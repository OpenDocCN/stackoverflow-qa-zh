# StackOverflow 问答 12149000-12149999

# java - idlj-maven-plugin 和包翻译

> ID：12149000
> 
> 赞同：2
> 
> 时间：2012-08-27T20:19:14.947
> 
> 标签：java, maven, corba, idl

我正在尝试使用[idlj-maven-plugin](http://mojo.codehaus.org/idlj-maven-plugin/usage.html)在 Maven 项目中包含一个 Corba .idl 文件。.idl 文件指定了某个模块，例如

```
module Tester
{
  interface Test {
    void sayHello();
  }
} 
```

我希望生成的类属于包`com.mycompany.tester`。我试过使用

```
 <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>idlj-maven-plugin</artifactId>
        <version>1.2.1</version>
        <executions>
          <execution>
            <goals>
              <goal>generate</goal>
            </goals>
          </execution>
        </executions>
        <configuration>
            <debug>true</debug>
            <compiler>jacorb</compiler>
            <sourceDirectory>../../idl</sourceDirectory>
            <source>
                <packageTranslations>
                    <packageTranslation>
                        <type>Tester</type>
                        <package>com.mycompany.tester</package>
                    </packageTranslation>
                </packageTranslations>
            </source>
        </configuration>
      </plugin> 
```

但它似乎完全没有效果。我也尝试使用`idlj`as`<compiler>`或使用

```
 <additionalArguments>
                    <additionalArgument>
                        -i2jpackage Tester:com.mycompany.tester
                    </additionalArgument>
                </additionalArguments> 
```

但似乎没有任何效果。

任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T21:01:50.527

我设法使一切都以这种方式工作：

```
 <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>idlj-maven-plugin</artifactId>
        <version>1.2.1</version>
        <executions>
          <execution>
            <goals>
              <goal>generate</goal>
            </goals>
          </execution>
        </executions>
        <configuration>
            <debug>true</debug>
            <compiler>jacorb</compiler>
            <sourceDirectory>../../idl</sourceDirectory>
            <sources>
                <source>
                    <additionalArguments>
                        <list>-i2jpackage</list>
                        <list>Tester:com.mycompany.tester</list>
                    </additionalArguments>
                </source>
            </sources>
        </configuration>
      </plugin> 
```

使用时，`<compiler>idlj</compiler>`我改为使用`<additionalArguments>`：

```
<additionalArguments>
    <list>-pkgTranslate</list>
    <list>Tester</list>
    <list>com.mycompany.tester</list>
</additionalArguments> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-16T01:26:04.883

使用命令 idlj 更容易

```
====  your tester.idl  ====

module tester
{
    interface Test {
        void sayHello();
    }
}

=========================== 
```

您可以使用带有选项的idlj`-pkgPrefix`将java文件生成到某个包，如下所示

```
idlj -pkgPrefix tester com.mycompany -fall tester.idl 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-23T17:10:22.463

尽管 idlj-maven-plugin 使用页面中的示例另有说明，但您必须将源选项包装在 sources 元素中：

```
<configuration>
    <compiler>jacorb</compiler>
    <sources>
        <source>
            <packagePrefix>com.acme</packagePrefix>
        </source>
    </sources>
</configuration> 
```

# floating-point - 浮点稳定性

> ID：12149002
> 
> 赞同：3
> 
> 时间：2012-08-27T20:19:27.367
> 
> 标签：floating-point

假设我有两个相等的有理分数 a/b 和 c/d。a、b、c 和 d 都可以表示为 32 位有符号整数。如果我用 64 位浮点数除法，a/b == c/d 总是吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T20:26:11.277

在某些情况下，即使结果保证相同，编译器优化也会阻止等式成立。原始的 x86 浮点运算是在 80 位寄存器上执行的；如果您将其中一个与存储的 64 位值进行比较，它可能会比较不相等。

# c# - Windows 8 - 如何关闭触控键盘？

> ID：12149006
> 
> 赞同：15
> 
> 时间：2012-08-27T20:19:49.357
> 
> 标签：c#, user-interface, windows-8, microsoft-metro

我正在用 C# 为 Windows 8 开发我的应用程序，一件非常烦人的事情是，即使所有文本框都失去焦点，触摸键盘有时也会停留在屏幕上。

我阅读了文章[键盘解除逻辑白皮书](http://msdn.microsoft.com/en-us/library/windows/apps/hh465404.aspx#invocation_and_dismissal_logic)，其中解释了从控件切换到控件时，即使控件可能不接受键盘输入，键盘也可以保持打开状态。这就是我的情况，因为我的所有内容都托管在 GridView 或 ListView 中。当用户点击屏幕上的任何项目时，点击会落在这些控件上。这很烦人，因为键盘占了半个屏幕，而且没有办法关闭键盘。

我试图将文本框设置为禁用，但它没有影响。删除键盘的唯一方法是将焦点设置在按钮上，这非常hacky。

我以为我需要用“AutomationPeer”做点什么，但我不清楚具体要做什么。有没有办法覆盖这种行为？

**编辑：** 我想通了。目标是更改为[白皮书](http://msdn.microsoft.com/en-us/library/windows/apps/hh465404.aspx#invocation_and_dismissal_logic)中未列出的 GridView 和 GridView 项的控件类型。这是我所做的允许我关闭键盘的网格代码：

```
public class KeyboardUnfocusableGridView : GridView
{
    private class KeyboardUnfocusableGridViewAutomationPeer : GridViewAutomationPeer
    {
        public KeyboardUnfocusableGridViewAutomationPeer(GridView owner)
            : base(owner)
        {
        }

        protected override AutomationControlType GetAutomationControlTypeCore()
        {
            return AutomationControlType.Custom;
        }

    }

    private class KeyboardUnfocusableGridViewItemAutomationPeer : GridViewItemAutomationPeer
    {
        public KeyboardUnfocusableGridViewItemAutomationPeer(GridViewItem owner)
            : base(owner)
        { }

        protected override AutomationControlType GetAutomationControlTypeCore()
        {
            return AutomationControlType.Custom;
        }

    }

    private class KeyboardUnfocusableGridViewItem : GridViewItem
    {
        protected override AutomationPeer OnCreateAutomationPeer()
        {
            var baseItem = base.OnCreateAutomationPeer();
            return new KeyboardUnfocusableGridViewItemAutomationPeer(this);
        }

    }

    protected override AutomationPeer OnCreateAutomationPeer()
    {
        var baseItem = base.OnCreateAutomationPeer();
        return new KeyboardUnfocusableGridViewAutomationPeer(this);
    }

    protected override Windows.UI.Xaml.DependencyObject GetContainerForItemOverride()
    {
        return new KeyboardUnfocusableGridViewItem();
    }
} 
```

不幸的是，我需要编写这么多代码来做一件简单的事情。这绝对不是最优的，因为我需要为`ItemsControl`我需要使用的每一个都这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:07:16.430

您需要做的是将焦点设置到任何不接受文本输入的控件。但是，请注意，如果用户手动显示键盘（而不是因为 TextBox 获得焦点而自动显示），那么键盘将保持打开状态。

查看这个关于屏幕键盘的非常好的线程以获取更多信息：

[http://social.msdn.microsoft.com/Forums/pl/winappswithcsharp/thread/3c227262-1d2c-4382-9c50-5b71d2b5d823](http://social.msdn.microsoft.com/Forums/pl/winappswithcsharp/thread/3c227262-1d2c-4382-9c50-5b71d2b5d823)

# image - 如何将图像显示为整个网页？

> ID：12149013
> 
> 赞同：0
> 
> 时间：2012-08-27T20:20:43.143
> 
> 标签：image, html, webpage

在我开始问这个问题之前，我确实进行了搜索，因为这是一个非常简单的问题。我有一张图片，我想把它作为我们网页上的唯一元素。没有其他内容，因为这张图片传达了我们想要传达的内容。现在我们还想根据显示的设备调整自身大小。我希望这可以通过 HTML 实现，但我想知道是否还有其他选择。

谢谢，

卡尔斯嫩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:24:41.163

你要找的是`background-size`房产。通过应用`background-size:cover` 到您`<body>`的 ，无论视口尺寸如何，图像都会相应地调整自身大小。 *注意：您的图像可能会使用**封面**进行剪辑。*

的替代值`background-size`也可以是**contains**。如果您`background-size:contain`改为应用，它仍会像前者一样相应地调整图像大小。 *注意：虽然这种方法承诺永远不会剪切图像，但它也会显示负空间/死空间（有时并不理想）。*

您的 CSS 应反映以下内容：

```
body {
 background-image: url('bg.jpg');
 background-position: center center;
 background-size: cover; /* or background-size: contain */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T21:23:28.473

您可以将图像用作网络资源（“页面”）。你可以简单地使用类似的链接到它`href="test.jpg"`，或者你可以直接公布它的 URL。浏览器会以某种方式显示它，可能会缩放它以适应浏览器窗口的宽度。

下一个更简单、更好的方法是使用仅包含一个`img`元素作为其内容的页面。通过将其宽度设置为 100%（在 HTML 或 CSS 中），可以使其缩放到浏览器窗口宽度。这样，缩放时它将保持其宽度：高度比例。浏览器中缩放的质量各不相同，但通常都很好，除非你向上缩放很多。在这种方法中，图像的固有宽度应该足够大（比如 2,000 像素）以避免相当大的向上缩放。

要删除图像周围的默认间距（默认页边距），使用 CSS 是最简单的。

示例（将“...”替换为有用信息）：

```
<!doctype html>
<meta charset=utf-8>
<title>...</title>
<style>
html, body { margin: 0; padding: 0; }
</style>
<img src="demo.jpg" alt="..." width="100%"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T20:25:59.850

将其设置为 a`background-image`并使用适当的`background-size`（例如`contain`）：

```
html {
    height: 100%;
}

body {
    background: url('to/your/image.png') no-repeat;
    background-size: contain;
} 
```

[这是一个演示。](http://jsfiddle.net/minitech/EgCds/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-27T20:29:49.240

我用这个：css

```
#body{
    background:url(../img/bg.jpg);
    margin: 0;
} 
```

javascript

```
$("#body").css('width',window.innerWidth)
$("#body").css('height',window.innerHeight) 
```

# jquery - jQuery .ajax 和同源策略

> ID：12149015
> 
> 赞同：2
> 
> 时间：2012-08-27T20:20:54.863
> 
> 标签：jquery, ajax, json, jsonp, same-origin-policy

我有一个正在运行的 HTML5/JS 应用程序，我正在尝试将其移植到浏览器进行演示。该应用程序是为在车辆中运行而构建的，并使用车辆制造商的网络 API 来获取/发布请求。

对于这个的浏览器版本，我正在尝试使用 jQuery 来获取/发布。但是，我立即遇到了问题。

```
XMLHttpRequest cannot load http://<API I AM CALLING>. Origin null is not allowed by Access-Control-Allow-Origin. 
```

我研究了同源政策，但仍然不完全理解。我可以浏览到正在使用的 URL，并查看我正在尝试检索的 JSON。

环顾网络，很多人建议在我的 ajax 调用中将 JSONP 指定为 dataType。我试了一下，没有成功。

```
 $.ajax({
                url: url,
                type: "GET",
                dataType: "jsonp",
                success: function (data, textStatus, jqXHR) {
                    log("success getting JSON from " + url);
                    success(data);
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    log("error getting JSON from " + url + ", code " + JSON.stringify(jqXHR));
                    log("textStatus is " + textStatus);
                    log("errorThrown is " + errorThrown);
                },
            }); 
```

我的控制台中出现错误：

```
Uncaught SyntaxError: Unexpected token : 
```

之后，使用我的错误回调。

```
error getting JSON from http://<API I AM CALLING>, code {"readyState":4,"status":200,"statusText":"success"}
textStatus is parsererror
errorThrown is Error: jQuery180006523256213404238_1346098086632 was not called 
```

看起来服务器正在响应我需要的 JSON 数据。但是，我猜测 jQuery 期望这些数据被包装在一个函数中，因此它无法解析它。

我无法控制我正在调用其 API 的服务器。由于数据正在返回浏览器，我觉得必须有某种方式来访问它。

注意：
App只针对webkit浏览器，其他的我不需要支持。将 dataType 保留为“json”只会导致 Chrome 出现问题，但由于不同的安全策略，Safari 似乎可以正常工作。寻找代码解决方法，而不是简单地使用特殊参数启动 Chrome。即使我在 Apache 上托管我的代码，Chrome 中仍然会发生这种情况，因此它不仅限于我尝试在本地打开 index.html。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:38:34.987

一种可能的解决方案是编写一个服务来代理您想要的 JSON 服务并返回 JSONP。我已经编写了许多这样的代理服务，因此我可以绕过相同的来源策略。

例如：[http ://high-cloud-3702.heroku.com/](http://high-cloud-3702.heroku.com/)

该服务是城市词典的 jsonp 代理。

您可以非常轻松地在 Sinatra 中编写这样的代理，并将其免费托管在 Heroku 上。

像这样的代理的关键是这段代码：

```
get '/' do
  callback = params.delete('callback') # jsonp
  json = <function_to_get_data_here>.to_json

  if callback
    content_type :js
    response = "#{callback}(#{json})" 
  else
    content_type :json
    response = json
  end
  response
end 
```

# ffmpeg - FFMPEG、像素化帧和 webm 格式

> ID：12149022
> 
> 赞同：1
> 
> 时间：2012-08-27T20:21:08.763
> 
> 标签：ffmpeg, webm

似乎每次我分割 .webm 视频时，一半或更多的帧都会被像素化和扭曲。

我的配置如下所示：

```
FFmpeg version 0.6.6-4:0.6.6-0ubuntu0.11.04.1, Copyright (c) 2000-2010 the Libav developers
  built on Jun 12 2012 16:35:16 with gcc 4.5.2
  configuration: --extra-version=4:0.6.6-0ubuntu0.11.04.1 --prefix=/usr --enable-avfilter --enable-avfilter-lavf --enable-vdpau --enable-bzlib --enable-libgsm --enable-libschroedinger --enable-libspeex --enable-libtheora --enable-libvorbis --enable-pthreads --enable-zlib --enable-libvpx --disable-stripping --enable-runtime-cpudetect --enable-vaapi --enable-gpl --enable-postproc --enable-swscale --enable-x11grab --enable-libdc1394 --enable-shared --disable-static 
```

有没有人有类似的经验？当我在同一系统上使用标准 ffmpeg 播放器播放相同的视频时，它们看起来还不错。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T07:21:53.277

如果您只是将 .webm 文件拆分为 2 个 .webm 文件，那么您需要添加`-vcodec copy -acodec copy`到命令行，例如

```
ffmpeg -i input.webm -vcodec copy -acodec copy -ss 10 -t 10 output.webm 
```

否则 ffmpeg 也会使用默认的低比特率对视频进行转码，这会导致像素化。此外，它使分裂慢得多。

# maven-3 - 将现有项目导入 Maven 多模块父项目

> ID：12149024
> 
> 赞同：2
> 
> 时间：2012-08-27T20:21:14.143
> 
> 标签：maven-3, myeclipse

我有 3 个项目，操作、安全和服务，我想制作一个多模块 maven 项目。

首先我做的是创建一个父项目——actionParent，把包装改成pom，添加接下来我添加到每个项目中。

但问题是子项目没有出现在父项目中

如

```
actionParent
     |
      ----action
     |
      ----security
     |
      ----service
     |
      ----pom.xml 
```

右键单击父项目导入现有的maven项目没有成功，我使用的是myEclipse 10

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:30:33.793

这与您遇到的问题相似吗？答案很冗长，可能会有所帮助。

[Maven - 制作可以独立于父项目的子项目](https://stackoverflow.com/questions/1725579/maven-making-child-projects-that-can-be-independent-of-their-parent)

# actionscript-3 - 如何在 adobe flash cs6 actionscript 3.0 中停止一个场景并播放下一个场景

> ID：12149028
> 
> 赞同：1
> 
> 时间：2012-08-27T20:21:36.907
> 
> 标签：actionscript-3, flash, loops, adobe, scene

我正在尝试制作一个循环动画场景，就像眼睛睁开和闭上一样。我有一个黑色矩形向下并与另一个黑色矩形相遇以创建闪烁效果。然后在中间我有一个按钮，观众可以点击它进入下一个场景。问题是在按下按钮之前和之后两个场景同时播放。如何播放第一个循环场景，然后在用户按下该按钮时停止播放下一个场景？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T23:18:56.103

您需要告诉各自的场景停止。否则，flash 播放器将在前一个场景的最后一帧之后自动移动到下一个场景（并在最后一个场景的最后一帧之后循环回到第一个场景）。

在 Flash 中，打开您的第一个场景并打开时间线视图。滚动到时间线的最后，添加一个新图层，在新图层上时间线的最后一帧上，创建一个关键帧（Windows 上的 F6）。选择新的关键帧后，打开代码编辑器（Windows 上的 F9）并输入命令，`stop();` 或者如果您希望当前场景保持循环（不移动到下一个场景）输入命令`gotoAndPlay(1);`

如果您希望您的其他场景在最后也停止，请在其时间轴上重复上述步骤。

# unit-testing - 如果没有断言，我可以强制单元测试失败吗？

> ID：12149039
> 
> 赞同：9
> 
> 时间：2012-08-27T20:22:03.107
> 
> 标签：unit-testing, mstest

我团队中的一些程序员有时会编写单元测试来调用方法，获取结果但忘记调用正确的`Assert`方法来实际检查正在发生的事情。

我想知道如果没有进行验证，我是否可以做任何配置来强制 MSTest 使测试失败。我记得在 DUnit 中看到过类似的东西，但在 Visual Studio 中找不到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T04:53:31.310

查看[Roy Osherove](http://www.typemock.com/test-lint/)和 co 的 Test-Lint。这是测试代码的静态代码分析。

我在公开 alpha/beta 版发布时尝试过一次。表现得非常好。但是没有尝试这种特定的需求。我不认为 MSTest 或大多数单元测试框架会防范这种开箱即用的情况。

阿奎那也有一个有效的评论。教育可能比检查和棍子更好。您甚至可以创建自定义规则来捕获流氓断言。检查该工具。

从该工具的主页，

> 它检测到什么问题？
> 目前，Test Lint 发现了一组常见问题：
> * 测试中缺少断言

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T21:23:47.340

我没有听说过这样的功能。没有断言的单元测试只是测试没有抛出错误，在这种情况下通常每次都会通过。

我很惊讶您的程序员实际上是在没有断言的情况下编写测试，这似乎非常不专业。我建议他们阅读一些关于测试驱动开发的在线课程，通常你编写一个测试失败，然后进行编程更改以使其通过（在这种情况下 Assert.IsTrue(true) 甚至不会开始有道理。

同时提供模板：

```
[Test]
public void TestCase
{
    //Setup
    //Run Test
    //Process Results
    //Assert
} 
```

我强烈建议购买此截屏视频：http: [//tekpub.com/productions/ft_tdd_wilson](http://tekpub.com/productions/ft_tdd_wilson)

它为如何编写单元测试以及如何正确遵循 TDD 提供了一个好主意。

# c# - AppSettings、UserSettings 和注册表项

> ID：12149041
> 
> 赞同：0
> 
> 时间：2012-08-27T20:22:31.617
> 
> 标签：c#, registry, app-config, appsettings, settings

基本上，我有一个 C# 应用程序，它具有某些我希望任何用户都能够更改的设置，但我希望这些设置适用于所有用户。（确切的实现是针对特定于计算机但不是特定于用户的项目，例如文件夹路径和 com 端口等）到目前为止，我已经使用 appSettings 实现了这一点，并且它运行良好，但是当用户没有权限时它会崩溃写入 Program Files 目录。

我正在寻找有关如何利用 appSettings、userSettings 或注册表中的值最好地处理这种情况的建议。我使用的任何解决方案都必须适用于非管理员用户以及管理员用户。对于这种类型的要求，什么被认为是“最佳实践”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:44:25.667

我将尝试编写一个包含所有需要读取/写入的设置的 XML 文件。
该文件可以保存在众所周知的文件夹中，例如 ProgramData（使用 Enviroment.SpecialFolder.CommonApplicationData）

最简单的方法是使用数据表 WriteXml 和 ReadXml 的内置方法。
您可以使用数据表实现一个内部加载和保存设置的类，并提供检索和设置单个设置（数据表中的行）的方法；

```
public class MyAppSettings
{
    // Where to store your settings
    private DataTable _storage = null;

    public MyAppSettings()
    {
       string settingFile = Path.Combine(Environment.GetFolderPath
                            (Environment.SpecialFolder.CommonApplicationData), 
                            "MyAppName", "MyAppSettings.xml");
       _storage = new DataTable();
       _storage.ReadXml(settingFile);
    }
    public void Save()
    {
       string settingFile = Path.Combine(Environment.GetFolderPath
                            (Environment.SpecialFolder.CommonApplicationData), 
                            "MyAppName", "MyAppSettings.xml");
       _storage.WriteXml(settingFile);
    }

    public string GetValue(string settingName)
    {
        // Code to search the base table
    }
    public void SetValue(string settingName, string settingValue)
    {
        // Code to update/insert the base table
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:25:57.640

您应该为此使用[应用程序设置](http://msdn.microsoft.com/en-us/library/a65txexh%28v=vs.100%29.aspx)。

Visual Studio[提供了良好的支持](http://msdn.microsoft.com/query/dev11.query?appId=Dev11IDEF1&l=EN-US&k=k%28ApplicationSettingsOverview%29;k%28TargetFrameworkMoniker-.NETFramework,Version=v4.0%29&rd=true)并使用您声明的属性（设置）自动生成访问器类。

# express - Express.js 渲染部分视图没有玉

> ID：12149047
> 
> 赞同：1
> 
> 时间：2012-08-27T20:23:03.043
> 
> 标签：express, template-engine, pug

我是 Node 和 Express 的新手。在 Express 创建的默认应用程序中，我发现部分渲染是通过这些行在翡翠中完成的（如果我错了，请纠正我）：

```
// layout.jade
body
    block content

// index.jade
block content
    h1= title 
```

使用过 php 框架后，这对我来说有点新鲜。显然，从今天开始，Express 不再处理部分渲染。它现在如何运作？

谢谢。

编辑：顺便说一句，有人知道 Express 文档发生了什么吗？官方网站的指南部分缩小了很多（或者可能只是我）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T03:07:08.080

部分渲染现在确实是由模板系统完成的。Express 3.0+ 决定保持简单并删除了内置的部分渲染功能。

[https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x](https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x)

# knockout.js - Knockout.js - 多个“页面”，切换模型？

> ID：12149051
> 
> 赞同：4
> 
> 时间：2012-08-27T20:23:10.833
> 
> 标签：knockout.js

无法理解如何在 Knockout 中最好地执行以下操作：

我正在将一个多页面服务器端应用程序移植到 Knockout，它在各个页面上执行许多不同的功能和数据，例如：

*   列出所有用户
*   查看用户页面
*   编辑用户页面
*   您的帐户设置
*   等等

这些不同的页面显示在每个页面的主要部分，带有共同的页眉、侧边栏和页脚。

所有页面（在页眉和侧边栏中）都有通用数据，我希望它的行为类似于“单页”应用程序（部分之间有动画等）

在等待您的反馈之前，我认为最好的方法是：

*   一个主模型，每个“页面”都有子模型
*   适用于 header、sidebar 等的常见 observables
*   指示“活动页面”和模板的可观察对象

例如：

```
var MainModel = {
   listUsersModel: { ... },
   userModel: { ... },
   accountModel: { ... },
   commonProperty: ko.observable('Blah'),
   anotherCommonProperty: ko.observable('Blah'),
   activeSection: ko.observable('listUsers') 
```

}

虽然我认为这会起作用，但我对如何“切换页面”以及使用新的服务器端数据更新新页面的模型有点模糊。

是最好/唯一的方法来做到这一点：

```
MainModel.userModel.userId(123456)
// userModel above subscribes to userId changes, to get new server via ajax
MainModel.activeSection = 'viewUser' 
```

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T06:06:51.370

这是 RNiemeyer 的一个例子，它回答了我的需要：

[https://github.com/rniemeyer/SamplePresentation/tree/master/js](https://github.com/rniemeyer/SamplePresentation/tree/master/js)

# algorithm - 在有向树图中找到“最佳根”？

> ID：12149053
> 
> 赞同：5
> 
> 时间：2012-08-27T20:23:15.490
> 
> 标签：algorithm, graph, tree, graph-theory

（这来自最近完成的编程竞赛）

给你 G，一个有 N 个节点和 N-1 条边的连通图。

（请注意，这意味着 G 形成一棵树。）

G 的每条边都是有向的。（不一定向上到任何根）

对于 G 的每个顶点 v，可以反转零个或多个边，使得从每个其他顶点 w 到 v 都有一条有向路径。让实现这一点的边反转的最小可能数量为 f(v)。

我们可以通过什么线性或对数线性算法来确定具有最小总 f(v) 的顶点子集（包括这些顶点的 f(v) 的值）？

例如考虑具有这些边的 4 个顶点图：

```
A<--B
C<--B
D<--B 
```

f(A) = 2, f(B) = 3, f(C) = 2 和 f(D) = 2...

..因此，所需的输出是 {A,C,D} 和 2

（注意我们只需要计算具有最小 f(v) 的顶点的 f(v) - 不是全部）

**代码：**

对于后代，这里是解决方案的代码：

```
int main()
{
    struct Edge
    {
        bool fwd;
        int dest;
    };

    int n;
    cin >> n;

    vector<vector<Edge>> V(n+1);

    rep(i, n-1)
    {
        int src, dest;
        scanf("%d %d", &src, &dest);

        V[src].push_back(Edge{true, dest});
        V[dest].push_back(Edge{false, src});
    }

    vector<int> F(n+1, -1);

    vector<bool> done(n+1, false);

    vector<int> todo;
    todo.push_back(1);
    done[1] = true;
    F[1] = 0;

    while (!todo.empty())
    {
        int next = todo.back();
        todo.pop_back();

        for (Edge e : V[next])
        {
            if (done[e.dest])
                continue;

            if (!e.fwd)
                F[1]++;
            done[e.dest] = true;
            todo.push_back(e.dest);
        }
    }

    todo.push_back(1);

    while (!todo.empty())
    {
        int next = todo.back();
        todo.pop_back();

        for (Edge e : V[next])
        {
            if (F[e.dest] != -1)
                continue;

            if (e.fwd)
                F[e.dest] = F[next] + 1;
            else
                F[e.dest] = F[next] - 1;

            todo.push_back(e.dest);
        }
    }

    int minf = INT_MAX;

    rep(i,1,n)
        chmin(minf, F[i]);

    cout << minf << endl;

    rep(i,1,n)
        if (F[i] == minf)
            cout << i << " ";
    cout << endl;

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-27T20:43:27.740

我认为以下算法可以正常工作，并且肯定可以在线性时间内工作。

该算法的动机如下。假设您已经知道某个单个节点 v 的 f(v) 的值。现在，考虑与 v 相邻的任何节点 u。如果我们想计算 f(u) 的值，我们可以重用来自f(v) 来计算它。请注意，为了从图中的任何节点 w 到 u，必须发生以下两种情况之一：

1.  这条路径穿过连接 u 和 v 的边。在这种情况下，我们从 w 到 u 的方式是从 w 到 v，然后沿着从 v 到 u 的边。
2.  那条路径不通过连接 u 和 v 的边。在这种情况下，我们从 w 到 u 的方式与我们从 w 到 v 的方式完全相同，只是我们一到达 u 就停止.

这个观察很重要的原因是，它意味着如果我们知道从任何节点翻转到 v 的边的数量，我们可以轻松修改它以获得我们要翻转的边集你的任何节点。具体来说，它将是与以前相同的边集，除了我们想要引导连接 u 和 v 的边，以便它将 v 连接到 u，而不是反过来。

如果从 u 到 v 的边最初是定向的 (u, v)，那么我们必须翻转所有翻转的正常边以使每个节点都指向 v，再加上一条边以使 v 重新指向 u。因此 f(u) = f(v) + 1。否则，如果边最初是有向的 (v, u)，那么我们要翻转的边集将与之前相同（将所有东西都指向 v），除了我们不会翻转边缘（v，u）。因此 f(u) = f(v) - 1。

因此，一旦我们知道单个节点 v 的 f 值，我们就可以为每个相邻节点 u 计算它，如下所示：

```
f(u) = f(v) + 1    if (u, v) is an edge.
f(u) = f(v) - 1    otherwise 
```

这意味着我们可以为所有节点 v 计算 f(v)，如下所示：

1.  计算任意选择的某个初始节点 v 的 f(v)。
2.  从 v 开始做 DFS。当到达节点 u 时，使用上述逻辑计算其 f 分数。

剩下要做的就是为某个初始节点计算 f(v)。为此，我们可以从 v 向外运行 DFS。每次我们看到边缘指向错误的方向时，我们都必须翻转它。因此，f(v) 的初始值由我们在初始 DFS 期间发现的错误指向边的数量给出。

因此，我们可以在 O(n) 时间内计算每个节点的 f 分数，方法是执行初始 DFS 计算初始节点的 f(v)，然后使用辅助 DFS 计算每个其他节点 u 的 f(u)。然后，您可以对 n 个 f 分数中的每一个进行 for 循环以找到最低分数，然后再执行一个循环以找到具有该 f 分数的所有值。这些步骤中的每一步都需要 O(n) 时间，因此整个算法也需要 O(n) 时间。

希望这可以帮助！这是一个很棒的问题！

# c++ - 矢量无效分配大小

> ID：12149057
> 
> 赞同：4
> 
> 时间：2012-08-27T20:23:27.677
> 
> 标签：c++, stl, vector, size, std

当我尝试创建一个向量并调整其大小以容纳最大数量的项目（vector::max_size()）时，我在运行时出现调试错误：

> “无效的分配大小：429467292”

我想知道为什么你不能调整这个大小，如果 max_size() 应该返回向量中的最大项目数......

```
vector<int> vc;
vc.resize(vc.max_size()); 
```

我也尝试在 VS2010 中启用 LARGADRESSAWARE:On，但这无济于事。想知道这是否是一个正确的 thoguth...

有人有线索吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T20:25:33.953

`max_size()`是向量可以存储的元素的绝对最大数量。使用默认分配器，这通常是`std::numeric_limits<std::size_t>::max() / sizeof(T)`. 也就是说，它是您可能创建的该类型的最大数组。

但是，您永远无法真正分配这么大的数组。程序加载的模块会占用程序的一些地址空间，每个线程的堆栈也是如此。您的程序中可能会有其他动态分配的对象（由您或运行时分配）。这些都导致地址空间碎片化，这意味着可用地址空间的最大连续块远小于可用地址空间的总量。

简而言之，实际上不可能`vector`用`max_size()`元素来分配 a。

# ruby-on-rails - Mongoid 分配 has_many 嵌入文档数组

> ID：12149058
> 
> 赞同：1
> 
> 时间：2012-08-27T20:23:38.713
> 
> 标签：ruby-on-rails, mongodb, mongoid

我有一个包含许多嵌入式文档（学生）的 mongoid 文档（学校）。有没有办法直接分配一组学生，而不是为每个学生进行数据库调用：

```
school.students << student1
school.students << student2 
```

（许多数据库调用）

对比

```
school.students = [ student1, student2 ] 
```

问题是第二个示例似乎因“无效学生”错误而不断失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T13:57:43.613

看起来这在最新版本的 mongoid gems 中已修复。完整的 gem 更新解决了这个问题。

# c++ - 创建包含 time_t 的字符串时出错？

> ID：12149063
> 
> 赞同：1
> 
> 时间：2012-08-27T20:23:50.663
> 
> 标签：c++, string, string-concatenation

我正在尝试使用当前时间和日期创建一个字符串

```
time_t t = time(NULL); //get time passed since UNIX epoc
struct tm *currentTime = localtime(&t);
string rightNow = (currentTime->tm_year + 1900) + '-'
     + (currentTime->tm_mon + 1) + '-'
     +  currentTime->tm_mday + ' '
     +  currentTime->tm_hour + ':'
     +  currentTime->tm_min + ':'
     +  currentTime->tm_sec; 
```

我得到错误

> 初始化 'std::basic_string<_CharT, _Traits, _Alloc>::basic_string(const _CharT*, const _Alloc&) [with _CharT = char, _Traits = std::char_traits, _Alloc = std::allocator]' 的参数 1

我担心字符串中使用的第一个“+”（因为它可能表示连接）是它在括号中的事实是否意味着添加？虽然我认为问题出在不同的行，因为编译器在我给出的最后一行给出了错误。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-27T20:27:18.107

在 C++ 中，不能使用 + 运算符连接数字、字符和字符串。要以这种方式连接字符串，请考虑使用`stringstream`：

```
time_t t = time(NULL); //get time passed since UNIX epoc
struct tm *currentTime = localtime(&t);
ostringstream builder;
builder << (currentTime->tm_year + 1900) << '-'
 << (currentTime->tm_mon + 1) << '-'
 <<  currentTime->tm_mday << ' '
 <<  currentTime->tm_hour << ':'
 <<  currentTime->tm_min << ':'
 <<  currentTime->tm_sec;
string rightNow = builder.str(); 
```

Alternatively, consider using the [Boost.Format](http://www.boost.org/doc/libs/1_51_0/libs/format/doc/format.html) library, which has slightly nicer syntax.

Hope this helps!

# linux - 如何删除bash中的双行

> ID：12149064
> 
> 赞同：2
> 
> 时间：2012-08-27T20:23:52.853
> 
> 标签：linux, bash, line

给定一个像这样的长文本文件（我们称之为`file.txt`）：

**已编辑**

```
1 AA
2 ab
3 azd
4 ab
5 AA
6 aslmdkfj
7 AA 
```

**如何删除bash中同一文件中至少出现两次的行？**我的意思是我想要得到这个结果：

```
1 AA
2 ab
3 azd
6 aslmdkfj 
```

给定一个特定的文本文件，我不想在双精度中使用相同的行。你能告诉我命令吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-27T20:27:37.143

假设空白很重要，典型的解决方案是：

```
awk '!x[$0]++' file.txt 
```

（例如，“ab”行与“ab”不同。如果您想以不同的方式处理空白，预处理数据可能是最简单的。）

--EDIT-- 鉴于修改后的问题，我将其解释为只想在给定列之后检查唯一性，请尝试以下操作：

```
awk '!x[ substr( $0, 2 )]++' file.txt 
```

这只会比较第 2 列到行尾，忽略第一列。这是一个典型的 awk 习惯用法：我们只是构建一个名为的数组`x`（一个字母变量名在脚本中是一个糟糕的想法，但对于命令行上的单行来说是合理的），它保存给定字符串的次数见过。第一次看到它，它被打印出来。在第一种情况下，我们使用包含在`$0`. 在第二种情况下，我们只使用由包括第二个字符和第二个字符之后的所有内容组成的子字符串。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-27T20:26:58.573

试试这个简单的脚本：

```
cat file.txt | sort | uniq 
```

`cat`将输出文件的内容，

`sort`将重复的条目彼此相邻

`uniq`将删除相邻的重复条目。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-27T20:25:55.427

该`uniq`命令将执行您想要的操作。

但请确保文件首先排序，它只检查连续行。

像这样：

```
sort file.txt | uniq 
```

# python - 使用 Python 生成多个 rdesktop 会话

> ID：12149070
> 
> 赞同：0
> 
> 时间：2012-08-27T20:24:32.923
> 
> 标签：python

我正在编写一个脚本来使用 rdesktop 启动远程桌面会话。代码的相关部分如下所示：

```
subprocess.call(["rdesktop", "-a 16", "-u user", "-g 1280x1024",, server]) 
```

发生这种情况时，终端将被锁定，直到我退出 rdesktop 会话。是否可以使用此脚本启动多个桌面会话？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-13T14:48:43.763

`subprocess.Popen`( [py2 docs](https://docs.python.org/2/library/subprocess.html#subprocess.Popen) , [py3 docs](https://docs.python.org/3/library/subprocess.html#subprocess.Popen) ) 是正确的答案。 `subprocess.call`等待命令完成，同时`subprocess.Popen`在后台调用它，并立即执行下一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:26:45.463

您可以分叉 python 进程或使用线程，或在后台运行该进程。

# amazon-s3 - 我应该使用 AWS 中的账户级访问密钥还是应该坚持使用特定于用户的访问密钥？

> ID：12149071
> 
> 赞同：1
> 
> 时间：2012-08-27T20:24:36.733
> 
> 标签：amazon-s3, amazon-web-services, credentials

我将所有内容存储在 AWS S3 中，我想知道哪种方法是检索我的图像的最佳方法：

*   我应该使用帐户访问密钥还是应该创建一个具有正确策略的用户，然后使用该“用户”的访问密钥？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:10:56.873

始终始终始终使用自己的 IAM 策略创建用户。如果你能提供帮助，你永远不应该使用 root 帐户凭据来做任何事情。

这就像以`root`用户身份在本地计算机上永久运行命令。帐户级访问和秘密访问密钥是王国的绝对密钥。有了它们，黑客、恶意员工或善意但容易发生事故的管理员可以完全破坏您拥有的每个 AWS 资源，从它们下载任何东西，并且通常会造成混乱和不和谐。即使是带有 pem 文件的机器也不安全。根级用户可以只从现有机器上切断 AMI。

查看[IAM 策略生成器。](http://awspolicygen.s3.amazonaws.com/policygen.html)编写 JSON 策略并不有趣且容易出错，但类似的工具将帮助您实现大部分目标。

# php - 如何远程登录并调用API？

> ID：12149072
> 
> 赞同：-1
> 
> 时间：2012-08-27T20:24:37.350
> 
> 标签：php

让我们抽象出世界上的困难，假设这里的这个家伙目前在他的库中拥有一个 HTML 页面和两个表单。它们看起来像这样：

```
 <form method="POST" action="foobar.com/login"> ...
 <form method="POST" action="foobar.com/getstuff"> ... 
```

第一个登录远程服务器，设置 cookie 等，第二个向该服务器发送请求以显示数据。

如何在 PHP 中完成此任务，登录并在单个页面加载中获取数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:14:52.543

您可以使用 cURL 进行通信，服务器端。从技术上讲，您的服务器将登录到远程服务器。因此，如果您需要连接许多会话，只要远程服务器不限制每个 IP 地址的数量或会话，它就可以工作。

更多信息： http: [//php.net/curl](http://php.net/curl)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-27T20:39:00.900

你的问题对我来说不是很清楚，但让我们试试：

最简单的方法是服务器对发送的第一个表单的响应是第二个表单。

或者你可以使用框架（我不建议这样做）。

另一种可能性是您在后台发送带有 ajax 的表单。有很多 js 框架允许轻松使用 ajax（jquery、prototype，...）。

# javascript - 为什么我的犀牛书的 SVG 时钟副本是一个黑色圆圈？

> ID：12149077
> 
> 赞同：0
> 
> 时间：2012-08-27T20:24:53.333
> 
> 标签：javascript, html, svg

我在[http://pastebin.com/RkhbhYra](http://pastebin.com/RkhbhYra)有一个 HTML 页面，其中包含以下相关 JavaScript：

```
var wallclock_now = new Date();
var wallclock_minute = wallclock_now.getMinutes();
var wallclock_hour = wallclock_now.getHours() % 12 + wallclock_minutes / 60;
var wallclock_minute_angle = wallclock_minute * 6;
var wallclock_hour_angle = wallclock_hour * 30;
var wallclock_minute_hand = document.getElementById('minutehand');
var wallclock_hour_hand = document.getElementById('hourhand');
wallclock_minute_hand.setAttribute('transform', 'rotate(' + wallclock_minute_angle + ',50,50)');
wallclock_hour_hand.setAttribute('transform', 'rotate(' + wallclock_hour_angle + ',50,50'); 
```

这旨在作为副本，以一些重命名和移动到单引号为模，例如 David Flanagan 的*JavaScript：权威指南*（第 6 版）中的示例 21-3。

它似乎不起作用；它在 AFAICT 内形成一个黑色圆圈，没有任何非黑色。JavaScript 控制台没有显示任何错误。

我在 Chrome 中查看它。

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:22:24.167

更改#face 将阻止一切变黑。

```
 #face
        {
        stroke-width: 3px;
        fill: none;
        } 
```

# php - parse_str, parse_url

> ID：12149084
> 
> 赞同：0
> 
> 时间：2012-08-27T20:25:43.640
> 
> 标签：php, string, parsing, youtube-api, parse-url

我一直在使用 parse_url 和 parse_str 来从 youtube.com 链接中获取 ?v= ，不幸的是，youtube 似乎传递了以下划线和连字符开头的视频 ID。

因此，

```
$url = parse_url($url);
$vid = parse_str($url['query'], $output);
$video_id = $output['v']; 
```

给我格式错误的 ID，其中 - 更改为 _ - 无论如何告诉 parse_url，parse_str 不要表现出这种行为？或其他一些解决方法？

理想情况下，我想避免正则表达式..

# sql - django 是否在第一次查询时创建隐式事务？

> ID：12149086
> 
> 赞同：1
> 
> 时间：2012-08-27T20:25:52.187
> 
> 标签：sql, django, transactions, innodb

我有 django 1.3.1、python2.6 和 MySQL 5.5.20。 `init_command`在 setting.py 中设置为`SET storage_engine=INNODB`.

我有以下情况：

考虑模型：

```
class Fruit(models.Model):
    name = models.CharField(max_length=50)

    def __unicode__(self):
        return self.name 
```

现在我打开两个 Django shell 并输入：

**django外壳我：**

```
./manage.py shell
(InteractiveConsole)
>>> import fruits.models as m
>>> m.Fruit(name="apple").save()
>>> m.Fruit.objects.get(pk=1)    
<Fruit: apple> 
```

**django 外壳二：**

```
./manage.py shell
(InteractiveConsole)
>>> import fruits.models as m
>>> m.Fruit.objects.get(pk=1)    
<Fruit: apple> 
```

到现在为止还挺好。现在我继续输入**shell I**：

```
>>> m.Fruit(name="peach").save()
>>> m.Fruit.objects.get(pk=2)
<Fruit: peach> 
```

*****问：为什么在shell II*** **中输入以下内容****找不到对象？****

 **```
>>> m.Fruit.objects.get(pk=2)
Traceback (most recent call last):
  File "<console>", line 1, in <module>
  File "..../django/db/models/manager.py", line 132, in get
    return self.get_query_set().get(*args, **kwargs)
  File "..../django/db/models/query.py", line 349, in get
    % self.model._meta.object_name)
DoesNotExist: Fruit matching query does not exist. 
```

我发现让 shell II “焕然一新”的唯一方法是：

```
>>> from django.db import transaction
>>> transaction.enter_transaction_management()
>>> transaction.rollback() 
```

如果我想确保 orm 不会“撒谎”，我`roolback()`每次查询水果时都需要这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:06:17.257

这是一个隔离问题。您可以放松到“隔离级别读取提交”以避免这种行为。此外，了解这种隔离级别的含义（[幻象](http://en.wikipedia.org/wiki/Isolation_%28database_systems%29#Phantom_reads)）。

要将 Read Committed Isolation Level 设置为您的 django 项目的 MySQL，您应该在 settings.py 中设置此参数：

```
DATABASE_OPTIONS = { 
     "init_command": 'SET storage_engine=INNODB,    \
                      SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED', } 
```**

# android - 如何在 TextView 中跨越多个字符串？

> ID：12149101
> 
> 赞同：2
> 
> 时间：2012-08-27T20:26:57.607
> 
> 标签：android, textview, spannablestring

我尝试使用此代码创建一个带有字符串“abcde”的TextView，其中“b”和“d”跨越：

```
private void testStringSpanning(TextView tv)
{
    // blue
    ForegroundColorSpan fcs = new ForegroundColorSpan( Color.BLUE );

    SpannableString  a = new SpannableString( "a" );
    SpannableString  b = new SpannableString( "b" );    
    b.setSpan( fcs, 0, 1, Spannable.SPAN_INCLUSIVE_INCLUSIVE );
    SpannableString  c = new SpannableString( "c" );
    SpannableString  d = new SpannableString( "d" );    
    d.setSpan( fcs, 0, 1, Spannable.SPAN_INCLUSIVE_INCLUSIVE );
    SpannableString  e = new SpannableString( "e" );

    SpannableStringBuilder builder = new SpannableStringBuilder();
    builder.append(a);
    builder.append(b);
    builder.append(c);
    builder.append(d);
    builder.append(e);

    tv.setText( builder, BufferType.SPANNABLE);
} 
```

结果不是我想要的。a、c 和 e 应为纯白色，bd 应为蓝色。

我究竟做错了什么？

![结果字符串，“a”为纯白色，“bdce”为蓝色](../Images/65b4627460564fc5332e7ef591862bb9.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-27T23:01:53.727

尝试这个：

```
ForegroundColorSpan fcs = new ForegroundColorSpan( Color.BLUE );

//your strings in case you have most than one
String str1 = new String("a");
String str2 = new String("b");
String str3 = new String("c");
String str4 = new String("d");

//or a single one str = new String ("abcd")

//set all to on a TV
TextView string =(TextView)findViewById(R.id.tvString);
string.setText( str1 + str2 + str3 + str4, TextView.BufferType.SPANNABLE );

//convert all string y a single SpannableString
SpannableString s = (SpannableString)string.getText();

//This variables hepl you counting large strings
int str1_lenght = str1.length();
int str2_lenght = srt2.length();
int str3_lenght = srt3.length();
int str4_lenght = srt4.length();

//setting color on an specific string
s.setSpan(fcs, str1_lenght, str1_lenght + str2_lenght, 0);
s.setSpan(fcs, str1_lenght + str2_lenght + str3_lenght, str1_lenght + str2_lenght + str3_lenght + str4_lenght, 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:18:11.263

如果将Span 设置为字母C 和E，那么此时它看起来是否正确？我有一种感觉，字母 B 上的 setSpan 正在覆盖其余字符的“默认值”。那是我在黑暗中拍摄的。

# python - Twitter auth 在 Twython 2.3.4 上失败，错误：401，无法验证 oauth 签名和令牌

> ID：12149102
> 
> 赞同：4
> 
> 时间：2012-08-27T20:26:59.357
> 
> 标签：python, django, oauth, twitter-oauth, twython

我刚刚更新到[Twython](https://github.com/ryanmcgrath/twython) 2.3.4，但现在我的 Twitter 身份验证停止工作。它在“auth_props = twitter.get_authentication_tokens()”行上失败。知道出了什么问题吗？提前致谢！

使用 Twython 进行 Twitter 身份验证的 python 代码如下：

```
def begin_auth(request):
    twitter = Twython(
        twitter_token = TWITTER_KEY,
        twitter_secret = TWITTER_SECRET,
        callback_url = request.build_absolute_uri(reverse('portnoy.views.thanks'))
    )
    # Request an authorization url to send the user to...
    auth_props = twitter.get_authentication_tokens() 
```

**我在上面的行中有以下错误：TwythonAuthError：“似乎无法使用您的 OAuth 垃圾验证某些内容。错误：401，消息：无法验证 oauth 签名和令牌”**

```
 # Then send them over there, durh.
    request.session['request_token'] = auth_props
    return HttpResponseRedirect(auth_props['auth_url'])

def thanks(request, redirect_url='/'):
    c = RequestContext(request)
    # for permanent ones and store them...
    twitter = Twython(
        twitter_token = TWITTER_KEY,
        twitter_secret = TWITTER_SECRET,
        oauth_token = request.session['request_token']['oauth_token'],
        oauth_token_secret = request.session['request_token']['oauth_token_secret']
     )

    # Retrieve the tokens we want...
    authorized_tokens = twitter.get_authorized_tokens()
    request.session['request_tokens'] = authorized_tokens
    debug('thanks', request.session['request_tokens'])

    user = User.objects.filter(username=authorized_tokens['screen_name'])
    if user.exists():
        user = user[0]
        user.backend='django.contrib.auth.backends.ModelBackend'     
        auth.login(request,user)
    else:
        return render_to_response('twitter_register.html', c)   
    return HttpResponseRedirect(redirect_url) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T20:37:42.187

我是 Twython 的作者。

你在后台运行什么版本的请求？最近有一个问题是，由于上游错误，人们不断遇到各种与 OAuth 相关的错误。好奇是不是跟这个有关...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T15:23:42.127

我自己也遇到了同样的问题。如果您在本地进行测试，它似乎不起作用。

这是我为修复它所做的：

1.  编辑你的主机文件（在 OSX 上它位于 /private/etc/hosts）。添加行：127.0.0.1 myapp.com
2.  转到您的 Twitter 应用程序设置，然后单击“设置”选项卡。将您的回调 URL 设置为： [http ://myapp.com:8000/thanks](http://myapp.com:8000/thanks)

确保正确设置端口号和 url。希望有帮助！

# asp.net-mvc-3 - 发布一个不能使用 DefaultModelBinder 的 Javascript 数组？

> ID：12149106
> 
> 赞同：2
> 
> 时间：2012-08-27T20:27:07.540
> 
> 标签：asp.net-mvc-3, jquery, knockout.js, model-binding

## 代码

我无法将一组 javascript 对象发送到服务器。ModelBinder 标准无法识别该格式。

**在我的服务器上，我有课程：**

```
public class PessoaViewModel
{
    [HiddenInput(DisplayValue = false)]
    public int Id { get; set; }

    public string Nome { get; set; }
    public string Tipo { get; set; }
    public string CPF { get; set; }

    public ICollection<TelefoneViewModel> Telefones { get; set; }
    public ICollection<EnderecoViewModel> Enderecos { get; set; }
    public ICollection<EmailViewModel> Emails { get; set; }
    public PessoaViewModel Conjuge { get; set; }
}

public class TelefoneViewModel
{
    [HiddenInput(DisplayValue = false)]
    public int Id { get; set; }

    [AdditionalMetadata("class", "span2")]
    [AdditionalMetadata("placeholder", "Tipo")]
    public string Tipo { get; set; }

    [DataType(DataType.PhoneNumber)]
    [AdditionalMetadata("class", "span2")]
    public string Numero { get; set; }

    [HiddenInput(DisplayValue = false)]
    public int Ordem { get; set; }
} 
```

> 我没有列出课程的其余部分，因为它还没有在代码中使用！

**我的 javascript**

```
$.ajax
    url:  $(form).attr("action")
    type: "POST"
    error: (err, errType, errMessage) -> 
        console.error a.statusText
    cache: false
    data: ko.mapping.toJS(@, ignoreFunctionsMapping) 
    success: (data, txtStatus) -> console.log "OK!!?? On server maybe not!" 
```

**服务器结果**

![动作粘合剂](../Images/347c6b8d43927e0ebe3393f73c24b006.png)

> 完整图片：http: [//i.stack.imgur.com/NeIm1.jpg](https://i.stack.imgur.com/NeIm1.jpg)

## 问题

可以看到，post 正在做，值是正确的。但是 asp.net mvc 没有正确填充`Telefones`对象！

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-08T08:22:43.173

您的问题是因为您缺少“。”，它应该具有以下格式：

```
Telefones[0].Id: 1
Telefones[0].Ordem: bli 
```

# c# - IEnumerable 的简单转换 Monotouch 中的 JSON

> ID：12149107
> 
> 赞同：3
> 
> 时间：2012-08-27T20:27:12.157
> 
> 标签：c#, .net, json, xamarin.ios

我想知道是否有一种合乎逻辑的方法可以从`IEnumerable`Monotouch-JSON 中的任何内容中生成 JSON 字符串。我找到`System.Json`了 -Namespace 但它似乎总是需要 a`KeyValuePair`而且我不明白如何使用这个重载。

为了清楚起见：我不想将一些 WebRequest 从 JSON 转换为 .NET 中的东西。我想要另一种方式，比如 ASP.NET 中的 JsonResult-Conversion。我最喜欢的是：

```
var list = new List<string>() { "value1", "value2" };
var result = new System.Json.JsonArray(list); 
```

所以这`result`就像

```
["value1","value2"] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T20:33:38.993

[Json.Net](http://json.codeplex.com/)会给出你期望的输出

```
var list = new List<string>() { "value1", "value2" };
var result = JsonConvert.SerializeObject(list); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-27T20:35:09.357

它不是特别整洁，但这有效：

```
var list = new List<string>() { "value1", "value2" };

var result = new System.Json.JsonArray(list.Select(x => (System.Json.JsonValue)x));

Console.WriteLine( result.ToString() ); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-27T20:31:17.103

最好的选择（为了兼容性和易用性）可能是使用[Newtonsoft 的 JSON.NET](http://json.codeplex.com/)库。

# python - 如何使用 Django QuerySet 中的 startTime 和 endTime 字段计算持续时间？

> ID：12149114
> 
> 赞同：1
> 
> 时间：2012-08-27T20:27:25.270
> 
> 标签：python, django, django-queryset, django-aggregation

我有这个模型：

```
class TimeInterval(models.Model):
    startTime = models.DateTimeField()
    endTime = models.DateTimeField() 
```

如何仅使用 QuerySet API 聚合平均时间间隔？

我试过这个：

```
qs = TimeInterval.objects.extra(
    select={"duration": "endTime - startTime"}).aggregate(
        Avg("duration")) 
```

但它抛出：

```
FieldError: Cannot resolve keyword 'duration' into field. Choices are:
endTime, startTime 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:10:43.547

我将为此使用一种解决方法。

创建一个名为持续时间的新字段。

为 TimeInterval 创建一个 pre-save_signal 来计算持续时间的值。

然后，您可以轻松地在查询中使用持续时间字段。

# ssl - 扭曲的listenSSL虚拟主机

> ID：12149119
> 
> 赞同：1
> 
> 时间：2012-08-27T20:27:37.840
> 
> 标签：ssl, twisted, twisted.web

目前使用一个非常简单的 Twisted`NameVirtualHost`和一些 JSON 配置文件来在一个`Site`对象中提供非常基本的内容。Twisted 提供的资源都是烧瓶中内置的 WSGI 对象。

我想知道如何使用 包装与这些域的连接`SSLContext`，因为`reactor.listenSSL`只需要一个上下文，因此如何为每个域/子域赋予它自己的 crt/key 对并不明显。有没有办法为每个不需要代理的域设置带有 ssl 的命名虚拟主机？我找不到任何`NameVirtualHost`与 SSL 一起使用的 Twisted 示例，而我唯一能做的事情就是在只有一个域的上下文的情况下挂上侦听端口 443 的反应器？

我想知道是否有人尝试过这个？

我的简单服务器没有任何 SSL 处理：

[https://github.com/DeaconDesperado/twsrv/blob/master/service.py](https://github.com/DeaconDesperado/twsrv/blob/master/service.py)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T18:26:41.343

TLS（取代 SSL 的现代协议的名称）最近才支持您正在寻找的功能。该功能称为[服务器名称指示](http://en.wikipedia.org/wiki/Server_Name_Indication)（或*SNI*）。现代平台上的现代浏览器支持它，但不支持一些较旧但仍广泛使用的平台（有关支持的浏览器列表，请参见维基百科页面）。

Twisted 对此没有特定的内置支持。但是，它不需要任何东西。Twisted 的 SSL 支持所基于的 pyOpenSSL 确实支持 SNI。

set_tlsext_servername_callback [pyOpenSSL](http://packages.python.org/pyOpenSSL/openssl-context.html) API 为您提供了构建所需行为的基本机制。这使您可以定义一个回调，该回调可以访问客户端请求的服务器名称。此时，您可以指定要用于连接的密钥/证书对。您可以在 pyOpenSSL 的示例目录中找到[演示如何使用此 API的示例。](http://bazaar.launchpad.net/~exarkun/pyopenssl/trunk/files/head:/examples/sni/)

这是该示例的摘录，可为您提供要点：

```
def pick_certificate(connection):
    try:
        key, cert = certificates[connection.get_servername()]
    except KeyError:
        pass
    else:
        new_context = Context(TLSv1_METHOD)
        new_context.use_privatekey(key)
        new_context.use_certificate(cert)
        connection.set_context(new_context)

server_context = Context(TLSv1_METHOD)
server_context.set_tlsext_servername_callback(pick_certificate) 
```

您可以将此方法合并到自定义上下文工厂中，然后将该上下文工厂提供给`listenSSL`调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-29T05:36:17.953

只是为了给这个添加一些闭包，为了将来的搜索，这里是来自打印 SNI 的示例中的 echo 服务器的示例代码：

```
from twisted.internet import ssl, reactor
from twisted.internet.protocol import Factory, Protocol

class Echo(Protocol):
    def dataReceived(self, data):
        self.transport.write(data)

def pick_cert(connection):
    print('Received SNI: ', connection.get_servername())

if __name__ == '__main__':
    factory = Factory()
    factory.protocol = Echo

    with open("keys/ca.pem") as certAuthCertFile:
        certAuthCert = ssl.Certificate.loadPEM(certAuthCertFile.read())

    with open("keys/server.key") as keyFile:
        with open("keys/server.crt") as certFile:
            serverCert = ssl.PrivateCertificate.loadPEM(
                keyFile.read() + certFile.read())

    contextFactory = serverCert.options(certAuthCert)

    ctx = contextFactory.getContext()
    ctx.set_tlsext_servername_callback(pick_cert)

    reactor.listenSSL(8000, factory, contextFactory)
    reactor.run() 
```

而且因为让 OpenSSL 工作总是很棘手，所以您可以使用以下 OpenSSL 语句来连接它：

```
openssl s_client -connect localhost:8000 -servername hello_world -cert keys/client.crt -key keys/client.key 
```

针对 pyOpenSSL==0.13 运行上面的 python 代码，然后运行上面的 s_client 命令，将把它打印到屏幕上：

```
('Received SNI: ', 'hello_world') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-02T17:01:13.837

现在有一个 txsni 项目负责根据请求查找正确的证书。[https://github.com/glyph/txsni](https://github.com/glyph/txsni)

# javascript - 返回错误时如何在jQuery中重新发送ajax请求？

> ID：12149121
> 
> 赞同：0
> 
> 时间：2012-08-27T20:27:44.673
> 
> 标签：javascript, jquery, ruby-on-rails, ajax

我的 javascript 中有一个将数据发送到 Rails 控制器的 ajax 请求。如果控制器发现数据与数据库中已有的信息重复，则返回“无法处理的实体”错误。

我想打开一个对话框并询问用户是否确定要插入重复信息。如果用户说是，我想向数据对象添加另一个键并重试请求。添加的键将是一个忽略重复检查并插入数据的标志。

```
$.ajax({
      url: '/url',
      type: 'post',
      data: this.buildData(),
      success: function() {
        bootbox.alert('Information added', function() {
            Backbone.history.loadUrl();
          }.bind(this)
        );
      }.bind(this),
      error: function(jqXHR, textStatus, errorThrown) {
        if(errorThrown === 'Unprocessable Entity') {
          bootbox.confirm('Do it anyway?', function(confirm) {
              if(confirm) {
                /*Here I want to add another key to the data object and resend the request*/ 
              }
             }.bind(this)
           );
         }  
       }.bind(this)
    }); 
```

我将如何去做，或者更好的是，有没有更好的方法来做我想要完成的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:36:33.110

首先，我确信有一些插件。

但是如果没有合适的插件，你总是可以做这样的事情

```
function dispatchAjax( options ){

     options = $.extend({},options);
     var data = $.extend({}, this.buildData(), options.data );
     $.ajax({ ... , 
                  error : function( ) { .... 
                             if ( typeof(options.retry) == "function" ){
                                   var retryFunc = options.retry;
                                   options.retry = null;
                                   options.data = { "extraKey":"extraValue"};
                                   dispatchAjax( options );
                             }
             });

} 
```

给我一些时间来确保它正常运行并给出完整的代码

您可能感兴趣的另一种方法是使用同步调用。`{"async":false}`在 JQuery 的 ajax 请求中。

我知道这似乎违背了目的，但是我发现它对于服务器端验证非常有用 - 所以它可能适合您的需求，并且您不必像上面显示的那样处理复杂的处理程序，它只是这样的：

```
 var result = dipatchRequest( options, /*async*/  false, /*ignore-duplicates*/ false );
  if ( result.error && confirm(..) ){ 
       dispatchRequest(options, true, true);
  } 
```

# google-app-engine - 为什么在 Gql 中使用 PostalAddress 属性？

> ID：12149127
> 
> 赞同：0
> 
> 时间：2012-08-27T20:28:05.760
> 
> 标签：google-app-engine, gql, gqlquery

> **可能重复：**
> [为什么将电子邮件、用户名、邮政编码等作为 GAE 数据存储中的实体](https://stackoverflow.com/questions/9814182/why-email-username-postalcode-etc-as-entities-in-gae-datastore)

App Engine Data store 有这个属性“PostalAddress”，但使用它的目的是什么？

它在文档中：[https ://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#PostalAddress](https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#PostalAddress)

我有要存储的地址，我在想如果我想获得城市或邮政编码，如果我将它们存储在不同的列字段中，我就可以轻松地查询它们。或者有没有办法从邮政地址属性中提取邮政编码或城市/州或街道线，而不必在其上使用正则表达式......

有谁知道如何使用这个属性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T01:32:36.920

它基本上只是一个字符串属性。不执行验证或假定任何类型的结构。他们可能使用它来支持 gd:postalAddress 元素。

[https://developers.google.com/gdata/docs/1.0/elements?hl=el#gdPostalAddress](https://developers.google.com/gdata/docs/1.0/elements?hl=el#gdPostalAddress)

# php - PHP中字符串内的闭包

> ID：12149131
> 
> 赞同：2
> 
> 时间：2012-08-27T20:28:14.730
> 
> 标签：php, closures, anonymous-function

我想在 PHP 中的一个字符串中创建和执行一个闭包，它不喜欢我这样做的方式。

此代码不起作用...

```
echo ( 'Hello, ' . (function($s) { return $s; })('World!') ); 
```

然而，这是完全有效的，并且按预期工作......

```
$f = (function($s) { return $s; });
echo ( 'Hello, ' . $f('World!') ); 
```

为什么第一个不起作用，有没有办法在一行中做到这一点（不是因为我认为它有效，因为我确定它不是）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:32:19.397

您可能想看看[PHP5.3 中的自执行函数？](https://stackoverflow.com/questions/3865934/self-executing-functions-in-php5-3).

本质上，直到（也许）在 5.4 中的某个时候，才使用“（...）（）”进行自我调用。

[https://wiki.php.net/rfc/fcallfcall](https://wiki.php.net/rfc/fcallfcall)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:31:48.843

我相信这只能在 PHP 5.4 中实现：http: [//php.net/manual/en/migration54.new-features.php](http://php.net/manual/en/migration54.new-features.php)

# actionscript-3 - 弹性复选框组

> ID：12149137
> 
> 赞同：0
> 
> 时间：2012-08-27T20:28:32.347
> 
> 标签：actionscript-3, apache-flex, flex4

我需要使用复选框作为单选按钮。就我而言，我想定义一个复选框组，但我不知道为什么。如果我选择一个复选框，我希望另一个复选框被取消选择

你可以帮帮我吗 ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T05:59:58.580

如果您需要静态数量的单选按钮，则可以使用 Spark States。

```
<s:states>
    <s:State name="check1"/>
    <s:Stage name="check2"/>
</s:States>

<s:CheckBox selected="false" selected.check1="true" click="currentState='check1'"/>
<s:CheckBox selected="false" selected.check2="true" click="currentState='check2'"/> 
```

当您单击第一个复选框时，它会触发“check1”状态，其中第一个复选框被选中，另一个复选框未被选中。单击第二个则相反。显然，这并不像某些人希望的那样灵活。但如果是用于界面元素（例如选项菜单），那就完美了。

如果您了解如何以及何时使用状态，状态将非常有用。上周末，我使用它们创建了一个[全 Flex 幻灯片](http://flexsupreme.com/2012/08/25/the-all-flex-slideshow/)，这是一个很好的例子，说明了这个简单的小阵列有多么强大。

编辑：我只是拼凑了一个简单的应用程序来测试它，它看起来不像使用 click 可以工作。不过，我相信您可以修改另一个事件以使其正常工作。抱歉，这不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T02:19:58.047

我会使用`RadioButton`s，但如果你真的想这样做，我会采用 LondonDrugs_MediaServices 方法。

`CheckBox`并且`RadioButton`都从`ToggleButtonBase`.

创建您自己的`CheckBoxRadioButtonSkin`. 复制`CheckBoxSkin`到它并重命名`hostComponent`.

然后在你`radioButton`的皮肤上使用这个皮肤，让它看起来像复选框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T23:20:39.783

我之前有过这样的要求，我使用了一个带有 Checkbox 的 Datagrid 作为 itemRenderer。

我对 Checkbox 进行了子类化，覆盖了`data`getter，以便每次单击它时，Datagrid 的所有项目都未选中，除他之外未选中。这种方法获得了一些优点：

1.  灵活地以编程方式添加选项数量。
2.  是否显示选项组的标题。
3.  如果空间有限，则启用使用滚动条。

希望解决方案是您正在寻找的。

# objective-c - 为什么这是一个潜在的对象泄漏？

> ID：12149138
> 
> 赞同：3
> 
> 时间：2012-08-27T20:28:35.910
> 
> 标签：objective-c, properties

有人可以解释为什么我在这里收到“潜在的对象泄漏”警告吗？我不明白。谢谢！

```
-(Code) drawTo:(ContextClass *) trg
{
  CGColorSpaceRef rgbColorspace = CGColorSpaceCreateDeviceRGB();
  CGFloat values[4] = { getRed(colour),
                      getGreen(colour),
                      getBlue(colour), 1.0 };

  trg.storedColourRef = CGColorCreate(rgbColorspace, values);    

  CGColorSpaceRelease(rgbColorspace);

  return OK;
} 
```

是因为我将对象存储在 trg.storedColourRef 吗？...这是不同类别的属性：

```
@property (nonatomic, assign) CGColorRef storedColourRef; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T20:35:13.273

是的，那是因为您使用创建 Quartz 颜色`CGColorCreate()`并将其传递给某个外部 (?) 对象。编译器找不到`CGColorRelease()`用于销毁颜色对象的相应调用，因此生成此警告。

# javascript - highcharts 选项可点击的类别名称

> ID：12149140
> 
> 赞同：1
> 
> 时间：2012-08-27T20:28:55.173
> 
> 标签：javascript, html, jquery, highcharts

我正在使用[HighCharts](http://highcharts.com)，用于制作图表的 javascript 插件。
我想要的是找到处理**类别**名称上的单击事件的选项并获取其属性，如下图所示：

# 高图

![highcharts 可点击类别](../Images/cae2df9cc20e87c17d8b102defeb55ff.png)

我知道 HighCharts 使用 JQuery。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T22:40:19.890

您可以将事件处理程序添加到`first` `highcharts-axis`. 哪个是`categories`容器。

因此，**对于类别**：

```
$('#container .highcharts-axis:first tspan').click(function() {
    console.log($(this).text());
}); 
```

[**演示**](http://jsfiddle.net/ricardolohmann/WqZcP/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T21:51:55.897

您可以在 svg 元素上监听 click 事件。这里的工作示例：http: [//livecoding.io/3492608](http://livecoding.io/3492608)。它的要点：

```
$('.highcharts-axis text').click(function(){
  alert($(this).text());
}); 
```

# javascript - 自动点击html按钮

> ID：12149141
> 
> 赞同：-2
> 
> 时间：2012-08-27T20:28:55.697
> 
> 标签：javascript, google-chrome-extension

我正在制作一个 chrome 扩展程序，但我被 javascript 和页面上的按钮卡住了。我在网上有这样的网站（不是我的，所以我不能编辑它）：

```
 <input class="button" name="accept" type="submit" value=LoggIn"> 
```

现在我会自动打开填写了用户名和密码的页面，但现在我希望自动单击该按钮。

## 谢谢帮助！

编辑：

我有脚本代码：

```
var tabID = 1;
chrome.tabs.create({index:tabID,url:"https://monostudby4frd.hisf.no:8001/",active:false,pinned:true},
function(tab) {
    tabID = tab.id;
}); 

sleep(3000);
chrome.tabs.executeScript(null, {code:clickButton()});
sleep(3000);

chrome.tabs.getSelected(null, function(tab) {
    chrome.tabs.remove(tabID);
});

function sleep(ms) {
    var dt = new Date();
    dt.setTime(dt.getTime() + ms);
    while (new Date().getTime() < dt.getTime());
}

function clickButton() {
    document.getElementById("accept").click();
} 
```

调试器说：

```
Uncaught TypeError: Cannot call method 'click' of null 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:55:57.373

按钮输入很简单：`inputElem.click()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:53:00.153

您可以使用 jquery 来触发点击事件。

不过，您不应该真的自动提交表单。

```
<form onsubmit='doSomething();'>
    <input id="submitButton" class="button" name="accept" type="submit" value="LoggIn">
</form>

<script type="text/javascript">
    function doSomething() {

        console.log("Clicked!");

    }

    $("#submitButton").trigger('click');
</script> 
```

# android - 在 Spinner 打开对话框之前做一些事情 - Android

> ID：12149145
> 
> 赞同：-1
> 
> 时间：2012-08-27T20:29:04.370
> 
> 标签：android, events, spinner

我正在尝试获取在显示带有单选按钮的对话框之前调用的事件。但我做不到。我尝试使用 setOnTouchListener 事件，但它没有按我的计划工作。所以我想象有一个事件可以控制微调器对话框的打开和关闭功能。

有人知道吗？！

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:36:16.667

查看有关对话框的官方文档：http: [//developer.android.com/guide/topics/ui/dialogs.html](http://developer.android.com/guide/topics/ui/dialogs.html)

```
final CharSequence[] items = {"Red", "Green", "Blue"};

AlertDialog.Builder builder = new AlertDialog.Builder(this);
builder.setTitle("Pick a color");
builder.setSingleChoiceItems(items, -1, new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int item) {
        Toast.makeText(getApplicationContext(), items[item], Toast.LENGTH_SHORT).show();
    }
});
AlertDialog alert = builder.create(); 
```

# ajax - 急切地获取（分离）集合上的 LazyInitializationException

> ID：12149146
> 
> 赞同：0
> 
> 时间：2012-08-27T20:29:06.120
> 
> 标签：ajax, hibernate, jpa, primefaces, lazy-initialization

首先一些信息：

*   我在用着：
    *   Spring 3.1.1.RELEASE
    *   休眠 4.1.5.SP1
    *   JSF 2.0？
    *   OpenSessionInViewFilter (org.springframework.orm.hibernate4.support.OpenSessionInViewFilter)
    *   PrimeFaces 3.3.1
    *   龙目岛 0.11.2
    *   JBoss 7.1.1.Final

**简短版本：**

当我的实体`Emloyee`变得分离时（因此它也急切地获取了`Location`s 的集合），我不能在`Employee.getLocations().add()`没有得到`LazyInitializationException`. 使用基于非 JPA 的集合作为传输对象是可行的。

**长版：**

我有一个包含 s`Employee`集合的实体`Location`：

```
@Data
@EqualsAndHashCode(callSuper = true, of = {})
@ToString(callSuper = true, of = {})
@Entity
@Inheritance(strategy = InheritanceType.JOINED)
public class Employee extends Person
{
    @ManyToMany
    @JoinTable(name = "location_employee",
            joinColumns = @JoinColumn(name = "employee_id",
                    referencedColumnName = "id"),
            inverseJoinColumns = @JoinColumn(name = "location_id",
                    referencedColumnName = "id"))
    private Set<Location>   locations   = new HashSet<Location>();
} 
```

`Employee`extends from `Person`which 有一些字符串，如名称等，但这些不相关。

```
@Data
@EqualsAndHashCode(of = "id")
@ToString(of = { "id", "name" })
@Entity
@Inheritance(strategy = InheritanceType.JOINED)
public class Person
{
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Setter(AccessLevel.NONE)
    private Long    id;

    private String  name;
} 
```

这个`Location`类也很简单：

```
@Data
@EqualsAndHashCode(of = "id")
@ToString(of = { "id", "name" })
@Entity
public class Location
{
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Setter(AccessLevel.NONE)
    private Long            id;

    private String          name;
    @ManyToMany
    @JoinTable(name = "location_employee",
            joinColumns = @JoinColumn(name = "location_id",
                    referencedColumnName = "id"),
            inverseJoinColumns = @JoinColumn(name = "employee_id",
                    referencedColumnName = "id"))
    private Set<Employee>   employees = new HashSet<Employee>();
} 
```

默认情况下，所有集合都是惰性的。但是在我的 JSF 页面中，我想将`Location`s 添加到现有的`Employee`. 为此，我渴望`Employee`使用以下支持 bean 加载我的内容：

```
@Named
@Scope("view")
public class BackingBean
{
    @Inject
    private EmployeeDAO employeeDAO;
    private Employee        employeeFull;
    @Inject
    private LocationDAO locationDAO;
    private List<Location> locations;

    public Employee getSelectedEmployeeFull()
    {
        if (selectedEmployeeFull == null)
        {
            selectedEmployeeFull = employeeDAO.getEagerById(1L);
        }
        return selectedEmployeeFull;
    }

    public void setEmployeeFull(Employee e)
    {
        employeeFull = e;
    }

    public List<Location> getLocations()
    {
        if (locations == null)
        {
            locations = locationDAO.getAll()
        }
        return locations;
    }

    //...
} 
```

`EmployeeDAO`包含急切加载查询的类：

```
@Named
public class EmployeeDAO
{
    @Inject
    private SessionFactory sessionFactory;

    @Transactional(readOnly = true)
    public Employee getEager(Long id)
    {
        Query q = sessionFactory.getCurrentSession().createQuery("select e from Employee e join fetch e.locations where e.id = :id");
        q.setParameter("id", id);
        try
        {
            return (Employee) q.uniqueResult();
        }
        catch (NonUniqueObjectException ex)
        {
            //Exception logging/handling
            return null;
        }
    }
} 
```

在我的 JSF 中，我有以下代码段：

```
<p:dialog dynamic="true">
    <h:form>
        <p:selectCheckboxMenu label="Locations" value="#{employeeBean.employeeFull.locations}">
            <f:selectItems var="location" itemLabel="#{location.name}" value="#{employeeBean.locations}" />
        </p:selectCheckboxMenu>

        <p:commandButton value="save" action="#{employeeBean.update}"/>
    </h:form>
</p:dialog> 
```

当我打开对话框时，它会很好地加载属性，并用s`employeeFull`填充并标记已经拥有的s 。`selectCheckboxMenu``Location``Location``Employee`

但是，当我单击保存按钮（不更改任何内容）并提交表单时，`Employee.locations`集合会出现`LazyInitializationException`：

```
09:36:42,633 WARNING [javax.enterprise.resource.webcontainer.jsf.lifecycle] (http-localhost-127.0.0.1-8080-1) failed to lazily initialize a collection, no session or session was closed: org.hibernate.LazyInitializationException: failed to lazily initialize a collection, no session or session was closed
    at org.hibernate.collection.internal.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:394) [hibernate-core-4.1.5.SP1.jar:4.1.5.SP1]
    at org.hibernate.collection.internal.AbstractPersistentCollection.throwLazyInitializationExceptionIfNotConnected(AbstractPersistentCollection.java:386) [hibernate-core-4.1.5.SP1.jar:4.1.5.SP1]
    at org.hibernate.collection.internal.AbstractPersistentCollection.initialize(AbstractPersistentCollection.java:379) [hibernate-core-4.1.5.SP1.jar:4.1.5.SP1]
    at org.hibernate.collection.internal.PersistentSet.add(PersistentSet.java:206) [hibernate-core-4.1.5.SP1.jar:4.1.5.SP1]
    at com.sun.faces.renderkit.html_basic.MenuRenderer.convertSelectManyValuesForModel(MenuRenderer.java:382) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.renderkit.html_basic.MenuRenderer.convertSelectManyValue(MenuRenderer.java:129) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.renderkit.html_basic.MenuRenderer.getConvertedValue(MenuRenderer.java:315) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at org.primefaces.component.selectcheckboxmenu.SelectCheckboxMenuRenderer.getConvertedValue(SelectCheckboxMenuRenderer.java:34) [primefaces-3.3.1.jar:]
    at javax.faces.component.UIInput.getConvertedValue(UIInput.java:1030) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIInput.validate(UIInput.java:960) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIInput.executeValidate(UIInput.java:1233) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIInput.processValidators(UIInput.java:698) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIForm.processValidators(UIForm.java:253) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at org.primefaces.component.dialog.Dialog.processValidators(Dialog.java:359) [primefaces-3.3.1.jar:]
    at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIViewRoot.processValidators(UIViewRoot.java:1172) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at com.sun.faces.lifecycle.ProcessValidationsPhase.execute(ProcessValidationsPhase.java:76) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at org.primefaces.webapp.filter.FileUploadFilter.doFilter(FileUploadFilter.java:79) [primefaces-3.3.1.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:280) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:322) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:116) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:113) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:103) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:113) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:45) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:150) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter.doFilter(DefaultLoginPageGeneratingFilter.java:91) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:182) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:184) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:155) [spring-security-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:280) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at org.springframework.orm.hibernate4.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:119) [spring-orm-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:280) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.13.Final.jar:]
    at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671) [jbossweb-7.0.13.Final.jar:]
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.13.Final.jar:]
    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_31] 
```

该`EmployeeBean.update`方法永远不会被调用，因为它上设置的断点永远不会被命中。

~~现在是大结局：我怎样才能防止这种情况发生`LazyInitializationException`。~~

**编辑**

我创建了一个解决方法，但这可能不是最好的解决方案：

在 JSF 页面中：

```
<p:dialog dynamic="true" onShow="loadSelectedEmployee()">
    <h:form>
        <p:remoteCommand action="#{employeeBean.loadSelectedEmployee}" name="loadSelectedEmployee" update=":editEmployeeDialogContent" />
    </h:form>
    <p:outputPanel layout="block" id="editEmployeeDialogContent">
        <h:form rendered="#{employeeBean.selectedEmployeeLoaded}">
            <p:selectCheckboxMenu label="Locations" value="#{employeeBean.selectedEmployee.locations}">
                <f:selectItems var="location" itemLabel="#{location.name}" value="#{employeeBean.locations}" />
            </p:selectCheckboxMenu>

            <p:commandButton value="save" action="#{employeeBean.update}"/>
        </h:form>
    </p:outputPanel>
</p:dialog> 
```

在支持 bean 中：

```
public void loadSelectedEmployee()
{
    if (!selectedEmployeeLoaded)
    {
        selectedEmployee.setLocations(locationManager
                .getByEmployee(selectedEmployee));
        selectedEmployee.setRoles(roleManager
                .getByEmployee(selectedEmployee));
        selectedEmployeeLoaded = true;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T16:15:16.157

这绝对是一个错误，我猜是在 Primefaces 或 Jboss-jsf-api-2.1 中。我可以直接在控制器中修改 PersistenSet，因此它肯定会急切地加载，但是当绑定到 JSF 组件时（我使用的是 Primefaces selectCheckboxMenu），它也会抛出 LazyInitalizationException。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T12:12:18.117

如果您对一个与标记为“eager”没有关系的实体执行 HQL，将继续使用“lazy”的品牌并尝试在“get”时查询数据。

对于这种情况，强制初始化关系的示例是：

```
Hibernate.initialize(e.getLocations()); 
```

融合的：

```
@Transactional(readOnly = true)
public Employee getEager(Long id)
{
    Query q = sessionFactory.getCurrentSession().createQuery("select e from Employee e join fetch e.locations where e.id = :id");
    q.setParameter("id", id);
    try
    {
        final Employee e = (Employee) q.uniqueResult();
        if(e != null){
            Hibernate.initialize(e.getLocations());
        }
        return e;

    }
    catch (NonUniqueObjectException ex)
    {
        //Exception logging/handling
        return null;
    }
} 
```

问候，

# php - CakePHP 数据库查询 DISTINCT / GROUP BY 错误

> ID：12149156
> 
> 赞同：1
> 
> 时间：2012-08-27T20:29:50.897
> 
> 标签：php, mysql, database, cakephp, cakephp-2.0

在我的 CakePHP 模型中，我试图从我的表中获取一些数据。
我尝试使用 DISTINCT，但似乎使用 DISTINCT 不会改变查询结果。
我可以看到许多行具有相同的**缺口**

与**'DISTINCT Mytable.nick'**

```
$this->Mytable->find('all',
    array(
        'fields'=> array(
            'DISTINCT Mytable.nick',
            'Mytable.age', 'Mytable.location',
        ),
        'conditions' => array('Mytable.id >=' => 1, 'Mytable.id <=' => 100),
        'order' => array('Mytable.id DESC')
)); 
```

与**“组 Mytable.nick”**

```
$this->Mytable->find('all',
    array(
        'fields'=> array(
            'Mytable.nick',
            'Mytable.age', 'Mytable.location',
        ),
        'conditions' => array('Mytable.id >=' => 1, 'Mytable.id <=' => 100),
        'group' => 'Mytable.nick',
        'order' => array('Mytable.id DESC')
)); 
```

与**“Mytable.nick”**

```
$this->Mytable->find('all',
    array(
    'fields'=> array(
            'Mytable.nick',
            'Mytable.age', 'Mytable.location',
    ),
    'conditions' => array('Mytable.id >=' => 1, 'Mytable.id <=' => 100),
    'order' => array('Mytable.id DESC')
)); 
```

编辑：似乎即使 CakePHP 2.1 也不能使用 DISTINCT 选项。当我尝试“GROUP BY”时，它解决了我的问题。但正如您从我的查询中看到的那样，我需要对**Mytable.id**下降的结果进行排序。当我使用 GROUP BY 时，当 Mysql 找到相关行时，它不会占用其他行。例如。

*   id=1，nick=mike，age=38，location=uk
*   id=2，nick=albert，age=60，location=usa
*   id=3，nick=ash，年龄=42，位置=uk
*   id=4，nick=albert，年龄=60，位置=new_zelland

当我使用 时`group Mytable.nick`，我没有在结果中看到第 4 行，而是看到了第 2 行。因为当mysql第二次看到“albert”时，它并没有把它放到我的结果中。但我需要最新的“阿尔伯特”结果。不可能吗？

Edit2：似乎 order by/group by 冲突是一个常见问题。[我在这个问题](https://stackoverflow.com/questions/924494/mysql-group-by-ordering)中找到了一些提示。但它为本地 Mysql 查询提供了解决方案。我需要一个 CakePHP 类型查询的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:26:31.300

不清楚为什么要按 nick 分组并按 id 排序。您是否打算使用聚合函数`COUNT()`来查看相同的缺口出现了多少次？总之，你的总体目标对我来说仍然不清楚。可能值得了解`HAVING`MySQL 关键字。

更新：好的，这更有意义。因此，您需要在条件上使用子选择，或者将其表达为连接。我将尝试使用 WHERE 子句中的子选择来展示一个示例。

```
/* select last occurrence for each nick (if you need one for each location )*/
SELECT nick, age, location
FROM myTable t1
WHERE id =
    (SELECT MAX(id) 
    FROM myTable t1
    WHERE t1.nick = t2.nick); 
```

会认为这样的事情会起作用：

```
$this->Mytable->find('all',
    array(
    'fields'=> array(
            'Mytable.nick',
            'Mytable.age', 'Mytable.location',
    ),
    'conditions' => array('Mytable.id =' => '(SELECT MAX(id) FROM myTable t2 WHERE myTable.nick = t2.nick)', 'Mytable.id <=' => 100)
)); 
```

# java - REST 重复 URL

> ID：12149158
> 
> 赞同：2
> 
> 时间：2012-08-27T20:30:08.827
> 
> 标签：java, rest, jersey

我有两个网址：

```
blah.com/workorder/{dealer_code} 
blah.com/workorder/{cust_id} 
```

这两个都根据发送的数据返回工作订单。dealer_code 和 cust_id 都是字符串数据（您无法分辨它们的区别）。

假设没有时间或方法来确定后端哪个是哪个，您将如何设计它。我有一些想法，但不想领导。此外，它可能会变得更长。如果你有这个怎么办：

```
blah.com/workorder/{dealer_code}/{id_no}/{category}
blah.com/workorder/{cust_id}/{ref_no}/{name} 
```

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:42:24.467

去查询字符串参数。

看起来您正在执行搜索，因为您不是通过其 id（主键）查找工作订单，而是通过工作订单实体中的其他字段进行搜索。

如果您通过它的 id 查找工作订单，请使用：

```
 blah.com/workorder/{id} 
```

否则使用类似的东西：

```
 blah.com/workorder?dealer_code=1&cust_id=1 
```

类似问题：[RESTful URL design for search](https://stackoverflow.com/questions/207477/restful-url-design-for-search)

# jquery - 通过单击链接打开页面时，图像不会显示

> ID：12149159
> 
> 赞同：1
> 
> 时间：2012-08-27T20:30:10.297
> 
> 标签：jquery, html, bxslider

[这](http://wearesoda.com/jjlustres/galeria/)是我的页面。

在它的底部有一个图像列表（bx-slider），当您单击链接（菜单上的画廊）时不会出现该列表，但是当您按 F5 时它会加载。

有谁知道它为什么会出现奇怪的行为？

编辑：这是解释我所说的视频： [http ://wearesoda.com/development/2012-08-28_1059.swf](http://wearesoda.com/development/2012-08-28_1059.swf)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T04:56:44.743

我在您的滑块中发现了宽度问题，单击链接后也会出现该问题...它显示**宽度为 20 像素**，而未显示

把它放在你的CSS中，然后检查

```
.bx-window{
  width:565px !important;
} 
```

图像加载和缓存问题预加载所有图像并检查....

# c++ - ifstream::open() 究竟做了什么？

> ID：12149161
> 
> 赞同：0
> 
> 时间：2012-08-27T20:30:24.323
> 
> 标签：c++, file-io, filestream, fstream

考虑这段代码：

```
ifstream filein;

filein.open("y.txt"); 
```

当我使用该`open()`功能时，会发生什么？

*   文件流本身是否被打开？

*   还是对象的状态变为打开？

*   或两者？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:34:22.587

不清楚你是想知道实现细节还是标准要求——但至于实现细节——它将调用操作系统上的底层开放系统调用。例如，在 Linux 上，这称为`open`. 在 Windows 上，它被称为`CreateFile`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T21:17:09.697

`std::ifstream`设置为拥有 a `std::filebuf`，它是派生自 的类`std::streambuf`。流缓冲区以通用方式管理流的缓冲，并抽象出如何访问流的细节。对于`std::filebuf`底层流是根据需要访问的操作系统文件。何时`std::ifstream::open()`调用此调用主要委托给`std::filebuf::open()`哪个执行实际工作。但是，如果调用成功，`std::ifstream`则将`clear()`其状态位，如果调用失败，则设置。文件缓冲区将调用系统的方法来分配文件句柄，如果成功，则安排此文件句柄在其析构函数或函数中释放 - 无论先到先得。打电话时`std::filebuf::open()``std::ios_base::failbit``std::filebuf::close()``std::ifstream::open()`使用默认参数，系统调用将检查文件是否存在、是否可访问、是否打开了太多文件句柄等。有一个`std::ios_base::openmode`参数可用于以某些方式修改行为以及调用时使用不同的标志`std::ofstream::open()`.

调用是否`std::filebuf::open()`有任何其他效果取决于实现。例如，实现可以选择获取字节序列并将它们转换为字符。由于用户可以覆盖某些设置，特别是`std::locale`（参见`std::streambuf::pubimbue()`函数），但在第一次读取之前不太可能发生很多事情。在任何情况下，打开文件本身后任何操作的结果都不会影响任何状态标志。

顺便说一句，提到的类实际上是所有模板（`std::basic_ifstream`、`std::basic_filebuf`、`std::basic_streambuf`和`std::basic_ofstream`），它们被`typedef`编入上面用于`char`作为字符类型的实例化的名称。有类似`typedef`的 s 使用`w`前缀来进行实例化`wchar_t`。有趣的是， and版本没有`typedef`s ，而且让它们实例化似乎也需要一些工作。`char16_t``char32_t`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-27T21:05:54.313

打开或关闭的文件流由它的状态表示。因此，如果您将状态更改为打开，则文件流现在已打开。就像一个门廊。如果您打开它，您已将其状态更改为打开位置。然后您可以稍后将其关闭，这涉及将其状态更改为关闭位置。将其状态更改为打开和打开流是完全相同的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-27T20:50:22.107

如果您从逻辑上思考， ifstream 只是我们将在其中获取文件内容的流。我们提供给 ifstream.open() 的参数将打开文件并将其标记为打开。当文件被标记为打开时，它将不允许您对文件执行某些操作，例如在某些程序打开文件时重命名文件。它允许您在关闭流后执行相同的操作。ifstream - imo 只是访问文件的辅助类。

# css - 如何使用 Bootstrap（或直接 CSS）实现“迷你”选择样式？

> ID：12149164
> 
> 赞同：35
> 
> 时间：2012-08-27T20:30:41.890
> 
> 标签：css, twitter-bootstrap, twitter-bootstrap-2

我正在使用 Bootstrap 的`btn-mini`“迷你”按钮类，并且正在寻找类似的东西来创建一个“迷你”选择元素，其中选择按钮（即您单击以显示选项列表的部分，而不是选项列表本身）与迷你按钮的尺寸和样式相同。

当我将`btn-mini`类应用于选择元素时，选择按钮的字体样式与迷你按钮的大小相同，但选择按钮本身的大小与默认大小没有变化。

我应该使用不同的 Bootstrap 类吗？或者另一种方式来做到这一点？

PS我正在使用OS X Chrome，但自然希望有一个跨浏览器兼容的解决方案。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-12-19T21:57:51.770

以防万一任何 Bootstrap 3 用户遇到这个老问题，这里是 BS3 方式：

```
<select class="form-control input-lg"></select>
<select class="form-control"></select>
<select class="form-control input-sm"></select>

<input class="form-control input-lg">
<input class="form-control">
<input class="form-control input-sm"> 
```

但是，没有 input-xs，因此如果您想要更小，则必须自己制作。

```
.input-xs, select.input-xs {
  height: 20px;
  line-height: 20px;
} 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-08-28T12:50:24.607

## HTML

```
<select class="btn btn-mini">
    <!-- options -->
</select>
<span class="caret"></span> 
```

## CSS

```
select.btn-mini {
    height: auto;
    line-height: 14px;
}

/* this is optional (see below) */
select.btn {
    -webkit-appearance: button;
       -moz-appearance: button;
            appearance: button;
    padding-right: 16px;
}

select.btn-mini + .caret {
    margin-left: -20px;
    margin-top: 9px;
} 
```

最后两条规则是可选的，它`<select>`看起来像`<button>`，我还添加了一个插入符号。看到这个[小提琴](http://jsfiddle.net/x3Xzs/253/)。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2017-08-17T12:47:39.350

对于**Bootstrap 4** ，我们可以使用class with来设置**高度**。`form-control-sm``form-control`

```
<select class="form-control form-control-lg">
  <option>Large select</option>
</select>
<select class="form-control">
  <option>Default select</option>
</select>
<select class="form-control form-control-sm">
  <option>Small select</option>
</select> 
```

[![在此处输入图像描述](../Images/7724939a0647cff60fa7a54909df30f2.png)](https://i.stack.imgur.com/RGA9E.png)

要设置这些的**宽度**，我们必须使用网格列类，如`.col-sm-*`, `.col-md-*`,`.col-lg-*`等。

所以将选择代码放入：

```
<div class="row">
  <div class="col-md-3">
    ... select tag code ...
  </div>
</div> 
```

它看起来像这样：

[![在此处输入图像描述](../Images/dd24ba28223b9fec646daf187ffac8c1.png)](https://i.stack.imgur.com/LeS70.png)

您可以将最后一个称为**“迷你”**选择元素。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-28T12:42:04.680

这不是最终答案，但我想与其他对此感到好奇的人分享我到目前为止所获得的信息。

正如jackwanders所建议的那样，我继续创建了一个自定义CSS类：

```
.select-mini {
  font-size: 11px;
  height: 20px;
  width: 100px;
} 
```

这`font-size`和`height`规则或多或少地使选择框与迷你按钮的大小相同，但文本并没有以相同的方式完全对齐（它略微向上移动）。请注意，您需要使用`height`not`line-height`覆盖`height`Bootstrap 在其他地方设置的选择元素的规则。（`width`规则只是改变小部件，可以是你想要的任何东西。）

我的 CSS-fu 不足以快速使迷你选择看起来与迷你按钮完全一致，而且从我可以看到选择在 CSS 方面的行为无论如何都很奇怪，但希望这对其他人有帮助. 同时，仍然对更好的答案持开放态度！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-03T11:28:47.437

根据`btn-xs`课程，我准备了这个：

```
.input-xs{
    height: 20px;
    line-height: 1.5;
    font-size: 12px;
    padding: 1px 5px;
    border-radius: 3px;
} 
```

请注意，宽度不受限制！

请检查[此小提琴](https://jsfiddle.net/yhngqvqy/)以查看它的实际效果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-25T13:20:31.473

巴甫洛的回答更好。但是当鼠标光标位于插入符号上时，单击不会起作用。只需将一件事添加到插入符类中即可修复它：

```
select.btn-mini + .caret {
    margin-left: -14px;
    margin-top: 19px;
	pointer-events: none;
}
```

# java - JavaFX 缩放图表系列单位

> ID：12149165
> 
> 赞同：0
> 
> 时间：2012-08-27T20:30:45.243
> 
> 标签：java, javafx-2

嗨，我有一个 JavaFX LineChart，我想使用不同的单位重新绘制系列，我创建一个单独的列表，使用转换因子计算新值，删除所有值并添加新值。

这很好用，只是现在第一个点连接到前一个最后一个点，该点已经被删除。

任何想法如何避免这种情况？

```
for(XYChart.Series<Number, Number> series : _chart.getData())
{
    List<XYChart.Data<Number, Number>> data = series.getData();
    List<XYChart.Data<Number, Number>> newData = 
                                  new ArrayList<XYChart.Data<Number, Number>>();
    for(XYChart.Data<Number, Number> item : data)
    {
        newData.add(new XYChart.Data<Number, Number>(
                              item.getXValue(), 
                              item.getYValue().floatValue() * conversionFactor));
    }
    series.getData().remove(0, series.getData().size() - 1);
    for(XYChart.Data<Number, Number> item : newData)
    {
        series.getData().add(item);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T14:14:52.657

首先清除数据`series.getData().clear()`。您也可以使用`ObservableList`来避免添加循环。

```
for (XYChart.Series<Number, Number> series : chart.getData()) {
    List<XYChart.Data<Number, Number>> data = series.getData();
    ObservableList<XYChart.Data<Number, Number>> newData =
            FXCollections.<XYChart.Data<Number, Number>>observableArrayList();
    for (XYChart.Data<Number, Number> item : data) {
        newData.add(new XYChart.Data<Number, Number>(
                item.getXValue(),
                item.getYValue().floatValue() * 1.1));
    }
    series.getData().clear();
    series.setData(newData);
} 
```

# mysql - mySql中的两个Dim（2-D）数组或Datatable？

> ID：12149169
> 
> 赞同：0
> 
> 时间：2012-08-27T20:31:22.137
> 
> 标签：mysql, arrays

我需要将select语句结果（多行和多列）存储在一个变量中以供以后使用，有没有办法只在mySql中做到这一点。我想在存储过程中使用它。

我知道一个 select 语句的单个结果可以很容易地存储在一个变量中，但是有没有可以存储多个行和列？

如果有。那是什么，没关系。

如果不是，那么如何在 mySql 中解决类似以下的场景？假设存在一个dataTbale，我已经编写了以下理想/所需的代码。

```
Declare dt DataTable;
set dt = select column_name,table_name from information_schema.columns
where table_schema='emp';

DECLARE i INT; DECLARE c INT; set i=0; set c=dt.Rows.Count;

  WHILE i < c
    @q = concat ('select ', dt.Rows[i][0],' from ',dt.Rows[i][1]);
    prepare s1 from @q;
    execute s1;deallocate prepare s1;
  END WHILE; 
```

每个 Row 及其两个 dt 单元格在 while 中使用。有没有二维数组或其他的设施？

正在尝试做什么？while 中的上述代码旨在显示数据库所有表中所有列（一一）的所有值

什么是问题？标题和第一个问题陈述。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:36:57.890

不要一次存储所有结果，而是使用游标：[http ://dev.mysql.com/doc/refman/5.0/en/cursors.html](http://dev.mysql.com/doc/refman/5.0/en/cursors.html)

然后在读取光标时循环。

# facebook - Facebook 应用服务器端身份验证（带有 JavaScript 客户端的 Java 服务器）

> ID：12149179
> 
> 赞同：0
> 
> 时间：2012-08-27T20:32:24.727
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

我正在开发一个将在 FB Canvas 中运行的 Facebook 应用程序。我的服务器是 Java 服务器，我在客户端使用 JavaScript。

Facebook 要求在应用程序加载时请求 (POST) 的 URL。此 URL 不应是动态 URL（以“/”结尾或包含“？”）。所以我写了一个带有 URL: 的 servlet `http://localhost:8080/myApp`，它将解析`signed_request`参数。现在我被困在如何将标记返回给客户端，然后对 FB API 执行客户端请求。有没有比这个 servlet 返回标记更优雅的方法？请注意，我无法重定向（使用 302），因为 servlet 从 iframe 运行。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T10:48:38.397

> 有没有比这个 servlet 返回标记更优雅的方法？

更“优雅”在哪方面？

您的 servlet 在这里充当 Web 服务器，并且 Web 服务器通常通过返回“标记”（HTML、CSS、JS 等）来响应 HTTP 请求——在什么时候以及如何让您的应用程序“更优雅”？

> 请注意，我无法重定向（使用 302），因为 servlet 从 iframe 运行。

您是指 Facebook 画布 iframe，还是其中的另一个 iframe？

你想重定向到哪里，为什么？

# wpf - 如何使 TreeViewItem 不可折叠

> ID：12149181
> 
> 赞同：0
> 
> 时间：2012-08-27T20:32:47.297
> 
> 标签：wpf, xaml, treeview, treeviewitem

我正在开发一个 WPF 项目，我有一个`TreeView`using `HierarchicalDataTemplates`. 我已经能够建立一些不同级别的节点。到目前为止一切进展顺利。

```
<TreeView Margin="14,14,14,14" Name="treeView" ItemsSource="{Binding Tree}"
                               BorderThickness="0">
                  <TreeView.Resources>
                    <!--
                        First Level
                    -->
                    <HierarchicalDataTemplate DataType="{x:Type vm:FirstLevelViewModel}" 
                                              ItemsSource="{Binding Children}" >
                        <StackPanel Orientation="Horizontal" >
                        <TextBlock Text="{Binding SomeText}" FontSize="14" FontWeight="Bold" Foreground="DarkBlue"  />
                        </StackPanel>                           
                    </HierarchicalDataTemplate>
                    <!--
                        Second Level
                    -->
                    <HierarchicalDataTemplate DataType="{x:Type vm:SecondLevelViewModel}" 
                                              ItemsSource="{Binding Children}" >
                            <CheckBox Name="checkBox" IsChecked="{Binding IsChecked}" IsEnabled="{Binding IsEnabled}">
                            <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{Binding SomeText}" FontSize="14" />
                            </StackPanel>
                        </CheckBox>
                    </HierarchicalDataTemplate>
. . . . 
```

我的问题是：**我需要一些节点不可折叠。**

**有没有办法做到这一点？我一直在寻找它，但没有运气。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:03:11.657

的[默认模板](https://stackoverflow.com/questions/1559261/control-template-for-existing-controls-in-wpf)`TreeViewItem`定义了一个`ToggleButton`显示和隐藏子项目的模板。您可以根据属性绑定到项目上的某个属性的模板创建自己的模板`IsEnabled`，这样可以防止它被切换，当然您还应该绑定`IsExpanded`（也可以在模板之外完成）和这种情况下的值应始终为`true`。

# ios - 如何将用于 iOS 开发的 Apple ID 转移给不同的开发者

> ID：12149188
> 
> 赞同：1
> 
> 时间：2012-08-27T20:33:18.640
> 
> 标签：ios, xcode4, iphone-developer-program

我将在本周末离开我目前的职位。我是一家小型商店的开发人员，我的 Apple ID 是我即将成为前雇主的 Apple 开发人员帐户中唯一的一个。我们在 iTunes 应用商店中确实有一个应用程序（尽管它只是一个应用程序）。所以我去了苹果开发者门户并点击了“管理我的 Apple ID”，在那里我更改了附加到 Apple ID 的名称。这样，仍然在这里工作的人可以管理可用的应用程序，我可以继续前进到更绿色的牧场。

所以我改变了信息，它确实在那里改变了，但在苹果开发门户中，它似乎仍然认为我的名字是附在苹果 ID 上的那个。我最初认为这可能只是一个单独的过程，但上周五我将其切换了。当我去撤销我的开发者证书并为新人重新生成它时，它仍然将我的名字附加到苹果 ID，即使联系信息设置为新人。

这是一家真正的小土豆店，所以我试图在我出飞机之前为任何人设置他们的开发环境。

**问题：**如何将 Apple ID 转换为新用户？新人本身并不是 iOS 开发者。他是（老实说）不太了解的主管。我感谢任何想法或建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T22:07:52.263

Apple ID 与您相关联（即您的姓名、电子邮件地址）。您无需尝试将其所有权交给其他人。他们应该已经注册并获得了自己的 Apple ID。您需要做的是将团队代理角色转换为新人。

听起来您是为公司注册 Apple 开发人员计划的人，我假设您的帐户是指定的团队代理。这个角色应该被转移给新的人，最终，你应该作为团队成员被删除。

有关如何转换代理角色的详细信息，请参见此处：

[https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/AppDistributionGuide/ManagingYourTeam/ManagingYourTeam.html](https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/AppDistributionGuide/ManagingYourTeam/ManagingYourTeam.html)

# java - Struts 2 Action 标签，检索属性

> ID：12149190
> 
> 赞同：0
> 
> 时间：2012-08-27T20:33:23.387
> 
> 标签：java, jsp, struts2, struts

如果我有一个带有转发到 JSP 的操作的典型设置，我会像这样请求我的属性：

`<s:property value="myVariable" />`

其中 myVariable 是操作中的变量。

我想在另一个页面中使用这样的操作标签：

```
<s:action name="actionName" executeResult="false"> 
    <s:param name="switch">true</s:param>
</s:action> 
```

`myVariable`使用上述操作标签时如何访问？我试过`<s:property value="myVariable" />`了，但它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T21:51:06.423

当您编写 时`<s:property value="myVariable" />`，Struts 会 `myVariable`在其“值堆栈”中查找该属性。当前操作在 ValueStack 中，这就是典型设置起作用的原因。现在，在

```
<s:action name="actionName" executeResult="false"> 
    <s:param name="switch">true</s:param>
</s:action>
<s:property value="myVariable" /> 
```

执行最后一行时，`actionName`动作已经执行，当前动作不是那个，而是主要（“外部”）一个。如果您想访问“内部”操作的属性，您有几种选择，其中两个显示在[文档](http://struts.apache.org/2.x/docs/action.html)中：

添加`var`属性，以便将执行的（内部）操作分配给变量并使用[# 语法](https://stackoverflow.com/a/11620838/277304)引用它：

```
<s:action name="actionName" var="innerAction" executeResult="false">
   <s:param name="switch">true</s:param>
</s:action>
<s:property value="#innerAction.myVariable" /> 
```

或者，在您的操作方法中，将您的属性值显式添加到某个范围（例如：属性）

```
// in your inner action: 
ServletActionContext.getRequest().setAttribute("myVariable", "blah blah");

<s:property value="#attr.myVariable" /> 
```

免责声明：我没有测试过这个

# java - 浮点缓冲区溢出异常 java

> ID：12149193
> 
> 赞同：2
> 
> 时间：2012-08-27T20:33:47.233
> 
> 标签：java, nio, lwjgl, floatbuffer

我在这里有这段代码：

```
static ByteBuffer bytes = ByteBuffer.allocateDirect(16).order(ByteOrder.nativeOrder());
static FloatBuffer matAmbientB = bytes.asFloatBuffer();
static FloatBuffer matAmbientC = bytes.asFloatBuffer();
static FloatBuffer matAmbientD = bytes.asFloatBuffer();
static FloatBuffer matAmbientE = bytes.asFloatBuffer();
static FloatBuffer matAmbientF = bytes.asFloatBuffer();
static FloatBuffer matAmbientG = bytes.asFloatBuffer();
static FloatBuffer matAmbientH = bytes.asFloatBuffer();

    private void initGL()
    { 
        matAmbientB.put(redDiffuseMaterial);
        matAmbientB.rewind();
        matAmbientC.put(whiteSpecularMaterial);
        matAmbientC.rewind();
        matAmbientD.put(greenEmissiveMaterial);
        matAmbientD.rewind();
        matAmbientE.put(whiteSpecularLight);
        matAmbientE.rewind();
        matAmbientF.put(blankMaterial);
        matAmbientF.rewind();
        matAmbientG.put(whiteDiffuseLight);
        matAmbientG.rewind();
        matAmbientH.put(blackAmbientLight);
        matAmbientH.rewind();
    }

    void light ()
    {
        glLightf(GL_LIGHT0, GL_SPECULAR, matAmbientE.get());
        glLightf(GL_LIGHT0, GL_AMBIENT, matAmbientH.get());
        glLightf(GL_LIGHT0, GL_DIFFUSE, matAmbientG.get());
    } 
```

当我尝试运行它时，我收到此错误：

```
Exception in thread "main" java.nio.BufferOverflowException
    at java.nio.DirectFloatBufferU.put(Unknown Source)
    at java.nio.FloatBuffer.put(Unknown Source)
    at src.Main.initGL(Main.java:76)
    at src.Main.run(Main.java:45)
    at src.Main.main(Main.java:232) 
```

我查看了整个互联网我找不到如何解决这个问题（我也不知道它是什么）。我的目标是将 float[] 转换为 float，但这是我知道的唯一方法。在 c++ 中有 glLightfv，但在 lwjgl 中只有 glLightf。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:27:04.613

我在其他地方找到了这个问题的答案。在我提出的方法中`(FloatBuffer)bytes.asFloatBuffer().put(lightAmbient).flip()`。这更短并且有效。

# tfs - 禁用在结帐 TFS 时获取最新信息

> ID：12149196
> 
> 赞同：5
> 
> 时间：2012-08-27T20:33:56.090
> 
> 标签：tfs

我必须将项目恢复到上周的版本。所以我按日期得到了一个特定的版本，但现在如果我在一个文件中添加一个空格，它会签出并获取最新的。

我去了工具->选项->源代码控制-> VS TFS->“结帐时获取最新版本”->未选中。

然后我转到工具-> 源代码管理设置-> “启用在签出时获取最新信息”-> 未选中。

但是这种行为仍然发生！不确定要尝试什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T20:38:19.537

我必须重新启动 Visual Studio 才能看到更改。:|

# c# - 如何将内容控件附加到列表框？

> ID：12149197
> 
> 赞同：0
> 
> 时间：2012-08-27T20:34:02.900
> 
> 标签：c#, silverlight, windows-phone-7, xaml

XAML：

```
<ListBox>
    <ListBox.ItemTemplate>
        <DataTemplate >  
            <StackPanel >
                <Grid  Width="335"  >
                    <TextBlock Text="{Binding Body}"  />
                </Grid>
            </StackPanel>
        </DataTemplate>
        <DataTemplate > 
            <StackPanel >
                <Grid  Width="335"  >
                    <Image  Source="{Binding Image}"  />
                </Grid>
            </StackPanel>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

CS：

```
public class GardenConverter : ContentControl
{
    public DataTemplate TextTemplate { get; set; }
    public DataTemplate ImageTemplate { get; set; }

    protected override void OnContentChanged(object oldContent, object newContent)
    {
        base.OnContentChanged(oldContent, newContent);
        // apply the required template

        GardenObject garden = newContent as GardenObject;
        if (garden.image == "0")
        {
            ContentTemplate = TextTemplate;
        }
        else
        {
            ContentTemplate = ImageTemplate;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T22:23:36.463

您可以尝试使用数据模板选择器。

```
public class GardenTemplateSelector : DataTemplateSelector
{
    public override DataTemplate SelectTemplate(object item, DependencyObject container)
    {
        var element = container as FrameworkElement;
        if (element != null && item != null && item is GardenObject)
        {   
            if((item as GardenObject).image == "0")
            {
                return element.FindResource("TextTemplate") as DataTemplate;            
            }
            else
            {
                return element.FindResource("ItemTemplate") as DataTemplate;            
            }           
        }

        return null;
    }
} 
```

在 XAML 中，您需要定义 TextTemplate 和 ItemTemplate。

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/system.windows.controls.datatemplateselector.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.datatemplateselector.aspx)

# java - 更改 GWT TabPanel 名称

> ID：12149199
> 
> 赞同：2
> 
> 时间：2012-08-27T20:34:08.820
> 
> 标签：java, gwt, tabpanel

我正在尝试在 GWT 中制作动态 TabPanel。我希望 TabPanel 中的文本根据用户在 TextBox 中键入的内容进行更改。例如，键入“Tab one”会将选项卡文本更改为“Tab one”。但是，我似乎找不到更改选项卡名称的方法。getTitle() 只返回标题，而不是实际文本。有谁知道如何做到这一点？

一种方法可能是删除选项卡并使用相同的内容重新创建它，但如果可能的话，我真的很想避免这种情况。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:53:59.013

好吧，“onnoweb”已经给出了正确的答案，但是这里有一个演示示例。

```
package stefank.client;

import com.google.gwt.core.client.EntryPoint;
import com.google.gwt.dom.client.Style.Unit;
import com.google.gwt.event.dom.client.ClickEvent;
import com.google.gwt.event.dom.client.ClickHandler;
import com.google.gwt.user.client.ui.Button;
import com.google.gwt.user.client.ui.HTML;
import com.google.gwt.user.client.ui.RootPanel;
import com.google.gwt.user.client.ui.TabLayoutPanel;

public class _02_GWTAnimation implements EntryPoint {

    public void onModuleLoad() {

        // Create a tab panel
        final TabLayoutPanel tabPanel = new TabLayoutPanel(2.5, Unit.EM);
        tabPanel.setHeight("100px");
        tabPanel.setAnimationDuration(1000);
        tabPanel.getElement().getStyle().setMarginBottom(10.0, Unit.PX);

        // Add a home tab
        String[] tabTitles = {"hello", "world"};
        HTML homeText = new HTML("Lorem ipsum");
        tabPanel.add(homeText, tabTitles[0]);

        // Add a tab
        HTML moreInfo = new HTML("Lorem ipsum");
        tabPanel.add(moreInfo, tabTitles[1]);

        // Return the content
        tabPanel.selectTab(0);
        tabPanel.ensureDebugId("cwTabPanel");

        RootPanel.get().add(tabPanel);

        Button changeText = new Button("change Text");
        changeText.addClickHandler(new ClickHandler() {

            @Override
            public void onClick(ClickEvent event) {
                tabPanel.setTabText(0, "new Title");                
            }
        });
        RootPanel.get().add(changeText);

    }
} 
```

# java - GWT PushButton ClickHandler 在点击后需要鼠标移动

> ID：12149200
> 
> 赞同：3
> 
> 时间：2012-08-27T20:34:12.760
> 
> 标签：java, gwt

我正在构建 2 列按钮，升级到 GWT 2.4.0 后，我的点击事件出现问题。

在 PC 上单击按钮后，您必须移动鼠标位置才能触发事件。在 iPad 上，必须再次按下该按钮。

```
int rows = (int) Math.ceil( (double)alphaLettersList.size() / 2);

Grid toolbarGrid = new Grid(rows, 2);

int numRows = toolbarGrid.getRowCount();
int numColumns = toolbarGrid.getColumnCount();

int i = 0;
for (int col = 0; col < numColumns; col++) {
    for (int row = 0; row < numRows; row++) {
        if (i < alphaLettersList.size()) {
            final String letter = (String) alphaLettersList.get(i).toUpperCase();

            PushButton letterButton = new PushButton();
            letterButton.setHTML("<div class='googleLetterBtn'>"+letter+"</div>");

            letterButton.addClickHandler(new ClickHandler() {
                public void onClick(ClickEvent event) {
                    LocalSurveyManager2.getInstance().getArticlesForLetter(letter,     RoomPanelArticleForLetterListener.getInstance());                            
            }
            });                 

            toolbarGrid.setWidget(row, col, letterButton);
        }
        i++;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T13:08:50.093

我通过使用 MouseDownHandler 和 TouchStartHandler 而不是 ClickHandler 解决了这个问题。

# android - 使用 Eclipse IDE 编辑 Launcher2.apk（在 android 4.1 中）

> ID：12149201
> 
> 赞同：1
> 
> 时间：2012-08-27T20:34:14.290
> 
> 标签：android, eclipse

我用**谷歌搜索**、询问、搜索、做了所有事情，但我没有足够的关于我的问题的信息。这里是：我正在做一个项目。对于这个项目，我必须在应用程序和小部件选项卡旁边的启动器顶部**添加一个选项卡面板（称为教育）。**[在这里](http://fs02.androidpit.info/ass/x97/6294097-1342709440417.jpg)你可以看到。但我是初学者，网上什么都**没有**。任何文件、视频等。是的，你可以说“有太多但你看不到”。但是所有这些文档都是关于 4.0 ICS 或 2.2

我需要有关 android 4.1 JB 的信息。这正是我的问题：我已经下载了所有 sdk 文件，并且我确定我将 adt 包含在 eclipse 中（因为启用了一些选项）但即使我看不到创建新的 android 项目选项。

第二个问题：我包含了launcher2文件（我从原始源文件中得到它）但是eclipse显示了太多错误。它们不可能是真正的错误，因为“Launcher2.apk”是您知道的 Android 4.1 JB 上的工作文件 :)

是的，请帮助我编辑**Android 4.1 JB**的启动器以添加新的选项卡面板。谢谢。。（对不起，我的英语和经验不足）

（图片在这里。看看）

![错误](../Images/242cc7f5bfae4634b12fe7bfc1a799e7.png) ![新的安卓项目](../Images/e546c7b9616150d85969967792bb86be.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:44:31.503

新的 Android 项目现在称为“Android 应用程序项目”

如果您有 Launcher2 的源代码，则只需转到`File->Import->Android->Existing Android Project into workspace`. 如果您还没有设置“自动构建”，那么您可能需要运行 Clean and Build。

* * *

**编辑：**

好的，在查看了您的图像并进行了更多研究之后，我需要您为我检查一下。

1.  打开`FocusHelper.java`
2.  查看顶部的所有导入语句。
3.  如果您看到任何内容，请`import android.R`删除该行。
4.  保存文件，看看是否可以消除您遇到的一些错误。
5.  如果可行，那么您需要进入每个错误抛出文件并重复步骤 2 和 3。

我之前遇到过这个问题，并且执行这些步骤为我解决了这个问题。[这似乎是一个常见的 Eclipse 错误](https://stackoverflow.com/questions/885009/r-cannot-be-resolved-android-error?page=1&tab=votes#tab-top)

*此外，您的 SDK 版本设置为 Android 4.0 API 14，但根据我在`Advanceable`课堂上阅读的内容，您需要 API 级别 16，即 4.1。*

* * *

**编辑2：**

当我尝试这样做时，我发现有很多丢失的声明，你必须通过并声明自己，还有没有找到的导入引用，你必须找到它们并将它们导入到你的项目并相应地引用它们或删除它们并使用功能稍差的启动器。[看看这个答案](https://stackoverflow.com/a/8668334/1134705)。

首先，我发现当您最初导入项目时，如果 a`R.java`没有在`gen/com.android.launcher/`包中自动生成，那么只需在您的文件夹中创建一个 XML 虚拟文件`res/values/`（您很可能在`res`文件夹中的任何位置执行此操作）它会然后`R.java`在该点生成一个，然后删除该文件。您**将**需要该`import com.android.launcher.R;`行，但此时您应该看到很多错误已清除，假设您的设置设置为“自动构建”。一旦完成，然后双击每个错误行，它将带您到该错误，您可以通过声明变量（并在大多数情况下初始化它们，如果不是所有情况）来修复，按`CTRL+SHIFT+O`，删除`@Override`等。你不会拥有所有的功能，但一旦完成，你就会有一些东西可以使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T03:22:31.017

您将无法使用 Android SDK 构建 Launcher，因为它使用了一些私有 API（您看到的错误）。

# android - Android：AsyncTask 和 UI 线程上的通信错误

> ID：12149208
> 
> 赞同：0
> 
> 时间：2012-08-27T20:34:34.857
> 
> 标签：android, exception, android-asynctask

我正在使用 Android [AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)从网络上获取一些数据。它是一个从 random.org 获取字节并显示字节的简单程序（“破解我”）。该程序还固定 random.org 的公钥来检测拦截代理。

我已经实现`onPreExecute`,`doInBackground`和`onPostExecute`. 当“一切顺利”时，需要这些方法。当出现问题时`doInBackground`，我无法显示，`AlertDialog`因为它不是 UI 线程。该接口还缺少`onError`在 UI 线程上执行的或类似的方法。

使用此类时如何传达错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:41:04.107

My suggestion is create field in your AsyncTask class. If something gonna wrong put there some exception throwed:

```
class SomeAsyncTask<..> extends AsyncTask<..> {
    Exception exception = null;
    public doInBackground(...) {
        try {
            . . . 
        } catch (Exception ex) {
            exception = ex;
        }
    }

    public onPostExecute(...) {
        if (exception != null) {
            // process exception on UI thread
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T20:41:39.223

I catch the error in the `doInBackground`, save the `Exception` in a field variable and check in `onPostExecute` if an error occurred:

```
private Exception exception = null;

protected Void doInBackground(Void... params){
    try{
        doStuff();
    } catch (Exception ex){
        exception = ex;
    }

    return null;
}

protected void onPostExecute(Void result){
    if(exception != null){
        showException(exception);
    }
} 
```

You could easily create your own interface using this code, and then implement the `doStuff` and `showException` methods when using it.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T20:41:20.633

You should return any information needed to onPostExecute() and show your dialog there. Or you can store it locally as a member of an AsyncTask subclass.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T21:55:45.833

不，只需在 AsyncTask 中发出广播并在您喜欢的任何地方处理广播。AsyncTask 只需要一个 Context 来发出它，您可以将它传递给它。可能希望作为粘性广播发布，以便您可以恢复它。

# android - 安卓和 SQLite

> ID：12149212
> 
> 赞同：1
> 
> 时间：2012-08-27T20:34:55.497
> 
> 标签：android, database, eclipse, sqlite

> **可能重复：**
> [如何将现有数据库与 Android 应用程序一起使用](https://stackoverflow.com/questions/9109438/how-to-use-existing-database-with-android-app)

我和一个朋友正在努力解决这个问题。他在 SQLite 中创建了一个数据库，我们正试图弄清楚如何基本上将该数据库放入我们创建的 Android 应用程序中，而无需在 Eclipse 中从头开始创建一个。我观看了有关如何从头开始创建数据库的教程视频，但既然他已经制作了一个，那么如何导入它呢？还有人知道关于 SQLite + eclipse 的任何好的教程吗？谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:39:16.967

试试这个。它对我有用。=]

它唯一没有告诉您的是，如果您更改了随应用程序提供的数据库，您必须重命名它或将其删除并将其重新插入您的资产文件夹。

不知道为什么会这样，但是如果您不这样做，它将继续读取旧数据库而不是更新的数据库。

[http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)

如果您必须在 Google Play 上更新您的应用，请按照以下链接中的说明进行操作：http: [//support.andromo.com/kb/distributing/how-to-update-your-app-in-google-play](http://support.andromo.com/kb/distributing/how-to-update-your-app-in-google-play)

# c - "printf" 不会立即打印字符串

> ID：12149217
> 
> 赞同：4
> 
> 时间：2012-08-27T20:35:21.060
> 
> 标签：c, printf

> **可能重复：**
> [为什么 printf 在调用后不刷新，除非换行符在格式字符串中？（在 C 中）](https://stackoverflow.com/questions/1716296/why-does-printf-not-flush-after-the-call-unless-a-newline-is-in-the-format-strin)

我有这样的代码：

```
printf("Starting nets allocation...");
while(...)
{
    ...some operations...
}
puts("DONE"); 
```

代码应立即打印字符串“Starting nets allocation...”，然后在循环之后打印“DONE”。

相反，程序首先执行循环，然后打印字符串“Starting nets allocation...DONE”为什么会发生？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-27T20:36:17.250

默认情况下，输出流`stdout`是缓冲的，所以如果你想要立即输出，你需要刷新输出流 - 使用`fflush`- 或在以下位置打印换行符`printf`：

```
printf("Starting nets allocation...");
fflush(stdout); 
```

或者：

```
printf("Starting nets allocation...\n"); 
```

请注意，您还可以使用`setbuf`stdio.h 中的函数在文件指针级别控制缓冲：

```
setbuf(stdout, NULL); 
```

to的第二个参数`setbuf`是调用者提供的缓冲区，用于缓冲输出到流。传递 NULL 表示要禁用缓冲，等效于：

```
setvbuf(stdout, NULL, _IONBF, 0); 
```

这也会禁用对指定流的缓冲。

请参阅`setbuf` [此处](http://en.cppreference.com/w/c/io/setbuf)的文档。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T20:37:12.483

输出到`stdout`被缓冲，所以添加

```
fflush(stdout); 
```

在`printf`调用刷新内容之后。通常添加换行符也会刷新缓冲区，但在您的情况下可能不希望这样做。

# mysql - 选择所有字段包含以逗号分隔的字符串

> ID：12149218
> 
> 赞同：1
> 
> 时间：2012-08-27T20:35:23.010
> 
> 标签：mysql

我有一个名为“标签”的字段，其中包含一个以逗号分隔的标签列表，例如：

```
ios, ios development, freelance, new_project 
```

我想查询该字段以检查值“ios”是否在逗号分隔列表中。请你能告诉我我该怎么做吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T20:38:28.803

使用 MySQL，您可以使用`FIND_IN_SET()`：

```
SELECT * FROM mytable WHERE FIND_IN_SET('ios ', tags) > 0; 
```

[http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set)

请注意，`FIND_IN_SET`期望字符串以*逗号*分隔，而不是*逗号和空格*分隔。所以你可能对最后一个标签有问题。真正最好的方法是*规范化表格*；否则，您可能会从列中删除空格`tags`；最后，您可以通过在列中添加空格来解决此问题`tags`：

```
SELECT * FROM mytable WHERE FIND_IN_SET('ios ', CONCAT(tags,' ')) > 0; 
```

如果标签数量有限，您可以考虑将列转换为`SET`. 这将大大提高效率。

**更新**

除了我*弄错*了空格。它们*在*弦之前而不是之后。

所以：

```
SELECT * FROM mytable WHERE FIND_IN_SET(' ios', CONCAT(' ', tags)) > 0; 
```

但同样，摆脱那些空间 - 它们只不过是麻烦:-)

**更新 2**

上面的工作，好的。但是，这几乎就是你能说的对我有利的全部。该解决方案不仅效率非常*低，而且还使系统几乎无法维护（去过那里，做过那个，得到了 T 恤和下面的一个被咀嚼过的屁股）。所以我现在要强调一下规范化，即至少还有这两个表：

```
CREATE TABLE tags ( id      INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
                    tagName varchar(32) // I'm a bit of a cheapskate
);
CREATE TABLE has_tag ( tableid INTEGER, tagid INTEGER ); 
```

这个好多少？让我来计算一下。

*   您可以轻松添加更灵活的查询（“在 iOS、C++、...中具有所有标签”或“其中至少具有三个标签：（iOS、Python、SQL、.NET、Haskell）”。是的，您可以这有`FIND_IN_SET`，但相信我，你*不会喜欢它*。
*   您有一个*受控的标签字典*，它使您能够检查是否已知任何标签（以及轻松生成下拉组合框等列表，或者——有人说'jQuery Autocomplete'吗？）。
*   节省一些磁盘空间（标签只写一次）
*   搜索*速度很快*。如果您已经知道要查找的标签并将它们预编译为标签 ID，它们会在运行时在人行道上留下 SQL 橡胶焦痕（索引搜索*整*数值！）。并且不会编译的标签将*不存在*，您甚至在搜索开始之前就会知道这一点。
*   更容易重命名标签
*   可以容纳*任意数量*的标签（您有可能迟早会将某些标签截断为“iOS Developm”......）

我相信“CSV 字段”在*SQL 反模式*（[http://pragprog.com/book/bksqla/sql-antipatterns](http://pragprog.com/book/bksqla/sql-antipatterns)）中被审查（或），这是有充分理由的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:36:59.303

这是一个适用于逗号分隔列表的简单方法：

```
select *
  from mytable
 where concat(', ', tags, ',') like concat(', %ios%,') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T20:37:16.610

第一个（简单）：

```
WHERE tags LIKE '%ios,%' 
```

# html - IE9中浮动图像扭曲无序列表

> ID：12149222
> 
> 赞同：0
> 
> 时间：2012-08-27T20:35:31.830
> 
> 标签：html, css, internet-explorer-9, css-float, html-lists

代码在这里：[删除] 如果您注意到页面中心的 3 个内容框，它们都有一个向左浮动的图像，其中 2 个也有一个无序列表。在 chrome/ff 中，无序列表正确地移动到浮动图像的右侧，但在 IE9 中，图像似乎扩展了列表宽度，将项目符号推到了框的左侧。我已经尝试了我能想到的一切并且没有任何运气，非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:58:59.013

IE9 不知道如何正确放置列表项位置，请使用：

```
li{list-style-position: inside;} 
```

在带有浮动图像的 div 内的列表上。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:43:23.313

检查你的html。有`<p>`没有关闭的标签。我目前无法在 ie9 中实时编辑您的页面，但这可能是问题所在。

编辑：但它不是。如果您手动设置`<li>`元素的宽度，它会起作用，但这意味着编辑图像的填充（您不希望这样做，因为它在非浏览器中看起来会有所不同）。它实际上在ie9的“兼容模式”中是正确的..

# c# - 寻找一个很好的资源来学习将 CUDA 与 C# 一起使用

> ID：12149223
> 
> 赞同：2
> 
> 时间：2012-08-27T20:35:33.867
> 
> 标签：c#, visual-studio-2010, cuda

我想开始使用 CUDA。我的编程环境是VS 2010，C#.Net 4.0。已下载 CUDA SDK 和最新驱动程序。我花了几个小时寻找资源来学习如何建立联系；但是有很多选项和关于它们中的每一个的信息很少：GPU.NET、Cloo、OpenTK、Cudafy 等，并且无法确定哪个更可靠或更流行。

最终我会在一个商业项目中使用它，所以我尽量远离那些在一段时间后就死掉的开源项目，并且它们周围没有很好的支持和可靠性保证。

如果有人能提供一些关于哪个工具更成熟和可靠的信息，我将不胜感激，并指导我获取一些资源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:48:40.913

Cudafy 似乎很好地覆盖了基础。我不熟悉你提到的其他项目。我最初也想从舒适的 C# 开始 CUDA 开发，但最终放弃了使用 NVidia CUDA 工具包在 C++ 中使用 CUDA。

您有足够的新概念来学习核心 CUDA 本身。在此之上添加第三方层只会增加概念上的负载。我建议首先按照自己的术语学习 CUDA（在 C++ 中），然后一旦您精通核心 CUDA，您就可以查看 .NET 层并评估每个层为您所考虑的应用程序公开核心 CUDA 的程度。

# asp.net - asp:menu : 当页面加载不同样式时需要显示子菜单项

> ID：12149224
> 
> 赞同：2
> 
> 时间：2012-08-27T20:35:35.840
> 
> 标签：asp.net, css, menu, submenu, aspmenu

```
 <asp:SiteMapDataSource runat="server" ID="RelativeSiteMapDataSource" StartFromCurrentNode="False"
    ShowStartingNode="False" SiteMapProvider="CatalogSiteMap" />

<asp:Menu runat="server" ID="Navigator" MaximumDynamicDisplayLevels="0" StaticDisplayLevels="2" 
    Orientation="Vertical" DataSourceID="RelativeSiteMapDataSource"   /> 
```

我在几个 ASPX 页面中有上面的代码。

我想要做的是在页面加载时显示所有子菜单项，并且应该有某种缩进来显示菜单项的层次结构。上面的代码当前在单击其父菜单项时会打开子菜单（例如，当我单击产品菜单时，它会显示它的子菜单）。

PS：由于我是新用户，因此不允许附加图像。但我已经展示了我希望如何在下面显示菜单，请提出建议。

产品

*   有存货
*   缺货

订单

*   订单
*   销售订单
    *   延期交货
    *   发票订单

文件

*   购买
*   发票

**更新 1：**目前使用上述代码，加载页面时不会显示所有菜单项（和子菜单项）。所以我首先想调整 asp:menu 以获取所有菜单项，然后我想应用 CSS（与 asp:menu 一起）来显示上述方式。

**更新 2：**这是菜单的样子（取自查看源代码）。

产品订单文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T02:55:29.373

在 asp:menu 源代码（aspx 页面）中，只需设置两个属性，即：`RenderingMode ="List"`和`StaticDisplayLevels="3"`，我创建了您希望在页面加载时显示的相同菜单。现在，您可以将 css 应用到所有这些简单的项目符号列表中。

# css - 为新手使用 CSS 预处理器

> ID：12149226
> 
> 赞同：4
> 
> 时间：2012-08-27T20:35:40.823
> 
> 标签：css

我是制作 CSS 的新手，在尝试保持它的组织性时我觉得有点不方便。我的 CSS 现在大约有 800 行，并且变得越来越大。我知道这对技术熟练的人来说不是一项具有挑战性的任务，但对我来说却是。在寻找有关组织 CSS 的好建议时，我开始了解 CSS 预处理器系统，例如 LESS、SCSS (SASS)。

所以问题是：对于像我这样的新手来说，这是一种使用它们的好方法吗？或者最好开发制作标准 CSS 的技能，然后才（了解了那里的所有困难和技巧）将头转向预处理器系统？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:53:00.883

一定要从头开始学习如何做。稍后您的“外部工具包”会有所帮助。否则你最终会得到一个拐杖。那是因为除了必须使用其他人的代码而无法选择您最喜欢的工具之外，没有其他原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T21:06:31.623

我希望我早点知道预处理器。尽管如此，当我开始使用预处理器时，对 CSS 的了解还是很有帮助的。我会想办法打破你现在的 CSS，当你觉得有点舒服时，从 LESS 的变量和嵌套开始。

如果可以将 CSS 分解为易于分离的元素，请尝试将它们分成多个文件，然后组合/缩小以进行最终版本构建。

# sass - Octopress，更改主题中的样式表

> ID：12149227
> 
> 赞同：4
> 
> 时间：2012-08-27T20:35:46.253
> 
> 标签：sass, octopress

我正在使用 Octopress，我想更改我的样式表。它在一个名为“斜线”的主题中

我打了

```
rake watch 
```

然后转到 .themes/mytheme/sass/parts/_syntax.scss 并更改了一些代码。

但看起来我收到了消息：

```
unchanged sass/screen.scss 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T15:33:02.467

如果要添加或覆盖样式，请编辑`sass/custom/_styles.scss`. 此样式表是最后导入的，因此您可以使用级联覆盖样式。[更多信息](http://octopress.org/docs/theme/styles/)

# rspec - RSpec：方法内部外部对象的存根方法调用

> ID：12149228
> 
> 赞同：5
> 
> 时间：2012-08-27T20:35:59.927
> 
> 标签：rspec, mocking, stub

我试图在方法中存根方法的行为：

```
class A
  def method_one(an_argument)
  begin
    external_obj = ExternalThing.new
    result = external_obj.ext_method(an_argument)
  rescue Exception => e
    logger.info(e.message)
  end
  end
end 
```

规格：

```
it "should raise an Exception when passed a bad argument" do
  a = A.new
  external_mock = mock('external_obj')
  external_mock.stub(:ext_method).and_raise(Exception)
  expect { a.method_one("bad") }.to raise_exception
end 
```

但是，永远不会引发异常。

我也试过：

```
it "should raise an Exception when passed a bad argument" do
  a = A.new
  a.stub(:ext_method).and_raise(Exception)
  expect { a.method_one("bad") }.to raise_exception
end 
```

这也不起作用。在这种情况下，如何正确地存根外部方法以强制异常？

提前感谢您的任何想法！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T21:45:16.007

您必须存根的类方法`new`并`ExternalThing`使其返回模拟：

```
it "should raise an Exception when passed a bad argument" do
  a = A.new
  external_obj = mock('external_obj')
  ExternalThing.stub(:new) { external_obj }
  external_obj.should_receive(:ext_method).and_raise(Exception)
  expect { a.method_one("bad") }.to raise_exception
end 
```

请注意，此解决方案在 rspec 3 中已弃用。对于未在 rspec 3 中弃用的解决方案，请参阅[rspec 3 - stub a class method](https://stackoverflow.com/questions/25066699/rspec-3-stub-a-class-method)。

# javascript - 检查元素是否被点击或 hasClass

> ID：12149231
> 
> 赞同：3
> 
> 时间：2012-08-27T20:36:16.983
> 
> 标签：javascript, jquery

我想知道是否有可能在 jQuery 中知道一个元素是否被点击或 hasClass()

这是我尝试过但没有成功的方法

```
if($('.subCat span[data-value="all"]').hasClass('checked') || $('.subCat span[data-value="all"]').click()){
        alert('woohoo');
    } 
```

那么我该如何实现呢？我需要在单击时执行脚本，或者如果它具有所需的类。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:39:05.587

你需要的是一个点击事件，而不是一个 if 语句。

```
$('.subCat').on("click", 'span[data-value="all"].checked', function(){
    alert("woohoo foobar");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:40:16.697

要判断它是否被点击，您需要添加一个事件处理程序

```
$(document).on("click",'.subCat span[data-value="all"]', function(){
    alert("I was clicked");
}); 
```

没有事件可以告诉您它是否是必修课。如果您想检查页面何时加载，您可以这样做。

```
$( function() {
    $('.subCat span[data-value="all"]').filter('.checked').each( function(){
        alert("I have a checked class at ready");
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T20:42:48.177

如果您需要该功能在单击时以及最初为具有选中类的元素运行，我建议这样做：

```
function doStuff() {
    alert('woohoo');
}

$(document).ready(function() {
    // This will wire up a click event. When the matching elements are clicked,
    // the doStuff function will run.
    $('.subCat span[data-value="all"]').click(doStuff);

    // This will call the doStuff function for every matched element on the
    // document ready.
    $.each($('.subCat span[data-value="all"].checked'), function(index, value) {
        doStuff();
    });
}); 
```

# sql - 跨数据库表？

> ID：12149232
> 
> 赞同：1
> 
> 时间：2012-08-27T20:36:17.407
> 
> 标签：sql, sql-server-2008

我有一个相对较大的数据库应用程序，它有一个用户表，其中包含每个员工的记录。

我有另一个很小的数据库，它记录了一名员工参加的所有教育课程。这个数据库实际上只是从遗留应用程序迁移的少数表，现在是独立的。

除了用户之外，这两个应用程序没有任何共同点。

将较小的数据库表简单地导入到较大的数据库中并更新应用程序是“最好的”，还是可以访问/使用较大数据库中的用户表？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:40:51.547

Assuming the small database will never write to the large one, I would set up a view on the small DB that provides the exact info you need. If both db's are hosted on the same server, the view can select from the large db by specifying the full name of the table (server.database.schema.table), assuming the user has the appropriate access rights. If they are on separate database servers, you will also need to setup a linked database.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T13:10:38.850

在多个应用程序之间共享数据库并不少见。假设没有名称冲突并且只有 20 个小表，我建议将较小的 db 表导入到较大的表中。

无需担心依赖数据库（或链接服务器）的管理和故障排除以及可能出现的所有安全和维护问题（以及完整性！），您可以拥有一个数据库并缓解大多数潜在问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T20:38:49.910

您*可以*使用完全限定名称访问另一个数据库（在同一服务器中）中的表：

```
<database name>.<schema>.<table name> 
```

您需要确保使用的登录名具有正确的权限。

使用[链接服务器](http://msdn.microsoft.com/en-us/library/ms188279.aspx)，您还可以访问不同服务器上的数据库。

您必须记住，这会将一个数据库耦合到另一个数据库——这是否可以取决于数据库、应用程序以及它们的使用方式。

# javascript - 在 Javascript 中连接动态变量名

> ID：12149233
> 
> 赞同：10
> 
> 时间：2012-08-27T20:36:19.233
> 
> 标签：javascript, variables

在 PHP 中，您可以像这样连接变量名

```
$a = 1

${'fruit_' . $a} = 'apple'; 
```

结果将导致创建变量`$fruit_a`

我将如何在 javascript 中执行此操作？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-27T20:42:41.753

不确定您要完成什么，但使用 JavaScript，您可以使用以下内容：

```
> var a = 1;
> var b = {};
> b['fruit_' + a] = 'apple';
> b.fruit_1
"apple"
> b['fruit_1']
"apple" 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-27T20:44:38.413

您可以通过将变量分配给上下文来做到这一点。例如，要在浏览器上下文中创建动态命名的全局变量，您可以使用：

```
const a = 1
window['fruit_' + a] = 'apple'

console.log(fruit_1) 
```

如果您在 Node 上下文中，您将使用`global`而不是`window`. 如果您尝试在方法上下文中创建变量，您将使用`this`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-04T13:57:01.830

我遇到了同样的情况，然后我使用 switch case 来管理具有这样序列号的变量列表。

```
var url = 'stackoverflow.com/questions/12149233/concatenate-a-dynamic/variable-name-in-javascript';
var splittedu = url.substring(url.lastIndexOf('/')+1);
var subsections = splittedu.split("/");

for(let i=1; i<subsections.length-1; i++){
  switch(i) {
    case 1:
      subsection1 = subsections[i];
      break;
    case 2:
      subsection2 = subsections[i];
      break;
    case 3:
      subsection3 = subsections[i];
      break;
    case 4:
      subsection4 = subsections[i];
      break;
 }
```

# jquery - 如何使用 jQuery 选择器链接来选择文件

> ID：12149234
> 
> 赞同：0
> 
> 时间：2012-08-27T20:36:21.813
> 
> 标签：jquery

我整个早上都在为此苦苦挣扎，是时候寻求帮助了。

为了回收屏幕空间并整理 UI，我必须替换老式的 HTML：

```
<input type="file" name="upload">
<input type="button" value="Submit"> 
```

在页面上占用较少空间的内容，例如：

```
<p id="picfile">Choose your file</p>
<input type="hidden" name="userfile"> 
```

这个想法是脚本（JQuery？）将接收点击事件，方便用户选择文件，并管理将该文件上传到网络服务器。

哪位好心人请指点我正确的方向，或者至少建议一个比“文件”或“文件选择器”或“jquery选择文件”更好的搜索字符串......如果只有一个高度可搜索的技术名称这个活动。

我找到了一个声称可以做到这一点的 jQuery 插件，但文档并不是最好的。我什至无法采用他们的工作示例并复制它。[http://www.daimi.au.dk/~u061768/file-input.html](http://www.daimi.au.dk/~u061768/file-input.html)

谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-27T20:48:37.827

use "custom file input jquery" and you will find a lot, for example:

*   [http://filamentgroup.com/lab/jquery_custom_file_input_book_designing_with_progressive_enhancement/](http://filamentgroup.com/lab/jquery_custom_file_input_book_designing_with_progressive_enhancement/)

*   [http://archive.plugins.jquery.com/project/custom-file](http://archive.plugins.jquery.com/project/custom-file)

*   [http://www.quirksmode.org/dom/inputfile.html](http://www.quirksmode.org/dom/inputfile.html)

# iphone - iOS5 Twitter api在一个请求中获取所有关注者的详细信息？

> ID：12149238
> 
> 赞同：3
> 
> 时间：2012-08-27T20:36:49.980
> 
> 标签：iphone, ios, ios5, twitter

我是 Twitter API 的新手，但已经多次使用 Facebook API。在 Facebook API 中，可以获取所有当前用户好友的列表，其中包含他们的姓名、Thumb Url、Facebook Id 等。

我似乎在 Twitter API 中找不到类似的方法。

我可以使用以下方法获取所有当前用户、朋友 ID（最多 5000 个）的列表：

[https://api.twitter.com/1/followers/ids.json?adc=phone&cursor=-1&id=myuser&stringify_ids=true](https://api.twitter.com/1/followers/ids.json?adc=phone&cursor=-1&id=myuser&stringify_ids=true)

然后查找它们（一次最多 100 个）以获取详细信息，但对于一项非常微不足道的任务来说，这似乎过于复杂和耗时。

真的是这样吗？- 有什么想法或建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:30:11.543

我最终使用了两个电话。似乎有一个单一的调用来获取所有关注者和一些关于他们的详细信息，但这个调用被认为是过时的，并将在 2012 年秋季删除。

# php - 希望 2 台本地机器充当客户端和服务器机器

> ID：12149239
> 
> 赞同：0
> 
> 时间：2012-08-27T20:36:50.543
> 
> 标签：php, apache, networking, virtual-machine

我的 Mac 上有一个 Windows 虚拟机。我的 Mac 上有 apache 网络服务器。我的虚拟机使用与我的 mac 相同的网络，所以我想要做的是能够通过我的 windows 虚拟机访问我的 mac webservice。

这是因为我想在 IE 上测试我的应用程序。所以我的问题是这个...

如何设置我的 windows 虚拟机以调用 mac webservice，以便我的 mac 可以处理请求。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:41:46.773

在 Windows 虚拟机上不需要配置，Web 服务通过 tcp/ip 协议工作，并且（MAC 和 Windows）都支持它。

**尝试以编程方式或直接从 Windows 上的浏览​​器调用您的 Web 服务。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T06:35:40.747

如果您将虚拟机的网络设置为 NAT，那么它们将具有不同的 IP，您可以连接到 mac。我不确定你是否可以在桥接中做到这一点。

请记住，mac 不等于 IP。

总的来说，我认为你想多了。

# c - 未声明的变量交叉 C 链接器或编译器

> ID：12149242
> 
> 赞同：1
> 
> 时间：2012-08-27T20:36:54.830
> 
> 标签：c, compilation, embedded, arm, freertos

我正在尝试使用自己的 Makefile 和链接器文件运行 freeRTOS。问题是当我试图用 3 个文件编译项目时：

```
 tasks.c:1614:6: error: 'ulTIM6_OverflowCount' undeclared (first use in this function) 
```

task.c - 有问题：

```
 void vTaskGetRunTimeStats( signed char *pcWriteBuffer )
{
unsigned portBASE_TYPE uxQueue;
unsigned long ulTotalRunTime;

    /* This is a VERY costly function that should be used for debug only.
    It leaves interrupts disabled for a LONG time. */

    vTaskSuspendAll();
    {
        #ifdef portALT_GET_RUN_TIME_COUNTER_VALUE
[1355]      portALT_GET_RUN_TIME_COUNTER_VALUE( ulTotalRunTime );
        #else ... 
```

文件中的宏端口ALT_GEN_RUN_TIME_COUNTER_VALUE()

FreeRTOSConfig.h

```
 #define portALT_GET_RUN_TIME_COUNTER_VALUE( ulCountValue )                                            \
{                                                                                       \
    TIM_Cmd( TIM6, DISABLE );                                                           \
    ulCountValue = ( ( ulTIM6_OverflowCount << 16UL ) | ( unsigned long ) TIM6->CNT );  \
    TIM_Cmd( TIM6, ENABLE );                                                            \
}
    #endif /* FREERTOS_CONFIG_H */ 
```

最后是我要编译的 main.c 女巫：

```
 #include "FreeRTOSConfig.h"
    #include "task.h"
    //problematic variable
    unsigned long ulTIM6_OverflowCount = 0UL;

    void main( void )
    {
        for( ;; );
    } 
```

错误前的编译器操作：

```
 Compiling file: ./system_and_ST_code/STM32L1xx_StdPeriph_Driver/src/misc.c
     /home/grochu/arm/arm-none-eabi-gcc-4_6/bin/arm-none-eabi-gcc -c -mcpu=cortex-m3 -         mthumb -O0 -ffunction-sections -fdata-sections -Wall -Wstrict-prototypes -Wextra -std=gnu89 -g -ggdb3 -fverbose-asm -Wa,-ahlms=out/misc.lst -DSTM32L1XX_MD -MD -MP -MF out/misc.d -I.  -I./  -I./include  -I./portable/GCC/ARM_CM3  -I./Common/include  -I./system_and_ST_code/CMSIS/CM3/DeviceSupport/ST/STM32L1xx  -I./system_and_ST_code  -I./system_and_ST_code/STM32L152_EVAL  -I./system_and_ST_code/STM32L1xx_StdPeriph_Driver/inc  -I./system_and_ST_code/Common  -I./system_and_ST_code/CMSIS/CM3/CoreSupport ./system_and_ST_code/STM32L1xx_StdPeriph_Driver/src/misc.c -o out/misc.o 
```

在我看来，变量：ulTIM6_OverflowCount 应该是全局的，并且在文件 task.c 中可见这是来自 freeRTOS 项目的示例，我从女巫那里删除了几乎所有代码，但它是 IAR 专用的，没有 makefile。制作文件来自 CortexM3 的优秀教程，它可以选择添加所有 INC 和 SRC 目录，链接器也来自这个项目。我的问题是我必须在哪里搜索错误：在链接器中？编译器？还是在项目中？当我使用另一个链接器（来自 chibiOS 项目）时，我没有收到任何错误，但我得到了一个损坏的 elf 文件。链接器是否有可能没有看到 main.c 字段？或者我忘了包含一些文件？我整天都在调试这个问题，现在我需要一些新的想法或提示。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:39:44.877

You should try adding a true declaration before using it:

```
extern unsigned long ulTIM6_OverflowCount; 
```

Preferably in a header like `task.h` that's included by both `main.c` and `task.c`.

# python - Python xml试图在标签上显示if语句

> ID：12149251
> 
> 赞同：1
> 
> 时间：2012-08-27T20:37:20.107
> 
> 标签：python, xml-parsing

我的问题围绕着我正在使用的 XML 文件，它看起来像这样。

```
<log>
<logentry
 revision="33185">
<author>glv</author>
<date>2012-08-06T21:01:52.494219Z</date>
<paths>

<path
 kind="file"
 action="M">/branches/Patch_4_2_0_Branch/text.xml</path>   

<path
 kind="dir"
 action="M">/branches/Patch_4_2_0_Branch</path>

</paths>
<msg>PATCH_BRANCH:N/A
BUG_NUMBER:N/A
FEATURE_AFFECTED:N/A
OVERVIEW:N/A
Adding the SVN log size requirement to the branch 
</msg>
  </logentry>
    </log> 
```

现在我想做的是我想对此使用“if”语句来查看 xml 路径标记以检查它是 kind= dir 还是 kind = file。然后将路径添加到名为 content 的变量中。这就是我到目前为止所拥有的。我正在使用 dom.import 顺便说一句。

```
xmlPath = dom.getElementsByTagName('paths')[0]
xmlPathM =  xmlPath.getAttribute('kind')    
if xmlPathM == dir:
    content += "Directory location:" + xmlPathM +"\n \n"
else:
    content += "FileName"  + xmlPathM +"\n \n " 
```

现在它似乎不想工作它会在其中打印出 FileName 而不是 Directory 位置。我相信，但我希望它查看这个日志并打印出来

```
Directory location: /branches/Patch_4_2_0_Branch 

FileName:/branches/Patch_4_2_0_Branch/text.xml 
```

对于相同的日志条目。关于我错过了什么或做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T20:57:39.010

使用良好的交互式控制台（如 IPython）是一件很棒的事情。[旁注：我更喜欢 ElementTree，因为我更喜欢界面，但无论如何]

让我们深入研究。首先阅读它：

```
In [51]: import xml.dom.minidom as minidom

In [52]: dom = minidom.parse("log.xml")

In [53]: dom
Out[53]: <xml.dom.minidom.Document instance at 0x97082ec> 
```

现在查看路径内部：

```
In [55]: dom.getElementsByTagName("paths")
Out[55]: [<DOM Element: paths at 0x97086cc>]

In [56]: dom.getElementsByTagName("paths")[0]
Out[56]: <DOM Element: paths at 0x97086cc>

In [57]: vars(dom.getElementsByTagName("paths")[0])
Out[57]: 
{'_attrs': {},
 '_attrsNS': {},
 'childNodes': [<DOM Text node "u'\n\n'">,
  <DOM Element: path at 0x970874c>,
  <DOM Text node "u'   \n\n'">,
  <DOM Element: path at 0x97088ac>,
  <DOM Text node "u'\n\n'">],
 'namespaceURI': None,
 'nextSibling': <DOM Text node "u'\n'">,
 'nodeName': u'paths',
 'ownerDocument': <xml.dom.minidom.Document instance at 0x97082ec>,
 'parentNode': <DOM Element: logentry at 0x970848c>,
 'prefix': None,
 'previousSibling': <DOM Text node "u'\n'">,
 'tagName': u'paths'} 
```

看看`childNodes`：

```
In [58]: dom.getElementsByTagName("paths")[0].childNodes
Out[58]: 
[<DOM Text node "u'\n\n'">,
 <DOM Element: path at 0x970874c>,
 <DOM Text node "u'   \n\n'">,
 <DOM Element: path at 0x97088ac>,
 <DOM Text node "u'\n\n'">] 
```

空格很重要，所以这有点让人头疼。但是可以扔掉非元素：

```
In [61]: elements = [x for x in dom.getElementsByTagName("paths")[0].childNodes if isinstance(x, minidom.Element)]

In [62]: elements
Out[62]: [<DOM Element: path at 0x970874c>, <DOM Element: path at 0x97088ac>] 
```

向内看：

```
In [65]: elements
Out[65]: [<DOM Element: path at 0x970874c>, <DOM Element: path at 0x97088ac>]

In [66]: vars(elements[0])
Out[66]: 
{'_attrs': {u'action': <xml.dom.minidom.Attr instance at 0x970880c>,
  u'kind': <xml.dom.minidom.Attr instance at 0x97087ac>},
 '_attrsNS': {(None, u'action'): <xml.dom.minidom.Attr instance at 0x970880c>,
  (None, u'kind'): <xml.dom.minidom.Attr instance at 0x97087ac>},
 'childNodes': [<DOM Text node "u'/branches/'...">],
 'namespaceURI': None,
 'nextSibling': <DOM Text node "u'   \n\n'">,
 'nodeName': u'path',
 'ownerDocument': <xml.dom.minidom.Document instance at 0x97082ec>,
 'parentNode': <DOM Element: paths at 0x97086cc>,
 'prefix': None,
 'previousSibling': <DOM Text node "u'\n\n'">,
 'tagName': u'path'} 
```

最后我们知道我们想要什么：

```
In [67]: for elem in elements:
    print elem, elem.childNodes[0].nodeValue, elem.getAttribute("kind"), elem.getAttribute("action") 
   ....:     
<DOM Element: path at 0x970874c> /branches/Patch_4_2_0_Branch/text.xml file M
<DOM Element: path at 0x97088ac> /branches/Patch_4_2_0_Branch dir M 
```

我无法想象不以交互方式执行此操作。

# ios - Xamarin、C++、Cocos2D-X 和 Visual Studio

> ID：12149253
> 
> 赞同：4
> 
> 时间：2012-08-27T20:37:24.193
> 
> 标签：ios, monodevelop, cocos2d-x, xamarin

好的，所以我目前有一个混合了 iOS 用户界面元素和 Cocos2d-x (Cocos2d C++) 的 iOS 应用程序。

当我偶然发现 Xamarin 和他们的 Visual Studio 插件时，我得到了一个使用 Java/JNI 为 Android 工作的粗略端口。他们的文档提到 C++ 代码可以与它一起使用，但我找不到任何演示此功能的示例 Xamarin 项目。

Xamarin 是否支持将 C++ 源代码添加到他们的 Visual Studio 项目中？如果是这样，它是否允许对该源代码与 C# 进行无缝编译和调试？

另外，有没有这个功能的例子？

本质上，我很想使用 Xamarin C# 用户界面的可移植性，以及我已经编写的大量 C++ Cocos2d-x 代码。

如果我不清楚，请回答问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-21T15:41:11.543

2014年研究这个：

*   将 C++ 代码与不同语言捆绑在一起的通用方法是提供 C 函数调用接口。这通常意味着您的 C++ 代码包含一个工厂函数，用于返回指向 C++ 对象的通用指针，并作为 void* 传递到 C 包装器中。地球上几乎每个环境都可以调用标准 C 函数，因为这是获取大多数低级操作系统函数所必需的。
*   这篇 Xamarin 论坛[2014 年 1 月文章](http://forums.xamarin.com/discussion/12174/porting-c-native-code)讨论了在使用 CppSharp 生成包装器后使用 NDK 进行编译
*   Skyscanner 做了一个关于跨平台库的两部分系列，在 2014 年 2 月[介绍了这些工具](http://www.skyscanner.net/blogs/developing-mobile-cross-platform-library-part-1-exploring)，然后是[C++ 答案](http://www.skyscanner.net/blogs/developing-mobile-cross-platform-library-part-2-c)，其中有很多细节可能有助于使用 Xamarin 中的 C++（所有笨拙的 NDK 位）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T16:06:06.027

我不确定这是否能准确回答您的问题，但也许可以从[http://tirania.org/blog/archive/2011/Dec-19.html开始](http://tirania.org/blog/archive/2011/Dec-19.html)

# php - 从 mysql 数组返回 True/False

> ID：12149254
> 
> 赞同：0
> 
> 时间：2012-08-27T20:37:28.367
> 
> 标签：php, mysql, arrays

我在这里有这个查询：

```
function movement_performed_today($class_id, $client_id){
$class_id = (int)$class_id;
$client_id = (int)$client_id;

$query = mysql_query("SELECT COUNT(`movement`) FROM `completed_movements` WHERE `class_id` = '$class_id' AND `client_id` = '$client_id' AND `date` = CURDATE()");

$movement_performed = mysql_fetch_assoc($query);

print_r($movement_performed);   
} 
```

这将返回：

```
Array ( 
[COUNT(`movement`)] => 0 
) 
Array ( 
[COUNT(`movement`)] => 0 
) 
```

哪个是对的。现在我想做这样的事情：

```
function movement_performed_today($class_id, $client_id){
$class_id = (int)$class_id;
$client_id = (int)$client_id;

$query = mysql_query("SELECT COUNT(`movement`) FROM `completed_movements` WHERE `class_id` = '$class_id' AND `client_id` = '$client_id' AND `date` = CURDATE()");

$movement_performed = mysql_fetch_assoc($query);

return (mysql_result($movement_performed['count'], 0) == 1) ? true : false; 
} 
```

这样我就可以在 while 循环中调用这个函数，如果它返回 0/false，它会将表单数据发布到数据库。有人可以帮忙吗？这是我尝试执行此功能的 while 循环：

```
if (empty($_POST)=== false){
$i = 0;
while (isset($_POST["first_name"][$i])) {
    $movement_data = array(   
    'user_id'       => $session_user_id,   
    'class_id'      => $class_id,   
    'class_name'    => $class_name,
    'client_id'     => $_POST['client_id'][$i],    
    'first_name'    => $_POST['first_name'][$i],   
    'last_name'     => $_POST['last_name'][$i],   
    'nickname'      => $_POST['nickname'][$i],   
    'order'         => $_POST['order'][$i],   
    'movement'      => $_POST['movement'][$i],   
    'rep_set_sec'   => $_POST['rep_set_sec'][$i],   
    'rest'          => $_POST['rest'][$i],   
    'date'          => $today   
    );  

   $movement_performed = movement_performed_today($class_id, $_POST['client_id']);
   foreach ($movement_performed as $performed){
   if($performed == false){
    completed_movement($movement_data);
    } // if performed
  } // foreach
   $i++; 
   } // while

} // if empty 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:17:11.720

Your method `movement_performed_today` returns a Boolean. Not something you can loop on. Do the check in your main loop. Also you are aware that trusting user input from a _POST is not secure? The use of mysql_query is depreciated you need to look at using [PDO](http://php.net/manual/en/ref.pdo-mysql.php) and bound parameters.

```
if (! empty($_POST)) {
    $i = 0;
    while (isset($_POST["first_name"][$i])) {
        $movement_data = array(   
        'user_id'       => $session_user_id,   
        'class_id'      => $class_id,   
        'class_name'    => $class_name,
        'client_id'     => $_POST['client_id'][$i],    
        'first_name'    => $_POST['first_name'][$i],   
        'last_name'     => $_POST['last_name'][$i],   
        'nickname'      => $_POST['nickname'][$i],   
        'order'         => $_POST['order'][$i],   
        'movement'      => $_POST['movement'][$i],   
        'rep_set_sec'   => $_POST['rep_set_sec'][$i],   
        'rest'          => $_POST['rest'][$i],   
        'date'          => $today);  

        //check not already performed today
        $isPerformed = movement_performed_today($class_id, $_POST['client_id']);

        //if not performed then do insert
        if(! $isPerformed) completed_movement($movement_data);    

        $i++; 
    }    
} 
```

# c - 乘以有限域 p=2

> ID：12149259
> 
> 赞同：0
> 
> 时间：2012-08-27T20:37:52.367
> 
> 标签：c

在 C 代码中使用这个[快速乘法](https://stackoverflow.com/questions/12146052/fast-multiplication-code-in-c)代码我试图将`x*A`where`x=0xAA`和`A`这个矩阵相乘

```
1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1
0 1 0 0 1 0 1 1 0 0 0 1 0 0 1 1
0 0 1 0 0 1 1 0 1 1 1 0 1 1 0 0
0 0 0 1 1 1 0 1 1 0 1 1 0 0 0 0

```

但是在 C 编译器中我什么也没有得到，我的程序被挂起。

为什么会这样？任何想法？。

我认为这个问题在这一行

```
cR[j] ^= *pt++; 
```

# mysql - 如何更新一个表以引用 MYSQL 中的另一个表？

> ID：12149267
> 
> 赞同：1
> 
> 时间：2012-08-27T20:38:17.400
> 
> 标签：mysql

这是我设置表格的方式 -

```
Products
_______

P_Id  Desc  
1      Apple  
2     Orange  
3     Banana

Categories
__________

P_Id  Cat_Id  
1      200  
2      200  
3      205 
```

现在我需要更新表“产品”中的字段“Desc”字段，其中表“类别”中的“Cat_Id”字段等于 200。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:40:53.220

这是一种方法：

```
UPDATE Products
SET `desc` = 'foo'
WHERE P_id IN (SELECT P_Id FROM Categories WHERE Cat_Id = 200) 
```

另一种方法是使用多表更新

```
UPDATE Products, Categories
SET Products.`desc` = 'foo'
WHERE Products.P_id = Categories.P_ID
AND Categories.Cat_Id = 200 
```

顺便说一句，`desc`列名是一个非常糟糕的选择。它是一个[保留字](http://dev.mysql.com/doc/refman/5.6/en/reserved-words.html)。`description`当您必须调试在忘记反引号时不起作用的查询时，由于不完整输入而节省的所有时间将很快丢失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:42:55.457

试试这个：

```
UPDATE products
set `Desc` = 'xxx'
WHERE P_id IN (SELECT P_Id FROM Categories WHERE Cat_Id = 200); 
```

# sugarcrm - 将自定义字段添加到编辑视图 - SugarCRM

> ID：12149271
> 
> 赞同：3
> 
> 时间：2012-08-27T20:38:28.623
> 
> 标签：sugarcrm

我正在尝试修改 SugarCRM（SugarPro 6.1.2）实例的 EditView 中自定义字段（复选框）的行为。具体来说，我希望每当有人点击复选框时都会显示一个 div。该字段按预期出现在编辑视图中，我添加了一些执行 onclick 的 javascript - 这也很好。问题是，保存记录时，未保存复选框的值。以下是关于我如何添加字段和关联 javascript 的详细信息：

1.  我在 Studio 中将该字段创建为复选框。它被称为wire_payment_c
2.  我将该字段添加到 DetailView 和 EditView 布局。
3.  我跑了快速修复和重建
4.  我编辑 ./custom/modules/MODULE/metadata/editviewdefs.php 如下：

    ```
     1 => 
    array (
      0 => '',
      1 => 
      array (
        'name' => 'wire_payment_c',
        'label' => 'LBL_WIRE_PAYMENT',
     'customCode' => '<input type="hidden" value="0" name="wire_payment_c">    
     <input id="wire_payment_c" type="checkbox" tabindex="107" title="" value="{$fields.wire_payment_c.value}" name="wire_payment_c" onclick="showMe(\'wire_message\', this)"> 
     <div id="wire_message" style="display:none">Please obtain wire payment information.</div>' ,
      ),
    ), 
    ```

在面板定义的下方，我还添加了以下内容：

```
'includes'=> array(
     array('file'=>'custom/modules/MODULE/wire_pmt.js' ),
 ), 
```

1.  我在 ./custom/modules/MODULE/wire_pmt.js 创建了包含 showMe() 的 javascript。
2.  我再次运行了快速修复和重建

如果我取出 editviewdefs.php 中的 customCode 行，我已经能够验证复选框值是否完全按预期保存并保留在数据库中。此外，我可以验证删除 onclick 指令并将输入标记保留在分配给 customCode 的值中就足以重现问题。结果似乎是这个问题与 javascript 无关——这与我如何重新呈现输入标签有关。但是我为输入标记准备的代码看起来与我完全注释掉 customCode 并通过 FireBug 查看表单时看到的完全一样。

在这种情况下，是否还有其他事情要做才能让 Sugar 将自定义字段的值保存到数据库中，然后在加载时将保存的值显示到详细信息和编辑视图？很高兴阅读有关此过程的文档，但未能找到任何似乎适用于此类特定任务的文档。

非常感谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:31:46.853

在调查您的问题时，我发现问题在于您如何确定复选框是否被选中。这会影响表单提交的方式。

目前您正在使用：`value="{$fields.wire_payment_c.value}"`

默认情况下，属性值应为`1`. `true`是否`false`使用属性指定复选框的决定因素`checked`。

您的`customCode`属性应该看起来更像这样：

```
'customCode' => '<input type="hidden" value="0" name="wire_payment_c">{if $fields.wire_payment_c.value == "1"}{assign var="isChecked" value="CHECKED"}{else}{assign var="isChecked" value=""}{/if}<input type="checkbox" id="wire_payment_c" name="wire_payment_c" value="1" title="" tabindex="107" onclick="showMe(\'wire_message\', this)" {$isChecked}><div id="wire_message" style="display:none">Please obtain wire payment information.</div>', 
```

要了解我们如何在核心产品中处理此问题，您可以查看`include/SugarFields/Fields/Bool/EditView.tpl`.

亲切的问候，杰里·克拉克

开发者支持工程师

# java - Java Split into 3 Fields

> ID：12149286
> 
> 赞同：3
> 
> 时间：2012-08-27T20:39:36.670
> 
> 标签：java

I have a String that looks like **"NAME:City~FORMAT:S~PRINT:true"**

I want to split and assign the value of "City" to field1, "S" to field2, and true to field3 (Boolean).

I know I can grind through this code with brute force, but is there a way to parse the value of the 2nd split into the fields without doing some sort of check on a subscript to see if it is an odd value (e.g. subscript 0 is the NAME, but I want subscript 1, which is "City").

```
 for (String element : text.split("~")) {
        for (String rule : element.split(":")) {
            System.out.println(rule);
        }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:01:32.397

您还可以通过执行类似的操作来避免循环：

```
String[] flds = text.split("NAME:|~FORMAT:|~PRINT:");
String field1 = flds[1];
String field2 = flds[2];
String field3 = flds[3]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:41:39.767

You could just do

```
for (String element : text.split("~")) {
   System.out.println(element.split(":")[1]);
} 
```

[`split()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String%29) returns an array, and you want the second element, which has index `1`.

# android - 显示使用 Google 的 IAB 的产品的设备特定定价

> ID：12149292
> 
> 赞同：4
> 
> 时间：2012-08-27T20:39:56.140
> 
> 标签：android, in-app-billing, google-play

查看 Google 的 IAB API 很明显，您无法访问产品的定价信息。如果我要向用户展示多个产品，显然这是有问题的。

我想知道其他 Android 开发人员在创建店面活动方面做了什么。好像有三个选项。

1.  显示不带价格的产品列表，迫使用户单击每个以显示价格可见的购买活动。
2.  选择一种货币（比如美元）并只显示其中的价格，因为您知道您可能会惹恼非美国用户。
3.  尝试根据他们的语言环境或位置猜测用户的货币，并从您维护某人的表格中查找“最佳猜测”价格。

我很想听听人们选择了哪些选项以及为什么。令人难以置信的是，谷歌没有让你访问这些信息，因此你可以显示一个适当的产品菜单来购买。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T10:13:55.693

> 选择一种货币（比如美元）并只显示其中的价格，因为您知道您可能会惹恼非美国用户。

我想你自己回答了。这不是一个很好的用户体验。

> 尝试根据他们的语言环境或位置猜测用户的货币，并从您维护某人的表格中查找“最佳猜测”价格。

如果您绝对需要在将价格发送到 Google Play 之前向用户显示价格，那么这是最好的选择。

> 令人难以置信的是，谷歌没有让你访问这些信息，因此你可以显示一个适当的产品菜单来购买。

有[Google Play Android Developer API](https://developers.google.com/android-publisher/v1/)，这看起来像是可以添加到其中的功能。告诉 Google 您希望看到添加此功能，而不是我们。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T17:11:30.547

因此，如果其他人面临同样的问题，请分享我最终用作解决方案/解决方法的内容。

我没有显示价格，而是使用翻译后的字符串“购买”的最便宜的商品标签。我列出的其他项目为 %discount。

所以商店是这样写的

*   5X 数量的小部件 80% 折扣
*   3X 数量的小部件 66% 折扣
*   X 数量的小部件 购买

我认为不列出总价有点阴暗，但由于我不能，至少这些解决了显示什么的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T21:23:03.763

Google 通过发布“应用内结算版本 3”解决了这个问题，该版本支持查询产品信息（包括价格）。

# dns - 如何将 appharbor 域转发到我的自定义域

> ID：12149295
> 
> 赞同：1
> 
> 时间：2012-08-27T20:40:04.877
> 
> 标签：dns, asp.net-mvc-4, appharbor

[我有一个在AppHarbor](https://appharbor.com/)中运行的网站 ( [Tulpep](http://www.tulpep.com) ) 应用程序。appharbor 中的默认域是[http://tulpepwebsite.apphb.com/](http://tulpepwebsite.apphb.com/)。

该站点在 ASP.NET MVC 4.5 上运行。

如果在某些情况下用户访问 *apphb.com 域到我的自定义域，是否可以将用户重定向？

我认为这可能是不可能的，因为从我的自定义域到我的 apphb.com 域的重定向是由从 www 到 tulpepwebsite.apphb.com 的 DNS 进行的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T23:54:03.100

您可以在 AppHarbor 上定义[规范的主机名。](http://support.appharbor.com/kb/tips-and-tricks/canonical-hostname)

# perl - perl calling 'ssh -f -N' .. should I use Net::Expect, system or exec?

> ID：12149299
> 
> 赞同：0
> 
> 时间：2012-08-27T20:40:17.077
> 
> 标签：perl, ssh, expect

I'm trying to automate a process with perl that will basically telnet into one system, "ssh -f -N" into two more and finally open a screen/tmux session and run sshuttle, then disconnect from screen/tmux.

If I am going to be running ssh with the "-f -N" options - is this best handled through Net::SSH::Expect, Net::Expect, system or exec?

I'm concerned with Net::SSH or Net::Expect as I'm not sure of a few things, first, how can I get Net::Expect/SSH to recognize that the SSH session is successful? That is to say, when I program Net::Expect and spawn the ssh session with those parameters, and subsequently login, there is no more output for 'expect' to see. I'd like to rely upon something other than the expect timeout.

Does that make sense? I'm not sure I'm phrasing my question clearly.

I'm also not sure how perl will behave if I spawn the ssh session that goes into the background. Will my perl program never exit? Waiting for the backgrounded SSH sessions to end?

It is because of this last question that I ask the additional questions of whether I should be considering the use of system or exec calls over `Net::Expect`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T23:57:03.627

您可以使用[Net::OpenSSH](https://metacpan.org/module/Net%3a%3aOpenSSH)，如果需要，它可以与 Expect 集成。

编辑，呃，我错过了你通过 telnet 会话中继它。忽略以上。

# c - calloc(): Do the individual values matter for performance?

> ID：12149300
> 
> 赞同：5
> 
> 时间：2012-08-27T20:40:20.693
> 
> 标签：c, memory, malloc, calloc

I'm currently writing an embedded application in C where performance is critical.

Currently, I'm allocating lots of empty memory like this: `calloc(1, num_bytes)` - however, I simply calculate `num_bytes` as the product of a number of items and the size of each item earlier in the code as it's code that used to call `malloc`.

`calloc` seems unique in that it is the only memory allocation function of the -alloc family which takes two arguments for the size. Is there a good reason for doing this? Are there performance implications for specifying different arguments? What was the rationale in choosing this argument layout?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:48:36.570

One advantage of having the separate arguments is that it automatically guards against integer overflow:

```
// On a 32-bit system, the calloc will almost certainly fail, but the malloc
// will succeed to overflow, likely leading to crashes and/or security holes
// (e.g. if the number of items to allocate came from an untrusted source)
void *a = calloc(64, 67108865);  // 2^32/64 + 1
void *b = malloc(64 * 67108865);  // will allocate 64 bytes on 32-bit systems 
```

For large allocations, there can also be a performance advantage of doing a `calloc` instead of a `malloc` and `memset` combination, since the `calloc` implementation can use its internal knowledge of the heap to avoid unnecessary work or have improved cache performance.

For example, if the allocator decides to use an OS function such as [`mmap(2)`](http://linux.die.net/man/2/mmap) or [`VirtualAlloc`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366887%28v=vs.85%29.aspx) to acquire more virtual address space, that memory will come pre-zeroed for security reasons. See [this question](https://stackoverflow.com/questions/2688466/why-mallocmemset-slower-than-calloc) for a detailed explanation. For small allocations, you're unlikely to notice much of a difference.

Some `calloc` implementations just call `malloc` and `memset` internally, so there's no advantage other than a potential overflow check.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:48:52.293

I suppose that the argument layout of `calloc()` is to allow the allocation of object sizes greater than the storage capacity of a single `size_t` parameter type (which might be as small as 64KiB).

Whether performance is affected depends mostly on how the arguments are passed to `calloc()` in your particular environment. *Usually*, more arguments to pass means more data to be transferred between the caller and the callee -- for example, more arguments will need to be pushed to the callee's stack, yielding a couple of extra instructions to push the arguments in. But I believe that this extra overhead won't be a bottleneck in your program, specially when compared to the execution time of the memory allocator itself.

If you're worried about the performance of `calloc()`, `malloc()` might be faster simply due to the fact that it does not initialize the allocated buffer as `calloc()` do.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T20:48:25.483

> I'm currently writing an embedded application in C where performance is critical.

I think that `calloc` optimization should be pretty low as priority. But try to see whether it's possible to employ `malloc` instead (avoiding the zero-initialization), avoid `alloc` altogether by re-using memory, and possibly allocating memory padded to a platform-specific boundary.

These are all very minor optimization, though (except maybe for `alloc` reuse). I'd focus on the algorithm instead.

# javascript - googlemaps api3, demogallery example "Custom Small Navigation Control"

> ID：12149305
> 
> 赞同：0
> 
> 时间：2012-08-27T20:40:36.730
> 
> 标签：javascript, google-maps, google-maps-api-3

This may not be the best place for this question but here goes:

I'm a beginner in googlemaps and javascript and found this example for something I'm working on. [http://search.missouristate.edu/map/mobile/examples/ZoomPanControl.htm](http://search.missouristate.edu/map/mobile/examples/ZoomPanControl.htm) I understand most of the code but I'm having a hard time finding out the meaning of the following lines of code at the end of this file ZoomPanControl.js

```
window["missouristate"] = window["missouristate"] || {};
window["missouristate"]["web"] = window["missouristate"]["web"] || {};
window["missouristate"]["web"]["ZoomPanControl"] = ZoomPanControl; 
```

**Edit:** The [original example](http://search.missouristate.edu/map/mobile/examples/ZoomPanControl.htm) is no longer available and redirects to a map that doesn't have the custom ZoomPanControl, [here is an example that shows the custom zoom/pan control referenced](http://www.geocodezip.com/v3_GoogleEx_control-custom_ZoomPanControl.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T07:26:08.453

它将控件附加到全局变量（或命名空间？）“窗口”，以便您可以使用以下方法实例化它：

```
 var ZoomPanControl = new missouristate.web.ZoomPanControl(map); 
```

[**Google Maps API 加载器**](http://maps.google.com/maps/api/js?sensor=false)做同样的事情，即：

```
window.google = window.google || {};
google.maps = google.maps || {}; 
```

# eclipse - IBM Rational Application Developer Data Source Explorer DB2 - how to view tables by system name?

> ID：12149310
> 
> 赞同：1
> 
> 时间：2012-08-27T20:40:52.207
> 
> 标签：eclipse, db2, ibm-rad

We have a db2 database at our company, and I'm trying to view tables in a schema by their shorter system name instead of by their long name. Is there any way to do this? If I'm in the SQL editor, i can get the short/system name to autofill for table names, but they won't show up in the data source explorer.

Sometimes I'm given a table to look up, and I don't know what the long name of the table is, so I can't find it. The search feature doesn't seem to find it, and the filter options don't find it either.

Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:39:05.957

我没用过 RAD，但总有[`SYSIBM.SYSTABLES`目录视图](http://publib.boulder.ibm.com/infocenter/dzichelp/v2r2/topic/com.ibm.db2z9.doc.sqlref/src/tpc/db2z_sysibmsystablestable.htm)。

我猜测“短名称”实际上是指该表的表空间，可以在目录视图中找到，如下所示（`TYPE = 'T'`只会返回基表）：

```
SELECT RTRIM(CREATOR) || '.' || RTRIM(NAME)
FROM SYSIBM.SYSTABLES
WHERE TSNAME = 'short_name'
  AND TYPE   = 'T' 
```

通常，除非您指定一个现有的表空间，否则 DB2 会隐式地为该表创建一个新的表空间，因此一个表空间中可能会有多个表。查看下面的[`CREATE TABLE`](http://publib.boulder.ibm.com/infocenter/dzichelp/v2r2/topic/com.ibm.db2z9.doc.sqlref/src/tpc/db2z_sql_createtable.htm)条目以`IN DATABASE`获取更多信息。

# java - 在Java中插入原始数组的ArrayList后取回原始数组

> ID：12149314
> 
> 赞同：29
> 
> 时间：2012-08-27T20:41:09.400
> 
> 标签：java

```
List<double[]> x = new ArrayList<double[]>();
x.add(new double[]={1,2,3,4,54,6}); 
```

元素 1,2,3,4,54,6 添加到 x

```
x.get(0) ---> returns 1 
```

但是这样做会添加数组的地址吗？为什么

```
 List<double[]> x = new ArrayList<double[]>();
    double[] name=new double[5];
    name[0]=1
    name[1]=3;
    name[2]=3;
        .
        . 
        . 
        .
    x.add(name);
    getting x.get(0) ---> returns @as12cd2 (address of the array) 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-08-27T20:50:01.013

如果您只想让列表存储双精度而不是双精度数组，请更改列表存储的内容

```
List<Double> doubleList = new ArrayList<Double>(); 
```

然后您可以将数组作为列表添加到您的数组列表中，这意味着该列表存储的是值而不是数组。这将为您`get(0)`提供将给您 1 而不是数组地址的行为

```
Double[] doubleArray = {1.0, 2.0, 3.0, 4.0, 54.0, 6.0 };
doubleList.addAll(Arrays.asList(doubleArray));
doubleList.get(0); //gives 1.0 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-27T20:45:00.490

这是因为`List`由 组成`double[]`而不是`double`。

因为 a`double[]`是一个数组，所以您还必须从该数组中指定位置。像这样：

```
x.get(0)[0] 
```

如果您希望能够只使用`x.get()`，`List`则必须`double`由原语组成。然后您可以使用单独的方法将数组添加`doubles`到`List`（我不知道内置的方法）：

```
List<Double> addArray(List<Double> o, double[] a) {
  for(Double d : a)
    o.add(d);

  return o;
} 
```

希望这是有道理的。我喜欢使用简短的变量名来使逻辑更清晰。只要你知道变量是什么，你应该没问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-27T20:42:49.563

`double[]`数组是对象。所以，你得到地址，整个数组被添加到索引 0 处。

您可以使用`Arrays.toString(x.get(0))`来获得可读的数组打印。

数组的 toString() 是打印 [，后跟表示数组元素数据类型的字符，然后是 @，然后是内存地址。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-27T20:45:55.510

any （包括）的默认`toString()`实现是返回 Object 地址。这就是您的代码打印的内容。`Object``double[]`

# google-app-engine - 如何将 filepicker.io 与谷歌应用引擎（blobstore）集成？

> ID：12149315
> 
> 赞同：4
> 
> 时间：2012-08-27T20:41:10.583
> 
> 标签：google-app-engine, google-cloud-datastore, blobstore, webapp2, filepicker.io

所以我正在尝试将 filepicker.io 与 GAE 应用程序一起使用。文件选择器小部件返回用户上传的文件的 URL。

然后如何使用此 url 将文件上传到 GAE 的 blobstore？

blobstore 仅支持“通过表单上传文件”，因此真正的问题是如何伪造包含文件 URL 的表单 POST。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T21:12:11.170

伪造表单帖子是可能的，但使用[Files API要简单得多](https://developers.google.com/appengine/docs/python/blobstore/overview#Writing_Files_to_the_Blobstore)

*编辑：*

要将 File API 与 urlfetch 一起使用，您可以编写如下内容：

```
from __future__ import with_statement
from google.appengine.api import files
from google.appengine.api import urlfetch

url = "http://www.facebook.com/somephoto.png"
result = urlfetch.fetch(url)
if result.status_code not 200:
  return "some error"

# Create the file
file_name = files.blobstore.create(mime_type='application/octet-stream')

# Open the file and write to it
with files.open(file_name, 'a') as f:
  f.write(result.content)

# Finalize the file. Do this before attempting to read it.
files.finalize(file_name)

# Get the file's blob key
blob_key = files.blobstore.get_blob_key(file_name) 
```

*我还没有测试过这个 - 所以如果这不起作用，请告诉我。*

另外，我相信您可以将 mime_type 保留为“application/octet-stream”，App Engine 将尝试猜测正确的类型。如果这不起作用，请尝试将其更改为“image/png”。或者对于 pdf，mime 类型将是 'application/pdf'

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-22T00:32:46.797

投票最多的答案中的文件 API 已弃用，所以我在 github 上写了一个 gist 来解决这个问题。它获取图像的 url 并使用请求和海报将其发布到您自己的服务器。

[https://gist.github.com/jmasonherr/6301914](https://gist.github.com/jmasonherr/6301914)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T06:54:10.657

实际上，我们花了很多时间试图找出是否可以绕过浏览器来伪造您描述的确切类型的东西，但无济于事。我的建议是编写一些快速的后端代码，比如 Kyle 建议从 url 中获取文件对象，但如果你真的坚持不懈，你实际上可以使用 ajax 伪造你自己的多部分表单请求。

请参阅[XMLHttpRequest POST multipart/form-data](https://stackoverflow.com/questions/155371/xmlhttprequest-post-multipart-form-data)和[Is it possible to fake a multipart/form-data post with a jquery ajax call?](https://stackoverflow.com/questions/9712893/is-it-possible-to-fake-a-multipart-form-data-post-with-a-jquery-ajax-call) 有关如何执行此操作的一些想法

# android - Android：layout_gravity center 不居中

> ID：12149316
> 
> 赞同：4
> 
> 时间：2012-08-27T20:41:20.087
> 
> 标签：android, android-layout, layout-gravity

我有一个问题，这可能很愚蠢，但我无法弄清楚为什么这不起作用。

基本上，我的活动中有一个标题。此标题应居中。

布局-XML

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

<TextView 
    style="@style/TextHeader"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/define"
    />
</LinearLayout> 
```

styles.xml 中的定义

```
<style name="TextHeader">
    <item name="android:textSize">20dp</item>
    <item name="android:paddingTop">15dp</item>
    <item name="android:layout_gravity">center</item>
    <item name="android:paddingBottom">15dp</item>
</style> 
```

据我了解，`layout_gravity`定义了组件本身的重力，同时`gravity`定义了该组件内容的重力。我尝试了两种方式，包括`center`center_horizo​​ntal 和 center_horizo​​ntal。我还制作了标题 TextView`layout_width:wrap_content`并尝试将其居中`layout_gravity`，但结果总是如下（如果我将应用程序放在手机上也是如此）

![在此处输入图像描述](../Images/0d523cf26edc575137dfa54731091567.png)

为什么会这样？我该如何解决？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-27T20:50:38.643

有几种不同的解决方案，这是一个：

```
<TextView
    android:id="@+id/text"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:text="@string/define" /> 
```

这是另一个：

```
<RelativeLayout .../>

    <TextView
        ...
        android:centerInParent="true" />

</RelativeLayout> 
```

您可以将样式属性调整为您选择的任何方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-18T16:45:01.680

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="center"
    android:orientation="vertical" > 
```

android:gravity - 在**父**视图中居中（在布局中使用它）

android:layout_gravity -在父视图中居中（在所有要居中的**视图中使用它）**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T20:47:22.537

尝试使用`"center_horizontal"`和`layout_width:"fill_parent"`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T20:48:26.827

尝试

```
 center_vertical 
```

或者

```
 Use Relative Layout. 
```

# android - How to stop overwrite to an NFC tag using Android

> ID：12149318
> 
> 赞同：1
> 
> 时间：2012-08-27T20:41:22.193
> 
> 标签：android, android-intent, nfc

I'm using PN512 in card emulation mode as a NFC tag and am developing an Android application to read and write into the tag. The problem is, as long as the tag is in the NFC field, the program will keep reading and writing to the tag, but I want stop the program from overwriting the same tag once successfully writen. Are there any solutions for that?

(I know there is no way to programmatically disable NFC based on Android SDK)

```
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    btn = (Button) findViewById(R.id.btn_OK);
    mEditText = (EditText) findViewById(R.id.text_username);
    btn.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            prefs = getSharedPreferences(prefName, MODE_PRIVATE);
            SharedPreferences.Editor editor = prefs.edit();
            editor.putString(TEXT_VALUE_KEY, mEditText.getText().toString());
            editor.commit();

            String outtxt = "please touch and hold phone to tag";
            Toast toastedit12 = Toast.makeText(getApplicationContext(), outtxt, Toast.LENGTH_SHORT);
            toastedit12.show();
        }
    });

    resolveIntent(getIntent());
}

// This method/task executes when the tag is read
void resolveIntent(Intent intent)
{
    NdefMessage msg1, msg2;
    // Parse the intent
    String action = intent.getAction();

    if (NfcAdapter.ACTION_TAG_DISCOVERED.equals(action) ||
        NfcAdapter.ACTION_NDEF_DISCOVERED.equals(action)) {

        try
        {
            mRecord=createRecord();
        }
        catch (Exception e)
        {
            Toast toaste = Toast.makeText(getApplicationContext(), "exception in call to create record", Toast.LENGTH_SHORT);
            toaste.show();
        }

        // When a tag is discovered we send it to the service to be save. We
        // include a PendingIntent for the service to call back onto. This
        // will cause this activity to be restarted with onNewIntent(). At
        // that time we read it from the database and view it.
       Parcelable[] rawMsgs = intent.getParcelableArrayExtra(NfcAdapter.EXTRA_NDEF_MESSAGES);
       NdefMessage[] msgs;

       if (rawMsgs != null)
       {
            msgs = new NdefMessage[rawMsgs.length];
            for (int i = 0; i < rawMsgs.length; i++)
            {
                msgs[i] = (NdefMessage) rawMsgs[i];
            }

            msg1 = msgs[0];
            myPayload=msg1.getRecords()[0].getPayload();
        }
        else {
            // Unknown tag type
            byte[] empty = new byte[] {};
            NdefRecord record = new NdefRecord(NdefRecord.TNF_UNKNOWN, empty, empty, empty);
            msg2 = new NdefMessage(new NdefRecord[] {record});
            msgs = new NdefMessage[] {msg2};
        }
        writeToNfcTag(intent);
    }

    public NdefRecord createRecord() throws UnsupportedEncodingException {
        SharedPreferences prefs = getSharedPreferences(prefName, MODE_PRIVATE);
        mEditText.setText(prefs.getString(TEXT_VALUE_KEY, "def"))

        String lang       = "en";

        byte[] textBytes  = mEditText.getText().toString().getBytes();

        byte[] langBytes  = lang.getBytes("US-ASCII");
        int    langLength = langBytes.length;
        //int    myPayloadLength = myPayload.length;
        int    textLength = textBytes.length;
        byte[] payload    = new byte[1+langLength+textLength];

        // Set status byte (see NDEF spec for actual bits)
        payload[0] = (byte) langLength;

        // Copy langbytes and textbytes into payload
        System.arraycopy(langBytes, 0, payload, 1, langLength);
        System.arraycopy(textBytes, 0, payload, 1+langLength, textLength);
        NdefRecord record = new NdefRecord(NdefRecord.TNF_WELL_KNOWN,
                                           NdefRecord.RTD_TEXT,
                                           new byte[0],
                                           payload);
        return record;
    }

    public void writeToNfcTag(Intent intent)
    {
        Tag tag = intent.getParcelableExtra(NfcAdapter.EXTRA_TAG);
        try
        {
            write(tag);
        }
        catch (Exception e)
        {
            // Toast this; bail
        }
    }

    public void write(Tag tag) throws IOException, FormatException {
        NdefRecord[] records = { mRecord };
        NdefMessage  message = new NdefMessage(records);

        // Get an instance of Ndef for the tag.
        Ndef ndef = Ndef.get(tag);

        // Enable I/O
        ndef.connect();

        // Write the message
        ndef.writeNdefMessage(message);

        // Close the connection
        ndef.close();

        Intent myIntent = null;
        myIntent = new Intent(MyAndroidAppActivity.this, TagDeactivatedActivity.class);

        myIntent.setFlags(myIntent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(myIntent);
        finish();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-06T20:06:09.047

在您写入标签后，您可以执行此操作，但请记住，此过程是不可逆的。

```
 Ndef ndef = Ndef.get(tag);  
    if (ndef != null) { 
        ndef.makeReadOnly();
    } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-05-02T02:13:13.520

是的，可以使活动只读取和写入标签一次。我通过将标志声明为全局变量并使用该标志来控制我的标签读写来解决了我的问题。

在您的班级中将标志声明为布尔值。认为 ：

```
public class YourClass{
Boolean flag= false;
.
.
.
.
void resolveIntent(Intent intent)
{
    NdefMessage msg1, msg2;
// Parse the intent
    String action = intent.getAction();
if(flag== false){
flag = true;
    if (NfcAdapter.ACTION_TAG_DISCOVERED.equals(action) ||
        NfcAdapter.ACTION_NDEF_DISCOVERED.equals(action)) {

        try
        {
            mRecord=createRecord();
        }
        catch (Exception e)
        {
            Toast toaste = Toast.makeText(getApplicationContext(), 
"exception in call to create record", Toast.LENGTH_SHORT);
            toaste.show();
        }

        // When a tag is discovered we send it to the service to be save. We
        // include a PendingIntent for the service to call back onto. This
        // will cause this activity to be restarted with onNewIntent(). At
        // that time we read it from the database and view it.
       Parcelable[] rawMsgs = 
intent.getParcelableArrayExtra(NfcAdapter.EXTRA_NDEF_MESSAGES);
       NdefMessage[] msgs;

       if (rawMsgs != null)
       {
            msgs = new NdefMessage[rawMsgs.length];
            for (int i = 0; i < rawMsgs.length; i++)
            {
                msgs[i] = (NdefMessage) rawMsgs[i];
            }

            msg1 = msgs[0];
            myPayload=msg1.getRecords()[0].getPayload();
        } 
        else {
            // Unknown tag type
            byte[] empty = new byte[] {};
            NdefRecord record = new NdefRecord(NdefRecord.TNF_UNKNOWN, 
empty, empty, empty);
            msg2 = new NdefMessage(new NdefRecord[] {record});
            msgs = new NdefMessage[] {msg2};
        }
        writeToNfcTag(intent);
       }
    }
.
.
.
.
} 
```

希望能帮助到你。

# android - 如何使用 Fragment 运行使用 ProgressDialog 并且可以在方向更改后幸存的 AsyncTask

> ID：12149320
> 
> 赞同：0
> 
> 时间：2012-08-27T20:41:33.473
> 
> 标签：android

我正在关注 CommonsWare 书中关于如何使用片段来处理异步任务的方向更改（使用 setRetainInstance(true)）的示例。然后我尝试向异步任务添加一个进度对话框，但它在方向更改时不断崩溃，说“视图未附加到窗口”。

是否有一种模式用于在片段内部的异步任务中使用进度对话框，当方向改变时不会丢失进度对话框或崩溃？

即使片段没有被销毁，我是否仍然需要管理片段中的进度对话框的生命周期？我假设由于在活动的 UI 上创建了进度对话框，所以我可能必须通过覆盖片段的 onAttach() 和 onDetach() 方法来销毁/重新创建进度对话框？但是，我认为如果我使用片段，Android 应该负责重新附加活动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:52:26.917

根据设计指南，ProgressDialog 似乎已过时。看起来我们应该只使用微调器或条形图而不使用文本。鉴于此信息，我认为正确的路线是使用微调器作为片段的布局并将该布局嵌入到主要活动的布局中。这样可以从片段中管理显示/隐藏它，从而处理方向变化。

不幸的是，我仍然收到以下错误。

```
08-27 17:38:07.647: E/AndroidRuntime(7863): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.my.app/com.my.app.ui.SmsVerificationActivity}: java.lang.ClassCastException: android.support.v4.app.NoSaveStateFrameLayout cannot be cast to android.widget.Button
08-27 17:38:07.647: E/AndroidRuntime(7863):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at android.app.ActivityThread.access$600(ActivityThread.java:123)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at android.os.Looper.loop(Looper.java:137)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at android.app.ActivityThread.main(ActivityThread.java:4424)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at java.lang.reflect.Method.invokeNative(Native Method)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at java.lang.reflect.Method.invoke(Method.java:511)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at dalvik.system.NativeStart.main(Native Method)
08-27 17:38:07.647: E/AndroidRuntime(7863): Caused by: java.lang.ClassCastException: android.support.v4.app.NoSaveStateFrameLayout cannot be cast to android.widget.Button
08-27 17:38:07.647: E/AndroidRuntime(7863):     at com.my.app.ui.SmsVerificationActivity.initResources(SmsVerificationActivity.java:52)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at com.my.app.ui.SmsVerificationActivity.onCreate(SmsVerificationActivity.java:29)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at android.app.Activity.performCreate(Activity.java:4465)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
08-27 17:38:07.647: E/AndroidRuntime(7863):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920) 
```

这是我的主要活动布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:id="@+id/header"
        android:layout_width="fill_parent"
        android:layout_height="60dip"
        android:background="@drawable/gradient"
        android:gravity="center_vertical"
        android:paddingLeft="10dip"
        android:text="@string/sms_verification_header"
        android:textColor="#ffffff"
        android:textSize="16dip" />

    <RelativeLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/relative_layout"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/header" >

        <TextView
            android:id="@+id/verification_description_text"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_below="@+id/relative_layout"
            android:background="#000000"
            android:padding="10dip"
            android:text="@string/sms_verification_step_one"
            android:textColor="#ffffff"
            android:textSize="16dip" />

        <View
            android:id="@+id/divider"
            android:layout_width="fill_parent"
            android:layout_height="1dip"
            android:layout_below="@+id/verification_description_text"
            android:background="#808080" />

        <EditText
            android:id="@+id/phone_number"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_below="@+id/divider"
            android:layout_marginBottom="10dp"
            android:layout_marginTop="10dp"
            android:imeOptions="flagNoExtractUi"
            android:inputType="phone" />
    </RelativeLayout>

    <fragment
        android:id="@+id/async_verification_fragment"
        android:name="com.my.app.ui.AsyncVerificationFragment"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_below="@+id/phone_number"
        android:layout_weight="1" />

    <LinearLayout
        android:id="@id/connect_footer"
        android:layout_width="match_parent"
        android:layout_height="50dip"
        android:layout_alignParentBottom="true"
        android:background="@drawable/gradient"
        android:orientation="horizontal" >

        <Button
            android:id="@+id/verify"
            android:layout_width="0dip"
            android:layout_height="wrap_content"
            android:layout_marginTop="5dp"
            android:layout_weight="1"
            android:text="@string/yes" />

        <Button
            android:id="@+id/cancel"
            android:layout_width="0dip"
            android:layout_height="wrap_content"
            android:layout_marginTop="5dp"
            android:layout_weight="1"
            android:text="@string/cancel" />
    </LinearLayout>

</RelativeLayout> 
```

片段布局：

主要活动中的违规代码行：

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.sms_verification_activity);
        getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_PAN);

        initResources();

    }

    private void initResources() {

        TelephonyManager tm = (TelephonyManager) getSystemService(TELEPHONY_SERVICE);
        final String number = tm.getLine1Number();

        mPhoneNumber = (EditText) findViewById(R.id.phone_number);
        if (!TextUtils.isEmpty(number)) {
            mPhoneNumber.setText(number);
        }

        final Button verify = (Button) findViewById(R.id.verify); 
```

这是片段的 onCreateView：

```
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View v = inflater.inflate(R.layout.fragment_progress_bar, container);

        return v;
    } 
```

# json - 带有 Spring MVC 的 Tomcat 不压缩响应

> ID：12149326
> 
> 赞同：2
> 
> 时间：2012-08-27T20:42:10.770
> 
> 标签：json, tomcat, compression

我已经配置了通过 AWS EC2 安装在 Linux 服务器上的 Tomcat 6.0，以压缩大型 JSON 对象响应（约 54k 大小）——但由于某种原因，它没有压缩它。

/usr/share/tomcat6/conf/server.xml 中的连接器定义 -

```
<Connector port="8080" protocol="HTTP/1.1"
               connectionTimeout="20000" compression="force"
               compressableMimeType="text/html,text/xml,text/plain,application/javascript,application/json,text/javascript,text/json"
               redirectPort="8443" />

<Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true" 
           maxThreads="200" scheme="https" secure="true" compression="force"
           compressableMimeType="text/html,text/xml,text/plain,application/javascript,application/json,text/javascript,text/json" 
           keystoreFile="/usr/share/tomcat6/conf/my.keystore" keystorePass="password"
           clientAuth="false" sslProtocol="TLS" /> 
```

请求标头，接受 gzip -

```
POST /mycommand HTTP/1.1
Host: my.host.com
Proxy-Connection: close
Accept-Encoding: gzip
Content-Type: application/x-www-form-urlencoded; charset=utf-8
Content-Length: 431 
```

响应标头，在连接器中配置 MIME -

```
HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Content-Type: application/json;charset=UTF-8
Vary: Accept-Encoding
Date: Mon, 27 Aug 2012 20:19:05 GMT
Connection: close
Content-Length: 55565 
```

我试过了`compressed="2048"`，同样的问题。

我在服务器上的命令方法是使用带有杰克逊 JAR 的 Spring MVC 来创建 JSON 响应 -

```
@RequestMapping(method=RequestMethod.POST, value="/mycommand")
public @ResponseBody BasicResponse doCommand( 
    ...
} 
```

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:53:21.233

好吧，这很烦人...

事实证明，我用来监控所有通信的代理 Burp Suite 已经`unpack gzip / deflate`检查过了。

您必须一直向下滚动并取消选中它才能接收压缩响应。

删除后，一切正常。

# c# - Monotouch：UIDocumentInteractionController 预览右栏按钮在 iPhone 中不起作用

> ID：12149327
> 
> 赞同：3
> 
> 时间：2012-08-27T20:42:16.100
> 
> 标签：c#, iphone, ios, xamarin.ios

我在支持 iPhone 和 iPad 的通用应用程序中工作。我目前使用 UIDocumentInteractionController 来呈现 PDF 并在该 PDF 上提供一些选项（最重要的是打印功能）。随着概述的出现和预览中的 RightBarButtonItem 正确允许我打印，一切似乎都可以在 iPad 上完美运行。但是，使用 iPhone 时，当我单击 RightBarButtonItem 时收到错误消息：

```
Presenting action sheet clipped by its superview. Some controls might not respond to touches. On iPhone try -[UIActionSheet showFromTabBar:] or -[UIActionSheet showFromToolbar:] instead of -[UIActionSheet showInView:]. 
```

使用典型的操作表解决此问题相对简单：

```
ActionSheet.ShowFromTabBar(this.TabBarController.TabBar);
ActionSheet.ShowFromToolbar(this.NavigationController.ToolBar); 
```

然而，随着文档控制器的成熟，我发现很难掌握如何去做。与我在这里找到的其他实现相比，交互控制器的代码非常标准，所以我确信我缺少一些小东西。这是实现：

```
invoiceInteractionController = UIDocumentInteractionController.FromUrl(url);
invoiceInteractionController.Delegate = new UIDocumentInteractionControllerDelegateClass(this);

InvokeOnMainThread(delegate{
    if (!DeviceHelper.IsIPhone())
        invoiceInteractionController.PresentOptionsMenu(NavigationItem.RightBarButtonItem, true);
    else {
        invoiceInteractionController.PresentPreview(true);
}
}); 
```

现在，如果设备是 iPhone，我只是直接跳到预览，如您在此代码中所见。当按下右上角的条形按钮项时，问题出在预览控制器内，这会引发上述问题。但是，顺便说一句，将 PresentPreview() 替换为：

```
invoiceInteractionController.PresentOptionsMenu(new RectangleF(320,320,0,500), this.NavigationController.Toolbar, true); 
```

这也会引起同样的错误。

我几乎想知道它是否与我的委托类有关，如下所示：

```
public class UIDocumentInteractionControllerDelegateClass : UIDocumentInteractionControllerDelegate
{
    UIViewController viewC;

    public UIDocumentInteractionControllerDelegateClass (UIViewController controller)
    {
        viewC = controller;
    }

    public override UIViewController ViewControllerForPreview (UIDocumentInteractionController controller)
    {
        return viewC;
    }

    public override UIView ViewForPreview (UIDocumentInteractionController controller)
    {
        return viewC.View;
    }

    public override RectangleF RectangleForPreview (UIDocumentInteractionController controller)
    {
        return viewC.View.Frame;
    }
} 
```

与往常一样，非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T13:29:37.597

我将基本上将此标记为已解决，因为它不会导致应用程序或控制器无法工作。最终我相信我将不得不用我自己的控制器卷来替换整个东西，因为它对品牌/皮肤并不友好。如果它能够提供从标签栏呈现的能力，那就太好了。

我确实注意到的一件事是，当在 Interface Builder 中定义的选项卡栏中的导航控制器中显示它时，文档控制器将抛出相同的警告，但永远不会出现。以编程方式创建标签栏并明确定义 RectangleF 将允许控制器显示，但仍会引发警告。

我最好的猜测是 PresentPreview(true) 假设它应该从调用事件的控件中呈现，不幸的是，它是从右栏按钮呈现的操作表中的一个按钮。我愿意接受更多建议以使警告消失。

# windows - 在没有 Visual Studio 的情况下将 Visual Studio 2008 解决方案转换为 2010？

> ID：12149329
> 
> 赞同：1
> 
> 时间：2012-08-27T20:42:17.927
> 
> 标签：windows, visual-studio-2010

[这个问题看起来很有希望](https://stackoverflow.com/questions/5320206/convert-visual-studio-solution-file-from-2008-to-2010-using-msbuild)，但接受的答案需要使用 devenv，它是 Visual Studio 的一部分。

假设我有一个构建系统，我不想浪费 Visual Studio 许可证，但我想让它自动将 2008 解决方案文件转换为 2010，并使用 Windows SDK 7.1 中的 msbuild 构建它们。我该怎么做？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-27T20:51:36.233

有人为此编写了一个工具。我建议在转换真正的项目之前尝试一些虚拟项目。

[http://stevedunns.blogspot.co.il/2010/02/tool-to-switch-project-files-between.html](http://stevedunns.blogspot.co.il/2010/02/tool-to-switch-project-files-between.html)

# sql - 创建视图后 ORA-01722

> ID：12149333
> 
> 赞同：-1
> 
> 时间：2012-08-27T20:42:38.973
> 
> 标签：sql, oracle, view

使用以下方法生成视图：

```
CREATE OR REPLACE VIEW USER_AUD_VIEW (AUDIT_ID, USER_ID, TABLE_NAME_TXT, COLUMN_NAME_TXT, OLD_VALUE_TXT, NEW_VALUE_TXT, AUDIT_LAST_UPDATED_DT, AUDIT_UPDATED_USER_ID, EVALUATOR_ID, PRODUCT_ID)
AS
SELECT acm.audit_id,
CAST(GET_TOKEN(GET_TOKEN(acm.PRIMARY_KEY_VALUES,1,','),2,':') AS VARCHAR2(64)) AS user_id,
acm.table_name_txt,
CASE WHEN (acm.table_name_txt = 'XREF_USER_PRODUCT')
THEN (mstr_product.product_description_txt || '/' || acm.column_name_txt)
ELSE acm.column_name_txt
END AS column_name_txt,
CASE WHEN UPPER(acm.column_name_txt) = 'PASSWORD_TXT'
THEN '******'
ELSE acm.old_value_txt
END AS old_value_txt,
CASE WHEN UPPER(acm.column_name_txt) = 'PASSWORD_TXT'
THEN '******'
ELSE acm.new_value_txt
END AS new_value_txt,
acm.system_dt,
CASE WHEN UPPER(acm.audit_updated_user_id) = 'UNKNOWN'
 THEN acm.audit_updated_user_id
 ELSE (users.user_id
|| ' ('
|| DECODE(users.last_name_txt, NULL,' ' , users.last_name_txt)
|| ', '
|| DECODE(users.first_name_txt, NULL,' ' , users.first_name_txt)
|| ')' )
END AS audit_updated_user_id,
acm.evaluator_id,
CASE WHEN UPPER(acm.table_name_txt) = 'XREF_USER_PRODUCT'
 THEN TO_NUMBER(trim(GET_TOKEN(GET_TOKEN(acm.PRIMARY_KEY_VALUES,2,','),2,':')))
 ELSE 0
END AS product_id
FROM audit_config_maintenance acm,
users,
mstr_product
WHERE acm.table_name_txt in ('USERS','XREF_USER_PRODUCT','XREF_USER_FUNCTION')
AND UPPER(acm.audit_updated_user_id) = UPPER(users.user_id)
AND CASE WHEN UPPER(acm.table_name_txt) = 'XREF_USER_PRODUCT'
     THEN     TO_NUMBER(trim(GET_TOKEN(GET_TOKEN(acm.PRIMARY_KEY_VALUES,2,','),2,':')))
     ELSE -1
END = mstr_product.product_id
AND acm.primary_key_values is not null
/ 
```

当我执行 desc USER_AUD_VIEW 时，我得到

```
Name      Null?             Type
AUDIT_ID    NOT NULL        NUMBER
USER_ID                 VARCHAR2(64)
TABLE_NAME_TXT          VARCHAR2(30)
COLUMN_NAME_TXT         VARCHAR2(81)
OLD_VALUE_TXT           VARCHAR2(64)
NEW_VALUE_TXT           VARCHAR2(64)
AUDIT_LAST_UPDATED_DT   DATE
AUDIT_UPDATED_USER_ID   VARCHAR2(71)
EVALUATOR_ID            NUMBER
PRODUCT_ID              NUMBER 
```

然而，当我从 USER_AUD_VIEW 中选择 * 时，我得到

ORA-01722: 无效号码

我在创建视图时做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:52:00.200

```
SQL> select TO_NUMBER('1AB234') from dual;

ORA-01722: invalid number
01722\. 00000 -  "invalid number"
*Cause:    
*Action:

SQL> select TO_NUMBER('1234') from dual;
TO_NUMBER('1234')
-----------------
         1234 
```

当您在视图上发出 a 时，视图将`select`在s 代码中执行。它更像是而不是再次编写整个大文件，您只需在视图上运行 - 这意味着，在视图上很好，但是当您尝试转换为字母数字的字段值时，创建视图中的数据会导致问题. 要求只有数字（字符形式）、任何字母（AZ、az）或其中的任何特殊字符都会导致.`view``select``select``select``desc``select``TO_NUMBER``TO_NUMBER(val)``val``val``ORA-01722`

所以这是一个无赖，**但等等！**我们可以做点什么，只从字段中获取数字，而忽略其中的任何 alpha 或特殊字符。

```
SQL> select to_number(regexp_replace('1!@#2Aa33-*^4','[^[:digit:]]')) from dual;

VAL
------
12334 
```

***警告***- 上面的解决方案可能对十进制数不太友好。但要给出一个整体的想法。

因此，`regexp`拯救你的人将如下所示（假设`GET_TOKEN`运作良好）-

```
TO_NUMBER(regexp_replace(GET_TOKEN(GET_TOKEN(acm.PRIMARY_KEY_VALUES,2,','),2,':'),'[^[:digit:]]')) 
```

# java - WordPress 和 GWT

> ID：12149342
> 
> 赞同：2
> 
> 时间：2012-08-27T20:43:01.083
> 
> 标签：java, wordpress, gwt, blogs

关于如何将 WordPress 集成到 GWT 应用程序中的任何想法？

我想在 GWT 应用程序中创建一个博客页面。使用 WordPress 可以让我免于从头开始创建博客系统。将用户重定向到由 WordPress 托管的博客（想想 myblog.wordpress.com）不是一种选择。我想让用户留在我的网站内。

或者，是否有任何可以与 GWT 很好地集成的博客系统（WordPress 除外）？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T12:29:34.743

GWT 是一个 RIA 框架。你几乎可以做任何你想做的事情。

您想要实现的目标有很多选择。

一种可行的解决方案是添加一个**com.google.gwt.user.client.ui.Frame**小部件——它为 GWT 提供一个 IFrame——无论你在应用程序中的什么位置。从 MVP 的角度来看，这可能意味着包含（甚至可能扩展）框架的新视图。您甚至可以发布用于登录 GWT 应用程序的登录凭据。然后，您可以在任何实现 HasWidgets 接口的类中加载视图。

你可以用对话框做同样的事情。

另一个可能的解决方案是使用类似 www.mysitename.com 的 GWT 应用程序和 www.mysitename.com/blog 作为 wordpress 站点文件夹，并使用 GWT 提供的锚小部件将您的用户重定向到那里。

可能性是无止境。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:47:03.517

这取决于您对“集成”的含义:) 但这个问题/回答可能值得您检查：
[如何在 GWT/GXT webapp 中嵌入网页？](https://stackoverflow.com/questions/2185386/how-can-i-embed-a-webpage-in-a-gwt-gxt-webapp)

# asp.net - 此代码是否可以防止 2 个单独的 Azure 工作实例同时执行操作？

> ID：12149345
> 
> 赞同：0
> 
> 时间：2012-08-27T20:43:09.117
> 
> 标签：asp.net, vb.net, azure, multiple-instances, azure-worker-roles

我正在向未充分利用的 Azure Web 角色添加一个简单的工作进程。为了可靠性/正常运行时间，我在 2 个实例上运行了这个 Web 角色。这个工作进程将被设置为休眠大约 5 分钟，然后再执行一个操作，然后再次休眠。通过将此工作进程添加到 Web 角色，它将在多个实例上运行，并且它们都将尝试同时执行相同的操作。通常这个问题可以通过使用队列来解决，但我不需要任何复杂的东西。我只是为了防止两个实例完全同步。

我的想法是将 thread.sleep 从硬编码的等待时间更改为随机等待时间，如下所示：

```
 Public Overrides Sub Run()

    Trace.WriteLine("Worker Role entry point called.", "Information")

    While (True)
        Dim r As New Random
        Dim wait As Integer = r.Next(60000, 600000)
        Dim Minutes As Decimal = wait / 60000
        Thread.Sleep(wait)
        Trace.WriteLine(String.Format("Worker Role - Triggered on {0:f}.  Waited {1:N2} Minutes.", Now(), Minutes), "Information")
    End While

    End Sub 
```

实例 0 的输出：
信息：调用了工作角色入口点。
信息：工人角色 - 于 2012 年 8 月 27 日星期一上午 9:37 触发。等了 7.71 分钟。
信息：工人角色 - 于 2012 年 8 月 27 日星期一上午 9:41 触发。等了 4.25 分钟。
信息：工人角色 - 于 2012 年 8 月 27 日星期一上午 9:49 触发。等了 7.87 分钟。
信息：工人角色 - 于 2012 年 8 月 27 日星期一上午 9:53 触发。等了 4.77 分钟。
信息：工人角色 - 于 2012 年 8 月 27 日星期一上午 10:03 触发。等了 9.91 分钟。

实例 1 的输出：
信息：调用了 Worker Role 入口点。
信息：工人角色 - 于 2012 年 8 月 27 日星期一上午 9:38 触发。等了 9.47 分钟。
信息：工人角色 - 于 2012 年 8 月 27 日星期一上午 9:44 触发。等了 6.15 分钟。
信息：工人角色 - 于 2012 年 8 月 27 日星期一上午 9:48 触发。等了 3.41 分钟。
信息：工人角色 - 于 2012 年 8 月 27 日星期一上午 9:49 触发。等了 1.63 分钟。
信息：工人角色 - 于 2012 年 8 月 27 日星期一上午 9:58 触发。等了 8.26 分钟。
信息：工人角色 - 于 2012 年 8 月 27 日星期一上午 10:01 触发。等了 3.14 分钟。

这个计划是否有我没有看到的缺陷？感谢您的输入！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T20:55:00.777

好吧，要回答您的名义问题，这并不能保证他们俩同时做某事。但这肯定会降低这种可能性。

也就是说，使用实际的并发控制机制不必“精心设计”。来自[http://blog.smarx.com/posts/simple-scheduling-in-windows-azure](http://blog.smarx.com/posts/simple-scheduling-in-windows-azure)：

```
AutoRenewLease.DoEvery(blob, TimeSpan.FromMinutes(5), () => {
    Trace.WriteLine("Doing stuff at {0:R}", DateTimeOffset.UtcNow);
}); 
```

为什么不这样做呢？它以 NuGet 包的形式提供，它可以缩短您的代码。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:53:22.910

这是您在拥有多个辅助角色实例时可能面临的典型问题。并且解决方案非常简单，使用 Steve Marx 的[WazStorageExtensions](http://nuget.org/packages/smarx.WazStorageExtensions)库。该库允许您编写如下代码：

```
using (var arl = new AutoRenewLease(leaseBlob))
{
    if (arl.HasLease)
    {
        // inside here, this instance has exclusive access
    }
} // lease is released here 
```

从示例中可以看出，如果特定实例具有租约，则可以独占访问您正在执行的任何操作。

该库使用 blob 租约，您可以将其与 C# 中的 lock 关键字进行比较。但是锁定 blob 允许您锁定不同的进程甚至不同的实例。当时只有一个实例可以租用一个 blob，这意味着您可以确保一个进程不会同时在多个实例上运行。而且您仍然可以使用随机计时器来保持进程运行，而不必担心并发性。

# jquery - 使用 JQuery 创建方便的数据显示界面 - 按需 - 通过 iframes

> ID：12149347
> 
> 赞同：0
> 
> 时间：2012-08-27T20:43:21.533
> 
> 标签：jquery, iframe, jquery-ui-accordion

我正在尝试构建一个方便的功能，我计划将其滚动到库函数中，以便我可以再次使用。

常见的场景如下；

假设我们有一个包含一些行和列的常规表；

例子

```
<table>
    <tr><td>row 1 col 1</td><td>row 1 col 2</td><td>row 1 col 3</td></tr>
    <tr><td>row 2 col 1</td><td>row 2 col 2</td><td>row 2 col 3</td></tr>
    <tr><td>row 3 col 1</td><td>row 3 col 2</td><td>row 3 col 3</td></tr>
</table> 
```

我们希望发生以下情况；

您单击 TD 单元格（例如第 1 行/第 1 列）并响应此单击事件，在该行的正下方出现一个分区（具有很好的手风琴效果），并且该分区基本上是一个 iframe 100% 拉伸到该分区以及一个其 src 包含您在该单元格上单击的值；就像是`site.com?id=THAT_VALUE_HERE`

这样，您可以方便地单击此表中的各个单元格，然后将相关数据按需拉入 iframe 中，无论单击何处，都位于其下方。只需重新单击相同的值，iframe 分区就会关闭。当然，您可以在其他单元格上执行相同的操作。

我知道这一切都可以通过 JQuery 实现，但是如果没有好的教程，我可能需要一段时间才能完成。

有人可以指出如何实现这一点的教程吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:53:35.017

您不必为此使用 iFrame。你可以做一个常规的ajax调用。

```
$('tr').on('click', function(){
    //You could store target data directly in the td's, or however you want. 
    //This is just a quick example
    var target = $(this).attr('title');

    $.get(target, "", function(data){
        $('#contentDiv').html(data);
    });

}); 
```

# html - 为什么网页在IE8浏览器模式和IE7文档模式下显示？

> ID：12149353
> 
> 赞同：0
> 
> 时间：2012-08-27T20:44:08.950
> 
> 标签：html, doctype, ie8-browser-mode

由于某些未知原因，我正在处理的网站保持交叉匹配浏览器和文档模式。当我打开 IE8 开发工具时，我看到浏览器模式是 IE8，但文档模式是 IE7。

我已经进行了几次 doctype 更改，但无法让网站在文档模式的浏览器模式下自动加载，也就是 IE8。

当前的 Doctype 声明：

```
<%@ Page Language="vb" AutoEventWireup="true"  Src="Scripts/Splash.aspx.vb" Inherits="SplashFunctionality"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Welcome to CAE's KC-135 ATS Home</title>
<link rel="stylesheet" type="text/css" href="CSS/HomeStyles.css"/>
<link rel="stylesheet" type="text/css" href="CSS/headerStyles.css"/>
<script type="text/javascript" src="Scripts/Roladex.js"></script>
<script type="text/javascript" src="Scripts/HeaderNav.js"></script>
<script type="text/javascript" src="Scripts/HomeFunctionality.js"></script>
<script type="text/javascript" src="Scripts/JSTweener.js"></script>
</head>
<body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:56:49.613

发生这种情况的原因通常是因为 IE 中的配置设置，它告诉它在某些条件下切换到兼容模式。这通常会在您浏览本地网络中的站点时发生——因此通常会在您测试正在开发的站点时发生。

当然，您可以通过更改配置将其关闭。但是您的用户仍然可以启用该设置，因此您需要尝试在站点内处理它。

这样做的方法是设置`X-UA-Compatible`元标志，您可以使用它来强制 IE 进入正确模式。

在大多数情况下，最佳设置如下：

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

将此添加到代码顶部的`<head>`块内。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:48:26.770

To force IE the use the latest available settings on the browser you can add this to your .htaccess if you use Apache:

```
# ----------------------------------------------------------------------
# Better website experience for IE users
# ----------------------------------------------------------------------

# Force the latest IE version, in various cases when it may fall back to IE7 mode
#  github.com/rails/rails/commit/123eb25#commitcomment-118920
# Use ChromeFrame if it's installed for a better experience for the poor IE folk

<IfModule mod_headers.c>
  Header set X-UA-Compatible "IE=Edge,chrome=1"
  # mod_headers can't match by content-type, but we don't want to send this header on *everything*...
  <FilesMatch "\.(js|css|gif|png|jpe?g|pdf|xml|oga|ogg|m4a|ogv|mp4|m4v|webm|svg|svgz|eot|ttf|otf|woff|ico|webp|appcache|manifest|htc|crx|oex|xpi|safariextz|vcf)$" >
    Header unset X-UA-Compatible
  </FilesMatch>
</IfModule> 
```

More info can be found (as stated) [github.com/rails/rails/commit/123eb25#commitcomment-118920](http://github.com/rails/rails/commit/123eb25#commitcomment-118920)

You can also add this as a regular meta tag:

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

if apache is not used.

And as a side note, I would suggest using html5 doctype:

```
<!doctype html> 
```

# tomcat - Apache Tomcat 和 CORS

> ID：12149355
> 
> 赞同：2
> 
> 时间：2012-08-27T20:44:16.583
> 
> 标签：tomcat, wsdl

我正在使用服务器，并且正在尝试执行跨域脚本。

我尝试添加[http://software.dzhuvinov.com/cors-filter-installation.html](http://software.dzhuvinov.com/cors-filter-installation.html)并将 java 文件放在 .../tomcat/lib/ （和 .../tomcat/webapps/MYAPP /WEB-INF/lib/ 因为它不起作用）并已修改 web.xml 以包含...

```
<servlet>
    <description>Desciption</description>
    <display-name>Displayname</display-name>
    <servlet-name>myservlet</servlet-name>
    <servlet-class>java.path</servlet-class>
</servlet>

<servlet-mapping>
    <servlet-name>myservlet</servlet-name>
    <url-pattern>/wsdl</url-pattern>
</servlet-mapping>
<filter>
     <filter-name>CORS</filter-name>
     <filter-class>com.thetransactioncompany.cors.CORSFilter</filter-class> 
</filter>

<filter-mapping>
    <filter-name>CORS</filter-name>
    <servlet-name>myservlet</servlet-name>
</filter-mapping> 
```

然后我重新启动网络服务器。

我无法让 Access-Control-Allow-Origin 工作。我不断收到 403 错误。

我想我一定没有正确遵循网站上的 3 个步骤。任何想法如何使它工作？

谢谢。

Edit1：我在此调用之前将我的 url 和我的 soap 消息声明为 url 和 soapMessage。我确信它们都很好，因为它们在soapUI中工作正常。

电话是：

```
$.ajax({ 
    type: "POST",
        url: url,
        dataType: "xml",
        contentType: "text/xml",
        //crossDomain: true, 
        data: soapMessage,
        //xhrFields: {
        //  withCredentials: true
        //},
        success: function(data){ 
            var xml = data.xml;
            console.log("Success!");
            console.log(xml);
            //[do something with the xml] 
        }, 
        error: function(data){ 
            var xml = data.xml;
            console.log("Error!");
            console.log(xml);
            //[do something with the xml] 
        }, 
        complete: function(data){ 
            var xml = data.xml;
            console.log("Complete!");
            console.log(xml);
            //[do something with the xml] 
        } 
```

我一直在尝试不同的领域，但运气不佳。我不确定它是否值得注意，但是当我不包含 dataType 时，响应标头指示我想要查看的 Access-Control-Allow-Origin 并返回 415 错误（不支持媒体类型）。

示例请求标头：

```
OPTIONS /servlet/wsdl?wsdl HTTP/1.1
Host: otherserver:8080
Connection: keep-alive
Access-Control-Request-Method: POST
Origin: thiswebpage.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.83 Safari/537.1
Access-Control-Request-Headers: origin, content-type, accept
Accept: */*
Referer: thiswebpage.com/thisForm.cfm
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3 
```

示例响应标头：

```
HTTP/1.1 403 Forbidden
Server: Apache-Coyote/1.1
Content-Type: text/plain
Content-Length: 86
Date: Tue, 28 Aug 2012 13:12:04 GMT 
```

还有其他过滤器（web.xml 文件很大），但唯一可能影响事情的是这些。我需要去创建文件的公司，因为我的老板可能不会让我碰这些（我只是实习生）。

```
<filter>
    <filter-name>agentSecurityModeFilter</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<filter-mapping>
    <filter-name>agentSecurityModeFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

我不确定他们在这里做什么......似乎他们将相同的过滤器两次添加到具有不同名称的相同 url 模式中。

再次，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T20:05:00.587

您是否尝试通过以下方式配置 CORSFilter？

```
<filter>
    <filter-name>CORS</filter-name>
    <filter-class>com.thetransactioncompany.cors.CORSFilter</filter-class>

    <init-param>
            <param-name>cors.allowOrigin</param-name>
            <param-value>thiswebpage.com</param-value>
    </init-param>
</filter> 
```

# ms-word - 在 Java 中将 Microsoft Word 转换为 PDF 的最佳方法是哪种（JODConverter+open Office 或 Apache POI HWPF+iText）？

> ID：12149358
> 
> 赞同：1
> 
> 时间：2012-08-27T20:44:29.270
> 
> 标签：ms-word, openoffice.org, document-conversion

在我的应用程序中，当客户状态发生变化时，我必须向客户发送自动电子邮件。我需要在该电子邮件中附加一份文件，该文件应为 pdf 格式。我必须从现有的 word 文档创建这个附加的 PDF 文档。作为[Apache](http://poi.apache.org/hwpf/index.html) [Open](http://www.artofsolving.com/opensource/jodconverter) [Office](http://wiki.openoffice.org/wiki/Main_Page)是安装程序，每次我想转换文档时都必须作为服务启动[HWPF](http://poi.apache.org/hwpf/index.html) + [iText](http://itextpdf.com/) 。请建议我使用哪个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T21:50:29.137

**披露：我领导 docx4j 项目**

**JODConverter + OpenOffice 可能会为您提供对二进制 .doc**文件中最广泛功能的最佳支持。HWPF 仅支持 .doc 内容的受限子集。

如果您的文档是标准票价段落、表格、图像、页眉/页脚**docx**文件，则 docx4j 应该可以满足您的需求（它包括通过 Apache FOP 输出的 PDF）。

# node.js - 找出一系列回调（从循环触发）何时全部执行的正确方法是什么？

> ID：12149365
> 
> 赞同：2
> 
> 时间：2012-08-27T20:45:26.647
> 
> 标签：node.js, loops

我是 Node.js 的新手，我很好奇规定的方法是在一个进程上（重复地）运行一个循环，在执行结束时，下一步将发生，但只有在所有迭代的回调都有被解雇了。

具体来说，我正在进行 SQL 调用，在进行了一堆插入和更新后，我需要关闭 sql 连接，但是由于它们都是异步的，我无法知道它们实际上何时完成，所以我可以在会话上调用 end()。

显然，这是一个远远超出这个特定示例的问题，所以，我不是在寻找有关 sql 的具体解决方案，而是更多的一般做法，到目前为止，我有点难过。

我现在正在做的实际上是为循环对象的长度设置一个全局计数器，并在每个回调中从它递减以查看它何时达到零，但这感觉真的很笨拙，我希望有一个更优雅的（和以Javascript为中心）的方式来实现这种监控。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:55:53.800

有一堆可用的流控制库可以应用模式来帮助处理这种事情。我最喜欢的是[异步](https://github.com/caolan/async)。例如，如果您想依次运行一堆 SQL 查询，您可以使用[`series`](https://github.com/caolan/async#series)：

```
async.series([
  function(cb) { sql.exec("SOME SQL", cb) },
  function(cb) { sql.exec("SOME MORE SQL", cb) },
  function(cb) { sql.exec("SOME OTHER SQL", cb) }
], function(err, results) {
  // Here, one of two things are true:
  // (1) one of the async functions passed in an error to its callback
  //     so async immediately calls this callback with a non-null "err" value
  // (2) all of the async code is done, and "results" is
  //     an array of each of the results passed to the callbacks
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:59:27.763

我编写了自己的队列库来做到这一点（我将在这些日子里发布它），基本上将查询推送到队列（基本上是一个数组）上执行每个被删除的查询，当数组为空时发生回调。

不需要太多。

*编辑。我已经添加了这个示例代码。这不是我以前使用过的，也没有在实践中尝试过，但它应该给你一个起点。你可以用这个模式做更多的事情。

需要注意的一件事。排队有效地使您的操作同步，它们一个接一个地发生。我编写了我的 mysql 队列脚本，因此我可以在多个表上异步执行查询，但在任何一个表上同步执行，以便插入和选择按照请求的顺序发生。

```
var queue = function() {
    this.queue = [];

    /**
     * Allows you to pass a callback to run, which is executed at the end
     * This example uses a pattern where errors are returned from the 
     * functions added to the queue and then are passed to the callback 
     * for handling.
     */
    this.run = function(callback){
        var i = 0;
        var errors = [];

        while (this.queue.length > 0) {
            errors[errors.length] = this.queue[i]();
            delete this.queue[i];
            i++;
        }
        callback(errors);
    }

    this.addToQueue = function(callback){
        this.queue[this.queue.length] = callback;
    }
} 
```

采用：

```
var q = new queue();
q.addToQueue(function(){
    setTimeout(function(){alert('1');}, 100);
});

q.addToQueue(function(){
    setTimeout(function(){alert('2');}, 50);
});

q.run(); 
```

# sql-server - 如何从另一个表或 excel 文件更新表？

> ID：12149368
> 
> 赞同：1
> 
> 时间：2012-08-27T20:45:43.237
> 
> 标签：sql-server, sql-update

我有一个表 T1(col1, col2, info)，col1 是主键。现在我有另一个表 T2 (col1, col2, col3)，col1 是主键。例如，

T1：

```
col1 col2 info
num1 data1 info1
num2 data2 info2 
```

T2

```
col1 col2 col3
num1 data1 Y
num2 data2 N
num3 data3 NULL 
```

如何编写脚本来用 T2 更新 T1？结果应该是 T1：

```
col1 col2 col3 info
num1 data1 Y info1
num2 data2 N info2
num3 data3 NULL NULL 
```

另外，如果我的T2不是表格，而是excel文件，是否可以编写脚本将数据导入T1并同时更新T1？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T22:36:13.083

`col3`手动添加会更容易`T1`。更新脚本由两部分组成：更新和插入

```
UPDATE T1
SET
  T1.col3 = T2.col3  
FROM T1 INNER JOIN T2 ON T1.col1 = T2.col1;

INSERT INTO T1
  (col1, col2, col3, info)
  SELECT T2.col1, T2.col2, T2.col3, NULL 
  FROM T2
  WHERE NOT T2.col1 IN (SELECT col1 FROM T1); 
```

为了`T2`成为 Excel 文件，您需要设置`T2`为 OLEDB 表（使用链接服务器和 MS Jet 驱动程序）。

# javascript - 如何读取本地文件 IO javascript

> ID：12149374
> 
> 赞同：0
> 
> 时间：2012-08-27T20:46:02.700
> 
> 标签：javascript, file-io

如何在 JavaScript 中读取本地文本文件，没有 jquery 等？我意识到这个问题以前被问过，有无数的答案（但多年来，html 和 javascript 也发生了很大变化）。

所以这是我的场景：

*   不想为此使用任何网络服务器，因为我希望将 tarball+make 安装发送给某人进行演示并希望零安装
*   阻塞读取很好
*   文件是简单的文本文件，例如“downloaded/xyz.json”。它们确实是字符串化的 json。不想使用文件对话框来选择文件名 - 为此目的需要硬编码
*   在这种情况下，安全性不是问题，尽管我不准备使用 --disable-web-security 运行浏览器或做任何远程跨域的事情
*   环境：linux (openSuse 11.4)，使用 google-chrome
*   不想为此使用 jquery

如果可行，将不胜感激一个简单的代码片段。

# javascript - 打开一个多开手风琴选项卡并滚动到该部分中的哈希位置（IE 在评估查询字符串之前滚动到哈希锚？）

> ID：12149375
> 
> 赞同：1
> 
> 时间：2012-08-27T20:46:03.053
> 
> 标签：javascript, jquery, internet-explorer, anchor

如何创建将扩展特定手风琴部分的链接，**然后滚动到该部分中的特定 DIV？**

我正在使用最新的 jQuery UI 库以及 jquery.multi-accordion-1.5.3.js，并为 IE8 或更高版本开发

我已经能够成功地实现 multiAccordion 并且通过解析查询字符串我可以操作要扩展的部分，并滚动到第一个哈希锚。

*奇怪的是，这似乎只适用于第一个链接，对于任何其他链接它滚动过去相应的哈希锚点*，并且总体上它的行为不规律。

我遇到了一些线程，提到 IE 在识别这样的查询字符串中的哈希锚时遇到问题`index.php?page=page1#section3`，即……[为什么 Internet Explorer 不支持同时带有查询字符串和哈希/锚的书签？Firefox 工作正常](https://stackoverflow.com/questions/6703749/why-internet-explorer-does-not-support-hash-anchor-bookmark-along-with-querys)，但我还没有遇到一个解决方案...

有没有人对此有解决方案？有什么选择吗？

这是我的代码（或者如果它对您来说更清晰 - 使用相同代码的小提琴[http://jsfiddle.net/3QSmq/1/](http://jsfiddle.net/3QSmq/1/)）

**HTML**

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"     "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>jQuery UI Multi Open Accordion</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=8"/>
<link type="text/css" rel="stylesheet" href="css/jquery-ui-1.8.9.custom/jquery-ui-1.8.9.custom.css" />
<script type="text/javascript" src="jquery-1.4.3.min.js"></script>  
<script type="text/javascript" src="jquery-ui-1.8.13.custom.min.js"></script>
<script type="text/javascript" src="jquery.multi-accordion-1.5.3.js"></script>
<style type="text/css">
    /*demo page css*/
    body{ font: 62.5% "Trebuchet MS", sans-serif; margin: 50px;}
</style>    
</head>
<body>
<a href="index.html?page=tab2#something">SOMETHING</a><br />
<a href="index.html?page=tab3#something1">SOMETHING1</a>
<div id="multiAccordion">
    <h3><a href="#" id="tab1">tab 1</a></h3>
    <div>Text here
    </div>
    <h3><a href="#" id="tab2">tab 2</a></h3>
    <div>

        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut eu mauris nulla, at cursus nulla. Morbi venenatis, risus sit amet ultricies pharetra, lorem purus tempor risus, vel tincidunt lectus nisi sit amet neque. Aenean sit amet nibh orci, a gravida eros. Pellentesque dignissim, libero eu congue semper, mauris metus molestie nisi, vitae posuere felis leo ac lectus. Mauris a nisi eget sapien varius eleifend vel vel nibh. In placerat commodo blandit. Vivamus sagittis ante sed nisl sodales id luctus diam dapibus. Proin a felis tristique nulla rhoncus sollicitudin. Nullam sit amet neque augue. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Fusce at nisi sapien.
    <p id="something" style="color:red">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut eu mauris nulla, at cursus nulla. Morbi venenatis, risus sit amet ultricies pharetra, lorem purus tempor risus, vel tincidunt lectus nisi sit amet neque. Aenean sit amet nibh orci, a gravida eros. Pellentesque dignissim, libero eu congue semper, mauris metus molestie nisi, vitae posuere felis leo ac lectus. Mauris a nisi eget sapien varius eleifend vel vel nibh. In placerat commodo blandit. Vivamus sagittis ante sed nisl sodales id luctus diam dapibus. Proin a felis tristique nulla rhoncus sollicitudin. Nullam sit amet neque augue. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Fusce at nisi sapien.
    </p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut eu mauris nulla, at cursus nulla. Morbi venenatis, risus sit amet ultricies pharetra, lorem purus tempor risus, vel tincidunt lectus nisi sit amet neque. Aenean sit amet nibh orci, a gravida eros. Pellentesque dignissim, libero eu congue semper, mauris metus molestie nisi, vitae posuere felis leo ac lectus. Mauris a nisi eget sapien varius eleifend vel vel nibh. In placerat commodo blandit. Vivamus sagittis ante sed nisl sodales id luctus diam dapibus. Proin a felis tristique nulla rhoncus sollicitudin. Nullam sit amet neque augue. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Fusce at nisi sapien.

        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut eu mauris nulla, at cursus nulla. Morbi venenatis, risus sit amet ultricies pharetra, lorem purus tempor risus, vel tincidunt lectus nisi sit amet neque. Aenean sit amet nibh orci, a gravida eros. Pellentesque dignissim, libero eu congue semper, mauris metus molestie nisi, vitae posuere felis leo ac lectus. Mauris a nisi eget sapien varius eleifend vel vel nibh. In placerat commodo blandit. Vivamus sagittis ante sed nisl sodales id luctus diam dapibus. Proin a felis tristique nulla rhoncus sollicitudin. Nullam sit amet neque augue. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Fusce at nisi sapien.

    </div>
    <h3><a href="#" id="tab3">tab 3</a></h3>
    <div>

        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut eu mauris nulla, at cursus nulla. Morbi venenatis, risus sit amet ultricies pharetra, lorem purus tempor risus, vel tincidunt lectus nisi sit amet neque. Aenean sit amet nibh orci, a gravida eros. Pellentesque dignissim, libero eu congue semper, mauris metus molestie nisi, vitae posuere felis leo ac lectus. Mauris a nisi eget sapien varius eleifend vel vel nibh. In placerat commodo blandit. Vivamus sagittis ante sed nisl sodales id luctus diam dapibus. Proin a felis tristique nulla rhoncus sollicitudin. Nullam sit amet neque augue. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Fusce at nisi sapien.
    <p id="something1" style="color:red">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut eu mauris nulla, at cursus nulla. Morbi venenatis, risus sit amet ultricies pharetra, lorem purus tempor risus, vel tincidunt lectus nisi sit amet neque. Aenean sit amet nibh orci, a gravida eros. Pellentesque dignissim, libero eu congue semper, mauris metus molestie nisi, vitae posuere felis leo ac lectus. Mauris a nisi eget sapien varius eleifend vel vel nibh. In placerat commodo blandit. Vivamus sagittis ante sed nisl sodales id luctus diam dapibus. Proin a felis tristique nulla rhoncus sollicitudin. Nullam sit amet neque augue. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Fusce at nisi sapien.
    </p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut eu mauris nulla, at cursus nulla. Morbi venenatis, risus sit amet ultricies pharetra, lorem purus tempor risus, vel tincidunt lectus nisi sit amet neque. Aenean sit amet nibh orci, a gravida eros. Pellentesque dignissim, libero eu congue semper, mauris metus molestie nisi, vitae posuere felis leo ac lectus. Mauris a nisi eget sapien varius eleifend vel vel nibh. In placerat commodo blandit. Vivamus sagittis ante sed nisl sodales id luctus diam dapibus. Proin a felis tristique nulla rhoncus sollicitudin. Nullam sit amet neque augue. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Fusce at nisi sapien.

    </div>
    <h3><a href="#" id="tab4">tab 4</a></h3>
    <div>Text Here
    </div>
</div> 
```

**JavaScript**

```
$(function(){
        $('#multiAccordion').multiAccordion({
            active: [1, 2],
            click: function(event, ui) {
                //console.log('clicked')
            },
            init: function(event, ui) {
                //console.log('whoooooha')
            },
            tabShown: function(event, ui) {
                //console.log('shown')
            },
            tabHidden: function(event, ui) {
                //console.log('hidden')
            }

        });

        $('#multiAccordion').multiAccordion("option", "active", [y]);
    });

    function getQueryVariable(variable)
{
   var query = window.location.search.substring(1);
   var vars = query.split("&");

   for (var i=0;i<vars.length;i++) {
           var pair = vars[i].split("=");
           if(pair[0] == variable){return pair[1];}
   }
   return(false);

}
var x = getQueryVariable("page");

switch (x){
        case(x = "tab1"):
        y = 0;
        break;  
        case(x = "tab2"):
        y = 1;
        break;          
        case(x = "tab3"):
        y = 2;
        break;          
        case(x = "tab4"):
        y = 3;
        break;
        case(x = false):
        y = "";
        break;
        default:
        y ="";
        break;
        } 
```

有什么建议么？

PS 这是网络上其他地方对我的问题的最接近的描述，但没有答案..[另一个线程](http://www.cre8asiteforums.com/forums/index.php?showtopic=35100)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T22:21:11.620

无需在页面中包含选项卡，只需针对哈希中的 ID。因此，您的链接将如下所示：

```
<a href="#something">SOMETHING</a><br />
<a href="#something1">SOMETHING1</a> 
```

然后您可以包含此代码以从哈希中查找 ID，找到正确的选项卡并打开它。这是完整的代码和[演示](http://jsfiddle.net/Mottie/3QSmq/2/)：

```
$(function() {

    var updateAccordion = function(hash) {
        hash = hash || window.location.hash;
        var content, tab;
        // look for a hash
        if (hash && $(hash).length) {
            // find accordion content
            content = $(hash).closest('.ui-accordion-content');
            if (content.length) {
                // find "tab#" from <a> inside of accordion header (h3)
                tab = parseInt(content.prev('h3').find('a').attr('id').replace('tab',''), 10) - 1;
                $('#multiAccordion').multiAccordion("option", "active", [tab]);
            }
        }
    };

    // intercept all clicked links and look for a hash
    $('a').click(function(){
        if (this.hash) {
            updateAccordion(this.hash);
        }
    });

    $('#multiAccordion').multiAccordion({
        active: [1],
        click: function(event, ui) {
            //console.log('clicked')
        },
        init: function(event, ui) {
            //console.log('whoooooha')
        },
        tabShown: function(event, ui) {
            //console.log('shown')
        },
        tabHidden: function(event, ui) {
            //console.log('hidden')
        }
    });

    // open up accordion to correct tab after initialization
    updateAccordion();
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:35:24.360

尝试使用`document.location.hash`直接访问哈希参数。在您的示例中：

```
index.html?page=tab2#something 
```

`document.location.search`将会`?page=tab2`

`document.location.hash`将会`#something`

您正在尝试解析错误的值，所以我猜 JQuery 插件在尝试打开不存在的选项卡时会滚动到页面底部。

# swing - do点击一个不可见的按钮

> ID：12149378
> 
> 赞同：3
> 
> 时间：2012-08-27T20:46:12.667
> 
> 标签：swing, jbutton, actionlistener

我可以`doClick`在使按钮不可见后调用它吗？
像：

```
StopBtn.setVisible( false );
StopBtn.doClick(); 
```

还会`doClick()`做它的工作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T21:01:09.040

发现这一点的最简单方法当然是对其进行测试（例如，如果您担心 Oracle 的那些人会改变行为，请在单元测试中）

```
@Test
public void clickOnInvisibleButton(){
  JButton button = new JButton( "test button" );
  button.setVisible( false );
  final boolean[] buttonClicked = new boolean[]{false};
  button.addActionListener( new ActionListener(){
    @Override
    public void actionPerformed( ActionEvent e ){
      buttonClicked[0] = true;
    }  
  });
  button.doClick();
  assertTrue( "Button has not been clicked", buttonClicked[0] );
} 
```

否则，您可以查看该方法的源代码

```
public void doClick(int pressTime) {
    Dimension size = getSize();
    model.setArmed(true);
    model.setPressed(true);
    paintImmediately(new Rectangle(0,0, size.width, size.height));
    try {
        Thread.currentThread().sleep(pressTime);
    } catch(InterruptedException ie) {
    }
    model.setPressed(false);
    model.setArmed(false);
} 
```

在那里你找不到对可见性的检查。再进一步看（例如在`setPressed`模型的方法中），您会发现`enabled`状态检查，但清楚地看到没有检查可见性存在。你还看到 an`ActionEvent`被触发，这将触发`actionPerformed`按钮的方法

```
public void setPressed(boolean b) {
    if((isPressed() == b) || !isEnabled()) {
        return;
    }

    if (b) {
        stateMask |= PRESSED;
    } else {
        stateMask &= ~PRESSED;
    }

    if(!isPressed() && isArmed()) {
        int modifiers = 0;
        AWTEvent currentEvent = EventQueue.getCurrentEvent();
        if (currentEvent instanceof InputEvent) {
            modifiers = ((InputEvent)currentEvent).getModifiers();
        } else if (currentEvent instanceof ActionEvent) {
            modifiers = ((ActionEvent)currentEvent).getModifiers();
        }
        fireActionPerformed(
            new ActionEvent(this, ActionEvent.ACTION_PERFORMED,
                            getActionCommand(),
                            EventQueue.getMostRecentEventTime(),
                            modifiers));
    }

    fireStateChanged();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T20:55:36.827

我刚刚给你试过了。它仍然有效，这意味着它仍然会触发该`actionPerformed()`方法。

但是，如果禁用它，它就不起作用：`button.setEnabled(false)`这是有道理的。

# sql-server-2008 - in sql inserting from one table to another without dupes

> ID：12149388
> 
> 赞同：1
> 
> 时间：2012-08-27T20:47:09.723
> 
> 标签：sql-server-2008

this worked once before for me but the script is not working now i want toinsert into another table but without any dupes......

```
 select * from [Data_Guru].[dbo].[MORTGAGE_AUG_27_new_1] 
 where Phone not in (select Phone from [dbo].MASTER_LIST) 
```

that is the bottom part that i am having trouble with when i change it to another table it shows all of the numbers that are not in that table. and i do know for a fact that there shouldnt be many if any duplicate records in the 2 tables.. they are complete different categories....pleas help

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:38:11.403

通常，“in”和“not in”查询的问题是 NULL 的存在。尝试这个：

```
select *
from [Data_Guru].[dbo].[MORTGAGE_AUG_27_new_1]
where Phone not in (select Phone from [dbo].MASTER_LIST where Phone is not null) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T04:35:07.160

```
select distinct * from [Data_Guru].[dbo].[MORTGAGE_AUG_27_new_1] t1
where NOT EXISTS (select Phone from [dbo].MASTER_LIST where t1.phone=t2.phone) 
```

# c# - LINQ 连接方法的正确返回值是多少？

> ID：12149390
> 
> 赞同：1
> 
> 时间：2012-08-27T20:47:25.290
> 
> 标签：c#, .net, linq-to-sql, 3-tier

我正在开发一个 3 层应用程序。我也使用 LINQ to SQL 进行数据访问。

DataLayer 有一个返回客户表的函数：

```
public Table<Customer> getCustomers()
{
    DataContext context = new DataContext();
    Table<Customer> customerTable = context.GetTable<Customer>();

    return customerTable;
} 
```

它被提供给业务层，其中结果被传递给表示层`IEnumerable<Customer>`：

```
public IEnumerable<Customer> getCustomers()
{
    CustomerDAL customerDAL = new CustomerDAL();

    return from c in customerDAL.getCustomers() select c;            
} 
```

在表示层中，我只是将 IEnumerable 用于 DatagridView 的数据源。

如果我有另一个表格，如“信息”和相应的`customerDAL.getInfo()`表格怎么办？现在我想在业务层的方法中进行连接查询。我想象它是这样的：

```
public IEnumerable<Customer> getCustomerInfo()
{
    CustomerDAL customerDAL = new CustomerDAL ();

    return from c in customerDAL.getCustomers()
                  join i in customerDAL.getInfo() on c.id equals i.InfoID
                  select new { c.id, c.Name, i.DateTime, i.Project };
} 
```

问题是 IEnumerable 需要对象的类型。我的返回值不再是客户表，而是客户表和信息表的组合。我做对了吗？这里返回值的正确选择是什么？

根据您的建议，我创建了一个自定义类`CustomerInfo.cs`：

```
public class CustomerInfo
    {        
        string name { get; set; }
        long id { get; set; }
        string dateTime { get; set; }
        string project { get; set; }

        public CustomerInfo(long _id, string _name, string _date, string _project) 
        {
            name = _name;
            id = _id;
            dateTime = _date;
            project = _project;
        }
    } 
```

然后我调用与 Reed 描述的完全相同的方法。但是在表示层中，当我设置数据源时，我得到了异常：

```
The query contains references to items defined on a different data context. 
```

实际上，并非所有实体类都在同一个 .dbml 文件中。有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:54:23.897

> 这里返回值的正确选择是什么？

如果要返回强类型类，则需要一个自定义类来表示这种类型，例如`CustomerInfo`类。您需要定义此类，并包含适当的属性和构造函数。然后你可以这样做：

```
public IEnumerable<CustomerInfo> GetCustomerInfo()
{
        CustomerDAL customerDAL = new CustomerDAL();

        return from c in customerDAL.getCustomers()
                    join i in customerDAL.getInfo() on c.id equals i.InfoID
                    select new CustomerInfo(c.id, c.Name, i.DateTime, i.Project);
} 
```

这将允许您以强类型的方式返回所需的确切信息。我认为在这种情况下创建自定义类尤其重要，因为您已将其定义为公共 API 的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:31:25.447

关于第二个错误：

然后我调用与 Reed 描述的完全相同的方法。但是在表示层中，当我设置 DataSource 时出现异常：查询包含对在不同数据上下文中定义的项目的引用。

Most likely your DAL is instantiating a separate instance of the context for each table that you are returning (Typical in a ActiveRecord patterned implementation). In order for the join to work, both tables need to be retrieved by the same context object. You may want to modify your DAL so that you inject the context in the constructor of the DALs so that you can centralize the lifetime of the context.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T20:50:32.137

到目前为止，一切看起来都不错。如果您只想在单个方法的范围内使用查询，那么使用匿名类（这是您当前正在做的）就可以了。既然你不是，你需要为你的投影创建一个具体的类，以便你可以返回它。

查询将变为：

```
select new SomeClassYouAreAboutToCreate { c.id, c.Name, i.DateTime, i.Project }; 
```

该类可能只有一堆属性，`id`,`Name`等。您只需将这些属性设置在`Select`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T20:55:33.677

当你创建一个这样的匿名对象时，它的类型是`dynamic`. 因此，要返回这样的匿名对象列表，您将使用以下签名：

```
public IEnumerable<dynamic> getCustomerInfo() {
    CustomerDAL customerDAL = new CustomerDAL ();

    return from c in customerDAL.getCustomers()
        join i in customerDAL.getInfo() on c.id equals i.InfoID
        select new { c.id, c.Name, i.DateTime, i.Project };
} 
```

但请记住，该`dynamic`类型有其缺点。特别是，您失去了强类型，这可能会引入难以发现的错误。您应该考虑[Servy 的答案](https://stackoverflow.com/a/12149430/1159478)以获得更强大的解决方案。

# javascript - How to fix Javascript obfuscation virus from website

> ID：12149391
> 
> 赞同：0
> 
> 时间：2012-08-27T20:47:26.187
> 
> 标签：javascript, web, obfuscation, antivirus, malware

I'm having a problem with the website I'm helping manage. Visitors are getting a JavaScript Obfuscation warning from our site. We haven't purposely obfuscated any of our code, which only leaves a malicious attack as the probable cause. It doesn't look like our antivirus is going to fix the problem. I'm not finding a whole lot of useful information on this issue online. What should I do to address this? Is there some utility that would work for a Linux server that may help us find the source of the problem, and remove the threat?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:50:51.357

第一步是将您现在服务器上的内容与您最初放置的内容进行比较。这应该告诉您它是否处于您最初部署的相同状态。

如果它不在同一状态，则将其放回该状态（例如，通过从版本控制中获取源代码）并进行全面的安全审核。

如果代码确实是您最初放在那里的代码，则您正在使用的第三方 JavaScript 库（或您自己的库，如果您使用某些技术缩小代码）可能会触发防病毒产品的误报. 如果是这种情况，请找出哪些防病毒软件会触发警告并向该供应商提交误报报告。每个主要的反病毒供应商都有在线提交误报报告的方法。他们通常会在几天内采取行动。

# objective-c - nsdate from picker to string and back to date, eventually passed to another controller

> ID：12149398
> 
> 赞同：1
> 
> 时间：2012-08-27T20:47:50.420
> 
> 标签：objective-c

uidate picker has proper user zone set.

```
NSDate *date= Uidatepicker.date;
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init]; 
[dateFormatter setDateStyle:NSDateFormatterMediumStyle]; 
[dateFormatter setTimeZone:[NSTimeZone localTimezone]];
//show correct date and time
NSString *string=[dateFormatter stringFromDate:date]; 

//back to date 
NSDate *outDate=[dateFormatter dateFromString:string]; 
```

The outdate is passed to another controller and eventually used to query db using time since 1970\. The date used in the query has +4 hours (GMT time). I think it should have localtime. I know the NSdate has no timezone but I need the correct time for the db query. The db seems to have correct time since 1970 (based on local time). I am converting to string to check in this case as time is off by +4 hours. Any suggestions and appreciate your help.

# ruby-on-rails - 通过 Shopify 应用代理获取用户订阅

> ID：12149401
> 
> 赞同：1
> 
> 时间：2012-08-27T20:48:06.147
> 
> 标签：ruby-on-rails, ruby, shopify

App 代理可以用于为单独的后端 Rails 应用程序传递各种 ID 吗？

我有一个案例，我们在单独的 rails 应用程序中实现了订阅系统，但我们想向用户展示他们从 Shopify 的订阅。为此，我想在 Shopify 上添加一个应用代理，例如：

代理网址：subscriptions.com/api/customers/subscriptions 代理路径：/a/customers

但我希望能够代理 /a/customers/:customer_id/subscriptions，甚至可能是 /a/customers/:customer_id/subscriptions/:id （用于显示订阅液体响应），因此将 id 连接到 url是我的主要目标。

在 rails 方面，我可以轻松地从参数中提取 path_prefix，这取决于 Shopify 如何匹配我猜的代理路径。

这是可能吗？或者有没有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T14:31:17.150

额外的路径组件被附加到代理 URL。Shopify[应用程序代理](http://api.shopify.com/app_proxy.html)文档甚至在代理请求部分提供了一个示例。

因此，对于您而言，代理 url 在哪里，`http://subscriptions.com/api/customers/subscriptions`而代理路径是`/a/customers`一个请求，然后`/a/customers/:customer_id/subscriptions`将被代理到`http://subscriptions.com/api/customers/subscriptions/:customer_id/subscriptions`

所以听起来代理请求已经正是你想要的。

# django - 使用 paramiko 在 vi rtualenv 中安装 Django

> ID：12149402
> 
> 赞同：1
> 
> 时间：2012-08-27T20:48:08.763
> 
> 标签：django, rabbitmq, celery, pip

我正在使用 paramiko 并通过 ssh 创建一些 virtualenvs，如下所示：

```
from paramiko import SSHClient, SSHConfig

def ssh_connect(self):
    # ssh config file
    config = SSHConfig()
    config.parse(open(settings.SSH_CONFIG))
    o = config.lookup('my_key')

    # ssh client
    ssh_client = SSHClient()
    ssh_client.load_system_host_keys()
    ssh_client.connect(o['hostname'], username=o['user'])
    return ssh_client

def create_virtualenv(self):
    ssh = self.ssh_connect()
    venv_path = '/srv/virtualenvs/%s' % self.domain
    cmd = 'virtualenv %s' % env_path
    stdin = ssh.exec_command(cmd)
    self.create_database()
    ssh.close() 
```

现在我在这里遇到了一些障碍，因为我还想用 pip 将 Django 安装到这个新创建的 virtualenv 中。我尝试了一个 postmkvirtualenv 钩子，因为我确实在该服务器上安装了 virtualenvwrapper，但是当我使用上面的代码创建新环境时，它似乎没有运行。

谁能给我任何关于如何以这种方式安装 Django 的提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:04:19.540

您是否尝试使用**workon**命令？此命令是 virtualenvwrapper 的一部分，允许您激活给定的 virtualenv，您应该能够执行以下操作：

```
def create_virtualenv(self):
    ssh = self.ssh_connect()
    venv_path = '/srv/virtualenvs/%s' % self.domain
    cmd = 'workon %s; pip install Django' % env_path
    stdin = ssh.exec_command(cmd)
    self.create_database()
    ssh.close() 
```

# java - 无法转换 ArrayList 到数组列表

> ID：12149404
> 
> 赞同：4
> 
> 时间：2012-08-27T20:48:18.077
> 
> 标签：java, swing, arraylist, jcombobox

我有一个奇怪的（在我看来）问题。我目前正在为自定义渲染器中需要的一些自定义功能制作自定义 JComboBoxModel，我还不确定如何处理，稍后我将发布相关内容。

无论如何，正如标题所暗示的那样，我遇到了一些类型错误。

这是类（当前）代码：

```
package miscclasses;
import java.util.ArrayList;
import javax.swing.AbstractListModel;

public class CustomComboBoxModel<String> extends AbstractListModel<String> {
    /**
     * Contains a list of row indexes that shouldn't be displayed.
     */
    private ArrayList<String> alreadySelectedIndexes;
    /**
     * The comboBoxes selected index.
     */
    private int selectedIndex=-1;
    /**
     * Contains a list of values in this model.
     */
    private ArrayList<String> vals;
    /**
     * Creates an empty CustomComboBoxModel.
     */
    public CustomComboBoxModel() {
        this.alreadySelectedIndexes=new ArrayList<>();
        this.vals = new ArrayList<>();
    }
    /**Creates a CustomComboBoxModel with the values passed in.
     * 
     * @param values the row values.
     */
    public CustomComboBoxModel(ArrayList<String> values) {
        this();
        this.vals.addAll(values);
    }

    public CustomComboBoxModel(ArrayList<String> values, ArrayList<String> alreadySelected) {
        this(values);
        this.alreadySelectedIndexes.addAll(alreadySelected);
    }

    public CustomComboBoxModel(ArrayList<String> values, ArrayList<String> alreadySelected, int selectedIndex) {
        this(values, alreadySelected);
        this.selectedIndex=selectedIndex;
    }

    public CustomComboBoxModel(ArrayList<String> values, ArrayList<String> alreadySelected, String selectedValue) {
        this(values, alreadySelected);
        if(!this.vals.isEmpty()) {
            //this.selectedIndex = Misc.containsI(this.vals, selectedValue);
        }
    }

    @Override
    public int getSize() {
        return this.vals.size();
    }

    @Override
    public String getElementAt(int i) {
        return this.vals.get(i);
    }

    public boolean isRowSelected(int i) {
        return ((!this.alreadySelectedIndexes.contains(Integer.toString(i)))?false:true);
    }
} 
```

我收到的错误在第 55 行，我尝试在其中获取所选值索引。这是构造函数中的注释行，它接受两个 ArrayList 列表和一个字符串值。该错误指出“没有适合的方法 containsI(java.util.ArrayList,String) 方法 miscclasses.Misc.containsI(java.util.ArrayList, java.lang.String) 不适用”。

据我所知 String 和 java.lang.String 是完全相同的东西。因此，我似乎无法弄清楚可能导致此问题的原因，并认为我会来问那些比我更了解 Code-fu 方式的人。

作为参考，Misc.containsI(ArrayList,String) 代码在这里：

```
 /**
 * Finds the index of value Target. Returns -1 if this ArrayList doesn't contain Target.
 * @param a         ArrayList of Strings a.
 * @param target    Value to find.
 * @return          Index of target if found; Else returns -1.
 */
public static int containsI(ArrayList<String> a, String target) {
    for (int i = 0; i < a.size(); i++)
    {
        if(a.get(i).equalsIgnoreCase(target))
            return i;
    }
    return -1;
} 
```

我还奇怪地在我的 isRowSelected(int i) 函数中收到以下警告：“对 java.util.Collection.contains 的可疑调用：预期类型字符串，实际类型字符串”。

同样，我不明白为什么我会收到警告。它似乎是完全有效的代码，我之前也做过类似的事情。对于这个奇怪的警告和错误的任何帮助，将不胜感激。

编辑：更改声明，使其内容为：

```
public class CustomComboBoxModel extends AbstractListModel<String> 
```

代替：

```
public class CustomComboBoxModel<String> extends AbstractListModel<String> 
```

似乎已经摆脱了警告和错误。但是我不明白为什么，因为我声明了一个自定义 JList 模式：

```
public class CustomListModel<String> extends javax.swing.DefaultListModel<String> 
```

在同一个包中没有错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-27T20:51:09.017

在这一行中，您声明了一个名为的类型参数`String`：

```
public class CustomComboBoxModel<String> extends AbstractListModel<String> {
                                 ^^^^^^ 
```

当您稍后提到`String`编译器时，认为您的意思是类型参数，而不是 `java.lang.String`类。

这里的解决方案是删除类型参数，因为您不需要类型参数。

* * *

以下简化示例给出了类似的错误消息：

```
class Foo<String>
{
    String s = ""; // error: incompatible types
} 
```

完整的错误信息是：

```
Main.java:3：不兼容的类型
找到：java.lang.String
必需：字符串
    字符串 s = "";
               ^

```

在线查看：[ideone](http://ideone.com/CmG17)

# javascript - 对象不支持 Internet Explorer 10 (Windows 8) 中的属性或方法“transformNode”

> ID：12149410
> 
> 赞同：5
> 
> 时间：2012-08-27T20:48:35.023
> 
> 标签：javascript, internet-explorer-10

我遇到了一些似乎只在 Windows 8 上的 Internet Explorer 10 中出现的 JavaScript 问题（IE 7、8 和 9 都可以正常工作）。我所做的基本工作是从 Web 服务获取 XML 和 XSL，然后将它们转换为 JavaScript 以使用 Sys.Net.XMLDOM 对象在页面上呈现。

```
XMLDOM = Sys.Net.XMLDOM;

var xsl = // XSL gotten from somewhere else 
var xmlString = // XML gotten from somewhere else as a string...
var xml = new XMLDOM(xmlString);

var content = xml.transformNode(xsl); 
```

当我在 IE 10 中使用上述代码时，我得到：

> 对象不支持属性或方法“transformNode”

关于 Internet Explorer 10 为何这样做的任何想法？

**编辑**

我也试过这个：

```
xmldoc = new ActiveXObject("Msxml2.DOMDocument"); 
xmldoc.async = false; 
xmldoc.load(xml); 

xsldoc = new ActiveXObject("Msxml2.DOMDocument"); 
xsldoc.async = false; 
xsldoc.load(xsl); 

var content = xmldoc.transformNode(xsldoc); 
```

这适用于所有以前版本的 IE，但在 IE 10 中我得到：

> 引用未声明的命名空间前缀：'atom'。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T21:37:15.633

IE 9 及 grater 不支持，试试这个功能（[网上找](http://www.roelvanlisdonk.nl/?p=2113)的）

```
function TransformToHtmlText(xmlDoc, xsltDoc) {
    if (typeof (XSLTProcessor) != "undefined") { // FF, Safari, Chrome etc
        var xsltProcessor = new XSLTProcessor();
        xsltProcessor.importStylesheet(xsltDoc);
        var xmlFragment = xsltProcessor.transformToFragment(xmlDoc, document);
        return GetXmlStringFromXmlDoc(xmlFragment);
    }

    if (typeof (xmlDoc.transformNode) != "undefined") { // IE6, IE7, IE8
        return xmlDoc.transformNode(xsltDoc);
    }
    else {
        try { // IE9 and grater
            if (window.ActiveXObject) {
                var xslt = new ActiveXObject("Msxml2.XSLTemplate");
                var xslDoc = new ActiveXObject("Msxml2.FreeThreadedDOMDocument");
                xslDoc.loadXML(xsltDoc.xml);
                xslt.stylesheet = xslDoc;
                var xslProc = xslt.createProcessor();
                xslProc.input = xmlDoc;
                xslProc.transform();
                return xslProc.output;
            }
        }
        catch (e) {
            alert("The type [XSLTProcessor] and the function [XmlDocument.transformNode] are not supported by this browser, can't transform XML document to HTML string!");
            return null;
        }

    }
}
var content = TransformToHtmlText(xml, xsl); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T16:47:48.150

找到了答案：http: [//blogs.msdn.com/b/ie/archive/2012/07/19/xmlhttprequest-responsexml-in-ie10-release-preview.aspx](http://blogs.msdn.com/b/ie/archive/2012/07/19/xmlhttprequest-responsexml-in-ie10-release-preview.aspx)

IE 10 需要使用将 responseType 设置为“msxml-document”的 XMLHttpRequest。一旦我将代码切换到那个，一切都在所有浏览器中完美运行：

```
if (window.XMLHttpRequest) {
    xhr = new XMLHttpRequest();
} else {
    xhr = new ActiveXObject("Microsoft.XMLHTTP"); // For IE 6
}
xhr.open("GET", url, false);
try { xhr.responseType = "msxml-document"; } catch (e) { };
xhr.send(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-08T19:18:38.723

我在 IE 9 上遇到了同样的问题，直到我停止尝试`xslt`使用`jQuery`. 我使用以下脚本加载了文件：[https](https://msdn.microsoft.com/en-us/library/ms762796%28v=vs.85%29.aspx) ://msdn.microsoft.com/en-us/library/ms762796%28v=vs.85%29.aspx 。

然后我就可以使用该`transformNode()`功能了。这是他们提供的脚本：

```
<HTML>
<HEAD>
  <TITLE>sample</TITLE>
  <SCRIPT language = "javascript">
     function init()
     {
        var srcTree =
           new ActiveXObject("Msxml2.DOMDocument.6.0");
        srcTree.async=false;
        // You can substitute other XML file names here.
        srcTree.load("hello.xml"); 

        var xsltTree =
           new ActiveXObject("Msxml2.DOMDocument.6.0");
        xsltTree.async = false;
        // You can substitute other XSLT file names here.
        xsltTree.load("hello.xsl");
        resTree.innerHTML = srcTree.transformNode(xsltTree);
     }
  </SCRIPT>
</HEAD>

<BODY onload = "init()" >
   <div id="resTree"></div>
</BODY>

</HTML> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-14T15:04:57.020

首先归功于发布 Sheik Heera 分享的功能的 Roel van Lisdonk。

我发现了这个函数，因为它在 Chrome 中不起作用，因为 GetXmlStringFromXmlDoc() 所以我使用了 XMLSerializer：

例如：

```
if (typeof(GetXmlStringFromXmlDoc)!= "undefined")
{       
    return GetXmlStringFromXmlDoc(xmlFragment);
}
else
{
    // chrome friendly

    // get a xml serializer object
    var xmls = new XMLSerializer();

    // convert dom into string
    var sResult = xmls.serializeToString(xmlFragment);
    //extract contents of transform iix node if it is present
    if (sResult.indexOf("<transformiix:result") > -1)
    {
        sResult = sResult.substring(sResult.indexOf(">") + 1, sResult.lastIndexOf("<"));
    }       
    return sResult;
} 
```

修改后的功能现在是：

```
function TransformToHtmlText(xmlDoc, xsltDoc) 
{
    // 1.
    if (typeof (XSLTProcessor) != "undefined") 
    {
        var xsltProcessor = new XSLTProcessor();
        xsltProcessor.importStylesheet(xsltDoc);
        var xmlFragment = xsltProcessor.transformToFragment(xmlDoc, document);

        if (typeof(GetXmlStringFromXmlDoc)!= "undefined")
        {       
            return GetXmlStringFromXmlDoc(xmlFragment);
        }
        else
        {
            // chrome friendly

            // get a xml serializer object
            var xmls = new XMLSerializer();

            // convert dom into string
            var sResult = xmls.serializeToString(xmlFragment);
            //extract contents of transform iix node if it is present
            if (sResult.indexOf("<transformiix:result") > -1)
            {
                sResult = sResult.substring(sResult.indexOf(">") + 1, sResult.lastIndexOf("<"));
            }       
            return sResult;
        }
    }
    // 2.
    if (typeof (xmlDoc.transformNode) != "undefined") 
    {
        return xmlDoc.transformNode(xsltDoc);
    }
    else {

            var activeXOb = null;
            try { activeXOb = new ActiveXObject("Msxml2.XSLTemplate"); } catch (ex) {}

        try {
            // 3
            if (activeXOb) 
            {
                var xslt = activeXOb;
                var xslDoc = new ActiveXObject("Msxml2.FreeThreadedDOMDocument");
                xslDoc.loadXML(xsltDoc.xml);
                xslt.stylesheet = xslDoc;
                var xslProc = xslt.createProcessor();
                xslProc.input = xmlDoc;
                xslProc.transform();

                return xslProc.output;
            }
        }
        catch (e) 
        {
            // 4
            alert("The type [XSLTProcessor] and the function [XmlDocument.transformNode] are not supported by this browser, can't transform XML document to HTML string!");
            return null;
        }

    }
} 
```

# php - How do i get the variable into the javascript tag?

> ID：12149416
> 
> 赞同：-1
> 
> 时间：2012-08-27T20:49:01.823
> 
> 标签：php, mysql, mysqli

I have managed to get part of this code working.

The variables will echo without problem but as soon as I try and put them into the javascript tag they stop working.

What am I doing wrong??

```
 <?php
$id_1 = $_GET['id'];
$tag_id = "tag_id";
$Activity_Tag_String = "Activity_Tag_String";
$group_tag_string = "group_tag_string";

$link = mysqli_connect("localhost", "username", "password", "database");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$query = "SELECT $tag_id, $Activity_Tag_String, $group_tag_string, advertiser_id FROM tbl_tags WHERE advertiser_id = '$id_1'";
$result = mysqli_query($link, $query);

?>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Mate Example</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
</head> 
<body>
<script type="text/javascript">
var branch = window.location.href;

var axel = Math.random() + "";
var a = axel * 10000000000000;
document.write('<iframe src="http://fls.doubleclick.net/activityi;src=<?php $tag_id?>;type=<?php $Activity_Tag_String?>;cat=<?php $group_tag_string?>;u1='';ord=' + a + '?" width="1" height="1" frameborder="0" style="display:none"></iframe>');

</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T20:51:24.987

```
<?php $tag_id?> 
```

应该

```
<?= $tag_id ?> 
```

或者

```
<?php echo $tag_id ?> 
```

您的版本只是在执行 PHP 等效项：

```
$tag_id; 
```

这是一个无所事事的声明。您需要实际**回显**该变量的内容。

另外，请注意您的代码容易受到[SQL 注入攻击](http://bobby-tables.com)，您应该在执行任何其他操作之前修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:51:41.417

对于 js 脚本部分尝试：

```
<?php echo $variable;?> 
```

或简而言之

```
<?=$var?> 
```

# deployment - Do MSIs contain a checksum?

> ID：12149419
> 
> 赞同：0
> 
> 时间：2012-08-27T20:49:29.233
> 
> 标签：deployment, installation, wix, windows-installer, checksum

I'm writing a utility to deploy some MSIs on remote machines. Do MSI files contain a built-in checksum that will be checked when they are run, or do I need to write something to check that they have been downloaded OK? The MSIs will be created with WiX if that makes any difference.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:56:00.280

对 MSI 进行数字签名，您就会知道它是否有效。

# c# - IIS Process Not Letting Go Of Files?

> ID：12149420
> 
> 赞同：0
> 
> 时间：2012-08-27T20:49:47.767
> 
> 标签：c#, file, iis

I have written a web app that has to save a few files. I have developed this app in C# using Visual Web Developer 2010 Express. The program executes flawlessly in VWD but when I deploy it to the server it runs into problems. One problem in particular is that the files being saved are held onto by some process and I can't access them or delete them when I need to. I believe I am properly closing the file streams. Here is an example of one such save:

```
string[] lines = MessagesTextbox.Text.Split(new string[] { Environment.NewLine }, StringSplitOptions.None);
string messagesFileLocation = currDir + "\\" + reportDir + "\\" + messagesFile;
FileStream fs2 = File.Open(messagesFileLocation, FileMode.Create, FileAccess.Write);
using (StreamWriter sw = new StreamWriter(fs2))
{
    sw.WriteLine("<Messages>");
    foreach (string message in lines)
    {
        if (!message.Equals(""))
        {
            sw.WriteLine("\t<message>" + message + "</message>");
        }
    }
    sw.WriteLine("</Messages>");
}
fs2.Close(); 
```

The problem is also occurring when I use HtmlAgilityPack to save the rendered HTML to a file.

The only difference between my development environment and the server is that on the server my app runs under IIS. Can anyone think of a reason why this problem might occur using IIS when it doesn't occur ever in my development environment? The person who administers the server thinks it has to be my code but, like I said, it has been running for several weeks on my own machine without any of these problems.

Any suggestions are appreciated.

Regards.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:53:48.797

如果抛出异常，您的 FileStream fs2 将不会关闭。您必须在*finally*块中关闭它，如果您将其包装在自己的*using*中，您将免费获得该块。

**作为良好的编码实践，实现*IDisposable的***所有**内容都应包装在*using*块中（或以其他方式处理某些高级情况）。有一些边缘情况可以确定在哪里无关紧要，但始终确保在不再需要实现接口的对象时立即调用*IDisposable.Dispose()是一个可靠的习惯。***

# matlab - MATLAB中的等高线图不是圆形的

> ID：12149424
> 
> 赞同：0
> 
> 时间：2012-08-27T20:50:13.523
> 
> 标签：matlab, contour

我正在尝试在 MATLAB 中获取基本的圆形温度等高线图。

相反，我得到了一条直线，根本不像

MATLAB 的等高线图示例。我想要 4 个圆形区域

分别代表90度、80度、70度、60度。

这是我的代码：

```
long = [0 1 2 3; 4 5 6 7; 8 9 10 11; 12 13 14 15];
lat = [15 16 17 18; 19 20 21 22; 23 24 25 26; 27 28 29 30];
temp = [98 95 94 92; 85 82 81 80; 72 75 74 71; 65 62 61 69];
figure; 
contour(long,lat,temp,4) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:09:01.277

问题是您只提供了一行数据而不是矩阵。您需要为每对`long`和提供一个温度`lat`。因此，如果`long`和`lat`都是 1x15，那么`temp`应该是 15x15。

例如：

```
x = 1:3
y = 1:3
z = [1 2 1; 2 3 2; 1 2 1];

contour(x,y,z); 
```

# objective-c - UIView animateWithDuration 不尊重持续时间

> ID：12149427
> 
> 赞同：0
> 
> 时间：2012-08-27T20:50:21.387
> 
> 标签：objective-c, animation, uiview

我有一个简单的动画，可以将视图从一个位置移动到另一个位置。动画正常运行，除了不遵循方法声明中设置的持续时间...

```
[UIView beginAnimations:@"listAnimationIn" context:nil];
[UIView animateWithDuration:1.0
                      delay:1.0
                    options:UIViewAnimationCurveLinear
                 animations:^{
                     lvc.view.frame = CGRectMake(0, 0, 320, 480);
                 }
                 completion:nil];
[UIView commitAnimations]; 
```

延迟有效，但无论我为持续时间输入什么值，动画都会**快速运行（我尝试了从 0.5 到 2000 的值）。**我也尝试了一些`UIViewAnimationCurve`选项，但似乎没有任何效果。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:59:28.853

您不需要`-beginAnimations:context:`和`-commitAnimations`消息。这是旧的做法，你不应该真的混用。只需调用该`-animateWithDuration:delay:options:animations:completion:`方法。此外，如果您添加一个完成块，它将传递一个布尔变量，该变量将告诉您动画是提前终止还是运行完成。如果动画太慢，或者您有从相同视图层次结构开始的竞争动画（您确实有，使用旧样式的 begin/commit 调用），就会发生这种情况。

# iphone - iOS Coco2D 播放 2 种背景声音

> ID：12149433
> 
> 赞同：1
> 
> 时间：2012-08-27T20:50:58.060
> 
> 标签：iphone, ios, cocos2d-iphone, simpleaudioengine

Coco2D 可以播放 2 个背景音吗？

```
[[SimpleAudioEngine sharedEngine] playBackgroundMusic:@"sound1.caf" loop:YES];
[[SimpleAudioEngine sharedEngine] playBackgroundMusic:@"sound2.caf" loop:YES]; 
```

sound2 可以设置为音量的一半，而 sound1 是主导吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T08:51:45.257

强烈建议同时播放两首 BGM（背景音乐）。由于 iPhone 的硬件架构，它只有一个硬件声音解码器来播放压缩的音乐文件。

话虽如此，您的声音似乎`caf`是未压缩的格式，因此很容易使用`playEffect:`. 您可以同时播放任意数量的效果，而不必担心性能问题。

**注意：**该`playEffect:`方法只能用于未压缩的音频，例如`caf`, `aif`, ... 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T08:52:29.353

来自 CocosDenshion 的作者 Steve Oldmeadow，cocos2d 附带的音频引擎。

> 有一个播放背景音乐的 AVAudioPlayer，因此您一次只能加载一个背景音乐文件，如果您需要更复杂的东西，那么您必须推出自己的解决方案。

有趣的链接

[http://www.cocos2d-iphone.org/forum/topic/3074](http://www.cocos2d-iphone.org/forum/topic/3074)

[Cocos2d 播放2种不同的背景音乐文件或循环播放效果](https://stackoverflow.com/questions/7370886/cocos2d-play-2-different-background-music-files-or-loop-playeffect)

# html - 为什么css中的背景图像表示为url，而img中的图像只能是文件的路径

> ID：12149443
> 
> 赞同：0
> 
> 时间：2012-08-27T20:51:33.443
> 
> 标签：html, css, url, image

我们有一个设计师来做我们的 html/css，在更新一些代码时我注意到了这一点：

`img`标签只是引用图像的路径：

`<img src="/images/pic.png">`

但是对于 css（带有`background`标签），它是使用 url 指定的：

`header { height: 73px; background: url(/assets/maudi/nav.png); }`

的重要性是`url`什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T20:53:43.647

HTML 没有任何地方可以接受“URL 或其他内容”。

CSS 可以。该`background`物业就是一个典型的例子。

```
background: blue; 
```

是`blue`颜色还是相对 URL？

# sql - 维度属性未显示在商业智能开发工作室中

> ID：12149447
> 
> 赞同：1
> 
> 时间：2012-08-27T20:51:45.800
> 
> 标签：sql, sql-server, ssas, business-intelligence, dimensions

所以我有一个数据库架构，现在我需要为 Analysis Services 创建一个多维数据集。但是，我对其中一列有疑问。

这是我所做的： 1\. 创建数据源 2\. 创建数据源视图 3\. 创建维度，这就是问题所在......

所以我的数据库有 10 个表，除了一个之外，它们中的大多数都可以正常工作。一个表“CustomerSatisfaction”具有“year”、“Quarter”、“customerSatisfactionValue”和“productID”列。现在，当我从该表创建维度时，我看不到“quater”列。

基本上我使用创建维度向导，但在向导的“选择维度属性”部分我看不到“季度”列。任何想法为什么会这样？我真的希望“季度”成为一个属性，但它似乎不起作用......

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T01:39:26.630

季度是否在数据源视图中列为一列？

如果是这样，打开维度设计器并将属性从数据源视图（右侧）拖到属性列表（左侧）。

如果没有，您需要修复维度查询/刷新数据源视图中的表列列表。

# winforms - 根据类中的字段生成编辑界面（文本框/标签）

> ID：12149450
> 
> 赞同：1
> 
> 时间：2012-08-27T20:52:00.243
> 
> 标签：winforms, visual-studio

我有大量的类，需要为每个类中的字段提供一个编辑界面。有没有快速的方法来做到这一点？这更多用于故障排除/测试，所以我不太关心它的实际外观，也不担心验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:54:29.120

在我看来，这听起来像是 PropertyGrid 控件的工作。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.propertygrid.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.propertygrid.aspx)

[截图介绍](http://tickblog.wordpress.com/2008/04/20/the-propertygrid-as-a-hobbyist-game-progammer/)（可能比 MSDN 链接更容易概念化。）

# php - 如何使用 Javascript/PHP 录制用户的声音？

> ID：12149451
> 
> 赞同：18
> 
> 时间：2012-08-27T20:52:03.113
> 
> 标签：php, javascript, flash, html

我目前正在尝试创建一个允许用户录制语音笔记并将其保存到他们的帐户的测试站点。使用 PHP 或 JavaScript 执行此操作的最佳方法是什么？

我希望为此过程采取的步骤是：

1) 用户点击录制按钮。 **2) 启动记录序列。** 3) 停止序列。4) 命名文件并将其发送到服务器。

我的主要查询集中在**第二步**，我需要一些可以与用户的麦克风交互来录制声音的机制。我对网络开发本身还是新手，我不知道如何使用 JavaScript 调用录音。

在 Google 中搜索后，我在 StackOverflow 中找到了一些解决类似问题的链接，但答案没有帮助。很多解决方案都指向 Flash，但我想尽可能避免这种情况。所以我的问题归结为“是否可以使用 JavaScript 录制语音？如果可以，如何？”

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-29T13:13:12.173

HTML5 音频 API 在浏览器中没有得到广泛支持，我认为它可以在 Chrome 和 Firefox 中使用，最近将它添加到它的 nightlies 中......现阶段需要浏览器前缀，但通用 API 是......

```
navigator.getUserMedia({audio: true}, function(stream) { /* do stuff */ }); 
```

这将`webkitGetUserMedia`适用于 Chrome 和`mozGetUserMedia`Firefox。

您现在更一致的选择是通过浏览器插件（例如 Flash 或 Java）或创建用户需要安装的桌面客户端。

关于 getUserMedia 感兴趣的资源：

*   [getUserMedia 简介](http://www.html5rocks.com/en/tutorials/getusermedia/intro/)
*   [getUserMedia 添加到 Firefox nightlies](https://hacks.mozilla.org/2012/07/getusermedia-is-ready-to-roll/)
*   [Chromium 中的 getUserMedia 仅存在音频问题](http://code.google.com/p/chromium/issues/detail?id=112404)

以下问题可能会进一步帮助您：

[使用 flash 或 java servlet 将麦克风数据从浏览器上传到服务器的教程？](https://stackoverflow.com/questions/836024/tutorial-on-using-flash-or-java-servlet-to-upload-microphone-data-from-browser-t)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T04:09:46.017

您现在可以通过创建将本地 MediaStream 连接到 ScriptProcessingNode 的音频图从麦克风进行录制：

```
navigator.webkitGetUserMedia({video: true, audio: true}, function(stream) {
    var audioContext = new webkitAudioContext,
        mediaStreamSource = context.createMediaStreamSource(stream),
        processor = context.createJavaScriptNode(4096, 2, 2);

    processor.onaudioprocess = function(e) {
        // Process the audio data found in e.inputBuffer
    };

    mediaStreamSource.connect(processor);
    processor.connect(context.destination);
}); 
```

（使用 Chrome 供应商前缀）

您可以将其连接到 Websockets 甚至普通 XHR 以将块发送到您的服务器，服务器可以将其处理成音频文件。您需要将每个频道从

> 非交错 IEEE 32 位线性 PCM，标称范围为 -1 -> +1

成您选择的格式。

可以在此处找到录制音频、将其编码为 wav 文件并保存（所有客户端）的类似示例：

[https://github.com/muaz-khan/WebRTC-Experiment/tree/master/RecordRTC](https://github.com/muaz-khan/WebRTC-Experiment/tree/master/RecordRTC)

有关 AudioContext 的更多详细信息：

[http://docs.webplatform.org/wiki/apis/webaudio/AudioContext](http://docs.webplatform.org/wiki/apis/webaudio/AudioContext)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-19T07:26:28.530

在 HTML5 音频录制到来之前，您确实需要结合 Flash 和移动设备上的文件上传的解决方案。在移动设备上，文件上传屏幕通常有一个音频或视频记录器，因此用户可以直接从他们的设备进行记录。

如果设备在文件上传时没有录音机，您应该使用录像机，然后在服务器上将视频转换为 MP3。这就是我们在[recordmp3online.com](http://recordmp3online.com)上的处理方式。

# c++ - 尝试构建 log4cxx 的 64 位二进制文 件时如何修复构建错误？

> ID：12149453
> 
> 赞同：3
> 
> 时间：2012-08-27T20:52:46.250
> 
> 标签：c++, logging, log4cxx

我希望在 Windows 7 64 位下编译和使用 log4cxx，并希望将其链接到 64 位应用程序（我也需要 32 位二进制文​​件，但我找到了这些文件的副本）。我在“ [http://www.dreamcubes.com/b2/software-development/28/log4cxx-for-win32-with-vs2005/](http://www.dreamcubes.com/b2/software-development/28/log4cxx-for-win32-with-vs2005/) ”上找到了一个“最新”项目，据说可以在 Windows 下编译，但我`an explicit instantiation of a template can only occur at namespace scope`尝试构建时遇到一堆错误。

有没有人碰巧知道解决这些构建问题的方法？

# .htaccess - 使用 .htaccess 将特定的移动流量重定向到移动版本

> ID：12149458
> 
> 赞同：1
> 
> 时间：2012-08-27T20:52:59.993
> 
> 标签：.htaccess, url-rewriting

我有一个关于书籍的 PHP 网站，该网站使用已经在我的 Apache 服务器上的 .htaccess 文件中定义的 URL 重写规则，因此由于以下规则，我已经有了类似的 URL

[http://www.example.com/book/name-of-book.html](http://www.example.com/book/name-of-book.html)

```
RewriteRule ^book/([^/]+)\.html$ book.php?book=$1 [QSA,L] 
```

我想改进我的网站并制作它的移动版本，我想使用诸如

[http://m.example.com/book/name-of-book.html](http://m.example.com/book/name-of-book.html)

由于我还没有完全完成移动开发，我只希望书籍部分有移动版本。所以 www.example.com 将保持不变，但 www.example.com/book/... 会触发条件。

我应该将哪些规则附加到我的 .htaccess 文件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:42:04.347

尝试使用这个：

```
RewriteCond %{HTTP_USER_AGENT} android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge\ |maemo|midp|mmp|opera\ m(ob|in)i|palm(\ os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows\ (ce|phone)|xda|xiino [NC,OR]
RewriteCond %{HTTP_USER_AGENT} ^(1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a\ wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r\ |s\ )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1\ u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp(\ i|ip)|hs\-c|ht(c(\-|\ |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac(\ |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt(\ |\/)|klon|kpt\ |kwc\-|kyo(c|k)|le(no|xi)|lg(\ g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-|\ |o|v)|zz)|mt(50|p1|v\ )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v\ )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-|\ )|webc|whit|wi(g\ |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-) [NC]
RewriteRule ^book/([^/]+)\.html$ http://m.example.com/m_book.php?book=$1 [QSA,L,R]

RewriteRule ^book/([^/]+)\.html$ book.php?book=$1 [QSA,L] 
```

前两行中的这些可怕情况将通过其 User-Agent 标头检测移动浏览器。以下规则会将查询重定向到移动网站。

需要第四行来重写非移动设备的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:07:43.523

这几乎不是一个完整的解决方案，但它应该为您指明正确的方向。

您首先需要匹配一个移动用户代理，并且它必须位于非移动主机（www.example.com）上。然后规则本身应该匹配`/book`：

```
RewriteCond %{HTTP_USER_AGENT} (android|blackberry|googlebot-mobile|iemobile|ipad|iphone|ipod|opera\ mobile|palmos|webos) [NC]
RewriteCond %{HTTP_HOST} !^m\.example\.com$ [NC]
RewriteRule ^/?book/(.*)$ http://m.example.com/book/$1 [R,L] 
```

这些规则在您的 htaccess 中的位置很重要，因此您可能想尝试一下您认为该重定向应该发生的位置。它应该*在*您将漂亮的 URL 转换为`/book.php?book=name`URI 之前进行。

# ruby-on-rails-3 - 在 Rails 应用程序的 .text.haml 文件中缩进纯文本

> ID：12149461
> 
> 赞同：1
> 
> 时间：2012-08-27T20:53:14.050
> 
> 标签：ruby-on-rails-3, haml

在我的 rails 3.1 应用程序中，我正在处理文本电子邮件备份，并希望它在电子邮件客户端中显示为分隔成新行的文本，如下所示：

```
Lorem ipsum dolor sit amet
Consectetur adipisicing elit
Sed do eiusmod tempor incididunt
Ut labore et d  Lorem ipsum dolor sit amet Consectetur adipisicing elit Sed do eiusmod tempor incididunt Ut labore et dolore magna aliquaolore magna aliqua 
```

在我的 .text.haml 文件中，我尝试使用它：

```
:plain
  Lorem ipsum dolor sit amet
  Consectetur adipisicing elit
  Sed do eiusmod tempor incididunt
  Ut labore et dolore magna aliqua 
```

但是，当我在 gmail 中检查它时，它似乎浓缩成这样的一段：

Lorem ipsum dolor sit amet Consectetur adipisicing elit Sed do eiusmod tempor incididunt Ut labore et dolore magna aliqua

我该怎么做才能让它发挥作用？当我将此代码复制并粘贴到视图文件中并查看源代码时，它会在视图源代码中显示为我想要的文本，但会在浏览器中压缩为一个段落。这是否可能表明 gmail 正在接受文本并以这种方式对其进行格式化，而我实际上没有问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:04:27.690

我没有设置来测试这个，但我相信你想要`:escaped`或者`:preserve`（可能是后者）。

如果这些不起作用，请参阅[http://haml.info/docs/yardoc/file.HAML_REFERENCE.html#filters](http://haml.info/docs/yardoc/file.HAML_REFERENCE.html#filters)其他人（包括有关如何创建自己的信息）。

# python - 在 Windows 中使用 Python 创建个人共享

> ID：12149468
> 
> 赞同：0
> 
> 时间：2012-08-27T20:53:54.270
> 
> 标签：python, windows, share, cifs

我正在尝试使用在 Python 上运行的 IDM 系统自动创建个人文件夹。所有用户共享将在 上创建`\\\server\personal\%userID%`。`\\\server\personal and %userID%`正在作为`default_settings.home_directory`和 profileid传递。我正在尝试这样的代码：

```
share = self.config.getID('default_settings.home_directory') +  profileid
self.log.info('Share = [{0}]'.format(share))
os.makedirs(share) 
```

在我的日志中

```
Share = [\\server\personal\xr2829] 
```

但它出错了

```
WindowsError: [Error 123] The filename, directory name, or volume label syntax is  incorrect: '\\\\' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:43:02.950

试试这个替代方案：

```
os.makedirs(os.path.join(self.config.getID('default_settings.home_directory'), profileid)) 
```

应该注意斜杠/反斜杠的混淆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T22:29:29.860

我猜`//`你的配置字符串后面有一个空字符。Python 不在乎，但 C 函数支持`os.makedirs`将在 null 处停止。尝试记录`repr(share)`，这将给出字符串的更详细的表示。

**编辑：**更仔细地查看该`os.makedirs`功能提出了另一种可能性。路径被分解为组件，以便可以根据需要检查或创建每个组件。该错误消息意味着前两个斜杠（`\\\\`使用 显示时`repr`）已被分解为第一个目录元素。[文档](http://docs.python.org/library/os.html#os.makedirs)说从2.3 版开始支持 UNC 路径，但也许您使用的是非常旧的 Python 版本，或者仍然存在错误。

# gwt - eclipse中gwt/gson的Total Noob，错误：“无法为类调用无参数构造函数”

> ID：12149469
> 
> 赞同：5
> 
> 时间：2012-08-27T20:53:55.737
> 
> 标签：gwt

我正在玩这个从 twitter 获取数据的 Google Web 工具包/GSON 示例。

一切都编译得很好，但是当我作为 Web 应用程序调试时，一切都加载得很好，但是当我单击“搜索”按钮时，出现以下错误：

> 严重：javax.servlet.ServletContext 日志：调度传入的 RPC 调用 com.google.gwt.user.server.rpc.UnexpectedException 时出现异常：服务方法'public abstract java.util.List com.google.gwt.twittersearch.client.TwitterService .searchTweets(java.lang.String) throws java.io.IOException,java.lang.IllegalArgumentException' throws an unexpected exception: java.lang.RuntimeException: Unable to invoke no-args constructor for class com.google.gwt.twittersearch。 server.TwitterServiceImpl$SearchResponse。向 Gson 注册此类型的 InstanceCreator 可能会解决此问题。在 com.google.gwt.user.server.rpc.RPC.encodeResponseForFailure(RPC.java:385) 在 com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:588) 在 com.google .gwt.user.server.rpc.RemoteServiceServlet.processCall（RemoteServiceServlet.java：org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755) 的 HttpConnection$RequestHandler.content(HttpConnection.java:938) org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218) org.mortbay .jetty.HttpConnection.handle(HttpConnection.java:404) 在 org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409) 在 org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582 ) 原因：java.lang.RuntimeException：无法为类 com.google.gwt.twittersearch.server.TwitterServiceImpl$SearchResponse 调用无参数构造函数。向 Gson 注册此类型的 InstanceCreator 可能会解决此问题。在 com.google.gson.internal.ConstructorConstructor$8.construct(ConstructorConstructor.java:167) 在 com.google.gson.internal.bind。

这是 TwitterServiceImpl 代码：

```
package com.google.gwt.twittersearch.server;

import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.Reader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.net.URLEncoder;
import java.util.List;

import com.google.gwt.twittersearch.client.Tweet;
import com.google.gwt.twittersearch.client.TwitterService;
import com.google.gson.Gson;
import com.google.gwt.user.server.rpc.RemoteServiceServlet;

@SuppressWarnings("serial") 
public class TwitterServiceImpl extends RemoteServiceServlet implements
        TwitterService {

    @Override
    public List<Tweet> searchTweets(String query) throws IllegalArgumentException, IOException {
          query = query.trim();
          if (query.isEmpty()) {
            throw new IllegalArgumentException("No search query specified.");
          }

          // see: https://dev.twitter.com/docs/api/1/get/search
          String q = URLEncoder.encode(query, "UTF-8");
          URL url = new URL("http://search.twitter.com/search.json?q=" + q);
          HttpURLConnection connection = (HttpURLConnection) url.openConnection();
          InputStream response = null;
          try {
            response = connection.getInputStream();
            return parseSearchResponse(response);
          } finally {
            if (response != null) {
              response.close();
            }
          }
    }

    @Override
    public String getPrivacyPolicy() throws IOException {
        // see: https://dev.twitter.com/docs/api/1/get/legal/privacy
        URL url = new URL("https://api.twitter.com/1/legal/privacy.json");
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        InputStream response = null;
        try {
            response = connection.getInputStream();
            return parsePolicyResponse(response);
        } finally {
            if (response != null) {
                response.close();
            }
        }
    }

    /**
     * Parses the privacy policy response returned from the Twitter API.
     * @param response the response
     * @return the privacy policy
     * @throws IOException if there was a problem reading the response
     */
    private String parsePolicyResponse(InputStream response) throws IOException {
        Reader reader = new InputStreamReader(response);
        PrivacyPolicyResponse privacyPolicyResponse = new Gson().fromJson(reader, PrivacyPolicyResponse.class);
        return privacyPolicyResponse.privacy;
    }

    /**
     * Parses the search response returned from the Twitter API.
     * @param response the response
     * @return the search results
     * @throws IOException if there was a problem reading the response
     */

    private List<Tweet> parseSearchResponse(InputStream response) throws IOException {
          Reader reader = new InputStreamReader(response);
          SearchResponse searchResponse = new Gson().fromJson(reader, SearchResponse.class);
          return searchResponse.results;
        }

    private class PrivacyPolicyResponse {
    public String privacy;
    }

    private class SearchResponse {
      public List<Tweet> results;
    }

} 
```

这是入口点代码：

```
 package com.google.gwt.twittersearch.client;

import java.util.List;
import com.google.gwt.safehtml.shared.SafeHtmlBuilder;
import com.google.gwt.core.client.EntryPoint;
import com.google.gwt.core.client.GWT;
import com.google.gwt.event.dom.client.ClickEvent;
import com.google.gwt.event.dom.client.ClickHandler;
import com.google.gwt.user.client.rpc.AsyncCallback;
import com.google.gwt.user.client.ui.Button;
import com.google.gwt.user.client.ui.HTML;
import com.google.gwt.user.client.ui.HorizontalPanel;
import com.google.gwt.user.client.ui.Image;
import com.google.gwt.user.client.ui.Label;
import com.google.gwt.user.client.ui.Panel;
import com.google.gwt.user.client.ui.RootPanel;
import com.google.gwt.user.client.ui.TextBox;
import com.google.gwt.user.client.ui.VerticalPanel;

/**
 * Entry point classes define <code>onModuleLoad()</code>.
 */
public class TwitterSearch implements EntryPoint {
  private Button privacyPolicyButton;
  private Button searchButton;
  private TextBox searchQueryTextBox;
  private Panel resultsPanel;
  private Label errorLabel;
  private Image loadingImage;
  private final TwitterServiceAsync service = GWT.create(TwitterService.class);

/**
 * This is the entry point method.
 */
public void onModuleLoad() {
    createWidgets();
    layoutWidgets();

}

private void createWidgets() {
    searchQueryTextBox = new TextBox();

    searchButton = new Button("Search");
    searchButton.addClickHandler(new ClickHandler() {
        @Override
        public void onClick(ClickEvent event) {
            setLoading(true);
            String query = searchQueryTextBox.getText();
            service.searchTweets(query, new AsyncCallback<List<Tweet>>() {
                @Override
                public void onFailure(Throwable caught) {
                    errorLabel.setText(caught.getMessage());
                    errorLabel.setVisible(true);
                    setLoading(false);
                }

                @Override
                public void onSuccess(List<Tweet> result) {
                    resultsPanel.clear();
                    for (Tweet tweet : result) {
                        SafeHtmlBuilder builder = new SafeHtmlBuilder();
                        builder.appendHtmlConstant("<b>User: </b>");
                        builder.appendEscaped(tweet.getFrom_user());
                        builder.appendHtmlConstant("<br /><b>Created: </b>");
                        builder.appendEscaped(tweet.getCreated_at());
                        builder.appendHtmlConstant("<br /><b>Tweet: </b>");
                        builder.appendEscaped(tweet.getText());
                        builder.appendHtmlConstant("<br /><br />");
                        resultsPanel.add(new HTML(builder.toSafeHtml()));
                    }
                    setLoading(false);
                }
            });
        }
    });

    privacyPolicyButton = new Button("Privacy Policy");
    privacyPolicyButton.addClickHandler(new ClickHandler() {
        @Override
        public void onClick(ClickEvent event) {
            setLoading(true);
            service.getPrivacyPolicy(new AsyncCallback<String>() {
                @Override
                public void onFailure(Throwable caught) {
                    errorLabel.setText(caught.getMessage());
                    errorLabel.setVisible(true);
                    setLoading(false);
                }

                @Override
                public void onSuccess(String result) {
                    resultsPanel.clear();

                    // convert newlines to <br />
                    SafeHtmlBuilder builder = new SafeHtmlBuilder();
                    builder.appendEscapedLines(result);

                    resultsPanel.add(new HTML(builder.toSafeHtml()));

                    setLoading(false);
                }
            });
        }
    });

    resultsPanel = new VerticalPanel();

    errorLabel = new Label();
    errorLabel.addStyleName("errorLabel");
    errorLabel.setVisible(false);

    //image from http://loadinfo.net/
    loadingImage = new Image("loading.gif");
    loadingImage.setVisible(false);
}

private void layoutWidgets() {
    Panel panel = new VerticalPanel();

    panel.add(errorLabel);

    Panel horizPanel = new HorizontalPanel();
    horizPanel.add(searchQueryTextBox);
    horizPanel.add(searchButton);
    horizPanel.add(privacyPolicyButton);
    horizPanel.add(loadingImage);
    panel.add(horizPanel);

    panel.add(resultsPanel);

    RootPanel.get().add(panel);
}

/**
 * Updates the UI for when a RPC call is made.
 * @param loading true if an RPC call is being sent, false if not
 */
private void setLoading(boolean loading) {
    if (loading) {
        errorLabel.setVisible(false);
    }
    searchQueryTextBox.setEnabled(!loading);
    searchButton.setEnabled(!loading);
    privacyPolicyButton.setEnabled(!loading);
    loadingImage.setVisible(loading);
}
} 
```

这是推文代码：

```
 package com.google.gwt.twittersearch.client;

import java.io.Serializable;

@SuppressWarnings("serial")
public class Tweet implements Serializable{
private String id;
  private String from_user;
  private String created_at;
  private String text;

  public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }

    public String getFrom_user() {
        return from_user;
    }

    public void setFrom_user(String from_user) {
        this.from_user = from_user;
    }

    public String getCreated_at() {
        return created_at;
    }

    public void setCreated_at(String created_at) {
        this.created_at = created_at;
    }

    public String getText() {
        return text;
    }

    public void setText(String text) {
        this.text = text;
    }

} 
```

任何对此错误的见解或我可能从这里去的地方将不胜感激！

谢谢，brl

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-27T21:27:59.810

您需要添加一个无参数构造函数，例如：

```
public class Tweet implements Serializable{

  public Tweet(){
  }

} 
```

**编辑**

你在这里也需要一个

```
private class SearchResponse {

  public SearchResponse(){
  }
  public List<Tweet> results;
} 
```

处理你的错误`java.lang.RuntimeException: Unable to invoke no-args constructor for class`

如果满足以下条件，用户定义的类是可序列化的：

1.  该类可分配给 IsSerializable 或 java.io.Serializable，因为它实现了这些接口之一，或者因为它派生自实现这些接口之一的超类。

2.  所有类的非最终、非瞬态实例字段都是可序列化的

3.  该类有一个公共默认（零参数）构造函数

[以上来自本教程](http://developerlife.com/tutorials/?p=125)

# c++ - 为什么我的 qt centralWidget（一个 QGLWidget）不能正确调整大小？

> ID：12149471
> 
> 赞同：2
> 
> 时间：2012-08-27T20:54:05.610
> 
> 标签：c++, qt, qglwidget, qmainwindow

我有一个带有 QMainWindow 的应用程序，理想情况下应该有一个 QGLWidget 以它为中心，在外部留有空间用于工具栏和其他顶部/侧面小部件。

不幸的是，无论 QGLWidget 设置为什么大小或几何形状，它看起来都很大并且占据了整个主窗口！

基本上，设置如下：在main()中调用CreateWindow()，构造主窗口，调用函数Init()，构造GLWidget。因此，在我改编的主窗口类的成员 Init() 中，我基本上有：

```
GLScene = new MyQGLWidget(this);  
setCentralWidget(GLScene); 
```

现在，为了使 GLScene 符合其所需的大小和位置，我首先尝试在 GLWidget（也就是我的直接从 GLWidget 派生的类）构造函数中设置它的几何图形：

```
MyQGLWidget::MyQGLWidget(QWidget* parent){
    ....
    setGeometry(210, 40, 600, 400);  //the main window is of course bigger and should fit this nicely 
    ....
} 
```

然而，这根本不起作用，仍然占据了整个主窗口。相反，我尝试将 setGeometry 调用放入 Init()。我在 setCentralWidget(); 之前和之后都试过了。两种选择都不起作用。也没有完全删除 setCentralWidget 调用（事实上，这使得 GLWidget 消失了）。

既然这显然不能正常工作，那么缩放 GLWidget 的正确方法是什么？还是只是我需要更深入地研究事物的顺序问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T01:00:15.950

您需要为其添加布局。我有完全相同的东西（从 QGLWidget 派生的小部件），其父级调用 resize 函数。这解决了我所有的问题，并使它可以在运行时更改其大小。

# eclipse - Eclipse PDT 扩展点和使用

> ID：12149472
> 
> 赞同：3
> 
> 时间：2012-08-27T20:54:18.293
> 
> 标签：eclipse, eclipse-pdt, eclipse-plugin

我正在尝试开始开发 eclipse 插件，特别是扩展[PDT](http://www.eclipse.org/pdt/)。是否有扩展点、文档和其他方法的列表？

在撰写本文时，最新版本是 Eclipse Juno 4.2 + PDT 3.1.0。

我检查了[eclipse 帮助](http://help.eclipse.org)，PDT 上什么都没有。我在 wiki 中找到的最好的内容是[pdt 2.0 上的一些注释](http://wiki.eclipse.org/API_Document_for_Extension_Points_PDT_2.0)。

## 更新 - 赏金

我在找什么：

*   PDT 扩展点列表
*   任何文档的链接（api、手册等）

对于每个扩展点：

*   从什么版本开始可用？
*   总结每个扩展点的用途会很棒。

额外学分：

*   任何指向文章、教程等的链接或任何点的示例用法都会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:04:46.670

似乎没有关于 PDT 开发的最新、全面的文档。我能找到的唯一部分是[Extending PDT 2.2](http://wiki.eclipse.org/Extending_PDT_2.2)和[PDT 0.7 Design Document](http://wiki.eclipse.org/images/5/54/API_PDT.pdf)。

但是，有一种方法可以构建 PDT 扩展点列表，包括它们从哪个版本可用以及一些文档：

1.  根据[Working with PDT source code in Eclipse 设置 Eclipse](http://wiki.eclipse.org/PDT/Contributing#Working_with_PDT_source_code_in_Eclipse)。请注意，您应该在第 2 点“检查 PDT 插件到 Eclipse 工作区”之前执行第 5 点“安装缺少的依赖项”。另请注意，除了提到的缺失依赖项之外，您还需要“EGit 项目集支持”（可能还有更多依赖项）才能从 Git 导入团队项目集。

2.  导入项目集后，切换到“插件开发”透视图并打开“插件”视图。找到 PDT 插件。

    ![在此处输入图像描述](../Images/d9a161209c88071f96c10452a426d9b4.png)

3.  双击每个插件将打开其插件编辑器，其中包含有关插件的一般信息以及 - 此插件的扩展和扩展点列表。打开“扩展点”链接或选项卡 - 如果有扩展点 - 将为您提供另一个链接：“显示扩展点描述”，包括“自”和“描述”。你在这！

关于 Eclipse 扩展点和扩展的一些背景：[http ://www.vogella.com/articles/EclipseExtensionPoint/article.html#extensionpoints](http://www.vogella.com/articles/EclipseExtensionPoint/article.html#extensionpoints)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T06:24:20.647

我不得不同意前面的回答。PDT 没有最新的扩展点文档。更糟糕的是，存储库中仍有扩展点不再被 PDT 使用。我在我的一个插件的[wiki](https://github.com/pulse00/Symfony-2-Eclipse-Plugin/wiki/Development-links)中收集了几个 dltk/pdt 开发教程的链接。要快速设置您的开发环境，您可以使用[本](https://github.com/pulse00/Symfony-2-Eclipse-Plugin/wiki/Development-environment)教程。

我建议您浏览现有 PDT 扩展的源代码并从现有代码中学习。[您可以在此 wiki](https://github.com/PHPsrc/wiki/wiki/PDT-Extension-project-list)中找到现有 pdt 扩展的列表。

当然，您可以随时在[PDT 邮件列表](https://dev.eclipse.org/mailman/listinfo/pdt-dev)上寻求帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-29T03:08:28.370

在这里，在 Eclipse Luna 参考中：[http ://help.eclipse.org/luna/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fextension-points%2Findex.html&cp=46_1_1](http://help.eclipse.org/luna/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fextension-points%2Findex.html&cp=46_1_1)

# android - 关于Android公钥的澄清？

> ID：12149473
> 
> 赞同：8
> 
> 时间：2012-08-27T20:54:19.433
> 
> 标签：android, string, encryption, google-play, in-app-billing

[我对来自http://developer.android.com/guide/google/play/billing/billing_integrate.html#billing-signatures](http://developer.android.com/guide/google/play/billing/billing_integrate.html#billing-signatures)的这条建议感到困惑

> 为了保护您的公钥免受恶意用户和黑客的攻击，请勿将您的公钥嵌入为整个文字字符串。相反，在运行时从片段构造字符串或使用位操作（例如，与其他字符串进行异或）来隐藏实际密钥。密钥本身不是秘密信息，但您不想让黑客或恶意用户轻易地用另一个密钥替换公钥。

这是否意味着

```
String one = "thisIs";
String two = "MyKey";
String base64EncodedPublicKey = one + two;
PublicKey key = Security.generatePublicKey(base64EncodedPublicKey);
verified = Security.verify(key, signedData, signature); 
```

比安全

```
String base64EncodedPublicKey = "thisIsMyKey";
PublicKey key = Security.generatePublicKey(base64EncodedPublicKey);
verified = Security.verify(key, signedData, signature); 
```

? 如果没有，您能否给我一个如何执行此操作的代码示例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-11T02:48:22.327

最好的方法是对密钥进行一些严重的更改。就个人而言，我更喜欢使用加密，这样的事情会起作用。对于键，将几个部分串在一起，这应该有助于将它们组合在一起。使用 encryptKey 对您的密钥进行加密，然后从源代码中删除真正的密钥，您应该是相当安全的。更好的是以某种方式从安全服务器获取密钥，但这并不总是一种选择。

```
String encryptKey(String input)
{
    byte[] inBytes=input.getBytes();
    String finalString=null;
    try {
        Cipher cipher=Cipher.getInstance("AES/CBC/PKCS5Padding");
        MessageDigest md = MessageDigest.getInstance("SHA-1");
        byte[] keyBytes=md.digest((KeyPart1+KeyPart2).getBytes());
        keyBytes = Arrays.copyOf(keyBytes, 16);
        SecretKey key= new SecretKeySpec(keyBytes,"AES");
        IvParameterSpec ivSpec = new IvParameterSpec(new byte[] {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0});
        cipher.init(Cipher.ENCRYPT_MODE,key,ivSpec);
        byte[] outBytes = new byte[cipher.getOutputSize(inBytes.length)];
        //cipher.update(encrypted, 0, encrypted.length, decrypted, 0);
        outBytes=cipher.doFinal(inBytes);
        finalString=new String(Base64.encode(outBytes,0));
        Log.v(TAG,"Encrypted="+finalString);

    } catch (NoSuchAlgorithmException e) {
        Log.e(TAG,"No Such Algorithm",e);
    } catch (NoSuchPaddingException e) {
        Log.e(TAG,"No Such Padding",e);
    } catch (InvalidKeyException e) {
        Log.e(TAG,"Invalid Key",e);
    } catch (InvalidAlgorithmParameterException e) {
        Log.e(TAG,"Invalid Algorithm Parameter",e);
    } catch (IllegalBlockSizeException e) {
    } catch (BadPaddingException e) {}
    return finalString;
}

String decryptKey(String base64Text)
{
    byte[] encrypted=Base64.decode(base64Text,0);
    //encrypted=base64Text.getBytes();
    String decryptedString=null;
    try {
        Cipher cipher=Cipher.getInstance("AES/CBC/PKCS5Padding");
        MessageDigest md = MessageDigest.getInstance("SHA-1");
        byte[] keyBytes=md.digest((KeyPart1+KeyPart2).getBytes());
        keyBytes = Arrays.copyOf(keyBytes, 16);
        SecretKey key= new SecretKeySpec(keyBytes,"AES");
        IvParameterSpec ivSpec = new IvParameterSpec(new byte[] {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0});
        cipher.init(Cipher.DECRYPT_MODE,key,ivSpec);
        byte[] decrypted = new byte[cipher.getOutputSize(encrypted.length)];
        //cipher.update(encrypted, 0, encrypted.length, decrypted, 0);
        decrypted=cipher.doFinal(encrypted);
        decryptedString=new String(decrypted);
    } catch (NoSuchAlgorithmException e) {
        logStackTrace(e);
    } catch (NoSuchPaddingException e) {
        logStackTrace(e);
    } catch (InvalidKeyException e) {
        logStackTrace(e);
    } catch (InvalidAlgorithmParameterException e) {
        logStackTrace(e);
    } catch (IllegalBlockSizeException e) {
        logStackTrace(e);
    } catch (BadPaddingException e) {
        logStackTrace(e);
    }
    return decryptedString;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T21:09:45.557

是的。尽管在这种情况下，您只是连接字符串，但效果并不好。这样做的原因是有人可以轻松地反汇编您的代码并访问您的公钥。如果您必须重新组装密钥，则从反汇编代码中获取密钥变得更具挑战性。

# ios - 将文本字段转换为数值，然后在该值处停止计时器

> ID：12149477
> 
> 赞同：0
> 
> 时间：2012-08-27T20:54:39.307
> 
> 标签：ios, xcode, uitextfield, nstimer

我希望计时器在文本字段的用户定义输入处停止，然后重置并重复，直到达到用户定义的重复次数（另一个文本字段）。这在我使用滑块时效果很好，但是我在使用滑块时遇到了其他一些问题，所以我改为使用文本字段。我认为问题是将文本字段转换为数值，我尝试了许多不同的方法但没有成功。该应用程序是一个简单的锻炼重复计数器，带有保持时间。非常感谢任何帮助。谢谢...

```
-(void)countup {   

float floatHoldTime=[holdTimeText.text floatValue];
float floatReps=[repsText.text floatValue];

CountHold ++;
displayHoldTime.text = [NSString stringWithFormat:@"%i", CountHold];

if (CountHold == floatHoldTime) {
    CountRep ++;    
    displayReps.text = [NSString stringWithFormat:@"%i", CountRep];
    CountHold = 0; 
}

if (CountRep == floatReps) {
    [Timer invalidate];
    Timer = nil;
}

}

-(IBAction)start:(id)sender {
Timer = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(countup) userInfo:nil repeats:YES];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:17:39.150

我怀疑问题在于您的浮点数和我认为的 int (CountHold) 永远不会完全相等，因为浮点数在计算机内部的表示方式。要么制作 floatHoldTime 和 floatReps 整数，要么让你比较类似 CountHold - floatHoldTime < 0.01 以允许一点点倾斜。

# python - 使用 Python/Biopython/Clustalw 的生物信息学脚本，使用标准输出迭代蛋白质目录

> ID：12149479
> 
> 赞同：1
> 
> 时间：2012-08-27T20:54:55.317
> 
> 标签：python, stdout, bioinformatics, biopython

所以我在 python 中做一些生物信息学工作，利用 Biopython 和 Clustalw2 来对齐蛋白质序列。我对此相当陌生（只有几个月的经验），并且在使用 stdout 并迭代整个目录时遇到了问题。任何帮助，将不胜感激。

所以我写了这个，它一次处理一个文件并产生所需的结果......

```
#!/usr/bin/python

import Bio
import os
from Bio.Align.Applications import ClustalwCommandline
from Bio import Seq
from Bio import SeqIO
from Bio import AlignIO
from Bio.SeqRecord import SeqRecord

clustal_loc=r"/Users/Wes/Desktop/eggNOG_files/clustalw-2.1-macosx/clustalw2"
try:
    f_in=raw_input("Enter the filepath of the FASTA to align: ")
    f_out= raw_input("Enter the output filename: ")
    fh= open(f_in)
    fo=open(f_out,'w')
    for record in SeqIO.parse(fh,"fasta"):
            id = record.id
            seq = record.seq
            print("Name: %s, size: %s"%(id,len(seq)))
    try:
            cl = ClustalwCommandline(clustal_loc,infile=f_in, outfile=f_out, align=True, outorder="ALIGNED", convert=True, output="pir")
            assert os.path.isfile(clustal_loc), "Clustal W not found"
            stdout, stderr = cl()
            print cl
    except:
            print("There was a problem aligning. Check ClustalW path and .fasta input.")

    fh.close()
    fo.close()

except:
        print("Could not parse. Check to make sure filepath is correct and that file is in   FASTA format") 
```

...这似乎工作得很好。当我尝试在整个目录上迭代它时问题就来了（比如需要对齐的 1000 多个蛋白质序列文件。我知道问题出在标准输出上，但此时我有点太业余了，不知道如何解决它. 下面是损坏的代码——</p>

```
/usr/bin/python

import Bio
import os
from Bio.Align.Applications import ClustalwCommandline
from Bio import Seq
from Bio import SeqIO
from Bio import AlignIO
from Bio.SeqRecord import SeqRecord
import subprocess
from subprocess import Popen
clustal_loc=r"/Users/Wes/Desktop/eggNOG_files/clustalw-2.1-macosx/clustalw2"

try:

    folder= raw_input("Enter the folder of .fasta files to iterate over and align: ")
    listing = os.listdir(folder)

    for infile in listing:
        print folder+'/'+infile
        f_in = open(folder+'/'+infile,'r')

        f_out=open(folder+'/'+infile+".pir",'w')

        for record in SeqIO.parse(f_in,"fasta"):
                id = record.id
                seq = record.seq
                print("Name: %s, size: %s"%(id,len(seq)))

        clustalw_cline= ClustalwCommandline(clustal_loc,infile=f_in, outfile=f_out, align=True, outorder="ALIGNED", convert=True, output="pir")

        assert os.path.isfile(clustal_loc), "Clustal W not found"
        saveout = sys.stdout
        sys.stdout = clustalw_cline()
        sys.stdout = saveout

        f_in.close()

        f_out.close()
except:
    print("There was a problem aligning. Check ClustalW path and .fasta folder format/location") 
```

正如你所看到的，我已经把这个搞砸了。感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T22:29:29.283

您看到的错误究竟是什么？您不应该将 sys.sterr 和 sys.stdout 设置为字符串值（clustalw_cline() 函数将 clustal stderr 和 stdout 作为字符串返回），因为您将无法从 python 向 stdout 写入任何内容。

我试图在下面清理和更正您的代码。

```
#!/usr/bin/env python

import Bio
import os
from glob import glob
from Bio.Align.Applications import ClustalwCommandline
from Bio import Seq
from Bio import SeqIO
from Bio import AlignIO
from Bio.SeqRecord import SeqRecord
import subprocess
from subprocess import Popen
clustal_loc=r"/Users/Wes/Desktop/eggNOG_files/clustalw-2.1-macosx/clustalw2"

try:
    folder= raw_input("Enter the folder of .fasta files to iterate over and align: ")
    listing = glob(os.path.join(folder, '*.fasta'))
    for infile in listing:
        print infile
        with open(os.path.splitext(infile) + '.pir') as f_out:
            with open(infile) as f_in:
                for record in SeqIO.parse(infile,"fasta"):
                        id = record.id
                        seq = record.seq
                        print("Name: %s, size: %s"%(id,len(seq)))
                assert os.path.isfile(clustal_loc), "Clustal W not found"
                clustalw_cline= ClustalwCommandline(clustal_loc,infile=f_in,
                                                    outfile=f_out, align=True, 
                                                    outorder="ALIGNED",convert=True, output="pir")
                stdout, stderr = clustalw_cline()
except Exception:
    print("There was a problem aligning. Check ClustalW path and .fasta folder format/location") 
```

# bash - 仅在子字符串的一部分中替换字符... sed 会起作用吗？

> ID：12149484
> 
> 赞同：1
> 
> 时间：2012-08-27T20:55:21.400
> 
> 标签：bash, sed

如果我忽略了我的问题的可用解决方案，我提前道歉，但我花了几个小时试图解决这个问题：

我的日志文件很乱[不是我的错 T_T]，我需要找到包含某些字符串的行。到目前为止，一切都很好而且很简单。找到它们后，我需要用不同的字符 [在我的情况下为下划线] 替换单词 "Before" [或 String1] 和 "is" [ 或 String2 之间的每个空格。“String1”之前或“String2”之后的任何内容都不会受到影响。

为了让你知道我应该做什么：

```
2012-08-27 00:14:55 1346019295409 Before Lorem ipsum dolor sit amet consectetuer Curabitur In id urna ut. Ut massa ac commodo commodo rutrum ac sit neque ante pede. is 47 ms 
```

应该变成：

```
2012-08-27 00:14:55 1346019295409 Before_Lorem_ipsum_dolor_sit_amet_consectetuer_Curabitur_In_id_urna_ut._Ut_massa_ac_commodo_commodo_rutrum_ac_sit_neque_ante_pede._is 47 ms 
```

由于几乎每个条目的时间戳都不同，我一直在考虑尝试找到一些方法来设置 sed 的限制，但没有运气......

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:55:37.173

你可以。Sed 是图灵完备的，所以你可以用它做任何事情。这并不意味着 sed 是完成这项工作的好工具：任何不能很好地映射到 sed 命令的东西都会很快变得复杂。如果你坚持使用 sed：

```
:a
s/\( Before .*\) \(.* is \)/\1_\2/
t a
s/ Before \(.*\) is / Before_\1_is /
s/ Before is / Before_is / 
```

我推荐 awk 。代码更长，但逻辑并没有那么令人头疼。

```
match($0, / Before (.* )?is /) {
    prefix = substr($0, 1, RSTART + 6);
    middle = substr($0, RSTART + 7, RLENGTH - 10);
    suffix = substr($0, RSTART + RLENGTH - 3);
    gsub(/ /, " ", middle);
    $0 = prefix + middle + suffix;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T05:41:32.860

这可能对您有用（GNU sed）：

```
sed 's/ /_/4g;s/_\([^_]*\)_\([^_]*\)$/ \1 \2/' file 
```

解释：

*   `s/ /_/4g`从第 4 个空格开始，将空格替换为`_`
*   `s/_\([^_]*\)_\([^_]*\)$/ \1 \2/'``_`用空格替换最后两个。

另一种方法（也许更`_`安全）：

```
sed 's/\( [^ ]*\)\{2\}$/\n&/;h;s/\n.*//;s/ /_/4g;G;s/\n.*\n//' file 
```

解释：

*   `s/\( [^ ]*\)\{2\}$/\n&/`在最后两个空格前插入换行符
*   `h`将模式空间 (PS) 复制到保持空间 (HS)
*   `s/\n.*//`删除包含最后两个空格的模式。
*   `s/ /_/4g`在 PS 中用下划线替换除前四个空格之外的所有空格。
*   `G`将换行符后跟 HS 的内容附加到 PS。
*   `s/\n.*\n//`删除字符串的原始第一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T21:12:31.683

可能有一种更优雅的方法可以做到这一点，但是 sed 有很多版本，您可能没有拥有所有酷特性的最新版本。

因此，一个简单的解决方案，假设您对每一行都有相同的格式，将前 3 个空格转换为制表符，一次一个，（这可能对您使用数据的方式有好处），然后转换'_' 字符的所有其他空格。

```
 sed '
    s/ /      /
    s/ /      /
    s/ /      /
    s/ /_/g' file > newFile 
```

**编辑**，感谢 David Yaw 在行尾指出所需的 2 个空格，我知道这不是那么容易 :-)。所以..您可以将以下内容添加到上述脚本中，再次依赖于您想要进行已知数量的替换的想法；在这里，我们找到最后 2 个 '_' 字符并将它们替换为空格，

```
 '....
     s/\([^_][^_]*\)_\([^_][^_]*\)$/\1 \2/
     s/\([^_][^_]*\)_\([^_][^_]*\)$/\1 \2/' file > newFile 
```

较新的 sed 可能不尊重逃脱的父母来捕获一个群体。如果上述方法不起作用，请尝试从每行中删除所有 4 个 '\' 字符。

请注意，当然，您必须做正确的事情才能在 s/srchTarg/replPat/' 的第二半部分中获得一个制表符作为替换模式。如果您使用 vi 编辑器，Ctrl-V Ctrl-I（中间没有空格）将插入一个制表符。当然，这意味着一个 ControlV 字符（按住 Ctrl 键并按 V），然后是 Ctrl I（再次按住 Ctrl 键，然后按 I）。如果您从基于 Windows 的编辑器中复制粘贴，您可以假设制表符正在转换为空格，因此您必须自己解决这个问题。

另请注意，您可以使用其他字符而不是制表符，可能是“：”或“|”，作为最后一步，`s/|/ /g`将它们转换回空格。

IHTH。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-27T23:06:59.333

用 Perl 试试

```
perl -ne '$_ =~ s/(?<=Before)(.*)(?=is)/$a=$1;$a=~s! !_!g; $a/e; print ' 
```

用 -e 调用 Perl 执行用单引号括起来的语句。`(?<=)`是积极的向后看。它匹配之后的所有内容。`(?=)`是一个积极的前瞻。它匹配之前的所有内容。`(.*)`匹配两者之间的整个字符串并捕获 $1 中的匹配项。我`s///`与`e`修饰符一起使用。这迫使 Perl 将`/$a=$1;$a=~s! !_!g; $a`其视为 Perl 代码并执行它。

只需尝试：

```
echo "2012-08-27 00:14:55 1346019295409 Before Lorem ipsum dolor sit amet consectetuer Curabitur In id urna ut. Ut massa ac commodo commodo rutrum ac sit ne que ante petryde. is 47 ms" |
perl -ne '$_ =~ s/(?<=Before)(.*)(?=is)/$a=$1;$a=~s! !_!g; $a/e; print ' 
```

# php - 用空格分隔字符串

> ID：12149485
> 
> 赞同：4
> 
> 时间：2012-08-27T20:55:25.800
> 
> 标签：php, regex, preg-split

用所有空格分隔字符串的适当正则表达式是什么？两个标记之间也可以有多个空格，最后应该忽略空格。

到目前为止我所拥有的：

```
<?php
$tags = "unread dev     test1   ";
$tagsArr = preg_split("/ +/", $tags);
foreach ($tagsArr as $value) {
  echo $value . ";";
} 
```

这给了我以下输出：

```
"unread;dev;test1;;" 
```

如您所见，它不会忽略末尾的空格，因为正确的输出应该是：

```
"unread;dev;test1;" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-27T20:58:30.387

您可以使用标志忽略空条目[`PREG_SPLIT_NO_EMPTY`](http://php.net/preg_split#refsect1-function.preg-split-parameters)：

```
$tagsArr = preg_split("/ +/", $tags, -1, PREG_SPLIT_NO_EMPTY); 
```

演示：http: [//ideone.com/1hrNJ](http://ideone.com/1hrNJ)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-27T20:58:04.007

只需先使用[修剪功能](http://www.php.net/manual/en/function.trim.php)将最后的空白区域切掉。

$trimmed_tags = 修剪（$tags）；

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T00:39:10.193

最快的方式：

```
$tagsArr = array_filter( explode(' ', $tags) ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T21:01:03.533

看来您希望在整个字符串中保留空格，但从末尾删除（以防止最后一个烦人的分号。如果我到目前为止理解正确，这听起来像是修剪命令的完美用途：

[http://php.net/manual/en/function.trim.php](http://php.net/manual/en/function.trim.php)

# javascript - JavaScript onclick 在 IE 9 中工作两次，然后停止

> ID：12149486
> 
> 赞同：0
> 
> 时间：2012-08-27T20:55:31.307
> 
> 标签：javascript, asp.net-mvc-3, internet-explorer-9

我有一个 MVC3 应用程序。我通过复选框 onclick 方法通过 ajax 调用控制器。单击后，我正在刷新 Telerik 网格。在 Chrome 和 Firefox 中，这可以正常工作。在 IE9 中，它可以单击 2 次，然后停止。这是怎么回事？这是代码：

查看代码：

```
<input type="checkbox" name="archived" onclick="javascript:ShowArchivedClicked();" id="archived" value="Archived" style="vertical-align:middle;" @{ if ((bool)Session[Const.ArchivedAttribute]) { <text>checked="checked"</text> } } /><span style="padding: 0 10px 0 0;"> Include archived records</span>

    function ShowArchivedClicked() {
        $.ajax({
            url: '@Url.Action("SetShowArchived", "Home")',
            type: "GET",
            async: false,
            success: function () {
                var summaryGrid = $("#SummaryGrid").data("tGrid");
                summaryGrid.rebind();
            },
            data: { showArchivedItems: $("#archived").is(":checked") }
        });
    } 
```

控制器代码：

```
 [HttpGet]
        public void SetShowArchived(bool showArchivedItems)
        {
            ShowArchivedItems = showArchivedItems;
        }

        private bool ShowArchivedItems
        {
            get
            {
                return Session[Const.ArchivedAttribute] == null ? false : (bool)Session[Const.ArchivedAttribute];
            }
            set
            {
                Session[Const.ArchivedAttribute] = value;
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:42:23.667

将此行添加到 ajax 调用就可以了：

```
cache: false, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:56:34.457

从`javascript:`你的`onclick`

全部`onclick`都是javascript...检查这是否有帮助，如果没有，请发表评论；）

# c# - 稳定的硬件哈希

> ID：12149489
> 
> 赞同：0
> 
> 时间：2012-08-27T20:55:49.880
> 
> 标签：c#, hash, wmi, hardware

我想生成一个硬件哈希，用于生成加密文件的密钥，这样它就不能与其他计算机交换。这不是许可证问题，它是从我们的在线数据库中存储一些数据的备份副本，以便可以离线使用该应用程序（但其中包含的数据相当安全，不会被窥探）。以前，我抓取了（真实）网络适配器的 MAC 地址，如下所示：

```
ManagementClass mng = new ManagementClass("Win32_NetworkAdapter");
ManagementObjectCollection apts = mng.GetInstances();
IEnumerable<string> macs = from ManagementObject mo in apts
                           where mo["MacAddress"] != null && mo["NetConnectionStatus"] != null
                           select mo["MacAddress"].ToString(); 
```

这工作得相当好，除了现在我发现在一台新电脑上，当无线关闭时，我得到两个 MAC 地址（一个用于有线网卡，一个用于无线），当我打开无线时，我得到三个（前两个，加上一个蓝牙！），我没有看到任何真正明显的方法来过滤掉蓝牙一个（没有在 NetConnectionID 中搜索“蓝牙”）。

现在我在这里不需要超级稳定的哈希。如果哈希不匹配，则应用程序无法解码加密数据，如果在网络上，它将下载一个新副本，所以这没什么大不了的（如果你不在网络上，它会只是告诉你它现在不可用）。但是，如果打开和关闭无线足以改变我的哈希值，那么它显然不够稳定！

所以我的问题：

1）有没有更好的方法来判断其中一个网络适配器可能会突然消失，以便我可以将其从原始哈希中排除？

2）适配器的顺序是否保证相同？列出的第一个适配器总是有线网卡吗？如果是这样的话，也许我会限制它只使用第一个适配器。

3) 我可以使用更好、更稳定的哈希吗？还是一个相当稳定的组合？

注意：我也已经将 Environment.MachineName 中的机器名称添加到我的哈希中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:09:55.927

我不知道 1 或 2 的答案，但这里有一个潜在的解决方法：

您可以通过结合机器名称、处理器 ID 和主板 ID 创建更稳定的哈希。如果您只是将其用于本地识别，那应该足够强大。[这篇 CodePlex 文章](http://www.codeproject.com/Articles/17973/How-To-Get-Hardware-Information-CPU-ID-MainBoard-I)有一个很好的受支持硬件键列表。请让我知道，如果你有任何问题。

# jquery - 有没有办法检测 jQuery 对话框中是否发生了点击事件？

> ID：12149497
> 
> 赞同：-1
> 
> 时间：2012-08-27T20:56:23.847
> 
> 标签：jquery, dialog

有没有办法检测用户是否从 jQuery 对话框中单击了链接？

该对话框是使用打开的，`moreBlock.dialog('open');`并且该链接可从父窗口和 jQuery 对话框中获得。

我需要检测链接是从打开的对话框中单击还是从父窗口中单击的。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:02:36.840

为什么不通过检查它是否有一个带有`ui-dialog`类的父级来检查它是否在对话框内

```
$('a').click(function(){
    if($(this).closest('.ui-dialog').length > 0){
        // code here for anchor inside dialog
    }
}); 
```

[http://jsfiddle.net/p5V68/1/](http://jsfiddle.net/p5V68/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:02:21.317

您需要拦截单击事件并显示`this.id`或其他一些唯一标识属性。

# java - 按arraylist中的次数对arraylist进行排序，然后删除重复项

> ID：12149498
> 
> 赞同：2
> 
> 时间：2012-08-27T20:56:29.700
> 
> 标签：java, list, sorting, arraylist, duplicates

现在我在php中有一些看起来像这样的东西：

```
$count = array_count_values($result);
arsort($count);

foreach($count as $key => $val){
    $result[] = $key;
} 
```

它将计算数组中的所有项目并将其放入键/值对中。这将删除重复项，然后我告诉它进行排序。然后我拿它的钥匙并存储它。有没有办法在 Java 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:11:51.057

我不相信 Java 具有与该功能等效的`array_count_values`功能，因此您需要自己实现它。像这样的东西：

```
public static <T> Map<T, Integer> countValues(List<T> values) {
    Map<T, Integer> result = new HashMap<T, Integer>();
    // iterate through values, and increment its corresponding value in result
    return result;
} 
```

然后使用该`java.util.Collections.sort(List list, Comparator c)`函数按计数对数组进行排序。您需要实现 Comparator 以按计数排序。

```
public class CountComparator<T> implements Comparator<T> {
    private Map<T, Integer> counts;

    public CountComparator(Map<T, Integer> counts) {
        this.counts = counts;
    }

    public int compare(T o1, T o2) {
        // assumes that the map contains all keys
        return counts.get(o1).compareTo(counts.get(o2));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:10:58.453

使用[`Multiset`](http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multiset)Google Guava 库中的 a 来获取计数如何。它的工作方式与 PHP 的`array_count_values`.

如果您希望它按键排序，请使用[`TreeMultiset`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/TreeMultiset.html)实现。

如果要按计数排序，请使用[Multisets.copyHighestCountFirst](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html#copyHighestCountFirst%28com.google.common.collect.Multiset%29)

# javascript - 点击事件触发孩子？

> ID：12149502
> 
> 赞同：1
> 
> 时间：2012-08-27T20:56:45.703
> 
> 标签：javascript, jquery, html

我有以下 HTML 代码

```
 <div id="id0_0" class="clearfix" style="margin-left:40px">
       <div id="id0_1" class="choice">
          <span id="spanradio_1" class="radio"> </span>
          <span id="spanlabel_1" class="label"><label id="label_1">Indoor</label></span>
       </div>

       <div id="id0_2" class="choice">
          <span id="spanradio_2" class="radio"> </span>
          <span id="spanlabel_2" class="label"><label id="label_2">Outdoor</label></span>
       </div>
    </div> 
```

使用以下 jQuery：

```
 jQuery('.choice').click( function(e) {
       alert('clicked!! ' + e.target.id);
       var src_ele = $(e.target);

       e.stopPropagation();
       return false;
    }); 
```

但是，我的点击是触发 spanradio 的 & 标签而不是 div 的。有什么原因造成这种情况吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:58:35.783

`e.target`是用户实际点击的元素。

如果用户点击了一个嵌套元素，`e.target`就会是那个元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T21:45:31.480

基本上：

*   `this`是您将事件绑定到的元素（即您调用的集合中的元素之一`.on`）
*   `e.target`是你点击的最深的元素

所以你想要`this.id`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T20:59:28.980

因为标签是“.choice”元素中的唯一内容，因此位于顶部 --> 它实际上是元素，您点击了...

看看`event.relatedTarget`这是否适合您。

# ruby-on-rails - Snorby 设置-RedCloth 错误

> ID：12149503
> 
> 赞同：0
> 
> 时间：2012-08-27T20:56:45.610
> 
> 标签：ruby-on-rails, ruby, rubygems, gem, snort

我正在尝试安装 Snorby（显然），并且在使用同一个 gem 时不断遇到错误。每次我尝试在 snorby 目录中执行 sudo bundle install 时，都会收到以下错误：

```
Installing RedCloth (4.2.9) with native extensions /usr/local/lib/site_ruby/1.9.1/rubygems/installer.rb:556:in `rescue in block in build_extensions': ERROR: Failed to build gem native extension. (Gem::Installer::ExtensionBuildError)
    /usr/bin/ruby1.9.1 extconf.rb 
```

/usr/local/lib/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- mkmf (LoadError) from /usr/local/lib/site_ruby/1.9.1/rubygems/custom_require.rb:36:in`require' from extconf.rb:1:in `'

我已经尝试了我所看到和知道的一切。我试图安装它的早期版本。我试过 gem upate。我试过 sudo gem install Redcloth -v 。然后它告诉我同样的连续错误。无法构建 gem 原生扩展。没有任何工作。非常感谢所有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:16:15.950

我终于找到了问题！对于那些苦苦挣扎的人，不要再搜索了。您所要做的就是通过执行以下操作下载开发包：

sudo apt-get install ruby​​1.9.1-dev

# c# - 从 Form1 中的静态类访问 Form1 公共函数

> ID：12149508
> 
> 赞同：-2
> 
> 时间：2012-08-27T20:57:23.550
> 
> 标签：c#, class, static-classes

在写这篇文章时，我正在检查与相关主题相关的所有问题，但无法找到这个 Newbs C# 问题的简单答案

我想......如果可以的话，尽可能多地给出一个解释清楚的答案（拜托！）

我做了一个公共静态类

```
 public static class MyLoadedBtmpToolBox
        {
            public static string FnameToLoad;
            public static bool PutLoadedByteArrInPicbox;
            public static string[] LoadedRefrnce;
            public static int SourceX_Loaded, SourceY_Loaded, RectWidth_Loaded, RectHeight_Loaded;

--->            public static int tst = Str2Int(LoadedRef[0]);

            public static byte[] LoadedByteArr;

        } 
```

这个类通常默认情况下，在我使用的主要形式中

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Runtime.InteropServices;
using System.Threading;
using System.Diagnostics;
using System.Drawing.Imaging;
using System.IO;
using System.Security.Cryptography;
using WindowsInput;

namespace MyScrCupTry1
{
    public partial class MyForm1 : Form
    {

            public static class MyLoadedBtmpToolBox
            {

              public static int testStr2Int = Str2Int("100");

            }

          public int Str2Int(string STR)
          {

            int strInt = Convert.ToInt32(null);
            if (isntEmpty(STR))
            {
                strInt = Convert.ToInt32(STR);

            }
            else
            {
                MessageBox.Show("theString " + STR + " is Null");
            }
            return strInt;

     }

} 
```

我无法通过使用主表单中的`testStr2Int`公共“帮助方法”来评估 a 值，但我遇到了错误：`Str2Int()`

错误 1***​​非静态字段、方法或属性***'MyScrCupTry1.MyForm1.Str2Int(string)' G:\RobDevI5-Raid-0\Documents\Visual Studio 2010\Projects\WindowsFormsApplication2\WindowsFormsApplication2\MyForm1 需要对象引用.cs 95 45 MyScrCuptry1

如果可能/（非非法），从静态类访问主窗体公共元素的正确方法是什么...

*   **重新编辑**

在这两个答案之后...

我试图从第一个答案中实现代码而没有预期的结果我想我不知道正确的代码结构与覆盖 OnLoad(..) 的东西......

**但 ！** 我已将方法`Str2Int(STR)`从公共变为**公共静态**

所以现在表单本身的元素仍然可以访问（我很惊讶）`Str2Int()` 静态类，我也可以访问它......

这一切都感谢tp也将其变为静态，

当将 Str2Int() 从 public 更改为 public static 时，我是否遗漏了其他东西是否存在“隐藏”缺点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:03:17.657

代码的意义`static`在于它属于它自己，而不是任何其他对象。要做到这一点，当您将某些内容设置为静态时，依赖于它的*所有内容*也必须是静态的！

这就是您的错误消息试图告诉您的内容。您将某些东西声明为静态的，但在计算该静态时，您使用的是非静态的东西。 `Str2Int`没有标记为静态，所以这是一个直接的问题，也有可能`LoadedRef`不是静态的。我半信半疑你真的打算在`LoadedRefrnce`那里使用，在这种情况下你很好，但由于你拼写不正确，我不能确定！

查看[此页面](http://msdn.microsoft.com/en-us/library/98f28cdx.aspx)以获取有关 static 关键字的说明，还请努力阅读[C# 编码约定](http://msdn.microsoft.com/en-us/library/ff926074.aspx)- 这使人们在您寻求此类帮助时更容易阅读您的代码！

扩展上面的编辑：

使代码静态化的“缺点”是它几乎立即使它成为不可测试的一部分。单元测试背后的想法是将所有代码分解成完全可替换的部分，因此它们可以单独测试并单独移出（如果需要）。通过使一堆代码静态化，您实际上是将其焊接到它可能属于的任何其他代码上。在您自己的示例中，通过将`Str2Int()`public 设为静态，`Str2Int()`现在使用的所有内容都无法测试！

一般来说，静态代码是你应该尽量避免的恶习。有些地方是你做不到的，如果你才刚刚开始学习，那么最大的重点就是让一些东西发挥作用。但是请准备好回顾这段代码，然后对自己如何在几年内写出如此糟糕的东西感到冷漠，当您对自己的技能更有经验和信心时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:02:16.140

将`Form`对象添加到静态类，如下所示：

```
public static class MyLoadedBtmpToolBox
{
     public static Form MainForm {get;set;}

     public static int testStr2Int = MainForm.Str2Int("100");
} 
```

并从`Form`：

```
public partial class MyForm1 : Form
{
     private override OnLoad(..){

        base.OnLoad(...);    
        MyLoadedBtmpToolBox.MainForm =this;

     }
} 
```

这种设计本身很脆弱，因为您必须保证`MyForm`属性在用于调用**之前**`..testStr2Int = MainForm.Str2Int("100")..`已初始化。因此，考虑到它`testStr2Int`是公开的，可能是它的初始化，你也可以在`Form`其中而不是在静态类中进行。

# knockout.js - $.getJSON 来自 MVC WebApi 返回反序列化对象？

> ID：12149513
> 
> 赞同：1
> 
> 时间：2012-08-27T20:57:53.177
> 
> 标签：knockout.js, knockout-mapping-plugin

我正在使用新的 mvc web api 和 knockout.js 并遇到 $.getJSON 返回反序列化对象与 json 字符串的场景。不是真正的问题，但我只是好奇它为什么会发生。谁能解释一下？谢谢

```
 //Web Api call

 public UserViewModel GetNewUser()
 {
        var userViewModel = new UserViewModel()
        {
             Id = Guid.NewGuid(),
             Name = "Test"
        };

        return userViewModel;
}

//client code
$.getJSON('/api/User/GetNewUser', function (result) {
    //var viewModel = ko.mapping.fromJS(result);
    //result is already parsed to ojbect
}

enter code here 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:11:32.883

这就是背后*记录*的“魔法” [`jQuery.getJSON`](http://api.jquery.com/jQuery.getJSON/)：

> **成功回调传递返回的数据**，它通常是由 JSON 结构定义的 JavaScript 对象或数组，并**使用 $.parseJSON() 方法进行解析。**它还传递了响应的文本状态。

（“knockout.js”在哪里适合？）

# windows - 实现我自己的协议并通过我的浏览器使用它

> ID：12149515
> 
> 赞同：2
> 
> 时间：2012-08-27T20:58:01.303
> 
> 标签：windows, http, browser, protocols

我想创建一个新协议，以便可以在浏览器中查看通过协议检索到的数据。

例如，我希望能够访问 myprotocol://www.filepath.com/img.jpg 并查看图像。

myprotocol 由我自己定义的地方。

我在这里阅读了有关注册应用程序处理的信息：http: [//msdn.microsoft.com/en-us/library/aa767914%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa767914%28v=vs.85%29.aspx)

有了这个，就可以运行一个桌面 exe，它接收我试图访问的 url。我如何将检索到的 jpg 返回到浏览器进行查看，使其表现得像一个普通的协议，比如 http？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:15:24.067

该注册将允许您将应用程序绑定到 uri，因此如果通过 Windows 资源管理器（包括“运行”）和命令行启动，则启动应用程序并将 uri 作为参数传递给它（就像你加倍-单击一个文件，启动它的默认应用程序并传递文件的路径）。

例如，您的“默认”浏览器将以`http://`这种方式与之关联。

当它作为参数传递时，它仍然取决于应用程序本身对 URI 的处理。如果你想让浏览器处理你的新协议，你必须编写一个扩展/插件/附加组件/whatever-that-browser's-makers-call-it 来为浏览器添加更多功能。对于 Firefox、IE、Chrome、Konqueror、Chromium（至少它可以与 Chrome 共享）等，这是一项单独的工作，需要处理单独的 API。

# c++ - 什么可能导致此链接器错误？

> ID：12149516
> 
> 赞同：0
> 
> 时间：2012-08-27T20:58:02.273
> 
> 标签：c++, visual-studio-2010, visual-c++, linker-errors, unresolved-external

几个小时以来，我一直试图`unresolved external symbol`在静态变量上解决这个问题，但我束手无策。我正在使用 Visual Studio 2010。这是对情况的简化概述：

有问题的项目：

```
-ProjA (outputs a .dll and .lib)
-ProjB (outputs a .exe) 
```

在 ProjA 中，我有这两个文件：

```
//foo.h
#pragma once

class SUP
{
public: 
    static int staticint;
}; 
```

和

```
//foo.cpp
#include "foo.h"
int SUP::staticint = 10; 
```

ProjB 链接到 ProjA.lib

```
//main.cpp
#include "{Full_Path}foo.h"
int main(){
   std::cout << SUP::staticint << std:: endl;
} 
```

现在，main.cpp 编译没有任何问题，但是当我尝试构建项目时，出现以下错误：

`main.obj : error LNK2001: unresolved external symbol "public: static int SUP::staticint" (?staticint@SUP@@2HA)`

我几乎 100% 确定我已经正确设置了 ProjB 的选项。在“其他依赖项”下，我有“ProjA.lib”，在“其他库目录”下，我有生成 ProjA.lib 文件的目录的路径。

我什至让 ProjA 输出了一个 .map 文件，在地图中我发现： `0003:00004458 ?staticint@SUP@@2HA 10049458 foo.obj`

所以我猜这意味着它`staticint`已经被正确定义了。

可能出了什么问题？显然，我做错了什么，但我看不到是什么。我已确保 ProjB 链接到正确的 .lib 文件。我已经确保包含目录是好的。我已经确保静态变量的定义是正确的。如有必要，我将提供任何其他信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:01:38.203

在 MSVS 下，您必须明确声明要导出的符号`__declspec(dllexport)`.

由于`SUP`在不同的库中，只有导出的符号可用于其他模块，必须将它们标记为`__declspec(dllimport)`.

这种双重行为通常是通过宏来实现的：

```
#ifdef EXPORT_MODULE
#define DLLIMPEXP __declspec(dllexport)
#else
#define DLLIMPEXP __declspec(dllimport)
#endif 
```

和声明为的类

```
class DLLIMPEXP SUP
{
public: 
    static int staticint;
}; 
```

where`EXPORT_MODULE`在导出符号的项目中定义。

# javascript - 带有 $get 的页面源

> ID：12149518
> 
> 赞同：0
> 
> 时间：2012-08-27T20:58:08.293
> 
> 标签：javascript, jquery, html

有没有什么东西可以让我做类似的事情：

```
<script>
var source;
sources = $.get("www.johnverber.com/?url=www.google.com");

document.write(source);
</script> 
```

显然这段代码不起作用......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:29:08.750

从不同的主机获取数据时，您没有太多选择。您很可能会遇到跨域错误。您应该公开[JSONP](http://en.wikipedia.org/wiki/JSONP) Web 服务。然后，您可以使用[getJSON](http://api.jquery.com/jQuery.getJSON/)执行以下操作：

```
$.getJSON('http://www.johnverber.com/?url=www.johnverber.com/win1.html&callback=?', function(data){
  // do something with data
}); 
```

注意`callback=?`查询。

# boost - 使用 VS2012 RC 构建提升

> ID：12149524
> 
> 赞同：4
> 
> 时间：2012-08-27T20:58:44.160
> 
> 标签：boost, visual-studio-2012

我刚刚下载了适用于 Windows 8 64 位的 Visual Studio 2012 RC。我尝试编译 boost 库（版本 1.51），但是当我在 Visual Studio 提示命令中进行编译时，出现错误。我在帖子末尾发布了 bootstrap.log。我想知道在 Windows 8 Release Candidate 上构建 VS2012RC 的正确程序是什么。

提前感谢您的回复。

```
###
### Using 'vc11' toolset.
###

C:\Users\XXX\Downloads\boost_1_51_0\boost_1_51_0\tools\build\v2\engine>if
exist bootstrap rd /S /Q bootstrap

C:\Users\XXX\Downloads\boost_1_51_0\boost_1_51_0\tools\build\v2\engine>md
bootstrap

C:\Users\XXX\Downloads\boost_1_51_0\boost_1_51_0\tools\build\v2\engine>cl
/nologo /RTC1 /Zi /MTd /Fobootstrap/ /Fdbootstrap/ -DNT -DYYDEBUG
-wd4996 kernel32.lib advapi32.lib user32.lib /Febootstrap\jam0
command.c compile.c constants.c debug.c execnt.c filent.c function.c
glob.c hash.c hdrmacro.c headers.c jam.c jambase.c jamgram.c lists.c
make.c make1.c object.c option.c output.c parse.c pathunix.c regexp.c
rules.c scan.c search.c subst.c timestamp.c variable.c modules.c
strings.c filesys.c builtins.c md5.c pwd.c class.c w32_getreg.c
native.c modules/set.c modules/path.c modules/regex.c
modules/property-set.c modules/sequence.c modules/order.c
command.c
compile.c
constants.c
debug.c
execnt.c
filent.c
function.c
glob.c
hash.c
hdrmacro.c
headers.c
jam.c
jambase.c
jamgram.c
lists.c
make.c
make1.c
object.c
option.c
output.c
Generazione del codice in corso...
Compilazione in corso...
parse.c
pathunix.c
regexp.c
rules.c
scan.c
search.c
subst.c
timestamp.c
variable.c
modules.c
strings.c
filesys.c
builtins.c
md5.c
pwd.c
class.c
w32_getreg.c
native.c
set.c
path.c
Generazione del codice in corso...
Compilazione in corso...
regex.c
property-set.c
sequence.c
order.c
Generazione del codice in corso...

C:\Users\XXX\Downloads\boost_1_51_0\boost_1_51_0\tools\build\v2\engine>.\bootstrap    \jam0
-f build.jam --toolset=vc11 "--toolset-root=C:\Program Files
(x86)\Microsoft Visual Studio 11.0\Common7\Tools\..\..\VC\ " clean
...found 1 target...
...updating 1 target...
...updated 1 target...

C:\Users\XXX\Downloads\boost_1_51_0\boost_1_51_0\tools\build\v2\engine>.\bootstrap\jam0
-f build.jam --toolset=vc11 "--toolset-root=C:\Program Files
(x86)\Microsoft Visual Studio 11.0\Common7\Tools\..\..\VC\ "
don't know how to make command.c
don't know how to make compile.c
don't know how to make constants.c
don't know how to make debug.c
don't know how to make function.c
don't know how to make glob.c
don't know how to make hash.c
don't know how to make hcache.c
don't know how to make headers.c
don't know how to make hdrmacro.c
don't know how to make jam.c
don't know how to make jambase.c
don't know how to make jamgram.c
don't know how to make lists.c
don't know how to make make.c
don't know how to make make1.c
don't know how to make mem.c
don't know how to make object.c
don't know how to make option.c
don't know how to make output.c
don't know how to make parse.c
don't know how to make regexp.c
don't know how to make rules.c
don't know how to make scan.c
don't know how to make search.c
don't know how to make subst.c
don't know how to make w32_getreg.c
don't know how to make timestamp.c
don't know how to make variable.c
don't know how to make modules.c
don't know how to make strings.c
don't know how to make filesys.c
don't know how to make builtins.c
don't know how to make pwd.c
don't know how to make class.c
don't know how to make native.c
don't know how to make md5.c
don't know how to make modules/set.c
don't know how to make modules/path.c
don't know how to make modules/regex.c
don't know how to make modules/property-set.c
don't know how to make modules/sequence.c
don't know how to make modules/order.c
don't know how to make execnt.c
don't know how to make filent.c
don't know how to make pathunix.c
...found 50 targets...
...updating 1 target...
...can't find 46 targets...
...can't make 2 targets...
[MKDIR] bin.ntx86_64
...skipped b2.exe for lack of command.c...
...skipped bjam.exe for lack of b2.exe...
...skipped 2 targets...
...updated 1 target... 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-03T18:08:52.157

解决方法：

1.  将目录更改为 boost_1_51_0-x64\tools\build\v2
2.  执行 bootstrap.bat（不是从本机 x64 命令提示符 - 只需双击它）
3.  将 b2.exe 复制回 boost_1_51_0-x64 目录
4.  将目录更改为 boost_1_51_0-x64
5.  执行 b2

我编写了一个名为 BlueGo 的工具，它会自动下载 boost 1.51.0 并使用 VS2012 x64 构建它：http: [//vertexwahn.de/](http://vertexwahn.de/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-14T23:27:28.660

[版本 1.52](http://www.boost.org/users/history/version_1_52_0.html "1.52 发行说明") 刚刚发布，现在包括对 Visual Studio 2012 (VC11) 的支持 如果您需要早期版本的 Boost，您可以随时将项目使用的工具集更改为 VC10。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-27T21:02:23.100

不是真正的答案，但您可以[在此处](http://boost.teeks99.com/)下载使用 VC11 RC 构建的预构建 Boost 二进制文件。基于此页面，在 VC11 上构建 Boost 似乎存在一些问题（请参阅[此线程](http://lists.boost.org/Archives/boost/2012/08/195729.php)）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-02T16:04:15.993

对于 windows8，请查看此补丁[https://svn.boost.org/trac/boost/attachment/ticket/7243/boost_1_51_0_win8_x64_compat.patch](https://svn.boost.org/trac/boost/attachment/ticket/7243/boost_1_51_0_win8_x64_compat.patch)

# javascript - Ajax 发布到两个节点 NLB 上的 Web 服务

> ID：12149527
> 
> 赞同：2
> 
> 时间：2012-08-27T20:58:56.937
> 
> 标签：javascript, jquery, ajax, web-services, nlb

我有一个双节点 NLB 设置，我需要通过 ajax POST 从客户端调用多个 Web 服务。如果我点击页面说：

```
http://clusternode1/ 
```

没有问题。

如果我在

```
http://clusternode2/ 
```

没有问题。

但是，如果我在

```
http//clustername/ 
```

我得到了跨域异常（如预期的那样）。

有没有办法解决？有什么方法可以协调发出请求的名称以避免跨域异常？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T23:23:13.250

我头顶上的东西很少；这取决于几个因素，您可以通过几种方法来解决这个问题：

(1) 根据您的设置，为什么不只针对负载均衡器（通常这是使用 NAT 配置的方式），然后让负载均衡器完成工作？

(2) 如果节点位于不同的域上，您必须查看[CORS的配置](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)

（3）如果您无法访问标头等混乱，您可以寻求代理，但这半会破坏负载平衡的目的

(4) 也许为每个节点设置 cname 别名会避免跨域问题？

嗯，确定那里有解决方案:-)

# objective-c - 将 AMWorkflow 与沙盒应用程序一起使用

> ID：12149529
> 
> 赞同：1
> 
> 时间：2012-08-27T20:59:01.973
> 
> 标签：objective-c, cocoa, sandbox, mach

我正在尝试从沙盒 AppKit 应用程序执行 Automator 工作流程。

最小示例 + [github repo](https://github.com/pebrc/AMWorkflowCaller)：

```
 NSOpenPanel * panel = [NSOpenPanel openPanel];
   [panel setAllowsMultipleSelection:NO];
   [panel setCanChooseFiles:YES];
   [panel setCanChooseDirectories:NO];
   [panel setAllowedFileTypes:[NSArray arrayWithObject: @"com.apple.automator-workflow"]];
    NSInteger result = [panel runModal];

    if (result == NSFileHandlingPanelOKButton) {
      NSURL * workflow = [[panel URLs]objectAtIndex:0];
      NSLog(@"selected url %@", workflow);
      NSError * error = nil;
      [AMWorkflow runWorkflowAtURL:workflow withInput:[NSArray arrayWithObject:workflow] error:&error];
      if(error) {
          NSLog(@"Error while executing workflow %@", [error localizedDescription]);
      }        
    } 
```

根据我目前对 AMWorkflow API 的理解，我假设它使用 Mach IPC 在单独的 Automator Runner 进程中执行工作流。

这就是我向我的应用程序添加以下权利的原因：

```
 <key>com.apple.security.temporary-exception.mach-lookup.global-name</key>
   <array>
     <string>com.apple.AutomatorRunner</string>
     <string>com.apple.Automator</string>
   </array> 
```

但显然 Automator Runner 尝试连接回调用应用程序，但失败并显示以下错误消息：

```
Automator Runner(2717) deny mach-lookup  /Users/pbrc/Library/Developer/Xcode/DerivedData/AMWorkflowCaller-arjgkslqihljquelyvybmpsnljrn/Build/Products/Debug/AMWorkf

0   libsystem_kernel.dylib          0x00007fff96ce9686 mach_msg_trap + 10
1   liblaunch.dylib                 0x00007fff8db637c4
2   liblaunch.dylib                 0x00007fff8db624d9 bootstrap_look_up3 + 69
3   liblaunch.dylib                 0x00007fff8db62609 bootstrap_look_up2 + 40
4   Foundation                      0x00007fff8f4acffe -[NSMachBootstrapServer portForName:options:] + 102
5   Foundation                      0x00007fff8f4b84cb +[NSConnection connectionWithRegisteredName:host:usingNameServer:] + 30
6   Automator Runner                0x0000000100001a51 -[AMRunnerDelegate processArguments] + 487 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-11T08:50:14.257

简单的答案是 AMWorkflow API 在沙盒应用程序中不起作用。最近引入了另一种 API，它适用于沙盒应用程序：

```
NSUserAutomatorTask executeWithInput:completionHandler: 
```

使用此 API，您可以执行位于应用程序脚本文件夹中的自动化脚本：

/Users/USERNAME/Library/Application Scripts/BUNDLENAME.APPNAME

有一个重要的警告：尽管方法的“输入”参数没有输入将传递到 10.8.3 12D75 之前的 Mac OS 版本上的自动化工作流程（这是/曾经是一个错误）：

```
NSUserAutomatorTask * task = [[NSUserAutomatorTask alloc] initWithURL:workflow error:&error];
if(error) {
    NSLog(@"Error while creating script task %@", [error localizedDescription]);
}

[task executeWithInput: @"this will never reach your workflow" completionHandler:^(id result, NSError *error){
    if(error)
        NSLog(@"Error while executing workflow %@", [error localizedDescription]);
}]; 
```

# excel - 将多本 Excel 书籍中的行复制到新的 Excel 书籍中

> ID：12149531
> 
> 赞同：1
> 
> 时间：2012-08-27T20:59:06.373
> 
> 标签：excel, vba

我想将几本书中的行复制到一本新书中。我会试着解释一下。我有 book1、book2 和 book3，我想将 D 列中包含特定单词的行从这些行复制到 book4。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:01:23.140

按“D列”排序，然后将要抓取的所有数据组合在一起，全选并复制。

**编辑**

选择所有数据，然后转到`Data`顶部的选项卡并单击排序。

# ruby - 我可以将方法用作 lambda 吗？

> ID：12149532
> 
> 赞同：2
> 
> 时间：2012-08-27T20:59:07.373
> 
> 标签：ruby, class, methods, lambda, extending

我有一个定义一组条件的接口。它是与其他模型一起使用的几个此类接口之一。

这些条件将由消息队列处理程序调用以确定警报的完整性。所有的警报调用都是一样的，所以我试图通过将条件抽象到它们自己的方法中来稍微干掉入队调用（我质疑方法是否是正确的技术）。我认为通过这样做，我将能够测试这些条件中的每一个。

```
class Loan
  module AlertTriggers
    def self.included(base)
      base.extend           LifecycleScopeEnqueues

      # this isn't right
      Loan::AlertTriggers::LifecycleScopeEnqueues.instance_method.each do |cond|

        class << self
          def self.cond
            ::AlertHandler.enqueue_alerts(
              {:trigger => Loan.new}, 
              cond
            )
          end
        end

      end
    end
  end

  module LifecycleScopeEnqueues
    def student_awaiting_cosigner 
        lambda { |interval, send_limit, excluding|
          excluding ||= ''
          Loan.awaiting_cosigner.
            where('loans.id not in (?)', excluding.map(&:id) ).
            joins(:petitions).
            where('petitions.updated_at > ?', interval.days.ago).
            where('petitions.updated_at <= ?', send_limit.days.ago) 
        }
    end
  end 
```

我已经考虑过替代方案，其中每种方法都像一个范围。在那条路上，我不确定如何成为, 和`AlertHandler`的来源`interval`，它在调用它时传递给块/proc。 `send_limit``excluding`

* * *

有人建议我（离线）范围是 lambda，因此可能是更合适的解决方案 - 根据@BorisStitnicky 推断，钳子*可以*用作锤子，但不应该。我也愿意接受这方面的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T22:06:02.427

你知道，这可能不是你寻求的答案，但我会尽力而为。最好这样回答而不是放弃评论。在您的代码中，您正在做一些非常不寻常的事情。首先，您在类中定义一个模块。我以前从未做过或见过这个，以至于我打了 irb 来尝试一下。其次，您正在定义一个返回 lambda 的方法。这让我想起了我刚学习 Ruby 时所做的很多事情。Lambda 有非常具体的应用，通常应尽可能避免采用这种形式。如果你想像这样使用 lambda，至少将它们分配给一个变量，或者更好的是，一个常量：

```
STUDENT_AWAITING_COSIGNER = lambda { |interval, send_limit, excluding|
  # do your SQL magic
} 
```

我在理解您的词汇时遇到了麻烦：特别是，我不确定您所说的“范围”是 Ruby 范围还是其他类型的范围。

但就个人而言，我认为你根本不应该使用 lambdas。我敢说，你的代码需要的不仅仅是干一点。我认为你不应该在一个类中设置子命名空间。你为什么不使用例如。实例变量？此外，公共类方法只是蛋糕上的一颗樱桃。首先解决没有它们的问题，然后您可以决定添加它们以使您的界面更方便。总而言之，我会简单地按照以下方式做一些事情：

```
class Loan
  attr_reader :alerts

  def initialize( whatever_options )
    @alerts = Array( whatever_options[ :alerts ] )
  end

  def check_alerts
    @alerts.each &:test
  end
end

# Then I would set up an alert class:
class Alert
  def test( interval, send_limit, excluding = '' )
    Loan.awaiting_cosigner.
      where('loans.id not in (?)', excluding.map(&:id) ).
      joins(:petitions).
      where('petitions.updated_at > ?', interval.days.ago).
      where('petitions.updated_at <= ?', send_limit.days.ago) 
  end
end
# I used your prescription statically, if you have different kind
# of alerts, you would have to make the class sufficiently flexible
# to handle them all.

# and then I would eg. supply alerts to a Loan upon instantiation
# (this can be also done later, if you make it so)
my_little_loan = Loan.new( alerts: Alert.new )
# and when the time comes to check whether the alerts alert or not:
my_little_loan.check_alerts 
```

显然，这只是我谦虚地认为应该在 Ruby 中简单地解决这类问题的一个大纲。您需要付出自己的努力，使其在您的特定复杂情况下为您工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T13:29:44.537

处理此问题的一种方法是使用域的其他模型/部分所期望（或显示给）的名称空间（在模块内）。

在这种情况下`AlertHandler`不需要传递一个块。相反，它可以知道命名空间的存在（相反，它`LifecycleScopeEnqueues`可能读起来更*可操作*`Lifecycle_EnqueuingScopes`）。因此，无论内部发生什么`AlertHandler.enqueue_alerts`：

```
class AlertHandler
  def enqueue_alerts(options, condition)
    trigger = options[:trigger]
    handler = options[:trigger_handler].capitalize

    interval, send_limit, excluding = handler_metrics(handler, condition)

    range = "#{trigger.class.name}".constantize.send(condition, [interval, send_limit, excluding])

    # do other things
  end
end 
```

所有这些范围的警报仍然可以通过一种反射方法“排队”（与问题中的代码混合）

```
class Loan
  module AlertTriggers
    def self.included(base)
      base.extend     ClassMethods
    end

    module  ClassMethods
      def enqueue_lifecycle_reminders
        Loan::AlertTriggers::LifecycleScopeEnqueues.instance_method.each do |cond|
          ::AlertHandler.enqueue_alerts(
              {:trigger => Loan.new}, 
              cond
          )
        end
      end
    end
  end
end 
```

这种方法还允许通过以下方式测试范围/条件`Loan::AlertTriggers::LifecycleScopeEnqueues`：

*   每个方法
*   鸭子打字

# javascript - 表格单元格高度匹配背景高度

> ID：12149535
> 
> 赞同：0
> 
> 时间：2012-08-27T20:59:19.570
> 
> 标签：javascript, css, html-table

我有一个表格，其中一个单元格包含背景图像。单元格的宽度设置为页面宽度的 100%，图像的背景大小设置为 100%。这会生成背景图像，其中该图像的宽度被缩放以匹配页面的宽度。

不过我的身高有问题。

我希望单元格的高度是缩放图像的高度。这将导致单元格的宽度和高度与缩放图像的宽度和高度相匹配。缩放后的图像应始终保持其纵横比。

这如何使用 CSS 来完成？

编辑：

我正在建模的网站本质上是[http://www.vassar.edu/](http://www.vassar.edu/)。屏幕中央的主图像是我要建模的。我希望能够在这张图片上放置文字。

以下是相关的 HTML 和 CSS：

```
td.content
{
    vertical-align:  top;
    text-align:      left;
    font-family:     "Arial";
    font-style:      normal;
    font-size:       0.9em;
    background:      url('/pages/home/intro_image.jpg');
    background-size: 100%;
    width:           100%;
}

table.content_document
{
    width:            50%;
    padding:          0px;
    margin-top:       2em;
    border:           solid thin grey;
    border-radius:    0.5em;
    box-shadow:       black 0.5em 0.5em 0.3em;
    background-color: white;
    padding:          1em;
    position:         relative;
}

td.content_text_cell
{
    overflow: scroll;
}

<table>
    <tr class="content">
        <td class="content" colspan="2">
            <table class="content_document">
                <tr>
                    <td class="content_text_cell">
                        <p>
                            This is a simple test
                        </p>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:07:24.523

如果将图像添加为背景图像，则无法完成。
但如果它是表格单元格内的 img 元素，则单元格高度将与图像高度不同。

这是[添加的小提琴](http://jsfiddle.net/Yuss8/)。

# python - “ascii”编解码器无法在位置解码字节 0xef

> ID：12149539
> 
> 赞同：4
> 
> 时间：2012-08-27T20:59:55.997
> 
> 标签：python, python-2.7

我在这条线上遇到了这个讨厌的错误：

```
 r += '\n<Placemark><name>'+row[3].encode('utf-8','xmlcharrefreplace')+'</name>' \
         '\n<description>'+desc.encode('utf-8','xmlcharrefreplace')+'</description>\n' \
         '<Point><coordinates>'+row[clat].encode('utf-8','xmlcharrefreplace')+
         ','+row[clongitude].encode('utf-8','xmlcharrefreplace')+'</coordinates></Point>\n' \
         '<address>'+row[4].encode('utf-8','xmlcharrefreplace')+'</address>\n' \
         '<styleUrl>'+row[cstyleID].encode('utf-8','xmlcharrefreplace')+'</styleUrl>\n' \
         '</Placemark>' 
```

这是错误：

```
Traceback (most recent call last):
  File "<pyshell#38>", line 1, in <module>
    doStuff()
  File "C:\Python27\work\GenerateKML.py", line 5, in doStuff
    createFiles('together.csv')
  File "C:\Python27\work\GenerateKML.py", line 55, in createFiles
    '<styleUrl>'+row[cstyleID].encode('utf-8','xmlcharrefreplace')+'</styleUrl>\n' \
UnicodeDecodeError: 'ascii' codec can't decode byte 0xef in position 60: ordinal not in range(128) 
```

我究竟做错了什么？

感谢您的帮助。

这是完整的来源：

```
import hashlib
import csv

def doStuff():
  createFiles('together.csv')

def readFile(fileName):
  a=open(fileName)
  fileContents=a.read()
  a.close()
  return fileContents

def readCSVFile(fileName):
  return list(csv.reader(open(fileName, 'rb'), delimiter=',', quotechar='"'))

def GetDistinctValues(theFile, theColumn):
    with open(theFile, "rb") as fp:
        reader = csv.reader(fp)
        return list(set(line[theColumn] for line in reader))

def createFiles(inputFile):
  cNAME=3
  clat=0
  clongitude=1
  caddress1=4
  caddress2=5
  cplace=6
  ccity=7
  cstate=8
  czip=9
  cphone=10
  cwebsite=11
  cstyleID=18
  inputFileText=readCSVFile(inputFile)
  headerFile = readFile('header.txt')
  footerFile = readFile('footer.txt')
  r=headerFile
  DISTINCTCOLUMN=12
  dValues = GetDistinctValues(inputFile,DISTINCTCOLUMN)
  counter=0

  for uniqueValue in dValues:
    counter+=1
    print uniqueValue
    theHash=hashlib.sha224(uniqueValue).hexdigest()
    for row in inputFileText:
      if uniqueValue==row[DISTINCTCOLUMN]:
        for eachElement in row:
          eachElement=eachElement.replace('&','&amp;')            
        desc = ' '.join(row[3:])
        r += '\n<Placemark><name>'+row[3].encode('utf-8','xmlcharrefreplace')+'</name>' \
             '\n<description>'+desc.encode('utf-8','xmlcharrefreplace')+'</description>\n' \
             '<Point><coordinates>'+row[clat].encode('utf-8','xmlcharrefreplace')+
             ','+row[clongitude].encode('utf-8','xmlcharrefreplace')+'</coordinates></Point>\n' \
             '<address>'+row[4].encode('utf-8','xmlcharrefreplace')+'</address>\n' \
             '<styleUrl>'+row[cstyleID].encode('utf-8','xmlcharrefreplace')+'</styleUrl>\n' \
             '</Placemark>'      
    r += footerFile

    f = open(theHash+'.kml','w')
    f.write(r)
    f.close()
    r=headerFile 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T21:11:48.010

您可能正在尝试对字节进行编码。在这种情况下，Python 首先使用默认编码 (ASCII) 解码字节，然后使用您提供的编码对结果 Unicode 字符串进行编码。

解决方案是：不要对字节进行编码，即`encode()`仅在 Unicode 字符串上使用。在你的情况下，根本不要使用它。

要创建有效的 XML 文档，您可以使用[xml.etree.ElementTree 模块](http://docs.python.org/library/xml.etree.elementtree.html)。

# php - 当我尝试运行使用 CodeIgniter 编写的项目时出现 Xampp 未知错误

> ID：12149545
> 
> 赞同：0
> 
> 时间：2012-08-27T21:00:27.717
> 
> 标签：php, mysql, codeigniter, xampp

我下载并安装了 Xampp 1.8.0 和 1.5.0（针对不同版本的 PHP）。它们都与 HelloWorld 程序一起使用，但是当我尝试运行 CodeIgniter 项目时，它会出现此错误。![错误](../Images/8fea1e57f60be1aaa59fb7ae4d9156a0.png)

它说“数据库出现问题”和“无法使用数据库服务器提供的配置建立连接”。几乎到处检查（CodeIgniter、Xampp、Wamp）每个站点和每个版本。我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:21:02.673

如果你去你的`application`文件夹`codeigniter`，会有一个`config`文件夹，其中包含一个名为`database.php`. 此文件包含您的应用程序的数据库连接。

像这样的东西：

```
/*
| -------------------------------------------------------------------
| DATABASE CONNECTIVITY SETTINGS
| -------------------------------------------------------------------
| This file will contain the settings needed to access your database.
|
| For complete instructions please consult the 'Database Connection'
| page of the User Guide.
|
| -------------------------------------------------------------------
| EXPLANATION OF VARIABLES
| -------------------------------------------------------------------
|
|   ['hostname'] The hostname of your database server.
|   ['username'] The username used to connect to the database
|   ['password'] The password used to connect to the database
|   ['database'] The name of the database you want to connect to
|   ['dbdriver'] The database type. ie: mysql.  Currently supported:
                 mysql, mysqli, postgre, odbc, mssql, sqlite, oci8
|   ['dbprefix'] You can add an optional prefix, which will be added
|                to the table name when using the  Active Record class
|   ['pconnect'] TRUE/FALSE - Whether to use a persistent connection
|   ['db_debug'] TRUE/FALSE - Whether database errors should be displayed. 
```

**如果**您在应用程序中使用数据库，请确保此文件中的连接设置正确。

如果您没有在应用程序中使用数据库，则可能会自动加载数据库连接，这会导致您的应用程序失败。在这种情况下，转到`autoload.php`位于同一文件夹中的文件并检查以下行：

```
/*
| -------------------------------------------------------------------
|  Auto-load Libraries
| -------------------------------------------------------------------
| These are the classes located in the system/libraries folder
| or in your application/libraries folder.
|
| Prototype:
|
|   $autoload['libraries'] = array('database', 'session', 'xmlrpc');
*/

$autoload['libraries'] = array('database'); 
```

如果`database`正在自动加载，请将其从数组中删除，您的应用程序应该可以正常工作。

# ruby-on-rails - 访问 rails 中的 activerecord 字段

> ID：12149548
> 
> 赞同：0
> 
> 时间：2012-08-27T21:01:02.957
> 
> 标签：ruby-on-rails, ruby

在控制器方法中，我需要找到一些数据，使用like，所以我写：

```
***
esupp = oo.cell(line,'N')
supplier = Supplier.where("SUP_BRAND like ?", "%#{esupp}%")
@aa = @art_concret.find{|item| item['ART_SUP_ID']==supplier.SUP_ID}
*** 
```

但我得到像这样的错误

```
undefined method `SUP_ID' for #<ActiveRecord::Relation:0xa65048c> 
```

当我尝试编写 Supplier.all 时，一切都很好，我需要像 sql 一样。供应商有数据（在控制台中看到这个），但是当尝试访问字段时，得到错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:33:45.780

`supplier`不是您认为的对象 - 它是您返回的东西的列表。如果您希望只取回一个`Supplier`，请改为执行以下操作：

```
supplier = Supplier.where("SUP BRAND LIKE ?", "%#{esupp}%").first 
```

# vba - CreateObject 在 excel 2003 但不是 2010 中工作

> ID：12149552
> 
> 赞同：2
> 
> 时间：2012-08-27T21:01:28.180
> 
> 标签：vba, excel

本质上，代码只是在一个充满信息的目录中创建一个文本文件。就像标题说的我可以在 excel 2003 中打开工作表，它会运行良好，但如果它在 2010 年运行，则会弹出一个错误，提示运行时错误“70”权限被拒绝。

这是代码：

```
Dim i As Integer
Dim dataType As String
Dim dataName As String

Application.ScreenUpdating = False

ChDir ThisWorkbook.Path  'sets the directory to where the workpaper is
ChDir ".." 'Moves up a directory
ChDir (".\folder\")

direct = ThisWorkbook.Path

Worksheets("SchSB XML").Select

Set fs = CreateObject("Scripting.FileSystemObject")
Set a = fs.CreateTextFile(direct & "\" & flName &  ".xml", True)

a.writeline ("<?xml version=" & Chr(34) & "1.0" & Chr(34) & " encoding=" _
    & Chr(34) & "UTF-8" & Chr(34) & " standalone=" & Chr(34) & "yes" & Chr(34) & "?>")
a.writeline ("<SchSB xmlns:ns1=" & Chr(34) & "http://efast.gov/2011" _
    & Chr(34) & " xmlns:xsi=" & Chr(34) & "http://ww.w3.org/2001/XMLSchema-instance" & Chr(34) & ">") 
```

在此之后有一个循环，但它包含与上面相同的 a.writeline 代码，它旋转了大约 100 个单元格

调试显示 Set fs = CreateObject("Scripting.FileSystemObject") 正在破坏并显示权限被拒绝错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:03:59.697

即使使用“后期绑定”，您仍然需要检查“Microsoft Scripting Runtime”条目是否存在于引用列表中，并且它是否指向正确的文件路径，例如，所有计算机上的用户都可以访问的网络共享喜欢：

```
Z:\Lib\scrrun.dll 
```

反对：

```
C:\Users\"Username"\... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T22:22:14.957

这可能是因为您有一行代码的效果是：`Set fs = CreateObject("Scripting.FileSystemObject")`或`Set a = fs.CreateTextFile(direct & "\" & flName & ".xml", True)`在循环内。这可能会导致问题，因为 VBA 认为您正在尝试覆盖现有文件、打开已经打开的文件或类似的东西。为了解决这个问题和/或循环*之外*`CreateObject`的`CreateTextFile ，无论是之前还是之后（很可能是之前），然后从循环内部写入你想要的任何数据。

# linux - Linux：从多个目录复制一个文件

> ID：12149554
> 
> 赞同：1
> 
> 时间：2012-08-27T21:01:29.073
> 
> 标签：linux, copy, tar

我有一种情况，我想从 linux 下的数千个目录中复制特定文件“transaction.log”并构建一个包含这些相同特定文件的 tar 文件。

示例：我在 /user/foo/dirs/ 下有数千个目录

```
/user/foo/dirs/dir1
/user/foo/dirs/dir2
/user/foo/dirs/dir3
..
..
..
/user/foo/dirs/dir50000 
```

在每个目录中，都有几个文件和一个 transaction.log 文件。我想从所有 50000 个目录中复制这个 transaction.log 文件并将它们存储在一个 tar 文件中。

如果有办法，你能帮我吗？

谢谢。

# 解决方案：

Okies，我发现了这个问题，因为有一些指向其他磁盘的符号链接发现工作不正常。解决方案是使用 -follow 选项和 find 来跟踪符号链接。谢谢。我使用以下命令

寻找 。-follow -type f -name "transaction.log" | tar --create --files-from -> /foo/Stats_transaction_Object.tar.gz

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T22:23:01.077

带有 {} 的那个还不错，但它会为每个文件运行一个单独的 tar 进程。这是一个单一的 tar 进程，因此速度要快得多：

```
find /where/ever -name transaction.log -print | tar --create --files-from - > /somewhere/else/foo.tar 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T22:29:32.253

您可以使用以下命令：

```
cd /user/foo/dirs/
find . -type f -name "transaction.log" | xargs tar -zcvf transaction_logs_backup.tar.gz 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T21:52:38.187

假设您还想存储目录路径：

```
find /user/foo/dirs/ -name 'transaction.log' -exec tar rf /tmp/stuff.tar {} \; 
```

这会将在该目录结构中找到的每个 transaction.log 文件存储在 /tmp/stuff.tar 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T22:37:00.127

查找 /user/foo/dirs -name transaction.log | tar -cv -T- -f /tmp/stuff.tar

# java - 骆驼是否为每条路线创建一个线程

> ID：12149557
> 
> 赞同：8
> 
> 时间：2012-08-27T21:01:42.893
> 
> 标签：java, apache-camel

最近我开始使用骆驼，我发现它可能解决了我的很多集成层需求。

我创建了一个 java 客户端应用程序（不在任何容器中运行），我在其中定义了两条路由：

route1：将文件从传入的文件夹 1 移动到文件夹 2

route2：将文件内容从 folderx 移动到 mq 队列。

我启动我的应用程序，这些路由正在轮询这些文件夹并相应地路由消息。

谁能解释一下路线是如何工作的。骆驼（上下文）是否为每条路线创建一个线程。究竟会发生什么？

注意：我在骆驼网站上找不到关于此的简单说明。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-28T05:37:54.003

这取决于您在路由中使用的组件、正在创建和使用的线程数。

Camel 中的一些 EIP 也支持多线程（线程池），因此可以配置为使用 N 个线程。

在您的示例中，它是文件组件，它使用单个线程。由于您有 2 条路线，因此您将使用 2 条线程。一些组件还允许配置它们的线程（例如线程池）。例如，最近我们在 Camel 2.10 中添加了对文件组件的支持（请参阅[https://camel.apache.org/components/latest/file-component.html](https://camel.apache.org/components/latest/file-component.html)中的 scheduleExecutorService 选项）

这里有一些关于骆驼线程模型的注释 [http://camel.apache.org/threading-model.html](http://camel.apache.org/threading-model.html)

# assembly - 8086 汇编 - 除法溢出

> ID：12149560
> 
> 赞同：0
> 
> 时间：2012-08-27T21:02:04.670
> 
> 标签：assembly, x86, x86-16

我尝试在汇编中进行简单的除法，但出现“除法溢出”错误。

我的简单代码： cs:sum 和 cs:num 是一个字节变量。（D b）

```
 mov ax, word ptr cs:sum
mov cl, 10
xor dx,dx
div cl ; divide by 10
mov cs:num, ah ; ger rightest 
```

不知道为什么——但正如我所说——我没有正确分配。

那么你知道那个问题是什么以及如何解决它吗？谢谢 ！

（我使用 cs 尊重，因为那是一个 TSR 程序）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T10:59:12.310

为此导致除法异常

```
mov ax, word ptr cs:sum
mov cl, 10
div cl 
```

`ax`（来自）中的值`word ptr cs:sum`必须 >= 2560。

不是`word ptr cs:sum`< 2560 或者您的代码中的地址被破坏并且您没有将值存储在其中`word ptr cs:sum`或从那里获取它（例如，在引用 时您没有使用相同的段值`sum`）。

这些是唯一的可能性。

# python - Python str(u'a') 和 u'a'.encode('utf-8') 有什么区别

> ID：12149567
> 
> 赞同：8
> 
> 时间：2012-08-27T21:02:31.633
> 
> 标签：python, unicode

作为标题，是否有理由不使用 str() 将 unicode 字符串转换为 str？

```
>>> str(u'a')
'a'
>>> str(u'a').__class__
<type 'str'>
>>> u'a'.encode('utf-8')
'a'
>>> u'a'.encode('utf-8').__class__
<type 'str'>
>>> u'a'.encode().__class__
<type 'str'> 
```

更新：感谢您的回答，也不知道我是否使用特殊字符创建了一个字符串，它会自动转换为 utf-8

```
>>> a = '€'
>>> a.__class__
<type 'str'>
>>> a
'\xe2\x82\xac' 
```

也是 python 3 中的 Unicode 对象

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-27T21:04:50.893

当您编写它时，它将使用**默认编码**`str(u'a')`将 Unicode 字符串转换为字节字符串（除非您已经麻烦地[更改它](https://stackoverflow.com/questions/2276200/changing-default-encoding-of-python)）将是 ASCII。

 **第二个版本将字符串显式编码为 UTF-8。

如果您尝试使用包含非 ASCII 字符的字符串，则差异会更加明显。第二个版本仍然有效：

```
>>> u'€'.encode('utf-8')
'\xc2\x80'

```

第一个版本会给出一个例外：

```
>>> str(u'€')

回溯（最近一次通话最后）：
  文件“”，第 1 行，在
    str(u'€')
UnicodeEncodeError：“ascii”编解码器无法在位置 0 编码字符 u'\x80'：序数不在范围内（128）

```**

# python - mysql 服务器的 CPU 亲和性

> ID：12149570
> 
> 赞同：0
> 
> 时间：2012-08-27T21:02:51.713
> 
> 标签：python, mysql, linux, performance

我有**4 个 CPU**的 linux 服务器。我安装了**mysql**，并且我有在后台 24/7 运行的 CPU 繁重的任务。我对每个进程使用 CPU 亲和力有什么好处？例如：

```
1 CPU = background task/daemon
2 CPU = background task/daemon
3 CPU = background task/daemon
4 CPU = mysql 
```

在任何给定时间，每个后台任务都会占用多达 80% 的 CPU。

**更新**：我的任务是 lxml 解析器（python）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:30:27.467

我会看看你的流程在做什么。如果调度程序不断将任务切换到不同的内核/CPU，那么您可以通过将它们锁定到特定的内核/CPU 来获得性能提升。好处来自不必每次在两个内核/CPU 之间进行昂贵的上下文切换。

如果您没有看到这种情况发生，那么当调度程序可能需要对它们进行洗牌时，我认为不需要将它们锁定到特定的内核。

如果您正在寻找更具体的答案，您应该研究一下您的 Linux 内核正在使用什么调度程序以及它如何调度进程。一旦您了解了它是如何安排它们的，使用配置/标志可能会有所帮助，这样它就可以很好地处理您所有的后台繁重任务。但请记住，如果您做的事情过于极端，您将面临进程/线程饥饿、运行时间极长或总体性能不佳的巨大风险。

# javascript - javascript 样式背景颜色在设置时闪烁。ASP.NET

> ID：12149572
> 
> 赞同：0
> 
> 时间：2012-08-27T21:03:10.160
> 
> 标签：javascript, asp.net, styles, background-color

我正在尝试使用 javascript 在单击链接按钮时设置标签的背景颜色。
但是，背景会闪烁所需的颜色，然后回退到无背景。下面我有javascript函数以及有问题的控件。
我尝试使用 display='none',display='' 强制重绘，但无济于事。
另外，我尝试通过将标签设置为标准控件来使标签不在服务器上运行。
我还在设置样式的两个区域都设置了中断，并且调用了 LightGreen，但是没有空白，所以不确定背景在哪里被空白，因为在其他任何地方都没有指定。
谢谢，詹姆斯

**标签**

```
<asp:Label runat="server" Font-Bold="true" id="lblCustomer">Customer:</asp:Label> 
```

**Javascript**

```
function CheckUncheckAll(clientID, listID, check) {
        var chk = clientID.getElementsByTagName("input");
        for (var i = 0; i < chk.length; i++) {
            chk[i].checked = check;
        }
        if (check) {
            document.getElementById(listID.id).style.backgroundColor = "LightGreen";
        }
        else {
            document.getElementById(listID.id).style.backgroundColor = "";
        }
    } 
```

**背后的代码**

```
lbCustomerAll.Attributes.Add("onclick", "CheckUncheckAll(" + ckbxlstCustomer.ClientID + ", " + lblCustomer.ClientID + ", true)"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:13:43.720

如果您执行以下操作怎么办：

```
function CheckUncheckAll(clientID, listID, check) {
        var evt = document.getElementById(clientID);
        evt.preventDefault();

        var chk = clientID.getElementsByTagName("input");
        for (var i = 0; i < chk.length; i++) {
            chk[i].checked = check;
        }
        if (check) {
            document.getElementById(listID.id).style.backgroundColor = "LightGreen";
        }
        else {
            document.getElementById(listID.id).style.backgroundColor = "";
        }
    } 
```

这将防止触发链接按钮的默认行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:13:57.703

`checked`不是真/假值，它是二进制属性。

```
element.checked = true; //will fail
element.checked ='checked'; //will work 
```

如果传递的“检查”的值为真/假，则您的代码将不起作用。

PS jQuery 值得学习。您可以在一行代码中完成所有这些操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-06T19:09:20.900

遇到了同样的问题。偶然地，我意识到问题出在 Button 标签和 onclick 函数的关联上。

如果我将按钮更改为其他任何东西，例如`h1`，或者如果我将功能更改为`onmouseover`，它就可以工作。但是，无法弄清楚为什么。

# iphone - iOS 中的嵌套元素：父元素的背景在边缘可见

> ID：12149581
> 
> 赞同：1
> 
> 时间：2012-08-27T21:04:03.223
> 
> 标签：iphone, css, ipad

我有嵌套元素，其中父级的背景在 iDevices 上可见。无论使用何种浏览器（尝试过 Chrome 和 Safari），它都会创建一些边框/轮廓，类似于打印中的[出血](http://en.wikipedia.org/wiki/Bleed_%28printing%29)。

谁能帮我？

这是一个简化的代码和 JSFiddle：http: [//jsfiddle.net/5eTDD/6/](http://jsfiddle.net/5eTDD/6/)

```
<div class="a">
   <div class="b"></div>
</div>​

.a {background:#000; margin:10px; display:inline-block}
.b {width:100px; height:100px; background:#fff;}​ 
```

**屏幕截图**：

![截屏](../Images/571ac888f290e619c8dfc0d14c9b8f4d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T23:21:36.437

看起来边框出现在锚点上，而不是列表元素上。尝试添加：

```
a {border:0 !important} 
```

iDevices 有一个内置的样式表，有时会导致这种情况，这就是 !important 存在的原因 - 覆盖它。它甚至可能与您的“活动”类相关联 - 您也可以尝试将类更改为其他内容，只需尝试 active1，看看是否也可以修复它。

# java - Grails ASTTransformation：如何加载其他类（例如 Class.forName(..)）？

> ID：12149582
> 
> 赞同：0
> 
> 时间：2012-08-27T21:04:19.347
> 
> 标签：java, grails, groovy, classloader, abstract-syntax-tree

我正在我的项目中写一个`ASTTransformation`（用 JAVA 语言）`Grails`。

因为我想**基于另一个类来转换带注释的类**，所以我需要加载另一个类并分析它`AST`。

但是我没有成功加载另一个类：

```
Class.forName("OtherClass") -> ClassNotFoundException
Class.forName("OtherClass", false, classNode.getClassLoader()) -> ClassNotFoundException
OtherClass.class -> ClassNotFoundException 
```

它认为因为它`AST`本身是在编译时执行的，所以另一个类还不可用。

也许有可能在 my 中获取另一个类的来源，`ASTTransformation`然后`AST`用

```
new AstBuilder().buildFromCode { ... } 
```

或类似的东西。

但是如何加载资源/代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T07:38:21.647

我现在找到了解决方案：

```
ClassNode classNode = (ClassNode) astNode;
classNode.getCompileUnit().getClass("de.foo.bar.OtherClass") 
```

创建一个新`ClassNode`的，包含有关字段、方法、属性等的所有信息。

# c# - Windows 8 - 自定义动态磁贴

> ID：12149591
> 
> 赞同：3
> 
> 时间：2012-08-27T21:05:18.350
> 
> 标签：c#, .net, windows-8, microsoft-metro, visual-studio-2012

我们正在用 C# 开发适用于 Windows 8 的应用程序。

我们的应用程序涉及用户创建的绘图，我们希望将他们的绘图合并到动态磁贴中。

我找到了将文本和图片设置为应用程序动态磁贴的示例。有没有办法做自定义的东西来渲染线条等？

还是通过将 PNG 渲染到应用程序的 AppData 目录来完成我们需要的唯一方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:09:11.950

您需要将 PNG 或 JPG 渲染到应用程序数据目录中。动态磁贴具有固定数量的预定义模板，除此之外，您所能做的就是选择具有完整磁贴图像的模板并提供您自己的图像。

# c++ - 如何在 C++ 中创建随机数数组

> ID：12149593
> 
> 赞同：3
> 
> 时间：2012-08-27T21:05:32.800
> 
> 标签：c++, visual-c++

除了 ELEMENTS 是 25 之外，还有一种方法可以随机生成大量元素....10000、100000 甚至 1000000 个元素，然后使用我的插入排序算法。我正在尝试拥有大量元素并使用插入排序将它们按顺序排列，然后以相反的顺序排列。接下来我在 time.h 文件中使用了 clock() 来计算每个算法的运行时间。我正在尝试使用大量数字进行测试。

```
#define ELEMENTS 25

void insertion_sort(int x[],int length);
void insertion_sort_reverse(int x[],int length);

int main()
{
  clock_t tStart = clock();
  int B[ELEMENTS]={4,2,5,6,1,3,17,14,67,45,32,66,88,
               78,69,92,93,21,25,23,71,61,59,60,30};
  int x;

  cout<<"Not Sorted: "<<endl;
  for(x=0;x<ELEMENTS;x++)
       cout<<B[x]<<endl;

   insertion_sort(B,ELEMENTS);
   cout <<"Sorted Normal: "<<endl;
  for(x=0;x<ELEMENTS;x++)
       cout<< B[x] <<endl;

  insertion_sort_reverse(B,ELEMENTS);
  cout <<"Sorted Reverse: "<<endl;
  for(x=0;x<ELEMENTS;x++)
       cout<< B[x] <<endl;

  double seconds = clock() / double(CLK_TCK);
  cout << "This program has been running for " << seconds << " seconds." << endl;
  system("pause");
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-27T21:09:43.930

```
#include <random>     // mt19937 and uniform_int_distribution
#include <algorithm>  // generate
#include <vector>     // vector
#include <iterator>   // begin, end, and ostream_iterator
#include <functional> // bind
#include <iostream>   // cout

std::vector<int> create_random_data(int n) {
  std::random_device r;
  std::seed_seq      seed{r(), r(), r(), r(), r(), r(), r(), r()};
  std::mt19937       eng(seed); // a source of random data

  std::uniform_int_distribution<int> dist;
  std::vector<int> v(n);

  generate(begin(v), end(v), bind(dist, eng));
  return v;
}

int main() {
  auto random_data = create_random_data(100000);

  std::cout << "unsorted: ";
  copy(begin(random_data), end(random_data),
       std::ostream_iterator<int>(std::cout, "\n"));
} 
```

`generate`是一种用仿函数生成的值填充范围的通用算法。在这种情况下，我们为它提供了一个仿函数，它使用我们的随机数据源来生成随机数，并且我们提供了一个对应于容器的范围，我们可以在`generate`填充数据后使用它。

*   [`std::generate()`](http://en.cppreference.com/w/cpp/algorithm/generate)
*   [`std::uniform_int_distribution`](http://en.cppreference.com/w/cpp/numeric/random/uniform_int_distribution)
*   [`std::mt19937`](http://en.cppreference.com/w/cpp/numeric/random/mersenne_twister_engine)

我们使用`std::mt19937`and `std::uniform_int_distribution`，自 C++11 开始的标准 C++ 工具（在 VS2010 中可用）来创建随机数而不是旧的`std::rand()`，`std::srand()`因为新的方法更容易正确使用、更高的质量和更灵活。

* * *

如果您使用的是 VS2012 或更高版本，则可以使用 C++11 时间库。

```
#include <chrono>

int main() {
  using std::chrono::high_resolution_clock;
  using std::chrono::duration_cast;
  using std::chrono::nanoseconds;

  auto start = high_resolution_clock::now();

  // ...

  auto end = high_resolution_clock::now();

  std::cout << duration_cast<nanoseconds>(end - start).count() << "ns\n";
} 
```

*   [`<chrono>`](http://en.cppreference.com/w/cpp/header/chrono)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-27T21:10:46.153

代替

```
void insertion_sort(int x[],int length);
void insertion_sort_reverse(int x[],int length);

 int B[ELEMENTS]={4,2,5,6,1,3,17,14,67,45,32,66,88,
           78,69,92,93,21,25,23,71,61,59,60,30}; 
```

尝试

```
void insertion_sort(std::vector<int>& x);
void insertion_sort_reverse(std::vector<int>& x);

 srand(NULL);
 std::vector<int> B(num_elements); //num_elements can be a variable
 std::generate(B.begin(), B.end(), rand); 
```

与任务相关而不是问题：
您需要连续两次运行每种排序，第一次没有计时，第二次有计时。
您的测试不公平，因为一个从随机位置开始，另一个从排序位置开始。
您在计时中包含 IO，并且 IO 总是很慢（`cout`）
`std::endl`强制程序立即将所有输出提供给操作系统，使用`'\n'`.
您正在显示完全不相关的秒数。

```
int main()
{
  srand(NULL);
  std::vector<int> B(num_elements); //num_elements can be a variable
  std::generate(B.begin(), B.end(), rand);
  std::vector<int> C(B); //make a copy of the data

  std::cout << "Not Sorted:" << '\n';
  for(int i=0;i<B.size();i++)
       cout<<B[i]<<'\n';

  clock_t tStart0 = clock();        
  insertion_sort(B,ELEMENTS);
  clock_t tStop0 = clock();     

  cout <<"Sorted Normal: "<<'\n';
  for(int i=0;i<B.size();i++)
       cout<< B[i] <<'\n';

  clock_t tStart1 = clock();        
  insertion_sort_reverse(C);
  clock_t tStop1 = clock();  

  cout <<"Sorted Reverse: "<<'\n';
  for(int i=0;i<C.size();i++)
       cout<< C[i] <<'\n';

  double seconds = (tStop1-tStart1 + tStop0-tStart0) / double(CLK_TCK);
  cout << "This program has been running for " << seconds << " seconds." << endl;
  system("pause");
  return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-10-09T01:58:12.267

对于 C++11，我使用时间值作为初始随机种子来生成任意数量的随机数据。

请参阅以下示例代码

```
#include <iostream>
#include <random>
#include <chrono>
#include <functional>
#include <iterator>

constexpr auto MAX = 20;

int main(int argc, char* argv[]) {

    std::default_random_engine re(std::chrono::system_clock::now().time_since_epoch().count());
    std::uniform_int_distribution<int> uid(0, MAX);
    int nums[MAX] {};
    std::generate(nums, nums+MAX, std::bind(uid, re));

    // apply sort algorithm

    std::copy(nums, nums+MAX, std::ostream_iterator<int>(std::cout, ","));
    std::cout << std::endl;
    return 0;
} 
```

# salesforce - 如何将顶级沙箱转移到生产环境

> ID：12149595
> 
> 赞同：0
> 
> 时间：2012-08-27T21:05:47.993
> 
> 标签：salesforce, apex-code

我在沙箱中创建了一些类和触发器。类是日期助手的类型，我在触发器中使用。我试图从沙盒转移我的作品。我失败了。我下载了 Force IDE，并在此处复制了我的代码。所以，我的触发器不见了，但我的顶点类不是在生产中创建的。

我怎样才能为生产创建一个顶点类。

我们的销售商是企业版。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:52:33.847

最快的方法是从eclipse IDE创建一个项目到你的沙箱，选择你想要sincronice的项目并获取这些项目，然后你必须右键单击部署到salesforce ...并选择你的prod环境。

如果这不能解决您的问题，请向我们提供更多信息：您遇到了哪些错误？你有多少代码覆盖率？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T07:28:50.340

嗨，我是不同帐户的 Kerem Bekman，

这是我的课，

```
public class DateProcess
{
public DateProcess()
{
}
public Boolean isDaysOff(Datetime dt)
{
    if(dt.format('E') == 'Sat' || dt.format('E') == 'Sun')
        return true;
    else
        return false;
}
public Datetime getLastBussinessDateOfMonth(Datetime dt)
{
    //Datetime temp = new DateTime();
    while(this.isDaysOff(dt))
    {
        dt = dt.addDays(-1);
    }
    return dt;
}
} 
```

我在沙盒项目的 Force IDE 中创建了这个类。所以我点击了“部署到服务器”。我的课已经投入生产，但是

仅有的

```
public class DateProcess() {} 
```

我在 IDE 上查看了 Apex Test Runner

DateProcess (ApexClass) -- 9 行未测试。%0 已覆盖。

我怎么能测试我的课。我不知道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T10:42:28.573

我做到了。

这是测试方法。

您必须在您的班级或其他类似的班级中测试您的代码。

```
public class DateHelper
{
    public DateHelper()
    {
    }

    public Boolean isDaysOff(Datetime dt)
    {
        if(dt.format('E') == 'Sat' || dt.format('E') == 'Sun')
            return true;
        else
            return false;
    }

    static testMethod void testisDaysOff(){     
        DateHelper dh = new DateHelper();
        Datetime dt = Datetime.now();
        Test.startTest();

        Boolean ido1 = dh.isDaysOff(dt);
        dt = dt.addDays(-2);
        Boolean ido2 = dh.isDaysOff(dt);

        Datetime last = dh.getLastBussinessDateOfMonth(dt);

        Test.stopTest();
        System.assertEquals(false, ido1);
        System.assertEquals(true, ido2);
    }

    public Datetime getLastBussinessDateOfMonth(Datetime dt)
    {
        //Datetime temp = new DateTime();
        while(this.isDaysOff(dt))
        {
            dt = dt.addDays(-1);
        }
        return dt;
    }
} 
```

使用 force ide 将代码部署到生产环境。所以点击在salesforce上运行测试。

就这样..

# actionscript-3 - AS3：MovieClip(root) 的计算结果为 null？

> ID：12149599
> 
> 赞同：0
> 
> 时间：2012-08-27T21:06:05.743
> 
> 标签：actionscript-3, flash

好的，我不太习惯 Flash，我在这个问题上已经被困了几个小时，所以任何帮助都会非常感激......
我有这个非常复杂的 FLA，它基本上是这样设置的：

1.  “场景一”

    *   一些加载动画（和代码）
    *   AS 代码从 flashvars（在 HTML 代码中）接收值并验证它们
    *   在场景 1 时间线的末尾，我们输入了第二个影片剪辑：
2.  “地图总”

    *   这里显示了一张地图，上面出现了各种元素
    *   这里没有什么有趣的动作脚本
    *   但在这些元素中，一个影片剪辑：
3.  “btn-vb”

    *   这里，各种层；其中一个包含另一个电影剪辑（vb_anim）
    *   还包含一些 AS 代码以使 vb_anim 在鼠标滚动时变大，并在鼠标离开时反转（并对点击做出反应）
4.  “vb_anim”

    *   在这里，我们找到了一些带有一些基本动画的图层。
    *   在这些层中，三个代表同一个按钮的不同变体（可用、未准备好、禁止）。
    *   这三层中的每一层都包含一个实例化对象（带有一些补间）

我需要的是：
根据我在场景 1 中收到的 flashvars，我需要在“vb_anim”中显示或隐藏这三个对象中的一个或几个。

为了访问场景 1 中设置的变量，我使用以下快捷方式：

```
var global:MovieClip = MovieClip(root);
// allows for access to the "root" variables
// e.g. global.myVar 
```

我已经在“btn-vb”中使用了相同的代码（我需要访问 flashvars 提供的信息才能定义 onclick 事件），它就像一个魅力。

但是，当从“vb_anim”内部调用时，MovieClip(root) 的计算结果似乎为 null。因此，无法访问场景 1 中的变量，并且当我尝试这样做时，Flash 会抛出“TypeError：错误 #1009”。

由于“vb_anim”只是嵌入在“btn-vb”中，我不明白为什么它看不到 MovieClip(root) 而它的父级可以。

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T06:52:55.550

您在 IDE 中的 MovieClip 时间轴上声明的变量仅属于该剪辑，IDE 中的代码生成器将从它们为它为您使用的 MovieClip 生成的类生成类字段。这就是为什么它不起作用的原因，我想。即，您在只有与包含该代码的 MovieClip 关联的代码可以访问它的位置声明了此变量，但与您所称的相反，它不是全局的。

ActionScript 并没有真正的全局变量的概念，变量可以被限定为一个类（字段，或也称为成员）或包级变量（一种很少使用且很大程度上不鼓励的做法），而第二种可能有时服务于全局变量的目的，它没有提供确保唯一性的机制，因此存在潜在的错误危险和/或安全风险。在 AS3 中没有办法解决这个问题，这就是为什么最好完全避免它。

但这不是您的代码的唯一问题。您正在投射`root`到 MovieClip 只是因为它可以让您避免类型检查（使您的代码更容易出错）。解决这种情况的正确方法是为根容器创建一个类，并通过IDE（IDE 将此类称为“文档类”）分配给根容器。然后，无论何时使用`root`，您都可以将其强制转换为该类，从而允许代码辅助和编译器帮助您更快地编写更安全的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T01:30:12.177

时间轴上任何位置的所有影片剪辑（或通过 ActionScript 添加的，实际加载程序除外）都有一个 loaderInfo 属性，该属性指向您已经在读取参数的同一个 loaderInfo，因此您不需要参考根。

此外，对于孩子来说，了解其父母/祖父母/等的任何事情都是非常糟糕的做法。见[封装](http://en.wikipedia.org/wiki/Encapsulation_%28object-oriented_programming%29)。相反，让孩子公开一个属性（变量），父母可以用正确的信息填充该属性（变量）。因此，您的主时间线将信息提供给 btn-vb，btn-vb 既使用它又将其传递给 vb_anim。

# c# - C# Bouncycastle Blowfish CTR 解密

> ID：12149600
> 
> 赞同：2
> 
> 时间：2012-08-27T21:06:12.450
> 
> 标签：c#, .net, cryptography, bouncycastle, blowfish

我很难弄清楚如何使用 C# bouncycastle 库来解密河豚 CTR 密文。由于缺乏关于如何正确使用它的 BC 文档，我不知道如何使用它。

我进行了广泛的搜索，但没有在堆栈溢出中找到类似的东西，如果您有一些关于如何使用 BC 在 Blowfish CTR 模式密码中使用 BC C# 库进行加密/解密的示例，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T16:56:09.053

没关系，经过漫长的一周后，我决定使用 AES CBC 而不是 Blowfish CTR，使用 Zeroes 作为填充。

# c++ - 将大型 c++ 程序拆分为多个组件

> ID：12149603
> 
> 赞同：0
> 
> 时间：2012-08-27T21:06:23.683
> 
> 标签：c++, dll, dylib, decoupling

我有一个由许多 .cpp 和 .h 文件组成的 c++ 程序。

我想通过为程序的某个功能获取一堆 .cpp 文件来引入一些物理解耦，并将该功能编译成单独的 .dll / dylib。

这样做时，dylib 不会链接，因为它在“主”应用程序中调用了许多（100s）函数。我有什么选择来解决这个问题？（平台：osx、windows和linux）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T21:11:55.407

这个问题没有简单的答案。解开一个[大泥球](http://en.wikipedia.org/wiki/Big_ball_of_mud)是一门艺术而不是一门科学。我将从您的位置开始的基本方法是添加第三个组件，其中包含这 100 个函数，并使其成为主应用程序和功能 dll 的依赖项。然而，当您尝试识别系统的真正“叶子”组件时，这可能是一个兔子洞。

[Martin Fowler 关于重构的信息](http://refactoring.com/)有很多很好的资源。

# jquery - empty() 除特定元素外的所有内容

> ID：12149607
> 
> 赞同：4
> 
> 时间：2012-08-27T21:07:15.950
> 
> 标签：jquery

使用 jQuery 的`empty()`方法，我可以防止从 DOM 中删除特定元素，同时删除所有其他元素吗？

例如：

```
<div id="container">
    <div id="noRemove"></div>
    ... more content ...
</div> 
```

当我使用 jQuery 进行此调用时`$("#container").empty()`，如何防止删除，`noRemove`同时仍删除里面的其余内容`container`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-27T21:10:12.917

您不能`empty`单独使用该功能。这是您可以做到的一种方法：

```
var $container = $('#container'),
    $noRemove = $container.find('#noRemove');

$container.html($noRemove); 
```

这是一个小提琴：http: [//jsfiddle.net/joplomacedo/R4cu5/](http://jsfiddle.net/joplomacedo/R4cu5/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-27T21:13:54.940

使用以下内容，它将从容器中删除所有内容，*但*元素`id`为`noRemove`：

```
$('#container').contents().filter(function () {
    return this.id != "noRemove";
}).remove(); 
```

**[演示](http://jsfiddle.net/uTctB/)**。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-11T20:23:04.023

这是我刚刚使用的东西，它涉及在特定行的 AJAX 拉取后刷新表数据。有点偏题的回答。

```
$('.overrideFcstRow td').each(function(){
    if(!$(this).hasClass('overrideTitle')){
        $(this).empty();
    }
}); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-27T21:12:07.390

我认为这应该可以解决问题：

```
$("#container").find(":not(#noRemove)").remove(); 
```

# android - Android 服务在 onRebind() 后失败并出现 DeadObjectException

> ID：12149610
> 
> 赞同：1
> 
> 时间：2012-08-27T21:07:18.893
> 
> 标签：android, service

我的 Android 服务和重新绑定到它的客户端应用程序有问题。当客户端应用程序最初绑定到我的服务时，一切正常，之后可以将消息从服​​务发送到客户端。但是，如果客户端应用程序被杀死然后再次绑定，则在服务中正确调用 onRebind()，但我在意图中的信使无效，导致 DeadObjectException，如下面的代码中所述。有任何想法吗？

这是我的服务代码：

```
@Override
public IBinder onBind(Intent intent)
{        
    getMessenger(intent);

    return _inputMessenger.getBinder();
}

@Override
public void onRebind(Intent intent)
{        
    getMessenger(intent);
}

@Override
public boolean onUnbind(Intent intent)
{                
    return true;
}

private void getMessenger(Intent intent)
{
    Bundle extras = intent.getExtras();

    if (extras != null)
    {
        // Get the messenger sent from the app.
        // This is handled correctly after onBind() and onRebind().
        _outputMessenger = (Messenger) extras.get("MESSENGER"); 
        Log.i(TAG, "Got messenger from app: " + _outputMessenger);           
    }
}

private void sendMessageToClient(String key, String value)
{   
    Message message = Message.obtain();
    Bundle bundle = new Bundle();
    bundle.putString(key, value);
    message.setData(bundle);

    try
    {
        _outputMessenger.send(message); // EXCEPTION OCCURS HERE AFTER onRebind()
    }
    catch (Exception ex)
    {
        Log.e(TAG, "_outputMessenger.send() failed: " + ex);
    }
} 
```

这是应用程序的代码：

```
 Intent intent = new Intent("com.foobar.service");

    // Create a new messenger for the communication from service to app.
    _messenger = new Messenger(new ServiceToActivityHandler());
    intent.putExtra("MESSENGER", _messenger);

    _serviceConnection = new MyServiceConnection();

    _isBoundToService = _context.bindService(intent, 
                                           _serviceConnection, 
                                           Context.BIND_AUTO_CREATE); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:44:59.627

有一个关于绑定服务的[注释](http://developer.android.com/guide/components/bound-services.html)......附加注释下的部分应该很有用。我认为捕获异常可能是你应该做的......

```
try {
    // Do stuff
} catch(DeadObjectException e){
    // Dead object
} 
```

我读到对象生命周期应该由android跨进程引用计数，所以你应该没问题，当客户端死时我想知道是否

```
 _outputMessenger // needs to be unassigned in your service...? 
```

我假设正在发生的事情是您与服务的绑定，它将一些数据泵回您的客户端，您的客户端消失了，服务继续运行但随后需要将一些数据泵送到此时已经消失的客户端？

还有这个[链接](https://stackoverflow.com/questions/3156389/android-remoteexceptions-and-services)

# javascript - LoadControl HttpCompileException 自定义服务器控件 JavaScript 错误

> ID：12149611
> 
> 赞同：0
> 
> 时间：2012-08-27T21:07:22.627
> 
> 标签：javascript, asp.net

我有一个带有复选框控件的自定义覆盖文本框。该控件工作正常，除非我尝试在 Javascript 中引用控件的 TextBox/CheckBox ID，然后在呈现控件之前我得到一个 HttpCompileException。是否有一个覆盖事件可以更好地在一个控件中添加多个控件，或者完全有更好的方法？

页面上的控件：OverridableTextBox runat="server" ID="otbRate" TextBoxID="txtRate" CheckBoxID="chbRate">

在 JavaScript 中引用 ID：“<%=txtRate.ClientID %>”导致 .ascx 页面的 LoadControl 事件发生 HttpCompileException

覆盖文本框类

```
 private string _TextBoxID = "";
    private string _CheckBoxID = "";
    private bool _AlignOverrideLeft = false;
    private string _CheckBoxText = "";

    public string TextBoxID
    {
        get { return _TextBoxID; }
        set { _TextBoxID = value; }
    }
    public string CheckBoxID
    {
        get { return _CheckBoxID; }
        set { _CheckBoxID = value; }
    }
    public string CheckBoxText
    {
        get { return _CheckBoxText; }
        set { _CheckBoxText = value; }
    }
    public bool AlignOverrideLeft
    {
        get { return _AlignOverrideLeft; }
        set { _AlignOverrideLeft = value; }
    }

    public TextBox TextBox = new TextBox();
    public CheckBox CheckBox = new CheckBox();

    protected override void OnInit(EventArgs e)
    {
        Table tbl = new Table();
        TableRow tr = new TableRow();
        TableCell tdOne = new TableCell();
        TableCell tdTwo = new TableCell();

        if (AlignOverrideLeft)
        {
            tdOne.Controls.Add(CheckBox);
            tdTwo.Controls.Add(TextBox);
        }
        else
        {
            tdOne.Controls.Add(TextBox);
            tdTwo.Controls.Add(CheckBox);
        }

        if (_TextBoxID != "") { TextBox.ID = _TextBoxID; }
        if (_CheckBoxID != "") { CheckBox.ID = _CheckBoxID; }

        CheckBox.Text = _CheckBoxText;

        tr.Cells.Add(tdOne);
        tr.Cells.Add(tdTwo);
        tbl.Rows.Add(tr);
        this.Controls.Add(tbl);
    }

    protected override void Render(HtmlTextWriter w)
    {
        if (CheckBox.Checked)
        {
            TextBox.ReadOnly = false;
        }
        else
        {
            TextBox.ReadOnly = true;
        }

        string CheckBoxClickJS = "var chb = d.getElementById('" + CheckBox.ClientID + "'); var txt = d.getElementById('" + TextBox.ClientID + "');";
        CheckBoxClickJS += "if (chb.checked) { EnableTextBox(txt); txt.select(); } else { DisableTextBox(txt); }";

        if (CheckBox.Attributes["onclick"] != null)
        {
            CheckBox.Attributes.Add("onclick", CheckBox.Attributes["onclick"].ToString() + CheckBoxClickJS);
        }
        else
        {
            CheckBox.Attributes.Add("onclick", CheckBoxClickJS);
        }

        base.Render(w);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T04:49:04.293

您的页面无法`txtRate`直接访问文本框，因为它放置在控件的`Controls`集合中`otbRate`。试试这个：`'<%= otbRate.ClientID + "_txtRate" %>'`

# c - 为什么从结构中传递指针需要额外的取消引用？

> ID：12149613
> 
> 赞同：1
> 
> 时间：2012-08-27T21:07:29.710
> 
> 标签：c, function, pointers, struct, dereference

我正在使用 C 语言中的双链表，我遇到了一些我意识到我总是被接受为事实的东西，或者曾经知道答案但现在已经忘记了。当我再次开始使用指针时，这经常发生在我身上，我最终不得不每次都重新学习它们。

这是我的设置的基础知识：

```
int main(void)
{
    video *head = NULL;
    video *tail = NULL;

    char *buffer = NULL;
    buffer = (char*)malloc(sizeof(MAX_TITLE_LENGTH));

    printf("Enter a title: ");
    fgets(buffer, MAX_TITLE_LENGTH, stdin);

    insert(buffer, &head, &tail);
} 
```

我有一个结构：

```
typedef struct video
{
    char title[MAX_TITLE_LENGTH];
    struct video *prev;
    struct video *next;
}video; 
```

插入原型：

```
int insert (char *title, video **head, video **tail); 
```

我想知道为什么我必须专门传递视频*的地址。

我知道我传递字符的方式是传递字符串开头的内存地址。为什么我必须再次取消引用头部和尾部才能访问它们的值？

老实说，这比我想象的要简单，我确信这一点，而且我的大脑在考虑指针时处于一个糟糕的位置。

谁能把它弄松？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T21:08:29.127

这是因为该函数`insert`可能需要更改what`head`并`tail`指向*.*

请记住，在 C 中，函数参数是按值传递的。这就是为什么您将指针传递给`struct`要在函数中更改的 a：提供指针允许您的函数访问内存中的实际结构。

但是指向 的指针`struct`是按值传递的。如果要更改指针*指向的内容*怎么办？您将需要一个额外的引用级别，或者实际保存指针的内存，这样它就不会被简单地复制。使用附加级别的 if 引用，您将可以访问指针以在函数中更改它，并且可以使指针指向其他内容。

你会经常在链表代码中看到这一点，它需要修改`head`元素：列表中的所有其他元素 - 大概 - 可以通过使用列表中每个节点中包含的指针访问，但如果你需要例如插入头部有一个新元素，您的函数将需要*更改*头部指针。如果将其作为函数参数传入，则需要它的地址，否则函数只会更改副本，并且更改不会反映在函数之外。

# c# - 仅显示捕获的组

> ID：12149614
> 
> 赞同：0
> 
> 时间：2012-08-27T21:07:41.147
> 
> 标签：c#, regex, winforms

我试图**只**显示捕获的正则表达式组（被 () 包围的那些），但无论我尝试了什么，它都会显示捕获的和匹配的。

我正在寻找的是一种仅显示捕获的组的解决方案。

这是显示上述两个组的示例代码：

```
RegexOptions ignoreSpace = checkEditIgnoreSpaces.Checked ? RegexOptions.IgnorePatternWhitespace : RegexOptions.None;
RegexOptions ignorecase = checkEditIgnoreCase.Checked ? RegexOptions.IgnoreCase : RegexOptions.None;
RegexOptions multiline = checkEditMultiline.Checked ? RegexOptions.Multiline : RegexOptions.Singleline;
RegexOptions ignoreUnnamedGroups = checkEditCaptureUnnamedGroups.Checked ? RegexOptions.None : RegexOptions.ExplicitCapture;

MatchCollection mc = Regex.Matches(myRichTextBox1.Text, pattern, ignorecase | ignoreSpace | multiline | ignoreUnnamedGroups);

if (mc.Count > 0)
{
    foreach (Match match in mc)
    {
        Console.WriteLine(match.Value);
    }
} 
```

我希望 match.Captures 仅包含捕获的组，但事实并非如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:09:16.993

试试这个

```
match.Groups[1].Value; 
```

[来源](http://www.dotnetperls.com/regex-match)

# c# - 将 OracleLob 作为参数传递给函数

> ID：12149618
> 
> 赞同：1
> 
> 时间：2012-08-27T21:08:01.497
> 
> 标签：c#, .net, oracle, ado.net, blob

我想完成类似的事情：

```
try
{
    openConnection();
    OracleCommand cmd = new OracleCommand("SELECT CUSTOMER_ID, IMAGE_BLOB FROM CUSTOMER_IMAGE WHERE CUSTOMER_ID IN (3026)", conn);
    string pubID = "";
    OracleDataReader reader = cmd.ExecuteReader(CommandBehavior.SequentialAccess);

    //create the report object
    MemoryStream memStream;
    DataSet ds = new DataSet();
    DataTable ImageTable = new DataTable();
    BinaryReader binReader;
    DataRow dr;

    byte[] byteArrName;
    OracleLob blob;

    while (reader.Read())
    {
        pubID = reader.GetValue(0).ToString();

        // Obtain a LOB
        blob = reader.GetOracleLob(1);

        // Create a byte array of the size of the Blob obtained
        byteArrName = new byte[blob.Length];

        // Read blob data into byte array
        int i = blob.Read(byteArrName, 0, System.Convert.ToInt32(blob.Length));

        //Copied the contents of byte array to stream
        memStream = new MemoryStream(byteArrName);

        //Create a column of type byte[]
        ImageTable.Columns.Add(new DataColumn("id", typeof(string)));
        ImageTable.Columns.Add(new DataColumn("image", typeof(System.Byte[])));

        //Reading the stream which has the blob data
        binReader = new BinaryReader(memStream);
        dr = ImageTable.NewRow();

        dr["id"] = pubID;
        //ReadBytes method to add a byte array of the image stream.
        dr["image"] = binReader.ReadBytes((int)binReader.BaseStream.Length);
        ImageTable.Rows.Add(dr);

        memStream.Close();
        binReader.Close();
    }

    ds.Tables.Add(ImageTable);

    //Creating a temporary dataset which hold the image
    ds.WriteXmlSchema(@Directory.GetCurrentDirectory() + "\\temp.xsd");

    reader.Close();
    conn.Close();
} 
```

现在，我将在 Crystal Report 中填充 temp.xsd，以便动态显示图像。这只是我从头开始编写的示例代码，但为了适应我的场景，我需要获取已经存在的图像，`dtAcctSigner.Rows[0]["IMAGE_BLOB"],`所以我想知道是否有任何方法可以获取这个 BLOB，就像我在上面的代码中获取一样

```
OracleDataReader.GetOracleLob(); 
```

为此，我需要将数据表（Type-OracleLob）的一列作为参数传递给这样的函数：

```
Update(dtAcctSigner.Rows[0]["IMAGE_BLOB"]); 
```

功能如下：

```
public void Update(OracleLob a)
{ 
// I want to do take the OracleLob and make into a memorystream and put it into temp.xsd here
} 
```

但我收到一个错误：

```
cannot convert 'object' to 'OracleLob' 
```

请让我知道我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T22:05:46.507

```
using(reader)
{
      //Obtain the first row of data.
      reader.Read();
      //Obtain the LOBs (all 3 varieties).
      OracleLob BLOB = reader.GetOracleLob(1);
      ...

      //Example - Reading binary data (in chunks).
      byte[] buffer = new byte[4096];
      while((actual = BLOB.Read(buffer, 0, buffer.Length)) >0)
         Console.WriteLine(BLOB.LobType + 
            ".Read(" + buffer + ", " + buffer.Length + ") => " + actual);

      ...
} 
```

我个人会以这种方式创建列并将列添加到 DataTable，但您可以尝试这种方式或您知道可行的其他方式

```
DataTable table = new DataTable("ImageTable"); //Create a new DataTable instance.

DataColumn column0 = new DataColumn("id"); //Create the column.
column.DataType = System.Type.GetType("System.String"); //Type string 

DataColumn column1 = new DataColumn("image"); //Create the column.
column.DataType = System.Type.GetType("System.Byte[]"); //Type byte[] to store image bytes.
column.AllowDBNull = true;
column.Caption = "My Image";

table.Columns.Add(column0); //Add the column to the table.
table.Columns.Add(column1); //Add the column to the table.

Then, add a new row to this table and set the value of the MyImage column.

DataRow row = table.NewRow();
row["MyImage"] = <Image byte array>;
tables.Rows.Add(row); 
```

# jsf-2 - 弹出窗口不起作用战斧

> ID：12149619
> 
> 赞同：0
> 
> 时间：2012-08-27T21:08:05.843
> 
> 标签：jsf-2, popup, myfaces, tomahawk

我正在尝试在 t:popup 上运行示例代码。我复制的代码如下。

```
 <%@ taglib uri="http://java.sun.com/jsf/html" prefix="h"%>
    <%@ taglib uri="http://java.sun.com/jsf/core" prefix="f"%>
    <%@ taglib uri="http://myfaces.apache.org/tomahawk" prefix="t"%>

    <f:view>
    <html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <title>t:popup example</title>
    <style type="text/css">
    <!--
       .popClass{
           background-color:#F1F1F1;
       }
    -->
    </style>
    </head>
    <body>
    <h:form>
      <t:popup styleClass="popClass"
               closePopupOnExitingElement="true"
               closePopupOnExitingPopup="true"
               displayAtDistanceX="0"
               displayAtDistanceY="0">
            <h:outputText value="JSF tutorials and examples." style="font-weight:bold;"/>
            <f:facet name="popup">
               <h:panelGrid columns="1" >
                 <h:commandLink value="http://roseindia.net/jsf" />
                 <h:commandLink value="http://myfaces.apache.org" /> 
               </h:panelGrid>
            </f:facet>
      </t:popup>
     </h:form>
    </body>
    </html>
    </f:view> 
```

我正在使用 JSF 2.0 和 Tomahawk 1.1.13。我也在 Apache tomcat 7 上运行该应用程序。我不知道问题出在哪里，但只有 outputText 显示，当我在文本上执行鼠标悬停时没有任何反应。

这是我第一次使用 t:popup。如果有人遇到类似的问题，请告诉我您是如何解决的。

谢谢，简

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T14:32:20.487

从 JSF 2.0 开始，静态资源处理得到了改进。组件库的组件所依赖的 JS/CSS 文件由新`@ResourceDependency`注解自动包含。这需要一个`<h:head>`组件。

但是，您使用的是自 JSF 2.0 以来已**弃用**的 JSP，因此您将无法使用所有新的 JSF 2.0 特定功能/增强功能，包括`<h:head>`标记。

如果您用其后续的 Facelets (XHTML) 替换旧版 JSP，那么您将能够使用该`<h:head>`标记，最后`<t:popup>`将能够自动包含其 JS/CSS 文件，这些文件对于功能和视觉外观是必不可少的。

### 也可以看看：

*   [从 JSF 1.2 迁移到 JSF 2.0](https://stackoverflow.com/questions/4441713/migrating-from-jsf-1-2-to-jsf-2-0)（包含如何将 JSP 转换为 Facelets 的示例）

* * *

**与具体问题无关**，当涉及到 Java EE 相关教程/资源时，roseindia.net 是[最糟糕的站点之一。](http://balusc.blogspot.com/2008/06/what-is-it-with-roseindia.html)您似乎还混淆/混淆了 JSF 1.x 和 JSF 2.x 目标教程。在学习 JSF 2.x 时，您绝对不应该查看针对 JSF 1.x 的资源，因为这只会让您感到困惑，因为与旧的 JSF 1.x 相比，JSF 2.x 中的许多事情都不同。

### 也可以看看：

*   [我们的 JSF wiki 页面](https://stackoverflow.com/tags/jsf/info)（包含几个指向优质 JSF 2.x 教程的链接）

# asp.net-mvc-4 - 在 ASP.NET Web API REST 响应中，如何向根元素添加属性？

> ID：12149620
> 
> 赞同：0
> 
> 时间：2012-08-27T21:08:07.293
> 
> 标签：asp.net-mvc-4, asp.net-web-api, asp.net-4.0

我开发了一个 ASP.NET Web API，它的响应如下：

```
<ArrayOfMyData>
    <MyData>
         <Id>1</Id>
         <Name>x</Name>
    </MyData>
    <MyData>
         <Id>2</Id>
         <Name>y</Name>
    </MyData>
    <MyData>
         <Id>3</Id>
         <Name>z</Name>
    </MyData>
</ArrayOfMyData> 
```

我想向根元素添加一个属性，因此响应如下所示：

```
<ArrayOfMyData MyAttribute="bela bela bela">
    .
    .
    .
</ArrayOfMyData> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T03:13:17.433

您需要为此使用 XmlSerializer，因为它可以更好地控制您的输出。默认情况下，Web API 的 XmlMediaTypeFormatter 使用 DataContractSerializer，它不会生成属性。要切换到 XmlSerializer，您可以在属性上设置标志： UseXmlSerializer： [为什么 DataContractSerializer 不支持属性？](https://stackoverflow.com/questions/6074708/why-are-attributes-not-supported-with-the-datacontractserializer)

# mysql - 在 MySQL 中使用主键复制行的事务安全、复制安全方法？

> ID：12149621
> 
> 赞同：0
> 
> 时间：2012-08-27T21:08:08.923
> 
> 标签：mysql, innodb

我在 MySQL 中使用 InnoDB 表。应用程序是用 PHP 编写的，但理想情况下，这一切都可以通过查询来完成。我有几个具有典型整数 auto_increment 主键的表。有时我需要复制行，但如果没有新的主键值，我就无法做到这一点。如果我对查询中的列列表进行硬编码，这将是微不足道的，但我想避免这种情况。我编写了使用临时表的代码，因此我可以在插入之前摆脱现有的主键值，但显然这不是复制安全的（并且 MySQL 5.1 文档在使用临时表时可能导致隐式提交的查询不一致）。

我基本上想要与`INSERT IGNORE`. 我想要一个新的主键值，而不是更新现有的行。有没有一种合理的方法可以在没有硬编码列列表的情况下做到这一点？

**编辑：**我应该澄清主键不会是唯一需要修改的列。通常还有一个引用不同记录类型的 ID。总体目标是复制现有记录并将其附加到不同的父记录。我的冲动是复制记录，然后在第二个查询中进行任何其他更新。

# .net - 字符串数组和 ConvertTo-HTML

> ID：12149623
> 
> 赞同：3
> 
> 时间：2012-08-27T21:08:21.173
> 
> 标签：.net, powershell

我一辈子都无法将字符串数组的内容（它不是严格键入的，但数组中的所有项目都是字符串）变成一个表格，我正在尝试使用 ConvertTo-HTML。

例如：

```
$arr = @("One", "Two")
$arr | ConvertTo-HTML 
```

我尝试过-As List，使用片段，甚至使用InputObject，它甚至可能吗？

编辑：我只是想知道是否有使用数组作为 ConvertTo-HTML cmdlet 的输入，它所做的只是用字符串的长度属性制作一个表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T22:01:40.467

`ConvertTo-HTML`将获取 .NET 对象的集合并输出 HTML 以获得显示对象公共属性的漂亮表格。

`System.String`只有 1 个公共属性：长度。所以你会得到一个包含 1 列的表格：长度。这是设计使然，并且与正常行为一致。

但听起来您不想要集合对象的公共属性表。您需要一个带有`Length`属性的表和一个带有`ToString()`值的列。

为此，我们可以简单地创建一个属性与此目标匹配的自定义对象：

```
'one','two','three' |%{ New-Object PsObject -Prop @{Length = $_.Length; String = $_} } | ConvertTo-HTML 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T06:46:43.060

`Select-Object`这是使用cmdlet 和计算属性的另一种方法：

```
'one','two','three' | Select-Object @{Name='String';Expression={$_}},@{Name='Length';Expression={$_.Length}} 
```

# sql-server - 比较两个 SQL 日期列。如果帐户已超过一年，则将其添加到旧的计算列中，否则将其添加到计算列中是新的

> ID：12149632
> 
> 赞同：0
> 
> 时间：2012-08-27T21:09:05.817
> 
> 标签：sql-server

我正在尝试创建一个计算列来测试我的数据库中的联系人是否超过一年。

现在我创建了一个快速测试表，其中 id 为 int，DateCreated 为日期时间。我可以创建日期加上 1 年和当前日期，但我不知道如何比较这些值并返回以下字符串。

如果帐户超过 1 年，则必须显示“House Account” 如果帐户少于 1 年，则必须显示“New Account”

这是我到目前为止得到的。你到底会怎么做这种事情？

```
declare @AccountType datetime

select 
   id
  ,DateCreated
  ,DATEADD(year,1,DateCreated) as 'DatePlus1Yr'
  ,GETDATE() as 'CurrentDate'

FROM 
  Test 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:18:24.867

```
SELECT id, DateCreated,
       CASE WHEN DATEDIFF(DAY, GETDATE(), DateCreated) < 365 THEN 'New Account'
            ELSE 'House Account'
       END AS AccountType
    FROM Test; 
```

# actionscript-3 - AS3：如何开始创建游戏的教程

> ID：12149639
> 
> 赞同：0
> 
> 时间：2012-08-27T21:09:37.117
> 
> 标签：actionscript-3, flash, class, actionscript

我是一个相当新的程序员，有一些 AS2、C# 和 Java 方面的背景。我试图做的是开始在 AS3 中创建游戏，并在必要时简单地咨询谷歌，但是有一些重大的变化加上我的经验不足让事情变得困难。

基本上，我有一个成功的网格布局，您可以在其中控制网格上和边界内的影片剪辑。我还实现了一个 2D-Array 类来创建一个可以模仿棋盘并存储信息的数组，例如“位置 5,4 已经有一个角色，因此您不能将角色移动到那里。” 它只存储 0 和 1。

我迷失的是如何正确管理我在库中创建的电影剪辑，以便将它们放置在舞台上并由已经编写的代码处理。我的意思是添加一个movieclip并让一个事件处理程序更新我的2D数组以说该位置现在已被填充，这将是非常棒的。以及添加一些我可能有过的课程的 AI 动作。

所以简而言之，我想知道是否有人有一些快速提示或教程可以帮助我重新开始。

谢谢！！

麦克风

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:13:48.450

最好的方法是将 AS3 类链接到 MovieClip。本质上，您右键单击库中的影片剪辑。调出属性并选择`Export for ActionScript`。输入一个新的类名或你已经写过的类名。

然后，您所要做的就是创建它的一个新实例。要将东西添加到舞台上，只需将`addChild(myMovieClip)`它们放置好后使用。

您必须在运行时添加它们才能传递数组等参数（除非您只是从类中引用阶段）。只需确保链接的类扩展 MovieClip。

也可以看看这个网站：[AS Tutorial Basics](http://asgamer.com/2009/flash-game-design-basics-adding-library-objects-to-stage-with-as3)

希望这会有所帮助，祝你好运！我也讨厌过渡到 AS3.0。

# ios - 管理 ScrollView 中仅一个元素的滚动

> ID：12149641
> 
> 赞同：1
> 
> 时间：2012-08-27T21:09:40.237
> 
> 标签：ios, uiscrollview, scroll-paging

所以，我有一个 ScrollView，上面有卡片。ScrollView 必须启用分页。

目标是用户必须能够滚动它，即使它只有一张卡片。由于我的 ScrollView 框架的宽度和高度与卡片图片完全相同，因此我决定增加 ScrollView.contentSize 的宽度并为其添加一个点。

事实证明它工作正常，但它有点小故障 - 当我将卡拖到左边，然后再次抓住它时，它会向右移动一点（我猜，对于那个点的值）。如果我增加 contentSize，则偏移也会增加（例如，如果内容大小增加 10，则偏移值也会增加 10 个点）。这真的让我很恼火，我想摆脱它。

关于如何做到这一点的任何建议？非常感谢您的帮助。

UPD：我尝试在 scrollViewDidEndDecelerating 中手动将卡片重新居中，但这没有帮助。我现在的猜测是可以通过将内容偏移设置为正确的值来解决问题（因为现在它是（0,0）），但我不知道该怎么做。

UPD2：这是我现在使用的一些代码：

```
calendarScrollView = [[UIScrollView alloc]initWithFrame:CGRectMake(0, 0, 334, 372)]; 
//The cards themselves are 334 points wide too
calendarScrollView.clipsToBounds = NO;
calendarScrollView.pagingEnabled = YES;
calendarScrollView.bounces = YES;
calendarScrollView.showsHorizontalScrollIndicator = NO;
calendarScrollView.delegate = self;

//This part is used in the cycle of creating the cards
for (...) {

...

if (onlyOneCard) {
  calendarScrollView.contentSize = CGSizeMake(335, 372);
  onlyOneCard = 0;
} else {
  calendarScrollView.contentSize = CGSizeMake(334+offsetInScrollView, 372); //offsetInScrollView is increased by 334 by every end of the iteration of the cycle
}

...

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T22:27:40.663

您可以将滚动视图的**反弹**属性设置为 TRUE。

如果您超出滚动视图的范围，它将始终反弹。:)

# vim - 如何在没有 unicode 问题的情况下从浏览器复制并粘贴到 vim

> ID：12149642
> 
> 赞同：3
> 
> 时间：2012-08-27T21:09:42.037
> 
> 标签：vim, ascii, non-ascii-characters

这一直发生在我身上：我从富文本屏幕（通常是浏览器）复制一些内容，然后将其粘贴到 vim 中。通常它是一个代码块，然后当我去编译或运行或者你有什么时，我会得到各种集市错误。

我挠了挠头，然后花了半个小时试图找出问题所在，然后才意识到我复制了一些非 ASCII 字符：破折号、左右引号、长下划线、乘号代替 x 等。

所以我问你：我怎样才能将非 ASCII 复制到我的 VIM 会话中而不会出错？

是否有自动将 unicode 'down samples' 为 ASCII 的粘贴模式？是否对文件中的非 ASCII 字符进行快速/脏搜索？

* * *

**更新**：对于那些寻找类似解决方案的人，我没有找到通用工具。但我确实发现[这个 SO question 与相同的解决方案有关](https://stackoverflow.com/questions/334850/c-sharp-how-to-replace-microsofts-smart-quotes-with-straight-quotation-marks)。

如果您是 Vim 用户，那么您很幸运：我编写了一个通用函数并将其作为一个名为[vim-utf2ascii](https://github.com/dsummersl/vim-utf2ascii)的插件发布到 github 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-26T04:04:11.430

**Update**: For those looking for a similar solution, I didn't find a common tool. But I did find [this SO question related to the same solution](https://stackoverflow.com/questions/334850/c-sharp-how-to-replace-microsofts-smart-quotes-with-straight-quotation-marks).

If you're a Vim user, you're in luck: I've written a generic function and posted it to github as a plugin called [vim-utf2ascii](https://github.com/dsummersl/vim-utf2ascii).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T21:30:06.853

只需将 Vim 设置为使用 UTF-8：

```
set termencoding=utf-8
set encoding=utf-8 
```

还要确保您复制的是真实代码：一些著名的博客系统喜欢将直引号转换为弯引号，并对代码进行各种排版操作。为避免这种陷阱，请尽可能尝试从源代码复制或在某处寻找“原始”按钮。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T07:43:34.730

有一个名为[demoronizer](http://www.fourmilab.ch/webtools/demoroniser/)的脚本可以（除其他外）将所有这些智能引号和连字符替换为 ASCII 等效项。所以你可以通过它过滤你的文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T08:21:56.770

正如@Romaonl 所说，首先设置termencoding 并将编码设置为utf-8。

在浏览器中复制文本后，切换到 vim 并输入`"+p`

# file - file_put_contents - 警告信息

> ID：12149651
> 
> 赞同：0
> 
> 时间：2012-08-27T21:10:44.490
> 
> 标签：file, caching

我正在尝试修复损坏的网上商店。我收到以下错误消息。

> 警告：file_put_contents(/hermes/web06/XXXX/XXXXX/webstore/includes/work/configuration.cache) [function.file-put-contents]：无法打开流：/hermes/waloraweb053/XXXX 中没有这样的文件或目录/XXXXX/webstore/includes/classes/cache.php 第 52 行

configuration.cache 和 cache.php 位于路径所示的位置。

configuration.cache 没有 52 行（只有 3 行很长），但 cache.php 有。

这是我认为与此案例相关的代码。

```
/**
 * Write the data to a cache file
 *
 * @param string mixed $data The data to cache
 * @param string $key The key ID to save the cached data with
 * @access public
 */

    public function write($data, $key = null) {
      if ( empty($key) ) {
        $key = $this->_key;
      }

      return ( file_put_contents(DIR_FS_WORK . $key . '.cache', serialize($data), LOCK_EX) !== false );
    } 
```

注意：第 52 行是`return ( file_put_contents(DIR_FS_WORK . $key . '.cache', serialize($data), LOCK_EX) !== false );`行。

欢迎任何帮助或建议！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:25:43.313

我唯一注意到的是您的代码和缓存文件位于不同的树中。这是故意的吗？即，您正在尝试写入缓存：

```
/hermes/web06/ 
```

但是您的代码在：

```
/hermes/waloraweb053/ 
```

这些应该是一样的吗？也许当你认为你正在寻找是否`/hermes/web06/XXXX/XXXXX/webstore/includes/work/configuration.cache`存在时，你实际上正在寻找`/hermes/waloraweb053/XXXX/XXXXX/webstore/includes/work/configuration.cache`

# objective-c - Big Nerd Ranch 目标 C 第 17 章挑战 - 定义类

> ID：12149653
> 
> 赞同：3
> 
> 时间：2012-08-27T21:10:51.050
> 
> 标签：objective-c, compiler-errors, nsobject, fast-enumeration

我在上课时遇到问题。我必须创建作为 NSObject 子类的“StockHolding”对象。我创建实例变量和方法。然后我创建了 3 个包含名称和价格的库存迭代，并将它们加载到一个可变数组中。我很难快速枚举数组中的对象并打印每个对象的属性（价格）。问题是我在尝试枚举对象并打印属性时遇到错误。我尝试了几种不同的方法来解决这个问题，但没有运气。有任何想法吗？我还注意到 currentStock 不是打印名称，而是打印指针位置。也许这些问题是相关的。提前致谢。

'标题'

```
#import <Foundation/Foundation.h>

@interface StockHolding : NSObject
{
    float fPurchaseSharePrice; 
    float fCurrentSharePrice; 
    int iNumberOfShares;
}

@property float fPurchaseSharePrice;
@property float fCurrentSharePrice;
@property int iNumberOfShares;

-(float) fCostInDollars; //fPurchaseSharePrice * fNumberOfShares
-(float) fValueInDollars; //fCurrentSharePrice * fNumberOfShares

@end 
```

* * *

'执行'

```
#import "StockHolding.h"

@implementation StockHolding

@synthesize fCurrentSharePrice, fPurchaseSharePrice, iNumberOfShares;

-(float)fCostInDollars; //fPurchaseSharePrice * iNumberOfShares
{    
    return (fPurchaseSharePrice * iNumberOfShares);
}

-(float)fValueInDollars; //fCurrentSharePrice * iNumberOfShares
{
    return (fCurrentSharePrice * iNumberOfShares);
}

@end 
```

* * *

'主要的'

```
 int main(int argc, const char * argv[])
{

@autoreleasepool {
    StockHolding *Apple = [[StockHolding alloc] init];
    [Apple setFPurchaseSharePrice:225];
    [Apple setFCurrentSharePrice:300];
    [Apple setINumberOfShares:50];

    StockHolding *Cisco = [[StockHolding alloc] init];
    [Cisco setFPurchaseSharePrice:100];
    [Cisco setFCurrentSharePrice:50];
    [Cisco setINumberOfShares:75];

    StockHolding *WalMart = [[StockHolding alloc] init];
    [WalMart setFPurchaseSharePrice:75];
    [WalMart setFCurrentSharePrice:150];
    [WalMart setINumberOfShares:75];

    NSMutableArray *Portfolio = [NSArray arrayWithObjects: Apple, Cisco, WalMart, nil];

    for (NSObject *currentStock in Portfolio){   
        NSLog(@"Purchase Price: %@", currentStock );
        NSLog(@"Details: %f", [currentStock FPurchaseSharePrice]);  //  <---Error is on this line.  It says "No visible @interface for NSObject declares the selector fPurchaseSharePrice"
    }

}
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:18:30.647

而是为您的 for 循环执行此操作

```
for (StockHolding *currentStock in Portfolio){   
    NSLog(@"Purchase Price: %@", currentStock );
    NSLog(@"Details: %f", [currentStock fPurchaseSharePrice]);  //  <---Error is on this line.  It says "No visible @interface for NSObject declares the selector fPurchaseSharePrice"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:17:25.330

在你的 NSLog:`FPurchaseSharePrice`中应该是`fPurchaseSharePrice`.

此外，如果您覆盖 -(NSString *)description，则打印该对象将产生该字符串，而不是您当前看到的该对象的指针。

```
- (NSString *)description
{
    return [NSString stringWithFormat:@"StockHolding: %.2f, %.2f", self.fCostInDollars, self.fValueInDollars];
} 
```

产量：

```
Purchase Price: StockHolding: 11250.00, 15000.00 
```

而不是：

```
Purchase Price: <StockHolding: 0x7fe438c0a480> 
```

`NSObject`最后，您可以执行以下操作，而不是在 for 循环中强制转换为：

```
for (StockHolding *currentStock in Portfolio) 
```

并且可能无法响应的错误将消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T21:18:45.047

好吧，就像它说的那样：您没有具有该名称的方法。方法名称在 Objective-C 中区分大小写，并且您将属性（和相应的访问器）声明为`fPurchaseSharePrice`. 你想用这个：

```
NSLog(@"Details: %f", [currentStock fPurchaseSharePrice]); 
```

# biztalk - BizTalk 部署框架 5：升级到已部署的应用程序失败

> ID：12149657
> 
> 赞同：0
> 
> 时间：2012-08-27T21:11:14.173
> 
> 标签：biztalk, biztalk-2010, biztalk-deployment, btdf

阅读 BTDF 文档中的“升级已部署的应用程序”，我得到的印象是安装程序会升级已部署的应用程序。更改 ProductId 和 ProductVersion（根据需要）后，我运行了两次新安装程序，但均未成功。目标是在不取消部署/卸载应用程序的情况下升级已部署的应用程序。这甚至可能吗？文档对此并不清楚。这是我对结果采取的步骤的描述。

1.  第一次，我运行了安装程序，完成后，我运行了部署向导。部署的向导出错，建议指定一个唯一的应用程序名称（应用程序已经部署，所以我理解冲突）。

2.  第二次，我运行安装程序并完成。我没有启动部署向导，以为它会使用新的 DLL 更新 GAC，BizTalk 会检测到更新的 dll 并重置进程。也没有运气。

请有人解释一下这个过程吗？同样，目标是升级已部署的应用程序，而无需取消部署/卸载它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:51:48.033

我不得不说我只有将应用程序从 Visual Studio 部署到 Biztalk 服务器的经验，还没有使用实际安装程序的经验。但是，通过在部署之前完全停止 Biztalk 应用程序，我已经解决了大部分部署问题。不确定这是否对您有帮助，但如果您还没有，值得一试（问题中没有提及）。

此外，您正在进行什么样的更改，您如何知道在安装/部署后它们没有发生？我知道过去我必须重新启动主机实例才能在服务器上识别 Map 更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T16:46:37.687

BTDF 开发团队在 Codeplex 上回答了这个问题。

[http://biztalkdeployment.codeplex.com/discussions/393259](http://biztalkdeployment.codeplex.com/discussions/393259)

# c++ - C ++ concat const char 具有来自#define 的值

> ID：12149668
> 
> 赞同：1
> 
> 时间：2012-08-27T21:11:53.823
> 
> 标签：c++, string, char

我已经使用定义了一个值

```
#define username "admin" 
```

然后我想在 char 语句中使用用户名到 sql 作为

```
const char *pSQL[1];
pSQL[1] = "update websrv_config set admin_id='" + username + "'"; 
```

但似乎有错误

```
error: invalid operands of types ‘const char [36]’ and ‘const char [6]’ to binary ‘operator+’ 
```

我怎样才能克服它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:16:51.117

尝试这个：

```
pSQL[0] = "update websrv_config set admin_id='"  username  "'"; 
```

在 c++ 中，数组索引从 0 开始，因此当您清除长度为 1 的数组时。它可以拥有的唯一索引是 0。此外，“+”不用于 c++ 中的连接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T21:13:03.570

这是一个 C 字符串，而不是一个`std::string`（以及你在 C 中所做的，而不是 C++），但如果你**必须**这样做，你可以这样做：

```
pSQL[0] = "update websrv_config set admin_id='"  username  "'"; 
```

C 字符串不能连接，`+`因为它们是字符串文字。

`std::string`如果我是你，我会使用：

```
std::string sql = "update websrv_config set admin_id='";
sql += username;
sql += "'"; 
```

您可以使用以下`const char*`格式获取内容（如果需要）

```
sql.c_str(); 
```

另外，请注意，由于`username`它是一个宏，因此您不能在运行时更改它。

此外，如果您摆脱宏，请考虑一些提供用户名的邪恶策划者，例如：

```
"johnny'; DROP TABLE websrv_config;" 
```

# jquery - .append() 与类

> ID：12149670
> 
> 赞同：0
> 
> 时间：2012-08-27T21:11:55.697
> 
> 标签：jquery, append

我想用来`.append()`向表中添加新行。但是，`class="addRowDemo3"`并`class="removeRowDemo3"`没有附加。关于为什么的任何想法？

```
$('.addRowDemo3').click(function(){
    $('#Demo3 > tbody:last').append('<tr><td>Google</td><td>12.3</td><td>14.5</td><td>17.3</td><td>20.2</td><td><button class="addRowDemo3">Add a row</button><button class="removeRowDemo3">Remove a row</button></td></tr>');
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T21:16:53.657

应附加添加和删除具有正确类的行的按钮。但该事件不受新元素的约束。

当您使用 $('selector').click(function(){}) 时，只有当前在 DOM 中可用且由选择器匹配的元素才会绑定到事件处理程序。

对于未来的元素，请尝试使用 jQuery "on"：

尝试这个

```
$('#Demo3').on('click', '.addRowDemo3', function(){
    $('#Demo3 > tbody:last').append('<tr><td>Google</td><td>12.3</td><td>14.5</td><td>17.3</td><td>20.2</td><td><button class="addRowDemo3">Add a row</button><button class="removeRowDemo3">Remove a row</button></td></tr>');
}); 
```

这样您就可以将事件委托给“#Demo3”。每当您单击新添加或现有的“.addRowDemo3”时，事件都会冒泡到“#Demo3”并执行您的函数

见：[http ://api.jquery.com/on/](http://api.jquery.com/on/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:23:49.800

对我来说似乎工作正常，你的代码有什么不同？

[http://jsfiddle.net/CV3kp/](http://jsfiddle.net/CV3kp/)

这是一个使用 on 作为 labroo 和 daedalus 建议的版本，可能是您真正想要的

[http://jsfiddle.net/HWRhX/1/](http://jsfiddle.net/HWRhX/1/)

# jquery - 创建流体布局并需要 JQuery 在大小更改时重置

> ID：12149675
> 
> 赞同：0
> 
> 时间：2012-08-27T21:12:46.133
> 
> 标签：jquery, fade

[嗨，我目前正在通过 Div 制作淡入/淡出图像](https://stackoverflow.com/questions/12148702/fadeout-fadein-image-over-element)，在这个问题上，我从“TheHe”得到了一些很大的帮助，因为我正在构建它以在多个设备上工作，所以我需要脚本才能工作当屏幕尺寸超过 950 像素时。这在 iPad 上从水平移动到垂直时最为明显，因此我希望脚本在屏幕更改时自行重置。如果你访问[http://playing.everythingcreative.co.uk](http://playing.everythingcreative.co.uk)你会明白我的意思...谢谢

```
if( $(window).width() > 950)
    {

        $(".Content_Frame_Container")
        .each(function(){
            $(this).find('.Content_Frame_Image');
        })
        .hover( 
            function(){
                $(this).find('.Content_Frame_Image').stop(false, true).fadeOut('slow');
            }, 
            function(){
                $(this).find('.Content_Frame_Image').stop(false, true).fadeIn('slow');
            }
        );

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T23:09:37.493

您的完整解决方案是：

```
<script type="text/javascript">
"use strict";
$(document).ready(function() {
    var $containers = $(".Content_Frame_Container");
    $(window).resize(function(){
        if($(this).width() > 950)
                return;
        $containers.each(function(){
            $(this).trigger('mouseleave');
        });
    });

    $containers
     .hover(function(){
             console.log('fadeout');
             $(this).find('.Content_Frame_Image').stop(false, true).fadeOut('slow');
         }, 
         function(){
            if($(window).width() <= 950)
                return;
             console.log('fadeout');
             $(this).find('.Content_Frame_Image').stop(false, true).fadeIn('slow');
         });         
 });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:17:02.660

将您的代码封装成以下内容：

```
$(window).resize(function(){
     // your code here
}).trigger('resize'); 
```

# javascript - 未捕获的事件

> ID：12149676
> 
> 赞同：0
> 
> 时间：2012-08-27T21:12:49.483
> 
> 标签：javascript, jquery, backbone.js, backbone-events

我使用 jQuery 和 Backbone 为 Github Star 页面构建了一个 chrome 扩展。您可以在这里尝试：[https](https://chrome.google.com/webstore/detail/gpmgjficglcobhpbbkbgklfcpmhpemnb) ://chrome.google.com/webstore/detail/gpmgjficglcobhpbbkbgklfcpmhpemnb源代码在这里：[https ://github.com/gregorym/galactic](https://github.com/gregorym/galactic)

我的问题如下，在页面上我插入了一个过滤存储库的文本字段。但有时当我输入得太快时，我的事件被触发但没有被捕获......

这里是触发事件的代码： [https ://github.com/gregorym/galactic/blob/master/app/views/stars/search.js#L25](https://github.com/gregorym/galactic/blob/master/app/views/stars/search.js#L25)

这是应该捕获它们的代码： [https ://github.com/gregorym/galactic/blob/master/app/views/stars/index.js#L14](https://github.com/gregorym/galactic/blob/master/app/views/stars/index.js#L14)

知道可能导致问题的原因吗？

谢谢，格雷格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T01:14:51.663

您的侦听器`self`位于 Backbone 视图上，但您在 jQuery 元素上触发。触发器和侦听器都必须位于扩展 Backbone.Events 的同一元素上。

PS 看起来你使用的所有东西都使用了命名空间`name.space = name.space || {}`——你最好实现一个命名空间函数，例如`ns('name.space.foo')`或者`ns('app.views.Home', Backbone.View.extend({...})`

# html - 使用 css 增长列

> ID：12149677
> 
> 赞同：0
> 
> 时间：2012-08-27T21:12:56.647
> 
> 标签：html, css, layout

我正在尝试学习 CSS，并开始尝试做一些看起来应该相当基本的事情，但我似乎无法弄清楚。我会以旧方式做的事情是这样的：

```
<table width="100%">
  <tr>
    <td>content area</td>
    <td width="200">ads, links, whatever</td>
  </tr>
</table> 
```

我希望右侧的侧边栏区域设置为 X 像素宽。我想要一个内容区域来填满页面的其余部分。这似乎是整个问题的后半部分，因为将其设置为某个固定宽度将是一件轻而易举的事。

我确实设法得到了我想要的那种行为。通过在两者上使用“position：absolute”并将内容列的右边距设置为侧栏列的宽度，我能够在右侧以某个 X 宽度获得一个列，在左侧获得一个填充其余部分的列.

当我这样做时，尽管内容 div 的高度最终非常小。这是不行的，因为我希望这个 div 有一种特殊的颜色，它位于侧边栏中的内容和内容的后面。

我已经对此进行了彻底的研究，并试图在绝对定位的之后添加一个“div style='clear:both'>”，但这没有任何作用。有任何想法吗？

HTML：

```
<html>
    <head>
        <title>FIRST TRY</title>
        <link rel="stylesheet" type="text/css" href="style.css" />
    </head>
    <body>
        <div id="content">
            <div id="left">
                <p>Dolor consuetudium putamus nunc illum at. Qui vel accumsan zzril odio feugait. Iriure nobis aliquam est qui nam. Est ii ad et quod consuetudium. Eu vero tation placerat illum dolore. Suscipit saepius aliquip commodo erat me. Consequat littera autem anteposuerit ullamcorper dolor. Legunt doming dignissim facer futurum quinta. Consuetudium ad magna tempor ut suscipit. Typi aliquam ex esse quarta qui.</p>

                <br />

                <p><a href="http://css-tricks.com/examples/SuperSimpleTwoColumn.zip">Download this example.</a></p>
            </div>
            <div id="right">
                RIGHT
            </div>
            <div style="clear: both"></div>
        </div>
    </body>
</html> 
```

CSS：

```
#content {
    border: 1px solid red;
    padding: 5px;
    position: relative;
}

#left {
    border: 1px solid green;
    float: left;
    margin-right: 200px;
    position: absolute;
    top: 0;
    left: 0;
}

#right {
    border: 1px solid blue;
    float: right;
    width: 200px;
    position: absolute;
    top: 0;
    right: 0;
} 
```

结果： ![在此处输入图像描述](../Images/1d03cb70fca09679b7daa5807889af1c.png)

我特别想要的是红色框完全包含其他两个。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:21:49.063

以下示例为您提供了一个具有固定宽度的右列的流畅左列。

要更改边栏宽度：

1.  调整margin-right on`.left-col`
2.  调整宽度`.right-col`。

这是一个例子（小提琴）：http: **[//jsfiddle.net/simshaun/8szTV/](http://jsfiddle.net/simshaun/8szTV/)**

**HTML：**

```
<div class="cf">
    <div class="left-col-wrap">
        <div class="left-col"></div>
    </div>
    <div class="right-col"></div>
</div>
text text text textext text t text ttext text text textext text 
text textext text t t exttext text text text 
```

​CSS **：**

```
.left-col-wrap {
    float: left;
    width: 100%;
}
.left-col {
    margin-right: 220px;
}
.right-col {
    float: right;
    margin-left: -200px;
    width: 200px;
}

/** Micro clearix */
.cf:before, .cf:after {
    content: " ";
    display: table;
}
.cf:after { clear: both; }
.cf { *zoom: 1; }

/** Just for visual debugging purposes: **/
body {
    margin: 20px;
}
.left-col {
    background: #FF0000;
}
.right-col {
    background: #00FF00;
}
.left-col {
    height: 200px;
}
.right-col {
    height: 400px;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T21:21:30.690

这是一个经典的 2 列布局问题。基本上你想要做的是有一个像这样的简单结构：

```
<div id="wrapper">
    <div id="sidebar">sidebar content here</div>
    Other content here.
</div> 
```

然后将侧边栏放置在右侧，您将应用`float: right`到`#sidebar`. 我制作了一个[JSFiddle 示例](http://jsfiddle.net/D7UhD/1/)。边框，如果应用于`#wrapper`将围绕整个事物。

您的边框未在上面的代码中应用的原因是您已`position: absolute`在其中一个元素上声明。这有效地从 DOM 中删除了元素，因此`#content`将不再将绝对定位的元素视为其子元素，并在尝试渲染时完全忽略它。

**编辑**

使侧边栏独立于内容——也就是说，不允许内容环绕底部——是一个简单的修复。像这样更新 HTML：

```
<div id="wrapper">
    <div id="content">        Other content here.</div>
    <div id="sidebar">sidebar content here</div>
    <div class="clearfix"></div>
</div> 
```

然后将你的 CSS 修改`float: left`为`#content`并给它一个与你的侧边栏相同的宽度加上填充的边距。添加 a`margin-left`与on`#sidebar`相同。clearfix 很简单。`margin-right``#content``.clearfix { clear: both; }`

我更新了[JSFiddle 示例](http://jsfiddle.net/D7UhD/4/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T21:20:55.013

这样的事情应该有望使您走上正确的道路：

[http://jsfiddle.net/tVWxv/](http://jsfiddle.net/tVWxv/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T21:29:39.187

您想要的是，您的包装器`<div id="content">`采用其子容器的高度。这不起作用，因为您的子容器是绝对定位的。只需让它们左右浮动（绝对定位时也不起作用）并为子容器指定宽度。

# xml - 查询值与字符串的 XPath 比较

> ID：12149679
> 
> 赞同：0
> 
> 时间：2012-08-27T21:13:01.637
> 
> 标签：xml, jakarta-ee, xpath

我正在使用 XPath。我正在尝试比较存储在字符串中的值，然后编写如下查询

```
XPathExpression desc_expr = xpath.compile("/algorithms/info[name=s]/description/text()"); 
```

其中 s 包含值并且是一个字符串。我为此变得空虚。

但是，如果我像这样写查询

```
XPathExpression desc_expr = xpath.compile("/algorithms/info[name='somename']/description/text()"); 
```

然后查询工作。字符串值的形式为 abcd_abcd 。它有一个特殊字符 _。是因为特殊字符我得到一个空值吗？任何人都可以帮助解决这个问题。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:16:57.620

改变

```
xpath.compile("/algorithms/info[name=s]/description/text()") 
```

到

```
xpath.compile("/algorithms/info[name="+s+"]/description/text()") 
```

您需要使用字符串连接才能使用变量中的值。

# facebook - 从推荐框中排除路径

> ID：12149685
> 
> 赞同：1
> 
> 时间：2012-08-27T21:13:25.090
> 
> 标签：facebook, facebook-recommendations

有什么方法可以将我网站上的某些目录和/或文件排除在 Facebook 推荐框中吗？我不想阻止这些页面被点赞或推荐；我只是不希望它们出现在我网站其他地方的推荐框中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T23:27:41.377

根据[https://developers.facebook.com/docs/reference/plugins/recommendations/](https://developers.facebook.com/docs/reference/plugins/recommendations/)，跨域聚合目前不起作用。
因此，您可能会考虑将那些您希望包含在不同子域下的目录和文件包含在内，并且只调用该路径。
例如 - 所有需要包含在推荐框中的页面 - include.YOUR-SITE.com 和您希望排除的页面直接托管在 - YOUR-SITE.com 下。
当您调用 fb:recommendations 标签时，将站点指定为 - site="include.YOUR-SITE.com"

# iphone - UINavigationBar 右键选择

> ID：12149686
> 
> 赞同：0
> 
> 时间：2012-08-27T21:13:35.477
> 
> 标签：iphone, ios, uinavigationbar, uibarbuttonitem

我想知道如何阻止右栏按钮处于可选状态，直到用户履行义务。

我目前像这样设置我的右栏按钮

self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"Search" 样式：UIBarButtonItemStyleDone 目标：自我操作：@selector(submitSearch)]; [self.navigationItem.rightBarButtonItem setStyle:UIControlStateDisabled];

虽然它看起来不可选择，因为我已将 setstyle 设置为禁用它仍然是可选择的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:16:08.743

```
[self.navigationItem.rightBarButtonItem setEnabled:NO] 
```

# ios - 等待 UIButton 恢复为 UIControlStateNormal

> ID：12149687
> 
> 赞同：1
> 
> 时间：2012-08-27T21:13:35.670
> 
> 标签：ios, uiimageview, uibutton, uiimage

当用户点击我界面上的按钮时，我想使用 renderInContext 创建屏幕图像：

但是，图像是在按钮处于“按下”状态时创建的——也就是说，使用了 UIControlStateHighlighted 图像。

在我创建图像之前，是否有某种方法可以等待此按钮恢复到 UIControlStateNormal 状态？

如果没有，我能想到的唯一其他解决方案是重新创建屏幕外的视图，并对其进行成像。

PS我宁愿避免使用一些任意计时器来等待设定的时间间隔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:25:43.573

使用子类按钮创建和替换您的按钮，并在

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent*)event 
```

方法被调用。当用户将手指从按钮上移开时调用此方法。

或者使用uibutton的这个方法设置现有按钮的动作方法：

```
-(void)addTarget:(id)target action:(SEL)action forControlEvents:(UIControlEvents)controlEvents 
```

控制事件设置为 UIControlEventTouchUpInside

# android - 用户凭据对话框不会关闭，但正在等待其他服务

> ID：12149688
> 
> 赞同：0
> 
> 时间：2012-08-27T21:13:37.827
> 
> 标签：android, view, dialog, dismiss

我在用户可以输入密码和用户名的对话框中遇到问题。一旦用户输入数据并单击确定，此对话框不会关闭。

这是对话框：

```
private void askUserCredentials(String pWarning) {
        // starting the user credentials
        Log.v(tag, "askUserCredentials started ");

        // create the new dialog
        final Dialog dialogCredentials = new Dialog(this);

        //Set the content view to our xml layout
        dialogCredentials.setContentView(R.layout.dialog_login);

        // if there is a warning
        if (pWarning != null) {
            // show it instead of the regular text
            TextView dialogDescription = (TextView) dialogCredentials
                    .findViewById(R.id.dialog_cred_description);

            dialogDescription.setText(pWarning);

            // also set it to red
            //dialogDescription.setTextColor(R.color.text_headline_main);
        }

        // Set the title of the dialog. this space is always drawn even if blank
        // so might as well use it
        dialogCredentials
                .setTitle(getString(R.string.LABEL_DIALOG_CREDENTIALS));

        // get password and username
        String lUsername = SharedPrefHandler.getPrefString(
                getApplicationContext(), SharedPrefHandler.USER_NAME);
        String lPassword = SharedPrefHandler.getPrefString(
                getApplicationContext(), SharedPrefHandler.USER_PASSWORD);

        // to get the values later set the reference to the fields
        final EditText txtPassword = (EditText) dialogCredentials
                .findViewById(R.id.edit_text_password);
        final EditText txtUsername = (EditText) dialogCredentials
                .findViewById(R.id.edit_text_username);

        // preset the values
        if (lUsername != null)
            txtUsername.setText(lUsername);
        if (lPassword != null)
            txtPassword.setText(lPassword);

        // Allow the dialog to be cancelable
        dialogCredentials.setCancelable(true);

        Button okButton = (Button) dialogCredentials
                .findViewById(R.id.dialog_cred_butt_OK);
        Button canceButton = (Button) dialogCredentials
                .findViewById(R.id.dialog_cred_butt_cancel);

        okButton.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                Log.v(tag, "Got some data - username:"
                        + txtUsername.getText().toString() + "-Password: "
                        + txtPassword.getText().toString());

                //close the dialog
                dialogCredentials.dismiss();

                // store them to the users settings
                SharedPrefHandler.storeSharedPref(getApplicationContext(),
                        txtUsername.getText().toString(),
                        SharedPrefHandler.USER_NAME);
                SharedPrefHandler.storeSharedPref(getApplicationContext(),
                        txtPassword.getText().toString(),
                        SharedPrefHandler.USER_PASSWORD);

                guiStatusMessage.setText("#Bitte warten.");

                //Start the sync in case the user just entered the credentials
                startSynchronisation();

                Log.i(tag,"started synch!"); //gets called after the function was executed
            }
        });

        // close the dialog if canceled
        canceButton.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {

                dialogCredentials.dismiss();

            }
        });

        dialogCredentials.show();
    } 
```

用户输入凭据后，点击确定按钮。一切正常，但命令“startSynchronisation()”可能需要一段时间，并且对话框不会被关闭。同步正在另一个服务中运行，因此完全不清楚为什么对话框正在等待它。

```
private void startSynchronisation() {

        try {
            if (myServerServiceBound && myServerService != null)

                myServerService.IgetUserData();
        } catch (RemoteException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    } 
```

非常感谢帮助。这一定是架构问题，因为我在另一段代码中也有类似的问题。那里的选项菜单不会关闭。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T20:55:10.003

缺少的是将调用设置为异步远程进程的 ONEWAY。

我花了一段时间才找到那个....

# emacs - 隐藏emacs中的第一列

> ID：12149689
> 
> 赞同：4
> 
> 时间：2012-08-27T21:13:41.070
> 
> 标签：emacs, elisp

我正在编写一种模式来更轻松地处理我拥有的一些日志文件。前几列都是相同的元数据，我想省略它的显示。隐藏此信息的最佳方法是什么 - 遍历每一行并用“不可见的文本属性”标记每一行的该部分？

这些日志文件将只显示，而不是编辑

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:01:59.893

将此添加到您的`.emacs`：

```
(add-hook 'text-mode-hook (lambda ()
  (font-lock-add-keywords nil '(("\\[.*\\]" (0 '(face default display "meta") append))) t)
  (push 'display font-lock-extra-managed-props))) 
```

这将显示使用正则表达式匹配的元`"\\[.*\\]"`数据`meta`

```
[01/01/2012 14:00 - Message] Hello World! 
```

会暂时变成

```
meta Hello World! 
```

只需将正则表达式替换为与您的元数据匹配的正则表达式。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T01:18:03.410

我会尝试使用添加“不可见”属性的字体锁定关键字。类似于下面 100% 保证未经测试的代码：

```
(font-lock-add-keywords nil
  '(("^.............." (0 '(face nil invisible t))))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T22:38:52.880

我建议编写一个 elisp 函数，该函数读取日志的每一行并在打印之前丢弃您不想要的信息。

# ruby-on-rails - 如何第一次使用主干渲染索引视图？

> ID：12149690
> 
> 赞同：0
> 
> 时间：2012-08-27T21:13:42.123
> 
> 标签：ruby-on-rails, backbone.js

案子：

第一次显示所有项目的一页应用程序。（使用backbone.js +一些像rails这样的mvc框架）

索引操作应该呈现什么或应该如何构建（如果有一些关于该的好文章或/和现场示例，请添加它）？

**选项 1 -（问题：a. 2 个 HTTP 调用 b. 渲染速度更慢）：**

一个。索引操作呈现没有数据的索引视图

湾。调用 getData 操作发送带有数据的 json 和主干将它们插入模型等。

**选项 2 -（问题：a. 2 个 HTTP 调用）：**

一个。索引操作用数据渲染索引视图

湾。（仅用于同步骨干网）调用 getData 操作，发送带有数据的 json 和骨干网将它们插入模型等。

**选项 3：**

一个。索引操作用数据渲染索引视图

湾。主干视图更新模型等。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:23:48.707

我认为您的 3 个选项有些重叠。我的建议是 1 和 3 的组合，创建一个视图来管理您的模型、集合、数据：

1.  将您的模型/集合事件（如重置、添加、更改等）连接到 intialize 函数中的适当处理程序
2.  在初始化函数中呈现没有数据的索引
3.  获取索引数据，异步工作，传入数据将由初始化函数中的事件处理程序（参见 a）处理

优点：用户将立即看到页面，数据将自动显示，一旦从服务器到达，无需人工干预。

本文可能有助于初始化应用程序[。](http://lostechies.com/derickbailey/2012/02/06/3-stages-of-a-backbone-applications-startup/)

我建议将您的模型包装到单独的 Backbone 子视图中；但这并不是绝对需要回答您的问题，只是最佳实践:-)。可以在[此处](http://ianstormtaylor.com/rendering-views-in-backbonejs-isnt-always-simple/)找到有关此主题的一些详细信息。

# ios - 延迟 App Store 上的应用发布

> ID：12149693
> 
> 赞同：0
> 
> 时间：2012-08-27T21:13:50.550
> 
> 标签：ios, app-store

是否可以在审核后延迟发布发送到 Apple App Store 的应用程序？假设我提交了我的应用程序以供审核，但出现了一些问题，该应用程序需要在以后（未知）日期发布。我们可以审查应用程序，然后当它准备好时，它会被发布吗？（假设应用程序在审核后获得批准）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:15:40.460

是的，你可以这样做。当您发布应用程序更新时，请确保您选择“保留到开发人员发布”或任何实际措辞。审核应用程序后，您可以随时发布它。如果这是提交的第一个版本，您可以将发布日期设置为未来的某个日期。当您准备好后，您可以将日期设置为今天的任何日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:22:22.890

对于新应用程序，只需将可用日期设置为未来某个时间。我们通常尽可能在未来做。然后要发布应用程序，请将日期设置为当前日期或更早。

对于更新，如果您选择了“等待开发者发布”，请不要按发布此版本按钮

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-29T07:55:30.503

现在它很容易在`iTunesConnect`;

> --> 管理您的应用程序 --> 选择您的应用程序 --> 权利和定价（右上角） --> 更改您的应用程序可用性

# algorithm - 搜索特定的加密算法

> ID：12149696
> 
> 赞同：-1
> 
> 时间：2012-08-27T21:14:14.830
> 
> 标签：algorithm, security, encryption

# 更新！

如果是这样，新 Q 将是：

> 最强的加密算法是什么？（没有时间限制）
> 注意算法不能比输入更多的字母

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T22:19:10.657

[http://en.wikipedia.org/wiki/One-time_pad](http://en.wikipedia.org/wiki/One-time_pad)

如果您的要求是完全安全并且根本不增加消息的长度，那么可以使用一次性填充实现来做到这一点。

您的关键材料需要是：

1.  完全随机
2.  与您的消息长度相同
3.  从未泄露
4.  从未重复使用

如果您能够做到这 4 件事，那么您可以在不增加消息长度的情况下实现最大的安全性。

您实现此功能的能力取决于您的要求。在您完成上述 1-4 的时候，您并没有减少密钥交换的问题（如果确实需要）。

阅读链接的文章，它将详细解释。

# php - 带和不带逗号的 DSQL 条件

> ID：12149698
> 
> 赞同：1
> 
> 时间：2012-08-27T21:14:20.267
> 
> 标签：php, pdo, dynamic-sql, atk4

嗨，我正在使用 Agile Toolkit 编写一些 DSQL 查询，但有点困惑。给定以下 DSQL 代码：

```
$select = $select->add('Model_Rental')->dsql()
                         ->field('id')
                         ->where('dvd_id', $select->getField('id'))
                         ->where('is_returned!=', 'Y');
return "if(($select) is null,'N','Y')"; 
```

我收到以下 SQL 错误：

```
pdo_error: SQLSTATE[HY093]: Invalid parameter number: no parameters were bound
mode: select
params: Array ( )
query: select (select `name` from `movie` where `dvd`.`movie_id` = `movie`.`id` ) `movie`,`code`,if((select `id` from `rental` where `dvd_id` = `dvd`.`id` and `is_returned` != :a ) is null,'N','Y') `is_rented`,`id` from `dvd`
template: select [options] [field] [from] [table] [join] [where] [group] [having] [order] [limit] 
```

但是当我在同一个引号内定义条件时，我没有收到错误：

```
$select = $select->add('Model_Rental')->dsql()
                         ->field('id')
                         ->where('dvd_id', $select->getField('id'))
                         ->where('is_returned!="Y"');
return "if(($select) is null,'N','Y')"; 
```

这给了我预期的：

```
select (select `name` from `movie` where `dvd`.`movie_id` = `movie`.`id` ) `movie`,`code`,if((select `id` from `rental` where `dvd_id` = `dvd`.`id` and is_returned!="Y" ) is null,'N','Y') `is_rented`,`id` from `dvd` 
```

为什么我必须将状态写为：

```
->where('is_returned!="Y"'); 
```

为什么我不能像往常一样写：

```
->where('is_returned!=', 'Y'); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T02:11:43.570

**更新：** DSQL 已重构为独立库：[git.io/dsql](http://git.io/dsql)

代表 $dsql 对象的 $select 包含查询和**参数**。当您将其转换为字符串时，它不会插入参数。你需要这个

```
return ($this->expr("if([subselect] is null, 'N','Y')")->setCustom('subselect'=>$select)); 
```

另见：[http ://agiletoolkit.org/doc/dsql/expr](http://agiletoolkit.org/doc/dsql/expr)

注意：这不返回字符串，它返回 DSQL 查询。

要回答您的问题：

默认情况下 where() 将第二个参数视为参数并将其添加到参数变量中。投射到字符串时会松开它。如果您指定单个参数，则不使用任何参数，您将获得一个完整的查询。

# c# - 将 Emit IL 与内部类一起使用？

> ID：12149699
> 
> 赞同：1
> 
> 时间：2012-08-27T21:14:24.223
> 
> 标签：c#, performance, reflection, instantiation, reflection.emit

我有一个基类，它有一个嵌入式列表，所有子类都可以使用它来返回一个排序的集合。

我一直在使用`Activator.CreateInstance()`，但与简单的 new() 函数相比，这非常慢。

我找到了一种使用 Emit IL 几乎与 new() 一样快的方法，但如果我的课程不是公开的，我会收到`MethodAccessException`错误消息。这似乎很常见。

有没有解决的办法？

在此处生成类的代码： [http ://codeblocks.codeplex.com/wikipage?title=FasterActivator%20Sample](http://codeblocks.codeplex.com/wikipage?title=FasterActivator%20Sample)

此处与上述代码一起使用的代码：

```
public static List<T> SortedCollection<T>(SPListItemCollection items, ListSortType sortType, List<Vote> votes) where T : IVotable
{
    var returnlist = new List<T>();  
    var functionCreator = FastActivator.GenerateFunc<Func<SPListItem, List<Vote>, T>>();
    for (int i = 0; i < items.Count; i++) { returnlist.Add(functionCreator(items[i], votes)); }

    //Old code here
    //Type genericType = typeof(T);
    //for (int i = 0; i < items.Count; i++) { returnlist.Add((T)Activator.CreateInstance(genericType, new object[] { items[i], votes })); }

    switch (sortType)
    {
        case ListSortType.Hot:
            returnlist.Sort((p1, p2) => p2.HotScore.CompareTo(p1.HotScore));
            break;
        case ListSortType.Top:
            returnlist.Sort((p1, p2) => p2.VoteTotal.CompareTo(p1.VoteTotal));
            break;
        case ListSortType.Recent:
            returnlist.Sort((p1, p2) => p2.CreatedDate.CompareTo(p1.CreatedDate));
            break;
        }
        return returnlist;
    }

    //Usage
    //Post : BaseClass which has above method
    return Post.SortedCollection<Post>(listItems,sortType,votes); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T21:27:44.207

您可以使用[DynamicMethod Constructor (String, Type, Type[], Type)](http://msdn.microsoft.com/en-us/library/z84bd3st.aspx)方法来生成与您想要访问的成员的类关联的方法。

生成的方法将完全访问您与之关联的类型中的*所有成员，以及该类在其模块中可以访问的所有内部方法和成员。*

# asp.net - 检查客户PC上是否存在目录

> ID：12149700
> 
> 赞同：0
> 
> 时间：2012-08-27T21:14:40.777
> 
> 标签：asp.net, vb.net, webserver, client

在 WinForms VB.NET 中，您可以检查目录是否存在，就像这样，`If My.Computer.FileSystem.DirectoryExists()`但我将如何在 ASP.NET 中执行此操作。我已经按照上面的方法进行了尝试，但它检查的是“服务器”，而不是从他/她的工作场所/家中查看网站的最终用户。我将如何获取客户端存在的文件夹？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:15:55.797

你不能这样做。从网页访问本地文件是不可能的，并且有充分的理由 - 这将是一个重大的安全风险。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T06:08:35.120

微型技术是正确的。

请记住，您可以使用[caspol](http://msdn.microsoft.com/en-us/library/cb6t8dtz%28v=vs.80%29.aspx)、Silverlight 或在 IE 中运行的 ActiveX 来实现。

如果您真的需要知道 ASP.Net 中是否存在目录，则需要一种解决方法。例如，客户端可以下载一个文件（exe、bat、vbs 等）并执行它以调用 Web 服务来告诉您。不太理想。

我猜是一键式 .Net 4 安装程序，然后您可以假设每个人都拥有它。

# playframework-2.0 - Play Framework：如何在 /app 之外配置可编译的 [LESS] 资产

> ID：12149704
> 
> 赞同：0
> 
> 时间：2012-08-27T21:14:54.650
> 
> 标签：playframework-2.0, sbt

我有一个使用引导程序的 play 2.0.2 (scala) 项目。我已将 bootstrap 添加为 git 子模块，以便我可以轻松更改其版本，而无需复制各个文件。

我的项目结构如下：

```
project
  |_ bootstrap
  |    \_ img
  |    \_ js
  |    \_ less
  |         \_ bootstrap.less
  |         \_ responsive.less
  |_ app
       \_ assets
            \_ css
                \_ my.less 
```

我的 Build.scala 有：

```
def customLessEntryPoints(base: File): PathFinder = (
    (base / "app" / "assets" / "css" * "*.less") +++
    (base / "bootstrap" / "less" / "bootstrap.less") +++
    (base / "bootstrap" / "less" / "responsive.less")
)

def externalAssets(base: File): PathFinder = (base / "bootstrap")
val main = PlayProject(appName, appVersion, appDependencies, mainLang = SCALA).settings(
  playAssetsDirectories <+= baseDirectory / "bootstrap",
  playExternalAssets <+= baseDirectory.apply(file => (file, externalAssets(_), "bootstrap")),
  lessEntryPoints <<= baseDirectory(customLessEntryPoints)
  // other settings
) 
```

当我在执行“~ run”后访问 Web 应用程序时，（或者如果我运行 play-copy-assets）我得到：

```
[error] {file:/<path_to_project>/}<project>/*:play-copy-assets: No mapping for <path_to_project>\bootstrap\less\bootstrap.less
[error] application -

! Internal server error, for request [GET /] ->

play.api.UnexpectedException: Unexpected exception [RuntimeException: No mapping for <path_to_project>\bootstrap\less\bootstrap.less]
    at sbt.PlayReloader$$anon$2$$anonfun$reload$3$$anonfun$4$$anonfun$apply$12.apply(PlayReloader.scala:233) ~[na:na]
    at sbt.PlayReloader$$anon$2$$anonfun$reload$3$$anonfun$4$$anonfun$apply$12.apply(PlayReloader.scala:226) ~[na:na]
    at scala.Option.map(Option.scala:133) ~[scala-library.jar:0.11.3]
    at sbt.PlayReloader$$anon$2$$anonfun$reload$3$$anonfun$4.apply(PlayReloader.scala:226) ~[na:na]
    at sbt.PlayReloader$$anon$2$$anonfun$reload$3$$anonfun$4.apply(PlayReloader.scala:224) ~[na:na]
    at scala.Either$LeftProjection.map(Either.scala:183) ~[scala-library.jar:0.11.3]
java.lang.RuntimeException: No mapping for <path_to_project>\bootstrap\less\bootstrap.less
    at scala.sys.package$.error(package.scala:27) ~[scala-library.jar:na]
    at scala.Predef$.error(Predef.scala:66) ~[scala-library.jar:0.11.3]
    at sbt.Mapper$$anonfun$fail$1.apply(PathMapper.scala:26) ~[na:na]
    at sbt.Mapper$$anonfun$fail$1.apply(PathMapper.scala:26) ~[na:na]
    at sbt.Alternatives$$anon$1$$anonfun$$bar$1$$anonfun$apply$3.apply(PathMapper.scala:61) ~[na:na]
    at sbt.Alternatives$$anon$1$$anonfun$$bar$1$$anonfun$apply$3.apply(PathMapper.scala:61) ~[na:na] 
```

我希望将 bootstrap 的 img 和 js 子文件夹用作资产（与公共静态文件一起或在不同的路径中），并将 bootstrap|responsive.less 文件编译成 css 并提供。

自定义入口点工作正常。也就是说，如果我更改它们，使它们都在 /app 下并将较少的文件从引导程序移到那里，它们就可以工作。如果我在公共下移动图像和 js 文件，那也可以。但我想要实现的是干净的分离。

我很确定我没有正确理解如何使用 playAssetsDirectories 和 playExternalAssets，我已经为这些设置尝试了许多变体。我不确定我正在尝试的内容是否可行或设置应该如何关联 - 例如，lessEntryPoint 是否必须位于资产目录中，并且 externalAssets 是否被视为资产目录？谁能指出我哪里出错了？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T05:45:18.033

如果您正在尝试干净分离，最好禁用内部编译器，并使用像 Crunch 这样的外部工具。

如果您不这样做，您可能希望限制 Play 使用单个文件 (my.less)，然后从其中包含所有其他文件。您不能使用公共目录中的内部编译器编译 LESS 文件——它们只是静态资产。如果您希望 Play 能够访问它们，它们应该位于 app/stylesheets 下。

另请注意，LESS 1.3 在尝试编译子目录中的文件时存在一些重大问题——这已经在 play-framework 邮件列表中吸引了多个人，尤其是 Bootstrap 会因错误而崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T10:58:53.033

我已将 Bootstrap LESS 应用到我的项目中，如下所示：

在资产目录中有引导程序“导入”文件。Play 将编译它们。

```
app\assets\bootstrap.less
app\assets\responsive.less 
```

在例如有其他“.less”文件`app\less`

编辑路径指向`app\less`目录的 bootstrap.less 文件

```
@import "../less/reset.less"; 
```

物理上编译的 CSS 去

```
\target\scala-2.9.1\resource_managed\main\public 
```

但是您仍然可以像在公共场合一样提及它们

```
<link rel="stylesheet" media="screen" href="@routes.Assets.at("bootstrap.css")"> 
```

# django-admin - 如何连接到在子目录上运行的 django 1.4 应用程序的静态管理文件

> ID：12149709
> 
> 赞同：1
> 
> 时间：2012-08-27T21:15:24.037
> 
> 标签：django-admin, ubuntu-12.04, django-staticfiles, django-1.4, django-wsgi

我正在使用 django-wsgi 在 apache2 上运行 django。

我一直在寻找解决这个问题的问题，但我发现要么解决方案适用于早期版本的 Django，要么不适合我的特定问题（如果我在这方面错了，请对我温柔）。

我的问题是，当我从域根目录运行 django 时，管理员 css 工作正常，但是当我从子目录（例如[http://www.mysite.com/djangoapp/](http://www.mysite.com/djangoapp/)）运行它时，登录 django 没有问题管理员，但缺少所有样式。

我尝试将 settings.py 中的 URL_prefix 更改为 URL_PREFIX = "/django_app"。

我还尝试在我的 apache2 配置 (/etc/apache2/sites-available/mysite) 中的 Alias 中添加 Alias /djangoapp/static /path/to/static，这在 django 1.3 中对我有用，但在 1.4 中不起作用

# html - 精灵不工作 - 背景位置 = 50%

> ID：12149710
> 
> 赞同：0
> 
> 时间：2012-08-27T21:15:29.057
> 
> 标签：html, css, css-sprites

在使用我的精灵时，我忽略了一些明显的东西。我在[JSFiddle](http://jsfiddle.net/photo_tom/HJUg6/1/)有一个例子。它没有在跨度中显示精灵，当我在 Chrome 中查看元素时，它报告的实际背景位置为 0px，50%。css 为 0px，-31px。

建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:18:16.433

`SPANS`不是块元素，并且不能采用宽度或高度 CSS 属性。为此元素使用`DIV`或添加到您的定义中。`display:block`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T21:24:00.720

您必须将 SPAN 显示为块并丢失背景位置设置之间的逗号，因为应该只有一个空格：

[http://jsfiddle.net/HJUg6/2/](http://jsfiddle.net/HJUg6/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T21:20:40.017

`display:block`在 div 上使用它可以工作。（我不知道这是否是您应该看到的图像..）

# java - 显示 JList

> ID：12149723
> 
> 赞同：2
> 
> 时间：2012-08-27T21:16:21.927
> 
> 标签：java, swing

我再次在显示来自 mysql 数据库的数据时遇到 JList 问题，我使用了下面给出的代码，但它没有在屏幕上显示任何内容..

```
JFrame f8 = new JFrame("Schedule");
f8.setVisible(true);
f8.setSize(1000, 1000);
JPanel jpa1 = new JPanel(new GridBagLayout());

String query = "SELECT * FROM Location";
DefaultListModel model = new DefaultListModel();
DefaultListModel model1 = new DefaultListModel();
try {
    Class.forName("oracle.jdbc.driver.OracleDriver");
    Statement stmt = null;
    ResultSet rs;
    Connection conn = DriverManager.getConnection("jdbc:mysql://127.0.0.1/SPL", "root", "PWD");
    stmt = (Statement) conn.createStatement();
    rs = stmt.executeQuery(query);
    while (rs.next()) {
        String stadium = rs.getString("Stadium");
        String city = rs.getString("City");
        model.addElement(stadium);
        model1.addElement(city);
    }
    JList list = new JList(model);
    JList list1 = new JList(model1);
    f8.add(jpa1);
    jpa1.add(list);
    list.setSelectionMode(ListSelectionModel.SINGLE_INTERVAL_SELECTION);
    list.setLayoutOrientation(JList.HORIZONTAL_WRAP);
    list.setVisibleRowCount(1);
    JScrollPane listScroller = new JScrollPane(list);
} catch (SQLException e) {
    System.out.println("Message   : " + e.getMessage());
} 
```

你能告诉我我哪里错了吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-27T21:21:36.353

根据代码片段很难说是什么问题，更不用说有点难以阅读的无格式代码，但是……

*   您将一个列表添加到 JPanel，然后将相同的列表添加到 JScrollPane 并忽略 JScrollPane。
*   您正在使用没有任何 GridBagConstraints 的 GridBagLayout
*   您在 Swing 事件线程上执行了大量 JDBC 代码，这可能会锁定该线程。
*   您创建了一个 JList，list1，但不要将它添加到任何内容中。

你应该考虑：

*   在 GUI 之外测试您的数据库代码。划分问题以解决它，否则您将有太多变量会影响您的结果，从而很难知道是什么导致了什么。
*   在代码中放置调试语句或使用调试器首先找出错误所在。
*   在请求志愿者帮助时只发布格式正确的代码。理解别人的代码已经够难了，你应该努力不让它变得更难。我们非常感谢您的努力！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-27T21:33:58.320

充满鳗鱼的气垫船几乎一针见血，但我原谅他，因为直到我开始把你的代码的整个部分都拿出来我没有看到它。

代码的最后一行是

```
JScrollPane listScroller = new JScrollPane(list); 
```

您永远不会将此滚动窗格添加到您的 UI。它的效果是`list`从它的前一个父级 ( `jpa1`) 中删除 并添加到滚动窗格中，这样就不会在屏幕上显示任何内容。

我会遵循所有充满鳗鱼的气垫船的建议，然后弄清楚如何解决最后一个问题......

```
jpa1.add(new JScrollPane(list)); 
```

应该做

# oauth - SAML 断言错误

> ID：12149737
> 
> 赞同：0
> 
> 时间：2012-08-27T21:17:15.750
> 
> 标签：oauth, cloud, identity, saml

我正在尝试使用的云服务要求这样做：

```
Enter Attribute containing Login Name . This attribute is used for authentication of
end-user. This is the attribute name that maps to the LDAP email address. From the XML 
meta-data, find: <NameID>user@example.com<NameID>. NameID is what is to be copied into 
this field. In some cases, this attribute may also be found at <Attribute 
Name"https://schema/xml.soap.org/.....identity/claims/name"> 
<AttributeValue>user@example.com<AttributeValue>.  In these cases, name is the attribute 
value. 
```

我使用 SimpleSAMLPHP 作为我的 IDP。我到底需要在这里输入什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T19:33:36.930

如果您想在 NameID 字段中设置您的用户 ID，您可以查看 IdP 配置：

*   [http://simplesamlphp.org/docs/1.10/simplesamlphp-reference-idp-hosted#section_2](http://simplesamlphp.org/docs/1.10/simplesamlphp-reference-idp-hosted#section_2)

特别是`attributes.NameFormat`which 告诉使用哪种名称标识符。

将它与 一起使用`userid.attribute`以在 NameID 字段中设置特定的属性值。

否则，如前所述，如果 userid 在其中一个属性中，则需要知道该属性的名称，该名称可能继承自认证源，例如 LDAP。

# bash - 将 sed 反向引用与 bash 变量混合

> ID：12149740
> 
> 赞同：1
> 
> 时间：2012-08-27T21:17:22.950
> 
> 标签：bash, sed, escaping

我正在运行旧版本的 git，并且正在编写一个更新主机名配置的脚本。

我的问题是我无法找出正确的转义字符组合，因此变量不会与我的正则表达式中使用的反向引用混合。

这是我最大的努力

```
#!/bin/bash
#code
foo=`ec2-describe-instances i-f95e4b82 | grep amazon | awk '{print $4}'`
sed -i "s/\(ec2-user@\)\(.*\)\(:repo\.git\)/\\1 $foo \\3/" /var/www/.git/config 
```

这在第一个反向引用和变量 foo 之间放置了一个空格。希望在第一个反向引用和 $foo 之间没有那个空间。我怀疑我可以使用文字而不是反向引用，但用户名和存储库可能会改变。

有任何想法吗？

**编辑**

```
"s/\(ec2-user@\)\(.*\)\(:repo\.git\)/\\1$foo\\3/" 
```

不会产生正确的答案，因为 foo 与 1 合并，产生错误的反向引用。我不知道如何逃脱 $foo。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T02:38:12.043

您需要隔离`$foo`变量，这样您就不需要在其周围使用空格来将其名称与周围的其他字符区分开来。尝试

```
sed -i "s/\(ec2-user@\)\(.*\)\(:repo\.git\)/\\1${foo}\\3/" /var/www/.git/config 
```

如果您只想要 foo 之后的空格，请使用

```
sed -i "s/\(ec2-user@\)\(.*\)\(:repo\.git\)/\\1${foo} \\3/" /var/www/.git/config 
```

IHTH

# c++ - 我应该使用什么 API 来编写网络使用程序？

> ID：12149742
> 
> 赞同：0
> 
> 时间：2012-08-27T21:17:25.907
> 
> 标签：c++, windows, api, network-programming

我发现我的计算机正在使用大量网络带宽，我想弄清楚哪个程序实际上在后台执行此操作。

我做了一些研究，我找不到任何能够记录每个程序的网络使用情况的免费软件；所以我想自己写一个简单的。

我想用 C++ 编写它，但我不知道我可以使用哪个 API。

你能提出任何建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:24:19.003

不要重新发明轮子，使用[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)、[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)、[Wireshark](http://www.wireshark.org/)和/或[netstat](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/netstat.mspx?mfr=true)。

# git - 从 git 历史记录中删除文件不起作用

> ID：12149744
> 
> 赞同：7
> 
> 时间：2012-08-27T21:17:33.533
> 
> 标签：git, github

我正在尝试使用[此 GitHub 过程](https://help.github.com/articles/remove-sensitive-data)删除包含敏感数据的文件。

但是，这不适用于我的特定回购。当我运行时：

```
git filter-branch --index-filter 'git rm --cached --ignore-unmatch some_file.json' \
  --prune-empty --tag-name-filter cat -- --all 
```

它完成了：

```
Rewrite 73f9cce9ab282cec272022314f361c1cd48955a7 (418/418)  
WARNING: Ref 'refs/heads/master' is unchanged     
WARNING: Ref 'refs/remotes/origin/blah' is unchanged    
WARNING: Ref 'refs/remotes/origin/blah2' is unchanged     
WARNING: Ref 'refs/remotes/origin/blah3' is unchanged     
WARNING: Ref 'refs/remotes/origin/blah4' is unchanged     
WARNING: Ref 'refs/remotes/origin/master' is unchanged 
```

但一切都没有改变。当我做

```
git push origin master --force 
```

它说

> 一切都是最新的

有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T21:38:45.013

根据评论中的讨论，使用文件的完整路径。该命令的当前版本正在`some_file.json`顶级 repo 目录中删除。

# android - getDrawingCache() 总是返回 null

> ID：12149746
> 
> 赞同：1
> 
> 时间：2012-08-27T21:17:36.850
> 
> 标签：android, nullpointerexception, android-view, android-notifications

我知道这个问题经常被问到，但这似乎有所不同。我尝试了 StackOverflow 的 6 种解决方案，但没有成功。我正试图`Notification.BigPictureStyle`在他们离开应用程序时将某人制作的绘图放入其中。

```
 public void surfaceCreated(SurfaceHolder holder) {
        // TODO Auto-generated method stub
        _thread.setRunning(true);
        _thread.start();            
        setDrawingCacheEnabled(true);
    }

    public void surfaceDestroyed(SurfaceHolder holder) {
        // TODO Auto-generated method stub
        _thread.setRunning(false);

        measure(MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED),
                MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED));
        layout(0, 0, getMeasuredWidth(), getMeasuredHeight());

        buildDrawingCache(false);
        Bitmap currentState = Bitmap.createBitmap(getDrawingCache());
        setDrawingCacheEnabled(false);

        NotificationManager manager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);

        Intent notificationIntent = new Intent(DrawActivity.this, DrawActivity.class);
        PendingIntent contentIntent = PendingIntent.getActivity(DrawActivity.this, 0, notificationIntent, Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP);

        Notification noti = new Notification.BigPictureStyle(
                new Notification.Builder(DrawActivity.this)
                    .setContentTitle("Your drawing")
                    .setContentText("Unfold to see drawing")
                    .setWhen(System.currentTimeMillis())
                    .setSmallIcon(R.drawable.ic_launcher)
                    .setContentIntent(contentIntent))
        .setSummaryText("Here you can see how you left your drawing.")
        .bigPicture(currentState)
        .build();

        manager.notify(1023, noti);

    }
} 
```

但我总是`NullPointerException`在这一行得到一个：

```
Bitmap currentState = Bitmap.createBitmap(getDrawingCache()); 
```

此代码来自 StackOverflow，启用了所有这些缓存。有人能看出有什么问题吗？

顺便说一句，我当然使用的是 Android 4.1.1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T22:01:12.317

类似的问题[在这里](https://stackoverflow.com/questions/5278707/videoview-getdrawingcache-is-returning-black)更多信息[在这里](https://groups.google.com/forum/?fromgroups=#!topic/android-platform/xHIActZZ9PA)......

问题似乎是您无法访问surfaceview的内容-显然您可以捕获ImageView的内容...我假设您使用surfaceView并因此遇到相同的问题...如果您愿意进一步挖掘，[这](http://www.droidnova.com/how-to-create-and-save-a-screenshot-from-a-surfaceview,880.html)可能帮助（来自上述线程/主题之一）

如果您不使用表面视图，那么 setLayerType 可能是您的答案......

# php - 你能帮我制定一个 SQL 查询来连接 3 个表吗？

> ID：12149755
> 
> 赞同：-4
> 
> 时间：2012-08-27T21:18:36.077
> 
> 标签：php, mysql

我不知道如何做到这一点，所以我在这里问它......

我的数据库中有 3 个表，其结构如下..

表：联系人 ----- 行：contact_id，名字

表：组-----行：组ID，组名

表：groupmembership ------ 行：contact_id，group_id

表“group_membership”中“contact_id”和“group_id”之间的关联反映了特定组中的联系人。

我需要做的是获取一个contact_id，并在下拉列表中显示他是哪些组的成员。我最终将使用此下拉列表将 group_id 发布到显示组信息的页面。

谁能帮助我如何制定 MySQL 查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:20:12.330

如果要按 user_id 选择：

```
SELECT group_name, group_id
FROM groupmembership gm
INNER JOIN groups g ON g.group_id = gm.group_id
WHERE gm.contact_id = 4711 
```

如果要按用户的名字选择：

```
SELECT group_name, group_id
FROM groupmembership gm
INNER JOIN groups g ON g.group_id = gm.group_id
INNER JOIN contact c ON c.contact_id = gm.contact_id
WHERE c.firstname LIKE 'TheHe'; 
```

# c# - 正则表达式没有捕获多个匹配项

> ID：12149759
> 
> 赞同：1
> 
> 时间：2012-08-27T21:18:47.447
> 
> 标签：c#, regex

假设我有以下用于 C# 控制台应用程序的代码。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;

namespace stupidconsoleapp
{
    class Program
    {
        static void Main(string[] args)
        {
            Regex regx = new Regex(@"^(?:https?://)?(?:[\w]+\.)(?:\.?[\w]{2,})+$");

            string test = Console.ReadLine();

            foreach (Match match in regx.Matches(test))
                Console.WriteLine("Match: " + match.Value);

            Console.WriteLine("Press any key to exit.");

            Console.ReadKey();
        }
    }
} 
```

我给它“http://www.cnn.com”，它告诉我这个短语匹配；我再次运行它并给它“www.cnn.com”，我又得到了一个匹配；我再次运行它并给它“cnn.com”并获得第三次成功的比赛。

但是，如果我只输入“http://www.cnn.com www.cnn.com cnn.com”，我就找不到匹配项。

为什么是这样？我的正则表达式错了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T21:21:35.553

您的正则表达式以 - 开头`^`和结尾`$`- 这表明它应该只匹配整个字符串。`^`匹配行（或字符串）的开头并匹配`$`结尾 - 如果在第一个有效 URL 之后的字符串末尾有更多文本，它将不匹配。

如果您想要字符串的所有匹配部分，请删除`^`和`$`.

# ruby - 使用 html 标签区分文本

> ID：12149765
> 
> 赞同：0
> 
> 时间：2012-08-27T21:19:21.270
> 
> 标签：ruby, rubygems, diff

我一直想找到或编写一个新的 diffing gem，它不仅可以突出显示文本的变化，还可以突出 HTML 结构的变化。这是我的意思的一个快速示例。

现在，大多数不同的 gems 或 algos 将采用以下内容：

```
a = "<p>I am some text</p>"
b = "<p>I was some text</p>"
MyDiffer.diff(a,b)
=> "<p>I <del>am</del><ins>was</ins> some text</p>" 
```

然而，当 HTML 标签被抛出时，它们中的大多数都没有正确考虑。我想看到这样的东西：

```
a = "<p>I am <strong>some</strong> text</p>"
b = "<p>I was some text</p>"
MyDiffer.diff(a,b)
=> "<p>I <del>am</del><ins>was</ins> <del class='htmlchange'><strong>some</strong></del><ins class="htmlchange">some</ins></p>"
a = "<p>I am a sentence.  I am another sentence.</p>"
b = "<p>I am a sentence.</p><p>I am another sentence.</p>"
MyDiffer.diff(a,b)
=> "<p>I am a sentence.<del class="htmlchange">I am another sentence</del></p><ins class="htmlchange"><p>I am another sentence</p></ins>" 
```

外面有这样的东西吗？如果不是，我不完全确定如何按照这些思路进行构建。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:48:41.977

对于 HTML，您需要使用解析器，例如 Nokogiri，它会为您进行一些清理和规范化。然后，您需要重新格式化文档的标签，以便参数的顺序一致。我建议使用参数名称进行简单的字母排序。

在输出重组结果时， Nokogiri 的`to_html`方法将很有用。

您还需要决定是否在文本节点中保留或删除空格，以及是否支持参数和标记名大小写。

您可以尝试在不依赖解析器的情况下执行此操作，但我认为您会发疯。HTML 过于非结构化和不规则，只能做一个简单的 diff。

# javascript - 在jquery中单击时更改类名的名称

> ID：12149766
> 
> 赞同：2
> 
> 时间：2012-08-27T21:19:25.030
> 
> 标签：javascript, jquery

我有一个类名的 div：.sel-display-on。单击时，我想使用 jquery 将其更改为 .sel-display-off。这可能吗？这个新类名的css属性会被应用吗？

```
$('.sel-display-on').click(function (e) {
        e.stopPropagation();
        // change class name to .sel-display-off
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T21:20:56.620

```
$(this).removeClass('sel-display-on').addClass('sel-display-off'); 
```

或者，如果您确定此元素不会有任何其他类名（不是很好的做法，但可能更快）：

```
$(this).attr('class', 'sel-display-off'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T21:21:04.013

```
$(this).addClass('...'); 
```

或者

```
$(this).attr('class','...'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T21:21:44.840

你可以这样做：

```
$('.sel-display-on').click(function (e) {
    e.stopPropagation();
    // change class name to .sel-display-off
    $(this).removeClass('sel-display-on').addClass('sel-display-off');
}); 
```

您也可以使用 toggleClass 来做到这一点：

```
$('.sel-display-on').click(function (e) {
    e.stopPropagation();
    // change class name to .sel-display-off
    $(this).toggleClass(function(){
       if($(this).is('.sel-display-on'){ 
          return "sel-display-off";
       } else {
          return "sel-display-on";
       }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T21:21:53.077

您所有问题的答案都是“是”

您可以根据需要使用`addClass`、`removeClass`、`toggleClass`和`attr('class', ...)`。

如果这`e.stopPropagation`是在 a 上，则上述内容不是必需的`div`，除非您要停止绑定到它的其他一些功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-27T21:23:02.687

[http://api.jquery.com/addClass/](http://api.jquery.com/addClass/)

[http://api.jquery.com/removeClass/](http://api.jquery.com/removeClass/)

是的，使用上面的两个函数来实现这一点。此外，新课程将立即应用。

另一个注意事项：删除类 .sel-display-on 后，您将无法再使用 .sel-display-on 选择该元素。

# silverlight - Silverlight RIA 服务数据

> ID：12149767
> 
> 赞同：0
> 
> 时间：2012-08-27T21:19:34.593
> 
> 标签：silverlight, wcf-ria-services, data-access

几天来，我一直试图弄清楚如何从我的 Silverlight 应用程序访问数据。

我想使用已经编写好的数据类和业务类。

根据另一篇文章的一些建议，我创建了一个 Silverlight 业务应用程序。访问数据的代码位于我的 Web 应用程序的域服务类中。这是从 Silveright 应用程序调用的。

我想我很接近，但我的语法不太正确。

这是我的域服务类中的代码

```
Public Function GetGridData() As IEnumerable(Of Submissions)

Dim dtResults As DataTable

Dim _ConnectionString As String
= _

"Password=xxxx;Persist Security Info=True;User ID=xxxx;Initial Catalog=APCD;Data Source=xxxx"

mdsResults = s.GetSubmissions(3, 0, _ConnectionString,"2011", "0", False)

dtResults = mdsResults.Tables(0)

Dim MySubmissions = New List(Of Submissions
)()

For Each row As DataRow In
dtResults.Rows

Dim MySubmission = New Submissions() With
{ _
.SubmissionControlId = Convert.ToString(row("SubmissionControlId"
)), _
.OrgId = Convert.ToString(row("Org Id"
)), _
.DateProcessed = Convert.ToString(row("DateProcessed")) _

}

MySubmissions.Add(MySubmission)

Next

Return MySubmissions

End Function

The code in the silverlght page is

 Dim x As New Web.CustomerDomainContext

    grdSubmissions.DataContext = x.GetGridData() 
```

它全部编译并运行，但网格为空。我通过逐步了解存储过程确实包含数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T00:25:01.360

There are several points I'd like to comment on.

Firstly, it is better not to return from a function like above. This is because you lose the benefit of being able to edit and update data. You should return IQueryable instead. Generate some code using EF to have a feel for it.

Secondly, instead of setting DataContext, the ItemsSource on the DataGrid instead.

```
Dim gridData = x.GetGridData()
grdSubmissions.ItemsSource= gridData 
```

Thirdly, you should also step through Silverlight code and make sure gridData contains values. From first observation, it doesn't look correct because Silverlight is asynchronous. The code to fetch data from grid should look like:

```
Dim domainContext = new MyDomainContext()
AddHandler domainContext.Completed, 
  Sub (op)
    grdSubmissions.ItemsSource = domainContext.Submissions
  End Sub 
domainContext.Load(domainContext.GetSubmissionQuery()) 
```

You are best working through this example: [http://blogs.msdn.com/b/kylemc/archive/2011/04/29/mvvm-pattern-for-ria-services.aspx](http://blogs.msdn.com/b/kylemc/archive/2011/04/29/mvvm-pattern-for-ria-services.aspx) as the original Ria Services code is the bare minimum, and needs more convenience methods.

**Update 1 - DomainService**

```
namespace SampleDataClass.Web.Services
{
    using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.ComponentModel.DataAnnotations;
    using System.Linq;
    using System.ServiceModel.DomainServices.Hosting;
    using System.ServiceModel.DomainServices.Server;

    public class Customer
    {
        [Key]
        public int CustomerId { get; set; }

        public string Name { get; set; }

        public string Address { get; set; }
    }

    // TODO: Create methods containing your application logic.
    [EnableClientAccess()]
    public class DomainService1 : DomainService
    {

        [Query]
        public IQueryable<Customer> GetCustomers()
        {
            return (new Customer[]
            {
                new Customer() { CustomerId=1, Name="Luigina Davide", Address="Via Giulio Petroni, 82 24050-Palosco BG" },
            }).AsQueryable<Customer>();
        }
    }

} 
```

# android - android小部件中的倒数计时器

> ID：12149776
> 
> 赞同：0
> 
> 时间：2012-08-27T21:20:41.863
> 
> 标签：android

如何在 android 中执行倒数计时器并将此计时器插入到 android 小部件中？我想做的计时器是这样的：[http ://www.timeanddate.com/clocks/freecountdown.html](http://www.timeanddate.com/clocks/freecountdown.html)

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T21:31:02.617

考虑在您喜欢的任何布局中使用 Android [CountDownTimer](http://developer.android.com/reference/android/os/CountDownTimer.html)。

```
public class Example extends Activity {
    long mMilliseconds = 60000;
    SimpleDateFormat mSimpleDateFormat = new SimpleDateFormat("HH:mm:ss");
    TextView mTextView;

    CountDownTimer mCountDownTimer = new CountDownTimer(mMilliseconds, 1000) {
        @Override
        public void onFinish() {
            mTextView.setText(mSimpleDateFormat.format(0));
        }

        public void onTick(long millisUntilFinished) {
            mTextView.setText(mSimpleDateFormat.format(millisUntilFinished));
        }
    };

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        mSimpleDateFormat.setTimeZone(TimeZone.getTimeZone("UTC"));
        mTextView = (TextView) findViewById(R.id.text);

        mCountDownTimer.start();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T21:49:29.097

另一种选择是让您在小部件外部运行倒数计时器，并发送广播，这些广播将在通过广播接收器后由小部件接收和处理。因此，您可能会考虑将 CountdownTimer 放在服务或应用程序的其他部分中，并在每个滴答声或最后发出一个广播，Widget 将通过广播接收器获得该广播。这使 Widget 保持轻量级。

# php - 将表单数据存储为临时会话

> ID：12149785
> 
> 赞同：1
> 
> 时间：2012-08-27T21:21:26.557
> 
> 标签：php, session

我已经查看了[将表单数据存储为会话变量](https://stackoverflow.com/questions/3791414/storing-form-data-as-a-session-variable)，但没有人说一旦用户离开该表单，如何撤消会话。对我来说，一旦设置了会话，它就会不断设置（我想直到注销）。因此，例如，如果我不成功或成功提交带有“test”的表单然后转到其他一些链接，则**用户名字段将始终包含“test”。**这是我所拥有的：

```
$_SESSION['temp_username'] = $_POST['username']; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:25:29.020

只需在不需要时清除会话数据。你可以`unset`对你的临时变量做一个。

但出于同样的原因，我认为将表单存储更深一层会更好：

```
$_SESSION['formdata'] = $_POST; // Save the form 
```

然后您可以检索`username`为`$_SESSION['formdata']['username']`或`unset` `$_SESSION['formdata']`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T21:24:38.033

您可以使用`$_SESSION['temp_username'] = null`, （或其他默认值）或`unset()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T21:26:10.990

一旦你完成它，你总是可以 unset() $_SESSION['temp_username'] 。

```
unset($_SESSION['temp_username']) 
```

或者您可以调用 session_unset() 来清除所有会话数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-22T21:52:00.760

我写了一些东西来解决这个问题。基本上，我将表单数据设置为会话变量。如果 HTTP 引用者与 PHP 脚本的名称不同，会话变量会将其重置为新数组。否则，它将新数据合并到现有表单数据中。该脚本还允许您设置默认值，并清理输入。

您可能可以更改它以擦除或取消设置会话值，但这对我有用。

```
$form = array();

if(isset($_SESSION['form']) && isset($_SERVER['HTTP_REFERER']) && strrpos($_SERVER['HTTP_REFERER'], $_SERVER['SCRIPT_NAME']) !== false) {
    $form = $_SESSION['form'];
}

if(isset($_SESSION['defaults']) && is_array($_SESSION['defaults'])) {
    $defaults = $_SESSION['defaults'];
    unset($_SESSION['defaults']);
}
else {
    $defaults = array();
}
function addValues($arr, &$form) {
    foreach($arr as $key=>$value) {
        $form[$key] = mysql_real_escape_string(strip_tags(stripslashes($value)));
    }
}
if(sizeof($_POST) > 0) {
    addValues($_POST, $form);
}
if(sizeof($_GET) > 0) {
    addValues($_GET, $form);
}
$_SESSION['form'] = array_merge($defaults, $form); 
```

用法：

```
$_SESSION['defaults'] = array(
    'button'=>'first'
);
include_once "formdata.php"; 
```

...

```
<form>
    <p>Form data for button (always a valid index): <?php echo $_SESSION['form']['button'] ?></p>
    <button value="test" name="button" type="submit">Test</button>
</form> 
```

请注意，这允许您不必测试索引并使用 if 语句在默认值和表单值之间切换以在初始加载和回发时设置表单值的表单的简写。

# javascript - 从嵌套列表中删除 LI 保留子级？

> ID：12149786
> 
> 赞同：0
> 
> 时间：2012-08-27T21:21:29.787
> 
> 标签：javascript, jquery

我有一个嵌套的 UL LI 列表。例如

前

```
<ul>
    <li>Item A</li>
    <li>Item B
        <ul>
            <li id="removeme">Item BA (REMOVE ME)
            <ul>
                <li>Item BAA</li>
                <li>Item BAB</li>
                <li>Item BAC</li>
                <li>Item BAD
                    <ul>
                    <li>Item BADA</li>
                    <li>Item BADB</li>
                    <li>Item BADC</li>
                    <li>Item BADD</li>
                    </ul>                 
                </li>
                <li>Item</li>
            </ul>            
            </li>
            <li>Item BB</li>
            <li>Item BC </li>
            <li>Item BD</li>
        </ul>
    </li>
    <li>Item C</li>
    <li>Item D</li>
    <li>Item E</li>
</ul> 
```

后 ：

```
<ul>
    <li>Item A</li>
    <li>Item B
        <ul>
            <li>Item BAA</li>
            <li>Item BAB</li>
            <li>Item BAC</li>
            <li>Item BAD
                <ul>
                <li>Item BADA</li>
                <li>Item BADB</li>
                <li>Item BADC</li>
                <li>Item BADD</li>
                </ul>                 
            </li>
            <li>Item</li>           
            </li>
            <li>Item BB</li>
            <li>Item BC </li>
            <li>Item BD</li>
        </ul>
    </li>
    <li>Item C</li>
    <li>Item D</li>
    <li>Item E</li>
</ul> 
```

如果我想通过双击删除括号（或任何项目）中的上述项目并将其从列表中删除，但保留子元素并重新设置它们。你会怎么做？我正在开发一个导航管理器，需要能够删除项目，但不能删除孩子，并让他们重新成为父母。

任何线索都会很棒。

我虽然关于将当前元素的所有子元素附加到当前项目的父元素。但这会重复 ul。

谢谢

*更新包括之前和之后的例子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:28:18.243

像这样的东西：

```
$("li").dblclick(function(e) {
    e.stopPropagation();
    var $children = $(this).children().detach();
    $(this).remove();
    // do something with $children here, e.g.,
    // $children.appendTo(someOtherElement)
}); 
```

该[`.detach()`方法](http://api.jquery.com/detach/)从 DOM 中删除元素，但保留所有与它们关联的 jQuery 数据，因此您可以稍后重新插入它们。

当然，`$children`如果您打算在单击事件之后的某个时间点使用该变量（例如，为了响应某些稍后的事件），您需要在单击处理程序之外声明该变量。

如果这样做是为了响应单击或双击，则需要使用这些事件，`event.stopPropagation()`因为这些事件通过 DOM 向上传播，因此嵌套 li 元素之一的单击事件也会传播到父 li 元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T21:33:52.070

如果您要对其执行此操作的目标元素是`elem`，那么您可以这样做：

```
$(elem).find("li").insertAfter(elem);
$(elem).remove(); 
```

这里的例子：http: [//jsfiddle.net/jfriend00/RrHB2/](http://jsfiddle.net/jfriend00/RrHB2/)

要将其连接到 dlbclick 事件，它看起来像这样（您在其中填写适当的选择器以定位正确的项目）：

```
$(selector).dblclick(function(e) {
    e.stopPropagation();
    var target = $(this);
    target.find("li").insertAfter(item);
    target.remove();
}); 
```

* * *

如果你想支持多个级别并且只折叠一个级别，那么你可以使用这个：

```
var target = $("#removeme");
target.children("ul").children().insertAfter(target);
target.remove(); 
```

或者

```
$(selector).dblclick(function() {
    e.stopPropagation();
    var target = $(this);
    target.children("ul").children().insertAfter(target);
    target.remove();
}); 
```

工作演示：http: [//jsfiddle.net/jfriend00/TbDY7/](http://jsfiddle.net/jfriend00/TbDY7/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T21:49:47.613

```
$('elem').dbclick(function(e) {
    var elem = $(e.target);
    var children = elem.children();

    for (var i = children.length-1; i >= 0; i--)
       children[i].insertAfter(elem);

     elem.remove();
 } 
```

# java - 在 HTML 标记中调用 Java 变量

> ID：12149797
> 
> 赞同：1
> 
> 时间：2012-08-27T21:22:12.873
> 
> 标签：java, html

我需要在 HTML 标记中引用 Java 变量，以便将字符串变量内容显示为工具提示的 HTML“标题”标记值。我已经尝试了一天半，我的谷歌搜索也没有产生任何帮助。

我根据这个应用程序的要求将 Java 变量存储在一个表中，下面的代码是我可以纠正的最接近的代码，但它显示了工具提示/鼠标悬停结果的确切文本“block_type_desc”我需要当您将鼠标移到“block_code”值上时，显示表格列“block_type_desc”中的值。我试过： sb.append(""+block_type_desc'); sb.append(""); sb.append(""); sb.append(""); //无论我如何区分 t.getValue 等语法，它都不会编译

有人可以建议如何更正我的语法以正确调用变量字符串数据来显示它吗？非常感谢您的时间和帮助！我正在复制整个显示功能，因为我认为这将有助于全面了解我的需求和情况。

```
private StringBuffer displayUserMenuItems(Table t) {
        StringBuffer sb = new StringBuffer(20000);
        sb.append("<table>");
        sb.append("<tr>");
    sb.append("<td><strong>Code</strong></td>");
    sb.append("<td><strong>Menu Item Description</strong></td>");
    sb.append("<td><strong>Block Type</strong></td>");
    sb.append("</tr>");
    t.reset();
    String css;
    int i = 0;
    while (t.next()) {
        if (i % 2 == 0) {
            css = "even";
        } else {
            css = "odd";
        }
        sb.append("<tr class=\"" + css + "\">");
        sb.append("<td>");
        sb.append(t.getValue("menu_code"));
        sb.append("</td>");
        sb.append("<td>");
        sb.append(t.getValue("menu_desc"));
        sb.append("</td>");
        // this next line below displays "block_type_desc" for title
        **sb.append("<td title='block_type_desc'>");**
        sb.append(t.getValue("block_type"));
        sb.append("</td>");
        sb.append("</tr>");
        i ++;
    }
    sb.append("</table>");
    return sb;      
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:25:07.787

```
sb.append("<td title=\"" + t.getValue("block_type_desc") + "\">"); 
```

# c# - 难以订阅 SelectedItem 属性作为 EF4 中 SProc 的输入，通用存储库模式/MVVM

> ID：12149801
> 
> 赞同：0
> 
> 时间：2012-08-27T21:22:26.803
> 
> 标签：c#, stored-procedures, entity-framework-4, repository-pattern, complextype

[我在这里](http://www.codeproject.com/Articles/182880/Using-the-Microsoft-Desktop-Stack-Part-3-Using-Ent)使用了 MsDesktop Stack 示例来创建我的模式并为实体集建立视图/视图模型/存储库，其 PrimaryKey（称为 PartNumber）使用存储过程函数映射映射到 ComplexType 的许多 Attribute 属性。

我很容易订阅 RaisePropertyChangedEvent("Parts") 来填充列表框，但无法获得：

```
 public Part SelectedPart
    {
        get { return p_SelectedPart; }

        set
        {
            base.RaisePropertyChangingEvent("SelectedPart");
            p_SelectedPart = value;
            base.RaisePropertyChangedEvent("SelectedPart");
        }
    } 
```

当我在 OnPropertyChangedEvent 中订阅它时：

```
 void OnPropertyChanged(object sender, System.ComponentModel.PropertyChangedEventArgs e)
    {
        switch (e.PropertyName)
        {
            case "SelectedPart":

                /* When we select a Part, we need to configure the view model
                    * to display the selected Part's attributes. */

                VMSProcServices.ReturnExtendedPartProperties(this);

                break;

            case "Parts":

                /* When we load a Parts collection from the data store, we replace 
                    * the existing collection in the Parts property. After we do that, 
                    * we need to subscribe to the CollectionChanging event of the new
                    * collection. */

                this.Parts.CollectionChanging += OnPartsCollectionChanging;
                break;
        } 
```

其中 ReturnExtendedProperties() 定义为：

```
 public static void ReturnExtendedPartProperties(MainWindowVM mainWindowVM)
 {
      MyEntities myEntities = new MyEntities();
      mainWindow.ReturnAttsPerPn_Result = new ObservableCollection<ReturnAttsPerPn_Result>();
      if (mainWindowVM.SelectedPart != null)
      {
          mainwWindowVm.ReturnAttsPerPn_Result.Clear();
          foreach (ReturnAttsPerPn_Result attResult in myEntities.ReturnAttsPerPn(mainWindowVM.SelectedPart.PnID))
          { 
              mainWindowVM.ReturnAttsPerPn_Result.Add(attResult);
          }
       }
  } 
```

调试时，我的 Locals 窗口中没有 SelectedPart 属性的数据，但 Part 对象的 ObservableCollection 在那里（这很明显，因为我可以看到这些数据）。此外，我什至从未涉足“SelectedPart”的情况，只有 OnPropertyChanged 方法上的“Part”。

我的主要问题是，（请原谅我作为初学者缺乏表达能力）：我如何有效地“捕捉” SelectedPart 属性的值并将其提供给我的存储过程，并将输出用作集合？

感谢您的阅读，非常感谢您的帮助:)

编辑:: 更改标题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T19:55:28.813

尴尬地发现我的错误，只是绑定路径中的语法错误，我没有抓到（也没有贴出来。有兴趣的朋友，这是一个更简洁的存储过程结果获取方法版本，可能有点用给某人：

```
 public static void ReturnExtendedPartProperties(MainWindowVM mainWindowVM)
  {
       mainWindow.ReturnAttsPerPn_Result = new ObservableCollection<ReturnAttsPerPn_Result>();
       using (var myEntities = new MyEntities())
       {
             var results = myEntities.ReturnAttsPerPn(mainWindowVM.SelectedPart.PnID)
             if (mainWindowVM.SelectedPart != null)
             {
                  mainWindowVM.ReturnAttsPerPn_Result.Clear();
                  foreach (ReturnAttsPerPn_Result attresult in results)
                  {
                        mainWindowVM.ReturnAttsPerPn_Result.Add(attresult);
                  }
              } 
       }
 } 
```

# visual-c++ - C ++内存释放序列导致错误

> ID：12149804
> 
> 赞同：0
> 
> 时间：2012-08-27T21:22:37.523
> 
> 标签：visual-c++, memory-management

很久以前我在读一本书，并告诉我如何为指针分配和释放内存的模式。出于某种原因，它现在不适用于我的项目和我之前的项目。直到现在我才决定解决这个分配问题。所以这是有问题的代码：

```
 // Encrypting or Decrypting Mode
    bool ModeSelected(false);                   // stores the result if the user had selected a valid mode
    bool Mode(ENCRYPT);                         // saves the Mode if Encrypt or Decrypt

    while(!ModeSelected)
    {
        cout << "Enter E to Encrypt or D to Decrypt: " << endl;
        char resultED[MAXCHAR];                 // stores the result if to Encrypt or Decrypt
        char *presultED(nullptr);               // stores the result
        cin.getline(resultED, MAXCHAR, '\n');   
        presultED = new char((strlen(resultED)) + 1);
        strcpy(presultED, resultED);                // copy the result the char pointer variable

        if((*(presultED + 0) == 'E') || 
           (*(presultED + 0) == 'e'))                       // The user wants Encrypt
        {
            cout << endl << "Encrypt Mode is Selected" << endl;
            Mode = ENCRYPT;
            ModeSelected = true;
        }
        else if ((*(presultED + 0) == 'D') || 
                 (*(presultED + 0) == 'd'))             // The user wants Decrypt
        {
            cout << endl << "Decrypt Mode is Selected" << endl;
            Mode = DECRYPT;
            ModeSelected = true;
        }
        else
        {
            // Input is invalid
            cout << endl << "Input is invalid" << endl;
        }
        // clean up
        if(presultED)                           // If not null then delete it
        {
            // Garbage collection
            // Contact Stack Overflow
                 delete[] presultED;
                 presultED = nullptr;
        }
    } 
```

您会看到代码的**// clean up**部分正是这本书告诉我如何释放内存的。我也有点了解这背后的计算机科学。现在请告诉我这个问题。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:25:10.560

您使用 分配`presultED`和`new`释放它`delete[]`，这会产生**未定义的行为**。

```
presultED = new char((strlen(resultED)) + 1);  //allocates one char 
```

不一样

```
presultED = new char[(strlen(resultED)) + 1];  //allocates an array 
```

可能还有其他一些错误，我一看到这个就停止阅读了:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T21:27:51.917

问题是您没有分配数组，`char`而是`char`通过调用删除数组`delete[]`

你应该分配

```
presultED = new char[(strlen(resultED)) + 1]; 
```

像这样，因为这会创建一个 s 数组`char`。

如果不存在数组，则无法删除。

# php - 在 CodeIgniter 中使用 .htaccess 强制 HTTPS

> ID：12149807
> 
> 赞同：3
> 
> 时间：2012-08-27T21:23:01.780
> 
> 标签：php, .htaccess, codeigniter

我现有的完全从我的 URL`.htaccess`中删除：`index.php`

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /

#'system' can be replaced if you have renamed your system folder.
RewriteCond %{REQUEST_URI} ^system.*
RewriteRule ^(.*)$ index.php/$1 [L]

#Checks to see if the user is attempting to access a valid file,
#such as an image or css document, if this isn't true it sends the
#request to index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

#This last condition enables access to the images and css folders, and the robots.txt file
RewriteCond $1 !^(index\.php|(.*)\.swf|images|robots\.txt|css|docs|cache)
RewriteRule ^(.*)$ index.php/$1 [L]
</IfModule>

<IfModule !mod_rewrite.c>
# If we don't have mod_rewrite installed, all 404's
# can be sent to index.php, and everything works as normal.
ErrorDocument 404 /application/errors/404.php
</IfModule> 
```

我需要整个网站都通过 SSL 运行，而我的托管公司 Pagoda Box 有一个专有的`.htaccess`编辑可以从切换`http`到`https`：

```
RewriteCond %{HTTP:X-Forwarded-Proto} = http
RewriteRule (.*) https://%{SERVER_NAME}/$1 [R] 
```

它仅在第一个条件语句的末尾添加时才有效，并且它完美地工作：它添加`https`到裸 URL 并删除`index.php`.

但是，如果您在地址栏中选择`s`from`https`并将其删除，则`index.php`返回，加上 URL 的最后一段重复。如果我键入以 开头的完整 url，`http://`它会重定向并完美运行 - 只有当我将光标放在 前面`s`并删除它时，站点才会中断。

关于如何阻止这个新条件和规则与我现有文件冲突的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T23:37:20.807

对于任何 CI/Pagoda Box 用户，这对我有用：

```
<IfModule mod_rewrite.c>
RewriteEngine On

RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R,L]

RewriteBase /

#'system' can be replaced if you have renamed your system folder.
RewriteCond %{REQUEST_URI} ^system.*
RewriteRule ^(.*)$ index.php/$1 [L]

#Checks to see if the user is attempting to access a valid file,
#such as an image or css document, if this isn't true it sends the
#request to index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

#This last condition enables access to the images and css folders, and the robots.txt file
RewriteCond $1 !^(index\.php|(.*)\.swf|images|robots\.txt|css|js|docs|cache)
RewriteRule ^(.*)$ index.php/$1 [L]
</IfModule>

<IfModule !mod_rewrite.c>
# If we don't have mod_rewrite installed, all 404's
# can be sent to index.php, and everything works as normal.
ErrorDocument 404 /application/errors/404.php
</IfModule> 
```

请注意，RewriteBase 在 https 重定向之后，并且 [L] 结束处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T21:30:46.813

尝试将 http 到 https 重定向作为第一件事。它也可能最好`!https`用作重写的条件。所以你的 .htaccess 的重写部分可能看起来像这样。

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule (.*) https://%{HTTP_HOST}/$1 [R]

#'system' can be replaced if you have renamed your system folder.
RewriteCond %{REQUEST_URI} ^system.*
RewriteRule ^(.*)$ index.php/$1 [L]

#Checks to see if the user is attempting to access a valid file,
#such as an image or css document, if this isn't true it sends the
#request to index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

#This last condition enables access to the images and css folders, and the robots.txt file
RewriteCond $1 !^(index\.php|(.*)\.swf|images|robots\.txt|css|docs|cache)
RewriteRule ^(.*)$ index.php/$1 [L]
</IfModule> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-02T18:38:00.953

我的偏好是在虚拟主机中配置这种类型的重定向，而不是使用 .htaccess

```
<VirtualHost *:80>
    ServerName example.com
    Redirect permanent / https://example.com/
</VirtualHost>

<VirtualHost *:443>
   ServerName secure.example.com
   DocumentRoot /path_to_webroot/
   SSLEngine On
</VirtualHost> 
```

# css - 在伪 css 选择器上将 content css 属性的文本与 knockoutJS 绑定

> ID：12149809
> 
> 赞同：2
> 
> 时间：2012-08-27T21:23:02.937
> 
> 标签：css, knockout.js

我经常看到使用 ::after css 伪选择器实现的时尚 css 效果。例如：

`.bs-docs-example::after { content: "Example"; position: absolute; ...`

在这个 twitter-bootstrap 类`content`属性中定义 ::after 元素中的文本。有什么方法可以通过将它与 KnockoutJS 绑定来使其动态化？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T01:11:22.280

之前我不得不做几次类似的事情，我做的方式是绑定到一个`style`元素的文本，比如：

```
<style type='text/css' data-bind="text: exampleAfterStyle"></style> 
```

具有计算的可观察值，例如：

```
var viewModel = {
    name: ko.observable("Bob"),
};

viewModel.exampleAfterStyle = ko.computed(function() {
    return '.example::after { content: "' + viewModel.name() + '"; }';
}); 
```

这是一个示例：http: [//jsfiddle.net/rniemeyer/hfKPc/](http://jsfiddle.net/rniemeyer/hfKPc/)

# spring - 如何使用在 mvc 控制器中使用 @Scope("session") 保存的 jsp 页面中的会话变量的值

> ID：12149820
> 
> 赞同：2
> 
> 时间：2012-08-27T21:24:12.300
> 
> 标签：spring, spring-mvc

使用spring mvc做一个网站。我添加了一个 SignupController 来处理所有与注册相关的请求。用户注册后，我将使用 @Scope("session") 将其添加到会话中。下面是 SignupController 代码，

## 注册控制器.java

```
@Controller
@Scope("session")
public class SignupController {

@Autowired
SignupServiceInter signUpService;

private static final Logger logger = Logger.getLogger(SignupController.class);

private String sessionUser;

@RequestMapping("/SignupService")
public ModelAndView signUp(@RequestParam("userid") String userId, 
    @RequestParam("password") String password,@RequestParam("mailid") String emailId){

    logger.debug("  userId:"+userId+"::Password::"+password+"::");

    String signupResult;

    try {

        signUpService.registerUser(userId, password,emailId);
        sessionUser  = userId; //adding the sign up user to the session
        return new ModelAndView("userHomePage","loginResult","Success"); 
         //Navigate to user Home page if everything goes right

    } catch (UserExistsException e) {
        signupResult = e.toString();
        return new ModelAndView("signUp","loginResult", signupResult); 
         //Navigate to signUp page back if user does not exist
    }
}
 } 
```

我正在使用“sessionUser”变量来存储注册的用户 ID。我的理解是，当我将 @Scope("session") 用于控制器时，所有实例变量都将添加到 HttpSession。因此，通过这种理解，我尝试在 userHomePage.jsp 中访问这个“SessionUser”，

## 用户主页.jsp

```
Welcome to <%=session.getAttribute("sessionUser")%> 
```

但它抛出空值。

所以我的问题是如何使用在 mvc 控制器中使用 @Scope("session") 保存的 jsp 页面中的会话变量的值。

注意：我的解决方法是通过 ModelAndView 将签名的用户 ID 传递给 jsp 页面，但似乎在页面之间传递这样的值让我回到使用 QueryStrings 天来管理页面之间的状态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T01:52:56.950

当您为控制器指定 @Scope("session") 时，Spring 现在将确保每个会话都有一个唯一的控制器实例，因此您将能够将会话特定状态（如 sessionUser）保留为实例变量。

但是，要将变量公开给 UI，该变量必须是模型/会话属性的一部分，您可以使用 @ModelAttribute("sessionUser") 或 @SessionAttribute("sessionUser")

```
@Controller
@SessionAttribute("sessionUser")
public class SignupController {
@RequestMapping("/SignupService")
public ModelAndView signUp(@RequestParam("userid") String userId, 
    @RequestParam("password") String password,@RequestParam("mailid") String emailId,  Model model){
...
    try {

        signUpService.registerUser(userId, password,emailId);
        sessionUser  = userId; //adding the sign up user to the session
        model.addAttribute("sessionUser", sessionUser);

        return new ModelAndView("userHomePage","loginResult","Success"); 
         //Navigate to user Home page if everything goes right
       ....
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:35:49.617

我从来没有尝试过使用jsp进行spring集成，因为我一直在使用jsf，但我会尝试一下：

首先：为您感兴趣的属性添加 getter 和 setter（到控制器）。

```
@Controller
@Scope("session")
public class SignupController {

...

private String sessionUser;

public void setSessionUser(String sessionUser) {
    this.sessionUser = sessionUser;
}

public String getSessionUser() {
    return this.sessionUser;
}

... 
```

然后：像这样在jsp中调用它：

```
Welcome to ${session.sessionUser} 
```

那对你有用吗？:) 如果没有，我会尝试：

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
...
Welcome to <c:out value="${session.sessionUser}" /> 
```

# jquery - jQuery触摸链接不起作用

> ID：12149822
> 
> 赞同：1
> 
> 时间：2012-08-27T21:24:24.713
> 
> 标签：jquery, jquery-mobile

我有一些链接在我们网站的移动视图上不起作用。如果域中的路径中包含 /m，我们的站点所做的就是显示移动版本。除了这两个链接之外，一切似乎都运行良好：

```
<ol>
 <li>
  <a id="turn_off_mobile_link" href="http://oursite.com/welcome.htm?mobile_view_turn_off=1" target="_webapp">Turn off Mobile View</a>
 </li>
 <li>&nbsp;</li>
 <li>
  <a id="logoff_link" href="http://oursite.com/login.htm?logout=true" target="_webapp">Sign-Out</a>
 </li>
</ol> 
```

我不知道这些链接有什么问题，因为它们在移动设备上不一致。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:12:09.513

我为此找到的最佳解决方案无需进行太多更改，就是摆脱 target="_webapp" 并使用 rel="external"。这似乎效果最好。

# google-chrome - Chrome 从 OGG 文件中的搜索点开始缓冲，但不在 MP3 文件中

> ID：12149829
> 
> 赞同：4
> 
> 时间：2012-08-27T21:25:22.360
> 
> 标签：google-chrome, mp3, html5-audio, buffering, ogg

我已经设置了一个 HTML5 音频标签，其中包含两个源，一个 OGG 文件和一个 MP3 文件，如下所示：

```
<audio controls="controls" id="audioplayer1">
    <source src="podcast.mp3" type="audio/mpeg" />
    <source src="podcast.ogg" type="audio/ogg" />
</audio> 
```

当在 Chrome 中播放 OGG 文件并寻找未缓冲的位置时，缓冲会在其旧位置停止并从这个新位置继续，因此播放几乎立即继续。这也适用于 Internet Explorer 9 中的 MP3 和 Firefox 14.0.1 和 Opera 12.01 build 1532 中的 OGG。但是，当在 Chrome 中播放 MP3 文件时，缓冲只是从头开始并停止播放，直到缓冲达到新的播放位置。对于大型音频文件，这可能需要一些时间。示例： http: [//mvcpeer.be/uhbpmedia/web/test.html](http://mvcpeer.be/uhbpmedia/web/test.html)

我的服务器应该正确配置：

```
AddType audio/mpeg mp3
AddType audio/ogg ogg 
```

并且支持字节范围。我比较了浏览器对 OGG 和 MP3 的请求，发现有些奇怪：

对于 OGG，Chrome 首先发出一个包含 的请求`Range: bytes=0-`，它会收到一个 206 响应，其中包含其标头中的总文件大小（本例中为 136.320.012 字节），如下所示：

要求

```
GET /audio/podcast.ogg HTTP/1.1
Host: inderdaad.be
Connection: keep-alive
Accept-Encoding: identity;q=1, *;q=0
User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.83 Safari/537.1
Accept: */*
Referer: http://mvcpeer.be/uhbpmedia/web/web.php
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
Range: bytes=0- 
```

回复

```
HTTP/1.1 206 Partial Content
Date: Mon, 27 Aug 2012 18:18:41 GMT
Server: Apache/2
Last-Modified: Mon, 27 Aug 2012 10:08:56 GMT
ETag: "26016c4-820140c-4c83c837ab335"
Accept-Ranges: bytes
Content-Length: 136.320.012
Vary: Accept-Encoding,User-Agent
Content-Range: bytes 0-136320011/136320012
Keep-Alive: timeout=1, max=100
Connection: Keep-Alive
Content-Type: audio/ogg 
```

当我跳到无缓冲的位置时，对文件末尾的一小部分发出第二个请求，`Range:`然后属性为`bytes=136241821-136255487`（可能对于某些元数据，响应为 200），然后是第三个`Range:`设置为的请求`bytes=37340471-136242175`（响应 206 ）。缓冲现在从这一点开始。

但是对于 MP3，Chrome 只发出一个包含`Range: bytes=0-`. 当我寻找一个无缓冲的位置时，没有第二个或第三个请求，因此缓冲不能从寻找点开始。

这是 Chrome 的问题吗？（使用 Chrome 21.0.1180.83 m）

非常感谢！

# c# - c# singleton winform 加载/卸载图像

> ID：12149831
> 
> 赞同：0
> 
> 时间：2012-08-27T21:25:34.917
> 
> 标签：c#, image, singleton, dispose, idisposable

我有一个winform应用程序。主要形式是单例，它加载了很多图像。图片代表产品，每次点击图片，我都会修改产品的库存并重新加载产品和图片的哈希表。

问题在于每次我从 BBDD 重新加载产品的哈希表并重新加载图像时。在一天结束时，应用程序消耗了大量内存，我不知道何时以及如何卸载图像以便重新加载（因为有时我可以修改图像并且我也必须重新加载）

重新加载哈希表和按钮的代码是：

```
Family fam = new Family();

List<Family> listFamilies = fam.loadFamilies();
htProducts.Clear();

foreach(Family family in listFamilies)
{
   //reload all the products of each family
   if(htProducts[family.idFamily]==null)
   {
     List<Product> listProducts= fam.loadProductsFamily(family.idFamily);
     htProducts[family.idFamily] = listProducts;
   }
   Button bt = new Button();
   bt.location = new Point(x,y); //The buttons are created dinamically
   bt.Parent = panelFamilies;//I have all the buttons inside a panel.
   try
   {
      if(family.urlImage !="")
      {
         bt.Text=family.Name;
         bt.Image = new Bitmap(family.urlImage);
      }
   }
   catch(Exception ex)
   {
     ....
    }

} 
```

当我点击一个系列按钮时，它会加载该系列的产品，但代码或多或少是相同的。它也加载图像。

或多或少这是代码。问题是每次单击按钮时，我都会在产品中加载更多按钮并加载图像。

很多时候，我重新加载单例表单并执行之前的代码，然后再次加载图像并耗尽内存。

¿ 何时以及如何卸载图像？

编辑：

在再次加载带有图像的按钮之前，我添加了以下代码：

```
foreach (Control c in panel8.Controls)
{
    if (c is Button)
        c.Dispose();
}
GC.Collect(GC.MaxGeneration);// I think that isn't correct to use because I've read,  but reduces the memory. 
```

它会在再次加载图像之前处理面板的所有按钮和图像并减少内存吗？

顺便说一句对不起我的英语:(

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T23:21:13.113

```
foreach (Control c in panel8.Controls)
{
    if (c is Button)
        c.Dispose();
} 
```

那是行不通的。通常，当您在迭代集合的 foreach 语句中更改集合时，.NET 集合类会引发 InvalidOperationException。不幸的是，这并没有为 Controls 集合实现。所以这段代码所做的只是处理所有其他控件。这足以导致不受控制的资源泄漏，不仅是 Button 控件，还有它们的图像。

解决方法是向后迭代 Controls 集合，如下所示：

```
for (int ix = panel8.Controls.Count - 1; ix >= 0; --ix) {
    Control c = panel8.Controls[ix];
    // etc...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T21:41:27.990

听起来您在表格中保留了一个或两个参考。

您应该使用诸如 CLRProfiler 或 ANTs 之类的调试器来查看您的进程，以了解在您的进程中占用如此多内存的原因。获得此信息后，您可以采取下一步措施，确保释放对它的所有引用，以便收集它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T21:49:40.853

要排除故障，请致电

```
GC.Collect(GC.MaxGeneration); 
```

这将强制进行垃圾收集。然后在进程资源管理器或任务管理器中检查内存使用情况。如果它更小，则仅意味着运行时决定不收集内存。

如果它不起作用，则需要查找内存泄漏。

# java - 接口是否被视为实现它的类的父级？

> ID：12149833
> 
> 赞同：3
> 
> 时间：2012-08-27T21:25:39.563
> 
> 标签：java, generics, inheritance, multiple-inheritance

我这里有一个框架，它使用一个对象在其他对象与之交互时维护它们之间的状态。我希望与状态交互的对象（“动作”）通常可以接受一种接口类型，状态对象将实现该接口，但我无法完成这项工作。

我想根据特定的状态实现（或接口）来定义框架对象本身，并且能够向它添加操作，只要它们直接或通过状态实现的接口接受定义的状态。

据我了解，该`<? super S>`定义的意思是“某种类型是 S 的父类”，但我不确定由 S 实现的接口是否符合此描述，因为它不完全是父类。

这是一个示例（不完全编译代码）：

```
Class Framework<State> {
    addAction(Action<? super State> a) {} // adds to a list of actions to be run

    run(State s) {
        for(Action<? super State> a : actions) {
            a.perform(s);
        }
    }
}

Interface IState1 {}

Interface IState2 {}

Interface Action<State> {
    public void perform(State s);
}

Class Action1 implements Action<IState1> {}

Class Action2 implements Action<IState2> {}

Class CombinedState implements IState1, IState2 {}

public static void run() {
    Framework<CombinedState> f = new Framework<CombinedState>();

    // add is expecting Action<? super CombinedState> but getting Action<IState1>
    f.add(new Action1()); // This doesn't seem to work
    f.add(new Action2());

    f.run(new CombinedState());
} 
```

出于泛型的目的，接口是否算作父类？有什么方法可以实现不需要反射吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:39:35.100

```
import java.util.ArrayList;

class State{}

class Framework<State> 
{
    public ArrayList< Action< ? super State > >actions = new ArrayList< Action< ?super State > >();

    void add(Action<? super State> a) {

        actions.add(a);

    } 

    void doRun(State s) {
        for(Action<? super State> a : actions) {
            a.perform(s);
        }
    }
}

interface IState1 {}

interface IState2 {}

interface Action<State> {
    public void perform(State s);
}

class Action1 implements Action<IState1> {
    public void perform( IState1 s )
    {
        System.out.println("Do something 1");
    }
}

class Action2 implements Action<IState2> {

    public void perform( IState2 s )
    {
        System.out.println("Do something 2");
    }   
}

class CombinedState implements IState1, IState2 {}

class Untitled {
    public static void main(String[] args) 
    {
         Framework<CombinedState> f = new Framework<CombinedState>();

            // add is expecting Action<? super CombinedState> but getting Action<IState1>
            f.add(new Action1()); // This doesn't seem to work
            f.add(new Action2());

            f.doRun(new CombinedState());
    }
} 
```

这在 OSX 上的 CodeRunner 中运行。

# javascript - 如何检索用户浏览器中当前网页的高度和宽度？

> ID：12149836
> 
> 赞同：2
> 
> 时间：2012-08-27T21:25:45.077
> 
> 标签：javascript, jquery, html

我正在尝试使用弹出式视频播放器。会使用fancybox，但它们是非商业的，我的用例相对简单。基本上，我正在创建一个 div，它在黑色背景中覆盖整个页面，具有足够的不透明度，仍然可以看到所有内容。我想在此“覆盖”div 上的页面上用户当前位置（高度方面）放置一个 youtube 视频（通过 iframe 硬链接插入）。基本上，我不想将此视频放在用户必须滚动到的页面的高度位置。

我查看了 jquery 库，包括浏览器和支持，但没有看到任何值得注意的东西。有没有我错过的方法？顺便说一句，它可能是一个 Javascript 解决方案，我只是碰巧将 JQuery 用于其他一切，所以风格上，你知道。

编辑：

我试图将这个新的 div（包含 iframe 代码）放在用户浏览器视口当前所在的位置，而不是确定文档的高度或浏览器视口的高度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:27:24.080

使用 $（窗口）。例如：

```
console.log($(window).height());
console.log($(window).width()); 
```

在调整浏览器窗口大小时尝试一下，您会看到它发生了变化。

如果要获取窗口视口滚动到的位置，请使用 $(window).scrollTop() 和 $(window).scrollLeft()。

如果要获取特定元素的位置，请使用 $("#myid").position() （相对于偏移父级）或 $("#myid")offset() （相对于文档）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T22:07:54.253

`.height()`或者`.outerHeight()`两者都应该工作：

[http://jsfiddle.net/hL3cv/](http://jsfiddle.net/hL3cv/)

```
$(window).height();
$(window).outerHeight();
$(window).width();
$(window).outerWidth(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T21:43:00.603

[jquery 高度文档](http://api.jquery.com/height/)

[jquery 宽度文档](http://api.jquery.com/width/)

获取文档高度：
$(window).height();

获取文档宽度：
$(window).width();

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T21:32:48.947

我使用[PrettyPhoto](http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone/)。它不是太大，如果您对 JavaScript 感到满意，您可以删除任何不需要的代码以使其更加紧凑。

# php - 间歇性 MySQL 服务器已消失错误

> ID：12149838
> 
> 赞同：4
> 
> 时间：2012-08-27T21:25:57.730
> 
> 标签：php, mysql, curl

我一直在摸索，试图找出导致脚本间歇性错误的原因。错误是：SQLSTATE[HY000]: General error: 2006 MySQL server has gone away。

我下面的脚本是执行 curl 的函数的一部分，从 JSON 响应中获取一些值，然后将它们写入表。我会说 80% 的时间它工作正常，然后其他 20% 我得到服务器消失错误。我无法确定导致它出错的任何趋势，它似乎只是随机的。任何想法为什么我可能会收到此错误？谢谢你检查这个

```
 ...
    //post via cURL 
    $ch = curl_init( $url );
    $timeout = 500;
    curl_setopt( $ch, CURLOPT_POST, 1);
    curl_setopt( $ch, CURLOPT_POSTFIELDS, $myvars);
    curl_setopt( $ch, CURLOPT_FOLLOWLOCATION, 1);
    curl_setopt( $ch, CURLOPT_CONNECTTIMEOUT, $timeout);
    curl_setopt( $ch, CURLOPT_HEADER, 0);
    curl_setopt( $ch, CURLOPT_RETURNTRANSFER, 1);
    $this->response = curl_exec( $ch );
    $this->json_decoded = json_decode($this->response);
    $this->full = print_r($this->json_decoded, true);
    $client_leadid = $this->json_decoded->Parameters->lead_id;
    $client_status = $this->json_decoded->Status;   
    $length = curl_getinfo($ch);
    curl_close($ch);

    //record in DB
    $insert = $this->full.' | '.$url.' | '.$myvars.' | '.$this->date . ' | Time Taken: '.$length['total_time'];
    $db->exec("UPDATE table SET client_resp = '$insert' WHERE global_id = '$this->leadid' LIMIT 1");
    $db->exec("UPDATE table SET client_leadid = '$client_leadid' WHERE global_id = '$this->leadid' LIMIT 1"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T22:44:53.727

这可能是因为您的 CURL 请求花费的时间比 mysql 连接超时时间长

要么 1) 为 CURL 设置请求超时，以便它在错误时更快地死掉（CURLOPT_CONNECTTIMEOUT 仅用于连接 - CURLOPT_TIMEOUT 用于请求的总长度，如果服务器没有及时响应，它将停止）2）出现mysql 空闲超时以防止服务器因未发送查询而断开连接
3) 检测错误并自动重新连接到 mysql

```
mysql> show variables like "%timeout%";
+--------------------------+-------+
| Variable_name            | Value |
+--------------------------+-------+
| connect_timeout          | 5     |
| delayed_insert_timeout   | 300   |
| innodb_lock_wait_timeout | 50    |
| interactive_timeout      | 28800 |
| net_read_timeout         | 30    |
| net_write_timeout        | 60    |
| slave_net_timeout        | 3600  |
| table_lock_wait_timeout  | 50    |
| wait_timeout             | 28800 |
+--------------------------+-------+
9 rows in set (0.00 sec) 
```

wait_timeout 和 interactive_timeout 是你关心的两个

# c# - 后台线程中的 HttpWebRequest

> ID：12149842
> 
> 赞同：0
> 
> 时间：2012-08-27T21:26:26.910
> 
> 标签：c#, .net, multithreading, httpwebrequest

我想`HttpWebRequest`在一个单独的线程中执行一个。

例如我有：

```
public string GetPage(string url)
{
    string html = new WebClient().DownloadString(url);
    return html;
} 
```

我如何在没有太多麻烦的情况下在单独的线程中运行它？

我尝试过启动一个简单的线程，但我不知道如何返回 HTML。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:34:53.517

要做到“没有太多麻烦”，请使用 c# 5.0

```
public async void DoWork(string url)
{
    string page = await new WebClient().DownloadStringTaskAsync(url);
    //Caller thread will not be blocked but you will be able to
    //continue your work at this point after BG thread 
    //(executing "DownloadStringTaskAsync") has downloaded the page

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:46:45.443

“没有太多麻烦”不太可能......

选项：

*   将结果放入某种同步集合（即[ConcurentQueue](http://msdn.microsoft.com/en-us/library/dd267265)）以构建某种消费者/生产者对（将该集合作为参数传递给您的调用）
*   传递某种回调“数据就绪”，当数据存在时将被调用（类似于[DownloadStringCompleted](http://msdn.microsoft.com/en-US/library/system.net.webclient.downloadstringcompleted%28v=vs.100%29)）
*   只需在该新线程上处理数据并在您需要的任何地方提交结果

# jquery - 自动完成组合框 Slickgrid 自定义编辑器不完全有效

> ID：12149847
> 
> 赞同：2
> 
> 时间：2012-08-27T21:26:49.910
> 
> 标签：jquery, jquery-ui, autocomplete, jquery-ui-autocomplete, slickgrid

我正在尝试在最新版本的 SlickGrid 中创建自定义自动完成组合框编辑器。组合框的主要目的是根据用户键入的文本显示结果，并且它还将包括一个向下箭头链接按钮，使用户可以通过将空白参数传递给“自动完成”函数来查看所有结果。这是您可以查看我正在尝试在 SlickGrid 中作为自定义编辑器创建的[链接的链接。](http://jqueryui.com/demos/autocomplete/#combobox)（请忽略“显示底层选择”按钮）

我能够根据用户输入获得建议，并且在列字段的右侧放置了一个小箭头链接按钮，该按钮应该显示 [availableTags] 数组中的所有项目。当我单击箭头时，它并没有列出基本上没有按预期响应的所有项目。但是，如果用户键入与列表中的某个项目匹配的内容，则意味着小部件已打开，单击箭头按钮后它会关闭但不会显示所有项目的列表。我想我在处理 DOM 方面做错了。任何帮助将不胜感激。

这是创建列的源代码。

```
 var columns = [
        {id: "TestAuto", name: "Auto Complete", field: "TestAuto", minWidth:100,width:150, editor: Slick.Editors.Auto}
      ]; 
```

这是自定义编辑器代码：

```
$.extend(true, window, {
    "Slick": {
      "Editors": {
        "Auto": AutoCompleteEditor,
        "Text": TextEditor,
        "Integer": IntegerEditor,
        "Date": DateEditor,
        "YesNoSelect": YesNoSelectEditor,
        "Checkbox": CheckboxEditor,
        "PercentComplete": PercentCompleteEditor,
        "LongText": LongTextEditor,
        "Combo": ComboTest
      }
    }
  });
  var availableTags = [
                        "ActionScript",
                        "AppleScript",
                        "Asp",
                        "BASIC",
                        "C",
                        "C++",
                        "Clojure",
                        "COBOL",
                        "ColdFusion",
                        "Erlang",
                        "Fortran",
                        "Groovy",
                        "Haskell",
                        "Java",
                        "JavaScript",
                        "Lisp",
                        "Perl",
                        "PHP",
                        "Python",
                        "Ruby",
                        "Scala",
                        "Scheme"
                      ];

  function AutoCompleteEditor(args) {
     var $input;
     var defaultValue;
     var scope = this;
     var calendarOpen = false;

     this.init = function () {

       $input = $("<INPUT id='tags' class='editor-text' />");
       $input.width($(args.container).innerWidth() - 25);
       $input.appendTo(wrapper);

       $( "<a>" )
            .attr( "tabIndex", -1 )
            .attr( "title", "Show All Items" )
            .appendTo( wrapper )
            .button({
                icons: {
                    primary: "ui-icon-triangle-1-s"
                },
                text: false
            })
            .removeClass( "ui-corner-all" )
            .addClass( "ui-corner-right ui-combobox-toggle" )

            .click(function() {

                // close if already visible
                if ( $input.autocomplete( "widget" ).is( ":visible" ) ) {
                    $input.autocomplete( "close" );
                    return;
                }

                // work around a bug (likely same cause as #5265)
                $( this ).blur();

                // pass empty string as value to search for, displaying all results
                $input.autocomplete( "search", "" );

                $input.focus();
            });

       $input.focus().select();
       $input.autocomplete({
            source: availableTags
        });

     };

     this.destroy = function () {
       $input.autocomplete("destroy");
     };

     this.focus = function () {
       $input.focus();
     };

     this.loadValue = function (item) {
       defaultValue = item[args.column.field];
       $input.val(defaultValue);
       $input[0].defaultValue = defaultValue;
       $input.select();
     };

     this.serializeValue = function () {
       return $input.val();
     };

     this.applyValue = function (item, state) {
       item[args.column.field] = state;
     };

     this.isValueChanged = function () {
       return (!($input.val() == "" && defaultValue == null)) && ($input.val() != defaultValue);
     };

     this.validate = function () {
       return {
         valid: true,
         msg: null
       };
     };

     this.init();
   } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T17:08:58.283

在我发布这个问题后不久，终于找到了解决方案。为了显示建议框中列出的所有项目，必须在输入的自动完成定义中将 minLength 设置为 0。

```
$input.autocomplete({
                delay: 0,
                minLength: 0, //has to be 0 to bring all items in case the search contains empty string.
                source: availableTags
            }); 
```

很抱歉那些长期以来一直在寻找解决此类问题的方法。

# css - CSS 过渡（翻译）闪烁

> ID：12149849
> 
> 赞同：2
> 
> 时间：2012-08-27T21:27:18.127
> 
> 标签：css, css-transitions

我都试过了

```
-webkit-backface-visibility: hidden; 
```

和

```
-webkit-perspective: 1000; 
```

解决触发转换时发生的闪烁，但没有任何效果。有没有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:46:37.690

这是相当不科学的，但尝试添加`-webkit-transform: translate3d(0, 0, 0);`

它应该没有什么区别（0,0,0 的翻译毕竟意味着“什么都不做”），它可能在未来没有任何区别，但它有时会强制以这样的方式使用 3d 加速平滑动画和过渡。我发现它很好地整理了一些在 safari 中可怕地闪烁的动画。（并且在 iPad 上的 safari 中闪烁非常非常可怕）。

这有点像 1990 年代将魔术词添加到网页，但有时确实有效。

# php - 如何设置自定义错误消息zend表单元素文件？

> ID：12149850
> 
> 赞同：7
> 
> 时间：2012-08-27T21:27:22.067
> 
> 标签：php, file, zend-framework, element, validation

所以我正在使用 Zend，我有一个 Zend 表单，其中包含 Zend_Form_Element_File 和三个验证器：1\. setRequired 2\. Extension 3\. Size

```
 $this->browse = new Zend_Form_Element_File('Browse');
 $this->browse->setRequired(false)->removeDecorator('errors')->removeDecorator('label')
->addValidator('Extension', true, 'pdf')->addValidator('Size', false, 2000000); 
```

我想为这些验证器设置自定义错误消息，但不知道如何。

我想设置自定义错误消息的原因是因为我有一个自定义装饰器，当表单使用 isValid() 无效时，我可以使用它抓取所有错误并将它们显示在表单顶部。我在表单中获取错误的方法是 getErrors()。

我也试过：[http://www.mail-archive.com/fw-general@lists.zend.com/msg25779.html](http://www.mail-archive.com/fw-general@lists.zend.com/msg25779.html) 通过这样做：

```
 $validator = new Zend_Validate_File_Upload();
 $validator->setMessages(array('fileUploadErrorNoFile' => 'Upload an image!'')); 
```

和做

```
 $this->browse->addValidator($validator); 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-28T05:07:39.397

这就是我用来设置自定义验证器消息的方式。

```
$file = new Zend_Form_Element_File('file');
$file->setLabel('File Label')
     ->setMaxFileSize('512000')
     ->addValidator('Count', true, 1)
     ->addValidator('Size', true, 512000)
     ->addValidator('Extension', true, 'jpg,jpeg,png,gif');

$file->getValidator('Count')->setMessage('You can upload only one file');
$file->getValidator('Size')->setMessage('Your file size cannot upload file size limit of 512 kb');
$file->getValidator('Extension')->setMessage('Invalid file extension, only valid image with file format jpg, jpeg, png and gif are allowed.'); 
```

以下是一些可能有助于理解自定义验证器消息的链接。

[http://framework.zend.com/manual/en/zend.validate.messages.html](http://framework.zend.com/manual/en/zend.validate.messages.html)

[Zend Framework 自定义验证类错误消息](https://stackoverflow.com/questions/2739508/zend-framework-custom-validation-class-error-message)

[无法在 Zend_Form 中设置自定义验证器消息](https://stackoverflow.com/questions/9517524/cant-set-custom-validator-messages-in-zend-form)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T03:39:29.553

```
$this->browse = new Zend_Form_Element_File('Browse');
$this->browse->setRequired(true)
             ->removeDecorator('errors')
             ->removeDecorator('label')
             ->addValidator('Extension', true, 'pdf')
             ->addValidator('Size', false, 2000000)
             //->setMessage('You custom message')
             ->addValidator('File_Upload', true, array('messages'=>'You custom message')); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T09:03:21.347

要在 zend_form_element_file 上添加自定义消息，请参见以下代码，

```
 $browse = new Zend_Form_Element_File('Browse');
   $browse->addValidator('Extension', false, array('pdf',
               'messages'=>array('fileExtensionFalse'=>'file extension is not supported'))
          ->addValidator('Size', false, array(2000000,
                'messages'=>array('filesizefalse'=>'maximum 2000000 supported')); 
```

# c# - 如何在不同的线程中引用控件？

> ID：12149861
> 
> 赞同：1
> 
> 时间：2012-08-27T21:28:11.933
> 
> 标签：c#, multithreading, backgroundworker

```
//button is clicked
//worker starts

private void processWorker_DoWork(object sender, DoWorkEventArgs e)
{
     string code = DoLongWorkAndReturnCode();

     if (code != 0)
     {
         MessageBox.Show("Error!");
         EnableAllButtons(); // this is defined in the other thread and it's where i run into the error.
     }
     else
     {
          string code = DoAnotherLongProcessAndReturnCode(); 
          if (code != 0)
          {
               MessageBox.Show("Error 2!");
               EnableAllButtons(); // again, this is defined in the other thread
          }
     }
} 
```

我遇到了跨线程错误，因为“EnableAllButtons()”是在不同的线程中定义的。

如何从不同的线程启用一个线程中的所有按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:36:57.993

根据您的姓名，我假设您使用的是[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)。您必须更新[ProgressChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.progresschanged.aspx)、[RunWorkerCompleted](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.runworkercompleted.aspx)、[Control.Invoke](http://msdn.microsoft.com/en-us/library/zyzhdc6b.aspx)或[Control.BeginInvoke](http://msdn.microsoft.com/en-us/library/0b1bf3y3)中的控件（您不需要为 Control 的 BeginInvoke 触发 EndInvoke）。

我的建议是在后台工作人员中抛出异常（如果您没有使用除检查 0 以外的代码，如果不使用 Result 方法。）并检查传递给 RunWorkerCompleted 事件的参数的[Error](http://msdn.microsoft.com/en-us/library/system.componentmodel.asynccompletedeventargs.error.aspx)属性。从那里您可以启动另一个后台工作人员或停止。您将在主线程上运行，因此您无需调用即可更改按钮。

* * *

**示例：**通过 BeginInvoke 启用按钮

使用此示例，您可以按原样使用您的代码，只需修改 EnableAllButtons

```
private void EnableAllButtons() 
{ 
    //See if the main form needs invoke required, assuming the buttons are on the same thread as the form
    if(this.InvokeRequired) 
    {
        //Calls EnableAllButtons a seccond time but this time on the main thread.
        //This does not block, it is "fire and forget"
        this.BeginInvoke(new Action(EnableAllButtons));
    }
    else
    {
        btnProcessImages.Enabled = true; 
        btnBrowse.Enabled = true; 
        btnUpload.Enabled = true; 
        btnExit.Enabled = true; 
        ControlBox = true;
    }
} 
```

* * *

**示例：**通过 Result 返回数据

```
private void processWorker1_DoWork(object sender, DoWorkEventArgs e)
{
     string code = DoLongWorkAndReturnCode();
     e.Result = code;
}
private void processWorkers_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    if (code != 0)
    {
        MessageBox.Show("Error!");
        EnableAllButtons(); // this is defined in the other thread and it's where i run into the error.
    }
    else
    {
          doAnotherLongProcessAndReturnCodesBackgroundWorker.RunWorkerAsync(); 
    }
} 
```

* * *

**示例：**通过异常返回数据 + 重用事件处理程序。

```
private void processWorker1_DoWork(object sender, DoWorkEventArgs e)
{
     string code = DoLongWorkAndReturnCode();
     if (code != 0)
     {
         thow new MyCustomExecption(code);
     }
}

private void processWorker2_DoWork(object sender, DoWorkEventArgs e)
{
     string code = DoAnotherLongProcessAndReturnCode(); 
     if (code != 0)
     {
         thow new MyCustomExecption(code);
     }
}

private void processWorkers_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    if(e.Error != null)
    {
        string message;

        //See if it was our error
        if(e.Error.GetType() == typeOf(MyCustomExecption))
        {

            //Choose which error message to send
            if(sender.Equals(processWorker2))
                message = "Error2!";
            else
                message = "Error!";
        }
        else
        {
            //Handle other types of thrown exceptions other than the ones we sent
            message = e.Error.ToString();
        }

        //no matter what, show a dialog box and enable all buttons.
        MessageBox.Show(message);
        EnableAllButtons();
    }
    else
    {
        //Worker completed successfully. 
        //If this was called from processWorker1 call processWorker2

        //Here is the code that was returned from the function
        if(sender.Equals(processWorker1))
            processWorker2.RunWorkerAsync();
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:31:40.847

为了访问另一个线程中的控件，您需要使用 Control.Invoke，如下所述： [Control.Invoke 方法（委托）](http://msdn.microsoft.com/en-us/library/zyzhdc6b.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T21:33:26.000

如果您必须直接从另一个线程访问 UI 控件，请查看这个最有用的扩展方法

[https://stackoverflow.com/a/3588137/141172](https://stackoverflow.com/a/3588137/141172)

BackgroundWorker[为进度更新提供了一个事件](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.progresschanged.aspx)。如果您对 UI 的更改属于这种性质，请考虑使用该事件。

# android - Corona SDK (Android) 的本地通知

> ID：12149864
> 
> 赞同：2
> 
> 时间：2012-08-27T21:28:20.193
> 
> 标签：android, uilocalnotification, coronasdk

有没有办法在使用 Corona SDK 时实现本地通知？这是 android 特定的，因为我们已经找到了 iOS 方向。

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:43:46.833

本地通知适用于 iOS 和 Android：[http ://docs.coronalabs.com/api/library/system/scheduleNotification.html](http://docs.coronalabs.com/api/library/system/scheduleNotification.html)

似乎没有办法为这些通知设置图标，但我相信他们会在某个时候添加它。

截至目前（2012.12.07），推送（远程）通知在 iOS 上可用，但在 Android 上不可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T11:54:01.343

目前本地通知是 iOS 仅在 Corona 上... Android 版本尚未完成。

完成后，我会看到使用 android 版本的说明进行编辑。

# ruby-on-rails - Rails：rails_admin 扩展指定模型的新动作

> ID：12149865
> 
> 赞同：1
> 
> 时间：2012-08-27T21:28:22.023
> 
> 标签：ruby-on-rails, rails-admin

我正在使用 rails_admin 作为后端。我想知道是否有任何方法可以扩展 rails_admin 的“新”操作以自动将 current_user id 分配给指定的模型？自定义字段似乎对我不起作用，因为我不想要隐藏字段。

有人会提出解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T23:56:49.943

[https://github.com/sferik/rails_admin/wiki/How-to-set-default-values](https://github.com/sferik/rails_admin/wiki/How-to-set-default-values)

我认为应该这样做。在你的配置文件中尝试这样的事情。

```
config.model Post do 
  new do 
    field :user_id, :hidden do
      default_value do
        bindings[:view]._current_user.id
      end
    end
  end 
end 
```

# bash - 从命令行运行的脚本的 Git BASH 位置

> ID：12149868
> 
> 赞同：0
> 
> 时间：2012-08-27T21:28:27.783
> 
> 标签：bash, git-bash

__git_ps1 是我可以在 BASH shell 中运行的命令，无论它从哪个目录运行，它都会运行。我怎么知道这个批处理文件的来源？我检查了我所有的 $PATH 文件夹，但它不在其中任何一个文件夹中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:32:00.460

如果该命令实际上是路径中的独立脚本，则可以使用 type 命令来定位它：

`type __git_ps1`

但是，它可能是一个函数或别名，在这种情况下，type 命令的输出不会有太大帮助。（除了至少让你知道它是一个函数或别名。）

[编辑]

刚刚意识到这是来自 git 完成，它（可能？）在 /etc/bash_completion.d/git 中定义。

# java - Hibernate 事件监听器 - 回滚

> ID：12149870
> 
> 赞同：7
> 
> 时间：2012-08-27T21:28:39.797
> 
> 标签：java, hibernate, event-listener

我像这样实现了一个休眠事件监听器：

```
public class AuditListener implements PostInsertEventListener {
  private static final long serialVersionUID = -966368101369878522L;

  @Override
  public void onPostInsert(PostInsertEvent event) {
    if (event.getEntity() instanceof Auditable) {
      StatelessSession session = null;
      try {
        session = event.getPersister().getFactory().openStatelessSession();
        Auditable auditableEntity = (Auditable)event.getEntity();
        session.beginTransaction();
        session.insert(new AuditTrail(auditableEntity.getClass().getSimpleName(),
            auditableEntity.getId(), auditableEntity.getStatus(),
            auditableEntity.getLastModified()));
        session.getTransaction().commit();
      } catch (HibernateException he) {
        System.out.println("Horrible error: " + he.getMessage());
        session.getTransaction().rollback();
      } finally {
        if (session != null) {
          session.close();
        }
      }
    }
  }
} 
```

它所做的只是`AuditTrail`在插入任何`Auditable`对象后立即将一个对象插入数据库。

当在持久化对象的事务期间出现任何类型的异常情况时，我遇到的问题是`Auditable`：事务回滚，但我仍然`AuditTrail`插入了一条记录。

我试图把这个：

```
StatelessSession session = event.getPersister().getFactory().openStatelessSession(); 
```

进入这个：

```
Session session = event.getSession(); 
```

但是当我尝试使用该会话时，它会导致堆栈跟踪以 message 结尾`Session is closed`。

问题似乎是事件在事务中间触发，在导致回滚的异常情况之前，并且由于事件侦听器必须使用自己的会话，它也不会回滚。

有没有办法确保事件监听器的动作也被回滚？我是否刚刚选择了在交易中过早发生的事件？是否有一些事件发生在可能发生回滚的最后一点之后，从而确保在`AuditTrail`发生回滚时不会触发插入？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T16:22:02.123

由于没有人回复，所以我一直在自己研究，我的初步解决方案如下：

```
public class AuditListener implements PostInsertEventListener {
  private static final long serialVersionUID = -966368101369878522L;

  @Override
  public void onPostInsert(PostInsertEvent event) {
    if (event.getEntity() instanceof Auditable) {
      Session session = null;
      try {
        session = event.getPersister().getFactory().getCurrentSession();
        Auditable auditableEntity = (Auditable)event.getEntity();
        session.save(new AuditTrail(auditableEntity.getClass().getSimpleName(),
            auditableEntity.getId(), auditableEntity.getStatus(),
            auditableEntity.getLastModified()));
      } catch (HibernateException he) {
        System.out.println("Horrible error: " + he.getMessage());
        session.getTransaction().rollback();
      }
    }
  }
} 
```

请注意，我是`getCurrentSession()`从`PostInsertEvent`'s中调用 "" 的`SessionFactoryImplementor`。我不确定这是否是一个潜在的危险策略，我也不确定将那个`rollback()`电话保留在那里是否有意义，但它似乎起作用了，而且没有其他人提供过更好的解决方案。所以你去。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-08-10T18:20:00.487

我最近有一个非常相似的问题。这些问题是几年前提出的，但我认为这个答案可能对其他人有所帮助。

> 当事务期间存在任何类型的异常情况时，我遇到的问题是保留 Auditable 对象：事务回滚，但我仍然插入了 AuditTrail 记录。

在我看来，真正的问题是，在`onPostInsert`未提交事务时甚至不应该被解雇。

原来是`PostInsertEventListener`休眠中的一个错误（8年！从2006年到2014年）。参考：[https ://hibernate.atlassian.net/browse/HHH-1582](https://hibernate.atlassian.net/browse/HHH-1582)

为了向后兼容，他们通过引入新的`PostCommitInsertEventListener`. 所以我们`PostCommitInsertEventListener`现在应该使用（对于 hibernate >= v4.3.5）并且`onPostInsert`只有在事务成功提交时才会被触发

# delphi - 使用纯 API 从剪贴板保存图像

> ID：12149872
> 
> 赞同：1
> 
> 时间：2012-08-27T21:28:55.423
> 
> 标签：delphi, clipboard

我无法使用纯 API 从剪贴板保存图像。

这是我的代码。它会创建 20 个空的 bmp 文件。我已经检查了 dwSize 并且它是正确的，所以看起来我正在正确地检索数据，但我正在错误地写入文件。

```
 program WebcamTest;
  //cswi

  uses
    Windows;

  const
    WM_CAP_DRIVER_CONNECT = 1034;
    WM_CAP_GRAB_FRAME = 1084;
    //WM_CAP_SAVEDIB = 1049;
    WM_CAP_EDIT_COPY = 1054;
    WM_CAP_DRIVER_DISCONNECT = 1035;

  function SendMessageA(hWnd: Integer;
                        Msg: Integer;
                        wParam: Integer;
                        lParam: Integer): Integer;
                        stdcall;
                        external 'user32.dll' name 'SendMessageA';

  function capGetDriverDescriptionA(DrvIndex: Cardinal;
                                    Name: PAnsiChar;
                                    NameLen: Integer;
                                    Description: PAnsiChar;
                                    DescLen: Integer) : Boolean;
                                    stdcall;
                                    external 'avicap32.dll' name 'capGetDriverDescriptionA';

  function capCreateCaptureWindowA(lpszWindowName: PAnsiChar;
                                   dwStyle: Integer;
                                   x : Integer;
                                   y : Integer;
                                   nWidth : Integer;
                                   nHeight : Integer;
                                   ParentWin: Integer;
                                   nId: Integer): Integer;
                                   stdcall;
                                   external 'avicap32.dll' name 'capCreateCaptureWindowA';

  function IntToStr(i: Integer): String;
  begin
    Str(i, Result);
  end;

  var
    WebCamId : Integer;
    CaptureWindow : Integer;
    x : Integer;
    FileName : PAnsiChar;
    hData:  DWORD;
    pData:  Pointer;
    dwSize: DWORD;
    szText : AnsiString;
    FileHandle, BytesWritten : LongWord;
  begin
    WebcamId := 0;
    CaptureWindow := capCreateCaptureWindowA('CaptureWindow', 0, 0, 0, 0, 0, 0, 0);
    if CaptureWindow <> 0 then
    begin
      if SendMessageA(CaptureWindow, WM_CAP_DRIVER_CONNECT, WebCamId, 0) <> 1 then
      begin
        SendMessageA(CaptureWindow, WM_CAP_DRIVER_DISCONNECT, 0, 0);
      end
      else
      begin
        for x := 1 to 20 do // Take 20 photos.
        begin
          SendMessageA(CaptureWindow, WM_CAP_GRAB_FRAME, 0, 0);
          FileName := PAnsiChar('C:\Test' + IntToStr(x) + '.bmp');
          //SendMessageA(CaptureWindow, WM_CAP_SAVEDIB, 0, LongInt(FileName));
          SendMessageA(CaptureWindow, WM_CAP_EDIT_COPY, 0, LongInt(FileName));
          if OpenClipBoard(0) then
          begin
            hData := GetClipBoardData(CF_DIB);
            if hData <> 0 then
            begin
              pData := GlobalLock(hData);
              if pData <> nil then
              begin
                dwSize := GlobalSize(hData);
                if dwSize <> 0 then
                begin
                  FileHandle := CreateFileA(FileName, GENERIC_WRITE, FILE_SHARE_WRITE, nil, CREATE_NEW, FILE_ATTRIBUTE_HIDDEN, 0);
                  WriteFile(FileHandle, pData, dwSize, BytesWritten, nil);
                  CloseHandle(FileHandle);
                end;
                GlobalUnlock(DWORD(pData));
              end;
            end;
            CloseClipBoard;
          end;
        end;
      end;
      SendMessageA(CaptureWindow, WM_CAP_DRIVER_DISCONNECT, 0, 0);
    end;
  end. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T08:42:08.657

（ab）使用剪贴板从捕获窗口传输图像数据只是因为您想获取内存中的数据是一个非常（非常！）坏主意，因为无论如何您都在写入文件我非常热情建议您坚持使用该`WM_CAP_SAVEDIB`选项。（只是给你两个很好的理由：在剪贴板中，其他进程可以访问它：安全！；它丢弃剪贴板中的任何内容：不方便！）

但是要回答您的问题：WriteFile 将 Buffer 作为无类型参数，因此，如果您将指针传递给它，它将采用指针的*值*，而不是指向的数据，除非您指定它应该这样做，就像这样（插入符号后缀）：

```
WriteFile(FileHandle, pData^, dwSize, BytesWritten, nil); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T10:09:28.350

由于将剪贴板用于不响应用户交互的事情非常糟糕（*非常非常*糟糕），我将提供另一种方法来获取抓取的帧数据。如果您将`capCreateCaptureWindow`句柄传递给窗体的控件，则在发送`WM_CAP_GRAB_FRAME`消息后，您可以使用窗体和位图上的[`BitBlt`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd183370%28v=vs.85%29.aspx)将此数据复制到位图。`Canvas.Handle`此方法的一个重要缺点是表单需要在屏幕上可见。

# java - Hibernate - 如何提供对整数类型的正确映射？

> ID：12149874
> 
> 赞同：4
> 
> 时间：2012-08-27T21:29:21.930
> 
> 标签：java, mysql, hibernate, maven

我正在执行我的 Maven 构建，它抛出了这个异常：

`Last cause: Wrong column type in x.clients for column type. Found: tinyint, expected: integer`

我是这样映射的：

```
@Id
@GeneratedValue(strategy = GenerationType.AUTO)
private Integer id; 
```

我正在使用 InnoDB 创建列，如下所示：`id int NOT NULL UNIQUE AUTO_INCREMENT`

这不应该好吗？为什么说他正在寻找tinyint？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-06-17T10:48:24.383

我知道这个问题（真的！）老了，但是：

TINYINT 表示 8 位值。它映射到字节/字节。在这两种情况下，它的最小值为 -128，最大值为 127（含）。

SMALLINT 表示 16 位值。它映射到短/短。

INTEGER 表示 32 位值。它映射到 int/Integer。

BIGINT 表示 64 位值。它映射到长/长。

因此，您不能使用 Integer 映射 tinyint；你必须使用一个字节。

[https://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html](https://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html) [http://dev.mysql.com/doc/refman/5.7/en/integer-types.html](http://dev.mysql.com/doc/refman/5.7/en/integer-types.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T23:24:28.760

对基本整数使用[@Basic](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html_single/#entity-mapping-property)。不过，您总是可以尝试将您的 ID 声明为 Long。我通常总是使用 Long 作为我的 ID。请参阅[映射标识符属性](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html_single/#entity-mapping-identifier)：

```
@Id
@GeneratedValue(strategy = GenerationType.AUTO)
private Long id; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-07T22:01:08.197

我刚遇到这个问题，分享细节应该很有用。我的情况是：

*   你定义 @Column (... definition = "integer" )
*   Oracle 将“整数”翻译成十进制（0，-127）（或十进制（0），我还不清楚）
*   您使用“test.hibernate.hbm2ddl.auto”为“验证”的其他应用程序
*   Hibernate 报告 integer != decimal 并且验证失败

我唯一的解决方案是将 test.hibernate.hbm2ddl.auto 保持为空（未定义 = 未触及数据库）。不确定它是 Oracle 还是 Hibernate 错误（或两者兼而有之）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-27T22:59:36.287

尝试添加类型注释：

```
@Type(type = "org.hibernate.type.IntegerType") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-27T21:55:24.870

将此添加到`id`字段的注释中：

```
@Column(columnDefinition = "TINYINT") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-27T22:15:41.030

```
@Column(columnDefinition = "int") 
```

# jquery - 无法使用 jQuery aeImageResize 函数调整图像大小

> ID：12149876
> 
> 赞同：1
> 
> 时间：2012-08-27T21:29:53.803
> 
> 标签：jquery, html, css

我正在使用 jQuery aeImageResize 函数来调整我的图像大小，但它一直说 Uncought Type error: Object has no method aeImageResize 当我使用 chrome 检查元素进行调试时。是的，我收到了测试警报消息，并且在此脚本之前我确实有 jQuery 库。我使用的 jQuery 库是[http://code.jquery.com/jquery-latest.min.js](http://code.jquery.com/jquery-latest.min.js)。

```
$(function() {
alert("Testing");
$('#resizeme IMG').aeImageResize({height: 507, width: 338});

}); 
```

HTML 代码：

```
<img src="img/img2.jpg" alt="" class="resizeme" />
<img src="upload/75.jpg" alt="random image" class="resizeme" />
<img src="upload/img4.jpg" alt="random image" class="resizeme" />    
<img src="img/img3.jpg" alt="" class="resizeme" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:42:15.837

首先你必须包含插件： [https ://raw.github.com/adeelejaz/jquery-image-resize/master/jquery.ae.image.resize.js](https://raw.github.com/adeelejaz/jquery-image-resize/master/jquery.ae.image.resize.js)

你的javascript也有一点错误。您尝试选择嵌套在 ID 为“resizeme”的对象中的图像。试试吧`$('img.resizeme').aeImageResize({height: 507, width: 338});`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:35:24.157

看来 ae Image Resize 是一个插件。您是否下载了插件，是否包含对该插件的引用？ [http://archive.plugins.jquery.com/project/aeImageResize](http://archive.plugins.jquery.com/project/aeImageResize)

# javascript - Qtip2 ToolTip 未定位

> ID：12149877
> 
> 赞同：1
> 
> 时间：2012-08-27T21:29:59.870
> 
> 标签：javascript, jquery, coffeescript, qtip2

我正在运行此代码-

```
 $(".imgClass").each( (elem,value)->
      imgSrc = $(value).attr("src")
      $(value).qtip({
        content: "<img src=" + imgSrc + ">"
        position:{
            corner:{
              target:'leftTop',
              tooltip:'bottomRight'
            }

        }

        })
      ) 
```

img 显示良好，但工具提示始终位于目标的右下角，与 leftTop 相对。

我认为这可能是语法错误 - 任何人都可以帮忙吗？（另外，这是用coffeescript写的，因此没有;s，但我保留了括号，因为我仍然不清楚咖啡）

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T22:40:16.013

qTip2 不再使用这样的定位。它使用`my`and`at`参数代替。

```
position: {
    my: 'top left',
    at: 'bottom right'
} 
```

（您需要使用的实际值，但这是一般语法）。

[qTip2 定位文档](http://craigsworks.com/projects/qtip2/docs/position/)

# ios - 如何提交使用 iOS6 功能的应用程序？

> ID：12149879
> 
> 赞同：0
> 
> 时间：2012-08-27T21:30:00.713
> 
> 标签：ios, xcode, cocoa-touch

我已准备好将我的应用程序提交给苹果，但是它在 iOS 开发门户上说 xCode 4.5 还不能用于提交应用程序，请使用公开版本。xCode 4.4 不会编译我的项目，因为我正在使用一些新的 iOS 6 代码。

iOS6 在拐角处我无法提交这个似乎很奇怪。我必须删除它并提交，然后在他们允许的情况下重新提交以支持 iOS6，还是有人从 xCode 4.5 beta 4 成功提交？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:35:25.793

您不能提交链接到未发布的 SDK 的应用程序。不幸的是，事情就是这样。这是因为 API 没有被锁定并且可能会改变。

我的建议是保留使用新 API 的代码，并在 SDK 上线后重新提交。顺便说一句，这发生在实际的 iOS 版本向公众发布之前。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T21:36:21.737

您不能使用 4.5 提交。以您的说法，即您所做的是未经进一步检查的 iOS 6 功能，您目前不想提交，因为没有人拥有 iOS 6。您的应用程序无法在任何人的设备上运行。

如果您想发布 iOS 6 应用程序，请等到人们拥有 iOS 6 设备。如果您想在 iOS 6 之前发布，请确保您与 iOS 5 兼容，并且 - 现在 - 只需禁用您的 iOS 6 代码。

# sql - 模型结构

> ID：12149882
> 
> 赞同：0
> 
> 时间：2012-08-27T21:30:39.700
> 
> 标签：sql, codeigniter, data-structures, model

我需要帮助为 codeigniter 编写数据库模型。我有 2 张桌子。首先，我保存了所有产品，在第二个表中，我有产品 ID 和类别 ID。因此，例如：

餐桌**用品**

```
t-shirt with ID 1
polo shirt with ID 2 
```

表**类别**

```
shirts with ID 5 
```

表**产品_cat**

```
product_id category_id
---------- ------------
1 5
2 5
```

我如何编写模型来获取所有产品及其信息，使用表格`protucts_cat`并获取它`->result()`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T04:46:52.703

假设每个产品都映射到一个类别，我会使用**活动记录**进行简单的连接：

```
$this->db->select('product.id as product_id, product.name as name, categories.name')
$this->db->from('product p');
$this->db->join('protucts_cat pc','pc.product_id = p.id');
$this->db->join('categories c','c.id = pc.id');
$query = $this->db->get();

if($query->num_rows){
return $query->result();
}
return false; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T23:27:09.037

我倾向于在没有 AR 的情况下编写复杂的查询，但您可以使用 AR 来完成：

```
return $this->db->query('
    SELECT
        products.id AS product_id,
        products.name AS product_name,
        categories.id AS category_id,
        categories.name AS category_name
    FROM
        products_cat

    LEFT JOIN
            products
        ON
            products.id = products_cat.product_id

    LEFT JOIN
            categories
        ON
            categories.id = products_cat.category_id

    WHERE categories.id = '.$category_id.'
')->result(); 
```

# c# - 弹出警报消息 asp.net

> ID：12149883
> 
> 赞同：0
> 
> 时间：2012-08-27T21:30:39.933
> 
> 标签：c#, asp.net, visual-studio-2010, popup, barcode

我正在使用一个简单的 asp.net 条形码应用程序，当某些验证不正确时，我需要显示一条弹出消息。

问题是我的信息只有在我按下“提交”按钮两次后才有效。第一次只是重新加载页面，如果我再次按下按钮，弹出窗口就会出现！

编辑：我只是忘记添加一些细节。我正在使用 VS 2010，使用 C# 作为代码构建 Web 应用程序 asp.net。

```
public partial class Barcode : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (IsPostBack)
        {
            Validate();

            if (IsValid)
            // 
            {
                string kemet = kemetTextBox.Text;
                string sud = sudTextBox.Text;

                if (kemet.Length == 14 && sud.Length == 28) // SOME VALIDATION CONTROL
                {

                    if (kemet.Substring(1) == sud.Substring(0, 13) && kemet != "" && sud != "")
                    {

                        //resultLabel.Text = "HIGH VOLUME<br/>";
                        redImage.Visible = false;
                        greenImage.Visible = true;

                    }
                    if (kemet.Substring(1) != sud.Substring(0, 13) && kemet != null && sud != null)
                    {

                        //  resultLabel.Text = "LOW VOLUME<br/>" + kemetEd + sudEd;
                        greenImage.Visible = false;
                        redImage.Visible = true;
                    }
                }
                else
                    Button1.Attributes.Add("onClick", "javascript:alert('Message Here');"); // HERE WOULD BE THE ERROR MSG 
```

我试图让 IsPostBack 为假，但这只会让情况变得更糟。

谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:40:03.563

如果您的错误消息始终相同，一种方法是使用[CustomValidator 类ServerValidate 事件。](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx)

如果没有，请使用以下内容：

```
Page.ClientScript.RegisterClientScriptBlock(typeof(Page), Guid.NewGuid().ToString(), "alert('my message')", true); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T21:51:14.990

尝试替换这个：

```
Button1.Attributes.Add("onClick", "javascript:alert('Message Here');"); 
```

这样：

```
RegisterDOMReadyScript("alert message", "alert('Message Here');"); 
```

它使用以下辅助方法：

```
public void RegisterDOMReadyScript(string key, string script)
{
    string enclosed = EncloseOnDOMReadyEvent(script);
    ScriptManager.RegisterClientScriptBlock(this, this.GetType(), key, enclosed, true);
}

private string EncloseOnDOMReadyEvent(string str)
{
    StringBuilder sb = new StringBuilder();
    sb.Append("function r(f){/in/.test(document.readyState)?setTimeout('r('+f+')',9):f()} r(function(){")
        .Append(str)
        .Append("});");
    return sb.ToString();
} 
```

这将确保您的消息仅在[文档准备好](http://dustindiaz.com/smallest-domready-ever)后才会显示，从而防止出现难看的格式问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T21:41:02.843

您仅将错误消息分配给尚未发生的按钮单击事件，因此只有在加载页面并再次单击按钮后，您才会看到错误。

为此，您需要在页面中注册脚本：

```
ClientScript.RegisterStartupScript(Page.GetType(), "SomeKey", "alert('Message Here');", true); 
```

[http://msdn.microsoft.com/en-us/library/z9h4dk8y.aspx](http://msdn.microsoft.com/en-us/library/z9h4dk8y.aspx)

# jquery - jQuery点击功能不起作用

> ID：12149889
> 
> 赞同：0
> 
> 时间：2012-08-27T21:31:08.837
> 
> 标签：jquery

我以前见过这个问题，但我看到的所有答案都不适用于我的特定问题。我见过的大多数是由于单击未在文档就绪功能中使用引起的。setup_calenders 和 disable_items 中的所有内容都在发生，但单击复选框时不会弹出警报。

```
$(document).ready(setup)

function setup() {
$("id_Clearance").click(enable_clearance);
$("id_Paperwork").click(enable_paperwork);
$("id_AVSupport").click(enable_support);
setup_calendars();
disable_items();
}

function enable_paperwork()
{
alert("clicked");
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T21:33:22.193

您缺少`#`指示选择器应与元素 ID 匹配的标志：

```
$("#id_Clearance").click(enable_clearance);
$("#id_Paperwork").click(enable_paperwork);
$("#id_AVSupport").click(enable_support); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T21:33:31.677

这是你想要的吗？

```
function setup() {
  $("#id_Clearance").click(enable_clearance);
  $("#id_Paperwork").click(enable_paperwork);
  $("#id_AVSupport").click(enable_support);
  setup_calendars();
  disable_items();
} 
```

您需要在元素的 id 之前包含一个 # 以选择 id。只是这样的名称会寻找标签。例如：

```
<id_Clearance/> 
```

jQuery 有很好的文档：[http ://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T21:33:56.967

我可能是错的，因为我没有您的 html 源代码，但看起来您可能没有正确的 ID 选择器。

目前，您正在这样做：

```
$("id_Clearance").click(enable_clearance);
$("id_Paperwork").click(enable_paperwork);
$("id_AVSupport").click(enable_support); 
```

如果这些确实应该是页面上元素的 id，您需要将其更改为：

```
$("#id_Clearance").click(enable_clearance);
$("#id_Paperwork").click(enable_paperwork);
$("#id_AVSupport").click(enable_support); 
```

注意选择器开头的#。这就是用来选择一个id的。

# javascript - 在 jQuery 动画效果中将 backgroundColor 替换为 backgroundImage

> ID：12149893
> 
> 赞同：0
> 
> 时间：2012-08-27T21:31:36.387
> 
> 标签：javascript, jquery, html, css, jquery-animate

我在这里有一个工作淡入/淡出 jQuery 示例：http: [//jsfiddle.net/mcgarriers/NJe63/6/](http://jsfiddle.net/mcgarriers/NJe63/6/)

但是，我想知道是否可以用**背景图像替换****背景色红色效果**？

 **非常感谢您的任何指点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:37:00.117

你可以用 CSS3 做到这一点。您可以在图像周围创建一个您选择大小的 div 标签，然后使用基本的 CSS3 过渡。

```
 #yourdiv a {
     background-color: #FFF;
}

#yourdiv a:hover {
     background-color: #000;
     -webkit-transition: background-color 600ms linear;
     -moz-transition: background-color 600ms linear;
     -o-transition: background-color 600ms linear;
     -ms-transition: background-color 600ms linear;
     transition: background-color 600ms linear;
} 
```

或者您可以使用 CSS3 将图像淡入另一个：http: [//css3.bradshawenterprises.com/cfimg1/](http://css3.bradshawenterprises.com/cfimg1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T21:39:03.320

试试这样的东西怎么样？

我更改了您的 jsfiddle 链接中的代码。

```
$('.box').mouseenter(function(){
    $(this).stop().animate({opacity: 0}, 0).css('background', 'url(http://static.tvtropes.org/pmwiki/pub/images/Hello_Kitty_Pink_2981.jpg)').animate({ opacity: 1 }, 1000);
}).mouseleave(function(){
    $(this).stop().animate({opacity: 1}, 0).css('background', 'white');
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T21:48:11.017

您不能淡入/淡出 HTML 元素的背景图像，但可以使用背景颜色。

这可能是您的解决方案吗？[使用jQuery淡入淡出背景图像？](https://stackoverflow.com/questions/5533171/fade-background-image-in-and-out-with-jquery)**

# event-handling - 是否可以使用 addEventHandler 方法将 ActionEvent 处理程序添加到 javaFX 文本字段？

> ID：12149898
> 
> 赞同：4
> 
> 时间：2012-08-27T21:32:29.540
> 
> 标签：event-handling, textfield, javafx-2

我尝试使用 addEventHandler() 将操作处理程序添加到文本字段，但似乎不起作用。它甚至可能是一个错误吗？如果我尝试使用 Button 控件，一切都很好。

这是示例代码：

```
package com.teste;

import javafx.application.Application;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.scene.Scene;
import javafx.scene.control.TextField;
import javafx.scene.layout.StackPane;
import javafx.stage.Stage;

public class EventHandlerTest extends Application {

@Override
public void start(Stage stage) throws Exception {
    // TODO Auto-generated method stub
    stage.setTitle("Custom JavaFX Event");
    TextField btn = new TextField();
    btn.setId("Fire Button");
    btn.setText("Fire MyEvent'");

    btn.addEventHandler(ActionEvent.ACTION, new EventHandler<ActionEvent>() {

        @Override
        public void handle(ActionEvent event) {

            if (event.getEventType().equals(ActionEvent.ACTION)) {
                System.out.println("ActionEvent 2");
            }
        }     
    }); 

    StackPane root = new StackPane();
    root.getChildren().add(btn);
    stage.setScene(new Scene(root, 300, 250));
    stage.show();
}

/**
 * @param args
 */
public static void main(String[] args) {
    // TODO Auto-generated method stub
    launch(args);
}

} 
```

文档说这应该是可能的，但找不到其他任何东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T22:54:27.453

如果您使用[setOnAction](http://docs.oracle.com/javafx/2/api/javafx/scene/control/TextField.html#setOnAction%28javafx.event.EventHandler%29)而不是[addEventHandler](http://docs.oracle.com/javafx/2/api/javafx/scene/Node.html#addEventHandler%28javafx.event.EventType,%20javafx.event.EventHandler%29)，那么您将能够捕获 TextField 的 ActionEvent。

```
btn.setOnAction(new EventHandler<ActionEvent>() {
    @Override public void handle(ActionEvent event) {
        System.out.println("ActionEvent: " + event);
    }     
}); 
```

我不知道为什么 addEventHandler 代码没有捕获事件。我也尝试了 addEventFilter ，但这对我也不起作用（JavaFX 2.2）。

请注意，当您在 TextField 上按 Enter 键时，TextField 将生成一个 ActionEvent。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-17T13:35:25.410

在 java 8 中现在是可能的

```
btn.addEventHandler(ActionEvent.ACTION, new EventHandler<ActionEvent>() {
        @Override
        public void handle(ActionEvent event) {
        System.out.println("ActionEvent: " + event);
        }
    });

//Lambda Notation
btn.addEventHandler(ActionEvent.ACTION, event -> {
        System.out.println("ActionEvent: " + event);
    }); 
```

# php - 银条：SS_DAG_CyclicException。DAG 有循环要求

> ID：12149900
> 
> 赞同：0
> 
> 时间：2012-08-27T21:32:52.317
> 
> 标签：php, silverstripe

我刚刚将几个站点从早期版本的 SS3 升级到了 3.0 稳定版本（CMS 和 Sapphire）。现在，当我尝试开发/构建时，出现以下错误：

```
PHP Fatal error:  Uncaught exception 'SS_DAG_CyclicException' with message 'DAG has cyclic requirements' in /Users/fraser/Documents/Work/HallPass/sapphire/core/DAG.php:73
Stack trace:
#0 /Users/fraser/Documents/Work/HallPass/sapphire/core/manifest/ConfigManifest.php(272): SS_DAG->sort()
#1 /Users/fraser/Documents/Work/HallPass/sapphire/core/manifest/ConfigManifest.php(144): SS_ConfigManifest->sortYamlFragments()
#2 /Users/fraser/Documents/Work/HallPass/sapphire/core/manifest/ConfigManifest.php(75): SS_ConfigManifest->regenerate(false)
#3 /Users/fraser/Documents/Work/HallPass/sapphire/core/Core.php(275): SS_ConfigManifest->__construct('/Users/fraser/D...', false, false)
#4 /Users/fraser/Documents/Work/HallPass/sapphire/main.php(62): require_once('/Users/fraser/D...')
#5 {main}
  thrown in /Users/fraser/Documents/Work/HallPass/sapphire/core/DAG.php on line 73 
```

其他一切都很好，但是只是当我在 /dev 中做任何事情时。我做了一些更改，需要在这些站点上重新生成清单。

我也尝试过全新安装 SS 并遇到同样的问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T21:00:20.537

这是 CMS 和 Sapphire 代码中的错误。我在 open.silverstripe.org 上提出了这个问题，它已经得到纠正。#7817 on open.silverstripe.org

# sharepoint - Sharepoint 2010 Web 部件不在一个网站上显示，但在另一个网站上

> ID：12149901
> 
> 赞同：0
> 
> 时间：2012-08-27T21:33:02.767
> 
> 标签：sharepoint, sharepoint-2010, web-parts

我正在改造我的公司现有的 Sharepoint 网站。我安装了 SP ZAP Slideshow webpart 并转到 sharepoint 站点插入它，并且绝对没有列出任何 webpart。我进入了提供的 Sharepoint 2010 中央管理，并意识到一切似乎都被列为

```
//usmvwc0wtf1srv.ww005.work.net/sitepages/ 
```

当网站托管时，它应该列出的是

```
//usmvwc0wtf1srv.ww005.work.net/sites/ 
```

我去了 /sitepages 网站，所有的 webparts 都存在并且可以工作，但是我需要让他们在 /sites 页面上工作。有什么方法可以切换它，这样它就不会默认我上传到错误页面的所有 webpart 和内容？我觉得好像列出了错误的默认页面？对不起，这一切都是新手！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:32:24.430

Web 部件来自网站集中的 Web 部件库。当您激活其网站集范围功能时，它们通常会安装到库中。检查您没有在新网站集中激活哪些功能 - 我怀疑其中之一负责安装您正在寻找的 Web 部件。（该功能的范围可以是网站集或网站 - 检查两者。）

# expand - Qt：ProxyModel、QTreeView 和带过滤的委托设置无法正确更新

> ID：12149902
> 
> 赞同：1
> 
> 时间：2012-08-27T21:33:06.483
> 
> 标签：expand, qtreeview, qabstractitemmodel, qsortfilterproxymodel, qstyleditemdelegate

我有一个 QTreeView 设置显示 QSortFilteredProxyModel 在 filterAcceptsRow() 中自定义过滤，只接受取决于父行值的值的行（通过 QStyledItemDelegate 派生类在 QComboBox 中选择。例如，如果我在一行中选择“类型” 值“宝马”，我想为这个特殊情况显示孩子。这对第一个项目很有用，我可以在 Item1 中选择这些值多个级别（最多 5 个级别）。一切都很好。

但是，我注意到，一旦我使用 item1 和此自定义过滤，然后添加 item2，问题就开始了。我注意到的第一件事是，QTreeView 确实取消了 item1/item2 的公共父项，并且只显示了根项的子项。正常行为（以及添加 item1 的行为确实如此）是扩展 item1 的父项。为什么这会对第二个项目感到困惑，并且只有当我一直在玩 item1 的儿童设置 idk 时。此外，我注意到在 item2 中过滤无法正常工作。我在 item2->Type 中有一个 QComboBox，其子项取决于 item2->Type 值。. QComboBox 的默认值的第一个子项仍会按应有的方式显示，但是在更改 QComboBox 时，视图不再更新，并且留在 item2/item3/... 中的第一个加载的子项 但是，使用正确的值/索引调用 Delegate::setModelData 并相应地调用 TreeItem->setData() 。只是过滤似乎卡在了 TreeItem->data() 的旧值上。请再次注意，这只发生在我玩过 item1 之后。如果我不碰那个项目，我可以正确玩所有其他项目（item2，item3，...）并且它做得很好。

如果有人可以提供帮助，我将非常高兴。

有没有人给我提示，什么可能导致扩展状态的“重置”，即使 expand() 被称为 item1 和 item2 插入并且对 item1 很好用？什么可能导致我的进一步问题？

ExampleDelegate.h

```
类 ExampleDelegate ：
    公共 QStyledItemDelegate
{
    Q_OBJECT
    上市：
        ExampleDelegate(QObject* parent = 0);
        ~ExampleDelegate(void);
        QWidget* createEditor(QWidget *parent, const QStyleOptionViewItem &option, const QModelIndex &index) const;
        void setModelData(QWidget *editor, QAbstractItemModel *model, const QModelIndex &index) const;
        void setEditorData(QWidget* editor, const QModelIndex &index) const;
}
```

代理模型.h

```
类代理模型：
    公共 QSortFilterProxyModel
{
    Q_OBJECT    
    上市：
        ProxyModel(QObject *parent);
        〜代理模型（无效）；
        无效刷新（）；
        无效doReset（）；

        pthread_mutex_t* proxyMutex；

        int rowCount(QModelIndex& parent) const;
        bool hasChildren ( const QModelIndex & parent = QModelIndex() ) const;
        QModelIndex parent(const QModelIndex &index) const;
        QModelIndex index(int row, int col, QModelIndex& parent) const;
            bool filterAcceptsRow(int sourceRow, const QModelIndex &sourceParent) const;

};

```

代理模型.cpp

```
bool ProxyModel::filterAcceptsRow(int sourceRow, const QModelIndex &sourceParent) const {
    printf("ProxyModel::filterAcceptRow \n");
    pthread_mutex_lock(this->proxyMutex);

    QAbstractItemModel* source = this->sourceModel();
    QModelIndex index = source->index(sourceRow, 0, sourceParent);
    TreeItem* item = ((TreeItem*) index.internalPointer());
    如果（项目！= NULL）{
        int showOnly = item->showOnlyParentDetailDialog;
        如果（仅显示！= -1）{
            TreeItem* parent = ((TreeItem*) index.internalPointer())->parent();

            如果（父！= NULL）{

                int parentOption = parent->selectedIndex;
                //printf("parentOption: %u \n", parentOption);
                bool result = (showOnly == parent->selectOptions->at(parentOption).detailDialog);

                pthread_mutex_unlock(this->proxyMutex);
                返回结果；
            } 别的 {
                pthread_mutex_unlock(this->proxyMutex);
                返回真；
            }   
        }
    }
    pthread_mutex_unlock(this->proxyMutex);
    返回真；
}

```

# winapi - ValidateRect 与 BeginPaint

> ID：12149906
> 
> 赞同：4
> 
> 时间：2012-08-27T21:33:23.077
> 
> 标签：winapi

从 MSDN 文档：

> 该`BeginPaint`函数验证整个客户区。
> 
> `ValidateRect`如果必须在生成下一条 WM_PAINT 消息之前验证更新区域的一部分，则不应调用该函数。[1](http://msdn.microsoft.com/en-us/library/ms914091.aspx)

多年来我一直在使用 Win32 API 进行编程，但我从未想过要调用该`ValidateRect`函数。今天我的一位同事指出，我们错过了对 的调用`ValidateRect`，它修复了我们使用 GDI 进行高速动画时遇到的错误（我知道，一个矛盾的说法）

有人可以告诉我在/对`ValidateRect`之后是否需要调用 to ？我在 MSDN 上没有看到任何说明这一点的文档，而且我看到的哪些文档和示例表明不需要调用。`BeginPaint``EndPaint``ValidateRect`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:36:04.983

这不是必需的。`BeginPaint`在验证区域时使用，因为您在`WM_PAINT`.

`ValidateRect`更多的是“取消失效”，通常在没有或因为某些更改而直接在窗口上绘制之后`WM_PAINT`，您不再希望发出 pending `WM_PAINT`。

它修复了一个错误这一事实可能意味着发生了其他事情，而这意外地修复了它（可能是通过减少`WM_PAINT`消息的数量？），或者错误的观察结果（例如，你改变了两件事，但这一件事引起了人们的注意，而不是其他是实际修复）。

# performance - Ext.grid.Panel 垂直滚动在 Mozilla Firefox 中非常慢

> ID：12149920
> 
> 赞同：1
> 
> 时间：2012-08-27T21:34:55.920
> 
> 标签：performance, firefox, extjs, grid, extjs4

我有一个大约 10 列的网格面板，在我的数据存储中大约有 1000 条记录。因为可见记录的数量少于数据存储记录的数量，所以我在网格面板中得到了一个垂直滚动条。当网格在 Internet Explorer 9 或 Google Chrome 中显示时，当我使用鼠标滚轮时，垂直滚动条移动得很好而且很快。但在 Mozilla Firefox 中，它的滚动速度非常慢。每一次完整的手指拉动只允许看到一个额外的记录/行，或者更少。

我怎样才能解决这个问题？

我正在使用 Mozilla Firefox 14.0.1

**下午 5:21 更新**.. 分页工具栏未显示

```
 var store = new Ext.data.Store({

        pageSize: 50,
        // allow the grid to interact with the paging scroller by buffering
        buffered: true,
        // never purge any data, we prefetch all up front
        purgePageCount: 0,
        model: 'Project',
        //proxy: {
        //    type: 'memory'
        //},

        proxy: new Ext.ux.AspWebAjaxProxy({
            url: '/Controls/ProjectList/ProjectListService.asmx/GetProjectList',
            actionMethods: {
                create: 'POST',
                destroy: 'DELETE',
                read: 'POST',
                update: 'POST'
            },
            reader: {
                type: 'json',
                model: 'Project',
                root: 'd'
            },
            headers: {
                'Content-Type': 'application/json; charset=utf-8'
            }
        }),
        autoLoad: true
    });

Ext.define('Ext.ux.AspWebAjaxProxy', {
    extend: 'Ext.data.proxy.Ajax',
    require: 'Ext.data',

    buildRequest: function (operation) {
        var params = Ext.applyIf(operation.params || {}, this.extraParams || {}),
                                request;
        params = Ext.applyIf(params, this.getParams(params, operation));
        if (operation.id && !params.id) {
            params.id = operation.id;
        }

        params = Ext.JSON.encode(params);

        request = Ext.create('Ext.data.Request', {
            params: params,
            action: operation.action,
            records: operation.records,
            operation: operation,
            url: operation.url
        });
        request.url = this.buildUrl(request);
        operation.request = request;
        return request;
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T23:27:39.777

为了回答您的第一个问题，Firefox 从版本 13 开始将“平滑滚动”作为默认配置。ExtJS 4.1.0 没有考虑到这一点，但这是在 4.1.1 中处理的。您必须升级才能处理它，或者您可以将它从 4.1.1 代码中拼凑出来。

看看[**这个**](http://www.sencha.com/forum/showthread.php?215624-Firefox-13-new-default-smooth-scrolling-leads-to-very-slow-grid-scrolling/page2&langid=4)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T21:59:26.890

中的缓冲区设置`Ext.data.Store`可能会有所帮助。

```
var store = Ext.create('Ext.data.Store', {
    id: 'store',
    pageSize: 50,
    // allow the grid to interact with the paging scroller by buffering
    buffered: true,
    // never purge any data, we prefetch all up front
    purgePageCount: 0,
    model: 'ForumThread',
    proxy: {
        type: 'memory'
    }
}); 
```

[http://dev.sencha.com/deploy/ext-4.0.0/examples/grid/buffer-grid.html](http://dev.sencha.com/deploy/ext-4.0.0/examples/grid/buffer-grid.html)

我已经在 Firefox 上测试了该示例，它比 chrome 慢一点，但可以使用。

如果它仍然太慢，也许应该将分页添加到网格中。

[http://dev.sencha.com/deploy/ext-4.0.0/examples/grid/paging.html](http://dev.sencha.com/deploy/ext-4.0.0/examples/grid/paging.html)

# ios - 使用 MBProgressHUD 断言失败 - 视图不能为零

> ID：12149922
> 
> 赞同：12
> 
> 时间：2012-08-27T21:35:07.183
> 
> 标签：ios, ios5, uiview, uiviewcontroller, mbprogresshud

我正在尝试`MBProgressHUD`在应用程序中使用。在将 HUD 添加到视图时出现错误。

这是将进度条添加到视图的代码。

```
HUD = [[MBProgressHUD alloc] initWithView:self.navigationController.view];
[self.view.window addSubview:HUD];

// Set determinate mode
HUD.mode = MBProgressHUDModeAnnularDeterminate;

HUD.labelText = @"Loading";

// myProgressTask uses the HUD instance to update progress
[HUD showWhileExecuting:@selector(processFieldEntries) onTarget:self withObject:nil animated:YES]; 
```

应用程序错误：

```
*** Assertion failure in -[MBProgressHUD initWithView:], /Users/.../MBProgressHUD/MBProgressHUD.m:190 
```

还

```
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'View must not be nil.' 
```

和

```
Crash: View must not be nil. 
```

有谁知道断言失败是为了什么以及如何解决。MBProgressHUD.m 文件包含在 Build Phases 选项卡下的 Compile Sources 中，并且文件中包含标题。正在将进度添加到处理字段验证的过程中。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-28T03:25:52.557

您好，这里有一个关于 HUD 显示的快速提示。

首先，不要试图在这里翻转，但请确保如果您正在为导航控制器初始化 HUD，那么您有一个 - 或其他任何东西。请注意，您将 HUD 贴在您的视图中越高，越多的交互将被禁用并被 HUD 覆盖（这通常是一件好事）。

因此，例如，如果您在基本视图控制器或模式等中执行以下操作：

```
HUD = [[MBProgressHUD alloc] initWithView:self.view];
[self.view addSubview:HUD]; 
```

请注意，您正在将其添加到您初始化它的同一视图中。

另请注意，您也可以将其填充到其他视图中，例如：self.navigationcontroller.view、self.splitviewcontroller.view 或我最喜欢的：self.splitviewcontroller.view.superview（以覆盖和禁用视图的两侧）。

我认为如果您按照应用程序的正确视图遵循 init 示例，您的问题将自行解决。

好起来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T22:22:40.090

您在哪里使用该代码段？如果您提供一些其他详细信息，我可以帮助您。同时，等待一些细节，我可以给你一些关于你的问题的提示。

我想当你创建`MBProgressHUD`

```
HUD = [[MBProgressHUD alloc] initWithView:self.navigationController.view]; 
```

您的`view`导航控制器是`nil`，因此是问题所在。

如果您浏览`MBProgressHUD`代码 ( [MBProgressHUD.m](https://github.com/jdg/MBProgressHUD/blob/master/MBProgressHUD.m) )，您可以看到有这样的控制检查：

```
NSAssert(view, @"View must not be nil."); 
```

因此代码停止，因为它没有通过控制。

要使其正常工作，您需要通过一个非`nil` `view`.

如果您创建了一个扩展`UIViewController`（例如）的类，则可以在`viewDidAppear`方法中显示 HUD。在那里你确定`view`你的视图控制器已经被创建和显示了。

或者，将 HUD 添加为窗口的子视图。有关更多信息，您可以看到[MBProgressHUD 未显示](https://stackoverflow.com/questions/5522079/mbprogresshud-not-showing)。

希望有帮助。

# oracle - Oracle 报告 SELECT INTO 未选择

> ID：12149926
> 
> 赞同：1
> 
> 时间：2012-08-27T21:35:46.933
> 
> 标签：oracle, triggers, oraclereports

我正在编写 Oracle Reports Builder 中的报告，但我的 AFTERPFORM 触发器有问题。查看报告时，似乎年份正在正确处理，而期间和子期间正在使用它们的初始值。我很困惑，因为它们是完全相同的选择语句，但没有按预期工作。任何帮助将不胜感激！

```
function AfterPForm return boolean is
  v_subpdenddt_user date;
  v_subpdenddt_max date;
  v_rowcount integer;
begin

select value into year from wos_report_param where parameter = 'year' and sequence_num = :sequencenum;
select value into period from wos_report_param where parameter = 'period' and sequence_num = :sequencenum;
select value into user_subpd from wos_report_param where parameter = 'subpd' and sequence_num = :sequencenum; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-20T04:38:51.923

您必须检查变量数据类型是否与数据库列匹配？

尝试更改上面的代码以使用 varchar2 变量，然后如果要处理日期，则将 varchar2 转换为日期，如果要处理数字，则将其转换为数字。

# shell - 编写一个 shell 脚本 if 语句来检查目录

> ID：12149928
> 
> 赞同：0
> 
> 时间：2012-08-27T21:35:57.480
> 
> 标签：shell, package, uninstallation, dpkg

我需要编写一个脚本，如果我从中删除一个包时它被删除，它将重新创建我的 opt 文件夹。这是我之前帖子的链接：[dpkg remove to stop processes](https://stackoverflow.com/questions/12148273/dpkg-remove-to-stop-processes)

现在，我遇到的问题可以在这里更好地描述：http: [//lists.debian.org/debian-devel/2006/03/msg00242.html](http://lists.debian.org/debian-devel/2006/03/msg00242.html)

我正在考虑添加一个 postrem 脚本来检查 opt 目录是否存在，如果不存在，则创建一个。不过，我对 shell 脚本的经验非常有限..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:37:32.737

```
[ -d "$dir" ] || mkdir -p "$dir" 
```

这可以写得更详细/更清楚：

```
if ! test -d "$dir"; then
    mkdir -p "$dir"
fi 
```

有关`help test`更多信息，请参阅。

# php - 将大型json字符串存储到数据库+哈希

> ID：12149931
> 
> 赞同：1
> 
> 时间：2012-08-27T21:36:05.123
> 
> 标签：php, mysql, caching

我需要在我的数据库中存储大型（30K 未压缩）JSON 字符串。我正在使用 gzip 压缩字符串，因此使用 MySQL 的 BLOB 数据类型来存储它。但是，只有 5% 的请求包含唯一数据，并且只有唯一数据需要存储在数据库中。

我的方法如下。

1.  `array_multisort`数据（数组`[a, b, c]`实际上与 相同`[a, c, b]`）。
2.  `json_encode`数据（`json_encode`比 快；我们需要第**3**`serialize`步的字符串数组表示）。
***   `sha1`数据（比 慢`md5`，但不太可能发生冲突）。*   检查数据库中是否存在哈希。*   *   存在：不插入数据。
    *   新：gzip 数据并将其存储在散列中。**

 **这有什么（除了首先将 JSON 数据存储到数据库之外）听起来很可疑或应该以不同的方式完成吗？

该数据库每月创建大约 1kk 条唯一记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T22:18:36.877

在我看来，您正在做的是某种 L2/持久/分布式缓存。

整个过程是非常正确的，但是您应该考虑使用适合您的环境并具有最佳性能的哈希算法。

MD5 有 128 位，而 SHA-1 有 160 位。差别很大！虽然 MD5 可能有 2^128 (~3.4x10^38)，但 SHA-1 可能有 2^160 (~1.4x10^48)。您认为使用 MD5 会发生冲突吗？

在*最好的情况下*，假设每月有 100 万条唯一记录 (10^6)，您将需要大约 3.4x10^32 个月才能发生冲突。当然，这些都是理论值，即使 MD5 在 2^128 上分布不均。

此外，如果您认为应该丢弃旧值（如 LRU 算法），因为它们不再与存储相关，您甚至可以使用更简单、更快的哈希算法。

如果无论如何，性能和/或存储容量都不是问题，请坚持使用 SHA-1，它的持续时间要长得多，碰撞的可能性要小得多。

干杯!**

# c# - LINQ 等效查询

> ID：12149932
> 
> 赞同：1
> 
> 时间：2012-08-27T21:36:18.057
> 
> 标签：c#, linq, list, dictionary, linq-to-objects

我有一个

```
 List<string>     

List<string> students; 
students.Add("123Rob"); 
students.Add("234Schulz"); 
```

和一个

```
Dictionary<string,string> 

Dictionary<string, string> courses = new Dictionary<string, string>(); 
courses .Add("Rob", "Chemistry");   
courses .Add("Bob", "Math");  
courses .Add("Holly", "Physics"); 
courses .Add("Schulz", "Botany"); 
```

我现在的目标是获得一个包含值的列表 - `{Chemistry,Botany}`。

换句话说，我试图获得 LINQ 等价于

```
select value from [courses]
where [courses].key in 
(
select [courses].key from courses,students where [students].id LIKE '%courses.key%'
) 
```

应该如何构建 LINQ 查询？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T21:41:08.723

这是正确的答案：

```
var values = from c in courses
             where students.Any(s => s.IndexOf(c.Key, StringComparison.OrdinalIgnoreCase) >= 0)
             select c.Value; 
```

在我的机器上测试。希望这能有所帮助。

# php - php中的关键字new是否意味着在堆上分配内存？

> ID：12149934
> 
> 赞同：5
> 
> 时间：2012-08-27T21:36:30.593
> 
> 标签：php

php中的关键字new是否意味着在堆上分配内存？前任。

```
class person {
    // properties and methods
}

$p1 = new person(); 
```

有没有办法像在 c++ 中一样在 PHP 中的堆栈中创建对象？
前任。

```
class person {
    // properties and methods
}

//inside in main stack
int main() {
person p1; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T21:50:38.470

在幕后，当您使用“new”关键字创建对象时，您正在创建一个 zval。用于在核心库和扩展中创建 zval 的宏为 zval 分配内存，所以答案是肯定的，在 PHP 中创建对象会导致创建存储在堆上的对象。事实上，所有类型的 PHP 变量都是幕后的 zval（这便于转换），因此它们实际上都存储在堆上。

如果要将数据存储在堆栈上，最好使用不同的语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T21:43:46.010

答案是肯定的。

此外，您不应该控制 PHP 控制内存的方式。这是 PHP 等高级语言的一部分。请注意，C++ 是一种非常低级的语言（语言本身不考虑不同的操作系统，您必须为不同的操作系统编写不同的代码（您可以使用库，ofc，为您做到这一点））。

# sql - 数据库建模 - 多对多中的非此即彼

> ID：12149935
> 
> 赞同：1
> 
> 时间：2012-08-27T21:36:42.423
> 
> 标签：sql, sql-server-2008, database-design

在我试图建模的多对多关系中，我有一种非此即彼的情况。

所以我有这些表：

```
Message
----
*MessageID
MessageText

Employee
----
*EmployeeID
EmployeeName

Team
----
*TeamID
TeamName

MessageTarget
----
MessageID
EmployeeID (nullable)
TeamID (nullable) 
```

因此，a`Message`可以有一个`Employee`s 列表，也可以有一个 s 列表`Team`作为 a `MessageTarget`。`MessageTarget`我上面的表格是实现这种关系的最佳方式吗？我可以有效地施加哪些限制`MessageTarget`？我应该如何在表上创建主键`MessageTarget`？

有问题的数据库是 SQL Server 2008

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:55:48.850

你呈现这个的方式，似乎`Employee` *is-a* `MessageTarget`和`Team` *is-a* `MessageTarget`。
所以 a`Message`有 a`Target`要么是a 要么是`Employee`a `Team`。
在我看来，这就像 SQL 中的继承（或组合）问题。
查看“[在 SQL Server 中实现表继承](http://www.sqlteam.com/article/implementing-table-inheritance-in-sql-server)”。An本身`Employee`不是一个`MessageTarget`，但也许这方面的读数可以帮助您进行建模

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T04:26:46.630

因此，您要确保单个消息的 MessageTargets 都设置了 employeeID 或 teamID，但不是两者的混合？

根据您的 RDBMS，您可能能够创建物化视图并对其施加约束。视图看起来像

```
select messageId, count(employeeId), count(teamId) from messageTarget 
```

在此之上，您将放置一个检查约束，以确保其中一个计数为零。

或者，您可以将 MessageTarget 替换为两个表：EmployeeMessageTarget 和 TeamMessageTarget，每个表在第一个表中只包含一个 TargetId 和一个 EmployeeId，在第二个表中包含一个 TeamId。

您的 Message 表将获得两个新字段：一个 EmployeeMessageTargetId 和一个 TeamMessageTargetId 加上一个检查约束，确保其中至少一个为空。如果您使两个字段都唯一，则可以从 *MessageTarget 表中获得一个外键。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T15:50:24.050

由于员工和团队不能混合在同一条消息中，您需要执行以下操作：

![在此处输入图像描述](../Images/cf3f3ac8c198a2ab9d32c5ed0a553368.png)

*   `MessageEmployee.MessageIdForEmployee`参考资料`Message.MessageIdForEmployee`。
*   `MessageTeam.MessageIdForTeam`参考资料`Message.MessageIdForTeam`。

并且表上有以下约束`Message`：

```
CHECK (
    (MessageIdForEmployee = MessageId AND MessageIdForTeam IS NULL)
    OR
    (MessageIdForEmployee IS NULL AND MessageIdForTeam = MessageId)
) 
```

请注意我们如何为每种子表创建一个单独的联结表，并且联结表**不**引用父级的 PK。相反，每个联结表都引用一个**单独**的UNIQUE 字段。由于这些字段中只有一个可以为非 NULL，因此只有一种子项可以连接到任何给定消息。

`MessageId`注意：与`MessageIdForEmployee`or匹配并不是绝对必要的`MessageIdForTeam`，但它可以在一定程度上简化查询。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-27T21:52:16.690

你也可以考虑

```
MessageTarget
----
MessageID
targetID (not nullable)
targetType 
```

然后将类型设置为应为的类型...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-28T00:59:56.917

is-a 关系通常是 gen-spec 模式的实例。类表继承是为 gen-spec 的情况设计表的一种方法。

[http://martinfowler.com/eaaCatalog/classTableInheritance.html](http://martinfowler.com/eaaCatalog/classTableInheritance.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-28T04:12:14.397

考虑删除 MessageTarget 实体中的“团队 ID”字段，以便您只有 messageId 和 employeeId。为了满足团队的需求（如果要求每个员工必须是团队的成员），您可以拥有另一个实体“团队消息”，其中数据库触发器将确保在插入该表时，您可以插入一个团队中每个员工的消息目标表中的行。这样，您可以方便地从每条消息链接回 MessageTarget 表中的员工或返回“团队消息”表中的团队。还将在 ORM 框架中提供方便的访问，其中 Employee 实体仅具有 List 并且 Team 也具有相同的

# xml - 使用 VBA 从 Excel 创建基于 xPath 的 xml 文件

> ID：12149941
> 
> 赞同：1
> 
> 时间：2012-08-27T21:37:13.190
> 
> 标签：xml, xpath, excel, vba

我发现了一些似乎围绕着我想做的事情跳舞的项目。我不是一个成熟的程序员，但一直在 Excel 中创建自己的宏。我现在正在尝试创建一个可以帮助我创建 XML 文件结构的文件。

对于这种情况，我有一列 Xpath 和一个关联值。我想查看 XPath 列表，并为每一个根据需要在路径中创建任何父级以及子级及其值。我将添加另一个方面以将其过滤到我想要的字段，但我正在努力的部分是检查每个父节点是否存在的逻辑，如果需要创建它，然后添加子节点及其值。

如果输出文件被格式化为新行上的每个节点，那么如果它的子节点从父节点缩进则更是如此，但创建它是我的主要关注点。任何帮助将不胜感激，这有可能为我节省大量时间。

* * *

更新：我在这方面取得了进展，并且能够创建一个小示例文件。我仍然不确定是否有办法使用换行符和/或制表符缩进格式化文件，但我认为创建文件的主要部分正在进行中。我仍然需要看看如何处理迭代节点。以下是我目前的内容，如果有人有任何批评，欢迎：

```
Sub main()
    Dim xmldoc As New DOMDocument60
    Dim xpath As String
    Dim outPath As String
    outPath = "c:\temp\test.xml"

    'just a small sample for now, xpaths in column 2 on spreadsheet
    For i = 2 To 5
        'xpaths I have leave off root element, so I add it here
        xpath = "session/" & Cells(i, 2).Value
        Call makeXPath(xmldoc, xpath)
    Next
    xmldoc.Save outPath
End Sub
Private Sub makeXPath(xmldoc As DOMDocument60, xpath As String)
    Dim partsOfPath() As String
    Dim oNodeList As IXMLDOMNodeList
    Dim strXPathQuery As String
    Dim sParent As String
    Dim objRootElem As IXMLDOMElement
    Dim objMemberElem As IXMLDOMElement
    Dim objMemberName As IXMLDOMElement
    Dim objParent As Object

    Set objParent = xmldoc

    partsOfPath = Split(xpath, "/")

    For i = LBound(partsOfPath) To UBound(partsOfPath)
        If strXPathQuery > "" Then strXPathQuery = strXPathQuery & "/"
        strXPathQuery = strXPathQuery & partsOfPath(i)

        Set oNodeList = xmldoc.SelectNodes(strXPathQuery)

        If oNodeList.Length = 0 Then
            'if I don't have the node, create it
            Set objMemberElem = xmldoc.createElement(partsOfPath(i))
            objParent.appendChild objMemberElem
            'setting the parent for the next element of the path
            Set objParent = objMemberElem
        Else
            'setting parent to first iteration, until I make adjustment otherwise later
            Set objParent = oNodeList.Item(0)
        End If

    Next
End Sub 
```

* * *

Update2 - 这是一个 xpath 示例和具有第二次地址迭代的示例输出：

```
data/account/AcctNumber
data/account/Phone
data/account/address/Address1
data/account/address/City
data/account/address/State
data/account/address/ZIP
data/account/address/AddressType

<data>
    <account>
        <AcctNumber>
        <Phone>
        <address>
            <Address1 />
            <City />
            <State />
            <ZIP />
            <AddressType />
        </address>
        <address>
            <Address1 />
            <City />
            <State />
            <ZIP />
            <AddressType />
        </address>
    </account>
</data> 
```

# git - 如何简单地为 git 中的一个变更集获取补丁？

> ID：12149944
> 
> 赞同：0
> 
> 时间：2012-08-27T21:37:16.700
> 
> 标签：git, syntax

[git revision](http://git.kernel.org/?p=git/git-htmldocs.git;a=blob_plain;f=gitrevisions.html;hb=HEAD)语法非常强大，但我找不到如何简化诸如：

```
git diff 1a2e^..1a2e 
```

不写两次tree'sh1？

现在是否有“NEXT”语法，例如：

```
git diff 1a2e^..NEXT 
```

或者

```
git changeset 1a2e 
```

??

如果 1a2e 是已知修订版，则另一种“下一个”语法可能有用：

```
git cherry-pick 1a2e+NEXT..origin/featureBranch 
```

^^ “樱桃从 1a2e 中挑选任何东西来掌握除了 1a2e 本身”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:38:22.937

```
git show <tree-ish> 
```

例如。

不，您不能参考子提交，父级对此一无所知。并且可能有不止一个，没有特定的顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:51:58.390

你可以做到`git log -1 -p sha1`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T22:51:35.747

我已经构建了一个 q'n'd 解决方法[git-getnext](http://code.childno.de/marcel/src/master/bin/git-getnext) 它将从 git log 获取当前分支中的子 ID

# javascript - JavaScript：返回 NAN 的函数

> ID：12149945
> 
> 赞同：3
> 
> 时间：2012-08-27T21:37:17.207
> 
> 标签：javascript

我正在学习 codecademy.com 课程，其中包含编写下面的 calculateTotal 函数的说明。当我单击运行时，它返回 NaN。任何人都知道我编写的 calculateTotal 函数有什么问题，导致它返回 NaN。请注意，我知道 NaN 不是数字...

```
// runner times
var carlos = [9.6,10.6,11.2,10.3,11.5];
var liu = [10.6,11.2,9.4,12.3,10.1];
var timothy = [12.2,11.8,12.5,10.9,11.1];

// declare your function calculateTotal here
var calculateTotal = function(raceTimes){
    var totalTime; 
    for(i = 0; i < raceTimes.length; i++){
        totalTime += raceTimes[i]; 
        return totalTime; 
    }
};

var liuTotal = calculateTotal(liu);

console.log(liuTotal); 
```

请注意，许多回答这个问题的人都说 var totalTime 必须设置为“O”。但是，在下一个 codecademy 课程中，作者编写了一个未设置 totalTime 的函数，并且它可以工作

```
var calculateAverage = function (raceTimes) {
  var totalTime;
  for ( i = 0; i < raceTimes.length; i++ ) {
    totalTime = (totalTime || 0) + raceTimes[i];
  }
// assign variable averageTime
var averageTime = totalTime / raceTimes.length; 

  return averageTime;
}; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-27T21:39:30.193

两个问题：

1.  `totalTime`未定义 - 在未定义的结果中添加某些内容`NaN`
2.  您正在循环内部返回。

使固定：

```
var totalTime=0;
for(i = 0; i < raceTimes.length; i++){
    totalTime += raceTimes[i]; 
}
return totalTime; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T21:39:38.927

您`totalTime`没有初始值，因此它以`undefined`. 您不能添加数字`undefined`并获取数字：

```
var totalTime; // implicitly initialized to undefined 
for(i = 0; i < raceTimes.length; i++){
    totalTime += raceTimes[i];  // undefined + raceTimes[i] = NaN
    return totalTime; 
} 
```

将其初始化为`0`.

```
var totalTime = 0; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-27T21:40:04.390

您尚未`totalTime`使用值进行初始化。所以它默认为`undefined`. 因此，在每次迭代中，都会添加 undefined ，从而产生`NaN`.

# node.js - 认证区域的节点路由？

> ID：12149948
> 
> 赞同：0
> 
> 时间：2012-08-27T21:37:46.153
> 
> 标签：node.js, authentication, routes

我们有一个包含以下路线的应用程序

```
/dothis/
    ...//dothis routes
/dothat
    ...//dothat routes
/doother
    ...//doother routes 
```

和登录路线：

```
/login 
```

和

```
/   //which currently actually isn't even used, would redirect to /login 
```

是否可以关闭路由，以便实际上只有 / 和 /login 可以在没有身份验证的情况下访问？或者我们是否需要对所有其他路由应用前缀。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T22:10:11.890

```
 app.get('*', function(req, res, next) {
         //  console.log(everyauth);
        if (!req.session.auth) {
            res.redirect('/login');
        } else {
          next();
        }
    });

app.get('/login', function(req, res){
  res.render('login', {
  });
}); 
```

似乎工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T22:13:26.743

```
app.all('*', Authentication, function(req, res) {
});

function Authentication(req, res, next) {
   if (req is not user) {
       if (req.url === '/' || req.url === '/login')
           next()
   }
   else
      next();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:21:48.777

我有中间件可以做到这一点：[https ://github.com/jaredhanson/connect-ensure-login](https://github.com/jaredhanson/connect-ensure-login)

```
app.get('/dothat',
  ensureLoggedIn('/login'),  // redirect to /login if not logged in
  function(req, res) {
    // render do that;
  }); 
```

它可以独立使用，也可以与[Passport](http://passportjs.org/)无缝集成，因此在登录后，用户将被重定向回他们最初请求的 URL。

# ruby-on-rails - 两个不同数据库中的 Rails 3.0 模型导致表中不存在错误

> ID：12149949
> 
> 赞同：0
> 
> 时间：2012-08-27T21:37:50.623
> 
> 标签：ruby-on-rails, activerecord

在我的 Rails 3.0 应用程序中，我有两个模型，概念和类别。概念具有映射到类别的 category_id 字段。由于各种原因，这些模型必须存储在两个不同的数据库中，这两个数据库都不同于我的主应用程序数据库：

```
class Concept < ActiveRecord::Base
  establish_connection configurations[Rails.env]["db1"]
  set_table_name "concepts"
end

class Category < ActiveRecord::Base
  establish_connection configurations[Rails.env]["db2"]
  set_table_name "categories"
end 
```

为了获得一个概念的类别，我的概念模型中有一个方法，如下所示：

在 app/models/concept.rb 中：

```
 def category
    Category.find_by_id(category_id)
  end 
```

在他们的 rails 控制台中，这可以正常工作。但是，如果我尝试在概念展示页面上执行 @concept.category，则会收到以下错误：

```
Table 'myapp_development.categories' doesn't exist 
```

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T00:04:21.163

有趣的问题。以前从未尝试过。

`set_table_name`如果模型名称是表名称的单数，则不需要，就像您的一样。

如果您在 database.yml 中设置数据库连接，就像您通常做的那样，传递连接名称，如下所示。

您确实忘记添加关联，这就是您遇到异常的原因。

刚刚测试过：

```
# config/database.yml
db1:
  adapter: mysql2
  database: db1
  username: username
  password: password

db2:
  adapter: mysql2
  database: db2
  username: some_other_username
  password: some_other_password

# models/concept.rb
class Concept < ActiveRecord::Base
  establish_connection :db1
  belongs_to :category
end

# models/category.rb
class Category < ActiveRecord::Base
  establish_connection :db2
  has_one :concept
end 
```

它的行为就好像它是一个单一的数据库。

# asp.net - 如何修复来自 ASP.NET 登录控件的错误重定向？

> ID：12149950
> 
> 赞同：0
> 
> 时间：2012-08-27T21:37:53.673
> 
> 标签：asp.net, controls, membership

我有一个托管在 GoDaddy 上的网站。网址是 www.boatronix.com。这些文件位于文件夹“/boatronix”中，该文件夹又位于文件夹“/_sites”中。我有一个包含 SiteNav.ascx 的母版页（位于根目录下的“Controls”文件夹中），它的页面链接全部带有“../sales.aspx”或“../operations.aspx”的网址“ 等等。当我转到其中一个页面时，所有页面都在同一个根目录中，我得到一个在“boatronix.com/sales.aspx”上方带有地址栏的页面，就像它应该的那样。

我在母版页上也有 ASP.net 会员登录控件，其中一个导航链接指向受限页面。当我从任一路由重定向到 login.aspx（请求受限页面或单击 loginStatus 控件中的“登录”按钮）时，我被带到 login.aspx，但上面的地址栏现在附加了“boatronix.aspx”。 com/_sites/boatronix/login.aspx。”

问题：这是一个不受欢迎的结果，因为查询字符串中的 returnUrl，然后每个后续页面请求都被搜索为“boatronix.com/_sites/boatronix/page.aspx”，所以我的导航链接现在都被破坏了。

我的问题：登录控件的“doPostBack”功能的脚本是否应该归咎于——这就是 GoDaddy 的技术线告诉我的问题；或者，我是否需要在 IIS、我的代码或我的 web.config 中解决这个问题？（例如，设置任何虚拟目录规则）

如果您访问站点“www.boatronix.com”并单击右上角的“登录”链接，您会看到页面请求似乎将一个目录从“/boatronix”追溯到“_sites”然后从那里继续-我试图阻止它这样做并保留在根目录中。

非常感谢您的寻找和任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:50:50.030

如果不完全查看站点的结构，很难弄清楚您的问题是什么，但听起来您需要在 Web.Config 中调整登录页面 URL。

当您访问任何受保护的页面时，ASP.NET 会将您定向到登录 url，其中包含查询字符串参数中的引用页面，其中包含 key `ReturnURL`。如果要调整重定向的`loginUrl`位置，则需要调整 Web.Config 中的位置。

如

```
<authentication mode="Forms">
  <forms loginUrl="~/Account/Login" timeout="2880" />
</authentication> 
```

请参阅：[MSDN 上的身份验证 Web.Config](http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k%28%22HTTP://SCHEMAS.MICROSOFT.COM/.NETCONFIGURATION/V2.0#@LOGINURL%22%29;k%28%22HTTP://SCHEMAS.MICROSOFT.COM/.NETCONFIGURATION/V2.0#CONFIGURATION/SYSTEM.WEB/AUTHENTICATION/FORMS%22%29;k%28%22HTTP://SCHEMAS.MICROSOFT.COM/.NETCONFIGURATION/V2.0#FORMS%22%29;k%28VS.XMLEDITOR%29;k%28TargetFrameworkMoniker-%22.NETFRAMEWORK,VERSION=V4.0%22%29&rd=true)

# ruby - 将事件从旧版 MS SQLServer 传播到 Rails

> ID：12149954
> 
> 赞同：0
> 
> 时间：2012-08-27T21:38:05.927
> 
> 标签：ruby, sql-server, ruby-on-rails-3, publish-subscribe

我有一个集成到基于旧版 MS SQLServer 系统的 rails 应用程序。我需要创建某种发布订阅，由旧版 SQLServer 生成事件，Rails 应用程序订阅这些事件。

我需要生成的事件将由旧版应用程序的用户引起，观察者无济于事。基本上我需要检测由旧版应用程序引起的表插入并将其广播到 rails 应用程序。

我可以在 Legacy SQLServer 上设置 TRIGGERS，它最终可以通过 xp_cmdexec 调用某些东西。

我想出某种基于 Ruby 的 pub/sub gem，其中 SQLServer 框（在后台）上的 ruby​​ 可执行文件可以发布事件，而 Rails（在云中）应用程序可以订阅它们。性能不是问题，平均每天 10 到 30 次表插入！我控制防火墙，所以我可以通过任何协议。

我有很多通过 SQLServer 适配器在 rails 应用程序中定义的旧版 SQLServer 表，但是 rails 应用程序不会生成我感兴趣的表插入。

我见过 hookr、蚂蚁、ruby-mqtt，然后我开始看到更多：<

有人有推荐吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T02:29:52.583

如果响应性不是主要关注点，那么让 Rails 应用程序每隔一段时间轮询一次新记录可能是最简单的。如果数据库有时间戳或至少有自动增量 ID，您可以确保只处理新的。否则，您将不得不使用记录计数。

# html - 如何在使用 m4a 声音文件时使用 CSS 在我的网站上嵌入音乐？并且仍然有控制权？

> ID：12149967
> 
> 赞同：0
> 
> 时间：2012-08-27T21:39:17.713
> 
> 标签：html, css, audio, embed

我想使用 HTML/CSS 在我的页面上嵌入音乐，同时能够将声音文件类型设为 .M4A。我一次又一次地尝试了这个，它不起作用。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:49:23.770

你可以看看 JW Player：[http ://www.longtailvideo.com/players/](http://www.longtailvideo.com/players/)

# java - 如何刷新面板？

> ID：12149969
> 
> 赞同：3
> 
> 时间：2012-08-27T21:39:24.403
> 
> 标签：java, swing, user-interface

我有一个 JMenu，当有人单击 JMenuItem 时，我希望中间面板刷新并显示一些新内容。所以我尝试了 .removeAll ，它工作正常，但是当我尝试添加它不会显示的东西时。

**注意：我正在使用 WindowBuilder PRO，所以我仍在尝试使用它等等**

这是我的代码：

```
import java.awt.EventQueue;
import javax.swing.JFrame;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JCheckBoxMenuItem;
import javax.swing.JMenu;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.SpringLayout;

import java.awt.List;
import javax.swing.JLabel;
import javax.swing.JTextPane;
import javax.swing.JSeparator;
import org.eclipse.wb.swing.FocusTraversalOnArray;
import java.awt.Component;
import java.awt.Container;
import java.awt.FlowLayout;
import java.awt.Font;
import java.awt.GridBagLayout;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.Panel;
import java.awt.GridBagConstraints;

public class HomeScreen {

JFrame frame;
private final Panel panel = new Panel();

public HomeScreen(String name) {
    initialize(name);
}

/**
 * Initialize the contents of the frame.
 */
private void initialize(String name) {
    frame = new JFrame("Timzys CMS / Monitor / Account( " + name + " )");
    frame.setResizable(false);
    frame.setSize(694,525);
    frame.setLocationRelativeTo(null);

    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    JMenuBar menuBar = new JMenuBar();
    frame.setJMenuBar(menuBar);

    JMenu mnMonitor = new JMenu("Monitor");
    menuBar.add(mnMonitor);

    JMenuItem mntmUsers = new JMenuItem("Users");
    mnMonitor.add(mntmUsers);

    JMenuItem mntmContentPosts = new JMenuItem("Content Posts");
    mnMonitor.add(mntmContentPosts);

    JMenuItem mntmLogs = new JMenuItem("Logs");
    mnMonitor.add(mntmLogs);

    JMenu mnExtras = new JMenu("Extras");
    menuBar.add(mnExtras);

    mntmUsers.addActionListener(new ActionListener(){
        public void actionPerformed(ActionEvent e)
        {
             frame.getContentPane().removeAll();

             frame.getContentPane().add(new JLabel("Test"));
             frame.getContentPane().revalidate();

        }
    });

    JMenuItem mntmFeedbacksuggestions = new JMenuItem("Feedback/Suggestions");
    mnExtras.add(mntmFeedbacksuggestions);
    frame.getContentPane().setLayout(null);
    panel.setBounds(0, 0, 688, 476);
    frame.getContentPane().add(panel);
    panel.setLayout(null);

    JTextPane txtpnWelcomeTimzysCms = new JTextPane();
    txtpnWelcomeTimzysCms.setFont(new Font("Arial", Font.PLAIN, 18));
    txtpnWelcomeTimzysCms.setEditable(false);
    txtpnWelcomeTimzysCms.setText("Welcome Timzys CMS Monitor. If you are here then you are a admin! So please do not tamper with any important things. If you have questions or suggestions goto the extras tab and submit a feedback idea. Enjoy!");
    txtpnWelcomeTimzysCms.setBounds(10, 11, 668, 72);
    panel.add(txtpnWelcomeTimzysCms);

 }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:47:51.227

可能您在问题中面临与其他人类似的问题：
[Java Swing revalidate() vs repaint()](https://stackoverflow.com/questions/1097366/java-swing-revalidate-vs-repaint)

如建议的那样：尝试调用`repaint`而不是`revalidate`（您现在在方法的实现中调用的那个`actionPerformed`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T22:12:44.370

问题在于，因为您已将框架的布局设置为 null，所以`JLabel`您添加的新框架需要设置其大小。例如：

```
JLabel label = new JLabel("Test");
label.setSize(100, 100);
frame.getContentPane().add(label); 
```

*As an aside:* Actually I wonder why you are mixing AWT & Swing components here. You have a heavyweight AWT panel added to the frame which blocks out the menus. Switching to `JPanel` would fix this.

# asp.net - 如何使用 ODP.NET 强制关闭非活动 Oracle 会话

> ID：12149974
> 
> 赞同：1
> 
> 时间：2012-08-27T21:39:43.047
> 
> 标签：asp.net, connection-pooling, odp.net

asp.net 2.0 使用 odp.net 10.1.04 连接到 Oracle 10g。

我们的 Web 应用程序每天都会出现一次这个问题：ODP-1000 "Connection request timed out"。

众所周知，这是一个内存泄漏问题，由于打开的连接没有被关闭和处理。

我们已经仔细检查了我们的代码，并且打开后的所有连接都已关闭和处置。OracleCommand、Oracledatareader 等所有 odp.net 对象在使用后都会被丢弃。

在 web.config 上，这是我们的连接字符串：

```
<add key="ConnectionString" value="user id=xxxx;data source=XXXX;password=xxxxx;Pooling=True;Connection Timeout=15;Incr Pool Size=5;Decr Pool Size=3;Max Pool Size=300;Min Pool Size=10;Validate Connection=true;"/> 
```

我们已将连接超时增加到 60。

由于我们在代码中找不到任何未关闭的连接，当 conn.Open 收到错误“连接请求超时”时，有什么方法可以关闭或销毁非活动的 Oracle 会话？

根据一些信息： [http ://rainmanalex.wordpress.com/2008/11/13/odpnet-connection-string-attributes/](http://rainmanalex.wordpress.com/2008/11/13/odpnet-connection-string-attributes/)

“调节器线程每 3 分钟生成一次，如果未使用，则关闭最多 Decr Pool Size 数量的池连接。”

在收到错误“连接请求超时”时，有没有办法强制关闭非活动连接，而不是等待 3 分钟？

就像是：

```
If conn.Open gets error "Connection request timed out"
Then
  Destroy inactive Oracle session
  Try again conn.Open 
End If 
```

# objective-c - 目标 c - 字母和分数模型

> ID：12149975
> 
> 赞同：1
> 
> 时间：2012-08-27T21:39:51.190
> 
> 标签：objective-c, model, structure

我正在开发一个文字游戏，基本上我想为字母表的每个字符分配一个整数值。

目前，我有一个帮助器来返回每个 char 的值，但我想知道应该如何构造初始数据结构。

目前它是一个字典，其中包含字母表中的每个字母作为键，我希望这些点成为该键的对象。设置点对象的最佳做法是什么？

我想避免这样的事情：

```
if      (_letter == 'a' || _letter == 'A') _points = 1;
else if (_letter == 'b' || _letter == 'B') _points = 4;
else if (_letter == 'c' || _letter == 'C') _points = 3; 
```

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:43:28.550

您可以使用一个 26 元素的 C 整数数组，其中每个整数是该字母的点值，第 0 个元素是 A，第一个元素是 B，等等。然后您只需小写字母，然后再减去`'a'`它并使用作为数组的索引。此时，唯一剩下的就是防止考虑非 ASCII 字母字符，这可以通过小写 ( `if (c >= 'a' && c <= 'z')`) 后的简单范围检查来完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:46:41.200

您可以利用 chars在 C*中是*整数（因此也是 Objective-C 中的整数）这一事实，并且只需拥有一个 int 数组，以 char 的小写版本 - 'a' 为键，如下所示：

```
int *letterValues[] = {1,4,3}; // a = 1, b=4, etc...
char thisChar = 'B';

int thisCharVal = letterValues[tolower(thisChar) - 'a']; 
```

请注意，这使用了在（std 库）中声明的 tolower，并且从小写字母字符中减去 'a' 本质上是在推导出它在字母表中的“索引”：'a' - 'a' = 0，“第一个" item, 'b'-'a' = 1 等。因此，您的数组初始值设定项 ( `{1,4,3}`) 只是您要按顺序分配给字符的值（或者如果您愿意，可以使用指定的初始值设定项，您*可以*使用 chars还有：

```
int *letterValues[] = {1,4,3, 'z'=4}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T21:49:40.093

如果它只是标准拉丁字母，没有变音符号或其他特殊字符，最简单的方法是为“点”值创建一个 26 个整数的数组：

```
int LookupPoints(char c)
{
    static const unsigned char Points[26]={1,4,3, ... };

    c=c|0x20;    /* all lower case */
    assert(c>='a' && c<='z');
    return Points[c-'a'];
} 
```

如果你想包含其他字符，你可以专门检查它们，或者制作一个按字母排序的结构数组（带有字符和值）以使用 bsearch 搜索。

编辑：当然，字典也可以。只需针对您的特定情况使用任何感觉最简单的解决方案即可。

# asp.net - c# cast 到 Literal 的 vb.net 转换

> ID：12149977
> 
> 赞同：1
> 
> 时间：2012-08-27T21:40:02.597
> 
> 标签：asp.net, vb.net

我正在尝试使用 vb 进行密码恢复。我在网上找到了 c# 代码，并试图将其转换为 vb。我收到“预期语句结束”错误。任何人都可以看到这个问题吗？

c#代码：

```
protected void validateUserEmail(object sender, LoginCancelEventArgs e)
{
    TextBox EmailAddressTB = 
        ((TextBox)PWRecovery.UserNameTemplateContainer.FindControl("EmailAddressTB"));

Literal ErrorLiteral = 
  ((Literal)PWRecovery.UserNameTemplateContainer.FindControl("ErrorLiteral"));

MembershipUser mu = Membership.GetUser(PWRecovery.UserName);

if (mu != null) // The username exists
    {
        if (mu.Email.Equals(EmailAddressTB.Text)) // Their email matches
        {
            ProfileCommon newProfile = Profile.GetProfile(PWRecovery.UserName);
            HttpCookie appCookie = new HttpCookie("usernameCookie");
            appCookie.Value = newProfile.FullName;
            appCookie.Expires = DateTime.Now.AddMinutes(3);
            Response.Cookies.Add(appCookie);
        }
        else
        {
            e.Cancel = true;
            ErrorLiteral.Text = "Your username and password do not match";
        }
    }
    else
    {
        e.Cancel = true;
        ErrorLiteral.Text = "No such user found.";
    }

} 
```

VB代码：

```
Protected Sub SubmitButton_Click(sender As Object, e As System.EventArgs)

    Dim user As MembershipUser = Membership.GetUser(PasswordRecovery1.UserName)

    Dim errorLiteral As Literal = (Literal)PasswordRecovery1.UserNameTemplateContainer.FindControl("FailureText")

    If (user IsNot Nothing) Then
        Dim password As String = user.GetPassword()

        EmailPassword(user.Email, password, user.ToString())
    Else
        errorLiteral.Text = "No such user found."
    End If

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:54:09.840

```
Dim errorLiteral As Literal = (Literal)PasswordRecovery1.UserNameTemplateContainer.FindControl("FailureText") 
```

可以只是

```
Dim errorLiteral As Literal = PasswordRecovery1.UserNameTemplateContainer.FindControl("FailureText") 
```

如果您愿意，还可以使用 Ctype(object, type) 或 DirectCast(object, type) - 例如：

```
Dim errorLiteral As Literal = CType(PasswordRecovery1.UserNameTemplateContainer.FindControl("FailureText"), Literal) 
```

# jquery - jQuery resize() 在 IE8 中不起作用

> ID：12149981
> 
> 赞同：2
> 
> 时间：2012-08-27T21:40:20.807
> 
> 标签：jquery, internet-explorer-8

我被难住了...我正在构建一个响应式站点，该站点仅在较大的屏幕上加载较大的图形。它在 IE9/FF/Chrome 中运行良好，但在 IE8 中不起作用。

有谁看到是什么让 IE8 不火？这是我的代码：

```
<script type="text/javascript">
$(document).ready(function() {
   $(window).resize(function() {
    //small-screen
    if (window.innerWidth < 768) {$('#smiling-model').html('');}
    //end small-screen
    else if (window.innerWidth >= 768) {
        $('#smiling-model:empty').append('<img id="#smiling-model-img" src="images/smiling-model-500x456px.jpg" alt="Great Smile" />');
            }
    }).resize(); // trigger resize event
});
</script> 
```

这是实际网站的链接： [http ://www.orlickdental.com/](http://www.orlickdental.com/)

谢谢大家！

奥马尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:44:34.870

据我所知`window.innerWidth`，低于版本 9 的 Internet Explorer 不支持

有关更多信息，请查看古老的 Quirksmode 提供的[DOM 兼容性信息:)](http://www.quirksmode.org/dom/w3c_cssom.html)

由于您已经在使用 jQuery，因此您可以依赖`$(window).width()`. 然而——本着知识的精神——掌握窗口的尺寸一直是 IE 的一个问题。做到这一点的主要方法是依靠 body 元素的尺寸*（使用 body.clientWidth）*或实际插入用 css 设计的特定元素`div`来填充窗口的尺寸*（然后从该元素中读取尺寸）*。jQuery 现在显然把所有的乐趣都带走了；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T10:07:10.800

使用，但由于[jQuery 1.8](http://bugs.jquery.com/ticket/12310)中的更改（返回宽度） ，请`$(window).width()`确保页面没有以怪异模式呈现。`IE``0`

简短的回答：`<!DOCTYPE html>`在页面的开头使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T21:43:08.183

怎么样`$(this).width()`：

```
$(window).resize(function() {
    //small-screen
    var w = $(this).width();
    if (w < 768) {
       $('#smiling-model').html('');
    }
    //end small-screen
    else if (w >= 768) {
        $('#smiling-model:empty').append('<img id="#smiling-model-img" src="images/smiling-model-500x456px.jpg" alt="Great Smile" />');
    }
 }).resize(); // trigger resize event 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T21:45:54.180

为了浏览器兼容性，我建议使用`$(window).width()`而不是`window.innerWidth`.

```
$(document).ready(function() {
   $(window).resize(function() {

    //cache the width of the viewport
    var width = $(window).width();

    //and check it's value
    if (width < 768) {$('#smiling-model').html('');}
    //end small-screen
    else if (width >= 768) {
        $('#smiling-model:empty').append('<img id="#smiling-model-img" src="images/smiling-model-500x456px.jpg" alt="Great Smile" />');
            }
    }).resize(); // trigger resize event
}); 
```

这是一个演示：http: [//jsfiddle.net/FpReh/](http://jsfiddle.net/FpReh/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-27T21:48:37.670

在 IE8 的控制台中，我检查了该`window.innerWidth`值并返回`undefined`.

而是使用`$(window).width();`

# c# - 在列中计算相同的值并写入新的excel文件

> ID：12149984
> 
> 赞同：1
> 
> 时间：2012-08-27T21:40:27.890
> 
> 标签：c#, .net, excel

我想用c#读取一个excel文件并计算一列中所有相同的值，然后写下这个值+我在另一个excel文件中找到该值的频率。所以如果我有这样的东西：

```
 A            B          C
  *something*      110    *something*   
  *something*      120    *something*  
  *something*      120    *something*  
  *something*      130    *something*  
  *something*      110    *something*
  *something*      120    *something*  
  *something*      110    *something* 
```

我的专栏是我要数的“B”。我想进入一个新的excel，输出如下：

```
 A             B
 110           3
 120           3
 130           1 
```

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T00:55:38.057

虽然它有点先进，但我建议创建一个数据透视表来完成您的要求。它非常适合这个，不需要太多编码。

试试这个代码（不要忘记为实际的列名和工作簿位置更改“相同”）：

```
using System;
using System.Collections.Generic;
using System.Text;
using Excel = Microsoft.Office.Interop.Excel;

namespace ExcelFun01
{
    class Program
    {
        static void Main(string[] args)
        {
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWb = xlApp.Workbooks.Open(@"C:\stackoverflow.xlsx");
            Excel.Worksheet xlWs = (Excel.Worksheet)xlWb.Sheets[1]; // Sheet1
            Excel.Worksheet xlWsNew = (Excel.Worksheet)xlWb.Sheets.Add();

            // find the data range
            Excel.Range dataRange = getDataRange(ref xlWs);

            // start by creating the PivotCache - this tells Excel that there is a data connection
            // to data inside the workbook (could be used to get external data, too)
            Excel.PivotCache pc = xlWb.PivotCaches().Create(Excel.XlPivotTableSourceType.xlDatabase
                                                            ,dataRange
                                                            ,Excel.XlPivotTableVersionList.xlPivotTableVersion14);

            // create the pivot table and set the destination to the new sheet at A1
            Excel.PivotTable pt = pc.CreatePivotTable(xlWsNew.Range["A1"]);

            // get the PivotField "Same" for easy referencing
            Excel.PivotField pf = (Excel.PivotField)pt.PivotFields("Same");

            // first add the count
            pt.AddDataField(pf, "Count of Same", Excel.XlConsolidationFunction.xlCount);

            // now add the row with the same field
            pf.Orientation = Excel.XlPivotFieldOrientation.xlRowField;
            pf.Position = 1;

            // behold!!!
            xlWsNew.Select();
            xlApp.Visible = true;
        }

        private static Excel.Range getDataRange(ref Excel.Worksheet xlWs)
        {
            Excel.Range rng = xlWs.Cells.SpecialCells(Excel.XlCellType.xlCellTypeLastCell);
            Excel.Range dataRange = xlWs.Range["A1", rng.Address];
            return dataRange;
        }
    }
} 
```

这是数据透视表的样子：

![在此处输入图像描述](../Images/0dd2dea9f517fdabed914099dab59b5b.png)

# ruby-on-rails - 对 resque .perform 方法设定期望。任务在回调中排队

> ID：12149986
> 
> 赞同：2
> 
> 时间：2012-08-27T21:40:39.740
> 
> 标签：ruby-on-rails, rspec, resque, resque-retry

所以根据我的理解，我相信你这样做

`Resque.inline = Rails.env.test?`

您的 resque 任务将同步运行。我正在编写一个关于在`after_commit`回调期间排队的 resque 任务的测试。

`after_commit :enqueue_several_jobs`

```
#class PingsEvent < ActiveRecord::Base
...
   def enqueue_several_jobs
      Resque.enqueue(PingFacebook, self.id)
      Resque.enqueue(PingTwitter, self.id)
      Resque.enqueue(PingPinterest, self.id)
   end 
```

在`.perform`我的 Resque 任务类的方法中，我正在做一个`Rails.logger.info`并且在我的测试中，我正在做类似的事情

```
..
Rails.logger.should_receive(:info).with("PingFacebook sent with id #{dummy_event.id}")
PingsEvent.create(params) 
```

我对`PingTwitter`和有相同的测试`PingPinterest`。

我在第二个和第三个期望上都失败了，因为似乎测试实际上在所有 resque 作业运行之前就完成了。只有第一个测试真正通过。RSpec 然后抛出一个`MockExpectationError`告诉我其他两个测试`Rails.logger`没有收到的消息。`.info`有人有过这方面的经验吗？

# 编辑

有人提到它的`should_receive`行为类似于 a `mock`，而我应该这样做`.exactly(n).times`。很抱歉没有早点说清楚，但我对不同的`it`区块有我的期望，我不认为`should_receive`一个`it`区块会在下一个区块模拟它`it`？让我知道我是否错了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T02:42:15.250

```
class A
  def bar(arg)
  end

  def foo
    bar("baz")
    bar("quux")
  end
end

describe "A" do
  let(:a) { A.new }

  it "Example 1" do
    a.should_receive(:bar).with("baz")
    a.foo # fails 'undefined method bar'
  end
  it "Example 2" do
    a.should_receive(:bar).with("quux")
    a.foo # fails 'received :bar with unexpected arguments
  end
  it "Example 3" do
    a.should_receive(:bar).with("baz")
    a.should_receive(:bar).with("quux")
    a.foo # passes
  end
  it "Example 4" do
    a.should_receive(:bar).with(any_args()).once
    a.should_receive(:bar).with("quux")
    a.foo # passes
  end
end 
```

像存根一样，消息期望**取代了方法的实现**。满足期望后，对象将不再响应方法调用——这将导致“未定义的方法”（如示例 1 中所示）。

示例 2 显示了当期望因参数不正确而失败时会发生什么。

示例 3 展示了如何对同一方法的多次调用进行存根——按照接收顺序使用正确的参数对每个调用进行存根。

示例 4 表明您可以使用`any_args()`帮助程序在一定程度上减少这种耦合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T22:07:37.700

使用`should_receive`的行为就像一个模拟。对具有不同参数的同一个对象有多个期望是行不通的。如果您更改对`Rails.logger.should_receive(:info).exactly(3).times`规范的期望，则可能会过去。

综上所述，您可能想要断言比为这些规范记录的内容更相关的内容，然后您可能会有多个有针对性的期望。

规格之间不会被拆除，因此`Rails.logger`期望是否在不同的示例中并不重要。为两个单独的示例吐出记录器的对象 ID 说明了这一点：

```
it 'does not tear down rails logger' do
  puts Rails.logger.object_id # 70362221063740
end

it 'really does not' do
  puts Rails.logger.object_id # 70362221063740
end 
```

# iphone - RaptureXML 无法访问子标签

> ID：12149987
> 
> 赞同：0
> 
> 时间：2012-08-27T21:40:55.250
> 
> 标签：iphone, ios, xcode, ipad, ios5

我正在使用 raptureXML 从我的 XML`<forecast .../>`标签中提取数据。

这是 XML

```
<?xml version="1.0" ?>
<weatherdata>
<weather weatherlocationname="Chicago, IL">

<forecast low="67" high="86" skycodeday="34" skytextday="Mostly Sunny" date="2012-08-27" day="Monday" shortday="Mon" precip="0" />

<forecast low="66" high="82" skycodeday="34" skytextday="Mostly Sunny" date="2012-08-28" day="Tuesday" shortday="Tue" precip="0" />

<forecast low="66" high="82" skycodeday="34" skytextday="Mostly Sunny" date="2012-08-29" day="Wednesday" shortday="Wed" precip="0" />

<forecast low="68" high="88" skycodeday="32" skytextday="Sunny (Clear)" date="2012-08-30" day="Thursday" shortday="Thu" precip="0" />

<forecast low="70" high="90" skycodeday="34" skytextday="Mostly Sunny" date="2012-08-31" day="Friday" shortday="Fri" precip="0" />

<toolbar timewindow="60" minversion="1.0.1965.0" />
</weather>
</weatherdata> 
```

我将此代码用于 raptureXML

```
RXMLElement *rootXML = [RXMLElement elementFromXMLString:XML encoding:NSUTF8StringEncoding];

[rootXML iterate:@"forecast" usingBlock:^(RXMLElement *element) 
    {
        NSString *high = [element attribute:@"low"];
        NSLog(@"high: %@", high);
    }];

    NSArray *forecast = [rootXML children:@"forecast"];
    NSLog(@"[forecast count]: %d", [forecast count]); 
```

很直接对吧？但问题是它没有找到任何预测标签，即我什么也没得到，`NSLog(@"high: %@", high);`并且 `[forecast count]`为零。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:59:23.963

我没有使用过 RaptureXML，但看起来你错过了一层。`rootXML`可能是`weatherdata`它没有`forecast`孩子，因为它唯一的孩子是`weather`有`forecast`孩子的。尝试添加：

```
RXMLElement *weather = [rootXML child:@"weather"]; 
```

然后使用`weather`其余代码代替`rootXML`.

像这样：

```
RXMLElement *rootXML = [RXMLElement elementFromXMLString:XML encoding:NSUTF8StringEncoding];

RXMLElement *weather = [rootXML child:@"weather"];

[weather iterate:@"forecast" usingBlock:^(RXMLElement *element) 
{
    NSString *high = [element attribute:@"low"];
    NSLog(@"high: %@", high);
}];

NSArray *forecast = [weather children:@"forecast"];
NSLog(@"[forecast count]: %d", [forecast count]); 
```

# ruby-on-rails - heroku 未初始化常量 Admin

> ID：12149991
> 
> 赞同：0
> 
> 时间：2012-08-27T21:41:08.473
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku

我已经看到一些像这样发布的问题，但任何答案都可以解决我的问题:(

我正在尝试将我的应用程序部署到heroku，我已经使用设计进行简单的身份验证，部署似乎还可以，但是当我浏览到我的应用程序时，我看到了错误：

应用程序发生错误，无法提供您的页面。请稍后重试。如果您是应用程序所有者，请查看您的日志以获取详细信息。

我尝试运行 heroku rake db:migrate 但我仍然遇到同样的错误。

在此先感谢，我的日志是：

```
2012-08-27T21:23:17+00:00 app[web.1]: => Booting WEBrick 2012-08-27T21:23:17+00:00 app[web.1]: => Rails 3.2.8 application starting in pro duction on http://0.0.0.0:17074 2012-08-27T21:23:17+00:00 app[web.1]: => Call with -d to detach 2012-08-27T21:23:17+00:00 app[web.1]: => Ctrl-C to shutdown server 2012-08-27T21:23:17+00:00 app[web.1]: Connecting to database specified by DATABA SE_URL 2012-08-27T21:23:21+00:00 app[web.1]: Exiting 2012-08-27T21:23:21+00:00 app[web.1]: /app/app/controllers/admin_user/omniauth_c allbacks_controller.rb:1:in `<top (required)>': uninitialized constant AdminUser s (NameError) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:51:08.713

在 omniauth_callbacks_controller.rb 中，您应该将常量“AdminUsers”的所有实例更改为“AdminUser”（末尾没有“s”）。

# jquery - 试图用 .then、.fail 和 .reject 打破 jQuery 承诺链

> ID：12149993
> 
> 赞同：12
> 
> 时间：2012-08-27T21:41:10.277
> 
> 标签：jquery, deferred, chain, promise

更新：这个问题是 jQuery 1.7 vs 1.8 的结果。永远不要在 1.7 中使用 Promise，因为它们不能通过在`.then`. 1.8 看起来他们没有搞砸。

[http://jsfiddle.net/delvarworld/28TDM/](http://jsfiddle.net/delvarworld/28TDM/)

```
// make a promise
var deferred = $.Deferred();
promise = deferred.promise();

// return a promise, that after 1 second, is rejected
promise.then(function(){
    var t = $.Deferred();
    setTimeout(function() {
        console.log('rejecting...');
        t.reject();
    }, 1000);

    return t.promise();
});

// if that promise is successful, do this
promise.then(function() {
    console.log('i should never be called');
})

// if it errors, do this
promise.fail(function() {
    console.log('i should be called');
});

deferred.resolve(); 
```

预期：'我应该被调用'

实际：'我永远不应该被调用'

**问题**：我想要链接回调并让它们中的任何一个能够打破链接并触发`fail`函数，并跳过其他链接的回调。我不明白为什么所有的 then 都被触发了，而 fail 没有被触发。

我来自 NodeJS 的 Q 库，所以我`.then`先尝试了它。但是，将其更改为`.pipe`没有效果。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-27T22:03:57.030

你没有重新定义 的值`promise`，试试这个：

[http://jsfiddle.net/28TDM/1/](http://jsfiddle.net/28TDM/1/)

```
var deferred = $.Deferred();
promise = deferred.promise();

promise = promise.then(function(){
    var t = $.Deferred();
    setTimeout(function() {
        console.log('rejecting...');
        t.reject();
    }, 1000);

    return t.promise();
});

promise.then(function() {
    console.log('i should never be called');
})

promise.fail(function() {
    console.log('i should be called');
});

deferred.resolve(); 
```

显然它**确实**按照您认为的方式工作，~~只是没有记录~~ [https://api.jquery.com/deferred.then](https://api.jquery.com/deferred.then)。很酷。这是 jQuery 1.8.0 中添加的新功能，很可能他们只是没有完成更新文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-07T07:28:49.347

恕我直言，你没有链接任何东西。**您的第二个`.then`附加到与第一个附加到相同的承诺`.then`上**。

*为什么？*

请注意，`then`将始终**返回**新的 Promise，而不是更改它所附加的 Promise。它没有副作用。

例如：

```
var promiseX = promiseA
                 .then(function() { return promiseB; })
promiseX.then(function() { return promiseC; }); 
```

`promiseA` **附加后**不会改变它的值**`then`；它会保持原样。**

 **`promiseX`将是 1st 的返回值`then`，即`promiseB`.

所以第二个`then`实际上是附加到`promiseB`.

这正是@Kevin B 在他的回答中所做的。

* * *

另一个解决方案是，由于`.then`将返回新的承诺，您可以`.then`像下面这样链接函数。

```
var promiseX = promiseA
                 .then(function() { return promiseB; })
                 .then(function() { return promiseC; }); 
```

这一次，第一个`then`被附加到`promiseA`，猜猜第二个`then`被附加到哪个承诺？

你是对的。是`promiseB`，不是`promiseA`。因为 2nd`then`实际上是附加到 1st 的返回值`then`，即`promiseB`.

最后将 2nd`then`的返回值赋值给`promiseX`，所以`promiseX`等于`promiseC`。

好的，回到OP的问题。以下代码是我的答案。

```
var deferred = $.Deferred();
promise = deferred.promise(); // this is the first promise

promise.then(function(){ // callbacks for 1st promise
    var t = $.Deferred();
    setTimeout(function() {
        console.log('rejecting...');
        t.reject();
    }, 1000);
    return t.promise(); // this is the 2nd promise
    // return $.Deferred().reject(); // To reject immediately.
}).then(function() { // callbacks for 2nd promise
    console.log('i should never be called');
}, function() {
    console.log('i should be called');
})

deferred.resolve(); 
```**

# sql - SQL 查询 - 如果存在则选择一个，否则选择其他，从不同时

> ID：12149994
> 
> 赞同：3
> 
> 时间：2012-08-27T21:41:17.240
> 
> 标签：sql

假设有一个包含两列的表，First Name 和 Eye Color。

在此表中，您可能拥有：

```
Name - Green Eyes
Name - Brown Eyes 
```

我正在尝试为带有绿眼睛的名称选择所有行，但是如果有一个没有绿眼睛的名称，那么我想选择带有棕色眼睛的名称。我从不想为给定名称返回两行。关于如何做到这一点的任何想法？任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:45:55.333

```
SELECT COALESCE(g.name, b.name) name,
    COALESCE(g.eye_color, b.eye_color) eye_color

FROM (
  SELECT DISTINCT name, eye_color
  FROM eye_colors
  WHERE eye_color = 'green'
) g

FULL OUTER JOIN (
  SELECT DISTINCT name, eye_color
  FROM eye_colors
  WHERE eye_color = 'brown'
) b
ON b.name = g.name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-04T18:56:09.010

```
IF EXISTS(SELECT * FROM Table WHERE Color='Green')
    SELECT * FROM Table WHERE Color = 'Green'
ELSE
    SELECT * FROM Table WHERE Color='Brown' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-04T19:27:30.477

我会在表的 (name,color) 上有一个索引，然后加入它自己，但首先取主要的“绿色”，然后寻找棕色

```
select
      justName.Name,
      coalesce( Green.Eye_Color, Brown.Eye_Color ) as Eye_Color
   from
      ( select distinct name 
           from eye_colors ) justName
         left join eye_colors as Green
            on justName.Name = Green.Name
           and Green.Eye_Color = 'Green'
         left join eye_colors as Brown
            on justName.Name = Brown.Name
           and Brown.Eye_Color = 'Brown' 
```

预查询只是获得不同的名称，然后通过左连接到表两次，一次是绿色，第二次是棕色。如果绿色记录没有匹配，则获取棕色实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T21:44:52.450

我会做

```
select * 
from person 
where person.eyecolor = 'green' 
   or (     person.eyecolor = 'brown' 
        and not exists(select null from person where person.eyecolor = 'green')
      ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-02T12:31:51.540

```
select *
from person p
inner join (
    select decode(count(name), 1, 'Green Eyes', 'Brown Eyes') as color
    from person
    where color = 'Green Eyes'
    and rownum < 2
) t
on p.color = t.color 
```

如果至少有一个人拥有“Green Eyes”，则子查询应返回“Green Eyes”，否则将返回“Brown Eyes”。我们可以使用 where 子句进行过滤，而不是内部连接。

# sql-server - 计算一个字段以识别共享相同 ID 的数据点的时间顺序

> ID：12149996
> 
> 赞同：0
> 
> 时间：2012-08-27T21:41:30.470
> 
> 标签：sql-server, sql-server-2008, tsql

我使用 Microsoft SQL Server 2008 尝试识别数据点的时间顺序，以创建一个过滤字段，该字段允许我创建一个查询，该查询仅包含每个 ID 号的第一条和最后一条记录，其中多行代表不同的数据来自同一 ID 的积分

这是我当前数据和所需数据的示例，以便更好地理解我的意思：

**当前数据**

```
ID    Indicator        Date
1       1           1988-02-11
1       1           1989-03-9
1       1           1993-04-3
1       1           2001-05-4
2       1           2000-01-01
2       1           2001-02-03
2       1           2002-04-22
3       1           1990-02-01
3       1           1998-02-01  
3       1           1999-03-02
3       1           2000-04-02
4       0               NA 
```

**所需数据**

```
ID    Indicator    Date        Order_Indicator
1       1       1988-02-11        1
1       1       1989-03-9         2
1       1       1993-04-3         3
1       1       2001-05-4         4
2       1       2000-01-01        1
2       1       2001-02-03        2
2       1       2002-04-22        3
3       1       1990-02-01        1
3       1       1998-02-01        2
3       1       1999-03-02        3
3       1       2000-04-02        4
4       0       NULL             NULL 
```

我要创建的字段是“Desired Data”表中的“Order_Indicator”字段，唯一相关的记录是 Indicator = 1 的记录。有了这些信息，我将创建一个查询，我只选择 Order_Indicator = 1 的行对于共享相同 ID 的每个“行组”，Order_Indicator = MAX(Order_Indicator)。有谁知道我该怎么做？我知道我可以在 Excel 中很容易地做到这一点，但我需要在 SQL Server 上做到这一点，以便我的同事可以重现它。

非常感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:48:01.733

您可以使用排名函数执行此操作：

```
select c.*,
       (case when indicator = 1
             then row_number() over (partition by id, indicator order by [date])
        end) as OrderIndicator
from current c 
```

这会根据日期和指示符分配一个序号。case 语句处理指示符 = 0 的情况。

顺便说一句，这假设“日期”被存储为日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T08:48:16.743

使用以下查询：

```
select YourTable.ID,
       YourTable.indicator,
       case when date<>'NA' then date end as date,
       case when indicator = 1 then row_number() over (partition by id, indicator order by ID) end as Order_Indicator
from YourTable 
```