# StackOverflow 问答 000901000-000901999

# java - 批量解压.gz文件

> ID：901003
> 
> 赞同：6
> 
> 时间：2009-05-23T06:21:23.140
> 
> 标签：java, gzip, compression

我有 100 个需要解压缩的 .gz 文件。我有几个问题

a) 我正在使用[http://www.roseindia.net/java/beginners/JavaUncompress.shtml](http://www.roseindia.net/java/beginners/JavaUncompress.shtml)提供的代码来解压缩 .gz 文件。它工作正常。Quest:- 有没有办法获取压缩文件的文件名。我知道 Java 的 Zip 类提供了要处理的输入文件的枚举。这可以给我存储在 .zip 文件中的文件名、大小等。但是，对于 .gz 文件，我们是否有相同的文件名，或者文件名是否与删除 .gz 的 filename.gz 相同。

b) 是否有另一种优雅的方法来通过调用 java 代码中的实用程序函数来解压缩 .gz 文件。就像从您的 java 类中调用 7-zip 应用程序一样。然后，我不必担心输入/输出流。

提前致谢。卡皮尔

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-24T02:15:08.243

a) Zip 是一种存档格式，而 gzip 不是。因此，除非（例如）您的 gz 文件是压缩的 tar 文件，否则条目迭代器没有多大意义。你想要的可能是：

```
File outFile = new File(infile.getParent(), infile.getName().replaceAll("\\.gz$", "")); 
```

b）您只想解压缩文件吗？如果不是，您可以使用 GZIPInputStream 并直接读取文件，即无需中间解压缩。

但是没问题。假设您真的*只想*解压缩文件。如果是这样，你可能会使用这个：

```
public static File unGzip(File infile, boolean deleteGzipfileOnSuccess) throws IOException {
    GZIPInputStream gin = new GZIPInputStream(new FileInputStream(infile));
    FileOutputStream fos = null;
    try {
        File outFile = new File(infile.getParent(), infile.getName().replaceAll("\\.gz$", ""));
        fos = new FileOutputStream(outFile);
        byte[] buf = new byte[100000];
        int len;
        while ((len = gin.read(buf)) > 0) {
            fos.write(buf, 0, len);
        }

        fos.close();
        if (deleteGzipfileOnSuccess) {
            infile.delete();
        }
        return outFile; 
    } finally {
        if (gin != null) {
            gin.close();    
        }
        if (fos != null) {
            fos.close();    
        }
    }       
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T06:42:56.223

关于 A，该`gunzip`命令创建一个原始名称减去`.gz`后缀的未压缩文件。请参阅[手册页](http://www.manpagez.com/man/1/gunzip/)。

关于B，您是否需要专门使用gunzip，还是需要另一种压缩算法？7zip 使用 LZMA 压缩算法的[java 端口](http://www.7-zip.org/sdk.html)来创建`.7z`文件，但它不会处理`.gz`文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T06:54:00.713

如果你有固定数量的文件要解压一次，为什么不使用现有的工具呢？正如 Paul Morie 注意到的那样，`gunzip`可以做到这一点： `for i in *.gz; do gunzip $i; done` 它会自动命名它们，剥离`.gz$`

在 Windows 上，尝试 winrar，可能，或者`gunzip`从[http://unxutils.sf.net](http://unxutils.sf.net)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T06:55:19.040

GZip 通常只用于单个文件，因此它*通常*不包含有关单个文件的信息。要将多个文件捆绑到一个压缩存档中，首先将它们组合成一个未压缩的 Tar 文件（包含有关单个内容的信息），然后压缩为单个文件。这种组合称为 Tarball。

有一些库可以从 Tar 中提取单个文件信息，就像 ZipEntries 一样。[一个例子。](http://www.trustice.com/java/tar/) 您首先必须将 .gz 文件提取到一个临时文件中才能使用它，或者至少将 GZipInputStream 输入到 Tar 库中。

您也可以使用 Java 从命令行调用 7-Zip。7-Zip 命令行语法在这里：[7-Zip 命令行语法。](http://dotnetperls.com/Content/7-Zip-Examples.aspx) 从 Java 调用命令 shell 的示例：[在 Java 中执行 shell 命令。](http://ihategeek.wordpress.com/2007/10/19/execute-command-prompt-thru-java/) 您将不得不调用 7-Zip 两次：一次是从 .tar.gz 或 .tgz 文件中提取 Tar，另一次是从 Tar 中提取单个文件。

或者，您可以做简单的事情并编写一个简短的 shell 脚本或批处理文件来进行解压缩。没有理由在圆孔中锤击方钉——这就是批处理文件的用途。作为奖励，您还可以为它们提供参数，从而大大降低了 java 命令行执行的复杂性，同时仍然让 java 控制执行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T07:41:08.370

你有没有尝试过

```
gunzip *.gz 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-24T01:30:30.207

.gz 文件（gzipped）可以存储压缩文件的文件名。因此，例如 FuBar.doc 可以保存在 myDocument.gz 中，并通过适当的解压缩，文件可以恢复为文件名 FuBar.doc。不幸的是，java.util.zip.GZIPInputStream 不支持任何读取文件名的方式，即使它存储在存档中也是如此。

# windows - 确定 TCP/IP 端口是否已在 Windows 下使用？

> ID：901006
> 
> 赞同：1
> 
> 时间：2009-05-23T06:23:29.000
> 
> 标签：windows, sockets, windows-vista, tcp

我使用的跨平台开发环境有一个内置函数，应该指示 tcp 端口是否可用。但是，该功能在 Vista 下出现故障并始终返回“可用”。

有没有一种简单的方法，例如 dll 函数，我可以在不需要 .Net 的情况下正确确定这些信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T06:33:44.927

您可以尝试使用常用的 Winsock 函数绑定和监听端口。如果其他东西已经在同一个端口上监听，你会得到一个错误（`WSAEADDRINUSE`from [`bind()`](http://msdn.microsoft.com/en-us/library/ms737550(VS.85).aspx)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T06:57:15.557

为避免引入额外的依赖项或特定于 Windows 的代码，您可以简单地尝试使用该端口并捕获任何问题（例如被防火墙软件拦截）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T15:17:36.577

只需使用 Win32 Nw api 来枚举 TCP 端口。

# php - 在 CakePHP 中将数组发送到 REST 服务

> ID：901014
> 
> 赞同：0
> 
> 时间：2009-05-23T06:34:08.157
> 
> 标签：php, cakephp, rest

我目前正在使用 CakePHP 编写 REST 服务，我想知道如何通过 REST 将 item_ids 数组发送到操作。

```
class ItemsController extends AppController {

var $components = array('RequestHandler');
var $helpers = array('Text', 'Xml');

function index()
{

}

function create($itemsArr)
{
        //handle $itemsArr here and sends data as xml to views.
}

} 
```

我想我真正的问题是，请求会是什么样子？

[http://mysite/items/create/](http://mysite/items/create/) ???

我想我可以将值作为 1 个参数传递，`implode(someSeperator, array)`但有更好的解决方案吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-25T02:55:42.520

这不是 REST。REST 是关于使用 HTTP，而不是 XML！

创建项目的典型 HTTP 请求是这样的

```
PUT http://mysite/items/ HTTP/1.1
Host: xxxxx

<myitem>
<text> asdasdas </text>
</myitem> 
```

您可以在请求正文中使用任何您想要的内容。XML、JSON、PHP SERIALIZE 或您自己的数据格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T10:59:12.123

如果您真的想对此保持 RESTful，那么您肯定希望使用 POST 请求来创建记录。那是如果您对标准严格要求的话，但这也会对您有所帮助，因为我读到您的数组的长度可能会有很大差异 - 有时是 1 个 ID，可能是 30 个其他时间，等等。URI 查询字符串（或曾经？ ) 有一个最大字符数限制，你可以想象会遇到这个限制。

如果你使用 POST 请求，你可以很容易地传入一个逗号分隔的列表（想想一个带有多个复选框的字段名称是如何传递的），或者，我最喜欢的机制，一个 JSON 编码的数组（表示为一个字符串，可以很容易地在另一端进行 JSON 解码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T07:55:44.287

这实际上适用于任何网页，而不仅仅是 CakePHP。

任何想要发送大量字段的网页都必须将它们全部包含在他们的 POST 请求中。

如果您有一个包含 50 个输入并在底部提交的网页表单，则该页面默认会序列化数据并在表单请求中发送。

如果您不希望在单独的栏中发送所有数据，那么使用分隔符也可以正常工作，这意味着它们都进入了 1 个参数。

像：

```
http://mysite/items/create?mydata=23-45-65-32-43-54-23-23-656-77 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T08:31:01.093

另外的选择：

```
$safedata = base64_encode(serialize($arrayofdata)); 
```

并将其作为安全字符串传递给 URL。

然后解压缩它：

```
$data = unserialize(base64_decode($safedata); 
```

# silverlight - Silverlight的秒表？

> ID：901021
> 
> 赞同：22
> 
> 时间：2009-05-23T06:43:18.173
> 
> 标签：silverlight

Silverlight 没有秒表。

你会用什么来代替它？

我看到一些关于人们说要创建一个空动画并从 Storyboard 类调用 GetCurrentTime() 的帖子，但我无法让它工作......

你会怎么做？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2011-01-06T06:35:48.357

这就是我所做的。它很简单，对我来说效果很好：

```
long before = DateTime.Now.Ticks;
DoTheTaskThatNeedsMeasurement();
long after = DateTime.Now.Ticks;

TimeSpan elapsedTime = new TimeSpan(after - before);
MessageBox.Show(string.Format("Task took {0} milliseconds",
    elapsedTime.TotalMilliseconds)); 
```

您需要做的就是在开始目标任务之前保留一个长变量来保存总滴答数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-24T00:13:11.657

看我的手表在[这里](http://xmldocs.net/ball2)。源代码在[这里](http://code.msdn.microsoft.com/trainmaster)。关于它的两篇文章在[这里](http://blogs.msdn.com/synergist/archive/2008/09/19/updated-ball-trainmaster-cannonball-watch-to-silverlight-2.aspx)和[这里](http://blogs.msdn.com/synergist/archive/2008/05/24/beauty-with-silverlight.aspx)。Silverlight 动画模型非常适合秒表。

[替代文字 http://xmldocs.net/ball2/background.png](http://xmldocs.net/ball2/background.png)

```
<Storyboard x:Name="Run" RepeatBehavior="Forever">
<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" 
    Storyboard.TargetName="SecondHand" x:Name="SecondAnimation" 
    Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[2].(RotateTransform.Angle)" RepeatBehavior="Forever">
    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="0"/>
    <SplineDoubleKeyFrame KeyTime="00:01:00" Value="360"/>
</DoubleAnimationUsingKeyFrames>
<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" 
    Storyboard.TargetName="MinuteHand" 
    Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[2].(RotateTransform.Angle)" RepeatBehavior="Forever">
    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="0"/>
    <SplineDoubleKeyFrame KeyTime="01:00:00" Value="360"/>
</DoubleAnimationUsingKeyFrames>
<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" 
    Storyboard.TargetName="HourHand" 
    Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[2].(RotateTransform.Angle)" RepeatBehavior="Forever">
    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="0"/>
    <SplineDoubleKeyFrame KeyTime="12:00:00" Value="360"/> 
```

运行该故事板的代码在这里：

```
private void RunWatch()
{
    var time = DateTime.Now;

    Run.Begin();

    Run.Seek(new TimeSpan(time.Hour, time.Minute, time.Second));
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-12-07T19:10:20.580

这是一个可以添加到项目中的[秒表替换类。](http://www.wiredprairie.us/blog/index.php/archives/723)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-23T07:39:50.853

你可以用这个做一些事情。拳头是使用 Environment.TickCount 之类的东西，就像[这里](http://www.wiredprairie.us/blog/index.php/archives/723)的人一样。但是，我认为可能更好的方法是使用[DispatcherTimer](http://www.wiredprairie.us/blog/index.php/archives/723)。

要将 DispatcherTimer 设置为像秒表一样工作，我们还需要一个关联的 TimeSpan 来表示它的运行时间。我们可以实例化 DispatcherTimer 并设置它的时间间隔，以及 Tick 事件的处理程序。

```
DispatcherTimer _timer;
TimeSpan _time;
public Page()
{
    InitializeComponent();
    _timer = new DispatcherTimer();

    _timer.Interval = new TimeSpan(0, 0, 0, 0, 10);
    _timer.Tick += new EventHandler(OnTimerTick);
} 
```

在 UI 中，我们可以创建一些简单的东西来启动和停止我们的计时器，以及显示秒表数据：

```
 <StackPanel>
        <Button Content="Start" x:Name="uiStart" Click="OnStartClick"  />
        <Button Content="Stop" x:Name="uiStop" Click="OnStopClick" />
        <TextBlock x:Name="uiDisplay"/>
 </StackPanel> 
```

现在，剩下的就是事件处理程序。
OnTimerTick 处理程序将递增并显示我们的秒表数据。
我们的 Start 处理程序将负责初始化/重新初始化 TimeSpan，而 Stop 处理程序只会停止 DispatcherTimer。

```
 void OnTimerTick(object sender, EventArgs e)
 {
     _time = _time.Add(new TimeSpan(0, 0, 0, 0, 10));
     display.Text = _time.ToString();
 }       
 private void OnStartClick(object sender, RoutedEventArgs e)
 {
     _time = new TimeSpan(0,0,0,0,0);
     _timer.Start();  
 }
 private void OnStopClick(object sender, RoutedEventArgs e)
 {
     _timer.Stop();
 } 
```

# iphone - 从 iphone 中的此信息加载谷歌地图？

> ID：901023
> 
> 赞同：0
> 
> 时间：2009-05-23T06:43:56.673
> 
> 标签：iphone, xcode, google-maps

大家好，我有一个 UITableCell，其中包含一些详细信息，例如“550 Ashbury St., San Francisco, CA, 94117”。详细信息来自数据库。现在我希望当我单击单元格时应该加载一个新视图带有这个地址的谷歌地图。知道如何实现这一目标吗？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T05:42:24.763

使用 iPhone OS 3.0，其中包含使用 Google 地图的 MapKit 框架。您不再需要使用浏览器的方式，因为使用 MapKit 您可以将自己的地图嵌入到应用程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T06:54:52.740

我这样做是为了在我的服务器上创建一个简单的网页，该网页设置谷歌地图并包含一个 javascript 函数，该函数将位置作为字符串参数。该函数负责设置谷歌地图以显示地址。

然后我在 a 中加载页面`UIWebView`并构造 javascript，它使用参数执行我的 javascript 函数，例如：

```
NSString* js = [NSString stringWithFormat:@"setup('%@')", location]; 
```

然后我执行它使用：

```
[googleMapView stringByEvaluatingJavascriptFromString:js]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T09:18:19.127

您需要对地址进行[地理编码](http://code.google.com/apis/maps/documentation/services.html)，将其转换为 GPS 坐标，即纬度和经度。Google 不是唯一提供此功能的网络服务，但您可能会为此目的使用一些网络服务。

获得坐标后，您可以将它们提供给 iPhone 3.0 SDK 中的 MapKit 组件，您可以在[Apple Developer Connection](http://developer.apple.com/)阅读更多信息。

# iphone - iphone本机应用程序中奇怪的闪屏问题？

> ID：901028
> 
> 赞同：0
> 
> 时间：2009-05-23T06:47:12.300
> 
> 标签：iphone, xcode, ios-simulator

我有一个应用程序，我根据苹果的文档将 Default.png 用于启动画面。启动画面显示正常。但是当我删除 Default.png 并且 png.it 的引用没有被删除时，它仍然显示启动画面。我在模拟器中运行程序。？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T07:31:34.913

简单的解决方案：

1.  停止任何 iPhone 模拟
2.  在 XCode 中单击菜单栏中的 Build -> Clear
3.  取消选中这两个框并单击“清理”
4.  重建您的应用程序。

# iphone - 如何在 iphone 的一个视图中对文本字段设置不同的最大字符数限制？

> ID：901033
> 
> 赞同：0
> 
> 时间：2009-05-23T06:52:24.367
> 
> 标签：iphone, xcode

我有一个 UIView，上面有 10 个 UITextFields。我想限制每个 UItextField 上不同的最大字符长度。假设在第一个文本字段上，最大长度应该是 17，第二个和第三个应该是 2。我该如何实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T07:05:30.003

当文本视图内容的长度等于或大于最大长度时，实现`UITextViewDelegate`with`textView:shouldChangeTextInRange:replacementText`并返回。`NO`唯一的例外是当`replacementText`为空时，在这种情况下你应该总是返回`YES`

# c# - 为什么我们在 HashTable 中使用 Hash Code 而不是 Index？

> ID：901034
> 
> 赞同：10
> 
> 时间：2009-05-23T06:52:29.717
> 
> 标签：c#, algorithm, hash

*   GetHashCode() 函数如何生成整数哈希？它是一个不唯一的随机值吗？

*   在字符串中，它被覆盖以确保特定字符串仅存在一个哈希码。怎么做？

*   如何使用哈希码加快在哈希表中搜索特定键的速度？

*   与直接在集合中使用索引（如在数组中）相比，使用哈希码有什么优势？

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-23T07:09:38.263

基本上，哈希函数使用一些通用函数来消化数据并为该数据生成指纹（此处为整数）。与索引不同，此指纹仅取决于数据，并且不应基于数据进行任何可预测的排序。对单个数据位的任何更改也应显着更改指纹。

请注意，这并不能保证不同的数据不会给出相同的哈希值。事实上，恰恰相反：这种情况经常发生，称为碰撞。但是，对于一个整数，这个概率大约是 40 亿分之一（2^32 分之一）。如果发生冲突，您只需比较您正在散列的实际对象以查看它们是否匹配。

然后可以将此指纹用作存储值数组（或数组列表）的索引。因为指纹只依赖于数据，所以您可以计算某物的哈希值，然后检查该哈希值的数组元素以查看它是否已经存储。否则，您必须检查整个数组是否与某个项目匹配。

您还可以通过使用 2 个数组来非常快速地创建关联数组，一个具有键值（由哈希索引），另一个具有映射到这些键的值。如果使用散列，则只需要知道键的散列即可找到键的匹配值。这比在排序的键列表上进行二进制搜索或扫描整个数组以查找匹配键要快得多。

生成哈希的方法有很多，它们都有不同的优点，但很少有简单的。我建议查阅有关散列函数的维基百科页面以获取更多信息。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-23T15:41:10.023

哈希码是一个索引，而哈希表在其最低级别是一个数组。但是对于给定的键值，我们以不同的方式确定哈希表中的索引，以加快数据检索速度。

示例：您有 1,000 个单词及其定义。您希望存储它们，以便您可以非常非常快速地检索单词的定义 - 比二进制搜索更快，这是您必须对数组执行的操作。

因此，您创建了一个哈希表。您从一个远大于 1,000 个条目的数组开始——比如 5,000 个（越大，时间效率越高）。

您使用表格的方式是，您查找单词，然后将其转换为 0 到 4,999 之间的数字。您选择执行此操作的算法；这就是哈希算法。但毫无疑问，你可以写出非常快的东西。

然后，您使用转换后的数字作为 5,000 元素数组的索引，并在该索引处插入/查找您的定义。根本没有搜索：您直接从搜索词*创建了索引。*

我描述的所有操作都是常数时间。当我们增加条目数量时，它们都不会花费更长的时间。我们只需要确保散列中有足够的空间来最小化“冲突”的机会，即两个不同的词将转换为相同的整数索引的机会。因为任何散列算法都可能发生这种情况，所以我们需要添加检查以查看是否存在冲突，并做一些特殊的事情（如果“hello”和“world”都散列到 1,234 并且“hello”已经在表中，那么我们会使用“world”吗？最简单的方法是将其放入 1,235，并调整我们的查找逻辑以允许这种可能性。）

编辑：重新阅读您的帖子后：哈希算法绝对不是随机的，它必须是确定性的。在我的示例中为“hello”生成的索引每次必须为 1,234；这是查找工作的唯一方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T09:10:02.513

HashCode 是一个伪唯一键。我们希望有一个真正独特的密钥，但这是不可行的。我们满足于快速且安全（无例外）的功能。

[HashTable](http://en.wikipedia.org/wiki/Hashtable)最初使用HashCode 在 O(1) 时间内进行查找。任何索引方案都需要 O(log(n)) 时间。但是使用低效的 HashCode 函数，冲突处理会​​使 HashTable 变慢很多。

在 .NET 中有 GetHashCode 的默认实现，但类型可以覆盖它。

System.String 覆盖 GetHashCode() 因为它覆盖 Equals() 然后 GetHashCode 必须保持一致。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-23T09:41:55.383

直接回答您的每一个问题：

> GetHashCode() 函数如何生成整数哈希？它是一个不唯一的随机值吗？

整数散列由适合对象的任何方法生成。生成方法不是随机的，但必须遵循一致的规则，确保为一个特定对象生成的哈希等于为等效对象生成的哈希。例如，整数的散列函数将简单地返回该整数。

> 在字符串中，它被覆盖以确保特定字符串仅存在一个哈希码。怎么做？

有很多方法可以做到这一点。这是我在现场考虑的一个例子：

```
int hash = 0;
for(int i = 0; i < theString.Length; ++i)
{
    hash ^= theString[i];
} 
```

这是一个有效的哈希算法，因为相同的字符序列总是会产生相同的哈希数。这不是一个*好的*散列算法（极端轻描淡写），因为许多字符串会产生相同的散列。有效的哈希算法不必保证唯一性。一个*好的*哈希算法将使两个不同的对象产生相同数字的可能性极小。

> 如何使用哈希码加快在哈希表中搜索特定键的速度？与直接在集合中使用索引（如在数组中）相比，使用哈希码有什么优势？

哈希码通常用于哈希表中。哈希表是一个数组，但数组中的每个条目都是项目的“桶”，而不仅仅是一个项目。如果你有一个对象，你想知道它属于哪个桶，计算

```
 hash_value MOD hash_table_size. 
```

然后，您只需将该对象与存储桶中的每个项目进行比较。因此，哈希表查找的搜索时间很可能为 O(1)，而排序列表的搜索时间为 O(log(N))，未排序的列表为 O(N)。

# c# - 在 C# 中使用 asp.net 表单登录屏幕抓取网站？

> ID：901045
> 
> 赞同：7
> 
> 时间：2009-05-23T07:04:47.417
> 
> 标签：c#, screen-scraping

是否可以为受表单登录保护的网站编写屏幕抓取工具。当然，我可以访问该站点，但我不知道如何登录该站点并将我的凭据保存在 C# 中。

此外，非常感谢 C# 中任何好的屏幕截图示例。

这已经完成了吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T08:46:54.760

这很简单。您需要自定义登录 (HttpPost) 方法。

你可以想出这样的东西（这样你会在登录后得到所有需要的cookies，你只需要将它们传递给下一个HttpWebRequest）：

```
public static HttpWebResponse HttpPost(String url, String referer, String userAgent, ref CookieCollection cookies, String postData, out WebHeaderCollection headers, WebProxy proxy)
    {
        try
        {
            HttpWebRequest http = WebRequest.Create(url) as HttpWebRequest;
            http.Proxy = proxy;
            http.AllowAutoRedirect = true;
            http.Method = "POST";
            http.ContentType = "application/x-www-form-urlencoded";
            http.UserAgent = userAgent;
            http.CookieContainer = new CookieContainer();
            http.CookieContainer.Add(cookies);
            http.Referer = referer;
            byte[] dataBytes = UTF8Encoding.UTF8.GetBytes(postData);
            http.ContentLength = dataBytes.Length;
            using (Stream postStream = http.GetRequestStream())
            {
                postStream.Write(dataBytes, 0, dataBytes.Length);
            }
            HttpWebResponse httpResponse = http.GetResponse() as HttpWebResponse;
            headers = http.Headers;
            cookies.Add(httpResponse.Cookies);

            return httpResponse;
        }
        catch { }
        headers = null;

        return null;
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T07:48:58.760

当然，这已经完成了。我已经做过几次了。这（通常）称为[屏幕抓取](http://en.wikipedia.org/wiki/Screen-scraping)或网页抓取。

你应该看看[这个问题](https://stackoverflow.com/questions/519387/writing-a-c-program-that-scans-ecommerce-website-and-extracts-products-pictures)（也可以浏览标签“ [screen-scraping](https://stackoverflow.com/questions/tagged/screen-scraping) ”下的问题。请注意，Scraping 不仅与从 Web 资源中提取数据有关。它还涉及将数据提交到在线表单以便模仿用户在提交输入（例如登录表单）时的操作。

# java - 覆盖paint或paintComponent时需要恢复图形原始状态

> ID：901046
> 
> 赞同：9
> 
> 时间：2009-05-23T07:05:28.973
> 
> 标签：java, swing, graphics, awt

我意识到大多数Java代码都可以覆盖paint或paintComponent，它们中的大多数在更改图形对象的状态后都不会恢复图形对象的旧状态。例如，setStroke、setRenderingHint...

我想知道在从方法返回之前恢复图形对象的旧状态是否是一个好习惯。例如

```
public void paintComponent(Graphics g) {
    super.paintComponet(g);
    Stroke oldStroke = g.getStroke();
    g.setStroke(newStroke);
    // Do drawing operation.
    g.setStroke(oldStroke);
} 
```

这是一个好习惯吗？还是结束了？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-23T09:00:06.077

您根本不应更改传入的 Graphics 对象，而应在其副本上执行所有图形操作，然后将其处置。那时根本不需要重置状态。

```
public void paintComponent(Graphics g1) {
    super.paintComponent(g1);
    final Graphics2D g = (Graphics2D)g1.create();
    try {
         // ...Whole lotta drawing code...
    } finally {
         g.dispose();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T07:14:17.910

是的，**这是一个非常好的做法。** 您不会在性能上付出太多（相对于实际的绘画操作），如果您对图形上下文进行不寻常的更改，您会为自己省去一团糟。不过不要过度——例如，您可能不需要担心颜色设置。

另一种方法是对图形上下文不做任何假设，并在每次绘画之前设置所有必要的属性，以防它们被设置为不可靠的东西。 **尽量避免为每个操作随意创建和处置 Graphics 对象。**

**如果修改，您应该始终恢复特定属性：（**因为它们可能会做坏事并产生意外后果）：

*   变换 - 因为对此的修改将叠加在一起并且变得非常非常难以重置。注意：这是由 Graphics2D 的 translate、shear、scale、rotate 和 transform 方法修改的。修改转换应谨慎使用。
*   中风 - 因为（至少在我的配置中），保留此默认设置比*任何设置*运行得快得多，即使相当于默认设置。别问——这是 Java2D 图形管道使用图形硬件加速默认情况的结果。
*   Clip：将导致仅绘制部分屏幕的奇怪错误。
*   复合：大多数操作可能并不认为这是奇怪的事情。

**不用担心的属性：**

*   渲染提示。这些是您可以轻松设置和恢复的内容，通常您希望在应用程序运行的整个过程中以某种方式设置它们（抗锯齿等）。更改 RenderingHints 很少会破坏组件的渲染，尽管它可能会使它变得更丑陋。
*   背景颜色和油漆颜色。无论如何，大多数事情都会在绘制之前修改这些。
*   字体：同样。

# iphone - 不能在 Objective-C 描述方法中包含“self”？

> ID：901048
> 
> 赞同：8
> 
> 时间：2009-05-23T07:05:46.617
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我有一个非常直接的类，主要是 NSString 类型的属性。在其中，我编写了描述方法的简单实现。我发现每当我尝试在描述中包含“self”时，它都会使我的 iPhone 应用程序崩溃。一个示例如下所示：

```
- (NSString *)description
{
    NSString *result;

    result = [NSString stringWithFormat:@"me: %@\nsomeVar: %@", self, self.someVar];

    return result;
} 
```

一旦我删除格式字符串的第一个参数self，它就会按预期工作。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-23T07:18:30.477

使用`%p`for `self`，就会显示 的地址`self`。如果你使用`%@`，那么它将调用`description`on `self`，这将建立一个无限递归。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-07T01:56:10.980

您可以使用 [super description] 而不是 self 来避免无限递归，如下所示：

```
- (NSString *)description
{
    return [NSString stringWithFormat:@"%@: %@", [super description], [self someVar]];
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-23T07:10:43.317

您确实意识到这会设置无限递归。

`description`当您传入时，您的实现隐式调用自身，`self`然后调用自身，依此类推。

您的崩溃很可能是由于堆栈空间用完......如果您愿意，可以使用“stackoverflow”。适合考虑现场:-)

# mysql - 如何在 Visual Studio 2010 中连接到 MySQL 5.1？

> ID：901049
> 
> 赞同：22
> 
> 时间：2009-05-23T07:07:30.250
> 
> 标签：mysql, visual-studio-2010

有人知道如何使用[Visual Studio 2010连接到](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2010)[MySQL](http://en.wikipedia.org/wiki/MySQL) 5.1吗？

我已经尝试过[MySQL 连接器/ODBC](http://dev.mysql.com/downloads/connector/odbc/5.1.html)路由，但结果非常糟糕。表行都作为视图列在视图部分中，表或过程文件夹中根本没有列出任何内容。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-05-07T05:34:12.357

为了让实体框架与 VS2010 一起工作，我必须执行以下操作：

1.  这仅适用于 Mysql .net Connector v6.3.1 (alpha)。以前的版本忽略了 VS 2010（点击 Development Releases）
2.  我不得不重命名我的 Framework\v1.1.4322\CONFIG 文件夹。否则安装会失败。完成后重命名

（我在[这里](http://christianpayne.com.au/2010/05/07/vs-2010-mysql-entity-framework-and-setup-wizard-ended-prematurely-because-of-an-error/)写过关于这个的博客）

**更新** [6.3.2 处于测试阶段](http://dev.mysql.com/downloads/mirror.php?id=389424)，我可以确认这是可行的。（我不需要重命名框架文件夹）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-02-23T20:11:23.570

## **这似乎解决了这个问题**

最新发布的更新链接感谢@Christian Payne

**更新**：看起来已经有非测试版了！！！！

[http://www.mysql.com/downloads/connector/net/](http://www.mysql.com/downloads/connector/net/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-04-23T10:56:48.363

正如其他人建议的那样..

[http://dev.mysql.com/downloads/mirror.php?id=382641](http://dev.mysql.com/downloads/mirror.php?id=382641)

..解决问题。

我在安装 vs2010 后安装了 v6.2.3，并且 MySQL 驱动程序未显示在“数据库连接”对话框的列表中。我错误地认为我应该改用 .NET ODBC 驱动程序，这会导致各种问题。尽管我可以使用代码隐藏轻松连接到数据库，但服务器资源管理器不会连接到数据库。

幸运的是，在卸载 6.2.3 并安装 6.3.0（来自上面的链接）后，MySQL 驱动程序已添加到 VS2010，我能够连接到数据库并在我的服务器资源管理器中看到它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-16T10:13:52.337

[http://bugs.mysql.com/bug.php?id=45122](http://bugs.mysql.com/bug.php?id=45122)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-02-04T17:51:26.707

通过执行以下操作，我能够使其工作：

**我的环境：**

*   开发盒——Win7 64bit, VS2010 Pro
*   Deployment Box -- Win2k8 svr with IIS7 running ASP.NET .Net 2.0/3.0/3.5 sp 托管在 DiscountAsp.Net 上（注意：DiscountAsp.Net 在 Win2k8 svr 上运行时不提供 MySQL DB，我正在使用我连接到 InterWebs 上其他地方的 MySQL 数据库）

**我采取的步骤：**

1.  安装 MySql.Data，版本=6.3.6.0，文化=中性，PublicKeyToken=c5687fc88969c44d
2.  在我的 ASP.NET MVC2 Web 项目中将 MySQL 程序集的 .Net 2.0 版本设置为目标 .Net 3.5（我使用的 MySQL 程序集的路径是 C:\Program Files (x86)\MySQL\MySQL Connector Net 6.3.6\程序集\v2.0)
3.  我引用了所有 3 个 MySQL 程序集（MySql.Data.dll、MySql.Data.Entity.dll 和 MySql.Web.dll）
4.  我在我的项目（又名 bin 部署）中将这些程序集中的每一个标记为“Copy Local=True”
5.  向我的项目添加了一个 MySQL 数据库连接字符串（使用 MySQL 提供程序）
6.  在 VS2010 中使用连接字符串向我的项目添加了 ADO.NET 实体数据模型
7.  VS2010 花了大约 30 秒的时间来浏览我的 MySQL DB 模式，但随后为我提供了一个漂亮的 GUI 界面来调整我的 MVC 模型
8.  在我的 MVC 控制器中使用了数据库实体
9.  将应用程序部署到我在 DiscountAsp.Net 上的托管服务器

它就像一个魅力:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-23T08:52:29.490

嗯...通过代码？或者你的意思是服务器资源管理器加载项？您是否尝试过来自 Mysql 的 .NET 的最新（尽管是 GPL 版）连接器版本？同样，它是 GPL 版的，因此请注意将其用于您自己的软件的后果。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-30T21:29:55.140

Microsoft Visual Studio 2010 Beta 2 被[DDEX](http://en.wikipedia.org/wiki/Digital_Data_Exchange)提供程序破坏。他们正在自动将 VS 2008 程序集从 9.0 升级到 10.0，但它失败了。失败与 .NET 2 程序集无法加载 .NET 4 程序集这一事实有关。

这在 beta 1 中有效，所以这是他们破坏的东西。

我什至回去尝试了 SDK 中的参考 DDEX 提供程序。它也不会在 VS 2010 beta 2 中加载。这告诉我他们有一些东西需要修复。

下一个测试版是什么时候？

# android - 在 Android 的 SQLite 中创建数据库的问题

> ID：901057
> 
> 赞同：1
> 
> 时间：2009-05-23T07:12:15.043
> 
> 标签：android

嗨，我是 android 新手，在创建数据库时遇到问题。

```
public class database extends ListActivity {
    /** Called when the activity is first created. */
    private final String MY_DATABASE_NAME = "myCoolUserDB.db";
    private final String MY_DATABASE_TABLE = "t_Users"; 
    Context c;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        ArrayList<String> results = new ArrayList<String>();
        setContentView(R.layout.main);
        SQLiteDatabase mydb=null;
        try
        {
            mydb.openOrCreateDatabase(MY_DATABASE_NAME,  null);

        } catch(Exception e){}
    }
} 
```

当我运行此代码时，它会引发运行时异常。请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-03T12:02:09.750

1.  如果要调用像 openOrCreateDatabase 这样的静态方法，请在类 (SQLiteDatabase.openOrCreateDatabase(...)) 上执行，而不是在实例上执行。它更清晰 - 你所做的方式看起来像你正在调用一个实例方法，所以看起来肯定是 NullPointerException，这当然是误导性的。

2.  正如其他人所说，在寻求异常帮助时，堆栈跟踪将是最有用的东西。

3.  （几乎）永远不会在不记录异常的情况下捕获异常。不要只是什么都不做。当然，每条规则都有例外，但我们暂时不要去那里。无论如何，如果您至少不记录它，那么您只是在丢弃信息，这些信息会在以后一切都变得废话时告诉您出了什么问题。

4.  您不应该直接使用该方法，而应该扩展[SQLiteOpenHelper](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)。请参阅有关数据存储的 android 开发人员页面以开始使用（我会发布一个链接，但显然我的帖子中只允许一个链接？！），并且由于您可能必须下载 SDK 才能开始使用，请看在记事本示例应用程序附带的示例中。它包含一个 NotePadProvider 类，它是内容提供者和数据库访问的一个很好的例子，它们在 android 上经常齐头并进。我建议在您开始制作自己的应用程序之前编译该应用程序并对其进行一些简单的更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T12:46:22.717

要使用 sqlite 数据库，您需要创建从 SQLiteOpenHelper 扩展的类：

```
private class DBHelper extends SQLiteOpenHelper {   

    public DBHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(CREATE_TABLES);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        db.execSQL(UPGRADE_TABLES);
    }

} 
```

然后您可以使用 DbHelper 对象访问 db：

```
DBHelper dbHelper = new DBHelper(Activity.this);
SQLiteDatabase db = dbHelper.getReadableDatabase(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-26T19:50:36.620

我遇到了同样的问题。它发现在开发过程中发生了两个错误

*   目录“数据库”不存在
*   顺便说一句，“.db”被创建为目录。

他们遵循的代码涵盖了两者

```
File dbFile = getDatabasePath ("abc.db");

if (dbFile.isDirectory ()) {
    dbFile.delete();
}
if (! dbFile.exists()) {
    String path = dbFile.getParent ();
    new File (path).mkdirs ();
}
database  = SQLiteDatabase.openDatabase (dbFile.getAbsolutePath (), this, SQLiteDatabase.OPEN_READWRITE | SQLiteDatabase.CREATE_IF_NECESSARY); 
```

希望这可以帮助

我认为 SQLiteOpenHelper 仅对“单表”数据库有用。对于多表应用程序，我认为直接使用 SQLiteDatabase 更适合良好的架构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-29T09:41:06.740

这是一篇简单的文章，它告诉您[如何在 Android 中将数据插入到 SQLite 数据库中](http://anujarosha.wordpress.com/2011/12/12/how-to-insert-data-in-to-a-sqlite-database-in-android/)，此外，此链接还向您[展示了如何从 Android 中的 SQLite 数据库中检索数据](http://anujarosha.wordpress.com/2011/12/19/how-to-retrieve-data-from-a-sqlite-database-in-android/)。

# jquery - jQuery 逻辑不影响 DIV 中的子级

> ID：901058
> 
> 赞同：0
> 
> 时间：2009-05-23T07:13:22.047
> 
> 标签：jquery

我的页面上有以下 DIV。我在鼠标悬停和鼠标移出时增加/减小 LeftDiv (div id="leftc") 的宽度

```
<div id="outerwrap">
    <div id="innerwrap">
        <div id="centerc">...</div>

        <div id="rightc" style="font-weight:bold">
        </div>
        <div style="background-color:White;height:10px;top:284px;left:0px"></div>

        <div id="leftc">..</div>
    </div>
    <div id="footer" ">...</div>
</div> 
```

jQuery逻辑，

```
<script type="text/javascript">
    $(document).ready(function () {
        $("#leftc").hover(
            function mouseover() {
                $(this).css({ width: "190px" });
                $("#centerc").css({ "margin-left": "195px" });
            },
            function mouseout() {
                $(this).css({ width: "25px" });
                $("#centerc").css({ "margin-left": "29px" });
            }
        );
    });
</script> 
```

如果 leftdiv 没有子 div，这句话很好，但如果它有子 div，那么它们不会受到影响。

如何编写 jQuery 以便子 div 也像父 div 一样缩小和扩展？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T07:34:24.297

这也会改变所有子 div 的宽度

```
<script type="text/javascript">
    $(document).ready(function () {
        $("#leftc").hover(
            function mouseover() {
                $(this).css({ width: "190px" });
                $("#leftc div").css({ width: "190px" }); // added this line
                $("#centerc").css({ "margin-left": "195px" });
            },
            function mouseout() {
                $(this).css({ width: "25px" });
                $("#leftc div").css({ width: "25px" }); // added this line
                $("#centerc").css({ "margin-left": "29px" });
            }
        );
    });
</script> 
```

但你不应该这样做。您可能想检查您的 CSS（对子 div 使用液体宽度。）

# python - Django 没有在 settings.py 中获取对 INSTALLED_APPS 的更改

> ID：901061
> 
> 赞同：2
> 
> 时间：2009-05-23T07:15:26.833
> 
> 标签：python, django

我正在尝试让 South 工作 - 它在我的 PC 上运行良好，但我正在努力将它部署在我的虚拟主机上。

现在看来，我为从 INSTALLED_APPS 添加/删除项目所做的任何更改都没有被`syncdb`或拾取`diffsettings`。我已添加`south`到我的 INSTALLED_APPS 列表中，但是在我运行`syncdb`. 如果我更改其他设置，它们会被拾取，它似乎是 INSTALLED_APPS 不起作用。

如果我跑

```
from south.db import db 
```

从我得到的 shell 中`manage.py shell`，我没有收到任何导入错误，所以我认为 where `south`is 不是问题。我已经尝试删除所有其他应用程序（Django 标准应用程序除外），并且当我运行`syncdb`.

即使我完全删除了 INSTALLED_APPS，当我运行 manage.py diffsettings 时，我仍然会得到旧的 INSTALLED_APPS 列表。

任何想法我做错了什么？

谢谢，

多姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T16:22:33.170

如果您为应用程序编写迁移，syncdb 将无法工作。你必须使用

```
manage.py migrate 
```

syncdb 不适用于使用 south 进行迁移的应用程序。这些应用程序模型的变化只会根据南迁历史而被注意到。

[南迁文件](http://south.aeracode.org/wiki/Documentation)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T18:52:06.983

事实证明，答案是我是个白痴。我这样做了：

在`settings.py`：

```
...
INSTALLED_APPS = (
    ...
)
...

from localsettings import * 
```

在`localsettings.py`

```
...
INSTALLED_APPS = (
    ...
)
... 
```

我`localsettings.py`从`settings.py`, 创建了仅与项目当前位置相关的内容（如数据库设置），但忘记删除该`INSTALLED_APPS`部分。

为做出如此明目张胆的蠢事而道歉。

# c# - 对象引用未设置为对象 #3 的实例

> ID：901063
> 
> 赞同：4
> 
> 时间：2009-05-23T07:19:18.323
> 
> 标签：c#, asp.net-mvc, exception, nullreferenceexception

我在方法刚开始时就遇到了对象引用错误。

例如：

```
259: public ActionResult ShowAddress(FormCollection formCollection)
260: { 
```

在上面的示例中，我收到错误行号 260。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T10:06:39.670

这是问题评论中的代码

```
259: public ActionResult ShowAddress(FormCollection formCollection) { 
260:   long _userId= long.Parse(formCollection["UserId"].ToString()); 
261:   UserDetails _userDetails = _userDAL.GetUserDetails(_userId); 
262:   if(!string.IsNullOrEmpty(_userDetails.Address1)) return  RedirectToAction("GetAddress", "User"); else return View(); } 
```

如果您在第 260 行看到 NullReferenceException，则 formCollection 或 formCollection["UserId"] 的结果为 null。您需要在代码中考虑到这一点。例如，您可以执行以下操作。

```
public ActionResult ShowAddress(FormCollection formCollection) {
  if ( null == formCollection ) { 
    return View();
  }
  object obj = formCollection["UserId"];
  if ( null == obj ) {  
    return View();
  }
  long _userId = long.Parse(obj.ToString());
  ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T08:42:49.480

最后，有足够的信息来尝试发布答案......

我想 formCollection 必须为空。

PS：您将从阅读以下内容中受益：[http](http://catb.org/esr/faqs/smart-questions.html#intro) : //catb.org/esr/faqs/smart-questions.html#intro 将其视为对人寿保险的终身投资。

# c# - 在 getter 中返回子控件的属性是无限递归的吗？

> ID：901065
> 
> 赞同：1
> 
> 时间：2009-05-23T07:20:44.857
> 
> 标签：c#, winforms

所以......这个让我难住了。我正在使用 VS 2008 (C#)。

我有一些无限递归的代码，但对于我的一生，我无法解释为什么（好吧，我有一个猜测）。您可以通过执行以下操作重现问题：

1.  创建一个新的 Form 或 UserControl 类。向它添加一个子控件（按钮、标签等）。
2.  打开代码文件。重写 Font 属性并使其返回并设置子控件的 Font 属性，即

    ```
    class MyForm
    {
        public override Font Font
        {
            get { return childControl.Font; }
            set { childControl.Font = value; }  // not actually needed to reproduce 
        }
    } 
    ```

    您只需要 getter 返回子控件的属性即可重现问题。在下一次构建后不要为您的 Form 或 UserControl 打开设计器，VS 将崩溃。

3.  启动您的程序。由于 StackOverflow，它将崩溃。这发生在

    ```
    this.Controls.Add( childControl ); 
    ```

    设计器文件的行。对 Font 属性的 Get() 调用是递归的。

那么，有谁知道为什么在将子控件添加到 Controls 集合时，为什么在覆盖中返回子控件的属性会导致堆栈溢出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T07:28:41.657

那是因为获取控件的字体涉及查看父字体，在您的情况下，这涉及查看子字体，这涉及查看父字体，这涉及...

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.font(VS.80).aspx)：

> Font 属性是环境属性。环境属性是控件属性，如果未设置，则从父控件中检索。

# mysql - MYSQL 区分大小写搜索 utf8_bin 字段

> ID：901066
> 
> 赞同：19
> 
> 时间：2009-05-23T07:23:05.240
> 
> 标签：mysql, sql, character-encoding, case-sensitive, mysql-error-1267

我创建了一个表并将排序规则设置为**utf8**，以便能够向字段添加唯一索引。现在我需要进行不区分大小写的搜索，但是当我使用 collat​​e 关键字执行一些查询时，我得到了：

```
mysql> select * from page where pageTitle="Something" Collate utf8_general_ci; 
```

> 错误 1253 (42000): COLLATION 'utf8_general_ci' 对 CHARACTER SET 'latin1' 无效

```
mysql> select * from page where pageTitle="Something" Collate latin1_general_ci; 
```

> 错误 1267 (HY000): 非法混合排序规则 (utf8_bin,IMPLICIT) 和 (latin1_general_ci,EXPLICIT) 用于操作 '='

我对 SQL 很陌生，所以我想知道是否有人可以提供帮助。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-23T07:55:57.827

MySQL 中的字符串有一个[字符集和一个排序规则](http://dev.mysql.com/doc/refman/5.0/en/charset.html)。utf8 是字符集，utf8_bin 是它的排序规则之一。要将您的字符串文字与 utf8 列进行比较，请将其转换为 utf8，方法是在其前面加上 _charset 表示法：

```
_utf8 'Something' 
```

现在排序规则仅对某些字符集有效。utf8区分*大小写*的排序规则似乎是 utf8_bin，您可以指定如下：

```
_utf8 'Something' collate utf8_bin 
```

通过这些转换，查询应该可以工作：

```
select * from page where pageTitle = _utf8 'Something' collate utf8_bin 
```

_charset 前缀适用于字符串文字。要更改字段的字符集，有 CONVERT ... USING。当您想将 pageTitle 字段转换为另一个字符集时，这很有用，如下所示：

```
select * from page 
where convert(pageTitle using latin1) collate latin1_general_cs = 'Something' 
```

要查看名为“TAB”的表中名为“col”的列的字符和排序规则，请尝试：

```
select distinct collation(col), charset(col) from TAB 
```

可以通过以下方式找到所有字符集和排序规则的列表：

```
show character set
show collation 
```

utf8 的所有有效排序规则都可以通过以下方式找到：

```
show collation where charset = 'utf8' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-18T15:38:08.457

另请注意，如果使用“Collat​​e utf8_general_ci”或“Collat​​e latin1_general_ci”，即“强制”整理 - 这样的转换将阻止使用现有索引！这可能是未来性能的瓶颈。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-23T11:22:39.050

试试这个，它对我有用

SELECT * FROM `users`WHERE UPPER( `name`) = UPPER('josé') 整理 utf8_bin;

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T07:52:42.980

请问为什么在执行 SELECT 时需要显式更改排序规则？为什么不在排序时以您想要检索记录的方式进行整理？

您的搜索区分大小写时遇到的问题是您有一个二进制排序规则。尝试改用通用排序规则。有关区分大小写和排序规则的更多信息，请查看此处： [字符串搜索中的区分大小写](http://dev.mysql.com/doc/refman/5.0/en/case-sensitivity.html)

# python - 寻找子串

> ID：901070
> 
> 赞同：1
> 
> 时间：2009-05-23T07:29:12.763
> 
> 标签：python

在此先感谢。我想找到出现在 K 和 N 之间的所有子字符串，即使 K 和 N 出现在任意次数之间。例如
a='KANNKAAN'

输出;
[坎卡恩，坎恩，坎恩，卡恩]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T07:51:05.420

```
import re

def occurences(ch_searched, str_input):
    return [i.start() for i in re.finditer(ch_searched, str_input)]

def betweeners(str_input, ch_from, ch_to):
    starts = occurences(ch_from, str_input)
    ends = occurences(ch_to, str_input)
    result = []
    for start in starts:
        for end in ends:
            if start<end:
                result.append( str_input[start:end+1] )
    return result

print betweeners('KANNKAAN', "K", "N") 
```

那是你需要的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T12:06:24.857

其他方式：

```
def findbetween(text, begin, end):
    for match in re.findall(begin + '.*' +end, text):
        yield match
        for m in findbetween(match[1:], begin, end):
            yield m
        for m in findbetween(match[:-1], begin, end):
            yield m

>>> list(findbetween('KANNKAAN', 'K', 'N'))
['KANNKAAN', 'KAAN', 'KANN', 'KAN'] 
```

# fluent-nhibernate - 映射枚举列表

> ID：901072
> 
> 赞同：3
> 
> 时间：2009-05-23T07:30:04.417
> 
> 标签：fluent-nhibernate, enums, string, mapping

我有一个名为 UserPermissions 的表，它通过 userId 对用户表有一个 FK，然后是一个用于枚举字符串值的字符串列。

我看到的错误是 NHibernate.MappingException：来自表 UserPermissions 的关联引用了一个未映射的类：GotRoleplay.Core.Domain.Model.Permission

我的权限枚举：

```
 public enum Permission
{
    [StringValue("Add User")]
    AddUser,

    [StringValue("Edit User")]
    EditUser,

    [StringValue("Delete User")]
    DeleteUser,

    [StringValue("Add Content")]
    AddContent,

    [StringValue("Edit Content")]
    EditContent,

    [StringValue("Delete Content")]
    DeleteContent,
} 
```

我的用户类中的属性：

```
public virtual IList<Permission> Permissions { get; set; } 
```

我的数据库表：

```
CREATE TABLE dbo.UserPermissions
(
UserPermissionId            int                 IDENTITY(1,1) NOT NULL,
UserId                      int                 NOT NULL,
PermissionName              varchar (50)        NOT NULL,

CONSTRAINT PK_UserPermissions PRIMARY KEY CLUSTERED (UserPermissionId),
CONSTRAINT FK_UserPermissions_Users FOREIGN KEY (UserId) REFERENCES Users(UserId),
CONSTRAINT U_User_Permission UNIQUE(UserId, PermissionName)
) 
```

我尝试映射用户对象的权限属性：

```
HasManyToMany(x => x.Permissions)
             .WithParentKeyColumn("UserId")
             .WithChildKeyColumn("PermissionName")
             .WithTableName("UserPermissions")
             .LazyLoad(); 
```

我做错了什么，它无法将权限映射到枚举值列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-14T22:33:48.557

这是对我有用的方式

```
HasMany(x => x.Licences)
                .WithTableName("DriverLicence")
                .AsElement("Level").AsBag(); 
```

在这里查看更多[信息](https://stackoverflow.com/questions/432809/fluent-nhibernate-question)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T18:48:17.257

您需要指定类型，以便 NHibernate 可以将表中的值转换为 Permission 枚举的成员。

```
HasManyToMany(x => x.Permissions)
         .WithParentKeyColumn("UserId")
         .WithChildKeyColumn("PermissionName")
         .WithTableName("UserPermissions")
         .LazyLoad()
         .CustomTypeIs(typeof(Permission)); 
```

编辑添加：对不起，我应该注意到你有这个作为多对多。这是不可能的：你不能让一个用户集合（m:m 的另一端）挂在一个枚举上。您需要将其定义为 1:m 或创建权限表和类并将其映射为 m:m。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-14T21:34:40.437

我想我会发布我为我的解决方案选择的代码。这只是一种解决方法。我希望 Fluent 支持 Enum 列表，但在它支持之前，这是一个可能的解决方案：

枚举 - 这是我的枚举，你的标准枚举。

```
public enum PermissionCode
{
    //site permissions 1-99
    ViewUser = 1,

    AddUser = 2,

    EditUser = 3,

    DeleteUser = 4
} 
```

接下来，我有我的 Permission 课程。

```
public class Permission
{
    public virtual int PermissionId { get; set; }
    public virtual string PermissionName { get; set; }

    public virtual PermissionCode PermissionCode 
    {
        get
        {
            return (PermissionCode)PermissionId;
        }
    }
} 
```

如您所见，我有一个 ID 和一个名称，然后是一个将 Id 转换为我的 PermissionCode 枚举的属性。

映射如下所示：

```
public class PermissionMap : ClassMap<Permission>
{
    public PermissionMap() 
    {
        WithTable("Permissions");

        Id(x => x.PermissionId).GeneratedBy.Identity();

        Map(x => x.PermissionName);
    }
} 
```

由于 PermissionCode 属性是派生的，因此我们在映射中不做任何事情。

映射后面的表结构如下所示：

```
CREATE TABLE dbo.Permissions
(
    PermissionId                    int                 NOT NULL,
    PermissionName                  varchar (50)        NOT NULL,

    CONSTRAINT PK_Permissions PRIMARY KEY CLUSTERED (PermissionId)
) 
```

如果您想使用名称而不是整数值，您可以稍作修改。这取决于您的个人喜好。

# content-management-system - mojoPortal 还是 Umbraco？

> ID：901073
> 
> 赞同：15
> 
> 时间：2009-05-23T07:30:16.257
> 
> 标签：content-management-system, umbraco, mojoportal

我一直在寻找免费/开源 ASP.NET CMS / Portal 系统一段时间，并将其分为两个不同的系统。

Umbraco - [http://umbraco.org](http://umbraco.org)

mojoPortal - [http://www.mojoportal.com](http://www.mojoportal.com)

两者看起来都很棒，并且具有不同的吸引人的功能，但我正在寻找同时使用过这两种方法的人以及您选择了哪一种，为什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-05-05T06:42:31.097

实际上，我最终选择了 Umbraco，并且永远不会回头，它非常易于安装和使用

要安装，您可以使用 Web 平台安装程序来安装它，而且您只需单击几下即可轻松安装大量免费项目，使其成为迄今为止最好的 CMS

[http://our.umbraco.org/projects](http://our.umbraco.org/projects)

如果您不确定从哪里开始，请阅读本文

[http://www.blogfodder.co.uk/post/A-Complete-Newbies-Guide-To-Umbraco-CMS.aspx](http://www.blogfodder.co.uk/post/A-Complete-Newbies-Guide-To-Umbraco-CMS.aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-12-28T15:07:55.097

我试过 Umbraco，它不适合胆小的人。我觉得我是一个相当技术性的人，Sr. Web Developer……几个小时后我放弃了。

MojoPortal 可以正常工作。

它有其缺陷，但它只是有效的简单事实意味着它赢了。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-07-28T18:57:56.947

我使用了 Kentico、DNN、Sitecore、Joomla、CMS Made Simple（是的，当然不是 mojoPortal）。如果您追求高度定制和高度指定的解决方案，Umbraco 是迄今为止最强大的。Linq2Umbraco 刚刚完成了交易。

但是，如果您在使用内置所有内容的傻瓜证明 CMS，并且您最关心的是寻找复选框以启用论坛/博客/任何其他笑话模块/花里胡哨/等。Umbraco 不适合你。IMO Kentico/DNN 就是这些。

编辑 - 3 年后，我也使用了 SharePoint、epiServer、SiteFinity。

Umbraco 仍然胜出。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-24T10:03:00.807

mojoPortal 对我来说似乎更容易使用，即使在禁用 javascript 的情况下也可以使用，例如使用 noscript 浏览器插件。使用渐进增强 javascript 技术似乎更加关注可访问性，而使用 Umbraco 禁用 javascript 时您根本无法管理您的网站。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-12-19T00:00:52.520

I haven't tried mojoPortal, but I love Umbraco.

Things I like:

*   Clean code
*   Uses XSLT, python, or .NET to extend
*   Awesome community support
*   Tutorial videos for easy learning
*   Admin area is extensible
*   Good plug-in projects

But really its because I can use it for both small and large projects easily.

# python - 替换为 Python-* 等价物？

> ID：901074
> 
> 赞同：0
> 
> 时间：2009-05-23T07:30:50.687
> 
> 标签：python, replace

如果我正在查找和替换一些文本，我怎样才能让它替换一些每天都会改变的文本，即 (( & )) 之间的任何内容，不管它是什么？

干杯!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T07:36:49.533

使用正则表达式（[http://docs.python.org/library/re.html](http://docs.python.org/library/re.html)）？

您能否更具体一点，我认为我不完全理解您要完成的工作。

编辑：

好的，现在我明白了。这可能更容易完成，但这里是：

```
>>> import re

>>> s = "foo(bar)whatever"
>>> r = re.compile(r"(\()(.+?)(\))")
>>> r.sub(r"\1baz\3",s)
'foo(baz)whatever' 
```

对于多个级别的括号，这将不起作用，或者更确切地说它会起作用，但会做一些你可能不希望它做的事情。

哦，嘿，作为奖励，这里有相同的正则表达式，只是现在它会替换最里面的括号中的字符串：

```
r1 = re.compile(r"(\()([^)^(]+?)(\))") 
```

# model-view-controller - 在 MVC 中的视图页面中，处理空变量的首选方法是什么

> ID：901078
> 
> 赞同：0
> 
> 时间：2009-05-23T07:34:07.277
> 
> 标签：model-view-controller, web-applications

在使用 MVC 设计模式时，我通常会尝试使我的视图文件尽可能简单。

因此，在我看来，**我**尽量不要有很多这样的代码：

```
if page title exists

    display page title

else 

    display 'default page title'

end if 
```

相反，在我的**控制器**中，我可能会使用如下代码：

```
if no page title is specified

    page title = 'default page title'

end if

load the view (pass page title as a parameter) 
```

这是解决这个问题的最好方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T08:02:22.710

将这种 if-else 条件保留在控制器级别比移动到视图中更好。（如果可以的话，没关系）

它会让你的观点看起来不错！！！！

# http - 发送 HTTP 标头后服务器无法设置内容类型

> ID：901083
> 
> 赞同：1
> 
> 时间：2009-05-23T07:39:43.397
> 
> 标签：http, content-type

我需要在单击按钮时呈现 pdf。

我正在使用以下js代码：

```
function RenderPDf() {
    //for
    window.open("/Resources/RenderPDF", "", 'toolbar=no,titlebar=no, directories=no, location=no,status=yes, menubar=no, resizable=yes, scrollbars=yes,width=1010, height=680,left=0,top=0');
    return false;
} 
```

但我有时会收到以下错误：

```
Message :Server cannot set content type after HTTP headers have been sent.
Source :System.Web
Stack Trace :   at System.Web.HttpResponse.set_ContentType(String value)
  at System.Web.UI.Page.SetIntrinsics(HttpContext context, Boolean allowAsync)
  at System.Web.UI.Page.ProcessRequestWithNoAssert(HttpContext context)
  at System.Web.UI.Page.ProcessRequest(HttpContext context)
  at ASP.views_file_viewtaxreturn_aspx.ProcessRequest(HttpContext context)
  at System.Web.Mvc.ViewPage.RenderView(ViewContext viewContext)
  at System.Web.Mvc.WebFormView.RenderViewPage(ViewContext context, ViewPage page)
  at System.Web.Mvc.WebFormView.Render(ViewContext viewContext, TextWriter writer)

  at System.Web.Mvc.ViewResultBase.ExecuteResult(ControllerContext context)
  at System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ControllerContext controllerContext, ActionResult actionResult)
  at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<InvokeActionResultWithFilters>b__e()
  at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
  at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<>c__DisplayClass13.<InvokeActionResultWithFilters>b__10()

  at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult)

  at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)
  at System.Web.Mvc.Controller.ExecuteCore()
  at System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext)
  at System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext)
  at System.Web.Mvc.MvcHandler.ProcessRequest(HttpContextBase httpContext)
  at System.Web.Mvc.MvcHandler.ProcessRequest(HttpContext httpContext)
  at System.Web.Mvc.MvcHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext httpContext)
  at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
  at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)

TargetSite :Void set_ContentType(System.String) 
```

请提出这个例外。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T18:36:24.870

[`EmptyResult`](https://docs.microsoft.com/en-us/dotnet/api/system.web.mvc.emptyresult?view=aspnet-mvc-5.2)通过在控制器中返回解决了这个错误

```
return new EmptyResult(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T08:11:35.503

任何东西，我的意思是在您打算设置的标头之前发送给客户端的任何东西都可能导致此错误*。*在某些情况下，您的应用会在您想要的标头之前向客户端发送某些内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T07:45:41.763

作为一个建议，当我遇到这个问题时，这是因为在我开始我的代码块之前我有空格/新行/html代码。在调用函数之前，请检查您没有向客户端发送任何内容。

# ruby - 如何在外部设置 Ruby 的加载路径

> ID：901085
> 
> 赞同：33
> 
> 时间：2009-05-23T07:40:17.157
> 
> 标签：ruby, rubygems

我有一个自定义的 Ruby 库目录，我希望在执行 Ruby 时自动添加到 Ruby 的加载路径中。我知道我可以使用`-I`Ruby 的选项，但是我可以设置一个环境变量之类的东西来全局确定 Ruby 的加载路径。

我想在没有 root 权限的 Linux 机器上安装 Ruby Gems，所以我需要在非标准位置有一个 Ruby 加载路径。我按照“[在用户目录中](http://rubygems.org/read/chapter/3#page83)安装 RubyGems”安装了 RubyGems ，但该`gem`命令没有选择非标准加载路径。

也许我在这里遗漏了一些明显的东西并使自己的事情变得更加困难？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-23T07:56:58.370

请参阅 The Pickaxe Book 中的“ [Ruby 及其世界](http://phrogz.net/ProgrammingRuby/rubyworld.html)”一章，特别是关于环境变量的部分。摘抄：

```
RUBYLIB 
  Additional search path for Ruby programs ($SAFE must be 0).
DLN_LIBRARY_PATH
  Search path for dynamically loaded modules.
RUBYLIB_PREFIX
  (Windows only) Mangle the RUBYLIB search path by adding this
  prefix to each component. 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-23T12:37:34.233

确保您已将安装的`bin`目录放在您的目录中`$PATH`，以便`gem` 命令正常工作。它应该修改`RUBYLIB`自己，但如果没有，请尝试[Martin 的回答](https://stackoverflow.com/questions/901085/setting-ruby-load-path-externally/901109#901109)来解决这个问题。

然后，您可以将 gem home（rubygems 安装的 gem 存储在其中）放在本地。

只需使用`$GEM_HOME`（或在您`~/.gemrc`的`gem environment`.

```
% mkdir ~/.gems
% 导出 GEM_HOME=~/.gems
% gem 帮助环境

用法：gem 环境 [arg] [options]

  常用选项：
    -h, --help 获取有关此命令的帮助
    -V, --[no-]verbose 设置输出的详细级别
    -q, --quiet 静音命令
        --config-file FILE 使用这个配置文件而不是默认的
        --backtrace 显示错误的堆栈回溯
        --debug 开启 Ruby 调试

  论据：
    packageversion 显示包版本
    gemdir 显示 gem 的安装路径
    gempath 用于搜索宝石的显示路径
    version 显示 gem 格式版本
    remotesources 显示远程 gem 服务器
           显示一切

  概括：
    显示有关 RubyGems 环境的信息

  描述：
    RubyGems 环境可以通过命令行参数控制，
    gemrc 文件、环境变量和内置默认值。

    命令行参数默认值和一些 RubyGems 默认值可以在
    ~/.gemrc 文件用于单个用户，/etc/gemrc 用于所有用户。一个gemrc
    是具有以下 YAML 键的 YAML 文件：

      :sources: 用于安装 gem 的远程 gem 存储库的 YAML 数组
      :verbose: gem 命令的详细程度。false、true 和 :really 是
                水平
      :update_sources：启用/禁用存储库元数据的自动更新
      :backtrace: RubyGems 遇到错误时打印回溯
      :bulk_threshold: 当这么多来源用完时切换到批量更新
                       日期（旧设置）
      :gempath: 寻找宝石的路径
      gem_command：包含指定 gem 命令的参数的字符串

    例子：

      ：详细：假
      安装：--no-wrappers
      更新：--无包装

    RubyGems 的默认本地存储库可以用 GEM_PATH 和
    GEM_HOME 环境变量。GEM_HOME 将默认存储库设置为
    安装到。GEM_PATH 允许搜索多个本地存储库
    为了
    宝石。

    如果你在代理服务器后面，RubyGems 使用 HTTP_PROXY，
    HTTP_PROXY_USER 和 HTTP_PROXY_PASS 环境变量来发现
    代理服务器。

    如果要打包 RubyGems，所有 RubyGems 的默认值都在
    lib/rubygems/defaults.rb。您可以在
    lib/rubygems/defaults/operating_system.rb

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-26T18:23:39.827

让生活变得轻松并安装[RVM](http://rvm.io/ "虚拟机")。它将安装您想要的任何版本的 Ruby，并让您在它们之间切换，并且不需要 root 访问权限。它具有许多其他杀手级功能，您在使用一段时间后就会上瘾。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-09T03:23:51.737

我使用[@MartinCarpenter 的解决方案通过](https://stackoverflow.com/a/901109/242933)[minitest](https://github.com/seattlerb/minitest)运行特定/特定/单一测试方法。我通常使用[Rake::TestTask](http://rake.rubyforge.org/classes/Rake/TestTask.html)`test`将目录添加到其中，例如，我可以使用命令行来执行此操作，如下所示：`$LOAD_PATH``t.libs << 'test'`

```
RUBYLIB=test ruby test/user_test.rb --name test_create 
```

我添加`test`到`$LOAD_PATH`是因为`user_test.rb`调用`require 'test_helper'`load `lib/test_helper.rb`。

# javascript - html选择滚动条

> ID：901089
> 
> 赞同：11
> 
> 时间：2009-05-23T07:43:35.137
> 
> 标签：javascript, html, scrollbar

如何在 html 选择框中添加滚动条？是否有任何 javascript 库可以模拟这种行为？

或者无论如何要重新设计，界面我有2个选择框，项目可以通过>>＆<< Filezilla，诺顿指挥官，总指挥官类型的界面转移到右侧选择框，项目可以左右移动.. .（问题是如何重新设计才能看到固定宽度选择框中的溢出字）

从[这个论坛帖子](http://www.webdeveloper.com/forum/showthread.php?t=7797)，指向另一个[示例](http://www.vladdy.net/tests/lbie.html)，示例代码将使用 div 覆盖以显示附加文本，但它需要用户将鼠标悬停在选项上。不是我正在寻找的解决方案，尽管我暂时会使用它。

```
<html>

<body>
<table>
<tr><td>
<select size="4" id="mySelect" style="width:65px;color:#f98ad3;">
    <option value="1" selected>option 1 The Long Option</option>
    <option value="2">option 2</option>
    <option value="3">option 3</option>
    <option value="4">option 4</option>
    <option value="5">option 5 Another Longer than the Long Option ;)</option>
    <option value="6">option 6</option>
</select>
</td>
<td>
<input type="button" value=">>"/><br>
<input type="button" value="<<"/>
</td>
<td>
<select size="4" id="mySelect" style="width:65px;color:#f98ad3;">
    <option value="1" selected>option 1 The Long Option</option>
    <option value="2">option 2</option>
    <option value="3">option 3</option>
    <option value="4">option 4</option>
    <option value="5">option 5 Another Longer than the Long Option ;)</option>
    <option value="6">option 6</option>
</select>
</td>
</tr>
</table>
</body>
</html> 
```

目标浏览器是 MSIE。从上面的代码中，用户看不到'option 1 The long Option'等......并且每个选项最多应该有200char。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-26T04:47:27.313

原生不支持 HTML Select 中的水平滚动条。但是，这里有一种创建水平滚动条外观的方法：

**1.首先创建一个css类**

```
<style type="text/css">
 .scrollable{
   overflow: auto;
   width: 70px; /* adjust this width depending to amount of text to display */
   height: 80px; /* adjust height depending on number of options to display */
   border: 1px silver solid;
 }
 .scrollable select{
   border: none;
 }
</style> 
```

**2\. 将 SELECT 包装在 DIV 中 -**另外，将大小显式设置为选项数。

```
<div class="scrollable">
<select size="6" multiple="multiple">
    <option value="1" selected>option 1 The Long Option</option>
    <option value="2">option 2</option>
    <option value="3">option 3</option>
    <option value="4">option 4</option>
    <option value="5">option 5 Another Longer than the Long Option ;)</option>
    <option value="6">option 6</option>
</select>
</div> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-23T08:33:30.293

一个选项是在选择列表上方（或下方）显示所选选项，如下所示：

**HTML**

```
<div id="selText"><span>&nbsp;</span></div><br/>
<select size="4" id="mySelect" style="width:65px;color:#f98ad3;">
    <option value="1" selected>option 1 The Long Option</option>
    <option value="2">option 2</option>
    <option value="3">option 3</option>
    <option value="4">option 4</option>
    <option value="5">option 5 Another Longer than the Long Option ;)</option>
    <option value="6">option 6</option>
</select> 
```

**JavaScript**

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"   
  type="text/javascript"></script> 
<script type="text/javascript">
$(document).ready(function(){        
    $("select#mySelect").change(function(){
      //$("#selText").html($($(this).children("option:selected")[0]).text());
       var txt = $($(this).children("option:selected")[0]).text();
       $("<span>" + txt + "<br/></span>").appendTo($("#selText span:last"));
    });
});
</script> 
```

PS：- 设置 div#selText 的高度，否则它将继续向下移动选择列表。

# javascript - 如何使用java脚本控制windows录音机

> ID：901095
> 
> 赞同：0
> 
> 时间：2009-05-23T07:48:30.557
> 
> 标签：javascript, audio-recording

我正在做一些需要我必须控制 Windows 录音机的事情，例如开始录制和停止录制以及保存录制的声音。如何控制它。还有一件事我不想看到录音机窗口。我会很感激谁给出答案。。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T10:08:48.527

扩展一下Machine所说的，为什么不试试Flash，我相信它有能力使用刻录机。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T07:54:59.403

如果您打算通过浏览器进行此操作，则不能。JavaScript 无权执行任何这些操作，因为这将是一个很大的安全漏洞。您可能可以通过嵌入式对象访问记录器，但我从未尝试过，所以我不确定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T10:02:46.387

试试这个： http: [//www.iol.ie/~locka/mozilla/plugin.htm](http://www.iol.ie/~locka/mozilla/plugin.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T09:21:15.643

我正在制作仅使用 javascript 的 Firefox 扩展。我可以打开录音机，但无法开始/停止录音，并且正在显示窗口。这是主要问题

# html - 在 Rails 应用程序中设置字符集

> ID：901097
> 
> 赞同：8
> 
> 时间：2009-05-23T07:50:57.930
> 
> 标签：html, ruby-on-rails, apache, character-encoding

我正在尝试在 RoR 应用程序的 html 视图中设置我的字符集。我已经通过 meta equiv 标签配置了字符集：
**meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" **

它没有用，所以我尝试更改我的 .htaccess（它是在 apache 下运行的 RoR 应用程序），但这是我的问题。通常我可以使用以下语句： **AddType 'text/html; 字符集=ISO-8859-1' html**

但问题是，众所周知，RoR 没有“文件扩展名”，这破坏了这个 .htaccess 解决方案。有人知道在布局模板或视图中设置字符集的另一种方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-23T10:21:51.933

让您的 Rails 应用程序设置`Content-type`标题，然后您就不必担心 Apache 正在做什么。

```
response.headers['Content-type'] = 'text/html; charset=utf-8' 
```

您可能还想添加

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

到页面本身，这样如果有人将其保存到磁盘，它将使用正确的字符集加载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T12:36:42.877

我添加了一个类似的函数，但仍然无法正常工作我的 application.rhtml 中有 ç ~ 代码无法正常工作。

```
before_filter :configure_charsets 

# Configuring charset to UTF-8 
def configure_charsets 
   headers["Content-Type"] = "text/html; charset=UTF-8"     
end 
```

我还添加了元 http-equiv html 标记和 .htaccess 参数 AddDefaultCharset UTF-8

这仍然不起作用，还有其他提示吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-16T16:47:56.787

只需在模板名称之后设置 :encoding => 'utf-8' ，如下所示：

```
respond_to do |f|
  f.pdf do
    render :pdf => 'path_to_template_file', :encoding => 'utf-8'
  end
end 
```

# .htaccess - 在 .htaccess 中使用 mod_rewrite 时，HTML 中的相对路径会中断

> ID：901099
> 
> 赞同：0
> 
> 时间：2009-05-23T07:51:27.773
> 
> 标签：.htaccess, mod-rewrite, relative-path, absolute-path

我是新手`.htaccess`和 mod_rewrite。

我正在使用以下重写规则：

```
RewriteRule ^wants/([0-9]+)$ /wantlist.php?wantid=$1
RewriteRule ^dashboard$ /dashboard.php 
```

我能够成功地重定向这两种情况。

但为了做到这一点，我不得不将 CSS、JS 和其他路径更改为绝对路径，否则 CSS 和 JS 不会加载。

我正在使用

```
<script type="javascript" src="js/javascript.js"></script> 
```

在重写规则不起作用并且在我将其更改为之后

```
<script type="javascript" src="http://example.com/js/javascript.js"></script> 
```

我让它工作。

网站上的任何其他 URL 也是如此。

有没有办法绕过这个，因为我在我正在开发的网站的几乎所有地方都使用相对路径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T08:36:28.027

这是一个 URL 解析问题。请参阅[mod_rewrite 所需的 URL 信息](https://stackoverflow.com/questions/891775/modrewrite-url-info-required/891785#891785)

[`BASE`您可以使用HTML 元素](http://www.w3.org/TR/html401/struct/links.html#edef-BASE)显式设置基本 URI ，例如：

```
<base href="/"> 
```

# c++ - 新的 C++ 标准是否提供了新的容器？

> ID：901114
> 
> 赞同：4
> 
> 时间：2009-05-23T08:07:00.207
> 
> 标签：c++, stl

随着 C++ STL 的更新，是否会有一定数量的容器。
**编辑：** 当涉及到容器时，除了向量、列表等之外，库中还会有新的补充吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-23T08:21:48.260

提议的 C++ 标准（又名 C++0x）添加了以下模板化容器：

*   `array` （更像是一个固定大小的向量）
*   `forward_list` （单链表）
*   `unordered_map`和`unordered_multimap` （哈希表作为字典）
*   `unordered_set`和`unordered_multiset` （设置的哈希表）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T08:40:03.947

您可以查看一篇关于 C++0x 的非常好的维基百科文章的[哈希表](http://en.wikipedia.org/wiki/C%2B%2B0x#Hash_tables)部分

# javascript - 如何在 JavaScript 中获取查询字符串值？

> ID：901115
> 
> 赞同：2695
> 
> 时间：2009-05-23T08:10:48.453
> 
> 标签：javascript, url, plugins, query-string

是否有通过 jQuery（或没有）检索[查询字符串](http://en.wikipedia.org/wiki/Query_string)值的无插件方式？

如果是这样，怎么做？如果没有，是否有插件可以做到这一点？

* * *

## 回答 #1

> 赞同：9587
> 
> 时间：2009-05-23T08:35:46.217

**更新：2022 年 1 月**

Using[`Proxy()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy)比using[性能](https://jsben.ch/MeP5G)[`Object.fromEntries()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/fromEntries)更高，并且得到更好的支持

```
const params = new Proxy(new URLSearchParams(window.location.search), {
  get: (searchParams, prop) => searchParams.get(prop),
});
// Get the value of "some_key" in eg "https://example.com/?some_key=some_value"
let value = params.some_key; // "some_value" 
```

**更新：2021 年 6 月**

对于需要所有查询参数的特定情况：

```
const urlSearchParams = new URLSearchParams(window.location.search);
const params = Object.fromEntries(urlSearchParams.entries()); 
```

**更新：2018 年 9 月**

您可以使用简单的[URLSearchParams](https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams#Browser_compatibility)并且具有[不错的（但不完整）浏览器支持](https://caniuse.com/urlsearchparams)。

```
const urlParams = new URLSearchParams(window.location.search);
const myParam = urlParams.get('myParam'); 
```

**原来的**

为此，您不需要 jQuery。您可以只使用一些纯 JavaScript：

```
function getParameterByName(name, url = window.location.href) {
    name = name.replace(/[\[\]]/g, '\\$&');
    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, ' '));
} 
```

**用法：**

```
// query string: ?foo=lorem&bar=&baz
var foo = getParameterByName('foo'); // "lorem"
var bar = getParameterByName('bar'); // "" (present with empty value)
var baz = getParameterByName('baz'); // "" (present with no value)
var qux = getParameterByName('qux'); // null (absent) 
```

注意：如果一个参数出现多次 ( `?foo=lorem&foo=ipsum`)，您将获得第一个值 ( `lorem`)。对此没有标准，用法各不相同，例如，请参阅这个问题：[Authoritative position of duplicate HTTP GET query keys](https://stackoverflow.com/questions/1746507/authoritative-position-of-duplicate-http-get-query-keys)。

注意：该函数区分大小写。如果您更喜欢不区分大小写的参数名称，[请将 'i' 修饰符添加到 RegExp](https://stackoverflow.com/questions/3939715/case-insensitive-regex-in-javascript)

注意：如果你得到一个 no-useless-escape eslint 错误，你可以`name = name.replace(/[\[\]]/g, '\\$&');`用`name = name.replace(/[[\]]/g, '\\$&')`.

* * *

这是基于新[URLSearchParams 规范](https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams)的更新，以更简洁地实现相同的结果。[请参阅下面标题为“ URLSearchParams](https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript/901144#12151322) ”的答案。

* * *

## 回答 #2

> 赞同：1764
> 
> 时间：2010-05-21T09:29:16.547

此处发布的一些解决方案效率低下。每次脚本需要访问参数时重复正则表达式搜索是完全没有必要的，一个函数将参数拆分为关联数组样式对象就足够了。如果您不使用 HTML 5 History API，则每次页面加载只需要一次。这里的其他建议也无法正确解码 URL。

```
var urlParams;
(window.[onpopstate](https://developer.mozilla.org/en-US/docs/DOM/window.onpopstate) = function () {
    var match,
        pl     = /\+/g,  // Regex for replacing addition symbol with a space
        search = /([^&=]+)=?([^&]*)/g,
        decode = function (s) { return [decodeURIComponent](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/decodeURIComponent)(s.replace(pl, " ")); },
        query  = window.[location](https://developer.mozilla.org/en-US/docs/DOM/window.location).search.[substring](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/substring)(1);

    urlParams = {};
    while (match = search.[exec](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/exec)(query))
       urlParams[decode(match[1])] = decode(match[2]);
})();
```

示例查询字符串：

> `?i=main&mode=front&sid=de8d49b78a85a322c4155015fdce22c4&enc=+Hello%20&empty`

结果：

```
 urlParams = {
    enc: " Hello ",
    i: "main",
    mode: "front",
    sid: "de8d49b78a85a322c4155015fdce22c4",
    empty: ""
}

alert(urlParams["mode"]);
// -> "front"

alert("empty" in urlParams);
// -> true 
```

这也可以很容易地改进以处理数组样式的查询字符串。[这里](http://jsbin.com/adali3/2)有一个例子，但由于[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986)中没有定义数组样式的参数，我不会用源代码污染这个答案。[对于那些对“污染”版本感兴趣的人，请查看下面的 campbeln 答案](https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript/23401756#23401756)。

此外，正如评论中所指出的，`;`是对的合法分隔符`key=value`。它需要一个更复杂的正则表达式来处理`;`or `&`，我认为这是不必要的，因为它很少`;`被使用，而且我会说更不可能同时使用两者。如果您需要支持`;`而不是`&`，只需在正则表达式中交换它们。

* * *

如果您使用的是服务器端预处理语言，您可能希望使用其原生 JSON 函数为您完成繁重的工作。例如，在 PHP 中，您可以编写：

```
<script>var urlParams = <?php echo [json_encode](http://php.net/manual/en/function.json-encode.php)($_GET, JSON_HEX_TAG);?>;</script>
```

简单多了！

＃更新

> 一项新功能是检索重复的参数，如下所示`myparam=1&myparam=2`。没有*规范*，但是，大多数当前方法都遵循数组的生成。

```
myparam = ["1", "2"] 
```

因此，这是管理它的方法：

```
let urlParams = {};
(window.onpopstate = function () {
    let match,
        pl = /\+/g,  // Regex for replacing addition symbol with a space
        search = /([^&=]+)=?([^&]*)/g,
        decode = function (s) {
            return decodeURIComponent(s.replace(pl, " "));
        },
        query = window.location.search.substring(1);

    while (match = search.exec(query)) {
        if (decode(match[1]) in urlParams) {
            if (!Array.isArray(urlParams[decode(match[1])])) {
                urlParams[decode(match[1])] = [urlParams[decode(match[1])]];
            }
            urlParams[decode(match[1])].push(decode(match[2]));
        } else {
            urlParams[decode(match[1])] = decode(match[2]);
        }
    }
})(); 
```

* * *

## 回答 #3

> 赞同：1312
> 
> 时间：2010-10-04T12:53:04.823

# ES2015 (ES6)

```
getQueryStringParams = query => {
    return query
        ? (/^[?#]/.test(query) ? query.slice(1) : query)
            .split('&')
            .reduce((params, param) => {
                    let [key, value] = param.split('=');
                    params[key] = value ? decodeURIComponent(value.replace(/\+/g, ' ')) : '';
                    return params;
                }, {}
            )
        : {}
}; 
```

* * *

## 没有 jQuery

```
var qs = (function(a) {
    if (a == "") return {};
    var b = {};
    for (var i = 0; i < a.length; ++i)
    {
        var p=a[i].split('=', 2);
        if (p.length == 1)
            b[p[0]] = "";
        else
            b[p[0]] = decodeURIComponent(p[1].replace(/\+/g, " "));
    }
    return b;
})(window.location.search.substr(1).split('&')); 
```

使用类似的 URL `?topic=123&name=query+string`，将返回以下内容：

```
qs["topic"];    // 123
qs["name"];     // query string
qs["nothere"];  // undefined (object) 
```

* * *

## 谷歌方法

撕裂谷歌的代码，我找到了他们使用的方法：`getUrlParameters`

```
function (b) {
    var c = typeof b === "undefined";
    if (a !== h && c) return a;
    for (var d = {}, b = b || k[B][vb], e = b[p]("?"), f = b[p]("#"), b = (f === -1 ? b[Ya](e + 1) : [b[Ya](e + 1, f - e - 1), "&", b[Ya](f + 1)][K](""))[z]("&"), e = i.dd ? ia : unescape, f = 0, g = b[w]; f < g; ++f) {
        var l = b[f][p]("=");
        if (l !== -1) {
            var q = b[f][I](0, l),
                l = b[f][I](l + 1),
                l = l[Ca](/\+/g, " ");
            try {
                d[q] = e(l)
            } catch (A) {}
        }
    }
    c && (a = d);
    return d
} 
```

它被混淆了，但它是可以理解的。它不起作用，因为某些变量未定义。

`?`他们开始在 url和 hash中寻找参数`#`。然后对于每个参数，它们以等号拆分`b[f][p]("=")`（看起来像`indexOf`，它们使用字符的位置来获取键/值）。将其拆分后，他们检查参数是否具有值，如果有，则存储 的值`d`，否则继续。

最后`d`返回对象，处理转义和`+`符号。这个对象就像我的一样，它具有相同的行为。

* * *

我作为**jQuery 插件的方法**

```
(function($) {
    $.QueryString = (function(paramsArray) {
        let params = {};

        for (let i = 0; i < paramsArray.length; ++i)
        {
            let param = paramsArray[i]
                .split('=', 2);

            if (param.length !== 2)
                continue;

            params[param[0]] = decodeURIComponent(param[1].replace(/\+/g, " "));
        }

        return params;
    })(window.location.search.substr(1).split('&'))
})(jQuery); 
```

用法

```
//Get a param
$.QueryString.param
//-or-
$.QueryString["param"]
//This outputs something like...
//"val"

//Get all params as object
$.QueryString
//This outputs something like...
//Object { param: "val", param2: "val" }

//Set a param (only in the $.QueryString object, doesn't affect the browser's querystring)
$.QueryString.param = "newvalue"
//This doesn't output anything, it just updates the $.QueryString object

//Convert object into string suitable for url a querystring (Requires jQuery)
$.param($.QueryString)
//This outputs something like...
//"param=newvalue&param2=val"

//Update the url/querystring in the browser's location bar with the $.QueryString object
history.replaceState({}, '', "?" + $.param($.QueryString));
//-or-
history.pushState({}, '', "?" + $.param($.QueryString)); 
```

* * *

## [性能测试（针对正则表达式方法的拆分方法）](http://jsperf.com/querystring-with-javascript)（[jsPerf](http://jsperf.com/)）

准备代码：方法声明

### 拆分测试代码

```
var qs = window.GetQueryString(query);

var search = qs["q"];
var value = qs["value"];
var undef = qs["undefinedstring"]; 
```

### 正则表达式测试代码

```
var search = window.getParameterByName("q");
var value = window.getParameterByName("value");
var undef = window.getParameterByName("undefinedstring"); 
```

**在 Windows Server 2008 R2 / 7 x64 上的 Firefox 4.0 x86 中进行测试**

*   **拆分方法**：最快 144,780 ±2.17%
*   **正则表达式方法**：13,891 ±0.85% | 慢 90%

* * *

## 回答 #4

> 赞同：676
> 
> 时间：2011-03-01T17:49:02.010

[Artem Barger 答案的](https://stackoverflow.com/questions/901115/get-querystring-values-with-jquery/901144#901144)改进版本：

```
function getParameterByName(name) {
    var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
    return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
} 
```

有关改进的更多信息，请参阅：http: [//james.padolsey.com/javascript/bujs-1-getparameterbyname/](http://james.padolsey.com/javascript/bujs-1-getparameterbyname/)

* * *

## 回答 #5

> 赞同：664
> 
> 时间：2012-08-28T00:27:41.967

# URL搜索参数

Firefox 44+、Opera 36+、Edge 17+、Safari 10.3+ 和 Chrome 49+ 支持 URLSearchParams [API](https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams)：

*   [Chrome 公告和详细信息](https://developers.google.com/web/updates/2016/01/urlsearchparams)
*   [Opera 公告及详情](https://dev.opera.com/blog/opera-36/)
*   [Firefox 公告和详细信息](https://developer.mozilla.org/en-US/Firefox/Releases/44#Miscellaneous)

有一个谷歌推荐的用于 IE 稳定版本的**[URLSearchParams polyfill](https://github.com/WebReflection/url-search-params)**。

它不是[W3C](https://www.w3.org/TR/2014/WD-url-1-20141209/#interface-urlsearchparams)标准化的，但它是[WhatWG](https://url.spec.whatwg.org)的生活标准。

你可以使用它`location`：

```
const params = new URLSearchParams(location.search); 
```

或者

```
const params = (new URL(location)).searchParams; 
```

或者当然在任何 URL 上：

```
const url = new URL('https://example.com?foo=1&bar=2');
const params = new URLSearchParams(url.search); 
```

您还可以使用 URL 对象上的简写`.searchParams`属性来获取参数，如下所示：

```
const params = new URL('https://example.com?foo=1&bar=2').searchParams;
params.get('foo'); // "1"
params.get('bar'); // "2" 
```

`get(KEY)`您通过, `set(KEY, VALUE)`, `append(KEY, VALUE)`API读取/设置参数。您还可以遍历所有值`for (let p of params) {}`。

[参考实现](https://trac.webkit.org/browser/trunk/Source/WebCore/platform/URLParser.cpp)和[示例页面](https://googlechrome.github.io/samples/urlsearchparams/)可用于审计和测试。

* * *

## 回答 #6

> 赞同：400
> 
> 时间：2011-03-15T15:21:00.817

只是另一个建议。插件*[Purl](https://github.com/allmarkedup/jQuery-URL-Parser)*允许检索 URL 的所有部分，包括锚点、主机等。

它可以与 jQuery 一起使用，也可以不与 jQuery 一起使用。

用法很简单很酷：

```
var url = $.url('http://allmarkedup.com/folder/dir/index.html?item=value'); // jQuery version
var url = purl('http://allmarkedup.com/folder/dir/index.html?item=value'); // plain JS version
url.attr('protocol'); // returns 'http'
url.attr('path'); // returns '/folder/dir/index.html' 
```

但是，截至 2014 年 11 月 11 日，Purl 不再维护，作者建议改用[URI.js。](https://github.com/medialize/URI.js)jQuery 插件的不同之处在于它专注于元素 - 对于字符串的使用，只需`URI`直接使用，无论有无 jQuery。类似的代码看起来像这样，更完整的文档[在这里](http://medialize.github.io/URI.js/docs.html)：

```
var url = new URI('http://allmarkedup.com/folder/dir/index.html?item=value'); // plain JS version
url.protocol(); // returns 'http'
url.path(); // returns '/folder/dir/index.html' 
```

* * *

## 回答 #7

> 赞同：252
> 
> 时间：2014-01-16T03:20:35.013

# *tl;博士*

一种快速、**完整的解决方案**，可处理**多值键**和**编码字符**。

```
var qd = {};
if (location.search) location.search.substr(1).split("&").forEach(function(item) {var s = item.split("="), k = s[0], v = s[1] && decodeURIComponent(s[1]); (qd[k] = qd[k] || []).push(v)})

//using ES6   (23 characters cooler)
var qd = {};
if (location.search) location.search.substr(1).split`&`.forEach(item => {let [k,v] = item.split`=`; v = v && decodeURIComponent(v); (qd[k] = qd[k] || []).push(v)}) 
```

多线：

```
var qd = {};
if (location.search) location.search.substr(1).split("&").forEach(function(item) {
    var s = item.split("="),
        k = s[0],
        v = s[1] && decodeURIComponent(s[1]); //  null-coalescing / short-circuit
    //(k in qd) ? qd[k].push(v) : qd[k] = [v]
    (qd[k] = qd[k] || []).push(v) // null-coalescing / short-circuit
}) 
```

这些代码是什么...
*[“空合并”](https://stackoverflow.com/q/476436/985454)，[短路评估](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Logical_Operators#Short-Circuit_Evaluation)
ES6 解构[赋值](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)，[箭头函数](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Functions/Arrow_functions)，[模板字符串](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals#Tagged_template_literals)*

例子：

```
"?a=1&b=0&c=3&d&e&a=5&a=t%20e%20x%20t&e=http%3A%2F%2Fw3schools.com%2Fmy%20test.asp%3Fname%3Dståle%26car%3Dsaab"
> qd
a: ["1", "5", "t e x t"]
b: ["0"]
c: ["3"]
d: [undefined]
e: [undefined, "http://w3schools.com/my test.asp?name=ståle&car=saab"]

> qd.a[1]    // "5"
> qd["a"][1] // "5" 
```

* * *

# 阅读更多... 关于 Vanilla JavaScript 解决方案。

*要访问 URL 的不同部分，请使用`location.(search|hash)`*

## 最简单的（虚拟）解决方案

```
var queryDict = {};
location.search.substr(1).split("&").forEach(function(item) {queryDict[item.split("=")[0]] = item.split("=")[1]}) 
```

*   正确处理**空键**。
*   用找到的**最后一个**值覆盖**多键。**

 **```
"?a=1&b=0&c=3&d&e&a=5"
> queryDict
a: "5"
b: "0"
c: "3"
d: undefined
e: undefined 
```

## 多值键

简单的密钥检查`(item in dict) ? dict.item.push(val) : dict.item = [val]`

```
var qd = {};
location.search.substr(1).split("&").forEach(function(item) {(item.split("=")[0] in qd) ? qd[item.split("=")[0]].push(item.split("=")[1]) : qd[item.split("=")[0]] = [item.split("=")[1]]}) 
```

*   现在改为返回**数组。**
*   `qd.key[index]`通过或访问值`qd[key][index]`

```
> qd
a: ["1", "5"]
b: ["0"]
c: ["3"]
d: [undefined]
e: [undefined] 
```

## 编码字符？

用于`decodeURIComponent()`第二次*或两次*拆分。

```
var qd = {};
location.search.substr(1).split("&").forEach(function(item) {var k = item.split("=")[0], v = decodeURIComponent(item.split("=")[1]); (k in qd) ? qd[k].push(v) : qd[k] = [v]}) 
```

例子：

```
"?a=1&b=0&c=3&d&e&a=5&a=t%20e%20x%20t&e=http%3A%2F%2Fw3schools.com%2Fmy%20test.asp%3Fname%3Dståle%26car%3Dsaab"
> qd
a: ["1", "5", "t e x t"]
b: ["0"]
c: ["3"]
d: ["undefined"]  // decodeURIComponent(undefined) returns "undefined" !!!*
e: ["undefined", "http://w3schools.com/my test.asp?name=ståle&car=saab"] 
```

* * *

# 来自评论

***!!!** 请注意，这`decodeURIComponent(undefined)`将返回 string `"undefined"`。解决方案在于简单地使用[`&&`](https://stackoverflow.com/a/476445/985454)，确保`decodeURIComponent()`不会在未定义的值上调用 。*（请参阅顶部的“完整解决方案”。）*

```
v = v && decodeURIComponent(v); 
```

如果查询字符串为空 ( `location.search == ""`)，则结果有些误导`qd == {"": undefined}`。建议在启动解析函数之前检查查询字符串，如下所示：

```
if (location.search) location.search.substr(1).split("&").forEach(...) 
```

* * *

## 回答 #8

> 赞同：222
> 
> 时间：2010-03-19T19:52:08.840

snipplr.com 上的 Roshambo 有一个简单的脚本来实现这一点，在*[Get URL Parameters with jQuery |中进行了描述。改进](http://snipplr.com/view/26662/get-url-parameters-with-jquery--improved/)*。使用他的脚本，您还可以轻松提取所需的参数。

这是要点：

```
$.urlParam = function(name, url) {
    if (!url) {
     url = window.location.href;
    }
    var results = new RegExp('[\\?&]' + name + '=([^&#]*)').exec(url);
    if (!results) { 
        return undefined;
    }
    return results[1] || undefined;
} 
```

然后从查询字符串中获取您的参数。

因此，如果 URL/查询字符串是`xyz.com/index.html?lang=de`.

只要打电话`var langval = $.urlParam('lang');`，你就知道了。

UZBEKJON 对此也有一篇很棒的博文，*[Get URL parameters & values with jQuery](http://jquery-howto.blogspot.com/2009/09/get-url-parameters-values-with-jquery.html)*。

* * *

## 回答 #9

> 赞同：168
> 
> 时间：2009-05-23T08:14:40.957

如果您使用 jQuery，则可以使用库，例如[​​ jQuery BBQ: Back Button & Query Library](http://benalman.com/projects/jquery-bbq-plugin/)。

> ...jQuery BBQ 提供了一个完整的`.deparam()`方法，以及散列状态管理，以及片段/查询字符串解析和合并实用程序方法。

编辑：添加 Deparam 示例：

```
 var DeparamExample = function() {
            var params = $.deparam.querystring();

            //nameofparam is the name of a param from url
            //code below will get param if ajax refresh with hash
            if (typeof params.nameofparam == 'undefined') {
                params = jQuery.deparam.fragment(window.location.href);
            }

            if (typeof params.nameofparam != 'undefined') {
                var paramValue = params.nameofparam.toString();

            }
        };
```

如果你只想使用纯 JavaScript，你可以使用...

```
var getParamValue = (function() {
    var params;
    var resetParams = function() {
            var query = window.location.search;
            var regex = /[?&;](.+?)=([^&;]+)/g;
            var match;

            params = {};

            if (query) {
                while (match = regex.exec(query)) {
                    params[match[1]] = decodeURIComponent(match[2]);
                }
            }    
        };

    window.addEventListener
    && window.addEventListener('popstate', resetParams);

    resetParams();

    return function(param) {
        return params.hasOwnProperty(param) ? params[param] : null;
    }

})();​ 
```

由于新的 HTML History API，特别是`history.pushState()`和`history.replaceState()`，URL 可以更改，这将使参数及其值的缓存无效。

每次历史记录更改时，此版本都会更新其内部参数缓存。

* * *

## 回答 #10

> 赞同：102
> 
> 时间：2012-09-03T21:08:41.647

只需使用两个**拆分**：

```
function get(n) {
    var half = location.search.split(n + '=')[1];
    return half !== undefined ? decodeURIComponent(half.split('&')[0]) : null;
} 
```

我正在阅读所有以前的和更完整的答案。但我认为这是最简单快捷的方法。你可以检查这个 jsPerf[基准](http://jsperf.com/querystring-with-javascript/9)

为了解决 Rup 评论中的问题，通过将第一行更改为下面的两行来添加条件拆分。但是绝对准确性意味着它现在比正则表达式慢（参见[jsPerf](http://jsperf.com/querystring-with-javascript/10)）。

```
function get(n) {
    var half = location.search.split('&' + n + '=')[1];
    if (!half) half = location.search.split('?' + n + '=')[1];
    return half !== undefined ? decodeURIComponent(half.split('&')[0]) : null;
} 
```

所以如果你知道你不会遇到鲁普的反案，这就是胜利。否则，正则表达式。

> *或者*，如果您可以控制查询字符串并且可以保证您尝试获取的值永远不会包含任何 URL 编码字符（在值中包含这些字符将是一个坏主意） - 您可以使用以下稍微简化和易读的版本第一个选项：
> 
> ```
>  function getQueryStringValueByName(name) {
>         var queryStringFromStartOfValue = location.search.split(name + '=')[1];
>          return queryStringFromStartOfValue !== undefined ? queryStringFromStartOfValue.split('&')[0] : null; 
> ```

* * *

## 回答 #11

> 赞同：97
> 
> 时间：2010-10-05T20:49:37.310

这是我将 Andy E 的优秀解决方案变成一个成熟的 jQuery 插件的尝试：

```
;(function ($) {
    $.extend({      
        getQueryString: function (name) {           
            function parseParams() {
                var params = {},
                    e,
                    a = /\+/g,  // Regex for replacing addition symbol with a space
                    r = /([^&=]+)=?([^&]*)/g,
                    d = function (s) { return decodeURIComponent(s.replace(a, " ")); },
                    q = window.location.search.substring(1);

                while (e = r.exec(q))
                    params[d(e[1])] = d(e[2]);

                return params;
            }

            if (!this.queryStringParams)
                this.queryStringParams = parseParams(); 

            return this.queryStringParams[name];
        }
    });
})(jQuery); 
```

语法是：

```
var someVar = $.getQueryString('myParam'); 
```

两全其美！

* * *

## 回答 #12

> 赞同：77
> 
> 时间：2012-02-20T14:18:01.967

如果您正在做更多的 URL 操作而不是简单地解析查询字符串，您可能会发现[URI.js](http://medialize.github.com/URI.js/)很有帮助。它是一个用于处理 URL 的库 - 并带有所有的花里胡哨。（对不起，这里是自我广告）

将您的查询字符串转换为地图：

```
var data = URI('?foo=bar&bar=baz&foo=world').query(true);
data == {
  "foo": ["bar", "world"],
  "bar": "baz"
} 
```

（URI.js 还“修复”了错误的查询字符串`?&foo&&bar=baz&`，例如`?foo&bar=baz`）

* * *

## 回答 #13

> 赞同：65
> 
> 时间：2012-01-10T23:36:08.110

我喜欢[Ryan Phelan 的解决方案](https://stackoverflow.com/a/3867610/632117)。但我看不出为此扩展 jQuery 有什么意义？没有使用 jQuery 功能。

另一方面，我喜欢 Google Chrome 中的内置函数：window.location.getParameter。

那么为什么不使用这个呢？好的，其他浏览器没有。因此，如果它不存在，让我们创建这个函数：

```
if (!window.location.getParameter ) {
  window.location.getParameter = function(key) {
    function parseParams() {
        var params = {},
            e,
            a = /\+/g,  // Regex for replacing addition symbol with a space
            r = /([^&=]+)=?([^&]*)/g,
            d = function (s) { return decodeURIComponent(s.replace(a, " ")); },
            q = window.location.search.substring(1);

        while (e = r.exec(q))
            params[d(e[1])] = d(e[2]);

        return params;
    }

    if (!this.queryStringParams)
        this.queryStringParams = parseParams(); 

    return this.queryStringParams[key];
  };
} 
```

这个函数或多或少来自 Ryan Phelan，但它的包装方式不同：名称清晰且不依赖其他 javascript 库。[有关此功能的更多信息，请访问我的博客](http://sharepointkunskap.wordpress.com/2012/01/11/get-url-parameters-with-javascript/)。

* * *

## 回答 #14

> 赞同：58
> 
> 时间：2012-02-20T14:00:00.887

用纯 JavaScript 代码保持简单：

```
function qs(key) {
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)
    {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars[key];
} 
```

从 JavaScript 代码中的任何位置调用它：

```
var result = qs('someKey'); 
```

* * *

## 回答 #15

> 赞同：57
> 
> 时间：2012-08-30T13:00:15.113

这是获取类似于 PHP [$_GET](http://php.net/manual/en/reserved.variables.get.php)数组的对象的快速方法：

```
function get_query(){
    var url = location.search;
    var qs = url.substring(url.indexOf('?') + 1).split('&');
    for(var i = 0, result = {}; i < qs.length; i++){
        qs[i] = qs[i].split('=');
        result[qs[i][0]] = decodeURIComponent(qs[i][1]);
    }
    return result;
} 
```

用法：

```
var $_GET = get_query(); 
```

对于查询字符串`x=5&y&z=hello&x=6`，这将返回对象：

```
{
  x: "6",
  y: undefined,
  z: "hello"
} 
```

* * *

## 回答 #16

> 赞同：46
> 
> 时间：2012-09-13T00:34:28.080

这些都是很好的答案，但我需要一些更强大的东西，并且认为你们都可能喜欢我创造的东西。

它是一个简单的库方法，可以对 URL 参数进行剖析和操作。静态方法具有以下可在主题 URL 上调用的子方法：

*   获取主机
*   获取路径
*   获取哈希
*   集合哈希
*   获取参数
*   获取查询
*   设置参数
*   获取参数
*   有参数
*   移除参数

例子：

```
URLParser(url).getParam('myparam1') 
```

* * *

```
var url = "http://www.test.com/folder/mypage.html?myparam1=1&myparam2=2#something";

function URLParser(u){
    var path="",query="",hash="",params;
    if(u.indexOf("#") > 0){
        hash = u.substr(u.indexOf("#") + 1);
        u = u.substr(0 , u.indexOf("#"));
    }
    if(u.indexOf("?") > 0){
        path = u.substr(0 , u.indexOf("?"));
        query = u.substr(u.indexOf("?") + 1);
        params= query.split('&');
    }else
        path = u;
    return {
        getHost: function(){
            var hostexp = /\/\/([\w.-]*)/;
            var match = hostexp.exec(path);
            if (match != null && match.length > 1)
                return match[1];
            return "";
        },
        getPath: function(){
            var pathexp = /\/\/[\w.-]*(?:\/([^?]*))/;
            var match = pathexp.exec(path);
            if (match != null && match.length > 1)
                return match[1];
            return "";
        },
        getHash: function(){
            return hash;
        },
        getParams: function(){
            return params
        },
        getQuery: function(){
            return query;
        },
        setHash: function(value){
            if(query.length > 0)
                query = "?" + query;
            if(value.length > 0)
                query = query + "#" + value;
            return path + query;
        },
        setParam: function(name, value){
            if(!params){
                params= new Array();
            }
            params.push(name + '=' + value);
            for (var i = 0; i < params.length; i++) {
                if(query.length > 0)
                    query += "&";
                query += params[i];
            }
            if(query.length > 0)
                query = "?" + query;
            if(hash.length > 0)
                query = query + "#" + hash;
            return path + query;
        },
        getParam: function(name){
            if(params){
                for (var i = 0; i < params.length; i++) {
                    var pair = params[i].split('=');
                    if (decodeURIComponent(pair[0]) == name)
                        return decodeURIComponent(pair[1]);
                }
            }
            console.log('Query variable %s not found', name);
        },
        hasParam: function(name){
            if(params){
                for (var i = 0; i < params.length; i++) {
                    var pair = params[i].split('=');
                    if (decodeURIComponent(pair[0]) == name)
                        return true;
                }
            }
            console.log('Query variable %s not found', name);
        },
        removeParam: function(name){
            query = "";
            if(params){
                var newparams = new Array();
                for (var i = 0;i < params.length;i++) {
                    var pair = params[i].split('=');
                    if (decodeURIComponent(pair[0]) != name)
                          newparams .push(params[i]);
                }
                params = newparams;
                for (var i = 0; i < params.length; i++) {
                    if(query.length > 0)
                        query += "&";
                    query += params[i];
                }
            }
            if(query.length > 0)
                query = "?" + query;
            if(hash.length > 0)
                query = query + "#" + hash;
            return path + query;
        },
    }
}

document.write("Host: " + URLParser(url).getHost() + '<br>');
document.write("Path: " + URLParser(url).getPath() + '<br>');
document.write("Query: " + URLParser(url).getQuery() + '<br>');
document.write("Hash: " + URLParser(url).getHash() + '<br>');
document.write("Params Array: " + URLParser(url).getParams() + '<br>');
document.write("Param: " + URLParser(url).getParam('myparam1') + '<br>');
document.write("Has Param: " + URLParser(url).hasParam('myparam1') + '<br>');

document.write(url + '<br>');

// Remove the first parameter
url = URLParser(url).removeParam('myparam1');
document.write(url + ' - Remove the first parameter<br>');

// Add a third parameter
url = URLParser(url).setParam('myparam3',3);
document.write(url + ' - Add a third parameter<br>');

// Remove the second parameter
url = URLParser(url).removeParam('myparam2');
document.write(url + ' - Remove the second parameter<br>');

// Add a hash
url = URLParser(url).setHash('newhash');
document.write(url + ' - Set Hash<br>');

// Remove the last parameter
url = URLParser(url).removeParam('myparam3');
document.write(url + ' - Remove the last parameter<br>');

// Remove a parameter that doesn't exist
url = URLParser(url).removeParam('myparam3');
document.write(url + ' - Remove a parameter that doesn\"t exist<br>'); 
```

* * *

## 回答 #17

> 赞同：46
> 
> 时间：2013-02-11T10:31:21.567

来自[MDN](https://developer.mozilla.org/en-US/docs/Web/API/URLUtils/search#Get_the_value_of_a_single_search_param)：

```
function loadPageVar (sVar) {
  return unescape(window.location.search.replace(new RegExp("^(?:.*[&\\?]" + escape(sVar).replace(/[\.\+\*]/g, "\\$&") + "(?:\\=([^&]*))?)?.*$", "i"), "$1"));
}

alert(loadPageVar("name")); 
```

* * *

## 回答 #18

> 赞同：41
> 
> 时间：2010-11-16T12:49:46.823

代码高尔夫：

```
var a = location.search&&location.search.substr(1).replace(/\+/gi," ").split("&");
for (var i in a) {
    var s = a[i].split("=");
    a[i]  = a[unescape(s[0])] = unescape(s[1]);
} 
```

显示它！

```
for (i in a) {
    document.write(i + ":" + a[i] + "<br/>");   
}; 
```

在我的 Mac 上：`test.htm?i=can&has=cheezburger`显示

```
0:can
1:cheezburger
i:can
has:cheezburger 
```

* * *

## 回答 #19

> 赞同：41
> 
> 时间：2011-03-14T10:13:40.390

我经常使用正则表达式，但不是为了那个。

在我的应用程序中读取一次查询字符串，并从所有键/值对构建一个对象，对我来说似乎更容易、更有效，例如：

```
var search = function() {
  var s = window.location.search.substr(1),
    p = s.split(/\&/), l = p.length, kv, r = {};
  if (l === 0) {return false;}
  while (l--) {
    kv = p[l].split(/\=/);
    r[kv[0]] = decodeURIComponent(kv[1] || '') || true;
  }
  return r;
}(); 
```

对于像您这样的 URL，`http://domain.com?param1=val1&param2=val2`您可以稍后在代码中获取它们的值，如`search.param1`和`search.param2`.

* * *

## 回答 #20

> 赞同：39
> 
> 时间：2010-07-10T20:48:12.670

```
function GET() {
        var data = [];
        for(x = 0; x < arguments.length; ++x)
            data.push(location.href.match(new RegExp("/\?".concat(arguments[x],"=","([^\n&]*)")))[1])
                return data;
    }

example:
data = GET("id","name","foo");
query string : ?id=3&name=jet&foo=b
returns:
    data[0] // 3
    data[1] // jet
    data[2] // b
or
    alert(GET("id")[0]) // return 3 
```

* * *

## 回答 #21

> 赞同：39
> 
> 时间：2010-12-14T12:20:00.277

Roshambo jQuery 方法没有处理解码 URL

> [http://snipplr.com/view/26662/get-url-parameters-with-jquery--improved/](http://snipplr.com/view/26662/get-url-parameters-with-jquery--improved/)

刚刚添加了该功能，同时添加了 return 语句

```
return decodeURIComponent(results[1].replace(/\+/g, " ")) || 0; 
```

现在您可以找到更新的要点：

```
$.urlParam = function(name){
var results = new RegExp('[\\?&]' + name + '=([^&#]*)').exec(window.location.href);
if (!results) { return 0; }
return decodeURIComponent(results[1].replace(/\+/g, " ")) || 0;
} 
```

* * *

## 回答 #22

> 赞同：37
> 
> 时间：2011-08-18T10:45:21.330

这是我对[这个出色答案](https://stackoverflow.com/questions/901115/get-query-string-values-in-javascript/3855394#3855394)的编辑- 增加了使用没有值的键解析查询字符串的能力。

```
var url = 'http://sb.com/reg/step1?param';
var qs = (function(a) {
    if (a == "") return {};
    var b = {};
    for (var i = 0; i < a.length; ++i) {
        var p=a[i].split('=', 2);
        if (p[1]) p[1] = decodeURIComponent(p[1].replace(/\+/g, " "));
        b[p[0]] = p[1];
    }
    return b;
})((url.split('?'))[1].split('&')); 
```

**重要的！**最后一行中该函数的参数不同。这只是一个如何将任意 URL 传递给它的示例。您可以使用 Bruno's answer 中的最后一行来解析当前 URL。

那么究竟发生了什么变化呢？使用 url`http://sb.com/reg/step1?param=`结果将是相同的。但是使用 url，`http://sb.com/reg/step1?param`布鲁诺的解决方案返回一个没有键的对象，而我的解决方案返回一个有键`param`和`undefined`值的对象。

* * *

## 回答 #23

> 赞同：37
> 
> 时间：2012-07-26T20:29:05.807

我喜欢[这个](http://jquery-howto.blogspot.co.uk/2009/09/get-url-parameters-values-with-jquery.html)（取自 jquery-howto.blogspot.co.uk）：

```
// get an array with all querystring values
// example: var valor = getUrlVars()["valor"];
function getUrlVars() {
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for (var i = 0; i < hashes.length; i++) {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
} 
```

对我很有用。

* * *

## 回答 #24

> 赞同：34
> 
> 时间：2013-02-14T21:20:49.747

我需要查询字符串中的一个对象，我讨厌很多代码。它可能不是宇宙中最健壮的，但它只是几行代码。

```
var q = {};
location.href.split('?')[1].split('&').forEach(function(i){
    q[i.split('=')[0]]=i.split('=')[1];
}); 
```

像这样的 URL`this.htm?hello=world&foo=bar`将创建：

```
{hello:'world', foo:'bar'} 
```

* * *

## 回答 #25

> 赞同：34
> 
> 时间：2014-05-01T03:51:40.210

这是 Andy E 链接的“处理数组样式查询字符串”版本的扩展版本。修复了一个错误（`?key=1&key[]=2&key[]=3`;`1`丢失并替换为`[2,3]`），进行了一些小的性能改进（重新解码值、重新计算“[”位置等）并添加了一些改进（功能化、支持`?key=1&key=2`、支持`;`分隔符） . 我把变量留得很短，但添加了大量注释以使它们可读（哦，我`v`在本地函数中重用了，抱歉，如果这令人困惑；）。

它将处理以下查询字符串...

> ?test=Hello&person=neek&person[]=jeff&person[]=jim&person[extra]=john&test3&nocache=1398914891264

……把它变成一个看起来像……的物体

```
{
    "test": "Hello",
    "person": {
        "0": "neek",
        "1": "jeff",
        "2": "jim",
        "length": 3,
        "extra": "john"
    },
    "test3": "",
    "nocache": "1398914891264"
} 
```

正如您在上面看到的，此版本处理一些“格式错误”的数组，即 -`person=neek&person[]=jeff&person[]=jim`或者`person=neek&person=jeff&person=jim`密钥是可识别且有效的（至少在 dotNet 的[NameValueCollection.Add 中](http://msdn.microsoft.com/en-us/library/xsc9a449.aspx)）：

> 如果指定的键已存在于目标 NameValueCollection 实例中，则将指定的值添加到现有的以逗号分隔的值列表中，格式为“value1,value2,value3”。

由于没有规范[，陪审团](https://stackoverflow.com/questions/1746507/authoritative-position-of-duplicate-http-get-query-keys)似乎对重复键有些不满意。在这种情况下，多个键存储为（假）数组。但请注意，我**不会将**基于逗号的值处理成数组。

**编码：**

```
getQueryStringKey = function(key) {
    return getQueryStringAsObject()[key];
};

getQueryStringAsObject = function() {
    var b, cv, e, k, ma, sk, v, r = {},
        d = function (v) { return decodeURIComponent(v).replace(/\+/g, " "); }, //# d(ecode) the v(alue)
        q = window.location.search.substring(1), //# suggested: q = decodeURIComponent(window.location.search.substring(1)),
        s = /([^&;=]+)=?([^&;]*)/g //# original regex that does not allow for ; as a delimiter:   /([^&=]+)=?([^&]*)/g
    ;

    //# ma(make array) out of the v(alue)
    ma = function(v) {
        //# If the passed v(alue) hasn't been setup as an object
        if (typeof v != "object") {
            //# Grab the cv(current value) then setup the v(alue) as an object
            cv = v;
            v = {};
            v.length = 0;

            //# If there was a cv(current value), .push it into the new v(alue)'s array
            //#     NOTE: This may or may not be 100% logical to do... but it's better than loosing the original value
            if (cv) { Array.prototype.push.call(v, cv); }
        }
        return v;
    };

    //# While we still have key-value e(ntries) from the q(uerystring) via the s(earch regex)...
    while (e = s.exec(q)) { //# while((e = s.exec(q)) !== null) {
        //# Collect the open b(racket) location (if any) then set the d(ecoded) v(alue) from the above split key-value e(ntry) 
        b = e[1].indexOf("[");
        v = d(e[2]);

        //# As long as this is NOT a hash[]-style key-value e(ntry)
        if (b < 0) { //# b == "-1"
            //# d(ecode) the simple k(ey)
            k = d(e[1]);

            //# If the k(ey) already exists
            if (r[k]) {
                //# ma(make array) out of the k(ey) then .push the v(alue) into the k(ey)'s array in the r(eturn value)
                r[k] = ma(r[k]);
                Array.prototype.push.call(r[k], v);
            }
            //# Else this is a new k(ey), so just add the k(ey)/v(alue) into the r(eturn value)
            else {
                r[k] = v;
            }
        }
        //# Else we've got ourselves a hash[]-style key-value e(ntry) 
        else {
            //# Collect the d(ecoded) k(ey) and the d(ecoded) sk(sub-key) based on the b(racket) locations
            k = d(e[1].slice(0, b));
            sk = d(e[1].slice(b + 1, e[1].indexOf("]", b)));

            //# ma(make array) out of the k(ey) 
            r[k] = ma(r[k]);

            //# If we have a sk(sub-key), plug the v(alue) into it
            if (sk) { r[k][sk] = v; }
            //# Else .push the v(alue) into the k(ey)'s array
            else { Array.prototype.push.call(r[k], v); }
        }
    }

    //# Return the r(eturn value)
    return r;
}; 
```

* * *

## 回答 #26

> 赞同：32
> 
> 时间：2011-01-28T15:43:24.523

这是我不久前创建的一个功能，我对此非常满意。它不区分大小写 - 这很方便。此外，如果请求的 QS 不存在，它只会返回一个空字符串。

我使用它的压缩版本。我正在为新手类型发布未压缩的内容，以更好地解释发生了什么。

我确信这可以进行优化或以不同的方式完成以更快地工作，但它总是能很好地满足我的需要。

享受。

```
function getQSP(sName, sURL) {
    var theItmToRtn = "";
    var theSrchStrg = location.search;
    if (sURL) theSrchStrg = sURL;
    var sOrig = theSrchStrg;
    theSrchStrg = theSrchStrg.toUpperCase();
    sName = sName.toUpperCase();
    theSrchStrg = theSrchStrg.replace("?", "&") theSrchStrg = theSrchStrg + "&";
    var theSrchToken = "&" + sName + "=";
    if (theSrchStrg.indexOf(theSrchToken) != -1) {
        var theSrchTokenLth = theSrchToken.length;
        var theSrchTokenLocStart = theSrchStrg.indexOf(theSrchToken) + theSrchTokenLth;
        var theLocOfNextAndSign = theSrchStrg.indexOf("&", theSrchTokenLocStart);
        theItmToRtn = unescape(sOrig.substring(theSrchTokenLocStart, theLocOfNextAndSign));
    }
    return unescape(theItmToRtn);
} 
```

* * *

## 回答 #27

> 赞同：28
> 
> 时间：2013-05-14T12:47:10.743

如果您使用的是 Browserify，则可以使用*Node.js*`url`中的模块：

 *```
var url = require('url');

url.parse('http://example.com/?bob=123', true).query;

// returns { "bob": "123" } 
```

进一步阅读：[**URL Node.js v0.12.2 手册和文档**](http://nodejs.org/api/url.html)

**编辑：**您可以使用[URL](https://developer.mozilla.org/en-US/docs/Web/API/URL)接口，它在几乎所有新浏览器中都被广泛采用，如果代码要在旧浏览器上运行，您可以使用这样的[polyfill](https://github.com/lifaon74/url-polyfill)。这是一个关于如何使用 URL 接口获取查询参数（又名搜索参数）的代码示例

```
const url = new URL('http://example.com/?bob=123');
url.searchParams.get('bob'); 
```

你也可以使用 URLSearchParams，这里有[一个来自 MDN 的例子，](https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams#Example)使用 URLSearchParams来做到这一点：

```
var paramsString = "q=URLUtils.searchParams&topic=api";
var searchParams = new URLSearchParams(paramsString);

//Iterate the search parameters.
for (let p of searchParams) {
  console.log(p);
}

searchParams.has("topic") === true; // true
searchParams.get("topic") === "api"; // true
searchParams.getAll("topic"); // ["api"]
searchParams.get("foo") === null; // true
searchParams.append("topic", "webdev");
searchParams.toString(); // "q=URLUtils.searchParams&topic=api&topic=webdev"
searchParams.set("topic", "More webdev");
searchParams.toString(); // "q=URLUtils.searchParams&topic=More+webdev"
searchParams.delete("topic");
searchParams.toString(); // "q=URLUtils.searchParams" 
```

* * *

## 回答 #28

> 赞同：27
> 
> 时间：2013-04-13T14:37:07.127

该问题的最佳答案的问题是它不支持放在 # 之后的参数，但有时也需要获取此值。

我修改了答案，让它解析一个带有井号的完整查询字符串：

```
var getQueryStringData = function(name) {
    var result = null;
    var regexS = "[\\?&#]" + name + "=([^&#]*)";
    var regex = new RegExp(regexS);
    var results = regex.exec('?' + window.location.href.split('?')[1]);
    if (results != null) {
        result = decodeURIComponent(results[1].replace(/\+/g, " "));
    }
    return result;
}; 
```

* * *

## 回答 #29

> 赞同：27
> 
> 时间：2013-09-30T17:37:08.840

我们刚刚发布了[arg.js](https://github.com/stretchr/arg.js)，这是一个旨在一劳永逸地解决这个问题的项目。传统上这很困难，但现在你可以做到：

```
var name = Arg.get("name"); 
```

或得到全部：

```
var params = Arg.all(); 
```

如果您关心 and 之间的区别`?query=true`，`#hash=true`那么您可以使用`Arg.query()`and`Arg.hash()`方法。

* * *

## 回答 #30

> 赞同：25
> 
> 时间：2013-02-06T09:09:42.137

```
function GetQueryStringParams(sParam)
{
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');

    for (var i = 0; i < sURLVariables.length; i++)
    {
        var sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0] == sParam)
        {
            return sParameterName[1];
        }
    }
}​ 
```

假设 URL 是，这就是你如何使用这个函数

> `http://dummy.com/?stringtext=jquery&stringword=jquerybyexample`

```
var tech = GetQueryStringParams('stringtext');
var blog = GetQueryStringParams('stringword'); 
```

* * *

## 回答 #31

> 赞同：23
> 
> 时间：2012-05-24T08:18:40.867

这个工作正常。其他一些答案中的正则表达式会引入不必要的开销。

```
function getQuerystring(key) {
    var query = window.location.search.substring(1);
    var vars = query.split("&");
    for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split("=");
        if (pair[0] == key) {
            return pair[1];
        }
    }
} 
```

取自[这里](http://forums.asp.net/t/1771251.aspx/1)

* * *

## 回答 #32

> 赞同：21
> 
> 时间：2012-04-06T21:14:18.440

```
http://someurl.com?key=value&keynovalue&keyemptyvalue=&&keynovalue=nowhasvalue#somehash 
```

*   常规键/值对 ( `?param=value`)
*   没有值的键（`?param`：没有等号或值）
*   带空值的键（`?param=`：等号，但等号右侧没有值）
*   重复键 ( `?param=1&param=2`)
*   删除空键（`?&&`：没有键或值）

### 代码：

*   ```
    var queryString = window.location.search || '';
    var keyValPairs = [];
    var params      = {};
    queryString     = queryString.substr(1);

    if (queryString.length)
    {
       keyValPairs = queryString.split('&');
       for (pairNum in keyValPairs)
       {
          var key = keyValPairs[pairNum].split('=')[0];
          if (!key.length) continue;
          if (typeof params[key] === 'undefined')
             params[key] = [];
          params[key].push(keyValPairs[pairNum].split('=')[1]);
       }
    } 
    ```

### 如何调用：

*   ```
    params['key'];  // returns an array of values (1..n) 
    ```

### 输出：

*   ```
    key            ["value"]
    keyemptyvalue  [""]
    keynovalue     [undefined, "nowhasvalue"] 
    ```

* * *

## 回答 #33

> 赞同：20
> 
> 时间：2012-11-15T18:15:13.280

单行获取查询：

```
var value = location.search.match(new RegExp(key + "=(.*?)($|\&)", "i"))[1]; 
```

* * *

## 回答 #34

> 赞同：20
> 
> 时间：2013-01-25T20:35:40.543

我使用此处列出的技术开发了一个小型库，以创建一个易于使用的嵌入式解决方案，以解决任何人的麻烦；在这里能找到它：

[https://github.com/Nijikokun/query-js](https://github.com/Nijikokun/query-js)

**用法**

获取特定参数/键：

```
query.get('param'); 
```

使用构建器获取整个对象：

```
var storage = query.build();
console.log(storage.param); 
```

还有更多...查看 github 链接以获取更多示例。

**特征**

1.  缓存解码和参数
2.  支持哈希查询字符串`#hello?page=3`
3.  支持传递自定义查询
4.  支持数组/对象参数`user[]="jim"&user[]="bob"`
5.  支持空管理`&&`
6.  支持没有值的声明参数`name&hello="world"`
7.  支持重复参数`param=1&param=2`
8.  干净、紧凑、可读的源代码`4kb`
9.  AMD、要求、节点支持

* * *

## 回答 #35

> 赞同：18
> 
> 时间：2010-11-16T09:55:08.010

这是[我在 GitHub 上的查询字符串解析代码版本](https://github.com/voituk/Misc/blob/master/js/jquery.hash.js#L10)。

它以 jquery.* 为“前缀”，但解析函数本身不使用 jQuery。它非常快，但仍然可以进行一些简单的性能优化。

它还支持 URL 中的列表和哈希表编码，例如：

```
arr[]=10&arr[]=20&arr[]=100 
```

或者

```
hash[key1]=hello&hash[key2]=moto&a=How%20are%20you 
```

* * *

```
jQuery.toQueryParams = function(str, separator) {
    separator = separator || '&'
    var obj = {}
    if (str.length == 0)
        return obj
    var c = str.substr(0,1)
    var s = c=='?' || c=='#'  ? str.substr(1) : str; 

    var a = s.split(separator)
    for (var i=0; i<a.length; i++) {
        var p = a[i].indexOf('=')
        if (p < 0) {
            obj[a[i]] = ''
            continue
        }
        var k = decodeURIComponent(a[i].substr(0,p)),
            v = decodeURIComponent(a[i].substr(p+1))

        var bps = k.indexOf('[')
        if (bps < 0) {
            obj[k] = v
            continue;
        } 

        var bpe = k.substr(bps+1).indexOf(']')
        if (bpe < 0) {
            obj[k] = v
            continue;
        }

        var bpv = k.substr(bps+1, bps+bpe-1)
        var k = k.substr(0,bps)
        if (bpv.length <= 0) {
            if (typeof(obj[k]) != 'object') obj[k] = []
            obj[k].push(v)
        } else {
            if (typeof(obj[k]) != 'object') obj[k] = {}
            obj[k][bpv] = v
        }
    }
    return obj;

} 
```

* * *

## 回答 #36

> 赞同：18
> 
> 时间：2013-03-29T00:59:07.147

一个非常轻量级的jQuery方法：

```
var qs = window.location.search.replace('?','').split('&'),
    request = {};
$.each(qs, function(i,v) {
    var initial, pair = v.split('=');
    if(initial = request[pair[0]]){
        if(!$.isArray(initial)) {
            request[pair[0]] = [initial]
        }
        request[pair[0]].push(pair[1]);
    } else {
        request[pair[0]] = pair[1];
    }
    return;
});
console.log(request); 
```

并提醒，例如 ?q

```
alert(request.q) 
```

* * *

## 回答 #37

> 赞同：17
> 
> 时间：2011-05-03T23:59:19.087

我宁愿使用`split()`而不是 Regex 进行此操作：

```
function getUrlParams() {
    var result = {};
    var params = (window.location.search.split('?')[1] || '').split('&');
    for(var param in params) {
        if (params.hasOwnProperty(param)) {
            var paramParts = params[param].split('=');
            result[paramParts[0]] = decodeURIComponent(paramParts[1] || "");
        }
    }
    return result;
} 
```

* * *

## 回答 #38

> 赞同：13
> 
> 时间：2014-05-30T02:17:09.607

这是我正在使用的：

```
/**
 * Examples:
 * getUrlParams()['myparam']    // url defaults to the current page
 * getUrlParams(url)['myparam'] // url can be just a query string
 *
 * Results of calling `getUrlParams(url)['myparam']` with various urls:
 * example.com                               (undefined)
 * example.com?                              (undefined)
 * example.com?myparam                       (empty string)
 * example.com?myparam=                      (empty string)
 * example.com?myparam=0                     (the string '0')
 * example.com?myparam=0&myparam=override    (the string 'override')
 *
 * Origin: http://stackoverflow.com/a/23946023/2407309
 */
function getUrlParams (url) {
    var urlParams = {} // return value
    var queryString = getQueryString()
    if (queryString) {
        var keyValuePairs = queryString.split('&')
        for (var i = 0; i < keyValuePairs.length; i++) {
            var keyValuePair = keyValuePairs[i].split('=')
            var paramName = keyValuePair[0]
            var paramValue = keyValuePair[1] || ''
            urlParams[paramName] = decodeURIComponent(paramValue.replace(/\+/g, ' '))
        }
    }
    return urlParams // functions below
    function getQueryString () {
        var reducedUrl = url || window.location.search
        reducedUrl = reducedUrl.split('#')[0] // Discard fragment identifier.
        var queryString = reducedUrl.split('?')[1]
        if (!queryString) {
            if (reducedUrl.search('=') !== false) { // URL is a query string.
                queryString = reducedUrl
            }
        }
        return queryString
    } // getQueryString
} // getUrlParams 
```

在最后一种情况下返回 'override' 而不是 '0' 使其与 PHP 一致。在 IE7 中工作。

* * *

## 回答 #39

> 赞同：10
> 
> 时间：2014-01-25T12:54:09.527

**获取所有查询字符串参数，包括复选框值（数组）。**

考虑到 GET 参数的正确和正常使用，我看到它在大多数函数上缺少的东西是对数组的支持和删除哈希数据。

所以我写了这个函数：

```
function qs(a){
 if(!a)return {};
 a=a.split('#')[0].split('&');
 var b=a.length,c={},d,k,v;
 while(b--){
  d=a[b].split('=');
  k=d[0].replace('[]',''),v=decodeURIComponent(d[1]||'');
  c[k]?typeof c[k]==='string'?(c[k]=[v,c[k]]):(c[k].unshift(v)):c[k]=v;
 }
 return c
} 
```

使用速记运算符 & while-- 循环，性能应该很好。

**支持：**

1.  空值（*key= / key*）
2.  键值（*键=值*）
3.  数组（*键[]=值*）
4.  哈希（*哈希标签被拆分出来*）

**笔记：**

它不支持对象数组（key[key]=value）

如果空格是+​​，它仍然是+。

`.replace(/\+/g, " ")`如果需要，请添加。

**用法：**

```
qs('array[]=1&array[]=2&key=value&empty=&empty2#hash') 
```

**返回：**

```
{
    "empty": "",
    "key": "value",
    "array": [
        "1",
        "2"
    ]
} 
```

**演示：**

[http://jsfiddle.net/ZQMrt/1/](http://jsfiddle.net/ZQMrt/1/)

**信息**

如果您不了解某些内容或无法阅读该功能，请询问。我很高兴解释我在这里做了什么。

*如果您认为该函数不可读且不可维护，我很乐意为您重写该函数，但请考虑速记和位运算符总是比标准语法快（也许阅读 ECMA-262 书中的速记和位运算符或使用你最喜欢的搜索引擎）。以标准可读语法重写代码意味着性能损失。*

* * *

## 回答 #40

> 赞同：10
> 
> 时间：2014-04-14T07:18:53.967

对于那些想要一个简短的方法（有限制）的人：

```
location.search.split('myParameter=')[1] 
```

* * *

## 回答 #41

> 赞同：9
> 
> 时间：2012-02-08T18:53:18.353

```
function getUrlVar(key){
    var result = new RegExp(key + "=([^&]*)", "i").exec(window.location.search); 
    return result && unescape(result[1]) || ""; 
} 
```

[https://gist.github.com/1771618](https://gist.github.com/1771618)

* * *

## 回答 #42

> 赞同：8
> 
> 时间：2011-10-16T18:38:02.993

以下代码将创建一个具有两种方法的对象：

1.  `isKeyExist`: 检查特定参数是否存在
2.  `getValue`：获取特定参数的值。

```
var QSParam = new function() {
       var qsParm = {};
       var query = window.location.search.substring(1);
       var params = query.split('&');
       for (var i = 0; i < params.length; i++) {
           var pos = params[i].indexOf('=');
           if (pos > 0) {
               var key = params[i].substring(0, pos);
               var val = params[i].substring(pos + 1);
               qsParm[key] = val;
           }
       }
       this.isKeyExist = function(query){
           if(qsParm[query]){
               return true;
           }
           else{
              return false;
           }
       };
       this.getValue = function(query){
           if(qsParm[query])
           {
               return qsParm[query];
           }
           throw "URL does not contain query "+ query;
       }
}; 
```

* * *

## 回答 #43

> 赞同：8
> 
> 时间：2012-01-05T00:26:07.657

试试这个：

```
String.prototype.getValueByKey = function(k){
    var p = new RegExp('\\b'+k+'\\b','gi');
    return this.search(p) != -1 ? decodeURIComponent(this.substr(this.search(p)+k.length+1).substr(0,this.substr(this.search(p)+k.length+1).search(/(&|;|$)/))) : "";
}; 
```

然后像这样调用它：

```
if(location.search != "") location.search.getValueByKey("id"); 
```

您也可以将其用于**cookie**：

```
if(navigator.cookieEnabled) document.cookie.getValueByKey("username"); 
```

这仅适用于具有`key=value[&|;|$]`... 的字符串不适用于对象/数组。

如果您**不想**使用**String.prototype** ...将其移至函数并将字符串作为参数传递

* * *

## 回答 #44

> 赞同：7
> 
> 时间：2012-02-22T20:40:59.497

这是我自己的看法。第一个函数将 URL 字符串解码为名称/值对的对象：

```
url_args_decode = function (url) {
  var args_enc, el, i, nameval, ret;
  ret = {};
  // use the DOM to parse the URL via an 'a' element
  el = document.createElement("a");
  el.href = url;
  // strip off initial ? on search and split
  args_enc = el.search.substring(1).split('&');
  for (i = 0; i < args_enc.length; i++) {
    // convert + into space, split on =, and then decode 
    args_enc[i].replace(/\+/g, ' ');
    nameval = args_enc[i].split('=', 2);
    ret[decodeURIComponent(nameval[0])]=decodeURIComponent(nameval[1]);
  }
  return ret;
}; 
```

另外，如果您更改了一些参数，您可以使用第二个函数将参数数组放回 URL 字符串中：

```
url_args_replace = function (url, args) {
  var args_enc, el, name;
  // use the DOM to parse the URL via an 'a' element
  el = document.createElement("a");
  el.href = url;
  args_enc = [];
  // encode args to go into url
  for (name in args) {
    if (args.hasOwnProperty(name)) {
      name = encodeURIComponent(name);
      args[name] = encodeURIComponent(args[name]);
      args_enc.push(name + '=' + args[name]);
    }
  }
  if (args_enc.length > 0) {
    el.search = '?' + args_enc.join('&');
  } else {
    el.search = '';
  }
  return el.href;
}; 
```

* * *

## 回答 #45

> 赞同：7
> 
> 时间：2013-09-07T08:37:17.537

我使用这段代码（JavaScript）来获取通过 URL 传递的内容：

```
function getUrlVars() {
            var vars = {};
            var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
                vars[key] = value;
            });
            return vars;
        } 
```

然后要将值分配给变量，您只需指定要获取的参数，即如果 URL 是`example.com/?I=1&p=2&f=3`

您可以这样做来获取值：

```
var getI = getUrlVars()["I"];
var getP = getUrlVars()["p"];
var getF = getUrlVars()["f"]; 
```

那么值将是：

```
getI = 1, getP = 2 and getF = 3 
```

* * *

## 回答 #46

> 赞同：6
> 
> 时间：2012-07-02T09:09:53.363

以下函数返回您的 queryString 的对象版本。您可以简单地写入`obj.key1`和 `obj.key2`访问参数`key1`中的值`key2`。

```
function getQueryStringObject()
{
    var querystring = document.location.search.replace('?','').split( '&' );
    var objQueryString={};
    var key="",val="";
    if(typeof querystring == 'undefined')
    {
        return (typeof querystring);
    }
    for(i=0;i<querystring.length;i++)
    {
        key=querystring[i].split("=")[0];
        val=querystring[i].split("=")[1];
        objQueryString[key] = val;
    }
    return objQueryString;
} 
```

要使用此功能，您可以编写

```
var obj= getQueryStringObject();
alert(obj.key1); 
```

* * *

## 回答 #47

> 赞同：6
> 
> 时间：2012-10-26T08:29:56.070

此函数将查询字符串转换为类似 JSON 的对象，它还处理无值和多值参数：

```
"use strict";
function getQuerystringData(name) {
    var data = { };
    var parameters = window.location.search.substring(1).split("&");
    for (var i = 0, j = parameters.length; i < j; i++) {
        var parameter = parameters[i].split("=");
        var parameterName = decodeURIComponent(parameter[0]);
        var parameterValue = typeof parameter[1] === "undefined" ? parameter[1] : decodeURIComponent(parameter[1]);
        var dataType = typeof data[parameterName];
        if (dataType === "undefined") {
            data[parameterName] = parameterValue;
        } else if (dataType === "array") {
            data[parameterName].push(parameterValue);
        } else {
            data[parameterName] = [data[parameterName]];
            data[parameterName].push(parameterValue);
        }
    }
    return typeof name === "string" ? data[name] : data;
} 
```

`undefined`我们对on进行检查，`parameter[1]`因为`decodeURIComponent`如果变量是 ，则返回字符串“undefined” `undefined`，这是错误的。

用法：

```
"use strict";
var data = getQuerystringData();
var parameterValue = getQuerystringData("parameterName"); 
```

* * *

## 回答 #48

> 赞同：6
> 
> 时间：2013-04-19T07:18:16.473

我在这里为我的需要做了一个小的 URL 库：[https ://github.com/Mikhus/jsurl](https://github.com/Mikhus/jsurl)

这是在 JavaScript 中操作 URL 的一种更常见的方式。同时它真的很轻量级（压缩和压缩 < 1 KB）并且有一个非常简单和干净的 API。它不需要任何其他库来工作。

关于最初的问题，做起来很简单：

```
var u = new Url; // Current document URL
// or
var u = new Url('http://user:pass@example.com:8080/some/path?foo=bar&bar=baz#anchor');

// Looking for query string parameters
alert( u.query.bar);
alert( u.query.foo);

// Modifying query string parameters
u.query.foo = 'bla';
u.query.woo = ['hi', 'hey']

alert(u.query.foo);
alert(u.query.woo);
alert(u); 
```

* * *

## 回答 #49

> 赞同：5
> 
> 时间：2011-05-24T06:32:43.170

我接受了[这个答案](https://stackoverflow.com/questions/901115/get-querystring-values-in-javascript/3855394#3855394)并添加了对可选地将 URL 作为参数传递的支持；回退到 window.location.search。显然，这对于从不是当前页面的 URL 获取查询字符串参数很有用：

```
(function($, undef) {
  $.QueryString = function(url) {
    var pairs, qs = null, index, map = {};
    if(url == undef){
      qs = window.location.search.substr(1);
    }else{
      index = url.indexOf('?');
      if(index == -1) return {};
      qs = url.substring(index+1);
    }
    pairs = qs.split('&');
    if (pairs == "") return {};
    for (var i = 0; i < pairs.length; ++i)
    {
      var p = pairs[i].split('=');
      if(p.length != 2) continue;
      map[p[0]] = decodeURIComponent(p[1].replace(/\+/g, " "));
    }
    return map;
  };
})(jQuery); 
```

* * *

## 回答 #50

> 赞同：5
> 
> 时间：2013-11-20T15:17:59.307

如果你有[Underscore.js](https://en.wikipedia.org/wiki/Underscore.js)或[lodash](http://lodash.com/docs#zipObject)，一个快速而肮脏的方法是：

```
_.object(window.location.search.slice(1).split('&').map(function (val) { return val.split('='); })); 
```

* * *

## 回答 #51

> 赞同：4
> 
> 时间：2012-10-31T20:31:45.507

有一个不错的小`url`实用程序，带有一些很酷的糖：

```
http://www.example.com/path/index.html?silly=willy#chucky=cheese

url();            // http://www.example.com/path/index.html?silly=willy#chucky=cheese
url('domain');    // example.com
url('1');         // path
url('-1');        // index.html
url('?');         // silly=willy
url('?silly');    // willy
url('?poo');      // (an empty string)
url('#');         // chucky=cheese
url('#chucky');   // cheese
url('#poo');      // (an empty string) 
```

查看更多示例并在此处下载：[https ://github.com/websanova/js-url#url](https://github.com/websanova/js-url#url)

* * *

## 回答 #52

> 赞同：4
> 
> 时间：2013-01-25T05:29:54.433

***这是从 URL 获取 int ans String 参数值的最简单和小函数 JavaScript***

```
/* THIS FUNCTION IS TO FETCH INT PARAMETER VALUES */

function getParameterint(param) {
            var val = document.URL;
            var url = val.substr(val.indexOf(param))  
            var n=parseInt(url.replace(param+"=",""));
            alert(n); 
}
getParameteraint("page");
getParameteraint("pagee");

/*THIS FUNCTION IS TO FETCH STRING PARAMETER*/
function getParameterstr(param) {
            var val = document.URL;
            var url = val.substr(val.indexOf(param))  
            var n=url.replace(param+"=","");
            alert(n); 
}
getParameterstr("str"); 
```

**源码和演示：** [http ://bloggerplugnplay.blogspot.in/2012/08/how-to-get-url-parameter-in-javascript.html](http://bloggerplugnplay.blogspot.in/2012/08/how-to-get-url-parameter-in-javascript.html)

* * *

## 回答 #53

> 赞同：4
> 
> 时间：2013-03-17T04:24:25.213

我相信这是实现这一目标的准确而简洁的方法（修改自[http://css-tricks.com/snippets/javascript/get-url-variables/](http://css-tricks.com/snippets/javascript/get-url-variables/)）：

```
function getQueryVariable(variable) {

    var query = window.location.search.substring(1),            // Remove the ? from the query string.
        vars = query.split("&");                                // Split all values by ampersand.

    for (var i = 0; i < vars.length; i++) {                     // Loop through them...
        var pair = vars[i].split("=");                          // Split the name from the value.
        if (pair[0] == variable) {                              // Once the requested value is found...
            return ( pair[1] == undefined ) ? null : pair[1];   // Return null if there is no value (no equals sign), otherwise return the value.
        }
    }

    return undefined;                                           // Wasn't found.

} 
```

* * *

## 回答 #54

> 赞同：4
> 
> 时间：2013-04-01T23:40:02.097

如果你想要数组样式的参数[URL.js](https://github.com/kevincox/url.js)支持任意嵌套的数组样式参数以及字符串索引（映射）。它还处理 URL 解码。

```
url.get("val[0]=zero&val[1]=one&val[2]&val[3]=&val[4]=four&val[5][0]=n1&val[5][1]=n2&val[5][2]=n3&key=val", {array:true});
// Result
{
    val: [
        'zero',
        'one',
        true,
        '',
        'four',
        [ 'n1', 'n2', 'n3' ]
    ]
    key: 'val'
} 
```

* * *

## 回答 #55

> 赞同：4
> 
> 时间：2013-05-17T02:14:15.517

如果您不想使用 JavaScript 库，您可以使用 JavaScript 字符串函数来解析`window.location`. 将此代码保存在外部 .js 文件中，您可以在不同的项目中反复使用它。

```
// Example - window.location = "index.htm?name=bob";

var value = getParameterValue("name");

alert("name = " + value);

function getParameterValue(param)
{
    var url = window.location;
    var parts = url.split('?');
    var params = parts[1].split('&');
    var val = "";

    for ( var i=0; i<params.length; i++)
    {
        var paramNameVal = params[i].split('=');

        if ( paramNameVal[0] == param )
        {
            val = paramNameVal[1];
        }
    }
    return val;
} 
```

* * *

## 回答 #56

> 赞同：4
> 
> 时间：2013-07-28T10:42:07.813

Node.js 的源代码中有一个强大的实现
[https://github.com/joyent/node/blob/master/lib/querystring.js](https://github.com/joyent/node/blob/master/lib/querystring.js)

TJ 的 qs 也做嵌套参数解析
[https://github.com/visionmedia/node-querystring](https://github.com/visionmedia/node-querystring)

* * *

## 回答 #57

> 赞同：4
> 
> 时间：2013-08-12T20:15:51.307

```
var getUrlParameters = function (name, url) {
    if (!name) {
        return undefined;
    }

    name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
    url = url || location.search;

    var regex = new RegExp('[\\?&#]' + name + '=?([^&#]*)', 'gi'), result, resultList = [];

    while (result = regex.exec(url)) {
        resultList.push(decodeURIComponent(result[1].replace(/\+/g, ' ')));
    }

    return resultList.length ? resultList.length === 1 ? resultList[0] : resultList : undefined;
}; 
```

* * *

## 回答 #58

> 赞同：4
> 
> 时间：2013-09-07T09:32:51.557

检索 URI 查询值的解决方案有很多，我更喜欢这个，因为它很短而且效果很好：

```
function get(name){
   if(name=(new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)')).exec(location.search))
      return decodeURIComponent(name[1]);
} 
```

* * *

## 回答 #59

> 赞同：4
> 
> 时间：2013-09-13T17:29:21.920

这是获取参数值（查询字符串）的非常简单的方法

使用`gV(para_name)`函数检索其值

```
var a=window.location.search;
a=a.replace(a.charAt(0),""); //Removes '?'
a=a.split("&");

function gV(x){
 for(i=0;i<a.length;i++){
  var b=a[i].substr(0,a[i].indexOf("="));
  if(x==b){
   return a[i].substr(a[i].indexOf("=")+1,a[i].length)} 
```

* * *

## 回答 #60

> 赞同：4
> 
> 时间：2014-01-30T08:34:11.837

使用纯 JavaScript 和[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)的简单解决方案：

```
alert(getQueryString("p2"));

function getQueryString (Param) {
    return decodeURI("http://www.example.com/?p1=p11&p2=p2222".replace(new RegExp("^(?:.*[&?]" + encodeURI(Param).replace(/[.+*]/g, "$&") + "(?:=([^&]*))?)?.*$", "i"), "$1"));
} 
```

[提琴手](http://jsfiddle.net/QeLF3/)

* * *

## 回答 #61

> 赞同：3
> 
> 时间：2013-07-13T08:38:29.220

我推荐[Dar Lessons](http://www.darlesson.com/jquery/querystring/)作为一个很好的插件。我已经使用它很长时间了。您也可以使用以下代码。只需放在`var queryObj = {};`document.ready 之前，并将下面的代码放在 document.ready 的开头即可。在此代码之后，您可以将`queryObj["queryObjectName"]`其用于您拥有的任何查询对象

```
var querystring = location.search.replace('?', '').split('&');
for (var i = 0; i < querystring.length; i++) {
    var name = querystring[i].split('=')[0];
    var value = querystring[i].split('=')[1];
    queryObj[name] = value;
} 
```

* * *

## 回答 #62

> 赞同：3
> 
> 时间：2013-07-23T13:00:05.837

采用：

```
 $(document).ready(function () {
      var urlParams = {};
      (function () {
          var match,
          pl = /\+/g, // Regex for replacing addition symbol with a space
              search = /([^&=]+)=?([^&]*)/g,
              decode = function (s) {
                  return decodeURIComponent(s.replace(pl, " "));
              },
              query = window.location.search.substring(1);

          while (match = search.exec(query))
              urlParams[decode(match[1])] = decode(match[2]);
      })();
      if (urlParams["q1"] === 1) {
          return 1;
      } 
```

请检查并让我知道您的意见。另请参阅*[如何使用 jQuery 获取查询字符串值](http://jquerybyexample.blogspot.com/2012/05/how-to-get-querystring-value-using.html)*。

* * *

## 回答 #63

> 赞同：3
> 
> 时间：2014-06-06T10:32:43.477

最漂亮但基本的：

```
data = {};
$.each(
    location.search.substr(1).split('&').filter(Boolean).map(function(kvpairs){
        return kvpairs.split('=')
    }),
    function(i,values) {
        data[values.shift()] = values.join('=')
    }
); 
```

它不处理值列表，例如`?a[]=1&a[]2`

* * *

## 回答 #64

> 赞同：2
> 
> 时间：2013-07-10T09:27:37.463

看到这篇[文章](http://www.darlesson.com/jquery/querystring/)或使用这个：

```
<script type="text/javascript" language="javascript">
    $(document).ready(function()
    {
        var urlParams = {};
        (function ()
        {
            var match,
            pl= /\+/g,  // Regular expression for replacing addition symbol with a space
            search = /([^&=]+)=?([^&]*)/g,
            decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
            query  = window.location.search.substring(1);

            while (match = search.exec(query))
                urlParams[decode(match[1])] = decode(match[2]);
        })();

        if (urlParams["q1"] === 1)
        {
            return 1;
        }
    });
</script> 
```

* * *

## 回答 #65

> 赞同：2
> 
> 时间：2014-01-17T08:20:59.710

可靠地做到这一点比人们最初想象的要复杂得多。

1.  `location.search`，在其他答案中使用，很脆弱，应该避免 - 例如，如果有人搞砸并在字符串`#fragment`之前放置标识符，它会返回空。`?query`
2.  在我看来，浏览器中自动转义 URL 的方式有很多种，这`decodeURIComponent`几乎是强制性的。
3.  许多查询字符串是从用户输入生成的，这意味着对 URL 内容的假设非常糟糕。包括非常基本的东西，比如每个键都是唯一的，甚至是有价值的。

为了解决这个问题，这里有一个可配置的 API，它带有大量的[防御性编程](http://en.wikipedia.org/wiki/Defensive_programming "关于以较少假设进行编程的 Wiki 文章。")。请注意，如果您愿意对某些变量进行硬编码，或者如果输入永远不能包含`hasOwnProperty`等，则可以将其缩小一半。

**版本 1：**返回一个数据对象，其中包含每个参数的名称和值。它有效地对它们进行重复数据删除，并始终尊重从左到右找到的第一个。

```
function getQueryData(url, paramKey, pairKey, missingValue, decode) {

    var query, queryStart, fragStart, pairKeyStart, i, len, name, value, result;

    if (!url || typeof url !== 'string') {
        url = location.href; // more robust than location.search, which is flaky
    }
    if (!paramKey || typeof paramKey !== 'string') {
        paramKey = '&';
    }
    if (!pairKey || typeof pairKey !== 'string') {
        pairKey = '=';
    }
    // when you do not explicitly tell the API...
    if (arguments.length < 5) {
        // it will unescape parameter keys and values by default...
        decode = true;
    }

    queryStart = url.indexOf('?');
    if (queryStart >= 0) {
        // grab everything after the very first ? question mark...
        query = url.substring(queryStart + 1);
    } else {
        // assume the input is already parameter data...
        query = url;
    }
    // remove fragment identifiers...
    fragStart = query.indexOf('#');
    if (fragStart >= 0) {
        // remove everything after the first # hash mark...
        query = query.substring(0, fragStart);
    }
    // make sure at this point we have enough material to do something useful...
    if (query.indexOf(paramKey) >= 0 || query.indexOf(pairKey) >= 0) {
        // we no longer need the whole query, so get the parameters...
        query = query.split(paramKey);
        result = {};
        // loop through the parameters...
        for (i = 0, len = query.length; i < len; i = i + 1) {
            pairKeyStart = query[i].indexOf(pairKey);
            if (pairKeyStart >= 0) {
                name = query[i].substring(0, pairKeyStart);
            } else {
                name = query[i];
            }
            // only continue for non-empty names that we have not seen before...
            if (name && !Object.prototype.hasOwnProperty.call(result, name)) {
                if (decode) {
                    // unescape characters with special meaning like ? and #
                    name = decodeURIComponent(name);
                }
                if (pairKeyStart >= 0) {
                    value = query[i].substring(pairKeyStart + 1);
                    if (value) {
                        if (decode) {
                            value = decodeURIComponent(value);
                        }
                    } else {
                        value = missingValue;
                    }
                } else {
                    value = missingValue;
                }
                result[name] = value;
            }
        }
        return result;
    }
} 
```

**版本 2：**返回具有两个相同长度数组的数据映射对象，一个用于名称，一个用于值，每个参数都有一个索引。这个支持重复的名称，并且有意不去重复它们，因为这可能是您想要使用这种格式的原因。

```
function getQueryData(url, paramKey, pairKey, missingValue, decode) {

    var query, queryStart, fragStart, pairKeyStart, i, len, name, value, result;

    if (!url || typeof url !== 'string') {
          url = location.href; // more robust than location.search, which is flaky
    }
        if (!paramKey || typeof paramKey !== 'string') {
            paramKey = '&';
        }
        if (!pairKey || typeof pairKey !== 'string') {
            pairKey = '=';
        }
        // when you do not explicitly tell the API...
        if (arguments.length < 5) {
            // it will unescape parameter keys and values by default...
            decode = true;
        }

        queryStart = url.indexOf('?');
        if (queryStart >= 0) {
            // grab everything after the very first ? question mark...
            query = url.substring(queryStart + 1);
        } else {
            // assume the input is already parameter data...
            query = url;
        }
        // remove fragment identifiers...
        fragStart = query.indexOf('#');
        if (fragStart >= 0) {
            // remove everything after the first # hash mark...
            query = query.substring(0, fragStart);
        }
        // make sure at this point we have enough material to do something useful...
        if (query.indexOf(paramKey) >= 0 || query.indexOf(pairKey) >= 0) {
            // we no longer need the whole query, so get the parameters...
            query = query.split(paramKey);
            result = {
                names: [],
                values: []
            };
            // loop through the parameters...
            for (i = 0, len = query.length; i < len; i = i + 1) {
                pairKeyStart = query[i].indexOf(pairKey);
                if (pairKeyStart >= 0) {
                    name = query[i].substring(0, pairKeyStart);
                } else {
                    name = query[i];
                }
                // only continue for non-empty names...
                if (name) {
                    if (decode) {
                        // unescape characters with special meaning like ? and #
                        name = decodeURIComponent(name);
                    }
                    if (pairKeyStart >= 0) {
                        value = query[i].substring(pairKeyStart + 1);
                        if (value) {
                            if (decode) {
                                value = decodeURIComponent(value);
                            }
                        } else {
                            value = missingValue;
                        }
                    } else {
                        value = missingValue;
                    }
                    result.names.push(name);
                    result.values.push(value);
                }
           }
           return result;
       }
   } 
```

* * *

## 回答 #66

> 赞同：2
> 
> 时间：2014-01-21T02:53:28.317

这将从URL 字符串解析变量**和数组。**它既不使用*正则表达式*，也不使用任何外部库。

```
function url2json(url) {
   var obj={};
   function arr_vals(arr){
      if (arr.indexOf(',') > 1){
         var vals = arr.slice(1, -1).split(',');
         var arr = [];
         for (var i = 0; i < vals.length; i++)
            arr[i]=vals[i];
         return arr;
      }
      else
         return arr.slice(1, -1);
   }
   function eval_var(avar){
      if (!avar[1])
          obj[avar[0]] = '';
      else
      if (avar[1].indexOf('[') == 0)
         obj[avar[0]] = arr_vals(avar[1]);
      else
         obj[avar[0]] = avar[1];
   }
   if (url.indexOf('?') > -1){
      var params = url.split('?')[1];
      if(params.indexOf('&') > 2){
         var vars = params.split('&');
         for (var i in vars)
            eval_var(vars[i].split('='));
      }
      else
         eval_var(params.split('='));
   }
   return obj;
} 
```

例子：

```
var url = "http://www.x.com?luckyNums=[31,21,6]&name=John&favFoods=[pizza]&noVal"
console.log(url2json(url)); 
```

输出：

```
[object]
   noVal: ""
   favFoods: "pizza"
   name:     "John"
   luckyNums:
      0: "31"
      1: "21"
      2: "6" 
```

* * *

## 回答 #67

> 赞同：2
> 
> 时间：2014-02-12T18:19:29.850

这对我不起作用，我想`?b`在`b`参数存在时匹配，而不是`?return`作为`r`参数匹配，这是[我的解决方案](https://gist.github.com/Dorian/833b37d2c7b168b7e94c)。

```
window.query_param = function(name) {
  var param_value, params;

  params = location.search.replace(/^\?/, '');
  params = _.map(params.split('&'), function(s) {
    return s.split('=');
  });

  param_value = _.select(params, function(s) {
    return s.first === name;
  })[0];

  if (param_value) {
    return decodeURIComponent(param_value[1] || '');
  } else {
    return null;
  }
}; 
```

* * *

## 回答 #68

> 赞同：2
> 
> 时间：2014-02-14T21:14:06.730

就大小而言，获取查询对象的最短可能表达式似乎是：

```
var params = {};
location.search.substr(1).replace(/([^&=]*)=([^&]*)&?/g,
  function () { params[decodeURIComponent(arguments[1])] = decodeURIComponent(arguments[2]); }); 
```

您可以使用该`A`元素将 URI 从字符串解析为类似`location`的组件（例如，摆脱`#...`）：

```
var a = document.createElement('a');
a.href = url;
// Parse a.search.substr(1)... as above 
```

* * *

## 回答 #69

> 赞同：2
> 
> 时间：2014-04-16T18:16:32.490

这是`String`原型实现：

```
String.prototype.getParam = function( str ){
    str = str.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
    var regex = new RegExp( "[\\?&]*"+str+"=([^&#]*)" );    
    var results = regex.exec( this );
    if( results == null ){
        return "";
    } else {
        return results[1];
    }
} 
```

示例调用：

```
var status = str.getParam("status") 
```

`str`可以是查询字符串或 url

* * *

## 回答 #70

> 赞同：1
> 
> 时间：2014-01-22T07:58:16.637

这将起作用...您需要在需要通过传递其名称来获取参数的位置调用此函数...

```
function getParameterByName(name)
{
  name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
  var regexS = "[\\?&]"+name+"=([^&#]*)";
  var regex = new RegExp( regexS );
  var results = regex.exec( window.location.href );
  alert(results[1]);
  if (results == null)
    return "";
  else
    return results[1];
} 
```

* * *

## 回答 #71

> 赞同：1
> 
> 时间：2014-04-14T01:23:36.280

快速、简单、快速：

**功能：**

```
function getUrlVar() {
    var result = {};
    var location = window.location.href.split('#');
    var parts = location[0].replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
        result [key] = value;
    });
    return result;
} 
```

**用法：**

```
var varRequest = getUrlVar()["theUrlVarName"]; 
```

* * *

## 回答 #72

> 赞同：1
> 
> 时间：2014-06-30T12:05:10.257

此函数将根据需要使用递归返回已解析的 JavaScript 对象，该对象具有任意嵌套的值。

这是一个[jsfiddle](http://jsfiddle.net/WZHm5/3/)示例。

```
[
  '?a=a',
  '&b=a',
  '&b=b',
  '&c[]=a',
  '&c[]=b',
  '&d[a]=a',
  '&d[a]=x',
  '&e[a][]=a',
  '&e[a][]=b',
  '&f[a][b]=a',
  '&f[a][b]=x',
  '&g[a][b][]=a',
  '&g[a][b][]=b',
  '&h=%2B+%25',
  '&i[aa=b',
  '&i[]=b',
  '&j=',
  '&k',
  '&=l',
  '&abc=foo',
  '&def=%5Basf%5D',
  '&ghi=[j%3Dkl]',
  '&xy%3Dz=5',
  '&foo=b%3Dar',
  '&xy%5Bz=5'
].join(''); 
```

给定上述任何测试示例。

```
var qs = function(a) {
  var b, c, e;
  b = {};
  c = function(d) {
    return d && decodeURIComponent(d.replace(/\+/g, " "));
  };
  e = function(f, g, h) {
    var i, j, k, l;
    h = h ? h : null;
    i = /(.+?)\[(.+?)?\](.+)?/g.exec(g);
    if (i) {
      [j, k, l] = [i[1], i[2], i[3]]
      if (k === void 0) {
        if (f[j] === void 0) {
          f[j] = [];
        }
        f[j].push(h);
      } else {
        if (typeof f[j] !== "object") {
          f[j] = {};
        }
        if (l) {
          e(f[j], k + l, h);
        } else {
          e(f[j], k, h);
        }
      }
    } else {
      if (f.hasOwnProperty(g)) {
        if (Array.isArray(f[g])) {
          f[g].push(h);
        } else {
          f[g] = [].concat.apply([f[g]], [h]);
        }
      } else {
        f[g] = h;
      }
      return f[g];
    }
  };
  a.replace(/^(\?|#)/, "").replace(/([^#&=?]+)?=?([^&=]+)?/g, function(m, n, o) {
    n && e(b, c(n), c(o));
  });
  return b;
}; 
```

* * *

## 回答 #73

> 赞同：0
> 
> 时间：2014-06-27T21:22:38.590

```
// Parse query string
var params = {}, queryString = location.hash.substring(1),
    regex = /([^&=]+)=([^&]*)/g,
    m;
while (m = regex.exec(queryString)) {
    params[decodeURIComponent(m[1])] = decodeURIComponent(m[2]);
} 
```

# google-app-engine - 如何在 google-app-engine 中使用 inbulit django 模板标签

> ID：901121
> 
> 赞同：5
> 
> 时间：2009-05-23T08:18:28.187
> 
> 标签：google-app-engine, django-templates

我正在尝试在我的谷歌应用程序中使用 Django 构建模板标签（如标记和人性化），但它不起作用。我在 INSTALLED_APPS 中添加了标记和人性化。还是行不通。怎么用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-21T07:36:36.040

这是人性化的方法，其他应该类似。在调用模板的控制器末尾有一个函数，如下所示：

```
def main():
    run_wsgi_app(application) 
```

在 def main() 之后添加以下两行：

```
from google.appengine.ext.webapp import template
template.register_template_library(
             'django.contrib.humanize.templatetags.humanize') 
```

无需在模板中添加 {% load humanize %}。

感谢这篇文章[http://blog.yjl.im/2011/02/few-things-on-google-app-engine-i.html](http://blog.yjl.im/2011/02/few-things-on-google-app-engine-i.html)为我暗示了解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T05:33:42.833

可以这样做，但您需要提供更多信息才能解决您的特定情况。听起来可能有一个异常被抛出——是这样吗？如果有，控制台（或日志）会打印什么？

我正在使用 app-engine-patch 并且能够同时使用 django.contrib.humanize 和 django.contrib.markup，所以你可能会看看这是否适合你。

# subsonic - 生成数据库版本

> ID：901127
> 
> 赞同：0
> 
> 时间：2009-05-23T08:21:45.840
> 
> 标签：subsonic

我正在尝试使用 SubSonic 生成 dbVersion，但是当我执行以下命令时：

```
C:\Program Files (x86)\SubSonic\SubSonic 2.1 Final\SubCommander\sonic.exe
    version /out Generated\dbVersions\ 
```

我收到以下错误：

> 无法加载文件或程序集`'Microsoft.SqlServer.Management.Sdk.Sfc, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91'`或其依赖项之一。该系统找不到指定的文件。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T19:36:31.777

我猜你使用的是 SQL 2008？看看这里：http: [//msdn.microsoft.com/en-us/library/cc284267.aspx](http://msdn.microsoft.com/en-us/library/cc284267.aspx)

您需要下拉 CLR 对象以及 Native 类型（答案在底部）：

“下载这些解决了问题 [http://www.microsoft.com/downloads/details.aspx?FamilyId=C6C3E9EF-BA29-4A43-8D69-A2BED18FE73C&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=C6C3E9EF-BA29-4A43-8D69-A2BED18FE73C&displaylang=en) 来自 Microsoft SQL Server 2008 Feature Pack，2008 年 8 月：Microsoft SQL Server System CLR 类型 Microsoft SQL Server 2008 管理对象"

# ado.net - SQLCacheDependency 与 ADO.NET 实体模型

> ID：901130
> 
> 赞同：1
> 
> 时间：2009-05-23T08:25:09.733
> 
> 标签：ado.net

SQL 缓存依赖项是否适用于 ADO.NET 实体模型？请给我一些示例链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T15:19:36.340

这是[SqlCacheDependency的 msdn 链接](http://msdn.microsoft.com/en-us/library/system.web.caching.sqlcachedependency.aspx)

这是[LINQ 和 SqlCacheDependency](http://www.andrewdothay.net/blog/2009/01/28/LINQAndTheSqlCacheDependency.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-21T14:15:06.153

但是 linq 和 ADO.Net 并不是一回事

# licensing - GNU GENERAL PUBLIC LICENSE 软件作为商业产品的一部分

> ID：901131
> 
> 赞同：7
> 
> 时间：2009-05-23T08:27:48.870
> 
> 标签：licensing, gnu, commerce

我正在为中小型公司开发 CRM 系统，我想将 GPL 软件作为模块集成到我的系统中（根据我的需求进行一些修改）。将其作为商业产品许可是否合法？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-10T22:16:54.863

在商业产品中使用 GPL 是一件非常复杂的事情。在 GPLv2 时代，有一个灰色地带，在 GPLv3 中已经被彻底清除了。要提供详细信息，您应该让我们知道您正在使用哪个模块以及它属于哪个 GPL 版本。

这一切都归结为“你的代码是 GPL 模块的派生作品”。举一个愚蠢的例子。如果 GPL 模块是一个冒泡排序并且您的应用程序使用该模块的 API，那么它是一个派生作品，所以一切都属于 GPL。如果您围绕模块创建 web 服务，则 web 服务是 GPL，但使用 web 服务的任何东西都不是。在一个更加灰色的区域中，如果您有使用另一种排序算法的旧代码，并且您制作了一个“包装”层以将 API 从旧排序转换为新排序，那么只有包装层是 GPL，因为原始应用程序是不是派生作品（它在您使用 GPL 模块之前可用，并且没有考虑到 GPL 模块编写）。请注意，这一切都值得商榷，但是基于 GPLv2 的这种解释，存在诸如非 GPL 二进制 Linux 内核模块之类的东西。

就像 Neil 已经说过的：遵循 GPL 并不意味着您必须发布您的代码。只有当拥有您的软件许可证的人要求它时，您才应该提供它。除非他/她实际购买了该应用程序，否则一个随机的人不能只索要代码。当然，只有一个人必须购买它，然后他/她对代码做任何他/她想做的事情（例如发布它）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T08:35:32.210

这取决于您所说的“商业产品”是什么意思。如果您使用 GPL 代码，您的代码将被 GPL 覆盖，并且您不能为其提供删除 GNU 许可证限制的许可证。这并不意味着您不能销售该产品，而是意味着您必须根据要求向您的被许可人提供其源代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T08:32:38.470

像往常一样，IANAL，但是：

如果您使用的是根据 GPL 许可的软件模块，那么您的软件将属于“衍生作品”的定义，因此也已根据 GPL 许可。

不过，您需要自己查看“衍生作品”的确切定义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T08:32:25.960

如果您的产品不附带任何 GPL 许可软件，我认为您没问题。

*   然后用户必须下载程序
*   如果您对 GPL 程序进行任何更改以进行分发，您必须发布那些

# iphone - 将地址簿数据导入 iPhone 模拟器

> ID：901132
> 
> 赞同：22
> 
> 时间：2009-05-23T08:28:26.530
> 
> 标签：iphone, ios-simulator

有没有一种简单的方法可以将地址簿数据导入 iPhone 模拟器？

现在我唯一的假设是手动修改*/Library/Application Support/iPhone Simulator/User/Library/AddressBook*中的 SQLite 文件。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2011-03-02T20:50:23.607

我一直在寻找确切的解决方案，这对我来说非常适合在未越狱的手机上使用。它的工作原理是从未加密的备份中提取您的 iPhone 通讯录。

*   退出 iOS 模拟器
*   下载[iPhone/iPod Touch 备份提取器](http://supercrazyawesome.com/)
*   运行它，然后选择最后一个选项“iOS 文件”
*   在桌面上创建一个文件夹并将所有文件提取到该文件夹
*   完成后，转到您的提取文件夹并导航到 Library/AddressBook
*   将两个文件（AddressBook.sqlitedb 和 AddressBookImages.sqlitedb）复制到：~/Library/Application Support/iPhone Simulator/{SDK}/Library/AddressBook
*   在 iOS 模拟器中运行联系人应用程序

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-02-11T23:04:53.040

DummyContacts 是一个允许您将联系人添加到地址簿的应用程序，它可以成为所有 iOS 设备以及模拟器的便捷工具。DummyContacts 是一个救生员，而且很容易设置。一键添加100条记录，一键删除全部100条。它还支持iOS6。因此，请访问：[https](https://github.com/Janak-Nirmal/DummyContacts) ://github.com/Janak-Nirmal/DummyContacts 。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-08-20T13:39:11.310

这是我制作的一个简单的应用程序，您可以将其安装在模拟器中 [https://github.com/cristianbica/CBSimulatorSeed](https://github.com/cristianbica/CBSimulatorSeed)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-09-25T13:24:42.377

只需在模拟器上登录您的 iCloud 帐户，然后在 iCloud 下打开“联系人”。您的所有联系人、照片等都将出现在模拟器上。显然，这是假设您将联系人备份到 iPhone 上的 iCloud。希望能帮助到你！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-03-16T09:47:47.363

正如 Marc 在他的回答[https://stackoverflow.com/a/27582281/4598931](https://stackoverflow.com/a/27582281/4598931)中指出的类似问题，只需将联系人导出到 vCard 并将生成的文件拖放到 iphone 模拟器即可。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-08-16T16:31:02.667

或者，如果您的 iPhone 没有越狱，您可以在此处使用 shell 脚本从备份中提取 sqlite db：http: [//0xced.blogspot.com/2009/01/using-your-own-address-book-in- iphone.html](http://0xced.blogspot.com/2009/01/using-your-own-address-book-in-iphone.html)

（请注意，您需要更改将其复制到的模拟器路径，因为在当前 SDK 中，由于添加了 OS 版本文件夹，它会有所不同 - 最简单的方法是将其更改为您的主目录并手动复制从那里）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T10:26:49.473

对，这是我使用“合法”iPhone 知道的唯一方法

但是如果你有越狱的 iPhone，你可以用 ssh 下载 iPhone AddressBook 数据库，然后用 iphone 替换模拟器。

# sql-server - SQL Server - 简单的远程报告工具？

> ID：901134
> 
> 赞同：4
> 
> 时间：2009-05-23T08:30:55.603
> 
> 标签：sql-server

我想让客户端访问 SQL Server 实例，以便他们可以执行存储过程或运行视图，但理想情况下我不想给他们 SQL Server 管理工作室，因为它们不是技术性的。

是否有任何免费且易于使用的 SQL Server 远程管理/报告实用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T08:36:57.293

不是我知道的。

在我看来，您最好创建一个简单的 Web 表单/win 表单，让您的客户只能访问他们需要的特定功能和流程。这样做可以避免让客户对管理工作室会呈现给他们的所有不必要的复杂性感到困惑。

我不是编程大师，但是像这样将一些基本的东西放在一起，比如使用 .NET，可以在几个小时内完成，包括提高适当的安全性。我怀疑您可能会在 ASP.Net 教程中找到执行此操作所需的所有信息。

[http://www.asp.net/learn/](http://www.asp.net/learn/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T09:06:19.947

如果您使用的是 SQL Server 2008，则[Report Builder 2.0](http://www.microsoft.com/downloads/details.aspx?FamilyID=9f783224-9871-4eea-b1d5-f3140a253db6&displaylang=en)（免费下载）是一种旨在允许最终用户从各种数据源（包括视图和报告模型）创建报告的工具。

更多信息[在这里](http://www.microsoft.com/sqlserver/2008/en/us/report-builder.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T08:40:52.387

MS Access 不是免费的，但如果他们已经拥有它，那么您就可以了。只需针对数据库创建一个访问数据项目 (adp)，并仅授予他们对您希望他们使用的视图/存储过程的执行访问权限。他们只需点击一下即可运行存储过程，并提示他们输入参数值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T09:26:26.177

如果它是一个特定的存储过程或它要查看一个特定的视图，为什么不编写自己的单一用途应用程序呢？根本不需要很长时间，然后您将控制界面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-15T18:12:24.970

我知道这篇文章很旧，但我仍在为其他人发帖。我构建了一个小型 Web 应用程序来实现这一点。基本上，您输入服务器、目录、用户、密码和 sql 查询，并获得指向该查询/报告的 URL。您将 URL 提供给目标用户，他们将由查询生成的数据以表格格式呈现。它还包括分页、过滤和排序等功能。您可以从[http://klauscam.github.io/EasyReportingTool](http://klauscam.github.io/EasyReportingTool)下载它。

# asp.net - ASP.NET MVC - jquery 日期选择器

> ID：901137
> 
> 赞同：8
> 
> 时间：2009-05-23T08:32:10.563
> 
> 标签：asp.net, jquery, asp.net-mvc, datepicker

好的，所以我是 ASP.NET MVC 和 JQuery 的新手。

我已按照以下示例*进行操作*，但无法使日期选择器正常工作：

[http://codesprouts.com/post/Creating-A-DatePicker-Extension-In-ASPNet-MVC.aspx](http://codesprouts.com/post/Creating-A-DatePicker-Extension-In-ASPNet-MVC.aspx)

谁能告诉我这是否有任何问题或陷阱？

伯纳德。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-23T13:27:26.800

使用 google 托管的 jquery。

```
<script type="文本/javascript"
src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js">
</脚本>
<script type="文本/javascript"
src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/jquery-ui.min.js">
</脚本>

```

您还需要链接到所需的 CSS。

```
$().ready(函数()
{
    $('#from').datepicker({ dateFormat:'yy-mm-dd' });
});

<html>
...
<input id="from" class="date-field" name="from" type="text" >

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-02-10T19:35:55.923

这篇[博](http://blogs.msdn.com/b/stuartleeks/archive/2011/01/25/asp-net-mvc-3-integrating-with-the-jquery-ui-date-picker-and-adding-a-jquery-validate-date-range-validator.aspx)文提供了将 jQuery datepicker 集成到 MVC 3 站点的出色概述。

我能找到的其他一些示例集中在 MVC1 和 2 上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T08:39:06.197

如果没有更具体的信息，很难判断出了什么问题。

让您开始的一件显而易见的事情是，确保您的脚本文件的 src 标记是正确的。如果您下载标准或自定义版本，jquery-ui .js 文件的文件名会发生变化，因此值得仔细检查代码中的脚本标记是否与文件名匹配。Firefox 的 firebug 插件的“网络”选项卡真正有助于快速发现您的页面找不到的文件 - 它以红色突出显示任何未找到的文件 - 通常可以节省大量时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T09:53:21.863

看看你是否可以让日期选择器首先在 HTML 中工作。这样您就可以消除由 src 标记中不正确的文件名等引入的错误。一旦您完成了该工作，您应该能够将其添加到本文描述的 MVC 解决方案中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T05:12:09.937

过去，当我在一个文件中使用整个 jquery UI css 时，我在使用 jQuery datepicker 时遇到了困难。我最终做了什么，并且似乎对我有用，是根据需要在我的页面或母版页中分别包含不同的 jQuery UI CSS 文件。当我将 datepicker 包含在一个单独的 CSS 文件中时，它起作用了。

YMMV

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T21:12:01.217

我发现的一件事是，如果您的 id 有方括号或点，那么 datepicker 将无法工作。尝试用 under score 或其他东西替换它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-01T18:58:52.737

标签

```
 UL.tabNavigation {
                list-style: none;
                margin: 0;
                padding: 0;
            }

            UL.tabNavigation LI {
                display: inline;
            }

            UL.tabNavigation LI A {
                padding: 3px 5px;
                background-color: #ccc;
                color: #000;
                text-decoration: none;
            }

            UL.tabNavigation LI A.selected,
            UL.tabNavigation LI A:hover {
                background-color: #333;
                color: #fff;
                padding-top: 7px;
            }

            UL.tabNavigation LI A:focus {
                    outline: 0;
            }

            div.tabs > div {
                    padding: 5px;
                    margin-top: 3px;
                    border: 5px solid #333;
            }

            div.tabs > div h2 {
                    margin-top: 0;
            }

            #first {
                background-color: #f00;
            }

            #second {
                background-color: #0f0;
            }

            #third {
                background-color: #00f;
            }

            .waste {
                    min-height: 1000px;
            }
-->
</style>

<script src="Scripts/jquery-1.3.2.js" type="text/javascript"></script>
<link href="CSS/jquery-ui-1.7.2.custom.css" rel="stylesheet" type="text/css" />
<script src="Scripts/jquery-ui-1.7.2.custom.min.js" type="text/javascript"></script>

   <script  type="text/javascript">
       $(function() {
           $("#datepicker").datepicker();
       }); 
```

日期：

从 JQUERY 下载 js 文件并将它们放在您机器上的本地文件夹中，如果您使用 Visual Studio，只需将文件拖到您的设计器表面。不要忘记链接 CSS 文件。我为每个项目所做的是从我的下载位置将 js 文件添加到项目中名为 Scripts 的文件夹中，并将 css 文件添加到名为 CSS 的文件夹中。

# c# - catch 块内的异常

> ID：901149
> 
> 赞同：3
> 
> 时间：2009-05-23T08:38:49.067
> 
> 标签：c#

> **可能重复：**
> [在 C# 中，如果抛出未处理的异常，Finally 块是否会在 try、catch、finally 中执行？](https://stackoverflow.com/questions/833946/in-c-will-the-finally-block-be-executed-in-a-try-catch-finally-if-an-unhandled)

最终会在这种情况下执行（在 C# 中）？

```
try
{
    // Do something.
}
catch
{
    // Rethrow the exception.
    throw;
}
finally
{
    // Will this part be executed?
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-23T08:42:37.327

是的，finally 总是被执行。

演示行为的简单示例：

```
private void Button_Click(object sender, EventArgs e)
{
    try
    {
        ThrowingMethod();
    }
    catch
    { 
    }
}

private void ThrowingMethod()
{
    try
    {
        throw new InvalidOperationException("some exception");
    }
    catch
    {
        throw;
    }
    finally
    {
        MessageBox.Show("finally");
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T08:45:02.987

（编辑：合并评论的澄清 - 谢谢大家）
最后总是执行。我知道的唯一例外是；

*   你拔掉电源插头
*   如果一个作为“后台”运行的线程因为它所属的主程序正在结束而终止，那么该线程中的 finally 块将不会被执行。见[约瑟夫·阿尔巴哈里](http://www.albahari.com/threading/#_Creating_Starting)。
*   其他异步异常，例如 stackoverflows 和内存不足。看到[这个问题](https://stackoverflow.com/questions/833946/in-c-will-the-finally-block-be-executed-in-a-try-catch-finally-if-an-unhandled)。

大多数未执行 finally 的场景都与灾难性故障有关，除了后台线程之一，因此值得特别注意这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T08:42:37.903

是的。

您可以轻松地对此进行测试。

但是，您提出这个问题这一事实是一个很好的论据，可以将其编写为嵌套在 try/finally 中的 try/catch 块。眼睛舒服多了。

# sql - 如何计算连续事件之间的最小时间段？

> ID：901156
> 
> 赞同：2
> 
> 时间：2009-05-23T08:40:26.257
> 
> 标签：sql, mysql, timestamp

假设我有一个包含记录的时间戳列的表，我想仅使用一个查询来计算两个连续记录之间的最小时间差。

也许像一张桌子......

```
CREATE TABLE `temperatures` (
  `temperature` double,
  `time` timestamp DEFAULT CURRENT_TIMESTAMP
); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T12:24:34.743

您需要的是分析函数`LAG`和`MIN`.

它们在 中缺失`MySQL`，但可以使用会话变量轻松模拟。

此查询返回连续记录之间的所有差异：

```
SELECT  (temperature - @r) AS diff,
        @r := temperature
FROM    (
        SELECT  @r := 0
        ) vars,
        temperatures
ORDER BY
        time 
```

这个返回最小的时间差：

```
SELECT  (
        SELECT  id,
                @m := LEAST(@m, TIMEDIFF(time, @r)) AS mindiff,
                @r := time
        FROM    (
                SELECT  @m := INTERVAL 100 YEAR,
                        @r := NULL
                ) vars,
                temperatures
        ORDER BY
                time, id
        ) qo
WHERE   qo.id = 
        (
        SELECT  id
        FROM    temperatures
        ORDER BY
                time DESC, id DESC
        LIMIT 1
        ) 
```

请参阅我的博客中的这篇文章，了解如何在以下位置模拟分析函数`MySQL`：

*   [**解析函数：`FIRST_VALUE`, `LAST_VALUE`, `LEAD`,`LAG`**](http://explainextended.com/2009/03/10/analytic-functions-first_value-last_value-lead-lag/)

如果您`PRIMARY KEY`向您的表格添加一个（您应该始终这样做！），那么您可以使用更多`SQL`-ish 解决方案：

```
SELECT  temperature -
        (
        SELECT temperature
        FROM   temperatures ti
        WHERE  (ti.timestamp, ti.id) < (to.timestamp, to.id)
        ORDER BY
               ti.timestamp DESC, ti.id DESC
        LIMIT 1
        )
FROM    temperatures to
ORDER BY
       to.timestamp, to.id 
```

但是，`MySQL`由于存在[**错误 20111**](http://bugs.mysql.com/bug.php?id=20111) ，此解决方案效率非常低。

子查询将不使用`range`访问路径，尽管它将使用 ( `timestamp`, `id`) 上的索引进行排序。

这可以通过创建`UDF`返回先前温度的 a 来解决，给定当前记录的`id`.

有关详细信息，请参阅我的博客中的这篇文章：

*   [**分析函数：优化`LAG`, `LEAD`, `FIRST_VALUE`,`LAST_VALUE`**](http://explainextended.com/2009/03/12/analytic-functions-optimizing-lag-lead-first_value-last_value/)

如果您不使用任何过滤条件，那么使用会话变量的解决方案将是最有效的，尽管`MySQL`具体。

类似的解决方案`SQL Server`如下所示：

```
SELECT  temperature -
        (
        SELECT TOP 1 temperature
        FROM   temperatures ti
        WHERE  ti.timestamp < to.timestamp
               OR (ti.timestamp = to.timestamp AND ti.id < to.id)
        ORDER BY
               ti.timestamp DESC, ti.id DESC
        )
FROM    temperatures to
ORDER BY
       to.timestamp, to.id 
```

和

```
SELECT  MIN(mindiff)
FROM    (
        SELECT  timestamp -
                (
                SELECT TOP 1 timestamp
                FROM   temperatures ti
                WHERE  ti.timestamp < to.timestamp
                       OR (ti.timestamp = to.timestamp AND ti.id < to.id)
                ORDER BY
                       ti.timestamp DESC, ti.id DESC
                ) AS mindiff
        FROM    temperatures to
        ORDER BY
               to.timestamp, to.id
        ) q 
```

在`SQL Server`中，这可以正常工作，前提是您有一个索引`(timestamp, id)`（或仅在 上`(timestamp)`，如果您`PRIMARY KEY`是集群的）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T17:10:59.660

假设时间戳有唯一约束（防止同时有两个记录）：

```
SELECT MIN(timediff(t1.`time`, t2.`time`)) AS delta_t,
    FROM temperatures t1 JOIN temperatures t2 ON t1.`time` < t2.`time` 
```

这相当准确地回答了问题 - 并且不传达其他有用的信息（例如哪两个时间戳或温度）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T08:49:53.303

尝试这样的查询：

```
select 
    cur.timestamp as CurrentTime,
    prev.timestamp as PreviousTime,
    timediff(cur.timestamp,prev.timestamp) as TimeDifference,
    cur.temperature - prev.temperature as TemperatureDifference
from temperatures cur
left join temperatures prev on prev.timestamp < cur.timestamp
left join temperatures inbetween
    on prev.timestamp < inbetween.timestamp
    and inbetween.timestamp < cur.timestamp
where inbetween.timestamp is null 
```

第一个连接查找当前（“cur”）行的所有先前行。第二个连接查找第一行和第二行之间的行。where 语句表示第一行和第二行之间不能有任何行。这样，您将获得包含前一行的行列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T08:48:25.223

你可以试试这个：

```
SELECT
    T1.*,
    (SELECT MIN(T2.time)
     FROM temperatures T2
     WHERE T2.time > T1.time)-T1.time diff
FROM
    temperatures T1
ORDER BY
    T1.time 
```

# cocoa - 如何在 NSComboBox 的弹出菜单中为文本着色？

> ID：901164
> 
> 赞同：1
> 
> 时间：2009-05-23T08:45:20.207
> 
> 标签：cocoa, user-controls, user-interface

我正在使用 NSComboBox 并希望将弹出列表中的某些项目标记为红色。我在 NSComboBoxCell 中找不到合适的方法来覆盖。任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T15:57:13.453

您需要直接修改弹出按钮的菜单项，但这并不难。您甚至不需要子类化，您可以从控制器中完成所有操作。

```
NSMenu *menu = [popUpButton menu];
NSMenuItem *item = [menu itemWithTag:100];
NSDictionary *attributes = [NSDictionary dictionaryWithObjectsAndKeys:[NSColor redColor], NSForegroundColorAttributeName, nil];
NSAttributedString *string = [[NSAttributedString alloc] initWithString:[item title] attributes:attributes];

[item setAttributedTitle:string]; 
```

您可能希望从现有的属性字符串标题中复制属性，以便字体和大小保持不变，但这应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T09:00:55.823

使用`NSCell`'s`-setAttributedStringValue:`方法怎么样？只需创建一个`NSAttributedString`具有您想要为`NSForegroundColorAttributeName`键设置的颜色的颜色，您就可以开始使用了。

# .net - 为什么 UnicastIPAddressInformation.IPv4Mask 在 IPv4 地址上返回 null？

> ID：901165
> 
> 赞同：1
> 
> 时间：2009-05-23T08:45:36.667
> 
> 标签：.net, network-programming, subnet

以下是从本地系统构建 IP 地址及其子网掩码列表的代码部分，但是警告功能似乎会定期触发，这在理论上应该是不可能的 - 因为它不应该有 IPv4 地址没有相关的子网掩码[?]。

```
 static NetworkUtil()
    {
        foreach (NetworkInterface ni in NetworkInterface.GetAllNetworkInterfaces())
        {
            foreach (UnicastIPAddressInformation address in ni.GetIPProperties().UnicastAddresses)
            {
                if (address.Address.AddressFamily == AddressFamily.InterNetwork)
                {
                    if (address.IPv4Mask != null)
                    {
                        m_subnets.Add(address.Address, address.IPv4Mask);
                    }
                    else
                    {
                        m_log.Warn("[NetworkUtil] Found IPv4 Address without Subnet Mask!?");
                    }
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-10-05T13:29:52.293

这是因为您遇到了环回适配器。即 127.0.0.1 这些将 IPv4Mask 设置为空。请参阅 ni.Name 以查看我是否正确。

要检查环回适配器，请执行...

if (ni.NetworkInterfaceType != NetworkInterfaceType.Loopback) ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-29T13:55:40.650

当网络关闭时，IPv4Mask 返回 null（请参阅 ni.OperationalStatus），您在遍历 GetAllNetworkInterfaces() 返回的所有内容时经常会遇到这种情况。

这似乎已在 .Net 4.0 中修复

有时可以推断出掩码，例如所有以 169.254 开头的 IP 地址（当 DHCP 失败时 Windows 会选择该地址）具有 255.255.0.0 的掩码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T09:14:59.947

这很奇怪。显然，它的语义并不是人们可以合理预期的。

你能检查一下有问题的接口的子网掩码是否是有类的吗？即，对于那些`IPv4Mask`为空的接口地址，它们是分别具有/8、/16 和/24 网络掩码的A、B 和C 类地址吗？

也许这个函数并不是真正的 CIDR 世界的成员，他们真的只做“子网”掩码；假定没有地址的地址使用有类网络掩码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-26T15:24:25.567

我刚刚遇到的一个原因：

我使用 .NET 框架 4 客户端配置文件，IPv4Mask 与我配合得很好。切换到 .NET 框架 2 或 3.5 时，它返回 NULL。我多次重现了这个问题。

# asp.net-mvc - 如何以矩阵形式显示数据 - Asp.Net MVC

> ID：901169
> 
> 赞同：0
> 
> 时间：2009-05-23T08:47:30.937
> 
> 标签：asp.net-mvc

我有一个表结构喜欢

1)Id 2)Date 3)score

按日期过滤，我可以显示行数（显示字段：分数）。

在一页上我要显示 3 个日期的记录（3 个后续日期，存储在表格中）。

格式应该看起来像....

**日期 1 日期 2 日期 3**

分数分数分数

分数分数分数

分数分数分数

…………

我应该使用现有的模型类创建自己的模型吗？

我不知道您会想到什么，但是在这种情况下，用户控制可以帮助我吗？

请帮我...

**公众需求更新**

使用

```
<% foreach (var item in Model) { %>
<% } %> 
```

我可以在索引视图中轻松显示每条记录。

上面的结构呢？？

如果你没有得到那么...

记录 ：

1 2009 年 2 月 21 日 29

2 2009 年 2 月 21 日 50

3 2009 年 2 月 21 日 54

2 2009 年 2 月 21 日 77

2 2009 年 2 月 23 日 55

2 2009 年 2 月 23 日 44

2 2009 年 2 月 23 日 66

2 2009 年 2 月 24 日 53

展示

21/2/2009| 23/2/2009| 2009 年 2 月 24 日

29| 55| 53

50| 44|

54| 66|

77|

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T09:49:13.853

我已经从脑海中发布了这个 - 所以可能存在拼写错误/错误。

首先，您需要一个自定义模型：

```
public class ScoreColumnViewModel {
    public DateTime Date;
    public List<int> Score;
} 
```

在您的控制器中创建一个 ScoreColumnViewModel 列表（假设 Linq-To-Sql）：

```
var dates = /* dates to select */

var scoreColumns = dates.Select(date =>
    new ScoreColumnViewModel {
        Date = date;
        Score = DB.Scores.Where(x => x.Date == date).
                    Select(x => x.Score).ToList();
    }
).ToList(); 
```

在您看来：

```
<% foreach(var column in Model) { %>
    <table>
        <tr><th><%= column.Date %></th></tr>
        <% foreach(var score in column.Scores) { %>
            <tr><td>score</td></tr>
        <% } %>
    </table>
<% } %> 
```

在你的 CSS 中：

```
table {
    float: left;
} 
```

我的解决方案并不理想，但它可能是您的起点。

# java - NIO 中的线程实现需要帮助

> ID：901188
> 
> 赞同：1
> 
> 时间：2009-05-23T09:06:54.500
> 
> 标签：java, multithreading, nio

我想创建 NIOServer，它使用 1 个线程从客户端读取数据并使用另一个线程将数据写入客户端。也接受客户端连接将在其他线程中。

有没有在线帮助

谢谢迪帕克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T09:31:47.337

如果您使用选择器和单个线程更轻松地完成所有操作，为什么要使用这么多线程？如果您想要一种多线程方法来处理网络 I/O，那么您应该考虑普通的老式阻塞套接字。

顺便说一句，您可以使用 3 个选择器完成所有操作：一个接受连接，一个读取和一个写入。当您接受连接时，您可以使用其他两个选择器注册通道，并使用适当的兴趣操作。

当然，当您必须释放通道时，您必须从两个选择器（读取和写入）中取消 SelectionKey 或关闭它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T16:51:09.320

我会向您推荐[Apache Mina](http://mina.apache.org/)：非常灵活、高级抽象、高性能等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T10:32:05.780

我建议你看一下 JDK 下 sample/nio/server 下的示例代码

# wordpress - WordPress 的 .htaccess 和 SEO 是如何构建的？

> ID：901189
> 
> 赞同：1
> 
> 时间：2009-05-23T09:09:47.537
> 
> 标签：wordpress, .htaccess, seo, url-rewriting

我曾考虑过使用 WordPress——或者只是将一些功能复制到内部站点——但在我使用它之前，我想知道它是如何工作的。

我认为 WP 是一堆 slamcode，所以我希望你们中的一些人可以帮助我了解它是如何构建的。

.htaccess 和 URL 重写如何与 index.php 结合？- .htaccess 将*所有内容*发送到 index.php，我尝试跟踪每个文件，但看不到 index.php 如何检测 url。我怎么能建立一个简单的版本呢？

干杯，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T09:35:23.087

[WordPress Codex 中有一个关于使用永久链接](http://codex.wordpress.org/Using_Permalinks)的非常详细的摘要。

如果您对它的实现方式感兴趣，请参阅文件中的 WordPress Rewrite API`/wordpress/wp-includes/rewrite.php`并查看[WP Codex 中的相关参考条目](http://codex.wordpress.org/Function_Reference/WP_Rewrite)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T09:30:24.720

index.php 真的被参数调用：

```
 index.php?page=55 
```

我猜你正在寻找一种方法来为没有 seo 的 seo 提供很好的链接？参数

htaccess 部分可能如下所示：

```
 RewriteCond %{ENV:REDIRECT_STATUS} ^$
RewriteCond %{REQUEST_FILENAME} !-f [NC]
RewriteCond %{REQUEST_FILENAME} !-d [NC]
RewriteRule ^(.+)/$ index.php?page=$1 [NC,L,QSA] 
```

1.  我们还没有重定向 2.+3。链接不指向真实文件或目录
2.  将斜杠后的内容映射为页面参数

所以例如“www.homepage.com/superpage”被映射到“www.homepage.com/index.php?page=superpage”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T22:53:19.463

更正...根据WordPress中默认的.htaccess规则和下面列出的规则，它会首先查看URL中给出的路径中是否存在文件或目录。如果该位置没有文件/目录，则调用 index.php。

这确保了管理部分的工作方式。这也确保您可以转储 WordPress 目录中的任何文件并且仍然能够访问它们。

一旦重定向到达 index.php，就会调用 WordPress 重定向 API，如[本文](https://stackoverflow.com/questions/901189/how-is-wordpress-htaccess-and-seo-built/901217#901217)所示。

# jquery - Jquery - 鼠标悬停 -> 淡入/淡出 // 点击 -> 不透明度 100% // 其他点击 -> 不透明度 60

> ID：901194
> 
> 赞同：1
> 
> 时间：2009-05-23T09:13:55.157
> 
> 标签：jquery, onclick, fadein, fadeout

我正在一个带有 jquery 和缩略图的网站上工作。

加载页面时，所有缩略图都必须为 60% 的不透明度。只要您将鼠标移到拇指上，它就需要淡出至 100%，如果您将鼠标移出，则缩略图需要淡出至 60% 的不透明度。

当用户点击缩略图时，它必须保持 100% 的不透明度。一旦用户点击另一个缩略图，“旧”缩略图必须淡出到 60%，而“新”缩略图必须保持在 100%。（它已经具有 100% 的不透明度，因为您将鼠标悬停在它上面）。

这是我到目前为止的代码：

```
$(window).bind("load", function () {
    $("#mycarousel li").fadeTo(1, 0.6);

    $("#mycarousel li").hover(function () {
        $(this).fadeTo(350, 1.0);
        $(this).addClass('Active');
    }, function () {
        $("this:not('.Active')").fadeTo(350, 0.6);
    });
}); 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T12:03:56.360

```
$(window).bind("load", function() {
    var activeOpacity   = 1.0,
        inactiveOpacity = 0.6,
        fadeTime = 350,
        clickedClass = "selected",
        thumbs = "#mycarousel li";

    $(thumbs).fadeTo(1, inactiveOpacity);

    $(thumbs).hover(
        function(){
            $(this).fadeTo(fadeTime, activeOpacity);
        },
        function(){
            // Only fade out if the user hasn't clicked the thumb
            if(!$(this).hasClass(clickedClass)) {
                $(this).fadeTo(fadeTime, inactiveOpacity);
            }
        });
     $(thumbs).click(function() {
         // Remove selected class from any elements other than this
         var previous = $(thumbs + '.' + clickedClass).eq();
         var clicked = $(this);
         if(clicked !== previous) {
             previous.removeClass(clickedClass);
         }
         clicked.addClass(clickedClass).fadeTo(fadeTime, activeOpacity);
     });
}); 
```

# php - 创建动态 PNG 图像

> ID：901201
> 
> 赞同：30
> 
> 时间：2009-05-23T09:25:00.657
> 
> 标签：php, image, png

我想在 PHP 中创建一个小函数，它接受颜色、形状、透明度等参数并输出 PNG 图像。我听说过 PHP GD 库，但我想知道如何才能像尽快一样创建有创意的东西[。media.mit.edu](http://soon.media.mit.edu/masthead/?short=1;solid=c30;fuzz=0.62)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-23T09:31:34.123

[这是一个很好的例子](http://php.net/manual/en/image.examples-png.php)，您几乎可以使用[这些功能](http://php.net/manual/en/book.image.php)做任何事情。虽然可能，但创建一个像你描述的那样的图像会非常困难，因为我已经用渐变、循环和颜色做了一些奇怪的东西。

如果您想根据某些参数动态地制作这样的图像，您总是可以事先在 Photoshop 中创建图像，然后根据用户选择的内容叠加它们。

您可以享受很多乐趣。

编辑：哦，顺便说一句，如果您有兴趣[提供一个无效参数，则会显示一些](http://soon.media.mit.edu/masthead/?short=0.4;solid=c30;fuzz=invalid)负责创建图像并导致错误的 python 代码。这将是了解代码的好地方。

第二次编辑：这只是我用这种技术所做的事情。请记住，这是很久以前的事了。它接受基于查询字符串的名称，并且基本上使用大量随机数进行一些循环。

这是源代码，对于任何愚蠢的代码/报价，我深表歉意。这是很久以前写的，我相信当时我大约 14 岁（可能有很多缺陷）。

```
<?php
header("Content-type:image/jpeg");
$array=array("I am a monument to all your sins", "Currently making pizza","Best before 12/7/09", "Farming Onions");
        function imagettftext_cr(&$im, $size, $angle, $x, $y, $color, $fontfile, $text)
        {
            // retrieve boundingbox
            $bbox = imagettfbbox($size, $angle, $fontfile, $text);
            // calculate deviation
            $dx = ($bbox[2]-$bbox[0])/2.0 - ($bbox[2]-$bbox[4])/2.0;         // deviation left-right
            $dy = ($bbox[3]-$bbox[1])/2.0 + ($bbox[7]-$bbox[1])/2.0;        // deviation top-bottom
            // new pivotpoint
            $px = $x-$dx;
            $py = $y-$dy;
            return imagettftext($im, $size, $angle, $px, $y, $color, $fontfile, $text);
        }
$image = imagecreate(500,90);
$black = imagecolorallocate($image,0,0,0);
$grey_shade = imagecolorallocate($image,40,40,40);
$white = imagecolorallocate($image,255,255,255);

$text = $array[rand(0,sizeof($array)-1)];

// Local font files, relative to script
$otherFont = 'army1.ttf';
$font = 'army.ttf';

if($_GET['name'] == ""){ $name = "Sam152";}else{$name= $_GET['name'];}
$name = substr($name, 0, 25);    

//BG text for Name
while($i<10){
imagettftext_cr($image,rand(2,40),rand(0,50),rand(10,500),rand(0,200),$grey_shade,$font,$name);
$i++;
}
//BG text for saying
while($i<10){
imagettftext_cr($image,rand(0,40),rand(90,180),rand(100,500),rand(200,500),$grey_shade,$otherFont,$text);
$i++;
}

// Main Text
imagettftext_cr($image,35,0,250,46,$white,$font,$name);
imagettftext_cr($image,10,0,250,76,$white,$otherFont,$text);
imagejpeg($image);

?> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-23T09:46:59.070

这是我之前用来生成具有两个名称的图像的代码，它们从查询字符串参数中接受。我使用准备好的背景图像并将名称放在上面。

```
<?php
// Print two names on the picture, which accepted by query string parameters.

$n1 = $_GET['n1'];
$n2 = $_GET['n2'];

Header ("Content-type: image/jpeg");
$image = imageCreateFromJPEG("images/someimage.jpg");
$color = ImageColorAllocate($image, 255, 255, 255);

// Calculate horizontal alignment for the names.
$BoundingBox1 = imagettfbbox(13, 0, 'ITCKRIST.TTF', $n1);
$boyX = ceil((125 - $BoundingBox1[2]) / 2); // lower left X coordinate for text
$BoundingBox2 = imagettfbbox(13, 0, 'ITCKRIST.TTF', $n2);
$girlX = ceil((107 - $BoundingBox2[2]) / 2); // lower left X coordinate for text

// Write names.
imagettftext($image, 13, 0, $boyX+25, 92, $color, 'ITCKRIST.TTF', $n1);
imagettftext($image, 13, 0, $girlX+310, 92, $color, 'ITCKRIST.TTF', $n2);

// Return output.
ImageJPEG($image, NULL, 93);
ImageDestroy($image);
?> 
```

要在页面上显示生成的图像，您可以执行以下操作：

```
<img src="myDynamicImage.php?n1=bebe&n2=jake" /> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-23T14:18:26.433

不是“用 PHP 做”的直接答案，但您可以*从*PHP 调用一些强大的命令行软件。特别是[ImageMagick](http://imagemagick.org)将绘制包括厨房水槽在内的所有内容。它还具有可用于“带外”处理的“后端”脚本（即，在请求完成后执行图像处理（更快的用户反馈）或在深夜资源紧张时分批执行的优势。高峰时间。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-07-17T11:33:46.083

这是一个简单的例子：

```
<?php
    $your_text = "Helloooo Worldddd";

    $IMG = imagecreate( 250, 80 );
    $background = imagecolorallocate($IMG, 0,0,255);
    $text_color = imagecolorallocate($IMG, 255,255,0); 
    $line_color = imagecolorallocate($IMG, 128,255,0);
    imagestring( $IMG, 10, 1, 25, $your_text,  $text_color );
    imagesetthickness ( $IMG, 5 );
    imageline( $IMG, 30, 45, 165, 45, $line_color );
    header( "Content-type: image/png" );
    imagepng($IMG);
    imagecolordeallocate($IMG, $line_color );
    imagecolordeallocate($IMG, $text_color );
    imagecolordeallocate($IMG, $background );
    imagedestroy($IMG); 
    exit;   
?> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-04T04:29:44.267

这并不完全是您要查找的内容，但我编写了一个脚本以将动态颜色层插入透明图像。您使用单色图像“图层”设置它并运行它，为其提供十六进制颜色代码。该脚本为您的图层重新着色并将它们合并为一个图像以呈现。这是代码；希望你能从中得到一些用处。

```
function hexLighter($hex, $factor = 30) {
    $new_hex = '';

    $base['R'] = hexdec($hex{0}.$hex{1});
    $base['G'] = hexdec($hex{2}.$hex{3});
    $base['B'] = hexdec($hex{4}.$hex{5});

    foreach ($base as $k => $v) {
        $amount = 255 - $v;
        $amount = $amount / 100;
        $amount = round($amount * $factor);
        $new_decimal = $v + $amount;

        $new_hex_component = dechex($new_decimal);

        $new_hex .= sprintf('%02.2s', $new_hex_component);
    }

    return $new_hex;
}

// Sanitize/Validate provided color variable
if (!isset($_GET['color']) || strlen($_GET['color']) != 6) {
    header($_SERVER['SERVER_PROTOCOL'] . ' 400 Bad Request', true, 400);

    exit(0);
}

if (file_exists( "cache/{$_GET['color']}.png" )) {
    header( 'Content-Type: image/png' );
    readfile( "cache/{$_GET['color']}.png" );

    exit(0);
}

// Desired final size of image
$n_width = 50;
$n_height = 50;

// Actual size of source images
$width = 125;
$height = 125;

$image =    imagecreatetruecolor($width, $height);
            imagesavealpha($image, true);
            imagealphablending($image, false);

$n_image =  imagecreatetruecolor($n_width, $n_height);
            imagesavealpha($n_image, true);
            imagealphablending($n_image, false);

$black = imagecolorallocate($image, 0, 0, 0);
$transparent = imagecolorallocatealpha($image, 255, 255, 255, 127);

imagefilledrectangle($image, 0, 0, $width, $height, $transparent);

$layers = array();
$layers_processed = array();

$layers[] = array( 'src' => 'layer01.gif', 'level' => 0 );  // Border
$layers[] = array( 'src' => 'layer02.gif', 'level' => 35 );     // Background
$layers[] = array( 'src' => 'layer03.gif', 'level' => 100 );    // White Quotes

foreach ($layers as $idx => $layer) {
    $img = imagecreatefromgif( $layer['src'] );
    $processed = imagecreatetruecolor($width, $height);

    imagesavealpha($processed, true);
    imagealphablending($processed, false);

    imagefilledrectangle($processed, 0, 0, $width, $height, $transparent);

    $color = hexLighter( $_GET['color'], $layer['level'] );
    $color = imagecolorallocate($image,
        hexdec( $color{0} . $color{1} ),
        hexdec( $color{2} . $color{3} ),
        hexdec( $color{4} . $color{5} )
    );

    for ($x = 0; $x < $width; $x++)
        for ($y = 0; $y < $height; $y++)
            if ($black === imagecolorat($img, $x, $y))
                imagesetpixel($processed, $x, $y, $color);

    imagecolortransparent($processed, $transparent);
    imagealphablending($processed, true);

    array_push($layers_processed, $processed);

    imagedestroy( $img );
}

foreach ($layers_processed as $processed) {
    imagecopymerge($image, $processed, 0, 0, 0, 0, $width, $height, 100);

    imagedestroy( $processed );
}

imagealphablending($image, true);

imagecopyresampled($n_image, $image, 0, 0, 0, 0, $n_width, $n_height, $width, $height);

imagealphablending($n_image, true);

header( 'Content-Type: image/png' );
imagepng( $n_image, "cache/{$_GET['color']}.png" );
imagepng( $n_image );

// Free up memory
imagedestroy( $n_image );
imagedestroy( $image ); 
```

如果您想了解有关该代码的更多信息，我的[博客](http://www.stephenwalcher.com/blog/2012/02/02/how-to-make-a-transparent-image-with-dynamic-color-layers/)上有详细说明。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-12-16T21:33:07.577

这是我用动态文本创建动态 png 图像的功能......并且可以称为 -

```
<img src="create_image.php?s=008080_F_1000_200&t=Sample%20Image%20Drawn%20By%20PHP" alt="GD Library Example Image" > 
```

这里是 create_image.php，它提供了请求的图像...

```
<?php
$setting = isset($_GET['s']) ? $_GET['s'] : "FFF_111_100_100";
$setting = explode("_",$setting );
$img = array();

switch ($n = count($setting)) {
    case $n > 4 :
    case 3:
        $setting[3] = $setting[2];
    case 4:
        $img['width'] = (int) $setting[2];
        $img['height'] = (int) $setting[3];
    case 2:
        $img['color'] = $setting[1];
        $img['background'] = $setting[0];
        break;
    default:
        list($img['background'],$img['color'],$img['width'],$img['height']) = array('F','0',100,100);
        break;
}

$background = explode(",",hex2rgb($img['background']));
$color = explode(",",hex2rgb($img['color']));
$width = empty($img['width']) ? 100 : $img['width'];
$height = empty($img['height']) ? 100 : $img['height'];
$string = (string) isset($_GET['t']) ? $_GET['t'] : $width ."x". $height;

header("Content-Type: image/png");
$image = @imagecreate($width, $height)
    or die("Cannot Initialize new GD image stream");

$background_color = imagecolorallocate($image, $background[0], $background[1], $background[2]);
$text_color = imagecolorallocate($image, $color[0], $color[1], $color[2]);

imagestring($image, 5, 5, 5, $string, $text_color);
imagepng($image);
imagedestroy($image);

function hex2rgb($hex) {
    // Copied
   $hex = str_replace("#", "", $hex);

   switch (strlen($hex)) {
    case 1:
        $hex = $hex.$hex;
    case 2:
          $r = hexdec($hex);
          $g = hexdec($hex);
          $b = hexdec($hex);
        break;

    case 3:
          $r = hexdec(substr($hex,0,1).substr($hex,0,1));
          $g = hexdec(substr($hex,1,1).substr($hex,1,1));
          $b = hexdec(substr($hex,2,1).substr($hex,2,1));
        break;

    default:
          $r = hexdec(substr($hex,0,2));
          $g = hexdec(substr($hex,2,2));
          $b = hexdec(substr($hex,4,2));
        break;
   }

   $rgb = array($r, $g, $b);
   return implode(",", $rgb); 
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-01-04T10:22:12.500

这是一个简单的使用示例：

```
<?php
    $your_text = "Helloooo Worldddd";

    $IMG = imagecreate( 250, 80 );
    $background = imagecolorallocate($IMG, 0,0,255);
    $text_color = imagecolorallocate($IMG, 255,255,0); 
    $line_color = imagecolorallocate($IMG, 128,255,0);
    imagestring( $IMG, 10, 1, 25, $your_text,  $text_color );
    imagesetthickness ( $IMG, 5 );
    imageline( $IMG, 30, 45, 165, 45, $line_color );
    header( "Content-type: image/png" );
    imagepng($IMG);
    imagecolordeallocate($IMG, $line_color );
    imagecolordeallocate($IMG, $text_color );
    imagecolordeallocate($IMG, $background );
    imagedestroy($IMG); 
    exit;   
?> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-27T21:54:20.587

您也可以使用[Imagick](http://php.net/manual/en/book.imagick.php)。它在性能方面可能比 GD 库更好。

```
// Create new object
$im = new Imagick();

// Create new image with properties
$im->newImage( 1000, 1000, '#FF0000' );

// Write texts on it
$text_draw = new ImagickDraw();
$text_draw->setFont( 'path/to/font' );
$text_draw->setFontSize( 150 );
$text_draw->setStrokeColor('#fff');
$text_draw->setFillColor('#C0C0C0');

$im->setImageFormat( "png" );
$im->writeImage( 'path/to/save/filename.png' );
$img->destroy(); 
```

来源：[http ://coderaweso.me/php-imagick-create-images-texts/](http://coderaweso.me/php-imagick-create-images-texts/)

# javascript - 选择一组节点并包裹在一个

> ID：901202
> 
> 赞同：0
> 
> 时间：2009-05-23T09:25:16.803
> 
> 标签：javascript, jquery

我正在尝试为一个结构相当不愉快的页面编写一个greasemonkey 脚本。我希望能够显示和隐藏不同的条目，但它们的形式是：

```
<a name="first"/>
<h3>First</h3>
Some text....
<!-- end -->
<a name="second"/>
<h3>Second</h3>
Some text....
<!-- end --> 
```

我希望能够将这些包装在 <div> 中，例如：

```
<a name="first"/>
<div name="first>
    <h3>First</h3>
    Some text....
    <!-- end -->
</div> 
```

我怎样才能做到这一点？我正在考虑使用 prev ~ 兄弟姐妹 jQuery 选择器，然后迭代直到我达到另一个匹配，但是（a）我必须手动匹配下一个，并且（b）我不确定如何将它们放入什么时候完成？

谢谢！

PS。为什么我必须使用 < 和> 写 <div> 而不是尖括号？

**更新：**

到目前为止，我有：

```
$(document).ready(function(){
    var course = $("meta[name=DEPARTMENT]").attr("content").replace(/^\s+/, "");

    $("a[name^="+course+".]:first").each(function(){
        GM_log(this.name);
        var stop=false;
        $(this).nextAll().filter(function(){
            if ($(this).is("a[name^="+course+".]"))
            {
                stop=true;
            }
            return !stop;
        })
        .wrapAll(document.createElement("div"));
    });
}); 
```

但是，这会留下孤立的文本：

```
<a name="first"/>
<div name="first>
    <h3>First</h3>
    <!-- end -->
</div>
Some text... 
```

**更新 2：** 原来 nextAll 函数被写入仅返回元素节点。我写了一个替换：

```
$.fn.nextAllWithText = function() {
    var ret = [];

    $(this).each(function() {
        var cur = this.nextSibling;
        while (cur && cur != document) {
            ret.push(cur);
            cur = cur.nextSibling;
        };
    });

    return $(ret);
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T10:19:47.023

:first 在我看来不合适。

# oop - 培训初级开发人员

> ID：901206
> 
> 赞同：-2
> 
> 时间：2009-05-23T09:27:53.383
> 
> 标签：oop, architecture

我正在培训一名初级开发人员。

我想指派他设计和构建一个面向对象的应用程序的任务。

网络上是否有任何重要的示例练习，其中包括对问题的良好描述和建议的架构图？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-23T09:54:53.080

多年来，他一直是学生。他不需要或不想要其他任务，他想要真正的工作，所以把它交给他。下沉或游泳。

> 做，或不做。没有尝试。
> 
> ~~尤达。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-23T10:55:00.430

在我们的组织中，我们有一系列易于解决的非关键工单，我们倾向于保留这些工单，作为新员工的首要任务。这些票证通常涉及主要代码库周围的东西，偶尔包含新的“不错的”功能请求。

由于它们不是紧急/关键的，因此如果初级开发人员犯了错误也没什么大不了的。*但是，他们了解编写真实*代码的感觉，这有助于使他们保持专注和满足。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T10:44:54.677

给他一个你的组织真正需要的大任务（你或其他人本来会做的），给他详细的指示（比你通常给有经验的开发人员的更多：里程碑，数据源等），并且指导他的进步。

新开发人员通常更喜欢做真实的事情。此外，通过这种方式，他将学到更多对他接下来的任务有用的东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-23T09:38:30.460

我建议你这样做：

*   从给他简单的任务开始。
*   查看解决方案，评论并说出可以以其他/更好的方式完成的工作以及原因，与他讨论。
*   让他做实验，帮助他回答问题或给他一些参考资料。

通过这种方式，您将在几周/几个月内看到差异:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T09:31:54.513

一个典型的练习是建立一个完整的课程成绩簿，并为教师、学生、课程等定义数据库模式。我不认为这是微不足道的，它有很好理解的要求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T13:23:10.287

我决定给他一个调度系统，部分基于这个：

[http://martinfowler.com/apsupp/recurring.pdf](http://martinfowler.com/apsupp/recurring.pdf)

# jquery - jQuery：交换图像 - 几乎完成

> ID：901207
> 
> 赞同：4
> 
> 时间：2009-05-23T09:29:06.407
> 
> 标签：jquery, drag-and-drop

**概述**

*   用户可以将图像从“#products”拖到“#container”。它们将落入正常的元素流中。
*   “#container”内的所有图像都可以在网格中该容器的一侧拖动。
*   在“#container”中，如果一个图像被丢弃到另一个图像所在的位置，它们会交换位置。

**问题**

当我开始在“#container”中移动图像时，就会出现问题。下次我将图像从“#products”拖到“#container”时，图像将落入正常的元素流中，而不会意识到元素已被移动。这导致图像可能位于另一个图像之上，从而覆盖了它。

这可能与 position:relative 在移动元素时保持不变有关。

您的帮助将不胜感激。

我计划将它作为一个 jQuery 插件发布。如果他们愿意，任何帮助使其工作的人都将得到认可。

**代码**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta http-equiv="Content-type" content="text/html; charset=iso-8859-1" />
    <title>Drag drop 1</title>
    <script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui-1.7.1.custom.min.js"></script>
    <script type="text/javascript">
    $(document).ready(function() {
        // --------------
        // - Image swap -
        // --------------
        // The user can drag an image from "#products" to "#container". They will fall into the normal flow of elements.
        // All images inside of "#container" can be dragged around in side that container in a grid.
        // If an image is dropped where another image are, they swap places.

        // Setting global variables.
        var dragged = null;

        // Make a clone of a image from the "#products" container.
        $(".product").draggable({
            helper: 'clone'
        });

        // Make "#container" a droppable and only accept images with ".product" class.
        $("#container").droppable({

            // Only accept images with ".product" class.
            accept: '.product',
            drop: function(event, ui) {

                // When clone of image from "#products" gets dropped on "#container" it is added to "#container".
                // After that we change the class name to "item".
                $(this).append(ui.draggable.clone().addClass("item").removeClass("product"));

                // Images with class "item" in "#container" are made draggable. 
                $(".item").draggable({

                    // Prevent draggables to go outside "#container".
                    containment: 'parent',

                    // Make sure that draggables only can be in 9 positions in a grid.
                    grid: [150,150],
                    start:function(event, ui) {

                        // When image is dragged, make sure it is always on top.
                        $(this).css({'z-index' : '100'});

                        // Get position where the dragging got started.
                        dragged = $(this).position();

                        // Below line can be uncommeted if you use Firebug and Firefox so you can trace variable "dragged".
                        //console.debug("Dragged: ",dragged);
                    },
                    stop: function(event, ui) {

                        // Revert to original layer position.
                        $(this).css({'z-index' : '10'});
                    }
                });

                // Inside the "#container" we make all images droppables.
                $(".item").droppable({
                    drop: function(event, ui) {

                        // If a clone dragged from "#products" over an existing image in "#container" do not do below.
                        if(dragged!=null) {

                            // Get position of the image where another image from "#container" was dropped on.
                            var dropped_on = $(this).position();
                            var drop_top = $(this).css("top");
                            var drop_left = $(this).css("left");

                            // All images has the css property position:relative. Therefore it is needed to calculate the
                            // where to move the dropped on image relative to it's current position.
                            var newTop = dragged.top - (dropped_on.top - parseInt(drop_top));
                            var newLeft = dragged.left - (dropped_on.left - parseInt(drop_left));

                            // Only move dropped on image since dragged image has been dropped in the right position.
                            $(this).css({'top' : newTop, 'left' : newLeft});

                            // Below lines can be uncommeted if you use Firebug and Firefox so you can trace variables.
                            // console.debug("newTop: ",newTop," newLeft: ",newTop);
                            // console.debug("drop_top: ",drop_top," drop_left: ",drop_left);
                        }
                    }
                });
            }
        });
    });
    </script>
    <style>
    body {

    }
    #container {
        width:450px;
        height:450px;
        border:1px solid #000;
    }
    .item {
        width:150px;
        height:150px;
        z-index:10;
        cursor:move;
    }
    #products {
        position:absolute;
        width:450px;
        height:450px;
        top:9px;
        left:550px;
        border:1px solid #000;
    }
    .product {

    }
    #testarea {
        position:absolute;
        width:450px;
        height:450px;
        top:9px;
        left:1100px;
        border:1px solid #000;
    }
    </style>
</head>
<body>
    <div id="container">
    </div>
    <div id="products">
        <img id="productid_1" src="images/pic1.jpg" class="product" alt="" title="" /><img id="productid_2" src="images/pic2.jpg" class="product" alt="" title="" /><img id="productid_3" src="images/pic3.jpg" class="product" alt="" title="" /><img id="productid_4" src="images/pic4.jpg" class="product" alt="" title="" /><img id="productid_5" src="images/pic5.jpg" class="product" alt="" title="" /><img id="productid_6" src="images/pic6.jpg" class="product" alt="" title="" /><img id="productid_7" src="images/pic7.jpg" class="product" alt="" title="" /><img id="productid_8" src="images/pic8.jpg" class="product" alt="" title="" /><img id="productid_9" src="images/pic9.jpg" class="product" alt="" title="" />
    </div>
</body>
</html> 
```

# iphone - sqlite3_bind_text 是否足以防止 iPhone 上的 SQL 注入

> ID：901214
> 
> 赞同：14
> 
> 时间：2009-05-23T09:32:32.953
> 
> 标签：iphone, sqlite, sql-injection

鉴于声明：

```
const char *sql = "INSERT INTO FooTable (barStr) VALUES (?)"; 
```

以下使用`sqlite3_bind_text`（及相关`sqlite3_bind_*`函数）是否足以防止 SQL 注入攻击？

```
sqlite3 *db; 
sqlite3_stmt *dbps;

int dbrc = sqlite3_open([dbFilePath UTF8String], &db); 
if (dbrc) { 
    // handle error
    return; 
} 

dbrc = sqlite3_prepare_v2 (db, sql, -1, &dbps, NULL);

sqlite3_bind_text(dbps, 1, [userContent UTF8String], -1, SQLITE_TRANSIENT);

dbrc = sqlite3_step(dbps);
if (SQLITE_DONE != dbrc) {
    // handle error
}

sqlite3_finalize (dbps); 
sqlite3_close(db); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-23T10:22:26.080

是的，如果您只将用户提供的数据传递给 sqlite3_bind_* 函数，那么您可以免受 SQL 注入攻击（这些攻击假定您动态构建查询字符串并且不正确引用/转义用户提供的数据）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-04T11:09:36.957

[这个答案](https://stackoverflow.com/questions/52786834/scripts-in-sql-are-compiled-or-executed)在 SQL 服务器运行 SQL 查询之前告诉了相同的过程。

`sqlite3_prepare_v2`应该将 SQL 查询编译成某种 AST，用绑定数据（整数、浮点数、文本、日期等）替换占位符。

并且由于查询已经被编译成 AST，所以查询的结构在数据绑定之前就已经确定了。绑定数据时，SQL 服务器将用户内容视为纯数据，只需将占位符 AST 节点替换为它即可。结果，SQL 将按照程序员的预期执行。

# c++ - 为什么 STL 头文件没有扩展名？

> ID：901216
> 
> 赞同：13
> 
> 时间：2009-05-23T09:34:36.787
> 
> 标签：c++, stl, standards

我有这个基本的疑问。STL 标头没有`.h`扩展名。

```
#include <vector>
#include <map> 
```

这背后有什么具体原因吗？谁知道这背后的历史，请分享。

**编辑**：

> @GMan 找到 了解决这个问题[的 Michael Burr 的答案。](https://stackoverflow.com/questions/441568/when-can-you-omit-the-file-extension-in-an-include-directive/441683#441683)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-23T09:51:54.380

*   #include 指令不区分文件类型（它只是一个美化的复制粘贴操作） - 不会自动添加 .h。
*   提供的 C++ 标准头文件不带 .h 扩展名
*   有时向后兼容的头文件由供应商提供，名称相同，并添加了 .h 扩展名

这一切都与命名空间有关。C++ 标准头文件的 .h 对应项通常#includes 正确的 C++ 标准头文件（没有 .h 扩展名），然后发出一堆 using（类似这样）：

文件：iostream.h

```
#include <iostream>

using std::iostream;
using std::ostream;
using std::ios;
... 
```

而没有 .h 扩展名的头文件不会用所有定义的类和类型污染命名空间。

# java - 在 Java 中没有焦点的情况下监听输入

> ID：901224
> 
> 赞同：25
> 
> 时间：2009-05-23T09:44:37.187
> 
> 标签：java, keylistener

我正在使用 Robot 类在 Java 中制作一个小程序。程序接管鼠标。在调试过程中，如果它开始以我不希望的方式运行，则很难退出程序，因为我无法将鼠标移到 Eclipse 中的终止按钮，也无法使用热键点击它是因为鼠标在另一个窗口中不断单击，而是给该窗口焦点。

我想做的只是连接一个按键监听器，这样当我点击 q 时我可以退出程序，但我知道如何做到这一点的唯一方法是制作一个窗口，并且该窗口需要焦点来捕获输入。有没有办法从任何地方监听键盘或鼠标输入，而不管焦点是什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-10-20T17:59:17.637

有一个库可以为您完成艰苦的工作： [https ://github.com/kwhat/jnativehook](https://github.com/kwhat/jnativehook)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-24T19:05:20.467

这不是一个微不足道的问题，Java 并没有给你一种优雅的方法。您可以使用类似 banjollity 建议的解决方案，但如果您错误的鼠标点击打开另一个当前在任务栏中打开的全尺寸窗口，即使这样也不会一直有效。

事实是，默认情况下，Java 几乎没有给开发人员对操作系统的控制权。这是由于两个主要原因：安全性（正如 java 文档所引用的那样）以及不同的操作系统处理事件完全不同的事实，并且使用一个统一的模型来表示所有这些可能没有多大意义。

所以为了回答你的问题，我想你想要的是你的程序的某种行为，它在全球范围内监听按键，而不仅仅是在你的应用程序中。像这样的事情将要求您访问您选择的操作系统提供的功能，并且要在 Java 中访问它，您将需要通过 Java 本机接口 (JNI) 层来完成它。

所以你想做的是：

1.  如果此操作系统是 Windows，则在 C 中实现一个程序，该程序将侦听您的操作系统上的全局按键，而不是在 Windows 挂钩上查找文档，该文档由 Microsoft 和 MSDN 在 web 和其他地方很好地记录。如果您的操作系统是 Linux 或 Mac OS X，那么您将需要使用 X11 开发库来监听全局按键。这可以根据我在[http://ubuntuforums.org/showthread.php?t=864566上写的 Howto 在 ubunutu linux 发行版上完成](http://ubuntuforums.org/showthread.php?t=864566)

2.  通过 JNI 将 C 代码连接到 Java 代码。这一步实际上是更容易的一步。遵循我在教程中使用的过程[http://ubuntuforums.org/showthread.php?t=864566](http://ubuntuforums.org/showthread.php?t=864566)在 windows 和 linux 下，因为将 C 代码连接到 Java 代码的过程在两个操作系统上都是相同的。

要记住的重要一点是，如果您首先编写和调试您的 C/C++ 代码并确保它正常工作，那么让您的 JNI 代码工作起来会容易得多。然后将它与 Java 集成很容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-05T21:10:01.870

有同样的问题。就我而言，机器人只控制了一个已最大化的 Windows 应用程序。我将这些行放在驱动机器人的主循环的顶部：

颜色 iconCenterColor = new Color(255,0,0); // 如果程序图标是红色的

if (iconCenterColor.equals(robot.getPixelColor(10,15))) throw new IllegalStateException("机器人没有与正确的应用程序交互。");

要取消机器人，只需 alt-tab 到另一个应用程序。非常适合一个简单的应用程序驾驶机器人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T21:17:51.557

从终端中的命令行启动程序并使用 Ctrl-C 终止它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T21:32:32.933

让您的程序打开第二个窗口，该窗口显示在主窗口下方但已最大化，然后您的错误鼠标点击将全部被最大化的窗口接收，并且它可以接收您的键盘输入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-05T15:16:34.460

这是解决您所描述的问题的纯 Java 方法（不是 KeyListener 问题......使用机器人问题时尽早退出测试）：

在整个测试过程中，将鼠标位置与您的测试最近设置的位置进行比较。如果不匹配，请退出测试。注意：此代码的**重要**部分是`testPosition`方法。这是我最近使用的代码：

```
public void testSomething() throws Exception {
    try {
        // snip

        // you can even extract this into a method "clickAndTest" or something
        robot.mouseMove(x2, y2);
        click();
        testPosition(x2, y2);

        // snip
    } catch (ExitEarlyException e) {
        // handle early exit
    }
}

private static void click() throws InterruptedException {
    r.mousePress(InputEvent.BUTTON1_DOWN_MASK);
    Thread.sleep(30 + rand.nextInt(50));
    r.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);
    Thread.sleep(30 + rand.nextInt(50));
}

private static void testPosition(int x2, int y2) throws ExitEarlyException {
    Point p = MouseInfo.getPointerInfo().getLocation();
    if(p.x != x2 || p.y != y2) throw new ExitEarlyException();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-20T03:27:25.670

（正如[@MasterID](https://stackoverflow.com/a/19480853/14731257)提到的，并在[JNativeHook 的](https://github.com/kwhat/jnativehook/blob/2.2/doc/Keyboard.md)本地键盘输入检测文档中显示 { [main GitHub project here](https://github.com/kwhat/jnativehook) }），

此代码应该足以在**没有应用程序焦点（按下和/或释放）的情况下收听任何键**：

***>>记得在你的项目中添加 jnativehook 库，以便能够使用它的所有实用程序。<<***

```
public class yourClass implements NativeKeyListener {//<-- Remember to add the jnativehook library

public void nativeKeyPressed(NativeKeyEvent e) {
    System.out.println("Key Pressed: " + NativeKeyEvent.getKeyText(e.getKeyCode()));
}

public void nativeKeyReleased(NativeKeyEvent e) {
        System.out.println("Key Released: " + NativeKeyEvent.getKeyText(e.getKeyCode()));
}

public void nativeKeyTyped(NativeKeyEvent e) {
        System.out.println("Key Typed: " + NativeKeyEvent.getKeyText(e.getKeyCode()));
}

public static void main(String args[]){
    //Just put this into your main:
    try {
        GlobalScreen.registerNativeHook();
    }
    catch (NativeHookException ex) {
        System.err.println("There was a problem registering the native hook.");
        System.err.println(ex.getMessage());
        System.exit(1);
    }

    GlobalScreen.addNativeKeyListener(new yourClass());
    //Remember to include this^                     ^- Your class
}
} 
```

**对于这个特殊的问题**，使用 nativeKeyPressed 方法，如下所示：

```
public void nativeKeyPressed(NativeKeyEvent e) {
    System.out.println("Key Pressed: " + NativeKeyEvent.getKeyText(e.getKeyCode()));
    if (e.getKeyCode() == NativeKeyEvent.VC_Q){
        System.exit(1);
    }
} 
```

请注意，**默认情况下，JNativeHook 在您的控制台中显示了很多您可能不想要的东西**，要更改它，只需在您在 main 函数中使用的 try-catch 之前添加它，如图所示（*这也将关闭警告和错误消息，更多信息[在这里](https://github.com/kwhat/jnativehook/blob/2.2/doc/ConsoleOutput.md)*）：

```
//(From here)
Logger logger = Logger.getLogger(GlobalScreen.class.getPackage().getName());
logger.setLevel(Level.OFF);
logger.setUseParentHandlers(false);
//(To there-^)
try {
    GlobalScreen.registerNativeHook();
}
catch (NativeHookException ex) {
    System.err.println("There was a problem registering the native hook.");
    System.err.println(ex.getMessage());
    System.exit(1);
} 
```

免责声明：*我知道这个问题在几年前就已经解决了，我只是希望有人发现这个问题更容易找到/使用。*

# silverlight - 使用 Silverlight 和 DeepZoom 的良好示例网站？

> ID：901225
> 
> 赞同：4
> 
> 时间：2009-05-23T09:45:14.300
> 
> 标签：silverlight, deepzoom

我目前正在考虑在未来的项目中使用 Silverlight 和 Deepzoom。谁能推荐一些充分利用这些技术的网站？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T10:46:14.613

*   [花花公子档案](http://playboy.covertocover.com/)( [NSFW](http://en.wikipedia.org/wiki/Not_safe_for_work) )
*   [硬石纪念品](http://memorabilia.hardrock.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T10:02:36.543

上周我看到了一个即将上线的网站的精彩演示： [Deep Zoom 中的拉斐尔前收藏](http://www.preraphaelites.org/personal-collections/zoom/37/exceptional-colour/)

基本上它是英国博物馆的整个拉斐尔前派目录——你可以浏览收藏，然后选择图像进行深度缩放，这样你就可以看到各个笔触——真的很有效。

[这是主页的链接](http://www.preraphaelites.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-19T20:41:34.277

您需要查看shoothill 的演示，他们有一些惊人的深度变焦。[http://www.shoothill.com](http://www.shoothill.com)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T09:52:35.063

Microsot Silverlight 网站的[展示部分](http://silverlight.net/Showcase/)有一些使用 DeepZoom 的 Silverlight 应用程序的精彩演示。只需在搜索框中输入“DeepZoom”，它就会出现许多结果。

以下是从那里选择的一些：

*   [照片蒙太奇](http://www.butterworth.me.uk/clientbin/deepzoom.htm)
*   [自行车“配置器”](http://www.faltundklapprad.de/silverlight.aspx)
*   [鸟瞰图](http://app.colaab.com/R/2171fed2-f060-4c2b-b187-9bc10095ec9f)
*   [汽车图片](http://www.laguna-coupe.com/silverlight)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-11T23:57:01.167

[http://www2.advertiser.com.au/uniquelyrundlemall](http://www2.advertiser.com.au/uniquelyrundlemall)

圣诞礼物指南网站

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-29T00:08:00.427

MGM 使用 Silverlight Deep Zoom 和 Photosynth 创建 Stargate Destiny App。您可以在此处阅读有关制作的信息[http://www.microsoft.com/casestudies/Case_Study_Detail.aspx?casestudyid=4000005102](http://www.microsoft.com/casestudies/Case_Study_Detail.aspx?casestudyid=4000005102)并在 stargate.mgm.com 上使用该应用程序

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T04:09:00.997

BestBuy 商店定位器使用 silverenlightenment.com 上的 Virtual Earth 帖子

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-24T06:52:19.833

我不了解 Deepzoom，但我知道儿童网站[Shidonni](http://www2.shidonni.com/)非常成功地使用了 Silverlight。

奥里

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-25T10:55:15.670

两个类似 HardRock 的 DeepZoom 系列

*   [墨尔本一级方程式](http://www.theage.com.au/interactive/2009/sport/f1/silverlight.html)
*   [狂欢节（悉尼）](http://www.smh.com.au/interactive/2009/mardigras/silverlight.html)

商业应用：

*   [凯利蓝皮书](http://www.kbb.com/KBB/PerfectCarFinder/PhotoEdition.aspx)（汽车查找器）

带有 DeepZoom 的标记照片示例

*   [不丹的照片](http://deepzoompublisher.com/ClientBin/DeepZoomMetadataTestPageRC0.html)

以及带有 DeepZoom的**GPS标记照片示例**

*   [世界各地的城市](http://conceptdevelopment.net/Silverlight/DeepZoomPublisher04/Default.html)使用虚拟地球（[操作方法](http://conceptdev.blogspot.com/2009/03/silverlight-virtualearth-map-control_23.html)）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-21T00:47:01.947

抱歉回复晚了。这是我工作的一个

[http://sites.tepapa.govt.nz/tepapawall/](http://sites.tepapa.govt.nz/tepapawall/)

# wpf - WPF 从列表框中拖动元素

> ID：901236
> 
> 赞同：2
> 
> 时间：2009-05-23T09:53:13.237
> 
> 标签：wpf, drag-and-drop

在我的 WPF 应用程序中，我有一个列表框，其中 DataTemplate 定义如下：

```
 <DataTemplate x:Key="ListBoxTemplate">
            <ui:TaskMonthPreview/>
 </DataTemplate> 
```

TaskMonthPreview 是我的自定义控件，定义如下：

```
<UserControl x:Class="Lista.TaskMonthPreview"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="30" Width="100">

    <UserControl.Resources>
        <ResourceDictionary>
            <ControlTemplate x:Key="TaskView" TargetType="Thumb">

                <Rectangle
                Name="rectangle1" 
                Stroke="Chocolate" 
                HorizontalAlignment="Left" 
                Width="{TemplateBinding Width}" 
                Height="{TemplateBinding Height}" 
                Fill="LightSkyBlue"/>

            </ControlTemplate>
        </ResourceDictionary>
    </UserControl.Resources>

        <Thumb Name="myThumb"  Background="Blue" 
          Width="100" Height="20" DragDelta="onDragDelta" 
          DragStarted="onDragStarted" DragCompleted="onDragCompleted" HorizontalAlignment="Left"
          Template="{StaticResource TaskView}"/>

</UserControl> 
```

我在 TaskMonthPreview 中的拇指是可拖动的，但不幸的是它不能被拖动到 TaskMonthPreview 区域之外。是否可以在 TaskMonthPreview 范围之外甚至在列表框范围之外拖动我的拇指？

# android - Android - 使用 runOnUiThread 从线程进行 UI 更改

> ID：901239
> 
> 赞同：24
> 
> 时间：2009-05-23T09:55:05.137
> 
> 标签：android

我正在使用自定义标题视图，并希望在线程工作时在标题视图中显示/隐藏进度条。

这是我的标题视图的 XML

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
>
    <Button
        android:id="@+id/image_left_btn"
        android:layout_width="75dip" 
        android:layout_height="wrap_content" 
        android:text="Back"
    />
    <TextView
        android:id="@+id/image_title_text"
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content" 
        android:layout_weight="1"
        android:textSize="20dip"
        android:textStyle="bold"
        android:textColor="#fff"
        android:layout_gravity="center"
        android:gravity="center"
        android:paddingLeft="8dip"
        android:paddingRight="8dip"
    />
    <ProgressBar 
        android:id="@+android:id/progress_small_title"
        style="?android:attr/progressBarStyleSmall"
        android:layout_width="75dip"
        android:layout_height="wrap_content" 
        android:paddingRight="8dip"/>
</LinearLayout> 
```

在我的活动中，将其设置为自定义标题栏后，我这样做

```
titleProgress = (ProgressBar)findViewById(R.id.progress_small_title);
titleProgress.setVisibility(View.INVISIBLE); 
```

其中 titleProgress 是 ProgressBar 对象。

这就是我在我的线程中所做的

```
runOnUiThread(new Runnable() {
    public void run() {
        titleProgress.setVisibility(View.VISIBLE);
    }
});
//long operation here
runOnUiThread(new Runnable() {
    public void run() {
        titleProgress.setVisibility(View.INVISIBLE);
    }
}); 
```

但是进度条没有变化。它从不显示。有人可以告诉我代码有什么问题吗？

是否可以在自定义标题中显示标题进度条？

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-09-22T22:34:26.850

几件事要尝试：

1）（这可能不是）确保“ `titleProgress`”是易变的。

2）尝试扔几个`postInvalidate()`或`titleProgress.postInvalidate()`在那里触发重绘。

3) 你有没有在一个类似于巨型绿色机器人的祭坛上牺牲了一台 x486 机器？（只是在开玩笑）

让我知道前两个（如果你真的很绝望，第三个）是否能帮助你。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-09-22T22:25:28.363

在这种情况下您应该使用的是 AsyncTask，请参阅 [http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

如果您的目标不是 1.5 之前的 Android 版本，则必须使用另一个名为 UserTask 的类。见[http://android-developers.blogspot.com/2009/05/painless-threading.html](http://android-developers.blogspot.com/2009/05/painless-threading.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-02-18T17:46:04.040

使用与处理程序的通信，

1.  执行你的线程
2.  into `run()`：您应该向 Handler 发送一条消息，该消息将更新 progressBar（当然是水平的）：`handler.sendMessage(handler.obtainMessage());`
3.  在您的活动中，您应该覆盖该方法`handleMessage(Message msg )`：像这样

    ```
    handler = new Handler(){
      @override
      public void handleMessage(Message msg ) 
      {
        //here you write the code which will update your progressBar 
      }
    }; 
    ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-29T10:13:53.950

你的布局正确吗？您是否尝试过首先使用垂直布局来实现此功能？只是想在您开始活动时查看进度条是否可见？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-05T10:39:10.723

尝试将 ProgressBar 的样式更改为水平：

```
style="?android:attr/progressBarStyleHorizontal" 
```

原本的

```
style="?android:attr/progressBarStyleSmall" 
```

给出一个在标题栏中无法完全看到的圆形“进度条”。

# xml - 为什么 Eclipse 不能解析 spring-dwr 模式？

> ID：901242
> 
> 赞同：12
> 
> 时间：2009-05-23T09:56:38.270
> 
> 标签：xml, eclipse, spring, schema, dwr

*Eclipse 在我的 Spring 的applicationContext.xml*中显示以下错误：

```
cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 'dwr:configuration'.   myappservlet-servlet.xml    MyApp/src/main/webapp/WEB-INF   line 23 XML Problem
cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 'dwr:controller'.  myappservlet-servlet.xml    MyApp/src/main/webapp/WEB-INF   line 21 XML Problem
cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 'dwr:remote'.  myappservlet-servlet.xml    MyApp/src/main/webapp/WEB-INF   line 41 XML Problem 
```

当我将鼠标悬停在订单项错误上时，它还会显示：

```
 - schema_reference.4: Failed to read schema document 'http://www.directwebremoting.org/
 schema/spring-dwr-3.0.xsd', because 1) could not find the document; 2) the document could not be 
 read; 3) the root element of the document is not <xsd:schema>. 
```

我确认根元素实际上是*<xsd:schema>*。当我通过键入*<dwr:*使用自动完成功能时， Eclipse 正确地向我显示了各种选项，例如*<dwr:configuration>*、*<dwr:controller>*等。Eclipse 如何在不阅读架构的情况下知道这一点？

我毫无问题地使用了许多不同的名称空间；DWR 模式是唯一未解决的模式。这是声明：

```
<?xml version="1.0" encoding="utf-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:dwr="http://www.directwebremoting.org/schema/spring-dwr"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
              http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
              http://www.springframework.org/schema/aop 
              http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
              http://www.springframework.org/schema/context
              http://www.springframework.org/schema/context/spring-context-2.5.xsd
              http://www.directwebremoting.org/schema/spring-dwr
              http://www.directwebremoting.org/schema/spring-dwr-3.0.xsd"
    default-autowire="byName"> 
```

我的类路径中有最新的 DWR 3.0.0.116.rc1。如果我打开 DWR jar，我会发现*META-INF/spring.handlers*包含：

```
http\://www.directwebremoting.org/schema/spring-dwr=org.directwebremoting.spring.DwrAnnotationNamespaceHandler 
```

和*META-INF/spring.schemas*包含：

```
http\://www.directwebremoting.org/schema/spring-dwr-2.0.xsd=org/directwebremoting/spring/spring-dwr-2.0.xsd
http\://www.directwebremoting.org/schema/spring-dwr-3.0.xsd=org/directwebremoting/spring/spring-dwr-3.0.xsd 
```

冒号的逃逸让我有点失望，但我认为这一切都是正确的，否则每个人的 DWR 都会被破坏。

在我从 DWR 网站实时获取此特定模式之前，但当我的生产系统因 DWR 网站关闭而崩溃时，我被此所困扰。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-07-02T15:23:16.557

您可以尝试将用户指定的目录贡献添加到 Eclipse。在**Window->Preferences->XML->XML Catalog**下选择**User Specified Entries**，然后选择**Add**按钮。

然后，您可以添加架构的详细信息（如果连接断开，您可以在本地复制文件）。然后，Eclipse 将在验证期间访问该模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T15:58:33.577

我不确定你的问题是什么。您似乎在最后一段中自己回答了这个问题 - DWR 站点出现故障，Eclipse 中的模式验证失败。请注意，Eclipse（即使使用 Spring IDE 插件）不使用 META-INF/spring.schemas 来解析名称空间，这是由 Eclipse 平台完成的。如果在架构位置找不到架构，则会收到这些错误。

至于自动完成，如果 Eclipse 找不到模式，它仍然会通过从文档中的现有结构推断来提供这一点。

这不是应用程序本身的问题，因为 Spring 将使用 META-INF/spring.schemas 文件来解析 JAR 中的模式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-23T03:13:04.707

这是脱机使用 Eclipse 时的常见问题。它试图从网上获取模式。当它找不到它时，它表示验证错误。

我只是忽略这些错误。当您重新联机时，清理项目，它们就会消失。

# javascript - 在不使用服务器端语言的情况下获取状态代码（也许是 javascript？）

> ID：901244
> 
> 赞同：2
> 
> 时间：2009-05-23T09:58:02.900
> 
> 标签：javascript, status, http-status-codes

我创建了一项服务，通过复制/粘贴到错误页面模板（例如 Google Analytics）的代码片段来帮助处理 Web 应用程序中的错误页面。状态代码设置为安装代码中的隐藏输入。问题是我不希望安装代码依赖于服务器端语言（例如 PHP、Ruby）——但应用程序可以真的、真的使用动态方法来收集 http 请求中的状态码，而无需硬编码状态代码，因此，每个错误页面都需要单独的安装代码（虽然，我们实际上只查看 500 和 404；但就我而言，一个选项太多了）。

对 Google 和我的开发者朋友进行测验表明，通过 javascript 获取状态代码是不可能的（不过，我们正在以这种方式获取 http_referer），但我想知道是否有人有任何我尚未遇到的建议。 ..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-22T18:11:37.777

**无法从 HTML 页面或 JavaScript 函数中访问 HTTP 状态代码。**XMLHttpRequest 可以访问它，因为它知道它自己创建的 Http 请求。它首先是 HTTP 连接的发起者。但是您要运行的 JavaScript 代码包含在已经加载的页面中。

顺便说一句，这无论如何都会混合层（例如传输层和应用层）。例如，由于您可以从文件系统加载 .html 页面 - 在这种情况下 HTTP 状态代码是什么？或者，如果您从 FTP 服务器或 SVN 存储库访问 HTML 页面，HTTP 状态代码是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T20:10:05.470

使用 XmlHttpRequest，您可以只检索位于服务器上的文本/纯文本文件的内容，该文件将独立于您使用的服务器语言。

这可以是一个文本文件，其值由逗号或分号分隔，一旦请求完成，您将对其进行拆分。

注意：您必须使用 XmlHttpRequest 的 responseText 属性。

希望我足够清楚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-22T17:53:04.483

据我所知，没有办法使用嵌入在该页面上的代码来确定页面本身的状态代码。（对 URL 的 Ajax 请求将返回状态代码，因此理论上您可以向您所在的页面发出 Ajax 请求（即请求两次），但如果您需要在每个页面加载时都这样做，那就有点古怪了...)

我认为唯一的解决方案是按照您的建议进行操作并修改您的服务器端 404、500 等处理程序以将有关状态代码的信息嵌入页面本身（例如`<script>document.status = "404";</script>`），然后您可以使用 JavaScript 提取这些信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T19:21:33.687

尼尔。

这里有一些代码来澄清。

```
function createXhrObject()
{
    if (window.XMLHttpRequest)
        return new XMLHttpRequest();

    if (window.ActiveXObject)
    {
        var names = [
            "Msxml2.XMLHTTP.6.0",
            "Msxml2.XMLHTTP.3.0",
            "Msxml2.XMLHTTP",
            "Microsoft.XMLHTTP"
        ];
        for(var i in names)
        {
            try{ return new ActiveXObject(names[i]); }
            catch(e){}
        }
    }
    return null; // not supported
}
xhr = createXhrObject();

xhr.onreadystatechange = function() 
{
    if(xhr.readyState == 4 && xhr.status == 200) 
    {
        document.getElementById('your_hidden_input').value = xhr.responseText;
    } 
}

xhr.open('GET', 'your_text_file.txt', true); 
xhr.send(null); 
```

# actionscript-3 - 从子类调用超类中的函数

> ID：901246
> 
> 赞同：1
> 
> 时间：2009-05-23T10:00:44.347
> 
> 标签：actionscript-3, class, subclass

我在 Actionscript 3 中有一个小项目，如果可以从子类调用超类中的代码，一切都会变得容易得多。

这是项目：

汽车游戏
        车

是否可以从 Car 类调用 CarGame 类中的函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T10:08:59.430

你会用*super*声明来称呼他们。

如：

```
super.someFunction(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T10:08:22.223

见[`super`](http://livedocs.adobe.com/flex/3/langref/statements.html#super)声明。

# asp.net-mvc - 将 asp.net MVC 从 Beta 升级到 1.0 版

> ID：901247
> 
> 赞同：2
> 
> 时间：2009-05-23T10:01:58.960
> 
> 标签：asp.net-mvc, updatemodel

a）目前我在 asp.mvc beta 上实时部署了一个应用程序......但几天前它拒绝使用以下错误：

找不到方法：'System.String System.Web.Mvc.Html.LinkExtensions.RouteLink（System.Web.Mvc.HtmlHelper，System.String，System.Web.Routing.RouteValueDictionary，System.Web.Routing.RouteValueDictionary）'。

版本信息：Microsoft .NET Framework 版本：2.0.50727.3053；ASP.NET 版本：2.0.50727.3053

搜索结果并没有给我相关的东西:(

b）我的下一步是将应用程序升级到 asp.net mvc 1.0 ...但这里我有一个新问题：如果在测试版中我有：

```
[AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Edit(FormCollection entityform)
    {
        var entity = repository.GetById(1);

        UpdateModel(entity, entityform);
        repository.Update(entity);

        return View("Index", entity);

    } 
```

那么现在 UpdateModel(map, "/ 接受 IValueProvider 或 DefaultValueProvider /");

问题：

1.  这里发生了什么变化？（我想hostng环境已经改变了一些东西）
2.  我应该在这里调整什么以不破坏已经实现的功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T10:28:13.543

```
UpdateModel(entity, entityform.ToValueProvider()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T13:21:55.983

a) 当我升级我的 web 项目时，我注意到 web.configs 中包含的内容不同。请注意，在主项目目录和视图中都有 2 个 web.config。我建议创建一个新的 MVC 1.0 项目并将 web.configs 与您的 beta 版本进行比较。

b）我只是使用 UpdateModel 传入实体，如果您已将 FormCollection 传递给 ActionResult，这将相应地更新它。

```
public ActionResult Edit(FormCollection entityform)
{
    var entity = repository.GetById(1);
    更新模型（实体）；

```

# java - 使用黑莓使用 AES/CBC/PKCS5Padding 解密数据

> ID：901251
> 
> 赞同：5
> 
> 时间：2009-05-23T10:08:38.370
> 
> 标签：java, blackberry, encryption

我在java中使用AES/CBC/PKCS5Padding密码实例进行AES加密和解密如何在java中使用上面加密的黑莓解密数据。

使用黑莓使用 AES/CBC/PKCS5Padding 解密数据

谢谢巴皮

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-25T02:25:14.027

我建议使用 BlackBerry API（Bouncy Castle 可以，但为什么要让事情复杂化呢？）。

使用 net.rim.crypto 包 - 您使用的是所有对称加密，因此您只需要标准[RIM 签名密钥](https://www.blackberry.com/SignedKeys/)即可在设备上运行（20 美元和 2-3 天即可获得） - 同时您可以做任何事情用模拟器。

基本上，您需要创建一个包装 CBCDecryptorEngine 的 PKCS5UnformatterEngine，该 CBCDecryptorEngine 包装了 AESDecryptorEngine。可能将所有内容都包装在 BlockDecryptor 中，这样您就可以像在 InputStream 中一样对待它。类似的东西（自从我这样做以来已经有一段时间了，所以它可能无法按所写的 100% 工作）：

```
InputStream encryptedInput;  // if you have a byte[] of data, use a ByteArrayInputStream
AESKey key = new AESKey(<your key data as a byte[]>) 
InitializationVector iv = new InitializationVector(<your iv data as a byte[]>) // of course you need to know your IV since you're doing CBC encryption

BlockDecryptor decryptor = new BlockDecryptor(
   new PKCS5UnformatterEngine(
      new CBCDecryptorEngine(
         new AESDecryptorEngine(key),
         iv
      )
   )
);

// then decryptor acts as an InputStream which gives you your decrypted, unpacked data

decryptor.read(buffer); // buffer will contain decrypted, unpacked data 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T14:16:58.283

我认为[Bouncy Castle Library](http://www.bouncycastle.org/java.html)支持这一点。他们也提供了一些简短的教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T14:28:26.483

充气城堡有一个很棒的图书馆可以做到这一点。主要问题是如何以安全的方式获取密钥。我发现 .NET 和 Java 以不兼容的方式序列化密钥，所以为了安全起见，我最终在双方都使用了 Bouncy Castle 以促进密钥传输，因为它是使用 RSA 传输的。

# wpf - 用于 Web 服务调用的 WPF ProgressBar

> ID：901259
> 
> 赞同：1
> 
> 时间：2009-05-23T10:20:16.303
> 
> 标签：wpf, web-services, progress-bar

是否可以显示 ProgressBar 来显示 Web 服务调用的进度？我正在使用一个 web 服务，它调用一个 SQL 数据库并根据需要返回一个请求数据的列表。

网络服务代码

```
 public List<LocationUpdate> GetAllLocationsByUserID(int UserID)
    {
        MainframeConnectionDataContext db = new MainframeConnectionDataContext();
        var validLocations = from query in db.LocationUpdates select query;
        return validLocations.ToList();
    } 
```

客户代码

```
 void Window1_Loaded(object sender, RoutedEventArgs e)
    {
        dg_sql_data.ItemsSource = CMainFrameConnection.GetAllLocationsByUserID(0);
    } 
```

目前加载数据大约需要 5-10 秒。

有任何想法吗？

*   雷特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T10:24:26.997

进度条在这里可能不合适，因为您可能无法判断操作完成了多远。显示某种“加载”动画可能更合适。

例如，您可以在此处使用一些示例动画[http://www.ajaxload.info/](http://www.ajaxload.info/)

编辑：正如 Dreas 指出的那样，设置[IsIndeterminate](http://msdn.microsoft.com/en-us/library/system.windows.controls.progressbar.isindeterminate.aspx)是处理此问题的好方法。

# .net - 在 .NET 中设计选项/设置表单

> ID：901266
> 
> 赞同：1
> 
> 时间：2009-05-23T10:24:59.960
> 
> 标签：.net, winforms, settings, usability, options

我有一个应用程序，在不同类别中有大约 35~ 种不同的设置。

将其公开给客户的最佳实践是什么。

其次，是否有任何 VS.NET 附加组件或库（*商业或非商业*）可以帮助加快此过程。也许像“Property Grid”这样的东西，但具有更专业和用户友好的外观。

*所有设置都基于一个类和几个子类。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T10:27:45.320

您是否查看过 Visual Studio 本身实现的设计，它是类别的树视图和在选择每个类别时更新的面板？

我无法在 Code Project 上找到任何示例（我可能在搜索错误的术语），但我发现[本教程](http://www.differentpla.net/content/2004/10/implementing-a-paged-options-dialog)将引导您完成三种不同的可视化。它的日期为 2004 年，因此可能会有更新的页面，但这将是一个很好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T16:42:52.907

对于只有 35 个选项，我认为标准选项卡式选项对话框可以正常工作。这是一个熟悉的界面，即使是新手用户也能理解。

但是，对于具有许多选项的应用程序，这种类型的界面开始出现故障。您最终会在每个选项卡上看到太多选项卡或太多混乱。对于大量选项，Word 2007 中的选项屏幕稍好一些。它本质上是一个选项卡式界面，但选项卡位于左侧而不是顶部，右侧区域是可滚动的。您要小心地将最重要的选项“放在首位”，以免它们迷路。此外，拥有“热门”标签也是一个好主意。

如果您预计您的选项数量会增加，您可能需要考虑使用 Office 2007 样式的选项屏幕。

# php - getimagesize() 不适用于大图像 (640k+)

> ID：901267
> 
> 赞同：2
> 
> 时间：2009-05-23T10:25:07.417
> 
> 标签：php, image-processing, gd

我正在使用 PHPs GD 扩展来处理 jpg 图像。

我`getimagesize()`用来获取图像的宽度和高度。

它在本地以及我的一台远程服务器上都可以正常工作，但在我的另一台远程服务器上却不行。这个问题似乎出现在相对较大的图像（大约 640k 和更大）上。`getimagesize()`适用于较小的图像。

有没有人遇到过这样的问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T10:33:22.783

我很确定您需要增加 PHP 的内存限制，最初尝试将其加倍以查看是否可以修复它。您可以在 .htaccess 中执行此操作（如果您使用的是 apache）：

```
php_value memory_limit 16M 
```

您也可以在脚本中进行设置：

```
ini_set('memory_limit', '16M'); 
```

将此行添加到您的脚本中，以查看 GD 给您的错误：

```
error_reporting(E_ALL); 
```

# jquery - 我可以使用 jQuery 从 MySql 数据库中获取记录吗？

> ID：901272
> 
> 赞同：3
> 
> 时间：2009-05-23T10:29:26.723
> 
> 标签：jquery

有可能吗，我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T10:32:50.723

是的，但是有 ajax 帮助和服务器端脚本。jquery 和 JS 不支持 MySQL 连接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T11:49:08.573

简短的回答：

不，你不能开箱即用。JavaScript 代码在浏览器中运行，服务器上的 MySQL 数据库。Browser-Javascript 不能直接在服务器上运行任何代码（pfewww！:)。

长答案：

一些 Web-Development-Frameworks 在 json 中以明确定义（有时是 RESTful）的方式公开底层数据库结构：

如果是 Ruby on Rails 中的假设模型“用户”：

作为 GET 请求发出时的所有用户列表。当作为 POST 发布时，创建一个新用户。

```
/users.json 
```

当作为 GET 请求发出时，返回数据库 ID 为 1 的用户。当作为 PUT-Request 发出时，使用 database-id 1 更新用户。当作为 DELETE 请求发出时删除对象。

```
/users/1.json 
```

返回的 json 代码（JavaScript 对象表示法）可以很容易地在 JavaScript 中使用 eval() 进行解析。所以这是一种使用 jQuery 以半直接方式访问数据库的方法:)

希望这可以帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T10:32:58.337

不是直接的，但您可以使用 Ajax 从由服务器端语言生成的页面中获取内容。[以下是如何将 Ajax 与 jQuery 一起使用](http://docs.jquery.com/Ajax)。

# css - 如何在 detailsview 数据行中选择第二个 td？

> ID：901273
> 
> 赞同：30
> 
> 时间：2009-05-23T10:30:27.577
> 
> 标签：css, detailsview

我正在尝试创建一个新的 CSS 来塑造我的详细信息视图。但我无法在 detailsviews 字段行中达到第二个 td。你知道访问 2nd td 吗？

但请想象一下由 detailsview 生成的 belov 代码。

```
<table>
<thead>
...
</thead>

<tbody>
    <tr>
        <td>Name</td>
        <td><input type='text' id='txtName' /></td>
    </tr>
</tbody>
</table> 
```

* * *

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-05-23T10:38:26.500

第一个问题是：你需要支持IE6吗？如果答案是肯定的，那么你不能这样做。如果不是最简单的解决方案可能是：

```
td + td { ... } 
```

更现代（且支持较少）的是：

```
td:nth-child(2) { ... } 
```

这假设您不愿意或不能在第二个 td 上放置类或其他标识符，以便您可以更轻松地完成它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-23T10:47:47.247

我建议不要选择一个恰好是连续第二个的字段。更好的方法是将有意义的 css 类分配给字段并选择这些：

```
<head>
  <style type="text/css" media="screen">
    td.form-value {
      background-color:red;
    }
  </style>
</head>
<tr>
  <td class="form-label">
    Label:
  </td>
  <td class="form-value">
    ...
  </td>
</tr> 
```

# c++ - ref 到 TBuf 的转换

> ID：901279
> 
> 赞同：2
> 
> 时间：2009-05-23T10:34:53.810
> 
> 标签：c++, symbian

我正在使用 CRSAKeypair 类，它返回长格式的公钥和私钥，我希望它转换为 TBuf 格式我应该如何继续。我已经尝试过创建指针但仍然没有运气..还有其他方法吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T09:51:08.517

如果您使用 CRSAKeypair，您可能下载了 Symbian 密码库及其文档。

诚然，文档并不明确，但我敢冒昧地说，您可以将模数和指数组件发送到任何其他 RSA 引擎，以重构公钥。您正在寻找的方法可能是：

CRSAParameters::N();
CRSAPublicKey::E();
TInteger::BufferLC();

请记住，带有尾随“C”的方法会将它们返回的内容推送到清理堆栈中，因此您需要自己弹出它。

如果您需要更好地理解描述符以将 HBufC8* 转换为 TBuf，我建议您花一些时间在[http://descriptors.blogspot.com](http://descriptors.blogspot.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T11:10:36.420

您也许可以使用[TASN1DecRSAPublicKey](http://library.forum.nokia.com/index.jsp?topic=/S60_5th_Edition_Cpp_Developers_Library/GUID-35228542-8C95-4849-A73F-2B4F082F0C44/sdk/doc_source/reference/reference-cpp/Certificate_and_Key_Management/TASN1DecRSAKeyPairClass.html)和[TASN1EncRSAPublicKey](http://library.forum.nokia.com/index.jsp?topic=/S60_5th_Edition_Cpp_Developers_Library/GUID-35228542-8C95-4849-A73F-2B4F082F0C44/sdk/doc_source/reference/reference-cpp/Certificate_and_Key_Management/TASN1DecRSAKeyPairClass.html)类来执行类似的操作，但除此之外，很抱歉我无能为力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-22T15:11:28.493

好吧，首先创建您的 TBuf8，其数据长度如下：

```
TUint length = sizeof(myLong);
TBuf<length> myLongBuf; 
```

然后也许正在寻找其中一些描述符函数来将数据复制到描述符中？

```
TDes::Num(TInt64) 
```

将 64 位有符号整数转换为十进制字符表示并将转换复制到此描述符中，替换任何现有数据

```
TDes::Num(TReal,const TRealFormat &) 
```

将指定的浮点数转换为字符表示并将转换复制到此描述符中，替换任何现有数据

```
TDes::Num(TUint64,TRadix) 
```

将指定的 64 位无符号整数转换为基于指定数字系统的字符表示，并将转换复制到此描述符中，替换任何现有数据

```
TDes::NumFixedWidth(TUint,TRadix,TInt) 
```

根据指定的数字系统将指定的无符号整数转换为固定宽度的字符表示，并将转换复制到此描述符中，替换任何现有数据

```
TDes::NumFixedWidthUC(TUint,TRadix,TInt) 
```

根据指定的数字系统将指定的无符号整数转换为固定宽度的字符表示，并将转换复制到此描述符中，替换任何现有数据

```
TDes::NumUC(TUint64,TRadix) 
```

将指定的 64 位无符号整数转换为基于指定数字系统的字符表示，并将转换复制到此描述符中，替换任何现有数据

# ruby-on-rails - 优化 Ruby on Rails 项目

> ID：901281
> 
> 赞同：1
> 
> 时间：2009-05-23T10:35:57.817
> 
> 标签：ruby-on-rails, optimization, yaml

我正忙着创建一个非常简单的*ruby​​ on rails*应用程序，它不需要很多默认情况下加载到 ruby​​ on rails 环境中的东西。

我不会使用**mysql**，只是一个从 Yaml 文件中获取数据的模型。所以我想我不需要**ActiveRecord**，或者至少不需要很大一部分。（如果我在这里错了，请纠正我）；

如何从我的应用程序中清除所有不需要的东西。
（就像阻止**应用程序**在 /config/database.yml 中查找我不需要的配置）

而且，当我全部完成后，我如何确定哪些东西已加载但不需要？示例：**ActionMailer**。

谢谢，
史蒂夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T10:51:28.207

在您的 environment.rb - 文件中：

```
 # Skip frameworks you're not going to use. To use Rails without a database,
 # you must remove the Active Record framework.
 config.frameworks -= [ :active_record, :active_resource, :action_mailer ] 
```

# java - 什么是 Java 等价于 webmin？

> ID：901286
> 
> 赞同：2
> 
> 时间：2009-05-23T10:42:50.627
> 
> 标签：java, linux, apache, configuration, frameworks

[webmin](http://www.webmin.com/)是一个用于配置软件的管理/UI 框架。我很好奇是否有人知道 Java 等价物可能是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T11:06:26.350

因为没有“java 操作系统”，所以很难找到一个完全等价的。

检查和配置*单个 JVM*的好工具是 JMX 协议及其客户端[visualvm](https://visualvm.dev.java.net/)和[Jconsole](http://java.sun.com/j2se/1.5.0/docs/guide/management/jconsole.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T11:00:18.047

根据定义，Webmin 看起来完全依赖于平台（至少对于 Unix 系统而言）。Java 等价物毫无意义——当然，您可以用 Java 编写这样的工具，但它不可移植，并且可能需要大量非 Java 代码才能访问特定于平台的 API

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-08T21:27:59.967

webmin 是用 perl 编写的，虽然它可以在比 Java 更多的平台上使用，但实际上它的可移植性并不高。而且几乎所有这些都基于管理文本文件和已知的 Unix 命令，所有这些都可以通过 Java 实现。

我一直在努力思考如何启动这样的项目——微软世界有许多工具可以让管理系统集群变得容易，但 Unix 世界却不是这样。cfengine 很好，但很笨拙。我想要可以从一个控制台管理我的整个网络的 webmin。我认为与 OpenNMS 集成的东西会是一个不错的起点。

但简短的回答是没有 Java 版本的 webmin。

# scripting - 黑莓开发脚本语言？

> ID：901287
> 
> 赞同：3
> 
> 时间：2009-05-23T10:44:31.573
> 
> 标签：scripting, blackberry, tcl, tkinter, hecl

据我所见，开发 Blackberry 应用程序的首选方法是 Java。这是*唯一*的方法吗？

我梦想有一个快速的应用程序环境，您可以在其中创建 GUI（使用 Blackberry UI 组件）。

类似于 Blackberry 上的 Tcl/Tk 端口……或 Python/Tkinter……或新的，但类似的东西。

存在这样的东西吗？（我对此表示怀疑）

*这样的东西可以存在吗*？*（即，给定钱，是否可行/合理/...）*

 ** * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T06:09:14.883

是的，它确实存在。使用 Visual Studio BlackBerry 插件 ( [http://na.blackberry.com/eng/developers/rapidappdev/vsplugin.jsp](http://na.blackberry.com/eng/developers/rapidappdev/vsplugin.jsp) )，然后您将获得您梦寐以求的 GUI。

唯一的缺点（无论如何对我来说）是您编写代码的语言是 JavaScript。好处是您可以使用一个非常丰富的框架，它为您提供了 BlackBerry OS 中许多功能的包装器。

此外，您可以直接从任何 Web 服务中获得非常好的数据绑定支持，如果您走 Java 之路，这并非易事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T13:32:31.597

如果你可以使用 Java/J2ME，你总是可以使用 Hecl：[www.hecl.org](http://www.hecl.org)

编辑 - 截至 2009 年夏末，我已经开始为 Hecl 开发官方 BlackBerry 端口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T10:51:15.850

不，没有。

Blackberry 让您可以在三种不同的开发环境之间进行选择。

*   浏览器
*   MDS 运行时
*   最后但并非最不重要的 Java 开发

看一下 Research in Motion 的这个视频

[介绍黑莓开发](http://www.blackberry.com/DevMediaLibrary/view.do?name=IntroBlackBerryDev)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-30T16:39:29.783

对于 J2ME/CLDC ，至少有两种[Lua实现。](http://www.lua.org/)我个人可以确认至少 Kahlua 可以在 BlackBerry 上运行：

[http://code.google.com/p/kahlua/](http://code.google.com/p/kahlua/)

[http://code.google.com/p/mochalua/](http://code.google.com/p/mochalua/)

# php - Zend 框架内的 inet_pton() 调用问题

> ID：901294
> 
> 赞同：1
> 
> 时间：2009-05-23T10:46:26.157
> 
> 标签：php, api, zend-framework, youtube

我在使用 Zend 框架（用于 YouTube 数据 API）时遇到问题。我创建了一个非常简单的 PHP 脚本，用于使用这个 API 上传 YT 视频，它几乎可以在任何地方工作——我在 3 台不同的机器（Linux 和 WinXP）上进行了尝试。但是在将它安装到第四台机器之后，我得到了这个错误：

```
Error:  inet_pton() [function.inet-pton]: Unrecognized address www.google.com    
Error type/ Nr.:    Warning - 2  
File:   /Zend/Validate/Ip.php    
Line:   62   
Line 62 source:  } else if ((@inet_pton($value) === false) ||(inet_ntop(@inet_pton($value)) !== $valueString)) { 
```

我很确定这一定是一些配置缺陷，但有什么问题？（PHP 脚本在所有实例上都完全相同）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T23:34:41.423

在第 62 行和第 65 行之间修改 /library/Zend/Validate/Ip.php，如：

```
} else if ((@inet_pton(gethostbyname($value)) === false) 
|| (inet_ntop(@inet_pton(gethostbyname($value))) !== $valueString)) {
        $this->_error();
        return false;
    } 
```

$value 必须是 IP 地址而不是主机名。

# entity-framework - 有人在生产中使用 POCO Adapter for Entity Framework 吗？

> ID：901295
> 
> 赞同：3
> 
> 时间：2009-05-23T10:46:30.353
> 
> 标签：entity-framework, architecture, poco

阅读有关实体框架中缺乏持久性无知的信息时，我经常偶然发现[POCO Adapter](http://blogs.msdn.com/jkowalski/archive/2008/09/09/persistence-ignorance-poco-adapter-for-entity-framework-v1.aspx)。问题是，有没有人在生产中使用它，它是如何进行的，有什么陷阱？

我考虑了应用程序设计的两种选择：在业务逻辑中使用带有该适配器的 POCO，并让表示层使用它们或创建在 EF 实体和 DTO 之间转换的服务层：(1) EF 实体 <-> 适配器 <-> POCO 业务对象 <-> 表示或 (2) EF 实体 <-> 服务层 <-> DTO <-> 表示。第一种方法似乎更干净，但我有点犹豫 POCO Adapter 不是非常标准的解决方案，并且可能包含一些目前不明显的缺点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T18:21:35.957

EFPocoAdapter 已被弃用，取而代之的是 Entity Framework 4.0。[Beta 版](http://blogs.msdn.com/adonet/archive/2009/05/20/entity-framework-4-0-beta-1-bits-now-available-in-the-vs-2010-and-net-4-beta-1.aspx)发布不到一周，如果您是 MSDN 订阅者，您已经可以下载 Beta 1 。

没有理由再使用 EFPocoAdapter。我还鼓励您阅读 ADO.NET Entity Framework [Design Team 博客](http://blogs.msdn.com/adonet/archive/2009/05/21/poco-in-the-entity-framework-part-1-the-experience.aspx)以获取 EF 4.0 上所有功能的列表，这是一本极好的阅读材料。

另请查看此博客文章：[实体框架中的 POCO：第 1 部分 - 体验](http://blogs.msdn.com/adonet/archive/2009/05/21/poco-in-the-entity-framework-part-1-the-experience.aspx)。

至于我使用 EFPocoAdapter 的经验，我对 POCO、延迟加载和 n 层场景的支持感到满意。Entity Framework 通过提供 T4 模板以及其他东西进一步构建了这一点，这是我真正感到缺乏的东西（尽管许多人更喜欢手动编码他们的 POCO 类）。我遇到的其他问题是JavaScriptSerializer 的[序列化程序问题](http://aleembawany.com/2009/05/22/json-serializers-in-net/)，它不处理循环引用，而 DataContractSerializer 需要在 T4 模板之前使用自动生成的类无法实现的类/成员属性。

EFPocoAdapter 始终旨在成为一种从社区获得反馈并为 EF 4.0 开发功能集的暂存平台。虽然边缘有点粗糙，但我确实设法满足了我的要求，尽管在与 Jaroslaw 进行了几次交流之后。那和支持非常惨淡（论坛上的人很少或堆栈溢出）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T13:58:13.803

您可能想使用[AutoMapper](http://www.codeplex.com/AutoMapper/)。然后，如果需要，您可以编写 EF 实体、POCO 实体和 DTO-s。两组实体似乎有点开销，但是当您需要对持久性无知时，这似乎是使用 AutoMapper 最简单的方法。

[AutoMapper 简介](http://dimecasts.net/Casts/CastDetails/111)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-20T03:52:59.790

我只想在这个线程中添加我一直在使用 Entity Framework v4 和 POCO 模型，该模型是在生产中使用 C# POCO 生成器生成的（大约六个月），它运行良好。

但是，将它们与 WCF 服务一起使用时有[一些](http://www.sanderstechnology.com/?p=10142)问题，因此如果您正在考虑通过 WCF 公开它们，则可能值得将它们放在一起进行合理的概念证明，并查看对象图的复杂性是否会给无状态的序列化带来任何问题用法等

# javascript - 像在 Gmail 中一样上传文件

> ID：901301
> 
> 赞同：-1
> 
> 时间：2009-05-23T10:51:57.440
> 
> 标签：javascript, jquery, file-upload

> **可能重复：**
> [使用 jQuery 上传 Gmail 之类的文件](https://stackoverflow.com/questions/710852/gmail-like-file-upload-with-jquery)

我正在学习 JQuery，想知道是否有任何方法可以实现类似于 GMail 中使用 JQuery 的附件（在撰写邮件时）的文件上传功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T21:02:52.273

GMail 使用 Flash 在后台上传文件。[SWFUpload](http://swfupload.org/)是一个开源项目，它遇到了一些类似的事情。

# windows - 在win7中删除旧的PostgreSQL数据目录

> ID：901302
> 
> 赞同：1
> 
> 时间：2009-05-23T10:52:12.027
> 
> 标签：windows, postgresql, acl

我无法在 Windows 7 中删除我的旧数据目录。我已经卸载了 PostgreSQL，但仍然有系统服务用户帐户“postgres”，他是唯一一个对该文件夹具有访问权限的用户。

可能的解决方案是开发一个服务，以“postgres”用户身份运行，删除文件夹，但必须有更简单的方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-30T18:42:30.893

这很简单。只需以管理员身份打开命令提示符，然后键入

```
net user 
```

然后按回车键，您将在您的操作系统中看到用户帐户。您还会注意到那里列出的 postgres。要删除它，请键入以下内容：-

```
net user postgres /del 
```

和回车键。瞧，你完成了。只是为了确保一切都已完全完成，请检查 C: 驱动器中的“USERS”文件夹，或任何相关的文件夹，并删除名为“postgres”的文件夹（如果存在）。完毕！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T11:09:09.917

我没有使用过 Windows 7，但如果我没记错的话，应该有一种方法可以在 Postgres 用户下启动资源管理器会话（文件管理器，而不是 IE），然后将其删除。

否则，您可以通过以管理员身份登录，为管理员添加修改该目录和父目录的权限，然后您应该能够将其删除。

我不确定管理员是否可以直接删除目录，但应该可以添加权限来执行此操作。

**更新**：我刚刚安装了 PostgreSQL 并在 Vista 中对其进行了测试，它可能在 Windows 7 中工作相同。似乎他们已经修复了权限的东西，所以上面的提示不起作用（更改权限）。

但是，如果系统帐户仍然存在，您可以在计算机管理中访问它。将其添加到常规用户组（如用户或管理员），然后您应该能够使用它登录，然后删除目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T11:15:02.667

作为管理员获取相关目录的所有权 - 在 Windows 资源管理器中 - 右键单击​​它，“属性”、“安全”、“高级”、“所有者”，然后从“将所有者更改为”下的列表中选择您的帐户. 然后删除它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-08T01:07:58.133

您也必须删除该用户。

打开命令行并输入 net user "login of the user" /delete

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-14T13:37:09.867

帖子有点旧，但如果我的意图与我的意图相同（删除“postgres”帐户），解决方案可能是这样的：

1.  以*管理员*身份打开**cmd**
**   运行命令：`net user postgres /delete`*

 *# windows - 检索网络共享评论

> ID：901303
> 
> 赞同：0
> 
> 时间：2009-05-23T10:52:32.540
> 
> 标签：windows, winapi, networking

如何在 Windows 中检索网络共享评论？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T10:55:38.823

找到它 NetShareGetInfo。

# .net - 根据可用宽度和字体计算文本高度？

> ID：901304
> 
> 赞同：16
> 
> 时间：2009-05-23T10:53:51.710
> 
> 标签：.net, formatting, pdfsharp

我们正在使用[PDFsharp](http://www.pdfsharp.net/)从数据库中即时创建 PDF 文档。

我需要知道根据使用的字体和可用宽度计算文本区域高度的最佳方法。

我需要知道高度，以便在需要时处理分页符。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-08-24T16:16:36.893

PdfSharp.Drawing.XGraphics 对象有一个 MeasureString 方法，可以返回您需要的内容。

```
 var pdfDoc = new PdfSharp.Pdf.PdfDocument();
 var pdfPage = pdfDoc.AddPage();
 var pdfGfx = PdfSharp.Drawing.XGraphics.FromPdfPage(pdfPage);
 var pdfFont = new PdfSharp.Drawing.XFont("Helvetica", 20);

 while (pdfGfx.MeasureString("Hello World!").Width > pdfPage.Width)
      --pdfFont.Size;

 pdfGfx.DrawString("Hello World!", pdfFont
      , PdfSharp.Drawing.XBrushes.Black
      , new PdfSharp.Drawing.XPoint(100, 100)); 
```

这应该可以帮助你。请考虑到我没有测试这段代码，因为我是为了提供帮助而即时编写的。它可能包含一些编译时错误，但您可能会明白。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-08-25T11:07:20.603

> 在 .NET 中，您可以调用 Graphics.MeasureString 来确定绘制文本的大小。

对，但是当使用 PDFsharp 时，您调用 XGraphics.MeasureString。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-04-03T11:42:08.240

我有一个类似的问题，所以我实现了这个扩展方法：

```
public static double MeasureHeight(this PdfSharp.Drawing.XGraphics gfx, string text, PdfSharp.Drawing.XFont font, int width)
{
    var lines = text.Split('\n');

    double totalHeight = 0;

    foreach (string line in lines)
    {
        var size = gfx.MeasureString(line, font);
        double height = size.Height + (size.Height * Math.Floor(size.Width / width));

        totalHeight += height;
    }

    return totalHeight;
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-24T05:56:22.303

在 .NET 中，您可以调用[Graphics.MeasureString](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.measurestring.aspx)来确定绘制文本的大小。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-10-11T10:01:58.267

我为 XGraphic 对象编写了一个小的扩展方法来做到这一点：通过指定 maxWidth 来计算确切的文本高度（和宽度）。有关代码，请参阅以下要点：[https ://gist.github.com/erichillah/d198f4a1c9e8f7df0739b955b245512a](https://gist.github.com/erichillah/d198f4a1c9e8f7df0739b955b245512a)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-07T16:40:26.853

OP询问如何根据*可用宽度*和字体计算文本高度。Windows .NET 为此提供了一个 API 调用，它接受一个宽度参数；我正在使用的 PDFsharp 版本（0.9.653，.NET 1.1）没有。

我的解决方案 - 使用 .NET API 调用和为自定义创建的 Bitmap 对象分配的 Graphics 对象来获得答案。

对我有用的是使用具有 100 DPI 分辨率（关键）并且恰好是肖像页面大小（可能不太关键）的位图。

然后我只是问.NET 在该位图上绘制的像素大小是多少。

然后，您可能希望将单位从 1/100 英寸转换为点（对于 PDFsharp）。

```
''' 改编代码 - 这未经测试甚至编译 - 警告 Emptor！
''' 目标：Visual Basic、.NET 1.1 (VS2003) [根据需要调整]

'''''''''''''''''''
' GraphicsAlt.MeasureString() 的作用与 System.Drawing MeasureString(...,Integer) 的作用基本相同。
'''''''''''''''''''
公共模块 GraphicsAlt

    '
    ' 静态数据仅用于计算下面的 MeasureString()。
    '
    ' 缓存这两个对象的单个副本，以解决其他无法解释的间歇性异常。
    '
    私人共享 myImage 作为位图 = 无
    私人共享 myGraphics 作为图形 = 没有

    公共共享函数 GetMeasureGraphics() 作为图形
        如果 myImage 什么都不是，那么
            myImage = New Bitmap(1700, 2200) '' ... 指定 8.5x11
            myImage.SetResolution(100, 100) '' ... 和 100 DPI（如果你想要不同的单位，你可以改变这个）
            myGraphics = Graphics.FromImage(myImage)
        万一
        返回我的图形
    结束功能

    '给定 1/100TH 英寸最大宽度，返回 Rect 以保持单位 1/100TH 英寸
    '
    公共函数 MeasureString(ByVal text As String, ByVal aFont As System.Drawing.Font, ByVal width As Integer) As System.Drawing.SizeF
        返回 (GraphicsAlt.GetMeasureGraphics()).MeasureString(text, aFont, width)
    结束功能

端模块

```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-18T09:26:17.130

如果有人仍然想找到答案，我已经实现了一个相当容易理解的方法来找出结果文本的高度。

```
Public Function PrintString(text As String, ft As XFont, rect As XRect, graph As XGraphics, b As SolidBrush, Optional tf As XTextFormatter = Nothing) As Integer
    If Not IsNothing(tf) Then
        tf.DrawString(text, ft, b, rect)
    Else
        Dim drawLeft As New XStringFormat
        drawLeft.Alignment = XStringAlignment.Near

        graph.DrawString(text, ft, b, rect, drawLeft)
    End If

    Dim width As Double = graph.MeasureString(text, ft).Width
    Dim multiplier As Integer = 0

    While width > 0
        multiplier += 1

        width -= rect.Width
    End While

    Dim height As Double = (graph.MeasureString(text, ft).Height) * multiplier
    Return height
End Function 
```

解释代码：

首先，打印文本。我包含了一个名为 tf 的可选 XTextFormatter，因为我在我的应用程序中可以互换使用 XGraphics 或 XTextFormatters。

然后，通过 MeasureString().Width 计算文本的长度。

然后，计算有多少行文本。这是通过将之前找到的文本的总长度除以提供的打印税款的矩形（框）的宽度来完成的。我在这里使用了一个while循环。

将文本的高度（使用 graph.MeasureString().Height）乘以行数。这是文本的最终高度。

返回高度值。现在，调用 PrintString() 函数将打印提供的文本，然后返回打印文本的高度。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-17T20:15:43.693

PDFsharp 包含一个类 XTextFormatter，可用于绘制带有换行符的文本。

但是它无法确定文本所需的高度。受@Wakka02 评论的启发，我改进了这个类，生成了 XTextFormatterEx 类。
我认为它也回答了原始问题，因此我发布了答案。
我知道这是一个老问题，答案可能对 OP 没有帮助，但这是一个常见问题，答案可能对其他人有帮助。

新类有 500 行代码——我认为这对于这篇文章来说太多了。

源代码可以在 PDFsharp 论坛上找到：http:
[//forum.pdfsharp.net/viewtopic.php?p =9213#p9213](http://forum.pdfsharp.net/viewtopic.php?p=9213#p9213)

它也可以在我不起眼的博客中找到：http:
[//developer.th-soft.com/developer/pdfsharp-improving-the-xtextformatter-class-measuring-the-height-of-the-text/](http://developer.th-soft.com/developer/pdfsharp-improving-the-xtextformatter-class-measuring-the-height-of-the-text/)

使用新类时，您可以先调用`PrepareDrawString`以了解文本适合多少以及适合文本的高度。然后您的解码器可以绘制准备好的文本或准备另一个文本或准备具有不同矩形的相同文本。

我的新课程：XTextFormatterEx tf = new XTextFormatterEx(gfx); int lastCharIndex; 双倍需要高度；

```
// Draw the text in a box with the optimal height
// (magic: we know that one page is enough).
XRect rect = new XRect(40, 100, 250, double.MaxValue);
//tf.Alignment = ParagraphAlignment.Left;
tf.PrepareDrawString(text, font, rect,
                     out lastCharIndex, out neededHeight);
rect = new XRect(40, 100, 250, neededHeight);
gfx.DrawRectangle(XBrushes.SeaShell, rect);
// Both variants should look the same.

// Optimized version: draw the prepared string.
tf.DrawString(XBrushes.Black, XStringFormats.TopLeft); 
```

准备文本会多次调用 MeasureString。稍后无需再次调用 MeasureString 即可绘制准备好的文本。

截至今天（2015 年 7 月 17 日），XTextFormatterEx 类（与原来的 XTextFormatter 一样）使用 XFont 类的内部字段。这需要在编译类时进行特殊处理。在下载了 PDFsharp 1.32 的完整源包后，我决定将我的 XTextFormatterEx 类复制到 PDFsharp 文件夹中。
任何试图修改 XTextFormatter 或 XTextFormatterEx 类的人都将面临同样的问题。
我希望这个问题将在 PDFsharp 的未来版本中得到解决，允许将这些类的修改版本包含在应用程序项目中。

# iphone - 是否有任何工具或好的技术可以找出 iPhone 应用程序的性能瓶颈在哪里？

> ID：901308
> 
> 赞同：-1
> 
> 时间：2009-05-23T10:56:58.117
> 
> 标签：iphone, cocoa-touch, uikit, core-animation

我有一个应用程序已经完成了一半。性能不是很好，不知道瓶颈在哪里。虽然我可以继续注释掉可疑的代码行，但我想知道是否有任何工具可以告诉我哪种方法很酷需要多长时间以及接下来会发生什么。堆栈跟踪并没有那么有用。

我有一个奇怪的想法，将堆栈跟踪转换为 GraphViz 图，以直观地查看整个画面。我知道 IBM 的一些人做了类似的事情，生成了堆栈跟踪的可视化图表，这非常令人印象深刻和有意义。在我重新发明轮子之前：是否有一些好的工具或技术可以帮助发现 iPhone OS 的性能瓶颈？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T13:48:35.837

正如 Kenneth 所说，[Instruments](http://www.apple.com/macosx/developertools/instruments.html)是 Cocoa 应用程序性能优化的宝贵工具。它的用户指南可以在[这里](http://developer.apple.com/documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/index.html)找到（或者在你的 Xcode 文档中）。Xcode 调试工具的一大优点是它们可以针对在设备上执行的应用程序运行，因此您可以使用 Instruments 在实际硬件上对应用程序进行分析。

在使用 Instruments 时，我发现 CPU Sampler 工具可以很好地细分我的应用程序花费最多时间的地方。例如，当我运行 Instruments 并发现它实际上是由于一些浪费的字符串处理例程时，我有一个我认为是缓慢的 SQLite 查询，并且正准备优化我所有的 SQLite 交互。

您也可以使用[Shark](http://developer.apple.com/tools/sharkoptimize.html)进行分析，尽管它不那么容易使用。

您可能还对以下问题的答案感兴趣：

*   [“为了优化目的，我如何分析一段代码在 Objective-C/Cocoa 中执行所需的时间”](https://stackoverflow.com/questions/206574/how-do-i-profile-how-long-a-piece-of-code-takes-to-execute-in-objective-c-cocoa-f)
*   [“如何减少典型 iPhone 应用程序的启动时间？”](https://stackoverflow.com/questions/406015/how-to-reduce-the-startup-time-for-a-typical-iphone-app)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T13:13:23.507

使用 Instruments（开发人员工具附带的应用程序）附加到流程并测量性能。

有一个名为“核心动画”的预设，这可能是您想要的。

iPhone 开发者门户网站上有一个关于 Instruments 的教程视频： [http://developer.apple.com/codingheadstarts/index.html](http://developer.apple.com/codingheadstarts/index.html)

# xml - 在 vim 中编辑长行的 xml 文件真的很慢。我能做些什么来解决这个问题？

> ID：901313
> 
> 赞同：50
> 
> 时间：2009-05-23T10:59:17.037
> 
> 标签：xml, vim, performance

我用 vim 编辑了很多 xml 文件。问题是，由于行长，vim 中的导航/编辑非常慢。有什么我可以做的（除了关闭语法突出显示/文件类型插件和文件类型缩进之外）能够编辑这些文件而没有所有滞后？

vim 对语法高亮等琐碎的事情处理得如此糟糕，这真是令人沮丧。我不记得这是任何其他编辑器的问题。我真的很喜欢使用 vim，我希望有一些方法可以解决这个问题。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2010-08-11T17:00:46.200

问题是 VIM 语法高亮对于长行来说很慢。一个只会稍微降低功能的简单解决方法是将语法突出显示限制为前 x 列。像这样的东西在你的`.vimrc`：

```
set synmaxcol=120 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-03-06T16:24:51.993

现在是 2014 年，我使用的是 Vim 7.4 版。语法高亮和长行组合仍然会导致 vim 运行缓慢。由于这是 Google 返回的第一个响应，我想放弃我的“当前”解决方案。

*   我发现在加载有问题的文件后简单地打开和关闭你的语法可以让 vim 以可接受的速度运行。为方便起见，您可以绑定它

    `:syntax off` `:syntax on`

    或绑定它：`nnoremap <leader>ts :syntax off<cr>:syntax on<cr>`

*   我还发现采购我的 .vimrc 会产生相同的结果

    `:source $MYVIMRC`

    和强制性地图：`nnoremap <leader>sv :source $MYVIMRC<cr>`

编辑---- 2014 年 7 月 31 日

进一步的探索使我将语法限制为最大列。这工作得很好，自从我将以下内容添加到我的 vimrc 以来，我没有遇到任何问题。

```
set synmaxcol=250 
```

这将语法慷慨地限制为前 250 列。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-08-29T16:36:53.323

```
:set nocursorline 
```

应该有帮助。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-23T11:18:54.250

您是否禁用了换行？根据我的经验，在处理很长的行时，换行会降低 vim 的速度。

```
set nowrap 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-23T11:10:38.307

如何漂亮地打印您的 XML 文件（如果行长是真正的问题）？您可以这样做，例如使用`xmllint`Gnome libxml2 包的一部分（并且还有一个适用于 Windows 的版本）。

您可以通过执行就地漂亮打印

```
xmllint --format -o xmlFile.xml xmlFile.xml 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-07-31T16:12:14.610

我发现的最简单和最有效的解决方案是简单地禁用语法突出显示：
`syntax off`

这似乎是处理长线时的罪魁祸首。此外，根据我对 vim 和 xml 的经验，文件的大小似乎并不重要——导致这些减速的是长行。

我发现另一个有用的解决方法是用长线[折叠](http://vim.wikia.com/wiki/Folding)区域：

```
 <!--{{{ long lines -->
  <text>A reeealy long line</text>
  <!--}}}--> 
```

关闭折叠将使 vim 无需解析这些行的语法。当然，这种方法并不总是实用的，但在我只有几行长行或者它们位于文件的特定区域的情况下，它工作得很好。

通常，Vim 仍然明显较慢，但在大多数情况下，性能变得可以接受。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-23T11:02:40.930

没有。这是语法高亮认为，AFAIK。Vim 使用的正则表达式方法实际上并不是编辑 xml 文件的最佳解决方案。

（当然，您可以随时尝试编写自己的 xml 语法文件，希望您能做得更好）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-23T20:03:15.547

有一个插件，[LargeFile](http://www.vim.org/scripts/script.php?script_id=1506)用于这项工作。它禁用了一些事件、语法高亮甚至撤消。您没有提到 XML 文件的大小，但插件是可配置的。您可以以兆字节为单位设置“大文件”的大小，以便可以正常处理“不大的文件”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-23T11:32:15.940

我经常用 >\r< -> 替换 >< `:s/>\s*</>\r</g`，然后用 .reindent 整个文件`gg=G`。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-10-22T23:32:15.717

注释掉该行

```
syn sync match xmlSyncDT grouphere  xmlDocType +\_.\(<!DOCTYPE\)\@=+ 
```

在您的 xml.vim 文件中（带有`"`）。

这种问题可以在 vim 会话中通过键入 来调试`:syntime on`，做一些展示关注缓慢的事情，然后`:syntime report`. 就我而言，它报告`xmlSyncDT`在我的 6MB xml 文件中花费了 10 多秒，其中包含 4000 个字符的行，只是为了显示文件的最后一页。据我所知，注释掉上面的行并没有影响语法突出显示，只是现在显示屏幕的时间永远不会超过几分之一秒。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-02-08T15:17:04.793

添加到 vimrc 文件

```
nmap <leader>x <Esc>:set filetype=xml<CR>:%s/></>\r</g<CR><ESC>gg=G<Esc>:noh<CR> 
```

然后按 x 将自动漂亮地打印 xml 文件。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-07-18T15:31:46.330

您可以将此功能添加到您的 .vimrc 以重新格式化您的 xml 文件并希望减少行长。

```
function! DoPrettyXML()
  " save the filetype so we can restore it later
  let l:origft = &ft
  set ft=
  " delete the xml header if it exists. This will
  " permit us to surround the document with fake tags
  " without creating invalid xml.
  1s/<?xml .*?>//e
  " insert fake tags around the entire document.
  " This will permit us to pretty-format excerpts of
  " XML that may contain multiple top-level elements.
  0put ='<PrettyXML>'
  $put ='</PrettyXML>'
  silent %!xmllint --format -
  " xmllint will insert an <?xml?> header. it's easy enough to delete
  " if you don't want it.
  " delete the fake tags
  2d
  $d
  " restore the 'normal' indentation, which is one extra level
  " too deep due to the extra tags we wrapped around the document.
  silent %<
  " back to home
  1
  " restore the filetype
  exe "set ft=" . l:origft
endfunction

command! PrettyXML call DoPrettyXML() 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-10-05T23:09:31.243

它是由 vim 中的长行解析引起的。我终于发现，如果我从我`.vimrc`的 中删除以下内容，问题就解决了：

```
filetype indent plugin on 
```

`:filetype indent plugin off`请注意，如果您在编辑带有长行的文件时输入，则它不起作用。

# mysql - PHP值不会超过127

> ID：901315
> 
> 赞同：2
> 
> 时间：2009-05-23T10:59:50.607
> 
> 标签：mysql, types, range

这是我表单上的部分代码：

```
<br><input type="checkbox" checked="yes" name="country[]" value="1" />Asia/Pacific Region
<br><input type="checkbox" checked="yes" name="country[]" value="2" />Europe
<br><input type="checkbox" checked="yes" name="country[]" value="3" />Andorra
...
<br><input type="checkbox" checked="yes" name="country[]" value="250" />Jersey
<br><input type="checkbox" checked="yes" name="country[]" value="251" />Saint Barthelemy
<br><input type="checkbox" checked="yes" name="country[]" value="252" />Saint Martin 
```

这是我的php代码：

```
$country=$_POST['country'];
...
foreach ($country as $country) {
    $sql="INSERT INTO sites_countries (siteID, country) VALUES ('$id', '$country')";
    # execute SQL command
    if (!mysql_query($sql,$con)) {
        die('Error: ' . mysql_error());
    }
} 
```

但我查看了我的数据库，它似乎只能达到 127，然后 $country 总是 127

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T11:05:11.003

如果字段“country”被定义为带符号的 tinyint，最大值为 127。
请参阅[http://dev.mysql.com/doc/refman/5.0/en/numeric-types.html](http://dev.mysql.com/doc/refman/5.0/en/numeric-types.html)

编辑：即使您的 MySQL 服务器允许您插入超出范围的数据，您也可以获得有关截断的信息，例如

```
SHOW WARNINGS
```

这将导致类似

```
“级别”；“代码”；“消息”
"警告";"1264";"第 1 行的列 'i' 的值超出范围"
```

如果任何数据超出范围，您还可以将服务器置于严格模式并得到错误。
见[http://dev.mysql.com/doc/refman/5.0/en/server-sql-mode.html](http://dev.mysql.com/doc/refman/5.0/en/server-sql-mode.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T11:08:08.530

请检查您所在国家/地区的数据列类型。如果此列是 tinyint，请检查它是否为“无符号”。

有符号的 tinyint 被限制为 -127/127

[http://dev.mysql.com/doc/refman/5.0/en/numeric-types.html](http://dev.mysql.com/doc/refman/5.0/en/numeric-types.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T11:08:56.067

我们需要查看您的 SQL DDL 语句才能解决这个问题。最可能的原因是您的数据库中的数据类型范围太小，无法处理大于 127 的数字。

执行以下语句：

```
SHOW CREATE TABLE sites_countries; 
```

在这里发布结果。

# c# - 苹果 Ipod 和 C#

> ID：901319
> 
> 赞同：2
> 
> 时间：2009-05-23T11:01:17.610
> 
> 标签：c#, .net, ipod

用 C# 阅读 ipod 歌曲的最佳方式是什么。我正在考虑为 ipod 做一个接口作为测试:)

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-23T08:28:22.087

这个问题出现在谷歌搜索中，但我找到的第一个合理答案花了一段时间：

[SharePod](http://www.getsharepod.com/)有一个用于 iPod 访问的 .Net (2.0) 库，显然支持所有最新的 iPod 和 iPhone（我没有亲自测试过）：

[http://www.getsharepod.com/fordevelopers/](http://www.getsharepod.com/fordevelopers/)

它对非商业用途是免费的，而且对于许可使用来说似乎很便宜（目前 99 美元）

希望这对某人有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T11:50:59.100

这个问题有点模糊，所以我将根据我能看到的解释它的方式来回答。

我不能谈论当前一代（Touch）设备，因为它们已经改变了一些东西，但我知道在此之前歌曲存储在 iPod_Control 目录中。这些文件是名称-magled，因此为了读取诸如曲目和艺术家姓名之类的信息，必须从声音文件本身的 udata 原子中提取它。

iTunes 和 iPod 将 MPEG-4 AAC 音频用于声音文件，因此播放它们涉及从声音文件的数据原子中提取此数据并将其传递给功能强大的渲染器，例如 iTunes 或 QuckTime，这些渲染器可通过 COM 从托管代码访问。

可以使用 3rd 方库和编解码器在没有 quicktime 或 itunes 的情况下渲染 MP4-AAC，但我还没有探索过。

Apple 最近停止在 iTunes 商店中使用 DRM，但是，如果使用第三方音频库，您在渲染以这种方式加密的音频文件时可能会遇到问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T18:55:16.120

也许我错过了一个主题，但你可以试试[这里](http://www.getsharepod.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T11:21:08.427

一个快速的谷歌搜索给了我：

*   [http://www.kbcafe.com/juice/?guid=20050507072047](http://www.kbcafe.com/juice/?guid=20050507072047)
*   [http://projects.gnome.org/hipo/](http://projects.gnome.org/hipo/)

# c# - HTTPWebResponse + StreamReader 非常慢

> ID：901323
> 
> 赞同：21
> 
> 时间：2009-05-23T11:03:01.710
> 
> 标签：c#, performance, web-crawler, httpwebresponse, streamreader

我正在尝试使用 HttpWebResponse.GetResponse() 和 Streamreader.ReadToEnd() 在 C# 中实现一个有限的网络爬虫（仅适用于几百个站点），还尝试使用 StreamReader.Read() 和一个循环来构建我的 HTML 字符串。

**我只下载大约 5-10K 的页面。**

这一切都非常缓慢！例如，平均 GetResponse() 时间约为半秒，而平均 StreamREader.ReadToEnd() 时间约为 5 秒！

所有站点都应该非常快，因为它们离我的位置非常近，并且拥有快速的服务器。（在 Explorer 中几乎不需要 D/L）而且我没有使用任何代理。

My Crawler 有大约 20 个线程同时从同一站点读取。这会导致问题吗？

如何大幅减少 StreamReader.ReadToEnd 时间？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-12-23T04:30:29.177

HttpWebRequest 可能需要一段时间来检测您的[代理设置](http://msdn.microsoft.com/en-us/library/kd3cf2ex.aspx)。尝试将此添加到您的应用程序配置中：

```
<system.net>
  <defaultProxy enabled="false">
    <proxy/>
    <bypasslist/>
    <module/>
  </defaultProxy>
</system.net> 
```

您还可能会看到缓冲读取以减少对底层操作系统套接字的调用次数会带来轻微的性能提升：

```
using (BufferedStream buffer = new BufferedStream(stream))
{
  using (StreamReader reader = new StreamReader(buffer))
  {
    pageContent = reader.ReadToEnd();
  }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-23T11:31:37.593

WebClient 的 DownloadString 是 HttpWebRequest 的一个简单包装器，您可以暂时尝试使用它，看看速度是否有所提高？如果事情变得更快，您能否分享您的代码，以便我们看看它可能有什么问题？

**编辑：**

似乎 HttpWebRequest 观察到 IE 的“最大并发连接数”设置，这些 URL 是否在同一个域中？您可以尝试增加连接限制，看看是否有帮助？我发现[这篇](http://www.lnbogen.com/CommentView,guid,dba7a00e-808e-4bd7-9dd1-eb028d187db2.aspx)关于这个问题的文章：

> 默认情况下，您不能执行超过 2-3 个异步 HttpWebRequest（取决于操作系统）。为了覆盖它（最简单的方法，恕我直言）不要忘记在应用程序的配置文件的部分下添加它：

```
<system.net>
  <connectionManagement>
     <add address="*" maxconnection="65000" />
  </connectionManagement>
</system.net> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-09-23T12:35:09.237

我有同样的问题，但是当我将 HttpWebRequest 的 Proxy 参数设置为 null 时，它解决了问题。

```
UriBuilder ub = new UriBuilder(url);
HttpWebRequest request = (HttpWebRequest)WebRequest.Create( ub.Uri );
request.Proxy = null;
HttpWebResponse response = (HttpWebResponse)request.GetResponse(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-14T02:03:29.043

您是否尝试过 ServicePointManager.maxConnections？对于与此类似的事情，我通常将其设置为 200。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-21T15:19:34.127

我遇到了同样的问题，但最糟糕的是。响应 = (HttpWebResponse)webRequest.GetResponse(); 在我的代码中延迟了大约 10 秒，然后再运行更多代码，之后下载使我的连接饱和。

库尔特的回答 defaultProxy enabled="false"

解决了这个问题。现在响应几乎是即时的，我可以以我的连接最大速度下载任何 http 文件 :) 抱歉英语不好

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-24T13:37:36.667

我发现Application Config方法不起作用，但问题仍然是由于代理设置造成的。我的简单请求过去最多需要 30 秒，现在需要 1 秒。

```
public string GetWebData()
{
            string DestAddr = "http://mydestination.com";
            System.Net.WebClient myWebClient = new System.Net.WebClient();
            WebProxy myProxy = new WebProxy();
            myProxy.IsBypassed(new Uri(DestAddr));
            myWebClient.Proxy = myProxy;
            return myWebClient.DownloadString(DestAddr);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-08T18:10:47.080

谢谢大家的回答，他们帮助我找到了正确的方向。我遇到了同样的性能问题，尽管更改应用程序配置文件的建议解决方案（据我所知，该解决方案适用于 Web 应用程序）不符合我的需求，我的解决方案如下所示：

```
HttpWebRequest webRequest;

webRequest = (HttpWebRequest)System.Net.WebRequest.Create(fullUrl);
webRequest.Method = WebRequestMethods.Http.Post;

if (useDefaultProxy)
{
    webRequest.Proxy = System.Net.WebRequest.DefaultWebProxy;
    webRequest.Credentials = CredentialCache.DefaultCredentials;
}
else
{
    System.Net.WebRequest.DefaultWebProxy = null;
    webRequest.Proxy = System.Net.WebRequest.DefaultWebProxy;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-31T01:46:52.837

为什么多线程不能解决这个问题？多线程将最大程度地减少网络等待时间，并且由于您将缓冲区的内容存储在系统内存 (RAM) 中，因此处理文件系统不会出现 IO 瓶颈。因此，需要 82 秒下载和解析的 82 个页面应该需要 15 秒（假设是 4x 处理器）。如果我遗漏了什么，请纠正我。

____ 下载主题_____*

下载内容

表单流

阅读内容

_________________________*

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-11-19T10:48:17.510

尝试`AspxAutoDetectCookieSupport=1`像这样将 cookie() 添加到您的请求中

```
request.CookieContainer = new CookieContainer();         
request.CookieContainer.Add(new Cookie("AspxAutoDetectCookieSupport", "1") { Domain = target.Host }); 
```

# linq - 如何按日期过滤 LINQ 查询？

> ID：901332
> 
> 赞同：0
> 
> 时间：2009-05-23T11:08:45.287
> 
> 标签：linq

```
query = query.Where(q => q.Date.ToString().Contains(strDate)); 
```

上述说法不正确。

如果我使用“==”那么它将匹配确切的日期。没关系，但我可以过滤吗，就像我们过滤字符串一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T11:10:54.283

我真的不明白你所说的“过滤器”是什么意思。

您可以执行以下操作：

```
query = query.Where(q => q.Date.Year.Equals(myDate.Year)); 
```

或者

```
query = query.Where(q => q.Date.Day.Equals(myDate.Day)); 
```

如果这就是你所追求的。

当然，您必须将 strDate 转换为 DateTime。如果您真的不想这样做，您还可以将 DB 日期转换为相同格式的字符串：

```
query = query.Where(q => q.Date.ToString("dd-MM-yyyy").Contains(strDate)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T11:12:38.583

假设 q.Date 是 DateTime 的一个实例，我不认为将 DateTime 实例转换为 String 是比较日期的最佳方式。根据对象的属性过滤 DateTime 会更可靠。例如，年、月等...

例如，如果您想过滤 strDate 中的年份，您可以执行以下操作。

```
var d = DateTime.Parse(strDate);
query = query.Where(q => q.Date.Year == d.Year); 
```

您能否通过详细说明 strDate 将包含哪些类型的值来为我们提供更多背景信息，这样我们就可以知道您要过滤的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T03:54:07.643

如果您确定您将在搜索中获得的字符串，那么您始终可以执行特定于您所在地区的包含。

```
(((q.Date == null ? DateTime.Parse("01/01/1900") : q.Date).Value.Day.ToString()) + "/" + ((q.Date == null ? DateTime.Parse("01/01/1900") : q.Date).Value.Month.ToString()) + "/" + ((q.Date == null ? DateTime.Parse("01/01/1900") : q.Date).Value.Year.ToString())).ToString().Contains(strDate) || (q.Date == null ? DateTime.Parse("01/01/1900") : q.Date).ToString().Contains(strDate)) 
```

`d/m/yyyy`例如，这将为在日期搜索的字符串产生匹配。这对于公共搜索来说并不理想，但它比简单的`.ToString().Contains()`.

# javascript - 如何在 JavaScript 中创建对象/数组？

> ID：901335
> 
> 赞同：4
> 
> 时间：2009-05-23T11:10:10.633
> 
> 标签：javascript, arrays

我对 JavaScript 相当陌生，我想使用 JavaScript 创建对象和数组。

我基本上追求的是一种创建将存储以下信息的对象的方法，即：

[索引，名称] 例如 [0,"NameA"][1,"NameB"] 等。

我不确定如何创建一个对象/数组来使用 jQuery 存储这种类型的信息。

其次，我需要一种将这个对象/数组作为参数传递给另一个函数的方法，然后能够遍历这个对象/数组并打印出它的内容。

同样，我也不确定如何做这部分。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-23T11:31:18.890

如果您有兴趣将一些数据保存在数组中，并将其与索引一起取出，为什么不以最简单的方式进行呢？

```
var arr = ["Alpha", "Bravo", "Charlie", "Dog", "Easy"];

for (i = 0; i<5; i++) {
    alert("Element with index " + i + " is " + arr[i] + ".");
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T13:32:28.787

您可能会发现以下文章很有趣

*   [剥离 jQuery 包装器并找到一个数组](http://www.learningjquery.com/2008/12/peeling-away-the-jquery-wrapper)

本质上，jQuery 函数返回的 (jQuery) 对象`$()`有一堆属性，其中包括一个与选择器匹配的每个元素，属性名称是数字“索引”

例如，给定以下 HTML

```
 <p>Hello, World!</p>
  <p>I'm feeling fine today</p>
  <p>How are you?</p> 
```

和选择器

```
$('p'); 
```

返回的对象如下所示

```
({length:3, 0:{}, 1:{}, 2:{}}) 
```

使用该[`.get()`](http://docs.jquery.com/Core/get)命令，您可以访问匹配的元素并对其进行相应的操作。跟随示例

```
$(function () {
var p = $('p').get();
for (var prop in p)
  alert(prop + ' ' + p[prop].innerHTML);
}); 
```

或者，了解返回的对象的结构

```
$(function () {
var p = $('p');
for (var i=0; i< p.length; i++)
  alert(i + ' ' + p[i].innerHTML);
}); 
```

会提醒

```
0 Hello, World!
1 I'm feeling fine today
2 How are you? 
```

我知道我没有直接回答您的问题，但认为深入了解 jQuery 的工作原理可能很有用。

我认为您需要回答您的问题

*   一个简单的数组，如[Tomas Lycken 的回答所示](https://stackoverflow.com/questions/901335/jquery-objects-arrays-how/901371#901371)。这似乎最适合您的要求

    `var mySimpleArray = ['a','b','c'];`

*   一个对象数组，每个对象都有一个“索引”和“名称”。我将在这里假设“索引”是您想要分配的任何数字，而不是序数位置

    `var myObjectArray = [{ index: 5, name: 'a' },{ index: 22, name: 'b'},{ index: 55, name: 'c'}];`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T11:17:35.377

$.each 的文档页面应该可以解决您的问题：

[http://docs.jquery.com/Utilities/jQuery.each](http://docs.jquery.com/Utilities/jQuery.each)

从上面的链接：

```
var arr = [ "one", "two", "three", "four", "five" ];
var obj = { one:1, two:2, three:3, four:4, five:5 };

jQuery.each(arr, function() {
  $("#" + this).text("My id is " + this + ".");
  return (this != "four"); // will stop running to skip "five"
});

jQuery.each(obj, function(i, val) {
  $("#" + i).append(document.createTextNode(" - " + val));
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T11:34:44.437

```
//class
function Foo(index, name) {
this.index = index;
this.name = name;}
//object of that class
var obj = new Foo(0, "NameA");

var myArray = new Array();
//add object to array
myArray.push(obj);    

function loopArray(someArray) {
var index; 
var name;
for (var i = 0; i < someArray.length; i++) 
 {
    index = someArray[i].index;
    name = someArray[i].name;
 }
} 
```

# .net - 无法解析远程名称

> ID：901340
> 
> 赞同：3
> 
> 时间：2009-05-23T11:11:36.107
> 
> 标签：.net, windows-mobile

我正在为 Windows Mobile 6 创建移动应用程序。我在 url/网站上上传图像。对于这个我使用 webrequest 和 webresponse 类。在获得响应时，我得到了这种类型的错误-

无法解析远程名称..我的代码是 - String url = " [http://weblogs.asp.net/scottgu/rss.aspx](http://weblogs.asp.net/scottgu/rss.aspx) "; System.Net.WebRequest 请求 = System.Net.WebRequest.Create(url); request.Credentials = System.Net.CredentialCache.DefaultCredentials；

```
 System.Net.WebResponse response = null;
        System.IO.Stream stream = null;
        response = request.GetResponse();
        stream = response.GetResponseStream(); 
```

任何人都可以帮助我..提前谢谢...问候Pankaj Pareek

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T11:18:16.233

虽然我没有使用 Windows Mobile 的具体经验，但此错误消息通常表示无法将主机名解析为 IP 地址。发生这种情况的原因有很多，包括：

*   客户端无法联系 DNS 服务器以尝试解析名称。这表明缺乏网络和/或互联网连接
*   DNS 查询没有产生结果。

解决建议：

1.  检查名称是否正确指定
2.  验证是否存在网络连接，因为这是与用于解析主机名的 DNS 服务器通信所必需的
3.  检查 DNS 服务器地址是否正确，尤其是静态配置时。

希望这可以帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T11:16:07.173

这意味着在处理 Web 服务器的 URL 时，底层网络连接无法将名称转换为 IP 地址。这可能发生的两个最可能的原因是

1.  您在输入应用程序的 URL 中引入了错字
2.  您当前在网络上遇到 DNS 问题

验证这一点的最快方法是尝试在移动浏览器中打开网站。如果您无法将其拉起，则可能是DNS问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T20:04:04.030

我给你的第一个建议是在设备上的浏览器中尝试。如果它适用于浏览器，那么它应该适用于您的代码。如果不是，则可能是您设备上的设置问题，或者如果您通过 ActiveSync 连接，则可能是主机上的网络问题（如防火墙）。

另请注意，您的代码不会自动创建蜂窝网络连接。在进行 Web 请求之前，您[将向](http://msdn.microsoft.com/en-us/library/ms838160.aspx)Connection [Manager](http://msdn.microsoft.com/en-us/library/ms827522.aspx)请求它。

# c# - 如何在 C# 中通过伪 REST 服务触发 GET 请求

> ID：901341
> 
> 赞同：0
> 
> 时间：2009-05-23T11:11:49.273
> 
> 标签：c#, .net, xml, http

我需要与旧的 php 应用程序通信。API 只是一个 php 脚本，它接受 get 请求并以 XML 形式返回响应。

我想用 C# 编写通信。

**触发 GET 请求（带有许多参数）然后解析结果的最佳方法是什么？**

理想情况下，我想找到像下面的python代码一样简单的东西：

```
params = urllib.urlencode({
    'action': 'save',
    'note': note,
    'user': user,
    'passwd': passwd,
 })

content = urllib.urlopen('%s?%s' % (theService,params)).read()
data = ElementTree.fromstring(content)
... 
```

**更新：** 我正在考虑使用 XElement.Load 但我看不到轻松构建 GET 查询的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T13:48:21.330

[WCF REST Starter Kit](http://www.codeplex.com/aspnet/Wiki/View.aspx?title=WCF%20REST)中有一些很好的实用程序类，用于实现调用在任何平台上实现的服务的 .NET REST 客户端。

[这是一个](http://channel9.msdn.com/shows/Endpoint/endpointtv-Screencast-Consuming-REST-services-with-HttpClient/)描述如何使用客户端部分的视频。

示例代码片段：

```
HttpClient c = new HttpClient("http://twitter.com/statuses");
c.TransportSettings.Credentials = 
    new NetworkCredentials(username, password);
// make a GET request on the resource.
HttpResponseMessage resp = c.Get("public_timeline.xml");
// There are also Methods on HttpClient for put, delete, head, etc
resp.EnsureResponseIsSuccessful(); // throw if not success
// read resp.Content as XElement
resp.Content.ReadAsXElement(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T12:01:08.393

A simple[`System.Net.Webclient`](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)在功能上类似于`python`'s `urllib`。

该`C#`示例（对上面的参考进行了略微编辑）显示了如何“触发 GET 请求”：

```
using System;
using System.Net;
using System.IO;
using System.Web;

public class Test
{
    public static String GetRequest (string theService, string[] params)
    {
        WebClient client = new WebClient ();

        // Add a user agent header in case the 
        // requested URI contains a query.

        client.Headers.Add ("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)");

        string req = theService + "?";
        foreach(string p in params)
            req += HttpUtility.UrlEncode(p) + "&";
        Stream data = client.OpenRead ( req.Substring(0, req.Length-1)
        StreamReader reader = new StreamReader (data);
        return = reader.ReadToEnd ();
    }
} 
```

要解析结果，请使用 System.XML 类，或者更好的 - [System.Xml.Linq](http://msdn.microsoft.com/en-us/library/system.xml.linq.aspx)类。一个直接的可能性是[`XDocument.Load(TextReader)`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.load.aspx)方法 - 您可以直接使用`WebClient`返回的流`OpenRead()`。

# javascript - 今天有哪些新的浏览器功能可用？

> ID：901345
> 
> 赞同：6
> 
> 时间：2009-05-23T11:15:35.490
> 
> 标签：javascript, html, css, internet-explorer-8

现在是 2009 年。Internet Explorer 8 终于发布了，而 Firefox 即将升级到 3.5。许多大型浏览器开始集成 CSS3 和 HTML 5 的功能，或者已经这样做了很长一段时间。尽管如此，我发现自己开发网页的方式与 2005 年完全一样。

从那时起已经取得了很多进展，我认为我没有开始利用这些新可能性的原因是很难知道哪些新功能适用于所有主要浏览器。由于我主要是后端开发人员，我只是没有时间再跟上这些发展。不过，我觉得我错过了很多很酷的东西，这些东西实际上会让我的生活更轻松。

**如何快速确定所有主流现代浏览器是否支持 CSS3 或 HTML5 的功能？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-23T11:19:45.060

[Can I Use](https://caniuse.com)是一个跟踪浏览器对当前和即将推出的 Web 标准的支持的网站。如果您想知道给定功能是否得到广泛支持，请查看它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T11:18:50.023

通过 CSS 嵌入字体，使用`@font-face`. Webkit/Safari 从 3.1 版开始支持它，从 IE4 开始支持 Microsoft，从 Firefox 3.5 开始支持 Mozilla（[浏览器支持概述](http://webfonts.info/wiki/index.php?title=%40font-face_browser_support)）。

此外，[Selectors API](http://www.w3.org/TR/selectors-api/)的各种实现，它提供了一个浏览器原生的 CSS 选择器引擎，用于 DOM 脚本。

对于其他示例，[When Can I Use...](http://a.deveria.com/caniuse/)似乎是一个很好的参考。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T11:56:19.573

浏览器对本地存储的支持应该会带来很多新想法，因为可以将一些内容保存在用户的机器上。

参考文档：

*   [火狐浏览器](https://developer.mozilla.org/En/DOM:Storage)
*   [IE浏览器](https://msdn.microsoft.com/en-us/library/bg142799(v=vs.85).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T12:20:51.100

我会说 display:table 和一系列 CSS2.1 选择器对设计师来说是最大的胜利。display:table 在不破坏语义和使用实际表格的情况下解决了一些无法解决或困难的布局，例如 100% 高度和内部边框。

多个类 (.c1.c2)

我经常使用最小/最大宽度/高度。

也工作 :hover 和 !important 很棒。

我本来希望将 SVG 支持添加到该列表中，但微软自然把它搞砸了。

顺便说一句，对于那些对 HTML5 功能感到兴奋的人来说，这是一个重大警告。采用此规范没有正式日期。甚至暗示可能还需要 10 年（尽管我对此表示怀疑）。关键是你现在对 HTML5 所做的任何事情都会在官方规范到来时受到破坏，同时你可以预期大量的浏览器不一致、错误和 API 更改（更不用说完全不支持这些功能的浏览器了） .

# windows - Windows 脚本：获取 MS Access 的默认选项

> ID：901348
> 
> 赞同：0
> 
> 时间：2009-05-23T11:17:56.467
> 
> 标签：windows, ms-access, vbscript

试图找到 Access 的对象属性以获取默认文件位置，以便我可以编写脚本对其进行更新。示例：这会从 Word 中获取内容并告诉我用户文件和模板路径指向的位置

```
Const wdDocumentsPath = 0
Const wdWorkgroupTemplatesPath = 3
Set objWord = CreateObject("Word.Application")
Set objOptions = objWord.Options
Wscript.Echo "Word Documents Path: " & _
    objOptions.DefaultFilePath(wdDocumentsPath)
Wscript.Echo "Word Workgroup Templates Path: " & _
    objOptions.DefaultFilePath(wdWorkgroupTemplatesPath)
objWord.Quit 
```

尝试使用 Access 做类似的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-24T18:52:39.760

有两种方法可以做到这一点。您可以按照您的建议获取访问对象并使用它：

```
Dim objAcc     
Set objAcc = CreateObject("Access.Application")
objAcc.SetOption "Default Database Directory", "C:\Test"
objAcc.Quit 
```

或者您可以只编辑注册表中的值：

```
Dim WshShell
Set WshShell = WScript.CreateObject("WScript.Shell")    
WshShell.RegWrite  "HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Access\Settings\Default Database Directory", "C:\Test", "REG_SZ" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T14:25:12.003

嗯...只是使用 TLViewer 快速浏览一下`C:\Program Files\Microsoft Office\Office10\MSACC.OLB`（我使用的是较旧的 Access）。

```
Property Path As String [Get/o]
  member of Access.CodeProject

Property Path As String [Get/o]
  member of Access.CurrentProject

Property FullPath As String [Get/o]
  member of Access.Reference 
```

我不知道这些是否有用——我不太喜欢 Access。

# methodology - 功能规格

> ID：901350
> 
> 赞同：3
> 
> 时间：2009-05-23T11:18:37.090
> 
> 标签：methodology, specifications

无论我在哪里查看，功能规范都是某种文档，其中包含并详细说明了需求/提议的功能。我最近能够为我们公司制作功能规范的标准模板。我暂时选择的格式是一个具有相当多自动化程度的 excel 文件。

1.  该模板计划将顶层需求链接到层次结构中的较低级别需求。

2.  然后可以将较低级别的要求映射到设计的技术方面，类似于质量屋。相关性在 HOQ 中被确定，但此外，对于每对需求和技术方面，都估计了可行性。

3.  如果需求的任何技术方面被标记为不可行，则该需求被标记为重新考虑。

4.  在将所有需求标记为可行或适当删除之后，提取每个需求-技术方面对，并根据时间和预算为每个需求寻求估计。

5.  这些估计有助于我们规划项目。

我可以对此提案发表知情意见吗？在我看来，这似乎是将需求与技术方面联系起来，然后再与项目规划联系起来的最佳方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T13:02:01.047

根据我的经验，功能规范通常是一个用例文档（有或没有相应的图表）。电子表格听起来很酷，但功能要求通常用于与业务利益相关者进行沟通，目的是获得同意并最终签署，以便批准项目的预算。除非您的电子表格可以以某种方式格式化打印输出的要求，否则我对您建议如何共享内容以供讨论和反馈感到有些困惑。

我的两分钱...

希望这可以帮助，

账单

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T11:27:58.680

您可能希望在低级需求和测试之间添加映射（例如“设计测试”，而不是“单元测试”。
这样您就可以建立该项目所需的广泛的功能测试覆盖范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T11:36:44.403

“我可以对这个提议有一个知情的意见吗？”

此电子表格的用户是谁？

您的用户如何使用此电子表格？他们在需求收集、规划和项目批准方面有哪些用例？

如果您是用户，那么它非常适合您。

如果您不是用户，则需要与您的用户会面，确定以下内容：

*   需求的用户采取什么行动？他们批准、拒绝、确认还是拒绝？

*   他们做出什么决定？

*   他们需要哪些信息来做出这些决定？

如果您的电子表格满足您的用户需求，那就太好了。

需求是很棘手的事情，必须以多种方式重新确定优先级和重新考虑。过多的电子表格自动化可能会成为障碍。

大多数情况下，人们需要能够添加无限数量的额外列，并将它们分类为无数的组织和重组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T14:57:47.397

您可能需要对电子表格进行补充以列出用例和任何用户界面规范。

# rhino-mocks - Rhino 模拟记录播放语法

> ID：901353
> 
> 赞同：4
> 
> 时间：2009-05-23T11:19:00.570
> 
> 标签：rhino-mocks

求助，谁能帮忙解释一下Rhino Mocks'Record'范围的用途？

我假设在范围内设置的期望只会被验证，但似乎一旦你创建了模拟对象，Rhino Mocks 就处于“记录模式”，所以我现在不确定记录范围的目的。

这是我的一个例子：

```
 private static void SomeTest()
    {
        MockRepository mockRepository = new MockRepository();
        ISomeInterface test = mockRepository.StrictMock<ISomeInterface>();

        test.Bar();

        using (mockRepository.Record())
        {
            Expect.Call<string>(test.GetFoo()).Return("Hello");
        }

        using (mockRepository.Playback()) 
        {
           test.GetFoo();
        }
    }

    public interface ISomeInterface
    {
        string GetFoo();
        void Bar();
    } 
```

这个测试会失败，因为期望**Bar**应该被调用。是因为我创建了一个 StrictMock 而不是 Dynamic 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T14:30:28.607

此测试将失败，因为*不*期望 Bar() 会被调用，但它*被*调用了。

To answer your question, yes, it is because you have a strict mock. If you change to a DynamicMock, it will ignore everything except the expectations that you actually set. I would highly recommend using DynamicMocks wherever possible, as StrictMocks are actually quite brittle and tend to end up being a lot of hassle.

As for Record/Replay, it is not automatically in Record mode if you're using a concrete MockRepository. It's just the nature of the StrictMock that looks for anything being called that was outside of expectations, no matter when.

# php - PHP APC，教育我

> ID：901356
> 
> 赞同：13
> 
> 时间：2009-05-23T11:20:33.343
> 
> 标签：php, apc

我目前正在我的服务中实现 memcached，但不断出现的建议是我还应该实现 APC 以缓存实际代码。

我浏览了一些教程以及[PHP 文档](http://uk3.php.net/apc/)，但我的主要问题是，如何大规模实现它？PHP 文档讨论了存储变量，但没有那么详细。

请原谅我在这方面没有受过教育，但我想知道在实际站点中的哪个位置实现了这一点。我是从字面上缓存所有内容还是只缓存经常使用的部分，例如函数？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-23T11:41:31.350

APC 既是[操作码缓存](http://www.google.com/search?q=opcode+cache)又是通用数据缓存。后者的工作方式与 memcached 非常相似，而操作码缓存通过缓存已解析的 php 文件来工作，因此不必在每个请求上都解析它们。这通常可以大大加快执行时间。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-23T11:43:54.497

如您所知，PHP 是一种解释性语言，因此每次请求到达服务器时，它都需要打开所有必需和包含的文件，解析并执行它们。APC 提供的是跳过 require/include 和解析步骤（这些文件仍然是必需的，但存储在内存中，因此访问速度要快得多），因此只需执行脚本。在我们的网站上，我们使用 APC 和 memcached 的组合。APC 可加快上述步骤，memcached 可实现对全局变量（可在一定时间内由多个客户端共享的预先计算的昂贵函数调用等）以及会话变量的快速和分布式存储和访问。这使我们能够拥有多个前端服务器，而不会丢失任何客户端状态，例如登录状态等。

当涉及到您应该缓存的内容时……嗯，这实际上取决于您的应用程序。如果您在某个地方需要多个前端，我会尝试使用 memcached 进行此类缓存和存储，并将 APC 用作操作码缓存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T11:54:23.803

您不必实现 APC 的操作码缓存功能，只需将它们作为 php 模块启用即可。

APC 缓存大小和其他配置信息在[这里](http://de3.php.net/manual/en/apc.configuration.php)。

# ios - 如何将 NSString 值转换为 NSData？

> ID：901357
> 
> 赞同：943
> 
> 时间：2009-05-23T11:20:38.193
> 
> 标签：ios, objective-c, nsstring, nsdata

如何将`NSString`值转换为`NSData`？

* * *

## 回答 #1

> 赞同：1439
> 
> 时间：2009-05-23T11:34:10.180

```
NSString* str = @"teststring";
NSData* data = [str dataUsingEncoding:NSUTF8StringEncoding]; 
```

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2015-03-10T12:39:11.420

```
NSString *str = @"helowrld";
// This converts the string to an NSData object
NSData *data = [str dataUsingEncoding:NSUTF8StringEncoding]; 
```

你可以参考这个[链接](http://albertech.blogspot.in/2011/08/convert-nsstring-to-nsdata-and-back.html)

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2011-10-25T19:47:04.267

做：

```
NSData *data = [yourString dataUsingEncoding:NSUTF8StringEncoding]; 
```

然后随意继续`NSJSONSerialization:JSONObjectWithData`。

* * *

### 更正有关 NULL 终止符的答案

在评论、官方文档和[验证](https://stackoverflow.com/questions/14087094/does-converting-nsstring-to-nsdata-force-a-trailing-byte)之后，此答案已更新，以删除所谓的 NULL 终止符：

1.  正如[dataUsingEncoding:](https://developer.apple.com/documentation/foundation/nsstring/1416696-datausingencoding?language=objc)所记录的：

    > ### 返回值
    > 
    > `dataUsingEncoding:allowLossyConversion:`以 NO 作为第二个参数调用的结果

2.  正如[getCString:maxLength:encoding:](https://developer.apple.com/documentation/foundation/nsstring/1415702-getcstring?language=objc)和[cStringUsingEncoding:](https://developer.apple.com/documentation/foundation/nsstring/1408489-cstringusingencoding?language=objc)所记录的：

    > 请注意，返回的数据`dataUsingEncoding:allowLossyConversion:`不是严格的 C 字符串，因为它**没有 NULL 终止符**

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2015-03-03T15:28:31.137

如果 Swift Developer 来到这里，

从 NSString / String 转换为 NSData

```
var _nsdata = _nsstring.dataUsingEncoding(NSUTF8StringEncoding) 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2016-03-26T23:03:52.877

**目标-C：**

```
NSString *str = @"test string";
NSData *data = [NSKeyedArchiver archivedDataWithRootObject:str];
NSString *thatStr = [NSKeyedUnarchiver unarchiveObjectWithData:data]; 
```

**迅速：**

```
let str = "test string"
let data = NSKeyedArchiver.archivedData(withRootObject: str)
let thatStr = NSKeyedUnarchiver.unarchiveObject(with: data) as! String 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-09-13T08:02:28.580

首先，您应该使用`dataUsingEncoding:`而不是通过`UTF8String`. 仅`UTF8String`当您需要`C`该编码中的字符串时才使用。

然后，对于`UTF-16`，只需传递`NSUnicodeStringEncoding`而不是`NSUTF8StringEncoding`在您的`dataUsingEncoding:`消息中。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-11-01T07:59:14.480

对于 Swift 3，您将主要从 转换`String`为`Data`.

```
let myString = "test"
let myData = myString.data(using: .utf8)
print(myData) // Optional(Data) 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-11-27T17:46:07.043

```
NSString *str = @"hello";
NSData *data = [NSData dataWithBytes:str.UTF8String length:str.length]; 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2019-03-14T08:30:30.057

**目标-C：**

NSString 到 NSData：

```
NSString* str= @"string";
NSData* data=[str dataUsingEncoding:NSUTF8StringEncoding]; 
```

NSData 到 NSString：

```
NSString* newStr = [[NSString alloc] initWithData:theData encoding:NSUTF8StringEncoding]; 
```

**迅速：**

字符串到数据：

```
var testString = "string"
var somedata = testString.data(using: String.Encoding.utf8) 
```

数据到字符串：

```
var backToString = String(data: somedata!, encoding: String.Encoding.utf8) as String! 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2021-06-29T04:22:54.653

更新 Swift 5.x

```
let str = "teststring"
let data = str.data(using: .utf8) 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2021-07-05T10:43:10.793

**迅速：**

斯威夫特 5.x

```
let myStringToConvert = "My String to Convert in Data"
let myData = str.data(using: .utf8) 
```

字符串到数据：

```
var myStringToConvert = "My String to Convert in Data"
var myData = testString.data(using: String.Encoding.utf8) 
```

数据到字符串：

```
var backToMyString = String(data: myData!, encoding: String.Encoding.utf8) as String! 
```

**目标 C：**

NSString 到 NSData ：

```
NSString* myStringToConvert= @"My String to Convert in Data";
NSData* myData=[str dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:NO]; 
```

NSData 到 NSString ：

```
NSString* backToMyString = [[NSString alloc] initWithData: myData encoding:NSUTF8StringEncoding]; 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-04-13T21:37:12.530

```
NSString *str = @"Banana";
NSData *data = [str dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:true]; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-04-17T06:19:36.737

Objective-C

```
NSString *str = @"Hello World";
NSData *data = [str dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:NO]; 
```

迅速

```
let str = "Hello World"
let data = string.data(using: String.Encoding.utf8, allowLossyConversion: false) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-06-29T04:31:33.357

在 Swift 中有一个返回**非可选的 API**

```
let str = "teststring"
let data = Data(str.utf8) 
```

# python - 用于 XSS 过滤的 Python 库？

> ID：901369
> 
> 赞同：14
> 
> 时间：2009-05-23T11:29:47.520
> 
> 标签：python, xss

是否有一个良好的、积极维护的 Python 库可用于过滤恶意输入（例如 XSS）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-15T16:12:45.137

如果您正在使用 Web 框架和 Jinja2 之类的模板引擎，那么模板引擎或框架有可能为此内置了一些东西。

cgi 模块中有一些东西可以帮助你：

`cgi.escape('malicious code here')`，见：[http ://docs.python.org/library/cgi.html#cgi.escape](http://docs.python.org/library/cgi.html#cgi.escape)

Jinja2 还提供转义：

```
from jinja2 import utils
str(utils.escape('malicious code here')) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T16:00:05.153

您可以轻松地在 Python 中编写 XSS 防御代码，例如，请参阅[http://code.activestate.com/recipes/496942/](http://code.activestate.com/recipes/496942/)以获得指导性和可用的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T12:10:36.440

[Strip-o-Gram](http://zope.org/Members/chrisw/StripOGram/readme)库看起来相当不错。我没有正确检查它，但它看起来做得很好（即可以将您指定的 HTML 标签列入白名单，以及 HTML 转义任何讨厌的东西）。

这是从该页面引用的示例用法片段：

```
 from stripogram import html2text, html2safehtml
  mylumpofdodgyhtml # a lump of dodgy html ;-)
  # Only allow <b>, <a>, <i>, <br>, and <p> tags
  mylumpofcoolcleancollectedhtml = html2safehtml(mylumpofdodgyhtml,valid_tags=("b", "a", "i", "br", "p"))
  # Don't process <img> tags, just strip them out. Use an indent of 4 spaces 
  # and a page that's 80 characters wide.
  mylumpoftext = html2text(mylumpofcoolcleancollectedhtml,ignore_tags=("img",),indent_width=4,page_width=80) 
```

希望有帮助。

# asp.net-mvc - Mvc Html.ActionButton

> ID：901372
> 
> 赞同：11
> 
> 时间：2009-05-23T11:31:28.750
> 
> 标签：asp.net-mvc

有人写过吗？我希望它表现得像一个链接，但看起来像一个按钮。带有单个按钮的表单不会这样做，我不需要任何 POST。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-23T11:42:16.420

最简单的方法是使用一个带有 的小`form`标签`method="get"`，在其中放置一个提交按钮：

```
<form method="get" action="/myController/myAction/">
    <input type="submit" value="button text goes here" />
</form> 
```

您当然可以编写一个非常简单的扩展方法，该方法采用按钮文本和一个`RouteValueDictionary`（或带有路由值的匿名类型）并构建表单，这样您就不必到处重新做。

**编辑**：响应 cdmckay 的回答，这里有一个替代代码，它使用`TagBuilder`类而不是常规`StringBuilder`来构建表单，主要是为了清楚起见：

```
using System.Web.Mvc;
using System.Web.Mvc.Html;
using System.Web.Routing;

namespace MvcApplication1
{
    public static class HtmlExtensions
    {
        public static string ActionButton(this HtmlHelper helper, string value, 
                              string action, string controller, object routeValues)
        {
            var a = (new UrlHelper(helper.ViewContext.RequestContext))
                        .Action(action, controller, routeValues);

            var form = new TagBuilder("form");
            form.Attributes.Add("method", "get");
            form.Attributes.Add("action", a);

            var input = new TagBuilder("input");
            input.Attributes.Add("type", "submit");
            input.Attributes.Add("value", value);

            form.InnerHtml = input.ToString(TagRenderMode.SelfClosing);

            return form.ToString(TagRenderMode.Normal);
        }
    }
} 
```

此外，与 cdmckay 的代码相反，这个代码实际上会编译；）我知道这段代码可能会有很多开销，但我希望你不需要在每个代码上运行很多次页。如果你这样做了，你可能会做很多优化。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-10-22T22:26:43.587

如果您希望它表现得像一个链接但“看起来”像一个按钮，只需使用带有 CSS 类的 ActionLink。

```
<%: Html.ActionLink("Back", "Index", null, new { @class = "link-button" })%> 
```

这是我正在使用的按钮的 CSS。

```
.link-button {
    -moz-border-radius:0.333em 0.333em 0.333em 0.333em;
    -moz-box-shadow:0 1px 4px rgba(0, 0, 0, 0.4);
    background:-moz-linear-gradient(center top , white, #306AB5 4%, #274976) repeat scroll 0 0 transparent;
    border-color:#306AB5 #2B5892 #274771;
    border-style:solid;
    border-width:1px;
    color:white;
    cursor:pointer;
    display:inline-block;
    font-size:1.167em;
    font-weight:bold;
    line-height:1.429em;
    padding:0.286em 1em 0.357em;
    text-shadow:0 1px 2px rgba(0, 0, 0, 0.4);
}

.link-button {
    color: white;
    border-color: #a1a7ae #909498 #6b7076;
    background: #9fa7b0 url(../images/old-browsers-bg/button-element-grey-bg.png) repeat-x top;
    background: -moz-linear-gradient(
        top,
        white,
        #c5cbce 5%,
        #9fa7b0
    );
    background: -webkit-gradient(
        linear,
        left top, left bottom,
        from(white),
        to(#9fa7b0),
        color-stop(0.05, #c5cbce)
    );
    -moz-text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
    -webkit-text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
    -moz-box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
    }
    .link-button:hover {
        border-color: #a1a7b0 #939798 #6e7275;
        background: #b1b5ba url(../images/old-browsers-bg/button-element-grey-hover-bg.png) repeat-x top;
        background: -moz-linear-gradient(
            top,
            white,
            #d6dadc 4%,
            #b1b5ba
        );
        background: -webkit-gradient(
            linear,
            left top, left bottom,
            from(white),
            to(#b1b5ba),
            color-stop(0.03, #d6dadc)
        );
    }
    .link-button:active {
        border-color: #666666 #ffffff #ffffff #979898;
        background: #dddddd url(../images/old-browsers-bg/button-element-grey-active-bg.png) repeat-x top;
        background: -moz-linear-gradient(
            top,
            #f1f1f1,
            #dddddd
        );
        background: -webkit-gradient(
            linear,
            left top, left bottom,
            from(#f1f1f1),
            to(#dddddd)
        );
    } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-07-27T11:07:21.117

两个版本可以扩展...

```
<button 
    onclick="javascript:window.location=('@Url.Action("Review", "Order", null)')"
    >Review Order</button> 
```

**不显眼的版本：**

```
<button data-action="@Url.Action("Review", "Order", null)">Review Order</button>

$(document).on('click', "[data-action]", 
    function(e) { window.location = $(this).attr('data-action'); }
); 
```

如果您的用户没有打开 javascript，那么表单标签就是要走的路。**虽然，如果您的链接已经在表单**中，这会使情况变得困难。但是，您可以将操作和方法更改为 GET。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-28T18:32:10.570

托马斯回答的代码：

```
public static class HtmlExtensions
{
  public static string ActionButton(this HtmlHelper helper, string value, 
      string action, string controller, object routeValues)
  {
    UrlHelper urlHelper = new UrlHelper(helper.ViewContext);
    var action = urlHelper.Action(action, controller, routeValues);

    var html = new StringBuilder();
    html.AppendFormat("<form method='get' action'{0}'>", action).AppendLine()
        .AppendFormat("    <input type='submit' value='{0}' />", value).AppendLine()
        .AppendFormat("</form>").AppendLine();

    return html.ToString();
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-13T17:25:46.377

如果您想要一个功能类似于链接的按钮，则应该可以：

```
<input type="button" value="Button Text"
  onclick="@("location.href='http://stackoverflow.com/q/901372/2460971'")" /> 
```

如果您希望按钮使用控制器操作，则只需稍作更改：

```
<input type="button" value="Button Text"
  onclick="@("location.href='" + Url.Action("ActionName", "ControllerName") + "'")" /> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-24T11:23:58.700

我修改了 Tomas Lyckens 代码以返回一个 MvcHtmlString 而不仅仅是一个字符串。这确保输出是 HTML，而不是作为文本转义。我也很好地用 xml 记录了它。感谢托马斯，他做了所有真正的工作。

```
 /// <summary>
    /// Returns an HTML submit button (enclosed in its own form) that contains the virtual path of the specified action.
    /// </summary>
    /// <param name="helper">The HTML helper instance that this method extends.</param>
    /// <param name="buttonText">The visible text of the button.</param>
    /// <param name="action">The name of the action.</param>
    /// <param name="controller">The name of the controller.</param>
    /// <param name="routeValues">An object that contains the parameters for a route. The parameters are retrieved through reflection by examining the properties of the object. The object is typically created by using object initializer syntax.</param>
    /// <returns></returns>
    public static MvcHtmlString ActionButton(this HtmlHelper helper, string buttonText, string action, string controller, object routeValues)
    {
        string a = (new UrlHelper(helper.ViewContext.RequestContext)).Action(action, controller, routeValues);

        var form = new TagBuilder("form");
        form.Attributes.Add("method", "get");
        form.Attributes.Add("action", a);

        var input = new TagBuilder("input");
        input.Attributes.Add("type", "submit");
        input.Attributes.Add("value", buttonText);

        form.InnerHtml = input.ToString(TagRenderMode.SelfClosing);

        return MvcHtmlString.Create(form.ToString(TagRenderMode.Normal));
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-12-05T04:51:42.390

这是一个带有额外内容的 VB.NET 版本，控制器和路由参数是可选的，因此如果它与页面的当前/默认控制器相同，则可以使用它而无需重复控制器名称。

```
Public Module MvcExtensions

    ''' <summary> 
    ''' Returns an HTML submit button (enclosed in its own form) that contains the virtual path of the specified action. 
    ''' </summary> 
    ''' <param name="helper">The HTML helper instance that this method extends.</param> 
    ''' <param name="text">Text displayed in the button.</param> 
    ''' <param name="action">Action name.</param> 
    ''' <param name="controller">Optional controller name, using current when null.</param> 
    ''' <param name="routeValues">
    ''' An object that contains the parameters for a route. The parameters are retrieved
    ''' through reflection by examining the properties of the object.
    ''' The object is typically created by using object initializer syntax.
    ''' </param> 
    ''' <returns>
    ''' HTML output.
    ''' </returns> 
    <Extension()> _
    Public Function ActionButton(helper As HtmlHelper, text As String, action As String,
                                 Optional controller As String = Nothing, Optional routeValues As Object = Nothing) As MvcHtmlString

        ' Validate parameters
        If String.IsNullOrEmpty(text) Then Throw New ArgumentNullException("text")

        ' Get post back URL for action
        Dim actionUrl As String = New UrlHelper(helper.ViewContext.RequestContext).Action(action, controller, routeValues)

        ' Build form tag with action URL
        Dim form = New TagBuilder("form")
        form.Attributes.Add("method", "get")
        form.Attributes.Add("action", actionUrl)

        ' Add button
        Dim input = New TagBuilder("input")
        input.Attributes.Add("type", "submit")
        input.Attributes.Add("value", text)
        form.InnerHtml = input.ToString(TagRenderMode.SelfClosing)

        ' Return result as HTML
        Return MvcHtmlString.Create(form.ToString(TagRenderMode.Normal))

    End Function

End Module 
```

然后它可以像其他 MVC 控件一样被调用，页面上的代码最少。

这真的应该从一开始就进入核心 MVC 框架；这似乎是一个显而易见的要求。我认为在执行创建或更改事物而不是链接的操作时，按钮对用户来说更直观。链接应该只是导航到相关信息（不改变任何东西）。如果我有一个网格，我会使用 ActionLink 进行任何数据导航（例如单击产品名称转到产品页面），但只有 ActionButton 用于真正的“操作”，例如编辑和删除。

# sony - wapsite 上 索尼爱立信 P1i

> ID：901378
> 
> 赞同：-1
> 
> 时间：2009-05-23T11:33:50.400
> 
> 标签：sony

在索尼爱立信 p1i 上，Wapsite 无法正常打开？休息时一切正常。这是浏览器功能还是我们的问题。请提出解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T14:37:42.633

哪个浏览器？内置浏览器或任何其他浏览器？如果是其他浏览器，请检查是否在其他手机中使用相同的浏览器。

对于像 p1i 这样的手机，我认为网站无法正确显示，因此可能是您的问题。请提供有关错误的更多信息。

顺便说一句，网站无法正确显示是错误而不是功能；-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T22:12:45.050

您的问题描述不是很容易理解，但我认为您的问题是对于一个特定的站点，wap 页面将无法正确显示。这可能是 wap 浏览器的本地问题。消除这种情况的一种方法是使用其他浏览器而不是内部浏览器。尝试下载[Opera Mini](http://www.opera.com/mini/download/)或[Opera Mobile](http://www.opera.com/mobile/download/)并使用它打开网站。如果可行，则显然是本地 wap 浏览器的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T10:48:40.257

这是网关端的一些问题。之后它正常工作....

# time-management - 好的甘特图软件？

> ID：901380
> 
> 赞同：0
> 
> 时间：2009-05-23T11:34:24.937
> 
> 标签：time-management

我自己有多个项目，每个项目都有截止日期和（个人）估计我应该投入多少时间来完成这件事。

在特定时间，我可以参与多个项目。

我需要的是一个软件，它可以让我计划和显示“时间表”：每个项目的一条线，当我必须努力投入其中时，它就会延伸。

你知道做类似事情的东西吗？我记得这是软件工程中使用的一种技术，但我不记得名字了……

**编辑**

感谢*duffymo*，我知道我想要一个甘特图管理器 :)

* * *

有关的：

*   [您会为 linux 推荐哪种甘特图/项目管理工具？](https://stackoverflow.com/questions/191997/which-gantt-chart-project-management-tool-would-you-recommend-for-linux)
*   [项目管理——资源图](https://stackoverflow.com/questions/198666/project-management-resource-chart)
*   [你能推荐一个好的php甘特图开发吗？](https://stackoverflow.com/questions/364322/can-you-recommend-a-good-php-gantt-charting-development)
*   [是否有任何用于绘制甘特图的 LaTeX 包？](https://stackoverflow.com/questions/171809/is-there-any-latex-package-for-drawing-gantt-diagrams)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T12:35:05.923

在 Feeware 基于 java 的前端，你有[**GanttProject**](http://www.ganttproject.biz/)。

您可以从此[jnlp 链接](http://ganttproject.googlecode.com/svn/webstart/ganttproject-2.0.9/ganttproject-2.0.9.jnlp)启动它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T12:48:06.083

如果您没有 Microsoft Project，您可以在 Excel 中使用堆积条形图执行此操作。

[http://office.microsoft.com/en-us/excel/HA010346051033.aspx](http://office.microsoft.com/en-us/excel/HA010346051033.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T11:38:59.437

我认为它被称为[甘特](http://en.wikipedia.org/wiki/Gantt_chart)图。

而谷歌可以找到一堆开源的可能性，包括[这个](http://www.ganttproject.biz/)。不知道好不好

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T12:05:50.147

微软项目是一个很好的项目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T12:13:40.240

对于 Mac OS，您应该看看[OmniPlan](http://www.omnigroup.com/applications/omniplan/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-23T18:44:30.477

你*真的*需要甘特图吗？

您有一组工作（积压工作），其中包括来自多个项目的项目。您需要根据您实际完成工作的速度（您的速度）和当前的工作项目组合来预测项目的结束日期，并决定调整积压工作以移动各种项目的估计完成日期. 到此为止吧？

给定一个速度（每个固定时间段的工作单位），您可以通过将积压项目划分为时间框（迭代）来提前计划，这些时间框（迭代）容纳的项目不超过一个速度的价值。项目的最后一个工作项进入的时间框是该项目预计完成的时间。相应地洗牌。

这在某些方面被称为“基于现实的”调度，因为它基于已证明的进度和一致的估计。甘特是基于计划的；有一种想要让现实符合计划的倾向，这会导致很多压力和痛苦。

有许多敏捷/Scrum 工具可以自动管理您的工作积压，并让您跟踪工作并计算速度。我是基于网络且免费的[Pivotal Tracker的粉丝。](http://www.pivotaltracker.com/)（完全披露：我曾与 Pivotal Labs 合作。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-08T10:20:50.780

我会向您推荐一个在线免费工具，它可以让您创建您想要的东西，它被称为“ [Gantter](http://www.gantter.com) ”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-23T12:32:24.650

对于 Linux 和 Windows：[规划器](http://live.gnome.org/Planner)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-23T12:56:25.083

[OpenProj](http://openproj.org/)真的很强大，似乎与 MSProject 兼容，并且可以在 Windows / Linux / Mac 上运行（它基于 Java）。它也是免费的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-04-25T09:56:02.690

关于时间管理软件，它有很多种，我用过的一种叫做[EfficientCalendar](http://www.efficientsoftware.net/products/time-management-software.htm)，只是一个建议。

# javascript - Ajax 页面部分加载和 Google

> ID：901381
> 
> 赞同：1
> 
> 时间：2009-05-23T11:34:29.150
> 
> 标签：javascript, ajax, search-engine

我在页面上通过 ajax 从服务器加载了一些 div，但在场景中谷歌和其他搜索引擎不索引这个 div 的内容。我看到的唯一解决方案是，它识别页面何时由搜索机器人获取并返回没有 ajax 的完整页面。1）有更简单的方法吗？2）如何区分人类和机器人？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T12:26:07.610

您还可以在站点地图中提供指向非 ajax 版本的链接，并且当您提供该文件（给机器人）时，请确保已将规范链接元素包含到您希望用户看到的“真实”页面：

```
<html>
    <head>
        [...]
        <link rel="canonical" href="YOUR_CANONICAL_URL_HERE" />
        [...]
    </head>
    <body>
        [...]
        YOUR NON_AJAX_CONTENT_HERE
    </body>
</html> 
```

编辑：如果这个解决方案不合适（下面的一些评论指出这个解决方案是非标准的，只有“三巨头”支持），你可能需要重新考虑是否应该制作非 ajax 版本标准解决方案，并使用 JavaScript 隐藏/显示信息，而不是通过 AJAX 获取信息。如果获取的是业务关键信息，您必须意识到并非所有用户都启用了 JavaScript，因此他们将无法看到此信息。在这种情况下，渐进式增强方法可能更合适。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T10:10:20.987

如果您试图向您的用户展示与抓取工具不同的内容，Google 会感到不安。我建议简单地缓存您的查询或需要 AJAX 的任何内容，然后使用 AJAX 仅替换您需要更改的内容。您还没有真正解释这个 div 中只有 AJAX 可以提供的内容。如果您可以在没有 AJAX 的情况下做到这一点，那么您应该不仅适用于 SEO，而且适用于盲文阅读器、移动设备和没有 javascript 的人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T00:40:39.477

您可以在`robots.txt`. 该站点地图应该是您的静态页面的列表。您**不**应该在同一个 URL 上向 Google 提供不同的页面，因此您应该有一个包含静态和动态内容的不同 URL。通常，静态 URL 是`.../blog/03/09/i-bought-a-puppy`，动态 URL 类似于`.../search/puppy`.

# c - 面向 C 程序员的 Intel Core

> ID：901383
> 
> 赞同：5
> 
> 时间：2009-05-23T11:35:23.720
> 
> 标签：c, hardware, cpu

**第一个问题** 从 C 程序员的角度来看，英特尔酷睿处理器与其 AMD 同类产品有什么区别**？**

**相关的第二个问题** 我认为有一些指令可以将英特尔酷睿与其他处理器区分开来，反之亦然。这些指示有多重要？编译器是否考虑了它们？如果有一些仅用于 Core 家族的特殊 Intel 编译器，性能会更好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T11:54:18.673

> 第一个问题 从 C 程序员的角度来看，英特尔酷睿处理器与其 AMD 同类产品有什么区别？

最显着的差异可能只出现在使用新一代指令的高度专业化代码中，例如向量数学、并行化、SSE。

> 如果有一些仅用于 Core 家族的特殊 Intel 编译器，性能会更好吗？

不确定您是否知道，但有一个专门针对 Intel 内核的编译器：[icc](http://software.intel.com/en-us/intel-compilers/)。从优化的角度来看，它通常被认为是最好的编译器。

您可能想查看它的[维基百科文章](http://en.wikipedia.org/wiki/Intel_C%2B%2B_Compiler)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T12:08:48.300

1.  如果您正在编写用户级代码和大多数驱动程序代码，则没有太多差异（一个例外是某些指令集的可用性 - 对于不同的处理器可能会有所不同，见下文）。如果您正在编写处理特定于 CPU 的功能的内核代码（使用内部计数器进行分析、内存管理、电源管理、虚拟化），那么架构在实现上会有所不同，有时甚至很大。

2.  大多数编译器不会自动利用 SSE 指令。但是，大多数确实提供了基于 SSE 的内在函数，这将允许您编写 SSE 感知代码。所有可用 SSE 级别的子集因每个处理器架构和制造商而异。

有关说明列表，请参阅[此页面](http://en.wikipedia.org/wiki/X86_instruction_listings)。按照链接查看支持特定指令的架构。此外，请阅读[Intel](http://www.intel.com/products/processor/manuals/)和[AMD](http://www.amd.com/us-en/Processors/DevelopWithAMD/0,,30_2252_875_7044,00.html)架构开发手册，了解有关任何和所有指令集的支持和实现的详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T12:09:49.000

根据[Intel Core Wikipedia 文章，对](http://en.wikipedia.org/wiki/Intel_Core#Technical_specifications)[SSE](http://en.wikipedia.org/wiki/Streaming_SIMD_Extensions)、[SSE2](http://en.wikipedia.org/wiki/SSE2)和[SSE3](http://en.wikipedia.org/wiki/SSE3)指令进行了显着改进。这些指令是 SIMD（相同指令，多数据），这意味着它们旨在将单个算术运算应用于值向量。它们当然很重要，并且已经被 GCC 等编译器使用了[很长一段时间](http://gcc.gnu.org/gcc-3.3/changes.html)。

当然，最近的 AMD 处理器采用了最新的 Intel 指令，反之亦然。这是一个持续的趋势。

# python - 使用 XMLRPC 在 Python 中进行动态函数调用

> ID：901391
> 
> 赞同：1
> 
> 时间：2009-05-23T11:41:19.167
> 
> 标签：python, function, xml-rpc, rpc

我正在编写一个我打算用来创建子例程的类，构造函数如下：

```
def __init__(self,menuText,RPC_params,RPC_call):
   #Treat the params
   #Call the given RPC_call with the treated params 
```

问题是我想在模式“ **rpc.serve.(function name here)(params)** ”上调用函数，其中 rpc 是我用来调用 XMLRPC 函数的 serverProxy 对象，并且 serve.-function name - 是我在 XMLRPC 服务器上调用的方法。

我已经看过[Calling a function from a string with the function's name in Python](https://stackoverflow.com/questions/3061/calling-a-function-from-a-string-with-the-functions-name-in-python)，但是看到我的 serverProxy 对象不知道它有哪些“远程属性”，我不能使用 getattr() 函数来检索该方法。

我已经看到了一个通过制作字典来调用给定函数的示例，但是没有办法像创建字符串一样通过创建函数调用来使函数真正动态化吗？就像将字符串作为函数运行一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T11:53:56.240

您*可以*使用`getattr`从服务器代理获取函数名称，因此可以像这样调用函数：

```
getattr(rpc, function_name)(*params) 
```

# data-structures - 在计算运行时复杂度时如何找出基本操作？

> ID：901396
> 
> 赞同：2
> 
> 时间：2009-05-23T11:44:05.247
> 
> 标签：data-structures, runtime, time-complexity

我试图在创建的几个算法上获得最差的运行时复杂度顺序。但是，我遇到了一个问题，即我一直倾向于为算法选择错误或错误数量的基本操作。

在我看来，基本操作的选择更像是一门艺术而不是一门科学。在谷歌搜索和阅读我的文本框后，我仍然没有找到一个好的定义。到目前为止，我已将其定义为“始终在算法执行中发生的操作”，例如比较或数组操作。

但是算法通常有许多总是执行的比较，所以你选择哪个操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T11:56:38.747

我在某种程度上同意这是一门艺术，因此在编写文档等时应始终澄清。但通常这是对底层数据结构的“访问”。所以就像你说的，对于一个数组，它是一个比较或交换，对于一个哈希映射，它可能是一个键的手动检查，对于一个图，它是对顶点或边的访问，等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T18:47:17.440

即使是实践复杂性理论家对这类事情也有分歧，所以下面的内容可能有点主观： http: [//blog.computationalcomplexity.org/2009/05/shaving-logs-with-unit-cost.html](http://blog.computationalcomplexity.org/2009/05/shaving-logs-with-unit-cost.html)

big-O 表示法的目的是为读者总结算法的效率。在实际环境中，我最关心的是算法需要多少时钟周期，假设 big-O 常数既不太小也不太大（并忽略内存层次结构的影响）；这是链接帖子中提到的“单位成本”模型。

对排序算法进行比较计数的原因是比较的成本取决于输入数据的类型。您可以说排序算法需要 O(cn log n) 个周期，其中 c 是比较的开销，但在这种情况下计算比较更简单，因为算法执行的其他工作是 O(n log n)。有一种排序算法可以在 n^2 log n 步和 n^2 比较中对 n 个长度为 n 的排序数组的串联进行排序；在这里，我希望将比较次数和计算开销分开说明，因为两者都不一定占主导地位。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T13:57:43.993

这仅在您实际实现了算法时才有效，但您可以使用分析器来查看哪个操作是瓶颈。这是一个实用的观点。理论上，有些人假设所有不是基本操作的东西都在零时间内运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-10T23:42:51.153

我听到的有点简单的定义是：

> 至少与算法中的任何其他操作一样多次执行的操作。

例如，在排序算法中，这些往往是比较而不是赋值，因为您几乎总是必须在重新排序之前访问并“检查”一个元素，但检查可能不会导致重新排序。所以总会有至少和作业一样多的比较。

# vba - Outlook 2007 VBA 代码跳转到（打开）IMAP 收件箱

> ID：901408
> 
> 赞同：1
> 
> 时间：2009-05-23T11:56:47.810
> 
> 标签：vba, outlook, keyboard-shortcuts, imap

我正在使用 Outlook 通过 IMAP 将邮件与 GMail 同步。

Outlook 转到收件箱 ( `Shift`++ `Ctrl`)的默认快捷方式会`I`打开原始收件箱，而不是新的默认 IMAP 收件箱（我已将其指定为新的 Outlook 默认电子邮件帐户）。

我想创建可以绑定到另一个击键的 VBA 代码，这将打开 IMAP 收件箱。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T12:56:18.147

我认为这样做的唯一方法是在工具栏上创建一个按钮，用于搜索您的 IMAP 文件夹并在其上调用 display。然后，您可以为该按钮分配一个键盘快捷键并使用它。另一种方法是使用winapi挂钩快捷方式并调用您搜索和显示。

76梅尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-07T22:12:14.917

-右键单击桌面-
单击新建 > 快捷方式
-对于 OUTLOOK 2003 类型（包括双引号）：“C:\Program Files\Microsoft Office\OFFICE11\OUTLOOK.EXE” Outlook://SUBSTITUTE-OUTLOOK-INBOX-NAME -这里/收件箱

- 对于 OUTLOOK 2007 类型（包括双引号）：“C:\Program Files\Microsoft Office\OFFICE12\OUTLOOK.EXE” Outlook://SUBSTITUTE-OUTLOOK-INBOX-NAME-HERE/Inbox

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-05T16:11:23.327

希望这仍然与某人有关；添加到dakruhm的答案：

最好将`/recycle`开关添加到命令中。这样，如果 Outlook 已打开，则不会创建新的 Outlook 窗口。（除非您想要创建一个，否则请使用它。）

因此，该命令（适用于 Outlook 2007）如下所示：

```
"C:\Program Files\Microsoft Office\Office12\OUTLOOK.EXE" /recycle Outlook://Gmail IMAP/Inbox 
```

另外，dakruhm 的回答很详细，但是他忘了说需要指定快捷键。我已经检查过了，如果你使用`Ctrl`++ ，在执行命令`Shift`之前`I`似乎会有延迟。因此，我使用`Ctrl`++ ，这需要一些时间来`Alt`适应`I`，但工作得更快。

# python - Python：将多个列表连接到一个句子中

> ID：901412
> 
> 赞同：3
> 
> 时间：2009-05-23T12:01:08.907
> 
> 标签：python, list, join

你好，我有多个列表。例如：

```
[u'This/ABC']
[u'is/ABC']
[u'not/ABC']
[u'even/ABC']
[u'close/ABC']
[u'to/ABC']
[u'funny/ABC']
[u'./ABC']

[u'O/ABC']
[u'noez/ABC']
[u'!/ABC'] 
```

我需要加入这个列表

```
This/ABC is/ABC not/ABC even/ABC close/ABC to/ABC funny/ABC ./ABC

O/ABC noez/ABC !/ABC 
```

请问我该怎么做？是的，中间有空白！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T12:05:16.093

如果将它们全部放在一个列表中，例如这样：

```
a = [
    [u'This/ABC'],
    [u'is/ABC'],
    ...
] 
```

您可以通过添加所有列表并在结果上使用常规连接来获得结果：

```
result = ' '.join(sum(a, [])) 
```

* * *

在重新阅读了几次问题之后，我想你也想要那个空行。这几乎是一样的。添加：

```
b = [
    [u'O/ABC'],
    [u'HAI/ABC'],
    ...
]

lines = [a, b]

result = '\n\n'.join([' '.join(sum(line, [])) for line in lines]) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T14:34:35.073

要加入列表，请尝试模块 itertools 中的链功能，例如，您可以尝试

```
import itertools
print ' '.join(itertools.chain(mylist)) 
```

如果两个列表之间的新行是有意的，则在第一个列表的末尾添加 '\n'

```
import itertools
a = [[u'This/ABZ'], [u'is/ABZ'], ....]
b = [[u'O/ABZ'], [u'O/noez'], ...]
a.append('\n')

print ' '.join(itertools.chain(a + b)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T12:06:55.183

简单的：

```
x = [[u'O/ABC'], [u'noez/ABC'], [u'!/ABC']] 
print ' '.join(y[0] for y in x) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T12:06:26.730

如果将所有列表放在一个列表中，则可以这样做：

```
' '.join(e[0] for e in [[u'This/ABC'], [u'is/ABC']]) 
```

# qt4 - Qt programname.exe 退出并显示代码 -1073741819 我该如何解决这个问题？

> ID：901424
> 
> 赞同：8
> 
> 时间：2009-05-23T12:08:22.047
> 
> 标签：qt4, opencv

我正在尝试将 Qt 与 OpenCV 集成。

这是示例：http www opendesktop org/content/show.php/Qt+Opencv+webcam+viewer?content=89995

但功能：

```
 putImage(IplImage* cvimage) 
```

给出退出错误代码：1073741819，以下任何地方..：

```
 cvimage->depth 
```

..正在使用。

如何防止发生此错误？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-07-02T08:37:51.790

您在十六进制中引用的错误号是 0xC0000005，表示 Windows 中的访问冲突。访问冲突意味着您的进程试图访问不属于它的内存（即取消引用指针）。很可能 cvimage 不是一个有效的指针，因此取消引用该指针会导致您的错误。

编辑：堆栈溢出将导致应用程序突然退出。

有关如何编写异常处理程序的说明，请参阅[这篇文章，该处理程序将告诉您崩溃是什么。](http://support.microsoft.com/kb/315937)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-19T22:56:43.657

那么也许你没有从你的主函数返回任何值？对我来说，它看起来像“未初始化的值”

# objective-c - 在 Objective c 代码中查找异常

> ID：901430
> 
> 赞同：1
> 
> 时间：2009-05-23T12:13:05.313
> 
> 标签：objective-c, iphone, xcode

我正在使用 X-code 3.1 iphone SDK 3.0 beta 5 在 iphone (OS 2.0) 上调试我的应用程序。我的应用程序崩溃并给出消息 *** 由于未捕获的异常 'NSRangeException' 而终止应用程序，原因：'*** -[NSCFArray insertObject:atIndex:]: index (8) beyond bounds (8)' 2009-05-23 17:13:32.304 myApp [405:5a07] 堆栈：（808163835、806099672、807978623、807978527、812332907、812067179、812067103、126035、812081649、812081343、82652）

在 gdb 中，当我发出命令 (gdb) 信息行 126035 行号 126035 超出“/Users/videomac/manish/EXPLab/2009-05-18-12-27 myApp/main.m”的范围。

(gdb) info line *126035 Line 527 of "/Users/videomac/manish/EXPLab/2009-05-18-12-27 myApp/Classes/PlaybackThread/Playback.m" 从地址 0x1ec52 <-[Playback startPlaybackThread:] 开始+514> 并在 0x1ec6a <-[Playback startPlaybackThread:]+538> 处结束。

这是否意味着崩溃是由于我的方法 [Playback startPlaybackThread:] 中的代码造成的，那么 no +514 和 +538 的含义是什么？它们是否表示行号？

有没有其他方法可以找到崩溃的原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T21:15:20.267

查找异常发生位置的最简单方法是在 gdb 中的 -[NSException raise] 和 objc_exception_throw 上设置断点。然后你会在它发生时立即中断，你可以在那个时候检查堆栈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T12:38:27.007

关于您提到的第一个错误，来自[-insertObject:atIndex:](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMutableArray/insertObject:atIndex:)文档：

> **重要提示**： 如果*index*大于数组中的元素数，则引发[NSRangeException 。](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Constants/Reference/reference.html#//apple_ref/doc/c_ref/NSRangeException)

 *我会查找此方法的调用，试图找出导致错误的方法。

数字 +514 和 +538 给出了与之前指令代码的偏移量。

# jquery - 如何阻止 jQuery 函数相互干扰？

> ID：901433
> 
> 赞同：1
> 
> 时间：2009-05-23T12:13:48.850
> 
> 标签：jquery, ajax

我有两个独立（但相似）的 jQuery 代码。他们都工作，但互相干扰。如何正确格式化这些函数以使其具有唯一性并阻止它们相互影响？

> **代码块 1：**

```
$('#share-email').click(function (e) {
    e.preventDefault();
    $("#socialbox-" + $(this).attr('rel')).load('<?php echo site_url();?>club/sendtofriend/' + $(this).attr('rel'));
    return false;
});

$().ajaxSend(function (r, s) {
    $(".social-share-container").fadeOut('fast');
});

$().ajaxStop(function (r, s) {
    $(".social-share-container").fadeIn('fast');
}); 
```

> **代码块 2：**

```
$('.djlink').click(function (e) {
    e.preventDefault();
    $("#djinfo").load($(this).attr('href'), Cufon.refresh);
    return false;
});

$().ajaxSend(function (r, s) {
    $("#djinfo").fadeOut('fast');
});

$().ajaxStop(function (r, s) {
    $("#djinfo").fadeIn('fast');
}); 
```

似乎重叠的代码部分是 ajax 发送/停止部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T12:19:04.223

如果我猜对了你想要做什么，这样的事情应该可以解决：

```
 $('#share-email').click(function(e) {
        e.preventDefault();
        $("#socialbox-" + $(this).attr('rel')).fadeOut('fast').load('<?php echo site_url();?>club/sendtofriend/' + $(this).attr('rel'), function() {
            $(this).fadeIn('fast')
        });
        return false;
    });

    $('.djlink').click(function(e) {
        e.preventDefault();
        $("#djinfo").fadeOut('fast').load($(this).attr('href'), function() {
            Cufon.refresh();
            $(this).fadeIn('fast');
        });
        return false;
    }); 
```

# vba - 如何使用 VBA 从 Excel 中的公式中获取单元格值？

> ID：901440
> 
> 赞同：5
> 
> 时间：2009-05-23T12:21:16.620
> 
> 标签：vba, excel-2003

我在工作表的一系列单元格中有一个公式，它计算为数值。如何从传递给函数的范围中获取 VBA 中的数值？

假设工作表中 A 列的前 10 行包含 rand() 并且我将其作为参数传递给我的函数...

```
public Function X(data as Range) as double

    for c in data.Cells
        c.Value    'This is always Empty
        c.Value2   'This is always Empty
        c.Formula  'This contains RAND()
    next

end Function 
```

我从一个单元格调用函数......

```
=X(a1:a10) 
```

如何获得单元格值，例如 0.62933645？

Excel 2003, VB6

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T12:44:34.157

从 VBA (Excel 2003) 运行时，以下代码适用于我：

```
Public Function X(data As Range) As Double

For Each c In data.Cells
    a = c.Value     'This works
    b = c.Value2    'This works too (same value)
    f = c.Formula   'This contains =RAND()
Next

End Function 
```

a 和 b 相同且等于我传入的内容（这是其中包含 Rand() 的单元格范围）。我不确定这里还有什么。

啊哈！你需要设置X，不是吗？我不确定你希望这个函数做什么，但你需要将 X （函数的名称）设置为你想要返回的值。添加这一行：

```
X = a 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T08:54:41.440

我无法使用您发布的布局复制问题。我注意到您发布的代码中有一些语法错误（即：“for”应该是“for each”）。但是当我将 =RAND() 放入 A1:A10 和 =X(A1:A10) 时，我得到了一个很好的回报：

```
Public Function X(data As Range) As Double
    Dim c As Excel.Range
    Dim sum As Double
    For Each c In data.Cells
        sum = sum + c.Value
    Next
    X = sum
End Function 
```

但是，只是为了进一步扩展您遇到的其他一些问题。您可以评估公式的结果，如下所示：

```
Public Function X(data As Range) As Double
    Dim c As Excel.Range
    Dim sum As Double
    For Each c In data.Cells
        sum = sum + Excel.Evaluate(c.Formula)
    Next
    X = sum
End Function 
```

*但一般来说你不会想要*，因为这基本上是计算相同的值两次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-17T01:13:48.977

确保在请求值之前进行计算。

为了加快宏的速度，通常会执行以下操作..

```
'Set Reasonable default
Application.CutCopyMode = False
Application.ScreenUpdating = False
Application.Interactive = False
Application.Calculation = xlCalculationManual 
```

在这种状态下，您必须在值可用之前强制计算。

```
Public Function X(data As Range) As Double
    'You may need the following as well
    'Application.Calculate
    Dim c As Range
    For Each c In data.Cells
        c.Calculate
        c.Value    'This is now has a value
        c.Value2   'This is now has a value
        c.Formula  'This contains RAND()
    Next
End Function 
```

# php - 推荐一个Linux或基于浏览器的维恩图绘制工具

> ID：901447
> 
> 赞同：0
> 
> 时间：2009-05-23T12:26:23.180
> 
> 标签：php, flash, charts, venn-diagram

我正在寻找一种工具来绘制好看的[维恩图](http://en.wikipedia.org/wiki/Venn_diagram)，用于基于 Linux 的 PHP 站点，该站点已经使用 Flash 进行图形绘制（[打开 Flash 图表 2](http://teethgrinder.co.uk/open-flash-chart-2/)）。免费（如啤酒或演讲）会很好，但不是必需的。

所以它应该是以下之一（按照我的粗略偏好顺序）：

*   基于浏览器 (Flash)
*   PHP 库
*   Linux 命令行应用程序
*   网络服务

到目前为止，我知道的选项是：

*   [谷歌图表](http://code.google.com/apis/chart/types.html#venn)
*   使用[PHP GD](http://php.net/manual/en/book.image.php)或 Flash自己编写一些东西

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-06-15T21:44:56.167

使用[文尼](http://bioinfogp.cnb.csic.es/tools/venny/index.html)

非常易于使用，最多可容纳四组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T12:35:05.050

使用[谷歌图表 api](http://code.google.com/apis/chart/types.html#venn)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-23T12:35:49.557

使用[PHP GD](http://php.net/manual/en/book.image.php)或 Flash 自己编写一些东西。

# asp.net - 将 ASP.NET MVC 应用程序转换为网站

> ID：901448
> 
> 赞同：1
> 
> 时间：2009-05-23T12:29:53.703
> 
> 标签：asp.net, asp.net-mvc

我将如何在 ASP.NET 标准网站模型中使用 MVC 框架，而不是 Web*应用程序*模型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T12:35:09.743

[这里](http://pietschsoft.com/post/2008/08/15/How-To-Use-ASPNET-MVC-in-Website-rather-than-Web-Application-Project.aspx "如何在网站而不是 Web 应用程序项目中使用 ASP.NET MVC")解释了如何。

# ddd-repositories - DDD：在哪里获取值对象列表最合适

> ID：901462
> 
> 赞同：4
> 
> 时间：2009-05-23T12:38:05.870
> 
> 标签：ddd-repositories

我有一个分配给产品的名为“产品类型”的值类型。（一个产品有一个产品类型）

为了允许用户从列表中选择类型，我将填写一个下拉列表。在哪里检索产品类型列表最合适？一个实现存储库模式的类？

编辑：通过将产品代码更改为产品类型来澄清。产品类型类似于“DVD”/“CD”/“蓝光”/等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T13:50:25.007

产品似乎是聚合根，所以产品类型列表应该在 ProductRepository 中。

# iphone - 代码与。界面生成器 Iphone

> ID：901465
> 
> 赞同：0
> 
> 时间：2009-05-23T12:38:40.267
> 
> 标签：iphone

我正在阅读《Beginning Iphone Development Apress》一书，并且在构建 NIB 文件时经常遇到问题。由于 NIBS，我的练习应用程序崩溃了。我现在这样做是因为我将把我的换成样本，应用程序就可以工作了。我将查看示例笔尖，我的所有连接都是相同的。我在调试 NIBS 并找出问题所在时遇到问题。所以...

1) 你能在 IB 中设计你的界面并在 Code 中完成所有的接线吗？

2) 找出您的 NIB 有什么问题的最佳方法是什么？

3）其他人在做 Apress 书中的例子时有同样的问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T13:34:18.753

> 1) 你能在 IB 中设计你的界面并在 Code 中完成所有的接线吗？

你可以，但它的工作量更大。如果您不想使用 IB，那么在代码中做所有事情是一个更好的选择。

> 2) 找出您的 NIB 有什么问题的最佳方法是什么？

检查每个控件并检查所有参考出口 (Command-2) 和类标识 (Command-4)。

检查 IBActions 和 IBOutlets 的接口、实现以及正确加载顺序的实现。（即如果使用 IB 则在 viewDidLoad 中初始化您的视图）

> 3）其他人在做 Apress 书中的例子时有同样的问题吗？

不

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T14:57:04.263

Interface Builder 将通过在 NIB 文档窗口的右下角显示警报图标来指示 NIB 文件中的错误和警告。单击它以查看警告是什么。

您可以放心地忽略“非法几何”警告，但缺少出口等可能是致命的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T21:12:28.683

如果你愿意，你可以完全用代码构建你的 UI。我个人更喜欢这种方式，并且只使用 NIB 文件来处理有很多需要定位的项目的视图。

我推荐 Erica Sadun 的[*The iPhone Developer's Cookbook*](https://rads.stackoverflow.com/amzn/click/com/0321555457)以获得一个很好的教程，向您展示如何做到这一点。我在[这里](http://blog.ablepear.com/2009/03/book-review-iphone-developers-cookbook_05.html)写了一篇评论。

NIB 显然占有一席之地，许多开发人员更喜欢使用像 Interface Builder 这样的可视化工具来连接。但是我们中的一些人（比如我）宁愿在可行的情况下用代码做事。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T15:58:47.320

如果您的应用程序“由于 NIBS 而崩溃”，那么当崩溃发生时您会收到什么样的错误消息？如果您查看 Xcode 控制台，通常会有相当大的线索表明问题所在，通常这是开始找出导致崩溃的原因的最佳方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-08T07:39:22.607

我和你一样都是新手，但发现这篇文章建议在两者之间取得平衡，并用一个例子来说明：

[http://wiresareobsolete.com/wordpress/2010/03/striking-the-balance-interface-builder-vs-code/](http://wiresareobsolete.com/wordpress/2010/03/striking-the-balance-interface-builder-vs-code/)

# logic - 具体领域究竟可以用来描述什么？

> ID：901466
> 
> 赞同：2
> 
> 时间：2009-05-23T12:38:47.973
> 
> 标签：logic

我已经阅读了“具体域”的正式定义，但我仍然不太明白。

有人可以用更简单的术语向我解释一下，最好是一些例子吗？

该定义可在 Ullrich Hustadt、Boris Motik、Ulrike Sattler的“ [*Reasoning in Description Logics with a Concrete Domain in the Resolution of Resolution”中找到。*](http://www.fzi.de/KCMS/kcms_file.php?action=link&id=403)第 1 页，定义 1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T13:09:56.897

我自己对谓词逻辑不是很好，但对你的问题很感兴趣，所以我阅读并从“描述逻辑手册”的第 6.2.1 部分中对具体域的概念有了相当好的概述，它有一些例子也。

我是新用户，无法发布链接，但您可以通过在 Google 上搜索“具体域”找到这本书（查找 books.google.com）。

我希望它有所帮助，我发现正式的定义也很难得到！6.2.1 部分的开头很适合作为本书的介绍。

祝你好运！

# objective-c - 你用过的 NSLog 有哪些独特的用途？

> ID：901469
> 
> 赞同：0
> 
> 时间：2009-05-23T12:42:50.213
> 
> 标签：objective-c, cocoa, nslog

您用于调试的 NSLog 有什么独特或特殊的用途吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-23T15:32:46.127

我喜欢使用这种格式进行调试。

```
NSLog( @"<%p %@:(%d)> %@", self, [[NSString stringWithUTF8String:__FILE__] lastPathComponent], __LINE__, [NSString stringWithFormat:(s), ##__VA_ARGS__] ) 
```

当然，您需要将其包装在您自己的方法或函数中以方便使用。我使用预处理器，并且只为我自己的使用和我发送给 beta 测试人员的特殊版本启用它。[顺便说一句，这是从我对这个](https://stackoverflow.com/questions/300673/is-it-true-that-one-should-not-use-nslog-on-production-code/302246#302246)问题的回答中复制而来的。

```
#define DEBUG_MODE

#ifdef DEBUG_MODE
    #define DebugLog( s, ... ) NSLog( @"<%p %@:(%d)> %@", self, [[NSString stringWithUTF8String:__FILE__] lastPathComponent], __LINE__, [NSString stringWithFormat:(s), ##__VA_ARGS__] )
#else
    #define DebugLog( s, ... ) 
#endif 
```

这使得`DebugLog`行为就像`NSLog`，但显示文件名和行号，它被调用：

```
2009-05-23 17:23:40.920 myproject[92523:10b] <AppCon.m:(8)> My debug message... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T18:07:47.743

我使用一些带有 NSLog 的宏来快速调试 cocoa 的`NSPoint`、`NSSize`和`NSRect`struct 的内容：

```
#define LogPoint(POINT) CMLog(@"%s: (%0.0f, %0.0f)",\
                              #POINT, POINT.x, POINT.y)

#define LogSize(SIZE) CMLog(@"%s: %0.0f x %0.0f",\
                            #SIZE, SIZE.width, SIZE.height)

#define LogRect(RECT) CMLog(@"%s: (%0.0f, %0.0f) %0.0f x %0.0f",\
                            #RECT, RECT.origin.x, RECT.origin.y,\
                            RECT.size.width, RECT.size.height) 
```

这些可以按如下方式使用：

```
LogPoint(somePoint);
LogSize(someSize);
LogRect(someRect); 
```

它们产生以下输出：

```
somePoint: (100, 200)
someSize: 12 x 440
someRect: (120, 240) 326 x 74 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T18:14:49.027

```
NSLog(@"%s", __func__); 
```

打印当前方法签名或函数名。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-23T18:15:00.587

这不是 NSLog 的特性，但是它与 NSLog 一起使用非常方便：您可以使用 %@ 占位符来表示对象，并且将显示它们的描述：

```
NSLog (@"The object is %@", someKindOfObjectWhichYouWantToDisplay); 
```

例如，通过这种方式，您可以快速查看返回的对象。这通过向“描述”选择器发送一个对象来工作，当然，它可以在您自己的对象中实现。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-23T18:25:50.507

这是一个可以让您缩进调试日志的某些部分以使内容更具可读性的方法：

```
// MyDebugStuff.h:
void MyLog_Indent();
void MyLog_Outdent();
void MyLog(NSString * format, ...);

// MyDebugStuff.m:
int logIndentLevel = 0;

void MyLog_Indent()  { logIndentLevel++; }
void MyLog_Outdent() { if (logIndentLevel > 0) { logIndentLevel--; } }

void MyLog(NSString * format, ...)
{
    va_list args;
    va_start(args, format);

    NSString * indentString = [[NSString stringWithString:@""]
                     stringByPaddingToLength:(2*LogIndentLevel)
                                  withString:@" "
                             startingAtIndex:0];

    NSLogv([NSString stringWithFormat:@"%@%@", indentString, format], args);

    va_end(args);
} 
```

这可以像这样使用：

```
MyLog(@"Hello, world");
MyLog_Indent();
MyLog(@"Step 1");
MyLog(@"Step 2");
MyLog_Indent();
MyLog(@"Step 2a");
MyLog(@"Step 2b");
MyLog_Outdent();
MyLog(@"Step 3");
MyLog_Outdent();
MyLog(@"Goodbye, cruel world!"); 
```

并将产生：

```
你好世界
  第1步
  第2步
    步骤 2a
    步骤 2b
  第 3 步
再见，残酷的世界！

```

# c# - 有没有办法测试潜在的僵尸事务，看看它是否可以回滚？

> ID：901471
> 
> 赞同：4
> 
> 时间：2009-05-23T12:45:48.193
> 
> 标签：c#, .net, ado.net, transactions, rollback

如果 sql 调用失败，比如由于死锁而超时，事务可能会变成僵尸事务——我猜我的代码或框架代码会回滚。SqlTransaction 不为空，但如果您尝试执行 Rollback()，它是一个僵尸可能会引发错误。我找不到 .IsZombie 属性。

```
// Make sure the transaction is not null
if (transaction != null)
{
    //TODO: Is there a way to test a transaction to see if it can be rolled back?
    transaction.Rollback();  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T17:17:06.080

您可以尝试使用 .NET 2.0 的 System.Transactions 命名空间中的 TransactionScope 类。此类允许您指定超时时间，在该超时时间之后事务将自动取消并回滚。.NET 2.0+ 中的 ADO.NET 支持 TransactionScope，如果在调用数据库时存在 DbTransaction，它将自动在范围内注册一个 DbTransaction：

```
public void DoSomething()
{
    using (TransactionScope scope = new TransactionScope(TransactionScopeOptions.Required, TimeSpan.FromSeconds(60)))
    {
        MyDac();

        scope.Complete(); // If timeout occurrs, this line is never hit, scope is disposed, which causes rollback if Complete() was not called
    }
}

public class MyDac()
{

    using (SqlConnection ...)
    {
        using (SqlCommand ...)
        {
            // Do something with ADO.NET here...it will autoenroll if a transaction scope is present
        }
    }
} 
```

TransactionScope 在内部创建一个 System.Transactions.Transaction，如果只涉及单个服务器，则默认情况下允许对 SQL Server 进行轻量级事务。如果事务涉及多个服务器或分布式资源管理器，TransactionScope封装的Transaction会被提升为分布式事务，这需要MSDTC协调，这会使TransactionScope的使用变得复杂。如果您的所有事务都是轻量级的，那么 TransactionScope 可以比手动管理您的数据库事务提供很多好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-21T11:08:05.660

我请你原谅，但我无法避免不同意。客户事务使业务流程原子操作成为可能。如果您想将所有事务操作移入 DB，则总是将业务逻辑移入其中。这是一种方法，但如果您将在程序中使用一些稍微复杂的逻辑，则强烈不推荐。有 while/for/foreachs、字符串检查和其他琐碎的操作真的很繁重，要移入 DB（有时甚至是不可能的）。然而，死锁提示似乎非常有用，并为客户端应用程序提供了进一步的控制（在我看来，这是最好的方法）。

干杯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-01T17:00:53.783

我知道的老问题，但我最近正在处理这个问题，并为自己创建了一个小助手函数来安全地提交/回滚 SqlTransactions。我想我会发布它，以防其他人正在寻找这个问题的解决方案。

```
public void CompleteTransaction(SqlTransaction transaction, bool isRollback) {
    if (transaction == null) { return; }
    try {
        if (isRollback) { 
            transaction.Rollback(); 
        } else { 
            transaction.Commit(); 
        }
    } catch (InvalidOperationException ex) {
        // In my case, I just ignored exceptions due to zombie transactions, 
        // but you could handle it differently depending on your needs
        if (ex.TargetSite == null || ex.TargetSite.ToString() != "Void ZombieCheck()") {
            throw; // Not a zombie transaction, so re-throw the exception
        }
    }
} 
```

当我检查因僵尸事务引发的异常抛出的异常详细信息时，我注意到 TargetSite 是`Void ZombieCheck()`，因此我的解决方案假定如果 TargetSite 未设置为该值，则它不是由于僵尸事务而导致的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T12:57:04.600

您可能需要考虑将事务处理代码放在数据库中，然后您可以测试@@ERROR = 1205 以确定您的查询是否是死锁的受害者，在这种情况下您可以重试或回滚。允许客户端应用程序创建和管理事务有点冒险，如果可能的话最好避免。

希望这可以帮助，

账单

# django - Eclipse/PyDev + Django 调试

> ID：901472
> 
> 赞同：4
> 
> 时间：2009-05-23T12:45:51.547
> 
> 标签：django, debugging, pydev

Eclipse/PyDev、Python 2.6、Django 1.1

一切都在运行模式下工作。如果我将调试点放在 manage.py 文件中，断点就会起作用。但是当我把它放在任何动作方法中时，它什么都不会产生:(

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-01-06T23:48:00.603

通常问题是您在 django 中使用自动重新加载运行，在这种情况下，实际上是由不同的进程提供页面，因此，您需要使用 no reload 选项运行它或使用远程调试器。

（要配置 PyDev 以使用 Django，请参阅： http: [//pydev.org/manual_adv_django.html](http://pydev.org/manual_adv_django.html)）

请注意，如果您想在没有自动重新加载功能的情况下执行（当您创建新的 Django 运行时 PyDev 应该自动执行此功能），您可以直接执行所有操作（即：调试器和启动不需要任何特殊调整）。

* * *

**注意**：最近情况有所改善，因此，尽管上述答案仍然有效，但对于那些确实希望通过自动重新加载进行开发的人来说，还是有一些改进：

* * *

回答自动重新加载：

如果您想在开发时自动重新加载，请使用以下提示：[PyDev 和 Django：如何重新启动开发服务器？](https://stackoverflow.com/questions/2746512/pydev-and-django-how-to-restart-dev-server/7648375#7648375)（以克服当主进程被杀死时 Django 将使子进程保持活动状态的问题）

并查看与远程调试器相关的会话：http: [//pydev.org/manual_adv_remote_debugger.html](http://pydev.org/manual_adv_remote_debugger.html)以了解如何在使用自动重新加载功能时将调试器附加到 PyDev（主要是，您需要启动远程调试器，但会定期添加断点，如果您在主会话之前调用 pydevd.patch_django_autoreload()，PyDev 将停止这些断点 - 即：) `before if __name__ == "__main__":, add the following: import pydevd;pydevd.patch_django_autoreload()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-14T17:10:28.553

如果在尝试导入 pydevd 时，eclipse 找不到 pydevd 依赖关系。确保从您的插件文件夹中添加它：

*   查找您的 eclipse/plugins/org.python.pydev_ **x.xx** /pysrc，其中**xxx**是您的 eclipse pydev 插件版本。在 eclipse/plugins 文件夹中，您会发现许多以相似名称开头的文件夹，其中只有一个具有 pysrc 子文件夹（**和**正确的版本号）。
*   将 eclipse/plugins/org.python.pydev_ **x.xx** /pysrc 添加到项目的外部库中：
    *   右键单击您的项目资源管理器。
    *   转到 properties/PyDev - PYTHONPATH/External Libraries/ 并单击*Add Source folder*。
    *   在提供的浏览器上找到您的 eclipse/plugins/org.python.pydev_ **x.xx** /pysrc 文件夹。

# c++ - 读取 Unicode 文件 C++

> ID：901473
> 
> 赞同：7
> 
> 时间：2009-05-23T12:45:56.993
> 
> 标签：c++, visual-c++, unicode, file, utf-16

我有一个简单的问题要问。我有一个以 FFFE 开头的 UTF 16 文本文件可供阅读。处理这种文件的 C++ 工具有哪些？我只想阅读它，过滤一些行并显示结果。

它看起来很简单，但我只是有处理普通 ascci 文件的经验，而且我很着急。我正在使用 VS C++，但我不想使用托管 C++。

问候

这里放一个非常简单的例子

```
wifstream file; 
file.open("C:\\appLog.txt", ios::in);

wchar_t buffer[2048]; 
file.seekg(2);
file.getline(buffer, bSize-1);

wprintf(L"%s\n", buffer);
file.close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T13:04:09.233

您可以使用[fgetws](https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/fgets-fgetws)，它读取 16 位字符。您的文件采用小端字节序。由于 x86 机器也是 little-endian，因此您应该能够轻松处理文件。当您想要输出时，请使用[fwprintf](https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/fprintf-fprintf-l-fwprintf-fwprintf-l)。

另外，我同意更多信息可能有用。例如，您可能正在使用一个抽象出其中一些内容的库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T14:31:04.020

由于您很着急，请在二进制模式下使用 ifstream 并完成您的工作。我和你有同样的问题，这挽救了我的一天。*（这不是推荐的解决方案，当然，它只是一个 hack）*

```
 ifstream file; 
  file.open("k:/test.txt", ifstream::in|ifstream::binary);

  wchar_t buffer[2048]; 
  file.seekg(2);
  file.read((char*)buffer, line_length);
  wprintf(L"%s\n", buffer);
  file.close(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T12:56:15.770

对于它的价值，我想我已经读过您必须使用允许您指定编码的 Microsoft 功能。

[http://msdn.microsoft.com/en-us/library/z5hh6ee9(VS.80).aspx](http://msdn.microsoft.com/en-us/library/z5hh6ee9(VS.80).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T12:52:40.520

FFFE 只是初始 BOM（字节顺序标记）。像往常一样从文件中读取，但读取到一个宽字符缓冲区。

# ajax - tomcat 是否有任何等效的 mod_proxy？

> ID：901475
> 
> 赞同：0
> 
> 时间：2009-05-23T12:46:36.850
> 
> 标签：ajax, tomcat, mod-proxy

我正在尝试在 tomcat 5.5 上运行修改后的 JWChat（一个简单的基于 javascript 的 jabber 客户端）。此应用程序基于 ajax，并使用 http 绑定来与 jabber 服务器通信（我使用的是 openfire）。在 apache 服务器上运行它时，它需要使用 mod_proxy 将请求重定向到 http-bind 并且它可以工作。有没有其他方法可以在tomcat上做同样的事情？我尝试了 UrlRewriteFilter，到目前为止没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T12:52:04.547

[这](http://edwardstx.net/wiki/Wiki.jsp?page=HttpProxyServlet)是一个很好的可用选项以及功能性 HTTP 代理 servlet 的源代码，看起来可以满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T12:53:38.913

你总是可以在你的 web 应用程序前面放置一个透明的 apache 代理。这有额外的好处，比如缓存、重写、负载平衡、虚拟主机管理等。并不是说 Tomcat 不能做这些事情，只是说 apache 擅长这些事情并且有据可查。

它比你想象的要容易得多，你甚至可以将它与你的重写结合起来

```
# Proxy and Caching. Only proxy dynamic documents if this
# is the application server (or we waste disk space).
# [L] = Last rule [P] = Proxy
RewriteEngine On
RewriteRule \.(css|js|pdf|gif|jpg|png|swf|mp4|zip|exe)$ - [L]
RewriteRule (.*) http://www.yoursite.com:8000$1 [P]
CacheRoot "/var/www/cache/www.yoursite.com"
CacheSize 2000000 
```

# c - PECL 安装失败

> ID：901476
> 
> 赞同：8
> 
> 时间：2009-05-23T12:47:18.970
> 
> 标签：c, centos, pear, pecl

我浏览了每一个谷歌结果，阅读了所有关于这个错误的论坛帖子，但我无法解决它。

当使用 PECL 安装任何东西时，我总是会收到这个错误：

```
checking whether the C compiler works... configure: error: cannot run C compiled programs. 
```

到那时为止，其他一切都成功了，他们砰！

我使用的是 CentOS 4.3，PEAR 是最新的稳定版本，GCC 是稳定的最新版本。一切正常，但 C 编译器似乎总是出错。我试图通过临时启用它来使 tmp 具有操作的正确权限：

```
mount -o remount,exec,suid /tmp 
```

但这不起作用。

我确实尝试了所有建议的方法，但均无济于事。有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-11-21T03:24:48.837

我在 Centos 5.3 上，通过删除 /tmp*和*/var/tmp上的 noexec 标志，我能够成功运行 PECL 安装程序（在我的情况下是 APC）

```
mount -o remount,exec,suid /tmp
mount -o remount,exec,suid /var/tmp 
```

仅在 /tmp 上执行此操作不起作用 - 我仍然收到错误“检查 C 编译器是否工作......配置：错误：无法运行 C 编译程序。”

请记住在安装完成后使用 noexec 再次运行这些重新安装。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-25T13:34:48.313

```
cd ~
mkdir setups
cd setups
wget http://pecl.php.net/get/APC-3.1.2.tgz
tar -xvf APC-3.1.2.tgz
cd APC-3.1.2
phpize && ./configure --with-apxs && make 
```

我很快把它写下来，并且能够通过一些手动工作来安装 APC。例如将模块复制到 PHP 模块中，并在 php.ini 中添加扩展名。现在完美运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-13T19:00:40.650

当我在安装 MongoDB 驱动程序时遇到类似问题时，这对我有用：

```
sudo mkdir /root/tmp.pear
sudo mkdir /root/tmp.pear-build-root

sudo ln -s /root/tmp.pear /tmp/pear
sudo ln -s /root/tmp.pear-build-root /tmp/pear-build-root 
```

然后：

```
sudo sudo pecl install XXX 
```

（这不会打开安全漏洞，因为只有 root 可以在这两个目录中创建可执行文件。）

请注意，以下内容不适**用于**PECL：

```
sudo pear config-set temp_dir /var/tmp/pear/temp 
```

# mysql - 如何在嵌套 SELECT 中存储结果行数？

> ID：901481
> 
> 赞同：1
> 
> 时间：2009-05-23T12:49:37.437
> 
> 标签：mysql

我有一个 MySQL 查询，其中有一个嵌套的 SELECT，它向父级返回一个数组：

```
SELECT ...
FROM ...
WHERE ... IN (SELECT .... etc) 
```

我想存储来自嵌套 SELECT 的返回结果的数量（行数），但是执行 IN (SELECT count(...), columnA) 之类的操作不起作用，因为 IN 只需要一个结果。

有没有办法存储返回的结果计数以供以后在父语句中使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T13:16:29.460

您可能必须将嵌套语句的结果选择到临时表中。然后你可以做一个 IN 并在以后计数。我更熟悉 MS-SQL，但我认为你应该能够这样做：

```
CREATE TEMPORARY TABLE tmp_table AS
SELECT something
FROM your_table;

SELECT ...
FROM ...
WHERE ... IN (SELECT * FROM tmp_table);

SELECT count(*) FROM tmp_table; 
```

如果这不起作用，您可能必须向临时表创建语句提供完整的详细信息，就像使用普通的“CREATE TABLE”一样。请参阅MySQL 手册中的此处，以及[此处](http://dev.mysql.com/doc/refman/5.1/en/create-table.html)[的](http://www.java2s.com/Code/SQL/Table-Index/UsingTemporaryTables.htm)类似示例。

```
CREATE TEMPORARY TABLE tmp_table
(
    tableid INT,
    somedata VARCHAR(50)
);

INSERT INTO tmp_table
SELECT ...
FROM ...

SELECT ...
FROM ...
WHERE ... IN (SELECT * FROM tmp_table);

SELECT count(*) FROM tmp_table; 
```

富有的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T13:22:47.777

您在评论中提到您的查询如下所示：

```
SELECT
  tabA.colA,
  tabA.colB
FROM tabA
WHERE tabA.colA IN ( SELECT tabA.colA FROM tabA WHERE tabA.colB = 1 ) 
```

我可能遗漏了一些东西，但您不需要子查询。为什么不在常规条件下执行此操作：

```
SELECT
  tabA.colA,
  tabA.colB,
FROM tabA
WHERE tabA.colB = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T14:34:08.490

您可以`IN`对多个列使用谓词，如下所示：

```
SELECT  *
FROM    table
WHERE   (col1, col2) IN
        (
        SELECT  col3, col4
        FROM    othertable
        ) 
```

如果要选择`COUNT(*)`每个值，请使用：

```
SELECT  colA, colB, cnt
FROM    (
        SELECT  COUNT(*) AS cnt
        FROM    tabA
        WHERE   colB = 1
        ) q,
        tabA
WHERE   colB = 1 
```

# actionscript-3 - DAE解析器增强现实的问题

> ID：901484
> 
> 赞同：0
> 
> 时间：2009-05-23T12:51:32.597
> 
> 标签：actionscript-3, papervision3d, augmented-reality

我尝试了一切但没有成功。我在导入文件时遇到了很大的问题。很多错误....花了 5 个小时但没有。我成功地能够使用 collada 解析器创建项目，但是当我使用 import org.papervision3d.objects.parsers.DAE 时，所有问题都出现了；丢失了一些文件，当我尝试下载丢失的文件时，它显示我下载的文件中有错误。请建议我如何解决它。我想知道任何人都可以上传您用于创建演示的 papervision+libspark+ascollada 的配置（就像 Brian Hodge 使用的那样）。提前非常感谢。我非常抱歉在 AS3 DAE Augmented Reality PaperVision 3D 线程中发布这个问题作为答案。我是这个论坛的新手，还没有注意到问题标签。非常抱歉......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T00:52:52.077

以下是关于 PV3D/Flar 工具包 AR 的一个相当大的解释的链接

[AS3 DAE 增强现实 PaperVision 3D](https://stackoverflow.com/questions/673059/as3-dae-augmented-reality-papervision-3d)

## -问题

你在开发什么IDE？Flex Builder 3、Flash Develop 和 Flash CS4 都能够使用 Flex 3 SDK 处理嵌入，但是，Adobe Flash CS3 不允许您使用嵌入并且无法识别它。

## -Flash CS3 产生以下

```
TypeError: Error #1007: Instantiation attempted on a non-constructor.
at Untitled_fla::MainTimeline/Untitled_fla::frame1() 
```

## -以下适用于上面列出的所有其他人

```
[Embed(source="foo.jpg")]  //<---  NO SEMICOLON OR BREAKS
private var foo:Class;

var testFoo:Bitmap = new foo(); 
```

## -重要的

我要注意的一件事是，请注意嵌入行上没有分号！

希望这会有所帮助，显然原始发帖人解决了他/她的问题，但想回答 sid。

# java - 如何在java中拆分paint swing方法？

> ID：901489
> 
> 赞同：0
> 
> 时间：2009-05-23T12:54:46.460
> 
> 标签：java, swing, paint, repaint

我正在用java开发一个相当大的医院模拟游戏。现在，我的止痛方法开始看起来有点大，我需要一种方法将它分成不同的部分……我有一个想法，但我不确定这是否是最好的方法。首先是画草，然后是医院大楼，然后是任何建筑物，然后是人，然后是任何建筑物在建造时的预览。草和医院大楼不会改变，所以我只需要画一次。建筑物本身不会经常变化，只有在建造新建筑物时才会发生变化。

我在想，使用布尔值来确定哪些部分需要重新绘制？理想，我希望能够拆分paint方法，然后在需要时调用每个方法，但我不确定如何在物理上拆分它。

我对Java还是很陌生，并且在旅途中学习。

提前致谢。

相对

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T14:59:03.713

另一个想法是为必须在屏幕上绘制的所有项目创建一个超类或接口。让我们对这个类 ScreenObject 进行 cvall。然后，您可以在 ScreenObject 类中指定 draw(Graphics2d g) 方法。接下来，每个必须绘制的对象都实现了 draw() 方法，并且只关心绘制本身。您甚至可以考虑创建一个变量来确定是否应该运行此绘制方法。

在绘制屏幕的主类中，您可以引用 ArrayList 中的所有 ScreenObjects，并且您的 paint() 方法将简单地迭代每个对象上的这个调用 draw()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T13:28:29.590

我从你的描述中假设你的场景被分成了瓷砖。保留一组布尔值是跟踪下次更新时需要重绘哪些图块的好方法。在某些情况下，LinkedList 可能会表现得更好一些。（我正在考虑一个生命游戏模拟，其中有大量的瓷砖要重绘，你需要检查每个邻居，所以你可能不需要走这条路。）

在没有看到您的代码的情况下，我无法就拆分您的绘画方法提供非常具体的建议。我可以告诉你，在 sprite 动画中，每个 sprite 对象通常都有自己的 draw 方法，该方法将主 Graphics 对象（或更可能是缓冲区）作为参数。由于精灵应该知道自己的图像和位置，然后它可以将自己绘制到主图像中。然后，您的paint 方法可以循环遍历需要重绘的精灵列表并调用它们的draw 方法。

您可以查看[Java 中的 Killer Game Programming 以](http://books.google.com/books?id=SVHVgbeMVvoC&pg=PA668&lpg=PA668&dq=java+tilin&source=bl&ots=0kUVW45J42&sig=Nfv0piFeuGQx8YOXzZfALEPQqFs&hl=en&ei=G_cXSsSJOIKMtge-5IT0DA&sa=X&oi=book_result&ct=result&resnum=10#PPP1,M1)获取更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T13:35:01.120

好吧，我并不是真正的编程专家，但为了拆分我的绘画方法，我总是创建一个新方法，它接受一个 Graphics 对象并从绘画中调用它，它总是帮助我保持我的代码有条理，但我从来没有听起来您正在从事的大型项目，因此它可能不适用于您的情况。

# ruby-on-rails - Amazon SQS 是这里的正确选择吗？Rails 性能问题

> ID：901501
> 
> 赞同：5
> 
> 时间：2009-05-23T13:04:05.613
> 
> 标签：ruby-on-rails, backgroundworker, amazon-web-services, amazon-sqs

我即将发布一个具有常见网络功能（消息、墙等）的 Rails 应用程序。我想使用某种后台处理（很可能是 Bj）从请求/响应周期中卸载任务。

当用户通过电子邮件邀请朋友加入并获得电子邮件通知时，就会发生这种情况。

我不确定我是否应该使用模型将这些邀请和通知放入我的数据库中，然后每 x 分钟使用一个工作进程处理它，或者我是否应该使用 Amazon SQS，将消息和邀请存储在那里并让我的工作人员从 Amazon SQS 检索它进行处理（发送邀请/通知）。

亚马逊的方法会从我的数据库中卸载，但我想从那里检索消息会更慢。

你怎么看？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-23T15:57:44.123

您的标题表明您有 Rails 性能问题，但您确定吗？从您的问题的其余部分来看，您似乎正在尝试预测未来可能出现的性能问题。明智地处理性能问题的唯一方法是让您的应用程序投入使用并对其进行分析。这样做将为您提供有关实际性能问题的经验数据。

鉴于 Amazon SQS 不是免费的，而且使用它几乎肯定会增加应用程序的复杂性，如果数据库负载成为问题，我会迁移**到**它**。**不要试图在问题出现之前对其进行第二次猜测，因为您会发现当您的应用程序上线时您可能会面临不同的问题，其中一些您可能没有考虑过。

要点是您已经决定使用后台处理，这是正确的决定，因为任何类型的非即时处理都不属于 Rails 的请求/响应周期，因为它会阻塞 Rails过程。如果需要，您以后可以随时使用 Amazon 进行扩展。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-19T04:19:05.977

您的应用程序是否已经托管在 Amazon EC2 上？我可能不会为了使用 SQS 将现有应用程序迁移到 AWS，但如果您已经在使用 Amazon 的基础设施，那么 SQS 是一个不错的选择。您当然可以设置自己的消息传递系统（例如 RabbitMQ），但是通过使用 SQS，您不必担心这一点。

有很多选项可以向 Rails 应用程序添加后台处理，例如[延迟](http://github.com/tobi/delayed_job)作业或[背景](http://codeforpeople.rubyforge.org/svn/bj/trunk/README)作业，但我个人最喜欢的是[Workling](https://github.com/ascarter/workling)。它为您提供了一个很好的抽象层，允许您插入不同的后台运行器，而无需更改作业的实际实现。

我维护一个[添加 SQS 客户端的 Workling 分支](http://github.com/digitalhobbit/workling)。有一些缺点（请阅读评论或[我的博客文章](http://www.digitalhobbit.com/2009/04/04/workling-and-amazon-sqs/)了解更多详细信息），但总体而言，它在我上次创业时对我们来说效果很好。

我还将 SQS 用于一个单独的 Ruby（非 Rails）项目，并且通常发现它足够可靠且足够快。就像 James 上面指出的那样，您一次最多可以读取 10 条消息，因此您肯定会想要这样做（我的 Workling SQS 客户端会执行此操作并在本地缓冲消息）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T16:05:28.803

我同意 John Topley 的观点，即如果您不需要，您不想让您的应用程序过于复杂。话虽如此，有时尽早做出这种决定是好的，您是否从一开始就预计高负载？您是将其推广到现有的用户群，还是可能会或可能不会起飞的公共网站？

如果您知道从一开始就需要处理大量流量，那么这可能是一个很好的步骤。如果您不想花钱使用 SQS，请查看一些免费的队列解决方案，例如 RabbitMQ。

我目前每月通过 SQS 推送几百万条消息，而且效果很好。确保您计划它不时下降或变慢，因此您需要在一些重试设施和指数退避中工作。一件好事是您一次可以获得 10 条消息，这可以加快处理队列的速度，您可以使用一个请求来获取 10 条消息并逐个处理它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-01-17T18:36:26.423

Amazon SQS 是一项很好的服务，除非以下事项变得重要：

*   表现
*   合法的
*   确认和交易
*   消息惯用语消息属性
*   安全性、真实性和队列
*   权限

如果其中任何一项很重要，您需要查看真正的企业 MQ 服务，例如 StormMQ、RabbitMQ 甚至 onlinemq.com。

我发现这个博客系列很有趣，因为它将 Amazon SQS 与 StormMQ 进行了比较，没有任何回击：http: [//blog.stormmq.com/2011/01/06/apples-and-oranges-performance/](http://blog.stormmq.com/2011/01/06/apples-and-oranges-performance/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-21T12:13:39.687

如果您在迁移到 EC2 时遇到问题，您可以使用其他服务，例如 onlinemq.com。

# java - 创建动态数据输入表单

> ID：901504
> 
> 赞同：0
> 
> 时间：2009-05-23T13:06:49.150
> 
> 标签：java, architecture, forms, dynamic

我有一个小项目，我想在其中生成带有一些逻辑的动态数据输入表单。

一个简单的用例可能是一个 Football 结果表单，因此您有一个用于射手的按钮，当单击时，将提示用户选择一名球员。然后表单将发送带有事件数据的消息（可能发送到 Web 服务，也可能发送到 JMS 队列）。例如巴塞罗那、进球、亨利。

然后我想为网球创建一个类似的表格......

我的想法是创建一个 Web 服务，您可以在其中定义业务逻辑。（事件、组件、您采取的行动等。）最初我以为我会从 web 服务以 xml 发送运动定义。然后编写一个应用程序来解析 xml 并动态创建数据输入屏幕。

我最初是在考虑编写一个 web 服务并返回一个 xml 数据。（这看起来很糟糕）渲染技术可以是 flex/flash 并成为一个瘦客户端。

然后我认为使用 swing 应用程序框架创建表单就像创建 java 应用程序一样容易，这就是要走的路。

然后我想，与其编写一个 xml 模式来描述 java 表单，我可以只序列化一个 java 类并通过网络发送它。

一旦走上这条路，我现在想知道是否应该只是一个 java 框架，并且动态表单成为通过反射调用的类。

我希望得到有关上述方法的反馈，以及 stackoverflow 上的人们如何解决这个问题。

谢谢

大卫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T18:58:04.930

我也会考虑[XForms](http://www.w3schools.com/xforms/default.asp)。它允许您将数据模型和 UI 都定义为 XML，在客户端呈现它所需要的只是一个 Web 浏览器。我假设事件将被提交到远程服务器，这使得 Web 浏览器成为自然的选择。

这将使您能够根据用户想要报告的体育赛事类型在服务器上生成 UI，因此您可以轻松添加新表单、修复错误等，而无需更新客户端软件。

顺便说一句，我不明白您对使用 XML 的担忧。在我看来，这对于您的用例来说是一个可行的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T13:16:49.380

我会避免序列化，因为它有点脆弱，难以安全地进行并且难以诊断。

你说这是一个小项目，那么元数据真的必须从客户端传递到服务器吗？将元数据（真正的代码）简单地编写为 Java 代码不是更好吗？

（FWIW，我的第一个商业 Java 项目是从数据库规范（定期添加）动态创建表单。在此之前，我使用 C++ 运行训练系统的解释器。在这两种情况下，我现在（以及过去十年），已将它们编写为 Java。不要被人们对“硬编码”不满地喃喃自语。）

# asp.net - 如何在 Linq 中使用 2 个字段分组？

> ID：901508
> 
> 赞同：2
> 
> 时间：2009-05-23T13:09:39.190
> 
> 标签：asp.net, linq

如何在 Linq 中使用 2 个字段分组？

```
(from i in info 
 group i by i.OrderId into g 
 select new { orderId = g.Key, infos = g }); 
```

不仅使用订单 ID 进行排序，而且还有两个字段，例如 ...

```
group by i.orderId And i.City 
```

这会怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T13:13:47.060

我相信你想要这样的东西：

```
var result = from i in info
             group i by new { OrderId = i.OrderId, City = i.City } into g
             select new { OrderId = g.Key, Infos = g }; 
```

将密钥创建为匿名类型只允许 LINQ 对匿名类型的所有字段使用默认的相等比较器，这在大多数情况下应该可以完成这项工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T13:21:18.777

作为诺多林回答的后续行动，当匿名类型上的字段名称与您设置的字段匹配时，您可以省略它们。

例子：

```
var result = from i in info
             group i by new { i.OrderId, i.City } into g
             select new { OrderId = g.Key, Infos = g }; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T19:59:59.233

Noldorin 和 Josh Einstein 的回答的另一个后续行动……OrderID 将采用整个密钥……在这种情况下，它是一个具有两个属性 OrderID 和 City 的新对象。如果您的最终结果集需要 OrderID 作为 OrderID，那么您需要执行以下操作：

```
var result = from i in info
             group i by new { i.OrderId, i.City } into g
             select new { OrderId = g.Key.OrderId, Infos = g }; 
```

# asp.net-mvc - 如何编辑表格数据（ASP MVC）

> ID：901509
> 
> 赞同：11
> 
> 时间：2009-05-23T13:09:41.953
> 
> 标签：asp.net-mvc, html-table

我需要能够在浏览器中编辑数据表。

我在 MVCContrib 中看到有一个 HTML 助手来渲染表格。有用...但是如果我希望用户能够编辑该表呢？据我所知，它在那里没有帮助。

解决这个问题的最佳方法是什么？

传统的 FORM 里面有一个 TABLE？如果是这样，MVC 是否足够聪明，可以将发布的数据解析回行集合？无论如何，这将如何运作？

或者也许它应该在单击一行时切换到编辑模式（使用 javascript 等），然后当用户移动到另一行时，调用 AJAX 操作以仅提交一行。我可以想象这里的逻辑可能会变得复杂——这可能仍会使用表单，但我是否必须将其动态插入到 DOM 中？

我还需要能够向该表添加行。我不需要分页支持。

有现成的解决方案吗？

我应该回到网络表单吗？:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T13:50:28.923

查看 Phil Haack 的博客，他在其中描述了如何[建模绑定到列表](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)。

也许这可以帮助？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-01T13:35:13.280

我有同样的问题，我已经找到了解决方案。不要认为它是最漂亮的，但它对我来说是理想的，因为我的要求之一是能够使用 jQuery 的[Jeditable](http://www.appelsiini.net/projects/jeditable)插件编辑表格数据。

所以我使用 MVCContrib 的 Grid<> 扩展生成了一个表：

```
Html.Grid<Somenamespace.Line>( Model.InvoiceLines )
           .Attributes( id => "InvoiceGrid" )
           .Columns( column => {
               column.For( li => li.LineItem.ItemDescription ).Attributes( name => ".LineItem.ItemDescription", @class => "click" );
               column.For( li => li.LineItem.InvoiceUnitNetPrice ).Named( "Unit net price " ).Attributes( name => ".LineItem.InvoiceUnitNetPrice", @class => "click" );
               column.For( li => li.LineItem.InvoiceQuantity ).Attributes( name => ".LineItem.InvoiceQuantity", @class => "click" );
           })
           .Render();  
//rest of the code
Html.Submit("_submit", "Save"); 
```

现在您可以就地编辑值，但不会升级相应的模型。用户点击提交按钮后，所有的魔法都会发生：

```
$(document).ready(function() {
        $('#_submit').click(function(e) {
                e.preventDefault();
                $('#InvoiceGrid tbody tr').each(function(index) {
                    var hidden = $('<input />').attr({ type: 'hidden', name: 'InvoiceLines.Index', value: index });
                    $(this).children('td:first-child').before(hidden);
                    $(this).children('td:not(:first-child)').each(function() {
                        $(this).append($('<input />').attr({ type: 'hidden', value: $(this).text(), name: 'InvoiceLines[' + index + ']' + $(this).attr('name') }));
                    });
                });
                $('form').submit();
            });

            //editable stuff            
            $('.click').editable(function(value, settings) {
                return (value);
            }, { submit: 'OK' });
        }); 
```

在每个 TD 中，我使用来自该 TD 的值创建隐藏输入，在每行输入中使用索引，这里最重要的是“名称”属性：*模型中的集合名称[这里是 index].rest.of.path*，所以在这种特殊情况下（示例）：

```
InvoiceLines[2].LineItem.ItemDescription 
```

希望它会有所帮助，因为丰富的网格并不总是一个答案；）

问候马特乌斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T14:25:56.283

我会先签出一个 javascript UI 库：

*   [ExtJS 网格](http://extjs.com/deploy/dev/examples/grid/edit-grid.html)
*   [雅虎数据表](http://developer.yahoo.com/yui/examples/datatable/dt_cellediting.html)
*   [弹性网格](http://www.flexigrid.info/)

在快速开发丰富的 UI （如可编辑网格）时，WebForms 更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T01:45:44.903

昨晚我实现了一个简单的解决方案：内部表格 + 表格，使用单元格中的输入字段，命名约定如[Phil Haack 的博客](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)中所述（感谢 @BengtBe 的链接）。

它正在工作，但有点繁琐（例如，使用 jquery 添加行需要我计算出下一个未使用的索引）。

所以我还在寻找更多的解决方案。

我发现的一个是[extjs 库](http://extjs.com)，它提供了非常丰富的网格。我还没有弄清楚是否有一种简单的方法可以将网格数据回发到我的一个控制器操作中，但是......

# c# - 如何将匿名类型转换为 Ttype？

> ID：901512
> 
> 赞同：4
> 
> 时间：2009-05-23T13:13:36.967
> 
> 标签：c#

如何使用 Cast() 扩展方法进行上述转换？

例如

```
var aType = anonymousType;

IEnumreable<MyType> = aType.Cast(); 
```

解决者

```
aType.Select(i => new MyType { } ).ToList(); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-23T13:46:09.243

您可以将匿名类型强制转换为的唯一类型是`Object`. 如果您想要任何其他类型，则必须从匿名类型对象中的数据创建这些对象。

例子：

```
List<MyType> items = aType.Select(t => new MyType(t.Some, t.Other)).ToList(); 
```

您应该考虑在`MyType`获取数据时已经创建对象，而不是创建匿名类型的对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T13:22:03.940

是`aType`由`IEnumerable<anonymous type>`例如 linq 查询返回的吗？

您可能希望使用`Select`（将转换函数应用于元素） insted`Cast`仅执行强制转换。

```
IEnumerable<MyType> = aCollection.Select(e => SomeExpressionWithE); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T14:28:56.520

这是一篇可能对您有所帮助的文章。尽管我认为 Guffa 是正确的，但您应该在需要时创建类的实例。匿名类型不应该以这种方式使用。

这是链接： http: [//www.codeproject.com/KB/cs/castinganonymous.aspx](http://www.codeproject.com/KB/cs/castinganonymous.aspx)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-23T13:16:42.063

```
IEnumreable<MyType> n = (IEnumreable<MyType>)aType; 
```

[http://msdn.microsoft.com/en-us/library/ms173105.aspx](http://msdn.microsoft.com/en-us/library/ms173105.aspx)

# php - 用户浏览 index.php 的情况如何解决

> ID：901514
> 
> 赞同：3
> 
> 时间：2009-05-23T13:15:32.550
> 
> 标签：php, zend-framework, zend-framework-mvc

在 Zend 框架中，使用 MVC，如果用户显式[浏览 http://base/url/index.php](http://base/url/index.php)而不仅仅是[http://base/url](http://base/url)，系统认为真正的基本 url 是[http://base/ url/index.php/](http://base/url/index.php/)并据此计算系统中的所有 URL。

所以，如果我有一个控制器 XXX 和动作 YYY 链接将是
[http://base/url/index.php/XXX/YYY](http://base/url/index.php/XXX/YYY)这当然是错误的。

我目前正在通过在 index.php 中添加一行来解决这个问题：

```
$_SERVER["REQUEST_URI"]=str_replace('index.php','',$_SERVER["REQUEST_URI"]); 
```

我想知道 ZF 是否有内置的方法来解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T13:46:35.967

您可以使用 ZF 来做到这一点[`Zend_Controller_Router_Route_Static`](http://framework.zend.com/manual/en/zend.controller.router.html#zend.controller.router.routes.static)（呸！），例如：

阅读上面链接的手册页，可以找到一些非常好的示例。

```
$route = new Zend_Controller_Router_Route_Static(
    'index.php',
    array('controller' => 'index', 'action' => 'index')
);
$router->addRoute('index', $route); 
```

不能说我完全不同意你的做法。也就是说，其他人可能会指出 5000 个左右的缺点。祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-22T21:32:02.753

使用 mod_rewrite。这样的事情应该这样做：

```
RewriteRule ^index.php/(.*)$ /$1 [r=301,L] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T14:01:43.937

那么这真的取决于你想如何解决这个问题。如您所知，Zend 框架构建在前端控制器模式上，其中每个未明确引用 /public 目录中文件的请求都被重定向到*index.php*。所以你基本上可以通过多种方式解决这个问题：

1.  编辑 .htaccess 文件（或服务器配置指令）以将请求重写为所需的请求：
    *   RewriteRule (.*index.php) /error/forbidden?req=$1 // 重写为错误控制器的禁止动作。
    *   RewriteRule index.php /index // 重写请求到主控制器和动作
2.  [按照karim79](https://stackoverflow.com/questions/901514/how-to-solve-the-case-when-users-surf-to-index-php/901554#901554)的建议，在引导程序中添加静态路由。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-22T16:51:36.407

我的看法是，如果我有一个由 PHP 提供支持的网站并且用户访问[http://site/index.aspx](http://site/index.aspx)，那么我会发送 404。

尽管 index.php 在理论上确实存在，但它在我的应用程序中不是有效的 URL，所以在这种情况下我也会发送 404。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T14:17:23.533

我认为您不应该使用路线来执行此操作。

这是一个不应该通过这种方式解决的普遍问题。

您最好必须在 .htaccess 中执行此操作，这将为您提供一种更好、更简单的方式将用户重定向到您想要的位置，例如错误页面或索引。

这是[mod_rewrite的文档页面](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewritecond)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T14:56:32.423

我从未使用 Zend Framework 遇到过这个问题。只是不要链接到 index.php 文件。而已。当您将应用程序的地址提供给用户时，只需告诉他们转到[http://base/url/](http://base/url/)

当用户输入[http://base/url/](http://base/url/)她的请求 URI 是*base/url*并且您的 .htaccess 文件将请求路由到 index.php，但请求**是** *base/url*。您不需要从请求中删除“index.php”。因为它不存在。

当您尝试为链接和表单生成 URL 时...，请使用内置的 url() 视图助手来生成链接。像这样：

```
// in some view script
<a href="<?php
  echo $this->url( array('controller'=>'targetController','action'=>'targetAction') );
         ?>" >click</a> 
```

不要担心链接。Zend 将为您生成一个 URL。

# ruby - Google 是否使用 Ruby 进行应用程序开发？

> ID：901519
> 
> 赞同：16
> 
> 时间：2009-05-23T13:16:52.953
> 
> 标签：ruby

有谁知道 Google 是否使用 Ruby 进行应用程序开发？

与 Perl 或 Python 等其他语言相比，Ruby 的一般工作前景如何？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-23T15:05:13.997

亚伦大致正确。我们仅将 C 用于内核工作（以及对用 C 编写的 3rd 方内容的其他维护），因此我不会将其视为“应用程序开发”，而 Objective C 则用于在 Apple 设备上运行客户端的应用程序的特定情况，等等

Ruby 是用于 Google Sketchup 的嵌入式脚本语言，请参阅[http://code.google.com/apis/sketchup/docs/gsrubyapi_examples.html——](http://code.google.com/apis/sketchup/docs/gsrubyapi_examples.html)该决定是在 Google 收购 Sketchup 的制造商“@Last Software”之前做出的。

关于 Nishant 的第二个问题，在更广泛的就业市场上，Ruby 还算不错：绝对数字仍然很低，但增长良好，请参阅[http://duartes.org/gustavo/blog/post/programming-language-jobs-and-trends](http://duartes.org/gustavo/blog/post/programming-language-jobs-and-trends)和[http ://blog.timbunce.org/2008/02/12/comparative-language-job-trend-graphs/](http://blog.timbunce.org/2008/02/12/comparative-language-job-trend-graphs/) - 数据有点长，但很难在非常高的时间内进行这些评估- 最新时尚；-)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-23T13:18:43.603

> 有人知道 ig google 使用 Ruby 进行任何应用程序开发吗？

不：他们使用 C/C++/Java/Python/JavaScript（我会去找参考资料）。

*   这是[Steve Yegge 的一篇文章，](http://steve-yegge.blogspot.com/2008/05/dynamic-languages-strike-back.html)很清楚他们不使用 Ruby。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-23T15:22:36.317

关于工作前景：如果你想为谷歌工作，你精通 Python、Perl 和 Ruby 中的哪一个并不重要：Python 黑客在申请软件方面的工作时并不比 Ruby 黑客等更有优势工程师。如果你想做很多 Perl 或 Ruby 编程，Google 不适合你。

要大致了解编程语言在职位空缺中的流行程度，请尝试在工作招聘网站上搜索编程语言。例如，[http](http://www.itpinoy.com/search/) ://www.itpinoy.com/search/说 Java 比 PHP 更流行，PHP 比 Ruby 更流行。

在开始使用 Ruby 之前，我已经使用 Perl 编程了几年。几年后，我再次开始使用 Python，同时还在使用 Perl 和 Ruby。一般来说，我在 Ruby 和 Python 中的工作效率往往高于在 Perl 中，所以我不再使用 Perl。我喜欢 Python，因为它对我来说感觉成熟、精心设计和干净（与 Ruby 相比，我觉得它有点 hacker），我喜欢 Ruby 是因为我只需输入一点点就可以进行强大的操作（相比之下，Python不支持在表达式、块、正则表达式作为一等对象、可变字符串中间进行赋值；并且 Python 的标准库不是那么通用，例如 list 和 dict 类型的方法比 Ruby 中的少）。

因此，对于刚接触 Perl、Ruby 和 Python 的人，我建议花一天时间学习 Ruby，再花一天时间学习 Python，然后选择这两者中的哪一个来专注于学习。

# sql - LINQ to SQL 更新

> ID：901534
> 
> 赞同：0
> 
> 时间：2009-05-23T13:26:59.890
> 
> 标签：sql, linq, linq-to-sql

有人对如何使用 LINQ 运行以下语句有一些想法吗？

```
UPDATE FileEntity SET DateDeleted = GETDATE() WHERE ID IN (1,2,3) 
```

我既喜欢又讨厌 LINQ，但到目前为止，几乎没有什么事情做得不好。我想避免的明显解决方案是枚举所有文件实体并手动设置它们。

```
foreach (var file in db.FileEntities.Where(x => ids.Contains(x.ID)))
{
    file.DateDeleted = DateTime.Now;
}
db.SubmitChanges(); 
```

上面的代码有一个问题，除了相当大的开销之外，每个实体都有一个相当大的数据字段，所以对于一个大的更新，很多数据在没有特殊原因的情况下跨数据库连接运行。（LINQ 解决方案是延迟加载 Data 属性，但如果有某种方法可以使用 LINQ to SQL 更新字段，则不需要这样做）。

我在想一些会导致上述 T-SQL 的查询表达式提供程序......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T13:46:35.763

LINQ 无法在存储更新中执行 - 它是语言集成查询，而不是更新。大多数（甚至可能全部）OR 映射器将生成一个选择语句来获取数据，在内存中对其进行修改，并使用单独的更新语句执行更新。智能 OR 映射器只会在需要额外数据之前获取主键，但随后它们通常会获取整个其余部分，因为一次仅获取单个属性会非常昂贵。

如果您真的关心这种优化，请使用存储过程或手写 SQL 语句。如果您想要更紧凑的代码，可以使用以下代码。

```
db.FileEntities.
    Where(x => ids.Contains(x.ID)).
    Select(x => x.DateDeleted = DateTime.Now; return x; );

db.SubmitChanges(); 
```

我不喜欢这个，因为我觉得它的可读性较差，但有些人更喜欢这样的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T19:52:25.257

LINQ to SQL 是一个 ORM，就像任何其他的一样，因此，它不是为处理批量更新/插入/删除而设计的。L2S、EF、NHibernate、LLBLGen 等的总体思路是为您处理关系数据到对象图的映射，无需管理大型存储过程库，这最终会限制您的灵活性和适应性。

当涉及到批量更新时，最好留给最适合它们的东西……数据库服务器。L2S 和 EF 都提供了将存储过程映射到您的模型的能力，这允许您的存储过程在某种程度上是面向实体的。由于您使用 L2S，因此只需编写一个以一组身份作为输入的 proc，并在问题的开头执行 SQL 语句。将该存储过程拖到您的 L2S 模型上，然后调用它。

它是解决手头问题的最佳解决方案，即批量更新。与报告一样，对象图和对象关系映射不是批量处理的最佳解决方案。

# java - 处理休眠实体上的数据库视图的优雅方法？

> ID：901537
> 
> 赞同：26
> 
> 时间：2009-05-23T13:28:15.847
> 
> 标签：java, database, hibernate

我使用 Hibernate 的主要原因之一是它提供了切换到另一个数据库的灵活性，而无需重写任何代码。

但是直到现在我还没有找到一个好方法来在我的休眠实体匹配的表上定义额外的视图。我仍在为此使用简单的 SQL 脚本。有没有更优雅的方式来定义由休眠管理的表上的视图？

理想情况下，我想使用 HQL 或其他通用方法来完成这项工作，这样我就不必担心我的 SQL 脚本与其他类型的数据库不兼容。

如果有办法做到这一点，那么第二个问题就是从这些视图中获取“合成”只读实例，这应该会使将聚合数据输入 UI 变得更加容易。

**编辑：**

似乎我没有把问题说得足够清楚，所以这就是我想要做的：我想编写独立于所用数据库的代码。由于我使用休眠，我只需要更改方言配置文件，然后可以使用另一个 DBMS。

问题：如何在*不*依赖特定 SQL 方言（以保持一切可移植性）甚至 HQL 的情况下在我的休眠实体上创建*视图？*如果可能的话，我可以使用 HQL 来查询这些视图，即创建只读聚合实体吗？是否有任何额外的休眠插件可以帮助我解决这个问题？到目前为止还没有找到任何东西...... :-/

 ** * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-27T03:15:11.203

Hibernate 不会自动为您创建视图，因为每种方言仅支持底层数据库的数据定义语言 (DDL) 的有限子集。基本上，它支持足够的 DDL 来生成工作模式，但不足以处理“额外”对象（如视图）的创建。

不过，一切都没有丢失。Hibernate 确实使您能够在 XML 映射文件中自己创建（和删除）其他数据库对象，并且这些对象可以限定为特定方言。例如，我可以有这样的映射：

```
<hibernate-mapping>
  <class name='com.mycompany.myproduct.Customer' table='tbl_customer'>
    <id name='id' column='customer_id'>
      <generator class='native'/>
    </id>
    <property name='name' length='50' unique='true' not-null='true' />
  </class>

  <database-object>
    <create>create or replace view read_only_cust...</create>
    <drop>drop view read_only_cust</drop>
    <dialect-scope name='org.hibernate.dialect.Oracle9Dialect' />
  </database-object>
</hibernate-mapping> 
```

您可以通过添加更多“数据库对象”部分来自由创建所需的任何其他视图。您必须自己为要支持的每个数据库编写 SQL (DDL)，但由于它们的范围仅限于方言，Hibernate 将只为在模式导出时选择的方言执行 SQL。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-10-07T06:31:11.870

有同样的问题，并在休眠文档中找到了以下解决方案：

> Hibernate 映射的视图和基表之间没有区别。这在数据库级别是透明的，尽管某些 DBMS 不正确支持视图，尤其是更新时。有时您想使用视图，但不能在数据库中创建视图（即使用旧模式）。在这种情况下，您可以将不可变的只读实体映射到给定的 SQL 子选择表达式：

```
<class name="Summary">
    <subselect>
        select item.name, max(bid.amount), count(*)
        from item
        join bid on bid.item_id = item.id
        group by item.name
    </subselect>
    <synchronize table="item"/>
    <synchronize table="bid"/>
    <id name="name"/>
    ...
</class> 
```

[https://docs.jboss.org/hibernate/stable/core/manual/en-US/html_single/#mapping-declaration](https://docs.jboss.org/hibernate/stable/core/manual/en-US/html_single/#mapping-declaration)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T21:17:08.837

您可以直接在数据库中声明视图吗？然后你可以直接从视图中选择。查看[Hibernate 手册的第 10.4.4 章](http://docs.jboss.org/hibernate/stable/core/reference/en/html/objectstate-querying.html#objectstate-querying-nativesql)

这应该允许您从数据库视图中选择并让 Hibernate 自动将数据水合到您的实体中。

当然，视图不带任何参数。Hibernate 3 应该支持存储过程，但我已经使用过了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T18:20:33.933

“创建视图”是什么意思？我从纯数据库上下文中知道这意味着什么——但这不是你的意思——对吧？

您可以将新的 Java 类映射到相同的表以创建“视图”，也可以使用 HQL 选择由其他持久类映射的列的子集。

高温高压

# ruby-on-rails - 使用 jruby 1.1.6 在 netbeans 中运行 laika

> ID：901539
> 
> 赞同：0
> 
> 时间：2009-05-23T13:28:52.133
> 
> 标签：ruby-on-rails, ruby

我是 Ruby/Rails 新手，并试图让 laika 工具 ( [http://github.com/CCHIT/laika/tree/master](http://github.com/CCHIT/laika/tree/master) ) 在 NetBeans IDE 中运行。我收到以下异常。我正在使用 NetBeans IDE 6.5.1、JRubby 1.1.6 和 GlassFish V3。有什么想法可能是错的吗？

信息：Jruby 版本是：1.1.6

信息：启动 Rails 实例严重：线程“pool-13-thread-1”中的异常

严重：C:/Program Files/NetBeans 6.5.1/ruby2/jruby-1.1.6/lib/ruby/1.8/pathname.rb:420:in `realpath_rec':

严重：没有这样的文件或目录 - 没有这样的文件或目录 - C:/Program Files/glassfish-v3-prelude/glassfish/C: (Errno::ENOENT)

严重：来自 C:/Program Files/NetBeans 6.5.1/ruby2/jruby-1.1.6/lib/ruby/1.8/pathname.rb:453:in `realpath'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-04T18:13:03.590

事实证明这是 GlassFish 的问题。它在 WEBrick 上运行良好。

# iphone - 在 iphone 的 uinavigationbar 上使用图像或色调颜色？

> ID：901542
> 
> 赞同：6
> 
> 时间：2009-05-23T13:33:20.767
> 
> 标签：iphone, xcode, interface-builder

如何在导航栏上显示背景图像或在本机 iphone 应用程序中为导航栏提供色调？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-11-03T22:50:57.510

对于 iOS5，使用以下代码行：

```
UINavigationBar *navBar = [[self navigationController] navigationBar];
UIImage *backgroundImage = [UIImage imageNamed:@"nav-bar-background-normal"];
[navBar setBackgroundImage:backgroundImage forBarMetrics:UIBarMetricsDefault]; 
```

为了向后兼容，请检查导航栏是否响应 setBackgroundImage:forBarMetrics：

更多信息： [http ://sebastiancelis.com/2009/12/21/adding-background-image-uinavigationbar/](http://sebastiancelis.com/2009/12/21/adding-background-image-uinavigationbar/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-10-26T18:32:12.203

This's how I did on iOS4:

```
#import <QuartzCore/QuartzCore.h> // For .layer 

self.navigationController.navigationBar.layer.contents = (id)[UIImage imageNamed:@"navigationBarBackgroundImage"].CGImage;
self.navigationController.navigationBar.tintColor = [UIColor orangeColor]; 
```

No need to switch subviews between z-orders (-exchangeSubviewAtIndex:withSubviewAtIndex:), both background image and tintColor set in one line of code, and works with @2x image too.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-23T19:56:49.240

一周前正在寻找这个。在这里的讨论中找到了这个。苹果。com/thread.jspa?threadID=1649012&tstart=0 （抱歉不会让我发布真正的链接）。

```
-(void)setBackgroundImage:(UIImage*)image withTag:(NSInteger)bgTag{
if(image == NULL){ //might be called with NULL argument
    return;
}
UIImageView *aTabBarBackground = [[UIImageView alloc]initWithImage:image];
aTabBarBackground.frame = CGRectMake(0,0,self.frame.size.width,self.frame.size.height);
aTabBarBackground.tag = bgTag;
[self addSubview:aTabBarBackground];
[self sendSubviewToBack:aTabBarBackground];
[aTabBarBackground release];
}
/* input: The tag you chose to identify the view */
-(void)resetBackground:(NSInteger)bgTag {
    [self sendSubviewToBack:[self viewWithTag:bgTag]];
} 
```

我把它作为 UINavigationBar 的一个类别。要将其设置为 UINavigationBarController 内的 UINavigationBar 的背景图像，我这样做了：

```
[navigationControllerForChannels.navigationBar setBackgroundImage:[UIImage imageNamed:@"top_bar.png"] withTag:48151623]; 
```

我在更新标签栏时遇到了一些问题，所以你需要打电话

```
[self.navigationController.navigationBar resetBackground:48151623]; 
```

任何修改后吧。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-03-23T22:03:09.193

您可以覆盖 UINavigationBar drawRect。该代码可以放置到 appDelegate.m 我已经测试过它，它可以在 3x 和 4x iOS 上运行。

```
@implementation UINavigationBar (UINavigationBarCategory)
- (void)drawRect:(CGRect)rect {
    UIColor *color = [UIColor blackColor]; //tint color
    UIImage *img = [UIImage imageNamed: @"navBarBg.png"]; // your image
    [img drawInRect:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];
    self.tintColor = color;
 }@end 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-19T13:51:48.583

对于 iOS5 和 iOS6，我使用了这个解决方案，并且效果很好，制作了一个通用 UINavigationBar 背景图像。

iPhone 视网膜纵向 640px x 88px / iPhone 非视网膜纵向 320px x 44px

AppDelegate.m 内部

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

放置此代码

```
// Set the status bar to black color.
[[UIApplication sharedApplication] setStatusBarStyle:UIStatusBarStyleBlackOpaque animated:NO];

// Change @"menubar.png" to the file name of your image.
UIImage *navBar = [UIImage imageNamed:@"menubar.png"];

[[UINavigationBar appearance] setBackgroundImage:navBar forBarMetrics:UIBarMetricsDefault]; 
```

不要忘记更改图像名称（menubar.png）

查看此链接以获取完整答案[http://www.lwxted.com/blog/2012/add-custom-background-image-uinavigationbar-ios-5/](http://www.lwxted.com/blog/2012/add-custom-background-image-uinavigationbar-ios-5/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-23T15:18:09.667

背景图像将需要更多工作（您可能想尝试设置与栏本身大小相同的titleView；我自己没有尝试过）或在现有子视图后面添加一个视图。着色很简单：navBar.tintColor = [UIColor orangeColor];

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-06-10T10:18:09.963

如果你使用 CGImage 解决方案，你可能会遇到图像大小的问题：

```
CGRect layer=self.navigationController.navigationBar.frame;
layer.size.height=57.0;
layer.origin.y=0;
self.navigationController.navigationBar.frame=layer;
CGImageRef imageRef         = [UIImage imageNamed:@"myImg.png"].CGImage;
self.navigationController.navigationBar.layer.contents = (id)imageRef; 
```

在我看来，图像被拉伸了，因为图层的高度似乎为 44.0 像素，但 UINavigationBar 的背景图像至少应为 57.0。

如果您尝试移动图层的框架，所有按钮都会在其中移动。

# iphone - UIPickerview 自定义

> ID：901545
> 
> 赞同：4
> 
> 时间：2009-05-23T13:36:26.593
> 
> 标签：iphone, objective-c, uipickerview

我想对 UIPickerView 进行一些自定义。

最终目标：有一个选择器视图旋转几个图标大小的图像。

首先，我想将主轴周围的黑色/灰色边框更改为透明色。即[UIColor clearColor]；

然后缩小选择器视图，使其相对较小（可能约为 40 x 40 像素） IB 对此进行试验并不容易。

最后更改返回到每个部分的选择器的视图。我认为这很容易

```
pickerView:viewForRow:forComponent:reusingView: 
```

其余的，不确定是否有可能，或者我是否必须深入研究一些核心动画/图形（或找到一种不同的方式来做我想做的事）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T21:04:27.623

UIPickerView 不可自定义。完全没有。

你必须去定制你想要的。

也许最简单的方法是弄乱启用垂直分页的 UIScrollView，并尝试让它像你想要的那样运行。也许将 UIImageView 与它重叠并将整个内容包装在自定义视图中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-30T20:32:51.920

您还可以通过简单地将 UIImageView 放置在顶部并为工作部件切出一个孔来“自定义”选择器的外边框。Apple 通过时钟应用程序做到了这一点。

# java - 排序列表时在列表中查找值的最佳方法

> ID：901546
> 
> 赞同：1
> 
> 时间：2009-05-23T13:38:45.543
> 
> 标签：java, algorithm, search, sorting

假设我有一个已排序的 Java ArrayList。现在我想找到值 x 的索引。最快（没有超过 30 行代码）的方法是什么？使用 IndexOf() 方法？在一个简单的 for 循环中遍历所有值？使用一些很酷的算法？我们谈论的是大约 50 个整数键。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-23T13:40:36.553

[二进制搜索](http://en.wikipedia.org/wiki/Binary_search)，但由于它只有 50 个项目，谁在乎（除非你必须做数百万次）？简单的线性搜索更简单，50 个项目的性能差异可以忽略不计。

**编辑**：您也可以使用内置的 java.util.Collections [binarySearch](http://java.sun.com/javase/6/docs/api/java/util/Collections.html)方法。请注意，即使找不到该项目，它也会返回一个插入点。您可能需要进行额外的检查，以确保该项目确实是您想要的。感谢@Matthew 的指点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-23T13:51:16.753

tvanfosson 是对的，两者的时间都将非常短，因此除非此代码非常频繁地运行，否则不会有太大的不同。

但是，Java 具有用于对 Lists（包括 ArrayLists）进行二进制搜索的内置功能，[Collections.binarySearch](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#binarySearch(java.util.List,%20T))。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T14:02:09.523

```
import java.util.ArrayList;
import java.util.Collections;

ArrayList myList = new ArrayList();
// ...fill with values

Collections.sort( myList );
int index = Collections.binarySearch( myList, "searchVal" ); 
```

编辑：未经测试的代码

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T13:53:32.287

如果键具有可接受的分布，考虑到执行时间，[插值搜索](http://en.wikipedia.org/wiki/Interpolation_search)可能是一种非常快速的方法。

考虑编码时间`IndexOf()`是要走的路（或者如果您的数据类型可用，则内置二进制搜索（我来自 C#，不知道 Java））。

# netbeans - Netbeans 6.5.1 + Openfire 3.6.4 协作？

> ID：901547
> 
> 赞同：0
> 
> 时间：2009-05-23T13:39:18.693
> 
> 标签：netbeans, plugins, collaboration, openfire

我们在 Netbeans 中使用 collab 插件。不幸的是，“开发人员协作 XMPP 服务器 share.java.net 的服务将于 2009 年 4 月 20 日停止。”

[http://wiki.netbeans.org/FaqShareJavaNet](http://wiki.netbeans.org/FaqShareJavaNet)

我设法在 OpenSolaris 2008.11 上安装了 OpenFire 3.6.4。

无论我做什么，我都无法从 Netbeans 协作插件登录，但得到“对象不代表有效的 JID”服务器日志：

> 2009.05.23 21:41:27 [org.jivesoftware.openfire.spi.PresenceManagerImpl.userUnavailable(PresenceManagerImpl.java:271)] 存储用户离线状态时出错：

关于这个主题的信息很少，除了

[http://wiki.netbeans.org/CollabServer](http://wiki.netbeans.org/CollabServer)

[http://www.igniterealtime.org/community/message/190171](http://www.igniterealtime.org/community/message/190171)

有人用 Openfire 成功运行 Netbeans 吗？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-24T08:52:40.317

我认为 Openfire 和 netbeans 协作模块之间存在错误。使用 NB 6.7、Openfire 3.6.4 和 postgres 7，我注意到有 2 个进程试图提供“存在”功能，导致存在表中的 2 个冲突数据库条目。

我认为来自 netbeans 协作连接的一个条目包含 netbeans 所需的用户 JID，而另一个没有，这是我认为“对象不代表有效 JID”错误消息背后的罪魁祸首。

我决定尝试删除 Openfire 群聊选项卡中的所有服务，并成功地从我的 NB 6.7 登录，但没有可用的协作频道...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-07T16:13:34.107

是的！

从 openfire 管理员的可用插件列表中安装“搜索”插件。就这样！它甚至在上面的链接中:) 如果它不起作用，请尝试禁用离线消息。

# python - 如何在 Django 模板中包含图像文件？

> ID：901551
> 
> 赞同：85
> 
> 时间：2009-05-23T13:45:07.920
> 
> 标签：python, django, django-templates

我是 Django 新手，我正在尝试通过我正在开发的一个名为“dubliners”的简单项目和一个名为“book”的应用程序来学习它。目录结构是这样的：

```
dubliners/book/  [includes models.py, views.py, etc.]
dubliners/templates/book/ 
```

我有一个 JPG 文件，需要在每个网页的页眉中显示。我应该在哪里存储文件？我应该使用哪个路径让标签使用模板显示它？我尝试了各种位置和路径，但到目前为止没有任何效果。

...

感谢您在下面发布的答案。但是，我尝试了图像的相对路径和绝对路径，但仍然在网页中显示损坏的图像图标。例如，如果我的主目录中有一个图像并在我的模板中使用这个标签：

```
<img src="/home/tony/london.jpg" /> 
```

图像不显示。但是，如果我将网页保存为静态 HTML 文件，则会显示图像，因此路径是正确的。也许 Django 附带的默认 Web 服务器仅在图像位于特定路径时才显示图像？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-08-05T20:25:36.423

尝试这个，

## 设置.py

```
# typically, os.path.join(os.path.dirname(__file__), 'media')
MEDIA_ROOT = '<your_path>/media'
MEDIA_URL = '/media/' 
```

## 网址.py

```
urlpatterns = patterns('',
               (r'^media/(?P<path>.*)$', 'django.views.static.serve',
                 {'document_root': settings.MEDIA_ROOT}),
              ) 
```

## .html

```
<img src="{{ MEDIA_URL }}<sub-dir-under-media-if-any>/<image-name.ext>" /> 
```

## 警告

谨防！using`Context()`将为您产生一个空值`{{MEDIA_URL}}`。您必须使用`RequestContext()`, 代替。

我希望这个能帮上忙。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-05-23T14:04:01.377

在生产中，您只需将模板生成的 HTML 指向主机存储媒体文件的位置。所以你的模板将只有例如

```
<img src="../media/foo.png"> 
```

然后您只需确保该目录存在相关文件即可。

在开发过程中是一个不同的问题。django 文档对其进行了简洁明了的解释，因此在此处链接并在此处输入会更有效，但基本上您将为站点媒体定义一个视图，其中包含指向磁盘位置的硬编码路径。

就[在这里](http://docs.djangoproject.com/en/dev/howto/static-files/)。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-09-10T17:54:12.430

我明白，您的问题是关于存储在 MEDIA_ROOT 中的文件，但有时当您不打算再创建该类型的内容时，可以将内容存储在静态中。
这可能是一种罕见的情况，但无论如何 - 如果您的网站有大量“当天的图片” - 所有这些文件都在您的硬盘上？

在那种情况下，我认为在 STATIC 中存储这样的内容没有任何矛盾。
一切都变得非常简单：

> ### 静止的
> 
> 要链接到保存在 STATIC_ROOT 中的静态文件，Django 附带一个静态模板标签。无论您是否使用 RequestContext，您都可以使用它。
> 
> `{% load static %} <img src="{% static "images/hi.jpg" %}" alt="Hi!" />`

[从官方 django 1.4 文档/内置模板标签和过滤器](https://docs.djangoproject.com/en/1.4/ref/templates/builtins/#static)复制

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2017-03-14T13:11:59.040

**开发**
中 在您的应用程序文件夹中创建文件夹名称“静态”并将您的图片保存在该文件夹中。
要使用图片使用：

```
<html>
    <head>
       {% load staticfiles %} <!-- Prepare django to load static files -->
    </head>
    <body>
        <img src={% static "image.jpg" %}>
    </body>
</html> 
```

**在生产中：**
一切都与开发中一样，只需为 Django 添加更多参数：

1.  添加**settings.py**
    `STATIC_ROOT = os.path.join(BASE_DIR, "static/")`（这将准备存储所有应用程序的静态文件的文件夹）

2.  确保您的应用在`INSTALLED_APPS = ['myapp',]`

3.  在终端运行命令**python manage.py collectstatic**（这会将静态文件从 INSTALLED_APPS 中包含的所有应用程序复制到全局静态文件夹 - STATIC_ROOT 文件夹）

    这就是 Django 所需要的，之后您需要进行一些 Web 服务器端设置使用静态文件夹的权限。例如，在配置文件**httpd.conf**（对于 windows）或**sites-enabled/000-default.conf 中的 apache2 中。**（在 linux 的站点虚拟主机部分下）添加：

    别名 \static "path_to_your_project\static"

    要求所有授予 仅

    此而已

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2010-11-26T11:42:45.400

我已经花了两天的时间来解决这个问题，所以我只是想我也会分享我的解决方案。截至 10 年 11 月 26 日，当前分支为 1.2.X，这意味着您必须在*settings.py*中包含以下内容：

```
MEDIA_ROOT = "<path_to_files>" (i.e. /home/project/django/app/templates/static)
MEDIA_URL = "http://localhost:8000/static/" 
```

*（请记住，MEDIA_ROOT 是文件所在的位置，MEDIA_URL 是您在模板中使用的常量。）*

然后在你的*url.py*中放置以下内容：

```
import settings

# stuff

(r'^static/(?P<path>.*)$', 'django.views.static.serve',{'document_root': settings.MEDIA_ROOT}), 
```

然后在您的 html 中，您可以使用：

```
<img src="{{ MEDIA_URL }}foo.jpg"> 
```

django 的工作方式（据我所知是：

1.  在 html 文件中，它将 MEDIA_URL 替换为在 setting.py 中找到的 MEDIA_URL 路径
2.  它在 url.py 中查找 MEDIA_URL 的任何匹配项，然后如果找到匹配项（如*r'^static/(?P.* )$'* 与*http://localhost:8000/static/*相关），它会搜索对于 MEDIA_ROOT 中的文件，然后加载它

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2015-05-23T09:58:05.640

项目根目录下的 /media 目录

## 设置.py

```
BASE_DIR = os.path.dirname(os.path.dirname(__file__))
MEDIA_URL = '/media/'
MEDIA_ROOT = os.path.join(BASE_DIR, 'media') 
```

## 网址.py

```
 urlpatterns += patterns('django.views.static',(r'^media/(?P<path>.*)','serve',{'document_root':settings.MEDIA_ROOT}), ) 
```

## 模板

```
<img src="{{MEDIA_URL}}/image.png" > 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2014-09-08T12:58:19.880

如果您的文件是模型中的模型字段，您还可以在模板标签中使用“.url”来获取图像。

例如。

如果这是您的模型：

```
class Foo(models.Model):
    foo = models.TextField()
    bar = models.FileField(upload_to="foo-pictures", blank = True) 
```

在视图的上下文中传递模型。

```
return render (request, "whatever.html", {'foo':Foo.objects.get(pk = 1)}) 
```

在您的模板中，您可以拥有：

```
<img src = "{{foo.bar.url}}"> 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-05-23T15:12:28.290

您的

```
<img src="/home/tony/london.jpg" /> 
```

将适用于从磁盘读取的 HTML 文件，因为它将假定 URL 为`file:///home/...`. 但是，对于从网络服务器提供的文件，URL 将变为：`http://www.yourdomain.com/home/tony/london.jpg`，这可能是无效的 URL，而不是您真正的意思。

有关如何提供静态文件以及放置静态文件的信息，请查看此[文档](http://docs.djangoproject.com/en/dev/howto/static-files/)。基本上，如果您使用 django 的开发服务器，您想向他展示您的媒体文件所在的位置，然后让您`urls.py`为这些文件提供服务（例如，通过使用一些`/static/`url 前缀）。

将要求您在您的`urls.py`：

```
(r'^site_media/(?P<path>.*)$', 'django.views.static.serve',
    {'document_root': '/path/to/media'}), 
```

在生产环境中，您希望跳过此操作并让您的 http 服务器（*apache*、*lighttpd*等）提供静态文件。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-06-22T17:44:40.500

另一种方法：

```
MEDIA_ROOT = '/home/USER/Projects/REPO/src/PROJECT/APP/static/media/'
MEDIA_URL = '/static/media/' 
```

这将要求您将媒体文件夹移动到静态文件夹的子目录。

然后在您的模板中，您可以使用：

```
<img class="scale-with-grid" src="{{object.photo.url}}"/> 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-06-11T04:59:48.360

我尝试了各种方法都不起作用。但这有效。希望它也对你有用。文件/目录必须位于以下位置：

项目/您的应用程序/模板项目/您的应用程序/静态

## 设置.py

```
import os    
PROJECT_DIR = os.path.realpath(os.path.dirname(_____file_____))
STATIC_ROOT = '/your_path/static/' 
```

例子：

```
STATIC_ROOT = '/home/project_name/your_app/static/'    
STATIC_URL = '/static/'    
STATICFILES_DIRS =(     
PROJECT_DIR+'/static',    
##//don.t forget comma    
)
TEMPLATE_DIRS = (    
 PROJECT_DIR+'/templates/',    
) 
```

## 项目/应用程序/模板/文件名.html

体内

```
{% load staticfiles %}

//for image

img src="{% static "fb.png" %}" alt="image here"

//note that fb.png is at /home/project/app/static/fb.png 
```

如果 fb.png 在 /home/project/app/static/image/fb.png 那么

```
img src="{% static "images/fb.png" %}" alt="image here" 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-06-16T00:33:57.100

还要检查问题可能不是由于路径，而是文件名或扩展名。虽然无法显示添加到 base.html 模板的图像，但发现错误与图像文件扩展名有关。如果您以 jpeg 格式存储图像，请使用 .jpg 作为 img 标签中的扩展名 `<img src="{% static 'logo.jpg' %}" alt="Logo">`。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-07-29T10:03:02.303

如果您在 django 项目中提供在线图像的地址，它将起作用。这对我有用。你应该拍一拍。

# c# - 一个对象应该将自己写到一个文件中，还是应该另一个对象对其进行操作以执行 I/O？

> ID：901555
> 
> 赞同：51
> 
> 时间：2009-05-23T13:47:59.037
> 
> 标签：c#, design-patterns, oop, io

*注意：对不起，很长的问题！*

我试图了解面向对象背后的一些关键领域，但我无法以一种或另一种方式决定我的特定问题。

假设我有一个充满可爱数据的对象。类鲍勃。

```
Bob myBob = new Bob("This string is data"); 
```

假设我想将 myBob 的内容保存到 xml 文件 (bob.xml)

我应该让一个对象作用于 bob 以写出内容，还是应该让 myBob 这样做？

**案例 1：作用于对象**

```
Writer myWriter = new Writer(myBob, "C:\\bob.xml"); 
```

**案例2：保存方法**

```
myBob.Save("C:\\bob.xml"); 
```

有些人支持选项一，因为这意味着如果写入文件的代码发生了变化，则不需要在每个 Save 方法中都进行更新；我想促进代码重用。我的问题是从对象中获取所有数据，这些对象可能具有没有访问器的私有数据。

选项二的情况是该方法只作用于对象持有的数据，这就是它应该的方式。不受其他物体干扰。

还是我的问题的答案是那些“取决于案例”的问题之一？如果是这样，你怎么知道什么时候一种方法比另一种更受欢迎？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-23T13:54:20.333

通常，正确的方法是您的案例 1。这为类（无论它做什么）保持单一职责，而不会将其耦合到特定的持久性机制（磁盘）。

您正在查看一个更普遍的问题的具体案例：序列化。对于一个对象来说，有一些方法来指示它应该如何被序列化是很好的——毕竟，它是唯一知道反序列化它所必需的实体。但是，如果您让对象将自身保存到磁盘，您就将该对象与特定实现紧密耦合。

相反，请考虑创建一个接口，通用“编写器”可以使用该接口将对象“序列化”为编写器序列化的任何对象。这样，您将能够序列化到磁盘、网络、内存，以及您实际需要序列化的任何内容。:)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-05-23T13:52:43.910

我会`Bob`知道如何序列化自己，因为它有私有数据。另一个对象（例如 your `Writer`）会将其存储在磁盘上。Bob 知道如何最好地处理其数据，但它不需要关心数据的存储方式或存储位置。您的 Writer 知道如何最好地保存数据，但它不需要关心数据是如何创建的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-23T14:15:02.180

这是可以使用**策略设计模式**的示例。您的`myBob`对象可能有一个将其写出的类的实例。您可能希望编写器实现接口或从抽象类派生，以便可以轻松更改保存例程。
今天您正在保存到 xml，但您最终可能还需要将对象保存到数据库中。此模式将允许您轻松更改保存程序。您甚至可以选择在运行时更改保存方式。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-23T13:54:53.983

我以前更喜欢选项2；然而，由于我已经开始真正尝试理解和建模我正在处理的领域，我更喜欢选项 1。

想象一下，如果您的建模车辆。为什么车辆会知道如何坚持自己？它可能知道如何移动、如何启动和如何停止，但在车辆的上下文中什么是 Save。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-23T19:05:34.523

另一种方法是使用访问者模式。让您的对象包含一个 Accept 方法，该方法通过您要处理/序列化的成员，并让访问者成为您的序列化程序。每当您更新或更改序列化（纯文本到 xml 到二进制到任何内容）时，您都不需要更新对象。

我们在工作中以这种方式获得了很好的经验。它非常强大。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-05-23T14:32:02.427

做这个：

```
public interface Writable {
    public void Save(Writer w);
}

public interface Writer {
    public void WriteTag(String tag, String cdata);
}

public class Bob : Writable {
    private String ssn = "123-23-1234";
    public void Save(Writer w) {
        w.WriteTag("ssn", ssn);
    }
}

public class XmlWriter : Writer {
    public XmlWriter(Sting filename) {...}
    public void WriteTag(String tag, Sting cdata) {...}
} 
```

显然这不是一个完整的解决方案，但您应该了解总体思路。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2009-05-23T14:10:38.180

我认为正确的方法是案例 1，但您的类可能会以这种方式定义以利用这两种方法：

```
class Bob {

    IWriter _myWriter = null;

    public Bob(){
        // This instance could be injected or you may use a factory
        // Note the initialization logic is here and not in Save method
        _myWriter = new Writer("c://bob.xml")
    }

    //...
    public void Save(){

        _myWriter.Write(this);    

    }
    // Or...
    public void Save(string where){

        _myWriter.Write(this, where);

    }
    //...
} 
```

这可以很容易地修改，将编写逻辑和初始化放在一个基类中，这样 Bob 类就更干净了，并且独立于持久性。

# php - 长时间的听众。第一次来电... 严格来说不是一个 PHP 问题，因为它涉及正则表达式，但这个问题让我大吃一惊。 我有 3 个要创建的正则表达式，只有一个可以正常工作。 现在我不确定这是否是由于以下事实： 我不了解 preg_match 和 ereg 以及它们的返回码，因为我已经有 7 年 问问题 user104656 问问题 2009-05-23T13:49:23.543 153 次 This question shows research effort; it is useful and clear 2 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 长时间的听众。第一次来电... 严格来说不是一个 PHP 问题，因为它涉及正则表达式，但这个问题让我大吃一惊。 我有 3 个要创建的正则表达式，只有一个可以正常工作。 现在我不确定这是否是由于以下事实： 我不了解 preg_match 和 ereg 以及它们的返回码，因为我已经有 7 年没有在 PHP 中工作了。 我的正则表达式完全错误。 我有精神障碍。 无论哪种方式，这里都是表达式和 我使它们起作用的微弱尝试。 1) 匹配任何以 2、3、4 或 5 开头的数字，然后是 5 位数字。（我认为这个可行） 代码： if (!ereg('/[2-5]\d{5}/', $_POST['packageNumber' ) { echo "The package number is not the correct format."; } 2) 匹配任何以 2、3、4 或 5 开头的数字，然后是 5 位数字，然后是句点，然后是 1 或 2。 if (!ereg("/[2-5]\d{5}\.[1-2]/", $_POST['packageModifier' ) { echo "The package modifier is not the correct format."; } 3) 匹配字母数字、空格、句点和连字符的任意组合，最多 50 个字符。 if (!ereg("/[0-9a-zA-Z\s\-\.]{0,50}/", $_POST['customerNumber' ) { echo "The customer number is not the correct format."; } 如果有人可以请告诉我我做错了什么，我会给他们我的第一个孩子。 您正在混淆PCRE 函数和POSIX 正则表达式函数。您正在使用带有 POSIX 正则表达式函数的Perl 兼容正则表达式。 所以替换ereg为preg_match它应该可以工作： if (!preg_match('/^[2-5]\d{5}$/', $_POST['packageNumber'])) { echo "The package number is not the correct format."; } if (!preg_match("/^[2-5]\d{5}\.[1-2]$/", $_POST['packageModifier'])) { echo "The package modifier is not the correct format."; } if (!preg_match("/^[0-9a-zA-Z\s\-.]{0,50}$/", $_POST['customerNumber'])) { echo "The customer number is not the correct format."; } 除了修复 PHP 语法错误之外，我还为要匹配的字符串的开始 ( ^) 和结束 ( ) 添加了锚点。$ phpregex 4 5 回答 5 This answer is useful 8 您正在混淆PCRE 函数和POSIX 正则表达式函数。您正在使用带有 POSIX 正则表达式函数的Perl 兼容正则表达式。 所以替换ereg为preg_match它应该可以工作： if (!preg_match('/^[2-5]\d{5}$/', $_POST['packageNumber'])) { echo "The package number is not the correct format."; } if (!preg_match("/^[2-5]\d{5}\.[1-2]$/", $_POST['packageModifier'])) { echo "The package modifier is not the correct format."; } if (!preg_match("/^[0-9a-zA-Z\s\-.]{0,50}$/", $_POST['customerNumber'])) { echo "The customer number is not the correct format."; } 除了修复 PHP 语法错误之外，我还为要匹配的字符串的开始 ( ^) 和结束 ( ) 添加了锚点。$ 于 2009-05-23T13:52:51.990 回答 This answer is useful 1 你不需要锚定正则表达式吗？ 否则 '111111111111111211111111111' 将匹配 /[2-5]\d{5}/。 于 2009-05-23T13:53:54.377 回答 This answer is useful 1 我假设您刚刚错过了 $_POSTS 上的结束 ] 并且我已经在行的开头和结尾添加了锚点并使用了 preg_match。 如果你不锚定它并且模式匹配字符串中的任何地方，那么整个事情都会匹配。例如。 如果第一个没有锚定，“dfasfasfasfasf25555555as5f15sdsdasdsfghfsgihfughd54”将被匹配。 第一 if (!preg_match('/^[2-5]\d{5}$/', $_POST['packageNumber'])) { echo "The package number is not the correct format."; } 第二 if (!preg_match('/^[2-5]\d{5}\.[2-5]$/', $_POST['packageModifier'])) { echo "The package modifier is not the correct format."; } 第三 if (!preg_match('/^[0-9a-zA-Z\s\-.]{0,50}$/m', $_POST['customerNumber'])) { echo "The package modifier is not the correct format."; } 于 2009-05-23T13:59:44.567 回答 This answer is useful 1 当使用 POSIX 正则表达式（被 PHP 5.3 弃用）时，你应该像这样编写测试： if (ereg('^[2-5][0-9]{5}$', $_POST['packageNumber']) === false) { echo "The package number is not the correct format."; } if (ereg('^[2-5][0-9]{5}\\.[1-2]$', $_POST['packageModifier']) === false) { echo "The package modifier is not the correct format."; } if (ereg('^[[:alnum:][:space:].-]{0,50}$', $_POST['customerNumber']) === false) { echo "The customer number is not the correct format."; } 请注意，我锚定了正则表达式——否则 customerNumber 将始终匹配（使用零长度匹配）。 有关更多信息，请参阅POSIX 正则表达式手册页。 于 2009-05-23T14:13:47.423 回答 This answer is useful 0 preg_match('/^[2-5]\d{5}$/', $str); // 1-st preg_match('/^[2-5]\d{5}\.[1-2]$/', $str); // 2-nd preg_match('/^[0-9a-z\s\-\.]{0,50}$/i', $str); // 3-rd 你的错误： 您没有转义斜杠，最后正则表达式“\d”仅表示“d”，但“\d”表示“\d”。 您必须通过 ^ 和 $ 符号将 regesp 锚定到 beginnig 和整个字符串的结尾。 就这样 ;） PS：更好地为字符串文字使用单引号 - 它们更快更安全...... 于 2009-05-23T16:34:09.423 回答 Related 2 javascript - 在 JavaScript 中强制事件侦听器 1 jquery - 淘汰赛拖放表 1 javafx-2 - JavaFX 2：有没有办法在加载时显示工具提示？ 1 algorithm - 以下gcd算法的时间复杂度 0 javascript - Javascript 清除所有脚本。高 I/O 使用率 2 java - 向现有 Java 正则表达式添加空格处理 3 css - 带滚动条的固定框？ 3 ios - 让 TableView 只占屏幕的一部分 1 php - 我的 php 设置中的 http_post 文件权限错误 1 javascript - 如何从外部调用表单的发布操作 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：901558
> 
> 赞同：2
> 
> 时间：
> 
> 标签：php, regex

长时间的听众。第一次来电...

严格来说不是一个 PHP 问题，因为它涉及正则表达式，但这个问题让我大吃一惊。

我有 3 个要创建的正则表达式，只有一个可以正常工作。

现在我不确定这是否是由于以下事实：

1.  我不了解 preg_match 和 ereg 以及它们的返回码，因为我已经有 7 年没有在 PHP 中工作了。
2.  我的正则表达式完全错误。
3.  我有精神障碍。

无论哪种方式，这里都是表达式和​​我使它们起作用的微弱尝试。

1) 匹配任何以 2、3、4 或 5 开头的数字，然后是 5 位数字。（我认为这个可行）

代码：

```
if (!ereg('/[2-5]\d{5}/', $_POST['packageNumber' )
{
   echo "The package number is not the correct format.";
} 
```

2) 匹配任何以 2、3、4 或 5 开头的数字，然后是 5 位数字，然后是句点，然后是 1 或 2。

```
if (!ereg("/[2-5]\d{5}\.[1-2]/", $_POST['packageModifier' )
{
   echo "The package modifier is not the correct format.";
} 
```

3) 匹配字母数字、空格、句点和连字符的任意组合，最多 50 个字符。

```
if (!ereg("/[0-9a-zA-Z\s\-\.]{0,50}/", $_POST['customerNumber' )
{
   echo "The customer number is not the correct format.";
} 
```

如果有人可以请告诉我我做错了什么，我会给他们我的第一个孩子。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T13:52:51.990

您正在混淆[PCRE 函数](http://docs.php.net/manual/en/ref.pcre.php)和[POSIX 正则表达式函数](http://docs.php.net/manual/en/ref.regex.php)。您正在使用带有 POSIX 正则表达式函数的[Perl 兼容正则表达式。](http://docs.php.net/manual/en/pcre.pattern.php)

所以替换`ereg`为`preg_match`它应该可以工作：

```
if (!preg_match('/^[2-5]\d{5}$/', $_POST['packageNumber'])) {
    echo "The package number is not the correct format.";
}
if (!preg_match("/^[2-5]\d{5}\.[1-2]$/", $_POST['packageModifier'])) {
    echo "The package modifier is not the correct format.";
}
if (!preg_match("/^[0-9a-zA-Z\s\-.]{0,50}$/", $_POST['customerNumber'])) {
    echo "The customer number is not the correct format.";
} 
```

除了修复 PHP 语法错误之外，我还为要匹配的字符串的开始 ( `^`) 和结束 ( ) 添加了锚点。`$`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T13:53:54.377

你不需要锚定正则表达式吗？

否则 '111111111111111211111111111' 将匹配 /[2-5]\d{5}/。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T13:59:44.567

我假设您刚刚错过了 $_POSTS 上的结束 ] 并且我已经在行的开头和结尾添加了锚点并使用了 preg_match。

如果你不锚定它并且模式匹配字符串中的任何地方，那么整个事情都会匹配。例如。

如果第一个没有锚定，“dfasfasfasfasf25555555as5f15sdsdasdsfghfsgihfughd54”将被匹配。

**第一**

```
if (!preg_match('/^[2-5]\d{5}$/', $_POST['packageNumber'])) {
 echo "The package number is not the correct format.";
} 
```

**第二**

```
if (!preg_match('/^[2-5]\d{5}\.[2-5]$/', $_POST['packageModifier'])) {
  echo "The package modifier is not the correct format.";
} 
```

**第三**

```
if (!preg_match('/^[0-9a-zA-Z\s\-.]{0,50}$/m', $_POST['customerNumber'])) {
 echo "The package modifier is not the correct format.";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T14:13:47.423

当使用 POSIX 正则表达式（[被 PHP 5.3 弃用](http://php.net/manual/en/intro.regex.php)）时，你应该像这样编写测试：

```
if (ereg('^[2-5][0-9]{5}$', $_POST['packageNumber']) === false)
{
   echo "The package number is not the correct format.";
}

if (ereg('^[2-5][0-9]{5}\\.[1-2]$', $_POST['packageModifier']) === false)
{
   echo "The package modifier is not the correct format.";
}

if (ereg('^[[:alnum:][:space:].-]{0,50}$', $_POST['customerNumber']) === false)
{
   echo "The customer number is not the correct format.";
} 
```

请注意，我锚定了正则表达式——否则 customerNumber 将始终匹配（使用零长度匹配）。

有关更多信息，请参阅[POSIX 正则表达式手册页](http://www.tin.org/bin/man.cgi?section=7&topic=regex)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T16:34:09.423

```
preg_match('/^[2-5]\d{5}$/', $str); // 1-st
preg_match('/^[2-5]\d{5}\.[1-2]$/', $str); // 2-nd
preg_match('/^[0-9a-z\s\-\.]{0,50}$/i', $str); // 3-rd 
```

你的错误：

1.  您没有转义斜杠，最后正则表达式“\d”仅表示“d”，但“\d”表示“\d”。
2.  您必须通过 ^ 和 $ 符号将 regesp 锚定到 beginnig 和整个字符串的结尾。

就这样 ;）

PS：更好地为字符串文字使用单引号 - 它们更快更安全......

# wpf - 如何在 WPF RichTextBox 中强制插入模式

> ID：901566
> 
> 赞同：1
> 
> 时间：2009-05-23T13:52:51.413
> 
> 标签：wpf, richtextbox

有谁知道如何控制 WPF RichTextBox 的插入模式。我想强制 RichTextBox 始终处于覆盖模式而不是插入模式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T17:15:32.960

不幸的是，似乎没有记录在案的方式来做到这一点。我知道的唯一方法是使用反射，如下所示，但这种技术可以访问 RichTextBox 的内部工作。它适用于当前版本的 WPF，但不能保证它会继续工作，因此使用它需要您自担风险。

```
PropertyInfo textEditorPropertyInfo = typeof(RichTextBox).GetProperty("TextEditor", BindingFlags.NonPublic | BindingFlags.Instance);

        if (textEditorPropertyInfo == null)
            throw new NotSupportedException("SetOverwriteable not support on this platform");

        object textEditor = textEditorPropertyInfo.GetValue(this, null);
        PropertyInfo overtypeModePropertyInfo = textEditor.GetType().GetProperty("_OvertypeMode", BindingFlags.NonPublic | BindingFlags.Instance);

        if (overtypeModePropertyInfo == null)
            throw new NotSupportedException("SetOverwriteable not support on this platform");

        overtypeModePropertyInfo.SetValue(textEditor, true, null); 
```

以上需要在构造函数之后发生。

# iphone - 是否可以通过 3G 上的 NAT 穿越技术连接 iPhone 进行对等 2 对等游戏

> ID：901569
> 
> 赞同：4
> 
> 时间：2009-05-23T13:53:50.147
> 
> 标签：iphone, networking, tcp, network-programming, udp

是否可以将 iPhone 连接到另一部 iPhone 或任何其他使用该游戏协议的网络客户端。

我在想我可以使用与 XBox 360 中相同的[NAT 遍历技术](http://www.brynosaurus.com/pub/net/p2pnat/)通过防火墙在用户 XBox 上托管游戏。

为了使 NAT 遍历有效地工作，我必须有一个中央服务器，它允许客户端“广播”他们托管的内容，以便另一个客户端可以启动 NAT 连接。在提供的链接中，这称为中继。

美国 AT&T 3G 网络是否有任何固有的限制会阻止 NAT 穿越技术（您是否仅限于 wifi 防火墙 NAT 穿越）？

NAT 穿越项目： - [PJSIP](http://www.pjsip.org/pjnath/docs/html/) - 通过使用基于标准的协议（例如 STUN、TURN 和 ICE）提供 NAT 穿越功能。- [Freecast 使用 Apache MINA Java 网络库进行 NAT 遍历](http://www.nabble.com/Another-MINA-use-case:-freecast.org-td7521483.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T20:16:44.917

iPhone OS 3.0 将有一个 API 用于多人游戏和与您附近区域的设备连接，

> “你可以在给定区域内找到其他 iPhone 和 iPod Touch 与你玩相同的游戏；Forstall 举了两个孩子在汽车后座的例子。iPhone 3.0 将通过蓝牙自动发现其他应用程序，并且没有配对. “完全无缝，”他承诺。Bonjour 是其背后的后端技术，它不仅适用于游戏。

资料来源：[CNET Live Blog](http://news.cnet.com/8301-13579_3-10197216-37.html)和 [Apple 特别活动 Quicktime 视频](http://www.apple.com/quicktime/qtv/preview-iphone-os/)演示开始大约 20 分钟。

如果您想要的不仅仅是玩附近的设备，您可能会遇到 3G 网络上的带宽上限问题以及取决于用户所在位置的延迟问题。具有非常零星的 3G 覆盖的 Boonies 与美国市中心主要城市的多个蜂窝塔集中在一个小区域。您也可能会遇到 AT&T 的问题，具体取决于游戏通过 3G 网络从手机发送和接收的数据量，因为多人游戏需要玩家和服务器（即使它是一个玩家）发回信息不断地来回。不过有趣的想法！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-13T00:23:39.980

对的，这是可能的。

Eyeball Networks 发布了用于[iPhone NAT Traversal的 SDK](http://www.voipforiphone.net/iphone-nat-traversal.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-03T00:33:24.320

AT&T 似乎使用随机对称 NAT——这意味着在没有中继服务器的情况下，无法在其网络上的 2 部 iphone 之间进行遍历。我不知道的是，如果 AT&T 上的 iPhone 位于 AT&T 网络的同一部分，或者是否有防火墙，它们是否可以直接使用它们的私有地址相互联系。上次我检查 TMobile 使用了端口受限的锥形 NAT，因此 TMobile 上的 iPhone 之间可以遍历，但不能从 TMobile 到 AT&T。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-14T23:02:47.997

3G是个大问题。如果您想通过 3G 与其他播放器建立 UDP 连接，您可能想尝试这种技术：

[https://drive.google.com/file/d/0B1IimJ20gG0SY2NvaE4wRVVMbG8/view?usp=sharing](https://drive.google.com/file/d/0B1IimJ20gG0SY2NvaE4wRVVMbG8/view?usp=sharing)

# php - How to print list using hierarchical data structure?

> ID：901576
> 
> 赞同：2
> 
> 时间：2009-05-23T13:58:14.117
> 
> 标签：php, list, hierarchy

When I run this code:

```
foreach ($tree as $node) {
    echo str_repeat(' ', $node->tree_depth * 4) . $node->id . PHP_EOL;
} 
```

I get well formatted text like:

```
Food
 Fruit
   Red
     Cherry
     Strawberry
               Cool
               Not cool
   Yellow
     Banana
 Meat
   Beef
   Pork 
```

But I want to create a list with `<ul><li>...`:

I tried with:

```
echo '<ul>';
$prev_depth = 0;
foreach($table->fetchTree() as $row) {
    if ($row->tree_depth > $prev_depth) {
        echo '<li><ul>';
    } else if ($row->tree_depth < $prev_depth) {
        echo '</li></ul>';
    }
    echo '<li>' . $row->name . '</li>';
    $prev_depth = $row->tree_depth;
}
echo '</ul>'; 
```

But I have some extra ul tags and so on. I lost 2 days on this so if you can help me please post here...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T14:47:03.660

Try this algorithm:

```
$tree = array(
    array('Food', 0),
    array('Fruit', 1),
    array('Red', 2),
    array('Cherry', 3),
    array('Strawberry', 3),
    array('Cool', 4),
    array('Not cool', 4),
    array('Yellow', 2),
    array('Banana', 3),
    array('Meat', 0),
    array('Beef', 1),
    array('Pork', 1),
);

$depth = -1;
$flag = false;
foreach ($tree as $row) {
    while ($row[1] > $depth) {
        echo "<ul>\n", "<li>";
        $flag = false;
        $depth++;
    }
    while ($row[1] < $depth) {
        echo "</li>\n", "</ul>\n";
        $depth--;
    }
    if ($flag) {
        echo "</li>\n", "<li>";
        $flag = false;
    }
    echo $row[0];
    $flag = true;
}
while ($depth-- > -1) {
    echo "</li>\n", "</ul>\n";
} 
```

Here you just need to replace `$tree` by `$table->fetchTree()`, `$row[0]` by `$row->name` and `$row[1]` by `$row->tree_depth`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T14:30:42.070

Try this code instead:

```
<?php
echo "<ul>\n";

$tree = array(
    array('Food', 0),
    array('Fruit', 1),
    array('Red', 5),
    array('Cherry', 3),
    array('Strawberry', 3),
    array('Cool', 4),
    array('Not cool', 4),
    array('Yellow', 2),
    array('Banana', 3),
    array('Meat', 0),
    array('Beef', 4),
    array('Pork', 2),
);

$depth = 0;

foreach ($tree as $node) {
  if ($node[1] > $depth)
    echo str_repeat("<ul>\n", $node[1] - $depth);
  if ($node[1] < $depth)
    echo str_repeat("</ul>\n", $depth - $node[1]);
  $depth = $node[1];

  echo "<li>" .  $node[0] . "\n";
}
echo str_repeat("</ul>\n", $depth+1);
?> 
```

I've updated it to output fewer `<li>` tags, thereby reducing the number of bullets. But on the other hand, this will generate HTML that wont validate since a jump of more than one level will result in a `<ul><ul>` being generated.

# iphone - 为什么升级数据库时从 App Store 更新 iPhone 应用程序失败？

> ID：901590
> 
> 赞同：2
> 
> 时间：2009-05-23T14:05:32.073
> 
> 标签：iphone, sqlite

我发布了一个应用程序更新，它升级了数据库，即。在捆绑包中执行一个脚本文件，将一列添加到现有表等。我已经通过在我的设备上从 xcode 部署以前的版本构建然后部署最新版本来测试这一点。升级工作正常。

昨天我的发行版本被应用商店接受了。当我启动它时，我的噩梦场景实现了，在数据库升级期间它失败了！我已经检查了分发版本，并且 upgradeSQL 文件在那里，所以它似乎不是缺少的资源文件，尽管我不确定。我不知道我应该如何调试它。除了代码签名之外，来自应用商店的分发版本和从 xcode 部署的发布/调试版本有什么区别？对我来说没有意义。

这是我的崩溃日志和失败的代码：

```
0   libSystem.B.dylib               0x3141d414 pread + 20
1   libsqlite3.0.dylib              0x303a2154 unixRead + 40
2   libsqlite3.0.dylib              0x303bd7c4 sqlite3PagerAcquire + 3748
3   libsqlite3.0.dylib              0x303c7718 sqlite3BtreeNext + 260
4   libsqlite3.0.dylib              0x303c7b84 sqlite3BtreeNext + 1392
5   libsqlite3.0.dylib              0x304272b8 sqlite3VdbeExec + 38668
6   libsqlite3.0.dylib              0x30428944 sqlite3Step + 504
7   libsqlite3.0.dylib              0x303ecbc4 sqlite3_exec + 600
8   MyApp                       0x00046ae4 +[DBUpgradeService executeUpgradeScript:] (DBUpgradeService.m:94)
9   MyApp                       0x000469aa +[DBUpgradeService upgradeV1_0ToV1_1] (DBUpgradeService.m:67)
10  MyApp                       0x0004687a +[DBUpgradeService upgradeDBIfNecessary] (DBUpgradeService.m:27)
11  MyApp                       0x000021ec -[MyAppAppDelegate applicationDidFinishLaunching:] (MyAppAppDelegate.m:49)
12  UIKit                           0x30a4ef24 -[UIApplication performInitializationWithURL:asPanel:] + 160
13  UIKit                           0x30a57dec -[UIApplication _runWithURL:] + 644
14  Foundation                      0x306945a2 __NSFireDelayedPerform + 326
15  CoreFoundation                  0x30269d88 CFRunLoopRunSpecific + 2642
16  CoreFoundation                  0x30269320 CFRunLoopRunInMode + 44
17  GraphicsServices                0x31567e58 GSEventRunModal + 268
18  UIKit                           0x30a4fa6c -[UIApplication _run] + 520
19  UIKit                           0x30a591d0 UIApplicationMain + 1132
20  MyApp                       0x00002090 main (main.m:20)
21  MyApp                       0x0000202c start + 44

+ (BOOL) executeUpgradeScript:(NSString*) scriptName{
    NSString *resourcePath = [[NSBundle mainBundle] resourcePath];
    NSString *scriptPath = [resourcePath stringByAppendingPathComponent:scriptName];

    NSString* upgradeScript = [NSString stringWithContentsOfFile:scriptPath];
    NSArray* lines = [upgradeScript componentsSeparatedByString:@"\n"];
    //begin transaction
    NSString* begin = [NSString stringWithString:@"BEGIN TRANSACTION"];

    sqlite3_exec([DatabaseManager getDatabase], begin.UTF8String , nil , nil , nil);
    BOOL failed = NO;
    for( NSString* line in lines) {
        const char *sql = line.UTF8String;
        char* error = nil;
        sqlite3_exec([DatabaseManager getDatabase], sql , nil , nil , &error); //THIS LINE FAILS
        if(error != nil) {
            NSLog([NSString stringWithCString:error]);
            failed = YES;
            break;
        }
    }

    if(failed){
        return NO;
    }
    else{
        NSString* commit = [NSString stringWithString:@"COMMIT"];
        sqlite3_exec([DatabaseManager getDatabase], commit.UTF8String , nil , nil , nil);
        return YES;

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T15:43:03.283

您不能修改应用程序包中的文件（请参阅 epatel 的[链接](http://tinyurl.com/pkeu9m)）。作为构建过程的一部分，应用程序会被签名，并且修改捆绑包中的文件会破坏签名。

您应该使用应用程序的文档目录。您应该将您的 resourcePath 分配替换为：

```
NSString *resourcePath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T17:42:59.907

如果数据库的升级在启动阶段需要很长时间，应用程序可能会被踢出。

解决此类问题的一种方法是将升级放在 NSThread

```
- (void)upgradeSomething:(id)sender
{
  NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init]; 

  // Do something here that takes time

  // and maybe signal when done with some flag or thing...

  [pool release];
}

- (void)awakeFromNib
{
    // The usual stuff

    // and detach a NSThread for upgrade 

    [NSThread detachNewThreadSelector:@selector(upgradeSomething:) 
                             toTarget:self 
                           withObject:nil]
} 
```

阅读[此处](http://tinyurl.com/ralnyz)了解保持事件循环处于活动状态的原因。

# asp.net-mvc - ASP.NET MVC 中的替代用户管理

> ID：901620
> 
> 赞同：9
> 
> 时间：2009-05-23T14:33:29.147
> 
> 标签：asp.net-mvc

我正处于一个新的 ASP.NET MVC 应用程序的规划阶段，其中一个要求是存储一些用户信息，这些信息不属于 ASP.NET MVC 附带的 User 类中的标准集的一部分。我想这归结为两个问题。

1) 我可以编辑已经用于存储我需要的信息的类吗？

2）如果我自己滚动，当尝试使用 User.IsAuthenticated 方法锁定某些视图时，如何保留像 Authentication 部分这样的东西？

我考虑的另一种选择是使用按原样提供的 User 类，而不是将其他信息放入一个单独的表中，并以 guid userid 作为外键。

建议？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-23T19:22:53.177

正如@Burt 所说，配置文件是一种选择，并提供了很大的灵活性。

我也有类似的需要跟踪员工信息，但我选择推出自己的员工类并创建与标准用户的关系。~~我真的很喜欢这样的结果，因为我可以将任何特定于员工的业务逻辑与用户类~~成员系统分开。

由于不是每个用户都会与员工绑定，这对我来说更有意义。它可能不适合您，但它是一种替代方案。

所以，我有类似的东西：

```
public class Employee
{
    public Employee(string name) : this()
    {
        Name = name;
    }

    public virtual string Name { get; set; }
    public virtual string Title { get; set; }
    public virtual decimal Salary { get; set; }
    public virtual decimal Hourly { get; set; }
    public virtual decimal PerDiem { get; set; }
    public virtual string StreetAddress { get; set; }
    public virtual Guid UserId { get; set; }
    public virtual MembershipUser User {
        get
        {
            // note that I don't have a test for null in here, 
            // but should in a real case.
            return Membership.GetUser(UserId);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-08-15T08:18:34.013

请参阅[ASP.Net MVC Membership Starter Kit](http://www.codeplex.com/MvcMembership)。它提供了管理用户和角色所需的 Asp.Net MVC 控制器、模型和视图。它将为您缩短一半的距离。

开箱即用的入门套件为您提供以下功能：

*   用户列表
*   角色列表
*   用户帐户信息
*   更改电子邮件地址
*   更改用户的角色

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T14:51:18.597

查看属于 MS 提供的会员功能一部分的配置文件。它们是可扩展的并且非常灵活。

# c# - 如何将 cs 文件添加到现有 C# 项目？

> ID：901621
> 
> 赞同：6
> 
> 时间：2009-05-23T14:33:44.310
> 
> 标签：c#, visual-studio-2008, file

不久前，我用 Microsoft Visual C# 2008 Express Edition 编写了一个小程序。其中包含一个名为“ProblemReport.cs”的文件，它有自己的表单和 ProblemReport 类。

我正在编写一个新程序并希望重用此代码。（仍在 MS Vis C# 2008 express 中工作）

在我的新程序中，在 C# 解决方案资源管理器中，我右键单击我的项目并选择“添加现有项目...”，然后添加了 ProblemReport.cs、ProblemReport.designer.cs 和 ProblemReport.resx。

我在这里缺少什么步骤？当我回到新程序中的主窗体并尝试实例化“ProblemReport”的新实例时，我收到错误消息：

“找不到命名空间名称'ProblemReport'的类型（您是否缺少 using 指令或程序集引用？）”

显然 - 我应该做点别的事情来让它工作......只是不确定它是什么！

-阿迪娜

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-23T14:34:45.447

确保所有 CS 文件都在同一个命名空间中。听起来导入的项目不适合您的新项目。

确保这件事：

```
namespace MyProgram //same as the rest of your project
{

    public class ProblemReport
    {
    }

} 
```

同时在您的其他 .cs 文件中....

```
namespace MyProgram 
{

     public class SomeClass
     {
           public void DoSomething()
           {
               ProblemReport. //you should get intellisense here.
           }
      }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T14:38:02.133

您最好将 ProblemReport 提取到它自己的类库（单独的 dll）中，这样您只有一份代码副本。

创建一个新的类库项目，将 ProblemReport.cs、ProblemReport.designer.cs 和 ProblemReport.resx 复制到其中并根据需要更新命名空间。构建它并将 dll 放在中心位置。然后从您的两个程序中添加对该类库的引用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T14:36:08.923

您必须在新项目中添加“使用”指令 -

```
using ProblemReport; 
```

然后您应该能够访问 ProblemReport 类。当然，这取决于 ProblemReport.cs 文件的命名空间名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T14:35:21.920

当您创建它时，它可能使用了不同的命名空间，因为默认情况下这些命名空间是从项目名称生成的。

在 .CS 文件中，命名空间是否与项目其余部分的命名空间相匹配？

# c# - WPF：一个非常简单的表单的 XamlParserException？

> ID：901626
> 
> 赞同：0
> 
> 时间：2009-05-23T14:35:13.200
> 
> 标签：c#, .net, wpf

我不相信这一点：刚刚用一个组合框构建了一个非常简单的表单，当用户选择一个项目时，标签将显示选择。这是我的代码：

```
<Window x:Class="WpfApplication8.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <Grid>
        <ComboBox Height="23" Margin="139,0,19,14" Name="comboBox1" Text="Worker"
                  VerticalAlignment="Bottom" IsReadOnly="True" SelectionChanged="comboBox1_SelectionChanged">
            <ComboBoxItem Name="None" Selector.IsSelected="True">Select Target</ComboBoxItem>
            <ComboBoxItem Name="Alice">Alice</ComboBoxItem>
            <ComboBoxItem Name="Bob">Bob</ComboBoxItem>
            <ComboBoxItem Name="Chris">Chris</ComboBoxItem>
            <ComboBoxItem Name="Dan">Dan</ComboBoxItem>
        </ComboBox>
        <Label Height="28" Margin="15,0,0,14" Name="label1" 
               VerticalAlignment="Bottom" Content="Assign to: " HorizontalAlignment="Left" Width="120"></Label>
    </Grid>
</Window> 
```

后面的代码：

```
private void comboBox1_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    label1.Content = comboBox1.SelectedValue;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T14:51:33.730

这是全部在 xaml 中的简化版本：

```
<Page
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <StackPanel>  
          <ComboBox Name="comboBox1" Text="Worker" IsSynchronizedWithCurrentItem="True"
                  VerticalAlignment="Bottom" IsReadOnly="True" >
            <ComboBoxItem Name="None" Selector.IsSelected="True">Select Target</ComboBoxItem>
            <ComboBoxItem Name="Alice">Alice</ComboBoxItem>
            <ComboBoxItem Name="Bob">Bob</ComboBoxItem>
            <ComboBoxItem Name="Chris">Chris</ComboBoxItem>
            <ComboBoxItem Name="Dan">Dan</ComboBoxItem>
        </ComboBox>
        <Label Name="label1" DataContext="{Binding ElementName=comboBox1, Path=SelectedItem}"
               VerticalAlignment="Bottom" Content="{Binding Name}" HorizontalAlignment="Left"></Label>

  </StackPanel>
</Page> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T14:46:51.337

以下作品：

```
 protected void comboBox1_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        if (label1 != null)
            label1.Content = ((ComboBoxItem)comboBox1.Items[comboBox1.SelectedIndex]).Content;
    } 
```

安德鲁

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T14:50:00.127

另一种方法是，如果您不想检查标签是否为空，则在加载窗口后添加选择更改处理程序，因为它会在标签加载之前触发一个：

代码背后：

```
 public Window1()
    {
        InitializeComponent();
        this.Loaded += new RoutedEventHandler(Window1_Loaded);
    }

    void Window1_Loaded(object sender, RoutedEventArgs e)
    {
        comboBox1.SelectionChanged+=new SelectionChangedEventHandler(comboBox1_SelectionChanged);
    }

    protected void comboBox1_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        label1.Content = ((ComboBoxItem)comboBox1.Items[comboBox1.SelectedIndex]).Content;
    } 
```

标记：

```
<Grid>
    <ComboBox Height="23" Margin="139,0,19,14" Name="comboBox1" Text="Worker"
              VerticalAlignment="Bottom" IsReadOnly="True">
        <ComboBoxItem Name="None" Selector.IsSelected="True">Select Target</ComboBoxItem>
        <ComboBoxItem Name="Alice">Alice</ComboBoxItem>
        <ComboBoxItem Name="Bob">Bob</ComboBoxItem>
        <ComboBoxItem Name="Chris">Chris</ComboBoxItem>
        <ComboBoxItem Name="Dan">Dan</ComboBoxItem>
    </ComboBox>
    <Label Height="28" Margin="15,0,0,14" Name="label1" 
           VerticalAlignment="Bottom" Content="Assign to: " HorizontalAlignment="Left" Width="120"></Label>
</Grid> 
```

安德鲁

# java - 为什么 AspectJ 不编译 Spring 的 @Configurable 工作？

> ID：901632
> 
> 赞同：25
> 
> 时间：2009-05-23T14:36:45.117
> 
> 标签：java, maven, aop, spring-aop, compile-time-weaving

**更新 5：**我已经下载了基于最新 Eclipse 的最新 Spring ToolsSuite IDE。当我将我的项目作为 Maven 项目导入时，Eclipse/STS 似乎使用 Maven 目标来构建我的项目。这意味着 AspectJ 最终在 Eclipse 中正常工作。

**更新 4：**我最终只使用 Maven + AspectJ 插件进行编译时编织，有效地绕过了 Eclipse 的机制。

**更新 3：** AspectJ 的 Eclipse 插件似乎破坏了 Eclipse 正确发布到 Tomcat 的能力。只有通过删除项目中的 AspectJ 功能，我才能让它再次正确发布。很烦人。

**更新 2：**我现在在 Eclipse 中工作。这么说让我很不舒服，但我不知道我是如何从 Eclipse 或 Maven 构建中得到它的。它似乎是编译问题而不是运行时问题。

**更新 1：**看来我已经通过 Maven 构建让它工作了，但我不知道如何。Eclipse 仍然无法正常工作。*我在pom.xml*中唯一更改的是添加这些（无关紧要的？）配置参数：

```
<source>1.6</source>
<complianceLevel>1.6</complianceLevel>
<verbose>true</verbose>
<showWeaveInfo>true</showWeaveInfo>
<outxml>true</outxml> 
```

我实际上担心我会重复[这个问题](https://stackoverflow.com/questions/828747/why-does-springs-configurable-sometimes-work-and-sometimes-not)，一切都不一致。随着我了解更多，我会不断更新这个问题。

关于 Eclipse，我通过获取我希望编织的二进制方面（在本例中*为 spring-aspects.jar*）并将其从我的类路径中复制出来，取得了一些进展。然后我将这个现在的外部 jar 添加到我的**Aspect Path**中。完成此操作后，Eclipse 会在我的代码中正确显示 AspectJ 标记。令人讨厌的是，我不能将**spring-aspects.jar**留在我的**Java 构建路径**中，该路径由 Maven 通过 Maven 插件为我维护。然而，出于某种原因，AspectJ 插件看不到二进制方面，除非它们被显式添加到**Aspect Path**中。

* * *

**原帖：** @Configurable 是一个 Spring 注释，它允许将依赖项注入到 Spring 外部实例化的对象中（例如，通过 Hibernate 或某些工厂类）。

我之前在加载时编织中使用了这个注释，它*大部分都*有效。有时我会启动并且不会注入任何东西。这个问题产生了[这个 StackOverflow 问题](https://stackoverflow.com/questions/828747/why-does-springs-configurable-sometimes-work-and-sometimes-not)。答案并不多，但大多数人建议我尝试编译时编织，因为可靠性更高。

我为 Eclipse 和 Maven 安装了 AspectJ 插件。这两者都产生似乎是正确编译的类。在 AspectJ 编译之前，我在文本编辑器中打开了其中一个类，但没有发现对 AspectJ 的引用。我在 AspectJ 编译后打开它，Eclipse 和 Maven 生成的版本都引用了**org.aspectj.weaver.MethodDeclarationLineNumber**。这就是为什么我认为它被正确编译的原因。问题是一旦部署，就不会注入任何依赖项。

我的 Spring *applicationContext.xml*确实包括以下内容：

```
 <context:spring-configured />

    <context:component-scan base-package="com.myapp" /> 
```

以上是标记为@Configurable 的类完成DI 所需的全部内容吗？在从加载时编织到编译时编织的转换过程中，我从我的 applicationContext.xml 中删除了META *-* *INF/aop.xml*、*<context:load-time-weaver /> ，并从我的**context.xml*中删除了Spring 的 Tomcat 编织器。

 **我该如何进一步调查这个问题？可能的原因是什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-28T12:49:45.773

它适用于我们在 maven 上使用编译时编织，尝试添加以下插件：

```
<plugin>
<groupId>org.apache.maven.plugins</groupId>
<artifactId>maven-compiler-plugin</artifactId>
<configuration>
    <compilerVersion>1.6</compilerVersion>
    <fork>true</fork>
    <source>1.6</source>
    <target>1.6</target>
</configuration>
</plugin>

<plugin>
<groupId>org.codehaus.mojo</groupId>
<artifactId>aspectj-maven-plugin</artifactId>
<executions>
    <execution>
        <id>compile</id>
        <configuration>
            <source>1.6</source>
            <target>1.6</target>
            <verbose>false</verbose>
            <outxml>true</outxml>
            <aspectLibraries>
                <aspectLibrary>
                    <groupId>org.springframework</groupId>
                    <artifactId>spring-aspects</artifactId>
                </aspectLibrary>
            </aspectLibraries>
        </configuration>
        <goals>
            <goal>compile</goal>
        </goals>
    </execution>
    <execution>
        <id>test-compile</id>
        <configuration>
            <source>1.6</source>
            <target>1.6</target>
            <verbose>false</verbose>
            <aspectLibraries>
                <aspectLibrary>
                    <groupId>org.springframework</groupId>
                    <artifactId>spring-aspects</artifactId>
                </aspectLibrary>
            </aspectLibraries>
        </configuration>
        <goals>
            <goal>test-compile</goal>
        </goals>
    </execution>
</executions>
<dependencies>
    <dependency>
        <groupId>org.aspectj</groupId>
        <artifactId>aspectjweaver</artifactId>
        <version>1.6.4</version>
    </dependency>
</dependencies>
</plugin> 
```

它作为两个单独的执行步骤完成，允许您添加不同的方面库以进行单元测试和编译。

您还需要为 spring-aspects 库添加以下依赖项：

```
 <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-aspects</artifactId>
        <scope>compile</scope>
    </dependency> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-28T08:59:13.850

如果这是您的替代方案，我已在我的应用程序中成功配置了加载时编织。

我的环境：

*   JDK-1.6
*   Spring-2.5.6
*   JPA 与 eclipselink-1.1.0

配置细节：

春天 XML 配置：

```
<context:annotation-config/>
<context:spring-configured/>
<context:load-time-weaver/>

<bean id="baseEntity" class="package.name.BaseEntity" scope="prototype">
  <property name="historyHandler" ref="historyHandler" />
</bean>

<bean id="historyHandler" class="package.name.HistoryJpaHandler" scope="prototype">
  <property name="historyDao" ref="historyDao" />
</bean>

<bean id="historyDao" class="package.name.HistoryJpaDao">
  <property name="entityManagerFactory" ref="entityManagerFactory" />
</bean> 
```

弹簧注解

```
@Configurable("baseEntity")
public abstract class BaseEntity

@Configurable("historyHandler")
public class HistoryJpaHandler extends SessionEventAdapter implements HistoryHandler 
```

Java 虚拟机参数

```
<JAVA_HOME>/bin/java -javaagent:/full/path/to/spring-agent-2.5.6.jar 
```

historyHandler 和 baseEntitty 的实例由 ecriselink 创建。baseEntitty 中的 historyHandler 和 historyHandler 中的 historyDao 由 load-timeweaving 设置。

您可以在 Eclipse 运行配置或 Tomcats catalina.sh/bat 中设置 VM 参数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-03-07T23:09:03.650

如果您没有为此注释正确配置弹簧，则创建 @configurable 类 Autowired 的字段会引发 NullPointerException。按照以下步骤使 @configurable 注释正常工作

这种方法称为**AspectJ 构建时间编织，用于将 spring bean 注入到您的非 spring-made 类**中。

第一步是在eclipse中安装这些插件：

从这两个更新站点安装 eclipse 建议的任何内容：

```
http://download.eclipse.org/tools/ajdt/43/update
http://dist.springsource.org/release/AJDT/configurator/ 
```

安装后，右键单击项目并执行：

```
Configure > Convert to Aspectj
Maven > Update 
```

接下来，您需要将这些添加到您的 pom.xml 中：

**在依赖项下添加：**

```
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-aspects</artifactId>
    <version>4.0.2.RELEASE</version>
</dependency> 
```

**在插件下添加：**

```
 <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>aspectj-maven-plugin</artifactId>
            <version>1.5</version>
            <configuration>
                <showWeaveInfo>true</showWeaveInfo>
                <source>1.7</source>
                <target>1.7</target>
                <Xlint>ignore</Xlint>
                <complianceLevel>1.7</complianceLevel>
                <encoding>UTF-8</encoding>
                <verbose>false</verbose>
                <aspectLibraries>
                    <aspectLibrary>
                        <groupId>org.springframework</groupId>
                        <artifactId>spring-aspects</artifactId>
                    </aspectLibrary>
                </aspectLibraries>
            </configuration>
            <executions>
                <execution>
                    <goals>
                        <goal>compile</goal>
                        <goal>test-compile</goal>
                    </goals>
                </execution>
            </executions>
            <dependencies>
                <dependency>
                    <groupId>org.aspectj</groupId>
                    <artifactId>aspectjrt</artifactId>
                    <version>1.7.0</version>
                </dependency>
                <dependency>
                    <groupId>org.aspectj</groupId>
                    <artifactId>aspectjtools</artifactId>
                    <version>1.7.0</version>
                </dependency>
            </dependencies>
        </plugin> 
```

**重要提示：**请勿`<pluginManagment>`在标签下使用任何`<build>`标签。你的 pom.xml 需要是这样的：

```
<project ....>
    ....
    <dependencies>
        <dependency> 
                    ....
        </dependency>
                ....
    </dependencies>
    <build>
        <plugins>
            <plugin>
                            ....
            </plugin>
                        ....
        </plugins>
    </build>
</project> 
```

最后添加`<context:spring-configured />`到您的 spring 应用程序上下文配置文件中。

现在您可以将 POJO 类注释为`@Configurable`并使用`@Autowired`注释在其中注入 spring bean。这样，每当您创建该 POJO 的新实例时，它将自动配置（例如注入依赖项）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-13T11:18:44.220

就您的 Eclipse 类路径问题而言，您可能会发现这很有用。

[m2eclipse 插件](http://m2eclipse.sonatype.org/)有一个可选的AJDT[集成](https://docs.sonatype.org/display/M2ECLIPSE/Integration+with+AJDT)。集成读取 aspectj-maven-plugin 配置的 aspectLibraries 部分，并将 jars 贡献给 Eclipse 的 Aspect Path。

# security - 最好的“忘记密码”方法是什么？

> ID：901639
> 
> 赞同：54
> 
> 时间：2009-05-23T14:42:21.593
> 
> 标签：security, md5, application-design, forgot-password

> **可能重复：**
> [忘记密码：实现忘记密码功能的最佳方法是什么？](https://stackoverflow.com/questions/522967/forgot-password-what-is-the-best-method-of-implementing-a-forgot-password-funct)

我正在编写一个社区网站。

我想建立一个“忘记密码”功能。

环顾不同的网站，我发现他们采用了以下**三种选择**之一：

1.  向用户发送**一封电子邮件，其中包含指向唯一隐藏 URL 的链接，该 URL**允许他更改密码（Gmail 和 Amazon）

2.  向用户发送一封带有**随机生成的新密码**的电子邮件（Wordpress）

3.  向用户发送**他当前的密码**(www.teach12.com)

**选项#3**对用户来说似乎是最方便的，但由于我将密码保存为 MD5 哈希，我看不到选项#3 对我来说如何可用，因为**MD5 是不可逆的**。这似乎也是**不安全**的选项，因为这意味着网站必须在某处以明文形式保存密码，并且至少明文密码是通过不安全的电子邮件发送给用户的。或者我在这里错过了什么？

因此，如果我不能执行选项#1，**选项#2**似乎是**最简单的编程**，因为我只需要更改用户的密码并将其发送给他。尽管这**有点不安全**，因为您必须通过不安全的电子邮件传达实时密码。然而，这也可能被麻烦制造者滥用，通过输入随机电子邮件和不断更改各种用户的密码来**纠缠用户。**

**选项#1**似乎是**最安全**的，但需要一些额外的编程来处理过期的隐藏 URL 等，但它似乎是大型网站使用的。

**您使用/编程这些不同的选项有什么经验？有什么我错过的选择吗？**

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-23T14:45:21.667

4) 将两个随机金额记入他们的银行帐户，并要求他们输入。
5) Snail 给他们邮寄一些新密码并要求他们输入。
6) 让他们发短信或拨打某个号码，然后在电话中输入一些值号码与他们登记在案的手机号码。
7) 完全摆脱密码管理问题，将其外包给 OpenID 提供商，如 Stack Overflow、Facebook、博客引擎和其他开始做的事情。

除此之外，使用选项 #1 或 #2 以及两个都会在一小时内到期的附加功能。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-08-04T17:00:50.030

我对将 #1 和 #2 描述为等效的答案的赞成票感到震惊。他们根本不是。向用户发送一个短期链接来更改他们的密码是最方便、最常用和最安全的方法，它不涉及带外交互（邮件、短信等）。几个原因：

1.  通过忘记密码链接设置临时密码，用户可以有效地更改用户密码，并在知道用户登录信息的情况下将用户锁定在其帐户之外。有了链接，用户就知道有人在捣乱，他们的访问不会受到影响。
2.  密码重置链接仅在短时间内有效，因此攻击者攻击的窗口非常小。即使他们这样做了，用户也会知道，因为如果攻击者截获该链接并使用它来更改密码，重置链接将不再有效。如果用户没有立即更改新分配**的密码，则截获密码的攻击者可以无限期地悄悄冒充用户**。所以最大的区别是，虽然黑客可以拦截重置密码链接电子邮件，**但如果他们使用该链接更改用户的密码，用户就会知道有问题**，因为该链接不起作用，他们会再次生成密码重置要求。
3.  更易于使用 - 用户只需单击电子邮件中的链接，而不是输入您生成的新随机密码。

安全问题通常会使网站的安全性降低，而不是提高——它们是另一种攻击媒介，通常是最薄弱的环节。我强烈推荐阅读[The Web Application Hacker's Handbook](https://rads.stackoverflow.com/amzn/click/com/0470170778)以获得关于这个主题的精彩讨论。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-23T14:48:19.540

请注意，选项 #2 还要求您跟踪旧密码，如果在 24 小时内未使用新的随机密码，则它会使其失效。

否则，我可能会通过反复给你一个新的随机密码来惹恼你——如果你不在你的电子邮件附近，你可能不知道为什么你不能用你的正常密码登录。

另外，请**避免**要求“识别问题”。这些问题的答案通常比真正的密码更容易猜测/查找——因此每个人都可以将自己识别为我。请参阅[Sarah Palin](http://en.wikipedia.org/wiki/Sarah_Palin_email_hack)的故事，了解最近的一个例子，说明这是多么不安全。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-23T14:57:34.763

## 选项 1 和 2 彼此一样不安全。

那里。我说了。如果用户的电子邮件帐户遭到入侵，那么就没有合理的安全方式来做事，除非您收集更多的私人数据，例如他们的地址、母亲的娘家姓——所有这些都可以猜到。

我见过的最好的（尽管最烦人的）版本是你需要记住一个秘密问题*和*一个秘密答案的地方。这意味着用户必须记住他们提出的问题，当然，也总是可以忘记的！

如果他们忘记了这个问题并且您是一家“真正的”公司，则始终可以选择通过帖子向用户发送令牌，并提供有关如何重置其所有安全性的说明……黑客不太可能获得访问权限到他们现实生活中的邮件。

一个偏差是在用户创建帐户时收集电话号码。如果存在这种情况并且他们不记得他们的任何详细信息，您可以设置某种自动呼叫系统，告诉他们如何重置他们的详细信息。

还有一件事要提到#2：不要让进程覆盖当前帐户密码。如果发生这种情况，任何人都可以说他们忘记了任何帐户的密码，从而引发大量不必要的密码更改。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-23T14:45:18.157

选项 1 或 2 的安全性没有真正的区别。选项 1 实际上与在表单中预加载新密码相同。

事实上，随着网络钓鱼攻击的盛行，有人可能会争辩说，鼓励使用带有长 URL 的选项 1 可能会使人们对点击长而神秘的 URL 的警惕性降低。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-23T14:47:03.940

阅读[OWASP 前十名](http://www.owasp.org/index.php/OWASP_Top_Ten_Project)以确保您的方法符合要求。

[这](http://www.owasp.org/index.php/Top_10_2007)是直接链接。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-23T16:49:01.523

只是快速说明一些与您的问题无关的内容。您提到您使用 MD5 对存储的密码进行哈希处理。无论您选择使用选项 1 还是 2（3 将是最不安全的，因为显而易见的原因），MD5 是一种破解的哈希算法，实际上可以让黑客相当容易地访问受保护的帐户MD5 哈希。

您可以在以下 URL 阅读有关该漏洞的更多信息：en.wikipedia.org/wiki/MD5

更好的散列解决方案是类似于 SHA，它仍然是一种稳定且安全的散列算法。结合选项 #1 或 #2，您应该有一个相当安全的系统来保护您的用户密码，除了最坚定的黑客之外的所有人。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-23T14:54:07.653

选项#1 可能是最好的。#3 是不安全的（我还建议使用比 MD5 更强大的东西，例如 SHA1）。选项 #2 不好，因为它允许任何随机的人将您锁定在您的帐户之外，直到您检查您的电子邮件，除非您使用安全问题。安全问题通常比密码更容易破解。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-23T20:24:44.817

选项#1 与#2 相比有几个主要优点。如果随机用户在“我忘记密码”框中输入我的电子邮件地址，我的密码将不会被重置。此外，它稍微更安全一点，因为网站密码没有永久记录在您的 gmail 收件箱中。

这里缺少的一个关键部分是您在 #1 中提供的链接**仅适用于一次密码重置并且有时间限制**

所有这些解决方案意味着您将您的电子邮件收件箱视为统治所有这些的“一环”。无论如何，大多数在线服务现在似乎都在这样做。

我的首选方法是尽可能使用 openid。密码管理是地狱，似乎没有人完全正确。把这个问题交给别人更容易。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-23T14:48:12.753

我同意您关于选项 #3 不安全的评论。

至于编程#1 或#2，选项#2 更容易编程，但#1 并不难，两者可能彼此一样安全。

无论您选择哪个选项，您还可以考虑通过将个人信息请求（您在注册期间获得）作为忘记密码过程的一部分来提高安全性。

我已经对系统进行了编程，其中您有一个用户名，并且要获得一个新密码，您必须输入您的用户名和您的电子邮件地址。您可以收到有关您的用户名的提醒，但要点是有人可能无法猜出您的用户名和电子邮件，但如果您仅通过电子邮件进行猜测，则安全性较低。

秘密问题是一种处理个人信息部分的方法。我个人认为它们没有提供太多价值，因为人们倾向于选择许多人知道答案、能够猜测或能够找出答案的问题。但是，只要您将它与已经相对安全的方法结合使用，总比没有好。

显然，你做的越多，编程工作就越多。

最简单的方法是：

1.  有一个“提醒我我的用户名”链接（输入电子邮件）。不要告诉用户是否发送了电子邮件，因为人们可以使用它来确定电子邮件地址是否属于成员。始终告诉用户检查他们的收件箱以获取提醒电子邮件，但仅在某人是会员时才发送；和
2.  需要用户名和电子邮件才能收到新的一次性密码。该密码应该只持续一个小时左右。当用户使用它时，他们应该被强制立即更改他们的密码。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-23T15:11:03.487

选项 4：要求用户通过输入其帐户名和电子邮件地址来重置密码。只要您不在网站上披露真实姓名或电子邮件地址（为什么您会在这个时代？），这是一种相当安全且防篡改的方法。发送指向重置页面的链接，而不是密码本身。

选项 5：使用[OpenID](http://openid.net/)并将责任转交给第三方来担心它。

老实说，尽管这比大多数网站需要的努力要多得多。我喜欢通过电子邮件接收明文密码，因为我将它们存储在收件箱的“注册”文件夹中。这样我就可以在我忘记网站密码时查找它们（这种情况经常发生！）。如果有人正在阅读我的电子邮件，那么我需要担心的问题比使用我的 Twitter 帐户（如果我有的话）的人要担心的多。当然银行和公司有更严格的要求，但你没有具体说明你的网站是什么。这是最佳答案的关键。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-23T14:48:35.467

选项1或2都可以。正如您所说，选项 3 是不安全的，因为您需要存储明文密码。您可能会喜欢并使用可逆加密算法来存储/检索密码，但是有更好的替代方案可供您使用，没有理由走这条路。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-23T14:50:20.407

您可以将一个附加选项与您提到的任何选项结合使用：

您可以让用户为他们的密码写一个提醒，当他们忘记密码时，您可以作为第一步发送给他们。如果提醒对用户没有帮助，您可以继续下一个选项。

由于提醒不是密码本身，因此通过邮件发送是安全的（甚至可能直接显示在页面上）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-23T14:51:21.967

如果您正在对它们进行散列，则选项 3 不可用，并且如果您没有对它们进行散列，那么您会感到羞耻。:)

我更喜欢选项 1，将重置密码链接发送到他们的电子邮件，允许他们（在有限的时间内）重置密码。它确实需要更多的工作，但对他们来说很容易使用，并且最终与他们的电子邮件登录过程一样安全。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-23T15:01:42.007

您可以在 #1 和 #2 之间进行混合，同时利用两者的优势：

向用户发送一封电子邮件，其中包含指向唯一隐藏 URL 的链接，该 URL 允许他更改随机生成的新密码。

该页面可能是 SSL，密码可能会在 12-24 小时内过期。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-07-01T21:21:52.253

我尝试了几种我不太满意的方法。我对下一个项目的决定是：

1.  用户输入用户名和电子邮件地址
2.  带有包含 url 和 guid 参数的链接的电子邮件已存储在 db 中，有效期为 48 小时
3.  用户确认要重置的密码
4.  新密码通过电子邮件发送给用户
5.  使用新密码登录会显示消息或重定向到更改密码页面。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-08-19T08:49:09.790

指示用户亲自到您的办公室，并用身份证或护照证明她的身份。

当然，这假设您在用户附近设有办事处，并且该帐户的价值足以证明此过程的合理性。适用于例如银行。

# iphone - 核心数据主键

> ID：901640
> 
> 赞同：82
> 
> 时间：2009-05-23T14:44:26.550
> 
> 标签：iphone, cocoa-touch, core-data

这可能看起来很愚蠢，但我仍然不知道如何在 xcdatamodel 文件中将属性标记为主键。我的持久存储是 sqlite 文件。谁能帮我？

在那种情况下，我怎样才能“验证”一个 ID 是唯一的？我应该写一个验证方法还是什么？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-05-24T13:33:28.263

您的选择是：

*   使用`-[NSManagedObject objectID]`. 请注意，此 ID 是临时的，直到第一次保存对象或您调用`-[NSManagedObjectContext obtainPermanentIDsForObjects:error:]`
*   使用函数族为方法`CFUUID`中的每个对象生成 UUID`-awakeFromInsert`
*   创建您自己的类似主键的系统，该系统将整数存储在模型中，并随着每个对象的创建而递增

没有很好的方法来验证属性是否唯一。您将得到的最接近的方法是确保它在创建时是唯一的，然后实现一个自定义设置方法来阻止任何人更改 ID。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-05-23T15:42:59.833

请记住，Core Data 是一个对象图持久性框架，而不是数据库。像主键这样的东西被抽象出来了，因为它们依赖于持久存储的实现。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-05-23T14:59:24.947

Core Data 有自己的主键——你不必添加一个。你可以用

```
NSManagedObjectID *moID = [managedObject objectID]; 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-05-28T22:22:34.170

有时当黑客需要主键的实际 int 时。以下是如何抓住它：

```
NSManagedObjectID *yourManagedObjectID = [yourManagedObject objectID];
int yourManagedObject_PK = [[[[[yourManagedObjectID URIRepresentation] absoluteString] lastPathComponent] substringFromIndex:1] intValue]; 
```

尽管 CoreData 是一个对象图，但如果查看 CoreData 生成的 SQLite 数据库数据，这种获取 NSManagedObject 主键的方式应该不是问题。ii 在同一代码中一起使用了 CoreData 和低级 sqlite3 C 库，并将主键从 CoreData 传递到 sqlite3 以获取记录工作得很好。

！如果您打算在生产中使用此代码，请注意可能对 db 主键转换为 URIRepresentation 的方式进行内部更改，这可能会破坏您的代码。

请享用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T18:40:54.290

无需破解 NSManagedObjectID，您就可以在管理远程数据收集之前快速检查您的属性。

我做了一个实用方法，[在这里检查](https://github.com/malcommac/DMCoreDataUtils)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-22T15:54:45.680

用于检索主键的 Swift 扩展

```
extension NSManagedObject {
    var primaryKey : String {
        guard objectID.uriRepresentation().lastPathComponent.count > 1 else { return "" }
        return objectID.uriRepresentation().lastPathComponent.substring(from: 1)
    }
} 
```

对于字符串

```
extension String
{
    func substring(from : Int) -> String {
        guard self.count > from else { return "" }
        return String(self[self.index(self.startIndex, offsetBy: from)...])
     }
} 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2013-08-13T11:59:09.480

我宁愿使用时间 + 类名作为唯一标识符。

# testdriven.net - TestDriven.NET 选项窗格在哪里？

> ID：901651
> 
> 赞同：1
> 
> 时间：2009-05-23T14:48:47.290
> 
> 标签：testdriven.net

我正在使用 TestDriven.NET 2.21，并且我在创建者的博客上读到现在有一​​个选项窗格。我正在使用 Visual Studio 2008 专业版。问题是，我无法找到如何在任何地方访问此选项窗格。它在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T15:02:01.117

工具 -> 选项 -> TestDriven.NET

# c# - IEnumerable 和字符串数组 - 查找匹配值

> ID：901670
> 
> 赞同：0
> 
> 时间：2009-05-23T14:59:00.703
> 
> 标签：c#, asp.net-mvc, viewmodel, ienumerable

背景：我在视图模型中有一个带有 MultiSelectList 的 ASP.NET MVC 视图页面。我想用 MultiSelectList 对象中的 SelectedValues 列表填充标签。该列表以 IDName 类型存储在 MultiSelectList 中：

```
public class IDName {
    public int ID {get; set;}
    public string Name {get; set;}
} 
```

所以 MultiSelectList.Items 是一个包含 IDName 列表的 IEnumerable。我可以在这个列表上做一个 foreach 并抓取 .Name 来获取每个条目的名称。但是，如果 ID 在 MultiSelectList.SelectedItems 中，我只想这样做，它看起来是一个字符串 []，看起来像：

```
["1", "3", "4"] 
```

所以，当 IDName.ID 在 SelectedItems 列表中时，我只想获取 IDName.Name。

我对 MVC 和 C# 都很陌生，所以我不确定最好的方法。有什么建议么？

更新#2：

好的，我很密集。这有效：

```
list.Items
  .Cast<IDName>()
  .Where(x => list.SelectedValues.Cast<string>().Contains(x.ID.ToString())) 
```

SelectedValues 实际上是一个包含 string[] 的 IEnumerable。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T15:03:12.630

试试下面的。

```
var selected = MultiSelectList.Items
  .Cast<IDName>()
  .Where(x => MultiSelectList.SelectedItems.Contains(x.Name)); 
```

这样做是处理 MultiSelectList.Items 集合中的所有项目。然后它将它们全部转换为强类型 IDName 实例。where 子句会将集合过滤为仅 Name 字段与 SelectedItems 数组中的条目匹配的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T15:05:04.030

您可以使用 LINQ过滤`list`.`ids`

```
list.Where(item => ids.Contains(item.Id.ToString())).Select(item => item.Name) 
```

# javascript - 使用 JavaScript/jQuery 预加载图像的最终最佳方法？

> ID：901677
> 
> 赞同：50
> 
> 时间：2009-05-23T15:02:17.373
> 
> 标签：javascript, jquery, image-preloader

我完全意识到这个问题已经被问到并在任何地方得到了回答，无论是在 SO 还是在关闭。但是，每次似乎都有不同的答案，例如[this](https://stackoverflow.com/questions/761263/what-is-the-best-way-to-preload-multiple-images-in-javascript/761332#761332)、[this](https://stackoverflow.com/questions/257550/php-ajax-best-practice-for-pre-loading-images/257594#257594)和[that](https://stackoverflow.com/questions/476679/preloading-images-with-jquery/476681#476681)。

我不在乎它是否使用 jQuery - 重要的是它可以工作，并且是跨浏览器的。]

那么，预加载图像的最佳方法是什么？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-05-23T15:12:08.647

不幸的是，这取决于你的目的。如果您打算将图像用于样式目的，那么最好的选择是使用精灵。 [http://www.alistapart.com/articles/sprites2](http://www.alistapart.com/articles/sprites2)

但是，如果您打算在 <img> 标签中使用图像，那么您需要预先加载它们

```
function preload(sources)
{
  var images = [];
  for (i = 0, length = sources.length; i < length; ++i) {
    images[i] = new Image();
    images[i].src = sources[i];
  }
} 
```

（修改后的源代码取自[What is the best way to preload multiple images in JavaScript?](https://stackoverflow.com/questions/761263/what-is-the-best-way-to-preload-multiple-images-in-javascript/761332)）

using`new Image()`不涉及使用 DOM 方法的费用，但对指定图像的新请求将被添加到队列中。由于图像此时并未实际添加到页面中，因此不涉及重新渲染。但是，我建议将其添加到页面的末尾（如果可能，所有脚本都应该如此）以防止它包含更多关键元素。

编辑：编辑以正确反映评论，指出需要单独`Image`的对象才能正常工作。谢谢，我很遗憾没有更仔细地检查它。

Edit2：编辑使可重用性更加明显

**编辑3（3年后）：**

由于浏览器处理不可见图像的方式发生了变化（显示：无，或者，如本答案所示，从未附加到文档中），因此首选一种新的预加载方法。

您可以使用 Ajax 请求来强制提前检索图像。使用 jQuery，例如：

```
jQuery.get(source); 
```

或者在我们之前的例子中，你可以这样做：

```
function preload(sources)
{
  jQuery.each(sources, function(i,source) { jQuery.get(source); });
} 
```

请注意，这不适用于按原样正常的精灵的情况。这仅适用于照片画廊或带有图像的滑块/轮播等图像未加载的内容，因为它们最初不可见。

另请注意，此方法不适用于 IE（通常不使用 ajax 来检索图像数据）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-23T23:19:32.170

**雪碧**

正如其他人所提到的，由于各种原因，精灵效果很好，但是，它并没有想象中的那么好。

*   从好的方面来说，您最终只为您的图像发出了一个 HTTP 请求。虽然是 YMMV。
*   不利的一面是，您在一个 HTTP 请求中加载所有内容。由于大多数当前浏览器限制为 2 个并发连接，因此图像请求可能会阻止其他请求。因此 YMMV 和类似菜单背景的东西可能暂时不会渲染。
*   多个图像共享相同的调色板，因此可以节省一些费用，但情况并非总是如此，即使这样也可以忽略不计。
*   压缩得到了改进，因为图像之间有更多的共享数据。

不过，处理不规则形状很棘手。将所有新图像合并到新图像中是另一种烦恼。

**使用 <img> 标签的低插孔方法**

如果您正在寻找**最明确**的解决方案，那么您应该采用我仍然喜欢的低插孔方法。在文档末尾创建指向图像的 <img> 链接，并将 and 设置`width`为`height`1x1 像素，另外将它们放在隐藏的 div 中。如果它们位于页面末尾，它们将在其他内容之后加载。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-26T15:10:31.943

截至 2013 年 1 月，此处描述的所有方法都不适用于我，所以这里是替代方法，测试并使用 Chrome 25 和 Firefox 18。使用 jQuery 和[这个插件](https://github.com/desandro/imagesloaded)来解决加载事件的怪癖：

```
function preload(sources, callback) {
    if(sources.length) {
        var preloaderDiv = $('<div style="display: none;"></div>').prependTo(document.body);

        $.each(sources, function(i,source) {
            $("<img/>").attr("src", source).appendTo(preloaderDiv);

            if(i == (sources.length-1)) {
                $(preloaderDiv).imagesLoaded(function() {
                    $(this).remove();
                    if(callback) callback();
                });
            }
        });
    } else {
        if(callback) callback();
    }
} 
```

用法：

```
preload(['/img/a.png', '/img/b.png', '/img/c.png'], function() { 
    console.log("done"); 
}); 
```

请注意，如果缓存被禁用，您将得到不同的结果，当开发者工具打开时，默认情况下在 Chrome 上是这样，所以请记住这一点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-04-30T07:23:49.390

在我看来，使用一些库引入的 Multipart XMLHttpRequest 将是未来几年的首选解决方案。但是 IE < v8，仍然不支持 data:uri（即使 IE8 支持有限，最多允许 32kb）。这是并行图像预加载的实现 - [http://code.google.com/p/core-framework/wiki/ImagePreloading](http://code.google.com/p/core-framework/wiki/ImagePreloading)，它捆绑在框架中，但仍然值得一看。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-12T20:45:57.477

这是很久以前的，所以我不知道还有多少人对预加载图像感兴趣。

我的解决方案更加简单。

我只是使用CSS。

```
#hidden_preload {
    height: 1px;
    left: -20000px;
    position: absolute;
    top: -20000px;
    width: 1px;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-29T02:38:47.947

这是我的简单解决方案，加载后图像淡入。

```
 function preloadImage(_imgUrl, _container){
        var image = new Image();
            image.src = _imgUrl;
            image.onload = function(){
                $(_container).fadeTo(500, 1);
            };
        } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-23T02:56:54.963

对于我的用例，我有一个带有全屏图像的轮播，我想预加载它。但是，由于图像按顺序显示，并且每个加载可能需要几秒钟，因此按顺序加载它们很重要。

为此，我使用了异步库的`waterfall()`方法（[https://github.com/caolan/async#waterfall](https://github.com/caolan/async#waterfall)）

```
 // Preload all images in the carousel in order.
        image_preload_array = [];
        $('div.carousel-image').each(function(){
            var url = $(this).data('image-url');
            image_preload_array.push(function(callback) {
                var $img = $('<img/>')
                $img.load(function() {
                    callback(null);
                })[0].src = url;
            });
        });
        async.waterfall(image_preload_array); 
```

这是通过创建一个函数数组来工作的，每个函数都被传递了`callback()`它需要执行的参数，以便调用数组中的下一个函数。的第一个参数`callback()`是一个错误信息，如果提供了非空值，它将退出序列，所以我们每次都传递null。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-05-23T15:07:28.690

看到这个：

[http://www.mattfarina.com/2007/02/01/preloading_images_with_jquery](http://www.mattfarina.com/2007/02/01/preloading_images_with_jquery)

关于 SO 的相关问题：

[jquery隐藏预加载](https://stackoverflow.com/questions/775008/jquery-hidden-preload/775084#775084)

# java - Java生成随机数{-1,0,1}

> ID：901689
> 
> 赞同：7
> 
> 时间：2009-05-23T15:08:10.730
> 
> 标签：java, random

我需要一个返回随机整数的函数，该整数只能是 -1、0 或 1。谢谢？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-23T15:13:17.147

正如 Apocalisp 所写，您可以执行以下操作：

```
import java.util.Random;

Random generator = new Random();
int randomIndex = generator.nextInt( 3 ) - 1; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-23T15:10:08.263

如何生成一个从 0 到 2 的随机数并减去 1？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-23T15:13:52.497

[这应该有帮助](http://java.sun.com/javase/6/docs/api/java/util/Random.html)：

```
Random random = new Random();
int value = random.nextInt(3) - 1; 
```

# html - shell脚本中的HTML到文本转换

> ID：901697
> 
> 赞同：2
> 
> 时间：2009-05-23T15:11:35.717
> 
> 标签：html, shell, lynx

我编写了一个 shell 脚本来使用 lynx 将 HTML 源代码转换为纯文本。

这里是：

```
#!/bin/sh

if [ -f = "/usr/bin/lynx" ]
  then
    if [ -f = "$1" ]
      then
        lynx -dump $1 > $2
      else
        echo "File $1 does not exist!"
    fi
  else
    echo "Lynx is not installed!"
fi 
```

现在，虽然 lynx 存在于正确的目录中，并且我传递了正确的参数，但我得到“Lyns 未安装！” 消息或（如果我评论第一个测试）“文件 $1 不存在！”。我不擅长 sh 所以有人可以告诉我脚本有什么问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T15:15:26.987

我认为第一个 if 是错误的，应该替换为

```
if [ -f /usr/bin/lynx ] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T15:16:20.997

尝试删除“-f =”并保留它只是“-f”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T16:35:34.213

```
LINKS=`which links`
if [ -x $LINKS ]; then
   ...
else
   ...
endif 
```

如果它没有安装在 /usr/bin/ 中怎么办？如果由于某种原因它无法执行怎么办？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T16:29:25.180

现在是这样的：

```
#!/bin/sh

if [ -f /usr/bin/lynx ]
  then
    if [ -f $1 ]
      then
        lynx -dump $1 > $2
      else
        echo "File $1 does not exist!"
    fi
  else
    echo "Lynx is not installed!"
fi 
```

测试的问题已经消失了，但现在我收到了这个错误：

第 7 行：$2：不明确的重定向

虽然

如果从控制台运行 lynx -dump site.html > site.txt 工作正常

# c++ - 从 boost 1.38 升级到 1.39 导致我对 boost::algorithm::split 的调用无法编译

> ID：901700
> 
> 赞同：0
> 
> 时间：2009-05-23T15:12:21.160
> 
> 标签：c++, boost

我使用的是 Boost 1.38，我刚刚升级到 1.39。升级破坏了以下代码：

```
std::vector<std::wstring> consoleParser::loadStringsFromFile(const std::wstring &fileName)
{
    std::vector<std::wstring> files;
    std::wstring fileString(loadFileAsString(fileName));
    boost::algorithm::split(files, fileString, boost::is_any_of(L"\r\n'\"")); //Error on this line
    return files;
} 
```

关于导致失败的原因有什么想法吗？我的编译器有助于发出以下内容：

```
c:\boost\boost\utility\addressof.hpp(30) : error C2220: warning treated as error - no 'object' file generated
        c:\boost\boost\utility\addressof.hpp(56) : see reference to class template instantiation 'boost::detail::addr_impl_ref<T>' being compiled
        with
        [
            T=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>
        ]
        c:\boost\boost\function\function_template.hpp(600) : see reference to function template instantiation 'T *boost::addressof<FunctionObj>(T &)' being compiled
        with
        [
            T=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>,
            FunctionObj=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>
        ]
        c:\boost\boost\function\function_template.hpp(491) : see reference to function template instantiation 'bool boost::detail::function::basic_vtable2<R,T0,T1>::assign_to<F>(FunctionObj,boost::detail::function::function_buffer &,boost::detail::function::function_obj_tag)' being compiled
        with
        [
            R=boost::iterator_range<std::_String_iterator<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t>>>,
            T0=std::_String_iterator<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t>>,
            T1=std::_String_iterator<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t>>,
            F=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>,
            FunctionObj=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>
        ]
        c:\boost\boost\function\function_template.hpp(906) : see reference to function template instantiation 'bool boost::detail::function::basic_vtable2<R,T0,T1>::assign_to<Functor>(F,boost::detail::function::function_buffer &)' being compiled
        with
        [
            R=boost::iterator_range<std::_String_iterator<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t>>>,
            T0=std::_String_iterator<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t>>,
            T1=std::_String_iterator<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t>>,
            Functor=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>,
            F=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>
        ]
        c:\boost\boost\function\function_template.hpp(720) : see reference to function template instantiation 'void boost::function2<R,T0,T1>::assign_to<Functor>(Functor)' being compiled
        with
        [
            R=boost::iterator_range<std::_String_iterator<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t>>>,
            T0=std::_String_iterator<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t>>,
            T1=std::_String_iterator<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t>>,
            Functor=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>
        ]
        c:\boost\boost\algorithm\string\detail\find_iterator.hpp(51) : see reference to function template instantiation 'boost::function2<R,T0,T1>::function2<FinderT>(Functor,int)' being compiled
        with
        [
            R=boost::iterator_range<std::_String_iterator<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t>>>,
            T0=std::_String_iterator<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t>>,
            T1=std::_String_iterator<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t>>,
            FinderT=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>,
            Functor=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>
        ]
        c:\boost\boost\algorithm\string\find_iterator.hpp(261) : see reference to function template instantiation 'boost::algorithm::detail::find_iterator_base<IteratorT>::find_iterator_base<FinderT>(FinderT,int)' being compiled
        with
        [
            IteratorT=input_iterator_type,
            FinderT=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>
        ]
        c:\boost\boost\algorithm\string\iter_find.hpp(167) : see reference to function template instantiation 'boost::algorithm::split_iterator<IteratorT>::split_iterator<FinderT>(IteratorT,IteratorT,FinderT)' being compiled
        with
        [
            IteratorT=input_iterator_type,
            FinderT=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>
        ]
        c:\boost\boost\algorithm\string\split.hpp(149) : see reference to function template instantiation 'SequenceSequenceT &boost::algorithm::iter_split<SequenceSequenceT,RangeT,boost::algorithm::detail::token_finderF<PredicateT>>(SequenceSequenceT &,RangeT &,FinderT)' being compiled
        with
        [
            SequenceSequenceT=std::vector<std::wstring>,
            RangeT=std::wstring,
            PredicateT=boost::algorithm::detail::is_any_ofF<wchar_t>,
            FinderT=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>
        ]
        c:\documents and settings\user\my documents\visual studio 2008\projects\pevfind\pevfind\consoleparser.cpp(1529) : see reference to function template instantiation 'SequenceSequenceT &boost::algorithm::split<std::vector<_Ty>,std::wstring,boost::algorithm::detail::is_any_ofF<CharT>>(SequenceSequenceT &,RangeT &,PredicateT,boost::algorithm::token_compress_mode_type)' being compiled
        with
        [
            SequenceSequenceT=std::vector<std::wstring>,
            _Ty=std::wstring,
            CharT=wchar_t,
            RangeT=std::wstring,
            PredicateT=boost::algorithm::detail::is_any_ofF<wchar_t>
        ]
c:\boost\boost\utility\addressof.hpp(30) : warning C4512: 'boost::detail::addr_impl_ref<T>' : assignment operator could not be generated
        with
        [
            T=boost::algorithm::detail::token_finderF<boost::algorithm::detail::is_any_ofF<wchar_t>>
        ] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T15:48:26.543

您的编译失败，因为发出了一个新警告 ( `boost::detail::addr_impl_ref<T>' : assignment operator could not be generated`)，并且您的设置被设置为将警告视为错误。从[this](http://www.nabble.com/-utility--foreach--1.39.0--warning-C4512-td23446419.html)和[this](https://svn.boost.org/trac/boost/ticket/2993)来看，确实是Boost 1.39.0和VS2008的问题。

后一个链接提供了一个修复该问题的补丁。它应该在 Boost 1.40.0 中修复。

另一种方法是暂时禁用“将警告视为错误”标志。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T15:47:41.817

如果我切换到警告级别 4 并将警告设置为错误，我的也会中断。尝试更改这些设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-18T08:12:28.347

由于这种原因，我真的不喜欢“将警告视为错误”，但您可以这样做：

```
#pragma warning (disable:4512) 
```

在 addressof.hpp 的任何 #include 行上方。

# list - 建模问题：相互依赖但可以是专门条目的列表？

> ID：901702
> 
> 赞同：0
> 
> 时间：2009-05-23T15:13:16.820
> 
> 标签：list, modeling, oop

相信我，在问这里之前我已经对这个问题进行了很多思考，我想我已经找到了解决方案，但我想看看你们在解决我自己的问题之前能想出什么:)

**设想：**

在域中，我们有 3 个实体：一个治疗、一个美容店和一个员工。一家美容店可以雇佣 0 到多名员工。现在，美容院列出了可以为顾客提供的一系列治疗方法。每种治疗都有描述、持续时间和价格。每个员工都有一个类似的列表，但每个员工可以专门针对每种治疗（不同的价格或持续时间），添加新的治疗或“删除”美容店的治疗。

..这对我来说似乎是一个相当普遍的问题，所以我希望有人能想出一些聪明的东西:)

到目前为止，我正在考虑让每个治疗都有一个唯一的 id，然后让员工列表自己插入治疗，这将与商店中的治疗具有相同的 id。然后，这些员工待遇将覆盖具有相同 ID 的商店。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T18:42:49.667

我们是在谈论问题的客观表示还是问题的数据库表示？如果它是客观的表示，那么专门的治疗应该只是通用治疗的一个**子类**。

对于问题的关系数据库表示，事情变得有点困难：

```
beautyshop ---= employee
beautyshop ---= treatment_type
treatment_type ---= treatment
employee =--= treatment 
```

（`---=`是一对多，`=--=`是多对多）。

但是我们如何获得美容店提供的治疗清单呢？**我们没有。**相反，我们会从所有美容店员工那里获得一份治疗清单。也就是说，如果一家美容店的员工人数为 0，则它不提供任何治疗服务。

您可以使用`treatment`表中的空字段来指示特定员工使用默认属性进行此处理。如果特定美容店的治疗类型的默认值发生变化，则所有治疗都会更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T18:43:27.077

我建议`Treatments`通过添加`parentTreatment`对类的引用来添加某种继承/专业化机制`Treatment`。您将拥有一组标准`Treatments`，并且每个`Employee`都可以选择和自定义它们。`BeautySalon`s 不会显式存储任何，`Treatments`瞬态和易失`getAvailableTreatments()`方法将遍历关联`Employees`并聚合each 提供的父`Treatments`级。`Treatments``Employee`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T16:37:02.603

为什么要对同一个ID进行不同的处理？

我宁愿设置一个“自定义处理”ID。

# python - 给 Wxwidget Grid 行一个 ID

> ID：901704
> 
> 赞同：2
> 
> 时间：2009-05-23T15:13:30.017
> 
> 标签：python, wxpython, wxwidgets

我在邮件列表中发布了这个，但我得到的回复不太清楚，所以也许我会在这里有更好的运气。

我目前有一个包含数据的网格。我想知道是否有办法为每个生成的行提供一个 ID，或者至少将每行与一个对象相关联。

如果我澄清我在做什么，它可能会更清楚。如下所述。

我从 SQL 表中提取数据并将它们显示在网格中。我允许用户添加/删除行和编辑单元格。

假设用户正在查看一个有 3 行的网格（这又是一个有 3 行的 mysql 表）。如果他在最后一行并按下向下箭头键，则会创建一个新行，他可以在其中输入数据，当他按下回车键时，它将被插入到数据库中。

但是，我需要一种方法来找出哪些行将使用“插入”查询，哪些将使用“更新”查询。

所以理想情况下，当用户通过按下向下箭头创建新行时，我会给该行一个 ID 并将其存储在列表中（或者，如果行已经有 ID，则将其存储在列表中），当用户完成在单元格中输入数据并按回车键，我会检查该行的 ID 是否在列表中。如果是，我会将所有该行的单元格值插入表中，如果不是，我将使用这些值更新 mysql。

希望我说清楚了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T16:02:23.827

当我遇到这种情况时，我所做的就是为 ID 创建一个列并将其宽度设置为 0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T18:05:19.103

您可以制作自己的 GridTableBase 来实现这一点，作为一个简单的示例来帮助您入门，请参阅我对[这个](https://stackoverflow.com/questions/328003/wxpython-updating-a-dict-or-other-appropriate-data-type-from-wx-lib-sheet-csheet/328078#328078)问题的回答。

# php - 检查变量是否有数字php

> ID：901708
> 
> 赞同：19
> 
> 时间：2009-05-23T15:14:51.653
> 
> 标签：php, variables, numbers

我想检查一个变量中是否有一个数字，我只想看看是否有一个我不在乎它是否还有其他东西，如下所示：

```
"abc" - false
"!./#()" - false
"!./#()abc" - false
"123" - true
"abc123" - true
"!./#()123" - true
"abc !./#() 123" -true 
```

如果您想知道所有数字，但如果只有一个数字，则有一些简单的方法可以做到这一点。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-05-23T15:24:15.130

您可以使用以下[`strcspn`](http://php.net/manual/en/function.strcspn.php)功能：

```
if (strcspn($_REQUEST['q'], '0123456789') != strlen($_REQUEST['q']))
  echo "true";
else
  echo "false"; 
```

`strcspn`返回不包含任何整数的部分的长度。我们将它与字符串长度进行比较，如果它们不同，那么一定是一个整数。

无需为此调用正则表达式引擎。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-23T15:19:52.017

```
$result = preg_match("/\\d/", $yourString) > 0; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-07-02T07:57:05.770

秉承@Martin 的精神，我发现了另一个以类似方式工作的功能。

```
(strpbrk($var, '0123456789') 
```

例如测试用例

```
<?php

function a($var) {
    return (strcspn($var, '0123456789') != strlen($var));
}

function b($var) {
    return (strpbrk($var, '0123456789'));
}

$var = array("abc", "!./#()", "!./#()abc", "123", "abc123", "!./#()123", "abc !./#() 123");

foreach ($var as $v) {
    echo $v . ' = ' . b($v) .'<hr />';
}

?> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-23T15:25:06.593

这应该可以帮助您：

```
$numberOfNumbersFound = preg_match("/[0-9]+/", $yourString); 
```

您可以从 preg_match 函数中获得更多信息，因此请查看[其手册](http://uk3.php.net/preg_match)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-23T15:24:32.837

您可以使用此模式使用正则表达式测试您的字符串：

```
$isNumeric = preg_match("/\S*\d+\S*/", $string) ? true : false; 
```

# netbeans6.5 - 可以在他的表单中实现图像背景吗？

> ID：901710
> 
> 赞同：0
> 
> 时间：2009-05-23T15:16:18.140
> 
> 标签：netbeans6.5

有没有一种方法可以在 hos 应用程序中实现图像背景（来自）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T15:20:41.143

根据[http://forums.netbeans.org/topic4381.html&highlight=](http://forums.netbeans.org/topic4381.html&highlight=)，“使您的面板成为 JLayeredPane 并将您要附加图像的组件放在“最低”的组件上”应该可以工作，

# javascript - 如何检查是否在 jQuery 中选中了复选框？

> ID：901712
> 
> 赞同：4978
> 
> 时间：2009-05-23T15:16:39.917
> 
> 标签：javascript, jquery, html, checkbox

我需要检查复选框的`checked`属性并使用 jQuery 基于选中的属性执行操作。

例如，如果`age`复选框被选中，那么我需要显示一个文本框来输入`age`，否则隐藏文本框。

但以下代码`false`默认返回：

```
if ($('#isAgeSelected').attr('checked')) {
  $("#txtAge").show();
} else {
  $("#txtAge").hide();
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<input type="checkbox" id="isAgeSelected"/>
<div id="txtAge" style="display:none">
  Age is selected
</div>
```

如何成功查询`checked`房产？

* * *

## 回答 #1

> 赞同：3601
> 
> 时间：2009-05-23T15:20:33.797

> 如何成功查询选中的属性？

复选框 DOM 元素的`checked`属性将为您提供元素的`checked`状态。

鉴于您现有的代码，您可以这样做：

```
if(document.getElementById('isAgeSelected').checked) {
    $("#txtAge").show();
} else {
    $("#txtAge").hide();
} 
```

但是，有一种更漂亮的方法可以做到这一点，使用[`toggle`](http://api.jquery.com/toggle/)：

```
$('#isAgeSelected').click(function() {
    $("#txtAge").toggle(this.checked);
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<input type="checkbox" id="isAgeSelected"/>
<div id="txtAge" style="display:none">Age is something</div>
```

* * *

## 回答 #2

> 赞同：2095
> 
> 时间：2011-06-22T10:14:41.493

使用 jQuery 的[is()](http://api.jquery.com/is/)函数：

```
if($("#isAgeSelected").is(':checked'))
    $("#txtAge").show();  // checked
else
    $("#txtAge").hide();  // unchecked 
```

* * *

## 回答 #3

> 赞同：623
> 
> 时间：2011-06-23T17:29:18.880

使用 jQuery > 1.6

```
<input type="checkbox" value="1" name="checkMeOut" id="checkMeOut" checked="checked" />

// traditional attr
$('#checkMeOut').attr('checked'); // "checked"
// new property method
$('#checkMeOut').prop('checked'); // true 
```

使用新的属性方法：

```
if($('#checkMeOut').prop('checked')) {
    // something when checked
} else {
    // something else when not
} 
```

* * *

## 回答 #4

> 赞同：258
> 
> 时间：2014-05-20T20:03:29.577

**jQuery 1.6+**

```
$('#isAgeSelected').prop('checked') 
```

**jQuery 1.5 及以下**

```
$('#isAgeSelected').attr('checked') 
```

**任何版本的 jQuery**

```
// Assuming an event handler on a checkbox
if (this.checked) 
```

所有功劳归于[西安](https://stackoverflow.com/a/426276/443427)。

* * *

## 回答 #5

> 赞同：186
> 
> 时间：2010-08-19T13:38:58.290

我正在使用它，它工作得非常好：

```
$("#checkkBoxId").attr("checked") ? alert("Checked") : alert("Unchecked"); 
```

注意：如果复选框被选中，它将返回 true 否则未定义，因此最好检查“TRUE”值。

* * *

## 回答 #6

> 赞同：172
> 
> 时间：2016-08-29T11:38:19.463

采用：

```
<input type="checkbox" name="planned_checked" checked id="planned_checked"> Planned

$("#planned_checked").change(function() {
    if($(this).prop('checked')) {
        alert("Checked Box Selected");
    } else {
        alert("Checked Box deselect");
    }
}); 
```

```
 $("#planned_checked").change(function() {
        if($(this).prop('checked')) {
            alert("Checked Box Selected");
        } else {
            alert("Checked Box deselect");
        }
    });
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<input type="checkbox" name="planned_checked" checked id="planned_checked"> Planned
```

* * *

## 回答 #7

> 赞同：132
> 
> 时间：2012-04-27T11:54:21.343

从 jQuery 1.6 开始， 的行为发生[`jQuery.attr()`](http://api.jquery.com/attr/)了变化，鼓励用户不要使用它来检索元素的选中状态。相反，您应该使用[`jQuery.prop()`](http://api.jquery.com/prop/)：

```
$("#txtAge").toggle(
    $("#isAgeSelected").prop("checked") // For checked attribute it returns true/false;
                                        // Return value changes with checkbox state
); 
```

另外两种可能性是：

```
$("#txtAge").get(0).checked
$("#txtAge").is(":checked") 
```

* * *

## 回答 #8

> 赞同：115
> 
> 时间：2009-05-24T05:30:25.670

这对我有用：

```
$get("isAgeSelected ").checked == true 
```

`isAgeSelected`控件的id在哪里。

此外，@ karim79 的[回答](https://stackoverflow.com/questions/901712/check-checkbox-checked-property-using-jquery/901727#901727)也很好。我不确定我在测试它时错过了什么。

**注意，这是答案使用 Microsoft Ajax，而不是 jQuery**

* * *

## 回答 #9

> 赞同：98
> 
> 时间：2013-08-25T03:11:57.893

如果您使用的是 jquery 的更新版本，则必须寻找`.prop`解决问题的方法：

`$('#isAgeSelected').prop('checked')``true`如果选中，如果未选中，将返回`false`。我确认了这一点，并且我早些时候遇到了这个问题。`$('#isAgeSelected').attr('checked')`并且`$('#isAgeSelected').is('checked')`正在返回`undefined`，这对于这种情况来说不是一个值得回答的问题。所以按照下面给出的做。

```
if($('#isAgeSelected').prop('checked')) {
    $("#txtAge").show();
} else {
    $("#txtAge").hide();
} 
```

希望它有所帮助:)- 谢谢。

* * *

## 回答 #10

> 赞同：73
> 
> 时间：2013-09-29T15:45:05.537

采用：

```
<input type="checkbox" id="abc" value="UDB">UDB
<input type="checkbox" id="abc" value="Prasad">Prasad 
```

```
$('input#abc').click(function(){
  if($(this).is(':checked'))
  {
    var checkedOne=$(this).val()
    alert(checkedOne);

    // Do some other action
  }
}) 
```

如果您希望仅在选中该框而不是在您取消选中时才必须执行所需的操作，这会有所帮助。

* * *

## 回答 #11

> 赞同：70
> 
> 时间：2011-10-06T01:12:52.573

使用`Click`复选框属性的事件处理程序是不可靠的，因为该`checked`属性可以在事件处理程序本身的执行期间更改！

理想情况下，您希望将代码放入`change`事件处理程序中，例如每次更改复选框的值时都会触发它（与更改方式无关*）*。

```
$('#isAgeSelected').bind('change', function () {

   if ($(this).is(':checked'))
     $("#txtAge").show();
   else
     $("#txtAge").hide();
}); 
```

* * *

## 回答 #12

> 赞同：64
> 
> 时间：2019-10-03T08:20:13.953

您可以尝试`change`复选框事件来跟踪`:checked`状态变化。

```
$("#isAgeSelected").on('change', function() {
  if ($("#isAgeSelected").is(':checked'))
    alert("checked");
  else {
    alert("unchecked");
  }
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<input type="checkbox" id="isAgeSelected" />
<div id="txtAge" style="display:none">
  Age is selected
</div>
```

* * *

## 回答 #13

> 赞同：61
> 
> 时间：2012-03-20T19:19:03.430

我决定发布一个关于如何在没有 jQuery 的情况下做同样事情的答案。只因我是叛逆者。

```
var ageCheckbox = document.getElementById('isAgeSelected');
var ageInput = document.getElementById('txtAge');

// Just because of IE <333
ageCheckbox.onchange = function() {
    // Check if the checkbox is checked, and show/hide the text field.
    ageInput.hidden = this.checked ? false : true;
}; 
```

首先，您可以通过它们的 ID 获取这两个元素。然后为复选框的事件分配`onchange`一个函数，该函数检查复选框是否被选中并`hidden`适当地设置年龄文本字段的属性。在该示例中使用三元运算符。

这是一个[小提琴](http://jsfiddle.net/mainerror/cjSkC/)供您测试。

**附录**

如果跨浏览器兼容性是一个问题，那么我建议将 CSS`display`属性设置为*none*和*inline*。

```
elem.style.display = this.checked ? 'inline' : 'none'; 
```

速度较慢但跨浏览器兼容。

* * *

## 回答 #14

> 赞同：60
> 
> 时间：2009-05-23T15:34:24.500

我相信你可以这样做：

```
if ($('#isAgeSelected :checked').size() > 0)
{
    $("#txtAge").show(); 
} else { 
    $("#txtAge").hide();
} 
```

* * *

## 回答 #15

> 赞同：58
> 
> 时间：2010-12-16T18:50:53.703

我遇到了完全相同的问题。我有一个 ASP.NET 复选框

```
<asp:CheckBox ID="chkBox1" CssClass='cssChkBox1' runat="server" /> 
```

在 jQuery 代码中，我使用了以下选择器来检查复选框是否被选中，它看起来就像一个魅力。

```
if ($("'.cssChkBox1 input[type=checkbox]'").is(':checked'))
{ ... } else { ... } 
```

我相信你也可以使用 ID 代替 CssClass，

```
if ($("'#cssChkBox1 input[type=checkbox]'").is(':checked'))
{ ... } else { ... } 
```

我希望这可以帮助你。

* * *

## 回答 #16

> 赞同：58
> 
> 时间：2016-10-13T06:03:19.157

**此代码将帮助您**

```
$('#isAgeSelected').click(function(){
   console.log(this.checked);
   if(this.checked == true) {
        $("#txtAge").show();
    } else {
       $("#txtAge").hide();
   }
}); 
```

* * *

## 回答 #17

> 赞同：54
> 
> 时间：2011-01-06T11:33:35.203

这对我有用：

```
/* isAgeSelected being id for checkbox */

$("#isAgeSelected").click(function(){
  $(this).is(':checked') ? $("#txtAge").show() : $("#txtAge").hide();
}); 
```

* * *

## 回答 #18

> 赞同：53
> 
> 时间：2014-10-14T07:48:07.280

有很多方法可以检查复选框是否被选中：

使用 jQuery 检查的方法

```
if (elem.checked)
if ($(elem).prop("checked"))
if ($(elem).is(":checked"))
if ($(elem).attr('checked')) 
```

检查示例或文档：

*   [http://api.jquery.com/attr/](http://api.jquery.com/attr/)

*   [http://api.jquery.com/prop/](http://api.jquery.com/prop/)

* * *

## 回答 #19

> 赞同：49
> 
> 时间：2015-08-24T12:19:36.577

这是做同样事情的一些不同方法：

```
$(document).ready(function (){

    $('#isAgeSelected').click(function() {
        // $("#txtAge").toggle(this.checked);

        // Using a pure CSS selector
        if ($(this.checked)) {
            alert('on check 1');
        };

        // Using jQuery's is() method
        if ($(this).is(':checked')) {
            alert('on checked 2');
        };

        //  // Using jQuery's filter() method
        if ($(this).filter(':checked')) {
            alert('on checked 3');
        };
    });
});
```

```
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<input type="checkbox" id="isAgeSelected"/>
<div id="txtAge" style="display:none">Age is something</div>
```

* * *

## 回答 #20

> 赞同：43
> 
> 时间：2016-07-27T09:46:54.973

用这个：

```
if ($('input[name="salary_in.Basic"]:checked').length > 0) 
```

如果选中该复选框，则长度大于零。

* * *

## 回答 #21

> 赞同：39
> 
> 时间：2012-02-06T14:31:08.660

我这样做的方法是：

```
if ( $("#checkbox:checked").length ) {       
    alert("checkbox is checked");
} else {
    alert("checkbox is not checked");
} 
```

* * *

## 回答 #22

> 赞同：36
> 
> 时间：2012-02-12T15:15:43.617

```
$(selector).attr('checked') !== undefined 
```

`true`如果检查输入，则返回，否则返回`false`。

* * *

## 回答 #23

> 赞同：34
> 
> 时间：2014-11-25T12:25:58.630

```
$(document).ready(function() {    
    $('#agecheckbox').click(function() {
        if($(this).is(":checked"))
        {
            $('#agetextbox').show();
        } else {
            $('#agetextbox').hide();
        }
    });
}); 
```

* * *

## 回答 #24

> 赞同：34
> 
> 时间：2016-04-28T12:07:18.983

您可以使用：

```
 if(document.getElementById('isAgeSelected').checked)
    $("#txtAge").show();  
  else
    $("#txtAge").hide(); 
```

* * *

```
if($("#isAgeSelected").is(':checked'))
  $("#txtAge").show();  
else
  $("#txtAge").hide(); 
```

他们都应该工作。

* * *

## 回答 #25

> 赞同：32
> 
> 时间：2013-10-30T12:43:44.703

**1) 如果您的 HTML 标记是：**

```
<input type="checkbox"  /> 
```

使用的属性：

```
$(element).attr("checked"); // Will give you undefined as initial value of checkbox is not set 
```

如果使用道具：

```
$(element).prop("checked"); // Will give you false whether or not initial value is set 
```

**2) 如果您的 HTML 标记是：**

```
 <input type="checkbox"  checked="checked" />// May be like this also  checked="true" 
```

使用的属性：

```
$(element).attr("checked") // Will return checked whether it is checked="true" 
```

使用的道具：

```
$(element).prop("checked") // Will return true whether checked="checked" 
```

* * *

## 回答 #26

> 赞同：28
> 
> 时间：2012-12-10T05:02:35.263

最佳答案并没有为我做。但这确实：

```
<script type="text/javascript">
    $(document).ready(function(){

        $("#li_13").click(function(){
            if($("#agree").attr('checked')){
                $("#saveForm").fadeIn();
            }
            else
            {
                $("#saveForm").fadeOut();
            }
        });
    });
</script> 
```

基本上，当单击元素#li_13 时，它会使用该`.attr('checked')`函数检查元素#agreement（即复选框）是否被选中。如果是，则在#saveForm 元素中为fadeIn，如果不是，则在saveForm 元素中为fadeOut。

* * *

## 回答 #27

> 赞同：28
> 
> 时间：2014-01-03T10:38:25.003

此示例适用于按钮。

尝试以下操作：

```
<input type="button" class="check" id="checkall" value="Check All" />  &nbsp; <input type="button" id="remove" value="Delete" /> <br/>

<input type="checkbox" class="cb-element"  value="1" /> Checkbox  1 <br/>
<input type="checkbox" class="cb-element"  value="2" /> Checkbox  2 <br/>
<input type="checkbox" class="cb-element"  value="3" /> Checkbox  3 <br/>

$('#remove').attr('disabled', 'disabled'); 

$(document).ready(function() {  

    $('.cb-element').click(function() {

        if($(this).prop('checked'))
        {
            $('#remove').attr('disabled', false);
        }
        else
        {
            $('#remove').attr('disabled', true);
        }
    });   

    $('.check:button').click(function()
{
    var checked = !$(this).data('checked');
    $('input:checkbox').prop('checked', checked);
    $(this).data('checked', checked);

    if(checked == true)
    {
        $(this).val('Uncheck All');
         $('#remove').attr('disabled', false);
    }

    else if(checked == false)
    {
        $(this).val('Check All');
        $('#remove').attr('disabled', true);
    }
});
}); 
```

* * *

## 回答 #28

> 赞同：27
> 
> 时间：2013-09-06T06:43:19.470

我正在使用这个：

```
 <input type="checkbox" id="isAgeSelected" value="1" /> <br/>
 <input type="textbox" id="txtAge" />

 $("#isAgeSelected").is(':checked') ? $("#txtAge").show() : $("#txtAge").hide(); 
```

* * *

## 回答 #29

> 赞同：27
> 
> 时间：2015-08-22T19:09:46.303

尽管您已经为您的问题提出了一个 JavaScript 解决方案（`textbox`当 a `checkbox`is时显示 a `checked`），但这个问题可以**仅通过 css**来解决。使用这种方法，您的表单适用于禁用 JavaScript 的用户。

假设您有以下 HTML：

```
<label for="show_textbox">Show Textbox</label>
<input id="show_textbox" type="checkbox" />
<input type="text" /> 
```

您可以使用以下 CSS 来实现所需的功能：

```
 #show_textbox:not(:checked) + input[type=text] {display:none;} 
```

对于其他场景，您可能会想到合适的 CSS 选择器。

[这是一个 Fiddle 来演示这种方法](https://jsfiddle.net/gLztyn9x/4/ "小提琴")。

* * *

## 回答 #30

> 赞同：26
> 
> 时间：2019-10-03T09:50:54.323

对单击时选中或未选中的复选框进行操作。

```
$('#customCheck1').click(function() {
  if (this.checked) {
    console.log('checked');
  } else {
    console.log('un-checked');
  }
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<input type="checkbox" id="customCheck1">
```

`if (boolean == true)`编辑：虽然`.checked`属性也可能返回其他类型变量，但这不是一个很好的编程表达式。

最好改为使用`.prop("checked")`。它`true`只会返回`false`。

* * *

## 回答 #31

> 赞同：24
> 
> 时间：2015-01-08T13:10:44.387

切换：0/1 或其他

```
<input type="checkbox" id="nolunch" />
<input id="checklunch />"

    $('#nolunch').change(function () {
    if ($(this).is(':checked')) {
        $('#checklunch').val('1');
    };
    if ($(this).is(':checked') == false) {
        $('#checklunch').val('0');
    };
}); 
```

* * *

## 回答 #32

> 赞同：23
> 
> 时间：2015-06-04T05:07:16.820

我认为这将是简单的

```
$('#isAgeSelected').change(function() {
    if($(this).is(":checked")) {
        $('#txtAge').show();
    }
else{
        $('#txtAge').hide();
    }                                          
}); 
```

* * *

## 回答 #33

> 赞同：22
> 
> 时间：2019-05-29T04:46:21.783

**请尝试下面的代码来检查复选框是否被选中**

```
$(document).ready(function(){

    $("#isAgeSelected").on('change',function(){

    if($("#isAgeSelected").is(':checked'))
        $("#txtAge").show();  // checked
    else{
        $("#txtAge").hide();  // unchecked
    }

   });

}); 
```

* * *

## 回答 #34

> 赞同：20
> 
> 时间：2013-11-15T10:50:44.103

我敢肯定这不是什么启示，但我并没有在一个例子中看到这一切：

所有选中复选框的选择器（在页面上）：

```
$('input[type=checkbox]:checked') 
```

* * *

## 回答 #35

> 赞同：18
> 
> 时间：2012-02-07T18:43:37.907

我在 Firefox 9.0.1 中验证了以下内容可用于捕获复选框后更改的状态：

```
$("#mycheckbox").change(function() {
    var value = $(this).prop("checked") ? 'true' : 'false';                     
    alert(value);
}); 
```

* * *

## 回答 #36

> 赞同：17
> 
> 时间：2013-03-02T05:38:24.887

包括来自本地文件系统的 jQuery。我用的是谷歌的[CDN](http://en.wikipedia.org/wiki/Content_delivery_network)，也有很多CDN可供选择。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> 
```

一旦`mycheck`单击类内的复选框，代码就会执行。如果选中当前单击的复选框，则它将禁用所有其他复选框并启用当前复选框。如果当前未选中，它将再次启用所有复选框以重新选中。

```
<script type="text/javascript">
    $(document).ready(function() {

        var checkbox_selector = '.mycheck input[type=checkbox]';

        $(checkbox_selector).click(function() {
            if ($($(this)).is(':checked')) {

                // Disable all checkboxes
                $(checkbox_selector).attr('disabled', 'disabled');

                // Enable current one
                $($(this)).removeAttr('disabled');
            }
            else {
                // If unchecked open all checkbox
                $(checkbox_selector).removeAttr('disabled');
            }
        });
    });
</script> 
```

简单的表格测试

```
<form method="post" action="">
    <div class="mycheck">
        <input type="checkbox" value="1" /> Television
        <input type="checkbox" value="2" /> Computer
        <input type="checkbox" value="3" /> Laptop
        <input type="checkbox" value="4" /> Camera
        <input type="checkbox" value="5" /> Music Systems
    </div>
</form> 
```

输出画面：

![在此处输入图像描述](https://i.stack.imgur.com/SM7V9.png)

* * *

## 回答 #37

> 赞同：17
> 
> 时间：2013-06-10T13:12:59.673

```
if($("#checkkBoxId").is(':checked')){
  alert("Checked=true");
} 
```

或者

```
if($("#checkkBoxId").attr('checked') == true){
  alert("checked=true");
} 
```

* * *

## 回答 #38

> 赞同：15
> 
> 时间：2013-10-10T06:23:22.307

`checked`an的属性`input type="checkbox"`映射到`defaultChecked`属性，而**不是**`checked`属性。

因此，当未选中复选框时在页面中执行某些操作时，请改用该`prop()`方法。它获取属性值并随着复选框状态的变化而变化。

在这些情况下使用`attr(`) 或`getAttribute`(在纯 JavaScript 中) 不是正确的做事方式。

如果`elem`是相关复选框，则执行以下操作来获取值：

```
elem.checked 
```

或者

```
$(elem).prop('checked') 
```

* * *

## 回答 #39

> 赞同：15
> 
> 时间：2014-05-14T05:42:19.807

### 自动化

```
$(document).ready(function()
{
    $('#isAgeSelected').change(function()
    {
        alert( 'value =' + $('#chkSelect').attr('checked') );
    });
}); 
```

### HTML

```
<b> <input type="isAgeSelected" id="chkSelect" /> Age Check </b>

<br/><br/>

<input type="button" id="btnCheck" value="check" /> 
```

### jQuery

```
$(document).ready(function()
{
    $('#btnCheck').click(function()
    {
        var isChecked = $('#isAgeSelected').attr('checked');

        if (isChecked == 'checked')
            alert('check-box is checked');
        else
            alert('check-box is not checked');
    })
}); 
```

**阿贾克斯**

```
function check()
{
    if (isAgeSelected())
        alert('check-box is checked');
    else
        alert('check-box is not checked');
}

function isAgeSelected()
{
    return ($get("isAgeSelected").checked == true);
} 
```

* * *

## 回答 #40

> 赞同：15
> 
> 时间：2020-02-03T06:20:21.687

```
$(document).on("click","#isAgeSelected",function(){
  if($(this).prop("checked") == true){
    $("#txtAge").show();
  }
  else if($(this).prop("checked") == false){
    $("#txtAge").hide();
  }
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

 <input type="checkbox" id="isAgeSelected"/>

<div id="txtAge" style="display:none">
<input type="text" name="age" placeholder="Please enter age" />
</div>
```

* * *

## 回答 #41

> 赞同：14
> 
> 时间：2013-07-15T15:50:34.353

这是我认为我需要有效地做这样的事情的最少代码量。我发现这种方法很有用；它返回一个选中的复选框数组，然后您可以使用它们的值（此解决方案使用 jQuery）：

```
// This is how you get them
var output = "";
var checkedBoxes = $("DivCheckBoxesAreIn").children("input:checked");
if(checkedBoxes.length <= 0) {
    alert('Please select check boxes');
    return false;
};

// And this is how you use them:
checkedBoxes.each(function() {
    output +=  this.value + ", ";
}; 
```

打印“输出”将为您提供以逗号分隔的值列表。

* * *

## 回答 #42

> 赞同：13
> 
> 时间：2018-07-14T07:47:06.983

只需像下面这样使用它

```
 $('#isAgeSelected').change(function() {
     if ($(this).is(":checked")) { // or if($("#isAgeSelected").attr('checked') == true){
         $('#txtAge').show();
     } else {
         $('#txtAge').hide();
     }
 }); 
```

* * *

## 回答 #43

> 赞同：13
> 
> 时间：2018-09-11T00:51:34.997

使用纯**JavaScript**：

```
let checkbox = document.getElementById('checkboxID');

if(checkbox.checked) {
  alert('is checked');
} else {
  alert('not checked yet');
} 
```

* * *

## 回答 #44

> 赞同：12
> 
> 时间：2010-12-09T14:44:05.070

我遇到了同样的问题，发布的解决方案似乎都不起作用，然后我发现这是因为 ASP.NET 将 CheckBox 控件呈现为内部带有 INPUT 的 SPAN，所以 CheckBox ID 实际上是 SPAN 的 ID，而不是一个输入，所以你应该使用：

```
$('#isAgeSelected input') 
```

而不是

```
$('#isAgeSelected') 
```

然后上面列出的所有方法都应该起作用。

* * *

## 回答 #45

> 赞同：12
> 
> 时间：2011-05-10T21:36:20.640

这是一个示例，其中包括在**页面加载时****初始化**显示/隐藏以匹配复选框的状态；考虑到Firefox在刷新页面时会记住*复选框的状态，但**不会*记住显示/隐藏元素的状态。

 ****```
$(function() {
    // initialise visibility when page is loaded
    $('tr.invoiceItemRow').toggle($('#showInvoiceItems').attr('checked'));
    // attach click handler to checkbox
    $('#showInvoiceItems').click(function(){ $('tr.invoiceItemRow').toggle(this.checked);})
}); 
```

（在这个问题的其他答案的帮助下）

* * *

## 回答 #46

> 赞同：10
> 
> 时间：2013-02-25T02:26:58.797

这是我的解决方法：

```
$('#vcGoButton').click(function () {
    var buttonStatus = $('#vcChangeLocation').prop('checked');
    console.log("Status is " + buttonStatus);
    if (buttonStatus) {
        var address = $('#vcNewLocation').val();
        var cabNumber = $('#vcVehicleNumber').val();
        $.get('postCabLocation.php',
              {address: address, cabNumber: cabNumber},
              function(data) {
                  console.log("Changed vehicle " + cabNumber + " location to " + address );
              });
    }
    else {
        console.log("VC go button clicked, but no location action");
    }
}); 
```

* * *

## 回答 #47

> 赞同：9
> 
> 时间：2013-01-23T16:40:06.830

采用：

```
$(this).toggle($("input:checkbox", $(this))[0].checked); 
```

当您选择脱离上下文时，请记住您需要 [0] 才能访问该复选框。

* * *

## 回答 #48

> 赞同：9
> 
> 时间：2014-04-22T02:31:27.670

二传手：

```
$("#chkmyElement")[0].checked = true; 
```

吸气剂：

```
if($("#chkmyElement")[0].checked) {
   alert("enabled");
} else {
   alert("disabled");
} 
```

* * *

## 回答 #49

> 赞同：9
> 
> 时间：2021-05-27T08:53:41.720

**jQuery prop()**方法提供了一种简单、有效且可靠的方法来跟踪复选框的当前状态。它在所有条件下都工作得很好，因为每个复选框都有一个**选中的属性**，它指定了它的选中或未选中状态。

不要误解它与选中的属性。checked 属性仅定义复选框的初始状态，而不是当前状态。让我们看看它是如何工作的：

```
<script>
    $(document).ready(function(){
        $('input[type="checkbox"]').click(function(){
            if($(this).prop("checked") == true){
                console.log("Checkbox is checked.");
            }
            else if($(this).prop("checked") == false){
                console.log("Checkbox is unchecked.");
            }
        });
    });
</script> 
```

详细解释：[jQuery prop()](https://www.tutorialrepublic.com/faq/how-to-check-a-checkbox-is-checked-or-not-using-jquery.php)

但是，您也可以使用 jQuery 的**is() 函数**。

```
if($("#isAgeSelected").is(':checked'))
    $("#txtAge").show();  // Age is selected - Show the Age
else
    $("#txtAge").hide();  // Age is not selected - Hide the Age 
```

* * *

## 回答 #50

> 赞同：8
> 
> 时间：2014-08-30T10:36:58.090

我实际上更喜欢这个`change`活动。

```
$('#isAgeSelected').change(function() {
    $("#txtAge").toggle(this.checked);
}); 
```

[演示小提琴](http://jsfiddle.net/5udtC/6913/)

* * *

## 回答 #51

> 赞同：8
> 
> 时间：2015-03-29T21:45:11.570

选择器返回多个对象，它必须取数组中的第一项：

```
// Collection
var chckremember = $("#chckremember");

// Result boolen
var ischecked=chckremember[0].checked; 
```

* * *

## 回答 #52

> 赞同：8
> 
> 时间：2015-09-03T17:42:31.053

试试这个，

```
$('#isAgeSelected').click(function() {
    if(this.checked){
        $("#txtAge").show();
    } else{
        $("#txtAge").hide();
    } 
}); 
```

* * *

## 回答 #53

> 赞同：7
> 
> 时间：2017-05-18T23:03:09.850

我正在使用 jQuery 1.11.1，我在设置和读取复选框值时也遇到了麻烦。

我终于通过这两个功能解决了它：

```
function setCheckboxValue(checkBoxId, checked) {
    if (checkBoxId && (checked === true || checked === false)) {
        var elem = $('#' + checkBoxId);
        if (checked === true) {
            elem.attr('checked', 'checked');
        } else {
            elem.removeAttr('checked');
        }
    }
}

function isChecked(checkBoxId) {
    return $('#' + checkBoxId).attr('checked') != null;
} 
```

它可能看起来有点脏，但它解决了我在不同类型的浏览器中遇到的所有有线问题。

* * *

## 回答 #54

> 赞同：7
> 
> 时间：2019-03-29T02:54:22.133

你可以试试这段代码：

```
$('#isAgeSelected').click(function(){
   console.log(this.checked);
   if(this.checked == true) {
        $("#txtAge").show();
    } else {
       $("#txtAge").hide();
   }
}); 
```

* * *

## 回答 #55

> 赞同：6
> 
> 时间：2013-01-21T09:53:56.167

```
if( undefined == $('#isAgeSelected').attr('checked') ) {
    $("#txtAge").hide();
} else {
    $("#txtAge").show();
} 
```

* * *

## 回答 #56

> 赞同：6
> 
> 时间：2019-12-09T00:19:41.730

嗨，您可以使用 plain `Javascript`，如下所示：

```
document.getElementById('checkboxOption').addEventListener('click',      
   event => console.log(event.target.checked)
);
```

```
<label><input type="checkbox" id="checkboxOption">Check Option</label>
```

* * *

## 回答 #57

> 赞同：4
> 
> 时间：2016-09-30T10:30:58.500

这个解决方案怎么样？

```
$("#txtAge")[
    $("#isAgeSelected").is(':checked') ?
    'show' :
    'hide'
](); 
```

* * *

## 回答 #58

> 赞同：4
> 
> 时间：2018-09-03T06:56:46.967

我需要检查复选框的选中属性并使用 jQuery 基于选中的属性执行操作。

前任 -

1）如果选中年龄复选框，则在加载时运行以获取复选框值，然后我需要显示一个文本框来输入年龄，否则隐藏文本框。

2）如果年龄复选框被选中，那么我需要显示一个文本框来输入年龄，否则使用复选框的单击事件隐藏文本框。

**所以代码默认不返回false：**

尝试以下操作：

```
<html>
        <head>
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        </head>
        <body>
            <h1>Jquery Demo</h1>
            <input type="checkbox" name="isAge" checked id="isAge"> isAge <br/>
            <div id="Age" style="display:none">
              <label>Enter your age</label>
              <input type="number" name="age">
            </div>
            <script type="text/javascript">
            if(document.getElementById('isAge').checked) {
                $('#Age').show();
            } else {
                $('#Age').hide();
            }   
            $('#isAge').click(function() {
                if(document.getElementById('isAge').checked) {
                    $('#Age').show();
                } else {
                    $('#Age').hide();
                }
            }); 
            </script>
        </body>
    </html> 
```

这是修改后的版本：[https ://jsfiddle.net/sedhal/0hygLtrz/7/](https://jsfiddle.net/sedhal/0hygLtrz/7/)

* * *

## 回答 #59

> 赞同：4
> 
> 时间：2019-08-28T04:39:14.123

在纯js复选框状态更容易阅读

```
isAgeSelected.checked 
```

```
function check() {
  txtAge.style.display= isAgeSelected.checked ? 'block':'none';
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

Age <input type="checkbox" id="isAgeSelected"/>

<button onclick="check()">Check</button>

<div id="txtAge" style="display:none">
Age is selected
</div>
```

* * *

## 回答 #60

> 赞同：3
> 
> 时间：2018-08-07T09:23:45.940

如果您需要知道是否选中了纯复选框，`javascript`您应该使用此代码。

```
let checkbox =document.getElementById('myCheckboxId');
if(checkbox.checked) {
    alert("element is checked");
} else {
    alert("element is  ot checked");
} 
```

* * *

## 回答 #61

> 赞同：2
> 
> 时间：2013-01-18T13:39:28.133

```
if( undefined == $('#isAgeSelected').attr('checked') ) {
    $("#txtAge").hide();
} else {
    $("#txtAge").show();
} 
```

* * *

## 回答 #62

> 赞同：2
> 
> 时间：2015-06-29T01:42:08.193

对于旧版本的 jQuery，我必须使用以下内容，

```
$('#change_plan').live('click', function() {
     var checked = $('#change_plan').attr('checked');
     if(checked) {
          //Code       
     }
     else {
          //Code       
     }
}); 
```

* * *

## 回答 #63

> 赞同：1
> 
> 时间：2014-11-07T16:37:02.640

如果您需要使用 CSS 类作为 jQuery 选择器，您可以执行以下操作：

```
$(document).ready(function () {
        $('.myOptionCheckbox').change(function () {            
            if ($(this).prop('checked') == true) {
                console.log("checked");           
            }
            else {
                console.log("unchecked");                
            }
        });
    }); 
```

它适用于`checkboxes`并且`radioboxes`也适用。

* * *

## 回答 #64

> 赞同：1
> 
> 时间：2015-04-14T15:17:34.687

此功能是替代且稳定的：

```
$('#isAgeSelected').context.checked
(return True/False) 
```

***例子：***

```
if($('#isAgeSelected').context.checked){ //if Checkbox is checked then bla bla..
    /*.....*/
}else{
    /*.....*/
} 
```

* * *

## 回答 #65

> 赞同：1
> 
> 时间：2015-06-24T02:13:14.837

```
$('#chk').change(function() { 
    (this.checked)? alert('true') : alert('false');
});

($('#chk')[0].checked)? alert('true') : alert('false'); 
```

* * *

## 回答 #66

> 赞同：0
> 
> 时间：2016-04-28T19:30:50.477

```
if($('#isAgeSelected').prop('checked')) {
    // do your action 
} 
```

* * *

## 回答 #67

> 赞同：-1
> 
> 时间：2015-01-06T12:34:55.270

`$("#isAgeSelected").prop('checked', true);`

# authentication - 哪些身份验证提供程序用于单点登录？

> ID：901726
> 
> 赞同：2
> 
> 时间：2009-05-23T15:20:31.470
> 
> 标签：authentication, facebook, opensocial, google-friend-connect

我最近的任务是实现[单点登录](http://www.dynamicalsoftware.com/single/sign/in)功能，用户可以使用来自更受欢迎的网站的凭据注册和登录该网站。这让我开始四处寻找和询问谁在进行单点登录。我惊讶地发现它竟然是一个热门话题。

如果您为 Web 应用程序推出了单点登录，那么您最终使用了哪些身份验证提供程序，为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T15:23:36.223

尝试 OpenID，stackoverflow 也使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T15:28:33.887

如果它是一个互联网应用程序，OpenID 非常好。允许用户使用他们的 google 帐户之类的东西登录您的帐户。

如果它是一个 Intranet 应用程序，那么 Windows Auth 相当常见，但它最适合 IE。

# php - 将大量文本（聚类）与矩阵进行比较

> ID：901730
> 
> 赞同：2
> 
> 时间：2009-05-23T15:21:36.257
> 
> 标签：php, cluster-analysis, text-comparison

我有以下 PHP 函数来计算文本之间的关系：

```
function check($terms_in_article1, $terms_in_article2) {
    $length1 = count($terms_in_article1); // number of words
    $length2 = count($terms_in_article2); // number of words
    $all_terms = array_merge($terms_in_article1, $terms_in_article2);
    $all_terms = array_unique($all_terms);
    foreach ($all_terms as $all_termsa) {
        $term_vector1[$all_termsa] = 0;
        $term_vector2[$all_termsa] = 0;
    }
    foreach ($terms_in_article1 as $terms_in_article1a) {
        $term_vector1[$terms_in_article1a]++;
    }
    foreach ($terms_in_article2 as $terms_in_article2a) {
        $term_vector2[$terms_in_article2a]++;
    }
    $score = 0;
    foreach ($all_terms as $all_termsa) {
        $score += $term_vector1[$all_termsa]*$term_vector2[$all_termsa];
    }
    $score = $score/($length1*$length2);
    $score *= 500; // for better readability
    return $score;
} 
```

该变量`$terms_in_articleX`必须是一个数组，其中包含出现在文本中的所有单个单词。

假设我有一个包含 20,000 条文本的数据库，这个函数将花费很长时间来运行所有连接。

我怎样才能加速这个过程？我应该将所有文本添加到一个巨大的矩阵中，而不是总是只比较两个文本吗？如果您有一些代码方法，最好是在 PHP 中，那就太好了。

我希望你能帮助我。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T21:13:01.647

您可以在添加文本时拆分文本。简单的例子：`preg_match_all(/\w+/, $text, $matches);`当然真正的分裂不是那么简单......但有可能，只需纠正模式:)

像这样创建表 id(int primary autoincrement)、value(varchar unique) 和链接表：word_id(int)、text_id(int)、word_count(int)。然后在拆分文本后用新值填充表格。

最后，您可以对这些数据做任何您想做的事情，快速使用 DB 中的索引整数 (ID) 进行操作。

更新：这里是表和查询：

```
CREATE TABLE terms (
    id int(11) NOT NULL auto_increment, value char(255) NOT NULL,
    PRIMARY KEY  (`id`), UNIQUE KEY `value` (`value`)
);

CREATE TABLE `terms_in_articles` (
    term int(11) NOT NULL, 
    article int(11) NOT NULL, 
    cnt int(11) NOT NULL default '1',
    UNIQUE KEY `term` (`term`,`article`)
);

/* Returns all unique terms in both articles (your $all_terms) */
SELECT t.id, t.value 
FROM terms t, terms_in_articles a 
WHERE a.term = t.id AND a.article IN (1, 2);

/* Returns your $term_vector1, $term_vector2 */
SELECT article, term, cnt 
FROM terms_in_articles 
WHERE article IN (1, 2) ORDER BY article;

/* Returns article and total count of term entries in it ($length1, $length2) */
SELECT article, SUM(cnt) AS total 
FROM terms_in_articles 
WHERE article IN (1, 2) GROUP BY article;

/* Returns your $score wich you may divide by ($length1 / $length2) from previous query */
SELECT SUM(tmp.term_score) * 500 AS total_score FROM 
(
    SELECT (a1.cnt * a2.cnt) AS term_score 
    FROM terms_in_articles a1, terms_in_articles a2 
    WHERE a1.article = 1 AND a2.article = 2 AND a1.term = a2.term
    GROUP BY a2.term, a1.term
) AS tmp; 
```

好吧，现在，我希望这会有所帮助？最后的 2 个查询足以执行您的任务。其他查询以防万一。当然，您可以计算更多统计信息，例如“最流行的术语”等...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T18:33:22.537

编辑：试图更明确：

1.  首先，将每一项编码为一个整数。您可以使用字典关联数组，如下所示：

    ```
     $count = 0;
        foreach ($doc as $term) {
          $val = $dict[$term];
          if (!defined($val)) {
            $dict[$term] = $count++;
          }
          $doc_as_int[$val] ++;
        } 
    ```

    这样，您可以将字符串计算替换为整数计算。例如，您可以将单词“cloud”表示为数字 5，然后使用数组的索引 5 来存储单词“cloud”的计数。请注意，我们这里只使用关联数组搜索，不需要 CRC 等。

2.  将所有文本存储为矩阵，最好是[稀疏的](http://en.wikipedia.org/wiki/Sparse_matrix)。
3.  使用[特征选择 (PDF)](http://www.csee.umbc.edu/cadip/2002Symposium/kogan.pdf)。
4.  也许以更快的语言使用本机实现。
5.  我建议您首先使用具有大约 20 个集群的 K-means，这样可以粗略了解哪个文档靠近另一个文档，然后仅比较每个集群内的对。假设集群大小一致，这会将比较次数提高到`20*200 + 20*10*9`- 大约 6000 次比较，而不是 19900 次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T16:56:35.930

这是原始功能的略微优化版本。它产生完全相同的结果。（我在 Wikipedia 上的两篇文章中运行它，包含 10000 多个术语，每篇文章都运行 20 次：

```
check():
test A score: 4.55712524522
test B score: 5.08138042619
--Time: 1.0707

check2():
test A score: 4.55712524522
test B score: 5.08138042619
--Time: 0.2624 
```

这是代码：

```
function check2($terms_in_article1, $terms_in_article2) {
    $length1 = count($terms_in_article1); // number of words
    $length2 = count($terms_in_article2); // number of words

    $score_table = array();
    foreach($terms_in_article1 as $term){
        if(!isset($score_table[$term])) $score_table[$term] = 0;
        $score_table[$term] += 1;
    }
    $score_table2 = array();
    foreach($terms_in_article2 as $term){
        if(isset($score_table[$term])){
            if(!isset($score_table2[$term])) $score_table2[$term] = 0;
            $score_table2[$term] += 1;
        }
    }
    $score =0;
    foreach($score_table2 as $key => $entry){
        $score += $score_table[$key] * $entry;
    }
    $score = $score / ($length1*$length2);
    $score *= 500;
    return $score;
} 
```

（顺便说一句。不包括将所有单词拆分为数组所需的时间。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T14:17:31.473

如果您可以使用简单的文本而不是数组进行比较，并且如果我理解您的目标在哪里，您可以使用[levenshtein](http://it2.php.net/manual/en/function.levenshtein.php) php 函数（通常用于提供类似 google 的“您的意思是……吗？”函数在 php 搜索引擎中）。

它的工作方式与您使用的相反：返回两个字符串之间的差异。

例子：

```
<?php
function check($a, $b) {
    return levenshtein($a, $b);
}

$a = 'this is just a test';
$b = 'this is not test';
$c = 'this is just a test';

echo check($a, $b) . '<br />';
//return 5
echo check($a, $c) . '<br />';
//return 0, the strings are identical
?> 
```

但我不知道这是否会提高执行速度。但也许是的，你取出了许多 foreach 循环和 array_merge 函数。

**编辑：**

一个简单的速度测试（是一个 30 秒编写的脚本，它不是 100% 准确的，嗯）：

```
function check($terms_in_article1, $terms_in_article2) {
    $length1 = count($terms_in_article1); // number of words
    $length2 = count($terms_in_article2); // number of words
    $all_terms = array_merge($terms_in_article1, $terms_in_article2);
    $all_terms = array_unique($all_terms);
    foreach ($all_terms as $all_termsa) {
        $term_vector1[$all_termsa] = 0;
        $term_vector2[$all_termsa] = 0;
    }
    foreach ($terms_in_article1 as $terms_in_article1a) {
        $term_vector1[$terms_in_article1a]++;
    }
    foreach ($terms_in_article2 as $terms_in_article2a) {
        $term_vector2[$terms_in_article2a]++;
    }
    $score = 0;
    foreach ($all_terms as $all_termsa) {
        $score += $term_vector1[$all_termsa]*$term_vector2[$all_termsa];
    }
    $score = $score/($length1*$length2);
    $score *= 500; // for better readability
    return $score;
}

$a = array('this', 'is', 'just', 'a', 'test');
$b = array('this', 'is', 'not', 'test');

$timenow = microtime();
list($m_i, $t_i) = explode(' ', $timenow);

for($i = 0; $i != 10000; $i++){
    check($a, $b);
}
$last = microtime();
list($m_f, $t_f) = explode(' ', $last);
$fine = $m_f+$t_f;
$inizio = $m_i+$t_i;
$quindi = $fine - $inizio;
$quindi = substr($quindi, 0, 7);
echo 'end in ' . $quindi . ' seconds'; 
```

打印：在**0.36765**秒后结束

第二次测试：

```
<?php
function check($a, $b) {
    return levenshtein($a, $b);
}

$a = 'this is just a test';
$b = 'this is not test';

$timenow = microtime();
list($m_i, $t_i) = explode(' ', $timenow);
for($i = 0; $i != 10000; $i++){
    check($a, $b);
}
$last = microtime();
list($m_f, $t_f) = explode(' ', $last);
$fine = $m_f+$t_f;
$inizio = $m_i+$t_i;
$quindi = $fine - $inizio;
$quindi = substr($quindi, 0, 7);
echo 'end in ' . $quindi . ' seconds';
?> 
```

打印：在**0.05023**秒后结束

所以，是的，看起来更快。尝试使用许多数组项会很好（以及许多单词用于 levenshtein）

**2°编辑**：

使用类似的文本，速度似乎等于 levenshtein 方法：

```
<?php
function check($a, $b) {
    return similar_text($a, $b);
}

$a = 'this is just a test ';
$b = 'this is not test';

$timenow = microtime();
list($m_i, $t_i) = explode(' ', $timenow);
for($i = 0; $i != 10000; $i++){
    check($a, $b);
}
$last = microtime();
list($m_f, $t_f) = explode(' ', $last);
$fine = $m_f+$t_f;
$inizio = $m_i+$t_i;
$quindi = $fine - $inizio;
$quindi = substr($quindi, 0, 7);
echo 'end in ' . $quindi . ' seconds';
?> 
```

打印：在**0.05988**秒后结束

但它可能需要超过 255 个字符：

> 另请注意，该算法的复杂度为 O(N**3)，其中 N 是最长字符串的长度。

并且，它甚至可以返回百分比的相似值：

```
function check($a, $b) {
    similar_text($a, $b, $p);
    return $p;
} 
```

**又一个编辑**

那么创建一个数据库函数，直接在 sql 查询中进行比较，而不是检索所有数据并循环它们呢？

如果你在运行 Mysql，看看[这个](http://codejanitor.com/wp/2007/02/10/levenshtein-distance-as-a-mysql-stored-function/)（手工制作的 levenshtein 函数，仍然是 255 字符限制）否则，如果你在 Postgresql 上，[这个另一个](http://www.postgresql.org/docs/8.3/static/fuzzystrmatch.html)（应该评估的许多函数）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T14:14:24.463

另一种方法是潜在语义分析，它利用大量数据来查找文档之间的相似性。

它的工作方式是获取文本的共现矩阵并将其与语料库进行比较，本质上为您提供了“语义空间”中文档的抽象位置。这将加快您的文本比较，因为您可以在 LSA 语义空间中使用欧几里得距离比较文档。这是非常有趣的语义索引。因此，添加新文章不会花费太多时间。

我无法给出这种方法的具体用例，只是在学校学过，但 KnowledgeSearch 似乎是该算法的开源实现。

（抱歉，这是我的第一篇文章，所以无法发布链接，请自行查找）

# c# - Friendfeed 的简单消息海报

> ID：901741
> 
> 赞同：0
> 
> 时间：2009-05-23T15:25:07.530
> 
> 标签：c#, .net, friendfeed

我正在尝试将一个函数集成到一个应用程序中，该应用程序使用 C# API 将消息发布到friendfeed。作为一个新手，我无法弄清楚如何建立连接然后向其发布消息。

有人能帮忙吗？

我的 HTTP 基本身份验证工作正常，只是没有发布到我的朋友提要帐户的功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T16:07:48.820

[FriendFeed 文档](http://code.google.com/p/friendfeed-api/wiki/ApiDocumentation)似乎为您详细说明了这一点。向下滚动到标题为“发布到 FriendFeed”的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T08:15:59.497

所以我使用 API 文档并创建了 HTTP Auth 对象，但是当我尝试让 Friendfeed.FriendfeedClient() 工作时，它不断返回 405 错误。长话短说，我的应用程序一直在工作，但由于我看到的错误，我认为它不是。

错误本身是由于试图将 HTTP Auth 对象验证到错误的 URL。

# java - 如何通过Java获取linux上电脑的ip？

> ID：901755
> 
> 赞同：12
> 
> 时间：2009-05-23T15:35:14.593
> 
> 标签：java, linux, networking, ip-address

如何通过Java获取Linux上计算机的IP？

我在网上搜索了一些例子，我发现了一些关于 NetworkInterface 类的东西，但我无法理解如何获得 IP 地址。

如果我同时运行多个网络接口会怎样？将返回哪个 IP 地址。

我真的很感激一些代码示例。

PS：到目前为止，我一直使用 InetAddress 类，这对于跨平台应用程序来说是一个糟糕的解决方案。（赢/Linux）。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-23T17:10:03.143

不要忘记环回地址，它们在外面是不可见的。这是一个提取第一个非环回 IP（IPv4 或 IPv6）的函数

```
private static InetAddress getFirstNonLoopbackAddress(boolean preferIpv4, boolean preferIPv6) throws SocketException {
    Enumeration en = NetworkInterface.getNetworkInterfaces();
    while (en.hasMoreElements()) {
        NetworkInterface i = (NetworkInterface) en.nextElement();
        for (Enumeration en2 = i.getInetAddresses(); en2.hasMoreElements();) {
            InetAddress addr = (InetAddress) en2.nextElement();
            if (!addr.isLoopbackAddress()) {
                if (addr instanceof Inet4Address) {
                    if (preferIPv6) {
                        continue;
                    }
                    return addr;
                }
                if (addr instanceof Inet6Address) {
                    if (preferIpv4) {
                        continue;
                    }
                    return addr;
                }
            }
        }
    }
    return null;
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-23T15:45:32.830

来自[Java 教程](http://java.sun.com/docs/books/tutorial/networking/nifs/listing.html)

为什么`InetAddress`不是一个好的解决方案？我在文档中没有看到有关跨平台兼容性的任何内容？

此代码将枚举所有网络接口并检索它们的信息。

```
import java.io.*;
import java.net.*;
import java.util.*;
import static java.lang.System.out;

public class ListNets 
{
    public static void main(String args[]) throws SocketException {
        Enumeration<NetworkInterface> nets = NetworkInterface.getNetworkInterfaces();
        for (NetworkInterface netint : Collections.list(nets))
            displayInterfaceInformation(netint);
    }

    static void displayInterfaceInformation(NetworkInterface netint) throws SocketException {
        out.printf("Display name: %s\n", netint.getDisplayName());
        out.printf("Name: %s\n", netint.getName());
        Enumeration<InetAddress> inetAddresses = netint.getInetAddresses();
        for (InetAddress inetAddress : Collections.list(inetAddresses)) {
            out.printf("InetAddress: %s\n", inetAddress);
        }
        out.printf("\n");
     }
} 
```

以下是示例程序的示例输出：

```
Display name: bge0
Name: bge0
InetAddress: /fe80:0:0:0:203:baff:fef2:e99d%2
InetAddress: /121.153.225.59

Display name: lo0
Name: lo0
InetAddress: /0:0:0:0:0:0:0:1%1
InetAddress: /127.0.0.1 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-09-24T18:56:13.800

这段代码对 4me 有效：

```
import java.net.InetAddress;
import java.net.NetworkInterface;
import java.net.SocketException;
import java.util.Enumeration;

public class ShowIp {

    public static void main(String[] args) throws SocketException {
        NetworkInterface ni = NetworkInterface.getByName("eth0");
        Enumeration<InetAddress> inetAddresses =  ni.getInetAddresses();

        while(inetAddresses.hasMoreElements()) {
            InetAddress ia = inetAddresses.nextElement();
            if(!ia.isLinkLocalAddress()) {
                System.out.println("IP: " + ia.getHostAddress());
            }
        }
    }

} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-01-15T21:17:00.217

不能只返回第一个非环回接口，因为它可能是由 Parallels 等软件创建的。尝试钓鱼 eth0 是一个更好的选择。

```
static private InetAddress getIPv4InetAddress() throws SocketException, UnknownHostException {

    String os = System.getProperty("os.name").toLowerCase();

    if(os.indexOf("nix") >= 0 || os.indexOf("nux") >= 0) {   
        NetworkInterface ni = NetworkInterface.getByName("eth0");

        Enumeration<InetAddress> ias = ni.getInetAddresses();

        InetAddress iaddress;
        do {
            iaddress = ias.nextElement();
        } while(!(iaddress instanceof Inet4Address));

        return iaddress;
    }

    return InetAddress.getLocalHost();  // for Windows and OS X it should work well
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-06T22:18:45.347

就我而言，最简单的解决方案是`Socket.getLocalAddress()`. 为此，我必须专门打开 Socket，但是对于我的 Ubuntu 10.04 机器上的所有网络接口，这是获取外部 IP 地址的唯一方法。

# php - 这些正则表达式模式匹配什么？

> ID：901757
> 
> 赞同：1
> 
> 时间：2009-05-23T15:36:13.470
> 
> 标签：php, regex, pcre

我是 PHP 中正则表达式的新手，并且了解基本模式，但是下面的模式有点复杂，我不明白以下模式匹配什么：

```
$ret = preg_replace("#(^|[\n ])([\w]+?://[\w\#$%&~/.\-;:=,?@\[\]+]*)#... "<a href='' rel='nofollow'></a>", $ret);

$ret = preg_replace("#(^|[\n ])((www|ftp)\.[\w\#$%&~/.\-;:=,?@\[\]+]*... "<a href='http://' rel='nofollow'></a>", $ret); 
```

有人可以解释一下吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T15:54:02.737

简而言之：用链接替换 ​​URL。

详细地：

1.  第一个正则表达式描述以单词字符 ( `[\w]+`) 开头的序列，然后是`://`，然后是集合中的一个或多个字符`[\w\#$%&~/.\-;:=,?@\[\]+]`。

    这可能应该匹配以 URL 协议/方案开头的 URL，例如`http://`,`https://`或`ftp://`.

    但它也会匹配`javascript://`。这不好：`javascript://%0Aalert%28%22booo%21%22%29`等于 JavaScript 代码：

    ```
    //
    alert("booo!") 
    ```

2.  第二个正则表达式描述以 or 开头的序列，`www.`后跟`ftp.`一个或多个字符集`[\w\#$%&~/.\-;:=,?@\[\]+]`。

    这可能应该匹配以`www.`or开头的 URL `ftp.`。然后将 URL 协议/方案添加到 URL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T15:49:02.003

获取[RegexBuddy](http://www.regexbuddy.com/)，它会向您解释（[参见屏幕截图](http://www.regexbuddy.com/screen.html)）任何正则表达式的含义。SO中有另一个[anwser证明了这一点](https://stackoverflow.com/questions/891477/basic-php-regex-question/891487#891487)。

无论如何，根据`preg_replace`s 的第二个参数，它们应该匹配 URL 并标记它们。

# c# - 从静态类写入 cookie

> ID：901760
> 
> 赞同：2
> 
> 时间：2009-05-23T15:39:06.903
> 
> 标签：c#, asp.net

我的解决方案中有一个静态类，基本上是使用辅助/实用类。

在其中我有以下静态方法：

```
// Set the user
    public static void SetUser(string FirstName, string LastName)
    {
        User NewUser = new User { Name = String.Format("{0}{1}", FirstName, LastName) };
        HttpCookie UserName = new HttpCookie("PressureName") { Value = NewUser.Name, Expires = DateTime.Now.AddMinutes(60) };       

    } 
```

User 是一个简单的类，它包含：

```
 String _name = string.Empty;

    public String Name
    {
        get { return _name; }
        set { _name = value; }
    } 
```

一切正常，直到我尝试编写 cookie“PressureName”并从 NewUser.Name 将值插入其中。从单步执行代码看来，cookie 从未被写入。

我犯了一个明显的错误吗？我仍然是 c# 的业余爱好者，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T15:45:53.533

创建 cookie 对象不足以将其发送到浏览器。您还必须将其添加到 Response 对象中。

由于您使用的是静态方法，因此您无法直接访问页面上下文及其`Response`属性。使用该`Current`属性从静态方法访问当前页面的上下文：

```
HttpContext.Current.Response.Cookies.Add(UserName); 
```

# math - 具体数学中提到的“特殊数字”在哪里使用？

> ID：901761
> 
> 赞同：5
> 
> 时间：2009-05-23T15:40:14.093
> 
> 标签：math, computer-science, numbers, discrete-mathematics

我在网上浏览了具体数学的内容。我至少听说过提到的大部分功能和技巧，但有一整节是关于特殊数字的。这些数字包括斯特林数、欧拉数、谐波数等。现在我从来没有遇到过这些奇怪的数字。它们如何帮助解决计算问题？它们一般用在什么地方？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T15:57:25.137

谐波数几乎无处不在！音乐和声，快速排序的分析... 斯特林数（第一类和第二类）出现在各种组合和划分问题中。欧拉数也出现在几个地方，最显着的是在多对数函数的排列和系数中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T16:28:58.193

你提到的很多数字都用于算法分析。您的代码中可能没有这些数字，但如果您想估计代码运行需要多长时间，您将需要它们。您也可能在代码中看到它们。其中一些数字与组合学有关，计算某事发生的方式有多少。

有时仅仅知道有多少种可能性是不够的，因为您需要*列举*各种可能性。 [Knuth 的 TAOCP 第 4 卷](https://rads.stackoverflow.com/amzn/click/com/0321637135)正在进行中，提供了您需要的算法。

这是使用[斐波那契数](http://www.johndcook.com/blog/2008/04/23/fibonacci-numbers-at-work/)作为数值积分问题的一部分的示例。

谐波数是对数的离散模拟，因此它们出现在差分方程中，就像对数出现在微分方程中一样。这是与谐波数相关[的谐波均值的物理应用](http://www.johndcook.com/blog/2009/03/26/springs-and-resistors-harmonic-mean/)示例。参见[Gamma](https://rads.stackoverflow.com/amzn/click/com/0691099839)一书，了解许多谐波数在作用中的示例，尤其是“这是一个谐波世界”一章。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T16:24:08.163

这些特殊数字可以在许多方面帮助解决计算问题。例如：

*   您想知道计算 2 个数字的 GCD 的程序何时将花费最长的时间：尝试 2 个连续的斐波那契数。

*   您想粗略估计大量的阶乘，但您的阶乘程序花费的时间太长：使用[Stirling's Approximation](http://en.wikipedia.org/wiki/Stirling's_approximation)。

*   您正在测试素数，但对于某些数字，您总是得到错误的答案：可能是您正在使用费马的素数测试，在这种情况下，[卡迈克尔数](http://en.wikipedia.org/wiki/Carmichael_numbers)是您的罪魁祸首。

我能想到的最常见的一般情况是循环。大多数情况下，您使用一种语法类型来指定循环`(start;stop;step)`，在这种情况下，可以通过使用所涉及数字的属性来减少执行时间。

例如，当 n 在循环中很大时，将所有从 1 到 n 的数字相加肯定比使用 identity 慢`sum = n*(n + 1)/2`。

像这样的例子还有很多。他们中的许多人都在密码学中，信息系统的安全性有时*取决于*这些技巧。它们还可以帮助您解决性能问题、内存问题，因为当您知道公式时，您可能会找到一种更快/更有效的方法来计算其他事情——您真正关心的事情。

有关更多信息，请查看 wikipedia，或直接尝试 Project Euler。你会很快开始找到模式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-25T14:55:11.240

这些数字中的大多数都计算某些类型的离散结构（例如，斯特林数计算子集和循环）。这样的结构，以及因此的这些序列，隐含地出现在*算法分析中*。

[OEIS](http://www.research.att.com/~njas/sequences/GKP.html)有一个详尽的列表，列出*了 Concrete Math 中出现的几乎所有序列*。该列表的简短摘要：

*   哥伦布数列
*   二项式系数
*   Rencontres 数字
*   斯特林数字
*   欧拉数
*   超因子
*   Genocchi 数字

您可以浏览各个序列的 OEIS 页面，以获取有关这些序列的“属性”的详细信息（尽管不完全是应用程序，如果您最感兴趣的话）。

此外，如果您想了解这些序列在算法分析中的实际用途，请翻阅 Knuth 的计算机编程艺术索引，您会发现许多关于这些序列的“应用”的参考资料。John D. Cook 已经提到了斐波那契数和谐波数的应用；这里还有一些例子：

*斯特林循环数*出现在寻找*数组最大元素*的标准算法的分析中（TAOCP Sec. 1.2.10）：找到最大值时必须更新当前最大值多少次？事实证明，在元素`k`数组中找到最大值时需要更新最大值的概率是。由此，我们可以得出，平均而言，大约需要更新。`n``p[n][k] = StirlingCycle[n, k+1]/n!``Log(n)`

*Genocchi 数*的出现与计算“瘦”的[BDD](http://en.wikipedia.org/wiki/Binary_decision_diagram)的数量有关（TAOCP 7.1.4 练习 174）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T16:38:04.597

不一定是您提到的参考文献中的*幻数，但尽管如此-*

```
0x5f3759df 
```

*- 臭名昭著的幻数，用于通过对牛顿的根近似*给出良好的初步估计来计算数字的平方根，通常归因于 John Carmack 的工作 -[更多信息在这里](http://www.codemaestro.com/reviews/9)。

和编程无关吧？:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T12:29:42.087

这与编程直接相关吗？肯定有关系，但我不知道有多密切。

特殊的数字，例如 e、pi 等，到处都是。我认为没有人会为这两个争论。Golden_ratio也以惊人的[频率](http://en.wikipedia.org/wiki/Golden_ratio)出现，从艺术到其他特殊数字本身（看看连续斐波那契数之间的比率。）

各种数列和数族也出现在数学的许多地方，因此也出现在编程中。一个美丽的地方是[整数序列百科全书](http://www.research.att.com/~njas/sequences/Seis.html)。

我会建议这是一个经验的事情。例如，当我在很多很多年前学习线性代数时，我了解了矩阵的特征值和特征向量。我承认，在我看到它们在各种地方使用之前，我根本没有意识到特征值/特征向量的重要性。在统计学中，根据他们告诉您的有关协方差矩阵估计的不确定性、置信椭圆的大小和形状、主成分分析或马尔可夫过程的长期状态。在数值方法中，它们会告诉您方法的收敛性，无论是优化还是 ODE 求解器。在机械工程中，您将它们视为主要应力和应变。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-24T19:25:56.883

[Reddit 上的讨论](http://www.reddit.com/r/compsci/comments/8mpma/ask_compsci_where_are_the_special_numbers/)

# c - 编写 Windows 端口监视器基础知识

> ID：901766
> 
> 赞同：1
> 
> 时间：2009-05-23T15:42:40.460
> 
> 标签：c, windows, winapi, printing

我正在尝试查找有关如何编写打印机端口监视器的基本示例、教程或博客文章。我下载了 Windows DDK 并通过 localmon 进行了挖掘，但看起来这个示例比简单的基础知识要复杂得多，据我了解，它与 OEM 端口监视器有点不同，因为它处理注册表项的方式和端口枚举。有没有人知道一篇博文、教程甚至一本书，它可以引导读者了解基本代码以开始使用？我发现了一些关于概念性内容的链接，但没有任何关于代码的内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T07:22:54.430

我是根据[规范](http://msdn.microsoft.com/en-us/library/ff563806.aspx)编写的，实际上并没有那么多 API 可以实现。

经常绊倒人们的一件事是 EnumPorts，假脱机程序为所有端口分配足够的内存，而不仅仅是你的。因此，您需要确保从 spoolers 缓冲区的末尾填充任何字符串，不要将它们直接放在结构之后。

规范中没有这样说，但您可以安全地将 UI 和服务器函数放在同一个 DLL 中。

还可以创建支持 NT 和后来的 Windows 2000 类型端口监视器的单个端口监视器。

RedMon 中的代码比 localmon 示例更易于阅读，值得在开始之前查看。很好，因为你可以在VS中编译它，你不需要使用DDK来构建它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-25T08:00:45.320

我可以推荐[http://www.codeproject.com/KB/printing/wpa.aspx](http://www.codeproject.com/KB/printing/wpa.aspx)，它描述了如何编写打印机驱动程序，并且对构建端口监视器所需的内容也有很好的提示。

但我的看法是，互联网上没有这方面的好教程（我很高兴找到能告诉我我错了的人）。所以，当我不得不处理这个任务时，我不得不以艰难的方式去做：我已经仔细阅读了从这一点开始的 MSDN 解释：http: [//msdn.microsoft.com/en-us/library/ff561109 .aspx](http://msdn.microsoft.com/en-us/library/ff561109.aspx)。在阅读 MSDN 的同时，我还检查了您提到的 DDK 中的代码并尝试理解它。我相信这个解决方案也可以为你工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T18:41:36.987

对于串行打印机，我已经经历了完全相同的领域。关于我发现的最好的例子是[Dobbs 博士杂志上的这篇文章](http://www.ddj.com/windows/184416559)。好的部分是串行端口驱动程序和用户空间控制程序都包括在内，并且该项目也可以用作如何设置 Visual Studio 来编译驱动程序的示例。这也是一些很难找到相关信息的东西。这篇文章讨论了一个旧的 NT 风格的驱动程序，它对我在 XP 上运行良好。

[CodeProject](http://www.codeproject.com/)上有很多关于编写驱动程序和程序以与之交互的好文章。它们包括源代码，大多数处理较新的 WDM 和 WDF 样式驱动程序。

[OSROnline](http://www.osronline.com/)是另一个很好的资源，特别是用于讨论特定问题和常见错误。他们还有一些你需要的很棒的实用程序。

我遇到的一些最清晰、最易理解的驱动程序代码是 Mark Russinovich 的示例代码。尽管微软在购买 Sysinternals 时撤回了所有源代码，但仍然可以在这里和那里找到一些最好的示例。

司机很有趣。不管你做什么，在虚拟机中做。真的。

# ruby-on-rails - Rails：保持用户欺骗检查 DRY

> ID：901772
> 
> 赞同：1
> 
> 时间：2009-05-23T15:45:34.593
> 
> 标签：ruby-on-rails, ruby, refactoring

出于一种非原创性，我正在使用 Ruby on Rails 编写一个博客应用程序。My`PostsController`包含一些代码，确保登录用户只能编辑或删除他们自己的帖子。

我尝试将此代码分解为一个私有方法，其中包含一个参数以显示 Flash 消息，但是当我这样做并通过编辑另一位作者的帖子对其进行测试时，我得到了一个`ActionController::DoubleRenderError`- “每次操作只能渲染或重定向一次”。

我怎样才能保持这些支票[干燥](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)？显而易见的方法是使用前置过滤器，但该`destroy`方法需要显示不同的闪光灯。

这是相关的控制器代码：

```
before_filter :find_post_by_slug!, :only => [:edit, :show]

def edit

  # FIXME Refactor this into a separate method
  if @post.user != current_user
    flash[:notice] = "You cannot edit another author’s posts."
    redirect_to root_path and return
  end
  ...
end

def update 
  @post = Post.find(params[:id])

  # FIXME Refactor this into a separate method
  if @post.user != current_user
    flash[:notice] = "You cannot edit another author’s posts."
    redirect_to root_path and return
  end
  ...
end

def destroy
  @post = Post.find_by_slug(params[:slug])

  # FIXME Refactor this into a separate method
  if @post.user != current_user
    flash[:notice] = "You cannot delete another author’s posts."
    redirect_to root_path and return
  end
  ...
end

private
def find_post_by_slug!
  slug = params[:slug]
  @post = Post.find_by_slug(slug) if slug
  raise ActiveRecord::RecordNotFound if @post.nil?
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T16:12:47.977

前过滤器方法仍然是一个不错的选择。`action_name`您可以使用控制器的方法访问请求的操作。

```
before_filter :check_authorization

...

protected

def check_authorization
  @post = Post.find_by_slug(params[:slug])
  if @post.user != current_user
    flash[:notice] = (action_name == "destroy") ? 
      "You cannot delete another author’s posts." : 
      "You cannot edit another author’s posts."
    redirect_to root_path and return false
  end
end 
```

很抱歉中间的那个三元运算符。:) 自然你可以做任何你喜欢的逻辑。

如果您愿意，您也可以使用方法，如果失败则通过显式返回来避免双重渲染。这里的关键是返回，这样你就不会重复渲染。

```
def destroy
  @post = Post.find_by_slug(params[:slug])
  return unless authorized_to('delete')
  ...
end

protected

def authorized_to(mess_with)
  if @post.user != current_user
    flash[:notice] = "You cannot #{mess_with} another author’s posts."
    redirect_to root_path and return false
  end
  return true
end 
```

您可以通过拆分行为的不同部分（授权、处理错误授权）来进一步简化它（在我看来），如下所示：

```
def destroy
  @post = Post.find_by_slug(params[:slug])
  punt("You cannot mess with another author's post") and return unless author_of(@post)
  ...
end

protected

def author_of(post)
  post.user == current_user
end

def punt(message)
  flash[:notice] = message
  redirect_to root_path
end 
```

就个人而言，我更喜欢将所有这些日常工作卸载到插件中。我个人最喜欢的授权插件是[Authorization](http://github.com/DocSavage/rails-authorization-plugin/tree/master/)。在过去的几年里，我使用它取得了巨大的成功。

这将重构您的控制器以使用以下变化：

```
permit "author of :post" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T16:04:31.410

简单的答案是将消息更改为适合两者的内容：“您不能与其他作者的帖子混淆。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T01:12:32.113

如果您不喜欢最后一个解决方案中的丑陋* 返回，则可以使用环绕过滤器并仅在用户被授权时有条件地让出。

```
around_filter :check_authorization, :only => [:destroy, :update]

private
def check_authorization
    @post = Post.find_by_slug(params[:slug])
    if @post.user == current_user
        yield
    else
        flash[:notice] = case action_name
        when "destroy"
            "You cannot delete another author's posts."
        when "update"
            "You cannot edit another author's posts."
        end
        redirect_to root_path
    end
end 
```

*-- 这是我的偏好，尽管在代码方面它是完全有效的。我只是发现风格方面，它往往不适合。

我还应该补充一点，我没有对此进行测试，也不是 100% 确定它会起作用，尽管它应该很容易尝试。

# subsonic - 选择包含相同字段名称的 2 个表？

> ID：901774
> 
> 赞同：1
> 
> 时间：2009-05-23T15:46:07.090
> 
> 标签：subsonic, inner-join

我正在开发一个使用基于 Joomla 的数据库的 CMS！在 Joomla db 中，我们有 2 个表：

```
+----------+
|Categories|
+----------+
id
title
...

+-------+
|Content|
+-------+
id
title
catid
... 
```

我在下面有一个查询：

```
SqlQuery q = new Select("*")
                         //.Top("1")
                         .From(JosContent.Schema)
                         .InnerJoin(JosUser.IdColumn, JosContent.CreatedByColumn)
                         .InnerJoin(JosCategory.IdColumn, JosContent.CatidColumn)
                         .Where("catid").IsEqualTo(catId); 
```

在 ASPX 页面中，我显示这样的数据：

```
Tite : <%# DataBinder.Eval(Container.DataItem, "title") %>
In category : <%# DataBinder.Eval(Container.DataItem, "title") %> 
// Category tite not Content title, but ASP.NET think it is Content title :-( 
```

请帮我修好吗？如何区分这两者？

非常感谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T15:52:21.330

您可以通过：引用表格，通过`title`：引用表格。对不起，如果我误解了你的问题。`Categories``Categories.title``title``Content``Content.title`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T16:14:22.047

在您的选择中，您可以像 Alan 所说的那样做，然后使用 AS 更改您稍后引用它们的内容。（我并不特别了解 ASP，我是一名 PHP 程序员，但我认为它非常相似）。

就像是

SELECT *, Categories.title AS categoryTitle, Content.title AS contentTitle ... ...

然后你可以参考 categoryTitle 或 contentTitle。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T17:15:03.633

我已经完成了：）

```
SqlQuery q = new Select("*", "jos_Categories.title AS 'CatTitle'")
                         //Select("*", "CatTitle = jos_Categories.title")
                         //Select("*", "CatTitle = JosCategory.TitleColumn")
                         //.Top("1")
                         .From(JosContent.Schema)
                         .InnerJoin(JosUser.IdColumn, JosContent.CreatedByColumn)
                         .InnerJoin(JosCategory.IdColumn, JosContent.CatidColumn)
                         .Where("catid").IsEqualTo(catId); 
```

谢谢...谷歌:-)

# javascript - JQuery拖放停止在某些对象上工作？

> ID：901775
> 
> 赞同：1
> 
> 时间：2009-05-23T15:46:46.700
> 
> 标签：javascript, jquery, drag-and-drop, postback

通过使用以下 Jquery，我已经成功地使元素（如 div、面板等）可拖动：

```
<script type="text/javascript">
      $(function() {
          $(".drag").draggable({ revert: true });
      });
</script> 
```

这适用于在 page_load 完成之前和任何回发发生之前页面上已经存在的任何内容。我有一系列按钮（带有“.catbuttons”类），当单击它们时，将调用我的数据库并检索一些图像 url。一旦我检索到这组 url，我会执行一个 for/next 循环并创建一大堆图像对象并将它们放入面板中。每个图像都具有“.drag”的 cssclass 以使其与上面的 JQuery 一起使用。

问题是，他们不再拖了！我在这里阅读了另一篇关于在回发（甚至是部分回发？）后需要重新绑定 javascript 内容的文章，这将允许全新的控件将上述 Jquery 代码附加到它们，从而使它们可拖动。经过一些谷歌搜索，我遇到了这个并测试了它：

```
<script type="text/javascript">
        $(".catbuttons").live("click", function(){
            $(".drag").draggable({ revert: true });
        });
 </script> 
```

我尝试将其与原始脚本一起留在我的 aspx 页面的页眉部分，并且在此处完全独立。两种方式都没有骰子。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T16:03:32.860

上面的函数实际上期望用户点击，再次调用draggable。相反，您需要在回发后执行此操作。**这里的规则应该是，在将图像放置在页面上之后，注册所有具有可拖动功能的图像。**

**编辑：** 在您的情况下，单击按钮只会触发获取图像的功能。这些图像应该放在页面上，然后再将它们设为可拖动。您可以在运行时将“.drag”cssclass 应用于这些对象/图像的语句之后立即使用可拖动对象注册创建的对象。

# android - 我在 Ubuntu 9.04 中安装的 Android 可能有什么问题

> ID：901781
> 
> 赞同：2
> 
> 时间：2009-05-23T15:53:08.303
> 
> 标签：android, eclipse

我正在按照（www.softwarepassion.com/?p=176）的安装教程进行解释，一切似乎都很好，没有出现任何错误。但是，当我运行“Hello, world”应用程序时，我的手机上出现了一个空白屏幕，只显示“Android”并带有闪烁的光标。有谁知道我可能会错过什么或做错了什么？我在 Ubuntu 9.04 上使用 Eclipse。

这是我运行应用程序时模拟器的屏幕截图：www.twitpic.com/5rrcg 这是我应该得到的屏幕：developer.android.com/guide/tutorials/images/hello_world_5.png

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T16:09:33.763

你让它坐在那个屏幕上多久？模拟器需要几秒钟才能加载，在我的机器上大约需要 10-15 秒。

# c++ - 像列表一样订购但通过键访问？

> ID：901786
> 
> 赞同：1
> 
> 时间：2009-05-23T15:54:18.570
> 
> 标签：c++, stl, containers

我使用列表将城市放入旅行中。然后我遍历列表以显示旅行行程。我想按名称而不是按行程顺序访问城市。所以，我认为我可以使用地图而不是列表，但键决定了顺序。我仍然想控制序列的顺序，但能够通过键访问条目。

这些功能可以结合起来吗？有没有一些标准的方法来解决这个问题？

```
#include <list>
#include <iostream>
struct City{
   City(std::string a_n, int a_d):name(a_n), duration(a_d){}
   std::string name;
   int duration;
};
int main(){
    std::list<City*> trip;
    trip.push_back(new City("NY", 5));
    trip.push_back(new City("LA", 2));
    for (std::list<City*>::iterator ii=trip.begin(); ii!=trip.end(); ++ii)
        std::cout << (*ii)->name << " for " << (*ii)->duration << " days." <<std::endl;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T16:01:48.633

很多时候，您需要编写多个列表和地图。常见的方法是从列表中的指针存储指向城市查找地图中城市的指针。或者你可以使用像[Boost.MultiIndex](http://www.boost.org/doc/libs/1_39_0/libs/multi_index/doc/index.html)这样的类来做你想做的事，我想说的是更干净。如果您想添加新索引，它的扩展性也更好，并且样板代码也更少。它通常也[更节省空间和时间](http://www.boost.org/doc/libs/1_39_0/libs/multi_index/doc/performance.html)

```
typedef multi_index_container<
  City,
  indexed_by<
    sequenced<>, //gives you a list like interface
    ordered_unique<City, std::string, &City::name> //gives you a lookup by name like map
  >
> city_set; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T15:59:04.263

创建 a `map<string,int> m;`，其中值是 a 的索引`vector<City>`，例如`m["NY"] == 0`和`m["LA"] == 1`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T15:59:56.293

使用两个集合：

*   按您感兴趣的顺序存储实际对象的列表。
*   将名称映射到对象的映射。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T20:08:10.967

最好的解决方案是使用[Boost.MultiIndex](http://www.boost.org/doc/libs/1_39_0/libs/multi_index/doc/index.html)，尽管这稍微复杂一些。不幸的是，我现在没有时间提供示例代码；对不起。

# php - 我应该使用框架还是编写自己的 MVC？

> ID：901788
> 
> 赞同：7
> 
> 时间：2009-05-23T15:56:49.910
> 
> 标签：php, model-view-controller, zend-framework, cakephp, refactoring

我有一个目前到处都是的项目，我正在考虑将其制作为 MVC。

问题是系统当前正在使用，我无法更改界面（它在框架中：s）还有一些我需要自己处理的事情，例如密码生成、登录和用户级别。

我已经有了 MVC 的模型面，所以我想知道是否值得使用 Zend Framework 或 CakePHP 之类的框架，或者只是编写我自己的视图和控制器来解决这个问题？

我将不得不慢慢地工作，如果我使用现成的框架之一，我不确定是否能够做到这一点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-23T16:19:37.273

我为 Coldfusion 编写了自己的 MVC 框架，因为当前的“本月最佳风味”Mach-II 非常缓慢。切换后我的页面生成时间从 2-5 秒下降到 9 毫秒。

在过去的 3 年里，我通过为一系列常见任务构建函数库和组件（ CMS、CC 处理、图像处理等）

尽管毫无疑问，我最终得到的一些“重新发明轮子”正是我完成工作所需要的。我了解它是如何与任何文档都无法提供的亲密感一起工作的。

当然，有一天，一些未来的程序员可能会诅咒我的代码，希望我不使用他们最喜欢的库——但坦率地说——我根本不在乎。我为我写了它，它做了我需要的，而且做得很好。在这个过程中我也学到了很多。

话虽如此，您不会通过编写自己的框架来自动伤害您的客户/同事。公共框架往往没有真正的方向，因此它们往往会大量膨胀，试图让每个人都开心。这种膨胀意味着要学习更多，可能会出错的更多。您的框架将满足一组更小的要求，并且具有良好的文档可能比更成熟的公共框架更容易理解和设置。

我说去吧，生活在边缘一点。也许在 5 年内你会发布下一个“Mach-II”或其他什么，我们都可以抱怨它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-23T16:03:24.233

通常我会惊恐地退缩并建议不要将另一个 Web MVC 框架引入这个世界，但公平地注意到我们的主持人 Joel 和 Jeff 对此事有不同的看法：

来自乔尔：[为重新发明轮子辩护](http://www.joelonsoftware.com/articles/fog0000000007.html) 来自杰夫：[不要重新发明轮子](http://www.codinghorror.com/blog/archives/001145.html)

最后一个想法：如果这是一个人的项目，那么你只会用这个选择影响自己。如果涉及开发长期产品的团队，我的抵抗力会飙升。如果你自己动手，你可能会对团队和客户造成伤害。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-23T15:59:36.667

您会发现 CakePHP 尤其具有“侵入性”。恕我直言，您应该使用轻量级框架或编写自己的框架。我通常不建议为这种事情编写自己的代码，但是当您处理无法更改的软件时，它有时可能是最好的解决方案。此外，在 PHP 中编写控制器并不是一件难事，因此如果您使用的预制解决方案过于重量级或不适合您当前的约束，有时您最终可能会不必要地过度复杂化解决方案。

对于轻量级 MVC 框架，我强烈推荐[CodeIgniter](http://codeigniter.com/)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-23T16:00:08.710

车轮再造是坏事。使用像 Zend Framework 这样久经考验的框架，除非您有非常非常特殊的理由不这样做。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-23T16:20:14.557

这取决于你的任务。一些琐碎的任务已经有了出色的解决方案，但有时修复错误或满足您的需求的解决方案比编写自己的解决方案更难。

无论如何，当您开始使用框架时 - 您必须花一些时间来学习它。有时写作比学习更快。

只需在谷歌上搜索您需要的解决方案，找到一些成熟的解决方案，查看它们的功能，阅读打开的错误并决定是否要使用它。这就是我可以告诉你的所有内容，没有详细的任务。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-23T16:53:47.897

> 问题是系统当前正在使用，我无法更改界面（它在框架中：s）还有一些我需要自己处理的事情，例如密码生成、登录和用户级别。
> 
> 我将不得不慢慢地工作，如果我使用现成的框架之一，我不确定是否能够做到这一点。

不知道您的情况的详细信息，我会说系统当前正在运行的事实将使通用 MVC 框架难以集成。

话虽如此，许多 MVC 框架都是由可用作独立实体的模块化组件组成的。您可能能够提取这些框架的某些功能以在您的项目中使用。

用户身份验证、会话管理和密码处理是一个特别需要从头开始构建的领域，前提是您在该领域拥有丰富的经验。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T14:09:08.833

开发一个框架不是一件容易的事，顺便说一句，你应该不断地编码、测试、修补、更多的测试和开发新功能。因此，如果你不打算让它开源，这对于拥有一个庞大的测试开发人员社区来说是个好主意，你不应该考虑重新发明轮子。它是圆形的，旋转得很好，所以选择最适合您需求的，并从社区几个月的编码和测试中获利。

最良好的祝愿

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-01-15T22:48:19.550

这个问题很老，但仍然有效。就个人而言，我是一个“白手起家”的人。我喜欢节省时间，但不是不惜一切代价。所以我交替使用框架。这意味着我在任何框架之外的 TDD 流程中创建所有业务类/规则，然后将它们集成到允许将我的工作与标准服务和库合并的框架中。但我的工作与它们无关。它们是解耦且快速的。

为了更直接地回答这个问题。我创建了自己的 CMS。我可以告诉你，如果你想了解一些东西，那就创造你自己的。即使你从不分享它。您最终会更好地了解其他系统，这将使您更容易选择一个。再说一次，您可能永远不想使用另一个，然后是您的。但这通常发生在几次修改之后:)

所以是的，创造你自己的，但研究别人。

# ruby-on-rails - 这个嵌入式红宝石分隔符是什么？-%>

> ID：901805
> 
> 赞同：6
> 
> 时间：2009-05-23T16:01:59.257
> 
> 标签：ruby-on-rails

“ `-%>`”出现在我正在做的教程中的一些代码中，作为一些嵌入式红宝石的分隔符，如下所示：

```
<% 5.times do |i| -%>
    <%= thumbnail_tag slideshow.slides[i] %>
<% end -%> 
```

这是什么意思？书中没有关于它的内容（*Rails Up and Running*）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-23T16:07:58.273

除了 Ruby 代码分隔符`<%-`和.`-%>``<%``%>`

在分隔符的内侧添加减号会从 HTML 中去除分隔符外侧旁边的空白。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T16:04:17.400

在 ERB 中，它会删除输出中的任何换行符。

# php - PHP比较数组

> ID：901815
> 
> 赞同：29
> 
> 时间：2009-05-23T16:05:45.200
> 
> 标签：php, arrays, comparison

无论如何，有没有使用内置函数比较 php 中的数组，而不是做某种循环？

```
$a1 = array(1,2,3);
$a2 = array(1,2,3);

if (array_are_same($a1, $a2)) {
    // code here
} 
```

顺便说一句，数组值并不总是以相同的顺序排列。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-23T16:12:26.930

```
if ( $a == $b ) {
    echo 'We are the same!';
} 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-07-14T11:22:59.290

比较两个数组是否具有相等的值（是否重复，考虑到类型杂耍）可以通过使用[`array_diff()`](http://php.net/array_diff)两个方向来完成：

```
!array_diff($a, $b) && !array_diff($b, $a); 
```

这给出了`TRUE`两个数组是否具有相同的值（在类型杂耍之后）。`FALSE`否则。例子：

```
function array_equal_values(array $a, array $b) {
    return !array_diff($a, $b) && !array_diff($b, $a);
}

array_equal_values([1], []);            # FALSE
array_equal_values([], [1]);            # FALSE
array_equal_values(['1'], [1]);         # TRUE
array_equal_values(['1'], [1, 1, '1']); # TRUE 
```

如本例所示，`array_diff`将数组键排除在等式之外，也不关心值的顺序，也不关心值是否重复。

* * *

如果复制必须有所作为，这将变得更加棘手。就“简单”值而言（只有字符串和整数值有效），[`array_count_values()`](http://php.net/array_count_values)用于收集有关哪个值在数组中出现频率的信息。这些信息可以很容易地与`==`：

```
array_count_values($a) == array_count_values($b); 
```

这给出了`TRUE`两个数组是否在相同的时间内具有相同的值（在类型杂耍之后）。`FALSE`否则。例子：

```
function array_equal_values(array $a, array $b) {
    return array_count_values($a) == array_count_values($b);
}

array_equal_values([2, 1], [1, 2]);           # TRUE
array_equal_values([2, 1, 2], [1, 2, 2]);     # TRUE
array_equal_values(['2', '2'], [2, '2.0']);   # FALSE
array_equal_values(['2.0', '2'], [2, '2.0']); # TRUE 
```

这可以通过首先比较两个数组的计数来进一步优化，这相对便宜，并且当计数值重复产生差异时，可以快速测试以区分大多数数组。

* * *

到目前为止，这些示例部分限于字符串和整数值，并且`array_diff`两者都无法进行严格比较。更专注于严格比较的是[`array_search`](http://php.net/array_search). 因此，需要对值进行计数和索引，以便可以比较它们，因为仅仅将它们变成一个键（就像`array_search`这样）不会成功。

这是一个多一点的工作。但是最后的比较与之前的相同：

```
$count($a) == $count($b); 
```

只是`$count`这有所不同：

```
 $table = [];
    $count = function (array $array) use (&$table) {
        $exit   = (bool)$table;
        $result = [];
        foreach ($array as $value) {
            $key = array_search($value, $table, true);

            if (FALSE !== $key) {
                if (!isset($result[$key])) {
                    $result[$key] = 1;
                } else {
                    $result[$key]++;
                }
                continue;
            }

            if ($exit) {
                break;
            }

            $key          = count($table);
            $table[$key]  = $value;
            $result[$key] = 1;
        }

        return $result;
    }; 
```

这保留了一个值表，以便两个数组可以使用相同的索引。也可以在第二个数组中第一次遇到新值时提前退出。

此函数还可以通过附加参数来添加*严格上下文。*并且通过添加另一个附加参数将允许启用或不查找重复项。完整的例子：

```
function array_equal_values(array $a, array $b, $strict = FALSE, $allow_duplicate_values = TRUE) {

    $add = (int)!$allow_duplicate_values;

    if ($add and count($a) !== count($b)) {
        return FALSE;
    }

    $table = [];
    $count = function (array $array) use (&$table, $add, $strict) {
        $exit   = (bool)$table;
        $result = [];
        foreach ($array as $value) {
            $key = array_search($value, $table, $strict);

            if (FALSE !== $key) {
                if (!isset($result[$key])) {
                    $result[$key] = 1;
                } else {
                    $result[$key] += $add;
                }
                continue;
            }

            if ($exit) {
                break;
            }

            $key          = count($table);
            $table[$key]  = $value;
            $result[$key] = 1;
        }

        return $result;
    };

    return $count($a) == $count($b);
} 
```

用法示例：

```
array_equal_values(['2.0', '2', 2], ['2', '2.0', 2], TRUE);           # TRUE
array_equal_values(['2.0', '2', 2, 2], ['2', '2.0', 2], TRUE);        # TRUE
array_equal_values(['2.0', '2', 2, 2], ['2', '2.0', 2], TRUE, FALSE); # FALSE
array_equal_values(['2'], ['2'], TRUE, FALSE);                        # TRUE
array_equal_values([2], ['2', 2]);                                    # TRUE
array_equal_values([2], ['2', 2], FALSE);                             # TRUE
array_equal_values([2], ['2', 2], FALSE, TRUE);                       # FALSE 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-01-17T12:44:03.733

@Cleanshooter 很抱歉，但这并没有，这是预期要做的事情：（在此上下文中提到的 array_diff 也是如此）

```
$a1 = array('one','two');
$a2 = array('one','two','three');

var_dump(count(array_diff($a1, $a2)) === 0); // returns TRUE 
```

（注解：你不能[在 PHP 5.5 之前](http://php.net/migration55.new-features)的函数上使用空）在这种情况下，尽管数组不同，但结果为真。

> array_diff [...] 返回一个数组，其中包含 array1 中不存在于任何其他数组中的所有条目。

这并不意味着`array_diff`类似于：`array_get_all_differences`. 在它计算的数学集合中解释：

```
{'one','two'} \ {'one','two','three'} = {} 
```

这意味着类似于第一组中的所有元素，而第二组中的所有元素都在第一组中。以便

```
var_dump(array_diff($a2, $a1)); 
```

计算为

```
array(1) { [2]=> string(5) "three" } 
```

结论是，您必须以`array_diff`“两种方式”来获取两个数组的所有“差异”。

希望这可以帮助 ：）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-11-06T16:24:25.873

您也可以尝试这种方式：

```
if(serialize($a1) == serialize($a2)) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-23T16:12:21.500

只需检查`$a1 == $a2`- 那有什么问题？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-11-20T02:30:48.153

[`array_intersect()`](http://www.php.net/array-intersect)返回一个包含所有公共值的数组。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-15T10:28:11.520

来自这里的评论的结论：

数组值的比较相等（在类型杂耍之后）并且仅以相同的顺序：

```
array_values($a1) == array_values($a2) 
```

数组值相等（在类型杂耍之后）且顺序相同且数组键相同且顺​​序相同的比较：

```
array_values($a1) == array_values($a2) && array_keys($a1) == array_keys($a2) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-08-07T06:16:54.457

从用户那里获取数组或输入数组值。使用排序函数对两个数组进行排序。使用三元运算符检查。如果两个数组相等，它将打印数组相等，否则它将打印数组不相等。这里没有循环迭代。

```
sort($a1);
sort($a2);
echo (($a1==$a2) ? "arrays are equal" : "arrays are not equal"); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-08-21T15:27:36.113

一种用于比较可以按任何顺序排列的数组值的快速方法...

```
function arrays_are_same($array1, $array2) {
    sort($array1);
    sort($array2);
    return $array1==$array2;
} 
```

因此对于...

```
 $array1 = array('audio', 'video', 'image');
    $array2 = array('video', 'image', 'audio'); 
```

`arrays_are_same($array1, $array2)`将返回`TRUE`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-01-02T10:57:49.263

如果您想在**一个大数组**（> 10k）中搜索某个数组，那么比较序列化数组（保存在缓存中）**要快得多。**使用 URL 的示例：

```
/**
@return array
*/
function createCache()
{
    $cache = [];
    foreach ($this->listOfUrl() as $url => $args)
    {
        ksort($args);
        $cache['url'][$url] = $args;
        $cache['arr'][crc32(serialize($args))] = $url;
    }
    return $cache;
}

/**
@param array $args
@return string
*/
function searchUrl($args)
{
    ksort($params);
    $crc = crc32(serialize($params));        
    return isset($this->cache['arr'][$crc]) ? $this->cache['arr'][$crc] : NULL;                
} 

/**
@param string $url
@return array
*/
function searchArgs($url)
{
    return isset($this->cache['url'][$url]) ? $this->cache['url'][$url] : NULL;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-05-12T03:54:20.903

比较两个数组的值：

```
$a = array(1,2,3);
$b = array(1,3,2);

if (array_diff($a, $b) || array_diff($b, $a)) {
    echo 'Not equal';
}else{
    echo 'Equal';
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-17T20:00:53.570

验证交叉点计数是否与两个源数组相同

```
$intersections = array_intersect($a1, $a2);
$equality = (count($a1) == count($a2)) && (count($a2) == count($intersections)) ? true : false; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-10-19T03:04:04.377

这是获得差异的简单方法：

```
$array1 = [40,10,30,20,50];
$array2 = [10,30];
$result = array_filter(
                       $array1,
                       function($var) use($array2){
                                if(in_array($var, $array2)){
                                   return $var;
                                }
                         }
             );
print_r($result); //Array ( [0] => 10 [1] => 30 ) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-01-22T16:47:13.543

如果您不关心键而只关心值，那么这是比较值并确保计算重复项的最佳方法。

```
$mag = '{"1":"1","2":"2","3":"3","4":"3"}';
$mag_evo = '1|2|3';

$test1 = array_values(json_decode($mag, true));
$test2 = array_values(explode('|', $mag_evo));

if($test1 == $test2) {
    echo 'true';
} 
```

这不会回显 true，因为 $mag 在数组中有 2 个等于 3 的值。

如果您只关心值和键而不关心重复，则此方法效果最佳。$mag = '{"1":"1","2":"2","3":"3","4":"3"}'; $mag_evo = '1|2|3';

```
$test1 = json_decode($mag, true);
$test2 = explode('|', $mag_evo);

// There is no difference in either array.  
if(!array_diff($test1, $test2) && !array_diff($test2, $test1)) { 
    echo 'true';
} 
```

这将返回 true，因为在两个数组中都找到了所有值，但如前所述，它不关心重复。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2012-05-23T08:48:55.013

尝试这个 ：

```
$array1 = array("street" => array("Althan"), "city"   => "surat", "state"  => "guj", "county" => "india");
        $array2  = array("street" => array("Althan"), "city"   => "surat", "state"  => "guj", "county" => "india");

    if (array_compare($array1, $array2))
    {
             echo "<pre>";
             print_r("succsses..!");
             echo "</pre>";
             exit;

    }
    else
    {
            echo "<pre>";
            print_r("Faild..!");
            echo "</pre>";
            exit;
    }

    function array_compare($op1, $op2)
    {

            foreach ($op1 as $key => $val)
            {
                    if (is_array($val))
                    {
                            if (array_compare($val, $op2[$key]) === FALSE)
                                    return false;
                    }
                    else
                    {

                            if (!array_key_exists($key, $op2))
                            {
                                    return false; // uncomparable
                            }
                            elseif ($val < $op2[$key])
                            {
                                    return false;
                            }
                            elseif ($val > $op2[$key])
                            {
                                    return false;
                            }
                    }
            }
            return true; // $op1 == $op2
    } 
```

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2009-07-02T18:29:32.310

```
if(count($a1) == count($a2)){
    $result= array_intersect($a1, $a2);
    if(count($a1) == count($result))
        echo 'the same';
    else
        echo 'a1 different than a2';
} else
        echo 'a1 different than a2'; 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2012-11-02T22:21:17.727

据我所知，没有一个内置函数可以为您完成，但是，类似于：

```
if (count($a) == count($b) && (!count(array_diff($a, $b))) {
  // The arrays are the same
} 
```

应该做的伎俩

# hibernate - 从 grails 1.1-beta3 升级到 grails 1.1.1 的文件附件损坏

> ID：901818
> 
> 赞同：1
> 
> 时间：2009-05-23T16:07:45.980
> 
> 标签：hibernate, grails

这是一个相当具体的升级路径，但这是我正在做的。我想我也尝试过 1.1，并且遇到了同样的问题，但不是 100% 确定。

无论如何，我使用的是 1.1-beta3 并且已经实现了一个文件上传/附件系统，如下所述：`thegioraproject.com/2008/03/26/image-attachments-in-grails-using-imagemagick/`

我有一个具有“徽标”（定义为图像域）的“经纪人”对象。Image 和 Attachment（父类）按照上面 URL 中的定义完成。

在 brokerController 中，我有这样的代码：

```
 def file = new Image()
    def f = params.logo
    if(f.size>0) {
        file.setFile(f)
        file?.save(flush:true)
        brokerUserInstance.logo?.delete()
        brokerUserInstance.logo = file
    } 
```

“徽标”是表单中上传文件的名称。在此代码之后，还有更多标准 grails CRUD 代码（`brokerUserInstance.properties=params`、`brokerUserInstance.save()`等）。

这在 1.1-beta3 中运行良好。我可以上传一张图片，它会被缩略图化并附加到域中（关系在数据库中就位，等等）。当我更新代理对象而不上传新图像时，旧图像保持不变。

转到 grails 1.1.1，当我尝试上传新图像时，我得到：

```
Error 500: org.springframework.dao.InvalidDataAccessApiUsageException: object references an unsaved transient instance - save the transient instance before flushing: Image; nested exception is org.hibernate.TransientObjectException: object references an unsaved transient instance - save the transient instance before flushing: Image 
```

如果我不上传图片，我会得到：

```
[org.springframework.web.multipart.commons.CommonsMultipartFile] to required type [Image] for property logo; nested exception is java.lang.IllegalArgumentException: Cannot convert value of type [org.springframework.web.multipart.commons.CommonsMultipartFile] to required type [Image] for property logo: no matching editors or conversion strategy found 
```

在这个问题上，我几乎可以找到 0。在 1.1-beta3 中工作正常，但在 1.1.1（可能还有 1.1）中发生了一些变化（戏剧性地）。

有什么建议/想法/帮助吗？我很高兴向某人授予服务器访问权限以帮助调试它。

谢谢 ：）

# python - 在 Python 中执行 *nix 二进制文件

> ID：901829
> 
> 赞同：1
> 
> 时间：2009-05-23T16:12:09.193
> 
> 标签：python, gnu-screen

我需要运行以下命令：

```
screen -dmS RealmD top 
```

*本质上是在后台调用 GNU 屏幕，会话标题为“RealmD”，顶部命令在屏幕内运行。必须以这种方式调用该命令，因此此时在重新装备服务器之前不能替代屏幕。（另一个项目另一个时间）*

*我已经替换了需要运行的服务器二进制文件的 top 命令。但是在为这个 python 模块调试代码时，top 是一个不错的替代品。*

**我真正需要的是一种在 Python 中使用上述参数执行屏幕的方法。**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-23T16:20:59.753

`os.system`是最简单的方法，但是，为了获得更多的可能性和自由度，还请查看标准库[`subprocess`](http://docs.python.org/library/subprocess.html)模块（当然，除非 Stephan202 非常简单的使用`os.system`满足您的所有需求；-）。

**编辑**这是标准的替代品`os.system()`

```
p = Popen("screen -dmS RealmD top", shell=True)
sts = p.wait() 
```

[http://docs.python.org/library/subprocess.html#replacing-os-system](http://docs.python.org/library/subprocess.html#replacing-os-system)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-23T16:16:13.543

使用[os.system](http://docs.python.org/3.0/library/os.html#os.system)：

```
os.system("screen -dmS RealmD top") 
```

然后在一个单独的 shell 中，你可以`top`通过运行来查看`screen -rd RealmD`。

# asp.net-mvc - ASP.NET MVC UI Helper 列表和文档

> ID：901847
> 
> 赞同：0
> 
> 时间：2009-05-23T16:22:43.950
> 
> 标签：asp.net-mvc, documentation

是否有用于 ASP.NET MVC 的 UI 助手的更新列表？我只能找到测试版东西的文档。我有消息来源，无论如何我可能最终都会看到它，但如果能跑下来就好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T16:49:48.573

它们列在[MSDN](http://msdn.microsoft.com/en-us/library/system.web.mvc.htmlhelper_members.aspx)上该类的“扩展方法”下`HtmlHelper`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T16:49:17.607

查看 MSDN，几乎有 MVC 框架的完整文档。
[http://msdn.microsoft.com/en-us/library/dd410596.aspx](http://msdn.microsoft.com/en-us/library/dd410596.aspx)

# c++ - 制作一个遍历 2 个容器的 c++ 迭代器

> ID：901848
> 
> 赞同：3
> 
> 时间：2009-05-23T16:22:47.367
> 
> 标签：c++, iterator

我需要一个类似下面的“容器”。它有 2 个子容器，称为 A 和 B，我需要能够仅迭代 A、B 以及 A 和 B 的组合。我不想为冗余数据使用额外的空间，所以我想制作自己的迭代器来迭代 A 和 B 的组合。制作自己的迭代器的最简单方法是什么？或者，还有什么方法可以做到这一点？

**编辑**最终，我认为这不是好的设计。我重新设计了整个班级层次结构。+1 用于重构。但是，我确实充分解决了这个问题。这是我所做的简化版本，以供参考；它使用 boost::filter_iterator。令 T 为容器中的类型。

```
enum Flag
{
    A_flag,
    B_flag
};

class T_proxy
{
public:
    T_proxy(const T& t, Flag f) : t_(t), flag_(f) {}
    operator T() const {return t_;}
    Flag flag() const {return flag_;}
    class Compare
    {
    public:
        Compare(Flag f) : matchFlag_(f) {}
        operator() (const T_proxy& tp) {return tp.flag() == matchFlag_;}
    private:
        Flag matchFlag_;
    };
private:
    T t_;
    Flag flag_;
};

class AB_list
{
public:
    typedef T_proxy::Compare Compare;
    typedef vector<T_proxy>::iterator iterator;
    typedef boost::filter_iterator<Compare, iterator> sub_iterator;
    void insert(const T& val, Flag f) {data_.insert(T_proxy(val, f));}
    // other methods...

    // whole sequence
    iterator begin() {return data_.begin();}
    iterator end() {return data_.end();}

    // just A
    sub_iterator begin_A() {return sub_iterator(Compare(A_flag), begin(), end());
    sub_iterator end_A() {return sub_iterator(Compare(A_flag), end(), end());

    // just B is basically the same
private:
    vector<T_proxy> data_;
};

// usage
AB_list mylist;
mylist.insert(T(), A_flag);
for (AB_list::sub_iterator it = mylist.begin_A(); it != mylist.end_A(); ++it)
{
    T temp = *it; // T_proxy is convertible to T
    cout << temp;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T16:25:59.097

我将重新发布我对类似问题的回答。我认为这会做你想要的。

使用像[Boost.MultiIndex](http://www.boost.org/doc/libs/1_39_0/libs/multi_index/doc/index.html)这样的库来做你想做的事。如果您想添加新索引，它可以很好地扩展，并且样板代码要少得多。它通常也[更节省空间和时间](http://www.boost.org/doc/libs/1_39_0/libs/multi_index/doc/performance.html)

```
typedef multi_index_container<
  Container,
  indexed_by<
    sequenced<>, //gives you a list like interface
    ordered_unique<Container, std::string, &Container::a_value>, //gives you a lookup by name like map
    ordered_unique<Container, std::string, &Container::b_value> //gives you a lookup by name like map
  >
> container; 
```

如果您正在迭代一个索引，您可以使用库中的迭代器投影概念切换到另一个索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T16:25:43.340

有一个容器来存储您感兴趣的值以及一个指示它是在 A 还是 B 中的标志。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T16:30:49.907

您还可以创建一个包含 std::pair<> 对象的容器。

比利3

# grails - 什么是“按约定编码”？

> ID：901851
> 
> 赞同：25
> 
> 时间：2009-05-23T16:24:10.907
> 
> 标签：grails, groovy

我一直在看 Grails 上的 Groovy 并注意到底部有一行写着：

> Grails 旨在将“按惯例编码”范式引入 Groovy。

究竟什么是约定俗成的编码？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-23T16:34:36.053

> 约定优于配置（又名约定编码）是一种软件设计范式，旨在减少开发人员需要做出的决策数量，获得简单性，但不一定失去灵活性。
> 
> 这句话本质上意味着开发人员只需要指定应用程序的非常规方面。例如，如果模型中有一个类Sale，则数据库中对应的表默认称为sales。只有当人们偏离这一约定时，例如调用表“products_sold”，才需要编写有关这些名称的代码。
> 
> 当您使用的工具实现的约定与您想要的行为相匹配时，您无需编写配置文件即可享受好处。当您想要的行为偏离实现的约定时，您可以配置您想要的行为。

来自[Wikipedia 上的“约定优于配置”一文](http://en.wikipedia.org/wiki/Convention_over_Configuration)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-23T16:35:02.327

在 Grails 的上下文中，“按约定编码”意味着大量（乏味和重复的）显式代码和/或配置被简单的命名和目录结构约定所取代。例如：

*   任何在 grails-app/controllers 目录中名称以 Controller 结尾的类都会自动成为 Spring 控制器，并且其中定义的闭包将绑定到 URL - 您不必像使用时那样在 XML 文件中配置它纯净的春天。
*   taglibs（grails-app/taglib 目录）也是如此——不再需要繁琐的 TLD 文件！
*   grails-app/domain 中的域类可能具有最大的“约定魔法”，它会自动映射到自动生成的 DB 模式 - 按照约定，DB 表和列名称与域属性名称相同。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-23T16:35:04.213

按约定编码与按配置编码：您对东西有一定的放置或命名约定的想法，因此您不必明确告诉程序东西在哪里或叫什么。
例如，在 ASP.Net MVC 中，对于视图的存储位置和调用方式有一个约定。这意味着当您的代码指示服务器返回视图时，运行时将在某些文件夹中查找具有特定命名结构的视图。请参阅[此 pdf](http://blog.codeville.net/blogfiles/2009/April/Pro_ASP_NET_MVC_Framework-4358.pdf)中的第 20 页以获得更清晰的信息。

另一个例子是方法的命名约定。例如，在事件驱动的语言中，您可以选择显式声明哪个方法处理哪些事件，或者您可以依赖命名约定 - 例如 ..._OnOpen 或 ...OnClick，然后依赖运行时来确定调用给定事件的正确方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-23T16:29:21.203

这里有很多约定：

1.  如何命名 HTML 元素，以便它们可以作为 HTTP 请求的参数轻松访问；
2.  如何将对象属性与数据库中的表名和列名相关联；
3.  如何将项目安排到目录/包中；

当您发现自己以特定方式解决常见问题时，您就会这样做。您注意到相似之处并将它们编入一些自动化方案中。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-23T16:35:56.350

请参阅[约定优于配置](http://en.wikipedia.org/wiki/Convention_over_Configuration)。这是设计工具或框架以将最常见的配置选项作为默认值的概念，因此对于绝大多数用户而言，不需要配置。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-23T16:31:48.630

这意味着，如果您遵守所使用的任何基于约定的框架所定义的某些编码约定，您将免费获得许多功能。换句话说，如果你按照框架的期望来构建你的应用程序，可以节省很多工作。

按照惯例查找编码的优缺点是一个好主意。

# c# - LINQ：如何声明 IEnumerable[AnonymousType]？

> ID：901854
> 
> 赞同：28
> 
> 时间：2009-05-23T16:28:00.987
> 
> 标签：c#, .net, linq

这是我的功能：

```
 private IEnumerable<string> SeachItem(int[] ItemIds)
    {
        using (var reader = File.OpenText(Application.StartupPath + @"\temp\A_A.tmp"))
        {
            var myLine = from line in ReadLines(reader)
                         where line.Length > 1
                         let id = int.Parse(line.Split('\t')[1])
                         where ItemIds.Contains(id)
                         let m = Regex.Match(line, @"^\d+\t(\d+)\t.+?\t(item\\[^\t]+\.ddj)")
                         where m.Success == true
                         select new { Text = line, ItemId = id, Path = m.Groups[2].Value };
            return myLine;
        }
    } 
```

我收到编译错误，因为“myLine”不是 IEnumerable[string]，而且我不知道如何编写 IEnumerable[Anonymous]

“无法将类型 'System.Collections.Generic.IEnumerable[AnonymousType#1]' 隐式转换为 'System.Collections.Generic.IEnumerable[string]'”

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-23T16:36:39.373

您无法声明`IEnumerable<AnonymousType>`，因为该类型在构建时没有（已知）名称。因此，如果您想在函数声明中使用此类型，请将其设为普通类型。或者只是修改您的查询以返回 a`IENumerable<String>`并坚持使用该类型。

或`IEnumerable<KeyValuePair<Int32, String>>`使用以下选择语句返回。

```
select new KeyValuePair<Int32, String>(id, m.Groups[2].Value) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-23T17:06:13.240

我不一定推荐这个......这是对类型系统的一种颠覆，但你可以这样做：

1）更改您的方法签名以返回`IEnumerable`（非通用的）

2）通过示例助手添加[演员：](http://blogs.msdn.com/alexj/archive/2007/11/22/t-castbyexample-t-object-o-t-example.aspx)

```
public static class Extensions{
    public static IEnumerable<T> CastByExample<T>(
            this IEnumerable sequence, 
            T example) where T: class
    {
        foreach (Object o in sequence)
            yield return o as T;
    }
} 
```

3）然后调用这样的方法：

```
var example = new { Text = "", ItemId = 0, Path = "" };
foreach (var x in SeachItem(ids).CastByExample(example))
{
    // now you can access the properties of x 
    Console.WriteLine("{0},{1},{2}", x.Text, x.ItemId, x.Path);
} 
```

你完成了。

关键在于，如果您在两个地方创建具有相同顺序、类型和属性名称的匿名类型，则类型将被重用。知道这一点，您可以使用泛型来避免反射。

希望这有助于亚历克斯

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-23T16:39:10.510

on 方法签名`SearchItem`表示该方法返回一个`IEnumerable<string>`但在 LINQ 查询中声明的匿名类型不是 type `string`。如果要保留相同的方法签名，则必须将查询更改为仅选择`string`seg

```
return myLine.Select(a => a.Text); 
```

如果您坚持返回查询选择的数据，则可以返回一个`IEnumerable<object>`if 您将`return`语句替换为

```
return myLine.Cast<object>(); 
```

然后您可以使用反射来使用对象。

但实际上，如果您要在声明它的方法之外使用匿名类型，您应该定义一个类，并让该方法返回该类的一个`IEnumerable`。匿名类型很方便，但它们容易被滥用。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-23T16:58:44.627

您的函数试图返回 IEnumerable<string>，而您正在执行的 LINQ 语句实际上返回的是 IEnumerable<T>，其中 T 是编译时生成的类型。匿名类型并不总是匿名的，因为它们在编译代码后采用特定的具体类型。

然而，匿名类型，因为它们在编译之前是短暂的，只能在创建它们的范围内使用。为了在您提供的示例中支持您的需求，我想说最简单的解决方案是创建一个简单的实体来存储结果您的查询：

```
public class SearchItemResult
{
    public string Text { get; set; }
    public int ItemId { get; set; }
    public string Path { get; set; }
}

public IEnumerable<SearchItemResult> SearchItem(int[] itemIds)
{
    // ...
    IEnumerable<SearchItemResult> results = from ... select new SearchItemResult { ... }
} 
```

但是，如果您的最终目标不是检索某种对象，并且您只对路径感兴趣……那么您仍然可以生成一个 IEnumerable<string>：

```
IEnumerable<string> lines = from ... select m.Groups[2].Value; 
```

我希望这有助于澄清您对 LINQ、可枚举和匿名类型的理解。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-05T16:54:28.303

返回 a`ValueTuple`而不是匿名类。例如（使用“命名元组”）-

```
(Text: line, ItemId: id, Path: m.Groups[2].Value) 
```

[https://docs.microsoft.com/en-us/dotnet/csharp/tuples](https://docs.microsoft.com/en-us/dotnet/csharp/tuples)

代替-

```
new { Text = line, ItemId = id, Path = m.Groups[2].Value } 
```

它`ValueTuple`是 C# 版本 7 的一部分，最初是作为单独的 NuGet 包 (System.ValueTuple) 实现的。从 .NET 4.7 开始，它是一种内置类型。对于 .NET Core，2.0 之前的版本需要 NuGet 包，但它是 2.0 版内置的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-23T16:35:10.203

要记住的一件事是`LINQ`语句使用[延迟执行](http://msdn.microsoft.com/en-us/library/bb669162.aspx)。这意味着您的`LINQ`语句实际上不会执行，除非您在`foreach`语句中对其进行迭代或调用`.ToList()`on 方法`myLine`。
对于您的示例，请尝试更改：

```
return myLine; 
```

到：

```
return myLine.ToList(); 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2021-09-28T18:19:56.547

此链接可能对最终来到这里的其他人有用 [https://idreesdotnet.blogspot.com/2019/08/c-how-to-create-list-of-anonymous-type.html](https://idreesdotnet.blogspot.com/2019/08/c-how-to-create-list-of-anonymous-type.html)

第一个解决方案（6 个）非常简单

1：首先创建匿名类型的对象，然后将其传递给数组并调用 ToList() 方法。

```
 var o1 = new { Id = 1, Name = "Foo" };
   var o2 = new { Id = 2, Name = "Bar" };
   var list = new[] { o1, o2 }.ToList(); 
```

# sql - MySQL 在同一张表上有 2 个 LEFT JOIN

> ID：901855
> 
> 赞同：3
> 
> 时间：2009-05-23T16:28:38.427
> 
> 标签：sql, mysql, left-join

我正在尝试运行此查询：

```
SELECT 
  Destaque.destaque, Noticia.id, Noticia.antetitulo, 
  Noticia.titulo, Noticia.lead, Noticia.legenda, 
  Noticia.publicacao, Seccao.descricao, Album.pasta,
  Foto.ficheiro, Foto.descricao, Cronista.nome, 
  Cronista.profissao, Cronista.ficheiro,
  AudioFile.*, AudioCollection.*, VideoFile.*, VideoCollection.*
FROM 
  nt_highlights AS Destaque
  LEFT JOIN nt_noticias  AS Noticia         ON Destaque.noticia_id = Noticia.id
  LEFT JOIN mm_fotos     AS Foto            ON Noticia.foto_id = Foto.id
  LEFT JOIN nt_temas     AS Seccao          ON Noticia.tema_id = Seccao.id
  LEFT JOIN mm_albuns    AS Album           ON Foto.album_id = Album.id
  LEFT JOIN nt_cronistas AS Cronista        ON Cronista.id = Noticia.cronista_id  
  LEFT JOIN ntNoticias_mmFiles AS Rel       ON Rel.noticia_id = Noticia.id
  LEFT JOIN mm_files     AS AudioFile       ON AudioFile.id = Rel.file_id
  LEFT JOIN mm_coleccoes AS AudioCollection ON AudioFile.coleccao_id = AudioCollection.id        
  LEFT JOIN mm_files     AS VideoFile       ON VideoFile.id = Rel.file_id
  LEFT JOIN mm_coleccoes AS VideoCollection ON VideoFile.coleccao_id = VideoCollection.id
WHERE 
  Destaque.area_id = 1
  AND Noticia.paraPublicacao = 1 
  AND Noticia.publicacao <= NOW()   
  AND (AudioFile.mimeType != '' OR AudioFile.id IS NULL)
  AND (VideoFile.mimeType = '' OR VideoFile.id IS NULL)
ORDER BY 
  Destaque.destaque 
```

这将为我提供一些文章（来自`nt_noticias`），其想法是同时从表中获取 a`Video`和一个`Audio`文件。`mm_files`

发生的情况是，当我有一篇有声音和视频的文章时，MySQL 将返回 4 行：

*   有声音（视频为空）
*   带视频（声音为空）
*   全部为空
*   有声音和视频

我如何“强制”它在每篇文章中只返回一行并关联任何现有的视频和音频？我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T16:50:00.803

JOIN 将返回所有组合，这就是问题所在。
如果每篇文章只有一个音频和/或视频文件，那么您可能需要查看子选择。在 SQL Server 中，这看起来像（未经测试的代码）：

```
SELECT title, 
       (select TOP 1 audio from audio where audio.aid = articles.id) as Audio, 
       (select TOP 1 video from video where video.aid = articles.id) as Video
FROM articles 
```

请注意，在大型数据集上，这可能会表现不佳，因为此示例中的子选择是针对返回到外部查询的每一行单独执行的。例如，如果您返回 10,000 篇文章，那么实际上将在服务器上执行总共 20,001 个查询。还有其他可能的答案可以克服这个问题，但他们会更多地参与进来（我怀疑你可以用派生表做一些事情，但目前我还没有想到）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T17:41:35.883

我*想*你想要这样的东西：

```
SELECT 
  Destaque.destaque, Noticia.id, Noticia.antetitulo, 
  Noticia.titulo, Noticia.lead, Noticia.legenda, 
  Noticia.publicacao, Seccao.descricao, Album.pasta,
  Foto.ficheiro, Foto.descricao, Cronista.nome, 
  Cronista.profissao, Cronista.ficheiro,
  AudioFile.*, AudioCollection.*, VideoFile.*, VideoCollection.*
FROM 
  nt_highlights AS Destaque
  LEFT JOIN nt_noticias  AS Noticia         ON Destaque.noticia_id = Noticia.id
  LEFT JOIN mm_fotos     AS Foto            ON Noticia.foto_id = Foto.id
  LEFT JOIN nt_temas     AS Seccao          ON Noticia.tema_id = Seccao.id
  LEFT JOIN mm_albuns    AS Album           ON Foto.album_id = Album.id
  LEFT JOIN nt_cronistas AS Cronista        ON Cronista.id = Noticia.cronista_id  
  LEFT JOIN ntNoticias_mmFiles AS AudioRel  ON Rel.noticia_id = Noticia.id
                                               AND AudioRel.file_id IN (
    SELECT file_id 
    FROM   ntNoticias_mmFiles 
    WHERE  noticia_id = Noticia.id AND IsAudioFile = 1 /* whatever the check is */
    LIMIT  1
  )
  LEFT JOIN mm_files     AS AudioFile       ON AudioFile.id = Rel.file_id
  LEFT JOIN mm_coleccoes AS AudioCollection ON AudioFile.coleccao_id = AudioCollection.id        
  LEFT JOIN ntNoticias_mmFiles AS VideoRel  ON VideoRel.noticia_id = Noticia.id
                                               AND VideoRel.file_id IN (
    SELECT file_id 
    FROM   ntNoticias_mmFiles 
    WHERE  noticia_id = Noticia.id AND IsVideoFile = 1  /* whatever the check is */
    LIMIT  1
  )
  LEFT JOIN mm_files     AS VideoFile       ON VideoFile.id = Rel.file_id
                                               AND VideoFile.IsVideoFile = 1
  LEFT JOIN mm_coleccoes AS VideoCollection ON VideoFile.coleccao_id = VideoCollection.id
WHERE 
  Destaque.area_id = 1
  AND Noticia.paraPublicacao = 1 
  AND Noticia.publicacao <= NOW()   
ORDER BY 
  Destaque.destaque 
```

我的想法是这样的：

您最多需要一个音频文件和一个视频文件。每个 有多个文件可用`Noticia`，因此您需要确保每种类型最多有一个文件进入连接。这也意味着您必须加入`ntNoticias_mmFiles`表两次——每种类型一次。

这就是连接条件中的子查询应该做的事情：每种文件类型选择一行。从那里继续，您可以将其余数据加入其中，就像您已经做的一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T17:05:28.343

您可能希望将该连接查询优化为视图。这是一个很大的查询，而且有这么多的连接，效率会很低。另外，视图可以帮助您调试连接，并且通过允许您分别编写连接（在视图中）和 WHERE 子句（在视图中的选择中）来帮助您调试查询，从而基本上简化了操作。

# django - 将 PHP 论坛集成到 Django 站点的最佳方法是什么？

> ID：901857
> 
> 赞同：4
> 
> 时间：2009-05-23T16:29:15.617
> 
> 标签：django

假设您正在运行一个 Django 站点，并且有一个旧的 PHP 论坛来支持和集成到您的站点中，因为当前的 Django 论坛解决方案还不够成熟。

做这个的最好方式是什么？

目前我有一个简单的视图，它呈现了一个非常简单的模板，它扩展了我网站的基本模板，内容区域只有一个`<IFRAME>`将论坛作为其`src`. 一个小的 jQuery 函数用于最大化`<IFRAME>`' 高度（一旦完成加载），以包含 100% 的论坛内容。

但这一切听起来很尴尬。你会怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T20:04:18.850

有几个选项。没有一个是理想的（但混合两个平台绝不是！）

1.  按照您的建议使用 iframe（因为地址栏中的地址始终是 django 页面的地址，如果有人处理论坛外的链接，它将是 PHP 论坛，而不是 django 持有者）

2.  使用 iframe 但不是一直使用相同`src`的，而是解析 URL 并将相对位附加到 iframe 的 src 上。即，如果 django 看到`/forum/this-url`，将 src 设置为`http://forum-address/this-url`并确保所有链接目标`parent`。这样做的好处是始终在地址栏中显示正确的链接（而不是总是显示 /forum/）。您需要破解您的论坛才能使其正常工作。

3.  代理内容并将其正确注入页面。您需要传递 cookie，它可能会变得非常混乱，但在大多数情况下，这是整合事物的好方法，因为您的链接将始终正确。您需要删除您的论坛主题以去除所有内容，包括`<body>`标签。

4.  以与 Django 站点相同的方式为您的论坛设置主题。这将提供最佳性能，但如果您在 django 模板中使用动态内容，您可能会遇到问题。解决这个问题的一个方法是让 django 模板将内容缓存到 memcache 并使用 php-memcache 将它们拉出到您的论坛模板中。

我过去做过3和4。我将 3 用于一个非常简单的表单（因此不必像您那样处理 cookie 和会话）。我使用 4 将 FluxBB 论坛集成到 Wordpress 安装中。*两者都是 PHP，但在*Wordpress中加载 FluxBB 会非常臃肿。我将动态模板的东西缓存到 memcache 中，然后在论坛模板中将它们拉出来。

为此，我可能会建议使用#4。必须保持两个主题是一件很痛苦的事情，但它是迄今为止性能最快的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T20:15:33.243

当我阅读问题摘要时，我立即想到您需要某种脚本，该脚本可以通过 Django 中的 Dispatcher 链接到信号，以将用户数据库从您的 Django 站点同步到论坛。这将检查事物的身份验证方面 - 但您仍然需要执行 Oli 建议的其中一项操作，以使它们看起来相同。

主题化可能是最轻松的途径，但这并不是说它会很容易！

# asp.net - 母版页上的搜索文本框触发验证错误

> ID：901866
> 
> 赞同：0
> 
> 时间：2009-05-23T16:32:01.267
> 
> 标签：asp.net

我最近遇到了一个有趣的问题。在 ASP.NET 母版页中，我有一个登录控件和一个 Google 搜索框，如下所示：

```
 <div id="searchBox">
         <table border="0" cellpadding="0" cellspacing="0" width="100%">
                        <tr><td> <asp:TextBox ID="q" MaxLength="100" AutoPostBack="false" runat="server" onclick="ctl00$q.value=''" CausesValidation="False" Text="Google Custom Search" /></td>
                           <td align="right">
                              <asp:ImageButton ID="_btnSearch" runat="server" AlternateText="Search" validationgroup="SearchGroup"
                                 CommandName="Search" ImageUrl="~/images/search.gif" OnClick="_btnSearch_Click"/>
                           </td>
                           <td width="5px" align="right">
                           <asp:RequiredFieldValidator ID="_rfvQ" ControlToValidate="q" runat="server" validationgroup="SearchGroup" />
<asp:HiddenField ID="cx" Value="00054535354544538:kmy_69vgpnm" runat="server" />
<asp:HiddenField ID="cof" Value="FORID:11" runat="server" /></td>
                        </tr>
                     </table>      
         </div> 
```

登录控制

```
<asp:LoginView ID="LoginView1" runat="server">
        <AnonymousTemplate>
           <asp:Login ID="Login" runat="server" Width="100%" FailureAction="RedirectToLoginPage" meta:resourcekey="LoginResource1">
              <LayoutTemplate>
                 <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tr>
                       <td width="60px"><asp:Label runat="server" ID="lblUserName" AssociatedControlID="UserName" Text="Username:" meta:resourcekey="lblUserNameResource1" /></td>
                       <td><asp:TextBox id="UserName" runat="server" Width="95%" meta:resourcekey="UserNameResource2" /></td>
                       <td width="5px" align="right">
                          <asp:RequiredFieldValidator ID="valRequireUserName" runat="server" SetFocusOnError="True"
                             ControlToValidate="UserName" Text="*" ValidationGroup="Login" meta:resourcekey="valRequireUserNameResource1" />
                       </td>
                    </tr>
                    <tr>
                       <td style="height: 24px"><asp:Label runat="server" ID="lblPassword" AssociatedControlID="Password" Text="Password:" meta:resourcekey="lblPasswordResource1" /></td>
                       <td style="height: 24px"><asp:TextBox ID="Password" runat="server" TextMode="Password"  Width="95%" meta:resourcekey="PasswordResource2" /></td>
                       <td width="5px" align="right" style="height: 24px">
                          <asp:RequiredFieldValidator ID="valRequirePassword" runat="server" SetFocusOnError="True"
                             ControlToValidate="Password" Text="*" ValidationGroup="Login" meta:resourcekey="valRequirePasswordResource1" />
                       </td>
                    </tr>
                 </table>
                 <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tr>
                       <td><asp:CheckBox ID="RememberMe" runat="server" Text="Remember me" meta:resourcekey="RememberMeResource1"></asp:CheckBox></td>
                       <td align="right">
                          <asp:ImageButton ID="Submit" runat="server" AlternateText="Login"
                             CommandName="Login" ImageUrl="~/images/go.gif" ValidationGroup="Login" meta:resourcekey="SubmitResource1" />
                       </td>
                       <td width="5px" align="right">&nbsp;</td>
                    </tr>
                 </table>
                 <div style="border-top: solid 1px black; margin-top: 2px; padding-top: 2px">
                    <br />
                    <asp:HyperLink ID="lnkRegister" runat="server" NavigateUrl="~/Register.aspx" meta:resourcekey="lnkRegisterResource1" ForeColor="#104A9D" Text="Create new account"></asp:HyperLink><br />
                    <asp:HyperLink ID="lnkPasswordRecovery" runat="server" NavigateUrl="~/PasswordRecovery.aspx" meta:resourcekey="lnkPasswordRecoveryResource1" ForeColor="#104A9D" Text="I forgot my password"></asp:HyperLink>
                 </div>
              </LayoutTemplate>
           </asp:Login>
        </AnonymousTemplate>
        <LoggedInTemplate>
           <div id="welcomebox">
              <asp:LoginName ID="LoginName1" runat="server" FormatString="Hello {0}" meta:resourcekey="LoginName1Resource1" /><br />
              <small>
              <asp:HyperLink ID="lnkProfile" runat="server" Text="Edit Profile" NavigateUrl="~/EditProfile.aspx" meta:resourcekey="lnkProfileResource1" /><br /> 
              <asp:LoginStatus ID="LoginStatus1" Runat="server" meta:resourcekey="LoginStatus1Resource1" />
              </small>
           </div>
        </LoggedInTemplate>
     </asp:LoginView> 
```

如果用户在搜索文本框中输入文本并单击搜索按钮，则搜索工作正常。但是，如果用户在搜索文本框中输入文本并点击 Enter 按钮，则会触发 Login 控件的验证。我想避免这种情况，因为用户只想搜索。

当用户在搜索文本框中点击输入时，如何防止验证触发。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T16:42:24.530

您需要阅读有关[ValidationGroups](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.validationgroup.aspx)的信息。您可能还想更改默认按钮[链接文本](http://msdn.microsoft.com/en-us/library/system.web.ui.htmlcontrols.htmlform.defaultbutton(VS.80).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-30T04:59:53.860

直到我理解您的问题...我想...如果您只想在输入设置搜索按钮作为默认按钮进行搜索，同时您希望它可以正常工作并且不对登录文本框进行验证，然后设置属性搜索按钮 CauseValidation=false。如果这是您的错误，那么可以正常工作，否则您会详细描述您的问题

# java - 文本到图片信息的转换？

> ID：901867
> 
> 赞同：1
> 
> 时间：2009-05-23T16:32:12.980
> 
> 标签：java, text, smpp

朋友们，我想知道如何**将文本转换为JAVA中的图片消息（.ota）格式**以便通过手机发送？我正在开发一个软件，通过串口将图片信息发送到另一台手机。

任何人都可以帮助创建转换过程的例程吗？我需要该例程将给定的文本/图片转换为 .ota 格式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-01T23:41:21.240

阅读有关文件格式的[文章](http://en.wikipedia.org/wiki/OTA_bitmap)后，我会说这听起来并不那么复杂。基本步骤已经大致列出，可以在一小时内实施。猜猜你现在已经做到了吗？

（如果是这样，介意分享解决问题的代码吗？；）不需要超过几百行，对吧？）

# linq - 无法将 GridView 绑定到 LINQ to SQL 结果

> ID：901877
> 
> 赞同：2
> 
> 时间：2009-05-23T16:36:36.143
> 
> 标签：linq, linq-to-sql

好的，我确实是 LINQ 的新手，并且在上周阅读了我所能阅读的所有内容。我只是在玩，试图遵循我找到的一些示例（实际上是 Scott Gu 关于该主题的 PDF），我完全不知所措。有人可以告诉我为什么，当我使用下面的代码将 GridView 绑定到下面的查询时，我没有得到任何数据？我可以在调试时看到结果，所以我知道它们是从数据库中返回的，只是它们显然没有正确绑定。我读到一些内容说您无法直接绑定到结果，并且您必须使用 BindingSource 作为中间步骤？

有人，请告诉我我在这里缺少什么。

```
protected void Page_Load(object sender, EventArgs e)
{
    SwapDBDataContext db = new SwapDBDataContext();

    var users = from u in db.aspnet_Users
                select new
                {
                   Name =  u.UserName,
                   ID = u.UserId
                };

    GridView1.DataSource = users;
    GridView1.DataBind();

} 
```

我只是使用一个空的 GridView。我曾假设绑定会负责设置列以匹配查询的结果列 - 这是一个愚蠢的初学者错误吗？

```
 <asp:GridView ID="GridView1" runat="server">
    </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T17:05:58.687

无法理解为什么这不应该工作。我使用（几乎）您的代码拼凑了一个页面。它非常适合我。

```
protected void Page_Load(object sender, EventArgs e)
{
    BlodsockerkollenDataContext db = new BlodsockerkollenDataContext();
    var members = from m in db.Members
                  select new { Id = m.Id, Email = m.Email };

    GridView1.DataSource = members;
    GridView1.DataBind();
} 
```

我不同意建议的答案，说明您应该使用 ToList()。GridView 能够获取和遍历 IEnumerable，而 IQueryable 继承了 IEnumerable。

不，应该不需要声明 BindingSource。

也许你已经在你的 GridView 中声明了一些东西？我的只是空的，直接从工具箱中拉出来：

```
<asp:GridView ID="GridView1" runat="server">
</asp:GridView> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T17:08:31.490

您不必转换为列表或数组。绑定至少需要一个 IEnumerable<T>，这就是您的 Users 变量。匿名类型只是编译器生成的具体类型的预编译占位符，因此您还应该能够绑定到匿名类型。

您的 GridView 可能没有设置 AutoGeneratedColumns 属性，这是让数据源定义出现的列所必需的。尝试启用它，并查看您的 GridView 是否显示您的查询结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-18T04:01:02.947

```
protected void Page_Load(object sender, EventArgs e)   
{   
   SwapDBDataContext db = new SwapDBDataContext();   

   GridView1.DataSource = from u in db.aspnet_Users   
            select new   
            {   
               Name =  u.UserName,   
               ID = u.UserId   
            };   

  GridView1.DataBind();   
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T16:44:16.367

尝试做

```
GridView1.DataSource = users.ToList(); 
```

或者

```
GridView1.DataSource = users.ToArray(); 
```

由于延迟执行，查询可能根本没有执行。

# ruby-on-rails - ruby on rails x 字符集

> ID：901884
> 
> 赞同：1
> 
> 时间：2009-05-23T16:38:18.997
> 
> 标签：ruby-on-rails, ruby, character-encoding

我在处理 ruby​​ on rails 应用程序中的字符集时遇到问题，特别是在我的模板中。来自我的数据库的代码可以正常工作，但是位于我的视图中的 ç ~ 之类的代码无法正常工作。我将以下代码添加到我的代码中

我添加了一个类似的函数，但仍然无法正常工作我的 application.rhtml 中有 ç ~ 代码无法正常工作。

```
before_filter :configure_charsets 
 # Configuring charset to UTF-8 def configure_charsets    
 headers["Content-Type"] = "text/html; charset=UTF-8"     
end 
```

我还将 meta http-equiv html 添加到 utf-8 和一个 .htaccess 参数 AddDefaultCharset UTF-8

这仍然不起作用，还有其他提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T17:55:47.153

您用于将特殊字符放入文件（源或视图）的文本编辑器是否将这些字符视为 UTF-8？例如，如果您使用 TextMate，您可以故意将文件保存为 UTF-8。如果由于某种原因您之前使用了不同的编码（可能是默认编码），那些 UTF-8 字符可能会在代码编辑阶段被转码，所以即使渲染过程始终使用 UTF-8，它仍然不会工作。

此外，如果您使用的是来自 shell 的东西，比如 vi 或其他什么，您的终端是否设置为默认接受 UTF-8？如果您将其设置为 ISO-8859-1 或其他，您会遇到同样的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-06T09:10:00.327

将这段代码放入您的配置 ( `environment.rb`)

```
Rails::Initializer.run do |config|
  config.action_controller.default_charset = "iso-8859-1"
end 
```

这会做到的。

此外，删除默认字符集行（如果有）`layouts/application.html`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T16:43:03.390

您的`application.rhtml`文件是否以正确的字符集编写？确保它是 UTF-8，而不是 ISO-8859-1。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T04:18:56.083

因此，如果您的文件的内容是 UTF-8，并且输出被解释为 UTF-8，则介于两者之间的东西正在更改数据。可以给我们一个特殊字符的输入字节的十六进制解释（任何非 ASCII 将至少是 UTF-8 中的两个字节），以及输出字节的十六进制解释？也许我们可以弄清楚变化是什么，然后从那里开始工作。

# opengl - OpenGL中带有粒子效果的Alpha透明度

> ID：901885
> 
> 赞同：3
> 
> 时间：2009-05-23T16:38:49.107
> 
> 标签：opengl, particles

我使用 GL_POINTS 在 OpenGL 中有一个简单的粒子效果。调用以下方法，按照从最远的粒子到最接近相机的最后一个粒子的顺序传递粒子：

```
void draw_particle(particle* part) {
    /* The following is how the distance is calculated when ordering.
     * GLfloat distance = sqrt(pow(get_camera_pos_x() - part->pos_x, 2) + pow(get_camera_pos_y() - part->pos_y, 2) + pow(get_camera_pos_z() - part->pos_z, 2));
     */

    static GLfloat quadratic[] = {0.005, 0.01, 1/600.0};
    glPointParameterfvARB(GL_POINT_DISTANCE_ATTENUATION_ARB, quadratic);
    glPointSize(part->size);
    glEnable(GL_BLEND);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
    glEnable(GL_POINT_SPRITE_ARB);
    glEnable(GL_TEXTURE_2D);

    glBegin(GL_POINTS);
        glColor4f(part->r, part->g, part->b, part->a);
        glVertex3f(part->pos_x, part->pos_y, part->pos_z);
    glEnd();

    glDisable(GL_BLEND);
    glDisable(GL_POINT_SPRITE_ARB);
} 
```

但是，在渲染时会出现一些伪影，如以下效果所示：[artifacted image http://img199.imageshack.us/img199/9574/particleeffect.png](http://img199.imageshack.us/img199/9574/particleeffect.png)

如果我禁用深度测试，问题就会消失，但我需要效果能够与场景的其他元素交互，根据深度出现在相同 GL_TRIANGLE_STRIP 元素的前面和后面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T16:47:39.543

如果您的粒子已经排序，您可以像这样呈现：

*   使用 GL WRITE DEPTH 渲染粒子但没有深度测试（我不记得确切的常量）
*   使用深度测试渲染场景的其余部分。

这样，您一定会获得与漂亮粒子的场景交互。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T16:49:38.510

注意：请在发布问题时指定您使用的 OpenGL 版本。这适用于任何 API。当您想要使用 alpha 混合渲染图元时，您不能启用深度写入。您需要绘制从后到前排序的混合图元。如果场景中有不透明对象，请先渲染它们，然后以从后到前的排序方式绘制透明图元，启用深度测试并禁用深度写入。

```
glEnable(GL_DEPTH_TEST);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
glEnable(GL_POINT_SPRITE);
glEnable(GL_CULL_FACE);

while(1)
{
    ...
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glDisable(GL_BLEND);
    glDepthMask(1);
    RenderOpaque();
    SortSprites();
    glEnable(GL_BLEND);
    glDepthMask(0);
    DrawSprites();
    ...
} 
```

# python - python factory functions compared to class

> ID：901892
> 
> 赞同：19
> 
> 时间：2009-05-23T16:43:25.323
> 
> 标签：python, function

Just working through learning python and started to look at nested/factory functions (simple example):

```
def maker(N):
    def action(X):
        return X * N
    return action 
```

Are there any advantages of factory functions over creating a class? performance? memory? clean up?

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-23T17:38:58.057

What I like most about nested functions is that it is less verbose than classes. The equivalent class definition to your maker function is:

```
class clsmaker(object):
    def __init__(self, N):
        self.N = N
    def __call__(self, X):
        return X * self.N 
```

That doesn't seem so bad until you start adding more arguments to the constructor. Then doing it the class way takes an extra line for each argument, while the function just gets the extra args.

It turns out that there is a speed advantage to the nested functions as well:

```
>>> T1 = timeit.Timer('maker(3)(4)', 'from __main__ import maker')
>>> T1.timeit()
1.2818338871002197
>>> T2 = timeit.Timer('clsmaker(3)(4)', 'from __main__ import clsmaker')
>>> T2.timeit()
2.2137160301208496 
```

This may be due to there being fewer opcodes involved in the nested functions version:

```
>>> dis(clsmaker.__call__)
  5           0 LOAD_FAST                1 (X)
              3 LOAD_FAST                0 (self)
              6 LOAD_ATTR                0 (N)
              9 BINARY_MULTIPLY     
             10 RETURN_VALUE        
>>> act = maker(3)
>>> dis(act)
  3           0 LOAD_FAST                0 (X)
              3 LOAD_DEREF               0 (N)
              6 BINARY_MULTIPLY     
              7 RETURN_VALUE 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-24T00:55:57.483

Comparing a function factory to a class is comparing apples and oranges. Use a class if you have a cohesive collection of data and functions, together called an object. Use a function factory if you need a function, and want to parameterize its creation.

Your choice of the two techniques should depend on the meaning of the code.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-23T16:49:17.683

Nesting functions allows one to create custom functions on the fly.

Have a look at e.g. [decorators](http://www.python.org/dev/peps/pep-0318/). The resulting functions depend on variables that are bound at creation time and do not need to be changed afterwards. So using a class for this purpose would make *less* sense.

# c++ - 如何使用类型列表

> ID：901907
> 
> 赞同：13
> 
> 时间：2009-05-23T16:50:14.623
> 
> 标签：c++, visual-studio-2005, typelist, policy-based-design

我在“现代 C++ 设计”中阅读了类型列表，并将其理解为某种类型的联合。通过将不同的、不相关的类型放入类型列表中，可以使用它一次表示多个类型，而无需继承。我在一些具有原始类型的简单函数中测试了 typelist，但我无法让它们中的任何一个工作。

有人能告诉我我对类型列表的理解是否正确，并给出一个简单的现实世界示例如何在日常平均代码中使用类型列表吗？提前致谢。

顺便说一句，我正在使用 Windows 和 Visual Studio 2005 及其编译器。

编辑：我的例子不见了，我在 vs 中使用了一个沙箱项目来测试这些东西。但它很安静，类似于 Dobbs 教程中的代码：

```
void SomeOperation(DocumentItem* p)
{
    if (TextArea* pTextArea = dynamic_cast<TextArea*>(p))
    {
        ... operate on a TextArea object ...
    }
    else if (VectorGraphics* pVectorGraphics =
        dynamic_cast<VectorGraphics*>(p))
    {
        ... operate on a VectorGraphics object ...
    }
    else if (Bitmap* pBitmap = dynamic_cast<Bitmap*>(p))
    {
        ... operate on a Bitmap object ...
    }
    else
    {
        throw "Unknown type passed";
    }
} 
```

这行得通，但我没有看到能够做同样事情的继承的优势。动态转换不适用于原始类型。是否可以将其用作返回值，例如：

```
typedef Typelist<int, string> mylist
mylist myfunction() {
    if(foo == bar)
        return 5;

    return "five";
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-24T02:33:39.627

类型列表是类型的通用编译时集合。如果你使用dynamic_cast，你就错过了重点，因为它不应该被需要，因为它是一个静态的、编译时的概念。

> 这行得通，但我没有看到能够做同样事情的继承的优势。

你不能让任何现有的类型继承你想要的任何东西。这根本不可行，因为这种现有类型可能是内置类型或库中的类型。将类型列表视为任何合理数量的类型（而不仅仅是 2 个）的类型列表（例如在 std::pair 中）的扩展。

类型列表可用于创建将一组参数传递给函数的工具。这是一段代码，它调用 5 个参数的通用函子（现代 C++ 设计的另一个概念），参数在一个元组（又一个）中提供，类型列表定义了元组中保存的对象类型：

```
//functor is just a holder of a pointer to method and a pointer to object to call this 
//method on; (in case you are unfamiliar with a concept)
template<class R, class t0, class t1, class t2, class t3, class t4>
R call(Loki::Functor<R,LOKI_TYPELIST_5(t0, t1, t2, t3, t4
    )> func,
    Loki::Tuple<LOKI_TYPELIST_5(t0, t1, t2, t3, t4)> tuple)
{
    ///note how you access fields
    return func(Loki::Field<0>(tuple), Loki::Field<1>(tuple),
        Loki::Field<2>(tuple), Loki::Field<3>(tuple),
        Loki::Field<4>(tuple));
}

//this uses the example code
#include<iostream>
using namespace std;

int foo(ostream* c,int h,float z, string s,int g)
{
    (*c)<<h<<z<<s<<g<<endl;
    return h+1
}

int main(int argc,char**argv)
{
    Loki::Functor<int,LOKI_TYPELIST_5(ostream*, int, float, string, int)> f=foo;
    //(...)
    //pass functor f around
    //(...)
    //create a set of arguments
    Loki::Tuple<LOKI_TYPELIST_5(ostream*, int, float, string, int)> tu;
    Field<0>(tu)=&cout;
    Field<1>(tu)=5;
    Field<2>(tu)=0.9;
    Field<3>(tu)=string("blahblah");
    Field<4>(tu)=77;
    //(...)
    //pass tuple tu around, possibly save it in a data structure or make many 
    //specialized copies of it, or just create a memento of a call, such that 
    //you can make "undo" in your application; note that without the typelist 
    //you would need to create a struct type to store any set of arguments;
    //(...)
    //call functor f with the tuple tu
    call(f,tu);
} 
```

请注意，只有使用元组或仿函数等其他概念，类型列表才开始有用。此外，我已经在一个项目中体验了 Loki 大约 2 年，并且由于模板代码（很多），DEBUG 版本中的可执行文件的大小往往很大（我的记录是 35 MB 左右）。编译速度也受到了一些影响。还记得 C++0x 可能会包含一些等效机制。结论：如果没有必要，尽量不要使用类型列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T17:14:17.143

类型列表是一种将“参数列表”传递给作为编译过程的一部分“执行”的模板元程序的方式。

因此，它们可用于生成某种“联合”类型，但这只是一种可能的用途。

[对于“真实世界”的示例：我们使用类型列表作为在Comet](http://www.lambdasoft.dk/comet/)库中实现 COM 对象时自动生成“QueryInterface”方法的一种方式。

它允许您编写如下代码：

```
class Dog : public implement_qi<make_list<IAnimal, INoisy, IPersistStream> >
{
    // The implement_qi template has provided
    // an implementation of COM's QueryInterface method for us without
    // having to write an ugly ATL "message map" or use any Macros.
    ...
} 
```

在此示例中，“make_list”是用于生成“类型列表”的模板，implement_qi 模板随后可以“枚举”以[生成适当的 QueryInterface 代码](http://www.lambdasoft.dk/comet/introduction/index.htm#Excursion)。

# javascript - 使用 jquery 从链接更改 html 文本

> ID：901909
> 
> 赞同：120
> 
> 时间：2009-05-23T16:51:18.943
> 
> 标签：javascript, jquery, dom, hyperlink

这里有一个简单的问题

有没有办法改变“点击这里”的文字

```
<a id="a_tbnotesverbergen" href="#nothing">click here</a> 
```

在这个链接

理查德

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2009-05-23T17:06:26.300

您必须使用[jquery 的 text() 函数](https://api.jquery.com/text/#text-text)。它的作用是：

> **获取所有匹配元素的组合文本内容。**
> 
> 结果是一个字符串，其中包含所有匹配元素的组合文本内容。此方法适用于 HTML 和 XML 文档。不能用于输入元素。对于输入字段文本，使用 [val 属性](https://api.jquery.com/val/#val1)。

例如：

> 找到第一段中的文本（去掉 html），然后设置最后一段的 html 以显示它只是文本（粗体消失了）。
> 
> ```
> var str = $("p:first").text();
> $("p:last").html(str); 
> ```
> 
> **测试**段落。
> 
> 测试段落。

使用您的标记，您必须执行以下操作：

```
$('a#a_tbnotesverbergen').text('new text'); 
```

这将导致

```
<a id="a_tbnotesverbergen" href="#nothing">new text</a> 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2009-05-23T16:54:36.723

您正在寻找的方法是[jQuery 的 .text()](https://api.jquery.com/text/#text-text)，您可以按以下方式使用它：

```
$('#a_tbnotesverbergen').text('text here'); 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-05-23T16:53:06.180

```
$('#a_tbnotesverbergen').text('My New Link Text'); 
```

或者

```
$('#a_tbnotesverbergen').html('My New Link Text or HTML'); 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2015-06-15T09:41:15.273

您需要 J-query 库来简单地做到这一点：

```
<script src="//code.jquery.com/jquery-1.11.3.min.js"></script> 
```

首先，您需要将元素放入 div 中，如下所示：

```
<div id="divClickHere">
<a id="a_tbnotesverbergen" href="#nothing">click here</a>
</div> 
```

然后你应该写这个 J-Query 代码：

```
<script type="text/javascript">
$(document).ready(function(){
$("#a_tbnotesverbergen").click(function(){
$("#divClickHere a").text('Your new text');
});
});
</script> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-08-17T16:35:41.283

我发现这是完成工作的最简单的代码。如您所见，它非常简单。

对于原始链接文本

我用：

```
 $("#sec1").text(Sector1); 
```

在哪里

```
 Sector1 = 'my new link text'; 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-02-27T16:46:28.793

来自 W3 Schools [HTML DOM Changes](http://www.w3schools.com/js/js_htmldom_html.asp)：如果您查看第三个示例，它显示了如何更改链接中的文本，“单击此处”。例子：

```
<a id="a_tbnotesverbergen" href="#nothing">click here</a> 
```

JS：

```
var element=document.getElementById("a_tbnotesverbergen"); 
element.innerHTML="New Text"; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-11T08:06:54.423

在javascript中试试这个

```
 document.getElementById("22IdMObileFull").text ="itsClicked" 
```

# winapi - 锁定可移动驱动器？

> ID：901912
> 
> 赞同：0
> 
> 时间：2009-05-23T16:53:00.580
> 
> 标签：winapi, vb6, locking, drives

朋友们，如何在 VB6中**锁定/解锁（基于软件的）可移动磁盘/驱动器？**我需要知道为此目的是否有任何特定的**win32例程？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-14T16:37:18.527

没有使用过这个，我想说你想看看 DeviceIoControl() 的 win32 [IOCTL_STORAGE_MEDIA_REMOVAL 控制代码](http://msdn.microsoft.com/en-us/library/aa363416.aspx)参数，它 *“..启用或禁用弹出媒体的机制，对于那些拥有锁定能力的设备......”*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T00:14:57.090

打开可移动磁盘上的文件是锁定驱动器的最简单方法。这可以通过 VB6 的内部`Open`命令来完成，或者通过声明`OpenFile`API 并调用它来完成。

我想有一些方法可以锁定驱动器本身，但是锁定文件要容易得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-30T05:36:16.633

这对您来说没有多大用处，但如果可以在[那里](http://www.mjmwired.net/kernel/Documentation/ioctl/cdrom.txt#773)完成，来自 linux 内核 2.6 文档的简单证明。

同时，API 的替代方案可能是[this](http://www.shivaranjan.com/2008/09/29/lock-and-unlock-cd-or-dvd-drives-from-windows/)，这是一个可以锁定/解锁 CD 驱动器的软件。

干杯。

# active-directory - 对活动目录进行编程

> ID：901914
> 
> 赞同：1
> 
> 时间：2009-05-23T16:53:08.350
> 
> 标签：active-directory

我有一个正在运行的 asp 应用程序，但我想搜索 Active Directory。

我正在使用 vb (visual web developer 2008)

如何搜索给定用户的活动目录？

即：用户在文本框中输入登录名，点击提交。单击此用户会搜索活动目录。当发现用户信息时显示。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T16:57:29.887

您可以使用哪个版本的 .NET 框架？在 .NET 3.5 中搜索和查找 AD 中的内容变得非常容易 - 请参阅Ethan Wilanski 和 Joe Kaplan 撰写的这篇关于使用安全主体 API 的[精彩 MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx)。

如果您还没有使用 .NET 3.5，则必须使用`DirectorySearcher`该类并根据需要设置搜索过滤器。获得正确的 LDAP 过滤器可能是最大的障碍。

Robbie Allen 还有两篇关于 System.DirectoryServices 编程的精彩介绍文章： -[第 1](http://www.ondotnet.com/pub/a/dotnet/2003/07/28/activedir.html)部分 -[第 2 部分](http://www.ondotnet.com/pub/a/dotnet/2003/08/04/activedir.html)

[http://www.directoryprogramming.net](http://www.directoryprogramming.net)上有一些非常好的资源（Joe Kaplan 的网站 - 他是 Microsoft Active Directory MVP），Richard Mueller 有一些很好的参考 Excel 表，介绍了每个 ADSI 提供程序可用的属性，以及它们的含义，以及它们的 LDAP 名称如何 - 请参阅[http://www.rlmueller.net](http://www.rlmueller.net)。

马克

编辑：好的-这是 .NET 2.0 / 3.0 方法：

```
// set the search root - the AD container to search from
DirectoryEntry searchRoot = new DirectoryEntry("LDAP://dc=yourdomain,dc=com");

// create directory searcher
DirectorySearcher ds = new DirectorySearcher(searchRoot);

ds.SearchScope = SearchScope.Subtree;

// set the properties to load in the search results
// the fewer you load, the better your performance    
ds.PropertiesToLoad.Add("cn");
ds.PropertiesToLoad.Add("sn");
ds.PropertiesToLoad.Add("givenName");
ds.PropertiesToLoad.Add("mail");

// set the filter - here I'm using objectCategory since this attribute is
// single-valued and indexed --> much better than objectClass in performance
// the "anr" is the "ambiguous name resolution" property which basically
// searches for all normally interesting name properties
ds.Filter = "(&(objectCategory=person)(anr=user-name-here))";

// get the result collection
SearchResultCollection src = ds.FindAll();

// iterate over the results
foreach (SearchResult sr in src)
{
    // do whatever you need to do with the search result
    // I'm extracting the properties I specified in the PropertiesToLoad
    // mind you - a property might not be set in AD and thus would
    // be NULL here (e.g. not included in the Properties collection)
    // also, all result properties are really multi-valued, so you need
    // to do this trickery to get the first of the values returned
    string surname = string.Empty;
    if (sr.Properties.Contains("sn"))
    {
        surname = sr.Properties["sn"][0].ToString();
    }

    string givenName = string.Empty;
    if (sr.Properties.Contains("givenName"))
    {
        givenName = sr.Properties["givenName"][0].ToString();
    }

    string email = string.Empty;
    if (sr.Properties.Contains("mail"))
    {
        email = sr.Properties["mail"][0].ToString();
    }

    Console.WriteLine("Name: {0} {1} / Mail: {2}", givenName, surname, email);
 } 
```

希望这可以帮助！

马克

# haskell - Haskell中的“条件类型错误”

> ID：901918
> 
> 赞同：0
> 
> 时间：2009-05-23T16:56:08.000
> 
> 标签：haskell

我的原始代码在下面给出并且工作正常。我想添加“ind”的范围检查，并在修改后的版本中添加了一个 if 语句。当我运行它时，我得到一个“条件类型错误”，我认为这是因为输出定义 [[String]] 而不是 IO()？

有没有其他方法可以检查保存的值的范围`ind`并产生类似 "error"/"outofrange" 的输出？

**原始代码**

```
retrieve :: [Int] -> [[String]] -> [[String]]
retrieve [] dat = [[]]
retrieve ind dat = [exC ind d | d <- dat] 
```

**修改代码**

```
retrieve :: [Int] -> [[String]] -> [[String]]
retrieve [] dat = [[]]
retrieve ind dat = if ind>3
                       then putStrLn "not found"
                       else [exC ind d | d <- dat] 
```

谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T17:20:25.527

该代码实际上有两个错误。

*   你需要使用`error`，因为它有类型`String -> a`而不是`String -> IO ()`
*   您`>`申请`[Int]`和`Int`。假设您要测试`ind`长度是否最多为 3，则必须调用`length`.

例子：

```
retrieve :: [Int] -> [[String]] -> [[String]]
retrieve [] dat = [[]]
retrieve ind dat | length ind > 3 = error "not found"
                 | otherwise      = [exC ind d | d <- dat] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-23T17:04:18.457

替换`putStrLn`为`error`。这将导致您的程序完全中止（除非更高级别的东西捕获异常。）

你写的问题是你声明了一个纯类型，然后试图做 IO，这是不允许的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T17:27:19.540

如 Ganesh 的帖子中所述，您想在[纯函数](http://en.wikipedia.org/wiki/Purely_functional)中执行 IO ，这是不可能的。

`length ind > 3`表达你的程序的方式（*无论如何你都必须使用）

1 使用`error`（最佳方式）如其他帖子所示

2 使用模式守卫（ -`non exhaustive patterns`会发生异常）

3 正确实施 IO：

```
retrieve ind dat = if ind >= 3
                    then do return [exC ind d | d <- dat ] 
                    else do putStrLn "error"; return [[]] 
```

`retrieve`将有类型

```
retrieve :: [Int] -> [[String]] -> IO [[String]] 
```

4`Maybe`用于表示计算可能会失败。

```
retrieve :: [Int] -> [[String]] -> Maybe [[String]]
retrieve [] dat = [[]]
retrieve ind dat | length ind > 3 = Nothing
                 | otherwise      = Just [exC ind d | d <- dat] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-23T17:16:43.850

您可以为此使用模式防护：

```
retrieve :: [Int] -> [[String]] -> [[String]]
retrieve [] dat = [[]]
retrieve ind dat | ind <= 3 = [exC ind d | d <- dat] 
```

如果你这样离开它，你会得到一个“函数检索中的非详尽模式”。您还可以添加另一个带有自定义错误的案例：

```
retrieve _ _ = error "Out of range" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T17:20:23.187

`then`分支有类型，`IO ()`有`else`类型`[[String]]`。两个`if`分支的类型不同，没有办法给整体`if`一个不会与其中一个分支发生类型冲突的类型。

# c# - Json.net 属性：单个值或值数组

> ID：901919
> 
> 赞同：3
> 
> 时间：2009-05-23T16:56:31.043
> 
> 标签：c#, json.net

我对 JSON.Net 库有疑问。通常我有一个这样的 XML 字符串：

```
<Config>
  ....
  <Name>some name</Name>
  ....
</Config> 
```

然后我使用 JSON.Net 库将字符串转换为 json 字符串，如下所示：

```
Congif: {
   ...
   Name: "some name",
   ...
} 
```

最后，我将此 json 字符串映射到 Config 类的实例：

```
Config instance = JsonConvert.DeserializeObject<Config>(json); 
```

如果 name 属性是我的 Config 类中的名称数组：

```
class Config {
   ....
   public string[] Name { get; set; }
   ....
} 
```

我知道在 json 字符串中，数组的定义如下：

```
 Name: ["some name"], 
```

由于我得到了一个从 XMl 字符串转换而来的 json 字符串，因此我可能在那里有一个或多个 Name 节点。当 XML 中只定义一个名称时，这会给我带来麻烦。我会收到异常抱怨它无法将字符串转换为字符串 []。如果在 XML 文件中定义了多个 Name 节点，则可以。

不确定是否有任何方法或选项可以让 JSON 库在映射看到目标属性时自动将其转换为字符串数组，即使名称只有一个值，名称也是数组类型属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T22:43:06.177

我想我必须接受JSON.Net方式的方式。如果 jsonString 包含键的字符串值，那么它应该将该值转换为字符串值而不是字符串数组，即使映射属性是数组类型。

如果 XML 字符串中只有一个节点，我可以做的是向 XML 字符串添加一个空值节点，使其类似于节点数组，或者无论如何都向所有现有节点添加空值节点。

唯一的问题是在数组中附加了一个空条目。

# performance - 使用MVC设计模式（模型视图控制器）的优缺点

> ID：901920
> 
> 赞同：1
> 
> 时间：2009-05-23T16:56:33.100
> 
> 标签：performance, model-view-controller

在我的设计中，出于性能原因，我正在考虑放弃 MVC 设计，不确定直接包含页眉/页脚的 PHP 页面是否会执行我的 MVC 设置（使用 PHP/Zend）。我有种感觉。

评论？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T17:07:38.513

你的时间有什么价值？你的生产力？你的代码的可维护性？

对比

增加一台服务器的成本是多少？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T17:09:46.497

这取决于你正在构建什么。MVC 在某些事情上肯定是矫枉过正，甚至不适用于其他事情。权衡未来的维护、与其他开发人员合作、您将自己重写多少 MVC 设计模式等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T17:12:09.770

[本文](http://www.artima.com/articles/dci_vision.html)讨论了 MVC 及其发明者的新范式 DCI，该范式有可能成为传统 OO 的挑战者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T17:14:53.960

我从最初的 Smalltalk-80 上下文中熟悉 MVC。是否使用 MVC 或其他东西的决定是关于代码的清晰度，而不是性能。如果 MVC 在 PHP 中的性能存在特殊问题，我不知道。

但同样，转向 MVC 的主要原因是关注点分离是确保软件随时间可支持和可维护的重要价值。

# c# - ObservableCollection 和 Item PropertyChanged

> ID：901921
> 
> 赞同：56
> 
> 时间：2009-05-23T16:57:17.547
> 
> 标签：c#, observablecollection

我已经看到很多关于这个问题的讨论，但也许我只是一个新手，无法理解。如果我有一个可观察的集合，它是 msdn 示例中的“PersonNames”集合（[http://msdn.microsoft.com/en-us/library/ms748365.aspx](http://msdn.microsoft.com/en-us/library/ms748365.aspx)`PersonName` ），如果 a是，我会更新我的视图添加或删除等。当我更改属性时，我想更新我的视图`PersonName`。就像我改变名字一样。我可以`OnPropertyChanged`为每个属性实现并让这个类派生自`INotifyPropertyChanged`，并且似乎按预期调用。

我的问题是，*视图如何从 中获取更新的数据，`ObservableCollection`因为属性更改不会导致任何事件`ObservableCollection`？*

这可能是一件非常简单的事情，但为什么我似乎找不到一个例子让我感到惊讶。任何人都可以为我阐明这一点或对示例有任何指示，我将不胜感激。我们当前的 WPF 应用程序中的多个地方都有这种情况，并且正在努力解决这个问题。

* * *

“通常，负责显示数据的代码会为`PropertyChanged`当前显示在屏幕上的每个对象添加一个事件处理程序。”

有人可以给我一个例子来说明这意味着什么吗？我的视图绑定到我的`ViewModel`哪个有`ObservableCollection`. 此集合由`RowViewModel`具有支持`PropertiesChanged`事件的属性的 组成。但我不知道如何让集合更新本身，所以我的视图将被更新。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2010-08-13T15:54:24.380

以下是您将如何附加/分离到每个项目的 PropertyChanged 事件。

```
ObservableCollection<INotifyPropertyChanged> items = new ObservableCollection<INotifyPropertyChanged>();
items.CollectionChanged += items_CollectionChanged;

static void items_CollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
{
    if (e.OldItems != null)
    {
        foreach (INotifyPropertyChanged item in e.OldItems)
            item.PropertyChanged -= item_PropertyChanged;
    }
    if (e.NewItems != null)
    {
        foreach (INotifyPropertyChanged item in e.NewItems)
            item.PropertyChanged += item_PropertyChanged;
    }
}

static void item_PropertyChanged(object sender, PropertyChangedEventArgs e)
{
    throw new NotImplementedException();
} 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-11-12T20:58:07.433

我们在 WPF 聊天中写道：

```
public class OcPropertyChangedListener<T> : INotifyPropertyChanged where T : INotifyPropertyChanged
{
    private readonly ObservableCollection<T> _collection;
    private readonly string _propertyName;
    private readonly Dictionary<T, int> _items = new Dictionary<T, int>(new ObjectIdentityComparer());
    public OcPropertyChangedListener(ObservableCollection<T> collection, string propertyName = "")
    {
        _collection = collection;
        _propertyName = propertyName ?? "";
        AddRange(collection);
        CollectionChangedEventManager.AddHandler(collection, CollectionChanged);
    }

    private void CollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
    {
        switch (e.Action)
        {
            case NotifyCollectionChangedAction.Add:
                AddRange(e.NewItems.Cast<T>());
                break;
            case NotifyCollectionChangedAction.Remove:
                RemoveRange(e.OldItems.Cast<T>());
                break;
            case NotifyCollectionChangedAction.Replace:
                AddRange(e.NewItems.Cast<T>());
                RemoveRange(e.OldItems.Cast<T>());
                break;
            case NotifyCollectionChangedAction.Move:
                break;
            case NotifyCollectionChangedAction.Reset:
                Reset();
                break;
            default:
                throw new ArgumentOutOfRangeException();
        }

    }

    private void AddRange(IEnumerable<T> newItems)
    {
        foreach (T item in newItems)
        {
            if (_items.ContainsKey(item))
            {
                _items[item]++;
            }
            else
            {
                _items.Add(item, 1);
                PropertyChangedEventManager.AddHandler(item, ChildPropertyChanged, _propertyName);
            }
        }
    }

    private void RemoveRange(IEnumerable<T> oldItems)
    {
        foreach (T item in oldItems)
        {
            _items[item]--;
            if (_items[item] == 0)
            {
                _items.Remove(item);
                PropertyChangedEventManager.RemoveHandler(item, ChildPropertyChanged, _propertyName);
            }
        }
    }

    private void Reset()
    {
        foreach (T item in _items.Keys.ToList())
        {
            PropertyChangedEventManager.RemoveHandler(item, ChildPropertyChanged, _propertyName);
            _items.Remove(item);
        }
        AddRange(_collection);
    }

    public event PropertyChangedEventHandler PropertyChanged;

    protected virtual void ChildPropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
            handler(sender, e);
    }

    private class ObjectIdentityComparer : IEqualityComparer<T>
    {
        public bool Equals(T x, T y)
        {
            return object.ReferenceEquals(x, y);
        }
        public int GetHashCode(T obj)
        {
            return System.Runtime.CompilerServices.RuntimeHelpers.GetHashCode(obj);
        }
    }
}

public static class OcPropertyChangedListener
{
    public static OcPropertyChangedListener<T> Create<T>(ObservableCollection<T> collection, string propertyName = "") where T : INotifyPropertyChanged
    {
        return new OcPropertyChangedListener<T>(collection, propertyName);
    }
} 
```

*   弱事件
*   跟踪多次添加到集合中的相同项目
*   它~冒泡~了孩子们的财产改变事件。
*   静态类只是为了方便。

像这样使用它：

```
var listener = OcPropertyChangedListener.Create(yourCollection);
listener.PropertyChanged += (sender, args) => { //do you stuff} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-06-17T18:44:56.073

账单，

我确信您现在已经找到了解决您的问题的解决方法或解决方案，但我为遇到此常见问题的任何人发布了此内容。您可以用此类替换 ObservableCollections，这些 ObservableCollections 是实现 INotifyPropertyChanged 的​​对象的集合。这有点苛刻，因为它表示列表需要重置而不是找到已更改的一个属性/项目，但对于小型列表，性能影响应该是不明显的。

马克

```
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Collections.Specialized;
using System.ComponentModel;

namespace WCIOPublishing.Helpers
{
    public class ObservableCollectionWithItemNotify<T> : ObservableCollection<T> where T: INotifyPropertyChanged 
    {

        public ObservableCollectionWithItemNotify()
        {
            this.CollectionChanged += items_CollectionChanged;
        }

        public ObservableCollectionWithItemNotify(IEnumerable<T> collection) :base( collection)
        {
            this.CollectionChanged += items_CollectionChanged;
            foreach (INotifyPropertyChanged item in collection)
                item.PropertyChanged += item_PropertyChanged;

        }

        private void items_CollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
        {
            if(e != null)
            {
                if(e.OldItems!=null)
                    foreach (INotifyPropertyChanged item in e.OldItems)
                        item.PropertyChanged -= item_PropertyChanged;

                if(e.NewItems!=null)
                    foreach (INotifyPropertyChanged item in e.NewItems)
                        item.PropertyChanged += item_PropertyChanged;
            }
        }

        private void item_PropertyChanged(object sender, PropertyChangedEventArgs e)
        {
            var reset = new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Reset);
            this.OnCollectionChanged(reset);

        }

    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-23T17:54:04.567

正如您所发现的，没有集合级别的事件表明集合中某个项目的属性已更改。通常，负责显示数据的代码会为当前显示在屏幕上的*每个对象添加一个 PropertyChanged 事件处理程序。*

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-12-21T18:14:24.700

而不是 ObservableCollection 只需使用[BindingList<T>](https://msdn.microsoft.com/en-us/library/ms132679(v=vs.110).aspx)。
以下代码显示了与 List 和项的属性的 DataGrid 绑定。

```
<Window x:Class="WpfApplication1.MainWindow"
                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    Title="MainWindow" Height="350" Width="525">
    <DataGrid ItemsSource="{Binding}" AutoGenerateColumns="False" >
        <DataGrid.Columns>
            <DataGridTextColumn Header="Values" Binding="{Binding Value}" />
        </DataGrid.Columns>
    </DataGrid>
</Window> 
```

* * *

```
using System;
using System.ComponentModel;
using System.Windows;
using System.Windows.Threading;

namespace WpfApplication1 {
    public partial class MainWindow : Window {
        public MainWindow() {
            var c = new BindingList<Data>();
            this.DataContext = c;
            // add new item to list on each timer tick
            var t = new DispatcherTimer() { Interval = TimeSpan.FromSeconds(1) };
            t.Tick += (s, e) => {
                if (c.Count >= 10) t.Stop();
                c.Add(new Data());
            };
            t.Start();
        }
    }

    public class Data : INotifyPropertyChanged {
        public event PropertyChangedEventHandler PropertyChanged = delegate { };
        System.Timers.Timer t;
        static Random r = new Random();
        public Data() {
            // update value on each timer tick
            t = new System.Timers.Timer() { Interval = r.Next(500, 1000) };
            t.Elapsed += (s, e) => {
                Value = DateTime.Now.Ticks;
                this.PropertyChanged(this, new PropertyChangedEventArgs("Value"));
            };
            t.Start();
        }
        public long Value { get; private set; }
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-04-14T08:50:15.720

以下代码给出了[@Stack](https://stackoverflow.com/a/34401912/1437877)对答案的简单解释，并显示了如何`BindingList`观察它是否有项目更改，并且显示`ObservableCollection`不会观察项目内部的变化。

```
using System;
using System.Collections.ObjectModel;
using System.ComponentModel;

namespace BindingListExample
{
    class Program
    {
        public ObservableCollection<MyStruct> oc = new ObservableCollection<MyStruct>();
        public System.ComponentModel.BindingList<MyStruct> bl = new BindingList<MyStruct>();

        public Program()
        {
            oc.Add(new MyStruct());
            oc.CollectionChanged += CollectionChanged;

            bl.Add(new MyStruct());
            bl.ListChanged += ListChanged;
        }

        void ListChanged(object sender, ListChangedEventArgs e)
        {
            //Observe when the IsActive value is changed this event is triggered.
            Console.WriteLine(e.ListChangedType.ToString());
        }

        void CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
        {
            //Observe when the IsActive value is changed this event is not triggered.
            Console.WriteLine(e.Action.ToString());
        }

        static void Main(string[] args)
        {
            Program pm = new Program();
            pm.bl[0].IsActive = false;
        }
    }

    public class MyStruct : INotifyPropertyChanged
    {
        public event PropertyChangedEventHandler PropertyChanged;
        private bool isactive;
        public bool IsActive
        {
            get { return isactive; }
            set
            {
                isactive = value;
                NotifyPropertyChanged("IsActive");
            }
        }

        private void NotifyPropertyChanged(String PropertyName)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(PropertyName));
            }
        }
    }
} 
```

# asp.net - 是否有允许使用数据绑定语法的非迭代控件？

> ID：901927
> 
> 赞同：0
> 
> 时间：2009-05-23T17:02:49.003
> 
> 标签：asp.net, data-binding, controls

假设我的代码隐藏中有一个 XML 内容节点。我需要从各个节点中获取一些数据并放到 Web 表单上。

传统上，我会在页面上创建一堆文字，然后在代码隐藏中执行以下操作：

```
MyLiteral.Text = myXmlNode.SelectSingleNode("/some/xpath").InnerText; 
```

这很好，但考虑一下我们在中继器中使用的绑定语法：

```
<ItemTemplate>
    <p>
        <%# XPath("/some/xpath") %>
    </p>
</ItemTemplate> 
```

所以，我想知道您是否可以在非中继器情况下使用相同的语法。在非迭代情况下没有相同的语法似乎很奇怪。

（当然，如果你不介意变得可笑，你可以将你的 XML 节点绑定到一个中继器，它只会有一次迭代。我*发誓*我从来没有这样做过......）

我不禁想到框架的设计者会为此做好计划。是否有一些我不知道的非迭代控件允许您绑定数据源并使用数据绑定表达式呈现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T17:48:25.967

正如您已经发现的那样，[数据绑定](http://msdn.microsoft.com/en-us/library/ms228214.aspx)语法仅适用于复合控件，例如中继器、列表视图、详细信息视图等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T17:34:47.610

我能想到的最好的建议是使用 DetailsView 或 FormView 之类的东西。这至少可以摆脱“非重复”数据的问题。

# speech-recognition - “语音触发”检测

> ID：901928
> 
> 赞同：4
> 
> 时间：2009-05-23T17:03:20.017
> 
> 标签：speech-recognition, signal-processing, voice, voice-recording

我有一个语音应用程序，如果能够使用“触发词”开始录制音频，它将会大大改进。我不需要完整的语音文本引擎，只需要可靠/有效地检测触发词的能力。

我想知道是否有任何专门的语音引擎支持这个特定的用例，或者有任何库/方法来开发这种单一用途的检测引擎。理想情况下，我希望它可以在嘈杂的环境中工作，但可以针对单个用户的声音进行训练。

指向研究论文/主题的指针也将不胜感激，所以我知道要问什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-09-05T19:27:47.477

我在 Red5 项目中的一位同事创建了一个类似的演示，使用触发词来对图像存储库运行搜索。说“猫”会使猫的图像在大约一秒钟内出现。客户端应用程序是用 Flash 编写的，后端使用免费的 Sphinx 库在 Red5 上运行。你当然可以毫不费力地用 Sphinx 做你想做的事。
狮身人面像项目：[http ://cmusphinx.sourceforge.net/sphinx4/](http://cmusphinx.sourceforge.net/sphinx4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T17:20:52.267

好的，我可能会完全关闭，但是使用功能齐全的语音识别库可能对您的用例来说太过分了..

如果您可以使用更简单但仍受音频驱动的东西，请考虑以下内容：

检测拍手非常简单。拍手将在整个音频频带上产生高能量。检测它比完整的语音识别简单且计算成本低得多。

简而言之，您录制音频，对数据进行（短时间）FFT，并检测您在 80% 的可用频率区间中具有高能量的情况。由于简单的录音室/麦克风设置，80% 可以解决任何相位问题。然后根据口味调整阈值，就完成了。

对语音识别做同样的事情也是可能的，但是你会消耗*大量*的 CPU 周期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T17:21:09.490

什么操作系统？例如，我想知道[Windows Vista 中的语音功能](http://en.wikipedia.org/wiki/Speech_Application_Programming_Interface#Speech_functionality_in_Windows_Vista)是否会对您有所帮助。对于任何语音分析器来说，识别一个单词似乎是最简单的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-05T00:11:57.983

我有一个录音win32应用程序。我使用 OCX 来管理录制/播放。

我知道这不完全是您要求的解决方案，但您可能需要考虑使用脚踏板。它的编程很简单，并且非常像一个口语来开始/停止录音。检查这些： www.pedalpower.com

希望能帮助到你，

雷纳尔多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T21:54:29.317

就在几天前，有人问[了一个关于 linux 上语音识别可能性的问题。](https://stackoverflow.com/questions/877508/need-text-to-speech-and-speech-recognition-tools-for-linux/)您要求的是其中的一个子集，我认为其中一些答案可能包含有用的信息。joeforker 的答案中链接的文章非常有趣。

# sql-server - 触发器修改不同表上的多行，然后在 SQL Server 2005 中调用它

> ID：901931
> 
> 赞同：0
> 
> 时间：2009-05-23T17:04:48.347
> 
> 标签：sql-server, tsql, triggers

我试图对由其他表上的更新触发的表执行更新，但收到错误消息：

更新或删除的行值要么不使行唯一，要么改变多行。

例如我有这个表：

```
table_1
===========
int id   (primary_key,identity)
nchar(10)  state_name

table_2
===========
int number 
```

在更新 table_2 之后，我想将列“state_name”中的所有值更改为“false”

```
create trigger tr on table_2
after update
as
update table_1 set state_name = 'false' 
```

当我尝试更新 table_2 时，我收到错误消息。有没有办法绕过这个限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T17:23:47.020

在 Table_2 中添加一个主键约束（例如 auto inc no）就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T17:25:08.157

创建表 table_1(id int identity(1,1) 主键，state_name char(10))

创建表 table_2 ( number int) 去

更新后在 table_2 上创建触发器 tr as update table_1 set state_name = 'false' go

插入表_1选择“真”插入表_2选择1

去

更新 table_2 集数 = 2

从 table_1 中选择 *

从 table_2 中选择 *

您使用哪个版本？它在 SQL 2K8 和 SQL 2K5 中运行良好。再次检查您的代码。

# vb.net - Ms-Access：加入 3 个表

> ID：901935
> 
> 赞同：2
> 
> 时间：2009-05-23T17:05:59.733
> 
> 标签：vb.net, ms-access

有没有人有一个如何加入 3 个表的示例，我有以下语句，但我缺少一个（语法错误“操作员错误”）

```
da = New OleDbDataAdapter("SELECT [S].[Scheduled Vege], [V].[Description], 
        [DS].[Task], [DS].[Task Date], [DS].[Completed] FROM [Scheduled] AS S 
        INNER JOIN [Date Schedules] AS DS ON [S].[SchedID] = [DS].[SchedID] 
        INNER JOIN [Vegetables Descriptions] AS V ON [V].[Task] = [DS].[Task] 
        WHERE [DS].[TaskNumber] >= " & aFromDate & " AND [DS].[TaskNumber] <= " & aToDate & " 
        AND [DS].[Completed] = '" & aCompleted & "' ", conn) 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T07:26:29.387

发现了问题，因为它是一个访问数据库，所以第一个 from 语句和 INNER JOIN 需要放在括号中，如下所示。

```
da = New OleDbDataAdapter("SELECT [S].[Scheduled Vege], [V].[Description], 
[DS].[Task], [DS].[Task Date], [DS].[Completed] FROM ([Scheduled] AS S 
INNER JOIN [Date Schedules] AS DS ON [S].[SchedID] = [DS].[SchedID]) 
INNER JOIN [Vegetables Descriptions] AS V ON [V].[Task] = [DS].[Task] 
WHERE [DS].[TaskNumber] >= " & aFromDate & " AND [DS].[TaskNumber] <= " & aToDate & " 
AND [DS].[Completed] = '" & aCompleted & "' ", conn) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T17:11:26.120

如果您删除 WHERE 子句，您的查询是否会执行？唯一立即让我大吃一惊的是，您的日期不一定采用 OleDB 提供商会喜欢的格式。

我的猜测是您需要封装您的日期，例如“2009 年 1 月 1 日”或类似的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T17:13:16.897

您的加入看起来不错，但我认为您的问题可能在于您将 ' `TaskNumber`' 与 ' `aFromDate`' 进行比较；数字和日期在 SQL 中是不同的类型，尝试像这样比较它们会导致问题。

# ruby-on-rails - 如何使用 ActiveRecord 和 Rails 获得一个急切加载的条件，以便稍后延迟加载

> ID：901938
> 
> 赞同：1
> 
> 时间：2009-05-23T17:07:08.390
> 
> 标签：ruby-on-rails, ruby, activerecord, lazy-loading, eager-loading

首先让我展示一些代码。

```
class User
  has_and_belongs_to_many :roles
  named_scope :employees, { :conditions => ["roles.name = 'Employee'"], :include => :roles }
end 
```

好的，所以稍后在控制器中我想搜索所有员工。我设置了命名范围以帮助通过连接和条件搜索来做到这一点。但问题出在我想显示所有用户角色的视图中，但它只会显示员工角色。

无论如何我可以说“user.roles”并在我已经迫不及待地加载它之后将它延迟加载到视图中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T18:47:23.060

[`habtm`](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#M001792)（以及）的文档`has_many`声明您可以使用可选参数访问集合：

> 集合（force_reload = false）
> 
> 返回所有关联对象的数组。如果没有找到，则返回一个空数组。

您可以使用 重新加载角色`user.roles(true)`。

# java - 在对象中实现二分查找

> ID：901944
> 
> 赞同：24
> 
> 时间：2009-05-23T17:10:28.943
> 
> 标签：java, search, collections, binary-search

有没有办法在带有对象的 ArrayList 中实现二进制搜索？在此示例中，ArrayList 将使用字段“id”进行排序。

```
class User{
 public int id;
 public string name;
}

ArrayList<User> users = new ArrayList<User>();

sortById(users);

int id = 66
User searchuser = getUserById(users,id); 
```

如果我应该使用二进制搜索返回具有指定 id 的用户，“User getUserById(ArrayList users, int userid)”会是什么样子？这甚至可能吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-05-23T17:15:45.817

The Java Tutorials 的[Object Ordering](http://java.sun.com/docs/books/tutorial/collections/interfaces/order.html)文章有一个编写自己的示例[`Comparator`](http://java.sun.com/javase/6/docs/api/java/util/Comparator.html)以便对自定义类型进行比较。

然后，`ArrayList`（或任何其他`List`）要查找的键`Comparator`可以传递到[`Collections.binarySearch`](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#binarySearch(java.util.List,%20T,%20java.util.Comparator))方法中。

这是一个例子：

```
import java.util.*;

class BinarySearchWithComparator
{
  public static void main(String[] args)
  {
    // Please scroll down to see 'User' class implementation.
    List<User> l = new ArrayList<User>();
    l.add(new User(10, "A"));
    l.add(new User(20, "B"));
    l.add(new User(30, "C"));

    Comparator<User> c = new Comparator<User>() {
      public int compare(User u1, User u2) {
        return u1.getId().compareTo(u2.getId());
      }
    };

    // Must pass in an object of type 'User' as the key.
    // The key is an 'User' with the 'id' which is been searched for.
    // The 'name' field is not used in the comparison for the binary search,
    // so it can be a dummy value -- here it is omitted with a null.
    //
    // Also note that the List must be sorted before running binarySearch,
    // in this case, the list is already sorted.

    int index = Collections.binarySearch(l, new User(20, null), c);
    System.out.println(index);    // Output: 1

    index = Collections.binarySearch(l, new User(10, null), c);
    System.out.println(index);    // Output: 0

    index = Collections.binarySearch(l, new User(42, null), c);
    System.out.println(index);    // Output: -4
                                  // See javadoc for meaning of return value.
  }
}

class User {
  private int id;
  private String name;

  public User(int id, String name) {
    this.id = id;
    this.name = name;
  }

  public Integer getId() {
    return Integer.valueOf(id);
  }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-18T10:02:20.513

您还可以将比较器放在 User 类中：

```
public class User implements Comparable<User>, Comparator<User>
{
  public User(int id, String name)
  {
    this.id = id;
    this.name = name;
  }
  @Override
  public int compareTo(User u)
  {
    return id - u.getID();
  }
  @Override
  public int compare(User u1, User u2)
  {
    return u1.getID() - u2.getID();
  }

  public int getID() { return id; }
  public String getName() { return name; }
  private int id;
  private String name;
} 
```

然后，您将对名为 users 的 ArrayList 执行以下操作：

```
ArrayList<User> users = new ArrayList<User>();
users.add(new User(3, "Fred"));
users.add(new User(42, "Joe"));
users.add(new User(5, "Mary"));
users.add(new User(17, "Alice"));

Collections.sort(users);
int index = Collections.binarySearch(users, new User(5, null));
if(index >= 0)
  System.out.println("The user name of id 5 is: "+users.get(index).getName());
else
  System.out.println("ID 5 is not in the list"); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-23T17:13:19.877

`Collections.binarySearch`与`Comparator`. _

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-23T17:14:33.883

```
import java.util.Collections;
Collections.binarySearch(users, id); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-16T21:34:45.253

您应该只对已排序的 ArrayList 使用 binarySearch 方法。所以首先对 ArraList 进行排序并使用相同的比较器引用（用于进行排序）来执行 binarySearch 操作。

# ajax - AJAX 风格应用程序中的 XSRF 保护

> ID：901946
> 
> 赞同：7
> 
> 时间：2009-05-23T17:11:09.613
> 
> 标签：ajax, security, oauth, csrf

我们目前正在开发一个完全基于 AJAX 的应用程序，它将通过 RESTful API 与服务器交互。我已经考虑了防止针对 API 的 XSRF 攻击的潜在方案。

1.  用户进行身份验证并接收一个会话 cookie，该 cookie 也会随每个请求一起双重提交。

2.  我们在 Javascript 中实现 OAuth 消费者，在用户登录时检索令牌，并使用该令牌签署所有请求。

我倾向于 OAuth 方法，主要是因为我想提供对我们 API 的第 3 方访问，并且我宁愿不必实现两个身份验证方案。

在这种情况下 OAuth 消费者是否有任何理由无法工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-09-09T19:30:01.227

大多数 AJAX 库会设置一个额外的标头“X-Requested-With: XMLHttpRequest”，这在基本的 XSRF 攻击中很难伪造（尽管如果与 XSS 结合使用可能）。如果您希望所有请求都是 AJAX，那么验证此标头是否存在是一个很好的纵深防御策略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-10T07:59:47.860

使用两步请求，第一个请求服务器一个不可预测的令牌，第二个请求带有令牌的实际操作。

由于攻击者无法预测令牌，也无法读取它（同源策略），因此他无法在第二个查询中给出有效令牌。

但请注意不要泄漏令牌（了解如何在它们影响全局变量的值时使用捕获 json 等）并阅读：

[http://www.google.com/search?q=xsrf+defence](http://www.google.com/search?q=xsrf+defence)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-06T09:17:49.457

防止 XSRF 的最简单方法是检查每个 RESTful 请求的引用者，以确保请求来自同一个域。会话 cookie 对于保持状态很重要，但它不会防御 XSRF，因为它也会与伪造的请求一起发送。在内存需求有限的嵌入式网络硬件上常见基于引用的 XSRF 保护系统，摩托罗拉在其大部分硬件上使用这种方法。这不是最安全的 XSRF 保护，基于令牌的保护更好，但两个系统仍然可以通过 XSS 绕过。基于令牌的 XSRF 保护的最大问题是需要花费大量时间返回并修复每个请求，并且您可能会错过一些请求。

确保阅读[同源策略](http://code.google.com/p/browsersec/wiki/Part2#Same-origin_policy_for_XMLHttpRequest)并[扫描您的站点以查找 xss](http://www.acunetix.com/cross-site-scripting/scanner.htm)。您还应该阅读 OWASP Top 10 for 2010 [A3-Broken Authentication and Session Management](http://www.owasp.org/index.php?title=Top_10_2010-A3-Broken_Authentication_and_Session_Management&setlang=es)。

# ruby-on-rails - Rails：如何覆盖 stylesheet_path

> ID：901949
> 
> 赞同：0
> 
> 时间：2009-05-23T17:13:13.900
> 
> 标签：ruby-on-rails, ruby, mixins

我一直在尝试覆盖 Rails 的`stylesheet_path`助手，但我还没有找到方法。我不能只打开`ActionView::Helpers::AssetTagHelper`模块并在那里覆盖它，因为 Rails 不会采用我的新方法。

我知道这可能是因为模块混入了，那么我该如何解决呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T18:12:16.677

你这样做是否`stylesheet_link_tag`会导致与正常情况不同的事情？如果是这样，只需在帮助程序中覆盖*它*:)

或者，如果您真的想覆盖`stylesheet_path`，您还需要重新定义别名，因为奇怪的是，它只能通过其别名访问（在 Rails 2.3.2 中）。例如，我把它放进去`environment.rb`，它起作用了：

```
module ActionView
  module Helpers
    module AssetTagHelper
      def stylesheet_path(source)
        "x"
      end
      alias_method :path_to_stylesheet, :stylesheet_path
    end
  end
end 
```

我个人不会走这条路，但如果你需要它应该对你有用:)

# asp.net - 在长时间运行的操作完成之前保持 ASP.NET 页面的最佳方式是什么？

> ID：901954
> 
> 赞同：1
> 
> 时间：2009-05-23T17:14:34.757
> 
> 标签：asp.net, javascript, ajax, refresh, long-running-processes

Javascript？

元标记刷新？

Response.Redirect（到自己）

Server.Transfer（给自己）

Ajax 更新面板？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T17:34:50.247

让我们看看选项：

> Javascript？

只要用户没有禁用它，它就可以正常工作。

> 元标记刷新？

支持 Javascript 方法的已弃用方法。但是，如果用户禁用了 Javascript，您可以将其用作备份。

> Response.Redirect（到自己）

这不起作用，因为浏览器在重定向时不会显示对用户有用的任何内容。此外，浏览器将在一定数量的重定向后停止请求，以保护用户免受无限重定向。

> Server.Transfer（给自己）

也不起作用，因为服务器上的代码只会循环而不向浏览器发送任何内容。效果与代码中只有一个循环相同。

> Ajax 更新面板？

工作正常，只要用户没有禁用 Javascript。它与第一个选项基本相同，只是 Javascript 自己执行请求，而不是让浏览器执行请求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T03:08:00.680

如果您可以向用户报告任何类型的进度，我倾向于使用 asxh 和[永久框架](http://cometdaily.com/2007/11/05/the-forever-frame-technique/)的变体来运行。添加一点[jQuery UI Dialog](http://jqueryui.com/demos/dialog/)和[jQuery UI Progress Bar](http://jqueryui.com/demos/progressbar/)，当你在服务器上做繁重的工作时，你就有了一种吸引用户注意力的闪亮方式。

[我在874204](https://stackoverflow.com/questions/871184/forcing-page-content-to-change-through-javascript/874204#874204)给出了一些示例代码来演示该技术。

如果您无法为用户提供进度，我倾向于仍然使用 UI 对话框并弹出一条“请稍候，正在处理...”消息，并带有一个 web 两点哦兼容的 spinny gif。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T17:31:47.163

查看这篇关于[异步页面](http://msdn.microsoft.com/en-us/magazine/cc163725.aspx)的文章。这里还有一个来自[CodeProject](http://www.codeproject.com/KB/aspnet/AsyncProcessingMessage.aspx)的示例，其中包括异步页面和 META-REFRESH。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T17:41:28.113

[您可以在 Beer House Starter Kit- http://www.asp.net/Downloads/starter-kits/the-beer-house/](http://www.asp.net/Downloads/starter-kits/the-beer-house/)中找到此类功能的示例实现。

SendingNewsLetter.aspx 和 SendNewsLetter.aspx 页面将对您有用。不过，这可能对您的需要有点过分——它甚至显示了长时间运行的操作的进度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T17:56:12.943

使用 [AJAX WebModalAnchor](http://www.codeproject.com/KB/user-controls/WebModalAnchor.aspx)弹出一个带有取消按钮的窗口怎么样？

希望这可以帮助，

账单

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T17:35:00.700

我建议使用 Ajax 并显示一个 UpdateProgress，这样用户就知道它仍在流失。

# extension-methods - 有没有办法将规范的 OnPropertyChanged 方法编写为扩展方法？

> ID：901957
> 
> 赞同：0
> 
> 时间：2009-05-23T17:15:05.647
> 
> 标签：extension-methods, inotifypropertychanged

基本上我想做这样的事情：

```
public static void OnPropertyChanged(this INotifyPropertyChanged changedObject, string propertyName)
{
    var handler = changedObject.PropertyChanged;
    if (handler != null)
    {
        var e = new PropertyChangedEventArgs(propertyName);
        handler(changedObject, e);
    }
} 
```

这给出了“System.ComponentModel.INotifyPropertyChanged.PropertyChanged 只能在 += 或 -=" 的左侧使用

我的意思是我可以通过这样做来解决它：

```
public static void RaisePropertyChanged(this PropertyChangedEventHandler handler, object sender, string propertyName)
{
    if (handler != null)
    {
        var e = new PropertyChangedEventArgs(propertyName);
        handler(sender, e);
    }
} 
```

但调用代码看起来不太好：

```
PropertyChanged.RaisePropertyChanged(this, "Name"); 
```

与这个：

```
this.OnPropertyChanged("Name"); 
```

没什么大不了的，但是能够像调用实例方法一样调用它会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T10:05:44.327

这也违反了指导方针： On* 方法通常是基于实现实例内部的东西来做事。通常，这些方法是虚拟的，因此您可以在派生类中覆盖它们。因此，在外部使用 On* 方法是没有意义的。如果您想引发一个事件而不需要到处进行可怕的空测试，那么您确实应该使用 RaiseEvent() 扩展方法。我写了很多这些，都有重载，所以你可以只拥有 RaiseEvent(...) 并且你不必在方法中包含事件的名称。这在您使用普通 EventHandler 类型的情况下特别容易，因此您可以对更多事件使用相同的扩展方法。

# ruby - 无法使用 TicGit：Ruby 的问题

> ID：901958
> 
> 赞同：1
> 
> 时间：2009-05-23T17:15:06.893
> 
> 标签：ruby

我正在尝试通过运行来使用 Ticgit

```
 ti 
```

我收到以下错误消息

```
/opt/local/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require': no such file to load -- git (LoadError)
        from /opt/local/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:31:in `require'
        from /opt/local/lib/ruby/gems/1.8/gems/schacon-ticgit-0.3.6/lib/ticgit.rb:8
        from /opt/local/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
        from /opt/local/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:31:in `require'
        from /opt/local/lib/ruby/gems/1.8/gems/schacon-ticgit-0.3.6/bin/ti:9
        from /opt/local/bin/ti:19:in `load'
        from /opt/local/bin/ti:19 
```

该问题可能与 MacPorts 有关。它抱怨我需要将我的 Xcode 更新到最新版本，尽管我有最新版本。

错误消息中的第一行很奇怪，因为我有文件。

**错误信息告诉你什么？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T20:55:05.020

你有安装 git ruby​​gem 吗？

“/opt/local/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require': no such file to load -- git (LoadError)” 表示您没有可用的 ruby​​ 库您的加载路径，而不是您没有安装 git 二进制文件。

运行“gem list -l git”，如果找不到库，运行“gem install git”

# php - 正则表达式问题：将此模式与硬引号或软引号匹配

> ID：901962
> 
> 赞同：0
> 
> 时间：2009-05-23T17:16:23.023
> 
> 标签：php, regex

我有这个定位正则表达式的锚点工作得很好：

```
$p = '%<a.*\s+name="(.*)"\s*>(?:.*)</a>%im'; 
```

它匹配`<a`后跟零个或多个任何内容，后跟一个空格和`name="`

即使类或 id 在锚点中的名称之前，它也会抓取名称。

我想补充的是匹配`name='`单引号 (') 的能力，因为迟早有人会这样做。

显然我可以添加第二个为此编写的正则表达式，但这似乎不优雅。

任何人都知道如何添加单引号并只使用一个正则表达式？任何其他改进或建议将非常受欢迎。我可以使用我可以获得的所有正则表达式帮助！

非常感谢阅读，

```
function findAnchors($html) {
    $names = array();
    $p = '%<a.*\s+name="(.*)"\s*>(?:.*)</a>%im';
    $t = preg_match_all($p, $html, $matches, PREG_SET_ORDER);
    if ($matches) {
        foreach ($matches as $m) {
            $names[] = $m[1];
        }
        return $names;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T19:12:56.037

James 的评论实际上是一个非常流行但错误的正则表达式，用于字符串匹配。这是错误的，因为它不允许转义字符串分隔符。鉴于字符串分隔符是 ' 或 " 以下正则表达式有效

```
$regex = '([\'"])(.*?)(.{0,2})(?<![^\\\]\\\)(\1)'; 
```

\1 是起始分隔符，\2 是内容（减去 2 个字符），\3 是最后 2 个字符和结束分隔符。只要转义字符是 \ 并且转义字符没有被转义，此正则表达式就允许对分隔符进行转义。IE。，

```
'Valid'
'Valid \' String'
'Invalid ' String'
'Invalid \\' String' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T17:21:45.277

用于`[]`匹配字符集：

```
$p = "%<a.*\s+name=['\"](.*)['\"]\s*>(?:.*)</a>%im"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T17:22:47.067

试试这个：

```
/<a(?:\s+(?!name)[^"'>]+(?:"[^"]*"|'[^']*')?)*\s+name=("[^"]*"|'[^']*')\s*>/im 
```

在这里你只需要去掉周围的引号：

```
substr($match[1], 1, -1) 
```

但是使用像[DOMDocument](http://docs.php.net/manual/en/class.domdocument.php)这样的真正解析器肯定会比这种正则表达式方法更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T02:38:21.817

您当前的解决方案不会将锚点与“名称”之后的其他属性匹配（例如`<a name="foo" id="foo">`）。

尝试：

```
$regex = '%<a\s+\S*\s*name=["']([^"']+)["']%i'; 
```

这会将 'name' 属性的内容提取到反向引用中`$1`。
这`\s*`也将允许属性之间的换行符。
您不需要完成 ' `a`' 标记的其余部分，因为否定字符类`[^"']+`将是惰性的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-27T11:01:15.537

这是另一种方法：

```
$rgx='~<a(?:\s+(?>name()|\w+)=(?|"([^"]*)"|\'([^\']*)\'))+?\1~i'; 
```

我知道这个问题很老，但是当它刚刚重新浮出水面时，我想到了[Cookbook](http://shop.oreilly.com/product/9780596520694.do)中“空捕获组作为复选框”的另一种用法。第一个非捕获组在不情愿的加号 ( `+?`) 的控制下处理所有“name=value”对的匹配。如果属性名称是字面意义`name`上的 ，则空组 ( `()`) 不匹配，然后反向引用 ( `\1`) 再次不匹配，跳出循环。（反向引用成功，因为该组*参与了比赛*，即使它没有消耗任何字符。）

每次在组#2 中捕获属性值，覆盖在前一次迭代中捕获的任何内容。（分支重置结构（`(?|(...)|(...))`使我们能够“重用”组 #2 来捕获引号内的值，无论它们是哪种引号。）由于循环在名称`name`出现后退出，最终捕获的值对应于那个属性。

**[在 Ideone 上查看演示](http://ideone.com/O30ef)**

# c# - C# 控制台：边读边写并保留结构

> ID：901963
> 
> 赞同：6
> 
> 时间：2009-05-23T17:16:25.190
> 
> 标签：c#, multithreading, console, client-server

我正在编写一个通过 TCP 连接到服务器的 C# 控制台应用程序，它使用单独的线程来侦听来自服务器的传入消息，我希望它将它们写入控制台，同时从控制台读取消息。我能够做到这一点，但我有一个问题。

控制台在我输入时显示此信息，并出现一条消息：

> 来自服务器
> 的消息 来自服务器的消息
> 我的来自服务器
> g 的消息到服务器

我希望它将我的消息与服务器消息分开，如下所示：

> 来自服务器
> 的味精 来自服务器的
> 味精 来自服务器的味精
> 我的味精到服务器

*如果我收到一条消息，我仍然想保留我输入的消息，但我不希望它与收到的消息混淆，我希望它在最后一行保持完整。*

我可以这样做吗？如何？

当来自服务器的消息进入时，我可以将消息转移到控制台的末尾吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T17:37:21.460

我相信这实际上可以通过标准的 .NET 控制台 API 使用，使用一点hacky。您需要做的是创建一个异步 Read/ReadLine 方法（我假设您已经完成了，根据您的帖子判断）并允许在新数据到达时立即取消它。我现在假设您正在逐行发送输入。“新数据处理程序”的伪代码可能是这样的：

```
保存当前输入缓冲区。
取消当前的异步读取。
将光标位置重置到最后一次写入新数据的末尾。
输出新数据。
保存光标位置。
重新启动异步读取事件。

```

特别是，您需要处理[Console.CursorLeft](http://msdn.microsoft.com/en-us/library/system.console.cursorleft.aspx)和[Console.CursorTop](http://msdn.microsoft.com/en-us/library/system.console.cursortop.aspx)属性。您可能可以通过直接与 Win32 API 控制台函数交互来避免*一些*黑客行为，但这可能不值得费心。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T17:21:20.237

您不能直接通过 C# 中的 BCL 执行此操作。不过，有两种主要选择。

1）把它变成一个GUI应用程序，并有单独的输入/输出区域。这是用户 POV 中最“清晰”的选项，但需要 GUI 应用程序而不是控制台应用程序。

2) 直接P/Invoke 到[控制台API](http://msdn.microsoft.com/en-us/library/ms682073(VS.85).aspx)。这使您可以逐点完全控制控制台的视图。参见 SetConsoleCursorPosition 和 WriteConsole 等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T17:33:54.397

您需要使用 a `lock`on some`object`同时停止使用控制台的两个线程。声明如下：

```
public static class ThreadSafeConsole
{
    private static object _lockObject = new object();

    public static void WriteLine(string str)
    {
        lock (_lockObject) 
        {
            Console.WriteLine(str);
        }
    }
} 
```

现在调用`ThreadSafeConsole.WriteLine`而不是`Console.WriteLine`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T17:39:49.847

如果我理解正确，您必须为您的应用程序定义“键入控制台”的开始和结束，以便在发生这种情况时您仍然可以锁定对象，而不是将来自侦听器线程的消息插入到您输入的文本。

```
public static Object consoleLock = new Object();
public static void Main(string[] args)
{
    lock (consoleLock)
    {
        // now nothing can write to the console (if it's trying to lock onto it)
        Console.WriteLine("Please Input Something");
        // read from console
    }
    // now, your separate thread CAN write to the console - without 
    // interrupting your input process
} 
```

# java - Berkeley DB 中的突变错误

> ID：901966
> 
> 赞同：1
> 
> 时间：2009-05-23T17:16:49.603
> 
> 标签：java, berkeley-db

我正在使用 Berkely DB，但出现错误，提示缺少突变。这是什么意思？

```
Exception: com.sleepycat.persist.evolve.IncompatibleClassException: Mutation is missing to evolve class: TopMoveDAO.TopMoveClass version: 0 Error: java.lang.ClassNotFoundException: TopMoveDAO.TopMoveClasscom.sleepycat.persist.evolve.IncompatibleClassException: Mutation is missing to evolve class: TopMoveDAO.TopMoveClass version: 0 Error: java.lang.ClassNotFoundException: TopMoveDAO.TopMoveClass 
```

在 com.sleepycat.persist.impl.PersistCatalog.(PersistCatalog.java:365) 在 com.sleepycat.persist.impl.Store.(Store.java:180) 在 com.sleepycat.persist.EntityStore.(EntityStore.java: 165) 在 TopMoveDAO.TopMovePut.setup(TopMovePut.java:40) 在 TopMoveDAO.TopMovePut.run(TopMovePut.java:59) 在 TopMoveDAO.TopMovePut.main(TopMovePut.java:84)

```
package TopMoveDAO;

import java.io.File;
import java.util.Timer;
import java.util.TimerTask;

import com.sleepycat.je.DatabaseException;
import com.sleepycat.je.Environment;
import com.sleepycat.je.EnvironmentConfig;

import com.sleepycat.persist.EntityStore;
import com.sleepycat.persist.StoreConfig; 

public class TopMovePut {

    //private static File envHome = new File("C:/dev/je-3.3.75/");
 private static File envHome = new File("C:/dev/db/berkeley");

    private Environment envmnt;
    private EntityStore store;
    private TopMoveDA sda; 

//Next we create a method that simply opens our database environment and entity store for us.

   // The setup() method opens the environment and store
    // for us.
    public void setup()
        throws DatabaseException {

        EnvironmentConfig envConfig = new EnvironmentConfig();
        StoreConfig storeConfig = new StoreConfig();

        envConfig.setAllowCreate(true);
        storeConfig.setAllowCreate(true);

        // Open the environment and entity store
        envmnt = new Environment(envHome, envConfig);
       store = new EntityStore(envmnt, "EntityStore", storeConfig);
    } 

//We also need a method to close our environment and store.

    // Close our environment and store.
    public void shutdown()
        throws DatabaseException {

        store.close();
        envmnt.close();
    } 

//Populate the entity store
private void run()
    throws DatabaseException {

    setup();

    // Open the data accessor. This is used to store
    // persistent objects.
    sda = new TopMoveDA(store);

    // Instantiate and store some entity classes

    PriceElement pe1 = new PriceElement();

    pe1.setSecCode("UNO");
    pe1.setLastPrice(1);

    sda.pIdx.put(pe1);

    shutdown();
} 

//main
public static void main(String args[]) {
    //SimpleStorePut ssp = new SimpleStorePut();
    TopMovePut tmp = new TopMovePut();
    try {
        //ssp.run();
     tmp.run();
    } catch (DatabaseException dbe) {
        System.err.println("TopMovePut: " + dbe.toString());
        dbe.printStackTrace();
    } catch (Exception e) {
        System.out.println("Exception: " + e.toString());
        e.printStackTrace();
    }
    System.out.println("All done - TopMovePut.");
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-25T12:51:36.213

您必须编写一个突变来发展您的数据库。删除数据库并不能解决问题，只能规避它（如果您尚未部署到生产环境，这很好，但如果您不想丢失现有数据，请编写突变。）

Berkley db 会自动处理对持久实体的某些更改，例如添加字段。涉及删除数据或重命名字段的通常需要您编写显式突变。当您开始使用突变时，您还必须使用突变将引用的版本号注释您的实体 - 即使自动处理突变，您也必须增加版本号。当您进行重大结构更改（例如使用不同的主键）时，您将不得不进行整个存储转换。

在复制环境中演进数据库时要小心。我强烈建议阅读以下内容：

[包 com.sleepycat.persist.evolve（Oracle - Berkeley DB Java 版 API）](https://docs.oracle.com/cd/E17277_02/html/java/com/sleepycat/persist/evolve/package-summary.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-06T13:23:39.520

您必须每次都删除现有的数据库。

# c# - C# 从注册表中读取十进制值

> ID：901968
> 
> 赞同：0
> 
> 时间：2009-05-23T17:17:52.537
> 
> 标签：c#, registry

我有一个 NumericUpDown 控件并想从注册表更新其内容。到目前为止，这就是我得到的：

```
this.apTime.Value = APRegsitry.GetValue("apTime").ToString(); 
```

显然这不起作用所以我如何将 this.apTime 设置为注册表项的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T17:20:13.233

我不完全确定问题是什么。您在将其转换为小数时遇到问题吗？如果是这样，请尝试 Decimal.Parse

```
Object obj = APRegistry.GetValue("apTime");
String str = obj != null ? obj.ToString() : "0";
Decimal value = Decimal.Parse(str);
this.apTime.Value = value; 
```

如果不是，您能否进一步详细说明问题所在？

**编辑**更新代码以说明 GetValue 的空返回

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T18:48:39.143

您不应该信任注册表中的值，因为用户可以在您的应用程序之外对其进行编辑。您需要处理以下情况：

*   注册表项不存在
*   注册表项存在，但名称/值不存在 ( `null`)
*   你期望 a `string`，值不是`string`类型（例如它是一个`int`or `byte[]`）
*   值是 a`string`但不可解析为`decimal`( `""`, `"abc"`)

如果键不存在，则`RegistryKey.OpenSubKey(name)`返回 null。您可能想要处理它并创建密钥。如果键存在，但不存在名称/值对，则`RegistryKey.GetValue(name)`返回 null。您可以通过将默认值传递给重载`RegistryKey.GetValue(name, defaultValue)`或使用`??`.

现在，如果名称/值对存在但具有无效值 ( `""`, `"abc"`)，您将从`Parse()`. `Parse()`方法（在, `int`,`decimal`等中`DateTime`）已被`TryParse()`. 他们返回`false`而不是投掷`FormatException`。

```
// passing the default value to GetValue()
object regValue = APRegistry.GetValue("apTime", "0");
// ...same as...
object regValue = APRegistry.GetValue("apTime") ?? "0";

decimal value;

// regValue will never be null here, so safe to use ToString()
if(decimal.TryParse(regValue.ToString(), out value))
{
    this.apTime.Value = value;
}
else
{
    // Name/pair does not exist, is empty,
    // or has invalid value (can't parse as decimal).

    // Handle this case, possibly setting a default value like this:
    this.apTime.Value = 0; 
} 
```

# vb6 - vb6中动态二级或多级子菜单生成

> ID：901975
> 
> 赞同：3
> 
> 时间：2009-05-23T17:21:33.310
> 
> 标签：vb6, dynamic, creation, submenu

朋友，告诉我如何在VB6运行时**生成多于1​​级的子菜单？**简要解释一下？有什么具体的控制吗？但我不想使用外部控件！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-08-09T09:10:45.800

您可以使用 API 函数创建多个级别的子菜单

```
Private Declare Function CreatePopupMenu Lib "user32" () As Long

Private Declare Function AppendMenu Lib "user32" Alias "AppendMenuA" (ByVal hmenu As Long, ByVal wFlags As Long, ByVal wIDNewItem As Long, ByVal lpNewItem As Any) As Long

Private Declare Function GetCursorPos Lib "user32" (lpPoint As POINTAPI) As Long

Private Declare Function TrackPopupMenu Lib "user32" (ByVal hmenu As Long, ByVal wFlags As Long, ByVal X As Long, ByVal Y As Long, ByVal nReserved As Long, ByVal hwnd As Long, lprc As Any) As Long

Private Declare Function DestroyMenu Lib "user32" (ByVal hmenu As Long) As Long

Private Type POINTAPI
    X As Long
    Y As Long
End Type

Dim hmenu As Long, hSubMenu As Long
Private Const MF_STRING = &H0&
Private Const MF_SEPARATOR = &H800&

  hSubMenu = CreatePopupMenu
  AppendMenu hSubMenu, 0, 121, "Sub Menu1"
  AppendMenu hSubMenu, 0, 122, "Sub Menu2"

  hmenu = CreatePopupMenu
  AppendMenu hmenu, 0, 107, "Menu1"

  AppendMenu hmenu, 0, 106, "Menu2"

  AppendMenu hmenu, MF_POPUP, hSubMenu, "Menu3"
  AppendMenu hmenu, MF_POPUP, hSubMenu, "Menu4"

  AppendMenu hmenu, 0, 101, "Menu5" 
```

显示

```
 If Button = vbRightButton Then
    Dim P As POINTAPI
    GetCursorPos P
    TrackPopupMenu hmenu, 0, P.X, P.Y, 0, hwnd, 0 
```

菜单在`TrackPopupMenu`被调用之前不会显示。它的返回值可以指示选择了哪个（如果有）菜单项。例如，如果选择了“Menu1”，它可能会返回“107”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T17:43:39.577

您可以使用标准的 VB 菜单来做到这一点，但是由于您必须使用控件数组，因此您必须在设计时（通常不可见）创建第一个原型菜单`Index = 0`（例如`mnuFoo(0)`）。您现在可以动态加载新项目。

```
Call Me.Load(mnuFoo(1)) ' New array member (index 1) '
With mnuFoo(1)
    .Visible = True ' Make it visible
    ' --- Do some settings
End With 
```

# algorithm - 在 FTP 中实现 mktree 的最快方法

> ID：901979
> 
> 赞同：1
> 
> 时间：2009-05-23T17:23:36.270
> 
> 标签：algorithm, ftp, file-transfer

使用 FTP 协议递归创建目录（类似于 UNIX mkdir -p）的最快算法通常是什么？

我考虑过一种方法：

1.  MKDIR 节点
2.  如果错误和剩余节点与下一个节点一起转到 1
3.  结尾

但是，如果目录的一部分很可能存在，这可能会导致性能不佳。例如，通过某些摊销，“/a/b/c/d/e/f/g”路径的“/a/b/c/d”部分存在 %99 的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T11:03:54.320

考虑到发送命令和接收响应需要花费大部分时间，创建目录路径的最快方法是使用尽可能少的命令。

因为除了尝试创建或 cd 到一个目录来检查它的存在之外别无他法，只需使用 mkdir a; mkdir a/b; ...， mkdir a/b/c/d/e/f 通常是最快的方法（不要 cd 进入子目录来创建下一个，因为这会延长过程）。

如果您以这种方式创建多个目录，您当然可以跟踪您已经创建了哪些顶级目录。此外，根据路径的长度和上层目录已经存在的可能性，您可以尝试从例如 mkdir a/b/c （对于 a/b/c/d/e/f）开始，然后回溯，如果它没有成功。但是，如果目录更可能不存在，从长远来看，这实际上会变慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T14:26:59.870

如果现有目录层次结构在任何给定深度处结束的可能性相同，则对开始位置的**二进制搜索**将是最快的方法。但是正如[dseifert 指出的那样](https://stackoverflow.com/questions/901979/the-fastest-way-to-implement-mktree-in-ftp/903540#903540)，如果大多数时候目录已经存在到 k 级，那么在 k 级而不是 n/2 级开始二进制搜索会更快。

顺便说一句，您必须创建*很多**非常深*的目录才能使这种优化值得您花时间。你确定你没有过早优化吗？

# git - 为什么 git 不知道我合并了？有没有办法告诉它？

> ID：901980
> 
> 赞同：2
> 
> 时间：2009-05-23T17:23:45.100
> 
> 标签：git, merge, git-svn

我正在使用 git-svn；我通常创建一个主题分支，对其进行提交，然后是 checkout master、git svn rebase、git merge --squash topic_branch、git commit -m "summary comment"，然后是 git svn dcommit。

这很好用，但 git 似乎不知道我将分支更改合并到 master 中。我在没有涉及 svn 的情况下尝试了这个：

```
# Make a repository, add a couple files
$ mkdir gittest
$ cd gittest
$ git init
$ touch foo bar
$ git add .
$ git commit -m "initial version"

# Make a branch, change a file, commit.
$ git checkout -b a_branch
$ vi foo # make a change
$ git commit -am "a change"

# Merge changes into master
$ git checkout master
$ git merge --squash a_branch
$ git commit -m "merged a_branch" 
```

并且 gitk --all 显示了这一点，这表明这不是 git-svn 问题：

[![gitk 图片显示显然未合并的分支](https://i.stack.imgur.com/Xwt8N.png)](https://i.stack.imgur.com/Xwt8N.png)
[（来源：[selfamusementpark.com](http://selfamusementpark.com/pic/hosted/gittest.png?sekrit=NADEU6)）]

在我的主要 (git-svn) 项目中，我看到早期的一些更改似乎已经被合并，但我不知道我现在在做什么不同，因为我当时没有这样做。（如果重要的话，这是 Ubuntu Jaunty 上的 git 1.6.0.4。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T17:31:00.003

我想这是因为你使用了`--squash`. 我不确定你为什么这样做，但你不应该这样做。从`--squash`git merge 的文档中：

> 生成工作树和索引状态，就好像发生了真正的合并一样，但实际上不进行提交或移动 HEAD，也不记录 $GIT_DIR/MERGE_HEAD 以使下一个 git commit 命令创建合并提交。这允许您在当前分支之上创建一个提交，其效果与合并另一个分支相同（或者在章鱼的情况下更多）。

基本上，您需要进行“适当的”合并。挤压似乎有一个相当具体的使用情况（我从未有过，所以我不能真正评论它*为什么*有用）。我*想*这是因为如果您在分支中做了一些工作，但又决定将其合并到您正在做更多总体工作的不同分支中，那么您不希望分支树看起来凌乱。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T17:31:40.923

只是不要使用`git merge --squash`:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T07:51:34.043

添加到彼得库珀的答案（评论不够长）：

`git rebase --interactive`（虽然电锯很危险：请参阅[http://tomayko.com/writings/the-thing-about-git](http://tomayko.com/writings/the-thing-about-git)了解更多信息和一些关于您为什么要使用它的背景）将让您在 dcommitting 之前压缩和重新排序单个提交他们到svn。我经常使用它来帮助将 10-12 个中间提交合并为 3-4 个补丁集，然后再提交回 repo。

尝试`git rebase --interactive HEAD~10`以交互方式对当前分支上的最后 10 次提交进行变基。一旦你学会了它就非常棒，我每天都在我的 git svn repo 上使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-23T06:42:53.673

在你完成壁球合并之后，你需要手动告诉 git 你的合并，因为在你 dcommit 之后 git 忘记了。手动告诉 git 合并的方法是使用 git 嫁接。 [链接文本](http://radorant.blogspot.com/2009/06/use-git-to-do-your-svn-merges.html)

# python - Python OSError：[Errno 2]

> ID：901982
> 
> 赞同：38
> 
> 时间：2009-05-23T17:24:03.650
> 
> 标签：python, subprocess

我有以下代码试图在 Linux 中启动下面的每个“命令”。如果两个命令中的任何一个因任何原因崩溃，该模块会尝试保持每个命令运行。

```
#!/usr/bin/env python
import subprocess

commands = [ ["screen -dmS RealmD top"], ["screen -DmS RealmD top -d 5"] ]
programs = [ subprocess.Popen(c) for c in commands ]
while True:
    for i in range(len(programs)):
        if programs[i].returncode is None:
            continue # still running
        else:
            # restart this one
            programs[i]= subprocess.Popen(commands[i])
        time.sleep(1.0) 
```

执行代码时会抛出以下异常：

```
Traceback (most recent call last):
  File "./marp.py", line 82, in <module>
    programs = [ subprocess.Popen(c) for c in commands ]
  File "/usr/lib/python2.6/subprocess.py", line 595, in __init__
    errread, errwrite)
  File "/usr/lib/python2.6/subprocess.py", line 1092, in _execute_child
    raise child_exception
OSError: [Errno 2] No such file or directory 
```

我想我遗漏了一些明显的东西，任何人都可以看到上面的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-05-23T17:31:21.033

使用`["screen", "-dmS", "RealmD", "top"]`而不是`["screen -dmS RealmD top"]`.

也许也使用完整的路径`screen`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-23T17:29:51.737

唯一的猜测是它找不到`screen`。尝试`/usr/bin/screen`或任何`which screen`给你的东西。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-07T22:05:54.477

问题是您的命令应该被拆分。subprocces 要求 cmd 是一个列表，而不是一个字符串。它不应该是：

```
subprocess.call('''awk 'BEGIN {FS="\t";OFS="\n"} {a[$1]=a [$1] OFS $2 FS $3 FS $4} END
{for (i in a) {print i a[i]}}' 2_lcsorted.txt > 2_locus_2.txt''') 
```

那是行不通的。如果您为 subprocess 提供一个字符串，它假定这是您要执行的命令的路径。该命令需要是一个列表。查看[http://www.gossamer-threads.com/lists/python/python/724330](http://www.gossamer-threads.com/lists/python/python/724330)。另外，因为您使用的是文件重定向，所以您应该使用`subprocess.call(cmd, shell=True)`. 您也可以使用`shlex`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-04-15T19:52:51.487

当我这样写时，我遇到了同样的错误：-

```
subprocess.Popen("ls" ,shell = False , stdout = subprocess.PIPE ,stderr = subprocess.PIPE) 
```

当我制作**shell=True**时问题就解决了。它会起作用

`subprocess.Popen("ls" ,shell = False , stdout = subprocess.PIPE ,stderr = subprocess.PIPE, shell=True)`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-06-12T13:21:50.440

```
commands = [ "screen -dmS RealmD top", "screen -DmS RealmD top -d 5" ]
programs = [ subprocess.Popen(c.split()) for c in commands ] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-29T15:36:06.883

以防万一..我也遇到了这个错误，问题是我的文件在 DOS 而不是 UNIX 所以在：

```
 return subprocess.call(lst_exp) 
```

其中 lst_exp 是 args 列表，其中一个是“未找到”，因为它在 DOS 而不是 UNIX 中，但抛出的错误是相同的：

```
File "/var/www/run_verifier.py", line 59, in main
return subprocess.call(lst_exp)
File "/usr/lib/python2.7/subprocess.py", line 522, in call
return Popen(*popenargs, **kwargs).wait()
File "/usr/lib/python2.7/subprocess.py", line 710, in __init__
errread, errwrite)
File "/usr/lib/python2.7/subprocess.py", line 1335, in _execute_child
raise child_exception
OSError: [Errno 2] No such file or directory 
```

# java - JVM 类文件验证器如何工作？

> ID：901987
> 
> 赞同：3
> 
> 时间：2009-05-23T17:26:28.607
> 
> 标签：java, jvm

JVM 类文件验证器如何执行类验证？

谁能告诉我步骤？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T17:45:57.967

有四种通行证：

1.  **基本格式检查**（加载类时）-（幻数，检查常量池）。

2.  **附加验证**（链接时） - 检查最终修饰符，检查直接子类，有效字段，检查常量池。

3.  **字节码验证**（链接时） - 检查代码数组 - 操作数堆栈是否正常、局部变量、正确的方法调用、字段分配等...

4.  **Virtual Pass** (Code Invoked) - 确保引用的类/方法存在并具有正确的描述符。

完整的细节在这里，请参阅第 4.9.1 节验证过程

[http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html](http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T17:41:34.870

[请参阅VM Spec](http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html#88597)的第 4.9 节。该过程详细说明。

# macos - 无法找到 logFiles 以查看哪些在 Mac 中打开/关闭了我的 X11

> ID：901999
> 
> 赞同：0
> 
> 时间：2009-05-23T17:34:33.023
> 
> 标签：macos, x11

我的 X11 反复打开和关闭。我在 Dock 上只能看到以下内容

```
Application not responding 
```

**你怎么能找到告诉我连续打开/关闭 X11 的应用程序的 logFiles？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T11:37:39.947

没有日志可以跟踪哪个应用程序启动/停止了 X11。并且至少在我的机器上，X11 也总是由 launchd 进程启动（在 X11 运行时，在终端中键入“ps xa -O ppid | grep X11”以查看父进程 ID（第 2 列））。

对我来说，当我使用 ssh 以及启动任何 X11 应用程序（例如 xterm）时，X11 就会启动。也许您可以看看 X11 启动时正在运行的其他应用程序。

此外，您提到了“应用程序无响应”，我认为这与 X11 本身有关。因此，X11 服务器更有可能只是简单地崩溃（或以某种方式卡住），而不是其他一些应用程序停止它。在这种情况下，您可能会在**Library/Logs/CrashReporter**目录（您的库和系统库）中找到一些信息。*************