# StackOverflow 问答 000562000-000562999

# vba - 无模式 MsgBox、错误捕获、.Find

> ID：562001
> 
> 赞同：3
> 
> 时间：2009-02-18T17:10:57.317
> 
> 标签：vba, excel

我有一个子例程在另一个工作簿中搜索字符串的出现。如果找不到字符串（很可能是由于拼写错误），我试图弹出一条错误消息，如 vbModeless，并允许用户单击搜索表中具有正确值的单元格. 然后我想用新值继续搜索。

我现在坚持让我的简单 MsgBox 成为无模式的。任何人都可以帮忙吗？到目前为止，我有（简化）：

```
With ...
    On Error GoTo UserSelect
    celladdress = .Range("a1:bb100").Find("searchstring").Address 
```

还有我的错误标签：

```
UserSelect:
    MsgBox("Select the cell with the correct spelling") vbModeless
    newstring = ActiveCell.Value
    searchstring = newstring
    Resume 
```

我认为是无模式的 MsgBox 让我感到悲伤。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T17:18:59.043

我不相信您可以将 vbModeless 与 msgbox 一起使用。这是与用户表单的 Show 方法一起使用的。

您可能需要做的是创建一个用户表单，上面有一个 refedit 控件和一个按钮。然后，他们可以使用 refedit 控件选择一个单元格。当用户单击按钮时，在表单上设置一个公共变量，其中单元格引用被选中。

然后您需要在用户表单上使用“.Show vbModal”并读取他们从表单公共变量中选择的单元格。

编辑：

实际上，您不需要公共变量，因为 refedit 控件无论如何都应该是表单的公共属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T01:21:50.630

我不是 100% 确定这里的要求。给定一个搜索字符串*dgo*和一个包含*bird*、*cat*和*dog*单元格的工作表。您是否希望用户：

(a) 编辑包含*dog*的单元格并将其更改为*dgo*

这将使用由 andynormancx 概述的模态表单和 RefEdit 控件。与 MsgBox 一样，模态窗体会暂停宏，直到窗体关闭

(b) 允许用户单击包含*dog的单元格，然后以**dog*作为搜索词重新运行搜索

这更复杂。我认为您需要查看这里的事件。如果您的子程序几乎是独立的，这很好，但如果它是更大程序的一部分，那么这可能需要大量重写

# asp.net - ASP.NET 2.0 - 带有 tbody/thead 的 DataGrid

> ID：562010
> 
> 赞同：6
> 
> 时间：2009-02-18T17:13:26.263
> 
> 标签：asp.net, datagrid

有没有办法让 DataGrid 控件呈现 tbody 和 thead HTML 元素？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-19T21:03:59.350

虽然我喜欢“user186197”的答案，但该博客文章使用反射，但在非完全受信任的托管环境中可能会出现问题。这是我们使用的，没有黑客：

```
public class THeadDataGrid : System.Web.UI.WebControls.DataGrid
{
    protected override void OnPreRender(EventArgs e)
    {
        this.UseAccessibleHeader = true; //to make sure we render TH, not TD

        Table table = Controls[0] as Table;

        if (table != null && table.Rows.Count > 0)
        {
            table.Rows[0].TableSection = TableRowSection.TableHeader;
            table.Rows[table.Rows.Count - 1].TableSection = TableRowSection.TableFooter;
        }

        base.OnPreRender(e);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-09-13T11:24:19.627

It can be done also via javascript.

```
function AddTHEAD(tableName)
{
   var table = document.getElementById(tableName); 
   if(table != null) 
   {
    var head = document.createElement("THEAD");
    head.style.display = "table-header-group";
    head.appendChild(table.rows[0]);
    table.insertBefore(head, table.childNodes[0]); 
   }
} 
```

Then you must call this function on body onload like that:

```
<body onload="javascript: AddTHEAD('DataGridId')"> 
```

Source: [http://www.codeproject.com/KB/grid/HeaderOnEachPage.aspx](http://www.codeproject.com/KB/grid/HeaderOnEachPage.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T17:23:33.777

DataGrid 没有内置的东西来满足您的需求。看看[ASP.NET 2.0 CSS Friendly Control Adapters 1.0](http://www.asp.net/cssadapters/)，它们内置了对 DataView 的支持，但似乎您可以轻松地将这个想法用于 DataGrid。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T18:11:19.870

是的，看起来数据网格不支持这个开箱即用，所以我不得不创建一个继承自 DataGrid 的类。在 DataGrid 呈现之后，我解析 HTML 并将元素注入正确的位置。

附件是我的课程，供那些想知道如何操作的人使用。这是一种快速而肮脏的方法，因此欢迎我提出更好的想法。

```
 Imports System.IO
Imports System.Text

Public Class TestDataGrid
  Inherits System.Web.UI.WebControls.DataGrid

  Private sTHeadClass As String = String.Empty
  Private sTBodyClass As String = String.Empty
  Private sTFootClass As String = String.Empty

#Region " Properties "

  Public Property THeadClass() As String
    Get
      Return sTHeadClass
    End Get
    Set(ByVal value As String)
      sTHeadClass = value
    End Set
  End Property

  Public Property TBodyClass() As String
    Get
      Return sTBodyClass
    End Get
    Set(ByVal value As String)
      sTBodyClass = value
    End Set
  End Property

  Public Property TFootClass() As String
    Get
      Return sTFootClass
    End Get
    Set(ByVal value As String)
      sTFootClass = value
    End Set
  End Property

#End Region

  Protected Overrides Sub Render(ByVal writer As System.Web.UI.HtmlTextWriter)

    Dim oMemoryStream As New MemoryStream()
    Dim oStreamWriter As New StreamWriter(oMemoryStream)
    Dim oStreamReader As New StreamReader(oMemoryStream)
    Dim oHtmlTextWriter As New HtmlTextWriter(oStreamWriter)

    MyBase.Render(oHtmlTextWriter)

    oHtmlTextWriter.Flush()

    oMemoryStream.Flush()
    oMemoryStream.Position = 0

    Dim sHtml As String = oStreamReader.ReadToEnd()
    Dim oHtml As New Text.StringBuilder()

    Dim iPastIndex As Integer = 0
    Dim iIndex As Integer = sHtml.IndexOf("<tr>")

    oHtml.Append(sHtml.Substring(iPastIndex, iIndex - iPastIndex))

    iPastIndex = iIndex

    If ShowHeader Then
      WriteElementStart(oHtml, "thead", sTHeadClass)

      'Write Header Row
      iIndex = sHtml.IndexOf("</tr>", iPastIndex) + 5
      oHtml.Append(sHtml.Substring(iPastIndex, iIndex - iPastIndex))
      iPastIndex = iIndex

      oHtml.Append("</thead>")
      WriteElementStart(oHtml, "tbody", sTBodyClass)
    Else
      WriteElementStart(oHtml, "tbody", sTBodyClass)
    End If

    If ShowFooter Then

      'Writer Body Rows
      iIndex = sHtml.LastIndexOf("<tr>")
      oHtml.Append(sHtml.Substring(iPastIndex, iIndex - iPastIndex))
      iPastIndex = iIndex

      WriteElementEnd(oHtml, "tbody")
      WriteElementStart(oHtml, "tfoot", sTFootClass)

      'Write Footer Row
      iIndex = sHtml.LastIndexOf("</table>")
      oHtml.Append(sHtml.Substring(iPastIndex, iIndex - iPastIndex))
      iPastIndex = iIndex

      WriteElementEnd(oHtml, "tfoot")

    Else
      iIndex = sHtml.LastIndexOf("</table>")
      oHtml.Append(sHtml.Substring(iPastIndex, iIndex - iPastIndex))
      iPastIndex = iIndex

      WriteElementEnd(oHtml, "tbody")
    End If

    oHtml.Append(sHtml.Substring(iPastIndex, sHtml.Length - iPastIndex))

    writer.Write(oHtml.ToString())
  End Sub

  Private Sub WriteElementStart(ByVal Builder As StringBuilder, ByVal Tag As String, ByVal CssClass As String)
    If String.IsNullOrEmpty(CssClass) Then
      Builder.AppendFormat("<{0}>", Tag)
    Else
      Builder.AppendFormat("<{0} class='{1}'>", Tag, CssClass)
    End If
  End Sub

  Private Sub WriteElementEnd(ByVal Builder As StringBuilder, ByVal Tag As String)
    Builder.AppendFormat("</{0}>", Tag)
  End Sub

End Class 
```

# asp.net - 如何通过 Intranet 使 ASP 应用程序可用

> ID：562011
> 
> 赞同：1
> 
> 时间：2009-02-18T17:13:43.753
> 
> 标签：asp.net

我已经创建了一个我们遗留的（陈旧的）本土 Timesheet ASP 应用程序的副本到一个不同的、更新的工作站上用于备份。

我终于可以使用以下地址通过 http 在本地运行它：

[http://localhost/timesheet/Timesheet.asp](http://localhost/timesheet/Timesheet.asp)

我想通过网络测试它，地址如下：

[http://backupServerHostname/timesheet/Timesheet.asp](http://backupServerHostname/timesheet/Timesheet.asp)

实时应用程序使用类似的寻址方案。我只是不清楚需要做什么才能使该应用程序可从新服务器上使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T17:29:15.867

您需要确保备份服务器没有使用 Windows 防火墙或其他东西来阻止端口 80 访问。此外，如果您的 asp 应用程序未设置为允许匿名访问（假设您希望这样做），您可能会遇到权限问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T17:45:55.500

转到 Timesheet Web 内容所在的文件夹（可能是 C:\Inetpub\wwwroot\TimeSheet，只是猜测）。

然后右键单击该文件夹，选择“属性”，然后单击“Web 共享”选项卡，然后选择“共享此文件夹”选项，这应该会弹出一个“编辑别名”窗口。将别名更改为“backupServerHostName”。

这是假设所有机器都在同一个局域网上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T17:16:41.670

什么都不需要做。如果它在端口 80 上为 localhost 提供服务，它应该使用与您提供的名称相似的名称为您本地网络上的其他计算机提供服务。从字面上看，它可能就像尝试一样简单......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T17:18:21.480

如果您只需要在工作中的其他机器上浏览它，只需将“localhost”部分替换为您的机器名称即可。

如果您需要通过网络访问它，您需要使用 IIS 在面向外部的服务器上安装它，然后以这种方式浏览它。

# .net - 我应该如何处理与 .Net 中的插件类型系统相关的强名称问题

> ID：562012
> 
> 赞同：2
> 
> 时间：2009-02-18T17:13:55.950
> 
> 标签：.net, plugins

我正在开发一个 SDK。SDK的目标是统一访问各种硬件产品。因此，我们已经确定了插件架构，使用抽象工厂模式进行创建。我遇到的问题是，每当 SDK 发生变化时，我都必须让项目团队重新编译他们的插件。显然，如果他们依赖或实现的接口发生了变化，这是必要的。我的问题是当我修复几个错误（但没有更改接口）时，它们仍然需要重新编译，因为插件正在尝试加载特定版本的 SDK（基于程序集强名称）。据我了解，我的选择是：

1.  不要强烈命名我的 SDK 程序集。这最终是不可接受的，因为我们的许多客户要求 .Net 程序集被强命名。
2.  创建发布者策略。我怀疑我最终会使用它，但我对安装在同一台机器上的两个应用程序不能使用不同版本的 SDK 的想法不满意。

我知道我正在寻找的东西会让我再次陷入 DLL 地狱，但在这种情况下，我觉得我需要它。有什么我想念的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T17:31:57.297

SDK 是否被放置在 GAC 中？如果没有，那么[http://msdn.microsoft.com/en-us/library/0a7zy9z5(vs.71).aspx](http://msdn.microsoft.com/en-us/library/0a7zy9z5(vs.71).aspx)可能会有所帮助。我似乎记得通过配置看到了一种更简单的方法来做到这一点，但不记得在哪里或如何做到这一点，也无法找到任何细节。

另一种可能性是在应用程序配置中使用 assemblyBinding。看起来这将允许您指示在请求版本 1.0 时改为加载版本 2.0。这仍然需要适配器创建者的努力，但是它应该只要求他们将一些罐装的 xml 放入 app.config 中。[http://msdn.microsoft.com/en-us/library/twy1dw1e.aspx](http://msdn.microsoft.com/en-us/library/twy1dw1e.aspx)

从该链接中，配置将具有以下内容：

```
<configuration>
   <runtime>
      <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
         <dependentAssembly>
            <assemblyIdentity name="myAssembly"
                              publicKeyToken="32ab4ba45e0a69a1"
                              culture="neutral" />
            <bindingRedirect oldVersion="1.0.0.0"
                             newVersion="2.0.0.0"/>
            <codeBase version="2.0.0.0"
                      href="http://www.litwareinc.com/myAssembly.dll"/>
         </dependentAssembly>
      </assemblyBinding>
   </runtime>
</configuration> 
```

未来最好的选择可能是将公共接口提取到一个单独的程序集中供适配器作者使用。这将允许独立于实现对接口进行版本控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T15:42:59.493

我们选择使用发布者策略文件。上述方法需要适配器编写者的干预。我们的目标是使用和适配 SDK 的新（补丁）版本。Publisher Policy 文件的缺点是它会影响机器上运行的所有应用程序。

它仍然有效。

帕特奥

# c# - 如何管理线程池中的哪些项目？

> ID：562015
> 
> 赞同：1
> 
> 时间：2009-02-18T17:15:21.220
> 
> 标签：c#, .net, multithreading, windows-services

我有一个 Windows 服务，它在服务主计时器过去 (OnElapse) 时运行一个方法。

OnElapse 方法获取要处理的 .xml 文件列表。每个 xml 文件都插入到一个 ThreadPool 中。

**我想确保我不会将 2 个同名的 XML 插入到 ThreadPool 中。**

如何管理线程池中的哪些项目？我基本上想这样做：

```
if xmlfilename not in threadpool
   insert in threadpool 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T18:24:20.900

这是一个非常巧妙的技巧，因为您需要密切监视 ThreadPool 并且它需要一种同步形式。这是一个快速而肮脏的例子。

```
class XmlManager {
  private object m_lock = new object();
  private HashSet<string> m_inPool = new HashSet<string>();

  private void Run(object state) {
    string name = (string)state;
    try { 
      FunctionThatActuallyProcessesFiles(name);
    } finally { 
      lock ( m_lock ) { m_inPool.Remove(name); }
    }
  }

  public void MaybeRun(string xmlName) { 
    lock ( m_lock ) { 
      if (!m_pool.Add(xmlName)) {
        return;
      }
    }
    ThreadPool.QueueUserWorkItem(Run, xmlName);
  }
} 
```

这不是一个万无一失的解决方案。代码中至少存在一种竞争条件。也就是说，当您尝试重新添加某个项目时，可能会从池中删除它，但实际上不会添加它。但是，如果您只关心它们被处理一次，那没关系。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T18:36:12.710

应该这样做（如果您使用的是 .Net 3.5 或更高版本，请使用 HashSet 而不是 Dictionary）：

```
using System;
using System.Collections.Generic;
using System.Threading;

namespace Something
{
    class ProcessFilesClass
    {
        private object m_Lock = new object();
        private Dictionary<string, object> m_WorkingItems = 
            new Dictionary<string, object>();
        private Timer m_Timer;

        public ProcessFilesClass()
        {
            m_Timer = new Timer(OnElapsed, null, 0, 10000);
        }

        public void OnElapsed(object context)
        {
            List<string> xmlList = new List<string>();
            //Process xml files into xmlList

            foreach (string xmlFile in xmlList)
            {
                lock (m_Lock)
                {
                    if (!m_WorkingItems.ContainsKey(xmlFile))
                    {
                        m_WorkingItems.Add(xmlFile, null);
                        ThreadPool.QueueUserWorkItem(DoWork, xmlFile);
                    }
                }
            }
        }

        public void DoWork(object xmlFile)
        {
            //process xmlFile
            lock (m_Lock)
            {
                m_WorkingItems.Remove(xmlFile.ToString());
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T17:22:53.417

OnElaspe 你不能重命名 xml 文件吗？所以它在线程池上有一个独特的名字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T17:25:42.273

您不能制作字典> 并在插入之前检查一下吗？像这样的东西...

```
Dictionary<ThreadPool, List<String>> poolXmlFiles = new Dictionary<ThreadPool, List<String>>();
if(poolXmlFiles.ContainsKey(ThreadPool) && !poolXmlFiles[ThreadPool].Contains(xmlFileName))
{
     poolXmlFiles[ThreadPool].Add(xmlFileName);
     //Add the xmlFile to the ThreadPool
} 
```

抱歉，如果有语法错误，这些天我正在用 VB 编码。

# c# - 在 C# 中列出 ODBC 数据源

> ID：562016
> 
> 赞同：12
> 
> 时间：2009-02-18T17:15:44.370
> 
> 标签：c#, odbc

我正在寻找一种适当抽象的方法来从 C# 系统中获取 ODBC 数据源列表。我尝试了“在注册表中查找”技巧，我发现它在英语中效果很好：

```
 RegistryKey reg = (Registry.CurrentUser).OpenSubKey("Software");
        reg = reg.OpenSubKey("ODBC");
        reg = reg.OpenSubKey("ODBC.INI");
        reg = reg.OpenSubKey("ODBC Data Sources");

        and then, of course, iterating over reg.GetValueNames() 
```

唯一的问题是我在至少一台西班牙机器上发现他们的注册表键是西班牙语，所以显然违反了这个抽象（如果存在的话）已经给我带来了麻烦。

是否有库函数可以做到这一点？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-05T10:23:53.990

您可以在 ODBC32.DLL 中调用 SQLDataSources 函数：

```
 using System.Runtime.InteropServices;
    public static class OdbcWrapper
    {
        [DllImport("odbc32.dll")]
        public static extern int SQLDataSources(int EnvHandle, int Direction, StringBuilder ServerName, int ServerNameBufferLenIn,
    ref int ServerNameBufferLenOut, StringBuilder Driver, int DriverBufferLenIn, ref int DriverBufferLenOut);

        [DllImport("odbc32.dll")]
        public static extern int SQLAllocEnv(ref int EnvHandle);
    } 
```

列出数据源的示例：

```
public void ListODBCsources()
    {
        int envHandle=0;
        const int SQL_FETCH_NEXT = 1;
        const int SQL_FETCH_FIRST_SYSTEM = 32;

        if (OdbcWrapper.SQLAllocEnv(ref envHandle) != -1)
        {
            int ret;
            StringBuilder serverName = new StringBuilder(1024);
            StringBuilder driverName = new StringBuilder(1024);
            int snLen = 0;
            int driverLen = 0;
            ret = OdbcWrapper.SQLDataSources(envHandle, SQL_FETCH_FIRST_SYSTEM, serverName, serverName.Capacity, ref snLen,
                        driverName, driverName.Capacity, ref driverLen);
            while (ret == 0)
            {
                System.Windows.Forms.MessageBox.Show(serverName + System.Environment.NewLine + driverName);
                ret = OdbcWrapper.SQLDataSources(envHandle, SQL_FETCH_NEXT, serverName, serverName.Capacity, ref snLen,
                        driverName, driverName.Capacity, ref driverLen);
            } 
        }

    } 
```

第一次调用 SQLDataSources`SQL_FETCH_FIRST_SYSTEM`告诉函数以 System-DSN 开始列表。如果您只是从它开始，`SQL_FETCH_NEXT`它将首先列出驱动程序。[链接到 Microsoft 网站上的功能参考](http://msdn.microsoft.com/en-us/library/ms711004(VS.85).aspx)

编辑：
每个人似乎都知道，但我昨天在一个新项目中使用此代码时才发现：如果您在 64 位 Windows 上使用 VS 编译它，您必须将“目标平台”设置为“x86”或代码不会运行。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-09-21T09:06:25.760

我使用以下代码从注册表中检索 DSN：

```
 private List<string> EnumDsn()
    {
        List<string> list = new List<string>();
        list.AddRange(EnumDsn(Registry.CurrentUser));
        list.AddRange(EnumDsn(Registry.LocalMachine));
        return list;
    }

    private IEnumerable<string> EnumDsn(RegistryKey rootKey)
    {
        RegistryKey regKey = rootKey.OpenSubKey(@"Software\ODBC\ODBC.INI\ODBC Data Sources");
        if (regKey != null)
        {
            foreach (string name in regKey.GetValueNames())
            {
                string value = regKey.GetValue(name, "").ToString();
                yield return name;
            }
        }
    } 
```

奇怪的是，“ODBC 数据源”键的名称不是英文的……我有一个法文版的 Windows，名称仍然是英文

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T21:02:50.830

我认为 .NET 中没有任何内容，快速检查（本机）ODBC API 会显示一些可能有帮助的功能：

*   SQLBrowseConnec
*   SQL 驱动程序

鉴于 ODBC API 中使用缓冲区的方式，需要仔细固定字符数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-21T09:43:13.007

如果您使用的是 Windows 窗体应用程序（不是 Web 环境），则可以使用 Visual Studio 的“选择数据源”对话框。

它包含在一个组件中，可以轻松使用。

我在其中找到此信息的文章： [http ://www.mztools.com/articles/2007/MZ2007011.aspx](http://www.mztools.com/articles/2007/MZ2007011.aspx)

无论如何，我来自西班牙，我也使用 Registry 解决方案（特别是在 Web 应用程序中）。我从来没有找到一台机器用不同于英语的语言输入这些条目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-30T17:13:55.217

我知道这是一篇旧帖子，但对于 Windows 10 的价值，我发现位于 LocalMachine 节点而不是当前用户中的 ODBC 连接可能是 64 位的东西。

```
 RegistryKey reg = (Registry.LocalMachine).OpenSubKey("Software");
        reg = reg.OpenSubKey("ODBC");
        reg = reg.OpenSubKey("ODBC.INI");
        reg = reg.OpenSubKey("ODBC Data Sources");
        string instance = "";
        foreach (string item in reg.GetValueNames())
        {
            instance = item;
        } 
```

# java - 优化的网络图形绘制

> ID：562018
> 
> 赞同：11
> 
> 时间：2009-02-18T17:15:57.240
> 
> 标签：java, graph, server-side, graph-layout

看过[一些关于图表的](https://stackoverflow.com/questions/51574/good-java-graph-algorithm-library) [建议](https://stackoverflow.com/questions/555804/real-time-java-graph-chart-library)后，我想知道最适合我的问题的是什么。

我想将有向图呈现到浏览器中显示的 servlet/图片。应该对位置进行某种优化。最好不要依赖于 Swing。算法并不重要，因为图的结构是由业务逻辑决定的。也希望能够将标签添加到边缘。如果我可以将其作为 png/svg 提供，那将是最佳选择。

您会推荐哪个图书馆/服务？

澄清：

1）问题都是关于 Graphs - like [Directed Acyclic Graph](http://en.wikipedia.org/wiki/Directed_acyclic_graph) - NOT - [Charts](http://en.wikipedia.org/wiki/Chart)的。

2）flot，Google Charts - 无法绘制图表，只能绘制图表，还是我错过了什么？

3）不，我不需要交互

4) graphviz 会很好，但是 grappa java 库已经过时了，并且是建立在 swing/awt 之上的。虽然理论上可以将摇摆渲染到图像上，但在服务器应用程序中这不是我最喜欢的方式。

5) 可以使用不在本地托管图像的在线服务。

编辑：添加了指向 Wikipedia 的链接以阐明图形/图表术语

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-18T17:21:40.037

看看[graphviz](http://www.graphviz.org/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-28T19:27:01.463

[yFiles](http://www.yworks.com/en/products_yfiles_web_about.html)可能对此有用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-25T16:34:10.670

Graphviz 的点组件怎么样？它生成图形（不是图表），输出到 PNG 和 SVG，并支持标记边缘。您可以使用 dot 生成您需要的图像，并返回一个引用该图像的 img 标签。或者，您可以返回一个引用 URL 的 img 标记，该 URL 将生成必要的图形（或检索缓存副本）。这是点信息：

[http://www.graphviz.org/pdf/dotguide.pdf](http://www.graphviz.org/pdf/dotguide.pdf)

您还可以查看 WebDot，它显然是为此目的而设计的：

[http://www.graphviz.org/webdot/](http://www.graphviz.org/webdot/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-20T20:58:54.710

试试[aiSee](http://www.aisee.com/ "爱视")。它被各种基于 Web 的应用程序用于[数据挖掘](http://www.chilibot.net/ "辣椒机器人")、[静态程序分析](http://www.program-analysis.com/ "PAG/万维网")、[矩阵可视化](http://www.aisee.com/matrix2gdl/ "矩阵2GDL")、[网络分析](http://tyna.gersteinlab.org/tyna/ "tYNA")等等。它也被一些[MediaWikis](http://semeb.com/dpldemo/index.php?title=Wgraph "图形")用作他们的图形布局后端。

他们在 aiSee.com 上有一个庞大的[示例图表数据库。](http://www.aisee.com/graphs/ "示例 ai参见图表")看看这个。它支持边缘标签，导出到映射的 SVG 和 HTML，并且不依赖于 Swing。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-03T00:18:36.800

除了等待数周来了解将在一行代码中解决所有问题的魔术框架之外，还有另一种选择，就是自己编写一些代码来做你想做的事......（我不是说这是 10 分钟的工作，但可能是一两天，你在两周前发布了你的问题......）

例如，您是否看过维基百科关于[基于力的算法](http://en.wikipedia.org/wiki/Force-based_algorithms)的条目——它有伪代码和一些可能有用的链接。

我假设问题在于布局算法，而不是创建 BufferedImage、绘制到其图形上下文、对其进行 PNG 编码并将其发送到套接字的问题。你真的不需要一个框架*，*我不认为。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-07-23T12:33:52.580

对于**服务器端**，试试[JUNG](http://jung.sourceforge.net/)，你可以针对[Batik](http://xmlgraphics.apache.org/batik)运行它并生成漂亮的 SVG 或 PNG 文件。JUNG 有一个很好的设计和非常强大的布局算法......

此外，由于您提到“使用***在线服务****会很好”***，graphviz 提供了一个名为[webdot](http://www.research.att.com/~north/cgi-bin/webdot/webdot.cgi)的服务来呈现图形。**

 **沿着这条线还有其他......例如[http://graph.gafol.net/](http://graph.gafol.net/)（似乎已经关闭）

**客户端：**

*   尝试[http://arborjs.org/](http://arborjs.org/)一个专门用于布局的最小（ish）库，使用它是您喜欢自己的渲染例程（div、canvas、svg、paper.js、处理......等） .

*   我也喜欢[http://sigmajs.org/](http://sigmajs.org/)以获得更完整的方法，内置触摸支持、插件、文件格式等。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-01-23T20:02:07.597

我们为此类需求创建[了 mxGraph](http://www.jgraph.com)。我们确实在 2006 年发布了它，但花了一段时间才注意到这个问题......

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-11-06T23:44:23.593

有趣的是，Eclipse 项目有一个 SWT/JFace 组件/框架，能够以纯 Java 显示和生成（导入/导出）Graphviz 的“DOT”格式：

[ZEST（主页和下载链接）](http://wiki.eclipse.org/Zest)

有关使用示例，请参阅[http://wiki.eclipse.org/Graphviz_DOT_as_a_DSL_for_Zest](http://wiki.eclipse.org/Graphviz_DOT_as_a_DSL_for_Zest)。

尽管 ZEST 被吹捧为 Eclipse 插件，但 DOT 操作 API 似乎可以独立使用，也可以在 Eclipse 安装外部使用。

干杯

富有的

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-04-25T22:35:19.157

你可以试试 sigma.js：[http ://sigmajs.org/](http://sigmajs.org/)

它是一个轻量级的 Javascript 开源库，用于在 Web 上显示大型图形。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-02T09:37:00.803

[JPGD](http://www.alexander-merz.com/graphviz/)是 Java 中的 Graphviz 解析器。它*有点*被遗弃了，但代码很好而且清晰，如果你发现错误，我相信作者会接受贡献的修复。

虽然宣传为解析器，但它也是一个生成器。您可以将 Graph 构建为 Node 和 Edge 对象的集合，然后使用 Graph.toString() 获取 .dot。将其作为图形将是 Graphviz dot 可执行文件的简单外壳。

或者，点很容易自己生成。在最简单的情况下，只需编写一个盆栽标题即可

```
digraph myGraph { 
```

...后跟每条边的一个边定义

```
node1 -> node2 ; 
```

...后跟一个右大括号

```
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-02T23:15:56.077

所以我查看了所有给定的答案和链接，看起来[Prefuse](http://prefuse.org/) / [Flare](http://flare.prefuse.org)将是最佳选择。它们具有非常吸引人的可视化，此外它们还内置了对图表的支持。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-18T17:20:18.417

也许看看[谷歌图表](http://code.google.com/apis/chart/)？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-25T17:03:01.117

您可以将 SVG 与 Batik 结合使用。我已经多次使用它来显示图形。使用 Java 1.5 的 Batik 非常快。使用此解决方案，您可以使用 Java 对图形进行编程，而无需依赖 Swing。您可以在需要的位置添加标签，将其托管为 Servlet 并将其显示为 png 或 svg。

您可以在 SVG 中创建图形（这是一个 XML 文档）。
您使用[Batik](http://xmlgraphics.apache.org/batik/)将 SVG 文档转换为 PNG/JPG 图像。
您可以使用 Servlet 将此图像流式传输回浏览器。

在 java 中，您构建一个 SVG(=XML) 文档。可以在此处找到 SVG 图的示例 ：有向[图](http://www.nationmaster.com/encyclopedia/Image:Directed-graph.svg)和此处：[简单有向图](http://en.wikiversity.org/wiki/File:Simple_directed_graph.svg)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-02T09:27:07.647

看到[这个问题](https://stackoverflow.com/questions/345549/what-algorithms-are-good-for-interactive-realtime-graph-drawing)，尤其是斯蒂芬关于 prefuse 的回答。我读到您不需要交互性，但 prefuse 仍然可能有用。

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2009-02-18T17:28:05.230

我可以全心全意地推荐[flot](http://code.google.com/p/flot/) - 太棒了！

请参阅[此处的示例](http://people.iola.dk/olau/flot/examples/)。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2009-02-25T14:38:45.050

[JFreeChart](http://www.jfree.org/)可能是您想要的方式，但您要区分图表和图形。也许你可以解释你的意思。我通常将这些术语用作同义词。:)

JFreeChart 有很好的散点图、条形图和折线图，还有像 Pie 和 Dial 这样有趣的图，所以也许它对你有用。

# vb.net - 从项目参考中获取类型以出现在智能感知中的问题

> ID：562027
> 
> 赞同：0
> 
> 时间：2009-02-18T17:17:36.503
> 
> 标签：vb.net, visual-studio, visual-studio-2008, namespaces, reference

我收到一个编译器错误，提示“Acme.Business.User”未定义。

我有一个名为“Acme.Business”的类库项目，其中“Acme.Business”作为程序集名称和根命名空间。没有一个类使用“Namespace”关键字，所以它们都应该存在于命名空间“Acme.Business”中。

我还有一个名为“Acme.Web”的类库项目，其中包含对“Acme.Business”的项目引用。同样，“Acme.Web”是项目名称、程序集名称和根命名空间。

这是奇怪的部分。如果我向“Acme.Web”添加一个类，我可以输入“Imports Acme”。在顶部并看到两个命名空间都出现在智能感知中，就像你期望的那样，但是如果我尝试执行“Dim x as New Acme.Business.User”，那么“商业”不会出现在智能感知中，我会收到一条错误消息“Acme.Business.User”未定义。

我看不出我做错了什么！请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T17:35:29.580

我认为您可能误解了项目默认命名空间的工作方式。默认命名空间是一个项目文件设置，它只是告诉 Visual Studio 在向项目添加新类文件时要向每个文件添加的命名空间。如果您从代码文件中删除了所有这些命名空间，那么您的类型不存在于该命名空间中。

这意味着您在 Acme.Business 程序集中的所有类型都位于全局命名空间中，这可能不是您想要的。为了获得所需的行为，您需要将命名空间重新添加到代码文件中，因为这是编译器使用该命名空间创建类型名称的唯一方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T20:07:40.557

好的，我发现我看到的行为是因为我在 Acme.Web 的代码中声明命名空间，就像我在 C# 中习惯的那样，即完全限定它。**命名空间 Acme.Web.UI.WebControls**。我没有意识到在 VB.NET 中它是在为根命名空间指定的内容之上构建的。我删除了在我的项目的“根名称空间”设置中指定的部分，它开始工作。所以我在 Acme.Web 代码中的命名空间现在看起来像**Namespace UI.WebControls**。

# .net - 在 Vista 中停止滚动条淡入淡出（.NET 或 WinAPI）

> ID：562029
> 
> 赞同：0
> 
> 时间：2009-02-18T17:18:04.850
> 
> 标签：.net, winforms, windows-vista, scrollbar

有谁知道有什么方法可以抑制滚动条上的 Vista 淡入淡出动画？

我只想暂时这样做，我不认为子类化是一种选择，因为滚动条是由自动滚动功能生成的“自动”滚动条（它是一个 .NET 应用程序，但我认为互操作是必需的）。

我想这样做的原因是因为控件的内容可以（并且将会）改变并导致垂直滚动条被自动隐藏。但是 - 这就是让我发疯的部分 - 如果用户在过去 1-2 秒内将鼠标悬停在滚动条上并且动画仍在进行中，那么滚动条会隐藏但动画仍然会继续并留下幽灵图像，因此 SB 似乎仍然存在，即使它确实不存在（无法单击它，并且最小化/恢复表单使其完全消失）。

我认为 Vista 使用某种计时器来制作这个动画，并希望可能有一些新的 API 来停止计时器（不幸的是，谷歌对此没有帮助）。或者，如果其他人遇到过这个问题并且知道解决它的不同方法，那也很棒。

在此先感谢，
亚伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-08-30T06:34:34.897

这篇文章中的解决方法对我有用：

[http://social.msdn.microsoft.com/Forums/en/vcgeneral/thread/88abdb31-651b-4b47-ae24-8b923344c349](http://social.msdn.microsoft.com/Forums/en/vcgeneral/thread/88abdb31-651b-4b47-ae24-8b923344c349)

帖子中的示例使用 C++，但这里有一些 C# 代码说明了我如何通过 pinvoke 在 .NET 中使用它（在 Control 子类中工作......）

```
protected override void OnSizeChanged(EventArgs e)
{
    if (_vScrollVisible != VerticalScroll.Visible)
    {
        _vScrollVisible = VerticalScroll.Visible;

        if (!_vScrollVisible)
        {

            if (NativeMethods.IsThemeActive())
            {
                // Fix scrollbar fade issue                
                NativeMethods.SetWindowTheme(Handle, null, null);
            }
        }
    }
}

internal static class NativeMethods
{      
    [DllImport("uxtheme.dll", CharSet = CharSet.Unicode)]
    public static extern bool IsThemeActive();

    [DllImport("uxtheme.dll", ExactSpelling = true, CharSet = CharSet.Unicode)]
    public static extern int SetWindowTheme(IntPtr hWnd, String pszSubAppName, String pszSubIdList);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T05:58:27.627

有任何理由有滚动条吗？您可以在不使用任何 Win32 API 技巧的情况下关闭它们，同时还可以设置窗口大小以适当地处理动画（或缩放动画）。

我认为您唯一的其他选择是滚动您自己的 Window 对象，这将是一种皇家痛苦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T10:03:06.947

这是我也想知道的效果。

我编写了一个从 ContainerControl 派生的控件，其中子控件可以通过用户交互来增长或缩小。所以我花了一些时间设置自己的 LayoutEngine 来获取子控件所需的布局。但即使是这个动画不间断的 SB 也是肮脏的。我有一个解决方法——请不要把它当作解决方案——在布局方法中，我在进行布局之前将焦点设置在容器控件上。这对我行得通...

rp

另一种解决方法...

```
is to inherit from the ScrollableControl (Panel, ...) and to 
```

覆盖 WndProc 方法并使用 PreventScrollAnimation 方法。这将吃掉所有在滚动条中有命中测试的 WM_NCMOUSEMOVE 消息。所以这将防止内部开始滚动条的褪色。顺便说一句，衰落是在 VISTA-UI 中使用计时器回调实现的，因此不可能停止它。

```
const int WM_NCMOUSEMOVE = 160;
const int HTHSCROLL = 6;
const int HTVSCROLL = 7;

bool PreventScrollAnimation(ref Message m)
{
    if (m.Msg == WM_NCMOUSEMOVE)
    {
        if ((m.WParam.ToInt32() == HTHSCROLL) ||
            (m.WParam.ToInt32() == HTVSCROLL))
        {
            m.Result = IntPtr.Zero;
            return true;
        }
    }
    return false;
}

protected override void WndProc(ref Message m)
{
    if (PreventScrollAnimation(ref m))
        return;

    base.WndProc(ref m);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T07:39:49.447

如果您指的是应用程序或系统范围内的滚动条，这个问题并不完全清楚。如果您指的是系统范围，那么除了为您的整个计算机设计一个全新的主题之外，我不确定您还能做什么。但是，如果您指的是仅更改您自己的应用程序，则可以使用 WPF 控件模板修改滚动条行为以执行您所描述的操作。

如果您有 Expression Blend，这很容易做到，因为它可以创建默认滚动条的副本，您可以根据自己的喜好对其进行修改（例如在这种情况下将淡入淡出的时间更改为零）。[此链接](http://www.designerwpf.com/2008/08/26/styling-a-silverlight-scrollviewer-to-look-like-a-mac-scrollviewer/ "这个链接")并不完全是您正在寻找的内容，但它应该让您了解其中可能涉及的内容。

如果您没有 Expression Blend，仍然可以手动编写相同的代码，因为它只是 XAML 文本（即使 Blend 生成它），但学习如何这样做需要更多的努力。

*Windows Presentation Foundation Unleashed*的第 15 章（一本好书，原因有很多）解释了如何在 Win32 和 Windows 窗体应用程序中使用 WPF，并将其用作 Win32 和 Windows 窗体应用程序的宿主，如果您无法将整个应用程序移植到 WPF 但仍想移植，这很方便有选择地使用一些 WPF 功能。

# scripting - 在批处理脚本中转义双引号

> ID：562038
> 
> 赞同：105
> 
> 时间：2009-02-18T17:19:38.853
> 
> 标签：scripting, parameters, batch-file, escaping, quotes

我将如何用转义的双引号替换批处理文件参数中的所有双引号？这是我当前的批处理文件，它在字符串中扩展了它的所有命令行参数：

```
@echo off
call bash --verbose -c "g++-linux-4.1 %*" 
```

然后它使用该字符串调用 Cygwin 的 bash，执行 Linux 交叉编译器。不幸的是，我将这些参数传递到我的批处理文件中：

```
"launch-linux-g++.bat" -ftemplate-depth-128 -O3 -finline-functions 
-Wno-inline -Wall  -DNDEBUG   -c 
-o "C:\Users\Me\Documents\Testing\SparseLib\bin\Win32\LinuxRelease\hello.o" 
"c:\Users\Me\Documents\Testing\SparseLib\SparseLib\hello.cpp" 
```

传入的第一个路径周围的第一个引号过早地结束了传递给 GCC 的字符串，并将其余参数直接传递给 bash（这非常失败。）

我想如果我可以将参数连接成一个字符串然后转义引号它应该可以正常工作，但我很难确定如何做到这一点。有人知道吗？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-02-18T17:31:53.803

批处理脚本中的转义字符是`^`. 但是对于双引号字符串，双引号：

```
"string with an embedded "" character" 
```

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2015-07-14T17:45:13.877

[eplawless 自己的回答](https://stackoverflow.com/questions/562038/escaping-double-quotes-in-batch-script#562131)简单有效地解决了他的具体问题：它将`"`整个参数列表中的所有实例替换为`\"`，这就是 Bash 需要在双引号字符串中使用双引号来表示的方式。

要普遍回答如何使用Windows 命令行解释器**在双引号字符串中转义双引号的问题（无论是在命令行上 - 通常仍被错误地称为“DOS 提示符” - 还是在批处理文件中）：`cmd.exe`**^(请参阅底部以了解*PowerShell*。)

**tl;博士**：

**答案取决于*您调用的程序*：**

*   将参数传递**给（另一个）*****批处理文件******时******必须*使用`""`**，并且可以与**使用*****Microsoft*****的 C/C++/.NET 编译器**（*也*接受）**创建的应用程序一起**使用，在 Windows 上**包括 Python、Node.js**和**PowerShell （核心）7+ 的****[CLI](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_pwsh)**（）但*不是 Windows PowerShell 的*（）：****`""`******`\"`**`pwsh`*`powershell.exe`*******

     ******   例子：`foo.bat "We had 3"" of rain."`***** 
******   以下内容仅适用于定位**批处理文件**：

    *   `""`是让命令解释器 ( `cmd.exe`) 将整个双引号字符串视为*单个*参数的唯一方法（尽管如果您只是将*所有*参数*传递*给另一个程序，`%*`使用

    *   然而，遗憾的是，不仅保留了封闭的双引号（像往常一样），而且双引号也保留了，因此获得预期的字符串是一个两步过程；例如，假设双引号字符串作为第一个参数传递，`%1`：

        *   `set "str=%~1"`删除封闭的双引号；`set "str=%str:""="%"`然后将双引号转换为单引号。
            请务必在分配部分周围使用封闭的双引号，以防止对值进行不必要的解释。*   **`\"`是许多其他程序****（例如，Ruby、Perl、PHP 以及使用 [`CommandLineToArgv`](https://docs.microsoft.com/en-us/windows/win32/api/shellapi/nf-shellapi-commandlinetoargvw)Windows API 函数解析其命令行参数的程序）所***必需*****的 - 作为*****唯一*****选项，但它使用 from`cmd.exe`并不*健壮和安全***：**

     ***   `\"`是许多可执行文件和解释器*需要*的——包括 Windows PowerShell——当*从外部*传递字符串时，在命令行上——或者，在**微软的编译器的情况下，支持*作为替代方案* `""`**——不过，最终**取决于目标程序解析参数列表。**
        *   例子：`foo.exe "We had 3\" of rain."`
    *   **但是，使用`\"`can*中断*调用并至少假设会导致不必要的、任意执行命令和/或输入/输出重定向**：
        *   以下字符存在此风险：`& | < >`
        *   例如，以下结果会导致`ver`命令的意外执行；请参阅下面的进一步解释和解决方法的下一个要点：
            *   `foo.exe "3\" of snow" "& ver."`
    *   **对于调用*Windows PowerShell* [CLI](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_powershell_exe)，`powershell.exe`和是强大但有限的替代方法`\""`（`"^""`**请参阅下面的“调用 PowerShell 的 CLI ...”部分）。** ***   **如果你必须使用`\"`from `cmd.exe`，只有 3 种*安全*的方法 from`cmd.exe`**，但是**很麻烦**：^(向[TS 致敬](https://stackoverflow.com/users/2770331/t-s)以寻求帮助。)

    *   **在批处理文件中使用（可能是*选择性*的）延迟变量扩展**，您可以**将文字存储`\"`在*变量*中并使用语法在`"..."`字符串中引用该变量`!var!`**- 请参阅[T S 的有用答案](https://stackoverflow.com/a/44169953/45375)。

        *   上述方法尽管很麻烦，但其优点是您可以*有条不紊地*应用它，并且它可以在任何输入下*稳健地工作。*
    *   **只有使用 LITERAL 字符串 - 不涉及 VARIABLES 的字符串 - 你会得到类似的有条不紊的方法： categorically `^`-escape *all* `cmd.exe` metacharacters:** `" & | < >`和 - 如果你还想抑制变量扩展 - `%`：
        `foo.exe ^"3\^" of snow^" ^"^& ver.^"`

    *   否则，您必须**根据识别字符串的哪些部分由于被误解`cmd.exe`*`\"`****为关闭分隔符而被**视为*****未引用来制定您的字符串：****

         **   在包含 shell 元字符 的*文字*`^`部分中： -转义它们；使用上面的例子，它`&`必须是`^`-转义的：
            `foo.exe "3\" of snow" "^& ver."`

        *   在*带有`%...%`-style 变量引用*的部分中：确保将`cmd.exe`它们视为`"..."`字符串的一部分，*并且*变量值本身没有嵌入的不平衡引号 -**这甚至并不总是可能的**。******** 

 ***** * *

### 背景

^(注意：这是基于我自己的实验。如果我错了，请告诉我。)

类 POSIX 的 shell，例如**类 Unix 系统上的 Bash，在将参数***单独*传递给目标程序之前对参数列表（字符串）进行标记：在其他扩展中，它们将参数列表拆分为单个单词（分词）并从结果词（引号删除）。**目标程序将收到一*组*单独的*逐字参数***，即删除了***句法*引号**。

**相比之下，Windows 命令解释器显然不会对参数列表进行标记，而只是传递包含*所有参数的**单个*字符串- 包括引用字符。- 到目标程序。** *但是，在将单个字符串传递给目标程序之前会进行*一些*`^`预处理：转义字符。双引号之外的字符串被删除（它们转义以下字符。），变量引用（例如，`%USERNAME%`）首先被*插值*。*

 *因此，与 Unix 不同，目标程序负责解析参数字符串并将其分解为去掉引号的单个参数。因此，**不同的程序可能需要不同的转义方法**，并且**没有单一的转义机制可以*保证*适用于所有程序**- ^(https://stackoverflow.com/a/4094897/45375 包含关于 Windows 命令行解析的无政府状态的优秀背景.)

**在实践中，`\"`这是非常常见的，但不是安全的`cmd.exe`**，如上所述：

由于`cmd.exe`它本身不能识别`\"`为*转义*的双引号，因此它可能会将命令行上的后续标记误解为*未引用*，并可能将它们解释为*命令*和/或*输入/输出重定向*。
**简而言之：问题浮出水面，如果以下任何字符跟随一个*开口或不平衡* `\"`：`& | < >`** ; 例如：

```
foo.exe "3\" of snow" "& ver." 
```

`cmd.exe`看到以下标记，这是由于误解`\"`为常规双引号引起的：

*   `"3\"`
*   `of`
*   `snow" "`
*   休息：`& ver.`

由于`cmd.exe`认为那`& ver.`是*unquoted*，它将其解释为`&`（命令序列运算符），后跟要执行的命令的名称（`ver.`-`.`被忽略；`ver`报告`cmd.exe`的版本信息）。
整体效果是：

*   首先，仅使用前*3 个*标记`foo.exe`调用。
**   然后，执行命令`ver`。*

 *即使在意外命令没有伤害的情况下，您的整体命令也不会按设计工作，因为并非所有参数都传递给它。

**许多编译器/解释器只识别`\"`**- 例如，GNU C/C++ 编译器、Perl、Ruby、PHP，以及使用 [`CommandLineToArgv`](https://docs.microsoft.com/en-us/windows/win32/api/shellapi/nf-shellapi-commandlinetoargvw)Windows API 函数解析其命令行参数的程序 - 对他们**来说，没有简单的解决方案问题。**
本质上，您必须事先知道命令行的哪些部分被误解为未引用，并有选择地`^`转义这些部分中的所有实例`& | < >`。

相比之下，**使用`""`is SAFE**，但**遗憾的是仅支持基于 Microsoft 编译器的可执行文件和批处理文件**（在批处理文件的情况下，具有上面讨论的怪癖），值得注意的是不包括*PowerShell* - 请参阅下一节。

* * *

### `cmd.exe`从类似 POSIX 的 shell调用 PowerShell 的 CLI ：

*注意：有关如何在*PowerShell中处理引用，请参阅底部部分。

**从外部**调用时- 例如， from `cmd.exe`，无论是从命令行还是批处理文件：

*   ***PowerShell [Core] v6+*现在可以正确识别`""`**（除了`\"`），它既可以**安全使用又可以保留空白**。

    *   `pwsh -c " ""a & c"".length "`不会破坏并正确产生`6`
*   ***Windows PowerShell***（最新和*最终*版本为 5.1 的旧版） ***仅*****识别or *`\"``"""`****，后者是 , 形式中***最*****可靠****的选择*`cmd.exe`*`"^"""`**（即使*内部*PowerShell 使用```双引号字符串中的转义字符并且也接受`""`- 请参阅底部），如下所述：*

 ***从**/ 批处理文件调用***Windows PowerShell ：*** **`cmd.exe`**

*   **`""` *break***，因为它基本上不受支持：

    *   `powershell -c " ""ab c"".length "`-> 错误“字符串缺少终止符”
*   `\"`***原则上***工作`"""` **，但*不安全*****：**

     ***   `powershell -c " \"ab c\".length "`按预期工作：它输出`5`（注意*2 个*空格）
    *   但这并不安全，因为`cmd.exe`元字符会破坏命令，除非转义：
        `powershell -c " \"a& c\".length "` *breaks*，由于`&`，必须将其转义为`^&`** 
***   `\""`是***安全*的，但*规范化内部空白***，这可能是不希望的：

    *   `powershell -c " \""a& c\"".length "`输出`4`(!)，因为 2 个空格被归一化为 1。

    *   **`"^""`*特别是Windows PowerShell*的最佳选择，**它既安全又保留空白，但**对于 PowerShell *Core*（在 Windows 上），它与 相同`\""`**，即空白*规范化*（如上所述，只需`""`在此处使用）。[归功于 Venryx](https://stackoverflow.com/users/2441655/venryx)发现了这种方法。

    *   `powershell -c " "^""a& c"^"".length "` *作品*：不会破坏 - 尽管`&`-*和*输出`5`，即正确保留的空白。

    *   PowerShell *Core* :`pwsh -c " "^""a& c"^"".length "` *有效*，但输出`4`，即*标准化空白*，就像`\""`这样。** 

 **在**类 Unix 平台**（Linux、macOS）上，当从类 POSIX 的 shell 调用**PowerShell [Core]**的 CLI 时，`pwsh`例如`bash`：

您***必须*使用`\"`**，但是**它既安全又保留空白**：

```
$ pwsh -c " \"a&  c|\".length" # OK: 5 
```

* * *

### 相关信息

*   **`^`只能用作不带引号的字符串中的转义字符***- 在双引号字符串中，***不*****特殊**`^`并被视为文字。*

     **   **CAVEAT**：**传递给****语句****的 in 参数的使用`^``call`**被破坏（这适用于以下两种用法`call`：调用另一个批处理文件或二进制文件，以及调用同一批处理文件中的子例程）：
        *   **`^`*双引号*中的实例被*莫名其妙地加倍***，改变了传递的值：例如，如果变量`%v%`包含文字值`a^b`，则将(!)`call :foo "%v%"`分配给子例程中的（第一个参数）。`"a^^b"``%1``:foo`
        *   ***不带引号*的`^`with使用完全`call`被*破坏*，因为`^`它不能再用于转义特殊字符**：例如，`call foo.cmd a^&b`悄悄地中断（而不是传递文字`a&b`就像`foo.cmd`没有 的情况一样`call`） -`foo.cmd`甚至从未调用（！），至少在 Windows 上7.* 
**   **不幸的是，转义文字`%`是一种特殊情况**，它**需要不同的语法，具体取决于字符串是在*命令行*还是*在批处理文件***中指定的；见[https://stackoverflow.com/a/31420292/45375](https://stackoverflow.com/a/31420292/45375)

    *   简而言之：在批处理文件中，使用`%%`. 在命令行中，`%`不能进行转义，但如果将 a放在不带*引号*的字符串（例如， ）`^`的开头、结尾或变量名内部，可以防止变量扩展（插值）；命令行上不属于变量引用的实例被视为文字（例如，）。*`echo %^foo%``%``100%`*
    **   通常，**要安全地使用可能包含空格和特殊字符的变量值**：

    *   **赋值**：**将变量名和值括在一*对**双*引号中**；例如，`set "v=a & b"`将文字值分配`a & b`给变量`%v%`（相比之下，`set v="a & b"`会使双引号成为值的一部分）。将文字`%`实例转义为`%%`（仅适用于批处理文件 - 见上文）。
    *   **参考**：**双引号变量引用**以确保它们的值没有被插值；例如，`echo "%v%"`不会对 的值`%v%`进行插值和打印`"a & b"`（但请注意，双引号也总是会打印）。相比之下，`echo %v%`将文字传递`a`给`echo`，解释`&`为命令序列运算符，因此尝试执行名为 的命令`b`。
        还要注意上面的警告重用`^`with`call`语句。
        *   *外部*程序通常负责删除参数周围的双引号，但如前所述，在批处理文件中您必须自己做（例如，`%~1`从第一个参数中删除双引号），遗憾的**是，没有直接的我知道在*没有*封闭双引号的情况下`echo`忠实地打印变量值***的方式。

            *   [Neil](https://stackoverflow.com/users/182705/neil)提供**了一个`for`基于 - 的解决方法，*只要该值没有嵌入双引号就可以使用***；例如：
                `set "var=^&')|;,%!" for /f "delims=" %%v in ("%var%") do echo %%~v`* 

    **   **`cmd.exe`不*将**单*引号识别**为字符串分隔符 ( `'...'`) - 它们被视为文字，通常不能用于分隔带有嵌入空格的字符串；同样，紧靠单引号的标记和介于两者之间的任何标记都被视为未引用`cmd.exe`并相应地解释。

    *   然而，鉴于目标程序最终会执行自己的参数解析，一些程序（例如 Ruby）即使在 Windows 上也能识别单引号字符串。相比之下，C/C++ 可执行文件和 Perl*无法*识别它们。
        但是，即使目标程序支持，也不建议使用单引号字符串，因为它们的内容不受`cmd.exe`.***

 *** * *

### *从*PowerShell中引用：

[Windows PowerShell](https://en.wikipedia.org/wiki/Windows_PowerShell)是一个比 PowerShell 高级得多的 shell `cmd.exe`，它多年来一直是 Windows 的一部分（[PowerShell Core](https://github.com/PowerShell/PowerShell)也将 PowerShell 体验带到了 macOS 和 Linux）。

PowerShell在引用方面始终在*内部工作：*

*   在双引号字符串中，使用``"`或`""`转义双引号
*   在单引号字符串中，用于`''`转义单引号

*这适用于 PowerShell 命令行以及从*PowerShell 中将参数传递给 PowerShell 脚本或函数时。

（如上所述，将转义的双引号*从外部*传递给 PowerShell需要`\"`，或者更稳健地`\""`- 没有其他方法）。

**遗憾的是，当从 PowerShell 调用*外部*程序时，您既需要适应 PowerShell 自己的引用规则*，又*需要为*目标*程序转义：**

*   [此答案](https://stackoverflow.com/a/66837948/45375)中也讨论和总结了这种有问题的行为；PowerShell Core 7.2.0-preview.5 中引入的[*实验性*](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_Experimental_Features) 功能 - 假设它成为官方功能 - 将至少为那些接受.`PSNativeCommandArgumentPassing` `\"`

***双*引号内的*双*引号字符串**：

考虑 string `"3`" of rain"`，它在 PowerShell 内部转换为 literal `3" of rain`。

如果要将此字符串传递给外部程序，***除了*****PowerShell 的**;之外，**还必须应用目标程序的转义。***假设您想将字符串传递给 C 程序，该程序期望嵌入的双引号被转义为`\"`：*

 *```
foo.exe "3\`" of rain" 
```

请注意- 让 PowerShell 快乐 -*和* *-*让目标程序快乐 - 必须存在。``"`*`\`*

 *相同的逻辑适用于调用批处理文件，其中`""`必须使用：

```
foo.bat "3`"`" of rain" 
```

相比之下，**在*****双*****引号字符串中嵌入*****单****引号根本不需要转义。*

 ****单*引号字符串****中的****单***引号不需要额外*的*转义；考虑`'2'' of snow'`，这是 PowerShell 的`2' of snow`.*

 *```
foo.exe '2'' of snow'
foo.bat '2'' of snow' 
```

PowerShell 在将单引号字符串传递给目标程序之前将其转换为双引号字符串。

但是，***单*****引号字符串中的*****双*引号，对于****PowerShell*不需要转义，但对于*目标程序*仍然需要转义：*

 *```
foo.exe '3\" of rain'
foo.bat '3"" of rain' 
```

PowerShell **v3**引入了魔术**`--%`选项**，称为*停止解析符号*，它通过将未*解释*的任何内容传递给目标程序来减轻一些痛苦，除了扩展的*-style*`cmd.exe`环境变量引用（例如，`%USERNAME%`）；例如：

 *```
foo.exe --% "3\" of rain" -u %USERNAME% 
```

请注意，仅对目标程序（而不是 PowerShell as ）转义嵌入式`"`as就足够了。`\"``\`"`

但是，这种方法：

*   不允许*转义* `%`字符以避免环境变量扩展。
*   禁止*直接*使用 PowerShell 变量和表达式；相反，命令行必须在第一步中构建在字符串变量中，然后`Invoke-Expression`在第二步中调用 with。

解决此问题的*另一种*解决方法* 是使用包含*整个命令行*`cmd /c`的单个参数调用 via ：

 *```
cmd /c "foo.exe `"3\`" of rain`" -u $env:USERNAME" 
```

* * *

因此，尽管 PowerShell 取得了许多进步，但在调用*外部程序*时并没有让转义变得更容易——相反。但是，它引入了对单引号字符串的支持。

如果您不介意安装第三方模块（由我编写），该[`Native`模块](https://github.com/mklement0/Native)（视窗：`Install-Module Native``ie`

```
# Simply prepend 'ie' to your external-program calls.
ie foo.exe '3" of rain' -u $env:USERNAME 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-02-18T17:48:17.680

谷歌最终想出了答案。批量替换字符串的语法是这样的：

```
set v_myvar=replace me
set v_myvar=%v_myvar:ace=icate% 
```

这会产生“复制我”。我的脚本现在看起来像这样：

```
@echo off
set v_params=%*
set v_params=%v_params:"=\"%
call bash -c "g++-linux-4.1 %v_params%" 
```

它替换了`"`with的所有实例，`\"`为 bash 正确转义。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-05-24T23:19:05.407

作为[mklement0 出色答案](https://stackoverflow.com/a/31413730/45375)的补充：

几乎所有可执行文件都接受`\"`转义的`"`. 然而，在 cmd 中的安全使用几乎只有使用 DELAYEDEXPANSION 才能实现。要显式地向某个进程
发送文字，请分配给环境变量，然后在需要传递引号时使用该变量。例子：`"``\"`

```
SETLOCAL ENABLEDELAYEDEXPANSION
set q=\"
child "malicious argument!q!&whoami" 
```

注意`SETLOCAL ENABLEDELAYEDEXPANSION`似乎只在批处理文件中起作用。要在交互式会话中获得 DELAYEDEXPANSION，请启动`cmd /V:ON`.

如果您的批处理文件不适用于 DELAYEDEXPANSION，您可以暂时启用它：

```
::region without DELAYEDEXPANSION

SETLOCAL ENABLEDELAYEDEXPANSION
::region with DELAYEDEXPANSION
set q=\"
echoarg.exe "ab !q! & echo danger"
ENDLOCAL

::region without DELAYEDEXPANSION 
```

如果您想从包含转义引号的变量中传递动态内容，`""`您可以在展开时替换`""`为`\"`：

```
SETLOCAL ENABLEDELAYEDEXPANSION
foo.exe "danger & bar=region with !dynamic_content:""=\"! & danger"
ENDLOCAL 
```

`%...%`这种替换对于样式扩展是不安全的！

^(在[OP](https://stackoverflow.com/a/562131/2770331) `bash -c "g++-linux-4.1 !v_params:"=\"!"`的情况下是安全版本。)

* * *

如果出于某种原因甚至暂时无法启用 DELAYEDEXPANSION，请继续阅读：

`\"`如果总是需要转义特殊字符，而不是有时需要转义，则在 cmd 中使用from 会更安全一些。（如果它是一致的，它不太可能忘记插入符号......）

为了实现这一点，在任何引用之前都带有插入符号 ( `^"`)，应该作为文字到达子进程的引用必须另外使用反斜杠 ( `\^"`) 进行转义。**所有**shell 元字符也必须转义`^`，例如`&`=> `^&`; `|`=> `^|`; `>`=> `^>`; 等等

例子：

```
child ^"malicious argument\^"^&whoami^" 
```

资料来源：[每个人都以错误的方式引用命令行参数](https://blogs.msdn.microsoft.com/twistylittlepassagesallalike/2011/04/23/everyone-quotes-command-line-arguments-the-wrong-way/)，请参阅“更好的引用方法”

* * *

要传递动态内容，需要确保以下几点：
包含变量的命令部分必须被视为“引用” `cmd.exe`（如果变量可以包含引号，这是不可能的 -**不要写`%var:""=\"%`**）。为了实现这一点，`"`变量之前的最后一个和变量`"`之后的第一个不会被`^`转义。`"`不能转义这两者之间的 cmd 元字符。例子：

```
foo.exe ^"danger ^& bar=\"region with %dynamic_content% & danger\"^" 
```

**这是不安全的，如果`%dynamic_content%`可以包含不匹配的引号。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-20T08:35:47.253

如果字符串已经在引号内，则使用另一个引号来取消其操作。

```
echo "Insert tablename(col1) Values('""val1""')" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-29T22:07:33.333

在 Windows 10 21H1。

`.bat`如果我想从批处理 ( ) 文件运行 Everything 应用程序，我`"""`在双引号内使用参数：

`"C:\Program Files\Everything\Everything.exe" -search "<"""D:\My spaced folder""" | """Z:\My_non_spaced_folder"""> <*.jpg | *.jpeg | *.avi | *.mp4>"`

希望能帮助到你。

# sql-server - 如何使用二进制编写器为 Money 数据类型编写正确的 MS SQL 原生格式？

> ID：562042
> 
> 赞同：0
> 
> 时间：2009-02-18T17:21:34.200
> 
> 标签：sql-server, bulkinsert, currency, bcp

如何使用二进制编写器为 Money 数据类型编写正确的 MS SQL 原生格式？

我想在 .net 中取一个值，从文件中读取为十进制数的字符串表示形式（实际上是从 SQL 导出的“Money”数据类型，但这并不重要）。

如何使用二进制写入器写入值，以便您可以在本机格式模式下使用 BCP 或 BULK INSERT 成功读取值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T17:23:52.573

（其中 w 是先前实例化的二进制写入器）

```
 Dim dec = CDec(aString)
                    Dim lng = CLng(dec * 10000)
                    Dim bytes = BitConverter.GetBytes(lng)
                    w.Write(bytes(4))
                    w.Write(bytes(5))
                    w.Write(bytes(6))
                    w.Write(bytes(7))
                    w.Write(bytes(0))
                    w.Write(bytes(1))
                    w.Write(bytes(2))
                    w.Write(bytes(3)) 
```

可能有更清洁或更好的方法，但这似乎没问题

提醒一下，这种格式仅适用于 NON NULL 货币列，我认为你必须先写一个长度字节或类似的东西才能用于可空货币列

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-20T11:38:21.210

我不记得如何使用 BCP 对分隔文件中的数字类型执行空值，但我相信如果您使用长度前缀文件，长度值 -1 表示空值。

# iphone - 如何以编程方式更改（UITabViewController 的）选项卡？

> ID：562046
> 
> 赞同：11
> 
> 时间：2009-02-18T17:22:39.567
> 
> 标签：iphone, cocoa-touch

我正在尝试以编程方式选择/更改 UITabViewController 的选项卡。

我尝试通过以下方式进行：

```
self.tabBarController.selectedIndex = 2; 
```

这看起来是我应该这样做的方式，但它不起作用。我想也许 self.tabBarController 返回一个只读对象（我有点记得在某处读过），但我不知道如何让它工作。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-18T17:26:01.710

设置 selectedViewController：

```
self.tabBarController.selectedViewController = viewControllerYouWant; 
```

例如，

```
self.tabBarController.selectedViewController 
    = [self.tabBarController.viewControllers objectAtIndex:2]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T17:28:32.047

根据文档，`selectedIndex`或者`selectedViewController`是您想要的属性并且都是可分配的。

tabBarController 属性是只读的，但它返回一个可编辑的对象。

所以你所有的代码对我来说都是正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-23T12:48:17.760

如果你想按索引来做，这对我很有效。

```
[self.tabBarController setSelectedIndex:2]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-05T21:01:08.987

我正在做这样的事情：

```
[root setSelectedViewController: [root.historyController navController]]; 
```

# wcf - WCF 服务 webHttpBinding 匿名身份验证

> ID：562051
> 
> 赞同：0
> 
> 时间：2009-02-18T17:23:33.947
> 
> 标签：wcf, iis

我有一种情况，我在 IIS 中取消了匿名身份验证，因此设计人员和客户能够看到工作，但看不到其他人。我需要让 WCF 服务在这些条件下工作，但我不确定如何。

有谁知道我需要做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T17:35:40.407

您可以将凭据作为查询字符串附加到 URL。您的 WCF 服务（在消息检查器中）可以检查它以进行身份​​验证。您可能还想启用 https。

# .net - 我应该导航到相对 URI，还是导航到 WPF 中页面的新实例？

> ID：562054
> 
> 赞同：0
> 
> 时间：2009-02-18T17:24:11.793
> 
> 标签：.net, wpf, navigation

调用 frame.Navigate 和设置 frame.Source = new MyPage() 有什么区别吗？其中一个在内存使用方面是否更有效，并且在使用特定方法时框架的日志（后退，前进按钮）是否受到不同的影响？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T20:39:51.347

是的，有区别。您导航到的内容会被记录下来。这意味着，如果您导航到某个页面，只要它保留在导航历史记录中，整个页面就会在日志中保持活动状态。在记忆方面，导航到 Uri 会更好。请注意，WPF 中的导航系统和日志非常复杂，并且经常与生命周期管理不一致。这里有龙。在选择使用内置导航系统之前，尽可能多地了解这个主题。

# c# - 如何根据 C# 中的日期时间键获取列表的子集？

> ID：562056
> 
> 赞同：3
> 
> 时间：2009-02-18T17:25:23.367
> 
> 标签：c#, sorting, list

我有一个描述在某个时间发生的事件的元素列表，时间被表示为对象上的 Datetime 属性“StartTime”。我现在希望提取这些事件的子集，其中包含放置在两个 DateTime 实例 A、B 之间的间隔中的那些元素，使得 StartTime >= A && StartTime <= B。目前这是通过一个简单的 Linq 查询完成的，但是因为我必须运行大量查询来提取列表的一小部分，所以效率很低。

曾希望标准的 SortedList 类在键上具有某种子集功能，但似乎并非如此。有什么想法可以使用现有的框架类相对简单地存档，还是我必须基于 SortedList 进行某种自定义二进制搜索？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T17:40:58.880

如果可能的话，我会将实例保存在一个数组中，按 StartTime 排序，然后调用 BinarySearch 来确定数组中边界结束的索引。

然后，鉴于此，您可以轻松快速地访问基于日期范围的子集。

我已经制定了一个通用类，它也可以帮助你：

```
public class BinarySearcher<T>
{
    // Possibly passed to the call to BinarySort.
    private class ComparisonComparer : Comparer<T>
    {
        Comparison<T> comparison;

        internal static IComparer<T> Create(Comparison<T> comparison)
        {
            // If comparison is null, return the default comparer for T.
            if (comparison == null)
            {
                // Return the default.
                return Comparer<T>.Default;
            }

            // Return a new implementation.
            return new ComparisonComparer(comparison);
        }

        private ComparisonComparer(Comparison<T> comparison)
        {
            this.comparison = comparison;
        }

        public override int Compare(T x, T y)
        {
            return comparison(x, y);
        }
    }

    // The elements.
    T[] elements;

    // The IComparable implementation.
    IComparer<T> comparer;

    // Do not assume sorting.
    public BinarySearcher(IEnumerable<T> elements) : 
        this(elements, false, (IComparer<T>) null) { }

    // Use default comparer.
    public BinarySearcher(IEnumerable<T> elements, bool sorted) :
        this(elements, sorted, (IComparer<T>) null) { }

    // Assume no sorting.
    public BinarySearcher(IEnumerable<T> elements, 
        Comparison<T> comparer) :
            this(elements, false, 
                ComparisonComparer.Create(comparer)) { }

    // Convert to IComparable<T>.
    public BinarySearcher(IEnumerable<T> elements, bool sorted, 
        Comparison<T> comparer) :
            this(elements, sorted, 
                ComparisonComparer.Create(comparer)) { }

    // No sorting.
    public BinarySearcher(IEnumerable<T> elements, 
        IComparer<T> comparer) :
            this(elements, false, comparer) { }

    // Convert to array.
    public BinarySearcher(IEnumerable<T> elements, bool sorted, 
        IComparer<T> comparer) :
            this(elements.ToArray(), sorted, comparer) { }

    // Assume no sorting.
    public BinarySearcher(T[] elements) : this(elements, false) { }

    // Pass null for default comparer.
    public BinarySearcher(T[] elements, bool sorted) : 
        this(elements, sorted, (IComparer<T>) null) { }

    // Assume not sorted.
    public BinarySearcher(T[] elements, Comparison<T> comparer) :
        this(elements, false, ComparisonComparer.Create(comparer)) { }

    // Create IComparable<T> from Comparable<T>.
    public BinarySearcher(T[] elements, bool sorted, 
        Comparison<T> comparer) :
            this(elements, sorted, ComparisonComparer.Create(comparer)) { }

    // Assume the elements are not sorted.
    public BinarySearcher(T[] elements, IComparer<T> comparer) : 
        this(elements, false, comparer) { }

    public BinarySearcher(T[] elements, bool sorted, 
        IComparer<T> comparer)
    {
        // If the comparer is null, create the default one.
        if (comparer == null)
        {
            // Set to the default one.
            comparer = Comparer<T>.Default;
        }

        // Set the comparer.
        this.comparer = comparer;

        // Set the elements.  If they are sorted already, don't bother, 
        // otherwise, sort.
        if (!sorted)
        {
            // Sort.
            Array.Sort(elements, this.comparer);
        }

        // Set the elements.
        this.elements = elements;
    }

    public IEnumerable<T> Between(T from, T to)
    {
        // Find the index for the beginning.
        int index = Array.BinarySearch(this.elements, from, comparer);

        // Was the item found?
        bool found = (index >= 0);

        // If the item was not found, take the bitwise 
        // compliment to find out where it would be.
        if (!found)
        {
            // Take the bitwise compliment.
            index = ~index;
        }

        // If the item was found, cycle backwards from
        // the index while there are elements that are the same.
        if (found)
        {
            // Cycle backwards.
            for (; index >= 0 && 
                comparer.Compare(from, elements[index]) == 0; 
                --index) ;

            // Add one to the index, since this is on the element 
            // that didn't match the comparison.
            index++;
        }

        // Go forward now.
        for ( ; index < elements.Length; index++)
        {
            // Return while the comparison is true.
            if (comparer.Compare(elements[index], to) <= 0)
            {
                // Return the element.
                yield return elements[index];
            }
            else
            {
                // Break
                yield break;
            }
        }
    }
} 
```

这里的大部分内容是初始化类的助手，这将需要一个比较两个项目的方法（`IComparer<T>`并`Comparable<T>`在此处获取）。该类还允许您接收已经排序的原始数组，以防您以后想自己在适当的位置添加/删除/更新元素（不必一直使用数组）。

类的重点在于对 Between 的调用。它接受一个 from 值，该值将传递给 Array 类的静态 BinarySearch 方法，传递此实例使用的 IComparer 实现（如果没有传入，则假定默认值）。

*如果该值不存在，它会*找出它在数组中的位置，然后向后循环，以防数组中有多个具有相同值的元素。

然后，它向前循环，在当前元素小于或等于 to 值时返回枚举中的项。

在您的特定情况下，假设您有这样的课程：

```
public class Task
{
    public string Name;
    public DateTime StartTime;
} 
```

您可以执行以下操作：

```
// Create tasks.
Task[] tasks = 
{ 
    new Task() { Name = "Task 1", StartTime = new DateTime(2009, 02, 18) },
    new Task() { Name = "Task 2", StartTime = new DateTime(2009, 02, 16) },
    new Task() { Name = "Task 3", StartTime = new DateTime(2009, 02, 12) },
    new Task() { Name = "Task 4", StartTime = new DateTime(2009, 02, 11) },
    new Task() { Name = "Task 5", StartTime = new DateTime(2009, 02, 10) },
    new Task() { Name = "Task 6", StartTime = new DateTime(2009, 02, 01) },
    new Task() { Name = "Task 7", StartTime = new DateTime(2009, 02, 09) }
};

// Now create the indexer.
BinarySearcher<Task> searcher = new BinarySearcher<Task>(tasks,
    (x, y) => Comparer<DateTime>.Default.Compare(x.StartTime, y.StartTime));

foreach (Task t in searcher.Between(
    new Task() { StartTime = new DateTime(2009, 02, 13) },
    new Task() { StartTime = new DateTime(2009, 02, 10) }))
{
    // Write.
    Console.WriteLine(t);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T17:46:11.270

您是否使用自定义谓词检查了 Array.Find？

# wpf - 我们应该迁移到 WPF 还是 Winforms？

> ID：562068
> 
> 赞同：5
> 
> 时间：2009-02-18T17:27:19.460
> 
> 标签：wpf, winforms

**DUPE**：[Windows 窗体何时是 WPF 的正确选择？](https://stackoverflow.com/questions/388711/when-is-winforms-the-correct-choice-vs-wpf)

这些天，我们必须决定是否使用 WPF 作为构建我们下一代产品的平台。

就我个人而言，我有点害怕使用这项技术，特别是因为性能和它不成熟（我不确定 Blend 等 UI 编辑器的质量）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T17:33:21.863

就个人而言，我非常喜欢 WPF。

它需要从 Winforms 的思维方式发生根本性转变。Winforms 您将内容拖放到表单上。这让您真正快速轻松地完成了 80% 的工作，但是当您需要跳出 WinForms 明确涵盖的内容时，您将进入一个痛苦的世界。

在 WPF 中，您要做的第一件事就是关闭可视化编辑器。你的 UI 代码从丑陋的混乱变成了美丽的东西。此外，它非常强大和灵活，一旦你掌握了它，你可以做的事情绝对是惊人的。

WPF 的缺点是它比 WinForms 更重，学习曲线也比较大。但是，这是未来的方式，除非它是您正在制作的微不足道的应用程序，否则我会选择 WPF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T17:31:16.440

如果您不需要带有动画等的非常有光泽的 UI，我认为没有什么理由跳到 WPF... 只是现在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T17:34:34.560

如果您担心性能，您应该查看这些 MSDN 页面：

> [Windows Presentation Foundation 性能](http://msdn.microsoft.com/en-gb/library/aa970776.aspx)

我的猜测是，只要有合适的 DirectX 硬件，WPF 甚至会胜过 Winforms，因为渲染可以直接由 GPU 完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T17:30:15.367

考虑到 MS 正在使用基于 WPF 的代码编辑器构建他们的下一个 VS 版本，我发现很难找到对 WPF 不“成熟”或存在性能问题的支持。

我想说，如果您无论如何都能够迁移，那么您不妨升级以增加代码库的寿命。如果您的代码在 Winforms 中正确编写，那么开始将其移入 WPF 应该不会很困难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T17:31:29.950

大约 10 周前，我开始自学 WPF，然后在过去的两周里，我实际上用 WPF 编写了一个应用程序。

我来自 ASP.NET，我喜欢 WPF。我喜欢 XAML 标记，它比拖动项目并确保它们在 WinForm 中的正确位置更有意义。

WPF 中的样式更容易，您可以快速制作带有圆角的边框。

使用 Expression Blend，您可以设计一个非常漂亮的动画界面。

我在 Vista（家庭）和 XP（工作）上开发了一个 WPF 应用程序，它们看起来都非常好。

我对 WPF 非常满意，不会再使用 WinForms。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T17:47:03.220

我的感觉是，如果你对 winforms 的外观和感觉感到满意，那就坚持下去。如果您认为您将进行*任何*视觉自定义，那么请使用 WPF。但是后来我一直在使用 winforms 很长一段时间，而 WPF 却很少。如果我刚开始，我可能会专注于学习 WPF，因为它确实更灵活

# vb.net - 使用 VB ''' 语法，我的摘要信息不会显示在 Sandcastle 中

> ID：562082
> 
> 赞同：1
> 
> 时间：2009-02-18T17:32:18.403
> 
> 标签：vb.net, visual-studio-2008, documentation, comments, sandcastle

我正在尝试利用[Sandcastle](http://www.codeplex.com/DocProject/Release/ProjectReleases.aspx?ReleaseId=10744)来帮助构建系统文档，但出于某种奇怪的原因，我的`<summary>`数据都没有显示在 chm 中……有没有人使用 VB 获得了最新版本的 Sandcastle 和 VS2008 的成功？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T17:51:49.543

您是否检查过 XML 文档生成实际上已打开（在 Build 属性中）并且正在正确的位置（即 bin/Release/）创建 XML 文件？另外，请参阅MSDN 上的[这个线程，它记录了我相信的相同问题。](http://social.msdn.microsoft.com/Forums/en-US/devdocs/thread/055172d5-2e3f-4f51-87af-afab11d4be55/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:26:23.720

这是一个两步过程。

*   必须在项目构建窗口中打开 XML 文档生成。
*   在 SandCastle UI 中选择生成的 XML 文档作为项目文档源。

# sql-server - SQL 2005 选择转换失败的数据

> ID：562083
> 
> 赞同：2
> 
> 时间：2009-02-18T17:32:28.323
> 
> 标签：sql-server, sql-server-2005, tsql

我有什么方法可以在 select 语句中测试数据转换，并且只返回转换失败的行？

IE：

```
SELECT * FROM my_table WHERE CONVERT(datetime, [colA]) = NULL 
```

我对任何 SQL 黑客/诡计持开放态度。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-18T17:38:29.387

使用 isdate

```
SELECT * FROM my_table
WHERE isdate(colA)  = 0 
```

另请参阅[ISDATE 和转换为 SMALLDATETIME 的问题](http://wiki.lessthandot.com/index.php/Trouble_With_ISDATE_And_Converting_To_SMALLDATETIME)

# svn - 在 Subversion 中更改修订号，即使文件在提交中没有更改

> ID：562087
> 
> 赞同：1
> 
> 时间：2009-02-18T17:33:17.417
> 
> 标签：svn, version-control

我在文件中使用 $Rev:$ 来获得修订号，问题是文件没有太大变化，因此该数字不会自动更新。任何帮助如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T17:51:05.830

$Rev$ 不会按您期望的方式工作。

如果您使用的是命令行颠覆，那么您有[svnversion](http://svnbook.red-bean.com/en/1.4/svn.ref.svnversion.re.html)输出最新版本。

使用 tortoisesvn，它是[http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-subwcrev.html](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-subwcrev.html)

无论如何，您应该更新您的构建脚本，以便它自动合并最新的修订号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T17:38:34.300

如果您将其用于文件中的构建/版本号，请查看 svnrev 或 WCSubRev 工具以创建您需要的信息。

# input - 避免 SAS 错误消息：“注意：函数 INPUT 的参数无效”

> ID：562089
> 
> 赞同：5
> 
> 时间：2009-02-18T17:33:29.790
> 
> 标签：input, sas

有没有办法测试变量是否会使 SAS 中的 INPUT 转换过程失败？或者，如果可以避免产生的“注意：无效参数”消息？

```
data _null_;  
format test2 date9.;  
input test ;  
test2=INPUT(PUT(test,8.),yymmdd8.);  
if _error_ =1 then do;  
    _error_=0;  
    test2=INPUT(PUT(test-1,8.),yymmdd8.);  
end;  
put test2=;  
cards;  
20270229  
run; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T14:01:32.407

只需包括“？？” 在格式名称之前。您的示例已在下面修改...

```
data null;
format test2 date9.;
input test ;
test2=INPUT(PUT(test,8.),?? yymmdd8.);
if error =1 then do;
error=0;
test2=INPUT(PUT(test-1,8.), ?? yymmdd8.);
end;
put test2=;
cards;
20270229
run; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T20:05:25.260

您可以先将变量视为字符变量，而不是这样做（因为您知道某些值不是真实日期），然后使用[AFHood 提供的宏](https://stackoverflow.com/questions/561353/sas-invalid-leap-year-date-issue-yymmdd8/561924#561924)来帮助您找到无效值，然后修复这些值，然后在所有数据都干净后将变量转换为数字 var。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T08:59:00.767

您可以使用以下内容进行检查：

```
data null;
  format test2 date9.;
  input test ;
  test2=INPUT(PUT(test,8.),yymmdd8.);
  **if test ne '' and nmiss(test2)** then test2=INPUT(PUT(test-1,8.),yymmdd8.);
  put test2=;
cards;
20270229
run; 
```

# performance - 我应该为我的高性能 Web 服务选择哪种编程语言？

> ID：562095
> 
> 赞同：17
> 
> 时间：2009-02-18T17:36:21.530
> 
> 标签：performance, web-services, architecture, scalability, programming-languages

我正在为我的应用程序构建 Web 服务 API。此外，我计划通过 REST 和 SOAP 公开服务。

我有兴趣从社区获得一些关于我应该选择哪种编程语言来实现服务的反馈？（我知道 C#、Java 和 Ruby - RoR 足以创建服务）。

该服务主要是一个 HTTP POST 服务。它需要处理大约 2000 个并发连接，并且每秒能够处理大约 10,000 个 HTTP POST。（对于 SOAP，我们将有一个提交方法供客户端调用）。

对于 POST 请求，该服务不会向客户端返回任何响应。

关于应该使用哪种编程语言/架构的任何想法？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-02-18T17:46:55.390

每秒 10,000 个请求是每月 250 亿次点击。这意味着两件事之一：

1.  您的应用程序比 MySpace 更受欢迎；或者
2.  您正试图使用​​它在您控制的两个*非常*健谈的组件之间进行通信，这是一个~~糟糕~~的可怕设计选择。

仅用于在 Web 前端场中分配如此多负载的交换硬件将花费数千美元。

首先编写一个每秒可以处理 50 个请求的 Web 服务（语言选择不是很重要）。如果您的应用程序太忙以至于您经常超过该阈值，您可以聘请专人全职解决扩展问题，而不必在免费问答网站上寻求帮助。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-03-10T08:45:59.003

根据我以前的经验，我可以给你以下建议。

1.  **选择您（可能还有其他团队成员）最喜欢的语言**。我更喜欢高级语言，因为硬件既快又便宜，但程序员又慢又贵。
2.  将您的服务设计**为绝对无状态（无会话！）**。这使得添加新硬件变得容易，因为您的服务的不同实例不需要相互了解。
3.  **异步处理您的处理**，幸运的是您不需要给客户端任何响应（除了 OK）。如果您同步执行此操作，您的进程将阻塞并且您的请求率将下降。[这篇维基百科文章](http://en.wikipedia.org/wiki/Asynchronous_I/O)很好读，尤其是（经典！）*[C10K 问题](http://www.kegel.com/c10k.html)*。
4.  **将服务放在多台机器上。**（取决于您的服务速度）
5.  **将您的数据库服务器放在除 web-services 之外的其他机器上**。使用快速磁盘！
6.  **通过使用以下方式平衡负载来处理负载**：
    *   [Linux Virtual Server](http://www.linuxvirtualserver.org/)是性能最高的解决方案，因为它在内核中运行。像疯了一样的鳞片。我在 2003 年以 ~500req/sec 的速度在 P3/1GHz 上使用它，CPU 负载为 0.1%。可以配对实现[HA](http://en.wikipedia.org/wiki/High_availability)。应该在单台机器上很好地处理 10000req/sec。尝试更简单的方法后执行此操作。这可能非常具有挑战性。2018 年更新：如今它已集成到主线内核中，因此所有发行版都应将其作为一个包。
    *   [Nginx](http://www.nginx.net/)，配置简单，性能非常好。可以做SSL。也可以充当 HTTP-Server，并且可能是您服务的高性能托管解决方案。
    *   [Varnish](https://varnish-cache.org/)，一个可以处理多个后端的 HTTP 缓存。非常可配置，但不能做 SSL，所以如果你想加密你的流量，你需要一个 Nginx 在它前面。
    *   ~~[磅](http://www.apsis.ch/pound/)，很容易设置，但开销很大。好的起点。可以做SSL。~~自 2011 年以来项目已终止。
    *   ~~[Perlbal](http://www.danga.com/perlbal/)，没用过，但听说不错。~~自 2013 年以来项目已终止。
    *   或其他[反向代理](http://en.wikipedia.org/wiki/Reverse_proxy)。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-02-18T17:51:40.307

在每秒 10,000 个帖子的情况下，语言是您最不必担心的问题。更大的问题是服务器场和网络的设计。我假设您不打算在单个盒子上运行它？

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-18T19:29:24.783

高度可扩展的应用程序、可靠的、分布式的以及使用多核/多处理器系统？在这里，我立即将 Erlang/OTP 与 Yaws 一起视为 Web 应用程序服务器。Yaws 在极高负载下运行极其稳定和快速。而 Erlang/OTP 作为平台是为并发和分发而设计的，以及一些有助于开发稳定软件的机制。代价：函数式编程语言的并发导向与 Java 或 C# 没有 OOP，语法看起来很奇怪（但一旦你采用它就非常直接和强大），第三方库的数量没有那么大至于主流语言。但这是值得的。

希望这可以帮助

缪

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-24T04:57:25.080

我可以看到每个月从一台机器上获得十亿个帖子。我有一个用 c# 编写的 Web 服务，目前每天处理大约 350 万个帖子。Web 服务器以 3% 的 CPU 利用率运行。这意味着我至少可以用力推它 20 倍……

假设您的每台机器都有 4 个 Xeon 六核、32GB RAM、一个快速磁盘阵列和一个高度优化的写入数据库，您就可以做到。虽然，每台服务器的成本可能在 $35K 到 $40K 之间。

无论如何，您的瓶颈不会出现在 C# 或 Java 上。取决于数据库服务器的增长量，它将与数据库服务器一起使用。就我而言，它大约是 300GB，每天删除 10GB 并添加 10GB。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-24T03:45:43.710

以这样的速度，由于您无论如何都在破坏 HTTP（没有响应），您不妨开发自己的服务器，或修改开源服务器。

全部用 C 或 C++ 编写，你会尽可能快地燃烧起来。

可扩展性不仅受语言选择的影响。

-亚当

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-09T14:50:48.087

让我们看看问题：

IO：这很容易成为你系统中最大的瓶颈。选择一种语言，它提供与主机操作系统的最佳集成，并为非阻塞提供高级语义，并可选择支持并发。

数据：SOAP？XML？您将希望**最小化**任何不必要的 CPU 周期。简单地使用 JSON 有什么问题？（并且没有神圣的规定说基于 REST 架构的服务器不能在协议中使用二进制数据......）

内容：如果涉及任何数据转换（例如从文本到数字），您还需要考虑哪种语言提供最有效的机制。例如，在 Java 中（顺便说一句，这对你来说是一个非常强大的候选者），String 类是一个严重的 CPU 消耗。

Java 和 Erlang 是非常好的候选者。C 始终是一种选择，但并发编程要困难得多。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-18T17:51:06.143

您可以通过 CGI（通用网关接口）真正使用任何语言，因此它归结为性能。在您列出的语言中，我希望 C# 最快。语言之间速度的一个很好的比较是[语言枪战](http://shootout.alioth.debian.org/)

如果您*真的*需要性能，您可能希望使用更面向性能的语言（如 C 或 D）来处理请求。

这完全取决于每个请求必须真正执行什么样的计算。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T04:22:18.083

您需要一种类似 C 的语言，并且为了避免编写完整的服务器，我建议使用 CGI（无论如何，这都是 php 等都运行的）Windows 服务器提供 ISAPI 插件，但这些插件在服务器的上下文中运行，因此内存泄漏和GPF 将关闭服务器。再加上每次更改时停止/启动服务器的不便，CGI/FastCGI 看起来更好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-18T18:03:09.797

更新：它意味着是一个火而忘记网络服务。我想我会发回一个简单的 HTTP 200/OK 响应

不，这不打算在单个盒子上运行。它打算在几个盒子上运行（比如 3-4）。

当收到请求时，它们会被推送到其他机器上的队列中，然后将它们取出并放入 HBase/Voldemort 存储中。

正如我所说，它的意思是“一劳永逸”的网络服务

# sharepoint - 如何在 SharePoint 中找到用户 ID 具有权限的所有位置？

> ID：562096
> 
> 赞同：2
> 
> 时间：2009-02-18T17:36:47.380
> 
> 标签：sharepoint

如果员工离开公司，我们需要一种方法来查找该人在 SharePoint 中被授予权限的所有位置。当然，我们需要删除这些权限，或者如果他们是网站所有者，请将所有者更改为其他员工。

有没有人这样做或知道从哪里开始？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T20:02:40.540

我们使用[Sharepoint 访问检查器 Web 部件](http://www.codeplex.com/AccessChecker)来检查用户已被授予哪些站点的权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T18:12:34.343

此链接可能有用... [VBDotNetHeaven - 检查 SharePoint 站点中的用户权限](http://www.vbdotnetheaven.com/UploadFile/ssahmed/spuserperm09192006044916AM/spuserperm.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T21:25:37.500

我最近整理了一个 Web 部件来执行此操作 - 基本上，您网站上的`SPList`每个部件都有一个对象集合，这些对象定义了该对象的权限。在 中，有一个对象集合，您可以从中获取已分配对该对象权限的用户或组的名称。即使列表或文件夹不是从父级继承的，这也允许您获得权限。前面提到的[访问检查器 Web 部件](http://www.codeplex.com/AccessChecker)会执行此操作，但它不会查看可能拥有自己权限的子文件夹。`SPWeb``SPRoleAssignment``SPRoleAssignment``Member`

底线是，**如果您已授予用户对不同文件夹的明确权限**，您将需要构建一个解决方案来为您提供权限，或者分别单击每个文件夹。没有内置功能可以快速简单地显示它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T17:42:59.500

我不太熟悉 SharePoint 权限的工作原理，但最好不要让任何员工直接访问任何内容并使用 AD 安全组。当他们离开公司时，您可以从所有 AD 安全组中删除他们的个人资料和姓名，而不必担心访问包括 SharePoint 在内的任何内容。

我知道您可以查看 SharePoint 网站权限，但嵌套的 SharePoint 网站会带来更多麻烦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T21:29:36.180

我管理我们的共享点站点并使用 Active Directory 来处理所有安全问题。如果您现在不这样做，我会建议您尝试转向这种类型的安全模型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-06T20:41:00.137

单击`Site Actions`→ `Site Settings`→`Site Permissions`它将显示具有个人访问权限的每个人。您可以删除不再与您在一起的任何人来拥有它。

# c# - 形成 Load() 或不形成 Load()

> ID：562098
> 
> 赞同：4
> 
> 时间：2009-02-18T17:37:56.440
> 
> 标签：c#, .net, winforms, constructor, form-load

我应该在构造函数还是 FormLoad() 中加载子表单？

我有一些代码正在调用在控件中嵌入表单的自定义类。我最初是在构造函数之外声明我的子表单，然后在 FormLoad() 中调用 FormPaint() 例程，然后像这样加载表单：

```
internal frmWWCMCPHost frmWWCMCPHost = new frmWWCMCPHost();
internal frmWWCEnrollmentHost frmWWCEnrollmentHost = new frmWWCEnrollmentHost();
internal frmWWCMemberHost frmWWCMemberHost = new frmWWCMemberHost();

public frmWWCModuleHost()
{
    InitializeComponent();        
}

private void frmWWCModuleHost_Load(object sender, EventArgs e)
{
    FormPaint();
}

public void FormPaint()
{
    WinFormCustomHandling.ShowFormInControl(frmWWCMCPHost, ref tpgMCP, FormBorderStyle.FixedToolWindow,-4,-2);
    WinFormCustomHandling.ShowFormInControl(frmWWCMemberHost, ref tpgMember, FormBorderStyle.FixedToolWindow, -4, -2);
    WinFormCustomHandling.ShowFormInControl(frmWWCEnrollmentHost, ref tpgEnrollment, FormBorderStyle.FixedToolWindow, -4, -2);

    // Call each top-Level (visible) tabpage's form FormPaint()
    frmWWCMCPHost.FormPaint();
} 
```

现在我已经看到了一种在容器控件中嵌入表单的更好方法，因为它与我的自定义类有关，[here](https://stackoverflow.com/questions/543087/custom-class-for-dealing-with-embedding-in-forms/545864#545864)。

我的问题是我应该在哪里加载这些，因为示例将它们加载到同时声明它们的构造函数中，如下所示：

```
public frmWWCModuleHost()
{
    InitializeComponent();
    WinFormCustomHandling.ShowFormInContainerControl(tpgCaseNotes, new XfrmTest());
} 
```

显然，这是更少的代码。通过在构造函数中加载，我会使用更多不必要的资源吗？我会有所收获吗？我该如何决定？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T21:23:34.510

我更喜欢使用表单的构造函数。我的意思是在显示表单**之前**设置所有内容，而不是之后。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T18:59:07.883

减少外部复杂性将增加可读性，并应减少可能的错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T19:12:55.853

切线，永远不要使用 throw ex 重新抛出异常；它将重置调用堆栈。只需使用 throw;

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-18T20:53:41.897

有趣的问题 Mr_Mom。我的建议是使用您的构造函数只执行子表单所需的设置，并将子表单的加载推迟到父表单加载（）。

至于资源、得失……我不知道。

# c# - 如何在 VS2005 的表单设计器中显示用户控件的重写 Text 属性？

> ID：562103
> 
> 赞同：2
> 
> 时间：2009-02-18T17:38:58.137
> 
> 标签：c#, visual-studio-2005, user-controls, propertygrid, windows-forms-designer

我有一个用户控件，其中包含以下代码。

```
[System.ComponentModel.Category("Appearance")]
public override string Text { ... }

private int myVar;
[System.ComponentModel.Category("Appearance")]
public int MyProperty { ... } 
```

`MyProperty`将控件插入表单时显示在属性网格中，但`Text`不显示。我怎样才能让它可见？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T17:51:21.570

如果您将 System.ComponentModel.Browsable(true) 属性添加到您的属性，它应该会显示在属性浏览器中。使用上面的示例，我确认了 VS2008 中的行为。

# java - 在 java 中运行内部和外部 unix 命令的区别

> ID：562104
> 
> 赞同：1
> 
> 时间：2009-02-18T17:40:02.300
> 
> 标签：java, unix

为什么内部 unix 命令（cd、pwd 等）不能像使用 Runtime.getRuntime().exec() 的外部命令（chmod、chown 等）一样直接在 java 中运行？

请帮忙解释一下。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T17:47:36.900

因为它们是内置在 shell 中的，而不是它们本身的程序。

最简单的做法是调用 shell 并使用 -c 选项传递命令：

```
> bash -c pwd
/home/foo/bar/baz 
```

...或在 Java 中：

```
Runtime.getRuntime().exec("bash -c pwd") 
```

...或更一般地说：

```
Runtime.getRuntime().exec(new String[]{"bash", "-c", command}); 
```

我们需要使用 String[] 变体，否则，如果 StringTokenizer 包含任何空格，我们的命令将被破坏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T17:46:22.533

Java 需要一个可执行文件来执行。这就是为什么 shell 内置命令（例如 cd、bg、别名）在 Java 中不起作用的原因。内置命令不是实际的可执行文件，而是当 shell 在命令行或脚本中遇到它们时由 shell 简单地解释。

您可以通过编写包含内置命令的 shell 脚本然后从 Java 应用程序执行 shell 脚本来解决此问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T17:48:55.273

您可能想阅读[“当 Runtime.exec() 不会”。](http://www.javaworld.com/javaworld/jw-12-2000/jw-1229-traps.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-18T19:07:29.750

其他人提供了基本原因，但他们并没有真正解释*为什么*会这样。

shell 命令`cd`和`pwd`是 shell 内部的，因为它们影响或报告 shell 的内部状态。

这里的两个示例都在“工作目录”上工作，它是 shell 内部状态的一部分，尽管环境变量`PWD`也随着稀薄的信息保持最新。

要在您的程序中实现相同的效果，您需要更改或访问*您的*进程的内部状态。获取和设置环境变量的状态`PWD`将是一种合理的，如果独特的方式来实现这一点。

# c# - 如何在 log4net appender 名称中使用 GlobalContext 属性？

> ID：562108
> 
> 赞同：40
> 
> 时间：2009-02-18T17:41:41.063
> 
> 标签：c#, log4net

我正在尝试自定义 log4net 文件路径以使用我在`log4net.GlobalContext.Properties`字典中设置的属性。

```
log4net.GlobalContext.Properties["LogPathModifier"] = "SomeValue"; 
```

通过它进行调试时，我可以看到该值设置正确。然后在我的配置中

```
<file type="log4net.Util.PatternString" 
      value="Logs\%appdomain_%property{LogPathModifier}.log" /> 
```

然而，这个输出在路径的末尾给了我“_(null).log”。是什么赋予了？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-02-21T04:12:53.263

我遇到了同样的行为，并通过在调用 XmlConfigurator 之前设置全局变量来解决它......这是我成功使用的内容：

log4net.config 详细信息：

```
<appender name="RollingLogFileAppender" type="log4net.Appender.RollingFileAppender,log4net">
  <File type="log4net.Util.PatternString" value="App_Data/%property{LogName}" />
  ...
</appender> 
```

Global.asax 详细信息：

```
private static readonly log4net.ILog log = log4net.LogManager.GetLogger("Global.asax");
void Application_Start(object sender, EventArgs e) 
{
    // Set logfile name and application name variables
    log4net.GlobalContext.Properties["LogName"] = GetType().Assembly.GetName().Name + ".log";
    log4net.GlobalContext.Properties["ApplicationName"] = GetType().Assembly.GetName().Name;

    // Load log4net configuration
    System.IO.FileInfo logfile = new System.IO.FileInfo(Server.MapPath("log4net.config"));
    log4net.Config.XmlConfigurator.ConfigureAndWatch(logfile);

    // Record application startup
    log.Debug("Application startup");
} 
```

希望这可以帮助...

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-01T20:35:40.230

将 type= 添加`log4net.Util.PatternString`到 File 元素中

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-04T14:47:18.293

问题（我认为）是您在设置名称并加载配置之前获取（GetLogger）记录器......

尝试像这样声明记录器：`private static log4net.ILog _pLog` 然后在 Application_Start 中执行：

```
void Application_Start(object sender, EventArgs e) 
{
    // Set logfile name and application name variables
    log4net.GlobalContext.Properties["LogName"] = GetType().Assembly.GetName().Name + ".log";
    log4net.GlobalContext.Properties["ApplicationName"] = GetType().Assembly.GetName().Name;

    // Load log4net configuration
    System.IO.FileInfo logfile = new System.IO.FileInfo(Server.MapPath("log4net.config"));
    log4net.Config.XmlConfigurator.ConfigureAndWatch(logfile);

    //Get the loger
    _pLog = log4net.LogManager.GetLogger("Global.asax");

    // Record application startup
    pLog .Debug("Application startup");
} 
```

所以顺序是：

```
// Set logfile name and application name variables
// Load log4net configuration
// get the logger
// Record application startup 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T17:54:39.583

logger 是否通过应用程序中的 global 或 main 方法进行了初始化？可能是 GlobalContext 尚未初始化。

# gdb - 使用 GDB 调试 Bison 生成的代码

> ID：562113
> 
> 赞同：0
> 
> 时间：2009-02-18T17:43:37.190
> 
> 标签：gdb, bison

我正在尝试进入我的 yyparse 函数，该函数在 Bison 生成的代码中定义，但我从 GDB 收到一条消息说

> `Reading file "foo.tab.c"...No such file or directory.`

Bison 生成的文件名为 foo.cc。它为什么要寻找`foo.tab.c`，而不是？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T18:10:15.287

.cc 文件实际上是 Bison 程序的输入。foo.tab.c 是输出——由 Bison 生成的 C 文件。它包含用于加速解析的查找表和一些您需要的大多数内容的默认定义。该文件**被**编译并提供给目标代码。您可能会发现[文档](http://www.gnu.org/software/bison/manual/html_mono/bison.html#Bison-Parser)很有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T18:30:13.910

Bison 的输入文件应遵循 yacc 约定并命名为 foo.y。处理后的输出文件应该是 foo.tab.c。对于 C++，这是 foo.yxx 到 foo.tab.cxx。

您是否使用 Bison 的 -o 或 --output-file 参数。这可能是问题所在，而是使用提到的约定。

# bash - 在 bash 中按 alt + numeric 你会得到 (arg [numeric]) 那是什么？

> ID：562115
> 
> 赞同：117
> 
> 时间：2009-02-18T17:44:25.003
> 
> 标签：bash, shell, keyboard-shortcuts, readline

在 bash 中按 alt + numeric 你会得到 (arg [numeric]) 那是什么？

（这种类型的问题更适合问人，而不是试图“猜测”正确的术语来通过互联网搜索文档）。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-02-18T18:00:55.120

您要搜索的术语是：

```
"readline arguments" 
```

例如，这将导致[bash 参考手册中的这一章](https://www.gnu.org/software/bash/manual/bashref.html#Readline-Arguments)：

> 您可以将数字参数传递给 Readline 命令。有时参数充当**重复计数**，有时它是重要的参数的符号。如果您将负参数传递给通常向前执行的命令，则该命令将向后执行。例如，要将文本终止到行首，您可以键入“M-- Ck”。
> 
> 将数字参数传递给命令的一般方法是在命令之前键入元数字。如果键入的第一个“数字”是减号（“-”），则参数的符号将为负。一旦你输入了一个元数字来启动参数，你可以输入其余的数字，然后输入命令。例如，要为 Cd 命令提供 10 的参数，您可以键入“M-1 0 Cd”，这将删除输入行中接下来的十个字符。

为此，您必须知道 Meta 键的映射位置：有时是`Alt`，有时是`Esc`，很酷的计算机有一个专用的 Meta 键；）

对于那些不熟悉语法的人来说，'M-- Ck'相当于`Meta_key`++ 。“M”是 Meta 键的简写，如前所述，它因系统而异，“C”是 Ctrl 键的简写。字符后的“-”（如“M-”）不是您键入的内容，它是一种表示同时按键的方式。`-` `Ctrl``k`

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-07-20T04:03:01.643

为了重复数字字符 - 例如 128 个零，请点击以下内容：

`Meta-key + 1` `2` `8` `Ctrl + v` `0`

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-18T17:51:15.377

试试这个。键入`Alt` `4`，然后键入`T`，然后点击`Enter`。

编辑为使用更时髦的 HTML。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-18T17:58:46.500

它重复下一个命令多次，与 Emacs 中相同。例如`M-1-0 C-p`，向后移动 10 个历史项目。`M-4 C-h`退格四个字符，`M-3 M-t`将前一个单词向前移动 3 次，依此类推。在这里，我使用`M-`Alt 键的含义“元”，就像 Bash 中的自定义一样。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-05-28T09:15:50.117

我知道这已经是一个公认的答案，但是我确实找到了一些[有用的示例](http://blog.yjl.im/2012/02/using-digit-argument-in-bash-readline.html)，这些示例还展示了除了简单的字符重复之外的其他用途。数字参数可以适用于各种事物。例如序列“Alt+3, Escape, Backspace”将向后删除 3 个单词。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-18T17:46:45.717

我不知道，但是当您执行 alt + numeric 然后按一个字符时，您会得到 num 个字符：(arg: 123) + a -> 123 次 "a"

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-18T18:01:29.190

[bash 手册部分](http://www.gnu.org/software/bash/manual/bashref.html#Readline-Arguments)- 基本上是一种重复 readline 命令或反转它们的方式。

# php - 是否可以获得 Youtube 视频的所有评论？

> ID：562116
> 
> 赞同：0
> 
> 时间：2009-02-18T17:44:36.470
> 
> 标签：php, zend-framework, youtube

我正在用 PHP 构建一个与 Youtube 集成的网站。我想访问在特定视频上发布的所有评论。

当我使用 Zend 库时，我可以使用 getVideoCommentFeed() 方法获取视频评论提要，但这只会返回最新评论。

有没有办法获取自视频上传以来发布的每条评论？

如果不可能，我正在考虑使用 cron 作业定期获取评论提要并将它们保存在本地，但这将是最后的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T18:00:37.260

我相信您每个请求只能检索 25 个项目，但我相信您可以通过设置起始评论偏移量来获取下一页数据。看看 [setStartIndex()](http://framework.zend.com/apidoc/core/Zend_Gdata/Gdata/Zend_Gdata_Feed.html#setStartIndex)和[setItemsPerPage()](http://framework.zend.com/apidoc/core/Zend_Gdata/Gdata/Zend_Gdata_Feed.html#setItemsPerPage)。

# domain-driven-design - 所有“批量”操作在 DDD 中属于哪里？

> ID：562117
> 
> 赞同：11
> 
> 时间：2009-02-18T17:45:24.597
> 
> 标签：domain-driven-design, abstraction, ddd-repositories

在 DDD 中，关键概念之一是存储库，它允许您检索实体（或聚合根），然后在更新后将它们保存回来。

假设我们需要对实体执行一些“批量”操作，并且实体的数量使得将它们检索到内存中是绝对不可能的。ie操作只能在数据库中进行。

这种“批量”操作的地方在哪里？它应该是存储库上的方法吗？它不会通过数据库特定操作“泄漏”存储库抽象吗？它不会将业务操作从实体转移到存储库吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-08-26T03:48:13.953

我觉得应该是服务。

Evans 在他的书中建议，当您因为认为某个类不属于该类而怀疑是否将“闻起来很糟糕”的方法放入类时，请在其中创建一个带有操作的 ServiceFoo 类。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-18T17:54:25.683

```
void DoLongInvolvedTask(); 
```

我认为将批量任务作为方法放入存储库中没有任何问题。他们不会泄露任何东西。拥有批量操作并不意味着任何特定于数据库的操作，除非您的方法类似于 ReBuildMSSQLIndexesOnMyBigTable()。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-26T03:26:13.217

您需要的是领域驱动设计中的[服务。](http://domaindrivendesign.org/node/125)服务用于对程序任务进行建模。像您描述的那样，批量更新操作将是服务的理想候选者。

**编辑：**原始链接消失了。您可以在此处找到 DDD 术语表，但它不如原始页面有用。[http://dddcommunity.org/resources/ddd_terms/](http://dddcommunity.org/resources/ddd_terms/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T17:59:42.520

您不应该在域对象中保存、检索逻辑（我假设您正在使用域模型）。这是存储库的责任。所以你的批量方法属于存储库。

如果您使用 ORM，那么您的存储库将不依赖于数据库。他们会将所有请求转发到 ORM 层。

如果您正在编写自己的映射器，则存储库会将请求转发给实体的映射器。我认为这种耦合是可以的。

# c# - 如何使用 Moq 模拟扩展方法？

> ID：562129
> 
> 赞同：95
> 
> 时间：2009-02-18T17:48:01.190
> 
> 标签：c#, mocking, moq, extension-methods

我正在编写一个依赖于扩展方法结果的测试，但我不希望该扩展方法未来的失败会破坏这个测试。模拟该结果似乎是显而易见的选择，但**Moq 似乎没有提供覆盖静态方法的方法**（扩展方法的要求）。Moq.Protected 和 Moq.Stub 也有类似的想法，但它们似乎没有为这种情况提供任何东西。我错过了什么还是应该以不同的方式解决这个问题？

这是一个简单的示例，该示例因通常的***“对不可覆盖成员的无效期望”***而失败。这是一个需要模拟扩展方法的坏例子，但它应该这样做。

```
public class SomeType {
    int Id { get; set; }
}

var ListMock = new Mock<List<SomeType>>();
ListMock.Expect(l => l.FirstOrDefault(st => st.Id == 5))
        .Returns(new SomeType { Id = 5 }); 
```

至于任何可能建议我使用 Isolator 的 TypeMock 爱好者：我很欣赏你的努力，因为看起来 TypeMock 可以蒙着眼睛和醉酒地完成这项工作，但我们的预算不会很快增加。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-02-18T18:02:25.757

扩展方法只是变相的静态方法。Moq 或 Rhinomocks 等模拟框架只能创建对象的模拟实例，这意味着模拟静态方法是不可能的。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2014-03-28T18:04:03.177

如果您可以更改扩展方法代码，那么您可以像这样编写代码以便能够测试：

```
using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Moq;

public static class MyExtensions
{
    public static IMyImplementation Implementation = new MyImplementation();

    public static string MyMethod(this object obj)
    {
        return Implementation.MyMethod(obj);
    }
}

public interface IMyImplementation
{
    string MyMethod(object obj);
}

public class MyImplementation : IMyImplementation
{
    public string MyMethod(object obj)
    {
        return "Hello World!";
    }
} 
```

所以扩展方法只是实现接口的一个包装器。

（您可以只使用没有扩展方法的实现类，这些扩展方法是一种语法糖。）

您可以模拟实现接口并将其设置为扩展类的实现。

```
public class MyClassUsingExtensions
{
    public string ReturnStringForObject(object obj)
    {
        return obj.MyMethod();
    }
}

[TestClass]
public class MyTests
{
    [TestMethod]
    public void MyTest()
    {
        // Given:
        //-------
        var mockMyImplementation = new Mock<IMyImplementation>();

        MyExtensions.Implementation = mockMyImplementation.Object;

        var myClassUsingExtensions = new MyClassUsingExtensions();

        // When:
        //-------
        var myObject = new Object();
        myClassUsingExtensions.ReturnStringForObject(myObject);

        //Then:
        //-------
        // This would fail because you cannot test for the extension method
        //mockMyImplementation.Verify(m => m.MyMethod());

        // This is success because you test for the mocked implementation interface
        mockMyImplementation.Verify(m => m.MyMethod(myObject));
    }
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-04-28T20:35:57.927

我知道这个问题已经有一年没有活跃了，但微软发布了一个框架来处理这个问题，叫做[Moles](http://research.microsoft.com/en-us/projects/moles/)。

这里还有一些教程：

*   [DimeCasts.net](http://www.dimecasts.net/Content/WatchEpisode/170)*   [Nikolai Tillman 的教程](http://channel9.msdn.com/posts/Peli/Moles-Replace-any-NET-method-with-a-delegate/)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-10-01T14:30:00.583

我为需要模拟的扩展方法创建了一个包装类。

```
public static class MyExtensions
{
    public static string MyExtension<T>(this T obj)
    {
        return "Hello World!";
    }
}

public interface IExtensionMethodsWrapper
{
    string MyExtension<T>(T myObj);
}

public class ExtensionMethodsWrapper : IExtensionMethodsWrapper
{
    public string MyExtension<T>(T myObj)
    {
        return myObj.MyExtension();
    }
} 
```

然后，您可以使用 IOC 容器模拟测试和代码中的包装器方法。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-01-29T16:23:49.207

对于扩展方法，我通常使用以下方法：

```
public static class MyExtensions
{
    public static Func<int,int, int> _doSumm = (x, y) => x + y;

    public static int Summ(this int x, int y)
    {
        return _doSumm(x, y);
    }
} 
```

它允许注入 _doSumm 相当容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-17T05:38:04.520

您可以做的最好的事情是为具有扩展方法的类型提供自定义实现，例如：

```
[Fact]
public class Tests
{
    public void ShouldRunOk()
    {
        var service = new MyService(new FakeWebHostEnvironment());

        // Service.DoStuff() internally calls the SomeExtensionFunction() on IWebHostEnvironment
        // Here it works just fine as we provide a custom implementation of that interface
        service.DoStuff().Should().NotBeNull();
    }
}

public class FakeWebHostEnvironment : IWebHostEnvironment
{
    /* IWebHostEnvironment implementation */

    public bool SomeExtensionFunction()
    {
        return false;
    }
} 
```

# javascript - 仅当元素的第一个子元素之前没有文本节点时，如何匹配它？

> ID：562134
> 
> 赞同：4
> 
> 时间：2009-02-18T17:49:21.980
> 
> 标签：javascript, jquery, css-selectors

我正在尝试匹配 div 的 h4（使用 jQuery），以便我可以删除它的上边距。但是，如果 h4 上面没有文本，我只想匹配它。例如，匹配这个：

```
<div>
  <h4>Header</h4>
  ...
</div> 
```

但不是这个：

```
<div>
  Blah blah blah.
  <h4>Header</h4>
  ...
</div> 
```

我在 jQuery 中能想到的最好的代码是这样的：

```
$("div h4:first-child") 
```

但不幸的是，这与上述两种情况都匹配。无论如何指定您希望它是绝对的第一个元素，之前没有文本节点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T18:05:31.193

```
<div>
    <h4>Header</h4>
    ...
</div>

<div>
    Blah blah blah.
    <h4>Header</h4>
    ...
</div> 
```

那么您可以使用以下内容。

```
$('div').each(function() {
    var me = this;
    if ($(me).html().toUpperCase().indexOf("<H4>") == 0){ //check to see if the inner html starts with an h4 tag
        $(me).children('h4')... //do what you need to do to the header
    }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T18:10:56.050

```
$("div h4")
    .filter(function() {
    var prev = this.previousSibling;
        return (!prev 
            || prev.nodeType !== 3
            || (prev.nodeType == 3 && prev.nodeValue.match(/^\s*$/)));
    }) 
```

编辑：修复它。适用于 Firefox、IE8

笔记：

1.  过滤器函数中的“this”指的是节点
2.  两个 H4 前面都有一个文本节点。我认为浏览器会在发现空格和换行符的任何地方插入文本节点。在这种情况下，我们只选择那些不是纯空格的。
3.  `Node.TEXT_NODE`在 IE 中不可用。因此使用幻数 3。

# javascript - 如何使用 Javascript 将彩色图像转换为黑白？

> ID：562135
> 
> 赞同：20
> 
> 时间：2009-02-18T17:49:46.567
> 
> 标签：javascript, image-processing, canvas

**如何仅使用 Javascript 将彩色图像转换为黑白？**

并且，还要使它在大多数浏览器中交叉兼容，因为我听说 Internet Explorer 有一个“过滤器”机制，但没有其他浏览器支持它。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-18T17:54:01.330

尽管我最初持怀疑态度，但在某些浏览器中使用新的 Canvas 功能，这种魔法似乎确实是可能的。

这个页面展示了如何使用支持 Canvas 的浏览器来做到这一点：

[http://www.permadi.com/tutorial/jsCanvasGrayscale/index.html](http://www.permadi.com/tutorial/jsCanvasGrayscale/index.html)

对于 IE 你需要使用过滤器，这里有一个做灰度的例子：

[http://www.javascriptkit.com/filters/basicimage.shtml](http://www.javascriptkit.com/filters/basicimage.shtml)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-18T18:11:00.370

我这样做的方法是将 img 的 src 设置为指向服务器端 PHP 脚本

例如。，

```
<img src="http://mysite/grayscale.php?url='...' 
```

该脚本获取图像，运行一些 GD 代码，并返回 JPG。[像这样](http://php.about.com/od/gdlibrary/ss/grayscale_gd.htm)的东西

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-02-14T17:01:36.983

这个 jquery 插件似乎可以跨浏览器工作。不过，我还没有彻底测试过。

[https://github.com/GianlucaGuarini/jQuery.BlackAndWhite](https://github.com/GianlucaGuarini/jQuery.BlackAndWhite)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-02-03T14:53:32.307

使用 HTML5 Canvas 和 JavaScript

```
 ctx.drawImage(img, 0, 0, w, h);

    var imgPixels = ctx.getImageData(0, 0, w, h);
    for(var y = 0; y < imgPixels.height; y++){
     for(var x = 0; x < imgPixels.width; x++){
          var i = (y * 4) * imgPixels.width + x * 4;
          var avg = (imgPixels.data[i] + imgPixels.data[i + 1] + imgPixels.data[i + 2]) / 3;
          imgPixels.data[i] = avg;
          imgPixels.data[i + 1] = avg;
          imgPixels.data[i + 2] = avg;
     }
}
ctx.putImageData(imgPixels, 0, 0, 0, 0, imgPixels.width, imgPixels.height); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-05-04T12:17:40.703

> 我认为这段代码可以完美运行，无需嵌套循环或任何其他库

```
var image = document.getElementById("image");

var canvas=document.createElement("canvas");
var ctx=canvas.getContext("2d");

canvas.width= image.width;
canvas.height= image.height;

ctx.drawImage(image,0,0);

var imageData=ctx.getImageData(0,0, image.width, image.height);

for (var i=0;i<imageData.data.length;i+=4) {
    var avg = (imageData.data[i]+imageData.data[i+1]+imageData.data[i+2])/3;

    imageData.data[i] = avg;
    imageData.data[i+1] = avg;
    imageData.data[i+2] = avg;

}

ctx.putImageData(imageData, 0, 0, 0, 0, imageData.width, imageData.height);
document.getElementById("grayscale").appendChild(canvas); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-05-15T01:48:48.330

现代浏览器现在可以在 CSS 中做到这一点——在*任何*HTML 元素上，而不仅仅是图像。结合 IE 的老`filter`CSS，可以得到相当不错的兼容性：

```
image.grayscale {
  /* IE */
  filter: progid:DXImageTransform.Microsoft.BasicImage(grayscale=1);

  /* Chrome, Safari */
  -webkit-filter: grayscale(1);

  /* Firefox */
  filter: grayscale(1);
} 
```

OP 指定“仅 JavaScript”，但也提到如果 IE`filter`得到更广泛的支持，现在（实际上）是可以接受的，所以我相信这是 2015 年最好的解决方案。如果你真的必须有 JavaScript：

```
element.style.filter = 'grayscale(1)'; 
```

资料来源：

*   [浏览器支持](http://caniuse.com/#feat=css-filters)
*   [规格](https://developer.mozilla.org/en-US/docs/Web/CSS/filter)
*   [教程](http://davidwalsh.name/css-filters)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-09-07T20:49:07.113

我发现这个（[http://spyrestudios.com/html5-canvas-image-effects-black-white/](http://spyrestudios.com/html5-canvas-image-effects-black-white/)）解决方案在 IE 之外工作得相当好，正如其他人所指出的那样，您需要使用过滤器为了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-12-12T11:14:18.630

一些图像过滤器在 CSS 中可用，并受到所有主要浏览器的支持，但您可以使用 HTML5 Canvas 和 Javascript 获得更多选项。

但是，当使用基于 Canvas 的图像过滤时，您不需要自己实现过滤器算法。只需使用图像处理或 Canvas 操作库。

例子：

*   [织物.js](http://fabricjs.com/)
*   [处理.js](http://processingjs.org/)
*   [马文杰](http://www.marvinj.org)

在下面的示例中，我使用了 MarvinJ。

**加载图像：**

```
image = new MarvinImage();
image.load("https://i.imgur.com/B33rKWi.png", imageLoaded); 
```

**灰度：**

```
Marvin.grayScale(image.clone(), image); 
```

[![在此处输入图像描述](https://i.stack.imgur.com/QIIao.png)](https://i.stack.imgur.com/QIIao.png)

**黑与白：**

```
Marvin.blackAndWhite(image.clone(), image, 5); 
```

[![在此处输入图像描述](https://i.stack.imgur.com/nvZ66.png)](https://i.stack.imgur.com/nvZ66.png)

**黑与白2：**

```
Marvin.blackAndWhite(image.clone(), image, 40); 
```

[![在此处输入图像描述](https://i.stack.imgur.com/MWqPP.png)](https://i.stack.imgur.com/MWqPP.png)

**半色调：**

```
Marvin.halftoneErrorDiffusion(image.clone(), image); 
```

[![在此处输入图像描述](https://i.stack.imgur.com/dq7l2.png)](https://i.stack.imgur.com/dq7l2.png)

**可运行示例：**

```
var canvas = document.getElementById("canvas");
image = new MarvinImage();
image.load("https://i.imgur.com/B33rKWi.png", imageLoaded);

function imageLoaded(){
	// GrayScale
	//Marvin.grayScale(image.clone(), image);
	//image.draw(canvas);

	// Black and White
	Marvin.blackAndWhite(image.clone(), image, 5);
	image.draw(canvas);

	// Black and White 2
	//Marvin.blackAndWhite(image.clone(), image, 40);
	//image.draw(canvas);

	// Error Diffusion
	//Marvin.halftoneErrorDiffusion(image.clone(), image);
	//image.draw(canvas);
}
```

```
<script src="https://www.marvinj.org/releases/marvinj-0.7.js"></script>
<canvas id="canvas" width="400" height="400"></canvas>
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-03-03T21:33:42.377

如今，您还可以在将图像渲染到画布之前应用[过滤器。](https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/filter)[浏览器支持数据在这里](https://caniuse.com/mdn-api_canvasrenderingcontext2d_filter)。

```
const image = document.getElementById("image");
const canvas = document.createElement("canvas");
const ctx = canvas.getContext("2d");
canvas.width = image.width;
canvas.height = image.height;
ctx.filter = "grayscale()";
ctx.drawImage(image, 0, 0); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-10T19:17:08.080

Canvas 确实是解决这个问题的最佳客户端解决方案，我只想指出，对于 IE，您实际上可以使用 google exCanvas 项目，该项目将 canvas 命令转换为专有的 Microsoft 基于 XML 的矢量语言 VML。

[http://excanvas.sourceforge.net/](http://excanvas.sourceforge.net/)

# wpf - 如何在 Silverlight 中操纵用远见物理学制作的布娃娃？

> ID：562141
> 
> 赞同：3
> 
> 时间：2009-02-18T17:51:13.647
> 
> 标签：wpf, silverlight, physics, farseer

我制作了一个类似于此[演示](http://www.spritehand.com/silverlight/2.0/physicshelper/PhysicsHelperDemos.htm#)中的布娃娃。这个布娃娃将用于回合制 rpg 游戏，其中物理将用于动画，例如角色受到伤害、死亡、摔倒等。

我现在正在思考的是，这应该怎么做，我应该把布娃娃的头贴在背景上（让身体悬空），然后基本上把它的身体部位四处乱扔，模拟打孔等（如图所示）图1），或僵硬关节并静态旋转和移动身体部位进行动作（如图2所示），当涉及到角色死亡（或类似动作）时，只需松开关节并让抹布娃娃掉下来。还是有更好的方法来做到这一点？

我是新手物理学的新手，甚至不知道我提到的是否有可能或非常难以做到。

[插图 http://img3.imageshack.us/img3/8681/charactermovementrg5.jpg](http://img3.imageshack.us/img3/8681/charactermovementrg5.jpg)

请注意图中的红线代表人物的手臂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T10:10:30.807

如果你想要动画，不确定布娃娃是否适合去这里。但如果你确实想使用它们，我会将脚锁定在地板上，并在关节处安装一些旋转弹簧，这样当没有施加力时，身体就会直立。然后如果它被击中，它会弯曲，但之后应该反弹到它的站立状态（你可能需要在回来的路上帮助它，例如施加一些力/扭矩直到它回到你想要的地方）。

对于动画，例如角色打孔，您也许可以应用弹簧关节（我认为这就是名称）。将它连接到拳头和目的地，手臂应该会自动移动到那里。你也可以用踢腿做同样的事情，只需松开那只脚上的锁。但是，我认为可能很难让它看起来正确。另一方面，它看起来对其他游戏来说是独一无二的，即使它看起来有点有趣。

如果您熟练，您可能想要创建一个动画编辑器并将动画保存为一系列力和扭矩，这些力和扭矩需要应用于四肢，以便将它们带到应在的位置和时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-19T01:22:16.033

毫无疑问，动画精灵是最好的、无痛的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T08:27:33.743

我认为更好的方法是播放动画精灵，而不是通过联合操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T08:58:05.057

也许您可以使用一些**RotateTransform**实现来表达手臂和腿。

# sql - 所有者 ID 类型数据库字段

> ID：562148
> 
> 赞同：1
> 
> 时间：2009-02-18T17:52:53.627
> 
> 标签：sql, database, database-design

假设您有这些表：`RestaurantChains`, `Restaurants`, `MenuItems`- 它们之间有明显的关系。现在，您有表`Comments`和`Ratings`，它们存储客户对连锁店、餐馆和菜单项的评论/评分。链接这些表的最佳方法是什么？显而易见的解决方案可能是：

*   在表格中使用列`OwnerType`和，但现在我无法添加外键来链接评论/评级与他们所针对的对象`OwnerID``Comments``Ratings`
*   为每个表创建单独的表`Comments`，`Ratings`例如`MenuItemRatings`，`MenuItemComments`等。该解决方案的优点是存在所有正确的外键，但明显的缺点是具有大量具有基本相同结构的表。

那么，哪种解决方案效果更好？还是有我不知道的更好的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T18:37:50.930

由于关于菜单项的评论与关于餐厅的评论不同（即使它们碰巧共享相同的结构），我会将它们放在单独的表中，并具有适当的 FK 以在数据库中强制执行某些数据完整性。

我不知道为什么会厌恶在您的数据库中拥有更多表。除非您从 50 个表增加到 50,000 个表，否则不会因为大型目录表而出现性能问题（在这种情况下，拥有更多、更小的表实际上应该会给您带来更好的性能）。我也倾向于认为，在处理名为“Menu_Item_Comments”和“Restaurant_Comments”的表时，比处理名为“Comments”的表更清楚地理解它只是通过它的名字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T18:21:51.577

[这个替代文本](http://www.freeimagehosting.net/uploads/8241ff5c76.png)怎么样http://www.freeimagehosting.net/uploads/8241ff5c76.png

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T17:59:28.167

对所有对象都有一个评论/评级表，不要使用自动生成的外键。评级表中的键，例如 RatingID，可以放在 Restaurant、Chain、Menuitems 表中的字段中，它们都可以指向同一个表，它们仍然是外键。

如果您需要反向知道评论与哪个对象相关，您需要有一个字段来指定评论的类型，但这应该是全部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T18:04:37.250

使用单个表进行评论并使用`GUID`'s 作为您的实体的主键。

然后，您可以选择评论，甚至事先不知道它们属于哪里：

```
SELECT CommentText
FROM Comments c, Restaurants r
WHERE c.Source = r.Id

SELECT CommentText
FROM Comments c, Chains ch
WHERE c.Source = ch.Id 
```

等等

当然，您不能将外键用于评论，但这并不是说没有外键就无法评论。

您可以清除触发器中的孤立评论，但如果留下一些评论也没什么不好。

您还创建了一个全局`Entity`表（只有一`GUID`列），创建您的`Chains`, `Restaurants`，`MenuItems`并使用 ,`Comments`引用该表`FOREING KEY ON DELETE CASCADE`，然后在`DELETE`创建餐厅时，将其从该表中删除。它将删除餐厅及其上的所有评论，您仍然保持诚信。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T18:13:47.820

如果您想利用外键约束并跨基表规范评论（和评分）的属性，您可能需要在基表和评论（和评分）之间创建关系表。

例如餐厅和评论：

```
Restaurants
  id (PK)
  (attributes of restaurants...)

RestaurantComments
  id (PK)
  restaurantid (FK to Restaurants)
  commentid (FK to Comments)

Comments
  id (PK)
  (attributes of comments...) 
```

# asp.net - 多用户控件和javascript

> ID：562152
> 
> 赞同：6
> 
> 时间：2009-02-18T17:54:31.080
> 
> 标签：asp.net, javascript

我在用户控件中包含一个 JS 文件。主机页面有多个用户控件实例。

JS 文件有一个全局变量，用作 JS 函数的标志。我需要将此变量的范围限制为用户控件。不幸的是，当我有多个控件实例时，变量值被覆盖。

在这种情况下推荐的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T18:07:19.287

一些选项是根据用户控件的 ClientId 动态生成 javascript。例如，您可以动态生成全局变量。

我推荐的另一种选择是将全局变量和函数封装在一个对象中，然后您的用户控件可以发出 JS 来创建该对象的一个​​实例（可以动态命名，从而让您根据需要确定对象的范围）。

# 编辑

我没有可以共享的工作代码示例，但是我以几种不同的方式完成了此操作。最简单的方法是在用户控件的标记中执行此操作。

```
<script language='javascript'>
   var <%=this.ClientID%>myObject=new myObject();
</script> 
```

假设您的控件具有 myControl 的 clientId，这将创建一个变量 myControlmyObject。

另一种方法是在后面的代码中生成脚本，您可以使用以下代码注册它：`Page.ClientScript.RegisterStartupScript()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T18:07:28.757

好吧，如果你必须保持当前的解决方案，你可以将你的全局变量重命名为类似下面的代码，它应该在你控制的 .ascx 文件中：

```
<script type='text/javascript'>
var <%= this.ClientID %>_name_of_global_variable;
</script> 
```

其中“this”是 asp.net 控件。这样，每个控件都有一个基于客户端 ID 的唯一变量名称。确保更新 javascript 的其余部分以使用这个新的命名约定。问题是，它看起来很乱，并且变量名称会变得很长，具体取决于控件在页面中嵌入的位置。

那有意义吗？它应该需要最少的 javascript 修改才能使其正常工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T18:14:34.120

我建议重构您的代码，以便所有常见的 JS 逻辑都存储在一个地方，而不是每个 UserControl 中。这将大大减少您的页面大小。

您可以将 UserControl 的 id 传递给常见的 JS 方法以区分 UserControl。

对于限制“UserControl”变量范围的问题，您可以存储某种 Key/Value 结构以保留特定于 UserControl 的值 - Key 将是 UserControl clientID，值将是您的变量'感兴趣。

例如：

```
var UCFlags = new Object();
//set the flag for UserControl1:
UCFlags["UC1"] = true;
//set the flag for UserControl2:
UCFlags["UC2"] = false; 
```

要访问它们，您只需将 UserControl 的 ClientID 传递给 UCFlags 数组：

```
myFlag = UCFlags["UC1"]; 
```

在服务器端，您可以将常量字符串“UC1”或“UC2”替换为

```
<%= this.ClientID %> 
```

像这样：

```
myFlag = UCFlags["<%= this.ClientID %>"]; 
```

即使大部分 JS 在单独的文件中，您仍然可以在此处使用 <%= this.ClientID %> 语法；简单地设置

```
UCFlags["<%= this.ClientID %>"] = value; 
```

在调用嵌入 JS 文件之前。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-22T21:46:19.493

我遇到了同样的问题，下面的博客文章解决了它。解决方案是对 javaScript 采取面向对象的方式

[将多个使用 JavaScript 的 .NET 用户控件添加到同一页面](http://www.iandevlin.com/blog/2009/12/webdev/adding-multiple-net-user-controls-that-use-javascript-to-the-same-page)

# vb6 - 如何将 VB6 应用程序从 XP 更新到 Vista？

> ID：562154
> 
> 赞同：3
> 
> 时间：2009-02-18T17:54:42.420
> 
> 标签：vb6, windows-vista, uac, windows-appcompat-platform

由于显而易见的原因（写入程序文件以及默认情况下不再允许的其他内容），我正在处理一个与 Vista 存在问题的 vb6 应用程序。

*   我应该在哪里存储应用程序数据或用户保存的文件？
*   我也需要在那里创建文件夹和文件的权限吗？
*   还有哪些常见的操作会导致问题？
*   该程序有一个必须下载和注册文件的更新程序，发生这种情况时如何提升权限？

其中一些问题有明显的答案，但我想把明显的东西弄清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T19:06:57.707

根据您所做的事情，您可能会陷入痛苦的世界。对于这些问题中的任何一个都没有硬性和快速的答案，但是我现在正在经历同样的问题，这就是我所知道的。

1) 我应该在哪里存储应用程序数据或用户保存的文件？

这取决于你想要做什么。如果您希望每个用户使用它们，请将它们存储在 Users/AppData 中，如果您希望它们用于所有用户，请将它们存储在 Common/AppData

```
 If SHGetFolderPath(0, CSIDL_COMMON_APPDATA, -1, SHGFP_TYPE_CURRENT, sTempPath) = 0 Then
      sCommonAppdata = Left$(sTempPath, InStr(1, sTempPath, Chr(0)) - 1) &  "CompanyName\AppName"
  End If 
```

将其更改为用户 AppData 目录的 CSIDL_APPDATA。注意：对于 XP 和 Vista，这些映射到文件系统上完全不同的位置，因此在调试时准备查看不同的位置。

2) 我是否也需要权限来创建文件夹和文件？

您需要管理员权限才能在 Program Files 中写入任何内容，如果可能的话，不要这样做！我们目前遇到的[问题](https://stackoverflow.com/questions/562337/vista-phantom-directory/562353)是用于 VB 的 API 和标准 API 在 Program Files 中的文件上表现不同。

3) 还有哪些常见的操作会导致问题？

有很多隐藏的陷阱。仅举几例，您无法通过 IPC 或命名管道与其他应用程序进行通信（我们有一个通过托盘通知图标与之通信的服务，并且必须完全重写）。您看到 UAC 通知的任何事情都非常困难。此外，您不能在没有管理员的情况下在 LOCAL_MACHINE 的注册表中写入任何内容，因此您必须坚持使用 LOCAL_USER 或提高凭据（见下文）。

4) 该程序有一个必须下载和注册文件的更新程序，当发生这种情况时，我该如何提升权限（原文如此）？

祝你好运，我强烈建议你不要用 VB6 编写它，就像我说的那样，VB6 文件 api 访问文件的方式似乎与标准 API 不同。如果您需要提升权限，请参阅有人帮助我的这篇[文章。](https://stackoverflow.com/questions/517607/elevated-credentials-for-vb6)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T18:00:28.273

在排序术语中[，关闭 UAC](http://blogs.msdn.com/tims/archive/2006/09/20/763275.aspx)并安装[ActiveX 安装程序服务器](http://www.vistaclues.com/install-the-activex-installer-service/)会有所帮助。从长远来看，您需要将数据和配置信息放在 \users 下的用户目录或 \programdata 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T18:06:25.530

从短期来看，可能根本不需要修改您的应用程序，因为 Vista 提供了一组兼容性选项以允许运行旧版应用程序。这包括文件和注册表虚拟化，该功能基本上将写入操作重定向到受保护的文件夹，例如 C:\Program Files 到仅对在兼容模式下运行的特定应用程序可见的虚拟位置。

本文中提到了更多细节：Dobb 博士的[如何管理 Windows Vista 应用程序兼容性。](http://www.ddj.com/windows/199001130;jsessionid=EIDRCEASOSGF2QSNDLPSKH0CJUNN2JVN?pgno=3)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T21:27:57.900

Karl Peterson 写了一篇关于在哪里存储用户数据和应用程序数据的[好文章，其中包含一个 VB6](http://visualstudiomagazine.com/articles/2009/01/19/lemme-tell-ya-where-to-stick-it.aspx)[类](http://vb.mvps.org/samples/SysFolders)，可以为您检索特殊路径的位置。

# java - 在 Java 中，如何将 XML 解析为字符串而不是文件？

> ID：562160
> 
> 赞同：265
> 
> 时间：2009-02-18T17:56:28.640
> 
> 标签：java, xml, string, file, parsing

我有以下代码：

```
DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(xmlFile); 
```

如何让它解析包含在字符串而不是文件中的 XML？

* * *

## 回答 #1

> 赞同：500
> 
> 时间：2009-02-18T18:10:14.287

我的代码库中有这个函数，这应该对你有用。

```
public static Document loadXMLFromString(String xml) throws Exception
{
    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    DocumentBuilder builder = factory.newDocumentBuilder();
    InputSource is = new InputSource(new StringReader(xml));
    return builder.parse(is);
} 
```

也看到[这个类似的问题](https://stackoverflow.com/questions/33262)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-18T17:59:56.387

一种方法是使用采用 InputSource 而不是文件的 parse 版本

可以从 Reader 对象构造 SAX InputSource。一个 Reader 对象是 StringReader

所以像

```
parse(new InputSource(new StringReader(myString))) may work. 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-18T18:02:14.087

将字符串转换为 InputStream 并将其传递给 DocumentBuilder

```
final InputStream stream = new ByteArrayInputStream(string.getBytes(StandardCharsets.UTF_8));
DocumentBuilder builder = DocumentBuilderFactory.newInstance().newDocumentBuilder();
builder.parse(stream); 
```

**编辑**
针对**bentin**关于编码的评论，请参阅**shsteimer**对此问题的回答。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-18T17:58:18.997

[javadocs](http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/parsers/DocumentBuilder.html)显示 parse 方法被重载。

使用您的字符串 XML 创建一个 StringStream 或 InputSource，您应该进行设置。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-09-07T09:48:58.083

我正在使用这种方法

```
public Document parseXmlFromString(String xmlString){
    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    DocumentBuilder builder = factory.newDocumentBuilder();
    InputStream inputStream = new    ByteArrayInputStream(xmlString.getBytes());
    org.w3c.dom.Document document = builder.parse(inputStream);
    return document;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-10T07:25:35.003

您可以使用 GitHub 上提供的 Scilca XML Progession 包。

```
XMLIterator xi = new VirtualXML.XMLIterator("<xml />");
XMLReader xr = new XMLReader(xi);
Document d = xr.parseDocument(); 
```

# c# - 无法让异常助手工作

> ID：562162
> 
> 赞同：0
> 
> 时间：2009-02-18T17:57:08.030
> 
> 标签：c#, wpf, visual-studio, exception

我有一个 C# WPF 应用程序，它使用了许多使用本机代码的程序集。我的问题是，大多数时候，当我的应用程序抛出异常时，异常助手不会出现 - 只有 Break/Continue/... 对话框。我当然在 Visual Studio 选项中打开了异常助手，并且在 Debug::Exceptions 对话框中选择了正在抛出的特定异常 (System.Windows.Markup.XAMLParseException )。我需要能够深入到被抛出的内部异常。我看到 EA 有时会出现 - 只是不可靠。我对 C# 和托管开发相当陌生，所以任何建议，无论多么基本，都会受到赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T18:02:24.073

如果您只需要访问内部异常，您可以这样做。对话框出现时按中断。然后选择 Debug -> Windows -> Locals。在 locals 窗口的顶部，您应该会看到一个名为 $exception 的值。这是当前的异常，深入研究该变量将允许您访问内部异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-30T15:59:48.380

我想我看到了同样的问题。我在两台显示器上开发，当visual studio 2k8在显示器1上运行时，异常助手弹出并正常工作。当 Visual Studio 在监视器 2 上时，助手在监视器 1 上短暂闪烁，然后消失。

我的“修复”是只使用监视器

> 1.  可能导致此问题的其他因素：我正在运行 ultra-mon 来管理我的桌面和显示器
> 2.  设置在显示器 1 的左侧。

# sql - 如何将 SQL 数据顺序从行更改为列？

> ID：562177
> 
> 赞同：2
> 
> 时间：2009-02-18T18:00:39.117
> 
> 标签：sql, asp-classic, ado

我有一段代码按字母顺序从网页上的数据库*ACROSS 3 列中写入数据。*

例子：

```
a 结果 b 结果 c 结果
d 结果 e 结果 f 结果
g 结果 h 结果 i 结果

```

我需要*按字母顺序显示它 DOWN the columns*，如下所示：

```
结果 d 结果 g 结果
b 结果 e 结果 h 结果
c 结果 f 结果 i 结果

```

请记住，我有大约 100 个数据结果，它将显示第一列中的前 1/3 降序，然后开始一个新列并继续，将其分成 3 个相等的部分。

我现在对行进行排序的代码是：

```
<% 
GL="<table width="+Z+"100%"+Z+"border=0 cellpadding=3 celspacing=3>"
sql="select * from guideDef order by guideDesc;"
rs.open sql,adoCon
colCount=0
do while not rs.eof
  colCount=(colCount+1) mod 3
  if colCount=1 then GL=GL+"<tr>" 
  GL=GL+"<td valign=middle id=menu1 width="+Z+"33%"+Z+">"+E 
  GL=GL+"<a href="+Z+"shop.asp?guide="+rs("guide")+"&city=Plantation"+Z+">"+E 
  GL=GL+rs("guideDesc")+"</a></td>" 
  if colCount=0 then GL=GL+"</tr>" 
  GL=GL+E
  rs.moveNext
loop
rs.close
if colCount=1 then GL=GL+"<td> </td><td> </td></tr>"+E
if colCount=2 then GL=GL+"<td> </td></tr>"+E
GL=GL+"</table>"
response.write GL
%> 
```

提前感谢您的帮助。我不写代码，所以我尝试了几个小时来改变它但没有成功。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T18:12:59.397

也许更好的解决方案是保留 SQL 并在应用程序代码中处理它，而不是作为查询的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T18:24:36.297

我相信这段代码会解决你的问题：

```
<%
Set rs     = Server.CreateObject("ADODB.RecordSet")
Set adoCon = Server.CreateObject("ADODB.Connection")

adoCon.Open "your connection string here"

Const COLUMN_COUNT    = 3

Const adOpenStatic    = 3

sql = "SELECT guide, guideDesc FROM guideDef ORDER BY guideDesc;" 
rs.Open sql, adoCon, adOpenStatic

CellsRemain = rs.RecordCount Mod COLUMN_COUNT
RowCount    = (rs.RecordCount - CellsRemain) / COLUMN_COUNT

Response.Write "<div>Rendering " & rs.RecordCount & " records to a " & _
               COLUMN_COUNT & " x " & RowCount & " table with " & _
               CellsRemain & " stand-alone cells.</div>"

Response.Write "<table width=""100%"" border=""0"" cellpadding=""3"" celspacing=""3"">" & vbCrLf

done = 0
cell = 0
While done < rs.RecordCount
  Response.Write "<tr>"  & vbCrLf
  While cell < COLUMN_COUNT And done < rs.RecordCount
    cell      = cell + 1
    done      = done + 1
    guide     = "" & rs("guide")
    guideDesc = "" & rs("guideDesc")
    url       = "shop.asp?guide=" + Server.UrlEncode(guide) + "&city=Plantation"
    Response.Write "<td>"
    Response.Write "<a href=""" & Server.HtmlEncode(url) & """>"
    Response.Write Server.HtmlEncode(guideDesc)
    Response.Write "</td>"  & vbCrLf
    If cell < COLUMN_COUNT Then rs.Move RowCount
  Wend
  If done < rs.RecordCount Then 
    rs.Move -1 * ((COLUMN_COUNT - 1) * RowCount - 1)
    cell = 0
  Else
    While cell < COLUMN_COUNT
      Response.Write "<td>&nbsp;</td>" & vbCrLf
      cell = cell + 1
    Wend
  End If
  Response.Write "</tr>" & vbCrLf
Wend

Response.Write "</table>" & vbCrLf
%> 
```

这会按照您想要的方式呈现您的表格：

```
AEH
BFI
CGJ
D

```

您可以使用`COLUMN_COUNT`常量来控制将创建多少列。该算法灵活地适应该数字。

代码的作用基本上是这样的：

1.  打开一个静态 RecordSet 对象，这样我们就可以在其中自由跳转
2.  计算我们需要显示所有记录的行数和列数
3.  `<tr>`
4.  分步跳下 RecordSet `RowCount`，绘制`<td>`s 直到`<tr>`满
5.  跳回我们在第 4 步开始的记录之后的记录
6.  `</tr>`
7.  如果仍有记录，请转到步骤 3
8.  渲染尽可能多的空单元格，以使表格格式正确
9.  完毕。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T18:02:14.773

查看使用 PIVOT AND UNPIVOT 命令。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T18:22:56.347

忽略有关使用交叉表的所有答案，他们没有阅读您的问题。

我要做的是将您的结果作为一个巨大的表格并将它们分成三个不同的集合，然后遍历每一行从集合一中插入项目一，然后是集合二，然后是集合三，等等，直到您用尽所有三个集合。

另一种选择是编写代码，该代码将向下一列直到使用三分之一的结果，然后移动到下一列，但考虑到 HTML 的排序方式，编写起来会有点困难。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T18:33:22.500

您可以将结果分为 3 部分（如果您知道行数）。在单独的 div 元素中将它们打印为 3 个单独的表格。然后，您可以使用 CSS 将 div 元素彼此相邻浮动。

如果这听起来像你想要做的，（因为你说你不写代码）让我知道你是否需要帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T18:19:29.773

这也称为交叉表查询。您需要使用带有一些聚合函数的 case 语句，请参见此处

[http://www.paragoncorporation.com/ArticleDetail.aspx?ArticleID=25](http://www.paragoncorporation.com/ArticleDetail.aspx?ArticleID=25)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-18T20:28:19.837

我会做这样的事情（在 C# 中）：

```
const int columns = 3;
string[] cells = GetCells(); // load your sql into this
string ret = "<table>";
int numRows = (cells.Length + columns - 1) / columns; // round up
for (int y = 0; y < numRows; y++)
{
    ret += "<tr>";
    for (int x = 0; x < columns; x++)
    {
        int elem = x*numRows + y;
        if (elem < cells.Length)
            ret += "<td>" + cells[elem] + "</td>";
        else
            ret += "<td>&nbsp;</td>";
    }
    ret += "</tr>";
}
ret += "</table>"; 
```

和 GetCells() 看起来像：

```
string[] GetCells()
{
    string sql = "SELECT guide, guideDesc FROM guideDef ORDER BY guideDesc";
    rs.Open(sql, adoCon, adOpenStatic);
    string[] ret = new string[rs.RecordCount]
    for (int i=0; i<rs.RecordCount; i++)
    {
        ret[i] = "<a href=...></a>";
    }
    return ret;
} 
```

# ruby-on-rails - mod_perl 和Passenger 如何在同一个Apache 服务器上运行？

> ID：562189
> 
> 赞同：0
> 
> 时间：2009-02-18T18:02:57.283
> 
> 标签：ruby-on-rails, apache, passenger, mod-perl

这甚至可能吗？

我有一个在Passenger 上运行的Rails 应用程序和一个需要在同一台服务器上运行的mod_perl 站点。我已经尝试设置两个 VirtualHost，并且我尝试只使用一个 VH 和一个别名/位置作为 mod_perl。在这两种情况下，Passenger 都会尝试为 mod_perl 应用程序提供服务，并告诉我它找不到正确的文件。有人知道我在做什么错吗？

这是我的设置自动取款机：

```
NameVirtualHost *:80
RailsAutoDetect off
<VirtualHost *:80>
   DocumentRoot (home of rails app)/public
   RailsBaseURI /
</VirtualHost>

 PerlModule Apache::DBI
 PerlRequire /opt/rt3/bin/webmux.pl

Alias /rt /opt/rt3/share/html <== mod_perl app
<Location /rt>
  AddDefaultCharset UTF-8
  SetHandler perl-script
  PerlHandler RT::Mason
</Location> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T19:49:20.180

好吧，现在我刚刚将它们设置为两个不同的虚拟主机，使用不同的端口进行连接。那行得通，但是我的网站使用起来有点乱，如果有人有更好的主意，我会全神贯注。谢谢。

编辑：得到它的工作！我最终在不同的端口上设置了两个 VirtualServer，然后使用 mod-proxy 将到 /rt 站点的流量重定向到 mod-perl VirtualServer（将Passenger 保留为默认值）。这很好用，最棒的是我的 mod_perl 网站认为它仍然与Passenger 在同一个地方，这也解决了我正在处理的许多兼容性问题。我知道我错过了一些简单的东西！只是提出这个问题，以防其他人对此有任何疑问。

# coding-style - 如何向您的同事证明他们编写了糟糕的代码？

> ID：562196
> 
> 赞同：18
> 
> 时间：2009-02-18T18:05:47.043
> 
> 标签：coding-style

我发现在目前的工作中继续工作有些困难。

代码库最近变得有点疯狂（但绝对不是我见过的更糟糕的情况），而且我很难处理代码的某些部分。我可能很愚蠢，但很可能只是因为它让我失去了很多动力去开始做一些难以理解的事情。

我的老板已经意识到了我的想法——我表达了这样工作的*感觉*。他让我举例说明哪里出了问题。当我指出两三个小问题时，他说“是的，好的”，但重构花了他很多钱，而且我们必须把产品拿出来（这不是我第一次听到）。

我不得不承认，这些例子并不是最有说服力的，但这个问题实际上很难解释。它由整个代码库中的许多微小的“错误决定”组成。（我们也看到这个问题是绝对主观的）。例如，错误的命名、处理空值、样板、不使代码可重用（或相反）等等。重新思考别人的代码以证明我会以不同的方式做这件事可能会很累。

你对如何处理这个有想法吗？我有点厌倦了每次都不得不去破解一个*快速的“n脏”代码库！*

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-18T18:33:10.050

**有时你的程序员同事做的事情**和你很不一样，你可能觉得很不对的事情实际上可能有积极的方面。我们都有我们来自的学校。我想我遇到过抱怨我不理解的事情的程序员，就像我自己觉得需要抱怨的事情一样频繁。

**确保您可以将您抱怨的内容推断为具体的劣势**。如果没有其他原因，您可以激励中层管理人员进行改进。难以推断为可衡量事实的事情通常源于品味/风格的差异而不是质量（有关于这个主题的书籍可供阅读）。***smacl***发布的答案有很好的具体建议！

如果您可以将您的担忧推断为真正的劣势，那么当人们说必须“接受”这样的情况时，我真的不同意。我不止一次接触过这个问题，我告诉你，重构不是解决问题的办法。**重构只能解决症状**。

**接受这样的情况就像说“*我的公司可以忍受质量差的产品线和昂贵且令人沮丧的维护*”**。这种情况当然很少。然而，管理层（即那些决定优先考虑哪些项目的人）通常在技术上不知道问题是什么，或者为什么开发成本高昂。他们不应该为此而存在。

这就是为什么您需要一个拥有技术主管、首席架构师、良好的组织结构和分层模型等的开发组织。如果您忽略开发的某些方面，经验丰富的软件专业人员已经看到了道路的走向。这是关于改变团队的“文化”。

要么你坚持你的公司并尝试**从根本上改变你做事的方式**，要么你找到另一个工作的地方，并确保你在面试中确切地了解他们在日常发展中是如何工作的。

祝你好运

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-18T18:52:31.580

我最近遇到了一个非常相似的问题，一位朋友给了我一些帮助很大的建议。他说：“别管它。”

他的意思是，你必须沟通这些问题，因为它们是真实的、代价高昂的问题，会在时间和金钱方面产生后果。但是当你进行沟通时，只谈论对**组织的影响。**不要向**你提及后果，**因为那样听起来就像在抱怨，会被忽略。

例如：

**不要**让自己置身事外：

“其他开发人员使用这些晦涩、误导性的标识符，然后**我**不得不花费数小时查看代码，试图找出它们的含义。这占用了**我**很多时间。”

让自己远离它：

“对类和变量名进行一些重构，并围绕标识符建立一些编码标准，这将非常有帮助且具有成本效益。直接的回报将是每个人都更容易理解的代码库，从而提高生产力。更长的- “长期回报将是以后我们将能够修改代码并更快地修复问题。如果在发布之前发现关键错误，那么可理解的代码库将非常重要。”

我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-18T18:23:25.753

**1) 让问题更加明显并获得管理层的支持**

在大约一个月的时间里，详细记录在各种编码任务上花费的时间。在月底分析和总结你老板的内容，即浪费时间，因此浪费金钱，以说明某种形式的改变是必要的。

**2) 考虑一种具有成本效益的前进方式**

例如; 与其重构整个代码库，不如将接口与实现分开，并在接口层执行更严格的标准，包括单元测试、命名约定等。因此，每个程序员都可以有信心使用他们没有编写的代码。虽然这在一定程度上扫除了地毯下的垃圾，但这是为更大规模重构做准备的好方法。

从管理的角度来看，重要的是工作流程不会中断，并且积极的结果是可见的，因此请相应地进行计划。

**3) 与您的同事商定长期改进**

坐下来与其他程序员商定未来代码的合理编码标准。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-18T18:18:33.660

也许你可以安排每月一次的会议，在这些会议上你可以展示好的和坏的代码。显然，您不想指手画脚，因此您希望使用基于您在项目中看到的内容的通用代码示例。通过这种方式，您可以建设性地从其他人那里以您的风格获得支持。您可能希望在会议结束后编译这些内容，以便人们可以轻松地参考它们。

我认为指出问题和抱怨真的很容易，但指导人们并帮助他们改变需要付出努力。这不是一件容易的事，但如果你在工作中遇到困难，也许这会给你一个很好的动力。您可能会在很长一段时间内学到一些东西。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-18T18:14:10.470

你会发现这是司空见惯的。你能做的就是接受不同的人做不同的事情。当您修复错误或添加功能时，您将获得一个简短的窗口，进入您可以改进的应用程序的子部分。当你处理代码时，你可以让它变得更好，他们不需要知道你是在零敲碎打地改进代码。

不过要非常小心。有时代码的编写方式看起来“被黑”了，但解决了一个不容易识别的错误。特别是如果它是经过尝试和测试的旧代码。

另一方面，抱怨只会让你被视为抱怨者。想想你想要什么结果，什么行动最有可能产生这个结果。当您问“我可以做 X 天的工作而绝对没有明显的结果吗？”时，您总是会听到“不”的答案？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-18T18:16:15.553

你可以放弃并希望找到更好的东西。

**或者**，您可以坚持下去并尝试改进您可以控制的代码，当您可以控制它时。无论开发人员的意图有多好，如果有多个开发人员，则代码库按照合格的开发人员标准将是“丑陋的”。与其他开发人员合作以提高他们的能力并在您进行增强时重构代码。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-12-30T18:41:31.187

对于初学者：

1.  强制使用静态代码分析工具。每种语言都有一些众所周知的工具。

2.  展示一些重构前后的代码示例，并解释为什么你认为它更好。尽量不要让任何人当场。

3.  由经验丰富的开发人员进行代码审查。

4.  请记住，无论您如何尝试，都无法帮助一些开发人员...

5.  如果有人批评你的代码要有礼貌和思想开放，你可能会学到一些东西。

6.  [圈复杂度](https://en.wikipedia.org/wiki/Cyclomatic_complexity)/变更集/错误的数量。复杂的代码更容易出错，导致更多的错误导致更多的变化，这会花费更多的钱！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-18T18:12:00.460

99% 的时间你永远无法选择与你一起工作的人。并非所有的关系都能奏效，无论它们是否有效。

最好将您的项目分解得足够多，以便每个开发人员都可以为其他人的需求做出贡献，这样程序员就不会互相干涉。

让人们改变他们的编码风格很难。它需要一个致力于此类事情的铸铁技术领导，并且在您提出它时会有所帮助。管理类型无法做到这一点，领导需要提供技术细节。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-18T18:13:19.163

在我看来，您对*代码*的问题并不像您的*同事*那样有问题。您可能很难强制进行您希望看到的更改。您最好的选择可能是开始更新您的简历并留意其他机会

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-18T18:16:52.663

我认为，一旦你陷入困境，你就没有很好的机会把事情做好，你只需要把它们做好。我想说大多数开发人员不喜欢救火并且想要理想的代码库，但在我看来，这需要您花时间预先规划系统。

我建议您尝试与您的经理合作，以确保您认为现在缺少的领域在下一个项目中不会缺少。也许它让你处于领先地位，与同行进行更多的代码审查，也许它是对整个团队的进一步培训。

无论哪种方式，我认为这是我们大多数人都会经历的事情。我同意另一个人对此提出的谨慎建议。我知道我昨天写的代码当时看起来很棒，回顾它，可能可以找到 10 种其他方法来做到这一点，让它看起来更干净。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-18T18:17:26.157

您是否考虑过将 fxcop 添加到自动构建中以强制执行编码风格？除此之外，您可以尝试建议 TDD，这将赋予编写测试的任何人以确保每个类的接口以特定方式构造的权力。

在我的脑海中，这就是我能想到的全部。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-18T18:19:23.407

生活中的事情并不完美，如果你开始吹毛求疵，羽毛就会被弄乱，人际关系会变质。

最好的方法是仔细挑选你的战斗。如果某些东西足够小，请忽略它并忍受它。如果它是大而有价值的（即管理层认为投资回报率在支持你）那就去吧。

这很适合你的情况...

上帝，请赐予我平静去接受我无法改变的事情的勇气，以及改变我能改变的事情的勇气，以及辨别差异的智慧。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-18T18:21:08.707

我尝试做的一件事可能会对您有所帮助。如果代码的一部分是坏的，并且你建议修复它的想法是最好的，但是给出了“没有时间”的借口，你为什么不重写它呢？说你自己的时间？如果您决定在该工作上停留一段时间，那只会对您有所帮助。只有你会学习并成为更好的程序员。

请注意，这是一个好主意，我什至会说是必需的，在签入之前对该更改进行完整的代码审查，并且您应该尝试对签入进行计时，以便它在发布的完整回归测试周期之前. 这样你的重构就被完全测试过了。在 6 个月左右的时间里，它将开始显示出有益的影响，然后您可以要求为此分配时间，并提供证据支持。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-18T18:21:11.860

唯一有机会说服管理层的事情就是证明你所引用的作为感知问题的事情变成了**实际**问题。

要尝试利用这一点，请尽量将“抱怨者”的语气降到最低，即关注这如何影响底线，而不是它给你带来的感受。指出您看到做出的错误决定的可能后果。如果这些后果发生了，并且它们的成本超过了预先修复的成本，请温和地提醒管理层您已经预见到了困难，并就如何通过一些预先的努力来避免未来的类似成本提供有用的建议。

问题是，在许多组织中，这些问题永远不会引起管理层关注的足够多的问题，或者即使他们这样做，他们也不会看到您对问题的看法与实际问题发生方式之间的联系。在这些情况下，你最终看起来像一个不必要的挑剔的技术人员，这不是你想要的声誉。

所以我的建议是，选择你的战斗。如果有一些非常令人震惊的事情要让其他人漏掉，那么你可以说出来，也许以后会被证明是正确的。对于那些只会磨砺你的小细节，恐怕你无能为力，只能忍受。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-18T19:23:46.263

**向他们展示他们自己被遗忘的代码，伪装成你的代码以供批评。**

*   拿一段他们忘记的旧代码
*   假装你写的
*   让他们用它找出一些东西
*   确保他们指出代码有多糟糕，无论出于何种原因
*   添加您自己的项目。集思广益应该做什么，因为这是你的错。
*   让他们知道你不知道如何提出来冒犯他们，但这是他们的代码。

如果他们记得是*他们*写的，他们可能会赶上..

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-18T18:19:36.993

如果您与您的经理关系良好，您也许可以利用这一点让自己成为“高级”或“领导”开发人员角色。你可以建议最好是团队中的一个人负责代码库的技术领导。您的工作是审查他人的代码，并在您认为有必要时要求他们进行改进。如果你走这条路，一定要慢慢走。如果你很快要求很多，那么你最终可能会惹恼所有其他开发人员。

# .net - .NET 应用程序中的窗体或控件的多种模式？

> ID：562204
> 
> 赞同：0
> 
> 时间：2009-02-18T18:09:31.777
> 
> 标签：.net, forms, user-interface, controls

对于通过赋予多种模式在 WinForms .NET 应用程序中重用窗体或控件是否是糟糕的设计是否有任何意见？我经常发现自己想要这样做。我将有一些需要在多个地方使用的 UI，而不是重用代码，我会给表单一个模式来确定显示的文本、某些元素是否可见以及如何元素被定位。

不过，这似乎总是有点麻烦，所以我想知道是否有人以不同的方式解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T18:28:29.767

我认为这归结为您向单个表单添加不同的模式。例如，隐藏单个复选框的模式比交换大部分控件的模式更容易维护。只有您可以决定您的表单在此范围内的位置。

我也会尝试识别和使用技术来最小化多种模式的复杂性。一些想法浮现在脑海：

*   采用分层的方式将业务逻辑与展示分离
*   将相关控件系列放在一个可重复使用的单元中（例如 Panel 或 UserControl）
*   使用诸如 PropertyGrid 之类的组织控件，它可以反映和显示所选对象的属性，而不是根据对象的类在表单中手动隐藏或显示控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T18:27:16.227

我想说，只要表单足够“小”，模式不会造成维护噩梦，并且只要每个模式的功能密切相关，那么它应该没问题。在某些时候，如果维护变得比它的价值更麻烦，您可能需要将事情分开。

例如，我有一个表单，它既可以用作给定客户的联系信息列表，也可以用作一般的“搜索联系人”表单。在构造函数中，是否传递客户 ID 会告诉表单处于何种模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T18:28:19.313

只有当表单正在编辑的数据相同但上下文不同时，我才会这样做。在这些情况下，我经常向表单传递上下文枚举，表单使用它来启用/禁用某些字段，或更改某些文本。

例如，我现在在应用程序中的一个表单允许我编辑“通道”（多路复用通道）。当我使用表单创建“新”频道时，频道名称是一个可编辑字段。但是，当我编辑现有频道时，名称是我不想更改的关键字段，因此该字段被禁用。它是完全相同的表单，但表单会根据上下文确定该字段是否被禁用/启用。

最后，我认为这是一种相当普遍的做法。

# c++ - typedef 标准容器？

> ID：562209
> 
> 赞同：3
> 
> 时间：2009-02-18T18:10:17.750
> 
> 标签：c++, templates, typedef

我想做

```
typedef deque type; //error, use of class template requires template argument list
type<int> container_; 
```

但是那个错误阻止了我。我该怎么做呢？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-18T18:28:14.760

你不能（直到 C++0x）。但它可以用以下方式模拟：

```
template<typename T>
struct ContainerOf
{
  typedef std::deque<T> type;
}; 
```

用作：

```
ContainerOf<int>::type container_; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-18T18:14:24.433

deque 不是类型。它是一个模板，用于在给定参数时生成类型。

```
 deque<int> 
```

是一种类型，所以你可以这样做

```
 typedef deque<int> container_ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T18:11:41.553

你不知道，C++ 还不支持这种类型定义。你当然可以说；

```
typedef std::deque <int> IntDeque; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T18:15:15.897

你遇到了一个错误，因为你错过了在双端队列中指定 int。

但请注意：[模板 typedef](http://en.wikipedia.org/wiki/C%2B%2B0x#Template_typedefs)是公认的 C++0x 功能。尝试使用最新的 g++

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T18:16:27.190

你可以这样做的方法是：

```
#define type deque 
```

但这有几个缺点。

# c# - 多列主键映射到 Dictionary<>... 又名 Struct 与 Class

> ID：562213
> 
> 赞同：0
> 
> 时间：2009-02-18T18:11:31.693
> 
> 标签：c#, .net, data-structures

所以我一直在试图找出最有效的方法来完成这个技巧：

我在数据库中有一个两列主键（一个 int 和一个字符串），我正在尝试制作一个缓存（我喜欢使用字典），我需要有一种方法来引用这两个值作为获取的键反对。

关键是

```
private struct PageNameOnSite
{
    public int siteId;
    public string pageName;
} 
```

有人建议我创建一个类来包装它，但这听起来不是使用内存的最佳方式，一旦这个东西放入了 10,000 个条目。我的理解是结构的内存占用小于类的内存占用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T18:16:47.953

为什么不使用PageNameOnSise 键来访问Dictionary？你需要覆盖一些东西，但这还不错。

```
private struct PageNameOnSite
{
    public int siteId;
    public string pageName;
    public override bool Equals(object obj) {
      if ( !obj is PageNameOnSite) { return false; }
      var other = (PageNameOnSite)obj;
      return sideId == other.siteId && StringComparer.Oridinal.Equals(pageName, other.pageName);
   }
   public override int GetHashCode() { return sideId + pageName.GetHashCode(); }
} 
```

然后您可以使用带有 id pageName 对的快速查找

```
public static object Loopup(Dictionary<PageNameOnSite,object> map, int id, string name) {
  var key = new PageNameOnSite() { siteId = id, pageName = name};
  return map[key];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T18:45:36.387

这是一个符合 KISS 的答案：

为什么不生成一个字符串作为您的键，例如site|page，即对于site = 1 和page=default.aspx，使用1|default.aspx？

我意识到这不是很酷的 OOP 方式，但是如果您的密钥发生更改，您无论如何都会更改代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T18:23:24.380

如果您确实选择使用您提到的课程选项。这是很有可能的，Code Project 发布了一篇很棒的[文章](http://www.codeproject.com/KB/cs/dictionary_customkey.aspx?display=Print)。

简而言之，您使用一个类作为键并定义一个自定义比较器。正如您所说，类可以比结构具有更大的占用空间，而这个会。另一个问题是，如果你确实需要在本地使用超大的数据集合，也许有更好的方法。

也许您应该使用“移动”数据库，而不是将其加载到内存中，大多数功能齐全的数据库都提供了这些精简、易于部署的替代方案。祝你好运！

# asp.net - CSS 文件被引用两次

> ID：562226
> 
> 赞同：3
> 
> 时间：2009-02-18T18:14:41.717
> 
> 标签：asp.net, css

我有一个使用主题、iframe 和母版页的 asp.net Web 应用程序。我用 IE Web developer 和 FF Firebug 分析了这些页面，发现每个页面都引用了同一个 css 文件两次。我不知道这是因为母版页模型还是因为 iframe。任何人都知道如何只引用一次 css 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-03-21T12:15:36.053

我遇到了同样的问题，我发现了我的情况 -
添加到 web.config 时：
`<pages styleSheetTheme="Default" theme="Default"></pages>`

.css 文件将被渲染到源两次，与仅添加 : 不同
`<pages theme="Default"></pages>`
，然后它只会被渲染一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T05:52:36.033

如果您在配置中设置页面主题，则会自动引用 App_Themes/YourTheme 文件夹中的所有 .css 文件。

```
<system.web>
    <pages theme="ThemeName">
        <controls>
        </controls>
    </pages>
<system.web> 
```

因此，您不需要添加对 CSS 文件的任何引用。

但是有一个问题，CSS 文件将按字母顺序引用（据我所知，无法更改），因此如果您希望一个 .css 文件覆盖另一个文件，则需要注意文件名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T18:22:20.890

您是否从内容页面引用此 CSS 文件？如果是这样，这将导致 CSS 被引用两次。您不需要从内容页面引用 CSS，只需从母版页引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T18:22:35.193

iframe 是一个独特的渲染上下文，所以你真的无法合理地绕过它需要加载它的 CSS。如果它使用与嵌入页面相同的样式表，那么是的，该样式表将被引用两次。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T18:28:32.433

我猜你的答案是停止使用 IFRAME。如果您需要使用可重用的内容块，您可以嵌套母版页。人们使用 IFRAME 的一个原因是当他们从远程站点提供内容时，但既然你说它调用的是同一个 CSS 文件，情况并非如此。

有关 IFRAME 正在做什么的更多信息会有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-19T08:07:51.300

我只在我的一些 aspx 页面上遇到了同样的问题，我刚刚修复了它。我在`StyleSheetTheme`每个 aspx 页面继承的基类中覆盖和设置属性。现在，如果我`StyleSheetTheme`在标记页面中另外设置，链接定义会呈现两次。手动设置`Theme`属性时可能会发生同样的情况

```
<%@ Page Title="My Page" StyleSheetTheme="DefaultTheme" Language="C#" MasterPageFile="~/Master.Master" AutoEventWireup="true"
    CodeBehind="Details.aspx.cs" Inherits="MyProject.Article.Details" %>
```

# silverlight - Silverlight 资源 dll 构建预防

> ID：562227
> 
> 赞同：7
> 
> 时间：2009-02-18T18:14:53.450
> 
> 标签：silverlight, build-process

当您构建 Silverlight 应用程序时，它总是将一大堆本地化资源 dll 输出到`\bin\de\` `\bin\es\` `\bin\fr\` etc 中（最终可以打包在 .xap 中）。这太棒了，但我没有使用这些，它们不是应用程序运行所必需的，它们会弄乱我们 TFS 构建服务器的根目录。

我意识到 TFS 2K8 存在一个小错误，该错误很容易修复，以确保这些文件不会被转储到构建服务器的根目录中，但是我最理想的做法是防止生成这些文件。

我已经尝试了所有方法来阻止创建这些文件。因为它们实际上直到构建时才存在，所以我不能告诉它们不要输出。

我发现了大量关于本地化/全球化、这些文件如何工作以及许多操作它们的方法的信息，但一开始就没有阻止它们构建的信息。

有谁知道我可以阻止这些出现在 \bin\ on build 的方法？我可以在构建选项或类似的东西中使用开关吗？

编辑。我想要一种方法来防止这种情况发生。它可以通过构建后事件进行清理，但这远非理想。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-08-25T14:09:07.257

我在另一个 StackOverflow 线程中回答了这个问题：[使用 Team Build 构建时 Silverlight 项目的语言文件夹](https://stackoverflow.com/questions/5349096/language-folders-for-silverlight-projects-when-building-with-team-build/7081384#7081384)

打开 Windows 资源管理器。转到 C:\Program Files\Microsoft SDKs\Silverlight\v4.0\Libraries\Client。（如果您运行的是 64 位 Windows，则 C:\Program Files (x86)\Microsoft SDKs\Silverlight\v4.0\Libraries\Client\）。在那个位置，你会看到一堆语言/文化文件夹。

*   新建一个文件夹。我将我的命名为“未使用的文化”。
*   将您不想使用的所有区域性文件夹移动到新文件夹中。确保不要移动文件夹列表中文化文件夹中间出现的“设计”文件夹。
*   在您的项目中，删除 Bin、Release 等文件夹的内容。重建。
*   当您想添加对另一种文化的支持时，只需将您想要的文化移回原始位置即可。

每当您获得 Silverlight SDK 的更新时，您可能必须再次执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-20T20:24:16.797

如果您在构建项目后查看这些文件夹，您将在其中看到一堆 dll 和/或资源文件。您在文件夹中看到的 dll/资源是导致文件夹本身生成的原因。由于您在项目中引用这些 dll，因此在构建项目时，引用会从 SDK 文件夹（或引用它们的任何位置）中获取这些文件。

因此，例如，如果您查看 System.Windows.Controls.dll，它将安装在 %ProgramFiles%\MicrosoftSDKs\Silverlight\v3.0\Libraries\Client 文件夹中。在该文件夹中，您将看到构建时生成的相同文件夹（de、fr、it 等）。所以为了防止这些被生成，你可以做几件事。

1) 将 dll 复制到一个单独的文件夹并引用该文件。我实际上必须从 sdk 文件夹中删除 dll 才能在 VS 2010 中使用该引用，但不确定该引用是否会在 2008 年修复。

2) 从 SDK 本身重命名或删除全局文件夹和文件。这将影响所有项目，而不仅仅是您的单个项目，但它可能会为您解决问题。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T09:54:11.647

在 Post-built 事件中：

```
rmdir /Q /S $(TargetDir)de
rmdir /Q /S $(TargetDir)fr
rmdir /Q /S $(TargetDir)it
rmdir /Q /S $(TargetDir)ja
rmdir /Q /S $(TargetDir)ko
rmdir /Q /S $(TargetDir)zh-Hans
rmdir /Q /S $(TargetDir)zh-Hant
rmdir /Q /S $(TargetDir)es 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T20:15:32.397

使用后期构建步骤来清理不需要的东西怎么样？为此：右键单击项目 -> 属性 -> 构建事件 比在后期构建中，您可以使用标准的 Windows 命令行命令。

# jquery - 如何在 jQuery 中触发 $().ready()？

> ID：562229
> 
> 赞同：13
> 
> 时间：2009-02-18T18:15:24.353
> 
> 标签：jquery

使用 jQuery，有没有办法`document.ready`在页面加载后的某个时候重新触发触发器？

更新：一旦它们运行，jQuery 就会摆脱它们。`().ready`在我的实验中，一旦`ready`触发初始事件，jQuery 就会在遇到它时立即运行回调。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-18T18:25:18.917

如果您只需要确保新的初始化函数能够运行，则无需执行任何操作。当您在 中添加新的事件处理程序时`$().ready`，文档完成加载后，它将立即运行。

显然，直接调用`$().trigger("ready")`是行不通的，因为 jQuery 在运行就绪事件处理程序后会重置它们。您将需要跟踪您需要调用的函数，并直接调用它们，如下所示。

当然，直接调用函数可能会更好，这样您就不会重新运行您不打算执行的操作（某些插件可能有自己的 $().ready() 函数，而这些函数是他们没想到的运行两次）。

```
$().ready(initializationFunction);

// later:
initializationFunction(jQuery); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-08-05T18:52:46.090

你可以这样做：

```
$(document).on('ready readyAgain', function() {
    // do stuff
});

// At some other point in time, just trigger readyAgain
$(document).trigger('readyAgain'); 
```

### 笔记：

`$(document).on('ready')`[根据文档](http://api.jquery.com/ready/)已在 jQuery 1.8 中弃用。另一种方法如下：

```
function myReadyFunction(){}
$(myReadyFunction);

// at some other point, just call your function whenever needed:
myReadyFunction($); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-09-03T13:04:42.703

如果您尝试将模块执行控制器直接构建到就绪函数中会怎样？有点像这样：

[https://gist.github.com/miguel-perez/476046a42d229251fec3](https://gist.github.com/miguel-perez/476046a42d229251fec3)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T18:19:09.350

Aaron - 你想完成什么，重新初始化变量？

已编辑...在我看来，jQuery 的美妙之处在于回调函数。为什么不在事件之后执行一些动作/功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-24T09:11:01.093

在某些情况下，您需要在代码的其他位置添加更多代码（脚本），因此创建函数会限制您在同一区域编写所有代码。这就是为什么我更喜欢添加我的自定义事件，然后触发它们：

```
//Add a page Ready custom event
$( document ).on( "page.ready", function( event ) {
    //Your Ready Scripts
});

//Add a page Load custom event
$( document ).on( "page.load", function( event ) {
    //Your Load Scripts
});

//Trigger Ready scripts on page ready
jQuery(function($) {
    $( document ).trigger( "page.ready" );
});

//Trigger Load scripts on page load
$(window).load(function () {
    $( document ).trigger( "page.load" );
});

//Trigger the Custom events manually
$( document ).trigger( "page.ready" );
$( document ).trigger( "page.load" ); 
```

[https://learn.jquery.com/events/introduction-to-custom-events/](https://learn.jquery.com/events/introduction-to-custom-events/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-04T19:22:22.873

我可以看到这将非常有用的一种情况，即如果您延迟加载 jQuery，直到其他所有内容都加载完毕，然后您动态附加一个新的脚本元素来加载 jQuery。

在这种情况下，$(document).ready 并不总是被触发，因为在许多情况下，文档会在 jQuery 完成加载并设置正确的事件处理程序之前完全加载。

您可以使用命名函数并调用它们，但它仍然会破坏任何依赖 $(document).ready 的插件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-15T17:18:15.097

如果对您有帮助：

```
var document_on_ready = new Array();

function on_ready(){
   for(i=0;i<document_on_ready.length;i++){
      document_on_ready[i].call();
   }
}
$(function(){
   on_ready();
});

var counter = 0;
document_on_ready.push(function(){
   counter++;
   console.log('step1: ' + counter);
});

document_on_ready.push(function(){
   counter++;
   console.log('step2: ' + counter);
});

window.setTimeout(on_ready,1000); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-07-20T09:21:32.403

简单：您只需要禁用安全标志 jQuery.isReady。将 jQuery.isReady 设置为 false 并使用 jQuery(document).trigger('ready') 重新触发此事件。这对于 turbolinks 风格的导航非常有用。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-08-04T19:26:50.507

ASP.Net UpdatePanel 部分页面加载是另一个可能需要重新触发加载功能的地方 - 这不是`$().ready`执行此操作的正确位置。在这种情况下，您可以使用 page_load 或 MS 框架的 endrequest 事件。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-02-18T18:20:09.647

您应该可以使用 document.ready.apply();

# java - 如何将 xslt 生成的错误消息传递给 java 应用程序调用者

> ID：562241
> 
> 赞同：3
> 
> 时间：2009-02-18T18:19:06.950
> 
> 标签：java, xml, xslt

我使用 java 应用程序调用 xslt 来进行 xml 转换。如果发生某种情况，xslt 文件将生成一条消息并终止进程。但是，我的 java 应用程序无法捕获 xslt 生成的错误消息，它只能捕获带有一般信息的异常 - “样式表定向终止”。

这是我的java代码：

```
SAXTransformerFactory saxTFactory = ((SAXTransformerFactory) tFactory);
    // Create a TransformerHandler for  stylesheet.
    File f2 = new File(styleSheetPath); 
```

TransformerHandler tHandler2 = saxTFactory.newTransformerHandler(new StreamSource(f2));

XMLReader 阅读器 = XMLReaderFactory.createXMLReader();

```
reader.setContentHandler(tHandler2);
reader.setProperty("http://xml.org/sax/properties/lexical-handler", tHandler2);

    CharArrayWriter outputWriter  = new CharArrayWriter();
    Result result = new StreamResult(outputWriter);
    tHandler2.setResult(result);

    try
    {
      reader.parse(new InputSource(new StringReader(XMLinput)));
    }
    catch(Exception ee)
    {
        dsiplay(ee.getMessage())
        throw ee;
    } 
```

如何从 xslt 捕获错误消息？

我试图写一个类：

私有类 MyErrorHandler 扩展 DefaultHandler{

```
 public void error(SAXParseException e)
  {
      System.out.println("error method "+e.getMessage());
  }

  public void fatalError(SAXParseException e)
  {
      System.out.println("fatal error method "+e.getMessage());
  }

  public void warning(SAXParseException e)
  {
      System.out.println("warning method "+e.getMessage());
  } 
```

和

```
MyErrorHandler myHandler = new MyErrorHandler();

reader.setErrorHandler(myHandler); 
```

它没有用。

你有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T19:12:27.320

看起来好像您在源文档 XML 解析器上放置了一个错误处理程序，但正试图从转换器中捕获错误。所以将错误处理程序放在`Transformer`而不是`XMLReader`

```
tHandler2.getTransformer().setErrorListener(myHandler); 
```

IIRC，我一直保持简单并`Transformer`直接使用而不是使用`ContentHandler`/ `TranformerHandler`。

作为替代方案，您可以使用特定于实现的扩展或导致解析并处理特殊的 URI（尽管 XSLT 是一种函数式语言，我猜它可以在技术上解析不会实际影响结果的 URI）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T18:25:05.157

XSLT 以何种方式生成错误并终止？这可能很关键，因为 <xsl:message> 标记并不总是像您预期的那样写入标准输出。尤其是撒克逊人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T18:37:30.103

非常感谢您的回复。这是我的 xslt 代码：

```
<xsl:template match="*[not(*) and ((text() and not(normalize-space(text()) != '')) or .='') 
       and name(.) != 'para' and name(.) != 'recordDelimiter' and name(.) != 'physicalLineDelimiter' and name(.) != 'fieldDelimiter' ]">
      <xsl:message terminate="yes">
        <xsl:call-template name="output_message3_fail">
          <xsl:with-param name="current_node" select="name(.)"/>
        </xsl:call-template>
      </xsl:message>
 </xsl:template>

 <xsl:template name="output_message3_fail">
    <xsl:param name="current_node"/>
    <xsl:text>
      Conversion to EML2.1 failed:
      The EML 2.0.1 document has empty string value in some elements which shouldn't be empty string in EML 2.1.0 sepcification - </xsl:text>
    <xsl:value-of select="$current_node"/>
</xsl:template> 
```

我`<xsl:message>`用来生成错误消息。

# installation - RemoveExistingProducts 操作的自定义属性

> ID：562249
> 
> 赞同：0
> 
> 时间：2009-02-18T18:20:37.710
> 
> 标签：installation, windows-installer, upgrade

执行`RemoveExistingProducts`操作时，MSI 设置两个属性

*   升级产品代码={...}
*   删除=全部

如何为此操作添加自定义属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T18:43:46.457

`RemoveExistingProducts`是一个内置的安装程序命令，您无法更改它。

如果您想在此之后做某事，您必须查找它被调用的所有位置（可能在 InstallExecuteSequence 中）并调用您的自定义操作、设置属性或之后的任何内容。

# ruby - 这是在 Linux 上拒绝远程连接到 jssh 的正确方法吗？

> ID：562250
> 
> 赞同：0
> 
> 时间：2009-02-18T18:20:55.447
> 
> 标签：ruby, security, watir, firewatir, jssh

我不知道 jssh 是否内置了任何安全性。在测试网络应用程序时，我只希望能够从 localhost 连接到 jssh。我在 iptables 中添加了以下几行：

```
 iptables -A INPUT -p tcp -s 0/0 --dport 9997 -j LOG
iptables -A INPUT -p tcp -s 0/0 --dport 9997 -j DROP 
```

他们会提供我需要的安全吗？

编辑：这与编程有关。测试是用 ruby​​ 编写的。但是要使测试正常工作，必须启用 jssh。默认情况下，jssh 在端口 9997 上运行并接受所有传入连接。连接后，它会接受来自已连接用户的命令。想象一下，如果有人连接到由具有管理权限的用户运行的 jssh shell 可能造成的潜在危害。

EDIT2：仅仅因为我编写的代码没有问题，这并不意味着应该忽略这个问题。我认为这是一个合理的问题。我想知道我是否可以控制我正在使用的工具之一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-10-10T02:48:42.537

您是否测试过默认配置是否允许来自本地主机外部的连接？

AFAIK，默认情况下它绑定到 127.0.0.1（仅本地主机），而不是 0.0.0.0（所有接口）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-12T10:56:18.130

SSH 仅接受来自经过身份验证的用户的连接。这*只是*安全性。你的问题还不清楚。

# ubuntu - 如何在 Ubuntu 的 CLISP 下包含“port”包

> ID：562255
> 
> 赞同：4
> 
> 时间：2009-02-18T18:22:14.320
> 
> 标签：ubuntu, package, lisp, require, clocc

我正在尝试遵循本教程： [http ://cl-cookbook.sourceforge.net/sockets.html](http://cl-cookbook.sourceforge.net/sockets.html)

由于端口包，我无法让它工作。首先`(in-package :port)`不起作用，它说找不到包。所以我将其更改为，`(clc:clc-require :port)`但这会导致另一个错误：

```
INTERN("STRUCTURE-KCONSTRUCTOR"): #<PACKAGE SYSTEM> is locked ... 
```

在ubuntu下我应该怎么做才能让它工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T13:54:40.363

不幸的是，cl-cookbook 仍然引用 CLOCC 的 PORT。我特别推荐反对 PORT 和一般的 CLOCC。

好消息是存在更新、更好的套接字库，使用它们不会有太多麻烦。以下是您的选择：

*   [usocket](http://common-lisp.net/project/usocket/)是一个可移植库，它抽象了各种 Lisp 实现中的套接字特性。它是 trivial-sockets 的精神继承者，如今许多 Common Lisp 库都依赖于 usocket。

    **我向新用户推荐 usocket。**

*   另一个竞争者是[iolib](http://common-lisp.net/project/iolib/)，它使用 FFI 重新实现套接字，而不是在实现的设施上构建。它还具有其他雄心勃勃的创新，例如替代 Common Lisp 路径名、I/O 多路复用和它自己的流抽象。

    愿意阅读源代码和单元测试的程序员会发现 iolib 很有趣，但它仍然处于不断变化的状态并且缺乏文档。

    **我向狂热的黑客推荐 iolib。**

许多安装方法是可能的。作为 Ubuntu 用户，您可以只使用 aptitude：

```
$ aptitude install cl-usocket
$ clisp
[1]> (asdf:operate 'asdf:load-op :usocket) 
```

请注意 Debian 和 Ubuntu 中的 Common Lisp 包通常已经过时并且与上游有很大不同。如果您正在在线寻求帮助，如果您切换到这些软件包的上游版本，您将获得更多有用的响应。

我个人使用 Debian，但运行[clbuild](http://common-lisp.net/project/clbuild)而不是 Lisp 的 Debian 软件包。请注意，clbuild 需要上游 CLISP，而不是 Ubuntu 提供的 CLISP。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T18:42:36.940

使用`apt-get install cl-port`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T18:32:03.597

看看**asdf-install**。设置好之后，lisp 包的安装非常简单：

```
(require 'asdf-install)
(asdf-install:install 'package-name) 
```

无论如何，clisp 已经不再使用了。看看**SBCL**，它是最广泛使用的通用 lisp 实现。

此外，要学习 common lisp，您最好从**Practical Common Lisp**作为一本优秀且免费的书开始。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T19:48:45.580

`require`和`in-package`是两个不同的东西。

*   **`require`**将某些代码加载到正在运行的 lisp 映像中，以使其可用（如果它不存在）。
*   **`in-package`**将“当前”命名空间更改为某个包，以便您可以在没有包前缀的情况下调用该包中的对象（例如`split`，而不是`cl-ppcre:split`）。当然，这个包必须已经“存在”在运行时中。

# maintenance - 每 1000 行代码需要多少维护开发人员

> ID：562265
> 
> 赞同：6
> 
> 时间：2009-02-18T18:23:42.540
> 
> 标签：maintenance

我们有一个非常庞大的项目，有 20-30 个模块，但大部分都完成了。它处于维护阶段（主要是错误修复，很少有新功能）。我正在尝试提出一些维护产品所需的开发人员。

有没有衡量这个数字的好方法？

该项目主要是基于 WinForm 的 C# 应用程序（.net 1.1 和 2.0 的混合）以及少量 vb6 应用程序。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-18T18:28:48.160

这将完全取决于代码质量、更改频率和测试级别。

例如，一个具有数千行代码但很少更改的系统和一个完整的单元/集成测试库可能比一个经常更改且没有测试的小型系统需要更少的开发人员。

另一个重要因素是所涉及的开发人员的经验，不仅是一般的经验，而且特别是他们对特定项目的理解。

最后，这是一个很难估计的统计数据，您可能最好查看当前参与项目的开发人员的工作量，并根据需要缓慢地将人员移入或移出项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T18:30:26.110

它更多地取决于需要修复的错误的数量和难度，而不是项目的大小。作为开始：

*   每周有多少错误需要修复？
*   这些错误有多复杂？
*   代码库的质量如何？对修复错误的感知“难度”产生巨大影响。
*   程序员在语言/框架方面有多少经验？
*   程序员对这个特定应用程序有多少经验？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T18:28:09.783

我认为这将取决于很多变量：您雇用的开发人员的质量、他们对代码的熟悉程度、代码的质量以及初学者使用的语言。我认为不会有一个可行的方程式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T18:29:55.783

我不认为有一个很好的方法来选择这个。这将取决于几个因素：

*   代码库的条件
*   从事它的工程师的经验/人才水平
*   预期错误修复/功能的时间表

您可能只想从一个小团队开始，看看工作进展如何，然后在需要时添加更多成员。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T18:48:56.317

如果您在项目的整个生命周期中使用了问题跟踪系统，您可以运行一份报告，显示每月平均问题数量和平均修复时间，这将为您提供历史维护需求。

然后，您可以将其推断到未来。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-15T22:19:43.307

有一个命令行工具，`sloccount`实现了[COCOMO 模型](https://en.wikipedia.org/wiki/COCOMO)。它可以在[作者的网站](https://www.dwheeler.com/sloccount/)和基于 Debian 的系统上通过`apt-get`.

# android - 如何以编程方式控制 Android AbsoluteLayout 中子视图的大小

> ID：562267
> 
> 赞同：2
> 
> 时间：2009-02-18T18:24:25.953
> 
> 标签：android, layout

[http://code.google.com/android/reference/android/widget/AbsoluteLayout.html](http://code.google.com/android/reference/android/widget/AbsoluteLayout.html)上的文档说：

```
onLayout(boolean changed, int l, int t, int r, int b)
//Called from layout when this view should assign a size and position to each of its children. 
```

所以我像这样覆盖它：

```
@Override
protected void onLayout(boolean changed, int l, int t, int r, int b) {
    Log.d("test", "In MainLayout.onLayout");
    int childCount = getChildCount();
    for (int childIndex = 0; childIndex < childCount; childIndex++) {
        getChildAt(childIndex).setLayoutParams(new LayoutParams(100, 100, 100, 100));
    }
    super.onLayout(changed, l, t, r, b);
} 
```

我在 XML 中为布局声明子元素（按钮）。

这正确设置了按钮的位置，但没有设置大小。大小取自 XML 中定义的内容（这是必需的属性）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-02-22T08:01:18.890

在你的链接上它还说

> 此类已弃用。

不要花时间做一些将要被放弃的工作。这个类已被弃用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-28T07:46:52.693

因为它是AbsoluteLayout。并且 AbsoluteLayout 以前已弃用。

# php - PHP：检查 SimpleXmlElement 是否有错误

> ID：562269
> 
> 赞同：0
> 
> 时间：2009-02-18T18:24:46.983
> 
> 标签：php, xml, dom, simplexml

任何人都知道如何检查 php SimpleXmlElement 对象是否有错误？我的意思是是否是一个有效的 XML 文件？我已经阅读了很多手册..但我不明白！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T18:41:56.100

根据[http://www.ibm.com/developerworks/library/x-simplexml.html](http://www.ibm.com/developerworks/library/x-simplexml.html)（参见`Error handling`章节）SimpleXML 不会验证您的文件，它只会检查它是否格式正确，如果不是则返回 false案子。

另一种方法是使用[PHP DOM Class](http://de.php.net/manual/en/book.dom.php)，调用[`DOMDocument::loadXML()`](http://de.php.net/manual/en/domdocument.loadxml.php)并编写自己的错误处理程序并查看警告，或者让它正常打印警告。由于 SimpleXML 只是一个 DOM Wrapper，您可以简单地将其转换为 DOMDocument，反之亦然。

您还可以关闭*validateOnParse*属性，然后使用[`DOMDocument::validate`](http://de.php.net/manual/en/domdocument.validate.php).

# asp.net - ASP.NET 访问数据库错误？

> ID：562272
> 
> 赞同：1
> 
> 时间：2009-02-18T18:26:08.523
> 
> 标签：asp.net, database, ms-access

我已经编写了一些使用 Access DB 的代码，在我的本地主机上，以下内容 - 选择、插入和删除查询工作得很好，并按照我对它们进行的编程。当我将应用程序移动到登台服务器时，应用程序在插入和删除时会抛出错误，但是 select 语句工作得很好。据我所知，我已确保所有权限都是读/写的，有人知道我缺少什么。请参阅下面的错误。

~~~~~

```
Description: An unhandled exception occurred during the execution of the 
current web request. Please review the stack trace for more information about
the error and where it originated in the code. 

Exception Details: System.Data.OleDb.OleDbException: Could not delete from
specified tables. 

Source Error: 
Line 714: OleDbDataReader objReader; 
Line 715: objConn.Open(); 
Line 716: objReader = objCmd.ExecuteReader(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T18:31:18.120

嗯……这很奇怪。您是否对登台服务器的文件夹具有修改（更改）文件系统权限？点击 .mdb 将创建该临时访问文件，因此如果您可以选择，您应该在该文件夹上写入。检查您是否有修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T18:31:54.453

你的 MDB 文件是只读的吗？我说的是 MDB 文件的文件系统属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T03:09:21.463

似乎使用 .mdb 文件的任何帐户都没有对该文件/文件夹的必要权限。

我发现为网站使用 .mdb 文件存在太多问题。您至少要切换到 SQL Express。您的网站将不胜感激。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-05T13:54:04.067

ASP.NET 在特殊的 ASPNET 或网络服务帐户下运行。主要是 IIS_USERS（位于机器中）

右键单击包含要由 ASP 用户修改的文件的文件夹

文件夹-> 属性-> 安全-> 编辑-> 添加 IIS_IUSRS（本地计算机），具有最高修改权限。

# java - Java Sound API 在您的计算机上找到哪些输出和录音端口？

> ID：562273
> 
> 赞同：8
> 
> 时间：2009-02-18T18:26:17.790
> 
> 标签：java, audio, javasound

我正在使用[Java Sound API](http://java.sun.com/products/java-media/sound/)，事实证明，如果我想调整录音音量，我需要对操作系统暴露给 Java 的硬件进行建模。事实证明，呈现的内容多种多样。

因此，我谦虚地要求任何能够帮助我在他们的计算机上运行以下内容并发回结果的人，以便我可以了解那里有什么。

提前感谢任何可以提供帮助的人:-)

```
import javax.sound.sampled.*;
public class SoundAudit {
  public static void main(String[] args) { try {
    System.out.println("OS: "+System.getProperty("os.name")+" "+
      System.getProperty("os.version")+"/"+
      System.getProperty("os.arch")+"\nJava: "+
      System.getProperty("java.version")+" ("+
      System.getProperty("java.vendor")+")\n");
      for (Mixer.Info thisMixerInfo : AudioSystem.getMixerInfo()) {
        System.out.println("Mixer: "+thisMixerInfo.getDescription()+
          " ["+thisMixerInfo.getName()+"]");
        Mixer thisMixer = AudioSystem.getMixer(thisMixerInfo);
        for (Line.Info thisLineInfo:thisMixer.getSourceLineInfo()) {
            if (thisLineInfo.getLineClass().getName().equals(
              "javax.sound.sampled.Port")) {
              Line thisLine = thisMixer.getLine(thisLineInfo);
              thisLine.open();
              System.out.println("  Source Port: "
                +thisLineInfo.toString());
              for (Control thisControl : thisLine.getControls()) {
                System.out.println(AnalyzeControl(thisControl));}
              thisLine.close();}}
        for (Line.Info thisLineInfo:thisMixer.getTargetLineInfo()) {
          if (thisLineInfo.getLineClass().getName().equals(
            "javax.sound.sampled.Port")) {
            Line thisLine = thisMixer.getLine(thisLineInfo);
            thisLine.open();
            System.out.println("  Target Port: "
              +thisLineInfo.toString());
            for (Control thisControl : thisLine.getControls()) {
              System.out.println(AnalyzeControl(thisControl));}
            thisLine.close();}}}
  } catch (Exception e) {e.printStackTrace();}}
  public static String AnalyzeControl(Control thisControl) {
    String type = thisControl.getType().toString();
    if (thisControl instanceof BooleanControl) {
      return "    Control: "+type+" (boolean)"; }
    if (thisControl instanceof CompoundControl) {
      System.out.println("    Control: "+type+
        " (compound - values below)");
      String toReturn = "";
      for (Control children:
        ((CompoundControl)thisControl).getMemberControls()) {
        toReturn+="  "+AnalyzeControl(children)+"\n";}
      return toReturn.substring(0, toReturn.length()-1);}
    if (thisControl instanceof EnumControl) {
      return "    Control:"+type+" (enum: "+thisControl.toString()+")";}
    if (thisControl instanceof FloatControl) {
      return "    Control: "+type+" (float: from "+
        ((FloatControl) thisControl).getMinimum()+" to "+
        ((FloatControl) thisControl).getMaximum()+")";}
    return "    Control: unknown type";}
} 
```

应用程序所做的只是打印出一行关于操作系统、一行关于 JVM 以及几行关于发现的可能与记录硬件有关的硬件的行。例如，在我工作的 PC 上，我得到以下信息：

操作系统：Windows XP 5.1/x86 Java：1.6.0_07（Sun Microsystems Inc.）

```
混音器：直接音频设备：DirectSound Playback [Primary Sound Driver]
混音器：直接音频设备：DirectSound Playback [SoundMAX HD Audio]
混音器：直接音频设备：DirectSound Capture [Primary Sound Capture Driver]
混音器：直接音频设备：DirectSound Capture [SoundMAX HD Audio]
混音器：软件混音器和合成器 [Java Sound Audio Engine]
混音器：Port Mixer [Port SoundMAX HD Audio]
  源端口：MICROPHONE 源端口
    控制：麦克风（复合 - 下面的值）
      控制：选择（布尔）
      控制：麦克风增强（布尔值）
      控制：前面板麦克风（布尔值）
      控制：音量（浮点数：从 0.0 到 1.0）
  源端口：LINE_IN 源端口
    控制：线路输入（复合 - 下面的值）
      控制：选择（布尔）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）

```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T22:58:46.143

```
OS: Mac OS X 10.5.6/i386
Java: 1.5.0_16 (Apple Inc.)

Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
Mixer: No details available [Built-in Microphone]
Mixer: No details available [Built-in Input] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-18T19:06:09.830

```
OS: Windows XP 5.1/x86
Java: 1.6.0_12 (Sun Microsystems Inc.)

Mixer: Direct Audio Device: DirectSound Playback [Primary Sound Driver]
Mixer: Direct Audio Device: DirectSound Playback [SoundMAX Digital Audio]
Mixer: Direct Audio Device: DirectSound Capture [Primary Sound Capture Driver]
Mixer: Direct Audio Device: DirectSound Capture [SoundMAX Digital Audio]
Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
Mixer: Port Mixer [Port SoundMAX Digital Audio]
  Source Port: COMPACT_DISC source port
    Control: CD Player (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: MICROPHONE source port
    Control: Microphone (compound - values below)
      Control: Select (boolean)
      Control: MIC Boost (boolean)
      Control: Mic2 Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
  Source Port: Aux source port
    Control: Aux (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: LINE_IN source port
    Control: Line In (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: Phone source port
    Control: Phone (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
  Source Port: Mono Out source port
    Control: Mono Out (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
  Source Port: Wave Out Mix source port
    Control: Wave Out Mix (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Target Port: SPEAKER target port
    Control: Volume (float: from 0.0 to 1.0)
    Control: Balance (float: from -1.0 to 1.0)
    Control: AC3 SPDIF (boolean)
    Control: PCM SPDIF (boolean)
    Control: Mute (boolean)
    Control: Wave (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: SW Synth (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: BassBoost (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
    Control: CD Player (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: Microphone (compound - values below)
      Control: Mic2 Select (boolean)
      Control: MIC Boost (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
    Control: Aux (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: Line In (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: Phone (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
    Control: Mono Out (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean) 
```

* * *

注意：复制自[http://fnord.pastebin.ca/1341281](http://fnord.pastebin.ca/1341281)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-18T19:16:18.387

正如 Uri 所指出的，Java Sound API 在 Mac OS X 上肯定不会产生任何有趣的结果：

```
OS: Darwin 9.6.0/i386
Java: 1.6.0_03-p3 (Sun Microsystems Inc.)

Mixer: software mixer and synthesizer [Java Sound Audio Engine] 
```

另外，我应该注意，我使用的是 soylatte-1.0.3，而不是随 Apple 开发人员工具一起分发的相当老的 JDK。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-18T19:17:40.007

```
asus p5gc-mx/1333

Name    Realtek High Definition Audio
Manufacturer    Realtek
Status  OK
PNP Device ID   HDAUDIO\FUNC_01&VEN_10EC&DEV_0662&SUBSYS_10438290&REV_1001\4&18A64267&0&0001
Driver  c:\windows\system32\drivers\rtkhdaud.sys (5.10.0.5506 built by: WinDDK, 4.41 MB (4,620,288 bytes), 12/23/2008 5:14 PM)

OS: Windows XP 5.1/x86
Java: 1.6.0_11 (Sun Microsystems Inc.)

Mixer: Direct Audio Device: DirectSound Playback [Primary Sound Driver]
Mixer: Direct Audio Device: DirectSound Playback [Realtek HD Audio output]
Mixer: Direct Audio Device: DirectSound Capture [Primary Sound Capture Driver]
Mixer: Direct Audio Device: DirectSound Capture [Realtek HD Audio Input]
Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
Mixer: Port Mixer [Port Realtek HD Audio output]
  Target Port: SPEAKER target port
    Control: Volume (float: from 0.0 to 1.0)
    Control: Balance (float: from -1.0 to 1.0)
    Control: Mute (boolean)
    Control: Wave (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: SW Synth (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: Front (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
    Control: Rear (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
    Control: Subwoofer (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
    Control: Center (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
    Control: SPDIF (compound - values below)
      Control: Mute (boolean)
    Control: Line Volume (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: Mic Volume (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Microphone Boost (boolean)
      Control: Mute (boolean)
    Control: CD Volume (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
Mixer: Port Mixer [Port Realtek HD Audio Input]
  Source Port: COMPACT_DISC source port
    Control: CD Volume (compound - values below)
      Control: Mute (boolean)
  Source Port: LINE_IN source port
    Control: Line Volume (compound - values below)
      Control: Mute (boolean)
  Source Port: MICROPHONE source port
    Control: Mic Volume (compound - values below)
      Control: Mute (boolean)
  Source Port: Stereo Mix source port
    Control: Stereo Mix (compound - values below)
      Control: Mute (boolean)
  Target Port: Recording Control target port
    Control: Volume (float: from 0.0 to 1.0)
    Control: Balance (float: from -1.0 to 1.0)
    Control: Mute (boolean)
    Control: CD Volume (compound - values below)
      Control: Mute (boolean)
    Control: Line Volume (compound - values below)
      Control: Mute (boolean)
    Control: Mic Volume (compound - values below)
      Control: Mute (boolean)
    Control: Stereo Mix (compound - values below)
      Control: Mute (boolean) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-18T19:02:21.993

我从来没有弄乱过声音 API——这是一件好事。谢谢。

从[戴尔](http://en.wikipedia.org/wiki/Dell)笔记本电脑：

```
Mixer: Direct Audio Device: DirectSound Playback [Primary Sound Driver]
Mixer: Direct Audio Device: DirectSound Playback [SigmaTel Audio]
Mixer: Direct Audio Device: DirectSound Capture [Primary Sound Capture Driver]
Mixer: Direct Audio Device: DirectSound Capture [SigmaTel Audio]
Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
Mixer: Port Mixer [Port SigmaTel Audio]
  Source Port: Stereo Mix source port
    Control: Stereo Mix (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: LINE_IN source port
    Control: Line In (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: MICROPHONE source port
    Control: Microphone (compound - values below)
      Control: Select (boolean)
      Control: Microphone Boost (boolean)
      Control: Volume (float: from 0.0 to 1.0)
  Source Port: MICROPHONE source port
    Control: Microphone (compound - values below)
      Control: Select (boolean)
      Control: Microphone Boost (boolean)
      Control: Volume (float: from 0.0 to 1.0)
  Target Port: SPEAKER target port
    Control: Volume (float: from 0.0 to 1.0)
    Control: Balance (float: from -1.0 to 1.0)
    Control: Mute (boolean)
    Control: PC Spk Mute (boolean)
    Control: SPDIF Interface (boolean)
    Control: Wave (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: SW Synth (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: CD Player (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: PC Speaker (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean) 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-18T23:25:01.783

```
OS: Linux 2.6.24-23-generic/amd64
Java: 1.6.0_05 (Sun Microsystems Inc.)

Mixer: Direct Audio Device: NVidia CK804, Intel ICH, NVidia CK804 [CK804 [plughw:0,0]]
Mixer: Direct Audio Device: NVidia CK804, Intel ICH - MIC ADC, NVidia CK804 - MIC ADC [CK804 [plughw:0,1]]
Mixer: Direct Audio Device: NVidia CK804, Intel ICH - IEC958, NVidia CK804 - IEC958 [CK804 [plughw:0,2]]
Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
Mixer: NVidia CK804, Realtek ALC850 rev 0 [Port CK804 [hw:0]]
  Source Port: IEC958 Playback AC97-SPSA source port
    Control: IEC958 Playback AC97-SPSA (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
  Source Port: Capture source port
    Control: Capture (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Select (boolean)
  Target Port: Master target port
    Control: Master (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Master Mono target port
    Control: Master Mono (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
  Target Port: PCM target port
    Control: PCM (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Surround target port
    Control: Surround (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Center target port
    Control: Center (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
  Target Port: LFE target port
    Control: LFE (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Line target port
    Control: Line (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: CD target port
    Control: CD (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Mic target port
    Control: Mic (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Phone target port
    Control: Phone (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
  Target Port: IEC958 Playback AC97-SPSA target port
    Control: IEC958 Playback AC97-SPSA (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
  Target Port: PC Speaker target port
    Control: PC Speaker (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Aux target port
    Control: Aux (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-18T23:30:13.050

```
OS: Windows XP 5.1/x86  
Java: 1.6.0_06 (Sun Microsystems Inc.)  

Mixer: Direct Audio Device: DirectSound Playback [Primary Sound Driver]  
Mixer: Direct Audio Device: DirectSound Playback [SoundMAX HD Audio]  
Mixer: Direct Audio Device: DirectSound Capture [Primary Sound Capture Driver]  
Mixer: Direct Audio Device: DirectSound Capture [SoundMAX HD Audio]  
Mixer: Software mixer and synthesizer [Java Sound Audio Engine]  
Mixer: Port Mixer [Port SoundMAX HD Audio]  
  Source Port: Stereo Mix source port  
    Control: Stereo Mix (compound - values below)  
      Control: Select (boolean)  
      Control: Volume (float: from 0.0 to 1.0)  
      Control: Balance (float: from -1.0 to 1.0)  
  Source Port: MICROPHONE source port  
    Control: Microphone (compound - values below)  
      Control: Select (boolean)  
      Control: Microphone Boost (boolean)  
      Control: Volume (float: from 0.0 to 1.0)  
      Control: Balance (float: from -1.0 to 1.0)  
  Source Port: COMPACT_DISC source port  
    Control: CD Player (compound - values below)  
      Control: Select (boolean)  
      Control: Volume (float: from 0.0 to 1.0)  
      Control: Balance (float: from -1.0 to 1.0)  
  Target Port: SPEAKER target port  
    Control: Volume (float: from 0.0 to 1.0)  
    Control: Balance (float: from -1.0 to 1.0)  
    Control: Mute (boolean)  
    Control: Disable Digital Output (boolean)  
    Control: Wave (compound - values below)  
      Control: Volume (float: from 0.0 to 1.0)  
      Control: Balance (float: from -1.0 to 1.0)  
      Control: Mute (boolean)  
    Control: SW Synth (compound - values below)  
      Control: Volume (float: from 0.0 to 1.0)  
      Control: Balance (float: from -1.0 to 1.0)  
      Control: Mute (boolean)  
    Control: Microphone (compound - values below)  
      Control: Microphone Boost (boolean)  
      Control: Volume (float: from 0.0 to 1.0)  
      Control: Balance (float: from -1.0 to 1.0)  
      Control: Mute (boolean)  
    Control: CD Player (compound - values below)  
      Control: Volume (float: from 0.0 to 1.0)  
      Control: Balance (float: from -1.0 to 1.0)  
      Control: Mute (boolean) 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-19T02:37:23.927

```
操作系统：Windows XP 5.1/x86
Java：1.6.0_12（Sun Microsystems Inc.）

混音器：直接音频设备：DirectSound Playback [Primary Sound Driver]
混音器：直接音频设备：DirectSound Playback [VIA AC'97 Audio (WAVE)]
混音器：直接音频设备：DirectSound Capture [Primary Sound Capture Driver]
混音器：直接音频设备：DirectSound Capture [VIA AC'97 Audio (WAVE)]
混音器：软件混音器和合成器 [Java Sound Audio Engine]
混音器：端口混音器 [Port VIA AC'97 Audio (WAVE)]
  端口：立体声混音器源端口
    控制：立体声混音器（复合 - 下面的值）
      控制：选择（布尔）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
  端口：MICROPHONE 源端口
    控制：麦克风（复合 - 值如下）
      控制：选择（布尔）
      控制：Mic2 Select（布尔值）
      控制：20dB 提升（布尔值）
      控制：音量（浮点数：从 0.0 到 1.0）
  端口：LINE\_IN 源端口
    控制：线路输入（复合 - 下面的值）
      控制：选择（布尔）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
  端口：COMPACT\_DISC 源端口
    控制：CD 播放器（复合 - 值如下）
      控制：选择（布尔）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
  端口：视频源端口
    控制：视频（复合 - 下面的值）
      控制：选择（布尔）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
  端口：辅助源端口
    控制：辅助（复合 - 下面的值）
      控制：选择（布尔）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-19T02:43:51.807

```
OS: Windows XP 5.1/x86
Java: 1.6.0_03 (Sun Microsystems Inc.)

Mixer: Direct Audio Device: DirectSound Playback [Primary Sound Driver]
Mixer: Direct Audio Device: DirectSound Playback [SoundMAX HD Audio]
Mixer: Direct Audio Device: DirectSound Capture [Primary Sound Capture Driver]
Mixer: Direct Audio Device: DirectSound Capture [SoundMAX HD Audio]
Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
Mixer: Port Mixer [Port SoundMAX HD Audio]
  Source Port: MICROPHONE source port
    Control: Microphone (compound - values below)
      Control: Select (boolean)
      Control: Microphone Boost (boolean)
      Control: Front panel microphone (boolean)
      Control: Volume (float: from 0.0 to 1.0)
  Source Port: LINE_IN source port
    Control: Line In (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Target Port: SPEAKER target port
    Control: Volume (float: from 0.0 to 1.0)
    Control: Balance (float: from -1.0 to 1.0)
    Control: Mute (boolean)
    Control: Wave (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: SW Synth (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: CD Player (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: Input Monitor (compound - values below)
      Control: Mute (boolean) 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-08-26T19:43:54.677

```
OS: Linux 2.6.28-15-generic/amd64
Java: 1.6.0_14 (Sun Microsystems Inc.)

Mixer: Direct Audio Device: HDA Intel, AD198x Analog, AD198x Analog [Intel [plughw:0,0]]
Mixer: Direct Audio Device: HDA Intel, AD198x Digital, AD198x Digital [Intel [plughw:0,1]]
Mixer: Direct Audio Device: USB Device 0x46d:0x8d7, USB Audio, USB Audio [U0x46d0x8d7 [plughw:1,0]]
Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
Mixer: HDA Intel, Analog Devices AD1988 [Port Intel [hw:0]]
  Source Port: Front Mic Boost source port
    Control: Front Mic Boost (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: Mic Boost source port
    Control: Mic Boost (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: IEC958 source port
    Control: IEC958 (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Select (boolean)
  Source Port: Capture source port
    Control: Capture (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Select (boolean)
  Source Port: Capture source port
    Control: Capture (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Select (boolean)
  Source Port: Capture source port
    Control: Capture (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Select (boolean)
  Source Port: Digital source port
    Control: Digital (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Target Port: Master target port
    Control: Master (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
  Target Port: PCM target port
    Control: PCM (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Target Port: Front target port
    Control: Front (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Front Mic target port
    Control: Front Mic (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Front Mic Boost target port
    Control: Front Mic Boost (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Target Port: Surround target port
    Control: Surround (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Center target port
    Control: Center (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
  Target Port: LFE target port
    Control: LFE (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Side target port
    Control: Side (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Line target port
    Control: Line (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: CD target port
    Control: CD (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Mic target port
    Control: Mic (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Mic Boost target port
    Control: Mic Boost (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Target Port: IEC958 target port
    Control: IEC958 (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Analog Mix target port
    Control: Analog Mix (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Beep target port
    Control: Beep (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
Mixer: USB Device 0x46d:0x8d7, USB Mixer [Port U0x46d0x8d7 [hw:1]]
  Source Port: Mic source port
    Control: Mic (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Select (boolean) 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-12-11T20:49:48.597

带有 Windows 7 的戴尔 9150：

```
OS: Windows 7 6.1/x86
Java: 1.6.0_16 (Sun Microsystems Inc.)

Mixer: Direct Audio Device: DirectSound Playback [Primary Sound Driver]
Mixer: Direct Audio Device: DirectSound Playback [Speakers (High Definition Audio Device)]
Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
Mixer: Port Mixer [Port Speakers (High Definition Audio]
  Target Port: SPEAKER target port
    Control: Mute (boolean)
    Control: Volume (float: from 0.0 to 1.0)
    Control: CD Audio (compound - values below)
      Control: Mute (boolean)
      Control: Volume (float: from 0.0 to 1.0)
    Control: Master Volume (compound - values below)
      Control: Mute (boolean)
      Control: Volume (float: from 0.0 to 1.0) 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2010-11-16T18:56:57.690

这个来自在 Virtual Box 上运行 Windows (pt-BR) 的 MacBook Pro MB990BZ：

```
OS: Windows XP 5.1/x86
Java: 1.6.0_22 (Sun Microsystems Inc.)

Mixer: Direct Audio Device: DirectSound Playback [Driver de som primário]
Mixer: Direct Audio Device: DirectSound Playback [Intel(r) Integrated Audio]
Mixer: Direct Audio Device: DirectSound Capture [Driver de captura de som primár
io]
Mixer: Direct Audio Device: DirectSound Capture [Intel(r) Integrated Audio]
Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
Mixer: Port Mixer [Port Intel(r) Integrated Audio]
  Source Port: Mixagem estéreo source port
    Control: Mixagem estéreo (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: Mixagem mono source port
    Control: Mixagem mono (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
  Source Port: Auxiliar source port
    Control: Auxiliar (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: Vídeo source port
    Control: Vídeo (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: COMPACT_DISC source port
    Control: Áudio CD (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: LINE_IN source port
    Control: Entrada (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: MICROPHONE source port
    Control: Microfone (compound - values below)
      Control: Select (boolean)
      Control: Aumento de sensibilidade do microfone (boolean)
      Control: Microfone alternativo (boolean)
      Control: Volume (float: from 0.0 to 1.0)
  Source Port: Linha de telefone source port
    Control: Linha de telefone (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
  Target Port: SPEAKER target port
    Control: Volume (float: from 0.0 to 1.0)
    Control: Balance (float: from -1.0 to 1.0)
    Control: Mute (boolean)
    Control: Som wave (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: Sint. de SW (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: Auxiliar (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: Vídeo (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: Áudio CD (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: Entrada (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: Microfone (compound - values below)
      Control: Microfone alternativo (boolean)
      Control: Aumento de sensibilidade do microfone (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
    Control: Linha de telefone (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
    Control: Alto-falante (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
  Target Port: Saída mono target port
    Control: Mixagem mono (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
    Control: Microfone (compound - values below)
      Control: Aumento de sensibilidade do microfone (boolean)
      Control: Microfone alternativo (boolean)
      Control: Volume (float: from 0.0 to 1.0) 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-18T19:05:24.793

请注意，Java Sound API 在 Mac OS X 上没有正确实现。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-10-07T14:57:06.677

GrowlSafari 似乎有问题 - 不知道为什么这会被注册为输入服务器......

```
OS: Mac OS X 10.6.1/x86_64
Java: 1.6.0_15 (Apple Inc.)

2009-10-07 15:53:56.203 java[5008:1707] Can't open input server /Library/InputManagers/GrowlSafari
Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
Mixer: No details available [Built-in Microphone]
Mixer: No details available [Built-in Input] 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-12-10T15:45:15.303

将 HP 笔记本电脑放入带有独立音频输出坞站的坞站中：

```
OS: Windows XP 5.1 build 2600 Service Pack 2/x86
Java: 1.5.0 (IBM Corporation)

Mixer: Direct Audio Device: DirectSound Playback [Primary Sound Driver]
Mixer: Direct Audio Device: DirectSound Playback [SoundMAX HD Audio]
Mixer: Direct Audio Device: DirectSound Playback [ATI HD Audio rear output]
Mixer: Direct Audio Device: DirectSound Capture [Primary Sound Capture Driver]
Mixer: Direct Audio Device: DirectSound Capture [SoundMAX HD Audio]
Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
Mixer: Port Mixer [Port SoundMAX HD Audio]
  Source Port: Stereo Mix source port
    Control: Stereo Mix (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: MICROPHONE source port
    Control: Microphone (compound - values below)
      Control: Select (boolean)
      Control: Microphone Boost (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Source Port: LINE_IN source port
    Control: Line In (compound - values below)
      Control: Select (boolean)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
  Target Port: SPEAKER target port
    Control: Volume (float: from 0.0 to 1.0)
    Control: Balance (float: from -1.0 to 1.0)
    Control: Mute (boolean)
    Control: Disable digital output (boolean)
    Control: Wave (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: SW Synth (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: CD Player (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: PC Beep (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Mute (boolean)
    Control: Line In (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
Mixer: Port Mixer [Port ATI HD Audio rear output]
  Target Port: SPEAKER target port
    Control: Volume (float: from 0.0 to 1.0)
    Control: Balance (float: from -1.0 to 1.0)
    Control: Mute (boolean)
    Control: Wave (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: SW Synth (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean)
    Control: CD Player (compound - values below)
      Control: Volume (float: from 0.0 to 1.0)
      Control: Balance (float: from -1.0 to 1.0)
      Control: Mute (boolean) 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2010-04-09T00:19:57.750

我为你插入了一些额外的 USB 声卡：

```
 OS: Windows XP 5.1/x86
    Java: 1.6.0_13 (Sun Microsystems Inc.)

    Mixer: Direct Audio Device: DirectSound Playback [Primary Sound Driver]
    Mixer: Direct Audio Device: DirectSound Playback [C-Media USB Audio Device   ]
    Mixer: Direct Audio Device: DirectSound Playback [SigmaTel Audio]
    Mixer: Direct Audio Device: DirectSound Playback [Virtual Cable 1]
    Mixer: Direct Audio Device: DirectSound Playback [SpeechMikeII]
    Mixer: Direct Audio Device: DirectSound Playback [PowerMicII-NS]
    Mixer: Direct Audio Device: DirectSound Capture [Primary Sound Capture Driver]
    Mixer: Direct Audio Device: DirectSound Capture [C-Media USB Audio Device   ]
    Mixer: Direct Audio Device: DirectSound Capture [SigmaTel Audio]
    Mixer: Direct Audio Device: DirectSound Capture [Virtual Cable 1]
    Mixer: Direct Audio Device: DirectSound Capture [SpeechMikeII]
    Mixer: Direct Audio Device: DirectSound Capture [Buddy DesktopMic PTT]
    Mixer: Direct Audio Device: DirectSound Capture [PowerMicII-NS]
    Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
    Mixer: Port Mixer [Port C-Media USB Audio Device   ]
      Source Port: MICROPHONE source port
      Target Port: SPEAKER target port
        Control: Mute (boolean)
        Control: Volume (float: from 0.0 to 1.0)
        Control: Balance (float: from -1.0 to 1.0)
        Control: Wave (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
        Control: SW Synth (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
        Control: CD Player (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
      Target Port: Wave In target port
        Control: Mute (boolean)
        Control: Volume (float: from 0.0 to 1.0)
        Control: AGC (boolean)
    Mixer: Port Mixer [Port SigmaTel Audio]
      Source Port: Stereo Mix source port
        Control: Stereo Mix (compound - values below)
          Control: Select (boolean)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
      Source Port: LINE_IN source port
        Control: Line In (compound - values below)
          Control: Select (boolean)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
      Source Port: MICROPHONE source port
        Control: External Mic (compound - values below)
          Control: Select (boolean)
          Control: Microphone Boost (boolean)
          Control: Volume (float: from 0.0 to 1.0)
      Source Port: MICROPHONE source port
        Control: External Mic (compound - values below)
          Control: Select (boolean)
          Control: Microphone Boost (boolean)
          Control: Volume (float: from 0.0 to 1.0)
      Target Port: SPEAKER target port
        Control: Volume (float: from 0.0 to 1.0)
        Control: Balance (float: from -1.0 to 1.0)
        Control: Mute (boolean)
        Control: PC Spk Mute (boolean)
        Control: SPDIF Interface (boolean)
        Control: Wave (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
        Control: SW Synth (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
        Control: CD Player (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
    Mixer: Port Mixer [Port Virtual Cable 1]
      Source Port: SPDIF Interface source port
        Control: SPDIF Interface (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
      Source Port: LINE_IN source port
        Control: Line (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
      Source Port: MICROPHONE source port
        Control: Microphone (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
      Target Port: SPEAKER target port
        Control: Volume (float: from 0.0 to 1.0)
        Control: Balance (float: from -1.0 to 1.0)
        Control: Mute (boolean)
        Control: Wave (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
        Control: SW Synth (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
        Control: CD Player (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
    Mixer: Port Mixer [Port SpeechMikeII]
      Source Port: MICROPHONE source port
      Target Port: SPEAKER target port
        Control: Mute (boolean)
        Control: Volume (float: from 0.0 to 1.0)
        Control: Wave (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
        Control: SW Synth (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
        Control: CD Player (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
      Target Port: Wave In target port
        Control: Mute (boolean)
        Control: Volume (float: from 0.0 to 1.0)
    Mixer: Port Mixer [Port Buddy DesktopMic PTT]
      Source Port: MICROPHONE source port
        Control: Microphone (compound - values below)
          Control: Mute (boolean)
          Control: Volume (float: from 0.0 to 1.0)
    Mixer: Port Mixer [Port PowerMicII-NS]
      Source Port: MICROPHONE source port
        Control: Microphone (compound - values below)
          Control: Mute (boolean)
          Control: Volume (float: from 0.0 to 1.0)
      Target Port: SPEAKER target port
        Control: Mute (boolean)
        Control: Volume (float: from 0.0 to 1.0)
        Control: Balance (float: from -1.0 to 1.0)
        Control: Wave (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
        Control: SW Synth (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean)
        Control: CD Player (compound - values below)
          Control: Volume (float: from 0.0 to 1.0)
          Control: Balance (float: from -1.0 to 1.0)
          Control: Mute (boolean) 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2011-11-02T01:43:53.980

```
OS: Mac OS X 10.6.7/x86_64
Java: 1.6.0_26 (Apple Inc.)

Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
Mixer: No details available [Microphone (Pink Front)] 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2010-12-01T23:21:17.593

```
操作系统：Linux 2.6.32-26-generic/i386
Java：1.6.0_22（Sun Microsystems Inc.）

混音器：直接音频设备：HDA Intel、ALC262 Analog、ALC262 Analog [Intel [plughw:0,0]]
混音器：软件混音器和合成器 [Java Sound Audio Engine]
混音器：HDA Intel、Realtek ALC262 [Port Intel [hw:0]]
  源端口：捕获源端口
    控制：捕获（复合 - 下面的值）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
      控制：选择（布尔）
  源端口：捕获源端口
    控制：捕获（复合 - 下面的值）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
      控制：选择（布尔）
  源端口：捕获源端口
    控制：捕获（复合 - 下面的值）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
      控制：选择（布尔）
  源端口：数字源端口
    控制：数字（复合 - 值如下）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
  目标端口：主目标端口
    控制：主（复合 - 下面的值）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
      控制：静音（布尔值）
  目标端口：PCM目标端口
    控制：PCM（复合 - 值如下）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
  目标端口：麦克风目标端口
    控制：麦克风（复合 - 值如下）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
      控制：静音（布尔值）
  目标端口：哔目标端口
    控制：哔哔声（复合 - 下面的值）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
      控制：静音（布尔值）
  目标端口：ATAPI 麦克风目标端口
    控制：ATAPI 麦克风（复合 - 值如下）
      控制：音量（浮点数：从 0.0 到 1.0）
      控制：平衡（浮动：从 -1.0 到 1.0）
      控制：静音（布尔值）

```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2010-12-07T12:12:11.067

```
OS: Windows 7 6.1/amd64
Java: 1.6.0_21 (Sun Microsystems Inc.)

Mixer: Software mixer and synthesizer [Java Sound Audio Engine]
Mixer: No details available [Microsoft Sound Mapper]
Mixer: No details available [Microphone (Logitech Mic (Orbit]
Mixer: Port Mixer [Port Speakers (High Definition Audio]
  Target Port: SPEAKER target port
    Control: Mute (boolean)
    Control: Volume (float: from 0.0 to 1.0)
    Control: CD Audio (compound - values below)
      Control: Mute (boolean)
      Control: Volume (float: from 0.0 to 1.0)
    Control: Master Volume (compound - values below)
      Control: Mute (boolean)
      Control: Volume (float: from 0.0 to 1.0)
Mixer: Port Mixer [Port Digital Audio (S/PDIF) (High De]
  Target Port: Master Volume target port
    Control: Mute (boolean)
    Control: Volume (float: from 0.0 to 1.0)
    Control: CD Audio (compound - values below)
      Control: Mute (boolean)
      Control: Volume (float: from 0.0 to 1.0)
    Control: Master Volume (compound - values below)
      Control: Mute (boolean)
      Control: Volume (float: from 0.0 to 1.0)
Mixer: Port Mixer [Port Digital Audio (S/PDIF) (High De]
  Target Port: Master Volume target port
    Control: Mute (boolean)
    Control: Volume (float: from 0.0 to 1.0)
    Control: CD Audio (compound - values below)
      Control: Mute (boolean)
      Control: Volume (float: from 0.0 to 1.0)
    Control: Master Volume (compound - values below)
      Control: Mute (boolean)
      Control: Volume (float: from 0.0 to 1.0)
Mixer: Port Mixer [Port Microphone (Logitech Mic (Orbit]
  Source Port: MICROPHONE source port
    Control: Master Volume (compound - values below)
      Control: Mute (boolean)
      Control: Volume (float: from 0.0 to 1.0)
  Target Port: Master Volume target port
    Control: Mute (boolean)
    Control: Volume (float: from 0.0 to 1.0)
    Control: Master Volume (compound - values below)
      Control: Mute (boolean)
      Control: Volume (float: from 0.0 to 1.0) 
```

# asp.net-mvc - 在没有 www 的情况下访问 ASP.Net MVC 站点会引发错误

> ID：562274
> 
> 赞同：1
> 
> 时间：2009-02-18T18:26:49.363
> 
> 标签：asp.net-mvc, error-handling, routing

这让我做了一些噩梦，因为我正在现场直播的盒子上试图找出问题所在！

[如果有人使用完整的 URL http://www](http://www) ..net访问我们的 ASP.Net MVC 网站，一切正常。如果他们访问：http://.net，则会显示我们的自定义错误页面。在我们将站点移至 MVC 之前，这曾经可以正常工作。

我们在 Global.asax 中确实有一个 Application_OnError 事件，但我知道在这种情况下没有受到影响，因为我登录到事件日志并且没有发生。

如果我在 web.config 中关闭自定义错误，则站点运行正常！

我们目前正在使用 MVC Beta。编辑：我们在 IIS6 上运行并使用 MVC 路由来获取友好的 URL。

这是不可能在本地测试的，这很令人沮丧，因为它只会在没有 www 的情况下发生。不知道是不是跟路由有关……

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T22:24:28.607

这个问题在这个阶段太模糊了，我无法给你一个好的答案，但我会首先看看你的 URL 重写——你使用的是什么版本的 IIS？如果是 IIS5 或 6，您使用的是 Isapi Rewrite 吗？这可能会干扰您的回复。

至于为什么当你关闭 customErrors 时错误会消失，好吧，我不知道抱歉。

附带说明一下，如果您关心 Google 排名，您可能希望使用重写工具（如 Isapi Rewrite，我认为它内置于 IIS7）来发送自动重定向（HTTP 301 响应），该重定向将发送用户从非www版本到www版本。谷歌将这两个网站视为具有重复内容的单独网站，这会削弱您的页面排名。这也将完全避免您正在尝试的问题，因为用户只会看到 www 版本。

另外，我不确定 Application_Error 是否真的是处理 ASP.Net MVC 中错误的最佳方法。对 HandleError Action Filter 做一些研究，看看这是否可以为您提供更好的错误处理方法。查看[Scott Gu](http://weblogs.asp.net/scottgu/archive/2008/07/14/asp-net-mvc-preview-4-release-part-1.aspx)关于此的帖子以获取更多信息。

我希望这有帮助。干杯，扎克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-09T09:46:01.560

我在我的 MVC .net 站点中遇到了同样的问题，但是当我在 IIS 的主机头中同时输入 domain.com 和 www.domain.com 时，它解决了。

# python - python upload - where are tmp/FILES?

> ID：562278
> 
> 赞同：0
> 
> 时间：2009-02-18T18:27:21.937
> 
> 标签：python, upload, cgi, mosso

I'm running python 2.4 from cgi and I'm trying to upload to a cloud service using a python api. In php, the $_FILE array contains a "tmp" element which is where the file lives until you place it where you want it. What's the equivalent in python?

if I do this

```
fileitem = form['file'] 
```

`fileitem.filename` is the name of the file

if i print fileitem, the array simply contains the file name and what looks to be the file itself.

I am trying to stream things and it requires the tmp location when using the php api.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T19:46:11.217

The file is a real file, but the `cgi.FieldStorage` unlinked it as soon as it was created so that it would exist only as long as you keep it open, and no longer has a real path on the file system.

You can, however, change this...

You can extend the `cgi.FieldStorage` and replace the `make_file` method to place the file wherever you want:

```
import os
import cgi

class MyFieldStorage(cgi.FieldStorage):
    def make_file(self, binary=None):
        return open(os.path.join('/tmp', self.filename), 'wb') 
```

You must also keep in mind that the `FieldStorage` object only creates a real file if it recieves more than 1000B (otherwise it is a `cStringIO.StringIO`)

**EDIT**: The `cgi` module actually makes the file with the `tempfile` module, so check that out if you want lots of gooey details.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T18:36:34.817

Here's a code snippet taken from my site:

```
h = open("user_uploaded_file", "wb")
while 1:
    data = form["file"].file.read(4096)
    if not data:
        break
    h.write(data)
h.close() 
```

Hope this helps.

# javascript - jQuery .find() 在 IE 中不返回数据，但在 Firefox 和 Chrome 中返回

> ID：562283
> 
> 赞同：23
> 
> 时间：2009-02-18T18:28:17.740
> 
> 标签：javascript, jquery, xml

我通过为他做一些网络工作来帮助他。他需要一种简单的方法来更改他网站上的几段文本。我决定提供一个包含消息的 XML 文件，而不是让他编辑 HTML，然后我使用 jQuery 将它们从文件中拉出并插入到页面中。

它工作得很好……在 Firefox 和 Chrome 中，在 IE7 中不是很好。我希望你们中的一个能告诉我原因。我做了一个公平但谷歌搜索但找不到我要找的东西。

这是 XML：

```
<?xml version="1.0" encoding="utf-8" ?>
<messages>
  <message type="HeaderMessage">
    This message is put up in the header area.
  </message>
  <message type="FooterMessage">
    This message is put in the lower left cell.
  </message>
</messages> 
```

这是我的 jQuery 调用：

```
<script type="text/javascript">
  $(document).ready(function() {
    $.get('messages.xml', function(d) {
      //I have confirmed that it gets to here in IE
      //and it has the xml loaded.
      //alert(d); gives me a message box with the xml text in it
      //alert($(d).find('message')); gives me "[object Object]"
      //alert($(d).find('message')[0]); gives me "undefined"
      //alert($(d).find('message').Length); gives me "undefined"
      $(d).find('message').each(function() {
        //But it never gets to here in IE
        var $msg = $(this);
        var type = $msg.attr("type");
        var message = $msg.text();
        switch (type) {
        case "HeaderMessage":
          $("#HeaderMessageDiv").html(message);
          break;
        case "FooterMessage":
          $("#footermessagecell").html(message);
          break;
          default:
        }
      });
    });
  });
</script> 
```

我需要在 IE 中做些不同的事情吗？基于带有 [object Object] 的消息框，我假设 .find 在 IE 中工作，但由于我无法使用 [0] 索引数组或检查它的长度，我猜这意味着 .find 不是返回任何结果。有什么理由可以在 Firefox 和 Chrome 中完美运行但在 IE 中失败？

我是 jQuery 的新手，所以我希望我没有做一些愚蠢的事情。上面的代码是从论坛中刮下来的，并根据我的需要进行了修改。由于 jQuery 是跨平台的，我想我不必处理这个烂摊子。

编辑：我发现如果我在 Visual Studio 2008 中加载页面并运行它，那么它将在 IE 中工作。所以事实证明它在通过开发 Web 服务器运行时总是有效的。现在我在想 IE 只是不喜欢在从我的本地驱动器加载的 XML 中执行 .find，所以当它在实际的 Web 服务器上时，它可能会正常工作。

我已经确认从 Web 服务器浏览时它可以正常工作。一定是IE的特点。我猜这是因为 Web 服务器为 xml 数据文件传输设置了 mime 类型，并且没有该 IE 无法正确解析 xml。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-01-10T01:24:47.660

由于 IE 的问题是它的 xml 解析器阻塞了未使用正确的“text/xml”标头传递的 xml 文件，因此您可以在**Ajax 完成**事件中包含一些代码：

```
    完成：函数（xhr，状态）
    {
      alert( "完成。你得到了：\n\n" + xhr.responseText ) ;
      如果（状态 == '解析错误'）
      {
        alert( "有一个 PARSERERROR。幸运的是，我们知道如何解决这个问题。\n\n" +
               "完整的服务器响应文本是" + xhr.responseText ) ;

        xmlDoc = null;

        // 从 responseText 字符串创建 xml 文档。
        // 这使用w3schools方法。
        //另见
        如果（窗口.DOMParser）
        {
          解析器=新 DOMParser();
          xmlDoc=parser.parseFromString(xhr.responseText,"text/xml");
        }
        否则 // Internet Explorer
        {
          xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
          xmlDoc.async = "假" ;
          xmlDoc.loadXML(xhr.responseText);
        }

        $( '#response' ).append( '<p>完成事件/xmlDoc: ' + xmlDoc + '</p>' ) ;
        $( '#response' ).append( '<p>完成事件/状态：' + status + '</p>' ) ;

        处理XMLDoc(xmlDoc)；
      }
    },

```

## 这是一个更完整的例子

```
<!DOCTYPE html>
<html>
<头部>
<title>使用 jQuery 读取 XML</title>
<风格>
＃回复
{
  边框：纯色 1px 黑色；
  填充：5px；
}
</style>
<script src="jquery-1.3.2.min.js"></script>
<脚本>
函数 processXMLDoc( xmlDoc )
{
  var header = $(xmlDoc).find('heading').text() ;
  $( '#response' ).append( '<h1>' + 标题 + '</h1>' ) ;

  var bodyText = $(xmlDoc).find('body').text() ;
  $( '#response' ).append( '<p>' + bodyText + '</p>' ) ;
}
$(文档).ready(函数()
{
  jQuery.ajax({

    类型：“获取”，

    网址：“a.xml”，//！注意同样
    //原点类型问题

    dataType: "xml", // 'xml' 通过浏览器的 xml 解析器传递它

    成功：函数（xmlDoc，状态）
    {
      // SUCCESS EVENT 表示xml文档
      // 从服务器下来并成功解析
      // 使用浏览器自己的 xml 解析 caps。

      处理XMLDoc(xmlDoc)；

      // IE 变得非常沮丧
      // 文档的 MIME 类型
      // 传递下来的不是 text/xml。

      // 如果您缺少 text/xml 标头
      // 显然 xml 解析失败，
      // 而在 IE 中你根本无法执行这个函数。

    },
    完成：函数（xhr，状态）
    {
      alert( "完成。你得到了：\n\n" + xhr.responseText ) ;
      如果（状态 == '解析错误'）
      {
        alert( "有一个 PARSERERROR。幸运的是，我们知道如何解决这个问题。\n\n" +
               "完整的服务器响应文本是" + xhr.responseText ) ;

        xmlDoc = null;

        // 从 responseText 字符串创建 xml 文档。
        // 这使用w3schools方法。
        //另见
        如果（窗口.DOMParser）
        {
          解析器=新 DOMParser();
          xmlDoc=parser.parseFromString(xhr.responseText,"text/xml");
        }
        否则 // Internet Explorer
        {
          xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
          xmlDoc.async = "假" ;
          xmlDoc.loadXML(xhr.responseText);
        }

        $( '#response' ).append( '<p>完成事件/xmlDoc: ' + xmlDoc + '</p>' ) ;
        $( '#response' ).append( '<p>完成事件/状态：' + status + '</p>' ) ;

        处理XMLDoc(xmlDoc)；
      }
    },
    错误：函数（xhr，状态，错误）
    {
      警报（'错误：'+状态）；
      警报（xhr.responseText）；
    }
  });
});
</脚本>
</head>
<正文>
  <div>
    <h1><a href="http://think2loud.com/reading-xml-with-jquery/">使用 jQuery 读取 XML</a></h1>
    <p>
      <a href="http://docs.jquery.com/Ajax/jQuery.ajax#options">#1 jQuery.ajax 参考</a>
    </p>

  </div>

  <p>服务器说：</p>
  <pre id="响应">

  </pre>
</正文>
</html>

```

## a.xml 的内容

```
<?xml 版本="1.0"?>
<注意>
  <to>祝</to>
  <from>贾尼</from>
  <heading>提醒</heading>
  <body>这个周末别忘了我！</body>
</注>

```

它扩展[了这个例子](http://marcgrabanski.com/article/jquery-makes-parsing-xml-easy)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-18T20:09:22.613

检查响应的内容类型。如果您将messages.xml 作为错误的mime 类型，Internet Explorer 不会将其解析为XML。

要检查内容类型，您需要访问 XMLHttpRequest 对象。正常的成功回调不会将其作为参数传递，因此您需要添加通用的 ajaxComplete 或 ajaxSuccess 事件处理程序。这些事件的第二个参数是 XMLHttpRequest 对象。您可以对其调用 getResponseHeader 方法来获取内容类型。

```
$(document).ajaxComplete(function(e, x) {
    alert(x.getResponseHeader("Content-Type"));
}); 
```

不幸的是，我知道在 Internet Explorer 中无法覆盖服务器发送的内容，因此如果错误，您需要更改服务器以发送内容类型的“text/xml”。

有些浏览器有一种`overrideMimeType`方法，您可以在之前调用`send`它来强制它使用“text/xml”，但据我所知，Internet Explorer 不支持该方法。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-05-30T14:17:33.390

dataType :"xml" 没有解决 IE8 中的这个问题，而是通过“TypeError”预期。

Quick & Dirty 修复，是将 xml 响应包装在 html 元素中，如 div：

```
$("<div>" + xml + "</div>").find("something"); 
```

（适用于所有浏览器）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-19T11:22:01.530

您可能会发现，如果将数据类型传递给 get 调用，它可能会正确解析为 XML。IE 的怪癖可能会阻止 jQuery 将其自动检测为 XML，从而导致将错误的数据类型传递给回调函数。

```
<script type="text/javascript">
      $(document).ready(function() {
        $.get('messages.xml', function(d) {
          //I have confirmed that it gets to here in IE
          //and it has the xml loaded.
          //alert(d); gives me a message box with the xml text in it
          //alert($(d).find('message')); gives me "[object Object]"
          //alert($(d).find('message')[0]); gives me "undefined"
          //alert($(d).find('message').Length); gives me "undefined"
          $(d).find('message').each(function() {
            //But it never gets to here in IE
            var $msg = $(this);
            var type = $msg.attr("type");
            var message = $msg.text();
            switch (type) {
            case "HeaderMessage":
              $("#HeaderMessageDiv").html(message);
              break;
            case "FooterMessage":
              $("#footermessagecell").html(message);
              break;
              default:
            }
          });
        }, "xml");
      });
</script> 
```

编辑：

实际上，我刚刚经历过 .find() 不适用于任何浏览器中的项目，但我能够使用 .filter() 代替。我不得不求助于这个很烦人，但如果它有效....

```
$(d).filter('message').each(......); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-06-17T14:11:14.090

你可以做

```
<a>
<messages>
  <message type="HeaderMessage">
    This message is put up in the header area.
  </message>
  <message type="FooterMessage">
    This message is put in the lower left cell.
  </message>
</messages>
</a> 
```

并使用 find()。它适用于 IE8 和 firefox v.3.6.3

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-01-12T09:05:26.713

我也遇到了同样的问题，但我已经使用下面的代码修复了 IE jQuery XML .find() 问题。

注意：使用 .text() 而不是 .html()。

```
jQuery.ajax({
 type: "GET",
        url: "textxml.php",
        success: function(msg){             
            data = parseXml(msg);
            //alert(data);
            var final_price = jQuery(data).find("price1").text();
            alert(final_price); 
            }
    });     

function parseXml(xml) {
     if (jQuery.browser.msie) {
        var xmlDoc = new ActiveXObject("Microsoft.XMLDOM"); 
        xmlDoc.loadXML(xml);
        xml = xmlDoc;
    }   
    return xml;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-18T18:39:26.573

有时 IE 将换行符读取为额外的节点。尝试删除标记之前的额外空白，或尝试将其封装为 CDATA。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-01-21T17:43:49.003

当我从 XML 文档中检索数据时，我遇到了同样的问题。在互联网上搜索了很多之后，我找到了这个网站，但没有正确回答这个问题。但是一个答案帮助我解决了这个问题：

“由于 IE 的问题是它的 xml 解析器阻塞了未使用正确的“text/xml”标头传递的 xml 文件，因此您可以在 Ajax 完成事件中包含一些代码：”

在进行 $.ajax(...) 和 $.get(...) 调用时，我发现了 IE 的两个问题：

1.  两个调用的*xml*参数值必须为大写（'XML' 而不是 'xml'） - $.ajax(..., dataType: "XML") 和*$.get(xmlDataFilePath, function(d){.. .}, "xml")*

2.  当ajax调用成功时，**回调函数的xml参数实际上是一个*字符串*而不是一个XML DOM对象**

第二个问题是这样解决的：

```
$(document).ready(function()
{
    $.ajax(
    { 
        type: "GET",
        url: "messages.xml", 
        dataType: "XML", /* this parameter MUST BE UPPER CASE for it to work in IE */
        success: function(xml)
        { 
            processXmlDoc( createXmlDOMObject ( xml ) );
        }, /* success: */
        error: function(xhr, textStatus, errorThrown)
        { 
            alert(textStatus + ' ' + errorThrown);
        } /* error: */
    });/* $.ajax */

    function createXmlDOMObject(xmlString)
    {
        var xmlDoc = null;

        if( ! window.DOMParser )
        {
            // the xml string cannot be directly manipulated by browsers 
            // such as Internet Explorer because they rely on an external 
            // DOM parsing framework...
            // create and load an XML document object through the DOM 
            // ActiveXObject that it can deal with
            xmlDoc = new ActiveXObject( "Microsoft.XMLDOM" );
            xmlDoc.async = false;
            xmlDoc.loadXML( xmlString );
        }
        else
        {
            // the current browser is capable of creating its own DOM parser
            parser = new DOMParser();
            xmlDoc = parser.parseFromString( xmlString, "text/xml" ) ;
        }

        return xmlDoc;
    }

    function processXmlDoc(xmlDoc)
    {
        // write here your XML processing logic for the document object...
    } 
}); // $(document).ready 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-04-29T05:56:08.937

更改以下内容。

```
dataType :"text/xml", 
```

到

```
dataType :"xml", 
```

无需更改 find()。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-05-30T14:23:17.950

```
$.ajax({
  url: 'messages.xml',
  success: function(data){
     $(d).find('message').each(function(){
        //But it never gets to here in IE
        var $msg = $(this);
        var type = $msg.attr("type");
        var message = $msg.text();
        switch (type) {
          case "HeaderMessage":
             $("#HeaderMessageDiv").html(message);
          break;
          case "FooterMessage":
             $("#footermessagecell").html(message);
          break;
        }
      });
  },
  dataType: 'xml'
}); 
```

尝试告诉 jQuery 它得到什么数据类型，以便它使用正确的方法来处理您的请求。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-12-07T12:36:10.650

我在导入电子邮件联系人时也遇到了同样的问题。我能够导入联系人并在除 IE 之外的所有浏览器中显示，但`.find()`无法正常工作。

所以，我分配`"text/xml"`到`response.contentType`.

即`response.contentType = "text/xml"`它起作用了。

早些时候是`"text/html"`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-02-10T04:12:07.093

我遇到了同样的问题，我正在开发一个基于 Web 的应用程序，但我需要它在 CD 内离线部署它。我在此页面中找到了解决方案，这与您可以在[http://docs.jquery.com/Specifying_the_Data_Type_for_AJAX_Requests](http://docs.jquery.com/Specifying_the_Data_Type_for_AJAX_Requests)上方看到的解决方案相同， 并且代码非常简单：

```
 $.ajax({
   url: "data.xml",
   dataType: ($.browser.msie) ? "text" : "xml",
   success: function(data){
     var xml;
     if (typeof data == "string") {
       xml = new ActiveXObject("Microsoft.XMLDOM");
       xml.async = false;
       xml.loadXML(data);
     } else {
       xml = data;
     }
     // write here your XML processing logic for the document object... 
   }
 }); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-08-02T14:33:11.947

我也有同样的问题...

解决了这个：

[http://www.w3schools.com/dom/dom_parser.asp](http://www.w3schools.com/dom/dom_parser.asp)

```
if (window.DOMParser)
  {
  parser=new DOMParser();
  xmlDoc=parser.parseFromString(text,"text/xml");
  }
else // Internet Explorer
  {
  xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
  xmlDoc.async="false";
  xmlDoc.loadXML(text); 
  } 
```

用它来将你的 var 转换为 xml 对象......

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-02-21T11:15:37.110

**它工作正常！试试这个，**

铬/火狐：

```
xml.children[0].childNodes[1].innerHTML; 
```

IE8+/Safari：

```
xml.childNodes[0].childNodes[1].textContent; 
```

IE8：

```
xml.documentElement.childNodes[1].text; 
```

示例代码在这里，

```
var xml = $.parseXML(XMLDOC); 

Var xmlNodeValue = ""; 

if(userAgent.match("msie 8.0")){

xmlNodeValue = xml.children[0].childNodes[1].innerHTML;

}else{ // IE8+

xmlNodeValue = xml.childNodes[0].childNodes[1].textContent; 

} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-09-17T09:35:01.683

如果 XML 是由 PHP 脚本生成的，您可以这样做

```
<?php
    header("Content-type: text/xml");
    echo '<myxml></myxml>';
?> 
```

然后 find 方法适用于每个浏览器

# .net - 使用 DirectorySearcher 访问 ActiveDirectory 的身份验证

> ID：562288
> 
> 赞同：2
> 
> 时间：2009-02-18T18:28:46.677
> 
> 标签：.net, active-directory, ldap

我需要使用域凭据访问我的 Active Directory 域中的信息。DirectorySearcher 类没有用户和密码参数。我该如何指定它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T18:38:46.137

[请参阅MSDN 上这篇文章中](http://msdn.microsoft.com/en-us/library/ms973834.aspx)的“向您的目录进行身份验证”部分。它的要点是您使用 DirectoryEntry （在构造函数中获取凭据）连接到您的 ldap 根，然后在其上使用 DirectorySearcher。

# lua - Lua值没有改变？

> ID：562292
> 
> 赞同：0
> 
> 时间：2009-02-18T18:30:01.527
> 
> 标签：lua

我在一个名为 ROBLOX 的在线游戏中使用了非常简单的 Lua 脚本。我的问题是我的脚本中的值没有改变！例子：

```
num = 0
while true do
    num = num + 1
    print(num)
    wait(1)
end 
```

这应该从 0 开始计数，但数字不会改变。这可能来自 ROBLOX 网站吗？我想不出还有什么可能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T18:35:02.620

会发生什么

```
local num = 0 
while true do 
    num = num + 1 
    print(num) 
    wait(1) 
end 
```

?

也许系统的其他部分正在改变全局`num`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-22T20:12:48.663

您的代码中没有错误。如果您使用的是 ROBLOX，那么我不确定您是如何运行错误的，因为它是一个相当简单的界面。我将在 ROBLOX 中尝试它，看看它是否对我有错误。

对于那些想知道 wait() 的人：这是一个 ROBLOX 特定的全局函数，它将当前任务暂停括号中的秒数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T15:37:15.977

我只是将您的代码放在[Lua 演示](http://www.lua.org/cgi-bin/demo)中，如果您删除 wait() 函数调用，它就可以正常工作。我假设你在某处定义了这个函数？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-19T04:10:42.917

代码没有问题。你一定是跑错了。此外，wait 是 Roblox API 中定义的函数。这是合法的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-23T03:23:04.443

尝试这个：

```
local num = 0
while true do
    num = num + 1
    print(num)
    print(type(num))
    wait(1)
end 
```

# sql - SQL Server 2005 LEN函数异常

> ID：562300
> 
> 赞同：1
> 
> 时间：2009-02-18T18:31:37.760
> 
> 标签：sql, sql-server

以下代码：

```
if (right(@eqlist,2) = ', ')
  set @eqlist = left(@eqlist,len(@eqlist)-2) 
```

在我的生产服务器上产生与在我的开发服务器上不同的结果（具有相同的数据）。

问题是 LEN 函数“应该”在计算字符串长度之前修剪尾随空格，但在我的开发服务器上似乎没有这样做。

在我的开发服务器上，它可以正常工作并从字符串中去除尾随的“，”，但在生产服务器上，它会去除一个额外的字符。显然，将“-2”更改为“-1”可以解决生产服务器的问题，但会破坏开发服务器的问题。

我重写了代码，使其在两台服务器上都能正常工作，但我仍然想知道为什么 LEN 函数在每台服务器上的行为都不同。

重写的代码：

```
if (right(@eqlist,2) = ', ')
  set @eqlist = left(rtrim(@eqlist),len(rtrim(@eqlist))-1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T18:53:20.003

您在创建表时检查过 ANSI_PADDING 的值吗？如果没有关于您的问题的完整细节，我不能肯定地说，但是如果您要针对带有 VARCHAR 列的表，这可能会导致它的行为不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T18:47:55.960

检查两台服务器、数据库和表上的字符集和排序规则设置。差异可能会导致一个被修剪而另一个不被修剪。

# c - 权威的 C 书籍指南和清单

> ID：562303
> 
> 赞同：400
> 
> 时间：2009-02-18T18:32:02.580
> 
> 标签：c编程语言的, , c, c++, c

这个问题试图收集社区维护的关于[c编程语言的](/questions/tagged/c "show questions tagged 'c'")***优质***书籍列表，针对不同的技能水平。

C 是一种复杂的编程语言，很难通过阅读在线教程在旅途中学习。一本综合性的书往往是学习语言的最好方法，而找到一本好书是第一步。避免写得不好的书很重要，更重要的是，避免包含严重技术错误的书。

请建议对已接受的答案进行编辑以添加高质量的书籍，并附上大致的技能水平和关于每本书的简短介绍/描述。（*请注意，问题已锁定，因此不会接受新答案。列表中只保留一个答案*）

随意辩论书籍的选择、质量、标题、摘要、技能水平以及您认为错误的任何其他内容。这里的 C 社区认为令人满意的书籍将留在列表中；其余的将定期删除。

对于有 C 和 C++ 用户协会 (ACCU) 评论的书籍，应随书添加指向这些评论的链接。

也可以看看：

*   [c](/questions/tagged/c "显示标记为“c”的问题") [标签 wiki](https://stackoverflow.com/tags/c/info)中的其他 C 相关资源
*   [c++](/questions/tagged/c%2b%2b "显示标记为“c++”的问题")的类似列表：[权威 C++ 书籍指南和列表](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)

* * *

[这个问题在[Meta](https://meta.stackoverflow.com/a/378475)上作为[2018 年已删除问题审计](https://meta.stackoverflow.com/questions/378437/deleted-question-audit-2018)的一部分进行了讨论。
共识是保持它不被删除并积极维护。]

* * *

## 回答 #1

> 赞同：544
> 
> 时间：2009-02-18T18:54:22.123

***警告***！

这是不同质量的随机书籍列表。在某些人看来（有一定道理），它不再是推荐书籍的清单。列出的一些书籍包含明显不正确的陈述或教导错误/有害的做法。了解此类书籍的人可以编辑此答案以帮助改进它。请参阅[C 书籍列表已乱套。该怎么办？](https://meta.stackoverflow.com/questions/355588/the-c-book-list-has-gone-haywire-what-to-do-with-it)，并且还[删除了问题审计 2018](https://meta.stackoverflow.com/questions/378437/deleted-question-audit-2018)。

# 参考（所有级别）

*   [C 编程语言（第 2 版）](https://rads.stackoverflow.com/amzn/click/com/0131103628) ——Brian W. Kernighan 和 Dennis M. Ritchie（1988 年）。仍然是一个很好的、简短但完整的 C 介绍（C90，不是 C99 或更高版本），由 C 的发明者编写。但是，在过去的 25 年中，语言发生了变化，良好的 C 风格已经发展起来，其中有部分显示其年代的书。

*   [C：参考手册（第 5 版）](https://rads.stackoverflow.com/amzn/click/com/013089592X) - Samuel P. Harbison 和 Guy R. Steele (2002)。一本关于 C 的优秀参考书，包括 C99。这不是教程，可能不适合初学者。如果您需要为 C 编写编译器，那就太好了，正如作者在开始时所做的那样。

*   [C Pocket Reference (O'Reilly)](https://rads.stackoverflow.com/amzn/click/com/0596004362) - Peter Prinz 和 Ulla Kirch-Prinz (2002)。

*   [comp.lang.c 常见问题解答](http://c-faq.com/)- Steve Summit。有许多关于 C. 的问题的答案的网站。

*   可以在[此处](http://www.iso-9899.info/wiki/The_Standard)找到各种版本的 C 语言标准。[C11 标准草案](http://port70.net/%7Ensz/c/c11/n1570.html)有一个在线版本。

*   [新的 C 标准 - 带注释的参考](http://www.knosof.co.uk/cbook/cbook.html)(免费 PDF) - Derek M. Jones (2009)。所指的“新标准”是旧的C99标准，而不是C11。

*   [C99 标准的基本原理](http://www.open-std.org/JTC1/SC22/WG14/www/C99RationaleV5.10.pdf)。

* * *

# 初学者

*   [C 编程：现代方法（第 2 版）](http://knking.com/books/c2/index.html) - KN King（2008 年）。一本学习的好书 C.

*   [C 语言编程（第 4 版）](https://rads.stackoverflow.com/amzn/click/com/0321776410) - Stephen Kochan（2014 年）。一个很好的一般介绍和教程。

*   [C Primer Plus（第 5 版）](https://rads.stackoverflow.com/amzn/click/com/0672326965) -Stephen Prata（2004 年）

*   [关于 C 的书](https://rads.stackoverflow.com/amzn/click/com/0201183994)- Al Kelley/Ira Pohl (1998)。

*   [C 书](http://publications.gbdirect.co.uk/c_book/)（免费在线）- Mike Banahan、Declan Brady 和 Mark Doran (1991)。

*   [C：如何编程（第 8 版）](https://www.amazon.com//dp/0133976890) - Paul Deitel 和 Harvey M. Deitel（2015 年）。很多适合初学者的好技巧和最佳实践。该索引非常好，可以作为一个不错的参考（只是不完全全面，而且非常浅薄）。

*   [Head First C](https://rads.stackoverflow.com/amzn/click/com/1449399916) - David Griffiths 和 Dawn Griffiths (2012)。

*   [开始 C（第 5 版）](https://www.apress.com/book/9781430248811) - Ivor Horton（2013 年）。非常好的指针解释，使用了许多小而完整的程序。

*   [Sams 在 21 天内自学 C](https://rads.stackoverflow.com/amzn/click/com/0672324482) - Bradley L. Jones 和 Peter Aitken (2002)。非常好的入门资料。

*   [C In Easy Steps（第 5 版）](https://smile.amazon.com/Programming-easy-steps-5th-Compiler/dp/1840788402/) - Mike McGrath（2018 年）。这是一本学习和参考C的好书。

*   [有效 C](https://smile.amazon.com/dp/1718501048) - Robert C Seacord (2020)。对现代 C 语言的良好介绍，包括关于动态内存分配、程序结构以及调试、测试和分析的章节。它有一些指向可能的 C2x 功能的指针。

# 中间的

*   [现代 C](https://modernc.gforge.inria.fr/) — Jens Gustedt（2017 年第 1 版；2020 年第 2 版）。涵盖从初级 C 到高级 C 的 5 个级别（相遇、相识、认知、经验、抱负）的 C。它涵盖了 C11 和 C17，包括线程和原子访问，其他书籍很少这样做。并非所有编译器都能在所有环境中识别这些功能。

*   [C 接口和实现](http://www.cs.princeton.edu/software/cii/)- David R. Hanson (1997)。提供有关如何以通用和可重用的方式在 C 中定义接口和实现之间的边界的信息。它还通过将其应用于 C 中常见机制和数据结构的实现来演示这一原则，例如列表、集合、异常、字符串操作、内存分配器等。基本上，Hanson 将他编写的所有代码作为构建[Icon](http://www.cs.arizona.edu/icon)和[lcc](http://www.cs.princeton.edu/software/lcc/)的一部分，并以其他人可以在他们自己的项目中重用的形式提取出最好的部分。它是使用现代设计技术（包括 Liskov 的数据抽象）的优秀 C 编程模型，展示了如何将大型 C 项目组织为一堆有用的库。

*   [C 拼图书](https://rads.stackoverflow.com/amzn/click/com/0201604612)- Alan R. Feuer (1998)

*   [标准 C 库](https://rads.stackoverflow.com/amzn/click/com/0131315099)- PJ Plauger (1992)。它包含 C89 标准库实现的完整源代码，以及关于设计的广泛讨论以及代码设计的原因。

*   [21 世纪 C：新学校的 C 提示](https://rads.stackoverflow.com/amzn/click/com/1449327141)- Ben Klemens (2012)。除了 C 语言，本书还解释了 gdb、valgrind、autotools 和 git。关于风格的评论在最后一部分（第 6 章及以后）中找到。

*   [C 中的算法](https://rads.stackoverflow.com/amzn/click/com/0201314525)- Robert Sedgewick (1997)。让您真正掌握用 C 实现算法。非常清晰明了；可能会让您想扔掉所有其他算法书籍并保留这本。

*   [C](https://rads.stackoverflow.com/amzn/click/com/0673999866) - Kenneth Reek (1997) 的指针。

*   [C 语言解决问题和程序设计（第 6 版）](https://rads.stackoverflow.com/amzn/click/com/0321535421) - Jeri R. Hanly 和 Elliot B. Koffman（2009 年）。

*   [数据结构 - 使用 C 的高级方法](https://rads.stackoverflow.com/amzn/click/com/B00101Y58Q)- Jeffrey Esakov 和 Tom Weiss (1989)。

*   [C Unleashed](https://rads.stackoverflow.com/amzn/click/com/0672318962) - Richard Heathfield、Lawrence Kirby 等人。（2000 年）。不理想，但值得中级程序员练习本书中写的问题。这是 comp.lang.c 贡献者建议的一种很好的类似食谱的方法。

*   [使用 ANSI-C 进行面向对象编程](http://www.planetpdf.com/codecuts/pdfs/ooc.pdf)（免费 PDF）- Axel-Tobias Schreiner (1993)。代码有点复杂。如果你想要 C++，请使用 C++。当然，它只使用 C90。

# 专家

*   [Expert C Programming: Deep C Secrets](https://rads.stackoverflow.com/amzn/click/com/0131774298) - Peter van der Linden (1994)。Sun 编译器团队提供了许多有趣的信息和战争故事，但有些地方有些过时。

*   [示例高级 C 编程](https://rads.stackoverflow.com/amzn/click/com/0534951406)- John W. Perry (1998)。

*   [UNIX 环境中的高级编程](https://rads.stackoverflow.com/amzn/click/com/0321637739)- Richard W. Stevens 和 Stephen A. Rago（2013 年）。全面描述了如何从 C 代码中使用 Unix API，但对 C 编码的机制并没有那么多。

* * *

# 未分类

*   [Essential C](http://cslibrary.stanford.edu/101/EssentialC.pdf) (免费 PDF) - Nick Parlante (2003)。请注意，这在几个方面描述了 C90 语言（*例如*，在讨论`//`注释和在代码中任意位置放置变量声明时），因此应谨慎对待。

*   [C 编程常见问题解答：常见问题解答](https://rads.stackoverflow.com/amzn/click/com/0201845199)- Steve Summit (1995)。这是前面列出的网站的书。它不包括 C99 或更高版本的标准。

*   [C in a Nutshell](https://rads.stackoverflow.com/amzn/click/com/0596006977) - Peter Prinz 和 Tony Crawford (2005)。如果您需要 C99 的参考资料，这本书很棒。

*   [功能 C](https://rads.stackoverflow.com/amzn/click/com/0201419505) - Pieter Hartel 和 Henk Muller (1997)。教授对低级编程非常宝贵的现代实践，同时考虑到并发性和模块化。

*   [编程实践](https://rads.stackoverflow.com/amzn/click/com/020161586X)- Brian W. Kernighan 和 Rob Pike (1999)。一本很好的陪伴K&R的书。它也使用 C++ 和 Java。

*   [A. Koenig (1989) 的C 陷阱和陷阱](https://rads.stackoverflow.com/amzn/click/com/0201179288)。非常好，但是 C 风格早于标准 C，这使得它现在不太推荐。

    ^(一些人主张从这份清单中删除“陷阱和陷阱”，因为它使一些人陷入了错误的陷阱；其他人继续主张将其纳入。也许它应该被视为一本“专家”书，因为它需要对 C 有一定广泛的了解才能理解自出版以来发生的变化。)

*   [MISRA-C](http://www.misra-c.com/Activities/MISRAC/tabid/160/Default.aspx) - 由汽车工业软件可靠性协会发布和维护的行业标准。涵盖 C89 和 C99。

    ^(尽管这不是一本这样的书，但许多程序员建议尽可能多地阅读和实施它。MISRA-C 最初旨在作为安全关键应用程序的指南，但它适用于任何需要稳定、无错误的 C 代码的应用程序领域（谁不想要更少的错误？）。MISRA-C 正在成为整个嵌入式行业的事实标准，甚至在其他编程分支中也越来越流行。该标准（至少）有三个出版物（1998 年、2004 年和 2012 年的当前版本）。还有一份 2016 年的 MISRA 合规指南文件和 MISRA C:2012 修正案 1 — MISRA C:2012 的附加安全指南（2016 年 4 月发布）。)

    ^(请注意，MISRA 规则中的某些限制并不适用于所有情况。例如，指令 4.12 声明“不得使用动态内存分配”。这适用于为其设计 MISRA 规则的嵌入式系统；它并不适合任何地方。（例如，编译器通常对符号表之类的东西使用动态内存分配，如果不是荒谬的话，不使用动态内存分配是很困难的。）)

*   从 2007 年开始，ACCU 审查过的关于[初学者 C](https://web.archive.org/web/20071105015557/http://www.accu.informika.ru/bookreviews/public/reviews/0sb/beginner_s_c.htm)（116 个标题）和2008 年[高级 C](https://web.archive.org/web/20081020081215/http://www.accu.informika.ru/bookreviews/public/reviews/0sb/advanced_c.htm)（76 个标题）的书籍的存档列表。其中大多数看起来不再出现在主站点上，您无法按主题浏览反正。

* * *

# 警告

[在ISO 9899 Wiki](http://iso-9899.info/wiki/Main_Page#Stuff_that_should_be_avoided)上有一份需要注意的书籍和教程列表，它本身与 ISO 或 C 标准没有正式关联，但包含有关 C 标准的信息（尽管它欢呼 ISO 9899:2011 和未提及 ISO 9899:2018 的发布）。

警惕[Herbert Schildt](http://catb.org/%7Eesr/jargon/html/B/bullschildt.html)写的书。特别是，您应该远离[C: The Complete Reference](https://rads.stackoverflow.com/amzn/click/com/0072121246) (4th Edition, 2000)，在某些圈子中称为 C: The Complete Nonsense。

也不要使用 Yashwant Kanetkar 的书^(Let) [Us C](https://smile.amazon.com/dp/9387284492/)（第 16版，2017 年）。许多人认为它是一本过时的书，教授 Turbo C，并且有许多过时、误导和不正确的材料。例如，第 137 页讨论了预期的输出，但并未将其归类为应有的[未定义行为](https://stackoverflow.com/questions/949433/why-are-these-constructs-using-pre-and-post-increment-undefined-behavior)。它还始终如一地促进不可移植和错误的编码实践，例如使用, in ，将返回值存储在类型的变量中或使用on 。^(`printf("%d %d %d\n", a, ++a, a++)``gets``%[\n]s``scanf``getchar``char``fflush``stdin`)

由 Zed Shaw[学习 C The Hard Way (2015)。](https://learncodethehardway.org/c/)一本褒贬不一的书。 Tim Hentenaar[对这本书的评论：](http://hentenaar.com/dont-learn-c-the-wrong-way)

> 总结一下我在下面列出的观点，作者以一种过于简单和误导的方式呈现材料，整个语料库是一团糟，他提供的一些观点和分析完全是错误的。我试图以一个新手的眼光来看待这本书，但不幸的是，我对用 C 编写代码的多年经验有偏见。对我来说很明显，要么作者对 C 的理解存在缺陷，要么他故意将其过度简化为他实际上在误导读者（有意或无意）。

《Learn C The Hard Way》不是我可以推荐给既学习编程又学习 C 的人的书。如果你已经是其他相关语言的合格程序员，那么它代表了一个有趣且不同寻常的关于C，尽管我对本书的某些部分有所保留。 [*乔纳森·莱弗勒*]

* * *

# 过时的

*   [实用 C 编程（第 3 版）](https://rads.stackoverflow.com/amzn/click/com/1565923065) - Steve Oualline（1997 年）（初学者）

* * *

[**其他贡献者**，不一定记入修订历史，包括：
[Alex Lockwood](https://stackoverflow.com/users/844882/alex-lockwood)、 [Ben Jackson](https://stackoverflow.com/users/479989/ben-jackson)、 [Bubbles](https://stackoverflow.com/users/631423/bubbles)、 [claws](https://stackoverflow.com/users/193653/claws)、 [coledot](https://stackoverflow.com/users/14463/coledot)、 [Dana Robinson](https://stackoverflow.com/users/3161/dana-robinson)、 [Daniel Holden](https://stackoverflow.com/users/1322636/daniel-holden)、 [desbest](https://stackoverflow.com/users/337306/desbest)、 [Dervin Thunk](https://stackoverflow.com/users/50305/dervin-thunk)、 [dwc](https://stackoverflow.com/users/57301/dwc)、 Erci [Hou](https://stackoverflow.com/users/2226524/eric-hou)、 [Garen](https://stackoverflow.com/users/102600/garen)、 [haziz](https://stackoverflow.com/users/714232/haziz)、 [Johan Bezem](https://stackoverflow.com/users/1029106/johan-bezem)、 [Jonathan Leffler](https://stackoverflow.com/users/15168/jonathan-leffler) , [Joshua Partogi](https://stackoverflow.com/users/141186/joshua-partogi) , [Lucas](https://stackoverflow.com/users/74660/lucas) , [Lundin](https://stackoverflow.com/users/584518/lundin) , [Matt K.](https://stackoverflow.com/users/52734/mattk) , [mossplix](https://stackoverflow.com/users/487623/mossplix) , [Matthieu M.](https://stackoverflow.com/users/147192/matthieu-m) , [midor](https://stackoverflow.com/users/3991400/midor) , [Nietzche-jou](https://stackoverflow.com/users/39892/nietzche-jou) , [Norman Ramsey](https://stackoverflow.com/users/41661/norman-ramsey) , [r3st0r3](https://stackoverflow.com/users/416623/r3st0r3) , [ridthyself](https://stackoverflow.com/users/2395058/ridthyself) , [Robert S. Barnes](https://stackoverflow.com/users/71074/robert-s-barnes) , [smalinux](https://stackoverflow.com/users/5688267/smalinux) , [Steve Summit](https://stackoverflow.com/users/3923896/steve-summit) , [Tim Ring](https://stackoverflow.com/users/3685/tim-ring) , [Tony Bai](https://stackoverflow.com/users/207003/tony-bai) , [VMatm](https://stackoverflow.com/users/213550/vmatm)]

# asp.net - 正则表达式适用于 Firefox，但不适用于 ie 7.0

> ID：562306
> 
> 赞同：0
> 
> 时间：2009-02-18T18:32:22.423
> 
> 标签：asp.net, regex

似乎使用 asp.net 正则表达式验证器存在一些问题，它们在 firefox 中工作，但在某些 ie 风格中却没有（反之亦然，我不知道）。

无论如何，任何人都有替代品：

```
([a-zA-Z1-9]*)\.(((P|p)(D|d)(F|f))|((d|D)(o|O)(c|C))) 
```

基本上将任何文件名/路径与 PDF 或 Doc 扩展名匹配？

正如我所说，这在Firefox下运行时效果很好，但不是IE 7

编辑：我在这里谈论客户端验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T18:39:12.063

你的表情不是很宽容：

```
 ([a-zA-Z1-9]*) 
```

不匹配`MyPDF-0.pdf`，或者更重要的是，`C:\Path\To\Doc.pdf`. 检查表单输入，看看您是否有完整的文件路径或只是一个文件名。

**编辑**：

试试这个：

```
\.([Pp][Dd][Ff]|[Dd][Oo][Cc][Xx]?)$ 
```

除非你可以让它不区分大小写，比如在 JavaScript 中：

```
/\.(pdf|docx?)$/i 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T18:46:23.450

```
<script type="text/javascript">
var re = /([a-zA-Z1-9]*)\.(((P|p)(D|d)(F|f))|((d|D)(o|O)(c|C)))/;
var filename = "abcd.PdF";
document.writeln(re.test(filename)); // true in IE 7
</script> 
```

能否提供一个在 IE 7 中不起作用但在 Firefox 中起作用的测试用例？

您可以将所有这些`or`s替换为`/([a-zA-Z1-9]*)\.(([Pp][Dd][Ff])|([dD][oO][cC]))/`or `/([a-z1-9]*)\.((pdf)|(doc))/i`。

James 有一个很好的观点，如果这应该与 an 中的值匹配`<input type="file">`，Internet Explorer 可能包含路径，而 Firefox 没有（我知道它在服务器上，它也可能在客户端上）。

好的建议是实际检查您尝试与正则表达式匹配的值，以确保它是您认为的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T18:47:24.620

您的正则表达式没有任何问题（除了您可以按照其他人的建议进行一些优化）。以下代码在 IE 7 和 Firefox 中运行良好并成功匹配字符串：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <title>Test</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript">
    window.onload = function() {
        var regex = /([a-zA-Z1-9]*)\.(((P|p)(D|d)(F|f))|((d|D)(o|O)(c|C)))/;
        alert(regex.test('test.pdf'));
    };
    </script>
</head>
<body></body>
</html> 
```

所以还有其他可能导致问题的原因。我建议您尝试尽可能多地隔离问题，然后更容易找到解决方案。

# .net - 水晶报表

> ID：562311
> 
> 赞同：0
> 
> 时间：2009-02-18T18:33:42.967
> 
> 标签：.net, crystal-reports

我将 ASP.Net 应用程序从 .NET 1.1 升级到了 .NET 2.0。所有网页仍然可以正常工作，但无法加载 Crystal Reports。

堆栈跟踪：

```
Load report failed.
StackTrace:    at CrystalDecisions.ReportAppServer.ReportClientDocumentWrapper.EnsureDocumentIsOpened()
   at CrystalDecisions.CrystalReports.Engine.ReportDocument.Load(String filename, OpenReportMethod openMethod, Int16 parentJob)
   at CrystalDecisions.CrystalReports.Engine.ReportClass.Load(String reportName, OpenReportMethod openMethod, Int16 parentJob)
   at CrystalDecisions.CrystalReports.Engine.ReportDocument.EnsureLoadReport()
   at CrystalDecisions.CrystalReports.Engine.ReportDocument.SetDataSourceInternal(Object val, Type type)
   at CrystalDecisions.CrystalReports.Engine.ReportDocument.SetDataSource(DataSet dataSet) 
```

有谁知道为什么加载不出来？

架构：Windows Server 2008 (IIS 7)

调用报告的代码：

```
ReportClass ApprovalPage=new CustomerJobLabelApprovalMod();
ApprovalPage.SetDataSource(reportDataSet); 
```

CustomerJobLabelApprovalMod 的代码：

```
//------------------------------------------------------------------------------
// <autogenerated>
//     This code was generated by a tool.
//     Runtime Version: 1.1.4322.2407
//
//     Changes to this file may cause incorrect behavior and will be lost if 
//     the code is regenerated.
// </autogenerated>
//------------------------------------------------------------------------------

namespace LabelVault {
    using System;
    using System.ComponentModel;
    using CrystalDecisions.Shared;
    using CrystalDecisions.ReportSource;
    using CrystalDecisions.CrystalReports.Engine;

    public class CustomerJobLabelApprovalMod : ReportClass {

        public CustomerJobLabelApprovalMod() {}

        public override string ResourceName {
            get {
                return "CustomerJobLabelApprovalMod.rpt";
            }
            set {
                // Do nothing
            }
        }

        [Browsable(false)]
        [DesignerSerializationVisibilityAttribute(System.ComponentModel.DesignerSerializationVisibility.Hidden)]
        public CrystalDecisions.CrystalReports.Engine.Section Section1 {
            get {
                return this.ReportDefinition.Sections[0];
            }
        }

        [Browsable(false)]
        [DesignerSerializationVisibilityAttribute(System.ComponentModel.DesignerSerializationVisibility.Hidden)]
        public CrystalDecisions.CrystalReports.Engine.Section Section2 {
            get {
                return this.ReportDefinition.Sections[1];
            }
        }

        [Browsable(false)]
        [DesignerSerializationVisibilityAttribute(System.ComponentModel.DesignerSerializationVisibility.Hidden)]
        public CrystalDecisions.CrystalReports.Engine.Section Section3 {
            get {
                return this.ReportDefinition.Sections[2];
            }
        }

        [Browsable(false)]
        [DesignerSerializationVisibilityAttribute(System.ComponentModel.DesignerSerializationVisibility.Hidden)]
        public CrystalDecisions.CrystalReports.Engine.Section Section4 {
            get {
                return this.ReportDefinition.Sections[3];
            }
        }

        [Browsable(false)]
        [DesignerSerializationVisibilityAttribute(System.ComponentModel.DesignerSerializationVisibility.Hidden)]
        public CrystalDecisions.CrystalReports.Engine.Section Section5 {
            get {
                return this.ReportDefinition.Sections[4];
            }
        }
    }

    [System.Drawing.ToolboxBitmapAttribute(typeof(CrystalDecisions.Shared.ExportOptions), "report.bmp")]
    public class CachedCustomerJobLabelApprovalMod : Component, ICachedReport {

        public CachedCustomerJobLabelApprovalMod() {}

        public virtual bool IsCacheable {
            get {
                return true;
            }
            set {}
        }

        public virtual bool ShareDBLogonInfo {
            get {
                return false;
            }
            set {}
        }

        public virtual System.TimeSpan CacheTimeOut {
            get {
                return CachedReportConstants.DEFAULT_TIMEOUT;
            }
            set {}
        }

        public virtual CrystalDecisions.CrystalReports.Engine.ReportDocument CreateReport() {
            CustomerJobLabelApprovalMod rpt = new CustomerJobLabelApprovalMod();
            rpt.Site = this.Site;
            return rpt;
        }

        public virtual string GetCustomizedCacheKey(RequestContext request) {
            String key = null;
            // // The following is the code used to generate the default
            // // cache key for caching report jobs in the ASP.NET Cache.
            // // Feel free to modify this code to suit your needs.
            // // Returning key == null causes the default cache key to
            // // be generated.
            // 
            // key = RequestContext.BuildCompleteCacheKey(
            //     request,
            //     null,       // sReportFilename
            //     this.GetType(),
            //     this.ShareDBLogonInfo );
            return key;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T20:52:27.517

之后进行了很多艰苦的谷歌搜索......

我必须授予 NETWORK SERVICE 权限，`Windows\Temp`因为 Crystal Reports 获取该用户，而*不是*被模拟的用户（具有管理员权限）。因此，该目录而不是 IIS 目录是正在使用的目录。

这很令人沮丧，但现在可以了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T19:22:45.050

我似乎记得不久前做过这个，我在 web.config 中找到了一些对旧 Crystal Reports 内容的引用。

# c++ - 在多行文本编辑控件中自动显示垂直滚动条

> ID：562313
> 
> 赞同：0
> 
> 时间：2009-02-18T18:34:54.883
> 
> 标签：c++, windows-mobile, mfc

在 Windows 移动设备上，我有一个设置为只读的多行文本编辑控件，并在其显示生命周期内显示一些静态文本。我只想在实际有用时才显示垂直滚动条（即文本大于显示）。

由于两个原因，我无法轻易弄清楚文本是否太大而无法显示。

1.  没有显示水平滚动条，因此文本换行。
2.  在 windows mobile 下，用于计算将显示的文本大小的 win32 例程无法正常工作。他们返回一个不正确的矩形。

编辑控件必须在某个时刻告诉滚动条它的滚动范围是什么。我想知道如果不使用滚动条，我是否可以在此之间进入并隐藏滚动条。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T02:25:38.720

这就是我解决这个问题的方法。

首先：

*   它仅适用于编辑控件的只读模式（因为您不希望文本经常更改）。
*   我认为特定于 Windows Mobile MFC，大窗口可以更好地处理这个问题。
*   解决方案非常非常hacky。

解决方案：

*   我有一个绑定到控件的标准 CEdit。

    > CEdit m_Message；
    > 
    > DDX_Control(pDX, IDC_MESSAGE, m_Message);

*   在 InitDialog 和 OnSize 调用期间，打开滚动条的显示并设置计时器消息。

    > m_Message.ShowScrollBar(SB_VERT, TRUE);
    > 
    > SetTimer(DO_ADJUST_DISPLAY_STATE, 50, 0);

*   在定时器处理代码中，使用滚动信息来判断是否需要显示滚动条。

*   如果不显示，请关闭滚动条并强制重新显示窗口。

> ```
>  void CMessageDlg::OnTimer( UINT_PTR nIDEvent )
>   {
>     switch(nIDEvent)
>     {
>     case DO_ADJUST_DISPLAY_STATE:
>         KillTimer(nIDEvent);
>         // deselect all text
>         m_Message.SetSel(0, 0); 
> ```

```
 SCROLLINFO info;
        m_Message.GetScrollInfo(SB_VERT, &info);

        if(info.nPage > (UINT)info.nMax)
        {
            // need to re-display the non scroll bar version
            m_Message.ShowScrollBar(SB_VERT, FALSE);

            // I could not find any other way to force a redisplay 
            // correctly without display problems...

            // first move the window to a know invisible area
            // then wait (using a timer) for the window to move
            // then move the window back to it's original position     
            RECT rt;
            rt.left = 0;
            rt.right = 5;
            rt.top = 0;
            rt.bottom = 5;
            m_Message.MoveWindow(&rt);

            SetTimer(DO_REDISPLAY_MESSAGE, 50, 0);
        }
        break;

    case DO_REDISPLAY_MESSAGE:
        KillTimer(nIDEvent);
        // m_MessagePosition holds the original position
        // worked out dynamically during the WM_SIZE
        // processing
        m_Message.MoveWindow(&m_MessagePosition);
        break;
    }
} 
```

我希望这可以帮助其他可能有类似要求的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T19:40:00.420

> 我想知道如果不使用滚动条，我是否可以在此之间进入并隐藏滚动条。

我对此表示高度怀疑。但我敢打赌，您可以在创建文本框后的某个时间调用[SetScrollInfo ，并发送您自己的滚动参数。](http://msdn.microsoft.com/en-us/library/bb787595(VS.85).aspx)

编辑：错误的链接，我的错。[这](http://msdn.microsoft.com/en-us/library/aa932134.aspx)是 Windows CE 的

# vb6 - Vista 幻影目录

> ID：562337
> 
> 赞同：2
> 
> 时间：2009-02-18T18:40:52.637
> 
> 标签：vb6, windows-vista, inno-setup, txf

我们有一个程序，安装程序会检查配置文件是否存在，如果存在，它不会复制该文件（它假设用户已经修改了他们的配置文件并希望保留这些修改）。不幸的是，这是一个 pre-Vista 应用程序，它将配置文件保存在 Program Files 中。问题是，如果您在重新安装某些 API 时手动清除该目录，仍然认为那里有一个目录。例如 VB6，它的文件浏览对话框看到文件夹，但是资源管理器、cmd shell 等看不到文件夹。覆盖文件仍然会留下旧文件（对某些 API，但不是对资源管理器），除了“浏览文件”对话框中的表单外，无法删除旧文件。

这些 Phantom 文件夹是怎么回事，我们如何删除文件以便所有 API 看到相同的内容？也许它与[TxF](http://en.wikipedia.org/wiki/Transactional_NTFS#Transactional_NTFS)或用于搜索的索引器有关，但我们使用的安装程序 (InnoSetup) 和应用程序的一部分（用 VB6 编写的部分）都看到了旧版本的文件，而其他一切都看到了当前版本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T19:16:58.417

不知道我是否走在正确的轨道上，但是 Vista 是否为尝试写入它的应用程序虚拟化 %programfiles% 或以其他方式标记为“没有以正确的方式进行此操作”？（因此将它移动到文件系统的用户部分，而不告诉遗留应用程序 - 使它有点透明）..？

虚拟存储重定向文件存储在 %appdata% 中的某个位置 - 您还可以通过在别名位置检查资源管理器中的“兼容性文件”选项来查找位置。据我所知，您需要停止写入 %programfiles% 以摆脱这种行为。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-19T09:33:52.053

正如Oskar Duveborn 所说，您所看到的很可能是Vista 的虚拟化行为。

当机器启用了用户帐户控制 (UAC) 时，不允许标准用户和非提升程序写入 Programs 文件夹。`%AppData%\Local\VirtualStore`Windows 会以静默方式将文件重定向到（例如）的相应子文件夹`C:\Users\MyUser\AppData\Local\VirtualStore`。

如果您在资源管理器中浏览真实文件夹，您将看到“兼容性文件”工具栏按钮，您可以使用它来浏览虚拟商店。

请注意，这只是 Windows 的兼容性行为 - 您的程序应写入其自己的子文件夹`%AppData%`.

有关详细信息，请参阅[此 TechNet 杂志文章](http://technet.microsoft.com/en-us/magazine/2007.06.uac.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T18:46:05.480

您是指 AppData 文件夹（C:\Documents and Settings\UserName\AppData）吗？我不在我的 vista 机器上，但我认为这就是路径，而且卸载后它没有被擦除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T15:24:48.310

上面 Ant 的 TechNet 链接（已接受的答案）不再有效。新链接是：

[http://support.microsoft.com/kb/927387](http://support.microsoft.com/kb/927387) - Windows Vista 中的常见文件和注册表虚拟化问题

# visual-studio - Visual Studio 中每个文件类型的“查看空白”设置

> ID：562339
> 
> 赞同：3
> 
> 时间：2009-02-18T18:41:30.547
> 
> 标签：visual-studio

有没有办法在每个文件类型的基础上启用/禁用 Visual Studion 中的“查看空白”功能？我希望能够编辑带有可见空格的 python 文件，但不能编辑其他类型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T07:53:29.003

不幸的是，没有办法做到这一点。“查看空白”设置（可从“编辑|高级|查看空白”菜单选项中获得）存储在注册表中，这意味着该设置适用于 Visual Studio 的所有文件和所有会话。

下一个最好的事情是学习快捷键并根据需要打开和关闭该功能。对于 Visual Studio 2008，快捷键是 Ctrl+E、S。

# performance - 高流量网站

> ID：562344
> 
> 赞同：2
> 
> 时间：2009-02-18T18:43:01.760
> 
> 标签：performance

是什么让网站适合高流量？

它是否与硬件/基础设施有关，或者与如何编写软件有关，以 Java 为例，如果重要的话？

我想知道该软件是如何变化的，只是因为预计将有数十亿用户在该网站上，如果有的话。

到目前为止，我的理解是代码没有改变，但它部署在多个服务器上，在一个集群中，负载均衡器分配负载，所以实际上，在任何一个服务器/部署上，应用程序只是与任何其他标准应用程序/网站一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T18:44:42.457

硬件便宜。编程很昂贵。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T18:53:37.193

我强烈推荐阅读[Jeff Atwood 关于 Micro-Optimization 的博客](http://www.codinghorror.com/blog/archives/001218.html)。在之前的博客中，他谈到了这个站点是如何创建的以及他所进行的硬件升级（快速总结说，更好的硬件只有更快/更好的程度才能更好地执行），但站点的真正速度来自于良好的编程，这篇文章似乎应该很好地总结了您的一些站点编程问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T18:52:28.977

有一些编程技术可以确保您的代码可以同时处理多个视图/更新。如果您使用的是现有框架，那么大部分工作（希望）已经为您完成，但否则您会发现在一台服务器上每小时运行几百次的东西在您无法正常工作时'正在获得数十万次点击，您必须部署多台负载平衡机器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T18:53:14.450

嗯，这主要是硬件扩展的问题，但是关于扩展涉及的软件，有一些事情需要记住。例如，如果您在服务器场中，则需要使用会话管理服务器（通过 SQL Server 或通过状态服务器 - 这意味着您的会话变量需要可序列化）。

但是，从更大的角度来看，您需要做很多事情才能扩展到企业级别。例如，将数据库调用抽象到 DAL 变得尤为重要，因为您可能需要在大容量环境中采用中间件包。

# c# - 将结构传递给另一个类

> ID：562346
> 
> 赞同：-1
> 
> 时间：2009-02-18T18:43:16.737
> 
> 标签：c#

我在一个 C# 类中有一组结构，我想将该数据传递给另一个类。

这是我的代码

```
private struct strClassOfService
{
    public string COS;
    public string myValue;
}

private strClassOfService[] arrCOS = null;

//
// some code that loads arrCOS with data
//

//
// here is where i will instantiate another class and
// set the arrCOS so I can use it in the other class
// 
```

如果一切都失败了，我想我可以在另一个类中重新加载数据。但我很好奇是否有办法。到目前为止，我的尝试都失败了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T18:46:17.477

好吧，一方面，如果你打算将结构传递给另一个类，你应该公开结构定义（或至少是内部的）......一旦你这样做了，你可以使用各种方法（属性，方法调用等）将数据复制到您的其他类。

下面显示了两种技术（当然，您只需要使用一种......）

```
public class Foo1
{
    public struct Bar
    {
        string A;
        string B;
    }

    private Bar[] data;

    // Using a method
    public Bar[] ExportData()
    {
        return data;
    }

    // Using properties
    public Bar[] DataProperty
    {
        get { return data; }
    }
}

public class Foo2
{
    private Foo1.Bar[] data;

    // Using a method
    public void ImportData(Foo1 source)
    {
        this.data = source.ExportData();
    }

    // Using properties
    public Foo1.Bar[] DataProperty
    {
        get { return data; }
    }

    public void ReadProperty(Foo1 source)
    {
        this.DataProperty = source.DataProperty;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T18:56:24.567

如果您不想创建 struct `public`，则可以考虑`internal`改为声明它：这样它只能被同一程序集中的其他类访问。

# python - 我想在树中加载所有单元测试，可以完成吗？

> ID：562349
> 
> 赞同：0
> 
> 时间：2009-02-18T18:44:56.247
> 
> 标签：python, unit-testing

我有一个充满 Python 单元测试的分层文件夹。它们都是定义 TestCase 对象的可导入“.py”文件。该文件夹包含许多嵌套子目录中的数千个文件，并且是由其他人编写的。我没有更改它的权限，我只需要运行它。

我想生成一个包含文件夹中所有 TestCases 的 TestSuite 对象。有没有一种简单而优雅的方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T19:06:15.743

**鼻子**应用程序可能对您有用，可以直接使用，也可以显示如何实现它。

[http://code.google.com/p/python-nose/](http://code.google.com/p/python-nose/)似乎是主页。

基本上，您要做的是遍历源代码树 ( `os.walk`)，用于`imp.load_module` 加载模块，用于将模块`unittest.defaultTestLoader`中的测试加载到 a`TestSuite`中，然后以您需要的任何方式使用它。

或者至少这大约是我在自定义`TestRunner`实现中所做的 ( `bzr get http://code.liw.fi/coverage-test-runner/bzr/trunk`)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T19:32:06.663

查看 unittest.TestLoader ( [https://docs.python.org/library/unittest.html#loading-and-running-tests](https://docs.python.org/library/unittest.html#loading-and-running-tests) )

还有 os.walk ( [https://docs.python.org/library/os.html#files-and-directories](https://docs.python.org/library/os.html#files-and-directories) )

你应该能够使用 TestLoader 遍历你的包树来构建一个你可以运行的套件。

与此类似的东西。

```
runner = unittest.TextTestRunner()
superSuite = unittest.TestSuite()
for path, dirs, files in os.walk( 'path/to/tree' ):
    # if a CVS dir or whatever: continue
    for f in files:
        # if not a python file: continue
        suite= unittest.defaultTestLoader.loadTestsFromModule( os.path.join(path,f)
        superSuite .addTests(suite ) # OR runner.run( suite)
runner.run( superSuite ) 
```

您可以通过树简单地运行每个测试 ( `runner.run(suite)`) **，或者**您可以累积`superSuite`所有单独的套件并将整个质量作为单个测试运行 ( `runner.run( superSuite )`)。

您不需要两者都做，但我在上述（未经测试的）代码中包含了两组建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T19:43:18.743

[Python 库源代码](http://svn.python.org/view/python/trunk/Lib/test/)的测试目录显示了方法。[自述](http://svn.python.org/view/python/trunk/Lib/test/README?view=markup)文件描述了如何为库模块编写 Python 回归测试。

regrtest.py[模块](http://svn.python.org/view/python/trunk/Lib/test/regrtest.py?view=markup)以：

```
"""Regression test.

This will find all modules whose name is "test_*" in the test
directory, and run them. 
```

# c# - 不允许请求的注册表访问

> ID：562350
> 
> 赞同：50
> 
> 时间：2009-02-18T18:45:03.487
> 
> 标签：c#, .net, security, uac, registry

我正在编写一个调整实用程序来修改`HKEY_CLASSES_ROOT`.

在 Windows XP 等下一切正常。但我`Requested registry access is not allowed`在 Windows 7 下遇到错误。我猜是 Vista 和 2008。

我应该如何修改我的代码以添加 UAC 支持？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-02-18T18:54:57.597

`app.manifest`应该是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<asmv1:assembly manifestVersion="1.0" xmlns="urn:schemas-microsoft-com:asm.v1" xmlns:asmv1="urn:schemas-microsoft-com:asm.v1" xmlns:asmv2="urn:schemas-microsoft-com:asm.v2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
   <assemblyIdentity version="1.0.0.0" name="MyApplication.app" />
   <trustInfo xmlns="urn:schemas-microsoft-com:asm.v2">
      <security>
         <requestedPrivileges xmlns="urn:schemas-microsoft-com:asm.v3">
            <requestedExecutionLevel level="requireAdministrator" uiAccess="false" />
         </requestedPrivileges>
      </security>
   </trustInfo>
</asmv1:assembly> 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-18T18:50:53.770

除非您具有管理权限，否则您无法在 Vista 和更新版本的 Windows 中写入 HKCR（或 HKLM）配置单元。因此，您需要在运行实用程序之前以管理员身份登录，给它一个清单，说明它需要管理员级别（这将提示用户输入管理员登录信息），或者在非-管理员不应该玩。:-)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-18T18:59:39.567

如果您不需要整个应用程序的管理员权限，或者只需要很少的更改，您可以在新进程中进行更改并使用以下命令启动它：

```
Process.StartInfo.UseShellExecute = true;
Process.StartInfo.Verb = "runas"; 
```

它将以管理员身份运行该过程以对注册表执行您需要的任何操作，但以正常权限返回您的应用程序。这样它就不会在每次启动时都用 UAC 对话框提示用户。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-18T18:58:48.633

作为临时修复，用户可以右键单击该实用程序并选择“以管理员身份运行”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-27T05:02:04.523

我正在尝试`verb = "runas"`，但在尝试更新注册表值时仍然收到 UnauthorizedAccessException。原来这是由于未打开可写设置为true的子项。

```
Registry.OpenSubKey("KeyName", true); 
```

[无法写入注册表项，出现 UnauthorizedAccessException](https://stackoverflow.com/questions/4463706/net-windows-service-cannot-write-to-registry-key-unauthorizedaccessexceptio)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-10-17T08:01:07.717

此问题与向运行应用程序的用户帐户授予必要的授权有关。要阅读 Microsoft 记录的类似情况和正确解决方案的详细响应，请随时访问此帖子：[http ://rambletech.wordpress.com/2011/10/17/requested-registry-access-is-不允许/](http://rambletech.wordpress.com/2011/10/17/requested-registry-access-is-not-allowed/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-05T21:06:52.100

你可以做和 abatishchev 一样的事情，但没有 UAC

```
<assembly manifestVersion="1.0" xmlns="urn:schemas-microsoft-com:asm.v1">
<assemblyIdentity version="1.0.0.0" name="MyApplication.app"/>
 <trustInfo xmlns="urn:schemas-microsoft-com:asm.v2">
   <security>
    <requestedPrivileges xmlns="urn:schemas-microsoft-com:asm.v3">
    </requestedPrivileges>
    </security>
  </trustInfo>
</assembly> 
```

# oracle - 我应该在这里使用参考光标吗？

> ID：562361
> 
> 赞同：0
> 
> 时间：2009-02-18T18:48:02.980
> 
> 标签：oracle, plsql

我正在编写一个函数，它最终将使用几个可能的游标之一，为简单起见，我将在这里使用两个。在函数的主体中，我希望能够使用单个变量来描述使用哪个游标。我是为此使用参考光标还是其他什么？

在下面的示例中，我希望 FOR LOOP 根据 myChar 的值使用 C1 或 C2。因此，我不想在整个 FOR LOOP 周围放置一个 IF（或 CASE 语句），而是想让当前的 C1 成为一个变量。这是可行的吗？

CREATE OR REPLACE FUNCTION MY_FUNCTION (myChar IN CHAR) RETURN INTEGER AS

光标 C1 是从员工中选择 FIRST_NAME；

CURSO C2 是从员工中选择 LAST_NAMES；

开始

FOR X IN C1 LOOP -- DO STUFF END LOOP；返回 1；

结束我的功能；

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T19:29:43.083

是的，我没有对此进行测试，但它可能会起作用：

```
CREATE OR REPLACE FUNCTION MY_FUNCTION (myChar IN CHAR) RETURN INTEGER AS
  type r_cursor is REF CURSOR;
  c1 r_cursor;
begin
  IF myChar = "1" THEN
      open c1 for SELECT FIRST_NAME FROM EMPLOYEES;
  ELSE 
      open c1 for SELECT LAST_NAMES FROM EMPLOYEES;
  END IF;

  loop
      fetch c1 into c1recs;

      -- DO STUFF

      exit when c1%notfound;
  end loop;
  close c1;

  RETURN 1;
end; 
```

# c# - linq to entity继承查询问题

> ID：562367
> 
> 赞同：4
> 
> 时间：2009-02-18T18:51:01.083
> 
> 标签：c#, linq, entity-framework, ado.net, linq-to-entities

[我正在尝试对使用Table per Type](http://msdn.microsoft.com/en-us/data/cc765425.aspx)继承的表执行 linq to entity 查询。

我遇到的问题是我无法获取 Inhertied 表上的属性，而只能获取 Base Table 上的属性。

```
var qry = from i in _DB.BaseTable
where i is catalogueModel.InheritedTable
// Field Doesn't Exist
// && i.InheritedTableField == "Value"
select i; 
```

当我尝试将继承表转换为它的类型时......

```
var qry = from i in _DB.BaseTable
where i is catalogueModel.InheritedTable
&& (i as catalogueModel.InheritedTable).InheritedTableField  == "Value"
select i; 
```

...代码编译，但我得到一个很酷的错误，内容如下

> 工作表中只允许使用文本指针，不允许使用 text、ntext 或 image 列。查询处理器生成了一个查询计划，该计划需要工作表中的 text、ntext 或 image 列。

[我想我的问题是，当使用Table per Type](http://msdn.microsoft.com/en-us/data/cc765425.aspx)时，您应该如何访问 linq 中继承表的属性到实体？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-18T19:25:17.477

采用 。[类型](http://msdn.microsoft.com/en-us/library/bb301729.aspx)（）：

```
var qry = from i in _DB.BaseTable.OfType<InheritedTable>()
          select i.InheritedTableField; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-08T15:00:12.927

您也可以使用 IS

```
var qry = from i in _DB.BaseTable where i is InheritedTable select i.InheritedTableField; 
```

这里有一些其他的帮助（使用 Entity SQL）

```
var q = SELECT VALUE c FROM OFTYPE(yourcontext.yourbaseclass, yourmodel.yoursubclass) AS c

var q = SELECT VALUE c FROM yourcontext.yourbaseclass AS c where c IS NOT OF (yourmodel.yoursubclass) 
```

# unix - 在 UNIX /usr/bin/script 中继承别名

> ID：562370
> 
> 赞同：5
> 
> 时间：2009-02-18T18:52:08.290
> 
> 标签：unix, shell, environment-variables, scope

UNIX "/usr/bin/script" 命令将创建您的 shell 会话的运行脚本（有关更多信息，请参见“man script”）。

但是，当*在*脚本实例中时，它似乎忘记了父 shell 的环境变量、别名等。

以下示例演示了我定义的“ll”别名如何在“脚本”中被忽略：

```
zsh> mkdir temp
zsh> cd temp

zsh> alias "ll=ls -alF"

zsh> ll
total 24
drwxr-xr-x   2 me   mygroup    4096 Feb 18 13:32 ./
drwxr-xr-x  28 me   mygroup    8192 Feb 18 13:32 ../

zsh> script a.out
Script started, file is a.out 
```

> $ ll
> 
> ```
> zsh: command not found: ll 
> ```

```
$ exit
Script done, file is a.out

zsh> ll
total 32
drwxr-xr-x   2 me   mygroup    4096 Feb 18 13:32 ./
drwxr-xr-x  28 me   mygroup    8192 Feb 18 13:32 ../
-rw-r--r--   1 me   mygroup     182 Feb 18 13:32 a.out 
```

那么，如何让“脚本”进程从父 shell 继承环境设置？

[编辑：] 好的，环境变量*不会*被遗忘。只是别名。重新采购 .profile 或其他东西会起作用......但我怎样才能让它**自动**发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T18:54:41.513

别名不是环境变量。您可以获取您的`.profile`或您设置别名的任何位置。另请查看 $SHELL 环境变量。

该`script`命令并不十分复杂。复制并使其按您期望的方式工作并不难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T19:37:12.690

当我在 bash 下启动它时它工作正常。也许你的 zsh 配置中有一些东西把它搞砸了，或者它没有获取你的 zsh 的启动文件。你可以试试： script -c zsh

这可能会迫使它启动一个新的 zsh shell 并让它获取你的 zsh 配置文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T19:01:18.673

正如 Jon Ericson 所指出的，别名*不是*环境的一部分。您将在脚本中找到所有环境。

要在脚本中获取所有别名，您可以将它们保存在一个文件中，然后重新加载它们：

```
    $ 别名 myls="ls -lCF"
    $ 别名 -L >/tmp/alias.zsh
    $脚本
    $ . /tmp/alias.zsh
    $ 迈尔斯

```

如果您将别名放在`.zshrc`主目录中调用的文件中，它将自动加载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-28T19:55:12.997

对于 zsh 别名的特定情况……如果您将别名放在 .zshenv（而不是 .zshrc）中，则应自动代表您执行。

我知道这是一个旧线程，但有时人们会阅读旧线程；>

```
alias foo='print FOO'
[khb@vm]~% foo
FOO
[khb@vm]~% script
Script started, file is typescript
[khb@vm]~% foo
zsh: command not found: foo
zsh: use 'exit' to exit.
[khb@vm]~% exit
Script done, file is typescript
[khb@vm]~% mv .bork .zshenv
[khb@vm]~% foo
FOO
[khb@vm]~% script
Script started, file is typescript
[khb@vm]~% foo
FOO
[khb@vm]~% 
 zsh: use 'exit' to exit.
Script done, file is typescript
[khb@vm]~% 
```

# uniqueidentifier - 在 VFP 中创建唯一 ID

> ID：562373
> 
> 赞同：4
> 
> 时间：2009-02-18T18:52:43.593
> 
> 标签：uniqueidentifier, visual-foxpro, foxpro

我需要根据邮寄信息在 VFP 中创建唯一的记录 ID：zip5、地址、姓氏、名字。创建后，关系表将使用唯一 ID 加载到 SQL Server 7 中。有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T19:12:27.493

[您可以在 FoxPro Wiki](http://fox.wikis.com/wc.dll?Wiki~GUID~VFP)上使用 GUID： GUID 条目。

这里有一些[例子](http://fox.wikis.com/wc.dll?Wiki~GUIDGenerationCode)。

使用 WSH 最简单的一种...

```
 * VFP 7+
   oGUID = CreateObject("scriptlet.typelib") 
   cGUID = Strextract(oGUID.GUID, "{", "}" )

   * Other VFP
   oGUID = CreateObject("scriptlet.typelib")
   cGUID = substr( oGUID.GUID, 2, 36 ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T01:23:42.640

VFP 确实支持唯一 ID - 因为它具有[主索引](http://msdn.microsoft.com/en-us/library/f9w73shy(VS.80).aspx#foconvisualfoxproindextypesanchor1)（可以基于多个字段 - 但请确保键长度是固定的，因此如果您的 VFP 表使用 varchars 您将需要填充字段）和一个表也可以有[候选索引](http://msdn.microsoft.com/en-us/library/f9w73shy(VS.80).aspx#foconvisualfoxproindextypesanchor2)（索引字段必须是唯一的，就像主键一样，但每个表可以有多个候选索引）。

这些中的任何一个都将在您的字段中强制执行唯一性，但是根据 zip5、地址、姓氏和名字生成主键效率低下。GUID 的建议会很好地工作，或者如果您有 VFP8 或更高版本，您可以使用[Autoinc 列](http://msdn.microsoft.com/en-us/library/aa976850(VS.71).aspx)，这类似于 SQL Server 中的 Identity 列。

顺便说一句，唯一索引[仅用于向后兼容](http://msdn.microsoft.com/en-us/library/f9w73shy(VS.80).aspx#foconvisualfoxproindextypesanchor5)..

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-02-19T07:03:19.257

为此，我创建了自己的函数来返回唯一标识符。当我有一条新记录时，我只需扫描数据库并让函数将数据库中的唯一标识符字段（我称之为我的 UID）替换为新的 uid（如果记录没有）。

```
FUNCTION UIDgenerator()
   LOCAL c_UID
   LOCAL c_dump

   c_UID = STRTRAN(SYS(2015),"_","") + [-]

   c_dump = STRTRAN(SYS(2015),"_","")
   c_dump = STRTRAN(SYS(2015),"_","")
   c_dump = STRTRAN(SYS(2015),"_","")

   c_UID = c_UID + STRTRAN(SYS(2015),"_","")

   RETURN c_UID

   endfunction() &&UIDGenerator 
```

您不必执行 c_dump 3 次，但我希望标识符之间的距离更远一些。

# c# - 如何在没有 UAC 确认的情况下更改文件关联？

> ID：562386
> 
> 赞同：1
> 
> 时间：2009-02-18T18:58:44.000
> 
> 标签：c#, .net, uac, file-association

当我在 .NET 应用程序中处理文件关联时，我还没有找到一种方法来设置它，而 UAC 不会弹出确认对话框。

今天，当我打开 uTorrent 并查找文件关联时，我发现您可以启用（写入注册表）而无需 UAC 的任何确认。

这怎么可能？uTorrent 未以管理员身份运行。

**编辑：**

好吧，我刚刚使用[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx) (Sysinternals) 发现 uTorrent.exe 所做的是创建一些密钥（**uTorrent**和**.torrent**），但在**HKCU** ( `HKEY_CURRENT_USER`) 中，而不是在`HKEY_CLASSES_ROOT`. 无论如何，我也有这些键`HKEY_CLASSES_ROOT`......也许安装程序创建了这些。没有把握。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T20:21:20.277

请参阅[MSDN 中](http://msdn.microsoft.com/en-us/library/bb530198.aspx)有关正在虚拟化的全局注册表的这篇文章，以便更改仅对您的用户配置文件有效。

# php - 线性数组，节点随机链接到数组中的其他节点，最短路径

> ID：562391
> 
> 赞同：0
> 
> 时间：2009-02-18T19:01:34.787
> 
> 标签：php, delphi, shortest-path

信息：我有一个 100 个节点的数组，[0 .. 99]。每个节点可以有任意数量的链接节点：

eg1, 0 链接到 5, 10, 15, 20\. eg2, 1 链接到 30, 40, 50\. eg3 等等。

所有 100 个节点都至少有一个链接节点，节点不知道谁链接到它们。

问题：如果提供了 START 和 END，我如何找到最短的链接路径。

例如。START=5，END=80，链接路径（示例）：[5]->10->24->36->[80]？

我正在使用 Pascal 和/或 PHP，但了解我在寻找什么 [代码也有帮助]。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T19:07:34.773

大量阅读/算法： [最短路径问题](http://en.wikipedia.org/wiki/Shortest_path_problem)。您实际上只是让每条边（如您所说的“链接”）具有相同的权重。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T19:10:45.983

从 Start 节点开始执行广度优先遍历，并在找到结束节点后立即退出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T19:26:00.783

这有循环吗？即它是一个 DAG 吗？

如果没有循环：

```
 List<Node> GetShortestPath(Node startNode, Node endNode)
   {   
       //If this is the node you are looking for...
       if (startNode.ReferenceEquals(endNode))
       {
           //return a list with just the end node
           List<Nodes> result = new List<Nodes>();
           result.Add(endNode);            
           return result;
       }

       List<Node> bestPath = null;

       foreach(Node child in startNode.Children)
       {             
          //get the shortest path from this child
          List<Node> childPath = GetShortestPath(child, endNode);
          if (childPath != null &&
             ( bestPath == null || childPath.Count < bestPath.Count))
          { 
              bestPath = childPath;
          }
       }

       bestPath.Insert(0, startNode);
       return bestPath;
    } 
```

[编辑：添加了循环示例]如果可以有循环：

```
 List<Node> GetShortestPath(Node startNode, Node endNode)
   {
        List<Node> nodesToExclude = new List<Node>();
        return GetShortestPath(startNode, endNOde, nodesToExclude);
   }

   List<Node> GetShortestPath(Node startNode, Node endNode, List<Node> nodesToExclude)
   {   
       nodesToExclude.Add(startNode);

       List<Node> bestPath = null;

       //If this is end node...
       if (startNode.ReferenceEquals(endNode))
       {
           //return a list with just the child node
           List<Nodes> result = new List<Nodes>();
           result.Add(endNode);            
           return result;
       }

       foreach(Node child in startNode.Children)
       {
          if (!nodesToExclude.Contains(child))
          {
              //get the shortest path from this child
              List<Node> childPath = GetShortestPath(child, endNode);
              if (childPath != null &&
                 ( bestPath == null || childPath.Count < bestPath.Count))
              { 
                  bestPath = childPath;
              }
          }
       }

       nodesToExclude.Remove(startNode);
       bestPath.Insert(0, child);

       return bestPath;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T19:35:08.250

两种结构：集合和列表。

在集合中，您存储已经访问过的节点。这会阻止您遵循周期。

该列表包含以下对象：（1）一个节点，以及（2）一个指向找到它的节点的指针。

从起始节点开始，将其添加到集合中，将其添加到具有空反向引用的列表中，然后将它可以到达的所有节点添加到具有反向引用到列表中索引 0 的列表（起始节点） .

然后对于列表中的每个元素，直到到达末尾，执行以下操作：

1.  如果它在集合中已经跳过它（您已经访问过它）并移动到列表中的下一个项目。
2.  否则，将其添加到集合中，并将它可以到达的所有节点添加到列表中，并将您正在“查看”的索引的反向引用添加到列表的末尾。然后转到列表中的下一个索引并重复。

如果您在任何时候到达结束节点（最好将它添加到列表中 - 而不是在列表中访问它），通过对起始节点的反向引用进行追溯并反转路径。

例子：

给定节点 0 到 3，其中
node0 --> node1
node0 --> node2
node1 --> node2
node2 --> node3
and node0 为 START 而 node3 为 END

设置 = {}
列表 = []

第 1 步 - 添加开始：

SET = {node0}
列表 = [[node0, null]]

第 2 步 - 在列表的索引 0 处 - 添加可达节点：

SET = {node0, node1, node2}
LIST = [ **[node0, null]** , [node1, 0], [node2, 0]]

第 3 步 - 在 LIST 的索引 1 - 添加可达节点：

node2 已经在 SET 中。跳过将可达节点添加到 LIST。
SET = {node0, node1, node2}
LIST = [[node0, null], **[node1, 0]** , [node2, 0]]

第 4 步 - 在 LIST 的索引 2 - 添加可达节点：

SET = {node0, node1, node2, node3}
LIST = [[node0, null], [node1, 0], **[node2, 0]** , [node3, 2]]

第 5 步 - 到达 END，现在回溯：

插入到 LIST 中的 END 节点（node3）具有对列表中索引 2 的反向引用，即 node2。这对列表中的索引 0 有一个反向引用，即 node0 (START)。将其反转，您将得到 node0 --> node2 --> node3 的最短路径。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T19:09:07.813

这是一棵树/图还是一片森林？如果是森林，则路径可能并不总是被定义。如果这是一个树/图，请尝试使用广度优先搜索。

可以这样想：比如说，你正在执行一项秘密任务，在附近寻找可爱的小鸡。您从自己的房子开始，并将其标记为开始。你接下来会去敲你最近的邻居，对吧？所以，我们将这样做——将所有连接到队列的节点推入队列中。现在，对该队列中的所有节点重复邻居搜索。并继续这样做，直到你得到你的女孩，错误，结束。

# c# - 在 C# 中获取窗口的句柄

> ID：562392
> 
> 赞同：24
> 
> 时间：2009-02-18T19:02:21.993
> 
> 标签：c#, wpf, windows

我声明了以下类：

```
public partial class MainWindow : Window 
```

一旦窗口有一个，我需要获取窗口的实际句柄。我该怎么做，我应该把查询功能放在哪里。

到目前为止我尝试的是：

```
IntPtr hwnd = new WindowInteropHelper(this).Handle; 
```

但是我得到的句柄是0，这可能是因为它是在OnInitialized中种植的——也许那个阶段窗口还没有准备好。而且，是的 - 它是通过 WPF 连接的，感谢您指出！

谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-18T19:23:50.397

在该`OnInitialized`方法中，尚未创建**句柄。**但你在正确的轨道上。如果您将调用放在**句柄**将被创建并且它应该返回正确的**句柄**`Loaded`的事件中。

 ***** * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-19T09:07:02.493

最早能​​拿到句柄的地方是 OnSourceInitialized

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T19:17:05.873

```
 [DllImport("user32.dll", EntryPoint = "FindWindowEx")]
        public static extern int FindWindowEx(int hwndParent, int hwndEnfant, int lpClasse, string lpTitre);

int hwnd = FindWindowEx(0, 0, 0, title);//where title is the windowtitle

                //verification of the window
                if (hwnd == 0)
                {
                    throw new Exception("Window not found");
                } 
```

# css - E#myid vs. #myid CSS Selectors

> ID：562394
> 
> 赞同：3
> 
> 时间：2009-02-18T19:04:07.090
> 
> 标签：css, css-selectors

I'm curious what the difference is b/w E#myid vs. #myid (E is any element) given that there can only be one element with #myid on a page?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T19:09:05.347

It must be a bug/mistake of you that `#myid` has no effect on the `input` element. It works fine for me.

* * *

As you changed your question:

Image you have two different documents that both use the same stylesheet. In one document a `DIV` element has the ID “foo” and in the other document a `SPAN` element has the same ID. You can then use the following stylesheet to style both element different:

```
#foo {
    color: #FFF;
}
div#foo {
    background-color: #F00;
}
span#foo {
    background-color: #0F0;
} 
```

Both elements would then have the same font color but a different background color.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-18T19:19:45.383

They have different specificity.

[http://www.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/](http://www.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T13:54:39.807

The two selectors have different specificity. Rules given in a more specific selector will override rules given in a less specific one.

The specificity rules are really easy. Whenever there is a conflict (two or more rules setting different values on the same element), the following rules are consulted *in order*:

1) What 'space' does the rule live in? A rule in a higher 'space' automatically wins against rules in lower spaces: a) Set by the user's stylesheet, with !important b) Set by the author's stylesheet, with !important c) Set by the browser's stylesheet, with !important d) Set in a style="" rule e) Set by the user's stylesheet, without !important f) Set by the author's stylesheet, without !important g) Set by the browser's stylesheet, without !important

2) How many #ids are in the selector? Selectors with more #ids automatically win against selectors with less (assuming they tied in rule #1).

3) How many .classes or :pseudoclasses are in the selector? Selectors with more .classes automatically win against selectors with less (assuming they tied in the previous rules).

4) How many plain elements are in the selector? Again, more is better.

5) Finally, how far down in the document is the rule? Later rules override earlier rules, if they are tied on all previous categories. This applies within a document (at the bottom of your CSS file vs at the top) and between documents (any rules in the second <link>ed css file are 'later' than the rules in your first <link>ed css file).

Understanding specificity can help you write simpler CSS. I almost always start my selectors with the closest #id that I can, because it simultaneously limits the spread of the selector to exactly the elements that I want, *and* automatically overrides any 'global' css rules I may have set in the document.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T19:16:24.813

The difference is that in different pages you could have different elements using that ID. Why you would do that, is beyond me, but it *could* be needed for (just an example) a div on some pages taking the same attributes as a span on other pages.

Different browsers will give you different and strange results on non specified corner cases. Some browsers allow for multiple elements sharing the same id, others don't. It even changes with different versions of the same browser. Without knowing wich browser you are using, it's harder to replicate the bug, but I recommend you to test your css on several browsers.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-18T19:21:32.370

Along with the other folks points about ID not necesarily being unique on a page...

It is possible to have one ID applied to either of N different elements (eg <UL Id=MyList> or <OL Id=MyList>). Then you could have different bits of javascript to handle the various elements (ie. a bit of code to handle UL, a different bit of code to handle OL).

Not saying whether or not that's would be a good design... just saying that it's possible.

Edit: what I mean is that the server side could generate a page with *either* an <OL> or a >UL>... not both at one time. Think dynamic web page. And again... I'm not saying one way or another if this is a good design... just that it IS POSSIBLE.

# build-automation - 软件构建工具包（来自 Google）有用吗？

> ID：562395
> 
> 赞同：2
> 
> 时间：2009-02-18T19:04:13.207
> 
> 标签：build-automation

有人在使用Google的[软件构建工具包吗？](http://google-opensource.blogspot.com/2009/02/software-construction-toolkit-released.html)是否足以替换`make`和/或`ant`？它的众多广告平台（java、.net、C++）有多好？

您对此有何看法？

[实际上这是 Google 在Scons](http://www.scons.org/)之上的修改。

编辑：还没有答案！所以，没人用吗？我会尽快发布我的印象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-28T18:37:27.760

我使用 Scons 有一段时间，发现它有几个问题。因此我切换回 Autotools，它本身就是一个 PITA。

目前我推荐 Waf：[http ://code.google.com/p/waf/](http://code.google.com/p/waf/)

这就是我能说的，我自己没有使用谷歌的东西。但是，如果您与单独的“制作”（而不是 Autotools）进行比较，单独的 Scons 是优越的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T00:49:40.903

我的印象是它是只为谷歌项目（chrome？）维护的近亲工具包。（就像 Open Office 的 dmake 一样）。

# java - 在运行时配置“管道”

> ID：562404
> 
> 赞同：3
> 
> 时间：2009-02-18T19:06:21.953
> 
> 标签：java, design-patterns

这是Java中的一种设计模式问题。

我正在设计一个 java .jar 文件来充当管理和处理某种形式的数据的框架。我希望最终用户能够以某种方式在某些约束内指定“管道”配置。这些部分是生产者和/或消费者，我知道如何实现它们，但是这些连接让我感到困惑……这是一个与我的应用程序类似的废话示例。

假设我已经实现了这些元素：

*   `AppleTree` => 生产苹果
*   `ApplePieMaker`=> 吃苹果，生产苹果派
*   `ApplePress`=> 吃苹果，生产苹果酒
*   `AppleSave`=> 将苹果、苹果派或苹果酒存储到文件中
*   `AppleLoad`=> 从由`AppleSave`
*   `ApplePieMonitor`=> 在屏幕上以 GUI 格式显示苹果派，因为它们是生产的

现在我希望用户能够指定以下内容：

*   `AppleTree | ApplePress | AppleSave cider1.sav`（生产苹果，制作苹果酒，保存到文件中）
*   `AppleTree | AppleSave apple1.sav`（生产苹果，保存到文件中）
*   `AppleLoad apple1.sav | ApplePieMaker | ApplePieMonitor`（取出保存的苹果，将它们做成馅饼，在 GUI 的屏幕上显示结果）
*   （不知道如何说明这一点，但可以指定如下）

    AppleTree tree1，ApplePieMaker piemaker1 < tree1，AppleSave apples.sav < tree1，AppleSave @select(*.sav) < piemaker1，ApplePress press1 < tree1，AppleSave cider.sav < press1，ApplePieMonitor piemon1 < piemaker1

（生产苹果，将它们制成馅饼和苹果酒，将苹果、馅饼和苹果酒保存到单独的文件中，馅饼将转到用户在运行时选择的文件，其他馅饼将转到预先确定的文件，并在GUI 中的屏幕）

所以我对如何构建配置文件有一个粗略的想法：即将事物构造成最多具有 1 个输入和最多 1 个输出的元素，然后为每个实例化的元素命名，如果它有输入，指定提供输入的元素的名称。

我不清楚的是如何在程序运行时耦合程序的元素。也许要走的路是拥有许多接口，比如`AppleConsumer`，`ApplePieConsumer`等，所以 an`ApplePieMaker`将实现`AppleConsumer`接口（包括方法`consumeApple()`），并且 an`AppleTree`将实现一个`AppleProducer`可以在启动时注册消费者的接口，以便每次`AppleTree`产生一个苹果，它有一个消费者列表并调用`consumeApple()`每个消费者，然后它会做正确的事情，而`AppleTree`不必知道他们对苹果做了什么......

有什么建议么？这种东西有名字吗？我在设计模式方面并不是很有经验。

编辑：我的最终用户不知道也不关心 Java。他们只需要能够设置一个配置文件（我试图使其尽可能简单，以便我可以给他们一些很好的例子）并运行我的程序，该程序将读取配置文件，构造元素，挂钩它们一起，然后走。所有的元素都在我的掌控之中，我不需要支持插件，所以我不必是超级通用的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T19:32:58.677

我前段时间遇到过这个问题，在 Java 中明确指定有点困难，因为我的输入和输出可能是复数。但是，当您确定只有一个输入和输出时（因为文件是一种特定类型的输出，对吗？），您可以尝试使用检查泛型。

处理步骤实现（我称之为*过滤器*）有两个检查类型参数：输入和输出（例如，假设它们都扩展了一个公共接口，并且对于您在系统中注入的每个新类型，您都将继承该接口） .

```
public interface Filter<Input extends Type, Output extends Type> {

  public Class<Input> getInputType();

  public Class<Output> getOutputType();

  public void process(Input in, Output out);

} 
```

过滤器链只是一个（兼容）`Filter`s的数组。通过兼容，我打算对于每个过滤器，其*Output与其跟随器**Input*的类型相同，第一个过滤器的*Input*与您的整体输入类型匹配，最后一个过滤器的*Output*与预期的结果类型匹配。这在实践中很容易验证，因为我们使用的是检查泛型。

因此，过滤器链是另一个（复合）过滤器。应在构造函数中检查复合过滤器的兼容性，并在最终的复合数组中进行检查。没有准确的方法来表达具有泛型的构造函数的参数的“链接”属性（兼容性），因此您将不得不使用裸类型来执行此操作，这有点不干净。

另一种绕过这个限制的方法是，以更繁琐的编写为代价，改变过滤器的定义，如下所示：

```
public interface Filter<Input extends Type, Output extends Type> {

   public Class<Input> getInputType();

   public Class<Output> getOutputType();

   public Output out process(Input in);

} 
```

然后，我们必须将复合过滤器定义为过滤器对的叠置，因此定义为：

```
public class CompoundFilter<Input extends Type, Output extends Type>
       implements Filter<Input extends Type, Output extends Type> {

  private final Filter<Input extends Type, ? extends Type> l;
  private final Filter<Input extends Type, ? extends Type> r;

  public <Median extends Type> CompoundFilter(
         Filter<Input, Median> r,
         Filter<Median, Output> l
      ) {
      this.l = l;
      this.r = r;
  }

  @SuppressWarnings("unchecked")
  public Output out process(Input in) {
      // Compute l(r(in)) = (l o r) (in)
      return ((Output<Input,Type>) l).process(r.process(in));
  }
} 
```

因此，*编写*过滤器只是一个写作问题：

```
Filter<A,B> f1 = new FilterImpl<A,B>;;
Filter<B,C> f2 = new FilterImpl<B,C>;
// this is mathematically f2 o f1
Filter<A,C> comp = new CompoundFilter<A,C>(f1,f2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T23:25:13.827

我忍不住，我必须为此锻炼一些东西。

所以就在这里。

你已经有了关于苹果生产者/消费者的想法，所以我会这样做。

创建三个接口，实现如下：

*   产品 - Apple、AppleCider、ApplePie、
*   生产者 - AppleTree、ApplePress、ApplePieMaker、AppleLoad、
*   消费者 - ApplePress（消费苹果）、ApplePieMaker（消费苹果）、AppleMonitor、AppleSave。

这个想法是有一个通用产品，由通用生产者生产并由通用消费者消费。

一旦你有了它，你就可以按照你描述的方式创建配置文件，并解析它为每个元素创建一个新实例。

```
 element1 | element2 | element3 <parameters> | element 4 
```

在映射中，您创建元素名称并将其映射到将创建新实例的类。

比方说

```
map.put( "AppleTree", YouAppleTreeClass.class ); 
```

因此，每次读取配置中的元素时，都会创建实例：

```
for( String item: line )  { 
    Object o = map.get( item ).newInstance();
} 
```

最后，您必须验证配置的结构，但基本上它可能是这样的：

*   第一个元素应该是生产者
*   最后应该是消费者
*   任何中间人都应该是生产者-消费者
*   您可以解析所需的参数（例如用于保存数据的文件）

一旦创建并链接了所有对象，就可以开始生产了。

有些事情你必须锻炼，但它们很容易：

1.  参数传递（将保存/加载它们的文件）
2.  不同配置中的对象重用（始终使用相同的 AppleTree）

最后说明：以下代码只是一个草稿，您可能真的考虑使用依赖注入器来完成这项工作，但当然这需要您一点时间来学习。

配置解析应该手动进行，因为您使用的格式对于最终用户来说是唯一的，并且应该非常简单。您仍然可以在 jar 中提供尽可能多的复杂性（使用您需要的任意数量的框架）。

您还可以查看以下设计模式：

*   [合成的](http://en.wikipedia.org/wiki/Composite_pattern)
*   [观察者](http://en.wikipedia.org/wiki/Observer_pattern)
*   [口译员](http://en.wikipedia.org/wiki/Interpreter_Pattern)

下面的实现，是这三个的一种怪物（我没有编译它，只是抛出一些代码来展示这个想法的样子）

我希望这有帮助。

```
/**
 * Anything. An apple, cider, pie, whatever.
 */
interface Product{}

// The kinds of products. 
class Apple     implements Product{}
class ApplePies implements Product{}
class AppleCider implements Product{}

/**
 * This indicates the class will do something.
 **/
interface Producer { 
    // adds a consumer to the list.
    public void addConsumer( Consumer c );
    // removes the consumer from the list.
    public void removeConsumer( Consumer c );
    // let know eveytone a product has been created.
    public void notifyProductCreation( Product someProduct );
    // You're producer? Produce then... 
    public void startProduction();
}

// To avoid copy/paste all around
class AbstractProducer implements Producer { 
    private List<Consumer> consumers = new ArrayList<Consumer>();
    // adds a consumer to the list.
    public void addConsumer( Consumer c ) {
        consumers.add( c );
    }
    // removes the consumer from the list.
    public void removeConsumer( Consumer c ) {
        consumers.remove( c );
    }
    public void notifyProductCreation( Product someProduct ) { 
        for( Consumer c : list ) { 
            c.productCreated( someProduct );
        }
    }
}

interface Consumer { 
    // Callback to know a product was created
    public void productCreated( Product p );
}

class AppleTree extends AbstractProducer { 
    public void startProduction() { 
        // do something with earh, sun, water.. 
        // and from time to time:
        Product ofThisNewApple = new Apple();
        notifyProductCreation( ofThisNewApple );
    }

}    
class ApplePieMaker extends AbstractProducer implements Consumer { 

    // Ok, a product was created, but
    // is it the product I care?
    // check first and consume after.
    public void productCreated( Product p ){
        // Is this the kind of product I can handle..
        // well do handle
        if( p instanceof Apple ) {
            /// start producing pies..
        }
    }
    public void startProduction() { 
        // collect the needed number of apples and then...
        Product ofPie = new ApplePie();
        notifyProductCreation( ofPie );
    }

}
class ApplePress extends AbstractProducer implements Consumer { 
    // Yeap, something gots produced.
    // Just handle if it is an apple
    public void productCreated( Product p ) { 
        if( p instanceof Apple ) { 
            // start producing cider
        }
    }

    public void startProduction() { 
        // collect the needed number of apples and then...
        Product ofCiderBottle = new AppleCider();
        notifyProductCreation( ofCiderBottle );
    }

}
class AppleSave implements Consumer { 
    public void productCreated( Product p ) { 
        file.append( p );// any one will do.
    }
}

class AppleLoad extends AbstractProducer { 
    public void startProduction() { 
        readFromFile();
    }
    private readFromFile() { 
        for( Product p : file ) { 
            notifyProductCreation( p );  
        }
    }
}

class Main { 
    public static void main( String [] args ) { 
        Configuration conf = new Configuration();
        List<Producer> producers conf.read();
        for( Producer p : producers ) { 
            // fasten your seat belts.... 
            p.startProduction();
        }
    }
}

/// Ahhh, pretty ugly code below this line.
// the idea is:
// Read the configuration file
// for each line split in the "|"
// for each element create a new instance
// and chain it with the next.
// producer | consumer | etc...  
// Becomes....
// new Producer().addConsumer( new Consumer() );
// Return the list of create producers.  
class Configuration { 
    List<Producer> producers
    // read the file 
    // create the instances
    // let them run.
    public List<Producer> read() { 
        File file = new File(....
        // The format is: 
        // producer | consumer-producer <params> | consumer 
        String line = uniqueLineFrom( file );

        String [] parts = line.split("|");

        if( parts.length == 1 ) { 
            System.err.println("Invalid configuration. use element | element | etc. Only one element was....");
            System.exit( 1 );
        }

        int length = parts.length;
        for( int i = 0 ; i < parts.length ; i++ ) { 
            Object theInstance = implementationMap.get( parts[i] ).newInstance();
            validatePosition( i, length, theInstance , parts[i] );
        }

        List<Producer> producers = new ArrayList<Producer>();
        for( int i = 0 ; i < parts.length ; i++ ) { 
            Object theInstance = getInstance( parts[i] );
            if( not( isLast( i, length ) && isProducer( theInstance ) ) { 
                // the next is its consumer
                Producer producer = ( Producer ) theInstance;
                producer.addConsumer( ( Consumer )  getInstance( parts[i+1] ));
                producers.add( producer );
            }
        }
        return producers;

    }
    // creates a new instance from the implementation map.
    private Object getInstance( String key ) { 
        return implementationMap.get( part[i] ).newInstance();        
    }
    // validates if an element at the given position is valid or not.
    // if not, prints the message and exit.
    // the first element most be a producer
    // the last one a consumer 
    // all the middle elements producer-consumer
    // 
    private void validatePosition( int i, int length, Object theInstance, String element  ) { 
        if( isFirst( i ) && not(isProducer(( theInstance ) ))) {  
            System.err.println( "Invalid configuration: " + element + " most be a producer ( either Ap...");
            System.exit( 2 );
        } else if ( isLast( i, length ) && not( isConsumer( theInstance  ))) { 
            System.err.println( "Invalid configuration: " + element + " most be a consumer ( either Ap...");
            System.exit( 3 );
        } else if ( isMiddleAndInvalid( i, length , instance ) ) { 
            System.err.println( "Invalid configuration: " + element + " most be a producer-consumer ( either Ap...");
            System.exit( 4 );
        }
    }
    private static Map<String,Class> implementationMap = new HashMap<String,Class>() static { 
        implementationMap.put( "AppleTree", AppleTree.class );
        implementationMap.put( "ApplePieMaker ", ApplePieMaker .class );
        implementationMap.put( "ApplePress", ApplePress.class );
        implementationMap.put( "AppleSave", AppleSave.class );
        implementationMap.put( "AppleLoad", AppleLoad.class );
        implementationMap.put( "ApplePieMonitor", ApplePieMonitor.class );
    };

    // Utility methods to read better ( hopefully ) the statements 
    // If you could read the validations above you may ignore these functions.

    private boolean not( boolean value ) { 
        return !value;
    }
    private boolean isFirst( int i  ) { 
        return i == 0;
    }
    private boolean isLast( int i, int l ) { 
        return i == l -1 ;
    }
    private boolean isProducer( Object o ) { 
        return o instanceof Producer;
    }
    private boolean isConsumer( Object o ) { 
        return o instanceof Consumer;
    }
    private boolean isMiddleAndInvalid( int index, int length, Object instance ) { 
        return not( isFirst( index ) ) && not( isLast( index, length ) ) && not( isProducer( instance ) && isConsumer( instance ));
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T19:15:51.353

我相信您正在尝试做的事情可以在 Spring 框架内完成。它使用依赖注入来表示“为了创建 XI 需要 Y，所以找到产生 Y 的东西，看看你需要什么来创建它”。

我可能错了，但我建议你看看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T19:21:42.010

试试 Java [Beanshell](http://www.beanshell.org/)。

> BeanShell 是一个小型、免费、可嵌入的 Java 源解释器，具有对象脚本语言功能，用 Java 编写。BeanShell 动态执行标准 Java 语法，并使用常见的脚本便利性对其进行扩展，例如松散类型、命令和方法闭包，如 Perl 和 JavaScript 中的那些。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T21:17:31.637

您将需要某种注册表，生产者可以在其中注册（嗨，我是一棵苹果树，我生产苹果），然后消费者可以查找曾经生产过苹果的人。这也可以在消费者注册兴趣和生产者查找的情况下反向完成。我使用 JMX 做了类似的事情，其中​​一个对象可以向 JMX 服务器查询产生某种类型消息的对象，然后向该对象注册（发布/订阅）。我现在正在移植该应用程序以使用具有类似功能的 OSGi

# data-structures - 你如何处理“一个人的许多名字”？

> ID：562406
> 
> 赞同：6
> 
> 时间：2009-02-18T19:06:41.517
> 
> 标签：data-structures

在创建任何信息系统时，我遇到的最常见问题之一是人们有这么多不同的名字。名为“Bill Smith”的人可能会使用“Will Smith”、“William Smith”、“Smith, Will”等……如果说，我想编写一个应用程序将博客文章链接到作者，我必须说明对于所有这些名字。

我的问题是：您采取什么方法来在整个应用程序中保持一致的数据。您如何构建您的数据库，以便您可以参考一个标识符来定位所有这些名称？您采用哪些 UI 方法来确保人们以一致的方式输入姓名？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-18T19:11:01.613

只要您有每个用户的唯一 ID（*不是*他们的姓名），您就可以拥有一个将名称变化映射到唯一 ID 的表，然后将每个帖子与该唯一 ID 相关联。

```
（将名称映射到 UID 的表）

名称 UID

罗伯特 S 123456
鲍勃 S 123456
伯特小号 123456
达伦 987654

```

```
（带有帖子信息的表格，包括作者的 UID）

标题作者...

邮政 1 123456
邮政2 123456
邮政 3 987654

```

```
（附有作者信息的表格）

UID 首选名称网页...

123456 罗伯特·史密斯 http://www.robert.com
987654 达伦·琼斯 http://www.jones.com

```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-18T19:09:46.953

最好只接受用户的一个名称，并允许他们使用“昵称”或“公共名称”。这使他们可以自由地使用合法名称（可能用于邮寄或计费）以及可公开查看的名称以在您的网站上进行交互。

除此之外，我认为我不会允许我的用户拥有多个名称，除非我的系统需要它。如果我这样做了，我会把它分成两个表：

*   **用户：**

    *   用户 ID *（例如：1821）*
*   **用户名：**

    *   用户 ID *（例如：1821）*
    *   名字*（例如：乔纳森）*
    *   姓氏*（例如：桑普森）*

此外，您可以在`usernames`表中添加一个名为“ `isPrimary`”的字段。这将是一个布尔值，它将告诉您将哪个名称视为用户的主要名称。这类似于维基百科存储数据/更改历史的方式。他们保留所有，但标记哪个是“活动的”，或者在你的情况下是“主要的”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T19:11:24.360

在我看来，您正试图将他们的名字用作主键或 UID。这是错误的方法。您应该有一个单独的 UID 作为主键，然后名称可以是您想要的任何名称，您甚至可以有一个备用名称列表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-18T19:45:12.280

我同意前 3 篇关于如何构建架构的帖子。

关于用户界面，我会允许一个字段用于合法的名字、中间名和姓氏，这应该很少改变。

然后根据您的应用程序要求允许昵称。

拥有他们的法定全名也可以在计费/财务/人力资源情况下派上用场。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-18T19:49:21.087

当您有多个应用程序并且每个应用程序都有自己的用户信息架构时，就会出现真正的问题。计费系统可能有“Will Smith”；工资系统可能有“William Smith”；索赔系统可能有“Willie X. Smith”。所有人都真的是同一个人。你做什么工作？对于瘦腿、遗留应用程序来说，这是一个巨大的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-18T20:14:43.257

您总是可以制作一个 AKA 表，在其中您可以使用首选名称而不是 AKA 名称。所以如果有人使用比尔这个名字，你总是可以用威廉代替它。

我从来没有亲自将这个概念用于名称，但我确实支持一个与电影标题类似的项目，它可能因不同的国家而异。

# javascript - 使用 Ajax 调用从函数返回值

> ID：562412
> 
> 赞同：5
> 
> 时间：2009-02-18T19:08:06.147
> 
> 标签：javascript, ajax, asynchronous

有人可以告诉我如何将 的值`status`作为函数的返回值返回。

```
function checkUser() {
    var request;
    var status = false;

    //create xmlhttprequest object here [called request]

    var stu_id = document.getElementById("stu_id").value;
    var dName = document.getElementById("dName").value;
    var fileName = "check_user.php?dName=" + dName + "&stu_id=" + stu_id;
    request.open("GET", fileName, true);
    request.send(null);

    request.onreadystatechange = function() {
        if (request.readyState == 4) {
            var resp = parseInt(request.responseText, 10);
            if(resp === 1) {
                alert("The display name has already been taken.");
                status = false;
            }
            else if(resp === 2) {
                alert("This student ID has already been registered");
                status = false;
            }
            else if(resp === 0) {
                status = true;
            }
        }
    }
    return status;
} 
```

当您在注册表单中点击提交时，上述功能会触发（必须很明显）。问题是，无论响应是什么，此表单都会提交，并且警告框有时不显示任何内容[空白]，有时根本不显示。但是，如果我将结尾更改`status`为`false`手动 [即替换`status`为`false`]，则警告框中会显示正确的值。

PS 我比 javascript 中的菜鸟还差，所以也欢迎提出一般改进代码的建议。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-18T19:12:32.547

问题是它`onreadystatechange`不会触发，直到......等待它......状态改变。所以当你`return status;`大多数时候状态都来不及设置。您需要做的是`return false;`始终在内部`onreadystatechange`确定您是否要继续。如果你这样做了，那么你提交表格。简而言之，获取处理返回值的代码，而是从 readystatechange 处理程序中运行它。你可以直接这样做：

```
request.onreadystatechange = function() {
    if (request.readyState == 4) {
        var resp = parseInt(request.responseText, 10);
        switch (resp) {
        case 0:
            document.getElementById('myform').submit();
            break;
        case 1:
            alert("The display name has already been taken.");
            break;
        case 2:
            alert("This student ID has already been registered");
            break;
        }
    }
}
return false; // always return false initially 
```

或通过将[延续](https://docs.microsoft.com/en-us/archive/blogs/wesdyer/continuation-passing-style)传递给进行异步调用的函数：

```
function checkUser(success, fail) {
    ...
    request.onreadystatechange = function() {
        if (request.readyState == 4) {
            var resp = parseInt(request.responseText, 10);
            switch (resp) {
            case 0:
                success(request.responseText);
            case 1:
                fail("The display name has already been taken.", request.reponseText);
                break;
            case 2:
                fail("This student ID has already been registered", request.reponseText);
                break;
            default:
                fail("Unrecognized resonse: "+resp, request.reponseText);
                break;
            }
        }
    } 
```

除此之外，在默认设置之前，`return false;`您可能希望有某种指示符来指示正在发生的事情，例如禁用提交字段、显示加载圈等。否则，如果需要很长时间来获取，用户可能会感到困惑数据。

### 进一步说明

好吧，所以你的方式不起作用的原因主要是在这一行：

```
request.onreadystatechange = function() { 
```

这样做是说，当`onreadystatechange`AJAX 请求的更改时，您定义的匿名函数将运行。此代码不会立即执行。它正在等待事件发生。这是一个异步过程，因此在函数定义结束时，javascript 将继续运行，如果在到达`return status;`变量时状态没有改变，`status`显然没有时间设置，您的脚本将无法按预期工作. 在这种情况下，解决方案是始终`return false;`在事件触发时（即服务器以 PHP 的脚本输出响应），然后您可以确定状态并在一切正常时提交表单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T20:54:13.690

可以同步执行 send 方法，因此 request.responseText 将立即*可用*，但这通常不是一个好主意。该请求将挂起浏览器，直到完成。

要将请求设置为同步，请将 request.open 的第三个参数设置为“false”。

```
function checkUser() {
    var request;
    var status = false;

    //create xmlhttprequest object here [called request]

    var stu_id = document.getElementById("stu_id").value;
    var dName = document.getElementById("dName").value;
    var fileName = "check_user.php?dName=" + dName + "&stu_id=" + stu_id;
    request.open("GET", fileName, false);
    request.send(null);

    if (request.status === 200) {
        var resp = parseInt(request.responseText, 10);
        if(resp === 1) {
            alert("The display name has already been taken.");
            status = false;
        }
        else if(resp === 2) {
            alert("This student ID has already been registered");
            status = false;
        }
        else if(resp === 0) {
            status = true;
        }
    }
    else {
        alert("Request failed");
        status = false;
    }

    return status;
} 
```

正如我之前提到的，**这不是一个好主意**。异步执行请求几乎总是一个更好的主意，这样其他代码就可以在您等待响应时运行。**流行A** jax 而不是**S** jax是有原因的。

# .net - 子类化 ViewPage 以共享公共 ViewData：它是愚蠢的吗？

> ID：562424
> 
> 赞同：0
> 
> 时间：2009-02-18T19:12:07.883
> 
> 标签：.net, asp.net-mvc

我正在设置一个向导。我的所有向导视图都需要访问通用数据以进行显示，例如 TotalWizardSteps 和 CurrentWizardStep。我正在尝试找到将这些公共数据添加到 ViewDataDictionary 的最佳方法。我正在考虑创建自己的 WizardStepViewPage。这个子类将有一个属性“WizardData”，它返回一个 WizardData 对象。这将允许我在我的视图中编写以下代码：

```
<p>Wizard Step:<%= WizardData.CurrentStep %></p> 
```

此 WizardData 对象的后备存储将是 ViewDataDictionary 和一些难以重现的键，例如“__TheWizardData”。我会用一个动作过滤器在这个键上设置值。

这听起来很乱，但我认为它会起作用。是不是很傻？有没有更好的方法来实现这一目标？

我想：

*   html标记中对wizardData的强类型访问
*   让我的行为不知道需要构造wizardData
*   让我的强类型 viewData 类不知道 wizardData

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T19:19:56.117

我认为您应该创建一个包含必要信息的模型类并使用它来创建强类型视图。

我看不出你可能想从强类型模型中隐藏 WizardData 的充分理由，但如果你**真的**想这样做，为什么不创建一个扩展方法`ViewPage`而不是继承呢？继承不适用于不同类型的`ViewPage`（类型化、非类型化）。

# django - 从中间表中检索变量

> ID：562430
> 
> 赞同：0
> 
> 时间：2009-02-18T19:13:51.857
> 
> 标签：django, many-to-many

我需要通过中间表来检索机构名称。我的视图获取除此之外的所有值，或者至少它没有显示在模板中。有人可以帮忙修改我的视图或模板声明吗？

[http://dpaste.com/122204/](http://dpaste.com/122204/)

谢谢，

可能

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-19T04:34:59.323

要调试这些类型的问题，请执行以下操作。

独立于任何模板或 Django 的任何其他部分运行视图函数的处理。

以交互方式或使用非常简单的脚本运行您的查询。例如，使用像这样的简单脚本来探索您的模型并确保您的模型确实有效。

```
from app.models import Contact, Institution, Whatever
results= Researchproject.objects.filter(restitlestrip__icontains='something').distinct()
for project in results:
    print project.contact
    print contact.institutionname 
```

请注意有关您的简单脚本和模板的几件事。

1.  案件很重要。项目！=项目。

2.  导航很重要。在上面显示的脚本中，`contact`未定义。 `project.contact`，然而，被定义。也许这就是你的意思。

您的模型似乎不完整。该`Contactintermed`表似乎没有在您的查询或视图中的任何地方使用。它可能对其他表有 FK，但您似乎没有从 Project 到 Contact 到 Contactinterma 到机构的明智导航。

让您的模型在独立脚本中正确。稍后添加模板处理。

* * *

另外，请在 StackOverflow 上发布所有代码。在整个互联网上追逐你的代码是一个巨大的痛苦。简单地忽略您的问题比追查您的代码要容易得多。

# mysql - 在 mysql 数据库中搜索所有出现的字符串

> ID：562457
> 
> 赞同：213
> 
> 时间：2009-02-18T19:23:17.357
> 
> 标签：mysql

我试图弄清楚如何在数据库中找到所有出现的 url。我想搜索所有表格和所有字段。但我不知道从哪里开始，或者是否有可能。

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2009-02-18T19:34:55.317

一个简单的解决方案是这样做：

```
mysqldump -u myuser --no-create-info --extended-insert=FALSE databasename | grep -i "<search string>" 
```

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2014-10-30T07:16:11.217

在**phpMyAdmin**中可以使用“搜索”功能：

1.  选择特定的数据库而不是表。
2.  点击“搜索”标签
3.  输入您想要的搜索词
4.  选择要在其中搜索的表

**phpMyAdmin**屏幕截图：

![phpMyAdmin 数据库搜索选项卡](https://i.stack.imgur.com/xE2IC.png)

**MySQL Workbench**中也提供了“搜索”功能：

1.  数据库菜单 > 搜索表数据
2.  选择要搜索的数据库和表（它将仅在选定的表中搜索）
3.  在搜索中，您可以使用 wildChars。

**MySQL 工作台**屏幕截图：

![MySQL Workbench 数据库搜索](https://i.stack.imgur.com/jAYbN.png)

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2011-09-12T18:55:10.973

我知道旧帖子，但是对于像我一样通过 Google 找到此内容的其他人，如果您安装了 phpmyadmin，它具有全局搜索功能。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2014-06-25T04:12:43.940

使用 MySQL Workbench，您可以从“数据库”->“搜索表数据”菜单选项中搜索字符串。

指定 LIKE %URL_TO_SEARCH% 并在左侧选择您要搜索的所有表。您可以使用“Cntrl + A”选择左侧的整个树，然后取消选择您不关心的对象。

![在此处输入图像描述](https://i.stack.imgur.com/2Ze3J.png)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-07-16T12:25:20.070

您可以通过使用[HeidiSQL](http://www.heidisql.com/)来执行此操作，而无需生成 Db 转储

**步骤**：

1）从GUI的左侧面板中选择您需要搜索的数据库。

2)**导出 > 将数据库导出为 SQL**

3) 在表格工具窗口中选择“**查找文本**”选项卡。

4) 提供您要搜索的字符串并单击“**查找**”。

5）它将列出所有包含我们字符串的表。

**6) 选择相关性 %**较高的行。

7) 点击“**查看结果**”

![在此处输入图像描述](https://i.stack.imgur.com/HdxdT.png)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-04-16T22:17:04.133

当我们在 Wordpress 网站上更改域时，我自己也在寻找这个。没有一些编程就无法完成，所以这就是我所做的。

```
<?php  
  header("Content-Type: text/plain");

  $host = "localhost";
  $username = "root";
  $password = "";
  $database = "mydatabase";
  $string_to_replace  = 'old.example.com';
  $new_string = 'new.example.com';

  // Connect to database server
  mysql_connect($host, $username, $password);

  // Select database
  mysql_select_db($database);

  // List all tables in database
  $sql = "SHOW TABLES FROM ".$database;
  $tables_result = mysql_query($sql);

  if (!$tables_result) {
    echo "Database error, could not list tables\nMySQL error: " . mysql_error();
    exit;
  }

  echo "In these fields '$string_to_replace' have been replaced with '$new_string'\n\n";
  while ($table = mysql_fetch_row($tables_result)) {
    echo "Table: {$table[0]}\n";
    $fields_result = mysql_query("SHOW COLUMNS FROM ".$table[0]);
    if (!$fields_result) {
      echo 'Could not run query: ' . mysql_error();
      exit;
    }
    if (mysql_num_rows($fields_result) > 0) {
      while ($field = mysql_fetch_assoc($fields_result)) {
        if (stripos($field['Type'], "VARCHAR") !== false || stripos($field['Type'], "TEXT") !== false) {
          echo "  ".$field['Field']."\n";
          $sql = "UPDATE ".$table[0]." SET ".$field['Field']." = replace(".$field['Field'].", '$string_to_replace', '$new_string')";
          mysql_query($sql);
        }
      }
      echo "\n";
    }
  }

  mysql_free_result($tables_result);  
?> 
```

希望它对将来遇到这个问题的人有所帮助:)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-01-06T10:37:07.373

[*在这里*](http://lookalive.co.uk/blog/searching-entire-database-string-mysqldump-and-grep)找到了两 (2) 个简单代码的方法。首先做一个[mysqldump](http://dev.mysql.com/doc/refman/5.7/en/mysqldump.html)：

```
mysqldump -uUSERNAME -p DATABASE_NAME > database-dump.sql 
```

然后[grep](http://www.cyberciti.biz/faq/howto-use-grep-command-in-linux-unix/) sqldump 文件：

```
grep -i "Search string" database-dump.sql 
```

也[可以](https://stackoverflow.com/a/4822691/4058484)[查找/替换](https://stackoverflow.com/a/15402972/4058484)并重新[导入](https://stackoverflow.com/a/17666279/4058484)数据库。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-07-23T07:25:21.800

[SQLyog](http://www.webyog.com/en/downloads.php)是基于 GUI 的解决方案，用于解决跨所有列、表和数据库的数据搜索问题。可以自定义搜索，将其限制为字段、表和数据库。

在其`Data Search`功能中，人们可以像使用 Google 一样搜索字符串。

![SQLyog 数据搜索截图](https://i.stack.imgur.com/l0Oyu.png)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2015-03-19T21:28:42.183

MikeW 提出了一个有趣的解决方案，但正如评论中提到的，它是一个 SQL Server 解决方案而不是 MySQL 解决方案。这是一个MySQL解决方案：

```
use information_schema;
set @q = 'Boston';
set @t = 'my_db';

select CONCAT('use \'',@q,'\';') as q UNION
select CONCAT('select \'', tbl.`TABLE_NAME`,'\' as TableName, \'', col.`COLUMN_NAME`,'\' as Col, `',col.`COLUMN_NAME`,'` as value  from `' , tbl.`TABLE_NAME`,'` where `' ,
        col.`COLUMN_NAME` , '` like \'%' ,@q,  '%\' UNION') AS q
from `tables` tbl
inner join `columns` col on tbl.`TABLE_NAME` = col.`TABLE_NAME`and col.DATA_TYPE='varchar'
where tbl.TABLE_SCHEMA  =  @t  ; 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-01-26T18:10:19.783

我不记得我在哪里遇到过这个脚本，但我一直在使用它和 XCloner 来移动我的 WP 多站点。

```
<?php

    // Setup the associative array for replacing the old string with new string
    $replace_array = array( 'FIND' => 'REPLACE', 'FIND' => 'REPLACE');

    $mysql_link = mysql_connect( 'localhost', 'USERNAME', 'PASSWORD' );
    if( ! $mysql_link) {
        die( 'Could not connect: ' . mysql_error() );
    }

    $mysql_db = mysql_select_db( 'DATABASE', $mysql_link );
    if(! $mysql_db ) {
        die( 'Can\'t select database: ' . mysql_error() );
    }

    // Traverse all tables
    $tables_query = 'SHOW TABLES';
    $tables_result = mysql_query( $tables_query );
    while( $tables_rows = mysql_fetch_row( $tables_result ) ) {
        foreach( $tables_rows as $table ) {

            // Traverse all columns
            $columns_query = 'SHOW COLUMNS FROM ' . $table;
            $columns_result = mysql_query( $columns_query );
            while( $columns_row = mysql_fetch_assoc( $columns_result ) ) {

                $column = $columns_row['Field'];
                $type = $columns_row['Type'];

                // Process only text-based columns
                if( strpos( $type, 'char' ) !== false || strpos( $type, 'text' ) !== false ) {
                    // Process all replacements for the specific column                    
                    foreach( $replace_array as $old_string => $new_string ) {
                        $replace_query = 'UPDATE ' . $table . 
                            ' SET ' .  $column . ' = REPLACE(' . $column . 
                            ', \'' . $old_string . '\', \'' . $new_string . '\')';
                        mysql_query( $replace_query );
                    }
                }
            }
        }
    }

    mysql_free_result( $columns_result );
    mysql_free_result( $tables_result );
    mysql_close( $mysql_link );

    echo 'Done!';

?> 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-12-22T19:00:50.963

如果您可以使用 bash - 这是一个脚本：它需要一个用户 dbread，并在数据库上传递 dbread。

```
#!/bin/bash
IFS='
'
DBUSER=dbread
DBPASS=dbread
echo -n "Which database do you want to search in (press 0 to see all databases): " 
read DB
echo -n "Which string do you want to search: " 
read SEARCHSTRING
for i in `mysql $DB -u$DBUSER -p$DBPASS -e "show tables" | grep -v \`mysql $DB -u$DBUSER -p$DBPASS -e "show tables" | head -1\``
do
for k in `mysql $DB -u$DBUSER -p$DBPASS -e "desc $i" | grep -v \`mysql $DB -u$DBUSER -p$DBPASS -e "desc $i" | head -1\` | grep -v int | awk '{print $1}'`
do
if [ `mysql $DB -u$DBUSER -p$DBPASS -e "Select * from $i where $k='$SEARCHSTRING'" | wc -l` -gt 1 ]
then
echo " Your searchstring was found in table $i, column $k"
fi
done
done 
```

如果有人想要解释： http: [//infofreund.de/ ?p=1670](http://infofreund.de/?p=1670)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-18T19:33:35.290

斯科特给出了一个很好的例子来说明如何做到这一点，但问题是你为什么要这样做？如果您需要对特定字符串进行查找和替换，您还可以尝试对数据库执行 mysqldump，在编辑器中执行查找和替换，然后重新加载数据库。

也许如果你提供了一些关于你想要达到的目标的背景，其他人可能会提供更好的答案。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-07-05T07:27:55.223

我一直在寻找相同但找不到​​它，所以我用 PHP 制作了一个小脚本，您可以在以下位置找到它： [http ://tequilaphp.wordpress.com/2010/07/05/searching-strings-in-一个数据库和文件/](http://tequilaphp.wordpress.com/2010/07/05/searching-strings-in-a-database-and-files/)

祝你好运！（我删除了一些私人代码，如果我没有在此过程中破坏它，请告诉我：D）

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-07-26T10:02:12.433

该视频的前 30 秒展示了如何使用 Phpmyadmin 的全局搜索功能并且它可以工作。它将在每个表中搜索一个字符串。

[http://www.vodahost.com/vodatalk/phpmyadmin-setup/62422-search-database-phpmyadmin.html](http://www.vodahost.com/vodatalk/phpmyadmin-setup/62422-search-database-phpmyadmin.html)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-11-20T10:59:47.983

在 unix 机器上，如果数据库不是太大：

```
mysqldump -u <username> -p <password> <database_name> --extended=FALSE | grep <String to search> | less -S 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-18T19:26:51.233

不是一个优雅的解决方案，但您可以使用嵌套循环结构来实现它

```
// select tables from database and store in an array

// loop through the array
foreach table in database
{
    // select columns in the table and store in an array

    // loop through the array
    foreach column in table
    {
        // select * from table where column = url
    }
} 
```

您可以通过在构建列数组时检查哪些列包含字符串以及将每个表的所有列组合在一个巨大的逗号分隔的 WHERE 子句中来加快这一速度。

# string - 什么时候可以很好地利用时间来重构字符串文字？

> ID：562462
> 
> 赞同：1
> 
> 时间：2009-02-18T19:23:59.803
> 
> 标签：string, refactoring, internationalization, constants, literals

我开始一个项目，其中大部分时间都将字符串写入代码中。许多字符串可能只在少数地方使用，但一些字符串在许多页面中都很常见。

将文字重构为常量是否可以很好地利用我的时间，因为该应用程序已经很好地建立并且运行良好？这样做的长期好处是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T19:28:16.737

要考虑的一件常见事情是[i18n](http://en.wikipedia.org/wiki/I18n)。如果您（或您的笨蛋）想在墨西哥或法国（等）销售您的产品，您会很感激这些字符串文字*不会*在整个代码库中乱扔垃圾。

编辑：我意识到这并不能直接回答你的问题，所以我投票赞成其他一些答案：三规则等。我知道您在谈论现有的代码库，所以从一开始就谈论合并 i18n 有点晚了。当您从一开始就养成习惯时，这很容易做到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T19:28:47.623

我喜欢在重构时应用三法则。如果它发生 3 次或更多次，则需要更新代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T19:27:21.123

如果一个字符串在多个地方使用，请重构它。如果只在一个地方使用，不要管它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T19:28:56.297

如果您重构了所有常用字符串，则可以更轻松地对它们进行国际化/翻译。如果它们都在属性文件中，或者任何你的语言等价物，那就更容易了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T19:30:43.750

只有当这个项目需要在未来得到支持时，这才是对时间的一种很好的利用。如果您将定期维护/扩展此系统；但是，这是个好主意。

1) 字符串文字存在很大程度的风险，因为通常只能在运行时检测到单个拼写错误。降低运行时错误的风险是一个重要的优势，因为它们可能会令人尴尬/沮丧。

2) 此外，如果它们需要更改，例如当它们用于引用另一个系统（如表名、服务器名等）时，当其他系统名称更改时，它们可能很难更新。集中它们，这是一个微不足道的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-18T19:35:00.450

> *将文字重构为常量是否可以很好地利用我的时间，因为该应用程序已经很好地建立并且运行良好？*

不，你最好让它保持原样。

> *这样做的长期好处是什么？*

如果没有人接触过该代码，则没有任何好处。

但是，您可以做的是避免添加新的文字。但我几乎会保持现状。

您可能可以在空闲时重构它们以睡得更好。

可能已经有一些其他错误需要您注意。改正那些。

最后，如果你设法将“重构”添加到你的任务列表中，请继续！！！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-18T19:35:59.683

我同意 JMD，请记住，i18n 不仅仅是更改字符串（货币、UI 必须适应从右到左的语言等）

即使您不希望 18n 您的应用程序，重构您的字符串也会很有用，因为该字符串今天只使用一次，明天可能会重复使用几次，如果它是硬编码的，您可能不知道它并且开始在各处复制字符串。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-18T19:35:37.123

最好让睡狗躺着。如果您需要更改使用了 18 次的字符串，是的，请继续在某处将其变为常量。如果你发现自己在一个模块中工作，该模块的字符串可以是常量化的，如果你愿意就去做。但是通过整个应用程序将所有字符串更改为常量......这应该在待办事项列表的最底部。

# javascript - 禁用浏览器上的 Ctrl+N 和 File->New 选项

> ID：562466
> 
> 赞同：0
> 
> 时间：2009-02-18T19:24:46.573
> 
> 标签：javascript, internet-explorer, keyboard-shortcuts

如何禁用浏览器窗口中的 Ctrl+N/File->New 选项，特别是针对 IE。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T19:35:06.017

你对客户有多少控制权？

如果您只是在 WWW 上公开提供一个页面，那么就没有办法了。

如果您正在运行信息亭或计算机教室或其他东西，那么您可能会一起破解一些东西以监视 IE 实例，并禁用菜单并捕获 Ctrl+N 组合键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T19:58:25.760

根据评论，听起来您正在尝试解决症状而不是问题本身。无论如何，您暗示的方法可能用途有限（仅适用于某些浏览器）。

我建议您发布重复会话问题的详细信息，让我们对此进行破解。

# sql-server - SQL Server SELECT/UPDATE 存储过程怪异

> ID：562467
> 
> 赞同：3
> 
> 时间：2009-02-18T19:25:02.390
> 
> 标签：sql-server, tsql, stored-procedures

我有一张桌子用作工作队列。本质上，它由一个主键、一段数据和一个状态标志（已处理/未处理）组成。我有多个进程试图抓取下一个未处理的行，因此我需要确保它们观察到正确的锁定并更新语义以避免竞争条件恶劣。为此，我定义了一个他们可以调用的存储过程：

```
CREATE PROCEDURE get_from_q
AS
DECLARE @queueid INT;
BEGIN TRANSACTION TRAN1;

SELECT TOP 1 
    @queueid = id 
FROM 
    MSG_Q WITH (updlock, readpast) 
WHERE 
    MSG_Q.status=0;

SELECT TOP 1 * 
FROM
    MSG_Q 
WHERE 
    MSG_Q.id=@queueid;

UPDATE MSG_Q 
SET status=1 
WHERE id=@queueid;

COMMIT TRANSACTION TRAN1; 
```

请注意使用“WITH (updlock, readpast)”来确保我锁定目标行并忽略已经类似锁定的行。

现在，该过程如上面列出的那样工作，这很棒。然而，当我把它放在一起时，我发现如果第二个 SELECT 和 UPDATE 按顺序颠倒（即先 UPDATE 然后 SELECT），我根本没有得到任何数据。不，第二个 SELECT 是在最后的 COMMIT 之前还是之后都没有关系。

因此，我的问题是为什么第二个 SELECT 和 UPDATE 的顺序会有所不同。我怀疑那里发生了一些我不明白的微妙事情，我担心它以后会咬我。

有什么提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T19:56:50.193

默认情况下，事务是 READ COMMITTED ：

“指定在读取数据时保持共享锁以避免脏读，但可以在事务结束之前更改数据，导致不可重复读取或幻像数据。此选项是 SQL Server 默认设置。”

[http://msdn.microsoft.com/en-us/library/aa259216.aspx](http://msdn.microsoft.com/en-us/library/aa259216.aspx)

我认为您在选择中一无所获，因为该记录仍被标记为脏。您必须更改事务隔离级别或者，我所做的是先进行更新然后读取记录，但要做到这一点，您必须使用唯一值标记记录（我使用 getdate() 进行批处理但 GUID 可能是您想要使用的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T19:32:44.027

尽管在这里没有直接回答您的问题，而不是重新发明轮子并使自己的生活变得困难，除非您当然喜欢它;-)，但我建议您考虑使用 SQL Server Service Broker。

它为使用队列等提供了一个现有的框架。

要了解更多信息，请访问。

[服务代理链接](http://msdn.microsoft.com/en-us/library/ms166043(SQL.90).aspx)

现在回到问题，我无法复制您的问题，因为您将看到如果执行下面的代码，无论选择/更新语句的顺序如何，都会返回数据。

所以你上面的例子。

```
create table #MSG_Q
(id int identity(1,1) primary key,status int)
insert into #MSG_Q select 0

DECLARE @queueid INT
BEGIN TRANSACTION TRAN1
SELECT TOP 1 @queueid = id FROM #MSG_Q WITH (updlock, readpast) WHERE #MSG_Q.status=0
UPDATE #MSG_Q SET status=1 WHERE id=@queueid
SELECT TOP 1 * FROM #MSG_Q WHERE #MSG_Q.id=@queueid
COMMIT TRANSACTION TRAN1

select * from #MSG_Q
drop table #MSG_Q 
```

返回结果 (1,1) 和 (1,1)

现在交换语句顺序。

```
create table #MSG_Q
(id int identity(1,1) primary key,status int)    
insert into #MSG_Q select 0

DECLARE @queueid INT
BEGIN TRANSACTION TRAN1
SELECT TOP 1 @queueid = id FROM #MSG_Q WITH (updlock, readpast) WHERE #MSG_Q.status=0
SELECT TOP 1 * FROM #MSG_Q WHERE #MSG_Q.id=@queueid
UPDATE #MSG_Q SET status=1 WHERE id=@queueid
COMMIT TRANSACTION TRAN1

select * from #MSG_Q
drop table #MSG_Q 
```

结果： (1,0), (1,1) 符合预期。

也许您可以进一步限定您的问题？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T20:49:37.977

更多的实验使我得出结论，我正在追逐一条红鲱鱼，这是由我用来执行我的存储过程的工具带来的。我最初使用的是 DBVisualizer（免费版）和 Netbeans，它们似乎都对结果格式感到困惑。DBVisualizer 建议我返回多个结果集，而免费版无法处理该问题。

从那以后，我使用了免费的 MS SQL Server Management Studio Express，一切都运行良好。对于那些感兴趣的人，SMSE 的 URL 在这里：

[MS SQL 服务器 SMSE](http://www.microsoft.com/downloads/details.aspx?FamilyID=c243a5ae-4bd1-4e3d-94b8-5a0f62bf7796&DisplayLang=en#Requirements)

不要忘记安装 MSXML6 服务包：

[MSXML 服务包 1](http://www.microsoft.com/downloads/details.aspx?familyid=D21C292C-368B-4CE1-9DAB-3E9827B70604&displaylang=en#filelist)

所以，在这种情况下完全是我的错。:-(

不过，非常感谢你们的回答。您帮助我确认我正在做的事情应该有效，这导致我必须做出改变才能真正“解决”这个问题。非常感谢！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T13:15:26.037

还有一点——在存储过程中包含一个“SET NOCOUNT ON”，为所有 ODBC 客户端修复了问题。显然，第一次选择的行数混淆了 ODBC 客户端，并且告诉 SQL Server 不返回该值会使事情完美地工作......

# c# - 定期从 SQL Server 动态加载应用程序设置

> ID：562468
> 
> 赞同：1
> 
> 时间：2009-02-18T19:25:10.287
> 
> 标签：c#, configuration

对于我的 .net 应用程序，我想将配置数据存储在 SQL Server 中，并希望最初加载它，然后定期刷新数据，以防直接在数据库中进行任何更改。是否有任何工作/库已经可用的“集中配置管理器”可以存储多个应用程序的配置数据。

否则是否有一种设计模式可以帮助我设计解决方案（特别是刷新部分）。

我对此已经有了一些想法
1\. 创建一个配置提供程序（可以改回基于 xml 的配置或扩展到其他配置提供程序）
2\. 使用 SQL 依赖缓存定期 ping 数据库。
3.可以暴露为WCF服务，以便多个应用程序可以使用存储在中心位置的配置

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T21:09:37.053

关于#2 的想法，虽然我不知道您正在使用/可以使用哪个版本的 EntLib 或 MSSQL。

2005 年的 SQL Dependency 不仅支持轮询，还支持推送模型。它将通过 NDS（通知传递服务）推送到 IIS，并在表更改时通知。如果您有多个依赖于存储在同一位置的配置的应用程序，这可能是一个不错的选择。然后你会得到及时的更新，而不是多个应用程序不断地轮询变化（即更少的网络聊天）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T19:39:43.853

您是否查看过 Enterprise Library 的配置应用程序块？

如果你自己做，MS SQL 2005+ 本身就支持缓存失效，所以当缓存数据改变时它可以通知你的程序。

# c# - 为什么 SortedList 实现使用 ThrowHelper 而不是直接抛出？

> ID：562479
> 
> 赞同：15
> 
> 时间：2009-02-18T19:28:29.933
> 
> 标签：c#

Reflector 告诉我 SortedList 使用 ThrowHelper 类来抛出异常，而不是直接抛出异常，例如：

```
public TValue this[TKey key]
{
    get
    {
        int index = this.IndexOfKey(key);
        if (index >= 0)
            return this.values[index];
        ThrowHelper.ThrowKeyNotFoundException();
        return default(TValue);
    } 
```

其中 ThrowKeyNotFoundException 无非只是：

```
throw new KeyNotFoundException(); 
```

请注意，这需要一个无法访问的 duff 语句“return default(TValue)”。我必须得出结论，这是一种具有足够大的好处的模式来证明这一点。

这些好处是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-19T21:53:14.763

根据[ThrowHelper.cs](https://github.com/dotnet/runtime/blob/master/src/libraries/System.Private.CoreLib/src/System/ThrowHelper.cs)源代码，主要目的是减少 JITted 代码大小。以下是链接中的直接复制粘贴：

```
// This file defines an internal class used to throw exceptions in BCL code.
// The main purpose is to reduce code size. 
// 
// The old way to throw an exception generates quite a lot IL code and assembly code.
// Following is an example:
//     C# source
//          throw new ArgumentNullException("key", Environment.GetResourceString("ArgumentNull_Key"));
//     IL code:
//          IL_0003:  ldstr      "key"
//          IL_0008:  ldstr      "ArgumentNull_Key"
//          IL_000d:  call       string System.Environment::GetResourceString(string)
//          IL_0012:  newobj     instance void System.ArgumentNullException::.ctor(string,string)
//          IL_0017:  throw
//    which is 21bytes in IL.
// 
// So we want to get rid of the ldstr and call to Environment.GetResource in IL.
// In order to do that, I created two enums: ExceptionResource, ExceptionArgument to represent the
// argument name and resource name in a small integer. The source code will be changed to 
//    ThrowHelper.ThrowArgumentNullException(ExceptionArgument.key, ExceptionResource.ArgumentNull_Key);
//
// The IL code will be 7 bytes.
//    IL_0008:  ldc.i4.4
//    IL_0009:  ldc.i4.4
//    IL_000a:  call       void System.ThrowHelper::ThrowArgumentNullException(valuetype System.ExceptionArgument)
//    IL_000f:  ldarg.0
//
// This will also reduce the Jitted code size a lot. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-18T19:32:47.850

看看 ThrowHelper 做了什么。它为错误消息获取资源和内容。在这个特定的例子中，没有错误文本，所以它看起来没用，但他们的模式可能需要它，所以编写它的开发人员遵循了他/她应该的模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-25T19:23:39.207

另一个有趣的方面是性能。有趣的是，`throw`即使因为 JIT 不喜欢内联此类方法（可能是为了提高调用堆栈的可读性）而没有抛出异常，包含语句的方法也会变慢。考虑以下示例：

```
private class TestClass
{
    internal int RegularThrow(int value)
    {
        if (value < 0)
            throw new ArgumentOutOfRangeException(nameof(value));
        return value + 1;
    }

    internal int ThrowByHelper(int value)
    {
        if (value < 0)
            Throw.ArgumentOutOfRangeException(Argument.value); // Argument is an enum
        return value + 1;
    }
} 
```

**我的电脑上的性能结果：**

（请参阅源链接以及下面的一些注释）

```
1\. ThrowByHelper: average time: 5,24 ms
  #1           5,26 ms
  #2           5,16 ms   <---- Best
  #3           5,31 ms   <---- Worst
  Worst-Best difference: 0,16 ms (3,02%)
2\. RegularThrow: average time: 23,51 ms (+18,27 ms / 448,40%)
  #1          23,46 ms
  #2          23,42 ms   <---- Best
  #3          23,65 ms   <---- Worst
  Worst-Best difference: 0,22 ms (0,95%) 
```

意思是，显式`throw`语句的方法慢了 4.5 倍！但...

**有趣的观察：**

*   从 .NET 4.0 开始，您可以应用该`[MethodImpl(MethodImplOptions.AggressiveInlining)]`属性，但它不能保证任何事情。例如，在 .NET Fiddle 中，内联似乎通常被禁用，因此两种方式实际上具有相同的性能。[在此处查看源代码和完全不同的结果](https://dotnetfiddle.net/XvFUkl)。
*   在 .NET Core 3（Windows 10 上的 x64 版本）中，似乎只有从`ArgumentException`阻止内联派生的异常类型（不使用任何属性）。至少扔一个`NotSupportedException`或`InvalidOperationException`直接不会对性能产生负面影响。
*   对于更复杂的方法，throw helper 无论如何都没有任何意义。但它在短期性能关键成员中很有用。

**冗余/无法访问的代码问题和代码分析器：**

`return`可以通过在 中定义一些通用重载来避免冗余语句`ThrowHelper`：

```
// for regular usage:
internal static void ArgumentException(Argument arg, string message) => throw new...

// for expression usage:
internal static T ArgumentException<T>(Argument arg, string message) => throw new... 
```

后者可以在`return`语句中使用，可以保留 a `break`in`case`块，从 C# 7.0 开始，它可以像 throw 表达式一样使用：

```
return value >= 0 ? value + 1 : Throw.ArgumentOutOfRangeException<int>(Argument.value); 
```

另一个问题是 ReSharper 和 FxCop 无法识别 throw helper 成员并可能开始发出误报警告。对于 ReSharper，我们可以使用以下`ContractAnnotation`属性：

```
// prevents PossibleNullReferenceException, AssignNullToNotNullAttribute and similar false alarms
[ContractAnnotation("=> halt")]
internal static void ArgumentException(Argument arg, string message) => throw new... 
```

不幸的是，对于 FxCop，我没有找到类似的解决方案（并且该`[DoesNotReturn]`属性显然不起作用），因此您应该使用`#pragma warning disable`or`SuppressMessage`属性来抑制 CA1031、CA1062 和他们的朋友。

# c++ - 如何在 MSVC 2005 中手动修饰链接器名称？

> ID：562482
> 
> 赞同：2
> 
> 时间：2009-02-18T19:29:10.697
> 
> 标签：c++, linker

有没有办法在 MS C++ 中手动装饰函数名称？我猜想任何解决方案都是微软特有的，我对此很满意。

或者，有没有办法声明函数“ `??_M@YGXPAXIHP6EX0@Z@Z`”以便编译器可以理解它？仅供参考，`undname`将其列为：

`void _ _ stdcall `eh vector destructor iterator'(void * , unsigned int, int, void (_ _thiscall * )(void * ))`

显然，编译器对我的标识符中的撇号不满意。

**编辑：**
解决方案实际上非常简单。我遵守了 obj，并在占位符名称上对所需的装饰名称进行了十六进制编辑，并用空值填充它们。链接器直接吃掉了它，没有问任何问题。这些函数是存根，调用外部函数，因此我不必每次进行小改动时都进行十六进制编辑。

感谢大家的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T19:39:36.677

> `eh 向量析构迭代器'

您确定撇号 [sic] 是标识符的一部分吗？您是否尝试在没有它们的情况下使用该功能？看起来它们的存在是为了提高可读性。

> 或者，有没有办法声明函数“??_​​M@YGXPAXIHP6EX0@Z@Z”

如果我们通过声明表示相同的意思，我严重怀疑您是否可以“声明”一个错误的名称。声明是预编译，修改发生在很久以后。

> ??_M@YGXPAXIHP6EX0@Z@Z

这是一个乱七八糟的名字。所有具有 C++ 链接的符号都被损坏。这是签名、返回类型和调用约定信息的散列。[在MSDN](http://msdn.microsoft.com/en-us/library/2ax8kbk1(VS.80).aspx)上阅读更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T19:53:53.493

我假设您知道向量析构函数迭代器是什么，并且只想知道如何在您的代码中模仿它的名称。

一种方法可能是在汇编中编写代码，这可能（但同样可能不会）允许您使用几乎任何函数名称。

另一种方法可能是将代码放入 DLL 并覆盖 DLL 的 *.def 文件中的名称，使用 *.def 文件的 EXPORTS 部分中允许的可选*entryname* [= *internalname* ] 语法（它允许您重命名正在出口）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T19:56:44.343

如果您将函数声明为*extern "C"*并使用禁用下划线前缀的链接器选项，那么您在代码中给出的名称就是您在 .obj 文件中的名称。但这并不能解决您的所有问题，因为当您尝试声明名称中包含特殊字符的函数时，编译器会犹豫。

我想解决方案（这是 IMO 的大量工作）是在源代码中为所需的函数提供唯一名称（如 PLACEHOLDER_01），然后在 .obj 文件中替换它们。您需要以某种方式解析目标文件并更改符号名称。

另请注意，“eh vector destructor iterator”是一个错位名称，真实（符号）名称中不应包含撇号或空格。转储 .obj/.dll 时，您必须禁用名称修改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-13T06:11:48.683

您可以使用带有此签名的 MSVC++ 生成该符号：

> void __stdcall __ehvec_dtor(void * __arr, unsigned int __size, int _ *n, void (* _stdcall * __dtor)(void *))

显然 __ehvec_dtor 映射到异常处理向量析构函数的特殊损坏符号。

# ruby-on-rails - Rails 初始化程序中对夹具数据的依赖

> ID：562492
> 
> 赞同：2
> 
> 时间：2009-02-18T19:32:45.760
> 
> 标签：ruby-on-rails, testing, dependencies, fixtures, initializer

我有一个初始化程序，它设置了在整个应用程序中使用的默认值。该值是一个 ActiveRecord 模型，我本质上是在应用程序的生命周期内缓存它：

```
@@default_region = Region.find_by_uri("whistler") 
```

记录保证在数据库中：它是其他模型引用的夹具数据。这工作正常，除非在每次测试运行之前清除数据库的测试环境中。（我在边缘轨道上运行，我认为这是最近的行为：我曾经能够手动插入数据并在测试运行之间保留它。）我的`regions.yml`夹具文件中也有记录，但直到夹具才加载在 rails 初始化程序完成后。

处理这种对夹具数据的依赖的正确方法是什么？还是有更好的方法来构建它？我宁愿不使用 before_filter 因为在每个请求上重新加载它是没有意义的：它不会改变，除非在不同的部署中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T20:43:32.267

我会在 region.rb 中添加这样的内容：

```
def self.default_region
  @@default_region ||= Region.find_by_uri("whistler")
end 
```

然后，您可以在任何需要的地方以 Region.default_region 的形式访问它，并且它只被查找一次 - 第一次被调用 - 到那时，固定装置将就位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T20:02:41.973

对 Ruby 或 Rails 不太熟悉……但为什么不尝试“延迟加载”方案呢？基本上，有一个全局函数来检查数据是否已加载，如果没有，则从数据库中获取它，然后缓存它。如果它已经被缓存，只需返回它。

这样，在第一次调用该函数之前，您不会尝试访问数据库，并且到那时一切都应该被初始化。

# apache - 下载受保护的 XLS 文件时，为什么 .htaccess 在 IE 中会触发两次？

> ID：562512
> 
> 赞同：0
> 
> 时间：2009-02-18T19:37:32.283
> 
> 标签：apache, excel, .htaccess

某些目录受 Basic Auth 保护，使用较旧的 Apache 1.x 服务器上的 .htaccess 文件。今天，一位用户指出，他刚刚发布的文件两次请求用户名/密码 - 一次是在进入目录查看索引时，然后是在下载文件时再次请求。发现这很奇怪，我研究了双重触发 .htaccess 身份验证的常见问题：

*   服务器名称（[http://server](http://server)与[http://www.server](http://www.server)）
*   斜杠（[http://server/somedir](http://server/somedir)与[http://server/somedir/](http://server/somedir/)）
*   http 与 https

没运气。更令人困惑的是 Firefox/Chrome/Safari 不会询问两次 - 只有 IE（6 和 7）。进一步的调查表明，PDF 文件不会发生这种情况——只有 Excel 文件——甚至是空白文件。

Excel 是否以某种方式回调服务器，需要第二次身份验证？为什么它只发生在 IE 中？

不重要-但我很好奇可能导致这种情况的原因。

编辑 - 我认为 bmdhacks 搞定了。观察网络流量，Excel+IE 使用称为“Microsoft 协议发现”的不同用户代理返回第二个请求

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T19:47:13.633

我不确定 Excel，但 Windows Media Player 与 IE 有一个特殊的交互，当 IE 请求一个具有 Windows Media Player 拥有的 MIME 类型的文件时，它不会将下载的文件交给 WMP，而是指示 Windows Media Player下载文件本身。这可能导致请求文件两次，一次是 IE 请求文件，第二次是 WMP 下载文件。

微软也有可能在 Excel 等其他产品中使用这种机制。您可以通过查看在第二个请求中提交的 User-Agent 标头来发现这一点。在 Windows Media 案例中，它实际上在第二个请求时从 IE 更改为 WMP 的 User-Agent。

# c# - 在 C# 中使用相同布局强制不同命名空间中的类型

> ID：562517
> 
> 赞同：13
> 
> 时间：2009-02-18T19:38:47.133
> 
> 标签：c#, .net, web-services, types, coerce

我已经开始为 FedEx 的网络服务 API 编写接口。他们有 3 个我感兴趣的不同 API；费率、运送和跟踪。我正在使用 SvcUtil.exe 生成服务代理。

不同的服务端点均由 FedEx 在其自己的 WSDL 文件中指定。每个服务端点都有自己的 xml 命名空间（例如[http://fedex.com/ws/rate/v5](http://fedex.com/ws/rate/v5)和[http://fedex.com/ws/ship/v5](http://fedex.com/ws/ship/v5)）

服务端点确实使用了很多相同的类型，例如 Address、Measures、Weight、AuthenticationDetail、ClientDetail 等...

这就是问题所在，我可以同时向 SvcUtil.exe 提供所有 WSDL 文件，通常它会将任何相同的类型合并为一个共享类型，但是由于 FedEx 的每个服务都在它们自己的命名空间中，并且他们在该命名空间下的每个 WSDL 文件中重新声明这些类型，而我最终得到的是每个命名空间的地址、地址 1 和地址 2。

为了解决这个问题，我现在要做的是通过 svcutil 分别运行每个 WSDL，并将它们分别放在自己的 .NET 命名空间中（例如 FedEx.Rate、FedEx.Ship、FedEx.Track）。问题在于，现在我在每个命名空间（Fedex.Rate.Address、FedEx.Ship.Address）中都有一个不同的地址类型。

这使得很难概括服务之间使用的代码，例如 GetAuthenticationDetail() 工厂方法，因此我不必在使用不同服务的每个地方重复该代码。

C# 中有什么方法可以将 FedEx.Rate.Address 强制为 FedEx.Ship.Address？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-18T19:55:27.887

如果类型相同，并且您可以控制源类，则可以在类中定义[转换运算符](http://msdn.microsoft.com/en-us/library/85w54y0a.aspx)，并且任何采用 a 的函数也`Rate.Address`将自动采用 a `Ship.Address`。例如：

```
namespace Rate {
    class Address {
        string Street;
        string City;
        // ...

        public static implicit operator Ship.Address(Rate.Address addr) {
            Ship.Address ret;
            ret.Street = addr.Street;
            ret.City = addr.City;
            // ...

            return ret;
        }
    }
} 
```

我的 C# 有点生疏，但我希望你能明白。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-19T01:27:59.727

所以这就是我如何使用反射实现隐式转换运算符。SvcUtil 创建部分类，因此我为每个转换方向添加了一个隐式转换运算符，因此您可以在客户端代码中键入`Type1 = Type2`.

在这个片段中，WebAuthenticationCredentials 是 WebAuthenticationDetails 的一个属性，因此在迭代源对象的属性时，如果类型不同（内置），它会检查类型的名称（没有命名空间）并递归调用具有这些属性的复制函数.

```
internal class ReflectionCopy
{
    public static ToType Copy<ToType>(object from) where ToType : new()
    {
        return (ToType)Copy(typeof(ToType), from);
    }

    public static object Copy(Type totype, object from)
    {
        object to = Activator.CreateInstance(totype);

        PropertyInfo[] tpis = totype.GetProperties(BindingFlags.Public | BindingFlags.Instance);
        PropertyInfo[] fpis = from.GetType().GetProperties(BindingFlags.Public | BindingFlags.Instance);

        // Go through each property on the "to" object
        Array.ForEach(tpis, tpi =>
        {
            // Find a matching property by name on the "from" object
            PropertyInfo fpi = Array.Find(fpis, pi => pi.Name == tpi.Name);
            if (fpi != null)
            {
                // Do the source and destination have identical types (built-ins)?
                if (fpi.PropertyType == tpi.PropertyType)
                {
                    // Transfer the value
                    tpi.SetValue(to, fpi.GetValue(from, null), null);
                }
                else
                {
                    // If type names are the same (ignoring namespace) copy them recursively
                    if (fpi.PropertyType.Name == tpi.PropertyType.Name)
                        tpi.SetValue(to, Copy(fpi.PropertyType, tpi.GetValue(from, null)), null);
                }
            }
        });

        return to;
    }
}

namespace Rate
{
    partial class WebAuthenticationDetail
    {
        public static implicit operator Ship.WebAuthenticationDetail(WebAuthenticationDetail from)
        {
            return ReflectionCopy.Copy<Ship.WebAuthenticationDetail>(from);
        }
    }

    partial class WebAuthenticationCredential
    {
        public static implicit operator Ship.WebAuthenticationCredential(WebAuthenticationCredential from)
        {
            return ReflectionCopy.Copy<Ship.WebAuthenticationCredential>(from);
        }
    }
}

namespace Ship
{
    partial class WebAuthenticationDetail
    {
        public static implicit operator Rate.WebAuthenticationDetail(WebAuthenticationDetail from)
        {
            return ReflectionCopy.Copy<Rate.WebAuthenticationDetail>(from);
        }
    }

    partial class WebAuthenticationCredential
    {
        public static implicit operator Rate.WebAuthenticationCredential(WebAuthenticationCredential from)
        {
            return ReflectionCopy.Copy<Rate.WebAuthenticationCredential>(from);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T20:07:38.547

您可以通过创建自己的 Address 实现来使用运算符重载，也可以使用其中一种稳定类型作为属性

一个例子：下面的 Address1 和 Address2 将分别是您的 Rate.Address 和 Ship.Address

```
class Address1
{
    public string name = "Address1";
}
class Address2
{
    public string name = "Address2";
}

class GenericAddress
{
    public string name = "GenericAddress";
    public static implicit operator GenericAddress(Address1 a)
    {
        GenericAddress p = new GenericAddress(); p.name = a.name; return p;
    }
    public static implicit operator GenericAddress(Address2 a)
    {
        GenericAddress p = new GenericAddress(); p.name = a.name; return p;
    }
}
class Program
{
    static void Main(string[] args)
    {
        PrintName(new Address1());//prints address1
        PrintName(new Address2());//prints address2
    }

    static void PrintName(GenericAddress a)
    {
        Console.WriteLine(a.name);
    }
} 
```

编辑：方法与上面的帖子相同，实现是在一个单独的类中，仅此而已

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T20:52:03.743

那些生成的类是否定义为“部分”？如果是这样，您可以在不同的文件中扩展它们并提取一个接口并让它由所有地址类实现。

# python - Python 图像库保存函数语法

> ID：562519
> 
> 赞同：13
> 
> 时间：2009-02-18T19:38:57.960
> 
> 标签：python, python-imaging-library

我认为很简单，但基本上我需要知道 PIL 上保存功能的语法是什么。帮助真的很模糊，我在网上找不到任何东西。任何帮助都会很棒，谢谢:)。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-18T19:43:19.697

来自[PIL 手册](http://effbot.org/imagingbook/image.htm#tag-Image.Image.save)：

```
im.save(outfile, options...)

im.save(outfile, format, options...) 
```

最简单的情况：

```
im.save('my_image.png') 
```

管他呢。在这种情况下，图像的类型将根据扩展名确定。你有什么特别的问题吗？或者您想使用但不确定如何使用的特定保存选项？

您可能能够在每个文件类型的文档中找到更多信息。[PIL Handbox 附录](http://effbot.org/imagingbook/pil-index.htm#appendixes)列出了支持的不同文件类型。在某些情况下，为`save`. 例如，在[JPEG 文件格式页面上](http://effbot.org/imagingbook/format-jpeg.htm)，我们被告知保存支持

*   `quality`
*   `optimize`， 和
*   `progressive`

附有关于每个选项的注释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T19:45:19.143

`Image.save(filename[, format[, options]])`. 您通常可以使用`Image.save(filename)`，因为它会自动从扩展名中为您确定文件类型。

# html - css 中的@font-face 声明不起作用

> ID：562524
> 
> 赞同：2
> 
> 时间：2009-02-18T19:40:19.093
> 
> 标签：html, css, fonts, font-face

我正在帮助我姐姐将某人在 Flash 中为她所做的网站转换为 html。

他们在我试图通过@font-face在css文件中定义的flash中使用花哨的字体。我尝试在 Firefox、IE 和 chrome 中打开页面，但在任何地方都看不到正确的字体。

我使用的声明是：

```
@font-face {
  font-family: "VAG Rounded";
  src: url("http://judith.huinink.net/chilax/VAGROUNL.OTF");
} 
```

[http://judith.huinink.net/chilax/index.htm](http://judith.huinink.net/chilax/index.htm)包含 html。

[http://judith.huinink.net/chilax/chilax.css](http://judith.huinink.net/chilax/chilax.css)包含完整的 css。

我检查了我可以下载字体文件，但是当我在浏览器中打开页面时它根本不使用字体。我一定是忽略了什么。有人有什么建议吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-02-04T12:09:58.947

# 字体成为主流

截至 2010 年 1 月，所有主要的新浏览器都支持 font-face

*   野生动物园 3.1
*   IE - 所有版本
*   火狐 3.6
*   铬 4
*   歌剧 10

请参阅[http://webfonts.info/wiki/index.php?title=@font-face_browser_support](http://webfonts.info/wiki/index.php?title=@font-face_browser_support)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-18T19:49:56.683

**更新**

去年，浏览器对字体的支持有了相当显着的提高。我建议阅读[Tim Brown 关于该主题的优秀文章](http://nicewebtype.com/notes/2009/10/30/how-to-use-css-font-face/)，其中详细描述了如何让网络字体在大多数现代浏览器中工作。

**原始答案**

实际上，`@font-face`现在完全无法使用。只有两种浏览器支持它——Windows 版 Internet Explorer，版本 5 或更高版本，以及 Safari 3.1。

更糟糕的是，IE 和 Safari 不支持相同的字体格式。IE 仅支持[EOT](http://en.wikipedia.org/wiki/Embedded_OpenType)，而 Safari 则支持更常见的 TrueType (.ttf) 和 OpenType (.otf) 格式。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-18T19:45:31.797

几乎没有浏览器支持@font-face：[我什么时候可以使用...](http://a.deveria.com/caniuse/#feat=fontface)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-18T19:43:44.407

[http://www.css3.info/preview/web-fonts-with-font-face/](http://www.css3.info/preview/web-fonts-with-font-face/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-16T14:38:56.773

如何在所有支持它的浏览器中使用@font-face：在[Jon Tangerine 的博客上](http://jontangerine.com/log/2008/10/font-face-in-ie-making-web-fonts-work)

[ttf2eot](http://code.google.com/p/ttf2eot)是一个很好的 Unix 和 Windows 字体转换器，所以你不必使用可怕的旧 Microsoft WEFT。它转换整个字体，而不仅仅是一些字符。

[这是](http://shepherd-interactive.com/#about-us/blog/2008/06/cross-browser-web-fonts/#xbwf-sifr)一个与 sIFR 一起使用的 javascript，它为启用 @font-face 的浏览器禁用 sIFR。

Flash 需要消亡，所以这里有另一种 sIFR 的替代方案：[改头换面](http://facelift.mawhorter.net/technology)。这是一个生成图像的服务器端脚本。

afaik all sIFR 替换的问题在于，选择和复制文本并不能真正起作用——您要么看不到选择，要么不可能选择少于一个单词或行。还有使用 <canvas> 的 Cufón，所以它只适用于较新的浏览器，其中大多数都有 @font-face。

做正确的事，现在使用最先进的技术：@font-face 与 TTF 或 OTF，以及 IE 和旧浏览器的后备。最好保持您的 HTML 干净，并在单独的 javascript 和 CSS 文件中实现这些回退。对于 IE，您可能需要使用我上面第一个链接中解释的“条件注释”。对于禁用 javascript 的浏览器，请始终在末尾指定带有网络安全字体的替换字体列表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T14:21:01.583

查看曾经流行的[sIFR](http://www.mikeindustries.com/sifr)或不依赖 Flash 的 [typeface.js](http://typeface.neocracy.org/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-11-17T18:12:33.330

我遇到过必须在域中包含 WWW 的情况。没有它，它就行不通。

# c# - 3.5sp1 中的 HttpWebRequest 超时

> ID：562526
> 
> 赞同：0
> 
> 时间：2009-02-18T19:40:35.257
> 
> 标签：c#, debugging, httpwebrequest, .net-3.5

我们有一个服务可以打开几个 HttpWebRequest。在我们将服务器升级到 .net 3.5sp1 之前，它在 3.0 下运行良好。现在我们在等待请求时超时。（我们已验证端点已启动并正在运行）。

有几件事让这很有趣。增加最大连接数将使其在超时发生之前运行更长时间。此外，一旦我们看到请求等待，如果我们打开 Fiddler，它们都会成功。这些请求通过 Timer 打开（每次调用 Elapsed 委托时都会产生一个新线程），所以我们可能会看到死锁，但代码库没有改变，我们在 3.0 下没有这个问题

我想我的问题是，有没有人有任何关于解决这个问题的提示？sp1 中的 HttpWebRequest 中是否有任何更改会导致我们看到这种行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-19T19:34:27.403

出于存档目的，这里是我们找到的解决方案：

将 KeepAlive 属性设置为 false 似乎可以解决问题，但它确实会稍微减慢每个请求。

# git - Git SVN 偶尔什么也得不到

> ID：562539
> 
> 赞同：3
> 
> 时间：2009-02-18T19:48:22.507
> 
> 标签：git, git-svn

下面的 svn 分支已添加到 .git/config 文件中。

```
[svn远程“svnb02”]
        网址 = https://svn/repos/Project/branches/b02
        获取 = :refs/remotes/git-svn-b02
[svn-远程“svnb03”]
        网址 = https://svn/repos/Project/branches/b03
        获取 = :refs/remotes/git-svn-b03

```

但只能使用以下命令获取“svnb03”：

```
git svn fetch -R svnb03 -r HEAD

```

对于“svnb02”，下面的命令将安静地返回而不获取任何东西。

```
git svn fetch -R svnb02 -r HEAD

```

欢迎任何评论。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T19:40:49.487

如果您的 subversion repo 没有标准布局，其中包含顶级的主干、分支和标签，git svn clone 也会静默失败。如果是这种情况，重组你的 repo 和 git svn clone 应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T20:54:51.700

也许没有设置分支 HEAD。看`.git/remotes/svnb02/HEAD`。如果它丢失或不是最新的，这可能会导致您的问题。

Git 有在这种情况下找到 HEAD 的代码，但显然`git svn`没有；有一个关于这个的[补丁](http://kerneltrap.org/mailarchive/git/2009/2/11/4947884)。

如果没问题，那么我会在配置文件中寻找一个`svn.`或`remote.svn.`变量的奇怪条目，或者在`.git/remotes`目录中寻找一些奇怪的东西。

这都是猜测。一个奇怪的情况通常有一个奇怪的解释。祝你好运。

编辑——我假设`svnb02`当你遇到这个问题时有新的修订。如果有未获取的修订版，您的命令只会从 svn 获取。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-08T17:15:55.827

如果请求的修订 (HEAD) 不在主干上，则会发生这种情况。我们的构建脚本会在构建成功后自动标记源代码，所以在我的情况下，最后一个 svn 修订版很少指向主干，所以我得到了很多。以下脚本将获取主干的最后修改版本并在执行提取时使用它：

```
 #! /bin/sh
URL=$1
# git-svn fails to pull files if specified revision is not in path specified
# so find the last changed revision and use that
REV=$(svn info ${URL}trunk | grep "Last Changed Rev:" | awk '{print $NF}')
[ -n "$REV" ] || {
  echo "Revision not found. Check URL"
  exit 1
}
git svn init "$URL" -s --prefix svn/
git svn fetch -r $REV 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-04T11:32:20.487

注意我是新用户，所以我的回复中只能有一个超链接。假设 BASE 是“ [https://svn/repos/Project](https://svn/repos/Project) ”。

我的回答不是这个问题的直接原因，但它密切相关，几乎可以肯定是一个因素。

问题与您将 SVN 分支视为 git 主干这一事实有关。我发现新版本的 git (1.6+) 不允许您将分支或标签作为 git 主干检出。Git 采用标准布局。在你的情况下，它可能假设。

树干 - {BASE}/trunk/ 分支 - {BASE}/branches/ 标签 - {BASE}/tags/

由于 b02 和 b03 是分支的孩子，因此它认为它们是分支而不是树干。在 1.5.x 后期版本中，我发现行为不是很一致，但在 1.6.x 版本（尤其是 1.6.x 后期版本）中，行为是完全可重现的。

对我来说非常有效的解决方法是明确声明标签和分支 URL：

git svn init -T {BASE}/branches/b03 -b {BASE}/anydir -t {BASE}/tags git svn fetch -r33666 # 其中 33666 是最新版本。

在我建议使用 git svn rebase 之后。

# jquery - .bind 和其他事件的区别

> ID：562548
> 
> 赞同：11
> 
> 时间：2009-02-18T19:51:31.593
> 
> 标签：jquery

以下代码行之间有什么区别，或者它们只是编写相同内容的两种不同方式：

```
$("p").click(function() { some code here });

$("p").bind("click", function(){ some other code here }); 
```

我是否过度简化了这个？因为如果您想绑定多个事件，您可以将事件链接起来，对吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-18T19:57:29.693

它还允许您将相同的匿名方法绑定到多个事件，例如：

```
$("p").bind("click dblclick mouseover mouseout", function(){ some other code here }); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-19T00:39:11.653

另请注意，绑定允许自定义事件

```
$(elem).bind('myEvent', function(){
   alert('myEvent!');
});
$(elem).trigger('myEvent'); //alerts 'myEvent!' 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-18T19:54:50.760

第一个版本只是第二个版本的简写。

# svn - 镜像两个可写 SVN 存储库之间的子文件夹

> ID：562554
> 
> 赞同：2
> 
> 时间：2009-02-18T19:54:01.870
> 
> 标签：svn, synchronization, repository, mirroring

我遇到了涉及我公司的 SVN 服务器的情况。我们将所有重要的代码保存在一个锁定的服务器中（我们称之为“开发”服务器）。有一些文件需要由公司网络之外的用户编辑，所以我们有另一个 SVN 服务器（“全局”服务器），它可以在防火墙外访问，并包含那些包含外部所需文件的目录的副本。如果重要的话，全局服务器的文件夹结构是开发服务器的一个子集（即它只是几个选择的文件/目录，但都具有相同的相对路径等）。如果您想阅读它，我已经在帖子末尾简要解释了*为什么我们要尝试这样做，但相信我，它必须在两个单独的服务器上完成。*

乍一看，`svnsync`这似乎是这项工作的理想选择，但不幸的是，它要求它是唯一修改目标存储库的东西。显然，这不会起作用，因为我们的开发存储库被大量使用。

在我看来，有两种解决方案，它们都不是一个好的解决方案。我希望有人可以帮助我调整其中一个，或者更好地提供替代方案。

1.  我的第一个想法是在开发服务器中使用外部，但这有一些问题。最值得注意的是，外部将遵循头部修订（我们不想将其设置为特定修订，因为这会破坏这一点），因此如果我们提取旧版本的开发存储库，外部定义仍将指向到全局 repo 的负责人，而不是全局 repo 在我们旧版本时代的样子——因此我们将无法简单地通过检查旧版本来重新创建旧版本。
2.  另一种解决方案是让 cron 作业定期从全局存储库中导出最新修订版，并将这些更改的文件覆盖到来自开发存储库的工作副本上，然后提交更改。可能这个覆盖和提交步骤将使用`svn_load_dirs.pl`SVN 自带的脚本。理想情况下，这将作为全局 repo 上的 post-commit 挂钩完成，但同样出于防火墙原因，全局服务器无法访问开发服务器，因此必须由防火墙内的机器执行（可能是开发服务器机器本身） . 这种方法的缺点是：开发服务器可能会在 cron 作业的时间间隔内过期，并且如果有人不小心对开发服务器进行了更改，他们的更改将被踩踏。（顺便说一句，如果有人能想出一种双向同步的方法，那就太棒了！）

我目前倾向于选项 2，因为它似乎让我尽可能接近我需要的东西，但这仍然是一个非常糟糕的选择。这本质上也是我们目前正在做的事情，用人类而不是 cron 工作。我为这篇长文道歉。非常感谢您提供的任何帮助。

**解释为什么：**我们需要这些共享文件存在于开发服务器目录层次结构中，因为它们是我们软件的必需部分，因此构建、测试等必须具有它们。我不能通过防火墙暴露开发服务器——我试图说服那些失败的权力。我已经向决策者明确表示，为此使用两台单独的服务器并不是 SVN 的预期用途，而且可能会出现问题。为了帮助缓解我们已经预见到的一些问题，只有全局服务器是可写的。开发服务器的文件副本在概念上将是只读的（仅在从全局服务器同步更改时修改），但我没有 t 认为我实际上可以使用 SVN 访问控制强制执行该只读策略，因为该目录结构中的某些文件不会存在于全局 repo 中，因此需要在 dev 中可编辑，所以我不能盲目地制作只读的东西。在每个文件的基础上设置只读似乎是不可维护的，因为有数百个并且它们经常被添加和删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T20:16:46.777

您可以尝试设置直写代理，以便将公共存储库上的所有写入自动转发到私有服务器。

我从来没有这样做过，但[这里](http://svnbook.red-bean.com/en/1.5/svn.serverconfig.httpd.html#svn.serverconfig.httpd.extra.writethruproxy)有一些关于这个主题的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-23T03:37:09.423

与其在源代码控制上变得复杂，不如考虑拆分两个存储库（从 dev 中删除存在于 global 中的代码），然后让 dev 的构建消耗 global 的构建。由于您的内部人员将能够同时致力于两者，并且在两者中存在相同的代码永远是困难的。

你没有提到所涉及的语言工具......所以很难知道这将如何适应。考虑在全局发布工件的基础上构建，然后构建全局解决该依赖关系。

您在备选方案 2 中没有提到的一件事是，您将失去审计线索，因为提交给 global 的用户不会是覆盖并提交给 dev 的用户。

# .net - C# 中的协议缓冲区：如何处理盒装值类型

> ID：562558
> 
> 赞同：4
> 
> 时间：2009-02-18T19:55:36.890
> 
> 标签：.net, protocol-buffers, protobuf-net

在以下示例中：

```
public class RowData
{
    public object[] Values;
}

public class FieldData
{
    public object Value;
} 
```

我很好奇 protobuf-net 或 dotnet-protobufs 将如何处理这些类。我对protobuf-net比较熟悉，所以我实际拥有的是：

```
[ProtoContract]
public class RowData
{
    [ProtoMember(1)]
    public object[] Values;
}
[ProtoContract]
public class FieldData
{
    [ProtoMember(1)]
    public object Value;
} 
```

但是，我收到一条错误消息，提示“未找到合适的默认对象编码”。有没有一种简单的方法来处理这些课程，我只是不知道？

要详细说明用例：

这是远程处理中使用的数据类的缩小版本。所以基本上它看起来像这样：

```
FieldData data = new FieldData();
data.Value = 8;

remoteObject.DoSomething(data); 
```

注意：为简单起见，我省略了 ISerializable 实现，但正如您所期望的那样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T21:04:28.690

重新 protobuf-net，我维护：

这里的问题不是值类型（它通常可以很好地处理） - 它是开放`object`使用，这意味着它根本不知道期望什么数据，因此不知道如何编码/解码它。

目前，我想不出一种简单/干净的方法来处理它。它将处理一系列常见的值类型场景、列表和任何基于契约（数据契约、原型契约或一些 xml 模式）的层次结构，但它需要一个*线索*。

也许如果你能澄清用例，我可能会提供更多帮助？例如，上面的内容不能很好地使用`DataContractSerializer`或者`XmlSerializer`......

重新 dotnet-protobufs; 我无法真正发表评论，但我敢肯定它会更不宽容；它旨在与从 .proto 文件生成的类一起使用，因此`object`永远不会进入模型（乔恩：如果我错了，请纠正我）。

如果你留下更多信息，你能在这里发表评论吗？所以我可以很容易地找到它......或者，直接给我发邮件（请参阅我的 SO 个人资料）。

* * *

编辑-这是我想到的骇人听闻的事情-目前无法正常工作，但明天（可能）我会弄清楚原因。请注意，理论上额外的成员都可能是私有的 - 我只是想在调试时让它变得容易。请注意，这不会占用任何额外的存储空间。就像我说的，它今天不起作用，但它应该 - 我会找出原因......

```
[ProtoContract]
public class FieldData
{
    public object Value {get;set;}

    [ProtoMember(1)]
    public int ValueInt32 {
        get { return (int)Value; } set { Value = value; } }
    public bool ValueInt32Specified {
        get { return Value != null && Value is int; } set { } }

    [ProtoMember(2)]
    public float ValueSingle {
        get { return (float)Value; } set { Value = value; } }
    public bool ValueSingleSpecified {
        get { return Value != null && Value is float; } set { } }

    // etc for expected types
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-19T05:41:33.440

（更新）

对; 想通了...上面示例中的主要问题是价值获取者；他们正在抛出异常。还有一些图书馆故障（[现已修复](http://code.google.com/p/protobuf-net/downloads/)）。

但是，最简单的方法是`Nullable<T>`传递属性：

```
 [ProtoMember(1)]
    private int? ValueInt32
    {
        get { return Get<int>(); }
        set { Value = value; }
    } 
```

等，与：

```
 private T? Get<T>() where T : struct
    {
        return (Value != null && Value is T) ? (T?)Value : (T?)null;
    } 
```

这和 *Specified 方法都已经过[测试](http://code.google.com/p/protobuf-net/source/browse/trunk/Examples/ValueWrapper.cs)，现在可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T23:29:25.457

这就像我的想法一样。让我知道你的想法。自然，我必须为我需要支持的每种值类型添加一个子类。你怎么看？有没有更好的方法，您是否发现这种方法效率低下？

```
[ProtoContract, Serializable]
[ProtoInclude(1, typeof(Int32FieldData))]
public abstract class FieldDataBase : ISerializable
{
    [ProtoIgnore]
    public abstract object Value { get; set;}
    protected FieldDataBase()
    { }

    #region ISerializable Members
    protected FieldDataBase(SerializationInfo info, StreamingContext context)
    {
        Serializer.Merge<FieldDataBase>(info, this);
    }
    public void GetObjectData(SerializationInfo info, StreamingContext context)
    {
        Serializer.Serialize<FieldDataBase>(info, this);
    }

    #endregion
}

[ProtoContract, Serializable]
public class Int32FieldData : FieldDataBase
{
    [ProtoMember(1)]
    public int? Int32Value;

    [ProtoIgnore]
    public override object Value
    {
        get { return this.Int32Value.HasValue ? this.Int32Value : null; }
        set { this.Int32Value = (int?)value; }
    }
    public Int32FieldData() { }
    protected Int32FieldData(SerializationInfo info, StreamingContext context)
        :base(info, context)
    { }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T01:35:05.653

直接封装似乎可以正常工作，而所有属性都没有额外的开销，方式如下：

```
[ProtoContract, Serializable]
public class ObjectWrapper : ISerializable
{
    public ObjectWrapper()
    { }
    [ProtoIgnore]
    public object Value
    {
        get
        {
            if (Int32Value.HasValue)
                return Int32Value.Value;
            else if (BinaryValue != null)
                return BinaryValue;
            else
                return StringValue;
        }
        set
        {
            if (value is int)
                this.Int32Value = (int)value;
            else if (value is byte[])
                this.BinaryValue = (byte[])value;
            else if (value is string)
                this.StringValue = (string)value;
        }
    }
    [ProtoMember(1)]
    private int? Int32Value;
    [ProtoMember(2)]
    private string StringValue;
    [ProtoMember(3)]
    private byte[] BinaryValue;
            // etc

    #region ISerializable Members
    protected ObjectWrapper(SerializationInfo info, StreamingContext context)
    {
        Serializer.Merge<ObjectWrapper>(info, this);
    }
    public void GetObjectData(SerializationInfo info, StreamingContext context)
    {
        Serializer.Serialize<ObjectWrapper>(info, this);
    }

    #endregion
} 
```

# java - Struts 索引属性——没有找到属性的 getter 方法

> ID：562559
> 
> 赞同：0
> 
> 时间：2009-02-18T19:55:42.257
> 
> 标签：java, struts

因此，在 struts 中，我有一个具有 5 个属性的动作表单。每个属性都是一个字符串数组。

在我的表单类中，我获取以下属性的 getter/setter 方法：

```
public String getPropertyX(int index) {
  return x[index];
}

public void setPropertyX(int index, String value) {
  x[index] = value; 
} 
```

当我的表单第一次被处理时，我填充表单对象，当它显示相应的 JSP 时，我可以修改它，以便它使用 struts 标记输出正确的值并获取每个数组的正确值。但是，我希望这些是输入，因此当我提交表单时，将为我填充对象/数组。但是，在提交表单时，我收到“错误 500：没有属性的 getter 方法”。当我将以下内容添加到我的表单对象时，我不再收到该错误：

```
public String getPropertyX() {
   return x;
} 
```

我不再收到该错误，但现在当我处理表单时，后端出现人口错误。我可以用另一种方式来做，但我更愿意使用 struts 框架（我在这里学习）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T21:53:13.423

我自己想出来的。决定走一条完全不同的路。创建了两个 ActionForm（不确定第二个是否需要成为 ActionForm，但它可以工作）。一个包含我要在表单的每一行上填充的表单中的实际元素。另一个包含另一个的数组。我遍历 jsp 上的数组并在输入上使用 indexed="true" 来实现我想要的。

# java - JNDI 失败并出现 NameNotFoundException

> ID：562570
> 
> 赞同：3
> 
> 时间：2009-02-18T19:58:44.573
> 
> 标签：java, jndi

我正在为内部库（创建者已经消失）编写回归测试，并且正在尝试验证环境。仅当 jndi 名称为“复杂”时，一些测试才会因 NameNotFoundException 而失败。

这是一个独立的应用程序，不与任何 Web 容器一起运行。该应用程序使用首选项文件，并且不涉及 LDAP。环境是 Java v1.4，应用程序安装了所有必要的本地库。（带有 jndi.jar、jms.jar 等的 lib 目录）。很简单，对吧？

由于库的复杂性以及它如何处理大量对象，我进行了一个简单的测试，然后增加了每个部分的复杂性作为单独的测试。

设置：文件：c:\data\eclipse\workspace\APP\testfiles\jndi\jms\label\.bindings
在文件中有这个条目：QRep​​ly/FactoryName=com.ibm.mq.jms.MQQueueFactory

UnitTest 类：“简单”测试有

```
Hashtable ht = new Hashtable();
ht.put(Context.PROVIDER_URL, 
    "file:/data/eclipse/workspace/APP/testFiles/jndi/jms/label/");
ht.put(Context.INITIAL_CONTEXT_FACTORY, 
    "com.sun.jndi.fscontext.RefFSContextFactory");
ht.put(Context.SECURITY_AUTHENTICATION, "none");
Context ctx;
try {
  ctx = new InitialContext(ht);
  String jndiName = "QReply";
  logger.debug("testFindRemoteObject_Simple", 
       "Invoking InitialContext.lookup(\"" + jndiName + "\")");
  Object remoteObject = ctx.lookup(jndiName);
  assertTrue(remoteObject != null);
} catch (NamingException e) {
  e.printStackTrace();
  fail(e.getMessage());
} 
```

这通过了。因为我在使用库时遇到了很多麻烦，所以我创建了另一个与传入的实际数据匹配的测试；Provider URL 被缩短并且 jndi 名称选择一个“路径”。

“实际”数据单元测试：

```
final Hashtable ht = new Hashtable();
ht.put(Context.PROVIDER_URL, 
   "file:/data/eclipse/workspace/APP/testFiles/jndi/");
ht.put(Context.INITIAL_CONTEXT_FACTORY, 
   "com.sun.jndi.fscontext.RefFSContextFactory");
ht.put(Context.SECURITY_AUTHENTICATION, "none");
Context ctx;
try {
  ctx = new InitialContext(ht);
  String jndiName = "jms/label/QReply";
  logger.debug("testFindRemoteObject_Actual", 
           "Invoking InitialContext.lookup(\"" + jndiName + "\")");
  Object remoteObject = ctx.lookup(jndiName);
  assertTrue(remoteObject != null);
} catch (NamingException e) {
  e.printStackTrace();
  fail(e.getMessage());
} 
```

哪个失败了

```
javax.naming.NameNotFoundException: jms/label/QReply
at com.sun.jndi.fscontext.RefFSContext.getObjectFromBindings(
      RefFSContext.java:400)
at com.sun.jndi.fscontext.RefFSContext.lookupObject(RefFSContext.java:327)
at com.sun.jndi.fscontext.RefFSContext.lookup(RefFSContext.java:146)
at com.sun.jndi.fscontext.FSContext.lookup(FSContext.java:127)
at javax.naming.InitialContext.lookup(InitialContext.java:347)
at com.advo.tests.services.UnitTestServiceLocator.testFindRemoteObject_Actual(
           UnitTestServiceLocator.java:85) 
```

其中 UnitTestServiceLocator.java:85 是 ctx.lookup(jndiname) 的行；

为什么简单的测试会通过，而更复杂的测试会失败？两者都使用指向 lib 目录的类路径，该目录填充有 jms 和 mq jar（以及其他内容）。

复杂的测试匹配库将填充的内容，但使用魔法作为传入的值。库代码还有“几行”可以从首选项文件中提取魔法值。我错过了什么？库代码将在服务器上运行，但在我的笔记本电脑上失败（开发时）。

我什至创建了另一个 jndi 路径——以防第一个测试搞砸了第二个。仍然失败。

由于我没有任何愿望（或更改库代码的权限），因此调用 InitialContext(X); 就是这样，因为图书馆就是这样做的。我已经看到了其他没有通过 InitialContext 传递的示例，我很困惑为什么这样会更好。

更新：我在 linux java1.5 上创建了一个 jndi_test 项目，并且成功运行了失败的测试。采用相同的源并将其移动到 Windows 环境 - 测试失败。由于 linux 上没有 C 盘但数据文件相同，因此类路径有一些更改。（嗯分隔符问题？）

我还发现如果我要在 1.5 上运行该库，我会遇到问题，但这是一个附带问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T21:38:33.240

我认为您与 JNDI 名称混淆了。

“QReply”是 JNDI 名称。你甚至这样说：

> 在文件中有这个条目：QRep​​ly/FactoryName=com.ibm.mq.jms.MQQueueFactory

如果条目是：“jms/label/QReply”，那么您的第二个测试将起作用。

# css - 两列 CSS 布局问题——在 IE6 中，内容区域中的表格被左侧导航向下推

> ID：562575
> 
> 赞同：0
> 
> 时间：2009-02-18T19:59:40.170
> 
> 标签：css, internet-explorer, internet-explorer-6

我有一个在 IE6 中无法正确显示的非常简单的页面。在此浏览器中，左侧导航会下推内容区域中的表格。谁能帮我让表格保持在它应该在的容器顶部，而不是被左侧 div 中的内容推下？

这是页面的html代码：

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <style type="text/css" media="screen">
            body

            #nav
            {
                float: left;
                width: 180px;
                background-color: #999;
            }

            #content
            {
                margin-left: 210px;
                background-color: #999;
            }

        </style>
    </head>
    <body>

        <div id="nav">
            <div>left content</div>
        </div>
        <div id="content">
            <table style="width: 100%; background-color: #666666">
            <tr><td>table</td>
            </tr>
            </table>
        </div>
    </body>
</html> 
```

这是一个网址，因此您可以看到它的样子：

[http://www.morganpackard.com/cssTest.html](http://www.morganpackard.com/cssTest.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T20:26:57.563

改为给您的表格设置 99% 的宽度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T20:45:01.437

另一种解决方案是使表格向左浮动并具有 100% 的宽度....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T20:04:12.140

您也可以使内容向左浮动：

```
 #content
 {
     float:left;
     ...
 } 
```

不要忘记调整margin-left

* * *

其他对其他浏览器不太适用的解决方案：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
        <head>
                <style type="text/css" media="screen">

                        #nav
                        {
                                float: left;
                                width: 180px;
                                background-color: #999;
                        }

                        #content
                        {
                                float: right;
                        }

                </style>
        </head>
        <body>
            <div id="container">
                <div id="nav">
                        <div>left content</div>
                </div>
                <div id="content">
                        <table style="width: 100%; background-color: #666666">
                        <tr><td>table</td>
                        </tr>
                        </table>
                </div>
            </div>
        </body>
</html> 
```

注意容器和浮动：对；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T20:29:33.563

如果一切都失败了，请使用 CSS 纯粹主义者的表格布局 *ducks and cover*：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
        <head>
                <style type="text/css" media="screen">

                        #nav
                        {
                            width: 180px;
                            background-color: #999;
                        }

                        #content
                        {
                            background-color: #999;
                        }

                </style>
        </head>
        <body>
            <table style="width:100%;">
                <tr>
                    <td id="nav">
                        <div>left content</div></td>

                    <td id="content">
                        <table style="width: 100%; background-color: #666666">
                        <tr><td>table</td>
                        </tr>
                        </table></td>
                </tr>
            </table>
        </body>
</html> 
```

# .net - ASP.NET MVC 缺少 htmlhelpers

> ID：562577
> 
> 赞同：0
> 
> 时间：2009-02-18T20:00:38.063
> 
> 标签：.net, asp.net, asp.net-mvc

我一直在阅读有关图像的 html 帮助程序和许多其他有用控件的信息。问题是我在智能感知中只得到了一些。我只得到大约 18 个，它们似乎都是面向形式的（单选按钮、下拉列表、beginform 等）

我的 web.config 有以下内容：

```
<assemblies>
    <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
    <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add assembly="System.Web.Abstractions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add assembly="System.Web.Routing, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add assembly="System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
    <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
    <add assembly="System.Data.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
  </assemblies>
  <namespaces>
    <add namespace="System.Web.Mvc"/>
    <add namespace="System.Web.Mvc.Ajax"/>
    <add namespace="System.Web.Mvc.Html"/>
    <add namespace="System.Web.Routing"/>
    <add namespace="System.Linq"/>
    <add namespace="System.Collections.Generic"/>
  </namespaces> 
```

那根本没有帮助。我正在使用 RC 构建的默认启动项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T10:18:08.517

[ASP.NET MVC Futures](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471)项目是其余控件所需要的。

这包含其他地方提到的 Microsoft.Web.Mvc 命名空间。这是一个实验版本，因此不包含在主库或安装程序中。

过去，随着元素的成熟，元素已经从 Microsoft.Web.Mvc 转移到 System.Web.Mvc。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T20:05:41.450

其中一些位于实验程序集 Microsoft.Web.Mvc 中。在您的项目中引用它，将其添加到 web.config 中的命名空间。

# sql-server - 您如何判断下一个身份列将是什么？

> ID：562578
> 
> 赞同：7
> 
> 时间：2009-02-18T20:01:17.250
> 
> 标签：sql-server, tsql, identity

是否有一个 tsql 查询来告诉它期望用于下一行插入的 SQL 服务器标识列值？

**编辑添加：**

我删除并重新创建了一个表

```
[personID] [int] IDENTITY(1,1) NOT NULL 
```

作为我的 CREATE TABLE 命令的一部分。我还尝试在删除该表中的所有信息时重新设置标识列，但这并不总是有效。这让我想知道是否有办法查看 SQL 预期将用于您的下一个身份列号。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-18T20:21:33.753

您可能希望使用 SCOPE_IDENTITY 而不是 @@IDENTITY 将其限制为当前范围内的标识值。这避免了触发器将新的标识值插入到其他表中，而不是刚刚插入的表中。

但是你可以计算下一个身份值是多少

```
SELECT IDENT_CURRENT('mytable') + IDENT_INCR('mytable') FROM mytable 
```

问题是你不能保证这是价值。您必须有一个锁，以便在运行时拒绝表上的其他插入，以确保值是准确的。此外，在你用完 32 位整数之后，我不知道逻辑是什么。不知道是翻车还是失败。

编辑：我刚刚对此进行了测试（参见下面的 SQL），当没有数据时它不会返回正确的值。使用 DBCC CHECKIDENT ('tablename', RESEED, 200) 重新播种实际上导致下一个值是 201 而不是 200。

```
CREATE TABLE willtest (myid integer IDENTITY(1,1), myvalue varchar(255))

SELECT IDENT_CURRENT('willtest') + IDENT_INCR('willtest')

INSERT INTO willtest (myvalue)
VALUES ('1')
INSERT INTO willtest (myvalue)
VALUES ('2')
INSERT INTO willtest (myvalue)
VALUES ('3')
INSERT INTO willtest (myvalue)
VALUES ('4')
INSERT INTO willtest (myvalue)
VALUES ('5')
INSERT INTO willtest (myvalue)
VALUES ('6')
INSERT INTO willtest (myvalue)
VALUES ('7')
INSERT INTO willtest (myvalue)
VALUES ('8')

SELECT IDENT_CURRENT('willtest') + IDENT_INCR('willtest')

DBCC CHECKIDENT ('willtest', RESEED, 200)

SELECT IDENT_CURRENT('willtest') + IDENT_INCR('willtest')

INSERT INTO willtest (myvalue)
VALUES ('200')
INSERT INTO willtest (myvalue)
VALUES ('201')
INSERT INTO willtest (myvalue)
VALUES ('202')
INSERT INTO willtest (myvalue)
VALUES ('203')
INSERT INTO willtest (myvalue)
VALUES ('204')
INSERT INTO willtest (myvalue)
VALUES ('205')
INSERT INTO willtest (myvalue)
VALUES ('206')
INSERT INTO willtest (myvalue)
VALUES ('207')

SELECT IDENT_CURRENT('willtest') + IDENT_INCR('willtest')

SELECT * FROM willtest

DROP TABLE willtest 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-18T20:04:51.437

不，没有任何*保证*的方法（尽管您当然可以找出下一个值*可能*是什么，但另一个命令可能会在您使用它之前先使用它）。您可以检索的唯一保证值是*先前*插入的标识值[`SCOPE_IDENTITY()`](http://msdn.microsoft.com/en-us/library/ms190315.aspx)（它将返回为当前范围最后生成的标识值）。

值得怀疑的是，为什么人们需要知道之前的值（当使用自动递增的种子标识列时）。

如果您需要知道之前的值，那么我建议您自己生成 id。您可以使用以表名作为键的 ids 表来执行此操作，或者，如果您有可伸缩性问题（并且您正在使用事务），您可以为每个需要 id 的表创建一个 id 表，该表将插入 id (并随后增加）。

或者，您可以使用 GUID，您可以轻松地在客户端生成这些，然后再将其发送到您的数据库。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-18T23:02:06.550

这段 sql 会给你下一个标识列值（可能有很多原因不在生产代码中重复这个片段）

```
declare @nextid int;
declare @previousid int;

begin tran

 insert into dbo.TestTable (Col1) values ('11');
 select @nextid = SCOPE_IDENTITY(); 

rollback tran

 select @previousid = @nextid -1
 DBCC CHECKIDENT('dbo.TestTable', RESEED, @previousid);
 select @nextid 
```

这个 stackoverflow 问题提供了一些额外的信息 - [sql-identity-autonumber-is-incremented-even-with-a-transaction-rollback](https://stackoverflow.com/questions/282451/sql-identity-autonumber-is-incremented-even-with-a-transaction-rollback)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-09T06:32:04.087

```
SELECT IDENT_CURRENT('mytable') + IDENT_INCR('mytable') FROM mytable 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-18T20:20:07.580

由于您从 1 开始播种并增加 1 (IDENTITY(1,1))，我想知道您是否可以创建一个过程，您可以在其中设置一个变量，如“Select @@IDENTITY + 1”或类似的东西。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-18T20:24:06.057

使用`GUID`列作为主键。除非您每秒有数十亿条记录和数千个请求，否则您可能不会注意到性能差异。但除非你喜欢花太多时间处理这样的愚蠢问题，否则你会注意到压力水平和预期寿命的差异。

# sql - 缺少关键字错误

> ID：562579
> 
> 赞同：0
> 
> 时间：2009-02-18T20:01:33.083
> 
> 标签：sql, oracle, ora-00905

嗨，我在尝试创建此表时收到此错误。你能告诉我如何在更新级联和删除集空约束上使用。

```
SQL> create table emp3
  2  (
  3  Fname               varchar2(15)not null,
  4  Minit               char,
  5  Lname               varchar(15) NOT NULL,
  6  Ssn                 char(9)     NOT NULL,
  7  Bdate               DATE,
  8  Address             varchar(30),
  9  Sex                 char,
 10  Salary              decimal(10,2),
 11  Super_ssn           char(9) not null,
 12  Dno                 int    default 1 not null,
 13  CONSTRAINT employee PRIMARY KEY (ssn),
 14  CONSTRAINT employeeSUPER FOREIGN KEY(Super_ssn) REFERENCES emp3(Ssn) ON UPD
ATE CASCADE  ON DELETE SET NULL );
CONSTRAINT employeeSUPER FOREIGN KEY(Super_ssn) REFERENCES emp3(Ssn) ON UPDATE C
ASCADE  ON DELETE SET NULL )
                                                                        *
ERROR at line 14:
ORA-00905: missing keyword 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T20:09:20.960

Oracle 没有“ON UPDATE CASCADE”。所以解析器期望在你有 UPDATE 的地方看到 DELETE 关键字，因为那是在那个位置应该跟随 ON 的唯一关键字。

# .net - 将用户添加到活动目录中的安全组

> ID：562585
> 
> 赞同：2
> 
> 时间：2009-02-18T20:02:59.867
> 
> 标签：.net, vb.net, active-directory

**使用任何 .NET 框架**

我能够创建安全组，但是当我尝试从同一个域中添加用户时，我得到一个错误。

使用`System.DirectoryServices.AccountManagement`：

```
TheGroup = GroupPrincipal.FindByIdentity(SecurityContext, "GROUPNAME")
TheGroup.Members.Add(SecurityContext, IdentityType.SamAccountName, "username")
TheGroup.Save() 
```

一切都适用于创建和获取现有组。添加成员也可以，但是当我尝试保存对组所做的更改时，我收到此错误：

> 无法检索有关域的信息 (1355)。

现在不使用`DirectoryServices.AccountManagement`：

```
Dim dGroup As DirectoryEntry = GetDirectoryEntry(GroupPath, UserName, Password)
dGroup.Properties("member").Add(nUser.Path)
dGroup.CommitChanges()
dGroup.Close() 
```

再次以这种方式创建/删除组工作正常，但是当我尝试将确实存在的成员添加到创建的组时，我收到此错误：

> 服务器不愿意处理请求。（来自 HRESULT 的异常：0x80072035）

**进入运行 AD 本身的服务器，我可以添加组并将用户放入其中。我正在使用相同的凭据。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T21:24:46.613

只是猜测：您可能会收到此错误，因为您尝试添加到安全组的用户没有遵循您的域密码策略的密码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T20:14:07.227

叹息，我解决了我的问题。

我正在连接到我们的 1 个开发 AD 服务器的 prod 工作站上进行此工作。我决定从我的开发工作站运行该项目，一切正常。

# c++ - 使用 enum/int 覆盖函数

> ID：562588
> 
> 赞同：3
> 
> 时间：2009-02-18T20:04:01.143
> 
> 标签：c++, inheritance, compiler-construction, enums

如果有一个基类 DeriveMe 有一个函数`virtual void DoSomething(int)`和一个继承 DeriveMe 的类，称为 DerivedThat，它有一个函数`void DoSomething(SomeEnum)`...... DerivedThat 是否会覆盖基类 DoSomething，因为枚举在 C++ 的编译期间评估为整数？

我可以通过将 DoSomething 设为纯虚拟并编译/运行它以查看它是否有效，但这是我的第一个 stackoverflow 问题，所以我宁愿问它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-18T20:15:53.907

不，`DerivedThat`将*隐藏*基类中的函数，因为签名不匹配。`enum`s*不*计算为`int`，因为它们是*不同的类型*。

请参阅 C++ FAQ，第[23.9](http://www.parashift.com/c++-faq-lite/strange-inheritance.html#faq-23.9)和[29.19](http://www.parashift.com/c++-faq-lite/newbie.html#faq-29.19)节。

# visual-studio - 非调试模式时在 Visual Studio 的输出窗口中显示消息？

> ID：562590
> 
> 赞同：60
> 
> 时间：2009-02-18T20:04:06.073
> 
> 标签：visual-studio

在 Java 中，您可以使用`System.out.println(message)`将消息打印到输出窗口。

Visual Studio 中的等价物是什么？

我知道当我处于调试模式时，我可以使用它在输出窗口中查看消息：

```
Debug.WriteLine("Debug : User_Id = "+Session["User_Id"]);
System.Diagnostics.Trace.WriteLine("Debug : User_Id = "+Session["User_Id"]); 
```

如果不在 Visual Studio 中进行调试，如何做到这一点？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-10-05T07:18:19.177

结果不在输出窗口中，而是在测试结果详细信息中（底部的测试结果窗格，右键单击测试结果并转到测试结果详细信息）。

这适用于 Debug.WriteLine 和 Console.WriteLine。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-18T20:07:09.933

即使您未处于调试模式，跟踪消息也可能出现在输出窗口中。您只需确保定义了 TRACE 编译器常量。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-18T20:11:55.977

Trace.WriteLine 方法是一种条件编译方法。这意味着只有在编译代码时定义了 TRACE 常量时才会执行它。默认情况下，在 Visual Studio 中，TRACE 仅在 DEBUG 模式下定义。

右键单击项目并选择属性。转到编译选项卡。选择 Release 模式并将 TRACE 添加到定义的预处理器常量。那应该可以为您解决问题。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-10-16T21:46:22.007

这整个线程混淆了我的 h#$l 直到我意识到***你必须运行调试器才能看到任何跟踪或调试输出***。我需要一个调试输出（在调试器之外），因为我的 WebApp 在我调试时运行良好，但在调试器未运行时运行良好（通过调试器运行时正确实例化了 SqlDataSource）。

仅仅因为当您在发布模式下运行时可以看到调试输出***并不***意味着如果您没有运行调试器，您将看到任何内容。仔细阅读[写入 Visual Studio 的输出窗口？](https://stackoverflow.com/questions/9466838/writing-to-output-window-of-visual-studio)给了我[DebugView](http://technet.microsoft.com/en-gb/sysinternals/bb896647.aspx)作为替代方案。*非常有用！*

希望这可以帮助其他对此感到困惑的人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-29T07:18:45.437

对我来说，这是 debug.writeline 显示在立即窗口中的事实，而不是输出。我默认安装的 VS2013 甚至没有显示打开立即窗口的选项，因此您必须执行以下操作：

```
Select Tools -> Customize 
Commands Tab
View | Other Windows menu bar dropdown
Add Command...
The Immediate option is in the Debug section. 
```

一旦你确定了，你可以去查看 -> 其他窗口并选择即时窗口，嘿，所有的调试输出都可以看到。

对我来说不幸的是，它还显示了大约 50 个我在项目中没有意识到的错误......也许我会再次将其关闭 :-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-06T14:52:47.560

为了在 Visual Studio 输出窗口中写入，我使用了`IVsOutputWindow`和`IVsOutputWindowPane`. 我包括在我的`OutputWindow`班级中，看起来像这样：

```
public class OutputWindow : TextWriter
{
  #region Members

  private static readonly Guid mPaneGuid = new Guid("AB9F45E4-2001-4197-BAF5-4B165222AF29");
  private static IVsOutputWindow mOutputWindow = null;
  private static IVsOutputWindowPane mOutputPane = null;

  #endregion

  #region Constructor

  public OutputWindow(DTE2 aDte)
  {
    if( null == mOutputWindow )
    {
      IServiceProvider serviceProvider = 
      new ServiceProvider(aDte as Microsoft.VisualStudio.OLE.Interop.IServiceProvider);
      mOutputWindow = serviceProvider.GetService(typeof(SVsOutputWindow)) as IVsOutputWindow;
    }

    if (null == mOutputPane)
    {
      Guid generalPaneGuid = mPaneGuid;
      mOutputWindow.GetPane(ref generalPaneGuid, out IVsOutputWindowPane pane);

      if ( null == pane)
      {
        mOutputWindow.CreatePane(ref generalPaneGuid, "Your output window name", 0, 1);
        mOutputWindow.GetPane(ref generalPaneGuid, out pane);
      }
      mOutputPane = pane;
    }
  }

  #endregion

  #region Properties

  public override Encoding Encoding => System.Text.Encoding.Default;

  #endregion

  #region Public Methods

  public override void Write(string aMessage) => mOutputPane.OutputString($"{aMessage}\n");

  public override void Write(char aCharacter) => mOutputPane.OutputString(aCharacter.ToString());

  public void Show(DTE2 aDte)
  {
    mOutputPane.Activate();
    aDte.ExecuteCommand("View.Output", string.Empty);
  }

  public void Clear() => mOutputPane.Clear();

  #endregion
} 
```

如果你有一个大文本要在输出窗口中写入，你通常不想冻结 UI。为此，您可以使用`Dispatcher`. 现在要使用这个实现在输出窗口中写一些东西，你可以简单地这样做：

```
Dispatcher mDispatcher = HwndSource.FromHwnd((IntPtr)mDte.MainWindow.HWnd).RootVisual.Dispatcher;

using (OutputWindow outputWindow = new OutputWindow(mDte))
{
  mDispatcher.BeginInvoke(DispatcherPriority.Normal, new Action(() =>
  {
    outputWindow.Write("Write what you want here");
  }));
} 
```

# unicode - SMTP 和 Unicode/UTF-8 字符...？我如何发送它们？base64 一切？

> ID：562600
> 
> 赞同：2
> 
> 时间：2009-02-18T20:07:07.283
> 
> 标签：unicode, utf-8, smtp

使用 SMTP，如何发送 Unicode/UTF-8 电子邮件？

我是否希望对 UTF-8 正文进行 base64 编码并在 MIME 标头中指定它或...？标题呢？

我敢肯定在某处有一个标准来描述这个......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T20:11:53.637

查看[RFC 2047](https://www.rfc-editor.org/rfc/rfc2047)。

# php - 正则表达式检查字符串是否有不匹配的括号？

> ID：562606
> 
> 赞同：21
> 
> 时间：2009-02-18T20:08:06.627
> 
> 标签：php, regex

在 PHP 脚本中，我应该使用什么正则表达式来检查字符串中不匹配的括号？我想允许的事情包括：

*   还行吧）
*   还行吧）

我想防止的事情：

*   这是不好的（
*   这也是（坏
*   这是（坏的（太）

谢谢！

更新：你们都摇滚。使用正则表达式执行此操作似乎比应有的要复杂，而这些 2 级答案使 stackoverflow 变得美丽。感谢您的链接和伪代码。我不知道该给谁答案，所以我向所有我不能接受答案的人道歉。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-18T20:17:47.693

正则表达式不是适合这项工作的工具。手动扫描字符串。

伪代码：

```
depth = 0
for character in some_string:
    depth += character == '('
    depth -= character == ')'
    if depth < 0:
       break

if depth != 0:
   print "unmatched parentheses" 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-18T20:39:24.163

您*可以*使用正则表达式来做到这一点——PHP 使用的 PCRE 允许递归模式。PHP 手册提供了一个几乎正是您想要的[示例：](http://php.net/manual/en/regexp.reference.php#regexp.reference.recursive)

```
\(((?>[^()]+)|(?R))*\) 
```

只要它以括号开头和结尾，它就会匹配任何正确带括号的子字符串。如果你想确保整个字符串是平衡的，允许像“wiggedy(wiggedy)(wiggedy(wack))”这样的字符串，这就是我想出的：

```
^((?:[^()]|\((?1)\))*+)$ 
```

这是对该模式的解释，它可能比模糊更具有启发性：

```
^ 字符串的开头
（启动“平衡子串”组（递归调用）
  (?: 启动“最小平衡子串”组
    [^()] 最小平衡子串是非括号字符
    | 或者
    \((?1)\) 一组包含平衡子串的括号
  ) 完成“最小平衡子串”组
  * 我们的平衡子串是最小的最大序列
              平衡子串
  + 一旦我们匹配了一个最大序列就不要回溯
) 完成“平衡子串”模式
$ 字符串结尾

```

这类正则表达式需要考虑很多效率和正确性。当心。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-18T20:10:15.653

使用正则表达式是不可能做到这一点的。大括号匹配需要正则表达式中不可用的递归/计数功能。为此，您需要一个解析器。

此处提供更多详细信息：http: [//blogs.msdn.com/jaredpar/archive/2008/10/15/regular-expression-limitations.aspx](http://blogs.msdn.com/jaredpar/archive/2008/10/15/regular-expression-limitations.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-18T20:19:01.390

您的示例不包含任何嵌套括号……如果您不关心嵌套，则可以使用以下表达式来完成：

```
^[^()]*(?:\([^()]*\)[^()]*)*$ 
```

这将与“允许”列表中的所有字符串匹配，并与“阻止”列表中的字符串匹配。但是，**对于任何带有嵌套括号的字符串，它也会失败**。例如“这（是（不）好的）”

正如其他人已经指出的那样，如果您需要处理嵌套，正则表达式不是正确的工具。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-18T20:21:06.733

同意使用正则表达式这是不可能的事实。不过，您可以执行以下操作：

```
<?php

$testStrings = array( 'This is (ok)', 'This (is) (ok)', 'This is )bad(', 'This is also (bad', 'This is (bad (too)' );

foreach( $testStrings as $string ) {
    $passed = hasMatchedParentheses( $string ) ? 'passed' : 'did not pass';
    echo "The string $string $passed the check for matching parenthesis.\n";
}

function hasMatchedParentheses( $string ) {
    $counter = 0;
    $length = strlen( $string );
    for( $i = 0; $i < $length; $i ++ ) {
        $char = $string[ $i ];
        if( $char == '(' ) {
            $counter ++;
        } elseif( $char == ')' ) {
            $counter --;
        }
        if( $counter < 0 ) {
            return false;
        }
    }
    return $counter == 0;
}

?> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-18T20:15:22.927

为了扩展 JaredPar 的答案，不使用正则表达式并不难解决，只需编写一个函数来检查字符串中的每个字符并增加/减少一个计数器。如果找到“（”，则增加它，如果找到“）”，则减少它。如果计数器低于 0，则可以中断，字符串无效。处理完整个字符串后，如果计数器不为 0，则存在不匹配的左括号。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-18T20:33:12.337

**为什么用正则表达式不可能**

其他答案都是正确的，但我只想为理论计算机科学加上一个插件……这是一个知道理论会带来实际实际优势的情况。

正则表达式对应于确定性有限自动机 (DFA)，但括号匹配需要上下文无关文法，该文法可以实现为有限自动机 (PDA)，但不能通过 DFA 实现。

正因为如此，无需大量额外的脑力劳动，我们就知道答案是否定的，我们不必担心我们忽略了某些东西。因此，您可以对上述答案充满信心，而不必担心作者在给出答案时只是忽略了某些内容。

几乎所有编译器书籍都会谈到这一点，这里有一个快速概述：

[http://books.google.com/books?id=4LMtA2wOsPcC&pg=PA94&lpg=PA94&dq=push-down+finite+automata&source=bl&ots=NisYwNO1r0&sig=ajaSHFXwpPOWG8IfbcfKoqzS5Wk&hl=en&ei=m26cSdf6DZGYsAPB-6SsRenum&sa=X&ctoi=book_result](http://books.google.com/books?id=4LMtA2wOsPcC&pg=PA94&lpg=PA94&dq=push-down+finite+automata&source=bl&ots=NisYwNO1r0&sig=ajaSHFXwpPOWG8IfbcfKoqzS5Wk&hl=en&ei=m26cSdf6DZGYsAPB-6SsAg&sa=X&oi=book_result&resnum=6&ct=result)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-12T10:57:13.290

没有正则表达式的工作 php：

```
function analyse($input){
    $len = strlen($input);
    $depth = 0;
    for ($i = 0; $i < $len; $i++) {
        $depth += $input[$i] == '(';
        $depth -= $input[$i] == ')';
        if ($depth < 0) break;
    }
    if ($depth != 0) return false;
        else return true;
}
$check_nestled = analyse('(5 * 2) + ((2 + 2) - 4)');
if($check_nestled){
    // do stuff, everything is ok
} 
```

# sql - SQL 中的分页帮助

> ID：562607
> 
> 赞同：0
> 
> 时间：2009-02-18T20:08:59.277
> 
> 标签：sql, oracle

下面的内部 SELECT 返回大量行 (1000000+)，外部 SELECTs(alpha BETWEEN #startRec# AND #endRec#) 用于 PAGINATION 以在每页中显示 25 个数据。

问题是：-在下面完成的分页非常慢，并且会减慢整个数据的显示速度。所以请大家帮我以更好的方式在分页下面执行此操作？关于分页的代码最好。

**我很抱歉这样说，但我对分页概念很陌生，所以需要你的帮助。

```
/*********ORIGINAL QUERY ****/
SELECT
*
FROM 
(
SELECT
beta.*, rownum as alpha
FROM
(
SELECT 
p.lastname, p.firstname, porg.DEPARTMENT,
porg.org_relationship,
porg.enterprise_name,
(
SELECT 
count(*) 
FROM 
test_person p, test_contact c1, test_org_person porg 
WHERE 
p.p_id = c1.ref_id(+) 
AND p.p_id = porg.o_p_id 
$where_clause$

) AS results
FROM 
test_person p, test_contact c1, test_org_person porg
WHERE 
p.p_id = c1.ref_id(+) 
AND p.p_id = porg.o_p_id 
$where_clause$ 

ORDER BY 
upper(p.lastname), upper(p.firstname)
) beta
)
WHERE
alpha BETWEEN #startRec# AND #endRec# 
```

* * *

我在下面尝试过的实现

* * *

(1)最里面的查询..是第一个获取数据的查询。(2)然后，我们对上述数据进行总计数。

现在，主要问题是运行查询永远进行......最后我不得不强行取消它。我觉得下面的查询中缺少一些东西，它会挂起。

另外，我知道在外面做 COUNT 是提高性能的最佳方法。所以，请您更正下面的查询，以便我能够使用 Pagination、rownum 等返回 COUNT *** DATA。主要是下面的别名， rownum 和获取数据。

```
select * from 
( select x.* ,rownum rnum 

from ( SELECT 
count(*) as results /****2nd QUERY is OUTSIDE to get total count**/ 
```

问题在这里，我如何访问在下面的第一个查询中选择的数据

```
from ( /****1st query to SELECT data***/

SELECT 
p.lastname, p.firstname, porg.DEPARTMENT,
porg.org_relationship,
porg.enterprise_name

FROM 
t_person p, t_contact c1, t_o_person porg 
WHERE rownum <10
and
p.person_id = c1.ref_id(+) 
AND p.person_id = porg.o_person_id 

ORDER BY 
upper(p.lastname), upper(p.firstname)

) y ------------------>alias defined Y from data of the 1st query

)x ------------------>alias defined X 
where rownum <= 20 )
where rnum >= 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T22:09:02.153

要快速进行分页，需要限制返回的查询结果。例如。在 mysql 中，您可以使用 limit 和 calc_rows。

您必须检查您的数据库，但是如果您没有这些辅助函数，则将这两个查询分成单独的查询会更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T22:12:31.803

也许我错过了一些东西，但是您是否研究过使用 LIMIT 和 OFFSET 子句？ [http://www.sql.org/sql-database/postgresql/manual/queries-limit.html](http://www.sql.org/sql-database/postgresql/manual/queries-limit.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T22:03:47.550

我通常将其作为两个单独的查询来执行，例如：

```
-- get page of data
SELECT *
FROM
(
    SELECT 
        p.lastname, p.firstname, porg.DEPARTMENT,
        porg.org_relationship,
        porg.enterprise_name
    FROM 
        test_person p, test_contact c1, test_org_person porg
    WHERE 
        p.p_id = c1.ref_id(+) 
        AND p.p_id = porg.o_p_id 
        $where_clause$ 
    ORDER BY 
    upper(p.lastname), upper(p.firstname)
) beta
WHERE
rownum BETWEEN #startRec# AND #endRec#

--get total count
SELECT count(*) as Count
FROM 
    test_person p, test_contact c1, test_org_person porg
WHERE 
    p.p_id = c1.ref_id(+) 
    AND p.p_id = porg.o_p_id 
    $where_clause$ 
```

您还可以返回结果中第一行数据的总计数，如下所示：

```
SELECT null, null, null, null, null, count(*) as Count
FROM 
    test_person p, test_contact c1, test_org_person porg
WHERE 
    p.p_id = c1.ref_id(+) 
    AND p.p_id = porg.o_p_id 
    $where_clause$ 

UNION ALL

SELECT *
FROM
(
    SELECT 
        p.lastname, p.firstname, porg.DEPARTMENT,
        porg.org_relationship,
        porg.enterprise_name, null
    FROM 
        test_person p, test_contact c1, test_org_person porg
    WHERE 
        p.p_id = c1.ref_id(+) 
        AND p.p_id = porg.o_p_id 
        $where_clause$ 
    ORDER BY 
    upper(p.lastname), upper(p.firstname)
) beta
WHERE
rownum BETWEEN #startRec# AND #endRec# 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T20:53:42.297

你用的是什么数据库？如果Oracle 别人建议的想法行不通，Oracle 不支持`LIMIT`SQL 的语法。

对于 Oracle，您使用以下语法包装查询：

```
SELECT * 
FROM (SELECT a.*, 
             ROWNUM rnum 
      FROM ( [your query] ) a 
      WHERE ROWNUM <= [endRow] ) 
WHERE rnum >= [startRow] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T22:20:17.807

这些是专门为 ASP 设计的，但可以轻松适应： [http](http://databases.aspfaq.com/database/how-do-i-page-through-a-recordset.html) : //databases.aspfaq.com/database/how-do-i-page-through-a-recordset.html 就个人而言，我实现了“#Temp表”存储过程方法，当我最近需要分页解决方案时。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T23:08:28.690

我的建议是：

*   按姓氏 + 名字在 test_person 上创建索引（按此顺序）
*   如果可能，删除上层函数（一些数据库允许使用函数创建索引）
*   删除外部 SELECT 并在客户端（不在数据库中）进行分页

我怀疑必须首先解决内部子查询，如果没有适当的索引，这将是昂贵的。通常按计算列排序不使用索引，创建临时表等等。

干杯

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T13:20:12.390

在 Oracle 中有几个选项：

1.  在带有包装的内部查询中使用 ROWNUM 来获取分页（正如您所尝试的那样）
2.  使用解析函数。

Tom Kyte 对这两种方法都有很好的描述：

[http://www.oracle.com/technology/oramag/oracle/07-jan/o17asktom.html](http://www.oracle.com/technology/oramag/oracle/07-jan/o17asktom.html)

希望这可以帮助。

# sql - 具有两个联接的聚合 (MySQL)

> ID：562608
> 
> 赞同：2
> 
> 时间：2009-02-18T20:09:08.947
> 
> 标签：sql, join, aggregation

我有一张叫做**画廊**的桌子。对于**画廊中的每一行，表格****图片**中有几行。一张图片属于一个画廊。然后是桌**票**。每一行都是对某个画廊的赞成或反对。这是（简化的）结构：

```
gallery ( gallery_id )
picture ( picture_id, picture_gallery_ref )
vote ( vote_id, vote_value, vote_gallery_ref ) 
```

现在我想要一个查询给我以下信息：所有画廊都有自己的数据字段和连接到画廊的图片数量和投票的汇总值。

这是我的查询，但由于多次加入，聚合值不是正确的。（至少当图片或选票超过一排时。）

```
SELECT 
  *, SUM( vote_value ) as score, COUNT( picture_id ) AS pictures
FROM 
  gallery
LEFT JOIN 
  vote
  ON gallery_id = vote_gallery_ref
LEFT JOIN 
  picture
  ON gallery_id = picture_gallery_ref
GROUP BY gallery_id 
```

因为我注意到这`COUNT( DISTINCT picture_id )`给了我正确数量的图片，所以我尝试了这个：

```
( SUM( vote_value ) / GREATEST( COUNT( DISTINCT picture_id ), 1 ) ) AS score 
```

它在这个例子中有效，但是如果一个查询中有更多的连接呢？

只是想知道是否有更好或更“优雅”的方式可以解决这个问题。另外我想知道我的解决方案是特定于 MySQL 还是标准 SQL？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T20:30:22.640

来自奥卡姆的威廉的这句话在这里适用：

> Enita non sunt multiplicanda praeter necessitatem
> 
> （拉丁语为“实体不得在必要时成倍增加”）。

您应该重新考虑*为什么需要在单个查询中完成此操作？* 确实，单个查询的开销比多个查询要少，但是如果单个查询的性质变得过于复杂，无论是您开发还是 RDBMS 执行，**都可以运行单独的查询。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T20:42:17.150

或者只是使用子查询...

我不知道这是否是有效的 MySQL 语法，但您可能可以执行以下操作：

```
SELECT
  gallery.*, a.score, b.pictures
LEFT JOIN
(
  select vote_gallery_ref, sum(vote_value) as score
  from vote
  group by vote_gallery_ref
) a ON gallery_id = vote_gallery_ref
LEFT JOIN 
(
  select picture_gallery_ref, count(picture_id) as pictures
  from picture
  group by picture_gallery_ref
) b ON gallery_id = picture_gallery_ref 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T21:10:21.670

您多久添加/更改一次投票记录？

您多久添加/删除一次图片记录？

您多久对这些总数运行一次此查询？

在图库表 ( `total_pictures, total_votes, total_vote_values`) 上创建总计字段可能会更好。

当您在图片表上添加或删除记录时，您还会更新图库表上的总数。这可以使用图片表上的触发器自动更新图库表来完成。也可以使用结合两条 SQL 语句来更新图片表和图库表的事务来完成。当您在图片表上添加记录时，会增加`total_pictures`库表上的字段。当您删除图片表上的记录时，会减少该`total_pictures`字段。

类似地，当添加或删除投票记录或`vote_value`您更新`total_votes`和`total_vote_values`字段的更改时。添加记录会增加`total_votes`字段并添加`vote_values`到`total_vote_values`. 删除记录会减少`total_votes`字段并从 中`vote_values`减去`total_vote_values`。更新`vote_values`投票记录也应该更新 `total_vote_values`差异（减去旧值，添加新值）。

您的查询现在变得微不足道 - 它只是来自画廊表的简单查询。但这是以更复杂的图片和投票表更新为代价的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T20:46:50.493

正如比尔卡尔文所说，在一个查询中完成这一切是非常丑陋的。

但是，如果你必须这样做，使用聚合数据连接和选择非聚合数据需要连接子查询（过去几年我没有太多使用 SQL，所以我实际上忘记了这个的正确术语）。

假设您的图库表有其他字段`name`并且`state`：

```
select g.gallery_id, g.name, g.state, i.num_pictures, j.sum_vote_values
from gallery g
inner join (
  select g.gallery_id, count(p.picture_id) as 'num_pictures'
  from gallery g
  left join picture p on g.gallery_id = p.picture_gallery_ref
  group by g.gallery_id) as i on g.gallery_id = i.gallery_id
left join (
  select g.gallery_id, sum(v.vote_value) as 'sum_vote_values'
  from gallery g
  left join vote v on g.gallery_id = v.vote_gallery_ref
  group by g.gallery_id
) as j on g.gallery_id = j.gallery_id 
```

这将产生一个结果集，如下所示：

```
gallery_id, name, state, num_pictures, sum_vote_values
1, 'Gallery A', 'NJ', 4, 19
2, 'Gallery B', 'NY', 3, 32
3, 'Empty gallery', 'CT', 0, 
```

# .net - 锁将如何响应竞争条件？

> ID：562617
> 
> 赞同：0
> 
> 时间：2009-02-18T20:11:25.540
> 
> 标签：.net, multithreading, synchronization, locking, race-condition

在以下场景中，线程将等待竞争条件多长时间？

将文件添加到集合中：

```
 lock(mylock)
 {
     // add to collection
 } 
```

然后以类似的方式将其从集合中删除。

如果一个线程在服务从集合中删除它时试图添加到集合中，谁会赢？

或者这是比赛条件的关键，你无法预测谁会赢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T20:15:15.000

如果删除线程首先尝试锁定，则它拥有锁，删除项目（如果存在），释放锁，然后继续。然后添加线程获取锁并添加项目。**最终结果：**项目存在于集合中。

如果添加线程首先尝试锁定，它拥有锁，添加项目，释放锁，然后继续。然后删除线程抓住锁并删除（刚刚添加的）项目。**最终结果：集合***中不*存在项目。

两个线程都不会等待超过从集合中添加或删除项目所需的时间。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-18T20:19:46.830

顾名思义，比赛条件意味着比赛正在进行，任何人都可以获胜！

如您在此处显示的那样使用`lock(obj)`将导致线程阻塞（等待），直到所有其他线程释放它们对`obj`. 这可能永远不会发生。

```
lock (obj)
{
    // stuff
} 
```

……相当于……

```
Monitor.Enter(obj);
try
{
    // stuff
}
finally
{
    Monitor.Exit(obj);
} 
```

如果您想强制锁定超时，请改用此表单：

```
if (!Monitor.TryEnter(obj, timeout))
{
    // handle the fact that you couldn't lock
}
else
{
    try
    {
        // stuff
    }
    finally
    {
        Monitor.Exit(obj);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T20:18:14.277

无论哪个线程先发出锁，都会获胜。第二个线程将等到第一个线程释放锁。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-23T18:44:37.743

'if' 和 'try' 之间存在不同类型的竞争条件。例如，如果线程在两者之间中止，那么它会使代码部分锁定。我认为这不是你问题的重点，但那里仍然存在问题。

# c# - 用 C++ 开发 Win32 应用程序比用 C# 开发 .NET 应用程序有什么优势？

> ID：562620
> 
> 赞同：16
> 
> 时间：2009-02-18T20:11:41.780
> 
> 标签：c#, .net, c++, unmanaged, managed-code

我使用 Visual C++ 和 Win32 API 学习了 Windows 编程。如今，似乎大多数应用程序都是使用 C# 在 .NET 中开发的。我知道大多数时候本机代码和托管代码之间没有太大的性能差异。所以我想知道，如果我今天要开始编写一个新的桌面应用程序，是否有任何理由（除了我更熟悉 C++ 的事实），我可能想用非托管 C++ 编写它.NET 的？使用 C++ 和本机代码还有一些优势吗？或者这种方法在 Windows 平台上是否或多或少地被 .NET 取代了？

当然，我知道编写低级设备驱动程序和类似程序的人不会在 .NET 中这样做。我问的是典型的不直接硬件调用的面向客户端的应用程序。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-18T20:27:25.347

IMO 对小型可下载应用程序最重要的一项是本机代码不需要 .NET 运行时。虽然宽带变得越来越普遍，但并不是几乎每个人都拥有它。

有些人可能会失望地看到您的 2 MB 应用程序实际上需要另外 20MB 的框架下载和一个麻烦的安装过程才能运行。如果他们不确定他们是否真的需要您的应用程序，他们可能会在尝试之前将其删除并转向竞争产品。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-18T20:17:40.190

*   性能（某些情况，例如图形）
*   内存占用（正如曼库索所说）
*   使用现有图书馆
*   不需要运行时
*   更精细的控制

列举几个。

但是，您可能还想从相反的角度看待问题，以公平地评估使用哪种语言。

此外，您可以使用 C++/CLI 来合并本机代码和 .net 代码。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-18T20:18:03.573

如果您的应用程序需要能够在不安装的情况下运行（即，如果您不能或不应该执行诸如安装 .NET 框架之类的操作），则不能指望 .NET 在 Windows 机器上（Vista 之前）。许多实用程序应用程序都属于这一类。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-18T21:51:14.943

**我建议用****托管代码**编写每个桌面应用程序。.NET/C# 是一个很好的平台。

我的理由：

1.  **性能损失可以忽略不计**。如果您不相信我的话，请在 Google 上进行基准测试。更重要的是代码本身。您可以在 C++ 或 .NET/C# 中编写 O(n^m) 算法。如今，JIT 引擎非常成熟。
2.  **在单元测试、模拟和重构**方面，非托管 C++ 存在重大缺陷。这非常麻烦且不灵活。反射允许托管代码使此类事情变得非常方便。
3.  部署是一个小问题。但是，创建一个检查必要的 .NET 前提条件并自动安装它们的设置是不费吹灰之力的。
4.  编译更快，**没有链接器**！当您编辑代码时，它甚至会在后台发生。
5.  .NET**库支持**比 STL、MFC 和 boost 更好、更干净。
6.  **没有头文件和宏**。他们只是容易出错。
7.  **安全**！再见缓冲区溢出，错误的指针，未初始化的变量......
8.  **例外**。清除 .NET 中的异常层次结构。C++ 异常被搞砸了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-18T20:12:59.843

内存占用。但是，除非您正在为内存严重受损的机器进行开发，否则对于大多数应用程序来说，这确实不应该成为问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-18T20:27:42.023

如果您负担得起对堆栈的依赖，请选择 .NET Modern、优雅、强大，因此开发速度更快。

但是要意识到你将你的应用程序链接到它 - 到语言和框架，如果你预见到你可能想要逃避这种情况的未来，那么最好三思而后行。

Win32 既旧又笨重，但它几乎可以在任何 Windows 版本上运行，无需额外依赖，而且您的代码可以是简单、可移植的 C/C++。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-18T20:28:52.393

+1 不需要在目标机器上安装 .NET 包/安装。这仍然是一个大问题。

当所有机器都有单声道或 NET 时，这没什么大不了的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-18T21:25:17.860

我能想到的两件事。

1.  知识产权保护。对非托管 C++ 应用程序进行逆向工程要困难得多。托管的 .Net 或 Java 应用程序可以很容易地反编译，而非托管 C++ 则不然。

2.  速度。正如其他评论所提到的，C++ 更接近硬件并且内存占用更小。这就是为什么大多数视频游戏继续使用 C++ 和内联汇编编写的原因。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-10-04T19:49:02.263

.Net 程序也有一个支持生命周期，而原生程序则没有。Native 将在不同的操作系统上运行多年，无需更新。

.Net 程序可能会被糟糕的 .Net 配置所破坏，本机只是继续运行，几乎不受操作系统更新的影响。

.Net 程序启动慢，感觉迟钝，native 启动快，运行快。

.Net 必须针对最低公分母（大多数分布式框架版本）进行编码，Native 将所有代码编译到应用程序中 - 所以使用你想要的。

将 Delphi 用于 Native，而不是 C++。.Net 部分基于 Delphi RAD 和 Java 后端。

# rest - 使用 SAS 使用 REST 服务

> ID：562632
> 
> 赞同：3
> 
> 时间：2009-02-18T20:13:50.060
> 
> 标签：rest, sas

这是一个奇怪的问题。我知道 SAS 有一个用于使用 Web 服务的 PROC SOAP。我想知道是否有人有使用 SAS 从 REST 资源中使用 XML 的经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T12:57:26.617

在 Base SAS 9.2 中还有一个名为[proc http](http://support.sas.com/documentation/cdl/en/proc/61895/HTML/default/a003286672.htm)的新 proc 。它专为调用 REST 服务（或用于站点抓取）而设计。您还可以将 url 访问方法用于简单的 get 请求。**proc http**的优点是您可以控制使用的 http 动词并传递有效负载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T23:23:18.717

我没有使用 SAS 的 REST API 的具体经验，但我使用过类似的基于 Web 的服务。

您可以使用*文件名 url*引擎访问任意 URL 并读取结果。YMMV 就与特定 REST API 和 XML 输出的兼容性而言。

*或者，您可以使用对wget*或*curl*等程序的系统调用将 XML 下载到文件中，然后使用 SAS 的 xml 引擎解析输入。

# php - Linux下PHP mail()的奇怪问题

> ID：562635
> 
> 赞同：3
> 
> 时间：2009-02-18T20:15:12.490
> 
> 标签：php, email, mime

当它“在我的机器上工作”时就是这种情况。除了我的机器是 Windows，目标是某种 Linux。

这个想法是该函数在和标题`mail()`之间放置一个换行符，从而破坏了整个事情。这是代码，尽可能简化：`MIME-Version``Content-Type`

```
<?php
        $HTMLPart = chunk_split(base64_encode('<html><body style="color: red">Test.</body></html>'));
        $PlaintextPart = chunk_split(base64_encode('>>> TEST <<<'));

$Headers     =<<<AKAM
From: "My Test" <my@mail.com>
Reply-To: my@mail.com
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="9-1410065408-1410065408=:27514"
AKAM;

$Body        =<<<AKAM
This is a multi-part message in MIME format.

--9-1410065408-1410065408=:27514
Content-Type: text/plain; charset="windows-1252"
Content-Transfer-Encoding: base64

$PlaintextPart
--9-1410065408-1410065408=:27514
Content-Type: text/html; charset="windows-1252"
Content-Transfer-Encoding: base64

$HTMLPart
--9-1410065408-1410065408=:27514--
AKAM;
    echo 'Try 3: ';
    echo mail('your@mail.com', 'Testmail', $Body, $Headers) ? 'WIN' : 'FAIL';
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T20:22:26.683

您可能在那里有一个回车和一个换行符。Windows 使用 CR+LF 结束行，但 Linux 仅使用换行符。

# apache-flex - Flex 错误：未找到类型或不是编译时常量

> ID：562644
> 
> 赞同：1
> 
> 时间：2009-02-18T20:16:36.480
> 
> 标签：apache-flex

我的弹性代码中出现以下错误。任何想法如何解决这个问题？

```
<mx:Script>
    <![CDATA[
        private function send_data():void {
            userRequest.send();
        }
    ]]>
</mx:Script>
<mx:Form x="22" y="10" width="493">
    <mx:HBox>
        <mx:Label text="UserId"/>
        <mx:TextInput id="userid"/>
    </mx:HBox>
    <mx:HBox>
        <mx:Label text="Ip Address"/>
        <mx:TextInput id="ip"/>
    </mx:HBox>
    <mx:Button label="Submit" click="send_data()"/>
</mx:Form>
<mx:DataGrid id="dgUserRequest" x="22" y="128" dataProvider="{userRequest.lastResult.users.user}">
    <mx:columns>
        <mx:DataGridColumn headerText="User ID" dataField="userid"/>
        <mx:DataGridColumn headerText="User Name" dataField="ip"/>
    </mx:columns>
</mx:DataGrid>
<mx:TextInput x="22" y="292" id="selectedemailaddress"
    text="{dgUserRequest.selectedItem.emailaddress}"/>
<mx:HTTPService id="userRequest" url="http://localhost/post.php" useProxy="false" method="POST" resultFormat="e4x">
    <mx:request xmlns="">
        <userid>{userid.text}</userid>
        <ipaddress>{ip.text}</ipaddress>
    </mx:request>
</mx:HTTPService> 
```

```
Type was not found or was not a compile-time constant: data.
[Generated code (use -keep to save): Path: data-generated.as, Line: 245, Column: 14] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-14T14:33:20.333

打开项目的属性对话框并转到“编译”部分。在“编译器参数”文本框中，添加：

```
-keep-generated-actionscript 
```

编译后，一个名为“生成”的文件夹将位于您的应用程序目录（或可能是 bin 目录）中。打开 data-generated.as 并使用第 245 行附近的代码更新您的原始问题。

完成后，我们可以为您提供进一步的帮助。

**编辑：**是否有 data.mxml 文件？我觉得奇怪的是错误来自数据生成。好像你的文件被称为 test.mxml

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T20:26:06.300

我的猜测是您从 post.php 返回的 xml 并不完全符合您的期望。

[尝试在flexcoders](http://tech.groups.yahoo.com/group/flexcoders/messages)上发布这个问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T06:07:35.990

您在使用 Flex Builder 吗？在这种情况下，它会在你右边的错误线上显示小红点。如果您发生以下情况，通常会发生此错误：

*   使用标准组件而不`import`使用包/类（这可以通过使用 IDE 的自动类型填充来轻松修复，这将添加必要的导入语句）
*   忘记声明一个变量/导入你自己的类

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-23T14:17:17.900

或者您的库可能与您的 SDK 版本不兼容

# java - 使用 Quartz 和 Spring

> ID：562652
> 
> 赞同：6
> 
> 时间：2009-02-18T20:18:00.657
> 
> 标签：java, spring, scheduling, quartz-scheduler

在我的应用程序中，需要能够根据传入的请求类型（动态）创建计划作业。

我仍然可以使用 Spring 来创建和触发 Jobs 吗？如果是，如何？

任何帮助都会很有用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-01T22:40:38.120

鉴于 SchedulerFactoryBean 公开了一个原生 Quartz Scheduler 对象，您可以将其直接连接到您的控制器类，然后使用 Scheduler 对象动态创建和注册触发器和作业。

Spring 本身不能用于调度动态创建的作业，因为 Spring 的 bean 支持将用于静态配置的作业，但本机 Quartz Scheduler API 足够合理，可以单独使用（几乎没有）。作为工作的触发，Quartz 的工作，而不是 Spring 的工作。

编辑：要么我误解了原来的问题，要么其他人都是。另一个答案详细说明了如何使用 Spring 静态连接一系列石英作业，但问题是如何在请求进入时*动态*调度作业。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-18T20:35:01.287

查看[CronTriggerBean](http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/scheduling/quartz/CronTriggerBean.html)和[JobDetailBean](http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/scheduling/quartz/JobDetailBean.html)。下面模拟的“MyJob”类是[QuartzJobBean](http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/scheduling/quartz/QuartzJobBean.html)的一个实例。cron 表达式是您所期望的，但它的第一个值是秒。

```
<beans>
   <bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
      <property name="startupDelay" value="5"/>
      <property name="waitForJobsToCompleteOnShutdown" value="false"/>
      <property name="triggers">
         <list>
            <bean class="org.springframework.scheduling.quartz.CronTriggerBean">
               <property name="jobDetail">
                  <bean class="org.springframework.scheduling.quartz.JobDetailBean">
                     <property name="jobClass" value="edu.vt.MyJob"/>
                     <property name="jobDataAsMap">
                        <map>
                           <entry key="messageSource" value-ref="messageSource"/>
                           <entry>
                              <key><value>anotherProperty</value></key>
                              <bean class="edu.vt.MyUsefulBean">
                                 <constructor-arg index="0" value="..."/>
                              </bean>
                           </entry>
                        </map>
                     </property>
                  </bean>
               </property>
               <property name="cronExpression" value="0 * * * * ?"/>
            </bean>
         </list>
      </property>
   </bean>
</beans> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-27T14:30:45.557

这方面似乎没有太多完整的信息。这就是我动态安排作业的方式。当然，您可以用其他触发器替换简单触发器。

春豆：

```
<bean name="dailyUpdateJob" class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
    <property name="jobClass" value="com.somecompany.scheduler.DailyUpdates" />
</bean>

<bean id="dailyCronTrigger" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
    <property name="jobDetail" ref="dailyUpdateJob" />
    <!-- run every morning at 4:15 AM -->
    <property name="cronExpression" value="00 15 04 * * ?" />   
</bean>

<bean name="quartzScheduler" class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
    <property name="triggers">
        <list>
            <ref bean="dailyCronTrigger" />
            <ref bean="weeklyReportsCronTrigger" />
        </list>
    </property>
    <property name="applicationContextSchedulerContextKey">
        <value>applicationContext</value>
    </property>
</bean> 
```

要立即运行作业获取对调度程序和作业的引用，请附加一个简单的触发器并将其放入调度程序中，如下所示：

```
 @Autowired
    SchedulerFactoryBean scheduler;

    @Autowired 
    @Qualifier("dailyUpdateJob")
    JobDetailFactoryBean dailyJob;

    public void dynamicJobTrigger() throws Exception {
        // Create a trigger for "now" 
        SimpleTrigger trigger = (SimpleTrigger) newTrigger()
                    .startAt(new Date())
                    .forJob(dailyJob.getObject())
                    .build();

        // And drop it into the scheduler for immediate execution
        scheduler.getScheduler().scheduleJob(trigger);
    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-28T13:11:02.107

[您可以从此链接](http://www.nabble.com/file/p14189448/quartz.zip)下载示例源代码

```
<?xml version="1.0" encoding="UTF-8"?> 
```

```
<!--  scheduler factory -->
<bean   id="com.notary.app.invoicing.scheduler.SchedulerFactory" 
        class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
    <property name="triggers">
        <list>
            <ref bean="ASFImportTrigger"/>
        </list>
    </property>
    <property name="dataSource">
        <ref bean="datasource"/>
    </property>
    <property name="transactionManager">
        <ref bean="transactionManager"/>
    </property>
    <property name="quartzProperties">
        <props>
            <prop key="org.quartz.jobStore.class">org.quartz.impl.jdbcjobstore.JobStoreTX</prop>
            <prop key="org.quartz.jobStore.driverDelegateClass">org.quartz.impl.jdbcjobstore.MSSQLDelegate</prop>
            <prop key="org.quartz.jobStore.misfireThreshold">60000</prop>
            <prop key="org.quartz.jobStore.selectWithLockSQL">SELECT * FROM {0}LOCKS UPDLOCK WHERE LOCK_NAME = ?</prop>
            <prop key="org.quartz.plugin.triggHistory.class">org.quartz.plugins.history.LoggingTriggerHistoryPlugin</prop>
            <prop key="org.quartz.plugin.triggHistory.triggerFiredMessage">Trigger {1}.{0} fired job {6}.{5} at: {4, date, HH:mm:ss dd/MM/yyyy}</prop>
            <prop key="org.quartz.plugin.triggHistory.triggerCompleteMessage">Trigger {1}.{0} completed firing job {6}.{5} at {4, date, HH:mm:ss dd/MM/yyyy} with resulting trigger instruction code: {9}</prop>
            <prop key="org.quartz.plugin.jobHistory.class">org.quartz.plugins.history.LoggingJobHistoryPlugin</prop>
            <prop key="org.quartz.plugin.jobHistory.jobSuccessMessage">Job {1}.{0} fired at: {2, date, dd/MM/yyyy HH:mm:ss} result=OK</prop>
            <prop key="org.quartz.plugin.jobHistory.jobFailedMessage">Job {1}.{0} fired at: {2, date, dd/MM/yyyy HH:mm:ss} result=ERROR</prop>
        </props>
    </property>
    <property name="overwriteExistingJobs" value="true"/>
    <property name="startupDelay" value="50"/>
    <property name="applicationContextSchedulerContextKey">
        <value>applicationContext</value>
    </property>
</bean> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-18T21:21:25.607

您也可以使用`MethodInvokingJobDetailFactoryBean`包中的`org.springframework.scheduling.quartz`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-16T09:51:19.377

Spring 3（撰写本文时的最新版本）几乎完全支持使用注释设置作业。

请参阅：[关于调度的 Spring 参考](http://static.springsource.org/spring/docs/3.1.1.RELEASE/spring-framework-reference/html/scheduling.html "Spring 调度参考")

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-02-15T13:57:56.287

一年后，我发现自己不得不做一些非常相似的事情。谷歌搜索，我发现[这个链接](http://cse-mjmcl.cse.bris.ac.uk/blog/2007/06/20/1182370280435.html)描述了通过 JobExecutionContext 从计划的作业中访问应用程序上下文。我想我将创建一个抽象类型的作业，它可以做一些实际的作业创建，并在作业需要运行时使用原型实际注入所需的服务。

# cocoa-touch - 在界面构建器中扩展属性检查器

> ID：562655
> 
> 赞同：2
> 
> 时间：2009-02-18T20:18:41.170
> 
> 标签：cocoa-touch, xcode, interface-builder

是否可以使用从 UIView 继承的自定义类的附加属性来扩展界面构建器的属性检查器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-19T04:03:42.380

现在不行。

Interface Builder 允许您通过 Interface Builder Plugin 为您的对象实现自定义检查器。但是，IB Kit 目前不支持为 iPhone OS 制作插件。目前仅支持 Mac OS 的插件开发。

# javascript - 如何在 IE6 或 7 中淡出一行 (TR)

> ID：562657
> 
> 赞同：1
> 
> 时间：2009-02-18T20:19:26.053
> 
> 标签：javascript, jquery, internet-explorer

当用户单击行 (TR) 上的删除按钮时，我正在使用 JQuery 淡出行 (TR)。通过淡出，我的意思是整行（TR）背景颜色变为红色，然后淡出为白色并消失。这是一个很棒的小动画，用于向用户展示对所做操作的即时反应。

JavaScript 看起来像这样：

```
$(tr).css("background-color", "rgb(255,200,200)");
$(tr).fadeOut(500, RemoveDomElement); 
```

这在 Firefox、Safari、Opera 和 Chrome 中运行良好，但在 IE 中当然不行。IE 将执行代码并完成清理，但不会显示实际的淡出动画。

我能为 IE 做什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-18T20:21:32.740

淡出（并删除）子单元格 (TD) 而不是行。

做这个：

```
$(tr).children().css("background-color", "rgb(255,200,200)");
$(tr).children().fadeOut(500, RemoveDomElement); 
```

尽管每个 TD 都在做自己的事情，但这对人眼来说将足够快，就像只是淡化/移除 TR 一样。

# dll - 与私有 dll 相比，共享 dll (GAC) 如何加载到内存并使用

> ID：562660
> 
> 赞同：3
> 
> 时间：2009-02-18T20:20:04.990
> 
> 标签：dll, gac

我想指出，我知道如何在 GAC 中添加/删除程序集。我要问的是是否有人可以从技术角度向我解释它是如何工作的。从节省资源的角度来看，将dll放在那里有什么意义。

亲切的问候 pk

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T20:24:21.407

将东西放入 GAC 的目的是让多个应用程序（甚至来自不同供应商）可以访问同一个程序集。然后有一个可以更新它的位置，并且可以正确访问该版本的所有应用程序都可以使用它。您还知道 GAC 中的所有程序集都经过数字签名，因此您知道代码的来源（例如 MS）。

至于加载到内存中。每个应用程序都必须自己加载它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T20:24:30.987

[这个问题](https://stackoverflow.com/questions/538710/why-should-i-not-use-the-gac)为不使用 GAC 提供了一个很好的论据，你可以避免它。

[这个问题](https://stackoverflow.com/questions/134485/best-gac-tutorial-overview)提供了一些指向 GAC 揭秘文章的链接，这可能有助于您做出决定。

# c# - 通用方法正在获取基类的类型

> ID：562669
> 
> 赞同：1
> 
> 时间：2009-02-18T20:23:02.173
> 
> 标签：c#, generics, inheritance

我有以下类（修剪以仅显示基本结构）：

```
public abstract class BaseModel {
    public bool PersistChanges() {
        // Context is of type "ObjectContext"
        DatabaseHelper.Context.SafelyPersistChanges(this);
    }
}

public static class ObjectContextExtensions {
    public static bool SafelyPersistChanges<T>(this ObjectContext oc, T obj) {
        // Persist the object using a transaction
    }
}

[Persistent("LEADS")]
public class Lead : BaseModel {
    // Extra properties
}

public class LeadsController : Controller {
    public ActionResult Save(Lead lead) {
        lead.PersistChanges()
    }
} 
```

我的**Lead**类派生自**BaseModel**，它包含使用事务将对象的更改持久保存到数据库的方法。我使用扩展方法实现了事务持久化。问题是通过**将此**传递给我的 BaseModel 类中**的****SafelyPersistChanges**，扩展方法上的通用 T 设置为**BaseModel**。但是，由于**BaseModel**没有被标记为持久对象（它不能是），所以 ORM 框架会引发异常。

例子：

```
Lead lead = LeadRepository.FindByNumber(2);
lead.SalesmanNumber = 4;
// Calls "ObjectContextExtensions.SafelyPersistChanges<BaseModel>(BaseModel obj)"
// instead of "ObjectContextExtensions.SafelyPersistChanges<Lead>(Lead obj)"
lead.PersistChanges(); 
```

上面的块引发了以下异常：

> 无法为没有持久属性的“SalesWeb.Data.BaseModel”类型创建映射。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T20:34:07.123

扩展方法在编译时被静态绑定。在调用 SafelyPersistChanges 时，它的类型为 BaseModel，因此您的异常。为了获得你想要的行为，你要么需要做一个带有大量强制转换的丑陋 if 语句，要么强制调用派生类。

使 PersistChanges 成为一个抽象方法。然后用完全相同的代码在派生类中实现调用。

```
public class Lead { 
    public override bool PersistChanges() {
        // Context is of type "ObjectContext"
        DatabaseHelper.Context.SafelyPersistChanges(this);
    }
} 
```

现在这将正确地成为铅

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T20:33:04.537

我会以不同的方式设计它，使“public bool PersistChanges()”调用一个虚拟方法，该方法在每个子类中都被覆盖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T20:44:18.020

因此，您需要一个“单一”实现，该实现因调用者已知的类型而异。听起来像是泛型公司的工作。

```
public static bool PersistChanges<T>(this T source)
  where T : BaseModel
{
        // Context is of type "ObjectContext"
//static property which holds a Context instance is dangerous.
        DatabaseHelper.Context.SafelyPersistChanges<T>(source);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T21:41:56.837

[你可以使用奇怪的重复模板模式](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)来解决这个问题：

```
// change your code to this

public abstract class BaseModel<TDerived> where TDerived : BaseModel
{
    public bool PersistChanges() {
        // Context is of type "ObjectContext"
        DatabaseHelper.Context.SafelyPersistChanges((TDerived)this);
        //                                            ^
        // note the cast here: -----------------------|
    }
}

public class Lead : BaseModel<Lead> { }

// the rest of your code is unchanged 
```

那会起作用，但我可能只是遵循其他建议并使用虚拟方法。

# documentation - 您推荐哪些方法/技术/工具用于记录系统和基础架构（运行手册）？

> ID：562670
> 
> 赞同：0
> 
> 时间：2009-02-18T20:23:16.667
> 
> 标签：documentation, system, sysadmin, system-administration

## 背景

在一家大公司工作后，我最近加入了一家小型初创公司。

但是，由于我的编程和系统知识，我不是专业的系统管理员，我现在是管理我们服务器和基础设施的内部人员。

过去，我从不需要记录我们的系统信息：密码（用于服务器、数据库、路由器、交换机等）、哪些服务器正在运行哪些应用程序（包括自制的和安装的）、服务器 IP 地址、配置文件位置等。 .. 专业的系统管理员总是做这项工作，让我可以专注于其他领域。

## 触发紧急情况的事件

在我发现我不知道我的主要 subversion 配置文件在 /etc/apache2 中的位置之前，我一直有点随意*（*更不用说配置文件不受版本控制或备份！ ) 我意识到这需要迅速解决。

## 下一步

我现在必须弄清楚如何以理智、优雅、访问受控的方式记录所有这些。

我听说过运行手册，但我不知道管理它们的最佳方式或工具。我的第一个想法是版本控制下的 excel/openoffice 电子表格。

是否有维护 Runbook 的良好指南？好软件？这一定是一个相当普遍的问题，你是如何处理的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T20:46:54.847

实际上，我在 Wiki 上取得了很大的成功。使用可以轻松控制登录的东西——Mediawiki 没问题，但需要一些 PHP hack——并为流程、库存等构建一些模板。

### 更新

事实上，我一定需要咖啡。 [Trac](http://trac.edgewall.org/)几乎是理想的。更好的访问控制、集成的问题跟踪和更强大的文本模型。您甚至可以将它直接绑定到您的 subversion 存储库，以便您可以将实际脚本连接到它们的运行手册页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T20:50:49.143

Wiki 确实是一个很好的方法。您可以为此设置共享点并获得不错的功能，例如更新历史记录、始终指向当前信息的链接等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T17:21:54.820

如果您使用[Puppet](http://reductivelabs.com/trac/puppet/)（或 Chef 或 CFEngine 等）之类的东西来构建和管理您的机器，那么大部分 Runbook 内容都可以存在于 puppet 配置中，这样您就可以使用更少的东西（只有位置和密码）对于 puppetmaster，如果你把它发挥到极致！）放入你的维基。

# oop - 如何强制执行“拥有”关系并保护“拥有”的对象

> ID：562680
> 
> 赞同：1
> 
> 时间：2009-02-18T20:26:48.750
> 
> 标签：oop

给定以下代码：

```
Class User{
  Task m_Task;  
  public function getTask("Do work") { return m_Task; }
}

Class Project{
  Task m_Task;  
  public function getTask("Do work") { return m_Task; }
}

Class Task {
  private m_Name;
  public Task(name) { m_Name = name; }
}

Class Evil {
  new Task = Error
} 
```

在不支持多重继承、嵌套类或私有类的语言中（私有构造函数不是一个选项），您如何设计一个要求只通过 User 或 Project 实例化 Task？理想情况下只使用语言结构而不是代码。有设计模式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T20:43:09.473

这似乎有点不切实际，但我想您编写了一个构造函数，它需要一个用户作为参数，并来回进行一些握手以将用户链接到任务，要求用户还没有任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T20:44:24.510

不是一个完整的答案，您可以从其他地方构建一个任务，但您需要一个有效的任务实例来完成它..

```
public class Task {
   public Task (User u, String name)
   {
     if (u==null) throw new UnsupportedOperationException("that's cheating");
     this.name=name;
   }
} 
```

最后，如果您要创建任务对用户外部的要求，那么其他东西需要能够加载任务的构造函数，所以我认为这是不可能的。

这个问题的目的是什么？这是否与某些现实世界的情况有任何关系？

# c# - 如何使用 XAML 在 WPF 中列出颜色？

> ID：562682
> 
> 赞同：15
> 
> 时间：2009-02-18T20:27:23.147
> 
> 标签：c#, wpf, xaml

如何获取我可以在 Visual Studio Designer 中选择的所有颜色的列表（即`System.Windows.Media.Colors`，但这不是一个集合）并`ComboBox`使用 WPF 和 XAML 标记将它们放入我自己的？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-18T21:05:28.187

这是纯 XAML 解决方案。

在你的资源部分，你会使用这个：

```
<!-- Make sure this namespace is declared so that it's in scope below -->
.. xmlns:sys="clr-namespace:System;assembly=mscorlib" ..

<ObjectDataProvider MethodName="GetType" 
    ObjectType="{x:Type sys:Type}" x:Key="colorsTypeOdp">
    <ObjectDataProvider.MethodParameters>
        <sys:String>System.Windows.Media.Colors, PresentationCore,
            Version=3.0.0.0, Culture=neutral, 
            PublicKeyToken=31bf3856ad364e35</sys:String>
    </ObjectDataProvider.MethodParameters>
</ObjectDataProvider>
<ObjectDataProvider ObjectInstance="{StaticResource colorsTypeOdp}"  
    MethodName="GetProperties" x:Key="colorPropertiesOdp">
</ObjectDataProvider> 
```

或者，正如[CodeNaked 指出的那样](https://stackoverflow.com/questions/562682/how-can-i-list-colors-in-wpf-with-xaml/562840#comment9495865_562840)，它可以简化为一个标签：

```
<ObjectDataProvider 
    ObjectInstance="{x:Type Colors}" 
    MethodName="GetProperties" 
    x:Key="colorPropertiesOdp" /> 
```

然后组合框看起来像这样：

```
<ComboBox Name="comboBox1" 
    ItemsSource="{Binding Source={StaticResource colorPropertiesOdp}}"
    DisplayMemberPath="Name"
    SelectedValuePath="Name" /> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-01-05T18:56:31.810

这是一个很棒的 ItemTemplate，可用于使用[casperOne 的代码](https://stackoverflow.com/questions/562682/how-can-i-list-colors-with-wpf/562840#562840)的组合框：

```
<ComboBox Name="cboColors"
          ItemsSource="{Binding Source={StaticResource colorPropertiesOdp}}"
          SelectedValuePath="Name">
     <ComboBox.ItemTemplate>
        <DataTemplate>
           <StackPanel Orientation="Horizontal" Height="18" Margin="0,0,0,2">
              <Border BorderThickness="1" CornerRadius="2" 
                  BorderBrush="Black" Width="50" VerticalAlignment="Stretch"
                  Background="{Binding Name}"/>
              <TextBlock Text="{Binding Name}" Margin="8,0,0,0"/>
           </StackPanel>
         </DataTemplate>
     </ComboBox.ItemTemplate>
</ComboBox> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-18T20:41:00.353

这是我在过去的 ASP.net 应用程序中所做的：

```
// populate colors drop down (will work with other kinds of list controls)
Type colors = typeof(System.Drawing.Color);
PropertyInfo[] colorInfo = colors.GetProperties(BindingFlags.Public |
    BindingFlags.Static);
foreach ( PropertyInfo info in colorInfo)
{
    ddlColor.Items.Add(info.Name);                
}

// Get the selected color
System.Drawing.Color selectedColor = 
    System.Drawing.Color.FromName(ddlColor.SelectedValue); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-13T14:15:49.450

这是使用反射在代码中执行此操作的方法。以下将所有预定义的 WPF 颜色名称转储到输出：

```
using System.Reflection;

void ListAllColors()
{
    Type colorsType = typeof(System.Windows.Media.Colors);
    PropertyInfo[] colorsTypePropertyInfos = colorsType.GetProperties(BindingFlags.Public | BindingFlags.Static);

    foreach (PropertyInfo colorsTypePropertyInfo in colorsTypePropertyInfos)
        Debug.WriteLine(colorsTypePropertyInfo.Name);
} 
```

要将它们放在组合框中，您只需将最后一行更改为：

```
_comboBox.Items.Add(colorsTypePropertyInfo.Name); 
```

# mysql - MySQL UPDATE 和 SELECT 一次完成

> ID：562693
> 
> 赞同：21
> 
> 时间：2009-02-18T20:29:54.030
> 
> 标签：mysql, sql-update

我有一个要执行的 MySQL 任务表，每一行都有一个任务的参数。
有许多工作应用程序（可能在不同的机器上）循环执行任务。
这些应用程序使用 MySQL 的本机 C API 访问数据库。

为了拥有一项任务，应用程序会执行以下操作：

*   生成一个全局唯一的 id（为简单起见，假设它是一个数字）

*   `UPDATE tasks`
    `SET guid = %d`
    `WHERE guid = 0 LIMIT 1`

*   `SELECT params`
    `FROM tasks`
    `WHERE guid = %d`

*   如果最后一个查询返回一行，我们拥有它并拥有要运行的参数

有没有办法在对服务器的一次调用中实现相同的效果（即“拥有”一行并获取其参数）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-08T09:03:26.840

试试这样

```
UPDATE `lastid` SET `idnum` =  (SELECT `id` FROM `history` ORDER BY `id` DESC LIMIT 1); 
```

上面的代码对我有用

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-18T20:43:38.990

您可以创建一个执行此操作的过程：

```
CREATE PROCEDURE prc_get_task (in_guid BINARY(16), OUT out_params VARCHAR(200))
BEGIN

  DECLARE task_id INT;

  SELECT id, out_params
  INTO task_id, out_params
  FROM tasks
  WHERE guid = 0
  LIMIT 1
  FOR UPDATE;

  UPDATE task
  SET guid = in_guid
  WHERE id = task_id;

END;

BEGIN TRANSACTION;

CALL prc_get_task(@guid, @params);

COMMIT; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T21:05:29.123

如果您正在寻找单个查询，那么它就不会发生。UPDATE 函数专门返回已更新的项目数。同样，SELECT 函数不会更改表，只会返回值。

使用过程确实会将其变成单个函数，如果您担心锁定，它会很方便。如果您最关心的是网络流量（即：传递太多查询），请使用该过程。如果您担心服务器过载（即：数据库工作太辛苦），那么过程的额外开销可能会使事情变得更糟。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-19T21:41:43.450

我有完全相同的问题。我们最终改用 PostreSQL，并且[`UPDATE ... RETURNING`](http://www.postgresql.org/docs/9.1/static/sql-update.html)：

> 可选的 RETURNING 子句使 UPDATE 根据实际更新的每一行计算和返回值。可以计算使用表的列和/或 FROM 中提到的其他表的列的任何表达式。使用表列的新（更新后）值。RETURNING 列表的语法与 SELECT 的输出列表的语法相同。

例子：`UPDATE 'my_table' SET 'status' = 1 WHERE 'status' = 0 LIMIT 1 RETURNING *;`

或者，在您的情况下：`UPDATE 'tasks' SET 'guid' = %d WHERE 'guid' = 0 LIMIT 1 RETURNING 'params';`

抱歉，我知道这并不能回答 MySQL 的问题，而且仅仅切换到 PostgreSQL 可能并不容易，但这是我们找到的最好的方法。即使 6 年后，MySQL 仍然不支持`UPDATE ... RETURNING`. 它可能会在将来的某个时候添加，但目前[MariaDB 仅用于 DELETE 语句](https://mariadb.com/kb/en/mariadb/delete/)。

***编辑***：有一项任务（低优先级）来[添加`UPDATE ... RETURNING`对 MariaDB](https://mariadb.atlassian.net/browse/MDEV-5092)的支持。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T20:35:30.240

我不知道单个调用部分，但是您所描述的是锁。锁是关系数据库的基本元素。

我不知道锁定一行的细节，读取它，然后在 MySQL 中更新它，但是通过阅读[mysql 锁定文档](http://dev.mysql.com/doc/refman/5.1/en/lock-tables.html)，您可以进行各种基于锁定的操作。

[锁](http://www.postgresql.org/docs/8.1/static/sql-lock.html)的 postgres 文档有一个很好的示例，准确地描述了您想要做什么：锁定表、读取表、修改表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-07T11:37:52.830

```
UPDATE tasks
SET guid = %d, params = @params := params
WHERE guid = 0 LIMIT 1; 
```

它将返回 1 或 0，具体取决于值是否有效更改。

```
SELECT @params AS params; 
```

这只是从连接中选择变量。

来自：[这里](http://johnbokma.com/mexit/2012/03/15/job-queue-in-mysql.html)

# asp.net - ASP.net - 使用 jQuery 多文件上传插件进行多次上传

> ID：562696
> 
> 赞同：14
> 
> 时间：2009-02-18T20:31:09.393
> 
> 标签：asp.net, jquery, file-upload, multifile-uploader

我知道如何使用 ASP.net 的 FileUpload 控件进行上传。

我想要做的是使用这个 jQuery Multiple File Upload Plugin 来上传多个文件。

这正是选择多个文件进行上传时的作用：

```
<input type="file class="multi MultiFile" id="MultiFile1_F3" name="file1[]" style="position: absolute; top: -3000px;"> 
```

但我无法弄清楚如何从 asp.net 操作这些文件。我尝试使用 Request.Files，如下链接所示： [ASP.Net Upload of multiple files after selections from jQuery](https://stackoverflow.com/questions/363286/asp-net-upload-of-multiple-files-after-choosing-them-from-jquery)

那是行不通的。我认为这只适用于在编译时标有 runat="server" 的控件。

有谁知道如何做到这一点？也许 Request.Form 中的东西......？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T00:55:17.973

要检查的两件事：

*   确保您的表单设置了 enctype="multipart/form-data" 属性。这是启用上传所必需的。
*   确保所有文件输入都设置了 id 和 name 属性。出于某种原因，如果您不同时设置两者，就会发生奇怪的事情。

此外， runat="server" 与 Request.Files 是否有效无关 - 这更多是浏览器实际发布文件的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-20T20:13:48.877

这个 jQuery 插件为每个生成的输入控件提供了完全相同的名称属性。

出于这个原因，这些文件没有发布。

我构建了自己的 javascript 解决方案。

我将在评论中发布代码的链接。

## 编辑

我重新审视了这一点，发现我想做的事情一点也不难。我得到了 jquery 多文件上传插件，可以在我的 aspx 表单中正常工作。我不知道为什么我以前遇到这么多麻烦。

1.) 在 Web 表单中包含 jQuery 库：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript" />
```

2.) 参考网络表单上的多文件插件（[在此处下载](http://www.fyneworks.com/jquery/multiple-file-upload/)）：

```
<script src="jquery.MultiFile.pack.js" type="text/javascript">
```

3.) 使用 class="multi" 在您的 Web 表单上添加文件输入：

```
<input type="file" class="multi" />
```

4.) 在表单提交时执行一些代码或调用这样的方法：

```
 void SendMail(string from, string to, string subject, string body, string smtpServer)
    {
        // create mail message
        MailMessage mail = new MailMessage(from, to, subject, body);

        // attach posted files
        for (int i = 0; i < Request.Files.Count; i++)
        {
            HttpPostedFile file = Request.Files[i];
            mail.Attachments.Add(new Attachment(file.InputStream, file.FileName));
        }

        //send email
        new SmtpClient(smtpServer).Send(mail);
    } 
```

这就是我将多个文件附加到从 aspx 页面发送的电子邮件中所要做的全部工作。

如果您想增加可以上传的文件的总大小，请将其添加到您的 web.config 文件中：

```
<system.web>
    <httpRuntime executionTimeout="240" maxRequestLength="30720"/>
</system.web> 
```

executionTimeout 以秒为单位，maxRequestLength 以千字节为单位。在此示例中，请求将在 4 分钟后超时，并允许 30mb 请求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T20:38:50.280

自从我在 .NET 中做那种事情以来已经有一段时间了，但是一旦你开始动态地克隆表单输入，我认为你必须去 Request.Form 并手动查找提交的值。[我编写了 jQuery 代码来克隆一些带有顺序标识符的](http://www.thosecleverkids.com/blog/2007/12/11/clone-table-rows-with-form-elements-in-a-net-style/)（非文件）输入。只要您有唯一的标识符，您就可以运行一个循环来查看 Request.Form["MultiFile1_F" + counter] 是否存在并从那里开始。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-22T21:57:13.503

我强烈推荐[Uploadify](http://www.uploadify.com/)作为一个多文件上传器。它使用 jquery 和 flash 允许用户通过 ctrl + 单击所有需要的文件一次上传多个文件。然后它会显示一个文件上传队列，并在完成时从队列中删除文件。它还允许您指定允许用户上传的扩展名，从而避免您进行扩展名验证。

**编辑：**
如果你不想使用 flash [Ajax Upload](http://valums.com/ajax-upload/)也很有效。如果我的网站公司网站上的用户没有最适合 uploadify 的正确版本的 flash，我会切换到 Ajax Upload。他们都对我工作得很好。

# c++ - 确定两个路径是否引用 Windows 中同一文件的最佳方法？

> ID：562701
> 
> 赞同：16
> 
> 时间：2009-02-18T20:32:25.180
> 
> 标签：c++, winapi, path

我将如何比较 2 个字符串以确定它们是否使用 C/C++ 在 Win32 中引用相同的路径？

虽然这会处理很多情况，但它会遗漏一些事情：

```
_tcsicmp(szPath1, szPath2) == 0 
```

例如：

*   正斜杠/反斜杠

*   相对/绝对路径。

[编辑] 标题已更改以匹配现有的 C# 问题。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-18T20:49:05.060

使用 打开两个文件`CreateFile`，调用`GetFileInformationByHandle`两者，然后比较`dwVolumeSerialNumber`, `nFileIndexLow`, `nFileIndexHigh`。如果所有三个都相等，则它们都指向同一个文件：

[`GetFileInformationByHandle`功能](http://msdn.microsoft.com/en-us/library/aa364952(VS.85).aspx)

[`BY_HANDLE_FILE_INFORMATION`结构](http://msdn.microsoft.com/en-us/library/aa363788.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-05-13T20:10:23.937

## 文件系统库

从 C++17 开始，您可以使用[标准文件系统库](http://en.cppreference.com/w/cpp/filesystem)。使用`#include <filesystem>`. 您甚至可以在旧版本的 C++ 中访问它，请参阅脚注。

您正在寻找的功能是`equivalent`，在命名空间下`std::filesystem`：

```
bool std::filesystem::equivalent(const std::filesystem::path& p1, const filesystem::path& p2 ); 
```

从[文档](http://en.cppreference.com/w/cpp/filesystem/equivalent)中总结：此函数将两个路径作为参数，如果它们引用相同的文件或目录，则返回 true，否则返回 false。还有一个`noexcept`带第三个参数的重载：`std::error_code`保存任何可能的错误的地方。

## 例子

```
#include <filesystem>
#include <iostream>
//...

int main() {
    std::filesystem::path p1 = ".";
    std::filesystem::path p2 = fs::current_path();
    std::cout << std::filesystem::equivalent(p1, p2);
    //...
} 
```

输出：

```
1 
```

## 使用 C++17 之前的文件系统

要在 C++17 之前的版本中使用此库，您必须在编译器中启用实验性语言功能并以这种方式包含该库：`#include <experimental/filesystem>`. 然后，您可以在命名空间下使用它的功能`std::experimental::filesystem`。请注意，实验文件系统库可能与 C++17 不同。[请参阅此处](http://en.cppreference.com/w/cpp/experimental/fs)的文档。
例如：

```
#include <experimental/filesystem>
//...
std::experimental::filesystem::equivalent(p1, p2); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-18T20:38:50.560

使用 kernel32.dll 中的 GetFullPathName，这将为您提供文件的绝对路径。然后将其与您使用简单字符串比较的其他路径进行比较

编辑：代码

```
TCHAR buffer1[1000];
TCHAR buffer2[1000];
TCHAR buffer3[1000];
TCHAR buffer4[1000];

GetFullPathName(TEXT("C:\\Temp\\..\\autoexec.bat"),1000,buffer1,NULL);
GetFullPathName(TEXT("C:\\autoexec.bat"),1000,buffer2,NULL);
GetFullPathName(TEXT("\\autoexec.bat"),1000,buffer3,NULL);
GetFullPathName(TEXT("C:/autoexec.bat"),1000,buffer4,NULL);
_tprintf(TEXT("Path1: %s\n"), buffer1);
_tprintf(TEXT("Path2: %s\n"), buffer2);
_tprintf(TEXT("Path3: %s\n"), buffer3);
_tprintf(TEXT("Path4: %s\n"), buffer4); 
```

上面的代码将为所有三个路径表示打印相同的路径.. 之后您可能想要进行不区分大小写的搜索

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-18T20:40:23.817

看到这个问题：[Best way to determine if two path reference to same file in C#](https://stackoverflow.com/questions/410705/best-way-to-determine-if-two-path-reference-to-same-file-in-c)

问题是关于 C#，但答案只是 Win32 API 调用`GetFileInformationByHandle`。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-18T20:37:05.963

简单的字符串比较不足以比较路径是否相等。在 Windows 中，c:\foo\bar.txt 和 c:\temp\bar.txt 很可能通过文件系统中的符号链接和硬链接指向完全相同的文件。

正确比较路径本质上会强制您打开两个文件并比较低级句柄信息。任何其他方法都会产生不稳定的结果。

查看 Lucian 就该主题发表的这篇出色的帖子。该代码在 VB 中，但由于他 PInvoke 了大多数方法，因此可以很好地转换为 C/C++。

[http://blogs.msdn.com/vbteam/archive/2008/09/22/to-compare-two-filenames-lucian-wischik.aspx](http://blogs.msdn.com/vbteam/archive/2008/09/22/to-compare-two-filenames-lucian-wischik.aspx)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-18T21:03:19.957

根据有关[GetFileInformationByHandle()](http://msdn.microsoft.com/en-us/library/aa364952(VS.85).aspx)的答案，这里是代码。

**注意：这仅在文件已存在时才有效...**

```
//Determine if 2 paths point ot the same file...
//Note: This only works if the file exists
static bool IsSameFile(LPCWSTR szPath1, LPCWSTR szPath2)
{
    //Validate the input
    _ASSERT(szPath1 != NULL);
    _ASSERT(szPath2 != NULL);

    //Get file handles
    HANDLE handle1 = ::CreateFileW(szPath1, 0, FILE_SHARE_DELETE | FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL); 
    HANDLE handle2 = ::CreateFileW(szPath2, 0, FILE_SHARE_DELETE | FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL); 

    bool bResult = false;

    //if we could open both paths...
    if (handle1 != INVALID_HANDLE_VALUE && handle2 != INVALID_HANDLE_VALUE)
    {
        BY_HANDLE_FILE_INFORMATION fileInfo1;
        BY_HANDLE_FILE_INFORMATION fileInfo2;
        if (::GetFileInformationByHandle(handle1, &fileInfo1) && ::GetFileInformationByHandle(handle2, &fileInfo2))
        {
            //the paths are the same if they refer to the same file (fileindex) on the same volume (volume serial number)
            bResult = fileInfo1.dwVolumeSerialNumber == fileInfo2.dwVolumeSerialNumber &&
                      fileInfo1.nFileIndexHigh == fileInfo2.nFileIndexHigh &&
                      fileInfo1.nFileIndexLow == fileInfo2.nFileIndexLow;
        }
    }

    //free the handles
    if (handle1 != INVALID_HANDLE_VALUE )
    {
        ::CloseHandle(handle1);
    }

    if (handle2 != INVALID_HANDLE_VALUE )
    {
        ::CloseHandle(handle2);
    }

    //return the result
    return bResult;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-05-21T19:27:22.067

如果您有权访问 Boost 库，请尝试

```
bool boost::filesystem::path::equivalent( const path& p1, const path& p2 ) 
```

[http://www.boost.org/doc/libs/1_53_0/libs/filesystem/doc/reference.html#equivalent](http://www.boost.org/doc/libs/1_53_0/libs/filesystem/doc/reference.html#equivalent)

从文档中总结：`true`如果给定的`path`对象解析为相同的文件系统实体，则返回，否则返回`false`。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-18T21:22:31.470

您需要做的是获取规范路径。

对于您要求文件系统转换为规范路径或为您提供唯一标识文件的标识符（例如 iNode）的每个路径。

然后比较规范路径或唯一标识符。

注意：不要试图自己找出锥形路径，文件系统可以用符号链接等做一些不容易处理的事情，除非你非常熟悉文件系统。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-18T20:44:13.730

如果您引用 UNC 或规范路径（即本地路径以外的任何内容），比较实际路径字符串将不会产生准确的结果。

shlwapi.h 有一些[路径函数](http://msdn.microsoft.com/en-us/library/bb773559(VS.85).aspx)，可能对您确定路径是否相同有用。

它包含像[PathIsRoot](http://msdn.microsoft.com/en-us/library/bb773674(VS.85).aspx)这样的函数，可以在更大范围的函数中使用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-04T17:43:47.910

如果文件存在并且您可以处理打开文件可能导致的竞争条件和性能损失，那么适用于任何平台的不完美解决方案是打开一个文件自行写入，关闭它，然后再次打开它进行写入打开另一个文件进行写入后。由于只允许写访问是独占的，如果您能够打开第一个文件以进行第一次写入但不能第二次打开，那么当您尝试打开这两个文件时，您可能会阻止您自己的请求。

（当然，也有可能是系统的其他部分打开了您的文件之一）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-03-15T21:40:35.390

打开这两个文件并使用**[`GetFinalPathNameByHandle()`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364962.aspx)**s `HANDLE`. 然后比较路径。

# c# - 如何通过 SqlCeCommand 对象禁用 sql server 精简版中的所有表索引？

> ID：562705
> 
> 赞同：4
> 
> 时间：2009-02-18T20:33:48.280
> 
> 标签：c#, indexing, sql-server-ce, ddl

我正在尝试向 SqlCe 数据库（版本 3.5，哦，使用 C# 3）进行大量批量插入。我尝试了各种方法（表适配器插入、准备好的参数化查询、sqlceresultset 插入等）。正如我在许多网站上所读到的，最快的时间是在表直接模式下使用 SqlCeResultSet 对象。

我想通过在插入之前禁用必要表上的所有索引来进一步加快速度（然后我将在之后重建它们）。我在使 ALTER INDEX 语句工作时遇到问题（以前从未使用过它，所以我确信我忽略了一些简单的东西）。

基本上我已经创建了一个 SqlCeCommandObject 并以下列方式设置了一个 alter 语句（连接对象已经设置并打开等）：

```
.
.
.
SqlCeCommand disableIndexCommand = Connection.CreateCommand();
disableIndexCommand.CommandText = "ALTER INDEX ALL ON ItemMaster DISABLE";
disableIndexCommand.ExecuteNonQuery();
.
.
. 
```

当我尝试运行此代码时，出现以下错误：

> 解析查询时出错。[令牌行号 = 1，令牌行偏移量 = 7，错误令牌 = INDEX]

在我看来，它不理解 alter 语句中的 INDEX 关键字。SqlCe 不支持这个吗？

谢谢

[更新] - 我尝试了其他 DDL 语句（如 DROP INDEX、CREATE INDEX），但我似乎无法让它们中的任何一个工作？就 DDL 语句而言，我一直在到处搜索，试图找到 SSCE 中支持和不支持的内容的列表。没运气。有谁知道这方面的好资源。我必须说，关于 sqlce compact 3.5 版的 MS 文档毫无用处...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-19T10:33:28.417

SqlServerCe 上的 DROP INDEX 语法为：

```
DROP INDEX [TableName].IndexName 
```

SqlServerCe 中没有 ALTER INDEX 语法，所以当它在“INDEX”处说“错误解析”时，因为它在寻找“TABLE”，所以 ALTER 在 SqlServerCe 中唯一有效。

**编辑：**至于文档，我发现最好的方法是下载[Books Online](http://www.microsoft.com/downloads/details.aspx?FamilyId=07829770-73A7-41E4-880D-E74B1A353623&displaylang=en)。如果您未使用 3.5 SP1，请[在此处](http://www.microsoft.com/Sqlserver/2005/en/us/compact-downloads.aspx)查找更完整的可用下载列表。

# c# - 锁定语句 C#

> ID：562708
> 
> 赞同：6
> 
> 时间：2009-02-18T20:34:47.310
> 
> 标签：c#, locking

假设我有三个线程需要访问一个集合，并且我在每个线程的访问周围使用了一个锁块。发生以下情况...

(1) 线程 1 获得对集合的锁定
(2) 线程 2 被阻塞
(3) 线程 3 被阻塞

当线程 1 释放锁时，接下来谁来获取锁？是FIFO访问吗？

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-18T20:37:18.070

您不应该关心下一个获得锁的人。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-18T20:45:06.443

您的问题暗示您正在寻找 FIFO 行为？然后你可能想试试 Jakub Sloup 的这段代码：

**[监视/锁定在 C# 中记住顺序以模拟 FIFO](http://www.jakubsloup.cz/Blog/March-2009/Monitor-lock-which-remember-order-in-C--to-simulat.aspx)**

正如其他答案中已经提到的，不能保证订单等待线程会收到锁。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-18T20:37:47.863

假设它就像 Win32，那么答案是它可能是 FIFO 但它可能不是（它是别的东西）。例如，更高优先级的线程应该是第一个；但是线程可以根据他们最近所做的事情暂时提高或降低其优先级。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-18T20:59:15.583

作为对您问题的回答，所有线程都会收到 monitor.pulse ，然后它将争夺下一个获得锁的人。

我相信 wintellect 的人写了一篇关于这种行为如何导致不公平情况的博客，但监视器中根本没有公平。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-18T21:01:41.787

根据定义，答案是不确定的。

# javascript - 如何从另一个封装函数引用封装的 javascript 函数？

> ID：562710
> 
> 赞同：1
> 
> 时间：2009-02-18T20:35:13.533
> 
> 标签：javascript, function, scope

我是面向对象的 JavaScript 新手。我有一个设置方法，我想a）检查一个元素是否为空，如果是，则等待并再次调用自己，b）观察按钮的单击事件。

```
ErrorBox.prototype.setUpErrorBox = function(btnClientID) {
    if (btnClientID == null) {
        setTimeout("setUpErrorBox()", 1000)
        return;
    }
    Event.observe(btnClientID, 'click', setValSummary);
} 
```

我收到 setUpErrorBox 和 setValSummary 不存在的错误（它们不存在）。我怎样才能引用它们？我试过 this.setValSummary 没有用。

换句话说，我如何在javascript中从同一个类的另一个方法调用一个类的等效方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T20:50:48.287

使用闭包来保持你的执行上下文：

```
ErrorBox.prototype.setUpErrorBox = function(btnClientID) 
{
   var box = this; // object context reference
   if (btnClientID == null) 
   {
      // use closure as event handler to maintain context
      setTimeout(function() { box.setUpErrorBox() }, 1000)
      return;
   }
   // again, use closure as event handler to maintain context
   Event.observe(btnClientID, 'click', function() { box.setValSummary() });
} 
```

### 另请参阅：[JavaScript 回调范围](https://stackoverflow.com/questions/183214/javascript-callback-scope)

# css - 在 CSS 中重置 Margins/Padding 时使用 * 是否错误？

> ID：562713
> 
> 赞同：2
> 
> 时间：2009-02-18T20:35:48.900
> 
> 标签：css, performance

是否应该回避以下内容，或者因其简单而受到赞扬？

作为记录，我在我构建的每个站点中都使用它，但我注意到它在许多主流 CSS 重置框架中不存在 - 他们是否也有理由不使用它？

```
* { margin: 0; padding: 0; } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T14:18:27.533

最好不要使用它，因为它会导致表单元素出现问题，尤其是输入按钮和选择框。

见[christianmontoya.com](http://www.christianmontoya.com/2007/02/01/css-techniques-i-use-all-the-time/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T23:57:49.320

通用选择器会降低很多速度，尤其是在某些 WAP 浏览器上。想一想：它匹配文档树中的*每一个*元素。

此外，对于大多数元素，您将继续指定与 0 不同的边距/填充。就像这样，为所有元素重新设置它们是没有意义的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T08:44:49.087

您绝对不想做的事情是使用通用选择器的相对大小。如果你这样做，事情会很快变得奇怪。;-)

为了获得良好的基线，我建议使用久经考验的[重置样式表](http://developer.yahoo.com/yui/reset/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T12:27:11.010

我曾经在 * {margin:0;padding:0}、Eric Meyer 的重置、YUI 重置和完全没有 CSS 之间进行了一些性能测试。性能差异可以忽略不计。

也就是说，我现在使用 Eric Meyer 的重置，这样我就不会丢失输入按钮的格式，这实际上使按钮更容易跨浏览器设置样式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T20:45:03.043

如果您的意图是设置每个元素的填充和边距，那么该选择器应该没有问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T20:46:38.327

它没有什么特别的问题。* 被称为“通用选择器”，浏览器对它的支持通常被认为是好的，尽管 IE 确实有一些晦涩的错误，像往常一样：
[http://reference.sitepoint.com/css/universalselector#compatibilitysection](http://reference.sitepoint.com/css/universalselector#compatibilitysection)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-18T21:02:00.083

我认为这是构建 CSS 布局的重要第一步。它消除了不同浏览器的许多麻烦的默认样式，并允许我获得更多独立于浏览器的结果。

当然，我将它与 IE 的条件注释结合起来，在我的整个页面上编写特定于 IE 版本的 div，并使用它们来处理 IE 的错误（因为 FF 等人往往更准确于 CSS 规范）。

编辑 - 我从来没有注意到它有任何性能问题。

# javascript - JQuery 是否有办法取消绑定随机 HTML 字符串中的事件？

> ID：562719
> 
> 赞同：0
> 
> 时间：2009-02-18T20:37:38.957
> 
> 标签：javascript, jquery

我正在使用 JQuery 在 div 中设置 HTML。像这样的东西：

```
$(div).html(strHtmlBlob); 
```

strHtmlBlob 是通过 Ajax 从服务器返回的 HTML 块。分配之后，我通过执行以下操作为新 HTML blob 中的元素设置了一些事件：

```
$(div).find("a").click(a_ClickHandler); 
```

这一切都很好。问题是删除事件。我想确保正确清理 DOM。

我正在像这样删除 HTML：

```
$(div).html(""); 
```

但我可以看到事件仍然存在。有没有办法清理不再存在的元素的事件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T20:38:36.973

使用 .remove() 而不是 .html("")

这将一次清除所有元素和事件。如果你愿意的话，JQuery 会在幕后做很多清理魔法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T20:38:19.313

```
$(div).find('a').unbind('click'); 
```

查看[文档](http://docs.jquery.com/Events/unbind#typefn)。

或者，您应该[`empty()`](http://docs.jquery.com/Manipulation/empty)：

```
$(div).empty(); 
```

根据文档：

> 请注意，从 1.2.2 开始的此函数还将删除所有事件处理程序和内部缓存的数据。

# asp.net - 是否可以通过 Response.Write 返回 NULL 值？

> ID：562725
> 
> 赞同：0
> 
> 时间：2009-02-18T20:38:41.357
> 
> 标签：asp.net, null, response.write

```
context.Response.ContentType = "text/plain";
context.Response.Write(returnString); 
```

如果 returnString 为 NULL 它会通过什么，还是会失败？

编辑：问题是如果可能的话，上面只是我意识到我可以测试的一个例子。但是，除了我的代码示例之外，我正在寻找任何其他可能的方法来做到这一点，我只是想不出在正文中没有重复问题标题中已经存在的信息的任何其他内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T22:49:30.373

虽然我同意其他人的观点，因为它可能很容易测试这个而不是问这个问题......但是，既然你问了，这里有一个代码示例给你。代码的结果是屏幕上没有显示任何文本。

```
 protected void Page_Load(object sender, EventArgs e)
    {
        string myString = null;
        Response.ContentType = "text/plain";
        Response.Write(myString);
        Response.End();
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T20:45:00.967

它相当于将一个空字符串传递给 Response.Write。

# c# - typedef 等效于 c# 中的重载

> ID：562735
> 
> 赞同：0
> 
> 时间：2009-02-18T20:41:26.170
> 
> 标签：c#, types, overloading, typedef

我有一堆代码，其中包含许多具有不同含义的整数（我宁愿使用通用解决方案，但对于一个具体示例：每月的一天与一年中的月份与年份等）。我希望能够根据这些含义重载类构造函数。

例如

```
int a; // takes role A
int b; // takes role B

var A = new Foo(a);  // should call one constructor
var B = new Foo(b);  // should call another constructor 
```

现在显然这行不通，但如果我可以定义一个类型（不仅仅是别名），`int`除了这样的名称之外，它是一个类型：

```
typedef int TypeA;  // stealing the C syntax
typedef int TypeB; 
```

我可以做我需要的重载，让类型系统跟踪什么是什么。*特别是，这将允许我确保值不会混淆，例如从函数返回的值作为年份不用作月份中的日期。*

在 c# 中是否有任何方法`class`或`struct`包装器可以做到这一点？

* * *

如果该解决方案也适用于浮点数和双精度数，那就太好了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-18T20:58:28.970

没有直接的 typedef 等效项，但您可以执行以下操作：

```
using TypeA = int;
using TypeB = int; 
```

但是，这只是给类型起别名，而不是创建新的强类型。因此，编译器仍会将它们视为`int`解析方法调用的时间。

更好的解决方案可能是创建简单的包装类来包装`int`并提供隐式转换，例如：

```
struct TypeA
{
   public TypeA(int value)
   {
      this.realValue = value;
   }

   private int realValue;
   public static implicit operator int(TypeA value)
   {
     return this.realValue;
   }

   public static implicit operator TypeA(int value)
   {
     return new TypeA(value);
   }
} 
```

但是，在大多数情况下，an`enum`会更合适。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-18T20:44:03.573

这可能很遥远，但你不能为此使用枚举吗？Enum base 是 int，但是是有类型的，你可以根据传递的 enum 的类型定义不同的构造函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T20:51:34.883

如果它只是用于构造函数，你不能使用这样的东西：

```
 int dom = 5;
int doy = 100;

Foo b = Foo.NewFromDayoftheMonth(dom);

Foo c = Foo.NewFromDayoftheYear(doy); 
```

其中每个方法都是静态的，并根据传入的参数创建一个新的 Foo 对象。

这对我来说似乎是一个解决方案，没有太多其他的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T21:12:04.537

我还将围绕值创建一个结构：

```
public struct TypeA
{
  private int value;
  public TypeA(int value)
  {
    this.value = value;
  }

  public static explicit operator int(TypeA a)
  {
     return a.value;
  }

  public static explicit operator TypeA(int value)
  {
     return new TypeA(value);
  }
} 
```

您还可以声明运算符来组合类型和方法，以围绕 int 值提供丰富的类型。

Year 类型可以提供一个`IsLeap`属性，一个月中的一天可以限制为 1 到 31 之间的值并提供特殊的算术。

# jquery - 我应该对 VS2008 中的 jquery 有多少智能感知？

> ID：562738
> 
> 赞同：5
> 
> 时间：2009-02-18T20:42:21.177
> 
> 标签：jquery, asp.net-mvc, visual-studio-2008, intellisense

不久前，我阅读了 ScottGu 的博客条目（[http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx](http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx)），它似乎暗示了比我正在看。我已经安装了 VS2008 及其服务包，并且我正在使用一个新的 MVC 项目和 RC1 版本的 asp.net MVC。我引用了 jquery-1.2.6.js 脚本，当我输入“$”时，我可以看到智能感知。但之后的任何事情都没有显示。这对于像我这样的 jquery 新手来说并不是特别有帮助，所以我希望我刚刚忘记了一些东西。

例如，当我尝试使用 Scott 博客文章中的特定脚本示例时：（ [来源：][[scottgu.com](http://www.scottgu.com/blogposts/jquerynov/step7.png)][）][![替代文字](https://i.stack.imgur.com/FJhXh.png)](https://i.stack.imgur.com/FJhXh.png)

对于他显示工具提示的“attr”，我没有得到任何智能感知操作。我应该期待这种智能感知帮助吗？如果是，我可以寻找什么来解决这个问题？

这是我的脚本参考。它在母版页 FWIW 中声明，我尝试使用 jquery 是在我的引用该母版页的页面中。

```
<head runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link href="~/Content/styles/default.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="~/Content/scripts/jquery-1.2.6.js"></script> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-18T20:45:02.730

您是否也安装了 jQuery-vsdoc.js 文件（与 jquery-1.2.6.js 位于同一位置）？此文件包含智能感知的注释。它记录在 ScottGu 博客文章的第 3 步中。

更新：

而且您还安装了[Visual Studio 补丁](http://code.msdn.microsoft.com/KB958502/Release/ProjectReleases.aspx?ReleaseId=1736)？

对我来说它有效（如 ScottGu 的博客所示），虽然我使用的是网站项目，而不是 MVC。我在母版页中添加了脚本参考：

```
<script src="jquery-1.3.1.js" type="text/javascript"></script> 
```

我在母版页和内容页中都获得了智能感知（使用您在问题中输入的代码进行了尝试）。

# c# - 我的 C# WPF 应用程序启动时出现 HRException

> ID：562745
> 
> 赞同：0
> 
> 时间：2009-02-18T20:43:39.100
> 
> 标签：c#, xaml, parsing, exception, assemblies

我有一个 C#`WPF`应用程序在启动时突然抛出异常，我不知道为什么。

例外是一个 C++ `HRException`，它出现在`MSCORLIB`in 中`CreateInstanceSlow()`，它被调用 from `CreateInstance()`，它`BamlRecordReader.CreateInstanceFromType()`在`System.Windows.Markup`程序集中被调用 from 。

我从这个应用程序中移动了我的所有程序集，以及我刚刚升级的第三方库，最后让应用程序再次运行（尽管它只是一个 shell）。然后我重新添加了第三方库，没问题，然后重新添加了我的每个程序集，将每个程序集添加为引用，并在我的主应用程序中声明该程序集中定义的类型的变量，这工作**正常**。

所以我把这一切都吹走了，恢复到签入的内容，我又回到了异常，所以我不认为这是一个找不到的 DLL，或者一个在初始化时爆炸的 DLL - 但我无法弄清楚这是什么。

我尝试降低调用堆栈并查看解析函数，但调试器告诉我，由于堆栈顶部有一个本机框架，我无法检查大多数变量。

我真的很感激有关如何弄清楚`XAML`抛出异常时实际解析的内容的任何提示，以及听取其他有类似问题的人的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T15:31:24.070

我将首先确保 VS 启用了本机和托管调试，并且符号服务器正常工作。这至少应该允许堆栈跟踪。

另一种选择可能是强制进程 dunp 并使用 WinDBG（以及大量涵盖此类调试的博客/书籍阅读）。

此外，XAML 负载是否是最简单的包装器（即足以使用 XamlReader 实例）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T21:48:51.237

虽然我仍然很欣赏有关如何调试这些异常的提示，但我能够追踪到这一点。我的一个 DLL 使用了另一个 DLL 中的一个类，该类的构建不正确（尽管我仍然不确定为什么）。一旦我能够重建该 DLL 和使用它的那个，然后重建我的应用程序，一切正常。但令人沮丧的是，我盲目地在黑暗中刺伤，通过反复试验来找出导致问题的 DLL（以及该 DLL 中的哪个类）。系统唯一能告诉我的就是某处的某个 XAML 中存在某种错误。我应该提到，我在 C# 应用程序中使用的这些程序集是用 C++/CLI 编写的，并且包含本机 C++ 代码——但我不认为这真的是一个互操作问题。所以无论如何，

# c# - “this”关键字可以与值类型一起使用吗？

> ID：562749
> 
> 赞同：6
> 
> 时间：2009-02-18T20:44:06.303
> 
> 标签：c#, .net

在 .NET Reflector 中查看 Int32.GetHashCode() 的反汇编代码时，我注意到“this”关键字的这种有趣用法：

```
public override int GetHashCode()
{
    return this;
} 
```

我一直认为“this”只用于引用类型而不是值类型。在上面的代码中，每次尝试获取 int 的哈希码时都会使用装箱吗？

来自 MSDN 中“this”关键字的文档： - this 关键字指的是类的当前实例

问候

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-18T20:51:24.820

是的，`this`对值类型有效。它不会导致拳击。虽然它引用了值类型，但它不是与引用类型引用相同的引用——它是编译/开发时的便利，而不是运行时引用。

C# 规范的第 7.5.7 节指出：

> *   当 this 在结构的实例构造函数中的主表达式中使用时，它被归类为变量。变量的类型是发生使用的结构的实例类型（第 10.3.1 节），变量代表正在构造的结构。struct 的实例构造函数的 this 变量的行为与 struct 类型的 out 参数完全相同 - 特别是，这意味着必须在实例构造函数的每个执行路径中明确分配该变量。
>     
>     
> *   当 this 用于结构的实例方法或实例访问器中的主表达式时，它被归类为变量。变量的类型是发生使用的结构的实例类型（第 10.3.1 节）。
>     
>     *   如果方法或访问器不是迭代器（第 10.14 节），则 this 变量表示为其调用方法或访问器的结构，其行为与结构类型的 ref 参数完全相同。
>         
>     *   如果方法或访问器是迭代器，则 this 变量表示为其调用方法或访问器的结构的副本，并且其行为与结构类型的值参数完全相同。

# distributed-computing - 如何在公司之间发送消息

> ID：562753
> 
> 赞同：3
> 
> 时间：2009-02-18T20:44:23.387
> 
> 标签：distributed-computing, edi, b2b

我经常看到自己需要在公司之间设置消息/数据/文件的自动传输。

除了可怕的 EDIFACT、Odette 和其他一些“大”电子数据交换标准，每个行业都有几十个甚至几百个相对健全的相对轻量级、相对完善的订单文件格式等。

我缺少的是在机器之间移动这种格式的文件的正确协议。协议应该支持

1.  验证
2.  可与 MS Windows 和 unix 上的标准工具一起使用
3.  支持事务，例如：文件已传输或未传输。但它永远不会在半传输状态下收到。
4.  传输加密
5.  防火墙友好
6.  一种“捆绑”的方式，例如 xml 描述和一堆 PDF。

今天基本上每个人都回退到 FTP。但是 FTP 服务器很难满足要求 3、5 和 6。

有没有更好的办法？像[Amazon SQS](http://aws.amazon.com/sqs/)这样的东西可以用来从一家公司向另一家公司发送消息吗？

**澄清：**我的意思是中小型公司。我们的合作伙伴通常没有内部开发人员，有时甚至没有内部 IT 人员。因此，至少需要在连接的一侧进行绝对最小的设置工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T20:49:26.667

SOAP 和 Web 服务满足所有要求

这是[Java 开源 Web 服务框架的列表](http://java-source.net/open-source/web-services-tools)

# svn - 如何防止颠覆用户访问存储库的一部分？

> ID：562755
> 
> 赞同：10
> 
> 时间：2009-02-18T20:44:33.167
> 
> 标签：svn, permissions, version-control, perforce

我正在为一个项目使用托管在 Dreamhost 上的 Subversion 存储库。

我想在受限的基础上允许访问某些用户。至少我想允许一些用户只读访问，但理想情况下我想阻止一些用户看到存储库的某些部分。尽管我认为它存在，但我找不到 Subversion 的网络文档中提到的用户权限？

我习惯使用 Perforce，所以我想要的是`p4 protect`对 Perforce 有什么作用。

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-18T20:51:08.067

查看 conf/ 目录中的 authz 文件。您可以为特定用户和特定目录设置权限。在 svnserve.conf 中，您可以指定匿名用户是否具有读取权限。

这是我的存储库中的一个示例：

```
[groups]
project1_team = dave, john, andy

[/]
* =
dave = rw

[/project1]
@project1_team = rw

[/project2]
andy = r 
```

这里发生的是我定义了一组对 project1 具有完全访问权限的用户；dave（恰好是我）对整个存储库具有完全访问权限，而 andy 对 project2 具有只读访问权限。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T20:55:38.617

在 Web 主机上，通常有一个配置文件（可以命名为任何名称）来运行[授权](http://svnbook.red-bean.com/en/1.4/svn-book.html#svn.serverconfig.svnserve.auth)。每个存储库都有一个类似
[my-repository:/]
myuser = rw的列表

这将授予“myuser”对整个存储库的读写权限。你也可以这样做：

[my-repository/just-this-folder/:]
somejerk: r

哪个应该做你想做的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T22:26:16.773

如果您同时使用 SVN 和 Apache，请按照以下步骤操作：

请注意，您可以管理的最佳权限级别将基于每个存储库。假设您有 repository1 和 repository2

1-在单独的文件中为每个存储库创建适当的用户：

```
sudo htpasswd -c -m /etc/apache2/dav_svn_REPOSITORY1.passwd $user_name_for_repository1
 sudo htpasswd -c -m /etc/apache2/dav_svn_REPOSITORY2.passwd $user_name_for_repository2 
```

如果要向每个文件添加更多用户，请从命令中删除 -c。因为它只是用于第一次创建文件。

2-编辑以下文件：

```
nano /etc/apache2/mods-available/dav_svn.conf 
```

你会有这样的部分：

```
<Location /svn>
  SVNPath $your svn repository path
  AuthType Basic
  AuthName "Subversion Repository"
  AuthUserFile /etc/apache2/dav_svn.passwd
  Require valid-user
  SSLRequireSSL
</Location> 
```

为您拥有的每个存储库复制这个块，在我们的例子中，您需要一个像这样的块。现在，摆脱（删除）上述块并添加以下块，它们是上述块的更改副本：

```
<Location /svn/repository1>
  SVNPath $your svn repository1 path
  AuthType Basic
  AuthName "Subversion Repository"
  AuthUserFile /etc/apache2/dav_svn_REPOSITORY1.passwd
  Require valid-user
  SSLRequireSSL
</Location>
<Location /svn/repository2>
  SVNPath $your svn repository2 path
  AuthType Basic
  AuthName "Subversion Repository"
  AuthUserFile /etc/apache2/dav_svn_REPOSITORY2.passwd
  Require valid-user
  SSLRequireSSL
</Location> 
```

3- 保存文件并重新启动 Apache。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T20:49:56.477

我不熟悉 Dreamhost 使用的具体配置，但强制执行权限的典型方式是使用 Apache 身份验证机制。这是 Subversion 文档中的[相关页面](http://svnbook.red-bean.com/en/1.0/ch06s04.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T20:55:13.097

[Subversion Book](http://svnbook.red-bean.com/en/1.0/)在[这里](http://svnbook.red-bean.com/en/1.0/ch06s03.html#svn-ch-6-sect-3.2)有你的答案。

说真的，人们：在纠缠其他人之前阅读最基本的文档什么时候过时了？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T22:41:05.820

请参阅上面接受的答案。但是，对于 Dreamhost 的细节，在 ~/svn 目录中，每个存储库都有两个文件，`repo_name.access`并且`repo_name.passwd`. 其中 repo_name 是您为存储库指定的名称。您可以按照接受的答案中的描述编辑 repo_name.access 文件。

编辑后不要忘记，`chmod 644 repo_name.access`以便 apache 可以访问它。

# .net - 构建时如何在 .NET 依赖链上要求 x86

> ID：562756
> 
> 赞同：3
> 
> 时间：2009-02-18T20:44:57.660
> 
> 标签：.net, x86, 64-bit, manifest, sxs

我们有几个项目使用[p4.net](http://p4dotnet.sourceforge.net/index.php/P4.Net_Overview)，一个托管 DLL，它又依赖于 p4dn.dll，一个 32 位非托管 DLL。这在 x64 系统上存在问题，所以我不得不去每个使用 p4.net 的项目并将其处理器类型设置为 x86。

如果我理解正确的问题，那就是当 .NET 加载一个 exe 时，它​​会检查清单，如果没有，它会做最适合处理器类型的任何事情。然后，当它运行到 32 位 dll 时，它会呕吐。

我可以去每个使用 p4.net 的项目并将其标记为 32 位。但是我们有很多这样的。此外，人们将继续制作新的并忘记设置 32 位，然后当其他人尝试在 x64 上使用它时，我们将再次遇到此问题。

我的问题是：有没有办法让 .NET 自动加载任何使用 p4dn.dll 作为 32 位的应用程序？如果做不到这一点，IDE 有没有办法检测到这一点并且无法构建？

或者是否可以制作一个我可以放在 p4api 或 p4dn.dll 旁边的 .manifest 文件，以便使用它们的任何应用程序将自动以 32 位运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T21:54:48.443

如果您绝对没有其他选择，您可以使用*corflags*作为自动构建脚本的一部分，将所有 .NET dll 标记为 x86 - `corflags /32bit+ file.dll`。尽管我认为对开发人员进行适当的教育是更充分的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T20:53:47.140

CLR 仅在从 GAC 加载程序集时检查平台类型。我猜 p4dn.dll 包含在应用程序根文件夹下，所以我认为你的逻辑是错误的。

当 p4dn.dll 在 WoW64 模式下运行并且您的应用程序本机在 x64 模式下运行时，它似乎无法使用。我认为最好的方法是编译所有针对 x86 (32) 平台的项目。或者将其分解为多个部分，因此 p4dn.dll 调用者将始终在 WoW64 模式下运行。

此外，您应该联系 p4net 开发人员以添加完整的 x64 平台支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T20:54:59.180

我不知道有任何方法可以自动执行此操作。我建议您执行以下操作：

*   培训您的开发人员，
*   将此主题添加到您的内部知识库并
*   将 x64 平台添加到您的测试环境

此外，您可能会考虑编写一个 VS 插件来检查正确的目标平台。但是也可能会动态创建 COM 组件......

# java - 如何使用 Java 与 MySQL 进行交互？

> ID：562762
> 
> 赞同：0
> 
> 时间：2009-02-18T20:45:20.233
> 
> 标签：java, mysql

我假设我需要使用 Connector\J 和 JDBC 来实现这一点，但我似乎无法使用 CLASSPATH 东西“安装”Connector\J。我怎么做 ？如果相关，我使用 IntelliJ IDE。

我正在寻找一种与 mysql 数据库对话并执行并打印出一些基本查询的方法，但我没有得到任何结果，因为我什至无法与数据库对话。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T20:49:42.720

您可能会遵循以下示例：

[http://www.kitebird.com/articles/jdbc.html](http://www.kitebird.com/articles/jdbc.html)

但是，您可能需要考虑使用[Hibernate](http://www.hibernate.org/)，除非您只执行几个基本查询。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-18T20:53:05.473

请参阅[将 MySQL 与 Java 结合使用——来自](http://dev.mysql.com/usingmysql/java/)[Google](http://www.google.com/search?q=mysql+java)的第一个链接。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-18T21:21:37.790

我喜欢[这个教程](http://www.developer.com/java/data/article.php/3417381)，因为它非常详细和彻底。几乎涵盖了从下载和安装 MySQL 和 Connector/J 到编写和运行查询的每一步。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T20:59:16.847

哪个版本的 IntelliJ？

您需要将[MySQL Connector-J](http://www.mysql.com/products/connector/j/) JAR 添加到您的项目依赖项中。

打开您的 IntelliJ 设置（顶部菜单栏中的“扳手”），转到“库”，单击“附加类”，然后添加您在上面下载的 MySQL Connector-J JAR。这会将它放在您的 CLASSPATH 中。

如果您仍然有问题，则意味着您没有正确的驱动程序类名称。它应该是 com.mysql.jdbc.Driver。

# c# - Doxygen：隐藏私有/受保护的方法......和提示

> ID：562763
> 
> 赞同：15
> 
> 时间：2009-02-18T20:46:21.760
> 
> 标签：c#, documentation, doxygen

我正在使用 Doxygen 为我们的 API 生成文档，用 C# 编写。但是，它公开了私有/受保护的成员。有没有办法隐藏这些？

我想出了如何隐藏文件：EXCLUDE = 文件名列表

然而，我需要更多的粒度，从而保护用户免受不必要的 API 噪音。一个示例 Doxygen 文件以及提示/技巧将不胜感激。

您使用什么工具从源代码生成 API？

当我通过 C++ 在 C# 中使用 Doxygen 时，我感觉有点留在 18 世纪。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-18T21:03:07.663

我不知道 Doxygen 对 C# 的支持程度如何。

为了隐藏私有成员，您更改`Doxyfile`配置文件如下：

```
EXTRACT_PRIVATE        = YES 
```

可以为各种提取/隐藏代码元素设置许多其他选项，例如，引用`Doxyfile`自身：

```
# If the EXTRACT_ALL tag is set to YES doxygen will assume all entities in 
# documentation are documented, even if no documentation was available. 
# Private class members and static file members will be hidden unless 
# the EXTRACT_PRIVATE and EXTRACT_STATIC tags are set to YES

EXTRACT_ALL            = YES

# If the EXTRACT_PRIVATE tag is set to YES all private members of a class 
# will be included in the documentation.

EXTRACT_PRIVATE        = YES

# If the EXTRACT_STATIC tag is set to YES all static members of a file 
# will be included in the documentation.

EXTRACT_STATIC         = YES

# If the EXTRACT_LOCAL_CLASSES tag is set to YES classes (and structs) 
# defined locally in source files will be included in the documentation.
# If set to NO only classes defined in header files are included.

EXTRACT_LOCAL_CLASSES  = YES

# This flag is only useful for Objective-C code. When set to YES local
# methods, which are defined in the implementation section but not in
# the interface are included in the documentation.
# If set to NO (the default) only methods in the interface are included.

EXTRACT_LOCAL_METHODS  = YES

# If this flag is set to YES, the members of anonymous namespaces will be
# extracted and appear in the documentation as a namespace called
# 'anonymous_namespace{file}', where file will be replaced with the base
# name of the file that contains the anonymous namespace. By default
# anonymous namespace are hidden.

EXTRACT_ANON_NSPACES   = NO

# If the HIDE_UNDOC_MEMBERS tag is set to YES, Doxygen will hide all
# undocumented members of documented classes, files or namespaces.
# If set to NO (the default) these members will be included in the
# various overviews, but no documentation section is generated.
# This option has no effect if EXTRACT_ALL is enabled.

HIDE_UNDOC_MEMBERS     = NO

# If the HIDE_UNDOC_CLASSES tag is set to YES, Doxygen will hide all
# undocumented classes that are normally visible in the class hierarchy.
# If set to NO (the default) these classes will be included in the various
# overviews. This option has no effect if EXTRACT_ALL is enabled.

HIDE_UNDOC_CLASSES     = NO

# If the HIDE_FRIEND_COMPOUNDS tag is set to YES, Doxygen will hide all
# friend (class|struct|union) declarations.
# If set to NO (the default) these declarations will be included in the
# documentation.

HIDE_FRIEND_COMPOUNDS  = NO 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-10T17:02:30.523

查看 doxygen 的 @cond 标志。在 C# 中，我隐藏了一些密码加密成员，如下所示：

```
 //! @cond
    private const String ENCRYPTEDFLAG = "xxxENCFLAGxxx";
    private const String SEED = "hi_i_r_@_seed";
    //! @endcond 
```

doxygen 文档会让您相信您需要为 doxygen 定义并在 @cond 行上使用的条件符号，但这对我不起作用。这个方法做到了。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-10-05T17:14:37.733

这对我有用，可以隐藏大量代码和文档：

```
/*! \cond PRIVATE */
<here goes private documented source code>
/*! \endcond */ 
```

运行`ENABLED_SECTIONS = PRIVATE`以创建文档的内部版本。您可以有几个条件并根据受众启用/禁用它们。

要仅隐藏文档块的一部分，请使用`\internal`（除非找到，否则将隐藏到块的末尾`\endinternal`）

* * *

注意：如果您更喜欢使用 @ 表示法而不是反斜杠，则可以使用它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-18T21:39:50.837

来自[doxygen 手册](http://www.doxygen.nl/manual/config.html)的一些可能性：

`HIDE_UNDOC_MEMBERS`, `HIDE_UNDOC_CLASSES`: 显然只有当你只记录公共成员时才有效。

`INTERNAL_DOCS`: 允许您使用 \internal 标记从文档的“公共”版本中排除注释。

`ENABLED_SECTIONS`: 都是比较通用的版本`INTERNAL_DOCS`

# perl - 如果更改，plperlu 是否会重新加载 Perl 模块？

> ID：562766
> 
> 赞同：-1
> 
> 时间：2009-02-18T20:46:49.637
> 
> 标签：perl, postgresql, plperl

如果我在 plperlu 中写了一些东西，并且它使用了一个 Perl 模块（例如 MyModule::Foo），那么该模块何时会被重新加载？[它是否像 mod_perl 的Apache2::Reload](http://search.cpan.org/dist/Apache2-Reload)一样跟踪它们，以便触摸会导致重新解释？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-09-23T14:43:15.127

根据 Leon 的评论进行了一些测试后，显然 MyModule::Foo 从第一次成功使用时就保留在内存中，但仅在当前进程中（即数据库句柄）。

如果在编译它（当你定义一个使用它的函数时它会抱怨）或使用它（例如当你从你的函数中选择时）出现错误，它会重新加载它。但是，我看不出有一种方法可以在它成功运行后强制它在进程中重新加载，即使通过调用模块中的另一个子程序也会出错。

此外，如果您通过 Apache::DBI 访问 PostgreSQL，这意味着您的缓存句柄不会获取模块更改，除非您断开所有缓存句柄。

所以我想没有办法在进程中强制检查，例如 Apache2::Reload ...

# sql - 多线程处理数据库记录的最佳实践

> ID：562780
> 
> 赞同：15
> 
> 时间：2009-02-18T20:50:28.317
> 
> 标签：sql, database, multithreading, concurrency, sybase

我有一个进程查询表中`PROCESS_IND`='N'的记录，进行一些处理，然后将其更新`PROCESS_IND`为'Y'。

我想允许这个进程的多个实例运行，但不知道避免并发问题的最佳实践是什么。

我应该从哪里开始？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-20T08:46:00.433

我使用的模式如下：

*   创建列“lockedby”和“locktime”，它们分别是线程/进程/机器 ID 和时间戳（在多台机器之间拆分处理时需要机器 ID）
*   每个任务都会执行一个查询，例如：

    UPDATE taskstable SET lockedby=(my id), locktime=now() WHERE lockedby IS NULL ORDER BY ID LIMIT 10

其中 10 是“批量大小”。

*   然后每个任务执行一个 SELECT 来找出它“锁定”了哪些行以进行处理，并处理那些
*   每行完成后，将lockedby和locktime设置回NULL
*   所有这些都是在一个循环中完成的，尽可能多的批次。
*   cron 作业或计划任务会定期重置锁定时间过长的任何行的“lockedby”，因为它们可能是由已挂起或崩溃的任务完成的。然后会有人来接他们

LIMIT 10 是特定于 MySQL 的，但其他数据库也有等价物。ORDER BY 是导入以避免查询是不确定的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-19T11:19:39.570

尽管我理解我的意图，但我不同意立即进行行级锁定。这将减少您的响应时间，实际上可能会使您的情况变得更糟。如果在测试之后您发现 APL 的并发问题，您应该首先迭代移动到“数据页”锁定！

要真正正确地回答这个问题，需要有关表结构和所涉及的索引的更多信息，但需要进一步解释。

DOL，数据行锁定比所有页面/页面级锁定使用更多的锁定。管理所有锁的开销以及由于在缓存中请求更多锁结构而导致的可用内存减少将降低性能并抵消通过转向更多并发方法可能获得的任何收益。

测试您的方法，而不首先在 APL 上移动（所有页面锁定“默认”），然后如果发现问题移动到 DOL（首先是数据页，然后是数据行）。请记住，当您将表切换到 DOL 时，该表上的所有响应都会变得稍差，该表使用更多空间并且该表变得更容易出现碎片，需要定期维护。

所以简而言之，不要直接转移到数据行，首先尝试你的并发方法，然后如果有问题，首先使用数据页锁定，然后是最后的数据行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T20:58:11.530

您应该`row level locking`在桌子上启用：

```
CREATE TABLE mytable (...) LOCK DATAROWS 
```

那么你：

*   开始交易
*   使用选项选择您的行`FOR UPDATE`（这将锁定它）
*   做你想做的。

在事务结束之前，没有其他进程可以对这一行做任何事情。

*PS*有人提到使用`LOCK DATAROWS`.

是的，有开销，但对于这样的桌子，我几乎不会称之为问题。

但是如果你切换到`DATAPAGES`then 你可能只锁定一行`PAGE`（`2k`默认情况下），并且行驻留在一页中的进程将无法同时运行。

如果我们谈论的是同时锁定了几十行的表，那么几乎不会有任何明显的性能下降。

进程并发对于这样的设计更为重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T05:33:32.290

最明显的方法是加锁，如果你的数据库没有加锁，你可以自己添加一个“Locked”字段来实现。

简化并发的一些方法是随机访问未处理的项目，因此它们不是在第一个项目上竞争，而是随机分配访问。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-19T04:59:18.347

将该过程转换为单个 SQL 语句，并将多行作为单个批处理进行处理。这就是数据库应该如何工作的方式。

# java - Groovy 的最低 JDK

> ID：562796
> 
> 赞同：3
> 
> 时间：2009-02-18T20:53:58.433
> 
> 标签：java, groovy

我正在寻找编写一些 Groovy 代码来在任何地方执行安装任务，但由于我们支持的平台，我仅限于 java 1.5。知道这是否足以运行最新的 groovy 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T20:55:51.237

Java 1.5 应该可以工作。Groovy 文档声明您[至少需要 1.4](http://groovy.codehaus.org/Tutorial+1+-+Getting+started)。我将 Groovy 与 Java 1.5 一起使用，据我所知，一切正常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-17T15:29:44.390

截至 2015 年初，groovy 2.4.0 的构建环境（在 build.gradle 文件中）表明：

```
sourceCompatibility = 1.6
targetCompatibility = 1.6 
```

因此，对于现代 groovy，您需要 1.6 或更高版本。2.4 的文档表明 JDK 1.5 支持，这与构建环境不一致，因此如果您卡在 1.5 上，请注意。

此外，在`invokeDynamic`JDK 1.7 的更高版本中支持使用该指令（它存在但已知在 JDK 7u60 之前的版本中存在错误），这可能会提供一些性能改进。

# perl - %$var 是否取消引用 Perl 哈希？

> ID：562798
> 
> 赞同：9
> 
> 时间：2009-02-18T20:54:20.010
> 
> 标签：perl, reference

我正在向一个子程序发送一个哈希，并用它来获取它`my($arg_ref) = @_;`

但究竟是`%$arg_ref`什么？是否`%$`取消引用哈希？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-18T20:59:11.150

`$arg_ref`是一个标量，因为它使用了`$`印记。据推测，它包含一个哈希引用。所以是的，`%$arg_ref`尊重哈希引用。另一种写法是`%{$arg_ref}`. 这使得代码的意图更加清晰，尽管更加冗长。

引用自`perldata(1)`：

```
 Scalar values are always named with '$', even when referring
 to a scalar that is part of an array or a hash.  The '$'
 symbol works semantically like the English word "the" in
 that it indicates a single value is expected.

     $days               # the simple scalar value "days"
     $days[28]           # the 29th element of array @days
     $days{'Feb'}        # the 'Feb' value from hash %days
     $#days              # the last index of array @days 
```

所以你的例子是：

```
 %$arg_ref           # hash dereferenced from the value "arg_ref" 
```

`my($arg_ref) = @_;`获取函数参数堆栈中的第一项并将其放入名为`$arg_ref`. 调用者负责传递一个哈希引用。一种更规范的写法是：

```
my $arg_ref = shift; 
```

要创建哈希引用，您可以从哈希开始：

```
some_sub(\%hash); 
```

或者您可以使用匿名哈希引用创建它：

```
some_sub({pi => 3.14, C => 4}); # Pi is a gross approximation. 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-18T21:02:32.377

而不是像那样取消引用整个哈希，您可以使用

```
$arg_ref->{key} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-18T23:19:57.710

对 Perl 中引用（创建和使用它们）的一个很好的简要介绍是`perldoc perfeftut`. 您也可以[在线阅读](http://perldoc.perl.org/perlreftut.html)（或以 pdf 格式获取）。（它更多地谈论复杂数据结构中的引用，而不是传入和传出子例程，但语法是相同的。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-19T03:35:26.910

```
my %hash = ( fred => 'wilma',
             barney => 'betty');
my $hashref = \%hash;
my $freds_wife = $hashref->{fred};
my %hash_copy = %$hash # or %{$hash} as noted above. 
```

Soo，语法灵活性的意义何在？让我们试试这个：

```
my %flintstones = ( fred => { wife => 'wilma',
                              kids => ['pebbles'],
                              pets => ['dino'],
                            }
                    barney => { # etc ... }
                  ); 
```

实际上，对于像这样的深度数据结构，从 ref 开始通常更方便：

```
my $flintstones = { fred => { wife => 'Wilma',
                               kids => ['Pebbles'],
                               pets => ['Dino'],
                              },
                   }; 
```

好的，所以弗雷德得到了一只新宠物，“迅猛龙”

```
push @{$flintstones->{fred}->{pets}}, 'Velociraptor'; 
```

弗雷德有多少只宠物？

标量 @ {flintstones->{fred}->{pets} }

让我们喂它们...

```
for my $pet ( @ {flintstones->{fred}->{pets} } ) {
    feed($pet)
} 
```

等等。花括号汤起初看起来有点令人生畏，但最终处理它们变得很容易，只要你处理它们的方式保持一致即可。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-19T02:34:29.300

由于有点清楚这个结构被用来提供一个哈希引用作为一个命名参数的列表给一个子，还应该注意这个

```
sub foo {
  my ($arg_ref) = @_;
  # do something with $arg_ref->{keys}
} 
```

可能比仅仅打开包装@_ 有点过分

```
sub bar {
  my ($a, $b, $c) = @_;
  return $c / ( $a * $b );
} 
```

取决于参数列表的复杂程度。

# apache - 具有上次修改的缓存过期控制

> ID：562802
> 
> 赞同：15
> 
> 时间：2009-02-18T20:55:34.187
> 
> 标签：apache, caching, browser, mod-expires

在 Apache 的`mod_expires`模块中，有`Expires`两个基本时间段的指令**access**和**modify**。

```
ExpiresByType text/html "access plus 30 days" 
```

可以理解的是，缓存将在 30 天后请求新内容。

然而，

```
ExpiresByType text/html "modification plus 2 hours" 
```

没有直觉意义。

浏览器缓存如何知道文件已被修改，除非它向服务器发出请求？如果它正在调用服务器，那么缓存这个指令有什么用？在我看来，我不了解缓存的某些关键部分。请赐教。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-18T21:50:54.273

以“修改”为基础的`Expires*`指令是指服务器上文件的修改时间。因此，如果您设置“修改加 2 小时”，则任何在文件修改后 2 小时内（在服务器上）请求内容的浏览器都会缓存该内容，直到文件修改时间后 2 小时。并且浏览器知道那个时间是什么时候，因为服务器发送了一个`Expires`带有正确过期时间的标头。

让我用一个例子来解释一下：假设您的 Apache 配置包括该行

```
ExpiresDefault modification plus 2 hours 
```

并且您在服务器上有一个文件`index.html`，该`ExpiresDefault`指令适用于该文件。假设您`index.html`在格林威治标准时间 9:53 上传了一个版本，覆盖了以前的现有版本`index.html`（如果有的话）。所以现在的修改时间`index.html`是格林威治标准时间 9:53。如果您`ls -l`在服务器（或`dir`Windows）上运行，您会在列表中看到它：

```
-rw-r--r--  1 apache apache    4096  Feb 18 09:53 index.html 
```

现在，对于每个请求，Apache 都会发送`Last-Modified`带有文件最后修改时间的标头。由于您有该`ExpiresDefault`指令，它还将发送`Expires`标头，其时间等于文件的修改时间 (9:53) 加上两个小时。所以这是浏览器看到的部分内容：

```
Last-Modified: Wed, 18 Feb 2009 09:53:00 GMT
Expires: Wed, 18 Feb 2009 11:53:00 GMT 
```

如果浏览器发出此请求的时间在格林威治标准时间 11:53 之前，浏览器将缓存该页面，因为它尚未过期。因此，如果用户在格林威治标准时间 11:00 首次访问该页面，然后在格林威治标准时间 11:30 再次访问同一页面，浏览器将看到其缓存版本仍然有效并且不会（或者更确切地说，允许不) 发出新的 HTTP 请求。

如果用户在格林威治标准时间 12:00 第三次访问该页面，浏览器会发现其缓存版本现已过期（在 11:53 之后），因此它会尝试验证该页面，并向服务器发送带有 If 的请求-Modified-Since 标头。将返回没有正文的 304（未修改）响应，因为该页面的日期自首次提供以来未更改。由于过期日期已过——该页面已“过时”——随后每次访问该页面时都会发出验证请求，直到验证失败。

现在，让我们假设您在 11:57 上传了新版本的页面。在这种情况下，浏览器在 12:00 尝试验证页面的旧版本失败，并且它在响应中收到与新页面一起的以下两个新标头：

```
Last-Modified: Wed, 18 Feb 2009 11:57:00 GMT
Expires: Wed, 18 Feb 2009 13:57:00 GMT 
```

（文件的最后修改时间在新版本上传后变为11:57，Apache计算过期时间为11:57 + 2:00 = 13:57 GMT。）

现在直到 13:57 才需要验证（使用最近的日期）。

（当然请注意，许多其他内容与我上面列出的两个标头一起发送，为简单起见，我只是删除了所有其他内容）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-18T21:29:03.560

服务器发送一个标头，例如：“ `Last-Modified: Wed, 18 Feb 2009 00:00:00 GMT`”。缓存的行为基于此标头或访问时间。

假设内容预计每天都会刷新，那么您希望它“修改加 24 小时”过期。

如果你不知道什么时候刷新内容，那么最好根据访问时间来确定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T21:00:58.730

我的理解是，修改要求浏览器根据 Last-Modificatied HTTP 标头的值来确定缓存时间。因此，修改加上 2 小时将是最后修改时间 + 2 小时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-09T21:32:07.683

首先感谢 David Z 上面的详细解释。在回答 bushman 的问题时，如果仍然需要服务器发出请求，为什么调用缓存是有意义的，答案是时间保存在服务器返回的内容中。如果缓存指令指示文件的内容仍然是新鲜的，则不会返回内容，而是返回 304 代码和空响应正文。这就是节省时间的地方。

比我给出的更好的解释在这里，来自[https://devcenter.heroku.com/articles/increasing-application-performance-with-http-cache-headers](https://devcenter.heroku.com/articles/increasing-application-performance-with-http-cache-headers)：

> 尽管条件请求确实会通过网络调用调用，但未修改的资源会导致响应主体为空——节省了将资源传输回最终客户端的成本。后端服务通常还能够非常快速地确定资源的最后修改日期，而无需访问资源，这本身可以节省大量的处理时间。
> 
> 基于时间
> 
> 基于时间的条件请求确保仅当请求的资源在浏览器的副本被缓存后发生更改时，才会传输内容。如果缓存的副本是最新的，则服务器返回 304 响应代码。
> 
> 为了启用条件请求，应用程序通过 Last-Modified 响应标头指定资源的最后修改时间。
> 
> Cache-Control:public, max-age=31536000 Last-Modified: Mon, 03 Jan 2011 17:45:57 GMT
> 
> 下次浏览器请求此资源时，它只会使用 If-Modified-Since 请求标头询问资源的内容，如果它们自此日期以来未更改
> 
> If-Modified-Since: 2011 年 1 月 3 日星期一 17:45:57 GMT
> 
> 如果资源自格林威治标准时间 2011 年 1 月 3 日星期一 17:45:57 以来没有更改，则服务器将返回带有 304 响应代码的空正文。

# actionscript-3 - 如何相对于其父容器在 flex 中动态定位 swf？

> ID：562805
> 
> 赞同：0
> 
> 时间：2009-02-18T20:56:34.043
> 
> 标签：actionscript-3, apache-flex

如何相对于其包含框定位孩子？

编码：

```
<mx:Script>
    <![CDATA[

                    thisMap.scaleX = scaleFactor;
                    thisMap.scaleY = scaleFactor;
                    thisMap.x = thisMap.x - thisMap.mouseX * 1.3;
                    thisMap.y = thisMap.y - thisMap.mouseY * 1.3;

]]>
</mx:Script>

<mx:Box id="mapHolder" x="0" y="30">
    <mx:SWFLoader id="thisMap" source="MyWorld1.swf" />
</mx:Box> 
```

要访问此地图，无需通过 mapHolder。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T21:04:43.883

盒子是一个容器，它为您管理在水平或垂直堆栈中的定位（请参阅 VBox 或 HBox）。看起来您正试图将 thisMap 定位为就好像它在画布中一样。尝试

```
<mx:Script>
        <![CDATA[

                                thisMap.scaleX = scaleFactor;
                                thisMap.scaleY = scaleFactor;
                                thisMap.x = thisMap.x - thisMap.mouseX * 1.3;
                                thisMap.y = thisMap.y - thisMap.mouseY * 1.3;

]]>
</mx:Script>

<mx:Canvas id="mapHolder" x="0" y="30">
        <mx:SWFLoader id="thisMap" source="MyWorld1.swf" />
</mx:Canvas> 
```

此外，我不确定通过相对于鼠标坐标定位它会是什么样子......看起来你正在尝试实现某种拖动功能。然而画布应该解决原来的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T21:14:16.280

我正在创建缩放功能。当用户单击此地图时，它会放大被单击的点。我缩放此地图并通过偏移其 x、y 位置来调整缩放和居中。这在主应用程序中运行良好，但我不知道如何将 swf 放入某种容器中。

# javascript - jQuery切换增值税切换

> ID：562815
> 
> 赞同：1
> 
> 时间：2009-02-18T20:59:43.007
> 
> 标签：javascript, jquery, switch-statement, toggle, unobtrusive-javascript

[我想实现一个增值税切换器，如您在http://aria.co.uk](http://www.aria.co.uk)右上角所见，尽管我只想在客户端执行此操作。

下面是我想出的东西，虽然我需要：

*   来回切换增值税（我的例子只是一种方式）
*   保存并从 cookie 中读取切换状态以保持持久性
*   让它不显眼/仅当 JS 可用时才显示切换链接

    `<html>`

    `<head>`

    `<title>VAT Switch</title>`

    `<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>`

    `<script type="text/javascript">`

    `function VATswitch(){`

    `var price = $(".price strong span").text();`

    `price = price * 10 / 12;`

    `$(".price strong span").text(price);`

    `var excl_incl = $(".price em").text();`

    `excl_incl = "(excl. VAT)";`

    `$(".price em").text(excl_incl);`

    `}` `</script>`

    `</head>`

    `<body>`

    `<a href="#" onclick="VATswitch();" id="vat_switch">Switch VAT</a>`

    `<p class="price">`

    `<strong>£<span>120</span></strong>`

    `<em>(incl. VAT)</em>`

    `</p>`

    `</body>`

    `</html>`

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T21:03:36.400

最简单的方法是将两个价格都呈现到您的页面，然后使用 jquery/css 控制可见性，例如：

```
<div class="price">
    <span class="incVAT">£11.50 (incl VAT)</span>
    <span class="exVAT">£10.00 (ex VAT)</span>
</div> 
```

然后您的切换器可以执行以下操作：

```
$('.price .incVAT').show();
$('.price .exVAT').hide(); 
```

反之亦然

编辑：我不会在客户端进行计算。大概你正在开一家商店，并不是所有的产品都会有增值税，有些可能会有不同的税率。

编辑重新评论：

有一个[jquery cookie 库](http://plugins.jquery.com/project/Cookie)可以帮助你做 cookie，所以你需要做的就是在加载时读取值：

```
$(function(){

    ShowPrices();

    $('a#vattoggle').click(function(){
        if($.cookie('VATMODE') == "INC"){
            $.cookie('VATMODE', 'EX');
        } else {
             $.cookie('VATMODE', 'INC')
        }
        ShowPrices();
        return false
    });
});

function ShowPrices(){
    if($.cookie('VATMODE') == "INC"){
        $('.price .incVAT').show();
        $('.price .exVAT').hide();
    } else {
        $('.price .incVAT').hide();
        $('.price .exVAT').show();
    }
} 
```

# php - PHP 方法在没有数据库查询的情况下执行 SQL LIKE 匹配？

> ID：562823
> 
> 赞同：3
> 
> 时间：2009-02-18T21:01:51.490
> 
> 标签：php, sql, pattern-matching, full-text-search, sql-like

我想将输入字符串与我的 PHP 页面匹配，就像 SQL (MySQL) 中的 LIKE 命令完成的匹配一样，以保持其他搜索的一致性。因为（我见过但不理解）一些 PHP 语法包括 SQL 命令，我想知道这是否可能？

这样做的原因是我现在正在搜索关键字与数据库中存储在序列化数组中的字段，我必须在 PHP 中取消序列化并根据数组的结构进行搜索。我不能对表进行查询，只需要查询的匹配能力。否则我需要找到一个替代的匹配例程，这将是不一致的。我不能回去重新构建数据库，因为这在规范中没有预料到。是的，我需要一个丑陋的黑客，但我正在寻找最优雅的。

如果不可能，我可以使用任何匹配用户输入文本的建议作为关键字与存储的文本。

编辑（澄清）：我的主要问题是我没有彻底掌握 LIKE 命令的工作原理（只是复制代码），并且由于关键字暗示某种程度的模糊性，我希望如果我切换到这种模糊性保留一个正则表达式。我对正则表达式更好，只是对喜欢不太好。我的查询是“LIKE 'matchme%'”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T21:22:07.557

## 更新

根据 tomalak 的评论和 OIS 使用 preg_grep 的绝妙想法，这可能更像是您的最终解决方案。

```
<?php

function convertLikeToRegex( $command )
{
    return "/^" . str_replace( '%', '(.*?)', preg_quote( $command ) ) .  "$/s";
}

function selectLikeMatches( $haystack, $needle )
{
    return preg_grep( convertLikeToRegex( $needle ), $haystack );
}

$likeClauses = array(
    '%foo'
    ,'foo%'
    ,'%foo%'
);

$testInput = array(
    'foobar'
    ,'barfoo'
    ,'barfoobaz'
);

foreach ( $likeClauses as $clause )
{
    echo "Testing $clause:";
    echo '<pre>';
    print_r( selectLikeMatches( $testInput, $clause ) );
    echo '</pre>';
} 
```

## 下面是原帖

这符合你所追求的吗？

```
<?php

function convertLikeToRegex( $command )
{
    return "/^" . str_replace( '%', '(.*?)', $command ) .  "$/s";
}

$likeClauses = array(
    '%foo'
    ,'foo%'
    ,'%foo%'
);

$testInput = array(
    'foobar'
    ,'barfoo'
    ,'barfoobaz'
);

foreach ( $testInput as $test )
{
    foreach ( $likeClauses as $clause )
    {
        echo "Testing '$test' against like('$clause'): ";
        if ( preg_match( convertLikeToRegex( $clause ), $test ) )
        {
            echo 'Matched!';
        } else {
            echo 'Not Matched!';
        }
        echo '<br>';
    }
    echo '<hr>';
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-18T21:22:26.383

实际上，您需要的是[preg_grep 。](http://us.php.net/manual/en/function.preg-grep.php)

```
$arr = array("tstet", "duh", "str");
$res = preg_grep("#st#i", $arr); //i for case insensitive
var_dump($res); 
```

结果是

```
array(2) {
  [0]=>
  string(5) "tstet"
  [2]=>
  string(3) "str"
} 
```

编辑：

> 用户提供文本，我在幕后添加通配符。我确实使用了 1%。喜欢'文本%'

这是您在正则表达式中指定它的方式

```
"#st#i"  regex is the same as in sql "%st%"
"#^st#i" regex is the same as in sql "st%"
"#st$#i" regex is the same as in sql "%st" 
```

另外，请记住在您从第三方获得的任何文本上使用[preg_quote 。](http://us.php.net/manual/en/function.preg-quote.php)$正则表达式 = "#" 。preg_quote($text) 。“＃一世”; $res = preg_grep($regex, $arr);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T21:11:11.217

我认为您需要[preg_match](http://us3.php.net/preg_match)但这与 LIKE 的行为并不完全相同。

```
<?php // The "i" after the pattern delimiter indicates a case-insensitive search 
if (preg_match("/php/i", "PHP is the web scripting language of choice.")) {
    echo "A match was found."; 
} else {
    echo "A match was not found."; } 
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T21:17:02.513

您的意思是您希望能够检查输入字符串是否为 LIKE var% ？

您可以使用 strpos(haystack, needle) 来匹配 %var%。

```
if( strpos($source, "var") == 0 ) echo "matches var%";
if( strlen($source) - (strpos($source, "var")) == strlen("var") ) echo "matches %var"; 
```

那是相当丑陋的。实际上可能不是最优雅的。

# linux - 如何在 linux 上仅使用 Gecko-sdk 构建 mozilla firefox NSAPI 示例插件

> ID：562826
> 
> 赞同：1
> 
> 时间：2009-02-18T21:02:34.280
> 
> 标签：linux, firefox, plugins

我已经在 Windows 上构建了 gecko-sdk NSAPI 示例插件（使用 Visual Studio 项目文件），但我想在 linux 平台上开发一些插件。

mozilla 站点仅涵盖为 windows 设置 gecko-sdk：

[https://developer.mozilla.org/En/Creating_XPCOM_Components/Setting_up_the_Gecko_SDK](https://developer.mozilla.org/En/Creating_XPCOM_Components/Setting_up_the_Gecko_SDK)

但是，gecko-sdk 代码只包含一个 makefile.in 文件（没有 configure.in/ac/am，autoconf 需要生成一个配置脚本）。

我知道如果我使用完整的 mozilla 源（firefox 源）构建插件，我可以创建插件 Makefile，并将插件目录添加到 mozilla/toolkit/toolkit-makefiles.sh 中的 MAKEFILE_plugins

然后在顶层做一个 ./configure 。

但是我该如何为 gecko-sdk 做呢？

下面是插件代码：

[http://mxr.mozilla.org/seamonkey/source/modules/plugin/](http://mxr.mozilla.org/seamonkey/source/modules/plugin/)

如何在 linux 上构建示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T06:23:13.457

这不是一个真正的答案，更多的是一个相似但不同的问题，可能会帮助你。

不久前，我在 OS X 上构建了一个 C++ XPCOM 扩展，但我没有（必须）使用来自 gecko-sdk 的配置/Makefile。相反，我只是在[我自己的小 Makefile](http://github.com/vasi/firefox-dock-progress/blob/433e98762b020b17abf10b36aafaa59c1094537b/src/Makefile)中调用了 GCC 。

唯一需要注意的是使用兼容的编译器和构建标志。您可以查看您的发行版的 Firefox 构建日志，以确定哪些构建标志是合适的，例如：[对于 Ubuntu](http://launchpadlibrarian.net/22018527/buildlog_ubuntu-jaunty-i386.firefox-3.0_3.0.6%2Bnobinonly-0ubuntu1_FULLYBUILT.txt.gz)。

# video - 保护分布式视频的重复和限制观看时间的最佳方法是什么？

> ID：562833
> 
> 赞同：0
> 
> 时间：2009-02-18T21:03:50.110
> 
> 标签：video, encryption, copy-protection

我希望在记忆棒（更有可能）或 DVD（不太可能）上发布一个视频，该视频具有防止复制并在特定日期后过期。我们基本上有一个视频，我们想把它卖给客户，但在业内，公司交易和复制他们购买的东西是很常见的，甚至是他们的竞争对手——我们正在努力防止这种情况发生。

一些必需/可能的功能：

*   难以复制：视频文件可能已加密，需要特定的视频播放器才能播放
*   48 小时后过期：48 小时后无法再播放视频
*   密钥输入：必须输入密钥才能开始观看，并且可能包含视频可用的时间长度
*   需要在没有互联网连接的情况下工作

在某些方面，这类似于 Apple iTunes 电影租赁，尽管我们并不关心人们是否会全程观看。由于大小的原因，我们也不打算通过 Internet 下载它，尽管这是可能的。

我们可以将视频转换成几乎任何格式。

有哪些预先存在的解决方案？我是一名网络开发人员，所以我不认为我可以开发桌面应用程序。虽然，像 Adob​​e AIR 这样的东西会为此工作吗？

我也明白，可能没有一个万无一失的系统可以保证视频永远不会被复制。

我知道这是与编程相关的边缘，但这可能是程序员经常被问到的问题，无论是在线还是其他。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T21:15:44.920

DRM 在很大程度上是浪费时间。总是存在[模拟漏洞](http://en.wikipedia.org/wiki/Analog_hole)，并且可以解码视频以观看它而不能够对其进行解码以复制它，这简直是一个荒谬的原则。通过使用 DRM，您将永远参与一场徒劳的猫捉老鼠游戏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-25T01:11:46.140

装饰风格。

让每个人都穿上不酷的衣服，并拥有俗气（但不是复古）的装饰，配上糟糕的配乐，比如 80 年代的合成器音乐。

人们不会分发它并且会在一段时间后停止观看（可能不是所需的 48 小时......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T21:54:49.240

这里最好的方法不是通过编程，而是通过法律保护。

让你给这个视频的每个人都签署一份声明，说他们不会重新分发视频（有点（完全）像保密协议）。

如果您担心他们仍然会这样做，请在视频中添加某种可识别的水印。

请记住，您的视频是受版权保护的作品。保护（和追回损害赔偿）只是律师的事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T21:18:08.923

许多不同的组织之前已经尝试过整个“到期”的事情。在我看来，这在很大程度上被证明是一个失败的实验。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T21:21:00.180

您将不得不填补的主要漏洞是试图让该人不只是在他们的计算机上设置日期以继续观看电影。如果不需要互联网连接，您将无法验证时间。除非您想出某种具有内部计时器的自定义 USB 记忆棒，它会在一定时间后过期，否则您不会很幸运地从用户的计算机控制此类事情。

另外，我不会假设文件太大而无法通过互联网传输。首先，如果他们可以控制解密的流，他们可以将其重新编码为更小的文件格式。此外，人们已经在互联网上分发蓝光翻录。我不确定你的格式的细节，但我怀疑它比蓝光更大。

# asp.net - RegisterStartupScript 和多个控件

> ID：562834
> 
> 赞同：0
> 
> 时间：2009-02-18T21:03:55.790
> 
> 标签：asp.net

我有一个加载 childUserControl 的 parentUserControl。将 parentUserControl 的多个实例（例如 3 个）添加到主机页面。

在 parentUserControl 的 PageLoad 上，我注册了 JS：

```
ScriptManager.RegisterStartupScript(this, typeof(Page), keyJSLoadBegin, "OnParentLoad();", true); 
```

在 hte childUserControl 的 PageLoad 上，我注册了 JS：

```
ScriptManager.RegisterStartupScript(this, typeof(Page), keyJSLoadBegin, "OnChildLoad();", true); 
```

导航到页面时出现 JS 错误。导致此错误的行是（在查看源代码中）：

```
`OnParentLoad('parentA');OnChildLoad('childA');OnParentLoad('parentB');
OnParentLoad('parentC')`;OnChildLoad('childC');OnChildLoad('childB') 
```

很明显，电话是无序的。

有谁知道为什么？

**编辑：**

该问题似乎与此处的错误有关：http: [//support.microsoft.com/kb/817032](http://support.microsoft.com/kb/817032)

建议是一次注册所有相关脚本。在我的情况下这是不可能的，因为脚本位于不同的用户控件中。

有没有人遇到过这个问题的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T21:08:12.613

ASP.NET 中的控制模型旨在完全封装您的代码。每个控件都应独立于其他控件运行，并且不依赖于加载顺序（理想情况下甚至不依赖于存在）。你应该重新考虑你的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T21:23:14.090

我不明白为什么会发生这种情况，但这是我的看法：

我认为您应该通过一种方法公开子控件的脚本。在父控件中以您想要的顺序连接它们，然后在一个地方注册您的页面。

# php - 表格未显示

> ID：562838
> 
> 赞同：1
> 
> 时间：2009-02-18T21:04:48.407
> 
> 标签：php

我有一个包含以下代码的文件 test.php：

```
<html>
<head>
<title>Listing 10.2 </title>
</head>
<body>
<div>

<form method="post" action="test.php" >
    <p> <input type="text" name="guess"/> </p>
</form>

<?php
if(!empty($_POST['guess'] )) {
    print "Last guess $_POST['guess']";
}
?>

</div>

</body>
</html> 
```

我有一个表格没有显示的问题。但是，如果我删除代码的 PHP 部分，它是可见的。我的问题是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T21:10:38.520

您不能像这样将 $_POST 变量嵌入到字符串中，尝试将 php 部分更改为：

```
<?php
if(!empty($_POST['guess'] )) {
    print "Last guess {$_POST['guess']}";
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-16T03:07:09.620

采用 。用于组合值和字符串

```
if(!empty($_POST['guess'] ))
{
    echo "Last guess".$_POST['guess'];
} 
```

# javascript - 如何将按钮组的 html 名称传递给 javascript 函数

> ID：562839
> 
> 赞同：1
> 
> 时间：2009-02-18T21:05:15.910
> 
> 标签：javascript

假设我有一个类似的功能：

```
 function getGroupValue(group)
  {
     for (var i=0; i < group.length; i++) 
     {
        if (group[i].checked) 
        {
           return group[i].value;
        }
     }
  } 
```

我可以用类似的东西打电话`getGroupValue(document.forms[0].myGroup)`

如何将其转换为仅传递 html 单选按钮组的名称，例如 `getGroupValue('myGroupName')`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T21:22:30.923

这应该有效：

```
 function getGroupValue(group)
 {
 var g = document.getElementsByName(group);

 for (var i=0; i < g.length; i++) 
 {
    if (g[i].checked) 
    {
       return g[i].value;
    }
 }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T21:32:17.517

考虑到您最初调用该函数的方式，我假设您的页面上只有一个表单。如果这是一个有效的假设，那么您可以执行以下操作：

```
function getGroupValue(groupName)
{
  var group = document.forms[0][groupName];
  for (var i = 0, n = group.length; i < n; i ++)
  {
    if (group[i].checked)
    {
      return group[i].value;
    }
  }
} 
```

Javascript 允许您使用方括号指定表单的属性/子项，因此您可以只使用传入的 groupName 作为表单本身的子项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T21:10:59.780

给所有的单选按钮一个共同的“组”类名称，并使用 CSS 选择器（[jQuery](http://docs.jquery.com/Selectors)，[Prototype](http://www.prototypejs.org/api/element/select)），然后循环返回的结果并获取每个的名称会更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T21:17:17.410

你可以做一个 document.getElementsByName([GroupName]) 并以这种方式获取集合。如果有多个组，您可以将组名存储在一个变量中，并像现在一样让它通过。

# vhdl - Xilinx 中的“死代码”

> ID：562843
> 
> 赞同：2
> 
> 时间：2009-02-18T21:06:20.073
> 
> 标签：vhdl, synthesis, dead-code

我有一些我正在为课程编写的 VHDL 代码。但是，合成工具将 cell3、cell2 和 cell1 识别为“死”代码，并且不会对其进行合成。

我真的不知道发生了什么导致细胞 3、2、1 在合成中被移除；我已经对其进行了 5 次以上的审查，并询问了几个不同的人，但我找不到“为什么”。

不是在寻找解决方案，只是一个指向原因的指针。

```
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_ARITH.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity multiply is
    Port ( a : in  STD_LOGIC_VECTOR (3 downto 0);
           b : in  STD_LOGIC;
           clk : in  STD_LOGIC;
           rst : in  STD_LOGIC;

           p : out  STD_LOGIC);

end multiply;

architecture Behavioral of multiply is

    component cell_a port(
                s: in std_logic;
                c: in std_logic;
                a: in std_logic;
                b: in std_logic;
                clk: in std_logic;

                c_out: out std_logic;
                s_out: out std_logic);
    end component;

    signal c_s_0: std_logic;    --loopback wire for cell 0 from carry to sum
    signal c_s_1: std_logic;
    signal c_s_2: std_logic;
    signal c_s_3: std_logic;

    signal xfer1_0: std_logic;  --wire between 1 and 0
    signal xfer2_1: std_logic;  --"     2 and 1
    signal xfer3_2: std_logic;      --"     3 and 2

begin

    cell3: cell_a port map(
                                    clk => clk, 
                                    s => c_s_3 , c => '0',   a => a(3), b => b,
                                    c_out => c_s_3, s_out => xfer3_2
                                    );

    cell2: cell_a port map(
                                    clk => clk, 
                                    s => c_s_2 , c => xfer3_2, a => a(2), b => b, 
                                    c_out => c_s_2, s_out => xfer2_1
                                    );

    cell1: cell_a port map(
                                    clk => clk, 
                                    s => c_s_1, c => xfer2_1, a => a(1), b => b, 
                                    c_out => c_s_1, s_out => xfer1_0
                                    );

    cell0: cell_a port map(
                                    clk => clk, 
                                    s => c_s_0 , c => xfer1_0, a => a(0), b => b, 
                                    c_out => c_s_0, s_out => p
                                    );
    process(clk)
    begin
        if(clk'event and clk = '1') then
            if(rst = '1') then
            --reset logic here. Magic happens and the circuit goes to all 0
            end if;
        end if;
    end process;
end Behavioral; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-18T21:16:35.197

在没有看到其余代码的情况下，我只能建议您对 cell_a 的“c”输入未使用，这会导致 cell3/2/1 的所有输出都未使用（因此，死代码，因为它不会产生可观察的结果） .

cell0 实例化，因为乘数的“p”输出是可观察的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T21:16:28.020

可能是 cell1-3 正在通过合成得到优化，因为这个块“p”的输出只有 1 位。

您不需要完全评估所有逻辑来确定该位应该是 0 还是 1。

# mbunit - 什么是生成单元测试框架？

> ID：562845
> 
> 赞同：14
> 
> 时间：2009-02-18T21:07:24.220
> 
> 标签：mbunit

在stackoverflow上我遇到了mbunit。在其页面上，它指出 mbunit 是一个生成单元测试框架，但我找不到任何描述生成单元测试框架的地方。

我希望得到：

*   定义
*   有关生成单元测试框架是什么和不是什么的文章的链接。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-09T03:56:38.767

生成测试框架是代码本身**生成测试用例**的框架。

通常，您编写代码以根据您想要测试的一个或多个假设来生成测试用例。

我不熟悉 mbunit 本身，但例如使用 Clojure 生成测试框架[test.generation](https://github.com/clojure/test.generative/)你可以编写如下测试：

```
(defspec integers-closed-over-addition
  (fn [a b] (+' a b))                    ;; input fn
  [^long a ^long b]                      ;; input spec
  (assert (integer? %)))                 ;; 0 or more validator forms 
```

该测试直接指定了您要测试的假设（即两个长整数相加总是产生一个整数）。

重要的一点是您不必`long`为测试指定特定的值 - 框架本身将生成任意输入组合并检查您的断言在每种情况下是否成立。

# apache-flex - 在画布中拟合 Flex 图像

> ID：562850
> 
> 赞同：0
> 
> 时间：2009-02-18T21:09:59.020
> 
> 标签：apache-flex, actionscript-3

如何在 Flex 中缩放图像以适应 Canvas？我的代码如下：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml"
         horizontalAlign="center"
         width="100" height="100"
         verticalGap="0" borderStyle="solid"
         initialize="onLoad()"
         horizontalScrollPolicy="off"
         verticalScrollPolicy="off">
    <mx:Canvas width="100%" height="100%" id="PictureBox" horizontalScrollPolicy="off"
         verticalScrollPolicy="off" />
    <mx:Label id="NameLabel" height="20%" width="100%"/>
    <mx:Script>
        <![CDATA[
        private function onLoad():void
        {
            var image:SmoothImage = data.thumbnail;

            image.percentHeight = 100;
            image.percentWidth = 100;
            this.PictureBox.addChild(image);

            var sizeString:String = new String();

            if ((data.fr.size / 1024) >= 512)
                sizeString = "" + int((data.fr.size / 1024 / 1024) * 100)/100 + " MB";
            else
                sizeString = "" + int((data.fr.size / 1024) * 100)/100 + " KB";

            this.NameLabel.text = data.name + " \n" + sizeString;

        }
        ]]>
        </mx:Script>
</mx:VBox> 
```

我正在尝试将 image:SmoothImage 放入 PictureBox 并将其缩小。

**注意**SmoothImage 派生自 Image。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T21:39:44.393

你需要确保你已经设置

```
image.scaleContent = true;
image.maintainAspectRatio = false; 
```

这应该将内容缩放到 swf 加载器的大小并对其进行扭曲，使其填充 Image 组件的整个区域。

这是它的快速版本

```
 <mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml"
         horizontalAlign="center"
         width="100" height="100"
         verticalGap="0" borderStyle="solid"
         initialize="onLoad()"
         horizontalScrollPolicy="off"
         verticalScrollPolicy="off">
    <mx:Canvas width="100%" height="100%" id="PictureBox" horizontalScrollPolicy="off"
         verticalScrollPolicy="off" />
    <mx:Label id="NameLabel" height="20%" width="100%"/>
    <mx:Script>
        <![CDATA[
            import mx.controls.Image;

        private function onLoad():void
        {
            var image : Image = new Image()
            image.source = "http://i.stackoverflow.com/Content/Img/stackoverflow-logo-250.png";
            image.scaleContent = true;
            image.maintainAspectRatio =false;
            image.percentWidth = 100;
            image.percentHeight = 100;

            PictureBox.addChild(image);

        }
        ]]>
    </mx:Script>
</mx:VBox> 
```

# flash - 能够将外部图像加载到绘图板的位图上

> ID：562857
> 
> 赞同：0
> 
> 时间：2009-02-18T21:11:15.600
> 
> 标签：flash

这是我的新代码，但它不会呈现外部图像，请帮忙。

```
//load libs
import flash.net.*;
import flash.geom.Matrix;
import flash.display.*;
import flash.events.*;
import com.adobe.images.JPGEncoder;

function myLoader() {
    var loader:Loader = new Loader();
    loader.contentLoaderInfo.addEventListener(Event.COMPLETE, sketch);

    var request:URLRequest = new URLRequest("http://www.sergiorodriguez.org/images/2008_5_FXD_VividBlack.jpg");
    loader.load(request);
    //addChild(loader);

}

//action for mouse 
stage.addEventListener(MouseEvent.MOUSE_MOVE, moveCursor);
Mouse.hide();

function moveCursor(event:MouseEvent):void{
    pencil.x = event.stageX;
    pencil.y = event.stageY;
}

var canvas_mc;
    canvas_mc = new MovieClip()

addChildAt(canvas_mc,0);
canvas_mc.swapDepths

//draw area to sketch
function sketch(e:Event):void{
    //load bitmap and draw it to memory
    var myBitmapData;
        myBitmapData = new BitmapData(500, 500);
        myBitmapData.draw(e);

    //define matrix
    var matrix;
        matrix = new flash.geom.Matrix();

    //start canvas
    canvas_mc.graphics.beginBitmapFill(myBitmapData,matrix, true, true);
    canvas_mc.graphics.drawRect(0, 0, 500, 500);
    canvas_mc.graphics.endFill();

    //listening  events
    canvas_mc.addEventListener(MouseEvent.MOUSE_DOWN, startDrawing);
    canvas_mc.addEventListener(MouseEvent.MOUSE_UP, stopDrawing);
    canvas_mc.addEventListener(MouseEvent.MOUSE_MOVE, makeLine);    
}       

//mouse draws on press
function startDrawing(event:MouseEvent):void{   
    canvas_mc.graphics.lineStyle(1, 0, 1);
    canvas_mc.graphics.moveTo(mouseX, mouseY);
    canvas_mc.addEventListener(MouseEvent.MOUSE_MOVE, makeLine);
}

//mouse stops drawing on realese
function stopDrawing(event:MouseEvent):void{
    canvas_mc.removeEventListener(MouseEvent.MOUSE_MOVE, makeLine);
}

//creates lines
function makeLine(event:MouseEvent):void{
    canvas_mc.graphics.lineTo(mouseX, mouseY);  
}

//call function
myLoader()

//start to save onto server
var serverPath:String = "";
function createJPG(m:MovieClip, q:Number, fileName:String){
    var jpgSource:BitmapData = new BitmapData (m.width, m.height);
    jpgSource.draw(m);
    var jpgEncoder:JPGEncoder = new JPGEncoder(q);
    var jpgStream:ByteArray = jpgEncoder.encode(jpgSource);
    var header:URLRequestHeader = new URLRequestHeader ("Content-type", "application/octet-stream");
    var jpgURLRequest:URLRequest = new URLRequest ( serverPath+"jpg_encoder_download.php?name=" + fileName + ".jpg");       
    jpgURLRequest.requestHeaders.push(header);              
    jpgURLRequest.method = URLRequestMethod.POST;               
    jpgURLRequest.data = jpgStream;

    var jpgURLLoader:URLLoader = new URLLoader();   
    //jpgURLLoader.load(jpgURLRequest);     
    navigateToURL(jpgURLRequest, "_blank");
}

save_btn.addEventListener(MouseEvent.CLICK, saveBtnPress);
save_btn.addEventListener(MouseEvent.ROLL_OVER, saveBtnOver);
save_btn.addEventListener(MouseEvent.ROLL_OUT, saveBtnOut);

function saveBtnPress(e:Event):void{    
createJPG(canvas_mc, 90, "sketch");
}

function saveBtnOver(e:Event):void{ 
    Mouse.show();
    pencil.visible = false;
}

function saveBtnOut(e:Event):void{  
    Mouse.hide();
    pencil.visible = true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T09:04:34.043

您需要等待图像加载才能绘制它：

```
public function LoaderExample() {
    var loader:Loader = new Loader();
    loader.contentLoaderInfo.addEventListener(Event.COMPLETE, handleComplete);

    var request:URLRequest = new URLRequest("www.foo.com/image.jpg");
    loader.load(request);
}

public function handleComplete(e:Event):void {
    //do stuff with the image here
} 
```

# asp.net - IE 7 停止响应

> ID：562858
> 
> 赞同：0
> 
> 时间：2009-02-18T21:11:37.907
> 
> 标签：asp.net, javascript, ajax

在我们的 asp.net 2.0 Web 应用程序中，有一个带有验证的用户控件。出于某种原因，当验证失败时，页面看起来还不错，但是，没有控件（asp 按钮、滚动条或 Telerik 文本编辑器等第三方）响应鼠标输入。唯一的解决方法是调整浏览器窗口的大小，这将使 UI 响应。有没有人见过这个问题？可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T21:14:41.350

它发生在其他浏览器中吗？您是在谈论客户端验证还是服务器端（它实际上是否回发？）您是否尝试过删除所有 CSS 并查看它是否仍然发生？如果没有，请一点一点地添加 css，直到它再次中断并且您找到了罪魁祸首！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T21:28:20.037

检查您的 CSS 和/或 javascript。听起来好像有一个透明元素（如 div）被放置在页面中的元素之上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T02:25:59.230

如果 CSS 中有表达式，我已经看到 IE 在调整大小时冻结。

```
#container{
    width: expression(document.body.clientWidth > 1100)? "1100px" : "auto";
} 
```

很容易让自己陷入两个元素基于彼此调整大小的情况，这可能会导致浏览器锁定的无限循环。在任何情况下，表达式将在 IE8 标准模式下[停止工作](http://blogs.msdn.com/ie/archive/2008/10/16/ending-expressions.aspx)，因此无论如何都应该删除它们。

# visual-studio - MS C# Visual Express 的安装神秘地失败了

> ID：562859
> 
> 赞同：0
> 
> 时间：2009-02-18T21:11:45.037
> 
> 标签：visual-studio, installation, visual-studio-express

我讨厌诉诸于向其他人倾销问题，我确信这是一个很容易解决的愚蠢问题，但它真的让我很恼火，我想不通。

好吧，我尝试安装 Microsoft C# Visual Express，但在安装几分钟后，我收到“Windows 模块安装程序停止工作...”错误。它说该程序“停止工作并被关闭”，但它似乎一直存在。我重新启动了 Vista，尽管 Windows 模块安装程序消失了，但每隔几分钟左右就会弹出相同的错误。

尝试了所有花哨的方法来重新启动服务，但仍然没有运气。

安装涉及 Microsoft .NET Framework v3.5，Vista 已经尝试更新了一段时间（没有尝试成功）。也许这可能是问题的一部分？我在网上搜索了一下，发现一些相关问题是“.NET Framework被损坏”引起的。解决方案主要涉及重新安装框架，但这只是问题 - 我无法重新安装它。

简而言之：

1）几次失败的自动更新

```
a) Microsoft .NET Framework
b) Solutions require re-installation of the Framework 
```

2) 尝试下载/安装 .NET Framework 的新副本

```
a) Download goes seamlessly, installation fails (no explanation given) 
```

3) 尝试安装 Microsoft C# Visual Express

```
a) Software requires .NET Framework
b) .NET Framework automatically included in installation
c) Download fails, error message appears with no explanation.
d) Windows Module Installer stays open, with no way to exit. 
```

4）计算机重新启动/重新启动

```
a) Windows Module Installer is gone 
b) Error messages still appear (And reappear when closed out), although the software isn't there anymore. 
```

这对我来说真的很困惑。嘿，我只是想让我的电脑恢复到我现在甚至尝试安装 C# Visual Express 之前的状态......

任何帮助深表感谢。提前致谢。

（另外，很抱歉格式混乱......这是我第一次使用这个网站。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T21:18:31.200

您是否检查过 Windows 更新日志文件中的任何相关错误消息？在 Windows 文件夹中查找“WindowsUpdate.log”或“Windows Update.log”。

此外，VS Express 安装程序可能会留下一个日志文件，可能在您的 %TMP% 文件夹中。（或者它们可能是创建日志文件的命令行选项，尝试使用 / 调用安装程序？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T21:24:23.230

您可能希望对系统内存进行诊断，有时可以将奇怪的应用程序行为追溯到不良的暗淡。

Ubuntu live cd 中包含这样一个诊断工具。您可以在 cd 启动后通过菜单访问它，运行大约需要 30-60 分钟。不过，可能有一些更快的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T22:40:53.373

更新：

尝试安装 SP1，但在安装的最后也失败了（与 Visual Express 完全相同）。相同的错误信息。一切都一样。

似乎与 .NET Framework 相关的任何内容都拒绝在我的计算机上运行......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T02:44:40.213

好吧，我尝试使用系统还原，但由于“未指定的错误”而无法成功完成。

现在这只是成为一种皇家痛苦。老实说，我只是想让我的电脑恢复到我尝试下载 Visual Express 之前的状态。

除了系统还原之外，还有什么方法可以做到这一点？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T04:22:01.207

解决方案：

1) 运行 Windows 配置实用程序

2) 转到“启动”选项卡

3) 确保“Windows 模块安装程序”未选中

4) 重启

# c# - 如何获取刚刚添加到 DataTable 的行的标识？

> ID：562869
> 
> 赞同：1
> 
> 时间：2009-02-18T21:15:43.857
> 
> 标签：c#, sql-server, .net-3.5

说我有这个代码：

```
rentalEaseDataSet.tblCheckbookEntry.Rows.Add(newRow); 
```

我想从我刚刚添加的那一行中获取一列的标识。我怎样才能做到这一点？假设该行称为 ID。

作为参考，我使用的是 C# 和 sql server express。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T21:18:56.597

好吧，该行实际上还没有保存到数据库中，所以它没有*数据库*ID（所以 sql server express 不是问题）。您需要使用适配器来保存更改，然后 id`newRow`应该反映数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T21:19:37.407

假设您正在处理数据源上的自动递增标识值，则不能这样做。您必须通过数据适配器将更改提交到数据源，然后表示自动递增 id 的列将使用该值更新。

# iphone - 释放变量时出现段错误（EXC_BAD_ACCESS）

> ID：562872
> 
> 赞同：3
> 
> 时间：2009-02-18T21:16:28.583
> 
> 标签：iphone, objective-c, cocoa-touch, memory-management

好的，我了解此错误主要来自发送方法调用或尝试访问已被释放的变量。

这是问题所在：

```
.h
@interface TimeEntry : NSObject <NSCopying, NSCoding> {

NSDate *from;
NSDate *to;

NSString *information;

}

@property (nonatomic, retain) NSDate *from;
@property (nonatomic, retain) NSDate *to;

@property (nonatomic, copy) NSString *information;

@end 
```

还有我班级的dealloc。

```
-(void)dealloc{

    [super dealloc];    
    [to release];
    [from release];
    [information release];

} 
```

这是我收到 EXC_BAD_ACCESS 错误时的回溯 ![替代文字](https://farm4.static.flickr.com/3596/3290604341_c78fae9981.jpg?v=0)

所以我正在向已被释放的对象发送消息，对吗？

所以我打开了 NSZombie，这停止了我的崩溃。它并没有像我希望的那样给我一些可爱的崩溃报告。相反，它只是防止程序崩溃。

在上面的 dealloc 方法中，如果我注释掉 [to release] 和 [from release] 应用程序不会崩溃。如果我只注释掉其中一个.. 它不会崩溃。在调试窗口中往返有不同的内存地址。

内存管理怎么这么难！！！！

任何线索任何人？

谢谢，

担

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-18T21:20:50.820

在释放变量之后发送 [super dealloc] 消息，而不是之前。[super dealloc] 应该是你在 dealloc 方法中做的最后一件事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T20:34:41.697

请注意，您可以发送 [nil release] 并且应用程序不会崩溃。所以在发布之前检查 nil 是不必要的。

但我同意你应该在 dealloc 过程结束时执行 [super dealloc]。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T09:54:23.467

您应该检查所有涉及您的属性的语句，以了解您的变量实际被释放的位置。无论如何，这是一个避免崩溃的快速解决方案，因为当且仅当它们仍然是分配的对象时，您的变量才会被释放：

-(无效)dealloc{

```
if(to != nil{ 
   NSLog(@"releasing: %@", to);
   [to release];
}

if(from != nil{
   NSLog(@"releasing: %@", from);
   [from release];
}

if(information != nil){
   NSLog(@"releasing: %@", information);
   [information release];
}

[super dealloc]; 
```

}

此外，您可能需要下载、安装和使用 CLANG 检查器工具来了解您的代码错误的原因。这个工具（已经为 Leopard 10.5.x 构建）有时可能无法提供正确的答案，但根据我的个人经验，它从未失败过。我强烈推荐它作为你的日常开发工具之一。

你可以从

[http://clang.llvm.org/StaticAnalysis.html](http://clang.llvm.org/StaticAnalysis.html)

使用它真的很简单。看一眼

[http://clang.llvm.org/StaticAnalysisUsage.html#BasicUsage](http://clang.llvm.org/StaticAnalysisUsage.html#BasicUsage)

在实践中，您只需使用以下命令构建您的 Xcode 项目

扫描构建 -k -V xcodebuild

然后，您使用将在终端窗口中显示为输出的命令检查生成的输出 HTML 文件。这些文件将为您详细解释代码中出现问题的原因。

亲切的问候

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-11T22:34:34.170

特里是正确的，`[super dealloc]`呼叫必须始终是最后一件事`-dealloc`。

更具体地说，调用`-[NSObject dealloc]`就是为对象释放内存。（在您的情况下，您直接扩展 NSObject，但更深层次的继承树会创建一系列 dealloc 调用。）一般意义上，`-dealloc`首先调用父级的方法将释放从父级继承的资源。如果孩子在释放自己的资源时依赖于这些资源中的任何一个，那么您将陷入困境。由于父级不能依赖子级，因此首先释放子级资源是正确、安全的做事方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-11T22:47:23.810

当前对象的属性存储在对象中。

当您调用 [super dealloc] 时，您是在告诉系统销毁该对象。在那次通话之后，您不能再依赖那里的属性或更正。

如前所述，在释放其他成员后调用它。

# java - Java：检测 ArrayList 中的重复项？

> ID：562894
> 
> 赞同：114
> 
> 时间：2009-02-18T21:22:31.110
> 
> 标签：java, arrays, arraylist, duplicates

我如何去检测（返回真/假）一个 ArrayList 是否包含多个 Java 中的相同元素？

非常感谢，特里

**编辑** 忘了提到我不是要比较“块”，而是要比较它们的整数值。每个“块”都有一个 int，这就是它们不同的原因。我通过调用名为“getNum”的方法（例如 table1[0][2].getNum();

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2009-02-18T21:25:32.757

最简单的：将整个集合转储到一个 Set 中（使用 Set(Collection) 构造函数或 Set.addAll），然后查看 Set 是否与 ArrayList 具有相同的大小。

```
List<Integer> list = ...;
Set<Integer> set = new HashSet<Integer>(list);

if(set.size() < list.size()){
    /* There are duplicates */
} 
```

更新：如果我正确理解你的问题，你有一个二维数组块，如

块表[][];

并且您想检测其中任何一行是否有重复项？

在这种情况下，假设 Block 正确实现了“equals”和“hashCode”，我可以执行以下操作：

```
for (Block[] row : table) {
   Set set = new HashSet<Block>(); 
   for (Block cell : row) {
      set.add(cell);
   }
   if (set.size() < 6) { //has duplicate
   }
} 
```

对于语法，我不是 100% 确定这一点，因此将其写成可能更安全

```
for (int i = 0; i < 6; i++) {
   Set set = new HashSet<Block>(); 
   for (int j = 0; j < 6; j++)
    set.add(table[i][j]);
 ... 
```

`Set.add``false`如果要添加的项目已经在集合中，则返回布尔值 false，因此如果您只想知道是否有任何重复项，您甚至可以短路并放弃返回的任何添加项。

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2009-03-01T19:13:17.150

改进的代码，使用返回值`Set#add`而不是比较列表和集合的大小。

```
public static <T> boolean hasDuplicate(Iterable<T> all) {
    Set<T> set = new HashSet<T>();
    // Set#add returns false if the set does not change, which
    // indicates that a duplicate element has been added.
    for (T each: all) if (!set.add(each)) return true;
    return false;
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-02-18T21:30:14.260

如果您希望完全避免重复，那么您应该取消检测重复的中间过程并使用[Set](http://java.sun.com/javase/6/docs/api/java/util/Set.html)。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2019-02-20T19:05:45.920

使用 Java 8+，您可以使用 Stream API：

```
boolean areAllDistinct(List<Block> blocksList) {
    return blocksList.stream().map(Block::getNum).distinct().count() == blockList.size();
} 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-09-10T11:45:26.687

改进了返回重复元素的代码

*   可以在集合中找到重复项
*   返回重复的集合
*   唯一元素可以从集合中获得

* * *

```
public static <T> List getDuplicate(Collection<T> list) {

    final List<T> duplicatedObjects = new ArrayList<T>();
    Set<T> set = new HashSet<T>() {
    @Override
    public boolean add(T e) {
        if (contains(e)) {
            duplicatedObjects.add(e);
        }
        return super.add(e);
    }
    };
   for (T t : list) {
        set.add(t);
    }
    return duplicatedObjects;
}

public static <T> boolean hasDuplicate(Collection<T> list) {
    if (getDuplicate(list).isEmpty())
        return false;
    return true;
} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-01-25T20:24:00.103

我需要为 a 做类似的操作`Stream`，但找不到一个好的例子。这就是我想出的。

```
public static <T> boolean areUnique(final Stream<T> stream) {
    final Set<T> seen = new HashSet<>();
    return stream.allMatch(seen::add);
} 
```

这具有在早期发现重复而不是必须处理整个流时短路的优点，并且并不比将所有内容放入 a`Set`并检查大小要复杂得多。所以这种情况大致是：

```
List<T> list = ...
boolean allDistinct = areUnique(list.stream()); 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-02-18T21:57:16.503

如果您的元素在某种程度上是 Comparable （顺序具有任何实际含义的事实是无关紧要的 - 它只需要与您对相等性的定义一致），最快的重复删除解决方案将对列表进行排序（ 0(n log( n)) ) 然后进行一次遍历并查找*重复*的元素（即，彼此跟随的相等元素）（这是 O(n)）。

总体复杂度将是 O(n log(n))，这与使用 Set 得到的大致相同（n 倍 long(n)），但常数要小得多。这是因为排序/去重中的常数来自比较元素的成本，而集合的成本最有可能来自哈希计算，加上一次（可能是多次）哈希比较。如果您使用的是基于哈希的 Set 实现，也就是说，因为基于 Tree 的结果会为您提供 O(n log²(n))，这就更糟了。

但是，据我了解，您不需要*删除*重复项，而只需测试它们的存在。所以你应该在你的数组上手动编码一个合并或堆排序算法，如果你的比较器返回 0，它只是退出返回 true（即“有一个 dup”），否则完成排序，并遍历排序的数组测试重复. 实际上，在合并或堆排序中，当排序完成时，您将比较每个重复的对，除非两个元素都已经在它们的最终位置（这不太可能）。因此，调整后的排序算法应该会产生巨大的性能改进（我必须证明这一点，但我猜调整后的算法应该在 O(log(n)) 中对均匀随机数据）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-10-23T03:25:27.593

如果您想要一组重复值：

```
import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

public class FindDuplicateInArrayList {

    public static void main(String[] args) {

        Set<String> uniqueSet = new HashSet<String>();
        List<String> dupesList = new ArrayList<String>();
        for (String a : args) {
            if (uniqueSet.contains(a))
                dupesList.add(a);
            else
                uniqueSet.add(a);
        }
        System.out.println(uniqueSet.size() + " distinct words: " + uniqueSet);
        System.out.println(dupesList.size() + " dupesList words: " + dupesList);
    }
} 
```

并且可能还考虑修剪值或使用小写字母......取决于您的情况。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-19T01:12:55.393

简单地说：1）确保所有项目都是可比较的 2）对数组进行排序 2）遍历数组并找到重复项

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-02-03T18:57:43.967

要知道列表中的重复项，请使用以下代码：它将为您提供包含重复项的集合。

```
 public Set<?> findDuplicatesInList(List<?> beanList) {
    System.out.println("findDuplicatesInList::"+beanList);
    Set<Object> duplicateRowSet=null;
    duplicateRowSet=new LinkedHashSet<Object>();
            for(int i=0;i<beanList.size();i++){
                Object superString=beanList.get(i);
                System.out.println("findDuplicatesInList::superString::"+superString);
                for(int j=0;j<beanList.size();j++){
                    if(i!=j){
                         Object subString=beanList.get(j);
                         System.out.println("findDuplicatesInList::subString::"+subString);
                         if(superString.equals(subString)){
                             duplicateRowSet.add(beanList.get(j));
                         }
                    }
                }
            }
            System.out.println("findDuplicatesInList::duplicationSet::"+duplicateRowSet);
        return duplicateRowSet;
  } 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-08-25T05:03:43.270

处理此问题的最佳方法是使用**HashSet**：

```
ArrayList<String> listGroupCode = new ArrayList<>();
listGroupCode.add("A");
listGroupCode.add("A");
listGroupCode.add("B");
listGroupCode.add("C");
HashSet<String> set = new HashSet<>(listGroupCode);
ArrayList<String> result = new ArrayList<>(set); 
```

只需打印 **结果**arraylist 并查看没有重复的结果 :)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-06-10T20:07:10.300

这个答案是用 Kotlin 写的，但可以很容易地翻译成 Java。

如果您的数组列表的大小在一个固定的小范围内，那么这是一个很好的解决方案。

```
var duplicateDetected = false
    if(arrList.size > 1){
        for(i in 0 until arrList.size){
            for(j in 0 until arrList.size){
                if(i != j && arrList.get(i) == arrList.get(j)){
                    duplicateDetected = true
                }
            }
        }
    } 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-12-16T11:07:34.010

```
private boolean isDuplicate() {
    for (int i = 0; i < arrayList.size(); i++) {
        for (int j = i + 1; j < arrayList.size(); j++) {
            if (arrayList.get(i).getName().trim().equalsIgnoreCase(arrayList.get(j).getName().trim())) {
                return true;
            }
        }
    }

    return false;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-10-30T05:35:10.737

```
 String tempVal = null;
    for (int i = 0; i < l.size(); i++) {
        tempVal = l.get(i); //take the ith object out of list
        while (l.contains(tempVal)) {
            l.remove(tempVal); //remove all matching entries
        }
        l.add(tempVal); //at last add one entry
    } 
```

注意：这将对性能造成重大影响，因为项目已从列表的开头删除。为了解决这个问题，我们有两个选择。1）以相反的顺序迭代并删除元素。2) 使用 LinkedList 而不是 ArrayList。由于在采访中提出的有偏见的问题是在不使用任何其他集合的情况下从 List 中删除重复项，因此上面的示例就是答案。但在现实世界中，如果我必须实现这一点，我会将元素从 List 放入 Set，很简单！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-11-10T08:09:44.810

```
/**
     * Method to detect presence of duplicates in a generic list. 
     * Depends on the equals method of the concrete type. make sure to override it as required.
     */
    public static <T> boolean hasDuplicates(List<T> list){
        int count = list.size();
        T t1,t2;

        for(int i=0;i<count;i++){
            t1 = list.get(i);
            for(int j=i+1;j<count;j++){
                t2 = list.get(j);
                if(t2.equals(t1)){
                    return true;
                }
            }
        }
        return false;
    } 
```

已覆盖的具体类的示例`equals()`：

```
public class Reminder{
    private long id;
    private int hour;
    private int minute;

    public Reminder(long id, int hour, int minute){
        this.id = id;
        this.hour = hour;
        this.minute = minute;
    }

    @Override
    public boolean equals(Object other){
        if(other == null) return false;
        if(this.getClass() != other.getClass()) return false;
        Reminder otherReminder = (Reminder) other;
        if(this.hour != otherReminder.hour) return false;
        if(this.minute != otherReminder.minute) return false;

        return true;
    }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-07-04T04:22:33.400

```
 ArrayList<String> withDuplicates = new ArrayList<>();
    withDuplicates.add("1");
    withDuplicates.add("2");
    withDuplicates.add("1");
    withDuplicates.add("3");
    HashSet<String> set = new HashSet<>(withDuplicates);
    ArrayList<String> withoutDupicates = new ArrayList<>(set);

    ArrayList<String> duplicates = new ArrayList<String>();

    Iterator<String> dupIter = withDuplicates.iterator();
    while(dupIter.hasNext())
    {
    String dupWord = dupIter.next();
    if(withDuplicates.contains(dupWord))
    {
        duplicates.add(dupWord);
    }else{
        withoutDupicates.add(dupWord);
    }
    }
  System.out.println(duplicates);
  System.out.println(withoutDupicates); 
```

# vb6 - VB6：这个简单的十六进制加法肯定是错误的吗？

> ID：562899
> 
> 赞同：4
> 
> 时间：2009-02-18T21:23:31.640
> 
> 标签：vb6, hex

我在一些 VB6 代码中得到了奇怪的结果，我已经缩小到这个范围：

```
Debug.Print Hex(&hEDB80000 + &h8300) 
```

显示**EDB78300**

那不可能吧？当然应该是**EDB88300**？

我要疯了吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-18T21:25:32.803

不要忘记[负数是如何用二进制表示的](http://en.wikipedia.org/wiki/Two's_complement)，并且 VB6 和 VB.NET 对 &h8300 之类的数字的解释不同。

因为 &hEDB80000 不适合 16 位，VB 将其解释为**long**（32 位）。因为设置了高位，VB6 知道它是负数。

让我们撤消[二进制补码](http://en.wikipedia.org/wiki/Two's_complement)（在 32 位世界中）以找出十进制值

```
(~&hEDB80000 + 1) = &h1247FFFF + 1 = &h12480000 = 306708480 
```

由于设置了符号位，那就是**-306708480**

因为 &h8300 适合 16 位，VB 将其解释为**整数**（16 位）。因为设置了高位，VB6 知道它是负数。

让我们撤消二进制补码（在*16 位*世界中）

```
(~&h8300 + 1) = &h7DFF + 1 = &h7D00 = 32000 
```

由于设置了符号位，因此为**-32000**。当加法发生时，两个值都被认为是长整数（32 位）。

```
(-306708480) + (-32000) = -306740480 
```

让我们把它放回二进制补码十六进制

```
~(306740480 - 1) = ~(&h12487D00 - 1) = ~(&h12487CFF) = &hEDB78300 
```

所以**&hEDB78300**是正确的答案。

* * *

笔记：

我个人认为混乱的发生是由于以下原因：

```
&h0004000 is interpreted as  16384 // Fits in 16-bits, sign bit is not set
&h0008000 is interpreted as -32768 // Fits in 16-bits, sign bit is set
&h0010000 is interpreted as  65536 // Requires 32-bits, sign bit is not set 
```

如另一篇文章中所述，您可以通过将值显式标记为 long 来解决此问题

```
&h0004000& is interpreted as  16384 
&h0008000& is interpreted as  32768 
&h0010000& is interpreted as  65536 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T22:10:35.443

从根本上说，因为 VB6 将 &h8300 视为具有值 -32000 的整数。要获得您期望的结果，您需要明确地将其标记为 Long：-

```
Debug.Print Hex(&hEDB80000 + &h8300&) 
```

您正在做的是将 Long 添加到 Interger 中。为此，VB6 首先将 Integer 扩展为 Long，因为 &h8300 表示负数，Long 转换为最终值 &hFFFF8300。有了这个值，您可以看到 VB6 返回的结果是正确的。

```
FF + B8 = B7 with carry bit set
FF + ED + carry bit = ED 
```

# algorithm - Paper Boy 的聚类算法

> ID：562904
> 
> 赞同：34
> 
> 时间：2009-02-18T21:25:06.177
> 
> 标签：algorithm, language-agnostic, cluster-analysis

我需要根据特定标准选择或创建聚类算法的帮助。

想象一下，您正在管理送报人员。

*   您有一组街道地址，每个地址都经过地理编码。
*   您希望对地址进行集群，以便将每个集群分配给一名送货员。
*   送货人员或集群的数量不是固定的。如果需要，我总是可以雇佣更多的送货员，或者解雇他们。
*   每个集群应该有大约相同数量的地址。但是，如果集群的地址更加分散，则集群的地址可能会更少。（换种说法：最小数量的集群，其中每个集群包含最大数量的地址，并且集群内的任何地址必须相隔最大距离。）
*   对于奖励积分，当数据集被更改（添加或删除地址）并且算法重新运行时，如果集群尽可能保持不变（即，这排除了简单的 k-means 聚类，即随机性）。不然快递员会发疯的。

所以……想法？

**更新**

如 Arachnid 的回答中所述，街道网络图不可用。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-01T02:24:29.480

我用 Java 编写了一个低效但简单的算法，看看我可以多接近在一组点上进行一些基本的聚类，或多或少如问题中所述。

`ps`如果 (x,y) 坐标指定为`int`s ，则该算法适用于列表。它还需要三个其他参数：

1.  radius ( `r`): 给定一个点，扫描附近点的半径是多少
2.  最大地址（`maxA`）：每个集群的最大地址（点）数是多少？
3.  最小地址 ( `minA`)：每个集群的最小地址

设置`limitA=maxA`。 **主迭代：** 初始化空列表`possibleSolutions`。 **外部迭代**：对于`p`. `ps`初始化空列表`pclusters`。定义了一个点的工作清单`wps=copy(ps)`。工作点`wp=p`。 **内部迭代：** while`wps`不为空。删除 中的点`wp`。`wps`确定距离 < from`wpsInRadius`的所有点。根据与 的距离升序排列。将第一点保留在. 这些点形成一个新的集群（点列表）。添加到. 从中删除点。如果`wps``r``wp``wpsInRadius``wp``min(limitA, sizeOf(wpsInRadius))``wpsInRadius``pcluster``pcluster``pclusters``pcluster``wps``wps`不为空，`wp=wps[0]`继续内迭代。 **结束内部迭代。** 获得集群列表`pclusters`。将此添加到`possibleSolutions`. **结束外部迭代。**

我们有一个集群列表中的`p`每一个。然后每一个都被加权。如果是（全局）中每个簇的平均点数，并且是每个（全局）中的平均簇数，那么这是使用这两个变量来确定权重的函数：`ps``pclusters``possibleSolutions``pclusters``avgPC``possibleSolutions``avgCSize``pclusters`

```
 private static WeightedPClusters weigh(List<Cluster> pclusters, double avgPC, double avgCSize)
  {
    double weight = 0;
    for (Cluster cluster : pclusters)
    {
      int ps = cluster.getPoints().size();
      double psAvgPC = ps - avgPC;
      weight += psAvgPC * psAvgPC / avgCSize;
      weight += cluster.getSurface() / ps;
    }
    return new WeightedPClusters(pclusters, weight);
  } 
```

现在最好的解决方案是`pclusters`重量最小的。只要我们能找到比之前最好的解决方案更好的解决方案（权重更小），我们就会重复主迭代`limitA=max(minA,(int)avgPC)`。**结束主迭代。**

请注意，对于相同的输入数据，此算法将始终产生相同的结果。列表用于保持顺序，不涉及*随机。*

要查看该算法的行为方式，这是 32 点测试模式上的结果图像。如果`maxA=minA=16`，那么我们找到 2 个 16 个地址的集群。

[![替代文字](https://i.stack.imgur.com/L2ymx.jpg)](https://i.stack.imgur.com/L2ymx.jpg)
[（来源：[sites.google.com 上的 paperboyalgorithm](https://sites.google.com/site/paperboyalgorithm/_/rsrc/1235871082842/Home/paperboy7.JPG)）]

接下来，如果我们通过设置 减少每个集群的最小地址数`minA=12`，我们会找到 12/12/8 个点的 3 个集群。

[![替代文字](https://i.stack.imgur.com/i0sgf.jpg)](https://i.stack.imgur.com/i0sgf.jpg)
[（来源：[sites.google.com 上的 paperboyalgorithm](https://sites.google.com/site/paperboyalgorithm/_/rsrc/1235871076935/Home/paperboy6.JPG)）]

为了证明该算法远非完美，这里是输出`maxA=7`，但我们得到了 6 个集群，其中一些集群很小。所以在确定参数的时候还是要猜测太多。请注意，`r`这里只有 5 个。

[![替代文字](https://i.stack.imgur.com/lsezq.jpg)](https://i.stack.imgur.com/lsezq.jpg)
[（来源：[sites.google.com 上的 paperboyalgorithm](https://sites.google.com/site/paperboyalgorithm/_/rsrc/1235871054789/Home/paperboy4.JPG)）]

只是出于好奇，我在一组更大的随机选择的点上尝试了该算法。我添加了下面的图片。

结论？这花了我半天的时间，效率低下，代码看起来很难看，而且速度比较慢。但它表明在短时间内产生*一些结果是可能的。*当然，这只是为了好玩；把它变成真正有用的东西是困难的部分。

[![替代文字](https://i.stack.imgur.com/ies85.jpg)](https://i.stack.imgur.com/ies85.jpg)
[（来源：[sites.google.com 上的 paperboyalgorithm](https://sites.google.com/site/paperboyalgorithm/_/rsrc/1235871032699/Home/paperboy1.JPG)）]

[![替代文字](https://i.stack.imgur.com/bZney.jpg)](https://i.stack.imgur.com/bZney.jpg)
[（来源：[sites.google.com 上的 paperboyalgorithm](https://sites.google.com/site/paperboyalgorithm/_/rsrc/1235871047913/Home/paperboy3.JPG)）]

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-19T21:14:04.143

您所描述的是（多）车辆路由问题（VRP）。有很多关于这个问题的不同变体的学术文献，使用了各种各样的技术（启发式、现成的求解器等）。通常，作者试图为具体实例找到好的或最佳解决方案，这也意味着站点的聚类（一辆车路线上的所有站点）。

但是，集群可能会发生重大变化，实例略有不同，这是您要避免的。不过，VRP 论文中的某些内容可能会激发您的灵感……

如果您决定坚持显式聚类步骤，请不要忘记将您的分布包含在所有聚类中，因为它是每条路线的一部分。

使用街道网格的图形表示来评估集群可能会比连接白色地图上的点产生更真实的结果（尽管两者都是 TSP 变体）。如果图形模型不可用，您可以使用出租车度量 (|x_1 - x_2| + |y_1 - y_2|) 作为距离的近似值。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-18T22:12:21.040

我认为你想要一种[分层聚集](http://en.wikipedia.org/wiki/Hierarchical_clustering#Hierarchical_clustering)技术而不是 k-means。如果您的算法正确，则可以在拥有正确数量的集群时停止它。正如其他人提到的，您可以使用以前的解决方案播种后续集群，这可能会给您带来显着的性能提升。

您可能需要仔细查看您使用的距离函数，尤其是当您的问题具有高维度时。欧几里得距离是最容易理解的，但可能不是最好的，请查看诸如 Mahalanobis 之类的替代方法。

我假设您的真正问题与送报纸无关...

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-23T12:35:01.260

您是否考虑过使用基于经济/市场的解决方案？将设置除以任意（但为避免随机效应而保持不变）分成偶数子集（由送货人员的数量决定）。

为每个点分配一个成本函数，根据它在图中增加多少，并给每个额外的点一个经济价值。

迭代允许每个人轮流拍卖他们最差的点，并给每个人一个最大的预算。

这可能非常符合人们在现实生活中的想法，因为人们会发现交换，或者会说“如果我不做这一两个，我的生活会容易得多。它也非常灵活（对于例如，将允许距离任何其他点数英里的点相当容易地获得溢价）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-19T07:16:10.997

我会以不同的方式处理它：将街道网络视为一个图形，每条街道的每一侧都有一条边，将图形划分为 n 个段，每个段不超过给定长度，这样每个报童可以骑一个从起点到终点的连续路径。这样，您就可以避免为人们提供需要他们重复骑行相同路段的路线（例如，当被要求覆盖街道两侧而不覆盖所有周围街道时）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-23T14:34:20.460

这是发现“集群”所在位置的一种非常快速而肮脏的方法。这是受到游戏“扫雷”的启发。

将您的整个交付空间划分为正方形网格。注意 - 需要对网格大小进行一些调整才能正常工作。我的直觉告诉我，一个与物理邻域块大小大致相同的正方形将是一个很好的起点。

循环遍历每个方块并存储每个街区内的送货地点（房屋）的数量。使用第二个循环（或第一次传递的一些巧妙方法）来存储每个相邻块的交付点数。

现在您可以使用与照片处理软件类似的方式在此网格上进行操作。您可以通过查找某些相邻块中没有交付点的块来检测集群的边缘。

最后，您需要一个系统，该系统结合了交付的数量以及行驶的总距离来创建和分配路线。可能有一些孤立的集群，只有少量的交付，以及一两个超级集群，其中许多家庭彼此非常接近，需要多个送货员在同一个集群中。必须访问每个家庭，这是您的第一个限制。

推导出任何一名送货员单次运行的最大允许距离。接下来对每人交付的数量执行相同的操作。

路由算法的第一次运行将分配一个送货员，将他们发送到任何未完成所有送货的随机集群，让他们送货，直到他们达到送货限制或他们已经送货到集群中的所有家庭。如果他们已达到交货限制，请将他们送回基地以结束路线。如果他们可以安全地前往最近的集群然后回家而不会达到他们的最大旅行距离，请这样做并重复上述操作。

为当前送货员完成路线后，检查是否有房屋尚未送货。如果是这样，请指定另一个送货员，并重复上述算法。

这将生成初始路线。我会存储所有信息——每个广场的位置和尺寸、一个广场内的房屋数量及其所有直接邻居、每个广场所属的集群、送货人及其路线——我会存储所有这些在数据库中。

我将把重新计算过程留给您 - 但是在数据库中拥有所有当前路线、集群等将使您能够保留所有历史路线，并尝试各种方案以了解如何最好地适应变化，从而产生最少的影响对现有路线的可能更改。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-28T01:22:42.583

这是一个值得[优化的解决方案](http://en.wikipedia.org/wiki/Category:Optimization_algorithms)而不是试图解决“最佳”问题的经典示例。它在某些方面类似于“[旅行商问题](http://en.wikipedia.org/wiki/Traveling_salesman_problem)”，但您还需要在优化期间对位置进行分段。

我使用了三种不同的优化算法来解决这样的问题：

1.  [模拟退火](http://en.wikipedia.org/wiki/Simulated_annealing)
2.  [大洪水算法](http://en.wikipedia.org/wiki/Great_Deluge_algorithm)
3.  [遗传算法](http://en.wikipedia.org/wiki/Genetic_algorithm)

使用优化算法，我认为您已经描述了以下“目标”：

1.  每个报童的地理区域应该最小化。
2.  每个服务的订阅者数量应该大致相等。
3.  每个人走过的距离应该大致相等。
4.  （还有一个你没有说明，但可能很重要）路线应该在它开始的地方结束。

希望这能让你开始！

*** 编辑 ***

如果您不关心路线本身，则可以消除上述目标 3 和 4，并可能使问题更适合您的奖金要求。

如果您考虑人口统计信息（例如人口密度、订阅采用率和订阅取消率），您可能可以使用上述优化技术来完全消除在订阅者采用或放弃您的服务时重新运行算法的需要。一旦集群被优化，它们将保持平衡，因为每个集群的速率与其他集群的速率相匹配。

唯一需要重新运行该算法的时间是外部因素（例如经济衰退/萧条）导致人口群体的行为发生变化。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-18T21:56:55.910

我认为您确实想要 Set Covering location 模型的一些变体，而不是聚类模型，并带有一个额外的约束来覆盖每个设施所覆盖的地址数量。我在网上真的找不到很好的解释。您可以查看[此页面](http://mat.gsia.cmu.edu/orclass/integer/node8.html)，但他们正在使用面积单位解决它，您可能希望在欧几里得或网络空间中解决它。如果您愿意挖掘死树格式的内容，请查看 Daskin 的 Network and Discrete Location 的第 4 章。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-18T21:58:52.833

对简单聚类算法的良好调查。还有更多：http: [//home.dei.polimi.it/matteucc/Clustering/tutorial_html/index.html](http://home.dei.polimi.it/matteucc/Clustering/tutorial_html/index.html)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-18T22:31:51.053

可能是客户的最小生成树，根据报童的位置分为一组。[Prims](http://en.wikipedia.org/wiki/Prim%27s_algorithm)或[Kruskal](http://en.wikipedia.org/wiki/Kruskal%27s_algorithm)用房屋之间的距离来获得 MST 的重量。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-28T02:15:23.473

我知道一种非常新颖的方法来解决这个问题，我已经看到它应用于生物信息学，尽管它适用于任何类型的聚类问题。这当然不是最简单的解决方案，但我认为它非常有趣。基本前提是聚类涉及多个目标。对于一个您想要最小化集群数量的人来说，简单的解决方案是一个包含所有数据的集群。第二个标准目标是最小化集群内的方差量，简单的解决方案是许多集群，每个集群只有一个数据点。当您尝试同时包含这两个目标并优化权衡时，就会出现有趣的解决方案。

所提出方法的核心是一种称为[模因算法](http://en.wikipedia.org/wiki/Memetic_algorithm)的东西，它有点像史蒂夫提到的遗传算法，但它不仅很好地探索了解决方案空间，而且还能够专注于有趣的区域，即解决方案。至少我建议阅读一些关于这个主题的论文，因为模因算法是一种不寻常的方法，尽管有一点警告；它可能会引导您阅读 The Selfish Gene 我还没有决定这是否是一件好事......如果您对算法不感兴趣，那么也许您可以尝试按照格式要求表达您的问题并使用源代码提供的代码。相关论文和代码可以在这里找到：[多目标聚类](http://dbkgroup.org/handl/mock/)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-01T09:53:42.363

这与问题没有直接关系，但我听说过，如果这确实是您遇到的路线规划问题，应该考虑一下。这将影响分配给每个驱动程序的集合内地址的顺序。

UPS 的软件可以为他们的送货人员生成最佳路线。该软件试图最大限度地增加路线中右转的次数。这为他们节省了大量的交货时间。

对于不住在美国的人来说，这样做的原因可能不是很明显。在美国，人们在马路右侧开车，所以在右转时，如果绿灯，您不必等待迎面而来的车辆。此外，在美国，当红灯右转时，您（通常）不必等到绿灯才可以走。如果你总是右转，那么你永远不必等待灯。

这里有一篇关于它的文章： [http ://abcnews.go.com/wnt/story?id=3005890](http://abcnews.go.com/wnt/story?id=3005890)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-18T21:44:53.163

您可以通过使用先前的聚类作为聚类特征，使 K 均值或预期最大化保持尽可能不变。让每个集群拥有相同数量的项目似乎有点棘手。我可以考虑如何通过执行 k 方法将其作为后聚类步骤，然后将一些点改组直到事情平衡，但这似乎不是很有效。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-23T10:28:41.893

一个没有任何奖励积分的简单答案：

每个地址一个送货员。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-24T11:13:44.337

我承认这不一定会提供大小大致相等的集群：

数据聚类中目前最好的技术之一是证据积累。(Fred and Jain, 2005) 你要做的是：

给定具有 n 个模式的数据集。

1.  在 k 的范围内使用类似 k-means 的算法。或者使用一组不同的算法，目标是产生一个分区集合。

2.  创建一个大小为 nx n 的联合关联矩阵 C。

3.  对于集成中的每个分区 p：
    3.1 更新协关联矩阵：对于 p 中属于同一簇的每个模式对 (i, j)，设置 C(i, j) = C(i, j) + 1 /N。

4.  使用聚类算法（例如 Single Link）并应用矩阵 C 作为邻近度度量。Single Link 给出了一个树状图作为我们选择具有最长生存期的聚类的结果。

如果您有兴趣，我将提供 SL 和 k-means 的描述。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-27T17:22:18.107

> *   您有一组街道地址，每个地址都经过地理编码。
>     *   您希望对地址进行集群，以便将每个集群分配给一名送货员。
>     *   送货人员或集群的数量不是固定的。如果需要，我总是可以雇佣更多的送货员，或者解雇他们。
>     *   每个集群应该有大约相同数量的地址。但是，如果集群的地址更加分散，则集群的地址可能会更少。（换种说法：最小数量的集群，其中每个集群包含最大数量的地址，并且集群内的任何地址必须相隔最大距离。）
>     *   对于奖励积分，当数据集被更改（添加或删除地址）并且算法重新运行时，如果集群尽可能保持不变（即，这排除了简单的 k-means 聚类，即随机性）。不然快递员会发疯的。

如前所述，车辆路线问题可能更适合......虽然严格设计时并未考虑到集群，但它会根据最近的地址进行优化分配。因此，您的集群实际上将是推荐的路线。

如果您提供最大数量的交付者并尝试达到最佳解决方案，这应该会告诉您所需的最小值。这涉及第 2 点。

可以通过对要访问的地址数量进行限制来获得相同数量的地址，基本上是分配一个库存值（现在它是一个受限制的车辆路线问题）。

如果地址更加分散（现在是时间窗口的人满为患的车辆路线问题），则添加送货人员工作的时间窗口或小时有助于减少负载。

如果您使用最近邻算法，那么您每次都可以获得相同的结果，删除单个地址不应该对您的最终结果产生太大影响，因此应该处理最后一点。

我实际上正在开发一个 C# 类库来实现这样的目标，并认为它可能是最好的方法，尽管它并不容易实现。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2009-02-19T07:41:41.170

我将使用基本算法根据他们的居住地和订阅者的当前位置创建第一组报童路线，然后：

当报童是：

*   补充：他们从一个或多个在新人居住的一般区域工作的报童那里获取位置。
*   删除：他的位置被提供给其他报童，使用离他们路线最近的位置。

当位置是：

*   补充：同样的，位置被添加到最近的路线。
*   移除：刚刚从那个男孩的路线中移除。

每季度一次，您可以重新计算整个事情并更改所有路线。

# .net - GAC 行为

> ID：562909
> 
> 赞同：1
> 
> 时间：2009-02-18T21:26:49.837
> 
> 标签：.net, dll, gac

我将签名的dll放入GAC。我从其他应用程序可以访问它的文件夹中删除了这个 dll。我尝试运行使用该 dll 的客户端应用程序。Dll 立即被放回原始文件夹。它是如何发生的？

我猜 GAC 正在监视文件夹，当它检测到缺少 dll 时，它会将最新版本放回其他应用程序可以访问的文件夹中。如果我是正确的，请告诉我如果重新构建，GAC 是否会再次自动备份 dll。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T21:32:36.937

GAC 不知道程序集的来源。最可能的解释是您只是通过 IDE 重建了 DLL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T21:37:00.420

我不知道为什么会发生这种情况，但这些信息可能会对您有所帮助，

您不需要从复制到 GAC 的位置删除文件。如果应用程序依赖于程序集，则 GAC 是主要查找位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T22:05:50.883

此外，如果您将使用不同的版本并使用重定向，请务必在您的参考属性中将“特定版本”标记为错误。

回答您的问题：不，GAC 不会监视任何其他文件夹以查找对 dll 所做的更新。您必须使用 gacutil 安装每个版本的 dll。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-29T18:55:19.323

要成功部署 .NET Framework 应用程序，您必须了解公共语言运行时如何定位和绑定到构成您的应用程序的程序集。默认情况下，运行时尝试与构建应用程序的程序集的确切版本进行绑定。此默认行为可以被配置文件设置覆盖。

尝试定位程序集并解析程序集引用时，公共语言运行库会执行许多步骤。每个步骤都将在以下部分中进行说明。在描述运行时如何定位程序集时，经常使用探测一词。它指的是用于根据程序集名称和文化定位程序集的一组启发式方法。

您可以使用Windows 软件开发工具包 (SDK) 中包含的程序[集绑定日志查看器 (Fuslogvw.exe) 查看日志文件中的绑定信息。](http://msdn.microsoft.com/en-us/library/e74a18c4.aspx)

问候...

s

# .net - 如何覆盖 WinForms 中数据绑定控件上的错误消息？

> ID：562915
> 
> 赞同：1
> 
> 时间：2009-02-18T21:29:16.960
> 
> 标签：.net, vb.net, winforms, data-binding, error-handling

我的应用程序中有一个表单，它使用绑定源将控件绑定到模型对象。这有效，并处理基本验证，例如确保用户不会在数字字段中输入文本。我正在使用一个 ErrorProvider，并设置它的数据源 = 绑定源，以便向用户显示错误消息，这也很有效。

但是，我无法弄清楚两件事：

1.  如何使用对最终用户更直观的内容覆盖默认错误消息。例如，上面提到的场景中的默认消息是：“输入字符串的格式不正确”，我更喜欢这样说：“年龄必须是一个正整数”。

2.  如何使用更复杂的业务逻辑轻松扩展这个系统。例如，上面的默认处理程序将阻止接受字符串作为数字，但默认情况下不会强制年龄 > 0。我知道我可以为每个控件覆盖 onValidate，但似乎应该有一种更简单的方法，它依赖于数据模型，而不是单个控件。

我尝试如下更新我的设置器，希望该消息随后会显示在使用此模型对象的所有表单/绑定上，但这不起作用：

```
Public Property Age() As Integer
  Get
    Return m_age
  End Get
  Set(ByVal Value As Integer)
    If Not IsNumeric(Value) And Value > 0 Then
      Throw New ArgumentException("Age must be a positive integer.")
    End If
    m_age = Value
  End Set
End Property 
```

其他想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T16:50:45.923

所以据我所知，这几乎是可能的，但由于一些古怪的行为，不能像你想要的那样简单。问题源于格式化程序和类型转换器吞下/覆盖域对象的错误消息这一事实。

这和我得到的一样接近：

对于您要绑定的域对象：

*   实施`System.ComponentModel.IDataErrorInfo`，返回您想要的用户友好消息。
*   实施`INotifyPropertyChanged`以提醒更改的绑定源。

将 ErrorProvider.DataSource 设置为 BindingSource。

`Validating`为要覆盖默认转换错误消息的每个文本字段 添加事件处理程序。

手动为您的控件添加绑定，以便您可以关闭格式设置。如果您不这样做，格式化程序将吃掉您提供的任何自定义错误消息。所以不要在VS中使用属性编辑器。相反，分配绑定 ala：

```
TextBox1.DataBindings.Add("Text", BindingSource1, "Age", False, DataSourceUpdateMode.OnValidation) 
```

如果您执行上述操作，那么您的最终用户将正确地看到您的模型对象的错误消息，只要转换没有导致错误。如果转换导致错误，他们将看到您在`Validating`处理程序中提供的消息（如果有的话），否则会看到通用消息。

仍然不是一个想法解决方案，但这是我能得到的最接近的。我说不理想是因为此解决方案阻止您使用自动格式化，并且如果您在多个地方使用模型对象，则要求您在不同的表单上复制一些验证消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T20:42:00.603

这里。这应该可以为您节省*大量*工作。

简而言之：要验证绑定控件，需要处理三个事件。

*   当用户离开控件时验证数据的`Control.Validating`事件，
*   事件，当`Control.Validated`且仅当它被正确验证时更新数据源，并且
*   该`Binding.Parse`事件在其他任何事情更改控件中的数据（即您的代码）时验证数据。

为确保仅将有效数据写入数据源，绑定数据的自动更新在创建时关闭`Binding`- 这样，数据*仅*`Control.Validated`在事件期间写入数据源。

`Validating`和事件都`Parse`将验证错误消息放入`ErrorProvider`附加到绑定中`Control`；您可能希望以其他方式显示错误消息，在这种情况下，您需要更改这两个事件。

您可能还想处理绑定的`Format`事件，以控制字段中的数据如何在绑定控件中呈现。

我没有重写此代码以使其通用，因为我不想引入任何错误。所以我会解释什么`fc`和`cm`是什么，只要你需要知道才能让它工作。

`fc`是包装我的应用程序绑定`Control`对象的类的实例。它有一个`Control`属性（显然是包装的控件），然后是其用途如下所示的属性`Binding`。`ErrorProvider`请注意，由于此代码为您设置了数据绑定，因此您无需在表单设计器中设置控件的绑定。严格来说，你*不需要*这个类来使这段代码工作，但它确实在一定程度上简化了代码。`fc`（这里的所有代码都来自传递给的类的静态方法`BindingSource`，如图所示。）

`cm`是一个类的实例，其中包含有关我将控件绑定到的数据列的元信息，特别是：

*   `ColumnName`，它在数据源中的名称（我显然绑定到 a `DataColumn`），
*   `PropertyName`，它绑定到的控件属性的名称（例如`"Text"`），
*   `NullValue`，如文档中所述`Binding.NullValue`，
*   `Format`，格式化列的内部值以在绑定控件中显示的方法，以及
*   `Parse`, 将输入解析为列内部值的方法。列的实际验证逻辑位于此处。

很明显，这是 C#，所以你需要弄乱它才能让它在 VB 中工作，但差异应该只是语法问题。

```
 // add an ErrorProvider to the control so that we have a place to display
 // error messages
 fc.ErrorProvider = new ErrorProvider {BlinkStyle = ErrorBlinkStyle.NeverBlink};

 // create the Binding.  DataSourceUpdateMode.Never bypasses automatic updating
 // of the data source; data only gets written to the data source when the
 // column is successfully validated.
 fc.Binding = fc.Control.DataBindings.Add(
    cm.PropertyName,
    bindingSource,
    cm.ColumnName,
    true,
    DataSourceUpdateMode.Never,
    cm.NullValue);

 // this is called whenever the Binding pushes data back to the data source;
 // it parses the data in the control into an object that's returned in e.Value.
 fc.Binding.Parse += delegate(object sender, ConvertEventArgs e)
 {
     string property = fc.Binding.PropertyName;
     object unparsedValue = fc.Control.GetType().GetProperty(property).GetValue(fc.Control, null);

     string message;
     // note that we don't actually care about the parsed value if message
     // is not null (i.e. if the value is invalid).  by convention it's null,
     // but it won't ever get written back to the data source.
     object parsedValue = cm.Parse(unparsedValue, out message);
     if (message != null)
     {
         fc.ErrorProvider.SetError(fc.Control, message);
     }
     else
     {
         fc.ErrorProvider.Clear();
     } 
     e.Value = parsedValue ?? DBNull.Value;
  };

  // this is called whenever the user leaves the Control.
  fc.Control.Validating += delegate
                                     {
     string property = fc.Binding.PropertyName;
     object value = fc.Control.GetType().GetProperty(property).GetValue(fc.Control, null);
     string message;
     cm.Parse(value, out message);
     if (message != null)
     {
         fc.ErrorProvider.SetError(fc.Control, message);
     }
     else
     {
         fc.ErrorProvider.Clear();
     }
 };

 // this, combined with the DataSourceUpdateMode of Never, insures that the Control's
 // value only gets pushed out to the data source after validation is successful.
 fc.Control.Validated += delegate {
     fc.Binding.WriteValue();
 };

 // this is called whenever the Binding pulls data from the data source into 
 // the bound Control
 fc.Binding.Format += delegate(object sender, ConvertEventArgs e)
 {
     e.Value = cm.Format(e.Value);
 }; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T18:47:45.750

将错误返回给调用者。然后，捕获您想要“覆盖”的异常类型。与其显示该异常消息，不如抛出一个自定义异常并显示其消息。

# mysql - 简单的Mysql表连接问题

> ID：562917
> 
> 赞同：1
> 
> 时间：2009-02-18T21:30:12.433
> 
> 标签：mysql, join

我正在设计一个网站来教自己如何在 mysql 中使用表连接，并且很早就被卡住了。（这些数字是 Wii 好友代码，如果这有助于您理解这一点！）

我有 3 张桌子：

用户：

```
id, firstname, surname 
```

游戏：

```
id, title 
```

数字：

```
number, users_id, game_id 
```

该号码是属于用户并与游戏相关联的唯一代码。

我正在尝试获取特定游戏的数字列表以及它们所属用户的名称。

我正在运行查询：

```
SELECT firstname, surname, number FROM games, users, numbers WHERE numbers.game_id = games.id AND games.title = 'foogame' 
```

例如，要取出所有属于 foogame 的数字。但是，这会返回任何没有此游戏代码的用户以及来自其他用户的随机代码。如何使此查询仅返回实际拥有该游戏代码的用户？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-18T21:33:10.570

我发现如果您实际使用连接会更容易，因为您不会像第一次那样错过连接条件。

> ```
> SELECT firstname, surname, number 
> FROM users u
> INNER JOIN numbers n
>   on n.users_id = u.id
> INNER JOIN games g
>   on n.game_id = g.id
> WHERE g.title = 'foogame' 
> ```

INNER JOIN 相当于你所做的 - 它特别限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T21:32:47.483

```
SELECT firstname, surname, number
FROM games g, numbers n, users u
WHERE g.title = 'foogame'
  AND n.game_id = g.id
  AND u.id = n.users_id 
```

要优化，请创建索引：

```
CREATE INDEX ix_game_title ON games (title)

CREATE INDEX ix_numbers_game ON numbers (game_id, users_id) 
```

当然，制作你的`games.id`和`users.id`主键。

如果您想`numbers`在所有`games`给定的特定条件下进行搜索`user`，您还需要：

```
CREATE INDEX ix_numbers_users ON numbers (users_id) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-16T02:26:42.880

我建议最初从一项更改开始。

甚至不要称任何对象或属性为“数字”。

在这种情况下，可以分别调用表和列“game_code”和games_codes。

那么：

```
SELECT firstname, surname, number 
FROM games, users, numbers 
WHERE numbers.game_id = games.id AND games.title = 'foogame' 
```

变成

```
SELECT firstname, surname, game_code
FROM games g, users u, game_codes gc
WHERE gc.game_id = g.id AND g.title = 'foogame' 
```

当然还有其他的加入

```
AND gc.users_id = u.id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T21:31:56.360

啊 - 只是写这个问题对我有帮助！

```
SELECT firstname, surname, number 
FROM   games, users, numbers 
WHERE  numbers.game_id = games.id AND 
       games.title = 'foogame' AND 
       games.user_id = users.id 
```

简单的！

有什么优化这个的想法吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T21:34:42.063

您需要将`numbers`表格`users_id`和`game_id`列链接到用户和游戏 ID 列。只需添加：

```
AND users_id = users.id
AND game_id = games.id 
```

您也可以使用 a`JOIN`代替。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T05:50:26.133

跟进汤姆的回答......如果您是 MySQL 新手，我建议您逐步分解它，并非常清楚从哪里抓取了什么。您可以将其视为两个表的连接，然后第三个进入其中。您还可以使用括号，以便在几个月后返回时允许一些分离。

```
SELECT firstname, surname, number 
    FROM 
    (
        (users u INNER JOIN numbers n ON(n.user_id = u.id) )
        INNER JOIN games g ON(n.game_id = g.id)
    )
    WHERE g.title = 'foogame' 
```

# php - 将图像拖放到 Web 表单中

> ID：562919
> 
> 赞同：9
> 
> 时间：2009-02-18T21:30:17.643
> 
> 标签：php, javascript, html, drag-and-drop, applet

我们有一个允许用户上传图片的网页（主要是 HTML javascript 和 PHP）。我们有正常的浏览按钮，它工作正常。但是，我们希望添加将图像拖放到文本字段中的功能。

gmail 允许您在他们的邮件应用程序中执行此操作，所以这是可能的。我们想到的唯一方法是创建一个 Java 小程序来完成所有这些工作，但这最终会变得非常混乱。

有人做过吗？它是如何工作的？

**编辑：**我在 Mac 上使用 firefox。我的大多数用户可能会在 Windows 上使用 IE。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T21:57:27.267

您可以在 XUL（使其有效地成为仅限 Firefox 的解决方案）或 ActiveX（仅限 IE 的解决方案）中执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T22:33:13.860

这是一个老问题，但它出现在我的搜索结果中。

因此，作为参考，请使用 HTML5 文件类和拖放。

此处有详细信息的文章：http: [//www.html5rocks.com/en/tutorials/file/dndfiles/](http://www.html5rocks.com/en/tutorials/file/dndfiles/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T21:43:36.317

我已经尝试拖放并为他们的编辑器提供图像。如果文件在网页上，它将选择路径，但如果它在本地驱动器上，则路径将为“file://c:....”，不会与消息一起上传，而是最终成为一个破碎的形象。

出于安全原因，浏览器无权访问本地文件系统，所以我怀疑这是否会按照您描述的方式工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T21:39:34.113

将文件拖放到普通输入字段中会将图像的本地路径复制到输入字段中，但这对您来说毫无价值，因为出于安全原因，<input type='file'> 标记的 .value 属性是只读的。

您会注意到 gmail 仅允许您将图像（用于上传）拖放到 <input type='file'> 输入而不是任何其他字段。

我认为您要问的是[**“我如何设置 <input type='file'> 标签的样式，例如 google”**](http://www.quirksmode.org/dom/inputfile.html)，这是另一个话题。

编辑：好的，在 IE 中，您不能将文件拖到 <input type='file'> 标记中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-19T11:18:46.717

完成此任务的最佳方法是制作独立的 Adob​​e AIR，例如[https://www.photoshop.com/express的照片上传器](https://www.photoshop.com/express)

* * *

你可以在这篇文章中找到一些很棒的信息：http: [//devzone.zend.com/article/3650-Desktop-Image-Uploaders-Using-Adobe-AIR-and-JavaScript](http://devzone.zend.com/article/3650-Desktop-Image-Uploaders-Using-Adobe-AIR-and-JavaScript)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-21T00:34:50.743

我想我有办法解决烦人的 FF3 本地文件系统问题，但我需要一段 javascript 来测试。如何从文件上传表单中读取本地文件路径？请停止使用“闪存是一种解决方案”。我是一名 Flash 开发人员，即使我认为这不是一个好的解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-21T01:09:07.527

您是否偶然安装了此 Firefox 扩展程序？

[http://www.teslacore.it/wiki/index.php?title=DragDropUpload](http://www.teslacore.it/wiki/index.php?title=DragDropUpload)

如果有无需安装外部插件或扩展的解决方案，我会感到惊讶。正如有人提到的那样，这将是一个安全问题。一个网站将能够从人们的计算机中获取文件并在他们不知情的情况下上传它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-16T14:14:55.077

查看 SWELL 框架。它基于javascript。

# windows - 如何识别通过远程桌面连接到 Windows 服务器的用户

> ID：562922
> 
> 赞同：5
> 
> 时间：2009-02-18T21:31:09.110
> 
> 标签：windows, logging, scripting, remote-desktop, event-log

在我的工作场所，我们有用于进行测试的实验室机器。

预留一台机器进行测试的标准程序是在办公室里走动，以确保没有人在使用这台机器。

这是非常低效且耗时的。

起初，我建立了一个网页，人们可以在其中预订实验室机器，但没有人保持页面更新，结果证明它毫无用处。

我终于找到了一个使用[微软日志解析器](http://www.microsoft.com/technet/scriptcenter/tools/logparser/default.mspx)的解决方案，并想把它分享给堆栈溢出社区。

它是在机器上运行的批处理文件，因此用户可以识别最后使用机器的用户并轻松地向他们发送 IM 以询问机器是否空闲。

有没有更好的解决方案来做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-18T22:20:57.943

使用**内置**命令**qwinsta**（Query Win Station）来确定哪些会话（包括控制台）处于活动状态或处于非活动状态（断开连接），然后根据给定的信息采取行动（信任 krusty.ar 顺便说一句已经链接了）。

如果您觉得人们在滥用相关机器，请参考**rwinsta**以将他们的会话彻底遗忘......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T21:33:12.817

您将需要安装[Microsoft 日志解析器](http://www.microsoft.com/technet/scriptcenter/tools/logparser/default.mspx)

然后创建以下2个文件

> TSLoginsDetails.sql

```
SELECT 
      timegenerated, 
      EXTRACT_TOKEN(Strings,1,'|') AS Domain, 
      EXTRACT_TOKEN(Strings,0,'|') AS User, 
      EXTRACT_TOKEN(Strings,3,'|') AS SessionName,
      EXTRACT_TOKEN(Strings,4,'|') AS ClientName,
      EXTRACT_TOKEN(Strings,5,'|') AS ClientAddress,
      EventID
FROM Security 
WHERE EventID=682 
ORDER BY timegenerated DESC 
```

> TSLogins.bat

```
echo off
cls
c:
cd "c:\Program Files\Log Parser 2.2\"
logparser.exe file:TSLoginsDetails.sql -o:DATAGRID 
```

现在，通过将此批处理文件放在桌面上，用户可以查看谁是最后登录的人，并通过 IM 与他们联系以验证他们是否已完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T21:40:34.093

如何将日志文件中的信息发布到网站上，告诉谁当前正在使用机器。

1.  检查并在他们登录时通知。
2.  更新了您之前制作的“谁在使用机器”页面。
3.  运行一个 AT 作业，每隔几个小时检查一次谁在上面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T23:51:27.510

完全开箱即用：

您可以在服务器和桌面上安装[软件测试自动化框架 (STAF)](http://staf.sourceforge.net/)来管理您的测试。它是用 Java 编写的，因此您可以在 Windows 和 Unix/Linux 桌面和服务器上使用它。

使用 STAF，您可以创建一个测试服务器资源池，在其上进行测试，然后编写 STAX 作业（STAX 是一个 STAF 执行框架）来进行测试。该作业可以从资源池中获取第一台可用的服务器，运行测试，监控测试状态，记录结果，通知提交者，然后在完成后将服务器释放回池中。如果您有多个人提交测试作业，STAF 将管理请求队列并在他们进来时满足他们。用户可以从他们的桌面监控作业，或者您可以设置电子邮件警报以在测试完成时通知他们.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T22:08:51.030

我不确定我是否理解你，但是有一组[命令行工具可以处理终端服务器会话](http://www.robvanderwoude.com/termserv.php#QWinSta)，如果你需要从程序中执行此操作，还有一个[Windows API可以执行相同的操作。](http://msdn.microsoft.com/en-us/library/aa383459(VS.85).aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T22:13:52.813

由于听起来您是一家微软商店，因此您可以将机器设置为 Outlook/exchange 中的资源并以这种方式保留它们。

# oracle - Fluent NHibernate - 如何为 oracle 配置？

> ID：562926
> 
> 赞同：9
> 
> 时间：2009-02-18T21:31:36.160
> 
> 标签：oracle, nhibernate, fluent-nhibernate

几乎可以肯定是一个愚蠢的问题，但我在任何地方都找不到答案。

在[入门教程](http://wiki.fluentnhibernate.org/show/GettingStarted:+First+Project)中，数据库是 SQLite，因此他的会话工厂创建是使用 FluentNHibernate.Cfg.Db 命名空间中的 SQLiteConfiguration 类完成的

伟大的！但我没有看到使用 Oracle 数据库的配置类。我该怎么做呢？

交叉发布到[流畅的 NH 邮件列表（附答案）](http://groups.google.com/group/fluent-nhibernate/browse_thread/thread/8a10a61a9a1d7581#)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T04:57:29.717

这对我有用。希望这可以帮助！

```
private static ISessionFactory CreateSessionFactory()
    {

        var cfg = OracleClientConfiguration.Oracle9
            .ConnectionString(c =>
                c.Is("DATA SOURCE=<<NAME>>;PERSIST SECURITY INFO=True;USER ID=<<USER_NAME>>;Password=<<PASSWORD>>"));

        return Fluently.Configure()
                .Database(cfg)
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<CLASS_NAME>().ExportTo(@".\"))
                .ExposeConfiguration(BuildSchema)
        .BuildSessionFactory();
    }

    private static void BuildSchema(NHibernate.Cfg.Configuration config)
    {
        // this NHibernate tool takes a configuration (with mapping info in)
        // and exports a database schema from it
        new SchemaExport(config)
          .Create(false, true);
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T22:07:32.673

这对你有帮助吗？

[http://tiredblogger.wordpress.com/2008/12/04/persistanceconfiguration-for-oraclefluent-nhibernate/](http://tiredblogger.wordpress.com/2008/12/04/persistanceconfiguration-for-oraclefluent-nhibernate/)

**编辑：** 提到的代码使用了 Fluent NHibernate 中不再存在的 ConnectionStringExpression 类。但是，该类仅用于保存**OracleConfiguration _config**字段。您可以安全地将该字段添加到 OracleConnectionStringExpression 类并将其删除。

剩下的问题是，NHibernate 现在会出于某种原因寻找当前版本的 Oracle.DataAccess 中没有的组件。如果你想处理这个问题，你可以做[这里](http://tiredblogger.wordpress.com/2008/11/07/using-oracle-odp-with-nhibernate-from-a-c-class-library/)的tiredblogger 所做的事情。

# cocoa-touch - 如何在自己的应用程序中创建一个控制器来模拟 iPhone 的 Springboard 功能

> ID：562932
> 
> 赞同：3
> 
> 时间：2009-02-18T21:32:18.200
> 
> 标签：cocoa-touch

我正在尝试在我的 iPhone 应用程序中设计一个功能，以模拟 Springboard 功能（iPhone 的主菜单允许您查看更多应用程序），或者天气应用程序的工作方式允许您在视图之间切换。

有没有人有这方面的任何样本，我将如何去做。这似乎很微不足道，但我想知道我是否遗漏了一些已经作为 Apple 示例或对此做了教程的人。

下图显示了用户将如何使用它。 [替代文字 http://www.agilitesoftware.com/SpringboardExample.png](http://www.agilitesoftware.com/SpringboardExample.png)

当他们将手指向右（或向左）滑动时，另一个图像将开始出现。它的动画效果会很流畅。您滑动手指的速度越快，它移动到下一个视图的速度就越快。

**更新：**另一个功能是，当您将手滑过与当前视图对齐的显示屏时，它应该模仿相同的感觉。如果您滑动手指的方向有超过 1 个视图，则不应继续滑动。

我已经看到其他应用程序使用它，所以这就是我问的原因。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T21:35:13.827

这是使用 UIScrollView 将 pagingEnabled 属性设置为 true 来完成的。只需添加您的每个视图，调整 contentSize，它就会自动“分页”到整个内容的屏幕宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T22:24:55.783

Apple.com 上的 iPhone 开发人员网站上有一个具有此功能的示例应用程序（带有代码）（我相信它被称为“PageControl”。） - 我建议检查一下。

d。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T07:19:49.833

我正在编写一个使用类似 UI 的应用程序。正如 NilObject 推荐的那样，我们使用的是`UIScrollView`with `pagingEnabled=YES`。

您可能还对[这个仅涉及两个子视图的示例代码](http://cocoawithlove.com/2009/01/multiple-virtual-pages-in-uiscrollview.html)感兴趣。我现在正在尝试；这是一种有趣的技术，但我不得不为一些奇怪的情况编写一些额外的特殊情况代码。

该站点上还有[另一个问题](https://stackoverflow.com/questions/508167/how-do-i-create-a-grid-of-icons-like-the-iphone-home-screen)，询问有关创建像主屏幕这样的图标网格的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T23:02:51.677

[为此，我会从Three20 项目](http://github.com/joehewitt/three20/tree/master)中查看 Joe Hewitt 的代码。它提供了一个很好的界面，并进一步细化了 UIScrollView 实现为 TTScrollView 和 TTScrollViewDelegate，TTScrollViewDataSource。

# vb.net - 在 VB.NET 中遍历 request.querystring

> ID：562943
> 
> 赞同：4
> 
> 时间：2009-02-18T21:36:38.863
> 
> 标签：vb.net, query-string

我正在尝试遍历查询字符串并提取某些值，如下所示：

```
?ProductID=1234&ProductID=4321&Quantity=1 
```

对于 ProductID 旁边的每个值，我想执行一些逻辑。但我不确定如何获得这些价值观。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T22:58:41.927

当您的查询字符串具有多个具有相同键的值时，您可以使用返回字符串数组的[NameValueCollection.GetValues](http://msdn.microsoft.com/en-us/library/4ba5htte.aspx)方法：

```
dim productID as string
for each productID  in Page.Request.QueryString.GetValues("ProductID")
  ' do something with productID
next productID 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-18T21:43:10.640

这是一些未经测试的伪代码，应该适用于页面后面的代码。我希望这有帮助。

```
dim key as string
dim list as new arraylist()
for each key in Page.Request.QueryString.Keys
 if key = "ProductID" then
   list.add(Page.Request.QueryString(key))
 end if
next key

' do somthing with the list of product id's 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T21:48:01.173

```
Dim productID = Request.Querystring("ProductID")
Dim quantity = Request.Querystring("Quantity") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T21:42:29.627

```
Dim sQS as String = Request.QueryString.ToString
For Each eItem In Split(sQS, "&")
Dim sName As String = Left(eItem, InStr(eItem & "=", "=") - 1)
Response.Write(sName _
& " = " & Request.QueryString(sName) _
& "<br>")
Next 
```

这更短但基于相同的想法

```
For Each Key As String In Request.QueryString.Keys
Response.Write(Key & " = " & Request.QueryString(Key) & "<br>")
Next 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T21:43:05.897

试试这个。仅适用于 VB9。

```
Dim queryString = GetQueryString()
queryString = queryString.SubString(1) 'Remove ?
Dim ids = queryString. _
  Split("&"c). _
  Select(Function(x) x.Split("="c)). _
  Where(Function(x) x(0) = "ProductId" ). _
  Select(Function(x) x(1)) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-12T13:15:46.683

供阅读`Value`使用`get Parameter``Request.QueryString.Item("param")`

# c++ - C++ 程序中堆栈溢出的症状是什么？

> ID：562973
> 
> 赞同：6
> 
> 时间：2009-02-18T21:45:40.790
> 
> 标签：c++, stack-overflow

我刚刚遇到一个问题，当本地对象试图调用一个非常简单的过程时，HPUX 上的线程 c++ 程序中的堆栈溢出导致 SEGV_MAPERR。我有一段时间感到困惑，但幸运的是，我与一个认识到这是堆栈大小问题的人交谈，我们能够通过增加线程可用的堆栈大小来解决这个问题。

如何识别堆栈何时溢出？windows/linux/hpux 上的症状是否不同？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-18T21:48:57.973

假设您不在一个会停止您的应用程序并说“堆栈溢出”的平台上，我怀疑您会看到与任何类型的缓冲区溢出相同的行为。堆栈只是为您的程序预先分配的另一块内存，如果您超出这些范围...祝您好运！谁知道你会踩到什么！

你可以重写 CPU 的温度读数，它可能是你正在给拉里输入的电子邮件，也可能是说内核被锁定，导致一个有趣的死锁状态！谁知道。

至于 C++，没有什么说堆栈应该如何与内存中的其他东西相关联，或者这个东西甚至需要是一个堆栈！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T23:42:14.397

> 如何识别堆栈何时溢出？

如果您知道堆栈大小、堆栈开始的位置以及它在内存中的增长方向，您可以简单地检查[堆栈指针](http://en.wikipedia.org/wiki/Stack_pointer#Structure)的地址，看看它是否超过了堆栈的末尾。C++ 不允许直接访问堆栈指针。您可以轻松地在汇编中编写一个小函数来执行此分析并将其链接到您的程序中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T21:57:21.073

Windows 上的异常代码`0xC00000FD`。

当您意识到您的 SEH 停止工作时，通常更容易诊断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T22:00:11.833

也许有点跑题了，但 Ada 中的类似问题（任务中的堆栈空间不足）是一个相当常见的“不常见”错误。许多编译器会以 PROGRAM_ERROR 异常停止任务（但不是主任务）。

在某种程度上，你几乎必须能够嗅出这个。它往往以“我将这个大数组移动到我的任务中，然后它突然停止工作”之类的东西开始。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-10-24T18:35:47.313

输出到屏幕的文本与来自被测程序的代码行混合在一起。还存在以前的 bash 命令和其他来源不明的文本。再加上程序文本已损坏。

# vb.net - 如何捕捉 Microsoft Word 文档第一页上的文本？

> ID：562976
> 
> 赞同：1
> 
> 时间：2009-02-18T21:46:48.447
> 
> 标签：vb.net, interop, ms-word, vsto

使用 VB.NET 如何捕获 Microsoft Word 文档第一页上的文本？我已经导入了 Word 12 互操作库（用于 Word 2007），并且我知道如何使用 document.range 函数，但是当你选择文本时，你怎么知道你在哪个页面上呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T23:30:25.377

粗略地说，你没有。Word 没有可靠的页面概念...例如，请参见[http://daiya.mvps.org/wordpages.htm 。](http://daiya.mvps.org/wordpages.htm)

您可以尝试以下方法：

```
docMyDocument.Bookmarks("\Page").Range 
```

这*主要是*有效的，但不能保证。（例如，如果有表格跨越页面末尾，则会失败......）

另请参阅[http://support.microsoft.com/kb/212555](http://support.microsoft.com/kb/212555)

# c# - C# 通用列表

> ID：562986
> 
> 赞同：3
> 
> 时间：2009-02-18T21:49:57.987
> 
> 标签：c#, generics

我有一个类映射到数据库中的一个字段。该类只关心字段的名称及其相关的 .NET 类型。 **类型可以是字符串、整数、日期时间等。**

```
class Foo()
{
    string Name { get; set; }
    Type FooType { get; set; }
} 
```

我有另一个从 Foo 继承的类，它为一个值添加了一个属性。现在我将值存储为一个对象，并使用 switch 语句根据基类 FooType 将值装箱。

```
class FooWithStuff() : Foo
{
    object Value { get; set; }   
} 
```

有没有办法用泛型来实现这一点，为值提供类型安全？

**编辑：**我已将关键要求加粗。当声明一个列表说 Foo 它需要一个类型。如果我针对自定义类执行此操作，我将创建和接口并使用它。但是这里我使用的是 int、string、DateTime 等。Int 是一个结构，string 是一个对象，所以 Foo< object> 对两者都不起作用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-18T21:57:03.883

```
class Foo
{
    public string Name { get; set; }
    public Type Type { get; set; }
}

class Bar<T> : Foo
{
    public T Value { get; set; }

    public Bar()
    {
        base.Type = typeof( T );
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-18T21:59:35.420

像这样定义你的类：

```
class Foo<T> : IFoo
{

    public Foo(string name)
    {
        Name = name;
    }

    string Name { get; set; }
    T Value {get; set;}
    Type FooType { get { return typeof(T); } }
} 
```

然后，您可以将接口 IFoo 定义为：

```
string Name { get; set; }
Type FooType { get; set; } 
```

并将列表声明为：

```
List<IFoo> list = new List<IFoo>(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T21:54:14.390

如果您想为 Foo 添加 Value 并使 Foo 是通用的，您可以这样做...

```
class Foo<T>
{
    T Value {get; set;}
}

Foo<int> myFoo = new Foo<int>();
myFoo.Value = 7; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T21:52:54.237

我会使用接口而不是通用类继承。

编辑：澄清。我会为 Foo 使用一个接口，为 FooWithStuff 使用一个泛型类：

```
public interface IFoo
{
  string Name{get;set;}
  Type FooType{get;set;}
}

public class FooWithStuff<T>:IFoo
{
   T Value {get;set;}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T21:57:27.627

是的，事实上你可以取消你的继承权，只是......

```
public class Foo<T>
{
  public string Name {get;set;}
  public T Value {get;set;}
  public Type FooType
  {
     get
     {
       return typeof(T);
     }
  }
} 
```

另请注意，使用 linq 您可以直接从列表中提取所需的类型，因此如果您出于某种原因只对字符串字段感兴趣，您可以...

```
List<object> list = getAllmyFoos();
foreach(Foo<string> sfoo in list.OfType<Foo<string>>())
{
  ...blah
} 
```

编辑：添加 FooType。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-02-18T22:04:39.763

我会推荐使用 2 个接口：

```
public interface IFoo
{
  string Name {get; }
  Type Type { get; }
  object Value {get; set;}
}

public interface IFoo<T> : IFoo
{
  T Value {get; set}
} 
```

然后实现它：

```
public class Foo<T> : IFoo<T>
{
   private T value;
   public Foo(string name, T value)
   {
     this.name = name;
     this.value = value;
   }

   public string Name { get { return name; } }
   public Type Type { get { return typeof(T); } }
   public T Value
   {
      get { return value; }
      set { value = value; }
   }

   object IFoo.Value
   {
      get { return value; }
      set { value = (T)value; }  // can check type before
   }
} 
```

这样，您也可以在非通用上下文中轻松使用 IFoo 接口。

# asp.net - ASP.net 中的历史管理问题

> ID：562987
> 
> 赞同：0
> 
> 时间：2009-02-18T21:50:01.310
> 
> 标签：asp.net, ajax, asp.net-ajax, updatepanel, scriptmanager

我创建了一个带有 UpdatePanel 的简单页面，其中我有几个 asp 面板控件，除了一个之外，所有的 Visible 属性都设置为 false。当用户单击侧边菜单上的某些按钮时，Visible 属性会在显示的面板之间切换，给用户一种酷炫的 ajax 感觉。

在 scriptManager 上，我将 EnableHistory 设置为 true。我添加了历史点来保存每次显示的面板。我添加了 OnNavigate 事件，该事件根据先前的历史记录点切换 Panel visible 的属性。

由于某种原因，这不起作用，我没有任何错误/异常......？！？当我尝试更改 Page.Title 属性时，例如在 OnNavigate 事件中，这可以完美地工作，但由于某种原因，更改其他控件的可见性不会......

有什么建议么 ？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T22:25:11.227

如果您只是更改面板的可见性而不是通过 AJAX 调用检索新数据（您没有指定），请删除 UpdatePanel，将面板控件替换为标准 DIV（不在服务器上运行）并使用 JavaScript 隐藏并显示 DIV。如果您在 AJAX 调用中检索数据，那么我们将不得不考虑其他事情；）

# apache-flex - 使用 httpservice 调用带参数的 PHP 函数

> ID：562988
> 
> 赞同：1
> 
> 时间：2009-02-18T21:50:34.633
> 
> 标签：apache-flex

如果你看下面的链接，有一些由 Flex mxml 通过 HttpService 调用的 PHP 代码。PHP 代码有函数，但 mxml 代码不调用特定函数。如何使用 httpservice 调用特定函数（在我的情况下，它需要参数）？

[http://livedocs.adobe.com/flex/3/html/help.html?content=data_access_2.html](http://livedocs.adobe.com/flex/3/html/help.html?content=data_access_2.html)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T22:17:44.147

我认为您可能正在寻找 RPC 而不是 HTTP 调用。您链接到的示例使用 HTTPService。看一下使用 PHP 的 RemoteObject。我怀疑您将不得不进入处理 AMF 的服务器上的某个层。 [这是一篇文章](http://www.adobe.com/devnet/flex/articles/remoteobject_sabreamf.html)。

# postgresql - 修改 postgresql "list" 聚合以删除重复项

> ID：562992
> 
> 赞同：1
> 
> 时间：2009-02-18T21:52:22.240
> 
> 标签：postgresql, aggregate, aggregate-functions

我最喜欢的 postgres 聚合之一是“列表”，根据我在网络上找到的少量证据，归因于“idocs 中的 Chris Rohlfs”。

```
CREATE FUNCTION comma_cat (text, text)
  RETURNS text AS
  'SELECT CASE
    WHEN $2 is null or $2 = '''' THEN $1
    WHEN $1 is null or $1 = '''' THEN $2
    ELSE $1 || '', '' || $2
  END'
LANGUAGE sql;

CREATE AGGREGATE list (BASETYPE = text, SFUNC = comma_cat, STYPE = text, INITCOND = ''); 
```

有时，我发现我希望它消除重复项。一个[旧的邮件列表线程](http://archives.postgresql.org/pgsql-sql/2003-02/msg00559.php)表明这种方法不能进行排序，这可能是重复删除的交易杀手。[同一线程中的另一篇文章](http://archives.postgresql.org/pgsql-sql/2003-02/msg00534.php)建议了一个做同样事情的函数；也许为此目的它更可修改？

与此同时，我只会用另一种语言来按摩输出。但是，如果我们可以直接在 postgres 中执行此操作，那就太酷了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T21:59:32.800

您可以使用中间数组：

```
CREATE OR REPLACE FUNCTION comma_cat(text[], text)
  RETURNS text[] AS
$BODY$
  SELECT
    CASE WHEN $1 @> ARRAY[$2] THEN $1
    ELSE $1 || $2
  END
$BODY$
  LANGUAGE 'sql' VOLATILE;

CREATE OR REPLACE FUNCTION comma_finish(text[])
  RETURNS text AS
$BODY$
    SELECT array_to_string($1, ', ')
$BODY$
  LANGUAGE 'sql' VOLATILE
  COST 100;

CREATE AGGREGATE list (BASETYPE = text, SFUNC = comma_cat, STYPE = text[], FINALFUNC = comma_finish, INITCOND = '{NULL, NULL}');

value    id
-------- --
"puer"   1
"socer"  2
"vesper" 3
"vesper" 4
"gener"  5
"asper"  6
"asper"  7
"miser"  8
"tener"  9
"liber"  10
"puer"   11

SELECT list(value)
FROM t_text

"puer, vesper, gener, asper, miser, tener, liber, socer" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-11-01T20:21:08.457

您可以在聚合函数调用中放置一个“不同的”限定符以删除重复项：

```
select list(distinct <column>)
from... 
```************************