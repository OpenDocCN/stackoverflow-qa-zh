# StackOverflow 问答 10143000-10143999

# java - 这个 Logback 模式有什么问题？

> ID：10143000
> 
> 赞同：12
> 
> 时间：2012-04-13T14:45:03.113
> 
> 标签：java, eclipse, logging, logback

我正在使用这种模式：

```
 <pattern>%d{HH:mm:ss.SSS} %-5level %logger{36} - (%file:%line) - %msg%n</pattern> 
```

然而输出看起来像：

09:42:25.811 警告 aaan.dao.api.ANApi - (ANApi.java:153

模式似乎在 %line 之后被截断（如果我使用 %L 也会发生这种情况） - 我做错了什么？

我需要这个特定的模式，以便 Eclipse 的控制台能够识别它。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-13T14:50:44.767

`(`并`)`具有特殊含义，如[logback](http://logback.qos.ch/manual/layouts.html)网站上所述：

> 在 PatternLayout 中，括号可用于对转换模式进行分组。因此，'(' 和 ')' 具有特殊含义，如果打算用作文字，则需要对其进行转义。括号的特殊性将在下面进一步解释。

在您的情况下，您需要[使用反斜杠转义它们](http://logback.qos.ch/manual/layouts.html#Parentheses)：

```
<pattern>%d{HH:mm:ss.SSS} %-5level %logger{36} - \(%file:%line\) - %msg%n</pattern> 
```

# ruby - Ruby - 如何获取当前用户的时间？

> ID：10143002
> 
> 赞同：2
> 
> 时间：2012-04-13T14:45:03.807
> 
> 标签：ruby, ruby-on-rails-3, time, timezone

我正在玩时区，我有一个简单的注册表单。用户注册后，我想显示他当前的时间，怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T14:56:14.610

你不能只用 Ruby 来做，因为这样的信息在服务器端是不可用的。

1）如果您知道用户的位置，您可以进行地理定位并[确定时区](https://stackoverflow.com/questions/4669366/timezone-from-geolocation)。但是，如果您从地理数据库获得的 IP 范围有几个时区，则可能会出现问题。

2）另一种解决方案，您可以使用javascript来帮助。因此，您可以使用 javascript 计算时区并将其设置为 cookie，然后从请求对象使用 Ruby 进行访问。（[如何使用 Javascript 获取时区](https://stackoverflow.com/questions/1194933/javascripts-date-gettimezoneoffset)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:00:29.117

您可以在注册期间向用户询问他们当前的时区，并将其与他们的用户详细信息一起保留。

ActiveSupport（包含在 Rails API 中）有一种很好的处理时区的方法，您可以使用 *in_time_zone* 将当前时间转换为不同时区中的时间。

举个例子

```
Time.now.in_time_zone("America/Guyana")
Time.now.in_time_zone(8) 
```

可以通过此 API 文档找到 time_zone 键：http: [//api.rubyonrails.org/classes/ActiveSupport/TimeZone.html](http://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html)

有关更多信息，请参见 TimeWithZone，[http:](http://api.rubyonrails.org/classes/ActiveSupport/TimeWithZone.html#method-i-in_time_zone) //api.rubyonrails.org/classes/ActiveSupport/TimeWithZone.html#method-i-in_time_zone 。

# sql-server-2008 - SQL Server：如何在字符串中进行数学计算？

> ID：10143006
> 
> 赞同：0
> 
> 时间：2012-04-13T14:45:10.357
> 
> 标签：sql-server-2008

我有一个应用程序允许在将输入数据写入表之前对其进行计算。

没有一个计算可以在 C# 中完成，所有的计算都必须在 T-SQL 中完成。

应用程序根据用户输入构建一个带有可能嵌套计算的插入语句。

一个样本是一个除以 10 然后转换为 的整数`varchar`。

```
 CAST(( ' ( CAST( 6828 AS BIGINT)) /10' ) AS NVARCHAR(MAX)) , 
```

这是基于用户界面输入构建的更大的 INSERT 语句的一部分。

我将如何首先`( CAST( 6828 AS BIGINT)) /10`执行内部部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T14:55:03.973

您可以使用`sp_executesql`来执行整个字符串。例如：

```
EXEC sp_executesql N'SELECT CAST( CAST( 6828 AS BIGINT)) /10 AS NVARCHAR(MAX))'; 
```

[在这里查看更多。](http://msdn.microsoft.com/en-us/library/ms175170.aspx)

# php - PHP：规范化字符串

> ID：10143007
> 
> 赞同：1
> 
> 时间：2012-04-13T14:45:12.590
> 
> 标签：php, string, normalize

我想将字符串规范化（因此规范化）为名称的正常形式：

1.  名字的第一个字母是大写的

这样做的困难现在是使用第二名和第三名遵循此规则。

我的方法：

```
 public function namilize($string)
{
    $strings = explode(' ', $string);
    foreach ($strings as $string) {
        $string = ucfirst(strtolower($string));
    }
    $string = implode(' ', $strings);

    return $string;
} 
```

不知何故

```
$string = ucfirst(strtolower($string)); 
```

失败。

我需要纠正什么？有没有更好的办法？

问候

编辑：

你好，

谢谢大家的所有评论和回答。我发现了另一种“现代”方法：

```
public function namilize($string)
{
    $string = mb_convert_case($string, MB_CASE_TITLE, mb_detect_encoding($string));
} 
```

当我现在还要为 Mc 和 O 添加一些正则表达式时，它会是完整的:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:04:47.190

```
public function namilize($name) {
    $name = strtolower($name);
    $normalized = array();

    foreach (preg_split('/([^a-z])/', $name, NULL, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY) as $word) {
        if (preg_match('/^(mc)(.*)$/', $word, $matches)) {
            $word = $matches[1] . ucfirst($matches[2]);
        }

        $normalized[] = ucfirst($word);
    }

    return implode('', $normalized);
} 
```

请注意，这适用于`John O'Brian`,`James McManus`等名称。对于其他带有前缀的名称`McManus`，只需将前缀添加到`preg_match()`. 显然，这存在误报的可能性，但没有任何方法是 100% 万无一失的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:04:54.327

foreach 中的 $string 将仅存储最后一次迭代（或姓氏）。不过这并不重要，因为 foreach 中的变量从不用于输出。内爆只是撤消了您对爆炸所做的操作，因此您最终将得到与输入完全相同的输出。在此示例中，我将变量名称更改为更具描述性：

```
function namilize($name_in)
{
    $a_names = explode(' ', $name_in); //explode string into array
    foreach ($a_names as $name) {
        $a_fullname[] = ucfirst(strtolower($name)); //build array of proper case names
    }    
    $string = implode(' ', $a_fullname); //convert array into string
    return $string;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T14:47:37.780

您必须通过引用传递 $string，请注意`&`：

```
 public function namilize($string)
{
    $strings = explode(' ', $string);
    foreach ($strings as &$string) {
        $string = ucfirst(strtolower($string));
    }
    $string = implode(' ', $strings);

    return $string;
} 
```

或者使用[@thetaiko建议的功能](https://stackoverflow.com/users/234695/thetaiko) `ucwords($string)`

# .net - XDocument 读取 MetaBase.xml

> ID：10143009
> 
> 赞同：0
> 
> 时间：2012-04-13T14:45:14.413
> 
> 标签：.net, vb.net, linq, linq-to-xml, vb.net-2010

出于某种原因，我今天早上有一个巨大的大脑放屁。

我无法从下面的代码中得到任何东西......它总是弹出 0，并且永远不会填充 _Qry，即使 _MBXml 已正确填充（在调试期间悬停显示它）

```
_MetaBasePath += "IIS6-MetaBase.xml" '"metabase.xml"
_MBXml = XDocument.Load(_MetaBasePath, LoadOptions.PreserveWhitespace)
_Qry = (From n In _MBXml.<IIsWebServer>
       Select New Typing.MetaBase() With {
           .Binding = Common.IsNull(Of String)(n.@ServerBindings, String.Empty)
       }).ToList()
MsgBox(_Qry.Count) 
```

这是 IIS 6 metaBase.xml 文件的示例...

```
<?xml version ="1.0"?>
<configuration xmlns="urn:microsoft-catalog:XML_Metabase_V64_0">
<IIsWebServer   Location ="/LM/W3SVC/1174460368"
    AuthFlags="0"
    SSLCertHash="8251cc2a9671150ac107aee3d78006b032f9bc36"
    SSLStoreName="MY"
    SecureBindings="184.106.185.111:443:"
    ServerAutoStart="TRUE"
    ServerBindings="184.106.185.111:80:beta.turbokits.com"
    ServerComment="TurboKits Beta"
>
</IIsWebServer>
</configurarion> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:29:02.140

如果 metabase.xml 有一个默认的命名空间声明（即`xmlns="http://example.com/"`），那么请确保您的 VB 代码有

```
Imports <xmlns="http://example.com"> 
```

在进口部分。当然，您需要确保适应`http://example.com/`XML 文档中使用的实际 URL。

如果您仍有问题，请向我们展示 XML 示例。

# .net - 使用 .NET 在 sql server 2008 数据库中保存文档

> ID：10143013
> 
> 赞同：-1
> 
> 时间：2012-04-13T14:45:40.267
> 
> 标签：.net, xml, vb.net, sql-server-2008, crystal-reports

大家好，我在 .NET 解决方案中工作，该解决方案`Visual Basic`使用适用于 .NET 的 Crystal Reports 生成数据库报告，我想在数据库中以 xml 或 PDF 格式生成每个报告后存储它，告诉我如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:06:36.743

SQL Server 具有 XML 数据类型，因此您可能希望将这些内容存储在定义为 XML 的列中。

通常不建议将 BLOB（例如 PDF）存储在数据库中，除非您有非常令人信服的理由这样做。在您的情况下，我会坚持使用 XML。

**更新**

您可以在 vb.net 中将 XML 作为字符串使用，或者更好的是作为[XML Literal](http://msdn.microsoft.com/en-us/library/bb384629.aspx)使用。您可以使用 ToString() 方法将其发送到数据库，SQL Server 将简单地重新解析并存储它，如下所示：

```
mySqlCommandObject.Parameters.AddWithValue("@mySqlParam", myXmlLiteral.ToString()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-05T01:13:05.647

Crystal Reports 具有内置的“另存为”或“导出”功能。

# sql - 如何编写用于在 Access 中连接 2 个字段的 sql 语句？

> ID：10143015
> 
> 赞同：-1
> 
> 时间：2012-04-13T14:45:50.093
> 
> 标签：sql, ms-access

样本：

```
ID firstname lastname
1  jerry     cai 
```

我得到一个字符串“jerrycai”，我需要从这两个字段中选择一次并将它们组合起来，然后与“jerrycai”进行比较。

只是猜测以下可能有效：

```
 select * from user where firstname+lastname='jerrycai' 
```

有没有在 SQL 中实现这个的方法？数据库：访问

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:02:06.447

当你可以这样做时为什么要连接：

```
select * 
  from user 
 where firstname = 'jerry'
       AND lastname = 'cai'; 
```

* * *

但如果你必须：

```
select * 
  from user 
 where firstname & lastname = 'jerrycai'; 
```

# python - 插入多个条目后获取主键列表

> ID：10143022
> 
> 赞同：1
> 
> 时间：2012-04-13T14:46:08.750
> 
> 标签：python, mysql

我正在使用 python 模块 MySQLDb 一次插入多个条目（有时最多 300 个）。我的 sql 看起来像...

```
INSERT INTO MyTable (row2,row3) values 
(row2_entry1,row3_entry1),(row2_entry2,row3_entry2),........(row2_entry300,row3_entry300) 
```

此表的主键是自动递增的。我想要的是输入到表中的条目的主键列表。我如何用批次做到这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T16:41:00.880

MySQL`LAST_INSERT_ID()`只返回一个值。在批量插入的情况下，它将返回第一个插入行的主键值。

您可以使用 GUID 令牌来跟踪作为批量插入操作一部分的行。`varchar(32)`为您的表添加一个名为的额外列`batch_insert_id`。在进行批量插入时，使用已知的 GUID 值。插入后，执行选择查询以获取插入行的主键。

```
import uuid

batch_insert_id = uuid.uuid4().hex
# Execute your batch insert query, with batch_insert_id 
# as value of batch_insert_id for all rows
cursor.execute("SELECT id FROM mytable WHERE batch_insert_id = '%s'", (batch_insert_id,))
primary_keys = [row[0] for row in cursor.fetchall()] 
```

# java - 使用正则表达式查找匹配项（Java 引擎）

> ID：10143028
> 
> 赞同：1
> 
> 时间：2012-04-13T14:46:24.687
> 
> 标签：java, regex

我想使用一些正则表达式来查找事件。例如，用户将输入：

**word1 代码1 -10001**！**没有任何**

这意味着：搜索 word1 AND code1 AND -10001 AND NOT none

这些标准用于构建正则表达式。

我有这样的文本行：

1 - “我通常的 word12 包括 GCode10 -10001。记录结束” // 这应该为真并返回“world12 包括 GCode10 -10001。”

2 - “这是另一行 word12 包括 GCode10 -10001 none End of record” // 这应该是 false 并且不返回任何内容

我试过这个：

```
^(?=.*?word1)(?=.*?code1)(?=.*?-10001)((?!none).)*$ 
```

它适用于第 1 行，但它返回所有行

我也试过这个：

```
(\\w*word1\\w*).*(\\w*code1\\w*).*(\\w*-10001\\w*)(?!none) 
```

但它只给了我“word12”，“GCode10”，但它错过了“-10001”，而且它与第二行匹配！它不应该。

我不是正则表达式的专家...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:10:29.793

你快到了，你只是错误地使用了负前瞻：

```
^(?=.*?word1)(?=.*?code1)(?=.*?-10001)(?!.*?none).*$ 
```

您还应该使用 multiline 选项编译正则表达式，除非您将每一行视为单独的字符串。所以，如果`subjectString`是多行字符串，

```
List<String> matchList = new ArrayList<String>();
Pattern regex = Pattern.compile("^(?=.*?word1)(?=.*?code1)(?=.*?-10001)(?!.*?none).*$", Pattern.MULTILINE);
Matcher regexMatcher = regex.matcher(subjectString);
while (regexMatcher.find()) {
    matchList.add(regexMatcher.group());
} 
```

将为您提供满足您条件的所有行的列表。

如果您正在处理用户输入，您可能希望调用`Pattern.quote()`用户给您的所有字符串，因此任何正则表达式元字符都将被转义。

# ruby - RSpec - 测试实际文件，而不是模拟数据

> ID：10143029
> 
> 赞同：4
> 
> 时间：2012-04-13T14:46:27.017
> 
> 标签：ruby, testing, rspec, test-data

我对 RSpec 很陌生，所以这是一个非常基本的问题。我正在编写一些东西，它解析文件中的大量数据，进行一些处理并返回一个汇总结果，这对 Ruby 来说非常可爱。

我想围绕此代码进行一些 RSpec 测试，但我不想在测试中模拟数据。这些文件又大又复杂，因为我希望代码可以处理这些文件，所以我想直接在测试中处理一些文件。

我已经做了很多谷歌搜索，但我找不到任何针对这种情况的最佳实践示例——我发现的所有内容似乎都建议使用模拟数据。

因此，需要明确的是，我想知道针对实际测试数据文件运行 RSpec 测试的最佳实践，而不是针对在测试代码中模拟的东西本身。我非常高兴打开文件，阅读它们等，这不是问题。我真正感兴趣的是如何最好地构建我的测试和测试数据目录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T16:31:33.753

我过去所做的是在 specs 文件夹中创建一个数据文件夹来保存我想要读取的文件。

我理解您想要使用实际文件的动机，因为在实际文件中通常存在您自己可能不会想到的各种小边缘情况。我的建议是进行一个打开文件并测试所需信息的测试。但是，如果该测试失败，请创建一个新测试来解决您找到的文件中的特定问题。

例如，假设在尝试打开文件时，您发现它不能正确处理非 UTF8 数据。使用有问题的行作为使用的数据创建一个新测试（而不是简单地将其作为更大测试的一部分）。这样，如果它再次失败，您将能够准确指出痛点在哪里。

# java - 使用 MVC 的二十一点 Java

> ID：10143030
> 
> 赞同：0
> 
> 时间：2012-04-13T14:46:31.790
> 
> 标签：java, model-view-controller, blackjack

我正在用 Java 创建一个 BlackJack 游戏，并在创建它时尝试使用 MVC 设计。到目前为止，我已经创建了以下类： - Card：保存创建一张牌 - Deck：创建一个装满所有 52 张牌的牌组 - Hand：持有一张牌的“手” - Player：创建一个供游戏使用的 Player - BlackJackTest：在这里我正在测试游戏的所有功能，试图让某些东西正常工作！

我目前已经到了可以展示所有 52 张牌的程度，并且还可以将 2 张牌发给一手牌并展示这手牌。但是我在接下来的步骤中遇到了很多麻烦。理想情况下，在“BlackJackTest”类中​​，我希望将其用作游戏引擎，在其中输入 X 数量的玩家及其姓名，它会创建玩家，并循环通过系统来玩游戏。

我的问题是我完全坚持下一步应该做什么，或者我做错了什么。我的下一个任务应该是实现一个功能，以便我可以让最多 3 名人类玩家对抗庄家，但我不确定如何做到这一点……我还应该实现我不确定的击中/站立功能我应该在哪里或如何编码这些。

任何帮助表示赞赏！

这是我的代码：

```
import java.util.Scanner;

public class BlackJackTest {

    public static void main(String[] args) {

        /*System.out.println(deck.getCard(0).toString());
        System.out.println(deck.getCard(0).getSuit());
        System.out.println(deck.getCard(0).getSuitCode());
        System.out.println(deck.getCard(0).getValue());
        System.out.println(deck.getCard(0).getValueCode());
        System.out.println();
        System.out.println(deck.cardsLeft());
        hand.addCard( deck.dealCard() );
        hand.addCard( deck.dealCard() );
        hand.showHand();
        System.out.println(deck.cardsLeft());
        System.out.println(hand.getHandSize());
        System.out.println(hand.getCard(0));
        System.out.println(hand.getCard(1));
        System.out.println(hand.getBlackJackValue());
        System.out.println();
        */

        Deck deck = new Deck();

        Hand p1hand = new Hand();
        Player player = new Player();

        Scanner sc = new Scanner(System.in);
        System.out.println("Enter your name: ");
        player.setName(sc.nextLine());

        System.out.println("Welcome " + player.getName() + "!");

        player.setHand(p1hand);

        p1hand.addCard( deck.dealCard() );
        p1hand.addCard( deck.dealCard() );

        System.out.println(player.getName() + ": ");
        p1hand.showHand();
        System.out.println("Score: " + p1hand.getBlackJackValue());
        System.out.println();
    }
} 
```

* * *

```
public class Card {

    public enum Value {
        TWO(2),
        THREE(3),
        FOUR(4),
        FIVE(5),
        SIX(6),
        SEVEN(7),
        EIGHT(8),
        NINE(9),
        TEN(10),
        JACK(10),
        QUEEN(10),
        KING(10),
        ACE(1);

        public final int value;

        Value(int c) {
            value = c;
        }
    }

    public enum Suit {
        CLUBS('C'),
        SPADES('S'),
        DIAMONDS('D'),
        HEARTS('H');

        public final char symbol;

        Suit(char c) {
            symbol = c;
        }
    }

    private Suit suit;
    private Value value;

    public Card(Suit suit, Value value) {
        this.suit = suit;
        this.value = value;
    }

    public Suit getSuit() {
        return suit;
    }

    public Value getValue() {
        return value;
    }

    public char getSuitCode() {
        return suit.symbol;
    }

    public int getValueCode() {
        return value.value;
    }

    public String toString() {
        return value + " of " + suit;
    }
} 
```

* * *

```
import java.util.Collections;
import java.util.LinkedList;
import java.util.List;

public class Deck {

    private List<Card> deck = new LinkedList<Card>();

    public Deck() {
        for(Card.Suit suit : Card.Suit.values()) {
            for(Card.Value value : Card.Value.values()) {
                deck.add(new Card(suit,value));
            }
        }
        shuffle();
    }

    public void shuffle() {
        Collections.shuffle(deck);
    }

    public int cardsLeft() {
          // As cards are dealt from the deck, the number of cards left
          // decreases.  This function returns the number of cards that
          // are still left in the deck.
        return deck.size();
    }

    public Card dealCard() {
          // Deals one card from the deck and returns it.
        if (deck.size() == 52) {
           shuffle();
        }
        Card temp;
        temp = deck.get(0);
        remove(0);
        return temp;
    }

    public Card getCard(int i) {
        return deck.get(i);
    }

    public Card remove(int i) {
        Card c = deck.get(i);
        deck.remove(i);
        return c;
    }   

} 
```

* * *

```
import java.util.Vector;

public class Hand {
    private Vector<Card> hand;

    public Hand() {
      hand = new Vector<Card>();
    }

    public void addCard(Card c) {
        if (c != null)
            hand.addElement(c);
    }

    public void showHand() {
        for(int i = 0; i < hand.size(); i++){
            System.out.println(hand.elementAt(i));
        }
    }

    public int getHandSize() {
        return hand.size();
    }

    public Card getCard(int position) {
        if(position >= 0 && position < hand.size())
            return (Card)hand.elementAt(position);
        else
            return null;
    }

    public int getBlackJackValue() {
        int val = 0;
        boolean ace = false;

        for(int i = 0; i < hand.size(); i++) {
            Card card;
            card = getCard(i);
            val += card.getValueCode();

            if(card.getValueCode() == 1) {
                ace = true;
            }
        }

        if(ace == true && val + 10 <= 21) {
            val += 10;
        }

        return val;
    }
} 
```

* * *

```
public class Player {
    private String name;
    private Hand hand;

    public Player() {
        this.hand = null;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }

    public void setHand(Hand h) {
        this.hand = h;
    }

    public void getHand(){
        hand.showHand();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-31T05:58:58.677

您的模型类有一个良好的开端，我将开始处理项目的视图和控制器部分。虽然您当然可以修改 main() 以合并多个玩家（只需实例化多个玩家对象，将它们存储在列表中，然后循环发牌），但如果/当您决定移动时，您将不得不丢弃很多它到非控制台视图和控制器。

您的控制器设计将与您如何接收和响应用户输入（即击中/站立）有很大关系。它的工作是将来自视图（当前通过console.in）的输入中继到模型。因此，您的视图将显示一个提示，询问用户他们想要做什么，阅读他们的响应，并通知控制器。控制器会将此输入映射到模型类中的适当对象/方法。

希望这会有所帮助！

史蒂夫

# matlab - 在matlab中逐行读取文本文件并计数

> ID：10143032
> 
> 赞同：2
> 
> 时间：2012-04-13T14:46:33.630
> 
> 标签：matlab, file-io

我有一个这样的文本文件：

```
v -0.874157 -0.291386 0.388514
v -0.854358 -0.0854358 -0.512615
v 0.57735 0.57735 -0.57735
v -0.646997 -0.539164 -0.539164
v -0.688247 -0.229416 -0.688247
v 0.105409 0.527046 -0.843274
v -0.442326 0.884652 0.147442
v -0.574696 -0.766261 0.287348
v 0.163846 -0.655386 -0.737309
v 0.536656 0.715542 0.447214
f 4 1 2
f 4 2 5 
f 9 4 5
f 1 4 8 
f 4 9 8 
f 10 1 8 
f 9 10 8 
f 10 9 3 
f 3 9 6 
f 5 2 6 
f 9 5 6 
f 1 10 7 
f 2 1 7 
f 3 6 7 
f 10 3 7 
f 6 2 7 
```

我想在 matlab 中导入这个文本文件，然后我的输出说 f 和 v 的数量，例如对于这个文件，我有 v=10 和 f=16 的数量，我试图写但我不能。我知道这很简单。

这是我的错误代码：

```
function [vnum, fnum]=read(varargin)
filename=varargin{1};
fid=fopen(filename, 'rt'); 
% this is error message for reading the file
if fid == -1 
    error('File could not be opened, check name or path.')
end
%
 tline = fgetl(fid);
while ischar(tline) 
   % reads a line of data from file.
  vnum = sscanf(tline, 'v %f %f %f');
  fnum=sscanf(tline, 'f %d %d %d');
  tline = fgetl(fid);
end
  vertex=length(strfind(vnum,'v'));
   face=length(strfind(fnum,'f'));
fclose(fid); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:02:58.717

基本上发生的事情是您的 vnum 和 fnum 值没有被保存。您需要将它们存储在某种数组中，如下所示。

```
function [vnum, fnum]=read(varargin)
filename=varargin{1};
fid=fopen(filename, 'rt'); 
% this is error message for reading the file
if fid == -1 
    error('File could not be opened, check name or path.')
end
%
 tline = fgetl(fid);

MAX_NUM_VALUES=100;
vnum=zeros(MAX_NUM_VALUES,3);
fnum=zeros(MAX_NUM_VALUES,3);
vnum_index=0;
fnum_index=0;

while ischar(tline) 
   % reads a line of data from file.
  if tline[1]=='v'
    vnum_index=vnum_index+1;
    vnum(vnum_index,:) = sscanf(tline, 'v %f %f %f');
  elseif tline[1]=='f'
    fnum_index=fnum_index+1;
    fnum(fnum_index,:)=sscanf(tline, 'f %d %d %d');
  end
  tline = fgetl(fid);
end
vnum=vnum(1:vnum_index);
fnum=fnum(1:fnum_index);
fclose(fid); 
```

# asp.net - Uses of the ASP Parameter objects

> ID：10143033
> 
> 赞同：0
> 
> 时间：2012-04-13T14:46:38.673
> 
> 标签：asp.net

Everyone,

I've been brushing up on some seldom used controls (at least for me) and I ran across the Parameter controls (ControlParameter, CookieParameter, etc.)

It seems they are mostly used with the SQL Datasource control, or the Object Datasource control.

But, is there any other uses that they can be put too? Or, are they fairly useless unless you are using the two Datasource controls?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T17:01:01.290

它只是为数据源控件构建的，但如果您想创建自己的自定义控件，当然可以将它们重用于自己的目的。它本质上是一个类，所以这是可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:49:56.513

它仅与一种或另一种数据源一起使用。

从[文档](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.controlparameter.aspx)中：

> **评论**
> 
> 您可以使用 ControlParameter 类将 Control 属性的值（例如 SelectedValue 或 SelectedIndex）绑定到参数化 SQL 查询、业务对象方法或过滤表达式中使用的参数。

# eclipse - make file project with existing code is missing optimization option in eclipse cdt

> ID：10143034
> 
> 赞同：4
> 
> 时间：2012-04-13T14:46:38.967
> 
> 标签：eclipse, eclipse-cdt

When I choose `new --> make file project` with existing code, in the project properties, I don't see code optimization. But if I create a new C++ project, the code optimization option appears. What should I do to enable code optimization when I choose `new --> make file project` with existing code?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T18:25:11.220

在未按您想要的方式运行的项目下，转到项目属性对话框并查看 `C/C++ BUild->Tool Chain Editor`. 通常，我发现 和 的选择`Current toochain:`会`Current builder:`影响其他区域中显示的选项和选项卡。应用正确的工具链后，您的优化设置应该会出现。

# opengl - 视锥内的坐标

> ID：10143039
> 
> 赞同：0
> 
> 时间：2012-04-13T14:46:55.707
> 
> 标签：opengl

有没有一种方法可以定义或获取在 gluPerspective 方法创建的视锥体中可见的坐标？我的四边形不会显示。这是初始化代码：

```
GL11.glMatrixMode(GL11.GL_PROJECTION);
GL11.glLoadIdentity();
GLU.gluPerspective(45, width/height, 1, 100);
GL11.glMatrixMode(GL11.GL_MODELVIEW);
GL11.glViewport(0, 0, 800, 600);
GL11.glClearColor(1, 1, 1, 1); 
```

这是渲染代码：

```
GL11.glLoadIdentity();
GL11.glClear(GL11.GL_COLOR_BUFFER_BIT);
GL11.glColor3f(0, 0, 0);

GL11.glBegin(GL11.GL_QUADS);

GL11.glVertex3f(1, 1, 5);
GL11.glVertex3f(10, 1, 5);
GL11.glVertex3f(10, 10, 5);
GL11.glVertex3f(1, 10, 5);

GL11.glEnd(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T16:11:37.790

> 这是初始化代码：

这不是初始化代码，这是状态设置。它属于渲染代码。在设置投影矩阵之前放置 glViewport、glClearColor 和 glClearDepth 是惯用的（尽管不是必需的）。

您的四边形可能没有出现，因为它超出了观看范围。在近平面，gluPerspective 的极限是

```
aspect = width/height
fov_ = atan2(fov)
right = near * aspect * fov_
left = -right
top = near * fov_
bottom = -top 
```

# mysql - Rolling back transactions

> ID：10143041
> 
> 赞同：1
> 
> 时间：2012-04-13T14:47:04.347
> 
> 标签：mysql

Relations: Model is the primary key for each table

```
Product( maker, model, type )
PC( model, speed, ram, hd, price)
Laptop( model, speed, ram, hd, screen, price)
Printer( model, color, type, price) 
```

My first question is how I properly start and rollback a transaction. what I have been doing is

```
START TRANSACTION; 
--- my sql says ok
--- do my queries (8 rows affected)
ROLLBACK
--- Mysql says ok but 0 rows affected. 
```

I cannot seem to get any of my changes to rollback after a transaction is started. Once I can figure this out I can start on my next few problems. I am having trouble with this one specifically

*   Insert the facts that for every pc there is a laptop with the same manufacturer, speed, ram, and hard disk, a 17 inch screen, a model number 1100 greater, and a price 500 more than the original pc.

**All the model numbers for pc's are from 1000 to 1013, so to make all the model numbers 1100 or above we can just add 100 to the pc's model number**

I need to insert into the products relation the new models, maker, and type for the new laptops also I need to insert the new laptops into the laptop relation. I know I will have a subquery within it near this

```
(SELECT * FROM pc) 
```

So I am taking the pc relation, adding a screen column where everything is set to 17, I then am adding this whole relation to the laptop relation. I also need to add the fact that that each manufacturer or pc's now make a latptop for every model of pc they make.

This is very confusing to me I am not sure how to work through it.

Any help is appriciated.

# sql - Oracle consolidate 2 rows into column

> ID：10143043
> 
> 赞同：1
> 
> 时间：2012-04-13T14:47:08.157
> 
> 标签：sql, oracle

Need help to display 2 rows as consolidated column
Made this image to illustrate the problem Thank you for your help ![enter image description here](../Images/4f81d2c2c680d449dd9cc960805a1796.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T16:15:05.207

如果您只需要 2 个城市，那么使用分析函数可能很简单：

```
select distinct studentname
     , min(city) over ( partition by studentname ) as city1
     , min(street1) over ( partition by studentname ) as street1
     , case when min(city) over ( partition by studentname ) 
                  <> nvl( max(city) over ( partition by studentname ), 'x')
              then max(city) over ( partition by studentname ) end as city2
     , case when min(street) over ( partition by studentname ) 
                  <> nvl( max(street) over ( partition by studentname ), 'x')
              then max(street) over ( partition by studentname ) end as street2
  from my_table 
```

尽管我必须补充一点，您可能不应该这样做。如果学生有 3 个地址会怎样？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T14:53:25.453

我认为您对此的思考方式不正确。

您应该为“Ted”返回 2 行并使用您的视图/报告代码操作输出。这会容易得多，并且如果您的要求发生变化，您可以非常快速地更改视图/报告。

# html - td 标签内的表格延伸 td 标签

> ID：10143058
> 
> 赞同：0
> 
> 时间：2012-04-13T14:47:55.083
> 
> 标签：html, css

我有一个表格，有 4 列，每列都有指定的百分比宽度。例如。td width="25%" 和宽度为 100% 的表格。现在，当列内没有其他表时，宽度可以完美地工作，只要我在具有特定宽度的 td 标记内添加下表，它就会自动增加百分比。

```
<td width="25%">
<table cellspacing="0" cellpadding="3" border="1">
<tbody>
<tr>
<td style="text-align: center;">text</td>
<td style="text-align: center;">text</td>
<td style="text-align: center;">text</td>
<td style="text-align: center;">text</td>
<td style="text-align: center;">text</td>
</tr>
<tr>
<tr>
<tr>
</tbody>
</table>
</td> 
```

然后我尝试将上面的表格添加到一个 div 标签中，它对列的拉伸问题进行了排序，但溢出了包含该表格的 div 标签

```
<div style="max-width: 100px !important; ">
<table cellspacing="0" cellpadding="3" border="1">
<tbody>
<tr>
<td style="text-align: center;">text</td>
<td style="text-align: center;">text</td>
<td style="text-align: center;">text</td>
<td style="text-align: center;">text</td>
<td style="text-align: center;">text</td>
</tr>
<tr>
<tr>
<tr>
</tbody>
</table>
</div> 
```

有没有什么办法可以让td标签内的表格宽度指定widht自动继承宽度不控制？我还尝试在列内指定表格的宽度，但这也不起作用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T14:53:52.490

边框和内边距会导致元素比它们看起来要大。例如，由于边框的像素宽度，`width: 100%; border-width: 1px`div 内部的表格`width: 100px`实际上会尝试适合内部。`102px`

有关这方面的更多信息，请参阅[IE 框模型错误](http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:58:41.567

不是因为你有未封闭的标签吗？

```
 <td width="25%">
<table cellspacing="0" cellpadding="3" border="1">
    <tbody>
        <tr>
            <td style="text-align: center;">text</td>
            <td style="text-align: center;">text</td>
            <td style="text-align: center;">text</td>
            <td style="text-align: center;">text</td>
            <td style="text-align: center;">text</td>
        </tr>
        <tr>
             <tr>
                    <tr>
</tbody>
</table>
</td> 
```

应该

```
<td width="25%">
<table cellspacing="0" cellpadding="3" border="1">
<tbody>
<tr>
<td style="text-align: center;">text</td>
<td style="text-align: center;">text</td>
<td style="text-align: center;">text</td>
<td style="text-align: center;">text</td>
<td style="text-align: center;">text</td>
</tr>
<tr>
    <td colspan="5">&nbsp;</td>
</tr>

</tbody>
</table>
</td> 
```

# php - 面向对象的页面渲染

> ID：10143061
> 
> 赞同：1
> 
> 时间：2012-04-13T14:48:11.290
> 
> 标签：php, oop, templates

我正在尝试将面向对象的方法应用于我的网站。

我有以下对象：

1.  错误：处理所有错误，杀死致命错误的应用程序
2.  数据库：处理数据库连接、查询等
3.  cookie：创建和读取cookies
4.  session：设置和获取会话变量，几乎处理会话
5.  用户：处理我所有的用户信息（他连接了吗？他的 ip 已知吗？他的 id 是什么？等等）
6.  page：知道上面的所有对象，并根据 get 变量决定必须向用户显示的内容

通常，每个对象都传递它上面的对象。

我想要做的是有一个 page->render() 函数来渲染整个页面。

我有一个标题数组、一个页脚数组、一个元标记数组和一个脚本数组，渲染函数依次包含这些数组。该函数看起来像这样：

```
public function render(){
// to simplify im excluding meta tag and script arrays
    foreach($this->headers as $header){
        include $header;
        }

    //page sontents here

    foreach($this->footers as $footer){
        include $footer;
        } 
```

我的问题是我应该如何渲染数据库数据，以便在调用渲染函数时而不是在包含视图时渲染它们？

例如，假设我有以下代码：

```
$result = mysql_query("SELECT SOME ENTRIES FROM DB");
while($row = mysql_fetch_assoc){
    include "views/show_the_entry.php";
    } 
```

当调用 page->render() 函数时，我能做些什么来渲染它们？

我是不是把整个事情都想错了？如果是这样，有人可以提供有关此类 OO 实现理念的链接或一些信息吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:18:41.667

我见过的最常见的处理视图的方法是将视图创建为它自己的类。因此，您将从一个通用视图类开始，并使用您的模板名称对其进行实例化。

```
$view = new View('show_the_entry'); 
```

从那里，您可以设置查询中的所有相关数据。

```
while($row = mysql_fetch_assoc($rs)){
    $view->set('row', $row);
    echo $view->render();
} 
```

这种方法有几个优点：

*   您的视图是可以测试的离散单元。（虽然，我想，你也可以“测试”一个包含，它只是多一点......牛仔。）
*   视图所依赖的数据必须显式传递到视图中。Using`include`意味着包含的视图可以访问调用脚本中的所有变量。使用`View`类将范围隔离到您传入的内容。
*   该类`View`在内部仍然可以简单地包含文件`::render`（这是我见过的最常见的实现）。但是，通过强制视图只使用它所需要的，并明确地将数据传递给它，您可以获得代码隔离、可重用性和可测试性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T22:34:07.837

首先，我不知道你在哪里学会使用 mysql 和 php，但那个网站很旧。真的老了。您不应该使用古老的`mysql_*`函数编写任何新代码。它们不再被维护，PHP 社区已经[开始](http://news.php.net/php.internals/53799)弃用它们。相反，您应该将[PDO](http://php.net/pdo) pr [MySQLi](http://php.net/mysqli)与准备好的语句一起使用。新的 API 实际上是面向对象的，这意味着您的“数据库类”也有点过时了。

要学习 PDO，你可以[去这里](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers).. 至于 MySQLi：我不知道。

也就是说，我真的怀疑您是否应该针对这种情况制定一个成熟的 MVC 架构。你应该远离框架。

您真正需要的是实现[一种简单的模板化方法](http://codeangel.org/articles/simple-php-template-engine.html)并废除 Java 样式*On-class-to-contain-them-all* .. 或者您称之为：`Page`.

而是使用一个简单的脚本 .. 像这样：

```
$connection = new PDO('mysql:...');

$user = new User( $connection );
if ( $user->hasLoggedOn() )
{
    $template = new Template('overview');
    $collection = new Entities( $connection );
    $template->bind( 'list', $collection->getSome() );
}
else
{
    $template = new Template('error-page');
}

echo $template->render(); 
```

不，这不能称为 MVC 或任何类似 MVC 的东西，因为*View*不应该是一个模板，而是一个类的实例，它处理表示逻辑并处理多个模板。在该架构模式的 Model2 MVC（也称为 Web MVC）版本的情况下，*视图*实例从模型层中的*域对象*请求信息。

但正如我已经提到的，在这种情况下实现 MVC 将是矫枉过正。此外，在您开始深入研究 MVC 之前，您应该了解什么是[SOLID 原则](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)和[依赖注入](http://martinfowler.com/articles/injection.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T14:52:56.373

广泛用于此问题的普遍模式是[模型-视图-控制器](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)模式。
我认为这就是您正在寻找的东西，但我建议您使用已经解决了这些问题的框架。Symfony 2、Yui 和 Zend 都是很好的框架，你应该使用哪一个取决于你需要构建的站点

# php - Zend_Db_Select 查询与 UNION 和 IN 运算符

> ID：10143064
> 
> 赞同：1
> 
> 时间：2012-04-13T14:48:33.570
> 
> 标签：php, sql, zend-framework, zend-db, zend-db-table

如何使用 Zend_Db_Select 对象编写此查询？

```
SELECT
    `v1`.`id`,
    `v1`.`title`,
    `v1`.`duration`,
    `v1`.`img`
FROM 
    `videos` AS `v1` 
WHERE 
    v1.id IN (
        SELECT id_video FROM videos_categories WHERE id_video NOT IN(
            select id_video from videos_categories where id_category=34
            UNION
            select id_video from videos_categories where id_category=20
        )
    ) 
```

我尝试了类似的方法，但没有任何效果，我有一个错误页面。我使用数据映射器

```
$objQuery = $this->getDbTable()->select()
    ->from(array('v'=>'videos'),array('v.id','v.title','v.duration','v.img'))

$tableVC1 = new Application_Model_DbTable_VideosCategories(); 
$tableVC2 = new Application_Model_DbTable_VideosCategories();
$tableVC3 = new Application_Model_DbTable_VideosCategories();
$tableVC4 = new Application_Model_DbTable_VideosCategories();

// select id_video from videos_categories where id_category=20
$tableVC4->select()->from(array("vc"=>"videos_categories"),array("id_video"))
    ->where("vc.id_category=20");

// select id_video from videos_categories where id_category=34
$tableVC3->select()->from("videos_categories","id_video")
    ->where("id_category=34");

// union between previous queries
$tableVC2->select()->union(array($tableVC4,$tableVC3));

$tableVC1->select()->from("videos_categories","id_video")
    ->where("id_video NOT IN ?",$tableVC2);

$objQuery->where("v.id IN ?",$tableVC1); 
```

谢谢帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:23:48.953

我的猜测是，当它需要一个字符串时，您正试图将一个对象发送到您的联合。

试试这个：

```
$objQuery = $this->getDbTable()
                 ->select()
                 ->from(array('v' => 'videos'),
                        array('v.id', 'v.title', 'v.duration', 'v.img'))

$tableVC1 = new Application_Model_DbTable_VideosCategories(); 
$tableVC2 = new Application_Model_DbTable_VideosCategories();
$tableVC3 = new Application_Model_DbTable_VideosCategories();
$tableVC4 = new Application_Model_DbTable_VideosCategories();

// select id_video from videos_categories where id_category=20
$select4 = $tableVC4->select()
                    ->from(array("vc" => "videos_categories"),
                           array("id_video"))
                    ->where("vc.id_category=20");

// select id_video from videos_categories where id_category=34
$select3 = $tableVC3->select()
                    ->from("videos_categories", "id_video")
                    ->where("id_category=34");

// union between previous queries
$select2 = $tableVC2->select()
                    ->union(array($select4, $select3));

$select1 = $tableVC1->select()
                    ->from("videos_categories", "id_video")
                    ->where("id_video NOT IN ?", $select2);

$objQuery->where("v.id IN ?", $select1); 
```

`echo $objQuery;`应该输出预期的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:55:15.640

您必须在 ? 周围加上括号。=> (?) ...并且变量必须是一个选择对象。

例如在这一行：

```
$tableVC2 = $xyz->select()...

$tableVC1->select()->from("videos_categories","id_video")
        ->where("id_video NOT IN (?)",$tableVC2); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:04:30.980

尝试像这样构建您的 SELECT 语句，没有模型 - 它应该以这种方式工作：

```
$db = Zend_Db_Table::getDefaultAdapter();
$select = $db->select()
    ->from(
        // base table
    )
    ->joinLeft(
        // join sth
    )
    ->where('x = ?', $x)
    ->where('y = ?', $y)
    ->order('z DESC')
    ->limit(10, 0);
$q = $db->query($select);
$rowSet = $q->fetchAll(); 
```

# c# - Dynamics CRM 2011 - LINQ - 检索帐户和联系人之间的连接

> ID：10143067
> 
> 赞同：2
> 
> 时间：2012-04-13T14:48:40.640
> 
> 标签：c#, linq, .net-4.0, dynamics-crm, dynamics-crm-2011

我进行了很多搜索，但找不到一个示例来说明如何在 Dynamics CRM 2011中检索和`Connection`之间的信息。**有人能指出我正确的方向吗？**`Account``Contact`

 **仅供参考，这是我检索数据的常用方法（它不包括这个问题，我尝试过的任何东西都没有接近工作）

```
 var context = new XrmServiceContext(crmService);
        var accounts = context.AccountSet.Where(a => a.Name.StartsWith("A"));

        Console.WriteLine("Accounts beginning with the letter A");

        foreach (Account account in accounts)
        {
            Console.WriteLine("{0} ({1})", account.Id, account.Name);
        } 
```

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T15:05:56.713

编辑：更新答案以匹配要求。

连接的详细信息存储在连接实体集中。

```
var context = new XrmServiceContext(crmService);
var accounts = context.AccountSet.Where(a => a.Name.StartsWith("A"));

Console.WriteLine("Accounts beginning with the letter A");

foreach (Account account in accounts)
{
    Console.WriteLine("{0} ({1})", account.Id, account.Name);
    var accToConConnections = 
    context.ConnectionSet.Where(con => con.Record1Id.Id.Equals(account.Id) &&
                                       con.Record2ObjectTypeCode.Value.Equals((int)Contact.EntityTypeCode));

   //do something with the connections if you want!
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T16:26:26.933

回答了我自己的问题。MSDN 中隐藏了一个示例，Google 从其搜索结果中省略了该示例。[MSDN 示例](http://technet.microsoft.com/en-us/library/gg509054.aspx)**

# .htaccess - 在目录中停止 .htaccess mod_rewrite

> ID：10143068
> 
> 赞同：10
> 
> 时间：2012-04-13T14:48:42.193
> 
> 标签：.htaccess, mod-rewrite

我已将一些代码（用于 Wordpress 永久链接）复制到根目录中的 .htaccess 文件中。一切正常。这是代码：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

我现在创建了一个新目录，我想使用 .htaccess 对其进行密码保护。我已经设置好了（使用我要保护的目录中的 ht.access 文件）但是当我尝试浏览到受密码保护的目录时，我被重定向到主站点 index.php 页面。

我猜我需要在根目录中的 .htaccess 文件中添加一些东西？这是正确的，如果是这样，有人可以告诉我我需要添加的代码吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-14T00:41:03.767

将其放入受密码保护的子目录 .htaccess 文件中。

```
<IfModule mod_rewrite.c>

#Disable rewriting
RewriteEngine Off

</IfModule> 
```

# c# - DynamoDb 和 Azure 表抽象层可能存在的问题？

> ID：10143070
> 
> 赞同：1
> 
> 时间：2012-04-13T14:48:45.317
> 
> 标签：c#, nosql, azure-table-storage, amazon-dynamodb

[过去曾有](https://stackoverflow.com/q/3129387/106623)关于为 NoSQL 数据库创建抽象层的问题，但它们之间的差异如此之大，以至于如果不遗漏它们提供的大部分功能，就不可能真正做到这一点。

这最近随着亚马逊 DynamoDb 的推出而改变，它看起来几乎与微软的 Azure 表存储相同，所以我正在考虑制作一个开源抽象层。每个人都喜欢抽象，因为当我们试图说服我们的雇主接受这些“新技术”时，它给了我们更多的筹码。

据我所知

```
AzureTable.RowKey == DynamoDB.HashKey
AzureTable.PartitionKey == DynamoDB.RangeKey 
```

谁能看到创建这个抽象层可能会出现什么问题以及我可能会失去什么功能？

两者似乎都以相同的方式对数据进行分区，并且它们的查询看起来相似。

我注意到的第一件事是 Microsoft 的 c# SDK 要求您的类派生自，`TableServiceEntity`而 Amazon 的 c# 对象持久性框架使用和属性上的`HashKey`属性`RangeKey`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T09:59:37.887

在查看此处的比较：[比较 Windows Azure 表存储和 Amazon DynamoDB](http://gauravmantri.com/2012/04/30/comparing-windows-azure-table-storage-and-amazon-dynamodb/)时，我问自己你到底想抽象什么。
你需要问自己，然后展示你在创建类和约束时选择的权衡，以便社区对你想要实现的目标有一个很好的了解，并希望能帮助你完善它。
话虽如此，我会从头顶提出几个问题，您应该弄清楚：
1.您将如何强制对象大小的差异？(1MB / 64KB)
2\. 您将如何抽象 DynamoDB 的预置吞吐量？
3\. 你打算如何强制 Azure 表存储有 256 个属性限制？

祝你好运

# qt - 如何从按钮创建一个新窗口

> ID：10143072
> 
> 赞同：-1
> 
> 时间：2012-04-13T14:49:01.250
> 
> 标签：qt

有没有其他方法可以从另一个窗口创建一个新窗口？打开->新建项目->GUI类型->mainWindow.cpp。它将使winodw，我希望它的按钮。我想在 On_click() 之后打开一个新窗口。我将如何实现它任何人都可以解释我我们面临很多问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:51:53.193

您应该将`QPushButton's clicked()`信号连接到您的插槽，在插槽的实现中，您可以创建新的小部件并显示它。

# android - 图像的 imageButton 边框

> ID：10143078
> 
> 赞同：1
> 
> 时间：2012-04-13T14:49:17.233
> 
> 标签：android, android-layout, imagebutton

我有一个带有按钮的应用程序，它以椭圆的方式呈圆形，所以当我把它们放在 imageButton 上时，图像按钮看起来像这样

![在此处输入图像描述](../Images/5b05d7a203f21a5d2dc30232ada0d34e.png)

但我希望 ImageButton 只显示图像而不是 Button 的边框

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T14:52:35.673

`ImageButton`正是用于此 - 当您想要常规按钮内的图像时。如果您不想要按钮背景，只需使用`ImageView`, 或常规`Button`，将背景更改为您自己的按钮图形（尽管在这种情况下第一个选项可能是最好的，因为您的按钮文本似乎是图片）。

如果您出于某种原因确实*必须*使用`ImageButton`，请将`background`属性设置为透明颜色或 @null 以摆脱边框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T14:52:19.650

使用 ImageView 而不是 ImageButton。基本上，它们是相同的，只是 ImageButton 将图像放在现有按钮内。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-13T14:57:56.917

为此，您需要制作自己的自定义按钮，

试试这个。在drawable中创建一个文件btn_default.xml并粘贴它

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<item android:state_window_focused="false" android:state_enabled="true"
    android:drawable="@drawable/btn_new_default" />    
<item android:state_pressed="true" 
    android:drawable="@drawable/btn_new_default_pressed" />
<item android:state_focused="true" android:state_enabled="true"
    android:drawable="@drawable/btn_new_default" />
<item android:state_enabled="true"
    android:drawable="@drawable/btn_new_default" />
</selector> 
```

创建圆形图像，您希望按钮具有不同的状态，即按下按钮时，默认等，并将它们放在可绘制文件夹中，上面代码中提到的名称或更改上面可绘制的名称。

完成后将 btn_default.xml 设置为您的普通按钮的背景。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T15:03:50.317

如果按钮是在 xml 中定义的，您可以将 android:background 属性设置为“@null”。如果它是在代码中创建的，请使用按钮的 setBackgroundDrawable() 方法，并将 null 作为参数。

# java - 在 Java 中创建方法和测试类

> ID：10143081
> 
> 赞同：0
> 
> 时间：2012-04-13T14:49:25.703
> 
> 标签：java, computer-science, class-method

我目前正在研究以下问题作为修订：

**VolumeModel 存储音量控制对象的数据。音量有水平，也可以置于静音状态。**

（下面是在 UML 图中绘制的内容：）

**VolumeModel** -*类名*

**静音：int** -*属性*

**级别：int** -*属性*

**+..methods..** -*类的方法*

**a) 写下您希望在此类中看到的所有方法标头，包括构造函数，以便它符合支持数据封装的常规标准。（不要编写方法体或文档）。**

作为我对这个问题的回答，我是这样写的：

```
public VolumeModel()
public VolumeModel(boolean muted, int level)
public void setLevel(int level)
public int getLevel()
public setMuted(boolean muted)
public boolean isMuted()
public void turnUp()
public void turnUp(int level)
public String toString()
public boolean equals(VolumeModel V) 
```

我不知道这是否是所有预期的方法标头，包括构造函数，由于下面的以下问题（与上述问题相关），预计会在此类中看到：

**b) 使用您在 (a) 部分中声明的方法，编写测试程序的代码以：**

*   **创建体积模型的实例...**
*   **音量为 1 且未静音：**
*   **在一个循环中，将音量稳定地增加到 10 级：**
*   **然后静音；**
*   **最后输出体积模型对象的状态**

到目前为止，作为我对上述问题的回答，我已经这样做了：

```
VolumeModel vml = new VolumeModel();
vml.setLevel(1);
vml.setMuted(false);

VolumeModel volumelevel = new VolumeModel(true, 11);
while (!vml.equals(volumelevel)
{
 //to be completed  
} 
```

上面的那段代码还没有完成，因为我正在为此苦苦挣扎，所以如果有人可以给我任何提示，我将不胜感激。

此外，对我对问题 a) 的以下回答的任何建议和反馈也会有所帮助。

提前致谢。

ps - 我无法在我的 eclipse 软件上试用此代码，因为我的 eclipse 软件由于某种原因无法在我的笔记本电脑上运行，但是当我有时间去我的计算机实验室时，我会看看我是否可以测试代码他们那边电脑上的eclipse软件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:05:37.313

一些备注：

*   你忘了声明返回类型`setMuted()`
*   没有javadoc。尽管大多数方法都是显而易见的，但`turnUp(int level)`例如，它们的作用是什么？参数是新级别（在这种情况下，它与 做同样的事情`setLevel()`），还是增量？使用无参数构造函数构造时，对象的状态是什么？
*   如果`equals()`被覆盖，那么`hashCode()`也必须被覆盖。约定是相等的对象必须具有相同的 hashCode。此外，该`equals`方法应采用`Object`as 参数。您可以实现一个`equals(VolumeModel)`方法，但请注意您不会覆盖该`Object.equals()`方法，因此该方法将永远不会被集合类调用。
*   有`turnUp`方法很奇怪，但没有`turnDown`。
*   没有限制是很奇怪的（尽管问题中没有提出）。

最后，您的代码段没有执行所要求的操作。它应该：

*   创建一个唯一的`VolumeModel`实例，将音量设置为 1 且未静音
*   `turnUp()`循环调用9 次迭代
*   通过调用将其静音`setMuted(true)`
*   调用`getLevel()`and`isMuted()`并分别检查值是`10`和`true`。该问题不要求您实现 equals 并测试两个 VolumeModel 实例之间的相等性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:17:40.803

您无需创建新的 VolumeModel 即可进行测试。您也不需要 equals 方法。

而不是做一个while循环试试这个：

```
for(i=2;i<11;i++){
    vml.turnUp(); //provided that turnUp sets the volume up a level
}
vml.setMuted(true); 
```

此时您应该指定要如何输出对象的状态。您可以通过这种方式创建自己的 outputState()，而不是尝试重新实现 toString，就像您正在做的那样

```
public void outputState(VolumeModel v) 
```

返回类型是 void，因为您可以简单地放置一系列 System.out，或者您喜欢的任何输出系统。

希望这可以帮助。

# javascript - Access-Control-Allow-Origin 不允许来源

> ID：10143093
> 
> 赞同：352
> 
> 时间：2012-04-13T14:50:19.807
> 
> 标签：javascript, ajax, cors, xmlhttprequest, cross-domain

我正在[Sencha Touch](https://en.wikipedia.org/wiki/Sencha_Touch) 2 应用程序（包装在[PhoneGap](http://en.wikipedia.org/wiki/PhoneGap)`Ajax.request`中）中创建远程 PHP 服务器。

来自服务器的响应如下：

> XMLHttpRequest 无法加载[http://nqatalog.negroesquisso.pt/login.php](http://nqatalog.negroesquisso.pt/login.php)。Access-Control-Allow- Origin`http://localhost:8888`不允许 Origin。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：383
> 
> 时间：2012-04-13T14:54:20.963

不久前我写了一篇关于这个问题的文章，[Cross Domain AJAX](http://www.cypressnorth.com/blog/programming/cross-domain-ajax-request-with-json-response-for-iefirefoxchrome-safari-jquery/)。

如果您可以控制响应服务器，则处理此问题的最简单方法是为以下内容添加响应标头：

```
Access-Control-Allow-Origin: * 
```

这将允许跨域[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)。在 PHP 中，您需要像这样修改响应：

```
<?php header('Access-Control-Allow-Origin: *'); ?> 
```

您可以将`Header set Access-Control-Allow-Origin *`设置放在[Apache](http://en.wikipedia.org/wiki/Apache_HTTP_Server)配置或 htaccess 文件中。

应该注意的是，这有效地禁用了 CORS 保护，这**很可能使您的用户受到攻击**。如果您不知道您特别需要使用通配符，则不应使用它，而应将您的特定域列入白名单：

```
<?php header('Access-Control-Allow-Origin: http://example.com') ?> 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2012-04-13T16:50:49.933

如果您**无法**控制服务器，您可以简单地将这个参数添加到您的 Chrome 启动器`--disable-web-security`：

请注意，我不会将其用于正常的“网上冲浪”。作为参考，请参阅这篇文章：[在 Chrome 中禁用同源策略](https://stackoverflow.com/questions/3102819/chrome-disable-same-origin-policy)。

如果您使用 Phonegap 实际构建应用程序并将其加载到设备上，这将不是问题。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2012-08-21T07:15:58.710

如果您使用的是 Apache，只需添加：

```
<ifModule mod_headers.c>
    Header set Access-Control-Allow-Origin: *
</ifModule> 
```

在您的配置中。这将导致您的网络服务器的所有响应都可以从 Internet 上的任何其他站点访问。如果您打算只允许特定服务器使用您主机上的服务，您可以将 替换`*`为原始服务器的 URL：

```
Header set Access-Control-Allow-Origin: http://my.origin.host 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-08-13T20:56:28.737

如果您有[ASP.NET](http://en.wikipedia.org/wiki/ASP.NET) / [ASP.NET MVC](http://en.wikipedia.org/wiki/ASP.NET_MVC_Framework)应用程序，则可以通过 Web.config 文件包含此标头：

```
<system.webServer>
  ...

    <httpProtocol>
        <customHeaders>
            <!-- Enable Cross Domain AJAX calls -->
            <remove name="Access-Control-Allow-Origin" />
            <add name="Access-Control-Allow-Origin" value="*" />
        </customHeaders>
    </httpProtocol>
</system.webServer> 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2013-06-06T15:24:54.913

[这是我尝试使用ASP.NET MVC](https://en.wikipedia.org/wiki/ASP.NET_MVC)作为数据源来解决相同问题时弹出的第一个问题/答案。我意识到这并不能解决[PHP](https://en.wikipedia.org/wiki/PHP)问题，但它的相关性足以产生价值。

我正在使用 ASP.NET MVC。Greg Brant的[博客文章](https://web.archive.org/web/20130906005352/http://blog.gregbrant.com:80/post/Adding-Custom-HTTP-Headers-to-an-ASPNET-MVC-Response.aspx)对我有用。最终，您创建了一个属性 ，`[HttpHeaderAttribute("Access-Control-Allow-Origin", "*")]`您可以将其添加到控制器操作中。

例如：

```
public class HttpHeaderAttribute : ActionFilterAttribute
{
    public string Name { get; set; }
    public string Value { get; set; }
    public HttpHeaderAttribute(string name, string value)
    {
        Name = name;
        Value = value;
    }

    public override void OnResultExecuted(ResultExecutedContext filterContext)
    {
        filterContext.HttpContext.Response.AppendHeader(Name, Value);
        base.OnResultExecuted(filterContext);
    }
} 
```

然后将其用于：

```
[HttpHeaderAttribute("Access-Control-Allow-Origin", "*")]
public ActionResult MyVeryAvailableAction(string id)
{
    return Json( "Some public result" );
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-04-23T04:46:10.933

由于 Matt Mombrea 在服务器端是正确的，您可能会遇到另一个问题，即白名单拒绝。

你必须配置你的phonegap.plist。（我使用的是旧版本的phonegap）

对于cordova，命名和目录可能会有一些变化。但步骤应该大体相同。

首先选择支持文件> PhoneGap.plist

![在此处输入图像描述](../Images/ee3012dee4403998bc3c2f73b442c231.png)

然后在“外部主机”下

添加一个条目，其值可能为“ [http://nqatalog.negroesquisso.pt](http://nqatalog.negroesquisso.pt) ”，我使用 * 仅用于调试目的。

![在此处输入图像描述](../Images/4fb9829c632bd31f969ddeed2db5b4ee.png)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2013-06-18T17:37:50.500

这对于需要对“www”和“非 www”版本的推荐人都例外的人来说可能很方便：

```
 $referrer = $_SERVER['HTTP_REFERER'];
 $parts = parse_url($referrer);
 $domain = $parts['host'];

 if($domain == 'google.com')
 {
         header('Access-Control-Allow-Origin: http://google.com');
 }
 else if($domain == 'www.google.com')
 {
         header('Access-Control-Allow-Origin: http://www.google.com');
 } 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-04-13T14:51:30.883

这是因为[同源策略](https://en.wikipedia.org/wiki/Same-origin_policy)。[在Mozilla Developer Network](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy)或[Wikipedia](https://en.wikipedia.org/wiki/Same-origin_policy)上查看更多信息。

基本上，在您的示例中，您只需要从 加载`http://nqatalog.negroesquisso.pt/login.php`页面`nqatalog.negroesquisso.pt`，而不是`localhost`.

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2012-12-19T00:07:14.857

我在使用各种 API 时遇到过几次。通常快速解决方法是添加“&callback=?” 到字符串的末尾。有时＆符号必须是字符代码，有时是“？”：“？callback =？” （请参阅[Forecast.io API 使用 jQuery](https://stackoverflow.com/questions/18132790/forecast-io-api-usage-with-jquery)）

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2013-10-16T04:01:55.230

我会给你一个简单的解决方案。就我而言，我无权访问服务器。在这种情况下，您可以更改[Google Chrome](http://en.wikipedia.org/wiki/Google_Chrome)浏览器中的安全策略以允许 Access-Control-Allow-Origin。这很简单：

1.  创建 Chrome 浏览器快捷方式
2.  右键单击快捷方式图标 -> 属性 -> 快捷方式 -> 目标

简单粘贴进去`"C:\Program Files\Google\Chrome\Application\chrome.exe" --allow-file-access-from-files --disable-web-security`。

位置可能不同。现在通过单击该快捷方式打开 Chrome。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2014-02-01T18:18:22.173

如果您正在编写 Chrome 扩展程序并收到此错误，请确保您已将 API 的基本 URL 添加到您`manifest.json`的[权限块](https://developer.chrome.com/extensions/declare_permissions.html)中，例如：

```
"permissions": [
    "https://itunes.apple.com/"
] 
```

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2015-09-02T18:31:50.333

如果您在 apache 下，只需将 .htaccess 文件添加到您的目录中，其中包含以下内容：

```
Header set Access-Control-Allow-Origin: *

Header set Access-Control-Allow-Headers: content-type

Header set Access-Control-Allow-Methods: * 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2013-04-18T09:23:16.723

如果你在 Angular.js 中得到这个，那么确保你像这样转义你的端口号：

```
var Project = $resource(
    'http://localhost\\:5648/api/...', {'a':'b'}, {
        update: { method: 'PUT' }
    }
); 
```

有关它的更多信息，请参见[此处](https://github.com/angular/angular.js/issues/1243)。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2013-09-03T15:51:49.567

在[Ruby on Rails](http://en.wikipedia.org/wiki/Ruby_on_Rails)中，您可以在控制器中执行以下操作：

```
headers['Access-Control-Allow-Origin'] = '*' 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2015-04-07T12:26:30.627

`Access-Control-Allow-Origin: *`您可以通过使浏览器在 HTTP OPTIONS 的响应中包含标头来使其在不修改服务器的情况下工作。

在 Chrome 中，使用[此扩展程序](https://chrome.google.com/webstore/detail/cors-unblock/lfhmikememgdcahcdlaciloancbhjino)。如果您在 Mozilla 上，请检查[此答案](https://stackoverflow.com/a/29096229/3495031)。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2013-03-11T06:37:12.497

我们在 chrome 中测试的 phonegap 应用程序也有同样的问题。我们每天在打开 Chrome 之前使用下面的批处理文件的一台 Windows 机器。请记住，在运行此之前，您需要从任务管理器中清除所有 chrome 实例，或者您可以选择 chrome 以不在后台运行。

批处理：（使用 cmd）

```
cd D:\Program Files (x86)\Google\Chrome\Application\chrome.exe --disable-web-security 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-06-07T20:16:51.847

在红宝石[辛纳屈](http://sinatrarb.com)

```
response['Access-Control-Allow-Origin'] = '*' 
```

对于每个人或

```
response['Access-Control-Allow-Origin'] = 'http://yourdomain.name' 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-09-09T23:10:26.763

当您收到请求时，您可以

```
var origin = (req.headers.origin || "*"); 
```

而不是当你必须回应这样的事情时：

```
res.writeHead(
    206,
    {
        'Access-Control-Allow-Credentials': true,
        'Access-Control-Allow-Origin': origin,
    }
); 
```

# objective-c - 如何将 JSON 用于关系类型数据 - 最好只重复数据？

> ID：10143094
> 
> 赞同：1
> 
> 时间：2012-04-13T14:50:36.017
> 
> 标签：objective-c, ios, database, json

我想创建 JSON 作为汽车的小型数据库。如果我要使用 MySQL，我会创建一个 Maker 表，以免重复每辆车的制造商和制造商属性。在 JSON 中执行此操作的最佳方法是什么？例如，如果我具有以下制造商属性：

“名称”：“福特”，“URL”：“ford.com”，“成立”：“某年”等...

然后是汽车列表“名称”：“Mustang”，“第一年”：“某年”，“制造商”：“福特”“制造商 URL”：“ford.com”

我不想为每辆福特汽车重复制造商属性。我应该有两个 JSON 文件并通过制造商 ID 或唯一制造商名称将它们链接在一起吗？还是我应该让制造商属性为每辆福特汽车重复？我专门在 Objective-C/iOS 中这样做，所以我可以在 iPhone 上使用数据。我会将 JSON 拉入一个数组以进行解析和查看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:00:31.587

为什么不使用 SQLLite 的核心数据并创建您将在 mySQL 中使用的相同表？如果您真的想坚持使用 JSON，那么“正确的”分析器取决于对您而言重要的内容。例如节省空间？易于更新（如果福特 URL 更改为 cars.ford 会怎样）？更少的读取访问？ETC

# c# - 如何使用 iTextSharp 4.1.6 提取文本？

> ID：10143098
> 
> 赞同：10
> 
> 时间：2012-04-13T14:50:50.620
> 
> 标签：c#, itextsharp, text-extraction

iTextSharp 4.1.6 是根据 LGPL 许可的最后一个版本，可免费用于商业目的，无需支付许可费。

对于某些人和我来说，如何使用此版本提取文本可能会很有趣。

有人有想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-11-24T17:43:09.810

我不得不手动破解这个，因为我和你在同一条船上。希望这对您有所帮助。它可能并不完美，但我能够通过这种方式从文档中获取所需的文本。`fileName`是 PDF 文件的字符串变量/参数。

```
var reader = new PdfReader(fileName);

StringBuilder sb = new StringBuilder();

try
{
    for (int page = 1; page <= reader.NumberOfPages; page++)
    {
        var cpage = reader.GetPageN(page);
        var content = cpage.Get(PdfName.CONTENTS);

        var ir = (PRIndirectReference)content;

        var value = reader.GetPdfObject(ir.Number);

        if (value.IsStream())
        {
            PRStream stream = (PRStream)value;

            var streamBytes = PdfReader.GetStreamBytes(stream);

            var tokenizer = new PRTokeniser(new RandomAccessFileOrArray(streamBytes));

            try
            {
                while (tokenizer.NextToken())
                {
                    if (tokenizer.TokenType == PRTokeniser.TK_STRING)
                    {
                        string str = tokenizer.StringValue;
                        sb.Append(str);
                    }
                }
            }
            finally
            {
                tokenizer.Close();
            }
        }
    }
}
finally
{
    reader.Close();
}

return sb.ToString(); 
```

# c# - ReSharper 显示对通用集合的值可能的空分配

> ID：10143101
> 
> 赞同：4
> 
> 时间：2012-04-13T14:50:54.567
> 
> 标签：c#, generics, collections, resharper

我正在使用 a`Dictionary<string, string>`并添加一个具有空值的项目（在我的实际情况下它是一个变量）。

```
var testDictionary = new Dictionary<string, string>();
testDictionary.Add("Test", null); 
```

这会导致警告“可能对标有 'NotNull' 属性的实体进行 'null' 分配”。 ![可能的“空”分配](../Images/ff8fbe9e5dc544144f35d687d243326f.png)

如果我让 ReSharper 将其转换为 Collection Initializer，它不会显示任何警告。

```
var testDictionary = new Dictionary<string, string> {{"Test", null}}; 
```

那么，字典的值是否被标记为“NotNull”属性？还是发生了其他事情？

编辑：这个问题与 Resharper 没有太大区别[：可能为用 notnull 属性标记的实体分配空值](https://stackoverflow.com/questions/8979008)，但我的问题的答案是不同的（这是 R# 中的一个错误，并且将空元素添加到集合不是一个好主意）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-13T14:54:29.960

一般来说，将`null`元素放入集合中是一种不好的做法。使用集合的绝大多数代码都假定集合中的值不是`null`. 如果`null`是一个有效的集合元素，它确实使所有消费代码复杂化。

例如，您基本上需要编写

```
foreach (var cur in theCollection) {
  if (cur.Value == null) {
    continue;
  }
  ...
} 
```

对于这种特定情况，看起来 R# 缺少集合初始值设定项情况。`null`出现在收藏中 绝对是出乎意料的。

而不是`null`为什么不使用`String.Empty`？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T15:03:42.423

这是[一个错误，已在 6.0 中修复](http://youtrack.jetbrains.com/issue/RSRP-207297)。

所以是的，**正在**发生其他事情 - 你需要升级你的 R# ;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T14:57:20.867

ReSharper 故障。如果要禁用警告，您可以编辑使用菜单以检查“可能为空...”的选项并将其更改为不显示。

代码非常好，虽然我无法想象你为什么要添加 null （通常指向糟糕的设计/算法，那里有更简洁的方法）。

# javascript - 对齐文章元素

> ID：10143103
> 
> 赞同：0
> 
> 时间：2012-04-13T14:51:04.113
> 
> 标签：javascript, html, css

在我的 html5 页面中，我尝试为一组文章设置样式。文章元素具有固定宽度但可变高度。我尝试使用浮动：左。

它应该看起来像下面的绿色框，但它看起来像红色框。框 nr 3 未正确对齐。

任何 CSS3 甚至 js 方法来解决这个问题？

![情况](../Images/9ffe7f6cd269be9cfc98973ad0b34d1f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:13:13.290

[有一个名为Masonry](http://masonry.desandro.com/)的 jQuery 插件就是为此而设计的。

# java - 更改单元格颜色在 netbeans 上不起作用

> ID：10143105
> 
> 赞同：0
> 
> 时间：2012-04-13T14:51:06.503
> 
> 标签：java, swing, colors, jtable, tablecellrenderer

我用 Netbeans 创建了桌面应用程序，如果它的字符串值为“on Process”，我想更改特定的单元格颜色。我试过了

```
class CustomTableCellRenderer extends DefaultTableCellRenderer{
    public Component getTableCellRendererComponent (JTable table, Object obj,
            boolean isSelected, boolean hasFocus, int row, int column) {
        Component cell = super.getTableCellRendererComponent(
            table, obj, isSelected, hasFocus, row, column);
        if (obj=="on Process") {
            cell.setBackground(Color.green);
        } 
        return cell;
    }
} 
```

但它并没有改变我用过的桌子

```
table.getColumnModel().getColumn(7).setCellRenderer(new CustomTableCellRenderer()); 
```

我正在从数据库中获取值并使用

```
for(int i=0; i<arraylist.size(); i++) {
    table.setValueAt(status, i, 7);
} 
```

这里的状态是`String`，如果我手动输入：

```
table.setValueAt("on Process", i, 7); 
```

它改变了颜色，很好，但我不能那样输入，我需要从变量中设置值。我试过String，Object，没用！我试过`toString()`了，我试过“”+状态，......它只是忽略了我分配给它的东西。如果我在 forloop 中键入“on Process”它可以工作，但在 forloop 之外我可以从变量中分配，它会改变颜色。我很困惑，不知道该怎么办。请帮我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T16:42:59.677

你需要这个：

```
if(obj.toString().equals("on Process")) 
```

代替：

```
if(obj=="on Process") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T02:30:08.563

@Eng.Fouad 关于区分`equals()`和是正确的`==`。您还需要验证您是否为指定列`TableModel`返回了所需的[类型标记，如本](http://docs.oracle.com/javase/tutorial/extra/generics/literals.html)[示例](https://stackoverflow.com/a/10067560/230513)所示。简单地`DefaultTableModel`返回`Object.class`。

# sql - 获取未订购特定产品的客户列表

> ID：10143106
> 
> 赞同：1
> 
> 时间：2012-04-13T14:51:09.200
> 
> 标签：sql, sql-server, sql-server-2008, tsql, exists

它位于 SQL Server 2008 R2 中。

我们有 3 种产品，订单和客户：P1 P2 P3

我们想知道订购 P1 和 P2 但不订购 P3 的客户。我们不希望得到订购所有 3 种产品的客户。我不知道如何编写该查询。你能告诉我吗？谢谢。

我们只有 2 张桌子。订单和客户。产品名称是固定的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:43:40.530

被迫猜测架构，并假设客户可以多次订购相同的产品，您可以使用这样的东西......

```
WITH
  Products (
    productID,
    inclusive
  )
AS
(
            SELECT 'P1', 1
  UNION ALL SELECT 'P2', 1
  UNION ALL SELECT 'P3', 0
)

SELECT
  customerID
FROM
  Orders
INNER JOIN
  Products
    ON Orders.ProductID = Products.ProductID
GROUP BY
  customerID
HAVING
  COUNT(distinct Orders.ProductID) = (SELECT SUM(inclusive) FROM Products)
  AND MIN(Products.inclusive)      = 1 
```

首先，连接将所有拥有的内容过滤为仅包含或的任何订单`P1`的订单。`P2``P3`

GROUP BY 将这些订单分组，每个客户一组。

第一个 HAVING 子句查看该列表中的所有订单。它计算该子集中有多少*不同的产品。*它会检查我们正在搜索的产品列表中有多少*包容性产品。*它规定这两个数字必须相同。
*[在这个例子中；他们一定订购了两种不同的产品。]*

第二个 HAVING 子句检查这些产品中是否*有*`inclusive = 0`.
*[客户订购的产品不得出现在排除列表中。]*

**编辑：**这是另一种选择，有些人似乎更喜欢，但我认为它的性能较低（在 Orders 表大小很大的情况下）。

```
SELECT
  customerID
FROM
  Orders
WHERE
  ProductID in ('P1', 'P2')
GROUP BY
  customerID
HAVING
  COUNT(distinct ProductID) = 2
  AND NOT EXISTS (SELECT *
                    FROM Orders AS lookup
                   WHERE CustomerID = Orders.CustomerID
                     AND ProductID IN ('P3')
                 ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:18:04.193

假设 Orders 包含 customerID 和 ProductId 列

```
select disrinct(customerID) from Orders 
```

为您提供所有下订单的客户

```
select customerID, COUNT(distinct(productID))
from Orders
where productID in ('P1', 'P2') 
      and customerid not in (select customerID
from Orders
where productID in ('P3'))
group by customerID
having COUNT(distinct(productID))>1 
```

为您提供所有使用产品 P1 和 P2 但不是 P3 下订单的客户

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T16:16:45.223

```
DECLARE @Customer TABLE ( ID int, Name nvarchar(20) )
DECLARE @Order TABLE ( CustomerID int, Product nvarchar(2) )

INSERT INTO @Customer VALUES ( 1, 'Dave' )
INSERT INTO @Customer VALUES ( 2, 'Another Dave' )

INSERT INTO @Order VALUES ( 1, 'P1' )
INSERT INTO @Order VALUES ( 1, 'P2' )
INSERT INTO @Order VALUES ( 2, 'P1' )
INSERT INTO @Order VALUES ( 2, 'P2' )
INSERT INTO @Order VALUES ( 2, 'P3' )

SELECT          a.Name
FROM            @Customer a
INNER JOIN      @Order b ON ( b.CustomerID = a.ID AND b.Product = 'P1' )
INNER JOIN      @Order c ON ( c.CustomerID = a.ID AND c.Product = 'P2' )
LEFT OUTER JOIN @Order d ON ( d.CustomerID = a.ID AND d.Product = 'P3' )
WHERE           d.CustomerID IS NULL
GROUP BY        a.Name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T18:06:26.010

```
select CustomerId
from 
(
   select o.*,
     (case when productid = <product1> then 1 else 0 end) as has_p1,
     (case when productid = <product2> then 1 else 0 end) as has_p2,
     (case when productid = <product3> then 1 else 0 end) as has_p3
   from Orders o
) o
group by CustomerId
having max(has_p1) = 1 
  and max(has_p2) = 1 
  and max(has_p3) = 0 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-19T18:53:13.057

```
select CustomerId
from 
(
   select o.*,
     (case when productid = <product1> then 1 else 0 end) as has_p1,
     (case when productid = <product2> then 1 else 0 end) as has_p2,
     (case when productid = <product3> then 1 else 0 end) as has_p3
   from Orders o
) o
group by CustomerId
having max(has_p1) = 1 
```

# java - 收到异常“SSLPeerUnverifiedException：peer not authenticated”，我该如何避免/忽略它？

> ID：10143111
> 
> 赞同：2
> 
> 时间：2012-04-13T14:51:28.137
> 
> 标签：java, automation, screen-scraping, htmlunit

我正在尝试使用 HtmlUnit（Java 库）登录网站，但遇到了一个我觉得可以忽略的异常。例外是“javax.net.ssl.SSLPeerUnverifiedException：peer not authenticated”。我已将其范围缩小到证书支持“www.thesite.com”，但它确实使用“somedomain.thesite.com”。我认为该错误是由于证书未命名它在某些 javascript 函数中使用的其他子域。很奇怪，当手动使用 Firefox 时，我没有看到这些异常，让我觉得还有其他事情发生。

下面是我正在使用的代码：

```
// <editor-fold desc="User Credentials and site.">
String user = "auser";
String password = "apassword";

String mainUrl = "https://www.awebsite.com/";

// Setup Ajax & Cookies
AjaxController ajaxController = new AjaxController();
CookieManager cookieManager = new CookieManager();
cookieManager.setCookiesEnabled(true);

// Setup WebClient
WebClient webClient = new WebClient(BrowserVersion.FIREFOX_3_6);
webClient.setAppletEnabled(true);
webClient.setCssEnabled(true);
webClient.setJavaScriptEnabled(true);
webClient.setAjaxController(ajaxController);
webClient.setThrowExceptionOnScriptError(false);
webClient.setThrowExceptionOnFailingStatusCode(false);
webClient.setCookieManager(cookieManager);

/*
 * Provider p = new sun.security.pkcs11.SunPKCS11();
 * Security.addProvider(p);
 */

//webClient.set
HtmlPage page = null;

try {
    webClient.setUseInsecureSSL(true);
    page = webClient.getPage(mainUrl);

    // fill in form
    HtmlForm htmlForm = page.getFormByName("thisForm");
    HtmlInput userField = htmlForm.getInputByName("Username");
    HtmlInput passwordField = htmlForm.getInputByName("Password");

    // Enter login and password
    userField.setValueAttribute(user);
    passwordField.setValueAttribute(password);

    //HtmlPage mainMenuPage = htmlForm.click();
    HtmlElement element = htmlForm.getInputByValue("Login");

    page = element.click();
    webClient.waitForBackgroundJavaScript(5000); // pause if

    System.err.println(page.asText());
    System.err.println(page.asXml());

} catch (Exception ex) {
    ex.printStackTrace();
}

webClient.closeAllWindows(); 
```

}

如您所见，我启用了“webClient.setUseInsecureSSL(true);” 在 HtmlUnit 库中。我认为这应该这样做。但是，在这一点上，我被卡住了。

这是我得到的异常错误：

```
javax.net.ssl.SSLPeerUnverifiedException: peer not authenticated
    at com.sun.net.ssl.internal.ssl.SSLSessionImpl.getPeerCertificates(SSLSessionImpl.java:352)
    at org.apache.http.conn.ssl.AbstractVerifier.verify(AbstractVerifier.java:128)
    at org.apache.http.conn.ssl.SSLSocketFactory.connectSocket(SSLSocketFactory.java:397)
    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:148)
    at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:149)
    at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:121)
    at org.apache.http.impl.client.DefaultRequestDirector.tryConnect(DefaultRequestDirector.java:573)
    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:425)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:820)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:776)
    at com.gargoylesoftware.htmlunit.HttpWebConnection.getResponse(HttpWebConnection.java:152)
    at com.gargoylesoftware.htmlunit.WebClient.loadWebResponseFromWebConnection(WebClient.java:1439)
    at com.gargoylesoftware.htmlunit.WebClient.loadWebResponse(WebClient.java:1358)
    at com.gargoylesoftware.htmlunit.WebClient.getPage(WebClient.java:307)
    at com.gargoylesoftware.htmlunit.WebClient.getPage(WebClient.java:373)
    at com.gargoylesoftware.htmlunit.WebClient.getPage(WebClient.java:358)
    at com.mycompany.extract.Program.main(Program.java:62) 
```

有什么想法或建议吗？在此错误之后程序根本不会继续，我不在乎证书是否坏（它是一个有效的证书，只是使用不同的子域），证书也是我无法控制的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T23:58:49.720

问题是您需要该子域的有效证书。获取它，并将其添加到您正在使用的 Java 版本中的 jssecacerts 中。

我使用 InstallCert.java 做到了这一点。这里有一些有用的文档：http: [//miteff.com/install-cert](http://miteff.com/install-cert)，也可能在这里： http: [//pinchii.com/home/tag/jssecacerts/](http://pinchii.com/home/tag/jssecacerts/)

一个简单的谷歌搜索“InstallCert.java”应该会给你很多结果。

祝你好运！

# php - PHP - 不显示输入值

> ID：10143113
> 
> 赞同：0
> 
> 时间：2012-04-13T14:51:30.633
> 
> 标签：php, html, sql-server

我正在从 mysqlserver 行项中检索数据到输入文本框的值，但在页面加载时该值未显示。而且我似乎无法显示输入框的值。有谁知道出了什么问题？

```
<?php           
        if(isset($_COOKIE["email"]))
        {               
            $emailAddress = $_COOKIE["email"];
            $password = $_COOKIE["password"];               
            include('connectDB.php');
            $select = "SELECT * FROM P_Profile WHERE P_EmailAddress = '$emailAddress' AND P_Password='$password'";              
            mysql_select_db("lotusbs", GetConnection()) or die(mysql_error());                  
            $result = mysql_query($select) or die(mysql_error());               
            $row = mysql_fetch_array($result)                   
            ?>              
                <div class="signupcontainer">
                    <div class="contentsignup" style="margin-top:20px;">                        
                    <div class="textboxsignup"><span class="signuptbspan" style="Display:none;">First name</span><input value="<?php echo $row['P_FirstName'];?>" name="txtfirstname" id="txtfirstname" type="text"/></div>
                        <div class="signupinfo">Enter first name</div>
                        <div class="signupinfoerror">Must Enter first name</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T14:56:27.390

尝试调试此脚本，例如：

1.  通过在 true 子句中回显来检查脚本是否通过了 if( isset($_coo....) 位。

2.  echo $select，在 mysql-query 形成字符串后，在 phpmyadmin 中尝试一下。检查查询是否没有错误，以及传递的变量是否以正确的方式包含在内。

3.  尝试在关闭 php 之前转储 $row 变量？> 这样，如果将结果传递给行变量，您将不会这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:11:02.850

这里有几种可能性：

*   该列可能不存在
*   该行可能不存在
*   连接可能已失败，或者您可能选择了错误的数据库。

还有一件事你应该考虑改变。您使用 cookie 保存未加密和未编码的密码。这意味着您实际上可以在 cookie 中找到人们的密码。这可能会产生相当大的后果，因为如果用户在其他网站上使用相同的信息，人们可以很容易地破解它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T16:54:41.150

在这样做之前：

```
$row = mysql_fetch_array($result) 
```

您应该始终检查查询是否已通过执行以下操作从表中获取任何行：

```
if (mysql_num_rows($result)) {
    // fetch the rows here and do other stuff
}
else {
    echo "Record was not found !";
} 
```

这将告诉您查询返回了一些记录。如果您将输出显示为“找不到记录”，那么您的 SQL 查询有问题。还`mysql_fetch_array()`为您提供了一个数组，该数组将作为`$row[0]`. 如果你想像这样以关联数组的形式访问它`$row['P_FirstName']`，你需要调用函数`mysql_fetch_assoc()`。

# html - 表格单元格宽度在整个表格中重复 - 不受欢迎

> ID：10143117
> 
> 赞同：0
> 
> 时间：2012-04-13T14:51:34.563
> 
> 标签：html

我有一个 html 表。在我的顶部表格行中，我有 2 个 td 标签，其宽度分别定义为 70% 和 30%。现在的问题是，在这一行下方恰好有 2 个 td 标签的每一行都会自动采用为顶行 td 标签指定的这些宽度，即使我将它们指定为其他值，例如 40% 和 60%。

我怎样才能避免这种对整个表格单元格宽度的通用复制？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T14:58:47.310

这就是 html 中的表格的工作方式。将列想象成 excel 中的列，列中的一个单元格的宽度不能与同一列中的另一个单元格的宽度不同，当然不考虑 colspans。为了实现这样的目的，每次您希望单元格的宽度与前行中同一列中的单元格不同时，您都必须使用单独的表格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T14:58:40.100

您应该研究使用`<col>`和`<colgroup>`元素：

[http://www.w3.org/TR/html401/struct/tables.html#h-11.2.4](http://www.w3.org/TR/html401/struct/tables.html#h-11.2.4)

# ruby-on-rails-3 - 设计用于重置密码的邮件模板

> ID：10143118
> 
> 赞同：7
> 
> 时间：2012-04-13T14:51:39.530
> 
> 标签：ruby-on-rails-3, devise

我想将附件添加到通过设计（徽标图像）重置密码时发送的电子邮件，并且我想使用用户的语言环境来本地化电子邮件文本。任何人都可以帮助并告诉我要覆盖什么来做到这一点吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-11T05:10:21.267

您需要将徽标图像添加为附件。

为此，请按照链接中的说明覆盖默认的 Devise::Mailer： [https ://github.com/plataformatec/devise/wiki/How-To:-Use-custom-mailer](https://github.com/plataformatec/devise/wiki/How-To:-Use-custom-mailer)

然后，使用添加附件`attachments.inline['logo.png']=`：

```
def reset_password_instructions(record, opts={})
  attachments.inline['logo.png'] = File.read('app/assets/images/logo.png')
  super(record, opts)
end 
```

在视图中您可以使用`attachments['logo.png'].url`：

```
<%= image_tag(attachments['logo.png'].url, alt: 'Logo') %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T20:49:16.493

只需运行`rails generate devise:views`和编辑模板`app/views/devise/mailer/reset_password_instructions.html.erb`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-23T11:00:03.087

我正在为 rails 5 应用程序使用设计 4.3。需要附加参数。

```
 def reset_password_instructions(record, token, opts={})
    attachments.inline['logo.png'] = File.read("#{Rails.root}/app/assets/images/logo.png")
    super(record, token, opts)
 end 
```

# javascript - json字符串作为json值

> ID：10143119
> 
> 赞同：0
> 
> 时间：2012-04-13T14:51:41.353
> 
> 标签：javascript, json

是否可以使用 json 字符串作为 json 的值？将有效的 json 字符串作为 json 元素的值传递，

我需要这样的样本：

```
{
"numberOfBlocks": 2,
"1": ""items": [
    {
        "Id": "111257",
        "Name": "AADbZyXqnVRCHjqWSpqQfgpu",
        "Order": 0
    },
    {
        "Id": "162972",
        "Name": "AADbZyXqnVRCHjqWSpqQfgpu",
        "Order": 1
    }]",
"2":""items": [
    {
        "Id": "111257",
        "Name": "AADbZyXqnVRCHjqWSpqQfgpu",
        "Order": 0
    },
    {
        "Id": "162972",
        "Name": "AADbZyXqnVRCHjqWSpqQfgpu",
        "Order": 1
    }]" 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T14:56:16.623

是的，这是一个简单的例子：

```
{
   "a": 3,
   "b": "{ \"c\": \"hello\" } "
} 
```

或者更像你所拥有的东西

```
{
  "numberOfBlocks": 2,
  "1": "{
    \"items\": [
      {
        \"Id\": \"111257\",
        \"Name\": \"AADbZyXqnVRCHjqWSpqQfgpu\",
        \"Order\": 0
      },
      {\
        \"Id\": \"162972\",
        \"Name\": \"AADbZyXqnVRCHjqWSpqQfgpu\",
        \"Order\": 1
      }]"
} 
```

但是，并不是文字换行符在 JSON 中无效，因此您也需要转义换行符。在 JS 中，它看起来像下面这样

```
var a = {
  "numberOfBlocks": 2,
  "1": "{\
    \"items\": [\
      {\
        \"Id\": \"111257\",\
        \"Name\": \"AADbZyXqnVRCHjqWSpqQfgpu\",\
        \"Order\": 0\
      },\
      {\
        \"Id\": \"162972\",\
        \"Name\": \"AADbZyXqnVRCHjqWSpqQfgpu\",\
        \"Order\": 1\
      }]"
} 
```

![在此处输入图像描述](../Images/ed4986e3110617fa53efc7308ff451dd.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:53:30.527

是的。但是，我认为没有理由这样做。它需要很多转义引号。它使解析变得困难，除此之外，它会使所有查看您的源代码的人感到困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T14:54:32.987

当然，您只需要转义双引号 as`\"`和换行符 as `\n`。我不建议你这样做，但它肯定是可能的。

# codeigniter - 如何在 Codeigniter 迁移文件中添加小数字段？

> ID：10143120
> 
> 赞同：9
> 
> 时间：2012-04-13T14:51:43.270
> 
> 标签：codeigniter, migration

在编写 codeigniter 迁移时，我不确定如何添加十进制类型的字段。具体来说，您如何定义允许的元素大小？例如，我将如何定义要传递的数组以`dbforge->add_field()`创建如下所示的字段：

```
price decimal(10,2) not null default 0.00 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-18T19:07:43.380

```
'price' => array(
    'type' => 'DECIMAL',
    'constraint' => '10,2',
), 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-09-18T23:11:14.800

```
'price' => array(
'type' => 'DECIMAL',
'constraint' => '10,2',
'null' => FALSE,
'default' => 0.00
), 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-26T18:53:18.043

```
'price' => array('type' => 'DECIMAL(10,2)') 
```

# c - 线程终止后内存映射对象是否会自动释放？

> ID：10143121
> 
> 赞同：2
> 
> 时间：2012-04-13T14:51:45.593
> 
> 标签：c, linux, multithreading, memory, posix

我有几个简单的问题。如果我在 C 中创建一个新的子线程，在线程完成处理并终止后，请执行以下操作：

*   内存映射对象“自动”释放？（我知道 C 没有垃圾收集器，但此时孩子已终止）

估计我发的太快了。找到了第二个问题的答案（供将来参考）：[http ://www.ibm.com/developerworks/linux/library/l-memory-leaks/index.html?ca=drs-](http://www.ibm.com/developerworks/linux/library/l-memory-leaks/index.html?ca=drs-)

*   子线程可以返回值给父线程吗？（这可能使用一些常见的例程吗？我知道孩子和父母的内存空间是一样的？）

另外我想提一下操作系统是 POSIX 兼容的。

谢谢， 内科

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:09:46.413

正如您已经发现的那样，第一个问题的答案是“不”。这也适用于在堆上分配的对象。

进程中的线程之间没有父子关系，所以“父线程”是没有意义的。但是，是的，线程可以在退出时返回一个值。线程顶层函数的原型是：

```
void *function(void *); 
```

观察返回类型是`void *`. 线程可以返回一个指针（指向任何你喜欢的东西）。此返回值将由等待返回线程完成的任何其他线程使用`pthread_join()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-14T03:29:04.343

线程退出时不会释放内存、文件句柄、互斥锁等资源。但是，当包含所有这些类型的对象的进程退出时，所有与进程相关的资源都会被释放。

# php - foreach语句PHP中的MySql查询

> ID：10143122
> 
> 赞同：0
> 
> 时间：2012-04-13T14:51:46.550
> 
> 标签：php, mysql, foreach

我在 PHP 语句中有这个查询`foreach`：

```
<?php $i = 2; $j = 0; foreach($listings AS $listing): $i = $i == 2 ? 1 : 2;?>

...

<?php
    $db =& JFactory::getDBO();
    $query = "SELECT COUNT(product) FROM my_table WHERE contentid = 'I want content id here'";
    $db->setQuery($query);
    $count = $db->loadResult();

    echo ($count); //this print the count
?>

...

<?php endforeach;?> 
```

如何从 MySQL 数据库中检索每个“列表”的内容 ID？

```
$query = "SELECT COUNT(product) FROM my_table WHERE contentid = '**I want content id here**'"; 
```

我正在使用 joomla 2.5 和 Jreviews。`<?php echo $listing['Listing']['listing_id'];?>`列表 id在`foreach`语句中被“调用” 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:10:41.773

您可以简单地将变量名称添加到查询中，假设 $i 是 id：

```
$query = "SELECT COUNT(product) FROM my_table WHERE contentid = $i"; 
```

或更好

```
$query = sprintf("SELECT COUNT(product) FROM my_table WHERE contentid = %d", $i); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:18:07.287

我认为最好的方法是在输出之前准备好所需的数据。在这种特殊情况下，您只能在 WHERE 子句中使用带有 IN 语句的 ONE SQL 查询。

# php - 转发/重定向数百个域的最佳实用方法是什么？

> ID：10143123
> 
> 赞同：1
> 
> 时间：2012-04-13T14:51:48.777
> 
> 标签：php, apache, hosting, dns, web-hosting

我想将数百个域重定向/转发到我主要网站上的一个特殊页面...例如，假设我拥有business.com ..当有人尝试访问www.business上的任何页面时，我想。 com 将被重定向到我网站上的页面 www.mywebsite.com/business.com。

正如我所说，我想重定向/转发数百个，并且它们一直在计数，所以不可能一个一个地做到这一点。我想要一个更像停车公司如何处理域的解决方案，将域指向 ns1.myowndns.com 和 ns2.myowndns.com 之类的 DNS 服务器并从那里获取。

PS：我拥有一个使用 WHM 面板的 VPS。

期待您的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T16:32:59.257

*   在您的服务器上设置虚拟主机
*   将您所有域的 A 记录指向您的服务器
*   为（来自问题）设置显式虚拟主机`www.mywebsite.com`
*   设置默认主机来处理对无法识别域的所有请求。
*   将此 .htaccess 放在默认主机的根目录中：

.htaccess

```
RewriteEngine On
RewriteRule ^.*$ http://www.mywebsite.com/%{HTTP_HOST} [L,R=302] 
```

`<VirtualHost>`如果您想让文件系统不包含仅包含 .htaccess 的目录，您也可以将这些行放在默认主机的部分中

# c - 第二个参数为空的 C 条件运算符 ('?')

> ID：10143125
> 
> 赞同：41
> 
> 时间：2012-04-13T14:51:55.733
> 
> 标签：c, operators, conditional, ternary-operator

通常是“？” 运算符以下列形式使用：

```
A ? B : C 
```

但是，在 B = AI 的情况下，会看到以下缩写

```
A ? : C 
```

这出人意料地有效。将第二个参数留在（风格方面）更好，还是某些编译器无法处理这个问题？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-04-13T14:55:59.820

语言 C 不允许这样做（据我所知），但 gcc 等编译器具有快捷方式 a?:c 作为[扩展名](http://gcc.gnu.org/onlinedocs/gcc-4.7.0/gcc/Conditionals.html#Conditionals)。 `a?:c`意思相同`a?a:c`。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-13T14:58:23.970

它是 gcc 的扩展

[带有省略操作数的条件](http://gcc.gnu.org/onlinedocs/gcc/Conditionals.html#Conditionals)

`x ? : y`相当于`x ? x : y`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-13T14:56:28.090

除非我大错特错，否则您使用的是编译器扩展（猜测是 gcc）。我很确定标准*不允许*您省略三元运算符的第二个操作数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-13T21:08:38.547

我稍微填一下。

该标准使用术语***条件运算符***。

```
**语法**
  *条件表达式：
          逻辑或表达式
          logical-OR-expression* **?** *expression : conditional-expression* 
```

*A conditional expression does not yield an lvalue.* Also; [Wikipedia; Conditional](http://en.wikipedia.org/wiki/Conditional_%28programming%29)

[Note: I.e.: C++ has:
        logical-OR-expression ? expression : **assignment**-expression]

```
**Constraints:**
* The first operand shall have scalar type^([1]).
* One of the following shall hold for the second and third operands:
   — both operands have arithmetic type^([2]);
   — both operands have the same structure[3] or union type^([4]);
   — both operands have void type^([5]);
   — both operands are pointers to qualified or unqualified[6] versions of compatible
     types[7]^(;
   — one operand is a pointer and the other is a null pointer constant^([8]); or
   — one operand is a pointer to an object or incomplete type^([9]) and the other 
     is a pointer to a qualified or unqualified version of void.) 
```

Foot food:

```
^([1]) Scalar type     : Arithmetic types and pointer types.
^([2]) Arithmetic type : Integer and floating types.
^([3]) Structure type  : A sequentially allocated nonempty set of member objects (and, in
                     certain circumstances, an incomplete array), each of which has an
                     optionally specified name and possibly distinct type.
^([4]) Union type      : An overlapping nonempty set of member objects, each of which has
                     an optionally specified name and possibly distinct type.
^([5]) Void type       : An empty set of values; it is an incomplete type that cannot be
                     completed.
^([6]) Qualified type  : 1998 (const and volatile), 1999 (restrict), respectively 
                     2011 (_Atomic). ^*
^([7]) Compatible type : Their types are the same.
^([8]) Null ptr. const.: NULL; implementation-defined null pointer constant.
^([9]) Incomplete type : Types that describe objects but lack information needed to determine 
                      their sizes. 
```

^* [Type qualifiers in C](http://www.bezem.de/pdf/tqinc.pdf)

So: Not wise to use.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-13T15:11:16.613

我在网上做了一些研究，根据维基百科，这种行为得到了 C 的 GNU 扩展的支持。[http://en.wikipedia.org/wiki/%3F:#C](http://en.wikipedia.org/wiki/%3F:#C)

所以其他编译器很可能认为这是非法的。顺便说一句，这个运算符被称为三元条件，因此您可以浏览它。

编辑：

我检查了 gcc 和 apple llvm，它工作正常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-13T15:04:49.817

最好保留第二个参数。如果 B 发生变化，您可能不记得修改上面的语句。此外，如果您将 B 排除在语句之外，其他人可能难以阅读您的代码并对其进行改进。

# php - 从一个域上传文件到另一个域

> ID：10143128
> 
> 赞同：0
> 
> 时间：2012-04-13T14:52:16.033
> 
> 标签：php, file-upload, permissions, cross-domain, file-permissions

我需要当用户上传文件时，该文件会存储在另一个域的文件夹中。我需要从一个域上传文件到另一个域。从 www.uploadto.com/ 到 www.uploadedfiles.com/uploadedfiles 我有一个简单的 php 网站。用户使用该网站上传文件和图像。但在后端，我需要将图像存储在同一服务器上其他域的文件夹中。我该怎么做？请帮忙。我的网站托管在 Linux Apache 服务器上。我已经给出了整个路径，包括 move_uploaded_file 参数中的用户名。但是我得到权限错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:01:07.913

您可以使用 jquery uploadify 将文件上传到图像服务器，然后将 url 获取到另一台服务器。

# android - 如何在android中更改android ListView Scrollbar thumb的高度

> ID：10143134
> 
> 赞同：1
> 
> 时间：2012-04-13T14:52:31.133
> 
> 标签：android, listview

我通过以下方式在我的列表视图中设置了 ListView Scrollbar thumb 的可绘制对象：

```
android:scrollbarThumbVertical="@drawable/tabscroller 
```

“tabscroller”是一个高度小的图像。但拇指在我的列表视图中显得太大（列表视图拇指的默认高度）。有没有办法改变拇指的高度？

# java - 十六进制字符串到图像

> ID：10143135
> 
> 赞同：1
> 
> 时间：2012-04-13T14:52:33.803
> 
> 标签：java, string, image, io

我有一个看起来像的十六进制字符串：

```
String hexImage ="0xFFD8FFE000104A46494600010200006400640000FFEC00114475636B79000100040000003C..." 
```

我需要使用 Java 将其转换为图像。我尝试先使用 org.apache.commons.codec.binary.Hex 类转换为字节数组。FileOutputStream 稍后将其转储到文件中。

```
char[] charArr= hexImage.toCharArray();
byte[] byteArray = Hex.decodeHex(charArr); 
```

但是 Hex 类中的解析器阻塞，解码器异常：奇数个字符。无论我使用什么方法转换为字节数组，它都失败了。文件格式绝对是 JPEG。

我尝试从字符串中删除~~此~~0xFF，但此时图像已损坏。0xFF 我认为是罪魁祸首 - 有人知道我需要做什么来纠正这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T14:56:53.453

通常，每个字节由 2 个十六进制数字表示，因此，如果您的十六进制字符串中有奇数个数字，那么它有问题。您可以尝试在开头使用 0 填充它，例如：

```
String hexImage ="0xFFD8FFE000104A46494600010200006400640000FFEC00114475636B79000100040000003C...";
if(hexImage.length()%2 == 1)
    hexImage = "0x0" + hexImage.substring(2); 
```

或最后，例如：

```
String hexImage ="0xFFD8FFE000104A46494600010200006400640000FFEC00114475636B79000100040000003C...";
if(hexImage.length()%2 == 1)
    hexImage += "0"; 
```

但是，这不能保证产生正确的图像。

总的来说，您应该检查如何获得十六进制字符串。正确的字节序列应始终包含偶数个十六进制数字。

**编辑：**此外，正如彼得劳里在他的评论中指出的那样，您应该检查该`decode`方法是否需要`0x`在字符串前面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T10:58:21.417

对于偶数长度的字符串

```
 public static byte[] hexStringToByteArray(String str) {
    try {

        String s = str;
        int len = s.length();
        byte[] data = new byte[len / 2];
        for (int i = 0; i < len; i += 2) {
            if (i == len - 1) {
                 System.out.println("in correct");                   
            } else {

                data[i / 2] = (byte) ((Character.digit(s.charAt(i), 16) << 4)
                        + Character.digit(s.charAt(i + 1), 16));

            }
        }
        return data;
    } catch (StringIndexOutOfBoundsException sex) {

        writeDirtyData(str.substring(0, str.indexOf(",")));
    }
    return null;
} 
```

**非奇数十六进制字符串是正确的**。从你那里检查来源得到这个字符串。这是因为由于字符数限制而截断了字符串。 **如果字符串是图像存储在数据库中，则使用程序检索它而不使用任何工具**

我在使用 .net 和 MSSQL 时遇到了同样的问题，通过使用 webservice 和 Java 客户端，我尝试了所有转换和库，包括轴和 util jpg。

# python-3.x - Python 3 无法使用 big5 解码 \xBD\xC6\xBB\x73

> ID：10143139
> 
> 赞同：0
> 
> 时间：2012-04-13T14:52:47.403
> 
> 标签：python-3.x, big5

我正在从数据库中读取 SQLASCII 字符串，并且遇到了一些基于我声明的 big5 编码未正确解码的字节。下面是简化的问题。python的big 5编码表似乎不知道如何解码这两个字符。据我所知（我不是专家），这些都是有效的汉字，因为我可以使用 Notepad++ 并更改编码以将它们显示为汉字。我将它们在 Notepad++ 中的样子与这个网站进行了比较，字符匹配，所以我假设它们是 big5 编码表的有效字节。

[http://ash.jp/code/cn/big5tbl.htm](http://ash.jp/code/cn/big5tbl.htm)

```
by = b'\xBD\xC6\xBB\x73'
print(by,len(by))
print(by.decode('big5')) 
```

b'\xbd\xc6\xbbs' 4

回溯（最后一次调用）：文件“qtest1.py”，第 15 行，in print(by.decode('big5')) 文件“C:\Python32\lib\encodings\cp1252.py”，第 19 行，in编码返回 codecs.charmap_encode(input,self.errors,encoding_table)[0] UnicodeEncodeError: 'charmap' codec can't encode characters in position 0-1: character maps to

非常感谢任何帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T17:09:58.760

仔细看：那是`UnicodeEncodeError`- 它无法*编码*，而不是解码。另请查看它正在使用的模块：`...\lib\encodings\cp1252.py`. 所以有些东西正试图将文本编码为 cp1252。

事实上，解码为 big5 工作正常 - 我可以运行您的确切代码并获取中文字符[1]。问题是您的终端 - Python 尝试使用您的 Windows 代码页 (cp1252) 对中文字符进行编码，但它不知道如何处理它们。您应该能够将它们写入以合适的编码（UTF-8 或 big5）打开的文件，或者对它们执行任何您需要的操作，只是不要将它们写入终端。

[1] 大多数 Linux 终端使用 UTF-8，因此任何字符都可以使用。

# forms - 是否有任何浏览器支持输入元素的表单属性？

> ID：10143140
> 
> 赞同：11
> 
> 时间：2012-04-13T14:52:47.497
> 
> 标签：forms, html

HTML5 规范允许[表单](http://dev.w3.org/html5/spec/forms.html#form-associated-element)[关联`<form>`元素](http://dev.w3.org/html5/spec/association-of-controls-and-forms.html#attr-fae-form)通过`[form]`属性引用它们的关联元素。是否有任何浏览器本机支持此功能？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-13T15:03:38.907

看：

*   [http://www.impressivewebs.com/html5-form-attribute/](http://www.impressivewebs.com/html5-form-attribute/)
*   [http://swatelier.info/at/forms/HTML5attrib.asp](http://swatelier.info/at/forms/HTML5attrib.asp)

自 Firefox 4、Opera 9.5、Safari 5.1 和 Chrome 10 起支持该`form`属性，但在 IE 上尚不支持。

这是一个测试页面：

[http://www.impressivewebs.com/demo-files/html5-form-attribute/](http://www.impressivewebs.com/demo-files/html5-form-attribute/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T15:05:24.433

> Opera 9.5+、Safari 5.1+、Firefox 4+、Chrome 10+

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T21:26:01.493

Chrome v25 似乎无法识别 form 属性的使用。如果表单名称/id 与表单属性的值不匹配，则包含“form='xxx'”元素的表单将不会显示在该表单的提交内容中。此外，如果表单属性包含两个表单名称，它根本不会显示，即使其中一个名称与表单的名称/ID 匹配。奇怪的行为。

# cocos2d-iphone - cocos2d - 读取 CCRenderTexture 的数据

> ID：10143143
> 
> 赞同：0
> 
> 时间：2012-04-13T14:53:05.533
> 
> 标签：cocos2d-iphone

我正在使用下面的代码来刮掉纹理。但我不确定如何检测划伤纹理的百分比。例如，当用户划伤 80% 时，它应该会淡出。谁能帮我这个？

```
-(id) init
{
if( (self=[super init] ))
    {
    CGSize size = [[CCDirector sharedDirector] winSize];

    [self setIsTouchEnabled:YES];
    reset = YES;

    bg = [CCSprite spriteWithFile:@"background.png"];
    bg.position =  ccp( size.width /2 , size.height/2 );
    [self addChild:bg z:1];

    burnSprite = [CCSprite spriteWithFile:@"fire.png"];
    [burnSprite setBlendFunc:(ccBlendFunc) { GL_ZERO, GL_ONE_MINUS_SRC_ALPHA }];
    [burnSprite retain];
            burnSprite.scale = 0.7f;

    // Scratch Background
    scratchBg = [[CCSprite spriteWithFile:@"scratchBg.png"] retain];
    scratchBg.position = ccp(size.width / 2, size.height / 2);

    // Scratch Layer
    scratchLayer = [CCRenderTexture renderTextureWithWidth:size.width height:size.height];
    scratchLayer.position =  ccp(size.width / 2 , size.height / 2);
    [[scratchLayer sprite] setBlendFunc: (ccBlendFunc) { GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA }];

    [self addChild:scratchLayer z:2];

    [self schedule: @selector(tick:)];
 }
return self;
}

 - (void) drawTexture 
{

// Update the render texture
[scratchLayer begin];

// Limit drawing to the alpha channel
glColorMask(0.0f, 0.0f, 0.0f, 1.0f);

// Draw
[burnSprite visit];

// Reset color mask
glColorMask(1.0f, 1.0f, 1.0f, 1.0f);

[scratchLayer end];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T19:46:59.487

这个问题已经出现在 cocos2d-iphone 论坛上。 [http://www.cocos2d-iphone.org/forum/topic/12557](http://www.cocos2d-iphone.org/forum/topic/12557)

可以在此处找到用于解决您的问题的示例代码的一个很好的示例。 [http://abitofcode.com/2012/04/ccrendertexture-category-percentage-complete/](http://abitofcode.com/2012/04/ccrendertexture-category-percentage-complete/)

# python - python脚本发送电子邮件，如何捕获并显示发送电子邮件的错误？

> ID：10143153
> 
> 赞同：2
> 
> 时间：2012-04-13T14:53:31.290
> 
> 标签：python

我有一个非常简单的 python 脚本可以发送电子邮件，如下所示：

```
import smtplib

from email.MIMEText import MIMEText

msg = MIMEText("test email")
msg['Subject'] = // ... yada yada 

for iIndex in range(0,200):
  s = smtplib.SMTP('smptserver')
  // send the email
  s.quit() 
```

我的问题是，通常 200 封电子邮件中有 1 封永远不会到达。我在控制台上没有看到任何错误消息，所以我假设电子邮件已发送到 SMTP 服务器，而 SMTP 服务器正在丢球。

但在我对 SMTP 人员进行错误处理之前，我想确保我没有在某处遗漏错误。

除了控制台之外，python 是否会输出错误消息？

谢谢，罗伯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T14:58:35.577

如果抛出错误，您会在控制台中看到一些内容。但是，您可以使用`SMTP.set_debuglevel()`任何真实值来解决此问题。这样做将显示“连接调试消息以及发送到服务器和从服务器接收的所有消息”。

# grails - 如何使用 grails 标记会话范围？

> ID：10143159
> 
> 赞同：1
> 
> 时间：2012-04-13T14:53:54.567
> 
> 标签：grails, gsp

我正在尝试在我的 gsp 上使用 g:set 标签。只要我在一页中并且范围是默认或页面，它就可以正常工作。当我试图将范围更改为会话时，它不起作用。

我的理解是，当范围为会话时，我不仅应该能够在该页面上访问该变量，而且还可以在其他页面上访问该变量，但是，我可能错了。

在一个全新的 2.0.3 应用程序中，我的 index.gsp 主体上有这个脚本，它按预期工作。

```
<g:set var="bar" value="${new Date() - 7}" scope="page" />
<div class="message" role="status">${bar}</div> 
```

但是，如果我将范围更改为会话它不起作用，

```
 <g:set var="bar" value="${new Date() - 7}" scope="session" />
    <div class="message" role="status">${bar}</div> 
```

不在任何其他页面上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T15:47:52.943

你有没有尝试过：

```
<div class="message" role="status">${session.bar}</div> 
```

[http://grails.org/doc/latest/guide/theWebLayer.html#variablesAndScopes](http://grails.org/doc/latest/guide/theWebLayer.html#variablesAndScopes)

# c# - 在 asp.net 中重置用户的安全信息 (Q&A)

> ID：10143160
> 
> 赞同：0
> 
> 时间：2012-04-13T14:53:58.850
> 
> 标签：c#, asp.net, security, passwords, asp.net-membership

我想通过调用ChangePasswordQuestionAndAnswer方法来更改用户的密码问答

```
MembershipUser user = Membership.GetUser(userName);
string password = user.GetPassword(); // error here
string sQuestion = DropDownList1.SelectedValue.ToString();
string sAnswer = txtAnswer.Text.ToString();
user.ChangePasswordQuestionAndAnswer(password, sQuestion, sAnswer); 
```

但我是管理员；我无法传递用户密码，因为我不知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:46:18.340

既然您已经要求用户输入数据，为什么不再次要求输入密码呢？然后您可以使用相同的代码，只需将密码设置为文本框的值。

```
string password = txtPassword.Text; 
```

另一种方法是自动重置密码，然后要求用户将其更改为更好的密码选择：

```
MembershipUser user = Membership.GetUser(userName);
string password = user.ResetPassword();
string sQuestion = DropDownList1.SelectedValue.ToString();
string sAnswer = txtAnswer.Text.ToString();
user.ChangePasswordQuestionAndAnswer(password, sQuestion, sAnswer); 
```

后者不是一个很好的解决方案，因为它需要在此代码之后执行其他步骤。

# vb.net - DirectShow VB.net 无法更改录制格式

> ID：10143161
> 
> 赞同：0
> 
> 时间：2012-04-13T14:54:09.040
> 
> 标签：vb.net, video, directshow, capture, directshow.net

我正在使用直接显示尝试将网络摄像头流捕获到我的 vb.net 程序中。这是运行的子程序：

```
Private Sub CaptureVideo()
            Dim hr As Integer = 0
            Dim sourceFilter As IBaseFilter = Nothing
            Try
                GetInterfaces()

                hr = Me.CaptureGraphBuilder.SetFiltergraph(Me.GraphBuilder)
                Debug.WriteLine("Attach the filter graph to the capture graph : " & DsError.GetErrorText(hr))
                DsError.ThrowExceptionForHR(hr)

                sourceFilter = FindCaptureDevice()

                hr = Me.GraphBuilder.AddFilter(sourceFilter, "Video Capture")
                Debug.WriteLine("Add capture filter to our graph : " & DsError.GetErrorText(hr))
                DsError.ThrowExceptionForHR(hr)

                hr = Me.CaptureGraphBuilder.RenderStream(PinCategory.Preview, MediaType.Video, sourceFilter, Nothing, Nothing)
                Debug.WriteLine("Render the preview pin on the video capture filter : " & DsError.GetErrorText(hr))
                DsError.ThrowExceptionForHR(hr)

                Dim pSink As DirectShowLib.IFileSinkFilter = Nothing
                Dim pMux As DirectShowLib.IBaseFilter = Nothing
                hr = Me.CaptureGraphBuilder.SetOutputFileName(DirectShowLib.MediaSubType.Avi, "c:\video\myvid1.avi", pMux, pSink)
                Debug.WriteLine("Set File : " & DirectShowLib.DsError.GetErrorText(hr))
                DirectShowLib.DsError.ThrowExceptionForHR(hr)

                hr = Me.CaptureGraphBuilder.RenderStream(DirectShowLib.PinCategory.Capture, DirectShowLib.MediaType.Video, sourceFilter, Nothing, pMux)
                Debug.WriteLine("Render the capture pin on the video capture filter : " & DirectShowLib.DsError.GetErrorText(hr))
                DirectShowLib.DsError.ThrowExceptionForHR(hr)

                Marshal.ReleaseComObject(sourceFilter)

                SetupVideoWindow()

                rot = New DsROTEntry(Me.GraphBuilder)

                hr = Me.MediaControl.Run()
                Debug.WriteLine("Start previewing video data : " & DsError.GetErrorText(hr))
                DsError.ThrowExceptionForHR(hr)

                Me.CurrentState = PlayState.Running
                Debug.WriteLine("The currentstate : " & Me.CurrentState.ToString)

            Catch ex As Exception
                MessageBox.Show("An unrecoverable error has occurred.With error : " & ex.ToString)
            End Try
        End Sub 
```

但是，当我换行时：

```
hr = Me.CaptureGraphBuilder.SetOutputFileName(DirectShowLib.MediaSubType.Avi, "c:\video\myvid1.avi", pMux, pSink) 
```

到

```
hr = Me.CaptureGraphBuilder.SetOutputFileName(DirectShowLib.MediaSubType.Asf, "c:\video\myvid1.wmv", pMux, pSink) 
```

我得到一个黑屏和一个错误：

![在此处输入图像描述](../Images/7be1f02b52779b1be2d737610cbabc84.png)

基本上我试图用 wmv 而不是未压缩的 AVI 录制（像 DiVX / xvid 之类的也可以）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T10:24:37.583

您需要先进行配置，然后才能尝试`WM ASF Writer`使用它来连接它。`RenderStream`有关详细信息，请参阅[将视频捕获到 Windows 媒体文件](http://msdn.microsoft.com/en-us/library/windows/desktop/dd318630%28v=vs.85%29.aspx)。

# javascript - 如何解决这个javascript函数

> ID：10143162
> 
> 赞同：1
> 
> 时间：2012-04-13T14:54:09.523
> 
> 标签：javascript, json

我正在调用这个函数

```
 el=DOM.create({tag:"div",css:{backgroundColor:"#000000",color:"green"},html:"abc"});
   $("#fb_dv").append(el); 
```

我的功能在这里

```
DOM={
    create:function(data){
        if(data.tag){
            d=document;
            doc=d.createElement(data.tag);
            for(var v in data){
                 if(v=="css"){
                     for(key in data[v]){
                        prop=doc.style;
                        prop.key=data[v][key]
                     }
                 }
                 if(v=="html"){
                     doc.innerHTML=data[v]
                 }
            }

            return doc;
        }
    }
} 
```

问题是这个函数没有设置css属性

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T14:59:03.533

问题出在应该设置样式的 for 循环中。您需要使用方括号语法来设置正确的属性：

```
for(key in data[v]){
    prop = doc.style;
    //prop.key = data[v][key]... change this to this:
    prop[key] = data[v][key];
} 
```

这是一个[工作示例](http://jsfiddle.net/4SxHG/)。

附带说明一下，您缺少很多`var`语句，因此所有变量都泄漏到了全局范围内，并且还缺少很多分号。

# random - 随机数生成

> ID：10143163
> 
> 赞同：1
> 
> 时间：2012-04-13T14:54:15.670
> 
> 标签：random

在一组 10 人生成的答案中生成 10 个不应该匹配的唯一数字的方法应该是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:06:38.937

这个有一个很好的解决方案。我假设您必须以随机方式将数字 1-10 分配给 10 个不同的人（但如果您有 10 个（或更多）不同的非连续数字，该原则也适用）。

*   排列数组中的数字。
*   使用混洗算法对数组中的元素进行混洗。
    *   （洗牌算法：[http](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle) ://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle ）
*   从数组中读取前 10 个值，将它们分配给十个人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T20:31:47.537

您可以使用操作系统工具来生成 GUID（全局唯一标识符）。

GUID 是一个 32 位的十六进制，如下所示：（`{21EC2020-3AEA-1069-A2DD-08002B30309D}`无耻地从[GUID 维基百科文章中](http://en.wikipedia.org/wiki/Globally_unique_identifier)窃取）。这使它成为一个 128 位的数字。现在，它有所有那些烦人的字符，但没有什么能阻止你删除无关字符并从十六进制转换并将其视为纯数字。

出于实际原因，您需要注意 128 位数字在某些语言（例如 C99）中有点笨拙。但是您仍然可以使用编译器扩展（GCC 有`__uint128_t`）或以其他方式处理它。

# java - java 类路径 unix

> ID：10143164
> 
> 赞同：0
> 
> 时间：2012-04-13T14:54:17.840
> 
> 标签：java, unix, classpath

> java -Djava.library.path=/usr/local/lib -classpath /usr/local/share/java/zmq.jar:. 客户端

在上面的例子中为什么会有“:.” 在类路径之后？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T14:56:06.030

[http://docs.oracle.com/javase/1.3/docs/tooldocs/win32/classpath.html](http://docs.oracle.com/javase/1.3/docs/tooldocs/win32/classpath.html)

“默认的类路径是当前目录。设置 CLASSPATH 变量或使用 -classpath 命令行选项会覆盖该默认值，因此如果要在搜索路径中包含当前目录，则必须在新路径中包含“.”设置。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:18:01.457

`:`冒号是类路径分隔符。

`.`句号是对当前目录的引用

```
-classpath /usr/local/share/java/zmq.jar:. 
```

因为类路径覆盖了对当前目录的默认引用，所以上面的行将 /usr/local/share/java/zmq.jar 和当前目录都添加到了类路径中。没有`:.`对当前目录的引用，JVM 就找不到 hwclient 类。

# android - 具有卫星视图和离线缓存的 Android 最佳 Maps API

> ID：10143167
> 
> 赞同：1
> 
> 时间：2012-04-13T14:54:22.567
> 
> 标签：android, caching, offline, android-maps

我从使用谷歌地图开始，但我需要在离线地图中显示地图的一部分，而谷歌地图不允许这样做。

所以，我需要一个包含两件事的 API：离线缓存（地图的一小部分）和卫星视图。

你能告诉我你对什么是最好的 API 的看法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:24:54.397

使用[ArcGIS](http://www.esri.com/software/arcgis/smartphones/develop.html) ... 制图和分析工具。它还为 Eclipse 的 Android 应用程序开发提供插件。

# properties - 注意：未定义的属性 - 如何在 PHP 中避免该消息？

> ID：10143172
> 
> 赞同：14
> 
> 时间：2012-04-13T14:54:36.747
> 
> 标签：properties, null, php-5.3

您好，我正在打这个电话：

```
$parts = $structure->parts; 
```

现在 $structure 只有特殊情况下的*部分*，所以调用返回 null。这对我来说很好，我的代码后面有一个*if($parts) {...} 。*不幸的是，在代码完成运行后，我收到了这条消息：

**注意：未定义的属性：stdClass::$parts in ...**

如何抑制此消息？

谢谢！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-04-13T14:59:59.527

该功能`isset`应该完全满足您的需求。

[PHP: isset - 手册](http://www.php.net/manual/en/function.isset.php)

例子：

```
$parts = (isset($structure->parts) ? $structure->parts : false); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-13T15:01:19.280

也许这个

```
$parts = isset($structure->parts) ? $structure->parts : false ; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-02-04T11:44:10.043

**在property_exists()**的帮助下，您可以轻松地从 php 文件中删除“未定义属性”通知。

以下是示例：

`if(property_exists($structure,'parts')){ $parts = $structure->parts; }`

了解更多[http://php.net/manual/en/function.property-exists.php](http://php.net/manual/en/function.property-exists.php)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-04-07T11:10:58.733

2020 年来到这里，惊讶地发现没有人提到：

1.[自 PHP 7.0 起](https://www.php.net/manual/en/migration70.new-features.php#migration70.new-features.null-coalesce-op)：

```
$parts = $structure->parts ?? false; 
```

2.一个[不受欢迎的做法](https://stackoverflow.com/a/36892995/6201440)- [stfu 运算符](https://www.php.net/manual/en/language.operators.errorcontrol.php)：

```
$parts = @$structure->parts; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-12-19T07:33:53.310

我已经为多级链接编写了一个辅助函数。假设您想做类似的事情`$obj1->obj2->obj3->obj4`，只要其中一个层未定义或为空，我的辅助函数就会返回空字符串，所以`$obj1->obj2->obj3->obj4`我的使用代替您`MyUtils::nested($obj1, 'obj2', 'obj3', 'obj4')`。同样使用这个辅助方法也不会产生任何**通知**或**错误**。从语法上讲，它不是最好的，但实际上非常舒适。

```
class MyUtils
{
    // for $obj1->obj2->obj3: MyUtils::nested($obj1, 'obj2', 'obj3')
    // returns '' if some of tiers is null
    public static function nested($obj1, ...$tiers)
    {
        if (!isset($obj1)) return '';
        $a = $obj1;
        for($i = 0; $i < count($tiers); $i++){
            if (isset($a->{$tiers[$i]})) {
                $a = $a->{$tiers[$i]};
            } else {
                return '';
            }
        }
        return $a;
    }
} 
```

# python - 使用 numpy/scipy 进行 6 度曲线拟合

> ID：10143174
> 
> 赞同：8
> 
> 时间：2012-04-13T14:54:40.130
> 
> 标签：python, numpy, scipy, curve-fitting, linear-regression

我对使用 6 次多项式插值非线性数据有非常具体的要求。我见过 numpy/scipy 例程（scipy.interpolate.InterpolatedUnivariateSpline），它只允许插值达到 5 级。

即使没有直接的函数可以做到这一点，有没有办法在 Python 中复制 Excel 的 LINEST 线性回归算法？LINEST 允许 6 度曲线拟合，但我不想将 Excel 用于任何事情，因为此计算是更大 Python 脚本的一部分。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-13T15:16:52.807

您可以使用[`scipy.optimize.curve_fit`](http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html)将您想要的任何功能（在合理范围内）适合您的数据。这个函数的签名是

```
curve_fit(f, xdata, ydata, p0=None, sigma=None, **kw) 
```

它使用非线性最小二乘拟合来拟合`f`数据的函数`ydata(xdata)`。在你的情况下，我会尝试类似的东西：

```
import numpy
from scipy.optimize import curve_fit
import matplotlib.pyplot as plt

def _polynomial(x, *p):
    """Polynomial fitting function of arbitrary degree."""
    poly = 0.
    for i, n in enumerate(p):
        poly += n * x**i
    return poly

# Define some test data:
x = numpy.linspace(0., numpy.pi)
y = numpy.cos(x) + 0.05 * numpy.random.normal(size=len(x))

# p0 is the initial guess for the fitting coefficients, set the length
# of this to be the order of the polynomial you want to fit. Here I
# have set all the initial guesses to 1., you may have a better idea of
# what values to expect based on your data.
p0 = numpy.ones(6,)

coeff, var_matrix = curve_fit(_polynomial, x, y, p0=p0)

yfit = [_polynomial(xx, *tuple(coeff)) for xx in x] # I'm sure there is a better
                                                    # way of doing this

plt.plot(x, y, label='Test data')
plt.plot(x, yfit, label='fitted data')

plt.show() 
```

这应该给你类似的东西：

![在此处输入图像描述](../Images/063ad17b356abb735bf5edda03fa81a7.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-13T15:24:32.433

使用 numpys polyfit 例程。

[http://docs.scipy.org/doc/numpy-1.3.x/reference/generated/numpy.polyfit.html](http://docs.scipy.org/doc/numpy-1.3.x/reference/generated/numpy.polyfit.html)

# git - 如何忽略 git 中的文件或目录，无论是跟踪、未跟踪还是提交的一部分

> ID：10143175
> 
> 赞同：4
> 
> 时间：2012-04-13T14:54:43.163
> 
> 标签：git, ignore, gitignore

我想完全忽略 git 存储库的一部分。该目录当前在存储库中被跟踪，我想确保

*   每当有人更改上游存储库中的内容时，即使我的副本也被更改，我也不会遇到任何合并冲突。
*   每当我更改其内容时，我所做的任何提交都不会反映这些更改

我并不特别关心实际内容。

问题出现在构建期间自动生成的文件中。不幸的是，有人碰巧将它们提交到存储库，但是当在与其创建者不同的机器上使用时，由于路径不同等原因，它们会导致构建错误，从而导致令人讨厌的合并冲突。

AFAIK，`.gitignore`不适用于此目的，因为它仅适用于未跟踪的文件。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-13T15:03:30.947

您可以轻松删除和取消跟踪`git rm`您想要使用的文件。如果文件是在构建过程中自动生成的，这似乎是您想要采取的路线。

但是，如果只有一个人的机器设置来正确生成这些文件，我相信存在更大的问题。但是做你想做的，这就是方法

开始忽略更改 `git update-index --assume-unchanged <dir>`

重新开始关心 `git update-index --no-assume-unchanged <dir>`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-13T15:14:39.103

如果文件应该永远不会进入存储库，请解决问题并正确执行...

1.  将文件/模式添加到`.gitignore`文件中
2.  从存储库中删除不需要的文件
3.  提交以*取消跟踪*不需要的文件并提交`.gitignore`
4.  推动改变

而且您将永远不必再次处理那些不需要的文件，因为`.gitignore`将避免`git add`这些文件的未来（除非`--force`d）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-20T08:45:12.707

**上面的所有答案都无法处理在 gitignoring 和删除不需要的文件之前**已经分裂的分支，并且包含对这些文件进行**更改的提交。**这样的分支只会坐在那里等待机会对合并或变基造成严重破坏。

实际上，除了从一开始就使用 .gitignore 中不需要的文件从头开始重新创建所有存储库之外，没有其他解决方案。取消跟踪的东西在 git 中被彻底破坏了。

Git 无法模拟用户没有使用**千里眼**的简单现实，而且显然**不知道**一个甚至还没有创建的框架会创建什么样的不跟踪（临时 | 中间 | 缓存 | 不管）尚未编写，但将在将来的某个时候纳入项目中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-17T09:09:18.110

您可以在 .gitignore 文件的开头尝试以下行：

```
!.gitignore 
```

我认为这应该迫使 git 忽略列出的冷杉/文件。我不知道这是最好的方法，但它适用于我的情况。例如

```
!.gitignore
my_dir/
some_dir/ 
```

注意：当然你应该 git add 和 commit .gitignore 而不是 push to origin。

# c# - 一个关于 ExecuteScalar 的错误，我无法弄清楚

> ID：10143181
> 
> 赞同：1
> 
> 时间：2012-04-13T14:55:12.550
> 
> 标签：c#, sql-server

我正在用可视化 C# 制作一个程序，我在其中提取数据并将其放入 dataGridView 中。这一切都很好，但如果我之后尝试提取更多数据（我想放入文本框的数据），则会出现错误。

这是我提取数据并将其放入 dataGridView 的部分：

```
SqlConnection connect;
DataSet ds1 = new DataSet();
SqlDataAdapter da;

connect = new SqlConnection();
connect.ConnectionString = "Data Source=THEPC-PC\\SQLExpress;Initial Catalog=DataBase;Integrated Security=True";

string sql = "SELECT * FROM table WHERE column = '" + comboBox.Text + "'";
da = new SqlDataAdapter(sql, connect);
da.Fill(ds1, "table");
the_data_dataGridView.AutoGenerateColumns = false;
the_data_dataGridView.DataSource = ds1.Tables["table"];
connect.Open();
connect.Close(); 
```

以下代码是我在上一个查询之后尝试进行的下一个查询。它在显示“ExecuteScalar”的第 3 行显示此错误：

> “string”不包含“ExecuteScalar”的定义，并且找不到接受“string”类型的第一个参数的扩展方法“ExecuteScalar”（您是否缺少 using 指令或程序集引用？）

```
SqlCommand sql2 = new SqlCommand("SELECT COUNT(column) FROM table WHERE column = '" + comboBox.Text + "'", connect);
connect.Open();
int the_result = System.Convert.ToInt32(sql.ExecuteScalar());
the_result_textBox.Text = the_result.ToString();
connect.Close(); 
```

两段代码在不同的形式下都可以正常工作。但显然不会一个接一个地工作。现在我确定我在这里做了一些非常愚蠢的事情，但无法弄清楚。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-13T14:56:35.047

那是因为 sql 是一个类型字符串。您在第一个示例中这样声明它。

```
string sql = "SELECT * FROM table WHERE column = '" + comboBox.Text + "'"; 
```

我想你想在 sql2 上调用 ExecuteScalar。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:58:08.920

尝试：

```
int the_result = System.Convert.ToInt32(sql2.ExecuteScalar()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T14:58:09.880

可能想这样做

```
sql2.ExecuteScalar() 
```

# java - 根据国家习惯格式化日期

> ID：10143188
> 
> 赞同：2
> 
> 时间：2012-04-13T14:55:42.957
> 
> 标签：java, date, time, format, simpledateformat

我们创建 J2SE 应用程序，该应用程序必须根据用户来自的国家/地区的自定义设置日期和时间的格式。我想问如何在Java中解决这个问题？可能我会使用 SimpleDateFormat，但我想知道是否有可能以某种更简单的方式获取格式字符串，而不是分别为每个国家/地区提供所有格式字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:00:39.823

`DateFormat` *已经*允许您这样做 - 只需使用[`DateTimeFormat.getDateTimeInstance(dateStyle, timeStyle, locale)`](http://docs.oracle.com/javase/7/docs/api/java/text/DateFormat.html#getDateTimeInstance%28int,%20int,%20java.util.Locale%29)或类似的东西，具体取决于您的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-07-18T16:38:51.190

# *java.time*

`java.util`日期时间 API 及其格式化 API已`SimpleDateFormat`过时且容易出错。建议完全停止使用它们并切换到[现代 Date-Time API](https://www.oracle.com/technical-resources/articles/java/jf14-Date-Time.html) ^*。

**使用`java.time`现代日期时间 API 的解决方案：**

用于[`DateTimeFormatter.#ofLocalizedDate`](https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html#ofLocalizedDate-java.time.format.FormatStyle-)获取 ISO 年表的区域设置特定日期格式。

**演示：**

```
import java.time.LocalDate;
import java.time.ZoneId;
import java.time.format.DateTimeFormatter;
import java.time.format.FormatStyle;
import java.util.Locale;

public class Main {
    public static void main(String[] args) {
        DateTimeFormatter dtfDateFull = DateTimeFormatter.ofLocalizedDate(FormatStyle.FULL)
                .localizedBy(new Locale("cs", "CZ"));
        DateTimeFormatter dtfDateMedium = DateTimeFormatter.ofLocalizedDate(FormatStyle.MEDIUM)
                .localizedBy(new Locale("cs", "CZ"));
        DateTimeFormatter dtfDateShort = DateTimeFormatter.ofLocalizedDate(FormatStyle.SHORT)
                .localizedBy(new Locale("cs", "CZ"));

        LocalDate date = LocalDate.now(ZoneId.of("Europe/Prague"));

        System.out.println(date.format(dtfDateFull));
        System.out.println(date.format(dtfDateMedium));
        System.out.println(date.format(dtfDateShort));
    }
} 
```

**示例运行的输出：**

```
neděle 18\. července 2021
18\. 7\. 2021
18.07.21 
```

[`ONLINE DEMO`](https://ideone.com/3b2hkQ)

**[从Trail: Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html)**了解有关现代日期时间 API 的更多信息。

* * *

^(* 出于任何原因，如果您必须坚持使用 Java 6 或 Java 7，则可以使用[***ThreeTen-Backport，***](http://www.threeten.org/threetenbp/)它将大部分*java.time*功能向后移植到 Java 6 和 7。如果您正在为 Android 项目和 Android API 工作level 仍然不符合 Java-8，请检查[Java 8+ APIs available through desugaring](https://developer.android.com/studio/write/java8-support-table)和[How to use ThreeTenABP in Android Project](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)。)

# mysql - 在mysql的列底部显示总和

> ID：10143190
> 
> 赞同：3
> 
> 时间：2012-04-13T14:55:59.667
> 
> 标签：mysql

除了使用Union查询之外，还有其他方法，而不是使用下面的查询在底部显示一列的总和

```
 select amount 
from receipt

UNION

select SUM(amount)
from receipt 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T14:57:52.097

[WITH ROLLUP](http://dev.mysql.com/doc/refman/5.0/en/group-by-modifiers.html)应该完全执行您正在执行的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T14:58:57.857

另一种选择是使用`SUM()`和`GROUP BY()`

见：[http ://dev.mysql.com/doc/refman/5.0/en/group-by-modifiers.html](http://dev.mysql.com/doc/refman/5.0/en/group-by-modifiers.html)

```
SELECT year, SUM(profit) FROM sales GROUP BY year 
```

这为您提供了没有 UNION 的年度利润。您还可以添加条件，就像在`COUNT()`

# ruby-on-rails - 没有路线匹配 [GET] "/images/rails.png"

> ID：10143195
> 
> 赞同：0
> 
> 时间：2012-04-13T14:56:06.953
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku

我收到错误：

> 没有路线匹配 [GET] "/images/rails.png"

我在我的`application.rb`：

```
config.assets.initialize_on_precompile = false
config.serve_static_assets = false 
```

为什么我会收到此错误？它发生在 localhost 和 Heroku 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:00:17.087

Heroku 是一个只读文件系统。您需要将 application.rb 设置为如下所示：

```
Bundler.require(*Rails.groups(:assets => %w(development test)))
config.assets.compile = true
config.serve_static_assets = true 
```

# javascript - 弹出 JS 画廊图像被重复

> ID：10143198
> 
> 赞同：0
> 
> 时间：2012-04-13T14:56:14.673
> 
> 标签：javascript, jquery, fancybox, categories, prettyphoto

[http://2012.delineamultimedia.com/delinea_new_12.html#home_portfolio_botm_bg](http://2012.delineamultimedia.com/delinea_new_12.html#home_portfolio_botm_bg)

这个投资组合模板有一个部分，其中包括一个看起来像是 HTML 模板的 wordpress 插件（这是我正在使用的所有 html、css 和 js，没有 wordpress）...插件看起来是在复制 fancybox 和 prettyPhoto与“rel”属性关联的弹出图像。如果您单击“第 1 个图像”图标，您将看到 prettyPhoto 与此弹出窗口相关联，并且当在标记中我仅链接到 1 个图像时，它在图库中显示 2 个图像。

我发现这个脚本上的行...http://2012.delineamultimedia.com/js/script.js 这是页面上的第一行之一。

```
$('.image-grid_' + (i+1) ).fGallery('.filter_' + (i+1) ); 
```

这个循环接缝似乎导致了这个问题。有没有办法改变这个循环以不复制弹出图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:19:46.353

这个脚本[2012.delineamultimedia.com/js/fGallery.js](http://2012.delineamultimedia.com/js/fGallery.js)正在克隆你的图像，所以这就是为什么它们在 fancybox 或 prettyphoto 中被复制：

```
var clone = element.clone().appendTo(element.parent()).attr('id','grid_clone'); 
```

原始图像在下面`<ul id="image-grid"...`，克隆图像在下面`<ul id="grid_clone" ...`

# ruby-on-rails - 对实例对象执行搜索

> ID：10143202
> 
> 赞同：1
> 
> 时间：2012-04-13T14:56:34.893
> 
> 标签：ruby-on-rails

我有以下代码：

```
 @anatomy = Anatomy.find_by_sql(" some long sql here") 
```

我想对@anatomy 结果集进行搜索。

我尝试了下面的代码，但它似乎不起作用。

```
@anatomy_subset = @anatomy.find :first, :conditions => ["public_id = ?", public_id ] 
```

它给了我：

```
wrong number of arguments (2 for 1) 
```

如何在 @anatomy 实例对象上搜索某些内容？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T14:59:46.543

您不能在 SQL 服务器之外进行 SQL 搜索，请改为执行以下操作：

```
subset = @anatomy.select { |entity| entity.public_id == public_id } 
```

# git - Windows 2003 服务器上的 git pull 非常慢（不是 ssh 传输部分）

> ID：10143204
> 
> 赞同：4
> 
> 时间：2012-04-13T14:56:41.493
> 
> 标签：git, msysgit, git-extensions

我遇到了特定服务器的问题，希望能在调试方面提供帮助。

运行 git 版本 1.7.10.msysgit.1 作为 git 扩展 2.3.1 Windows 2003 Standard R2 SP2 的一部分安装。还安装了 cwRsync（基于 Cygwin 1.7）。Trend AV 正在运行（因为它是一台工作机器，所以不能更改它）。服务器是一个 VMWare 虚拟机，并且负载合理。

主要问题是 git pull（来自 git 扩展或 git bash）即使对于非常小的存储库（600k 和 26 个文件）也需要几分钟。CPU 负载在持续时间内上升到接近 100%（在 1 个 CPU 上）。任务管理器将此负载归因于“系统”。git.exe 的内存和 CPU 保持不变（并且很低）。

一般来说，git 最初在服务器上做任何事情都很慢。我通过更改 $PS1 以删除 __git_ps1 显着改善了这一点。在这个 git clone、git push 之后，本地 git 操作仍然相当缓慢（每个 5-10 秒），但至少它几乎可以使用。（我 90% 的时间都是基于 linux 的，所以期待超快的速度！）

git pull 期间的数据包捕获显示 SSH 通信在整个过程中发生了 80%，并且只持续了几秒钟（正如您在一个好的系统上所期望的那样）。功能上 git pull 成功完成，没有报告错误。

使用 plink 手动使用 ssh 登录或提取文件似乎没问题，原始 ssh（捆绑） ssh 4.6p1 openSSL 0.9.8e 或最新替换 ssh 5.9p1 openSSL 0.9.8s 这种折扣任何网络或 SSH 相关方面。

系统日志或 git 扩展日志中没有任何内容指示任何错误。

我查看了 2 个已安装磁盘上的碎片整理。两者都需要去碎片化（10% 和 14%），一个 90% 已满，另一个有一些合理的空间。我无权进行碎片整理，但我尝试将 repo 克隆到两个磁盘上，但故障没有显着差异。

我对 Trend AV 持怀疑态度（但无法更改它以消除它），但我在另一台服务器上使用相同的存储库运行了相同的测试，而且速度非常快。

我怀疑 git 可能会扫描 $HOME（该帐户在 NetHood 子目录下有大量外部共享），但在单独的帐户下运行相同的测试，NetHood 中没有任何内容没有任何区别。

我知道这不是产品问题，但我已经没有想法了。鉴于我正试图说服有关公司迁移到 git - 公司服务器上的此类问题并不能完全帮助我的论点！

谢谢戴夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T19:57:27.950

这似乎是由 msysgit 使用古老的 OpenSSH 版本引起的。我认为这个人在这里解决了你的问题： [http](http://darrell.mozingo.net/2011/09/29/painfully-slow-clone-speeds-with-msysgit-gitextensions/) ://darrell.mozingo.net/2011/09/29/painfully-slow-clone-speeds-with-msysgit-gitextensions/ 我还没有按照他的指示，所以我必须报告这是否对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-02T17:46:44.933

帮助正在进行中，[提交 d637d1b](https://github.com/git/git/commit/d637d1b9a8fb765a8542e69bd2e04b3e229f663b)（对于 git 1.9.x/2.0，2014 年第二季度）：

> 改进我们的哈希表，使其满足[msysgit`fscache`项目](https://groups.google.com/forum/#!topic/msysgit/fL_jykUmUNE)的需求，并带来一些不错的性能改进。

`git status`并且`git clone`应该从这个新的[hasmap API](https://github.com/git/git/blob/d637d1b9a8fb765a8542e69bd2e04b3e229f663b/Documentation/technical/api-hashmap.txt)中得到提升。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-09T16:06:05.697

我遇到了同样的问题，将 msysgit 升级到最新版本（1.9.5 Preview 20141217）解决了这个问题。

# iphone - iPhone - 打开地图并放置带有非英文标题的图钉

> ID：10143205
> 
> 赞同：0
> 
> 时间：2012-04-13T14:56:43.580
> 
> 标签：iphone, google-maps, ios5, maps, location

这个问题似乎是重复的，但事实并非如此。

我想打开地图应用程序并在某个位置放置一个带有非英文标题（比如阿拉伯语）的图钉。我使用以下网址：

```
http://maps.google.com/maps?q=Title@30.036814,31.213998 
```

这个网址有效。但是，如果“标题”（写在 q= 之后的那个）是一个阿拉伯字符串，则没有任何帮助。有解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:19:23.933

我发现最可靠的方法是首先[对您的阿拉伯语进行 URL/百分比编码](http://www.motobit.com/util/url-encoder.asp)，然后替换`Title`为 %xx%yy 混乱。

例如：

[http://maps.google.com/maps?q=%D9%89+%D8%A7%D9%84%D8%AD%D8%AF%D9%88%D8%AF+%D8%A8%D9% 8A%D9%86+%D8%A7%D9%84%D8%B3%D9%88@30.036814,31.213998](http://maps.google.com/maps?q=%D9%89+%D8%A7%D9%84%D8%AD%D8%AF%D9%88%D8%AF+%D8%A8%D9%8A%D9%86+%D8%A7%D9%84%D8%B3%D9%88@30.036814,31.213998)

另一种选择是跟随您的`Title`链接，并在页面的搜索栏中（不是浏览器 URL）替换`Title`为常规阿拉伯语。然后，您可以单击链接图标。但我发现这种方法有时不会在地图上显示标记。

# windows - QFileInfo::isWritable() 在 Windows 7 上以完全权限返回 false

> ID：10143207
> 
> 赞同：2
> 
> 时间：2012-04-13T14:56:46.237
> 
> 标签：windows, qt, file-permissions

```
QFile file(filePath);
QFileInfo fileInfo(file);

file.open(QIODevice::ReadWrite); //or WriteOnly

if(!fileInfo.isWritable())
{
    //Log error
}
else
{
    //Save to file
} 
```

问题是，文件路径具有完全访问权限，文件已创建且可写，但 isWritable() 仍返回 false。如果我删除写访问检查并简单地写入文件，则写入成功。QFile::open 也返回 true。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:29:25.817

`QFileInfo::isWritable()`不是检查打开的文件是否可写，而是检查当前用户对该文件的权限。如果您只想查看打开文件操作是否成功，请检查 call 的返回值`QFile::open()`。如果它返回 true，则文件已准备好写入。如果返回 false，请进行错误处理。

我不知道为什么`isWritable()`在你的情况下失败。可能是 Windows 认为该文件已打开，因此无法从另一个`open()`调用中写入。如果您真的想检查权限，请`isWritable()`在打开文件之前调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:41:38.283

尝试以管理员身份运行您的程序（右键单击它）。也许这个问题是由 UAC 引起的。

# c# - SQL Server - 一列上的 DISTINCT

> ID：10143210
> 
> 赞同：0
> 
> 时间：2012-04-13T14:56:56.340
> 
> 标签：c#, asp.net, sql-server, web-services

我有一个查询，我在哪里加入 3 个关系....A，B &。加入是在一个唯一的 id 上。表 B 包含彼此相似的行，我想对表 B 中的 FK 列（来自 A 的 PK）执行 DISTINCT。

为了更清楚地说明这一点：

```
 A              B           C
---------      ---------   ---------
No. (PK)       Id(PK)       Id (PK)
Name           Role         Address
               No.(FK)      No.(FK) 
```

表 B 可以有来自表 A 的多个人员实例。我想要一个查询，该查询从 A、B 和 C 中提取字段，并加入 No. 字段。表 B 可以有几行与 No. 列的值相同，因此我想对 No. 列执行 DISTINCT。

我怎样才能做到这一点？

**示例数据：**

```
NAME          ROLE       ADDRESS
---------------------------------------
John Smith    Manager    1, The Village
Dawn French   Secretary  2, The City
John Smith    SQL Dev    1, The Village
Terry Tibbs   HR Manager 8, The Road 
```

这是连接关系 A、B 和 C 的示例：

```
 SELECT A.Name, B.Role, C.Address 
 FROM A, B, C 
 WHERE A.No = B.No AND B.No = C.No 
```

表 B 可能包含几个具有多个角色的 John Smiths（同一个人）-> 因此我想在唯一标识一个人的编号上做一个 DISTINCT。这是表 A（编号）的 ePK。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T22:12:52.290

在您的解决方案中，一个人可能有多个角色和多个地址。“一列 DISTINCT”需要子查询技巧（正如其他人已经向您展示的那样）。但是，如果您的查询是显示每个人的主要（或只是其中之一）角色和主要地址，那么您的查询可能会简单得多。

```
SELECT
A.Name,
(SELECT TOP 1 Role FROM B WHERE B.No = A.No) AS PrimaryRole, -- you may add ORDER BY here
(SELECT TOP 1 Address FROM C WHERE C.No = A.No) AS PrimaryAddress, -- add ORDER BY
FROM A
ORDER BY A.Name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:06:24.963

听起来您想在否列上使用 group by 来总结您的结果。问题是当编号值相同时，您想对其他列中的不同值做什么？

一种解决方案可能是：

```
select a.No, a.Name, 
b.MinRole, b.MaxRole, b.RoleCount,
c.Address
from a 
join (
  select b.No, Min(b.Role) as MinRole, Max(b.Role) as MaxRole, 
  Count(distinct b.Role) as RoleCount
  from b group by b.No
) as b on a.No = b.No
join c on a.No = c.No 
```

这假设 a.No 在 a 中是唯一的，并且 a 和 c 在 No 上具有 1 比 1

# javascript - 复选框的Javascript innerhtml

> ID：10143211
> 
> 赞同：1
> 
> 时间：2012-04-13T14:56:56.967
> 
> 标签：javascript, checkbox, innerhtml, getelementbyid

好吧，我有一些 id='0','1','2','3' 等的复选框。所以我需要获取复选框的文本。这是PHP中复选框的代码。

```
'<input id="'.$i.'"type="checkbox" name="option1" value="a1" onclick="checkYears()">'.$years[$i].'</input> 
```

所以我需要得到 $years[$i]-value。我正在使用这段代码。

```
while (bool==false)
    {
        if (document.getElementById(i)!=null)
        {
            if (document.getElementById(i).checked)
            {
                years.push(1);
                yearsValue.push(document.getElementById(i).innerHTML);
                document.getElementById(i).innerText="WORKS";
                console.log(yearsValue[i]);
            }
            else
            {
                years.push(0);
                yearsValue.push(document.getElementById(i)).innerHTML);
                console.log(yearsValue[i]);
            }
        }
        else 
        {
            bool=true;
        }
        i++;
    } 
```

添加 0 和 1 可以，但是当我尝试使用 innerHTML 时，控制台中有未定义的值。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-13T15:00:10.897

InnerHTML 获取元素的 HTML*内容*。即开始标签和结束标签之间的数据。输入是空元素，它们不能有内容（在 HTML（与 XHTML 相对）中它们也不能有结束标记）。您的 HTML 无效，您应该使用[验证器](http://validator.w3.org)。

你可能想要这样的东西：

```
<label>
    <input type="checkbox">
    <span>Text label</span>
</label> 
```

然后你可以得到：

```
checkbox.parentNode.innerHTML; 
```

或者

```
checkbox.parentNode.getElementsByTagName('span')[0].innerHTML 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:58:20.583

输入元素没有 innerhtml，因为该元素应该是自闭合的：

`<input type="checkbox" name="checkbox" value="1" />`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T14:58:48.773

你不能因为`<input>`没有关闭标签，所以它没有`innerHTML`属性：

> 必须有开始标签，不能有结束标签。

来自[MDN](https://developer.mozilla.org/en/HTML/Element/Input)。

我建议您使用[标签](https://developer.mozilla.org/en/HTML/Element/Label)和输入的组合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T14:58:59.447

理想情况下，输入元素不会有任何 innerHTML。这意味着您不能在输入元素中包含封闭的 html 内容。你可以只拥有输入元素的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-18T08:48:32.170

正如所指出的，输入元素是自闭合的并且没有innerHTML。如果您想捕捉复选框元素旁边的纯文本，最好的解决方案是使用“nextElementSibling”和“innerText”。

```
<input type="checkbox" id="checkbox1"> <span>Text to get...</span>
<button onclick="getText()">Get Text</button> 
```

JavaScript：

```
function getText() {
     console.log(document.getElementById("checkbox1").nextElementSibling.innerText);
} 
```

# javascript - 从头开始：Javascript 还是 JQuery？

> ID：10143213
> 
> 赞同：-4
> 
> 时间：2012-04-13T14:57:07.713
> 
> 标签：javascript, jquery

> **可能重复：**
> [在学习 jQuery 之前学习 JavaScript 是个好主意吗？](https://stackoverflow.com/questions/668642/is-it-a-good-idea-to-learn-javascript-before-learning-jquery)

一般来说，我是 javascript 的新手。我可以编写做基本事情的基本函数，这很棒。我最近开始涉足 JQuery，因为它很时髦，而且做的事情很酷。例如，我在网站上使用了他们的验证插件，为我节省了大量时间。事情是我只是依靠预先编写的脚本来完成工作。我想了解更多信息，以便在出现问题时编写自己的自定义解决方案。所以我的问题是，在 Javascript 或 JQuery 上建立基础哪个更好。我知道 JQuery 本质上是一个 Javascript 对象，有很多很酷的方法，所以最好在普通的旧 Javascript 上学习绳索，因为我会更“全面”。还是我应该跳过前戏并坚持流行的时髦 JQuery？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T14:59:12.003

jQuery 是 JavaScript。在 JavaScript 中建立基础。

一旦您了解了原生 JavaScript 的来龙去脉，使用 jQuery 就会变得更有意义，并且当出现问题时，您将能够修复问题并构建自己的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:01:06.667

两个都。

如果您打算进行大量的 JavaScript 开发，那么您将希望学习 JavaScript 作为基础。您会想知道该语言是如何工作的，它的设计优势和劣势是什么，等等。您不一定需要能够编写自己的 jQuery 替代品，但最好了解您正在使用的工具.

如您所知，jQuery 是一个框架。它是由专家制作的工具，用于以干净且可维护的方式执行常见任务。框架也很高兴知道。您想了解构建它们的基础，但您也希望在工具带中拥有有用的工具来有效地完成工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T15:01:37.353

我认为你应该首先学习基本的 javascript，特别是关注好的和坏的实践，因为如果你不知道自己在做什么，很容易编写糟糕的 jQuery 代码。

例如，在 jQuery 中，DOM 操作非常简单明了，但是如果您不知道每次操作都会在性能方面付出代价，那么您的代码无论如何都可以工作，但它肯定不是一个好的且可重用的代码（在 jQuery 中）可重用性很重要，因为远距离你应该在插件中组织你的代码）

所以把时间花在语言上，尝试应用一些广泛使用[的良好实践](http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml)，当你开始对它们有信心时，试试 jQuery

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T15:03:28.780

如果您有空闲时间并且更专注于学习最佳实践，那么我建议您从没有任何库（如 jQuery）的普通旧 JavaScript 开始。如果您从 JavaScript 开始，那么您将学习实际的语言，您将能够区分什么是 JavaScript 和什么是 jQuery，并且（也许是我认为最重要的一点）最终您会遇到许多交叉- 多年来困扰 Web 开发人员的浏览器 JavaScript 问题。这将使您对整个场景有一个很好的了解，并使您成为更好的开发人员。

另一方面，如果您正在处理时间线或正在处理您最终想要发布和维护的东西，那么您应该使用 jQuery。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T15:00:10.183

需要注意的一件重要事情是 jQuery 是 javaScript。它不是一种单独的语言或任何其他类型的魔法，它只是一个库，您可以使用它来减少一些常见的 JavaScript 模式的痛苦。

所以这里真正的问题是，你应该使用 jQuery 还是只使用原生 js？这个问题的答案主要取决于您的环境。如果您正在编写个人网页，我肯定会使用 jQuery。如果您在公司环境中工作，可能需要跳过一些障碍才能自由使用 jQuery。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-13T15:02:40.200

我会推荐 jQuery 开始。它更容易，更跨浏览器。当您需要使用直接的 Javascript 时，您将学习它。例如，AJAX 与 jQuery 一起使用要容易得多，当 jQuery 已经为您完成了大部分工作时，我不会建议有人尝试实现他们自己的解决方案。这只是浪费时间。有些事情你会需要 Javascript，但是当你找到它们时——那是你应该学习它们的时候。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-13T14:59:26.253

**从 Javascript 开始！**不要使用 jQuery 来学习 Javascript，因为它只是一个库（尽管它非常流行）。如果您不从学习 vanilla Javascript 开始，您将永远无法学习如何正确编程。一旦你学会了 Javascript，jQuery 就会自己出现。但是，这不起作用。如果你学习 jQuery，Javascript 对你来说仍然是一个很大的谜。

# ios - 无法为 ios testflight 创建 ipa

> ID：10143217
> 
> 赞同：0
> 
> 时间：2012-04-13T14:57:28.820
> 
> 标签：ios, testflight

您好，我已按照链接中的步骤操作

[http://help.testflightapp.com/customer/portal/articles/402741-how-to-create-an-ipa-xcode-3-](http://help.testflightapp.com/customer/portal/articles/402741-how-to-create-an-ipa-xcode-3-)

在第 4 步，当我尝试弹出窗口时，我没有看到 testflight 图标。我还没有下载他们的sdk或任何东西。刚刚创建了一个帐户。当我将它保存到我的磁盘时。我有一个 somename.app 文件夹。我现在应该怎么做？请帮忙

谢谢萨明

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T08:30:11.697

这些说明是为 Xcode 3 编写的，Apple 不再支持它。

您应该升级到 Xcode 4。

# android - 将数据发送到可能已启动的另一个活动

> ID：10143222
> 
> 赞同：2
> 
> 时间：2012-04-13T14:57:36.013
> 
> 标签：android, android-activity

我有一个 BroadcastReceiver 用于将数据发送到另一个可能正在运行或未运行的活动。我在 onReceive() 方法中使用意图，并​​使用 putExtra() 放入数据。数据被发送到活动，但是，即使活动已经在运行并且在前台，活动的 onCreate() 方法也会被调用，所以我猜它正在创建一个新实例。我只想调用 onResume() ，或者如果它不存在，我可能还有其他方法可以创建/启动意图，如果存在，就让它“恢复”。现在，正在重新创建活动，我不希望这样。

```
public void onReceive(Context context, Intent intent) {
            intent.setClass(context, MyActivity.class);
            intent.putExtra("message", "the data here");
            //intent.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            Log.d("sending msg", "msg");    
            context.startActivity(intent);    
       } 
```

如果我不使用 FLAG_ACTIVITY_NEW_TASK，则会抛出 RuntimeException，特别告诉我，如果我想从非活动的东西开始活动，我必须使用`FLAG_ACTIVITY_NEW_TASK`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-13T15:07:18.850

如果您想将您可能正在运行的活动置于最前面，并完成可能在其之上的任何其他活动，您可以指定以下标志：

```
intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP); 
```

在这种情况下，当接收到此意图的活动已在运行时，`onNewIntent()`将调用该方法，而不是从头开始重新创建它。

如果您想在所需的活动运行时简单地重新排序活动（即将其移动到堆栈的顶部），请尝试以下操作：

```
intent.setFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:09:26.707

我认为您应该将 android:launchMode="singleTask" 添加到清单上的活动声明中，或者使用标志 FLAG_ACTIVITY_NEW_TASK 启动活动意图，该标志与 singleTask 完全相同

如果 Activity 已经存在于堆栈中的某个位置，则通过调用 onNewIntent() 而不是 onCreate() 将其置于最前面。

对不同的启动模式进行阅读。非常重要的基础！:D [http://developer.android.com/guide/topics/manifest/activity-element.html#lmode](http://developer.android.com/guide/topics/manifest/activity-element.html#lmode)

[http://developer.android.com/guide/topics/manifest/activity-element.html](http://developer.android.com/guide/topics/manifest/activity-element.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T17:23:59.533

我最终（在内部）重新广播了我的 BroadcastReceiver 进入的解析信息。活动，在代码中，为事件注册，并在私有创建的接收器中有一个小的处理程序方法。这是一个很好的解决方案，因为我知道在我的情况下此活动将始终运行。

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        receiver = new BroadcastReceiver(){

            @Override
            public void onReceive(Context context, Intent intent) {
                Log.d("activity", "in local defined receiver");
                if(intent.getAction().equals(CustomInternalSendSmsAction) )
                {
                    handlePassedData(intent);               
                }
            }
        };
        this.registerReceiver(receiver, new IntentFilter(CustomInternalSendSmsAction));
} 
```

# button - Tabpanel ExtJs 4中的合并工具栏

> ID：10143223
> 
> 赞同：4
> 
> 时间：2012-04-13T14:57:38.603
> 
> 标签：button, extjs, tabs, toolbar

我有一个带有两个选项卡的选项卡面板和一个顶部的工具栏，该工具栏有两个按钮，用于在选项卡的内容上实现某些功能（这些按钮对两个选项卡都是通用的）。有没有办法将这些按钮放置在与选项卡相同的面板/div 中，即选项卡的最右侧，以便在 ui 上节省一些空间？ [http://i.imgur.com/Flfpj.png](http://i.imgur.com/Flfpj.png)

```
title: 'Results',
layout: { type: 'fit', align: 'stretch' },
dockedItems: [{
    xtype: 'toolbar',
    dock: 'top',
    items: [{
                xtype: 'tbfill' // fills left side of tbar and pushes following items to be aligned to right
            },
            {
                xtype: 'label',
                text: 'Export to: '
            },
            {
                xtype: 'button',
                text: 'Excel',
                iconCls: 'icon-excel'
            },
            {
                xtype:'button',
                text:'PDF',
                iconCls:'icon-pdf'
            }],
    style: { padding: '8px' }
}],
 items:
    [{
    xtype: 'tabpanel',
    id: 'results-tabpanel',
    activeTab: 0,
    border: false,
    items: [{
        title: 'Results',
        id: 'result-tab',
        layout: { type: 'fit', align: 'stretch' },
        html: "Run a query to see results"
    },
        {
            title: 'Transactions',
            id: 'transactions-tab',
            layout: { type: 'fit', align: 'stretch' },
            html: "Run a query to see transactions"
        }]
}] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T17:46:13.077

试试这个：

```
var tabPanel = Ext.getCmp("results-tabpanel");
tabPanel.tabBar.addTool([
    {xtype: "tbfill"},
    {
        xtype: "label",
        text:  "Export to: "
    },
    {
        xtype: "button",
        text:  "Excel",
        iconCls: "icon-excel"
    },
    {
        xtype: "button",
        text:  "PDF",
        iconCls: "icon-pdf"
    }
]); 
```

# asp.net - 如果将绑定值评估为特定值，则在中继器网格中显示图像

> ID：10143228
> 
> 赞同：1
> 
> 时间：2012-04-13T14:58:08.450
> 
> 标签：asp.net, eval, asprepeater

我已经浏览了这里的问题，但似乎没有人回答我的问题。

我有一个 ASP.NET 中继器网格，它设置为绑定到一个列表，该列表显示该项目的值是什么。目前，它只显示变量的文本值，即OFF，但我想要它做的是显示适当的图像，即如果它关闭，则显示绿色图像，如果它打开，则显示红色图像。

这就是我在代码中尝试做的事情，假设你是在这里而不是 aspx.cs 做的？

```
<td><%# DataBinder.Eval(Container.DataItem, "Spill") == "OFF" ? %>
<asp:Image runat="server" ImageUrl="~/Images/green.JPG" /> 
<%:%> 
<asp:Image runat="server" ImageUrl="~/Images/red.JPG" /> %>
</td> 
```

编译器在 ? 之后抱怨 '%>' 和 : 之后的 '%>' 很明显我没有做对，但想不出还能怎么做。

感谢任何人提前帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T00:18:00.160

要在一行中的前端执行此操作，您可以执行以下操作：

```
<asp:Image id="imgSpill" runat="server" ImageUrl='<%# (DataBinder.Eval(Container.DataItem, "Spill") == "OFF" ? "~/images/red.jpg" : "~/images/green.jpg") %>' /> 
```

希望这可以帮助！祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:07:22.540

**标记：**

```
<asp:Image runat="server" 
   ImageUrl='<%# WhichImage(DataBinder.Eval(Container.DataItem, "Spill")) %>' /> 
```

**代码隐藏：**

```
protected string WhichImage(object spill)
{
    string result = "~/Images/green.JPG";
    string spillResult= (string)spill;
    if(!spillResult.Equals("OFF"))
    {
        result = "~/Images/red.JPG";
    }
    return result;
} 
```

# php - 单击时使用 jQuery POST 到 MySQL

> ID：10143231
> 
> 赞同：2
> 
> 时间：2012-04-13T14:58:15.793
> 
> 标签：php, jquery, mysql

我正在尝试使用 jQuery 将变量发布到 MySQL/PHP 查询。我有一个按钮，`class="button"`按钮代码是：

```
$(".button").click(function(e){
  e.preventDefault();
  $.post("some.php", { var_today : <?php echo $new_var; ?> });
}); 
```

使用：

```
if(isset($_POST['var_today'])){
echo $_POST['var_today'];
} 
```

在我的 php 页面上，我得到未定义的索引：var_today

类按钮标签`onclick="window.open('')`附有一个，一旦点击它，我会得到“未定义的索引”，因为`var_today`没有发布，我在这里写错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:02:20.917

您需要引用您的价值：

```
$.post("some.php", { var_today : "<?php echo $new_var; ?>" }, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:02:30.407

试试这个：

```
$(".button").click(function(e){
  e.preventDefault();
  $.post("some.php", { var_today: ""});
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:03:23.740

```
{ var_today : "<?php echo $new_var; ?>" } 
```

这应该有效。

# c# - 紧密循环中的线程池回调 - 100% CPU

> ID：10143233
> 
> 赞同：5
> 
> 时间：2012-04-13T14:58:21.010
> 
> 标签：c#, cpu, threadpool

我的算法中有一个方法可以在非常大的数据集上运行非常紧密的循环。我最初是单线程写的，这很好，但是花了很长时间。我现在想要加快速度，所以我现在使用 ThreadPool 来并行化工作。问题是这会导致我的 CPU 使用率达到 95-100%，这是我所预料的。然而，我的表现已经显着提高，但我认为如果我可以减少所有上下文切换，我可以做得更好。这也导致我的其他程序有点滞后，因为它们必须与线程争夺 CPU 资源。

我的问题是我应该怎么做？我唯一能想到的就是限制一次运行的线程数，但这可能会使我的算法变慢，因为一次只能运行几个线程。我也不想在我的线程中添加睡眠，因为我只需要算法尽快运行完成。

编辑：有几个人提到使用 TPL。我认为这是一个好主意，但不幸的是，我忘了提到我一直在使用 .NET 3.5，因为父应用程序尚未发布使用 .NET 4 的版本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-13T15:15:46.783

这都是关于资源管理的。您的程序当前占用了所有资源，因此其他程序对它们的访问权限减少。您需要平衡“我只需要算法尽快完成”部分与“这也导致我的其他程序有点滞后，因为它们必须与线程争夺 CPU 资源”。它们是相互排斥的；您不能让您的应用程序在特定机器上尽可能快地运行，同时也让其他应用程序保持完美响应。CPU在任何时间段内可以做的事情都是有限度的。

就效率提升而言，您可以做一些事情：

*   不要将 ThreadPool 用于超优化的线程算法。ThreadPool 非常适合简单的“开始执行此操作，让我知道您已完成”操作。但是，如果您希望进行优化，则可以避免使用 ThreadPool 添加额外级别的线程调度所固有的开销（在 CPU 和操作系统固有的开销之上）。您还可以对 ThreadPool 中的线程进行更有限的控制，这意味着诸如分配处理器亲和性（负载平衡）和优先级（给线程更多或更少的时间）之类的优化不可用。尝试创建简单的线程，或者查看 TPL，它有许多策略来完成多项任务（并非所有这些都首先需要线程）。

*   是的，您将希望能够“限制”线程数。这既是通过减少程序对它的需求来允许其他程序一些 CPU 时间，但正如我所说，多线程也存在固有的开销。经验法则是，如果 CPU 具有两倍以上的主动运行线程数，因为它具有“执行单元”（这些是 CPU 芯片上的物理内核，以及像超线程技术那样拆分一个内核的“逻辑处理器”）成两个），那么操作系统将花费更多的时间来调度线程并在它们之间切换（“缓存抖动”），而不是实际运行线程所花费的时间。更一般地说，存在收益递减规律，这将发展为“规模不经济”；最终，添加另一个线程将导致您的程序运行得比您没有使用该线程时更慢。是的，ThreadPool 可以为您处理最大线程数，但这可能是在您自己的算法中实现的各种功能中最简单的一个。

*   确保每个线程的工作都经过优化。寻找幼稚或低效的算法（我称它们为“ *O*（我的上帝）-复杂性”）并简化它们。大多数操作的效率都有一个下限（因操作类型而异），“过早优化是万恶之源”（不要以牺牲代码实际工作为代价来优化性能），但是了解在多线程环境中，您在运行一次算法时可以提高算法效率的任何收益都将乘以您运行它的次数，因此确保并行操作的效率是双重好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T15:15:01.297

如果您可以将您的主应用程序重写为一个`foreach`循环，`IEnumerable`您可以使用[PLINQ](http://msdn.microsoft.com/en-us/library/dd460688.aspx)来并行化您的循环。您可以使用[WithDegreeOfParallelism](http://msdn.microsoft.com/en-us/library/dd383719.aspx)来控制您的应用程序将使用多少个内核。您可以通过不使用计算机上的所有内核来防止您遇到的一些“滞后”。此外，您不必处理如何跨线程划分循环以避免不必要的资源争用。PLINQ 为您完成所有这些工作。

假设你有这个非常简单的单线程循环：

```
var arrayOfStuff = new[] { ... };
for (var i = 0; i < arrayOfStuff.Length; ++i)
  DoSomething(arrayOfStuff[i]); 
```

如果订购无关紧要，您可以使用 PLINQ 并行化它，使用的核心少于可用核心：

```
var cores = Math.Max(1, Environment.ProcessorCount - 1);
arrayOfStuff.AsParallel().WithDegreeOfParallelism(cores).ForAll(DoSomething); 
```

即使您的主循环更复杂，您也可以将其重写为一个迭代器块，然后您可以并行化：

```
IEnumerable<Stuff> GetStuff() {
  for ( ... very complex looping ... ) {
    ...
    yield return stuff;
  }
} 
```

# c# - ValueInjecter - 将多个结果集加入 1 个集合 LINQ？

> ID：10143241
> 
> 赞同：1
> 
> 时间：2012-04-13T14:58:47.667
> 
> 标签：c#, .net, linq, valueinjecter

如何将 ValueInjecter 与连接多个结果集的 LINQ 连接一起使用？例如，此代码将`result`值注入`CombinedResult`对象，但我也希望将一些`errorsAndWarning`值注入`CombinedResult`. 属性具有相同的名称：

```
var combined = from result in results.DeferredItems
               join errorsAndWarning in errorsAndWarnings.DeferredItems
                on result.MeetingID equals errorsAndWarning.MeetingID
               select new CombinedResult().InjectFrom(result) as CombinedResult; 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:14:45.367

用这个：

```
var combined = from result in results.DeferredItems
               join errorsAndWarning in errorsAndWarnings.DeferredItems
                on result.MeetingID equals errorsAndWarning.MeetingID
               select new CombinedResult().InjectFrom(result)
                                          .InjectFrom(errorsAndWarning)
                                          as CombinedResult; 
```

# javascript - 使用 jQuery 创建一个 DOM 元素

> ID：10143255
> 
> 赞同：4
> 
> 时间：2012-04-13T14:59:14.723
> 
> 标签：javascript, jquery, dom

我用 jQuery 创建了一个输入元素，如下所示：

```
var element = $('<input />', {
  name: name1,
  id: id1,
  type: 'text'
}); 
```

我想返回与之关联的 DOM 元素。但是，元素还不是 DOM。如何将其转换为 DOM 元素？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:01:14.700

您可以使用 `element[0]`或`element.get(0)`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-13T15:04:08.440

jQuery 返回一个类似数组的 DOM 元素对象。使用数组索引器将始终允许您获取特定元素，如下所示：

```
var domElement = element[0]; 
```

或者，jQuery为此提供了一个函数[`.get`](http://api.jquery.com/get/)：

```
var domElement = element.get(0); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T15:02:47.803

您可以检查此解决方案以使用 DOM 解析器。 [将 HTML 字符串转换为 DOM 元素？](https://stackoverflow.com/questions/3103962/converting-html-string-into-dom-elements)

或者只是使用一些原生 javascript 函数。 [使用内置 DOM 方法或原型从 HTML 字符串创建新的 DOM 元素](https://stackoverflow.com/questions/494143/creating-a-new-dom-element-from-an-html-string-using-built-in-dom-methods-or-pro)

# android - Android 如何将 AdView 对齐到线性布局的中心

> ID：10143258
> 
> 赞同：6
> 
> 时间：2012-04-13T14:59:22.800
> 
> 标签：android, listview, adview

我正在尝试将 gogole Adview 与列表的底部和中心对齐，直到现在我能够强制 Adview 位于列表的底部而不会干扰列表，但它没有进入 center 。

代码贴在下面，抱歉没有附上截图

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
    android:id="@+id/topLayout"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent" >

    <LinearLayout
        android:id="@+id/linearlayoutlistview"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_above="@+id/ad_holder"
        android:orientation="vertical" >

        <ListView
            android:id="@android:id/list"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginTop="2dip"
            android:drawablePadding="4dip"
            android:paddingTop="2dip"
            android:textAppearance="?android:attr/textAppearanceSmall"
            android:textStyle="bold"
            android:typeface="serif" >
        </ListView>
    </LinearLayout>

    <!-- Ad Placeholder -->

    <LinearLayout
        android:id="@+id/ad_holder"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:gravity="bottom" >

        <com.google.ads.AdView
            android:id="@+id/adView"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            ads:adSize="BANNER"
            ads:adUnitId="MY_AD_UNIT_ID"
            ads:loadAdOnCreate="true"
            ads:testDevices="TEST_EMULATOR" >
        </com.google.ads.AdView>

    </LinearLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-13T15:05:33.373

不要`LinearLayout`用作 AdView 的父级。相反，对 AdView使用`RelativeLayout`and ：`layout_centerInParent="true"`

```
<RelativeLayout
    android:id="@+id/ad_holder"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:gravity="bottom" >

    <com.google.ads.AdView
        android:id="@+id/adView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        ads:adSize="BANNER"
        ads:adUnitId="MY_AD_UNIT_ID"
        ads:loadAdOnCreate="true"
        ads:testDevices="TEST_EMULATOR" >
    </com.google.ads.AdView>

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-06-04T13:00:57.790

或者，`android:layout_width="fill_parent"`如果您仍想使用`LinearLayout`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T15:05:07.977

使用 `android:layout_alignParentBottom="true"`和`android:layout_centerHorizontal="true"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-08T23:11:50.263

或者你也可以使用 LinearLayout：

> 机器人：layout_gravity="center_horizo​​ntal"

# sharepoint - Chrome 中的 Sharepoint 模态对话框问题

> ID：10143261
> 
> 赞同：1
> 
> 时间：2012-04-13T14:59:28.633
> 
> 标签：sharepoint, google-chrome, modal-dialog

**场景：** 我在网页上有一个解决方案，并且我有一个 SharePoint Web 部件。该解决方案显示为 Iframe。在 Web 部件中，我有一个 SP 模态对话框。当我尝试通过 Web 部件弹出此模式对话框时，它位于解决方案 iframe 的后面。这只发生在 Chrome [并且很可能是 safari] 上，对于其他主要浏览器 IE 8/9、FF，它工作正常。

**到目前为止：** 我尝试调整 Z 索引，但这没有帮助。

任何帮助或建议表示赞赏。

# android - 为什么我在 Eclipse 中得到这个，这是一个错误吗？

> ID：10143262
> 
> 赞同：2
> 
> 时间：2012-04-13T14:59:34.437
> 
> 标签：android, eclipse

[辅助功能] 图片上缺少 contentDescription 属性

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:01:13.827

因为所有图像都应该有一个文本描述符。

它是为了辅助功能，因此有视觉障碍的人可以使用该应用程序（通过 Google 的辅助功能应用程序，该应用程序会在 UI 中读出视图的名称）

您应该添加文本，但如果您不想（在我看来不正确），您可以将其设置为“”。

[http://developer.android.com/guide/topics/ui/accessibility/apps.html](http://developer.android.com/guide/topics/ui/accessibility/apps.html)

# php - .htaccess 相对 mod_rewrite 路径 - 简化应用程序的部署

> ID：10143266
> 
> 赞同：0
> 
> 时间：2012-04-13T14:59:38.867
> 
> 标签：php, .htaccess, codeigniter, relative-path, absolute-path

每次需要部署 CodeIgniter 应用程序时，我都发现自己在为更改 .htaccess 中的路径而苦苦挣扎。所以; 我正在寻找一个合适的、良好的工作解决方案，无论实际项目的位置如何。

障碍：我的本地测试环境不是 localhost/ 而是 localhost/project。这很可能不会出现在实际环境中（更有可能/）。因此，我更喜欢无论如何都可以使用的解决方案。

我当前的.htaccess：

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    RewriteCond %{REQUEST_URI} ^system.*
    RewriteRule ^(.*)$ /project/index.php?/$1 [L]

    RewriteCond %{REQUEST_URI} ^application.*
    RewriteRule ^(.*)$ /project/index.php?/$1 [L]

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ /project/index.php?/$1 [L]
</IfModule>

<IfModule !mod_rewrite.c>
    ErrorDocument 404 /project/index.php
</IfModule> 
```

仅使用 index.php 作为路径是行不通的。它给了我一个 404 not found 错误。尝试了很多不同的组合，并希望看到您的建议。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T08:05:30.353

就我个人而言，我不喜欢您在 .htaccess 中拒绝系统和应用程序文件夹。

根据此处找到的“CI 最佳实践”指南 ( [http://codeigniter.com/forums/viewthread/125687/](http://codeigniter.com/forums/viewthread/125687/) ) - 您应该将您的应用程序和系统文件夹移出 public_html，只留下 index.php。然后不管人们尝试什么花哨的东西 - 他们无法从 http 访问您的应用程序和系统文件夹。

然后同时 - 这是我在所有项目中使用的 .htaccess 文件 - 不需要任何修改。它只是“有效”（对我来说）。

```
Options -Indexes
Options +FollowSymLinks

# Set the default file for indexes
DirectoryIndex index.php

<IfModule mod_rewrite.c> 
        # activate URL rewriting 
        RewriteEngine on  

        # do not rewrite links to the documentation, assets and public files 
        RewriteCond $1 !^(files|css|js|assets|uploads|captcha)

        # do not rewrite for php files in the document root, robots.txt                  
        RewriteCond $1 !^([^\..]+\.php|robots\.txt) 

        # but rewrite everything else   
        RewriteRule ^(.*)$ index.php/$1 [L]
 </IfModule>

 <IfModule !mod_rewrite.c>     
        # If we don't have mod_rewrite installed, all 404's
        # can be sent to index.php, and everything works as normal. 
        ErrorDocument 404 index.php 
  </IfModule> 
```

哦-我将它用于本地主机上的多个项目。即 localhost/project1 ， localhost/project2

只需将 htaccess 文件的副本放在每个项目的根目录中即可。我的根本地主机中没有这个文件

# jquery - 为什么 Jquery .load() 函数没有成功触发？

> ID：10143267
> 
> 赞同：0
> 
> 时间：2012-04-13T14:59:44.550
> 
> 标签：jquery, hyperlink, href

我制作了一个 jquery 函数，假设执行 3 个步骤

1.  onload 它应该替换所有链接文件的属性
2.  单击它时应将子页面加载到 $("#content")
3.  再次它应该重新触发将再次替换所有链接的功能

下面的代码工作到 2 个步骤，但不会触发第三步，它应该再次替换所有 url 我认为它也应该替换加载页面的链接？

```
$(document).ready(function(){
   var base_url = "http://localhost/dolphin/";
   $("a").each(function(e){
   if(this.href == "javascript:void(0)" || 
        this.href == base_url || 
        this.href == base_url + "index.php" || 
        this.href == "javascript:void(0);" || 
        this.href == "javascript:%20void(0)") {

     }else{
       page = 'Javascript:LoadPage(\''+ this.href + '\')';
       this.setAttribute('onclick',page);
       this.setAttribute('href', '#');
     }
   });
});

function LoadPage(url){
   $("#contentarea").load(url, function() {
     //after loading it should call redoIt() but it doesnt.
      redoIt();
   });
}

function redoIt(){
    var base_url = "http://localhost/dolphin/";
    $("a").each(function(e){
       if(this.href == "javascript:void(0)" || 
          this.href == base_url + "index.php" || 
          this.href == "javascript:void(0);" || 
          this.href == "javascript:%20void(0)") {

       }else{
         page = 'Javascript:LoadPage(\''+ this.href + '\')';
         this.setAttribute('onclick',page);
         this.setAttribute('href', '#');
       }
   });
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:11:10.417

你的调用`$.load`是在一个函数内部，据我所知，你没有在任何地方调用它，所以它没有被执行。把它拿出来，它应该可以正常工作

```
$("#contentarea").load(url, function() {

//after loading it should call redoIt() but it doesnt.
 redoIt();
}); 
```

# jquery - $.each 循环遍历我的 json 中的每个字符并显示 undefined

> ID：10143269
> 
> 赞同：0
> 
> 时间：2012-04-13T14:59:47.373
> 
> 标签：jquery, jquery-mobile

我需要遍历下面的 json，但下面的代码循环遍历我的 json 中的每个字符并显示“未定义”：（下面的 json 有什么问题吗？？？感谢您的帮助）

```
{"news_id":"1","news_title":"News Title One","news_date":"2012-03-20","news_pic":"album-bb[6].jpg","news_desc":"Here goes the news title one Here goes the news title one Here goes the news title one Here goes the news title one.","gallid":"3"}
{"news_id":"2","news_title":"News Title Two","news_date":"2012-04-14","news_pic":"174863_163190093755777_2032987021_q.jpg","news_desc":"News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two News Title Two.","gallid":"0"} 
```

这是我在点击事件时触发的代码：

```
var phpNews;
var NewsObject;

$(document).ready(function () {

    $("#btnNewsPage").click(function()
    {
        $.post("server/news.php",null,function(e){
            NewsObject = e;
            $.mobile.changePage("#NewsPage");
        });
    });

    $('#NewsPage').live('pagebeforeshow',function(event, ui){
        var list;
        $.each(NewsObject, function(k,v){
            list = v.news_title;
        });

        $("#displayNews").html(list);
    });

}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:12:39.790

看起来，你`NewsObject`的不是`JSON`对象而是字符串。这可能会发生，因为 JQuery 无法猜测响应类型，因此您可能需要`dataType`为您的`$.post`请求指定（[文档](http://api.jquery.com/jQuery.post/)）：

```
$.post("server/news.php", null, function(e){ ... }, 'json'); 
```

PS 另外，您`JSON`看起来无效，我希望看到类似的东西`{'a':'b'}`，但您有`{'a':'b'} {'c':'d'}`。

**更新。**根据下面的评论，我建议您使用下一个 PHP 代码`server/news.php`：

```
<?php 

require "../includes/config.php"; 
require "../includes/h.conn.php"; 
require "../includes/admin.id.php"; 

$strSQL = "select * from news where admin_id=" .$admin_id; 
$objRS = mysql_query($strSQL);
$News_Obj = array();

while ($row = mysql_fetch_assoc($objRS)) {
    $record = array (
               "news_id" => $row['news_id'], 
               "news_title" => $row['news_title'], 
               "news_date" => $row['news_date']
    );
    $News_Obj[] = $record; 
}

// don't forget to clear after yourself: mysql_free_result, disconnect

header("Content-type: application/json");
echo json_encode($News_Obj);
?> 
```

您还可以使用 Firebug 查看究竟返回了什么脚本以及在您发出请求时发生了哪些 HTTP 或 Javascript 错误。

# css - CSS 和 IE9：标签被错误解释

> ID：10143270
> 
> 赞同：0
> 
> 时间：2012-04-13T14:59:49.430
> 
> 标签：css, internet-explorer, fonts, tags

我正在做一个关于化学安全象形图的 MCQ 的小网站。

学生阅读问题，选择答案，验证并阅读另一页上的答案。

很简单。

正确答案用绿色书写，如果学生回答正确，还会出现绿色“正确答案”的信息。一个糟糕的选择会用红色写成“错误答案”。

该网站在 Firefox 上完全正确，但颜色和字体在 IE9 上显示不正确。

我在部分中使用标签：

```
<style>
  itsfalse {
    font-family: "Times New Roman",serif; 
    font-weight: bold; 
    color:#00A000;
  }
  itstrue { 
    font-family: "Times New Roman",serif; 
    font-weight: bold; 
    color:#FF0000;
  }
  goodans {
    font-family: "Arial",sans-serif; 
    font-weight: bold; 
    color: #00A000; 
    font-size:larger;
  }
  badans {
    font-family: "Arial",sans-serif;
    font-weight: bold;
    color:#FF0000;
  }
</style> 
```

For instance when the choice was right I'd have something like :

```
<itstrue>[the right answer]</itstrue> 
<goodans>Good answer!</goodans> 
```

正如我所说，Firefox 正确读取它，而 IE 读取标签之间的内容，但不使用样式。

如果我不使用 CSS 而是使用好的 ol' HTML 及其`<font></font>`，没问题，但它有点重。

PS 网站[http://hildoceras.fr/quizz](http://hildoceras.fr/quizz)（法语标签是 vrai、faux、bon、mau incorrect.php）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:04:29.007

我认为你的主要问题是你正在编造元素。一些浏览器会很好地解析它，而另一些浏览器会忽略为这些元素所做的任何样式声明。这就是 HTML5 shim 存在的原因。

尝试将标准 HTML 元素 ( `<p>`, `<div>`) 与“itstrue”和“goodans”等*类一起使用。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:06:07.597

你不应该使用自定义 HTML 标签，如果你这样做了，它就不再是 HTML。

坚持使用 HTML 并使用 CSS 类，如下所示：

```
 <style type="text/css"> 
    .itsfalse {font-family:"Times New Roman",serif; font-weight:bold; color:#00A000;} 
    .itstrue {font-family:"Times New Roman",serif; font-weight:bold; color:#FF0000;} 
    .goodans {font-family:"Arial",sans-serif; font-weight:bold; color:#00A000; font-size:larger;} 
    .badans {font-family:"Arial",sans-serif; font-weight:bold; color:#FF0000;} 
    </style>
    ...
    <span class="itstrue"> [the right answer] </span> 
    <span class="goodans">&nbsp;&nbsp;&nbsp;Good answer !</span> 
```

# c# - 使用捕获制作一组网络摄像头

> ID：10143272
> 
> 赞同：0
> 
> 时间：2012-04-13T14:59:56.557
> 
> 标签：c#, arrays, webcam, emgucv

我尝试使用捕获类制作一组网络摄像头，但它没有构建。我不确定如何做到这一点。我有搜索和搜索，但什么也没看到。代码的目的是从 2 个网络摄像头实时获取视频帧并使用 EMGUcv 实时拼接它们我猜可以在 opencv 中完成。请如果您有任何其他选择，我愿意探索它们

```
 public partial class StitchingMainForm : Form
   {
       //declaring global variables
       Capture[] cap= new Capture[2];//takes images from cameras as image frames
       private bool captureInProgress;

      public StitchingMainForm()
      {
         InitializeComponent();
      }

      private void selectImagesButton_Click(object sender, EventArgs e)
      {
          Capture[] cap = new Capture[2];
         if (cap!= null)

         {
            sourceImageDataGridView.Rows.Clear();

            Image<Bgr, Byte>[] sourceImages = new Image<Bgr, byte>[cap.Length];

            for (int i = 0; i < sourceImages.Length; i++)
            {
               sourceImages[i] = new Image<Bgr, byte>(cap.[i]);

               using (Image<Bgr, byte> thumbnail = sourceImages[i].Resize(200, 200, Emgu.CV.CvEnum.INTER.CV_INTER_CUBIC, true))
               {
                  DataGridViewRow row = sourceImageDataGridView.Rows[sourceImageDataGridView.Rows.Add()];
                  row.Cells["FileNameColumn"].Value = cap.[i];
                  row.Cells["ThumbnailColumn"].Value = thumbnail.ToBitmap();
                  row.Height = 200;
               }
            }

i want to display the captured frames on seperate rows and see the final image after stitching. 

 1\. Cannot apply indexing with [] to an expression of type 'method group'
 2\. (40,34): error CS1502: The best overloaded method match for              Emgu.CV.Image<Emgu.CV.Structure.Bgr,byte>.Image(byte[*,*,*])' has some invalid arguments
 3\. (40,55): error CS1503: Argument 1: cannot convert from 'method group' to 'byte[*,*,*]'
 4\. (45,55): error CS0021: Cannot apply indexing with [] to an expression of type   'method group'

Thanks 
```

# ios5 - 使用 addChildViewController 或创建容器 VC 时，父级是否有 XIB 或 View？

> ID：10143284
> 
> 赞同：1
> 
> 时间：2012-04-13T15:00:35.140
> 
> 标签：ios5, interface-builder, xib

我想使用新的 iOS 5 方法（如 addChildViewController）创建一个容器视图控制器这个父（容器）控制器必须有一个带有视图的 XIB 文件吗？还是只有 .h 和 .m 文件就足够了？

谢谢。

# javascript - Node.js jsdom 错误

> ID：10143288
> 
> 赞同：7
> 
> 时间：2012-04-13T15:00:50.893
> 
> 标签：javascript, node.js, jsdom, cloud9-ide, contextify

我正在尝试让 jsdom 工作:)

这是代码：

```
var jsdom = require("jsdom");
var request = require("request");
var fs     = require('fs');
var jquery = fs.readFileSync("./jquery-1.7.2.js", 'utf-8');

request({ uri:'http://nodejs.org/dist/' }, function (error, response, body) {
    if (error && response.statusCode !== 200) {
        console.log('HTTP request error... '+error);
    }
    jsdom.env({
        html: body,
        scripts: [
            jquery
        ],
        done: function(errors, window) {
            console.log('done');
        }
    });
}); 
```

这是错误：

```
jsdom.js:171
    features   = JSON.parse(JSON.stringify(window.document.implementation._fea
                                                          ^
TypeError: Cannot read property 'implementation' of undefined 
```

我检查了页面是否被获取以及 jquery 库是否被解析——它们是。

我们可以看看 jsdom.js 的实现：

```
[snip]
exports.env = exports.jsdom.env = function() {
    [snip]
    window     = exports.html(html, null, options).createWindow(),
    features   = JSON.parse(JSON.stringify(window.document.implementation._features)),
    docsLoaded = 0,
    [snip] 
```

似乎 .createWindow() 不成功......

我在[Cloud9](http://c9.io)上运行它。

欢迎任何帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T21:11:16.110

正如[https://github.com/tmpvar/jsdom/issues/436](https://github.com/tmpvar/jsdom/issues/436)所报告的，这可能是由于未安装 contextify 造成的。理论上 jsdom 有一个 shim 允许它在没有 contextify 的情况下工作，这就是为什么它将它列为可选而不是必需模块的原因，但是这个 shim 似乎被破坏了（参见[https://github.com/tmpvar/jsdom/问题/456](https://github.com/tmpvar/jsdom/issues/456)）。

因此，到目前为止，您需要安装 contextify 才能使用最新的 jsdom。根据您的操作系统和环境，有几个原因可能会导致问题。运行 npm install contextify 然后追踪该问题。

根据您的根本问题尝试的事情： - 验证您是否安装了 Python 2.7 或更高版本，并且最好安装了 2.7.3。还要验证它是在您键入 python --version 时运行的，并且您的 PYTHONPATH 是正确的。- sudo npm install contextify - npm 缓存清理；npm install contextify --force

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:37:48.950

我找到了问题的答案。

可以在[http://support.cloud9ide.com/entries/21243717-accessing-your-private-running-project-via-javascript-or-curl](http://support.cloud9ide.com/entries/21243717-accessing-your-private-running-project-via-javascript-or-curl)上找到其中的一部分。

因此，为了使 jsdom 在 cloud9 上运行，需要使用旧版本（如 0.2.1）并使用旧版本的节点（如 0.4，cloud9 支持）运行脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-30T09:19:13.543

尝试升级 jsdom。我在旧版本的 jsdom (0.3.x) 上遇到了完全相同的错误。然后我删除了它并安装了当前的（jsdom@0.6.5）版本，现在它可以工作了。

# objective-c - 构建错误：体系结构 i386 的未定义符号？

> ID：10143294
> 
> 赞同：0
> 
> 时间：2012-04-13T15:01:15.997
> 
> 标签：objective-c, xcode4

我在使用带有情节提要的 XCode4 的 iPad 应用程序上遇到此构建错误：

> 架构 i386 的未定义符号：“_OBJC_CLASS_$_SQLite”，引用自：EnterDataViewController.o 中的 objc-class-ref

我在应用程序中查看了我所知道的所有地方，进行了清理并重新构建了所有内容，但均无济于事。我看不出错误在说什么。

发生了什么，我该如何解决？

更新：这是来自 EnterDataVewController.m 的相关代码

```
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//--  set First Responder
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++
- (BOOL) textFieldShouldReturn:(UITextField *)textField  {

    //  for site data...
    if(textField == txtSiteID)  {
        [txtSTA becomeFirstResponder];
        return true;
    }

    if(textField == txtSTA)  {
        [txtElev becomeFirstResponder];
        return true;
    }

    if(textField == txtElev)  {
        [txtSiteDesc becomeFirstResponder];
        return true;
    }

    if(txtSiteDesc.isFirstResponder)  { 
        SQLite *db = [[SQLite alloc] init];
        [db saveSiteData:(UITextField *) txtSiteID sta:(UITextField *) txtSTA desc:(UITextField *) txtSiteDesc elev: (UITextField *) txtElev ];
        [txtSiteDesc resignFirstResponder];
        return true;
    }

    //  for readings
    if(textField == txtSTA1)  {
        [txtBS becomeFirstResponder];
        return true;
    }

    if(textField == txtBS) {
        [txtFS becomeFirstResponder];
        return true;
    }

    if(textField == txtFS)  {
        [txtDesc becomeFirstResponder];
        return true;
    }

    //    if(textField.isFirstResponder) {  
    if(textField == txtDesc) {  
        SQLite *db = [[SQLite alloc] init];
        [db saveReadings:txtSiteID sta:txtSTA1 bs:txtBS fs:txtFS desc:txtDesc];
        [txtDesc resignFirstResponder];
        return true;
    }

    return YES;
}

//    //--  is this for txtDesc 
//    if(txtDesc.isFirstResponder)  {
//        [txtDesc resignFirstResponder];
//    }
//

NSString *databasePath;
NSString *docsDir;
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//--  save the site data
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++
- (BOOL) saveSiteData  {

    //  validate all fields
    if(txtSiteID.text.length == 0 || txtSiteDesc.text.length == 0)  {
        [self Alert:@"Missing Site ID and/or Description" andData:@"Reqired fields"];
        return NO;
    }

    if(txtSTA.text.length == 0 || txtElev.text.length == 0)  {
        [self Alert:@"Missing Initial STA and/or Elevation" andData:@"Reqired fields"];        
        return NO;
    }

    //    txtSiteDesc.text = txtSiteDesc.text.re  <----------  remove single quotes  TODO

    //  update d/b
    SQLite *dbCode = [[SQLite alloc] init];  //  instantiate slSQLite
    [dbCode saveSiteData:txtSiteID sta:txtSTA desc:txtSiteDesc elev:txtElev];  //  save site data

    return YES;
}

//++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//--  save the readings
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++
- (void) saveReadings  {

    //  update d/b
    SQLite *dbCode = [[SQLite alloc] init];  //  instantiate slSQLite
    [dbCode saveReadings:txtSiteID sta:txtSTA1 bs:txtBS fs:txtFS desc:txtDesc];

    return;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:38:10.663

我发现了问题...... EnterDataVewController.m 的两 (2) 个实例位于*同一项目的不同目录中*。我不知道为什么会导致问题，但是当我删除第二个实例时，它的构建没有任何问题（正常除外）。

谢谢大家的建议。我很感激你的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:11:24.493

SQLite 是您自己的单独类吗...如果是，请导入它...如果不是，请尝试在其中导入 CoreData 框架

# windows-server-2008 - 带有 Hyper-V 和 Vmware 播放器的 Windows 2008 服务器

> ID：10143297
> 
> 赞同：2
> 
> 时间：2012-04-13T15:01:27.890
> 
> 标签：windows-server-2008, vmware, hyper-v

有没有办法在安装了 microsoft hyper v 的 windows server 2008 r2 上安装 vmplayer。在尝试安装时，我收到一条消息，例如

此产品可能未安装为已安装的 microsoft hyper v。

服务器在云上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T12:35:23.903

我认为这可能会对您有所帮助：

[http://angledontech.blogspot.com/2011/05/how-to-install-vmware-player-after.html](http://angledontech.blogspot.com/2011/05/how-to-install-vmware-player-after.html)

但是，您将无法同时运行两个虚拟机管理程序。

# html - 浮动左容器挂在中间

> ID：10143306
> 
> 赞同：1
> 
> 时间：2012-04-13T15:02:00.177
> 
> 标签：html, css, position, css-float

我有以下代码：http: [//jsfiddle.net/69MqZ/1/](http://jsfiddle.net/69MqZ/1/)

如您所见，灰色文本行到灰色元数据：![在此处输入图像描述](../Images/214a4c25d08a0d369d79fe53ec9957ef.png)

尽管左边的名字很长，但我希望它是这样的：![在此处输入图像描述](../Images/e90e923609f25d805cf8942afaee8371.png)

显然，它必须使用 position: relative 或某种使边界底部相应移动的技术。这是 WordPress 生成的评论输出。

我在这里面临同样的问题（所有容器都有浮动：左；）： ![在此处输入图像描述](../Images/c25d971530ec4f3c7ef8601bd866aac9.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:10:06.537

您将需要在评论作者姓名和元数据周围包裹一个父元素*-* .comment-author 和 .comment-meta - 然后浮动该父元素。例如：

```
 <div class="comment_author_wrap">
 <div class="comment-author vcard">
     <cite class="fn">John Smith</cite> <span class="says">says:</span>        
 </div>

 <div class="comment-meta commentmetadata">
     <a href="#comment-3">May 23, 2010 at 5:04 pm</a>&nbsp;&nbsp;<a title="Edit comment" href="3" class="comment-edit-link">(Edit)</a>        
 </div>
 </div> 
```

然后

```
.comment_author_wrap {
   float: left;
 } 
```

这将允许评论文本像您想要的那样一直出现在该区域的顶部。

# asp.net-mvc-3 - 在 MVC 3 视图模型上使用 Editable 属性

> ID：10143307
> 
> 赞同：9
> 
> 时间：2012-04-13T15:02:00.767
> 
> 标签：asp.net-mvc-3, attributes

我正在寻找使用属性将视图模型属性标记为只读，以便视图字段在渲染视图中只读。应用 System.ComponentModel.DataAnnotations.EditableAttribute 似乎是我需要的确切属性，但它似乎不起作用，即文本框字段仍然是可编辑的。我环顾四周，找不到答案，只有几个相关的问题。呈现视图时，下面应用的可编辑属性不起作用。

```
[Display(Name = "Last Name")]
[Editable(false, AllowInitialValue = true)]
public string LastName { get; set; } 
```

我可以使用这样的视图辅助函数来实现只读行为，但我更喜欢在模型属性上使用属性。

```
@functions {
    object getHtmlAttributes()
    {
    if (@ViewBag.Mode == "Edit")
    {
      return new {style = "width:100px;background:#ff6;", @readonly = "readonly"};
    }

    return new { style = "width:100px;" };  
}
} 

@Html.TextBoxFor(model => model.FirstName, getHtmlAttributes()) 
```

其他属性可以正常工作，包括自定义验证属性。你能告诉我数据注释可编辑属性是否在这种情况下工作，应该像上面应用的那样工作，还是需要做其他事情？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T18:05:36.253

[EditableAttribute 文档](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.editableattribute.aspx)指出：

> 数据字段上存在的 EditableAttribute 属性指示用户是否应该能够更改字段的值。
> 
> **此类既不强制也不保证字段是可编辑的。**无论此属性是否存在，底层数据存储都可能允许更改字段。

不幸的是，这意味着使用此属性对 MVC 中的验证没有任何影响。这感觉是错误的，但如果您考虑在 MVC 框架中实现它需要什么，它是有道理的。例如，在典型的“编辑”视图中，用户执行初始 GET 请求，其中填充模型（通常来自数据库记录）并提供给视图以呈现给用户。然后用户进行一些编辑，然后提交表单。提交表单会导致从 POST 参数构造模型的*新实例。*验证器很难确保两个对象实例中的字段具有相同的值，因为其中一个实例（来自 GET 请求的第一个实例）已经被处理掉了。

**好吧，如果属性没有功能，为什么还要费心使用它呢？**

我最好的猜测是，他们希望开发人员在他们的代码中使用它来表达意图。更实际的是，您还可以编写自己的自定义代码来检查此属性的存在...

```
AttributeCollection attributes = TypeDescriptor.GetAttributes(MyProperty);
if (attributes[typeof(EditableAttribute)].AllowEdit)
{
   // editable
}
else
{
   // read-only
} 
```

还要记住，这些 DataAnnotation 属性不仅适用于 MVC 应用程序，它们还可以用于许多不同类型的应用程序。即使 MVC 没有对这个 Attribute 做任何特别的事情，[其他框架已经为这个 Attribute 实现了功能/验证](http://help.devexpress.com/#Silverlight/CustomDocument5301)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T03:00:17.993

我自己只是半解决了这个问题。

[隐藏输入（显示值=真）]

该字段显示但不可编辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T20:11:02.487

发现在模型上使用 Editable 而不是 Readonly 的效果完全一样。

```
[ReadOnly(true)] //or
[Editable(false)]
public string Name { get; set; } 
```

当查询视图本身的属性时，此语法确实有效。当属性为 Editable(true) 时也有效

```
@if (ViewData.ModelMetadata.Properties.Where(p => p.PropertyName == "Name").First().IsReadOnly)
{ 
    @Html.TextBoxFor(model => model.Name, new { style = "width:190px; background-color: #ffffd6", @readonly =  "readonly" })
} 
else
{
    @Html.TextBoxFor(model => model.Name, new { style = "width:190px; " })
} 
```

在此处使用编辑器模板是一个简单的字符串模板：

```
@model String
@{
IDictionary<string, object> htmlAttributes = new Dictionary<string, object>();
if (ViewData.ModelMetadata.IsReadOnly) //this will be looking at the actual property not the complete model
{
htmlAttributes.Add("style", "width:100px; background-color:#ffffd6");
htmlAttributes.Add("readonly", "readonly");
@Html.TextBox("", Model, htmlAttributes)
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T15:08:13.497

你有不同的创建场景吗？您允许初始值的任何特殊原因？我问是因为[文档](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.editableattribute%28v=vs.95%29.aspx)说：

> 因为您通常希望两个属性包含相同的值，所以 AllowInitialValue 属性设置为类构造函数中 AllowEdit 的值。

我在想如果你将它设置为 false 并且没有明确声明`AllowInitialValue`它会起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T21:49:07.630

不知道你是否已经弄清楚了，但我们使用

```
System.ComponentModel.ReadOnlyAttribute 
```

用法

```
[ReadOnly(true)] 
```

# php - 通过 PHP 使用 Exchange 管理单元执行 powershell 脚本

> ID：10143312
> 
> 赞同：2
> 
> 时间：2012-04-13T15:02:26.517
> 
> 标签：php, apache, powershell, windows-server-2008, exchange-server

我正在尝试使用 PHP 执行的 powershell 脚本查询 Exchange 服务器，但它似乎无法正常工作。我试图运行的命令是：

```
powershell "Add-PSSnapin Microsoft.Exchange.Management.PowerShell.E2010";"Get-CASMailbox -Identity user@example.com | fl ActiveSyncEnabled" 
```

如果我直接在命令提示符中键入它，它会正确执行并返回：

> ActiveSyncEnabled : 真

当我在 PHP 中尝试时：

```
$output=shell_exec('powershell "Add-PSSnapin Microsoft.Exchange.Management.PowerShell.E2010";"Get-CASMailbox -Identity user@example.org | fl ActiveSyncEnabled"'); 
```

我什么都得不到。$output 已设置但为空。如果我在末尾添加“> output.txt”，我会得到一个空白文本文件。我能够通过 PHP 成功运行其他更简单的 powershell 命令，但不是这个。Apache 服务以与我通过命令提示符成功执行脚本时相同的用户身份运行。

有任何想法吗？

我在跑：

*   Windows Server 2008 R2 SP1 64 位
*   Apache 2.2.22 32 位
*   PHP 5.2.17 VC6 32 位
*   Exchange 管理控制台 2010

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:16:15.847

您可以尝试`2>&1`在命令末尾添加，例如：

```
$output=shell_exec('powershell "Add-PSSnapin Microsoft.Exchange.Management.PowerShell.E2010";"Get-CASMailbox -Identity user@example.org | fl ActiveSyncEnabled" 2>&1'); 
```

有时，powershell 输出开头的换行符似乎会阻止`shell_exec`打印其他任何内容。

# java - 每次只需要一个此类的实例时，是否应该创建指向类的新链接？

> ID：10143315
> 
> 赞同：2
> 
> 时间：2012-04-13T15:02:41.620
> 
> 标签：java, oop

例如，有一个职业战士与剑职业联系在一起。在剑类中定义字段：public static int hp = 100; 它显示了这种武器消耗的生命值。需要几个职业的战士。我想我需要在 Warrior 类中定义链接 Sword（仅一次）才能获得静态字段 hp。我怎样才能正确链接它？

```
class public Warrior{
    public String name;
    public Sword s = new Sword(); // ???
}
class public Sword{
    public static int hp = 100;

} 
```

`new Sword()`每次创建新战士时都会创建指向班级的链接吗？我可以在另一个 Weapon 类中将 Sword 类定义为静态的吗？（需要剑等多个职业）

* * *

以下结构正确吗？外部类可以是静态的并保持在另一个静态中吗？

```
class public Warrior{
        public String name;

        public int SwordHp = Weapon.Sword().hp;
        public int BowHp = Weapon.Sword().hp;

    }

(abstract?) public static class Weapon{
    public static class Sword{
        public static int hp = 100;

    }
    public static class  Bow{
        public static int hp = 90;

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:05:43.513

我不确定您到底想要什么，但正如您现在的代码示例一样，战士的构造会导致剑的构造。

这取决于您所说的“消耗的健康点数”是什么意思。如果您想跟踪此类武器造成的所有伤害，您可以使用静态 HP 字段。如果这是您想要的，我建议您使用一个跟踪各种统计信息的系统。像这样的东西：

```
Statistics.getStatisticsForPlayer(playerName). // Get the statistics for a player
  increaseValue("damage_caused_by_sword", extraDamage); // increase that property 
```

如果您想跟踪每把剑的生命值（这对我来说看起来最真实，因为剑不会永远锋利），您应该创建非静态字段。这使得该字段成为每个 Sword 实例的属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T15:06:26.413

是的，每次你都会得到一把新剑。

但是，因为 hp 是一个静态字段，所以您只会得到其中一个。

查看此链接以获取更多信息： [http ://docs.oracle.com/javase/tutorial/java/javaOO/classvars.html](http://docs.oracle.com/javase/tutorial/java/javaOO/classvars.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T15:07:39.610

如果`hp`是`static`，则您根本不需要成员`Sword`。您可以使用 访问该字段`Sword.hp`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T15:09:52.360

要获得静态字段 hp，您无需创建

```
public Sword s = new Sword(); 
```

在武士班。静态变量在加载时初始化。因此，您可以在任何地方访问您的 hp，而无需在特定类中声明，只需使用

剑.hp ;

这对静态变量没有任何影响。

```
 Sword s = new Sword() 
```

据我了解，您目前拥有剑士和不同的武器。每种武器都有生命值，每个战士都有自己的武器和生命值。如果您使用静态字段，那么这些健康点将在所有战士之间共享，如果有 50 名战士，那么所有人将只使用 100 点，我希望您不想要，所以您应该使用：

```
class public Warrior{
    public String name;
    public Sword s = new Sword(); // ???
}
class public Sword{
    public  int hp = 100;

} 
```

每次创建战士时，它将创建一个具有 100 点生命值的新剑，并且每个战士都会消耗自己的生命值。希望它会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-13T18:02:20.617

如果武器类型的数量是恒定的，那么枚举会很好地工作。

```
enum Weapon {
   Sword(100),
   Bow(90);

   private final int hp;
   private Weapon(int hp) {
      this.hp = hp;
   }

   int getHp();
}

public class Warrior {
   public String name;
   public Weapon weapon = Weapon.Sword;
} 
```

# asp.net-mvc - DropDownListFor() 绑定值和文本到视图模型

> ID：10143320
> 
> 赞同：0
> 
> 时间：2012-04-13T15:02:58.413
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

我在视图上有一个带有下拉列表的表单，使用 DropDownListFor() 实现。这个 View 是强类型的 ViewModel，它有一个 SelectList 属性来保存下拉列表的选项，然后是另一个属性来保存下拉列表的选定值。这工作正常，但我想做的是，在我的第二个属性中同时保存下拉列表的选定值和选定文本。我想这样做的原因是，作为自我发布的表单，我同时拥有每个选择的文本和值。

我尝试将选定的值属性从 int 更改为 KeyValuePair，但在表单提交时只设置了该对的 int 部分。

也许有更好的方法来实现这一点，我愿意接受所有建议，包括对我的方法进行部分重新设计。

控制器（构建 SelectList）

```
SelectList leadTypeGroups = new SelectList(_enrollmentRepository.GetLeadTypeGroups(), "Key", "Value"); 
```

视图模型

```
public KeyValuePair<int, string> LeadTypeGroupID { get; set; }
public SelectList LeadTypeGroups { get; set; } 
```

看法

```
@Html.DropDownListFor(selected => Model.LeadTypeGroupID, Model.LeadTypeGroups, " ") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T17:12:18.940

让服务器在每次请求时从数据库（或内存缓存）中提取值。或者，有一个带有 javascript 的隐藏字段，只要下拉选择更改，它就会使用适当的文本更新它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:09:18.997

将 ViewModel 更改为 List，然后使用 for 循环为列表中的每个项目生成一个下拉列表。就像是...

看法

```
@for( int i = 0; i < Model.LeadTypeGroupIDs; i++ )
{
  @Html.DropDownListFor(x => Model.LeadTypeGroupIDs[i], Model.LeadTypeGroups, " ")
} 
```

视图模型

```
public List<string> LeadTypeGroupIDs { get; set; }
public SelectList LeadTypeGroups { get; set; } 
```

# c# - 在 asp 中显示数据表中的图像：代码隐藏中的图像

> ID：10143323
> 
> 赞同：3
> 
> 时间：2012-04-13T15:03:07.150
> 
> 标签：c#, asp.net, sql-server, datatable, code-behind

我有一个数据表，它是从 1 行选择语句的结果集中（通过 SQL Server 2008 中的存储过程）填充的，它包含一个`Image`类型化的列，我在其中存储图像。

我`asp:image`在 aspx 页面上有一个控件，我想将图像设置为该数据表的相应字段，但我做的任何事情都做不到。请告诉我如何**从后面的代码**`asp:image`中设置该数据表的to image 列。

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:08:49.147

你可以放`<img src="data:image/png;base64,<BASE64 STRING>" />`，所以你可以将`asp:image`'`ImageUrl`属性设置为`"data:image/png;base64,xxx"`.

但是，我怀疑浏览器对此的支持参差不齐，在 IE9 和 firefox 中运行良好，但我不确定旧浏览器是否支持此功能。

不过，我推荐的另一种方法是创建一个通用处理程序`ashx`，它读取数据库并返回图像。您可以查看此网站以了解如何操作：http: [//www.dotnetperls.com/ashx](http://www.dotnetperls.com/ashx)，然后将`ImageUrl`属性设置为此处理程序地址。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T15:11:19.140

[使用 ASP.Net 显示来自 SQL Server 数据库的图像](http://www.aspsnippets.com/Articles/Display-Images-from-SQL-Server-Database-using-ASP.Net.aspx)

.aspx 文件

```
<asp:image ID="Image1" runat="server" ImageUrl ="ImageCSharp.aspx?ImageID=1"/> 
```

.cs 文件

```
protected void Page_Load(object sender, EventArgs e)
{
    if (Request.QueryString["ImageID"] != null)
   {
        string strQuery = "select Name, ContentType, Data from tblFiles where id=@id";
        SqlCommand cmd = new SqlCommand(strQuery);
        cmd.Parameters.Add("@id", SqlDbType.Int).Value
        = Convert.ToInt32 (Request.QueryString["ImageID"]);
        DataTable dt = GetData(cmd);
        if (dt != null)
        {
            Byte[] bytes = (Byte[])dt.Rows[0]["Data"];
            Response.Buffer = true;
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = dt.Rows[0]["ContentType"].ToString();
            Response.AddHeader("content-disposition", "attachment;filename="
            + dt.Rows[0]["Name"].ToString());
            Response.BinaryWrite(bytes);
            Response.Flush();
            Response.End();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-13T15:13:56.450

尝试[数据 URL 方案](http://en.wikipedia.org/wiki/Data_URI_scheme)：

```
<img src="<%# ReturnEncodedBase64UTF8(Eval("ColumnA")) %>" />

protected static string ReturnEncodedBase64UTF8(object rawImg)
{
    string img = "data:image/gif;base64,{0}"; //change image type if need be
    byte[] toEncodeAsBytes = (byte[])rawImg;        
    string returnValue = System.Convert.ToBase64String(toEncodeAsBytes);
    return String.Format(img, returnValue);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-11T09:49:57.423

只需使用 Convert.ToBase64String

```
 byte[] bytes = (byte[])dr["YourImageField"];
        string b64img = Convert.ToBase64String(bytes);
        Image1.ImageUrl = "data:image/jpeg;base64," + b64img; 
```**

# dapper - 对可移植库项目的 Dapper 支持

> ID：10143329
> 
> 赞同：1
> 
> 时间：2012-04-13T15:03:23.470
> 
> 标签：dapper, portable-class-library

是否有必要阻止 Dapper 在 PortableLibraryProject 中使用？我正在尝试创建将在 wp7 和 WPF 应用程序中使用的数据访问库。

WP7 应用程序也将在离线模式下工作，因此我不能依赖通用的外部 Web 服务

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T07:00:05.683

Dapper 无法编译为可移植类库，因为不支持 Reflection.Emit 和 System.Data

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T07:08:50.987

Dapper 需要编译为可移植类库才能从可移植类库中使用它

# workflow-foundation-4 - WF 4 单元测试 - OverloadGroup 验证

> ID：10143339
> 
> 赞同：0
> 
> 时间：2012-04-13T15:03:50.987
> 
> 标签：workflow-foundation-4

我有单元测试来运行我的代码，如下所示：

```
 MyActivity myActivity = new MyActivity ()
            {
                Input1 = "value1"
            };

            WorkflowInvoker.Invoke(myActivity);
            /// do assert 
```

MyActivity 也有 Input2 作为 InArgument。我遇到的问题是 Input1 和 Input2 的验证参数如下。

```
[OverloadGroup("Input1")]
[RequiredArgument]
public InArgument<string> Input1{ get; set; }

[OverloadGroup("Input2")]
[RequiredArgument]
public InArgument<string> Input2{ get; set; } 
```

这是因为我只需要一个值。

我收到以下错误：

根活动的参数设置不正确。修复工作流定义或提供输入值来修复这些错误：“MyActivity”：配置了以下重载组：Input1、Input2。只有一个重载组应该配置其参数。参数名称：程序

我不确定我做错了什么，因为我只设置了两项活动之一？
也许有更好的方法来对 WF 进行单元测试。
当在工作流服务中正常调用时，该活动确实可以正常工作。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T22:04:04.293

我设法通过将活动包装在序列中然后调用序列活动来“解决”它。

# javascript - 类似tokiolab.it的视差效果怎么做？

> ID：10143340
> 
> 赞同：3
> 
> 时间：2012-04-13T15:03:54.353
> 
> 标签：javascript, jquery, html, css, parallax

我已经阅读了很多关于 jQuery 视差的内容，但我根本不明白。我想做和这个网站一样的事情：

[http://www.tokiolab.it/#/](http://www.tokiolab.it/#/)

如您所见，第一页是一个非常简单的动画，但是当您滚动下一页时，会开始覆盖第一页的一部分。有人可以帮帮我吗，我知道你需要使用 z-index 但你如何实现这种效果 - 它似乎并不难，也许是固定背景或固定 div，有什么想法吗？

非常感谢！提前致谢！

# php - 使用 PHP/MySQL 搜索并使用 jQuery 动态更新

> ID：10143345
> 
> 赞同：3
> 
> 时间：2012-04-13T15:04:15.820
> 
> 标签：php, mysql, search, jquery

我想知道如何用 PHP/MySQL 和 jQuery 做到以下几点：

有一个基本的搜索掩码，您可以在其中输入城市和最新日期。您处理到搜索结果页面，然后您可以使用某些参数（复选框、jQuery 滑块、文本输入...）缩小搜索结果的范围。然后搜索结果应该即时更新，而不需要重新加载整个页面......

我设法使用 jQuery ajax 并加载将信息发送到另一个 php 文件，执行例如 SELECT 并将结果返回到搜索详细信息页面，但我不知道如何组合缩小搜索结果的不同更改。

此外，详细页面上已经有结果，所以我不需要添加更多结果，而是“删除”不再适合的结果......

问题是缩小搜索范围的每个参数都连接到数据库中的另一个表。我是否必须以及如何将连接添加到原始查询......？还是我想错了方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T19:51:45.023

是的，这绝对是正确的方向。采用

```
$(document).ready(function() {  

    $('#ID_OF_YOUR_ELEMENT_TO_LOAD_INTO').load("load.php?parameter1=<?php echo $parameter1; ?>&parameter2=<?php echo $parameter2; ?>");

}); 
```

在用户第一次进入页面时获取结果，根据您的城市和日期获取结果。

检查 load.php 设置了哪些参数并使用设置的参数来构建查询。然后，当表单（或表单，取决于）更新时，您必须再次使用 .load ，如下所示：

```
$('#ID_OF_YOUR_FORM_BEING_UPDATED').change(function() {

    $('#ID_OF_YOUR_ELEMENT_TO_LOAD_INTO').load("load.php?parameter1=<?php echo $parameter1; ?>&parameter2=<?php echo $parameter2; ?>&parameter3=<?php echo $parameter3; ?>");

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:47:41.530

通过 PHP/MySQL 获取初始元组，将它们保存到一些 Javascript 结构中并创建所需的 html，以使用该结构中的 javascript 显示数据。

任何时候你想过滤你重写html的数据并动态检查过滤条件，例如不要从不匹配你的过滤条件的结构中写入元组。

[您可以在http://www.wowhead.com](http://www.wowhead.com)上查看是谁完成的

这当然只是一种方式。;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:47:55.430

您总是可以编写一些代码来根据传递的参数生成 SQL 查询。

除了您的基本城市和从用户选择的日期之外，您的 ajax 还可以使用一堆参数查询页面。如果您的页面保留了之前选择的搜索选项，它应该能够让用户添加更多选项并继续以相同的方式处理它们。然后，您的 php 将测试是否在 $_POST 或 $_GET 变量中设置了参数（$_POST 通常对于 ajax 更安全，但为了简单起见，我的示例将使用 $_GET）并构建这样的查询。

例子：

Javascript 生成一个查询，如`searchAjaxHandler.php?city=Chicago&from=2012-03-01&to=2012-03-05&someColumnLowerRange=500&someColumnUpperRange=700`

然后您的 php 脚本按如下方式处理：

```
$query = "SELECT * FROM Data WHERE City=? AND Date > ? AND Date < ?";
$arguments = array($_GET['city'], $_GET['from'], $_GET['to']);
if (isset($_GET['someColumnLowerRange'])) {
    $query .= " AND someColumn > ?";
    $arguments[] = $_GET['someColumnLowerRange'];
}
if (isset($_GET['someColumnUpperRange'])) {
    $query .= " AND someColumn < ?";
    $arguments[] = $_GET['someColumnUpperRange'];
}
//execute the query
//using PDOs (google them...they are a good way to prevent sql injection and
//support multiple database types without modifying code too much), create a
//statement with the above query in put the statement in $statement

$statement->execute($arguments); //this uses the $arguments array to fill in the prepared statement's ?'s

//then do the stuff to get the retrieved rows out of the result returned 
```

毕竟，javascript 端将通过将所有先前的结果替换为您返回的结果来完成与您之前所做的相同的事情。

# jquery - 在 jqgrid 中获取 [obj is undefined]

> ID：10143348
> 
> 赞同：1
> 
> 时间：2012-04-13T15:04:28.273
> 
> 标签：jquery, jqgrid, jqgrid-php

我在使用 jQgrid 时遇到问题，当我使用 json 数据类型初始化 jqgrid 时，它会导致错误：

> obj 未定义
> 
> ret = obj[expr];

当我用本地数据类型初始化jqgrid时，不会出现错误但不会加载json数据

索引.html

```
<table id="products"></table>
<div id="pager"></div>

<script type="text/javascript">
$('document').ready(function(){
    jQuery("#products").jqGrid({
        url: 'product.php',
        editurl: 'product_update.php',
        datatype: "json",
        mtype: 'POST',
        colNames:['Product Name'],
        colModel:[
            {name:'product_name',index:'product_name', width:90}
        ],
        rowNum:-1,
        viewrecords: true, 
        rowList:[10,20,30],
        pager: '#pager',
        toolbar : [true,"top"],
        sortorder: "DESC",
        caption:"Products",
        width: 940,
        height: "100%"
    });
});
</script> 
```

product.php（这只是一个模拟数据）

```
 $arrayName = array();
    $arrayName['page'] = 1;
    $arrayName['total'] = 1;
    $arrayName['records'] = 3;
    $arrayName['rows'][0] = array(
        'product_name' => 'Product X'
        );
    $arrayName['rows'][1] = array(
        'product_name' => 'Product Y'
        );
    $arrayName['rows'][2] = array(
        'product_name' => 'Product Z'
        );

    echo json_encode($arrayName); 
```

json输出：

> {"page":1,"total":1,"records":3,"rows":[{"product_name":"Product X"},{"product_name":"Product Y"},{"product_name" :"产品 Z"}]}

我希望有人可以在这里帮助我。

提前谢谢你：D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:34:32.877

JSON 数据的默认输入格式 - 具有类似 id 的项目数组

```
{"page":1,"total":1,"records":3,"rows":[
    {"id":"Product X", "cell":["Product X"]},
    {"id":"Product Y", "cell":["Product Y"]},
    {"id":"Product Z", "cell":["Product Z"]}
]} 
```

（见[这里](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aretrieving_data#json_data)）。要读取您当前发布的数据，您应该`jsonReader: {repeatitems: false, id: "product_name"}`向 jqGrid 定义添加选项。

如果您使用`jsonReader: {cell: "", id: "0"}`. 在这种情况下，您应该将 JSON 数据的格式更改为

```
{"page":1,"total":1,"records":3,"rows":[
    ["Product X","Product Y","Product Z"]}
]} 
```

此外，我不建议您使用`rowNum:-1`. 使用一些足够大的正值更好。例如`rowNum: 10000`. 如果您要添加`loadonce: true`到网格中，`rowNum:-1`那么 jqGrid 将以错误的方式呈现网格。

您应该添加[gridview: true](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aoptions)以提高它的性能。最后一句话：是`index:'invdate'`打字错误的用法吗？

# visual-studio-2008 - 如何告诉 Visual Studio 2008 它应该在哪些文件夹中搜索库文件？

> ID：10143350
> 
> 赞同：0
> 
> 时间：2012-04-13T15:04:30.377
> 
> 标签：visual-studio-2008, visual-c++

出于某种原因，我得到了这个：

```
1>LINK : fatal error LNK1104: cannot open file 'glew32.lib' 
```

但是当我将该库复制到 Visual Studio 2008 文件夹时，它就可以工作了。如何告诉我的 Visual Studio 2008 它应该从我的项目文件所在的同一文件夹中寻找库文件？我尝试查看所有项目设置，但找不到与我的工作项目不同的任何东西，它确实从项目文件所在的文件夹中搜索库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:18:39.217

单击项目 > 属性（或按 ALT + F7），在“配置属性”下选择“链接器”，然后在“常规”下，在这里您应该看到“附加库目录”，在那里添加您的路径。

# android - Eclipse：来自单一来源的多个项目

> ID：10143352
> 
> 赞同：7
> 
> 时间：2012-04-13T15:04:39.487
> 
> 标签：android, eclipse, cordova

一开始我不得不说我的英语不是很好，所以如果我能很好地解释我的意思，我很抱歉:)

我有一个项目需要复制 n 次；每个新项目必须具有相同的源代码，但不同的资源（例如：图像、html 文件、声音、pdf 等）和不同的类/包名称。

我的项目不是标准的java，而是android + phonegap。我有一个创建一个空的phonegap项目的eclipse插件......也许有办法修改这个插件来创建我的标准项目？

可能吗？最好还有一个系统来将主项目的源代码更改提交给子项目，但这不是强制性的。

再次对不起我的英语。

编辑：

对不起，如果我再次编辑这个问题，但我真的找不到我的问题的解决方案。

我想将它与一个示例集成，也许我可以解释我需要什么。

想象一下，您已经为一支足球队（例如巴塞罗那）开发了带有 eclipse 和 phonegap 的 android 应用程序。

该应用程序主要是html + jquerymobile，但是您修改了活动，android清单，添加了一些phonegap插件，一些媒体资源等。

现在你必须为更多团队、很多团队复制这个应用程序。对于每个人，您必须创建一个新的 phonegap 项目，修改每个文件，添加插件，添加资产……这些任务不可能没有错误。

但最大的问题是：如果你的代码只有一点点更新，你如何在 10/20/50/100/1000 个项目中复制它？

为了更具体，我也在帖子中添加了 android、phonegap 和 cordova 标签。

再次对不起我的英语。

**编辑 N°2**

我刚刚玩了一个多星期的 maven android 插件，但没有成功。我需要的是集中式代码，我可以在其中切换应用程序和包名、图标以及少量配置文件。

Android libs 不是解决方案，因为它无法导出资产文件。

我开始为这个问题寻找一个详细的答案......请帮助:(

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T04:55:19.793

从维护的角度来看，我不会考虑基于相同的代码库复制 1000 个项目。我将使用单个项目来管理特定于客户的资源，并在项目构建阶段交换所需的资源。换句话说，1 个项目构建 1000 个 apk，而不是 1000 个项目构建 1000 个 apk。

根据您在问题中提供的详细信息，解决这种使用场景（从单一源库构建多个应用程序）的正确方向（据我所知）是采用外部构建工具，如 Ant 或 Maven 主导构建进程（两者都提供了在整个构建生命周期中对每个步骤进行精细控制的能力，即编译、dex、打包等），如果需要，还可以编写用于批量构建的 shell 脚本。

我不是PhoneGap的乐趣，但快速浏览一下它的[入门指南](http://phonegap.com/start#android)，根据我的理解，它只是Android SDK之上的另一个编程层堆栈，提供主要使用Web编程语言编写移动应用程序的能力（ HTML、CSS、Javascript），应用程序仍然保留原始项目框架，所以我不会期望编写 Ant/Maven 脚本来构建 PhoneGap 应用程序有太多麻烦。

一旦你通过 Maven 成功构建了你的 PhoneGap 应用程序。您可以开始研究如何解决您的场景，我之前在 StackOverflow 中看到过类似的场景，请查看[此线程](https://stackoverflow.com/questions/9371698/speeding-up-the-android-build-process)和[此线程](https://stackoverflow.com/questions/9699485/skinning-android-app-with-maven-build-profiles)以进行一些案例研究。您可以启动概念验证项目以进行可行性研究。

我已经发布了一些示例代码，展示了 Maven 如何实现这一点，见下文。

示例项目目录结构：

```
myApp/
  src/
  res-barcelona/
  assets-barcelona/
  res-realmadrid/
  assets-realmadrid/
  ... ...
  project.properties
  AndroidManifest.xml
  pom.xml 
```

示例 pom.xml 文件：

```
<profiles>
  <profile>
    <id>barcelona</id>
    <properties>
      <app.package.name>com.company.app.barcelona</app.package.name>
      <app.res.dir>${project.basedir}/res-barcelona</app.res.dir>
      <app.assets.dir>${project.basedir}/assets-barcelona</app.assets.dir>
    </properties>
  </profile>
  <profile>
    <id>realmadrid</id>
    <properties>
      <app.package.name>com.company.app.realmadrid</app.package.name>
      <app.res.dir>${project.basedir}/res-realmadrid</app.res.dir>
      <app.assets.dir>${project.basedir}/assets-realmadrid</app.assets.dir>
    </properties>
  </profile>
  ... ...
</profiles>

....

<plugins>
  <plugin>
    <groupId>com.jayway.maven.plugins.android.generation2</groupId>
    <artifactId>android-maven-plugin</artifactId>
    <version>3.1.1</version>
    <extensions>true</extensions>
    <configuration>
      <sdk>
        <platform>13</platform>
      </sdk>
      <undeployBeforeDeploy>true</undeployBeforeDeploy>
      <renameManifestPackage>${app.package.name}</renameManifestPackage>
      <resourceDirectory>${app.res.dir}</resourceDirectory>
      <assetsDirectory>${app.assets.dir}</assetsDirectory>
    </configuration>
  </plugin>
  ... ...
</plugins> 
```

要构建 app-barcelona.apk，请运行`mvn clean install -Pbarcelona`.
要构建 app-realmadrid.apk，请运行`mvn clean install -Prealmadrid`.
要构建其他 1000 个 apk，请编写 shell 脚本。

Android Maven 插件提供了许多配置，让您可以在每个阶段/目标精细控制构建过程。查看[项目文档](http://maven-android-plugin-m2site.googlecode.com/svn/plugin-info.html)以获取完整的详细信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T20:17:38.293

Hope I got your right when assuming you're more looking for a general way how to do it then an actual list of files you've to change. Because this is something you'll probably won't come around to figure it out by yourself. (THough android projects are well structured it might be enough to just change the `res/`, `asserts/` folder and the `android.manifest` file. I merely used anything more on my Phonegap projects.

So my weapon of choice would be git branches.
[(Some words about git if you've not already heard about it.)](http://wiki.eclipse.org/EGit/Git_For_Eclipse_Users)

Given the last commit represents your finished application. From here you can fork the project for a (e.g. Valencia CF) release. Make sure that you only change the resources but nothing in the main program! It is important that your main development branch remains the most developed version!

So after releasing the second and third app you might want to do some bug fixes. You'll switch back into your development branch and continue to make your code even better. Hitting the next release you'll again branch of for all the other teams you want to gives updates to.
So you have a couple of branches with the updated version but the same resources on the one hand and already styled apps all on your old version.

If you have a charming git client you could easily pick the files you want to changes. This takes varies from easy to "wtf-MOAH-pcCra$h *throwing away the computer*" if you have a lot of individual files to merge but not simply big folders + few files like `res/` and `android.manifest`.

Another possibility would be to use a git feature called [cherry-pick](http://schacon.github.com/git/git-cherry-pick.html). I've never used it but the description sounds pretty much like what you want:

> Given one or more existing commits, apply the change each one introduces, recording a new commit for each. This requires your working tree to be clean (no modifications from the HEAD commit).

(Here's the rich [SO thread](https://stackoverflow.com/questions/449541/how-do-you-merge-selective-files-with-git-merge) where I've picked that it up.)

You have your clean working tree since you just branched of your new version to re-apply the Valencia CF design. Therefore the HEAD is clean and you can cherry-pick the commits from the old version where you've applied the design already.
Very probably something has changed from the old to the new version which requires to update the resources. (Some views went but other got introduced for example). However just go ahead and get it done but make sure to commit your final result because this commit will be the cherry-pick for the even better and greater version which you've already started to work on in your developing branch.

Though not directly related to your question I also would you recommend to read [A successful Git branching model](http://nvie.com/posts/a-successful-git-branching-model/) which gives you another idea how you can use branches to your favour.

Anyway I don't think it's the only possible solution but for it seems to be the most convenient method. Since all the magic you do is in the project folder you can just copy and paste them and edit the stuff manually or via clever programs. But I'm not sure where the Eclipse project files are stored and also copying them will probably let Eclipse freak out a little bit. (Same project name but wrong project path etc.). Creating new Eclipse project all the times also sounds like a lot of work to me. While git cooperates independently from your IDE (it's nothing more than an extra folder in the project.) you can just close Eclipse switch the branches via git and reopen the program and you've got the changes you applied. (OK, you've might have to right click on the project and hit refresh ... right.)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-22T12:09:44.080

正如您已经发现的那样，您需要一个共享的[Android 库项目。](http://developer.android.com/guide/developing/projects/projects-eclipse.html#SettingUpLibraryProject)不幸的是（正如您已经提到的）`assets`仅在使用 [Android Maven Plugin](http://code.google.com/p/maven-android-plugin/)构建版本时继承到依赖项目。

在我们的项目中，我们`syncAssets.xml`通过 Eclipse 中的 ADT 为开发人员构建创建了一个 Ant 任务，该任务位于 Android 库项目的基本文件夹中：

```
<?xml version="1.0" encoding="UTF-8"?>
<!-- This is an Ant build script to synchronize assets from Android library "pkonvert-base"
    because they are not included automatically by the ADT tools. See discussion
    at http://stackoverflow.com/questions/5889833/android-library-assets-folder-doesnt-get-copied
    and topic "Library projects cannot include raw assets" at http://developer.android.com/guide/developing/projects/index.html#considerations.
    The Maven build through the maven-android-plugin automatically includes dependent
    assets from referenced Android libraries, so this Ant script only has to
    be executed when the build is executed from within eclipse. -->
<project name="syncAssets" default="syncAssets" basedir=".">

    <property name="sync.source.dir" value="${ant.file}/../assets" />
    <property name="sync.target.dir" value="${basedir}/assets" />

    <target name="syncAssets" description="Synchronize assets from Android library pkonvert-base">
            <echo>Synchronizing assets from ${sync.source.dir} to ${sync.target.dir}</echo>
            <sync todir="${sync.target.dir}">
                    <fileset dir="${sync.source.dir}" includes="**" />
            </sync>
    </target>

    <target name="clean" description="Clean up assets">
            <delete dir="${sync.target.dir}" />
    </target>
</project> 
```

此 Ant 任务将库项目文件夹的内容同步`assets`到项目`assets`文件夹中，并在触发 Eclipse 中的新构建时触发。要将此脚本的执行添加到您的 Android 项目，请转到*Properties* -> *Builders*并创建一个新的*Ant Builder*，它必须是要调用的所有构建器链中的第一个（使用*向上*按钮向上移动 Ant 构建器）。

在 Tab *Main*中选择 Buildfile`${workspace_loc:/<YOUR_LIBRARY_PROJECT>/syncAssets.xml}`和 Base directory `${workspace_loc:/<YOUR_PROJECT>}`。

在选项卡*刷新*中，选择*完成后刷新资源*和*特定资源*，然后选择要刷新的项目文件夹。此外选择*Recursively include subfolders*。

在选项卡*目标*中确保默认目标*在 clean*、*手动构建*和*自动构建*之后执行。目标 clean 应该在*clean*期间执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-21T21:35:50.553

PhoneGap 的 AppLaud Eclipse 插件的源代码可[在此处](http://code.google.com/a/eclipselabs.org/p/mobile-web-development-with-phonegap/source/browse/)获得。创建项目的初始内容来自这个[资源目录](http://code.google.com/a/eclipselabs.org/p/mobile-web-development-with-phonegap/source/browse/tags/r1.2/com.mds.apg/resources/)。您可以将内容修改为您想要的任何内容，然后重新构建插件。由于代码具有 EPL 许可证，因此您必须开源您修改的任何内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T15:08:07.180

您可以将代码放在一个项目中并创建一个 jar 文件。比将此项目或 jar 作为依赖项添加到您的“自定义资源”项目。

# html - 如何使这些按钮不显示为蓝色链接

> ID：10143357
> 
> 赞同：6
> 
> 时间：2012-04-13T15:05:01.603
> 
> 标签：html, css

所以我只是想创建一个小网站。（别担心这不会是标题）现在“主页”“新闻”“画廊”和“关于我们”不是直接指向另一个页面的实际按钮。当我做

```
<a href="Mainpage.htm"> Home </a> 
```

按钮变为紫色并带有下划线。（我知道这是链接的显示方式）但是有没有一种方法可以让这些按钮像图片中一样保持橙色，而不会变成蓝色和带下划线。谢谢 [http://imgur.com/Czsk4](http://imgur.com/Czsk4)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-13T15:11:56.023

您可以内联设置样式，但最好的方法是通过 css 类。

内联：

```
<a href="Mainpage.htm" style="color: #fb3f00; text-decoration: none;">Home</a> 
```

通过一个类来做到这一点：

```
<a href="Mainpage.htm" class="nav-link">Home</a>

a.nav-link:link
{
   color: #fb3f00;
   text-decoration: none;
}
a.nav-link:visited
{
   color: #fb3f00;
   text-decoration: none;
}
a.nav-link:hover
{
   color: #fb3f00;
   text-decoration: none;
}
a.nav-link:active
{
   color: #fb3f00;
   text-decoration: none;
} 
```

要通过一个类来完成，您需要将 css 代码放在一个单独的 css 文件中并将其链接，或者您可以将其放在文档的头部。最佳做法是将其放在外部 css 文件中，以便在整个过程中使用。

如果您希望橙色出现在整个链接中，只需删除类的“.nav-link”部分并从链接标签中删除 class="nav-link"。这将使所有链接变为橙色，除非您定义了另一个类并将其显式应用于链接标记。

祝你好运！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-13T15:07:40.140

使用 CSS 而不是内联样式会更好：

```
a { 
    color:orange;
    text-decoration:none;
} 
```

您还可以变得更漂亮，并在悬停时显示下划线：

```
a:hover, a:focus {
    text-decoration:underline;
} 
```

这可以帮助改善用户体验 (UX)，但如果链接位于标题中，则很明显它们是链接。（当然，UX 设计比这更复杂，因为您必须考虑诸如没有“悬停”的触摸屏用户之类的事情。:)）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-13T15:08:45.767

所有链接都带有不同的状态，因此如果您希望它们仅使用一种颜色，您可以一起修改所有状态，如下所示：

```
a:link, a:visited, a:hover, a:active { color: orange } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-13T15:10:51.553

你可以通过使用 CSS 来做到这一点。在头部末尾的代码中设置它

```
 <style TYPE="text/css">

   a:link, a:visited, a:hover, a:active { color: #ff8080;
       text-decoration: none;
     }

    </style> 
```

并改变你的颜色#ff8080

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-07T12:17:26.113

我有完美的解决方案给你！

我直接从我的代码中复制和粘贴。让它与你相关。这绝对适用于您想要实现的目标。

```
<style type="text/css" media="screen">
a:link { color:#ffffff; text-decoration: none; }
a:visited { color:#33348e; text-decoration: none; }
a:hover { color:#91ac48; text-decoration: none; }
a:active { color:#7476b4; text-decoration: underline; }
</style> <a href="/shop">Order Now</a> 
```

# css - 内联块和列表样式图像的 CSS 问题

> ID：10143358
> 
> 赞同：0
> 
> 时间：2012-04-13T15:05:01.940
> 
> 标签：css

知道为什么当我应用于`display: inline-block`列表元素时，列表样式图像停止出现吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-13T15:07:52.167

列表项最重要的样式属性是其`display`默认值为`list-item`. 该设置是元素与相应的`list-style`. 设置`display`为`inline-block`删除有关列表项的唯一使其成为列表项的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-31T09:22:10.090

如果您希望列表元素使用 inline-block 但仍显示项目符号，则可以使用 ::before 伪元素和 content 属性：

```
li {
 display: inline-block;
}
li::before {
 content: '\25cf\a0';
} 
```

（ \25cf 是 Unicode 实心圆圈符号， \a0 是不间断空格）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-06T14:28:30.680

您可以使用 float:left; 在您的 li 元素上并添加最小宽度和最小高度

```
.footer ul li{
    float: left;
    list-style-image: url(../images/arrow.png);
    margin: 0px 0px 10px 0px;
    box-sizing: border-box;
    min-height: 38px;
    min-width: 300px;
} 
```

# objective-c - 带有模拟 Web 服务的单元测试不断崩溃

> ID：10143359
> 
> 赞同：1
> 
> 时间：2012-04-13T15:05:03.120
> 
> 标签：objective-c, unit-testing, protocols, ocmock

对于我的项目，我想做一点 TDD，尽管我对 Objective C 和单元测试还很陌生。我创建了一个连接到返回 json 响应的 Web 服务的项目。现在我创建了一个单元测试来模拟 Web 服务并且它一直在崩溃（甚至没有失败），我现在完全迷失了......

我有以下设置：

`SignUpService`（创建一个新帐户）使用`ServiceHelper`（发出实际的 http Web 服务请求）。像这样`ServiceHelper.h`：

```
@protocol ServiceHelperProtocol <NSObject> 
@required
- (NSString *)get:(NSString *)url; 
@end

@interface ServiceHelper : NSObject <ServiceHelperProtocol> {
    NSMutableData *receivedData; 
} 
```

和`SignUpService.h`

```
@class ServiceHelper;

@protocol SignUpServiceProtocol <NSObject>
- (NSString *)createUserAccount:(CreateUserAccountRequest *)createUserAccountRequest;
- (bool)doesUsernameExist:(NSString *)userName;
- (BOOL)isEmailValid:(NSString *)email;
- (BOOL)doesEmailExist:(NSString *)email;
@end

@interface SignUpService : NSObject <SignUpServiceProtocol> {
    id <ServiceHelperProtocol> serviceHelper;
}

@property(strong) id <ServiceHelperProtocol> serviceHelper;
- (id)initWithHelper:(id <ServiceHelperProtocol>)myServiceHelper; 
```

接下来是单元测试（SignUpServiceTests.h 和实现）

```
@interface SignUpServiceTests : SenTestCase {
    id <NSObject, ServiceHelperProtocol> serviceHelper;

    SignUpService *signUpService;
    CreateUserAccountRequest *createUserAccountRequest;
}
@property(nonatomic, strong) SignUpService *signUpService;
@property(nonatomic, strong) CreateUserAccountRequest *createUserAccountRequest;
@property(nonatomic, strong) id <NSObject, ServiceHelperProtocol> serviceHelper; 
```

和实施：

```
@implementation SignUpServiceTests

@synthesize signUpService;
@synthesize createUserAccountRequest;
@synthesize serviceHelper;

- (void)setUp {
    [super setUp];

    // Set-up code here.
    self.createUserAccountRequest = [[CreateUserAccountRequest alloc] init];
    self.createUserAccountRequest.firstName = @"first-name";
    self.createUserAccountRequest.lastName = @"last-name";
    .....

    self.serviceHelper = [ServiceHelper new];

    self.signUpService = [[SignUpService alloc] initWithHelper:(id <ServiceHelperProtocol>) self.serviceHelper];
}

- (void)tearDown {
    // Tear-down code here.
    [super tearDown];
}

- (void)testOnCreateUserAccountShouldReturnCreatedUserIdWhenCorrectResponseFromService {
    id mock = [OCMockObject partialMockForObject:(NSObject *) (id <ServiceHelperProtocol>) self.serviceHelper];
    [[[mock stub] andReturn:@"{\"status\":\"ok\",\"create_user\":\"12\"}"] get:[OCMArg any]];

    assertThat([self.signUpService createUserAccount:self.createUserAccountRequest], equalTo(@"12"));
} 
```

该项目包含 OCMock 1.77 版和 OCHamcrest 库。

由于某种原因，测试不断崩溃，并显示“进程以退出代码 0 完成”。当我调试时，我看不到出了什么问题。我觉得它与内存管理有关，还是与 OCMock 和 ARC 有关？（就像[这里](https://stackoverflow.com/questions/8675054/why-is-my-objects-weak-delegate-property-nil-in-my-unit-tests/9058542#9058542)和[这里](https://stackoverflow.com/questions/9104544/how-can-i-get-ocmock-under-arc-to-stop-nilling-an-nsproxy-subclass-set-using-a-w)建议的那样）

对新手 Objective C 开发人员有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T21:07:19.897

如果没有更多信息，我怀疑这不是因为内存问题，而是因为加载程序在启动 octest 时找不到 OCMock 框架。在 OS X 中，链接器（在构建时）使用与加载器（在运行时）不同的方式来定位框架。

OCMock 的公共版本是在加载器路径中使用 @rpath 构建的。这为运行时的项目布局提供了相当程度的灵活性，但一开始可能会令人困惑。作为第一步，您能否确保将 LC_RPATH 环境变量设置为包含 OCMock 框架可用的目录？dyld 手册页上对@rpath 的讨论有更多详细信息。

顺便说一句，OCMock 2.0 最近发布了。

# php - PHP数组通过JSON到jquery数组

> ID：10143361
> 
> 赞同：0
> 
> 时间：2012-04-13T15:05:18.630
> 
> 标签：php, jquery, json

我有点困惑为什么以下不起作用。

**获取.php**

```
<?php

$username="root";
$password="root";
$database="testing";

mysql_connect(localhost,$username,$password);
@mysql_select_db($database) or die( "Unable to select database");

$name= $_GET['name'];

$query="SELECT * FROM tableone ";
$result=mysql_query($query);

$num=mysql_numrows($result);

mysql_close();

$array = array();

$i=0;
while ($i < $num) {

    $first=mysql_result($result,$i,"firstname");
    $last=mysql_result($result,$i,"lastname");
    $date=mysql_result($result,$i,"date");
    $ID=mysql_result($result,$i,"id");

    $array[] = $first;

    $i++;
}

echo json_encode($array);

?> 
```

**jQuery**

```
var arr = new Array();

    $.get("get.php", function(data){
         arr = data;
         alert(arr);
    }, "json"); 
```

当我运行以下命令时，我得到一个看起来像这样的名称列表

```
["James","Lydia","John"] 
```

但是当我尝试挑出诸如 arr[2] 之类的条目时，我只给出了一个“J”，为什么这些元素会像我所期望的那样不是单个条目？

任何人都可以伸出援助之手吗？

谢谢！

**更新**

```
$.get("get.php", function(data){

     arr = $.parseJSON(data);
     alert(arr);
}, "json"); 
```

似乎没有返回结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:07:22.390

`data`包含 JSON 的字符串，因此`arr[2]`将是字符串中的第三个字符。你需要使用`$.parseJSON(data)`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T15:08:20.377

您的 PHP 声称 JSON 是 HTML。您需要明确地说它是 JSON 才能让 jQuery 自动处理它。

```
header("Content-type: application/json"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:11:00.467

通过在 php 中发送 json 标头，`header('Content-type: application/json');`以便 jQuery 自动解码您的 json 数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T15:27:28.653

您不能将数据值赋予数组。

```
 $.get("get.php", function(data){
     alert(data[2]);
}, "json"); 
```

# c# - 下拉缺少关闭选项标签

> ID：10143362
> 
> 赞同：0
> 
> 时间：2012-04-13T15:05:22.243
> 
> 标签：c#, asp.net, .net, sitecore

我有一个下拉列表，但缺少结束选项标签。这会导致站点无法通过针对 XHTML 1.1 的 W3C 验证

这是我的 HTML：

```
<select>
    <option value="">Select...
    <option value="val1">Value One
    <option value="val2">Value Two
</select> 
```

我期望这个：

```
<select>
    <option value="">Select...</option>
    <option value="val1">Value One</option>
    <option value="val2">Value Two</option>
</select> 
```

我都试过了`HtmlSelect`和`DropDownList`。我已经尝试添加`ListItem`和数据绑定以填充它，但我每次都得到相同的 HTML。

知道可能是什么原因造成的吗？

**编辑**

我使用的是 .NET 3.5，该站点是一个 Sitecore 站点。

这是我的文档类型声明：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"> 
```

像这样填充：

```
HtmlSelect dropdown = new HtmlSelect();
dropdown.ID = _Data.ControlID;

List<DataCollectionItem> lisItemCollection = new List<DataCollectionItem>();

foreach (DataCollectionItem item in lisItemCollection)
    dropdown.Items.Add(new ListItem(item.Text, item.Value)); 
```

也试过这个，结果是一样的：

```
dropdown.DataSource = lisItemCollection;
dropdown.DataTextField = "Text";
dropdown.DataValueField = "Value";
dropdown.DataBind(); 
```

浏览器文件：

表单浏览器

```
<browsers>
  <browser refID="Default">
    <controlAdapters>
      <adapter controlType="System.Web.UI.HtmlControls.HtmlForm" adapterType="Sitecore.Web.FormAdapter, Sitecore.Kernel" />
    </controlAdapters>
  </browser>
</browsers> 
```

w3cValidator.browser

```
<browsers> 
  <!--  Browser capability file for the w3c validator 
        sample UA: "W3C_Validator/1.305.2.148 libwww-perl/5.803" 
  --> 
  <browser id="w3cValidator" parentID="default"> 
    <identification> 
      <userAgent match="^W3C_Validator" /> 
    </identification> 

    <capture> 
      <userAgent match="^W3C_Validator/(?'version'(?'major'\d+)(?'minor'\.\d+)\w*).*" /> 
    </capture> 

    <capabilities> 
      <capability name="browser" value="w3cValidator" /> 
      <capability name="majorversion" value="${major}" /> 
      <capability name="minorversion" value="${minor}" /> 
      <capability name="version" value="${version}" /> 
      <capability name="w3cdomversion" value="1.0" /> 
      <capability name="xml" value="true" /> 
      <capability name="tagWriter" value="System.Web.UI.HtmlTextWriter" /> 
    </capabilities> 
  </browser> 
</browsers> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T09:01:29.260

事实证明，这个问题是由于 HTML Agility 包造成的。

```
HtmlNode.ElementsFlags.Remove("option"); 
```

有关更多详细信息，请参阅[此问题](https://stackoverflow.com/questions/7447461/htmlagilitypack-invalid-markup)。

# css - 2列div布局：右列固定宽度，左流体，高度相对于彼此

> ID：10143365
> 
> 赞同：0
> 
> 时间：2012-04-13T15:05:31.340
> 
> 标签：css, html, fixed, fluid

我想要一个包含两列、两个 div 的布局，其中左侧具有流动宽度，右侧具有固定宽度。到目前为止一切顺利 - 请参见下面的 jsfiddle - 但是，右列的高度必须与左列的高度相关。因此，如果我在流体列中有一些内容并且会调整浏览器窗口的大小，从而增加或减少左列的高度，那么右列应该跟随并获得相同的高度。

到目前为止我得到了什么：http: [//jsfiddle.net/henrikandersson/vnUdc/2/](http://jsfiddle.net/henrikandersson/vnUdc/2/)

编辑：已解决，请参阅下面的评论

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:11:59.810

所以，我从@thirtydot 得到了我的问题的答案（见上面的评论）：

> 你需要支持IE7吗？如果没有，您可以使用 display: table-cell

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:14:10.107

啊，旧的两列布局。除非您想借助 JavaScript 来跟踪一列的高度来调整另一列，否则您将无法以您期望的方式进行操作。在这些情况下，使用 height="100%" 通常也不起作用。

你*可以*做的是类似于旧的[仿柱](http://www.alistapart.com/articles/fauxcolumns/)技术。div 不会调整大小，但您在父元素上有一个垂直平铺的背景图像，给人一种等列的错觉。老派，是的，但有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:36:34.280

您可以使用 JavaScript 获取 left 的高度`div`，然后将 right`div`设置为该高度。

要获取左侧 div 的高度：

```
var divHeight = document.getElementById('left').offsetHeight; 
```

设置右 div 的高度：

```
document.getElementById('right').style.height = divHeight+'px'; 
```

[您的 JSFiddle 示例已修复。](http://jsfiddle.net/bz4fu/)

# hibernate - Hibernate 有效，但通过 Web 服务调用时无效

> ID：10143367
> 
> 赞同：0
> 
> 时间：2012-04-13T15:05:35.693
> 
> 标签：hibernate, tomcat

我有一个使用休眠连接到数据库并检索数据的方法。当作为独立的 java 应用程序执行时，该方法工作正常。但是，当我尝试将其部署在 tomcat 上并作为 Web 服务调用时，出现如下错误。我的方法是第一个也是唯一一个建立数据库连接的地方，即我没有在tomcat 中定义任何数据源。

```
No Hibernate Session bound to thread, and configuration does not allow creation 
of non-transactional one here
at
org.springframework.orm.hibernate3.LocalSessionFactoryBean$TransactionAwareInvocationHandler.invoke(LocalSessionFactoryBean. 
```

我的休眠配置文件：

```
<bean id="mySessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <property name="dataSource" ref="myDataSource" />
    <property name="exposeTransactionAwareSessionFactory" value="true" />
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.HSQLDialect</prop>
            <prop key="hibernate.show_sql">true</prop>
            <prop key="hibernate.hbm2ddl.auto">none</prop>
            <prop key="hibernate.statement_cache.size">10</prop>
            <prop key="hibernate.c3p0.min_size">1</prop>                
            <prop key="hibernate.c3p0.max_size">10</prop>
            <prop key="hibernate.connection.autocommit">false</prop>
            <prop key="hibernate.default_schema">${mydbSchema}</prop>
            <prop key="hibernate.current_session_context_class">thread</prop>        
            <prop key="hibernate.transaction.manager_lookup_class">com.atomikos.icatch.jta.hibernate3.TransactionManagerLookup</prop>                
        </props>
    </property>
</bean> 
```

我正在使用以下休眠模块：

休眠注释 3.4.0.GA，休眠核心 3.3.1.GA，休眠 3.2.6.ga，休​​眠公共注释 3.1.0.GA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T16:24:08.497

您的方法需要在事务中调用。或者您的方法需要使用事务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T17:46:15.463

如果实现服务器端 Web 服务的类是 Spring bean，只需将访问数据库的方法用`@Transactional`. 如果不是这种情况，请将该注释添加到作为 WS 和 DAO 之间的中介的其他一些 Spring bean。

如果`@Transactional`对您不起作用，您可以随时使用[`TransactionTemplate`](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/transaction/support/TransactionTemplate.html).

# security - 访问工具/参考时要求输入密码

> ID：10143372
> 
> 赞同：2
> 
> 时间：2012-04-13T15:05:50.993
> 
> 标签：security, ms-access, reference

我正在尝试访问 Access 数据库上的参考资料。我对这个数据库不是很熟悉，但这是我的历史：

我试图打开代码文件一次，它要求输入密码 之前的开发人员向我保证没有密码，他能够很好地进入代码文件。然后我尝试了，令我惊讶的是，它不再要求我输入密码 今天我尝试进入工具/参考，密码框又回来了。

据称这个 mdb 不应该受到保护。如果弄清楚如何克服这个问题，任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T09:59:46.320

最初的程序员删除了进入代码所需的密码，但后来我们发现还有另一个级别的安全保护项目引用。最初的程序员无法弄清楚如何删除该密码，但他能够将其更改为非个人的密码。

所以我从来没有真正得到我正在寻找的答案，但我认为这个故事的寓意是人们不需要为他们的工作使用个人密码，这样当我接管他们的工作时，他们就可以告诉我它是什么而不是让我等一个月让他们回来改变它。

# iphone - iCloud 似乎只在启动时起作用

> ID：10143376
> 
> 赞同：2
> 
> 时间：2012-04-13T15:06:03.170
> 
> 标签：iphone, ipad, icloud

我正在尝试创建一个使用 Core Data 的 iCloud 应用程序。为此，我使用了`UIManagedDocument`. 对于`persistentStoreOptions`，我`NSPersistentStoreUbiquitousContentNameKey`为`NSPersistentStoreUbiquitousContentURLKey`. 正如 Apple 建议的那样，我像这样打开文档：

```
if ([[NSFileManager defaultManager] fileExistsAtPath:[urlOfDatabase path]])
{
    [_database openWithCompletionHandler:^(BOOL success) { ... }];
}
else
{
    [_database saveToURL:urlOfDatabase
        forSaveOperation:UIDocumentSaveForCreating
       completionHandler:^(BOOL success) { ... }];
} 
```

另外，我注册了`NSPersistentStoreDidImportUbiquitousContentChangesNotification`s，并在该方法中合并了通知中的上下文。

为了测试应用程序，我使用了 iPad 和 iPhone。当我在一台设备上运行它，添加一些数据并在另一台设备上打开它时，会显示正确的数据。但是，如果我在应用程序在两台设备上运行时添加数据，它要么不会更新（我至少等了 10 分钟一次），要么会在几分钟后更新，但只会出现一大堆错误消息：“项目下载失败。”。

我在设置中错过了什么（希望是显而易见的）吗？

# php - 如何使用 2 个表选择数据并仅显示表 1 中的数据

> ID：10143378
> 
> 赞同：0
> 
> 时间：2012-04-13T15:06:08.047
> 
> 标签：php

我有一个名为 student 的表，其中有几个字段，包括：

学生矩阵

我有另一个名为参与的表，其中有几个字段，包括：

程序 ID

学生矩阵

地位

我需要的查询是，它将显示学生表中的所有数据。它将检查参加过某个项目的学生不能再参加该项目。

看起来是这样的，点击添加按钮后..状态变为加入..被讲座选择的学生，不能再被选择......这个系统被讲座使用......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:13:56.020

如果（1）我正确理解您要做什么；并且 (2)`student_matric`是一个外键（或者至少是第二个表中的一个引用字段，那么您可以尝试执行以下操作：

```
SELECT field1, field2, ..., fieldN
  FROM student
 WHERE student_matric NOT IN (SELECT student_matric FROM participation WHERE progra_id=your_value) 
```

# windows - 在批处理脚本中使用文本文件中的数据

> ID：10143380
> 
> 赞同：0
> 
> 时间：2012-04-13T15:06:11.167
> 
> 标签：windows, batch-file, dos

批次内容：

```
FOR /F "tokens=1,*" %%i IN (list.txt) DO (
    cd "%%j"
    Echo %CD%
    pause
) 
```

执行运行：

```
C:\Dwn>tmp1.bat

C:\Dwn>FOR /F "tokens=1,*" %i IN (list.txt) DO (
cd "%j"
 Echo C:\Dwn
 pause
)

C:\Dwn>(
cd "%APPDATA%\Microsoft\Windows\Start Menu\Programs\Administrative Tools"
 Echo C:\Dwn
 pause
)
The system cannot find the path specified.
C:\Dwn
Press any key to continue . . . 
```

怎么会`the system cannot find the path specified`？如果我复制该`cd`命令并自行执行它，它工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:23:21.590

它失败了，因为 %%j 的值包含 %APPDATA%。当你扩展 %%j 时，%APPDATA% 的值不会被扩展，因为环境变量扩展发生在 FOR 变量扩展之前。

解决方法是`call cd "%%j"`改用。CALL 将导致命令经过额外级别的 %VAR% 扩展，这正是您想要的。

您还有一个问题是`echo %CD%`在同一个 DO 代码块中使用。它将在您更改之前回显当前目录的值，因为在解析整个 FOR 语句时会扩展 %CD% 的值。您可以通过使用或通过使用和使用`call echo %CD%`启用延迟扩展来解决此问题。但最简单的解决方法是简单地使用; 不带任何参数的 CD 命令会将当前目录打印到屏幕上。`SETLOCAL EnableDelayedExpansion``echo !CD!``cd`

# actionscript-3 - 如何更改文本输入 Flex 4 的文本光标颜色？

> ID：10143387
> 
> 赞同：0
> 
> 时间：2012-04-13T15:06:42.593
> 
> 标签：actionscript-3, apache-flex, flex4, textinput

我想更改 Flex 4 中文本输入的闪烁文本光标颜色...如何更改？

有什么办法可以处理，还是只能通过Flash Player控制？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:41:49.067

不久前我有一个类似的问题。我从来没有找到更新实际光标的方​​法，所以我对解决方案很有创意。我的解决方案是堆叠两个文本字段。动态字段顶部的一个输入字段。

将输入字段的 alpha 设置为 0。然后，将 CHANGE 事件侦听器添加到输入字段。在处理程序中，更新动态字段并根据 textWidth 重新定位光标。

不理想，但它完成了工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T15:47:31.557

我已经解决了这个问题，

实际上，文本输入的蒙皮存在问题。如果我们将 textinput 皮肤的 richeditabletext 的 alpha 设置为 75 或某个向下值，flash 播放器会将光标颜色本身设为白色。

因此，通过增加该 alpha 值，我将光标颜色变为黑色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T22:28:32.243

我更改了 TextField.textColor = OxFFFFFF，光标也变为白色。当我需要闪烁光标和文本的颜色相同时，适用于我的情况。

# c - 如何将分配的内存分解为几个区域并分配进程？

> ID：10143389
> 
> 赞同：-1
> 
> 时间：2012-04-13T15:06:47.440
> 
> 标签：c, linux, memory, memory-management

我了解如何通过使用分配“一大块”内存

```
int shmget(IPC_PRIVATE, int size, IPC_CREAT | 0666) 
```

但是，如何将这一内存区域分解为多个区域？例如，

```
[          heap           ]
[region1][region2][region3] 
```

然后，我相信在我必须使用的每个分叉进程中

```
int shmget(key_t shmid, 0, 0666) 
```

访问我猜的区域？

我还在很多与内存分配相关的在线网站上看到“偏移”一词……这是什么意思？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T16:32:32.573

在现代 linux 系统上，没有太多理由使用`shmget`& Co。`shm_open`与 , 一起使用`mmap`。该界面更易于使用。

我不明白您是否想自愿划分地图，或者这只是您所读内容的结果`shmget`。但是`mmap`，如果您愿意，您可以轻松地绘制该地区的部分地图。

# jquery - jQuery 在悬停时加载 div 并能够与该 div 交互

> ID：10143390
> 
> 赞同：0
> 
> 时间：2012-04-13T15:06:47.940
> 
> 标签：jquery, css, html

我正在尝试创建一个悬停来加载 Facebook 和 Twitter 的社交提要。

我已经把 jQuery 放在一起了。但是我遇到了一个问题，即一旦用户将鼠标悬停在按钮之外，它就会淡出并且您无法单击该信息。

我为此创建了一个[jsFiddle](http://jsfiddle.net/ujBZY/)，如您所见，您将鼠标悬停在它加载内容的 a.social 上。但是一旦您尝试与加载的 DIV 交互，它就会消失。

我怎样才能使用户仍然可以单击打开的 div 中的信息？

jQuery代码如下：

```
$(".social_facebook").css('display','none');
$(".social_twitter").css('display','none');

    $('a.facebook').hover(function() {
        $('.social_facebook').fadeIn("slow");
    }, function() {
        $('.social_facebook').fadeOut("slow");
    });

    $('a.twitter').hover(function() {
        $('.social_twitter').fadeIn("slow");
    }, function() {
        $('.social_twitter').fadeOut("slow");
    }); 
```

这包含在 document.ready 函数中。

提前致谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:14:01.793

我想您想展示其中任何一个，如果是这样，请尝试以下方法。

[**演示**](http://jsfiddle.net/ujBZY/15/)

```
$(".social_facebook").css('display','none');
$(".social_twitter").css('display','none');

$('a.facebook').mouseenter(function() {
    $('.social_twitter').fadeOut("slow", function () {
        $('.social_facebook').fadeIn("slow");
    });        
});

$('a.twitter').mouseenter(function() {
    $('.social_facebook').fadeOut("slow", function () {
        $('.social_twitter').fadeIn("slow");
    });        
});

 //Added
$('.social_facebook, .social_twitter').mouseout(function () {
   $(this).fadeOut('slow');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:12:57.847

因为您已将`mouseout`方法设置为隐藏而`div`没有意识到。该`$.hover`方法的第二个函数参数实际上是告诉它当鼠标离开目标时要做什么。

这是您更新的小提琴：http: [//jsfiddle.net/ujBZY/2/](http://jsfiddle.net/ujBZY/2/)

要在离开“区域”时隐藏它们，只需定义一个包装元素并添加一个`mouseout`：

```
$('.main-area').mouseout(function() {
    $('.social_facebook').hide();
    $('.social_twitter').hide();
}); 
```

请记住，您的社交元素必须在该区域内，因此您必须更改它们的一些显示属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T15:19:17.360

尝试这样的事情：http: [//jsfiddle.net/ujBZY/9/](http://jsfiddle.net/ujBZY/9/)

```
ul {
    margin:0;
    padding:0;
}
li.social {
    display: inline-block;
    list-style:none;
    overflow:visible;
}
 a {
    display: block;
    height: 61px;
    margin: 0 5px;
    text-indent: -9000px;
    width: 61px;
}

.social_facebook, .social_twitter {
    position: absolute;
    right:0;
    background: white;
    z-index: 1000;
}

.sociallinks {
    float: right;
}

.facebook {
    background: url(http://i44.tinypic.com/smys80.png) no-repeat;
}

.twitter {
    background: url(http://i44.tinypic.com/10fno04.png) no-repeat;
}
<div class="span5">
    <div class="sociallinks">
        <ul>
            <li class="social"><a href="#" target="_blank" class="facebook" title="Join Us on Facebook">Join us on Facebook</a>
                <!-- Hidden Social Feeds -->
                <div class="social_facebook">
                        FACEBOOK HERE
                </div>
            </li>
            <li class="social"><a href="#" target="_blank" class="twitter" title="Follow Us on Twitter">Follow us on Twitter</a>
                <div class="social_twitter">    
                    <a href="http://twitter.com/" title="Follow us on Twitter">Latest Tweet</a>
                    <a href="https://twitter.com/twitter" class="twitter-follow-button" data-show-count="false" data-lang="en" data-size="large">Follow @twitter</a>

                    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>  
                </div>
            </li>
        </ul>                
    </div>
</div>

$(".social_facebook").css('display','none');
$(".social_twitter").css('display','none');

$('.social').hover(function() {
    $('div', this).stop().fadeIn("slow");
}, function() {
    $('div', this).stop().fadeOut("slow");
}); 
```

# sql - 我在哪里可以找到有关 ActiveRecord 优化的资源和信息？

> ID：10143391
> 
> 赞同：0
> 
> 时间：2012-04-13T15:06:53.153
> 
> 标签：sql, ruby-on-rails, activerecord

最近，我开始研究一个庞大的 Rails 3.1 项目，该项目包含每个控制器操作的多个 SQL 查询，并广泛而有意地使用 AR 查询 DSL。其中许多查询由嵌套的 where、join 和 merge 子句组成。当然，这一切都使应用程序在某些部分变得非常缓慢，我想知道有哪些资源、书籍、博客可以帮助 Railers 处理它？

我感谢对任何相关来源的任何建议。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:38:21.790

我建议你[The Ruby Reflector/SQL](http://rubyreflector.com/SQL)。顺便说一下，看看这个[源](http://www.ibm.com/developerworks/web/library/wa-rails3/)。

# internationalization - JavaFX 2 和国际化

> ID：10143392
> 
> 赞同：88
> 
> 时间：2012-04-13T15:06:53.590
> 
> 标签：internationalization, javafx-2

在学习了基础知识后，我刚刚开始编写我的第一个 JavaFX 2 应用程序，并希望将其国际化。

我注意到在 JavaFX 1.x 中，脚本语言允许非常简单的字符串国际化。JavaFX 2 中是否有任何类似的功能？

基本上：国际化 JavaFX 2 应用程序的最佳实践是什么？

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2012-04-13T20:58:17.880

java 应用程序国际化的基本步骤（除其他外）是`Locale`lizing 和资源捆绑。在 JavaFX 中，您可以`FXMLLoader#setResources()`用于此目的。这里有一个 SSCCE 演示来演示它。代码是自我描述的。
演示包结构：

```
bundledemo
    |------ BundleDemo.java
    |------ MyController.java
    |------ MyView.fxml  
bundles
    |------ MyBundle_en.properties
    |------ MyBundle_kg.properties 
```

MyBundle_en.properties

```
key1=Name Surname
key2=How are you? 
```

MyBundle_kg.properties

```
key1=Aты Жөнү
key2=Кандайсың? 
```

我的视图.fxml

```
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.*?>

<BorderPane fx:controller="bundledemo.MyController" xmlns:fx="http://javafx.com/fxml">
    <top>
        <!-- This label's text will be set by the controller -->
        <Label fx:id="lblTextByController"/> 
    </top>
    <center>
        <!-- This label's text will be taken from the bundle automatically -->
        <Label text="%key2"/>
    </center>
</BorderPane> 
```

MyController.java

```
package bundledemo;

import java.net.URL;
import java.util.ResourceBundle;
import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import javafx.scene.control.Label;

public class MyController implements Initializable {

    @FXML private Label lblTextByController;
    private ResourceBundle bundle;

    @Override
    public void initialize(URL location, ResourceBundle resources) {
        bundle = resources;
        lblTextByController.setText(bundle.getString("key1"));
    }
} 
```

BundleDemo.java

```
package bundledemo;
// imports are ignored.

public class BundleDemo extends Application {

    private Stage stage;

    @Override
    public void start(Stage primaryStage) {
        stage = primaryStage;
        Button btnEN = new Button();
        btnEN.setText("English");
        btnEN.setOnAction(new EventHandler<ActionEvent>() {
            @Override public void handle(ActionEvent event) {
                loadView(new Locale("en", "EN"));
            }
        });

        Button btnKG = new Button();
        btnKG.setText("Kyrgyz");
        btnKG.setOnAction(new EventHandler<ActionEvent>() {
            @Override public void handle(ActionEvent event) {
                loadView(new Locale("kg", "KG"));
            }
        });

        VBox root = new VBox(20);
        root.getChildren().add(HBoxBuilder.create().spacing(10).style("-fx-background-color: gray").padding(new Insets(5)).children(btnEN, btnKG).build());
        root.getChildren().add(new StackPane());
        primaryStage.setScene(new Scene(root, 300, 250));
        primaryStage.show();
    }

    private void loadView(Locale locale) {
        try {
            FXMLLoader fxmlLoader = new FXMLLoader();
            fxmlLoader.setResources(ResourceBundle.getBundle("bundles.MyBundle", locale));
            Pane pane = (BorderPane) fxmlLoader.load(this.getClass().getResource("MyView.fxml").openStream());
            // replace the content
            StackPane content = (StackPane) ((VBox) stage.getScene().getRoot()).getChildren().get(1);
            content.getChildren().clear();
            content.getChildren().add(pane);
        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }

    public static void main(String[] args) {
        launch(args);
    }
} 
```

截屏：

![在此处输入图像描述](../Images/2ea0060689f1d6e69182e4e0e408f28f.png)

* * *

如果您的国际化文本需要以可能在用户目标系统上的字体呈现，那么您可以：

1.  将字体嵌入到您的应用程序中：

*   [如何嵌入 .ttf 字体是 JavaFx 2.2？](https://stackoverflow.com/questions/16855677/how-to-embed-ttf-fonts-is-javafx-2-2)

或者

2.  [在 JavaFX 中使用 web(Google) 字体](http://fxexperience.com/2012/12/use-webgoogle-fonts-in-javafx/)。

如果所需的字体不可用，则国际化文本可能会显示为难以理解的乱码，即使有关设置的其他一切都很好。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-05-16T21:55:33.413

这对我有用：

```
└───src
    ├───app
    ├───bundles // <- here the "bundles"
    ├───dicts
    ├───images
    ├───libs
    └───resources 
```

在捆绑包中

```
LangBundle_en.properties
LangBundle_de.properties 
```

样本内容：

```
enter_pwd=Enter your password: 
```

要加载它们，我使用以下代码：

```
@Override
public void initialize(URL location, ResourceBundle resources) {
    ResourceBundle lngBndl = ResourceBundle
            .getBundle("bundles.LangBundle", new Locale("en", "EN"));

    tvSetupPwd.setText(lngBndl.getString("enter_pwd"));
    // ...
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-08-31T11:24:37.267

看我的例子 [![在此处输入图像描述](../Images/a3775c743f45c8672fb389c458cdeff5.png)](https://i.stack.imgur.com/B1fhf.png)

我[在这里](https://stackoverflow.com/a/45979456/3937190)或在[GitHub 上描述的更多内容](https://github.com/mcka-dev/javafx-internationalization-maven-example)

更新：

解决方案在`Messages.java`

```
/**
 * The class with all messages of this application.
 */
public abstract class Messages {

    private static ResourceBundle BUNDLE;

    private static final String FIELD_NAME = "lookup";
    private static final String BUNDLE_NAME = "messages/messages";
    private static final String CONTROLS_BUNDLE_NAME = "com/sun/javafx/scene/control/skin/resources/controls";

    public static final String MAIN_APP_TITLE;

    public static final String DIALOG_HEADER;
    public static final String MAIN_CONTROLLER_CONTENT_TEXT;
    public static final String MAIN_CONTROLLER_HELLO_TEXT;
    public static final String MAIN_CONTROLLER_GOODBYE_TEXT;

    static {
        final Locale locale = Locale.getDefault();
        final ClassLoader classLoader = ControlResources.class.getClassLoader();

        final ResourceBundle controlBundle = getBundle(CONTROLS_BUNDLE_NAME,
                locale, classLoader, PropertyLoader.getInstance());

        final ResourceBundle overrideBundle = getBundle(CONTROLS_BUNDLE_NAME,
                PropertyLoader.getInstance());

        final Map override = getUnsafeFieldValue(overrideBundle, FIELD_NAME);
        final Map original = getUnsafeFieldValue(controlBundle, FIELD_NAME);

        //noinspection ConstantConditions,ConstantConditions,unchecked
        original.putAll(override);

        BUNDLE = getBundle(BUNDLE_NAME, PropertyLoader.getInstance());

        MAIN_APP_TITLE = BUNDLE.getString("MainApp.title");

        DIALOG_HEADER = BUNDLE.getString("Dialog.information.header");
        MAIN_CONTROLLER_CONTENT_TEXT = BUNDLE.getString("MainController.contentText");
        MAIN_CONTROLLER_HELLO_TEXT = BUNDLE.getString("MainController.helloText");
        MAIN_CONTROLLER_GOODBYE_TEXT = BUNDLE.getString("MainController.goodbyeText");
    }

    public static ResourceBundle GetBundle() {
        return BUNDLE;
    }
} 
```

并且在`PropertyLoader.java`

```
public class PropertyLoader extends ResourceBundle.Control {

    private static final String PROPERTIES_RESOURCE_NAME = "properties";

    private static final PropertyLoader INSTANCE = new PropertyLoader();

    public static PropertyLoader getInstance() {
        return INSTANCE;
    }

    @Override
    public ResourceBundle newBundle(final String baseName, final Locale locale, final String format,
                                    final ClassLoader loader, final boolean reload)
            throws IllegalAccessException, InstantiationException, IOException {

        final String bundleName = toBundleName(baseName, locale);
        final String resourceName = toResourceName(bundleName, PROPERTIES_RESOURCE_NAME);

        ResourceBundle bundle = null;
        InputStream stream = null;

        if (reload) {

            final URL url = loader.getResource(resourceName);

            if (url != null) {
                final URLConnection connection = url.openConnection();
                if (connection != null) {
                    connection.setUseCaches(false);
                    stream = connection.getInputStream();
                }
            }

        } else {
            stream = loader.getResourceAsStream(resourceName);
        }

        if (stream != null) {
            try {
                bundle = new PropertyResourceBundle(new InputStreamReader(stream, StandardCharsets.UTF_8));
            } finally {
                stream.close();
            }
        }

        return bundle;
    }
} 
```

# excel - 在excel中查找重复行

> ID：10143396
> 
> 赞同：12
> 
> 时间：2012-04-13T15:07:22.387
> 
> 标签：excel

我有一个两行的 Excel 电子表格。一个用于名称，另一个用于标识。有什么方法可以找到具有完全相同 id 的行并让我轻松查看这些行吗？例如，我有以下行：

```
Name:     Id
Hello     1
World     5
Mylo      1
Jack      6
Jil       9
Frank     5 
```

因此，在上面的示例数据中，excel 应该以某种方式用 hello 和 mylo 以及 world 和 frank 标记行，以表明这些行有重复的 id

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-13T15:26:17.423

绝对最快和最简单的方法。条件格式，突出显示重复项（在 ID 列上）。然后通过颜色（复选框上方）过滤列（可能在表格中）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-13T15:32:39.657

在第三列中，您可以添加此公式（单元格 B3 示例）：

```
=IF(COUNTIF(B$2:B$7,"="&B2)>1,"<--Dup!","") 
```

您将不得不调整范围`B$2:B$7`以反映实际数据范围...

# java - java中优雅的字符串替换

> ID：10143400
> 
> 赞同：0
> 
> 时间：2012-04-13T15:07:27.570
> 
> 标签：java, string, replace

我有一个字符串，我必须替换一些内容：

```
"...content... <a href='document/link/B1'>foo</a> ...content... <a href='document/link/B2'>bar</a> ..." 
```

我正在寻找一种干净的方法来获得这样的东西：

```
"...content... <a href='document/link/23'>foo</a> ...content... <a href='document/link/24'>bar</a> ..." 
```

链接中的“23”和“24”是我所做的一些处理的结果。所以首先我应该能够选择链接，获取它们的 url（更具体地说：我需要 B1 和 B2）然后我必须使用例如 B1 执行一些操作，这会导致“23”，然后我必须再次插入在字符串中。

有没有很好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:23:28.853

一般来说，使用正则表达式解析 HTML/XML 是个坏主意。但是对于一些零星的使用（只运行一次），如果你确定你的 HTML 的结构并且不需要太多的健壮性，像这样的东西（基于[this](https://stackoverflow.com/questions/1326682/java-replacing-multiple-different-substring-in-a-string-at-once-or-in-the-most)）可以做到这一点：

```
 String original = "..content... <a href='document/link/B1'>foo</a> ...content... <a href='document/link/B2'>bar</a> ...";
   StringBuffer sb = new StringBuffer();
   // tweak the following
   Pattern pattern = Pattern.compile("(<a href='document/link/)([^']*)('>)");
   Matcher matcher = pattern.matcher(original);
   while(matcher.find()) {
      String oldlinkPart = matcher.group(2);
      String newlinkPart = buildNewLinkPart(oldLinkPart); // here you do your look-up
      matcher.appendReplacement(sb, matcher.group(1) + newlinkPart + matcher.group(3));
   }
   matcher.appendTail(sb);
   String modified = sb.toString(); 
```

您可以将正则表达式模式调整为更通用（更多空格、制表符、A 标记内的其他属性、区分大小写、双引号），但是当您开始假装*完全*通用时，您的代码可以正常工作形成 HTML，然后你就搞砸了：尝试使用 XML/DOM 解析器。

# objective-c - 使用不推荐使用的方法

> ID：10143412
> 
> 赞同：0
> 
> 时间：2012-04-13T15:07:50.283
> 
> 标签：objective-c, ios

> **可能重复：**
> [Apple 会接受带有已弃用代码的应用程序吗？](https://stackoverflow.com/questions/7909986/will-apple-accept-apps-with-deprecated-code)

我正在开发一个 iPhone 应用程序，我正在使用这样的方法：

```
- (NSString*)udid
{
    UIDevice* device = [UIDevice currentDevice];
    return [device.uniqueIdentifier stringByReplacingOccurrencesOfString:@"-" withString:@""];
} 
```

但我已经看到“uniqueIdentifier”已被弃用。它工作正常的问题，我想知道如果我像这样在商店中发布我的应用程序会发生什么（使用不推荐使用的方法）

谢谢你的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:11:37.553

一般来说，不要使用已弃用的 api，因为它们很可能会从未来的版本中删除。此外，API 通常已被弃用，因为它们已过时或次优，并且通常有一种更新、更好的方法来做你想做的任何事情。

在你的情况下，*绝对*不要，因为这个原因： http: [//gigaom.com/apple/apple-cracks-down-on-udid-use/](http://gigaom.com/apple/apple-cracks-down-on-udid-use/)

我相信流行的替代方法是在第一次运行时创建一个 UUID（它将是唯一的，但不绑定到设备）并将其保存以供后续运行参考。如果你用谷歌搜索它，它已经被广泛讨论了。

# nsstring - 将 NSString 变量添加到 plist 文件中时出错

> ID：10143413
> 
> 赞同：0
> 
> 时间：2012-04-13T15:07:50.947
> 
> 标签：nsstring, plist

我有一个问题我一直在努力解决......请帮助。

我正在使用以下代码行将记录添加到 plist 文件中：

[data_appo setObject:@"string value" forKey:[NSString stringWithFormat:@"%i",(i-1)]];

它工作正常。现在，如果我尝试从文件中读取字符串而不是添加它（我需要使用不同的键复制值），如下所示

NSString *string_appo=[data_appo objectForKey:[NSString stringWithFormat:@"%i",j]];

[data_appo setObject:string_appo forKey:[NSString stringWithFormat:@"%i",(i-1)]];

然后我 gest ERROR_EXEC 并且应用程序崩溃了......

任何想法？？？

任何帮助将不胜感激

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T09:03:11.450

添加后是否保存了plist文件。我经常这样做并且我这样做

```
 //find the plist file
        NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES); 
        NSString *documentsDirectory = [paths objectAtIndex:0]; 
        NSString *path = [documentsDirectory stringByAppendingPathComponent:@"Notes.plist"]; 
    //set the value for the key
        [notesData setValue:textView.text forKey:[NSString stringWithFormat:@"General notes %d",selectedIndex]];
    //save the plist file   
        [notesData writeToFile: path atomically:YES];
    //relese and reload it
        [notesData release];
        notesData = [[NSMutableDictionary alloc] initWithContentsOfFile: path]; 
```

我希望这有帮助！

# php - 如何在 Magento Admin 的交易屏幕中填写“交易详情”键/值表？

> ID：10143416
> 
> 赞同：1
> 
> 时间：2012-04-13T15:07:56.023
> 
> 标签：php, magento, checkout

我已经创建了一个自定义支付网关，但现在我需要处理支付后通知（就像 IPN 一样）以附加给定交易的附加信息。

我尝试了很多不同的组合，包括：

```
Mage::getModel('sales/order')->load('#id')
    ->getPayment()
        ->getTransaction('#id')
            ->setAdditionalInformation('foo', 'bar')
                ->save(); 
```

这不会产生任何错误（我能够检索订单/付款/交易）但保存操作似乎无法操作。我也尝试通过付款对象进行保存，但没有运气。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:36:25.803

自己发现的:P

```
$payment->getTransaction($id)
    ->setAdditionalInformation(
        Mage_Sales_Model_Order_Payment_Transaction::RAW_DETAILS,
        $data
    )->save(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-20T18:51:33.240

如果您尝试在 paymnet 的“授权”阶段包含信息，这里有一个有用的片段（请将变量更改为您自己的数据！）：

```
public function authorize(Varien_Object $payment, $amount) {
    .....
   $_data = array( 'Tranx' => $_transax, 'Auth' => $_autho ...);
   $payment->setTransactionAdditionalInfo(
                Mage_Sales_Model_Order_Payment_Transaction::RAW_DETAILS,
                $_data);
   $payment->setTransactionId($_authid)->setIsTransactionClosed(0);
   return $this
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-26T09:05:17.590

```
$transactin_detail = Mage::getModel('sales/order')->loadByIncrementId($order_id)->getPayment()->getTransaction($transId)->save();

echo '<pre>';
print_r($transactin_detail); 
```

# exception - 为什么 Json.NET 序列化会因 [Serializable] 和只读属性中的 lambda 而失败？

> ID：10143420
> 
> 赞同：3
> 
> 时间：2012-04-13T15:08:14.887
> 
> 标签：exception, serialization, .net-4.0, json.net

根据[这些发行说明](http://james.newtonking.com/archive/2012/04/11/json-net-4-5-release-2-serializable-support-and-bug-fixes.aspx)，Json.NET 现在支持 SerializableAttribute：

> Json.NET 现在检测具有 SerializableAttribute 的类型，并序列化该类型上的所有字段，包括公共的和私有的，并忽略这些属性。

我有以下示例代码引发`JsonSerializationException`：

> 从“ConsoleApplication1.MyType”上的“CS$<>9__CachedAnonymousMethodDelegate1”获取值时出错。

如果我评论 TotalWithLambda 属性，则序列化按预期成功。事实上，我得到以下结果：

*   离开[Serializable]，离开TotalWithLambda：抛出JsonSerializationException
*   离开 [Serializable]，移除 TotalWithLambda: 仅序列化“myList”
*   移除[Serializable]，留下TotalWithLambda：序列化“myList”、“Total”和“TotalWithLambda”
*   移除[Serializable]，移除TotalWithLambda：序列化“myList”和“Total”

我了解所有这些情况，除了第一个。为什么 [Serializable] 和带有 lambda 的只读属性的组合会导致此异常？

```
namespace ConsoleApplication1
{
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using Newtonsoft.Json;

    class Program
    {
        static void Main(string[] args)
        {
            var foo = new MyType();
            foo.myList = new List<int>() { 0, 1, 2, 3 };

            var returnVal = JsonConvert.SerializeObject(foo);

            Console.WriteLine("Return: " + returnVal.ToString());
            Console.ReadKey();
        }
    }

    [Serializable]
    class MyType
    {
        public IList<int> myList;
        public int Total { get { return this.myList.Sum(); } }
        public int TotalWithLambda { get { return this.myList.Sum(x => x); } }
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T18:29:15.437

我安装并使用[了 JustDecompile](http://www.telerik.com/products/decompiler.aspx)，发现当 lambda 未注释时，编译器会在类中添加一个字段和一个方法：

```
public class MyType
{
    [CompilerGenerated]
    private static Func<int, int> CS$<>9__CachedAnonymousMethodDelegate1;

    [CompilerGenerated]
    private static int <get_TotalWithLambda>b__0(int x) { ... }

    // ... plus the other class members ...
} 
```

当类上有 SerializableAttribute 时，Json.NET 会尝试序列化私有字段，但不能因为它是 type `Func<int, int>`。删除 SerializableAttribute 会指示 Json.NET 忽略私有字段，因此不会导致问题。

**更新：** Json.NET 4.5 第 3 版现在只有在显式设置 时才会出现此问题`IgnoreSerializableAttribute=false`，或者可以通过将 添加`JsonObjectAttribute`到类中来解决。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T21:46:40.450

我在第 3 版中默认将 IgnoreSerializableAttribute 更改为 true，这撤消了第 2 版中引入的重大更改 - [http://json.codeplex.com/releases/view/85975](http://json.codeplex.com/releases/view/85975)

你可以在这里阅读更多关于它的信息 - [http://json.codeplex.com/discussions/351981](http://json.codeplex.com/discussions/351981)

# delphi - 是否可以使用 TImage 和 GDIPlus 打开图像并保持完全透明

> ID：10143422
> 
> 赞同：3
> 
> 时间：2012-04-13T15:08:19.677
> 
> 标签：delphi, gdi+

我可以使用 GDIPlus 在 TImage 中显示一个 32 位图像，该图像具有部分（蒙版）透明度，但 alpha 值为 0 或 255，两者之间没有值。我尝试加载 PngImage，32 位位图和图标都产生相同的......蒙版透明度但不是完全透明度。

是否有另一种方法可以让 TImage 显示具有完全透明度的 GDI+ 图形，如所需结果图像中所示？

![在此处输入图像描述](../Images/267bab78495dd89b93f483a699e575ac.png) GDI Plus 开启后

![在此处输入图像描述](../Images/af9f6f93a5efb9be5883b4b65c04fd6e.png) 期望的结果

```
procedure TFormMain.Open1Click ( Sender: TObject );
// Load a GDIPlus Bitmap into TImage
var
  GPBitmap: TGPBitmap;
  iHBitmap: HBITMAP;
  iStatus: TStatus;
const
  TRANS_COLOR = clBlack;
begin

  if OpenPictureDialog1.Execute then
  begin

    FilePath := OpenPictureDialog1.FileName;
    begin

      GPBitmap := TGpBitmap.Create ( FilePath );
      try

        iStatus := GPBitmap.GetHBITMAP ( aclBlack, iHBitmap );
        // As best as I can determine from the internet, the GetHBitmap which is needed to assign a GPbitmap to TImage
        // does not hold an alphachannel, so loaded images alpha are either 0 or 255, but drawing with alphachannel values does work.
        if iStatus = Ok then
        begin

          Image1.Picture.Bitmap.Handle := iHBitmap;
          Image1.Picture.Bitmap.TransparentColor := Image1.Picture.Bitmap.Canvas.Pixels [ 0, Image1.Picture.Bitmap.Height - 1 ];
          StatusBar1.Panels [ 0 ].Text := FileCtrl.MinimizeName ( ExtractFileDir ( FilePath ), Canvas, 200 ); // Folder
          StatusBar1.Panels [ 1 ].Text := FileCtrl.MinimizeName ( ExtractFileName ( FilePath ), Canvas, 75 ); // Filename
          StatusBar1.Panels [ 2 ].Text := 'Width: ' + IntegerToString ( Image1.Picture.Bitmap.Width ); // Width
          StatusBar1.Panels [ 3 ].Text := 'Height: ' + IntegerToString ( Image1.Picture.Bitmap.Height ); // Height
          StatusBar1.Panels [ 4 ].Text := BitDepthToColorString ( GetPixelFormatSize ( GPBitmap.GetPixelFormat ) ); // Bitdepth

          Image1.Refresh;

        end;

      finally
        GPBitmap.Free;
      end;

    end;

  end;

end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T01:59:18.593

您需要做的是选择一种背景颜色，该颜色将与传输图像时绘制的表面混合。即代替

```
iStatus := GPBitmap.GetHBITMAP ( aclBlack, iHBitmap ); 
```

利用

```
iStatus := GPBitmap.GetHBITMAP(ColorRefToARGB(ColorToRGB(clBtnFace)), iHBitmap); 
```

例如，如果图像采用默认彩色形式。

此时您已经知道该图像没有 Alpha 通道，但已使用合适的颜色对其进行了展平处理。'TBitmap'的`Transparent..`属性对部分透明度没有帮助。如果你设置 的`Transparent`属性，`TBitmap`当你把它放在不同颜色的背景上时，它仍然会像你问题的第一张图片，可能有更好的边缘颜色。无论如何，如果您使用它，请不要忘记将“TransparentColor”设置为“clBtnFace”而不是“clBlack”。

# azure - Monotouch - Windows Azure 工具包

> ID：10143428
> 
> 赞同：1
> 
> 时间：2012-04-13T15:08:25.180
> 
> 标签：azure, xamarin.ios

我正在开发一个需要直接访问 Azure 的 Iphone 应用程序。我知道有针对 Objective C 和 Android 的工具包版本。Monotouch 是否存在任何移植版本的工具包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T17:28:33.733

没有专为 MonoTouch 设计的特定 Azure SDK，Azure 桌面二进制文件不兼容。如果您决定使用 MonoTouch，则需要使用 WebClient API 来创建您自己的 HTTP/HTTPS 连接，类似于[此处](http://weblogs.thinktecture.com/cweyer/2011/12/cross-devicecross-location-pub-sub-using-windows-azure-service-bus-topics-subscriptions-in-ios-with-monotouch.html)描述的内容，这可能比较复杂。在 Internet 上，您可能会找到一些实验级代码来使用 Azure 服务和 MonoTouch 应用程序，因此您可以自己尝试让事情正常运行。

如果您选择 Objective C，那么您可以使用适用于 Windows Azure 的 iOS SDK，这是更好的解决方案。我个人不会使用 MonoTouch 在 iOS 设备上开发应用程序，如果我严重依赖 Windows Azure Services，我会选择 iOS Windows Azure SDK 通过原生代码连接 Azure Service。

也检查一下：[MonoTouch 连接到 Azure ACS、Azure SQL / Azure WCF](https://stackoverflow.com/questions/10882159/monotouch-connect-to-azure-acs-azure-sql-azure-wcf/10885414#10885414)

# php - CodeIgniter CLI + HMVC，回显索引视图/控制器而不是 cron 控制器

> ID：10143429
> 
> 赞同：1
> 
> 时间：2012-04-13T15:08:27.583
> 
> 标签：php, codeigniter

服务器是来自运行 centos 的 mediatemple 的 DV4。`$DOC_ROOT/index.php - 777 has perms`.

**PHP的路径：** `/usr/bin/php`

**index.php 的路径：** `/var/www/vhosts/example.com/client/fhaz/index.php`

**cron.php 的路径：** `/var/www/vhosts/example.com/client/fhaz/application/controllers/cron.php`

**当我运行以下命令时：** `/usr/bin/php /var/www/vhosts/example.com/client/fhaz/index.php cron processCategoryCount`

它运行索引控制器打印出索引（主页）中的编译视图，而不是与 cron processCategoryCount 相关的 cron 控制器/方法

我也试过：`index.php/cron/processCategoryCount`，`index.php "cron/ProcessCategoryCount`

`index.php/cron/processCategoryCount`在浏览器中正确访问会返回`NOT CLI`由 cron 控制器中的构造执行的，`die("NOT CLI");`所以我知道它可以访问..

几个月前我遇到了这个问题，但忘记了修复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T16:06:18.253

问题被`$config['uri_protocol']`设置为`QUERY_STRING`而不是`AUTO`

# visual-studio - 这个配色方案元素是什么？

> ID：10143430
> 
> 赞同：2
> 
> 时间：2012-04-13T15:08:29.247
> 
> 标签：visual-studio, visual-studio-2010, color-scheme

我正在使用带有 ReSharper 和“黑曜石之子”主题的 VS2010，并且在 String.Format 部分中有以下令人沮丧的突出显示问题。

选择一个方法（或任何）参数会给出灰色背景 - 见图`string bString`。但是 String.Format 字符串中的突出显示是不同的，并且不可读。

在“工具 > 选项 > 字体和颜色”中，我尝试过：“选定文本”、“非活动选定文本”和“突出显示的参考”都是徒劳的。

所以，请：

a) 我需要改变什么

b) 有没有一种体面的方法可以找到它（我已经尝试对 Hex 颜色代码进行屏幕抓取并在 XML 样式中搜索它，但这不起作用）

![恼人的高亮问题](../Images/252217edda76a6052c857b0da29d3cc9.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T17:08:13.513

在我的家用电脑上尝试了一段时间后，我发现有问题的元素是`ReSharper Matched Format String Item`

![ReSharper 匹配格式字符串项](../Images/d220008e0bd8cc6bcd015b3cd46dcddb.png)

真的应该有一种更简单的方法来找到这些东西

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:22:37.343

您的光标似乎位于 Intellisense 代码片段字段中。

可能是代码片段字段吗？

![在此处输入图像描述](../Images/af7a929faedfe0d38fb407ffadd767e2.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-17T09:55:54.303

Paddy 的回复为我指明了正确的方向，但我的问题略有不同。我将在这里发布我的解决方案，希望它可以帮助其他人。

我正在使用 VS2013 和 Resharper 8。我的问题是 Resharper 在安装时无法导入它自己的字体和颜色设置。对我来说，Paddy 图片中显示的 Resharper 选项是不可见的。这是 Resharper 安装的一个已知问题，解决方案如下：

1) 关闭所有 Visual Studio 实例

2) 打开 C:\Program Files (x86)\Microsoft Visual Studio {VS version}\Common7\IDE\Extensions\extensions.configurationchanged 文件

3）在那里输入任何内容

4) 保存文件

5）打开VS并检查工具|字体和颜色 选项 | 环境

（[来源](http://resharper-support.jetbrains.com/entries/26859128-ReSharper-Fonts-Colors-settings-do-not-appear-in-Visual-Studio-after-installation)）

对我来说，只要我重新打开 VS，Resharper 就能够导入它自己的设置，并且突出显示问题已经得到修复，无需我采取任何进一步的行动。

现在，当尝试编辑 extensions.configurationchanged 文件时，我还遇到了“拒绝访问”错误消息（我以管理员身份运行 Windows 7）。为了克服这个问题，我必须以管理员身份打开记事本（开始 > 右键单击​​记事本 > 以管理员身份运行），然后使用文件 > 打开打开 extensions.configurationchanged 文件。

我希望这对未来的人们有所帮助！

# algorithm - 寻找第 N 个孪生素数

> ID：10143431
> 
> 赞同：8
> 
> 时间：2012-04-13T15:08:43.630
> 
> 标签：algorithm, math, primes

我试图解决 SPOJ 上的问题。我们需要计算第 n 个孪生素数对（相差 2 的素数）。n 可以大到 10^5。我尝试使用筛子进行预先计算，我必须筛分到 10^8 才能获得最大的 n 个孪生素数，但是时间限制很严格（2 秒）并且超时。我注意到人们已经在 0.00 秒内解决了它，所以我在谷歌上四处寻找一个公式，但找不到任何有用的东西。有人可以指导我吗？

提前致谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T00:30:24.300

出于好奇，我使用 Eratosthenes 筛的两种变体解决[了这个问题。](http://www.spoj.pl/problems/TWINP/)第一个变体在 0.93 秒内在测试机上完成，第二个在 0.24 秒内完成。作为比较，在我的电脑上，第一个在 0.08 秒内完成，第二个在 0.04 秒内完成。

第一个是对奇数的标准筛子，第二个是一个稍微复杂的筛子，除了偶数之外还省略了 3 的倍数。

SPOJ 的测试机器又旧又慢，所以程序在它们上运行的时间比在典型的新机器上运行的时间要长得多；而且它们的缓存很小，因此保持计算量很小很重要。

这样做，Eratosthenes 的筛子就足够快了。但是，保持较小的内存使用量非常重要。第一个变体，每个数字使用一个字节，在 SPOJ 上给出了“超出时间限制”，但在我的盒子上运行了 0.12 秒。因此，鉴于 SPOJ 试验机的特性，**使用位筛**在给定时间内解决它。

在 SPOJ 机器上，通过进一步将筛子的空间减少一半，我获得了显着的加速（运行时间 0.14 秒）。因为 - 除了第一对 (3,5) - 所有素数双胞胎都有形式，如果不产生双素数对，`(6*k-1, 6*k+1)`你不需要知道这两个数字中的哪个是合数，只筛选就足够了`k`指数`k`。

(`6*k + 1`可被 5 整除当且仅当`k = 5*m + 4`对于某些`m`，并且`6*k - 1`可被 5 整除当且仅当`k = 5*m+1`对于某些`m`，所以 5 将标记`5*m ± 1, m >= 1`为不产生孪生素数。类似地，`6*k+1`可被 13 整除当且仅当`k = 13*m + 2`对于某些`m`且`6*k - 1`当且仅当`k = 13*m - 2`对于 some `m`，所以 13 会标记出来`13*m ± 2`。）

这不会改变标记的数量，因此在缓存足够大的情况下，运行时间的变化很小，但对于小缓存来说，这是一个显着的加速。

不过，还有一件事。你10 ⁸的限制太高了。我使用了一个下限（2000 万），它不会高​​估第 100,000^个孪生素数对。限制为 10 ⁸，第一个变体肯定不会及时完成，第二个可能不会。

随着限制的减少，需要对阿特金筛子进行一些优化以击败省略偶数和 3 倍数的 Eratosthenes 变体，一个简单的实现将明显变慢。

* * *

关于您的（维基百科的伪代码）阿特金筛子的一些评论：

```
#define limit 100000000
int prime1[MAXN];
int prime2[MAXN]; 
```

您不需要第二个数组，素数双胞胎中较大的配对可以很容易地从较小的配对中计算出来。您正在浪费空间并破坏从两个数组读取的缓存位置。（不过，与筛分所需的时间相比，这微不足道。）

```
 int root = ceil(sqrt(limit));
    bool sieve[limit]; 
```

在当今的许多操作系统上，即使限制有所减少，这也是即时的段错误。堆栈大小通常限制为 8MB 或更小。应该在堆上分配该大小的数组。

如上所述，`bool`每个数字使用一个会使程序运行得比必要的慢得多。您应该自己使用`std::bitset`或`std::vector<bool>`或旋转这些位。此外，建议至少省略偶数。

```
 for (int x = 1; x <= root; x++)
    {
        for (int y = 1; y <= root; y++)
        {
//Main part of Sieve of Atkin
            int n = (4*x*x)+(y*y);
            if (n <= limit && (n % 12 == 1 || n % 12 == 5)) sieve[n] ^= true;
            n = (3*x*x)+(y*y);
            if (n <= limit && n % 12 == 7) sieve[n] ^= true;
            n = (3*x*x)-(y*y);
            if (x > y && n <= limit && n % 12 == 11) sieve[n] ^= true;
        }
    } 
```

这是非常低效的。它尝试了太多的 xy 组合，对于每个组合，它会进行三到四次除法以检查余数模 12，并且它在数组中来回跳跃。

分离不同的二次方。

因为`4*x^2 + y^2`，很明显，你只需要考虑`x < sqrt(limit)/2`和奇数`y`。那么余数模 12 是 1、5 或 9。如果余数是 9，则`4*x^2 + y^2`实际上是 9 的倍数，所以这样的数将被排除为不是无平方数。然而，最好从筛子中完全省略 3 的倍数，`n % 12 == 1`并`n % 12 == 5`分别处理这些情况。

对于`3*x^2 + y^2`，很明显，您只需要考虑`x < sqrt(limit/3)`并且稍微思考一下就会发现它`x`必须是奇数和`y`偶数（并且不能被 3 整除）。

对于`3*x^2 - y^2`with `y < x`，显然您只需要考虑`y < sqrt(limit/2)`。查看余数模 12，您会看到它`y`不能被 3 整除，`x`并且`y`必须具有不同的奇偶性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T22:19:39.523

我在 0.66 秒内获得了交流电。因为，有 0.0s 的解决方案，我认为可以进行更好的优化，但是，我在这里描述了我的方法。

我在`Sieve of Eratosthenes`. 您知道这`2`是唯一的偶数素数，使用它可以将计算素数的计算时间和内存减少一半。

其次，所有作为孪生素数的数字都不会是`2`和的倍数`3`（因为它们是素数！）。所以，这些数字将是形式`6N+1`和`6N+5`（其余的肯定不是素数）。`6N+5 = 6N+6-1 = 6(N+1)-1`. 所以可以看出`6N+1`并且`6N-1`可能是`N`> = 1的孪生素数。因此，您使用之前计算的素数预先计算所有这些值。（小例是 3 5）

注意：在 10^8 之前不需要计算素数，上限要低得多。[编辑：如果你愿意，我可以分享我的代码，但如果你自己想出一个解决方案会更好。:)]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T02:12:59.710

因此，根据 Wolfram Alpha 的说法，基本上，筛选多达 20,000,000 个就足够了。`vector<bool>`在 C++ 中使用 Eratosthenes 的普通筛子（顺便说一句，您使用的是什么语言？）。

跟踪筛环内的孪生素数。当你找到双胞胎时，将一对的下质数存储在一个单独的向量中，如果请求一个无序（小于前一个）索引（它们是，与描述页面上显示的示例相反），只需从此存储中获取素数：

```
size_t n = 10000000, itop=2236;
vector<bool> s;
vector<int> twins;
s.resize(n, true);
int cnt, k1, k2, p1=3, p2, k=0;
cin >> cnt;
if( cnt-- > 0 )
{
    cin >> k1;
    for( size_t i=1; i < n; ++i )  // p=2i+1
    {
        if( s[i] )
        {
            p2 = 2*i+1;
            if( p2-p1 == 2 ) { ++k; twins.push_back(p1); }
            if( k==k1 )
            { 
                cout << p1 << " " << p2 << endl;
                ...... 
```

等 1.05 秒（在 Ideone 上为 0.18 秒）接受。或者解开逻辑 - 只需立即预先计算 100,000 个孪生素数对，然后在单独的循环中访问它们（0.94 秒）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T12:00:22.563

可以在此处找到解决此问题的有效算法的描述[@Programming Praxis entry](http://programmingpraxis.com/2012/04/17/twin-primes/2/)此外，还提供了 Scheme 和 Perl 示例代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T18:15:16.783

我使用埃拉托色尼筛法预先计算了一个大的素数列表，然后遍历列表，计算比它们的后继少 2 个的项目，直到找到其中的 n 个。[在http://ideone.com/vYjuC](http://ideone.com/vYjuC)上运行 1.42 秒。我也想知道如何在零秒内计算答案。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define ISBITSET(x, i) (( x[i>>3] & (1<<(i&7)) ) != 0)
#define SETBIT(x, i) x[i>>3] |= (1<<(i&7));
#define CLEARBIT(x, i) x[i>>3] &= (1<<(i&7)) ^ 0xFF;

typedef struct list {
    int data;
    struct list *next;
} List;

List *insert(int data, List *next)
{
    List *new;

    new = malloc(sizeof(List));
    new->data = data;
    new->next = next;
    return new;
}

List *reverse(List *list) {
    List *new = NULL;
    List *next;

    while (list != NULL)
    {
        next = list->next;
        list->next = new;
        new = list;
        list = next;
    }

    return new;
}

int length(List *xs)
{
    int len = 0;
    while (xs != NULL)
    {
        len += 1;
        xs = xs->next;
    }
    return len;
}

List *primes(int n)
{
    int m = (n-1) / 2;
    char b[m/8+1];
    int i = 0;
    int p = 3;
    List *ps = NULL;
    int j;

    ps = insert(2, ps);

    memset(b, 255, sizeof(b));

    while (p*p < n)
    {
        if (ISBITSET(b,i))
        {
            ps = insert(p, ps);
            j = (p*p - 3) / 2;
            while (j < m)
            {
                CLEARBIT(b, j);
                j += p;
            }
        }
        i += 1; p += 2;
    }

    while (i < m)
    {
        if (ISBITSET(b,i))
        {
            ps = insert(p, ps);
        }
        i += 1; p += 2;
    }

    return reverse(ps);
}

int nth_twin(int n, List *ps)
{
    while (ps->next != NULL)
    {
        if (n == 0)
        {
            return ps->data - 1;
        }

        if (ps->next->data - ps->data == 2)
        {
            --n;
        }

        ps = ps->next;
    }

    return 0;
}

int main(int argc, char *argv[])
{
    List *ps = primes(100000000);

    printf("%d\n", nth_twin(100000, ps));

    return 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-17T12:36:31.693

这就是我所尝试的。我有一串 TLE。

```
bool mark [N];
vector <int> primeList;

 void sieve ()
 {
memset (mark, true, sizeof (mark));
mark [0] = mark [1] = false;

for ( int i = 4; i < N; i += 2 )
    mark [i] = false;

for ( int i = 3; i * i <= N; i++ )
{
    if ( mark [i] )
    {
        for ( int j = i * i; j < N; j += 2 * i )
            mark [j] = false;
    }
}

primeList.clear ();
primeList.push_back (2);

for ( int i = 3; i < N; i += 2 )
{
    if ( mark [i] )
        primeList.push_back (i);
}

//printf ("%d\n", primeList.size ());
 }

  int main ()
{
sieve ();

vector <int> twinPrime;

for ( size_t i = 1; i < primeList.size (); i++ )
{
    if ( primeList [i] - primeList [i - 1] == 2 )
        twinPrime.push_back (primeList [i - 1]);
}

int t;
scanf("%d",&t);
int s;
while ( t-- )
{
    scanf("%d",&s);
    printf ("%d %d\n", twinPrime [s - 1], twinPrime [s - 1] + 2);
}

return 0; 
```

}

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-15T14:56:01.147

这是一个可以回答您的问题的程序：

***素数除以 3 时，修正为十进制 0（零）后具有相等的商数是孪生素数。***

这可以写成

**对于任何一对素数 Px, Py, 如果 [Px/3, 0] = [Py/3, 0] 那么 Px 和 Py 是素数孪晶。**

其基础是，如果素数相差 2，则当商被修正为十进制零时，除以所有感兴趣的素数将产生唯一的等商。未被 2 分隔的质数在修正为十进制零时将不具有等商。

例如：

• 11, 13 除以 3 将产生唯一的唯一商，当商被修正为十进制零时。

• 17、19 除以 3 时，商被修正为十进制零时，将得出唯一的商 6。

• 29, 31 除以 3 时，将得到唯一商 10，此时商被修正为十进制零。

等等。

下面是一个使用 Excel 的简单过程：

• 从任何素数列表中找出素数孪生 • 在任何素数范围内找出孪生素数 • 找出最大的素数孪生素数 • 找出孪生素数之间的间隙

1.  将 Kutools 导入 Excel
2.  在第 1 列中列出感兴趣的素数。
3.  在第 2 列中插入除数 3 - 向下填充到第 1 列列表中最大素数的级别。
4.  将第 1 列的第一行除以第 2 列的第一行并将商放在第 3 列中
5.  将第 3 列填写到第 1 列列表中最大素数的级别。
6.  修正为零小数。保持选择数字第 3 列（商）。
7.  从“条件格式” - 从菜单中选择“重复值”
8.  转到 Kutools 并选择“实际” - 这将突出显示散布在商列 3 中的所有双胞胎对的单元格。
9.  选择第 3 列中的商
10.  在 Excel 中选择“排序和筛选”
11.  选择“自定义排序”
12.  填写菜单（对于值选择商列中突出显示的颜色），然后单击“确定”。
13.  孪生素数将在列中组合在一起。然后可以使用此列表来查找素数之间的间隙。

要找到最大的孪生素数，请使用上述程序，将已知最大素数的范围放入第 1 列（例如，最高的 10k 素数）。

如果在此范围内未找到素数孪生，则转到下一个最低范围，直到找到孪生素数。这将是最大的孪生素数。

希望这可以帮助。

# uilocalnotification - 通知关闭后 UILocalNotification 停止声音

> ID：10143440
> 
> 赞同：2
> 
> 时间：2012-04-13T15:09:04.727
> 
> 标签：uilocalnotification

我有一个应用程序可以为用户设置警报。警报是一个基本的 UILocalNotification，带有一个 12 秒长的声音文件。声音在设备上播放，但在用户关闭通知时不会消失。我通过使用它来停止在模拟器上播放声音

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Override point for customization after application launch.
    UILocalNotification *localNotif = [launchOptions objectForKey:UIApplicationLaunchOptionsLocalNotificationKey];
    if (localNotif) {
        [[UIApplication sharedApplication] cancelLocalNotification:localNotif];
    }    
    return YES;
} 
```

任何帮助都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-10T12:56:31.980

我把它放在我的 AppDelegate 上，它可以工作。

```
- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification
{
    [UIApplication sharedApplication].applicationIconBadgeNumber = 0;

    [[UIApplication sharedApplication] cancelAllLocalNotifications];
} 
```

希望它有所帮助。

# javascript - Twitter Bootstrap modal：如何移除 Slide down 效果

> ID：10143444
> 
> 赞同：167
> 
> 时间：2012-04-13T15:09:24.760
> 
> 标签：javascript, jquery, jquery-ui, twitter-bootstrap

有没有办法将 Twitter Bootstrap 模态窗口动画从向下滑动效果更改为淡入淡出或仅在没有幻灯片的情况下显示？我在这里通读了文档：

[http://getbootstrap.com/javascript/#modals](http://getbootstrap.com/javascript/#modals)

但他们没有提到任何改变模态身体滑动效果的选项。

* * *

## 回答 #1

> 赞同：364
> 
> 时间：2012-08-03T22:05:14.950

`fade`只需从模态 div 中取出课程。

具体来说，改变：

```
<div class="modal fade hide"> 
```

到：

```
<div class="modal hide"> 
```

* * *

**更新：**对于 bootstrap3，`hide`不需要该类。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-04-13T15:13:28.590

引导程序使用的模态使用 CSS3 来提供效果，可以通过从模态容器 div 中删除适当的类来删除它们：

```
<div class="modal hide fade in" id="myModal">
   ....
</div> 
```

正如你所看到的，这个模态有一个类`.fade`，意味着它被设置为淡入和`.in`，意味着它会滑入。所以只需删除与你想要删除的效果相关的类，在你的例子中就是`.in`类。

编辑：刚刚运行了一些测试，似乎情况并非如此，`.in`该类是由 javascript 添加的，尽管您可以使用 css 修改他的 slideDown 行为，如下所示：

```
.modal.fade {
    -webkit-transition: none;
    -moz-transition: none;
    -ms-transition: none;
    -o-transition: none;
    transition: none;
} 
```

[演示](http://jsfiddle.net/3v2zg/91/show/)

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2012-08-15T22:06:07.563

如果你喜欢让模态淡入而不是滑入（为什么要调用它`.fade`？）你可以覆盖你的 CSS 文件中的类或直接`bootstrap.css`用这个：

```
.modal.fade{
    -webkit-transition: opacity .2s linear, none;
    -moz-transition: opacity .2s linear, none;
    -ms-transition: opacity .2s linear, none;
    -o-transition: opacity .2s linear, none;
    transition: opacity .2s linear, none;
    top: 50%;
} 
```

如果您不想要任何效果，只需`fade`从模态类中删除该类。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2013-11-04T21:30:33.333

我相信这些答案中的大多数都是针对 bootstrap 2 的。我在 bootstrap 3 中遇到了同样的问题，并想分享我的修复。就像我之前对 bootstrap 2 的回答一样，这仍然会进行不透明度淡化，但**不会**进行幻灯片过渡。

您可以更改 modals.less 或 theme.css 文件，具体取决于您的工作流程。如果您没有花更少的时间度过任何美好的时光，我强烈推荐它。

更少，找到以下代码`MODALS.less`

```
&.fade .modal-dialog {
  .translate(0, -25%);
  .transition-transform(~"0.3s ease-out");
}
&.in .modal-dialog { .translate(0, 0)} 
```

然后更改`-25%`为`0%`

或者，如果您只使用 css，请在以下位置找到以下内容`theme.css`：

```
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, -25%);
  -ms-transform: translate(0, -25%);
  transform: translate(0, -25%);
  -webkit-transition: -webkit-transform 0.3s ease-out;
  -moz-transition: -moz-transform 0.3s ease-out;
  -o-transition: -o-transform 0.3s ease-out;
  transition: transform 0.3s ease-out;
} 
```

然后将 更改`-25%`为`0%`。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2012-10-23T22:30:39.577

我通过覆盖`.modal.fade`我自己的 LESS 样式表中的默认样式解决了这个问题：

```
.modal {
  &.fade {
    .transition(e('opacity .3s linear'));
    top: 50%;
  }
  &.fade.in { top: 50%; }
} 
```

这会保留淡入/淡出动画，但会删除上滑/下滑动画。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2014-06-04T12:29:18.840

我找到了**删除幻灯片但留下淡入淡出**的最佳解决方案是通过在您的选择的 css 文件中添加以下 css，该文件在 bootstrap.css 之后调用

```
.modal.fade .modal-dialog 
{
    -moz-transition: none !important;
    -o-transition: none !important;
    -webkit-transition: none !important;
    transition: none !important;

    -moz-transform: none !important;
    -ms-transform: none !important;
    -o-transform: none !important;
    -webkit-transform: none !important;
    transform: none !important;
} 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2013-03-29T04:16:07.623

我也不喜欢幻灯片效果。要解决此问题，您只需使`top`.modal.fade 和 modal.fade.in 的属性相同。你也可以去掉`top 0.3s ease-out`过渡，但把它留在里面并没有什么坏处。**我喜欢这种方法，因为淡入/淡出有效，它只是杀死了幻灯片**。

```
.modal.fade {
  top: 20%;
  -webkit-transition: opacity 0.3s linear;
     -moz-transition: opacity 0.3s linear;
       -o-transition: opacity 0.3s linear;
          transition: opacity 0.3s linear;
}

.modal.fade.in {
  top: 20%;
} 
```

如果您正在寻找引导程序 3 的答案，[请看这里](https://stackoverflow.com/questions/10143444/twitter-bootstrap-modal-how-to-remove-slide-down-effect/19777522#19777522)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-11-16T05:54:33.690

只需删除淡入淡出类，如果您想在 Modal 上执行更多动画，只需在 Modal 中使用 animate.css 类。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-04-27T09:53:31.193

您也可以通过简单地删除 "top:-25%;" 来覆盖 bootstrap.css

一旦删除，模态将简单地淡入和淡出而没有幻灯片动画。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-08-25T18:41:30.220

看看[http://quickrails.com/twitter-bootstrap-modal-how-to-remove-slide-down-effect-but-leaves-the-fade/](http://quickrails.com/twitter-bootstrap-modal-how-to-remove-slide-down-effect-but-leaves-the-fade/)

```
.modal.fade .modal-dialog 
{
    -moz-transition: none !important;
    -o-transition: none !important;
    -webkit-transition: none !important;
    transition: none !important;
    -moz-transform: none !important;
    -ms-transform: none !important;
    -o-transform: none !important;
    -webkit-transform: none !important;
    transform: none !important;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-05-01T09:45:41.353

我正在使用 bootstrap 3 和 Durandal JS 2 modal 插件。这个问题是在谷歌结果之上的，因为上面的答案都不适合我，我想我会为未来的访问者分享我的解决方案。

我用我自己的 less 覆盖了默认的 Bootstrap 的 Less 代码：

```
.modal {
  &.fade .modal-dialog {
    .translate(0, 0);
    .transition-transform(~"none");
  }
  &.in .modal-dialog { .translate(0, 0)}
} 
```

这样我就只剩下淡入淡出效果了，没有slideDown。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-01-11T11:18:38.767

```
.modal.fade, .modal.fade .modal-dialog {
    -webkit-transition: none;
    -moz-transition: none;
    -ms-transition: none;
    -o-transition: none;
    transition: none;
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-06-18T03:29:36.877

*问题很明确：只*删除幻灯片：这是如何在 Bootstrap v3 中更改它

在 modals.less 中注释掉 translate 语句：

```
&.fade .modal-dialog {
  //   .translate(0, -25%); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-01-07T14:33:46.843

只需从模态类中删除“淡入淡出”类

```
class="modal fade bs-example-modal-lg" 
```

作为

```
class="modal bs-example-modal-lg" 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-02-14T02:47:58.897

想更新这个。你们中的大多数人还没有完成这个问题。我正在使用 Bootstrap 3。上述修复均无效。

删除幻灯片效果但保持淡入。我进入引导 css 并（注意以下选择器） - 这解决了问题。

```
 .modal.fade .modal-dialog{/*-webkit-transform:translate(0,-25%);-ms-transform:translate(0,-25%);transform:translate(0,-25%);-webkit-transition:-webkit-transform .3s ease-out;-moz-transition:-moz-transform .3s ease-out;-o-transition:-o-transform .3s ease-out;transition:transform .3s ease-out*/}

 .modal.in .modal-dialog{/*-webkit-transform:translate(0,0);-ms-transform:translate(0,0);transform:translate(0,0)*/} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-04-23T20:23:50.587

以下 CSS 对我有用 - 使用 Bootstrap 3。您需要在 boostrap 样式之后添加此 css -

```
.modal.fade .modal-dialog{
    -webkit-transition-property: transform; 
    -webkit-transition-duration:0 ; 
    transition-property: transform; 
    transition-duration:0 ; 
}

.modal.fade {
   transition: none; 
} 
```

# dojo - 有限结果的总计数

> ID：10143447
> 
> 赞同：0
> 
> 时间：2012-04-13T15:09:32.053
> 
> 标签：dojo, symfony, doctrine-orm

所以我实现了[dojo.store.jsonRest](http://dojotoolkit.org/reference-guide/1.7/dojo/store/JsonRest.html)的分页以用作 dojox.grid.DataGrid 中的存储。在使用*Symfony 2*和 ORM *Doctrine*的服务器中，我是这两个框架的新手。

对于 Dojo jsonRest，服务器的响应必须有一个包含结果**偏移量**、**限制**和**记录总数（无限制）的标头****Content-Range**。

 ******因此，对于带有**Content-Range: items 0-24/66**标头的响应，如果用户将网格记录滚动到第**24 行**，它将发出带有**Range: 24-66**标头的异步请求，然后是响应标头应该有一个**Content-Range: items 24-66/66**。这样做是为了让 Dojo 可以知道它可以对分页数据发出多少请求，以及呈现和后续请求的记录范围。

所以我的问题是，要获得没有限制的记录总数，我必须使用具有偏移量和限制的相同查询进行**COUNT查询。**我不喜欢这个。

**我想知道是否有一种方法可以在不进行两次查询的情况下获得总计数和有限结果。**

```
public function getByTextCount($text)
{
    $dql = "SELECT COUNT(s.id) FROM Bundle:Something s WHERE s.text LIKE :text";

    $query = $this->getEntityManager()->createQuery($dql);
    $query->setParameter('text', '%'.$text.'%');

    return $query->getSingleScalarResult();
} 
```

-

```
public function getByText($text, $offset=0, $limit=24)
{
    $dql = "SELECT r FROM Bundle:Something s WHERE s.text LIKE :text";

    $query = $this->getEntityManager()->createQuery($dql);
    $query->setParameter('text', '%'.$text.'%');
    $query->setFirstResult($offset);
    $query->setMaxResults($limit);

    return $query->getArrayResult();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T04:24:41.437

如果你使用 MySQL，你可以做一个`SELECT FOUND_ROWS()`.

从[文档](http://dev.mysql.com/doc/refman/5.6/en/information-functions.html#function_found-rows)中。

> 一个 SELECT 语句可能包含一个 LIMIT 子句来限制服务器返回给客户端的行数。在某些情况下，希望知道在没有 LIMIT 的情况下该语句将返回多少行，但无需再次运行该语句。要获取此行数，请在 SELECT 语句中包含 SQL_CALC_FOUND_ROWS 选项，然后调用 FOUND_ROWS()：

```
mysql> SELECT SQL_CALC_FOUND_ROWS * FROM tbl_name
    -> WHERE id > 100 LIMIT 10;
mysql> SELECT FOUND_ROWS(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:38:43.867

如果您只想使用 Doctrine（即避免特定于供应商的 SQL），您始终可以在选择实体后重置部分查询：

```
 // $qb is a Doctrine Query Builder
    // $query is the actual DQL query returned from $qb->getQuery()
    // and then updated with the ->setFirstResult(OFFSET) and ->setMaxResults(LIMIT)

    // Get the entities as an array ready for JSON serialization
    $entities = $query->getArrayResult();

    // Reset the query and get the total records ready for the Range header
    // 'e' in count(e) is the alias for the entity specified in the Query Builder
    $count = $qb->resetDQLPart('orderBy')
                ->select('COUNT(e)')
                ->getQuery()
                ->getSingleScalarResult(); 
```******

# c# - DataGridView 最少行数

> ID：10143456
> 
> 赞同：0
> 
> 时间：2012-04-13T15:10:12.397
> 
> 标签：c#, winforms, datagridview, rows

我非常喜欢 C#，我正在尝试创建一个简单的网络分析器。我希望能够在 datagridview 中看到数据包。想象的布局可以与wireshark等工具进行比较。我希望我的 datagridview 始终被“填充”。填充我的意思是它总是包含行，即使这些是空的。

例如，在启动应用程序时，我希望网格完全充满行。gridView 的总高度是行高的倍数，因此它包含足够多的行，因此它正好 100% 填充。但是，在添加数据时，我希望这些空行不计在内，因此数据会覆盖这些空行，并且在删除这些行时返回，否则 DataGridView 不会被完全填充。我意识到我可能解释得有点糟糕，但我不确定如何尝试表达我的意思。例如，Excel 的工作方式将是理想的。您从带有空单元格的全屏开始，您可以向其中添加内容。如果您添加的数据多于适合的数据，则会引入一个 scoll 条以仍然能够查看所有数据。当您删除它时，滚动条会变小，直到最终它' s 不再需要，但仍显示单元格。（即使是空的）

提前致谢，

阿诺德

-edit- 关于事物的高度：我可能希望将来可以调整大小。因此，这些信息可能无法被利用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:22:35.160

使用用户控件包装 DataGridView 以覆盖添加和删除行。

如果您要删除一行 - 它必须是真实的（未标记为“占位符”[标签？]）。如果您的 Count 小于 IdealCount，请添加“占位符”行。

如果您要添加一行 - 如果您的 Count 小于 IdealCount，请删除最后一个“占位符”行。

使用 IdealCount 的“占位符”行数进行初始化。

让行按默认值为 0 的隐藏列和“占位符”值为 1 的隐藏列排序，或者只是在添加覆盖中自己维护行顺序。这样，“占位符”将始终位于最后（如果 Count > IdealCount，则不会有任何）。

# asp.net-mvc-3 - MVC3 SqlFunctions.StringConvert 方法

> ID：10143460
> 
> 赞同：1
> 
> 时间：2012-04-13T15:10:21.483
> 
> 标签：asp.net-mvc-3

我正在尝试将十进制值转换为字符串。

我的编码是这样的：

```
public ActionResult Search(string searchString)
    {
    product = product.Where(a => a.model.ToUpper().Contains(searchString.ToUpper())
                               || a.Category.name.ToUpper().Contains(searchString.ToUpper()) 
                               || SqlFunctions.StringConvert((decimal)a.displaySize).Contains(searchString));
    return View(product.ToList());
    } 
```

当 searchString 值为 '5' 而不是十进制值时，将显示产品列表。但是，如果 searchString 值为 '5.5'，则不会显示产品列表。

我真的不知道为什么。。

你可以帮帮我吗？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:21:36.837

如果您在 SQL Server 中使用不区分大小写的排序规则（这是默认设置），则不需要 ToUpper。我怀疑包含是你真正想要的，你可能想要这样的东西：

```
public ActionResult Search(string searchString) 
{
    decimal d = 0;
    bool isDecimal = decimal.TryParse(searchString, out d);
    product = product.Where(a => a.model.Contains(searchString) 
                           || a.Category.name.Contains(searchString)  
                           || (isDecimal && a.displaySize == d) ); 
    return View(product.ToList()); 
} 
```

另外，请考虑当模型或类别包含数字时会发生什么，您的搜索将返回结果..也许没关系。只是指出来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:18:34.210

`searchString`转换为小数可能会更容易，试试这个：

```
public ActionResult Search(string searchString)
{
    var searchVal = decimal.Parse(searchString);

    product = product.Where(a => a.model.ToUpper().Contains(searchString.ToUpper())
                           || a.Category.name.ToUpper().Contains(searchString.ToUpper()) 
                           || a.displaySize == searchVal);
    return View(product.ToList());
} 
```

您可能希望使用它`TryParse`来确保类型安全，具体取决于来自`searchString`哪里

# xcode - xcode：画线。如何传递变量

> ID：10143465
> 
> 赞同：2
> 
> 时间：2012-04-13T15:10:38.377
> 
> 标签：xcode, variables, line, draw

在我的 ViewController 我有一个按钮：

```
- (IBAction)drawLineClick:(id)sender 
{
    CGRect rect;
    rect.origin.x = 20.0f;
    rect.origin.y = 40.0f;
    rect.size.width = 100.0f;
    rect.size.height = 100.0f;

    //draw line
    DrawLine *drawLine = [[DrawLine alloc] initWithFrame:rect]; 
    [self.view addSubview:drawLine];
} 
```

在我的 DrawLine 类中，我只画一条线：

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        [super setBackgroundColor:[UIColor clearColor]];
    }
    return self;
}

- (void)drawRect:(CGRect)rect
{
    // Drawing code

    [self drawLine];
}

- (void)drawLine
{
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetStrokeColorWithColor(context, [UIColor blueColor].CGColor);
    CGContextSetLineWidth(context, 3.0);
    CGContextMoveToPoint(context, 0, 0); 
    CGContextAddLineToPoint(context, 50, 50); 
    CGContextStrokePath(context);
} 
```

这很好用，但这不是可变的。每次都是同一行。如何将 ViewController 中的线条颜色、线条宽度等传递给 DrawLine 类，以便绘制不同的线条？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:17:35.537

在您的 DrawLine 类中创建表示您想要控制的事物的属性。当您创建新对象时，通过直接分配它们或在自定义`initWith...`方法中传递它们来设置其属性。使用 drawRect: 中的属性值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-16T00:58:46.930

这是为我工作的代码，我传递了 lineWidth 参数：

画线.h 文件

```
#import <Cocoa/Cocoa.h>

@interface DrawLine : NSView
@property (nonatomic, strong) double *lineWidth;
@property (nonatomic, strong) UIColor *color;
- (void)drawRect:(CGRect)rect;
- (id)initWithFrame:(NSRect)frameRect andLineWidth :(double)lineWidth0 andColor: (UIColor *) color0;
...
@end 
```

画线.m 文件

```
...
- (id)initWithFrame:(NSRect)frameRect andLineWidth :(double)lineWidth0 andColor: (UIColor *) color0;
{
    self.lineWidth = lineWidth0;
    self = [super initWithFrame:frameRect];
if (self) {
    // Initialization code
    [super setBackgroundColor:color0];
}
return self;
    return self;
}
... 
```

ViewController.m 文件

```
...
- (IBAction)drawLineClick:(id)sender 
{
    CGRect rect;
    rect.origin.x = 20.0f;
    rect.origin.y = 40.0f;
    rect.size.width = 100.0f;
    rect.size.height = 100.0f;

    double lineWidth = 10;
    UIColor *color = [UIColor clearColor];

    //draw line
    DrawLine *drawLine = [[DrawLine alloc] initWithFrame:rect andLineWidth: lineWidth andColor: color]; 
    [self.view addSubview:drawLine];
}
... 
```

有用。

# javascript - 如何使用外部存储呈现数据视图的 tpl？

> ID：10143466
> 
> 赞同：0
> 
> 时间：2012-04-13T15:10:38.800
> 
> 标签：javascript, load, extjs4, store, dataview

我正在努力解决我的观点，即我使用代理在我的页面内加载了一个商店，并且它的工作完美。但是，一旦我加载具有相同 srore 但外部的相同数据视图，它就不起作用了。

此示例有效：

```
Ext.create('Ext.data.Store',{

storeId:'employeeStore',
fields:['id', 'name', 'type','children'],
data:[
    {
        id : 1,
        name : "GEO ET 09",
        type : 1,
        children: [ 
            { id: 11, parent: 1 ,name: '0820 689 689' }, 
            { id: 12, parent: 1, name: '0820 689 689' },
            { id: 13, parent: 1 ,name: '0820 689 689' }, 
            { id: 14, parent: 1, name: '0820 689 689' },
        ]
    },
    {
        id : 2,
        name : "0800 & 0805",
        type : 2,
        children: [ 
            { id: 21, parent: 2, name: '0820 689 689' }, 
            { id: 22, parent: 2, name: '0820 689 689' }, 
            { id: 23, parent: 2, name: '0820 689 689' },
        ]
    },
], 
```

});

Ext.define('Axiastats.view.NumbersChoicePanel', { extend : 'Ext.FormPanel', renderTo: 'numbersChoice', 别名: 'widget.NumbersChoicePanel', id : 'numbersChoice-container',

```
requires : ['Ext.form.*','Ext.button.*', 'Ext.layout.container.Column', 'Ext.tab.Panel','Axiastats.store.Numbers'],

baseCls: 'numbersChoice-container',
cls: 'choice hoverBox round6',
layout: 'anchor',
bodyPadding: '0',
modal : true,
defaults: {
    border: false,
    layout: 'anchor',
},
items : [
    {
        xtype: 'box',
        autoEl: {
            tag: 'div',
            cls: 'arrow'
        }
    },
    {
        xtype: 'dataview',
        id: 'numbers-view',
        cls: 'cont round4',
        itemSelector: 'div.categNumbersRow',
        store: Ext.data.StoreManager.lookup('employeeStore'),
        //store: 'Axiastats.store.Numbers',
        tpl: [
            '<tpl for=".">',
                '<div class="close cat0{type} categNumbersRow" id="categNumbers-{id}">',
                    '<div id="theCategNumbers-{id}" class="title">',
                        '<span class="n01">{name}</span>',
                        '<span class="n02">',
                            '<input type="checkbox" id="checkCategNumbers-{id}" name="checkCategNumbers" value={id} checked="yes"/>',
                            '<label for="checkCategNumbers-{id}">La catégorie</label>',
                        '</span>',
                        '<span id="detailCategNumbers-{id}" class="n03">Détail</span>',
                        '<div class="clear"></div>',
                    '</div>',

                    '<div id="allNumbers-{id}" class="allNumbers" style="display:none;">',
                        '<span class="sep first"></span>',
                        '<ul>',
                            '<tpl for="children">',
                                '<li><input type="checkbox" id="numbersRow-{id}" name="numbersRow-{id}" value="{id}" class ="numbersRow"/> <label for="numbersRow-{id}">{name}</label></li>',
                            '</tpl>',
                        '</ul>',
                        '<span class="sep clear"></span>',
                        '<ul class="select">',
                            '<li><input type="checkbox" id="checkAllNumbers-{id}" name="checkAllNumbers-{id}" class="checkAllNumbers" value="{id}" /> <label for="checkAllNumbers-{id}">Sélectionner tout</label></li>',
                            '<li><input type="checkbox" id="checkAllNumbersReset-{id}" name="checkAllNumbersReset-{id}" class="checkAllNumbersReset" value="{id}" /> <label for="checkAllNumbersReset-{id}">Désélectionner</label></li>',
                        '</ul>',
                        '<span class="sep clear"></span>',
                    '</div>',
                '</div>',
            '</tpl>'
        ], 
```

],

```
initComponent : function() {
    this.callParent();
}, 
```

});

但是，如果我想将我的商店放在外部文件中，如下所示：

```
Ext.define('Axiastats.store.Numbers', {
extend: 'Ext.data.Store',
singleton : true,
autoLoad: true,
storeId:'employeeStore',
fields:['id', 'name', 'type','children'],
data:[
    {
        id : 1,
        name : "GEO ET 09",
        type : 1,
        children: [ 
            { id: 11, parent: 1 ,name: '0820 689 689' }, 
            { id: 12, parent: 1, name: '0820 689 689' },
            { id: 13, parent: 1 ,name: '0820 689 689' }, 
            { id: 14, parent: 1, name: '0820 689 689' },
        ]
    },
    {
        id : 2,
        name : "0800 & 0805",
        type : 2,
        children: [ 
            { id: 21, parent: 2, name: '0820 689 689' }, 
            { id: 22, parent: 2, name: '0820 689 689' }, 
            { id: 23, parent: 2, name: '0820 689 689' },
        ]
    },
], 
```

});

我删除了商店：Ext.data.StoreManager.lookup('employeeStore')，按商店：'Axiastats.store.Numbers'，

商店已加载，但 tpl 未加载

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T17:38:25.307

您应该为数据视图显式创建商店：`store: Ext.create('Axiastats.store.Numbers')`。然后删除`singleton : true`商店中的配置。它将按预期工作。

# c - 在 C 源代码中包含项目的 SVN 修订

> ID：10143469
> 
> 赞同：9
> 
> 时间：2012-04-13T15:10:49.777
> 
> 标签：c, svn, project, revision

如何在 C 源代码或 Makefile 中包含我的项目的 SVN 修订版（不是文件修订版）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-13T18:13:56.473

我们在 makefile 中使用这样的一行：

```
REPO_REV := $(shell svnversion -n) 
```

它将工作副本的修订号存储到 make 变量中。要在 C 代码中使用它，您可以让您的 makefile 使用该值在编译器命令行上定义一个宏（类似于`-DREPO_REV=$(REPO_REV)`gcc）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-13T15:16:44.843

# git - 有没有办法将 git 提交从我的树的一部分应用到另一部分？

> ID：10143471
> 
> 赞同：2
> 
> 时间：2012-04-13T15:10:52.340
> 
> 标签：git, cherry-pick

在昏暗而遥远的过去，我们决定破坏与我们的配置程序之一的兼容性。然而，由于仍有远程单元运行旧软件，我们需要在构建中保留旧 mgmt 软件的版本。一个简短的“cp -a”之后，我们最终得到了一个目录结构，其中包含：

```
mgmt-app
mgmt-app.old 
```

开发继续进行，mgmt-app 积累了许多修复，一些是新功能和一些通用功能。正如您可能猜到的那样，现在注意到 mgmt-app.old 没有这些修复程序中的一些。如果我能挑选相关的修复程序并保留有用的东西（如评论）但将提交应用到 mgmt-app.old，那就太好了。显然它们不能正常应用，因为它们已经在应用到 mgmt-app 的树中！

我们正在使用 git 对存储库进行版本控制。有没有办法可以将这些提交“反向移植”到树的不同部分？这只是通过使用“patch -p”手动应用补丁来解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T18:37:17.573

为您的“旧”东西创建一个新分支：

`git checkout -b old`

使用`gitk`，回顾您的历史并找出`mgmt-app.old`创建之前的提交。确定该提交的 SHA1，以及

`git reset --hard <sha1>`

在那里建立你的`old`分支点。现在，您有一个分支，用于记录何时出现开发分歧，您可以执行[交互式 rebase](http://book.git-scm.com/4_interactive_rebasing.html) ( `git rebase -i`) 来挑选（并在需要时编辑）从新/当前开发分支到旧分支的提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:17:48.383

利用[`git cherrypick`](http://schacon.github.com/git/git-cherry-pick.html)

# java - ZeroMQ Java 绑定 LD_LIBRARY_PATH

> ID：10143478
> 
> 赞同：2
> 
> 时间：2012-04-13T15:11:09.713
> 
> 标签：java, unix, centos, zeromq, unsatisfiedlinkerror

我正在尝试在 CentOS 上使用 ZeroMQ。

我遵循了[类 unix 平台的安装说明](http://www.zeromq.org/bindings%3ajava)

运行时我不断收到以下异常：

```
java.lang.UnsatisfiedLinkError: no jzmq in java.library.path 
```

但是，以下行解决了这个问题：

```
export LD_LIBRARY_PATH=/usr/local/lib 
```

这个 LD_LIBRARY_PATH 到底是什么，为什么安装说明中没有解释？我是否需要每次都运行此导出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:27:39.723

这是一种指定在何处加载应用程序正在使用的本机库（.so 文件）的方法。您可以通过多种方式在环境中定义该变量，具体取决于您的需要。如果您要在操作系统启动时启动 MQ，您可以将导出放在启动 shell 脚本中。或者它可能进入 /etc/bashrc，或者它可能进入 ~/.bashrc 这取决于你需要什么。

仅供参考，我对 ZeroMQ 本身一无所知。

# html - 即使定义了宽度和高度，DIV 也会被截断

> ID：10143481
> 
> 赞同：0
> 
> 时间：2012-04-13T15:11:16.413
> 
> 标签：html, css

我的页面上有这个：

```
<div id="result" class="thumbholder"><img src="img/thumbs/thumb01.png" alt="thumb" /></div> 
```

CSS：

```
.thumbholder{
width:100px;
height:100px;
text-align:center;
overflow:hidden;
border-radius:6px;
float:left;
margin:0;
} 
```

`#result`div 没有在 CSS 中的任何地方定义（我检查过）。

div 拒绝以 100 x 100 大小显示，而是截断了部分高度。并不是说它没有一直显示，因为我可以看到较低的圆角 - 它实际上的高度比定义的要小。为什么会这样？

里面的图像也是 100 x 100 大小，但这没关系，无论我放入其中，都会发生同样的事情。

编辑：定义内联高度也无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:20:28.640

您是否在 Firebug 中检查过 div 是否继承了任何其他样式？也许添加 ' **display:block** ' 可能会修复它，如果您的 height 属性被忽略，听起来它可能会显示为内联元素......或者可能有一个 max-height: 在某处设置，在这种情况下是 ' **max-height :100%** ' 可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T22:30:54.410

尝试使用`!important`覆盖其他可能导致高度不是 100px 的代码

> ```
> .thumbholder
> {
>     width:100px !important;
>     height:100px !important;
>     text-align:center;
>     overflow:hidden;
>     border-radius:6px;
>     float:left;
>     margin:0;
> } 
> ```

这不是一个很好的解决方案，但它可以帮助您调试问题。否则，请使用 Chrome 的检查器（或萤火虫）找出覆盖您的高度定义的内容

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T16:39:21.567

试试这个

```
 <div style="clear:both;"></div>
      <div id="result" class="thumbholder"><img src="img/thumbs/thumb01.png" alt="thumb" /></div> 
```

# java - 从数组中随机选择

> ID：10143484
> 
> 赞同：0
> 
> 时间：2012-04-13T15:11:21.030
> 
> 标签：java, android

我在下面有这段代码，用于控制要从数组中显示的问题。我对第三行代码有问题，我不完全确定问题是什么。

rnd1, rnd2 都是双倍的。Eclipse 告诉我 rnd2 应该是一个 int。但是我被告知，为了使天花板功能起作用，rnd 应该是双倍的。问题是一个文本字段。问题是数组。

```
 rnd1 = Math.ceil(Math.random()*3);
 rnd2 = Math.ceil(Math.random()*questions.length)-1;
 ques.setText(questions[rnd2]); 
```

* * *

我将此基于我用于测验应用程序的动作脚本。它用于从问题数组中随机挑选出问题。

```
rnd1=Math.ceil(Math.random()*3);
rnd2=Math.ceil(Math.random()*questions.length)-1;
q.text=questions[rnd2];
if(questions[rnd2]=="x")
{
  change_question();
}
questions[rnd2]="x";
enable_disable(1); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:15:33.690

您需要使用 a 选择数组的一个元素，`int`因此请制作 rnd2`int`并转换上限函数（如果您真的需要它，如果您只转换随机数，它将截断小数位），如下所示：

```
rnd2 = (int)Math.ceil(Math.random()*questions.length)-1; 
```

只要确保将 rnd2 声明为`int`not`double`

# c - 将 R 代码转换为 C 代码

> ID：10143485
> 
> 赞同：10
> 
> 时间：2012-04-13T15:11:22.513
> 
> 标签：c, r, matrix

出于速度原因和将其打包为 .exe 的能力，我正在考虑将 R 脚本转换为 C 代码。我是 C 的新手。

我的问题是它在 C 中会明显更快吗？速率限制步骤是一种排序算法，必须多次应用于大向量。我不确定 R 中的矢量化功能是否会对此有所帮助或减慢速度。我还读到 for 循环在 R 中效率低下。

如果我应该在 C 中执行此操作，哪些库可以帮助我模仿 R 的一些数据处理功能，例如基本矩阵操作？我应该从哪里开始？现在我什至不知道如何将我的数据读入 C（逗号分隔的文本文件）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-13T18:11:10.937

我会尽量回答这个问题。

...但是您不问的问题可能更相关：R 算法可以在 R 中更快吗？这里的答案通常是“是”。它可以“足够快”吗？好吧，如果不尝试（并查看当前的 R 代码），这是不可能回答的。

问：我的 R 算法在 C 中会更快吗？

答：是的！如果您为算法编写“最好的”C 代码，它很可能会更快。这样做很可能还需要做**更多的**工作。

问：在 C 中可以更快地对大向量进行排序吗？

答：是的。使用多线程，可以大大提高速度。...但是从调用`sort(x, method='quick')`R 开始，看看这是否会有所改善！对于随机数据，默认方法不是很快。

```
x <- runif(1e7)
system.time( sort(x) )                   # 2.50 secs
system.time( sort(x, method='quick') )   # 1.37 secs
#system.time( tommysort(x) )             # 0.51 secs (4 threads) 
```

问：哪些库模仿了基本的 R 函数？

答：LAPACK/BLAS 在 R 中处理矩阵数学。如果您只需要这些，您可以找到比 R 中的普通库快得多的库（您也可以在 R 中使用其中的一些来提高性能！）。

[关于 BLAS 的更多信息](http://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms)

另一种方法是从 R 到 C 进行 .Call，然后从那里您可以访问 R 的所有功能！包`inline`和`Rcpp`包可以帮助使它更容易。

第三种方法是将 R 嵌入到您的应用程序中。`Rinside`可以帮助使这更容易。

问：如何将 CSV 数据读入 C？

- 答：看看`fopen`和`fscanf`功能。...并使用它们编写数据导入功能。

# facebook - 隐私政策身份验证对话框？

> ID：10143491
> 
> 赞同：2
> 
> 时间：2012-04-13T15:11:46.240
> 
> 标签：facebook, facebook-graph-api, privacy-policy

今天，我在一个旧应用程序的电子邮件中收到了“违规通知：隐私政策（应用程序 ID：xxxxxxxxxxxxxx）”。

我如何解决这个问题？只是添加一个隐私政策网址？或生成身份验证对话框？或删除应用程序？该应用程序是一个图像和一个 fbcomment 框，用于进入比赛的前提。

谢谢，迭戈

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-19T20:19:12.517

`Contact Info`您需要在部分 >`Privacy Policy URL`字段中将 URL 添加到您的隐私政策：

[![隐私政策网址](../Images/c18ca6d24a63fd2c4187cd5e36b75f60.png)](https://i.stack.imgur.com/XDxOX.jpg)

这样做会使您的隐私政策链接出现在应用程序对话框中，以征得用户同意，靠近`App Terms`：

[![缓冲区应用程序对话框](../Images/f848931fe5e5f23fc716f4b0bcf7b1d7.png)](https://i.stack.imgur.com/GAVMG.jpg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:14:03.010

我们也得到了这些。您只需添加一个隐私政策 URL。像您一样，我们实际上并没有使用任何显示隐私政策的功能，我们只是拥有用于创建 Facebook Feed 对话框的应用程序。

# android - 在本机 android 图库应用中打开图像

> ID：10143492
> 
> 赞同：0
> 
> 时间：2012-04-13T15:11:51.873
> 
> 标签：android, file, android-intent, uri

我有一个将图像（jpeg）保存到 SD 卡上的应用程序。我可以通过手动启动画廊来查看文件。但是我想以编程方式启动画廊并在保存文件时查看文件。--我有文件的绝对路径。

```
 Intent intent = new Intent ();
    intent.setAction(Intent.ACTION_VIEW);
    Uri uri = Uri.fromFile(file);
    intent.setData(uri);
    sendBroadcast (intent); 
```

它不会导致任何错误，但什么也没有发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:42:16.017

正确的语法是：

```
startActivity(intent); 
```

不是：

```
startBroadcast(intent); 
```

所以你的代码应该是这样的：

```
Intent intent = new Intent ();
intent.setAction(Intent.ACTION_VIEW);
Uri uri = Uri.fromFile(file);
intent.setData(uri);
startActivity(intent) 
```

此外，您可能会考虑执行以下操作：

```
intent.setDataAndType(uri, "image/*"); 
```

代替

```
intent.setData(uri); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-26T13:09:16.677

试试这个代码

```
Intent intent = new Intent();
// Show only images, no videos or anything else
intent.setType("image/*");
intent.setAction(Intent.ACTION_GET_CONTENT);
// Always show the chooser (if there are multiple options available)
startActivityForResult(Intent.createChooser(intent, "Select Picture"), PICK_IMAGE_REQUEST); 
```

参考[http://programmerguru.com/android-tutorial/how-to-pick-image-from-gallery/](http://programmerguru.com/android-tutorial/how-to-pick-image-from-gallery/)

# c - 在 C/C++ 中传递和修改多维数组

> ID：10143494
> 
> 赞同：0
> 
> 时间：2012-04-13T15:11:53.493
> 
> 标签：c, arrays, pointers, multidimensional-array, pass-by-reference

我遇到了数组和指针的问题，虽然我很瘦，但我知道我做错了什么，但我无法找到一个简单的解决方案。

我有这段代码：

```
void faceRotateACW(char *face[CUBE_DIM][CUBE_DIM]){
    char tempFace[CUBE_DIM][CUBE_DIM];
    for (int y=0;y<CUBE_DIM;y++){
        for (int x=0;x<CUBE_DIM;x++){
            tempFace[y][CUBE_DIM-x]=face[x][y];
        }
    }
    for (int a=0;a<CUBE_DIM;a++){
        for (int b=0;b<CUBE_DIM;b++){
            face[a][b]=tempFace[a][b];
        }
    }
} 
```

现在我知道问题在于我正在尝试将 char 指针分配给 char 并且这是不行的，但是我如何复制，然后修改数组并将其推回通过引用传递的数组？如何获取要传递给函数的数组中的值？

好的，一切顺利，至少我现在开始更好地理解这个问题（谢谢大家）。我需要提供更多信息，因为我使用此功能的方式可能也不是最好的方式，让我澄清一下。

我将数组定义为：

```
char *faces[NUM_FACES][CUBE_DIM][CUBE_DIM]={{{"o","o","o"},{"o","o","o"},{"o","o","o"}},
        {{"o","o","o"},{"o","o","o"},{"o","o","o"}},
        {{"o","o","o"},{"o","o","o"},{"o","o","o"}},
        {{"o","o","o"},{"o","o","o"},{"o","o","o"}},
        {{"o","o","o"},{"o","o","o"},{"o","o","o"}},
        {{"o","o","o"},{"o","o","o"},{"o","o","o"}}}; 
```

但是，当我调用该函数时，我试图像这样剥离外部数组：

```
 faceRotateACW(faces[currentFace]); 
```

对不起，我的第一篇文章：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:37:42.943

让我们从顶部开始。

在您的`main`函数（或调用的任何人`faceRotateACW`）中，您有一个数组，例如

```
char theFace[CUBE_DIM][CUBE_DIM]; 
```

除非它是`sizeof`或一元运算符的操作数`&`，或者是用于在声明中初始化另一个数组的字符串文字，否则“N-element array of `T`”类型的表达式将被转换为/替换为/“衰减”为一个类型为“pointer to `T`”的表达式，其值是数组第一个元素的地址。

如果您将函数称为

```
rotateFaceACW(theFace); 
```

函数调用中的表达式`theFace`将替换为“指向 CUBE_DIM 元素数组的指针”类型的表达式`char`，或者`char (*)[CUBE_DIM]`。因此，您的函数原型需要看起来像

```
void rotateFaceACW(char (*face)[CUBE_DIM]) {...} 
```

*或者*

```
void rotateFaceACW(char face[][CUBE_DIM]) {...} 
```

在这种情况下是一样的。您可以将其视为函数中的普通数组：

```
void rotateFaceACW(char (*face)[CUBE_DIM])
{
  char tempFace[CUBE_DIM][CUBE_DIM];
  ...
      tempFace[y][(CUBE_DIM-1)-x] = face[x][y];  // thanks Anthales
  ...
      face[x][y] = tempFace[x][y]; 
```

由于`face`是指向数组第一个元素的指针，因此在`theFace`中所做的任何更改都`rotateFaceACW`将反映在`theFace`.

由于看起来您总是要处理大小为常数 (CUBE_DIM) 的 NxN 矩阵，因此您*可能*不需要显式传递行数，但在一般情况下您需要传递。

如果您想处理*任意*数量的行和列的二维数组，则必须采用不同的方法，因为它似乎与您的问题无关，所以我不会在这里讨论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:29:14.727

据我了解，您尝试“以相反的列顺序”转置字符串矩阵。以下实现在 O(1) 空间和 O(CUBE_DIM^2) 时间内完成

```
void faceRotateACW(char* face[CUBE_DIM][CUBE_DIM])
{
    for (int i = 0;i< CUBE_DIM;++i) {
        for (int j = i; j<CUBE_DIM;++j) {
            char* tmpFace = face[i][j];
            face[i][j] = face[j][i];
            face[j][i] = tmpFace;
        }
        for (int j = 0;j < CUBE_DIM/2;++j) {
            char* tmpFace = face[i][j];
            face[i][j] = face[i][CUBE_DIM - 1 - j];
            face[i][CUBE_DIM - 1 - j] = tmpFace;
        }
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:31:06.337

您应该使用指针数组。语法类似于 faceRotateACW(char *face[],int cube_dim) 然后您可以访问多维数组中的所有值，然后更改这些值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T15:34:55.730

正如您所定义的，您传递的是一个指向 s 的指针×矩阵，*而不是*一个指向s的`CUBE_DIM`×`CUBE_DIM`矩阵的指针。要解决此问题，您应该使用`char`*`CUBE_DIM``CUBE_DIM``char`*

 *```
char (*face)[CUBE_DIM][CUBE_DIM] 
```

表示这`face`是指针，而不是存储在数组中的值。完成此操作后，代码将不再编译，因为`face[x][y]`(it is `char[]`) 是错误的分配类型和分配自的类型`tempFace[_][_]`(即 a `char`)。

你可以这样说，因为`face[x]`取消引用了指针的外层`face`（偏移量为`x`），因此也有 type `char[][]`。现在`[y]`剥去一层`[]`所以类型`face[x][y]`是`char[]`，*不是* `char`。

为了解决这个问题，我们需要在开始索引之前获取指向的数组`face`，即我们需要取消引用`face`然后索引。那是：

```
(*face)[x][y] 
```

所以最终的代码是：

```
void faceRotateACW(char (*face)[CUBE_DIM][CUBE_DIM]){
    char tempFace[CUBE_DIM][CUBE_DIM];
    for (int y=0;y<CUBE_DIM;y++){
        for (int x=0;x<CUBE_DIM;x++){
            tempFace[y][CUBE_DIM-1-x]=(*face)[x][y];
        }
    }
    for (int a=0;a<CUBE_DIM;a++){
        for (int b=0;b<CUBE_DIM;b++){
            (*face)[a][b]=tempFace[a][b];
        }
    }
} 
```*

# python - Python序列元素比较

> ID：10143499
> 
> 赞同：2
> 
> 时间：2012-04-13T15:12:23.747
> 
> 标签：python, list, comparison, sequence

我有这两个功能：

```
def comparison(a, b):
    return [-1, 0, 1].index(cmp(b, a))

def base_3(seq):
    return [comparison(a, b) for a, b in itertools.combinations(seq, 2)] 
```

函数比较基于此返回一个比较数：

1.  0 如果 a > b
2.  1 如果 a = b
3.  2 如果 a < b

函数 base_3 返回所有组合元素之间的比较。

例如：

```
x = [0, 1, 2]
y = [1, 2, 0]
z = [0, 1, 0]

>>> base_3(x)
[2, 2, 2]

>>> base_3(y)
[2, 0, 0]

>>> base_3(z)
[2, 1, 0] 
```

如果可能，我需要一个从给定 base_3 返回序列的函数：

```
>>> base_3_to_seq([2, 2, 2])
[0, 1, 2]

>>> base_3_to_seq([2, 1, 0])
[0, 1, 0]

>>> base_3_to_seq([0, 2, 1])
"Impossible" 
```

如何编写这个函数 base_3_to_seq？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:29:53.380

这是一种蛮力的方式：

```
def base_3_to_seq(base3):
   for seq in itertools.product(range(3), repeat=3):
       if base_3(seq) == base3:
           return seq
   return "Impossible" 
```

根据您最常调用它的方式，您可以通过记忆 base_3 或 base_3_to_seq 来加快代码的长期运行速度。

# java - Java IO 性能问题

> ID：10143501
> 
> 赞同：3
> 
> 时间：2012-04-13T15:12:35.750
> 
> 标签：java

我在用：

```
PrintWriter out = new PrintWriter(new BufferedWriter(new FileWriter("test.txt"),1024*1024*500)) 
```

写入一个大文件（约 2GB）。写入需要 26 秒。但是，当我用 10/20 替换 500 时，需要 19 秒。

从[这里](http://java.sun.com/developer/technicalArticles/Programming/PerfTuning/)，我理解的是缓冲提供了更好的性能。如果是这样，那么为什么会发生这种情况？我通过每次运行 5 次来检查它，因此系统/IO 负载不是问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:16:22.557

正如我在上一个问题中所说，有一个最佳缓冲区大小（通常约为 32 KB），当您使缓冲区大于此大小时，它会更慢而不是更快。默认缓冲区大小为 8 KB。

顺便说一句：你的 L2/L3 CPU 缓存有多大？（我怀疑大约 10 MB）您的主 L1 缓存大约是 32 KB？

通过使用适合最快缓存的缓冲区，您正在使用最快的内存。通过使用仅适合主内存的缓冲区，您正在使用最慢的内存（慢 10 倍）

* * *

在回答你的问题。

我所做的是假设`ISO-8859-1`编码`(byte) ch`，即一次将一个字节写入 ByteBuffer，可能是内存映射。

我有用于写入/读取`long`和`double`从 ByteBuffer 读取的方法，而不会产生任何垃圾。

[https://github.com/peter-lawrey/Java-Chronicle/blob/master/src/main/java/vanilla/java/chronicle/impl/AbstractExcerpt.java](https://github.com/peter-lawrey/Java-Chronicle/blob/master/src/main/java/vanilla/java/chronicle/impl/AbstractExcerpt.java)

使用这种方法，您可以每秒将大约 500 万行记录到磁盘。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T15:17:26.810

缓冲区过大会降低性能。坚持大约 32-64 kb IMO

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T15:17:11.497

`1024*1024*500`是 500 兆字节，给或取一点点。您基本上是在强制 JVM 分配一个 500mb 的连续内存块，而 JVM 可能必须执行 GC 循环才能做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T15:17:19.000

非常大的缓冲区（500 MB）也不好，因为对于操作系统来说，为那个巨大的字节缓冲区进行内存管理会更加困难。

将其与在您的房子里移动一张桌子而不是移动一个盒子进行比较。但是如果你的箱子变得太小，你将不得不去来回很多次。

不要忘记分配内存是一个`O(n)`操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-13T15:24:19.077

首先，您真的不需要那么大的缓冲区。通常 64K 甚至低至 8K 就足以获得下降 IO 性能。任何更大，您只是在浪费内存和 CPU，因为随着缓冲区越来越大，它会在 IO 层花费更多时间来写入大量数据。因此，在等待 IO 和仅写入内存之间进行权衡（如果您了解微积分，则为 min-max）。您不能将巨大的缓冲区推送到 IO 设备，因为它有一个内部固定大小的缓冲区。关键是尽可能地尝试匹配它，但要意识到这样做是相对不可能的，因为您不知道其他处理在做什么。最好的办法是尝试一些低 8K-16K 的东西，运行它，测量它。将缓冲区 32K 等加倍，运行它，测量它。如果你的速度有所提高，请再做一次。

因此，如果您在 26 秒内写入 2GB 数据，则吞吐量为 76MB/S 或 650Mbit/s。您可以通过将缓冲区大小降低到合理的值来改进它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-13T15:29:17.220

通过减少系统调用的数量，缓冲 I/O 可以在一定程度上提高性能。但是系统调用并没有那么昂贵（可能是一毫秒左右），过大的缓冲区可能会导致其他方面的问题。例如：

*   500 MB 的缓冲区使用大量内存，并可能增加 GC 开销，或增加系统的分页负载。

*   如果您在一次写入调用中写入 500 MB，则写入可能会使系统的缓冲区缓存饱和，并压倒其在应用程序级别执行其他操作时重叠磁盘写入的能力。

只需尝试使用（显着）较小的缓冲区。（如果不进行一些特定于应用程序的调整，我个人不会使用大于 8kb 的缓冲区。）

# ajax - 在没有提交按钮的情况下防止 ajax 请求和表单上的 CSRF

> ID：10143502
> 
> 赞同：6
> 
> 时间：2012-04-13T15:12:38.847
> 
> 标签：ajax, security, token, csrf

我对网络安全相当陌生。我想知道在没有提交按钮（即状态更新）的情况下在 ajax 请求和表单上使用令牌以保护 CSRF 的正确方法是什么。有人可以给我看一个代码示例吗？我知道如何正确处理带有提交按钮的表单。同样在我的 ajax 文件夹中，我有一个带有以下内容的 htaccess：

```
SetEnvIfNoCase X-Requested-With XMLHttpRequest ajax
Order Deny,Allow
Deny from all
Allow from env=ajax 
```

这对 ajax 请求是否足够安全，或者我也应该为 ajax 请求实现令牌安全性？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-13T15:26:53.100

您需要做的就是在页面加载时生成一个秘密（令牌）。将它放在页面上，并在会话中。通常，如果可以的话，我会将它作为隐藏字段放在表单中，或者如果它是一个更大的非常 ajaxy 页面的一部分，我会将它放在相关元素上的 value 属性中，比如包装整个页面的 div。其他人将添加一个带有变量集的脚本标签。

然后，每当您进行 AJAX 调用或发送表单时，都会包含一个密码字段。（Cheekysoft 的回答更详细地介绍了如何使用原始 JS 执行此操作，它可以与 jQuery 或您可能使用的任何其他框架大致相同。）将其与后端的会话值匹配以确保它们仍然存在相同（来自同一来源），你很好。

如果您想增加安全性，请在每个请求上重新生成密钥，并将该新密钥与请求的数据一起返回。让所有 ajax 请求用新值替换隐藏字段或值属性。如果您正在执行大量请求或并发请求，这并不能很好地工作。确实，如果您通过 HTTPS 执行此操作，则每次加载整个页面时生成一个就足够了，您应该这样做。

如果您不是通过 HTTPS 执行此操作，那真的没关系，坐在网吧/星巴克的人可以窃取会话并重新加载页面。

如果您要经常这样做，那么值得查看 jQuery 和[各种](https://gist.github.com/1044457)有助于为您提供 CSRF 保护的插件。[而且，我的方法不是唯一的方法。](http://erlend.oftedal.no/blog/?blogid=118)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T15:28:44.880

如果您的 XHR 是 GET 请求，请将令牌作为 URL 参数包含并让 PHP 脚本从`$_GET[]`. 如果您的 XHR 是 POST，则将令牌弹出到 POST 数据中并让 PHP 脚本从`$_POST[]`.

**获取请求**

```
var token = getElementById( 'myHiddenField' ).value;
var xhr = new XMLHttpRequest();
xhr.open( 'GET', 'server.php?token=' + token );
xhr.send( null ); 
```

**POST 请求**

```
var token = getElementById( 'myHiddenField' ).value;
var xhr = new XMLHttpRequest();
xhr.open( 'POST', 'server.php', true );
xhr.setRequestHeader( 'Content-Type', 'application/x-www-form-urlencoded' );
xhr.onreadystatechange = function() {
  if (xhreq.readystate != 4) { return; }
  // do client side stuff here
};
xhr.send( 'token=' + token ); 
```

# asp.net - 应用程序库的日志不会出现在 Windows 事件查看器中

> ID：10143505
> 
> 赞同：0
> 
> 时间：2012-04-13T15:12:52.293
> 
> 标签：asp.net, logging, enterprise-library

我尝试将我的应用程序配置为在 Windows 的事件查看器中显示日志，但它不起作用，但程序运行良好。谁能告诉我我的配置是正确的还是我有错误？

```
 <?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <configSections>
        <section name="loggingConfiguration" type="Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.LoggingSettings, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" requirePermission="true" />
    </configSections>
    <loggingConfiguration name="" tracingEnabled="true" defaultCategory="General">
        <listeners>
            <add name="Event Log Listener" type="Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.FormattedEventLogTraceListener, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
                listenerDataType="Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.FormattedEventLogTraceListenerData, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
                source="Enterprise Library Logging" formatter="Text Formatter"
                log="" machineName="." traceOutputOptions="None" />
        </listeners>
        <formatters>
            <add type="Microsoft.Practices.EnterpriseLibrary.Logging.Formatters.TextFormatter, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
                template="Timestamp: {timestamp}{newline}&#xA;Message: {message}{newline}&#xA;Category: {category}{newline}&#xA;Priority: {priority}{newline}&#xA;EventId: {eventid}{newline}&#xA;Severity: {severity}{newline}&#xA;Title:{title}{newline}&#xA;Machine: {localMachine}{newline}&#xA;App Domain: {localAppDomain}{newline}&#xA;ProcessId: {localProcessId}{newline}&#xA;Process Name: {localProcessName}{newline}&#xA;Thread Name: {threadName}{newline}&#xA;Win32 ThreadId:{win32ThreadId}{newline}&#xA;Extended Properties: {dictionary({key} - {value}{newline})}"
                name="Text Formatter" />
        </formatters>
        <categorySources>
            <add switchValue="All" name="General">
                <listeners>
                    <add name="Event Log Listener" />
                </listeners>
            </add>
        </categorySources>
        <specialSources>
            <allEvents switchValue="All" name="All Events" />
            <notProcessed switchValue="All" name="Unprocessed Category" />
            <errors switchValue="All" name="Logging Errors &amp; Warnings">
                <listeners>
                    <add name="Event Log Listener" />
                </listeners>
            </errors>
        </specialSources>
    </loggingConfiguration>
    <system.diagnostics>
        <sources>
            <!-- This section defines the logging configuration for My.Application.Log -->
            <source name="DefaultSource" switchName="DefaultSwitch">
                <listeners>
                    <add name="FileLog"/>
                    <!-- Uncomment the below section to write to the Application Event Log -->
                    <!--<add name="EventLog"/>-->
                </listeners>
            </source>
        </sources>
        <switches>
            <add name="DefaultSwitch" value="Information" />
        </switches>
        <sharedListeners>
            <add name="FileLog"
                 type="Microsoft.VisualBasic.Logging.FileLogTraceListener, Microsoft.VisualBasic, Version=8.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL"
                 initializeData="FileLogWriter"/>
            <!-- Uncomment the below section and replace APPLICATION_NAME with the name of your application to write to the Application Event Log -->
            <!--<add name="EventLog" type="System.Diagnostics.EventLogTraceListener" initializeData="APPLICATION_NAME"/> -->
        </sharedListeners>
    </system.diagnostics>
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:45:31.260

如果您打开注册表，您会找到事件查看器的键。

开启`HKLM/SYSTEM/CurrentControlSet/Services/EventLog`

右键单击并查看您赢得的部分的权限，以获得从 asp.net 池中写入的权限。

# android - 子类化应用程序是在 Android 中实现静态辅助方法的唯一方法吗？

> ID：10143508
> 
> 赞同：1
> 
> 时间：2012-04-13T15:13:00.717
> 
> 标签：android, subclass

我想在我的 android 应用程序中有一个辅助类，例如 Convert 或 Utils。我遇到的典型问题是：

```
public class Convert {

    private Convert() {
        // I can't be instantiated
    }

    public static int pxToDp(float pixels) {
        DisplayMetrics displayMetrics = getResources().getDisplayMetrics();
        return (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, pixels, displayMetrics);
    }
} 
```

以上当然失败了，因为 Convert 不知道 getResources() 是什么。所以这给我留下了两个选择：

1.  每次我想使用辅助方法时都传递一个上下文，这是垃圾
2.  子类应用程序，修改我的清单，然后创建一个引用，如下所示：

    ```
    public class App extends Application {

        private static Context mContext;

        @Override
        public void onCreate() {
            super.onCreate();
            mContext = this;
        }

        public static Context getContext() {
            return mContext;
        }
    } 
    ```

然后`App.getContext()`在我需要的任何地方做。

问题：这不可能是正确的，优雅的方式是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T15:22:06.663

如果你对应用程序进行子类化，这显然会起作用，但你最终可能会得到一个巨大的、可怕的类，它会做一大堆不相关的事情——粗暴地践踏单一职责原则。

是的，将上下文传递给实用程序类有点麻烦和烦人，但这意味着您可以为每种类型的实用程序（例如 StringUtils 或其他）创建类，并且至少将职责分开。

我建议不要在任何地方使用 App.getContext，因为这意味着您的所有实用程序类都将依赖于 App，这使得重用它们变得困难。如果传入上下文，则可以更轻松地在其他应用程序中重用某些实用程序类。

所以我会说使用单独的类，并将该上下文传递给方法。它有点难看，但在我看来，比替代品要丑得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-10T19:34:32.947

> *每次我想使用辅助方法时都传递一个上下文，这是垃圾*

对我来说，这听起来像是 OOP 宗教。我实际上会传入`DisplayMetrics`, 因为这是函数真正需要计算其答案的内容。

# javascript - JavaScript 中的 for 循环 - 谁能帮助我理解？

> ID：10143513
> 
> 赞同：1
> 
> 时间：2012-04-13T15:13:20.967
> 
> 标签：javascript, for-loop

我实际上是 javascript 的新手，只是为了学习基础知识，我开始学习 codecademy 课程。

```
var i;
for (i = 1; i <= 40; i++) {
  console.log("i is now equal to " + i);
} 
```

这是我的问题 - 在这段代码中，什么时候`i <= 40`，它应该打印到 41，不是吗？因为`for`循环继续运行直到条件`i <= 40`为`true`，但为什么它只打印到 40 呢？

IE

当它在 40 处运行时，它会通过增加一次来打印到 41，不是吗？那为什么它只打印到40？

如果有人还向我解释了代码的确切作用以及每一行的含义和作用，我将非常感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:20:12.497

`i=1`是初始化器，所以 的第一个值为`i`1。

初始化后，并在每次迭代时返回顶部，`i`检查条件`i<=40`。每次完成迭代后，执行增量`i++`。在第 40 次迭代中，i=40，通过条件并打印日志。然后（与之前的所有迭代一样）`i++`被调用，`i`最多 41 个。然后测试*失败*，`i<=40`因此循环*不会*再次执行代码块。

结果是控制台打印 1 到 40，然后退出`i=41`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:15:38.597

它说以下

```
var i; // DECLARE A NEW VARIABLE NAMED i

// set i to 1 and do things while i is less than or equal to 40
// after this block of code has executed increase the counter by 1

for (i = 1; i <= 40; i++) {     
  console.log("i is now equal to " + i);  // print "i is now equal to <the value of i>"
} 
```

这意味着它将第一次打印出数字 1 并且每次递增 1 直到 i 等于 41 时循环将完成（但不会在`{`' 的含义之间执行更多操作 41 永远不会被打印)

如果你写了以下

```
for (i = 0; i <= 40; i++) {     
  console.log("i is now equal to " + i);  // print "i is now equal to <the value of i>"
} 
```

除了计数将从 0 开始，再迭代一次，但它仍然会在 i 等于 41 时退出，但它仍然不会打印 41

如果您要在循环之外执行另一个日志语句，您会发现 i 等于 41，但该值从未在循环体中使用（大括号中的位）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T15:17:59.013

循环的最后一次运行`i`是 40，一旦达到 41，它就会退出循环。该`i++`语句在循环语句之后执行。

```
var i;
for (i = 1; i <= 40; i++) {
  console.log("i is now equal to " + i);
}

console.log("i is now equal to " + i); // Now it's 41 
```

这就是 for 循环的工作原理

```
for ( var i= 0; /* initializer */; 
     i < 40; /* check whether it should run, before running loop statements */ 
     i++ /* happens after the loop statements */ ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T15:17:37.377

当`i = 41`条件语句 ( `i <= 40`) 被检查并`false`返回时，循环停止执行其内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T15:19:19.380

在执行 for 循环内的代码之前，会检查条件（在您的情况下 i <= 40）。因此，当 i 达到 41 时，i <= 40 将评估为 false，因此不会执行该块并且不会打印 41。

此外，增量 (i++) 发生在条件之前。

# python - 如何按照特定模式对字符串列表进行排序

> ID：10143515
> 
> 赞同：3
> 
> 时间：2012-04-13T15:13:29.360
> 
> 标签：python, list, sorting, design-patterns

我想对每个字符串列表进行排序，例如：

```
list1 = ['3DT1_PN_DIS3D_S001', '3DT1_PN_noDIS3D_S001', '3DT1_S001', '3DT1_noPN_DIS3D_S001']
list2 = ['3DT1_noPN_DIS3D_S002', '3DT1_PN_noDIS3D_S002', '3DT1_PN_DIS3D_S002'] 
```

跟随模式`[ '3DT1_S##', '3DT1_noPN_DIS3D_S##', '3DT1_PN_noDIS3D_S##', '3DT1_PN_DIS3D_S##']`

结果应该是：

```
list1 = [ '3DT1_S001', '3DT1_noPN_DIS3D_S001', '3DT1_PN_noDIS3D_S001', '3DT1_PN_DIS3D_S001']
list2 = [ '3DT1_noPN_DIS3D_S002', '3DT1_PN_noDIS3D_S002', '3DT1_PN_DIS3D_S002'] 
```

我尝试使用 sorted 方法，但没有运气！

有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:22:59.740

您可以定义一个按所需顺序返回元组的*键函数*，然后将该函数传递给like so的`key`参数。`sorted`

```
>>> def key_fn(x):
...     tags = x.split('_')
...     if tags[1][0] == 'S':
...         return (0, int(tags[1][1:]))
...     elif tags[1] == 'noPN':
...         return (1, int(tags[3][1:]))
...     elif tags[1] == 'PN':
...         if tags[2] == 'noDIS3D':
...             return (2, int(tags[3][1:]))
...         else:
...             return (3, int(tags[3][1:]))
... 
>>> list1 = ['3DT1_PN_DIS3D_S001', '3DT1_PN_noDIS3D_S001', '3DT1_S001', '3DT1_noPN_DIS3D_S001']
>>> sorted(list1, key=key_fn)
['3DT1_S001', '3DT1_noPN_DIS3D_S001', '3DT1_PN_noDIS3D_S001', '3DT1_PN_DIS3D_S001'] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T22:19:14.020

我的两分钱......这有一个定义订单的'patternList'变量。这可能是实现这一点的最简单（最易读、可扩展）的方法：没有凌乱的 if-else。此外，具有相同起始模式的列表项按字符串的其余部分排序。

这`list1.sort(key = myKey)`意味着对于每个列表项`myKey`功能在排序之前执行。**函数仅以**正常排序将执行您想要的方式`myKey`修改已排序的列表项以进行排序。在输出排序列表中，未使用原始列表项（不是修改的项）。**`myKey`**

 **在下面的示例中，myKey 函数将列表项分成两部分，并根据 patternList 变量用整数标记第一部分。普通排序可以以您想要的方式处理返回的元组。

```
list1 = ['3DT1_PN_DIS3D_S001', '3DT1_PN_noDIS3D_S001', '3DT1_S001', '3DT1_noPN_DIS3D_S001']
list2 = ['3DT1_noPN_DIS3D_S002', '3DT1_PN_noDIS3D_S002', '3DT1_PN_DIS3D_S002', '3DT1_PN_DIS3D_S003', '3DT1_PN_DIS3D_S001']

def myKey(x):
    # create the 'order list' for starting pattern
    patternsList = [ '3DT1_S', '3DT1_noPN_DIS3D_S', '3DT1_PN_noDIS3D_S', '3DT1_PN_DIS3D_S']
    for i in range(len(patternsList)): # iterate patterns in order
        pattern = patternsList[i]
        if x.find(pattern) == 0: # check if x starts with pattern
            # return order value i and x without the pattern
            return (i, x.replace(pattern, '')) 

    # if undefined pattern is found, put it to first
    return (-1, x)

    # alternatively if you want undefind to be last
    # return (len(patternList)+1, x)

print list1
list1.sort(key = myKey)
print list1

print list2
list2.sort(key = myKey)
print list2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T15:31:10.393

此方法通过按找到的第一个模式的索引进行排序来工作。

```
>>> import re
>>> list1 = ['3DT1_PN_DIS3D_S001', '3DT1_PN_noDIS3D_S001', '3DT1_S001', '3DT1_noPN_DIS3D_S001']
>>> list2 = ['3DT1_noPN_DIS3D_S002', '3DT1_PN_noDIS3D_S002', '3DT1_PN_DIS3D_S002']
>>> patterns = [ '3DT1_S', '3DT1_noPN_DIS3D_S', '3DT1_PN_noDIS3D_S', '3DT1_PN_DIS3D_S']
>>> pattern = '|'.join('(%s)'%x for x in patterns)
>>> pattern #Creates a regex pattern with each pattern as a group in order
'(3DT1_S)|(3DT1_noPN_DIS3D_S)|(3DT1_PN_noDIS3D_S)|(3DT1_PN_DIS3D_S)'
>>> def sort_key(x):
        return re.match(pattern,x).lastindex
>>> list1, list2 = [sorted(l, key=sort_key) for l in (list1,list2)]
>>> list1
['3DT1_S001', '3DT1_noPN_DIS3D_S001', '3DT1_PN_noDIS3D_S001', '3DT1_PN_DIS3D_S001']
>>> list2
['3DT1_noPN_DIS3D_S002', '3DT1_PN_noDIS3D_S002', '3DT1_PN_DIS3D_S002'] 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-13T15:25:01.723

这是一种采用“前缀”列表的方法，该列表用于在排序之前对列表进行分组。*每个项目都添加到与其匹配的第*一个前缀对应的组中，并且只有第一个前缀。

```
list1 = ['3DT1_PN_DIS3D_S001', '3DT1_PN_noDIS3D_S001', '3DT1_S001', '3DT1_noPN_DIS3D_S001']
list2 = ['3DT1_noPN_DIS3D_S002', '3DT1_PN_noDIS3D_S002', '3DT1_PN_DIS3D_S002', '3DT1_S002']

prefixes = [ '3DT1_S', '3DT1_noPN_DIS3D_S', '3DT1_PN_noDIS3D_S', '3DT1_PN_DIS3D_S']

def f(l):
    result = []
    for p in prefixes:               # for each prefix, in order
        a = []                       # items in the group
        b = []                       # items not in the group
        for x in l:                  # for each item
            if x.startswith(p):      # does the item match the prefix?
                a.append(x)          # add it to the group
            else:  
                b.append(x)          # add it to the "rest"
        result.append(sorted(a))     # sort the group and save it for the result
        l = b                        # continue with the non-group elements
    return result 
```

结果如下：

```
>>> f(list1)
[['3DT1_S001'], ['3DT1_noPN_DIS3D_S001'], ['3DT1_PN_noDIS3D_S001'], ['3DT1_PN_DIS3D_S001']]
>>> f(list2)
[['3DT1_S002'], ['3DT1_noPN_DIS3D_S002'], ['3DT1_PN_noDIS3D_S002'], ['3DT1_PN_DIS3D_S002']] 
```**

# ajax - 无法访问 Ajax JSON 数据对象

> ID：10143516
> 
> 赞同：2
> 
> 时间：2012-04-13T15:13:38.503
> 
> 标签：ajax, json, extjs

我有一个从 Ajax 调用返回的 JSON 响应，但似乎根本无法访问 JSON 的任何部分。

JSON 格式为：[{"id":"1","description":"Employee","coverage":"Center","covered":"X"}]

我尝试了以下方法，但没有任何效果：

```
success: function(result, request){
    jsonData = Ext.util.JSON.decode(result.responseText);
    var id = jsonData.id;
    alert(id);
 }

 * returns as undefined

success: function(result,request){
    jsonData = result.responseText  ##shows the Json perfectly
    alert(jsonData.length) ### displays as number of chars, not how many objects in json string
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T17:47:05.223

`Ext.util.JSON.decode`是 ExtJS3 方法并且`Ext.JSON.decode`在 ExtJS4 中，因为您没有指出您正在使用哪个版本的 ExtJS，所以将使用故障安全方式，`Ext.decode`这在 ExtJS3 和 ExtJS4 中都可用

```
success: function(result, request){
    jsonData = Ext.decode(result.responseText);
    console.log(jsonData);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T16:46:40.777

您可以为此使用“邪恶” `eval`：

```
var jsonData;
eval('jsonData =' + result.responseText);
alert(jsonData[0].id); 
```

# javascript - jQuery $.parents() 无法正常运行

> ID：10143517
> 
> 赞同：0
> 
> 时间：2012-04-13T15:13:42.107
> 
> 标签：javascript, jquery, html

我的 html 文件中有以下代码，我想访问一个元素的祖父，例如 table，它是以下代码中 td 的祖父。为此，我使用了以下 jquery 语法，但它显示“未定义”。谁能指导我问题出在哪里？

```
 <script type="text/javascript">

   $(document).ready(function () {
     alert($('td[id="4"]').parents().eq(1).attr("id"));
  });

</script> 

<title></title>
</head>
<body>
<form id="form1" runat="server">
  <div  class="ui-layout-center" id="center" runat="server">
     <table id="Table1" >             
        <tr id="tr1">
            <td id="3" class="cell" >
               first cell 
            </td>
            <td id="4" class="cell">
            second cell
            </td>
        </tr> 
     </table>
    <br />
    <br />
  </div>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:20:27.220

首先，在加载 DOM 之前，您无法运行代码。这意味着您要么必须将它放在源文件中相关 HTML 之后，要么使用 jQuery 的等待 DOM 加载的方法：

```
$(document).ready(function() {
    alert($('td[id="4"]').parents().eq(0).attr("id"));
}); 
```

然后，您的代码：

```
$('td[id="4"]').parents().eq(0) 
```

`td`正在获取匹配元素的第一个父级。第一个父级将是`tr`标签，它会提醒它的 ID，而不是`<table>`元素的 id，如您在此处看到的：http: [//jsfiddle.net/jfriend00/rxUEp/](http://jsfiddle.net/jfriend00/rxUEp/)

如果您想要表格元素的 ID，那么最好使用如下代码指定您想要的实际父级：

```
$(document).ready(function() {
    alert($('td[id="4"]').closest("table").attr("id"));
}); 
```

进一步解决问题，ID 值应该以下划线或字母开头，而不是数字，一旦你有一个有效的 ID，你应该使用更高效的选择器，如下所示：

```
<table id="Table1" >
    <tr id="tr1">
        <td id="cell3" class="cell" >
           first cell 
        </td>
        <td id="cell4" class="cell">
        second cell
        </td>
    </tr> 
</table>

$(document).ready(function() {
    alert($('#cell4').closest("table").attr("id"));
}); 
```

PS 找到所需父级的另一个好处`.closest("table")`是表都有一个隐式`<tbody>`标签（即使它不在您的 HTML 中），这意味着实际`<table>`标签实际上是您的`<td>`. 有了`.closest("table")`，您不必担心这些查找细节，因为 jQuery 只会找到您指定的那个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T15:17:33.303

您正在一个尚不存在的表上运行代码。将`<script>`块移动到表格下方并且它可以工作（尽管您将获取`tr`父级，而不是`table`父级），或者将它放在一个 onready 函数中，这样它在整个 DOM 完成之前不会触发。

演示：（警报两次，一次在表前，一次在表后） [http://jsfiddle.net/Fzcv4/1/](http://jsfiddle.net/Fzcv4/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:15:36.880

如果您特别知道您想要哪个父元素，请尝试使用最接近的：

```
$(function() {
    alert($('td[id="4"]').closest("table").attr("id"));
}); 
```

此外，`id`以数字开头的属性无效。

# javascript - Django jquery ajax 图片上传

> ID：10143519
> 
> 赞同：1
> 
> 时间：2012-04-13T15:13:46.490
> 
> 标签：javascript, python, django, jquery

我正在使用 jquery 表单插件[http://jquery.malsup.com/form/#getting-started](http://jquery.malsup.com/form/#getting-started)将图像上传到 django 服务器端。没有错误，但图像未存储在 MEDIA_ROOT 路径中。在过去的两天里，我尝试了各种技术（尝试过的插件），但没有任何效果。下面我已经给出了一切，以方便您。

我的 HTML 代码：

```
<form id="uploadform" method="post" enctype="multipart/form-data" action="background/">
<input type="file" name="photoimg" id="photoimg" />
</form> 
```

Javascript代码：

[https://gist.github.com/2377516](https://gist.github.com/2377516)

Django 模型.py：

```
class BackgroundModel(models.Model):
    user = models.OneToOneField(User)
    background = models.ImageField(upload_to='backgrounds') 
```

Django 视图.py：

```
 def backgroundview(request):
        if request.is_ajax():
            b = request.POST.get('photoimg')        
        try:
            g = BackgroundModel.objects.get(user=request.user)
        except BackgroundModel.DoesNotExist:
            bm = BackgroundModel(background=b)
            bm.user = request.user
            bm.save()
        else:
            g.background = b
            g.save()
        return HttpResponse("") 
```

Django 设置.py：

```
MEDIA_ROOT = '/home/nirmal/try/files/'
MEDIA_URL = 'http://localhost:8000/files/' 
```

Django urls.py：

```
url(r'^cover/$', login_required(direct_to_template), {'template': 'cover.html'}),
url(r'^cover/background/$', 'cover.views.backgroundview'), 
```

有人可以帮我吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T16:39:21.403

文件在 request.FILES 而不是 request.POST 中。您没有看到任何错误，因为您从未确认`b`实际上得到了一个值，尽管我很惊讶您没有看到背景错误不能为空。

此外，您应该尝试为此使用 ModelForm。它将包含您必须编写的许多行为。

# pimcore - Pimcore 将对象链接到文档

> ID：10143524
> 
> 赞同：0
> 
> 时间：2012-04-13T15:13:59.727
> 
> 标签：pimcore

我试图了解 Pimcore。只是为了练习，我创建了一个名为 BlogItem 的对象。我有一个列出 BlogItems 的控制器。然后我想启用，所以当您单击博客项目标题时，浏览器中只显示博客项目。

URL 类似于： http: [//www.domain.com/blog/view/1](http://www.domain.com/blog/view/1) (id)。

Pimcore 如何做到这一点？是否有 Pimcore 指南描述如何做这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T22:14:10.317

不确定我是否正确，但我会尽力回答。

如果您 a) 创建一个新文档（在这种情况下，您需要创建文档博客并在其中添加一个子文档视图），您将获得这样一个 url。问题是“1”，因为这是一个参数。对于文档，它看起来像 /blog/view?id=1 左右。

b）您使用静态路由。您可以通过管理界面创建它们。[这是详细的操作方法： http](http://www.pimcore.org/wiki/display/PIMCORE/Custom+Routes+(Static+Routes) ://www.pimcore.org/wiki/display/PIMCORE/Custom+Routes+(Static+Routes )

在这两种情况下，您都可以定义一个控制器和一个动作名称（实际上是控制器中的方法名称，以 Action 为后缀）。

高温高压

# iphone - 为什么 iPhone 收不到推送通知？

> ID：10143527
> 
> 赞同：2
> 
> 时间：2012-04-13T15:14:05.850
> 
> 标签：iphone, ios, push-notification, apple-push-notifications, apns-php

我真的不知道问题出在哪里。我正在使用库 ApnsPHP 来发送推送通知。我也尝试了其他脚本，但这也不起作用。

我使用本教程（http://code.google.com/p/apns-php/wiki/CertificateCreation）生成推送证书，并将它们放到苹果开发者网站上。我从 iphone 获得了正确的令牌，我将其放入 sample_push.php

我有 Macbook Pro 13 英寸，2010 年中，带有 Mac OS Lion。

```
vojta:~/dev/www/application$ php sample_push.php 
Fri, 13 Apr 2012 16:23:24 +0200 ApnsPHP[6478]: INFO: Trying ssl://gateway.sandbox.push.apple.com:2195...
Fri, 13 Apr 2012 16:23:32 +0200 ApnsPHP[6478]: INFO: Connected to ssl://gateway.sandbox.push.apple.com:2195.
Fri, 13 Apr 2012 16:23:32 +0200 ApnsPHP[6478]: INFO: Sending messages queue, run #1: 1 message(s) left in queue.
Fri, 13 Apr 2012 16:23:32 +0200 ApnsPHP[6478]: STATUS: Sending message ID 1 [custom identifier: Message-Badge-3] (1/3): 109 bytes.
Fri, 13 Apr 2012 16:23:33 +0200 ApnsPHP[6478]: INFO: Disconnected. 
```

**如果我执行“php sample_push.php”，我不会收到任何错误，但我的 iPhone 上也没有收到任何推送通知。**

源 sample_push.php：

```
// Using Autoload all classes are loaded on-demand
require_once 'ApnsPHP/Autoload.php';

// Instanciate a new ApnsPHP_Push object
$push = new ApnsPHP_Push(
    ApnsPHP_Abstract::ENVIRONMENT_SANDBOX,
    'server_certificates_bundle_sandbox.pem'
);

// Set the Root Certificate Autority to verify the Apple remote peer
$push->setRootCertificationAuthority('entrust_root_certification_authority.pem');

// Connect to the Apple Push Notification Service
$push->connect();

// Instantiate a new Message with a single recipient

$message = new ApnsPHP_Message('xxxx'); // i put my token here

// Set a custom identifier. To get back this identifier use the getCustomIdentifier() method
// over a ApnsPHP_Message object retrieved with the getErrors() message.
$message->setCustomIdentifier("Message-Badge-3");

// Set badge icon to "3"
//$message->setBadge(3);

// Set a simple welcome text
$message->setText('Hello APNs-enabled device!');

// Play the default sound
$message->setSound();

// Set the expiry value to 30 seconds
$message->setExpiry(30);

// Add the message to the message queue
$push->add($message);

// Send all messages in the message queue
$push->send();

// Disconnect from the Apple Push Notification Service
$push->disconnect();

// Examine the error message container
$aErrorQueue = $push->getErrors();
if (!empty($aErrorQueue)) {
    var_dump($aErrorQueue);
} 
```

我也在尝试更简单的脚本（也不起作用）

```
// Put your device token here (without spaces):
$deviceToken = 'xxxxxxxxxxx';

// Put your private key's passphrase here:
$passphrase = 'pushchat';

// Put your alert message here:
$message = 'My first push notification!';

////////////////////////////////////////////////////////////////////////////////

$ctx = stream_context_create();
stream_context_set_option($ctx, 'ssl', 'local_cert', 'ck.pem');
stream_context_set_option($ctx, 'ssl', 'passphrase', $passphrase);

// Open a connection to the APNS server
$fp = stream_socket_client(
    'ssl://gateway.sandbox.push.apple.com:2195', $err,
    $errstr, 60, STREAM_CLIENT_CONNECT|STREAM_CLIENT_PERSISTENT, $ctx);

if (!$fp)
    exit("Failed to connect: $err $errstr" . PHP_EOL);

echo 'Connected to APNS' . PHP_EOL;

// Create the payload body
$body['aps'] = array(
    'alert' => $message,
    'sound' => 'default'
    );

// Encode the payload as JSON
$payload = json_encode($body);

// Build the binary notification
$msg = chr(0) . pack('n', 32) . pack('H*', $deviceToken) . pack('n', strlen($payload)) . $payload;

// Send it to the server
$result = fwrite($fp, $msg, strlen($msg));

if (!$result)
    echo 'Message not delivered' . PHP_EOL;
else
    echo 'Message successfully delivered' . PHP_EOL;

// Close the connection to the server
fclose($fp); 
```

我真的不知道该怎么办。请帮助我的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T16:03:52.357

我解决了。这是因为 XCode 使用 iOS Team Provision Profile 签署了应用程序。删除此配置文件后，推送通知开始起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T18:38:33.593

当向苹果发送推送通知时，它会返回一个状态码。您收到的状态码是什么？你得到一个0回来吗？

```
Status codes
0   No errors encountered
1   Processing error
2   Missing device token
3   Missing topic
4   Missing payload
5   Invalid token size
6   Invalid topic size
7   Invalid payload size
8   Invalid token
255 None (unknown) 
```

# c# - 通过搜索“名称”检索元素“值”

> ID：10143530
> 
> 赞同：2
> 
> 时间：2012-04-13T15:14:10.820
> 
> 标签：c#, xml

我很肯定这是一个简单的问题，但我无法弄清楚。

我正在将 XML 文件下载到 C# 中的字符串，它包含以下格式的项目：

```
<attribute name="Make" value="Volvo" />
<attribute name="Color" value="Blue" />
<attribute name="Damage" value="Rear scratched" />
<attribute name="Damage" value="Left hand side dented" /> 
```

而我想要做的就是将整个文档中“损坏”的*所有*值（无论它们落在哪里）放入一个数组中。我一直在玩 XmlDocument / XmlNodeList 但我就是不知道如何让它工作。

我很想用 RegEx 来做这件事，但感觉非常非常肮脏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-13T15:18:36.283

使用`XDocument`：

```
var doc = XDocument.Parse(xml);
var result = doc.Descendants("attribute")
                .Where(x => x.Attribute("name") != null &&
                            x.Attribute("value") != null)
                .Where(x => x.Attribute("name").Value == "Damage")
                .Select(x => x.Attribute("value").Value)
                .ToArray(); 
```

请注意：
这段代码比较简单，因为它考虑`attribute`了整个文档中的所有节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:19:41.923

```
string val = "";
XmlDocument doc = new XmlDocument();  

doc.Load("file.xml");

XmlNodeList nodes = doc.SelectNodes("/attribute[@name='Damage']");

foreach (XmlNode node in nodes)
{
   {
      val = node.Attributes["value"].Value; 
   }
} 
```

应该管用？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T15:27:35.690

您可以利用 LINQ-TO-XML，但您必须为其提供一个严格的 XML，因此只需手动创建一个根节点，否则您最终会得到`System.Xml.XmlException : There are multiple root elements.`.

```
// raw - your XML
string raw = File.ReadAllText("c:\\test1.xml");

// create root node manually
string xml = "<root>" + raw + "</root>";
var xdoc = XDocument.Parse(xml);       

// contains IEnumerable<string>
// TODO: add null-checks
var damagedValues = xdoc.Descendants("attribute")
                        .Where(e => e.Attribute("name").Value == "Damage")
                        .Select(e => e.Attribute("value").Value); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T15:31:24.097

嗯，那不是 XML 文档，它是一个片段。您需要用根元素包装它。这会起作用：

```
string fragment = File.ReadAllText("file.xml");
var doc = XDocument.Parse("<root>" + fragment  + "</root>");

var values = from element in doc.XPathSelectElements(@"//attribute[@name='Damage']")
             select element.Attribute("value").Value;

values.ToList().ForEach(Console.WriteLine); 
```

# c++ - CButton CDC::SetBkColor 什么都没做？

> ID：10143533
> 
> 赞同：1
> 
> 时间：2012-04-13T15:14:16.640
> 
> 标签：c++, visual-c++, mfc

在子类化 CButton 时，我希望每次按下按钮时按钮的颜色都会增加。但是以下对背景颜色没有任何作用。但是，文本显示“c”以递增。谢谢

```
void CMyButton::OnLButtonDown(UINT nFlags, CPoint point) 
{
    CButton::OnLButtonDown(nFlags, point);
    static int c;

    CString s;
    s.Format("left:  %d", c*50);
    this->SetWindowText(s);

  ////// Neither of the following change the background color   
    //CPaintDC dc(this);
    //dc.SetBkColor(0x0 + c*50);
    CDC *dc= GetDC();
    dc->SetBkColor(0x0 + c*50);

    c++;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:25:40.340

如果你想改变你的按钮的绘制方式，你应该实现`CMyButton::DrawItem`（覆盖`CButton::DrawItem`），并在那里进行绘制。在`OnLButtonDown`中，您只需执行以下操作：

```
c++; 
Invalidate(); 
```

你会想`c`成为的成员`CMyButton`，而不是本地的`OnLButtonDown`。

# javascript - 覆盖backbone.js中的同步功能时如何处理服务器响应

> ID：10143534
> 
> 赞同：2
> 
> 时间：2012-04-13T15:14:18.673
> 
> 标签：javascript, backbone.js

我一直在尝试将我的主干.js 应用程序连接到现有的 Codeigniter API。我查看了 github 上的 todos 示例并从那里开始构建。我正在覆盖 findAll 函数，该函数在“读取”时调用，并试图获取页面并将它们返回给 fetch 函数：

findAll: function() { console.log('synch - findAll');

```
var url = "/folio/get/8";
var data = ''; 

var postmethod = 'GET';

$.ajax({
    url : url,
    type : postmethod,
    async: false,
    data: data,
    success: function(response) 
    {
                    console.debug("response",response);
        console.debug("response.pages", response["pages"]);
        return _.values(response["pages"]);
    }
}); 
```

}

API 返回类似这样的内容 - 通过 console.debug("response", response) 输出：

```
{
    "id": "8",
    "facebook_id": "123456789",
    "title": "title",
    "access_date": null,
    "rating_avg": "0",
    "pages": [
        {
            "id": "6",
            "picture1": {
                "id": "3",
                "tag": "1",
                "tip": "Crazy",
                "facebook_picture_id": "1239102391023"
            },
            "picture2": "28",
            "picture3": "29",
            "picture4": null,
            "picture5": null,
            "picture6": null,
            "caption1": "caption 1",
            "caption2": "caption 2",
            "sequence": "2",
            "folio": "8",
            "ts": "2012-04-10 15:13:23",
            "template": "#page-template-2"
        },
        {
            "id": "5",
            "picture1": "24",
            "picture2": "25",
            "picture3": "26",
            "picture4": null,
            "picture5": null,
            "picture6": null,
            "caption1": "caption 1",
            "caption2": "caption 2",
            "sequence": "4",
            "folio": "8",
            "ts": "2012-04-10 15:13:23",
            "template": "#page-template-2"
        }
    ]
} 
```

但随后 console.debug("response.pages", response["pages"]) 打印出“未定义”。为什么这样做？

提前非常感谢！

- - - - - - - - - - 编辑 - - - - - - - - - - -

感谢您的回答。我可以在模型中进行 ajax 调用的技巧真的很有帮助。问题是我试图将几个页面放入一个 PageList 集合中：

```
$(function(){
  // Page Collection
  // ---------------

  var PageList = Backbone.Collection.extend({

    model: Page,
    localStorage: new Store("wickes-backbone"), // this to get hold of my overwritten localstorage file - it is not actually a localStorage

    nextOrder: function() {
      if (!this.length) return 1;
      return this.last().get('order') + 1;
    },

    comparator: function(page) {
      return page.get('order');
    }

  });

  window.Pages = new PageList;
}); 
```

所以在我正在调用的 appview 初始化函数中

```
Pages.fetch(); 
```

它填充所有页面并更新视图。我不确定如何在模型本身中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T16:48:47.487

Try adding this in your PageList Backbone Collection:

```
 parse: function(response) {
    return response.pages
  } 
```

This does two things:

1.  Uses `.pages` to reference the `pages` array in your response. From what I can tell from your code, backbone is using the overall object response to determine the objects in your collection.
2.  Tells backbone to uses the `pages` array to instantiate the models in your collection. It does this by overriding the native `parse` method and returning what you really want (the pages array)

Doing this *should* get your page objects into one PageList collection. This has worked for me in a similar situation. Hope it helps!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:34:58.103

我认为你的问题是你如何在 $.ajax() 中使用成功函数：

```
$.ajax({
    url : url,
    type : postmethod,
    async: false,
    data: data,
    success: function(response) 
    {
        console.debug("response",response);
        console.debug("response.pages", response["pages"]);
        return _.values(response["pages"]);
    }
}); 
```

如果您在 AJAX 调用上从成功函数返回某些内容，那么它会直接进入 bitbucket。那 _.values() 没有前往任何地方。$.ajax() 调用的结果是一个承诺，仅此而已。该 promise 可以在稍后附加 .done()、.fail() 等，它也可以与 .when() 一起使用以及用于其他目的。但是，它与稍后将调用的成功函数无关。这相当于只是附加到该承诺的 .done() 函数。

我的猜测是，您真正想要的是 AJAX 完成然后操作结果，然后将它们设置在模型上。

但总的来说，试图强制 Backbone 同步并不是它的本意。即使您不打算使用 Backbone 中内置的 Sync 并跳过获取、保存等。它仍然很乐意像这样被调用（请注意，模型只会在更新时更新，就像您正在做拿来）：

```
var myModel = Backbone.Model.extend({
  goGetSomeData : function () {
    var scope = this;

    $.ajax(....).done(
      function (results) {
        scope.set(results);
      }
    );
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T23:14:29.997

好的，所以我找出了这里实际出了什么问题。正如 John Munsch 在第一个答案中提到的，ajax 请求不太正确。这实际上不是骨干网的问题，而是我正在进行的 ajax 调用。首先，我将其更改为 json，其次我在 ajax 调用之外创建了一个变量“pages”，它可以记住响应并将其返回给同步函数：

```
findAll: function() {

    var url = "/folio/get/8";
    var pages;
    var postmethod = 'GET';

    $.ajax({
         type: postmethod,
         url: url,
         async: false,
         beforeSend: function(x) {
          if(x && x.overrideMimeType) {
           x.overrideMimeType("application/j-son;charset=UTF-8");
          }
     },
     dataType: "json",
     success: function(data){
         console.debug("data", data);
         console.debug("data.pages", data.pages);
         pages = data.pages;

     }
    });

    return pages;

}, 
```

非常感谢大家的帮助，我从你的回答中学到了很多！

# r - 列出与绘图功能不兼容的矩阵

> ID：10143537
> 
> 赞同：0
> 
> 时间：2012-04-13T15:14:28.637
> 
> 标签：r, list, for-loop, matrix

我有以下格式的列表对象：

```
> str(TEST.Lmm)
List of 16
 $ NofSimulations: num 2
 $ r             : num [1:511] 0.851 1.276 1.702 2.127 2.553 ...
 $ Ltheo         : num [1:511] 10.7 11.4 14.2 23.7 28.3 ...
 $ Lmm           : num [1:511] 27.6 27.6 29.6 58.2 74.5 ...
 $ Lmm.sims      : num [1:511, 1:2] 0 0 14.5 35.5 35.5 ...
 $ Lmm.maxdev    : num [1:3] 266.5 45 25.4
 $ Lmm.intdev2   : num [1:3] 7563233 333376 53004
 $ Lmm.intdev1   : num [1:3] 46093 11597 4472
 $ lower         : num [1:511] 0 0 0 19.3 19.7 ...
 $ upper         : num [1:511] 0 0 14.5 35.5 35.5 ...
 $ k             : num 1
 $ pmaxdev       : num 0.333
 $ pintdev2      : num 0.333
 $ pintdev1      : num 0.333
 $ typeIerror    : num 1
 $ call          : language mtests.Lmm(NofSimulations = 2, k = 1, data.mpp = Ahx[[7]], permutate = TRUE,      rmin = rmin, rmax = rmax)
 - attr(*, "class")= chr "mtests.Lmm" 
```

我可以使用以下绘图命令毫无问题地绘制这些结果[我正在使用尚未在 CRAN 上发布的未来 R 包的功能]。

```
plot.mtests.Lmm(TEST.Lmm, Plot.zeroline=TRUE, main="", xlim=c(0,rmax), ylim=c(-500,500), xlab=expression(italic(r)), ylab=expression(italic( hat(L)[mm](r)-hat(L)(r))), las=1) #this works fine! 
```

plot 函数相当复杂，但重要的是要知道它调用了上面列表中的大部分元素（例如 $NofSimulations、$r 等）

我进行了一系列分析，结果是以下格式的矩阵：

```
> Greenland.Lmm
               [,1]         [,2]         [,3]         [,4]         [,5]         [,6]        
NofSimulations 2            2            2            2            2            2           
r              Numeric,511  Numeric,512  Numeric,512  Numeric,512  Numeric,512  Numeric,511 
Ltheo          Numeric,511  Numeric,512  Numeric,512  Numeric,512  Numeric,512  Numeric,511 
Lmm            Numeric,511  Numeric,512  Numeric,512  Numeric,512  Numeric,512  Numeric,511 
Lmm.sims       Numeric,1022 Numeric,1024 Numeric,1024 Numeric,1024 Numeric,1024 Numeric,1022
Lmm.maxdev     Numeric,3    Numeric,3    Numeric,3    Numeric,3    Numeric,3    Numeric,3   
Lmm.intdev2    Numeric,3    Numeric,3    Numeric,3    Numeric,3    Numeric,3    Numeric,3   
Lmm.intdev1    Numeric,3    Numeric,3    Numeric,3    Numeric,3    Numeric,3    Numeric,3   
lower          Numeric,511  Numeric,512  Numeric,512  Numeric,512  Numeric,512  Numeric,511 
upper          Numeric,511  Numeric,512  Numeric,512  Numeric,512  Numeric,512  Numeric,511 
k              1            1            1            1            1            1           
pmaxdev        0.3333333    0.3333333    0.3333333    0.3333333    0.3333333    0.6666667   
pintdev2       0.3333333    0.3333333    0.3333333    0.3333333    0.3333333    1           
pintdev1       0.3333333    0.3333333    0.3333333    0.3333333    0.3333333    0.6666667   
typeIerror     1            1            1            1            1            1           
call           Expression   Expression   Expression   Expression   Expression   Expression 
```

我想使用前面介绍的 plot 命令分别绘制每一个。但是，当我执行以下操作时，我收到一条错误消息：

```
# step 1) transform matrix into list
xnew<-lapply(seq_len(ncol(Greenland.Lmm[,1,drop=FALSE])), function(i) Greenland.Lmm[,1,drop=FALSE][,i])

> plot.mtests.Lmm(xnew, Plot.zeroline=TRUE, main="", xlim=c(0,max(Greenland.Lmm[,1]$r)), ylim=c(-500,500), xlab=expression(italic(r)), ylab=expression(italic( hat(L)[mm](r)-hat(L)(r))), las=1)
Plot of r vs L[mm](r)-L(r).
Error in 1:x$NofSimulations : argument of length 0 
```

问题是我无法访问 plot.mtests.Lmm 函数调用的列表中的数据。

```
> xnew$NofSimulations
NULL
#vs
> xnew[[1]]$NofSimulations
[1] 2 
```

所以我的选择是修改 plot.mtests.Lmm 函数（我不希望这样做）或找到解决它的方法......但是如何？我怎样才能获得额外的 [[1]]？此外，我希望将所有这些都放入一个漂亮的小代码中（也许是一个 for 循环？），这样我就不必手动复制每个步骤。我会很感激任何关于什么是最好的方法的想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T21:30:44.440

以下应该`xnew$NofSimulations`在您给出的示例中返回 2（即，仅查看 的第一列`Greenland.Lmm`）。

```
xnew<-unlist(lapply(seq_len(ncol(Greenland.Lmm[,1,drop=FALSE])),
  function(i) Greenland.Lmm[,1,drop=FALSE][,i]), recursive = FALSE) 
```

但是，该示例看起来与您想要做的事情相比已经被驯服了很多。如果您打算按顺序在每一列中绘制数据`Greenland.Lmm`，我建议您创建 xnew，就像您在原始问题中所做的那样

```
xnew<-lapply(seq_len(ncol(Greenland.Lmm)), function(i) Greenland.Lmm[,i]) 
```

并执行以下操作：

```
plot.mtests.Lmm(xnew[[1]], Plot.zeroline=TRUE, main="", 
  xlim=c(0,max(xnew[[1]]$r)), ylim=c(-500,500), 
  xlab=expression(italic(r)), 
  ylab=expression(italic( hat(L)[mm](r)-hat(L)(r))), las=1) 
```

您可以在其中用任何您想要的列号替换`xnew`.

如果您想一举绘制每一列中的数据：

```
lapply(seq_len(ncol(Greenland.Lmm)),function(x){
  xnew<-Greenland.Lmm[,x]
  plot.mtests.Lmm(xnew, Plot.zeroline=TRUE, main="",
    xlim=c(0,max(xnew$r)), 
    ylim=c(-500,500), xlab=expression(italic(r)), 
    ylab=expression(italic( hat(L)[mm](r)-hat(L)(r))), las=1)
  }
) 
```

这些建议能满足您的需求吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:59:45.683

那里有很多代码，所以我可能有点偏离基础，但看起来你可以用来`sapply(xnew, "[[", "NofSimulations")`从列表中获取 NofSimulations 元素。一旦它在一个向量中，你可以尝试绘制？

# python - 有可能在python（2.4）中制作这种装饰器吗？

> ID：10143538
> 
> 赞同：1
> 
> 时间：2012-04-13T15:14:28.410
> 
> 标签：python

我有课窗口。此类具有 onClick 方法，该方法获取在该窗口上单击的控件 id 的参数（我无法更改它的工作方式）：

```
 class Window(SoneBaseWindowClass):

    def onClick(self,controlID):
        print controlID 
```

我想制作装饰器，它将我的方法添加到回调堆栈。而当单击某些控件时，方法 onClick 将调用某些方法。所以：

```
class Window(SoneBaseWindowClass):
    def __init__(self):
        callback_stack = {}

    def onClick(self,controlId):
        callback = self.callback_stack.get(controlID)
        if callback is not None:
            callback()

    # suppose to add decorated method to a callback_stack
    def onclick_decorator(method):
        pass 
```

所以我需要制作装饰器，它将向`callback_stack`. 示例使用。

```
class MyWindow(Window):

    @onclick_decorator(12345)
    def someMethod(self):
        print "Gets called when control with id 12345 clicked" 
```

实际上，问题是我如何才能从`onclick_decorator` Self 获得对类的访问权限，而不是传递给该方法。所以我可以假设它可以访问课程，但无法弄清楚如何。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T16:08:03.440

处理这种情况的方法是让装饰器将装饰方法添加到数据结构（在您的情况下为 CallbackStack） - 但是要将该数据结构附加到类，您需要在创建类时执行一些操作（即已解析） - 因为在解析时，装饰器，如您所说，无权访问实例或类。

在现代 Python（甚至 Python 2）中，有两种方法可以做到这一点：你可以使用一个metclass，或者一个类装饰器。但我不认为类装饰器可用于 Python 2.4 - 所以你需要有一个元类。

这并不复杂 -`__new__`元类上的方法通过解析期间构建的字典传递。您的装饰器所要做的就是使用元类可以找到的属性标记所需的方法 - 并从这些标记构建您的 callback_stack 。call_back 堆栈甚至可以是一个字典：

```
def on_click_decorator(key):
    def real_decorator(func):
        setattr(func, "_callback_to", key)
        return func
    return real_decorator

class Meta(type):
    def __new__(metacls, name, bases, dct):
        callback_stack = {}
        for name, value in dct.items():
            if hasattr(value, "_callback_to"):
                callback_stack[value._callback_to] = key
        dct["callback_stack"] = callback_stack
        # we've done all needed manipulation - no
        # need for the class to be from a special type - so we
        # don't call type.__new__
        return type(name, bases, dct) 
```

现在您可以从您的方法内部调用 `self.callback_stack[controlID]`以检索已注册的函数（您可以将它们作为函数而不是使用上面的代码的方法获取，因此将“self”显式传递给它们）。

# spring - JSF 2、Spring Security 3.x 和 Richfaces 4 在 ajax 请求的会话超时时重定向到登录页面

> ID：10143539
> 
> 赞同：5
> 
> 时间：2012-04-13T15:14:35.717
> 
> 标签：spring, jsf-2, spring-security

这似乎是一个非常普遍的问题。但我找不到任何可行的解决方案。我们正在使用 Richafaces 4、Myfaces 2.0.5 和 Spring security 3.0.X。

在 ajax/non ajax 请求的会话时间，用户应该被重定向到登录页面。在重新登录后，他应该看到之前执行的 ajax/non ajax 操作。

我们没有遇到非 ajax 请求的任何问题。但是对于 ajax 请求，用户不会被重定向到登录页面。

我已关注此链接[https://community.jboss.org/message/729913#729913](https://community.jboss.org/message/729913#729913) 并实施了 servlet 方法。该解决方案在 Firefox 中有效，而不是在 IE 8 中。

即使在会话超时时将其正确重定向到登录页面，也可能存在更多问题。对于先前调用的 ajax 请求，我期待在成功登录时出现 ViewExpiredException。

我想带来 ViewExpiredException，因为这两个问题可能相互关联。

任何解决方案/线索将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T18:57:28.283

由于您使用 Spring Security 3.0.x，因此您可以使用自定义 sessionManagementFilter，如此处[所述](http://wiki.icesoft.org/display/ICE/Spring+Security#SpringSecurity-Step4%3AConfigureYourSpringSecurityredirectStrategy)

com.icesoft.spring.security.JsfRedirectStrategy 类可[在此处获得](http://wiki.icesoft.org/display/ICE/Spring+Security)

如果您使用的是 Spring Security 3.1.x，请进行这些更改

```
 <beans:bean id="sessionManagementFilter" class="org.springframework.security.web.session.SessionManagementFilter">
    <beans:constructor-arg name="securityContextRepository" ref="httpSessionSecurityContextRepository" />
            <!-- this permits redirection to session timeout page from javascript/ajax or http -->
    <beans:property name="invalidSessionStrategy" ref="jsfRedirectStrategy" />
</beans:bean>

<beans:bean id="jsfRedirectStrategy" class="com.icesoft.spring.security.JsfRedirectStrategy">
  <beans:constructor-arg name="invalidSessionUrl" value="/general/logins/sessionExpired.jsf" />
</beans:bean>
<beans:bean id="httpSessionSecurityContextRepository" class="org.springframework.security.web.context.HttpSessionSecurityContextRepository"/> 
```

JSFRedirectStrategy 类的唯一变化是前几行：

```
public class JsfRedirectStrategy implements InvalidSessionStrategy {
protected final Log logger = LogFactory.getLog(getClass()); 
     private String invalidSessionUrl;
private boolean contextRelative;

public JsfRedirectStrategy(String invalidSessionUrl){
    this.invalidSessionUrl=invalidSessionUrl;
}

@Override
public void onInvalidSessionDetected(HttpServletRequest request,
        HttpServletResponse response) throws IOException, ServletException {
    String redirectUrl = calculateRedirectUrl(request.getContextPath(), invalidSessionUrl); 
```

这也适用于 IE8。如果你有兴趣，你也可以看看这个[博客](http://ovaraksin.blogspot.com/2010/10/jsf-ajax-redirect-after-session-timeout.html)，但我从来没有尝试过，因为上面的要容易得多。

仅供参考：如果你不使用 Spring，有很多方法可以做到这一点：Primefaces 在他们的网站上这样做。[链接](http://forum.primefaces.org/viewtopic.php?f=3&t=14316&start=30#p55248) 或者通过导入 Omnifaces jar[链接更简单](http://balusc.blogspot.com/2012/03/full-ajax-exception-handler.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-30T18:46:20.750

我将 Ravi 的答案与[How to set a custom invalid session strategy in Spring Security](https://stackoverflow.com/questions/25809367/how-to-set-a-custom-invalid-session-strategy-in-spring-security)合并。

它修改过滤器而不是创建一个新过滤器。如果您愿意，也可以分成多个班级。

```
 public class JSFRedirectStrategy implements InvalidSessionStrategy,
    BeanPostProcessor {

/**
 * JSF header
 */
private static final String FACES_REQUEST_HEADER = "faces-request";

/**
 * URL
 */
private String invalidSessionUrl;

public void setInvalidSessionUrl(String invalidSessionUrl) {
    this.invalidSessionUrl = invalidSessionUrl;
}

/**
 * {@inheritDoc}
 */
@Override
public void onInvalidSessionDetected(HttpServletRequest request,
        HttpServletResponse response) throws IOException, ServletException {
    String ajaxRedirectXml;
    String requestURI;

    // Force nouvelle session
    request.getSession(true);

    if ("partial/ajax".equals(request.getHeader(FACES_REQUEST_HEADER))) {
        requestURI = request.getContextPath() + invalidSessionUrl;
        requestURI = response.encodeRedirectURL(requestURI);
        ajaxRedirectXml = createAjaxRedirectXml(requestURI);
        response.setContentType("text/xml");
        response.getWriter().write(ajaxRedirectXml);
    } else {
        response.sendRedirect(response
                .encodeRedirectURL(getRequestUrl(request)));
    }
}

/**
 * Obtenir la requete qu'il voulait appeler
 * 
 * @param request
 * @return
 */
private String getRequestUrl(HttpServletRequest request) {
    StringBuffer requestURL;
    String queryString;

    requestURL = request.getRequestURL();
    queryString = request.getQueryString();
    if (!JavaUtil.isNullOrEmpty(queryString))
        requestURL.append("?").append(queryString);
    return requestURL.toString();
}

/**
 * XML redirect
 * 
 * @param redirectUrl
 * @return
 */
private String createAjaxRedirectXml(String redirectUrl) {
    return new StringBuilder()
            .append("<?xml version=\"1.0\" encoding=\"UTF-8\"?>")
            .append("<partial-response><redirect url=\"")
            .append(redirectUrl)
            .append("\"></redirect></partial-response>").toString();
}

@Override
public Object postProcessBeforeInitialization(Object bean, String beanName)
        throws BeansException {
    SessionManagementFilter filter;
    if (bean instanceof SessionManagementFilter) {
        filter = (SessionManagementFilter) bean;
        filter.setInvalidSessionStrategy(this);
    }
    return bean;
}

@Override
public Object postProcessAfterInitialization(Object bean, String beanName)
        throws BeansException {
    return bean;
}}
    <!-- Afin de gerer l'ajax lorsque spring redirige vers la page auth -->
<bean id="jsfRedirectStrategy" class="JSFRedirectStrategy" >
    <property name="invalidSessionUrl" value="/authentification.qc" />
</bean> 
```

# objective-c - 如何以编程方式确定 OS X 中当前活动的应用程序？

> ID：10143540
> 
> 赞同：0
> 
> 时间：2012-04-13T15:14:38.947
> 
> 标签：objective-c, osx-lion

我有一个在后台工作的简单状态栏应用程序。我想知道当前哪个应用程序处于活动状态。

有可能的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T15:21:34.473

查看[`NSRunningApplication`该类及其活动属性](https://developer.apple.com/library/mac/documentation/AppKit/Reference/NSRunningApplication_Class/Reference/Reference.html#//apple_ref/occ/instp/NSRunningApplication/active)（我已为您链接了文档）。您可以查看一系列正在运行的应用程序并找到“活动”的应用程序。

哦，要获得一系列正在运行的应用程序，您可以通过[`[NSWorkspace currentWorkspace] runningApplications]`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSWorkspace_Class/Reference/Reference.html#//apple_ref/occ/instm/NSWorkspace/runningApplications).

希望这可以帮助！

# java - LuaJ (Java) 编译成jar

> ID：10143544
> 
> 赞同：1
> 
> 时间：2012-04-13T15:14:51.800
> 
> 标签：java, jar, lua, luaj

所以我得到了这个加载 .lua 文件的 java 文件。非常基本，如果我尝试在 Eclipse 中运行它，它就可以工作。

现在，当我在可运行的 jar 文件中编译项目时，它根本不会加载。当您双击它时，它只会加载并停止。

我尝试了多个 jar 编译选项，但它似乎不起作用。

```
import org.luaj.vm2.LuaValue;
import org.luaj.vm2.lib.jse.JsePlatform;

public class SampleJseMain {

    public static void main(String[] args) throws Exception {
        String script = "main.lua";

        // create an environment to run in
        LuaValue _G = JsePlatform.standardGlobals();
        _G.get("dofile").call( LuaValue.valueOf(script) );
    }
} 
```

和 Lua 主文件：

```
delay = 100000
while delay > 1 do
  print( 'hello, world' )
  delay = delay - 1
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T13:43:17.220

我猜它找不到你的lua脚本。你的 lua 脚本相对于你的 Jar 在哪里。也许你应该从命令行运行 jar。此外，添加一些诊断打印或其他内容，以便您更好地了解正在发生的事情。

# c# - 如何验证 UPC 或 EAN 代码？

> ID：10143547
> 
> 赞同：26
> 
> 时间：2012-04-13T15:15:11.677
> 
> 标签：c#, .net, barcode, checksum

我需要一个 C# .NET 函数来评估键入或扫描的条形码是否是有效的[全球贸易项目编号](http://en.wikipedia.org/wiki/Global_Trade_Item_Number)（UPC 或 EAN）。

![条码校验位](../Images/857c04feedc8c5aedf5f030fab832dca.png)

条形码编号的最后一位数字是计算机校验位，可确保条形码正确组成。[GTIN 校验位计算器](http://www.gs1.org/barcodes/support/check_digit_calculator)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-13T15:17:50.847

```
public static bool IsValidGtin(string code)
{
    if (code != (new Regex("[^0-9]")).Replace(code, ""))
    {
        // is not numeric
        return false;
    }
    // pad with zeros to lengthen to 14 digits
    switch (code.Length)
    {
        case 8:
            code = "000000" + code;
            break;
        case 12:
            code = "00" + code;
            break;
        case 13:
            code = "0" + code;
            break;
        case 14:
            break;
        default:
            // wrong number of digits
            return false;
    }
    // calculate check digit
    int[] a = new int[13];
    a[0] = int.Parse(code[0].ToString()) * 3;
    a[1] = int.Parse(code[1].ToString());
    a[2] = int.Parse(code[2].ToString()) * 3;
    a[3] = int.Parse(code[3].ToString());
    a[4] = int.Parse(code[4].ToString()) * 3;
    a[5] = int.Parse(code[5].ToString());
    a[6] = int.Parse(code[6].ToString()) * 3;
    a[7] = int.Parse(code[7].ToString());
    a[8] = int.Parse(code[8].ToString()) * 3;
    a[9] = int.Parse(code[9].ToString());
    a[10] = int.Parse(code[10].ToString()) * 3;
    a[11] = int.Parse(code[11].ToString());
    a[12] = int.Parse(code[12].ToString()) * 3;
    int sum = a[0] + a[1] + a[2] + a[3] + a[4] + a[5] + a[6] + a[7] + a[8] + a[9] + a[10] + a[11] + a[12];
    int check = (10 - (sum % 10)) % 10;
    // evaluate check digit
    int last = int.Parse(code[13].ToString());
    return check == last;
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-03-10T17:53:28.850

[GS1 US](http://www.gs1us.org/)在 PDF 文档中发布了 GTIN 的校验位计算算法（删除了不断变化的链接）。

以下代码使用 linq 检查 GTIN 条码的最后一位：GTIN-8、GTIN-12 (UPC)、GTIN-13 (EAN) 和 GTIN-14 (ITF-14)。

```
private static Regex _gtinRegex = new System.Text.RegularExpressions.Regex("^(\\d{8}|\\d{12,14})$");
public static bool IsValidGtin(string code)
{
    if (!(_gtinRegex.IsMatch(code))) return false; // check if all digits and with 8, 12, 13 or 14 digits
    code = code.PadLeft(14, '0'); // stuff zeros at start to garantee 14 digits
    int[] mult = Enumerable.Range(0, 13).Select(i => ((int)(code[i] - '0')) * ((i % 2 == 0) ? 3 : 1)).ToArray(); // STEP 1: without check digit, "Multiply value of each position" by 3 or 1
    int sum = mult.Sum(); // STEP 2: "Add results together to create sum"
    return (10 - (sum % 10)) % 10 == int.Parse(code[13].ToString()); // STEP 3 Equivalent to "Subtract the sum from the nearest equal or higher multiple of ten = CHECK DIGIT"
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2014-01-21T20:10:07.497

上面的解决方案计算校验位并将其与给定的数字进行比较，忽略了它旨在以更简单的方式进行验证的事实。

1.  将所有数字（**包括校验位**）乘以 3 或 1 并求和。
2.  检查总和是否是 10 的倍数

根据卢西亚诺的回答：

```
private static Regex _gtinRegex = new Regex("^(\\d{8}|\\d{12,14})$");
public static bool IsValidGtin(string code)
{
    if (!(_gtinRegex.IsMatch(code))) return false;
    code = code.PadLeft(14, '0');
    int sum = code.Select((c,i) => (c - '0')  * ((i % 2 == 0) ? 3 : 1)).Sum();
    return (sum % 10) == 0;
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-02-24T16:02:57.463

可变长度 EAN

```
 public static bool IsValidEan13(string eanBarcode)
    {
        return IsValidEan(eanBarcode, 13);
    }

    public static bool IsValidEan12(string eanBarcode)
    {
        return IsValidEan(eanBarcode, 12);
    }

    public static bool IsValidEan14(string eanBarcode)
    {
        return IsValidEan(eanBarcode, 14);
    }

    public static bool IsValidEan8(string eanBarcode)
    {
        return IsValidEan(eanBarcode, 8);
    }

    private static bool IsValidEan(string eanBarcode, int length)
    {
        if (eanBarcode.Length != length) return false;
        var allDigits = eanBarcode.Select(c => int.Parse(c.ToString(CultureInfo.InvariantCulture))).ToArray();
        var s = length%2 == 0 ? 3 : 1;
        var s2 = s == 3 ? 1 : 3;
        return allDigits.Last() == (10 - (allDigits.Take(length-1).Select((c, ci) => c*(ci%2 == 0 ? s : s2)).Sum()%10))%10;
    }

    [Test]
    [TestCaseSource("Ean_13_TestCases")]
    public void Check_Ean13_Is_Valid(string ean, bool isValid)
    {
        BlinkBuilder.IsValidEan13(ean).Should().Be(isValid);
    }

    private static IEnumerable<object[]> Ean_13_TestCases()
    {
        yield return new object[] { "9781118143308", true };
        yield return new object[] { "978111814330", false };
        yield return new object[] { "97811181433081", false };
        yield return new object[] { "5017188883399", true };
    }

    [Test]
    [TestCaseSource("Ean_8_TestCases")]
    public void Check_Ean8_Is_Valid(string ean, bool isValid)
    {
        BlinkBuilder.IsValidEan8(ean).Should().Be(isValid);
    }

    private static IEnumerable<object[]> Ean_8_TestCases()
    {
        yield return new object[] { "12345670", true };
        yield return new object[] { "12345679", false };
        yield return new object[] { "55432214", true  };
        yield return new object[] { "55432213", false };
        yield return new object[] { "55432215", false };
    } 
```

**编辑**

我正在为其构建此代码的项目现已启动并运行 - 它是综合条形码数据库和工具集的一部分 - 并包括一个批量条形码验证器（非注册用户批量为 100 个，注册用户为 10,000 个） - [https:// blinked.in/tools/validator](https://blinked.in/tools/validator)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-08-16T12:10:25.487

我找到了这个 Nuget 包：[https ://www.nuget.org/packages/ProductCodeValidator/](https://www.nuget.org/packages/ProductCodeValidator/)

github 中的代码是：[https](https://github.com/ThomasPe/ProductCodeValidator) ://github.com/ThomasPe/ProductCodeValidator 。

以下是如何使用它：

```
using ProductCodeValidator;

bool IsValidEAN(string EAN)
{
    return EanValidator.IsValidEan(testEan));
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-11T22:01:02.013

```
/// <summary>
/// Validates a GTIN (UPC/EAN) using the terminating check digit
/// </summary>
/// <param name="code">the string representing the GTIN</param>
/// <returns>True if the check digit matches, false if the code is not 
/// parsable as a GTIN or the check digit does not match</returns>
public static bool IsValidGtin(string code)
{
    if (string.IsNullOrWhiteSpace(code))
        return false;
    if (code.Length != 8 && code.Length != 12 && code.Length != 13 
        && code.Length != 14)
        // wrong number of digits
        return false;

    int sum = 0;
    for (int i = 0; i < code.Length - 1 /* do not include check char */; i++)
    {
        if (!char.IsNumber(code[i]))
            return false;

        var cchari = (int)char.GetNumericValue(code[i]);
        // even (from the right) characters get multiplied by 3
        // add the length to align right
        if ((code.Length + i) % 2 == 0)
            sum += cchari * 3;
        else
            sum += cchari;
    }

    // validate check char
    char checkChar = code[code.Length - 1];
    if (!char.IsNumber(checkChar))
        return false;

    int checkChari = (int)char.GetNumericValue(checkChar);
    return checkChari == (10 - (sum % 10)) % 10;
} 
```

测试用例：

```
 [TestMethod()]
    public void IsValidGtinTest_Valid()
    {
        string[] valid = new[] {
            "085126880552",
            "0085126880552",
            "00085126880552",
            "0786936226355",
            "0719852136552"
        };
        foreach (var upc in valid)
            Assert.IsTrue(IdentifierUtilities.IsValidGtin(upc), upc);
    }

    [TestMethod()]
    public void IsValidGtinTest_Invalid()
    {
        string[] invalid = new[] {
            "0058126880552",
            "58126880552",
            "0786936223655",
            "0719853136552",
            "",
            "00",
            null,
            "123456789123456789123456789",
            "1111111111111"
        };
        foreach (var upc in invalid)
            Assert.IsFalse(IdentifierUtilities.IsValidGtin(upc), upc);
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-02-14T16:33:54.933

我有一个类似的问题，谷歌把我带到了这个页面。我需要为标签生成程序计算大量条形码的校验位。我首先从上面 Luciano Carvalho 的答案的变体开始，但我对将字符串转换为 char 到 int 有点好奇。我怀疑我可能能够提高一点性能。

请注意，验证是在此函数之外进行的。由于我正在生成大量条形码，因此此功能更多地是为了速度而构建的。

```
int CalculateCheckDigit(ulong label)
{
    int sum = 0;
    bool isEven=true;
    while(label>0)
    {
        if(isEven)
            sum += (int)(label % 10) * 3;
        else
            sum += (int)(label % 10) * 1;
        isEven = !isEven;
        label /= 10;
    }

    return (10 - (sum % 10)) % 10;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-08-29T13:09:27.850

```
 private bool ValidateCheckDigit()
    {

        Int32 _num = 0;
        Int32 _checkdigit = 0;

        for (int i = 0; i < CurrentUpcInfo.UpcCode.Length; i++)
        {
            if (i % 2 == 0)
            {
                _num += (3 * Convert.ToInt32(CurrentUpcInfo.UpcCode.Substring(i, 1)));
            }
            else
            {
                _num += Convert.ToInt32(CurrentUpcInfo.UpcCode.Substring(i, 1));
            }

        }
        _num = Math.Abs(_num) + 10;  // in case num is a zero
        _checkdigit = (10 - (_num % 10)) % 10;

        if (Convert.ToInt32(CurrentUpcInfo.Checkdigit) == _checkdigit)
            return true;

        return false;

    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-09T23:16:23.740

如果有人需要 AlexDev 的答案的 javascript 版本，就到这里。我注意到 AlexDev 的答案也适用于 ITF 条形码，而其他一些答案则不适用。

```
function isValidGtin(barcode) {
    var code = "00000" + barcode;
    code = code.substring(code.length - 14);
    var sum = 0;
    for (var i = 0; i < code.length; i++) {
        sum += code[i] * ((i % 2 == 0) ? 3 : 1);
    }
    return (sum % 10) == 0;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-07-14T11:02:42.400

我知道问题是在 .net/C# 的上下文中。尽管如此，我还是在此页面上寻求相同问题的答案，但在 Groovy 上下文中。

由于我实际上成功地使用了此页面上的信息来解决我自己的问题，所以我想我会分享结果。
尤其是 AlexDev、Zack Peterson 和 Mitch 的回答对我很有帮助。

```
/*
Check digit calculation is based on modulus 10 with digits in an odd
position (from right to left) being weighted 1 and even position digits
being weighted 3\. 
For further information on EAN-13 see:
Wikipedia - European Article Number: http://en.wikipedia.org/wiki/International_Article_Number_%28EAN%29
Implementation based on http://stackoverflow.com/questions/10143547/how-do-i-validate-a-upc-or-ean-code
Tests can be found there too
*/
boolean isValidEan(String code){
  returnValue = false
  if (code ==~ /\d{8}|\d{12,14}/){ //Matches if String code contains 8, 12, 13 or 14 digits
    assert [8,12,13,14].contains(code.size())
    code = code.padLeft(14, '0')
    assert code.size() == 14
    int sum = 0
    code.eachWithIndex{ c, i ->
      sum += c.toInteger() * ((i % 2 == 0) ? 3 : 1)
    }
    returnValue = sum % 10 == 0
  }
  return returnValue
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-01-09T20:18:01.777

我编写了这个 Python 代码来快速简洁地验证 UPC 代码：

```
def upc_validate(upc):
    # check if upc is exactly 12 digits
    upc = str(upc)
    if len(upc) != 12 or len(list(filter(lambda x: 48 <= ord(x) <= 57, upc))) != 12:
        return False

    # validate CRC / check digit (sum of digits is a product of 10 after multiplying each odd digit by CRC)
    digits = list(map(int, upc))
    crc = digits[-1]
    total = sum([digit if i & 1 else digit * crc for i, digit in enumerate(digits)])
    return total % 10 == 0 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-10-19T16:52:45.573

基于卢西亚诺的回答。

我删除了 Linq 依赖项，因为我在 Java 中也需要它。将填充删除为 14 位，因此可用于计算较长 ITF 条形码的校验位。

长度不等的代码由为长度不等的代码`(i + code.Length % 2)`制作`31313`图案`13131`的 处理。它避免了创建对象，并且需要 134 毫秒（在我的 PC 上）来计算所有 EAN-8 代码的校验位。

我知道这个问题是关于一种`IsValidEan()`方法的，但是如果你有一个包含方法的库，你可能无论如何都需要这个。`IsValidEan()`应该在长度和其他检查之后调用它进行校验位验证。

```
/// <summary>
/// Calculate check digit for UPC-A, EAN-13, ITF-14 (or any ITF)
/// </summary>
/// <param name="code">This should include the check digit (append a fake check digit if needed)</param>
/// <returns></returns>
public static char CalculateCheckDigit(string code)
{
    // Don't include check digit in the sum (< code.Length - 1)
    int sum = 0;
    for (int i = 0; i < code.Length - 1; i++)
        sum += (code[i] - '0') * (((i + code.Length % 2) % 2 == 0) ? 3 : 1);

    return (char)((10 - (sum % 10)) % 10 + '0');
} 
```

爪哇版：

```
public static char CalculateCheckDigit(String code) {
    int sum = 0;
    for(int i = 0; i < code.length() - 1; i++)
        sum += ((int)code.charAt(i) - (int)'0') * (((i + code.length() % 2) % 2 == 0) ? 3 : 1);

    return (char)((10 - (sum % 10)) % 10 + (int)'0');
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-01-20T18:09:53.613

def check_digit():

```
 users_gtin=raw_input("enter first seven digits of gtin ")

        gtin_seven_digits=unicode(users_gtin)

        if len(gtin_seven_digits) == 7 and gtin_seven_digits.isnumeric():
            ck = ((((int(gtin_seven_digits[0])) + (int(gtin_seven_digits[2])) + (int(gtin_seven_digits[4])) + (int(gtin_seven_digits[6])))*3) + ((int(gtin_seven_digits[1])) + (int(gtin_seven_digits[3])) + (int(gtin_seven_digits[5])))) %10
            final_ck = 10-ck

            if final_ck == 10:
                final_ck=0
                print "Is your check digit",final_ck,"?"

            else:
                print "Is your check digit",final_ck,"?"

        else:
            print "please try typing an seven digit number"
            check_digit()

        choice=raw_input("enter (a) to restart or press anything other than the letter  a  to end this program <<<< ").upper()

        if choice == "A":
            check_digit() 
```

检查数字（）

# 可能不是最有效的，但希望它有所帮助..

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-03-07T12:24:46.300

我还需要验证大量的 EAN-13，并在搜索时发现了这个问题。我不喜欢最受欢迎的答案的样子。处理大型数据集时可能的字符串分配过多。与仅验证每个字符是否为数字相比，正则表达式也很慢。

在我的旧笔记本电脑上运行我的 8851 个 EAN-13 数字数据集上最受好评的问题中使用的验证逻辑需要 47 毫秒，而我自己的实现只需要 2 毫秒。这里的字符串分配也少得多。

```
private static bool IsValidGtin(ReadOnlySpan<char> input, byte length)
{
    if (input.Length != length)
    {
        return false;
    }

    if (!char.IsDigit(input[^1]))
    {
        return false;
    }

    var sum = 0d;
    var multiplyByThree = true;
    var inputWithoutCheckDigit = input[..^1];
    for (var i = inputWithoutCheckDigit.Length - 1; i >= 0; i--)
    {
        var currentChar = inputWithoutCheckDigit[i];
        if (!char.IsDigit(currentChar))
        {
            return false;
        }

        var value = char.GetNumericValue(currentChar);
        if (multiplyByThree)
        {
            sum += value * 3;
        }
        else
        {
            sum += value;
        }

        multiplyByThree = !multiplyByThree;
    }

    var checkDigit = char.GetNumericValue(input[^1]);

    return (sum + checkDigit) % 10 == 0;

} 
```

如果需要，我[在这里](https://nnss.eu/2021/03/algorithm-for-effecient-validation-of-ean-13-and-other-gtin-numbers/)写了更多关于它的细节

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-03-26T17:02:40.257

我今天花了一些时间来完全支持 GTIN-8、GTIN-12、GTIN-13 和 GTIN-14 的校验和计算。大多数算法示例仅支持 GTIN-13 或丑陋。

那这个呢？

```
public static char CalculateCheckSumDigit(string code)
{
   // https://www.gs1.org/services/how-calculate-check-digit-manually
   var reversed = code.Reverse().Skip(1);

   int sum = 0;
   int multiplier = 3;
   foreach(char c in reversed)
   {
       if (multiplier == 3)
       {
           sum += (c - 0x30) * multiplier;
           multiplier = 1;
       }
       else
       {
           sum += (c - 0x30) * multiplier;
           multiplier = 3;
       }
   }

   int closestTenth = (sum + 9) / 10 * 10;

   return (char)((closestTenth - sum) + 0x30);
} 
```

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2020-10-20T12:45:30.160

EAN8、EAN12、EAN13、EAN14 在快船/港口

```
function DigitEan(cCodigo)
    local cCode := AllTrim(cCodigo)
    local nLen := Len(cCode)
    local cc := 0
    local i := 0

    for i:=1 to nLen-1
        cc+=(asc(substr(cCode,nLen-i,1))-48)*iif(i%2==0,1,3)
    next

return ( (10-(cc%10))%10 ) 
```

* * *

## 回答 #17

> 赞同：-3
> 
> 时间：2012-07-18T07:02:23.297

```
private void button1_Click(object sender, EventArgs e)
{
    string code = textBox1.Text;
    string sBarcode = string.Empty;
    sBarcode = IsValidGtin(code);
    lblBarCode.Text = sBarcode;
}
public static string IsValidGtin(string code)
{

    //if (code != (new Regex("[^0-9]")).Replace(code, ""))
    //{
    //    // is not numeric
    //    return false;
    //}
    // pad with zeros to lengthen to 14 digits
    switch (code.Length)
    {
        case 2:
            code = code + "000000000";
            break;
        case 3:
            code = code + "00000000";
            break;
        case 4:
            code = code + "0000000";
            break;
        case 5:
            code = code + "000000";
            break;
        case 6:
            code = code + "00000";
            break;
        case 7:
            code = code + "0000";
            break;
        case 8:
            code = code + "000";
            break;
        case 9:
            code = code + "00";
            break;
        case 10:
            code = code + "0";
            break;
        case 11:
            break;
        case 12:
            code = code.Substring(0, 11);
            break;
        //default:
        // wrong number of digits
        //  return false;
    }
    // calculate check digit
    int[] a = new int[12];
    a[0] = int.Parse(code[0].ToString()) * 3;
    a[1] = int.Parse(code[1].ToString());
    a[2] = int.Parse(code[2].ToString()) * 3;
    a[3] = int.Parse(code[3].ToString());
    a[4] = int.Parse(code[4].ToString()) * 3;
    a[5] = int.Parse(code[5].ToString());
    a[6] = int.Parse(code[6].ToString()) * 3;
    a[7] = int.Parse(code[7].ToString());
    a[8] = int.Parse(code[8].ToString()) * 3;
    a[9] = int.Parse(code[9].ToString());
    a[10] = int.Parse(code[10].ToString()) * 3;
    //a[11] = int.Parse(code[11].ToString());
    //a[12] = int.Parse(code[12].ToString()) * 3;
    int sum = a[0] + a[1] + a[2] + a[3] + a[4] + a[5] + a[6] + a[7] + a[8] + a[9] + a[10];
    string check = Convert.ToString((10 - (sum % 10)));
    // evaluate check digit
    // int last = int.Parse(code[13].ToString());
    // return check == last;
    code = code + check;
    return code;
} 
```

# c - strcpy() 中的分段错误

> ID：10143549
> 
> 赞同：2
> 
> 时间：2012-04-13T15:15:19.500
> 
> 标签：c, segmentation-fault, strcpy

我有这样的基本结构

```
typedef struct struck {
    char* id;
    char* mat;
    int value;
    char* place;
} *Truck; 
```

像这样的函数会创建该结构的新“实例”：

```
Truck CTruck(char* id, char* mat, int value, char* place) {
    Truck nT = (Truck) malloc(sizeof (Truck));
    nT->value = value;
    strcpy(nT->id, id);
    strcpy(nT->mat, mat);
    strcpy(nT->place, place);
    return nT;
} 
```

我在第一个中遇到错误`strcpy`。它编译没有问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-13T15:16:59.920

您的 typedef 定义`Truck`为 a `struct struck *`，即指针。所以它的大小将`4`取决于`8`架构而不是结构的大小

用于`sizeof(*Truck)`获取结构的实际大小。

您还需要为字符分配内存。最简单的方法是使用`strdup()`.

```
Truck CTruck(const char* id, const char* mat, int value, const char* place) {
    Truck nT = malloc(sizeof (*Truck));
    nT->value = value;
    nT->id = strdup(id);
    nT->mat = strdup(mat);
    nT->place = strdup(place);
    return nT;
} 
```

* * *

但是，我建议更改您的 typedef，使其成为结构的别名，而不是指向它的指针：

```
typedef struct {
    char* id;
    char* mat;
    int value;
    char* place;
} Truck; 
```

然后在你的函数中使用这个：

```
Truck *nT = malloc(sizeof(Truck)); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-13T15:16:53.963

`nT->id`只是一个指针。需要`malloc`将字符串复制到内存中。其他人也一样。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-13T15:19:00.007

你的用法`sizeof`不正确。通常，参数 to`malloc()`需要是“返回的指针指向的大小”。换句话说，您需要`sizeof *nT`. 看看这也消除了重复类型名称 ( `Truck`) 吗？

此外，在 C 中，您[不需要转换 ; 的返回值`malloc()`](https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc/605858#605858)。它没有任何作用，可以隐藏实际错误，并使代码更难阅读。

正如其他人指出的那样，您也没有为任何字符串数据分配空间，您所拥有的只是结构中的指针。

# c++ - 如何对齐人脸图像c ++ opencv

> ID：10143555
> 
> 赞同：18
> 
> 时间：2012-04-13T15:15:38.470
> 
> 标签：c++, opencv, face-detection, face-recognition

我正在开发一个用于面部认证的 C++ 应用程序。首先，我必须检测人脸并对图像进行预处理。

1.  对于人脸检测，我使用了 HaarCascadeClassifier。问题是这个工具或这个算法给了我一个面部区域，该区域由一个有点大的矩形检测到，该矩形覆盖了头发和一些背景。有没有办法改变这个矩形的尺寸？我使用了“frontalfacecascaadclassifier.xml”。
2.  对于面部预处理，我想完全像[这种技术](http://www.bytefish.de/blog/aligning_face_images)一样进行面部对齐。我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-15T06:05:32.313

在给定图像中找到眼睛的准确位置绝非易事。用于在 OpenCV 中寻找眼睛的 Haar 级联会产生太多的误报而无用，而且这种方法对图像旋转不具有鲁棒性（虽然它可能会补偿轻微的旋转，但我不知道训练图像）。如果我是你，我会在[http://scholar.google.com](http://scholar.google.com)上进行广度优先搜索，以查找该研究领域的相关论文。

您需要一个强大的头部姿势估计来对齐面部图像。我自己做了一些研究，我认为在这里共享算法和代码很有用。我见过的最有趣的方法是：

*   [Gary B. Huang](http://www.janelia.org/people/scientist/gary-huang)、[Vidit Jain](http://vis-www.cs.umass.edu/~vidit/)和[Erik Learned-Miller](http://www.cs.umass.edu/~elm/)。*复杂图像的无监督联合对齐。*计算机视觉国际会议 (ICCV), 2007\. [(项目页面)](http://vis-www.cs.umass.edu/congeal_complex.html) , [(PDF Online available)](http://vis-www.cs.umass.edu/congeal_complex.html) , [(Source code)](https://bitbucket.org/gbhuang/congealreal)

*   [X.朱](http://www.ics.uci.edu/~xzhu)，[D.拉马南](http://www.ics.uci.edu/~dramanan)。野生计算机视觉和模式识别 (CVPR)*中的人脸检测、姿势估计和地标定位，罗德岛普罗维登斯，2012 年 6 月。* [（项目页面）](http://www.ics.uci.edu/~xzhu/face/)，[（PDF 在线可用）](http://www.ics.uci.edu/~xzhu/face/)，[（源代码）](https://github.com/wg-perception/PartsBasedDetector)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-13T15:36:41.387

然后你不能使用另一个 Haar 分类器来找到每只眼睛（眼睛很容易找到）然后假设这个人有两只眼睛，我们定义一个“水平”的脸来表示眼睛是水平的。

只需测量两只眼睛之间的角度并将图像旋转该角度即可。

```
angle = atan ( eye1.Y - eye2.Y ) / (eye1.X - eye2.X ) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-11T07:05:06.240

我在 Wild 项目页面的 Labeled Faces 中尝试了以下面部对齐代码。它工作得非常好，不需要检测面部特征点。C++ 代码可从以下网址下载：http: [//vis-www.cs.umass.edu/faceAlignment/](http://vis-www.cs.umass.edu/faceAlignment/)

如果您仍然希望找到面部关键点，我发现 Viola-Jones 检测器不是很健壮和准确。我个人推荐使用 Flandmark 人脸关键点检测器：[http](http://cmp.felk.cvut.cz/~uricamic/flandmark/) ://cmp.felk.cvut.cz/~uricamic/flandmark/ ，它更加健壮和准确。C 代码可以从上面的站点下载。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-19T13:13:38.420

最**先进**的面部对齐方法必须是这样的：

[**有监督的下降方法及其在人脸对齐中的应用 X. Xiong 和 F. De la Torre 在 CVPR 2013**](http://www.ri.cmu.edu/pub_files/2013/5/main.pdf)

它非常快速和有效。您可以查看他们的项目网站[IntraFace](http://www.humansensing.cs.cmu.edu/intraface/)。

他们提供了一个易于使用的软件。***但是，***核心部分代码，即**监督下降法（SDM）**并***没有***发布，它只是简单的线性回归，可以很容易地实现。

这里有一个演示它可以处理倾斜的脸（为了隐私问题，添加模糊并注意左上角的轴）： [https ://drive.google.com/file/d/0BztytuqPViMoTG9QaEpZWi1NMGc/edit ?usp=分享](https://drive.google.com/file/d/0BztytuqPViMoTG9QaEpZWi1NMGc/edit?usp=sharing)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-21T13:42:51.227

检测未对齐的人脸会使人脸识别变得困难。有时您想修复对齐，有时排除未正确对齐的那些就足够了（例如，如果您正在检测视频流中的人脸）。我采用了后一种方法并训练了一个特殊的 Haar Cascade，以仅检测正确对齐、光线充足的人脸。详细信息：[http](http://rwoodley.org/?p=417) ://rwoodley.org/?p=417 。

如果您使用我的级联，请告诉我它是如何为您工作的。我很好奇其他人会得到什么结果。它满足了我的需求。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-02-21T17:32:56.303

我在这里使用 OpenCV 和 DLib 实现了它：[https ://github.com/ManuBN786/Face-Alignment-using-Dlib-OpenCV](https://github.com/ManuBN786/Face-Alignment-using-Dlib-OpenCV)

任何倾斜的面都可以使用我的代码对齐。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-16T07:19:18.023

看看 CSIRO 人脸分析 SDK（[网站和演示](http://face.ci2cv.net/)，[源代码](https://github.com/ci2cv/face-analysis-sdk)）软件，它可以进行人脸对齐，跟踪 66 个基准点。它快速且非常准确。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-16T12:44:22.557

在搜索了一整天的算法来实现这一点之后，我发现了 Hemlata 等人的“[通过查找面部特征和倾斜面的倾斜角度进行人脸检测”。](http://www.ijcsi.org/papers/IJCSI-10-2-1-472-479.pdf)从 Google 切换到 DuckDuckGo 后。它支持以大于 45 度的角度倾斜的面。

至于如何在代码中实现，这是我目前正在研究的另一个问题，但至少这是一个起点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-06-04T02:47:18.127

对于人脸认证，可以使用[dlib](https://github.com/davisking/dlib)或者[face_recognition](https://github.com/ageitgey/face_recognition)来做，比现在的 opencv 非常方便和准确。

至于 dlib，人脸对齐可以在这里找到（C++ 代码）[http://dlib.net/face_alignment.py.html](http://dlib.net/face_alignment.py.html)

或在这里（python代码）[https://www.pyimagesearch.com/2017/05/22/face-alignment-with-opencv-and-python/](https://www.pyimagesearch.com/2017/05/22/face-alignment-with-opencv-and-python/)。

算法论文名为[Face Alignment at 3000 FPS via Regressing Local Binary Features](http://7xrqgw.com1.z0.glb.clouddn.com/3000fps.pdf)由 dlib 实现。

# c# - C#锁（mylocker）不起作用

> ID：10143557
> 
> 赞同：15
> 
> 时间：2012-04-13T15:15:39.983
> 
> 标签：c#, multithreading, visual-studio-2010, locking

我有很多 Web 服务调用（异步），在回调中，我会将结果绘制到 Excel。我想同步绘图方法。所以我使用以下，但是，从我在 Visual Studio 中追踪，每次，lock(locker) 都是成功的，并且有很多线程在运行 clearcommentIfany，plot。我无法弄清楚为什么这没有按预期工作！谢谢

```
private readonly object locker = new object();

void ProcessPlot()
{
    lock (locker)
    {
        Debug.WriteLine("currentThreadID: " + Thread.CurrentThread.ManagedThreadId);
        //Helper.Dispatcher.Invoke(new AddClearCommentDelegate(ClearCommentIfAny));
        ClearCommentIfAny();

        if (Response.status != Status.COMPLETE)
        {
            ErrorMessage = ManipulateStatusMsg(Response);
            //Helper.Dispatcher.Invoke(new AddClearCommentDelegate(AddCommentToCell));
            AddCommentToCell();
        }
        else // COMPLETE
        {
            // TODO: Convert this into factory pattern
            Debug.WriteLine("ReportBuilder.Dispatcher's address " + Helper.GetAddress(Helper.Dispatcher));
            //Helper.Dispatcher.Invoke(new PlotDelegate(Plot), Response);
            Plot(Response);
        }               
    } 
}

public void DataRequestJobFinished(DataRequestResponse response)
{
    try
    {
        if (Request.IsRequestCancelled)
        {
            Request.FormulaCell.Dispose();
            return;
        }

        Response = response;

        //if (response.status != Status.COMPLETE)
        //{
        //    ErrorMessage = ManipulateStatusMsg(response);
        //}
        //else // COMPLETE
        //{
        //    // TODO: Convert this into factory pattern
        //    PlotDelegate plotDelegate = Plot;
        //    Debug.WriteLine("ReportBuilder.Dispatcher's address " + Helper.GetAddress(Helper.Dispatcher));
        //    Helper.Dispatcher.Invoke(plotDelegate, response);
        //    //Plot(response);                 
        //}
        var t = new Thread(ProcessPlot);
        t.Start();
        //ProcessPlot();
    }
    catch (Exception e)
    {
        ErrorMessage = e.Message;
        MIMICShared.Helper.LogError(e);
    }
    finally
    {
        //TODO: PutReportBuilderInQueue(this);
        ReadyForPlot = true;
        //Request.FormulaCell.Dispose(); move this after plot
        UnityContainer.Resolve<IEventAggregator>().GetEvent<DataRefreshEvent>().Publish(ID);
    }
} 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-04-13T15:17:42.220

我怀疑您的问题是您的锁是实例成员而不是静态（类型级别）成员。

假设每个线程都有自己的包含类的实例，那么它也会有自己的储物柜实例——这不是你想要的。

试试这个声明：

```
private static readonly object locker = new object(); 
```

包含 static 关键字现在使该对象实例存在于类型级别，即在您的类的所有实例之间共享。

# android - 在android中调用另一个活动时如何提供翻转动画

> ID：10143560
> 
> 赞同：2
> 
> 时间：2012-04-13T15:15:48.830
> 
> 标签：android, flip

我想用翻转动画加载活动。我已经看过 api 演示，但还没有澄清如何做到这一点。所以请大家给我建议。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T05:48:52.333

添加翻转动画 加载活动时。首先，您应该将动画添加到资源“anim”文件夹。动画应该是翻转和翻转。在调用意图后，您应该在 java 文件中添加这段代码。

```
(this).overridePendingTransition(R.anim.incoming, R.anim.outgoing); 
```

这将帮助您解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-21T20:43:59.867

上面的答案是正确的，但是您仍然需要过渡 xml 文件。我在我的博客上发布了完整的片段，所以在那里查看 -[在两个活动之间翻转](http://quodev.wordpress.com/2013/12/21/flip-between-two-activities/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-27T10:59:14.453

您可以使用这些 xml 文件获得有效且非常容易实现的效果。

**旋转输出.xml**

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<scale
    android:duration="300"
    android:fromXScale="1.0"
    android:fromYScale="1.0"
    android:interpolator="@android:anim/accelerate_decelerate_interpolator"
    android:pivotX="50%"
    android:pivotY="50%"
    android:toXScale="0.0"
    android:toYScale="0.90" />

<alpha
    android:duration="1"
    android:fromAlpha="1.0"
    android:startOffset="500"
    android:toAlpha="0.0" /> 
```

**旋转输入.xml**

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<scale
    android:duration="200"
    android:fromXScale="0.0"
    android:fromYScale="0.90"
    android:interpolator="@android:anim/accelerate_decelerate_interpolator"
    android:pivotX="50%"
    android:pivotY="50%"
    android:startOffset="500"
    android:toXScale="1.0"
    android:toYScale="1.0" />

<alpha
    android:duration="1"
    android:fromAlpha="0.0"
    android:startOffset="500"
    android:toAlpha="1.0" /> 
```

然后在 startActivity() 或 finish() 之后的代码中覆盖转换：

```
overridePendingTransition(R.anim.rotate_in, R.anim.rotate_out); 
```

# mysql - 使用 IN() 子句优化查询

> ID：10143568
> 
> 赞同：2
> 
> 时间：2012-04-13T15:16:34.163
> 
> 标签：mysql

阅读[这篇 wiki 文章](http://forge.mysql.com/wiki/Top10SQLPerformanceTips)，我发现如果在 MySQL 数据库中使用带有索引列的 IN() 子句，则 SELECT 性能会被杀死。我的问题是，我怎样才能重写我的查询，以便它不会使用任何 IN() 子句，同时仍保持其功能？

我的查询是：

```
SELECT 
    `Route`.`route_id`, `Route`.`order`, `Route2`.`order` 
FROM 
    `routes` AS `Route` 
INNER JOIN 
    `routes` AS `Route2` 
ON `Route`.`route_id` = `Route2`.`route_id` 
WHERE 
    `Route`.`station_line_id` IN ([10 values]) AND 
    `Route2`.`station_line_id` IN ([10 values]) AND 
    `Route`.`order` <= `Route2`.`order` 
GROUP BY `
    `Route`.`station_line_id`, `Route2`.`station_line_id`, (`Route2`.`order` - `Route`.`order`) 
```

并且我已经索引了所有列（route_id、station_line_id、station_id 和 line_id），其中 id 列是主键（该表在生成后只是只读的，所以不用担心索引所有内容）。`[10 values]`IN() 子句中的 以逗号分隔，例如：`IN(1, 2, ..., 10)`.

基本上，我自己加入表路由表并将结果分组以获得所需的记录。其他联接用于检索关联数据。

性能方面，使用 InnoDB 存储引擎，我在 > 30 秒内执行了类似的查询。使用 MyISAM，我得到 >5 秒。但我相信可以更快地获取结果。我的表中有大约 450 万条记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:30:49.377

您将在使用“哈希索引”的此类查询中获得最佳性能。“标准”索引是 B+ 树，它允许您在 log(n) 时间内查找条目，其中 n 是表中的行数。它们还保持排序顺序，因此您可以有效地执行类似的查询`... WHERE station_line_id > 14`，这就是您要在`Order`列上使用的内容。

但是，在您的情况下，使用`IN`子句，您只是在寻找等价性。在这种情况下，B+ 树将不得不单独查找所有 m 个“[10 个值]”，这将花费您 m * log(n) 时间，这显然需要 5-30 秒。

哈希索引用于在恒定的时间内（非常快）查找等效条目，这不依赖于（理论上）表中的行数——即使在大表上也总是非常快。哈希索引的缺点是您不能使用它来执行类似`<`or的查询`>`，但它在等价查询中是最快的，例如您在 in`IN`子句中执行的查询`station_line_id`。

**编辑：**特别是对于 MySQL，不幸的是，他们在任何流行的数据库引擎上都不支持 HASH 索引。如果您能够使用 MEMORY 或 HEAP 引擎，那么您可以使用 HASH 索引——无论如何，将所有内容都放在内存中可能会大大提高性能。值得一试。

# wpf - wpf 多线程套接字设计

> ID：10143571
> 
> 赞同：0
> 
> 时间：2012-04-13T15:16:50.963
> 
> 标签：wpf, sockets

我有一个 wpf 应用程序，它有多个对各种主机开放的套接字。主机会间歇性地发送数据包，我有时必须向主机发送数据包。我有应用程序工作，其中套接字线程将调用调度到 ui 线程以显示数据。该应用程序正在发展到它将拥有多个 UI“小部件/控件”，其中多个小部件可以显示来自单个套接字的数据（不同的渲染）。在 UI 线程上存在一些可观察的集合会很好。并且套接字将弱事件发送到 UI 线程。ui 线程更新集合，瞧，小部件更新。要从 UI 发送到套接字，也许有一个同步访问的流？

有人对使它成为可维护应用程序的设计有什么好的建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:33:56.043

[MVVM 模式](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)适用于 UI 和较低级别逻辑之间的接口。有很多关于如何开始使用 MVVM 的教程和示例（请参阅[这篇文章](https://stackoverflow.com/questions/1405739/mvvm-tutorial-from-start-to-finish)）。此外，还开发了一些框架来帮助您采用 MVVM 模式，例如[MVVMLight](http://mvvmlight.codeplex.com/)。

快速概述将是这样的：

1.  您的视图向您的用户显示 UI
2.  View 绑定到 ViewModel，后者为显示准备数据并相应地编组线程
3.  ViewModel 与您的模型交互，模型存储您的支持数据并管理您的套接字

# jakarta-ee - 不同的 bean 作用域如何在服务器上工作？

> ID：10143577
> 
> 赞同：7
> 
> 时间：2012-04-13T15:17:01.783
> 
> 标签：jakarta-ee, cdi

我想知道在 CDI ( 和 ) 中应用不同的 bean 范围是如何`@ApplicationScoped`工作`@SessionScoped`的`@RequestScoped`。我了解生命周期，但是这些存储在容器中的什么位置？我在 JSF bean 上使用这些注释。

这些 bean 是如何存储在服务器上的，服务器如何能够知道哪些 bean 属于谁。

例如是一个bean，它有一个`@SessionScoped`存储在`HTTPSession`幕后的对象？bean 是否`@ApplicationScoped`存储在地图实例变量中`ServletContext`？如果是这样，那么线程安全性如何。我想我误解了它，但如果有人能告诉我会发生什么，它们的存储位置（不同的范围），服务器如何能够知道哪些 bean 属于谁......就像还有其他 id （不仅是会话 ID）？

顺便说一句，我使用 Java EE 6 所有参考实现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T17:07:12.567

> 例如，在幕后的 HTTPSession 对象中存储了一个 @SessionScoped 的 bean？带有@ApplicationScoped 的bean 是否存储在ServletContext 的映射实例变量中？

对于 web 层，确实会发生这种情况。如果 bean 已被实例化，您通常可以通过手动迭代所述映射中的所有对象来找到它。

`@RequestScoped`虽然是一件特别的事情。在 Web 层中，这对应于请求属性映射，但此范围也适用于对远程会话 bean 或处理消息的消息驱动 bean 的调用。在这种情况下，没有 http 请求，因此没有请求属性映射。很可能这些存储在“其他地方”，可能在由 bean 代理设置和取消设置的 TLS（线程本地存储）中。

> 如果是这样，那么线程安全性如何。

应用程序和会话范围的 bean 本身根本不是线程安全的。**您**必须注意线程安全，例如通过使用线程安全数据结构、同步关键字或本质上是线程安全的 bean 类型（如 @Stateful 注释 bean）。

# python - 子类化双端队列时如何设置maxlen

> ID：10143578
> 
> 赞同：1
> 
> 时间：2012-04-13T15:17:04.387
> 
> 标签：python, subclass, deque

我正在尝试对双端队列进行子类化，但无法弄清楚如何设置 maxlen。

有`__maxlen__`吗？

编辑： - 以下是“坏”蟒蛇吗？

```
from collections import deque

class MinMax(deque):
    def __init__(self):
        deque.__init__(self, maxlen=2)

mm = MinMax() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:35:41.300

您应该`super()`正确调用构造函数

```
class dequePlus(collections.deque):
    def __init__(self, iterable):
        super(dequePlus, self).__init__(iterable, 100) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:27:49.840

调用超类构造函数：

```
class dequePlus(collections.deque):
    def __init__(self, iterable):
        collections.deque.__init__(self, iterable, 100) 
```

# cvs - 我可以使用 cvs 注释文件进行 cvs 提交吗？

> ID：10143589
> 
> 赞同：0
> 
> 时间：2012-04-13T15:17:43.440
> 
> 标签：cvs

我希望能够进行 cvs 提交，但从文件中提供多行注释，而不是让 cvs 调用编辑器。这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:27:58.623

因此使用[-F 标志](http://ximbiot.com/cvs/manual/cvs-1.12.13/cvs_16.html#SEC140)：

```
cvs commit -F file <files to commit> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:21:23.123

这可能做的工作：

```
cvs commit -m "$(cat file)" modified_file.c 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:27:37.850

假设你的意思是提交，而不是更新，不需要评论，你可以这样做

```
cvs commit -m `cat file_containing_multiline_comments` file_to_commit 
```

# gwt - GWT 堆栈小部件

> ID：10143592
> 
> 赞同：1
> 
> 时间：2012-04-13T15:17:49.657
> 
> 标签：gwt

我想要一堆小部件，只显示堆栈中的顶部小部件，并有下一个和后退按钮，显示堆栈中的下一个和上一个小部件。
它有点像 GWT StackPanel，但它是水平的，没有手风琴的影响。
有没有准备好这个（免费）或者我应该自己推出？如果我要自己动手，我会怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:25:59.340

你想要的实际上是 a [`DeckPanel`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/DeckPanel.html)or [`DeckLayoutPanel`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/DeckLayoutPanel.html)，带有一对递增或递减`getVisibleWidgetIndex`（或`getVisibleWidget`a `DeckPanel`）的按钮并`showWidget`使用结果索引调用（当然，你必须检查卡组中的第一个和最后一个小部件以避免`IndexOutOfBoundsException`s ）。

考虑到它的实现有多容易，你最好自己动手而不是试图找到一个现有的（这要么不会真正让你在美学上取悦，要么在布局/渲染方面非常灵活，以至于它变得臃肿）。

# php - Zend_Feed 访问项目 - ATOM

> ID：10143599
> 
> 赞同：2
> 
> 时间：2012-04-13T15:18:08.733
> 
> 标签：php, zend-framework, zend-feed

我正在尝试阅读“iTunes RSS Feed”。据我所知，它是基于 ATOM 的。

工作正常：

```
 $feed = $this->getFeed(self::TOP300_PAYED);

    foreach ($feed as $item) {
        echo $item->name;
    } 
```

但我需要以下节点：

```
<im:image height="53">
http://a3.mzstatic.com/us/r1000/116/Purple/61/9b/f2/mzl.wyuzxxzw.53x53-50.png
</im:image> 
```

知道如何使用 zend 提要访问它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T19:44:53.240

像任何其他 ATOM 提要一样，您可以像这样对其进行迭代：

```
 $feed = new Zend_Feed_Atom("example.com");
    foreach ($feed as $entry) {
        $xml = $entry->saveXml();
        $xmlObj = simplexml_load_string($xml);

        $xmlObj->registerXPathNamespace('im', "example.com");
        $result = $xmlObj->xpath('//im:image');

        foreach ($result as $image) {
          echo $image . "\n";
        }
    } 
```

注意[`registerXPathNamespace()`](http://cn.php.net/manual/en/simplexmlelement.registerxpathnamespace.php)这里的使用，似乎 iTunes 在他们的提要中使用了命名空间，这就是你需要先注册它的原因。

试试这个，让我知道它是否有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T07:36:34.373

感谢“命名空间”提示：

最终解决方案：

```
 $item->registerXPathNamespace('im', 'image');
        $image = (string) $item->image[0]; // first image "52" 
```

# git - 在我们的 Gerrit 安装中使用 git-review 的问题

> ID：10143600
> 
> 赞同：2
> 
> 时间：2012-04-13T15:18:14.867
> 
> 标签：git, gerrit

克隆 repo 并在分支上进行更改后，我在尝试将远程设置为 Gerrit 时得到以下信息：

```
$ git review -s
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/2.7/bin/git-review", line 676, in <module>
    main()
  File "/Library/Frameworks/Python.framework/Versions/2.7/bin/git-review", line 643, in main
    if not set_hooks_commit_msg(remote, hook_file):
  File "/Library/Frameworks/Python.framework/Versions/2.7/bin/git-review", line 122, in set_hooks_commit_msg
    parse_git_show(remote, "Push")
  File "/Library/Frameworks/Python.framework/Versions/2.7/bin/git-review", line 247, in parse_git_show
    team = project_name.split("/")[-2]
IndexError: list index out of range 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:10:10.093

这是此处记录的 git-review 的一个已知问题：[https](https://bugs.launchpad.net/git-review/+bug/980929) ://bugs.launchpad.net/git-review/+bug/980929已于 2012 年 4 月 14 日提交修复。

这似乎是由于假设项目使用斜线的命名约定引起的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-06-12T10:27:05.430

如果你确定你已经成功安装了 gerrit，但你仍然面临上述问题，请尝试升级你的 git 版本。这也解决了我的问题。

+桑巴。

# linq-to-entities - 具有对象列表的对象，其中具有对象列表 Linq to Entities

> ID：10143601
> 
> 赞同：1
> 
> 时间：2012-04-13T15:18:19.483
> 
> 标签：linq-to-entities

我正在使用 Linq to Entities，我只想调用一次数据库来获取一些数据。

我有一个帐户对象，它可以与多个公司关联。每个公司可以有很多地点。我可以得到带有公司列表的帐户没问题。问题是获取每个公司的位置列表并将其全部放回帐户对象。到目前为止，这是我的代码：

```
 public Account GetAccountByUserId(int userId)
    {
        IQueryable<Account> oq = _context.Accounts;

        oq = oq.Include(x => x.Companies);

        oq = oq.Include(x => x.Companies.SelectMany(l => l.Locations); //I was just guessing here, this throws the error below

        Account acct = oq.Single(x => x.Users.Any(y => y.Id == userId));
        return acct;
    } 
```

.SelectMany 引发的错误：包含路径表达式必须引用在类型上定义的导航属性。对引用导航属性使用虚线路径，对集合导航属性使用 Select 运算符。参数名称：路径

.Include() 甚至可能无法做到这一点，但如果没有，还有其他方法吗？我真的很想只调用一次数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T11:51:49.327

您是否尝试过仅包括这样的公司和地点：

```
_context.Accounts.Include("Companies.Locations"); 
```

# .net - 通过更改 SOMAXCONN 增加 Windows CE 中的最大积压？

> ID：10143605
> 
> 赞同：2
> 
> 时间：2012-04-13T15:18:31.873
> 
> 标签：.net, compact-framework, windows-ce, winsock2

我们正在 Windows Embedded CE 6 平台上开发 .NET CF 3.5 应用程序。我们正在尝试在 .NET 中实现一个小型 (HTTP 1.0) Web 服务器，它应该提供一个 WebApp 并响应简单的 REST 请求。

我们的实现遵循这篇 MSDN 文章中显示的模式：http: [//msdn.microsoft.com/en-us/library/aa446537.aspx](http://msdn.microsoft.com/en-us/library/aa446537.aspx)。我们使用 TCP 监听套接字、异步回调和 BeginAccept、EndAccept、BeginRecieve 和 EndReceive。

侦听端口上的传入连接由异步接受回调处理。（参见[http://msdn.microsoft.com/en-us/library/5bb431f9.aspx](http://msdn.microsoft.com/en-us/library/5bb431f9.aspx)）。通过调用 EndAccept 方法，在这个异步接受回调中，我们告诉监听端口将连接交给一个新的套接字并释放该端口，以便监听端口可以接受新的传入连接请求。已经接受的请求在一个自己的线程中处理（因为它是在异步回调中处理的）。

我们已经尝试过最小化 BeginAccept 和 EndAccept 之间的时间。因为，在调用 BeginAccept 和 EndAccept 之间的这段时间里，传入的连接请求被放置在侦听套接字的积压队列中。这个队列的长度可以通过所谓的 backlog 参数来配置——这个参数有一个依赖于平台的最大值。如果积压队列已用尽，新的 tcp 连接请求将在三次握手期间被拒绝（客户端/浏览器获取 RST 作为对其 syn 的响应）。

现在我们遇到了一个问题，大多数现代浏览器，如 Firefox、Chrome、Safari，例如使用多达 15 个（或更多）并发连接从服务器加载数据（每个主机的最大并发连接数可以在 Firefox 中配置about:config -> network.http.max-connections-per-server)。当一个页面被加载时，浏览器在需要时建立 15 个连接，这取决于需要加载的资源的数量（例如图像、javascript 或 css 文件）。

.NET CF socket.listen 方法（参见[http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.listen.aspx](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.listen.aspx)）允许定义积压编号。
根据我们的理解，我们的 backlog 应该大于 15，例如 20 左右，因为所有连接请求都是由浏览器同时触发的，所以我们的小型网络服务器同时受到 15 个连接请求的打击。太小的积压队列大小会导致 TCP 连接中止，因为在侦听套接字可以接受所有传入连接之前，并非所有传入连接都可以排队。在 Firebug 或 Chrome 中，这些请求显示为“已中止”。因此，我们通过 socket.listen(20) 将我们的积压工作增加到 20，并希望一切都会好起来，甚至可以承受最贪婪的浏览器。

问题是，socket.listen() 调用中的 backlog 参数被静默设置为 SOMAXXCON（在我们的例子中最多 5 个连接）。将数字设置得更高则没有效果。当浏览器建立例如 16 个并发套接字连接时，有些会丢失，因为某些套接字根本不适合 5 的积压队列，并且 TCP 连接从网络服务器获得 TCP-RST - 并且缺少一些资源在网页上。

有什么方法可以更改 Windows Embedded CE 6.0 中的 SOMAXXCON？（我们能够更改平台图像 - 使用平台构建器）。还是我们对这件事的理解有误？

我们附上了我们目前正在使用的源代码：

```
public class StateObject
    {
        // Client  socket.
        public Socket workSocket = null;
        // Size of receive buffer.
        public const int BufferSize = 1024;
        // Receive buffer.
        public byte[] buffer = new byte[BufferSize];
        // Received data string.
        public StringBuilder sb = new StringBuilder();
    }

public void StartListening()
    {
       logger.Debug("Started Listening at : " + this.listeninghostIp + ":" + this.listeningport);
       IPEndPoint localEP = new IPEndPoint(IPAddress.Parse(this.listeninghostIp), Convert.ToInt32(this.listeningport));
       listener = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);

       listener.Bind(localEP);
       listener.Listen(10);
       ThreadPool.QueueUserWorkItem(new WaitCallback(CheckForConnections) );
    }

public void CheckForConnections()
    {
        try
        {
            logger.Debug("listening successfully started! Waiting for incoming connections...");
            listener.BeginAccept(new AsyncCallback(acceptCallback), listener);
          }
        catch (Exception ex)
        {
            logger.Error("Exception Occured while starting Listening : " + ex.Message.ToString());
        }
     }

private void acceptCallback(IAsyncResult ar)
    {
        try
        {

            Socket listener = (Socket)ar.AsyncState;
            listener.BeginAccept(new AsyncCallback(acceptCallback), listener);
            Socket handler = listener.EndAccept(ar);
            StateObject state = new StateObject();
            state.workSocket = handler;
            handler.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0,
        new AsyncCallback(ReadCallback), state);

            logger.Debug("listening socket accepted connection...");

         }
        catch (Exception ex)
        {
            logger.Error("Error on acceptCallback. Error: " + ex.Message);
        }

public void ReadCallback(IAsyncResult ar)
    {
        String content = String.Empty;

        StateObject state = (StateObject)ar.AsyncState;
        Socket handler = state.workSocket;
        int bytesRead = handler.EndReceive(ar);

        if (bytesRead > 0)
        {
            state.sb.Append(Encoding.ASCII.GetString(
            state.buffer, 0, bytesRead));
        }
        ClientConnectionFactory.createConnection(ar.AsyncState);
 } 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-13T15:43:45.003

我认为您走错了路-您绝对可以在不更改积压请求编号的情况下处理此场景。

客户端请求进入端口 80，但响应不会返回到端口 80 上的客户端。这意味着您可以使用异步套接字处理来接收请求，然后将其传递给解析并以这种方式回复后续请求不会等待对先前请求的完整处理。我们在我们的 Padarn Web 服务器中使用了这种技术，并且在处理来自单个客户端浏览器的多个请求甚至来自多个同时客户端的多个请求时都没有问题。

# python - 在 Django-NoRel 中保存嵌套模型会出现“无法编码”错误

> ID：10143614
> 
> 赞同：1
> 
> 时间：2012-04-13T15:18:47.697
> 
> 标签：python, django, mongodb, pymongo, django-nonrel

我可以保存“节点”、“链接”，但不能保存“图表”（参见下面的错误）。使用 pymongo 2.1.1、Django-NoRel、Python 2.7：

```
from django.db import models
from djangotoolbox.fields import SetField, ListField, EmbeddedModelField

class Graph(models.Model):
    links = ListField(EmbeddedModelField('Link'))

class Link(models.Model):
    parent = EmbeddedModelField('Node')
    child = EmbeddedModelField('Node')

class Node(models.Model):
    extent = SetField() # set of strings e.g. "Gene-Bmp4"
    intent = SetField() # set of strings 
```

--

```
n1 = Node(extent=set(["Gene-bmp4"]),intent=set(["Attr1", "Attr2"]))
n2 = Node(extent=set(["Gene-fp4"]),intent=set(["Attr3", "Attr4"]))
link = Link(parent=n1, child=n2)
links = [link]
g = Graph(links=links)
g.save() 
```

产生错误：

/Library/Python/2.7/site-packages/pymongo-2.1.1-py2.7-macosx-10.7-intel.egg/pymongo/collection.py:312：RuntimeWarning：无法编码-重新加载python模块并重试. 如果您在没有收到 InvalidDocument 异常的情况下看到此内容，请参阅 api.mongodb.org/python/current/faq.html#does-pymongo-work-with-mod-wsgi

```
Exception Type:     InvalidDocument
Exception Value:    Cannot encode object: set(['Attr2', 'Attr1'])
Exception Location:     /Library/Python/2.7/site-packages/pymongo-2.1.1-py2.7-macosx-10.7-intel.egg/pymongo/collection.py in insert, line 312 
```

有谁知道我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T19:20:26.570

对我来说似乎是一个错误。请在[https://github.com/django-nonrel/djangotoolbox开票](https://github.com/django-nonrel/djangotoolbox)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T17:22:50.220

这里的问题是您不能将“set”类型的对象编码为 BSON，因为 BSON 没有“set”类型。

最好的解决方案是在保存图形之前将集合转换为数组。

# css - 皮肤类的 YUI3 位置更改外观

> ID：10143615
> 
> 赞同：0
> 
> 时间：2012-04-13T15:18:49.970
> 
> 标签：css, yui3

仅在 Firefox 9 中测试（到目前为止）。

在以下 HTML 中，如果您将`class="yui3-skin-sam"`BODY 标记移动到 main_menu DIV 标记，如下所示：

```
<div id="main_menu" class="yui3-skin-sam yui3-menu yui3-menu-horizontal yui3-menubuttonnav"> 
```

你会得到一个非常不同的外观（菜单背景中的图形丢失了）。但是，如果我将 main_menu DIV 与其他应用`class="yui3-skin-sam"`皮肤的 DIV 一起包装，它就可以正常工作。为什么？是否有可能让它只在一个 DIV 上工作，就像它对整个 BODY 和包装的 DIV 一样？

```
<html>
<head>
    <script src="http://yui.yahooapis.com/3.5.0/build/yui/yui-min.js">
    </script>
</head>
<body class="yui3-skin-sam">
    <div id="main_menu" class="yui3-menu yui3-menu-horizontal yui3-menubuttonnav">
        <div class="yui3-menu-content">
            <ul class="first-of-type">
                <li class="yui3-menu-item">
                    <a class="yui3-menuitem-content" href="#">Home</a>
                </li>
                <li>
                    <a class="yui3-menu-label" href="#search_menu"><em>Search</em></a>
                    <div id="search_menu" class="yui3-menu">
                        <div class="yui3-menu-content">
                            <ul>
                                <li class="yui3-menuitem">
                                    <a class="yui3-menuitem-content" href="http://www.google.ca">Google</a>
                                </li>
                                <li class="yui3-menuitem">
                                    <a class="yui3-menuitem-content" href="http://www.yahoo.ca">Yahoo</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </div>
    <script>
        YUI().use('node-menunav', function(Y) 
        {
            var menu = Y.one("#main_menu");

            menu.plug(Y.Plugin.NodeMenuNav);

            menu.get("ownerDocument").get("documentElement").removeClass("yui3-loading");
        });
    </script>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:04:44.290

几乎所有的 YUI 小部件都使用 CSS 样式声明，看起来像

```
.yui3-skin-sam .yui3-some-widget-name ... {
   ...
} 
```

而不是

```
.yui3-skin-sam.yui3-some-widget-name ... {
   ...
} 
```

所以有一个隐含的假设，即小部件位于某个容器的子容器中，该容器具有皮肤类。这通常是最有意义的，因为通常您希望将一堆具有一致皮肤的小部件组合在一起。所以（正如您所发现的）应用皮肤的最简单方法是只使用一个额外的包含`div`将皮肤类应用到菜单。

# ruby-on-rails - Rails 3\. 如何创建自定义 PUT 动作？

> ID：10143618
> 
> 赞同：2
> 
> 时间：2012-04-13T15:19:04.280
> 
> 标签：ruby-on-rails, ruby, routes, rake

我正在尝试为更新我的个人资料页面创建自定义操作。它不能是常规的 users#edit 或 users#update 操作，因为只有管理员可以使用该页面。

所以这就是我在 routes.rb 中的内容（附带问题：如何使链接变为 mydomain.com/users/update_profile 而不是 mydomain.com/update_profile？

```
get 'update_profile/:id' => "users#update_profile", :as => 'update_profile' 
```

_form.html.erb

```
<%= form_for @user, :url => update_profile_path(@user) do |f| %>
  <%= render :partial => "form", :locals => {:f => f} %>
<% end %> 
```

users_controller.rb

```
def update_profile
  @user = User.find(params[:id])
  respond_to do |format|
    if @user.update_attributes(params[:user])
      format.html { redirect_to @user, notice: 'User was successfully updated.' }
    else
      format.html { render action: "edit" }
    end
  end
end 
```

当我提交表单时，我得到这个：**路由错误没有路由匹配[PUT]“/update_profile/1”**

我理解错误，因为根据`rake routes`update_profile 操作的输出是 GET。

所以我需要将其更改为 PUT，但我不知道如何。如何在 routes.rb 中设置自定义 PUT 操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:21:18.813

您应该将其添加为`users`资源的成员

```
resources :users do
  member do
    put :update_profile
  end
end 
```

这样，它仍然是您的用户资源的一部分，并且路线将自动生成，并且可以通过类似的方式在您的表单中访问`update_profile_user_path(@user)`

# javascript - 不同的html来源

> ID：10143626
> 
> 赞同：0
> 
> 时间：2012-04-13T15:19:27.740
> 
> 标签：javascript, css, selenium, selenium-rc

如果我查看页面源代码，我会看到

```
<script language="javascript" type="text/javascript">
                styling += 'ul#topnav a.tabHeader5';
                styling += '{';
                styling += 'width: 142px;'; 
</script> 
```

如果我通过 selenium 从这个页面获取 html 源代码，我会看到

```
<style type=\"text/css\">\n\t\t\t\tul#topnav a.tabHeader5\n\t\t\t\t{\n\t\t\t\t\twidth: 142px;</style> 
```

我不明白为什么它从javascript更改为css。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:22:13.637

> 我不明白为什么它从javascript更改为css。

JavaScript 在执行时会更改 CSS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:24:01.947

看起来有一些 JavaScript 逻辑，无论是在同一页面中，还是在此页面引用的不同文件中，它根据脚本中声明的“样式”变量中的值动态写入 CSS 样式。

# xml - 如何在 XSL 中“向前看”以获取表格列标题？

> ID：10143632
> 
> 赞同：0
> 
> 时间：2012-04-13T15:19:48.973
> 
> 标签：xml, xslt, xmltable

我有一个如下的 XML 结构：

```
<Root>
  <Node Name="File System">
    <Node Name="C:\Windows\System32\drivers\etc\hosts">
      <Table>
        <Row>
          <Column Name="Name" Value="localhost" />
          <Column Name="IP" Value="127.0.0.1" />
        </Row>
        <Row>
        .....
    </Node>
  </Node>
</Root> 
```

我有 xslt 代码来遍历节点和表，但是当我想以某种方式获取列名作为标题时，我被卡住了。

这是工作代码（除了获取列标题：

```
<xsl:template match="Root">
  <ul>
    <xsl:apply-templates select="Node" />
  </ul>
 </xsl:template>

<xsl:template match="Node">
  <li>
    <xsl:value-of select="@Name" />
    <xsl:if test="Node">
      <ul>
        <xsl:apply-templates select="Node" />
      </ul>
    </xsl:if>
    <xsl:if test="Attributes">
      <xsl:apply-templates select="Attributes" />
    </xsl:if>
    <xsl:if test="Table">
      <xsl:apply-templates select="Table" />
    </xsl:if>
  </li>
</xsl:template>

<xsl:template match="Attributes">
  <ul>
    <xsl:apply-templates select="Attribute" />
  </ul>
</xsl:template>

<xsl:template match="Attribute">
  <li>
    <b><xsl:value-of select="@Name" />:</b> <xsl:value-of select="@Value" />
  </li>
</xsl:template>

<xsl:template match="Table">
  <table border="1">
    <tbody>
      <xsl:apply-templates select="Row" />
    </tbody>
  </table>
</xsl:template>

<xsl:template match="Row">
  <tr>
    <xsl:apply-templates select="Column" />
  </tr>
</xsl:template>

<xsl:template match="Column">
  <td>
    <xsl:value-of select="@Value" />
  </td>
</xsl:template> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:41:07.733

怎么样：

```
<xsl:template match="Row" mode="thead">
  <th>
    <xsl:apply-templates select="Column" mode="thead"/>
  </th>
</xsl:template>

<xsl:template match="Column" mode="thead">
  <td>
    <xsl:value-of select="@Name" />
  </td>
</xsl:template> 
```

然后将您的更改`match="Table"`为

```
<xsl:template match="Table">
  <table border="1">
    <thead>
      <xsl:apply-templates select="Row[1]" mode="thead"/>
    </thead>
    <tbody>
      <xsl:apply-templates select="Row" />
    </tbody>
  </table>
</xsl:template> 
```

# html - CSS: make overflow-x: hidden 真的隐藏了？

> ID：10143635
> 
> 赞同：11
> 
> 时间：2012-04-13T15:19:57.807
> 
> 标签：html, css

我有一个样式为 的 div `overflow-x: hidden`，但我发现当其中有一个包含文本的更宽 div 时，用户仍然可以用鼠标横向拖动以查看隐藏的文本。

我想防止这种情况并让文本真正隐藏起来。这个 jsfiddle 应该显示我的意思：http: [//jsfiddle.net/YzsGF/11/](http://jsfiddle.net/YzsGF/11/)或者这里是代码：

```
<div id="outer">
   <div id="inner">
       How can I truly hide the text beyond the margin?
    </div>
</div>
#outer { 
    width: 150px; 
    height: 300px; 
    overflow-x: hidden;
    border: 1px solid black;
}
#inner { 
    width: 300px;
    overflow-x: hidden;
} 
```

有没有办法阻止用户看到隐藏的文本？

更新：我需要溢出-y 工作：溢出-x 只是 CSS3 没关系。这可能有助于解释现实生活中的场景：

*   我有一个固定宽度但长度未知的内部 div。
*   当它足够短以适合没有 y 滚动条的外部 div 时，一切都很好。
*   当内部 div 变得足够长以至于外部 div 需要一个 y 滚动条时，会出现一个，但会切断内部 div 的一些右侧内容。这也可以（我故意留下了一些 RH 填充），但不好的是用户可以选择文本并将其拖动到侧面，从而显示空的 RH 填充并隐藏 LH 侧的一些文本。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:42:02.617

我不确定您是否需要内部 div 的 y 轴可滚动，但如果您不这样做，那么这应该适合您的需要：

```
#outer { 
    width: 150px; 
    height: 300px;
    overflow-x: hidden;
    border: 1px solid black;
}
#inner { 
    overflow: hidden;
    width: 100%;
}​ 
```

似乎溢出和溢出-x 的行为彼此不同。 [http://jsfiddle.net/G3T9w/5/](http://jsfiddle.net/G3T9w/5/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T15:52:35.513

`overflow-x: hidden`，不像`overflow: hidden`不禁用滚动。它只是导致内容被剪切并隐藏滚动条。元素本身仍然可以通过 javascript 滚动，或者正如您在某些元素自动滚动的选择场景中发现的那样。

没有非 javascript 的解决方案，而且 javascript 仍然很混乱，因为如果滚动条不可见， onscroll 不会触发（也就是说，onscroll 事件与滚动条更改位置相关联，而不是元素的实际滚动）。

有各种解决方法。Andrew Dunn 放置`overflow:hidden`包装纸并将包装纸设置为容器宽度的解决方案就是其中之一。但这只是解决问题，并不能解决实际问题。但是，如果您对此感到满意，那么它可能是一个不错的选择。请记住，您需要将此技术应用于容器中的所有项目，否则您可能会遇到相同的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-13T22:20:47.180

您可以使用 CSS`clip`属性。这将根据需要剪切您的文本，不显示任何超出剪切矩形的内容，并且还会阻止用户滚动。

> ```
> #inner { 
> position:absolute;
> clip:rect(0px,150px,150px,0px);
> width: 300px;
> } 
> ```

# 例子：

[http://jsfiddle.net/DigitalBiscuits/YzsGF/18/](http://jsfiddle.net/DigitalBiscuits/YzsGF/18/)

注意：您需要为此剪辑属性指定绝对定位才能正常工作。

**更多信息在这里：** [http ://www.w3schools.com/cssref/pr_pos_clip.asp](http://www.w3schools.com/cssref/pr_pos_clip.asp)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-07T00:02:53.637

假设简化的 HTML 代码是：

```
<html><body><div class=wrap>content...</div></body></html> 
```

将 body 和 html 都设置为 height:100%;

```
body, html {height:100%;} 
```

在 body 中放置一个 div，并将其设置为横跨整个身体高度：

```
div.wrap {height:100%; overflow:hidden;} 
```

这将防止窗口以奇怪的方式滚动，例如按下鼠标滚轮并移动它，使用锚点等。

要删除滚动条本身（视觉上），您还应该添加：

```
body {overflow: hidden; } 
```

* * *

要通过按键盘上的箭头键禁用滚动：

```
window.addEventListener("keydown", function(e) {
    // space, page up, page down and arrow keys:
    if([32, 33, 34, 37, 38, 39, 40].indexOf(e.keyCode) > -1) {
        e.preventDefault();
    }
}, false); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-03T16:33:01.090

对我有用的最简单的答案是将 CSS 样式添加`position: fixed;`到`<body>`标签中。

# ios - 如果我想在 iOS 中运行我的应用程序，我可以使用 ANSI 库吗？

> ID：10143636
> 
> 赞同：0
> 
> 时间：2012-04-13T15:19:58.030
> 
> 标签：ios

裸露我的基本问题。我基本上来自 C/C++ 背景。我想为 iOS 中的特定数据格式开发一个解析器，并在解析到 UI 后发送少量信息。我已经在 C 中解析登录，我的问题是，我可以在 Objective-C 中使用相同的代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:22:23.007

由于 Objective-C 是 C 的严格超集，任何和所有 C 代码都是有效的 Objective-C 代码，所以答案是肯定的。

# python - 嵌套的 python 生成器有多快？

> ID：10143637
> 
> 赞同：1
> 
> 时间：2012-04-13T15:19:59.987
> 
> 标签：python, generator

好的，所以无论如何我可能都不应该担心这一点，但是我有一些代码旨在通过一组过滤器和地图以及其他东西传递一个（可能很长，可能很短）的可能性列表，我想知道我的实现是否会表现良好。

作为我想做的事情类型的一个例子，考虑这个操作链：

*   获取从 1 到 100 的所有数字
*   只保留偶数
*   平方每个数字
*   生成所有对 [i, j] 与上面列表中的 i 和 [1, 2, 3, 4,5] 中的 j
*   只保留 i + j > 40 的对

现在，在做了所有这些废话之后，我想通过这组对 [i, j] 来寻找满足某个条件的对。通常，解决方案是第一个条目，在这种情况下，我什至不看任何其他条目。但是，有时我必须消耗整个列表，而我找不到答案并且不得不抛出错误。

我想将我的“操作链”实现为一系列生成器，即每个操作迭代由前一个生成器生成的项目，并逐项“产生”自己的输出（如 SICP 流）。这样，如果我从不查看输出的最后 300 个条目，它们甚至不会被处理。我知道 itertools 提供了 imap 和 ifilter 之类的东西来执行我想要执行的许多类型的操作。

我的问题是：在我必须遍历所有可能性的情况下，一系列嵌套生成器是否会对性能造成重大影响？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T16:06:51.460

我尝试了两种实现，一种使用生成器，一种不使用生成器。我在 2.7 中对其进行了测试，因此`range`返回一个列表而不是迭代器。

这是实现

使用生成器

```
def foo1():
    data = ((a,b) for a in (i*i for i in xrange(1,101) if i%2) for b in [1,2,3,4,5] if a+b > 40)
    return list(data) 
```

没有发电机

```
def foo2():
    result=[]
    for i in range(1,101):
        if i%2:
            i=i*i
            for j in [1,2,3,4,5]:
                if i+j > 40:
                    result+=[(i,j)]
    return result 
```

混合两者以免附加列表

```
def foo3():
    data=[(a,b) for a in (i*i for i in range(1,101)) for b in [1,2,3,4,5] if a+b > 40] 
    return data 
```

创建临时列表

```
def foo4():
    data=[(a,b) for a in [i*i for i in range(1,101)] for b in [1,2,3,4,5] if a+b > 40]
    return data 
```

这是我的结果

```
>>> t1=timeit.Timer("foo1()","from __main__ import foo1")
>>> t2=timeit.Timer("foo2()","from __main__ import foo2")
>>> t3=timeit.Timer("foo3()","from __main__ import foo3")
>>> t4=timeit.Timer("foo4()","from __main__ import foo4")

>>> print "%.2f usec/pass" % (1000000 * t1.timeit(number=10000)/10000)
100.95 usec/pass
>>> print "%.2f usec/pass" % (1000000 * t2.timeit(number=10000)/10000)
158.90 usec/pass
>>> print "%.2f usec/pass" % (1000000 * t3.timeit(number=10000)/10000)
130.02 usec/pass
>>> print "%.2f usec/pass" % (1000000 * t4.timeit(number=10000)/10000)
133.68 usec/pass
>>> 
```

结论：

生成器表达式功能强大，您可以对其进行更大程度的优化。正如您在示例中看到的那样`foo2`，这是最慢的，它很难附加一个导致性能下降的列表。`foo3`并且`foo4`时间几乎相同，因此创建临时列表似乎不是瓶颈，因为它在整个迭代中只创建了一次。如果没有生成器，您很快就会遇到一些性能问题，例如附加列表或创建临时列表。因此，懒惰的评估出现在这些性能瓶颈上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T16:01:11.113

根据官方文档，使用生成器表达式基本上等同于调用`imap`它创建一个迭代器。（“[生成器表达式产生一个**新**的生成器对象。](http://docs.python.org/reference/expressions.html#grammar-token-generator_expression) ”）没有明确讨论嵌套表达式是创建单独的（组合的）对象还是内部具有复杂逻辑的单个表达式，但是将自己想象为解释器实现者，嵌套对象似乎是最实现嵌套生成器表达式的直接方法。

然而，在决定什么会表现更好时，还有其他因素在起作用。我了解到，最小化短期对象的创建是性能的一个重要因素，而在 Python 中，当你这样做时有时很难注意到。

表现不佳：`(f(x) for x in range(100)) # builds 100-element list`

更好的性能：`(f(x) for x in xrange(100)) # uses counting iterator`

我在自己的实现中一直使用`imap`,`ifilter`和`izip`from`itertools`模块，我发现它们表现良好。虽然这些的每次调用都会创建一个新的迭代器对象，但这是相当轻量级的，有点像一个列表，其中永远不会超过一个项目。此外，在 CPython 中，这些都是用 C 实现的，因此非常高效。

在幕后，在纯 Python 中实现的迭代器有一个`next`被调用来检索每个数据的方法。方法调用的成本不是很高，但也不是零。因此，如果您的代码将在必须尽可能优化的紧密循环中使用，以下是我的建议：

*   绝对使用`imap`,`ifilter`并且`izip`在可能的情况下而不是`map`,`filter`并且`zip`在内存中构造结果列表并返回它们。如果您的代码使用基于列表的版本，您将通过更改为基于迭代器的版本看到很大的改进。
*   该`itertools`模块包含其他函数，如`takewhile`, `starmap`,`chain`并且`chain.from_iterable`在链式迭代器实现中通常有用。
*   与其链接多个应用程序，不如`ifilter`尽可能组合传入的函数。例如，代替`ifilter(lambda v: v > 0, ifilter(lambda v: v % 3 == 0, data))`，将过滤器组合为`ifilter(lambda v: (v > 0) and (v % 3 == 0), data)`。在某些情况下，重新排列操作顺序可能是有效的，以便您可以通过这种方式折叠它们。
*   当您执行映射操作以实现副作用并且对结果不感兴趣时​​，您可以使用它来代替`map`避免结果在内存中累积：

    ```
    def consume(i):
      u'eat all contents of given iterator'
      while True:
        i.next()

    consume(imap(side_effect, data)) 
    ```

最后，请注意其他可能会增加内存使用或重复创建和销毁对象的问题，从而给垃圾收集器带来压力。这实际上与迭代器没有任何关系，但它确实会影响性能。下面的函数在内存中创建一个 lambda 表达式，并在每次调用时将其丢弃：

```
def foo(data):
  return reduce(R, imap(bar, ifilter(lambda v: v % 5 == 0, data))) 
```

修复它的一种方法（此方法每次仍将创建两个迭代器对象，这是必要的，但不是额外的 lambda 表达式）：

```
_mod5zero = lambda v: v % 5 == 0
def foo(data):
  return reduce(R, imap(bar, ifilter(_mod5zero, data))) 
```

（注意：答案适用于 Python 2。在 Python 3`map`中，`filter`并`zip`返回迭代器。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T16:10:28.360

“嵌套”迭代器相当于迭代器实现的功能的组合，因此通常它们没有提出特别新颖的性能考虑。

请注意，由于生成器是惰性的，因此与重复分配一个序列以转换为另一个序列相比，它们也倾向于减少内存分配。

# wpf - 合并 CellEditingTemplate CellTemplateSelector DataGrid

> ID：10143645
> 
> 赞同：0
> 
> 时间：2012-04-13T15:20:29.933
> 
> 标签：wpf, datagrid, celltemplate, celleditingtemplate

我想将 CellTemplateSelector 应用于 CellEditingTemplate。它们可以结合起来吗？

这是他们分开的

```
 <DataGridTemplateColumn x:Name="dateScheduledColumn" Header="Date Scheduled" Width="125">
            <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Path= DateScheduled, StringFormat=\{0:d\}}" />
                </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
            <DataGridTemplateColumn.CellEditingTemplate>
                <DataTemplate>
                    <DatePicker SelectedDate="{Binding Path=DateScheduled, Mode=TwoWay,
                        ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                </DataTemplate>
            </DataGridTemplateColumn.CellEditingTemplate>
        </DataGridTemplateColumn>
        <DataGridTemplateColumn Header="Grade">
            <DataGridTemplateColumn.CellTemplateSelector>
                <local:GradeTemplateSelector
        PassedTemplate="{StaticResource PassedTemplate}"
        FailedTemplate="{StaticResource FailedTemplate}"/>
            </DataGridTemplateColumn.CellTemplateSelector>
        </DataGridTemplateColumn> 
```

如果我尝试这个，我会收到语法错误

```
 <DataGridTemplateColumn.CellEditingTemplate>
           <DataGridTemplateColumn.CellTemplateSelector> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:22:42.313

只需使用 DataGridTemplateColumn.CellEditingTemplateSelector

# .net - 如何将 mdf 文件附加到水晶报表

> ID：10143647
> 
> 赞同：0
> 
> 时间：2012-04-13T15:20:42.913
> 
> 标签：.net, vb.net, crystal-reports

我正在尝试将 mdf 文件附加到水晶报告中。谁能告诉怎么做？？

我已将 CrystalReport1.rpt 添加到我的项目中。现在该怎么办？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T18:19:30.280

您需要安装 mssql 服务器，支持用户实例，

并像这样在水晶报告中更改您的连接字符串：

```
data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|Registration.mdf;User Instance=true 
```

编辑1：

有关更多信息，请参阅[此](http://rbgupta.blogspot.de/2007/12/sql-server-user-instances-and.html)

# php - PHP：是否序列化

> ID：10143648
> 
> 赞同：2
> 
> 时间：2012-04-13T15:20:45.237
> 
> 标签：php, json, serialization, normalization

我有一个包含产品的产品表。每个产品可以有多个图像。图片的 urls/id 将存储在我的数据库中。现在，不是在我的产品表中创建诸如 、 等列，而是将`image_url1`包含`image_url2`我的产品表中的图像列表的序列化数据存储在一个名为`image_url`.

还是创建另一个`product_image`关系表并将产品 ID 和图像 ID/URL 存储在那里更好？

我确信这两种方法都行得通，但我想采用最佳实践。

注意：每个产品的图像数量会有所不同。有些产品甚至可能没有图像。

编辑：为我的问题添加更具体的细节。图片 URL 不会用于搜索。它将仅用于在显示产品时检索图像的 URL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:23:36.090

很多人会告诉您，如果您将事物列表存储在一个字段中，它会扼杀关系数据库引擎（或其他任何东西）的意义。

但是，如果您从不需要按该字段进行搜索（在您的情况下，如果您从不需要获取图像 url 并找到拥有该图像的产品），或者该字段永远不受约束（例如，如果有无需确保不使用两次相同的图像），您没有理由不将数据转储到单个字段中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T15:28:07.233

最佳实践不是灵丹妙药，它们总是最适合特定情况，无论是广泛的还是狭窄的。

如果您要做的只是遍历图像列表，我看不出有什么害处。但是，如果您要编辑或搜索特定图像，我不会这样做。而不是您的其他选择（命名图像字段），为什么不将图像放在不同的表中，并使用它们所属产品的外键。

或者，如果您真的需要将它们全部填充到一个字段中，您可能会查看您的数据库的 XML 功能。我已经完成了一些工作，在 xml 文档中编码大量字段并将其作为字段存储在数据库中，然后使用 XPath 搜索它。您依赖于 db 供应商实现的 XPath 函数的级别，但在我的情况下，它的性能非常好，并且允许我们将同一类对象的不同类型存储在同一个表中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T15:33:21.240

最佳做法是使用单独的表。将数据序列化到单个字段中会起作用，但这不是一个好主意。

如果您需要使用不同的语言访问数据库怎么办。它能够反序列化 PHP 序列化对象吗？（不）

使用序列化数据将需要更多代码。

**删除图像示例**

单独的表：

```
delete from product_images where product_image_id = 4 
```

序列化数据：

*   从数据库中获取序列化数据。
*   反序列化为数组或对象。
*   遍历数据以找到您需要的数据。
*   从列表中删除它。
*   序列化修改后的列表并将其保存回数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T15:24:48.533

在 images 表中创建列“product_id”。

# java - 从 Java 在 MySQL 中创建临时表

> ID：10143649
> 
> 赞同：1
> 
> 时间：2012-04-13T15:20:55.807
> 
> 标签：java, mysql, temp-tables

我有这个：

```
public static void createTemporaryTable() {
        Statement s = null;
        sentence = "CREATE TEMPORARY TABLE Book (ISBN int NOT NULL, " +
                "title varchar(45), author varchar(45), price double, PRIMARY KEY  (`ISBN`));";

        try {
            s = Conexion.getInstancia().createStatement();
            s.executeUpdate(sentence);
        } catch (SQLException e) {
            e.printStackTrace();
        } finally {
            try {
                s.close();
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
    } 
```

然后：

```
public class System {

    public static void main(String[] args) {
        SqlSentencesList.createTemporaryTable();
    }

} 
```

但是当我执行时`select * from Book`，MySQL 告诉我`Book`表不存在。我没有从 java 收到任何错误消息，所以应该创建表，但事实并非如此。

如果我直接在 mysql 中执行相同的 sql 语句来创建临时表，它就可以正常工作。

这是我的`Conexion`课：

```
public class Conexion {

    private static Connection conexion = null;

    private Conexion() {

    }

    public static Connection getInstancia() {
        if (conexion == null) {
            try {
                Class.forName("com.mysql.jdbc.Driver");
                conexion = DriverManager.getConnection(
                        "jdbc:mysql://localhost/Esquema_VentaLibros","gustavo", "123581321");

            } catch (SQLException sqlex) {
                sqlex.printStackTrace();
            } catch(ClassNotFoundException cnfex) {
                cnfex.printStackTrace();
            }
            return conexion;
        }
        else {
            return conexion;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:23:54.853

关闭连接时会自动删除临时表。

有关详细信息，请参阅[MySQL CREATE TABLE](http://dev.mysql.com/doc/refman/5.5/en/create-table.html)文档：

> 创建表时可以使用 TEMPORARY 关键字。TEMPORARY 表仅对当前连接可见，并在连接关闭时自动删除。这意味着两个不同的连接可以使用相同的临时表名，而不会相互冲突或与现有的同名非临时表冲突。（在删除临时表之前，隐藏现有表。）

如果你想创建一个临时表来做一些工作，你应该在开始工作时创建它，并针对它执行你的 UPDATE/SELECT 语句。当您关闭连接时，它会自动删除，并且不会与使用相同临时表名的其他连接发生冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:24:21.590

临时表是每个数据库连接的。因此，如果您尝试从另一个连接访问临时表，您将看不到它。

# android - 使用手机号码查找安卓手机的经纬度

> ID：10143653
> 
> 赞同：0
> 
> 时间：2012-04-13T15:21:13.777
> 
> 标签：android, android-intent

我正在尝试开发一个遵循以下步骤的android应用程序（名为ContactListFinder）

1.  通过 android.provider.ContactsContract 包访问联系人列表
2.  同样访问电话号码
3.  根据纬度和经度计算发送者和接收者的位置，然后找到发送者和接收者之间的距离
4.  如果在覆盖范围内则弹出消息，否则不显示消息

现在这里的问题是“根据longtitute和latitute使用手机号码查找位置”欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:59:21.050

根据定义，“使用手机号码根据经纬度查找位置”是不可能的。我在地球上的任何地方都有相同的电话号码，因为我在旅行（国内或国际）时不会更换我的 SIM 卡，而且我已经为国际漫游做好了准备。

“使用手机号码查找位置，对于那些使用某种“登记”服务的人来说，让人们随时知道他们在哪里，尽管事实上这种选择加入的全景监狱是真正可怕的”是可能的。你需要找到这样一个服务，它有一个 API，允许你通过电话号码找到任意人的位置。而且，您需要发送者和接收者都使用这些服务之一。而且，您需要确保您对这些服务的使用不违反任何隐私政策或其他使用条款。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T16:34:18.137

不错的应用程序，您可以不通过电话号码找到用户位置（经度，纬度），但您可以使用 LocationManager 类提供的基于位置的 Android 服务找到它。所以，除非他们安装了应用程序，否则您无法访问用户朋友的位置。所以，您可能必须使用您的应用程序创建用户社区并维护包含所有用户位置信息的中央数据库。希望这会有所帮助。

# jquery - 如何使用 jquery 检测多列表框中的更改

> ID：10143663
> 
> 赞同：0
> 
> 时间：2012-04-13T15:22:10.687
> 
> 标签：jquery

使用下面的代码，我可以使用 add'remove 按钮添加和删除元素。现在我试图在任何这些列表框中发生更改时检测更改。我该如何使用 jQuery 来做呢？

```
$(document).ready(function() {

    $('#btn-add').click(function(){
        $('#select-from option:selected').each( function() {
                $('#select-to').append("<option value='"+$(this).val()+"'>"+$(this).text()+"</option>");
            $(this).remove();
        });
    });
    $('#btn-remove').click(function(){
        $('#select-to option:selected').each( function() {
            $('#select-from').append("<option value='"+$(this).val()+"'>"+$(this).text()+"</option>");
            $(this).remove();
        });
    });

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:35:28.250

你可以简单地做

```
$('#select-to').change(function() {
    //your onChange code here
});
$('#select-from').change(function() {
    //your onChange code here
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:31:02.020

看起来您正在动态添加选项，但您只需要查看选择本身的更改事件..

所以你可以添加

```
//jquery 1.7.1
$('#select-to').on('change', function(){});
$('#select-from').on('change', function(){}); 
```

监视选择更改...如果您想跟踪添加选项的事件，您可以在添加/删除选项的按钮的单击事件中执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:45:17.600

您可以创建自定义事件

```
$(document).ready(function() {    
    $('#btn-add').click(function(){
        $('#select-from option:selected').each( function() {
                $('#select-to').append("<option value='"+$(this).val()+"'>"+$(this).text()+"</option>");
                $('#select-to,#select-from').trigger('customchange');
            $(this).remove();
        });
    });
    $('#btn-remove').click(function(){
        $('#select-to option:selected').each( function() {
            $('#select-from').append("<option value='"+$(this).val()+"'>"+$(this).text()+"</option>");
            $('#select-to,#select-from').trigger('customchange');
            $(this).remove();
       });
    });
}); 
```

然后将任何函数绑定到该事件：

```
$('#select-to').bind('customchange', function(){
  //do whatever
}); 
```

# facebook - 墙上的动态 Facebook 缩略图

> ID：10143664
> 
> 赞同：0
> 
> 时间：2012-04-13T15:22:12.857
> 
> 标签：facebook, thumbnails

我在 Facebook 上动态生成缩略图时遇到问题。我需要在每个子页面上放置一个独特的图像。我有如下页面链接：

*   www.name.com/1234
*   www.name.com/23
*   等等

在每个页面上，我都放置了一个独特的元属性 =“og:image”，例如：

```
<meta property="og:image" content="http://www.name.com/images/23.png"/> 
```

但 Facebook 只看到主页上定义的默认 og:image。

我能做些什么？请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T00:37:10.573

您还必须创建一个动态的“og:url”。

```
<meta property="og:url" content="http://www.one.com/[YOUR_DYNAMIC_PATH]" />
<meta property="og:image" content="http://www.one.com/[YOUR_DYNAMIC_IMAGE]?>" /> 
```

希望这可以帮助。

# javascript - 更改“with”属性更改样式

> ID：10143670
> 
> 赞同：0
> 
> 时间：2012-04-13T15:22:36.193
> 
> 标签：javascript, jquery, css, knockout.js

我有看起来像这样的 html：

```
<div>
    <table>
        <tr onclick="show();">
            <td class="cell">Click to open</td>
        </tr>
    </table>
</div>
<div style="display:none; position:absolute; left:150px" id="hiddenDiv">
    <table data-bind="with: someProperty">
        <tr onclick="hide();">
            <td class="cell" data-bind="text:message"></td>
        </tr>
    </table>
</div>
<input type="button" value="Color cells" onclick="colorCells()" /> 
```

我的 JavaScript 看起来像这样：

```
 function show() {
        vm.someProperty(vm.list[1]);
        $("#hiddenDiv").fadeIn("slow");
    }
    function hide() {
        $("#hiddenDiv").fadeOut("slow");
    }
    function colorCells() {
        $(".cell").css("background-color", "Yellow");
    }

    function ViewModel() {
        this.list = [new SubModel("item 1"), new SubModel("item 2")];
        this.someProperty = ko.observable(this.list[0]);
    }

    function SubModel(msg) {
        this.message = msg;
    }

    var vm = new ViewModel();

    $(function () {    
        ko.applyBindings(vm);
    }); 
```

[我在这里](http://jsfiddle.net/mkP9r/2/)设置了一个 jsFiddle 。

现在的问题是，当您单击按钮时，所有具有“单元格”类的表格单元格的背景颜色都应该改变。但是，如果隐藏的 div 不可见，那么当它可见时，它的背景颜色仍然是白色。这样做的原因似乎是因为我正在更改包装隐藏单元格的“with”绑定中使用的属性。似乎当您更改与“with”绑定的属性时，它会重置其子项的样式。

（如果这没有意义，请在 jsFiddle 上执行此操作。单击按钮，然后单击“单击以打开”单元格。注意“项目 2”未突出显示。再次单击该按钮，它将突出显示。现在再次点击“Click to open”单元格，注意“item 2”不再突出显示。现在删除显示函数中设置“someProperty”的行并重复实验。“item 1”现在无论是否正确突出显示单击颜色单元格按钮时是否可见）

这是设计使然吗？有没有办法解决它，以便更改“with”使用的属性不会重置样式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:33:40.303

恕我直言，解决这个问题的正确方法是将颜色也作为可观察的，可以在单击按钮时更改。我在[这里有更新 jsfiddle](http://jsfiddle.net/mkP9r/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:27:41.877

与其改变 css 类，不如尝试改变单元的类而不是 css 类“单元”本身，看看是否有效？

# java - 条件查询 ORDER BY 产生错误。这是 SQL-SERVER 限制吗？如何在复杂的条件查询中正确排序？

> ID：10143673
> 
> 赞同：1
> 
> 时间：2012-04-13T15:22:43.490
> 
> 标签：java, sql-server, hibernate

我有以下条件查询：

```
 String cat = "H";
    Criteria criteria = currentSession().createCriteria(this.getPersistentClass()).
            add(Restrictions.ne("category", cat)).
            createAlias("employees", "emp").
            createAlias("emp.company", "company");
    Disjunction disjunction = Restrictions.disjunction();
    for(Region r: regions){
           disjunction.add(Restrictions.eq("company.region", r));
    }
    criteria.add(disjunction);

    if(status != null) {
        criteria.add(Restrictions.eq("status", status));
    }

    if (period != null) {
        criteria.add(Restrictions.eq("period", period));
    }

    criteria.setProjection(Projections.groupProperty("id")) //this line was added to try to "fix" the error, but it still happened.
    criteria.addOrder(Order.asc("id")); 
```

我猜想解释我的标准查询的查询可能是：

```
 select n.* from NOMINATION n
  join NOMINEE i on n.NOM_ID = i.NOM_ID
  join EMPLOYEE e on e.EMP_ID = i.EMP_ID
  join COMPANY c on c.COMPANY_CODE = e.COMPANY_CODE
  where n.CATEGORY_CODE!='H' and (c.REGION_ID = ? or c.REGION_ID = ? or c.REGION_ID = ?) and n.STATUS_ID = ? and n.PERIOD_ID = ?
  order by n.NOM_ID 
```

我在这里尝试做的事情非常令人困惑，但大多数情况下它都可以工作，除非我添加了这个特定的行（尽管查询工作正常）：

```
 criteria.addOrder(Order.asc("id")); 
```

然后我得到错误：

```
 java.sql.SQLException: Column "NOMINATION.NOM_ID" is invalid in the ORDER BY clause because it is not contained in either an aggregate function or the GROUP BY clause. 
```

我怀疑这与 SQL-SERVER 有关。我已经按`id`. 那么我在这里做错了什么，还是应该只使用 HQL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:35:43.157

您当前的查询似乎是一个简单的查询，它没有使用任何组功能或没有按查询分组。根据您当前的要求，您不必使用这条线。

```
criteria.setProjection(Projections.groupProperty("id")).addOrder(Order.asc("id")); 
```

或者你必须修改你的 sql 语句。

# c++ - 错误共享和原子变量

> ID：10143676
> 
> 赞同：8
> 
> 时间：2012-04-13T15:23:00.487
> 
> 标签：c++, c, multithreading, caching, x86-64

当不同的变量在同一个缓存行中时，您会遇到[False Sharing](http://en.wikipedia.org/wiki/False_sharing)，这意味着即使两个不同的线程（运行在不同的内核上）正在访问两个不同的变量，如果这两个变量位于同一个缓存行中，您将有性能下降，因为每次都会触发缓存一致性。

现在说这些变量是原子变量（我所说的原子是指引入内存栅栏的变量，例如`atomic<t>`C++ 的），在那里错误共享很重要，或者原子变量是否在同一个缓存行中并不重要，因为据说他们无论如何都会引入缓存一致性。换句话说，将原子变量放在同一个缓存行中会使应用程序比不将它们放在同一个缓存行中慢吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-13T15:31:02.417

澄清：对于负面后果，至少应该写入对“错误共享”变量的一些访问。如果写入很少，则错误共享的性能影响可以忽略不计；写入次数越多（因此缓存行无效消息）性能越差。

即使使用原子，缓存行共享（无论是假的还是真的）仍然很重要。在这里寻找一些证据：[http](http://www.1024cores.net/home/lock-free-algorithms/first-things-first) ://www.1024cores.net/home/lock-free-algorithms/first-things-first 。因此，答案是 - 是的，将不同线程使用的原子变量放置到同一缓存行可能会使应用程序比将它们放置到两个不同的行更慢。但是，我认为它几乎不会被注意到，除非应用程序花费大量时间更新这些原子变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T16:06:49.367

If you use atomic variables with the strongest consistency requirements, a full memory barrier, the effect of false sharing will probably not be noticeable. For such an access the performance of an atomic operation is basically limited by the memory access latency. So things are slow anyhow, I don't think they would get much slower in the presence of false sharing.

If you have other less intrusive memory orderings the performance hit by the atomics itself may be less, and so the impact of false sharing might be significant.

In total, I would first look at the performance of the atomic operation itself before worrying about false sharing for such operations.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:45:16.610

> 将原子变量放在同一个缓存行中会使应用程序比不将它们放在同一个缓存行中慢吗？

“原子”变量的错误共享*可能会*导致性能问题（是否*会*导致此类问题取决于很多事情）。

假设您有两个核心`A`和`B`，并且每个核心都对自己的变量进行操作。让我们分别称这些变量`a`和`b`。

`A`有`a`在它的缓存中，并且`B`有`b`在它的缓存中。

`A`考虑递增时会发生什么`a`。

*   **如果`a`并`b`共享一个缓存行，** `B`的副本`b`将失效，并且它的下一次访问`b`将导致缓存未命中。
*   **如果`a`并且`b`不共享缓存行，**`B`则就其缓存副本而言没有影响`b`。

无论是否`a`并且`b`是“原子的”，都会发生这种情况。

# c# - 在.net 中解析以 JSON 形式返回的日期？

> ID：10143678
> 
> 赞同：3
> 
> 时间：2012-04-13T15:23:03.260
> 
> 标签：c#, .net, json

嗨，我从 API 接收响应为 JSON 并将其加载到我的应用程序中。除了特定项目的发布日期之外，所有内容都可以正常导入。日期作为我以前从未使用过的数字返回：

```
'date_created' : 1279643054 
```

我尝试使用普通的 DateTime.Parse() 没有运气。有谁知道如何解析这个，或者这种格式的名称是什么，所以我可以做进一步的研究？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:25:16.050

这是一个[UNIX 时间戳](http://en.wikipedia.org/wiki/Unix_time)。使用此代码将时间戳转换为`DateTime`对象：

```
static DateTime ConvertFromUnixTimestamp(long timestamp)
{
    return new DateTime(1970, 1, 1, 0, 0, 0, 0).AddSeconds(timestamp);
} 
```

# jquery - 将 Facebook 视频动态拉入外部页面

> ID：10143680
> 
> 赞同：-1
> 
> 时间：2012-04-13T15:23:06.760
> 
> 标签：jquery, .net, facebook

如果您查看类似[http://www.facebook.com/subway/videos](http://www.facebook.com/subway/videos)的内容，就会发现有一堵视频墙。我想以某种方式获取所有这些以显示在另一个站点上；随着此页面的更新，我的页面也将更新。这可能吗？如果是这样，我从哪里开始？

理想情况下，任何使用 jQuery 或 .NET 的方法都很棒，但我的请求可能非常大，因此我们将非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T19:18:04.540

您首先需要从 Facebook API 获取页面 ID，然后从同一 API 获取页面的视频。

尝试在下面执行此操作。

```
<html>
<head>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
</head>
<body>
<script type="text/javascript">
var pageName = "subway";

// Gets the page ID
$.getJSON("https://graph.facebook.com/" + pageName, function(data) {
   pageId = data.id;

   // Get JSON array of videos
   $.getJSON("https://graph.facebook.com/fql?q=SELECT vid, owner, title, description, thumbnail_link, embed_html, updated_time, created_time FROM video WHERE owner=" + pageId, function(videos) {
    $.each(videos.data, function(ix, el) {
        var title = el.title;
        var description = el.description;
        var thumb = el.thumbnail_link;
        var embedPlayer = el.embed_html;

        // Do your html stuff here
        $("body").append("<div>" + title + "<br/>" + embedPlayer + "</div><br/><br/><hr/>");        
    });
   });
});
</script>
</body>
</html> 
```

# jquery - KnockoutJS 使用 Mapping Plugin 订阅属性更改

> ID：10143682
> 
> 赞同：25
> 
> 时间：2012-04-13T15:23:17.757
> 
> 标签：jquery, knockout.js, knockout-mapping-plugin

无论如何我可以告诉淘汰映射插件订阅所有属性更改调用某个函数吗？

我意识到我可以通过这种方式手动订阅属性更改事件：

```
var viewModel = {
    name: ko.observable('foo'),
}

// subscribe manually here
viewModel.name.subscribe(function(newValue){
   // do work
}) 
```

不过，我希望能够进行一般订阅，因为我的视图模型可能会有所不同，我不想对属性名称进行硬编码。我创建了一个执行此操作的函数，但它可能不是最好的方法。它适用于除 IE7 及以下版本之外的所有浏览器。

在这里，我将视图模型作为参数并尝试通过订阅属性来反映它：

```
function subscribeToKO(data) {

        $.each(data, function (property, value) {
            if (getType(value) == "Object")
                data[property] = subscribeToKO(value);
            else if (getType(value) == "Array") {
                $.each(value, function (index, item) {
                    item = subscribeToKO(item);
                });
            }
            else {
                if (value.subscribe) {
                    value.subscribe(function (newValue) {
                        // do work                                         
                    });
                }
            }
        });
        return data;
    } 
```

就像我说的那样有效，但是由于我使用的是映射插件，所以我希望有一个钩子可以用来为它提供一个通常订阅属性更改的函数。

就像是：

```
mapping = {
   create: function(options){
       options.data.subscribe(function(newValue){
            // do work ???
       });
   }
}

ko.mapping.fromJS(viewModel, mapping); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-16T02:55:16.767

这是基于[Ryan Niemeyer 的脏标志](http://www.knockmeout.net/2011/05/creating-smart-dirty-flag-in-knockoutjs.html)的通用方法。
单击此处获取 [JsFiddle](http://jsfiddle.net/GQgpX/14/)。

html:

```
<ol>
<li>
    Telephone : <input data-bind="value: telephone"/>
</li>
<li>
    Address : <input data-bind="value: address"/>
</li>
</ol>​ 
```

Javascript：

```
var model = {
    telephone: ko.observable('0294658963'),
    address: ko.observable('167 New Crest Rd')

};
// knockout extension for creating a changed flag (similar to Ryan's dirty flag except it resets itself after every change)
ko.changedFlag = function(root) {
    var result = function() {};
    var initialState = ko.observable(ko.toJSON(root));

    result.isChanged = ko.dependentObservable(function() {
        var changed = initialState() !== ko.toJSON(root);
        if (changed) result.reset();
        return changed;
    });

    result.reset = function() {
        initialState(ko.toJSON(root));
    };

    return result;
};
// add changed flag property to the model
model.changedFlag = new ko.changedFlag(model);
// subscribe to changes
model.changedFlag.isChanged.subscribe(function(isChanged) {
    if (isChanged)  alert("model changed");
});
ko.applyBindings(model);​ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T12:59:10.397

这个方便的小插件与您所做的非常接近，但它带有多个选项，并且可以满足更广泛的需求，而无需 Mapping 插件：

[https://github.com/ZiadJ/knockoutjs-reactor](https://github.com/ZiadJ/knockoutjs-reactor)

基本上它允许您编写这种代码：

```
ko.watch(viewModel, function(target, trigger) { 
    // do work
}); 
```

# c# - AggregateException 中的 TaskCanceledException 不包含堆栈跟踪

> ID：10143683
> 
> 赞同：7
> 
> 时间：2012-04-13T15:23:21.063
> 
> 标签：c#, .net-4.0, task-parallel-library, cancellation, aggregateexception

我正在使用任务并行库来运行一个任务，该任务在取消时会引发 OperationCanceledException，然后使用 AggregateException 将其捕获，如下所示。AggregateException 包含一个 TaskCanceledExceptions 列表，它们对应于抛出的异常。不幸的是，这些 TaskCanceledExceptions 似乎正在丢失原始异常引发的堆栈跟踪。这是设计使然吗？

```
try
{
    task1.Wait();
}
catch (AggregateException aggEx)
{
    var tcex = ex as TaskCanceledException;
    if (tcex != null)
    {
        Debug.WriteLine("InnerException:{0}, Message:{1}, Source:{2}, StackTrace: {3}",
            tcex.InnerException, tcex.Message, tcex.Source, tcex.StackTrace);

        return true;
    }
    else
    {
        return false;
    }
} 
```

结果：

```
InnerException:, Message:A task was canceled., Source:, StackTrace: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T18:00:52.023

我认为这是设计使然，任务取消的异常通常仅在取消任务时才抛出，以帮助任务退出。在这种情况下，堆栈跟踪有什么用途？话虽如此，我并没有深入了解设计取消例外的开发人员的思维过程，只是我的看法。

我不太确定他们丢失原始异常抛出的堆栈跟踪是什么意思？通常他们不会有内部/原始异常。也许您由于其他一些异常而取消了一项任务？在这种情况下，您应该在上游捕获“原始”异常，将其记录在那里，然后取消。

# jstree - jstree没有构建树

> ID：10143688
> 
> 赞同：3
> 
> 时间：2012-04-13T15:23:31.497
> 
> 标签：jstree

我正在尝试使用 jstree 从 xml 文件构建树。我遵循了文档，看起来它不起作用。这是我的代码：

```
<html>
<head>
    <title>Demo</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="C:\Users\jstree\jstree_pre1.0_fix_1\jquery.jstree.js"></script>
    <Script Language="JavaScript">
  $(function () {  

     $("#demo2").jstree({   

         "xml_data" : {  

             "ajax" : {  

                 "url" : "books.xml" 

             },  

             "xsl" : "nest" 

         },  

         "plugins" : [ "themes", "xml_data" ]  

     });  
     }); 

</Script>

</head>
<body>

</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:35:01.393

The XML is not formatted in a way that jsTree can include it.

[http://www.jstree.com/documentation/xml_data](http://www.jstree.com/documentation/xml_data)

Two types of XML structures are supported - flat and nested:

```
<!-- FLAT -->
<root>
    <item id="root_1" parent_id="0" state="closed">
        <content>
            <name><![CDATA[Node 1]]></name>
        </content>
    </item>
    <item id="node_2" parent_id="root_1">
        <content>
            <name><![CDATA[Node 2]]></name>
        </content>
    </item>
</root>

<!-- NESTED -->
<root>
    <item id="xml_1">
        <content><name><![CDATA[Root node 1]]></name></content>
        <item id="xml_2">
            <content><name><![CDATA[Child node 1]]></name></content>
        </item>
    </item>
</root> 
```

An alternative is to bring the XML document in and convert it into JSON, then transform it into a valid JSON or HTML data format.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T10:02:47.050

看起来容器（#demo2）不见了。尝试`<div id='demo2'></div>`在*body*标签下添加。

还要确保正确加载 jstree.js 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-25T09:32:24.200

给出一个相对路径而不是**"url" : "books.xml"**。将其替换为当前路径，例如**"url" : "../Content/Xml/books.xml"**。那可能行得通。

问候， 阿姆鲁萨

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T21:08:37.797

对于称为“语言”的脚本没有这样的属性（可能有，但已弃用）。

将您的代码放在脚本标签中，如下面的代码，然后重试

```
<script type="text/javascript">
    //Your Code Here
</script> 
```

# javascript - 使用 style.position 定位对象

> ID：10143694
> 
> 赞同：1
> 
> 时间：2012-04-13T15:24:03.667
> 
> 标签：javascript, dom

我希望能够使用按钮将对象从一个位置移动到另一个位置，例如左右和中心的 3 个按钮，每次总是将对象放在完全相同的位置。

我试过使用 style.position="absolute" 但它向左或向右移动或任何位置取决于它最后一个位置永远不会是相同的三个位置。

在这种情况下，最好使用静态、绝对、固定、相对、继承中的哪一个？是否有可能提前获得一个特定对象如何设置到特定位置的示例

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:28:29.293

`position: absolute`告诉浏览器如何定位你的元素，而不是在哪里定位你的元素。您仍然需要通过在 CSS 中设置`left`or`right`和`top`or值来定位您的元素。`bottom`

给定一些标记：

```
<button id="left">LEFT</button>
<button id="right">RIGHT</button>
<button id="center">CENTER</button>
<div id="wrapper">
    <div id="thingy"/>
</div>​ 
```

和一些风格：

```
#wrapper {
    position: relative;
    margin-top: 10px;
}

#thingy {
    margin: 0 auto;
    width: 25px;
    height: 25px;
    background-color: #f69;
}​ 
```

你可以这样移动东西：

```
var thingy = document.getElementById('thingy');

document.getElementById('left').onclick = function() {
    thingy.style.position = 'absolute';
    thingy.style.right = null;
    thingy.style.left = 0;
};

document.getElementById('right').onclick = function() {
    thingy.style.position = 'absolute';
    thingy.style.left = null;
    thingy.style.right = 0;
};

document.getElementById('center').onclick = function() {
    thingy.style.position = 'inherit';
    thingy.style.left = null;
    thingy.style.right = null;
};
​ 
```

代码发布在：http: [//jsfiddle.net/TXWfh/1/](http://jsfiddle.net/TXWfh/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:30:41.070

你可以让它与 一起工作`absolute`，但我认为 relative 可能最适合你的情况。

HTML

```
<div id="test"></div>
<input type="button" id="left" value="Left">
<input type="button" id="middle" value="Middle">
<input type="button" id="right" value="Right"> 
```

CSS

```
#test {
    position: relative;
    width: 100px;
    height: 100px;
    background-color: red;
}

input {
    padding: 4px;
} 
```

JavaScript

```
var test = document.getElementById("test");

document.getElementById("left").onclick = function() {
    test.style.left = "0px";
};

document.getElementById("middle").onclick = function() {
    test.style.left = "250px";
};

document.getElementById("right").onclick = function() {
    test.style.left = "500px";
}; 
```

[**活生生的例子**](http://jsfiddle.net/MPeeN/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:40:32.693

不知道您要做什么，但是如果您没有很多周围的 html 代码会受到您选择的位置值的影响，那真的没关系。

以下 3 个小提琴做同样的事情，但有细微的差别，它们对位置属性有不同的值。

[http://jsfiddle.net/9uQT8/3/](http://jsfiddle.net/9uQT8/3/)

[http://jsfiddle.net/9uQT8/4/](http://jsfiddle.net/9uQT8/4/)

[http://jsfiddle.net/9uQT8/5/](http://jsfiddle.net/9uQT8/5/)

尝试单击左中右。看看。不过我用的是 jQuery，超酷的 JS 框架。

# android - android谷歌地图在运行中改变

> ID：10143695
> 
> 赞同：1
> 
> 时间：2012-04-13T15:24:08.517
> 
> 标签：android, google-maps

我有一个使用谷歌地图 API 的地图视图

在我的地图中，我设计的覆盖标记很少，用于扩展 ItemizedOverlay。

我想在地图对用户可见后更改此标记可绘制图像。是否可以 ？

我的意图是运行一些延迟的可绘制加载（就像你在列表视图中所做的那样），因为我所有的图像都来自网络，我不希望用户在加载地图之前等待所有图像加载.

在列表视图上它很容易，因为线程将更新 ImageView，但在这里我不知道如何在地图加载后访问特定项目..

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:01:10.500

根据我的说法，首先加载所有虚拟图像并将其显示在地图视图上并同时启动后台任务以从服务器下载所有图像，一旦图像下载过程完成，只需清除地图视图上的所有叠加层并重新加载实际下载的图像地图视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T12:13:27.960

查看 OverlayItem 中的函数 setMarker。它可以让您更改特定标记的图像。只需确保在设置图像之前将其居中绑定即可。

[叠加项目](http://code.google.com/android/add-ons/google-apis/reference/com/google/android/maps/OverlayItem.html)

# php - 如何将我的 php 代码（使用 SyntaxHighlight ）转换为图像（如 jpeg 或 png）

> ID：10143696
> 
> 赞同：-3
> 
> 时间：2012-04-13T15:24:12.057
> 
> 标签：php

我想与我的朋友分享我的 php 源代码，但我不希望他们复制或修改代码所以.. 我想将我的源代码（使用 SyntaxHighlight）转换为我硬盘中的图像（如 png 或 jpeg）可以任何有人告诉我有开源项目可以帮助我吗？谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:26:37.407

大概您有以 HTML 格式突出显示的代码，在这种情况下，您实际上正在寻找一种将 HTML 转换为图像的方法。这正是[wkhtmltoimage](http://code.google.com/p/wkhtmltopdf/)所做的。

# bash - 变量中的空格

> ID：10143700
> 
> 赞同：2
> 
> 时间：2012-04-13T15:24:21.717
> 
> 标签：bash, ffmpeg

我在变量中遇到一些空格问题：

```
ALBUM=' -metadata album="Peregrinações Alheias"' 
```

这个命令：

```
ffmpeg -i $R_IMG -r 1 -b 1800 -i $SOUND -acodec libmp3lame -ab 128k "$ALBUM" -y $OUT 
```

回报：

```
Unable to find a suitable output format for ' -metadata album="Peregrinações Alheias"' 
```

如果我从变量中取出“”：

```
ffmpeg -i $R_IMG -r 1 -b 1800 -i $SOUND -acodec libmp3lame -ab 128k $ALBUM -y $OUT 
```

回报：

```
Unable to find a suitable output format for 'Alheias"' 
```

而且我确信我在 bash sintax 中遗漏了一些东西......

* * *

**更新：**

所以看起来问题不在于空格，而在于“-metadata”参数......

问题是我有很多元数据，我想把它们放在一个变量中。像这样：

`META=' -metadata album="Peregrinações" -metadata title="Passeio ao PETAR" -metadata author="Rogério Madureira" -metadata date="2012" -metadata description="Áudio de um passeio ao PETAR" -metadata comment="Áudio capturado com TACAM DR-07MKII e Foto capturada com Canon PowerShot S5IS" '`

接着：

`ffmpeg -i $R_IMG -r 1 -b 1800 -i $SOUND -acodec libmp3lame -ab 128k $META -y $OUT`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:29:29.083

Bash 将引号中的单词解释为单个参数。尝试

```
ALBUM='album="Peregrinações Alheias"'
ffmpeg -i $R_IMG -r 1 -b 1800 -i $SOUND \
  -acodec libmp3lame -ab 128k -metadata "$ALBUM" -y $OUT 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T15:29:38.567

[而是将您的命令放入数组中。](http://mywiki.wooledge.org/BashFAQ/050)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T15:32:05.757

```
ALBUM='album=Peregrinações Alheias'

ffmpeg -i $R_IMG -r 1 -b 1800 -i $SOUND -acodec libmp3lame -ab 128k -metadata "$ALBUM" -y $OUT 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T15:37:10.923

如果你总是想设置`ALBUM`，那么亚当的回答是可以的。但是如果你想有*选择地*设置`ALBUM`然后使用这个：

```
ALBUM="Peregrinações Alheias"
TITLE="Passeio ao PETAR"
OPTIONAL=
ffmpeg -i $R_IMG -r 1 -b 1800 -i $SOUND \
    -acodec libmp3lame -ab 128k \
     ${ALBUM:+-metadata album="$ALBUM"} \
     ${TITLE:+-metadata title="$TITLE"} \
     ${OPTIONAL:+-metadata optional="$OPTIONAL"} \
    -y $OUT 
```

未设置时省略`ALBUM`完整`${var:+subst}`块。其他变量当然是一样的-

当然，*如果*您要设置一组固定的数据，这可以扩展到多个`-metadata`选项。

 ** * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-13T17:00:34.537

使用`eval`可以做你想做的事情......根据你在`$R_IMG`,`$SOUND`和中的内容`$OUT`，他们可能需要双引号转义，例如。`\"$SOUND\"`……

您的`$META`（我认为这是您最初名为 $ALBUM 的另一个名称）不需要像这样布置，但它肯定对（我）有帮助......只是空格，就像在您的原始作品中一样。

```
META='
-metadata album="Peregrinações"
-metadata title="Passeio ao PETAR"
-metadata author="Rogério Madureira"
-metadata date="2012"
-metadata description="Áudio de um passeio ao PETAR"
-metadata comment="Áudio capturado com TACAM DR-07MKII e Foto capturada com Canon PowerShot S5IS"
'; META="$(echo "$META" |sed 's|"|\\\\"|g' |tr '\n' ' ')" 

eval "ffmpeg -i $R_IMG -r 1 -b 1800 -i $SOUND -acodec libmp3lame -ab 128k $META -y $OUT" 
```

* * *

如果您不想使用`sed`转换线，您只需将每个更改为`"`如下示例所示： `$META``\\"`

```
META=' -metadata album=\\"Peregrinações\\" -metadata title=\\"Passeio ao PETAR\\" -metadata author=\\"Rogério Madureira\\" -metadata date=\\"2012\\" -metadata description=\\"Áudio de um passeio ao PETAR\\" -metadata comment=\\"Áudio capturado com TACAM DR-07MKII e Foto capturada com Canon PowerShot S5IS" '
eval "ffmpeg -i $R_IMG -r 1 -b 1800 -i $SOUND -acodec libmp3lame -ab 128k $META -y $OUT" 
```

* * *

我已经使用以下`ffmpeg`编码参数成功测试了它：

```
eval "ffmpeg -i ~/input.flv -sameq -acodec libmp3lame -ab 128k $META -y ~/output.mp3" 
```*

# django - 尝试将 Django 自定义过滤器加载到模板中时出错

> ID：10143703
> 
> 赞同：1
> 
> 时间：2012-04-13T15:24:40.383
> 
> 标签：django, django-templates, django-template-filters

我继承了一个 Django 应用程序，我需要使用自定义模板过滤器对其进行修改。我对 Django 完全陌生，对此我感到非常困惑。我以为我完全按照说明进行了操作，并且还遵循了其他帖子中有关该主题的所有建议，但是当我在模板中包含以下行时仍然出现错误：

```
{% load mlgb_custom_filters %} 
```

我的目录结构如下：

```
mysite (i.e. the project)    
    __init__.py    
    mlgb/ (i.e. the app)    
      __init__.py    
      templatetags/    
          __init__.py    
          mlgb_custom_filters.py 
```

mlgb_custom_filters.py 的代码如下：

```
from django import template    
from django.template.defaultfilters import stringfilter    
register = template.Library()    
@register.filter(name='fix_dashes')    
@stringfilter    
def fix_dashes( value ):    
    return value.replace( '--', 'DASH' )    
if __name__ == "__main__":    
    testvar = fix_dashes( "ouch -- ow -- I hate django" )    
    print testvar 
```

如您所见，我添加了一个 'name = main' 部分，让我在独立模式下运行它，只是为了检查该特定文件中没有错误，并且在独立模式下运行时很好。

根据其他人的建议，我也尝试将其导入另一个文件，只是为了查看是否存在导入错误，再一次，如果我将其添加到 settings.py 的末尾就可以了（在使用 dev服务器）：

尝试：导入 mlgb.templatetags.mlgb_custom_filters 例外，exc: print 'error importing mlgb_custom_filters' print exc

此外，settings.py 中的 INSTALLED_APPS 包含“mysite.mlgb”行，我还尝试在其中放置“mlgb”而不是“mysite.mlgb”，正如另一个人所建议的那样。每次进行更改时，我都会重新启动开发服务器。

到目前为止，我想我已经尝试了我在网上找到的每一个建议。有没有人有任何新的想法？我继承了一个目录结构，其中模板目录与应用程序不在同一结构内，即它不在 mysite 下，这可能与此有关吗？在这里刮桶寻找想法！我希望有人能帮帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:09:18.473

好的，在我第一次发布这个问题时的情况下，似乎我真正需要做的就是触摸`wsgi`我`appname/apache`目录下的文件以强制刷新应用程序。昨天的初步回答是红鲱鱼。基本上我应该碰过文件`myproject/myapp/apache/myapp.wsgi`。然后也许重新启动Apache以获得良好的效果？但是造成混淆的原因是，显然仅仅重新启动 Apache 或手动重新编译 Python 是不够的。为了获取我的更改，似乎我需要触摸那个 wsgi 文件。那么一切都很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T10:35:21.050

在我的同事 Masud Khokhar 的帮助下，我现在可以发布自己的问题的答案，他出色的侦探工作挽救了这一天。回顾一下，我的应用程序运行良好，直到我将“加载”语句添加到我的模板文件之一，以加载“自定义过滤器”模块。Masud 发现现在我需要在 urls.py 中使用模板文件的完整/绝对路径，而不是像以前那样使用相对路径（并且以前可以使用，直到它需要加载自定义过滤器模块）。因此，在 urls.py 中，我有一段代码如下：

```
 url(r'^book/(?P<object_id>\d+)/$', 'list_detail.object_detail',
     kwargs={
        'queryset':Book.objects.all(),
        'template_name' : 'mlgb/mlgb_detail.html'
     },
     name='mlgb_detail'
 ), 
```

而不是这个：

```
 'template_name' : 'mlgb/mlgb_detail.html' 
```

我需要这样的东西：

```
 'template_name' : '/THE_FULL_PATH/mlgb/templates/mlgb/mlgb_detail.html' 
```

做出改变 - 排序！再次感谢你，马苏德。

# jquery - jQuery - 没有动画的 ScrollTop

> ID：10143706
> 
> 赞同：29
> 
> 时间：2012-04-13T15:24:51.480
> 
> 标签：jquery, animation, scroll, scrolltop

如何在没有动画的情况下使用滚动条

此代码有效：

```
var offTop = $('#box').offset().top;
offTop  = offTop-43;
$('#mainCt').animate({scrollTop: '+=' + offTop + 'px'}, 400); 
```

这是我的（不工作的解决方案）：

```
$("#mainCt").scrollTop('+=' + offTop + 'px');                 // doesn't work
$("#mainCt").scrollTop('+='+offTop);                          // doesn't work
hhh = setTimeout(' $("#mainCt").scrollTop('+offTop+');',800); // doesn't work 
```

**演示**
[http://jsfiddle.net/DNNFF/9/](http://jsfiddle.net/DNNFF/9/)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-13T15:27:25.470

试试这个：

```
var offTop = $('#box').offset().top - 43;
$('#mainCt').scrollTop(offTop); 
```

该`scrollTop`属性只接受一个整数，不需要后缀或单位。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-04-16T22:11:37.767

也许如果您不想要动画或任何花哨的东西，只需使用锚点

```
<a name="top"></a> 
```

把它放在你需要滚动的地方

在你调用 use 的函数中

```
document.location.href="#top"; 
```

您还可以创建一个函数以在元素之前附加锚点，执行此操作`document.location`，然后删除该锚点。

[http://jsfiddle.net/fSrxr/1/](http://jsfiddle.net/fSrxr/1/)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-01-20T00:23:35.087

跳过 jQuery。只需使用 JavaScript：

```
window.scroll(0, 0); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-04-13T15:28:12.843

[http://api.jquery.com/scrollTop/](http://api.jquery.com/scrollTop/)

```
$(window).scrollTop(offTop) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-18T04:25:28.473

为什么不用更短的时间使用它。我摆弄它，它没有动画。因为没有时间看动画，所以根本就没有动画。

```
var offTop = $('#box').offset().top;
offTop  = offTop-43;
$('#mainCt').animate({scrollTop: '+=' + offTop + 'px'}, 50); //50 added here as duartion 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-13T15:29:21.337

你不能玩持续时间吗？

```
var offTop = $('#box').offset().top;
offTop  = offTop-43;
$('#mainCt').delay('800').animate({scrollTop: '+=' + offTop + 'px'}, 1); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-22T09:16:53.010

**使用jQuery**在刷新页面上保持位置的演示：

```
//------KEEP SCROLL POSITION
        $(window).scroll(function () {
            sessionStorage.scrollTop = $(this).scrollTop();
        });
        $(document).ready(function () {
            if (sessionStorage.scrollTop != "undefined") {
                setTimeout(() => window.scrollTo({
                    top: sessionStorage.scrollTop,
                    left: 0,
                    behavior: 'auto'
                }), 5);
            }
        }); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-05-09T06:11:46.170

```
var offTop = $('#box').offset().top;
$(window).scrollTop(parseInt(offTop)) 
```

# amazon-s3 - 从 Amazon S3 下载资产的速度取决于哪些因素？

> ID：10143710
> 
> 赞同：3
> 
> 时间：2012-04-13T15:25:00.717
> 
> 标签：amazon-s3, amazon-web-services, data-transfer

我们从 Amazon S3 下载文件的速度有多快，是否有上限（并且它们在来自同一用户的所有请求之间分配），还是仅取决于我的 Internet 连接下载速度？我在他们的 SLA 中找不到它。

它还取决于哪些其他因素？他们是否会在一定程度上限制数据传输速率以防止滥用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:42:14.553

这已在最近的[Amazon S3](http://aws.amazon.com/s3/)团队发布的[Amazon S3 性能提示和技巧](http://aws.typepad.com/aws/2012/03/amazon-s3-performance-tips-tricks-seattle-hiring-event.html)中得到解决：

> **第一：对于较小的工作负载（每秒总请求数<50），以下都不适用，无论有多少对象！**S3 有一堆在幕后工作的自动化代理，以平滑整个系统的负载，以确保无数不同的工作负载都公平、快速地共享 S3 的资源。即使是每秒偶尔爆发超过 100 个请求的工作负载，实际上也不需要向我们提供任何关于即将发生的事情的提示……**我们旨在永远增长和支持这些工作负载。**S3 是一个真正的横向扩展设计。
> 
> **S3 可扩展到远大于此的短期和长期工作负载。我们有客户每天一整天都在不断地每秒对 S3 执行数千个请求。**[...] 我们通过我们的高级开发人员支持产品与其他客户合作，帮助他们设计一个基本上可以在 S3 上无限扩展的系统。今天，我们将发布该指南以造福所有人。
> 
> *[强调我的]*

您可能希望阅读整篇文章，以更深入地了解 S3 架构以及真正*庞大的工作负载*所带来的挑战（即，正如 S3 团队所强调的，它根本不适用于大多数用例）。

# objective-c - firemonkey + xcode，混合代码

> ID：10143713
> 
> 赞同：2
> 
> 时间：2012-04-13T15:25:13.977
> 
> 标签：objective-c, delphi, delphi-xe2

使用 Delphi XE2，我们可以将源代码导出到 xcode 并使用免费的 pascal 编译器进行编译。但是我见过的所有示例都不会在 xcode 中修改 .pas 文件，只需导出并运行即可。

我想知道是否可以将任何 delphi 单元或库添加到 Objective C 应用程序中并将它们一起编译？如何将 .pas 单元包含到 .xcodeproj 中？

我希望将delphi应用程序移植到iOS，导出所有项目是不可能的，在原生ObjectiveC中为iOS制作GUI并从delphi单元导入逻辑和方法似乎是个好主意。可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T19:09:11.820

由于 Delphi XE2 在面向 iOS 时使用的是[Free Pascal 编译器](http://freepascal.org/)，因此您可以使用 FPC 的任何编程技术。

事实上，如果您不需要 FireMonkey，并且更喜欢使用原生用户界面，那么您根本不需要 Delphi XE2！

您可以使用免费的 FPC 从 XCode 编译您的应用程序。

最好的参考网站是[http://web.me.com/macpgmr/ObjP](http://web.me.com/macpgmr/ObjP)

特别是，[“使用 Objective Pascal 进行开发”文章](http://web.me.com/macpgmr/ObjP/Xcode4/)正是您正在寻找的内容：

*   在 XCode 中开发 UI；
*   使用 FPC 在 Pascal 中编写您的业务逻辑；
*   适用于 Max OSX 和 iOS。

只看[介绍页面](http://web.me.com/macpgmr/ObjP/Xcode4/ObjP_Part1.html)，我怀疑你会像我一样感到惊讶。

从我的观点来看，与 FPC 一起使用的“Object Pascal”范式（即 object pascal“方言”，可以与默认的 object pascal 代码共存）比 Delphi XE2 编译器的基于接口的“管道”更高级、轻量级和集成（使用 RTTI 进行动态编组）。这可能是一个品味问题......

# asp.net - 在 asp.net 处理程序中访问会话

> ID：10143719
> 
> 赞同：3
> 
> 时间：2012-04-13T15:25:45.340
> 
> 标签：asp.net, vb.net, session, handler

我正在尝试使用通用处理程序上传图像，如下所示，我有一个普通的 aspx 页面，上传后显示所有上传的图像。一切正常。

```
<%@ WebHandler Language="VB" Class="Upload"%>

Imports System
Imports System.Web
Imports System.Threading 
Imports System.Web.Script.Serialization
Imports System.IO

Public Class Upload : Implements IHttpHandler, System.Web.SessionState.IRequiresSessionState 
    Public Class FilesStatus
        Public Property thumbnail_url() As String
        Public Property name() As String
        Public Property url() As String
        Public Property size() As Integer
        Public Property type() As String
        Public Property delete_url() As String
        Public Property delete_type() As String
        Public Property [error]() As String
        Public Property progress() As String
    End Class
    Private ReadOnly js As New JavaScriptSerializer()
    Private ingestPath As String

    Public Sub ProcessRequest(ByVal context As HttpContext) Implements IHttpHandler.ProcessRequest

            Dim r = context.Response
            ingestPath = context.Server.MapPath("~/UploadedImages/")

            r.AddHeader("Pragma", "no-cache")
            r.AddHeader("Cache-Control", "private, no-cache")

            HandleMethod(context)
    End Sub
    Private Sub HandleMethod(ByVal context As HttpContext)
        Select Case context.Request.HttpMethod
            Case "HEAD", "GET"
                ServeFile(context)

            Case "POST"
                UploadFile(context)

            Case "DELETE"
                DeleteFile(context)

            Case Else
                context.Response.ClearHeaders()
                context.Response.StatusCode = 405
        End Select
    End Sub
    Private Sub DeleteFile(ByVal context As HttpContext)
        Dim filePath = ingestPath & context.Request("f")
        If File.Exists(filePath) Then
            File.Delete(filePath)
        End If
    End Sub
    Private Sub ServeFile(ByVal context As HttpContext)
        If String.IsNullOrEmpty(context.Request("f")) Then
            ListCurrentFiles(context)
        Else
            DeliverFile(context)
        End If
    End Sub

    Private Sub UploadFile(ByVal context As HttpContext)
        Dim statuses = New List(Of FilesStatus)()
        Dim headers = context.Request.Headers

        If String.IsNullOrEmpty(headers("X-File-Name")) Then
            UploadWholeFile(context, statuses)
        Else
            UploadPartialFile(headers("X-File-Name"), context, statuses)
        End If

        WriteJsonIframeSafe(context, statuses)
    End Sub

    Private Sub UploadPartialFile(ByVal fileName As String, ByVal context As HttpContext, ByVal statuses As List(Of FilesStatus))
        If context.Request.Files.Count <> 1 Then
            Throw New HttpRequestValidationException("Attempt to upload chunked file containing more than one fragment per request")
        End If
        Dim inputStream = context.Request.Files(0).InputStream
        Dim fullName = ingestPath & Path.GetFileName(fileName)

        Using fs = New FileStream(fullName, FileMode.Append, FileAccess.Write)
            Dim buffer = New Byte(1023) {}

            Dim l = inputStream.Read(buffer, 0, 1024)
            Do While l > 0
                fs.Write(buffer, 0, l)
                l = inputStream.Read(buffer, 0, 1024)
            Loop
            fs.Flush()
            fs.Close()
        End Using

        statuses.Add(New FilesStatus With {.thumbnail_url = "Thumbnail.ashx?f=" & fileName, .url = "Upload.ashx?f=" & fileName, .name = fileName, .size = CInt((New FileInfo(fullName)).Length), .type = "image/png", .delete_url = "Upload.ashx?f=" & fileName, .delete_type = "DELETE", .progress = "1.0"})

    End Sub

    Private Sub UploadWholeFile(ByVal context As HttpContext, ByVal statuses As List(Of FilesStatus))
        For i As Integer = 0 To context.Request.Files.Count - 1
            Dim file = context.Request.Files(i)
            file.SaveAs(ingestPath & Path.GetFileName(file.FileName))
            Thread.Sleep(1000)
            Dim fname = Path.GetFileName(file.FileName)
            statuses.Add(New FilesStatus With {.thumbnail_url = "Thumbnail.ashx?f=" & fname, .url = "Upload.ashx?f=" & fname, .name = fname, .size = file.ContentLength, .type = "image/png", .delete_url = "Upload.ashx?f=" & fname, .delete_type = "DELETE", .progress = "1.0"})
        Next i
    End Sub

    Private Sub WriteJsonIframeSafe(ByVal context As HttpContext, ByVal statuses As List(Of FilesStatus))
        context.Response.AddHeader("Vary", "Accept")
        Try
            If context.Request("HTTP_ACCEPT").Contains("application/json") Then
                context.Response.ContentType = "application/json"
            Else
                context.Response.ContentType = "text/plain"
            End If
        Catch
            context.Response.ContentType = "text/plain"
        End Try

        Dim jsonObj = js.Serialize(statuses.ToArray())
        context.Response.Write(jsonObj)
    End Sub
    Private Sub DeliverFile(ByVal context As HttpContext)
        Dim filePath = ingestPath & context.Request("f")
        If File.Exists(filePath) Then
            context.Response.ContentType = "application/octet-stream"
            context.Response.WriteFile(filePath)
            context.Response.AddHeader("Content-Disposition", "attachment, filename=""" & context.Request("f") & """")
        Else
            context.Response.StatusCode = 404
        End If
    End Sub
    Private Sub ListCurrentFiles(ByVal context As HttpContext)
        Dim files = New List(Of FilesStatus)()

        Dim names = Directory.GetFiles(context.Server.MapPath("~/UploadedImages/"), "*", SearchOption.TopDirectoryOnly)

        For Each name In names
            Dim f = New FileInfo(name)
            files.Add(New FilesStatus With {.thumbnail_url = "Thumbnail.ashx?f=" & f.Name, .url = "Upload.ashx?f=" & f.Name, .name = f.Name, .size = CInt(f.Length), .type = "image/png", .delete_url = "Upload.ashx?f=" & f.Name, .delete_type = "DELETE"})
        Next name

        context.Response.AddHeader("Content-Disposition", "inline, filename=""files.json""")
        Dim jsonObj = js.Serialize(files.ToArray())
        context.Response.Write(jsonObj)
        context.Response.ContentType = "application/json"
    End Sub
    Public ReadOnly Property IsReusable() As Boolean Implements IHttpHandler.IsReusable
        Get
            Return False
        End Get
    End Property

End Class 
```

现在我想通过生成一个随机字符串来添加一个会话变量，并将上传的图像添加到新创建的随机字符串中。

1.我已经在 SO 上看到了这个用于会话的[问题](http://System.Web.SessionState.IRequiresSessionState)`System.Web.SessionState.IRequiresSessionState` ，以及我如何使用它并将我的图像添加到该文件夹​​中，然后我如何`create`在我的页面中使用这个会话变量。`folder``access``normal` `aspx`

2.（或）更好的方法是在 aspx 页面中创建会话变量并将其传递给处理程序？如果是这样我该怎么做？

3 .我试图从我的处理程序中找到控件。这可能吗？如果有人知道如何得到这个，那么我的问题也将得到解决，因此我试图从 m aspx 页面创建一个会话。

谁能解释处理这种情况的更好方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T16:58:11.310

我完全同意`jbl`的评论。

1.  您可以使用项目中的任何位置获取和设置会话`HttpContext.Current.Session`。
2.  无论您在哪里创建会话。只需在访问之前确保会话存在即可。
3.  不知道你到底在问什么（需要更多解释）。

[这是一个示例](http://www.naveenbhat.in/2012/06/directory-security-on-webservice-with.html)，我在 HttpHandler 上使用了会话。但是，它是在 c# 上的（希望你能理解）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T06:45:10.087

这不是一个真正的答案，但@Knvn 写了一个我无法理解的 C# 示例，因此我使用转换器将其转换为 VB。把它贴在这里以防将来对某人有帮助。

```
Public Class HttpHandler
    Implements IHttpHandler
    Implements IRequiresSessionState
    Public Sub New()
    End Sub

    Public Sub ProcessRequest(context As HttpContext)
        Dim Request As HttpRequest = context.Request
        Dim Response As HttpResponse = context.Response

        If SessionHandler.Current.UserID = 0 Then
            Response.Redirect("~/Default.aspx")
        Else
            Try
                If Request.Path.EndsWith(".pdf") Then
                    Dim client As New WebClient()
                    Dim buffer As [Byte]() = client.DownloadData(HttpContext.Current.Server.MapPath(Request.Path))
                    Response.ContentType = "application/pdf"
                    Response.AddHeader("content-length", buffer.Length.ToString())
                    Response.BinaryWrite(buffer)
                Else
                    Using reader As New StreamReader(HttpContext.Current.Server.MapPath(Request.Path))
                        Response.Write(reader.ReadToEnd())
                    End Using
                End If
            Catch
                Response.Redirect("~/Default.aspx")
            End Try
        End If
    End Sub

    Public ReadOnly Property IsReusable() As Boolean
        ' To enable pooling, return true here.
        ' This keeps the handler in memory.
        Get
            Return False
        End Get
    End Property
End Class 
```

# android - android手机和笔记本电脑之间有通信吗？

> ID：10143724
> 
> 赞同：1
> 
> 时间：2012-04-13T15:25:50.777
> 
> 标签：android, communication, android-wifi

我的项目基于客户端-服务器架构，其中笔记本电脑是我的服务器，我的 Android 智能手机（三星 Galaxy）是我的客户端。

所以，我想知道的是：“如何使用 WiFi 或任何其他方法在这两个设备之间创建通信通道？”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:56:34.687

我想到的第一种方法是使用[Socket Communication](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/Socket.html)。

如果您不了解 Socket 通信的方式，我建议您在开始项目之前进行一些研究。

首先在你的PC上创建一个虚拟服务器和虚拟客户端并让它们通信，此时传输的信息并不重要，简单的字符串就可以了。

完成此操作后，将代码从 PC 客户端传输到您的手机，这应该很容易做到，因为它们应该工作相同。

初学者套接字教程的“Google-ing”应该让您立即开始。

希望这会有所帮助，如果您以后遇到任何问题，我相信社区会非常有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T16:39:06.637

您应该首先在android模拟器上开发和测试项目。对于简单的通信，您可以使用httppost或httpget。

# c# - GridView - 从与呈现的网格匹配的 Ajax 调用中添加格式化的子行

> ID：10143725
> 
> 赞同：1
> 
> 时间：2012-04-13T15:25:53.420
> 
> 标签：c#, asp.net, .net-4.0, webforms, ajax.net

我有一个带有相当大的 GridView 的 asp.net webforms 站点。GridView 是从过滤的数据对象列表中呈现的。

一些数据对象具有相同类型的子对象。

在我的 GridView 中，我最初只显示父对象。我希望能够通过 Ajax 调用扩展父对象以显示子对象，并在父对象下插入新行。

问题是，它们需要遵循与父级相同的格式和呈现规则，并适合所有其他现有行。这意味着新子节点的所有列都需要适合渲染网格的其余列。

如果可能的话，我还想重新使用现有的 GridView 渲染方法，这样我就不必维护本质上做同样事情的重复代码。

我可以轻松地使用 AjaxControlToolkit 中的 DynamicPopulateExtender 来调用 Web 服务以获取子行，但这并不容易为我提供适合已呈现的 GridView 表的呈现和格式化的 HTML。

有没有办法让它正常工作，或者我应该用不同的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T16:22:24.783

进行 Ajax 调用并使用 jQuery 插入数据，可能使用[jsRender](https://github.com/BorisMoore/jsrender)之类的模板引擎来合并数据。对 gridview 和模板使用相同的 css 类以保持您想要的统一外观。

# javascript - 如何在 KendoUI 条形图中使条形变为不同颜色？

> ID：10143726
> 
> 赞同：12
> 
> 时间：2012-04-13T15:25:56.697
> 
> 标签：javascript, jquery, asp.net, telerik, kendo-ui

我正在用 KendoUI 替换我的点网图表。我正在显示一个分数分布图。我希望所有条形图的颜色都相同，除了具有中值分数和图例的条形图。如何为单个条着色独特的颜色？我如何为 Legend 上色这种新颜色？

下面是我的旧 dotnet 图表条形图，下面是我试图替换它的新 KendoUI 图表。我只需要把颜色弄对，我们就可以做生意了。任何帮助表示赞赏。

![在此处输入图像描述](../Images/f36a4ff49d4d2464e22be540815859ea.png)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-16T16:01:59.920

更新：我将保留此行下方的答案，以防有人使用旧版本，但[根据稍后的评论](https://stackoverflow.com/a/12472084/1336699)，KendoUI 现在允许您覆盖系列中各个点的样式。

* * *

我不相信你可以，在当前版本中。也就是说，您可以绕过限制。

您需要创建两个数据系列 - 一个用于突出显示的数据，一个用于其他所有数据。将两者都添加到您的图表中，并将它们设置为堆叠。

这是我放在一起来说明的 jsFiddle：http: [//jsfiddle.net/LyndsySimon/9VZdS/](http://jsfiddle.net/LyndsySimon/9VZdS/)。这取决于 KendoUI 的 CDN，因此如果将来出现故障，我深表歉意。

这是供参考的Javascript：

```
$(function() {
    var dataset = new Array(1,2,3,null,5,6);
    var highlighted = new Array(null,null,null,4,null,null);

    $('#chart').kendoChart({
        theme: 'metro',
        seriesDefaults: {
            type: 'column',
            stack: true
        },
        series: [
            {
                name: 'Not Highlighted',
                data: dataset,
                color: '#609'
            },
            {
                name: 'Highlighted',
                data: highlighted,
                color: '#f03'
            }
        ]
    })
});​ 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-18T07:13:44.087

从 2012 Q2 版本开始，条形系列支持将点颜色绑定到数据项字段。

这是通过[colorField 选项](http://docs.kendoui.com/api/dataviz/chart#seriestype=%22bar%22colorfield-string)完成的。[绑定到本地数据](http://demos.kendoui.com/dataviz/bar-charts/local-data.html)在线示例演示了它。

Kendo UI 和 ASP.NET MVC 的旧包装器都将其作为一个选项公开：

```
.Series(series =>
{
    series.Bar(model => model.Value, model => model.Color)
        .Name("United States");
}) 
```

所有系列重载都可以在[这里](http://docs.kendoui.com/api/wrappers/aspnet-mvc/Kendo.Mvc.UI.Fluent/ChartSeriesFactory)看到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T10:00:58.193

您可以破解系统生成的 SVG。我为图表提供了一个模型，其中包含每个条的颜色。例如：

```
public class Model
{
    public int Id { get; set; }
    public string Name { get; set; }
    public string Code { get; set; }
    public string Colour { get; set; }
    public decimal Score { get; set; }
} 
```

用作图表上的系列。然后视图如下所示：

```
@(Html.Telerik().Chart(Model)
    .Name("AverageScores")
    .Theme("Simple")
    .HtmlAttributes(new {style = "height: 500px"})
    .Series(series => series.Column(s => s.Score).Name("Name").Color("Blue"))
    .SeriesDefaults(sd => sd.Column().Labels(l =>
                                                 {
                                                     l.Visible(true);
                                                     l.Format("{0}%");
                                                 }))
    .Title("Mean Percentage Scores")
    .Legend(builder =>
                {
                    builder.Position(ChartLegendPosition.Bottom);
                    builder.Visible(false);
                })
    .CategoryAxis(ca => ca.Categories(x => x.Code))
    .Tooltip(builder =>
                 {
                     builder.Visible(true);
                     builder.Format("{0}%");
                     builder.Template("<#= dataItem.Name #><br/><#= value #>%");
                 })
    .ValueAxis(va => va.Numeric().Labels(a => a.Format("{0}%")).Min(0).Max(100)
    )
)

@section BelowTelerikScriptRegistrar
{
 <script type="text/javascript">

    function setAverageScoresColours() {
        var data = $('#AverageScores').data("tChart").options.series[0].dataItems;
        if (data != null) {
            for (var i = 0; i < data.length; i++) {
                var averageScore = data[i];
                $($($('div#AverageScores svg g')[i]).children('path')[0]).attr('fill', '#' + averageScore.Colour);
                $($($('div#AverageScores svg g')[i]).children('path')[0]).attr('stroke', '#' + averageScore.Colour);
            }
        }
    }

     $(document).ready(function () {
         setAverageScoresColours();
     })
 </script>
} 
```

BeyondTelerikScriptRegistrar 部分必须在调用 Html.Telerik().ScriptRegistrar() 之后发生。

这适用于 Chrome、Firefox 和 IE10。我注意到多个图表和生成 SVG 的时间存在问题。不幸的是，您可能必须将 setAverageScoresColours() 包装在 setTimeout 函数中以确保已生成 SVG，但它似乎只适用于一个图表。

有点hacky，但比管理大量系列更容易。

对于 KendoUI（我已经编辑过......）：

```
<div class="chart-wrapper">
    <div id="chart"></div>
</div>

 <script>
 function createChart() {
     $("#chart").kendoChart({
         theme: $(document).data("kendoSkin") || "default",
         title: {
             text: "Internet Users"
         },
         legend: {
             position: "bottom"
         },
         seriesDefaults: {
             type: "column"
         },
         series: [{
             name: "World",
             data: [15.7, 16.7, 20, 23.5, 26.6]
         }],
         valueAxis: {
             labels: {
                 format: "{0}%"
             }
         },
         categoryAxis: {
             categories: [2005, 2006, 2007, 2008, 2009]
         },
         tooltip: {
             visible: true,
             format: "{0}%"
         }
     });
 }

 $(document).ready(function () {
     setTimeout(function () {
         // Initialize the chart with a delay to make sure
         // the initial animation is visible
         createChart();
         $($($('div#chart svg g')[0]).children('path')[0]).attr('fill', '#123');
         $($($('div#chart svg g')[1]).children('path')[0]).attr('fill', '#321');
         $($($('div#chart svg g')[2]).children('path')[0]).attr('fill', '#213');
         $($($('div#chart svg g')[3]).children('path')[0]).attr('fill', '#312');
         $($($('div#chart svg g')[4]).children('path')[0]).attr('fill', '#132');
     }, 400);
 });
</script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-11T10:34:03.963

您可以在运行时执行此操作的另一种方法是使用返回颜色的函数。

[API 参考](http://docs.telerik.com/KENDO-UI/api/javascript/dataviz/ui/chart#configuration-series.color)

这是一个示例代码：

```
<div id="chart"></div>
<script>
$("#chart").kendoChart({
  series: [{
    data: [1, 2],
    color: function(point) {
      if (point.value > 1) {
        return "red";
      }

      // use the default series theme color
    }
  }]
});
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-16T16:03:02.167

当前的 KendoUI 版本目前无法做到这一点。

它在他们的待办事项清单上。

[http://www.kendoui.c​​om/forums/dataviz/chart/change-bar-column-color-for-each-point.aspx](http://www.kendoui.com/forums/dataviz/chart/change-bar-column-color-for-each-point.aspx)

可以有一种解决方法，正如我在此处放置的线程中所说，它是为您需要的每种颜色描述一个系列。对我来说它看起来效率很低，但这是目前唯一的方法。如果你只有一张图表，你可以做到。否则，请等待具有此功能的新版本 KendoUI。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-26T16:22:38.210

Telerik 最近发布了一个 Kendo UI Data Vis Theme Roller

[http://demos.kendoui.c​​om/themebuilder/dataviz.html](http://demos.kendoui.com/themebuilder/dataviz.html)

# html - 当我单击jsp中的超链接时如何将listid传递给servlet

> ID：10143729
> 
> 赞同：0
> 
> 时间：2012-04-13T15:26:01.493
> 
> 标签：html

我有一个显示在 html 表中的项目列表，其中每一行都有一个超链接。

当我单击超链接时，我想使用该特定项目 ID 调用 servlet。

我怎样才能实现它？

10 个项目。

```
 <tr>
      <td>
        <input type="hidden" name="" value="%=request.getAttribute("item_id")%>"
      </td>
      <td align="center">
        <font> (String)providerDetail.get("tripTime")<font />
      </td>
      <td align="center">
        <font>(String) providerDetail.get("noOfSeats")</font>
      <td align="center">
        <font> <a href="./selectprovider"> Select font </a></font>
      </td>
    </tr> 
```

结束

因此，当我单击超链接时，我需要将适当的 item_id 传递给 servlet。如何为正在运行的 item_id 提供适当的输入元素并将其传递给 servlet？

我无法添加 html 元素，因为它的格式不正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:40:49.540

假设您使用 ajax，`onclick`调用 javascript 方法，将 item_id 作为参数传递给该方法。

然后将其作为数据发送到您的服务器（我正在使用 jQuery 来执行此操作，您可以使用任何其他库）

```
function sendData(item_id){
    jQuery.ajax({
      type:"POST",
      data:"itemId="+item_id,
      success: function(data){
       //Your code for a successful request goes here.
      },
      error: function(data){
        //Errors treatment goes here.
      }
    })
} 
```

如果您正在执行诸如基于项目 ID 下载文档之类的操作，这是一个很好的示例代码：

```
var form = '<form action="downloadme"><input type="hidden" name="itemid" value='+item_id+'</form>';
jQuery(form).submit(); 
```

创建一个表单并提交它，并作为隐藏参数传递 item_id。完成后从正文中删除该表格（因为您不再需要它了）。

希望这可以帮助。

# android - Android 最佳缓冲区大小

> ID：10143731
> 
> 赞同：16
> 
> 时间：2012-04-13T15:26:11.823
> 
> 标签：android, buffer

在 java 中有一个 32 Kb 的最佳缓冲区大小，它完全基于所使用的 cpu 架构。在 Android 手机上，Dalvik VM 是否动态地知道 cpu 的正确缓存以获得最大的缓冲区大小，而与许多不同的手机无关？如果是这样，我将如何在运行时解决这个问题？

假设我想通过使缓冲区最大且最快来优化录音活动。我知道您可以获得最小尺寸，但最佳尺寸呢？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-06-27T08:08:42.143

也许这取决于您拥有或介意的设备。

但是，在实验上，**8K < 缓冲区大小 < 32K**确实工作得很好，并且在 8K 下有显着的性能提升。有趣的是，一些缓冲区 > 64K 的数据表现出比缓冲区低于 64K 的数据更差的性能

（我已经在几个 android 设备上进行了测试，并尝试读取具有各种缓冲区大小的 20MB 二进制文件。）

这是 exp 结果，如果您想以漂亮的形式转换数据，最好将它们粘贴到电子表格中。标头表示*缓冲区大小*，单位为*毫秒*

图： http: [//fb.com/photo.php?fbid=468345876512381](http://fb.com/photo.php?fbid=468345876512381)

```
 128     256     512     1K      2K      4K      8K      16K     32K     64K     128K    256K    512K    1M      2M      4M      8M      16M
    Galaxy S       4047    3060    269     155     100     65      64      52      51      45      47      50      49      43      44      46      45      58
    Optimus LTE    1178    617     322     172     101     65      47      42      41      35      36      39      44      61      56      51      72      60
    HTC EVO        3971    1884    941     480     251     141     95      69      56      50      48      55      50      49      48      48      48      47         
    Galaxy S2      750     383     210     123     74      50      41      37      35      34      34      37      39      44      46      44      45      44
    Galaxy Nexus   2272    1216    659     341     187     108     70      52      41      38      38      45      44      54      56      66      68      58
    Galaxy Note    1549    799     404     220     127     75      58      54      52      56      52      45      44      62      43      39      44      46 
```

* * *

```
InputStream in = openFileInput(FILE_NAME);
startTime = System.currentTimeMillis();

while (in.read(buffer) > 0) {
    readCount++;
}

elapsedTime = System.currentTimeMillis() - startTime; 
```

* * *

[![在此处输入图像描述](../Images/d73a994a57b49160f3c6f6de6360e713.png)](https://i.stack.imgur.com/YbSXR.jpg)

# delphi - 来自 user32.dll 的 delphi Hook SetClipboardData

> ID：10143733
> 
> 赞同：2
> 
> 时间：2012-04-13T15:26:16.923
> 
> 标签：delphi, hook

我有这个组件，我想在 DLL 中使用它来实现系统范围的钩子：

```
unit ClipboardHook;

interface

uses
  Windows, SysUtils, Classes, ExtCtrls;

type
 TFOnOpenClipboard = procedure(Sender:TObject; hWndNewOwner:HWND; 
   var opContinue:Boolean) of object;
 TFOnSetClipboardData = procedure(Sender:TObject; hWndNewOwner:HWND; 
   uFormat:DWord; hMem:THandle; var opContinue:Boolean) of object;

type
  TClipboardHook = class(TComponent)
  private
    { Private declarations }
    FOnOpenClipboard:TFOnOpenClipboard;
    FOnSetClipboardData:TFOnSetClipboardData;
  protected
    { Protected declarations }
  public
    { Public declarations }
    constructor Create(AOwner: TComponent); override;
    destructor Destroy; override;
    //------------------------------------------------
  published
    { Published declarations }
    property OnOpenClipboard:TFOnOpenClipboard 
      read FOnOpenClipboard write FOnOpenClipboard;
    property OnSetClipboardData:TFOnSetClipboardData 
      read FOnSetClipboardData write FOnSetClipboardData;
  end;

implementation

type
  TcOpen=function(hWndNewOwner:HWND):Bool; stdcall;

  TscData=function(uFormat:DWord; hMem:Thandle):THandle; stdcall;

  TOP_H = packed record
    Push:Byte;
    Address:DWord;
    Ret:Byte;
  end; 

var 
  OC_Addr,SCD_Addr:Pointer;
  OP:DWord;
  cOpen,rcOpen,scData,rscData:TOP_H;
  WPM:DWord;
  sComponent:TObject;

{***************************Start:TClipboardHook***************************}
function Open_Clipboard(hWndNewOwner:HWND):Bool; stdcall;
var 
  c: Boolean;
begin
  c:=true;
  if Assigned(TClipboardHook(sComponent).FOnOpenClipboard) then
    TClipboardHook(sComponent).FOnOpenClipboard(sComponent,hWndNewOwner,c);
  if c then
  begin
    WriteProcessMemory(OP,OC_Addr,@rcOpen,SizeOf(rcOpen),WPM);
    Result:=TcOpen(OC_Addr)(hWndNewOwner);
    WriteProcessMemory(OP,OC_Addr,@cOpen,SizeOf(cOpen),WPM);
  end 
  else 
    Result:=false;
end;

function Set_ClipboardData(uFormat:DWord; hMem:THandle):THandle; stdcall;
var 
  c: Boolean;
  Win: DWord;
begin         
  c := true;
  Win := GetOpenClipboardWindow();
 if (Win <> 0) and 
    (Assigned(TClipboardHook(sComponent).FOnSetClipboardData)) then
   TClipboardHook(sComponent).FOnSetClipboardData(sComponent,Win,uFormat,hMem,c);
 if c then
 begin
   WriteProcessMemory(OP,SCD_Addr,@rscData,SizeOf(rscData),WPM);
   Result:=TscData(SCD_Addr)(uFormat,hMem);
   WriteProcessMemory(OP,SCD_Addr,@scData,SizeOf(scData),WPM);
 end 
 else 
   Result:=0;
end;

{****************************End:TClipboardHook****************************}
{##############################################################################}
constructor TClipboardHook.Create(AOwner:TComponent);
var 
  Dll: DWord;
begin
  inherited Create(Aowner);
  if (csDesigning in ComponentState) then 
    exit;
  sComponent:=Self;
  DLL := LoadLibrary('user32.dll');
  if DLL <> 0 then
  begin
    OC_Addr := GetProcAddress(DLL,'OpenClipboard');
    SCD_Addr := GetProcAddress(DLL,'SetClipboardData');
    if (OC_Addr <> nil) or (SCD_Addr <> nil) then
    begin      
      OP:=OpenProcess(PROCESS_ALL_ACCESS, false, GetCurrentProcessID);
      if OP <> 0 then
      begin
        if OC_Addr <> nil then
        begin
          cOpen.Push := $68;
          cOpen.Address := DWord(@Open_Clipboard);
          cOpen.Ret := $C3;
          ReadProcessMemory(OP, OC_Addr, @rcOpen, SizeOf(rcOpen), WPM);
          WriteProcessMemory(OP, OC_Addr, @cOpen, SizeOf(cOpen), WPM);
        end;
        if SCD_Addr <> nil then
        begin
          scData.Push := $68;
          scData.Address := DWord(@Set_ClipboardData);
          scData.Ret := $C3;
          ReadProcessMemory(OP, SCD_Addr, @rscData, SizeOf(rscData), WPM);
          WriteProcessMemory(OP, SCD_Addr, @scData, SizeOf(scData), WPM);
        end;
      end;
    end;
   FreeLibrary(Dll);
  end;
end;

destructor TClipboardHook.destroy;
begin
 if (OC_Addr <> nil) then 
   WriteProcessMemory(OP, OC_Addr, @rcOpen, SizeOf(rcOpen), WPM);
 if OP <> 0 then CloseHandle(OP);
 inherited destroy;
end;

{##############################################################################}
end. 
```

有人可以帮我把所有这些东西都放到一个 DLL 中（没有组件），我的意思是只有函数。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T20:42:20.787

`exports`您可以简单地通过在单元中的某处包含一个子句来导出函数。要导出该代码中的两个函数，请将其添加到单元的底部：

```
exports
  Open_Clipboard,
  Set_ClipboardData; 
```

# jquery - jQuery - 滚动事件

> ID：10143736
> 
> 赞同：2
> 
> 时间：2012-04-13T15:26:24.593
> 
> 标签：jquery, events, scroll

我的脚本的目标是当用户向下滚动时，我的页面应该滚动到下一个 div。为此，脚本会区分用户是否向上和向下滚动。之后，当他滚动时，它应该删除`active`我的第一个 div 的类并添加到下一个。然后它滚动到带有 class 的新 div `active`。问题是它只适用于第一个滚动，而不是下一个。

我的代码：

```
$(window).load(function() {
    var tempScrollTop, currentScrollTop = 0;
    var $current = $("#container > .active");
    var next = $('.active').next();
    var prev = $('.active').prev();

    $(window).scroll(function() {
        currentScrollTop = $(window).scrollTop();

        if (tempScrollTop < currentScrollTop) { //scrolling down 
            $current.removeClass('active').next().addClass('active'); 
            $.scrollTo(next, 1000);
        }
        else if (tempScrollTop > currentScrollTop ) { //scrolling up
            $current.removeClass('active').prev().addClass('active');
            $.scrollTo(prev, 1000);
        }

        tempScrollTop = currentScrollTop;
    }); 
}); 
```

有谁能够帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T09:11:21.547

我找到了答案

var lastScrollTop = 0; var isDoingStuff = false;

```
$(document).scroll(function(event) {
    //abandon 
    if(isDoingStuff) { return; }

    if ($(this).scrollTop() > lastScrollTop) {
        //console.log('down');
        $('.active').removeClass('active').next('div').addClass('active');
        isDoingStuff = true;
        $('html,body').animate( {scrollTop: $('.active').offset().top }, 1000, function() {
            setTimeout(function() {isDoingStuff = false;}, 100);
            console.log('off');
        });
    } else {
        //console.log('up');
    }
    lastScrollTop = $(this).scrollTop();
})​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:33:53.383

您需要将 next 和 prev 变量移动到滚动函数中

```
$(window).load(function(){

var tempScrollTop, currentScrollTop = 0;

$(window).scroll(function(){

currentScrollTop = $(window).scrollTop();
//you need to assign the $current, next and prev here so they get the current elements (not the ones that were set at the beginning
var $current = $("#container > .active");    
var next = $('.active').next();
var prev = $('.active').prev();    

if (tempScrollTop < currentScrollTop )//scrolling down
{
$current.removeClass('active').next().addClass('active');
$.scrollTo(next, 1000);
}
else if (tempScrollTop > currentScrollTop )//scrolling up

{
$current.removeClass('active').prev().addClass('active');
$.scrollTo(prev, 1000);
}
tempScrollTop = currentScrollTop;
});
}); 
```

**更新** 我也将 $current var 添加到滚动函数中。

# python - 如果匹配的行不存在，我如何插入 MySQL 行

> ID：10143738
> 
> 赞同：1
> 
> 时间：2012-04-13T15:26:32.287
> 
> 标签：python, mysql, insert, mysql-python

我的表`bank`有三列：uid、nick 和 balance。

我可以很好地插入新行，但是`nick`由于`uid`自动递增，因此很容易出现重复的行，从而使每一行都是唯一的。但是我不希望这样，我只想要一个每一行`nick`。

```
 target = input.group(2)

    cursor.execute ("INSERT INTO bank (nick, balance) VALUES('" + db.escape_string(target.lower()) + "', 5)")
    db.commit()

    bot.say('An account for ' + target + ' has been created.') 
```

到目前为止，这是我的代码，但是我不确定如何创建`SELECT`查询，然后`nick`在插入新行之前检查表中是否已经存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:38:34.390

我会采用不同的方法。我会在列的数据库级别添加一个*唯一*`nick`约束：

```
ALTER TABLE bank ADD UNIQUE (nick); 
```

在您的 Python 代码中，然后放置一个`try`and`except`来适当地处理*违反唯一约束*的异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:36:03.297

拥有那个递增的 ID 听起来没有意义。
相反，请考虑帐户的唯一标识符，例如帐号。
正如另一个答案所暗示的那样，在 上添加唯一约束的危险`nick`在于，随着人口的增长，您可能会有两个或更多人希望使用相同的`nick`.

此外，您应该将要插入的值作为第二个参数传递`execute()`给，至少有两个原因*。

```
cursor.execute("""INSERT INTO bank (nick, balance) 
                  VALUES (%s, %s);""", (target.lower(), 5)) 
```

*两个原因是：

1.  您不必手动处理任何报价问题。Mysql-Python 会为你解决这个问题。
2.  您避免了 SQL 注入攻击的可能性。

请注意：参数占位符适用`%s`于所有类型的参数，而不仅仅是字符串。所以你*不需要*做任何事情，比如`%d`插入一个整数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:37:45.373

我想你正在使用 psycopg2

cursor.execute ("SELECT * FROM bank WHERE nick = %s",[nick])

nick = cursor.fetchall()

如果尼克...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-22T10:24:58.400

我正在使用 Python (3.6) 和 MySql，我想在添加记录之前检查它们。这是我的代码：

```
import mysql.connector

mydb = mysql.connector.connect(
  host="localhost",
  user="user",
  passwd="password",
  database='football'
)

mycursor = mydb.cursor()

def write_to_db(db_table, col_list, data_list, *supply_id):
    """
    Takes a record, checks if it already exists and if not inserts it, returning its index or None
    :param db_table: name of table to be checked / inserted into
    :param col_list: column/field names in a list eg.  ['meat', 'sides']
    :param data_list: data to be found or inserted eg ['spam', 'eggs']
    :param supply_id: Only if you supply calculated id as tuple ('table_id', table_id_val)
    :return: If lists don't match =None Else =Index of found record or Index of inserted one
    """
    if len(col_list) != len(data_list) or len(col_list) == 0: # List lengths must match
        return None     # Otherwise returned index is None
    # Build search SQL - Select - table - Where - match conditions
    find_existing_sql = 'SELECT * FROM {} '.format(db_table)    # Which table
    find_existing_sql += 'WHERE {} = {} '.format(col_list[0], data_list[0])
    sql_end = ' LIMIT 1 ;'
    if len(col_list) > 1:  # Provided record has more than 1 column
        and_sql = ' AND {} = {} '           # add extra match condition for each column
        for indx in list(range(1, len(col_list))):
            find_existing_sql += and_sql.format(col_list[indx], data_list[indx])
        find_existing_sql += sql_end        # Complete SQL to find given record
    my_cursor.execute(find_existing_sql)    # Query database with SQL
    seek_response = my_cursor.fetchall()    # Read the seek a record response
    record_exists = len(seek_response) > 0  # Length = 0 not found, > 0 found
    if record_exists:
        return seek_response[0][0]          # Return id = the first item from the first list of items
    else:
        # Build insert SQL - Insert into  - table - column names - values 
        insert_sql = 'INSERT INTO {} ('.format(db_table)    # Which table
        if supply_id is not None:       # If you supplied an index
            id_col = supply_id[0][0]    # first item in first arg = index name
            id_val = supply_id[0][1]    # second item in first arg = index value
            col_list =[id_col] + col_list       # Add index column name on the front of column list
            data_list = [id_val] + data_list    # Add index value on front of data_list
        first_col = '{}'.format(col_list[0])    # Start listing columns
        more_cols_vals = ', {}'                 # To add more coumns/values if needed
        values_sql = ') VALUES ( {} '.format(data_list[0]) # Start listing values
        end_sql = ' );'  
        insert_cols_sql = insert_sql + first_col    
        if len(col_list) > 1:       
            for indx in list(range(1, len(col_list))):
                insert_cols_sql += more_cols_vals.format(col_list[indx])
                values_sql += more_cols_vals.format(data_list[indx])
        # Put Insert SQL together
        insert_new_sql = insert_cols_sql + values_sql + end_sql
        my_cursor.execute(insert_new_sql) # Insert the new record into db
        mydb.commit()
        if supply_id is not None:   # If you supplied an index
            return id_val           # Return that
        else:                           # if not
            return my_cursor.lastrowid  # Return auto-generated index 
```

如果您提供自己生成的索引，此函数将获取表名、列名列表、要插入的值列表和可选元组

```
 ('table_id', table_id_value) 
```

但是如果你不提供这个元组，MySQL 将使用自动生成的索引进行插入。该例程假定您的表将索引作为其第一列。

如果找到的记录已存在，则返回该记录的索引，如果记录不存在，则返回插入记录时使用的索引。索引要么是 MySQL 生成的，要么是您提供的。如果您的列名列表和值列表长度不匹配，它将返回 None。

我已经使用 Python 来构建 SQL 语句，因此您可以拥有可变数量的列。您可以在 SQL 中传递值（尽管我不知道如何为可变数量的列和值执行此操作），但我不断收到“参数数量错误”的错误，并且使用 Python 的 string.format() 解决了这个问题。

*supply_id（通常是 *args）参数是一个列表，即使您只提供一个元组，所以我需要两个索引来访问第一个 arg，然后是 0 或 1 来访问元组中的列名和值。

.fetchall() 本身对于防止“未读记录”错误是必要的，因为如果找到记录，它会从游标中清除数据。

# c++ - 在模板类中重载加法运算符

> ID：10143740
> 
> 赞同：3
> 
> 时间：2012-04-13T15:26:41.717
> 
> 标签：c++, templates, operator-overloading

我正在尝试为简单的复数操作编写一些代码。我正在使用模板类，但在重载运算符（特别是 +、-、*、/）时遇到问题。我试图在我的模板类中声明重载，然后在同一个头文件中定义它们。

我的标题代码如下：

```
#ifndef MY_CLASS_H
#define MY_CLASS_H

template <class T> class complex
{

private:
    T re,im;
public:
    // Constructors & destructor
    complex(){re=im=0;}
    complex(T r, T i){re=r; im=i;}
    ~complex(){}

    // Return real component
    T realcomp() const {return re;}
    // Return imaginary component
    T imagcomp() const {return im;}

    // Overload + operator for addition 
    complex<T> operator+(const complex<T> &C);

....

};
#endif

#include<iostream>
#include<cmath>
using namespace std;

template <class T> complex<T>& complex<T>::operator+(const complex &C){
complex<T> A(re+C.realcomp(),im+C.imagcomp());
return A;
} 
```

这会返回我迄今为止无法解决的错误，而且我不完全确定我哪里出错了。我是 C++ 的初学者，并试图拼凑本网站上其他问题的解决方案，这可能意味着我的代码有点混乱——我道歉！

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:32:34.917

for 的声明`complex<T>::operator+`正在返回，`complex<T>`而定义正在返回 a `complex<T>&`。您想按值返回对象，而不是引用。

此外，模板类必须在头文件中有它们的函数定义，因为编译器在实例化模板时需要能够*看到*这些，所以将`operator+`定义移动到头文件中。

您还应该使用构造函数初始化列表来初始化成员变量。

```
template <class T> class complex
{
private:
    T re,im;
public:
    // Constructors & destructor
    complex() : re(), im() {}
    complex( const T& r, const T& i ) : re(r), im(i) {}
    ~complex(){}

    // Return real component
    T realcomp() const {return re;}
    // Return imaginary component
    T imagcomp() const {return im;}

    // Overload + operator for addition 
    complex<T> operator+(const complex<T> &C)
    {
       return complex<T>( re + C.realcomp(), im + C.imagcomp() );
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:32:19.120

您将声明与定义不匹配。更改此行：

```
template <class T> complex<T>& complex<T>::operator+(const complex &C){ 
```

对此

```
template <class T> complex<T> complex<T>::operator+(const complex &C){ 
```

（注意缺少的“&”）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:32:56.497

这应该有效：

```
template <class T> complex<T> complex<T>::operator+(const complex<T> &C){ 
  complex<T> A(re+C.realcomp(),im+C.imagcomp()); 
  return A; 
} 
```

返回值被声明为类中的一个对象，并且参数中缺少模板参数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T15:34:21.940

您正在返回一个局部变量作为参考。加上声明不同：

您声明返回一个复合体，而在定义时您返回一个复合体&

# algorithm - LAG 函数的更多问题是 SAS

> ID：10143745
> 
> 赞同：2
> 
> 时间：2012-04-13T15:27:03.353
> 
> 标签：algorithm, sas, lag

以下 SAS 代码应该从包含名为“Radvalue”的数字变量的数据集中读取。Radvalue 是散热器的温度，如果散热器关闭但温度升高 2 或更多，则表明它已经启动，如果它打开但其温度降低 2 或更多，则表明它消失了。Radstate 是数据集中的一个新变量，它指示每次观察时散热器是打开还是关闭，这就是我试图为整个数据集自动填充的变量。所以我尝试使用 LAG 函数，尝试初始化第一行，它没有 dif_radvalue，然后尝试将我刚才描述的算法应用到第 2 行以后。知道为什么 Radstate 和 l_radstate 列完全空白吗？

非常感谢！！如果我没有清楚地解释问题，请告诉我。

```
Data work.heating_algorithm_b;
 Input ID Radvalue; 
 Datalines; 
  1 15.38 
  2 15.38 
  3 20.79 
  4 33.47 
  5 37.03 
  6 40.45 
  7 40.45 
  8 40.96 
  9 39.44 
  10 31.41 
  11 26.49 
  12 23.06 
  13 21.75 
  14 20.16 
  15 19.23 
 ; 

DATA temp.heating_algorithm_c;
 SET temp.heating_algorithm_b;

 DIF_Radvalue = Radvalue - lag(Radvalue);

 l_Radstate = lag(Radstate);

 if missing(dif_radvalue) then  
  do;
   dif_radvalue = 0;
   radstate = "off"; 
  end;                            
 else if l_Radstate = "off"  &  DIF_Radvalue > 2    then Radstate = "on";
 else if l_Radstate = "on" &  DIF_Radvalue < -2  then  Radstate = "off";
 else  Radstate = l_Radstate;
run; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:52:07.267

我没有 SAS 经验，但也许你需要一张`missing(l_Radstate)`支票来覆盖第一次，可能是这样的：

```
if missing(l_Radstate) then
do; radstate = "off"; end; 
```

我认为只有在`Radvalue - lag(Radvalue)`没有强迫`DIF_Radvalue`失踪的情况下才需要这样做。如果是这样，我不确定有什么帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T17:02:18.523

您试图对仅存在于输出数据集 (RADSTATE) 中的变量执行 LAG 函数。我用 RETAIN 替换了 RADSTATE 上的 LAG。此外，您将 LAG 函数保留在任何条件逻辑之外是正确的……试试下面的代码。

```
Data work.heating_algorithm_b;
 Input ID Radvalue; 
 Datalines; 
  1 15.38 
  2 15.38 
  3 20.79 
  4 33.47 
  5 37.03 
  6 40.45 
  7 40.45 
  8 40.96 
  9 39.44 
  10 31.41 
  11 26.49 
  12 23.06 
  13 21.75 
  14 20.16 
  15 19.23 
 ; 

DATA work.heating_algorithm_c;
 length radstate $3;
 retain radstate;
 SET work.heating_algorithm_b;

 old_radvalue=lag(radvalue);

 if _n_=1 then do;
  dif_radvalue=0;
  radstate="off";
 end;
 else do;
  DIF_Radvalue = Radvalue-Old_Radvalue;

  if Radstate = "off"  &  DIF_Radvalue > 2    then Radstate = "on";
  else if Radstate = "on" &  DIF_Radvalue < -2  then  Radstate = "off";
  /* Else Radstate stays the same */
 end;
run; 
```

# ruby-on-rails - 未定义的方法“布局”#

> ID：10143746
> 
> 赞同：1
> 
> 时间：2012-04-13T15:27:05.097
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, layout, controller

我希望我的欢迎控制器使用不同的布局：

```
class WelcomeController < ApplicationController

  def index
    if signed_in?
      layout 'default'
    else
      layout 'welcome'
    end
    render 'welcome/index'
  end

end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:28:51.947

```
class WelcomeController < ApplicationController

  def index
    if signed_in?
      render :layout => 'default'
    else
      render :layout => 'welcome'
    end
  end

end 
```

# sql - SQL Server 查询中对单个表的多个联接抛出计数

> ID：10143748
> 
> 赞同：1
> 
> 时间：2012-04-13T15:27:21.610
> 
> 标签：sql, sql-server-2005, join, left-join, outer-join

我正在 SQL Server Management Studio 2005 中编写一个存储过程，以返回两个不同时间段（本月至今和年初至今）的状态和策略计数列表。我创建了几个视图来收集所需的数据和一个存储过程，以便在 Reporting Services 报表中使用。

下面是我的存储过程：

```
SELECT DISTINCT
    S.[State],
    COUNT(HP_MTD.PolicyID) AS PolicyCount_MTD,
    COUNT(HP_YTD.PolicyID) AS PolicyCount_YTD
FROM tblStates S
    LEFT OUTER JOIN vwHospitalPolicies HP_MTD ON S.[State] = HP.[State]
        AND HP.CreatedDate BETWEEN DATEADD(MONTH, -1, GETDATE()) AND GETDATE()
    LEFT OUTER JOIN vwHospitalPolicies HP_YTD ON S.[State] = HP.[State]
        AND HP.CreatedDate BETWEEN DATEADD(YEAR, -1, GETDATE()) AND GETDATE()
GROUP BY S.[State]
ORDER BY S.[State] ASC 
```

我遇到的问题是，当添加第二个 LEFT OUTER JOIN 时，我的计数会膨胀，即使是没有引用第二个连接的 COUNT() 也是如此。我需要左加入，因为并非所有州都会在给定时期内制定政策，但它们仍应出现在报告中。

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:33:58.180

听起来你需要：

```
COUNT(DISTINCT HP_MTD.PolicyID) AS PolicyCount_MTD,
COUNT(DISTINCT HP_YTD.PolicyID) AS PolicyCount_YTD 
```

代替：

```
COUNT(HP_MTD.PolicyID) AS PolicyCount_MTD,
COUNT(HP_YTD.PolicyID) AS PolicyCount_YTD 
```

您的原始查询包括第二个联接中的匹配行数。在内部添加一个`DISTINCT`子句将其`COUNT`限制为 PolicyID 的唯一出现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T16:02:36.540

对于这类工作，我更喜欢 CTE——它们基本上是一种内联视图。

*您的实际问题是，某些策略在两个*计数列中都被计算了两次——一次是本月至今，一次是年初至今。所以，如果你有这样的源表：

```
year-to-date
state   policy
==================
1       1
1       2
1       3
2       4

month-to-date
state   policy
==================
1       1
1       2 
```

s的结果表`JOIN`（在评估之前`COUNT`）如下所示：

```
temp
state  monthPolicy  yearPolicy
================================
1      1            1
1      1            2
1      1            3
1      2            1
1      2            2
1      2            3
2      -            4 
```

显然不是你想要的。通常，解决方案是使用 CTE 或其他表引用来呈现最终连接的汇总记录。像这样的东西：

```
WITH PoliciesMonthToDate (state, count) as (
                          SELECT state, COUNT(*)
                          FROM vwHospitalPolicies
                          WHERE createdDate >= DATEADD(MONTH, -1, GETDATE())
                          AND createdDate < DATEADD(DAY, 1, GETDATE())
                          GROUP BY state),
     PoliciesYearToDate (state, count) as (
                         SELECT state, COUNT(*)
                         FROM vwHospitalPolicies
                         WHERE createdDate >= DATEADD(YEAR, -1, GETDATE())
                         AND createdDate < DATEADD(DAY, 1, GETDATE())
                         GROUP BY state)
SELECT a.state, COALESCE(b.count, 0) as policy_count_mtd, 
                COALESCE(c.count, 0) as policy_count_ytd
FROM tblStates a
LEFT JOIN PoliciesMonthToDate b
ON b.state = a.state
LEFT JOIN PoliciesYearToDate c
ON c.state = a.state
ORDER BY a.state 
```

（轻微的挑剔 - 不要为表和视图使用前缀。这是噪音，如果由于某种原因在它们之间切换，则需要更改代码。否则，名称会误导）

# javascript - 外部 css、$.ajax、firefox、jquery。

> ID：10143752
> 
> 赞同：1
> 
> 时间：2012-04-13T15:27:28.867
> 
> 标签：javascript, jquery, cross-browser

在我的 html 中，我有 2 个外部 css 文件

```
externalCSSContents = [];

function getExternalCSSContents(){
    var i, href;
    for (i=0; i < document.styleSheets.length; i++)
    {
        href = document.styleSheets[i].href;
            if (href != null)
            {  
                $.ajax({
                    async: false,
                    url: href, 
                    success: function (data) { 
                        externalCSSContents.push(data);
                    }
                });
            }
    }

}
getExternalCSSContents();
alert(externalCSSContents.length); 
```

并且此代码有时在 Firefox 中警告 1，但在其他浏览器中永久警告 2。出了什么问题，我该如何解决？
**[Edit]** href 有时 = null in ff
**[Edit2]**我明白了，很抱歉我没有提到附加的 prefixfree.min.js。有了这个库，document.styleSheets[i].href 就像在没有它的 Chrome 中一样在 FireFox 中工作。（ Сhrome 不支持 document.styleSheets ）。谢谢大家的回答，再次为我的疏忽感到抱歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:36:57.523

Another victim of AJAX. AJAX stands for Asynchronous JavaScript and XML. The first part is in place here (Asynchronous ).

It could be that the AJAX call is not finished before reaching the alert. You can use a callback to be called when you AJAX function is finished.

```
externalCSSContents = [];

function getExternalCSSContents(callback){
    var i, href;
    for (i=0; i < document.styleSheets.length; i++)
    {
        href = document.styleSheets[i].href;
            if (href != null)
            {  
                $.ajax({
                    url: href, 
                    success: function (data) { 
                        externalCSSContents.push(data);
                        callback();
                    }
                });
            }
    }

}
getExternalCSSContents(downloadReady);

function downloadReady() {
    alert(externalCSSContents.length);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:30:59.493

尝试将警报移动到成功功能中，您可能会遇到竞争情况。您希望警报等到 AJAX 调用完成。

# c++ - 使用 libavformat 通过 RTP 流式传输 H.264

> ID：10143753
> 
> 赞同：10
> 
> 时间：2012-04-13T15:27:34.480
> 
> 标签：c++, h.264, rtp, libavformat, libx264

在过去的一周里，我一直在尝试通过 RTP 实现 H.264 流，使用 x264 作为编码器和 libavformat 来打包和发送流。问题是，据我所知，它工作不正常。

现在我只是编码随机数据（x264_picture_alloc）并从 libx264 中提取 NAL 帧。这很简单：

```
x264_picture_t pic_out;
x264_nal_t* nals;
int num_nals;
int frame_size = x264_encoder_encode(this->encoder, &nals, &num_nals, this->pic_in, &pic_out);

if (frame_size <= 0)
{
    return frame_size;
}

// push NALs into the queue
for (int i = 0; i < num_nals; i++)
{
    // create a NAL storage unit
    NAL nal;
    nal.size = nals[i].i_payload;
    nal.payload = new uint8_t[nal.size];
    memcpy(nal.payload, nals[i].p_payload, nal.size);

    // push the storage into the NAL queue
    {
        // lock and push the NAL to the queue
        boost::mutex::scoped_lock lock(this->nal_lock);
        this->nal_queue.push(nal);
    }
} 
```

`nal_queue`用于将帧安全地传递给 Streamer 类，然后将帧发送出去。现在它没有线程化，因为我只是在测试试图让它工作。在对单个帧进行编码之前，我已确保初始化编码器。

但我不相信 x264 是问题所在，因为我可以在它返回的 NAL 中看到帧数据。流式传输数据是使用 libavformat 完成的，它首先在 Streamer 类中初始化：

```
Streamer::Streamer(Encoder* encoder, string rtp_address, int rtp_port, int width, int height, int fps, int bitrate)
{
    this->encoder = encoder;

    // initalize the AV context
    this->ctx = avformat_alloc_context();
    if (!this->ctx)
    {
        throw runtime_error("Couldn't initalize AVFormat output context");
    }

    // get the output format
    this->fmt = av_guess_format("rtp", NULL, NULL);
    if (!this->fmt)
    {
        throw runtime_error("Unsuitable output format");
    }
    this->ctx->oformat = this->fmt;

    // try to open the RTP stream
    snprintf(this->ctx->filename, sizeof(this->ctx->filename), "rtp://%s:%d", rtp_address.c_str(), rtp_port);
    if (url_fopen(&(this->ctx->pb), this->ctx->filename, URL_WRONLY) < 0)
    {
        throw runtime_error("Couldn't open RTP output stream");
    }

    // add an H.264 stream
    this->stream = av_new_stream(this->ctx, 1);
    if (!this->stream)
    {
        throw runtime_error("Couldn't allocate H.264 stream");
    }

    // initalize codec
    AVCodecContext* c = this->stream->codec;
    c->codec_id = CODEC_ID_H264;
    c->codec_type = AVMEDIA_TYPE_VIDEO;
    c->bit_rate = bitrate;
    c->width = width;
    c->height = height;
    c->time_base.den = fps;
    c->time_base.num = 1;

    // write the header
    av_write_header(this->ctx);
} 
```

这就是事情似乎出错的地方。`av_write_header`上面似乎什么也没做；我已经使用wireshark来验证这一点。作为参考，我`Streamer streamer(&enc, "10.89.6.3", 49990, 800, 600, 30, 40000);`用来初始化 Streamer 实例，`enc`作为对`Encoder`以前用于处理 x264 的对象的引用。

现在，当我想流式传输 NAL 时，我使用它：

```
// grab a NAL
NAL nal = this->encoder->nal_pop();
cout << "NAL popped with size " << nal.size << endl;

// initalize a packet
AVPacket p;
av_init_packet(&p);
p.data = nal.payload;
p.size = nal.size;
p.stream_index = this->stream->index;

// send it out
av_write_frame(this->ctx, &p); 
```

此时，我可以看到 RTP 数据出现在网络上，它看起来就像我一直在发送的帧，甚至包括来自 x264 的一点版权 blob。**但是**，我用过的任何播放器都无法理解这些数据。VLC 不再需要 SDP 描述，这[显然不是必需](https://stackoverflow.com/questions/6023668/rtp-video-stream-is-presence-of-sdp-file-mandatory)的。

然后我尝试通过以下方式播放它`gst-launch`：

`gst-launch udpsrc port=49990 ! rtph264depay ! decodebin ! xvimagesink`

这将等待 UDP 数据，但是当它收到时，我得到：

> 错误：元素/GstPipeline:pipeline0/GstRtpH264Depay:rtph264depay0：未协商 RTP 格式。附加调试信息：gstbasertpdepayload.c(372):gst_base_rtp_depayload_chain ():/GstPipeline:pipeline0/GstRtpH264Depay:rtph264depay0：输入缓冲区需要设置 RTP 上限。这通常通过设置上游源元素（通常是 udpsrc 或 appsrc）的 'caps' 属性来实现，或者通过在 depayloader 之前放置一个 capsfilter 元素并在其上设置 'caps' 属性来实现。另请参阅 [http://cgit.freedesktop.org/gstreamer/gst-plugins-good/tree/gst/rtp/README](http://cgit.freedesktop.org/gstreamer/gst-plugins-good/tree/gst/rtp/README)

由于我没有使用 GStreamer 进行流式传输，因此我不太确定 RTP 上限意味着什么。但是，这让我想知道我是否没有通过 RTP 发送足够的信息来描述流。我对视频很陌生，我觉得这里缺少一些关键的东西。有什么提示吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T16:40:47.627

h264 是一种编码标准。它指定了如何压缩视频数据并以一种可以在以后解压缩为视频流的格式存储。

RTP是一种传输协议。它指定了可以携带由**任意**编码器编码的音频-视频数据的数据包的格式和顺序。

GStreamer 期望接收符合 RTP 协议的数据。您是否期望 libaformat 会生成 GStreamer 立即可读的 RTP 数据包？也许 GStreamers 期望一个额外的流描述，使其能够使用适当的解码器接受和解码流数据包？也许它需要额外的 RTSP 交换或 SDP 流描述符文件？

错误消息非常清楚地表明尚未协商 RTP 格式。`caps`是能力的简写。接收器需要知道发射器的能力以正确设置接收器/解码机器。

我强烈建议至少尝试为您的 RTP 流创建一个 SDP 文件。libavformat[应该可以为您完成](http://cekirdek.pardus.org.tr/~ismail/ffmpeg-docs/avformat_8h.html#29b8a87c150f01024050603acf5c0323)。

# sql-server - 我们可以将 CASE 与 EXEC 一起使用吗

> ID：10143755
> 
> 赞同：8
> 
> 时间：2012-04-13T15:27:37.523
> 
> 标签：sql-server, case-when

我想根据用户输入选择要执行的存储过程。就像是 -

```
EXEC
CASE @InputParam 
  WHEN 'XML' THEN GetXMLData @ID, 'y'
  WHEN 'TABLE' THEN GetTableData @ID, 'y'
END 
```

这可以用构造完成`CASE`还是我应该考虑使用`If`构造？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-13T15:34:53.053

你想在`IF`这里使用构造：

```
IF @InputParam = 'XML'
    EXEC GetXMLData @ID, 'y'
IF @InputParam = 'TABLE'
    EXEC GetTableData @ID, 'y' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T15:29:58.627

在这种情况下，我认为即使 SQL Server 允许这样做，IF 也会更清楚。

```
IF @InputParam = 'XML'
BEGIN
    exec GetXMLData @ID, 'y'
END
ELSE IF @InputParam = 'TABLE'
BEGIN
    exec GetTableData @ID, 'y'
END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T15:29:47.483

你可以这样做：

```
IF @InputParam = 'XML'
BEGIN
   EXEC GetXMLData @ID, 'y'
END

IF @InputParam = 'TABLE'
BEGIN
   EXEC GetTableData @ID, 'y'
END 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-16T18:16:41.790

您可以使用 CASE，但必须使用 EXEC (cmd)：

```
DECLARE 
@cmd VARCHAR(200)
, @InputParam VARCHAR(5) ='TABLE'
, @ID INT =1

SELECT @cmd = ( CASE @InputParam 
WHEN 'XML' THEN 'GetXMLData '
      +CONVERT(VARCHAR,@ID)+', '+CHAR(39)+'y'+CHAR(39)
WHEN 'TABLE' THEN 'GetTableData '
      +CONVERT(VARCHAR,@ID)+', '+CHAR(39)+'y'+CHAR(39)
END)
EXEC(@cmd) 
```

# javascript - 将用户重定向到存储在变量中的 url (Javascript)

> ID：10143763
> 
> 赞同：0
> 
> 时间：2012-04-13T15:28:02.837
> 
> 标签：javascript, redirect

可能是一个愚蠢的问题，但我不经常使用 javascript，并且很困惑为什么下面的代码不起作用..

```
var loc = document.forms["myForm"]["sites"].value;
//loc = 'http://www.sites.com'
window.location(loc); 
```

我做了很多搜索，很惊讶地发现这以前没有出现过。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:29:21.070

`window.location`是一个对象，而不是一个函数。

试试这个：

```
window.location.href = loc; 
```

或者如果你想替换当前的历史条目：

```
window.location.replace(loc); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:29:14.420

尝试使用这个：

```
window.location.href = loc 
```

# c - C 无法编译 - 未找到架构 x86_64 的符号

> ID：10143784
> 
> 赞同：17
> 
> 时间：2012-04-13T15:29:11.343
> 
> 标签：c, compilation

我的 C 代码存在严重问题，我似乎无法编译它，我真的不知道为什么。

我已经尝试在网上搜索并找不到解决问题的方法，您有什么想法吗？

谢谢你的时间！

```
Undefined symbols for architecture x86_64:
  "_Insert", referenced from:
      _InsertNode in part1.o
     (maybe you meant: _InsertNode)
  "_Create", referenced from:
      _findShortestPaths in part1.o
  "_DeleteMin", referenced from:
      _findShortestPaths in part1.o
  "_decreaseKey", referenced from:
      _findShortestPaths in part1.o
  "_GetMin", referenced from:
      _findShortestPaths in part1.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status
make: *** [part1] Error 1 
```

来自 part1.c 的片段

```
#include "limits.h"
#include "pegBinaryHeap.h"

void InsertNode(int distance, Node* node, PriorityQueue PQ) {
  ...
  Insert(*item, PQ);
}

...

int* findShortestPaths(Graph *graph, int start) {
  ...

  //Priority queue ordered by distance
  PriorityQueue pq = Create(graph->MaxSize);
  for(int i = 0; i < graph->MaxSize; i++) {
    ...
  }

  //While the queue isn't empty:
  while((currentPqItem=GetMin(pq)) != NULL) { 
    ...
    DeleteMin(pq);

      //for each node accesable from currentNode
    List *currentNeighbour = currentNode.outlist;

    while(currentNeighbour!=NULL) {
      ...
        decreaseKey(currentNode.id, newDistance, pq);
    } // end for
  }// end while
}

int main(int argc,char *argv[])
{
  Graph mygraph;
  return 0;
} 
```

以及它似乎在抱怨的 .h 文件

```
#include "graph.h"

struct HeapStruct;
typedef struct HeapStruct *PriorityQueue;

typedef struct {
  int distance;
  Node *node;
} QueueType;

PriorityQueue Create( int MaxSize );
void Destroy( PriorityQueue H );
int Insert( QueueType Item, PriorityQueue H );
QueueType DeleteMin( PriorityQueue H );
QueueType* GetMin( PriorityQueue H );
void decreaseKey(int nodeId, int value, PriorityQueue H); 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-13T15:48:40.210

可以*编译*，但不能*链接*。

`part1.o`正在使用您在上一个`.h`文件中定义的函数，并且找不到实现。当你链接你的程序时，你需要确保你链接的对象文件（或库）包含这些函数的实现。你可能做过类似的事情：

`gcc part1.c -o myapp`

所以链接器没有拼图的所有部分。

如果要分段编译，则需要：

```
gcc -c part1.c -o part1.o
gcc -c implementations.c -o implementations.o 
gcc implementations.o part1.o -o myapp 
```

在这里，所有`.c`文件都被分别编译成 object ( `.o`) 文件，然后链接在一起成为一个可执行文件。或者你可以一次做所有事情：

```
gcc part1.c implementations.c -o myapp 
```

如果实现在库 ( `libimplementations.a`) 中：

```
gcc part1.c -Lpath/to/libs -limplementations -o myapp 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-06T05:16:54.520

我想补充一下，我遇到了类似的编译错误。见下文。

```
Undefined symbols for architecture x86_64:
  "_add", referenced from:
   _load in file.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status
make: *** [all] Error 1 
```

我通过实现我在头文件中创建的 add() 函数原型解决了这个问题。实施后，我不再收到此错误。可以帮助别人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:46:09.700

我会尝试创建一个显示相同错误的简约示例。我们缺少太多信息来帮助您诊断。其他文件中的代码和实际的编译命令（不仅仅是 Makefile 的一部分，而是实际的命令）可能是这个问题的根源。

（是的，这应该是评论而不是答案，但由于某种原因我无法评论问题）

# google-maps - 使用 KML 层的选项卡式 InfoWindow Google Maps API v3

> ID：10143800
> 
> 赞同：1
> 
> 时间：2012-04-13T15:29:50.550
> 
> 标签：google-maps, kml

我正在尝试将选项卡添加到该站点[http://nctcog.org/trans/data/trafficcounts/index.asp的信息窗口](http://nctcog.org/trans/data/trafficcounts/index.asp)

由于我在数据库中存储了数千个点，随着地图中心的变化，我抓取地图边界并将它们传递到构建 KML 文件的页面，然后使用 google.maps.KmlLayer 加载它们。信息窗口中的大部分数据都存储在与纬度、经度相同的表中，我在构建 KML 文件时将其与坐标一起加载。

我尝试了几种操作标签的方法，但都没有成功。

我知道可以添加一个侦听器来操作信息窗口，但是由于我没有将我的标记与侦听器一起添加，我如何将它与正确的标记联系起来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T18:45:19.830

困难的部分是从 KML 文件中操作您的标记。据我尝试，当您使用 KMLayer 时，没有办法这样做。由于您是在动态创建 KML，它使事情变得更容易。

幸运的是 :) 我最近处理了一个 KML 问题并且有一个起始文件。一个令人讨厌的“功能”是 AJAX 调用迫使我将 HTML 和 KML 放在同一台公共计算机中。我无法离线工作。你可以试试本地网络服务器，我没有。

[https://files.nyu.edu/hc742/public/googlemaps/kmlcircle.html](https://files.nyu.edu/hc742/public/googlemaps/kmlcircle.html)

关键思想是将`createMarker`下面显示的默认功能替换为您自己的功能名称。在这种情况下，我要添加圈子，在您的圈子中，您需要添加 InfoWindows。

```
 geoXml = new geoXML3.parser({
      map: map, 
      createMarker: addCircle}); 
```

至少可以通过两种方式将选项卡添加到您的信息窗口。[JQuery 方式](http://gmaps-samples-v3.googlecode.com/svn/trunk/infowindow/tabs.html)和Tabber[方式](http://www.grasoft.be/mtb/tracks/ShowGPX.htm?gpx=20100523.gpx)（加载此页面后单击绿线）

# clearcase - RTC 源代码管理中的“更改资源管理器”视图如何工作

> ID：10143807
> 
> 赞同：3
> 
> 时间：2012-04-13T15:30:20.180
> 
> 标签：clearcase, rtc

我有一个包含传出更改的组件：

![在此处输入图像描述](../Images/c7da729c8691605080bcb67b454f2ce3.png)

当我右键单击此组件并与“初始基线”进行比较时，我会得到一个包含该组件的更改集列表。这显示在“更改资源管理器”视图中：

![在此处输入图像描述](../Images/0baaebabdce8e5068cce001bef7cc496.png)

这是随时间推移交付给该组件的变更集列表还是交付给基线的变更集列表，还是两者兼而有之？

通过右键单击每个更改集，我会看到“接受”更改集的选项。这应该将选定的变更集复制到我的工作区吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:58:56.733

如果您在变更集上看到接受，这意味着它是传入变更的一部分，随着时间的推移在流上完成并交付。
如果您接受这些，并且如果您的组件已加载到您的沙箱中，那么是的，这些文件将被复制到您的硬盘上。

* * *

更清楚地说，“更改资源管理器”（与您的经典“待更改”视图相比）是关于源代码控制*探索*（即查找*并在需要时接受*您需要在您的存储库工作区中查看的旧更改集，并且，如果相应的组件已加载，在您的沙箱或硬盘中）

请参阅“[使用 Rational Team Concert 实践源代码控制考古](https://jazz.net/library/article/447/)”

> 选择`Open in Change Explorer`更改集将显示该更改集中涉及的所有文件版本和目录。
> 显示装饰器和澄清注释以帮助您了解发生了什么：
> 
> *   文件或目录已更改：![文件已更改](../Images/ab0436f82c0cc533e01e5a2cc3d779fb.png) ![目录已更改](../Images/5bb5c81d069f2119b41f10ad37dfee04.png)
> *   添加的文件或目录：![添加的文件](../Images/dc220a9f252baa3f5148b8398be5541c.png) ![添加的目录](../Images/d3365cd1d4223903e8e8d39a609d873c.png)
> *   文件或目录已删除：![文件已删除](../Images/88efb08019fbc92bad231f6eb6ea3f74.png) ![目录已删除](../Images/323e68052bb6ddba6b685808a911cd5b.png)

![变革探索者](../Images/852149ad328c4b8b8d89d110fdd3a1b8.png)

# iphone - 检查 NSDate 是在本周还是下周

> ID：10143811
> 
> 赞同：3
> 
> 时间：2012-04-13T15:30:35.700
> 
> 标签：iphone, ios, nsdate

有办法检查 NSDate 是本周还是下周？

我知道今天是：

```
[NSDate date] 
```

然后我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-13T15:45:03.613

使用 NSDateComponents，如下所示：

```
NSCalendar *gregorian = [[NSCalendar alloc]
    initWithCalendarIdentifier:NSGregorianCalendar];
    NSDate *today = [NSDate date];

    NSDateComponents *todaysComponents =
        [gregorian components:NSWeekCalendarUnit fromDate:date];

    NSUInteger todaysWeek = [todaysComponents week];

    NSDate *anotherDate = [NSDate date];

    NSDateComponents *otherComponents =
        [gregorian components:NSWeekCalendarUnit fromDate:anotherDate];

    NSUInteger anotherWeek = [otherComponents week];

    if(todaysWeek==anotherWeek){
         NSLog(@"another date is this week");
    }else if(todaysWeek+1==anotherWeek){
         NSLog(@"another date is next week")
    } 
```

您还可以使用其他组件（例如月份或年份）来完全确定。

注意：**不要使用时间间隔。**通过使用 NSDateComponents，您可以忽略小时、分钟和秒。我想你想要那个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T15:40:44.713

将 2 个日期传递给此方法：

```
- (BOOL) isSameWeekAsDate: (NSDate *) aDate andDate:(NSDate *) bDate
{
    NSDateComponents *components1 = [[NSCalendar currentCalendar] components:(NSYearCalendarUnit| NSMonthCalendarUnit | NSDayCalendarUnit | NSWeekCalendarUnit |  NSHourCalendarUnit | NSMinuteCalendarUnit | NSSecondCalendarUnit | NSWeekdayCalendarUnit | NSWeekdayOrdinalCalendarUnit) fromDate:aDate];
    NSDateComponents *components2 = [[NSCalendar currentCalendar] components:(NSYearCalendarUnit| NSMonthCalendarUnit | NSDayCalendarUnit | NSWeekCalendarUnit |  NSHourCalendarUnit | NSMinuteCalendarUnit | NSSecondCalendarUnit | NSWeekdayCalendarUnit | NSWeekdayOrdinalCalendarUnit) fromDate:bDate];

    if ([components1 week] != [components2 week]) return NO;

    //return (abs([self timeIntervalSinceDate:aDate]) < 604800); // ops, forgot to change "self" with parameter "bDate":
    return (abs([bDate timeIntervalSinceDate:aDate]) < 604800);
} 
```

**编辑：** 用 2 个不同年份的日期调用它：

```
[components setDay:31];
[components setMonth:12];
[components setYear:2010];
NSCalendar *gregorian = [[NSCalendar alloc]  initWithCalendarIdentifier:NSGregorianCalendar];
NSDate *date1 = [gregorian dateFromComponents:components];

// second date (SATURDAY -of the same week, other year...)
[components setDay:1];
[components setMonth:1];
[components setYear:2011];
NSDate *date2 = [gregorian dateFromComponents:components];

if ([self isSameWeekAsDate:date1 andDate:date2]) {
    NSLog(@"Same Week!");
}else{
    NSLog(@"OTHER WEEK!");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-23T12:53:17.677

我正在添加我的解决方案（实现为**NSDate 类别**），它不使用周，在 iOS7、iOS8 中已弃用

```
- (NSDate *)firstDateOfWeek {
    NSCalendar *calendar = [NSCalendar currentCalendar];
    NSDate *startOfWeek;
    [calendar rangeOfUnit:NSCalendarUnitWeekOfYear startDate:&startOfWeek interval:NULL forDate:self];
    return startOfWeek;
}

- (BOOL)isSameWeekWithDate:(NSDate *)date {
    if (ABS(self.timeIntervalSince1970 - date.timeIntervalSince1970) > (7 * 24 * 60 * 60)) {
        return NO;
    }    
    return ([[self firstDateOfWeek] timeIntervalSince1970] == [[date firstDateOfWeek] timeIntervalSince1970]);
}

- (BOOL)isThisWeek {
    return [self isSameWeekWithDate:[NSDate new]];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T15:36:17.877

```
NSCalendar *cal = [NSCalendar currentCalendar];
NSDateComponents *components = [cal components:NSWeekCalendarUnit fromDate:yourDate];
NSInteger week = [components week]; // here your have a Integer with the weeknr of yourDate

components = [cal components:NSWeekCalendarUnit fromDate:[NSDate date]];
weekToday = [components week]; // here your have a Integer with the weeknr of today 
```

其余的你应该能够做到。当谈到一年中的最后一周时，它可能会再做一次脑力劳动。

清除？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T15:36:54.120

注意：这使用周日-周六周的概念来计算“周”的概念。

要计算一周中的当前日期，请从[此处](https://discussions.apple.com/thread/1700102?start=0&tstart=0)使用以下命令：

```
NSCalendar *gregorian = [[NSCalendar alloc]  initWithCalendarIdentifier:NSGregorianCalendar];

NSDateComponents *weekdayComponents =[gregorian components:NSWeekdayCalendarUnit fromDate:dateOfInterest];

NSInteger weekday = [weekdayComponents weekday];
// weekday 1 = Sunday for Gregorian calendar

[gregorian release]; 
```

其余的应该是微不足道的。从您的 NSDate 获取当前日期和日期。使用日期和日期查找开始和结束日期（如果今天是星期一，那么`date - 1 day`是一周的第一天等）。找出日期在哪一周。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-17T02:18:25.473

对于 iOS 7 及更高版本，您必须替换`NSWeekCalendarUnit`为`NSCalendarUnitWeekOfYear`

```
- (NSInteger)thisW:(NSDate *)date
{
    NSCalendar *gregorian = [[NSCalendar alloc]
                             initWithCalendarIdentifier:NSGregorianCalendar];
    NSDateComponents *todaysComponents = [gregorian components:NSCalendarUnitWeekOfYear fromDate:[NSDate date]];
    NSUInteger todaysWeek = [todaysComponents weekOfYear];
    NSDateComponents *otherComponents = [gregorian components:NSCalendarUnitWeekOfYear fromDate:date];
    NSUInteger datesWeek = [otherComponents weekOfYear];

    //NSLog(@"Date %@",date);
    if(todaysWeek==datesWeek){
        //NSLog(@"Date is in this week");
        return 1;
    }else if(todaysWeek+1==datesWeek){
        //NSLog(@"Date is in next week");
        return 2;
    } else {
        return 0;
    }

} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-28T15:29:33.593

忘记日期组件，您必须调整很多东西（检查它是否是一年中的最后一周，检查星期日是否是一周的开始......）并且容易出现错误和意大利面条代码。

这解决了您的问题，并扩展到检测“上周”、“前几周”、“本周”、“下周”和“后周”

```
-(EventWeekRange)numberOfWeeksFromTodayToEvent:(NSDate *)eventDate {
    NSCalendar *calendar = [NSCalendar currentCalendar];
    NSComparisonResult comparison = [calendar compareDate:[NSDate date] toDate:eventDate toUnitGranularity:NSCalendarUnitWeekOfYear];
    if (comparison == NSOrderedSame) {
        return RangeThisWeek;
    } else if (comparison == NSOrderedAscending) { // The event date is in the future
        // Advance today's date one week to check if this new date is in the same week as the event
        NSDate *todaysNextWeek = [[NSDate date]dateByAddingTimeInterval:60*60*24*7];
        if ([calendar compareDate:todaysNextWeek toDate:eventDate toUnitGranularity:NSCalendarUnitWeekOfYear] == NSOrderedSame) {
            return RangeNextWeek;
        } else {
            return RangeLater;
        }
    } else { // The event date is in the past
        // Advance the event's date one week to check if this new date is in the same week as today
        NSDate *eventsNextWeek = [eventDate dateByAddingTimeInterval:60*60*24*7];
        if ([calendar compareDate:eventsNextWeek toDate:[NSDate date] toUnitGranularity:NSCalendarUnitWeekOfYear] == NSOrderedSame) {
            return RangeLastWeek;
        } else {
            return RangeEarlier;
        }
    }
} 
```

# apache-poi - 读取 MS Word 字符运行的字符样式和直接格式化

> ID：10143815
> 
> 赞同：1
> 
> 时间：2012-04-13T15:30:53.167
> 
> 标签：apache-poi

使用 Apache POI 库读取 MS Word 文档，如果字符运行具有粗体字符样式，该样式已被直接格式覆盖，因此字符运行不再是粗体，`true`当我期望它是以下返回时`false`：

```
org.apache.poi.hwpf.usermodel.CharacterRun characterRun;
characterRun.isBold(); 
```

有没有办法让字符运行的*粗体*状态同时考虑字符样式和直接格式？

# python - docstring max line-length 与普通 PEP8 标准不同吗？

> ID：10143825
> 
> 赞同：8
> 
> 时间：2012-04-13T15:31:30.350
> 
> 标签：python, pylint, docstring, pep8, code-standards

所以我查看了一些代码并在 pylint 的帮助下将其提升到 PEP 8 标准，我注意到如果我在打印语句中使用三引号，其中文本超过 120 个字符（我们允许 120 而不是 79）pylint没有抱怨。
这是 pylint 中的一个错误，**还是**它认为它可能是一个注释并且对行的长度更宽容，**或者**它不关心你在三引号中使用字符串有多远，因为你可能想以这种方式格式化它们？

*为了清楚起见*：是的 pylint 在超过行长的所有其他情况下都可以正常工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T16:30:16.300

定期使用 pylint 后，我​​也注意到了这种不一致。在[PEP8 的最大行长度部分](http://www.python.org/dev/peps/pep-0008/#maximum-line-length)，它说：

> 因此，请将**所有**行限制为最多 79 个字符。对于流动的长文本块（**文档字符串或注释**），建议将长度限制为 72 个字符。

我知道 pylint 根本没有对文档字符串和注释强制执行 79 个字符或 72 个字符的行长度限制，所以我猜这是一个 pylint 错误，因为它在该领域不符合 PEP8。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T18:37:12.800

作为 pylint 维护者，我可以说这绝对是一个错误。

@Jacxel：如果您在 logilab.org 上注册时遇到问题，您仍然可以在 python-projects@logilab.org 邮件列表上发布 pb

谢谢

# distribution - 使用临时配置文件将应用程序提交到应用商店

> ID：10143826
> 
> 赞同：8
> 
> 时间：2012-04-13T15:31:37.387
> 
> 标签：distribution, ios-provisioning, provisioning-profile, ad-hoc-distribution

我今天向应用商店提交了一个新应用。苹果接受了上传，所以我认为一切都是正确的。但我有一个想法。看看我附上的截图，我使用的分发配置文件，方法设置为“Ad-Hoc”（我使用该配置文件将构建发送到客户端）。应该将其设置为“分发”吗？如果设置为临时应用程序，我担心该应用程序可能会被拒绝。

我应该将其设置为临时，还是将其更改为分发？会不会有问题？

谢谢你。

![在此处输入图像描述](../Images/11012395550924afb56fde85a9ded9d4.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T09:51:14.957

万一有人遇到这种情况，该应用程序已被 Apple 接受并在应用程序商店中提供。但是，我将提交带有发布分发的更新，以确保一切正常。

# php - PHP 表单生成器 - 如何发送电子邮件

> ID：10143828
> 
> 赞同：4
> 
> 时间：2012-04-13T15:31:47.900
> 
> 标签：php, forms, sendmail

我正在使用这个[PHP 表单构建器](http://code.google.com/p/php-form-builder-class/)类，但我认为我缺少最基本的发送电子邮件的方法。我知道足够多的 php 来下载和修改代码，但不太确定如何实现：

```
mail(to,subject,message,headers,parameters) 
```

有谁知道如何在提交表单时使其正常工作并将电子邮件发送给自己？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:35:20.770

查看[PHP 文档](http://php.net/manual/en/function.mail.php)，或者更好地使用一些抽象类，如[swiftmailer](http://swiftmailer.org/)。Swiftmailer 将为您省去一些麻烦，因为它正确设置了标题并且独立于邮件子系统。

[这是一个如何包含 swiftmailer 的基本示例](http://swiftmailer.org/docs/messages.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T15:46:47.847

您不必实现该`mail`函数，它应该[已经存在](http://php.net/manual/en/function.mail.php)，并且从 PHP 4 开始就默认存在。

如果您没有找到某个`mail`函数（或者如果它不工作），那么很可能您没有在 PHP 可以访问 sendmail 命令的机器上运行。[您可以在此处](http://www.php.net/manual/en/mail.requirements.php)阅读有关邮件功能的要求。如果是这种情况（并且您*必须*能够测试电子邮件），那么您将需要获得一个邮件服务器。如果你在 Windows 上，我知道 XAMPP 附带一个，但我通常使用 Linux 机器进行这种开发。

# ruby-on-rails - Ruby on Rails：bbc 代码和性能

> ID：10143831
> 
> 赞同：0
> 
> 时间：2012-04-13T15:32:00.677
> 
> 标签：ruby-on-rails, bbcode

我在 Rails 应用程序中使用 bb-code 来发布和评论。目前，我有以下内容可以将帖子的内容放在视图中：

```
<%= @post.content.bbcode_to_html.html_safe.gsub('<a', '<a rel="nofollow"') %> 
```

将 bb-code 转换为 html 并将“nofollow”添加到所有链接的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T00:23:31.383

您正在使用的`bb-ruby`gem 允许使用作为参数传递给`bbcode_to_html`方法的自定义 BBCode 翻译。但是，如果您真的希望**所有**链接都包含`rel="nofollow"`，我认为您最好的选择是猴子修补它们 gem 本身。基于[BBRuby 源代码](https://github.com/cpjolicoeur/bb-ruby/blob/master/lib/bb-ruby.rb)，您希望执行以下操作：

```
module BBRuby
  @@tags = @@tags.merge({
    'Link' => [
      /\[url=(.*?)\](.*?)\[\/url\]/mi,
      '<a href="\1" rel="nofollow">\2</a>',
      'Hyperlink to somewhere else',
      'Maybe try looking on [url=http://google.com]Google[/url]?',
      :link],
    'Link (Implied)' => [
      /\[url\](.*?)\[\/url\]/mi,
      '<a href="\1" rel="nofollow">\1</a>',
      'Hyperlink (implied)',
      "Maybe try looking on [url]http://google.com[/url]",
      :link],
    'Link (Automatic)' => [
      /(\A|\s)((https?:\/\/|www\.)[^\s<]+)/,
      ' <a href="\2" rel="nofollow">\2</a>',
      'Hyperlink (automatic)',
      'Maybe try looking on http://www.google.com',
      :link]
    })
end 
```

这将重写 BBRuby 转换器以始终包含 nofollow 属性。我会`config/initializers`用一个描述性的文件名把它放进去，比如`bbruby_nofollow_monkeypatch.rb`

至于`html_safe`，我会保持原样。据我了解，这是一种首选方式，我认为它可以让您的意图清晰。上面的猴子补丁使您视图中的行更具可读性：

```
<%= @post.content.bbcode_to_html.html_safe %> 
```

# javascript - 如何在 jqGrid 子网格中设置标题对齐方式？

> ID：10143832
> 
> 赞同：3
> 
> 时间：2012-04-13T15:32:03.800
> 
> 标签：javascript, jquery, jqgrid, subgrid

特别是简单的子网格，而不是“网格作为子网格”。

我尝试了多种方法，但似乎都没有奏效。

如果我挂钩`subGridBeforeExpand`，表格还没有准备好让我选择标题并设置 css。

如果我连接到`subGridRowExpanded`subGrid 甚至不会渲染。

中的`align`属性`subGridModel`仅影响单元格值。

这是我的模型供参考：

```
subGrid: true,
subGridUrl: myUrl,                    
subGridModel: [{ 
     name: ["Item", "Qty"],
     width: ["200", "100"],
     align: ["right", "right"],
     param: ["Id"]
}] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T17:02:34.100

你是对的，Subgrids 和 Treegrids 中的回调太少了。尽管如此，因为我发现您的问题是非常有趣的挑战（来自我的 +1），所以我确实找到了一种解决方法。

您可以执行以下操作：

```
var $grid = $("#grid"), sid;
$grid.jqGrid({
    //... your other settings
    subGrid: true,
    serializeSubGridData: function(p) {
        sid = p.id; // save id from the last request
        return p;
    },
    ajaxSubgridOptions: {
        complete: function (sxml) {
            var ts = $grid[0], $subgridHeaders;
            if (ts.p.subgridtype === "xml") {
                ts.subGridXml (sxml.responseXML, sid);
            } else {
                ts.subGridJson($.jgrid.parse(sxml.responseText), sid);
            }
            // now the subgrid is completed and we can modify
            // style of subgrid headers
            $subgridHeaders = $('#' + $.jgrid.jqID(ts.id + '_' + sid))
                .find("th.ui-th-subgrid");
            // now we can do some custom actions:
            $($subgridHeaders[0]).css("text-align", "left");
            $($subgridHeaders[1]).css("text-align", "right");
        }
    }
}); 
```

您可以[在此处](http://www.ok-soft-gmbh.com/jqGrid/SubgridXmlLoadonce1.htm)演示子网格扩展后如下所示：

![在此处输入图像描述](../Images/2e161d4083c3c3a0cd2483a0cee7b2d2.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-27T10:14:44.207

我已经使用 CSS 选择器解决了问题，例如将第 7 列标题居中：

```
#GRIDID .subgrid-data th:first-child + th + th + th + th + th + th
{
    text-align: center;
} 
```

或将整列居中：

```
#GRIDID .subgrid-data th:first-child + th + th + th + th + th + th,
#GRIDID .subgrid-data td:first-child + td + td + td + td + td + td
{
    text-align: center;
} 
```

# java - Netty 中的 Channel.isWritable 通知

> ID：10143834
> 
> 赞同：5
> 
> 时间：2012-04-13T15:32:09.993
> 
> 标签：java, netty

我有一个场景，我需要继续写一个`Channel`. 如果它无法获取更多数据（因为缓冲区已满等），我需要停止写入，但需要在通道再次变为可写时恢复。当通道再次变为可写时，我如何确定这一时刻？是否有一个我可以覆盖的回调事件被触发？我正在扩展`SimpleChannelUpstreamHandler`我的业务处理程序 - 这有一个方法`channelInterestChanged()`- 但不确定这是否是正确的钩子？

我希望避免使用原始的基于线程的等待机制，例如等待通知，因为这些将涉及上下文切换。任何非阻塞方式来实现这种等待？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-13T18:34:54.330

您可以覆盖该`channelInterestChanged()`方法。

像这样的东西：

```
public class MyHandler extends SimpleChannelUpstreamHandler {
    ....

    @Override
    public void channelInterestChanged(ChannelHandlerContext ctx, ChannelStateEvent e) throws Exception {
        if (e.getChannel().isWritable() {
            .....
        }
    }
} 
```

这应该做的工作

# unicode - 为什么没有 UTF-24？

> ID：10143836
> 
> 赞同：27
> 
> 时间：2012-04-13T15:32:28.963
> 
> 标签：unicode, character-encoding, utf-32

> **可能重复：**
> [为什么存在 UTF-32 而编码每个字符只需要 21 位？](https://stackoverflow.com/questions/6339756/why-utf-32-exists-whereas-only-21-bits-are-necessary-to-encode-every-character)

UTF-32 中的最大 Unicode 代码点为 0x10FFFF。UTF-32 有 21 个信息位和 11 个多余的空白位。那么为什么没有 UTF-24 编码（即去掉高字节的 UTF-32）将每个代码点存储在 3 个字节而不是 4 个字节中呢？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-13T15:36:54.813

好吧，事实是：UTF-24 是在 2007 年提出的：

[http://unicode.org/mail-arch/unicode-ml/y2007-m01/0057.html](http://unicode.org/mail-arch/unicode-ml/y2007-m01/0057.html)

提到的优点和缺点是：

> ```
> "UTF-24 
> Advantages: 
>  1\. Fixed length code units. 
>  2\. Encoding format is easily detectable for any content, even if mislabeled. 
>  3\. Byte order can be reliably detected without the use of BOM, even for single-code-unit data. 
>  4\. If octets are dropped / inserted, decoder can resync at next valid code unit. 
>  5\. Practical for both internal processing and storage / interchange. 
>  6\. Conversion to code point scalar values is more trivial then for UTF-16 surrogate pairs 
>     and UTF-7/8 multibyte sequences. 
>  7\. 7-bit transparent version can be easily derived. 
>  8\. Most compact for texts in archaic scripts. 
> Disadvantages: 
>  1\. Takes more space then UTF-8/16, except for texts in archaic scripts. 
>  2\. Comparing to UTF-32, extra bitwise operations required to convert to code point scalar values. 
>  3\. Incompatible with many legacy text-processing tools and protocols. " 
> ```

[正如 David Starner 在http://www.mail-archive.com/unicode@unicode.org/msg16011.html](http://www.mail-archive.com/unicode@unicode.org/msg16011.html)中指出的那样：

> 为什么？UTF-24 几乎总是会比 UTF-16 大，除非您正在谈论旧斜体或哥特体的文档。数学字母数字字符几乎总是与足够的 ASCII 组合以使 UTF-8 获胜，如果没有，则有足够的 BMP 字符以使 UTF-16 获胜。现代计算机不能很好地处理 24 位块。在内存中，它们会占用 32 位，除非您声明它们已打包，然后它们会比 UTF-16 或 UTF-32 慢很多。如果您要存储到磁盘，您还可以使用 BOCU 或 SCSU（您已经使用非标准），或者使用 UTF-8、UTF-16、BOCU 或 SCSU 的标准压缩。压缩后的 SCSU 或 BOCU 应该占用 UTF-24 的一半空间，如果那样的话。

您还可以查看以下 StackOverflow 帖子：

[为什么存在 UTF-32 而编码每个字符只需要 21 位？](https://stackoverflow.com/questions/6339756/why-utf-32-exists-whereas-only-21-bits-are-necessary-to-encode-every-character)

# github - 对上游仓库的拉取请求包含以前从上游仓库获取/合并的提交？

> ID：10143842
> 
> 赞同：5
> 
> 时间：2012-04-13T15:32:53.557
> 
> 标签：github

我是 git 和 github 的新手，所以为新手问题道歉。我已经搜索了文档并且无法说出我做错了什么，或者即使我做错了......

我在 github 上创建了一个 repo，将其克隆到本地，在几个分支中进行了一些更改，在本地提交了这些更改，并将它们推送到我在 github 上的 fork repo。虽然我一直在研究这些东西，但我从上游回购中做出了各种提交。我不确定这是否是正确的做法，但我获取并合并了这些上游更改，然后再次推送到我的 fork。

现在，我想向上游仓库发送拉取请求。但是当我开始这样做时，github 会列出所有将成为拉取请求一部分的提交，并且它包括已经对上游 repo 进行的所有更改，这些更改我已经获取并合并了。

这似乎不对。我需要在这里做什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T20:14:04.073

这没关系，因为您已将这些提交推送到您的分叉存储库，因此它们在逻辑上属于您的拉取请求。

当上游仓库的所有者合并拉取请求时，Git 会检测到它已经“包含”了一些提交，并且只会合并您的更改。

只需创建您的拉取请求，您就可以了。

# python - 在python中迭代增长一个打乱的列表

> ID：10143844
> 
> 赞同：0
> 
> 时间：2012-04-13T15:33:01.720
> 
> 标签：python, list, random

我正在尝试迭代地打乱一个包含 4 个元素的列表，然后将打乱的列表附加到一个不断增长的列表中。结果将是一个长度为 4 个元素的倍数的列表，每四个元素是我原始列表的某种组合。

我的代码是

```
import random
list1 = ['X','Y','Z','Q']
list2 = []
for drop in range(0,72/4):
     random.shuffle(list1)
     list2.append(list1) 
```

我似乎遇到的问题是 list2 将一遍又一遍地成为 list1 的相同洗牌版本。

示例列表2：['Q','X',Z','Y','Q','X',Z','Y','Q','X',Z','Y',。 ..]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T15:38:37.133

我想你想写

```
list2.extend(list1) 
```

否则，您将一遍又一遍地将对象 list1的**相同实例添加到 list2。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T15:53:43.487

当您将一个列表附加到另一个列表时，您并没有制作该列表的副本 - 您正在将另一个引用附加到原始列表。你所有的追加尝试实际上都是对同一个对象的引用，对一个对象的修改就是对所有对象的修改。

这是这个令人惊讶的结果的演示。

```
>>> list1 = ['X', 'Y', 'Z', 'Q']
>>> list2 = []
>>> list2.append(list1)
>>> list2.append(list1)
>>> list2
[['X', 'Y', 'Z', 'Q'], ['X', 'Y', 'Z', 'Q']]
>>> list2[0][0] = 'A'
>>> list2
[['A', 'Y', 'Z', 'Q'], ['A', 'Y', 'Z', 'Q']]
>>> list1[0] = 'B'
>>> list2
[['B', 'Y', 'Z', 'Q'], ['B', 'Y', 'Z', 'Q']] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:41:11.843

当您将 list1 随机播放到位时，您会随机播放 list1 的所有实例。当您将 list1 附加到 list2 时，您只是一遍又一遍地改组同一个列表。

尝试使用[深拷贝](http://docs.python.org/library/copy.html)

```
import random, copy
list1 = [1,2,3,4]
list2 = []
for i in xrange(10):
    random.shuffle(list1)
    list2.append(copy.deepcopy(list1)) 
```

# java - 为什么在这种情况下使用接口而不是抽象类？

> ID：10143847
> 
> 赞同：3
> 
> 时间：2012-04-13T15:33:24.150
> 
> 标签：java, inheritance, interface

我在这里读了一篇博文：http: [//codeofdoom.com/wordpress/2009/02/12/learn-this-when-to-use-an-abstract-class-and-an-interface/](http://codeofdoom.com/wordpress/2009/02/12/learn-this-when-to-use-an-abstract-class-and-an-interface/)

```
public interface Actor{
   Performance say(Line l);
}
public interface Director{
   Movie direct(boolean goodmovie);
}
public interface ActorDirector extends Actor, Director{
...
} 
```

它说：实际上，有些演员也是导演。如果我们使用接口而不是抽象类。*我们可以使用抽象类来实现同样的目的。不幸的是，替代方案需要多达**2^n**（其中 n 是**属性**的数量）可能的组合才能支持所有可能性。*

问题：为什么抽象类在这里更好？为什么 2^n ？

```
public abstract class ActorDirector implements Actor,Director{
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-13T15:35:46.497

您不能从多个类（抽象或非抽象）继承，但可以实现多个接口

如果要创建抽象类，则每个组合都需要一个（n 个属性：2^n 个可能的组合）——以确保每个组合都可以在需要时继承。

如果你使用接口，你只需要定义n个接口（每个属性一个）并根据需要实现它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:37:44.707

在决定是否需要`Abstract`上课时，您需要回答的问题很简单；

实现这些接口中的任何一个的任何类之间共享的任何方法是否有任何通用**实现？**如果**是**，那么您将把该实现放在一个`AbstractClass`.

如果**不是**这样，那么您只需将两者组合成一个`Interface`，并让所有实现类都提供它们的自定义、非共享实现。

肯定有一个论据要做到这两点。拥有一个允许解决单一继承限制`Abstract`的超级接口，以及该超级接口的实现，以便为接口中任何方法的任何共享默认实现提供高内聚性。

您获得的错误解决这些问题的经验越多，这些决定就越容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T15:44:35.237

我认为您误解了该帖子：作者并不是说在这种情况下抽象类更好 - 相反，他认为接口更适合。

就`2^n`（或更准确地说`2^n-1`）而言，这个数字来自于意识到如果你有`n`正交行为契约，你可以`2^n-1`从它们中进行非空组合。如果您使用接口将契约添加到实现它们的类中，那么您只需要与行为一样多的接口：用户将能够对他选择实现的行为进行组合，最多`2^n-1`. 如果您尝试使用抽象类实现同样的灵活性，那么您最终不仅会创建您想要的实现，而且还会创建*一直到单个 root 所需的所有中间*实现，因为 Java 允许您一次只继承一个类.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T16:30:49.337

继承分为两部分：

1.  派生类可以将其父类的公共或受保护方法或字段视为自己的。
2.  在请求后者的大多数上下文中，派生类型对象可以替代基类型对象。

实现接口的类只能获得后者的好处，但是从抽象类继承的类可以实现两者。另一方面，这个好处带来了一个限制：因为一个类只能将另一个类的方法和字段视为自己的，所以一个类只能从一个抽象类继承。相比之下，一个类可以实现（因此可以替代）任意数量的接口。

不要担心抽象类的组合爆炸。假设一些车辆可以转向（例如 CompactCar），其他车辆可以 AttachFollower（例如铁路机车），而有些车辆可以同时进行（例如 PickupTruck）。a`PickupTruck`应该可以满足需要能够实现的车辆`Steer`的代码，以及需要能够执行的车辆的代码`AttachFollower`。但是，如果`Steer`和`AttachFollower`都是抽象类，则无法声明`PickupTruck`一个实例可以执行这两种功能。最好的办法是定义一个' SteerableAndHitchable `abstract class which inerits from`Steerable `and includes a`TrailerHitch`member of type`Attachable`，但那种东西即使只有两个能力也很恶心。以类型安全的方式添加更多功能不仅需要爆炸性数量的类；它将需要每个类别的属性数量不断增加。

# python - 在python中反转字符串

> ID：10143848
> 
> 赞同：1
> 
> 时间：2012-04-13T15:33:35.467
> 
> 标签：python

我想在一个字符串中找到一个回文。

```
mystring = "1234321" 
```

为什么

```
mystring[3:7:-1] 
```

不工作，但是

```
second = mystring[3:7]
reversed = second[::-1] 
```

这个工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-13T15:35:20.620

因为你必须告诉python用结束索引“开始”，用开始索引“结束”：

```
>>> "0123456789"[7:3:-1]
'7654' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:40:28.067

当您像这样动态地反转字符串时，您需要首先放置较大的索引。你应该使用：

```
mystring[7:3:-1] 
```

代替：

```
mystring[3:7:-1] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:44:06.330

mystring[::-1] 表示开始和结束。

使用 [3:7:-1] 你给出一个“增量”，开始索引和结束索引，但你也立即超出了你的字符串边界......

# php - 调用常量会导致难以理解的解析错误

> ID：10143851
> 
> 赞同：0
> 
> 时间：2012-04-13T15:33:46.163
> 
> 标签：php, class, constants, syntax-error

我被一个令我抓狂的难以理解的语法错误所阻止：/

显示的错误是`Parse error: syntax error, unexpected '.', expecting ',' or ';'`

这是实现这一点的代码：

```
class FamillePieceControllerCore extends FrontController
{
    public $php_self = 'famille-piece.php';

    private $webservice_url = _CICERONE_CONNECT_BASE_URL_ . 'WSC003&P2=0';
} 
```

在`_CICERONE_CONNECT_BASE_URL_` 其他文件中定义的位置。

如果我删除`. 'WSC003&P2=0'`代码工作正常。

我不明白：/感谢您的帮助

ps：我用的是php 5.3.8

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:35:58.140

您不能使用表达式（如串联）初始化类属性。相反，您必须在构造函数中执行此操作：

```
class FamillePieceControllerCore extends FrontController
{
    public $php_self = 'famille-piece.php';

    private $webservice_url;
    public function __construct() {
      $this->webservice_url = _CICERONE_CONNECT_BASE_URL_ . 'WSC003&P2=0';
    }
} 
```

[从文档中：](http://www.php.net/manual/en/language.oop5.properties.php)

> 类成员变量称为“属性”。您可能还会看到使用“属性”或“字段”等其他术语来提及它们，但出于本参考的目的，我们将使用“属性”。它们是通过使用关键字`public`、`protected`或之一来定义的`private`，后跟一个普通的变量声明。 
> 
> 这个声明可能包括一个初始化，但是这个初始化必须是一个常量值——也就是说，它必须能够在编译时被评估，并且不能依赖于运行时信息才能被评估。

定义的常量`define()`是在运行时定义的，因此`_CICERONE_CONNECT_BASE_URL_`在编译时初始化属性时不知道 的值。

### 更新以后的 PHP 版本：

从 PHP 5.6 开始，类属性声明中允许使用简单表达式，只要它们仍然可以在编译时求值。因此，原始发布的代码将在 PHP 5.6+ 中正确编译和执行。仍然不允许任何需要运行时评估的东西，例如函数调用或变量插值。

```
// This is okay in PHP 5.6+
public $property = SOME_CONST . " other stuff";

// This is still not possible since
public $property = strlen(SOME_CONST); 
```

# reporting-services - 如何创建报告“PBI 的错误列表”

> ID：10143855
> 
> 赞同：1
> 
> 时间：2012-04-13T15:33:57.730
> 
> 标签：reporting-services, mdx

我想使用 SQL Report Builder 2.0 和 TFS 2010 创建一个报告，显示每个 PBI 的错误列表。

有人可以帮我解决 MDX 查询吗？（最好使用 Report Builder 2.0 的查询生成器）我尝试了很多东西，但没有一个成功。

我们使用 Scrum1.0 模板和 Microsoft Test Manager，所以工作项层次结构是这样的：PBI -> Test Case (link type: Tested By) Test Case -> Test Result (link type: ?) Test Result -> Bug （链接类型：父）

注意：还有一个测试用例 -> 错误链接（类型：测试），但是当使用测试管理器的“复制并添加到测试套件”功能时，这也可能包含原始测试用例中的其他错误

谢谢！

# amazon-ec2 - 如何将 OpenGeo EC2 AMI 转换为 EBS 支持的？

> ID：10143858
> 
> 赞同：1
> 
> 时间：2012-04-13T15:34:07.707
> 
> 标签：amazon-ec2, amazon-web-services, amazon-ebs, amazon-ami

我是一个新手，我的知识非常低，如果我没有让自己清楚，请见谅。我想启动 OpenGeo AMI 的 EC2 实例，但我注意到我无法停止此实例，因为它不使用 EBS。我尝试启动 OpenGeo 实例，然后附加 EBS 卷，但仍然没有可用的停止功能。我认为我应该在启动实例时创建一个在用户文本中插入命令的 EBS 卷，但这只是一个理论。能不能给我一个解决方案，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T16:17:11.103

### 更新

刚刚意识到亚马逊网络服务上似乎也有免费的[OpenGeo Suite 社区版](http://blog.opengeo.org/2010/09/13/opengeo-suite-community-edition-on-amazon-web-services/)。因此，您可以通过下面我最初回答中引用的文章获得成功。

祝你好运！

* * *

### 初步答案

鉴于这似乎是付费 AMI，恐怕这是不可能的，请参阅常见问题解答[我可以创建由 Amazon EBS 快照支持的付费 AMI 吗？](http://aws.amazon.com/devpay/faqs/#Can_I_create_paid_AMIs_backed_by_Amazon_EBS_snapshots)：

> 否。目前，Amazon DevPay 仅支持由 Amazon S3 支持的 AMI。这意味着您的客户还不能使用利用 Amazon EBS 支持的根设备的 Amazon EC2 实例。

否则，我建议首先要求 AMI 创建者提供 EBS 支持的替代或同时提供，请参阅 Eric Hammond 的优秀摘要[您应该在 Amazon EC2 上使用 EBS 引导实例，](http://alestic.com/2012/01/ec2-ebs-boot-recommended)了解为什么这几乎总是更可取的。

最后，[创建 Amazon EBS 支持](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/creating-an-ami-ebs.html)的 AMI中*的将 Amazon EC2 实例存储支持的 AMI 转换为 EBS*支持的 AMI 部分回答了您的问题，但这不是一个简单的过程：

> AWS 管理控制台中没有简单的 API 或按钮可以将现有的 Amazon EC2 实例存储支持的 AMI 转换为 Amazon EBS 支持的 AMI。[...]

所需步骤仅在以下段落中相应地简要概述。

不过，还有很多其他帖子会更详细地介绍，例如[从 S3 支持的 AMI 创建 EBS 支持的 AMI](http://www.elastician.com/2009/12/creating-ebs-backed-ami-from-s3-backed.html)、[Amazon EC2 – 从 EBS 启动和 AMI 转换](http://coderslike.us/2009/12/07/amazon-ec2-boot-from-ebs-and-ami-conversion/)或[Amazon EC2 - 将根实例存储设备与 EBS 设备交换](https://stackoverflow.com/questions/2082724/amazon-ec2-swap-root-instance-store-device-with-ebs-device)。

# c# - GAC 程序集读取注册表 - c#

> ID：10143860
> 
> 赞同：1
> 
> 时间：2012-04-13T15:34:24.703
> 
> 标签：c#, registry, 64-bit

我有一个安装在 GAC 中的程序集。这个程序集可以访问注册表值吗`HKEY_LOCAL_MACHINE\SOFTWARE\COMPANYNAME`

我没有收到任何错误，但无法从上述路径读取子项。我的程序集签名强烈。

我使用注册表的原因是因为不允许使用配置文件。

示例代码

```
string regKey = "HKEY_LOCAL_MACHINE\SOFTWARE\COMPANYNAME";
string userGUID = (string)Registry.GetValue(regKey, "userGUID", "-1"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T17:21:04.473

如果您正在运行 64 位操作系统并且您的程序集是 x86，或者由 x86 进程调用，那么您的注册表调用将重定向到`HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\COMPANYNAME`node.js。这可能是您问题的根源。

# django - Django 信号接收器函数的规范位置

> ID：10143862
> 
> 赞同：1
> 
> 时间：2012-04-13T15:34:30.600
> 
> 标签：django

是否有实现 Django 信号接收器功能的规范位置？[文档](https://docs.djangoproject.com/en/dev/topics/signals/)建议models.py，但在我看来，如果将它们组织到一个单独的文件中会更干净。（例如，handlers.py、receivers.py）

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-13T16:34:37.913

文档推荐 models.py 因为它是一个始终为每个应用程序加载的文件。你可以使用任何你喜欢的文件结构，但是不，Django 不会为信号寻找特定的文件。您必须导入处理程序并将它们连接到 models.py 中。例如：

### 处理程序.py

```
def my_post_save_handler(sender, instance, created, *args, **kwargs):
    # do something 
```

### 模型.py

```
from handlers import my_post_save_handler

post_save.connect(my_post_save_handler, sender=MyClass) 
```

# jquery - 一张一张地填充瓷砖，甚至不同的宽度和高度

> ID：10143867
> 
> 赞同：0
> 
> 时间：2012-04-13T15:34:37.673
> 
> 标签：jquery, html, css

请参考图片，我想一旦你看到就会意识到这个问题。

我以两种方式测试了这个图块，比如 UL、LI 列表和一组 DIV，但都没有成功。我刚刚添加了 float:left 但如您所见，在第三行中，在高瓷砖之后，第四行项目没有填充到空间中。

如果含义不正确，请更改名称并用谷歌搜索但找不到应该是我的关键字想要丰富。请指导我。

![在此处输入图像描述](../Images/1ce6d3ee216d9fe69ee2b64dd99b6387.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T16:32:36.430

我使用[JQuery Masonry](http://masonry.desandro.com/)进行这样的设计。

将它的 CSS 与 JQuery 一起使用，您应该能够轻松获得所需的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T18:06:27.967

`html`

```
<table border="1">
  <tr>
      <td></td>
      <td></td>
      <td></td>
  </tr>
  <tr>
    <td colspan=2></td>
    <td></td>
  </tr>
  <tr>
    <td></td>
    <td></td>
    <td rowspan=2></td>
  </tr>
    <tr>
    <td colspan=2></td>
  </tr>
  <tr>
      <td></td>
      <td></td>
      <td></td>
  </tr>
</table>​ 
```

`css`

```
table {background:black;}
td {background:blue;width:40px;height:40px;}​ 
```

# sql - 与只有多个空格的列匹配的 Sql Like 运算符

> ID：10143874
> 
> 赞同：2
> 
> 时间：2012-04-13T15:35:11.317
> 
> 标签：sql, sql-server

如何使用“like”运算符编写查询，该运算符仅匹配包含多个空格的文本字段，仅此而已。例如' '、' '、' '等是应该被找到的字符串。'text', 'text' -- 不应包含在结果集中 (Sql Server 2008 R2)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:36:30.343

您可以使用`RTRIM`or`LTRIM`并检查空字符串，但是，正如 JNK 指出的那样，在 SQL Server 中，您只需检查空字符串，它将忽略空格。[这是一个显示的 SQL 小提琴](http://sqlfiddle.com/#!3/30d2e/2)

小提琴的代码

```
create table x ( y varchar(20))
insert into x values ('        ')
select 'TRUE' from x where y = '' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:38:21.987

在 SQL Server 中，字符串比较会忽略前导空格和尾随空格。

这意味着您只需与空字符串进行比较即可获得所需的结果：

`WHERE SomeVarchar = ''`

即使 SomeVarChar 是一系列 20 个空格，这也将评估为 true：

```
SELECT 'True'
WHERE '                     ' = '' 
```

# javascript - 查找具有指定 z-index 的元素

> ID：10143875
> 
> 赞同：11
> 
> 时间：2012-04-13T15:35:19.633
> 
> 标签：javascript, jquery

例如，如何找到`z-index`= 10 的 HTML 元素（-s）？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-13T15:38:16.120

您必须遍历所有元素并检查它们的 z-index：

```
$('*').filter(function() {
    return $(this).css('z-index') == 10;
}).each(function() {
    // do something with them   
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T15:38:32.127

一种可能的 [jQuery] 解决方案：

```
$(".elementsToSearch").each(function()
{
    if($(this).css('z-index') == 10)
    {
        //then it's a match
    }
}); 
```

只需遍历元素以搜索与 css 规则匹配的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-13T15:39:30.633

您可以获取所有元素并通过 css 属性对其进行过滤：

```
$('*').each(function(){
    if($(this).css('z-index') == 10) {
        //$(this) - is element what you need
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-27T16:34:17.710

在我对 Chrome 43 的测试中，我发现[@ThiefMaster 的帖子](https://stackoverflow.com/a/10143923/444382)很有帮助，但不是 100%。`z-index`被拉取的值是一个字符串。

我还让这个只遍历可见元素和句柄`auto`。

这是我的更新：

```
var topZ = $('.thing-in-front').css('z-index')
if (topZ != 'auto') {
    topZ = parseInt(topZ);
    $('*:visible').filter(function() {
        var thisZ = $(this).css('z-index')
        return thisZ != 'auto' && parseInt(thisZ) >= topZ;
    }).each(function() {
        $(this).css('z-index', topZ - 1);
    })
} 
```

# hibernate - 在调用 clear() 之前，使用 flushMode=AUTO 的休眠查询要慢得多

> ID：10143880
> 
> 赞同：22
> 
> 时间：2012-04-13T15:35:32.447
> 
> 标签：hibernate, jpa

我有一个使用 Hibernate（通过 JPA）的长时间运行（但相当简单）的应用程序。它在运行时正在经历相当*剧烈的*减速。我已经能够缩小到需要偶尔`entityManager.clear()`打电话的范围。当 Hibernate 的实体管理器跟踪 100,000 个实体时，它比只跟踪少数实体时慢约 100 倍（见下面的结果）。 **我的问题是：*为什么*Hiberate 在跟踪很多实体时会减慢这么多？还有其他方法吗？**

* * *

**！！！更新：我已经能够将其缩小到 Hibernate 的自动刷新代码。！！！**

具体到`org.hibernate.event.internal.AbstractFlushingEventListener`'`flushEntities()`方法（至少在 Hibernate 4.1.1.Final 中）。其中有一个循环遍历持久性上下文中的**所有**实体，围绕刷新每个实体执行一些广泛的检查（即使在我的示例中所有实体都已刷新！）。

因此，部分回答了我的问题的第二部分，可以通过`FlushModeType.COMMIT`在查询上设置刷新模式来解决性能问题（请参阅下面的更新结果）。例如

```
Place place = em.createQuery("from Place where name = :name", Place.class)
    .setParameter("name", name)
    .setFlushMode(FlushModeType.COMMIT)  // <-- yay!
    .getSingleResult(); 
```

...但这似乎是一个相当丑陋的解决方案——将了解事物是否刷新到查询方法而不是将其保留在更新方法中的责任。这也几乎意味着我必须在所有查询方法上将刷新模式设置为 COMMIT，或者更有可能在 EntityManager 上设置它。

这让我想知道：这是预期的行为吗？我在冲洗或如何定义实体方面做错了吗？或者这是 Hibernate 的限制（或可能存在的错误）？

* * *

我用来隔离问题的示例代码如下：

## 测试实体

```
@Entity @Table(name="place") @Immutable
public class Place {
    private Long _id;
    private String _name;

    @Id @GeneratedValue
    public Long getId() { return _id; }
    public void setId(Long id) { _id = id; }

    @Basic(optional=false) @Column(name="name", length=700,
        updatable=false, nullable=false, unique=true,
        columnDefinition="varchar(700) character set 'ascii' not null")
    public String getName() { return _name; }
    public void setName(String name) { _name = name; }

    @Override
    public boolean equals(Object o) { /* ... */ }

    @Override
    public int hashCode() { return getName().hashCode(); }
} 
```

## 基准代码

我的测试代码生成 100000 个随机地名并插入它们。然后按名称随机查询其中的 5000 个。名称列上有一个索引。

```
Place place = em.createQuery(
    "select p from Place p where p.name = :name", Place.class)
    .setParameter("name", name)
    .getSingleResult(); 
```

为了比较，并确保它不在数据库中，我在`em.unwrap(Session.class).doWork(...)`一个单独的随机选择的 5000 个地名上运行了以下基于 JDBC 的查询（在 下）：

```
PreparedStatement ps = c.prepareStatement(
    "select id, name from place where name = ?");
ps.setString(1, name);
ResultSet rs = ps.executeQuery();
while (rs.next()) {
    Place place = new Place();
    place.setId(rs.getLong(1));
    place.setName(rs.getString(2));
}
rs.close();
ps.close(); 
```

（注意，我确实为基准测试的 5000 个查询中的每一个创建并关闭了 PreparedStatement）。

## 结果

以下所有结果均超过 5000 个查询的平均值。JVM被给了`-Xmx1G`

```
Seconds/Query    Approach
0.000160s        JDBC
0.000286s        Hibernate calling clear() after import and every 100 queries
0.000653s        Hibernate calling clear() once after the import
0.012533s        Hibernate w/o calling clear() at all
0.000292s        Hibernate w/o calling clear(), and with flush-mode COMMIT 
```

其他观察结果：在 Hibernate 查询期间（没有任何 clear 调用），java 进程将一个核心固定在接近 100% 的利用率。JVM 从未超过 500MB 堆。查询期间也有很多 GC 活动，但 CPU 利用率显然由 Hibernate 代码主导。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-09-22T20:37:12.390

> 但主要是我很好奇为什么 Hibernate 似乎对查询表现出 O(n) 甚至 O(n^2) 查找 - 似乎它应该能够在引擎盖下使用哈希表或二叉树来保持查询快速地。当它跟踪 100000 个实体与 100 个实体时，请注意 2 个数量级的差异。

O(n²) 复杂度源于必须处理查询的方式。由于 Hibernate 在内部尽可能地延迟更新和插入（利用机会将类似的更新/插入组合在一起，尤其是在您设置对象的多个属性时）。

因此，在您可以保存查询数据库中的对象之前，Hibernate 必须检测所有对象更改并刷新所有更改。这里的问题是hibernate也有一些通知和拦截。所以它遍历持久化上下文管理的每个实体对象。即使对象本身是不可变的，它也可能包含可变对象甚至引用集合。

此外，拦截机制允许您访问任何被认为是脏的对象，以允许您自己的代码实现额外的脏度检查或执行额外的计算，如计算总和、平均值、记录额外信息等。

但是让我们看一下代码：

准备查询的刷新调用导致：

```
DefaultFlushEventListener.onFlush(..) 
```

-> AbstractFlushingEventListener.flushEverythingToExecution(事件) -> AbstractFlushingEventListener.prepareEntityFlushes(..)

该实现使用：

```
for ( Map.Entry me : IdentityMap.concurrentEntries( persistenceContext.getEntityEntries() ) ) {
        EntityEntry entry = (EntityEntry) me.getValue();
        Status status = entry.getStatus();
        if ( status == Status.MANAGED || status == Status.SAVING || status == Status.READ_ONLY ) {
            cascadeOnFlush( session, entry.getPersister(), me.getKey(), anything );
        }
    } 
```

如您所见，持久性上下文中所有实体的映射被检索和迭代。

这意味着对于查询的每次调用，您都会遍历所有以前的结果以检查脏对象。甚至更多的 cascadeOnFlush 创建一个新的 Object 并做更多的事情。这是 cascadeOnFlush 的代码：

```
private void cascadeOnFlush(EventSource session, EntityPersister persister, Object object, Object anything)
throws HibernateException {
    session.getPersistenceContext().incrementCascadeLevel();
    try {
        new Cascade( getCascadingAction(), Cascade.BEFORE_FLUSH, session )
        .cascade( persister, object, anything );
    }
    finally {
        session.getPersistenceContext().decrementCascadeLevel();
    }
} 
```

所以这就是解释。每次发出查询时，Hibernate 都会检查持久性上下文管理的每个对象。

因此，对于阅读本文的每个人来说，这里是复杂度计算： 1\. 查询：0 个实体 2\. 查询：1 个实体 3\. 查询：2 个实体 .. 100\. 查询：100 个实体。.. 100k + 1 个查询：100k 个条目

所以我们有 O(0+1+2...+n) = O(n(n+1)/2) = O(n²)。

这解释了你的观察。为了保持较小的 cpu 和内存占用，休眠托管持久性上下文应保持尽可能小。让 Hibernate 管理超过 100 个或 1000 个实体会大大降低 Hibernate 的速度。在这里应该考虑更改刷新模式，使用第二个会话进行查询和一个更改（如果可能的话）或使用无状态会话。

所以你的观察是正确的，它是 O(n²) 。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-13T16:22:38.653

也许您熟悉`EntityManager`跟踪持久对象（即通过调用创建的对象`em.createQuery(...).getSingleResult()`）。它们累积在所谓的*持久上下文*或*会话*（Hibernate 术语）中，并允许非常**简洁**的功能。例如，您可以通过调用 mutator 方法来修改对象，`setName(...)`并且`EntityManager`将在适当的时候将内存中的此状态更改与数据库同步（将发出 UPDATE 语句）。无需您调用显式`save()`或`update()`方法即可发生这种情况。您所需要的只是像处理普通 Java 对象一样使用该对象，并`EntityManager`负责持久性。

**为什么这很慢（呃）？**

一方面，它确保内存中每个主键**只有一个实例。**这意味着如果您加载同一行两次，堆中只会创建一个对象（两个结果都是`==`）。这很有意义 - 想象一下，如果您有 2 个同一行的副本，`EntityManager`则不能保证它可靠地同步 Java 对象，因为您可以独立地对两个对象进行更改。`Entitymanager`如果有很多必须跟踪的对象，也许还有很多其他低级操作最终会减慢速度。这些`clear()`方法实际上删除了持久上下文中的对象并使任务更容易（要跟踪的对象更少=操作更快）。

**你怎么能绕过它？**

如果你的`EntityManager`实现是 Hibernate，你可以使用[StatelessSession](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/batch.html)来解决这些性能损失。我认为你可以通过它：

`StatelessSession session = ((Session) entityManager.getDelegate()).getSessionFactory().openStatelessSession();`

（注意！代码未经测试，取自另一个[问题](https://stackoverflow.com/a/5182888/848569)）

# android - 如何在 ViewPager 中获取对 Fragment 的引用？

> ID：10143882
> 
> 赞同：6
> 
> 时间：2012-04-13T15:35:36.470
> 
> 标签：android, android-fragments

我发现的唯一记录方式是：

```
MyFragment fragment = (MyFragment) getSupportFragmentManager().findFragmentById(R.id.fragment); 
```

但是由于 Fragment 是在 ViewPager 中实例化的，所以我没有 id。

```
 List<Fragment> fragments = new Vector<Fragment>();
    fragments.add(Fragment.instantiate(this, Fragment1.class.getName()));
    fragments.add(Fragment.instantiate(this, Fragment2.class.getName()));
    fragments.add(Fragment.instantiate(this, Fragment3.class.getName())); 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T15:53:32.863

您似乎将所有片段都保存在 oh-so-obsolete`Vector`中。在这种情况下，您将从相同的`Vector`. 例如，调用`getCurrentItem()`以`ViewPager`查找当前选择的片段索引，然后调用具有`get()`该`Vector`索引的 。

但是请注意，如果您依赖`FragmentPagerAdapter`或`FragmentStatePagerAdapter`保存您的片段，则给定索引的片段可能不存在，因为它尚未创建或已被丢弃以最小化内存消耗。

（顺便说一句，有关更多信息，请参阅[为什么 Java Vector 类被认为已过时或已弃用？](https://stackoverflow.com/questions/1386275/why-java-vector-class-is-considered-obsolete-or-deprecated)`Vector`）

# database - lua 和 lsqlite3：加速 select 语句

> ID：10143886
> 
> 赞同：1
> 
> 时间：2012-04-13T15:35:56.573
> 
> 标签：database, performance, sqlite, lua

我正在使用 lsqlite3 lua 包装器，并且正在对数据库进行查询。我的数据库有大约 500 万行，我用来检索行的代码类似于：

```
db = lsqlite3.open('mydb')
local temp = {}
local sql = "SELECT A,B FROM tab where FOO=BAR ORDER BY A DESC LIMIT N"
for row in db:nrows(sql) do temp[row['key']] = row['col1'] end 
```

如您所见，我正在尝试`N`按降序对顶行进行排序`FOO`（我想获取顶行，然后应用而`LIMIT`不是相反）。我为该列编制了索引，`A`但似乎没有太大区别。我怎样才能让它更快？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:42:40.807

您需要索引您过滤的列（即使用 WHERE 子句）。原因是 ORDER BY*在*过滤后发挥作用，而不是相反。

所以你可能应该在 FOO 上创建一个索引。

你能发布你的表模式吗？

**更新**

您还可以增加[sqlite 缓存](http://www.sqlite.org/pragma.html#pragma_cache_size)，例如：

```
PRAGMA cache_size=100000 
```

您可以根据可用内存和数据库大小进行调整。

**更新 2**

如果您想更好地了解 sqlite 如何处理您的查询，您可以要求它为您提供查询计划：

[http://www.sqlite.org/eqp.html](http://www.sqlite.org/eqp.html)

**更新 3**

我最初的回答没有正确理解您的上下文。如果您要对一些大型数据集进行 ORDER BY，您可能希望使用该索引，而不是前一个，因此您可以告诉 sqlite 不要以这种方式使用 FOO 上的索引：

```
SELECT a, b FROM foo WHERE +a > 30 ORDER BY b 
```

# c# - 如何在 C# 和 SQL Server 中实现自动完成功能，值得吗？

> ID：10143889
> 
> 赞同：2
> 
> 时间：2012-04-13T15:35:58.360
> 
> 标签：c#, sql-server, winforms

所以这是我正在尝试做的一个例子。假设我正在制作一个足球比赛提交程序，并且我有一些我应该填写的字段，其中 2 个我想要自动完成。一个文本框用于主队，一个文本框用于客队。

以下是数据库表的简化示例：

```
-----------------------------
|  home_team  |  away_team  |
-----------------------------
|  Chelsea FC |   Arsenal   |
|  Liverpool  |  Norwich FC |
|  Man. City  |   Everton   |
|  Tottenham  | Stoke City  | 
```

当我在两个文本框中的任何一个中键入内容时，我希望程序加载建议或结果来检查表中的每个团队。这是为了根据以前的提交更轻松、更快地输入正确的团队名称。

这将如何完成？

另外，如果我这样做，是否会对数据库造成太大压力，并且每次提交都会变得更糟？因为它似乎必须检查整个“home_team”和“away_team”列以及我在其中一个文本框中键入的每个字母。

这适用于 Windows 窗体。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T15:42:08.803

加载表单时，您肯定希望获取所有数据和字段。每次键入字母时都执行请求是个坏主意。

拥有所有字段后，只需将它们放在一个列表中`AutoComplete`，您的文本框就会有属性。

设置`Auto Complete Mode`和`Auto Complete Source`你就完成了！

看看这个例子，很简单！

[C#中的自动完成文本框](http://www.c-sharpcorner.com/UploadFile/mahesh/AutoCompletion02012006113508AM/AutoCompletion.aspx)

# android - 密码保护应用程序按钮

> ID：10143890
> 
> 赞同：1
> 
> 时间：2012-04-13T15:36:00.413
> 
> 标签：android, passwords, password-protection

如何密码保护我的 android 手机主页上的应用程序按钮（samsung galaxy s captivate）。我知道那里有密码保护应用程序，其中包含您需要添加的应用程序列表，但我不希望这样。我想保护应用程序的整个访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:45:27.297

我很确定阻止从主屏幕访问应用程序并不常见，实际上我认为您甚至无法控制它，因为它是 Android 操作系统本身的一部分。毕竟，在主屏幕上阻止用户访问有什么意义，因为用户已经必须解锁手机才能到达那里……通常是通过密码。

一个可行的选择是在登录活动中向您的用户打招呼，并在他们可以访问实际的应用程序功能之前让他们识别自己。

如果您真的想开始在主屏幕上阻止用户，您可能正在考虑创建自己的 ROM 和应用程序。但是，没有人会想要仅仅为了运行您的应用程序而重新构建整个操作系统。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:47:25.470

编写您自己的主屏幕，除非用户进行身份验证，否则它会阻止启动任何应用程序。

# jquery - 侧边栏切换jQuery插件的问题

> ID：10143893
> 
> 赞同：1
> 
> 时间：2012-04-13T15:36:17.613
> 
> 标签：jquery, jquery-plugins, togglebutton

我想向我的页面添加侧边栏切换选项。我在网上搜索并找到了这个 jQuery 插件：

[http://www.adipalaz.com/experiments/jquery/toggle_sidebar.html](http://www.adipalaz.com/experiments/jquery/toggle_sidebar.html) 它没有向侧边栏添加“隐藏”链接。

在使用脚本标记调用 js 文件后，我在代码中输入的内容如下：

```
<script src="{$baseUrl}/js/sidebarToggle.js"></script>
<script type="text/javascript">
  $(function(){
      $("#sidebar").toggleSidebar({animation:"queuedLeft", position:"left", full:true});
  });
</script> 
```

我不知道问题出在哪里。你能帮帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T16:01:39.287

嗯，如果没有 html 源，我真的不能那么有帮助......但无论如何

在浏览器中查看源代码并搜索

```
<a class="trigger" 
```

如果你找到了它，那么你应用插件的容器很可能应该有一个 css 位置属性..

试一试 ，，，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T09:02:22.463

问题是 js 文件中的默认值。我必须更改它们以匹配我的布局 ID。

# javascript - 在提交表单之前验证输入字段

> ID：10143895
> 
> 赞同：3
> 
> 时间：2012-04-13T15:36:21.757
> 
> 标签：javascript, validation

我想验证表单中的输入字段“putime”，因为即使“putime”输入框为空，也会计算结果并将 nightSurcharges 添加到成本中。所以我想在'putime'为空时验证它，否则脚本没用。

```
function TaxiFare() {
// calculates taxi fare based upon miles travelled
// and the hour of the day in military time (0-23).

var baseFare = 14;
var costPerMile = 7.00;
var nightSurcharge = 20.50; // 9pm to 6am, every night //its flat 20.50 and not per mile

var milesTravelled = Number(document.getElementById("miles").value) || 0;
if ((milesTravelled < 1) || (milesTravelled > 200)) {
alert ("You must enter 1 - 200 miles");
document.getElementById("miles").focus();
return false;
}

var pickupTime = Number(document.getElementById("putime").value) || 0;
if ((pickupTime < 0) || (pickupTime > 23) || (pickupTime==null)) {  // note the hours are 0-23\.  There is no 24 hour, midnight is 0 hours
alert ("The time must be 0-23 hours");
document.getElementById("putime").focus();
return false;
}

var cost = baseFare + (costPerMile * milesTravelled);
// add the nightSurcharge to the cost if it is after
// 8pm or before 6am
if (pickupTime >= 21 || pickupTime < 6) {
cost += nightSurcharge;
}
document.getElementById("result").innerHTML = "Your taxi fare is: $. "  + cost.toFixed(2);
}

And here is the Form from HTML

    <form>
Miles for Journey <input type="text" id = "miles" required><br>
Pickup Time <input type = text id = "putime" required><br><br>
<input type="button" value="Calculate Fare" onclick="TaxiFare()">
<input type="reset" value="Clear"><br><br>
<span id = "result"></span>
</form> 
```

我已经尝试了很多但无济于事......欢迎任何帮助。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:41:29.670

如何在表单中添加事件处理程序，例如`document.forms[0].submit = validateFunction;`

其中 validateFunction 可能如下所示：

```
function validateFunction()
{
    var allIns = this.getElementsByTagName('input');
    if(allIns.namedItem('putime').value == '')
    {
        alert('silly');
        return false;
    }
    //and other checks go here, too
} 
```

# ms-access - 如何对 Access 数据库运行一系列查询

> ID：10143898
> 
> 赞同：1
> 
> 时间：2012-04-13T15:36:30.333
> 
> 标签：ms-access, vba

我想在几个类似的数据库上创建并运行一个预定义查询列表。

这个想法是打开数据库，运行查询，然后关闭。现在我手动创建它们中的每一个，运行然后从每个数据库中删除它们。

我不知道如何在 VBA 代码中做到这一点。谁能用一个简单的例子告诉我如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T16:47:52.287

You can use the `Name` property for each item in your database's `QueryDefs` collection to make a list of your saved queries. I think that addresses the title of your question. However the body of your question seems to ask for a lot more as far as I can tell.

You can load a string variable with the text from the `SQL` property of a `QueryDef` in your current database. Then use the `OpenDatabase` method to open another db file, and `Execute` that string there.

```
Public Sub RunQueryOnAnotherDb(ByVal pQuery As String, _
        ByVal pRemoteDb As String)

    Dim dbRemote As DAO.Database
    Dim strSql As String
    strSql = CurrentDb.QueryDefs(pQuery).SQL
    'Debug.Print strSql
    Set dbRemote = OpenDatabase(pRemoteDb)
    dbRemote.Execute strSql, dbFailOnError
    Debug.Print "RecordsAffected: " & dbRemote.RecordsAffected
    dbRemote.Close
    Set dbRemote = Nothing
End Sub 
```

There's plenty of room to refine that one. You should add error handling for example. But, though quick & dirty, I hope it points you in a useful direction.

I tested it on my system like this, and it works with my db and query names.

```
Public Sub test_RunQueryOnAnotherDb()
    Const cstrQuery As String = "qryTestDelete"
    Const cstrRemoteDb As String = "C:\share\Access\0NewScratch.mdb"
    RunQueryOnAnotherDb cstrQuery, cstrRemoteDb
End Sub 
```

# c# - 在运行时使用泛型接口创建泛型类型

> ID：10143899
> 
> 赞同：5
> 
> 时间：2012-04-13T15:36:31.473
> 
> 标签：c#, .net, linq, generics, expression-trees

我已经解决了几个小时的问题，我想我已经接近了。我正在开发一个应用程序，我们可以有 50-100 种以相同方式执行的类型。因此，我没有创建 50-100 个类，而是尝试使其通用，这就是我所拥有的：

这是基类：

```
public class RavenWriterBase<T> : IRavenWriter<T> where T : class, IDataEntity 
```

这是界面：

```
public interface IRavenWriter<T>
{
    int ExecutionIntervalInSeconds { get; }
    void Execute(object stateInfo);
    void Initialize(int executionIntervalInSeconds, Expression<Func<T, DateTime>> timeOrderByFunc);
} 
```

这就是我使用它的方式：

```
private static void StartWriters()
{
    Assembly assembly = typeof(IDataEntity).Assembly;
    List<IDataEntity> dataEntities = ReflectionUtility.GetObjectsForAnInterface<IDataEntity>(assembly);

    foreach (IDataEntity dataEntity in dataEntities)
    {
        Type dataEntityType = dataEntity.GetType();
        Type ravenWriterType = typeof(RavenWriterBase<>).MakeGenericType(dataEntityType);

        Expression<Func<IDataEntity, DateTime>> func = x => x.CicReadTime;

        // This is where I'm stuck. How do I activate this as RavenWriterBase<T>?
        var ravenWriter = Activator.CreateInstance(ravenWriterType);

        //ravenWriter.Initialize(60, func);  // I can't do this until I cast.

        // More functionality here (not part of this issue)
    }
} 
```

我从上面被困在这条线上：

```
var ravenWriter = Activator.CreateInstance(ravenWriterType); 
```

**这是我的问题：**
**如何将它用作 RavenWriterBase 或 IRavenWriter？就像是：**

```
ravenWriter.Initialize(60, func); 
```

我认为它需要是这样的，但我需要为 IRavenWriter<> 指定一个类型，但我还不知道：

```
var ravenWriter = Activator.CreateInstance(ravenWriterType) as IRavenWriter<>; 
```

如果我将鼠标悬停在 ravenWriter 上，我成功地拥有了我的对象：

![在此处输入图像描述](../Images/9fe55f399fec30abf33cd86a5798750b.png)

但现在我需要能够以通用方式使用它。我怎样才能做到这一点？

**更新：**

我只是想使用 dynamic 关键字，这很有效：

```
dynamic ravenWriter = Activator.CreateInstance(ravenWriterType);
ravenWriter.Initialize(60); 
```

我有点作弊，因为我意识到每个 IDataEntity 的 Func 都是相同的，因此没有必要将其作为参数传递给 Initialize()。但是，至少现在我*可以*调用 Initialize()。但是现在 Func 是相同的，我也不应该需要通用接口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:54:20.823

我的解决方案是：

*   创建一个非通用接口`IRavenWriter`
*   使`IRavenWriter<T>`继承自`IRavenWriter`
*   保持`Execute`和`ExecutionIntervalInSeconds`_`IRavenWriter`
*   在你的作家中`IRavenWriter`拥有`Func<DateTime>`并使用它
*   移至`Initialize`_`IRavenWriter<T>`
*   使用工厂根据类型和表达式初始化 Func：

例如：

```
public class MyDateTime
{
    public DateTime This { get; set; }
}

public static Func<DateTime> GetFunk<T>(Expression<Func<T, DateTime>> timeOrderByFunc, T t)
{
    return () => timeOrderByFunc.Compile()(t);
} 
```

你使用：

```
GetFunk<MyDateTime>(x => x.This, new MyDateTime(){This = DateTime.Now}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T09:03:30.190

`Type`将运行时转换为编译时通用类型参数并不难。只需引入用于创建/初始化对象的新接口：

```
 interface IRawenWriterFactory
{
  object Create();
}

class RawenWriterFactory<T> : IRawenWriterFactory
{
  public object Create()
  {
    Expression<Func<IDataEntity, DateTime>> func = x => x.CicReadTime;

    var ravenWriter = new RavenWriterBase<T>();
    ravenWriter.Initialize(60, func);

    return ravenWriter;
  }
} 

```

现在只需`RawenWriterFactory`像您创建的那样使用 dataEntityType 创建`ravenWriter`并通过非通用 IRavenWriterFactory 接口使用它。

但是，如果您要更改设计，可能会有更简单的解决方案。例如，如果您将 Initialize 方法转换为构造函数，您将能够将 func 作为 Activator.CreateInstance 参数传递，并且您根本不需要使用通用接口进行初始化。

# iphone - 调用 addChildViewController 后是否必须调用 addSubview？

> ID：10143903
> 
> 赞同：58
> 
> 时间：2012-04-13T15:36:43.563
> 
> 标签：iphone, ios5, uiviewcontroller, interface-builder

我正在尝试使用`iOS5`新方法创建容器视图控制器，例如`addChildViewController`.

我必须打电话`addSubview`后打电话`addChildViewController`吗？

打电话`removeFromSuperview`之前必须先打电话`removeChildViewController`吗？

我在 Apple 文档中没有看到任何关于此的内容。你怎么看？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2013-04-20T21:19:26.990

**1) 调用 addChildViewController 后是否必须调用 addSubview？**

是的

**2) 在调用removeChildViewController 之前我必须调用removeFromSuperview 吗？**

不完全的

你应该打电话`removeFromParentViewController:`而不是`removeChildViewController:` 你也应该打电话`willMoveToParentViewController:`

对于添加/删除，您可以参考这个伟大的类别：

[UIViewController + 容器](https://github.com/xelvenone/UIViewController--Container-)

```
- (void)containerAddChildViewController:(UIViewController *)childViewController {

    [self addChildViewController:childViewController];
    [self.view addSubview:childViewController.view];
    [childViewController didMoveToParentViewController:self];

}

- (void)containerRemoveChildViewController:(UIViewController *)childViewController {

    [childViewController willMoveToParentViewController:nil];
    [childViewController.view removeFromSuperview];
    [childViewController removeFromParentViewController];

} 
```

[developer.apple.com 上的官方资源](https://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html#//apple_ref/doc/uid/TP40007457-CH18-SW12)

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-04-13T18:09:31.943

Short answer: "Yes, and yes." The view hierarchy and the view *controller* hierarchy are still independent. The containment API simply allows views from other controllers to present themselves within a parent controller's view in a clean and consistent way.

You can find a bit in [Apple's docs here](https://web.archive.org/web/20150907234735/https://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/AboutViewControllers/AboutViewControllers.html#//apple_ref/doc/uid/TP40007457-CH112-SW10)... this is a relevant passage from the "Container View Controllers Arrange Content of Other View Controllers" section:

> A container manages a view hierarchy just as other view controllers do. A container can also add the views of any of its children into its view hierarchy. The container decides when such a view is added and how it should be sized to fit the container’s view hierarchy, but otherwise the child view controller remains responsible for the view and its subviews.

If you have access, I would highly recommend checking out the WWDC 2011 video entitled "Implementing UIViewController Containment" ([download it from Apple Developer Video Archive](https://developer.apple.com/videos/archive/)).

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-15T15:33:49.990

`addChildViewController`添加到彼得的答案：我之前发现调用的一个原因`addSubview`是，当`addSubview`调用时`viewDidLoad`，子调用的调用，在某些情况下，您将希望在那时正确设置父子层次结构。如果不这样做，在孩子的 viewDidLoad 期间 parentViewController 属性将为零。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-12T06:11:02.883

以下是 Apple 文档提供的示例。

```
- (void) displayContentController: (UIViewController*) content {
   [self addChildViewController:content];
   content.view.frame = [self frameForContentController];
   [self.view addSubview:self.currentClientView];
   [content didMoveToParentViewController:self];
} 
```

您还可以查看此处给出的详细说明 - [https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/ImplementingaContainerViewController.html](https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/ImplementingaContainerViewController.html)

这将使您了解子视图控制器和父视图控制器的关系以及如何使用它们。

# javascript - 从特殊字符中清除 json 字符串

> ID：10143904
> 
> 赞同：1
> 
> 时间：2012-04-13T15:36:48.730
> 
> 标签：javascript, regex

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:39:51.703

如果要删除除基本拉丁语以外的所有符号，只需应用正则表达式，例如

```
str = str.replace(/[\u0080-\uFFFF]+/g, ""); 
```

请参阅[此 unicode 字符列表](http://en.wikipedia.org/wiki/List_of_Unicode_characters)以选择您需要接受或不接受的字符

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T16:09:37.387

首先，请确保您绝对不能使用那些“有问题的”符号。干净的现代程序应该正确理解任何语言的输入。

至于您删除任何不可读内容的请求，最好指定您要留下的内容，因为 F. Calderan 的示例不会删除指定 FFFF 位置上方的任何额外 Unicode 符号。所以，考虑到你只想要 ASCII：

```
str = str.replace(/[^\u0000-\u007F]+/g, ""); 
```

# python - Python: two-curve gaussian fitting with non-linear least-squares

> ID：10143905
> 
> 赞同：19
> 
> 时间：2012-04-13T15:36:50.880
> 
> 标签：python, scipy, gaussian, least-squares

My knowledge of maths is limited which is why I am probably stuck. I have a spectra to which I am trying to fit two Gaussian peaks. I can fit to the largest peak, but I cannot fit to the smallest peak. I understand that I need to sum the Gaussian function for the two peaks but I do not know where I have gone wrong. An image of my current output is shown:

![Current Output](../Images/0c3c36dc8438195eef81068a8d2f2094.png)

The blue line is my data and the green line is my current fit. There is a shoulder to the left of the main peak in my data which I am currently trying to fit, using the following code:

```
import matplotlib.pyplot as pt
import numpy as np
from scipy.optimize import leastsq
from pylab import *

time = []
counts = []

for i in open('/some/folder/to/file.txt', 'r'):
    segs = i.split()
    time.append(float(segs[0]))
    counts.append(segs[1])

time_array = arange(len(time), dtype=float)
counts_array = arange(len(counts))
time_array[0:] = time
counts_array[0:] = counts

def model(time_array0, coeffs0):
    a = coeffs0[0] + coeffs0[1] * np.exp( - ((time_array0-coeffs0[2])/coeffs0[3])**2 )
    b = coeffs0[4] + coeffs0[5] * np.exp( - ((time_array0-coeffs0[6])/coeffs0[7])**2 ) 
    c = a+b
    return c

def residuals(coeffs, counts_array, time_array):
    return counts_array - model(time_array, coeffs)

# 0 = baseline, 1 = amplitude, 2 = centre, 3 = width
peak1 = np.array([0,6337,16.2,4.47,0,2300,13.5,2], dtype=float)
#peak2 = np.array([0,2300,13.5,2], dtype=float)

x, flag = leastsq(residuals, peak1, args=(counts_array, time_array))
#z, flag = leastsq(residuals, peak2, args=(counts_array, time_array))

plt.plot(time_array, counts_array)
plt.plot(time_array, model(time_array, x), color = 'g') 
#plt.plot(time_array, model(time_array, z), color = 'r')
plt.show() 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-13T23:36:22.480

如果您只拟合一个由两个高斯分布组合而成的函数，则此代码对我有用。

我刚刚做了一个残差函数，它添加了两个高斯函数，然后从真实数据中减去它们。

我传递给 Numpy 最小二乘函数的参数（p）包括：第一个高斯函数的均值（m），第一和第二个高斯函数的均值之差（dm，即水平位移），标准差第一个 (sd1) 的标准差和第二个 (sd2) 的标准差。

```
import numpy as np
from scipy.optimize import leastsq
import matplotlib.pyplot as plt

######################################
# Setting up test data
def norm(x, mean, sd):
  norm = []
  for i in range(x.size):
    norm += [1.0/(sd*np.sqrt(2*np.pi))*np.exp(-(x[i] - mean)**2/(2*sd**2))]
  return np.array(norm)

mean1, mean2 = 0, -2
std1, std2 = 0.5, 1 

x = np.linspace(-20, 20, 500)
y_real = norm(x, mean1, std1) + norm(x, mean2, std2)

######################################
# Solving
m, dm, sd1, sd2 = [5, 10, 1, 1]
p = [m, dm, sd1, sd2] # Initial guesses for leastsq
y_init = norm(x, m, sd1) + norm(x, m + dm, sd2) # For final comparison plot

def res(p, y, x):
  m, dm, sd1, sd2 = p
  m1 = m
  m2 = m1 + dm
  y_fit = norm(x, m1, sd1) + norm(x, m2, sd2)
  err = y - y_fit
  return err

plsq = leastsq(res, p, args = (y_real, x))

y_est = norm(x, plsq[0][0], plsq[0][2]) + norm(x, plsq[0][0] + plsq[0][1], plsq[0][3])

plt.plot(x, y_real, label='Real Data')
plt.plot(x, y_init, 'r.', label='Starting Guess')
plt.plot(x, y_est, 'g.', label='Fitted')
plt.legend()
plt.show() 
```

![代码的结果。](../Images/7d75767e7f47b9ba6f0f753b10fe9bd6.png)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-10-04T13:48:09.153

您可以使用[scikit-learn](http://scikit-learn.org/stable/modules/mixture.html)中的高斯混合模型：

```
from sklearn import mixture
import matplotlib.pyplot
import matplotlib.mlab
import numpy as np
clf = mixture.GMM(n_components=2, covariance_type='full')
clf.fit(yourdata)
m1, m2 = clf.means_
w1, w2 = clf.weights_
c1, c2 = clf.covars_
histdist = matplotlib.pyplot.hist(yourdata, 100, normed=True)
plotgauss1 = lambda x: plot(x,w1*matplotlib.mlab.normpdf(x,m1,np.sqrt(c1))[0], linewidth=3)
plotgauss2 = lambda x: plot(x,w2*matplotlib.mlab.normpdf(x,m2,np.sqrt(c2))[0], linewidth=3)
plotgauss1(histdist[1])
plotgauss2(histdist[1]) 
```

![在此处输入图像描述](../Images/ee5ce88d53f0196317e276d5c36f4127.png)

您还可以使用下面的函数通过 ncomp 参数拟合所需的高斯数：

```
from sklearn import mixture
%pylab

def fit_mixture(data, ncomp=2, doplot=False):
    clf = mixture.GMM(n_components=ncomp, covariance_type='full')
    clf.fit(data)
    ml = clf.means_
    wl = clf.weights_
    cl = clf.covars_
    ms = [m[0] for m in ml]
    cs = [numpy.sqrt(c[0][0]) for c in cl]
    ws = [w for w in wl]
    if doplot == True:
        histo = hist(data, 200, normed=True)
        for w, m, c in zip(ws, ms, cs):
            plot(histo[1],w*matplotlib.mlab.normpdf(histo[1],m,np.sqrt(c)), linewidth=3)
    return ms, cs, ws 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-14T01:05:34.507

系数 0 和 4 是退化的 - 数据中绝对没有任何东西可以在它们之间做出决定。您应该使用单个零级参数而不是两个（即从您的代码中删除其中一个）。这可能是阻止你适应的原因（忽略这里的评论说这是不可能的 - 该数据中显然至少有两个峰值，你当然应该能够适应那个）。

（可能不清楚我为什么要建议这个，但发生的事情是系数 0 和 4 可以相互抵消。它们都可以是零，或者一个可以是 100，另一个可以是 -100 - 无论哪种方式，适合一样好。这会“混淆”拟合程序，当没有一个正确答案时，它会花时间试图找出它们应该是什么，因为无论一个是什么值，另一个可能只是那个的否定，并且适合将是相同的）。

事实上，从剧情上看，可能根本不需要零级。我会尝试放弃这两个，看看合身的样子。

此外，无需在最小二乘中拟合系数 1 和 5（或零点）。相反，因为模型是线性的，你可以在每个循环中计算它们的值。这将使事情变得更快，但并不重要。我刚刚注意到你说你的数学不太好，所以可能忽略这个。

# c# - 是否可以使用 Umbraco 5 对另一个数据库执行搜索？

> ID：10143911
> 
> 赞同：0
> 
> 时间：2012-04-13T15:37:07.443
> 
> 标签：c#, asp.net-mvc-3, razor, umbraco

我对 Umbraco 太陌生了，甚至都不好笑。我已经在内部构建了一些 MVC3/razor 应用程序，所以我更喜欢使用 Umbraco 5。另外，“Hive”听起来像是我正在寻找的。

所以，请原谅我的无知。我希望最终有一天能在我用 Umbraco 构建我的大部分站点之后，即基本的静态内容页面。我想集成一些用户如何输入搜索条件并单击提交的页面，它返回多个记录或执行搜索的单个详细信息页面。

数据在另一个数据库中，无法集成到 Umbraco。我已经阅读了 Surface 控制器，听起来很有可能将数据从另一个系统返回到模板。但是是否可以像常规 Web 应用程序一样过滤数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:44:12.047

您可以创建自己的*区域*并定义*路线*并将它们指向客户*控制器*，您可以在其中查询数据库并做您想做的事情。

所以如果你想要的话，你可以完全绕过 Umbraco..

**编辑：**

您始终可以添加一个查询字符串，该查询字符串将作为参数传递给控制器​​操作。

假设：`domain.com/allartists`指向：

```
GetAllArtists() 
```

然后你可以打电话：`domain.com/allartists?name=Jackson`这将匹配：

```
GetAllArtists(string name) 
```

# django - 具有多个组件的页面

> ID：10143920
> 
> 赞同：0
> 
> 时间：2012-04-13T15:38:01.567
> 
> 标签：django, django-templates

在设计一个网页时，它会引入由各种应用程序处理的各种信息（例如，想想 Facebook 主页 => 由提要应用程序处理的新闻提要，对那些由评论应用程序处理的提要的评论，一个一方面是朋友列表，另一方面是股票代码），将这些组件组合到一个页面中的最佳方式是什么。

我已经阅读了 James Bennett 关于使用模板标签的帖子（http://www.b-list.org/weblog/2006/jun/07/django-tips-write-better-template-tags/）。这是标准方法还是有其他可行的选择？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:42:20.773

你可以做包含，但模板标签是最干净的机制。

# wcf - 使用 x509 和多个客户端设置 Web 服务以及如何区分客户端？

> ID：10143921
> 
> 赞同：1
> 
> 时间：2012-04-13T15:38:09.443
> 
> 标签：wcf, web-services, wcf-security, x509certificate, x509

通过这[两个](http://www.codeproject.com/Articles/36683/9-simple-steps-to-enable-X-509-certificates-on-WCF) [链接](https://stackoverflow.com/questions/335719/how-can-i-configure-wcf-to-use-x509-certificates-over-the-internet)，我能够实现一个具有 x509 认证的简单 Web 服务，以及一个经过身份验证的测试客户端来使用该服务。

现在，它看起来像这样：

```
 --------------
| ServiceA.svc | ------------> Test Client 1
|  -GetData()  |
 -------------- 
```

我怎样才能扩展我必须完成的事情：

```
 --------------
| ServiceA.svc | ------------> Test Client 1
|  -GetData()  | ------------> Test Client 2
|  -SaveData() |
 --------------
| ServiceB.svc |-------------> Test Client 1
|  -GetData()  |
 --------------
| ServiceC.svc |-------------> Test Client 2
|  -SaveData() |
 -------------- 
```

我已经设置了服务，并且可以使用测试客户端 2。

所以这是我的一些问题：

*   我需要为测试客户端 2 创建单独的证书吗？
*   配置文件/端点/行为会是什么样子？我认为服务 B 和 C 很容易设置，因为它与我现在拥有的基本相同，但是现在两个客户端都将使用 ServiceA，我有点迷茫。
*   如果调用 ServiceA，我怎么知道是哪个客户端调用它？我可能想限制他们可以调用的方法（即 TC1 只能使用 GetData()，TC2 只能使用 SaveData()），并且能够记录谁在访问这些方法。

如果需要，我可以在配置文件上发布我所拥有的内容，但它看起来基本上是上述两个链接所拥有的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:54:05.267

是的，每个客户都需要一个单独的证书。然后从操作中你可以得到它的显着身份：

```
ServiceSecurityContext.Current.PrimaryIdentity.Name 
```

最佳做法是将授权过程分开，如下所述：http: [//msdn.microsoft.com/en-us/magazine/cc948343.aspx](http://msdn.microsoft.com/en-us/magazine/cc948343.aspx)

# excel - 在网站上嵌入 excel 工作簿

> ID：10143936
> 
> 赞同：0
> 
> 时间：2012-04-13T15:38:55.840
> 
> 标签：excel, embed, interactive

我有一个工资单 Excel 工作簿，我想将它嵌入我们公司的 Intranet，以便员工可以打开该页面，填写电子表格中的相应单元格并打印出来。该工作簿有无数页，并且充满了宏，因此简单地在 HTML 中重新创建表格是行不通的。我曾尝试使用 Skydrive 来执行此操作，但不幸的是，该工作簿是 excel 93-2007 格式，不支持嵌入。这样做的另一种方法是什么？理想情况下，我希望将它放在自己的页面上，可以在 iframe 中查看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T16:01:39.267

很简单，将excel保存在另一个版本-2007或2010中就可以了。

# java - 当 JMX 引发通知时引发 java.io.NotSerializableException

> ID：10143939
> 
> 赞同：0
> 
> 时间：2012-04-13T15:39:02.897
> 
> 标签：java, notifications, jmx, jconsole, java-6

您好，最近我开始研究 JMX bean 实现。

然后我发布下面的 bean，运行 JConsole，连接到 bean，注册通知。但是，当发送通知时，我收到以下错误：

***2012 年 4 月 13 日下午 5:31:26 ClientNotifForwarder NotifFetcher.fetchOneNotif 警告：无法反序列化通知：java.io.NotSerializableException：com。*** .jmx.TaskMergeMBean***

任何帮助都将受到欢迎，我花了一天的大部分时间试图解决这个问题。

谢谢，乔纳森

```
public class TaskMBean extends NotificationBroadcasterSupport implements DynamicMBean {

  private final TaskStateChangedEventListener taskChangedListener;

  public TaskMBean (DriverIf driver) {
    taskChangedListener= new TaskStateChangedEventListener (this);
    driver.registerMergeTaskStateChangedListener(mergeTaskChangedListener);
  }
  @Override
  public MBeanNotificationInfo[] getNotificationInfo() {
    String[] types = new String[] { AttributeChangeNotification.ATTRIBUTE_CHANGE };
    String name = AttributeChangeNotification.class.getName();
    String description = "An attribute of this MBean has changed";
    MBeanNotificationInfo info = new MBeanNotificationInfo(types, name,description);
    return new MBeanNotificationInfo[] { info };
  }

  @Override
  public Object getAttribute(String attribute) throws AttributeNotFoundException,          MBeanException,
      ReflectionException {
    // TODO Auto-generated method stub
    return null;
  }

  @Override
  public void setAttribute(Attribute attribute) throws AttributeNotFoundException,
      InvalidAttributeValueException, MBeanException, ReflectionException {
    // TODO Auto-generated method stub

  }

  @Override
  public AttributeList getAttributes(String[] attributes) {
    // TODO Auto-generated method stub
    return null;
  }

  @Override
  public AttributeList setAttributes(AttributeList attributes) {
    // TODO Auto-generated method stub
    return null;
  }

  @Override
  public Object invoke(String actionName, Object[] params, String[] signature)
      throws MBeanException, ReflectionException {
    // TODO Auto-generated method stub
    return null;
  }

  @Override
  public MBeanInfo getMBeanInfo() {
    MBeanNotificationInfo haltInfo =
        new MBeanNotificationInfo(
            new String[] { "NOTIFICATION_TYPE_MERGE_STATE_CHANGE" },
            Notification.class.getName(), "server halt on fatal error");
    MBeanNotificationInfo[] notifications = new MBeanNotificationInfo[] { haltInfo };
    return new OpenMBeanInfoSupport(XhiveMergeMBean.class.getName(), "", null, null, null,
        notifications);
  }
}

public class TaskStateChangedEventListener implements Serializable {

  static final String NOTIFICATION_TYPE_MERGE_STATE_CHANGE = "com.xhive.lucene.merge";
  private final NotificationBroadcasterSupport broadcaster;
  private int notificationSequence = 1;

  public TaskStateChangedEventListener (NotificationBroadcasterSupport broadcaster) {
    this.broadcaster = broadcaster;
  }

  @Override
  public void notify(Object source) {
    Notification n =
        new AttributeChangeNotification(this, notificationSequence++,    System.currentTimeMillis(), "", "", "int", 1, 2);
    broadcaster.sendNotification(n);
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T20:54:17.687

彼得所说的。但是也.....

通知通常（但并非总是）必须被序列化，因此使用它**作为**通知源往往会削弱**.** （双关语）

因此，您需要完全确保**this**的实例是可序列化的（最好是这样），或者更好的是，发送一个更简单的**this**表示形式，例如 MBean 的 ObjectName。目的是让接收者（或过滤器）能够确定通知的来源，所以我发现一致使用信息性 ObjectNames 确实有帮助。

最后，JConsole 在业务类上往往有点薄（我的意思是默认情况下），所以如果你非常依赖 JConsole 并且希望能够干净地查看所有通知，你需要确保你只使用有效负载中的核心 JDK 类型。

（或使用 OpenTypes（同样的事情）或启用远程类加载（不值得麻烦））。

//尼古拉斯

# c# - 带定时器的静态 FIFO 队列 c#

> ID：10143942
> 
> 赞同：1
> 
> 时间：2012-04-13T15:39:19.993
> 
> 标签：c#, multithreading

我有一个 .NET 4.0 ASP.NET 项目，它需要一些我以前从未真正搞砸过的线程工作，我已经看了好几天了，但我仍然一无所知 =/

基本上，我想要一些东西，比如你在熟食店买票，然后等轮到你，然后他们再回来找你。我会试着把它联系起来，看看它是否有意义......

函数开始--->到达需要“取票”的部分（我假设在阻塞集合中排队某种类型的项目）并等待其他“票”（也就是同一函数的其他实例）在它之前完成使函数可以恢复（阻止集合到达队列中的项目）--->完成函数。

我不需要/不想在队列中做任何工作，我只想让函数在函数的其他实例中静态等待它轮到它。那有意义吗？那可能吗？

如果可能，请提供代码，因为我已经看到了大量的示例，但没有一个是有意义的/不要做我想做的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:44:57.530

如果您想拥有计时器解决方案，我会将所有操作排入 BlockingCollection 并有一个专用线程将它们出列。该线程将等待 5 秒，然后将出队的项目推入线程池。这个专用线程应该在无限循环中执行此操作。出队，等待，推送。

然而，我实际上推荐的是，您使用 SemaphoreSlim 类来限制对这个脆弱的 Web 服务的并发请求数。可能您应该选择一个介于 1 到 5 之间的数字作为允许的并发量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T04:39:58.513

好吧，在研究了一个又一个文档并进行了多次代码重写之后，我终于发现我没有正确使用 AutoResetEvent 以及如何在专用线程上使用阻塞集合。所以这是使用带有 BlockingCollection 的 AutoResetEvent 的最终解决方案。下面的这个解决方案可能不会在 100% 的情况下显示相同的结果（只是因为我认为它与将某些东西输入阻塞集合时的线程时间有关）但最终结果是它完全符合我的要求。

```
class Program
{
    static void Main(string[] args)
    {
        TaskProcessor tp = new TaskProcessor();

        Thread t1 = new Thread(new ParameterizedThreadStart(tp.SubmitRequest));
        t1.Start(1);

        Thread t2 = new Thread(new ParameterizedThreadStart(tp.SubmitRequest));
        t2.Start(2);

        Thread t3 = new Thread(new ParameterizedThreadStart(tp.SubmitRequest));
        t3.Start(3);         
    }
}

class TaskProcessor
{
    private AutoResetEvent _Ticket;

    public TaskProcessor()
    {
        _Continue = new AutoResetEvent(false);
    }

    public void SubmitRequest(object i)
    {
        TicketingQueue dt = new TicketingQueue();

        Console.WriteLine("Grab ticket for customer {0}", (int)i);

        dt.GrabTicket(_Ticket);

        _Continue.WaitOne();

        Console.WriteLine("Customer {0}'s turn", (int)i);
    }
}

public class TicketingQueue
{
    private static BlockingCollection<AutoResetEvent> tickets = new BlockingCollection<AutoResetEvent>();

    static TicketingQueue()
    {
        var thread = new Thread(
          () =>
          {
              while (true)
              {                      
                  AutoResetEvent e = tickets.Take();
                  e.Set();
                  Thread.Sleep(1000);
              }
          });
        thread.Start();
    }

    public void GrabTicket(AutoResetEvent e)
    {
        tickets.Add(e);
    }
} 
```

# vb.net - 需要 AutoSuggest For VB.NET ComboBox 的建议

> ID：10143944
> 
> 赞同：1
> 
> 时间：2012-04-13T15:39:29.547
> 
> 标签：vb.net, combobox, autosuggest

为了提供一些上下文，我有一个组合框，用户与之交互以选择一家保险公司。不幸的是，它们不仅仅需要名称。有时保险公司名称相同，区分它们的唯一方法是使用它们的地址（例如，北卡罗来纳州的医疗保险办公室与南卡罗来纳州的医疗保险办公室）。我目前所做的是使用组合框的 DrawItem 事件在显示下拉列表时在 ComboBox 旁边绘制一个工具提示。列表本身显示保险公司名称，但工具提示将显示当前选定公司的地址。组合框设置为 DropDownList，因此除了列表中的内容外，他们无法选择任何内容。

好吧，现在我被告知要改变这一点。用户不再满足于必须单击组合框或按箭头键。他们需要可以输入的组合框，并在输入时显示自动建议列表。这一切都很好，但这是我遇到的问题。我使用工具提示的可爱小方案在这种情况下无法工作，因为自动建议列表是一个完全独立的控件。DrawItem 没有触及它，我找不到自定义绘制自动建议列表的方法。另一个问题是 autosuggest 不会重复输入，所以即使我有两家不同的保险公司，也只有一家会出现在列表中，因为它们的名称相同。

到目前为止，我唯一的另一个想法是在用户按下一个键时以某种方式将下拉列表滚动到适当的项目。但是我不知道如何在不设置 selectedindex 的情况下在下拉列表中设置突出显示的项目。如果我使用 selectedindex，它会继续并替换文本。

有人对如何进行有任何建议吗？我是在正确的轨道上，还是我太努力了，需要完全做其他事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:46:40.743

您可以在用户输入文本的地方使用文本字段，并据此缩小下拉框中的选择范围。为了解决同名但不同公司的问题，您可以在括号中的名称后面列出公司的地址。如果用户输入的名称无效，请在文本字段旁边放置一个错误/警告图标。

要在运行时更新选择，您可以将事件侦听器添加到文本字段并查询当前文本以确定它是否是有效前缀。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T17:21:25.627

我们在我所在的公司做类似的事情。为此，我们通过 AJAX 使用 Web 服务。

本质上，您使用 AJAX AutoCompleteExtender (ACE) 修改标准文本框。这个 ace 引用了一个 Web 服务（我将对此进行说明），该服务会即时获取客户输入的信息。一旦启动并运行，它就非常酷。

这是一个例子：

.ascx

```
<asp:TextBox ID="txtInsuranceCompany" runat="server" TabIndex="520" 
      AutoComplete="Off"AutoCompleteType="Disabled" CssClass="asbSearch" Width="350px"></asp:TextBox>
<ajax:AutoCompleteExtender ID="aceInsuranceCompany" runat="server" CompletionSetCount="20"
       MinimumPrefixLength="0" OnClientShown="resetPosition" ServiceMethod="LookupData"
       ServicePath="~/WebLookUpService.asmx" TargetControlID="txtInsuranceCompany" UseContextKey="true">
</ajax:AutoCompleteExtender> 
```

微妙的是，您必须确保为您的自动完成扩展器设置上下文键，并在您的 Web 服务中创建一些功能来加载您的值（我将再次说明）。

.vb 代码隐藏

```
 Dim yourhardcodedlist As New List(Of String)
 yourhardcodedlist.Add("Progressive")
 yourhardcodedlist.Add("State Farm")
 yourhardcodedlist.Add("USAA")
 WebLookUpService.AddLookupValues(txtInsuranceCompany.ID, yourhardcodedlist.ToArray)
 aceInsuranceCompany.ContextKey = public_var0 & ":" & public_var1 & ":" & txtInsuranceCompany.ID 
```

请注意，“public_var0”“和 public_var1”不是强制性的。这只是说明如何将更多信息传递给您的 Web 服务，而无需实际将其作为参数传递（即一个冒号分隔的列表，您的 Web 服务函数可以解析出来以用于 SQL 语句或其他内容）。

现在对于网络服务...（.asmx）

```
<WebService(Namespace:="http://tempuri.org/")> _
<WebServiceBinding(ConformsTo:=WsiProfiles.BasicProfile1_1)> _
<System.Web.Script.Services.ScriptService()> _
<Global.Microsoft.VisualBasic.CompilerServices.DesignerGenerated()> _
Public Class WebLookUpService
    Inherits System.Web.Services.WebService

    <System.Web.Services.WebMethod(), System.Web.Script.Services.ScriptMethod()> _
    Public Function LookupData(ByVal prefixText As String, ByVal count As Integer,  ByVal contextKey As String) As String()
    'Construct SQL statement to pull from database
    'parsing the context key as necessary to construct your SQL statement (if necessary)
    'Dim somethingForSql As String = contextKey.Split(":")
    Dim suggestions As List(Of String) = New List(Of String)

    Try

        Using cnADO As SqlConnection = New SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings("PublicSafetyServer").ToString)
            cnADO.Open()

            Dim dt As DataTable = New DataTable
            Dim da As New SqlDataAdapter
            da.SelectCommand = New SqlCommand("<YourSQLStatement>")         

            da.Fill(dt)

            Dim endRow As Integer = dt.Rows.Count
            If endRow > count Then
                endRow = count
            End If

            For i As Integer = 0 To endRow - 1
                Dim des As String = dt.Rows(i).Item(field)
                Dim val As String = dt.Rows(i).Item(field)
                suggestions.Add(AjaxControlToolkit.AutoCompleteExtender.CreateAutoCompleteItem(des, val))
            Next
        End Using

    Catch ex As Exception
        'Throw Error
    End Try

    suggestions.Sort()
    If suggestions.Count = 0 Then
        suggestions.Add(AjaxControlToolkit.AutoCompleteExtender.CreateAutoCompleteItem(noneFound, ""))
    End If
    Return suggestions.ToArray()
End Function 
```

很酷的是，您可以通过“您的硬编码列表”故意添加值，该列表将与您通过 Web 服务提取的任何值相结合。这样，如果您无法向数据库添加值，您可以直接添加值。

# css - css - 填充传播到下一列

> ID：10143946
> 
> 赞同：1
> 
> 时间：2012-04-13T15:39:33.280
> 
> 标签：css

我有这个基本的 HTML 结构：

```
<div id="left-column"></div>
<div id="content"></div>
<div id="right-column"></div> 
```

这个CSS：

```
#left-column
{
    padding-top: 25px;
    width: 80px;
    background: url('../../common/images/black70.png');
    height: 100%;
    float: left;
    margin-right: 5px;
}

#content
{
    padding: 5px;
}

#right-column
{
    padding-top: 25px;
    width: 190px;
    background: url('../../common/images/black40.png');
    height: 100%;
    float: right;
} 
```

问题是内容填充正在传播到右列：

![在此处输入图像描述](../Images/d53e239eb281814f3ef18b721a9e1226.png)

我怎样才能避免这种情况？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:44:33.107

问题是您在文档流中的`#right-column`之后`#content`，它将在内容之后开始，该内容`10px`的顶部和底部填充具有高度。

如果您像这样重新排序 HTML，它可以解决您的问题。

```
<div id="left-column"></div>
<div id="right-column"></div>
<div id="content"></div> 
```

这是一个[jsfiddle](http://jsfiddle.net/9YzXV/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:46:34.600

如果你有浮动的东西和非浮动的东西，浮动的东西应该总是在源中的非浮动的东西之前。

在您的情况下，首先呈现内容，然后是其下方的右栏。

# html - 从 Word 复制到 textarea 保留格式

> ID：10143948
> 
> 赞同：3
> 
> 时间：2012-04-13T15:39:39.127
> 
> 标签：html, ms-word

我有用户需要从 word（或 excel）复制并粘贴到 textarea 以显示在具有背景的内部网页上（因此我不能使用数据图片，因为背景不会显示）。他们复制的文本有颜色和标准字体。

有没有一种简单的方法让用户从 word/excel 复制到 textarea 并保持格式？

下面是他们从 word 复制并微调颜色和间距后使用的文本示例：

```
<table align="center" border="0">
    <tbody>
        <tr>
            <td>
                <table border="0" cellpadding="0" cellspacing="0" class="MsoNormalTable" style="margin: auto auto auto 4.65pt; width: 422pt; border-collapse: collapse; mso-yfti-tbllook: 1184; mso-padding-alt: 0in 5.4pt 0in 5.4pt;" width="563">
                    <tbody>
                        <tr style="height: 33.75pt; mso-yfti-irow: 0; mso-yfti-firstrow: yes;">
                            <td colspan="2" nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 422pt; height: 33.75pt; background-color: transparent;" width="563">
                                <p align="center" class="MsoNormal" style="margin: 0in 0in 0pt; text-align: center; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri">Day</font></span></b></font></p>
                            </td>
                        </tr>
                        <tr style="height: 33.75pt; mso-yfti-irow: 1;">
                            <td colspan="2" nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 422pt; height: 33.75pt; background-color: transparent;" width="563">
                                <p align="center" class="MsoNormal" style="margin: 0in 0in 0pt; text-align: center; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri">Date<o:p></o:p></font></span></b></font></p>
                            </td>
                        </tr>
                        <tr style="height: 33.75pt; mso-yfti-irow: 2;">
                            <td colspan="2" nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 422pt; height: 33.75pt; background-color: transparent;" width="563">
                                <p align="center" class="MsoNormal" style="margin: 0in 0in 0pt; text-align: center; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri">OSP #</font></span></b></font></p>
                            </td>
                        </tr>
                        <tr style="height: 33.75pt; mso-yfti-irow: 3;">
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 126.95pt; height: 33.75pt; background-color: transparent;" width="169">
                                <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri">TIME1<o:p></o:p></font></span></b></font></p>
                            </td>
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 295.05pt; height: 33.75pt;" width="393">
                                <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri"><span style="mso-spacerun: yes;">&nbsp;</span>- Activity 1<o:p></o:p></font></span></b></font></p>
                            </td>
                        </tr>

                        <tr style="height: 33.75pt; mso-yfti-irow: 4;">
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 126.95pt; height: 33.75pt; background-color: transparent;" width="169">
                                <font size="160">&nbsp;</font></td>
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 295.05pt; height: 33.75pt;" width="393">
                                <p class="MsoNormal" style="margin: 0in 0in -10pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri"><span style="mso-spacerun: yes;">&nbsp;</span>- Activity 1B<o:p></o:p></font></span></b></font></p>
                            </td>
                        </tr>

                        <tr style="height: 33.75pt; mso-yfti-irow: 6;">
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 126.95pt; height: 33.75pt; background-color: transparent;" width="169">
                                <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri">Time2<o:p></o:p></font></span></b></font></p>
                            </td>

                            <td nowrap="nowrap" style="background: rgb(146, 205, 220); border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 295.05pt; height: 33.75pt;" width="393">
                                <p class="MsoNormal" style="margin: 0in 0in 7pt;margin-top:7pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri"><span style="mso-spacerun: yes;">&nbsp;</span>- Actvity 2<o:p></o:p></font></span></b></font></p>
                            </td>
                        </tr>
                        <tr style="height: 33.75pt; mso-yfti-irow: 6;">
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 126.95pt; height: 33.75pt; background-color: transparent;" width="169">
                                <font size="160">&nbsp;</font></td>
                            <td nowrap="nowrap" style="background: rgb(250, 191, 143); border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 295.05pt; height: 33.75pt;" width="393">
                                <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri"><span style="mso-spacerun: yes;">&nbsp;</span>- Activity 2B<o:p></o:p></font></span></b></font></p>
                            </td>   
                        </tr>
                        <tr style="height: 33.75pt; mso-yfti-irow: 7;">
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 126.95pt; height: 33.75pt; background-color: transparent;" width="169">
                                <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri">Time3<o:p></o:p></font></span></b></font></p>
                            </td>
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 295.05pt; height: 33.75pt; background-color: transparent;" width="393">
                                <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri"><span style="mso-spacerun: yes;">&nbsp;</span>- Activity3<o:p></o:p></font></span></b></font></p>
                            </td>
                        </tr>
                        <tr style="height: 33.75pt; mso-yfti-irow: 8;">
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 126.95pt; height: 33.75pt; background-color: transparent;" width="169">
                                <font size="160">&nbsp;</font></td>
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 295.05pt; height: 33.75pt; background-color: transparent;" width="393">
                                <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri"><span style="mso-spacerun: yes;">&nbsp;</span>- Activity 3B<o:p></o:p></font></span></b></font></p>
                            </td>
                        </tr>
                        <tr style="height: 33.75pt; mso-yfti-irow: 10;">
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 126.95pt; height: 33.75pt; background-color: transparent;" width="169">
                                <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri">Time4<o:p></o:p></font></span></b></font></p>
                            </td>
                            <td nowrap="nowrap" style="background: rgb(250, 191, 143); border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 295.05pt; height: 33.75pt;" width="393">
                                <p class="MsoNormal" style="margin: 0in 0in 7pt;margin-top:7pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri"><span style="mso-spacerun: yes;">&nbsp;</span>- Activity 4<o:p></o:p></font></span></b></font></p>
                            </td>
                        </tr>
                        <tr style="height: 33.75pt; mso-yfti-irow: 10;">
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 126.95pt; height: 33.75pt; background-color: transparent;" width="169">
                                <font size="160">&nbsp;</font></td>
                            <td nowrap="nowrap" style="background: rgb(146, 205, 220); border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 295.05pt; height: 33.75pt;" width="393">
                                <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri"><span style="mso-spacerun: yes;">&nbsp;</span>- Activity 4B<o:p></o:p></font></span></b></font></p>
                            </td>
                        </tr>
                        <tr style="height: 33.75pt; mso-yfti-irow: 11;">
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 126.95pt; height: 33.75pt; background-color: transparent;" width="169">
                                <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri">Time5<o:p></o:p></font></span></b></font></p>
                            </td>
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 295.05pt; height: 33.75pt;" width="393">
                                <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri"><span style="mso-spacerun: yes;">&nbsp;</span>- Activity 5<o:p></o:p></font></span></b></font></p>
                            </td>
                        </tr>
                        <tr style="height: 33.75pt; mso-yfti-irow: 12; mso-yfti-lastrow: yes;">
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 126.95pt; height: 33.75pt; background-color: transparent;" width="169">
                                <font size="160">&nbsp;</font></td>
                            <td nowrap="nowrap" style="border-color: rgb(240, 240, 240); padding: 0in 5.4pt; width: 295.05pt; height: 33.75pt;" width="393">
                                <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;">
                                    <font size="160"><b><span new="" style="font-size: 24pt; mso-ascii-font-family: Calibri;" times=""><font face="Calibri"><span style="mso-spacerun: yes;">&nbsp;</span>- Activity 5B<o:p></o:p></font></span></b></font></p>
                            </td>
                        </tr>
                    </tbody>
                </table>

            </td>
        </tr>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:54:57.217

这是一个非常复杂的过程，更像是编写应用程序，而不是解决简单的复制/粘贴操作。如果您希望它在浏览器中工作，它还将涉及 JavaScript、插件或 Flash。

由于您没有提到任何关于重新发明轮子的事情，我认为最好的答案是使用[支持“从单词粘贴”的](https://www.google.com/search?sourceid=chrome&ie=UTF-8&q=javascript%20rich%20text%20editor%20paste%20from%20word)富文本编辑器，例如[YUI 富文本编辑器](http://developer.yahoo.com/yui/editor/)或[TinyMCE](http://www.tinymce.com/)。

[这是一篇关于在粘贴到 YUI 时清理 word 格式](http://antscode.blogspot.com/2009/05/strip-formatting-on-paste-using-yui.html)的好帖子。

希望这会给你一个很好的介绍这个非常复杂的话题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-30T11:57:54.917

您不能使用 textarea 来做到这一点，而是使用带有`contenteditable`属性的 div。请参阅[https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand](https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand)

# assembly - 为什么DCPU-16指令的二进制表示中有前导1

> ID：10143949
> 
> 赞同：2
> 
> 时间：2012-04-13T15:39:39.840
> 
> 标签：assembly, binary, hex, dcpu-16

我目前正在摆弄 DCPU-16 汇编器（参见[http://0x10c.com/doc/dcpu-16.txt](http://0x10c.com/doc/dcpu-16.txt)和[http://jazzychad.net/dcpu.html](http://jazzychad.net/dcpu.html)）。

在将汇编程序指令转换为十六进制/二进制的方式中，我不明白一件事。

例如，采取类似的指令

```
SET B, 0x0002 
```

应该将寄存器 B 的值设置为十进制 2（或十六进制 0x0002 或二进制 0b000010）

DCPU-16 的指令格式为

```
bbbbbbaaaaaaoooo 
```

因此，低端的操作码占 4 位，第一个值占 6 位，第二个值占 6 位。

手动转换指令时，我会这样做：

```
SET == 0x1    == 0b0001
  B == 0x01   == 0b000001
       0x0002 == 0b000010 
```

以完整的指令结束

```
0b0000100000010001 == 0x811 
```

但 DCPU-16 的正确值是

```
0b1000100000010001 == 0x8811 
```

也就是说，添加了前导 1 - 为什么？

我对汇编程序和任何其他类型的硬核低级机器指令完全陌生，所以如果这是一个非常愚蠢的问题，请多多包涵。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T16:53:43.250

根据规格，

```
值：（6 位）
    0x00-0x07：寄存器（A、B、C、X、Y、Z、I 或 J，按此顺序）
    ...
    0x20-0x3f：字面值 0x00-0x1f（字面量）

```

因此，文字`0x00-0x1f`由指令值指定`0x20-0x3f`——也就是说，设置了最高有效位（6 个中的位）。所以文字`0x02`会有指令值`0x22`。

指令值`0x02`是指 C 寄存器，因此您认为汇编指令应该是 ，`0b0000100000010001 == 0x811`实际上是指令`SET B, C`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T16:11:23.740

您链接到的文本描述没有说明如何将指令组装成可执行代码，但您可以从链接到的模拟器页面上的 Javascript 对其进行逆向工程。似乎有一个名为“pack”的内部函数可以创建二进制指令。pack 函数执行此操作：

```
words[0] += value << (4 + operand * 6); 
```

对于解析的输入，它被迭代调用。我建议向供应商/发明人询问组装文件。

# php - 识别在我的站点中自动刷新的页面

> ID：10143952
> 
> 赞同：0
> 
> 时间：2012-04-13T15:39:53.043
> 
> 标签：php, wordpress

我有一个使用 wordpress 的网站。由于某种原因，我的一些页面不断刷新。我无法连续复制该问题。但是，我随机看到一些页面会自动刷新。当我在几分钟后重试相同的页面时，它工作正常。我的用户也遇到了同样的问题。当他们向我报告 url 的问题时，如果我检查该页面，它工作正常。因此，我确定问题存在，但无法复制问题或解决问题。

这不是浏览器或系统问题。注册和未注册用户都会出现此问题。

所以，我需要你的帮助来解决这个问题。无论如何，是否可以通过在 wordpress 主题 php 文件中添加一些代码（例如编写某种日志等）来确定页面是否保持刷新？这样我就可以尝试解决问题。

具有插件的相同主题在其他托管服务提供商的另一个站点中可以正常工作。我还与我的托管服务提供商核实过。他们回复说他们无法找到任何问题，也无法提供进一步的帮助，因为问题是随机发生的。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:46:40.187

这听起来像您的网站可能已被黑客入侵。检查您不认识的标签的页面来源（`View Source`或`Ctrl + u`） 。`<script>`如果您不确定，请尝试禁用所有插件并使用默认主题。如果问题仍然存在，那么很可能是您的网站被黑客入侵了，您应该从头开始重新安装 WordPress，并重新安装所有插件和主题。如果您使用的是自定义主题，请上传您知道可以使用的版本。此外，*请务必更改仪表板和托管帐户的密码*。

如果禁用插件或使用默认主题使问题消失，那么这是该特定主题/插件的错误。在这种情况下，将错误报告给适当的一方（负责导致问题的特定插件/主题的个人/公司）。

## 如何调试

尝试找到一种可以始终如一地测试问题的方法。例如，如果您可以刷新 20 次，并且每次都会发生两次，那么您就可以使用您的测试了。听起来它不会像这样简单，但这是基本思想......找到定期遇到问题所需的最少次数，并为您禁用的每个插件测试 3 次（以及当您重新打开主题时）。

# objective-c - 在 Objective-C 中继承访问器

> ID：10143953
> 
> 赞同：1
> 
> 时间：2012-04-13T15:39:56.850
> 
> 标签：objective-c, inheritance, readonly, setter, accessor

这是我的第一篇文章; 这个网站是一个非常宝贵的资源。

我对objective-c还很陌生，所以请多多包涵。

所以我有一个基类，其中包含一些我想要“私有”的属性，所以我将它们设为只读。需要明确的是，我不希望它们在外部是可变的，但我确实不想在这个类中使用“set”访问器。所以...

```
// .h file
@interface Vehicle
@property (nonatomic, readonly) int speed;
@end 
```

此外，我在类别接口块中重复了属性声明，以使访问器在此类中可写

```
// .m file
//Private properties and methods
@interface Vehicle()
@property (nonatomic, readwrite) int speed;
@end

@implementation
@synthesize speed = _speed;
- (void) someMethod {
    [self setSpeed:10]; // Works fine
}

@end 
```

但是现在如果我继承这个类，派生类不再有 set 访问器方法（在我的例子中是 setSpeed）。需要重新合成吗？似乎那样会破坏继承的目的。我知道我可以直接修改实例变量（_speed = 10;）但宁愿不这样做。我确定我的理解有问题。谢谢！

```
// Example
@interface Ship : Vehicle
@end

@implementation
- (void) someOtherMethod {
    [self setSpeed: 2]; // DOES NOT WORK, would like it to
}
@end 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-13T15:53:50.227

> 但是现在如果我继承这个类，派生类不再有 set 访问器方法（在我的例子中是 setSpeed）。

实际上，它确实有 set 访问器，只是编译器不知道它。你有一个选择：

*   将类扩展名（该`@interface Vehicle() .... @end`位放在一个单独的头文件中，该文件被导入`.m`for Vehicle 及其子类（或使用类别）
*   在子类的类扩展中重新声明读/写属性。为避免出现警告，`@dynamic speed`请在子类的实现中使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-13T15:47:12.460

由于没有“受保护”方法之类的东西，因此您需要在匿名类别所在的位置创建一个私有共享标头。然后，您的原始实现和派生类都包含此标头以访问此“私有”内容。

# ruby - 尝试将 Blogger 帖子导入 Octopress/Jekyll 时出错

> ID：10143957
> 
> 赞同：0
> 
> 时间：2012-04-13T15:40:31.317
> 
> 标签：ruby, nokogiri, blogger, jekyll

今天早些时候我想将我的主博客切换到 Octopress，因此我克隆了 Octopress，对其进行配置并将其部署在 Heroku 中。

然后我在网上搜索了如何将我的旧博客文章导入 Octopress 并找到这个脚本作为它的答案：

[https://gist.github.com/1578928](https://gist.github.com/1578928)

我有导出的`blog.xml`文件。当我在 gist 中运行脚本时，出现以下错误。我刚开始接触 Ruby，对它了解不多。如果有人能帮我解决这个问题，我会很高兴。该错误似乎是全新的，到目前为止我无法从我的搜索中找到任何答案。

```
 import.rb:33:in `add': dunno ide (RuntimeError)
    from import.rb:158:in `block in <main>'
    from C:/Ruby192/lib/ruby/gems/1.9.1/gems/nokogiri-1.5.2-x86-mingw32/lib/nokogiri/xml/node_set.rb:239:in `block in each'
    from C:/Ruby192/lib/ruby/gems/1.9.1/gems/nokogiri-1.5.2-x86-mingw32/lib/nokogiri/xml/node_set.rb:238:in `upto'
    from C:/Ruby192/lib/ruby/gems/1.9.1/gems/nokogiri-1.5.2-x86-mingw32/lib/nokogiri/xml/node_set.rb:238:in `each'
    from import.rb:157:in `<main>' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T02:20:13.513

查看您链接的 Gist 中的脚本，问题在于它只能解析“post”和“comment”类型，而您似乎还有另一个称为“ide”。

您应该仔细检查输出 XML 是否正常并且没有奇怪命名的标签。

# emacs - 在 Emacs org-mode 中归档时保持上下文

> ID：10143959
> 
> 赞同：19
> 
> 时间：2012-04-13T15:40:35.847
> 
> 标签：emacs, org-mode

我通常使用 org-mode 来跟踪 TODO。我有如下文件：

```
* Misc.
** TODO Task 1
** TODO Task 2
* Project 1
** TODO Task 1
** TODO Task 2 
```

在按预期归档整个子树`Project 1`时，我无法移动`Task 1`到`Misc.`归档文件看起来像这样（在此示例中忽略 PROPERTIES）：

```
* Misc
** DONE Task 1 
```

换句话说，我想保留一个任务所属的所有部分。有没有快速的方法来做到这一点？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-13T16:46:31.467

您可能希望`:ARCHIVE:`在父标题上设置该属性。

它允许您进行标题特定`org-archive-location`设置。（见[说明书](http://orgmode.org/manual/Moving-subtrees.html#Moving-subtrees)）

例如，如果您的存档文件设置为`%s_archive`您希望原始文件看起来像这样

```
* Misc.
  :PROPERTIES:
  :ARCHIVE:  %s_archive::* Misc
  :END:
** TODO Task 1
** TODO Task 2
* Project 1
  :PROPERTIES:
  :ARCHIVE:  %s_archive::* Project 1
  :END:
** TODO Task 1
** TODO Task 2 
```

这会将任何子树发送`* Misc`到存档文件的`* Misc`标题中，并对其中的子树执行等效操作`Project 1`（除非您一次性存档整个树）。在子树之后归档父树似乎会将其添加为目标下的附加子标题。它不支持多个级别，因此如果您需要这种复杂的设置，您必须提前设置存档文件的标题，以确保它以您想要的方式输出。

您还可以使用此属性将特定树存档到单独的文件中（用于导出/发布/共享目的）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-02-18T08:03:16.857

```
;; org-archive-subtree-hierarchical.el
;; modified from https://lists.gnu.org/archive/html/emacs-orgmode/2014-08/msg00109.html

;; In orgmode
;; * A
;; ** AA
;; *** AAA
;; ** AB
;; *** ABA
;; Archiving AA will remove the subtree from the original file and create
;; it like that in archive target:

;; * AA
;; ** AAA

;; And this give you
;; * A
;; ** AA
;; *** AAA

(require 'org-archive)

(defun org-archive-subtree-hierarchical--line-content-as-string ()
  "Returns the content of the current line as a string"
  (save-excursion
    (beginning-of-line)
    (buffer-substring-no-properties
     (line-beginning-position) (line-end-position))))

(defun org-archive-subtree-hierarchical--org-child-list ()
  "This function returns all children of a heading as a list. "
  (interactive)
  (save-excursion
    ;; this only works with org-version > 8.0, since in previous
    ;; org-mode versions the function (org-outline-level) returns
    ;; gargabe when the point is not on a heading.
    (if (= (org-outline-level) 0)
        (outline-next-visible-heading 1)
      (org-goto-first-child))
    (let ((child-list (list (org-archive-subtree-hierarchical--line-content-as-string))))
      (while (org-goto-sibling)
        (setq child-list (cons (org-archive-subtree-hierarchical--line-content-as-string) child-list)))
      child-list)))

(defun org-archive-subtree-hierarchical--org-struct-subtree ()
  "This function returns the tree structure in which a subtree
belongs as a list."
  (interactive)
  (let ((archive-tree nil))
    (save-excursion
      (while (org-up-heading-safe)
        (let ((heading
               (buffer-substring-no-properties
                (line-beginning-position) (line-end-position))))
          (if (eq archive-tree nil)
              (setq archive-tree (list heading))
            (setq archive-tree (cons heading archive-tree))))))
    archive-tree))

(defun org-archive-subtree-hierarchical ()
  "This function archives a subtree hierarchical"
  (interactive)
  (let ((org-tree (org-archive-subtree-hierarchical--org-struct-subtree))
        (this-buffer (current-buffer))
        (file (abbreviate-file-name
               (or (buffer-file-name (buffer-base-buffer))
                   (error "No file associated to buffer")))))
    (save-excursion
      (setq location (org-get-local-archive-location)
            afile (org-extract-archive-file location)
            heading (org-extract-archive-heading location)
            infile-p (equal file (abbreviate-file-name (or afile ""))))
      (unless afile
        (error "Invalid `org-archive-location'"))
      (if (> (length afile) 0)
          (setq newfile-p (not (file-exists-p afile))
                visiting (find-buffer-visiting afile)
                buffer (or visiting (find-file-noselect afile)))
        (setq buffer (current-buffer)))
      (unless buffer
        (error "Cannot access file \"%s\"" afile))
      (org-cut-subtree)
      (set-buffer buffer)
      (org-mode)
      (goto-char (point-min))
      (while (not (equal org-tree nil))
        (let ((child-list (org-archive-subtree-hierarchical--org-child-list)))
          (if (member (car org-tree) child-list)
              (progn
                (search-forward (car org-tree) nil t)
                (setq org-tree (cdr org-tree)))
            (progn
              (goto-char (point-max))
              (newline)
              (org-insert-struct org-tree)
              (setq org-tree nil)))))
      (newline)
      (org-yank)
      (when (not (eq this-buffer buffer))
        (save-buffer))
      (message "Subtree archived %s"
               (concat "in file: " (abbreviate-file-name afile))))))

(defun org-insert-struct (struct)
  "TODO"
  (interactive)
  (when struct
    (insert (car struct))
    (newline)
    (org-insert-struct (cdr struct))))

(defun org-archive-subtree ()
  (org-archive-subtree-hierarchical)
  ) 
```

这个 hack 就像用相同的父结构重新归档到你的存档文件，`:PROPERTIES:`这里没有存档。

也作为这里的要点：[https ://gist.github.com/CodeFalling/87b116291aa87fde72cb](https://gist.github.com/CodeFalling/87b116291aa87fde72cb)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-13T16:07:50.173

我认为不`org-mode`支持直接镜像存档文件中的当前上下文。

有一个相关变量，`org-archive-location`可用于指定单个标题来放置归档项目，但不支持树内的多个级别。在[此页面上](http://orgmode.org/worg/org-hacks.html)，有两个建议`org-archive-subtree`可能就足够了。我在这里复制第一个，以防网站消失：

```
(defadvice org-archive-subtree (around my-org-archive-subtree activate)
  (let ((org-archive-location
         (if (save-excursion (org-back-to-heading)
                             (> (org-outline-level) 1))
             (concat (car (split-string org-archive-location "::"))
                     "::* "
                     (car (org-get-outline-path)))
           org-archive-location)))
    ad-do-it)) 
```

第二个，也是更复杂的一个还保留了在顶级标题中找到的标签。

最后可能派上用场的是自定义变量`org-archive-save-context-info`。如果此列表包含符号`'olpath`，则存档条目将包含`:ARCHIVE_OLPATH:`属性，该属性设置为存档条目的大纲路径（例如`Projects/Misc`。也许您可以对 进行一些后期处理，`org-archive-subtree`并使用此将存档条目重新定位到其原始大纲路径。

# jquery - 取.get json 字符串，变成数组？

> ID：10143960
> 
> 赞同：-1
> 
> 时间：2012-04-13T15:40:38.937
> 
> 标签：jquery, json

我使用以下从 php 中检索字符串，我想知道如何将我的字符串变成一个数组。

**jQuery**

```
$.get("get.php", function(data){
    alert(data);
    //alert($.parseJSON(data));
}, "json"); 
```

注释掉的部分似乎没有效果，所以我真的不能告诉我做错了什么，有人可以请教吗？

如果需要，我可以发布 PHP。

谢谢。

**PHP**

```
<?php

$username="root";
$password="root";
$database="testing";

mysql_connect(localhost,$username,$password);
@mysql_select_db($database) or die( "Unable to select database");

$name= $_GET['name'];

$query="SELECT * FROM tableone ";
$result=mysql_query($query);

$num=mysql_numrows($result);

mysql_close();

$array = array();

$i=0;
while ($i < $num) {

    $first=mysql_result($result,$i,"firstname");
    $last=mysql_result($result,$i,"lastname");
    $date=mysql_result($result,$i,"date");
    $ID=mysql_result($result,$i,"id");

    $array[$i] = $first;

    $i++;
}

echo json_encode($array);

?> 
```

输出：

`["James","Lydia","John"]`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T16:02:59.503

你已经得到了比数组更有用的东西。假设你的 php 这样做：

```
<?php echo json_encode(array('John', 'Mary', 'Joseph')); ?> 
```

在您提醒数据的函数中，您可以访问以下元素：

```
alert(console.log(data[0])); //will alert "John"
alert(console.log(data[1])); //will alert "Mary" 
```

如果你需要遍历任何元素，你可以这样做：

```
$(data).each(function(index) {
    console.log(this.toString());
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:50:14.023

您已经在该回调中获取 JSON。它看起来不像，因为当您“警告”时，它会转换为由逗号分隔的数组元素列表组成的字符串。

你可以通过这样做来看到这一点，`alert(data instanceof Array);`这会吐出“真”。

# mongodb - 未嵌入子对象的 MapReduce

> ID：10143961
> 
> 赞同：0
> 
> 时间：2012-04-13T15:40:40.590
> 
> 标签：mongodb, mapreduce, mongoid

我在创建 mapreduce 算法时遇到问题，该算法将为我提供所需的统计信息。我有一个可以创建帖子的用户对象，并且帖子可以得到其他用户的很多赞。

用户——
发帖
——喜欢

帖子没有嵌入到用户中，因为我们单独访问帖子，而不仅仅是在用户上下文中。我需要的统计数据是作者获得的点赞数，我需要通过用户帖子的点赞数来获得。问题是因为帖子没有嵌入，我无法在我的地图功能中访问它们。这是我目前拥有的 map 和 reduce 函数

```
def reputation_map
 <<-MAP
   function() {      
       var posts = db.posts.find({user_id:this._id});
       emit(this._id, {posts:posts});      
   }
 MAP
end

def reputation_reduce
  <<-REDUCE
    function(key, values) {
      var count = 0;
      while(values.hasNext()){
        values.next();
        count+=1;
      }
      return {posts:count};
     }
 REDUCE
end 
```

这应该只返回每个用户的帖子，所以我什至还没有达到喜欢的级别，但不是计数，这只会返回帖子的 dbquery。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T18:32:05.763

Map Reduce 的设计目的是一次对单个集合进行操作。

从技术上讲，可以像您所做的那样从 Map 函数内部查询单独的集合，但要小心，因为不推荐也不支持这样做。您可能会遇到问题，尤其是当集合被分片时。

不久前有人问了一个类似的问题： [如何在我的 map/reduce 函数中调用 mongodb？这是一个好习惯吗？](https://stackoverflow.com/questions/8472769/how-to-call-to-mongodb-inside-my-map-reduce-functions-is-it-a-good-practice)

如果您正在聚合来自多个集合的结果，您可能会发现最安全和最直接的方法是在应用程序中。

或者，如果每个作者的赞是一个会以某种频率搜索的值，则最好将其作为一个值包含在每个文档中，并在每次更新上花费更多的开销来增加该值，而不是定期执行每个作者的所有投票的潜在资源繁重的计算。

希望这会给您一些思考，以检索您需要的值。

如果您在为单个集合编写 Map Reduce 操作时需要一些帮助，社区随时为您提供帮助。请包括一个示例输入文档，以及所需输出的描述。

有关 Map Reduce 的更多信息，可以在此处找到文档： [http ://www.mongodb.org/display/DOCS/MapReduce](http://www.mongodb.org/display/DOCS/MapReduce)

此外，MongoDB Cookbook 中有一些很好的 Map Reduce 示例：http: [//cookbook.mongodb.org/](http://cookbook.mongodb.org/)

食谱文章“使用版本化文档查找最大值和最小值” [http://cookbook.mongodb.org/patterns/finding_max_and_min/](http://cookbook.mongodb.org/patterns/finding_max_and_min/)的“附加”部分包含一个很好的 Map Reduce 操作的逐步演练，解释了如何功能被执行。

# jquery - CakePHP Paginator with Ajax - 不调用 Ajax 调用

> ID：10143963
> 
> 赞同：2
> 
> 时间：2012-04-13T15:40:45.897
> 
> 标签：jquery, cakephp-2.0

我正在使用 CakePHP 内置的 Paginator 助手，并在尝试将其与 Ajax 集成时遇到了问题。

实际的分页器（就是这个）：

```
echo $this->Paginator->prev('« Previous', null, null, array('class' => 'disabled'));

echo $this->Paginator->next('Next »', null, null, array('class' => 'disabled')); 
```

工作正常。但是，它会导致页面重新加载，这是我真的不想发生的事情。使用文档，它说使用以下代码：

```
$this->Paginator->options(array(
    'update' => '#testtable',   // This is the name of the table to be refreshed
    'evalScripts' => true
)); 
```

但是，当我点击链接时，它仍然只是重新加载页面。它完全忽略了选项集。可以在页面上访问 JQuery，因为在同一页面上调用了其他 Ajax 调用，我正在努力思考还有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T06:59:16.873

我以前遇到过同样的问题。我所做的是创建自己的 jquery 绑定函数。我摆脱了`$this->Paginator->options()`

```
 $('.prev a, .next a').bind('click', function(event){
        event.preventDefault();

        var url_link = $(this).attr('href');
        $.ajax ({ async:true, 
            beforeSend: function (XMLHttpRequest) {$("#busy-indicator").fadeIn();}, 
            complete: function (XMLHttpRequest, textStatus) {$("#busy-indicator").fadeOut();}, 
            dataType: "html", evalScripts:true, 
            success: function (data, textStatus) {   
                $("#testtable").empty().html(data);
            }, 
            url: url_link});
            return false;

        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T10:47:20.263

在您的视图文件或布局文件中添加以下脚本并尝试

```
jQuery(document).ready(function() {  
  jQuery('#example').dataTable( {
    "sPaginationType": "full_numbers",
    "bProcessing": true,
    "bServerSide": true,
    "sAjaxSource": src="<?= $this->base;?>/controller/action/<?=$dataId;?>",    
}); 
```

这可能会将 Ajax 功能添加到分页中。

我会推荐你​​使用 cakephp 插件[Cakephp-DataTable](https://github.com/tigrang/cakephp-datatable)

这个插件已经实现了分页，默认情况下它具有大部分功能。他们还提供了文档，如果您在实施中发现任何困难，请查看[问题部分](https://github.com/tigrang/cakephp-datatable/issues/5#issuecomment-5229179)

此外，开发人员反应迅速，如果您有任何插件，可以得到澄清。

# apache-flex - Flex ANT 任务 fb.exportReleaseBuild

> ID：10143965
> 
> 赞同：1
> 
> 时间：2012-04-13T15:40:49.917
> 
> 标签：apache-flex, flex3, flexbuilder

我正在使用 ANT 一次构建多个 Flex 项目。我的 XML 文件定义了一个目标，它是一系列 fb.exportReleaseBuild 任务。

但是，我使用 shell 脚本（OS X、终端）来驱动它，而不是在 Eclipse 中。我通过在命令行中执行 FlashBuilder 来构建目标，例如

flashbuilder -application org.eclipse.ant.core.antRunner \ -file myXmlFile 目标 FractionMats3

问题是，我必须在 Eclipse 关闭的情况下运行它。这没关系。但是我必须记得在关闭之前先打开所有相关项目，否则flashbuilder不会构建它们。

是否有用于打开项目的 ANT 任务？

# maven - 如何将资源添加到 Maven 插件的类路径中？

> ID：10143968
> 
> 赞同：2
> 
> 时间：2012-04-13T15:41:10.463
> 
> 标签：maven

我有一个依赖 slf4j 进行日志记录的 Maven 插件。默认行为对我来说太健谈了，但我不知道如何将我添加`logback.xml`到插件的类路径中。

```
<plugin>
  <dependencies>
  </dependencies>
</plugin> 
```

允许您将依赖项添加到插件的类路径，但是如何添加本地（资源）目录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:47:10.167

您必须将 logback.xml 包装到适当的 Maven 工件（即 jar）中并将其安装到本地存储库或部署到共享存储库，或者在依赖项声明中使用 systemPath 指向放置在项目内部某处的 jar，强烈不推荐。

这样做的原因是构建的可重用性。想想其他人如何能够复制它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:43:55.127

你没有。您必须将它们打包为工件并将其添加为依赖项。

# openid - 将 LinkedIn 与 openid 集成

> ID：10143970
> 
> 赞同：3
> 
> 时间：2012-04-13T15:41:12.897
> 
> 标签：openid, integration, linkedin

你知道一些将LinkedIn与openid集成的方法吗？我有一个允许用户使用 openid 登录的网页，并且我能够实现 Yahoo、Facebook 和 Gmail。

您可能知道，Facebook 和 LinkedIn 都不受支持，但我能够将 facebook 与 ffacebook 连接方法集成。

你知道任何整合LinkedIn的方法吗？

# jquery - 带有摘要的 jQuery 验证 onBlur

> ID：10143972
> 
> 赞同：0
> 
> 时间：2012-04-13T15:41:29.553
> 
> 标签：jquery, jquery-validate, onblur

尝试使用 jQuery Validate 验证我不知道其内容的表单并在页面顶部显示摘要。我不希望每个字段旁边都有消息。我可以让它在提交时正常工作，如果我禁用 onfocusout/onblur/onkeyup，一切都会很好。目前我一直在尝试通过 showErrors 做到这一点，但我很开放。

我的印象是 jQuery Validate 只带回在触发 onblur 或 keyup 时失败的单个元素。现在发生的情况是我的摘要每次都会被覆盖，并且当它触发 onblur 时，摘要可能会返回为空（大概是因为 errorMap 仅包含一个失败的元素）。我想要更新或重新生成我的摘要，以便在用户浏览表单时保持正确。

我有点想我可能需要保存对我的验证器的引用，然后循环通过验证器.errors() 或 .elements()，但我不确定该方法的去向。下面是我的整个 validateform() 函数，它是从任何被单击的提交按钮调用的。

```
function validateform() {

$("form").validate({

    showErrors: function(errorMap, errorList) {

        var errorCount = this.numberOfInvalids();

        if (errorCount > 0) {
            if (errorCount == 1) {
                $("#errorContainer h3").html("Your form contains " + errorCount + " error, see details below.");
            }
            else { /*two or more errors */
                $("#errorContainer h3").html("Your form contains " + errorCount + " errors, see details below.");
            }
            var summary = '';

            $.each(errorMap, function(key, value) {
                var field = $('input[name="' + key + '"],select[name="' + key + '"],textarea[name="' + key + '"]');
                field.addClass('err');
                var fieldname = field.attr("rel");
                summary += '<p><span class="errorkey">' + fieldname + '</span> - <span class="errorvalue">' + value + "</span></p>";
            });
            $('#errorList').html(summary);
            $('#errorContainer').slideDown();
        }
    },
    onfocusout: false,
    onkeyup: false,
    onclick: false

});
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T04:18:01.580

假设这种形式：

```
<div id="errorContainer"></div>
<form id="myform">
    <div>
        <label for="field1">field1</label>
        <input type="text" id="field1" name="field1" />
    </div>
    <div>
        <label for="field2">field2</label>
        <input type="text" id="field2" name="field2" />
    </div>
</form> 
```

您可以执行以下操作来获取实时错误并将它们放在摘要部分中：

```
$(function () {
    var
        container = $("#errorContainer"),
        validator = $("#myform").validate({
            rules: {
                field1: {
                    minlength: 2,
                    required: true
                },
                field2: {
                    required: true
                }
            },
            messages: {
                field1: {
                    minlength: "Please enter 2 or more characters for field1",
                    required: "Please enter field1"
                },
                field2: {
                    required: "Please enter field 2"
                }
            },
            onfocusout: function (element) {
                this.element(element);
            },
            errorPlacement: function (error, element) {
                var
                existingErSelector = $.validator.format("label[for={0}]:contains({1})", element.attr("id"), error.text());

                if (container.find(existingErSelector).length === 0) {
                    $("#errorContainer ").append(error);
                }
            },
            unhighlight: function (validElement) {
                container.find($.validator.format("label[for={0}]", validElement.id)).remove();
            }
        });
}); 
```

看到这个小提琴：http: [//jsfiddle.net/richwag/AjXqp/5/](http://jsfiddle.net/richwag/AjXqp/5/)

# amazon-ec2 - 如何设置和服务失败的鲸鱼式服务器过载页面？

> ID：10143978
> 
> 赞同：3
> 
> 时间：2012-04-13T15:41:56.237
> 
> 标签：amazon-ec2, amazon-web-services, lamp

我们在 AWS 上使用中型高 CPU 服务器建立了一个相当大的成员站点。大多数情况下，它以非常低的容量（约 3%）运行，但我们每周一次向有机会的会员发送简报。在时事通讯发布后的几分钟内，服务器负载猛增（有时超过 100%），会员试图访问该网站。

从长远来看，我们将重组系统，但现在，我想添加一个溢出服务器，在这种情况发生时为用户提供“几分钟后重试”页面。

我还没有找到任何关于为这种类型的事情设置路由的好方法。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:53:18.057

为什么不将[Elastic Load Balancing](http://aws.amazon.com/elasticloadbalancing/)与[Auto Scaling](http://aws.amazon.com/autoscaling/)一起使用呢？

这将允许您将服务器的数量与您的实际使用情况相匹配。在一周的大部分时间里，您不会为 97% 的未使用容量付费，并且在新闻通讯期间，您将有足够的容量让每个人登录并从您那里购买东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-15T17:20:57.097

Amazon Web Services 博客上有一篇文章解释了如何执行此操作。它将故障转移网页放在 S3 上，易于维护且成本低廉。

[使用 Route 53 DNS 故障转移和 S3 网站托管创建备份网站](http://aws.amazon.com/blogs/aws/create-a-backup-website-using-route-53-dns-failover-and-s3-website-hosting/)

# c# - 在 C# 中实现超时

> ID：10143980
> 
> 赞同：16
> 
> 时间：2012-04-13T15:42:00.690
> 
> 标签：c#, timeout

我是 C# 的新手；我主要做Java。

我想按照以下方式实现超时：

```
int now= Time.now();
while(true)
{
  tryMethod();
  if(now > now+5000) throw new TimeoutException();
} 
```

如何在 C# 中实现这一点？谢谢！

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-04-13T15:44:26.170

一种可能的方法是：

```
Stopwatch sw = new Stopwatch();
sw.Start();

while(true)
{
    tryMethod();
    if(sw.ElapsedMilliseconds > 5000) throw new TimeoutException();
} 
```

但是，您目前无法摆脱循环。我建议`tryMethod`返回 a`bool`并将其更改为：

```
Stopwatch sw = new Stopwatch();
sw.Start();

while(!tryMethod())
{
    if(sw.ElapsedMilliseconds > 5000) throw new TimeoutException();
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-13T15:59:44.710

我认为您可以使用计时器和委托来执行此操作，我的示例代码如下：

```
using System;
using System.Timers;

class Program
{
    public delegate void tm();

    static void Main(string[] args)
    {
        var t = new tm(tryMethod);
        var timer = new Timer();
        timer.Interval = 5000;

        timer.Start();

        timer.Elapsed += (sender, e) => timer_Elapsed(t);
        t.BeginInvoke(null, null);
    }

    static void timer_Elapsed(tm p)
    {
        p.EndInvoke(null);
        throw new TimeoutException();
    }

    static void tryMethod()
    {
        Console.WriteLine("FooBar");
    }
} 
```

你有 tryMethod，然后你创建一个委托并将这个委托指向 tryMethod，然后你异步启动这个委托。然后你有一个计时器，间隔为 5000 毫秒，你将你的委托传递给你的计时器经过的方法（它应该作为一个委托是一个引用类型，而不是一个值类型），一旦 5000 秒过去了，你调用 EndInvoke您的委托上的方法。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-07-20T18:47:14.663

这个问题很老了，但还有另一种选择。

```
using(CancellationTokenSource cts = new CancellationTokenSource(5000))
{
  cts.Token.Register(() => { throw new TimeoutException(); });
  while(!cts.IsCancellationRequested)
  {
    tryMethod();
  }
} 
```

从技术上讲，您还应该传播`CancellationToken`in`tryMethod()`以优雅地中断它。

工作演示：（注意我必须删除异常抛出行为，因为 .netfiddle 不喜欢它。）

[https://dotnetfiddle.net/WjRxyk](https://dotnetfiddle.net/WjRxyk)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-13T16:06:56.490

只要 tryMethod() 不阻止这应该做你想要的：

移动时夏令时或更改时区不安全：

```
DateTime startTime = DateTime.Now;

while(true)
{
    tryMethod();
    if(DateTime.Now.Subtract(startTime).TotalMilliseconds > 5000)
        throw new TimeoutException();
} 
```

时区和夏令时安全版本：

```
DateTime startTime = DateTime.UtcNow;

while(true)
{
    tryMethod();
    if(DateTime.UtcNow.Subtract(startTime).TotalMilliseconds > 5000)
        throw new TimeoutException();
} 
```

（DateTimeOffset 需要 .NET 3.5 或更高版本。）

```
DateTimeOffset startTime = DateTimeOffset.Now;

while(true)
{
    tryMethod();
    if(DateTimeOffset.Now.Subtract(startTime).TotalMilliseconds > 5000)
        throw new TimeoutException();
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-09-11T20:05:03.490

# 在异步方法上使用任务自定义超时

在这里，我实现了一个自定义类，该类具有包装任务以实现超时的方法。

```
public class TaskWithTimeoutWrapper
{
    protected volatile bool taskFinished = false;

    public async Task<T> RunWithCustomTimeoutAsync<T>(int millisecondsToTimeout, Func<Task<T>> taskFunc, CancellationTokenSource cancellationTokenSource = null)
    {
        this.taskFinished = false;

        var results = await Task.WhenAll<T>(new List<Task<T>>
        {
            this.RunTaskFuncWrappedAsync<T>(taskFunc),
            this.DelayToTimeoutAsync<T>(millisecondsToTimeout, cancellationTokenSource)
        });

        return results[0];
    }

    public async Task RunWithCustomTimeoutAsync(int millisecondsToTimeout, Func<Task> taskFunc, CancellationTokenSource cancellationTokenSource = null)
    {
        this.taskFinished = false;

        await Task.WhenAll(new List<Task>
        {
            this.RunTaskFuncWrappedAsync(taskFunc),
            this.DelayToTimeoutAsync(millisecondsToTimeout, cancellationTokenSource)
        });
    }

    protected async Task DelayToTimeoutAsync(int millisecondsToTimeout, CancellationTokenSource cancellationTokenSource)
    {
        await Task.Delay(millisecondsToTimeout);

        this.ActionOnTimeout(cancellationTokenSource);
    }

    protected async Task<T> DelayToTimeoutAsync<T>(int millisecondsToTimeout, CancellationTokenSource cancellationTokenSource)
    {
        await this.DelayToTimeoutAsync(millisecondsToTimeout, cancellationTokenSource);

        return default(T);
    }

    protected virtual void ActionOnTimeout(CancellationTokenSource cancellationTokenSource)
    {
        if (!this.taskFinished)
        {
            cancellationTokenSource?.Cancel();
            throw new NoInternetException();
        }
    }

    protected async Task RunTaskFuncWrappedAsync(Func<Task> taskFunc)
    {
        await taskFunc.Invoke();

        this.taskFinished = true;
    }

    protected async Task<T> RunTaskFuncWrappedAsync<T>(Func<Task<T>> taskFunc)
    {
        var result = await taskFunc.Invoke();

        this.taskFinished = true;

        return result;
    }
} 
```

然后你可以这样称呼它：

```
await new TaskWithTimeoutWrapper().RunWithCustomTimeoutAsync(10000, () => this.MyTask()); 
```

或者

```
var myResult = await new TaskWithTimeoutWrapper().RunWithCustomTimeoutAsync(10000, () => this.MyTaskThatReturnsMyResult()); 
```

如果您想在超时时取消正在运行的异步任务，您可以添加一个取消令牌。

希望能帮助到你

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-05T19:22:33.427

我喜欢做的另一种方式：

```
public class TimeoutAction
    {
        private Thread ActionThread { get; set; }
        private Thread TimeoutThread { get; set; }
        private AutoResetEvent ThreadSynchronizer { get; set; }
        private bool _success;
        private bool _timout;

        /// <summary>
        /// 
        /// </summary>
        /// <param name="waitLimit">in ms</param>
        /// <param name="action">delegate action</param>
        public TimeoutAction(int waitLimit, Action action)
        {
            ThreadSynchronizer = new AutoResetEvent(false);
            ActionThread = new Thread(new ThreadStart(delegate
            {
                action.Invoke();
                if (_timout) return;
                _timout = true;
                _success = true;
                ThreadSynchronizer.Set();
            }));

            TimeoutThread = new Thread(new ThreadStart(delegate
            {
                Thread.Sleep(waitLimit);
                if (_success) return;
                _timout = true;
                _success = false;
                ThreadSynchronizer.Set();
            }));
        }

        /// <summary>
        /// If the action takes longer than the wait limit, this will throw a TimeoutException
        /// </summary>
        public void Start()
        {
            ActionThread.Start();
            TimeoutThread.Start();

            ThreadSynchronizer.WaitOne();

            if (!_success)
            {
                throw new TimeoutException();
            }
            ThreadSynchronizer.Close();
        }
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-14T01:44:16.620

```
CancellationTokenSource cts = new CancellationTokenSource();
cts.CancelAfter(10000);
try
{
    Task task = Task.Run(() => { methodToTimeoutAfter10Seconds(); }, cts.Token);
    TaskCompletionSource<bool> tcs = new TaskCompletionSource<bool>();
    using (cts.Token.Register(s => ((TaskCompletionSource<bool>)s).TrySetResult(true), tcs))
    {
        if (task != await Task.WhenAny(task, tcs.Task))
        {
            throw new OperationCanceledException(cts.Token);
        }
    }
    /* Wait until the task is finish or timeout. */
    task.Wait();

    /* Rest of the code goes here */

}
catch (TaskCanceledException)
{
    Console.WriteLine("Timeout");
}
catch (OperationCanceledException)
{
    Console.WriteLine("Timeout");
}
catch (Exception ex)
{
    Console.WriteLine("Other exceptions");
}
finally
{
    cts.Dispose();
} 
```

# jquery - 在没有 jQuery 的情况下复制 jQuery 的 $('body').outerHeight(true)

> ID：10143983
> 
> 赞同：4
> 
> 时间：2012-04-13T15:42:08.860
> 
> 标签：jquery

我有一些页面加载到父页面中的 iframe 中，我正在使用 postMessage 将子页面的高度发送给父页面，以便它可以调整 iframe 的大小。子页面非常简单，为了找到正文的高度而拥有额外的 jQuery 大小似乎是一种耻辱。但是，到目前为止，我还没有能够在直接的 JavaScript 中复制上述调用的效果。

我尝试了应用于 body 和 body.documentElement 的 scrollHeight、offsetHeight 和 clientHeight 的不同组合，但都不匹配。而且它们在不同的浏览器中非常不同，尤其是当您在大小差异很大的子文档之间切换时。以下是所有子页面的 onload 事件处理程序的实际代码：

```
window.onload = function() {
    alert("height(1) = " + document.body.scrollHeight + "\n" +
        "height(2) = " + document.documentElement.scrollHeight + "\n" +
        "height(3) = " + document.body.offsetHeight + "\n" +
        "height(4) = " + document.documentElement.offsetHeight + "\n" +
        "height(5) = " + document.body.clientHeight + "\n" +
        "height(6) = " + document.documentElement.clientHeight + "\n" +
        "height(7) = " + $('body').outerHeight(true)
    );
    parent.postMessage($('body').outerHeight(true) + "px", "*");
} 
```

在每种情况下，前六个值都不匹配每个浏览器（IE8/FF/Chrome）中的第七个值。第二个是最近的，但是当从一个大的子页面切换到一个较小的页面时，它在 Chrome 中失败了——它仍然给出了前一页的大小。

我确实阅读了 jQuery 的源代码，但我的 JavaScript 还不够好，无法弄清楚它在做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T12:55:11.377

jQuery 然后进入 cssHooks 函数，这一切都开始变得棘手。回想起来，花时间试图弄清楚它在做什么似乎毫无意义。我应该使用它。我在父页面中使用它，所以无论如何所有浏览器都会缓存它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T14:43:02.017

Vanilla Masonry 有一个功能 - getWH() - 从 Jquery 重构，它应该可以满足您的需求： [https ://github.com/desandro/vanilla-masonry](https://github.com/desandro/vanilla-masonry)

```
// returns width/height of element, refactored getWH from jQuery
function getWH( elem, measure, isOuter ) {
    // Start with offset property
    var isWidth = measure !== 'height',
        val = isWidth ? elem.offsetWidth : elem.offsetHeight,
        dirA = isWidth ? 'Left' : 'Top',
        dirB = isWidth ? 'Right' : 'Bottom',
        computedStyle = getStyle( elem ),
        paddingA = parseFloat( computedStyle[ 'padding' + dirA ] ) || 0,
        paddingB = parseFloat( computedStyle[ 'padding' + dirB ] ) || 0,
        borderA = parseFloat( computedStyle[ 'border' + dirA + 'Width' ] ) || 0,
        borderB = parseFloat( computedStyle[ 'border' + dirB + 'Width' ] ) || 0,
        computedMarginA = computedStyle[ 'margin' + dirA ],
        computedMarginB = computedStyle[ 'margin' + dirB ],
        marginA, marginB;

    if ( !supportsPercentMargin ) {
        computedMarginA = hackPercentMargin( elem, computedStyle, computedMarginA );
        computedMarginB = hackPercentMargin( elem, computedStyle, computedMarginB );
    }

    marginA = parseFloat( computedMarginA ) || 0;
    marginB = parseFloat( computedMarginB ) || 0;

    if ( val > 0 ) {

        if ( isOuter ) {
            // outerWidth, outerHeight, add margin
            val += marginA + marginB;
        } else {
            // like getting width() or height(), no padding or border
            val -= paddingA + paddingB + borderA + borderB;
        }

    } else {

        // Fall back to computed then uncomputed css if necessary
        val = computedStyle[ measure ];
        if ( val < 0 || val === null ) {
            val = elem.style[ measure ] || 0;
        }
        // Normalize "", auto, and prepare for extra
        val = parseFloat( val ) || 0;

        if ( isOuter ) {
            // Add padding, border, margin
            val += paddingA + paddingB + marginA + marginB + borderA + borderB;
        }
    }

    return val;
} 
```

[编辑] 你还需要从 vanilla-masonry.js 获取 hackPercentMargin 和 getStyle

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:45:38.763

您可以查看[jQuery 源代码](http://code.jquery.com/jquery-1.7.2.js)。

```
// outerHeight and outerWidth
jQuery.fn[ "outer" + name ] = function( margin ) {
    var elem = this[0];
    return elem ?
        elem.style ?
        parseFloat( jQuery.css( elem, type, margin ? "margin" : "border" ) ) :
        this[ type ]() :
        null;
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T15:52:14.453

```
$('body').outerHeight(true) = document.body.height + document.body.marginTop + document.body.marginBottom + document.body.bordorTop + document.body.borderBottom 
```

# c# - 扩展器的默认 ControlTemplate

> ID：10143989
> 
> 赞同：10
> 
> 时间：2012-04-13T15:42:19.517
> 
> 标签：c#, wpf, controltemplate, expander

有人（可能使用 Blend）可以为我提供 WPF 扩展器的工作默认 ControlTemplate 吗？我想做一些细微的修改，但似乎找不到有效模板的来源。

提前致谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-13T15:47:53.770

我有混合，可以帮助你。这是 Blend 为我生成的。

```
<ResourceDictionary
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
<Style x:Key="ExpanderRightHeaderStyle" TargetType="{x:Type ToggleButton}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ToggleButton}">
                <Border Padding="{TemplateBinding Padding}">
                    <Grid Background="Transparent" SnapsToDevicePixels="False">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="19"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid>
                            <Grid.LayoutTransform>
                                <TransformGroup>
                                    <TransformGroup.Children>
                                        <TransformCollection>
                                            <RotateTransform Angle="-90"/>
                                        </TransformCollection>
                                    </TransformGroup.Children>
                                </TransformGroup>
                            </Grid.LayoutTransform>
                            <Ellipse x:Name="circle" HorizontalAlignment="Center" Height="19" Stroke="DarkGray" VerticalAlignment="Center" Width="19"/>
                            <Path x:Name="arrow" Data="M 1,1.5 L 4.5,5 L 8,1.5" HorizontalAlignment="Center" SnapsToDevicePixels="false" Stroke="#666" StrokeThickness="2" VerticalAlignment="Center"/>
                        </Grid>
                        <ContentPresenter HorizontalAlignment="Center" Margin="0,4,0,0" Grid.Row="1" RecognizesAccessKey="True" SnapsToDevicePixels="True" VerticalAlignment="Top"/>
                    </Grid>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsChecked" Value="true">
                        <Setter Property="Data" TargetName="arrow" Value="M 1,4.5  L 4.5,1  L 8,4.5"/>
                    </Trigger>
                    <Trigger Property="IsMouseOver" Value="true">
                        <Setter Property="Stroke" TargetName="circle" Value="#FF3C7FB1"/>
                        <Setter Property="Stroke" TargetName="arrow" Value="#222"/>
                    </Trigger>
                    <Trigger Property="IsPressed" Value="true">
                        <Setter Property="Stroke" TargetName="circle" Value="#FF526C7B"/>
                        <Setter Property="StrokeThickness" TargetName="circle" Value="1.5"/>
                        <Setter Property="Stroke" TargetName="arrow" Value="#FF003366"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
<Style x:Key="ExpanderUpHeaderStyle" TargetType="{x:Type ToggleButton}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ToggleButton}">
                <Border Padding="{TemplateBinding Padding}">
                    <Grid Background="Transparent" SnapsToDevicePixels="False">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="19"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid>
                            <Grid.LayoutTransform>
                                <TransformGroup>
                                    <TransformGroup.Children>
                                        <TransformCollection>
                                            <RotateTransform Angle="180"/>
                                        </TransformCollection>
                                    </TransformGroup.Children>
                                </TransformGroup>
                            </Grid.LayoutTransform>
                            <Ellipse x:Name="circle" HorizontalAlignment="Center" Height="19" Stroke="DarkGray" VerticalAlignment="Center" Width="19"/>
                            <Path x:Name="arrow" Data="M 1,1.5 L 4.5,5 L 8,1.5" HorizontalAlignment="Center" SnapsToDevicePixels="false" Stroke="#666" StrokeThickness="2" VerticalAlignment="Center"/>
                        </Grid>
                        <ContentPresenter Grid.Column="1" HorizontalAlignment="Left" Margin="4,0,0,0" RecognizesAccessKey="True" SnapsToDevicePixels="True" VerticalAlignment="Center"/>
                    </Grid>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsChecked" Value="true">
                        <Setter Property="Data" TargetName="arrow" Value="M 1,4.5  L 4.5,1  L 8,4.5"/>
                    </Trigger>
                    <Trigger Property="IsMouseOver" Value="true">
                        <Setter Property="Stroke" TargetName="circle" Value="#FF3C7FB1"/>
                        <Setter Property="Stroke" TargetName="arrow" Value="#222"/>
                    </Trigger>
                    <Trigger Property="IsPressed" Value="true">
                        <Setter Property="Stroke" TargetName="circle" Value="#FF526C7B"/>
                        <Setter Property="StrokeThickness" TargetName="circle" Value="1.5"/>
                        <Setter Property="Stroke" TargetName="arrow" Value="#FF003366"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
<Style x:Key="ExpanderLeftHeaderStyle" TargetType="{x:Type ToggleButton}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ToggleButton}">
                <Border Padding="{TemplateBinding Padding}">
                    <Grid Background="Transparent" SnapsToDevicePixels="False">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="19"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid>
                            <Grid.LayoutTransform>
                                <TransformGroup>
                                    <TransformGroup.Children>
                                        <TransformCollection>
                                            <RotateTransform Angle="90"/>
                                        </TransformCollection>
                                    </TransformGroup.Children>
                                </TransformGroup>
                            </Grid.LayoutTransform>
                            <Ellipse x:Name="circle" HorizontalAlignment="Center" Height="19" Stroke="DarkGray" VerticalAlignment="Center" Width="19"/>
                            <Path x:Name="arrow" Data="M 1,1.5 L 4.5,5 L 8,1.5" HorizontalAlignment="Center" SnapsToDevicePixels="false" Stroke="#666" StrokeThickness="2" VerticalAlignment="Center"/>
                        </Grid>
                        <ContentPresenter HorizontalAlignment="Center" Margin="0,4,0,0" Grid.Row="1" RecognizesAccessKey="True" SnapsToDevicePixels="True" VerticalAlignment="Top"/>
                    </Grid>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsChecked" Value="true">
                        <Setter Property="Data" TargetName="arrow" Value="M 1,4.5  L 4.5,1  L 8,4.5"/>
                    </Trigger>
                    <Trigger Property="IsMouseOver" Value="true">
                        <Setter Property="Stroke" TargetName="circle" Value="#FF3C7FB1"/>
                        <Setter Property="Stroke" TargetName="arrow" Value="#222"/>
                    </Trigger>
                    <Trigger Property="IsPressed" Value="true">
                        <Setter Property="Stroke" TargetName="circle" Value="#FF526C7B"/>
                        <Setter Property="StrokeThickness" TargetName="circle" Value="1.5"/>
                        <Setter Property="Stroke" TargetName="arrow" Value="#FF003366"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
<Style x:Key="ExpanderHeaderFocusVisual">
    <Setter Property="Control.Template">
        <Setter.Value>
            <ControlTemplate>
                <Border>
                    <Rectangle Margin="0" SnapsToDevicePixels="true" Stroke="Black" StrokeThickness="1" StrokeDashArray="1 2"/>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
<Style x:Key="ExpanderDownHeaderStyle" TargetType="{x:Type ToggleButton}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ToggleButton}">
                <Border Padding="{TemplateBinding Padding}">
                    <Grid Background="Transparent" SnapsToDevicePixels="False">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="19"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Ellipse x:Name="circle" HorizontalAlignment="Center" Height="19" Stroke="DarkGray" VerticalAlignment="Center" Width="19"/>
                        <Path x:Name="arrow" Data="M 1,1.5 L 4.5,5 L 8,1.5" HorizontalAlignment="Center" SnapsToDevicePixels="false" Stroke="#666" StrokeThickness="2" VerticalAlignment="Center"/>
                        <ContentPresenter Grid.Column="1" HorizontalAlignment="Left" Margin="4,0,0,0" RecognizesAccessKey="True" SnapsToDevicePixels="True" VerticalAlignment="Center"/>
                    </Grid>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsChecked" Value="true">
                        <Setter Property="Data" TargetName="arrow" Value="M 1,4.5  L 4.5,1  L 8,4.5"/>
                    </Trigger>
                    <Trigger Property="IsMouseOver" Value="true">
                        <Setter Property="Stroke" TargetName="circle" Value="#FF3C7FB1"/>
                        <Setter Property="Stroke" TargetName="arrow" Value="#222"/>
                    </Trigger>
                    <Trigger Property="IsPressed" Value="true">
                        <Setter Property="Stroke" TargetName="circle" Value="#FF526C7B"/>
                        <Setter Property="StrokeThickness" TargetName="circle" Value="1.5"/>
                        <Setter Property="Stroke" TargetName="arrow" Value="#FF003366"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
<Style x:Key="ExpanderStyle1" TargetType="{x:Type Expander}">
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
    <Setter Property="VerticalContentAlignment" Value="Stretch"/>
    <Setter Property="BorderBrush" Value="Transparent"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Expander}">
                <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" CornerRadius="3" SnapsToDevicePixels="true">
                    <DockPanel>
                        <ToggleButton x:Name="HeaderSite" ContentTemplate="{TemplateBinding HeaderTemplate}" ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}" Content="{TemplateBinding Header}" DockPanel.Dock="Top" Foreground="{TemplateBinding Foreground}" FontWeight="{TemplateBinding FontWeight}" FocusVisualStyle="{StaticResource ExpanderHeaderFocusVisual}" FontStyle="{TemplateBinding FontStyle}" FontStretch="{TemplateBinding FontStretch}" FontSize="{TemplateBinding FontSize}" FontFamily="{TemplateBinding FontFamily}" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" IsChecked="{Binding IsExpanded, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Margin="1" MinWidth="0" MinHeight="0" Padding="{TemplateBinding Padding}" Style="{StaticResource ExpanderDownHeaderStyle}" VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        <ContentPresenter x:Name="ExpandSite" DockPanel.Dock="Bottom" Focusable="false" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" Visibility="Collapsed" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                    </DockPanel>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsExpanded" Value="true">
                        <Setter Property="Visibility" TargetName="ExpandSite" Value="Visible"/>
                    </Trigger>
                    <Trigger Property="ExpandDirection" Value="Right">
                        <Setter Property="DockPanel.Dock" TargetName="ExpandSite" Value="Right"/>
                        <Setter Property="DockPanel.Dock" TargetName="HeaderSite" Value="Left"/>
                        <Setter Property="Style" TargetName="HeaderSite" Value="{StaticResource ExpanderRightHeaderStyle}"/>
                    </Trigger>
                    <Trigger Property="ExpandDirection" Value="Up">
                        <Setter Property="DockPanel.Dock" TargetName="ExpandSite" Value="Top"/>
                        <Setter Property="DockPanel.Dock" TargetName="HeaderSite" Value="Bottom"/>
                        <Setter Property="Style" TargetName="HeaderSite" Value="{StaticResource ExpanderUpHeaderStyle}"/>
                    </Trigger>
                    <Trigger Property="ExpandDirection" Value="Left">
                        <Setter Property="DockPanel.Dock" TargetName="ExpandSite" Value="Left"/>
                        <Setter Property="DockPanel.Dock" TargetName="HeaderSite" Value="Right"/>
                        <Setter Property="Style" TargetName="HeaderSite" Value="{StaticResource ExpanderLeftHeaderStyle}"/>
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
<!-- Resource dictionary entries should be defined here. --> 
```

# asp.net - 将查询转换为参数化的 asp.net 查询

> ID：10143995
> 
> 赞同：0
> 
> 时间：2012-04-13T15:42:47.897
> 
> 标签：asp.net

我将如何使这个参数化？

```
string query = "";

            query += " SELECT DistID FROM Distributor";
            query += " WHERE Username = '" + username_id.Text + "'";
            query += " AND Password = '" + password.Text + "'";

            GeneralFunctions.GetData( query ); 
```

可以在这里完成还是必须在 GetData 方法中完成？

以下是两种方法：

```
public static DataTable GetData ( string query )
{
    SqlDataAdapter dataAdapter;
    DataTable table;

    try
    {
        dataAdapter = new SqlDataAdapter( query, GetConnectionString() );
        table = new DataTable();

        dataAdapter.Fill( table );
        return table;
    }
    catch ( Exception ex )
    {
    }
    finally
    {
        dataAdapter = null;
        table = null;
    }

    return table;
}

public static string GetConnectionString ()
{
    string connectionString = ConfigurationManager.ConnectionStrings[ "CAPortalConnectionString" ].ConnectionString;

    return connectionString;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:51:50.960

我建议您设计特定的方法来查询您的数据库，如下所示：

```
public static int? GetDistID(string username, string password)
{
    using (var conn = new SqlConnection(GetConnectionString()))
    using (var cmd = conn.CreateCommand())
    {
        conn.Open();
        cmd.CommandText = 
        @"SELECT 
              DistID 
          FROM 
              Distributor
          WHERE 
              Username = @username 
          AND 
              Password = @password";
        cmd.Parameters.AddWithValue("@username", username);
        cmd.Parameters.AddWithValue("@password", password);
        using (var reader = cmd.ExecuteReader())
        {
            if (!reader.Read())
            {
                // no results found
                return null;
            }
            return reader.GetInt32(reader.GetOrdinal("DistID"));
        }
    }
} 
```

接着：

```
var distId = GeneralFunctions.GetDistID(username_id.Text, password.Text); 
```

不需要数据表/集/适配器。使用强类型对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T16:05:37.097

使用该`SqlCommand`对象，您可以像这样创建参数化查询：

```
public object GetDistID(string username, string password)
{
    using (var conn = new SqlConnection("..."))
    {
        using (var cmd = new SqlCommand("SELECT DistID FROM Distributor WHERE Username=@Username AND Password=@Password", conn))
        {
            cmd.Connection.Open();
            cmd.Parameters.AddWithValue("@Username", username);
            cmd.Parameters.AddWithValue("@Password", password);                
            return cmd.ExecuteScalar();
        }
    }
} 
```

如果它对你有用，这里有一个你可以使用的类。它是为存储过程量身定制的，但添加一个接受查询的方法应该很容易：

```
using System;
using System.Data;
using System.Data.SqlClient;
using System.Configuration;
using System.Web;
using System.Xml;
using System.Collections;
using System.Collections.Specialized;
using System.Collections.Generic;
using System.Text;

namespace NESCTC.Data
{  
    public class DataAccess : IDisposable
    {
        #region declarations

        private SqlCommand _cmd;
        private string _SqlConnString;

        #endregion

        #region constructors

        public DataAccess(string ConnectionString)
        {
            _cmd = new SqlCommand();
            _cmd.CommandTimeout = 240;
            _SqlConnString = ConnectionString;
        }

        #endregion

        #region IDisposable implementation

        ~DataAccess()
        {
            Dispose(false);
        }

        public void Dispose()
        {
            Dispose(true);            
        }

        protected virtual void Dispose(bool disposing)
        {
            if (disposing)
            {
                _cmd.Connection.Dispose();
                _cmd.Dispose();
            }
        }

        #endregion

        #region data retrieval methods

        public DataTable ExecReturnDataTable()
        {
            using (SqlConnection conn = new SqlConnection(this.ConnectionString))
            {
                try
                {
                    PrepareCommandForExecution(conn);
                    using (SqlDataAdapter adap = new SqlDataAdapter(_cmd))
                    {
                        DataTable dt = new DataTable();
                        adap.Fill(dt);
                        return dt;
                    }
                }
                catch
                {
                    _cmd.Connection.Close();
                    throw;
                }
                finally
                {
                    _cmd.Connection.Close();
                }
            }
        }    

        public object ExecScalar()
        {
            using (SqlConnection conn = new SqlConnection(this.ConnectionString))
            {
                try
                {
                    PrepareCommandForExecution(conn);
                    return _cmd.ExecuteScalar();
                }
                catch (Exception ex)
                {
                    _cmd.Connection.Close();
                    throw ex;
                }
                finally
                {
                    _cmd.Connection.Close();
                }
            }
        }                

        #endregion

        #region data insert and update methods

        public void ExecNonQuery()
        {
            using (SqlConnection conn = new SqlConnection(this.ConnectionString))
            {
                try
                {
                    PrepareCommandForExecution(conn);
                    _cmd.ExecuteNonQuery();
                }
                catch
                {
                    _cmd.Connection.Close();
                    throw;
                }
                finally
                {
                    _cmd.Connection.Close();
                }
            }
        }

        #endregion

        #region helper methods

        public void AddParm(string ParameterName, SqlDbType ParameterType, object Value)
        { _cmd.Parameters.Add(ParameterName, ParameterType).Value = Value; }

        private SqlCommand PrepareCommandForExecution(SqlConnection conn)
        {
            try
            {
                _cmd.Connection = conn;
                _cmd.CommandType = CommandType.StoredProcedure;
                _cmd.CommandTimeout = this.CommandTimeout;
                _cmd.Connection.Open();

                return _cmd;
            }
            catch
            {
                _cmd.Connection.Close();
                throw;
            }
        }

        #endregion

        #region properties

        public int CommandTimeout
        {
            get { return _cmd.CommandTimeout; }
            set { _cmd.CommandTimeout = value; }
        }

        public string ProcedureName
        {
            get { return _cmd.CommandText; }
            set { _cmd.CommandText = value; }
        }

        public string ConnectionString
        {
            get { return _SqlConnString; }
            set { _SqlConnString = value; }
        }

        #endregion
    }
} 
```

您可以像这样使用该类：

```
public object GetDistID(string username, string password)
{
    using (var data = new DataAccess("ConnectionString"))
    {
        data.ProcedureName = "GetDistID";
        data.AddParm("@Username", SqlDbType.VarChar, username);
        data.AddParm("@Password", SqlDbType.VarChar, password);
        return data.ExecScalar();
    }
} 
```

# java - Windows Console(java) System.out.println() 中的西里尔字母；

> ID：10143998
> 
> 赞同：2
> 
> 时间：2012-04-13T15:42:54.263
> 
> 标签：java, encoding, utf-8

当我写一些西里尔文字时， System.out.println("Русский язык") - 然后它超过了这个╨єёёъшщ ч√ъ，使用 Windows 控制台，如何解决这个问题？，文件编码是 utf-8，但它没关系，当它是 ansii 或 windows-1251 时，它输出相同。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-13T22:13:13.880

```
import java.io.PrintStream;
class Kyrill {
    public static void main(String args[])
        throws java.io.UnsupportedEncodingException
    {
        String ru = "Русский язык";
        PrintStream ps = new PrintStream(System.out, true, "UTF-8");
        System.out.println(ru.length());
        System.out.println(ru);
        ps.println(ru);
    }
}

D:\Temp :: chcp 65001
Aktive Codepage: 65001.

D:\Temp :: javac -encoding utf-8 Kyrill.java && java Kyrill
12
??????? ????
Русский языкй язык 
```

请注意，您可能会在输出中看到一些尾随垃圾（我会），但如果您将输出重定向到一个文件，您会发现这只是一个显示伪影。

[因此，您可以使用PrintStream](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/PrintStream.html)使其工作。[System.out](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/System.html)使用平台编码（对我来说是 cp1252），并且没有西里尔字符。

为您了解编码业务的附加说明：

```
D:\Temp :: chcp 1251
Aktive Codepage: 1251.
:: This is another codepage (8 bits only) that maps bytes to cyrillic characters.
:: Edit the source file to have:
::      PrintStream ps = new PrintStream(System.out, true, "Windows-1251");
:: We intend to match the console output; else we won't get the expected result.
D:\Temp :: javac -encoding utf-8 Kyrill.java && java Kyrill
12
??????? ????
Русский язык 
```

因此，您可以看到，与某些人所认为的相反，Windows 控制台确实在随意理解*Unicode ，因为它可以打印希腊语和俄语。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T19:24:37.267

尽管您可以通过 chcp 65001 将 Windows 控制台切换到 UTF-8，但您可能仍然无法正确查看 UTF-8 输出。这可能不是您想要的，但它至少是一种选择：将您的标准输出重定向到文件。将源文件保存为 UTF-8 并使用 UTF-8 编码对其进行编译。可以使用支持 UTF-8 的文本编辑器查看重定向的输出文件。

```
String s = "Русский язык";
System.setOut(new PrintStream(new FileOutputStream("out.txt"), true, "UTF-8"));
System.out.println(s); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T19:32:32.197

由于历史原因（还记得 DOS 吗？），Windows 控制台使用 Cyrillic 编码 CP866。Windows 控制台绝对不支持 Unicode。

（唉，我周围没有 Windows 机器来提供经过测试的代码片段。）

# c# - 带有动态 where 子句的 linq 查询

> ID：10143999
> 
> 赞同：0
> 
> 时间：2012-04-13T15:43:01.320
> 
> 标签：c#, asp.net, vb.net, linq, c#-4.0

我需要使用 LINQ 执行类似这样的 t-sql 语句：

```
SELECT * FROM mytable WHERE idnumber IN('1', '2', '3') 
```

所以在 LINQ 我有：

```
Dim _Values as String = "1, 2, 3"
Dim _Query = (From m In mytable Where idnumber = _Values Select m).ToList() 
```

不确定如何处理 _Values 以使 idnumber 评估字符串中的每个值。
提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:49:19.307

我会`Inner Join`在这种情况下进行。如果我会使用`Contains`，它会`Iterate unnecessarily`6 次`despite of the fact that there is just one match`。

## C#版本

```
var desiredNames = new[] { "Pankaj", "Garg" }; 

var people = new[]  
{  
    new { FirstName="Pankaj", Surname="Garg" },  
    new { FirstName="Marc", Surname="Gravell" },  
    new { FirstName="Jeff", Surname="Atwood" }  
}; 

var records = (from p in people 
               join filtered in desiredNames on p.FirstName equals filtered  
               select p.FirstName
              ).ToList(); 
```

* * *

## VB.Net版

```
Dim desiredNames = New () {"Pankaj", "Garg"}

Dim people = New () {New With { _
    .FirstName = "Pankaj", _
    .Surname = "Garg" _
}, New With { _
    .FirstName = "Marc", _
    .Surname = "Gravell" _
}, New With { _
    .FirstName = "Jeff", _
    .Surname = "Atwood" _
}}

Dim records = ( _
    Join filtered In desiredNames On p.FirstName = filtered).ToList() 
```

## 包含的缺点

假设我有两个列表对象。

```
List 1      List 2
  1           12
  2            7
  3            8
  4           98
  5            9
  6           10
  7            6 
```

## 使用 Contains，它将搜索 List-2 中的每个 List-1 项目，这意味着迭代将发生 49 次！！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:45:23.243

```
Dim _Values as String = "1, 2, 3"
Dim _Query = (From m In mytable Where _Values.Split(", ").Contains(m.idnumber) Select m).ToList() 
```