# StackOverflow 问答 000765000-000765999

# cruisecontrol.net - CruiseControl.NET 在构建时发送带有修复列表的邮件？

> ID：765011
> 
> 赞同：1
> 
> 时间：2009-04-19T07:27:07.500
> 
> 标签：cruisecontrol.net

我想知道是否可以在我的部署构建电子邮件通知中包含一个修复列表，我期望的是我会将最新更改添加到存储在目录中的文本文件中，CruiseControl.NET 会从那里选择它并与电子邮件一起发送。任何人有任何类似的解决方案，或者你是怎么做到的？任何示例或链接？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T07:37:59.890

第一个问题是您是进行持续集成 (CI) 构建还是只是定期构建？如果是 CI，您是否尝试过将此修复列表写入您的版本控制系统的签入注释中？CCNet 将此评论显示为构建报告（和电子邮件通知）的一部分。

更新：我看到的另一个选择是为此编写自己的 CCNet 插件。应该不会太难。作为编写 CCNet 插件的参考，您可以使用我自己的[BrekiLabeller](http://sourceforge.net/projects/brekiccnetutils/)插件。

# c# - 如何停止处理进一步的事件

> ID：765019
> 
> 赞同：1
> 
> 时间：2009-04-19T07:38:53.413
> 
> 标签：c#, events, event-handling, invoke

与 KeyPress 事件类似，我希望订阅该事件的人能够在我的 EventArgs 类中设置 e.Handled。如果它们返回 true，我不再想继续触发事件。任何想法如何实现这一点？现在，这是我的方法：

```
protected void OnDataReceived(SocketAsyncEventArgs e)
{
    if (DataReceived != null)
    {                
        DataReceived(this, e);
    }
} 
```

据我了解，每个订阅该事件的人都会收到通知，因此设置 e.Handled = true; 在这里不会有任何影响。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T12:18:50.073

使用以下解决方案的示例代码[`Delegate.GetInvocationList`](http://msdn.microsoft.com/en-us/library/system.delegate.getinvocationlist(loband).aspx)：

```
public class MyEventArgs : EventArgs
{
    public bool Handled { get; set; }
}

public class SomeClass
{
    public event EventHandler<MyEventArgs> SomeEvent;

    protected virtual void OnSomeEvent(MyEventArgs e)
    {
        var listeners = SomeEvent.GetInvocationList();
        foreach (var listener in listeners)
        {
            if (e.Handled) break;
            ((EventHandler<MyEventArgs>)listener).Invoke(this, e);
        }
    }
} 
```

# rdbms - 什么是 RDBMS 中的集群？

> ID：765021
> 
> 赞同：1
> 
> 时间：2009-04-19T07:41:23.953
> 
> 标签：rdbms

请解释一下 RDBMS 中的集群是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T07:56:56.193

在**SQL**中，集群也可以引用特定的物理行顺序。

例如，考虑具有两个表的数据库：INVOICES 和 INVOICE_ITEMS。如果同时插入许多 INVOICE_ITEM，那么同一张发票的项目很可能最终会出现在底层存储的多个物理块上。在读取这样的发票时，不需要的数据将与感兴趣的行一起读取。通过 INVOICES 的外键将 INVOICE_ITEMS 聚类到 INVOICES 将同一发票的项目行分组到同一块中，从而减少访问发票时所需的读取操作量。

阅读维基百科上的[聚集索引](http://en.wikipedia.org/wiki/Index_(database)#Clustered)。

* * *

在**系统管理**中，“集群”是配置为提供相同服务的多个服务器，但在用户看来就像一台服务器。

这可以出于性能原因（两台服务器可以响应比一台服务器更多的请求）或冗余（如果一台服务器崩溃，其他服务器仍然工作）来完成。

这样的配置通常需要特殊的软件或设置才能工作。一些服务，比如提供静态 Web 内容，可以很容易地集群。其他的，比如 RDBMS，需要复杂的复制方案来协调。

在 wikipedia 上阅读有关[计算机集群的信息。](http://en.wikipedia.org/wiki/Cluster_(computing))

* * *

在**统计学**中，集群是“一组项目，因此来自同一集群的对象比来自不同集群的对象更相似”。

阅读维基百科上的[聚类分析](http://en.wikipedia.org/wiki/Cluster_analysis)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T07:45:20.123

从[这里](http://en.wikipedia.org/wiki/High-availability_cluster)：

> 高可用性集群（也称为 HA 集群或故障转移集群）是计算机集群，其实施主要是为了提供集群提供的服务的高可用性。它们通过具有冗余计算机或节点来运行，然后当系统组件发生故障时，这些计算机或节点用于提供服务。通常，如果具有特定应用程序的服务器崩溃，则该应用程序将不可用，直到有人修复崩溃的服务器。HA 集群通过检测硬件/软件故障并立即在另一个系统上重新启动应用程序而不需要管理干预来纠正这种情况，这一过程称为故障转移

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T09:21:15.103

在数据库上下文中，它可以有两种完全不同的含义：

*   可能意味着[数据集群](http://en.wikipedia.org/wiki/Data_clustering)或[索引集群](http://en.wikipedia.org/wiki/Index_(database)#Clustered)，这是对相似行的分组。这对于数据挖掘很有用，一些数据库（例如[Oracle](http://www.dba-oracle.com/art_index_clustering_factor.htm)）也使用它来优化物理数据组织；
*   或[集群](http://en.wikipedia.org/wiki/Computer_cluster)作为在许多紧密链接的服务器上运行的数据库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-07T10:55:40.770

集群，在数据库的上下文中。它是指多个服务器或实例连接到单个数据库的能力。实例是与数据库交互的内存和进程的集合，数据库是实际存储数据的物理文件集。

# perl - 'use lib' 是否适用于 UNC 路径？

> ID：765029
> 
> 赞同：4
> 
> 时间：2009-04-19T07:48:40.753
> 
> 标签：perl, unc

我的托管脚本已被移动，不再工作。

> 指定的 CGI 应用程序因未返回完整的 HTTP 标头集而行为异常。

我注意到我的托管公司的某个人修改了我的脚本，以便我曾经拥有的地方

```
use lib 'd:/myorig/LIB'; 
```

我现在有

```
use lib '//newhost/LIB'; 
```

这应该工作吗？

我尝试了 1800 INFORMATION 的建议并运行了最小的脚本

```
#!perl -w
use lib '//whatever/lib';
print "success"; 
```

...给出了相同的结果。

**更新**：ysth 对 FatalsToBrowser 的建议确实揭示了更多信息。看起来路径（由托管公司的人添加）可能是错误的。

**更新**2：托管公司现在表示，这些脚本与之前的托管人想法相同，但会引发大量语法错误。“由于我们无法为您调试脚本，我们建议您联系原始程序员并向他们寻求帮助”。 `<grinds teeth>`

**部分解决方案：**托管公司终于意识到他们没有正确设置权限。他们仍然不对，并且（aargh）他们不允许站点所有者设置文件夹权限，甚至在他们自己站点中的文件夹上也不行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T08:01:22.363

我不知道它是否应该工作，但我的直觉是它会好的。但是，`use lib`您发布的两行并不等同。

```
# go to the 'd' drive and use the 'myorigLIB' directory on that drive
use lib 'd:/myorigLIB';

# go to the 'newhostLIB' server - no path is specified - this looks invalid to me
use lib '//newhostLIB'; 
```

也许您需要指定服务器上共享的路径？另外，您可能需要查看权限？也许 CGI 运行的用户无法访问该网络路径？

此外，您可以编写一个简单的（非 CGI）程序来测试您的理论并运行它：

```
#!perl -w
use lib '//whatever/lib';
print "success"; 
```

然后，如果可以的话，只需在服务器上运行它，看看会发生什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T08:11:40.760

不，路径不完整，它需要服务器名称和完整路径。这也是一种不好的做法，因为它需要监控两台机器而不是一台机器才能让您的应用程序运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T10:05:47.320

```
The specified CGI application misbehaved by not returning a complete set of HTTP headers. 
```

那是没有错误的。如果你幸运的话，你的托管公司会为你提供一个错误日志，它会显示 perl 正在死去的实际错误。如果没有，请考虑使用

```
use CGI::Carp "fatalsToBrowser"; 
```

供测试用。（如果您是偏执狂（这不是一件坏事），一旦完成测试，您将避免启用它，因为错误通常会提供有关您的代码甚至您的数据库的信息，这可能有助于黑帽利用安全性孔。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T14:02:30.200

我知道我在尝试使用来自 apache 的映射驱动器和 unc 路径时遇到了麻烦，因为不允许 apache 用户使用网络驱动器。这很难弄清楚——但有可能做到。这可能是一个相关的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T13:45:00.453

```
#!perl -w

print "HTTP/1.0 200 OK\nContent-Type: text/plain\n\n";

my $path = "//whatever/lib";
print "\nExists ", -e $path;
print "\nDirectory ", -d $path;
print "\nReadable ", -r $path;
print "\nListing:\n";
print "\t$_\n" for glob "$path/*"; 
```

# cocoa - NSTableView 内的 NSTextFieldCell 中的可点击 url 链接？

> ID：765047
> 
> 赞同：6
> 
> 时间：2009-04-19T08:05:46.767
> 
> 标签：cocoa, url, nstableview, nstextfield

我有一个在 NSTextFieldCell 中使用的 NSAttributedString。它创建了几个可点击的 url 链接，并在 NSTextFieldCell 中放置了一个大的 NSAttributedString。每当我正常查看 NSTextFieldCell 并突出显示时，我都无法单击链接。

如果我设置 TableView 以便可以编辑每一列或每一行，当我单击两次时，进入编辑模式并查看 NSTextFieldCell 内容，我的链接会显示出来并且是可点击的。当我点击远离该行时，我再也看不到可点击的链接。

我必须处于“编辑”模式才能查看链接或单击它们。

我觉得我只是缺少一些设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-06-14T20:36:57.353

我认为技术说明没有回答这个问题，即如何在 NSTableView 单元格中放置链接。我发现做到这一点的最好方法是使用按钮单元格作为表格单元格。这假定只有链接将位于表的特定列中。

在 Interface Builder 中，将 NSButton 单元格拖到需要链接的表格列上。

在您的表视图委托中，实现 tableView:dataCellForTableColumn:row: 如下：

```
- (NSCell *) tableView: (NSTableView *) tableView
    dataCellForTableColumn: (NSTableColumn *) column
    row: (NSInteger) row
{
    NSButtonCell *buttonCell = nil;
    NSAttributedString *title = nil;
    NSString *link = nil;
    NSDictionary *attributes = nil;

// Cell for entire row -- we don't do headers
    if (column == nil)
        return(nil);

// Columns other than link do the normal thing
    if (![self isLinkColumn:column]) // Implement this as appropriate for your table
        return([column dataCellForRow:row]);

// If no link, no button, just a blank text field
    if ((link = [self linkForRow:row]) != nil) // Implement this as appropriate for your table
        return([[[NSTextFieldCell alloc] initTextCell:@""] autorelease]);

// It's a link. Create the title
    attributes = [[NSDictionary alloc] initWithObjectsAndKeys:
        [NSFont systemFontOfSize:[NSFont systemFontSize]], NSFontAttributeName,
        [NSNumber numberWithInt:NSUnderlineStyleSingle], NSUnderlineStyleAttributeName,
        [NSColor blueColor], NSForegroundColorAttributeName,
        [NSURL URLWithString:link], NSLinkAttributeName, nil];
    title = [[NSAttributedString alloc] initWithString:link attributes:attributes];
    [attributes release];

// Create a button cell
    buttonCell = [[[NSButtonCell alloc] init] autorelease];
    [buttonCell setBezelStyle:NSRoundedBezelStyle];
    [buttonCell setButtonType:NSMomentaryPushInButton];
    [buttonCell setBordered:NO]; // Don't want a bordered button
    [buttonCell setAttributedTitle:title];
    [title release];
    return(buttonCell);
} 
```

将表的目标/操作设置为您的委托，并检查链接列上的点击：

```
- (void) clickTable: (NSTableView *) sender
{
    NSTableColumn *column = [[sender tableColumns] objectAtIndex:[sender clickedColumn]];
    NSInteger row = [sender clickedRow];
    NSString *link = nil;

    if ([self isLinkColumn:column] && (link = [self linkForRow:row]) != nil)
        [[NSWorkspace sharedWorkspace] openURL:[NSURL URLWithString:link]];
} 
```

现在链接*看起来*像一个链接，但单击它实际上是一个按钮按下，您可以在 action 方法中检测到它并使用 NSWorkspace 进行调度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-23T05:34:41.780

您是否看过 Apple 关于超链接的技术说明？

[在 NSTextField 和 NSTextView 中嵌入超链接](http://developer.apple.com/library/mac/#qa/qa2006/qa1487.html)

# python - 在 Python 中绘制一条龙曲线

> ID：765048
> 
> 赞同：-1
> 
> 时间：2009-04-19T08:06:50.477
> 
> 标签：python, fractals

我正在尝试使用 An L-System 或 Lindenmayer 系统绘制巨龙曲线。我没有代码是这样的

龙曲线；初始状态 = 'F'，替换规则 - 将 'F' 替换为 'F+F-F'，替换次数 = 8，长度 = 5，角度 = 60

但是不知道如何将其放入代码中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T08:30:21.450

首先在 Google 上搜索“dragons curve python”：

[http://www.pynokio.org/dragon.py.htm](http://www.pynokio.org/dragon.py.htm)

您可能可以修改它以使用您选择的绘图程序。我会尝试matplotlib。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-29T15:46:15.033

使用模块绘制龙曲线`turtle`（[@John Fouhy](https://stackoverflow.com/questions/765048/drawing-a-dragons-curve-in-python/766310#766310)建议）：

```
#!/usr/bin/env python
import turtle
from functools import partial

nreplacements = 8
angle = 60
step = 5

# generate command
cmd = 'f'
for _ in range(nreplacements):
    cmd = cmd.replace('f', 'f+f-f')

# draw
t = turtle.Turtle()
i2c = {'f': partial(t.forward, step),
       '+': partial(t.left, angle),
       '-': partial(t.right, angle),
}
for c in cmd: i2c[c]() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T22:56:20.853

好吧，大概，您可以从定义开始：

```
def replace(s):
    return s.replace('F', 'F+F-F') 
```

然后你可以生成你的序列：

```
code = 'F'
for i in range(8):
    code = replace(code) 
```

我不熟悉，`turtle`所以我无法帮助你。

# java - 多个java小程序处理

> ID：765050
> 
> 赞同：2
> 
> 时间：2009-04-19T08:08:37.603
> 
> 标签：java, applet, jpanel, jbutton

我正在创建一个具有多个面板的简单 java 游戏 Applet，主游戏面板有 4 个 JButton，当它们被点击时，它们会通向其余的面板。

当程序运行时，四个面板首先在 init() 中初始化，在每个面板初始化中，我使所有 Jcomponents 不可见，但只有主小程序。

假设在主 Applet 中有一个 JButton 调用启动，当它被按下时，我需要将所有主 JButtons 设置为不可见，并将子面板设置为可见但它对我不起作用，我使用了我能想到的一切，像 repaint() 或 UpdateUI() 但仍然无法正常工作。

任何建议将不胜感激。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T22:47:26.070

首先，确保所有创建不是在 init() 中执行，而是在 EDT 中执行，请参阅[教程](http://java.sun.com/docs/books/tutorial/uiswing/components/applet.html#thread)。如果你有一个 ampty start() 方法，我建议你在 init() 中使用 invokeLater（而不是教程推荐的 invokeAndWait）。

要隐藏按钮，只需调用JButton 上的[setVisible 。](http://java.sun.com/javase/6/docs/api/javax/swing/JComponent.html#setVisible(boolean))之后应该没有必要要求重新粉刷。

不看代码就很难进一步分析。

# java - IllegalArgumentException：对象不是声明类的实例

> ID：765052
> 
> 赞同：7
> 
> 时间：2009-04-19T08:08:55.167
> 
> 标签：java, reflection

怎么可能*没有*抛出“foo”异常，但随后调用 invoke() 会抛出以下异常？

```
if (method.getDeclaringClass() != object.getClass())
    throw new RuntimeException("foo");

method.invoke(object); 
```

抛出异常：

`java.lang.IllegalArgumentException: object is not an instance of declaring class at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-19T09:07:07.040

Beh... 这个`method.invoke()`电话不是直接发出的。目标方法也在使用`invoke`，它抛出了，所以它冒泡了。

经验教训：`InvocationTargetException`与其他异常分开处理。

# asp.net - 我最早什么时候可以访问 global.asax 中的一些 Session 数据？

> ID：765054
> 
> 赞同：18
> 
> 时间：2009-04-19T08:10:41.077
> 
> 标签：asp.net, session, global-asax

我想在我的 global.asax 中检查 Session 是否包含一些键/值数据。我不确定最早可能的时间（和方法名称）是什么时候来检查这个。

谢谢 ：）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-11-10T18:45:36.317

我一直认为`Application_AcquireRequestState`是 Global.asax 中第一个可以访问当前会话的事件。绝对不是`Application_BeginRequest`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-21T17:17:41.603

[MSDN](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.postacquirerequeststate.aspx)随便提到了在 Application_PostAcquireRequestState 事件期间获取会话状态。我希望它在[生命周期概述](http://msdn.microsoft.com/en-us/library/bb470252.aspx)页面上得到重申。

[您可以访问的最新会话状态在 Application_PostRequestHandlerExecute 中，因为它在下一个事件Application_ReleaseRequestState](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.releaserequeststate.aspx)期间由 SessionStateModule 保存。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-04-19T08:26:29.773

您需要使用`BeginRequest`（[http://msdn.microsoft.com/en-us/library/system.web.httpapplication.beginrequest.aspx](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.beginrequest.aspx)`HttpApplication` ），因为它是在对象（Global.asax 继承）上触发的第一个事件。

您将在此处看到更多关于 ASP.NET 应用程序生命周期的信息 - [http://msdn.microsoft.com/en-us/library/ms178473.aspx](http://msdn.microsoft.com/en-us/library/ms178473.aspx)（适用于 IIS 5 和 IIS 6）。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-04-19T08:21:38.833

根据[链接文本](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5771721.html)，您可以访问会话对象的 global.asax 中最早的事件是 global.asax 触发 Session_Start 事件

> **Session__Start**：当新用户访问应用程序网站时触发。
> **Session__End**：当用户的会话超时、结束或离开应用程序网站时触发

# java - Maven 中的代码生成

> ID：765060
> 
> 赞同：13
> 
> 时间：2009-04-19T08:15:01.673
> 
> 标签：java, maven-2, plugins, code-generation

我想从接口自动生成一些java类。我的第一个想法是编写一个代码生成器，并将其集成为一个 maven 插件。

我正在考虑创建一个带有在构建过程中调用的代码生成目标的 Maven 插件。

那么如果我选择这条路线，我该如何为插件提供要处理的接口呢？生成的文件应该去哪里？

是否有任何现有的插件可以配置为生成默认的类实现？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T20:55:59.987

来源应该在 {project.build.directory}/generated-sources/[plugin-id]/

大多数插件采用通过 pom.xml 中的插件配置部分传递的配置。您也可以使用默认值，或者注释和类路径扫描。

像[maven-jspc-plugin](http://mojo.codehaus.org/jspc-maven-plugin/usage.html)这样的插件会生成代码，你可以看看。“Better Builds With Maven”电子书还包含一个相当全面的关于编写插件的章节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T12:44:33.303

也许看看 XDoclet Maven 插件 - XDoclet 通常用于从类中的 doclet 样式标记生成源（例如，从实现中自动生成 MBean 接口），这听起来与您正在做的类似。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-15T07:51:11.837

我已经使用[APT-Jelly](http://apt-jelly.sourceforge.net/)成功地从带注释的 java 生成 java 源代码。你可能想检查一下。

# python - Standard Django way for letting users edit rich content

> ID：765066
> 
> 赞同：3
> 
> 时间：2009-04-19T08:24:27.767
> 
> 标签：python, django, django-models, django-admin

I have a Django website in which I want site administrators to be able to edit rich content. Suppose we're talking about an organizational info page, which might include some pictures, and some links, where the page is not as structured as a news page (which updates with news pieces every few days), but still needs the ability to be easily edited by site admins which do not necessarily want to mess with HTML (or rather, I do not want them to).

So where do I put this dynamic content? On the database? In which format? How do I make it accesible in the django default admin?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T08:28:12.313

**Use one of the existing rich-text editors**

The lightest weight would be to use something at the js level like DojoEditor:

[http://code.djangoproject.com/wiki/AddDojoEditor](http://code.djangoproject.com/wiki/AddDojoEditor)

See also this thread:

[Replace textarea with rich text editor in Django Admin?](https://stackoverflow.com/questions/329963/replace-textarea-with-rich-text-editor-in-django-admin)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T21:22:23.090

For what you're describing I'd use [flatpages](http://docs.djangoproject.com/en/dev/ref/contrib/flatpages/), which is a django app that lets users create and edit pages in the admin panel.

As for formatting, I'd use [TinyMCE](http://tinymce.moxiecode.com/). Integrating it is pretty easy, [here is a walkthrough](http://code.djangoproject.com/wiki/AddWYSIWYGEditor) (do steps 1 and 2 and jump to the bottom, "Using TinyMCE with flatpages (newforms)")

# c# - 使用 PostSharp 1.0 的 ClickOnce 应用程序似乎需要 GAC 中的 1.5 程序集

> ID：765074
> 
> 赞同：0
> 
> 时间：2009-04-19T08:31:31.527
> 
> 标签：c#, clickonce, postsharp

我已经在以前安装过 1.0 的机器上安装了 PostSharp 1.5。现在，我链接到 1.0SP1 程序集的应用程序由于某种原因开始请求 1.5 程序集在客户端**的 GAC中。**有人知道为什么吗？（我在 PostSharp 论坛上问过，但没有收到回复。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T09:11:37.150

好吧，这可能是一个参考问题。

如果您引用的 dll 引用了另一个非特定版本，则该 dll 引用了另一个的特定版本。

您继承了依赖关系。所以在这种情况下。

您的代码 -> Postsharp(v1.0) -> Postsharp.Laos(任何版本并获得 1.0) -> PostSharp.MSBuild.dll (v1.0)

你更新postsharp

您的代码 -> Postsharp(v1.0) -> Postsharp.Laos(任何版本并获得 1.5) -> PostSharp.MSBuild.dll (v1.5)

*注意：以上是一个示例，我不确定 Postsharp 引用的顺序是什么。*

# windows - 奇怪的情况删除和创建目录

> ID：765078
> 
> 赞同：4
> 
> 时间：2009-04-19T08:36:16.990
> 
> 标签：windows

我遇到了一种奇怪的情况，在 Windows Server 2008 上快速连续地删除和创建目录会导致一些偶尔出现的奇怪错误。有时我得到 IOExceptions，有一次我有一个 NotAuthorizedException。

这是我的有效代码，但是在调试器中单步执行时，会引发很多异常。事实上，在执行 directory.delete 时，我刚刚遇到了一个 IOException 和“目录不为空”！

**更新** 相当多的回复谈到了非原子目录创建和延迟写入等。是否有 100% 保证的方式来完成这项工作？理想情况下，我想要一些系统调用“DeleteDirectoryAndWaitForTheDirectoryToBeDeleted”和相应的系统调用“CreateDirectoryAndWaitForTheDirectoryToBeCreated”。

**另一个更新** 我在下面获取了 Neil 的代码并在我的机器上进行了尝试，但它很快就失败了（在 20 次循环之后）。似乎正在发生的事情是 IDriveE 服务有权访问该目录，并且尝试创建该目录失败并出现 DELETE PENDING。我想我需要对 DELETE PENDING 之类的事情进行更多的研究。

就我个人而言，我不喜欢这段代码，因为它“闻起来”是错误的——但它确实有效。

```
Console.WriteLine("CleanAndCreateDirectory: {0}", baseDirectory);
while (Directory.Exists(baseDirectory))
{
    Console.WriteLine("DeleteDirectory: {0}", baseDirectory);
    try
    {
        Directory.Delete(baseDirectory, true);
    }
    catch (Exception ex)
    {
        Console.Error.WriteLine(ex.Message);
        Thread.Sleep(1000);
    }
}

while (!Directory.Exists(baseDirectory))
{
    try
    {
        Directory.CreateDirectory(baseDirectory);
    }
    catch (Exception ex)
    {
        Console.Error.WriteLine(ex.Message);
    }
} 
```

我的怀疑是监视文件系统导致某些操作延迟，但我不知道是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T08:39:11.477

当您从文件系统中删除一个项目时，它不会立即删除它 - 它会将其标记为以后删除（如果目录包含子文件夹/文件，它也会抛出异常）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T09:04:51.727

Windows 还使用称为“延迟写入”的东西。因此，如果您删除一个目录，它不会立即删除，它只是标记为删除。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T09:56:10.963

以下 C++ 代码尽可能快地删除和重新创建目录，在我的旧 Win2K 机器上没有问题。您可能希望在您的机器上尝试它或类似的东西。

```
#include <iostream>
#include <direct.h>
using namespace std;

int main() {
    const char * DIRNAME = "testdir";
    try {
        while(1) {
            if ( rmdir( DIRNAME ) == -1 ) {
                throw "could not remove directory";
            }
            if ( mkdir( DIRNAME ) == -1 ) {
                throw "could not create directory";
            }
        }
    }
    catch( const char * s ) {
        cerr << "Error: " << s << endl;
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T06:17:09.453

使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)捕获删除，然后创建新目录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-19T08:57:04.880

问题是删除目录及其所有内容不是原子操作。因此，如果在删除代码“清除”目录后有其他任何东西将文件添加到目录，则目录的删除可能会失败。

您可能希望对循环进行计数，以便在删除或创建存在真正问题时不会挂起。

# .net - 将 Http 请求的副本转发到另一个系统

> ID：765089
> 
> 赞同：0
> 
> 时间：2009-04-19T08:52:33.580
> 
> 标签：.net, wcf, http, iis

我在生产中部署了 WCF 服务。我正在寻找一种工具来将该服务收到的所有消息的“副本”转发到开发服务器。我需要这个来调试开发框上我的 IDE 中的请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T09:01:43.153

你有 WCF 服务的源代码吗？如果是这样，您是否能够修改它并使用发送到其他地方的通信副本重新部署它？

否则，您可以尝试编写代理来拦截消息，然后将它们转发到现有服务和您的开发箱。

此外，您可能会查看 ethereal 和 fiddler 以查看实际的网络流量。

# c# - 序列化与数据库

> ID：765090
> 
> 赞同：25
> 
> 时间：2009-04-19T08:54:45.713
> 
> 标签：c#, database, serialization

我相信保存应用程序状态的最好方法是保存到传统的关系数据库中，大多数情况下它的表结构几乎代表了我们系统的数据模型 + 元数据。

然而，我团队中的其他人认为，今天最好将整个对象图简单地序列化为二进制或 XML 文件。
无需说（但我仍然会说）第三次世界大战正在我们之间进行，我想听听您对这个问题的看法。

我个人讨厌序列化，因为：

1.  保存的数据仅适用于您的开发平台（在我的情况下为 C#）。没有其他平台（如 Java 或 C++）可以使用这些数据。
2.  保存了整个对象图（包括所有继承链），而不仅仅是我们需要的数据。
3.  尝试加载旧状态时，更改数据模型可能会导致严重的向后兼容性问题。
4.  在应用程序之间共享部分数据是有问题的。

我想听听你对此的看法。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-19T17:26:54.903

你没有说它是什么类型的数据——很大程度上取决于你的性能、同时性、安装、安全性和可用性/集中化要求。

*   如果此数据非常大（例如，所讨论对象的许多实例），数据库可以通过其索引功能来帮助提高性能。否则它可能会损害性能，或者无法区分。

*   如果您的应用程序由多个用户同时运行，并且他们可能想要写入此数据，那么数据库会有所帮助，因为您可以依靠事务来确保数据完整性。使用基于文件的持久性，您必须自己处理。如果数据是单用户或单实例，那么数据库很可能是矫枉过正。

*   如果您的应用程序有自己的简单安装，使用数据库会给用户带来额外的负担，用户必须设置和维护（应用补丁等）数据库服务器。如果可以保证数据库可用并且由其他人处理，那么这不是问题。

*   数据的安全要求是什么？如果数据是集中的，有多个用户（同时或顺序），您可能需要管理数据的安全性和权限。如果没有看到数据，很难说使用基于文件的持久性还是使用数据库更容易管理。

*   如果数据是仅限本地的，那么上述关于数据的许多问题都有指向基于文件的持久性的答案。如果您需要集中访问，答案通常指向数据库。

我的猜测是，您可能不需要数据库，仅基于您主要从编程方便的角度而不是数据需求的角度询问它的事实。序列化，特别是在 .NET 中，是高度可定制的，并且可以很容易地定制为只保留您需要的基本部分。对这些数据进行版本控制也有[众所周知的最佳实践](http://msdn.microsoft.com/en-us/library/ms229752(VS.80).aspx)，所以我不确定从这个角度来看数据库方面是否有优势。

关于跨平台问题：如果您*不确定*将来是否需要跨平台功能，请不要立即构建它。在时机成熟时（迁移等）总体上解决该问题几乎肯定比现在限制您的开发更容易。通常情况下，[YAGNI](http://en.wikipedia.org/wiki/You_Ain't_Gonna_Need_It)。

关于在应用程序的各个部分之间共享数据：应该将其构建到应用程序本身中，例如访问数据的类中。不要重载持久性机制，使其成为应用程序各部分之间的数据管道；如果以这种方式重载它，则将持久状态转换为跨对象契约，而不是正确地将其视为对象私有状态的扩展。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-19T09:19:40.597

当然，这取决于您要序列化的内容。在某些情况下，序列化非常容易。

（我曾经用 Java 编写过一种时间线程序，您可以在其中绘制并拖动对象并调整对象大小。如果您准备好了，您可以将其保存在文件中（例如 myTimeline.til）。在那个 momenet 上保存了数百个对象，它们的它们在画布上的位置、它们的大小、它们的颜色、它们的内部文本、它们的特殊效果……

你当然可以打开 myTimeLine.til 并进一步工作。

这一切只问了**几行代码**。（只是让所有类及其依赖项都可序列化）而且我的编码时间不到 5 分钟，我自己都惊呆了！（这是我第一次使用序列化）

在时间轴上工作，您还可以为不同的版本“另存为”，以及非常容易备份和邮寄的“til”文件。

我认为在我的特殊情况下使用数据库会有点白痴。但这当然仅适用于类似文档的结构，例如 Word 等。）

我的观点首先是：**在某些情况下，数据库肯定不是最佳解决方案。** 序列化不是开发人员发明的，只是因为他们很无聊。

1.  如果您使用 XMLserialization 或 SOAP，则不正确
2.  不再相关
3.  仅当您不小心时，才会有大量“最佳实践”。
4.  仅当您希望它有问题时，请参见 1

当然，序列化除了实现速度之外还有其他重要的优势，比如在某些情况下根本不需要数据库！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-19T09:08:27.257

有关XML 的适用性与数据库管理系统的适用性的评论，请参阅[此 Stackoverflow 帖子。](https://stackoverflow.com/questions/201568/when-would-i-use-xml-instead-of-sql/201594#201594)它讨论的问题与您团队中的辩论主题非常相似。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-19T09:09:40.263

你有一些好的观点。我非常同意你的观点，但我会扮演魔鬼的拥护者。

1.  好吧，如果需要，您总是可以在 C# 中编写一个转换器来稍后提取数据。

2.  这是一个弱点，因为磁盘空间很便宜，而且我们将使用的额外字节数量的成本远远低于我们试图让这一切按您的方式工作所浪费的时间。

3.  这就是世界的方式。烧毁桥梁并需要升级。转换数据，或者做一个工具来做，然后不再支持旧版本的做的方式。

4.  如果 C# 程序将数据交给其他应用程序，则不会。其他应用程序不应该直接访问属于该应用程序的数据，不是吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-19T09:16:41.667

对于传输和离线存储，序列化是可以的；但对于积极使用，某种数据库是更可取的。

通常（如您所说），如果没有数据库，您需要反序列化整个流以执行任何查询，这使其难以扩展。添加线程等的固有问题，你要求痛苦。

你关于序列化的其他一些痛点并不都是正确的——只要你明智地选择。显然，对于[可移植性和版本控制](http://marcgravell.blogspot.com/2009/03/obfuscation-serialization-and.html)`BinaryFormatter`来说，这是一个糟糕的选择，但是“[协议缓冲区](http://code.google.com/p/protobuf/)”（Google 的序列化格式）有 Java、C++、[C#](http://code.google.com/p/protobuf-net/)和[许多其他](http://code.google.com/p/protobuf/wiki/OtherLanguages)版本，并且被设计为版本兼容。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-19T17:41:02.517

只需确保您有一个组件可以处理保存/加载状态，并为您的应用程序的其余部分提供一个干净的接口。然后，您为持久性所做的任何选择都可以在以后轻松地重新访问。

将对象图序列化为文件可能是一个很好的快速而肮脏的初始解决方案，并且可以非常快速地实现。

但是，如果您开始遇到使数据库成为更好选择的问题，您可以插入一个新版本，而对应用程序的其余部分几乎没有影响。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-18T15:00:27.910

是的，可能是真的。缺点是您必须检索整个对象，这就像从表中检索所有行一样。如果它很大，那将是一个缺点。但如果它不是那么大，而且我的爱好项目也不是那么大，那么也许它们应该是完美的匹配？

# c# - 如何在 C# 中获取消息？

> ID：765092
> 
> 赞同：0
> 
> 时间：2009-04-19T08:55:54.867
> 
> 标签：c#, winforms, winsock, message

如何获取有关特定方法的特定消息？

我看过一些例子，人们使用“ref”，但我不明白。

例如，在 delphi 中，我的函数（方法）必须在 Main Form 类中声明，并且在声明旁边我必须放置消息

```
type
  TForm1 = class(TForm)
    ...
  protected
    procedure MessageHandler(var Msg:Tmessage);Message WM_WINSOCK_ASYNC_MSG;
end; 
```

我在 C# 中需要这个，所以我可以在我的应用程序中使用 WSAAsyncSelect

用赏金 550 声望检查[>我的其他问题<](https://stackoverflow.com/questions/686355/how-to-invoke-and-use-wsaasyncselect-in-c)以了解我的意思

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-19T09:06:20.317

您可以覆盖控件（例如窗体）上的[WndProc方法。](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.wndproc(vs.71).aspx)

WndProc 引用一个消息对象。C# 中的 ref 参数类似于 Delphi 中的 var 参数。消息对象有一个包含消息类型的 Msg 属性，例如（来自 MSDN）：

```
protected override void WndProc(ref Message m) 
{
    // Listen for operating system messages.
    switch (m.Msg)
    {
        // The WM_ACTIVATEAPP message occurs when the application
        // becomes the active application or becomes inactive.
        case WM_ACTIVATEAPP:

            // The WParam value identifies what is occurring.
            appActive = (((int)m.WParam != 0));

            // Invalidate to get new text painted.
            this.Invalidate();

            break;                
    }        
    base.WndProc(ref m);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-19T09:10:41.417

在 .NET winforms 中，所有消息都转到`WndProc`，因此您可以覆盖它：

```
 protected override void WndProc(ref Message m)
    {
        if (m.Msg == WM_WINSOCK_ASYNC_MSG)
        {
            // invoke your method
        }
        else
        {
            base.WndProc(ref m);
        }
    } 
```

如果我误解了，请说 - 但我认为你最好避免这种低级方法，并描述你想要*实现*的目标- 即它可能`.Invoke`/`.BeginInvoke`更合适。

# http - 在 Jmeter 中同时运行的合理的最高线程数是多少？

> ID：765101
> 
> 赞同：37
> 
> 时间：2009-04-19T09:07:54.993
> 
> 标签：http, web-applications, load-testing, jmeter

我想使用尽可能多的线程（以使用更少的计算机），但又不会使瓶颈出现在客户端中。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-08-12T12:38:25.580

JMeter 可以模拟非常高的负载，只要您正确使用它。

不要听**Urban Legends**说 JMeter 无法处理高负载。

现在至于答案，这取决于：

*   你的机器功率

*   你的 jvm 32 位或 64 位

*   你的jvm分配的内存-Xmx

*   您的测试计划（大量 beanshell、后处理器、xpath ......意味着大量 cpu）

*   您的操作系统配置（可调）

*   Gui/非gui模式

所以没有理论上的答案，但遵循[最佳实践](http://jmeter.apache.org/usermanual/best-practices.html)将确保 JMeter 表现良好。

请注意，使用 jmeter，您可以通过远程测试分配负载，请阅读：

*   [远程测试 > 15.4 使用不同的样本发送器](http://jmeter.apache.org/usermanual/remote-test.html)

如果还不够，最后使用基于云的测试。

阅读此调整提示：

*   [http://www.ubik-ingenierie.com/blog/jmeter_performance_tuning_tips/](http://www.ubik-ingenierie.com/blog/jmeter_performance_tuning_tips/)

阅读[本书](https://leanpub.com/master-jmeter-from-load-test-to-devops)以进行负载测试和正确使用 JMeter。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-19T10:03:30.383

[JMeter Wiki](http://wiki.apache.org/jakarta-jmeter/HowManyThreads)报告了将 JMeter 用于多达 1000 个线程的案例。我最多使用了 100 个线程，但 Wiki 中的链接建议我从未尝试过减少资源。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-19T09:27:55.040

我已经使用过 JMeter，发现它在产生非常高的负载方面并不是很好。在具有 2Gb 内存的 2Ghz Core2 Duo 上，您可以合理地预期大约 100 个线程。

话虽如此，最好在您的硬件上运行它，这样 PC 的 CPU 不会达到 100% 的峰值 - 最好是稳定的 80%-90%，否则结果会受到影响。

我也尝试过[WAPT 5](http://www.loadtestingtool.com/?gclid=CIOs8a7Q_JkCFYItpAodtTPRFA) - 它成功地从同一台 PC 运行了 1000 多个线程。它不是免费的，但它比 JMeter 更有用，但不具备所有功能。

> 至少从 2.6 版开始的过时答案，请参阅[https://stackoverflow.com/a/11922239/460802](https://stackoverflow.com/a/11922239/460802)以获取更新的答案。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-01-11T15:30:29.657

我们在 Windows XP 上运行 JMeter 时遇到的问题之一是 Windows XP TCP 连接限制。应该删除限制以便运行使用 JMeter 来充分发挥工作站的潜力 更多信息[在这里](http://www.mydigitallife.info/2005/11/15/windows-xp-sp2-tcp-connection-limit-event-id-4226/)。AFAIK，不适用于其他操作系统。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-08-15T10:03:57.380

我从 2004 年开始使用 JMeter，并启动了很多负载测试。

使用 PC Windows 7 64 位 4Go RAM iCore5。

我认为 JMeter 可以支持 300 到**400 个**并发线程用于 Http (Sampler) 协议，只有一个“聚合报告侦听器”在日志文件结果中写入调用页面之间的计时器和**计时器。**

对于大型负载测试，您可以像这样 [http://jmeter-plugins.org/wiki/HttpSimpleTableServer/使用从属设备（负载生成器）配置 JMeter](http://jmeter-plugins.org/wiki/HttpSimpleTableServer/)

我已经用 11 个 PC 从机进行了测试，以模拟 5000 个线程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-19T09:19:19.727

我没有使用过 JMeter，但答案可能取决于您的硬件。最好的办法可能是建立性能指标，猜测线程数，然后运行二进制搜索，如下所示。

来源是维基百科。

猜数字游戏...

这个相当简单的游戏的开头类似于“我正在考虑一个介于 40 和 60 之间的整数，根据你的猜测，我会回答‘高’、‘低’或‘是的！’ 可能是这样。” 假设 N 是可能值的数量（这里，21 表示“包括”），那么最多需要问题来确定数量，因为每个问题都会使搜索空间减半。请注意，与一般算法相比，需要少一个问题（迭代），因为该数字已被限制在特定范围内。

即使我们猜测的数字可以任意大，在这种情况下没有上限 N，我们仍然可以通过首先找到一个上限，在最多步骤中找到该数字（其中 k 是（未知）选定的数字）通过反复加倍。例如，如果数字是 11，我们可以使用以下猜测序列来找到它：1、2、4、8、16、12、10、11

还可以扩展该技术以包括负数；例如，可以使用以下猜测来找到 -13：0、-1、-2、-4、-8、-16、-12、-14、-13

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-23T09:34:33.210

它更依赖于您在特定服务器上进行的性能测试（负载、峰值、耐久性等）（有点依赖于硬件）

请牢记这些参数 - 您针对运行 jmeter 的客户端计算机，将分配一定数量的堆内存，确保分配健康，以便脚本不会出错。我在 jmeter 上运行的最高值是本地环境（客户端 - 服务器架构）上的 1500，在 Web 架构上，我运行的最高值是基于非功能性要求限制为 250 个线程，

所以理想情况下，它取决于性能测试的种类和部署风格等等。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-06T06:51:35.443

对此没有标准编号。您可以从一台计算机生成的最大线程数完全取决于计算机的硬件和操作系统。默认情况下，操作系统会占用一定数量的 CPU 和 RAM。

要找出您的计算机可以处理的最大线程数，您可以准备一个示例测试并仅使用几个线程运行它。然后随着每个测试运行周期逐渐增加线程数。在此期间，您还需要监控计算机的 CPU、RAM、磁盘 I/O 和网络 I/O。当其中任何一个达到接近或超过 80% 时（再次由您决定接近是否适合您或更高），这就是您的计算机可以处理的最大线程数。为了更安全，我会在资源利用率达到 70% 时停止。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-26T18:11:53.697

这取决于您运行的硬件以及底层脚本。我一直觉得这种模糊性是传统负载测试工具最大的问题。如果您的预算很少（200 美元左右可以让您进行大量测试），请查看我公司的[负载测试服务](http://browsermob.com)BrowserMob。

除了我们的真实浏览器用户 (RBU) 控制数千个实际浏览器以进行性能和负载测试之外，我们还有传统的虚拟用户 (VU)。脚本是用 JavaScript 编写的，可以进行各种 HTTP 调用。

我提出这个问题的原因是，我一直觉得试图找出负载生成硬件上可以安装多少 VU 的游戏是危险的。在没有意识到的情况下很容易得到不好的结果。

为了解决 BrowserMob 的问题，我们对每个 CPU 核心的 VU 和 RBU 数量采取了一种极其保守的方法：每个 CPU 核心不超过 1 个浏览器或 50 个线程，有时甚至更少。在云计算的世界里，CPU 周期是如此的便宜，以至于试图让机器过载是没有意义的。

# cocoa - 如何在 Cocoa 中使用图像作为文本字段的背景？

> ID：765104
> 
> 赞同：3
> 
> 时间：2009-04-19T09:10:14.117
> 
> 标签：cocoa, image, background-image

是否可以将图像用作 Cocoa 中文本字段的背景？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T20:40:25.640

我不知道这是否是“正确”的方法，但首先想到的是创建一个 NSTextField 的自定义子类，它可能大致如下所示：

```
- (void)awakeFromNib
{
    [self setDrawsBackground:NO];
}

- (void)drawRect:(NSRect)rect
{
    [super drawRect:rect];

    [self lockFocus];
    [[NSImage imageNamed:@"<#image filename#>"] drawInRect:rect
        fromRect:rect
        operation:NSCompositeSourceOver
        fraction:1.0];
    [self unlockFocus];
} 
```

同样，这只是基本部分的粗略轮廓。

无论如何，就像我说的那样，我不确定这是否真的是“正确”的方式（或者是否有“正确”的方式，就此而言），但这将为您的 NSTextField 提供背景图像.

*编辑以回应约书亚的评论（我不会在那个小小的评论框中有足够的空间）：*

要将图像添加到您的项目中，您可以将其从任何位置拖到项目窗口中（项目窗口中间的文件主列表，尽管取决于您设置 Xcode 编辑环境的方式，这对你来说可能不同）。

为了子类`NSTextField`化，你会想要创建一个新的 Objective-C 类文件（File -> New File…），但是编辑头文件，以便类继承自`NSTextField`而不是`NSObject`. 换句话说，您的头文件可能如下所示：

```
#import <Cocoa/Cocoa.h>

@interface BGImageTextField : NSTextField
{
}

@end 
```

至于其余的代码，您可能希望将其添加到实现文件的主体中（`BGImageTextField.m`例如），特别是在`@implementation`and`@end`关键字之间。

我还想提两点。首先，我建议阅读 Aaron Hillegass 撰写的*Cocoa Programming for Mac OS X*的副本——它涵盖了我刚刚学习过的大部分 Cocoa 基础知识，并且是一般学习 Cocoa 的最佳方法之一。其次，虽然我的方法有效，但它可能不是最好的方法——尤其是因为我最近才发现[这篇文章](https://stackoverflow.com/questions/606319/subclassing-a-nstextfield/607979#607979)，这似乎暗示了一种更好的扩展 NSTextField 的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T18:19:22.773

而不是继承 NSTextField，只需使背景颜色透明 [NSColor clearColor] 并将图像放在它后面。

# c# - 如何显示用 Emgu 拍摄的网络摄像头图像？

> ID：765107
> 
> 赞同：10
> 
> 时间：2009-04-19T09:13:19.287
> 
> 标签：c#, wpf, image, webcam

我目前正在做一个使用面部识别的项目。因此，我需要一种向用户显示网络摄像头图像的方法，以便他可以调整自己的脸。

我一直在尝试使用尽可能少的 CPU 从网络摄像头获取图像：

*   [视频渲染器元素](http://www.codeplex.com/VideoRendererElement)
*   [WPFMediaKit](http://www.codeplex.com/WPFMediaKit)
*   [DirectShow-Lib](http://directshownet.sourceforge.net/)

但是它们都不是很好......要么太慢要么太消耗 CPU 资源。

然后我尝试了[Emgu 库](http://www.emgu.com/wiki/index.php/Main_Page)，感觉很棒。起初，我在一个 Windows 窗体项目中进行了尝试，并正在更新*Picture Box*中的图像。但是，当我尝试将它集成到我的 WPF 项目中时，我陷入了如何将图像传递给图像控件的问题。

现在，我有以下源代码：

```
<Window x:Class="HA.FacialRecognition.Enroll.Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Window1" Width="800" Height="600"
        Loaded="Window_Loaded" Closing="Window_Closing">
    <Grid>
        <Image x:Name="webcam" Width="640" Height="480" >
            <Image.Clip>
                <EllipseGeometry  RadiusX="240" RadiusY="240">
                    <EllipseGeometry.Center>
                        <Point X="320" Y="240" />
                    </EllipseGeometry.Center>
                </EllipseGeometry>
            </Image.Clip>
        </Image>
    </Grid>
</Window> 
```

以及背后的代码：

```
private Capture capture;
private System.Timers.Timer timer;

public Window1()
{
    InitializeComponent();
}

private void Window_Loaded(object sender, RoutedEventArgs e)
{
    capture = new Capture();
    capture.FlipHorizontal = true;

    timer = new System.Timers.Timer();
    timer.Interval = 15;
    timer.Elapsed += new ElapsedEventHandler(timer_Elapsed);
    timer.Start();
}

void timer_Elapsed(object sender, ElapsedEventArgs e)
{
    using (Image<Bgr, byte> frame = capture.QueryFrame())
    {
        if (frame != null)
        {
            var bmp = frame.Bitmap;
            // How do I pass this bitmap to my Image control called "webcam"?
        }
    }
}

private void Window_Closing(object sender, CancelEventArgs e)
{
    if (capture != null)
    {
        capture.Dispose();
    }
} 
```

我的猜测是使用 BitmapSource/WriteableBitmap 但我没有让它们工作......

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T23:05:58.283

查看 Emgu wiki -> 教程 -> 示例 -> WPF (Windows Presentation Foundation) 它包含以下代码片段，用于将您的 IImage 转换为 BitmapSource，您可以直接将其应用于您的控件。

使用 Emgu.CV；使用 System.Runtime.InteropServices；...

```
 /// <summary>
    /// Delete a GDI object
    /// </summary>
    /// <param name="o">The poniter to the GDI object to be deleted</param>
    /// <returns></returns>
    [DllImport("gdi32")]
    private static extern int DeleteObject(IntPtr o);

    /// <summary>
    /// Convert an IImage to a WPF BitmapSource. The result can be used in the Set Property of Image.Source
    /// </summary>
    /// <param name="image">The Emgu CV Image</param>
    /// <returns>The equivalent BitmapSource</returns>
    public static BitmapSource ToBitmapSource(IImage image)
    {
        using (System.Drawing.Bitmap source = image.Bitmap)
        {
            IntPtr ptr = source.GetHbitmap(); //obtain the Hbitmap

            BitmapSource bs = System.Windows.Interop.Imaging.CreateBitmapSourceFromHBitmap(
                ptr,
                IntPtr.Zero,
                Int32Rect.Empty,
                System.Windows.Media.Imaging.BitmapSizeOptions.FromEmptyOptions());

            DeleteObject(ptr); //release the HBitmap
            return bs;
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T09:26:43.203

Image Class 有一个你可能正在寻找的 UriSource 属性

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-03T11:47:30.353

我想你正在寻找的只是这个：

```
Image<Bgr, Byte> frame = capture.QueryFrame();
pictureBox1.Image = image.ToBitmap(pictureBox1.Width, pictureBox1.Height); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-07-29T08:18:10.770

如果您使用的是 WPF 和 MVVM，这里是使用[EMGU](http://www.emgu.com/wiki/index.php/Main_Page)的方法。

看法：

```
<Window x:Class="HA.FacialRecognition.Enroll.Views.PhotoCaptureView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Width="800" Height="600">
<Grid>
    <Image Width="640" Height="480" Source="{Binding CurrentFrame}">
        <Image.Clip>
            <EllipseGeometry  RadiusX="240" RadiusY="240">
                <EllipseGeometry.Center>
                    <Point X="320" Y="240" />
                </EllipseGeometry.Center>
            </EllipseGeometry>
        </Image.Clip>
    </Image>
</Grid> 
```

视图模型：

```
namespace HA.FacialRecognition.Enroll.ViewModels
{
public class PhotoCaptureViewModel : INotifyPropertyChanged
{
    public PhotoCaptureViewModel()
    {
        StartVideo();
    }

    private DispatcherTimer Timer { get; set; }

    private Capture Capture { get; set; }

    private BitmapSource _currentFrame;
    public BitmapSource CurrentFrame
    {
        get { return _currentFrame; }
        set
        {
            if (_currentFrame != value)
            {
                _currentFrame = value;
                OnPropertyChanged();
            }
        }
    }

    private void StartVideo()
    {
        Capture = new Capture();
        Timer = new DispatcherTimer();
        //framerate of 10fps
        Timer.Interval = TimeSpan.FromMilliseconds(100);
        Timer.Tick += new EventHandler(async (object s, EventArgs a) =>
        {
            //draw the image obtained from camera
            using (Image<Bgr, byte> frame = Capture.QueryFrame())
            {
                if (frame != null)
                {
                    CurrentFrame = ToBitmapSource(frame);
                }
            }
        });
        Timer.Start();
    }

    public static BitmapSource ToBitmapSource(IImage image)
    {
        using (System.Drawing.Bitmap source = image.Bitmap)
        {
            IntPtr ptr = source.GetHbitmap(); //obtain the Hbitmap
            BitmapSource bs = System.Windows.Interop.Imaging.CreateBitmapSourceFromHBitmap(ptr, IntPtr.Zero, Int32Rect.Empty, BitmapSizeOptions.FromEmptyOptions());
            DeleteObject(ptr); //release the HBitmap
            return bs;
        }
    }

    /// <summary>
    /// Delete a GDI object
    /// </summary>
    [DllImport("gdi32")]
    private static extern int DeleteObject(IntPtr o);

    //implementation of INotifyPropertyChanged, viewmodel disposal etc

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T20:09:10.647

我相信你必须使用互操作（[source](http://dedjo.blogspot.com/2007/05/how-to-use-systemdrawingbitmap-hbitmap.html)）：

```
using System.Windows.Interop;
using System.Windows.Media.Imaging;

public static ImageSource AsImageSource<TColor, TDepth>(
    this Image<TColor, TDepth> image) where TColor : IColor, new()
{
    return Imaging.CreateBitmapSourceFromHBitmap(image.Bitmap.GetHbitmap(),
                       IntPtr.Zero, Int32Rect.Empty,
                       BitmapSizeOptions.FromEmptyOptions());
} 
```

可以这样使用：

```
void timer_Elapsed(object sender, ElapsedEventArgs e)
{
        using (Image<Bgr, byte> frame = capture.QueryFrame())
        {
                if (frame != null)
                {
                        var bmp = frame.AsImageSource();
                }
        }
} 
```

如果互操作性能不够好，请查看源代码`Image.ToBitmap`并`Image.get_Bitmap`了解如何实现自己的`WriteableBitmap`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T10:36:59.760

[http://blogs.microsoft.co.il/blogs/tamir/archive/2008/04/23/webcam-control-with-wpf-or-how-to-create-high-framerate-player-with-directshow-通过使用-interopbitmap-in-wpf-application.aspx](http://blogs.microsoft.co.il/blogs/tamir/archive/2008/04/23/webcam-control-with-wpf-or-how-to-create-high-framerate-player-with-directshow-by-using-interopbitmap-in-wpf-application.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-25T12:15:15.483

尝试这个。

[http://easywebcam.codeplex.com/](http://easywebcam.codeplex.com/)

我用过，非常好。。

# c# - 从实体自动生成 DBML？

> ID：765108
> 
> 赞同：2
> 
> 时间：2009-04-19T09:15:30.717
> 
> 标签：c#, linq-to-sql

有没有办法从实体类而不是从数据库表生成 DBML 文件？这对于原型设计非常有用，其中只需创建一个逻辑模型并让自动生成的工具创建 DBML 文件。使用 DBML 文件，可以使用 SqlMetal 生成 Linq to SQL 类并完成它。因此，要快速制作原型，您可以：

1.定义模型

```
public class Person
{
    public string Name { get; set; }
    public int Age { get; set; }
    // etc
} 
```

2.运行工具（选择实体）

3.获取自动生成的DBML文件

4.运行[SqlMetal 工具](http://msdn.microsoft.com/en-us/library/bb386987.aspx)或[Damiens t4 脚本](http://damieng.com/blog/2009/01/19/linq-to-sql-templates-updated-now-on-codeplex)来创建 Linq to SQL 类

5.针对自动生成的数据上下文和自动生成的数据库进行编码（例如，使用 DataContext.CreateDatabase() 创建初始数据库）。某种数据库迁移会更好。

或者我想从对象而不是从数据库中的对象生成数据库是不是很奇怪？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T09:22:20.840

不存在。目前，为 Linq to SQL 生成 DBML 的唯一方法是从 sql 数据库源。

这可能有一天会存在于实体框架中，但目前也不存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T09:36:15.037

我实际上以稍微不同的方式来做：

1.  定义我的数据结构的**XML模型**
2.  使用 XSLT 生成用于创建、读取、更新插入等的存储过程。
3.  使用存储过程创建数据库
4.  以典型方式使用 Linq→SQL，导入存储过程（我不导入模型，因为 Linq→SQL 不知道如何使用 groovy '2008 功能）
5.  使用模型

# c# - 没有项目时更改我的中继器数据源

> ID：765112
> 
> 赞同：0
> 
> 时间：2009-04-19T09:17:03.333
> 
> 标签：c#, asp.net, vb.net, repeater

当没有图像时，我想在我的中继器中放置带有文本“NO IMAGE”的图像。为了实现这一目标，我必须做出哪些改变？我希望我的中继器数据源指向我根目录中的 IMAGE 文件夹中的图像。

我的页面加载

```
If Not IsPostBack Then

                Dim sBasePath As String = System.Web.HttpContext.Current.Request.ServerVariables("APPL_PHYSICAL_PATH")
                If sBasePath.EndsWith("\") Then
                    sBasePath = sBasePath.Substring(0, sBasePath.Length - 1)
                End If

                sBasePath = sBasePath & "\" & "pics" & "\" & lblID.Text

                Dim oList As New System.Collections.Generic.List(Of String)()

                For Each s As String In System.IO.Directory.GetFiles(sBasePath, "*_logo.*")

                    'We could do some filtering for example only adding .jpg or something 
                    oList.Add(System.IO.Path.GetFileName(s))

                Next

                If oList.Count = 0 Then

                  //I must do something here

                    repImages.DataSource = ??????
                    repImages.DataBind()

                Else

                    repImages.DataSource = oList
                    repImages.DataBind()

                End If

            End If 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T09:30:18.607

如果没有图像，您可以只加载带有文本“No Images”的图像并将其添加到您的 oList 并将其分配给 repImages.DataSource

```
If Not IsPostBack Then

            Dim sBasePath As String = System.Web.HttpContext.Current.Request.ServerVariables("APPL_PHYSICAL_PATH")
            If sBasePath.EndsWith("\") Then
                sBasePath = sBasePath.Substring(0, sBasePath.Length - 1)
            End If

            sBasePath = sBasePath & "\" & "pics" & "\" & lblID.Text

            Dim oList As New System.Collections.Generic.List(Of String)()

            For Each s As String In System.IO.Directory.GetFiles(sBasePath, "*_logo.*")

                'We could do some filtering for example only adding .jpg or something 
                oList.Add(System.IO.Path.GetFileName(s))

            Next

            If oList.Count = 0 Then

              oList.Add("Path to a image with no image text")

            End If

   repImages.DataSource = oList
                repImages.DataBind()

        End If 
```

# python - Python 多处理是如何在 Windows 上实现的？

> ID：765129
> 
> 赞同：13
> 
> 时间：2009-04-19T09:32:46.697
> 
> 标签：python, multithreading, fork

鉴于没有 Windows fork() 调用，Python 2.6 中的多处理包是如何在 Windows 下实现的？在 Win32 线程之上或某种假分叉之上，或者只是在现有多线程之上的兼容性？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-19T10:41:44.520

It's done using a subprocess call to sys.executable (i.e. start a new Python process) followed by serializing all of the globals, and sending those over the pipe. A poor man's cloning of the current process. This is the cause of the [extra restrictions](http://docs.python.org/library/multiprocessing.html#windows) found when using multiprocessing on Windows plaform.

You may also be interested in viewing [Jesse Noller's talk from PyCon](http://pycon.blip.tv/file/1947354/) about multiprocessing where he discusses its use.

# web-services - DLL 中的 Web 服务引用

> ID：765130
> 
> 赞同：0
> 
> 时间：2009-04-19T09:33:04.093
> 
> 标签：web-services, configuration

希望有人可以帮助我真正萌芽的东西。

我有一个智能客户端、几个 Web 服务和一些 DLL。dll 本质上是表单和控件。dll 引用自身内部的 Web 服务。

我遇到的问题是如何动态更改对 DLL 中的 Web 服务的引用，就像我将它们驻留在 web.config 文件中一样。

我可以将 Web 服务引用行为设置为动态并更改 Web 配置文件中的引用并使用新位置。我如何对 DLL 应用相同的内容，因为 tehy 是二进制的，并且 windows app.config 没有参考实际的 Web 服务。

希望这很清楚。我真的很沮丧，并希望得到任何建议。

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T09:39:44.577

The DLLs will use the app.config file of their host application. For example if your smart client is called MySmartClient, then you could use MySmartClient.exe.config the same way you would use web.config to define web service urls.

# sql - SQL 触发器问题：为什么这是一个语法错误？

> ID：765137
> 
> 赞同：0
> 
> 时间：2009-04-19T09:39:03.780
> 
> 标签：sql, database, sybase, triggers

我想为 Sybase 创建一个触发器，但它显示一个错误。

我要做的是，当对`[student]`表进行删除操作时，检查 [account] 上是否有与学生相关的记录，如果有，则引发异常。

Sybase 似乎缺乏支持。他们的官员似乎没有人来参观。

```
*CREATE TRIGGER AccountChecker
BEFORE DELETE ON student
REFERENCING OLD AS old_student
FOR EACH ROW 
BEGIN
DECLARE @acc CHAR(4);
DECLARE @acc_not_null EXCEPTION FOR SQLSTATE '99999';

SELECT @acc=account.account_number FROM account
WHERE account.student_id = old_student.student_id;

   IF @acc IS NOT NULL
   BEGIN
    SIGNAL acc_not_null
   END

END* 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T13:43:45.580

Sybase 支持外键和主键，既可以通过过程，`sp_primarykey`也`sp_foreignkey`可以通过声明性 SQL 约束。您正在寻求做的正是来自 [account] 引用 [student] 的外键应该做的事情。

Sybase SQL 用户指南（Adaptive Server 15，如果重要的话）说明了一个“删除受限”触发器（缩进略有不同）：

```
create trigger deltitle
    on titles
    for delete
    as
       if (select count(*)
               from deleted, salesdetail
               where salesdetail.title_id =
               deleted.title_id) > 0
       begin
           rollback transaction
           print "You cannot delete a title with sales."
       end 
```

我不相信回滚是个好主意。例外可能更好。

您尝试使用的表示法比记录在案的 Sybase 支持的表示法更接近 SQL 标准。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T13:00:42.050

Sybase 不支持外键吗？

# debugging - 您必须修复的最模糊的代码是什么？

> ID：765140
> 
> 赞同：2
> 
> 时间：2009-04-19T09:40:05.090
> 
> 标签：debugging, obfuscation

大多数程序员都有调试/修复别人代码的经验。有时，“别人的代码”是如此的模糊，以至于试图理解它在做什么已经够糟糕的了。

您必须调试/修复的最糟糕（最模糊）的代码是什么？

如果你没有把它扔掉并从头开始重新编码，那你为什么不呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-19T09:55:13.493

PHP OSCommerce 足以说，它是混淆代码......

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-19T11:40:07.530

*   一个Java类
*   仅操作 DOM 的静态方法
*   8000 个 LOC
*   在“错误”时返回 null 的长链方法：ab().c().d().e()
*   非常长的方法（每个方法 400/500 LOC）
*   嵌套 if，while，如：

    ```
    if (...) {
      for (...) {
        if (...) {
          if (...) {
            while (...) {
              if (...) { 
    ```

*   面向剪切和粘贴的编程

*   没有异常，所有异常都被捕获并使用 printStackTrace() “处理”
*   没有单元测试
*   没有文件

我很想扔掉并重新编码......但是，经过 3 天的艰苦调试，我已经添加**了魔法如果**:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T09:52:46.680

意大利面条代码 PHP CMS 系统。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-19T11:56:54.557

默认情况下，程序员认为别人的代码被混淆了。

我可能不得不做的更糟糕的事情是用一个简单的方法解释变量 i1、i2 j、k、t 是什么，它们不是“for”循环中的计数器。

在所有其他情况下，我猜问题区域很困难，这使得代码看起来很困难。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-06-08T09:30:54.997

我今天在我们的代码库中发现了这行代码，并认为这是偷偷摸摸混淆的一个很好的例子：

```
if (MULTICLICK_ENABLED.equals(propService.getProperty(PropertyNames.MULTICLICK_ENABLED))) {} else {
    return false;
} 
```

只要确保我阅读了整行。没有略读。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-19T10:00:52.123

在处理 GWT 项目时，我会接触到不属于我的 GWT 编译的混淆 JS 代码的一部分。

*现在祝你调试真正的*混淆代码好运。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-07T16:25:00.653

我不记得完整的代码，但它的一部分仍然留在我的记忆中，因为我花了几个小时试图理解：

```
do{
  $tmp = shift unless shift;
  $tmp;
}while($tmp); 
```

起初我无法理解它，它看起来很没用，然后我打印出@_ 用于参数列表，一系列交替的布尔和函数名称，该代码与一个库检测模块结合使用，如果它改变了行为一个函数被破坏了，但是代码的文档记录很糟糕，而且如果没有完全理解完整的代码就没有任何意义，我放弃并重写了整个代码。

* * *

来自 DVK 的更新：

而且，以免有人声称这是因为 Perl 是不可读的，而不是编码器是高尔夫大师而不是优秀的软件开发人员，这里是相同的代码，其混淆形式稍微少一些（真正正确的代码甚至没有交替的子名称和布尔值首先:)

```
# This subroutine take a list of alternating true/false flags
# and subroutine names; and executes the named subroutines for which flag is true.
# I am also weird, otherwise I'd have simply have passed list of subroutines to execute :)
my @flags_and_sub_names_list = @_;
while ( @flags_and_sub_names_list ) {
    my $flag     = shift @flags_and_sub_names_list; 
    my $subName  = shift @flags_and_sub_names_list;
    next unless $flag && $subName;
    &{ $subName }; # Call the named subroutine
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-19T09:53:32.780

我有一个 300 行函数执行输入清理的案例，它错过了某个角落案例。它使用 IndexOf 和 Substring 以及许多内联变量和常量手动解析某些情况（看起来原始编码器对良好实践一无所知），并且没有提供任何评论。由于时间限制以及我没有所需的规范，因此将其扔掉是不可行的，因此重写它意味着理解原件，但在理解它之后修复它会更快。我还加了很多评论，所以谁来找我看都不会觉得一样的痛苦……

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-19T11:48:53.047

Perl 声明：

```
select((select(s),$|=1)[0]) 
```

在原作者（Randal Schwartz 本人，他说他不喜欢它，但当时没有其他可用的）的建议下，它被替换为更容易理解的东西：

```
IO::Handle->autoflush 
```

除了这一行之外，IBM 的一些 Java JDBC 库被混淆了，所有变量和函数要么是字母“l”和“1”的组合，要么是单/双字符——在你得到它们之前很难追踪任何东西都改名了。需要这样做来追踪为什么他们在 IBM 的 JRE 中运行良好，但在 Sun 的运行良好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-07T16:04:49.103

如果您在谈论 HLL 代码，一旦我更新由中国人编写的项目并且所有评论都是中文的（存储在 ansii 中）并且理解一些代码片段是一种恐惧，如果您谈论的是低级代码，那么有其中*许多*（混淆，变异，vm-ed ...）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-11-07T16:19:28.700

我曾经不得不对一个 Java 1.1 框架进行逆向工程：

1.  为每个类扩展了事件驱动的 SAX 解析器类，甚至那些不解析 XML 的类（被覆盖的方法只是由其他代码临时调用）
2.  尽可能抛出自定义运行时异常来代替方法调用。结果，大部分业务逻辑都落在了嵌套的一系列`catch`块中。

如果我不得不猜测，这可能是某人的“聪明”想法，即在 Java 1.1 中方法调用代价高昂，因此为非异常流控制抛出异常在某种程度上被认为是一种优化。

用了大约三瓶眼药水。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-10-09T15:47:42.387

我曾经发现一个被故意混淆的定时炸弹。

当我终于破译了它在做什么时，我向经理提到了它，他们说他们知道定时炸弹，但因为它非常无效并且与其他代码交织在一起而将其留在原处。

定时炸弹（大概）应该在某个日期之后引爆。

相反，它有一个错误，因此只有在 12 月 31 日午餐时间之后有人工作时才会激活它。

从那个写定时炸弹的家伙离开公司到现在，这种情况已经过了三年。

# sql-server - 通过 ADO.NET 访问 SQL Server 消息

> ID：765142
> 
> 赞同：23
> 
> 时间：2009-04-19T09:45:27.150
> 
> 标签：sql-server, ado.net

是否可以通过 ADO.NET 访问 SQL Server“副产品消息”？由于缺少文字，我所说的“副产品消息”是指出现在 Microsoft SQL Server Management Studio 的“消息”选项卡中的输出。我特别想到的是读取 SET STATISTICS TIME ON 的输出。看来 SqlDataReader 在这件事上没有提供任何东西。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-19T09:48:52.010

是的，`SqlConnection`类上有一个名为的事件`SqlInfoMessage`，您可以将其挂钩：

```
SqlConnection _con = 
   new SqlConnection("server=.;database=Northwind;integrated Security=SSPI;");

_con.InfoMessage += new SqlInfoMessageEventHandler(InfoMessageHandler); 
```

事件处理程序将如下所示：

```
static void InfoMessageHandler(object sender, SqlInfoMessageEventArgs e)
{
    string myMsg = e.Message;            
} 
```

这`e.Message`是打印到 SQL Server Management Studio 中的消息窗口的消息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-19T11:29:46.137

谢谢楼上的回复。我只是做了一个小实验，在从多记录集结果中读取消息（在这种情况下由 SET STATISTICS TIME ON 产生）时发现了一个意想不到的小故障（错误？）。如下所示，即使在最后一个结果集之后，也必须调用 NextResult 才能获得最后一条消息。在单个记录集结果的情况下不需要这样做。

```
using System;
using System.Data.SqlClient;

namespace TimingTest
{
    class Program
    {

        static void Main(string[] args)
        {

            SqlConnection conn = new SqlConnection("some_conn_str");
            conn.Open();

            conn.InfoMessage += new SqlInfoMessageEventHandler(Message);

            SqlCommand cmd = new SqlCommand("some_sp", conn);
            cmd.CommandType = System.Data.CommandType.StoredProcedure;

            SqlDataReader rdr = cmd.ExecuteReader();

            while (rdr.Read()) { };

            rdr.NextResult();

            while (rdr.Read()) { };

            // this is needed to print the second message
            rdr.NextResult();

            rdr.Close();

            conn.Close();

        }

        static void Message(object sender, SqlInfoMessageEventArgs e)
        {
            Console.Out.WriteLine(e.Message);
        }

    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-30T11:52:56.823

基于[marc_s 的回答](https://stackoverflow.com/a/765144/52277)，我创建了一个包装类

```
public class SqlInfoMessageWrapper
{
     public SqlInfoMessageWrapper(SqlConnection connection)
     {
            SqlConnection = connection;
            connection.InfoMessage += new SqlInfoMessageEventHandler(InfoMessageHandler);
      }
      public SqlConnection SqlConnection { get; set; }
      public string Message  { get; set; }

      void InfoMessageHandler(object sender, SqlInfoMessageEventArgs e)
      {
            Message = e.Message;
      }
 } 
```

使用示例：

```
 using (SqlConnection connection = new SqlConnection(connectionString))
    {
        connection.Open();
        var messageWrapper=new SqlInfoMessageWrapper(connection) ;

        var ret = SqlHelper2.ExecuteNonQuery(connection, CommandType.Text, command, null);
        messages+= $"{messageWrapper.Message} number of rows affected {ret} ";
    } 
```

# jquery - 从 js 文件调用thickbox

> ID：765143
> 
> 赞同：0
> 
> 时间：2009-04-19T09:47:06.227
> 
> 标签：jquery, thickbox

嗨，我正在尝试将厚框添加到 googlemaps 中的叠加层。在我的 JQuery onload 函数中，我调用了以下函数。地图工作正常。但是当厚框似乎没有被调用。这是行之有效的线

```
<a href="test.html?keepThis=true&TB_iframe=true&height=250&width=400" title="add a caption to title attribute / or leave blank" class="thickbox">Example 1</a> 
```

整体功能

```
function load(lat, lng, zlevel, userKey, state) {

        map = new GMap2(document.getElementById("map"));
        map.disableDoubleClickZoom();
        map.setCenter(new GLatLng(lat, lng), zlevel);

        if (state) {

            dsp = true;

            map.addControl(new GLargeMapControl());
            GEvent.addListener(map, "click", function(overlay, latlng) {

                var zoom = map.getZoom();
                var display = '<h5 class="header-flag">Flag</h5><p class="maptext"><a href="#" onclick="javascript:openOverlay(' + latlng.lat() + ',' + latlng.lng() + ',' + zoom + ');">Click here</a> to enter your comment - 
<a href="test.html?keepThis=true&TB_iframe=true&height=250&width=400" title="add a caption to title attribute / or leave blank" class="thickbox">Example 1</a></p>';

                setTimeout(function() { map.openInfoWindowHtml(latlng, display, { maxWidth: 200 }); }, 0);
            });
        } else {

        }

        mgr = new MarkerManager(map);
        loadMarkers(userKey);
        mgr.refresh();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T15:51:46.600

在调用了thickbox 函数之后，将要激活thickbox 的链接添加到DOM。这是因为您正在 map.openInfoWindowHtml 函数中动态创建链接。执行此函数后，您需要调用thickbox 函数。

问题是我只是查看了thickbox 文档，并且一旦DOM 加载，thickbox 就会在thickbox.js 文件中设置，这对你来说太早了。您可以尝试将 setTimeout 函数更改为：

```
setTimeout(function() { map.openInfoWindowHtml(latlng, display, { maxWidth: 200 }); tb_init('a.thickbox'); }, 0); 
```

我不能 100% 确定这会奏效，但这是问题的症结所在。

# c++ - 如何删除 const_iterator 的常量？

> ID：765148
> 
> 赞同：54
> 
> 时间：2009-04-19T09:54:09.423
> 
> 标签：c++, stl, iterator, const-iterator

作为这个问题的延伸[更快吗](https://stackoverflow.com/questions/755347/are-constiterators-faster)[？`const_iterators`](https://stackoverflow.com/questions/755347/are-constiterators-faster)，我还有一个问题`const_iterators`。如何删除 a 的常量`const_iterator`？尽管迭代器是指针的广义形式，但仍然`const_iterator`和`iterator`s 是两个不同的东西。因此，我相信，我也不能使用`const_cast<>`to 转换 from `const_iterator`to `iterator`s。

一种方法可能是您定义一个迭代器，它将元素移动到哪个`const_iterator`点。但这看起来是一个线性时间算法。

关于实现这一目标的最佳方法的任何想法？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-05-19T21:40:06.980

在 C++11 中有一个恒定时间复杂度的解决方案：对于任何序列、关联或无序关联容器（包括所有标准库容器），您可以使用空范围调用范围擦除成员函数：

```
template <typename Container, typename ConstIterator>
typename Container::iterator remove_constness(Container& c, ConstIterator it)
{
    return c.erase(it, it);
} 
```

范围擦除成员函数有一对`const_iterator`参数，但它们返回一个`iterator`. 因为提供了一个空范围，所以对擦除的调用不会更改容器的内容。

[向 Howard Hinnant 和 Jon Kalb 致敬这一技巧。](https://twitter.com/#!/JonathanKalb/status/202815932089896960)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-19T10:00:50.780

不幸的是，线性时间是唯一的方法：

```
iter i(d.begin());
advance (i,distance<ConstIter>(i,ci)); 
```

其中 iter 和 constIter 是合适的 typedef，d 是您正在迭代的容器。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-19T12:49:08.333

在您上一篇文章的答案中，有几个人（包括我在内）建议使用 const_iterators 来代替与性能无关的原因。可读性，从设计板到代码的可追溯性......使用 const_iterators 提供对非常量元素的变异访问比根本不使用 const_iterators 要糟糕得多。你正在将你的代码转换成只有你能理解的东西，设计更差，可维护性也很痛苦。使用 const 只是为了抛弃它比根本不使用 const 要糟糕得多。

如果你确定你想要它，C++ 的好/坏部分是你总是可以得到足够的绳子来吊死自己。如果您打算使用 const_iterator 来解决性能问题，那么您真的应该重新考虑它，但是如果您仍然想摆脱困境……那么 C++ 可以提​​供您选择的武器。

首先，最简单的：如果您的操作将参数作为 const（即使在内部应用 const_cast）我相信它应该在大多数实现中直接工作（即使它可能是未定义的行为）。

如果您无法更改函子，那么您可以从任一方面解决问题：在 const 迭代器周围提供一个非常量迭代器包装器，或者在非常量函子周围提供一个 const 函子包装器。

迭代器外观，漫漫长路：

```
template <typename T>
struct remove_const
{
    typedef T type;
};
template <typename T>
struct remove_const<const T>
{
    typedef T type;
};

template <typename T>
class unconst_iterator_type
{
    public:
        typedef std::forward_iterator_tag iterator_category;
        typedef typename remove_const<
                typename std::iterator_traits<T>::value_type
            >::type value_type;
        typedef value_type* pointer;
        typedef value_type& reference;

        unconst_iterator_type( T it )
            : it_( it ) {} // allow implicit conversions
        unconst_iterator_type& operator++() {
            ++it_;
            return *this;
        }
        value_type& operator*() {
            return const_cast<value_type&>( *it_ );
        }
        pointer operator->() {
            return const_cast<pointer>( &(*it_) );
        }
        friend bool operator==( unconst_iterator_type<T> const & lhs,
                unconst_iterator_type<T> const & rhs )
        {
            return lhs.it_ == rhs.it_;
        }
        friend bool operator!=( unconst_iterator_type<T> const & lhs,
                unconst_iterator_type<T> const & rhs )
        {
            return !( lhs == rhs );
        }
    private:
        T it_;  // internal (const) iterator
}; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-19T13:26:07.933

[Scott Meyer](http://www.aristeia.com/Papers/CUJ_June_2001.pdf)关于更喜欢迭代器而不是 const_iterators 的文章回答了这个问题。Visage 的答案是 C++11 之前唯一安全的替代方案，但实际上对于实现良好的随机访问迭代器来说是恒定时间，而对于其他迭代器来说是线性时间。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-19T10:36:15.530

这可能不是您想要的答案，但有些相关。

我假设您想更改迭代器指向的东西。我做的最简单的方法是 const_cast 返回的引用。

像这样的东西

`const_cast<T&>(*it);`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-19T11:38:21.483

我相信在精心设计的程序中不需要这种转换。

如果您需要这样做 - 尝试重新设计代码。

作为解决方法，您可以使用以下方法：

```
typedef std::vector< size_t > container_type;
container_type v;
// filling container code 
container_type::const_iterator ci = v.begin() + 3; // set some value 
container_type::iterator i = v.begin();
std::advance( i, std::distance< container_type::const_iterator >( v.begin(), ci ) ); 
```

但我认为有时这种转换是不可能的，因为您的算法无权访问容器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-19T10:00:12.280

您可以从 const_iterator 中减去 begin() 迭代器以获得 const_iterator 指向的位置，然后将 begin() 添加回该位置以获得非常量迭代器。我认为这对于非线性容器来说不是很有效，但是对于诸如向量之类的线性容器，这将花费恒定的时间。

```
vector<int> v;                                                                                                         
v.push_back(0);
v.push_back(1);
v.push_back(2);
v.push_back(3);
vector<int>::const_iterator ci = v.begin() + 2;
cout << *ci << endl;
vector<int>::iterator it = v.begin() + (ci - v.begin());
cout << *it << endl;
*it = 20;
cout << *ci << endl; 
```

**编辑**：这似乎只适用于线性（随机访问）容器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-19T10:37:35.823

您可以将 const 迭代器值指针转换为非 const 值指针并直接使用它，如下所示

```
 vector<int> v;                                                                                                         
v.push_back(0);
v.push_back(1);
v.push_back(2);
v.push_back(2);
vector<int>::const_iterator ci = v.begin() + 2;
cout << *ci << endl;
*const_cast<int*>(&(*ci)) = 7;
cout << *ci << endl; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-15T16:05:49.040

我认为想出一个适用于不在标准库中且不包含 erase() 方法的容器的解决方案会很有趣。

尝试使用它会导致 Visual Studio 2013 挂起编译。我不包括测试用例，因为将其留给能够快速找出界面的读者似乎是个好主意；我不知道为什么这会挂在编译上。即使 const_iterator 等于 begin() 也会发生这种情况。

```
// deconst.h

#ifndef _miscTools_deconst
#define _miscTools_deconst

#ifdef _WIN32 
    #include <Windows.h>
#endif

namespace miscTools
{
    template < typename T >
    struct deconst
    {

        static inline typename T::iterator iterator ( typename T::const_iterator*&& target, T*&& subject )
        {
            typename T::iterator && resultant = subject->begin ( );

            bool goodItty = process < 0, T >::step ( std::move ( target ), std::move ( &resultant ), std::move ( subject ) );

        #ifdef _WIN32
             // This is just my habit with test code, and would normally be replaced by an assert
             if ( goodItty == false ) 
             {
                  OutputDebugString ( "     ERROR: deconst::iterator call. Target iterator is not within the bounds of the subject container.\n" ) 
             }
        #endif
            return std::move ( resultant );
        }

    private:

        template < std::size_t i, typename T >
        struct process
        {
            static inline bool step ( typename T::const_iterator*&& target, typename T::iterator*&& variant, T*&& subject )
            {
                if ( ( static_cast <typename T::const_iterator> ( subject->begin () + i ) ) == *target )
                {
                    ( *variant ) += i;
                    return true;
                }
                else
                {
                    if ( ( *variant + i ) < subject->end () )
                    {
                        process < ( i + 1 ), T >::step ( std::move ( target ), std::move ( variant ), std::move ( subject ) );
                    }
                    else { return false; }
                }
            }
        };
    };
}

#endif 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-03-02T02:11:10.333

假设您的容器`const_iterator`具有与其相同的布局`iterator`（所有 STL 容器的有效假设），您可以简单地将前者位转换为后者：

```
#include <bit>
#include <vector>

void demo() {
    using vec_t = std::vector<int>;
    vec_t v { 1, 2, 3 };
    vec_t::const_iterator c_it = v.cbegin();
    vec_t::iterator it = std::bit_cast<vec_t::iterator>(c_it);
    *it = 4; // OK, now v holds { 4, 2, 3 }
} 
```

# delphi - Delphi中的保护页面异常？

> ID：765162
> 
> 赞同：6
> 
> 时间：2009-04-19T10:01:16.287
> 
> 标签：delphi, exception

Raymond Chen 有一个帖子，[他通过吃保护页异常告诉 IsBadXxxPtr 函数有多糟糕](https://blogs.msdn.com/oldnewthing/archive/2006/09/27/773741.aspx)。

我不太明白它是如何应用于Delphi的。通常应该由谁以及如何（即不调用 IsBadXxxPtr）处理此异常？我知道 Delphi 插入了一个代码，它（例如）访问大型静态数组的内存 - 正是因为这个原因：扩展堆栈。

但是如果出现保护页异常：谁将在 Delphi 应用程序中处理它？我不能以不适当的方式使用 try/except 来不小心弄乱它吗？Delphi 的调试器会通知我这些异常吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-19T13:52:26.917

Windows 结构化异常处理 (SEH) 具有两阶段结构。当异常发生时，Windows首先按照已注册的异常处理程序链（其头部存储在x86上的fs:[0]中，即FS段所指向的段中的第一个dword）来寻找该异常的处理程序寄存器——所有丑陋的 16 位段偏移逻辑并没有在 32 位中消失，只是变得不那么相关了）。

通过调用具有特定标志的函数来完成搜索，该标志存储在堆栈上的每个异常帧中。fs:[0] 指向最顶层的帧。每一帧都指向前一帧。最终，列表中的最后一帧是由操作系统提供的（如果出现未处理的异常，此处理程序将弹出一个应用程序崩溃对话框）。

这些函数通常检查异常的类型，并返回一个代码来指示要做什么。可以返回的代码之一基本上是“忽略此异常并继续”。如果 Windows 看到这一点，它会将指令指针重置到异常点并恢复执行。另一个代码表明这个异常帧应该处理给定的异常。第三个代码是“我不会捕获这个异常，继续搜索”。Windows 不断调用这些异常过滤器函数，直到找到一个以一种或另一种方式处理异常的函数。

如果 Windows 发现一个通过捕获异常来处理异常，那么它将继续将堆栈展开回该处理程序，这包括再次调用所有函数，只传入一个不同的标志。在这一点上，函数执行`finally`逻辑，直到执行`except`逻辑的处理程序。

但是，对于堆栈页面保护异常，该过程是不同的。该语言的任何异常处理程序都不会选择处理此异常，因为否则堆栈增长机制将中断。相反，过滤器搜索一直过滤到操作系统提供的基本异常处理程序，该处理程序通过提交适当的内存来增加堆栈分配，然后返回适当的返回码以指示操作系统应该从中断的地方继续，而不是展开堆栈。

该工具和调试基础设施旨在让这些特定异常正确发挥作用，因此您无需担心处理它们。

[您可以在Matt Pietrek 十多年前在 MSJ 上发表的优秀文章中](http://www.microsoft.com/msj/0197/Exception/Exception.aspx)阅读更多关于 SEH 的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T13:38:52.487

通过查看评论，在我看来，“保护页面异常”混乱完全发生在内核中，而不是您需要从用户空间担心的事情。

您必须记住，本文是为 C++ 编写的，它在内存管理方面远没有 Delphi 先进。Delphi 中的未初始化指针问题比 C/C++ 中的问题要少得多，原因有两个：

1.  Delphi 在编译时检查未初始化的变量，这（无论出于何种原因）很多 C 编译器往往会遇到问题。
2.  Delphi 将其所有动态内存初始化为 0，因此您无需处理随机堆垃圾，这可能看起来像一个很好的指针，但实际上并非如此。这意味着大多数坏指针会给您带来访问冲突，这很容易调试，而不是默默地失败和破坏内存。

# delphi - 德尔福编码标准

> ID：765163
> 
> 赞同：6
> 
> 时间：2009-04-19T10:02:21.183
> 
> 标签：delphi, coding-style

我正在编写（写下）我们公司的 Delphi 编程编码标准，那么任何人建议有什么作为基础，你会推荐使用/不使用的任何东西？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-19T10:09:51.257

我使用[Delphi 语言编码标准文档](http://www.cs.ut.ee/~jellen/delphi/cs.html)作为内部文档的基础。

我认为，[Object Pascal 风格指南](http://edn.embarcadero.com/article/10280)可能被称为“官方”指南——只要有这样的东西。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-19T14:50:21.613

小心不要对强制标准过于直言不讳。您可能想从最有经验的程序员那里收集一些示例，让他们同意，然后将它们用作每个人的模板。

Jeff Atwood 最近发表了一篇有趣的博客文章，内容仅涉及标准的一个方面：[“太空异教徒的死亡！”](https://blog.codinghorror.com/death-to-the-space-infidels/) 在那里他说：

> “你选择哪种编码风格实际上并不重要。重要的是你和你团队中的其他人，坚持这些约定并始终如一地使用它们。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-19T15:22:27.057

编码标准是一个经典的自行车棚话题。人们为这些东西争论不休，因为它很少，最终也不像好的设计那么重要。干净、可读的代码值得拥有，干净可读的糟糕设计的代码比不可读的糟糕设计的代码好不了多少。也许最易读的坏代码更容易弄清楚它需要丢弃。

鼓励团队成员贡献清晰可读的代码的努力可以包括推广风格指南。风格指南评论中你反复抨击某人使用错误的风格，会适得其反。如果有人在使用可接受的风格时遇到困难，请向他们介绍使用某些工具的乐趣。不要让一个非常称职的程序员因为对小问题的过多批评而束手无策。

# asp.net - Using SQL server 2008 for ASP.net 2.0 Membership provider

> ID：765167
> 
> 赞同：7
> 
> 时间：2009-04-19T10:03:56.373
> 
> 标签：asp.net, sql-server-2008, membership-provider, sql-server-2008-express

I tried to set-up the SQL tables for ASP .net 2.0 membership provider by clicking on ASP.net Configuration under Project.

I have completely uninstalled SQL 2005 Express and installed SQL 2008 Express instead.

It seems like that it can not connect to the database.

Does anybody know how to get this fixed so I can use 2008 instead ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:53:55.890

尝试配置数据库，在 VS 命令提示符下键入“aspnet_regsql”。

然后设置数据库，最后更改 web.config 文件上的连接字符串。

[ASP.NET SQL Server 注册工具 (Aspnet_regsql.exe)](http://msdn.microsoft.com/en-US/library/ms229862%28v=vs.80%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T11:15:12.193

What is your SQL 2008 installation instance called? What does your connection string for the membership provider look like?

As far as I know, there is (or was) a glitch in the SQL Server 2008 Express installation that even if you chose to install as "default" instance, it would still make it a "named instance" called ".\SQLExpress" instead. Could that be the problem?

Marc

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T17:28:38.347

正如 Marc 已经指出的那样，这可能是实例名称的问题。这已在 SQL Server 2008 Express 的服务包 1 中得到修复。有关详细信息和解决方法，请参阅[此 Microsoft 知识库文章](http://support.microsoft.com/kb/958778)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T09:25:33.570

SQL 2005 and 2008 are both configured in a fairly locked down state by default - and this means that SQL won't accept access the database other than through Shared Memory, even with Integrated Security.

You need to enable TCP/IP or Named Pipes for the Client Protocols for the server (as this is how ASP.NET talks to SQL if you've not configured a DSN to use Shared Memory.

I can't remember the exact steps in 2k8, as I've only had to do it once, but in 2k5 you had to open the SQL Server Configuration Manager, select SQL Native Client Configuration, Client Protocols, and enable TCP/IP and Named Pipes - it's a similar process for 2k8 as I recall.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-16T10:14:19.073

*成员*标签中使用的*connectionStringName*应更改为您创建成员表的当前连接字符串。

 *如果*connectionStringName*未指向*connectionStrings*标记中的有效连接字符串名称，则应用程序不能使用成员资格表。

# php - 使用 throw try catch 错误处理的正确方法

> ID：765173
> 
> 赞同：4
> 
> 时间：2009-04-19T10:08:40.730
> 
> 标签：php, exception, error-handling

我在下面遇到了这个函数，我想知道这是否是使用 try/catch 错误处理的正确方法。

```
public function execute()
{
    $lbReturn = false;
    $lsQuery = $this->msLastQuery;
    try
    {
        $lrResource = mysql_query($lsQuery);

        if(!$lrResource)
        {
            throw new MysqlException("Unable to execute query: ".$lsQuery);
        }
        else
        {
            $this->mrQueryResource = $lrResource;
            $lbReturn = true;
        }

    }
    catch(MysqlException $errorMsg)
    {
        ErrorHandler::handleException($errorMsg);
    }
    return $lbReturn;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-19T10:10:45.233

不。在这种情况下抛出异常只是一个 GOTO，但有一个（稍微）漂亮的脸。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-19T10:42:57.467

在代码方面它是正确/有效的，但是 try-catch 的强大之处在于，当您正在调用的函数之一中从深处抛出异常时。
因为“停止执行中间功能并一直跳回catch块”。

在这种情况下，没有深层异常，因此我会这样写：（
假设 ErrorHandler 中有一个函数“handleErrorMessage”。）

```
public function execute() {
    $lsQuery = $this->msLastQuery;
    $lrResource = mysql_query($lsQuery);

    if(!$lrResource) {
         ErrorHandler::handleErrorMessage("Unable to execute query: ".$lsQuery);
         return false;
    }
    $this->mrQueryResource = $lrResource;
    return true;
} 
```

我觉得这更具可读性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T16:14:51.583

为什么还要在这里调用 ErrorHandler::handleException 呢？

只需抛出异常，但永远不要捕获它。然后在您的应用程序的全局初始化代码中有一个具有以下签名的函数：

```
function catchAllExceptions(Exception $e) 
```

然后调用：

```
set_exception_handler('catchAllExceptions'); 
```

这将导致所有未捕获的异常作为参数传递给 catchAllExceptions()。像这样在一个地方处理所有未捕获的异常是很好的，因为您可以减少代码复制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T10:32:41.127

好吧，这并不是一个很好的实现，因为您抛出异常并在 catch 中查找该异常。所以 Visage 的回答是正确的。

1.  您应该使用全局错误处理程序，而不是像代码中那样使用 tr-catch。
2.  如果您不确定错误和发生的类型，但希望在发生异常的情况下继续执行代码，那么 try-catch 块会有所帮助。

# c# - 如何使用 c# 获取有关 mysql 表的所有详细信息？

> ID：765176
> 
> 赞同：5
> 
> 时间：2009-04-19T10:10:12.303
> 
> 标签：c#, mysql

我想使用 c# 检索 mysql 表的这些信息

1) 完整的列定义，包括名称、大小和数据类型，以及 null/not null、无符号、自动递增、默认值等额外信息，如果数据类型为枚举，则接受的值

2) 所有约束 - Primary/Foreign/Check/Unique

3) 所有指标

我可以使用对数据库的“describe table_name”查询来获取与列相关的基本信息。

但是如何获取所有这些信息？

问候，安詹

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T10:36:56.810

只需对 INFORMATION_SCHEMA 提出查询...

例如，要获取列定义：

```
SELECT   TABLE_NAME
       , COLUMN_NAME
       , DATA_TYPE
       , CHARACTER_MAXIMUM_LENGTH
       , CHARACTER_OCTET_LENGTH 
       , NUMERIC_PRECISION 
       , NUMERIC_SCALE AS SCALE
       , COLUMN_DEFAULT
       , IS_NULLABLE
FROM INFORMATION_SCHEMA.COLUMNS 
```

查看[信息架构表](http://dev.mysql.com/doc/refman/5.0/en/information-schema.html)以获取更多信息。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-23T17:55:13.337

您可以使用`SqlDataReader.GetSchemaTable()`方法，这仅适用于您的 1) 选项，但**如果您的连接字符串设置了默认数据库 (模式) 选项**，则可以使用与模式的相同连接来完成。（您不需要创建与 INFORMATION_SCHEMA 模式的单独连接）。

可以在此处找到有关此方法的更多信息，并[在](http://support.microsoft.com/kb/310107)[此处](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.getschematable.aspx)举例说明如何使用它。

要获取有关您的架构或数据库的所有信息，请使用`SqlClientMetaDataCollectionNames`类。

可以在[此处](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlclientmetadatacollectionnames.aspx)找到有关课程的更多信息，以及如何在[此处使用示例](https://www.simple-talk.com/content/print.aspx?article=202)

# vb.net - VB.net 2008 Property Array

> ID：765180
> 
> 赞同：0
> 
> 时间：2009-04-19T10:15:23.273
> 
> 标签：vb.net, arrays, properties

Hi can anyone help here? I am currently learning VB.net but for a project I need to create and array and pass it using a property. The data to be passed will be a train's destination, the time its due and the expected time of the train. I was wondering if someone could simplly explain how to first produce an array and then show how to pass it to a custom control using a property any help would be great.

Thank you.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T14:52:19.643

如果您想为控件提供多个值，一种简洁的方法是使用单独的属性，每个值一个，而不是尝试将它们全部传递到一个数组中。另一种干净的方法是创建一个新类（类型），将所有这些值组合到一个结构中，并公开该类型的单个属性。例如：

```
Public Class TrainDetails
    Private _destination As String
    Private _due As DateTime
    Private _expected as DateTime

    Public Property Destination As String
        Get
            Return _destination
        End Get
        Set
            _destination = Value
        End Set
    End Property

    Public Property Due As DateTime
        Get
            Return _due
        End Get
        Set
            _due = Value
        End Set
    End Property

    Public Property Expected As DateTime
        Get
            Return _expected
        End Get
        Set
            _expected = Value
        End Set
    End Property
End Class 
```

（注意，我认为有必要实现属性过程，而不是直接公开内部字段值，以便属性显示在属性网格中。）

所以如果你有这个类，那么你可以在你的控件上创建一个 TrainDetails 类型的属性，它将所有这些属性封装在一个值中。我认为它们将在属性网格中作为单个属性进行编辑，旁边有一个可扩展的“+”来编辑各个值。

# c# - How Can I Get an Event Handler to be Called From a Seperate Thread than the One it Was Created On?

> ID：765181
> 
> 赞同：1
> 
> 时间：2009-04-19T10:15:24.833
> 
> 标签：c#, multithreading, events

I'm having some trouble getting a web-page indexing program to work. I have a form that automatically downloads URLs to index from a database server and sends back responses containing the indexed page information, over UDP. I have a static class called UDP that keeps track of incoming and outgoing messages. There is an event that fires whenever a message is recieved, which the form that contains all the indexing code hooks to keep track of messages sent from a program on the server that holds the database of urls to index.

This was all working fine, until I added another form that appears before the indexing form. Now, the indexing form opens on another thread (through Application.Run() and a second thread). The problem is, the event handler is no longer called when the event is fired.

So, the question is, what is going on here, and what can I do to fix it? I'm pretty sure it has to do with some cross-thread safety mechanism that doesn't call event handlers on another thread than the one the event was fired from. Does anybody know of a different way to do this or a way to circumvent this? Thanks in advance...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T10:19:40.797

An UI control has to be manipulated on the thread that it was created on (the UI thread). In order to achieve that, you'll have to 'invoke' the event-handler.

This can be done by raising the event like this:

```
EventHandler handler = myEventHandler;
if( handler != null )
{
    ISynchronizeInvoke target = handler.Target as ISynchronizeInvoke;

    if( target != null && target.InvokeRequired )
    {
        target.Invoke (handler, ... );
    }
    else
    {
        handler.DynamicInvoke (...);
    }
} 
```

Or, you can also have a look at the [AsyncOperation](http://msdn.microsoft.com/en-us/library/system.componentmodel.asyncoperation.aspx) & [AsyncOperationManager](http://msdn.microsoft.com/en-us/library/system.componentmodel.asyncoperationmanager.aspx) classes.

Or, perhaps even simpler, take a look at the [SynchronizationContext](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx) class. Using the 'Current' property of this class, you can just Post a SendOrPostCallback delegate which wraps around your eventhandler.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T12:37:20.687

我不认为这是一种“安全机制”。如果您在调试器中并且尝试从适当线程以外的线程访问 UI，则 WinForms（从 .NET 2.0 开始）中*确实*存在的安全机制会引发异常。

您确定根本没有调用该事件*吗*？这听起来非常奇怪。如果您在调试器中的事件处理程序上放置一个断点，该断点不会被命中吗？

不过，要以不同的方式回答您的问题，我不会让整个事件处理程序在特定线程上执行。可能订阅了多个处理程序，并且这些处理程序可能需要在不同的线程上执行。相反，我会让事件处理程序本身成为线程安全的——对它们进行编码，以便如果它们需要在特定线程上执行某些操作，它们会编组回线程（例如，使用`Control.BeginInvoke`等）。

您的大部分网络访问发生在哪个线程上？我希望它不是所涉及的任何一个 UI 线程（否则你会得到一个无响应的 UI）*。*这意味着如果它以前工作过，您可能已经在进行适当的编组......非常奇怪。

如果这些都没有帮助，您能否尝试提出一个简短但完整的程序来演示该问题？诊断具体代码更容易:)

# jquery - 如何使用 jQuery 显示/隐藏一些数据？

> ID：765183
> 
> 赞同：0
> 
> 时间：2009-04-19T10:20:22.527
> 
> 标签：jquery

我想要三个不同的“标签”。当用户单击选项卡时，它会隐藏其他两个并显示单击的那个。

我正在使用 ASP.NET + jQuery.1.3.2.min

例如。

```
 [ Tab 1]  [ Tab 2 ]  [ Tab 3 ]
---------------------------------
... Table data displayed here ... 
```

有人告诉我使用 jQuery。我不确定

*   要编写的html（例如选项卡和一个简单的表格（我知道如何做表格）
*   jquery 连接到选项卡。

我尝试了谷歌，但我没有得到正确的关键字来找到我想要的:(

干杯！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T10:27:18.953

[使用 CSS 轻松实现类似的东西，这将很容易在 ASP.NET 之上 - 不需要 jQuery。](http://www.alistapart.com/articles/slidingdoors/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T10:28:18.530

你的意思是[标签](http://jqueryui.com/demos/tabs/)它是一个 JQuery UI 插件。

# javascript - ReCaptcha 是“自定义选项字典”JSON 吗？

> ID：765184
> 
> 赞同：0
> 
> 时间：2009-04-19T10:20:22.747
> 
> 标签：javascript, recaptcha

这是一个令人尴尬的问题，因为这主要是因为我缺乏 Javascript 知识。似乎它可能“如此明显”以至于没有人再指定它。必须从某个地方开始！我是一个精通其他语言的编码器，我只是不熟悉 JS。

在[ReCaptcha Client API 文档页面上](http://recaptcha.net/apidocs/captcha/client.html#customization)，有一个自定义选项字典的正确格式示例。

我正在编写一个第 3 方应用程序，它根据用户偏好生成该字典。我不知道/在 Javascript 中找不到字典类型。我最好的猜测是字典是[JSON](http://www.json.org)。我想确保我的输出是有效的并且符合他们的期望，特别是关于引号（完全？单？双？等）

是 JSON 吗？它是另一种类型的字典吗？任何人都可以指出一些关于 JS 字典的有效实例看起来如何的规范吗？**由于搜索词的通用质量，谷歌搜索“Javascript Dictionary”已被证明是无效的。**

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T10:32:18.067

它是一个 javascript[对象文字](http://en.wikipedia.org/wiki/JavaScript_syntax#Creating_objects)，与 JSON 几乎相同（它是一个超集）。任何有效的 JSON 都可以在这里使用，但是从他们的示例中可以看出，Javascript 还有其他一些选项：

```
<script>
var RecaptchaOptions = {
   theme : 'white',
   tabindex : 2
};
</script> 
```

大括号之间的部分是有效的 Javascript，但不是有效的 JSON，因为`theme`,`tabindex`并且`white`都应该用双引号引起来。下面是嵌入在 Javascript 中的有效 JSON，它运行良好：

```
<script>
var RecaptchaOptions = {
   "theme" : "white",
   "tabindex" : 2
};
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T10:33:29.437

不，它不是 JSON，它是纯 JavaScript。更准确地说：它是一个使用对象初始化器语法声明的简单对象`{ … }`。

该语法类似于 JSON，因为 JSON 是 JavaScript 的子集。但是 JSON 要求属性名称是带引号的字符串，而 JavaScript 不是。

# sql - 时间限制层次结构的最佳关系数据库表示

> ID：765186
> 
> 赞同：5
> 
> 时间：2009-04-19T10:21:49.420
> 
> 标签：sql, database, reporting, hierarchy

每个人都认为 SQL 中时限层次结构的最佳表示是什么？

我的意思是：
- 在任何给定日期，您都有一个正常的树层次结构
- 这个层次结构可以每天更改
- 每个孩子在任何给定日期仍然只有一个父母

第一天...

```
Business
 |
 |-Joe
 |  |-Happy
 |  |-Sneezy
 |  |-Doc(*)
 |
 |-Moe
    |-Bashfull
    |-Sleepy 
```

第二天...

```
Business
 |
 |-Joe
 |  |-Happy
 |  |-Sneezy
 |
 |-Moe
    |-Doc(*)
    |-Bashfull
    |-Sleepy 
```

在任何时候，孩子都可以第一次加入层次结构，也可以完全离开层次结构。（例如，新员工和退休员工。）

主要考虑：

*   更新层次结构
*   查看整个日期范围内的整个层次结构
*   报告层次结构中的整个子树
*   跨日期范围报告整个子树

我知道我目前是怎么做的，但我很想知道其他人会怎么做:)

**编辑**

我天真地假设了一些考虑因素，所以会更明确......

*   每个“团队”或“个人”在其他地方的维度表中都有一个唯一的 ID
*   其他事实表将使用这些 ID（例如，存储性能指标）
*   该结构需要促进跨日期范围的历史报告
*   使用 ETL 或触发器来维护替代结构是一种选择

通用性是最重要的（仅形成通用关系模式的一部分），并结合了易于使用的驱动报告（适用于任何日期范围内的树的任何部分）和可靠更新的能力。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-19T11:58:41.527

这里有几本不同的相关书籍 - 一组用于“时间数据库”，另一组用于“RDBMS 中的层次结构”。

*   Snodgrass “[在 SQL 中开发面向时间的应用程序](http://www.cs.arizona.edu/%7Erts/publications.html)”（可在 URL 上在线获取 PDF）
*   Date、Darwen 和 Lorentzos “[时间数据和关系模型](https://rads.stackoverflow.com/amzn/click/com/B001E4587Q)”
*   Celko “ [Joe Celko 为 Smarties 编写的 SQL 中的树和层次结构](https://rads.stackoverflow.com/amzn/click/com/1558609202)”

在我看来，您问题的棘手部分是：

> *   查看整个日期范围内的整个层次结构
>     
>     
> *   跨日期范围报告整个子树

其他项目，如果不是直截了当的，那么可以使用书中概述的技术以及其他答案中建议的方式进行管理。部分问题在于理解这两个要点的含义。在某种意义上，它们是“相同的”；“整个层次结构”只是“整个子树”的一个特例。但更深层次的问题是“你想如何展示——可视化、表示——随着时间的推移层次结构的变化？” 您是要比较开始和结束时间的状态，还是要查看中间变化？你想如何在一个层次结构中表示一个人的动作？

问题多于答案 - 但我希望这些指针能有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T10:36:36.637

几张平板可以在这里工作。对于每一行，我们需要列 ID、Name、ParentID 和 InactivatedDatetime（默认为 null）。为属于 Joe 的旧 Doc 设置日期时间，指示该记录不再有效并将其移至存档表（为了清洁），然后为新 Doc 创建一个新行（原始行的近似副本）以 Moe 的 ID 作为 ParentID。这种方法的缺点是被移动的人必须获得一个新的 ID，这可能不方便。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T10:38:41.487

我可以想到几个合理的解决方案，具体取决于您的数据是如何被使用的以及它是如何变化的。

1）假设今天的等级制度是最重要的。我会在每条记录中使用传统的 ParentId 列存储今天的层次结构。对于以前版本的层次结构，我有一个历史表

```
ItemId, ParentId, ValidFromDate, ValidToDate 
```

每当层次结构发生变化时，您都会在历史表中添加一个新行。

2）如果任何/所有层次结构都同等重要，我会存储一个基线层次结构，然后实现一个层次结构事务表。

```
TransactionId, ItemId, Action (Move/Delete/Add), DateTime, OldParentId, NewParentId 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T12:08:33.673

```
table item(id, ...)

table item_link(parent_item, child_item, from_date, until_date) 
```

链接将存储树的表示一段时间

这种结构代表了一个网络，而不是一个简单的层次结构，但它支持在层次结构中移动事物，而且还可以回顾时间。在应用程序逻辑中需要检查的一些事情是不允许 joe 同时链接到层次结构中的不同位置。

通过前面的子句连接（在 oracle 中），报告相对容易

如果要在关系上指定附加数据，则其他详细信息可以与项目甚至项目链接相关。

# java - 休眠二级缓存

> ID：765192
> 
> 赞同：8
> 
> 时间：2009-04-19T10:30:59.210
> 
> 标签：java, hibernate, annotations, ehcache

嗨，我在使用休眠二级缓存时遇到了一些问题。作为缓存提供者，我使用 ehcache。

来自 persistence.xml 的部分配置

```
<property name="hibernate.cache.use_second_level_cache" value="true"/>
<property name="hibernate.cache.provider_class" value="net.sf.ehcache.hibernate.EhCacheProvider" />
<property name="hibernate.cache.provider_configuration_file_resource_path" value="/ehcache.xml" /> 
```

我使用注释配置我的实体，所以：

```
@Cache(region = "Kierunek", 用法 = CacheConcurrencyStrategy.READ_WRITE)
公共类 Kierunek 实现 Serializable {
```

这些注释的导入是： `import org.hibernate.annotations.Cache; import org.hibernate.annotations.CacheConcurrencyStrategy;`

我的 ehcache.xml

```
<diskStore path="java.io.tmpdir" />

<defaultCache maxElementsInMemory="10000" eternal="false"
    timeToIdleSeconds="120" timeToLiveSeconds="120" overflowToDisk="true"
    diskSpoolBufferSizeMB="30" maxElementsOnDisk="10000000"
    diskPersistent="false" diskExpiryThreadIntervalSeconds="120"
    memoryStoreEvictionPolicy="LRU" />

<cache name="Kierunek" maxElementsInMemory="1000"
    eternal="true" overflowToDisk="false" memoryStoreEvictionPolicy="LRU" /> 
```

有人知道为什么我会出现以下错误吗？

```
WARNING: Could not find a specific ehcache configuration for cache named [persistence.unit:unitName=pz2EAR.ear/pz2EJB.jar#pz2EJB.Kierunek]; using defaults.
19:52:57,313 ERROR [AbstractKernelController] Error installing to Start: name=persistence.unit:unitName=pz2EAR.ear/pz2EJB.jar#pz2EJB state=Create
java.lang.IllegalArgumentException: Cache name cannot contain '/' characters. 
```

解决方案是向 persistence.xml 添加另一个属性

```
<property name="hibernate.cache.region_prefix" value=""/> 
```

并且删除了那个错误的前缀 big thx ruslan！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-19T15:24:27.163

恕我直言，您将获得为您的班级生成的区域名称。这个生成的名称“persistence.unit:unitName=pz2EAR.ear/pz2EJB.jar#pz2EJB.pl.bdsdev.seps.encje.Kierunek”。而且它没有在您的 ehcache.xml 配置中定义。它还在寻找预定义的名称，因此它不能使用默认区域。

作为解决此问题的一个选项，您可以使用 @Cache 注释属性来预定义一些区域名称，例如

```
@Cache(region = 'Kierunek', usage = CacheConcurrencyStrategy.READ_WRITE) 
public class Kierunek implements Serializable {
  // ....
} 
```

并在 ehcache.xml

```
<cache name="Kierunek" 
       maxElementsInMemory="1000"
       eternal="true" 
       overflowToDisk="false" 
       memoryStoreEvictionPolicy="LRU" /> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-11-03T17:10:00.840

Hibernate 根据 appname 或属性 hibernate.cache.region_prefix 的值向缓存名称添加前缀

如果您将此属性设置为“”（空字符串），那么您的区域名称与休眠配置中的名称完全相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T11:27:08.547

EHCache 需要一个配置来告诉它如何缓存应用程序中的对象（实时时间、缓存类型、缓存大小、缓存行为等）。对于您尝试缓存的每个类，它都会尝试找到适当的缓存配置，并在失败时打印上面的错误。

有关如何配置 EHCache，请参阅[http://ehcache.sourceforge.net/documentation/configuration.html 。](http://ehcache.sourceforge.net/documentation/configuration.html)

# cruisecontrol.net - Cruisecontrol.net 依赖项

> ID：765197
> 
> 赞同：1
> 
> 时间：2009-04-19T10:33:25.803
> 
> 标签：cruisecontrol.net

我对 CCNET 中的依赖项有疑问。我有几个项目，每个项目都依赖于另一个项目（内部引用的控制库）。当控制库项目发生变化并触发重新编译时，如何重新构建其他依赖项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T11:59:05.690

通过使用[项目触发器](http://confluence.public.thoughtworks.org/display/CCNET/Project+Trigger)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T06:50:56.140

我们也有许多相互依赖的项目，我们通过告诉 MSBuild 构建一个包含所有项目所需的解决方案文件并以适当的构建顺序来解决这些问题。

# javascript - 如何将文本框中的文本传递给 JavaScript 函数？

> ID：765205
> 
> 赞同：27
> 
> 时间：2009-04-19T10:38:44.433
> 
> 标签：javascript, html

假设我有以下 HTML 代码，如何将用户的输入作为参数传递给 execute(str) JavaScript 函数？

```
<body>

<input name="textbox1" type="text" />
<input name="buttonExecute" onclick="execute(//send the user's input in textbox1 to this function//)" type="button" value="Execute" />

</body> 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-19T10:50:13.017

您可以通过名称访问元素的值：

```
document.getElementsByName("textbox1"); // returns a list of elements with name="textbox1"
document.getElementsByName("textbox1")[0] // returns the first element in DOM with name="textbox1" 
```

所以：

```
<input name="buttonExecute" onclick="execute(document.getElementsByName('textbox1')[0].value)" type="button" value="Execute" /> 
```

或者您为元素分配一个 ID，然后标识它，您可以使用以下命令访问它`getElementById`：

```
<input name="textbox1" id="textbox1" type="text" />
<input name="buttonExecute" onclick="execute(document.getElementById('textbox1').value)" type="button" value="Execute" /> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-19T10:44:19.397

与将文本作为变量传递相反，您可以使用 DOM 来检索函数中的数据：

```
var text = document.getElementsByName("textbox1").value; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-19T10:44:05.980

您可以像这样在 onclick-event 中获取输入值：

```
onclick="execute(document.getElementById('textbox1').value);" 
```

您当然必须在文本框中添加一个 id

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-19T10:55:30.837

这就是我所做的。（改编自您的所有答案）

```
<input name="textbox1" type="text" id="txt1"/>
<input name="buttonExecute" onclick="execute(document.getElementById('txt1').value)" type="button" value="Execute" /> 
```

有用。感谢大家。:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-04-07T08:38:07.287

如果我理解正确的问题：

```
<!DOCTYPE HTML>
<HEAD>
<TITLE>Passing values</TITLE>
<style>
</style>
</HEAD>
Give a number :<input type="number" id="num"><br>
<button onclick="MyFunction(num.value)">Press button...</button>
<script>
function MyFunction(num) {
   document.write("<h1>You gave "+num+"</h1>");
}
</script>
</BODY>
</HTML>
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-19T10:41:47.640

document.getElementById('textbox1').value

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-10T08:34:05.553

您可以通过dotNet编程中的以下简单示例获取文本框值和Id

```
<html>
        <head>
         <script type="text/javascript">
             function GetTextboxId_Value(textBox) 
                 {
                 alert(textBox.value);    // To get Text Box Value(Text)
                 alert(textBox.id);      // To get Text Box Id like txtSearch
             }
         </script>     
        </head>
 <body>
 <input id="txtSearch" type="text" onkeyup="GetTextboxId_Value(this)" />  </body>
 </html> 
```

# sql-server - 按数据库对 sys.dm_exec_connections 进行分组（与 sys.sysprocesses 不太一样）

> ID：765206
> 
> 赞同：0
> 
> 时间：2009-04-19T10:40:54.663
> 
> 标签：sql-server, connection

继我[上一个问题](https://stackoverflow.com/questions/744182/test-before-attempting-exclusive-lock)之后：

我编写了一些代码来升级 SQL Server 数据库。在升级数据库之前，我计划使用以下语句限制对数据库的访问：

```
ALTER DATABASE Test SET SINGLE_USER WITH ROLLBACK IMMEDIATE 
```

在运行此代码之前，我会给用户一个选择退出的机会。在提示用户时，我认为显示活动连接列表会很好（以设定的时间间隔连续轮询）；为用户提供一种工具来识别他们希望在继续之前从服务器启动的应用程序/用户。

在 SQL 2000 中，您可以使用该`sys.sysprocesses`表查看适用于数据库的所有连接。这包括没有活动请求的连接（例如当您打开查询分析器窗口并选择数据库时）。

但是，使用：

*   `sys.dm_exec_connections`
*   `sys.dm_exec_sessions`; 和
*   `sys.dm_exec_requests`

我想不出一种方法来达到同样的结果。这些视图似乎只通过请求将连接与数据库联系起来。有没有办法模仿的行为`sys.sysprocesses`？我不希望将此表用于 SQL Server 2005/2008 数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T12:56:47.987

呃......我为你的其他问题推荐了这些。

抱歉，但是，我发现您仍然必须使用 sysprocesses

它被记录为[Microsoft Connect 144515](http://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=144515)中的错误以进行修复，[我在这里找到了](http://www.windows-tech.info/15/dd2d15df8b55fcdc.php)

就个人而言，我仍然使用 sysprocesses，因为我对它很满意，尽管它可能是懒惰和 luddite ......

# asp.net-mvc - File upload MVC

> ID：765211
> 
> 赞同：9
> 
> 时间：2009-04-19T10:43:57.713
> 
> 标签：asp.net-mvc

With the following markup in my view:

```
<form action="Categories/Upload" enctype="multipart/form-data" method="post">
    <input type="file" name="Image">
    <input type="submit" value"Save">
</form> 
```

And in my controller:

```
public ActionResult Upload(FormCollection form)
{
    var file = form["Image"];
} 
```

The value of file is `null`. If I try it in a different view using a different controller Controller and it works with the same code.

I have VS2008 on Vista, MVC 1.0.

Why?

Malcolm

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-19T12:03:28.317

用作您的操作`HttpPostedFileBase`的参数。另外，添加`AcceptVerb`属性设置为`POST`.

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Upload(HttpPostedFileBase image)
{
    if ( image != null ) {
        // do something
    }
    return View();
} 
```

这段代码非常符合 ASP.NET MVC 的精神/设计。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-20T20:17:21.657

不要在这里挑剔或任何东西，但这是代码应该看起来的样子，因为丹尼尔在他提供的代码中缺少一些小细节......

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult UploadPlotImage(HttpPostedFileBase image)
{    
    if ( image != null ) 
    {        
        // do something    
    }

    return View();
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-19T11:22:39.273

试试这个代码：

```
 public ActionResult Upload()
    {
        foreach (string file in Request.Files)
        {
            var hpf = this.Request.Files[file];
            if (hpf.ContentLength == 0)
            {
                continue;
            }

            string savedFileName = Path.Combine(
                AppDomain.CurrentDomain.BaseDirectory, "PutYourUploadDirectoryHere");
                savedFileName = Path.Combine(savedFileName, Path.GetFileName(hpf.FileName));

            hpf.SaveAs(savedFileName);
        }

    ...
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-12-06T05:39:00.920

即使我遇到了问题，图像中的值为空

```
public ActionResult UploadPlotImadge(HttpPostedFileBase image) 
```

之前我没有添加`[AcceptVerbs(HttpVerbs.Post)]`我添加的。即使添加了它，它也不起作用，因为我缺少的第二部分`enctype="multipart/form-data"`，需要在表单标签中..

现在它对我有用....

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-06T06:13:48.777

尝试此类及以下操作并修复 AppSetting 中的文件夹路径。

配置：

```
 <appSettings>
            <add key="UploadFolerPath" value="..Your folder path" />
   </appSettings> 
```

看法：-

```
<form action="Account/AddImage" id="form_AddImage" method="post"   enctype="multipart/form-data">

            <input type="file" id="Img" name="Img" class="required" />

            <input type="submit" value="Upload" id="btnSubmit" />

</form> 
```

班级：-

```
public class FileUpload
{
    public string SaveFileName
    {
        get;
        set;
    }

    public bool SaveFile(HttpPostedFileBase file, string FullPath)
    {
        string FileName = Guid.NewGuid().ToString();

        FileName = FileName + System.IO.Path.GetExtension(file.FileName);

        SaveFileName = FileName;

        file.SaveAs(FullPath + "/" + FileName);
        return true;
    }
} 
```

//发布动作

```
 [HttpPost]
    public ActionResult AddImage(FormCollection Form)
    {

        FileUpload fileupload = new FileUpload();
         var image="";

        HttpPostedFileBase file = Request.Files["Img"];

        if (file.FileName != null && file.FileName != "")
        {

            if (upload.ContentLength > 0)
            {

                  fileupload.SaveFile(Request.Files["Img"],    Server.MapPath(AppSetting.ReadAppSetting("UploadFolerPath")));

                image = fileupload.SaveFileName;

                // write here your Add/Save function

                return Content(image);

            }
        }
        else
        {
                   //return....;
        }

    } 
```

# internet-explorer - Iframe problem with IE6 & IE7

> ID：765218
> 
> 赞同：0
> 
> 时间：2009-04-19T10:49:44.593
> 
> 标签：internet-explorer, layout, iframe, cross-browser

I'm experiencing difficulties getting my iframe to display correctly in IE6 & IE7. [www.e-g-t.nl](http://www.e-g-t.nl) I think IE has the height of the iframe stretched to far beyond the 400px height I set it to be, and the content is vertically centered.

I'm not an expert at css or html for that matter and don't seem to get it right. In IE8 though, the problem doesn't seem to exist. Any help on this is much appreciated!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-20T12:38:42.570

我很确定这可行： [http](http://strcpy.com/262) ://strcpy.com/262 。

由于其“兼容模式”/怪癖模式，它可以在 IE8 中运行...

# javascript - 使用 javascript 删除选择

> ID：765224
> 
> 赞同：4
> 
> 时间：2009-04-19T10:59:02.577
> 
> 标签：javascript, jquery

我正在开发具有可拖动滚动条的图像查看器。当用户拖动滚动条时，网页上的一些文本会被选中。我试过了

```
window.getSelection().removeAllRanges(); 
```

但这似乎在 IE7/8 中不起作用。还尝试了

```
document.getSelection().removeAllRanges(); 
```

这似乎与 IE7/8 一样“好”。

有没有其他方法可以做到这一点？不知道任何 jQuery 解决方案，但如果有，请告诉我（：

**编辑：**这是 onmouse-event 的上下文

```
$("#slideBar").mousedown(function(f) {
    mouseDown = true;
    some more code...
}

$(document).mouseup(function() {
    if (mouseDown) {
       window.getSelection().removeAllRanges();
       more code...
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T11:16:05.513

尝试在您使用的函数上返回 false，尤其是对于“mousedown”事件。在 document.onselectstart 和 document.ondragstart 上返回 false 也会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-19T11:13:36.190

您可以添加一些 CSS（使用 jquery）来处理这个问题：

```
element {
  -moz-user-select: none;
  -webkit-user-select: none;
  user-select: none;
} 
```

无论如何，对于 IE，您需要在该元素上添加一个专有属性（使用 jquery）：

```
unselectable="on" 
```

# c# - 如何使用 get{set 获取表单的句柄？

> ID：765225
> 
> 赞同：0
> 
> 时间：2009-04-19T10:59:08.783
> 
> 标签：c#, winforms, invoke, handle

我想从不同的类（可能是线程）中获取我的表单句柄。我想按照我调用的方式来做

```
 public int GetHandle
    {
        get
        {
            if (this.InvokeRequired)
            {
                this.Invoke((MethodInvoker)delegate
                {
                    return this.Handle.ToInt32();
                });
            }
        }
    } 
```

我收到一条错误消息“由于‘System.Windows.Forms.MethodInvoker’返回 void，return 关键字后面不能跟对象表达式”

如果我不使用调用，我会得到一个异常，即我没有从当前线程调用该方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T11:09:43.627

您可以调用任何委托，而不仅仅是 MethodInvoker。试试这个：

```
public int GetHandle
    {
        get
        {
            if (this.InvokeRequired)
            {
                return (int)this.Invoke((GetHandleDelegate)delegate
                {
                    return this.Handle.ToInt32();
                });
            }
            return this.Handle.ToInt32();
        }
    }
private delegate int GetHandleDelegate(); 
```

# c++ - 32 位整数 * 32 位整数 = 64 位整数？

> ID：765228
> 
> 赞同：6
> 
> 时间：2009-04-19T11:00:47.813
> 
> 标签：c++, integer-overflow

换句话说，这是否按预期工作？

```
int32 i = INT_MAX-1;
int64 j = i * i; 
```

还是我需要先将 i 转换为 64 位？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-19T11:03:30.707

您需要将至少一个操作数转换为乘法。在乘法完成时，系统不知道您打算分配给 int64。

（除非 int64 实际上是您的特定系统的本机 int 类型，这似乎不太可能）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-19T11:08:03.210

这取决于 int32 和 int64 是什么。

简而言之，在任何算术运算之前，所有整数都至少提升为“int”大小（可能是 64 位），如果二元运算符的等级高于 int，则提升为更大操作数的大小。

如何使用表达式的结果（无论它是否存储到更广泛的类型）与表达式组成部分的提升无关。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-19T15:55:44.703

基本答案是否定的，它不会做你想做的事。
但它确实做了预期的事情。

关于数学运算需要注意的两点：

*   两个操作数将是相同的类型。
*   结果类型将与输入相同。

如果编译器注意到操作数之间的不匹配，它将转换其中一个操作数以使两者都匹配（请参阅[在 C/C++ 中进行数学运算时应该对哪些变量进行类型转换？](https://stackoverflow.com/questions/245740/which-variables-should-i-typecast-when-doing-math-operations-in-c-c/245986#245986)）。注意：这是独立于结果发生的情况进行的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T12:29:33.467

**给定两个数字 a,b，每个数字使用 len_a 和 len_b 位。**

**您的输出数据类型至少需要：len_a 和 len_b 位。**

在上面的代码中，您有两个 31 位数字（因为 INT_MAX - 1 = 0x7FFFFFFE 使用 31 位），您需要将其中一个转换为 int64_t，因为它会在转换为 int64_t 之前执行 32 位乘法和溢出。

* * *

定点乘法所需的位数：

```
len_output = howManyBits( a * b )
           = len_a + len_b 
```

显示上述规则的一个简单示例：

```
a     = 7
len_a = 3

b     = 7
len_b = 3

c = a * b
  = 49 ( decimal )
  = 0x31 ( hex )

len_c = howManyBits( 0x31 ) 
      = 6 
```

您可以编写一个函数来计算位数。或者，如果您只想快速进行健全性检查以确认这一点，请使用 Windows Calc 之类的东西，它将数字转换为二进制形式并计算使用的位数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T15:32:46.310

请参阅：14\. 简单整数类型和 memsize 类型的混合使用。 [http://www.viva64.com/art-1-2-599168895.html](http://www.viva64.com/art-1-2-599168895.html)

# web-services - Server architecture and SubSonic

> ID：765235
> 
> 赞同：0
> 
> 时间：2009-04-19T11:08:59.010
> 
> 标签：web-services, subsonic

Im trying to develop an server /client application. The server will be a bunch of webservices, the idea was to expose methods like:

Company GetNewCompany(); //Creates an new Company Object
Save(Company C);
CompanyCollection GetCompany(Query q);

Where Query object is part of Subsonic 2.1\. But the problem is that SubSonic is not built for this, Have I missed something here? or is it just impossible to to use subsonic query language over SOAP?

This would have been great feature, becuase then it is really easy to make an application server using subsonic.

Br Soren.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T16:45:31.057

如果你想使用亚音速 v3，你可以看看这个关于 IUpdatable 的问题： [http ://code.google.com/p/subsonicthree/issues/detail?id=30](http://code.google.com/p/subsonicthree/issues/detail?id=30)

这将使您使用 ado 数据服务有些痛苦。您使用带有 URI 参数的 DB 构造函数。这可能不会成为 v3 的一部分，但您可以自己进行这样的更改。

```
using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using WcfClientTest.NorthwindService;

namespace WcfClientTest
{
    /// <summary>
    /// Summary description for WcfTest
    /// To run these tests, load this project, and somehow get a server running at the URI. 
    /// This can be done by updating the service reference to start the development server.
    /// </summary>
    [TestClass]
    public class WcfTest
    {
        private string baseURI = "http://127.0.0.1:49649/Northwind.svc";
        private DB ctx;

        /// <summary>
        /// Sets up test.
        /// </summary>
        [TestInitialize]
        public void SetUp()
        {
            ctx = new DB(new Uri(baseURI));
        }

        [TestCleanup]
        public void Cleanup()
        {
        }

        [TestMethod]
        public void Select_Simple_With_Variable()
        {
            int categoryID = 5;
            IQueryable<Product> result = from p in ctx.Products
                                         where p.CategoryID == categoryID
                                         select p;

            List<Product> products = result.ToList();
            Assert.AreEqual(7, products.Count());
        }

        [TestMethod]
        public void TestAddNew()
        {
            // add customer
            var c = new Customer
                        {
                            CustomerID = "XXXXX",
                            ContactTitle = "Prez",
                            Country = "USA",
                            ContactName = "Big Guy",
                            CompanyName = "Big Guy Company"
                        };
            ctx.AddToCustomers(c);
            ctx.SaveChanges();

            IQueryable<Customer> qCustomer = from cust in ctx.Customers
                                             where cust.CustomerID == "XXXXX"
                                             select cust;

            Customer c2 = qCustomer.FirstOrDefault();

            Assert.AreEqual("XXXXX", c2.CustomerID);

            if (c2 != null)
            {
                ctx.DeleteObject(c2);
            }
            ctx.SaveChanges();

            IQueryable<Customer> qCustomer2 = from cust in ctx.Customers
                                              where cust.ContactName == "Big Guy"
                                              select cust;
            // Returns null if the row isn't found.
            Customer c3 = qCustomer2.SingleOrDefault();
            Assert.AreEqual(null, c3);
        }
    }
} 
```

这就是服务的全部内容：

```
using System.Data.Services;
using Northwind;

namespace NorthwindService
{
    [System.ServiceModel.ServiceBehavior(IncludeExceptionDetailInFaults=false)]
    public class Northwind: DataService<DB>
    {
        // This method is called only once to initialize service-wide policies.
        public static void InitializeService(IDataServiceConfiguration config)
        {
            config.SetEntitySetAccessRule("*", EntitySetRights.All);
            config.UseVerboseErrors = true;
        }
    }
} 
```

对于 web.config：

```
 <system.serviceModel>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true"/>
  </system.serviceModel> 
```

# javascript - 在 Javascript 中使用 JSON 从 Google Search Ajax API 获取结果

> ID：765240
> 
> 赞同：0
> 
> 时间：2009-04-19T11:10:20.737
> 
> 标签：javascript, json, api, search

我正在尝试使用 javascript 从网页的 innerHTML 获取 url。

这就是我正在做的事情：

```
var goog = newTabBrowser.contentDocument.getElementsByTagName("pre")[0].innerHTML;
   alert(goog.responseData.results[0].url); 
```

但它不会工作：S

我输出了 goog（使用警报）并将其复制到我的程序中，如下所示：

```
var goog =  {"responseData": {"results":[{"GsearchResultClass":"GwebSearch","unescapedUrl":"http://stackoverflow.com/","url":"http://stackoverflow.com/","visibleUrl":"stackoverflow.com","cacheUrl":"http://www.google.com/search?q\u003dcache:U1GC2GYOToIJ:stackoverflow.com","title":"\u003cb\u003eStack Overflow\u003c/b\u003e","titleNoFormatting":"Stack Overflow","content":"A language-independent collaboratively edited question and answer site for  programmers."},{"GsearchResultClass":"GwebSearch","unescapedUrl":"http://en.wikipedia.org/wiki/Stack_overflow","url":"http://en.wikipedia.org/wiki/Stack_overflow","visibleUrl":"en.wikipedia.org","cacheUrl":"http://www.google.com/search?q\u003dcache:mWu8b0BQAmwJ:en.wikipedia.org","title":"\u003cb\u003eStack overflow\u003c/b\u003e - Wikipedia, the free encyclopedia","titleNoFormatting":"Stack overflow - Wikipedia, the free encyclopedia","content":"In software, a \u003cb\u003estack overflow\u003c/b\u003e occurs when too much memory is used on the call  \u003cb\u003estack\u003c/b\u003e. In many programming languages the call \u003cb\u003estack\u003c/b\u003e contains a limited amount  \u003cb\u003e...\u003c/b\u003e"},{"GsearchResultClass":"GwebSearch","unescapedUrl":"http://blog.stackoverflow.com/","url":"http://blog.stackoverflow.com/","visibleUrl":"blog.stackoverflow.com","cacheUrl":"http://www.google.com/search?q\u003dcache:iqtvg9Ge1c0J:blog.stackoverflow.com","title":"Blog - \u003cb\u003eStack Overflow\u003c/b\u003e","titleNoFormatting":"Blog - Stack Overflow","content":"Apr 12, 2009 \u003cb\u003e...\u003c/b\u003e Apparently some users who really should know better are confused about the way  \u003cb\u003eStack Overflow\u003c/b\u003e works. I take this as a sweeping indictment of \u003cb\u003e...\u003c/b\u003e"},{"GsearchResultClass":"GwebSearch","unescapedUrl":"http://support.microsoft.com/kb/145799","url":"http://support.microsoft.com/kb/145799","visibleUrl":"support.microsoft.com","cacheUrl":"","title":"How to Troubleshoot Windows Internal \u003cb\u003eStack Overflow\u003c/b\u003e Error Messages","titleNoFormatting":"How to Troubleshoot Windows Internal Stack Overflow Error Messages","content":"This article lists steps to help you troubleshoot problems with \u003cb\u003estack overflow\u003c/b\u003e  errors in Windows. Stacks are reserved memory that programs use to process \u003cb\u003e...\u003c/b\u003e"}],"cursor":{"pages":[{"start":"0","label":1},{"start":"4","label":2},{"start":"8","label":3},{"start":"12","label":4},{"start":"16","label":5},{"start":"20","label":6},{"start":"24","label":7},{"start":"28","label":8}],"estimatedResultCount":"273000","currentPageIndex":0,"moreResultsUrl":"http://www.google.com/search?oe\u003dutf8\u0026ie\u003dutf8\u0026source\u003duds\u0026start\u003d0\u0026hl\u003den\u0026q\u003dStack+overflow"}}, "responseDetails": null, "responseStatus": 200};` 
```

并尝试过

```
alert(goog.responseData.results[0].url); 
```

这有效

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T11:19:38.143

`innerHTML`返回一个字符串——不是一个对象结构。您可能必须使用`eval`JSON 解析库（取决于 JSON 数据的安全程度）将其从字符串转换为 JavaScript 对象。

例如，（使用[json2.js](http://www.json.org/js.html) JSON 库）：

```
var googString = newTabBrowser.contentDocument.getElementsByTagName("pre")[0].innerHTML;
var goog = JSON.parse(googString);

// This should give the correct result
alert(goog.responseData.results[0].url); 
```

史蒂夫

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-14T11:12:05.410

看看[有人写了 jquery.google 插件](http://bazaar.launchpad.net/~inportb/jquery-google/dev/files)我知道这个插件很小，它不支持分页或类似的。我想这会对你有帮助吗？只需检查它的源代码。

问候

# treeview - 从不同类型的对象填充的最佳实践 Treeview

> ID：765250
> 
> 赞同：2
> 
> 时间：2009-04-19T11:17:54.963
> 
> 标签：treeview

我想填充树视图。

这是我在 DB 中的内容：

表 : Box BoxID BoxName

表 Book : BookID BookName BoxID (fk Box.BoxID)

表章节：ChapterID ChapterName BookID (fk Book.BookID)

您可能知道树视图由树节点对象组成。treenode 对象有一个 text 属性和一个 tag 属性。“text”属性是它在屏幕上显示的该节点的文本，“tag”是一个“隐藏”值（通常用于标识节点）

所以就我而言；以 ID 结尾的字段将用于“tag”属性，以 Name 结尾的字段将用于“text”属性

示例：对于一本书来说；我将 BookID 字段用于“tag”属性，BookName 字段用于“text”属性

注意：我使用 dbml，所以我有一个 Book 对象、Box 对象和 Chapter 对象，我使用 linq 从数据库中获取它们。

所以我的问题是；构建这棵树的最佳实践是什么？

我有一个解决方案，但它真的很难看，因为它看起来像我在复制代码。问题是我需要为文本和标签属性提取的值由数据库中的不同字段名称标识

所以对于书本级别，我需要获取 BookID 字段来填充我节点的标签属性；对于盒子级别，我需要获取 BoxID 字段来填充标签属性，....

我怎样才能做出一种通用的方式来做到这一点？

我希望我说得足够清楚，不要犹豫，问我问题:)

提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T11:44:41.140

这是我目前拥有的

我得到带有 linq (dbml) 请求的框列表。

```
List<Box> MyListofBox = getMyListofBox();
Treenode tnBox = null;
Treenode tnBook =null;
foreach(Box b in MyListofBox )
{
    tnBox = new TreeNode();
    tnBox.tag = b.BoxID;
    tnBox.text = b.BoxName;

    List<Book> MyListofBook = getMyListofBookByBoxID(b.BoxID)
    foreach(Book boo in MyListofBook )
    {
        tnBook = new TreeNode();
        tnBook.tag = boo.BookID;
        tnBook.text = boo.BookName;
        tnBox.nodes.add(tnBook);
    }
    mytreeview.nodes.add(tnBox);
} 
```

但我当然不喜欢这个解决方案......

你有更好的方法吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T11:31:04.917

我会以结构的形式从数据库中提取您需要的内容，可能是通过与 linq 一起添加到 C# 的匿名类型。然后我会将这些数据填充到树中的位置。

据我所知，您试图分别获取每个属性，这不会很好，因为您将不得不为每个单独的属性调用数据库，这是非常浪费的。

**根据您添加的内容添加**

我不相信代码可以更紧凑——你调用的名字是相似的，但不一样，你这样做的方式就是我之前试图解释的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T13:48:57.550

你可以

1.  定义一个 Box 和 Book 都实现的键/值接口
2.  定义一个返回 TreeNode 的委托并创建接受 Box 和 Book 的委托方法

但是，我认为代码写得很好。有时您只需要对其进行编码，进一步抽象或优化它就没有什么意义了。

我在代码中看到的唯一问题是您正在循环中进行数据库调用。这是否是一个问题取决于应用程序。

# search - 无法在 Vim 中搜索重复的句子

> ID：765254
> 
> 赞同：0
> 
> 时间：2009-04-19T11:23:07.243
> 
> 标签：search, vim

我在 Vim 的搜索模式下运行以下失败

```
^(\1) (\2) 
```

我试图在我的.vimrc 中找到两个第一个单词相同的行。

**你如何在 Vim 中搜索这些行？**

[在第一个答案后编辑]

我找到了方便的工具

```
:sort u 
```

**如何在命令之后比较我的第一个版本和后续版本？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T14:25:20.787

你有点模棱两可。

*   如果您想查找第二个单词与第一个单词重复的行，例如

    ```
      狗狗这条线
      狗猫不是这条线
      猫猫这条线
      猫狗不是这条线

    ```

    然后使用以下正则表达式：

    ```
      /^\s*\(\w\+\)\s\+\1

    ```

    第一个单词被 捕获，`\(\w\+\)`并由反向引用再次匹配`\1`

*   如果您想按前两个单词对行进行分组，例如

    ```
      aa 是“a a”组中的第一行
      ab 是“a b”组中的第一行
      ab 是“a b”组中的第二行
      -------------nogroup-------------
      ab 是“a b”组中的第三行
      bb 是“b b”组中的第一行
      ab 是“a b”组中的第四行
           bb 是“b b”组中的第二行

    ```

    然后`:sort`是你的朋友。但是，如果你只是运行`:sort`，你会得到这个：

    ```
           bb 是“b b”组中的第二行
      -------------nogroup-------------
      aa 是“a a”组中的第一行
      ab 是“a b”组中的第一行
      ab 是“a b”组中的第四行
      ab 是“a b”组中的第二行
      ab 是“a b”组中的第三行
      bb 是“b b”组中的第一行

    ```

    注意组 'a b' 中的第四行是如何放置在第一行之后的，而组 'b b' 中的第二行是先放置的，因为前导空格。这是因为`:sort`，默认情况下，使用整行。要使其仅按前两个单词排序，否则要保持顺序，请使用`:sort /^\s*\zs\w\+\s\+\w\+/ r`

    ```
      -------------nogroup-------------
      aa 是“a a”组中的第一行
      ab 是“a b”组中的第一行
      ab 是“a b”组中的第二行
      ab 是“a b”组中的第三行
      ab 是“a b”组中的第四行
      bb 是“b b”组中的第一行
           bb 是“b b”组中的第二行

    ```

    `^\s*\zs`告诉它忽略前导空格，并 告诉`\w\+\s\+\w\+`它使用前两个单词作为排序键。r 选项告诉`:sort`使用给定的模式作为排序键。有关更多信息，请参阅[:help :sort](http://vimdoc.sourceforge.net/htmldoc/change.html#sorting)。

    如果您想了解发生了什么变化，我可以想到两种策略来帮助您：
    *   您可以保存文件，对行进行排序，然后将副本另存为不同的名称，然后使用 vim 的内置 diff 功能来比较两者：

        ```
        :w                                  *"保存你的文件*
        :sort /^\s*\zs\w\+\s\+\w\+/ r       *"按前两个单词排序*
        :w %.sorted                         *"将排序后的版本保存在一个新的带有 .sorted 扩展名的文件*
        :undo                               *"撤消对原始文件的更改*
        :vs %.sorted                        *"在新窗口中打开排序后的版本*
        :windo diffthis                     *"比较两个版本*

        ```

        但是，这可能不会给您非常有用的反馈。

    *   可能会给您更有用的反馈是在排序之前插入行号，这样您就可以看到原始文件中的行号去了哪里。为此，请尝试以下操作：

        ```
        :%s/^/\=line('.') 。''
        :排序 /^\d\+\s*\zs\w\+\s\+\w\+/ r

        ```

        在每行的`%s/^/\=line('.') . ' '`开头插入行号。然后排序（稍作修改以忽略行号）就可以了。对于上面的示例，这会产生：

        ```
        4 -------------无组---------------
        1 aa 是“a a”组中的第一行
        2 ab 是“a b”组中的第一行
        3 ab 是“a b”组中的第二行
        5 ab 是“a b”组中的第三行
        7 ab 是“a b”组中的第四行
        6 bb 是 'b b' 组中的第一行
        8 bb 是 'b b' 组中的第二行

        ```

        所以现在你知道哪条线是从哪里来的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T11:29:31.567

你的意思是：[删除重复的行](http://vim.wikia.com/wiki/Uniq_-_Removing_duplicate_lines)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T11:52:59.327

我无法为此找到简短的 vim 样式解决方案。这就是为什么这里是 vim 脚本。

```
function! s:escape(line)
    return escape(a:line, '[]*')
endfunction

function! s:highlight_similar(pattern, extraction)
    let sorted = sort(getline(1, '$'))
    let matched_lines = {}

    let pattern = '^\s*\(\w\+\)\s\+\(\w\+\).*$'
    let previous_part = ''
    let previous_line = ''

    for i in range(0, line('$') - 1)
        let line = sorted[i]
        if line !~ a:pattern
            continue
        endif
        let part = substitute(line, a:pattern, a:extraction, '')
        if empty(part)
            continue
        endif
        if part == previous_part
            let matched_lines[s:escape(line)] = i
            let matched_lines[s:escape(previous_line)] = i
        else
            let previous_part = part
            let previous_line = line
        endif
    endfor
    let @/ = join(keys(matched_lines), '\|')
endfunction 
```

和命令定义应该在同一个文件中

```
command! -nargs=0 HighlightTwoWords
      \call <SID>highlight_similar('^\s*\(\w\+\)\s\+\(\w\+\).*$', '\1 \2')
command! -nargs=0 HighlightTwoRows
      \call <SID>highlight_similar('^\s*\(.*\)\s*$', '\1') 
```

然后在使用“HighlightTwoWords”命令后，您将能够使用“n”和“N”来移动您感兴趣的行。或者通过使用“hls[earch]”命令，您可以突出显示这些行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T14:15:18.530

你的意思是：找到前两个单词相同的任何一行？

试试这个：

/^(\w+) \1

或更一般地说

/^(\w+)\s\1

# php - PHP/MySQL：将数据插入数据库字符集问题

> ID：765255
> 
> 赞同：0
> 
> 时间：2009-04-19T11:25:59.030
> 
> 标签：php, mysql, character-encoding

我正在构建一个从另一个页面获取文本并将其插入数据库的网站。

问题是所有特殊字符都使用 HTML 编码保存在数据库中，所以我需要使用以下方法转换输出：

`<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" />`

我的意思是，我现在所拥有的不仅仅是保存字符“'”，`&#x27;`而是保存在数据库中的 html 版本“”。保存西班牙语字符或其他特殊字符时也会发生这种情况。代替 ejample 的字母“ñ”，我得到“ `&ntilde;`”保存。

这会浪费数据库中的空间，我还需要稍后使用 content-type 转换输出，所以：

如何在保存之前转换或设置字符集，或者让 MySQL 转换它？

如果您需要知道我如何连接到数据库：

```
function dbConnect() {      
    $conn = new mysqli(DB_SERVER, DB_USER, DB_PASSWORD, DB_NAME) or die ('Error.');
    return $conn;
}

    $conn = dbConnect();
    $stmt = $conn->stmt_init(); 
```

希望你能帮我！！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T11:36:02.050

您可以使用[`html_entity_decode()`](http://uk3.php.net/manual/en/function.html-entity-decode.php)将 HTML 转换为（真正的）字符编码。

```
<? echo html_entity_decode("&ntilde;", ENT_COMPAT, "UTF-8"); ?>
ñ 
```

请注意，“HTML”不是通常意义上的字符编码，因此诸如 之类的库`iconv`和 MySQL 本身都无法理解。

我还建议（根据上面的示例）让整个应用程序使用 UTF-8。既然 Unicode 得到如此广泛的支持，像 ISO8859 这样的单字符编码实际上已经过时了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T11:44:45.693

如果有任何非英文字符，我建议使用 UTF-8。您可以运行 SQL

```
SET NAMES UTF-8 
```

在您连接到 dbase 后以 UTF-8 建立您的 dbase 连接。

执行此操作时，不应在保存数据时使用“htmlspecialchars”或“htmlentities”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T11:41:06.513

也许您应该使用[`htmlspecialchars`](http://docs.php.net/htmlspecialchars)第[`htmlentities`](http://docs.php.net/htmlentities)一个只是替换 HTML 特殊字符`&`,`<`和`>`而`"`不是像后者一样由命名实体字符引用表示的每个字符。

# c++ - 我应该更喜欢迭代器而不是 const_iterators 吗？

> ID：765257
> 
> 赞同：27
> 
> 时间：2009-04-19T11:28:13.253
> 
> 标签：c++, stl, iterator, const-iterator

这里有人最近提到[了](https://stackoverflow.com/questions/755347/are-constiterators-faster/755371#755371)Scott Meyers 的文章说：

*   更喜欢`iterators`（[pdf链接](http://www.aristeia.com/Papers/CUJ%5FJune%5F2001.pdf)`const_iterators`）。

其他人评论说这篇文章可能已经过时了。我想知道你的意见是什么？

这是我的：这篇文章的主要观点之一是你不能在 a 上擦除或插入`const_iterator`，但我认为用它作为反对`const_iterators`. 我认为`const_iterators`它的全部意义在于您根本不修改范围，既不是通过替换它们的值来修改元素本身，也不是通过插入或擦除来修改范围。还是我错过了什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-19T11:34:32.177

我完全同意你的看法。我认为答案很简单：在 const 值是正确使用的地方使用 const_iterators，反之亦然。在我看来，那些反对 const_iterators 的人通常必须反对 const ......

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-19T15:31:53.230

这是一种稍微不同的看待它的方式。**当您将它作为指针传递给特定集合并且**您也在传递集合`Const_iterator`时，几乎没有任何意义。Meyer 先生特别指出不能与集合实例的大多数成员函数一起使用。在这种情况下，您将需要一个普通的. 但是，如果您没有集合的句柄，则两者之间的唯一区别是您可以修改an*指向*的内容，而不能修改 a 引用的对象。**`const_iterator``iterator`*`iterator``const_iterator`***

 ***`iterator`所以......当您将集合和位置传递给算法时，您想要使用该集合。基本上，签名如下：

```
void some_operation(std::vector<int>& vec, std::vector::const_iterator pos); 
```

没有多大意义。隐含的声明是`some_operation`可以自由修改底层集合但不允许修改什么`pos`引用。这没有多大意义。如果你真的想要这个，那么`pos`应该是一个偏移量而不是一个迭代器。

另一方面，STL 中的大多数算法都基于由一对迭代器指定的范围。`iterator`集合本身永远不会被传递，因此和之间的区别在于`const_iterator`集合中的值是否可以通过迭代器进行修改。没有对集合的引用，分离是非常清楚的。

希望这让事情变得像泥巴一样清晰；）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-19T11:40:16.720

我不认为需要特别关注迈耶的这一特殊陈述。当您想要一个非修改操作时，最好使用`const_iterator`. 否则，使用普通的`iterator`. 但是，请注意一件重要的事情：永远不要混合迭代器，即迭代器`const`与迭代器`non-const`。只要你知道后者，你应该没问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-10-12T21:57:22.900

我通常更喜欢 constness，但最近遇到了一个与 const_iterators 相关的难题，这混淆了我的“始终使用 const 是可能的”理念：

```
MyList::const_iterator find( const MyList & list, int identifier )
{
    // do some stuff to find identifier
    return retConstItor;
} 
```

由于传入 const 列表引用要求我只使用 const 迭代器，现在如果我使用 find，我无法对结果做任何事情，但查看它，即使我想要做的只是表示 find 不会改变列表通过了。

那么，我想知道 Scott Mayers 的建议是否与这样的问题有关，因为这些问题无法逃避 const-ness。据我了解，由于一些内部细节，您*不能（可靠地）使用简单的强制转换 un-const const_iterators。*这也（可能同时）是问题所在。

这可能是相关的：[How to remove constness of const_iterator?](https://stackoverflow.com/questions/765148/how-to-remove-constness-of-constiterator)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-08-22T19:25:32.873

## C++98

我认为需要考虑到 Meyers 声明指的是 c++98。今天很难说，但如果我没记错的话

*   为非 const 容器获取 const_iterator 根本不容易
*   如果你有一个 const_iterator 你几乎不可能使用它，因为容器成员函数的大多数（全部？）位置参数都应该是迭代器而不是 const_iterators

例如

```
std::vector<int> container; 
```

本来需要

```
static_cast<std::vector<int>::const_iterator>(container.begin()) 
```

得到一个 const_iterator，它会大大夸大一个简单的 .find ，即使你有你的结果之后

```
std::vector<int>::const_iterator i = std::find(static_cast<std::vector<int>::const_iterator>(container.begin()), static_cast<std::vector<int>::const_iterator>(container.end()),42); 
```

将无法使用您的 std::vector::const_iterator 插入到向量或任何其他预期位置迭代器的成员函数中。并且没有办法从 const 迭代器中获取迭代器。为此，不存在（存在？）铸造方法。

**因为 const iterator 并不意味着容器不能改变，而只是指向的元素不能改变（const iterator 相当于指向 const 的指针）**，在这种情况下真的是一大堆废话.

## 今天恰恰相反。

const 迭代器很容易使用 cbegin 等。即使对于非 const 容器和所有（？）占据位置的成员函数都有 const 迭代器作为它们的参数，因此不需要任何转换。

```
std::vector<int> container;                
auto i = std::find(container.cbegin(), container.cend(), 42); 
container.insert(i, 43); 
```

那么曾经是什么

> 更喜欢迭代器而不是 const_iterators

今天真的真的应该

> 更喜欢 const_iterators 而不是迭代器

因为第一个只是历史执行缺陷的产物。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-19T18:21:31.637

通过阅读该链接，Meyers 似乎从根本上说 interator 比 const_interator 更好，因为您无法通过 const_iterator 进行更改。

但如果这是他所说的，那么迈耶斯实际上是错误的。这正是为什么 const_iterator 比 iterator 更好的原因，因为这是您想要表达的。

# api - 开发 API：平衡新特性和向后兼容性

> ID：765264
> 
> 赞同：1
> 
> 时间：2009-04-19T11:30:58.787
> 
> 标签：api, compatibility, project-planning, specifications

我现在正在为我们产品**的开发人员功能开发 API 。**

第一个版本已经发布，目前用户数量很少。自从我开始开发它的第二个版本以来，一些部分被重新设计，一些部分被删除以使 API 更加优雅和清晰。

但是对于旧版本用户来说，第二版部署可能会很痛苦。我们的营销部门正计划大量增强我们的 API 产品，为其添加更多功能。

我应该如何构建系统，所以
**1）**我们不会受限于“旧版本”来添加新的有趣功能
**2）**当前的 API 用户不会因为需要重新设计他们的系统以符合要求而感到不满意更改后的 API

或者 API 产品是否应该在公开发布之前在沙盒中测试相当长的一段时间，这样规范就不会有任何重大修改？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T11:36:04.780

当您必须对已经有一些用户的 API 进行更改时，最好的方法可能是弃用旧的 API 调用并鼓励使用新的调用。

删除旧 API 调用的功能可能会破坏旧代码的功能，因此这可能会导致一些使用您的“旧”API 的开发人员变得有些不满意。

如果您的语言提供了指示某些功能已被弃用的方法，它可以作为用户停止使用旧 API 调用并转而使用新调用的指示。在 Java 中，[`@deprecated`javadoc 标记](http://java.sun.com/j2se/1.5.0/docs/guide/javadoc/deprecation/deprecation.html#javadoc_tag)可以在文档中提供已弃用功能的注释，或者从 Java 5 开始，[`@Deprecated`注释](http://java.sun.com/j2se/1.5.0/docs/guide/javadoc/deprecation/deprecation.html#annotation)可用于在调用已弃用的 API 功能时引发编译时警告。

此外，提供一些关于从旧 API 迁移到新 API 的提示和提示可能是一个好主意，以鼓励人们使用与 API 交互的新方式。有了关于做什么和不做什么的示例和示例代码，API 的用户将能够根据新的、首选的方式编写代码。

更改公共 API 将很困难，但在从旧到新的过渡过程中要小心，我相信它可以在一定程度上减轻 API 用户所承受的痛苦。

这是一篇关于[如何以及何时](http://java.sun.com/j2se/1.5.0/docs/guide/javadoc/deprecation/deprecation.html)从 Sun 弃用 API 的文章，该文章可能会提供更多关于何时适合弃用部分 API 的信息。

另外，感谢 David Schmitt，他补充说 .NET 中的[`Obsolete`属性](http://msdn.microsoft.com/en-us/library/system.obsoleteattribute.aspx)类似于`@Deprecated`Java 中的注解。（不幸的是，编辑被我的编辑覆盖了，因为我们都在同时编辑这个答案。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T11:36:45.993

这是您必须与您的社区达成的平衡：

*   将旧函数保留很久，你最终会得到 Win32 API（30000 个公共函数）吗？

*   一直重写 API，你会得到类似于 .NET 的东西，新版本每隔一段时间就会发布（1.0、2.0、3.0、3.5...）并破坏现有程序或引入新的和改进的做事方式用户界面等）

如果社区能够容忍变化并愿意进行试验，那么您将努力争取精简、最新的 API，并且知道会导致一些损坏，也就是有点腐烂。另一方面，如果社区有大量遗留代码并且没有资源或不希望将其升级到最新版本，那么您必须保持向后兼容性，否则他们的所有东西都无法在新 API 上运行。

* * *

请注意其他答案之一：弃用 API 是一种常用的方式来指示哪些函数“即将退出”，但只要它们有效，许多开发人员甚至会在新代码中使用它们，因为这些是函数他们习惯了。很少有开明的开发人员既能意识到实际注意“已弃用”警告，又能有时间在代码中搜索旧 API 的其他实例并更新它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T11:38:13.387

微软以其疯狂的向后兼容性而闻名。他们所做的一件事是保留所有旧的过时调用，然后添加新的调用，新程序可以使用这些调用来访问它们无法在旧 API 中使用的增强功能。

您没有指定使用哪种编程语言，但 .NET 和 Java 都具有将某些 API 调用标记为过时的机制。如果向后兼容性对您非常重要，您可能希望采用相同的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T11:42:20.473

向后兼容性应该是默认设置。您应该妥协这一原则的唯一原因是当 API 不安全时，它会迫使用户更改为更安全的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T11:42:38.103

写入原始 API 的理想应用程序将继续与新版本一起使用。

添加新功能同时确保旧应用程序继续运行的一种方法是使用两个版本的 API 调用。

例如，假设您当前有一个函数**Foo**，它在 API 中采用 2 个参数（参数），但您决定新版本确实应该采用 3 个参数。保持**Foo**的原样并添加一个新的函数**Foo2**，它接受 3 个参数。

这样，用户可以继续针对**Foo**进行编码以实现向后兼容性，或者在需要新功能时使用新的**Foo2函数。**

这种技术已被 Microsoft 普遍用于 Windows API。

# security - 修改 LDAP 模式以支持 Cardspace 和 OpenID

> ID：765273
> 
> 赞同：2
> 
> 时间：2009-04-19T11:40:13.990
> 
> 标签：security, authentication, openid, ldap, cardspace

我正在寻找其他人如何修改 LDAP 模式以支持 Cardspace 和/或 OpenID 的示例。非常感谢 LDIF 或其他文档的链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T09:03:59.487

在没有完成 LDAP-InfoCard-OpenID-integration 的情况下，我认为修改 LDAP 模式以合并所需信息并不困难。

对于 OpenID，您必须存储 OpenID，而对于识别 InfoCard 授权的用户，您必须将相应 InfoCard 的私有个人标识符 (PPID) 存储在 LDAP 用户对象中。

由于 OpenID 只是一个 URI，因此 LDAP 属性的类型可以与例如`labeledURI`（目录字符串 (1.3.6.1.4.1.1466.115.121.1.15)、caseExactMatch (2.5.13.5)）的类型相同。

InfoCard 私人个人标识符 (PPID) 是一个 base64 编码的字节数组（长度未定义，因此您应该需要一个适当的最大长度；只是一个猜测，但我认为 48 个字符就足够了，因为 PPID 是一个 SHA256 散列与 32 bytes 和 base64 编码将需要大约 1.3 倍的存储空间），因此您可以使用`IA5 String`.

# asp.net - 错误站点地图

> ID：765278
> 
> 赞同：0
> 
> 时间：2009-04-19T11:43:08.273
> 
> 标签：asp.net, sitemappath

当我 SiteMapPath 和配置 whit siteMap 时，这个错误是什么。当然，当我上传我的网站时，我显示这个错误：“找不到页面

## 您要查找的页面可能已被删除、名称已更改或暂时不可用。

请尝试以下方法：

确保浏览器地址栏中显示的网站地址拼写和格式正确。如果您通过单击链接访问此页面，请联系网站管理员以提醒他们该链接的格式不正确。单击“返回”按钮尝试另一个链接。HTTP 错误 404 - 找不到文件或目录。Internet 信息服务 (IIS) “我该怎么做才能使 SiteMap 正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T12:39:17.593

这是一个关键问题，可以尝试：

## 该网站是否可以在您的开发机器上运行？

1.  如果它确实有效，则检查站点地图中页面的 url。如果 SiteMap 中页面的 URL 引用了诸如“ **C:\mySite\MyPage.aspx** ”之类的物理目录，那么这是最可能的原因。您希望确保 URL 通过像“ **~/MyPage.aspx** ”这样的相对路径引用页面位置。

2.  如果它不起作用，则验证 URLS 中没有输入错误。一旦你使用相对路径让它在本地开发环境中工作，那么它在远程机器上工作的机会应该会大大增加。

# tomcat - 使用 Apache HTTP 实例支持 Tomcat 的最简单方法

> ID：765284
> 
> 赞同：3
> 
> 时间：2009-04-19T11:47:37.340
> 
> 标签：tomcat, apache, cluster-computing, failover

我有一个 Tomcat 6 实例，由于多次 WAR 部署后的 PermGen 问题，该实例经常需要重新启动。

在生产环境中，关闭站点显然是不好的做法，只会让任何访问者连接失败。大局是设置一个或两个以上实例的故障转移 Tomcat 集群，但现在我想要一个简单的解决方案：

当 Tomcat 关闭时，所有请求都被转发到运行 1 个简单的“站点正在维护”类型页面的 Apache HTTP 服务器。

我假设我需要一些小型、超快速的代理来坐在 Tomcat 前面，为它提供请求并监控它的运行状况。如果它死了，它只是将这些请求发送到 Apache HTTP。

想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T12:13:42.863

您通常可以在安装 tomcat 之前使用 Apache。为您的 tomcat 设置重定向代理规则。如果这不起作用，apache 将发送一个“503 服务暂时不可用”，您可以将其配置为您的维护页面。

apache 应用程序文件看起来有点像这样

```
<VirtualHost *>
    ServerName example.com
    ServerAlias *.example.com
    ServerAdmin admin@example.com

    RewriteEngine on
    RewriteRule ^/static/(.*) /some/path/for/static/files/static/$1 [L]
    RewriteRule ^(.*) http://127.0.0.1:8080$1 [P]

    ErrorLog /var/log/apache2/example/error.log

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel warn

    CustomLog /var/log/apache2/example/access.log combined
    ServerSignature On

    ErrorDocument 503 /static/site_down.html
</VirtualHost> 
```

第一个重写规则将某个 URI ( /static/ ) 下的所有文件更改为一个目录，从该目录中直接提供这些静态文件而无需代理。您也可以使用它来提供来自您网站的所有静态资源，这在一定程度上弥补了在您的 Tomcat 前安装 apache 的一般（小）性能损失。

ErrorDocument 指令将正常的 503 响应更改为位于此静态路径中的文档 site_down.html。

为此，您需要启用 mod_rewrite 和 mod_proxy/mod_proxy_http 并在 apache2 配置中启用代理

```
<Proxy *>
        Order Deny,Allow
        Deny from all
        Allow from all
</Proxy> 
```

# c# - .NET 2.0/3.5 中的 SerialPort 内存泄漏

> ID：765285
> 
> 赞同：-1
> 
> 时间：2009-04-19T11:48:09.540
> 
> 标签：c#, .net, memory-leaks, serial-port

我`SerialPort`上课有问题。

我们在通用列表中使用多个串行端口，因为我们需要连接到多个设备。

这是我们的基本代码的样子：

```
List<SerialPort> ports = new List<SerialPort>();
private void button1_Click(object sender, EventArgs e)
{
    ports.Add(new SerialPort("COM6"));
    ports.Add(new SerialPort("COM7"));
    ports.Add(new SerialPort("COM8"));
    foreach (SerialPort port in ports)
    {
        port.Open();
    }
} 
```

现在，点击按钮后，如果其中一个设备（在我们的例子中是手机）被关闭，或者它的电缆从 USB 端口断开，就会立即出现大量内存泄漏。

我注意到[这里](http://www.experts-exchange.com/Prog..._23315204.html)有一个类似的线程和 Microsoft Connect 中的几个错误报告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T15:43:57.447

您确定问题`SerialPort`出在 USB 串行设备的驱动程序上，而不是驱动程序上吗？我会尝试另一个测试来验证这个问题：

1.  启动`hyperterm`
2.  连接到您的问题设备
3.  检查内存使用情况
4.  以与 C# 中导致问题相同的方式断开连接
5.  检查内存使用情况并进行比较

如果它没有发生，那么特别是有一个错误`SerialPort`。`SerialPort`如果它再次发生，您至少会知道它与' 的实现无关。问题可能出在 Window 的 COM 端口代码或您正在使用的驱动程序中。就个人而言，我发现问题可能出在驱动程序中的可能性更大，但我很想知道 Window 的串行端口是否存在一些未知问题。

我`SerialPort`以前在连接/断开端口时使用过，没有任何此类问题。

您可以尝试的另一件事是调试 CLR 的代码。[关于这个主题](https://stackoverflow.com/questions/378498/can-i-reflector-the-net-base-class-libraries-bcl)还有很多其他的 SO 问题，所以应该很容易找到这样做的方法。这应该让您进一步调试，并准确查看`Open()`内存泄漏发生的时间点。不过警告，因为它是系统串行端口的“简单”包装器，您可能很快就会看到它进入 P/Invoke 世界，而且可能看不到太多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T11:51:13.963

不确定问题是否如此简单，但您`SerialPort`是否正确处理对象？完成后，您需要`Dispose`在每个实例上调用该方法。

# jquery - 卡住使用 jQuery UI 选项卡

> ID：765300
> 
> 赞同：1
> 
> 时间：2009-04-19T11:59:19.387
> 
> 标签：jquery, ajax, jquery-ui, tabs, jquery-ui-tabs

我有三个要放入选项卡的 html 表。

所有三个表都可以加载，`AJAX`但我想显示第一个表，并且还允许第一个表是 ajaxable。

最后，我需要让用户在第三个选项卡中进行搜索，这些结果（html 结果）进入该选项卡。

**问题是：当我运行我当前的代码时，它不允许我单击选项卡（它在 FireFox 中显示了一些丑陋的样式）并且只显示了第三个选项卡。**

这是以前。

```
<h2>Title 1</h2>
<table>....data_A....</table>
<br/><br/>

<h2>Title 2</h2>
<table>....data_A....</table>
<br/><br/>

<h2>Title 3 - Search</h2>
<input id="name" type="textbox" />
<input id="search" type="submit" value="Search" />    
<br/><br/> 
```

这是我的 jQuery 尝试代码。

```
<asp:Content ContentPlaceHolderID="JavaScriptContent" runat="server">
<link type="text/css" href="../../Content/smoothness/jquery-ui-1.7.1.custom.css" rel="Stylesheet" />

<script src="/Scripts/jquery-1.3.2.min.js" type="text/javascript"></script> 
<script src="/Scripts/jquery-ui-1.7.1.custom.min.js" type="text/javascript"></script> 
<SCRIPT type=text/javascript>
    $(function() {
        $("#tabs").tabs();
    });
</SCRIPT>
</asp:Content>

<asp:Content ID="indexContent" ContentPlaceHolderID="MainContent" runat="server">

<div id="tabs">
    <ul>
        <li href="ajax/data_a">Title 1</li>
        <li href="ajax/data_b">Title 2</li>
        <li href="#tab-3">Search</li>
    </ul>
    <div id="tab-1">
        .... data_A table is put here ... 
        .... but will be updated via ajax when the tabs is clicked.
    </div>        
    <div id="tab-3">
        <input id="name" type="textbox" />
        <input id="search" type="submit" value="Search" />    
    </div>
</div>
</asp:Content> 
```

谁能帮我？我做错了什么？

加油：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T12:19:56.220

您必须在's中有一个`a`标签。没有这个属性。`li``li``href`

```
<li><a href="ajax/data_a">Title 1</a></li>
<li><a href="ajax/data_b">Title 2</a></li>
<li><a href="#tab-3">Search</a></li> 
```

就在这里的来源：http: [//stilbuero.de/jquery/tabs_3/](http://stilbuero.de/jquery/tabs_3/)

# c++ - 我应该拒绝 C++，因为它正在成为一个主宰吗？

> ID：765301
> 
> 赞同：21
> 
> 时间：2009-04-19T12:00:07.030
> 
> 标签：c++, programming-languages, c++11

自从他们推出 1998 年 ANSI/ISO C++ 以来，我一直试图跟上 C++ 的步伐。我吸收了新概念并试图理解它们。我学习了异常处理、模板和命名空间。我已经阅读了新的演员机制并使用了 STL 库。

所有这些概念都需要大量的精力。[但是现在看到新的C++0x](http://en.wikipedia.org/wiki/C%2B%2B0x)标准时，我有点担心 C++ 的未来。

事情变得越来越复杂。这种语言正在变成怪物。

我不确定我是否想再跟上这门语言的步伐，因为无论如何我都不会在 C++ 中进行日常黑客攻击。我主要使用解释或字节码语言。

那么我为什么要费心去学习这种困难但又异常强大的语言呢？我可以用 Python 等完成 95% 的业务。剩下的 5%，我可以毫不费力地处理普通的旧 C++ 或 C。

你怎么看？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-19T12:14:04.983

***每个人都***使用 C++ 的一个子集。对于 C++ 中的几乎所有应用程序编程，无论是服务器端还是客户端，该子集都是可管理的。在我看来，唯一需要完全掌握语言每一个细微差别的人是库作者——实现 Boost、STL、Loki 等的人。

但我绝对会使用适合任务的语言。如果 Python 在您的工作中比 C++ 更具可读性和可维护性，并且您不需要 C++ 提供的功能，那么一定要坚持使用 Python。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-04-19T13:15:18.160

听听 Bruce Eckel { 两本**所谓的**最佳[C++ 书籍](http://www.google.com/url?sa=t&source=web&ct=res&cd=8&url=http%3A%2F%2Fwww.mindview.net%2FBooks%2FTICPP%2FThinkingInCPP2e.html&ei=7R_rSbTDEoyJsAbyvZyOBw&usg=AFQjCNH76VGwE3vo7pXHye_fXySGioXihQ)的作者}几周前[对 C++ 的评论：](http://www.artima.com/weblogs/viewpost.jsp?thread=252441)

> 也就是说，我几乎不再使用 C++。当我这样做时，要么检查遗留代码，要么编写性能关键部分，通常尽可能小以从其他代码调用（我的首选方法是用 Python 快速编写应用程序，然后对其进行分析，并在必要时提高性能通过使用 Python 的 ctypes 库调用 C++ 的一小部分）。
> 
> 因为我是 C++ 标准委员会的成员，所以我看到了做出这些决定。它们都经过了极其仔细的考虑，远远超过了 Java 中做出的许多决定。
> 
> 然而，正如人们正确指出的那样，**由此产生的语言使用起来既复杂又痛苦，并且充满了奇怪的规则，一旦我离开它一段时间，我就会忘记**这些规则——我从第一原理中找出了这些规则当我写书时，不仅仅是通过记忆它们。

此外，您应该阅读[此线程](https://stackoverflow.com/questions/352113/what-is-the-future-of-c-language-developers/)和[Danny Kalev 对 C++ 的预测](https://stackoverflow.com/questions/352113/what-is-the-future-of-c-language-developers/518222#518222)。

**然而，C++ 日益增长的复杂性将产生将语言拆分为准官方方言的压力。我们今天已经可以看到这种趋势；未来可能会加剧。**

**编辑**：

你也应该看看这个讨论：

[C++ - 有没有人觉得 C++ 太复杂了？](http://www.velocityreviews.com/forums/t676282-anyone-else-feel-like-c-is-getting-too-complicated.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-19T12:27:12.160

首先，C++0x 的许多特性是为了让语言更易于使用。更易读的模板编译错误，更一致的初始化语法，对线程的支持，否则必须依赖于特定平台的库等等。

因此，如果您确实使用 C++，我觉得学习 C++0x 的重要部分应该是一项易于管理的任务。请记住，您无需学习所有新功能即可使用该语言。一些特性主要是作为对库实现者的帮助而添加的，例如允许更有效地实现 STL，但这不应该真正影响最终用户对该语言的使用。有些仅在极少数情况下才真正需要。忽略语言的那些部分。

他们对 C++0x 的既定目标之一是*避免*它变得更难使用。

但除此之外，*你*还需要 C++ 吗？如果您使用其他语言进行编码，为什么还要跟上 C++ 的步伐？

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-19T12:13:46.357

您不必使用语言提供的*所有功能。*我不在 C 中使用 setjmp/longjmp，尽管它在那里。我也没有使用 Java 集合的各个方面。

如果您认为新功能将使您的代码交付更好（更快或更高质量或两者兼而有之），请使用它们。否则忽略它们。

如果只是为了让你通过工作面试，从高层次上了解它们都是有用的，但在我看来，它们添加到语言中的一半是不必要的。

在切换到 Java 之前，我什至从未使用过 C++ 模板，但我知道它们的用途。

这并不总是关于学习最新和最伟大的。软件（至少在你的工作中）是关于产品的交付。如果你足够精通的话，这可以在 COBOL 或 FORTRAN 中完成。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-19T15:00:41.277

除了 Bjarne 和 Herb Sutter 之外，没有人知道所有的 C++。正如你所说，这是一种非常庞大的语言。期望能够采用整个标准+特定编译器的特定实现细节是不现实的。

但是你不需要知道一切才能使用 C++。相反，只学习对您和您的项目有价值的 C++ 子集。不断扩展您的知识并没有什么坏处，但除非您正在编写 C++ 编译器，否则没有理由了解全部内容。即使你完成了它，与你一起工作的所有人都不会。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-19T17:48:55.303

> 那么我为什么要费心去学习这种困难但又异常强大的语言呢？我可以用 python 等完成 95% 的业务。剩下的 5%，我可以毫不费力地处理普通的旧 C++ 或 C。

好吧，在大多数情况下，您会回答自己的问题。此时，您无需紧跟 C++ 的前沿。

然而，语言将继续前进。几年后，您认为今天最前沿浪费时间的一些概念将被普遍使用。有一天，您可能会发现在您使用“普通 C++”的 5% 期间，某些示例代码或您正在协作的代码使用了您不熟悉的构造。那时，您需要上网并复习新的“当前”C++。

这会是个问题吗？当然不是。你是程序员。您在 95% 的语言环境中了解最新的编程概念，这也会随着时间而变化。您可能已经非常熟悉这些概念，并且只需要在必须使用它们的时候熟悉它的 C++ 语法。

就我个人而言，我希望继续跟上 C++ 的步伐，即使我的职业生涯更多地转向 Java 或另一种下一代语言。为什么？我想说是因为它最让我感兴趣，因为我喜欢它的复杂性和表现力。不过，更有可能只是因为它是我的第一门专业语言。我认为这是我的“母语”。

如果您不感兴趣，并且与您的工作或未来工作无关，请不要打扰。那有什么问题？没有。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-19T12:24:48.330

很好的答案。

计算机制造商争夺买家，软件争夺您的磁盘空间，语言争夺用户。他们通过试图抓住彼此的特征来做到这一点。

我想知道多久我们才能看到 Fortran 推出 lambda 表达式 :-)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-07-31T14:44:01.747

我很难找到一个 C++0x 比 C++98 更复杂的实例。有两件事*确实*很复杂：

1.  概念。
2.  记忆模型

但是第一个已被再次删除（谢天谢地；标准化未实现的功能从未在 C++ 中实现过，见证抛出规范、外部模板、auto_ptr ......），第二个并不是现代编程语言可以逃脱的东西. 它是由 Intel & Co 外部诱导的，有助于破坏您的程序以使其运行得更快。

其余的只是解决每个 C++ 程序员在过去几十年中经常遇到的烦恼。

作为旁注：我觉得它......很有趣......看看像 C# 这样的语言是如何与数据库查询语言 (LINQ) 打包在一起的，而 C++ 被认为是臃肿的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-19T12:04:12.030

您无需了解所有背诵出来的标准。不过，它确实有助于了解大局。您编写代码的 5% 可能会让您重新发明偶尔的轮子。根据您需要接听电话的时间、5% 的重要性（想想帕累托）。

另外，有什么特殊原因（比如遗留代码依赖）为什么你不能把这 5% 转移到 python 上？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-19T12:55:13.047

首先尝试参加有关 c++0x 的课程并让您的公司为此付费：) 我们的大脑可以容纳大量的垃圾知识。我们应该首先向程序用户学习并听取其他人的意见/诀窍，而不是诅咒和拥有程序员的时刻。以这种方式，知识传输得更快。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-19T12:16:04.700

我的建议是学习 c++0x ( && FTW) 的新关键字，但不要费心尝试学习整个库。将 python 用于你想要的 w/e，可能 C# 用于应用程序，然后在你需要做一些强大的事情时使用 C++(0x)。并在原型设计时询问 stackoverflow 和谷歌关于新容器的信息。

您不需要使用少数几种语言，

# django - 不同的 ManyToManyField 小部件

> ID：765302
> 
> 赞同：1
> 
> 时间：2009-04-19T12:00:28.950
> 
> 标签：django, django-models, django-forms

The default django 1.0.2 ManyToManyField widget (a multi-select) is difficult to use when there are a lot of things in the select box. 是否有另一个可用的小部件在文本区域中提供逗号分隔的 id 列表？如果这不可用，我需要做什么来编写一个，并让它显示在 ModelForm.as_p() 和管理站点中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T19:57:56.990

如果没有现有的小部件可以满足您的需求（而且我认为没有），那么您需要编写自己的小部件。不幸的是，Django 文档没有向您展示如何执行此操作，但通过查看源代码`forms/widgets.py`复制现有小部件并对其进行修改并不难弄清楚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T16:50:44.623

我相信在 manytomanyfield 上设置 raw_id_fields 实际上会输出一个带有逗号分隔的 id 列表的 TextInput 小部件。您可以在 admin.py 中的相应 ModelForm 中覆盖它，并在其上强制使用 TextArea 小部件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T12:29:44.323

在管理员中，您可以使用 **过滤器水平**和/或**过滤器垂直**：

```
class MyModelAdmin(admin.ModelAdmin):
    filter_horizontal = ['many_to_many_field_name']
    filter_horizontal = ['another_many_to_many_field_name'] 
```

[文档](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.filter_horizontal)

# python - python中的代理检查

> ID：765305
> 
> 赞同：19
> 
> 时间：2009-04-19T12:01:51.427
> 
> 标签：python, http, proxy

我在 python 中编写了一个使用 cookie 和 POST/GET 的脚本。我还在我的脚本中加入了代理支持。但是，当一个人进入一个死代理时，脚本会崩溃。在运行我的脚本的其余部分之前，有什么方法可以检查代理是否死/活？

此外，我注意到一些代理不能正确处理 cookie/POST 标头。有没有什么办法解决这一问题？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-19T13:41:40.327

最简单的方法是简单地从 urllib 中捕获 IOError 异常：

```
try:
    urllib.urlopen(
        "http://example.com",
        proxies={'http':'http://example.com:8080'}
    )
except IOError:
    print "Connection error! (Check proxy)"
else:
    print "All was fine" 
```

此外，来自[这篇博文 - “检查状态代理地址”](http://love-python.blogspot.com/2008/07/check-status-proxy-address.html)（有一些轻微的改进）：

**对于蟒蛇 2**

```
import urllib2
import socket

def is_bad_proxy(pip):    
    try:
        proxy_handler = urllib2.ProxyHandler({'http': pip})
        opener = urllib2.build_opener(proxy_handler)
        opener.addheaders = [('User-agent', 'Mozilla/5.0')]
        urllib2.install_opener(opener)
        req=urllib2.Request('http://www.example.com')  # change the URL to test here
        sock=urllib2.urlopen(req)
    except urllib2.HTTPError, e:
        print 'Error code: ', e.code
        return e.code
    except Exception, detail:
        print "ERROR:", detail
        return True
    return False

def main():
    socket.setdefaulttimeout(120)

    # two sample proxy IPs
    proxyList = ['125.76.226.9:80', '213.55.87.162:6588']

    for currentProxy in proxyList:
        if is_bad_proxy(currentProxy):
            print "Bad Proxy %s" % (currentProxy)
        else:
            print "%s is working" % (currentProxy)

if __name__ == '__main__':
    main() 
```

**对于蟒蛇 3**

```
import urllib.request
import socket
import urllib.error

def is_bad_proxy(pip):    
    try:
        proxy_handler = urllib.request.ProxyHandler({'http': pip})
        opener = urllib.request.build_opener(proxy_handler)
        opener.addheaders = [('User-agent', 'Mozilla/5.0')]
        urllib.request.install_opener(opener)
        req=urllib.request.Request('http://www.example.com')  # change the URL to test here
        sock=urllib.request.urlopen(req)
    except urllib.error.HTTPError as e:
        print('Error code: ', e.code)
        return e.code
    except Exception as detail:
        print("ERROR:", detail)
        return True
    return False

def main():
    socket.setdefaulttimeout(120)

    # two sample proxy IPs
    proxyList = ['125.76.226.9:80', '25.176.126.9:80']

    for currentProxy in proxyList:
        if is_bad_proxy(currentProxy):
            print("Bad Proxy %s" % (currentProxy))
        else:
            print("%s is working" % (currentProxy))

if __name__ == '__main__':
    main() 
```

请记住，如果代理关闭（因为您将不得不等待两次连接超时），这可能会使脚本花费的时间加倍。除非您特别需要知道代理有问题，否则处理 IOError 会更干净、更简单而且更快..

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-06-15T08:20:53.180

您可以使用像这样简单的 Proxy-checker 库

```
from proxy_checker import ProxyChecker

checker = ProxyChecker()
checker.check_proxy('<ip>:<port>') 
```

输出 ：

```
{
  "country": "United States",
  "country_code": "US",
  "protocols": [
  "socks4",
  "socks5"
  ],
  "anonymity": "Elite",
  "timeout": 1649
} 
```

可以生成自己的代理并用两行代码检查它们

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-20T23:10:29.557

我认为更好的方法就像 dbr 所说的那样，处理异常。

在某些情况下可能更好的另一种解决方案是使用外部**[在线代理检查器](http://proxyipchecker.com/)**工具来检查代理服务器是否处于活动状态，然后继续使用您的脚本而不进行任何修改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2022-01-09T14:34:07.133

您可以使用 ip-getter 网站获取您发送请求的 IP，然后检查该 IP 是否与您的代理 IP 或其他内容相同。这是一个关于这个问题的脚本：

```
import requests

proxy_ip = "<IP>"
proxy_port = "<PORT>"
proxy_user = "<USERNAME>"
proxy_pass = "<PASSWORD>"

proxies = {
    "http": f"http://{proxy_user}:{proxy_pass}@{proxy_ip}:{proxy_port}/",
    "https": f"http://{proxy_user}:{proxy_pass}@{proxy_ip}:{proxy_port}/"
}

url = 'https://api.ipify.org'

try:
    response = requests.get(url, proxies=proxies)
    assert response.text==proxy_ip
except:
    print("Proxy does not work") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-05T21:55:17.187

有一个不错的包[Grab](http://docs.grablib.org/) 所以，如果它适合你，你可以写这样的东西（简单有效的代理检查器生成器）：

```
from grab import Grab, GrabError

def get_valid_proxy(proxy_list): #format of items e.g. '128.2.198.188:3124'
    g = Grab()
    for proxy in proxy_list:
        g.setup(proxy=proxy, proxy_type='http', connect_timeout=5, timeout=5)
        try:
            g.go('google.com')
        except GrabError:
            #logging.info("Test error")
            pass
        else:
            yield proxy 
```

# iphone - 是否可以在我的电脑显示器上显示我的 iPhone？

> ID：765314
> 
> 赞同：14
> 
> 时间：2009-04-19T12:08:24.017
> 
> 标签：iphone, external-display

正如标题所说，这可能吗？我想在 iPhone 上“镜像”我的行为，以便它显示在电脑显示器上。

我们已经在 Apple 的重要说明中看到了这一点，但我不确定这个功能是否是公开的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T13:03:21.387

许多显示 iPhone 应用程序的截屏视频仅使用 iPhone 模拟器，这是一种选择。

您还可以通过同时快速按下菜单和电源/睡眠按钮在手机上进行屏幕截图。然后将图像保存到您的“相机胶卷”并轻松传输到计算机

另一种方式只能使用越狱手机 - [Veency](http://www.tuaw.com/2008/09/18/veency-vnc-server-for-iphone/)是 iPhone 的 VNC 服务器，您可以使用常规 VNC 客户端连接到该服务器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T02:23:27.470

最新的 SDK（我相信从 2.2 开始）包括 TV-Out 功能。使用连接到 iPhone 底座连接器的特殊电缆，程序可以通过 iPhone->RCA 电缆发送代表其当前屏幕内容的 RCA 信号。如果您的计算机有一个带有 RCA 输入的电视调谐器（即我有一个 EyeTV Hybrid），您可以直接在电视查看器中显示 iPhone 的屏幕内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-19T17:45:42.907

在越狱的 iphone/ipod touch 上使用分屏器它可以工作

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T13:08:58.970

如果您的 iPhone 已越狱，您可以使用[DemoGod](http://www.plutinosoft.com/blog/projects/demogod)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-20T13:54:43.083

发行说明[iOS 3.2（外部显示器支持）](http://developer.apple.com/iphone/library/releasenotes/General/WhatsNewIniPhoneOS/Articles/iPhoneOS3_2.html#//apple_ref/doc/uid/TP40009337-SW1)和[iOS 4.0（继承改进）](http://developer.apple.com/iphone/library/releasenotes/General/WhatsNewIniPhoneOS/Articles/iPhoneOS4.html#//apple_ref/doc/uid/TP40009559-SW1)提到应该可以将外部显示器连接到 iOS 4.0 设备。
但是，如果您要镜像您的 iPhone 屏幕，您仍然必须越狱......
[相关的 SO 问题与更新](https://stackoverflow.com/questions/3289147/how-to-display-my-iphone-on-a-projector)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-14T07:45:56.893

我希望这会有所帮助。还没试过，等我试了再发。

[http://blog.appideas.net/using-iphone-video-output-to-demo-your-apps-o](http://blog.appideas.net/using-iphone-video-output-to-demo-your-apps-o)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-30T13:10:26.740

这是一个可以帮助您的工具，我自己安装了它

这是[链接](http://learninginhand.com/blog/2013/3/13/mirror-ipad-iphone-ipod-to-your-screen-for-free)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-12-20T10:31:24.197

难道我们没有一个应用程序可以从 iPhone 或 iPad 等 iOS 设备流式传输数字电影，以便在高清 LED 或等离子电视上播放？

我知道一个应用程序空气视频服务器，可用于在 iOS 设备上显示在计算机或笔记本电脑上播放的内容。但是有没有任何应用程序可以反向播放从 iphone 到 LED 电视的数字内容。

# java - 用于开发多线程网络应用程序的 IDE 插件

> ID：765327
> 
> 赞同：3
> 
> 时间：2009-04-19T12:24:10.967
> 
> 标签：java, multithreading, netbeans, eclipse-plugin, network-programming

我正在寻找一个插件，它可以帮助开发人员创建与 Eclipse 和/或 Netbeans 一起使用的多线程网络应用程序。应该允许以下功能：

*   回调的图形建模
*   配置执行器
*   创建自定义 SSL 工厂
*   用于创建各种过滤器流的向导

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T01:56:58.510

框架呢？JBoss Netty ( [http://www.jboss.org/netty/](http://www.jboss.org/netty/) ) 和 Apache MINA ( [http://mina.apache.org/](http://mina.apache.org/) ) 在功能上非常相似，并且都有助于您提到的各种事情。至于 IDE 插件，我什么都不知道，只是怀疑这样一个工具的价值。

# ruby-on-rails - 对于具有动态标题的大部分静态页面，最好的 Rails 缓存选项是什么

> ID：765329
> 
> 赞同：2
> 
> 时间：2009-04-19T12:25:36.937
> 
> 标签：ruby-on-rails, caching, layout, header

我有一组基本上是静态的页面，除了它们的布局包含更动态的标题之外，我很乐意在相对较长的时间内进行页面缓存。

到目前为止，最有前途的想法似乎是使用没有布局的动作缓存：-

```
class SomethingController < ApplicationController

  caches_action :index, :layout => false

end 
```

然后至少缓存页面的主要内容。那有意义吗？

还是我最好做些别的事情，例如片段缓存、服务器端包含等等……？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T14:51:03.890

我所做的是使用页面缓存，然后进行 AJAX 调用以获取：

1.  整个标题。
2.  标头中动态的特定部分。

此外，如果您只是想包含用户名，则存在更好的方法。只需将他们的名字存储在 cookie 中，然后使用 javascript 将其显示在标题中。如果没有 cookie，请显示一个链接以登录或注册。

# c - 使用 gcc 在共享库中传播“-g”

> ID：765331
> 
> 赞同：0
> 
> 时间：2009-04-19T12:27:17.167
> 
> 标签：c, linker, gdb, debug-symbols

我有一个程序`abc`。 `abc`使用该库`def`，`def`进而包含一个库`ghi`。

现在，`libghi.so`使用`gcc -g`. `libdef.so`也使用. *_* `gcc -g`但是，`abc` *不*与`-g`.

问题是，如果我使用调试`abc`，`gdb`我应该能够看到和中的符号`def`吗`ghi`？

该项目非常大，编译需要几个小时，这就是为什么我在自己测试之前询问的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T12:36:57.737

是的，您将能够，尽管如果没有调用应用程序中的调试信息，使用它们可能会有点困难。

# .net - 如何监控和编辑共享主机服务器上的图像？

> ID：765333
> 
> 赞同：0
> 
> 时间：2009-04-19T12:29:27.757
> 
> 标签：.net, web-applications, hosting

只是想要关于如何思考和执行以下操作的建议，
我正在创建一个网站，用户将在他的个人资料“图像大小”上设置一些设置，然后使用这些设置我希望他指向他的服务器和我的服务上的一个文件夹将监视并在此文件夹中上传任何图像我将根据他保存的设置重新调整大小

我首先想到让用户下载一个 dll 文件然后上传到这个文件夹中，它将处理调整大小，但是 dll 不是自运行的问题，并且用户必须调用它，所以它对某些用户来说很棘手，也不适用于非 Windows 托管网站。
我也想过在网络服务中，但这将花费大量时间和带宽来发送图像并再次接收。

任何想法如何做到这一点？
我的网站是用 asp.net 3.5 编码的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T12:39:54.003

共享主机将使这成为一个难以解决的问题。如果您有更多的控制权，您可以编写一个 Windows 服务来监视这些文件夹并重新调整大小。我认为您最好的选择是让用户通过您的应用程序上传，然后在将图像保存到文件夹之前调整图像大小。

# c# - 快速的本地数据库

> ID：765335
> 
> 赞同：7
> 
> 时间：2009-04-19T12:29:38.347
> 
> 标签：c#, database, caching

我有一个桌面应用程序可以与服务器对话肥皂。通信速度很慢，所以我想预先下载大量数据并从我的本地数据库中查询。我希望在应用程序关闭后保留此本地数据，那么执行此操作的最佳方法是什么。. . 有什么好的产品/例子可以做到这一点。. 我正在缓存大约 25 个表。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-19T12:32:14.490

SQLite 非常适合这个。几年前，我编写了一个“智能客户端”应用程序，在其中维护了一个本地缓存，以便用户仍然可以离线使用该应用程序。我使用了 SQLite，没有任何问题，它非常小，持久性很快，并且大多数现代 ORM 都支持它。（我使用的是 NHibernate）

[http://www.sqlite.org/](http://www.sqlite.org/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T14:28:18.873

[Berkeley DB](http://en.wikipedia.org/wiki/Berkeley_DB)是一个很好的独立数据库。您还应该考虑内置于 Windows 中的[ESENT 。](http://msdn.microsoft.com/en-us/library/ms684493(VS.85).aspx)这是Ayende的[一篇文章。](http://ayende.com/Blog/archive/2008/12/23/hidden-windows-gems-extensible-storage-engine.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T14:09:33.600

您始终可以使用 Access DB，通常在 .NET 应用程序中使用它非常简单，并且不需要在客户端上安装或配置任何服务器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-19T12:40:05.110

[H2](http://www.h2database.com/html/main.html)数据库也可能满足您的需求。Microsoft 提供 SQL Server 的精简版：[SQL Server Mobile Edition](http://technet.microsoft.com/en-us/sqlserver/bb671073.aspx)。如果您喜欢 SQL Server 和 TSQL，那么这可能是一个不错的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-19T14:26:50.563

我会考虑使用 SQL Server Express 甚至 SQL Server Compact Edition，它可以像 Access 一样对单个数据库文件进行操作。尽管如此，它仍然是 SQL Server。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-19T13:12:25.780

考虑使用 Firebird，我相信他们也有 ADO.NET 扩展。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-19T15:45:46.333

您还可以考虑在 Sun 的 Glassfish Java EE 服务器中使用的[Apache Derby 。](http://db.apache.org/derby/)

# parent-child - 具有父子关系的数据访问层应该是什么样子？

> ID：765337
> 
> 赞同：0
> 
> 时间：2009-04-19T12:30:29.640
> 
> 标签：parent-child, data-access-layer

我正在编写我的第一个 NHibernate 应用程序，但我想这个问题适用于任何 ORM 框架。我的应用程序是一个简单的错误跟踪器（开发人员都了解问题域，对吗？），我想知道如何最好地在 DAL 中建模项目/票证关系。A`Project`有多个`Ticket`s；a`Ticket`必须由 a 拥有`Project`。

我见过的每个例子都显示一个`IRepository<T>`, `FindAll`, `Save`, `Delete`, 等等。所以我有一个`interface IProjectRepository : IRepository<Project>`.

我的问题来自以下问题：我是否有一个`ITicketRepository`知道如何谈论门票的人，或者这是`IProjectRepository`需要知道的事情？

还是我完全在错误的树上吠叫？有人可以指点我一些示例代码，这些代码模拟了与 DAL 的父子关系吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T12:35:21.657

我认为如果您只关注票证列表，您可能希望将其放在 IRepository 存储库中，您还可以将票证集合添加到项目实体并延迟加载票证。这样你就可以从你的 IRepository 中检索项目，如果你想要所有的票只需点击这个集合，但如果你只是追求票，那么你可以通过 IRepository 使用它们。

# asp.net - 为什么 Application_Start 在 Cassini 中运行但在 IIS7 中不运行？

> ID：765341
> 
> 赞同：3
> 
> 时间：2009-04-19T12:34:41.363
> 
> 标签：asp.net, iis, cassini, application-start

我有一个在 Cassini 中开发的 ASP.NET 3.5 sp1 应用程序。该应用程序包含一个应该运行一些代码的 global.asax 文件 - 它在 Cassini 中运行良好，但在 IIS 中，调试器永远不会命中该函数。为什么该代码不运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T13:01:37.227

也许在 Cassini 中，应用程序在 Cassini 启动时启动。在 II7 中，一个服务，应用程序已经启动，当你启动调试器时，VS 只附加了调试器。您可以尝试在 IIS 控制台中启动调试器并回收池以查看应用程序是否重新启动？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T12:39:10.087

您正在手动将调试器附加到 w3wp.exe 进程？很可能您只是太晚了，并且 Application_Start 在调试器附加时已经运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T12:39:16.000

您确定代码没有被执行，还是您只是附加到进程太晚而调试器无法使用它？我建议在该方法中添加一些日志记录以确保。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-02T14:00:23.293

我看到在 IIS7 中运行的 WCF Web 项目存在同样的问题。Application_Start() 中的第一行代码是一个记录器写入，我从来没有得到它。此外，应该在 Application_Start 上初始化的其他对象永远不会被创建，并且我的其余代码因此而失败。有人对此有任何了解吗？它在卡西尼中运行良好......

# nhibernate - 我可以让 NHibernate 强制字符串属性为非空吗？

> ID：765345
> 
> 赞同：0
> 
> 时间：2009-04-19T12:36:15.680
> 
> 标签：nhibernate

我知道`not-null`属性。是否有一个强制字符串属性的最小长度？我不希望我的数据库中有空字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T13:00:45.700

我不知道映射文件中有任何内容可以让您执行此操作（而且我在架构中看不到任何内容）。您可能可以使用 NHibernate.IUserType 定义自定义类型并将您的逻辑构建到该类型中（如果字符串为空，则保存 null）。[这是一个](http://www.lostechies.com/blogs/rhouston/archive/2008/03/23/mapping-strings-to-booleans-using-nhibernate-s-iusertype.aspx)构建 IUserType 的示例（很容易更改此示例代码以适合您）

另一种选择是利用[NHibernate.Validations](http://nhforge.org/wikis/validator/nhibernate-validator-1-0-0-documentation.aspx)并在将实体保存到数据库之前处理验证逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T15:46:44.380

您正在寻找[NHibernate 验证器](http://nhforge.org/wikis/validator/nhibernate-validator-1-0-0-documentation.aspx)！[这里](http://www.codinginstinct.com/2008/05/nhibernate-validator.html)有一篇博客文章展示了它的一些优点。

# jquery - jQuery 可排序 + 可放置。掉落后，我的 LI 被包裹在另一个 LI 中

> ID：765346
> 
> 赞同：2
> 
> 时间：2009-04-19T12:36:49.360
> 
> 标签：jquery, jquery-ui-sortable, jquery-ui-droppable

这是我的可拖动连接到可排序的代码。问题是，我正在创建一个具有一堆属性的 LI。但是当我将一个项目拖到可放置的 div 时，可排序的会创建一个新的 li 标签并用它包装我创建的 li。

它看起来像这样：

```
<ul>
<li class="ui-draggable" style="display: list-item;">
    <li class="X" onclick="myFunc()"> My LI</li>
<li>
</ul> 
```

虽然我的意图是有这样的东西：

```
<ul>
    <li class="X" onclick="myFunc()"> My LI</li>
</ul> 
```

那么我该怎么做呢？

和代码：

```
$(document).ready(function() {

$('.draggable_text > li').draggable({
    helper: function(event, ui) {
        return '<div class="placeholder_sortable">&nbsp</div>'
    },
    connectToSortable:'#stagerows'
});

$('#stagerows').sortable({
    handle: '.drag_handle',
    placeholder: 'placeholder_sortable'
});

/**
 * When item is dropped from the Add <Stuff>
 */
$('#stagerows').droppable({
    drop: function(event, ui){
        return ui.draggable.html('<li class="X" onclick="myFunc()"> My LI</li>')
    }
});

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T12:43:38.377

尝试使用这个：

```
$('#stagerows').droppable({
    drop: function(event, ui){
        return ui.draggable.html('My LI').addClass('X').click( myFunc );
    }
}); 
```

# css - 如何在 Firebug 中查看打印媒体 CSS？

> ID：765349
> 
> 赞同：68
> 
> 时间：2009-04-19T12:37:27.177
> 
> 标签：css, printing, firebug, print-css

Firebug 是显示某些 HTML 元素的屏幕媒体 CSS 的绝佳工具，但有没有办法查看打印媒体 CSS 呢？或者是否有任何其他工具可以查看打印媒体 CSS？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-19T12:41:01.520

Web 开发者工具栏呢？
[https://addons.mozilla.org/en-US/firefox/addon/60](https://addons.mozilla.org/en-US/firefox/addon/60)
安装后转到 CSS -> 按媒体类型显示 CSS -> 打印

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2016-11-02T10:42:35.557

## 较新的火狐

1.  使用 F12 打开 devtools。
2.  转到检查器选项卡。
3.  打开规则子选项卡。
4.  将有打印媒体按钮。

[![在此处输入图像描述](https://i.stack.imgur.com/6bN8w.png)](https://i.stack.imgur.com/6bN8w.png)

## 老火狐

Firefox 现在不需要 firebug。

1.  通过按运行开发人员工具栏`Shift+F2`
2.  类型`media emulate print`

键入`media reset`以返回标准视图。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-12-16T17:33:33.183

I would have never expected this to work, but it does. Install -both- the 1.5 beta of Firebug and Web Developer. When you choose the print css from Web Developer, the tools in Firebug suddenly work on the new print version of the page. So far I haven't found any problems with running both at the same time.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-19T12:40:16.403

使用 Web Developer 插件。然后您可以从 CSS 菜单中选择您希望页面显示为哪种媒体。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-19T14:22:41.447

在 Firefox（和其他一些浏览器）中，您可以使用打印预览查看打印样式表的静态显示。它远不如 Web 开发人员工具栏有用，但它也可以帮助您了解将要打印的内容。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-19T12:40:15.530

你可能想看看 webdeveloper 工具栏——它允许你选择你想看到的 CSS。结合firebug，应该可以看到打印媒体CSS。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-05-02T17:21:26.290

实际上，请注意，您可能会`@media print`在意想不到的时候看到 CSS。

像[这样使用](http://www.codebeautifier.com/?css_text=&url=http%3A%2F%2Fsstatic.net%2Fstackoverflow%2Fall.css&template=0&custom=&preserve_css=on&compress_c=on&case_properties=0&css_level=CSS2.1&post=#skip)：

```
[..]@media print{#sidebar,#nav,[..],div.vote{display:none;}}[..]
```

...因此人们可能期望 Firebug 中的 CSS 面板以某种方式显示：

```
@媒体打印{
  #sidebar, #nav, [..], div.vote {
    显示：无；
  }
}
```

但相反，它显示 CSS 就好像`@media print`它实际上是活动的一样，例如：

```
#sidebar, #nav, [..], div.vote {
  显示：无；
}
```

[![](https://i.stack.imgur.com/KSgKr.png)](https://i.stack.imgur.com/KSgKr.png)

（另请参阅相关问题报告：[CSS 面板没有 @media UI](http://code.google.com/p/fbug/issues/detail?id=1717)。）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-05-22T16:44:06.343

**编辑 2**阅读[Arjan](https://stackoverflow.com/users/84237/arjan)的[回答](https://stackoverflow.com/a/2754264/413020)后，我意识到该解决方案无法正确处理使用（或滥用）`@media print`CSS 的站点。（见下面的例子。）但我认为这个解决方案仍然有效作为“非完美的快速和肮脏的技巧”，最重要的是你编写的代码并且你事先知道它没有这个.

* * *

使用 Firebug，您还可以方便地编辑`<link rel="stylesheet" type="text/css" ...>`和`<style>`标签。

例如，您可以切换原件

```
<link rel="stylesheet" type="text/css" media="print"> 
```

至

```
<link rel="stylesheet" type="text/css" media="screen"> 
```

浏览器会应用它。您还必须停用仅屏幕显示的功能。

当然，这仅在您只想快速检查带有很少样式表链接的几个页面时才有用，但至少，您不需要安装任何额外的插件。

* * *

**编辑 1**这个技巧建议我使用 javascript 来自动化这个......

*（免责声明：为简单起见，我将使用 JQuery。我不是 Javascript 专家。）*

```
// Save all stylesheet links
allStylesheets   = $('link[rel="stylesheet"], style');
// Save the print-stylesheet links
printStylesheets = $('link[media*="print"], link[media*="all"], style[media*="print"], style[media*="all"]');

// Set all stylesheet medias to something 'exotic'
if (null != allStylesheets) {
    allStylesheets.attr("media", "aural");
}
// Switch the print-stylesheet medias to 'screen'
if (null != printStylesheets) {
    printStylesheets.attr("media", "screen");
} 
```

请注意，默认`media`值为`"screen"`（[w3.org - media 属性](http://www.w3.org/TR/html4/present/styles.html#adef-media)）。这可以在按钮中使用以显示页面预览。唯一的缺点是您必须重新加载页面才能恢复原始视图。

如上所述，此解决方案不适用于这样的 html 代码，因为`@media print`浏览器不会应用其中的样式：

```
<html>
    <head>
        <title>Hello world</title>
        <style type="text/css" media="all">
            @media print { h1 { color: red; }}
        </style>
    </head>
    <body>
        <h1>Hello world</h1>
    </body>
</html> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-19T14:09:18.233

但是，Web 开发人员工具栏对于 CSS 调试有一个很大的缺点：每次刷新页面时，它都会恢复为屏幕样式表。

这些天我倾向于做的是在我开发时暂时将打印样式表的媒体切换到屏幕，然后在上线之前将其切换回来。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-22T17:58:27.237

[Firefox 68 在页面检查器的](https://developer.mozilla.org/en-US/docs/Tools/Page_Inspector)[规则视图](https://developer.mozilla.org/en-US/docs/Tools/Page_Inspector/UI_Tour#rules_view)中添加了一个“切换页面的打印媒体模拟”按钮（[错误 1534984](https://bugzilla.mozilla.org/show_bug.cgi?id=1534984)）：

[![Firefox Page Inspector 的屏幕截图](https://i.stack.imgur.com/ejtj7.png)](https://i.stack.imgur.com/ejtj7.png)

[在“检查和编辑 CSS”页面的“查看打印的 @media 规则”部分中](https://developer.mozilla.org/en-US/docs/Tools/Page_Inspector/How_to/Examine_and_edit_CSS#view_media_rules_for_print)有一个有关如何使用按钮的[视频](https://www.youtube.com/watch?v=AEmq9hNDOGU)。

# c# - 如何将 DataTemplate 应用于 XElement 子类？

> ID：765359
> 
> 赞同：0
> 
> 时间：2009-04-19T12:41:49.333
> 
> 标签：c#, xml, linq-to-xml, datatemplate, xelement

当我从 子类化时`XElement`，`DataTemplate`适用于`XElement`将元素名称用作 的`DataType`，不适用于子类。任何想法？

```
<HierarchicalDataTemplate DataType="grupo" ItemsSource="{Binding Path=Elements}">
        <TextBlock Text="{Binding Path=Attribute[name]}" />
</HierarchicalDataTemplate>
<!-- When I build an XDocument with XElements like this the template gets applied -->
XDocument _xdoc=XDocument.Load(@"RosterData1.xml");
treeRoster.DataContext = _xdoc;     
<TreeView Name="treeRoster" ItemsSource={Binding Path=Root.Elements}>
</TreeView>  
<!-- but if build de XDocument like this the DataTemplate doesn't apply -->
XDocument _xdoc=XDocument.Load(@"RosterData1.xml");
XDocument docOther = new XDocument(new XElement("contactos"));
var grupos = _xdoc.Descendants("grupo").Select(g => new Grupo(g));
docOther.Root.Add(grupos.ToArray());
var contactos = _xdoc.Root.Elements("contacto").ToList();
docOther.Root.Add(contactos);
treeRoster.DataContext = docOther;  
<!-- The xml file is like that:
<contactos>
  <grupo name="Amigotes">
    <contacto jid="batman@jabber.org" subscription="none" />
    <contacto jid="trucoman@jabber-hispano.org" subscription="both" name="truco" />
    <contacto jid="mmakinavaja@gmail.com" subscription="none" name="mmakinavaja" />
    <contacto jid="ramon@jabber-hispano.org" subscription="both" name="Ramon" />
 </grupo>
 <grupo name="Lannisters">
    <contacto jid="jamie@jabberes.org" subscription="none" />
 </grupo>
 <contacto jid="tyrion@jabber.org" subscription="none" />
   <contacto jid="nslbot@jabber.org" subscription="none" />
   <contacto jid="nslbot@jabberes.org" subscription="none" />
</contactos> --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T10:18:31.280

我知道为什么它不起作用，但我不明白为什么它是这样实现的。使用反射器查看方法“ `FindTemplateResourceInternal`”中的代码，我找到了答案：

```
Type baseType = item.GetType();
if ((baseType.FullName == "System.Xml.Linq.XElement") && 
((obj2 = GetXLinqTagName(item, baseType)) != null))
{
    baseType = null;
} 
```

好的，我知道我班级的全名不是`System.Xml.Linq.XElement`. 但后来，一旦你进入“while”：

```
while (obj2 != null)
{
    object obj3 = null;
    if (templateType == typeof(DataTemplate))
    {
        obj3 = new DataTemplateKey(obj2);
    }
    if (obj3 != null)
    {
        keys.Add(obj3);
    }
    if (exactMatch == -1)
    {
        exactMatch = keys.Count;
    }
    if (baseType != null)
    {
        baseType = baseType.BaseType;
        //HERE baseType FullName is XElement
        //Why don't check it again??
        if (baseType == typeof(object))
        {
            baseType = null;
        }
    }
    obj2 = baseType;
} 
```

在这个循环中， after `"baseType=baseType.BaseType"`，如果你再次检查`FullName`，现在它是`XElement`......但是相反，它现在正在寻找一个`DataTemplate`with `DataType={x:Type XElement}`...

# c# - 如何将 IntPtr/Int 转换为 Socket？

> ID：765364
> 
> 赞同：5
> 
> 时间：2009-04-19T12:47:16.730
> 
> 标签：c#, sockets, winsock, intptr

我想将 message.WParam 转换为 Socket。

```
 protected override void WndProc(ref Message m)
    {
        if (m.Msg == Values.MESSAGE_ASYNC)
        {

            switch (m.LParam.ToInt32())
            {
                case Values.FD_READ:
                    WS2.Receive(m.WParam);
                case Values.FD_WRITE: break;
                default: break;
            }

        }
        else
        {
            base.WndProc(ref m);
        }
    }

public class WS2
{
    public static void Receive(IntPtr sock)
    {
        Socket socket = sock;
    }
} 
```

如何将 IntrPtr(sock) 转换为 Socket，以便调用 Receive()？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T14:10:02.490

你不能这样做，因为 Socket 类创建和管理它自己的私有套接字句柄。从理论上讲，您可以使用一些邪恶的反射将您的套接字句柄塞入 Socket 的私有字段中，但那完全是 hack，我不会这样做。

给定一个有效的套接字句柄，您可以通过 P/Invoke 调用 Win32 recv 函数来接收数据，如下所示：

```
[DllImport("ws2_32.dll")]
extern static int recv([In] IntPtr socketHandle, [In] IntPtr buffer,
  [In] int count, [In] SocketFlags socketFlags);

/// <summary>
/// Receives data from a socket.
/// </summary>
/// <param name="socketHandle">The socket handle.</param>
/// <param name="buffer">The buffer to receive.</param>
/// <param name="offset">The offset within the buffer.</param>
/// <param name="size">The number of bytes to receive.</param>
/// <param name="socketFlags">The socket flags.</param>
/// <exception cref="ArgumentException">If <paramref name="socketHandle"/>
/// is zero.</exception>
/// <exception cref="ArgumentNullException">If <paramref name="buffer"/>
/// is null.</exception>
/// <exception cref="ArgumentOutOfRangeException">If the 
/// <paramref name="offset"/> and <paramref name="size"/> specify a range
/// outside the given buffer.</exception>
public static int Receive(IntPtr socketHandle, byte[] buffer, int offset,
  int size, SocketFlags socketFlags)
{
  if (socketHandle == IntPtr.Zero)
    throw new ArgumentException("socket");
  if (buffer == null)
    throw new ArgumentNullException("buffer");
  if (offset < 0 || offset >= buffer.Length)
    throw new ArgumentOutOfRangeException("offset");
  if (size < 0 || offset + size > buffer.Length)
    throw new ArgumentOutOfRangeException("size");

  unsafe
  {
    fixed (byte* pData = buffer)
    {
      return Recv(socketHandle, new IntPtr(pData + offset),
        size, socketFlags);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T13:56:45.113

[Socket 类](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.aspx)中没有任何内容可以执行此操作 - 尽管它使用底层句柄，但没有 API 来操作它，并且[Handle 属性](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.handle.aspx)是只读的。

最好只使用 P/Invoking [recv](http://msdn.microsoft.com/en-us/library/ms740121(VS.85).aspx)并使用 IntPtr 句柄直接调用它。

*快速*浏览一下[Rotor 代码](http://www.123aspx.com/rotor/RotorSrc.aspx?rot=42001)，您可以轻松创建一个Socket，关闭[它的handle](http://msdn.microsoft.com/en-us/library/ms737582(VS.85).aspx)，然后将它的m_handle 字段设置为您自己的。但这需要反射，并且如果您的套接字已经连接（听起来像是 - 因为您刚刚询问了调用 recv），那么您还必须操纵 Socket 的私有状态 - 这使得这个想法更加不受欢迎并且更脆弱。

# wpf - 在窗口的背景中创建一个透明的洞 - WPF

> ID：765365
> 
> 赞同：8
> 
> 时间：2009-04-19T12:47:56.853
> 
> 标签：wpf, transparency

我有一个包含这些值的窗口：

```
WindowState="Maximized"
AllowsTransparency="True"
Opacity="0.5"
WindowStyle="None" 
```

此窗口位于其他窗口（作为弹出窗口）之上，其内容位于特定位置。

我有一个新要求。这个窗口必须从下面的窗口中显示一个矩形区域。换句话说，我必须在这个窗口中设置一个完全透明的“洞”（没有不透明度值）。直到此刻，我想不出办法来制作这个透明的洞。

希望能给个思路...

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-19T14:55:41.010

我找到了一种解决方案：

这是另一个窗口顶部的弹出窗口，并且在所需位置包含另一个窗口的孔：

窗口标题：

```
 WindowState="Maximized"
    AllowsTransparency="True"
    WindowStyle="None" 
```

窗口内容：

```
<Window.Background >
    <SolidColorBrush x:Name="BackgroundBrush" Color="WhiteSmoke" Opacity="0" ></SolidColorBrush>
</Window.Background>
<Canvas x:Name="ContectHolder" >
    <Path Stroke="Black" Fill="WhiteSmoke" Opacity="0.8">
        <Path.Data>
            <CombinedGeometry GeometryCombineMode="Exclude">
                <CombinedGeometry.Geometry1  >
                    <RectangleGeometry Rect="0,0,2000,2000"  />
                </CombinedGeometry.Geometry1>
                <CombinedGeometry.Geometry2>
                    <RectangleGeometry Rect="75,75,400,900" />
                </CombinedGeometry.Geometry2>
            </CombinedGeometry>
        </Path.Data>
    </Path>
</Canvas> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-19T12:57:32.010

尽量避免 AllowsTransparency=true，这是非常错误和缓慢的。

您可以 PInvoke SetWindowRgn 创建任何形状的窗口：

1.  使用 CreateRectRgn 两次，一次用于窗口边界矩形，一次用于孔。
2.  使用带有 RGN_AND 的 CombineRgn 作为第 4 个参数来获得一个有洞的区域
3.  调用 SetWindowRgn 将区域应用到窗口
4.  不要忘记删除所有区域，除了传递给 SetWindowRgn 的区域

# c# - 在不考虑 IE 版本的情况下打印一个 asp .net 页面

> ID：765366
> 
> 赞同：0
> 
> 时间：2009-04-19T12:48:09.363
> 
> 标签：c#, asp.net, javascript

我有一个带有打印选项的 ASP.NET 站点`onclick = window.print()`（

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T12:53:49.023

这取决于客户端机器上设置的默认打印设置。

这与 ASP.NET 无关。

此外，`OnClick = Window.Print()`它是一个可以在客户端机器上执行的 JavaScript 函数。

您可以使用 CSS 来控制需要打印/查看页面的方式。

```
@media print {
    BODY { font-size: 10pt }
  }
  @media screen {
    BODY { font-size: 12pt }
  }
  @media screen, print {
    BODY { line-height: 1.2 }
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T13:58:23.580

您无法控制打印，因此无论客户端如何，您都可以获得相同的结果，这是 HTML 的“美女”之一。

例如，IE7 引入了增强的用户控制打印选项来“修复”打印网站时的一些问题。尽管如此，这仍然掌握在用户手中，并且迎合了他们如何最好地打印相关页面的想法，而不是页面本身或 Web 开发人员可以控制的东西。

如果您需要用于受控打印的内容，请改用合适的格式 - 例如 PDF（如果需要，动态生成）。

# linux - 如何实现一个实用的光纤调度器？

> ID：765368
> 
> 赞同：10
> 
> 时间：2009-04-19T12:50:11.013
> 
> 标签：linux, asynchronous, scheduling, language-implementation

我知道使用协程作为基础和实现玩具调度程序的基础知识。但我认为这是对整个异步调度程序的过度简化的看法。我的想法中缺少一整套漏洞。

如何防止 CPU 运行空闲/等待的调度程序？一些纤程只是休眠，另一些则等待操作系统的输入。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-12-28T20:39:59.247

您需要将 io 操作多路复用到基于事件的接口（选择/轮询）中，因此您可以利用操作系统进行等待，同时仍然能够安排其他纤程。select/poll 有一个超时参数——对于想要休眠的纤程，您可以创建一个优先级队列，该队列使用 select/poll 的选项来模拟休眠调用。

尝试为执行阻塞操作（调用读/写/睡眠等）的纤程提供服务。除非您将每个光纤安排在本机线程中，否则直接将无法正常工作-哪种方式超出了目的。

有关工作实施，请参阅[http://swtch.com/libtask/ 。](http://swtch.com/libtask/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T07:10:50.940

您可能应该看看 setcontext 系列函数 ( [http://en.wikipedia.org/wiki/Setcontext](http://en.wikipedia.org/wiki/Setcontext) )。这意味着在您的应用程序中，您需要将所有可能阻塞（读取、写入、睡眠等）的函数重新实现为异步形式并返回到调度程序。

只有“调度器纤程”才能使用 select()、poll() 或 epoll() 等待完成事件。这意味着当调度程序空闲时，进程将在 select/poll/epoll 调用中处于休眠状态，并且不会占用 CPU。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-05T09:20:30.547

虽然回答有点晚了，但我想提一下，我在 C 语言中有一个纤程库的实际实现，称为[libevfibers](https://github.com/Lupus/libevfibers)。

尽管是一个年轻的项目，但它已用于生产。它不仅为读/写套接字等经典异步操作提供了解决方案，而且还以非阻塞方式处理文件系统 IO。该项目利用了 3 个很棒的库——libcoro、libev 和 libeio。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-20T06:23:05.430

您也可以通过使用协程来控制控制流。支持创建这些的库是 BOOST.ASIO。

这里有一个很好的例子：[Boost Stackful Coroutines](http://www.boost.org/doc/libs/1_54_0/doc/html/boost_asio/overview/core/spawn.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T07:28:05.727

从实现的角度来看，您可以从异步事件循环实现开始。然后，您可以通过使用异步事件处理程序切换到相应的光纤来实现光纤调度。

睡眠/等待光纤只是意味着它目前没有被安排 - 它只是切换到事件循环。

顺便说一句，如果您正在寻找一些实际代码，请查看[http://svn.cmeerw.net/src/nginetd/trunk/](http://svn.cmeerw.net/src/nginetd/trunk/)仍在进行中，但尝试在多线程事件循环（使用 Win32 I/O 完成端口或 Linux 边缘）之上实现光纤调度程序-触发的epoll）。

# java - 我的 Java App Engine GWT 应用程序的 Web 服务 API

> ID：765373
> 
> 赞同：2
> 
> 时间：2009-04-19T12:56:15.180
> 
> 标签：java, web-services, google-app-engine

我正在创建一个在 Google App Engine 上运行的网络应用程序。我还在开发一个桌面客户端，它需要访问/更新 webapp 上的数据。

我想在服务器和客户端之间创建一个 Web 服务 api。我最好的选择是什么？

根据 GAE，开箱即用不支持 RMI og JAX。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T13:28:26.583

我不想回答我自己的问题，但 Restlet 正在开发 GAE 版本。当前的开发版本似乎运行良好。

[http://wiki.restlet.org/docs_1.2/13-restlet/252-restlet.html](http://wiki.restlet.org/docs_1.2/13-restlet/252-restlet.html)

# wxpython - wxAuiNotebook - 防止某些选项卡关闭

> ID：765379
> 
> 赞同：3
> 
> 时间：2009-04-19T13:00:07.043
> 
> 标签：wxpython

我正在试验 wx.aui.AuiNotebook；有没有办法可以防止特定标签被关闭？即我有一个应用程序，允许用户在 AuiNotebook 中创建多个选项卡，但前 2 个选项卡是系统管理的，我不希望它们被关闭。

另外，在关闭事件中，我可以让附加到选项卡的窗口对象被关闭吗？（从中提取数据）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T09:50:54.630

我有类似的情况，我想阻止用户关闭最后一个选项卡。我所做的是绑定`wx.aui.EVT_AUINOTEBOOK_PAGE_CLOSE`事件，然后在事件处理程序中检查打开的选项卡数量。如果选项卡的数量少于两个，我会切换`wx.aui.AUI_NB_CLOSE_ON_ACTIVE_TAB`样式，以便最后一个选项卡没有关闭按钮。

```
class MyAuiNotebook(wx.aui.AuiNotebook):

    def __init__(self, *args, **kwargs):
        kwargs['style'] = kwargs.get('style', wx.aui.AUI_NB_DEFAULT_STYLE) & \
            ~wx.aui.AUI_NB_CLOSE_ON_ACTIVE_TAB
        super(MyAuiNotebook, self).__init__(*args, **kwargs)
        self.Bind(wx.aui.EVT_AUINOTEBOOK_PAGE_CLOSE, self.onClosePage)

    def onClosePage(self, event):
        event.Skip()
        if self.GetPageCount() <= 2:
            # Prevent last tab from being closed
            self.ToggleWindowStyle(wx.aui.AUI_NB_CLOSE_ON_ACTIVE_TAB)

    def AddPage(self, *args, **kwargs):
        super(MyAuiNotebook, self).AddPage(*args, **kwargs)
        # Allow closing tabs when we have more than one tab:
        if self.GetPageCount() > 1:
            self.SetWindowStyle(self.GetWindowStyleFlag() | \
                wx.aui.AUI_NB_CLOSE_ON_ACTIVE_TAB) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-04-30T22:45:05.480

很晚了，我正在使用`wx.lib.agw.aui`. 但也许对其他人有用。

```
import wx
import wx.lib.agw.aui as aui 

class MyForm(wx.Frame):

    def __init__(self):
        super().__init__(None, wx.ID_ANY, "1 & 2 do not close")

        self.reportDown = aui.auibook.AuiNotebook(
            self,
            agwStyle=aui.AUI_NB_TOP|aui.AUI_NB_TAB_SPLIT|aui.AUI_NB_TAB_MOVE|aui.AUI_NB_SCROLL_BUTTONS|aui.AUI_NB_CLOSE_ON_ALL_TABS|aui.AUI_NB_MIDDLE_CLICK_CLOSE|aui.AUI_NB_DRAW_DND_TAB,
        )
        self.reportDown.AddPage(wx.Panel(self.reportDown), '1, I do not close')
        self.reportDown.AddPage(wx.Panel(self.reportDown), '2, I do not close')     
        self.reportDown.AddPage(wx.Panel(self.reportDown), '3, I do close')

        #--> For this to work you must include aui.AUI_NB_CLOSE_ON_ALL_TABS
        #--> in the agwStyle of the AuiNotebook
        # Remove close button from first tab
        self.reportDown.SetCloseButton(0, False)
        # Remove close button from second tab 
        self.reportDown.SetCloseButton(1, False)        

        self._mgr = aui.AuiManager()

        self._mgr.SetManagedWindow(self)

        self._mgr.AddPane(
            self.reportDown, 
            aui.AuiPaneInfo(
                ).Center(
                ).Caption(
                    '1 & 2 do not close'
                ).Floatable(
                    b=False
                ).CloseButton(
                    visible=False
                ).Movable(
                    b=False
            ),
        )

        self._mgr.Update()
    #---
#---
# Run the program
if __name__ == "__main__":
    app = wx.App(False)
    frame = MyForm()
    frame.Show()
    app.MainLoop() 
```

# c# - 静态异常实例

> ID：765383
> 
> 赞同：1
> 
> 时间：2009-04-19T13:02:40.767
> 
> 标签：c#, multithreading, exception

静态异常实例可以安全使用吗？有什么好的理由避免以下情况？

```
public class ResourceHttpHandler : IHttpHandler
{
    private static HttpException notFoundException =
                new HttpException(
                    (int)HttpStatusCode.NotFound,
                    "Assembly Not Found");

    public bool IsReusable
    {
        get { return true; }
    }

    public void ProcessRequest(HttpContext context)
    {
        ....
        throw notFoundException;
        ....
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-19T13:09:25.553

抛出异常时会设置异常的堆栈跟踪 ( [http://msdn.microsoft.com/en-us/library/system.exception.stacktrace.aspx](http://msdn.microsoft.com/en-us/library/system.exception.stacktrace.aspx) )，因此此代码不是线程安全的。

多个线程将使用同一个异常对象，任何依赖异常内容的人都会得到令人困惑的结果。

# performance - 哪些 Java 应用程序可用于对虚拟机进行压力测试？

> ID：765385
> 
> 赞同：1
> 
> 时间：2009-04-19T13:04:25.190
> 
> 标签：performance, profiling, computer-science, kernel

我对压力测试以及对[SANOS](http://www.jbox.dk/sanos/index.htm)操作系统内核进行基准测试的方法很感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-26T11:43:05.347

虽然我不确定这是否适合内核测试，但您可能想看看 [SPECjbb2005](http://www.spec.org/jbb2005/)

> "" *SPECjbb2005 (Java Server Benchmark) 是 SPEC 用于评估服务器端 Java 性能的基准。与其前身 SPECjbb2000 一样，SPECjbb2005 通过模拟三层客户端/服务器系统（强调中间层）来评估服务器端 Java 的性能。* **该基准测试了 JVM（Java 虚拟机）、JIT（即时）编译器、垃圾收集、线程和操作系统的某些方面的实现。它还测量 CPU、缓存、内存层次结构和共享内存处理器 (SMP) 的可扩展性的性能。** *SPECjbb2005 提供了一个新的增强型工作负载，在一个更* 面向对象的方式来反映实际应用程序的设计方式，并引入了 XML 处理和 BigDecimal 计算等新功能，使基准测试更真实地反映了当今的应用程序。""

# macos - 无法在 MacPorts 中将端口添加到我的本地存储库

> ID：765392
> 
> 赞同：2
> 
> 时间：2009-04-19T13:11:44.050
> 
> 标签：macos, macports

我正在尝试在 MacPorts 中向我的本地仓库添加一个端口。

我知道[导游](http://guide.macports.org/#development.examples)。

我在 /Users/Masi/bin/MacPorts/ports/Git 运行失败

```
portindex
Creating software index in /Users/Masi/bin/MacPorts/ports/Git

Total number of ports parsed:   0 
Ports successfully parsed:  0    
Ports failed:           0 
```

我的**端口文件**如下

```
PortSystem          1.0

name                git-svn 
version             1.0 
categories          git 
maintainers         sl 
description         svn for Git 
long_description    Git-svn is a tool which allows Git to use svn 
homepage            http://www.kernel.org/pub/software/scm/git/docs/git-svn.html 
platforms           darwin
master_sites        http://git-scm.com/ 

checksums           md5 

depends_lib         
                    port:syfi-dev\ 
                    port:syfi-doc\ 
                    port:python-syfi0\ 
                    port:libcln5\ 
                    port:libsyfi0\ 
                    port:libginac1.4\ 
                    port:libsyfi0-dev\
                    port:syfi-bin\

#I do not know what these are: I leave them as they are by default
configure.args      --enable-perl-site-install \
                    --mandir=${prefix}/share/man 
```

**我的来源.conf**

```
#  MacPorts system wide sources configuration file
#  $Id: sources.conf 42662 2008-11-28 23:18:50Z raimue@macports.org $

#  To setup a local ports repository, insert a "file://" entry following
#  the example below that points to your local ports directory:
#  Example: file:///Users/landonf/misc/MacPorts/ports
file:///Users/Masi/bin/MacPorts/ports
rsync://rsync.macports.org/release/ports

#  The default MacPorts repository should always be tagged [default]
#  for proper functionality of various resources (port groups, mirror
#  sites, etc).  If you switch it from the rsync:// URL, be sure to keep
#  it tagged [default].

#  To prevent a source from synchronizing when `port sync` is used,
#  append [nosync] at the end as shown in this example:
#  Example: file:///Users/landonf/misc/MacPorts/ports [nosync]

#  NOTE: The port command parses source URLs in order and installs the
#        first occurrance when a port appears in multiple repositories.
#        So keep "file://" URLs above other URL types.

#  To get the ports tree from the master MacPorts server in California, USA use:
#      rsync://rsync.macports.org/release/ports/
#  To get it from the mirror in Trondheim, Norway use:
#      rsync://trd.no.rsync.macports.org/release/ports/
#  A current list of mirrors is available at http://trac.macports.org/wiki/Mirrors
rsync://rsync.macports.org/release/ports/ [default] 
```

**如何成功地将端口添加到本地 MacPorts？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T14:03:07.703

端口文件*必须*按以下方式组织：

```
$LOCAL_PORT_DIR/{category}/{portname}/ 
```

所有文件，包括`Portfile`，都在该目录下。

在您的情况下，您的本地端口目录是`/Users/Masi/bin/MacPorts/ports`，而您的端口 ,`git-svn`在 category 中`git`，因此您的目录结构应如下所示：

```
/Users/Masi/bin/MacPorts/ports/git/git-svn/Portfile 
```

（但是，在特殊情况下`git-svn`，您始终可以`git-core`使用变体安装端口`+svn`，如下所示：`$ sudo port install git-core +svn`。）

（另外，作为另一个旁注，与 Git 相关的端口通常组织在“devel”类别下，而不是“git”。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T14:00:14.900

我不确定，但我认为您需要将目录结构更改为这种格式： `portcategory/portname/Portfile`. 在你的情况下，那将是`/Users/Masi/bin/MacPorts/ports/git/git-svn/Portfile`

然后尝试从本地 repo ( `/Users/Masi/bin/MacPorts/ports`)的根目录运行 portindex

# python - 用于 python 的 Exif 操作库

> ID：765396
> 
> 赞同：110
> 
> 时间：2009-04-19T13:15:44.087
> 
> 标签：python, exif

我正在为 python 寻找好的 exif（可交换图像文件格式）操作库。我更喜欢灵活性（例如，检索提供商专有标签的能力）而不是处理速度。你有什么建议？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-04-19T13:21:28.380

您可能想查看[exif-py](https://github.com/ianare/exif-py)：

> 用于从 tiff 和 jpeg 文件中提取 EXIF 数据的 Python 库。非常容易使用 - $ ./EXIF.py image.jpg

或[Python 图像库 (PIL)](http://www.pythonware.com/products/pil/)：

> Python 图像库 (PIL) 为您的 Python 解释器添加了图像处理功能。该库支持多种文件格式，并提供强大的图像处理和图形功能。

还有恰当命名的 pyexif：[http ://pyexif.sourceforge.net/](http://pyexif.sourceforge.net/)

> pyexif python 库和工具旨在从包含它的 Jpeg 和 Tiff 文件中提取 EXIF 信息。此信息通常包含在使用数字成像设备（如数码相机、数字胶片扫描仪等）创建的图像中。

但是，看起来 pyexif 已经有一段时间没有更新了。他们建议如果他们没有做检查 EXIF-py 的技巧，所以你应该先尝试那个，因为他们的 sourceforge 页面最近似乎有*一些*活动，虽然不多。最后，使用 PIL 你可以这样做：

```
from PIL import Image
from PIL.ExifTags import TAGS

def get_exif(fn):
    ret = {}
    i = Image.open(fn)
    info = i._getexif()
    for tag, value in info.items():
        decoded = TAGS.get(tag, tag)
        ret[decoded] = value
    return ret 
```

**免责声明**：
我实际上不知道哪个是最好的，这只是我能够与谷歌拼凑而成的。:)

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-04-19T14:00:38.707

我自己最近一直在使用[pyexiv2](http://tilloy.net/dev/pyexiv2/)，它似乎非常适合我的需求。也许它也适合你。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2011-05-11T15:02:59.410

## 基于 Exiv2 的解决方案

Exiv2 (exiv2: [http://exiv2.org/](http://exiv2.org/) ) 是一个成熟的开源 C++ 库，支持读取和写入多种图像类型（JPEG、PNG、TIFF 和许多原始格式）的元数据，理解标准（Xmp、IPTC和 Exif）和非标准元数据（“Makernotes”），并在多个平台（Windows、Linux 和 Mac）上运行。

与 exiv2 的 Python 绑定是：

*   gexiv2（多语言绑定，但适用于 python 2.6/2.7/3.X）：[https ://wiki.gnome.org/gexiv2](https://wiki.gnome.org/gexiv2)
*   pyexiv2（不再支持，但适用于 python 2.6/2.7）：[http ://tilloy.net/dev/pyexiv2/](http://tilloy.net/dev/pyexiv2/)

pyexiv2 的一个优点是有一个可用于 python 2.7 的 windows 构建。gexiv2 的 Windows 构建请求在这里：[https ://bugzilla.gnome.org/show_bug.cgi?id=712441](https://bugzilla.gnome.org/show_bug.cgi?id=712441)

exiv2 和绑定都是开源的（GPL）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-11-15T01:57:39.793

[本文](http://www.fetidcascade.com/pyexif.html)描述了一个 Python 模块，用于使用纯 Python 编写 EXIF 元数据（而不仅仅是读取它们）。显然，PIL、pyexif 和 EXIF-py 都不支持编写 EXIF。pyexiv2 似乎是前沿且特定于平台的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-04-13T03:26:34.457

使用 PIL :)

```
import os,sys
from PIL import Image
from PIL.ExifTags import TAGS

if __name__ == '__main__':
    for (k,v) in Image.open(sys.argv[1])._getexif().iteritems():
        print '%s = %s' % (TAGS.get(k), v)
    os.system('pause') 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-05-13T12:58:26.410

[http://redmine.yorba.org/projects/gexiv2/wiki](http://redmine.yorba.org/projects/gexiv2/wiki)上的页面（成为[https://wiki.gnome.org/Projects/gexiv2](https://wiki.gnome.org/Projects/gexiv2)）**现在**显示：

> 这将同样适用于 Python 2 或 3，这使得 GExiv2 成为仅支持 Python 2 的 pyexiv2 的绝佳替代品。

因此，现在 GExiv2 支持 Python2 和 Python3。

好消息。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-01-23T20:02:52.303

我开始编写自己的基于 PIL 代码的小型库。 [在这里检查](https://github.com/albertz/helpers/blob/master/exif.py)。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-06-26T10:38:57.720

不知何故，我用上面的 Paolo 代码得到了 _getexif 的属性错误。我使用的是 Python 2.6.6 和 PIL 1.1.7。_getexif 现在过时了吗？

这是一个对我有用的小修改。

```
from PIL import Image
from PIL.ExifTags import TAGS

def get_exif(fn):
    ret = {}
    i = Image.open(fn)
#    info = i._getexif()
    info = i.tag.tags
    for tag, value in info.items():
        decoded = TAGS.get(tag, tag)
        ret[decoded] = value
    return ret 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-06-09T09:34:52.763

我一直在使用我自己的包装器[http://www.sno.phy.queensu.ca/~phil/exiftool/](http://www.sno.phy.queensu.ca/~phil/exiftool/) - 原因是它非常完整，开发者非常活跃。并且不能支持几乎所有的图像格式对于需要它的项目来说是一个绝对的阻碍

缺点当然是它不是 python，所以你需要像我一样使用子进程调用。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-07-23T02:51:32.260

您还可以在[http://www.emilas.com/jpeg/](http://www.emilas.com/jpeg/)上查看 Gheorghe Milas 的 jpeg.py 库，它是“解析、读取和写入 JPEG EXIF、IPTC 和 COM 元数据的 Python 库”。

一个缺点是他似乎通过 DynDNS 将他的域托管在动态 IP 上，因此它并不总是可用的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-07-23T05:17:45.703

ASPN 上有一些 PIL 和 EXIF.py 使用[示例](http://code.activestate.com/recipes/tags/EXIF/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-07-08T08:29:00.370

在 Python 2.6 中，模块的位置不同。用这个：

```
import Image    
from ExifTags import TAGS 
```

# c# - C#：在泛型中没有强制转换？

> ID：765398
> 
> 赞同：5
> 
> 时间：2009-04-19T13:18:00.727
> 
> 标签：c#, generics, casting

虽然我可以将字符串向上转换为对象，但不能将字符串的 IList 向上转换为对象的 IList。怎么来的？除了将所有项目处理到新的 IList 之外，现在该怎么做？

```
static void ThisWorks()
{
     IList<object> list = new List<object>();
     list.Add("I can add a string since string : object");
}

static void ThisDoesNotWork()
{
     // throws an invalid cast exception
     IList<object> list = (IList<object>) new List<string>(); 

     list.Add("I'm never getting here ... why?");
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-19T13:25:12.303

这是不可能的，因为泛型是不变的（从 C# 3.0 开始）。

您可以使用以下方法解决它：

```
var objectList = list.Cast<object>().ToList(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-19T13:58:11.880

你问的本质上是一个**逆变和协方差**的问题。它是编程语言设计中的一个概念，它讨论了方法和集合对于同一继承层次结构中两个类的对象的行为。阅读[Wikipedia 文章](http://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science))可能有助于将您的上述好奇心放在更大、更普遍的角度。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-19T13:28:58.643

这么看：香蕉是水果，但一篮子香蕉不是一篮子水果，因为后者可以加橙子，前者不能。你`List<string>`的约束比 a 更强`List<object>`。

选角应始终尊重[Liskow](http://en.wikipedia.org/wiki/Liskov_substitution_principle)。对于不允许修改的容器和迭代器，这样的转换是安全的，但是一旦事情可以改变，你就如履薄冰。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-19T13:27:27.883

`string`继承自`object`但`IList<string>`不继承`IList<object>`它们是不相关的类型，因此您不能在它们之间进行转换。

试想一下如果这行得通会发生什么：

```
// THIS CODE DOES NOT WORK
IList<object> list = new List<string>(); // this doesn't compile
list.Add(5); // because this is perfectly valid on IList<object> but not on IList<string> 
```

# oop - 在棋盘游戏中代表棋盘

> ID：765400
> 
> 赞同：2
> 
> 时间：2009-04-19T13:19:48.883
> 
> 标签：oop

我正在尝试为棋盘游戏的棋盘和玩家在棋盘周围的运动写一个很好的表示。棋盘是一个方格，玩家可以上下左右移动。几组连续的瓦片组合在一起形成命名区域。有墙壁阻挡了一些瓷砖之间的运动。

基本上就是这样。如果所有玩家都是人为控制的，我想我知道从哪里开始，但我正在为电脑控制的玩家所发生的事情而苦苦挣扎。我希望玩家能够对自己说：“我在方格 x，我想去 R 区很多，我想去 S 区一点点。我有 6 步可用，因此我应该做...”

我不知道从哪里开始。有任何想法吗？这将是现代 OO 语言。

**编辑：**我（还）不关心电路板的图形表示，更多的是关于路线查找部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T13:37:03.867

我会说使用代表每个可能移动的树结构。您可以使用[Minimax](http://en.wikipedia.org/wiki/Minimax)类型的算法来确定计算机应该采取什么行动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T16:49:58.620

我可以告诉你在商业棋盘游戏风格产品上什么对我有用。

将您对棋盘和核心游戏逻辑的表示分解为它自己的模块，并为游戏的其余部分提供明确定义的接口。我们有 bool IsValidMove(origin, dest) 和 bool PerformMove(origin, dest) 之类的函数，以及返回 GUI 的接口，例如 AnimateMove(gamePieceID, origin, dest, animInfo)。

董事会和规则只知道董事会的状态，以及什么是有效的。它对渲染、人工智能、动画、声音、输入或其他任何东西一无所知。每一帧，我们将在 GUI 级别处理来自用户的输入，将命令发送到棋盘/游戏状态代码，然后完成。游戏状态代码将获取命令，解析它们是否有效，更新游戏状态和棋盘，然后将消息发送回 GUI 以直观地表示棋盘的新状态。这些更新由视觉表示系统排队，因此我们可以批量处理一系列动画以按顺序发生。

这样做的好处是董事会不知道也不关心人类与人工智能玩家之间的关系。你的 AI 可以是一个单独的子模块，轮到它行动。它可以发送与人类玩家相同的命令，并且游戏逻辑和视觉结果将是相同的。您需要获得有关游戏板状态的每个 AI 的本地信息，或者从游戏逻辑中公开一些 BoardSnapshot() 功能，让 AI“看到”板，但仅此而已。或者，您可以将每个 AI 注册为游戏状态的观察者模式，这样他们也会在棋盘更新时收到通知，以防他们需要进行任何复杂的实时规划。

将游戏的每个部分分开和隔离将有助于单元测试，并提供更强大的系统。定义良好的接口是您的朋友。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T13:34:16.273

有一个 Player 类，它的 Map 字段将 Squares 与移动到那里的概率相关联，即 Map<Square, Double> 如果您将它们表示为 0..1 double。

有一个 Board 类封装了一系列 Squares。每个 Square 将有四个布尔值或类似的值来标记它有墙的位置、它的坐标以及上面的玩家（如果有的话）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T13:38:16.000

如果问题在于寻路，那么有很多寻路算法。

维基[百科关于](http://en.wikipedia.org/wiki/Pathfinding)寻路的文章有一个寻路算法列表。游戏中常用的一种是[A* 搜索算法](http://en.wikipedia.org/wiki/A*_search_algorithm)，它可以做得很好。A* 可以考虑通过不同类型区域的成本（例如不可穿透的墙壁、需要较长时间移动的瓷砖等）

在许多情况下，棋盘可以由二维数组表示，其中每个元素代表一种类型的图块。但是，对区域的要求可能会使尝试解决它变得更有趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-19T13:26:40.753

如果您正在寻找游戏（及其状态）的内存表示，矩阵是最简单的。但是，根据董事会的复杂性、策略，您可能必须维护一个状态列表。

如果您的意思是屏幕上的表示，则需要一些图形库开始。

# sifr - sIFR 和改变背景

> ID：765404
> 
> 赞同：0
> 
> 时间：2009-04-19T13:23:02.573
> 
> 标签：sifr, styleswitching

大家好，我正在使用此代码动态更改我的 sIFR（版本 3）H1 和 H2 标签（感谢 Mark Wubben 的代码），但我需要在同一个函数中更改我的 H2 背景颜色。谁能帮忙我让代码工作？显然 sIFR 和 changeCSS 不适用于背景颜色..

功能改变颜色（十六进制值）{

```
var css1 = '.sIFR-root { color: '+ hexValue +'; }';
var css2 = '.sIFR-root { color: #080808; background-color: '+hexValue+'; }';

for (var i = 0; i < sIFR.replacements['h1'].length; i++) {
    sIFR.replacements['h1'][i].changeCSS(css1);
};

for (var i = 0; i < sIFR.replacements['h2'].length; i++) {
    sIFR.replacements['h2'][i].changeCSS(css2);
}; 
```

};

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T13:39:13.017

sIFR 只支持整个 Flash 电影的背景颜色，以后不能更改。

`<h2>`您最好的选择是启用替换的透明度，并在由 sIFR (the )替换的 HTML 元素上设置背景颜色。但是，建议您仅在绝对必要时使用透明度，并且请记住，Linux 在很大程度上不支持透明度。它将回退到指定的`background-color`值。

# asp.net-mvc - MVC 自定义 ViewModel 和自动绑定

> ID：765406
> 
> 赞同：8
> 
> 时间：2009-04-19T13:25:28.870
> 
> 标签：asp.net-mvc, binding, viewmodel

我有一个自定义 ViewModel 定义为：

```
public class SampleFormViewModel
{
    public SampleFormViewModel(SelectList companies, Widget widget)
    {
        Companies = companies;
        Widget = widget;
    }

    public SelectList Companies { get; private set; }
    public Widget Widget { get; private set; }
} 
```

在我的编辑 POST 处理程序中，我有以下条目：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(SampleFormViewModel model)
{ 
```

编辑表单设置为：

```
Inherits="System.Web.Mvc.ViewPage<Sample.Web.Models.SampleFormViewModel>" 
```

它只是爆炸，不知道发生了什么，有以下错误：没有为这个对象定义无参数构造函数。当然，我在这里遗漏了一些非常明显的东西。在某些背景下，GET 可以完美运行，并按预期显示 SelectList 中的下拉列表。我猜想自动绑定回自定义视图模型是失败的，但不知道该怎么做。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-19T13:40:50.487

你需要有一个无参数的构造函数，我相信属性需要有公共设置器。默认绑定器使用不带参数的构造函数创建对象，然后使用公共属性上的反射来设置表单/查询参数的值。

```
public class SampleFormViewModel
{
    public SampleFormViewModel() { }

    public SelectList Companies { get; set; }
    public Widget Widget { get; set; }
} 
```

不过，我怀疑您真正想要做的不是获取视图模型，而是获取底层 Widget 模型并在表单发布时选择列表值。我不认为活页夹将能够在 post 上重建 SelectList，因为它只有参数中的选定值。

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit( int CompanyID, Widget widget )
{
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-21T17:23:31.090

MVC 要求，在强类型视图上，视图可以创建在该视图上使用的类。这意味着没有任何参数的构造函数。这是有道理的。刚接触 MVC 的人会看到类似的“嗯？” 当他们忘记/未能公开参数时出现问题，以及当视图尝试将自身组合在一起时弹出的所有此类相关错误（而不是编译器错误）。

但是在这类无参数构造函数问题中“有趣”的是，当你的类的属性也没有无参数构造函数时。我想这是悲观的方法吗？

在 SelectList 类（MVC 特有的类）上花费了一些学习时间后，我希望能帮助一些人节省几分钟/几小时。

这个用于创建下拉列表的非常重要的工具/类具有以下构造函数：

公共选择列表（IEnumerable 项）；public SelectList(IEnumerable items, object selectedValue); public SelectList(IEnumerable items, string dataValueField, string dataTextField); public SelectList(IEnumerable items, string dataValueField, string dataTextField, object selectedValue);

..因此，如果这些是您的类上的属性（用于视图的属性），MVC 会给您一个难以捉摸的“无无参数构造函数”错误。

但是，如果您创建类似帮助类的东西，请从原始类中剪切并粘贴确切的代码，然后将该帮助类作为原始类的参数（不是获取/设置）；你可以走了。

通过这种方式，您可以使用单个视图来获取和发布。哪个更漂亮:)

就个人而言，我要么创建编译器来识别强类型视图的关联和要求，要么让下拉列表（或 SelectList 的其他“客户”）不起作用，而不是想知道是否存在特定级别的递归检查在无参数构造函数上。

值得庆幸的是，当前版本似乎只是顶级的。感觉就像一个黑客，我希望它是设计使然。

HTH。

# c++ - 用 C++ 绘制图形和图表的免费简单方法？

> ID：765408
> 
> 赞同：31
> 
> 时间：2009-04-19T13:25:47.557
> 
> 标签：c++, charts

我正在做一些探索模拟，我想显示图表以比较运行时算法之间的性能。

你想到了什么图书馆？如果我的导师很容易编译我的代码，我非常喜欢那些小我喜欢的。我检查了[gdchart](http://www.fred.net/brv/chart/)但它似乎太重了。我只想要一个简单的 xy 时间线图。

如果你读过[这个](https://stackoverflow.com/questions/82294/is-there-any-open-source-library-in-c-for-3d-chart)类似的问题，谷歌图表当然是不可能的。

* * *

相关文章[C++ 中的散点图](https://stackoverflow.com/questions/215110/scatter-plots-in-c/)。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-19T14:14:31.263

我最喜欢的一直是[gnuplot](http://www.gnuplot.info/)。它非常广泛，因此对于您的需求来说可能有点太复杂了。它是跨平台的，并且有[一个 C++ API](http://www.stahlke.org/dan/gnuplot-iostream/)。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-19T13:45:57.323

老实说，我和你在同一条船上。我有一个想要连接到图形实用程序的 C++ 库。我最终使用了[Boost Python](http://www.boost.org/doc/libs/1_38_0/libs/python/doc/index.html)和[matplotlib](http://matplotlib.sourceforge.net/)。这是我能找到的最好的。

*作为旁注：我也对许可持谨慎态度。matplotlib 和 boost 库可以集成到专有应用程序中。*

这是我使用的代码示例：

```
#include <boost/python.hpp>
#include <pygtk/pygtk.h>
#include <gtkmm.h>

using namespace boost::python;
using namespace std;

// This is called in the idle loop.
bool update(object *axes, object *canvas) {
    static object random_integers = object(handle<>(PyImport_ImportModule("numpy.random"))).attr("random_integers");
    axes->attr("scatter")(random_integers(0,1000,1000), random_integers(0,1000,1000));
    axes->attr("set_xlim")(0,1000);
    axes->attr("set_ylim")(0,1000);
    canvas->attr("draw")();
    return true;
}

int main() {
    try {
        // Python startup code
        Py_Initialize();
        PyRun_SimpleString("import signal");
        PyRun_SimpleString("signal.signal(signal.SIGINT, signal.SIG_DFL)");

        // Normal Gtk startup code
        Gtk::Main kit(0,0);

        // Get the python Figure and FigureCanvas types.
        object Figure = object(handle<>(PyImport_ImportModule("matplotlib.figure"))).attr("Figure");
        object FigureCanvas = object(handle<>(PyImport_ImportModule("matplotlib.backends.backend_gtkagg"))).attr("FigureCanvasGTKAgg");

        // Instantiate a canvas
        object figure = Figure();
        object canvas = FigureCanvas(figure);
        object axes = figure.attr("add_subplot")(111);
        axes.attr("hold")(false);

        // Create our window.
        Gtk::Window window;
        window.set_title("Engineering Sample");
        window.set_default_size(1000, 600);

        // Grab the Gtk::DrawingArea from the canvas.
        Gtk::DrawingArea *plot = Glib::wrap(GTK_DRAWING_AREA(pygobject_get(canvas.ptr())));

        // Add the plot to the window.
        window.add(*plot);
        window.show_all();

        // On the idle loop, we'll call update(axes, canvas).
        Glib::signal_idle().connect(sigc::bind(&update, &axes, &canvas));

        // And start the Gtk event loop.
        Gtk::Main::run(window);

    } catch( error_already_set ) {
        PyErr_Print();
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-19T13:36:12.680

我用过这个“便携式绘图仪”。它非常小，多平台，易于使用，您可以将其插入不同的图形库。[绘图](http://pplot.sourceforge.net/)

（仅适用于地块部分）

如果您使用或计划使用 Qt，另一个多平台解决方案是[Qwt](http://qwt.sourceforge.net/)和[Qchart](http://www.wysota.eu.org/charts.html)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-19T18:16:31.820

Cern 的[ROOT](http://root.cern.ch/drupal/)产生了一些非常好的东西，我经常用它来显示神经网络数据。

# cocoa - NSAlert 可以用来创建浮动窗口吗？

> ID：765416
> 
> 赞同：8
> 
> 时间：2009-04-19T13:31:12.723
> 
> 标签：cocoa, nsalert

`NSAlert`我有一个 Cocoa 应用程序，它使用该类显示应用程序模式警报。我希望警报窗口浮动在所有其他应用程序的窗口之上。这可以用 来完成`NSAlert`，还是我需要实现自己的窗口？

我不知道这些是否重要，但该应用程序是一个代理应用程序（`LSUIElement`是真的），实现为`NSStatusItem`. （有关该应用程序的更多信息，包括源代码，请查看[<此处>](http://capablehands.net/menubarcountdown)。）

这是显示警报的代码：

```
- (void)showTimerExpiredAlert {
    [NSApp activateIgnoringOtherApps:YES];

    NSAlert *alert = [[NSAlert alloc] init];
    [alert setAlertStyle:NSInformationalAlertStyle];
    [alert setMessageText:NSLocalizedString(@"Menubar Countdown Complete", @"Expiration message")];
    [alert setInformativeText:NSLocalizedString(@"The countdown timer has reached 00:00:00.",
                                                @"Expiration information")];
    [alert addButtonWithTitle:NSLocalizedString(@"OK", @"OK button title")];
    [alert addButtonWithTitle:NSLocalizedString(@"Restart Countdown...", @"Restart button title")];

    NSInteger clickedButton = [alert runModal];
    [alert release];

    if (clickedButton == NSAlertSecondButtonReturn) {
        // ...
    }
} 
```

我试过在`runModal`通话之前把这个：

```
[[alert window] setFloatingPanel:YES]; 
```

我也试过这个：

```
[[alert window] setLevel:NSFloatingWindowLevel]; 
```

但是，如果我单击另一个应用程序的窗口，这些都不会使窗口保持在其他窗口之上。我怀疑`runModal`只是不尊重这些设置中的任何一个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-19T23:23:30.803

不久前，我为这件事伤透了脑筋。

我可以让它工作（有点）的唯一方法是继承 NSApplication，并覆盖 -sendEvent。在 -sendEvent 中，您首先调用 super 的实现，然后执行以下操作：

```
id *modalWindow = [self modalWindow];
if (modalWindow && [modalWindow level] != MY_DESIRED_MODAL_WINDOW_LEVEL)
    [modalWindow setLevel: MY_DESIRED_MODAL_WINDOW_LEVEL]; 
```

除此之外，即使这也不是一尘不染——在切换应用程序时——你无论如何都不想这样做，因为它是一种公然、粗暴的黑客行为。

所以是的，可悲的是，您最好编写自己的 NSAlert 版本。如果你真的关心这种可能性，我会在上面提交一个错误。NSApplication 不支持 [[alert window] setLevel: someLevel] 是很奇怪的，而且为了能够做到这一点，必须使用其所有简洁的自动布局功能重新构建 NSAlert 是一种浪费。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T02:03:36.557

我最终做的是放弃`NSAlert`，而是`NSWindow`从 NIB 加载警报。

这是显示窗口的代码：

```
- (void)showAlert {
    NSWindow *w = [self window];
    [w makeFirstResponder:nil];
    [w setLevel:NSFloatingWindowLevel];
    [w center];
    [w makeKeyAndOrderFront:self];
} 
```

这是为了让它像一个警报一样，除了它也浮动，它不是模态的，所以菜单项可以在它启动时选择。

还有什么我应该做的吗？

# javascript - 任何给定 DOM 元素的 Javascript 字数

> ID：765419
> 
> 赞同：18
> 
> 时间：2009-04-19T13:35:01.607
> 
> 标签：javascript

例如，我想知道是否有办法计算 div 中的单词。假设我们有一个这样的 div：

```
<div id="content">
hello how are you?
</div> 
```

然后让 JS 函数返回一个整数 4。

这可能吗？我已经用表单元素做到了这一点，但似乎无法为非表单元素做到这一点。

有任何想法吗？

G

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-19T13:38:16.000

如果您知道 DIV 中*只会*包含文本，则可以[KISS](http://en.wikipedia.org/wiki/KISS_principle)：

```
var count = document.getElementById('content').innerHTML.split(' ').length; 
```

如果 div 中可以包含 HTML 标记，则您将不得不遍历其子级以查找文本节点：

```
function get_text(el) {
    ret = "";
    var length = el.childNodes.length;
    for(var i = 0; i < length; i++) {
        var node = el.childNodes[i];
        if(node.nodeType != 8) {
            ret += node.nodeType != 1 ? node.nodeValue : get_text(node);
        }
    }
    return ret;
}
var words = get_text(document.getElementById('content'));
var count = words.split(' ').length; 
```

这与 jQuery 库用于实现其[`text()`](http://docs.jquery.com/Attributes/text)功能效果的逻辑相同。jQuery 是一个非常棒的库，在这种情况下它不是必需的。但是，如果您发现自己做了很多 DOM 操作或 AJAX，那么您可能需要检查一下。

**编辑**：

正如 Gumbo 在评论中指出的那样，我们拆分上述字符串的方式会将两个连续的空格算作一个单词。如果您期望这种事情（即使您不期望），最好通过拆分正则表达式而不是简单的空格字符来避免它。请记住这一点，而不是进行上述拆分，您应该执行以下操作：

```
var count = words.split(/\s+/).length; 
```

唯一的区别在于我们传递给[split](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/String/split)函数的内容。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-05-18T20:21:15.663

Paolo Bergantino 的第二个解决方案对于空字符串或以空格开头或结尾的字符串是不正确的。这是修复：

```
var count = !s ? 0 : (s.split(/^\s+$/).length === 2 ? 0 : 2 +
    s.split(/\s+/).length - s.split(/^\s+/).length - s.split(/\s+$/).length); 
```

**解释：**如果字符串为空，则字数为零；如果字符串只有空格，则有零个单词；否则，计算字符串开头和结尾没有空白组的数量。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-17T17:46:32.723

```
string_var.match(/[^\s]+/g).length 
```

似乎这是一个更好的方法

```
string_var.split(/\s+/).length 
```

至少它不会将“word”计为 2 个词——['word'] 而不是 ['word', '']。而且它真的不需要任何有趣的附加逻辑。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-07-22T12:43:20.453

或者只是使用[Countable.js](http://radlikewhoa.github.io/Countable/)来完成这项艰巨的工作；）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-20T00:32:12.357

```
document.deepText= function(hoo){
    var A= [];
    if(hoo){
        hoo= hoo.firstChild;
        while(hoo!= null){
            if(hoo.nodeType== 3){
                A[A.length]= hoo.data;
            }
            else A= A.concat(arguments.callee(hoo));
            hoo= hoo.nextSibling;
        }
    }
    return A;
} 
```

I'd be fairly strict about what a word is-

```
function countwords(hoo){
    var text= document.deepText(hoo).join(' ');
    return text.match(/[A-Za-z\'\-]+/g).length;
}
alert(countwords(document.body)) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-20T10:51:10.603

或者你可以这样做：

```
function CountWords (this_field, show_word_count, show_char_count) {
    if (show_word_count == null) {
        show_word_count = true;
    }
    if (show_char_count == null) {
        show_char_count = false;
    }
    var char_count = this_field.value.length;
    var fullStr = this_field.value + " ";
    var initial_whitespace_rExp = /^[^A-Za-z0-9]+/gi;
    var left_trimmedStr = fullStr.replace(initial_whitespace_rExp, "");
    var non_alphanumerics_rExp = rExp = /[^A-Za-z0-9]+/gi;
    var cleanedStr = left_trimmedStr.replace(non_alphanumerics_rExp, " ");
    var splitString = cleanedStr.split(" ");
    var word_count = splitString.length -1;
    if (fullStr.length <2) {
        word_count = 0;
    }
    if (word_count == 1) {
        wordOrWords = " word";
    } else {
        wordOrWords = " words";
    }
    if (char_count == 1) {
        charOrChars = " character";
    } else {
        charOrChars = " characters";
    }
    if (show_word_count & show_char_count) {
        alert ("Word Count:\n" + "    " + word_count + wordOrWords + "\n" + "    " + char_count + charOrChars);
    } else {
        if (show_word_count) {
            alert ("Word Count:  " + word_count + wordOrWords);
        } else {
            if (show_char_count) {
                alert ("Character Count:  " + char_count + charOrChars);
            }
        }
    }
    return word_count;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-01-14T00:53:37.580

这应该考虑到前面和后面的空格

```
const wordCount = document.querySelector('#content').innerText.trim().split(/\s+/).length; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-19T00:23:16.853

当两个子节点之间没有空间时，Paolo Bergantino 的答案中的 get_text 函数对我来说无法正常工作。例如 <h1>heading</h1><p>paragraph</p> 将作为标题段落返回（注意单词之间没有空格）。所以在 nodeValue 前面加上一个空格可以解决这个问题。但是它在文本的前面引入了一个空格，但我发现了一个字数统计功能，可以将其修剪掉（另外它使用了几个正则表达式来确保它只计算字数）。下面的字数统计和编辑的 get_text 函数：

```
function get_text(el) {
    ret = "";
    var length = el.childNodes.length;
    for(var i = 0; i < length; i++) {
        var node = el.childNodes[i];
        if(node.nodeType != 8) {
            ret += node.nodeType != 1 ? ' '+node.nodeValue : get_text(node);
        }
    }
    return ret;
}

function wordCount(fullStr) {
    if (fullStr.length == 0) {
        return 0;
    } else {
        fullStr = fullStr.replace(/\r+/g, " ");
        fullStr = fullStr.replace(/\n+/g, " ");
        fullStr = fullStr.replace(/[^A-Za-z0-9 ]+/gi, "");
        fullStr = fullStr.replace(/^\s+/, "");
        fullStr = fullStr.replace(/\s+$/, "");
        fullStr = fullStr.replace(/\s+/gi, " ");
        var splitString = fullStr.split(" ");
        return splitString.length;
    }
} 
```

**编辑**

肯尼贝克的单词计数器真的很好。但是我发现的那个包含一个数字作为我需要的单词。不过，这很容易添加到肯尼贝克的。但是kennebec的文本检索功能也会有同样的问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-07-30T05:24:50.707

`string_var.match(/[^\s]+/g).length - 1;`

# windows - Win32 事件驱动编程是如何在底层实现的？

> ID：765421
> 
> 赞同：11
> 
> 时间：2009-04-19T13:35:24.400
> 
> 标签：windows, winapi, message-queue, event-driven

在 Win32 C++ 应用程序中，我们启动一个消息循环，从队列中获取消息，翻译它们，然后分派它们。最终，每条消息都会到达我们的 WndProc，在那里可以处理相关的事件。

我理解那部分。我不明白的是中间发生的事情。具体来说：

1.  不同类型的 OS 中断处理程序必须将消息放入所述“消息队列”中，但是该队列驻留在进程地址空间的哪个位置？它是如何暴露给中断处理程序代码的？
2.  “翻译”信息是什么意思？调用的`TranslateMessage()`真正作用是什么？
3.  一旦被发送`DispatchMessage()`，消息在到达我的 WndProc 之前会经过哪些地方（即操作系统如何处理它）？

如果有人知道以上问题的答案，请满足我的好奇心。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T22:16:07.610

这取决于您的消息的发送方式和处理方式。

调用 SendMessage 时，如果目标窗口属于当前线程，则调用绕过窗口的消息队列，窗口管理器直接调用目标窗口上的 windowproc。如果目标窗口由另一个线程拥有，则窗口管理器有效地调用 PostMessage 并泵送窗口消息，直到目标窗口从窗口进程返回。

当您调用 PostMessage 时，窗口管理器会编组消息参数并将相应的对象插入到目标窗口的消息队列中。当它下一次调用 GetMessage 时，该消息将从消息队列中删除。

窗口管理器还注册来自输入设备（键盘和/或鼠标）的原始输入事件，并为这些输入事件生成消息。然后它将这些消息适当地插入到队列中（输入事件的处理很复杂，因为它取决于窗口的消息队列中已经有哪些消息）。

正如 Stefan 所指出的，TranslateMessage 只是翻译加速键 - 例如它将键序列转换为 WM_COMMAND 消息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-19T14:19:59.473

操作系统维护一个消息队列，它将事件放置在其中（例如，来自中断或其他来源）。然后它将消息从该队列发送到所有窗口，具体取决于消息（例如，它不会将关键消息发送到没有焦点的窗口）。

应用程序可以有自己的队列来处理消息。这些队列是[根据请求](http://blogs.msdn.com/oldnewthing/archive/2006/02/21/536055.aspx)创建的（仅在需要时）。

翻译消息用于创建不是“真实”事件的消息。例如，WM_CONTEXTMENU 消息是通过鼠标右键单击、上下文菜单键或 shift-F10 来“翻译”的。WM_CHAR 是从 WM_KEYDOWN 消息转换而来的。当然，许多其他消息都是以这种方式“翻译”的。

一条消息被发布到应该接收它的每个窗口。操作系统根据消息的类型决定窗口是否应该接收该消息。大多数消息由系统等待，即消息在被窗口处理之前不会被发送到另一个窗口。这对广播消息有很大的影响：如果一个窗口在处理该消息时没有返回，则队列被[阻塞](http://blogs.msdn.com/oldnewthing/archive/2005/03/10/392118.aspx)，其他窗口将不再接收该消息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T22:56:26.217

> 不同类型的 OS 中断处理程序必须将消息放入所述“消息队列”中，但是该队列驻留在进程地址空间的哪个位置？它是如何暴露给中断处理程序代码的？

窗口与线程相关联。每个具有窗口的线程在进程的地址空间中都有一个线程队列。操作系统在其自己的地址空间中有一个用于硬件生成事件的内部队列。使用事件的详细信息和其他状态信息（例如，哪个窗口具有焦点），操作系统将硬件事件转换为消息，然后将这些消息放置在适当的线程队列中。

发布的消息直接放置在目标窗口的线程队列中。

发送的消息通常直接处理（绕过队列）。

细节变得毛茸茸的。例如，线程队列不仅仅是消息列表——它们还维护一些状态信息。一些消息（如 WM_PAINT）并没有真正排队，而是在您查询队列并且它是空的时从附加状态信息合成。发送到其他线程拥有的窗口的消息实际上是发布到接收者的队列而不是直接处理，但是从调用者的角度来看，系统使它看起来像一个常规的阻塞发送。如果这会导致死锁（因为循环发送回原始线程），就会引起欢闹。

Jeffrey Richter 的书有很多（全部？）血腥细节。我的版本是旧的（高级 Windows）。当前版本似乎[通过 C/C++ 称为 Windows](https://rads.stackoverflow.com/amzn/click/com/0735624240)。

操作系统做了很多工作来使消息流在调用者看来是合理的（并且相对简单）。

> “翻译”信息是什么意思？调用 TranslateMessage() 的真正作用是什么？

它监视虚拟按键消息，当它识别出按键/按键组合时，它会添加字符消息。如果您不调用[TranslateMessage](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644955(v=vs.85).aspx)，您将不会收到 WM_CHAR 之类的字符消息。

我怀疑它在返回之前直接发送字符消息（而不是发布它们）。我从未检查过，但我似乎记得 WM_CHAR 消息在 WM_KEYUP 之前到达。

> 一旦被 DispatchMessage() 发送，消息在到达我的 WndProc 之前会经过哪些地方（即操作系统如何处理它）？

DispatchMessage 将消息传递给目标窗口的 WndProc。一路上，它的一些钩子可能有机会看到消息（并可能干扰它）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T11:31:48.603

为了解决最后一个子问题，在通过所有钩子 (WH_CALLWNDPROC) 传递消息后，发送的消息将发送到您的 WindowProc

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T14:12:07.760

对此并不绝对肯定，但我最好的猜测是：

1.  队列是您通过 Win32 API 调用访问的系统对象。它根本不在您的进程地址空间中。因此中断处理程序可以访问它（可能通过内核的 HAL（硬件抽象层））。

2.  在 Win16 中，该调用将更大消息的各个子部分合并为一个整体。所以 TranslateMessage 会在找到对应的 WM_KEYDOWN WM_KEYUP 序列时添加 WM_KEYPRESS。它还会根据内部设置和消息的时间戳将各种按钮单击消息转换为双击消息。在Win32中是否仍然这样做，我不知道。

3.  DispatchMessage 可能是处理 Window 消息挂钩的地方。因此，如果您的窗口上有一个钩子，它要么在此处调用，要么在调用 GetMessage 时调用。我不确定。除此之外，DispatchMessage 只是查找与窗口关联的 WndProc 地址并调用它。它没有太多其他事情要做。

希望有帮助。

# c# - C# 中的 Jaxb 等效项

> ID：765422
> 
> 赞同：17
> 
> 时间：2009-04-19T13:35:41.513
> 
> 标签：c#, linq, linq-to-xml, jaxb

在 Java 中使用 JAXB 很容易从 xml 模式文件生成一组 Java 类，符合该模式的 xml 可以反序列化为这些类。

是否有一些 C# 等效的 JAXB？我知道 Linq 可以序列化和反序列化与 xml 文件之间的类。但是如何从 xml 模式文件生成 C# 类，然后将这些类与 linq 一起使用？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-19T13:37:46.593

~~如果您使用的是 Visual Studio，请~~尝试使用[**XML 架构定义工具**](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.80).aspx)。它采用您的模式定义并生成 C# 类——或者它可以采用另一种方式并从类中生成模式定义。它还具有许多其他与 XML 相关的转换。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T21:06:32.493

Microsoft 有一个更好的工具，称为[XsdObjectGen](http://msdn.microsoft.com/en-us/xml/bb190622.aspx)，即 XSD 对象代码生成器。它类似于 xsd.exe，但更好。同样免费，它不是 .NET SDK 的一部分，而是单独下载。

另请参阅 SO 问题：[XSDObjectGen vs Xsd.exe](https://stackoverflow.com/questions/289335/xsdobjectgen-exe-vs-xsd-exe)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-21T21:18:02.947

研究使用 DataSet。这与使用“Java Beans”有点不同。整个 XML 文档都被视为一个类中的分层表集。好的部分是 OOP 的封装理论实际上得到了执行。哇，Microsoft 做对了 Sun 拒绝的事情。

反正。如果您想让事情变得更有趣，您还可以查看类型化的 DataSet。我已经在重大项目中使用它并取得了巨大的成功。

# asp.net - 无法在 Visual Studio 2008 Web Developer 版中创建 Silverlight ASP.NET 网站

> ID：765429
> 
> 赞同：1
> 
> 时间：2009-04-19T13:38:35.920
> 
> 标签：asp.net, silverlight, visual-studio-express, visual-web-developer

我需要创建一个带有 Silverlight 控件的 ASp.net 网站。

我只有 2008 年的特快版（Web 开发者版和 C# 特快版）。

我已经创建了 WPF 应用程序唱 C# 表达式并创建了新的 XAML 文件。

然后我在 web 开发者版中创建了 asp.net 网站，并将 xaml 文件与 .

但没有任何效果。

注意：我在 Visual Studio 2008 Web 开发者版中没有 silverlight 应用程序项目类型和模板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T13:44:31.023

我认为您需要安装 Service Pack 1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T07:07:08.307

如果您有 Visual Web Developer，并且没有获得创建 silverlight 的模板，那么您可能需要从此链接安装 Silverlight 插件

www.microsoft.com/downloads/details.aspx?FamilyId=c22d6a7b-546f-4407-8ef6-d60c8ee221ed&displaylang=en

# opengl - 来自 FBO 的 glReadPixels 因多重采样而失败

> ID：765434
> 
> 赞同：9
> 
> 时间：2009-04-19T13:39:42.533
> 
> 标签：opengl, fbo, multisampling

我有一个带有颜色和深度附件的 FBO 对象，我渲染到它然后从使用中读取`glReadPixels()`，我正在尝试向它添加多重采样支持。
而不是`glRenderbufferStorage()`我要求`glRenderbufferStorageMultisampleEXT()`颜色附件和深度附件。帧缓冲区对象似乎已成功创建并报告为完整。
渲染后，我尝试使用`glReadPixels()`. 当样本数为 0 时，即多重采样禁用它可以完美地工作，我得到了我想要的图像。当我将样本数设置为其他值（例如 4）时，帧缓冲区仍然可以正常构建，但`glReadPixels()`失败并出现`INVALID_OPERATION`

有人知道这里可能出了什么问题吗？

编辑： glReadPixels 的代码：

```
glReadPixels(0, 0, width, height, GL_RGBA, GL_UNSIGNED_BYTE, ptr); 
```

其中 ptr 指向宽度*高度单位的数组。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-29T18:03:51.663

我认为您无法使用 glReadPixels() 从多采样 FBO 中读取数据。您需要从多重采样 FBO 到普通 FBO，绑定普通 FBO，然后从普通 FBO 读取像素。

像这样的东西：

```
// Bind the multisampled FBO for reading
glBindFramebufferEXT(GL_READ_FRAMEBUFFER_EXT, my_multisample_fbo);
// Bind the normal FBO for drawing
glBindFramebufferEXT(GL_DRAW_FRAMEBUFFER_EXT, my_fbo);
// Blit the multisampled FBO to the normal FBO
glBlitFramebufferEXT(0, 0, width, height, 0, 0, width, height, GL_COLOR_BUFFER_BIT, GL_NEAREST);
//Bind the normal FBO for reading
glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, my_fbo);
// Read the pixels!
glReadPixels(0, 0, width, height, GL_RGBA, GL_UNSIGNED_BYTE, pixels); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T11:53:17.097

您不能直接使用 glReadPixels 读取多重采样缓冲区，因为它会引发 GL_INVALID_OPERATION 错误。您需要 blit 到另一个表面，以便 GPU 可以进行下采样。您可以对后台缓冲区进行 blit，但存在“像素所有者船舶测试”的问题。最好再做一个FBO。假设您制作了另一个 FBO，现在您想要 blit。这需要 GL_EXT_framebuffer_blit。通常，当您的驱动程序支持 GL_EXT_framebuffer_multisample 时，它​​也支持 GL_EXT_framebuffer_blit，例如 nVidia Geforce 8 系列。

```
 //Bind the MS FBO
 glBindFramebufferEXT(GL_READ_FRAMEBUFFER_EXT, multisample_fboID);
 //Bind the standard FBO
 glBindFramebufferEXT(GL_DRAW_FRAMEBUFFER_EXT, fboID);
 //Let's say I want to copy the entire surface
 //Let's say I only want to copy the color buffer only
 //Let's say I don't need the GPU to do filtering since both surfaces have the same dimension
 glBlitFramebufferEXT(0, 0, width, height, 0, 0, width, height, GL_COLOR_BUFFER_BIT, GL_NEAREST);
 //--------------------
 //Bind the standard FBO for reading
 glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, fboID);
 glReadPixels(0, 0, width, height, GL_BGRA, GL_UNSIGNED_BYTE, pixels); 
```

来源：[GL EXT 帧缓冲多样本](http://www.opengl.org/wiki/GL_EXT_framebuffer_multisample)

# ruby-on-rails - 在 Ruby on Rails 应用程序中使用 RSpec 时，存根 Mock 对象的 #class 方法是否合法？

> ID：765437
> 
> 赞同：2
> 
> 时间：2009-04-19T13:42:46.613
> 
> 标签：ruby-on-rails, class, rspec, mocking, stub

我想存根模拟对象的#class 方法：

```
describe Letter do
  before(:each) do
    @john = mock("John")
    @john.stub!(:id).and_return(5)
    @john.stub!(:class).and_return(Person)  # is this ok?
    @john.stub!(:name).and_return("John F.")
    Person.stub!(:find).and_return(@john)
  end
  it.should "have a valid #to field" do
    letter = Letter.create!(:to=>@john, :content => "Hello John")
    letter.to_type.should == @john.class.name
    letter.to_id.should == @john.id
  end
  [...]
end 
```

在这个程序的第 5 行，我存根 #class 方法，以便允许像 @john.class.name 这样的东西。这是正确的方法吗？会不会有什么不好的副作用？

*编辑：*

Letter 类如下所示：

```
class Letter < ActiveRecord::Base
    belongs_to :to, :polymorphic => true
    [...]
end 
```

我想知道 ActiveRecord 是否通过`to.class.name`或通过其他方式获取 :to 字段的类名。也许这就是 ActiveRecord::Base 的 class_name 方法的用途？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T14:42:14.380

我认为你应该使用`mock_model`这种特殊情况。你`before(:each)`看起来像这样：

```
before(:each) do
  @john = mock_model(Person, :name => "John F.")
  Person.stub!(:find).and_return(@john)
end 
```

然后对于您的另一个问题，您不应该真正关心 Rails 如何测试您的行为。我认为自己测试 to_type 和 to_id 字段不是一个好主意。这是 Rails 的行为，因此应该在 Rails 中进行测试，而不是在您的项目中。

我使用[Remarkable](http://remarkable.rubyforge.org/)已经有一段时间了，它使这很容易指定：

```
describe Letter
  should_belong_to :to, :polymorphic => true
end 
```

# ruby - 从 webrick 流式传输 html？

> ID：765442
> 
> 赞同：1
> 
> 时间：2009-04-19T13:46:32.937
> 
> 标签：ruby, streaming, webrick

有没有人尝试过从 webrick 流式传输 html/文本/内容？我尝试将 IO 分配给响应正文，但 webrick 正在等待流首先关闭。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T14:25:31.847

偶然发现了这个链接（[http://redmine.ruby-lang.org/attachments/download/161](http://redmine.ruby-lang.org/attachments/download/161)），其中包含 webrick 补丁

```
# Copyright (C) 2008 Brian Candler, released under Ruby Licence.
#
# A collection of small monkey-patches to webrick.

require 'webrick'

module WEBrick

  class HTTPRequest
    # Generate HTTP/1.1 100 continue response. See
    # http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-core/18459
    def continue
      if self['expect'] == '100-continue' && @config[:HTTPVersion] >= "1.1"
        @socket.write "HTTP/#{@config[:HTTPVersion]} 100 continue\r\n\r\n"
        @header.delete('expect')
      end
    end
  end

  class HTTPResponse
    alias :orig_setup_header :setup_header
    # Correct termination of streamed HTTP/1.1 responses. See
    # http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-core/18454 and
    # http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-core/18565
    def setup_header
      orig_setup_header
      unless chunked? || @header['content-length']
        @header['connection'] = "close"
        @keep_alive = false
      end
    end

    # Allow streaming of zipfile entry. See
    # http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-core/18460
    def send_body(socket)
      if @body.respond_to?(:read) then send_body_io(socket)
      elsif @body.respond_to?(:call) then send_body_proc(socket)
      else send_body_string(socket)
      end
    end

    # If the response body is a proc, then we invoke it and pass in
    # an object which supports "write" and "<<" methods. This allows
    # arbitary output streaming.
    def send_body_proc(socket)
      if @request_method == "HEAD"
        # do nothing
      elsif chunked?
        @body.call(ChunkedWrapper.new(socket, self))
        _write_data(socket, "0#{CRLF}#{CRLF}")
      else
        size = @header['content-length'].to_i
        @body.call(socket)   # TODO: StreamWrapper which supports offset, size
        @sent_size = size
      end
    end

    class ChunkedWrapper
      def initialize(socket, resp)
        @socket = socket
        @resp = resp
      end
      def write(buf)
        return if buf.empty?
        data = ""
        data << format("%x", buf.size) << CRLF
        data << buf << CRLF
        socket = @socket
        @resp.instance_eval {
          _write_data(socket, data)
          @sent_size += buf.size
        }
      end
      alias :<< :write
    end
  end
end

if RUBY_VERSION < "1.9"
  old_verbose, $VERBOSE = $VERBOSE, nil
  # Increase from default of 4K for efficiency, similar to
  # http://svn.ruby-lang.org/cgi-bin/viewvc.cgi/branches/ruby_1_8/lib/net/protocol.rb?r1=11708&r2=12092
  # In trunk the default is 64K and can be adjusted using :InputBufferSize,
  # :OutputBufferSize
  WEBrick::HTTPRequest::BUFSIZE = 16384
  WEBrick::HTTPResponse::BUFSIZE = 16384
  $VERBOSE = old_verbose
end 
```

使用简单地将 proc 传递给作为响应主体，就像这样

```
res.body = proc { |w|
  10.times do
    w << Time.now.to_s
    sleep(1)
  end
} 
```

哇！

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-04-20T02:09:01.093

我建议不要将 WEBrick 用于任何事情，它是垃圾。我会说尝试 Mongrel。

我知道这不是你的问题，只是一些友好的建议。

# asp.net - 我可以将自动生成的编辑和删除列 ASP.Net 移动到表的末尾吗？

> ID：765443
> 
> 赞同：1
> 
> 时间：2009-04-19T13:47:55.523
> 
> 标签：asp.net, gridview

我正在使用 ASP.Net 2.0。我在一些数据上使用了 gridview 组件，因为我想获得它提供的分页功能。我的站点的其余部分不需要提供分页，因为我使用了字母索引，或者因为结果集小到可以放入我使用中继器的屏幕。在中继器中，我在自己的单元格中将删除快捷方式添加到表的末尾。通过单击结果中的任何行来提供编辑链接，这会将您带到一个新屏幕，您可以在其中编辑详细信息。

我一直无法找到将编辑和删除列移动到最后的方法。是否有可能我错过了一个属性，或者最简单的方法是扩展 Gridview 组件。如果是这种情况，最好扩展组件或尝试编写我自己的分页功能来配合我的转发器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T16:12:22.353

您可以使用 gridView 智能标签中的“编辑列”对话框手动添加编辑和删除字段，而不是使用自动生成的删除和编辑按钮。确保未选择自动生成字段，然后您可以根据需要添加列，并且编辑、删除和插入都可以作为 CommandField 选项的子项使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T13:57:57.293

最好的解决方案是将分页功能添加到您的数据访问解决方案中，这样如果您需要第 3 页，您只能获得这十条记录，而不是整个列表。这样，您还可以使用转发器来呈现列表，而不必使用分页功能对其进行扩展 - 只需在底部添加另一个转发器，将页码作为链接循环出。

但是，如果这不可能，最简单的方法可能是手动配置 GridView 以呈现您想要的方式（或尽可能接近......）。自从我使用 GridView 以来已经有一段时间了，但我在下面显示的名称至少足够接近，您可以在 VS 中使用 Intellisense 找到正确的名称。

首先，设置

```
AutoGenerateColumns = False 
```

在您的 GridView 上。然后，在标签之间添加一个`<Columns></Columns>`部分。`<asp:GridView></asp:GridView>`在该部分中，您应该能够指定要呈现的每个字段以及您希望它们的顺序。

# security - 为什么面向企业的开源应用程序没有这些安全功能？

> ID：765448
> 
> 赞同：0
> 
> 时间：2009-04-19T13:54:58.097
> 
> 标签：security, open-source, identity

1.  在我看来，许多大型企业已经拥有强大的目录服务，例如 Active Directory，并且在特定于应用程序的商店中不断复制用户是很愚蠢的。

2.  即使您需要复制用户存储，您也可以提供一种针对 Active Directory 进行身份验证的机制。或者，您可以支持利用 SAML 的基于标准的 SSO 机制。

3.  支持 XACML 协议。复制有关角色和权利的信息同样是阴险的。

4.  支持 SPML 协议。许多企业利用身份管理工具包，并且至少希望在集中管理和供应方面进行开箱即用的集成。

那么，为什么开源项目不将这种类型的功能视为在企业环境中引起关注的默认功能呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T14:38:14.217

有很多原因，但最大的原因之一是，对于正确或最佳方法的真正含义，并没有你想象的那么容易。

*   例如，Active Directory 因给非 Microsoft 开发人员带来实施困难而臭名昭著。

*   可能有六种相互竞争的单点登录“标准”。

*   协调不同的角色/权限模型非常困难——该死，Sun 在协调 Solaris Trusted Extensions 模型与 Java 模型时遇到了麻烦。

*   解决这些问题并不是很“有趣”，因此 FOSS 开发人员会被其他问题所吸引。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T15:48:05.157

我认为[查理做到了](https://stackoverflow.com/questions/765448/how-come-open-source-applications-that-are-targeted-at-enterprises-dont-have-th/765504#765504)：

> 解决安全问题很困难，而且通常没有很多乐趣

OSS 开发人员倾向于享受他们正在做的事情。作为我职业生涯的一部分，我从事一些“企业级”工作，我同意它们并不是很有趣。然而，这是我对 OSS 组件永无止境的悲痛之一……我们在解决方案中使用它们时遇到了麻烦，因为它们不能满足我们客户的需求。

我认为一般的原因是：

*   大学往往忽视“企业发展”这一方面
*   可供选择的标准太多
*   没有明确的市场领导者
*   不同的安全提供者难以配置和测试
*   整个应用程序安全范式需要大量专业知识才能开始尝试集成

就个人而言，我责怪第一个。大多数工程师甚至没有考虑如何在更大的环境中使用应用程序。他们对解决手头的问题感兴趣，而对提供可用的解决方案完全不感兴趣。大多数 FOSS 解决方案是一个有趣问题的非常有趣的解决方案。公司实体通常会出现并提供使 FOSS 解决方案在真实环境中实际可用的商业包装。当然，这个包装附有价格标签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T16:34:32.643

Open ID 是提供“身份验证”解决方案的开始。（据我所知，它没有“配置”机制。您必须信任外部机构来识别帐户，然后使用您自己的设备添加您的站点/应用程序版本的该帐户）

如果有人知道某种开放的“授权”解决方案来集中管理角色，那也会很有趣。不过，这听起来像是你会在内部做的事情，角色在你的组织中具有明确的意义。不过，我相信 IBM 或 Oracle 会很乐意进行大量更改并为您做点什么:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T10:31:52.310

您可能不希望您的活动目录/LDAP 包含您所有应用程序的所有用户的角色。如果你的结构中有很多运动，你可能会进行大量的日常修改。

此外，用户存储中的信息可能非常具体，并且可能在全局存储库中没有它的位置。

至少，角色的概念可能非常多变。我们有三个具有“经理”概念的应用程序，每个应用程序对什么是经理以及他/她管理谁的定义略有不同。

问候，纪尧姆

# geometry - CGAL：给定两条线/向量/方向的旋转变换矩阵

> ID：765453
> 
> 赞同：2
> 
> 时间：2009-04-19T13:59:22.797
> 
> 标签：geometry, rotation, cgal

如何通过CGAL中两条线/向量/方向之间的角度生成用于旋转点/其他的变换矩阵？

2D是我需要的。3D是我喜欢的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T14:36:58.107

根据[手册](http://www.cgal.org/Manual/3.4/doc_html/cgal_manual/Kernel_23_ref/Class_Aff_transformation_2.html)，您可以使用以下工具：

> `Aff_transformation_2<Kernel> t ( const Rotation, Direction_2<Kernel> d, Kernel::RT num, Kernel::RT den = RT(1))`
> 
> > 近似旋转由方向 d 指示的角度，使得由 d 给出的旋转和近似旋转的正弦和余弦之间的差异最多为 num/den。前提条件：num/den>0 且 d != 0。
> 
> `Aff_transformation_2<Kernel> t.operator* ( s)` 组成两个仿射变换。
> 
> `Aff_transformation_2<Kernel> t.inverse ()` 给出逆变换.

使用它们，您应该能够计算对应于两个方向的矩阵，并使用如下方式的恒等式：

```
Mat(d1-d2) === Mat(d1)*Inv(Mat(d2)) 
```

得到你想要的。

# c# - C#：制作一个同时安装 WPF 应用程序 (ClickOnce) 和 Windows 服务的安装程序

> ID：765457
> 
> 赞同：4
> 
> 时间：2009-04-19T14:01:19.127
> 
> 标签：c#, wpf, windows-services, clickonce

我目前有一个带有 2 个项目的 VS 解决方案：一个 WPF 应用程序和一个 Windows 服务。

现在，我已经设法让 ClickOnce 安装我的 WPF 应用程序，但我还希望在此安装过程中安装一个 Windows 服务（项目中的那个）。

我已经找到了如何使用 C# 代码以编程方式启动 Windows 服务的方法，但是有没有办法将其合并到我的 ClickOnce 安装中（因为我需要 ClickOnce 的自动更新等优势）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T14:46:07.023

我认为您不能以正常方式通过 ClickOnce 部署 Windows 服务。

[http://social.msdn.microsoft.com/Forums/en-US/winformssetup/thread/1bb64760-9622-4ca6-a1a6-3ce53e641f21](http://social.msdn.microsoft.com/Forums/en-US/winformssetup/thread/1bb64760-9622-4ca6-a1a6-3ce53e641f21)

[ClickOnce 部署 Windows 服务？](https://stackoverflow.com/questions/460118/clickonce-deploy-a-windows-service)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T12:03:32.613

请检查[DDay 更新](http://www.ddaysoftware.com/Pages/Projects/DDay.Update/)库，它可能会为您提供 ClickOnce 的更新内容，但首先安装您也必须使用另一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T17:37:32.023

您可以在 ClickOnce 安装期间执行一个过程吗？您可以使用[Topshelf](http://code.google.com/p/topshelf/)编写服务，然后从 ClickOnce 执行 MyService.exe /install。

# c++ - 当您的嵌入式编译器不支持 operator new 或 STL 时，您如何使用 C++？

> ID：765459
> 
> 赞同：7
> 
> 时间：2009-04-19T14:01:47.160
> 
> 标签：c++, c, embedded, memory-management, microcontroller

我正在为我的大学做一个小组高级项目，我在尝试让我的代码工作时遇到了一个主要障碍。

我们的 8 位 Atmel 微控制器的编译器不支持 new 或 delete 运算符，也不支持 C++ STL。我可以用 C 编写它，但我必须实现一个我以前从未做过的 A* 算法。虽然我最初尝试过 C，但我很快意识到我以前从未使用过纯 C。尝试使用结构和函数对对象进行建模让我放慢了速度，因为我已经习惯了更简洁的 C++ 语法。

无论如何，我的编译器缺点的确切措辞可以在这里找到：[http ://www.nongnu.org/avr-libc/user-manual/FAQ.html#faq_cplusplus](http://www.nongnu.org/avr-libc/user-manual/FAQ.html#faq_cplusplus)

为了克服它们并仍然使用 C++，我考虑了以下可能性。1）不要分配任何东西，只需使用模板在堆栈上生成固定数组。2）一旦我为它们分配了空间，就分配并找到一些技巧来调用对象的构造函数。放置 new 不是一个选项，因为 new 不是运算符。3) 只需使用 C 并把它吸起来，它是一个微控制器，为什么我会喜欢它？4）找到一个更好的编译器，它可能会花费$$$。

第二种选择是最难的，但就我如何编写这段代码而言，它会带来最大的回报。但是，我想如果我弄错了调试它可能会很痛苦。我正在考虑在堆栈上创建对象，将它们的位复制到分配的空间中，然后将对象中的位清零，这样它就不会调用它的析构函数。为此，我将使用 unsigned char 指针和 sizeof 运算符直接访问这些位以获取字节数。

这听起来很糟糕，我不知道它是否可以可靠地工作，但我正在考虑。我知道 vtables 可能是个问题，但我不打算拥有任何 vtables，因为它只是一个 8 位微控制器。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-19T14:20:51.093

不要与你的工具抗争。如果您的嵌入式系统唯一的编译器是 C 编译器，请学习 C - 这并不难。仅仅为了解决一个相当简单的编程问题而试图制作这两种语言的一些混蛋版本只会以眼泪收场。

换个角度来看，如果您的嵌入式平台甚至不支持 C 编译器，而只支持汇编器，您的第一个冲动会是坐下来用汇编器编写 C++ 编译器吗？我希望不是，我希望你能坐下来学习使用汇编程序来完成你的任务——编写一个 C++ 编译器（甚至是一个 C 编译器）完全不适合你的时间，而且几乎肯定会导致失败。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-19T14:31:10.723

只是为了记录，将对象中的位归零不会影响析构函数是否被调用（除非编译器有一个特殊的怪癖来启用这种行为）。只需在你的析构函数中写一些日志语句来测试它。

构建您的程序不分配任何东西可能是系统的设计方式。我以前没有使用过嵌入式系统，但是我读过一些有经验的嵌入式商店，他们不鼓励使用动态内存，因为运行时环境中的动态内存很少。

* * *

但是，如果必须，您仍然可以使用放置新。如果您没有`<new>`标题，以下是我的 GCC 版本上直接来自它的相关行：

```
// Default placement versions of operator new.
inline void* operator new(std::size_t, void* __p) throw() { return __p; }
inline void* operator new[](std::size_t, void* __p) throw() { return __p; }

// Default placement versions of operator delete.
inline void  operator delete  (void*, void*) throw() { }
inline void  operator delete[](void*, void*) throw() { } 
```

将其粘贴在每个使用放置新/删除的源文件包含的头文件中。

测试这个的示例文件：

```
#include <cstdio>
#include <new>

int
main(int argc, char** argv)
{
    typedef char const* cstr;
    char foobar[16];
    cstr* str = new (&foobar) cstr(argc > 1 ? argv[1] : "Hello, world!");
    std::puts(*str);
    str->~cstr();
} 
```

在我的 GCC 版本上，这根本不使用`libstdc++`（如果`-fno-exceptions`使用）。

* * *

现在，如果你想将它与`malloc`（如果你的平台提供这个）结合起来，那么你可以这样做：

```
#include <cstdio>
#include <cstdlib>

inline void* operator new  (std::size_t n) {return std::malloc(n);}
inline void* operator new[](std::size_t n) {return std::malloc(n);}
inline void  operator delete  (void* p) {std::free(p);}
inline void  operator delete[](void* p) {std::free(p);}

int
main(int argc, char** argv)
{
    typedef char const* cstr;
    cstr* str = new cstr(argc > 1 ? argv[1] : "Hello, world!");
    std::puts(*str);
    delete str;
} 
```

这允许您使用您熟悉的标准`new`/ ，而无需使用.`delete``libstdc++`

祝你好运！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-19T15:46:22.773

我认为你是从一个不太理想的角度来处理这个问题。

您专注于编译器（或缺少编译器），而不是专注于硬件。

您的主要问题最可能的答案是“因为硬件不支持所有 C++ 东西”。嵌入式硬件（微控制器）以定制硬件设计而著称——内存映射、中断处理程序、I/O 等。

在我看来，您应该首先花一些时间阅读有关微控制器的硬件书籍，了解设备的来龙去脉——即它是如何设计的以及主要用途是什么。一些设计用于快速内存操作，一些用于快速 I/O 处理，一些用于 A/D 类型的工作，一些用于信号处理。微控制器的类型决定了他们为它编写的汇编指令，这决定了任何更高级别的编译器可以有效地做什么。

如果这很重要，请花一些时间查看汇编器 - 它会告诉您设计人员认为什么是重要的。它还将告诉您很多关于您可以从高级编译器中获得多少的信息。

通常，微控制器不支持 C++，因为设计真的不关心对象或花哨的内存处理（从 C++ 的角度来看）。可以做到，但是您经常尝试在方孔中敲击圆钉，以使构造函数和析构函数（以及“新”和“删除”）在微环境中工作。

如果你有一个用于这个单元的 C 编译器，那么认为它是一种祝福。一个好的 C 编译器通常“绰绰有余”来创建出色的嵌入式软件。

干杯，

-理查德

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-19T14:28:03.120

仅仅因为它没有这些工具并不意味着您不能从 C++ 中受益。如果项目足够大，那么仅使用面向对象设计就足够了。

如果它不支持“新”，那么可能是因为自动区分堆和堆栈是没有意义的。这可能是因为您的内存配置。这也可能是因为内存资源非常有限，只有非常小心的分配才有意义。如果您绝对必须实现自己的“新”运算符，您可能会考虑调整[Doug Lea 的 malloc](http://g.oswego.edu/dl/html/malloc.html)。我相信他在类似的情况下开始了他的分配器（重新实现 C++ 的新功能）。

我喜欢 STL，但没有它仍然可以做有用的事情。根据项目的范围，您最好只使用数组。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-19T15:09:23.177

我有一个类似的编译器，它实现了一个奇怪的[Embedded-C++ 标准](http://www.caravan.net/ec2plus/)版本。我们有`operator new`哪些会为我们调用构造函数，而*在大多数情况下*会调用析构函数。编译器/运行时供应商去实施`try`和`catch`使用`setjmp`，并`longjmp`为*工程师提供方便*。问题是他们从未提到 a`throw`不会导致调用本地对象的析构函数！

无论如何，在有人编写了一个像标准 C++ 一样的应用程序之后，我们的团队继承了代码库：使用 RAII 技术和所有其他优点。我们最终改用我们许多人所说*的面向对象的 C*来重写它。您可能想考虑硬着头皮直接用 C 语言编写。而不是构造函数，有一个显式调用的初始化方法。析构函数成为显式调用的终止方法。没有多少 C++ 是您不能很快在 C 中模仿的。是的，MI 很痛苦……但是单继承很容易。查看[此 PDF](http://www.planetpdf.com/codecuts/pdfs/ooc.pdf)以获得一些想法。它几乎描述了我们采用的方法。我真希望我把我们的方法写在某个地方……

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-19T16:34:53.720

[您可以在我的 A* 教程网站](http://www.geocities.com/jheyesjones/astar.html)上找到一些有用的代码。尽管我为支持这一点而编写的[代码](http://code.google.com/p/a-star-algorithm-implementation/)使用了 STL，但应该很容易去除 STL 支持。此外，它还包含一个池分配器 (fsa.h)，我编写它以加速游戏机上的 STL。它是 C++ 代码，但我最初是从 C 移植过来的，我认为用另一种方式来做并不难。该代码已经过 10,000 多人的测试，因此它是一个很好的起点。

替换我正在使用的 STL 结构没有问题，因为它仅限于向量。我使用堆函数（make_heap 和 push_heap）将其中一个向量用作优先级队列。你可以用我的[旧 C 代码](http://www.geocities.com/SiliconValley/Lakes/4929/datacode.zip)替换它，它有一个用 C 实现的优先级队列，应该直接放入你的代码中。（它只做一个分配，所以你可以用一个指向你的内存保留区域的指针来替换它。

正如您在标头中的代码片段中看到的那样，C 代码的主要区别在于没有 this 指针，也没有对象，因此您的代码通常将对象指针作为第一个参数。

```
void PQueueInitialise( PQUEUE *pq, int32 MaxElements, uint32 MaxRating, bool32 bIsAscending );
void PQueueFree( PQUEUE *pq );
int8 PQueuePush( PQUEUE *pq, void *item,  uint32 (*PGetRating) ( void * ) );
int32 PQueueIsFull( PQUEUE *pq );
int32 PQueueIsEmpty( PQUEUE *pq );
void *PQueuePop( PQUEUE *pq, uint32 (*PGetRating) ( void * ) ); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-19T14:11:55.263

为什么不先在台式机上编写，考虑到编译器的限制，调试它，确保它完美运行，然后才转移到嵌入式环境？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-19T15:22:07.793

在进行嵌入式工作时，我曾经什至无法将 C 运行时链接到内存限制，但是硬件有一个 DMA（动态内存分配器）指令，所以我用那个硬件编写了自己的 malloc，你的硬件可能具有类似的功能，所以您可以编写一个 malloc，然后基于 malloc 编写一个新的。

无论如何，最后我使用了 99% 的堆栈分配，并且一些限制设置了我将通过就地构建来回收的 os 静态对象。这可能是一个很好的解决方案。

# java - Java I/O 流过滤器示例

> ID：765473
> 
> 赞同：0
> 
> 时间：2009-04-19T14:13:28.800
> 
> 标签：java, sockets, network-programming, filter, stream

我正在寻找演示如何创建理解*二进制*数据的过滤器的示例代码。非常感谢示例链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T14:53:08.330

如果您指的是 FilterInputStream/FilterOutputStream 的示例，那么您只需看看 JDK。为了论证，我将讨论输入流变体，但同样适用于输出流。

例如，看看 InflaterInputStream。查看数组的 read() 方法，并注意在某些时候 if 调用了 fill()，它又从底层输入流中读取。然后，围绕该方法，它调用 Inflater 以实际将其从底层流中提取的“原始”字节缓冲区转换为写入调用方数组的实际字节。

要考虑的一件事是 FilterInputStream 有点浪费空间。只要您可以定义您的 InputStream 以获取另一个基础 InputStream，并且在您从该基础流中读取的所有读取方法中（请记住，理论上您只需要定义字节 read() 方法），然后特别是让你的类扩展 FilterInputStream 并不能真正为你买太多。例如，下面是输入流的部分代码，它限制了它允许调用者读取的底层流的字节数（实际上，我们可以将一个流“切分”成几个子流，这很有用例如，从存档文件中读取时）：

```
class LimitedInputStream extends InputStream {
  private InputStream in;
  private long bytesLeft;

  LimitedInputStream(InputStream in, long maxBytes) {
    this.in = in;
    this.bytesLeft = maxBytes;
  }

  @Override
  public int read() throws IOException {
    if (bytesLeft <= 0)
      return -1;
    int b = in.read();
    bytesLeft--;
    return b;
  }

  @Override
  public int read(byte b[], int off, int len) throws IOException {
    if (bytesLeft <= 0)
      return -1;
    len = (int) Math.min((long) len, bytesLeft);
    int n = in.read(b, off, len);
    if (n > 0)
      bytesLeft -= n;
    return n;
  }

  // ... missed off boring implementations of skip(), available()..
} 
```

在这种情况下，在我的应用程序中，将此类声明为 FilterInputStream 并没有给我带来任何好处——实际上，这是在想要调用 in.read() 或 super.read() 来获取底层数据之间的选择...... ！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T15:34:04.987

举个很好的例子，我建议看一下[`java.io.DataInputStream`](http://java.sun.com/javase/6/docs/api/java/io/DataInputStream.html). 此类向您展示了一种从“二进制”数据中解码原始类型和字符串的方法，从中可以生成更复杂的结构。

当然，其他应用程序可能会选择使用其他编码。例如，[ASN.1“可区分编码规则”](http://luca.ntop.org/Teaching/Appunti/asn1.html)用于公钥基础设施应用程序。[Lucene](http://lucene.apache.org/java/2_3_2/fileformats.html)为其文件格式提供了良好的文档，该文件格式专为紧​​凑而设计。

如果您有 Sun JDK，请在其顶层目录中查找“src.zip”。如果您告诉他们在哪里可以找到该文件，大多数 IDE 将向您显示核心 Java 类的源代码。

# iphone - 如何将“标签栏控制器”附加到工具栏的现有视图？

> ID：765476
> 
> 赞同：1
> 
> 时间：2009-04-19T14:15:26.957
> 
> 标签：iphone, uitabbarcontroller

我正在`Tab Bar Controller`使用工具栏将 a 附加到现有视图。

但是，我`controller offset`在底部得到标签栏，所以你可以看到项目的顶部。我正在使用以下内容将其附加`Tab Bar Controller`到视图：

```
(void)viewDidLoad
  {
  [self.view insertSubview:dashboardTabController.view atIndex:0];
  } 
```

我附上了一张图片。我希望有人能提供帮助，因为我已经尝试解决这个问题几个小时了，这让我发疯了。

[图片可在以下位置查看：](http://img246.imageshack.us/img246/5825/iphonesimulatorscreensn.jpg) [alt text http://img246.imageshack.us/img246/5825/iphonesimulatorscreensn.jpg](http://img246.imageshack.us/img246/5825/iphonesimulatorscreensn.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T15:32:45.663

add constraint to fix your tabbar at the bottom of the screen

# java - 任何与 JMX 一起工作的 WS-DM 的开源实现？

> ID：765478
> 
> 赞同：0
> 
> 时间：2009-04-19T14:19:05.840
> 
> 标签：java, performance, web-services, distributed, jmx

WS-DM 是一种等效于 JMX 的 Web 服务。我正在寻找一个开源实现......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T14:24:23.877

你可能想看看[Apache Muse](http://ws.apache.org/muse/)

# .net - 调试时如何从 C# 应用程序步入 C/C++ DLL

> ID：765481
> 
> 赞同：28
> 
> 时间：2009-04-19T14:21:23.370
> 
> 标签：.net, visual-studio, visual-c++, visual-studio-debugging, step-into

我的解决方案中有两个项目：C/C++ Win32 DLL 和一些 C# 应用程序。

我必须做什么才能在调试时进入 DLL？

我打开了 C++ 项目设置中的所有调试选项，并将下一个文件复制到 C# 应用程序根目录：MyLib.dll、MyLib.pdb、vc90.pdb、vc90.idb，但它没有帮助。

我还需要执行哪些其他操作？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-19T14:35:54.910

您是否在 C# 项目中打开了启用非托管代码调试？

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-27T03:31:57.810

如果您通过**Debug > Attach To Process 附加**调试器，在单击“附加到进程”对话框中的“附加”之前，请确保选择可以附加调试器**的适当代码类型。**

[![在此处输入图像描述](https://i.stack.imgur.com/NtHM3.png)](https://i.stack.imgur.com/NtHM3.png)

# lisp - 如何编写一个接受两个列表并返回四个列表的方案函数

> ID：765484
> 
> 赞同：3
> 
> 时间：2009-04-19T14:22:59.450
> 
> 标签：lisp, scheme, racket

我有 2 个元素列表 '(abc) '(dbf) 并希望在一个结果中找到差异、联合和交集。那可能吗？如何？

我写了一个成员函数来检查第二个列表中是否有第一个列表的汽车，但是我不能将成员扔到新列表中。

```
(define (checkResult lis1 lis2)
  (cond...........

))
(checkresult '( a b c) '(d b f)) 
```

我的结果应该是`(( a c) (d f) (a b c d f) (b))`。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-19T15:19:33.837

正如其他人所说，您需要做的就是创建单独的函数来计算两个集合的交集、并集和减法，并从 checkresult 中调用它们：

```
(define (checkresult a b)
  (list (subtract a b)
        (subtract b a)
        (union a b)
        (intersect a b))) 
```

以下是一些示例并集、交集和减法函数：

```
(define (element? x lst)
  (cond ((null? lst) #f)
        ((eq? x (car lst)) #t)
        (#t (element? x (cdr lst)))))

(define (union a b)
  (cond ((null? b) a)
        ((element? (car b) a)
         (union a (cdr b)))
        (#t (union (cons (car b) a) (cdr b)))))

(define (intersect a b)
  (if (null? a) '()
      (let ((included (element? (car a) b)))
        (if (null? (cdr a))
            (if included a '())
            (if included
                (cons (car a) (intersect (cdr a) b))
                (intersect (cdr a) b))))))

(define (subtract a b)
  (cond ((null? a) '())
        ((element? (car a) b)
         (subtract (cdr a) b))
        (#t (cons (car a) (subtract (cdr a) b))))) 
```

注意：由于这些是集合并且顺序无关紧要，因此结果没有排序。此外，这些函数假定输入是集合，因此除了联合所需的内容之外，不会进行任何重复检查。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T14:32:47.943

当然有可能。假设您具有计算差异、联合交集等功能：

```
 (define (checkResult lis1 list2)
   (list (difference lis1 lis2)
        (union ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T14:32:16.323

当然有可能。这里有几个提示：

1.  组合列表和空列表的结果是什么？
2.  您不必一次完成所有操作。一次取一块。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T14:41:03.367

在查理马丁和汤姆詹的回答之上，我想出了这个来源：

[联合交点和差异](http://joung.im.ntu.edu.tw/teaching/pl/2005/solutions/hw2/B91705034-2.scm "联合交叉和差异")

可以通过很好的解释找到不同功能的实现。

# c# - 如何获得最后一个错误（WSAGetLastError）？

> ID：765491
> 
> 赞同：9
> 
> 时间：2009-04-19T14:28:08.797
> 
> 标签：c#, .net, winapi, error-handling, pinvoke

如何`WSAGetLastError()`从 WinAPI 调用，以便得到有效的文本错误？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-19T14:49:07.453

```
[DllImport("ws2_32.dll", CharSet = CharSet.Auto, SetLastError = true)]
static extern Int32 WSAGetLastError(); 
```

此外，在[pinvoke.net](http://www.pinvoke.net/default.aspx/kernel32/GetLastError.html)上说：

> 您永远不应该 PInvoke 到 GetLastError。改为调用 Marshal.GetLastWin32Error ！

[System.Runtime.InteropServices.Marshal.GetLastWin32Error()](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getlastwin32error.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-19T14:34:52.447

`WSAGetLastError`只是 Win32`GetLastError`函数的包装器。

如果您正在使用 P/Invoke 执行操作，则可以将`SetLastError`参数用于`DllImport`属性。它告诉 .NET 导入的函数将调用`SetLastError()`，并且应该收集该值。

如果导入的函数失败，您可以使用`Marshal.GetLastWin32Error()`. 或者，您可以只`throw new Win32Exception()`使用 ，它会自动使用此值。

如果您不使用 P/Invoke 执行操作，那么您就不走运了：无法保证最后一个错误值将保留足够长的时间以使其通过多层 .NET 代码返回。事实上，我将链接到 Adam Nathan：[永远不要为 GetLastError 定义 PInvoke 签名](http://blogs.msdn.com/adam_nathan/archive/2003/04/25/56643.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T14:34:38.033

从托管代码调用该函数没有多大意义。这在非托管代码中是有意义的，因为您知道调用的确切最后一个 Win32 函数，因此您知道必须设置最后一个错误的函数。在托管代码中，您不知道调用了哪些函数。

您可能可以使用 P/Invoke 来调用该函数；这对你没有任何好处。你想达到什么目的？

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-07-16T22:15:37.500

这就是我在网上看到的将GetLastError放入C#异常机制以及如何将其重新取出...

```
try
{
    // some p/invoke call that is going to fail with a windows error ...
    mHndActivatedDevice = MyNameSpace.Interop.Device.Device.ActivateDevice(
         "Drivers\\BuiltIn\\SomeDriverName", IntPtr.Zero, 0, IntPtr.Zero);
}
catch(System.ComponentModel.Win32Exception exc) // as suggested by John Saunders
{
    // you can get the last error like this:
    int lastError = System.Runtime.InteropServices.Marshal.GetLastWin32Error();
    Console.WriteLine("error:" + lastError.ToString());

    // but it is also inside the exception, you can get it like this
    Console.WriteLine(exc.NativeErrorCode.ToString());

    Console.WriteLine(exc.ToString());
} 
```

其中 ActivateDevice 是这样定义的：

# unix - 进程调度问题

> ID：765499
> 
> 赞同：1
> 
> 时间：2009-04-19T14:34:40.327
> 
> 标签：unix, kernel, internals, interrupt-handling

> 例如，等待磁盘 I/O 完成的进程将在与正在传输的数据对应的缓冲区头的地址上休眠。当磁盘驱动程序的中断例程注意到传输完成时，它会在缓冲区头上调用唤醒。**中断使用内核堆栈来处理当时正在运行的任何进程，并且从该系统进程中完成唤醒。**

您能否解释一下我强调的段落中的最后一行。它是关于唤醒一直在等待某些事件发生并因此已经休眠的进程。这一段来自高尔文。顺便问一下，你能推荐一些学习unix操作系统的好书或链接吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T14:43:17.403

在收到中断时有*一些*进程正在运行。内核不会切换到其他进程上下文来处理它——这需要时间——它只是在当前上下文中执行必要的操作，并让调度程序知道下次调度时，等待进程已准备好继续。

周围有很多不错的内部书籍。我喜欢 McKusick*等人*的各种书籍，例如[FreeBSD 操作系统的设计和实现](https://rads.stackoverflow.com/amzn/click/com/0201702452)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T15:09:08.510

Maurice Bach 的[Unix 操作系统设计](https://rads.stackoverflow.com/amzn/click/com/0132017997)是这方面最著名和最全面的书。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T14:45:04.967

I/O 完成中断将在磁盘发出传输结束信号后立即执行。无论内核当前在做什么，都会这样做。中断处理程序通常非常小且独立。因此，重用当前运行时环境（堆栈、CPU 状态等）比将完整的上下文切换到单独的线程更快。不利的一面是，这意味着中断处理程序只允许做非常有限的事情，比如在其他地方设置一个标志，或者将一个工作项加入队列。此外，他们必须非常小心地清理自己，以免干扰运行过程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T15:43:39.457

应该阅读Eric Raymond 的[“Unix 编程艺术”](http://catb.org/esr/writings/taoup/html/)以了解 Unix 哲学和文化。真正了解和欣赏其设计背后的原因。

# sql-server - SQL 2005 SMO - 查找引用表

> ID：765510
> 
> 赞同：6
> 
> 时间：2009-04-19T14:44:32.797
> 
> 标签：sql-server, smo

我需要将一些主键从非集群更改为集群，但我不能删除约束，因为它是从其他外键引用的。

如何在不遍历数据库中的所有表的情况下找到引用父表中的主键作为外部关系的一部分的表？我需要禁用这些约束，更改 PK 并重新启用。

更新：

1.  我不想使用纯 SQL 来执行此操作，而仅使用 SMO。

2.  马克，我知道 ForeignKeys 我需要类似的东西： table.PrimaryKey.ForeignKeys （即哪些表正在引用我的表的主键） 我只是想避免遍历数据库中的所有表并检查每个表的 ForeignKeys 属性其中一个看看是否有任何人引用我的表。（不可扩展）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-19T18:28:17.923

好的，我想我找到了。

```
table.Columns[0].EnumForeignKeys() 
```

或直接

table.EnumForeignKeys()

我期待一个属性而不是一个函数。我很确定它会在幕后执行 cmsjr 的建议。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-19T15:44:43.247

使用 SMO，您可以这样做：

```
using Microsoft.SqlServer.Management.Smo;

Server localServer = new Server("your server name");
Database dasecoDB = localServer.Databases["your database name"];

Table table = dasecoDB.Tables["your table name"];
foreach(ForeignKey fk in table.ForeignKeys)
{
  Console.WriteLine("Foreign key {0} references table {1} and key {2}", fk.Name, fk.ReferencedTable, fk.ReferencedKey);
} 
```

马克

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-19T15:48:56.637

此查询应该可以工作，并且可以使用 Database.ExecuteWithResults 执行

```
Select fk.Table_Name from 
INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS C 
    INNER JOIN 
    INFORMATION_SCHEMA.TABLE_CONSTRAINTS FK 
      ON C.CONSTRAINT_NAME = FK.CONSTRAINT_NAME 
    INNER JOIN 
    INFORMATION_SCHEMA.TABLE_CONSTRAINTS PK 
        ON C.UNIQUE_CONSTRAINT_NAME = PK.CONSTRAINT_NAME 
where PK.Table_Name = 'SomeTable' 
```

例如

```
SqlConnection sqlConnection =
new SqlConnection(@"Integrated Security=SSPI; Data Source=SomeInstance");
Server server = new Server(serverConnection);
Database db = server.Databases["somedatabase"];
DataSet ds = db.ExecuteWithResults(thesqlabove); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-19T15:43:35.433

您可以使用`INFORMATION_SCHEMA`视图。

`INFORMATION_SCHEMA.TABLE_CONSTRAINTS`将为您提供该表上主键的名称。

`SELECT CONSTRAINT_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE TABLE_NAME = @TableName`

给定主键名称，您可以获得使用这些键的引用约束`INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS`

然后通过查询表名`INFORMATION_SCHEMA.CONSTRAINT_TABLE_USAGE`

不是 SMO 本身，但鉴于上述情况，您应该能够组合一个查询，列出您需要禁用的约束。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-15T16:35:15.207

它对我不起作用。

考虑以下关系：

Table1 --> 主表；Table2 --> 从表；

Table2.Table1_ID 是 Table1.ID 的外键

Table1.EnumForeignKeys() 返回 null。

相反，我成功地尝试了 DependencyWalker 对象。以下代码列出了来自给定表集合的所有表。

```
 DependencyWalker w = new DependencyWalker(db.Parent);
            DependencyTree tree = w.DiscoverDependencies(urns,false);
            DependencyCollection depends = w.WalkDependencies(tree);

            foreach (DependencyCollectionNode dcn in depends)
            {
                if (dcn.Urn.Type == "Table")
                {
                    dcn.Urn.GetNameForType("Table");
                    Console.WriteLine(dcn.Urn.GetNameForType("Table"));
                }
            } 
```

其中“urns”是 table.Urn 的集合。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-20T12:41:17.770

您将不得不遍历依赖关系树。以下是使用 SMO 生成创建表和插入脚本的脚本。

**

```
**ServerConnection conn = new ServerConnection( GetConnection() );
            Server server = new Server( conn );
            Database db = server.Databases[ mDestinationDatabase ];
            // Create database script 
            StringBuilder dbScript = new StringBuilder();
            ScriptingOptions dbCreateOptions = new ScriptingOptions();
            dbCreateOptions.DriAll = true;
            dbCreateOptions.NoCollation = true;
            StringCollection coll = db.Script( dbCreateOptions );
            foreach( string str in coll )
            {
                dbScript.Append( str );
                dbScript.Append( Environment.NewLine );
            }
            sqlInsertCommands = dbScript.ToString();
            // Create dependency tree
            DependencyWalker w = new DependencyWalker(db.Parent);
            UrnCollection urnCollection = new UrnCollection();
            DataTable table = db.EnumObjects( DatabaseObjectTypes.Table );
            string tableName = string.Empty;
            foreach( DataRow row in table.Rows ) 
            {
                urnCollection.Add( new Urn( ( string )row[ "Urn" ] ) ); 
            }
            DependencyTree tree = w.DiscoverDependencies( urnCollection, true );
            DependencyCollection depends = w.WalkDependencies(tree); 
            // walk through the dependency tree and for each table generate create and insert scripts
            foreach (DependencyCollectionNode dcn in depends)
            {
                if (dcn.Urn.Type == "Table")
                {
                    tableName = dcn.Urn.GetNameForType( "Table" );
                     DataTable dataTableWithData = GetTableWithData( tableName);
                     ArrayList columnList = new ArrayList();
                    foreach(DataColumn  dataColumn in  dataTableWithData.Columns)
                    {
                        columnList.Add( dataColumn.ColumnName );
                    }
                    sqlInsertCommands = sqlInsertCommands + Environment.NewLine + Environment.NewLine
                        + GetCreateTableScript(tableName ) 
                        + Environment.NewLine + Environment.NewLine
                        + BuildInsertSQL( columnList, dataTableWithData, tableName );
                    }
            }** 
```

**

# c# - 如何在屏幕上移动对象

> ID：765518
> 
> 赞同：0
> 
> 时间：2009-04-19T14:49:58.743
> 
> 标签：c#, winforms

如何在 WinForm 中移动屏幕上的任何对象？

当我按右时 - >对象将向右移动，直到我按任何其他箭头键

当我按左 <- 对象将向左移动，直到我按任何其他箭头键

物体一直在运动（就像在蛇游戏中一样）

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T15:07:02.120

您可能希望从[Form](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.aspx)继承并覆盖[OnPaint](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.onpaint.aspx)方法。您可能还需要每次[Invalidate()强制重绘。](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.invalidate.aspx)这将设置一个简单的游戏循环，并允许您快速更新屏幕。

在您的 OnPaint 方法中，您将根据自上次调用 OnPaint 方法以来经过的时间以及最后按下哪个键来更新对象的位置。您可能会使用以下速度来执行此操作：

```
newPosition = oldPosition + (elapsedTime * velocity) 
```

速度值将根据您按下的键而改变（即左为负，右为正）。您还需要一个变量和一些代码来跟踪它是水平移动还是垂直移动。

这是实现此目的的一种非常低性能的方法（即，它是一种 hack）。如果您想坚持使用 Windows 但无需太多工作即可获得更好的性能，您可能会考虑[XNA](http://msdn.microsoft.com/en-us/xna/default.aspx)。如果您想要更好的性能并愿意做更多的工作，请查看 Interop with DirectX 和 Win32 API 或一起切换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T15:06:17.253

您需要一个游戏循环来继续您最初通过单击按钮启动的移动方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T15:08:20.963

捕获键，调整对象坐标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T15:09:11.833

假设您在 2D 中执行此操作，您可以设置一个 x 和 y 更改因子，您可以在每次按下箭头键时正确设置该因子。然后设置一个计时器以您想要的速率更新位置。当计时器滴答作响时，通过 x/y 变化因子调整对象的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-14T06:22:09.447

```
 enum position
    {
        Left,Right,up,down
    }
    private int _x;
    private int _y;
    private position _objposition;
    public Form1()
    {
        InitializeComponent();
        _x = 50;
        _y = 50;
        _objposition = position.down;
    }

    private void Form1_Paint(object sender, PaintEventArgs e)
    {
        e.Graphics.FillRectangle(Brushes.DarkSlateBlue,_x,_y,100,100);
    }

    private void timertick_Tick(object sender, EventArgs e)
    {
        if (_objposition == position.Right)
        {
            _x += 10;
        }
        else if (_objposition == position.Left)
        {
            _x -= 10;
        }
        else if (_objposition == position.up)
        {
            _y -= 10;
        }
        else if (_objposition == position.down)
        {
            _y += 10;
        }
        Invalidate();
    }

    private void Form1_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.KeyCode == Keys.Left)
        {
            _objposition =position.Left;
        }
        else if (e.KeyCode == Keys.Right)
        {
            _objposition = position.Right;
        }
        else if (e.KeyCode == Keys.Up)
        {
            _objposition = position.up;
        }
        else if (e.KeyCode == Keys.Down)
        {
            _objposition = position.down;
        }
    }
} 
```

这将创建一个 50X50 大小的矩形。默认情况下，我会将该框的位置设置为向下。但是当您按任意键时，例如：- 如果您按左键箭头，则键事件将触发，它将向左设置框的位置，框将开始移动向左直到按下另一个键

# iphone - 一个 XIB 中的多个视图 - iPhone SDK

> ID：765521
> 
> 赞同：17
> 
> 时间：2009-04-19T14:51:06.683
> 
> 标签：iphone, xib

我一直在花时间学习如何使用 iPhone SDK。我从头到尾阅读了“[开始 iPhone 开发：探索 iPhone SDK](http://books.google.com/books?id=WV9glgdrrrUC&printsec=frontcover&dq=Beginning+iPhone+development) ”，但我从未见过一个 XIB 中多个视图的示例。

为了说明我的意思，这是一个 XIB 的屏幕截图，其中包含我所指的简单配置：

[替代文字 http://theopensourceu.com/wp-content/uploads/2009/04/one-xib-multiple-views.png](http://theopensourceu.com/wp-content/uploads/2009/04/one-xib-multiple-views.png)

我认为必须有一个我从未见过的非常具体的原因。在 Apple 的示例和我迄今为止的所有阅读材料中，多个 XIB 仅用于一个“视图”（有时是导航控制器或选项卡栏控制器等）。这是什么原因？我应该避免在 XIB 中使用多个视图吗？这两种方法的优点或缺点是什么？

先感谢您

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-19T15:08:05.330

这是内存优化和加载时间的问题。如果您将所有视图放在一个 XIB 中，那么当您的应用程序启动时，它必须将整个 XIB 加载到内存中并为所有控件构建所有对象，这需要大量时间。

相反，如果您将视图分成单独的 XIB，那么您的应用程序将启动得更快，因为只有包含初始视图的 XIB 会被加载，而且一开始它也会使用更少的内存。然后，当视图更改时，您可以延迟加载包含新视图的 XIB。第一次打开视图时，这将导致一个小问题。如果你*真的*想优化内存使用，你也可以在切换视图时卸载前一个视图，但我不建议这样做，因为每次切换视图时都会出现问题，而不仅仅是第一次切换到任何给定的视图。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-31T16:34:28.353

跟进上一个答案，有时您希望同时加载多个视图。这是一个示例：您正在显示一个包含多个页面的报表，并且您将使用 UIScrollView 来管理它们。当用户浏览完报告后，他将关闭报告，这将关闭视图。

在 XIB 中创建一个 UIScrollView 以及为您需要的每个页面创建一个 UIView。由于 UIView 是 XIB 的一部分，因此当打开报表时，它们将一起加载到内存中。创建两个 UIViewController 并使用它们来显示正在查看的页面和正在滚动到的页面。当用户在页面中移动时，重新使用正在滚动离开的页面上的 UIViewController 来保持正在滚动到的页面。

这将确保用户在翻阅页面时获得出色的性能。它将所有页面一次加载到内存中。我只使用了两个 UIViewController，它只是改变了其中的哪些视图并移动它们。

这还具有将所有页面都放在一个 XIB 中的巨大好处。它比单独的 XIB 更容易编辑，加载速度更快。您只需要确保您有足够的内存一次加载所有页面。如果它是静态内容（例如在我的情况下），这是一个很好的方法。

如果您正在寻找一个很好的例子来说明如何做到这一点，我发现这个资源是一个很好的起点：

[http://cocoawithlove.com/2009/01/multiple-virtual-pages-in-uiscrollview.html](http://cocoawithlove.com/2009/01/multiple-virtual-pages-in-uiscrollview.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-25T18:43:50.417

这是对任何试图在单个 XIB（iOS 4 和 Xcode 4）中使用两个视图实现横向和纵向的人的警告。在一个 XIB 中拥有两个视图的主要缺点（对我而言）是您只能将 XIB 中的单个 UIOutlet 对象连接到视图控制器中的单个 UIOutlet 对象。

因此，例如，如果您有一个具有横向视图和纵向视图的 XIB，并且两个视图在不同位置包含相同的界面对象（例如横向的 UILabel 和纵向的 UILabel）。不能同时将纵向视图**中的 UILabel 和横向视图中的 UILabel 对象链接到视图控制器***中*的单个 UILabel 对象。

我觉得这很令人失望，因为 iOS UIViewController 文档 (iOS 4.3) 建议我可以通过在屏幕旋转时以编程方式在两个视图之间切换来实现自定义横向和纵向视图。

在花了相当长的时间弄清楚如何做到这一点之后，我发现可以将两个不同的视图附加到一个视图控制器上，但是你需要为这两个视图都有出口。例如，在我的视图控制器中，我有两个 UILabel 对象（一个连接到纵向视图中的 UILabel；一个连接到横向视图中的 UILabel）。在我的代码中，每次更新横向出口时，我也会更新纵向横向。

不是很优雅，但它可以工作，因为这是一个带有一个屏幕的简单视图，所以在控制器和视图中复制所有 UI 对象不会占用太多内存。我不会再创建一个这样做的项目，但对于该项目来说，这是一个足够好的解决方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-16T08:21:29.837

我在一个 xib 中放置多个视图的一个原因是因为与故事板 xib 不同的是，它不允许在表格视图本身中放置页眉和页脚。所以我为页眉和页脚视图创建了单独的视图，并将它们分配在`viewDidLoad`.

# mysql - MySQL：选择按字符数排序的行

> ID：765523
> 
> 赞同：9
> 
> 时间：2009-04-19T14:52:40.533
> 
> 标签：mysql, select, sql-order-by

在 MySQL 中，如何按字符数排序查询？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-19T14:54:28.453

尝试使用该[`LENGTH`](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_length)功能：

```
SELECT * FROM table ORDER BY LENGTH(myField); 
```

根据您正在做的事情，您可能希望[`CHAR_LENGTH`](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_char-length)改用：

> 多字节字符计为单个字符。这意味着对于包含五个两字节字符的字符串，LENGTH() 返回 10，而 CHAR_LENGTH() 返回 5。

如果你不知道这意味着什么，你可能想要`LENGTH`.

# css - 浮动元素的边距折叠

> ID：765526
> 
> 赞同：1
> 
> 时间：2009-04-19T14:53:37.050
> 
> 标签：css

根据 CSS 2.1 标准，浮动元素的垂直边距不应与任何相邻元素一起折叠。

见： [http ://www.w3.org/TR/CSS21/box.html#collapsing-margins](http://www.w3.org/TR/CSS21/box.html#collapsing-margins)

但实际上这并不是在除 IE6 之外的所有浏览器（FF、Safari、Opera 和 Chrome）中都会发生的情况（虽然没有尝试使用 IE7 或 IE8）。这是代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1" />
</head>
<body>
<div style="margin-bottom:10px;">HEADER</div>
<div style="float:left;width:100%;margin:10px 0px;">Floating div</div>
<div style="margin-top:10px;">FOOTER</div>
</body>
</html> 
```

添加明确：两者；到页脚 div 没有任何区别。

我不是 CSS 专家，所以如果我的理解有误，请纠正我

编辑：
显然我的问题引起了一些混乱。上面的代码只是为了演示我所指的行为，这不是我试图找到解决方案的真正问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-19T15:10:59.007

在 IE6 和标准浏览器中，浮动的边距都不会与其兄弟姐妹一起折叠。根据引用的标准，这是正确的。

渲染的差异是由 IE6 对哪些边距一起流动的解释造成的。（如果你给每个 div 一个背景颜色，就更容易看到这里发生了什么。）

> 正常流折叠中块框的两个或多个相邻垂直边距

使用这样定义的[正常流程](http://www.w3.org/TR/CSS21/visuren.html#floats)：

> 由于浮动不在流中，因此在浮动框之前和之后创建的非定位块框垂直流动，就好像浮动不存在一样。

也就是说，它们一起流动并具有可能崩溃的相邻垂直边距。IE6（和 Quirks 模式下的 IE7）弄错了，认为浮动会破坏流，导致不会发生崩溃。

由于围绕垂直边距和折叠的普遍混乱，再加上仍然存在的浏览器错误，我建议避免垂直边距并尽可能使用填充。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T15:09:39.853

我通过添加以下内容来解决（IE7，FF）：

`<div style="clear:both;"></div>`

在浮动 div 和页脚之间。

[编辑：]当你浮动一个元素，并在它之后放置一个你想要在下一个空间的开头开始的元素时，你应该/必须使用一个清除元素。Zack 也是对的：如果你只是堆叠 div，你不应该/不应该浮动任何东西。

# java - Java Servlet 中的产品浏览

> ID：765532
> 
> 赞同：0
> 
> 时间：2009-04-19T15:02:36.623
> 
> 标签：java, web-applications, servlets

我正在使用 EJB 和 servlet 创建一个 Web 应用程序。我有一个页面显示数据库中所有项目的列表。我想为用户提供一个选项来单击这些项目之一，这将打开 SHOW servlet，它将有关项目的信息收集到页面上。我不想为每个项目创建一个页面。相反，我想创建一个可用于所有项目的 ONE SHOW servlet。我不确定如何通过单击项目名称来提供此选项，以及如何发送参数......因为这取决于用户选择的项目。

有人能帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T15:14:55.317

当您生成产品列表时，您只需在链接中制作所有数据库项目参数的 ID。

```
<a href="/ShowProduct?productID=Q85349">Product Foo</a> 
```

然后在 ShowProduct servlet 的 doGet() 方法中，您可以调用 HttpServletRequest.getParameterValues() 方法来获取该参数的值并在数据库中进行查找。

例如

```
public void doGet(HttpServletRequest request, HttpServletResponse response)
    throws ServletException, IOException
{
    String[] params = request.getParameterValues("productID");
    String productID = params[0];
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T15:08:33.897

将项目的唯一 ID 传递到 SHOW servlet。然后从数据库中获取该项目的数据并使用该数据创建新页面。

尝试让 show 链接指向您的 show servlet，如下所示：“/ShowServlet?itemID="+itemID

# jquery - 对 firebug 和 jQuery 的一点帮助！

> ID：765536
> 
> 赞同：-1
> 
> 时间：2009-04-19T15:05:22.297
> 
> 标签：jquery, firefox, firebug

我有一个 div 元素，当我在 IE 上单击它时，它会显示一个线索提示。但是，当我在 Firefox（或 Chrome）中单击时，这个提示根本不显示。

我安装了萤火虫，但我没有很好的使用经验。

有了萤火虫，我能知道为什么这个提示没有显示吗？我怎样才能做到这一点？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T15:08:23.600

单击浏览器窗口右下角的 Firebug 图标。一个窗口窗格应该出现在屏幕底部，如下所示：

```
Console panel is disabled

Use this page to enable or disable following panels. Enabling these panels will reduce performance and will cause a page reload.
    Console     Support for Console logging.          Disabled Always
    Script      Support for JavaScript debugging.     Disabled Always
    Net         Support for Network monitoring.       Disabled Always 
```

选中所有 3 个框，然后单击“申请[http://www.example.org](http://www.example.org) ”

检查单击 DIV 时出现的任何错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T11:06:08.400

假设您的代码看起来像`<div alt="text">`. 当无法显示某些内容时，将使用 alt 属性。“对于无法显示图像、表单或小程序的用户代理，此属性指定替代文本。” [W3C HTML 4.01](http://www.w3.org/TR/html401/struct/objects.html#h-13.8)

使用 title 属性在 IE/Firefox/Chrome 上获得您想要的结果`<div title="text">`。“标题属性的值可以由用户代理以多种方式呈现。例如，可视浏览器经常将标题显示为“工具提示”......” [WC3 HTML 4.01](http://www.w3.org/TR/html401/struct/global.html#h-7.4.3)

有关更多信息，请阅读[http://www.456bereastreet.com/archive/200412/the_alt_and_title_attributes/](http://www.456bereastreet.com/archive/200412/the_alt_and_title_attributes/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T15:06:19.533

单击Firefox中的div后检查javascript错误控制台。

> 工具 > 错误控制台

这应该为您提供导致错误的代码行和错误描述。

# google-app-engine - Google App Engine 上的电子商务

> ID：765555
> 
> 赞同：15
> 
> 时间：2009-04-19T15:13:10.640
> 
> 标签：google-app-engine, e-commerce

我正在寻找可以安装在 Google App Engine 上的电子商务平台。

有什么建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T15:39:31.683

[EngineCarts](http://www.enginecarts.com/static/engine_cart.html)就是这样一种选择，但要花钱 AFAICT。

您可能可以相当轻松地移植现有的 python django 应用程序，例如[Satchmo 。](http://www.satchmoproject.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-27T04:37:02.220

Freeblisket 与 Google 的 App Engine 一起工作，它是 Java 语言。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-20T08:13:27.797

如果您查看 Google App Engine 报告的[问题或功能请求](http://code.google.com/p/googleappengine/issues/list)。在那里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-30T17:29:51.333

我不认为 Satchmo 可以部署到 Google App。英。由于许多依赖库，“容易”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T16:42:21.600

Satchmo，听起来不错，Google App Engine 上的电子商务。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-21T08:42:28.063

Viur has also a Shop modul including:

*   shoppingcart
*   workflow for paing
*   adminworkflow for sending pakackes labeling payed status
*   payingmethods like: paypal, google wallet, sofortüberweisung...

You also may structure your Productdatabase in:

*   Folders
*   Trees
*   Lists and categories

it's open Source and you can download it at:

[http://www.viur.is](http://www.viur.is)

# web-crawler - 网络爬取和链接评估

> ID：765558
> 
> 赞同：0
> 
> 时间：2009-04-19T15:20:03.273
> 
> 标签：web-crawler

我知道 cURL 会下载一个完整的文件。

我真正想要的是获取页面上的所有链接，并根据我的特定标准、链接位置等进行评估，然后决定是否应该抓取该页面并解析它以获取信息。

更具体地说，我想找到与娱乐活动相关的链接并解析数据并将其存储在我的 MySQL 数据库中，以填充我所在地区的活动网站。

有人对如何完成有想法吗？

-杰森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T15:23:16.637

我建议您将您的工作基于现有的网络爬虫/索引器解决方案，而不是自己在代码中或使用 CURL 等工具实现它。

例如，参见[Lucene](http://lucene.apache.org/java/docs/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-18T21:28:53.480

其他答案中的那些解决方案听起来很有趣，但我只是用[C#/Mono](http://mono-project.com/Main_Page)和[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)做了一些类似而简单的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T18:29:26.470

您没有指定编程语言。[Apache Droids](http://incubator.apache.org/droids/)可能适合您，如果您愿意使用 Java 对其进行自定义。它被计划为一个最小的爬虫，您可以根据您的特定需求进行自定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T16:32:57.717

如果你想要的只是一个页面上的链接枚举，你可以使用 .NET WebBrowser 和 DOM 来做到这一点。为此挖掘我的代码......我会回复你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T18:29:27.703

如上所述，您没有提到语言。如果您使用 Ruby，则可以使用蜘蛛网 gem。您将手动告诉它不要找到任何链接（默认情况下它会自动抓取所有链接）并在每个页面上自己执行此操作，因为您说您需要评估它们，然后如果您希望它们可以手动放入队列中被抓取。

如果这就是你所使用的，那么 Godaddy 共享主机似乎支持 Ruby on Rails。

（刚刚看到这是 3 年前的，不过可能对其他人有帮助！）

# java - SWT：收到系统设备更改通知（USB 设备连接/断开）

> ID：765564
> 
> 赞同：5
> 
> 时间：2009-04-19T15:26:02.027
> 
> 标签：java, event-handling, usb, swt

我正在编写一个 SWT 应用程序，它需要放在系统托盘中，并在用户连接某些 USB 设备时自动弹出（该应用程序用作其控制面板）。

在本机环境（本例中为 win32，但我最终应该独立于平台）中执行此操作的方法是监听 WM_DEVICECHANGE 事件，然后检查我的设备是否已断开连接。

谷歌搜索这个主题，看起来 SWT 实际上并没有处理这种类型的事件。有谁知道如何实现这一目标？我的后备解决方案是每 n 秒对 USB 端口进行采样，寻找设备，但就我而言，这是一个不可行的解决方案......

谢谢和欢呼

晒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T13:57:33.540

**编辑：J-16 SDiZ 报告说该 API 也适用于 Windows**

[这是一篇关于从 Java 应用程序访问 USB 设备](http://www.ibm.com/developerworks/library/j-usb.html)的非常好的文章

所描述的 jUSB 模块包含一个[USBListener](http://jusb.sourceforge.net/apidoc/usb/core/USBListener.html)对象。

> 由要监视 USB 结构的对象实现的接口。报告这些变化的顺序不一定是在现实世界中看到这些变化的顺序，也会出现延迟。

你的 SWt 对象可以实现这个监听器并做一些事情，当方法

```
deviceAdded(Device dev) 
```

被解雇

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T13:49:15.183

Java 不提供与设备和 USB 的直接交互。有几个 Java 第三方库提供 USB 相关功能（从 USB 端口读/写）。例如： http: [//www.icaste.com/](http://www.icaste.com/)（商业）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T08:18:48.880

[在http://www.steelbrothers.ch/jusb/](http://www.steelbrothers.ch/jusb/)有一个用于 windows 的 jUSB 端口

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T20:08:47.080

您对*Zorglub*的评论表明您有一些（大概）JNI/JNA 代码来调用您提到的第 3 方 DLL。我假设您还可以将 JNI 包装器写入 Windows API，您可以在其中注册以接收您提到的 _WM_DEVICECHANGE_ 事件的通知。

# http - 在哪里可以找到 HTTP 方法示例？

> ID：765565
> 
> 赞同：24
> 
> 时间：2009-04-19T15:26:05.773
> 
> 标签：http, httpwebrequest

[HTTP 定义了八种方法（有时称为“动词”）](http://en.wikipedia.org/wiki/HTTP)

你能帮我找到每个例子，以便我更好地测试和理解它们吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-04-19T15:51:36.973

首先，您应该查看[HTTP 1.1 规范](http://www.w3.org/Protocols/rfc2616/rfc2616.html)，尤其是部分[方法定义](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9)。

*   **OPTIONS** 获取有关服务器如何允许与之通信的信息。

    要求：

    ```
    OPTIONS * HTTP/1.1
    Host: example.com 
    ```

    回复：

    ```
    HTTP/1.1 200 OK
    Date: …
    Allow: OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE
    Content-Length: 0 
    ```

*   **GET** 检索资源。

    要求：

    ```
    GET /foo/bar HTTP/1.1
    Host: example.com 
    ```

    回复：

    ```
    HTTP/1.1 200 OK
    Date: …
    Content-Type: text/html;charset=utf-8
    Content-Length: 12345

    <!DOCTYPE … 
    ```

*   **HEAD** 与**GET**类似，但仅返回 HTTP 标头。

    要求：

    ```
    HEAD /foo/bar HTTP/1.1
    Host: example.com 
    ```

    回复：

    ```
    HTTP/1.1 200 OK
    Date: …
    Content-Type: text/html;charset=utf-8
    Content-Length: 12345 
    ```

*   **POST** 创建一个新资源。

    要求：

    ```
    POST /foo/bar HTTP/1.1
    Host: example.com
    Content-Type: application/x-www-form-urlencoded

    action=addentry&subject=Hello,%20World 
    ```

    回复：

    ```
    HTTP/1.1 201 Created
    Date: …
    Content-Length: 0
    Location: http://example.com/foo/bar 
    ```

*   **PUT** 向服务器发送数据。

*   **DELETE** 删除现有资源。

*   **TRACE** 返回客户端发送的请求头。

    要求：

    ```
    TRACE /foo/bar HTTP/1.1
    Host: example.com 
    ```

    回复：

    ```
    HTTP/1.1 200 OK
    Date: …
    Content-Length: 17

    Host: example.com 
    ```

我不知道这些例子是否正确。随时纠正它们。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-19T15:34:52.567

[您可以使用cURL](http://en.wikipedia.org/wiki/CURL)命令行工具试验不同的 HTTP 方法。例如：

```
curl --head http://www.google.co.uk

HTTP/1.1 200 OK
Cache-Control: private, max-age=0
Date: Sun, 19 Apr 2009 15:33:24 GMT
Expires: -1
Content-Type: text/html; charset=ISO-8859-1
Set-Cookie: PREF=ID=a2a414b9a84c8ffd:TM=1240155204:LM=1240155204:S=16kZnqzeSxIJT3jv; expires=Tue, 19-Apr-2011 15:33:24 GMT; path=/; domain=.google.co.uk
Server: gws
Transfer-Encoding: chunked 
```

*   -X 选项允许您指定除 GET 之外的 HTTP 方法。

# mysql - 高级 MySQL 我错过了重点吗？

> ID：765566
> 
> 赞同：3
> 
> 时间：2009-04-19T15:26:36.597
> 
> 标签：mysql

我不确定这个问题是否有意义。但我知道mysql的所有基本CRUD命令。可能在这里和那里更多（外键等）。但是关于mysql/dbms的书实在太多了。我可以编写体面的查询并获得我想要的所有结果。也许它们不是最有效的，但它很有效。那是因为我的应用程序还不是 facebook，所以我不得不担心优化。还是我？

我错过了这里的重点吗？我还应该知道什么？

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T15:47:54.143

过早的优化是万恶之源。专注于设计正确和逻辑的数据库结构并正确索引它们，这将使您走得更远。修改一个糟糕的查询总是比修改一个设计糟糕的数据库结构更容易。

在我看来，使用您拥有的查询并在需要优化时对其进行优化。查询的内容，而不是专注于使它们安全（请参阅sql注入）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-19T18:12:36.823

> 我还应该知道什么？

*   对关系理论有更多的理解，让你写出更好的SQL。我目前正在欣赏世界领先的关系模型专家 CJ Date 的新书“ [SQL 和关系理论”。](http://www.xaprb.com/blog/2009/03/29/a-review-of-sql-and-relational-theory-by-c-j-date/)

*   实施和监控[安全性](http://dev.mysql.com/doc/refman/5.1/en/security.html)——当然是 SQL 注入，但[OWASP](http://www.owasp.org/)、[SANS.org](http://www.sans.org/top25errors/)或诸如“[软件安全的 19 条致命罪](http://www.codinghorror.com/blog/archives/000841.html)”之类的书籍也涵盖了其他问题。这是一个不特定于 SQL 的广泛主题，但我认为每个软件开发人员都有责任学习这些内容。

*   性能测量和[监控](http://dev.mysql.com/doc/refman/5.1/en/mem-introduction.html)——你怎么知道你什么时候*需要*学习优化技术？

*   [I18N、L10N、字符集](http://dev.mysql.com/doc/refman/5.1/en/internationalization-localization.html)。

*   数据库维护和恢复——[备份、修复](http://dev.mysql.com/doc/refman/5.1/en/backup-and-recovery.html)。

*   [复制](http://dev.mysql.com/doc/refman/5.1/en/replication.html)、[集群](http://dev.mysql.com/doc/refman/5.1/en/mysql-cluster.html)和[代理](http://dev.mysql.com/doc/refman/5.1/en/mysql-proxy.html)。

*   部署和升级技术 - 如何在不中断服务的情况下将更改应用到正在运行的应用程序或站点。

*   编写可与多个 RDBMS 品牌一起使用的或多或少的可移植 SQL。如果您需要支持另一个品牌，至少要了解需要重写的内容。

*   如何以及何时使用对象关系映射框架。

*   如何以及何时使用[非关系数据库](https://stackoverflow.com/questions/282783/the-next-gen-databases/282813#282813)。SQL 是最好的通用数据管理范例，但还有其他技术更专业于特定任务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T16:14:31.240

数据库不仅仅是“放置东西的地方”。一旦您意识到这一点，您将开始充分发挥它们的潜力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T15:34:32.897

无论如何，您应该担心优化。当然，如果现在你只有 10 个人在使用你的应用程序，这不是问题，但在未来，如果用户群增长，重写数据库结构真的是一个“痛苦的事情”，特别是如果在你的代码中你正在使用没有数据库抽象的原始查询。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T15:35:29.947

高级 MySQL 可能不仅仅是为 CRUD 操作编写查询。有时您需要进行优化或各种维护过程，而这些过程确实需要对您正在使用的 DBMS 有深入的了解。如果您处理中小型应用程序，您可能不会担心查询的性能以及数据库设计的健壮性和效率，但是对于高度可扩展的应用程序，所有这些都是您必须考虑的因素。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-19T15:35:57.043

很好地了解 CRUD 语法。我建议您超越这些，了解关系设计、主键和候选键、索引等。这些主题对所有关系数据库都有意义，而不仅仅是 MySQL。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-19T16:24:38.813

哦，现在我明白了（问题）。我以为您的意思是“将'Advanced'和'MySQL'结合起来有什么意义？”。:-)

如果你的工作必须使用 MySQL，那么是的，你最好逐渐深入了解它，特别是它的缺点和陷阱是什么，以及工作中的其他人如何对无法真正解决的事情做出假设.

现在，我的“巨魔”：如果这只是你，请使用更强大的东西。我不是微软的粉丝，但它们确实使使用 SQL Server 的启动成本相当低，假设您在 Windows 上工作。更好的是，如果你在 *nix 服务器上工作，你可以试试 PostgreSQL。多年来，他们一直非常认真地正确实现诸如 ROLLBACK、事务隔离、外键引用完整性、视图、函数（又名存储过程）之类的古怪小东西。MySQL 多年来有所改进，但仍然（恕我直言）有些不成熟。早在 2000 年左右，我对它的印象是“xBASE 的可靠性和 SQL 接口的易用性”。（我不是 SQL 语言本身的忠实粉丝——也许我太老了，无法真正将其视为“唯一可能的方法”）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T00:37:42.263

I avoid MySQL like a bad flu bug, but I can add some insight here. One area that would be covered in the "advanced" portion of MySQL is customization.

There is alot involved with SQL in general that MySQL doesn't do out of the box, or can be customized. Our company uses full stored procedure implementation and geospatial queries as two examples.

Advanced would involved good customization skills, and experience adding and working with customizations or add-ins. Anything to make MySQL be more enterprise like.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-19T15:33:33.303

如果你有足够的知识去做需要做的事情，那么你现在知道的就足够**了**。然而， CJ Date 的[《数据库系统简介》](https://rads.stackoverflow.com/amzn/click/com/0201385902)是由该领域的先驱（以及其他类型的数据库系统）编写的对关系数据库的出色讨论。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-19T15:45:23.167

通常，人们不知道 mysql 和其他 RDBMS 系统的许多特性。这很好，因为您可以很好地处理一部分功能，但是要处理困难的问题或成为一名优秀的 DBA，需要学习大量的东西。当人们谈论数据库上的 Advanced X 时，这些就是所要表达的意思。

要回答您的问题，最好了解一下还有哪些其他功能和工具。你可能会找到更好的方法来解决自己的问题，并培养一套更好的技能来解决别人的问题。我也完全同意其他答案，建议您提高对更高级别主题的了解，知道如何进行良好的数据库设计非常重要。

# c# - 在加载时计算 T-SQL 查询参数

> ID：765570
> 
> 赞同：0
> 
> 时间：2009-04-19T15:32:07.113
> 
> 标签：c#, asp.net, sql, parameters

我正在尝试从具有当前月份的 EventDate 的事件数据库（将 EventDate 字段作为日期）中选择记录。

我有计算每月第一天的功能：

```
public string GetFirstofMonth(DateTime dt)
{
 int thisMonth = dt.Month;
 int thisYear = dt.Year;
 string firstOfMonth = thisMonth.ToString() + "/1/" + thisYear.ToString();
 return firstOfMonth;
} 
```

和本月的最后一天：

```
public string GetLastofMonth(DateTime dt)
{
  DateTime Date2Obj = new DateTime(dt.Year, dt.Month, 1);
  int thisMonth = dt.Month;
  int thisYear = dt.Year;
  Date2Obj.AddMonths(1);
  Date2Obj.AddDays(-1);
  int lastDay = Date2Obj.Day;
  string LastOfMonth = thisMonth + "/" + lastDay + "/" + thisYear;
  return LastOfMonth;
} 
```

所以在MasterPage（或实例，没关系）我有这个SQLDataSource：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
 ConnectionString="<%$ ConnectionStrings:MeetingsConnectionString %>" 
 SelectCommand="SELECT * FROM [Events] WHERE (([EventDate] &gt;= @EventDate) AND ([EventDate] &lt;= @EventDate2))">
 <SelectParameters>
   <asp:Parameter DbType="Date" Name="EventDate" />
   <asp:Parameter DbType="Date" Name="EventDate2" />
 </SelectParameters>
</asp:SqlDataSource> 
```

如何修改 SQLDataSource 中的 EventDate 和 EventDate2 参数以使用 GetFirstofMonth(DateTime.Today); 和 GetLastofMonth(DateTime.Today) 分别作为它们的值？或者这是不可能的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T16:17:17.303

这可以通过处理 SqlDataSource 的“Selecting”事件来完成，如下所示：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" OnSelecting="SqlDataSource1_Selecting"
 ConnectionString="<%$ ConnectionStrings:MeetingsConnectionString %>" 
 SelectCommand="SELECT * FROM [Events] WHERE [EventDate] BETWEEN @EventDate AND @EventDate2">
 <SelectParameters>
   <asp:Parameter Name="EventDate" />
   <asp:Parameter Name="EventDate2" />
 </SelectParameters>
</asp:SqlDataSource> 
```

在您的代码隐藏或内联代码中（无论您在哪里定义了函数）添加此方法：

```
protected void SqlDataSource1_Selecting(object sender, SqlDataSourceEventArgs e)
{
  e.Command.Parameters["@EventDate"].Value 
           = GetFirstofMonth(DateTime.Now); //replace with your date param
  e.Command.Parameters["@EventDate2"].Value 
              = GetLastofMonth(DateTime.Now); //replace with your date param
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T16:23:21.920

一种方法是在您的页面上放置隐藏字段，使用您的方法在代码隐藏中设置这些字段的值以及日期，然后将数据源参数绑定到隐藏字段。

**代码隐藏**

```
public void Page_Load( ... )
{
     ...
     EventDate.Value = GetFirstOfMonth( DateTime.Today );
     EventDate2.Value = GetLastOfMonth( DateTime.Today );
     ...
} 
```

**标记**

```
<asp:HiddenField runat="server" id="EventDate" />
<asp:HiddenField runat="server" id="EventDate2" />

<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
 ConnectionString="<%$ ConnectionStrings:MeetingsConnectionString %>" 
 SelectCommand="SELECT * FROM [Events] WHERE (([EventDate] &gt;= @EventDate) AND ([EventDate] &lt;= @EventDate2))">
 <SelectParameters>
   <asp:ControlParameter DbType="Date" Name="EventDate" ControlID="EventDate" PropertyName="Value" />
   <asp:ControlParameter DbType="Date" Name="EventDate2" ControlID="EventDate2" PropertyName="Value" />
 </SelectParameters>
</asp:SqlDataSource> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T16:23:27.087

我通常发现这样做更简单：

```
select * from Events where Month(EventDate) = Month(getdate()) 
```

如果用户可以选择月份，那么您只需用一个参数替换月份编号（从选择列表返回）。

PS - 如果您想对事件数据（每小时计数、每天计数等）进行更复杂的汇总分析，并且您使用的是 SQL Server 2005+，那么本文中描述的功能[可能](https://stackoverflow.com/questions/373490/insert-dates-in-the-return-from-a-query-where-there-is-none/373734#373734)会很有用。

# java - 如何通过 JDBC 从 Microsoft Access 数据库中获取数据并将表作为测试字段插入 Applet

> ID：765580
> 
> 赞同：0
> 
> 时间：2009-04-19T15:36:46.743
> 
> 标签：java, sql, ms-access, jdbc, textarea

我做了一个小写字母游戏作为Java Applet。我通过 JBDC 制作了一个 Microsoft Access 数据库以获得高分。

我已经设法将值（分数）插入到数据库中，但是我无法获取它们并`textArea`在`ajFrame`. 我什至不确定连接是否已建立。我已经为它创建了 SQL 语句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T16:07:30.337

如果您已成功连接，那么

```
 connection=DriverManager.getConnection("jdbc:odbc:databaseName"); 
```

应该返回一个连接对象而*不是*抛出一个 SqlException。

所以我会首先检查上述情况是否属实。

请注意，applet*只能*与其原始服务器对话（这是一项安全功能）。因此，如果您的小程序是从服务器 A 提供的，而您的数据库在服务器 B 上，您应该会遇到安全异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-17T05:28:22.307

1.  使用 sql 提示检查您的查询。

2.  验证使用的对象名称（Drivermanager、Connection、TextField）

3.  包括 sql 语句的异常处理代码（try 和 catch）

# java - 如何在 Servlet 中使用“应用程序”对象？

> ID：765581
> 
> 赞同：5
> 
> 时间：2009-04-19T15:37:05.900
> 
> 标签：java, jsp, servlets

如果我们正在编写 JSP 文件，我们只需要使用嵌入的“应用程序”对象。但是如何在 Servlet 中使用它呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T15:51:03.293

`application`JSP 中的对象称为servlet[`ServletContext`](https://docs.oracle.com/javaee/7/api/javax/servlet/ServletContext.html)中的对象。这可以通过继承的[`GenericServlet#getServletContext()`](https://docs.oracle.com/javaee/7/api/javax/servlet/GenericServlet.html#getServletContext--)方法获得。除了方法之外，您可以在 servlet 中的任何位置调用它`init(ServletConfig)`。

```
public class YourServlet extends HttpServlet {

    @Override
    public void init() throws ServletException { 
         ServletContext ctx = getServletContext(); 
         // ...
    } 

    @Override
    public void doGet(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException { 
         ServletContext ctx = getServletContext(); 
         // ...
    } 

    @Override
    public void doPost(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException { 
         ServletContext ctx = getServletContext(); 
         // ...
    } 

} 
```

另请参阅[获取 Servlet 上下文的不同方法](https://stackoverflow.com/questions/35837285/differents-ways-to-get-servlet-context)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-19T15:42:18.993

[应用程序](http://java.sun.com/j2ee/tutorial/1_3-fcs/doc/JSPIntro7.html)对象引用[javax.servlet.ServletContext](http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/servlet/ServletContext.html)并且您应该能够在您的 servlet 中引用它。

要引用 ServletContext，您需要执行以下操作：

```
// Get the ServletContext
ServletConfig config = getServletConfig();
ServletContext sc = config.getServletContext(); 
```

从那时起，您将像在 JSP 中使用应用程序对象一样使用 sc 对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-19T15:49:33.920

试试这个：

```
ServletContext application = getServletConfig().getServletContext(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-29T12:58:50.870

在 Java Web 应用程序中，您经常拥有该`request`对象。所以你可以得到这样的`"application"`对象：

```
request.getServletContext().getServerInfo() 
```

# math - 布尔代数文章/书籍

> ID：765582
> 
> 赞同：2
> 
> 时间：2009-04-19T15:38:45.897
> 
> 标签：math, boolean, algebra

每次遇到位运算时，我都感到非常困惑，尤其是那些移位、旋转、溢出等。我想知道网上是否有任何介绍布尔代数的书/文章，这可以给我一个扎实的布尔代数背景，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T19:09:29.400

我想到了两本非常棒的书。

*   [代码：计算机硬件和软件的隐藏语言](https://rads.stackoverflow.com/amzn/click/com/0735611319)
*   [黑客的喜悦](https://rads.stackoverflow.com/amzn/click/com/0201914654)

此外，您可以在线阅读[Bit Twiddling Hacks](http://graphics.stanford.edu/~seander/bithacks.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T15:44:09.347

维基文章：

[布尔代数（简介](http://en.wikipedia.org/wiki/Boolean_algebra_(introduction))）

[布尔代数（逻辑）](http://en.wikipedia.org/wiki/Boolean_algebra_(logic))

[布尔逻辑](http://en.wikipedia.org/wiki/Boolean_logic)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T15:59:11.963

我不知道关于这个主题的任何书籍，但这里有一些在线资源......在我看来，你想要的是更好地理解二进制。[这是来自 MathWorld 的Binary](http://mathworld.wolfram.com/Binary.html)的一点处理，这是网络上最好的数学参考。这是一个关于[二元移位](http://www.geocities.com/gnashes30/java/applets/binary_shift.htm)的小程序。有一篇关于[按位运算](http://en.wikipedia.org/wiki/Bitwise_operation)的维基百科文章。Ben Fry 创建了一个很好的[计算器](http://scicalc.belfry.com/)，其中包含 Bit Roll (Rotation) - 请务必查看计算器上的帮助，因为它的功能远不止一开始显而易见的 - 例如，尝试将 Mode 更改为 Bin。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T15:45:02.700

在大学时，我们使用了一本名为[《逻辑设计导论》](https://rads.stackoverflow.com/amzn/click/com/0073191647)的书。涵盖了从布尔代数到 FPGA 的所有内容。相当全面，它有相当数量的练习。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-19T15:46:07.173

如果您使用类似 C 的语言，您还可以阅读以下内容：[C 中的位运算](http://www.gamedev.net/reference/articles/article1563.asp)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-03T03:21:17.133

当我上第一堂数字逻辑课时，我实际上做了 Minecraft 中的每一个实验。这可能对很多人没有帮助，他们在这里建造了许多不同的东西。

我推荐 minecraft 以获得一些有趣的实践经验，尽管它可能不是最“有效”的学习方式:)

# groovy - 如何从 groovy 闭包中返回并停止执行？

> ID：765605
> 
> 赞同：36
> 
> 时间：2009-04-19T15:49:41.673
> 
> 标签：groovy, closures, return

我想从闭包中返回，就像在循环中使用 break 语句一样。

例如：

```
largeListOfElements.each{ element->
    if(element == specificElement){
        // do some work          
        return // but this will only leave this iteration and start the next 
    }
} 
```

在上面的 if 语句中，我想停止遍历列表并离开闭包以避免不必要的迭代。

我见过一个解决方案，其中在闭包内引发异常并在外部捕获，但我不太喜欢该解决方案。

除了更改代码以避免这种算法之外，是否有任何解决方案？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-20T00:35:46.013

我认为您想使用 find 而不是 each （至少对于指定的示例）。闭包不直接支持中断。

在幕后，groovy 实际上并没有为 find 使用闭包，而是使用了 for 循环。

或者，您可以编写自己的增强版本的 find/each 迭代器，该版本接受条件测试闭包，如果找到匹配项则调用另一个闭包，如果匹配项则中断。

这是一个例子：

```
Object.metaClass.eachBreak = { ifClosure, workClosure ->
    for (Iterator iter = delegate.iterator(); iter.hasNext();) {
        def 值 = iter.next()
        如果（ifClosure.call（值））{
            workClosure.call(值)
            休息
        }        
    }
}

def a = ["foo", "bar", "baz", "qux"]

a.eachBreak( { it.startsWith("b") } ) {
    println "正在处理 $it"
}

// 打印“工作条”

```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-19T15:55:10.867

我认为您正在处理错误的抽象级别。该`.each`块完全按照它所说的那样做：它为每个元素执行一次闭包。相反，您可能想要的是用来`List.indexOf`找到正确的`specificElement`，然后在上面做您需要做的工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-13T14:10:54.450

如果您想处理所有元素，直到找到特定元素，您还可以执行以下操作：

```
largeListOfElements.find { element ->
    // do some work
    element == specificElement
} 
```

尽管您可以将其与任何类型的“中断条件”一起使用。我只是用它来处理集合的前 n 个元素，方法是返回

```
counter++ >= n 
```

在关闭结束时。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-13T02:49:54.790

据我了解，简化此类循环的方法是抛出用户定义的异常。我不知道语法是什么（不是一个 groovy 程序员），但是 groovy 在 JVM 上运行，所以它会是这样的：

```
class ThisOne extends Exception {Object foo; ThisOne(Object foo) {this.foo=foo;}}

try { x.each{ if(it.isOk()) throw new ThisOne(it); false} }
catch(ThisOne x) { print x.foo + " is ok"; } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-15T22:34:59.363

在 paulmurray 的回答之后，我不确定自己从闭包中抛出的异常会发生什么，所以我编写了一个易于思考的 JUnit 测试用例：

```
class TestCaseForThrowingExceptionFromInsideClosure {

    @Test
    void testEearlyReturnViaException() {
        try {
            [ 'a', 'b', 'c', 'd' ].each {                 
                System.out.println(it)
                if (it == 'c') {
                    throw new Exception("Found c")
                } 
            }
        }
        catch (Exception exe) {
            System.out.println(exe.message)
        }
    }
} 
```

上面的输出是：

```
a
b
c
Found c 
```

但请记住，**“不应使用异常进行流控制”**，请特别参阅这个 Stack Overflow 问题：[为什么不使用异常作为常规控制流？](https://stackoverflow.com/questions/729379/why-not-use-exceptions-as-regular-flow-of-control)

因此，上述解决方案在任何情况下都不太理想。只需使用：

```
class TestCaseForThrowingExceptionFromInsideClosure {

    @Test
    void testEarlyReturnViaFind() {
        def curSolution
        [ 'a', 'b', 'c', 'd' ].find {                 
            System.out.println(it)
            curSolution = it
            return (it == 'c') // if true is returned, find() stops
        }
        System.out.println("Found ${curSolution}")
    }
} 
```

上面的输出也是：

```
a
b
c
Found c 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-29T14:07:43.497

今天我在处理每个闭包时都遇到了类似的问题。我想根据我的情况打破执行流程，但做不到。

在 groovy 中最简单的方法是在列表上使用*any()*而不是 each() 如果您希望基于某些条件返回布尔值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-13T11:01:52.890

好的 ole`for`循环在 Groovy 中仍然适用于您的用例

```
for (element in largeListOfElements) {
    if(element == specificElement){
        // do some work          
        return
    }
} 
```

# c# - 为什么我在调用 ContextRegistry.GetContext() 时收到 Spring.NET 引发的异常？

> ID：765616
> 
> 赞同：4
> 
> 时间：2009-04-19T15:55:46.793
> 
> 标签：c#, wpf, spring.net

*即使解决方案如此明显，我也不应该发布此内容，但我将其留作提醒和对他人有用的参考点。*

我的 app.config 文件中有以下内容：

```
<sectionGroup name="spring">
  <section name="context" type="Spring.Context.Support.ContextHandler, Spring.Core"/>
  <section name="objects" type="Spring.Context.Support.DefaultSectionHandler, Spring.Core" />
</sectionGroup> 
```

其次是：

```
<spring>
  <context>
    <resource uri="config://spring/objects"/>
  </context>
  <objects xmlns="http://www.springframework.net">
    <object name="mediaLibrary" type="AlbumLibraryWPF.AlbumLibrary, AlbumLibraryWPF"/>
  </objects>
</spring> 
```

然后在我的应用程序中，我得到了：

```
using Spring.Context;
using Spring.Context.Support;

public partial class AlbumChecker : Window
{
    private DataTable dataTable;

    private Library library;
    private Thread libraryThread;

    public AlbumChecker()
    {
        InitializeComponent();

        CreateToolTips();

        IApplicationContext ctx = ContextRegistry.GetContext();
        library = (Library)ctx.GetObject("mediaLibrary");

        // Other initialisation
    }

    // Other code
} 
```

这一切都编译得很好，但是，我在调用 GetContext() 时遇到了一个异常：

```
Error creating context 'spring.root': Could not load type from string value
'AlbumLibraryWPF.AlbumLibrary, AlbumLibraryWPF'. 
```

我检查了 Spring.NET 文档，看不出我做错了什么——但我显然有问题，否则它不会引发异常！

`AlbumLibraryWPF`是命名空间，`AlbumLibraryWPF.AlbumLibrary`是我要实例化的类的完全限定名。我猜这是我错了，但看不出怎么做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-19T18:10:03.757

我觉得自己太傻了。

这是因为我未能将 AlbumLibrary.dll 复制到正确的输出目录。这意味着 Spring 找不到它——即使在我修复了 Kent 突出显示的程序集名称问题之后。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T16:05:52.230

逗号后面的名称应该是程序集名称，不一定与命名空间名称相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-04T15:12:34.783

我收到此错误是因为错误地在 app.config 文件中存在拼写错误 [!*2]。一旦我把它拿出来，错误就消失了。像这样的东西

```
<context>
  <!--<resource uri="~//Aspects.xml"/>-->
  <!--<resource uri="~//Dao.xml"/>-->
  <!--<resource uri="~//Spring.xml"/>-->
  <resource uri="file://Spring.xml"/>
  <resource uri="file://Dao.xml"/>
</context> 
```

!*2

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T16:05:14.757

您应该使用 tha`id`属性而不是`name`：

```
<object id="mediaLibrary" type="AlbumLibraryWPF.AlbumLibrary, AlbumLibraryWPF"/> 
```

它也应该`config://spring/objects`代替`config://spring/obects`.

您需要仔细检查您是否在程序集中定义的命名空间中调用`AlbumLibrary`了一个类型。`AlbumLibraryWPF``AlbumLibraryWPF`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-11-28T03:36:14.467

您可以尝试更改类型。type="AlbumLibraryWPF.AlbumLibrary, AlbumLibraryWPF"，第一个参数表示名称空间，第二个参数（点后面）表示解决方案名称。

*   "AlbumLibraryWPF.AlbumLibrary" = NameSapce 名称
*   "AlbumLibraryWPF" = 解决方案名称

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-29T09:24:55.163

1.  以管理员权限打开 VS2012 或 VS2010
2.  配置：type="namespace.type，程序集"

然后尝试再次运行您的解决方案。

# objective-c - 将“const void *”转换为“const char *”

> ID：765619
> 
> 赞同：3
> 
> 时间：2009-04-19T15:57:54.697
> 
> 标签：objective-c, casting, pointers, constants

我有这样的代码：

```
NSData *data = [NSData dataWithContentsOfURL:objURL];
const void *buffer = [data bytes];
[self _loadData:buffer];
[data release]; 
```

“_loadData”函数采用如下参数：

```
- (void)_loadData:(const char *)data; 
```

如何在 Objective-C 上将“const void *”转换为“const char ”？*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-19T16:02:14.797

就像你在 C 中一样：

```
[self _loadData:(const char *)buffer]; 
```

应该管用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T16:02:40.863

您不能释放数据对象，因为您没有明确分配它。此外，你可以做一个简单的演员：

```
[self _loadData:(const char *) buffer]; 
```

# java - 通过 Java 学习 OpenGL

> ID：765629
> 
> 赞同：7
> 
> 时间：2009-04-19T16:06:43.973
> 
> 标签：java, c++, opengl

我对学习 OpenGL 很感兴趣，当时我最喜欢的语言是 Java。我可以使用 JOGL 之类的东西获得其全部（或大部分）好处，还是应该专注于获得更强大的 C++ 技能？

顺便说一句，这是您选择的 Java OpenGL 包装库，为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-19T16:15:32.737

[JOGL](https://jogl.dev.java.net/)是一个包装库，它允许在 Java 编程语言中使用 OpenGL。它目前是 [JSR-231（OpenGL 的 Java 绑定）](http://jcp.org/en/jsr/detail?id=231)的参考实现，因此它应该是您的首选

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T16:44:45.613

我也用 Delphi 和 Java 做了一些基本的 OpenGL 开发。正如其他人的回复中提到的那样，我使用了 JOGL，我必须得出结论，尽管使用 JOGL 用 Ja​​va 编程 OpenGL 和用其他语言（Delphi、C++ 等）编程 OpenGL 几乎没有区别，但它只是没有感觉对。正确设置所有内容然后写下类似的东西让我发疯

```
gl.glBegin (GL.GL_QUADS) 
```

似乎有很多多余的东西`gl, GL, GLU`要写，它只会妨碍你。我相信，如果你使用 C++ 或类似的东西，而不是 Java，性能会更好。

我不是说 JOGL (Java+OpenGL) 的手，它可以做到，而且它真的没有太大的不同，但是......正如我所说。如果可以的话，试试 C++。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T16:22:50.083

如果您也有兴趣在 Java 中做 3D 的东西而不用担心所有低级的东西，请查看[Java3D](http://java.sun.com/javase/technologies/desktop/java3d/)。

最坏的情况，你可以看看他们如何利用 OpenGL 获得一些好的学习材料。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T16:32:22.633

如果你真的想认真学习 3d 编程，你必须学习 C/C++，C++ 是编程 3d 游戏的标准

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-19T16:19:21.307

用 C++ 做，你将使用的位基本上是相同的，因为指针不会有太多的混乱，所以这不是直觉的重大飞跃。此外，C++ 绑定更可靠，并且（根据我的经验）是所有可用语言中最快的（尤其是 Python 真的不能做 OpenGL）。

此外，C++ 始终是一门好学的东西，它让你更详细地思考编程概念，而不是仅仅弹出一个 ArrayList<> 或任何为你目的服务的预构建类 =]

# gwt - GWT：FlexTable 与表

> ID：765638
> 
> 赞同：12
> 
> 时间：2009-04-19T16:12:07.173
> 
> 标签：gwt

在什么情况下我应该使用 FlexTable 而不是 HTMLTable？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-20T16:30:14.797

HTMLTable 是一个抽象类。FlexTable 扩展了这个类以及 Grid。因此从不直接使用 HTMLTable，但您会使用 FlexTable 或 Grid。问题是何时使用 FlexTable？以及何时使用网格？

这些类之间的区别在于 Grid 始终具有相同数量的行和/或列，而 FlexTable 可以具有每列不同的行和每行不同的列（由于 html 属性 rowspan 和 colspan，这成为可能）。

因此，当您需要灵活的行或列时，您可以使用 FlexTable 或 Grid。

但是，由于用于创建表的 DOM 方法很慢，**因此 FlexTable 在 Internet Explorer 中的速度非常慢。**因此，如果您可以或仅使用 FlexTable 创建一个简单的布局，请避免使用它（尽管在这种情况下，DockPanel 可能更容易使用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T19:21:18.037

你不能这样比较。

根据文档

```
HTMLTable contains the common table algorithms for Grid and FlexTable. 
```

所以 Grid 或`Flextable`extends `HTMLTable`。

和

A`Flexible table`按需创建单元格。它可以是锯齿状的（即每行可以包含不同数量的单元格），并且可以将单个单元格设置为跨越多行或多列。

现在我们可以有一个问题`Grid or Flextable`？？？

这是[网格和 Flextable 之间的性能差异。](http://whatwouldnickdo.com/wordpress/401/performance-grid-vs-flextable/)

# memory-management - 解释 FreeBSD 中的 CPU 缓存分页，特别是分页队列

> ID：765650
> 
> 赞同：1
> 
> 时间：2009-04-19T16:20:06.157
> 
> 标签：memory-management, paging, freebsd, page-replacement

> FreeBSD 使用分页队列实现页面着色。队列根据处理器的 L1 和 L2 缓存大小排列；当需要分配一个新页面时，FreeBSD 会尝试获取一个与缓存最佳对齐的页面。

有人可以解释一下上述几行，分页队列的概念是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T17:27:14.937

操作系统必须管理 CPU 缓存的大小以减少[缓存未命中](http://en.wikipedia.org/wiki/Cache_miss)（也解释了页面着色）。更简单地说，存储在缓存中的数据（以页为单位）必须根据使用频率、是否可能很快再次使用以及重新检索数据的“昂贵”程度来仔细选择。来自主存储器/HD/SomeOtherDevice 的数据。这些选择在内存带宽成为瓶颈的应用中很重要。

这种类型的事情通常使用优先级队列来完成，该队列实现了操作系统开发人员选择的分页替换策略。这些队列确定当新数据移动到缓存时哪些页面被替换，以及数据在缓存中的位置。如果您想了解正在使用的策略，您应该查阅 FreeBSD 的文档。

为了对齐，高速缓存（或主存）中的数据需要从特定边界开始放置，以便有效访问（即移动到 CPU 寄存器中）。如果数据未对齐，则需要额外的计算来对齐它。

# macos - Mac OS X 中的音高检测

> ID：765660
> 
> 赞同：2
> 
> 时间：2009-04-19T16:25:39.857
> 
> 标签：macos, audio

我想没有人知道任何允许您检测 Mac OS X 中麦克风接收到的当前音高（即在音符中）的库？我假设它是 Objective-C 和一些提供的 lib 的混合体。还是在 Java 中实现多平台优势？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-06-23T07:39:29.053

这里有一些代码片段描述了音高的自相关。

[http://www.iwillapps.com/wordpress/?p=212](http://www.iwillapps.com/wordpress/?p=212)

[http://www.iwillapps.com/wordpress/?p=214](http://www.iwillapps.com/wordpress/?p=214)

此外，这是对两种音高检测的一个很好的“解释” [http://cnx.org/content/m11714/latest/](http://cnx.org/content/m11714/latest/)）：

1.  时域自相关
2.  频域谐波积谱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T13:32:41.003

musical DSP solutions are difficult. finding something particularly GOOD *and* packed in a library *and* for free is very optimistic. (the music software industry being as competitive as it is...)

a useful repository of source code can be found at [http://www.musicdsp.org/](http://www.musicdsp.org/)

otherwise, Miller Puckette's Fiddle~ code does pretty much exactly what you describe. it is not a library, though (it is an extension to PD). but the source is available AFAIK.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T16:27:56.763

好吧，您可以在从麦克风录制样本后使用[Aubio](http://aubio.org/)，或者找到一种管道连接到它的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T17:29:26.070

不知道任何特定的库，但[Praat](http://www.fon.hum.uva.nl/praat/)确实进行音高分析，在 OS X 上运行并且可以编写脚本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-08T23:25:47.723

誊写很棒。它将向您显示录音的音高，并显示哪些钢琴键。

如果您想自己编写此代码，请查看 FFT（快速傅立叶变换）算法。它实际上很容易实现。Id 进行 FFT（将信号转换为其频率分量），然后只挑出最上面的那个。

# directx - 如何调整整个屏幕的大小？

> ID：765662
> 
> 赞同：0
> 
> 时间：2009-04-19T16:27:36.077
> 
> 标签：directx, resize

我希望能够重新调整显示的所有内容的大小——任务栏、窗口、桌面——所有内容并将其放在边框中。实现这一目标的最佳方法是什么？我在想 DirectX，但我对它不是很熟悉。我不确定什么技术可以做到这一点，但我敢打赌它必须是相当低的水平。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T16:52:03.320

DirectX 有自己的 API，但如果你想改变任务栏和桌面，我宁愿你必须去 Windows API。

要使用的直接 API 调用是[ChangeDisplaySettings()](http://www.pinvoke.net/default.aspx/user32/ChangeDisplaySettings.html)或[ChangeDisplaySettingsEx()](http://msdn.microsoft.com/en-us/library/dd183413(VS.85).aspx)，但您需要获取一个填充的[DEVMODE](http://msdn.microsoft.com/en-us/library/dd183565(VS.85).aspx)结构才能正确使用它。DEVMODE 是一头野兽。您将需要使用[EnumDisplaySettings()](http://msdn.microsoft.com/en-us/library/dd162611(VS.85).aspx)填充它，确定哪个显示器是您的主屏幕，并调整 dmBitsPerPel、dmPelWidth 和 dmEplHeight 成员。并非所有可能的设置都受支持：我认为[DeviceCapabilities()](http://msdn.microsoft.com/en-us/library/dd183552(VS.85).aspx)可以告诉你......这应该让你开始。

您没有明确告诉我们您要使用的是 Windows，也没有告诉我们您使用的是哪种语言。

# php - 使用 JSON 或 XML 发送 JavaScript 数组？如何将其转换为 XML？

> ID：765664
> 
> 赞同：2
> 
> 时间：2009-04-19T16:28:56.683
> 
> 标签：php, javascript, xml, json, prototypejs

好的，我的情况是这样的：我需要将 JavaScript 数组的内容发送到服务器，PHP 脚本会将单个数组条目保存在 MYSQL 数据库中。我没有使用 jQuery，但我即将将 Prototype 框架集成到我的项目中。

我收集到可以使用 Prototype 提供的 toJSON() 方法轻松地将 JS 数组转换为 JSON。然后我可以将其发布到我的脚本中，该脚本会以某种方式对数组进行 de-JSONise 并将值插入 DB。

但我也感兴趣的是不使用 JSON 数据交换格式，而是将 JS 数组转换为 XML，这可以很容易地被 simplexml PHP 扩展解析（为自己节省一些服务器端的开发时间）。因此，我的问题是：我应该选择 JSON 还是 XML？以及如何将 JS 数组转换为 XML？（是否有一个 toXML() 方法，就像 Prototype 中的 toJSON() 一样？）

我知道各种各样的非常相似的问题，但他们似乎都在反过来问这个问题……将 JSON 转换为 JS 数组，而且很多都与 jQuery 相关。所以请帮助我，即使这可能是重复的，并且您可能已经在其他地方回答了这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T17:05:26.097

您尝试过 php_json 扩展方法吗？使用它们，您将能够将 JSON 对象转换为 PHP 对象。

从那里你可以做任何你想做的事。创建一个 XML 字符串以使用 SimpleXML 处理或持久保存到 DataStore。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T17:34:50.313

如果您使用 php 的内置[json_decode ，您将真正节省开发时间](http://ca3.php.net/json_decode)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T16:45:25.207

使用 toJSON() 后，您可以使用它从[gossner.net](http://goessner.net/2006/06/converting-between-xml-and-json-xmlcom.html)（[源文件](http://goessner.net/download/prj/jsonxml/json2xml.js)）将 JSON 转换为 XML：

```
/*  This work is licensed under Creative Commons GNU LGPL License.

    License: http://creativecommons.org/licenses/LGPL/2.1/
    Version: 0.9
    Author:  Stefan Goessner/2006
    Web:     http://goessner.net/ 
*/
function json2xml(o, tab) {
   var toXml = function(v, name, ind) {
      var xml = "";
      if (v instanceof Array) {
         for (var i=0, n=v.length; i<n; i++)
            xml += ind + toXml(v[i], name, ind+"\t") + "\n";
      }
      else if (typeof(v) == "object") {
         var hasChild = false;
         xml += ind + "<" + name;
         for (var m in v) {
            if (m.charAt(0) == "@")
               xml += " " + m.substr(1) + "=\"" + v[m].toString() + "\"";
            else
               hasChild = true;
         }
         xml += hasChild ? ">" : "/>";
         if (hasChild) {
            for (var m in v) {
               if (m == "#text")
                  xml += v[m];
               else if (m == "#cdata")
                  xml += "<![CDATA[" + v[m] + "]]>";
               else if (m.charAt(0) != "@")
                  xml += toXml(v[m], m, ind+"\t");
            }
            xml += (xml.charAt(xml.length-1)=="\n"?ind:"") + "</" + name + ">";
         }
      }
      else {
         xml += ind + "<" + name + ">" + v.toString() +  "</" + name + ">";
      }
      return xml;
   }, xml="";
   for (var m in o)
      xml += toXml(o[m], m, "");
   return tab ? xml.replace(/\t/g, tab) : xml.replace(/\t|\n/g, "");
} 
```

也就是说，我个人会选择 JSON。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T09:30:51.950

我建议使用本机查询字符串，这将消除所有转换过程。这是将进行适当转换的代码：

```
/**
 * This function serializes the object to a standart URI query string which can directly interpreted by PHP.
 * 
 * @param {String} [format] The desired format for the output. Not needed for most usages.
 * @return {String} The URI query string.
  */
Object.prototype.toQueryString=function(format, encodeURI)
{
    if (typeof format!='string')
        format='%s';
    var result='';
    for (var paramName in this) 
    {
        if (this.constructor==Array && isNaN(parseInt(paramName)) || !this.hasOwnProperty(paramName))
            continue;

        if (this[paramName].constructor==Object || this[paramName].constructor==Array)
            result += '&' + this[paramName].toQueryString(format.format(paramName) + '[%s]', encodeURI);
        else
            result += '&' + format.format(paramName) + '=' + ((encodeURI!==false)?encodeURIComponent(this[paramName]):this[paramName]);
    }
    return result.substr(1);
}; 
```

有些人可能不喜欢使用 Object.prototype。如果您是其中之一，则可以轻松更改该功能以用作单独的功能。如果需要帮助，请敲我；）

# visual-studio - .vssettings 文件的架构？

> ID：765666
> 
> 赞同：4
> 
> 时间：2009-04-19T16:29:50.893
> 
> 标签：visual-studio, vssettings

我想手动编辑一个 Visual Studio 团队设置文件以进行一些更改。.vssettings 文件的任何地方（XSD 或英文散文）是否有记录的架构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T11:07:18.413

您能否详细说明您要编辑的内容，为什么？如果您遇到无法从 GUI 设置的内容，我会感到*非常惊讶。*如果您需要跨多台机器自动化一些 IDE 设置，我建议使用 IDE 宏。

从技术上讲 - 答案是否定的。vssettings 文件未针对任何架构进行验证，无论是否记录在案。如果从元素名称中看不出如何实现您想要的 - 例如，您可以使用 GUI 设置所需的选项，并将生成的 vssettings 与初始选项进行比较。
但是，再一次，你为什么要这样做？

# sql - MySQL 帮助：SELECT table2.id WHERE ... table1.date 最大

> ID：765667
> 
> 赞同：0
> 
> 时间：2009-04-19T16:30:39.173
> 
> 标签：sql, count, max

我有 2 个表，使用内部联接来查询它们。

```
SELECT COUNT(table2.id) 
FROM table2 
INNER JOIN table1 ON table2.relazioneid = table1.id 
WHERE table1.date > ? AND table1.date < ? 
```

它计算 2 个日期之间报告的条目 ID。表 1 保存有关报告的信息（日期、组 ID 等），表 2 保存报告中的条目。

我想做一个几乎完全相同的查询，除了它只从这两个日期之间的最新日期的报告中选择 ID。

任何人都可以帮忙吗？我无法完全理解 MAX(date) 类型的查询——我得到的只是每个 id 的计数以及最大日期，而不仅仅是来自最大日期的那些 id。

谢谢，

* * *

我一直在想也许是一个嵌套的 SQL 查询——你能做到吗？我可以在 Google 上找到参考资料，但无法使用...类似于：

```
SELECT COUNT(table2.id) 
FROM table2 
INNER JOIN table1 ON table2.relazioneid = table1.id 
WHERE table1.date > ? AND table1.date < ? AND 
(
    SELECT MAX(date) 
    FROM table1 
    WHERE date > ? AND date < ?
) 
```

但是无法让它工作，当我尝试在 phpMyAdmin 中对其进行测试时，它会因为告诉我我的用户没有 SELECT 权限的错误而将我踢出去。奇怪，因为这是我以 root 身份登录的测试服务器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T17:32:55.920

如果没有有关表结构的更多信息，我建议您尝试以下操作：

```
SELECT t2.id
FROM table1 t1
INNER JOIN table2 t2 ON t1.id = t2.relation_id
WHERE t1.date BETWEEN ? AND ?
HAVING MAX(t1.date) 
```

我没有对此进行测试，但它应该指向一个你可以解决这个问题的方向。您使用子查询的其他建议是有效的，可能会像这样工作：

```
SELECT *
FROM table2 t2 
WHERE t2.parent_id IN (
    SELECT t1.relation_id
    FROM table1 t1
    WHERE t1.date BETWEEN ? AND ?
    GROUP BY t1.relation_id
    HAVING MAX(t1.date)
) 
```

或者在一个临时表的连接中：

```
SELECT *
FROM table2 t2
INNER JOIN (
    SELECT t1.relation_id
    FROM table1 t1
    WHERE t1.date BETWEEN ? AND ?
    GROUP BY t1.relation_id
    HAVING MAX(t1.date)
) AS t1 ON t2.relation_id = t1.relation_id 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-19T16:41:25.873

```
 ...WHERE table1.date BETWEEN'2009-01-01' AND '2009-01-02' ORDER BY table1.date LIMIT 10 
```

会给你 10 第一行的日期

# java - Java Swing/AWT 中的 Vista 玻璃边框效果

> ID：765670
> 
> 赞同：0
> 
> 时间：2009-04-19T16:32:10.077
> 
> 标签：java, swing, drawing, blur

我正在尝试使用类似 Vista Aero Glass 的背景创建覆盖层来代替普通窗口。我的部分答案似乎在[这里](https://stackoverflow.com/questions/54926/java-make-a-jpanel-not-draw-its-background)，但我想知道如何在 Swing/AWT 中获得模糊效果。[这](http://www.java2s.com/Code/Java/2D-Graphics-GUI/ImageFilter.htm)看起来像一个开始：

```
public BufferedImage processImage(BufferedImage image) {
    float[] blurMatrix = { 1.0f / 9.0f, 1.0f / 9.0f, 1.0f / 9.0f, 1.0f / 9.0f, 1.0f /  
            9.0f, 1.0f / 9.0f, 1.0f / 9.0f, 1.0f / 9.0f, 1.0f / 9.0f };
    BufferedImageOp blurFilter = new ConvolveOp(new Kernel(3, 3, blurMatrix),
            ConvolveOp.EDGE_NO_OP, null);
    return blurFilter.filter(image, null);
} 
```

...但我真的很想获得一场势均力敌的比赛。看来流程应该是：

1.  模糊背景图像
2.  涂上透明的灰色（或任何你想要的背景颜色）
3.  然后绘制不透明的窗口内容

如果我做对了，我可能会加入 Aero 窗口边框阴影。

我在正确的轨道上吗？我应该多精确地进行模糊以获得相同的外观？也许有人已经解决了这个问题？（作为参考，打开 Vista 开始菜单并查看右侧。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-30T22:22:26.287

我没有手头的解决方案，但您绝对可以在模糊阶段叠加颜色。您需要了解的有关 Swing 效果和 Swing 图像效果的一切都在出色的[Filthy Rich Clients](http://filthyrichclients.org/)中。你的问题的答案肯定在那里。

事实上，如果您查看示例部分并从该站点下载第 8 章的代码，就会有代码可以进行所需的模糊和着色。

谢谢，jT

# grails - 为什么这么多人坚持将 JVM 拖到新的应用程序中？

> ID：765672
> 
> 赞同：7
> 
> 时间：2009-04-19T16:32:31.243
> 
> 标签：grails, groovy, jvm, jruby, jython

例如，我遇到了对 Rails 应用程序感到害怕的开发人员和架构师，但他们喜欢编写新的 Grails 应用程序的想法。

据我所见，使用 JVM 来支持 Groovy、JRuby 和 Jython 等语言而不是直接使用 Ruby 或 Python 会产生大量资源开销。

Ruby 和 Python 几乎都可以在任何操作系统上进行解释，所以我看不到任何“一次编写，随处运行”的优势……为什么要带上笨重的 JVM？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-19T16:39:15.080

Java 是一个成熟得多的平台，与 Ruby 或 Python（甚至 Perl，就此而言）相比，可以“插入”并使用许多现有的类库。因此，对于喜欢使用现有代码而不是自己编写所有代码的人来说，Java 是一个巨大的胜利。

例如，最近我一直在寻找类似 JAXB for Python 或 Ruby 的东西。最后，我最终还是使用了 JRuby，因为我还没有找到任何成熟的、广泛使用的 XML 绑定库。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-19T18:18:24.983

为 JVM 编写代码（用任何语言）的巨大优势在于，如果有必要，通常很容易利用那里大量成熟的 Java 库。

而且我不知道你从哪里得到这个“笨重”的 JVM 的想法，它具有巨大的资源开销。JIT 倾向于生成非常快的代码，而按照今天的标准，核心 JVM 绝不是巨大的。它在运行时确实会占用大量内存，但这是因为现代机器具有大量 RAM，而 GC 在有大量 RAM 可供使用时效果最佳。如果需要，可以将 GC[微调到地狱并返回](http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp)到更保守的状态。

正如其他人所说：“Groovy 最好的一点是我不必*使用*Java。Groovy 的第二个优点是我*可以*使用 Java”。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-24T14:15:43.873

一个似乎包含在问题中的假设是新项目是[新建项目](http://en.wikipedia.org/wiki/Greenfield_project)。在过去的十多年里，许多组织对 Java 进行了巨额投资，并且要求任何新项目都可以在现有（内部）代码生态系统中工作。正如所指出的，所有公开可用的 Java 库（无论是免费的/OSS 还是商业的）都有巨大的好处，但是使用现有代码甚至作为现有系统中的组件的需求至少同样重要（如果不是更多的话）所以）到大型组织。

很多还归结为平台的成熟度和功能，也就是说 JVM 和它附带的一切（整个 Java 生态系统）。我脑海中的几个例子：

*   您可以将远程调试器插入正在运行的 JVM 并获取有关正在运行的应用程序的各种信息，这对于 Python、Ruby 等来说是不可能的。更进一步，有[JMX](http://en.wikipedia.org/wiki/Java_Management_Extensions)，这是一种编写代码的标准方法，以便对象可以被监控甚至在实时应用程序中进行调整。看看[JConsole](http://java.sun.com/developer/technicalArticles/J2SE/jconsole.html)，看看你是不是有点流口水（尽管界面很丑）。

*   在这个方向上更进一步，还有[OSGi](http://en.wikipedia.org/wiki/OSGi)，这是一种编写高度模块化代码的标准，可以在实时应用程序中部署、启动、停止甚至升级。使用 OSGi，您可以将大型应用程序分解为许多较小的“捆绑包”，然后可以单独维护（部署、启动/停止、升级）。这对于大型应用程序或任何需要始终保持运行的应用程序来说非常重要。

*   该平台对异步、可靠的消息传递有*很好*的支持。您将[JMS](http://en.wikipedia.org/wiki/Java_Message_Service)作为基线，并在其上构建了许多出色且强大的库，用于用很少的代码完成复杂的事情（参见[Apache Camel](http://camel.apache.org/)、[ServiceMix](http://servicemix.apache.org/home.html)、[Mule](http://www.mulesource.com/)等）。这是另一个在大型应用程序或必须在更大的代码世界中运行的应用程序中非常有价值的功能。

*   JVM 具有真正的（操作系统级）线程，而 Python 等。在这方面*非常*有限（众所周知）。（话虽这么说，共享状态并发——线程——是错误的方法；参见[Erlang](http://erlang.org/)、[Alice](http://www.ps.uni-sb.de/alice/)、[Mozart/Oz](http://www.mozart-oz.org/)等）

*   除了标准的 Sun 实现之外，还有许多 JVM 选择，如[JRockit](http://www.oracle.com/technology/products/jrockit/index.html)、IBM 的 JVM 等。这是一个与其他语言一起发展的领域——Python 有 Jython、Iron Python，甚至 PyPy 和 Stackless；Ruby 有 JRuby、Rubinius 和[其他](http://antoniocangiano.com/2007/12/03/the-great-ruby-shootout/)—— 但尽管这些都很好，但它们无法与各种 JVM 产品中的成熟度相提并论。

话虽如此，我真的不喜欢 Java*这种语言*并尽可能避免使用它。这些天来，我不必为 JVM 提供所有优秀的替代语言。Groovy 因其可访问性和与平台（甚至语言）的紧密集成而获得了我的投票，并且因为 Grails，我有时喜欢将其称为“成人的 Rails”。我更喜欢其他 JVM 语言，尤其是[Clojure](http://clojure.org/)和[Scala](http://www.scala-lang.org/)，但这些对于普通程序员来说并不容易。不过，Scala 最近出现了很多，特别是由于它[在 Twitter 上的高调使用](http://developers.slashdot.org/article.pl?sid=09/04/07/1928218)，因此希望在更大的环境中使用有趣且真正优秀的语言。但这是另一个话题。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-19T17:16:02.590

> 为什么要和你一起使用笨重的 JVM？

JVM 不臃肿，也不慢。相反，它是一个精简、快速、深度优化的虚拟机。不幸的是，它针对静态 OOP 语言进行了优化。

尽管如此，针对 JVM 的优秀编译器确实可以创建性能良好的程序。我不知道 JRuby；但是 Jython 的目标是比普通的 C Python 更快，并且它们正在接近（在几个重要的用例中已经更快了）。

请记住，一个好的 JIT（比如那些用于 JVM 的 JIT）可以应用一些静态 C 编译器上不可用的优化，从它们那里获得更快的代码并不是白日梦。当然，为您的语言优化的 VM*应该*比 JVM 之类的“非通用”VM 更快；但存在成熟度问题：JVM 在那里完成了*很多*工作，而用于 Ruby 和 Python 的 JIT 还远远没有。

不幸的是，似乎没有更好的通用字节码虚拟机。Microsoft 的 CLI 与 JVM 存在类似的限制（ironPython 比 JPython 慢得多且重得多）。最好的候选人似乎是 LLVM。有人知道为什么 LLVM 上没有更多的动态语言吗？我见过几个 Scheme 编译器，但似乎有几个问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-19T18:34:55.770

Groovy 不是解释型语言，它是一种动态语言。groovy 编译器生成在 JVM 内部运行的 JVM 字节码，就像任何其他 java 类一样。从这个意义上说，groovy 就像 java 一样，只是在 java 语言中添加了只对开发人员有意义而不对 JVM 有意义的语法。

开发人员的生产力、语法的易用性和灵活性使 groovy 对 java 生态系统具有吸引力——如果 ruby​​ 或 python 生成 java 字节码（参见 jython），它们将同样具有吸引力。

Java 开发人员并不是真的害怕 ruby​​。事实上，许多人很快就接受了 groovy 或 jython 两者都接近 ruby​​ 和 python。他们不关心的是离开这样一个令人惊叹的平台（java）来使用性能较差、可扩展性较差甚至使用较少的语言，例如 ruby​​（尽管有它的优点）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-21T22:20:48.537

RoR 最大的问题是它不可扩展且难以部署。通过使用 Java 平台，您可以利用现有的基础架构。

```
grails war 
```

生成一个易于部署在 Glassfish、Jboss 等上的 war 文件。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-21T22:35:44.803

> Ruby 和 Python 几乎都可以在任何操作系统上进行解释，所以我看不到任何“一次编写，随处运行”的优势……为什么要带上笨重的 JVM？

主要是因为您想利用庞大的现有 Java 库、API 和产品生态系统，这使 Ruby 或 Python 的任何可用产品相形见绌，尤其是在企业领域。

另外，请记住，JRuby 和 Jython在许多基准测试中都比语言的常规（C 实现）*更快，尤其是 Ruby（甚至 Ruby 1.9）。*

针对同一虚拟机使用多种语言有很多好处，例如利用通用基础架构、代码重用、共享 API、使用概念上最适合您或特定问题域的任何语言的能力等。

同样的事情发生在 .NET 领域，有[多种语言](http://blogs.ugidotnet.org/nettools/articles/8060.aspx)针对 CLR。[Parrot](http://en.wikipedia.org/wiki/Parrot_virtual_machine) (vaporware) VM 项目的目标也是相同的，这也是[LLVM](http://llvm.org/)项目的既定目标。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-21T22:38:23.110

原因是热点。

这是一场工程之旅。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-24T12:05:48.977

没有多少人提到的另一个原因是与 jvm 相关的现有基础架构 - 如果您已经有一个运行 java 的服务器，为什么不使用它而不是引入另一个平台（如 rails）？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-05-15T04:20:20.203

我遇到过这种情况，也对此感到困惑，这是我的理论。

企业软件充满了 Java 程序员。与各行各业的程序员一样，许多 Java 程序员都相信他们的语言是最快、最灵活和最容易使用的——他们对其他语言不太熟悉，但相信那些实践它们的人一定是野蛮人和野蛮人，因为任何开明的人当然都会使用 Java。

这些人构建了庞大而复杂的 Java 基础设施：框架的 rube-goldberg 机器和充满拜占庭继承结构的自动生成代码和非常非常大的 XML 文件。

所以，当有人走过来说“嘿！让我们使用 C 解释语言！它速度快，有整洁的库，并且脚本和原型设计要快得多！” Java 的家伙首先就像“我必须运行一个 make 文件来配置它？QUEL HORREUR！” 然后，必须在运行过时的操作系统和过时版本的 Tomcat 的服务器上部署和托管它的现实开始出现。

“嘿，我知道！这种解释语言有一个 java 版本！它可能会在高峰时段在桥上的快车道上抛锚，有时它会着火，但我可以让 Tomcat 运行它。我不’不必为了学习非 Java 的东西而弄脏我的双手，我可以将它硬塞到现有的基础设施中！赢了！”

那么，这是选择脚本语言的 java 实现的“正确”原因吗？可能不是。取决于你对“正确”的定义。但是，我怀疑这就是他们比我这样的势利小人更愿意相信的原因。

# wpf - 在 WPF 中渲染数学方程 - 设计建议？

> ID：765674
> 
> 赞同：1
> 
> 时间：2009-04-19T16:33:16.890
> 
> 标签：wpf

我想在 WPF 中显示数学方程。我想使用本机 WPF 对象（即，不是来自先前渲染的方程图像）来显示它。例如，变量 X 将是字形 X，等等。

我在这里有哪些设计选择？有人知道这样做的任何图书馆吗？还是DYI是唯一的出路？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-05-02T07:29:12.477

我认为 windowsclient 的解决方案没有帮助。对于该领域的常见问题，它有很多解决方法。

更好的方法是：http: [//blog.noldorin.com/2010/04/rendering-tex-math-in-wpf/](http://blog.noldorin.com/2010/04/rendering-tex-math-in-wpf/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T22:57:49.227

我找到了这个库：[Displaying math equations in WPF](http://windowsclient.net/downloads/folders/controlgallery/entry2346.aspx)。

希望能帮助到你。

# asp.net - 我的站点地图无法正常工作

> ID：765677
> 
> 赞同：0
> 
> 时间：2009-04-19T16:36:12.937
> 
> 标签：asp.net, sitemappath

当我使用 SiteMapPath 时，这个错误是什么。当我单击我网站中的一个链接时，此错误出现在页面中。当然，当我上传我的网站时，我看到了这个错误：

找不到页面 您要查找的页面可能已被删除、名称已更改或暂时不可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T16:47:11.973

根据该错误，您的**SiteMap**中的 URL 似乎不是相对的。例如，假设您有一个名为“Example”的子目录和一个位于该“Example”目录中的名为“test.aspx”的页面。此条目将产生 404 错误（找不到页面）。

```
<siteMapNode url="Test.aspx" title="Test Page" /> 
```

这将是正确的 siteMapNode 条目：

```
<siteMapNode url="~/Example/Test.aspx" title="Test Page" /> 
```

# java - 从视频中抓取随机帧并制作 gif 图像 - Java

> ID：765679
> 
> 赞同：2
> 
> 时间：2009-04-19T16:38:23.850
> 
> 标签：java, video, random, frames

我想知道是否可以从视频中抓取随机帧，然后将这些帧“粘贴”在一起以制作 gif 图像？

我打算通过Java编程来实现上述想法。

我应该使用什么？（虽然我精通Java，但我之前没有涉及视频的编程经验）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T16:44:56.720

[Java 媒体框架](http://java.sun.com/javase/technologies/desktop/media/jmf/)让你做这种事情

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-11T22:44:59.220

这是一些使用[Xuggler](http://www.xuggle.com/xuggler)的源代码，可让您从视频中获取原始图像。从 Java 保存到图像非常简单。

[示例代码](http://build.xuggle.com/view/Stable/job/xuggler_jdk5_stable/ws/workingcopy/src/com/xuggle/mediatool/demos/DecodeAndCaptureFrames.java)。

# dependency-injection - 为什么 Google Guice 的依赖注入根本没有配置文件？

> ID：765680
> 
> 赞同：12
> 
> 时间：2009-04-19T16:39:03.757
> 
> 标签：dependency-injection, configuration-files, guice

我正在检查[Google Guice 作为 DI 框架](http://code.google.com/p/google-guice/)，但我有点困惑：为什么根本没有配置文件？

我找到了关于[这个问题](https://stackoverflow.com/questions/506359/why-would-you-want-dependency-injection-without-configuration)的部分解释，但仍然不清楚如何在没有配置文件的情况下设置我的组件角色（或我需要使用开关的任何其他东西）。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-19T16:56:18.300

配置在代码中而不是配置文件中，这对于许多场景来说都是一个有效的决定。

是的，这意味着如果你想发布一种不同的管道应用程序的方式，你必须重新构建（可能只是模块）——当然，如果你愿意，你仍然可以从命令行参数、属性文件等中获取一些配置值到。

如果您经常需要更改您的应用程序管道并且不想重新部署除单个文件之外的任何内容，那么 Guice 可能不适合您。另一方面，如果您使用 DI 的主要原因是让您的代码更清晰，并且在生产中您将始终使用相同的管道（或足够接近），那么 Guice 是一个不错的选择 - 通常有一些您想要的逻辑在整理管道时使用，以及通常难以以声明方式描述/构造的组件。

不同的 DI 框架有不同的好处和权衡 - 使用最适合您的应用程序的框架。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-12-18T02:27:18.387

如果您愿意，使用配置文件引入 boostrapping 是微不足道的。我们将 Guice 与一个简单的 API 一起使用，该 API 将属性文件加载到真正需要参数化的地方。这可以与@Named 注释等一起使用，当然您可以在模块中使用一些条件（尽管不要过度这样做是个好主意）。

这是我们如何设置部分引导的示例：

```
public class MetModules extends AbstractModule {

    private static final Logger log = LoggerFactory.getLogger(MetModules.class);

    private final Settings settings;

    public MetModules(Settings settings) {
        this.settings = settings;
    }

    @Override
    protected void configure() {

        // common (stage independent modules) go here
        install(new CommandsModule());
        install(new ServletsModule());
        install(new DataBaseModule(settings));
        install(new JobsModule(settings));

        // any development/ production specific modules
        Stage stage = currentStage();
        if (Stage.DEVELOPMENT.equals(stage)) {
            configureForDevelopment();
        } else { // PRODUCTION
            configureForProduction();
        }
    }

    /**
     * Install modules that will be used in development.
     */
    private void configureForDevelopment() {

        // Mock implementation of email delivery that just logs it got a
        // message rather than trying to send it.
        install(new AbstractModule() {
            @Override
            protected void configure() {
                bind(Delivery.class).toInstance(new Delivery() {

                    public String deliver(MailMessageExchange exchange)
                            throws DeliveryException {
                        log.info("email message: "
                                + exchange.getMessage().getMailMessage()
                                + " to "
                                + Arrays.asList(exchange.getMessage()
                                        .getMailMessage().getTo())
                                + " (not sent)");
                        return "fooMessageId";
                    }
                });
            }
        });

        // local in-memory registry suffices
        install(new LocalServiceRegistryModule());

        // local in memory db implementations of services
        install(new LocalServicesModule());
    }

    /**
     * Install modules that will be used in production.
     */
    private void configureForProduction() {
        // we really only need this (error interception and audit logging)
        // in production
        install(new AopModule());
        install(new ZooKeeperServiceRegistryModule());      }
} 
```

其中 Settings 是读取我们的属性文件等的内容。现在，开发/生产以及特定于部署的特定设置覆盖似乎为我们完成了这项工作，但如果我们显然愿意，我们可以更进一步。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-19T17:53:49.660

大多数 DI 配置从一个部署到另一个部署都是相同的，因此它们可以很好地使用代码进行配置，这使得 Guice 的配置非常简洁，您可以获得编译时类型检查、重构工具、代码导航等的好处。

对于那些从部署到另一个更改的东西，例如数据库用户名和密码配置，您可以自己编写所需的代码。编写代码来读取配置文件（可能是属性文件），解析参数，并将它们绑定到您的 Guice 模块中，以便您的应用程序可以访问它们。执行此操作所需的代码不会占用很多代码行。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-19T17:13:58.010

Guice 中的很多配置都是隐含的，通过 @Inject 注解。项目中的大量复杂性来自大量的项目工件。Java 文件、Xml 文件、属性文件、数据库、参数.. Guice 试图通过不使用配置文件来消除这种复杂性的一部分。

在编译时重新连接您的应用程序很容易。您很可能只需要编辑您的模块类。对于 Guice 处理的大多数类，您根本不需要配置，而只需要在正确的位置使用 @Inject - 当您有相同接口的两个不同实现时，您只需要配置任何东西 - 或者当您想要从使用 Provider 类的外部库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T18:05:58.743

不确定您所说的文件是什么意思，但 Guice 允许您通过 [Binder](http://google-guice.googlecode.com/svn/trunk/javadoc/com/google/inject/Binder.html)和自定义[Providers](http://google-guice.googlecode.com/svn/trunk/javadoc/com/google/inject/Provider.html)更改实现。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-15T08:24:19.477

我最近创建了以下项目。

[http://code.google.com/p/guice-property-injector/](http://code.google.com/p/guice-property-injector/)

它是 WIP，但允许从基于环境的属性文件运行时注入属性。

# asp.net - 如果 (fileUpload.HasFile)=false

> ID：765683
> 
> 赞同：3
> 
> 时间：2009-04-19T16:40:42.207
> 
> 标签：asp.net, vb.net, file-upload

大家好，这里是代码，然后我将解释我的问题：-

```
 Protected Sub btnupload_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnUpload.Click
    If (IsPostBack) Then
        HandleUploadedFile()
        Dim savePath As String = "Images\"
        If (fileUpload.HasFile) Then
            Dim fileName As String = fileUpload.FileName
            savePath = Server.MapPath(savePath) + fileName
            fileUpload.SaveAs(savePath)
            Me.Label1.Text = "Your file was saved as " & fileName
            adp.Insert(fileUpload.FileName)
        Else
            Me.Label1.Text = "You did not specify a file to upload."
        End If
    End If
End Sub 
```

每次我跟踪代码时，它都会这么说，`(fileUpload.HasFile)=false`之后再也看不到代码，然后跳转到 else 语句，这就是代码的其余部分

```
Private Sub HandleUploadedFile()
    ' get the root of the web site 
    Dim root As String = Server.MapPath("~/")

    ' clean up the path 
    If Not root.EndsWith("\") Then
        root += "\"
    End If

    ' make a folder to store the images in 
    Dim fileDirectory As String = root & "Images/"

    ' create the folder if it does not exist 
    If Not System.IO.Directory.Exists(fileDirectory) Then
        System.IO.Directory.CreateDirectory(fileDirectory)
    End If

    ' make a link to the new file 
    Dim link As String = "<a href='Images/{0}' target='_blank'>{1}</a>{2}{3}"

    ' loop through the file in the request 
    For i As Integer = 0 To Request.Files.Count - 1

        ' get the file instance 
        Dim fi As HttpPostedFile = Request.Files.[Get](i)

        ' create a byte array to store the file bytes 
        Dim fileBytes As Byte() = New Byte(fi.ContentLength - 1) {}

        ' fill the byte array 
        Using stream As System.IO.Stream = fi.InputStream
            stream.Read(fileBytes, 0, fi.ContentLength)
        End Using

        ' create a random file name 
        Dim fileName As String = Guid.NewGuid().ToString()

        'write the original file to the file system 
        File.WriteAllBytes(fileDirectory + fileName & ".jpg", fileBytes)
        litText.Text += String.Format(link, fileName & ".jpg", fileName & " Original", "<br/>", "")

        ' write the resized file to the file system 
        File.WriteAllBytes(fileDirectory + fileName & "_small.jpg", ResizeImageFile(fileBytes, 100))
        litText.Text += String.Format(link, fileName & "_small.jpg", fileName & " Small", "<br/>", "<br/>")

        ' cleanup 
        litText.Visible = True
        fileBytes = Nothing
    Next
End Sub
Private Shared Function ResizeImageFile(ByVal imageFile As Byte(), ByVal targetSize As Integer) As Byte()
    Using oldImage As System.Drawing.Image = System.Drawing.Image.FromStream(New MemoryStream(imageFile))
        Dim newSize As Size = CalculateDimensions(oldImage.Size, targetSize)
        Using newImage As New Bitmap(newSize.Width, newSize.Height, PixelFormat.Format24bppRgb)
            Using canvas As Graphics = Graphics.FromImage(newImage)
                canvas.SmoothingMode = SmoothingMode.AntiAlias
                canvas.InterpolationMode = InterpolationMode.HighQualityBicubic
                canvas.PixelOffsetMode = PixelOffsetMode.HighQuality
                canvas.DrawImage(oldImage, New Rectangle(New Point(0, 0), newSize))
                Dim m As New MemoryStream()
                newImage.Save(m, ImageFormat.Jpeg)
                Return m.GetBuffer()
            End Using
        End Using
    End Using
End Function
Private Shared Function CalculateDimensions(ByVal oldSize As Size, ByVal targetSize As Integer) As Size
    Dim newSize As New Size()
    If oldSize.Height > oldSize.Width Then
        newSize.Width = CInt((oldSize.Width * (CSng(targetSize) / CSng(oldSize.Height))))
        newSize.Height = targetSize
    Else
        newSize.Width = targetSize
        newSize.Height = CInt((oldSize.Height * (CSng(targetSize) / CSng(oldSize.Width))))
    End If
    Return newSize
End Function

End Class 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-14T14:44:27.767

Check if you'r using a UpdatePanel, if so then in Page.Init do something like this:

```
protected void userView_Init(object sender, EventArgs e)
{
 ScriptManager.GetCurrent(this).RegisterPostBackControl(uploadFileButton);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T17:12:48.450

原因`fileUpload.HasFiles = False`是在到达该代码时，文件流已在**HandleUploadFile 子**例程内关闭。

'这个 using 语句关闭原始输入流并从 FileUpload 中删除它

```
Using stream As System.IO.Stream = fi.InputStream            
 stream.Read(fileBytes, 0, fi.ContentLength)        
End Using 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T17:10:26.973

我认为可能是您将文件写入目录并在这样做时清除了文件上传表单。这发生在您运行 if 语句之前。尝试将 if/else 移到“handleuploadedfile()”函数上方。这应该确保您可以在系统写入文件并将其从上传表单中删除之前检查上传表单。

# c# - Max（Threading.Interlocked.Increment（Offset），Offset - 1）有什么意义？

> ID：765686
> 
> 赞同：4
> 
> 时间：2009-04-19T16:41:52.347
> 
> 标签：c#, .net, multithreading

我现在已经多次看到提到的代码，这样做有什么意义`Max(a+1, a-1)`？起初我认为这可能是为了防止下溢，但在这种情况下不防止下溢是没有意义的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-19T18:58:07.417

一些谷歌搜索让我怀疑这可能是由一些（可能有错误的）C# 到 VB.NET 转换软件引起的。这可以解释它的频繁出现。

**补充：**是的，我[找到了](http://converter.telerik.com/Default.aspx)！尝试在其中输入以下 C# 代码并转换为 VB.NET：

```
int i;
i++; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-19T18:13:35.183

正如您所提到的，他们可能会尝试检测何时`Offset`换行为零（或变为负数）并将其与任何类型的最大值挂钩`Offset`。或者他们可能正在尝试处理`Offset`在多个线程（或其他东西）中“同时”递增的情况。

无论哪种情况，这都是错误的代码。

如果他们试图检测/防止换行为零或负数，那么太多的增量无论如何都会导致问题。如果他们试图处理`Offset`“同时”递增的问题，我不确定他们真正想要解决什么问题，或者他们是如何解决的。

以下是问题：

[正如乔恩斯基特所说](https://stackoverflow.com/questions/765686/whats-the-point-in-maxthreading-interlocked-incrementoffset-offset-1/765697#765697)：

> 然而，这对我来说仍然很奇怪——因为除非 Offset 是 volatile ，否则后一个表达式可能无论如何都不会得到最新的值。

但它甚至比这更糟糕 - 即使`Offset`是 volatile 也没有什么可以序列化读取新值的`Offset`另一个线程可能会增加它，因此`Max()`表达式重新读取`Offset`任意数量其他线程的值后的那一刻可能会出现并增加它（任意次数）。所以充其量，表达式是无用的，但使用这种技术可能是有害的，因为你最终可能会使用一个`Offset`不“属于”你的值。

考虑一下您`Offset`用来跟踪数组索引或其他东西的情况（给定的名称听起来就像可能发生的事情）。当您以原子方式递增`Offset`该索引处的数组元素时，您就可以使用它了。如果您使用`Max()`问题中的表达式，您可能会突然踩到真正属于另一个线程的数组元素。

我想不出使用的正当理由

```
Max(Threading.Interlocked.Increment(Offset), Offset - 1) 
```

就像我说的，充其量它是无害的（也无用），但它可能会引入***非常***难以诊断的问题——**不要使用它**。

* * *

感谢 Simon Svensson 的评论指出谷歌搜索问题中的用法，看起来这段代码通常（总是？）来自 C# 到 VB.NET 转换器的输出。它甚至使用这个表达式来增加局部变量（所以线程不是问题）。在局部变量的情况下`Offset`，这个表达式属于无用但几乎无害的类型（如果增量换行，则会出现“错误”）。它实际上或多或少是一个非常低效的 `Offset++`表达式（实际上它似乎是转换器将 C# 表达式转换`Offset++`为 VB.NET 的方式 - 请参阅[http://www.telerik.com/community/forums/open-source-projects/代码转换器/附加值.aspx#307755](http://www.telerik.com/community/forums/open-source-projects/code-converter/added-value.aspx#307755)）。实际上这种转换是错误的`Offset++`无论如何，因为当它应该返回递增之前的值时，它会返回递增的值。

真正糟糕的是，其他人可能会看到该代码并认为“这就是我需要使用的方式`Interlocked.Increment()`”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T16:49:23.933

好吧，它与 - 不一样，`Max(a, a-1)`因为有对`Interlocked.Increment`. 假设另一个线程在对 的调用`Interlocked.Increment`和对 的评估之间更改了 Offset 的值`Offset-1`。

但是，这对我来说仍然很奇怪——因为除非`Offset`是 volatile，否则后一个表达式可能无论如何都不会获得最新值。

说了这么多，代码还不是*很全*

```
Math.Max(Interlocked.Increment(Offset), Offset-1) 
```

因为参数to`Interlocked.Increment`是一个`ref`参数。最接近的法律法规是：

```
Math.Max(Interlocked.Increment(ref Offset), Offset-1) 
```

（这仍然很奇怪，因为它意味着一个 Pascal 大小写变量......）

也许如果您可以*在上下文中*显示确切的代码，我们就可以解决问题。我不能说我自己见过这样的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T17:51:16.500

`Interlocked.Increment(a)``a`以原子方式递增 的值。在单线程应用程序中，它相当于`a++`，但速度稍慢。在多线程应用程序中，它确保当两个线程都增加值时，它们不会相互干扰。有关详细信息，请参阅[MSDN 参考页面](http://msdn.microsoft.com/en-us/library/dd78zt0c.aspx)

为什么在这种情况下使用它我不能说没有看到更多的代码。

# .net - net.pipe vs. net.tcp vs. http 绑定

> ID：765692
> 
> 赞同：61
> 
> 时间：2009-04-19T16:46:50.400
> 
> 标签：.net, wcf, wcf-binding

我是 WCF 的新手，想知道以下每个绑定的差异/优势/限制/等：

```
net.pipe
net.tcp
http 
```

支持关于何时使用每个绑定和其他示例的场景将不胜感激。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-04-19T17:14:21.160

虽然不能很好地提供特定的使用示例，但这里有一个来自 MSDN 的链接，其中列出了绑定的所有功能。

[http://msdn.microsoft.com/en-us/library/ms730879.aspx](http://msdn.microsoft.com/en-us/library/ms730879.aspx)

这是一个不错的流程图，也可以帮助在它们之间进行选择。

![流程图](https://i.stack.imgur.com/od0Ah.png)

[来源：[http ://bloggingabout.net/blogs/dennis/archive/2006/12/01/WCF-Binding-decision-chart.aspx](http://bloggingabout.net/blogs/dennis/archive/2006/12/01/WCF-Binding-decision-chart.aspx)]

这是我过去使用过的一篇很好的整体文章。

[http://mkdot.net/blogs/dejan/archive/2008/03/31/wcf-binding-decision.aspx](http://mkdot.net/blogs/dejan/archive/2008/03/31/wcf-binding-decision.aspx)（如果链接不再适合您，则在回程机器中）[。](https://web.archive.org/web/20120217184519/http://mkdot.net/blogs/dejan/archive/2008/03/31/wcf-binding-decision.aspx)

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-04-19T17:14:14.107

net.pipe，快速且安全，因为您的 Web 服务无法从网络访问（通常，您将使用 net.pipe 轻松与 Windows 服务交互）。

http，出于互操作性的原因，您将使用它，如果您的 Web 服务不是通过 HTTP，silverlight 或 flash 将无法使用它（因为浏览器会过滤非 http 数据包，就像防火墙一样）。

net.tcp 会快一点，因为你的soap 消息没有包含在HTTP 请求中，但是你不能使用RIA 技术调用你的web 服务，并且一些防火墙会丢弃你的消息。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-19T17:00:40.350

Windows Communication Foundation (WCF) 是用于构建处理 XML 消息的服务的框架。WCF 允许您使用不同的传输协议（如 HTTP、TCP 和 MSMQ）和使用不同的 XML 表示（如文本、二进制或 MTOM，在 WCF 中通常称为消息编码）来传输消息。

如果您想在一台机器上托管多个 WCF 服务并希望它们使用共享内存进行通信，请使用命名 pipe=>net.pipe，然后使用 tcp 与不同机器上的 WCF 服务进行通信。

nettcp 绑定的配置侧重于创建在 Windows 环境中性能更好的通道堆栈，为您提供替换各种 COM+ 和 .NET 远程处理投资的绝佳选择。

BasicHttpBinding 专为互操作性至关重要的场景而设计。因此，BasicHttpBinding 使用 HTTP 进行传输，使用文本进行消息编码。

# iphone - iPhone 上的 URL 和 POST

> ID：765695
> 
> 赞同：0
> 
> 时间：2009-04-19T16:48:15.433
> 
> 标签：iphone, objective-c

如何清理由字符串组成的 URL 以将空格等字符替换为 %20 等？

如何在 NSLog 中打印 NSURL？

如何使用 POST 将数据发送到网络服务器？我知道对于 HTML GET：

```
NSURL * theURL = [[NSURL alloc] initWithString:url];
NSString * results = [NSString stringWithContentsOfURL:theURL]; 
```

会做交易，但我通过用户名和密码等秘密数据发送什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T17:01:19.023

首先，多个问题应该作为多个问题提出，但无论如何我都会回答：

1.  `NSString *escapedString = [string stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];`
2.  `NSLog(@"URL is: %@, contents is: %@", myURLObject, [NSString stringWithContentsOfURL:myURLObject]);`
3.  [在这个问题](https://stackoverflow.com/questions/319463/can-i-make-post-or-get-requests-from-an-iphone-application)`POST`中已经回答了发送数据

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T17:01:44.357

在我写答案时问题发生了变化。这是在回答如何发布。

您将需要使用[NSURLConnection](http://developer.apple.com/documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T13:58:18.797

运行 POST 请求的一个更简单的框架是 Ben Copsey 的[ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest/)工具包，它包含 NSHTTPRequest 并添加了许多有用的功能。这将节省您的时间，绝对值得一试。

# javascript - jQuery.get() - 实际用途？

> ID：765698
> 
> 赞同：3
> 
> 时间：2009-04-19T16:49:39.470
> 
> 标签：javascript, jquery

我试图了解您为什么要使用[`jQuery.get()`and`jQuery.get(index)`](http://docs.jquery.com/Core/get)。文档说是将 jQuery 选择转换为原始 DOM 对象，而不是将选择作为 jQuery 对象和可用的方法。

一个简单的例子：

```
$("div").get(0).innerHTML; 
```

是相同的：

```
$("div").html(); 
```

显然这是一个不好的例子，但我很难弄清楚你什么时候会使用`.get()`. 你能帮我理解什么时候在我的代码中使用这个方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T16:59:50.010

当您想在元素上调用本机 JS 方法时，经常会发生这种情况。

```
//submitting a form...
$('#mySearchForm').get().submit(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-19T17:19:23.083

有时您在 noConflict 模式下使用 jQuery，并且您想要执行以下操作：

```
var element = jQuery('#jquery_selectors .are > .awesome[and=fast]').get(0); 
```

然后在原型中做一些事情：

```
$(element).whatever(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-19T16:53:55.063

在执行类似（伪代码）之类的操作时，这可能会派上用场：

```
a = $("div").get()
ajaxsend(a) 
```

有时您可能需要将实际的 DOM 对象传递给其他函数，这些函数可能无法处理 jQuery 对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T14:33:13.550

这对于访问任何不通过 jQuery 公开的 JavaScript 方法很有用。例如，在 jQuery 支持 offset() 之前，我通常会`get()`这样使用：

```
var offTop = $(element).get(0).offsetTop; 
```

再举一个例子，我最近用它来确定元素的滚动高度。

```
var scrollHeight = $(element).get(0).scrollHeight; 
```

这也可以写成：

```
var scrollHeight = $(element)[0].scrollHeight; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-21T01:44:01.333

Cody Lindley（jQuery 团队成员）有一个[很好的例子](http://codylindley.com/Webdev/355/jquery-get-caching-dom-nodes-in-an-array)来说明为什么要使用 get()

> 如果您需要缓存一组元素，因为您将要删除它们，jQuery get() 方法非常方便。例如，在下面的代码中，我`<li>`将页面上的所有元素保存在一个数组中，删除它们，然后使用这个数组将它们重新添加到页面中。有道理？

```
<html> 
<head> 
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script> 
</head>

<body>

<ul> 
    <li>test</li> 
    <li>test</li> 
    <li>test</li> 
    <li>test</li> 
    <li>test</li> 
    <li>test</li> 
    <li>test</li> 
    <li>test</li> 
 </ul>

<script>

var test = $('ul li').get();

$('ul').empty();

$.each(test, function(){ $('ul').append('<li>'+$(this).html() + ' new</li>'); });

</script> 
</body> 
</html> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-19T17:11:19.920

get() 的另一个可能用途是在 jQuery 中使用 XML 树时。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-26T11:56:23.830

我用它来获取单个元素的 id

```
 $(selector).get(0).id 
```

# wcf - wcf 序列化和休眠延迟加载

> ID：765699
> 
> 赞同：2
> 
> 时间：2009-04-19T16:51:05.990
> 
> 标签：wcf, nhibernate, serialization, lazy-loading

我将 .net 2.0 与 NHibernate/ActiveRecord 和 WCF 一起使用。

到目前为止我还没有使用过 NH Lazy load，但是性能损失太大而无法忽略，所以我开始使用它。

从我目前所读到的内容来看，这不是一个简单的主题，使用具有延迟加载和序列化到 WCF 的 NH 实体，但好处实在是太大了，不容忽视。

使用我在这里找到的代码：[WCF Serialization With NHibernate](http://timvasil.com/blog14/blog14/post/2008/02/WCF-serialization-with-NHibernate.aspx)，我已经能够让 WCF 识别基本类型。

我也在像这样创建 DataContractSerializer：

```
public override XmlObjectSerializer CreateSerializer(Type standard, XmlDictionaryString name, XmlDictionaryString NS, IList<Type> knownTypes)
{
    return new DataContractSerializer(standard, name, NS, knownTypes, 0x989680, false, true /* Preserve References*/, new HibernateDataContractSurrogate());
} 
```

我的问题是当我有这样的事情时：

```
[DataContract, ActiveRecord("POS_POSCUSTOMERS",Lazy = true)]
public class POSCustomer : ActiveRecordForPOS<POSCustomer>
{
    private Branch belongsToBranch;

    [DataMember,BelongsTo("BRANCH")]
    public virtual Branch BelongsToBranch
    {
        get { return belongsToBranch; }
        set { belongsToBranch = value; }
    }
} 
```

和

```
[DataContract, ActiveRecord("BRANCHES",Lazy = true)]
public class Branch : ActiveRecordForPOS<Branch>
{
    private POSCustomer defaultPOSCustomer;

    [DataMember, BelongsTo("POS_POSCUSTNUM", Cascade= CascadeEnum.None)]
    public virtual POSCustomer DefaultPOSCustomer
    {
        get { return defaultPOSCustomer; }
        set { defaultPOSCustomer = value; }
    }
} 
```

Branch.DefaultPOSCustomer 和 POSCustomer.BelongsToBranch 是两个不相关的实体，但它们是相同的实体，例如 Branch 200 具有 DefaultPOSCustomer 100，而 POSCustomer 具有 BelongsToBranch 200。

问题是，当 WCF 尝试序列化对象图时，它会在 DefaultPOSCustomer 和 BelongsToBranch 之间反弹，就好像没有识别出它们是相同的实体并且它已经序列化了它们，直到它遇到堆栈溢出。

如果我在这些类上关闭 Lazy = true，则序列化工作得很好。

1.  DataContractSerializer 如何判断一个实体已经被序列化了？
2.  我怎样才能阻止这种行为？
3.  是否有其他方法可以使用 WCF 序列化延迟加载实体？

ps 我一直在考虑另一种解决方案，创建类似于 NHibernate Proxy 的东西，但是用原始键替换与其他类相关的属性，所以我没有一个 Branch 类型的属性，而是一个类型的属性int 的值为 200。这样我也许可以避免我遇到的循环问题，但我会尝试将此作为最后的手段，因为维护起来会非常复杂。

编辑：我有很多实体，所以为每个实体创建一个 dto 是不可能的，动态创建它会很复杂，所以我宁愿避免这种情况或将其用作最后的手段。我还需要在服务器端做业务逻辑，所以我需要实体而不是原始数据。

编辑：好吧，直接 NH/AR/WCF 的方式不走运。我将继续创建似乎更容易的 DTO。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-13T11:18:23.657

我只是注意到我没有结束我的问题，我使用了 DTO 解决方案，到目前为止它工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-10T20:00:44.600

现在回答为时已晚 ;-) 但无论如何，这是因为延迟加载的对象是 NH 代理类；并且似乎在像这样加载时它们是不同的。一种解决方案是覆盖 .Equals() 以比较持久实体的 Id 属性。我猜你的实体有主键之类的东西。这可能会让 WCF 高兴，只有当它使用相等而不是引用比较时。如果 WCF 总是使用 ReferenceEquals - 不走运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-18T21:37:31.107

我们一直在使用[这个](https://stackoverflow.com/questions/2664245/identifying-nhibernate-proxy-classes)解决方案，并且发现它比 DTO 解决方案更容易/更好。

# c# - 什么时候应该使用 `out` 参数而不是返回复杂类型？

> ID：765703
> 
> 赞同：6
> 
> 时间：2009-04-19T16:53:12.473
> 
> 标签：c#, .net

`out`我们什么时候应该在 C# 中使用参数？

例如

```
bool TryGetValue(out object value); 
```

对比

```
class ReturnType
{
      public bool Found {get;set;}
      public object Value {get;set;}
}

ReturnType TryGetValue(); 
```

除了减少代码行数，什么时候应该使用`out`参数，什么时候应该作为返回类型返回？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T17:00:16.747

Out 也可用于可能失败的操作（通常在以 Try* 开头的方法中找到）。

例如 TryParse 将返回一个 bool 指示成功/失败，同时使用 out 值作为结果。这避免了必须抛出异常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T16:55:45.290

您已经明确了应该使用它的原因。降低代码复杂度。

```
if (TryGetValue(myObj))
{
    [...]
} 
```

比整洁

```
Result tryGetValueResult = TryGetValue();
if (tryGetValueResult.Found)
{
    [...]
} 
```

当结果需要是引用类型时，它还可以节省垃圾。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-19T16:59:13.257

如果没有一般理由将多个值封装在一起，除了这个调用，那么创建一个单独的类型可能是最重要的。

另一方面，如果你有多个输出参数和一个逻辑上属于一起的返回值（例如名字、姓氏、电话号码），那么创建一个适当的类型（例如“联系人”）并返回可能是有意义的那。

*如果所讨论的值是*值类型，则该选项的一种替代方法`TryGetValue`是使用可为空的值类型。例如， int.TryParse 可能具有以下签名：

 *```
int? TryParse(string text) 
```

（当然有过载`IFormatProvider`）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-19T16:59:49.633

它们在您需要从构造函数返回值的（罕见）情况下很有用。例如，**Mutex**构造函数有一个布尔输出参数，该参数设置为指示是否创建了新的 Mutex，或者是否已存在具有名称的现有互斥体。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-19T17:31:27.593

out 关键字通过编译器强制执行几件事。
**调用者不必初始化参数。被调用者无法从参数中读取，但必须在退出方法之前对其进行写入。**

out 更重要**的是使意图可见**，因为调用者在进行方法调用时必须指定 out 关键字

当您**需要从一个方法返回多个值**时，您可以使用 out （无需从对象 [] 中填充和去填充它们）。（喜欢从每个函数返回 bSuccess 的部分会喜欢 out 关键字。）
在您发布的示例中.. TryParse 的主要返回值是解析操作的成功。这就是它的返回值——但最可能的后续需求是如果成功则获取已解析的对象。因此，TryParse 不是让所有调用者都执行该步骤，而是通过将其作为输出参数来为您省去麻烦。因为它已经作为 CanParse 检查的一部分完成了该操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-19T17:34:46.167

输出参数通常偏脆。超越示例，从总体上看问题：Bill Wagner 的书“更有效的 C#”描述了一个非常聪明的方法，它也在[此处](http://visualstudiomagazine.com/columns/article.aspx?editorialsid=2069)进行了详细描述。

以下代码将在这种情况下工作。

```
public class Tuple<T1,T2>
{
  public T1 First {get;private set;}
  public T2 Second {get; private set;}
  Tuple(T1 first, T2 second)
  {
    First = first;
    Second = second;
  }
}

using ComplexPair = Tuple<bool,object>;

public class SomeOtherClass 
{
  public ComplexPair GetComplexType ()
  {
    ...
    return new ComplexPair(true, new object);

  }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-15T23:22:39.973

最好使用类似 Option 类型的东西作为可能不存在的返回类型的容器。这些在 Scala 等大多数函数式语言中都很普遍。对于您只关心某事是成功还是失败而不关心为什么的情况很有用。例如解析整数。

```
int num;  // mutable = bugprone
if (!int.TryParse(str, out num)) // branching = complexity
  num = someDefault; 
```

使用 Option 类型，您可以定义一个 int 解析器，它封装了可变的丑陋并返回一个干净的 Option。如果仅在一个地方使用，这会降低您的复杂性。避免重复和变异。

```
 public Option<int> IntParse(string str) {
    int num;  // mutable
    if (!int.TryParse(str, out num))
      return Option.None<int>();
    else
      return Option.Some<int>(num);
  } 
```

其他地方的用法：

```
int result = IntParse(someString).GetOrElse(defaultValue); 
```

正如您所看到的，这导致使用模式的复杂性大大降低，因为分支已被隐藏。

或者，如果您的函数必须返回两件事，则有可能：

*   功能太复杂，应该拆分（做好一件事！），或者
*   返回值密切相关，应该以新的类型绑定在一起

要考虑的东西！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-19T16:54:20.130

如果对象可以为空。那就不用实例化了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-19T17:01:50.847

我会投票支持使用返回类型。尽管 C# 不是函数式语言，但我认为以函数式编程风格为目标是件好事。不是为了学术纯粹，而是为了实用利益，其中每个函数的行为都是非神秘的，没有副作用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-19T17:09:11.127

如果您希望您的函数只返回对现有对象的引用或创建一个新对象，那么应该只使用 out 参数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-19T18:50:32.753

在我的观点中，两者都是正确的，但是我发现返回一个复杂类型更优雅，特别是如果它是一个泛型类型

```
ReturnType<T> 
```

这提供了有关预期值的更多信息，因此您无需猜测 Value 原始类型并进行强制转换。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2009-04-19T17:22:08.067

我喜欢为成功指标保留返回值。简单的 true/false 表示成功，或者更复杂的值，如 0 表示成功，其他值表示错误是什么。

这意味着程序员可以测试您编写的每个函数是否成功。（当然，不是所有人都会，但*可以*）

然后，这需要*out*参数来从函数中检索值。

# c++ - 为什么将有符号值分配给无符号整数时编译器不给出错误？- C++

> ID：765709
> 
> 赞同：20
> 
> 时间：2009-04-19T16:57:23.900
> 
> 标签：c++, variables, compiler-errors, compiler-warnings, unsigned

我知道*unsigned int*不能保存负值。但是以下代码编译时没有任何错误/警告。

```
unsigned int a = -10; 
```

当我打印变量*a*时，我打印了一个错误的值。如果无符号变量不能保存有符号值，为什么编译器允许它们编译而不给出任何错误/警告？

有什么想法吗？

**编辑**

编译器：VC++编译器

**解决方案**

需要使用警告级别 4。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-19T17:02:14.323

### 微软视觉 C++：

> 警告 C4245：“正在初始化”：从“int”转换为“unsigned int”，有符号/无符号不匹配

处于警告级别 4。

### G++

给我警告：

> 警告：负值 `-0x00000000a' to` unsigned int' 的转换

没有任何 -W 指令。

### 海合会

您必须使用：

> gcc main.c -Wconversion

这将给出警告：

> 警告：负整数隐式转换为无符号类型

请注意， -Wall 不会启用此警告。

* * *

也许您只需要提高警告级别。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-19T17:48:47.800

将 a 转换`signed int`为 an`unsigned int`在 C 标准中称为“通常的算术转换”，因此这不是错误。

编译器默认情况下通常不会对此发出警告的原因是因为它在代码中很常见，通常会发出太多的“误报”警告。有很多代码可以使用`signed int`值来处理本质上无符号的事物（例如计算缓冲区大小）。在表达式中混合有符号和无符号值也很常见。

这并不是说这些静默转换不对错误负责。因此，为新代码启用警告可能不是一个坏主意，因此它从一开始就“干净”。但是，我认为您可能会发现处理现有代码发出的警告相当困难。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T17:10:32.090

-10 被解析为整数值，并且允许将 int 分配给 unsigned int。要知道您做错了什么，编译器必须检查您的整数 (-10) 是负数还是正数。由于它不仅仅是类型检查，我猜它已因性能问题而被禁用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-06T19:20:27.863

我正在使用 g++ 4.9.2，需要使用 -Wsign-conversion 来显示此警告。

> [gcc.gnu.org](https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html): Warnings about conversions between signed and unsigned integers are disabled by default in C++ unless -Wsign-conversion is explicitly enabled.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T17:00:37.620

对于 gcc 编译器，您可以添加

```
gcc -Wconversion ... 
```

这将产生以下警告

```
warning: converting negative value '-0x0000000000000000a' to 'unsigned int' 
```

# python - 如何使用 PIL 使所有白色像素透明？

> ID：765736
> 
> 赞同：86
> 
> 时间：2009-04-19T17:13:27.853
> 
> 标签：python, image, python-imaging-library

我正在尝试使用 Python 图像库使所有白色像素透明。（我是一个试图学习 python 的 C 黑客，所以要温柔）我已经进行了转换（至少像素值看起来正确）但我不知道如何将列表转换为缓冲区以重新创建图片。这是代码

```
img = Image.open('img.png')
imga = img.convert("RGBA")
datas = imga.getdata()

newData = list()
for item in datas:
    if item[0] == 255 and item[1] == 255 and item[2] == 255:
        newData.append([255, 255, 255, 0])
    else:
        newData.append(item)

imgb = Image.frombuffer("RGBA", imga.size, newData, "raw", "RGBA", 0, 1)
imgb.save("img2.png", "PNG") 
```

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-04-19T17:38:26.280

您需要进行以下更改：

*   追加一个元组`(255, 255, 255, 0)`而不是一个列表`[255, 255, 255, 0]`
*   采用`img.putdata(newData)`

这是工作代码：

```
from PIL import Image

img = Image.open('img.png')
img = img.convert("RGBA")
datas = img.getdata()

newData = []
for item in datas:
    if item[0] == 255 and item[1] == 255 and item[2] == 255:
        newData.append((255, 255, 255, 0))
    else:
        newData.append(item)

img.putdata(newData)
img.save("img2.png", "PNG") 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-04-19T18:17:14.207

您还可以使用像素访问模式就地修改图像：

```
from PIL import Image

img = Image.open('img.png')
img = img.convert("RGBA")

pixdata = img.load()

width, height = img.size
for y in range(height):
    for x in range(width):
        if pixdata[x, y] == (255, 255, 255, 255):
            pixdata[x, y] = (255, 255, 255, 0)

img.save("img2.png", "PNG") 
```

如果您经常使用它，您也可以将上述内容包装到一个脚本中。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2019-01-11T14:24:35.080

由于这是目前在寻找“枕头白色到透明”时的第一个谷歌结果，我想补充一点，用 numpy 可以实现同样的效果，并且在我的基准测试中（一个带有大量白色背景的 8MP 图像）大约快 10 倍（对于建议的解决方案，大约 300 毫秒与 3.28 秒）。代码也短一点：

```
import numpy as np

def white_to_transparency(img):
    x = np.asarray(img.convert('RGBA')).copy()

    x[:, :, 3] = (255 * (x[:, :, :3] != 255).any(axis=2)).astype(np.uint8)

    return Image.fromarray(x) 
```

它也很容易转换为“几乎是白色”（例如，一个通道是 254 而不是 255）是“几乎透明”的版本。当然这会使整个画面部分透明，除了纯黑色：

```
def white_to_transparency_gradient(img):
    x = np.asarray(img.convert('RGBA')).copy()

    x[:, :, 3] = (255 - x[:, :, :3].mean(axis=2)).astype(np.uint8)

    return Image.fromarray(x) 
```

备注：`.copy()`是必需的，因为默认情况下枕头图像被转换为​​只读数组。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-12-25T19:34:34.070

```
import Image
import ImageMath

def distance2(a, b):
    return (a[0] - b[0]) * (a[0] - b[0]) + (a[1] - b[1]) * (a[1] - b[1]) + (a[2] - b[2]) * (a[2] - b[2])

def makeColorTransparent(image, color, thresh2=0):
    image = image.convert("RGBA")
    red, green, blue, alpha = image.split()
    image.putalpha(ImageMath.eval("""convert(((((t - d(c, (r, g, b))) >> 31) + 1) ^ 1) * a, 'L')""",
        t=thresh2, d=distance2, c=color, r=red, g=green, b=blue, a=alpha))
    return image

if __name__ == '__main__':
    import sys
    makeColorTransparent(Image.open(sys.argv[1]), (255, 255, 255)).save(sys.argv[2]); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-09-15T10:32:01.190

一种更 Pythonic 的方式，因为循环需要很长时间才能获得大图像

```
from PIL import Image

img = Image.open('img.png')
img = img.convert("RGBA")

imgnp = np.array(img)

white = np.sum(imgnp[:,:,:3], axis=2)
white_mask = np.where(white == 255*3, 1, 0)

alpha = np.where(white_mask, 0, imgnp[:,:,-1])

imgnp[:,:,-1] = alpha 

img = Image.fromarray(np.uint8(imgnp))
img.save("img2.png", "PNG") 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-11-29T06:36:24.510

Python 3 版本，所有文件都在一个目录中

```
import glob
from PIL import Image

def transparent(myimage):
    img = Image.open(myimage)
    img = img.convert("RGBA")

    pixdata = img.load()

    width, height = img.size
    for y in range(height):
        for x in range(width):
            if pixdata[x, y] == (255, 255, 255, 255):
                pixdata[x, y] = (255, 255, 255, 0)

    img.save(myimage, "PNG")

for image in glob.glob("*.png"):
    transparent(image) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-01-23T10:24:38.007

我很惊讶没有人看到不仅需要更改特定颜色，还需要更改该颜色与其他颜色的混合。这就是 Gimp 对“颜色到 alpha”的功能所做的。[使用https://stackoverflow.com/a/62334218/5189462](https://stackoverflow.com/a/62334218/5189462)扩展 cr333 的代码，我们得到类似于此功能的东西：

```
from PIL import Image

target_color = (255, 255, 255)

img   = Image.open('img.png')
imga  = img.convert("RGBA")
datas = imga.getdata()

newData = list()
for item in datas:
    newData.append((
        item[0], item[1], item[2],
        max( 
            abs(item[0] - target_color[0]), 
            abs(item[1] - target_color[1]), 
            abs(item[2] - target_color[2]), 
        )  
    ))

imgb = Image.frombuffer("RGBA", imga.size, newData, "raw", "RGBA", 0, 1)
imgb.save("img2.png", "PNG") 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-11-08T10:17:25.213

@egeres 使用与目标颜色的距离来创建 alpha 值的方法非常简洁，并且可以创建更好的结果。这里使用 numpy：

```
import numpy as np
import matplotlib.pyplot as plt

def color_to_alpha(im, target_color):
    alpha = np.max(
        [
            np.abs(im[..., 0] - target_color[0]),
            np.abs(im[..., 1] - target_color[1]),
            np.abs(im[..., 2] - target_color[2]),
        ],
        axis=0,
    )
    ny, nx, _ = im.shape
    im_rgba = np.zeros((ny, nx, 4), dtype=im.dtype)
    for i in range(3):
        im_rgba[..., i] = im[..., i]
    im_rgba[..., 3] = alpha
    return im_rgba

target_color = (0.0, 0.0, 0.0)
im = plt.imread("img.png")
im_rgba = color_to_alpha(im, target_color) 
```

为了完整起见，我在下面与应用于 matplotlib 徽标的基于掩码的版本进行了比较：

```
from pathlib import Path
import matplotlib.pyplot as pl
import numpy as np

def color_to_alpha(im, alpha_color):
    alpha = np.max(
        [
            np.abs(im[..., 0] - alpha_color[0]),
            np.abs(im[..., 1] - alpha_color[1]),
            np.abs(im[..., 2] - alpha_color[2]),
        ],
        axis=0,
    )
    ny, nx, _ = im.shape
    im_rgba = np.zeros((ny, nx, 4), dtype=im.dtype)
    for i in range(3):
        im_rgba[..., i] = im[..., i]
    im_rgba[..., 3] = alpha
    return im_rgba

def color_to_alpha_mask(im, alpha_color):
    mask = (im[..., :3] == alpha_color).all(axis=2)
    alpha = np.where(mask, 0, 255)
    ny, nx, _ = im.shape
    im_rgba = np.zeros((ny, nx, 4), dtype=im.dtype)
    im_rgba[..., :3] = im
    im_rgba[..., -1] = alpha
    return im_rgba

# load example from images included with matplotlib
fn_img = Path(plt.__file__).parent / "mpl-data" / "images" / "matplotlib_large.png"
im = plt.imread(fn_img)[..., :3]  # get rid of alpha channel already in image

target_color = [1.0, 1.0, 1.0]
im_rgba = color_to_alpha(im, target_color)
im_rgba_masked = color_to_alpha_mask(im, target_color)

fig, axes = plt.subplots(ncols=3, figsize=(12, 4))
[ax.set_facecolor("lightblue") for ax in axes]
axes[0].imshow(im)
axes[0].set_title("original")
axes[1].imshow(im_rgba)
axes[1].set_title("using distance to color")
axes[2].imshow(im_rgba_masked)
axes[2].set_title("mask on color") 
```

[![不同颜色到阿尔法技术的比较](https://i.stack.imgur.com/ufuaL.png)](https://i.stack.imgur.com/ufuaL.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-11-02T17:30:08.410

此功能结合了之前解决方案的所有优点：它允许任何背景并使用 numpy（比经典列表更快）。

```
import numpy as np
from PIL import Image

def convert_png_transparent(src_file, dst_file, bg_color=(255,255,255)):
    image = Image.open(src_file).convert("RGBA")
    array = np.array(image, dtype=np.ubyte)
    mask = (array[:,:,:3] == bg_color).all(axis=2)
    alpha = np.where(mask, 0, 255)
    array[:,:,-1] = alpha
    Image.fromarray(np.ubyte(array)).save(dst_file, "PNG") 
```

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2021-04-29T04:46:12.993

如果您打开它，请在模式中使用 RGBA img = img.convert("RGBA") 或 IMG = Image.new(mode="RGB", size=(width,high)) 以便您可以将 alpha 添加到图像 IMG.putpixel ((Y_Axis, X_Axis),(R, G, B))

# iphone - iPhone 相机图片旋转出现 - CGAffineTransformInvert：奇异矩阵

> ID：765737
> 
> 赞同：0
> 
> 时间：2009-04-19T17:13:40.257
> 
> 标签：iphone, objective-c, cocoa-touch, uiimage

我从图像选择器中获取 UIImage 并将其放入 UIImageView 中。它适用于常规图像，但对于使用 iphone 相机拍摄的图像，它们有时会旋转 90 度。

稍后访问其中一张图像时（它已保存到磁盘），我注意到上述错误。

有任何想法吗？我认为这与 iphone 在拍摄照片时存储有关相机位置的额外 exif 元数据有关，但是其中一张照片是在纵向模式下拍摄的，并且以某种方式旋转到横向。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T18:17:01.803

我使用的解决方案是按照`imageOrientation`属性的要求旋转和翻转图像。这里有一些代码可以解决问题：[UIImage fix](http://blog.logichigh.com/2008/06/05/uiimage-fix/)。

UIImageView 会自动旋转和翻转，因此如果您只是将其显示在屏幕上，这不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T23:14:57.953

您是对的，手机将旋转元数据与图像一起存储，以指示应以哪种方式旋转以进行显示。这可能是一个 EXIF 标签；它可能是完全不同的东西，Apple 告诉你的都是 UIImage 的形式。

UIImage 在很多方面都是 CGImage 的简单包装。在这种情况下，CGImage 图像是一个“愚蠢”的对象，它只知道/关心原始图像数据；没有像轮换信息那样高级别的东西。UIImage 将其与旋转和其他信息结合在一起，成为一个方便的类。好处之一是 UIImage 自动知道如何使用正确的旋转来绘制自己。

所以黄金基本上可以避免在大多数应用程序中**与 CGImage 交互。**UIImage 应该做你想做的几乎所有事情，并处理更高级别的旋转信息等。否则，您会遇到大多数图像正确绘制但有些旋转的奇怪情况。

# excel - 加在一起 - vba

> ID：765741
> 
> 赞同：0
> 
> 时间：2009-04-19T17:14:24.920
> 
> 标签：excel, vba

如果可能的话，我希望提供可以执行以下操作的代码……</p>

B 列有 10 种不同的内容变体，它们总是 10 个字符长，从单元格 B2 开始。

我想将 B 列中内容的 10 种不同变体变成从 C 列开始的第 1 行的标题。

接下来我希望宏从 A2 开始查看 A 列中的内容。然后我想使用 B2 中的内容来区分 A2 中的内容属于哪个标题（分别在同一行中）。现在，我不想将 A2 的实际内容放在标题下，而是将数字 1。

现在我想为 A:B 列中的每一行继续这种模式。

当出现重复时，我想删除重复出现的行并将原始出现增加 1。

我意识到我可以使用数据透视表，但我想尝试使用宏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T10:18:05.947

第一部分很简单，下面的代码应该可以满足您的需求，只需将其放入标准代码模块中即可：

```
私有子转置标题（）

    '//使用内置过滤功能从B列获取所有唯一条目并粘贴到C1
    Range("B:B").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Range("C1"),unique:=True

    '//复制这个过滤后的列表
    范围（“C2：C11”）。复制

    '//粘贴到第1行，使用转置将行变为列
    Range("C1").PasteSpecial Paste:=xlPasteAll, Transpose:=True

    '//删除临时过滤列表
    范围（“C2：C11”）。清除内容

    '//移除复制边界框
    Application.CutCopyMode = False
结束子
```

请注意，这使用硬编码范围，您可以使用命名/[动态范围](http://support.microsoft.com/kb/830287)使其更加健壮。

但是，恐怕您问题的第二部分有太多未知数，无法尝试提供一些有用的代码，我什至不确定我是否完全了解您要做什么。

正如 Ankur 建议的那样，自己来一场狂欢，然后返回您正在努力解决的任何细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T17:27:23.280

你知道如何使用循环吗？我的猜测是肯定的，因为你在一个编程网站上。

我记得当我在做一些 VBA 工作时，我看到大多数 Excel VBA 教程都使用 Range(a:b)，而这对于循环使用并不优雅。

您可以改为使用 cells(x,y) 访问单个单元格，它允许您指定 x 和 y 坐标，因此 A1 变为 1:1 而 A10 为 10:1 等。

这应该可以帮助您入门。从那里你需要从逻辑上思考并用谷歌搜索你不知道的东西，即在谷歌搜索“Excel VBA 范围重复项”，这将为你提供在一个范围内查找重复项的想法。

您所要求的大部分内容都需要简单的逻辑或一些谷歌搜索。如果您卡在特定点上，请尝试自己做，然后您可以发布这些特定问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-05T03:00:03.240

我想我明白。

如果数据看起来像这样

```
BRAND   ITEM
Bic     Eraser
Bic     Pencil
Bic     Pencil
Pentel  Marker
Sharpie Marker
Sharpie Marker 
```

最终的结果应该是这样的？

```
BRAND   ITEM    Marker  Eraser  Pencil
Bic     Eraser          1
Bic     Pencil                  2
Pentel  Marker  1
Sharpie Marker  2 
```

如果是这样，那么我建议您按“品牌”（key1）和“项目”（key2）排序。这样，重复项将彼此相邻。如果您制作一个将“品牌”和“项目”组合在一起的键，然后使用该键进行排序、比较和计数，这可能会更容易。

当我可能不得不删除行时，我通常喜欢先从最后一行开始。这样，我可以使用一个不错的 for 循环。嗯？试试看。

# visual-studio-2008 - 无法在从 C# 调用的 C++/CLI 使用的 C DLL 中设置断点

> ID：765745
> 
> 赞同：3
> 
> 时间：2009-04-19T17:16:57.907
> 
> 标签：visual-studio-2008, c++-cli, debugging

我有一个由 C++/CLI 对象调用的本机 C DLL，该对象是 C# 中 WPF 程序的 ViewModel。我想在 C DLL 中设置断点。当我尝试设置它们时，它们是灰色的，并且帮助气球说*断点当前不会被命中。没有为此文档加载任何符号。*

为了让程序正常运行，我必须添加一个自定义构建步骤，它将 DLL、PDB、ILK 和 LIB 文件复制到 C# 主程序的中间目录。我怀疑这与问题有关。

当我查看加载的模块列表（调试 - Windows - 模块）时，在我知道 DLL 已加载并执行其中的一些函数之后，我看不到 DLL。我看到了 C# 主程序和调用 C DLL 的 C++/CLI 模块。

所有这些项目都在同一个解决方案中 - 我是否需要运行解决方案的单独实例才能调试 DLL？理想情况下，我希望能够调试本机 DLL 以及调用 GUI 代码。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-19T17:26:14.907

由于您在托管代码中的入口点，您需要设置以下选项：在 Visual Studio-> 入口项目-> 属性-> 调试-> **启用非托管代码调试**<- 选中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-06-08T16:57:58.230

现在，12 年后@Scott Weinstein 的本质他的回答仍然有效。至少在 Visual Studio 2019 中，只有一些东西被重命名了。

为了帮助您，比我自己更快，这里是您正在寻找的设置：

`Visual Studio 2019`-> `Solution Explorer`-> `your start-up project`-> `properties`-> `Debug`-> 检查`Enable native code debugging`

# vba - 以编程方式从 PowerPoint 中读取格式化文本

> ID：765747
> 
> 赞同：1
> 
> 时间：2009-04-19T17:17:58.310
> 
> 标签：vba, powerpoint

我使用这样的东西从 PowerPoint 中的形状中获取文本：

```
s = ActiveWindow.Selection.SlideRange.Shapes("rec1").TextFrame.TextRange.Text 
```

但是，如果文本在形状内包含粗体、下划线、调整大小（等）文本（仅表示形状内的某些单词或短语），则该`.Text`属性会将其全部转换为纯文本。

我正在寻找形状的程式化标记（也许是 RTF）。

我看到如果我复制文本（*突出显示，右键单击，然后选择 COPY*），然后将其*粘贴*到写字板中，它会保留所有内容。但是，我没有看到可以以编程方式访问的`.RTFText`属性（*或任何类似*的东西） 。`TextRange`

有谁知道如何以编程方式执行此操作（我想是通过 VBA）？

谢谢 -

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T17:25:51.523

我认为唯一受支持的方法是自动化剪贴板访问：执行 VBA 复制并自己从剪贴板获取文本。不优雅，并且对用户有明显的副作用，但是......

# java - 什么是“驱动类”？

> ID：765751
> 
> 赞同：23
> 
> 时间：2009-04-19T17:24:22.617
> 
> 标签：java, oop

我正在阅读一本 Java 教科书，它提到了一个叫做“驱动程序类”的东西。它是什么，它与普通课程有何不同？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-04-19T17:27:52.220

“驱动程序类”通常只是包含主程序的类。在实际项目中，您可能经常有许多“驱动程序类”用于测试等，或者您可以在任何对象中构建一个主程序并通过您的 IDE 选择可运行的类，或者只需指定“java 类名”。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-19T17:27:57.040

没有上下文，很难说。也许是在谈论 JDBC 驱动程序？如果是这样，驱动程序类负责为特定数据库实现[java.sql.Driver](http://java.sun.com/javase/6/docs/api/java/sql/Driver.html)接口，以便客户端可以以与 db 无关的方式编写代码。JDBC 基础结构根据连接字符串确定要使用的驱动程序。

如果这本书不是在讨论 JDBC，我们将需要更多的上下文。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-09-24T15:00:47.027

根据我的 Java 书：

> 驱动程序类是负责运行其他类的类。正如计算机术语“软件驱动程序”指的是运行或驱动其他东西的软件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-05-21T19:20:33.450

“驱动程序类”可以指一种过程编程风格，包括：（1）“容器类”和（2）“驱动程序类”

假设您正在创建自己的对象作为数据容器。然后您可能想要创建两种类型的类：“容器”和“驱动程序”

“容器类”可能包含： - 保存相关数据的实例变量 - getter 和 setter - 支持将数据移入/移出类（解析、翻译）的方法 - 有限的计算

“驱动程序类”可能包含： - 驱动整个任务执行的主要方法（也称为执行入口点） - 调用静态方法，如过程编程 - 保存不同数据的容器类对象的实例（可以组织在其他数据结构中，例如数组；被操纵以解决整体任务）

# .net - COM 接口问题 - .NET

> ID：765768
> 
> 赞同：2
> 
> 时间：2009-04-19T17:33:01.910
> 
> 标签：.net, com, interop, tlbimp, tlbexp

最近我正在阅读有关互操作编组的内容，但我仍然不明白一件事。为了使 .NET 程序集对 COM 可见，我需要使用 tlbexp 工具和/或 regasm 工具。为了使 COM 对 .NET 组件可见，我必须使用 tlbimp 工具——这一切对我来说都很清楚。

1.  除此之外，我在互联网上看到了很多处理具有 guid 属性、IUnknown 和 IDispach 的 COM 接口的代码。

我的问题是所有这些与 COM 有什么关系——我需要使用它吗？我正在准备认证，但他们没有说任何关于接口、指南、IUnknown 等的信息……

我真的不喜欢留下不清楚的东西，所以如果有人可以向我解释一下，我将非常感激。

2.  我还有一个关于从 COM（tlbimp 工具）导入的类型库的问题。从 COM 导入的类型库是否还需要在系统中注册 COM 对象？

亲切的问候PK

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T18:14:42.123

我不知道为什么有人反对这个问题。对我来说，这似乎是一个完全正确的问题；也许他们今天早上还没有喝咖啡。

您似乎在问 GUID、IUnknown 和 IDispatch 与 COM 有什么关系。我将尝试做一个简短的调查。

每个 COM 组件都公开一个公共接口 IUnknown。IUnknown 有 AddRef()、Release() 和 QueryInterface() 方法。AddRef() 和 Release() 用于支持引用计数，因此当对对象的每个引用都被释放时，该对象将被销毁。QueryInterface() 有点像 COM 版本的 C++ 中的 dynamic_cast<> 运算符。客户端代码使用它来查看他们拥有的 IUnknow 指针是否实际上指向另一个类型的对象，例如 IDog、ICat 或其他类型的对象。

所以每个 COM 组件都必须实现 IUnknown，但大多数 COM 库会自动为您实现这一点，因此当您编写 COM 代码时，您通常不必编写任何代码来获取 IUnknown；你免费得到它。

GUID 有点像指纹。就像现实生活中两个人可以有完全相同的名字一样，在 COM 中两个 COM 组件也可以有相同的名字。例如，您可以有 2 个库都实现了 IDog 接口，但它们可能会做完全不同的事情。但是，您仍然应该能够在您的机器上安装这两个库，并且区分这两者是 GUID 的用途。GUID 是全球唯一标识符，这意味着当您生成一个时，理论上地球上任何其他时间点上的其他人都无法创建相同的 GUID。因此，除了名称之外，每个 COM 对象（以及 coclass 和库等）都有一个 GUID。

IDispatch 是另一个类似于 IUnknown 的基本接口，但与每个 COM 对象都需要的 IUnknown 不同，IDispatch 是可选的，并提供许多但不是所有 COM 对象都支持的特殊功能。诸如支持某些语言功能并使您的对象更易于客户使用之类的事情。大多数（可能）COM 对象都暴露了这个接口。

关于 COM 库；是的，它们必须在 Windows 中注册。

# xml - 是基于 xml 字符串还是基于 URI 的命名空间检查？

> ID：765769
> 
> 赞同：3
> 
> 时间：2009-04-19T17:33:55.730
> 
> 标签：xml, namespaces

我一直想知道 XML 解析器如何处理对 URI 命名空间的检查。它是基于字符串还是基于 URI？换句话说，这是 SVG 的标准 URI

```
xmlns="http://www.w3.org/2000/svg" 
```

假设我改写

```
xmlns="http://www.w3.org/2000/../2000/svg" 
```

或者

```
xmlns="http://www.w3.org/2000/svg/" 
```

甚至

```
xmlns="http://www.w3.org:8000/2000/svg" 
```

这些情况会被识别为 svg 命名空间（基于 URI）还是不被识别（基于字符串）？

谢谢

**编辑**：您可以使用 URN（如 uuid）这一事实让我觉得它是基于字符串的，因为您无法将正确的 URL/URI 考虑因素应用于非类似 URL 的 URI。但也许在那种情况下它只会作为一个字符串工作？

**编辑**：正如 Tormod 指出的那样，它是通过字符串比较进行的。这让我想知道是否有定义 URI 的建议（例如：末尾没有斜线，全部小写等......）。或者它只是一个免费的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T17:40:39.647

它们是基于字符串的。您的所有示例 URI 都解析为不同的命名空间。

[http://www.w3.org/TR/REC-xml-names/#NSNameComparison](http://www.w3.org/TR/REC-xml-names/#NSNameComparison)

> 在确定名称是否属于给定名称空间以及两个名称是否属于同一名称空间时，会比较标识名称空间的 URI 引用。【定义：两个URI被视为字符串，当且仅当字符串相同，即它们是相同的字符序列时，它们才是相同的。] 比较区分大小写，没有完成或撤消 % 转义。

# python - 在 Python 中测试对时间敏感的应用程序

> ID：765773
> 
> 赞同：3
> 
> 时间：2009-04-19T17:36:55.160
> 
> 标签：python, django, unit-testing, datetime

我在 Django 中编写了一个拍卖系统。我想编写单元测试，但应用程序对时间敏感（例如，向广告商收取的费用取决于他们的广告在网站上的活动时间）。测试此类应用程序的好方法是什么？

这是一个可能的解决方案：一个[DateFactory 类](http://www.artima.com/weblogs/viewpost.jsp?thread=251755)，它提供了一些方法来生成测试中的可预测日期和生产中的实时值。您对这种方法有什么想法，或者您在实践中尝试过其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T21:19:09.650

In the link you provided, the author somewhat rejects the idea of adding additional parameters to your methods for the sake of unit testing, but in some cases I think you can justify this as just an extension of your business logic. In my opinion, it's a form of inversion of control that can make your model more flexible and possibly even more expressive. For example:

```
def is_expired(self, check_date=None):
    _check_date = check_date or datetime.utcnow()
    return self.create_date + timedelta(days=15) < _check_date 
```

Essentially this allows my unit test to supply its own date/time for the purpose of validating my logic.

The argument in the referenced blog seems to be that this mucks up the API. However, I have encountered situations in which *production* use cases called for supplanting current date/time with an alternate value. In other words, the inversion of control approach eventually became a necessary part of my application.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T21:46:51.710

一般来说，我尝试让生产代码将日期对象作为输入（在语义允许的情况下）。在许多测试情况下，您所描述的 DateFactory 是人们所做的。

在 Python 中，您还可以直接更改静态模块方法 Datetime.now 或 Time.now。您需要小心在测试的拆卸部分替换它们。当您无法（或很难）更改您正在测试的课程时，这特别有用。

要做到这一点，你有

```
 def setUp(self) 
      self.oldNow = Datetime.now
      Datetime.now = self._fakenow
      ...

   def tearDown(self)
      Datetime.now = self.oldNow 
```

如果设置方法有任何失败的可能性，我会最后进行替换。

在许多情况下，自定义 DateFactory 使用起来更安全，特别是如果您不得不担心人们忘记了 tearDown 部分。

# c++ - 为什么 tm_sec 在 time.h 中的范围是 0-60 而不是 0-59？

> ID：765778
> 
> 赞同：26
> 
> 时间：2009-04-19T17:41:28.893
> 
> 标签：c++, c, time

我`time.h`的定义如下`tm`：

```
struct tm {
    int tm_sec;     /* seconds after the minute [0-60] */
    int tm_min;     /* minutes after the hour [0-59] */
    int tm_hour;    /* hours since midnight [0-23] */
    ...
} 
```

我只是注意到他们记录`tm_sec`的范围在**0-60**之间。我一直认为它的范围是 0-59，就像`tm_min`. 我当然从未见过时钟显示为 10:37:60...

你认为这只是这个 90 年代伯克利起源文件遗留下来的文档错误吗？

**还是有一些我不知道的更微妙的事情发生？**

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-19T17:43:04.087

[闰秒](http://en.wikipedia.org/wiki/Leap_second)是造成这种情况的原因：

> 闰秒是对协调世界时 (UTC) 时间尺度的正负一秒调整，使其接近平均太阳时。
> 
> 当在 23:59:60 UTC 添加正闰秒时，它会将下一个 UTC 日（UTC 时间 00:00:00）的开始延迟一秒，从而有效地减慢 UTC 时钟。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-19T17:46:00.803

手册页`ctime`解释说这是关于闰秒：

> `tm_sec`: 分钟后的秒数，通常在 0 到 59 的范围内，但可以最大为 60 以允许闰秒。

# ssl - 如何在 HTTPS 连接上显示非 SSL 图像？

> ID：765779
> 
> 赞同：24
> 
> 时间：2009-04-19T17:41:42.093
> 
> 标签：ssl, image, https

在我的 https 网站上，如何在没有证书的情况下显示来自网站的图像？

我拥有以下示例域：

*   http://www.example.com **_** _
*   http:// **static** .example.com（用于我的 CDN）

我拥有**www** .example.com 的证书，但不拥有**静态**.example.com 的证书。

**在我的 www.example.com 域上，您可以使用 http S** ://www.example.com通过 SSL 注册服务

在注册表单 (www.) 上，我想显示来自我的 CDN 的图像，该图像位于 http:// **static** .example.com 但不拥有该子域的证书。

在 https://**www.example.com 注册表 - 我正在使用 AJAX 从 http:// 动态提取图像**static.example.com。使用 AJAX 时，Web 浏览器似乎根本不显示非 SSL 图像。但是，*如果*该图像位于 http **S** ://www.example.com 域（与注册表单相同），则该图像将通过 AJAX 显示。****

 ****出于架构和设计的原因，我想将这些图像保留在我的 CDN (static.example.com) 上，而无需购买证书。

有谁知道我如何通过 AJAX 从我的 http **S** ://www.example 域上的非 SSL 子域显示这些图像？

提前致谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-05T07:26:19.557

您可以制作自己的 ssl 代理。

通过此脚本运行所有图像。只需创建一个文件并将此 PHP 代码放入其中。使用`curl`或`file_get_contents`回显内容。

所以如果你想调用安全镜像，你可以这样称呼它：

`https://mysecureserver.com/path_to_this_script/?url=[base64 encoded image link]`

```
<?php   
  $strFile = base64_decode(@$_GET['url']);
  $strFileExt = end(explode('.' , $strFile));
  if($strFileExt == 'jpg' or $strFileExt == 'jpeg'){
    header('Content-Type: image/jpeg');
  }elseif($strFileExt == 'png'){
    header('Content-Type: image/png');
  }elseif($strFileExt == 'gif'){
    header('Content-Type: image/gif');
  }else{
    die('not supported');
  }
  if($strFile != ''){
    $cache_ends = 60*60*24*365;
    header("Pragma: public");
    header("Cache-Control: maxage=". $cache_ends);
    header('Expires: ' . gmdate('D, d M Y H:i:s', time() + $cache_ends).' GMT');

    //... [and get the content using curl or file_get_contents and echo it out ]

  }
  exit;
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T18:17:01.150

如果没有 static.example.com 的证书，将无法在某些浏览器（尤其是 Internet Explorer）中触发安全警告或提示，则无法执行此操作。

GoDaddy 以 30 美元左右的价格出售 SSL 证书。我会说春天是为了一点点现金。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T20:33:18.660

您必须使用`https://`引用在通过 HTTPS 提供的页面上提供链接或嵌入（直接或通过 AJAX）的所有内容。

解决第 3 方纯 HTTP 内容问题的一种方法是通过使用 HTTPS 的反向代理提供该内容，可能在您的站点上或为此提供的服务。这样做可能会产生法律影响，具体取决于它是否被视为仅仅是代理或复制内容（可能类似于 Google 缓存的作用）。此外，通过这样做，您有效地保证了您以这种方式嵌入的内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-19T17:45:42.830

就像您将包含一个 https 图像一样：

```
<img src="http://www.google.com/intl/en_ALL/images/logo.gif" /> 
```

但是，某些浏览器可能会向用户抱怨您正在为安全页面加载不安全的资源。对此你无能为力。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-29T21:09:59.203

我知道这是一个非常古老的问题，但我想我还是会投入 0.02 美元。

我假设[http://static.example.com的子域也是](http://static.example.com)[http://www.example.com](http://www.example.com)的子目录/文件夹（即[http://www.example.com/static](http://www.example.com/static)），与这些天大多数托管。

您可以对此进行更改，但浏览到[http://www.example.com/static](http://www.example.com/static)和[https://www.example.com/static](https://www.example.com/static) ... 您看到的页面是否与浏览到[http://static 时相同。例子.com](http://static.example.com)

如果这是真的，您可以像这样提供图像......</p>

[https://www.example.com/static/image.ext](https://www.example.com/static/image.ext)

对于那些使用典型 shred 托管的人来说，另一种可能性是使用许多托管服务提供商提供的共享证书。请咨询托管公司的支持。它们通常是这样的……</p>

[https://host.hostcoserver.com/~user/dir/image.ext](https://host.hostcoserver.com/~user/dir/image.ext)

希望你们都觉得这很有用！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-19T18:30:18.263

要扩展[@Jaka Jančar 的答案](https://stackoverflow.com/questions/765779/how-to-display-non-ssl-images-on-https-connection/765784#765784)，您是否需要通过 AJAX 下载图像？您可以将 AJAX 调用替换为：动态添加 IMG 元素。

```
function load_image_instead_of_ajax_call(dom_parent_element,image_url) {
    var img = document.createElement('img');
    img.onload = your_success_callback_function;
    img.onerror = your_error_callback_function;
    img.src = image_url;
    dom_parent_element.appendChild(img);
} 
```

这样，您的图像资源就会被加载，并在成功/错误时进行适当的回调。

一些浏览器可能会抱怨您的页面包含 http 和 https 内容，但这并不常见（这似乎在大多数浏览器中默认关闭）。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-01-20T12:08:05.890

我为我运行的本地新闻聚合器遇到了这个问题，我最终使用 PHP 的副本将图像拉到我的服务器上，然后为它们提供 SSL。

[http://php.net/manual/en/function.copy.php](http://php.net/manual/en/function.copy.php)

# linux - 如何在 Redhat Linux 中获取线程 CPU 利用率指标

> ID：765781
> 
> 赞同：7
> 
> 时间：2009-04-19T17:43:15.553
> 
> 标签：linux, performance, multithreading, cpu, utilization

我需要获取进程中所有线程的 CPU 利用率指标。

*   操作系统 = Redhat linux
*   编程语言 = 使用 POSIX 的 C++
*   要求 = 需要每隔几秒不明确地采样一次，而不仅仅是及时的一个快照。
*   约束 = 不允许在线程中编写额外的代码

    我知道你可以使用“top”命令，但是还有什么其他的方法呢？“ps”有标志吗？

预先感谢您的所有帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-19T19:13:02.310

您可以阅读 的内容`/proc/[your PID]/stat`以获取整个过程的信息，如果您有 2.6 内核，则还`/proc/[your PID]/task/[thread ID]/stat`包含各个线程的信息。（见[这里](http://linux.die.net/man/5/proc)）

具体来说，您会发现这两个字段：

> 此进程已在用户模式下调度的 jiffies 数。
> 
> 时间%lu
> 
> 此进程已在内核模式下调度的 jiffies 数。
> 
> 可爱的 %ld

这里有问题的部分是给出值的单位。一个 jiffy 是 1/HZ 秒，其中 HZ 是内核时钟滴答速率，确定这个时钟速率是困难的部分。

如果你只需要一个特定的系统，你可以做一些测试或查看你的内核头文件并将这个值硬编码到你的程序中。如果您想知道如何以更一般的方式确定它，您可以通过查看[其源代码](http://procps.cvs.sourceforge.net/viewvc/procps/procps/proc/sysinfo.c?revision=HEAD&view=markup)来了解像 top 这样的工具是如何做到的（请参阅`old_Hertz_hack()`函数和相关注释）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-17T17:03:02.290

可能一种更简单的方法是使用[getrusage](http://pubs.opengroup.org/onlinepubs/009695399/functions/getrusage.html)和 .linux 的特定扩展名`RUSAGE_THREAD`。一旦有了这些时间，您就可以减去上次采样的时间，然后除以自上次采样以来经过的实际时间。也就是说，您以百分比形式获得 CPU 使用率。

有关 linux 特定文档，请参阅[rusage liunx 手册页](http://manpages.courier-mta.org/htmlman2/getrusage.2.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T17:47:29.193

您可以使用 Linux 中可用的[gnu gprof来执行此操作。](http://sourceware.org/binutils/docs/gprof/index.html)我相信他们声称支持线程，但这比进程级别的分析更复杂，因此您可能无法获得您正在寻找的结果。

这是[针对](http://sam.zoy.org/writings/programming/gprof.html)您的情况的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-18T14:37:27.457

您可以先使用“top”命令查找进程 ID。

之后，您可以使用以下命令仅显示进程的 CPU/Memory 使用情况

```
top -p {pid} 
```

之后，您可以按“Shift”+“h”显示线程

# c# - C#：如何制作类型泛型方法（字节/字/双字）？

> ID：765794
> 
> 赞同：0
> 
> 时间：2009-04-19T17:57:52.227
> 
> 标签：c#, generics

我是泛型的新手，我在 C# 中只能找到 List[T] - 没有别的了。

这是我必须用 C# 翻译的 C++ 代码

```
template <class type>
type Read()
{
    type t;
    int s = sizeof(type);
    if(index + s > size)
        throw(std::exception("error 101"));
    memcpy(&t, stream + index, s);
    index += s;
    return t;
} 
```

它是这样称呼的

```
BYTE mode = Read<BYTE>();
DWORD mode1 = Read<DWORD>();
WORD mode2 = Read<WORD>(); 
```

问题：如何使用 C# 泛型来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T18:28:18.470

您的代码似乎模仿了[BinaryReader](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.aspx)类的[ReadInt16](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.readint16.aspx)、[ReadInt32](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.readint32.aspx)和[ReadInt64](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.readint64.aspx)方法。

在不了解全局变量的情况下很难提供重写。假设该流是一个字节数组，则以下代码将起作用。

```
public T Read<T>() where T : struct {
  // An T[] would be a reference type, and alot easier to work with.
  T[] t = new T[1];

  // Marshal.SizeOf will fail with types of unknown size. Try and see...
  int s = Marshal.SizeOf(typeof(T));
  if (_index + s > _size)
    // Should throw something more specific.
    throw new Exception("Error 101");

  // Grab a handle of the array we just created, pin it to avoid the gc
  // from moving it, then copy bytes from our stream into the address
  // of our array.
  GCHandle handle = GCHandle.Alloc(t, GCHandleType.Pinned);
  Marshal.Copy(_stream, _index, handle.AddrOfPinnedObject(), s);

  _index += s;

  // Return the first (and only) element in the array.
  return t[0];
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-19T18:02:40.403

这是一个函数模板。您需要 C# 中的一个类，但类似于：

```
public static class Utility 
{
    public static Type Read<Type>()
    {
        //Converted code to c# that returns a Type;
    }
} 
```

您可能希望为此使用约束，例如限制为值类型。

您可以像这样调用该函数：

```
Utility.Read<int>(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T18:01:51.920

您正在寻找的签名是：

```
public class Reader
{
    public static T Read<T>()
    {
    }
} 
```

您需要将其放入一个类型中。它可以是实例或静态成员。

* * *

编辑：

除了必须显式传递泛型类型参数外，它的使用与任何其他方法一样。例如：

```
byte mode = Reader.Read<byte>() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T18:03:27.937

查看 MSDN 上的[C# 泛型简介](http://msdn.microsoft.com/en-us/library/ms379564(VS.80).aspx)文章。在那之后应该是不言自明的......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T18:13:13.327

我只想指出您的 C++ 示例充满了全局变量，并且在泛型类型中做的不是很好，这里的其他人已经指出了如何处理实际的方法签名，而不是移植那个 C++代码，我会修改成更适合 C# 风格的东西。

摆脱全局变量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-19T18:22:56.533

我的 C++ 非常生锈，但看起来您正在从流中读取值类型。

您可以将泛型限制为引用类型或值类型，并且可以使用`default`关键字初始化一个空变量。

```
public T Read<T>( Stream input ) 
    where T:struct //forces T to be a value type
{
    T returnValue = default(T); //init a return value
    int index = input.Position;

    //your conversion here

    return returnValue;
} 
```

您最好将流作为参数传递。

还要记住，在 C++ 中，这些是模板——您将获得为每种使用的类型编译的代码的副本。这排除了从 C# 引用 C++ 库的可能性，因为在编译 C++ 时，它不一定具有 C# 代码要求编译的类型。

C#中只编译了一个类，可以被外部引用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-19T19:01:10.093

我不完全确定您的数据流来自哪里。但是，如果它是非托管指针，您可以执行以下操作。

```
public static T Read<T>(ref IntPtr ptr) 
  where T : struct {
  var size = Marshal.SizeOf(typeof(T));
  var value = (T)Marshal.PtrToStructure(ptr, typeof(T));
  ptr = new IntPtr(ptr.ToInt64() + size);
  return value;
} 
```

# asp.net - 运行时错误

> ID：765796
> 
> 赞同：2
> 
> 时间：2009-04-19T18:00:32.563
> 
> 标签：asp.net

错误的含义是什么，我该怎么做才能解决这个问题？：

> 说明：服务器上发生应用程序错误。此应用程序的当前自定义错误设置可防止远程查看应用程序错误的详细信息（出于安全原因）。但是，它可以被本地服务器机器上运行的浏览器查看。

详细信息：要在远程计算机上查看此特定错误消息的详细信息，请在位于当前 Web 应用程序根目录的“web.config”配置文件中创建一个标签。然后，此标记应将其“模式”属性设置为“关闭”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T18:02:29.483

它在错误中告诉您：编辑 web.config 并将错误模式更改为关闭。

例如，添加以下内容：

```
<configuration>
    <system.web>
        <customErrors mode="Off"/>
    </system.web>
</configuration> 
```

出于安全原因，您不想在外部给出详细的错误，因此这通常是一个更好的设置：

```
<configuration>
    <system.web>
        <customErrors mode="RemoteOnly" defaultRedirect="~/Error.aspx"/>
    </system.web>
</configuration> 
```

如果从服务器访问，这将在您的开发机器或服务器上显示错误，但会将外部用户重定向到自定义错误页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T18:13:50.050

您不应该在生产服务器上关闭 CustomErrors，因为您冒着通过这些错误暴露敏感信息的风险（这就是它首先隐藏它们的全部原因）。您可以实施异常处理和日志记录以正确诊断生产服务器上的潜在问题。理想情况下，您可以在开发/测试服务器上重现相同的问题，在该服务器上可以安全地禁用 CustomErrors。但是 CustomErrors 的“RemoteOnly”默认选项仍然允许您查看生产中的错误，您只需要从本地计算机（即 Web 服务器）进行浏览。

您发布的错误只是意味着出现了一些未处理的异常，它几乎可以是任何东西。

# python - 将 timedelta 转换为年？

> ID：765797
> 
> 赞同：170
> 
> 时间：2009-04-19T18:00:40.033
> 
> 标签：python, datetime, timedelta

我需要检查自某个日期以来是否已有几年。目前我已经`timedelta`从`datetime`模块中获得，我不知道如何将其转换为年。

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2009-04-19T20:05:15.943

你需要不止一个`timedelta`来判断已经过去了多少年；您还需要知道开始（或结束）日期。（这是闰年的事情。）

您最好的选择是使用`dateutil.relativedelta` [object](http://labix.org/python-dateutil)，但这是一个 3rd 方模块。如果您想知道从某个日期算起的`datetime`年份`n`（默认为现在），您可以执行以下操作：

```
from dateutil.relativedelta import relativedelta

def yearsago(years, from_date=None):
    if from_date is None:
        from_date = datetime.now()
    return from_date - relativedelta(years=years) 
```

如果您宁愿坚持使用标准库，答案会稍微复杂一点：：

```
from datetime import datetime
def yearsago(years, from_date=None):
    if from_date is None:
        from_date = datetime.now()
    try:
        return from_date.replace(year=from_date.year - years)
    except ValueError:
        # Must be 2/29!
        assert from_date.month == 2 and from_date.day == 29 # can be removed
        return from_date.replace(month=2, day=28,
                                 year=from_date.year-years) 
```

如果是 2/29，而 18 年前没有 2/29，则此函数将返回 2/28。如果您宁愿返回 3/1，只需将最后一条`return`语句更改为::

```
 return from_date.replace(month=3, day=1,
                             year=from_date.year-years) 
```

Your question originally said you wanted to know how many years it's been since some date. Assuming you want an integer number of years, you can guess based on 365.2425 days per year and then check using either of the `yearsago` functions defined above::

```
def num_years(begin, end=None):
    if end is None:
        end = datetime.now()
    num_years = int((end - begin).days / 365.2425)
    if begin > yearsago(num_years, end):
        return num_years - 1
    else:
        return num_years 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2009-04-19T18:36:03.257

如果您要检查某人是否年满 18 岁，`timedelta`由于闰年，在某些边缘情况下使用将无法正常工作。例如，2000 年 1 月 1 日出生的人，将在 2018 年 1 月 1 日（包括 5 个闰年）正好在 6575 天后满 18 岁，但在 2001 年 1 月 1 日出生的人，将在 1 月 1 日正好 6574 天后满 18 岁， 2019 年（包括 4 个闰年）。因此，如果某人正好是 6574 天，如果不知道更多关于他们生日的信息，您就无法确定他们是 17 岁还是 18 岁。

正确的方法是直接从日期计算年龄，减去两年，如果当前月/日早于出生月/日，则减去一。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-19T18:08:08.083

首先，在最详细的层面上，问题无法完全解决。年份的长度各不相同，而且年份长度没有明确的“正确选择”。

也就是说，获取任何“自然”单位（可能是秒）的差异，然后除以该单位与年份之间的比率。例如

```
delta_in_days / (365.25)
delta_in_seconds / (365.25*24*60*60) 
```

...管他呢。远离几个月，因为它们的定义甚至不如几年。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-08-10T10:53:50.037

Here's a updated DOB function, which calculates birthdays the same way humans do:

```
import datetime
import locale

# Source: https://en.wikipedia.org/wiki/February_29
PRE = [
    'US',
    'TW',
]
POST = [
    'GB',
    'HK',
]

def get_country():
    code, _ = locale.getlocale()
    try:
        return code.split('_')[1]
    except IndexError:
        raise Exception('Country cannot be ascertained from locale.')

def get_leap_birthday(year):
    country = get_country()
    if country in PRE:
        return datetime.date(year, 2, 28)
    elif country in POST:
        return datetime.date(year, 3, 1)
    else:
        raise Exception('It is unknown whether your country treats leap year '
                      + 'birthdays as being on the 28th of February or '
                      + 'the 1st of March. Please consult your country\'s '
                      + 'legal code for in order to ascertain an answer.')
def age(dob):
    today = datetime.date.today()
    years = today.year - dob.year

    try:
        birthday = datetime.date(today.year, dob.month, dob.day)
    except ValueError as e:
        if dob.month == 2 and dob.day == 29:
            birthday = get_leap_birthday(today.year)
        else:
            raise e

    if today < birthday:
        years -= 1
    return years

print(age(datetime.date(1988, 2, 29))) 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-12-24T21:13:42.023

Get the number of days, then divide by 365.2425 (the mean Gregorian year) for years. Divide by 30.436875 (the mean Gregorian month) for months.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-19T18:04:03.020

你需要它有多精确？ `td.days / 365.25`如果您担心闰年，会让您非常接近。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-11-30T01:51:16.053

```
def age(dob):
    import datetime
    today = datetime.date.today()

    if today.month < dob.month or \
      (today.month == dob.month and today.day < dob.day):
        return today.year - dob.year - 1
    else:
        return today.year - dob.year

>>> import datetime
>>> datetime.date.today()
datetime.date(2009, 12, 1)
>>> age(datetime.date(2008, 11, 30))
1
>>> age(datetime.date(2008, 12, 1))
1
>>> age(datetime.date(2008, 12, 2))
0 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-12-24T20:52:12.080

Yet another 3rd party lib not mentioned here is mxDateTime (predecessor of both python `datetime` and 3rd party `timeutil`) could be used for this task.

The aforementioned `yearsago` would be:

```
from mx.DateTime import now, RelativeDateTime

def years_ago(years, from_date=None):
    if from_date == None:
        from_date = now()
    return from_date-RelativeDateTime(years=years) 
```

First parameter is expected to be a `DateTime` instance.

To convert ordinary `datetime` to `DateTime` you could use this for 1 second precision):

```
def DT_from_dt_s(t):
    return DT.DateTimeFromTicks(time.mktime(t.timetuple())) 
```

or this for 1 microsecond precision:

```
def DT_from_dt_u(t):
    return DT.DateTime(t.year, t.month, t.day, t.hour,
  t.minute, t.second + t.microsecond * 1e-6) 
```

And yes, adding the dependency for this single task in question would definitely be an overkill compared even with using timeutil (suggested by Rick Copeland).

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-15T23:20:49.107

In the end what you have is a maths issue. If every 4 years we have an extra day lets then dived the timedelta in days, not by 365 but 365*4 + 1, that would give you the amount of 4 years. Then divide it again by 4\. timedelta / ((365*4) +1) / 4 = timedelta * 4 / (365*4 +1)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-03-10T14:29:20.100

This is the solution I worked out, I hope can help ;-)

```
def menor_edad_legal(birthday):
    """ returns true if aged<18 in days """ 
    try:

        today = time.localtime()                        

        fa_divuit_anys=date(year=today.tm_year-18, month=today.tm_mon, day=today.tm_mday)

        if birthday>fa_divuit_anys:
            return True
        else:
            return False            

    except Exception, ex_edad:
        logging.error('Error menor de edad: %s' % ex_edad)
        return True 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-05-16T06:33:47.517

` Simple solution!

```
import datetime as dt
from dateutil.relativedelta import relativedelta

dt1 = dt.datetime(1990,2,1)
dt2 = dt.datetime(2021,5,16)
out = relativedelta(dt2, dt1)

print(f'Complete: {out}')
print(f'years:{out.years}, months:{out.months}, days:{out.days}') ` 
```

Complete: relativedelta(years=+31, months=+3, days=+15)

years:31, months:3, days:15

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-09-21T21:30:50.553

This method is a hack of the datetime library:

```
def calculate_age(birthday_date, fmt="%Y-%m-%d"):
    birthday = datetime.datetime.strptime(birthday_date, fmt)
    age = datetime.datetime.now() - birthday
    # first datime valid is (1, 1, 1), I use (1, 12, 31) => (2, 0, 0) to hack the lib
    age = (datetime.datetime(1, 12, 31) + age)
    return age.year - 2 
```

This solution is odd, so I shared it with you. It's probably not the most elegant function.

```
now : 2019-09-21

print(calculate_age("2019-09-21")) => 2 (Done) 

-> age + (1,12,31) = 0004-01-01 23:42:17.767031

print(calculate_age("2020-09-21")) => 0 (Undone)

-> age + (1,12,31) = 0002-12-31 23:46:39.144091 
```

The difference is one day. I understand the reason for the difference is due to the bisextile (leap) year.

To correct this undesired behaviour, you need to use the birthday year to add the result.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-07-03T10:51:42.820

Even though this thread is already dead, might i suggest a working solution for this very same problem i was facing. Here it is (date is a string in the format dd-mm-yyyy):

```
def validatedate(date):
    parts = date.strip().split('-')

    if len(parts) == 3 and False not in [x.isdigit() for x in parts]: 
        birth = datetime.date(int(parts[2]), int(parts[1]), int(parts[0]))
        today = datetime.date.today()

        b = (birth.year * 10000) + (birth.month * 100) + (birth.day)
        t = (today.year * 10000) + (today.month * 100) + (today.day)

        if (t - 18 * 10000) >= b:
            return True

    return False 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-09-01T09:29:40.003

this function returns the difference in years between two dates (taken as strings in ISO format, but it can easily modified to take in any format)

```
import time
def years(earlydateiso,  laterdateiso):
    """difference in years between two dates in ISO format"""

    ed =  time.strptime(earlydateiso, "%Y-%m-%d")
    ld =  time.strptime(laterdateiso, "%Y-%m-%d")
    #switch dates if needed
    if  ld < ed:
        ld,  ed = ed,  ld            

    res = ld[0] - ed [0]
    if res > 0:
        if ld[1]< ed[1]:
            res -= 1
        elif  ld[1] == ed[1]:
            if ld[2]< ed[2]:
                res -= 1
    return res 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-12-01T04:48:56.337

I'll suggest [Pyfdate](http://www.ferg.org/pyfdate/index.html)

> **What is pyfdate?**
> 
> Given Python's goal to be a powerful and easy-to-use scripting language, its features for working with dates and times are not as user-friendly as they should be. The purpose of pyfdate is to remedy that situation by providing features for working with dates and times that are as powerful and easy-to-use as the rest of Python.

the [tutorial](http://www.ferg.org/pyfdate/tutorial.html)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-03-06T00:46:06.043

```
import datetime

def check_if_old_enough(years_needed, old_date):

    limit_date = datetime.date(old_date.year + years_needed,  old_date.month, old_date.day)

    today = datetime.datetime.now().date()

    old_enough = False

    if limit_date <= today:
        old_enough = True

    return old_enough

def test_ages():

    years_needed = 30

    born_date_Logan = datetime.datetime(1988, 3, 5)

    if check_if_old_enough(years_needed, born_date_Logan):
        print("Logan is old enough")
    else:
        print("Logan is not old enough")

    born_date_Jessica = datetime.datetime(1997, 3, 6)

    if check_if_old_enough(years_needed, born_date_Jessica):
        print("Jessica is old enough")
    else:
        print("Jessica is not old enough")

test_ages() 
```

This is the code that the Carrousel operator was running in Logan's Run film ;)

[https://en.wikipedia.org/wiki/Logan%27s_Run_(film)](https://en.wikipedia.org/wiki/Logan%27s_Run_(film))

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-06-09T08:21:22.073

I came across this question and found Adams answer the most helpful [https://stackoverflow.com/a/765862/2964689](https://stackoverflow.com/a/765862/2964689)

But there was no python example of his method but here's what I ended up using.

input: datetime object

output: integer age in whole years

```
def age(birthday):
    birthday = birthday.date()
    today = date.today()

    years = today.year - birthday.year

    if (today.month < birthday.month or
       (today.month == birthday.month and today.day < birthday.day)):

        years = years - 1

    return years 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-06-18T05:33:51.940

I liked John Mee's solution for its simplicity, and I am not that concerned about how, on Feb 28 or March 1 when it is not a leap year, to determine age of people born on Feb 29\. But here is a tweak of his code which I think addresses the complaints:

```
def age(dob):
    import datetime
    today = datetime.date.today()
    age = today.year - dob.year
    if ( today.month == dob.month == 2 and
         today.day == 28 and dob.day == 29 ):
         pass
    elif today.month < dob.month or \
      (today.month == dob.month and today.day < dob.day):
        age -= 1
    return age 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-11-15T18:06:17.820

I would use `datetime.date` data type instead, as it is simpler when it comes to checking how many years, months and days have passed:

```
now = date.today()
birthday = date(1993, 4, 4)
print("you are", now.year - birthday.year, "years,", now.month - birthday.month, "months and",
  now.day - birthday.day, "days old") 
```

Output:

```
you are 27 years, 7 months and 11 days old 
```

I use `timedelta` when I need to perform arithmetic on a specific date:

```
age = now - birthday
print("addition of days to a date: ", birthday + timedelta(days=age.days)) 
```

Output:

```
addition of days to a date:  2020-11-15 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-12-02T05:19:42.003

Late to the party, but this will give you the age (in years) accurately and easily:

```
b = birthday
today = datetime.datetime.today()
age = today.year - b.year + (today.month - b.month > 0 or 
                             (today.month == b.month > 0 and 
                              today.day - b.day > 0)) 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-06-03T20:15:55.010

For my purposes since subtraction of two `datetime` objects (at least in Python 3.8) converts to a `timedelta` with only a `days` attribute:

```
>>> admit = datetime.strptime('20130530', '%Y%m%d')
>>> birth = datetime.strptime('20010621', '%Y%m%d')
>>> age = (admit - birth).days/365.2425
>>> age
11.940012457476882 
```

# c# - Windows 上的视频叠加（使用 C#？）

> ID：765808
> 
> 赞同：1
> 
> 时间：2009-04-19T18:05:31.443
> 
> 标签：c#, .net, windows, video-processing

我正在使用 C# 开发视频处理库，并希望在 Windows XP 上显示视频。为此，我目前使用了一个自定义的双缓冲`UserControl`并被覆盖`OnPaint`，它使用`Graphics.DrawImageUnscaled`. 这工作正常，但并不理想。

因此，我想像许多其他视频播放器一样使用[硬件覆盖来实现视频显示。](http://en.wikipedia.org/wiki/Hardware_overlay)

我该怎么做呢？在 C# 中？还是 C/C++？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-29T22:09:55.580

我最终通过适用于 Windows、Linux 和 Mac OS X 的优秀[OpenTK](http://www.opentk.com)库使用 OpenGL。实际上，我将帧复制到纹理中，然后映射到填充整个视口的四边形。像王牌一样工作。

感谢您的所有建议，

基督教。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-26T21:11:35.123

您是否看过使用 WPF 和[MediaElement 类？](http://msdn.microsoft.com/en-us/library/system.windows.controls.mediaelement.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T19:24:15.683

您是否考虑过使用 DirectShow？[这是一个例子](http://www.codeproject.com/KB/directx/directshowmediaplayer.aspx)。

# unit-testing - 谁负责在非初始化依赖注入方案中附加监听器？

> ID：765811
> 
> 赞同：3
> 
> 时间：2009-04-19T18:07:02.140
> 
> 标签：unit-testing, dependency-injection

我一直在阅读 Misko Hevery 的[指南：编写可测试代码](http://misko.hevery.com/code-reviewers-guide/)。

我肯定会购买依赖注入作为提高可测试性的好工具，并在我的代码中大量使用它。然而，当阅读指南的第一部分“[缺陷 #1：构造函数做真正的工作](http://misko.hevery.com/code-reviewers-guide/flaw-constructor-does-real-work/)”时，我发现我仍然对你应该如何连接事件监听器有点模糊。

假设我有一个类，为了正常工作，需要将侦听器附加到通过构造函数依赖注入传入的参数之一。根据指南，构造函数应该只将它的参数分配给成员变量，而不做其他工作。此外，当构造函数完成时，对象应该被完全初始化。但是，在这种情况下，除非需要连接侦听器，否则我不会认为对象已完全初始化。

据我所知，这需要连接构建器或工厂中的所有侦听器，尽管这似乎与对象本身非常分离，并且很容易失去同步。此外（至少在动作脚本中，我这些天大部分时间都在使用它），这意味着我的事件监听器不能再是私有的，因为工厂/构建器需要看到它们。

处理这个问题的最佳方法是什么？我在这里缺少另一个选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T17:14:37.237

一种常见的模式是将连线移动到 initialize() 或 start() 方法中，并利用依赖注入容器的生命周期机制来确保调用该方法。

在我当前的项目中，我们将注释与 Spring 和 Spring.NET 的 bean 后处理器结合起来，将事件侦听器连接到方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T19:34:25.520

**将业务逻辑（调用图）与对象创建分离**

具体来说：如果`House`需要初始化`Kitchen`才能正确运行，`Kitchen`则应将初始化传递给`House`构造函数。

`House`不应该负责初始化`Kitchen`。那是别人的责任。（可能是首先建造厨房的人。）

但是，有一个小问题：如果对象的生命周期比 短`House`，则它不属于成员变量。例如：`Person`或者`Owner`可能不应该通过构造函数传入。它应该通过函数调用传入。

[Misko 关于管理对象生命周期的最新文章讨论了这个主题。](http://misko.hevery.com/2009/04/15/managing-object-lifetimes/)

# c# - 如何从 c# powershell 脚本执行中提取 $lastexitcode

> ID：765816
> 
> 赞同：5
> 
> 时间：2009-04-19T18:10:37.110
> 
> 标签：c#, powershell, scripting, exit-code, pshost

我在这里使用代码项目上的 powershell 异步执行代码在 C# 中执行了一个 scipt：

[http://www.codeproject.com/KB/threads/AsyncPowerShell.aspx?display=PrintAll&fid=407636&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2130851#xx2130851xx](http://www.codeproject.com/KB/threads/AsyncPowerShell.aspx?display=PrintAll&fid=407636&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2130851#xx2130851xx)

我需要返回 $lastexitcode，Jean-Paul 描述了如何使用自定义 pshost 类返回它。我在 pshost 中找不到返回退出代码的任何方法或属性。

这个引擎我需要确保脚本正确执行。

任何帮助，将不胜感激。

问候鲍勃。

它的 $lastexitcode 和 $? 我需要带回来的变量。

你好，终于回答了。
我发现了 $host 变量。它实现了对主机的回调，特别是自定义 PSHost 对象，使您能够返回 $lastexitcode。这是 $host 解释的链接。

[http://mshforfun.blogspot.com/2006/08/do-you-know-there-is-host-variable.html](http://mshforfun.blogspot.com/2006/08/do-you-know-there-is-host-variable.html)

与 powershell 文档一样，它似乎晦涩难懂，文档记录不充分。使用第 4 点，调用 $host.SetShouldExit(1) 将 1 返回到 pshost 的 SetShouldExit 方法，如此处所述。

[http://msdn.microsoft.com/en-us/library/system.management.automation.host.pshost.setshouldexit(VS.85).aspx](http://msdn.microsoft.com/en-us/library/system.management.automation.host.pshost.setshouldexit(VS.85).aspx)

它实际上取决于定义您自己的退出代码定义。我猜是 0 和 1 后缀。

问候鲍勃。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T02:08:17.187

这是您可以尝试的功能：

```
function run-process ($cmd, $params) {
$p = new-object System.Diagnostics.Process
$p.StartInfo = new-object System.Diagnostics.ProcessStartInfo
$exitcode = $false  
$p.StartInfo.FileName = $cmd
$p.StartInfo.Arguments = $params
$p.StartInfo.UseShellExecute = $shell
$p.StartInfo.WindowStyle = 1; #hidden.  Comment out this line to show output in separate console
$null = $p.Start()
$p.WaitForExit()
$exitcode = $p.ExitCode
$p.Dispose()    
return $exitcode
} 
```

希望有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T21:22:43.637

您可以在脚本代码中编写将检查 $lastexitcode 并在退出代码不是您例外时[抛出异常的代码。](http://huddledmasses.org/trap-exception-in-powershell/)
异常更容易捕获。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-22T00:53:49.667

我相信您正在通过使用此代码项目从小山中翻山越岭。在 C# 中异步执行非常容易。

```
PowerShell psCmd = PowerShell.Create().AddScript({Invoke-YourScriptAndReturnLastExitCode});
IAsyncResult result = psCmd.BeginInvoke();
// wait for finish
psCmd.EndInvoke(result); 
```

此外，查看您对该项目的问题，您似乎正在尝试在 PowerShell 中使用 TFS。您可以考虑以下附加信息：

1.  [TFS 有 cmdlet](http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx)
2.  许多其他人使用过 TFS cmdlet，即[PSTFS](http://pstfs.codeplex.com/wikipage?title=Get-TFS-EN)
3.  您始终可以在任何需要的地方复制 tfs 可执行文件，这至少可以避免部分脚本的痛苦。

希望这可以帮助

# java - HQL：如何根据映射的复合元素的属性对对象列表进行排序

> ID：765821
> 
> 赞同：3
> 
> 时间：2009-04-19T18:13:53.560
> 
> 标签：java, hibernate, sorting, hql

我有一个带有组件图的对象：

```
<class name="Article" table="articles">
 ...
  <map name="i18nData" table="articles_i18n">
      <key column="id" not-null="true"/>
      <map-key column="language" type="string"/>

      <composite-element class="Article$ArticleI18nData">
        <property name="displayName" type="string"/>
      </composite-element>

    </map>      

</class> 
```

HQL 查询如何检索按映射组件的“displayName”属性排序的所有“文章”对象，并使用例如“EN”的键进行映射？

谢谢，克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T07:22:56.010

向地图元素添加“order-by”属性：

```
<map name="i18nData" table="articles_i18n" order-by="name asc">
  ..
</map> 
```

该属性的值是数据库列名。

看：

*   休眠文档 - 6.2。集合映射（docs.jboss.org/hibernate/stable/core/reference/en/html/collections-mapping.html）
*   休眠文档 - 6.3.1。排序集合（docs.jboss.org/hibernate/stable/core/reference/en/html/collections-advancedmappings.html）

抱歉，我是新用户，不允许添加真正的超链接。

# linux - Linux 命令：目录中的目录

> ID：765823
> 
> 赞同：2
> 
> 时间：2009-04-19T18:15:12.573
> 
> 标签：linux, command-line, directory

所以我有一个目录 - 比如说 /dir/。在其中我有这些文件夹- /dir/fold1/ /dir/fold2/ /dir/fold3/

这些文件夹（fold1、2、3）中的每一个都可能包含一个名为 foo 的文件夹。我想列出 dir 中的所有文件夹，其中包含一个名为 foo 的文件夹。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T18:17:51.943

用这个：

```
find dir -type d -name foo 
```

所以...`dir`是您要搜索的目录。

`-type`它们是您要查找的类型吗：**目录**、**文件**或**链接**。

`-name`是您要查找的名称，区分大小写。`-iname`如果您希望它不区分大小写，则可以使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T18:40:57.800

关于什么

```
ls -R /dir | grep -i foo 
```

分解我们拥有的命令： `ls -R`= 递归列出文件（包括目录

`grep -i foo`= 将采用上面的命令并过滤它不区分大小写以显示任何“foo”实例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T06:09:37.113

```
ls -ld /dir/*/foo | grep ^d 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T18:27:41.640

我提议：

```
find /dir -name foo -type d -exec dirname {} \; | xargs ls 
```

但如果任何目录中有空格，这将不起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T18:50:04.597

如果要列出仅包含`foo`在第一级命名的子目录的所有目录，则可以执行

```
for x in /dir/*; do
  [ -d $x/foo ] && ls $x
done 
```

该`[ ... ]`构造是 shell built-in 的缩写`test`。 `-d $x/foo`测试是否`$x/foo`存在并且是一个目录。如果是，则`ls $x`执行。

# iphone - 改变 UIImageView 动画速度

> ID：765834
> 
> 赞同：3
> 
> 时间：2009-04-19T18:20:28.410
> 
> 标签：iphone, cocoa-touch, uiimageview

我正在使用 UIImageView 为一堆图像设置动画。我知道我可以通过改变 animationDuration 来改变速度，但这似乎在动画重新启动之前不会生效。

我的问题是，除了真的不想重新启动动画，因为这限制了我每个周期只能改变一次速度，似乎也没有办法找出当前显示的帧和因此，我将不得不依靠计时器来“猜测”它是哪一个。

所以我的问题是，是否有办法在不重新启动动画的情况下改变速度，如果没有，是否有办法避免上述问题？我不太热衷于编写自己的动画课程，但如果没有更好的解决方案，可能最终不得不这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T18:48:37.703

我不确定这是否适用于`UIImageView`超类，但`UIView`类具有以下属性，默认为`NO`：

```
setAnimationBeginsFromCurrentState:(BOOL)fromCurrentState 
```

更改为`YES`并调用该`commitAnimations`方法后，后续调用`beginAnimations:context:`将在动画之前停止的点开始。

# iphone - 定位 UITableView 滚动的 UIView

> ID：765836
> 
> 赞同：2
> 
> 时间：2009-04-19T18:21:16.380
> 
> 标签：iphone, objective-c, cocoa-touch, uiviewcontroller

如果启用了滚动，我正在尝试获取 UITableView 滚动的 UIView。通常，背景是白色的，如果你将 UITableView 推出它的边界，你会看到一个背景。我正在尝试将此背景设置为 blackColor 的 UIColor。我似乎找不到合适的标签。我在 UIViewController 中尝试了以下代码：

```
- (void)loadView 
{
    [super loadView];
    UITableView *aTableView = 
        [[[UITableView alloc] 
            initWithFrame:self.view.bounds
            style:UITableViewStylePlain] autorelease];

    [aTableView setScrollEnabled:YES];
    [self.view setBackgroundColor:[UIColor blackColor]];
    [self.view addSubview:aTableView];
    self.tableView = aTableView;
} 
```

颜色仍然保持白色。似乎我打错了 UIView。

任何想法？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T18:52:30.627

我没有解决方案，但我有一个建议。您是否尝试过使 UITableView 的 backgroundColor 透明并将超级视图的颜色设置为白色？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T22:46:13.177

我能够实现你想要的，但它对我来说似乎是一种解决方法（也许库上有一个错误）。

首先，您需要在 UITableView 中将 backgroundColor 属性设置为黑色。

然后，当您创建一个新的 UITableViewCell 时，您需要执行以下操作（此代码在 UITableView 的数据源上）：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *MyIdentifier = @"MyIdentifier";

    // Try to retrieve from the table view a now-unused cell with the given identifier
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:MyIdentifier];

    // If no cell is available, create a new one using the given identifier
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:MyIdentifier] autorelease];
    }
    cell.contentView.backgroundColor = [UIColor whiteColor];

    UILabel *label = [[[UILabel alloc] initWithFrame:CGRectMake(0.0, 0.0, 60, 20)] autorelease];
    label.text = @"test";
    label.textColor = [UIColor blackColor];
    [cell.contentView addSubview:label];
    cell.textColor = [UIColor blackColor];

    return cell;
} 
```

您必须将 contentView 的背景颜色设置为白色，但是当您这样做时，单元格的文本会停止出现，因此您需要在其内容视图中添加一个 UILabel 并自己编写文本。

仅仅改变背景颜色似乎有点过头了，但可能有一个错误会阻止在 UITableViewCell 上设置与包含 UITableView 不同的背景颜色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-28T02:17:12.190

嗯..我在 cellForRowAtIndexPath 方法中设置单元格的背景颜色时遇到了类似的问题。解决方法是在回调方法 willDisplayCell 中设置背景颜色。

```
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{
   cell.backgroundColor = (indexPath.row % 2 == 0) ? DARK_BACKGROUND : LIGHT_BACKGROUND;
} 
```

# iphone - CALayer 和 CGGradientRef 抗锯齿？

> ID：765838
> 
> 赞同：4
> 
> 时间：2009-04-19T18:21:31.013
> 
> 标签：iphone, core-animation, gradient, antialiasing, radial-gradients

我对 iPhone 的 CALayer 绘图有一个奇怪的问题。我有一个根层，它添加了一堆代表“气泡”的子层。最终结果应该是这样的：

[http://www.expensivedna.com/IMG_0018.PNG http://www.expensivedna.com/IMG_0018.PNG](http://www.expensivedna.com/IMG_0018.PNG)

问题是我似乎无法使图层抗锯齿（注意气泡上的锯齿）。我为气泡 CALayer 覆盖 drawInContext 的代码如下：

```
- (void)drawInContext:(CGContextRef)theContext{
CGContextSetAllowsAntialiasing(theContext, true);
CGContextSetShouldAntialias(theContext, true);

size_t num_locations = 2;
CGFloat locations[2] = { 0.0, 1.0 };
CGFloat components[8] = { 1.0, 1.0, 1.0, 0.5,  // Start color
                          1.0, 1.0, 1.0, 0.0 }; // End color
CGColorSpaceRef rgbColorspace = CGColorSpaceCreateDeviceRGB();
CGGradientRef glossGradient = 
CGGradientCreateWithColorComponents(rgbColorspace, components, locations, num_locations);

CGPoint topCenter = CGPointMake(25, 20);
CGPoint midCenter = CGPointMake(25, 25);
CGContextDrawRadialGradient(theContext, glossGradient, midCenter, 20, topCenter, 10, kCGGradientDrawsAfterEndLocation); 
```

}

现在真正奇怪的是，如果我稍微改变绘图代码只绘制正常的红色圆圈，如下所示：

```
- (void)drawInContext:(CGContextRef)theContext{
CGContextSetAllowsAntialiasing(theContext, true);
CGContextSetShouldAntialias(theContext, true);

CGContextSetFillColorWithColor(theContext, [UIColor redColor].CGColor);
CGContextFillEllipseInRect(theContext, CGRectMake(0, 0, 40,40));
} 
```

一切似乎都可以抗锯齿：

[http://www.expensivedna.com/IMG_0017.PNG http://www.expensivedna.com/IMG_0017.PNG](http://www.expensivedna.com/IMG_0017.PNG)

我似乎无法弄清楚这种看似奇怪的行为。我是否错过了抗锯齿渐变和法线圆之间的一些区别？

多谢你们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T22:27:52.383

多谢你们。所以事实证明，答案是您的两个答案（coob 和 Alex）的组合。基本上，CGDrawRadialGradient 函数似乎只在起始圆有别名，而不是在结束圆。由于我想要在两者上都使用别名“边缘”，因此我首先将函数设置为从内向外绘制，这会处理第一个“边缘”，但会产生以下结果：

[第1步](http://www.expensivedna.com/pic2.png)

然后，我按照 coob 的建议剪辑图像，并在气泡的最后边缘产生很好的锯齿：

[第2步](http://www.expensivedna.com/pic1.png)

看起来对我来说已经足够好了！

```
- (void)drawInContext:(CGContextRef)theContext{
CGContextSetAllowsAntialiasing(theContext, true);
CGContextSetShouldAntialias(theContext, true);

size_t num_locations = 2;
CGFloat locations[2] = { 0.0, 1.0 };
CGFloat components[8] = { 1.0, 1.0, 1.0, 0.0,  // Start color
              1.0, 1.0, 1.0, 0.5 }; // End color
CGColorSpaceRef rgbColorspace = CGColorSpaceCreateDeviceRGB();
CGGradientRef glossGradient = 
CGGradientCreateWithColorComponents(rgbColorspace, components, locations, num_locations);

CGContextAddEllipseInRect(theContext, CGRectMake(5, 5, 40, 40));
CGContextClip(theContext);

CGPoint topCenter = CGPointMake(25, 20);
CGPoint midCenter = CGPointMake(25, 25);
CGContextDrawRadialGradient(theContext, glossGradient, topCenter, 10, midCenter, 20, kCGGradientDrawsAfterEndLocation); 
```

}

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T13:18:34.510

Jeff - 使 topCenter 更进一步，并使用带有圆形遮罩的 CGContextClipToMask。

编辑：实际上更好的方法是使用 CGContextClip 使用矢量剪切路径。

编辑2：示例代码：

```
CGContextAddEllipseInRect(theContext, CGRectMake(20, 20, 10, 10));
CGContextClip(theContext); 
```

在绘制渐变之前添加它，然后将其绘制得更远一些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T15:13:29.007

也许尝试退出 kCGGradientDrawsAfterEndLocation？它可能对 alpha 做了一些奇怪的事情

# ruby-on-rails - 在 Ruby on Rails 中将安全逻辑与模型混合？

> ID：765840
> 
> 赞同：4
> 
> 时间：2009-04-19T18:22:43.787
> 
> 标签：ruby-on-rails, security, model

在模型中混合处理安全逻辑的代码是不好的设计吗？

在 before_save 回调中编辑页面的示例

*   当前用户是从`current_user`控制器层的方法中获取的。
*   `current_user.has_permission? :edit_page`如果为假则抛出异常
*   `editor_id`设置为`current_user.id`
*   更改记录在单独的表中

该模型不是应用程序中唯一的安全检查。用户界面在显示编辑视图之前检查权限。该模型充当了针对 View/Controller 级别中的任何错误的屏障。

注意：模型和控制器级别之间的唯一突破是`current_user`方法。我正在开发的应用程序永远不会允许匿名用户。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T19:16:47.160

MVC 框架中的模型应该完全包含您的所有业务逻辑。在设计良好的 MVC 应用程序中，至少在理论上，您应该能够在不同的上下文中重用您的模型，而无需重新实现任何业务逻辑。

在每种情况下，我都认为授权、输入验证和审计日志记录*是*非常明确的业务逻辑，因此应该在您的模型中处理。

另一方面，我认为身份验证、加密、加密哈希等*不是*模型的一部分。这些安全方面不是核心业务逻辑的一部分，它们通常是应用程序接口的一部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T18:46:44.883

我不认为将安全逻辑放入模型中是不好的设计。您将业务逻辑放在那里，您可以将安全逻辑视为一种业务逻辑。您当然不希望它全部在控制器或视图中，您希望遵循[瘦控制器、胖模型](http://weblog.jamisbuck.org/2006/10/18/skinny-controller-fat-model)方法。

您的模型应该作为应用程序逻辑的一个内聚块独立存在。您应该能够从 Rails 控制台完全驱动您的模型。此外，在模型中包含安全逻辑可以更轻松地进行单元测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T08:30:45.200

我想说这取决于您的模型是否可以直接访问。如果是，那么肯定应该意识到安全问题，可能通过 mixin，因为这些问题可能与模型的主要问题有些正交。

如果模型应该是不可见的，并且您的控制器中已经有了安全逻辑，那么我会不理会模型。

# php - Rails 部分和模板的 CodeIgniter 或 PHP 等效项

> ID：765845
> 
> 赞同：6
> 
> 时间：2009-04-19T18:27:50.983
> 
> 标签：php, codeigniter, partials

在 CodeIgniter 或核心 PHP 中；是否有相当于 Rails 的视图部分和模板？

部分可以让我在我的视图中渲染另一个视图片段。我可以有一个共同的`navbar.php`观点，我可以指出我的`homepage.php`观点。模板将在一个地方定义 HTML 页面的整体外壳，并让每个视图只填充正文。

我在 CodeIgniter 文档中可以找到的最接近的内容是[Loading multiple views](http://codeigniter.com/user_guide/general/views.html)，其中多个视图在控制器中按顺序呈现。在控制器中规定我的页面的视觉外观似乎很奇怪。（即要移动导航栏，我的设计师必须编辑控制器）。

我一直在寻找堆栈**溢出**的 PHP 方法来实现这一点。我找到[了这个页面](https://stackoverflow.com/questions/761922/can-you-render-a-php-file-into-a-variable)，它讨论了用[ob_start](http://us3.php.net/ob_start)模拟部分。这是 CodeIgniter 中推荐的方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-20T14:11:16.100

我可能违反了一些 MVC 规则，但我总是将我的“片段”放在单独的视图中，并从需要它们的其他视图中加载它们，CodeIgniter 样式。我几乎所有的视图都分别在顶部和底部加载了页眉和页脚视图：

```
<? $this->load->view( "header" ); ?>
//Page content...
<? $this->load->view( "footer" ); ?> 
```

然后，标题可以以相同的方式包含 NavBar，等等。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-20T06:23:55.037

这基本上就是我使用的：

```
function render_partial($file, $data = false, $locals = array()) {
    $contents = '';

    foreach($locals AS $key => $value) {
        ${$key} = $value;
    }

    ${$name . '_counter'} = 0;
    foreach($data AS $object) {
        ${$name} = $object;

        ob_start();
        include $file;
        $contents .= ob_get_contents();
        ob_end_clean();

        ${$name . '_counter'}++;
    }

    return $contents;
} 
```

这允许你调用类似的东西：

```
render_partial('/path/to/person.phtml', array('dennis', 'dee', 'mac', 'charlie'), array('say_hello' => true)); 
```

在 /path/to/person.phtml 中有：

```
<?= if($say_hello) { "Hello, " } ?><?= $person ?> (<?= $person_counter ?>) 
```

这是一些正在发生的魔法，尽管它可以帮助您更好地了解正在发生的事情。完整文件：[view.class.php](http://vh1.cjb.net/gitweb/?p=gko.git;a=blob;f=core/lib/view.class.php;h=12ea5023ebbfaf16b41d10686a86c19796be198c;hb=HEAD)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-19T20:19:33.913

在 PHP 中你会使用[`include`](http://www.php.net/function.include)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T03:20:48.337

我发现自己也从 Rails 迁移到 CI，而我对部分所做的基本上是将视图中的部分渲染为变量并从控制器设置它。

所以在视图中你会有类似（_partial.php）的东西：

```
<h2>Here Comes The Partials</h2>
<?= $some_partials ?> 
```

您可以从控制器中设置它，例如：

```
$this->load->view('the_view', 
   array('some_partials', 
         $this->load->view('_partial', array(), TRUE)
   )
); 
```

个人比较喜欢用CI的view而不是ob_start，不过就是我=） PS：加载view的时候，第一个参数是视图名，第二个是要传递给视图的参数，第三个是“ECHO” flag，它基本上告诉 CI 是直接渲染它还是返回视图的值，这基本上是我在示例中所做的。

我认为这不是一个好的解决方案，但它对我有用。有人有更好的解决方案吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-12-31T09:08:52.800

我最近发布的[模板库](http://philsturgeon.co.uk/news/2009/12/CodeIgniter-Template-library)就是这样工作的。

该模板库还可以很好地与我的[Dwoo 实现](http://philsturgeon.co.uk/news/2009/11/Give-CodeIgniters-Parser-library-more-kick-with-Dwoo)配合使用，这将为您的视图提供更多功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-19T18:59:00.580

不幸的是，这根本不是 CodeIgniter 特有的，但是我建议你看看[Savant3](http://phpsavant.com/)模板系统。它允许您将模板呈现为字符串。然后你可以简单地把它粘在你想要的任何地方。

也许在 CodeIgniter 中有类似的东西？

我可以想办法在渲染视图时添加一个工具，渲染模板，然后渲染它包含的所有子模板。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-20T03:46:35.600

CodeIgniter 和 Smarty 配合得很好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-29T03:34:03.453

这是一篇博客文章，描述了如何将[smarty 与 codeigniter](http://www.nirandas.com/blog/index.php/using-smarty-with-codeigniter/)一起使用。asp.net 之类的母版页也实现了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-02-10T04:12:17.437

试用 Ocular - [http://codeigniter.com/wiki/Ocular_Layout_Library/](http://codeigniter.com/wiki/Ocular_Layout_Library/) - 它是一个受 Rails 启发的模板库。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-02-02T08:43:53.107

您可以检查它，以获取部分和模板

```
 http://code.google.com/p/ocular/wiki/Introduction 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-04-19T18:57:28.167

Symfony 通过他们的[部分/组件](http://www.symfony-project.org/book/1_2/07-Inside-the-View-Layer#chapter_07_code-fragments)设置来做到这一点。

# unix - unixFreeBSD 中的块分配

> ID：765848
> 
> 赞同：0
> 
> 时间：2009-04-19T18:28:12.793
> 
> 标签：unix

来自**FreeBSD UNIX** (Galvin)，

> 假设数据以 1 KB 字节的传输大小写入文件，文件系统的块和片段大小为 4 KB 和 512 字节。文件系统将分配一个 1 KB 的片段来包含第一次传输的数据。下一次传输将导致分配一个新的 2 KB 片段。必须将原始片段中的数据复制到这个新片段中，然后进行第二次 1 KB 传输。分配例程确实会尝试在磁盘上紧跟现有片段之后找到所需的空间，因此不需要复制，但如果它们不能这样做，则在片段成为块之前可能需要多达七个副本。已经为程序提供了发现文件块大小的规定，以便可以进行该大小的传输，以避免片段重新复制。

你能解释一下作者在这里想说什么吗？为什么不应该分配一个 4 kB 的块来写入，然后分配一个 512 字节的片段？作者正在谈论 UNIX 中的通用文件系统。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T18:40:00.923

FreeBSD 文件系统显然正在做一些适度巧妙的特殊处理，以防止“小文件占用太多空间，因为每个文件都使用一个磁盘块”问题，该问题曾经在磁盘变大后困扰 unix 机器，但文件系统仍然存在80 年代。

*这很好。*

但是，如果您将一个中到大的文件分成小块编写，您可以欺骗文件系统以一种浪费的方式使用“小文件”hack。

*这是不好的。而且慢。在固态“磁盘”设备上也很难。*

如果您将中型文件写入至少与磁盘块一样大的卡盘中的大文件，则不会调用“小文件”hack。而且这些问题都没有发生。

*这个更好。*

# database-design - 您是否为涉及子节点的多个父节点的分层数据建模扩展了嵌套集？你有什么经验？

> ID：765854
> 
> 赞同：5
> 
> 时间：2009-04-19T18:29:48.840
> 
> 标签：database-design, nested-sets

我希望在我即将进行的一个项目中使用这个概念。

更多信息：[在 MySQL 中管理分层数据](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)。

请用例子分享你的经验好坏。

我正在添加更多信息以使其更广泛：

我有可以有多个父项的子项（例如：一个用户可以属于城市，也可以属于一个名为 UserDefinedRegion 的组），典型的分层模型不支持，无论是邻接列表还是嵌套集。

为了清楚起见，我在此处粘贴用例：

* * *

背景：目前系统有一个固定的层次结构，即州->县->市->用户

1.  销售经理登录系统并创建一个新组，该组可以与市或县处于同一级别。

2.  销售经理登录系统并创建一个新组，该组可以位于州和县或县和市之间。

3.  一旦销售经理创建了组，他应该能够在第二天在他的仪表板中查看所有必要的报告。

* * *

正如你所看到的，第二点可以很容易地通过嵌套集合来完成，但不是第一点，它将为同一个子节点引入新的父节点。

到目前为止，stackOverflow 用户提出了以下解决方案：

1.  网络数据库支持的网络节点结构。
2.  有向无环图。

我肯定在寻找 RDBMS 解决方案。在现实生活中，似乎没有多少人在分层数据模型中遇到多个父节点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T20:36:15.543

正如您在引用的文章中指出的那样，您对多个父母的要求立即违反了嵌套集的基本性质，所以我会说您一开始就会遇到麻烦。由于您将使用关系数据库，它（使用它的核心功能）将处理您迄今为止描述的所有内容，我认为只需在该概念框架中工作并提高您的技能将提供您需要的一切，而无需添加额外的抽象（至少在这种情况下）不要增加任何价值。

如果你还想去那里，我称之为网络节点结构。[这是一个参考](http://c2.com/cgi/wiki?HierarchicalDatabase)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T19:48:43.380

由于您可能会为某些操作使用存储过程，因此请确保它们的性能确实足以满足您的需求！根据我的经验，如果您使用 MySQL，这可能是一个问题。

关于新要求（多个父母）：您现在在使用 RDBMS 时会遇到更多问题，具体取决于您需要针对数据运行哪种查询。我在[此 wiki 页面](http://wiki.neo4j.org/content/Roles)上将RDBMS 方法与使用**图形数据库**进行了比较。如果您只对 RDBMS 方法感兴趣，请查看[A Model to Represented Directed Acyclic Graphs (DAG) on SQL Databases](http://www.codeproject.com/KB/database/Modeling_DAGs_on_SQL_DBs.aspx)。

# sql - 你问的 TSQL 面试问题

> ID：765857
> 
> 赞同：19
> 
> 时间：2009-04-19T18:31:01.567
> 
> 标签：sql, sql-server, tsql

谷歌搜索出现了一些指向 tsql 问题的链接。我想知道 SO 专家在接受 TSQL 采访时会问什么。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-19T18:46:06.743

以下是我作为一名拥有强大 SQL Server 技能的 ASP.Net 开发人员被问到的一些最常见的问题：

*   命名并描述不同类型的 JOIN
*   什么是 COALESCE？
*   解释主键和外键
*   您将如何优化运行缓慢的查询？
*   删除和截断有什么区别？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-20T13:16:52.843

这里有一堆问题：[SQL Server 测验，你能回答所有这些吗？](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/sql-server-quiz-can-you-answer-all-these)

一个大问题当然是您如何编写代码以最大程度地减少死锁

以下面的代码为例，80% 的人都搞错了

下面的输出会是什么？

```
SELECT 3/2 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T19:13:34.103

在 SQL 查询部分（扩展 DOK）：

*   您将如何处理*NULL*问题？（即*NULL* - 25 = ？）
*   *SELECT中**CASE*的变化（优点/缺点）
**   用户函数与存储过程性能*   .NET/SQL 集成（优点/缺点）*   您将如何以及为什么链接 SQL 查询？（通过上帝查询、视图、存储过程等）*

 ** * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-22T05:06:20.387

部分建议列表：

*   获得你遇到过的最糟糕的 SQL，并让候选人尽可能多地解释它的错误

*   询问他们如何获得他们编写的 tsql 的查询计划，以及在查询计划中要避免哪些事情（以及如果确实弹出他们将如何纠正它们）；看看他们是否知道全表或索引扫描是什么

*   询问他们是否了解服务器优化器的工作原理以及这对他们编写的 tsql 有何影响

*   询问他们何时使用 tempdb 的示例

*   看看他们是否知道哪些 sql 子句会在幕后强制使用 tempdb；看看他们是否知道为什么这很重要

*   询问他们什么时候最好不要使用游标的例子

*   询问他们如何确保更新到位；询问他们哪些供应商支持该功能以及哪些将更新实现为删除/插入

*   让他们解释为什么在代码中使用 select * 是不好的做法

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T13:51:38.503

命名 TRANSACTION ISOLATION LEVEL's 解释它们中的每一个，哪个是默认的？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T12:16:16.233

以下是我可以提出的一些问题。

*   如何在不使用[Row_Number()](http://msdn.microsoft.com/en-us/library/ms186734.aspx)函数的情况下实现 Row_Number。
*   如何计算运行总和
*   如何转置记录 - 旋转。
*   `WHERE`过滤子句中的 NULL 记录
*   条件记录排序和过滤

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-19T19:24:28.117

我总是问程序员（不是真正的数据库程序员，而是应该能够编写 DAL 的程序员）

“说明相关的子查询和不相关的子查询之间的区别”

我知道对于了解 sql 的一两件事的人来说，这听起来很容易，但令我惊讶的是，只有不到 50% 的人做对了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-05-20T09:07:45.057

WHERE 子句和 HAVING 子句有什么区别？

这是一个看似简单的问题，很多人都会出错，听他们尝试回答会让你对他们对分组的理解有所了解。

# xul - 如何使用自定义相对路径为 xulrunner 应用程序设置配置文件目录？

> ID：765861
> 
> 赞同：4
> 
> 时间：2009-04-19T18:35:24.287
> 
> 标签：xul, xulrunner, portable-applications

有没有一种简单的方法来创建跨平台可移植 Xulrunner 应用程序？

我所说的“便携”是指[http://portableapps.com/](http://portableapps.com/)上的人所做的，但除此之外，我希望能够在我需要的任何平台运行时都放在闪存棒上。

例如，如果我希望我的应用程序在 Linux 上运行，我将 Xulrunner 的 linux 构建和我的 xulrunner 应用程序放在一起。如果我希望我的应用程序在 Windows 上运行，我还会放置 Xulrunner 的 Windows 版本等。

然后，最终用户将能够根据他/她使用的计算机上安装的平台运行相同的应用程序。一切都很好，假设我决定如何组织文件等。

问题出现在应用程序运行时。它在当前计算机上找到默认配置文件目录并使用它（NO PORTABLE）。配置文件目录应该在闪存棒上。

我在命令行上尝试了以下操作：

```
#After setting the following in my application.ini
[XRE]
EnableProfileMigrator=1
#and providing the branding information for the profilemanager

~/my/app$ ~/opt/xulrunner/1.9.0.7/xulrunner application.ini -P 
```

但这只会启动配置文件管理器

创建配置文件后，我尝试使用以下命令运行应用程序：

```
~/my/app$ ~/opt/xulrunner/1.9.0.7/xulrunner application.ini \
-profile ../../../opt/xulrunner/j2b59nt8.default 
```

现在它似乎工作了，但仍然不够。所以我的问题应该是： *如何使用自定义相对路径为 xulrunner 应用程序设置配置文件目录？*

*任何见解？* 谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T20:21:49.850

确认的 ：）

[http://kb.mozillazine.org/Starting_your_Mozilla_application_with_a_specified_profile#Bypassing_the_Profile_Manager](http://kb.mozillazine.org/Starting_your_Mozilla_application_with_a_specified_profile#Bypassing_the_Profile_Manager) 现在我只需要创建一个查找所需路径并运行 xulrunner 的 louncher（已编译的 exe）

# .net - 如何移动数组元素

> ID：765863
> 
> 赞同：1
> 
> 时间：2009-04-19T18:36:18.310
> 
> 标签：.net, arrays, shift

我有一个 n = 32 项的数组，其中包含正值和负值。第一个 n/2 元素是正数并按值排序，第二个 n/2 元素是负数并按值排序。我想按值对整个数组进行排序，从最小的负值到最大的正值，这意味着如果有 32 个元素，则前 16 个（n/2）排序元素应包含原始数组的后 16 个元素的值排序数组的后 16 个元素应包含原始数组的前 16 个值。

假设示例：

```
double[] original = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, -16, -15, ..., -1};

double[] sorted = {-16, -15, ...., -1, 1, 2, ..., 16}; 
```

有谁知道将元素转换为从原始生成排序数组的最佳方法是什么？

顺便说一下，这个数组与另一个数组相关联，该数组没有按大小排序的元素相同的方式，并且必须以与原始相同的方式移动，因此数组不应该按大小排序，**它必须被移动**。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-19T18:44:52.580

因此，您想要第二个数组，其中包含原始内容但位置已移动？要么明确地做到这一点：

```
double[] result = new double[32];
for (int i=0; i < 32; i++)
{
    result[(i+16)%32] = original[i];
} 
```

或使用`Array.Copy`两次：

```
double[] result = new double[32];
Array.Copy(original, 0, result, 16, 16);
Array.Copy(original, 16, result, 0, 16); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T19:07:19.343

鉴于问题的刚性性质，`Array.Copy`：

```
 int half = original.Length / 2;
        Array.Copy(original, 0, sorted, half, half);
        Array.Copy(original, half, sorted, 0, half); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T18:58:08.413

在Linq怎么样：

```
int half = original.Length/2;
var sorted = original.Skip(half).Concat(original.Take(half)).ToArray(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T18:38:06.793

只需对元素 0 和元素 16、1 和 17、2 和 18 等进行交换即可。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-19T18:40:43.590

你有没有尝试过：

```
Array.Sort(original); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-19T19:02:19.340

您想根据另一个相同大小的数组中包含的值对一个数组进行排序吗？如果是这样，请使用以下内容：

```
Array.Sort(keys, values); 
```

这是文档[Array.Sort(Array keys, Array items)](http://msdn.microsoft.com/en-us/library/85y6y2d3.aspx#Mtps_DropDownFilterText)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-17T16:04:23.987

Jon Skeet 和 Marc Gravell♦ 的答案提供了正确的解决方案，但如果您不想分配额外的数组，您可以：

a）解决您的具体问题（将第二半移到第一半之前）：

```
private void Rotate1(double[] toRotate ) {
        int startOf2nd = toRotate.Length / 2;
        for (int i=0; i < toRotate.Length/2; i++) {
            double temp = toRotate [i];
            toRotate [i] = toRotate [i + startOf2nd];
            toRotate [i + startOf2nd] = temp;
        }
    } 
```

请注意，此代码无法处理包含奇数项的数组。

b）您可以应用我从 Jon Bentley 的“Programming Pearls”中知道的矢量移位算法：

```
 private void Rotate2(double[] toRotate, int index ) {
        Array.Reverse(toRotate, 0, index);
        Array.Reverse(toRotate, index, toRotate.Length-index);
        Array.Reverse(toRotate, 0, toRotate.Length);
    } 
```

在您的示例中，索引为 16。此代码处理奇数个项目，并且索引不在中间。使用类似于书中使用的示例 toRotate={0,1,2,3,4,5,6,7} 和 index = 3 *Rotate2*将产生 {3,4,5,6,7,0 ,1,2}。

# sql-server - SQL Server DB 中所有索引和索引列的列表

> ID：765867
> 
> 赞同：383
> 
> 时间：2009-04-19T18:38:24.623
> 
> 标签：sql-server, tsql, indexing, reverse-engineering

如何获取 SQL Server 2005+ 中所有索引和索引列的列表？我能得到的最接近的是：

```
select s.name, t.name, i.name, c.name from sys.tables t
inner join sys.schemas s on t.schema_id = s.schema_id
inner join sys.indexes i on i.object_id = t.object_id
inner join sys.index_columns ic on ic.object_id = t.object_id
inner join sys.columns c on c.object_id = t.object_id and
        ic.column_id = c.column_id

where i.index_id > 0    
 and i.type in (1, 2) -- clustered & nonclustered only
 and i.is_primary_key = 0 -- do not include PK indexes
 and i.is_unique_constraint = 0 -- do not include UQ
 and i.is_disabled = 0
 and i.is_hypothetical = 0
 and ic.key_ordinal > 0

order by ic.key_ordinal 
```

这不正是我想要的。
我想要的是，列出所有用户定义的索引（*这意味着没有支持唯一约束和主键*的索引）以及所有列（按它们在索引定义中的出现方式排序）以及尽可能多的元数据。

* * *

## 回答 #1

> 赞同：675
> 
> 时间：2009-04-19T18:59:42.187

您可以查阅两个“sys”目录视图：`sys.indexes`和`sys.index_columns`.

这些将为您提供您可能想要的有关索引及其列的任何信息。

编辑：此查询非常接近您要查找的内容：

```
SELECT 
     TableName = t.name,
     IndexName = ind.name,
     IndexId = ind.index_id,
     ColumnId = ic.index_column_id,
     ColumnName = col.name,
     ind.*,
     ic.*,
     col.* 
FROM 
     sys.indexes ind 
INNER JOIN 
     sys.index_columns ic ON  ind.object_id = ic.object_id and ind.index_id = ic.index_id 
INNER JOIN 
     sys.columns col ON ic.object_id = col.object_id and ic.column_id = col.column_id 
INNER JOIN 
     sys.tables t ON ind.object_id = t.object_id 
WHERE 
     ind.is_primary_key = 0 
     AND ind.is_unique = 0 
     AND ind.is_unique_constraint = 0 
     AND t.is_ms_shipped = 0 
ORDER BY 
     t.name, ind.name, ind.index_id, ic.is_included_column, ic.key_ordinal; 
```

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2012-04-27T05:55:22.747

您可以使用`sp_helpindex`来查看一张表的所有索引。

```
EXEC sys.sp_helpindex @objname = N'User' -- nvarchar(77) 
```

而对于所有的索引，你可以遍历`sys.objects`得到每个表的所有索引。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2010-11-28T21:31:48.560

以上都没有为我做这项工作，但这确实：

```
-- KDF9's concise index list for SQL Server 2005+  (see below for 2000)
--   includes schemas and primary keys, in easy to read format
--   with unique, clustered, and all ascending/descendings in a single column
-- Needs simple manual add or delete to change maximum number of key columns
--   but is easy to understand and modify, with no UDFs or complex logic
--
SELECT
  schema_name(schema_id) as SchemaName, OBJECT_NAME(si.object_id) as TableName, si.name as IndexName,
  (CASE is_primary_key WHEN 1 THEN 'PK' ELSE '' END) as PK,
  (CASE is_unique WHEN 1 THEN '1' ELSE '0' END)+' '+
  (CASE si.type WHEN 1 THEN 'C' WHEN 3 THEN 'X' ELSE 'B' END)+' '+  -- B=basic, C=Clustered, X=XML
  (CASE INDEXKEY_PROPERTY(si.object_id,index_id,1,'IsDescending') WHEN 0 THEN 'A' WHEN 1 THEN 'D' ELSE '' END)+
  (CASE INDEXKEY_PROPERTY(si.object_id,index_id,2,'IsDescending') WHEN 0 THEN 'A' WHEN 1 THEN 'D' ELSE '' END)+
  (CASE INDEXKEY_PROPERTY(si.object_id,index_id,3,'IsDescending') WHEN 0 THEN 'A' WHEN 1 THEN 'D' ELSE '' END)+
  (CASE INDEXKEY_PROPERTY(si.object_id,index_id,4,'IsDescending') WHEN 0 THEN 'A' WHEN 1 THEN 'D' ELSE '' END)+
  (CASE INDEXKEY_PROPERTY(si.object_id,index_id,5,'IsDescending') WHEN 0 THEN 'A' WHEN 1 THEN 'D' ELSE '' END)+
  (CASE INDEXKEY_PROPERTY(si.object_id,index_id,6,'IsDescending') WHEN 0 THEN 'A' WHEN 1 THEN 'D' ELSE '' END)+
  '' as 'Type',
  INDEX_COL(schema_name(schema_id)+'.'+OBJECT_NAME(si.object_id),index_id,1) as Key1,
  INDEX_COL(schema_name(schema_id)+'.'+OBJECT_NAME(si.object_id),index_id,2) as Key2,
  INDEX_COL(schema_name(schema_id)+'.'+OBJECT_NAME(si.object_id),index_id,3) as Key3,
  INDEX_COL(schema_name(schema_id)+'.'+OBJECT_NAME(si.object_id),index_id,4) as Key4,
  INDEX_COL(schema_name(schema_id)+'.'+OBJECT_NAME(si.object_id),index_id,5) as Key5,
  INDEX_COL(schema_name(schema_id)+'.'+OBJECT_NAME(si.object_id),index_id,6) as Key6
FROM sys.indexes as si
LEFT JOIN sys.objects as so on so.object_id=si.object_id
WHERE index_id>0 -- omit the default heap
  and OBJECTPROPERTY(si.object_id,'IsMsShipped')=0 -- omit system tables
  and not (schema_name(schema_id)='dbo' and OBJECT_NAME(si.object_id)='sysdiagrams') -- omit sysdiagrams
ORDER BY SchemaName,TableName,IndexName

-------------------------------------------------------------------
-- or to generate creation scripts put a simple wrapper around that
SELECT SchemaName, TableName, IndexName,
  (CASE pk
    WHEN 'PK' THEN 'ALTER '+
     'TABLE '+SchemaName+'.'+TableName+' ADD CONSTRAINT '+IndexName+' PRIMARY KEY'+
     (CASE substring(Type,3,1) WHEN 'C' THEN ' CLUSTERED' ELSE '' END)
    ELSE 'CREATE '+
     (CASE substring(Type,1,1) WHEN '1' THEN 'UNIQUE ' ELSE '' END)+
     (CASE substring(Type,3,1) WHEN 'C' THEN 'CLUSTERED ' ELSE '' END)+
     'INDEX '+IndexName+' ON '+SchemaName+'.'+TableName
    END)+
  ' ('+
    (CASE WHEN Key1 is null THEN '' ELSE      Key1+(CASE substring(Type,4+1,1) WHEN 'D' THEN ' DESC' ELSE '' END) END)+
    (CASE WHEN Key2 is null THEN '' ELSE ', '+Key2+(CASE substring(Type,4+2,1) WHEN 'D' THEN ' DESC' ELSE '' END) END)+
    (CASE WHEN Key3 is null THEN '' ELSE ', '+Key3+(CASE substring(Type,4+3,1) WHEN 'D' THEN ' DESC' ELSE '' END) END)+
    (CASE WHEN Key4 is null THEN '' ELSE ', '+Key4+(CASE substring(Type,4+4,1) WHEN 'D' THEN ' DESC' ELSE '' END) END)+
    (CASE WHEN Key5 is null THEN '' ELSE ', '+Key5+(CASE substring(Type,4+5,1) WHEN 'D' THEN ' DESC' ELSE '' END) END)+
    (CASE WHEN Key6 is null THEN '' ELSE ', '+Key6+(CASE substring(Type,4+6,1) WHEN 'D' THEN ' DESC' ELSE '' END) END)+
    ')' as CreateIndex
FROM (
  ...
  ...listing SQL same as above minus the ORDER BY...
  ...
  ) as indexes
ORDER BY SchemaName,TableName,IndexName

----------------------------------------------------------
-- For SQL Server 2000 the following should work
--   change table names to sysindexes and sysobjects (no dots)
--   change object_id => id, index_id => indid,
--   change is_primary_key => (select count(constid) from sysconstraints as sc where sc.id=si.id and sc.status&15=1)
--   change is_unique => INDEXPROPERTY(si.id,si.name,'IsUnique')
--   change si.type => INDEXPROPERTY(si.id,si.name,'IsClustered')
--   remove all references to schemas including schema name qualifiers, and the XML type
--   add select where indid<255 and si.status&64=0 (to omit the text/image index and autostats) 
```

如果您的名称包含空格，请在创建脚本中在它们周围添加方括号。

当最后一个 Key 列全部为空时，您知道没有丢失任何内容。

在原始请求中过滤掉主键等是微不足道的。

注意：请注意此解决方案，因为它不区分索引列和包含列。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2009-06-23T20:09:55.643

——短而甜：

```
SELECT OBJECT_SCHEMA_NAME(T.[object_id],DB_ID()) AS [Schema],  
  T.[name] AS [table_name], I.[name] AS [index_name], AC.[name] AS [column_name],  
  I.[type_desc], I.[is_unique], I.[data_space_id], I.[ignore_dup_key], I.[is_primary_key], 
  I.[is_unique_constraint], I.[fill_factor],    I.[is_padded], I.[is_disabled], I.[is_hypothetical], 
  I.[allow_row_locks], I.[allow_page_locks], IC.[is_descending_key], IC.[is_included_column] 
FROM sys.[tables] AS T  
  INNER JOIN sys.[indexes] I ON T.[object_id] = I.[object_id]  
  INNER JOIN sys.[index_columns] IC ON I.[object_id] = IC.[object_id] 
  INNER JOIN sys.[all_columns] AC ON T.[object_id] = AC.[object_id] AND IC.[column_id] = AC.[column_id] 
WHERE T.[is_ms_shipped] = 0 AND I.[type_desc] <> 'HEAP' 
ORDER BY T.[name], I.[index_id], IC.[key_ordinal] 
```

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2015-06-15T22:03:43.757

以下适用于 SQL Server 2014/2016 以及任何 Microsoft Azure SQL 数据库。

生成可轻松导出到记事本/Excel 以进行切片和切块的综合结果集，包括

> 1.  表名
> 2.  索引名称
> 3.  索引 说明
> 4.  索引列 - 按顺序
> 5.  包含的列 - 按顺序

```
 SELECT '[' + s.NAME + '].[' + o.NAME + ']' AS 'table_name'
    ,+ i.NAME AS 'index_name'
    ,LOWER(i.type_desc) + CASE 
        WHEN i.is_unique = 1
            THEN ', unique'
        ELSE ''
        END + CASE 
        WHEN i.is_primary_key = 1
            THEN ', primary key'
        ELSE ''
        END AS 'index_description'
    ,STUFF((
            SELECT ', [' + sc.NAME + ']' AS "text()"
            FROM syscolumns AS sc
            INNER JOIN sys.index_columns AS ic ON ic.object_id = sc.id
                AND ic.column_id = sc.colid
            WHERE sc.id = so.object_id
                AND ic.index_id = i1.indid
                AND ic.is_included_column = 0
            ORDER BY key_ordinal
            FOR XML PATH('')
            ), 1, 2, '') AS 'indexed_columns'
    ,STUFF((
            SELECT ', [' + sc.NAME + ']' AS "text()"
            FROM syscolumns AS sc
            INNER JOIN sys.index_columns AS ic ON ic.object_id = sc.id
                AND ic.column_id = sc.colid
            WHERE sc.id = so.object_id
                AND ic.index_id = i1.indid
                AND ic.is_included_column = 1
            FOR XML PATH('')
            ), 1, 2, '') AS 'included_columns'
FROM sysindexes AS i1
INNER JOIN sys.indexes AS i ON i.object_id = i1.id
    AND i.index_id = i1.indid
INNER JOIN sysobjects AS o ON o.id = i1.id
INNER JOIN sys.objects AS so ON so.object_id = o.id
    AND is_ms_shipped = 0
INNER JOIN sys.schemas AS s ON s.schema_id = so.schema_id
WHERE so.type = 'U'
    AND i1.indid < 255
    AND i1.STATUS & 64 = 0 --index with duplicates
    AND i1.STATUS & 8388608 = 0 --auto created index
    AND i1.STATUS & 16777216 = 0 --stats no recompute
    AND i.type_desc <> 'heap'
    AND so.NAME <> 'sysdiagrams'
ORDER BY table_name
    ,index_name; 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2010-04-07T12:44:08.753

我没有通过，但在原作者发布的查询中得到了我想要的。

我使用它（没有条件/过滤器）来满足我的要求，但它给出了不正确的结果

主要问题是**在 index_id 上没有连接条件的情况下得到叉积的结果**

```
SELECT S.NAME SCHEMA_NAME,T.NAME TABLE_NAME,I.NAME INDEX_NAME,C.NAME COLUMN_NAME
  FROM SYS.TABLES T
       INNER JOIN SYS.SCHEMAS S
    ON T.SCHEMA_ID = S.SCHEMA_ID
       INNER JOIN SYS.INDEXES I
    ON I.OBJECT_ID = T.OBJECT_ID
       INNER JOIN SYS.INDEX_COLUMNS IC
    ON IC.OBJECT_ID = T.OBJECT_ID
       INNER JOIN SYS.COLUMNS C
    ON C.OBJECT_ID  = T.OBJECT_ID
   **AND IC.INDEX_ID    = I.INDEX_ID**
   AND IC.COLUMN_ID = C.COLUMN_ID
 WHERE 1=1

ORDER BY I.NAME,I.INDEX_ID,IC.KEY_ORDINAL 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2014-07-15T08:56:32.503

我需要获取特定的索引、它们的索引列以及它们包含的列。这是我使用的查询：

```
SELECT INX.[name] AS [Index Name]
      ,TBL.[name] AS [Table Name]
      ,DS1.[IndexColumnsNames]
      ,DS2.[IncludedColumnsNames]
FROM [sys].[indexes] INX
INNER JOIN [sys].[tables] TBL
    ON INX.[object_id] = TBL.[object_id]
CROSS APPLY 
(
    SELECT STUFF
    (
        (
            SELECT ' [' + CLS.[name] + ']'
            FROM [sys].[index_columns] INXCLS
            INNER JOIN [sys].[columns] CLS 
                ON INXCLS.[object_id] = CLS.[object_id] 
                AND INXCLS.[column_id] = CLS.[column_id]
            WHERE INX.[object_id] = INXCLS.[object_id] 
                AND INX.[index_id] = INXCLS.[index_id]
                AND INXCLS.[is_included_column] = 0
            FOR XML PATH('')
        )
        ,1
        ,1
        ,''
    ) 
) DS1 ([IndexColumnsNames])
CROSS APPLY 
(
    SELECT STUFF
    (
        (
            SELECT ' [' + CLS.[name] + ']'
            FROM [sys].[index_columns] INXCLS
            INNER JOIN [sys].[columns] CLS 
                ON INXCLS.[object_id] = CLS.[object_id] 
                AND INXCLS.[column_id] = CLS.[column_id]
            WHERE INX.[object_id] = INXCLS.[object_id] 
                AND INX.[index_id] = INXCLS.[index_id]
                AND INXCLS.[is_included_column] = 1
            FOR XML PATH('')
        )
        ,1
        ,1
        ,''
    ) 
) DS2 ([IncludedColumnsNames]) 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2011-03-17T14:58:35.810

以下给出了类似于 sp_helpindex*表名的内容*

```
select T.name as TableName, I.name as IndexName, AC.Name as ColumnName, I.type_desc as IndexType 
from sys.tables as T inner join sys.indexes as I on T.[object_id] = I.[object_id] 
   inner join sys.index_columns as IC on IC.[object_id] = I.[object_id] and IC.[index_id] = I.[index_id] 
   inner join sys.all_columns as AC on IC.[object_id] = AC.[object_id] and IC.[column_id] = AC.[column_id] 
order by T.name, I.name 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2017-12-06T12:10:47.823

根据接受的答案和其他两个问题^([1](https://stackoverflow.com/q/451415/87015)、[2](https://stackoverflow.com/q/1456496/87015))我已经组装了以下查询：

```
SELECT
    QUOTENAME(t.name) AS TableName,
    QUOTENAME(i.name) AS IndexName,
    i.is_primary_key,
    i.is_unique,
    i.is_unique_constraint,
    STUFF(REPLACE(REPLACE((
        SELECT QUOTENAME(c.name) + CASE WHEN ic.is_descending_key = 1 THEN ' DESC' ELSE '' END AS [data()]
        FROM sys.index_columns AS ic
        INNER JOIN sys.columns AS c ON ic.object_id = c.object_id AND ic.column_id = c.column_id
        WHERE ic.object_id = i.object_id AND ic.index_id = i.index_id AND ic.is_included_column = 0
        ORDER BY ic.key_ordinal
        FOR XML PATH
    ), '<row>', ', '), '</row>', ''), 1, 2, '') AS KeyColumns,
    STUFF(REPLACE(REPLACE((
        SELECT QUOTENAME(c.name) AS [data()]
        FROM sys.index_columns AS ic
        INNER JOIN sys.columns AS c ON ic.object_id = c.object_id AND ic.column_id = c.column_id
        WHERE ic.object_id = i.object_id AND ic.index_id = i.index_id AND ic.is_included_column = 1
        ORDER BY ic.index_column_id
        FOR XML PATH
    ), '<row>', ', '), '</row>', ''), 1, 2, '') AS IncludedColumns,
    u.user_seeks,
    u.user_scans,
    u.user_lookups,
    u.user_updates
FROM sys.tables AS t
INNER JOIN sys.indexes AS i ON t.object_id = i.object_id
LEFT JOIN sys.dm_db_index_usage_stats AS u ON i.object_id = u.object_id AND i.index_id = u.index_id
WHERE t.is_ms_shipped = 0
AND i.type <> 0 
```

此查询返回如下结果，其中显示了索引列表、它们的列和使用情况。非常有助于确定哪个索引的性能优于其他索引：

[![索引列表、列和用法](https://i.stack.imgur.com/9MW68.png)](https://i.stack.imgur.com/9MW68.png)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-04-20T21:23:00.290

这将起作用：

```
DECLARE @IndexInfo  TABLE (index_name         varchar(250)
                          ,index_description  varchar(250)
                          ,index_keys         varchar(250)
                          )

INSERT INTO @IndexInfo
exec sp_msforeachtable 'sp_helpindex ''?'''
select * from @IndexInfo 
```

这不会重新生成表名，并且您将收到所有没有索引的表的警告，如果这是一个问题，您可以在具有如下索引的表上创建一个循环：

```
DECLARE @IndexInfoTemp  TABLE (index_name         varchar(250)
                              ,index_description  varchar(250)
                              ,index_keys         varchar(250)
                              )

DECLARE @IndexInfo  TABLE (table_name         sysname
                          ,index_name         varchar(250)
                          ,index_description  varchar(250)
                          ,index_keys         varchar(250)
                          )

DECLARE @Tables Table (RowID       int not null identity(1,1)
                      ,TableName   sysname 
                      )
DECLARE @MaxRow       int
DECLARE @CurrentRow   int
DECLARE @CurrentTable sysname

INSERT INTO @Tables
    SELECT
        DISTINCT t.name 
        FROM sys.indexes i
            INNER JOIN sys.tables t ON i.object_id = t.object_id
        WHERE i.Name IS NOT NULL
SELECT @MaxRow=@@ROWCOUNT,@CurrentRow=1

WHILE @CurrentRow<=@MaxRow
BEGIN

    SELECT @CurrentTable=TableName FROM @Tables WHERE RowID=@CurrentRow

    INSERT INTO @IndexInfoTemp
    exec sp_helpindex @CurrentTable

    INSERT INTO @IndexInfo
            (table_name   , index_name , index_description , index_keys)
        SELECT
            @CurrentTable , index_name , index_description , index_keys
        FROM @IndexInfoTemp

    DELETE FROM @IndexInfoTemp

    SET @CurrentRow=@CurrentRow+1

END --WHILE
SELECT * from @IndexInfo 
```

 **如果需要，可以**编辑，您可以过滤数据，这里有一些示例（这些适用于任何一种方法）：****

 **```
SELECT * FROM @IndexInfo WHERE index_description NOT LIKE '%primary key%'
SELECT * FROM @IndexInfo WHERE index_description NOT LIKE '%nonclustered%' AND index_description  LIKE '%clustered%'
SELECT * FROM @IndexInfo WHERE index_description LIKE '%unique%' 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2011-06-15T11:45:58.543

```
with connect(schema_name,table_name,index_name,index_column_id,column_name) as
(   select s.name schema_name, t.name table_name, i.name index_name, index_column_id, cast(c.name as varchar(max)) column_name
 from sys.tables t
inner join sys.schemas s on t.schema_id = s.schema_id
inner join sys.indexes i on i.object_id = t.object_id
inner join sys.index_columns ic on ic.object_id = t.object_id and ic.index_id=i.index_id
        inner join sys.columns c on c.object_id = t.object_id and
                ic.column_id = c.column_id
                where index_column_id=1
union all
select s.name schema_name, t.name table_name, i.name index_name, ic.index_column_id, cast(connect.column_name + ',' + c.name as varchar(max)) column_name
 from sys.tables t
inner join sys.schemas s on t.schema_id = s.schema_id
inner join sys.indexes i on i.object_id = t.object_id
inner join sys.index_columns ic on ic.object_id = t.object_id and ic.index_id=i.index_id
        inner join sys.columns c on c.object_id = t.object_id and
                ic.column_id = c.column_id join connect on
connect.index_column_id+1 = ic.index_column_id
and connect.schema_name = s.name
and connect.table_name = t.name
and connect.index_name = i.name)
select connect.schema_name,connect.table_name,connect.index_name,connect.column_name
from connect join (select schema_name,table_name,index_name,MAX(index_column_id) index_column_id
from connect group by schema_name,table_name,index_name) mx
on connect.schema_name = mx.schema_name
and connect.table_name = mx.table_name
and connect.index_name = mx.index_name
and connect.index_column_id = mx.index_column_id
order by 1,2,3 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-04-19T18:54:51.073

这是一种支持索引的方式。您可以使用 SHOWCONTIG 来评估碎片。它将列出数据库或表的所有索引以及统计信息。我会警告说，在大型数据库上，它可能会长时间运行。对我来说，这种方法的好处之一是您不必成为管理员即可使用它。

--显示数据库中所有索引的碎片信息

```
SET NOCOUNT ON
USE pubs
DBCC SHOWCONTIG WITH ALL_INDEXES
GO 
```

...完成后关闭 NOCOUNT

--显示表上所有索引的碎片信息

```
SET NOCOUNT ON
USE pubs
DBCC SHOWCONTIG (authors) WITH ALL_INDEXES
GO 
```

--显示特定索引的碎片信息

```
SET NOCOUNT ON
USE pubs
DBCC SHOWCONTIG (authors,aunmind)
GO 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2013-12-04T13:53:04.340

我想出了这个，它给了我我需要的确切概述。有帮助的是，您可以为每个索引获取一行，将索引列聚合到该行中。

```
select 
    o.name as ObjectName, 
    i.name as IndexName, 
    i.is_primary_key as [PrimaryKey],
    SUBSTRING(i.[type_desc],0,6) as IndexType,
    i.is_unique as [Unique],
    Columns.[Normal] as IndexColumns,
    Columns.[Included] as IncludedColumns
from sys.indexes i 
join sys.objects o on i.object_id = o.object_id
cross apply
(
    select
        substring
        (
            (
                select ', ' + co.[name]
                from sys.index_columns ic
                join sys.columns co on co.object_id = i.object_id and co.column_id = ic.column_id
                where ic.object_id = i.object_id and ic.index_id = i.index_id and ic.is_included_column = 0
                order by ic.key_ordinal
                for xml path('')
            )
            , 3
            , 10000
        )    as [Normal]    
        , substring
        (
            (
                select ', ' + co.[name]
                from sys.index_columns ic
                join sys.columns co on co.object_id = i.object_id and co.column_id = ic.column_id
                where ic.object_id = i.object_id and ic.index_id = i.index_id and ic.is_included_column = 1
                order by ic.key_ordinal
                for xml path('')
            )
            , 3
            , 10000
        )    as [Included]    

) Columns
where o.[type] = 'U' --USER_TABLE
order by o.[name], i.[name], i.is_primary_key desc 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2014-04-30T21:13:45.050

May I hazard another answer to this saturated question?

This is a liberal reworking of @marc_s answer, mixed with some stuff from @Tim Ford, with the goal of having a bit of a cleaner and simpler result set and final display and ordering for my current need.

```
SELECT 
    OBJECT_SCHEMA_NAME(t.[object_id],DB_ID()) AS [Schema],
    t.[name] AS [TableName], 
    ind.[name] AS [IndexName], 
    col.[name] AS [ColumnName],
    ic.column_id AS [ColumnId],
    ind.[type_desc] AS [IndexTypeDesc], 
    col.is_identity AS [IsIdentity],
    ind.[is_unique] AS [IsUnique],
    ind.[is_primary_key] AS [IsPrimaryKey],
    ic.[is_descending_key] AS [IsDescendingKey],
    ic.[is_included_column] AS [IsIncludedColumn]
FROM 
    sys.indexes ind 
INNER JOIN 
    sys.index_columns ic 
    ON ind.object_id = ic.object_id AND ind.index_id = ic.index_id 
INNER JOIN 
    sys.columns col 
    ON ic.object_id = col.object_id and ic.column_id = col.column_id 
INNER JOIN 
    sys.tables t 
    ON ind.object_id = t.object_id 
WHERE 
    t.is_ms_shipped = 0
    --ind.is_primary_key = 1 -- include or not pks, etc
    --AND ind.is_unique = 0
    --AND ind.is_unique_constraint = 0 
ORDER BY 
    [Schema],
    TableName, 
    IndexName,
    [ColumnId],
    ColumnName 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2019-04-18T08:40:57.467

这是我的，适用于一个默认模式，但可以轻松改进它提供 3 个带有 SQLQueries 的列 - 创建/删除/重建（无重组）

询问：

```
SELECT
'CREATE ' + 
CASE WHEN is_primary_key=1 THEN 'CLUSTERED' 
WHEN is_primary_key=0 and is_unique_constraint=0 THEN 'NONCLUSTERED'
WHEN is_primary_key=0 and is_unique_constraint=1 THEN 'UNIQUE' END  
+ ' INDEX ' +
QUOTENAME(i.name) + ' ON ' +
QUOTENAME(t.name) + ' ( '  + 
STUFF(REPLACE(REPLACE((
        SELECT QUOTENAME(c.name) + CASE WHEN ic.is_descending_key = 1 THEN ' DESC' ELSE '' END AS [data()]
        FROM sys.index_columns AS ic
        INNER JOIN sys.columns AS c ON ic.object_id = c.object_id AND ic.column_id = c.column_id
        WHERE ic.object_id = i.object_id AND ic.index_id = i.index_id AND ic.is_included_column = 0
        ORDER BY ic.key_ordinal
        FOR XML PATH
    ), '<row>', ', '), '</row>', ''), 1, 2, '') + ' ) '  -- keycols
+ COALESCE(' INCLUDE ( ' +
    STUFF(REPLACE(REPLACE((
        SELECT QUOTENAME(c.name) AS [data()]
        FROM sys.index_columns AS ic
        INNER JOIN sys.columns AS c ON ic.object_id = c.object_id AND ic.column_id = c.column_id
        WHERE ic.object_id = i.object_id AND ic.index_id = i.index_id AND ic.is_included_column = 1
        ORDER BY ic.index_column_id
        FOR XML PATH
    ), '<row>', ', '), '</row>', ''), 1, 2, '') + ' ) ',    -- included cols
    '') as [Create],
'DROP INDEX ' + QUOTENAME(i.name) + ' ON ' + QUOTENAME(t.name) as [Drop],
'ALTER INDEX ' + QUOTENAME(i.name)  + ' ON ' +QUOTENAME(t.name) + ' REBUILD ' as [Rebuild]
FROM sys.tables AS t
INNER JOIN sys.indexes AS i ON t.object_id = i.object_id
LEFT JOIN sys.dm_db_index_usage_stats AS u ON i.object_id = u.object_id AND i.index_id = u.index_id
WHERE t.is_ms_shipped = 0
AND i.type <> 0
order by QUOTENAME(t.name), is_primary_key desc 
```

输出

```
Create                                                                                                      Drop                                    Rebuild
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CREATE CLUSTERED INDEX [PK_Table1] ON [Table1] ( [Tab1_ID] )                                                DROP INDEX [PK_Table1] ON [Table1]      ALTER INDEX [PK_Table1] ON [Table1] REBUILD 
CREATE UNIQUE INDEX [IX_Table1_Name] ON [Table1] ( [Tab1_Name] )                                            DROP INDEX [IX_Table1_Name] ON [Table1] ALTER INDEX [IX_Table1_Name] ON [Table1] REBUILD 
CREATE NONCLUSTERED INDEX [IX_Table2] ON [Table2] ( [Tab2_Name], [Tab2_City] )  INCLUDE ( [Tab2_PhoneNo] )  DROP INDEX [IX_Table2] ON [Table2]      ALTER INDEX [IX_Table2] ON [Table2] REBUILD 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2012-04-19T15:40:04.833

基于蒂姆福特代码，这是正确的答案：

```
 select tab.[name]  as [table_name],
         idx.[name]  as [index_name],
         allc.[name] as [column_name],
         idx.[type_desc],
         idx.[is_unique],
         idx.[data_space_id],
         idx.[ignore_dup_key],
         idx.[is_primary_key],
         idx.[is_unique_constraint],
         idx.[fill_factor],
         idx.[is_padded],
         idx.[is_disabled],
         idx.[is_hypothetical],
         idx.[allow_row_locks],
         idx.[allow_page_locks],
         idxc.[is_descending_key],
         idxc.[is_included_column],
         idxc.[index_column_id]

     from sys.[tables] as tab

    inner join sys.[indexes]       idx  on tab.[object_id] =  idx.[object_id]
    inner join sys.[index_columns] idxc on idx.[object_id] = idxc.[object_id] and  idx.[index_id]  = idxc.[index_id]
    inner join sys.[all_columns]   allc on tab.[object_id] = allc.[object_id] and idxc.[column_id] = allc.[column_id]

    where tab.[name] Like '%table_name%'
      and idx.[name] Like '%index_name%'
    order by tab.[name], idx.[index_id], idxc.[index_column_id] 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2011-06-16T06:59:56.263

在甲骨文中

```
select CONNECYBY.SCHEMA_NAME,CONNECYBY.TABLE_NAME,CONNECYBY.INDEX_NAME,CONNECYBY.COLUMN_NAME
from (  select TABLE_OWNER SCHEMA_NAME,TABLE_NAME,INDEX_NAME,COLUMN_POSITION,trim(',' from sys_connect_by_path(COLUMN_NAME,',')) COLUMN_NAME
        from DBA_IND_COLUMNS
        start with COLUMN_POSITION = 1
        connect by TABLE_OWNER = prior TABLE_OWNER
        and TABLE_NAME = prior TABLE_NAME
        and INDEX_NAME = prior INDEX_NAME
        and COLUMN_POSITION = prior COLUMN_POSITION + 1) CONNECYBY
join (  select TABLE_OWNER SCHEMA_NAME,TABLE_NAME,INDEX_NAME,max(COLUMN_POSITION) COLUMN_POSITION
        from DBA_IND_COLUMNS
        group by TABLE_OWNER,TABLE_NAME,INDEX_NAME) MAX_CONNECYBY
on (    CONNECYBY.SCHEMA_NAME = MAX_CONNECYBY.SCHEMA_NAME
        and CONNECYBY.TABLE_NAME = MAX_CONNECYBY.TABLE_NAME
        and CONNECYBY.INDEX_NAME = MAX_CONNECYBY.INDEX_NAME
        and CONNECYBY.COLUMN_POSITION = MAX_CONNECYBY.COLUMN_POSITION)
order by CONNECYBY.SCHEMA_NAME,CONNECYBY.TABLE_NAME,CONNECYBY.INDEX_NAME 
```

在 SQL Server 中

```
CONNECTBY(SCHEMA_NAME,TABLE_NAME,INDEX_NAME,INDEX_COLUMN_ID,COLUMN_NAME) 
as 
    (   select SCHEMAS.NAME SCHEMA_NAME
            , TABLES.NAME TABLE_NAME
            , INDEXES.NAME INDEX_NAME
            , INDEX_COLUMNS.INDEX_COLUMN_ID INDEX_COLUMN_ID
            , cast(COLUMNS.NAME AS VARCHAR(MAX)) COLUMN_NAME
        from SYS.INDEXES
        join SYS.TABLES on (INDEXES.OBJECT_ID = TABLES.OBJECT_ID)
        join SYS.SCHEMAS on (TABLES.SCHEMA_ID = SCHEMAS.SCHEMA_ID)
        join SYS.INDEX_COLUMNS on ( INDEXES.OBJECT_ID = INDEX_COLUMNS.OBJECT_ID 
                                    and INDEX_COLUMNS.INDEX_ID = INDEXES.INDEX_ID)
        join SYS.COLUMNS on (   INDEXES.OBJECT_ID = COLUMNS.OBJECT_ID 
                                and INDEX_COLUMNS.COLUMN_ID = COLUMNS.COLUMN_ID)
        where INDEX_COLUMNS.INDEX_COLUMN_ID = 1
        union all
        select SCHEMAS.NAME SCHEMA_NAME
            , TABLES.NAME TABLE_NAME
            , INDEXES.NAME INDEX_NAME
            , INDEX_COLUMNS.INDEX_COLUMN_ID INDEX_COLUMN_ID
            , cast(PRIOR.COLUMN_NAME + ',' + COLUMNS.NAME AS VARCHAR(MAX)) COLUMN_NAME
        from SYS.INDEXES
        join SYS.TABLES on (INDEXES.OBJECT_ID = TABLES.OBJECT_ID)
        join SYS.SCHEMAS on (TABLES.SCHEMA_ID = SCHEMAS.SCHEMA_ID)
        join SYS.INDEX_COLUMNS on ( INDEXES.OBJECT_ID = INDEX_COLUMNS.OBJECT_ID 
                                    and INDEX_COLUMNS.INDEX_ID = INDEXES.INDEX_ID)
        join SYS.COLUMNS on (   INDEXES.OBJECT_ID = COLUMNS.OBJECT_ID 
                                and INDEX_COLUMNS.COLUMN_ID = COLUMNS.COLUMN_ID)
        join CONNECTBY as PRIOR on (SCHEMAS.NAME = PRIOR.SCHEMA_NAME 
                                    and TABLES.NAME = PRIOR.TABLE_NAME 
                                    and INDEXES.NAME = PRIOR.INDEX_NAME 
                                    and INDEX_COLUMNS.INDEX_COLUMN_ID = PRIOR.INDEX_COLUMN_ID + 1))
select CONNECTBY.SCHEMA_NAME,CONNECTBY.TABLE_NAME,CONNECTBY.INDEX_NAME,CONNECTBY.COLUMN_NAME
from CONNECTBY
join (  select  SCHEMA_NAME
                , TABLE_NAME
                , INDEX_NAME
                , MAX(INDEX_COLUMN_ID) INDEX_COLUMN_ID
        from CONNECTBY 
        group by SCHEMA_NAME,TABLE_NAME,INDEX_NAME) MAX_CONNECTBY
        on (CONNECTBY.SCHEMA_NAME = MAX_CONNECTBY.SCHEMA_NAME
            and CONNECTBY.TABLE_NAME = MAX_CONNECTBY.TABLE_NAME
            and CONNECTBY.INDEX_NAME = MAX_CONNECTBY.INDEX_NAME
            and CONNECTBY.INDEX_COLUMN_ID = MAX_CONNECTBY.INDEX_COLUMN_ID)
order by CONNECTBY.SCHEMA_NAME,CONNECTBY.TABLE_NAME,CONNECTBY.INDEX_NAME 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-07-27T12:10:55.733

由于您的个人资料表明您正在使用 .NET，因此您**可以**以编程方式使用服务器托管对象 (SMO)……否则上述任何答案都很棒。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2021-03-30T16:10:08.607

Try this one:

```
EXEC sys.sp_helpindex @objname = 'mytable'; 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2017-02-08T15:38:22.397

下面的查询包括所有列的用户定义索引的所有相关信息（没有唯一约束和主键的索引）：

```
SELECT I.name as IndexName, 
        CASE WHEN I.is_unique = 1 THEN 'Yes' ELSE 'No' END as 'Unique',
        I.type_desc COLLATE DATABASE_DEFAULT as Index_Type,
        '[' + SCHEMA_NAME(T.schema_id) + ']' as 'Schema',
        '[' + T.name + ']' as TableName,
        STUFF((SELECT ', [' + C.name + CASE WHEN IC.is_descending_key = 0 THEN '] ASC' ELSE '] DESC' END
            FROM sys.index_columns IC INNER JOIN sys.columns C ON  IC.object_id = C.object_id  AND IC.column_id = C.column_id
            WHERE IC.is_included_column = 0 AND IC.object_id = I.object_id AND IC.index_id = I.Index_id
            FOR XML PATH('')), 1, 2, '') as Key_Columns,
        Included_Columns, 
        I.filter_definition,
        CASE WHEN I.is_padded = 1 THEN 'ON' ELSE 'OFF' END as PAD_INDEX, 
        CASE WHEN ST.no_recompute = 0 THEN 'OFF' ELSE 'ON' END as [Statistics_Norecompute],
        CONVERT(VARCHAR(5), CASE WHEN I.fill_factor = 0 THEN 100 ELSE I.fill_factor END) as [Fillfactor],
        CASE WHEN I.ignore_dup_key = 1 THEN 'ON' ELSE 'OFF' END as [Ignore_Dup_Key],       
        CASE WHEN I.allow_row_locks = 1 THEN 'ON' ELSE 'OFF' END as [Allow_Row_Locks], 
        CASE WHEN I.allow_page_locks = 1 THEN 'ON' ELSE 'OFF' END [Allow_Page_Locks]        
FROM    sys.indexes I INNER JOIN        
        sys.tables T ON  T.object_id = I.object_id INNER JOIN       
        sys.stats ST ON  ST.object_id = I.object_id AND ST.stats_id = I.index_id INNER JOIN 
        sys.data_spaces DS ON  I.data_space_id = DS.data_space_id INNER JOIN 
        sys.filegroups FG ON  I.data_space_id = FG.data_space_id LEFT OUTER JOIN 
        (SELECT * FROM 
            (SELECT IC2.object_id, IC2.index_id,
                STUFF((SELECT ', ' + C.name FROM sys.index_columns IC1 INNER JOIN 
                    sys.columns C ON C.object_id = IC1.object_id
                        AND C.column_id = IC1.column_id
                        AND IC1.is_included_column = 1
                    WHERE  IC1.object_id = IC2.object_id AND IC1.index_id = IC2.index_id
                    GROUP BY IC1.object_id, C.name, index_id  FOR XML PATH('')
                ), 1, 2, '') as Included_Columns
            FROM sys.index_columns IC2
            GROUP BY IC2.object_id, IC2.index_id) tmp1
            WHERE Included_Columns IS NOT NULL
        ) tmp2
        ON tmp2.object_id = I.object_id AND tmp2.index_id = I.index_id
WHERE I.is_primary_key = 0 AND I.is_unique_constraint = 0; 
```

作为额外的奖励，下面的查询被格式化以写出创建索引和删除索引脚本：

```
SELECT I.name as IndexName, 
        -- Uncommnent line below to include checking for index exists as part of the script
        --'IF NOT EXISTS (SELECT name FROM sysindexes WHERE name = '''+ I.name +''') ' +
        'CREATE ' + CASE WHEN I.is_unique = 1 THEN ' UNIQUE ' ELSE '' END +
        I.type_desc COLLATE DATABASE_DEFAULT + ' INDEX [' +
        I.name + '] ON [' + SCHEMA_NAME(T.schema_id) + '].[' + T.name + '] (' + STUFF(
        (SELECT ', [' + C.name + CASE WHEN IC.is_descending_key = 0 THEN '] ASC' ELSE '] DESC' END
            FROM sys.index_columns IC INNER JOIN sys.columns C ON  IC.object_id = C.object_id  AND IC.column_id = C.column_id
            WHERE IC.is_included_column = 0 AND IC.object_id = I.object_id AND IC.index_id = I.Index_id
            FOR XML PATH('')), 1, 2, '')  + ') ' +
        ISNULL(' INCLUDE (' + IncludedColumns + ') ', '') +
        ISNULL(' WHERE ' + I.filter_definition, '') + 
        'WITH (PAD_INDEX = ' + CASE WHEN I.is_padded = 1 THEN 'ON' ELSE 'OFF' END + 
        ', STATISTICS_NORECOMPUTE = ' + CASE WHEN ST.no_recompute = 0 THEN 'OFF' ELSE 'ON' END + 
        ', SORT_IN_TEMPDB = OFF' + 
        ', FILLFACTOR = ' + CONVERT(VARCHAR(5), CASE WHEN I.fill_factor = 0 THEN 100 ELSE I.fill_factor END) +
        ', IGNORE_DUP_KEY = ' + CASE WHEN I.ignore_dup_key = 1 THEN 'ON' ELSE 'OFF' END +      
        ', ONLINE = OFF' + 
        ', ALLOW_ROW_LOCKS = ' + CASE WHEN I.allow_row_locks = 1 THEN 'ON' ELSE 'OFF' END + 
        ', ALLOW_PAGE_LOCKS = ' + CASE WHEN I.allow_page_locks = 1 THEN 'ON' ELSE 'OFF' END + 
        ') ON [' + DS.name + '];' + CHAR(13) + CHAR(10) + 'GO' as [CreateIndex],
        'DROP INDEX ['+ I.name +'] ON ['+ SCHEMA_NAME(T.schema_id) +'].['+ T.name +'];' +
        CHAR(13) + CHAR(10) + 'GO' AS [DropIndex]
FROM    sys.indexes I INNER JOIN        
        sys.tables T ON  T.object_id = I.object_id INNER JOIN       
        sys.stats ST ON  ST.object_id = I.object_id AND ST.stats_id = I.index_id INNER JOIN 
        sys.data_spaces DS ON  I.data_space_id = DS.data_space_id INNER JOIN 
        sys.filegroups FG ON  I.data_space_id = FG.data_space_id LEFT OUTER JOIN 
        (SELECT * FROM 
            (SELECT IC2.object_id, IC2.index_id,
                STUFF((SELECT ', ' + C.name FROM sys.index_columns IC1 INNER JOIN 
                    sys.columns C ON C.object_id = IC1.object_id
                        AND C.column_id = IC1.column_id
                        AND IC1.is_included_column = 1
                    WHERE  IC1.object_id = IC2.object_id AND IC1.index_id = IC2.index_id
                    GROUP BY IC1.object_id, C.name, index_id  FOR XML PATH('')
                ), 1, 2, '') as IncludedColumns
            FROM sys.index_columns IC2
            GROUP BY IC2.object_id, IC2.index_id) tmp1
            WHERE IncludedColumns IS NOT NULL
        ) tmp2
        ON tmp2.object_id = I.object_id AND tmp2.index_id = I.index_id
WHERE I.is_primary_key = 0 AND I.is_unique_constraint = 0 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2011-10-25T14:04:26.630

首先，请注意所有上述查询可能会遗漏或错误地合并索引的[INCLUDE](http://msdn.microsoft.com/en-us/library/ms190806%28v=SQL.90%29.aspx)列。某些还缺少列的正确排序和/或 ASC/DESC 选项。

乔纳修改了上述查询。顺便说一句，在我使用的许多数据库中，我安装了自己的 CLR CONCATENATE 聚合函数，因此下面的代码取决于存在的类似内容。上面的 SQL 语句简化为更易于维护：

```
SELECT
  s.[name] AS [schema_name]
, t.[name] AS [table_name]
, i.[name] AS [index_name]
, dbo.Concatenate(CASE WHEN ic.[key_ordinal] > 0 AND ic.[is_descending_key] = 1 THEN c.[name] + ' DESC' WHEN key_ordinal > 0 THEN c.[name] ELSE NULL END,',',1) AS [columns]
, dbo.Concatenate(CASE WHEN ic.[is_included_column] = 1 THEN c.[name] ELSE NULL END,',',1) AS [includes]
FROM
  sys.tables t
INNER JOIN
  sys.schemas s ON t.[schema_id] = s.[schema_id]
INNER JOIN
  sys.indexes i ON i.[object_id] = t.[object_id]
INNER JOIN
  sys.index_columns ic ON ic.[object_id] = t.[object_id] AND ic.index_id = i.index_id
INNER JOIN
  sys.columns c ON c.[object_id] = t.[object_id] AND ic.column_id = c.column_id
GROUP BY
  s.[name]
, t.[name]
, i.[name]
ORDER BY
  s.[name]
, t.[name]
, i.[name] 
```

如果您的环境允许向其中添加基于 CLR 的函数，则存在大量[串联聚合。](http://msdn.microsoft.com/en-us/library/ms131056.aspx)

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2015-02-03T18:18:38.677

对于每个索引的唯一列：

```
select s.name, t.name, i.name, i.index_id,c.name,c.column_id
 from sys.schemas s
inner join sys.tables t on t.schema_id = s.schema_id
inner join sys.indexes i on i.object_id = t.object_id
inner join sys.index_columns ic on ic.object_id = t.object_id
    and ic.index_id=i.index_id
inner join sys.columns c on c.object_id = t.object_id 
    and ic.column_id = c.column_id
where i.object_id = object_id('previous.account_1')  
order by index_id,column_id 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2010-04-06T15:00:31.167

这是最好的方法：

```
SELECT sys.tables.object_id, sys.tables.name as table_name, sys.columns.name as column_name, sys.indexes.name as index_name,
sys.indexes.is_unique, sys.indexes.is_primary_key 
FROM sys.tables, sys.indexes, sys.index_columns, sys.columns 
WHERE (sys.tables.object_id = sys.indexes.object_id AND sys.tables.object_id = sys.index_columns.object_id AND sys.tables.object_id = sys.columns.object_id
AND sys.indexes.index_id = sys.index_columns.index_id AND sys.index_columns.column_id = sys.columns.column_id) 
AND sys.tables.name = 'your_table_name'
```

我更喜欢使用隐式连接，因为它更容易理解。您可以删除 object_id 引用，因为您可能不需要它。

干杯。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2018-07-19T05:53:29.263

当我有这个要求时，我使用了以下查询......

```
SELECT 
    TableName = t.name,
    ColumnId = col.column_id, 
    ColumnName = col.name,
    DataType = ty.name,
    MaxSize = ty.max_length,
    IsNullable = CASE WHEN (col.is_nullable = 1) THEN 'Y' END,
    IsIdentity = CASE WHEN (col.is_identity = 1) THEN 'Y' END,
    IsPrimaryKey = CASE WHEN (ic.column_id = col.column_id) THEN 'Y' END,
    IsForeignKey = CASE WHEN (fkc.parent_column_id = col.column_id) THEN 'Y' END,
    IsDefault = CASE WHEN (dc.parent_column_id = col.column_id) THEN 'Y' END
FROM 
    sys.tables t
INNER JOIN 
     sys.columns col ON t.object_id = col.object_id 
LEFT JOIN
    sys.indexes ind ON t.object_id = ind.object_id 
LEFT JOIN 
     sys.index_columns ic ON ic.index_id=ind.index_id AND ic.object_id = col.object_id and ic.column_id = col.column_id
LEFT JOIN sys.foreign_key_columns fkc
                ON fkc.parent_object_id = col.object_id AND fkc.parent_column_id=col.column_id
LEFT JOIN sys.default_constraints dc
                ON dc.parent_object_id = col.object_id AND dc.parent_column_id=col.column_id
LEFT JOIN
     sys.types ty on ty.user_type_id = col.user_type_id

WHERE
    --t.name='<TABLENAME>'
    t.schema_id = 10    --SCHEMA ID
    AND ind.is_primary_key=1    
ORDER BY
    t.name, ColumnId 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2020-06-16T22:47:32.153

我给了 KFD9 的答案一个更新。

[我调整了他们的版本以支持包含规范，并且不使用已弃用](https://docs.microsoft.com/en-us/sql/database-engine/deprecated-database-engine-features-in-sql-server-2016?view=sql-server-ver15)的 indexkey_property

这为您提供了索引和约束的创建和删除语句。

```
with indexes as (
    SELECT
      schema_name(schema_id) as SchemaName, OBJECT_NAME(si.object_id) as TableName, si.name as IndexName,
      (CASE is_primary_key WHEN 1 THEN 'PK' ELSE '' END) as PK,
      (CASE is_unique WHEN 1 THEN '1' ELSE '0' END)+' '+
      (CASE si.type WHEN 1 THEN 'C' WHEN 3 THEN 'X' ELSE 'B' END)+' ' as 'Type',  -- B=basic, C=Clustered, X=XML
      (select string_agg(CAST('[' + c.name + ']' + case when is_descending_key = 1 then ' DESC' else '' end AS NVARCHAR(MAX)), ',') within group (order by index_column_id) 
         from sys.index_columns ic JOIN sys.columns c on ic.column_id = c.column_id and ic.object_id = c.object_id where ic.index_id = si.index_id and ic.object_id = si.object_id and ic.is_included_column = 0) Cols,
      (select string_agg(CAST('[' + c.name + ']' + case when is_descending_key = 1 then ' DESC' else '' end AS NVARCHAR(MAX)), ',') within group (order by index_column_id) 
         from sys.index_columns ic JOIN sys.columns c on ic.column_id = c.column_id and ic.object_id = c.object_id where ic.index_id = si.index_id and ic.object_id = si.object_id and ic.is_included_column = 1) IncludedCols,
      (select count(*) from sys.index_columns ic where ic.index_id = si.index_id and ic.object_id = si.object_id) IndexColsCount
    FROM sys.indexes as si
    LEFT JOIN sys.objects as so on so.object_id=si.object_id
    WHERE index_id>0 -- omit the default heap
      and OBJECTPROPERTY(si.object_id,'IsMsShipped')=0 -- omit system tables
      and not (schema_name(schema_id)='dbo' and OBJECT_NAME(si.object_id)='sysdiagrams') -- omit sysdiagrams
)
SELECT SchemaName, TableName, IndexName,
  (CASE pk
    WHEN 'PK' THEN 'ALTER '+
     'TABLE ['+SchemaName+'].['+TableName+'] ADD CONSTRAINT ['+IndexName+'] PRIMARY KEY'+
     (CASE substring(Type,3,1) WHEN 'C' THEN ' CLUSTERED' ELSE '' END)
    ELSE 'CREATE '+
     (CASE substring(Type,1,1) WHEN '1' THEN 'UNIQUE ' ELSE '' END)+
     (CASE substring(Type,3,1) WHEN 'C' THEN 'CLUSTERED ' ELSE '' END)+
     'INDEX ['+IndexName+'] ON ['+SchemaName+'].['+TableName+']'
    END)+
  ' ('+Cols+')'+
  isnull(' include ('+IncludedCols+')', '')+
  '' as CreateIndex,
    CASE pk
    WHEN 'PK' THEN 'ALTER '+
     'TABLE ['+SchemaName+'].['+TableName+'] DROP CONSTRAINT ['+IndexName+'] '
    ELSE 'DROP INDEX ['+IndexName+'] ON ['+SchemaName+'].['+TableName + ']'
    END AS DropIndex,
    IndexColsCount
FROM indexes
ORDER BY SchemaName,TableName,IndexName 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-03-21T18:10:58.280

使用 SQL Server 2016，这提供了所有索引的完整列表，其中包含每个表的转储，因此您可以查看表之间的关系。它还显示了覆盖索引中包含的列：

```
select t.name TableName, i.name IdxName, c.name ColName
    , ic.index_column_id ColPosition
    , i.type_desc Type
    , case when i.is_primary_key = 1 then 'Yes' else '' end [Primary?]
    , case when i.is_unique = 1 then 'Yes' else '' end [Unique?]
    , case when ic.is_included_column = 0 then '' else 'Yes - Included' end [CoveredColumn?]
    , 'indexes >>>>' [*indexes*], i.*, 'index_columns >>>>' [*index_columns*]
    , ic.*, 'tables >>>>' [*tables*]
    , t.*, 'columns >>>>' [*columns*], c.*
from sys.index_columns ic
join sys.tables t on t.object_id = ic.object_id
join sys.columns c on c.object_id = t.object_id and c.column_id = ic.column_id
join sys.indexes i on i.object_id = t.object_id and i.index_id = ic.index_id
order by TableName, IdxName, ColPosition 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2019-05-13T09:00:21.733

SQL Server 2014 的工作解决方案。我在这里只包含了少数输出字段，但您可以随意添加任意数量的字段。

```
SELECT
    o.object_id AS objectId
    ,o.name AS objectName
    ,i.index_id AS indexId
    ,i.name AS indexName
    ,i.type_desc AS typeDesc
    ,ic.index_column_id AS indexColumnId
    ,ic.key_ordinal AS keyOrdinal
    ,ic.is_included_column AS isIncludedColumn
    ,ic.column_id AS columnId
    ,c.name AS columnName
FROM {database}.sys.objects AS o
    INNER JOIN {database}.sys.columns AS c ON
        c.object_id = o.object_id
        AND o.type = 'U'
    INNER JOIN {database}.sys.indexes AS i ON
        i.object_id = o.object_id
    INNER JOIN {database}.sys.index_columns AS ic ON
        ic.object_id = i.object_id
        AND ic.index_id = i.index_id
        AND ic.column_id = c.column_id
ORDER BY
    o.object_id
    ,i.index_id
    ,ic.index_column_id 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2020-07-06T04:43:31.863

正确的一个在这里（当我们在表上有多个索引时，上述所有帖子都会给出笛卡尔积结果）

```
select s.name, t.name, i.name, c.name from sys.tables t
inner join sys.schemas s on t.schema_id = s.schema_id
inner join sys.indexes i on i.object_id = t.object_id
inner join sys.index_columns ic on ic.object_id = t.object_id 
                                  AND i.index_id = ic.index_id
inner join sys.columns c on c.object_id = t.object_id 
                                  and  ic.column_id = c.column_id
where i.index_id > 0    
 and i.type in (1, 2) -- clustered & nonclustered only
 and i.is_primary_key = 0 -- do not include PK indexes
 and i.is_unique_constraint = 0 -- do not include UQ
 and i.is_disabled = 0
 and i.is_hypothetical = 0
 and ic.key_ordinal > 0
 AND  t.name = 'DimCustomer'
order by ic.key_ordinal 
```

* * *

## 回答 #29

> 赞同：-2
> 
> 时间：2016-12-08T21:53:11.687

```
sELECT 
     TableName = t.name,
     IndexName = ind.name,
     --IndexId = ind.index_id,
     ColumnId = ic.index_column_id,
     ColumnName = col.name,
     key_ordinal,
     ind.type_desc
     --ind.*,
     --ic.*,
     --col.* 
FROM 
     sys.indexes ind 
INNER JOIN 
     sys.index_columns ic ON  ind.object_id = ic.object_id and ind.index_id = ic.index_id 
INNER JOIN 
     sys.columns col ON ic.object_id = col.object_id and ic.column_id = col.column_id 
INNER JOIN 
     sys.tables t ON ind.object_id = t.object_id 
WHERE 
     ind.is_primary_key = 0 
     AND ind.is_unique = 0 
     AND ind.is_unique_constraint = 0 
     AND t.is_ms_shipped = 0 
     and t.name='CompanyReconciliation' --table name
     and key_ordinal>0
ORDER BY 
     t.name, ind.name, ind.index_id, ic.index_column_id 
```

# iphone - 如在 Tumblr 应用程序中所见，在 iPhone 上滚动 UITableView？

> ID：765876
> 
> 赞同：1
> 
> 时间：2009-04-19T18:46:22.280
> 
> 标签：iphone, cocoa-touch, user-interface, uitableview

这个询问对我来说是相当困难的，但无论如何我都会试一试。

我目前正在尝试弄清楚如何将我的 UITableView 设置为在背景上滚动，而不是在他们自己的范围内。我的意思是，如果您查看 Tumblr 应用程序，请在此处截屏：http: [//dl-client.getdropbox.com/u/57676/screenshots/tumblrbg.jpg](http://dl-client.getdropbox.com/u/57676/screenshots/tumblrbg.jpg)，

上面的实际 UITableView 在背景上优雅地滚动，虚线瓷砖。如果有道理的话，整张桌子都会齐声移动。UITableView 在其他情况下滚动时的默认行为看起来更像以下屏幕截图：[http ://dl-client.getdropbox.com/u/57676/screenshots/uitableview.jpg](http://dl-client.getdropbox.com/u/57676/screenshots/uitableview.jpg)

注意到 UITableView 底部大量的空白区域了吗？该屏幕截图是我尽可能向上拖动 UITableView 时拍摄的。而不是最后一个单元格与整个 UITableView 一起拖动，而是创建了底部的偏移量。

我很好奇 Tumblr 应用程序的诀窍是什么，可以让 UITableView 与所有单元格一起滚动，而不会在页眉或页脚中创建丰富的空白（取决于您滚动的垂直方向）。它是位于 UIScrollView 之上的 UITableView 吗？（我知道 UITableView 是 UIScrollView 的子类，所以我认为这将是糟糕的设计）。

感谢您的解决方案，这个解决方案让我陷入困境。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T00:09:16.237

好的，我们开始吧。只是一个快速而肮脏的例子......

[http://www.chrisandtennille.com/code/TableTest.zip](http://www.chrisandtennille.com/code/TableTest.zip)

基本上是 ImageView 之上的 TableView。TableView 的背景设置为透明。

现在，当您提供比默认单元更好的单元时，它会更好地工作。

但你明白了要点。

这不完全是我在 Capsuleer 中使用的方法——我最终编写了自己的表格系统以获得更好的滚动性能以及具有可扩展“部分”的能力。

希望这能让你朝着正确的方向前进。

如果您有任何其他问题，请告诉我，我会尽力提供帮助。

克里斯。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T20:06:55.707

如果我了解您要做什么，只需将 UITableView 的背景设置为清晰并将您的背景放在它后面。

在我放弃 UITableView 并编写自己的应用程序之前，我一直在我的应用程序中这样做。

例如：

[替代文字 http://capsuleer.evesuite.com/images/screenshots/feedlist.jpg](http://capsuleer.evesuite.com/images/screenshots/feedlist.jpg)

EVE 博客包部分下方的扫描线是背景，不会滚动。部分和行在其上方移动。

如果您需要更多细节，请告诉我，我可以举一个例子。

克里斯。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-25T21:28:14.357

这是相当直接的，不需要自定义表。在您的 UITableViewController 子类中，您可以在 loadView 中添加：

```
- (void)loadView {
    [super loadView];
    self.tableView.backgroundColor = [UIColor clearColor];
    self.view.backgroundColor = [UIColor colorWithPatternImage:yourPatternImage];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-08T09:50:27.497

很棒的应用。我正在谷歌上搜索制作一个可以具有可扩展部分的表格视图，并遇到了这篇文章。现在已经超过 5 天了，我正在寻找一个关于制作带有可扩展部分的 tableview 的示例。我什至在应用商店中都找不到这样做的应用程序，我偶然发现了这篇文章。我立即下载了您的应用程序 Capsuleer，我必须说它很棒。作为开发人员，我可以理解您在使组件工作方面所做的辛勤工作那。

如果您能分享使用可扩展部分制作 tableview 的想法，我将非常感谢您。

很棒的应用程序人喜欢 GUI。我不能停止赞美它。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-19T18:58:03.843

[您可以在此处](http://www.iphonedevsdk.com/forum/iphone-sdk-development/5939-safari-like-uiwebview-uiscrollview-uitableview-beyond-bounds-gradient.html)找到示例代码。

# sql-server - 管理更新多个数据库的迁移的最佳实践？

> ID：765891
> 
> 赞同：4
> 
> 时间：2009-04-19T18:59:40.487
> 
> 标签：sql-server, continuous-integration, linked-server, database-migration

我的团队正在评估用于管理数据库迁移/数据库重构的工具和流程，正如 Martin Fowler、Pramod Sadalage 等所描述的那样。人。我们对自动化、可重复、可测试的流程感兴趣，因此我们对每次部署时手动运行 SQL Compare 之类的技术不感兴趣。我们目前正在使用 CruiseControl.NET 进行持续集成。

我们的生产环境有多个 SQL Server 2000 数据库服务器，它们之间具有复制功能。因此，我们的迁移将对源数据库服务器和目标数据库服务器上的模式进行更改。

要使用 dbdeploy 等工具执行此类迁移，我们似乎需要针对其中一台服务器运行迁移，并且必须将其他服务器添加为链接服务器。因此，针对主服务器运行的单个脚本可以针对任何链接服务器执行 DDL。

我的问题是：这种方法会被认为是最佳实践，还是有更好的技术来应用涉及多个数据库服务器的迁移？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T12:30:34.850

Visual Studio 2008（团队版，特别是 GDR）可以根据定义的架构/元数据文件处理架构的自动部署，您可以将其部署到服务器。这可以包含在您的构建/部署过程中。但是，我认为复制和架构更改仍然存在问题 - 没有包可以理解/知道您的复制设置。

例如，我们在订阅者上使用自定义复制过程，尽管模式更改从发布者传播，但我们有时必须根据我们现有的任何自定义复制手动编写更改脚本。如果您不使用自定义复制过程，我会说这是要走的路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T13:25:07.100

我看不出这种方法有什么本质上的错误，但是在设置它时，一定要测试当其中一个链接服务器关闭时会发生什么。如果某个服务器发生故障并且您确实想知道更改未应用于该服务器，您不希望回滚所有其他服务器。

当然，任何迁移的第一个也是最重要的最佳实践是确保在开始迁移更改之前有一个可靠的备份过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-11T13:37:04.473

您可以尝试[Chinchillin](http://code.google.com/p/octalforty-chinchillin/)和[Wizardby](http://code.google.com/p/octalforty-wizardby/)的组合：在 DB 服务器上安装 Chinchillin 代理，并让它在部署过程中执行 Wizardby 迁移脚本。

不过，这种集成正在进行中:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-17T22:04:06.453

在 Red Gate，我们现在有了一个使用 SQL 比较和 SQL 源代码控制的可重复迁移解决方案。因此，SQL 比较命令行可用于支持持续集成过程。

[http://www.red-gate.com/MessageBoard/viewtopic.php?t=14107](http://www.red-gate.com/MessageBoard/viewtopic.php?t=14107)

它目前是早期访问版本，因此我们渴望获得尽可能多的反馈。

# asp.net - 配置错误

> ID：765893
> 
> 赞同：0
> 
> 时间：2009-04-19T19:00:19.890
> 
> 标签：asp.net

错误是什么意思。我设置然后出现这个错误。

> 说明：处理服务此请求所需的配置文件期间发生错误。请查看下面的具体错误详细信息并适当地修改您的配置文件。

解析器错误消息：在应用程序级别之外使用注册为 allowDefinition='MachineToApplication' 的部分是错误的。此错误可能是由未在 IIS 中配置为应用程序的虚拟目录引起的。

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T19:03:40.740

嗯，最明显的解决方案是遵循错误消息：它说它可能是由于虚拟目录未配置为 IIS 中的应用程序造成的。所以去IIS管理控制台，将虚拟目录配置为应用程序。或者，将配置更改为不包括错误消息中提到的部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T19:04:16.963

您需要为您的 ASP.NET 应用程序创建一个虚拟目录，如此[处](http://geekswithblogs.net/ranganh/archive/2005/04/25/37609.aspx)所述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T19:08:19.123

听起来您需要在 IIS 中为您的应用程序创建一个虚拟目录。要在 IIS 6 中执行此操作，请右键单击默认网站并选择新建，然后选择虚拟目录。这将打开一个向导。系统会提示您输入别名，通常是网站的名称。在下一个屏幕上，浏览到 Web 应用程序的根目录。对于访问权限，请确保选中读取和运行脚本。对于执行权限，选择仅脚本。

在 IIS 中配置应用程序还有很多工作要做，但这应该可以帮助您完成初始步骤。

要检查其他配置选项，请右键单击 IIS 中的新网站并选择“属性”。[这是](http://msdn.microsoft.com/en-us/library/aa286507.aspx)帮助您入门的 MSDN 页面。

# regex - 我可以在 VIM 或 Perl 的单个正则表达式中替换多个项目吗？

> ID：765894
> 
> 赞同：28
> 
> 时间：2009-04-19T19:00:57.613
> 
> 标签：regex, perl, vim

假设我有字符串“快速的棕色狐狸跳过懒惰的狗”，我可以用一个正则表达式将其更改为“慢速的棕色狐狸跳过精力充沛的狗”吗？目前，我针对这种情况使用了两组正则表达式。（在这种情况下，我使用`s/quick/slow/`后跟`s/lazy/energetic/`。）

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-04-19T21:05:19.263

您可以使用字典在 vim 中执行此操作：

```
:%s/quick\|lazy/\={'quick':'slow','lazy':'energetic'}[submatch(0)]/g 
```

这将更改以下文本：

> **敏捷**的棕色狐狸**迅速跑到****懒惰**的小溪旁边。

进入：

> **慢条斯理**的棕狐在**活力四射**的小溪旁**慢慢地跑着。**

 **要了解其工作原理，请参阅`:help sub-replace-expression`和`:help Dictionary`。简而言之，

*   `\=`让您替换 vim 表达式的结果。
*   `{'quick':'slow', 'lazy':'energetic'}`是一个`[]`用于查找的 vim 字典（如 perl 或 ruby​​ 中的哈希，或 javascript 中的对象）。
*   `submatch(0)`是匹配的字符串

这在重构代码时会派上用场 - 比如说您想将变量名交换为`foo`,`bar`和`baz`更改

*   `foo`→`bar`
*   `bar`→`baz`
*   `baz`→`foo`

除非您使用临时变量名，否则使用一系列`%s///`命令会很棘手——但您必须确保这些命令不会影响其他任何东西。相反，您可以使用 Dictionary 一次性完成：

```
:%s/\<\%(foo\|bar\|baz\)\>/\={'foo':'bar','bar':'baz','baz':'foo'}[submatch(0)]/g 
```

这会更改此代码

```
int foo = 0;
float bar = pow(2.0, (float) foo);
char baz[256] = {};

sprintf(baz,"2^%d = %f\n", foo, bar); 
```

进入：

```
int bar = 0;
float baz = pow(2.0, (float) bar);
char foo[256] = {};

sprintf(foo,"2^%d = %f\n", bar, baz); 
```

如果您发现自己经常这样做，您可能需要将以下内容添加到您的`~/.vimrc`:

```
" Refactor the given lines using a dictionary
" replacing all occurences of each key in the dictionary with its value
function! Refactor(dict) range
  execute a:firstline . ',' . a:lastline .  's/\C\<\%(' . join(keys(a:dict),'\|'). '\)\>/\='.string(a:dict).'[submatch(0)]/ge'
endfunction

command! -range=% -nargs=1 Refactor :<line1>,<line2>call Refactor(<args>) 
```

这使您可以使用该`:Refactor {'frog':'duck', 'duck':'frog'}`命令，并且比手动为 dict 创建正则表达式的重复性略低。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-04-19T19:08:15.643

替换的第二部分是双引号字符串，因此可以发生任何正常的插值。这意味着您可以使用捕获的值来索引散列：

```
#!/usr/bin/perl

use strict;
use warnings;

my %replace = (
    quick => "slow",
    lazy  => "energetic",
);

my $regex = join "|", keys %replace;
$regex = qr/$regex/;

my $s = "The quick brown fox jumps over the lazy dog";

$s =~ s/($regex)/$replace{$1}/g;

print "$s\n"; 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-05-03T15:43:58.600

您可以连接 vim 替换：

敏捷的棕色狐狸飞快地跑到了懒惰的小溪旁边。

```
:s/quick/slow/|s/lazy/energetic/ 
```

慢条斯理的棕狐迅速跑到了精力充沛的小溪旁边。

这里的好处是您只需键入一次替换

Rgds

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-19T19:06:45.303

您可以执行以下操作。

```
:%s/quick\(.*\)lazy/slow\1energetic 
```

诀窍是使用括号来匹配两个单词之间的文本。然后，您可以使用 . 在替换字符串中引用此文本`\1`。您还可以`\2`用于第二个匹配的括号表达式，依此类推。这使您可以替换多个单词而不会干扰中间的文本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-19T19:31:00.830

在 perl 中：

```
s/quick(.*)lazy/slow${1}energetic/; 
```

在 vim 中：

```
s/quick\(.*\)lazy/slow\1energetic/; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-19T22:57:22.317

Chas 的回答很好，我唯一要提到的另一件事是，如果你正在做单词交换，你可能想要匹配

\b(foo|bar|baz|qux)\b

以避免匹配子字符串。如果您进行了*大量*的单词交换，您可能会开始发现正则表达式有点限制，并且想要执行以下操作：

```
join '', map { exists $subst{$_} ? $subst{$_} : $_ } split /\b/, $string 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-19T19:36:33.033

在 Ruby 中使用带有块的[gsub有一种巧妙的方法：](http://www.ruby-doc.org/core/classes/String.html#M000832)

```
s = "The quick brown fox jumps over the lazy dog"
subs = {'quick' => 'slow', 'lazy' => 'industrious'}
s.gsub(/quick|lazy/) { |match| subs[match] }
# => "The slow brown fox jumps over the industrious dog" 
```

# c# - 亚音速查询 (ConditionA OR ConditionB) AND ConditionC

> ID：765896
> 
> 赞同：3
> 
> 时间：2009-04-19T19:01:51.137
> 
> 标签：c#, subsonic

如何在 Subsonic 中构建这种格式的查询

> （条件 A 或条件 B）与条件 C

我尝试了各种方法，但我似乎无法得到想要的结果。

这是我累的一件事：

```
Query q = Challenge.CreateQuery();
      q.WHERE(Challenge.Columns.ChallengeeKey, playerKey)
      .OR(Challenge.Columns.ChallengerKey, playerKey);
       q.AND(Challenge.Columns.Complete, false); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-19T20:56:44.433

如果您使用 2.2（或 2.1），您可以打开表达式：

```
Northwind.ProductCollection products = new Select(Northwind.Product.Schema)
    .WhereExpression("categoryID").IsEqualTo(5).And("productid").IsGreaterThan(10)
    .OrExpression("categoryID").IsEqualTo(2).And("productID").IsBetweenAnd(2, 5)
    .ExecuteAsCollection<Northwind.ProductCollection>(); 
```

您可以在这里阅读更多内容：http: [//blog.wekeroad.com/subsonic/subsonic-version-21-pakala-preview-the-new-query-tool/](http://blog.wekeroad.com/subsonic/subsonic-version-21-pakala-preview-the-new-query-tool/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T19:22:23.457

如果我没记错的话，这是带有 OR 的 Subsonic “功能”。

将您的查询重构为

```
(ConditionA AND ConditionC) OR (ConditionB AND ConditionC) 
```

在这种情况下，您的 Subsonic 查询如

```
q.WHERE(...).AND(...).OR(...).AND(...) 
```

**编辑：**

[在这里](http://biasecurities.com/blog/2008/complex-sql-conditional-statements-with-subsonic-2-1/)找到一些有趣的东西。主要思想是使用

```
CloseExpression() 
```

标签。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T20:33:55.983

我正在使用 Subsonic 2.2，我尝试了 Rob 示例的一些变体，但一直收到异常消息：“需要指定至少一个来自表”

最终达到了预期的效果：

```
 Challenge challenge = new Select().From(Challenge.Schema)
           .WhereExpression(Challenge.Columns.ChallengerKey).IsEqualTo(playerKey)
           .Or(Challenge.Columns.ChallengerKey).IsGreaterThan(playerKey)
           .AndExpression(Challenge.Columns.Complete).IsEqualTo(false)
           .ExecuteSingle<Challenge>(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-03T14:47:02.833

如果您已经使用 SubSonic3，使用 linq 查询，这很容易：

```
var result = from c in db.Challenges
             where (c.ChallengeeKey == playerKey || c.ChallengerKey == playerKey)
                 && c.Complete == false
             select c; 
```

使用查询工具（正如其他人所提到的） OrExpression / CloseExpression 是为您生成正确查询的正确方法。

# haskell - 如何轻松查看 Template Haskell 语句的输出？

> ID：765902
> 
> 赞同：11
> 
> 时间：2009-04-19T19:03:44.640
> 
> 标签：haskell, metaprogramming, ghc, template-haskell

我的模块中有以下模板 Haskell 代码，它是更大应用程序的一部分。

```
$(derive makeFoldable ''JStatement) 
```

我怀疑生成的 Foldable 实例并不完全是我最初的想法，但我找不到验证这一点的方法。那么，最好只使用`ghci`，是否可以查看生成的实例？

我尝试了以下并得到一个语法错误，我猜这是因为我做错了™。

```
> derive makeFoldable ''JStatement

<interactive>:1:21:
    lexical error in string/character literal at character '\'' 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-19T19:30:53.517

我想到了。如果您传递`-ddump-splices`它，它将在编译模块时将生成的实例打印到终端。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-14T21:42:39.063

GHCi 报告“ `lexical error...`”，因为您没有在 GHCi 会话中激活 Template Haskell。您可以通过`-XTemplateHaskell`命令行或 GHCi 本身来激活它：

```
ghci> :set -XTemplateHaskell 
```

修复此问题后，您应该会收到以下错误：

```
No instance for (Show DecsQ) arising from a use of ‘print’
In a stmt of an interactive GHCi command: print it 
```

现在，您有几个选项可以打印`Q`monad 中的内容：

*   使用（正如[Deniz Dogan 的回答](https://stackoverflow.com/a/765943)`-ddump-splices` 中已经指出的那样）

*   漂亮地打印 GHCi 本身生成的 Haskell 代码：

    ```
    > putStrLn $(stringE . pprint =<< derive makeFoldable ''JStatement)
    instance Foldable (JStatement ...)
      where foldr ... = ... 
    ```

*   显示基于构造函数的实际结构：

    ```
    > putStrLn $(stringE . show =<< derive makeFoldable ''JStatement)
    [InstanceD [] (AppT (ConT Foldable) (... JStatement ...)) [...]] 
    ```

最后两个可以使用 进行简化`runQ`，但这不适用于使用一些模板 Haskell 函数的代码生成，例如`reify`操作。这包括派生包的一些（或者可能是大多数？）派生。

# php - 有没有办法查看当前范围内的所有变量？

> ID：765904
> 
> 赞同：1
> 
> 时间：2009-04-19T19:04:32.923
> 
> 标签：php, scope

标题有点问这一切。我不是指`$_REQUEST`，`$_SERVER`所有的预定义。我只是想知道在我的程序的第 400 行我是否能以某种方式看到到目前为止已创建的所有变量。

**副本：**

*   [如何获取当前范围/符号表中定义的所有变量？](https://stackoverflow.com/questions/717852/php-get-all-variables-defined-in-current-scope-symbol-table)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-19T19:06:31.407

[`get_defined_vars()`](http://si.php.net/manual/en/function.get-defined-vars.php)

# c++ - 我应该担心“条件跳转或移动取决于未初始化的值”吗？

> ID：765913
> 
> 赞同：4
> 
> 时间：2009-04-19T19:10:22.783
> 
> 标签：c++, valgrind, memcheck

如果您使用过 Memcheck（来自 Valgrind），您可能会熟悉此消息...

> 条件跳转或移动取决于未初始化的值

~~我已经读过这个，当你使用一个未初始化的值时它就会发生。~~

 ~~```
MyClass s;
s.DoStuff(); 
```~~ 

~~这会起作用，因为`s`它是自动初始化的……所以如果是这样的话，而且它起作用了，为什么 Memcheck 告诉我它没有初始化？是否应该忽略该消息？~~

也许我误解了错误指向我的地方。从 Valgrind 手册中，实际的错误片段是......

```
int main()
{
  int x;
  printf ("x = %d\n", x);
} 
```

但是，在我的代码中，我看不到类似的东西。然而，我注意到堆栈跟踪 Memcheck 顶部的函数显示我是一个虚函数；这可能与它有关吗？

```
==14446== Conditional jump or move depends on uninitialised value(s)
==14446==    at 0x414164: vimrid::glut::GlutApplication::FinishRender() (GlutApplication.cpp:120)
==14446==    by 0x422434: vimrid::demos::filterdemos::FilterDemo3::Render() (FilterDemo3.cpp:260)
==14446==    by 0x412D3D: vimrid::VimridApplication::UpdateAndRender() (VimridApplication.cpp:93)
==14446==    by 0x4144BA: vimrid::glut::GlutApplication::glutHandleDisplay() (GlutApplication.cpp:201)
==14446==    by 0x41486A: vimrid::glut::GlutApplication::glutCallbackDisplay() (GlutApplication.cpp:277)
==14446==    by 0x54D9FAA: (within /usr/lib64/libglut.so.3.8.0)
==14446==    by 0x54DDA4A: fgEnumWindows (in /usr/lib64/libglut.so.3.8.0)
==14446==    by 0x54DA4A3: glutMainLoopEvent (in /usr/lib64/libglut.so.3.8.0)
==14446==    by 0x54DAEB5: glutMainLoop (in /usr/lib64/libglut.so.3.8.0)
==14446==    by 0x413FF8: vimrid::glut::GlutApplication::Run() (GlutApplication.cpp:112)
==14446==    by 0x41249D: vimrid::Launcher::runDemo(vimrid::VimridSettings&) (Launcher.cpp:150)
==14446==    by 0x412767: vimrid::Launcher::Launch(int, char**) (Launcher.cpp:62) 
```

### 更新1：

我查看了 GlutApplication.cpp:120，看起来未初始化的变量正在传递给该行的函数。简单的！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-04-15T18:19:54.823

您可以将标志添加`--track-origins=yes`到 valgrind，它将为您提供有关未初始化数据来源的信息。它运行速度较慢，但​​可能会有所帮助。

资料来源：[Valgrind 用户手册](http://valgrind.org/docs/manual/mc-manual.html#mc-manual.uninitvals)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-19T19:13:20.907

您可以发布更完整的示例吗？如果没有某种形式的 goto 或 flow 更改语句，很难看出如何会出现特定错误。

我最常在如下代码中看到此错误

```
MyClass s1;
...
if ( someCondition ) { 
  goto Foo:
}
MyClass s2;
Foo:
cout << s2.GetName(); 
```

这段代码基本上是不正确的。原因是即使 s2 有一个构造函数，如果 someCondition 为真，它也不会执行。goto 语句将跳过初始化，并且在程序的最后一行 s2 将未初始化并基本上指向垃圾。

**编辑**

您可能还想查看此页面，该页面提供了有关如何破译此特定 valgrind 错误的提示

[https://computing.llnl.gov/code/memcheck/#deciphering4](https://computing.llnl.gov/code/memcheck/#deciphering4)

**附录**

我刚刚发现的另一个常见原因是，当您将一些整数常量传递给可变参数函数时，它们作为整数放入堆栈，但是当被调用者将它作为长整数时，您在 64 上遇到了问题-位机。

我几乎要放弃并认为 valgrind 很愚蠢，然后我意识到只需将其转换为 long 即可修复它。

所以我的结果是：认真对待这些信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-19T21:17:06.943

如果 Valgrind 声明一个值没有被初始化，那么在 99.5% 的情况下它真的没有被初始化。通常，当编译器报告使用未初始化的值（GCC 中的 -Wuninitialized）时，您会检查内联展开，因为可以声明（而不是初始化）未初始化的值，例如 10 级内联函数“调用”（或模板展开）高于实际的 GCC 报告。**Valgrind 做同样的事情，但在运行时**。因此，您应该检查未初始化值从声明（而不是初始化）的地方到实际使用它的地方的整个路径。例如，路径可以是：函数调用的级联，其中每个函数将其参数（可能还有未初始化的值）传递给下一个函数。**当实际使用该值时，Valgrind 将在最后一个函数中报告。**

通常你不应该忽略 Valgrind 所说的。Valgrind 不是一个简单的跟踪程序。**可以看成是一个虚拟机：**

> Valgrind 本质上是一个使用即时 (JIT) 编译技术的虚拟机，包括动态重新编译。原始程序中的任何内容都不会直接在主机处理器上运行。相反，Valgrind 首先将程序转换为一种临时的、更简单的形式，称为中间表示 (IR)，它是一种与处理器无关的、基于 SSA 的形式。转换后，在 Valgrind 将 IR 转换回机器代码并让主机处理器运行之前，工具（见下文）可以自由地对 IR 进行任何转换。即使它可以使用动态转换（即主机和目标处理器来自不同的体系结构），它也不能。Valgrind 重新编译二进制代码以在相同架构的主机和目标（或模拟）CPU 上运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T19:34:42.553

如果您可以发布更多代码，尤其是从 valgrind 认为错误所在的部分，这将非常有帮助。

如果每次实例化类时都会发生这种情况，那么您可能忘记初始化构造函数中的成员之一。

是的：你应该担心这个错误，那些家伙真的会咬你。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-30T18:04:53.537

在 64 位机器上。通常， int 在内存中占用 4 个字节。但 long 将占用 8 个字节的内存。因此，只需引用一个 int 值，因为长格式会导致完全不正确的结果。在这种情况下需要转换。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-20T03:03:40.790

该错误似乎不是来自您的代码，而是来自您正在使用的库。

Valgrind 带有一些默认的错误抑制，但这可能不包括您正在使用的库。

> 错误检查工具可检测基本库中的大量问题，例如 GNU C 库和 X11 客户端库，这些库预装在您的 GNU/Linux 系统上。你不能轻易地修复这些，但你不想看到这些错误（是的，有很多！）所以 Valgrind 读取错误列表以在启动时抑制。构建系统时，./configure 脚本会创建一个默认抑制文件。

您可以创建自己的[错误抑制](http://valgrind.org/docs/manual/manual-core.html#manual-core.suppress)，您知道这些错误抑制与您的代码无关。

查看类似的 SO 问题[为什么 Valgrind 不喜欢我使用 glutCreateWindow？](https://stackoverflow.com/questions/766303/why-does-valgrind-not-like-my-usage-of-glutcreatewindow)

# protocol-buffers - 在 Google 协议缓冲区中是否有使用 int32 而不是 sint32 的好时机？

> ID：765916
> 
> 赞同：30
> 
> 时间：2009-04-19T19:12:59.160
> 
> 标签：protocol-buffers, primitive

我最近一直在阅读[Google Protocol Buffers](http://code.google.com/apis/protocolbuffers/)，它允许在消息中使用各种标量值类型。

根据[他们的文档](http://code.google.com/apis/protocolbuffers/docs/proto.html#scalar)，有三种类型的变长整数原语 - `int32`、`uint32`和`sint32`. 在他们的文档中，他们指出`int32`“对负数进行编码效率低下 - 如果您的字段可能有负值，请`sint32`改用。” 但是，如果您有一个没有负数的字段，我认为 uint32 将是比任何其他类型更好的类型`int32`（由于额外的位和处理负数的 CPU 成本降低）。

那么什么时候`int32`是一个好的标量呢？文档是否暗示只有当您很少得到负数时它才最有效？还是总是更喜欢使用`sint32`and `uint32`，具体取决于字段的内容？

（同样的问题也适用于这些标量的 64 位版本：`int64`、`uint64`和`sint64`; 但为了便于阅读，我将它们排除在问题描述之外。）

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-19T20:51:02.760

我不熟悉 Google Protocol Buffers，但我对文档的解释是：

*   `uint32`如果值不能为负，则使用
*   `sint32`如果该值很可能是负数，则使用（对于“可能是”的一些模糊定义）
*   如果值可能为负，则使用`int32`该值，但这比正值的可能性要小得多（例如，如果应用程序有时使用 -1 表示错误或“未知”值，这是一种相对不常见的情况）

以下是文档对编码的看法（[http://code.google.com/apis/protocolbuffers/docs/encoding.html#types](http://code.google.com/apis/protocolbuffers/docs/encoding.html#types)）：

> 在编码负数时，带符号的 int 类型（ `sint32`and `sint64`）和“标准” int 类型（`int32`and ）之间存在重要区别。`int64`如果你使用`int32`or`int64`作为负数的类型，结果`varint`总是十个字节长——实际上，它被视为一个非常大的无符号整数。如果您使用其中一种有符号类型，则结果`varint`将使用 ZigZag 编码，这种编码效率更高。
> 
> ZigZag 编码将有符号整数映射到无符号整数，因此绝对值小的数字（例如 -1）也具有小的`varint`编码值。它以一种通过正整数和负整数来回“曲折”的方式执行此操作，因此 -1 被编码为 1，1 被编码为 2，-2 被编码为 3，依此类推......

因此，即使您很少使用负数，只要您在协议中传递的数字（包括非负数）的幅度较小，您最好还是使用`sint32`. 如果您不确定，分析将是有序的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-02-22T04:35:49.740

几乎没有充分的理由使用 int* 而不是 sint*。这些额外类型的存在很可能是出于历史的、向后兼容的原因，Protocol Buffers 甚至在其自己的协议版本中都试图维护它们。

我最好的猜测是，在最早的版本中，他们以 2 的补码表示形式对负整数进行了愚蠢的编码，这需要 9 个字节的最大大小的 varint 编码（不包括额外的类型字节）。然后他们坚持使用这种编码，以免破坏已经使用它的旧代码和序列化。因此，他们需要添加一种新的编码类型 sint*，以便在不破坏现有代码的情况下为负数获得更好的可变大小编码。设计师们是如何从一开始就没有意识到这个问题的，这完全超出了我的理解。

varint 编码（没有类型说明，需要多 1 个字节）可以将无符号整数值编码为以下字节数：

[0, 2^7)：一个字节

[2^7, 2^14)：两个字节

[2^14, 2^21)：三个字节

[2^21, 2^28)：四个字节

[2^28, 2^35)：五个字节

[2^35, 2^42)：六个字节

[2^42, 2^49)：七个字节

[2^49, 2^56)：八个字节

[2^56, 2^64)：九个字节

如果您想类似地紧凑地编码小幅度负整数，那么您将需要“用完”一位来指示符号。您可以通过显式符号位（在某个保留位置）和幅度表示来做到这一点。或者，您可以进行 zig zag 编码，它通过将幅度左移 1 位并为负数减去 1 来有效地做同样的事情（因此最低有效位表示符号：偶数是非负的，几率是负的）。

*无论哪种方式，正*整数需要更多空间的切换点现在都提前了 2 倍：

[0, 2^6)：一个字节

[2^6, 2^13)：两个字节

[2^13, 2^20)：三个字节

[2^20, 2^27)：四个字节

[2^27, 2^34)：五个字节

[2^34, 2^41)：六个字节

[2^41, 2^48)：七个字节

[2^48, 2^55)：八个字节

[2^55, 2^63)：九个字节

为了说明在 sint* 上使用 int* 的情况，负数必须非常罕见，但可能，和/或您期望编码的最常见的正值必须正好落在导致的切点之一附近与 int* 相比，在 sint* 中进行更大的编码（例如 - 2^6 对 2^7 导致 2x 编码大小）。

基本上，如果你要得到一些可能是负数的数字，那么默认使用 sint* 而不是 int*。int* 很少会出类拔萃，而且通常甚至不值得您花费额外的精力来判断它是否值得恕我直言。

# flash - 如何简单地从 Adob e Flash Media Server 流式传输视频？(Linux)

> ID：765921
> 
> 赞同：0
> 
> 时间：2009-04-19T19:14:28.670
> 
> 标签：flash, actionscript, media, flash-media-server

我对如何开始使用 Adob​​e Flash Media Server 感到困惑。在 Linux 上。

我需要做的就是：

1.  接受 rtmp://myserver.com:1935/stream/static/abcdef0123456789 的请求
2.  告诉 FMS $filename 位于 /var/media/ab/cd/ef/abcdef0123456789
3.  让 FMS 将 /var/media/ab/cd/ef/abcdef0123456789 发送到客户端。
4.  必要时处理搜索。

我知道这可能是人们想要使用 FMS 的 99%。但是，我很难找到一个可行的例子。

您能告诉我类似“将 filename.asc 放入 $foldername 并输入以下代码”之类的内容吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T22:16:16.347

这是 FMS 和配置存储的手册。 [http://livedocs.adobe.com/flashmediaserver/3.0/docs/help.html?content=03_configtasks_32.html#1204236](http://livedocs.adobe.com/flashmediaserver/3.0/docs/help.html?content=03_configtasks_32.html#1204236)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-04T04:04:24.973

FMS 安装文件夹内“应用程序”中的“vod”目录是一个不错的起点。它的设置是为了轻松访问开箱即用的流媒体播放（无需像过去那样创建自定义应用程序目录来进行流媒体播放）。

因此，将视频文件放在“vod”内的“media”目录中，然后将其用作 FLVPlayback 组件的源来播放它：

rtmp://localhost/vod/abcd.flv

或者，如果通过 Web 而不是本地访问您的服务器：

rtmp://myFMSserverURL.com/vod/abcd.flv

# localhost - 无法从 localhost 运行 Web 应用程序

> ID：765922
> 
> 赞同：0
> 
> 时间：2009-04-19T19:15:45.610
> 
> 标签：localhost

我在运行 Web 应用程序项目时遇到问题。

它给了我以下错误：

[替代文字 http://www6.0zz0.com/2009/04/19/19/934715868.jpg](http://www6.0zz0.com/2009/04/19/19/934715868.jpg)

Web 应用程序项目和网站项目发生错误。

我尝试了以下 URL，但它给了我同样的错误：`http://localhost:3306/mobileApplication`

这样进入数据库：

```
http://localhost:3306/TheLostNumberApplication/
http://localhost:3306/TheLostNumberApplication/faces/welcomeJSF.jsp 
```

看起来 localhost 没有运行，我使用 MySQL，但我不知道在哪里可以找到 localhost 来运行它。

可能是什么问题？

### 更新：

我尝试了几种解决方案，但它仍然有同样的问题（本地主机不运行）......

我现在想问一下我有一个 Apache 服务。我应该拥有 Apache Tomcat，而不是 Apache 服务吗？还是没关系？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T22:02:46.503

MySQL 默认在 3306 端口上运行，不提供 Web 前端。您需要找出您正在运行的网络服务器打开了哪个端口。通常，它们在端口 80、端口 8080 或端口 8000 上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T21:55:55.570

你有防火墙可以阻止这个吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T22:02:51.870

您使用什么作为 Java 应用程序服务器？你需要先启动它。

您可以在 Windows 中的管理工具 -> 服务下找到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T22:08:10.737

进入 Internet Explorer 工具，单击高级选项卡，然后在设置树的浏览分支下，确保“显示友好的 HTTP 错误消息”设置已关闭。

这本身并不能解决您的问题，但是当您的 Web 应用程序未正确执行时，Internet Explorer 通常会向您隐藏真相。当您刷新时，它会告诉您*真正*出了什么问题（可能是 404），但至少 Internet Explorer 不会对页面失败的原因做出假设。

我自己也遇到过这种情况，Internet Explorer 报告 404 错误，实际上，这是一个语法问题，当此选项关闭时报告。将其关闭并相应地更新您的问题，或解决问题。如果这不起作用，请在此处参考其他答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-22T12:29:48.457

如果您使用的是较新的 Windows，请检查您的主机文件 - 微软删除了 Vista 中的 localhost 条目（？）。当您的 dns 拒绝解决它时，这会使生活变得混乱。

检查 %windir%\System32\drivers\etc\hosts

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-19T21:59:49.210

您是否在您的机器上安装了 Web 服务器？

[这](http://www.apachefriends.org/en/xampp-windows.html)是一个让您启动并运行的方法。

**编辑：**

看来你正在做一些 JSP 工作，你研究过[Tomcat](http://tomcat.apache.org/)吗？

# sql-server - 如何将对生产数据库所做的架构更改合并到我的迁移管理流程中？

> ID：765934
> 
> 赞同：2
> 
> 时间：2009-04-19T19:25:22.983
> 
> 标签：sql-server, continuous-integration, database-migration

我的团队正在评估 dbdeploy 以管理数据库迁移。据我了解，使用迁移需要一些流程纪律，即为每次更改编写迁移，并且要达到生产，必须将其从本地提升到开发，再从测试到生产。

有时，我们的生产 DBA 团队会直接对生产环境进行模式更改。如果我们编写一个新的迁移来针对我们当前的数据库开发版本进行更改，那么在将迁移部署到生产之前，将永远不会针对已经包含更改的模式测试该迁移。这让我很担心。

另一种选择是直接对基线模式进行更改，然后在所有环境（本地、开发、测试、阶段）中重建数据库。这种方法让我很担心，因为新模式可能会导致一个或多个迁移中断。

人们目前如何处理这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T15:09:25.523

我们在一夜之间将生产数据库的副本恢复到测试服务器上。

然后服务：

*   作为参考副本（代码和数据）
*   我们可以重置我们所做的任何更改
*   我们可以针对真实数据进行测试
*   我们可以并排新/旧代码性能
*   我们可以生成 100% 安全的更改/回滚脚本 (Red Gate)

我们不重建开发/测试数据库等，但我们的一些伙伴项目会这样做。但是，我不确定它的好处，因为数据库不是模式和代码：它也是数据。它与编译好的 .net 应用程序不同。

在我的商店中，未经批准对产品数据库进行更改（任何更改）的生产 DBA 将被解雇。它发生了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T19:29:49.367

生产模式上的数据库更改必须不时发生，这是可以理解的。尽管这些必须记录并尽快传达给开发团队，但这一点非常重要。带有执行 sql 的纯文本以及对受影响的用例/功能和可能的错误跟踪问题的评论就可以了

时不时地将实时数据库取回开发，并将其（它的模式）与开发人员所拥有的进行比较也是一个好主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T19:55:53.113

我假设 DBA 可以在生产数据库上更改的唯一事情是在这里和那里添加一个索引并调整一些存储过程——所有这些都是为了性能。一般来说，对数据库的所有其他更改都会使数据库模式与应用程序不兼容。

考虑到这一点，唯一真正应该进行版本控制的是存储过程，DBA 有责任将它们检查到源代码控制中。索引更不稳定，实际上可能不包含在迁移脚本中。

# character - 使用给定长度良好的所有字符组合

> ID：765936
> 
> 赞同：0
> 
> 时间：2009-04-19T19:26:43.867
> 
> 标签：character

是否有程序/工具/实用程序可以让我在给定的字符长度（最小-最大）上生成所有可能的字符组合（小写、大写、符号、数字）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T19:33:48.437

这与暴力破解密码本质上是相同的领域，这可能是您想要实现的目标。[维基百科有一篇关于密码破解](http://en.wikipedia.org/wiki/Password_cracking)的合理文章，并列出了该任务最流行的软件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-02T16:51:49.743

如果您不需要代码，只需要强密码，您可以尝试使用一些服务：

[http://onlinepasswordgenerator.net](http://onlinepasswordgenerator.net)

[http://h4sher.net](http://h4sher.net)

techzoom.net/tools/password-generator.en

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T19:33:04.587

在线的：

*   [Javascript 排列生成器](http://scriptar.com/JavaScript/permute.html)
*   [字符串的排列](http://www.digsys.se/js_permut.html)

桌面：

*   [免费密码生成器](http://free-random-password-generator.free-random-password-generator-com.qarchive.org/)。这是一个密码生成器工具，但你可以

    *   固定长度
    *   选择包括字母/数字/大写字母

        [替代文字 http://free-random-password-generator.free-random-password-generator-com.qarchive.org/mainscreen350.png](http://free-random-password-generator.free-random-password-generator-com.qarchive.org/mainscreen350.png)

# .net - NetNamedPipe：通信空闲时变化的响应时间

> ID：765938
> 
> 赞同：2
> 
> 时间：2009-04-19T19:27:03.867
> 
> 标签：.net, wcf, web-services, named-pipes, performance

我有两个 WCF 应用程序通过命名管道进行单向通信。一切都很好，除了一件事：通常，请求/响应周期需要零（边际）时间。但是，如果有一个时间跨度，比如说，半分钟没有任何通信，请求/响应会增加到 ~300-500 毫秒。

我环顾了一下网络，我想到了使用心跳/ping 机制来保持通信通道繁忙的想法。通过反复试验，我发现每 10 秒执行一次请求时，响应时间保持在较低水平。从大约 15 秒的间隔开始，“打嗝”响应时间开始出现。

现在我想知道这种现象是从哪里来的。我尝试将双方所有可想象的超时设置为 > 1 分钟，但这没有帮助。

谁能解释那里发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-12T17:19:24.443

看看董文龙的博文，[为什么WCF空闲15秒后变慢了？](http://blogs.msdn.com/wenlong/archive/2010/02/11/why-does-wcf-become-slow-after-being-idle-for-15-seconds.aspx)

该帖子还包括一个解决方法，直到它得到修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T19:31:07.727

空闲进程是否有可能被分页到磁盘？如果你让两端的*进程都忙，但不让**连接*忙，它还会发生吗？

这可能不是它，但它可能值得一试。

# naming-conventions - Model-View-ViewModel (MVVM) 类和实例的名称应该有多冗长？

> ID：765953
> 
> 赞同：4
> 
> 时间：2009-04-19T19:37:25.747
> 
> 标签：naming-conventions, naming, mvvm, verbosity

一般来说，我更喜欢详细说明 .NET 类和实例名称，但有时（[引用 Mike Woodhouse 的话](https://stackoverflow.com/questions/214160/how-self-documenting-can-code-be-without-being-annoying)）：

> 过于冗长往往会掩盖语法，而语法很重要。

我觉得我真正误入了过度冗长制度的第一个地方是在 Silverlight 和 WPF 应用程序中实现模型-视图-视图模型 (MVVM) 模式。

例如，我从一个 EnumerableRange 模型对象开始：

```
public class EnumerableRange<T> : IEnumerable<T>
{ 
    public T Start{ get; set; }
    public T Stop{ get; set; }
    public long Count{ get; set; }
    ...
} 
```

然后，我想创建一个控件，允许我显示此类以供用户输入。因此，我创建了一对与视图相关的类：

1.  一个 EnumerableRangeControlView 用户控件（在 XAML 中），以及
2.  POCO EnumerableRangeControlViewModel

现在，我分别在父 View 和 ViewModel 中使用这对。使用 MVVM，视图实例不需要名称，但我的 ViewModel 实例现在命名为：

**IndependentVariableEnumerableRangeControlViewModel**。

事情开始失控了！你会怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T17:42:38.243

我提出以下建议：

1.  从 View/ViewModel 类和实例名称中完全删除单词“Control”。“View”和“ViewModel”清楚地说明了类目的。

2.  （可选）始终采用约定以“VM”后修复 ViewModel 实例。

在上面的示例中，实例名称

```
IndependentVariableEnumerableRangeControlViewModel 
```

变得更具可读性

```
IndependentVariableEnumberableRangeVM 
```

# powershell - 在脚本中设置 MSMQ 队列的权限

> ID：765954
> 
> 赞同：17
> 
> 时间：2009-04-19T19:38:06.087
> 
> 标签：powershell, vbscript, permissions, msmq

谁能给我一些关于如何在脚本中设置 MSMQ 队列权限的指示，最好是 PowerShell，但我会使用 VBscript

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-27T10:59:31.093

这里是一些示例 PowerShell，包括设置权限...*抱歉长度*

```
Write-Host ""
Write-Host "Examples using the .NET System.Messaging assembly to access MSMQ"
Write-Host ""

Write-Host "... load the .NET Messaging assembly"
[Reflection.Assembly]::LoadWithPartialName("System.Messaging")

Write-Host ""

if ([System.Messaging.MessageQueue]::Exists(".\private$\MyQueue"))
  {
  [System.Messaging.MessageQueue]::Delete(".\private$\MyQueue")
  Write-Host "... delete old myqueue"
  }
if ([System.Messaging.MessageQueue]::Exists(".\private$\BtsQueue"))
  {
  [System.Messaging.MessageQueue]::Delete(".\private$\BtsQueue")
  Write-Host "... delete old btsqueue"
  }

Write-Host "... create a new queue"
$q1 = [System.Messaging.MessageQueue]::Create(".\private$\MyQueue")

Write-Host "... create new queue, set FullControl permissions for CORP\BIZTALK"
$qb = [System.Messaging.MessageQueue]::Create(".\private$\BtsQueue")

$qb.SetPermissions("CORP\BIZTALK", 
      [System.Messaging.MessageQueueAccessRights]::FullControl,            
      [System.Messaging.AccessControlEntryType]::Set)

Write-Host "... list existing queues" 
$pqs = [System.Messaging.MessageQueue]::GetPrivateQueuesByMachine(".")
Write-Host "    Count: "$pqs.length  -ForegroundColor gray
foreach($q in $pqs)
  {
    Write-Host "       "$q.QueueName  -ForegroundColor gray
  }

Write-Host "... access existing queue"
$q2 = New-Object System.Messaging.MessageQueue ".\private$\MyQueue"

Write-Host "... adding string Formatter and additional properties "
$q2.Formatter.TargetTypeNames = ,"System.String"
$q2.MessageReadPropertyFilter.ArrivedTime = $true 
$q2.MessageReadPropertyFilter.SentTime = $true 

Write-Host "... create a new High priorty message "
$msg = New-Object System.Messaging.Message "TestMessage"
$msg.label = "Test Msg Label"
$msg.body = "Add some body to test message"
$msg.priority = [System.Messaging.MessagePriority]::High

Write-Host "... send the High message"
$q2.send($msg)

$msg.body = "Some more text for the test message"
$msg.priority = [System.Messaging.MessagePriority]::Low

Write-Host "... send the Low message"
$q2.send($msg)

Write-Host "... check the queue "
Write-Host "    Count: "$q2.GetAllMessages().length  -ForegroundColor gray

Write-Host "... peek at queue"
$ts = New-Object TimeSpan 10000000 # 1 sec. timeout just in case MSMQ is empty
$pk = $q2.Peek($ts)
Write-Host "    ArrivedTime: "$pk.ArrivedTime.DateTime -ForegroundColor gray
Write-Host "    SentTime   : "$pk.SentTime.DateTime -ForegroundColor gray

Write-Host "... check the queue "
Write-Host "    Count: "$q2.GetAllMessages().length -ForegroundColor gray

Write-Host "... receive from queue"
$rmsg = $q2.receive($ts)
Write-Host "    Body : "$rmsg.body  -ForegroundColor gray
Write-Host "    Label: "$rmsg.label -ForegroundColor gray

Write-Host "... check the queue "
Write-Host "    Count: "$q2.GetAllMessages().length  -ForegroundColor gray

Write-Host "... purge the queue "
$q2.Purge()

Write-Host "... check the queue "
Write-Host "    Count: "$q2.GetAllMessages().length  -ForegroundColor gray

Write-Host ""
Write-Host "All done, but remember to delete the test queues !!" 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-12-18T12:16:11.227

目前（2015 年）日对这个问题的回答。

例子：

```
New-MsmqQueue -Name "MyQueue" -QueueType Private
Get-MsmqQueue -Name "MyQueue" -QueueType Private | 
  Set-MsmqQueueAcl -UserName "Everyone" -Allow FullControl 
```

适用于：Windows 8.1、Windows PowerShell 4.0、Windows Server 2012 R2

参考：[https ://technet.microsoft.com/en-us/library/dn391735(v=wps.630).aspx](https://technet.microsoft.com/en-us/library/dn391735(v=wps.630).aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T23:13:41.110

PowerShell 中没有为此内置任何内容，但您可以使用 .NET 框架类。只需加载 System.Messaging.dll 并使用 MessageQueue.SetPermissions() 更改队列上的 ACL。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-17T18:08:08.260

Windows 2012 和 8.1 现在具有 MSMQ cmdlet。设置队列权限的方法是：Set-MsmqQueueAcl

# javascript - 预加载动画 gif

> ID：765955
> 
> 赞同：4
> 
> 时间：2009-04-19T19:39:08.410
> 
> 标签：javascript, jquery, html

我有一个功能，用户可以单击视频缩略图，我的 PHP 脚本将抓取视频。

我有一个`display: none;`包含 Flash 视频播放器代码的 div，它的背景图像是 CSS 中的动画 gif（加载微调器）。我使用 jQuery show 方法使它在用户单击它时出现。

但是当`div`单击时，加载图像也需要被获取。由于视频也在同时被获取，加载图像很少出现。

如何使用负边距技巧预加载此图像而不使其成为另一个图像的一部分？？？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-19T19:42:49.150

将此 javascript 放在页面中的某个位置，以便它在加载时执行：

```
var image = new Image();
image.src = 'path/to/spinner.gif'; 
```

# git - 无法通过 MacPorts 安装 Git-core+svn

> ID：765959
> 
> 赞同：2
> 
> 时间：2009-04-19T19:46:48.967
> 
> 标签：git, svn, installation, macports

我正在尝试通过 svn 将 Git-core 安装到我的 Mac 上，但未成功

```
$ sudo port install git-core +svn
--->  Verifying checksum(s) for db46
Error: Checksum (md5) mismatch for patch.4.6.21.3
Error: Target org.macports.checksum returned: Unable to verify file checksums
Error: The following dependencies failed to build: p5-svn-simple subversion-perlbindings apr-util db46 sqlite3 cyrus-sasl2 neon serf subversion p5-term-readkey
Error: Status 1 encountered during processing. 
```

我试图通过以下方式解决问题，但未成功

```
sudo port -f clean --all {neon, subversion,...} 
```

你怎么能解决这个问题？

**解决了：**

一个名为 Peerguardian 的程序阻止了安装。当我删除它时，现在一切正常。非常感谢所有回复者！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T20:34:40.100

它失败了，因为有一个错误构建`db46`；具体来说，在校验该`port`实用程序下载的补丁文件时存在问题。看起来这可能是端口的问题，但我刚刚构建`db46`没有任何问题。你最近更新了你的端口树吗？您可以尝试这样做：

```
$ sudo port selfupdate               # updates the ports tree and port utility
$ sudo port install git +svn    # installs git 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T00:54:38.430

Oracle 最近默默地更改了他们的补丁，因此校验和不匹配。这已在 MacPorts 中修复，因此如果您自行更新，它将正常工作。

# asp.net - 更新 GAC 中包含 Web 应用程序的 aspx 页面的 dll

> ID：765960
> 
> 赞同：1
> 
> 时间：2009-04-19T19:47:38.547
> 
> 标签：asp.net, iis, web-applications, gac

原谅我的编码员，因为我犯了罪。我将一些代码放入 GAC 中的 dll 中，现在我对 GAC 如何真正与 IIS 一起工作感到困惑。

在我们的 Intranet 环境中，我有几个相关的 Web 应用程序（大约 10 个）。每个应用程序都从一个单独的 url 运行，并且可能在其自己的应用程序池中运行。目前所有应用程序都在同一台服务器上，但这不是必需的。这种设置允许我们分别控制、开发和迁移每个应用程序。但是，我们希望每个应用程序的几个部分在我们的所有应用程序中都通用（母版页、登录页、菜单等）。管理层的要求是对这些文件的更改可以是通用的，并且无需必须重新编译和重新迁移每个 Web 应用程序。有很多方法可以完成这项任务，尽管有警告要避免使用 GAC，但这似乎确实是使用虚拟路径提供程序和存储在 GAC 中的 dll 有意义的情况。

我将一个虚拟路径提供程序放在一起，然后将我需要通用的文件和资源嵌入到一个 dll 中。（我本可以让 VPP 从数据库中提取文件，但我希望将文件嵌入 dll 本身会更高效。

**并发症 #1**

我不希望每个应用程序的开发人员都必须弄乱他们自己的 GAC 来测试和运行他们的应用程序，所以在每个解决方案中我只包含 Virtual Path Provider 项目，并将其结果 dll 复制到本地，（以及如强命名），这意味着提供程序 dll 及其嵌入文件被复制到应用程序的 bin 目录中。只要开发人员在他们的 GAC 中没有这个 dll 的版本（他们不应该），就会使用本地 bin 副本。这允许开发人员轻松更改和测试应用程序的文件和每个应用程序共有的文件。这也意味着除非故意阻止，否则通用 dll 也将存在于生产中的每个应用程序的 bin 目录中。但是，由于 IIS 将始终使用 GAC 版本（如果存在），

我现在认为这是合理的，因为在将应用程序复制到服务器时，我找不到一种简单的方法来同时将 VPP.dll 复制到本地进行开发，但又不复制到 bin 目录。

**并发症 #2**

实际上对应用程序进行编码以便它始终使用最新版本的 dll 而不是编译它的特定版本似乎是一件相当复杂的事情。（我还没有看到一个很好的例子来说明如何做到这一点，但我认为我需要一系列发布者政策）尝试更明显的答案似乎更容易——在迁移新的 dll 时保持 dll 的版本号不变版本的 VPP dll 到 GAC。这似乎工作正常，直到它没有。

使用服务器上的 Windows /assembly 管理单元，我将 GAC 中我的 dll 的旧版本 v. 1.0.0.0 替换为 v. 1.0.0.0 的更新副本。尽管我在 GAC 中更新了 dll，但我的应用程序继续使用旧版本的代码。重新启动 IIS，甚至完全重新启动服务器似乎都没有帮助。真正让我大吃一惊的是，最终 IIS 会神秘而出人意料地自我纠正，并开始使用来自 GAC 的 dll 的正确副本。

我见过许多这类与 GAC 相关的问题，这些问题似乎都以“突然我的网站又开始正常工作”结束了。我花了一段时间才发现这是 IIS 如何缓存我的强命名 dll 的结果，并且我误用了强命名 dll 应该工作的方式。

接下来，我尝试完全从 GAC 中删除 dll 的版本。因为在 bin 目录中仍然有我的 dll 的副本，所以我预计该过程要么失败，要么恢复/前进到 bin 目录中的版本。但是因为bin中的版本也是1.0.0.0，IIS继续使用dll的缓存副本，现在机器上已经不存在了。（这让我真的困惑了一段时间，因为我对GAC失去了信心版本一直在运行）

最后，我必须确保更新 dll 的唯一方法是从 GAC 中删除 dll 的副本，从 bin 目录中删除 dll 的副本，运行该站点以使其失败，然后将新的将 dll 版本导入 GAC。在此期间启动和停止 IIS 无效。这始终让我的应用程序使用新代码，但是……</p>

如此简单地将新版本的 dll 插入 GAC 并使其新效果无缝传播。

在阅读了一些相关问题之后，我现在正在尝试的是：

1.  停止 IIS
2.  更新 GAC 中 dll 的软件（但仍将新 dll 的版本号保留为 1.0.0.0 ）
3.  删除 'C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files' 文件夹中的所有内容（我认为这会强制重新编译，但这是一个修复的大锤）
4.  重新启动 IIS。

这似乎是有效的，但似乎不得不去解决所有这些麻烦似乎有什么问题。有没有更简单的方法来强制 IIS 使用 GAC dll 的当前实例？有没有更好的方法来实现我所追求的效果。（一些通用文件 .aspx 和 .xml 文件在各种应用程序之间共享，可以与应用程序本身分开更新。）

编辑：根据 shahkalpesh 的评论，我在 microsoft
[http://msdn.microsoft.com/en-us/library/7wd6ex19(VS.80).aspx找到了这个页面](http://msdn.microsoft.com/en-us/library/7wd6ex19(VS.80).aspx)

它包括这个小知识：

重定向程序集版本 要将一个版本重定向到另一个版本，请使用该`<bindingRedirect>`元素。oldVersion 属性可以指定单个版本或**一系列版本**。例如，`<bindingRedirect oldVersion="1.1.0.0-1.2.0.0" newVersion="2.0.0.0"/>`指定运行时应使用版本 2.0.0.0 而不是 1.1.0.0 和 1.2.0.0 之间的程序集版本。

这意味着与我的 dll 一起，我可以推送一个将所有内容重定向到最新的发布者策略文件。那种缓解了我认为会是噩梦般的政策链的情况，我必须维护从每个可能版本到最新版本的链接......

我会试试这个，看看更新这样的版本是否也会触发 IIS 使用新文件的正确版本（在重置应用程序池之后）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T22:23:10.403

查看您的问题，您似乎希望在部署时使用更高版本的程序集。

在这种情况下，这个[http://msdn.microsoft.com/en-us/library/eftw1fys(VS.71).aspx](http://msdn.microsoft.com/en-us/library/eftw1fys(VS.71).aspx)可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T22:27:37.880

请记住，程序集版本和文件版本是不同的......它们可能会尝试将它们作为全新版本读取并引用它（而不是 1.0.0.0）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-22T19:53:25.393

为了让您放心 - 多年来，我们一直在用我们的共享程序集做非常相似的事情。

使用 GAC 时要记住的事项：

1.  如果您要用相同的版本号替换现有版本的 DLL - 您必须首先**删除**以前的版本（从 c:\windows\assembly 删除，或者`GACUtil /u`） - 只需重新部署它/ `GACUtil`/etc 不会有任何影响 - 它认为 DLL 已经存在并且不更新它。
2.  请记住 1，增加版本号会更容易，并且正如您所发现的，在配置链中的某处添加 BindingRedirect，通常我们使用 Machine.Config，因为我们希望影响服务器上的所有应用程序。

# asp.net - 从服务器端创建菜单

> ID：765963
> 
> 赞同：3
> 
> 时间：2009-04-19T19:51:00.907
> 
> 标签：asp.net, javascript, vb.net

我正在用 javascript 创建我的菜单。页面加载时从服务器端（VB ASP.NET）而不是客户端创建的可能性有多大？如果这是可能的，这是怎么做到的？我的主要目标是我可以从数据库创建菜单项。

随意发表你的意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T21:05:06.800

You may want to look at [micro-templating](http://ejohn.org/blog/javascript-micro-templating/), where you create a template that uses json as it's data source. This way you can control the menu items with a database query, xml, whatever. The template is a nice feature as you will not have to rebuild and re-deploy should you want to change the look and feel. There are several asp.net examples:

[Dave Ward's Encosia's blog](http://encosia.com/2008/06/26/use-jquery-and-aspnet-ajax-to-build-a-client-side-repeater/)

[Rick Strahl's blog](http://www.west-wind.com/presentations/jQuery/)

[StackOverflow](https://stackoverflow.com/questions/170168/jquery-templating-engines)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T19:58:32.060

它非常简单，有很多方法可以做到这一点，但基本上你的 asp.net vb 代码正在输出 HTML 和/或什至一些 JavaScript 有很多方法可以做到这一点，简单地说：

```
Response.Write("<div class='mymenu'>")
Response.Write("<ul>")
Response.Write("<li>Menu Item 1</li>")
Response.Write("<li>Menu Item 2</li>")
Response.Write("<li>Menu Item 3</li>")
Response.Write("<li>Menu Item 4</li>")
Response.Write("</ul>")
Response.Write("</div>") 
```

显然，这些菜单项可能来自数据库或其他任何地方。示例代码不是唯一的方法，甚至不一定是最好的方法，有很多很多方法......但不仅可以按照您的要求做，而且非常常见且容易做到也是。

javascript 也可以以相同的方式写入客户端，但假设它是静态的，您可以按照常规方式进行，即在标记中。

# python - 亚马逊 S3 权限

> ID：765964
> 
> 赞同：10
> 
> 时间：2009-04-19T19:51:07.787
> 
> 标签：python, django, amazon-web-services, amazon-s3

试图了解 S3...如何限制对上传到 S3 的文件的访问？例如，在 Web 应用程序中，每个用户都有可以上传的文件，但您如何限制访问权限，以便只有该用户可以访问该文件？似乎查询字符串身份验证需要一个到期日期，这对我不起作用，还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-20T12:28:03.960

有多种方法可以控制对 S3 对象的访问：

1.  使用查询字符串 auth - 但正如您所指出的，这确实需要一个到期日期。你可以在未来走得更远，这对我所做的大多数事情来说已经足够好了。

2.  使用 S3 ACLS - 但这需要用户拥有 AWS 账户并通过 AWS 进行身份验证才能访问 S3 对象。这可能不是您想要的。

3.  您通过实现访问控制逻辑的应用程序代理对 S3 对象的访问。这将通过您的盒子带来所有带宽。

4.  您可以使用代理逻辑设置 EC2 实例 - 这可以使带宽更接近 S3，并且可以减少某些情况下的延迟。这和＃3之间的差异可能很小，但取决于您的具体情况。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-20T12:43:17.013

1.  让用户访问您的服务器
2.  服务器是否设置了一个有效期较短的查询字符串身份验证（分钟、小时？）
3.  让您的服务器重定向到 #2

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T20:24:55.570

您必须在应用程序中构建对 S3 的整个访问逻辑

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T12:00:20.247

我也一直在处理这个问题。Don 编写了我正在使用的[S3 PHP](http://undesigned.org.za/2007/10/22/amazon-s3-php-class)类，他指出您可以在存储桶中使用 dirs。因此，您可以将文件放在带有随机字符串的目录中，然后重定向到该目录。mybucket.amazon.net/wef49kfe4j409jf4f4f9jdfd/myfile.zip 虽然根本不安全，但您可以根据需要通过更改权限或创建和删除它（将原始文件安全地保存在不同的存储桶中）来控制对它的访问。

# c# - new Action() 和 lambda 有什么区别？

> ID：765966
> 
> 赞同：46
> 
> 时间：2009-04-19T19:53:25.740
> 
> 标签：c#, .net-3.5, delegates, lambda

所以当我写这样的东西时

```
Action action = new Action(()=>_myMessage = "hello"); 
```

重构专业版！将此突出显示为冗余委托创建，并允许我将其缩短为

```
Action action = () => _myMessage="hello"; 
```

这通常效果很好。 **通常**，但并非总是如此。例如，Rhino Mocks 有一个名为 Do 的扩展方法：

```
IMethodOptions<T> Do(Delegate action); 
```

在这里，传入第一个版本有效，但第二个版本无效。这里到底发生了什么？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-04-19T20:02:30.100

第一个版本有效地做：

```
Action tmp = () => _myMessage = "hello";
var action = new Action(tmp); 
```

您遇到的问题是编译器必须知道 lambda 表达式应转换为哪种委托（或表达式树）。这就是为什么：

```
var action = () => _myMessage="hello"; 
```

实际上不会编译 - 它可以是*任何*`_myMessage`没有参数的委托类型，也可以是没有返回值或与（大概是）相同的返回类型`string`。例如，所有这些都是有效的：

```
Action action = () => _myMessage="hello";
Func<string> action = () => _myMessage="hello";
MethodInvoker action = () => _myMessage="hello";
Expression<Action> = () => _myMessage="hello";
// etc 
```

`action`如果用 声明，C# 编译器如何计算出它应该是什么类型`var`？

调用方法时（对于您的 Rhino Mocks 示例）解决此问题的最简单方法是强制转换：

```
methodOptions.Do((Action) (() => _myMessage = "hello")); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-19T20:00:38.483

您是否验证了第二行实际编译？它不应该编译，因为 C# 不支持将 lambda 表达式分配给隐式类型变量 (CS0815)。这条线将在 VB.Net 中工作，因为它支持匿名委托创建（从 VB 9.0 开始）。

Rhino Mocks 版本无法编译，原因与第二行不应编译的原因相同。C# 不会自动推断 lambda 表达式的类型。Lambda 表达式必须在可以确定它们要实现的委托类型的上下文中使用。第一行效果很好，因为预期的类型很明确：Action。Rhino Mocks 版本不起作用，因为 Delegate 更类似于抽象委托类型。它必须是具体的委托类型，例如 Action 或 Func。

有关此主题的详细讨论，您应该阅读 Eric Lippert 关于该主题的博客文章：http: [//blogs.msdn.com/ericlippert/archive/2007/01/11/lambda-expressions-vs-anonymous-methods-part -两个.aspx](http://blogs.msdn.com/ericlippert/archive/2007/01/11/lambda-expressions-vs-anonymous-methods-part-two.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-11T09:03:22.897

Action 是一种特殊类型的委托。因此，如果您使用 lambda 将无法理解您要使用哪种类型，因为有很多*(Action, Func,...)*。

为了克服这种强制转换的需要*（在大多数情况下很慢），*您可以将基本函数的参数从 Delegate 更改为 Action：

```
IMethodOptions<T> Do(Action action); 
```

这样你就可以同时使用这两个语句并且不会有任何不同：

```
Action action = new Action(()=>_myMessage = "hello"); 
Action action = () => _myMessage="hello"; 
```

如果这是不可能的，那么我建议使用*new Action(() => {})*而不是强制转换，它会更快。

请阅读以下链接以获取有关操作和委托的更多信息：[https ://docs.microsoft.com/en-gb/dotnet/api/system.action?view=netframework-4.7.1#definition](https://docs.microsoft.com/en-gb/dotnet/api/system.action?view=netframework-4.7.1#definition)

# c++ - 分配给 new 的内存是否会自动释放？

> ID：765971
> 
> 赞同：5
> 
> 时间：2009-04-19T19:55:59.040
> 
> 标签：c++, memory-management

我有 99% 的把握这个问题的答案是**否定**的。请验证我的提议，即以下代码将产生内存泄漏。

```
Data &getData()
{
    Data *i = new Data();
    return *i;
}

void exampleFunc()
{
    Data d1 = getData();
    Data d2;

    /* d1 is not deallocated because it is on the heap, and d2 is
     * because it is on the stack. */
} 
```

请注意，这是一个过于简单的例子，所以很明显你实际上不会使用上面的代码......所以不需要指出这一点，谢谢。

### 更新1：

除此之外，如果我将指针分配给引用怎么办？在这种情况下，我假设数据没有被复制......

```
Data &getData()
{
    Data *i = new Data();
    return *i;
}

void exampleFunc()
{
    // Does copying occur here?
    Data &d1 = getData();

    // Does this deallocate the memory assigned to the pointer?
    delete &d;
} 
```

### 更新 2：

我想回答我自己的问题（在更新 1 中）以下代码证明将引用分配给引用不会导致复制...

```
#include <iostream>
#include <string>

using namespace std;

class Data
{
public:
    string mName;

    Data(const string &name) : mName(name)
    { cout << mName << " default ctor" << endl; }

    Data(const Data& other)
    {
        mName = other.mName + " (copy)";
        cout << mName << " copy ctor" << endl;
    }

    ~Data()
    { cout << mName << " dtor" << endl; }

    static Data &getData(const string &name)
    {
        Data *d = new Data(name);
        return *d;
    }
};

int main()
{
    cout << "d1..." << endl;
    Data d1 = Data::getData("d1");

    cout << "d2..." << endl;
    Data d2("d2");

    cout << "d3..." << endl;
    Data &d3 = Data::getData("d3");

    cout << "return..."  << endl;
    return 0;
} 
```

产生以下结果...

```
d1...
d1 default ctor
d1 (copy) copy ctor
d2...
d2 default ctor
d3...
d3 default ctor
return...
d2 dtor
d1 (copy) dtor 
```

感谢 Eric Melski[的出色回答](https://stackoverflow.com/questions/765971/is-memory-allocated-with-new-ever-automatically-freed/766002#766002)（我在更新 2 中的代码是他的示例代码的修改副本）。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-19T20:11:35.243

实际上两者都`d1`将`d2`被释放，因为它们都在堆栈上。未释放的是`Data`您在`getData()`函数中分配的对象。`Data`如果您在构造函数和析构函数中使用检测来充实您的类，您可以更清楚地看到这一点。例如：

```
class Data {
public:
    Data() { cout << "Data default ctor" << endl; }
    Data(const Data& other) { cout << "Data copy ctor" << endl; }
    ~Data() { cout << "Data dtor" << endl; }

    static Data& getData()
    {
        Data *i = new Data();
        return *i;
    }
}; 
```

请注意，我已经明确声明了`Data`. 在您的示例中，当您这样做时，您会隐式调用该构造函数`Data d1 = getData();`，我怀疑这就是您的困惑所在。现在，如果我运行这个简单的程序：

```
#include <iostream>
using namespace std;

int main(int argc, char *argv[])
{
    Data d1 = Data::getData();
    Data d2;

    return 0;
} 
```

输出如下：

```
Data default ctor
Data copy ctor
Data default ctor
Data dtor
Data dtor 
```

逐行，这是您所看到的：

1.  当您分配一个新`Data`的 in时，会调用默认构造函数`getData()`。
2.  调用复制构造函数以从您刚刚创建`d1`的动态分配中创建。`Data`
3.  调用默认构造函数来创建`d2`.
4.  析构函数`d2`在结束时超出范围时调用`main()`。
5.  析构函数`d1`在结束时超出范围时调用`main()`。

请注意，有 3 个构造函数调用，但只有 2 个析构函数调用——表明您只泄漏了一个`Data`对象。

希望有帮助，

埃里克·梅尔斯基

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-19T19:59:57.487

`d1`是一个堆栈对象，从`getData()`. `d1`被释放，但在其中创建的对象`getData()`被泄露。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-19T20:00:02.197

`d1`并且`d2`都是堆栈对象，因此将在其作用域结束时被销毁，问题是`getData()`创建了一个永远不会删除的新堆对象。`d1`从对该堆对象的引用进行复制初始化，并且`d1`其自身将在 结束时正确销毁，但不会删除`exampleFunc`每次调用中生成的堆对象。`getData()`

使用具有的签名`getData()`可以删除此对象，但返回对需要删除的内容的引用不是惯用的接口。

工作，但不是一个好的界面：

```
Data& d = getData();
delete &d; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-19T20:05:14.180

只有当操作系统在程序终止时自动回收它时，才能恢复记忆。在程序执行期间，您发布的内容将导致内存泄漏，因为 C++ 没有内置的垃圾收集器，并且需要对堆分配的对象进行手动内存管理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T20:39:29.933

这是 Java/C# 程序员的典型“思维方式”。

在 C++ 中，您实际上可能比您想象的更多地使用值类型：

```
Data getData()
{
    Data i;
    return i;
}

void exampleFunc()
{
    Data d1 = getData();
    /* d1 is constructed here and destroyed */
    Data d2;

} 
```

如果你想返回指针，例如当你有一些只使用智能指针的派生类时`auto_ptr`，允许所有权移动：

```
auto_ptr<Data> getData()
{
    auto_ptr<Data> i(new Data());
    return i;
}

void exampleFunc()
{
    auto_ptr<Data> d1 = getData();
    /* now d1 is destroyed when goes out of scope */
    Data d2;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-19T20:00:11.837

你在这点上是对的。您必须使用 delete 或 delete[] 显式释放内存。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-19T20:38:58.033

准确地说，你的问题的答案是肯定的。

在这段代码中：

```
int main()
{
Data* d = new Data();
return 0;   //end of execution
} 
```

**d**指向的数据在执行结束时由操作系统自动释放。

换句话说，所有由完成执行但没有被它（程序）释放的程序分配的数据，将在执行之后（而不是在执行期间）被操作系统释放。

# java - 如何从 InputStream 中获取 SelectableChannel？

> ID：765981
> 
> 赞同：2
> 
> 时间：2009-04-19T20:00:13.430
> 
> 标签：java, inputstream

我想从 java.io.InputStream 中读取超时。显然正确的方法是使用 java.nio.channels.SelectableChannel 和 java.nio.channels.Selector。不幸的是，尚不清楚如何从 InputStream 转到 SelectableChannel。

InputStream 来自非常规来源[——http://java.sun.com/products/javacomm/reference/api/javax/comm/CommPort.html#getInputStream()](http://java.sun.com/products/javacomm/reference/api/javax/comm/CommPort.html#getInputStream())

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T20:05:03.620

并非所有`InputStream`s 都保证是可选的，因此没有直接的方法可以做到这一点。不幸的是，`CommPort`该类没有返回 a 的方法`SelectableChannel`；没有简单的、可移植的方法来实现这一点（即，不完全破坏封装）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T21:27:17.207

蔚来在这方面被打破了。您所要做的就是查看一下代码并查看所有要求通道为 SocketChannel 等的强制转换。不可能像应有的那样将 NIO 中的任何内容重用于另一种基于文件描述符的 I/O 通道。

最后我问没有计划解决这个问题以进行通用重用。

# wpf - 带有 DataTemplates 的 WPF ListBoxItems - 如何从 DataTemplate 中引用绑定到 ListBoxItem 的 CLR 对象？

> ID：765984
> 
> 赞同：9
> 
> 时间：2009-04-19T20:01:51.507
> 
> 标签：wpf, listbox, datatemplate, listboxitem

我有一个 ListBox，它绑定到一个`ObservableCollection`.

每个`ListBoxItem`都显示为`DataTemplate`. 我的 中有一个按钮，单击该按钮`DataTemplate`时需要引用它的成员，`ObservableCollection`它是 DataTemplate 的一部分。我无法使用该`ListBox.SelectedItem`属性，因为单击按钮时该项目没有被选中。

所以要么：我需要弄清楚如何正确设置`ListBox.SelectedItem`鼠标悬停或单击按钮时的设置。或者我需要找出另一种方法来获取对绑定到`ListBoxItem`按钮所属的 CLR 对象的引用。第二个选项看起来更干净，但任何一种方式都可能没问题。

下面的简化代码段：

XAML：

```
<DataTemplate x:Key="postBody">
    <Grid>
        <TextBlock Text="{Binding Path=author}"/>
        <Button Click="DeleteButton_Click">Delete</Button>
    </Grid>
</DataTemplate>

<ListBox ItemTemplate="{StaticResource postBody}"/> 
```

C＃：

```
private void DeleteButton_Click(object sender, RoutedEventArgs e)
{
    Console.WriteLine("Where mah ListBoxItem?");
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-19T20:13:39.077

一般来说，人们会对直接绑定的 CLR 对象感兴趣`ListBoxItem`，而不是实际的`ListBoxItem`。例如，如果您有一个帖子列表，您可以使用您现有的模板：

```
<DataTemplate x:Key="postBody" TargetType="{x:Type Post}">
  <Grid>
    <TextBlock Text="{Binding Path=author}"/>
    <Button Click="DeleteButton_Click">Delete</Button>
  </Grid>
</DataTemplate>
<ListBox ItemTemplate="{StaticResource postBody}" 
  ItemSource="{Binding Posts}"/> 
```

并且在您的代码隐藏中，您`Button`的 's`DataContext`等于您`DataTemplate`的 's `DataContext`。在这种情况下，一个`Post`.

```
private void DeleteButton_Click(object sender, RoutedEventArgs e){
  var post = ((Button)sender).DataContext as Post;
  if (post == null)
    throw new InvalidOperationException("Invalid DataContext");

  Console.WriteLine(post.author);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T20:22:14.967

您有多种可能性，具体取决于您需要做什么。

首先，主要问题是：“你为什么需要这个”？大多数时候，对容器项的引用并没有真正的用处（不是说这是你的情况，但你应该详细说明）。如果您正在对列表框进行数据绑定，则很少有这种情况。

其次，如果`myListBox.ItemContainerGenerator.ContainerFromItem()`您的列表框名为，您可以使用 获取列表框中的项目`MyListBox`。从 sender 参数中，您可以取回模板化的实际项目，例如（`XXX`数据绑定数据的类型在哪里）：

```
Container = sender as FrameworkElement;
if(sender != null)
{
    MyItem = Container.DataContext as XXX;
    MyElement = MyListBox.ItemContainerGenerator.ContainerFromItem(MyItem); // <-- this is your ListboxItem.
} 
```

[您可以在此博客](http://www.beacosta.com/blog/?p=7)中找到一个示例。她使用 index 方法，但 Item 方法类似。

# java - 如何以极简的方式“打电话回家”？

> ID：765992
> 
> 赞同：1
> 
> 时间：2009-04-19T20:05:55.927
> 
> 标签：java, web, installation

我正在寻找在某处成功安装程序时获得通知的最简单方法。我的应用程序是基于 Java 的并且有 Java 安装程序，我可以轻松地建立一个客户端来使用任何参数进行任何 http 调用，这不是问题。我的问题在另一边——我有托管网站，我希望将所有流量引导到那里，但我不熟悉编程世界的那一部分 :) 如果每次成功安装都会转储记录，那就太好了在数据库中（我已经在现场集成了 MySql）。另一种选择是给我发一封电子邮件，或者至少拖到一个日志文件中。越简单越好。两者都可以。有人可以提出一种方法吗？我知道一点 PHP，也许可以做一些简单的事情，但是没有示例或起点，它'

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T20:11:30.483

您的网站是否已经有日志记录？如果是这样，您已经有一个日志文件，您可以用 grep 查找相应的 URL。无需编程 :) 只是不要从其他任何地方链接到该 URL，并且您不应该以任何误报告终。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-19T20:24:40.267

我认为 Jon Skeet 已经很好地回答了这些问题，但是..

如果您打电话回家 - 出于礼貌，请务必通知用户并征得他们的许可。

如果不这样做，您可能会发现自己的名声不好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T20:16:37.773

使用 PHP 脚本将非常简单。您可以只传递查询字符串中的所有数据：

```
// For example, just a simple http call to log.example.com/?version=3.4.5b
$version = $_GET['version']; 

$dbh = new PDO('mysql:host=localhost;dbname=mydb', 'myuser', 'mypass');

$sth = $dbh->prepare("INSERT INTO log SET version = :version, installed_at = :installed_at");
$sth->bindParam(':version', $version, PDO::PARAM_STR);
$sth->bindParam(':installed_at', time(), PDO::PARAM_INT);
$sth->exec(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T20:09:49.053

是否要计算应用程序的所有安装？那么“打电话回家”不是处理事情的正确方式。为什么不只计算应用程序的下载量？如果有人下载它，通常也会安装它。

如果您对安装程序中的潜在错误更感兴趣，您可以在要求用户执行此操作**后撰写报告并将其发送到您的服务器。**

# javascript - 提示用户在离开页面时保存

> ID：765996
> 
> 赞同：14
> 
> 时间：2009-04-19T20:06:57.967
> 
> 标签：javascript, jquery, html

我需要在用户离开页面时提示他们保存他们的工作。我已经尝试过 onbeforeunload 但我需要显示一个样式提示而不是通常的对话框。Facebook 已经成功实现了这一点（如果你有 Facebook 帐户，编辑你的个人资料信息并转到另一个页面而不保存，你会得到一个风格化的提示）。我也尝试过 jquery unload，但似乎没有办法阻止 unload 事件传播。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-19T20:19:50.510

仔细看看 Facebook 正在做什么：如果您单击*页面上*的链接，您会收到提示，但在地址栏中输入新 URL、单击书签或导航返回浏览器历史记录时没有提示。

如果这对您有用，那么很容易做到：只需`click`向页面上的每个链接添加一个事件处理程序，并从中触发您的程式化确认。*由于这些处理程序将在页面本身触发的任何导航事件开始*之前被调用，因此您几乎可以在处理程序中做任何您想做的事情 - 保存数据，完全取消事件，记录预期的目的地并将其推迟到他们确认后...

但是，如果您确实需要或想要响应外部触发的导航事件，则必须使用`onbeforeunload`. 是的，对话很糟糕，你不能取消活动——这就是我们为 90 年代滥用这些功能的所有可耻的白痴付出的代价。对不起...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-20T19:56:55.877

选择的答案很好，但我仍然不得不挖掘细节。如果你想使用 onbeforeunload 事件，这里有一些示例代码：

```
<script>
window.onbeforeunload= function() { return "Custom message here"; };
</script> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-10T23:07:38.867

为了改进这里其他人的答案，我开发了一个很棒的小脚本。

```
 $('.measurement_value').change(function() {
        $(window).bind('beforeunload', function(){
            return 'You have unsaved changes, are you sure you want to leave?';
        });

        $('#MeasurementAdminEditForm').submit(function(){
            $(window).unbind('beforeunload');
        });
        $('#CancelButton').click(function(){
            $(window).unbind('beforeunload');
        });
    }); 
```

在我的每个表单元素上，我给出了一个“measurement_value”类，然后只有在其中一个元素发生变化时才加载 beforeunload。此外，我在提交表单并单击取消按钮时卸载了 beforeunload。

希望这对其他人有帮助。**************