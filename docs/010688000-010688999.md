# StackOverflow 问答 10688000-10688999

# python - 生成间隔之间的日期时间列表

> ID：10688006
> 
> 赞同：56
> 
> 时间：2012-05-21T15:18:04.167
> 
> 标签：python, list, datetime, date, period

给定两个日期时间（`start_date`和`end_date`），我想生成这两个日期之间的其他日期时间列表，新的日期时间由可变间隔分隔。例如，2011 年 10 月 10 日和 2011 年 12 月 12 日之间每 4 天一次，或者从现在到明天晚上 19​​ 点之间每 8 小时一次。

也许大致相当于[Dateperiod](http://php.net/manual/en/class.dateperiod.php) PHP 类。

在 Python 中完成此任务的最有效方法是什么？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2012-05-21T15:22:49.337

使用[`datetime.timedelta`](http://docs.python.org/library/datetime.html#timedelta-objects)：

```
from datetime import date, datetime, timedelta

def perdelta(start, end, delta):
    curr = start
    while curr < end:
        yield curr
        curr += delta

>>> for result in perdelta(date(2011, 10, 10), date(2011, 12, 12), timedelta(days=4)):
...     print result
...
2011-10-10
2011-10-14
2011-10-18
2011-10-22
2011-10-26
2011-10-30
2011-11-03
2011-11-07
2011-11-11
2011-11-15
2011-11-19
2011-11-23
2011-11-27
2011-12-01
2011-12-05
2011-12-09 
```

适用于日期和日期时间对象。你的第二个例子：

```
>>> for result in perdelta(datetime.now(),
...         datetime.now().replace(hour=19) + timedelta(days=1),
...         timedelta(hours=8)):
...     print result
... 
2012-05-21 17:25:47.668022
2012-05-22 01:25:47.668022
2012-05-22 09:25:47.668022
2012-05-22 17:25:47.668022 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-05-21T15:40:18.570

试试这个：

```
from datetime import datetime
from dateutil.relativedelta import relativedelta

def date_range(start_date, end_date, increment, period):
    result = []
    nxt = start_date
    delta = relativedelta(**{period:increment})
    while nxt <= end_date:
        result.append(nxt)
        nxt += delta
    return result 
```

问题中的示例“从现在到明天 19:00 之间每 8 小时”将这样写：

```
start_date = datetime.now()
end_date = start_date + relativedelta(days=1)
end_date = end_date.replace(hour=19, minute=0, second=0, microsecond=0)
date_range(start_date, end_date, 8, 'hours') 
```

请注意，有效值`period`是为相关信息定义的值[`relativedelta`](http://labix.org/python-dateutil#head-6a1472b7c74e5b8bab7784f11214250d34e09aa5)，即：`'years', 'months', 'weeks', 'days', 'hours', 'minutes', 'seconds', 'microseconds'`。

根据问题的要求，我的解决方案返回一个*list*。如果您一次不需要所有元素，则可以使用生成器，如@MartijnPieters 的回答。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-12-08T10:07:49.363

我真的很喜欢@Martijn Pieters 和@Óscar López 的两个答案。让我在这两个答案之间提出我的综合解决方案。

```
from datetime import date, datetime, timedelta

def datetime_range(start, end, delta):
    current = start
    if not isinstance(delta, timedelta):
        delta = timedelta(**delta)
    while current < end:
        yield current
        current += delta

start = datetime(2015,1,1)
end = datetime(2015,1,31)

#this unlocks the following interface:
for dt in datetime_range(start, end, {'days': 2, 'hours':12}):
    print dt
    print dt

2015-01-01 00:00:00
2015-01-03 12:00:00
2015-01-06 00:00:00
2015-01-08 12:00:00
2015-01-11 00:00:00
2015-01-13 12:00:00
2015-01-16 00:00:00
2015-01-18 12:00:00
2015-01-21 00:00:00
2015-01-23 12:00:00
2015-01-26 00:00:00
2015-01-28 12:00:00 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-06-20T22:31:31.443

如果您想依赖第三方库，则此处建议的解决方案适用于几天、几小时等的间隔`timedelta`，或者任何支持的东西。`dateutil.relativedelta`但我想以**yyyymm格式分享我针对每月间隔的特定情况的解决方案，在**[这里](https://stackoverflow.com/questions/28042298/how-to-generate-a-range-of-yyyymm-values)询问（但标记为该问题的副本）。

```
def iterate_months(start_ym, end_ym):
    for ym in range(int(start_ym), int(end_ym) + 1):
        if ym % 100 > 12 or ym % 100 == 0:
            continue
        yield str(ym)

list(iterate_months('201710', '201803')) 
```

输出：

```
['201710', '201711', '201712', '201801', '201802', '201803'] 
```

这个解决方案非常适合这种对 yyyymm 格式的特殊需求（尽管它至少在我的世界中经常出现）并且可能不是大量`continue`s 的最有效答案，但具有简洁、易于使用的优点理解，并且不涉及许多库或日期转换代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-01T15:23:06.337

到目前为止，此处给出的所有解决方案都特定于 start < stop 的情况，但您可以使用 operator 模块轻松调整它们以处理 stop < start 的情况，如下代码所示，改编自 @MartijnPieters 的答案。

```
import datetime
import operator

def time_range(start: datetime.datetime, stop, step: datetime.timedelta):
    "Imitate range function for datetimes instead of ints."
    sec = step.total_seconds()
    if sec == 0:
        raise ValueError("step must not be 0 seconds")
    if sec < 0:
        compare = operator.gt
    else:
        compare = operator.lt
    x = start
    while compare(x, stop):
        yield x
        x += step  # immutable 
```

# objective-c - 如何修复较新 SDK 中引入的选择器“可能无法响应”？

> ID：10688008
> 
> 赞同：1
> 
> 时间：2012-05-21T15:18:12.450
> 
> 标签：objective-c, macos, osx-lion

我有一个针对 10.5 SDK 构建的应用程序。我仍然希望它在 10.7 系统上运行时能够正常运行。代码片段

```
if ([window respondsToSelector:@selector(setRestorable:)])
{
  [window setRestorable:NO];
} 
```

但是，会触发编译器警告

```
'NSWindow' may not respond to '-setRestorable:' 
```

因为在 10.7 SDK 中引入了 setRestorable 选择器。解决此问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:46:10.093

尝试在某些标头中创建一个虚拟（从未使用过）协议，并确保将其导入到您使用它的源中：

```
@protocol Compatibility
- (void)setRestorable:(BOOL)flag;
@end 
```

我相信这应该让编译器相信该类可能会实现该协议（即使没有在其标头中明确指定）并且应该停止抱怨。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:59:50.887

我发现的一种可能性是：

```
if ([window respondsToSelector:@selector(setRestorable:)])
{
  IMP setRestorableFunc =
    [window methodForSelector:@selector(setRestorable:)];

  setRestorableFunc(window, @selector(setRestorable:), NO);
} 
```

不过，不确定这是否是最佳选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T21:13:24.267

只需将其转换为`id`：

```
if ([window respondsToSelector:@selector(setRestorable:)])
{
  [(id)window setRestorable:NO];
} 
```

# wpf - XAML 中样式的奇怪行为

> ID：10688014
> 
> 赞同：1
> 
> 时间：2012-05-21T15:18:54.220
> 
> 标签：wpf, xaml

我不明白为什么会这样。我在 WPF 中有一个简单的应用程序。这个应用程序有一个窗口，并且在 App.xaml 中定义了一种样式，它改变了所有按钮的样式：

```
<Application x:Class="PruebasDesk.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             StartupUri="Window1.xaml">
    <Application.Resources>
        <Style TargetType="{x:Type Button}">
            <Setter Property="Height" Value="23"></Setter>
            <Setter Property="Width" Value="75"></Setter>
            <Setter Property="Background" Value="DarkCyan"></Setter>
        </Style>
    </Application.Resources>
</Application> 
```

这很好用，所有按钮都有样式。现在，问题来了。如果我不使用 StartupUri 属性来启动应用程序，而是使用 OnStartup 方法启动它：

```
public partial class App : Application
    {
        protected override void OnStartup(StartupEventArgs e)
        {
            Window1 win1 = new Window1();
            win1.Show();
        }
    } 
```

应用程序的按钮不会应用在 App.xaml 中定义的按钮样式。但是...如果我向 App.xaml 添加另一种样式，如下所示：

```
<Application x:Class="PruebasDesk.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             >
    <Application.Resources>
        <Style TargetType="{x:Type Button}">
            <Setter Property="Height" Value="23"></Setter>
            <Setter Property="Width" Value="75"></Setter>
            <Setter Property="Background" Value="DarkCyan"></Setter>
        </Style>
        <Style TargetType="{x:Type TextBox}">
            <Setter Property="Height" Value="23"></Setter>
            <Setter Property="Width" Value="180"></Setter>
            <Setter Property="Background" Value="Azure"></Setter>
        </Style>
    </Application.Resources>
</Application> 
```

然后按钮应用样式！！！这对我来说真的很奇怪。有谁知道我是否遗漏了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:34:14.380

我不能肯定地告诉你为什么会发生这种行为，但我可以告诉你，最佳实践会引导你远离`App.xaml`以这种方式使用。我认为更好的做法是仅在 app.xaml 中合并您的资源字典。存储实际样式是创建难以管理的项目的好方法。

创建一个新的 ResourceDictionary 文件并添加这些样式。在添加更多字典时合并字典。

```
 <Application.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="Common.xaml"/>
      </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
  </Application.Resources> 
```

或者，您可以挂钩事件`Startup`(app.xaml: `Startup="App_Startup"`) 而不是覆盖`OnStartup`。这将适用于您定义的 App.xaml 资源设置。这很可能是一个时间问题。

# jquery - jCarouselLite - 强制列表项到单行

> ID：10688017
> 
> 赞同：1
> 
> 时间：2012-05-21T15:19:06.910
> 
> 标签：jquery, jcarousel, jcarousellite

我在我正在构建的网站的列表中使用 jCarouselite。它工作得很好，但问题是由于某种原因，脚本导致列表项停止堆叠。

我的意思是 - 而不是这个：

```
li     li
li     li 
```

我得到这个：

```
li     li     li      li 
```

当我删除脚本时它工作正常，但是有了它，它迫使它们全部到一个“行”上。我查看了脚本，无法弄清楚是什么部分将它们全部放在一行上。

这是脚本：[http ://www.trekradio.net/dev/wp-content/themes/tr2012/js/jcarouselite_1.0.1.js](http://www.trekradio.net/dev/wp-content/themes/tr2012/js/jcarousellite_1.0.1.js)

您还可以在 Heaer 的“Whats On”部分查看该问题的演示：[http](http://www.trekradio.net/dev/) ://www.trekradio.net/dev/ （此站点正在建设中，请原谅其状态）。

编辑：在脚本中将“垂直”选项设置为“真”会将轮播滚动更改为垂直并显示这样的列表项，这不是我想要的：

```
li

li

li

li 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:55:09.203

**更新：[丑陋的修复]**

这是您需要更新的行`jcarousellite_1.0.1.js`（您添加一`/ 2` 点点）：

```
 var ulSize = liSize * itemLength / 2;                   // size of full ul(total length, not just for the visible items) 
```

请注意，因为它会影响任何其他页面中的所有其他轮播。

**更新 2：向后兼容修复**

我修补了 .js 文件，您可以`lines`在代码中使用选项，或者默认保留 1 行：

```
<script type="text/javascript">
$(function() {
    $(".anyClass").jCarouselLite({
        btnNext: ".next",
        btnPrev: ".prev",
        lines : 2
    });
});
</script> 
```

这里是[补丁`jcarousellite_1.0.1.js`](http://paste.org/49668)

祝你好运 ！

--

恐怕这会使 jCarouselLite 有点过分弯曲。

我建议您通过 PHP 甚至通过在 Javascript/jquery 中操作 DOM将其分成`li`两部分。`ul`

这样，您可以通过设置两个平行的水平旋转木马一起运行来实现您的目标。

希望这可以帮助 ！

# windows - 如何使用 xcacls.vbs 设置权限

> ID：10688018
> 
> 赞同：0
> 
> 时间：2012-05-21T15:19:08.613
> 
> 标签：windows, vbscript

我们正在使用 xcacls.vbs 来修改 NTFS 权限 (support.microsoft.com/kb/825751)。

句法：

```
xcacls.vbs C:\TestFolder /G  DOMAIN\USER: RW /E 
```

RW - 读写 F - 完全访问

如何只授予读取、写入、修改、读取和执行权限？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T11:20:32.833

它在附带 xcacls.vbs 的文档中，我将其粘贴在这里，但您需要以下内容

```
xcacls.vbs C:\TestFolder /G  DOMAIN\USER: RWMX /E 
```

这里的语法

```
 Syntax for the Xcacls.vbs Command
The following output of the xcacls.vbs /? command describes the Xcacls.vbs command syntax:
Usage:
XCACLS filename [/E] [/G user:perm;spec] [...] [/R user [...]]
                [/F] [/S] [/T]
                [/P user:perm;spec [...]] [/D user:perm;spec] [...]
                [/O user] [/I ENABLE/COPY/REMOVE] [/N
                [/L filename] [/Q] [/DEBUG]

   filename            [Required] If used alone, it displays ACLs.
                       (Filename can be a filename, directory name or
                       wildcard characters and can include the whole
                       path. If path is missing, it is assumed to be
                       under the current directory.)
                       Notes:
                       - Put filename in quotes if it has spaces or
                       special characters such as &, $, #, etc.
                       - If filename is a directory, all files and
                       subdirectories under it will NOT be changed
                       unless the /A is present.

   /F                  [Used with Directory or Wildcard] This will change all
                       files under the inputted directory but will NOT
                       traverse subdirectories unless /T is also present.
                       If filename is a directory, and /F is not used, no
                       files will be touched.

   /S                  [Used with Directory or Wildcard] This will change all
                       subfolders under the inputted directory but will NOT
                       traverse subdirectories unless /T is also present.
                       If filename is a directory, and /S is not used, no
                       subdirectories will be touched.

   /T                  [Used only with a Directory] Traverses each
                       subdirectory and makes the same changes.
                       This switch will traverse directories only if the
                       filename is a directory or is using wildcard characters.
   /E                  Edit ACL instead of replacing it.

   /G user:GUI         Grant security permissions similar to Windows GUI
                       standard (non-advanced) choices.
   /G user:Perm;Spec   Grant specified user access rights.
                       (/G adds to existing rights for user)

                       User: If User has spaces in it, enclose it in quotes.
                             If User contains #machine#, it will replace
                             #machine# with the actual machine name if it is a
                             non-domain controller, and replace it with the
                             actual domain name if it is a domain controller.

                             New to 3.0: User can be a string representing
                             the actual SID, but MUST be lead by SID#
                             Example: SID#S-1-5-21-2127521184-160...
                                      (SID string shown has been shortened)
                                      (If any user has SID# then globally all
                                       matches must match the SID (not name)
                                       so if your intention is to apply changes
                                       to all accounts that match Domain\User
                                       then do not specify SID# as one of the
                                       users.)

                       GUI: Is for standard rights and can be:
                             Permissions...
                                    F  Full control
                                    M  Modify
                                    X  read and eXecute
                                    L  List folder contents
                                    R  Read
                                    W  Write
                             Note: If a ; is present, this will be considered
                             a Perm;Spec parameter pair.

                       Perm: Is for "Files Only" and can be:
                             Permissions...
                                    F  Full control
                                    M  Modify
                                    X  read and eXecute
                                    R  Read
                                    W  Write
                             Advanced...
                                    D  Take Ownership
                                    C  Change Permissions
                                    B  Read Permissions
                                    A  Delete
                                    9  Write Attributes
                                    8  Read Attributes
                                    7  Delete Subfolders and Files
                                    6  Traverse Folder / Execute File
                                    5  Write Extended Attributes
                                    4  Read Extended Attributes
                                    3  Create Folders / Append Data
                                    2  Create Files / Write Data
                                    1  List Folder / Read Data
                       Spec is for "Folder and Subfolders only" and has the
                       same choices as Perm.

   /R user             Revoke specified user's access rights.
                       (Will remove any Allowed or Denied ACL's for user.)

   /P user:GUI         Replace security permissions similar to standard choices.

   /P user:perm;spec   Replace specified user's access rights.
                       For access right specification see /G option.
                       (/P behaves like /G if there are no rights set for user.)

   /D user:GUI         Deny security permissions similar to standard choices.
   /D user:perm;spec   Deny specified user access rights.
                       For access right specification see /G option.
                       (/D adds to existing rights for user.)

   /O user             Change the Ownership to this user or group.

   /I switch           Inheritance flag.  If omitted, the default is to not touch
                       Inherited ACL's. Switch can be:
                          ENABLE - This will turn on the Inheritance flag if
                                   it is not on already.
                          COPY   - This will turn off the Inheritance flag and
                                   copy the Inherited ACL's
                                   into Effective ACL's.
                          REMOVE - This will turn off the Inheritance flag and
                                   will not copy the Inherited
                                   ACL's.  This is the opposite of ENABLE.
                          If switch is not present, /I will be ignored and
                          Inherited ACL's will remain untouched.

   /L filename         Filename for Logging. This can include a path name
                       if the file is not under the current directory.
                       File will be appended to, or created if it does not
                       exit. Must be Text file if it exists or error will occur.

                       If filename is omitted, the default name of XCACLS will
                       be used.

   /Q                  Turn on Quiet mode.  By default, it is off.
                       If it is turned on, there will be no display to the screen.

   /DEBUG              Turn on Debug mode. By default, it is off.
                       If it is turned on, there will be more information
                       displayed and/or logged. Information will show
                       Sub/Function Enter and Exit as well as other important
                       information.

   /SERVER servername  Enter a remote server to run script against.

   /USER username      Enter Username to impersonate for Remote Connections
                            (requires PASS switch).  Will be ignored if it is for a Local Connection.

   /PASS password      Enter Password to go with USER switch
                            (requires USER switch).

Wildcard characters can be used to specify more than one file in a command, such as:
                                *       Any string of zero or more characters
                                ?       Any single character

You can specify more than one user in a command.
You can combine access rights.

back to the top 
Use Xcacls.vbs to View Permissions

You can also use Xcacls.vbs to view permissions for files or folders. For example, if you have a folder that is named C:\Test, type the following at a command prompt to view the folder permissions, and then press ENTER: 
xcacls.vbs c:\testThe following example is a typical result:
C:\>XCACLS.VBS c:\test
Microsoft (R) Windows Script Host Version 5.6
Copyright (C) Microsoft Corporation 1996-2001\. All rights reserved.

Starting XCACLS.VBS (Version: 3.4) Script at 6/11/2003 10:55:21 AM

Startup directory:
"C:\test"

Arguments Used:
        Filename = "c:\test"

**************************************************************************
Directory: C:\test

Permissions:
Type     Username                Permissions           Inheritance

Allowed  BUILTIN\Administrators  Full Control          This Folder, Subfolde
Allowed  NT AUTHORITY\SYSTEM     Full Control          This Folder, Subfolde
Allowed  Domain1\User1           Full Control          This Folder Only
Allowed  \CREATOR OWNER          Special (Unknown)     Subfolders and Files
Allowed  BUILTIN\Users           Read and Execute      This Folder, Subfolde
Allowed  BUILTIN\Users           Create Folders / Appe This Folder and Subfo
Allowed  BUILTIN\Users           Create Files / Write  This Folder and Subfo

No Auditing set

Owner: Domain1\User1

Note The output of the xcacls.vbs c:\test command in this example matches the text that is shown in the graphical user interface (GUI). Some words are incomplete in the command window.

The output also gives the version of the script, the startup directory, and the arguments that were used. 

You can also use wildcard characters to display matching files under the directory. For example, if you type the following, all files with an extension of ".log" that are in the C:\Test folder are displayed: 
xcacls.vbs c:\test\*.logback to the top 
```

**例子**

以下 Xcacls.vbs 命令提供了 Xcacls.vbs 用法的一些示例。

```
xcacls.vbs c:\test\ /g domain\testuser1:f /f /t /e 
```

此命令编辑现有权限。它授予 Domain\TestUser1 对 C:\Test 下所有文件的完全控制权，它遍历 C:\Test 下的子文件夹，然后更改找到的所有文件。此命令不涉及目录。

```
xcacls.vbs c:\test\ /g domain\testuser1:f /s /l "c:\xcacls.log" 
```

此命令替换现有权限。它授予 Domain\TestUser1 对 C:\Test 下所有子文件夹的完全控制权，并将日志记录到 C:\Xcacls.log。该命令不接触文件，也不遍历目录。

```
xcacls.vbs c:\test\readme.txt /o "machinea\group1" 
```

此命令将 Readme.txt 的所有者更改为组 MachineA\Group1。

```
xcacls.vbs c:\test\badcode.exe /r "machinea\group1" /r "domain\testuser1" 
```

此命令撤销 MachineA\Group1 和 Domain\TestUser1 对 C:\Test\Badcode.exe 的权限。

```
xcacls.vbs c:\test\subdir1 /i enable /q 
```

此命令打开文件夹 C:\Test\Subdir1 上的继承。它抑制任何屏幕输出。

```
xcacls.vbs \\servera\sharez\testpage.htm /p "domain\group2":14 
```

此命令使用 Windows Management Instrumentation (WMI) 远程连接到 \ServerA\ShareZ。然后它获取该共享的本地路径，并在该路径下更改对 Testpage.htm 的权限。它保留 Domain\Group2 的现有权限不变，但它添加了权限 1（读取数据）和 4（读取扩展属性）。由于未使用 /e 开关，该命令会删除该文件的其他权限。

```
xcacls.vbs d:\default.htm /g "domain\group2":f /server servera /user servera\admin /pass password /e 
```

此命令使用 WMI 作为 ServerA\Admin 远程连接到 ServerA，然后将 Default.htm 的完全权限授予 Domain\Group2。Domain\Group2 的现有权限丢失，文件的其他权限仍然存在。返回顶部

# silverlight - 拍摄照片后对齐照片，用于显示 wp7

> ID：10688023
> 
> 赞同：1
> 
> 时间：2012-05-21T15:19:58.450
> 
> 标签：silverlight, image, windows-phone-7, camera

我正在使用相机任务拍照然后显示它。我有一个图像控件设置为 480 x 728 大小，这是相机取景器的大小。我告诉图像控件的来源是拍摄照片后选择的照片。问题是图片总是水平的而不是垂直的。如果我正在拍摄风景照片，但当我拍摄肖像照片时，这很有用。如果以纵向拍摄，我希望它填充图像控制肖像，反之亦然。有没有人可以解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:40:03.733

您可能需要对图像应用变换以正确显示图像，这在以下博客文章中有所介绍：-

[http://timheuer.com/blog/archive/2010/09/23/working-with-pictures-in-camera-tasks-in-windows-phone-7-orientation-rotation.aspx](http://timheuer.com/blog/archive/2010/09/23/working-with-pictures-in-camera-tasks-in-windows-phone-7-orientation-rotation.aspx)

# javascript - 来自 1000 个元素的数组中的 50 个随机唯一元素？

> ID：10688027
> 
> 赞同：5
> 
> 时间：2012-05-21T15:20:08.783
> 
> 标签：javascript, arrays, random

从 1000 个元素的数组中获取 50 个随机唯一元素的最简单方法是什么？

```
text = new Array();
for(i=0;i<1000;i++){ text[i]=i; }   //array populated
// now I need to get 50 random unique elements from this array. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T15:24:18.220

（对我来说）显而易见的方法是对数组进行洗牌，然后取前 50 个元素。 [这个问题](https://stackoverflow.com/questions/2450954/how-to-randomize-a-javascript-array)有一个很好的方法来洗牌一个数组，然后你可以[`slice`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/slice)前五十个元素。这保证了元素是唯一的。

因此，使用那里的功能：

```
fisherYates(text);
text = text.slice(0, 50); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:24:07.900

[本主题](https://stackoverflow.com/questions/1608181/unique-random-numbers-in-an-integer-array-in-the-c-programming-language)中解释了好的算法（在 C 中，但您可以在 JS 中轻松地做同样的事情）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:15:44.630

这假设您的意思是随机索引而不是具有唯一值的索引。

一种方法是复制数组并删除您使用的数组：

```
function getRandomIndexes( arr, cnt){
    var randomArr = [],
        arrCopy = arr.slice(),
        i, 
        randomNum ;
    for (i=0;i<arrCopy.length;i++) {
        randomNum = Math.floor( arrCopy.length * Math.random());
        randomArr = randomArr.concat(  arrCopy.splice(randomNum ,1) );
    }    
    return randomArr;
}

var myNums = [], i, randSet;
for (i=0;i<10;i++){
    myNums.push(i);
}
randSet = getRandomIndexes(myNums, 5); 
```

另一种方法是跟踪您使用的索引并继续查找，直到找到您未使用的索引。我发现 while 循环很可怕，如果随机索引需要接近数组长度，我个人不会使用此解决方案。

```
function getRandomIndexes( arr, cnt){
    var randomArr = [],
        usedNums = {},
        x;
    while (randomArr.length<cnt) {
        while (usedNums[x]===true || x===undefined) {
            x = Math.floor( Math.random() * arr.length);
        }
        usedNums[x] = true;
        randomArr.push( arr[x] );
    }
    return randomArr;
}

var myNums = [], i, randSet;
for (i=0;i<10;i++){
    myNums.push(i);
}
randSet = getRandomIndexes(myNums, 5); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T15:24:21.537

研究[Fisher-Yates 算法](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)，我认为这对你有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T15:29:53.223

```
var arr = [];
while(arr.length < 51){
    var ind = Math.floor(Math.random()*1000);
    if(!(ind in arr))
        arr.push(ind)
} 
```

您将在数组 arr 中有 50 个随机唯一数字，您可以将其用作索引

编辑：

正如@ajax333221 提到的，前面的代码不会从数组中获取唯一元素，以防它包含重复项。所以这是修复：

```
var result_arr = [];
while(result_arr.length < 51){
    var ind = Math.floor(Math.random()*1000);
    if(text[ind] && !(text[ind] in result_arr))
        result_arr.push(text[ind]);
} 
```

作为“文本”填充了 1000 个值的数组

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-21T15:27:47.603

如果您的意思是唯一值：

**[演示](http://jsfiddle.net/vZTXE/3/)**

```
var old_arr = [0,1,2,3,4,5,6,7,8,9], new_array = [];

for (var i = 0; i < 5; i++) {
    var rand_elem = old_arr[Math.floor(Math.random() * old_arr.length)];

    if (arrIndex(old_arr[rand_elem], new_array) == -1) {
        new_array.push(rand_elem);
    } else {
        i--;
    }
}

function arrIndex(to_find, arr) {//own function for IE support
    if (Array.prototype.indexOf) {
        return arr.indexOf(to_find);
    }
    for (var i = 0, len = arr.length; i < len; i++) {
        if (i in arr && arr[i] === to_find) {
            return i;
        }
    }
    return -1;
} 
```

如果您的意思是唯一索引：

*   生成随机索引并将索引存储在数组中并进行检查以防止重复
*   获取数组的元素后开始删除它们，（如果缓存长度可能会遇到问题，所以不要）

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-05-21T15:22:26.793

Math.random() * 1000;

生成 50 个随机数并将它们用作数组中的位置。

# ssh - 如何强制 ssh 打开从特定端口到主机的连接？

> ID：10688035
> 
> 赞同：2
> 
> 时间：2012-05-21T15:20:29.303
> 
> 标签：ssh, openssh

我想创建一个从我的电脑到另一台电脑的 SSH 连接，但我想从我自己决定的特定端口号开始连接。

可能吗？如何？

谢谢你

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-21T15:32:01.563

您必须将 SSH 服务器配置为使用 22 以外的其他端口。

例如，它可以`/etc/ssh/sshd_config`在大多数 Linux 发行版中完成。

# java - 如何从控制台中删除所有字符？

> ID：10688036
> 
> 赞同：0
> 
> 时间：2012-05-21T15:20:40.000
> 
> 标签：java, windows, console, escaping, character

我希望我的程序能够擦除它打印的所有文本。每次它打印一些东西时，我都会调用我的`print()`方法而不是`System.out.print()`，但是当我调用该`erase()`方法时，它似乎在 Windows 7 控制台中没有做任何事情。我不知道发生了什么；我单独进行了一项测试，确认`\b`确实会擦除字符，但无论出于何种原因，它都无法在`erase()`. 退格字符是相互擦除还是什么？

编辑：我已经进行了更多测试。看起来 \b 不会覆盖换行符。所以我想我需要一种方法来做到这一点。

```
public static int textLength = 0;

public static void erase() {
    for (int i = 0; i < textLength; i++) {
        System.out.print('\b');
    }
    textLength = 0;
}

public static void print(String s) {
    textLength += s.length();
    System.out.print(s);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T15:25:28.640

```
Runtime.getRuntime().exec("cls"); 
```

**编辑**：似乎这不是您正在寻找的解决方案。使用时

```
System.out.print('\b'); 
```

您需要注意这**不会删除**已打印的内容。相反，每个退格键都会**将光标向后移动**一个字符。然后要真正擦除那里的内容，您需要用其他文本覆盖它。

# java - Spring 的转换服务不调用转换器到字符串（用于显示目的）

> ID：10688037
> 
> 赞同：1
> 
> 时间：2012-05-21T15:20:50.400
> 
> 标签：java, spring, spring-webflow-2

我正在使用 Spring 网络流。

我有一个`FormattingConversionService`配置。在此转换服务中，我配置了以下内容：

*   A`ConverterFactory`将字符串值转换为`MyInterface`实例（绑定到对象）
*   A`Converter`将对象转换`MyInterface`为字符串（用于显示）

'ConverterFactory' 被调用并且运行良好。

我的问题是`Converter`没有调用。显示`toString()`在页面上。

如何让 Spring 将对象实例转换`MyInterface`为`String`用于显示目的？

这是我的`conversionService`声明：

```
<bean id="conversionService" class="org.springframework.format.support.FormattingConversionServiceFactoryBean">
    <property name="converters">
        <set>
            <bean class="myclasses.StringToMyInterfaceConverterFactory"/>
            <bean class="myclasses.MyInterfaceToStringConverter"/>
        </set>
    </property>
</bean> 
```

MyInterfaceToStringConverter：

```
@Component
public class MyInterfaceToStringConverter<T extends MyInterface> implements Converter<T, String> {

    public String convert(T source) {
        if (source == null) {
            return null;
        }
        return source.getCode(); // This is a method in MyInterface which returns a String
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-19T08:30:46.977

工作转换服务配置的示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <!-- Enables the Spring MVC @Controller programming model -->
    <mvc:annotation-driven conversion-service="conversionService" />

    <bean id="conversionService" class="org.springframework.context.support.ConversionServiceFactoryBean">
        <property name="converters">
            <set>
                <bean class="myclasses.StringToMyInterfaceConverterFactory" />
                <bean class="myclasses.MyInterfaceToStringConverter" />
            </set>
        </property>
    </bean>
</beans> 
```

# android - 如何在 Android 系统中添加对新硬件加速器的支持？

> ID：10688039
> 
> 赞同：1
> 
> 时间：2012-05-21T15:20:53.050
> 
> 标签：android, opengl-es

我的公司开发了一个 3D HW 加速器，我们已经准备好 EGL + OpenGLES1.1 库并在 Linux 下工作。我需要将这些库移植到 Android。我在同一个硬件平台上也有一个工作的 Android，但它当然是使用它自己的基于 sw 的 OpenGLES 渲染器（放置在 frameworks/base/opengles/libagl 并链接为 system/libs/egl/libGLES_android.so） . 首先，我的想法是通过编译我自己的库来替换原来的 libagl 源，但这并不是那么简单……我不知道如何进行，所以这里有一些问题：

1.  我在哪里可以找到有关此级别 Android 开发的一些文档/规范？
2.  最初的基于 SW 的渲染器与系统提供的专用表面紧密配合，任何可能发生的绘图都在该表面中完成。我不能那样工作——我的硬件加速器总是绘制到预定义的内存区域（具有固定的物理地址和格式），所以我需要找到一种方法（2a）将绘制结果复制到系统提供的表面，或者（ 2b) 告诉系统创建一个指向我的硬件操作区域和格式的表面。2b 会更好，因为复制较少。做什么和怎么做？
3.  我的硬件加速器仅适用于物理地址。我应该在哪里以及如何映射输出缓冲区的已知物理地址？
4.  使用 NDK 进行这种开发/移植是否可能/优选/有用？

谢谢，

安杰尔科

# spring - Spring Data JPA 无法调用 JtaTransactionManager

> ID：10688040
> 
> 赞同：4
> 
> 时间：2012-05-21T15:20:55.257
> 
> 标签：spring, transactions, openjpa, spring-data-jpa, atomikos

我正在使用 Spring Data JPA (SDJ)，在我的集成测试期间，我遇到了一个奇怪的情况——我可能错误配置了一些东西，但我看不到那可能是什么。

`PlatformTransactionManager`简而言之 -一旦在存储库接口上声明了*任何*类型的方法（即扩展的方法） ，SDJ 似乎根本无法调用 Spring 的实现`JpaRepository<T, ID>`。我已经将这种行为深入到一个非常平庸的原因 - 在这种情况下，`JtaTransactionManager`'s setter 根本不会调用，但我无法弄清楚原因。

如果接口缺少任何方法声明 - 一切都按原样工作：`JtaTransactionManager`setter 正常调用并启动事务，但我 **真的**不喜欢编写不需要的自定义存储库只是为了解决可能的错误配置/错误（我已经确认实现自定义存储库确实可以规避提到的行为）。

我会很感激你给我的任何信息，因为我在这里没有想法了。

这是我的相关堆栈：

*   JDK 1.5
*   Spring 3.1.1.RELEASE
*   Spring Data JPA 1.1 GA（已在 1.0.3 版确认问题）
*   Atomikos 3.7.0
*   OpenJPA 2.0.1
*   DB2 9.7

这个基本接口将正常执行：

```
package org.test
public interface TestDAO extends JpaRepository<Test, Integer> {} 
```

以下存储库接口将导致以下异常：

```
package org.test
public interface TestDAO extends JpaRepository<Test, Integer> {
//public static final String TEST = "SELECT t FROM Test t WHERE t.code=:code"; 

//@Query(TEST)
List<Test> findByCode(String code);} 
```

引发的异常（在 Spring 应用程序上下文引导期间抛出异常，在“配置时间”）：

```
08:23:40.296 | DEBUG | [o.s.d.r.c.AbstractRepositoryConfigDefinitionParser:110] | Triggering auto repository detection
08:23:40.997 | DEBUG | [o.s.d.r.c.AbstractRepositoryConfigDefinitionParser:233] | Registering repository: testDAO - Interface: org.test.TestDAO - Factory: org.springframework.data.jpa.repository.support.JpaRepositoryFactoryBean, - Custom implementation: null
.....
08:23:41.309 | DEBUG | [o.s.aop.framework.JdkDynamicAopProxy:113]         | Creating JDK dynamic proxy: target source is SingletonTargetSource for target object [org.springframework.data.jpa.repository.support.SimpleJpaRepository@6d886d88]
08:23:41.338 | DEBUG | [o.s.d.j.r.query.SimpleJpaQuery:122]               | Looking up query for method findByCode
08:23:41.342 | DEBUG | [o.s.d.j.repository.query.NamedQuery:108]          | Looking up named query Test.findByCode
08:23:43.451 | TRACE | [openjpa.jdbc.SQL:83]                              | <t 16515324, conn 2070969200> executing prepstmnt 694298978 SELECT SEQSCHEMA AS SEQUENCE_SCHEMA, SEQNAME AS SEQUENCE_NAME FROM SYSCAT.SEQUENCES
08:23:43.551 | TRACE | [openjpa.jdbc.SQL:83]                              | <t 16515324, conn 2070969200> [99 ms] spent
08:24:07.248 | INFO  | [o.s.b.f.s.DefaultListableBeanFactory:433]         | Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@6d966d96: defining beans [....]; root of factory hierarchy
08:24:07.253 | INFO  | [o.s.o.j.LocalContainerEntityManagerFactoryBean:441] | Closing JPA EntityManagerFactory for persistence unit 'xxx'
08:24:07.307 | ERROR | [o.s.test.context.TestContextManager:324]          | Caught exception while allowing TestExecutionListener [....] to prepare test instance [org.test.SomeIntegrationTest@64026402]
java.lang.NullPointerException: null
    at org.apache.openjpa.kernel.AbstractBrokerFactory.syncWithManagedTransaction(AbstractBrokerFactory.java:720) ~[openjpa-kernel-2.0.1.jar:2.0.1]
Wrapped by: org.apache.openjpa.persistence.PersistenceException: null
    at org.apache.openjpa.kernel.AbstractBrokerFactory.syncWithManagedTransaction(AbstractBrokerFactory.java:752) ~[openjpa-kernel-2.0.1.jar:2.0.1]
    at org.apache.openjpa.kernel.BrokerImpl.initialize(BrokerImpl.java:371) ~[openjpa-kernel-2.0.1.jar:2.0.1]
    at org.apache.openjpa.kernel.BrokerImpl.initialize(BrokerImpl.java:315) ~[openjpa-kernel-2.0.1.jar:2.0.1]
    at org.apache.openjpa.kernel.AbstractBrokerFactory.initializeBroker(AbstractBrokerFactory.java:231) ~[openjpa-kernel-2.0.1.jar:2.0.1]
    at org.apache.openjpa.kernel.AbstractBrokerFactory.newBroker(AbstractBrokerFactory.java:215) ~[openjpa-kernel-2.0.1.jar:2.0.1]
    at org.apache.openjpa.kernel.DelegatingBrokerFactory.newBroker(DelegatingBrokerFactory.java:156) ~[openjpa-kernel-2.0.1.jar:2.0.1]
    at org.apache.openjpa.persistence.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:227) ~[openjpa-persistence-2.0.1.jar:2.0.1]
    at org.apache.openjpa.persistence.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:154) ~[openjpa-persistence-2.0.1.jar:2.0.1]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.5.0]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79) ~[na:1.5.0]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.5.0]
    at java.lang.reflect.Method.invoke(Method.java:618) ~[na:1.5.0]
    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:376) ~[spring-orm-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:517) ~[spring-orm-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at $Proxy24.createEntityManager(Unknown Source) ~[na:na]
    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:234) ~[spring-orm-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at $Proxy31.createNamedQuery(Unknown Source) ~[na:na]
    at org.springframework.data.jpa.repository.query.NamedQuery.hasNamedQuery(NamedQuery.java:90) ~[spring-data-jpa-1.1.0.RELEASE.jar:na]
    at org.springframework.data.jpa.repository.query.NamedQuery.<init>(NamedQuery.java:69) ~[spring-data-jpa-1.1.0.RELEASE.jar:na]
    at org.springframework.data.jpa.repository.query.NamedQuery.lookupFrom(NamedQuery.java:111) ~[spring-data-jpa-1.1.0.RELEASE.jar:na]
    at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$DeclaredQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:125) ~[spring-data-jpa-1.1.0.RELEASE.jar:na]
    at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$CreateIfNotFoundQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:160) ~[spring-data-jpa-1.1.0.RELEASE.jar:na]
    at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$AbstractQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:68) ~[spring-data-jpa-1.1.0.RELEASE.jar:na]
    at org.springframework.data.repository.core.support.RepositoryFactorySupport$QueryExecutorMethodInterceptor.<init>(RepositoryFactorySupport.java:280) ~[spring-data-commons-core-1.3.0.RELEASE.jar:na]
    at org.springframework.data.repository.core.support.RepositoryFactorySupport.getRepository(RepositoryFactorySupport.java:148) ~[spring-data-commons-core-1.3.0.RELEASE.jar:na]
    at org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.getObject(RepositoryFactoryBeanSupport.java:125) ~[spring-data-commons-core-1.3.0.RELEASE.jar:na]
    at org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.getObject(RepositoryFactoryBeanSupport.java:41) ~[spring-data-commons-core-1.3.0.RELEASE.jar:na]
    at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.doGetObjectFromFactoryBean(FactoryBeanRegistrySupport.java:142) ~[spring-beans-3.1.1.RELEASE.jar:3.1.1.RELEASE] 
```

When you delve into the code that bombs (OpenJPA `AbstractBrokerFactory` class), it follows that OpenJPA expects the given transaction manager (as defined in OpenJPA properties map below), but Spring doesn't provide it, since setter on `JtaTransactionManager` class is not invoked at all (I've verified this behaviour while debugging).

Contrary to that, if interface without any methods is invoked, the setter is called normally and provides transaction manager to OpenJPA.

Here's my configuration - one thing that you may notice and could potentially be relevant: I am not using `persistence.xml` file at all.

**Datasource**

```
<bean id="dataSource" class="com.atomikos.jdbc.AtomikosDataSourceBean" init-method="init" destroy-method="close">
    <property name="uniqueResourceName" value="${dataSource.uniqueName}" />     
    <property name="xaDataSourceClassName" value="${dataSource.className}" />
    <property name="poolSize" value="100" />
    <property name="maxPoolSize" value="250" />
    <property name="borrowConnectionTimeout" value="5000" />
    <property name="xaProperties">
        <props>
        //snipped for brevity....
        </props>
    </property>
</bean> 
```

**Transaction manager**

```
<!-- Construct Atomikos UserTransactionManager, needed to configure Spring -->
<bean id="atomikosTransactionManager" class="com.atomikos.icatch.jta.UserTransactionManager" init-method="init" destroy-method="close">
    <property name="forceShutdown" value="true" />
</bean>

<bean id="atomikosUserTransaction" class="com.atomikos.icatch.jta.UserTransactionImp">
    <property name="transactionTimeout" value="3600"/>
</bean>

<!-- Configure the Spring framework to use JTA transactions from Atomikos -->
<bean id="transactionManager" class="org.springframework.transaction.jta.JtaTransactionManager">
    <property name="transactionManager" ref="atomikosTransactionManager" />
    <property name="userTransaction" ref="atomikosUserTransaction" />
    <property name="allowCustomIsolationLevels" value="true" />
</bean> 
```

**Entity manager**

```
<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="persistenceUnitName" value="${entityManagerFactory.persistenceUnitName}"/>
    <property name="packagesToScan" value="org.test.model" />
    <property name="jpaDialect" ref="jpaDialect"/>
    <property name="jpaVendorAdapter" ref="jpaVendorAdapter"/>
    <property name="jpaProperties" ref="openjpaProperties" />
</bean>
<bean id="jpaDialect" class="org.springframework.orm.jpa.vendor.OpenJpaDialect"></bean> 
<bean id="jpaVendorAdapter" class="org.springframework.orm.jpa.vendor.OpenJpaVendorAdapter"></bean> 
```

**OpenJPA properties**

```
<util:map id="openjpaProperties">
        <!-- Specifies whether JPA is using Managed (global) transactions or Local transactions -->
        <entry key="openjpa.TransactionMode" value="managed" />
        <entry key="openjpa.ConnectionFactoryMode" value="managed" />
        <entry key="openjpa.ConnectionFactory2" value-ref="dataSourceNonXA" />
        <!-- Specifies transaction manager to be used -->
        <entry key="openjpa.ManagedRuntime" value="invocation(TransactionManagerMethod=com.atomikos.icatch.jta.TransactionManagerImp.getTransactionManager)" />
</util:map> 
```

**JPA repository scanner**

```
<jpa:repositories base-package="hr.apisit.b28.intrastat.business.storage.codelists.internal.dao" entity-manager-factory-ref="entityManagerFactory"
                transaction-manager-ref="transactionManager" /> 
```

Thanks in advance

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T07:47:41.170

You need to init the atomikos transaction manager at startup. So, the only thing needed here is to add this:

`<bean id="atomikosTransactionManager" class="com.atomikos.icatch.jta.UserTransactionManager" init-method="init" destroy-method="close" lazy-init="false"> <property name="forceShutdown" value="true" /> </bean>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T17:58:06.310

you can try this:

```
<jpa:repositories base-         package="hr.apisit.b28.intrastat.business.storage.codelists.internal.dao" entity-manager-factory-ref="entityManagerFactory"
            transaction-manager-ref="transactionManager" depends-on="transactionManager"/> 
```

# iphone - iphone中的ssl套接字，有可能吗？

> ID：10688042
> 
> 赞同：4
> 
> 时间：2012-05-21T15:21:06.343
> 
> 标签：iphone, objective-c, sockets, ssl

在我的 iPhone 应用程序中，我想连接我的 SSL 服务器套接字（Java 中）。我有自己的证书。我正在尝试将其添加到我的应用程序中，但我不知道该怎么做。

没有 SSL，通信工作：

```
@interface ViewController ()

@end

@implementation ViewController
@synthesize openResponse;
@synthesize general; 
@synthesize response = _response;

- (void)viewDidLoad
{
 [super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{ 
[self setOpenResponse:nil];
[self setGeneral:nil];
[super viewDidUnload];
// Release any retained subviews of the main view.
}

 - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (IBAction)open:(id)sender {
    [self initNetworkCommunication];

Byte sendBuffer[4];
sendBuffer[0]=0x6b;
sendBuffer[1]=0x6f;
sendBuffer[2]=0x6c;
sendBuffer[3]=0x61;

[outputStream write:sendBuffer maxLength:4];
 }

- (void)initNetworkCommunication{

CFReadStreamRef readStream;
CFWriteStreamRef writeStream;
CFStreamCreatePairWithSocketToHost(NULL, (CFStringRef)@"mypage.com", 4444, &readStream, &writeStream);
inputStream = (__bridge NSInputStream *)readStream;
outputStream = (__bridge NSOutputStream *) writeStream;
[inputStream setDelegate:self];
[outputStream setDelegate:self];
[inputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
[outputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
[inputStream open];
[outputStream open];

}

- (void)stream:(NSStream *)theStream handleEvent:(NSStreamEvent)streamEvent
{
 switch (streamEvent) {

    case NSStreamEventOpenCompleted: {
        NSLog(@"Stream opened");

        break;
    }

    case NSStreamEventHasBytesAvailable: {
        NSLog(@"Data!");

        if (theStream == inputStream) {

            uint8_t buffer[1024];
            int len;

            while ([inputStream hasBytesAvailable]) {
                len = [inputStream read:buffer maxLength:sizeof(buffer)];
                if (len > 0) {

                    NSString *output = [[NSString alloc] initWithBytes:buffer length:len encoding:NSASCIIStringEncoding];

                    if (nil != output) {
                        NSLog(@"server said: %@", output);
                        self.response = output;
                        NSString *responseData =[[NSString alloc] initWithFormat:@"El servidor dice: %@",self.response];
                        self.openResponse.text = responseData;
                    }
                }
            }
        }
        break;

        break;
    }

    case NSStreamEventErrorOccurred: {
        NSLog(@"Can not connect to the host!");

        break;
    }
    case NSStreamEventEndEncountered: {
        NSLog(@"End encountered");

        break;
    }
    default:
        NSLog(@"Unknown event");
        break;
}
}

@end 
```

如何将我的证书添加到此代码中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T16:20:40.990

我也在解决与这个问题相同的问题。可能，这个 URL 和我的代码对你有帮助。但我的代码不确定。

1.  URL：[使用的套接字上的 NSStream SSL](https://stackoverflow.com/questions/2237735/nsstream-ssl-on-used-socket)

2.  代码

```
NSData *pkcs12data = [[NSData alloc] initWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"EGNF9784" ofType:@"pfx"]];
CFDataRef inPKCS12Data = (CFDataRef)pkcs12data;

CFStringRef password = CFSTR("enblinkPass");
const void *keys[] = { kSecImportExportPassphrase };
const void *values[] = { password };        
CFDictionaryRef options = CFDictionaryCreate(NULL, keys, values, 1, NULL, NULL);

CFArrayRef items = CFArrayCreate(NULL, 0, 0, NULL);

OSStatus securityError = SecPKCS12Import(inPKCS12Data, options, &items);        
CFRelease(options);     
CFRelease(password);        
[pkcs12data release];

if(securityError == errSecSuccess) 
    NSLog(@"Success opening p12 certificate.");

CFDictionaryRef identityDict = CFArrayGetValueAtIndex(items, 0);
SecIdentityRef myIdent = (SecIdentityRef)CFDictionaryGetValue(identityDict,
                                                              kSecImportItemIdentity);

SecIdentityRef  certArray[1] = { myIdent };
CFArrayRef myCerts = CFArrayCreate(NULL, (void *)certArray, 1, NULL);

NSMutableDictionary *settings = [NSMutableDictionary dictionaryWithCapacity:3];

[settings setObject:[NSNumber numberWithBool:YES] forKey:(NSString *)kCFStreamSSLAllowsExpiredRoots];

[settings setObject:[NSNumber numberWithBool:YES] forKey:(NSString *)kCFStreamSSLAllowsExpiredCertificates];

[settings setObject:[NSNumber numberWithBool:YES] forKey:(NSString *)kCFStreamSSLAllowsAnyRoot];

[settings setObject:[NSNumber numberWithBool:NO] forKey:(NSString *)kCFStreamSSLValidatesCertificateChain];

[settings setObject:[NSString stringWithFormat:@"%@:%hu",host,port] forKey:(NSString *)kCFStreamSSLPeerName];

[settings setObject:(NSString *)kCFStreamSocketSecurityLevelNegotiatedSSL forKey:(NSString*)kCFStreamSSLLevel];

[settings setObject:(NSString *)kCFStreamSocketSecurityLevelNegotiatedSSL forKey:(NSString*)kCFStreamPropertySocketSecurityLevel];

[settings setObject:(id)myCerts forKey:(NSString *)kCFStreamSSLCertificates];

[settings setObject:[NSNumber numberWithBool:YES] forKey:(NSString *)kCFStreamSSLIsServer]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:38:25.850

是的，如果您正在谈论 HTTP（如您的主机名“my page.com”所示），查看这篇文章可能很有意义：[如何使用 NSURLConnection 与 SSL 连接以获得不受信任的证书？](https://stackoverflow.com/questions/933331/how-to-use-nsurlconnection-to-connect-with-ssl-for-an-untrusted-cert) 使用 NSURLClass 将大大简化您的整体设计。

# c# - 在c#中用0-9之间的唯一随机数填充数组

> ID：10688044
> 
> 赞同：-1
> 
> 时间：2012-05-21T15:21:12.387
> 
> 标签：c#

我想在 c# 中用 0-9 之间的唯一随机数填充我的数组我尝试这个函数：

```
 IEnumerable<int> UniqueRandom(int minInclusive, int maxInclusive)
    {
        List<int> candidates = new List<int>();
        for (int i = minInclusive; i <= maxInclusive; i++)
        {
            candidates.Add(i);
        }
        Random rnd = new Random();
        while (candidates.Count > 1)
        {
            int index = rnd.Next(candidates.Count);
            yield return candidates[index];
            candidates.RemoveAt(index);
        }
    } 
```

我像这样使用它：

```
for (int i = 0; i < 3; i++)
{
    page[i] = UniqueRandom(0, 9);
} 
```

但我得到了错误：

```
Cannot implicitly convert type 'System.Collections.Generic.IEnumerable<int>' to 'int' 
```

我还添加了这个命名空间：

```
using System.Collections.Generic; 
```

我只是不知道如何将函数输出转换为int ...请帮助我...谢谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T15:23:17.637

你最好做这样的事情，使用[Fischer-Yates shuffle](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)：

```
public static void Shuffle<T>(this Random rng, IList<T> list)  
{  
    int n = list.Count;  
    while (n > 1) {  
        n--;  
        int k = rng.Next(n + 1);  
        T value = list[k];  
        list[k] = list[n];  
        list[n] = value;  
    }  
} 
```

*用法：*

```
var numbers = Enumerable.Range(0, 10).ToList(); // 0-9 inclusive
var rng = new Random();
rng.Shuffle(numbers);
int[] page = numbers.Take(3).ToArray(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T15:25:03.843

您的方法返回一个可枚举，但您尝试分配一个值。一步分配所有值：

```
int[] page = UniqueRandom(0, 9).Take(3).ToArray();  // instead of your loop 
```

* * *

**编辑**：根据您的评论，我判断您可能在不理解的情况下复制了您向我们展示的代码。也许你想*用可能重复的*随机数填充你的数组（例如`1, 6, 3, 1, 8, ...`）？您当前的代码仅使用每个值一次（因此名称为*unique*），因此您不能用它填充大小大于 10 的数组。

如果您只想要简单的随机数，则根本不需要这种方法。

```
var rnd = new Random();

// creates an array of 100 random numbers from 0 to 9
int[] numbers = (from i in Enumerable.Range(0, 100) 
                 select rnd.Next(0, 9)).ToArray(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T15:22:48.277

你可以这样做：

```
int i = 0;
foreach (int random in UniqueRandom(0, 9).Take(3))
{
    page[i++] = random;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T06:18:25.907

我的数组太大了，我需要很多随机数......当我使用

```
 int[] page = UniqueRandom(0, 9).Take(arraysize).ToArray(); 
```

它给了我正好 9 个唯一的随机数..

我得到了这个错误（例如对于arraysize = 15）：

```
index was outside of bounds of array 
```

我怎样才能有一个在 0-9 之间有太多随机数的数组而不重复？

# windows-phone-7.1 - WP7.1 指南针：是否必须调用停止？

> ID：10688048
> 
> 赞同：0
> 
> 时间：2012-05-21T15:21:49.257
> 
> 标签：windows-phone-7.1

如果我有一个以这种方式使用指南针的应用程序：

```
if (Compass.IsSupported)
            {
                Compass c = new Compass();
                c.CurrentValueChanged += (s, e) =>
                    {

                        Heading = e.SensorReading.TrueHeading;
                        PropertyChanged(this, new PropertyChangedEventArgs("Heading"));
                    };
                c.Start();
            } 
```

是否必须在某个地方调用 Stop()，或者当应用程序关闭时传感器读数是否会自动停止？我只是不想制造一个电池沉降片。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T19:12:45.073

你不必打电话停止，但你可能应该。当您的应用程序切换/墓碑/关闭时，它将停止。

您不希望创建“创建电池沉降片”与您的问题的需要相矛盾。一个很好的经验法则是，如果你不需要它，你应该停止它。
如果您没有在应用程序的每个页面上都使用它，那么它可能只适合在需要/使用时运行它。

# svn - 使用共享项目创建发布分支周期

> ID：10688049
> 
> 赞同：1
> 
> 时间：2012-05-21T15:21:52.440
> 
> 标签：svn, branch, projects

我们是一个中小型团队，之前使用了一个相当简单的分支系统，该系统利用了 SVN 的红皮书推荐的做法——当前开发的主干不稳定，工作时间长于一天等的分支。

我最近实施了一项更改，不幸的是我意识到这是错误的，但我很难正确地做到这一点。

该项目现在将用于多个团队的源代码 - 现在我知道有一种观点认为应该公开二进制文件而不是源代码，但这不是一个选项 - 这将通过 externs 包含在内，因为每个团队将需要对源进行积极的更改。

为此，我提出以下建议：

*   主干不会用于积极开发
*   每个团队都有自己的“主要开发”分支——这实际上是以前的主干。
*   对于较小的项目工作项，每个团队都会从他们的“主要开发”分支中取出一个分支。

因此，当一个开发周期完成时，每个团队都会将他们的“主开发”分支重新集成到主干中，从而其他团队可以在他们需要时合并（给予他们稳定性），然后为他们创建一个新的“主开发”分支。下一个周期。

EG，下面是分支的布局（不是物理布局） - 所以每个团队为他们的团队开发分支从主干中取出一个分支，并为每个成员工作分支从主干中取出一个分支：

```
--Trunk
    \  TeamAMainDev1
           \ PRJ1-teama
    \  TeamBMainDev1
           \ PRJ1-teamb 
```

问题是，一些分支需要比它们的父 MainDev 分支停留更长时间。一旦他们的父级被集成到 Trunk 中，并创建了一个新的 MainDev，合并显然不起作用。因此，如果有一个新的 TeamAMainDev2 分支，尝试将其合并到 PRJ1-teama 会导致树冲突等 - 这显然是有道理的；我原以为 SVN 会知道 MainDev1 上的更改在 PRJ1 中，但由于它需要合并 MainDev1 的整个重新集成，所以这不起作用。

其他人如何处理这个问题？要使多个分支脱离分支，需要不断地从其父级合并以保持最新，但可能会重新集成到另一个父级。或者其他人会推荐什么流程？

帮我OB1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T10:37:07.403

如果其他人需要做类似的事情，这就是我发现的：

在 Tortoise 中，有一个“合并两个不同的分支”的选项 - 所以只需选择前一个分支和之前的一个，这将检测到不是来自两者的任何更改，并添加差异。

这适用于上述情况。

# iphone - 在 OpenGLES 的两个类中创建 GLKView？

> ID：10688050
> 
> 赞同：-1
> 
> 时间：2012-05-21T15:22:04.173
> 
> 标签：iphone, ios, opengl-es

目前我在游戏应用程序中工作，我已经有一个视图控制器（并制作 GLKView），现在另一个视图控制器然后如何自定义 GLKView，请帮助我

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:59:37.773

是的，可以创建两个 GLKView，就像可以创建任何两个视图一样。

```
GLKView *view1 = [[GLKView alloc] initWithFrame:...];
GLKView *view2 = [[GLKView alloc] initWithFrame:...]; 
```

我怀疑您也在询问是否`GLKViewController`可以`GLKViews`控制两个。如果您想使用的`GLKView`帧管理功能，我很确定您只能拥有一个。但是您可以使用.`GLKViewController``GLKViewController``CADisplayLink`

看看这个教程，真的很有帮助： [http ://www.raywenderlich.com/5223/beginning-opengl-es-2-0-with-glkit-part-1](http://www.raywenderlich.com/5223/beginning-opengl-es-2-0-with-glkit-part-1)

# calendar - 最标准的日历交换数据格式

> ID：10688053
> 
> 赞同：7
> 
> 时间：2012-05-21T15:22:34.553
> 
> 标签：calendar, scheduling, google-calendar-api, icalendar

我有一个带有调度程序应用程序的系统（php/MySQL）。

我即将创建一项服务，允许用户从 Outlook、谷歌、sunbird、...

我想知道当今交换日历数据的最标准格式是什么。

是 ical 吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T15:32:06.280

是的，iCalendar - 最近记录在[RFC 5545](https://www.rfc-editor.org/rfc/rfc5545)中- 可能是您最好的选择。然而，它不会很有趣......并且期望在不同的实现中找到各种怪癖。如果您可以坚持标准的一些简单子集，那可能会对您有很大帮助。

# php - Magento 存储返回 URL

> ID：10688054
> 
> 赞同：0
> 
> 时间：2012-05-21T15:22:34.973
> 
> 标签：php, magento

嗨，这里有一个给万磁王的问题。我正在尝试获取前一页 URL 以用于后退按钮（JavaScript 的历史记录不适用于我的使用）。这是我得到的：

```
<li><a class="btn-go-back" href="<?php
                            $currentUrl = $this->helper('core/url')->getCurrentUrl();
                             echo  Mage::registry('backUrl');
                            ?>" >Go Back</a></li>
                    <?php if(Mage::registry('backUrl')!= $currentUrl)
                        Mage::unregister ('backUrl');
                        Mage::register('backUrl' , $currentUrl, true ); ?> 
```

代码不干净，但它甚至不起作用。

出于某种原因，我得到了当前 URL 的链接。

这是视图 phtml 中的位置。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T09:15:16.447

Magento 确实`last_url`在会话中存储了一个属性：

```
$_SESSION['core']['last_url'] 
```

唯一的问题是您无法分辨该页面是什么（不检查 URL），但如果您将`Go back`其用作锚文本，则无关紧要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:54:06.940

Magento 不会正常发送此信息，因此您可能需要添加观察者或在 index.php 文件中添加功能以保存会话中的最后访问 url。此技巧将保存 /any/ 选项卡中的最后一页，不一定用于引用页面。

# php - 数组替换最后一个值，不添加 [PHP]

> ID：10688055
> 
> 赞同：2
> 
> 时间：2012-05-21T15:22:35.343
> 
> 标签：php, arrays, array-push

我有一个 PHP 数组，使用

```
$this->cart = array(); 
```

除了数组不会，无论我做什么，它都不会采用新值，而只会用新值替换现有值。

我已经尝试过array_merge、array_push 和其他方法，并且发生了同样的事情，但这是*应该*工作的代码。

```
$this->cart[]=$input; 
```

第一次使用时，它说数组“Array ([0] => 1”中有一个项目第二次使用它会显示这个，替换第一个值“Array ([0] => 2)”

添加值由表单触发，拉取 ID 并将其作为值放入数组

```
echo '<input type="hidden" name="addeditem" value="2">'; 
```

但是无论什么代码，它都不会追加数组，只会替换它，任何想法。我尝试添加键和值，以及创建第二个数组并将其合并，但没有任何效果。

添加到购物车的功能是这个

```
function addToCart($input){
$this->cart[]=$input;
$this->setCartCount();
} 
```

已解决：见评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:34:35.843

您确定 $this->cart 是一个全局变量，并且每次调用 addToCart() 时都不会创建数组吗？

试试看。像这样：

1.  有一个购物车对象

    ```
    public class cart{

       private $items;
       function __construct() {
         $items=array();
       }
       public function addToCart($item){
         $this->items[]=$item;
       }
    } 
    ```

2.  将项目添加到代码中其他位置的购物车。

    ```
    $cart=$manager->getCart();
    $cart->addToCart($your_new_item); 
    ```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-21T15:23:39.543

名称应如下：`addeditem[]`

# ruby-on-rails - Rails 计数器缓存不适用于生产

> ID：10688057
> 
> 赞同：0
> 
> 时间：2012-05-21T15:22:46.520
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, counter-cache

Rails 3.1.4（ruby 1.8.7）的计数器缓存机制有一个奇怪的问题。当我在开发服务器上运行我的应用程序时，一切正常。切换到生产环境之后，comments_count 列每次我只添加一条评论时都会增加 +2。

我查看了日志，增量查询在那里显示了两次：

```
 Started POST "/comments" for 127.0.0.1 at Mon May 21 16:39:49 +0200 2012
  Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"content_id"=>"2803", "content_type"=>"Post", "value"=>"hello there"}, "authenticity_token"=>"/2HRoMq/I+fPzLlKB8CezWEpwjywHo5RwCgm2VRj0zo=", "utf8"=>"✓", "commit"=>"Dodaj"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
     1 row, 646 bajty
     app/controllers/application_controller.rb:27:in `current_user_session'
     app/controllers/application_controller.rb:32:in `current_user'
     app/controllers/application_controller.rb:41:in `require_user'
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (1.0ms)[0m  [1mUPDATE `users` SET `last_request_at` = '2012-05-21 14:39:50', `updated_at` = '2012-05-21 14:39:50', `perishable_token` = 'U6r38z0lX1G7Y48xC9s4' WHERE `users`.`id` = 1[0m
  [1m[35m (46.0ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mBlacklist Load (0.7ms)[0m  SELECT `blacklists`.* FROM `blacklists` WHERE (user_id = 1 AND end_date > '2012-05-21 14:39:50')
     0 rows, 0 bajty
     app/models/comment.rb:97:in `block_check'
     app/controllers/comments_controller.rb:25:in `create'
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `comments` (`comments_count`, `content_id`, `content_type`, `created_at`, `edits`, `points`, `reported`, `updated_at`, `user_id`, `value`) VALUES (0, 2803, 'Post', '2012-05-21 14:39:50', 0, 0, NULL, '2012-05-21 14:39:50', 1, 'hello there')[0m
  [1m[35mPost Load (0.6ms)[0m  SELECT `posts`.* FROM `posts` WHERE `posts`.`id` = 2803 LIMIT 1
     1 row, 658 bajty
     app/controllers/comments_controller.rb:25:in `create'
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `posts` SET `comments_count` = COALESCE(`comments_count`, 0) + 1 WHERE `posts`.`id` = 2803[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `posts` SET `comments_count` = COALESCE(`comments_count`, 0) + 1 WHERE `posts`.`id` = 2803
  [1m[36m (39.2ms)[0m  [1mCOMMIT[0m
  Redirected to http://0.0.0.0:3000/news/zobacz/Tibia-obt-startuje-w-listopadzie-2 
```

我一整天都在努力解决这个问题，但我不知道出了什么问题。在开发模式下一切正常。从 Rails2 升级后出现问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:33:59.727

问题解决了。正如我所说，我已经从 Rails2 迁移，并且在我的模型中遵循了已弃用的声明：

```
belongs_to :content, :polymorphic => true, :counter_cache => true 
```

Rails3 自动处理 counter_cache 字段，上面的语句是多余的。我将模型关系更改为：

```
belongs_to :content, :polymorphic => true 
```

像魅力一样工作。

# spring - tomcat web应用程序加载分步指南

> ID：10688062
> 
> 赞同：0
> 
> 时间：2012-05-21T15:22:57.090
> 
> 标签：spring, tomcat, web-applications

我有一个带有 Spring 安全支持的动态 Web 应用程序。我想知道在 tomcat 服务器上执行哪些步骤来运行我的应用程序。就像我想知道何时加载过滤器，何时调用侦听器，如何以及何时加载所有配置，JVM 加载了哪些对象。我试图搜索一本书或参考博客，以获取网络服务器加载我的应用程序并运行它所遵循的步骤序列。

我想知道所有这些细节只是为了了解 Web 应用程序的内部结构。我正在使用tomcat 7.0。

非常感谢您的帮助。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:01:31.810

阅读 servlet 规范。我知道这听起来像是我在说 RTFM 并向您推荐一些他们头脑正常的人都不会阅读的内容密集的技术手册，但 Java Servlet 规范实际上很短、简洁且可读性强。

不幸的是，您必须从 Oracle 下载它，但很容易获得：http: [//jcp.org/aboutJava/communityprocess/final/jsr315/index.html](http://jcp.org/aboutJava/communityprocess/final/jsr315/index.html)

servlet 规范解释了一切是如何工作的，从过滤器和侦听器被实例化和调用等，到容器管理的身份验证和授权如何操作。我认为任何编写基于 Web 的应用程序的人都需要阅读它。

# git - Git - 交互式 Rebase 和 Squashing 的问题

> ID：10688064
> 
> 赞同：3
> 
> 时间：2012-05-21T15:23:05.717
> 
> 标签：git, rebase, squash

我知道有很多关于这个的问题，但我似乎根本找不到我正在寻找的答案。

我刚刚将我的任务分支合并到我的主分支中，我准备将我的更改推送到远程主分支。但是，它们显示为两个提交：

```
 commit 878c07412aab6a6b06b7fc8dd84c2418cc4f31d8
Merge: 9ffa590 c9f5552
Author: ***
Date:   Mon May 21 16:02:36 2012 +0100

    Merge branch 'modelUpdate4'

    Conflicts:
        ***.xcodeproj/project.pbxproj

commit c9f5552862872673317701c3dffd7fb6b6daa02c
Author: ***
Date:   Mon May 21 15:03:21 2012 +0100

    Modified model according to requests.  Repopulated seeded database. 
```

这是 git log 的输出，我希望将两个提交压缩为一个。但是，当我这样做时：

```
git rebase -i HEAD~2 
```

它实际上只显示 4 个先前提交（和推送）的提交。我是否误解了我的分支是如何合并回来的？如果我尝试 git rebase -i 这只会显示 git 日志列表中的第一个提交。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:25:09.763

既然你说已经推送了四个提交，我猜你的图（`git log --oneline --decorate --graph`）看起来像这样，你有分支提交，`master`并且`modelUpdate4`已经推送到远程仓库：

```
* (master, modelUpdate4, HEAD) Merge branch 'modelUpdate4'
| \
|  * (origin/modelUpdate4) Modified model according to requests. [HEAD^2]
|  |
|  * Another commit on modelUpdate4
|  |
|  * Yet another commit on modelUpdate4!
|  |
*  | (origin/master) Something that conflics with a commit in modelUpdate4 [HEAD~1]
| /
* Previous commit on master [HEAD~2] 
```

`HEAD~2`是第一个父级的第一个父级，并且由于 your`HEAD`是 into 的合并`modelUpdate4`，`master`它指的是两个提交`master`。`HEAD^2`是第二个父母，所以在下线`HEAD's`之前提交。（另见： http: [//paulboxley.com/blog/2011/06/git-caret-and-tilde](http://paulboxley.com/blog/2011/06/git-caret-and-tilde)）`HEAD``modelUpdate4`

如果`HEAD~2`是您的新基地，您将在一条直线`HEAD~2`之间获得所有提交。`master`您还必须在发生的`modelUpdate4`提交中处理分支冲突。

```
* (master, HEAD) Merge branch 'modelUpdate4'
|
* Modified model according to requests.  Repopulated seeded database.
|
* Another commit on modelUpdate4
|
* Yet another commit on modelUpdate4!
|
* Something on master that conflics with modelUpdate4
|
* Previous commit on master 
```

如果其他人正在使用这些远程分支，或者您想维护您的分支历史记录，请不要变基。它会重写远程仓库中已经存在的历史记录，这对其他所有人来说都是一件头疼的事情。将合并提交推出，您将获得成功。

或者，您可以直接变基到`origin/master`. `origin/modelUpdate4`最终会出现在 git boonies 中，但由于它是一个任务分支，我打赌你无论如何都会删除它。

# eclipse - 使用 modisco 绘制图表

> ID：10688071
> 
> 赞同：1
> 
> 时间：2012-05-21T15:23:29.493
> 
> 标签：eclipse, eclipse-emf, eclipse-mdt

如何使用 modisco 插件绘制 uml 图？我有 Eclipse 建模工具并安装了带有 modisco 模型过滤器插件的 modisco 插件。我设法从 java 项目创建了一个 *.uml 文件，但是我无法从这个模型构建 uml 图。

我发现以下[链接](http://wiki.eclipse.org/MDT-UML2Tools_FAQ#Can_I_create_a_diagram_from_UML2_model_.28.2A.uml_file.29.3F)表明构建图很容易。但是，当我右键单击 *.uml 文件将其转换为 uml 图时，没有`Action`菜单。

我在文件上下文菜单中只有以下菜单项：

![在此处输入图像描述](../Images/a55983bff6e19b2e284525b83e0b5b16.png)

怎么做才能生成uml图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T10:09:55.020

有了这个发现，你只会发现 uml 文件的模型，它是一个模型。MoDisco 不是代码生成器，而是代码发现者（Retro Modeling）。可能有大量的插件可以从 uml 模型生成图表。

正如您的链接所说：

> **我可以从 UML2 模型（*.uml 文件）创建图表吗？**
> 
> 是的，这很容易。要从*.uml 文件“可视化”图表，请使用文件上下文菜单中的“初始化类图表”操作。还有初始化组件、活动或状态机图的操作，选择您需要的。*将创建相应的*图表文件（ .umlclass、*.umlcomp 等）然后打开。*此功能由 GMF 提供。

注意：您的链接与 moDisco 无关，但您应使用 UML2Tools 安装它

# c# - ANTLR 在 c# 文件中为给定语法生成 c++ 代码

> ID：10688080
> 
> 赞同：1
> 
> 时间：2012-05-21T15:23:53.883
> 
> 标签：c#, antlr

我试图在我的 C# 应用程序中解析和执行一个相当简单的 Oracle SQL 查询。为此，我决定使用 ANTLR 作为解析器工具，因为 Oracle SQL 语言的语法已经可以从[语法列表页面](http://www.antlr.org/grammar/list)下载。

我还选择了最新版本的 ANTLR 3.4 并使用以下命令生成 C# 源文件以在我的应用程序中使用

```
java -cp antlr-3.4-complete.jar org.antlr.Tool OracleSQL.g 
```

小备注：原来的语法文件有 C 作为输出语言，所以我把它改成了`CSharp2`（我也试过`CSharp3`，但没有运气）。

代码的问题是我得到了像这样的代码块

```
if ((((( !(strcasecmp((const char*)LT(1)->getText(LT(1))->chars, "SUBPARTITION")) )&& 
```

因此解决方案无法编译。

我也尝试过[这里](https://stackoverflow.com/questions/9923639/antlr-grammar-generating-invalid-c-sharp-code)发布的解决方案，但无济于事。

我错过了什么？

谢谢，阿德里安。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:25:15.550

很多时候，ANTLR 语法包含嵌入式（目标）代码。C代码，在你的情况下。您不能简单地将 in 更改`language=C;`为`language=CSharp2`（或其他语言）：它只会导致 ANTLR 生成带有嵌入式 C 代码的 C# 中的词法分析器和/或解析器。您必须自己重写所有嵌入式 C 代码。

例如，以下 C 目标语法：

```
grammar T;

options {
  language=C;
}

parse
 : Any* EOF {printf("done!\n");}
 ;

Any
 : .
 ; 
```

应该像这样重写（对于 C#）：

```
grammar T;

options {
  language=CSharp2; // or CSharp3
}

parse
 : Any* EOF {Console.WriteLine("done!");}
 ;

Any
 : .
 ; 
```

# ios - 如何在视图控制器中使用 NSString 更正这些错误？

> ID：10688084
> 
> 赞同：1
> 
> 时间：2012-05-21T15:24:08.903
> 
> 标签：ios, xcode, nsstring, integer

我正在将 Integer 转换为 NSString，我有一些代码，但有 11 个错误。

这是我正在使用的代码：

```
@interface GameViewController : UIViewController {

    积分；
    NSString *stringscore;
    NSString stringscore = [NSString stringWithFormat:@"d",score];
}

```

我该如何修复这些错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:27:37.093

您在格式字符串中省略了 % ，并且不需要第二个 NSString

```
stringscore = [NSString stringWithFormat:@"%d",score]; 
```

尽管在这种情况下，您可以将变量定义和赋值全部放在一行中：

```
NSString* stringscore = [NSString stringWithFormat:@"%d",score]; 
```

**愚蠢更新**

在我发帖（半睡半醒）的狂热中，我没有看到这一切都是在@Interface 中完成的。

如果应该在接口和实现之间进行拆分.. 以下是如何完成的示例：

```
@interface GameViewController : UIViewController  {

    int score;
    NSString *stringscore;
}
@end

@implementation GameViewController

-(void)SomeMethod
{
   score = 123;
   stringscore = [NSString stringWithFormat:@"%d",score];
}
@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:16:17.163

我不确定您是否可以像这样为@interface 部分中的变量赋值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T16:26:29.993

我相信最简单的解决方案应该是：

```
NSString *stringscore = [NSString stringWithFormat:@"%d",score]; 
```

但是，鉴于该分数是一个 int，您也可以这样做：

```
NSString* stringscore = [NSString stringWithFormat:@"%i",score]; 
```

但是，您应该只在 .m 文件中进行分配，并且只有在给 score 一个值之后。

# sharepoint-2010 - 如何在 SharePoint 的编辑器控制页面上修改 JS 函数 ValidateAndSubmit（或添加我自己的验证脚本）？

> ID：10688085
> 
> 赞同：0
> 
> 时间：2012-05-21T15:24:13.320
> 
> 标签：sharepoint-2010, custom-fields

我添加了带有自定义属性的自定义字段类型。我用我的自定义字段类型添加问题，并在我的 FieldEditor 的 OnSaveChange 方法中检查一些约束。但我想在用户提交“新问题”页面之前添加额外的客户端验证。我看到这个页面在javascript函数ValidateAndSubmit中有一些标准的共享点验证，例如 - 这个函数检查问题长度是否太多。如何在此验证脚本中添加我的逻辑以在客户端验证我的自定义属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:58:41.490

只需添加一个内容编辑器 Web 部件，包括您的 jQuery 引用并运行您的自定义验证，假设您的“新问题”按钮具有给定的 ID，

```
$("#myNewQuestionButton").click(function{ doYourMagicValidationsHere();}); 
```

这里的诀窍是正确执行您的 jquery 引用并将脚本从一个 web 部件转移到另一个。

如果需要一个例子，请告诉我，这个技巧我已经做了好几次了。

此致。

# maven - Apache Maven：无法识别 Windows 7 64 位类路径

> ID：10688086
> 
> 赞同：1
> 
> 时间：2012-05-21T15:24:17.517
> 
> 标签：maven, windows-7, command-line, path

Windows 7 无法将 mvn 识别为命令。

环境变量：

```
M2_HOME:  D:\apache-maven-3.0.4
M2:  %M2_HOME%\bin
PATH: . . . :M2_HOME;M2; . . . 
```

在命令提示符下，输入“echo %M2_HOME%”和“echo %M2%”给出：

```
D:\apache-maven-3.0.4  and  D:\apache-maven-3.0.4\bin 
```

输入 "%M2%\mvn --version" 给出：

```
Apache Maven 3.0.4 (r1232337; 2012-01-17 03:44:56-0500)
Maven Home: D:\apache-maven-3.0.4
Java Version: 1.7.0_03, vendor: Oracle Corporation
Java Home: D:\Glassfish3\jdk7\jre
and so on. 
```

只需输入 mvn --version" 产生：

```
mvn is not recognized as an internal or external command,
operable program or file. 
```

我已重新启动 Windows 7 无济于事。我不知道这里发生了什么。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T15:32:54.533

您必须将 %M2% 添加到 Path 变量中

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T15:42:09.747

You need to set you PATH to refer to `%M2%` instead of just `M2`, otherwise the OS is looking for `mvn` in the folder `M2`, not the path denoted by the value of the `M2` env. variable

# c++ - 为什么程序在没有 try/catch 的情况下会失败？

> ID：10688095
> 
> 赞同：-4
> 
> 时间：2012-05-21T15:24:48.900
> 
> 标签：c++, visual-studio-2010, try-catch

我在发布配置中使用 VS2010 和 C++

以下执行正常：

```
int status;
try
{
    status = myfunction(arg1, arg2);
}
catch (int e)
{
    cout << "An exception occurred. Exception Nr. " << e << endl;
} 
```

但是，以下内容使程序崩溃：

```
int status;
status = myfunction(arg1, arg2); 
```

发生了什么？
我没有方法的来源，myfunction，它是第三方 dll 的一部分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T15:30:00.353

通过删除 try/catch 块，您不会捕获调用函数时引发的异常。这会导致未捕获的异常一直结束堆栈，`main()`并且由于它仍未处理，因此退出程序

从输出看来，抛出的整数似乎是确切发生错误的代码。要查看这是否可以调和，您需要查找错误代码。

# actionscript-3 - 在 Flash Builder AS3 中向按钮添加过滤器

> ID：10688101
> 
> 赞同：0
> 
> 时间：2012-05-21T15:25:07.890
> 
> 标签：actionscript-3, button, filter, flash-builder, add

我尝试在 creationComplete 事件中为某些按钮添加阴影效果。

导入 flash.filters.DropShadowFilter；

```
// #1 Does work but removes other filters
protected function onButtonCreate(e:Event):void
{
 (e.target as Button).filters = [new DropShadowFilter(1,45,0x000000,0.4,4,4,2,1,false,true,false)];
}

// #2 Does not work
protected function onButtonCreate(e:Event):void
{
 (e.target as Button).filters.push(new DropShadowFilter(1,45,0x000000,0.4,4,4,2,1,false,true,false));
}

// #3 Does not work
protected function onButtonCreate(e:Event):void
{
 (e.target as Button).filters[(e.target as Button).filters.length] = new DropShadowFilter(1,45,0x000000,0.4,4,4,2,1,false,true,false);
} 
```

我究竟做错了什么？正确的方法是什么？

**编辑：**我正在使用 flex Spark 主题。按钮的过滤器数组没有元素但更改过滤器属性会删除所有应用的 Spark 主题样式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:29:02.443

Adboes 对此的实现有点 hacky，它不监听数组的更新，但只有设置数组才会更新过滤器。所以这就是你解决它的方法（复制旧数组并将新数组推送到它）。

```
var button:Button = (e.target as Button);
var oldFilters:Array = button.filters;
oldFilters.push(new DropShadowFilter(1,45,0x000000,0.4,4,4,2,1,false,true,false)]);
button.filters = oldFilters; 
```

如果这不起作用，您将不得不使用旧数组的内容创建一个新数组，并将新过滤器推送到新数组。

# gwt - 如何使用画布作为带有 GWT 的 celltable 小部件的单元格？

> ID：10688104
> 
> 赞同：2
> 
> 时间：2012-05-21T15:25:24.537
> 
> 标签：gwt, gwt-2.2-celltable

一切都在问题中，如何通过在 GWT 中使用 CellTable 创建一个带有画布的自定义单元格？

我搜索了一种将画布转换为 html 以将其附加到渲染方法的 SafeHtmlBuilder 参数但没有成功的方法。这是自定义单元格的有趣片段：

```
public void render(Context context, String value, SafeHtmlBuilder sb) {

    Canvas c = Canvas.createIfSupported();

    // create a text into the canvas using the value parameter
    // something like (this is not important) : 
    c.getContext2d().drawTheText(value);

    // here is the problem, what kind of transformation may I do 
    // to use the canvas in this cell ?
    SafeHtml safeValue = SafeHtmlUtils.fromString(c.?????);
    sb.append(safeValue);
} 
```

**编辑：这是可行的解决方案，感谢 Thomas**

```
sb.append(SafeHtmlUtils.fromTrustedString("<img src=\"" + canvas.toDataUrl() + "\" />")); 
```

请注意，应使用模板而不是直接使用一段 html 代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:54:25.880

我认为您必须使用`toDataURL()`并构建一个`<img>`元素来显示它。

请注意，您可以在调用;`Canvas`之间重用相同的实例。`render`只要确保在重用之前清除它。

# php - 字符串的加密和解密

> ID：10688107
> 
> 赞同：0
> 
> 时间：2012-05-21T15:25:33.613
> 
> 标签：php, security, encryption

我想以这种方式加密和解密字符串

加密

> 字符串---->转换为十六进制---->对十六进制进行一些数学运算以获得新的十六进制

解密：

> 十六进制 ----> 反转数学运算以获得第一个十六进制 -----> 转换为字符串

是否可以进行这种类型的加密解密......以及如何将十六进制（八进制甚至base32或base64转换为原始字符串）？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:37:55.770

只是吐代码

到字节数组；

```
$text = 'blub';
$out = new Array();

for($i = 0; i < strlen($text); i++)
{
    $out[$i] = ord(substr($text, $i, 1));
}

// Do what you want to your bytes here :D 
```

而对于倒车

```
// Do stuff reversed to your encoding

$out = new Array();
$text = '';

for($i = 0; i < count($out); i++)
{
    $text = $text . chr($out[$i]);
} 
```

# c++ - VC++ manifest - 在 assemblyIdentity 中设置版本

> ID：10688109
> 
> 赞同：0
> 
> 时间：2012-05-21T15:25:40.350
> 
> 标签：c++, visual-studio-2008, manifest

我有一个 C++ 项目，在构建时将 CRT 版本 9.0.21022.8 写入清单文件中的 assemblyIdentity 标记。由于我安装了 VS2008 SP1，我假设在重新构建后最新的 CRT 版本 9.0.30729.1 将被写入清单，但事实并非如此，它仍然是 9.0.21022.8。我的假设是错误的吗？如何让我的构建在清单文件中反映最新版本的 CRT？

提前致谢。

# error-handling - Mule：未调用异常策略

> ID：10688110
> 
> 赞同：4
> 
> 时间：2012-05-21T15:25:48.370
> 
> 标签：error-handling, esb, mule

我在 Mule 3.2.1 中有一个简单的流程，它只应该重新发布一个 web 服务。目标是了解异常处理在 Mule 中的工作原理。为了测试这一点，我使用了一个总是返回异常（即永远不会正确或错误响应）的 Web 服务，我想捕获这个异常并处理它（为初学者登录文件）。

问题是似乎根本没有调用异常策略......

我尝试了两个版本——第一个带有默认异常策略，第二个带有自定义异常策略。流程如下所示：

```
<flow name="LoginFlow">
    <http:inbound-endpoint address="http://localhost:8081/WsFaultResponseMule" exchange-pattern="request-response">
        <cxf:jaxws-service serviceClass="aaa.bbb.Soap">
            <cxf:features>
                <spring:bean class="sandbox.StackTraceFeature" id="stackTraceService"/>                     
            </cxf:features>
        </cxf:jaxws-service>
    </http:inbound-endpoint>

    <http:outbound-endpoint 
        host="localhost"
        port="8080"
        path="WsFaultResponse/services/Soap"
        exchange-pattern="request-response">
        <cxf:jaxws-client
            clientClass="aaa.bbb.SforceService"
            port="Soap"
            wsdlLocation="classpath:wsdl/partner.wsdl"
            operation="login"
            soapVersion="1.1"
            enableMuleSoapHeaders="false">
        </cxf:jaxws-client>
    </http:outbound-endpoint>

    <default-exception-strategy>
        <processor-chain>
            <object-to-string-transformer/>
            <file:outbound-endpoint path="data/exception" outputPattern="#[function:datestamp:yyyyMMddHHmmss].err"/>
        </processor-chain>
    </default-exception-strategy>

    <!-- <custom-exception-strategy class="exception.TestExceptionListener"/> -->
</flow> 
```

流程的注释掉部分中提到的自定义策略是微不足道的（基本上与他们文档中的策略相同）：

```
public class TestExceptionListener extends DefaultMessagingExceptionStrategy {

    public TestExceptionListener(MuleContext muleContext) {
        super(muleContext);
    }

    private MuleEvent handle(Exception ex, MuleEvent event, RollbackSourceCallback rollbackMethod) {

        logger.warn("Exception: " + ex.getMessage());
        Object payloadBefore = event.getMessage().getPayload();
        MuleEvent result = super.handleException(ex, event, rollbackMethod);
        result.getMessage().setPayload(payloadBefore);

        return result;
    }

    @Override
    public MuleEvent handleException(Exception ex, MuleEvent event) {
        return handle(ex, event, null);
    }

    @Override
    public MuleEvent handleException(Exception ex, MuleEvent event, RollbackSourceCallback rollbackMethod) {
        return handle(ex, event, rollbackMethod);
    }
} 
```

当我使用上述配置运行 Mule 服务器时，我没有得到预期的输出。我的期望是 default-exception-strategy 应该在异常目录中生成一个文件，但这不会发生。Java 策略应该将消息记录到控制台中，但同样，我什么也看不到...放置在句柄方法中的断点也根本不会触发。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:41:32.273

问题出在 Mule 版本上。该流程在 3.3.0-R3 中正常工作。

流量：

```
<default-exception-strategy>
    <processor-chain>
        <custom-transformer class="exception.StackTraceTransformer"/>
        <file:outbound-endpoint path="data/exception" outputPattern="#[function:datestamp:yyyyMMddHHmmss].txt"/>
    </processor-chain>
</default-exception-strategy> 
```

定制变压器：

```
public class StackTraceTransformer extends AbstractMessageTransformer {
    public StackTraceTransformer() {
        setName("StackTraceToText");
    }

    @Override
    public Object transformMessage(MuleMessage message, String outputEncoding) throws TransformerException {
        StringWriter writer = new StringWriter();
        PrintWriter stream = new PrintWriter(writer);
        Throwable t = ((ExceptionMessage) message.getPayload()).getException();
        t.printStackTrace(stream);
        return writer.toString();
    }
} 
```

# android - JavaCV 图像模糊

> ID：10688113
> 
> 赞同：3
> 
> 时间：2012-05-21T15:26:02.320
> 
> 标签：android, javacv

有人用过`JavaCV`吗？

我正在尝试在自定义形状图形的边缘周围实现模糊，该图形实际上是该图形周围具有透明度的图像？每次使用该`blur()`功能时，我都会收到此错误：`java.lang.RuntimeException: vector::_M_fill_insert`，我仍然使用 cvSmooth 但它只是模糊了整个图像......所以在 JavaCV 中有什么方法可以在自定义形状的图像周围添加羽化或某种模糊.. . 这是一个非常大的库，有很多功能......所以我认为它必须提供一些东西......

我还没有找到任何类型的文档`JavaCV`...

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T06:40:01.400

1.  创建 Src Image cvCloneImage() 的副本
2.  模糊克隆图像 cvSmooth()
3.  将 srcImage 添加到蓝色图像 cvAdd()

# c# - 大型正则表达式匹配导致程序挂起

> ID：10688115
> 
> 赞同：4
> 
> 时间：2012-05-21T15:26:12.143
> 
> 标签：c#, wpf, regex, parsing

前几天我试着问这个，诚然一开始没有很好地表达这个问题或邮政编码，答案被关闭了。所以我在这里再次尝试，因为老实说，这让我很快发疯。:)

我正在尝试实现这个[Address Parser](http://usaddress.codeplex.com/)，它最初是一个基于控制台的 c# 程序。我已成功地将其转换为一个独立的 WPF 程序，该程序仅包含一个`TextBox`用于输入、一个`Button`用于激活解析和一个`TextBlock`用于显示结果。在写这篇文章时，我确实将输出截断为我在主程序中需要的内容，但它仍然可以正常工作。我已经在下面包含了整个代码。

我的下一步是将其移植到我的主程序中，我通过使用复制/粘贴来完成。但是，在运行此程序时，程序会在按下按钮后挂起。最终 VS 给出了一个错误，即进程时间过长而没有输出消息，并且 TaskManager 中的内存使用量逐渐从 ~70k 增加到 3,000,000。针对这种情况，我将`Parsing`方法分配给了一个后台worker，希望能减轻主进程的工作量。这确实解决了程序冻结的问题，但后台线程只是做了同样的事情，提高了 RAM 使用率并且什么也不返回。

所以现在我陷入了僵局。我知道问题出在`var result = parser.ParseAddress(input);`语句的某个地方，因为当对每一行代码使用断点时，这是最后一个触发的。但基本上我不明白为什么这会在一个 WPF 程序而不是另一个程序中导致问题。

如果有必要，我会非常乐意将主程序的完整源代码发布到某个地方，但我无法想象在这里发布大约 20 个不同的类文件和项目的代码会是个好主意。:)

**独立的 WPF 应用程序**

```
namespace AddressParseWPF
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        public void Execute()
        {
            AddressParser.AddressParser parser = new AddressParser.AddressParser();
            var input = inputTextBox.Text;

            var result = parser.ParseAddress(input);

            if (result == null)
            {
                outputTextBlock.Text = "ERROR. Input could not be parsed.";
            }
            else
            {
                outputTextBlock.Text = (result.StreetLine + ", " + result.City + ", " + result.State + "  " + result.Zip);
            }
        }

        private void actionButton_Click(object sender, RoutedEventArgs e)
        {
            Execute();
        }
    }
} 
```

**将 Parser 移植到的主程序**

```
public void ExecuteAddressParse()
{
    AddressParser.AddressParser parser = new AddressParser.AddressParser();
    var input = inputTextBox.Text;

    var result = parser.ParseAddress(input);

    if (result == null)
    {
        outputTextBlock.Text = "ERROR. Input could not be parsed.";
    }
    else
    {
        outputTextBlock.Text = (result.StreetLine + ", " + result.City + ", " + result.State + "  " + result.Zip);
    }
}       

private void actionButton_Click(object sender, RoutedEventArgs e)
{
    ExecuteAddressParse();
} 
```

**ParseAddress 方法**

```
public AddressParseResult ParseAddress(string input)
{
    if (!string.IsNullOrWhiteSpace(input))
    {
        var match = addressRegex.Match(input.ToUpperInvariant());
        if (match.Success)
        {
            var extracted = GetApplicableFields(match);
            return new AddressParseResult(Normalize(extracted));
        }
    }

    return null;
} 
```

**正则表达式匹配方法**

```
private static void InitializeRegex()
{
    var suffixPattern = new Regex(
        string.Join(
            "|",
            new [] {
                string.Join("|", suffixes.Keys), 
                string.Join("|", suffixes.Values.Distinct())
            }),
        RegexOptions.Compiled);

    var statePattern = 
        @"\b(?:" + 
        string.Join(
            "|",
            new [] {
                string.Join("|", states.Keys.Select(x => Regex.Escape(x))),
                string.Join("|", states.Values)
            }) +
        @")\b";

    var directionalPattern =
        string.Join(
            "|",
            new [] {
                string.Join("|", directionals.Keys),
                string.Join("|", directionals.Values),
                string.Join("|", directionals.Values.Select(x => Regex.Replace(x, @"(\w)", @"$1\.")))
            });

    var zipPattern = @"\d{5}(?:-?\d{4})?";

    var numberPattern =
        @"(
            ((?<NUMBER>\d+)(?<SECONDARYNUMBER>(-[0-9])|(\-?[A-Z]))(?=\b))    # Unit-attached
            |(?<NUMBER>\d+[\-\ ]?\d+\/\d+)                                   # Fractional
            |(?<NUMBER>\d+-?\d*)                                             # Normal Number
            |(?<NUMBER>[NSWE]\ ?\d+\ ?[NSWE]\ ?\d+)                          # Wisconsin/Illinois
          )";

    var streetPattern =
        string.Format(
            CultureInfo.InvariantCulture,
            @"
                (?:
                  # special case for addresses like 100 South Street
                  (?:(?<STREET>{0})\W+
                     (?<SUFFIX>{1})\b)
                  |
                  (?:(?<PREDIRECTIONAL>{0})\W+)?
                  (?:
                    (?<STREET>[^,]*\d)
                    (?:[^\w,]*(?<POSTDIRECTIONAL>{0})\b)
                   |
                    (?<STREET>[^,]+)
                    (?:[^\w,]+(?<SUFFIX>{1})\b)
                    (?:[^\w,]+(?<POSTDIRECTIONAL>{0})\b)?
                   |
                    (?<STREET>[^,]+?)
                    (?:[^\w,]+(?<SUFFIX>{1})\b)?
                    (?:[^\w,]+(?<POSTDIRECTIONAL>{0})\b)?
                  )
                )
            ",
            directionalPattern,
            suffixPattern);

    var rangedSecondaryUnitPattern =
        @"(?<SECONDARYUNIT>" +
        string.Join("|", rangedSecondaryUnits.Keys) +
        @")(?![a-z])";
    var rangelessSecondaryUnitPattern =
        @"(?<SECONDARYUNIT>" +
        string.Join(
            "|",
            string.Join("|", rangelessSecondaryUnits.Keys)) +
        @")\b";
    var allSecondaryUnitPattern = string.Format(
        CultureInfo.InvariantCulture,
        @"
            (
                (:?
                    (?: (?:{0} \W*)
                        | (?<SECONDARYUNIT>\#)\W*
                    )
                    (?<SECONDARYNUMBER>[\w-]+)
                )
                |{1}
            ),?
        ",
         rangedSecondaryUnitPattern,
         rangelessSecondaryUnitPattern);

    var cityAndStatePattern = string.Format(
        CultureInfo.InvariantCulture,
        @"
            (?:
                (?<CITY>[^\d,]+?)\W+
                (?<STATE>{0})
            )
        ",
        statePattern);
    var placePattern = string.Format(
        CultureInfo.InvariantCulture,
        @"
            (?:{0}\W*)?
            (?:(?<ZIP>{1}))?
        ",
        cityAndStatePattern,
        zipPattern);

    var addressPattern = string.Format(
        CultureInfo.InvariantCulture,
        @"
            ^
            # Special case for APO/FPO/DPO addresses
            (
                [^\w\#]*
                (?<STREETLINE>.+?)
                (?<CITY>[AFD]PO)\W+
                (?<STATE>A[AEP])\W+
                (?<ZIP>{4})
                \W*
            )
            |
            # Special case for PO boxes
            (
                \W*
                (?<STREETLINE>(P[\.\ ]?O[\.\ ]?\ )?BOX\ [0-9]+)\W+
                {3}
                \W*
            )
            |
            (
                [^\w\#]*    # skip non-word chars except # (eg unit)
                (  {0} )\W*
                   {1}\W+
                (?:{2}\W+)?
                   {3}
                \W*         # require on non-word chars at end
            )
            $           # right up to end of string
        ",
        numberPattern,
        streetPattern,
        allSecondaryUnitPattern,
        placePattern,
        zipPattern);
    addressRegex = new Regex(
        addressPattern,
        RegexOptions.Compiled | 
        RegexOptions.Singleline | 
        RegexOptions.IgnorePatternWhitespace);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T16:07:25.990

省略`RegexOptions.Compiled`标志时，正则表达式是否有效？

答复是肯定的。

所以为什么？

似乎正则表达式编译器对于（一些？）大模式很慢。

这是你必须做出的权衡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T22:09:36.667

一些正则表达式子表达式是不恰当的（正如@Justin Morgan 所提到的）。
这通常是加入可重复使用的零散正则表达式的结果，这让
我感到畏缩。

但是，如果您打算使用/执行这种方法，那么
在构建后打印出实际的正则表达式总是一个好主意。并且，在格式化之后，针对
样本进行测试，并独立于您的主程序进行测试。这样更容易修复。
如果您看到可疑的子表达式，请尝试在该点使其失败，或者
通常尝试在样本末尾附近插入失败。如果超过
一眨眼的功夫就失败了，那么它就严重地倒退了。

不过回溯也不错。它有很大的好处。没有它，有些事情
就无法匹配。诀窍是隔离不影响
结果相对于它周围的结果的子表达式，然后限制它的回溯。

我去了 USPS 站点并抓取了一些样本状态/后缀/方向/辅助
样本，足以生成地址正则表达式。
下面是从您的代码生成的正则表达式的清理版本。

祝你好运！

```
 ^
   # Special case for APO/FPO/DPO addresses
   (
      [^\w\#]*
      (?<STREETLINE> .+? )
      (?<CITY> [AFD] PO )
      \W+
      (?<STATE> A [AEP] )
      \W+
      (?<ZIP> \d{5} (?: -? \d{4} )? )
      \W*
   )
 |         
   # Special case for PO boxes
   (
      \W*
      (?<STREETLINE> ( P [\.\ ]? O [\.\ ]? \  )? BOX \  [0-9]+ )
      \W+
      (?:
          (?:
              (?<CITY> [^\d,]+? )
              \W+
              (?<STATE>
                 \b
                 (?:AL|AK|AS|AZ|AR|Alabama|Alaska|American Samoa|Arizona|Arkansas)
                 \b
              )
          )
          \W*
      )?
      (?:
          (?<ZIP> \d{5} (?: -? \d{4} )? )
      )?
      \W*
   )
 |          
   (
       [^\w\#]*    # skip non-word chars except # (eg unit)
       (
         (
              (
                (?<NUMBER> \d+ )
                (?<SECONDARYNUMBER> (-[0-9]) | (\-?[A-Z]) )
                (?=\b)
              )                                                  # Unit-attached
           |          
             (?<NUMBER> \d+ [\-\ ]? \d+ \/ \d+ )                 # Fractional
           |
             (?<NUMBER> \d+ -? \d* )                             # Normal Number
           |
             (?<NUMBER>[NSWE]\ ?\d+\ ?[NSWE]\ ?\d+)              # Wisconsin/Illinois
         )
       )
       \W*

       (?:
           # special case for addresses like 100 South Street
           (?:
               (?<STREET>North|East|South|West|Northeast|Southeast|Northwest|Southwest|N|E|S|W|NE|SE|NW|SW|N\.|E\.|S\.|W\.|N\.E\.|S\.E\.|N\.W\.|S\.W\.)
               \W+
               (?<SUFFIX>ALLEY|ALY|ALLY|ALLEE|ALLEY|ALY)
               \b
           )
         |
           (?:
               (?<PREDIRECTIONAL>North|East|South|West|Northeast|Southeast|Northwest|Southwest|N|E|S|W|NE|SE|NW|SW|N\.|E\.|S\.|W\.|N\.E\.|S\.E\.|N\.W\.|S\.W\.)
               \W+
           )?
           (?:
                (?<STREET> [^,]* \d )
                (?:
                   [^\w,]*
                   (?<POSTDIRECTIONAL>North|East|South|West|Northeast|Southeast|Northwest|Southwest|N|E|S|W|NE|SE|NW|SW|N\.|E\.|S\.|W\.|N\.E\.|S\.E\.|N\.W\.|S\.W\.)
                   \b
                )
             |
                (?<STREET> [^,]+ )
                (?:
                    [^\w,]+
                    (?<SUFFIX>ALLEY|ALY|ALLY|ALLEE|ALLEY|ALY)
                    \b
                )
                (?:
                    [^\w,]+
                    (?<POSTDIRECTIONAL>North|East|South|West|Northeast|Southeast|Northwest|Southwest|N|E|S|W|NE|SE|NW|SW|N\.|E\.|S\.|W\.|N\.E\.|S\.E\.|N\.W\.|S\.W\.)
                    \b
                )?
             |
                (?<STREET> [^,]+? )
                (?:
                    [^\w,]+
                    (?<SUFFIX>ALLEY|ALY|ALLY|ALLEE|ALLEY|ALY)
                    \b
                )?
                (?:
                    [^\w,]+
                    (?<POSTDIRECTIONAL>North|East|South|West|Northeast|Southeast|Northwest|Southwest|N|E|S|W|NE|SE|NW|SW|N\.|E\.|S\.|W\.|N\.E\.|S\.E\.|N\.W\.|S\.W\.)
                    \b
                )?
           )
       )           

       \W+        

       (?:      
           (
               (
                  :?
                  (?:
                      (?:
                         (?<SECONDARYUNIT>APT|BLDG|DEPT|FL|HNGR|LOT|PIER|RM|SLIP|SPC|STOP|STE|TRLR|UNIT)
                         (?! [a-z] )
                         \W*
                       )
                    |
                       (?<SECONDARYUNIT> \# )
                       \W*
                  )
                  (?<SECONDARYNUMBER> [\w-]+ )
               )
             |
               (?<SECONDARYUNIT>BSMT|FRNT|LBBY|LOWR|OFC|PH|REAR|SIDE|UPPR)
               \b
           )
           ,?
           \W+
       )?

       (?:
           (?:
               (?<CITY> [^\d,]+? )
               \W+
               (?<STATE>
                  \b
                  (?:AL|AK|AS|AZ|AR|Alabama|Alaska|American Samoa|Arizona|Arkansas)
                  \b
               )
           )
           \W*
       )?

       (?:
           (?<ZIP> \d{5} (?: -? \d{4} )? )
       )?

       \W*         # require on non-word chars at end
   )
 $           # right up to end of string 
```

C# 代码

```
 public static void InitializeRegex()
    {
        Dictionary<string, string> suffixes = new Dictionary<string, string>()
        {
          {"ALLEY",  "ALLEE"},
          {"ALY",  "ALLEY"},
          {"ALLY",  "ALY"},
        };

        var suffixPattern = new Regex(
            string.Join(
                "|",
                new[] {
            string.Join("|", suffixes.Keys.ToArray()), 
            string.Join("|", suffixes.Values.Distinct().ToArray())
        }),
            RegexOptions.Compiled);

        //Console.WriteLine("\n"+suffixPattern);

        Dictionary<string, string> states = new Dictionary<string, string>()
        {
           {"AL", "Alabama"},
           {"AK", "Alaska"},
           {"AS",  "American Samoa"},
           {"AZ",  "Arizona"},
           {"AR", "Arkansas"}
        };

        var statePattern =
            @"\b(?:" +
            string.Join(
                "|",
                new[] {
            string.Join("|", states.Keys.Select(x => Regex.Escape(x)).ToArray()),
            string.Join("|", states.Values.ToArray())
        }) +
            @")\b";

        //Console.WriteLine("\n" + statePattern);

        Dictionary<string, string> directionals = new Dictionary<string, string>()
        {
           {"North", "N" },
           {"East", "E" },
           {"South", "S" },
           {"West", "W" },
           {"Northeast", "NE" },
           {"Southeast", "SE" },
           {"Northwest", "NW" },
           {"Southwest", "SW" }
        };

        var directionalPattern =
            string.Join(
                "|",
                new[] {
            string.Join("|", directionals.Keys.ToArray()),
            string.Join("|", directionals.Values.ToArray()),
            string.Join("|", directionals.Values.Select(x => Regex.Replace(x, @"(\w)", @"$1\.")).ToArray())
        });

        //Console.WriteLine("\n" + directionalPattern);

        var zipPattern = @"\d{5}(?:-?\d{4})?";

        //Console.WriteLine("\n" + zipPattern);

        var numberPattern =
            @"(
                ((?<NUMBER>\d+)(?<SECONDARYNUMBER>(-[0-9])|(\-?[A-Z]))(?=\b))    # Unit-attached
                |(?<NUMBER>\d+[\-\ ]?\d+\/\d+)                                   # Fractional
                |(?<NUMBER>\d+-?\d*)                                             # Normal Number
                |(?<NUMBER>[NSWE]\ ?\d+\ ?[NSWE]\ ?\d+)                          # Wisconsin/Illinois
             )";

        //Console.WriteLine("\n" + numberPattern);

        var streetPattern =
            string.Format(
                CultureInfo.InvariantCulture,
                @"
                    (?:
                      # special case for addresses like 100 South Street
                      (?:(?<STREET>{0})\W+
                         (?<SUFFIX>{1})\b)
                      |
                      (?:(?<PREDIRECTIONAL>{0})\W+)?
                      (?:
                        (?<STREET>[^,]*\d)
                        (?:[^\w,]*(?<POSTDIRECTIONAL>{0})\b)
                       |
                        (?<STREET>[^,]+)
                        (?:[^\w,]+(?<SUFFIX>{1})\b)
                        (?:[^\w,]+(?<POSTDIRECTIONAL>{0})\b)?
                       |
                        (?<STREET>[^,]+?)
                        (?:[^\w,]+(?<SUFFIX>{1})\b)?
                        (?:[^\w,]+(?<POSTDIRECTIONAL>{0})\b)?
                      )
                    )
                ",
                directionalPattern,
                suffixPattern);

        //Console.WriteLine("\n" + streetPattern);

        Dictionary<string, string> rangedSecondaryUnits = new Dictionary<string, string>()
        {
            {"APT",  "APARTMENT"},
            {"BLDG", "BUILDING"}, 
            {"DEPT", "DEPARTMENT"}, 
            {"FL",   "FLOOR"}, 
            {"HNGR", "HANGAR"}, 
            {"LOT",  "LOT"}, 
            {"PIER", "PIER"}, 
            {"RM",   "ROOM"}, 
            {"SLIP", "SLIP"}, 
            {"SPC",  "SPACE"}, 
            {"STOP", "STOP"}, 
            {"STE",  "SUITE"}, 
            {"TRLR", "TRAILER"}, 
            {"UNIT", "UNIT"} 
        };
        var rangedSecondaryUnitPattern =
            @"(?<SECONDARYUNIT>" +
            string.Join("|", rangedSecondaryUnits.Keys.ToArray()) +
            @")(?![a-z])";

        //Console.WriteLine("\n" + rangedSecondaryUnitPattern);

        Dictionary<string, string> rangelessSecondaryUnits = new Dictionary<string, string>()
        {
            {"BSMT", "BASEMENT"},
            {"FRNT", "FRONT"},
            {"LBBY", "LOBBY"},
            {"LOWR", "LOWER"},
            {"OFC",  "OFFICE"},
            {"PH",   "PENTHOUSE"},
            {"REAR", "REAR"},
            {"SIDE", "SIDE"},
            {"UPPR", "UPPER"}
        };

        var rangelessSecondaryUnitPattern =
            @"(?<SECONDARYUNIT>" +
            string.Join("|", rangelessSecondaryUnits.Keys.ToArray()) +
            @")\b";

        //Console.WriteLine("\n" + rangelessSecondaryUnitPattern);

        var allSecondaryUnitPattern = string.Format(
            CultureInfo.InvariantCulture,
            @"
                (
                    (:?
                        (?: (?:{0} \W*)
                            | (?<SECONDARYUNIT>\#)\W*
                        )
                        (?<SECONDARYNUMBER>[\w-]+)
                    )
                    |{1}
                ),?
            ",
             rangedSecondaryUnitPattern,
             rangelessSecondaryUnitPattern);

        //Console.WriteLine("\n" + allSecondaryUnitPattern);

        var cityAndStatePattern = string.Format(
            CultureInfo.InvariantCulture,
            @"
                (?:
                    (?<CITY>[^\d,]+?)\W+
                    (?<STATE>{0})
                )
            ",
            statePattern);

        //Console.WriteLine("\n" + cityAndStatePattern);

        var placePattern = string.Format(
            CultureInfo.InvariantCulture,
            @"
                (?:{0}\W*)?
                (?:(?<ZIP>{1}))?
            ",
            cityAndStatePattern,
            zipPattern);

        //Console.WriteLine("\n" + placePattern);

        var addressPattern = string.Format(
            CultureInfo.InvariantCulture,
            @"
                ^
                # Special case for APO/FPO/DPO addresses
                (
                    [^\w\#]*
                    (?<STREETLINE>.+?)
                    (?<CITY>[AFD]PO)\W+
                    (?<STATE>A[AEP])\W+
                    (?<ZIP>{4})
                    \W*
                )
                |
                # Special case for PO boxes
                (
                    \W*
                    (?<STREETLINE>(P[\.\ ]?O[\.\ ]?\ )?BOX\ [0-9]+)\W+
                    {3}
                    \W*
                )
                |
                (
                    [^\w\#]*    # skip non-word chars except # (eg unit)
                    (  {0} )\W*
                       {1}\W+
                    (?:{2}\W+)?
                       {3}
                    \W*         # require on non-word chars at end
                )
                $           # right up to end of string
            ",
            numberPattern,
            streetPattern,
            allSecondaryUnitPattern,
            placePattern,
            zipPattern);

        Console.WriteLine("\n-----------------------------\n\n" + addressPattern);

        var addressRegex = new Regex(
            addressPattern,
            RegexOptions.Compiled |
            RegexOptions.Singleline |
            RegexOptions.IgnorePatternWhitespace);

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:42:27.953

[像这样逐渐增加资源使用是灾难性回溯](http://www.regular-expressions.info/catastrophic.html)的确凿证据。基本上，如果你有类似的东西，比如这部分：

```
(?<CITY>[^\d,]+?)\W+ 
```

...那么输入的哪一部分与模式的哪一部分匹配就会有歧义。几乎任何匹配的东西`\W`也可以匹配`[^\d,]`。如果输入在第一次通过时无法匹配，引擎将返回并尝试这两组的不同排列，这会消耗资源。

例如，假设您输入的“城市”部分后面有一大堆空格。一长串空格将同时匹配`[^\d,]+?`and `\W+`，因此尚不清楚 CITY 组是否包含空格。基于这些量词的惰性/贪婪行为，引擎将尝试*仅*将城市名称放入. 然后它会继续前进并尝试匹配输入的其余部分。`[^\d,]+?``\W+`

如果输入的其余部分在第一次尝试时匹配，那很好。但是，如果匹配失败，它将不得不返回并重试，这次将其中一个空间匹配`[^\d,]+?`并捕获为您的 CITY 组的一部分。如果失败，它将使用两个空格重试，依此类推。

您通常会看到这成为嵌套量词的问题，例如`([ABC]+)*`. 我在您的模式中看不到任何正在发生的事情，但我可能在所有`string.Format`电话中都错过了一些东西。我的猜测是它是一个很长的模式，有很多量词和交流器要回溯（还有很多组要存储），即使是单级迭代也会让你丧命。我敢打赌，长输入字符串匹配*大多数*模式，但无法匹配所有模式，您会获得最大的性能影响。

在这种情况下，编译正则表达式可能会有所帮助，您应该这样做。但是，当您的应用程序一次获得一千次（或多少次）点击时，我怀疑这会减少它。还会有某些输入字符串会导致大量回溯，并在性能方面给您带来更大的打击。我最大的建议是找到并解决模式中的歧义。

找到有很多量词彼此相似`*`和`+`靠近的地方，并确保它们之间有清晰的、非可选的分隔符（例如，`\d+-?\d*`从您的 NUMBER 组中，性能会更好`\d+(-\d*)?`，或者更好`\d+(-\d+)?\b`）。最后，确保分隔符不能匹配它们旁边的标记。`\W+\ \W+`对于一个虚构的例子，如果你给它输入一长串空白，类似的东西会一直拖下去。

# c# - objectdatasource 将 gridview 数据源转换回通用列表

> ID：10688118
> 
> 赞同：0
> 
> 时间：2012-05-21T15:26:33.987
> 
> 标签：c#, asp.net

环境：asp.net fx3.5

我正在为我的gridview 使用objectdatasource。起初，我`List<Attachments>`为我的客户加载了来自通用记录的 gridview。接下来，我想在所有添加/删除完成之前，在不访问数据库的情况下从 gridview 添加/删除项目。然后用户将点击保存按钮，然后我将在 gridview 中保留项目。

我的问题是如何在 objectdatasource 连接到 gridview 时在 gridview 中添加/删除项目？我的猜测是以某种方式将 gridview 行转换回通用列表，然后添加/删除项目，然后重新绑定？这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:41:58.030

I would recommend to save changes to database if you are doing or can do postback on add/remove. As not saving data along change might cause loss of information. You can use ajax call for add/remove to make it more elegant and fast without reloading whole page.

or

If you want to do all add/remove on client side and finally saving to database, you can uses client storage to keep the changes temporarily and finally sending the changes back to server and commit them to database. Article about client storage [here](http://www.html5rocks.com/en/tutorials/offline/storage/) but it might not be supported by old browsers

or

You can put change in hidden fields e.g for deleted records you have one hidden field which store deleted record ids, on hidden field with added records with set pattern and update the database on postback using these hidden fields again there is hazard for losing information with this method

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:07:42.873

您可以暂时存储在 ViewState 中。您需要有一个提供者类，即对您存储在视图状态中的列表执行基本 CRUD 操作的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:32:45.237

由于您将只使用网格事件来存储所有这些信息以进行处理，因此您在数据源中唯一需要的是一个 select 方法，这样它就不会尝试更新/插入记录。您可以对 rowCommand 事件进行所有事件处理。

至于你正在尝试什么，我认为这不是一个好主意。您将不得不跟踪会话中的多条记录，或单独的数据库表（但那有什么意义呢？）。

# java - JNA 本机函数调用和具有双**指针/数组内存分配的结构

> ID：10688120
> 
> 赞同：1
> 
> 时间：2012-05-21T15:26:54.253
> 
> 标签：java, c++, native, jna

我正在使用带有 JNA 框架的 Java 应用程序中的本机 c++ dll。我有一个函数调用的问题。也许我没有正确分配内存？我没有意见，下一步该尝试什么。我没有得到更多信息来帮助我摆脱文档和论坛线程。我希望你能给我一个提示，会很好。

我想调用一个本机函数（在示例中`FooInterface`）。该函数将结构体`TNativeFoo`作为输入和输出参数。该结构`TNativeFoo`包含一个`Double**`/`Double[][]`数据。该字段可以看作是一个多维数组，但第一个维度的长度只有 1。所以它更像是一个指向大小为 的双精度数组的指针`Items`。

`StringArray`结构（`char**`/ ）中还有一个`String[]`带有 length 的`StringsCount`，这是无关紧要的，因为它没有被使用。我提到它是因为我不确定该错误是否与此有关。下面是对本机 dll 和结构的定义。

```
 public interface Foodll extends StdCallLibrary {

    Foodll INSTANCE = (Foodll) Native.loadLibrary("foodll.dll", Foodll.class);

    public static class TNativeFoo extends com.sun.jna.Structure {

    public TNativeFoo (){
            super();
            setAlignType(ALIGN_NONE);
        }
        public TNativeFoo(com.sun.jna.Pointer pointer,int offset) {
            super();
            setAlignType(ALIGN_NONE);
            useMemory(pointer,offset);
            read();
        }
        public TNativeFoo(TNativeFoo struct) {
        this(struct.getPointer(),0);
    }

        public static class ByReference extends TNativeFoo implements com.sun.jna.Structure.ByReference {
            ByReference() {}
            ByReference(TNativeFoo struct){super(struct.getPointer(),0);}
        }
        public static class ByValue extends TNativeFoo implements com.sun.jna.Structure.ByValue {
            ByValue() {}
            ByValue(TNativeFoo struct){super(struct.getPointer(),0);}
        }

        public PointerByReference Data;
        public NativeLong Items;
        public PointerByReference IrrelevantStringArray;
        public NativeLong StringsCounts = new NativeLong(0);
    }

    NativeLong FooInterface(TNativeFoo input, TNativeFoo output);
} 
```

对于函数的调用，我尝试在本机堆上分配内存并将数据写入其中。在像示例中那样将数据写入本机堆之后，我可以像在示例中那样使用替代方案 2 读取它（我在没有调用本机函数的情况下尝试了这个，并且直接从`inputFoo`. 像下面的示例中调用本机函数会引发致命异常。

调用：

```
public class FooInvocationClass
{
    public static FooInvocationMethod(double[] fooData)
    {

                Foodll foodllJnaLib = Foodll.INSTANCE;

                Foodll.TNativeFoo outputFoo = new Foodll.TNativeFoo();
                Foodll.TNativeFoo inputFoo = new Foodll.TNativeFoo();

        //Writing input data to the native heap
                Memory dataPointer = new Memory (fooData.length * Double.SIZE);
                dataPointer.write(0, fooData, 0, fooData.length);

                inputFoo.Data = new PointerByReference();
                inputFoo.Data.setValue(dataPointer);

                outputProfile.Data = new PointerByReference();
                inputFoo.Items = outputFoo.Items = new NativeLong(fooData.length);

        //Setting some irrelevant StringArray Parameters
                inputFoo.IrrelevantStringArray = outputFoo.IrrelevantStringArray = new PointerByReference();
                inputFoo.StringsCounts = outputFoo.StringsCounts = new NativeLong(0);

        //Invocation
        foodllJnaLib.FooInterface(inputFoo, outputFoo);

        //Reading Output
                Pointer outputFooDataPointer = outputFoo.Data.getValue();

        //Reading Output alternative  1
                Double[] outDataAlt1 = outputFooDataPointer.getDoubleArray(0, outputFoo.items);

        //Reading Output alternative  2
                Double[] outDataAlt2 = new Double[outputFoo.items];
                for (int x = 0; x < outputFoo.items; x += 1)
                {
                    outDataAlt2[x] = outputFooDataPointer.getDouble(x * 8);
                }
        }
} 
```

例外：

```
# A fatal error has been detected by the Java Runtime Environment:
#
#  Internal Error (0x0), pid=5904, tid=220
#
# JRE version: 7.0_04-b22
# Java VM: Java HotSpot(TM) Client VM (23.0-b21 mixed mode, sharing windows-x86 )
# Problematic frame:
# C  [KERNELBASE.dll+0xb9bc]  RaiseException+0x58
#
# Failed to write core dump. Minidumps are not enabled by default on client versions of Windows
#
# An error report file with more information is saved as:
# E:\Programme\apache-tomcat-7.0.27\bin\hs_err_pid5904.log
# 
```

我还可以想象 32 位 JVM 和在 64 位系统上运行的本机代码存在问题。我在我的 64 位系统上安装了一个 32 位 JVM，因为我遇到了 JNA“没有找到本机 dll”的问题。

# 编辑：

我发现我犯了一个错误，我查看了错误的结构定义，它看起来一样，但不是。所以我必须改变我的问题。

但我也提出我的问题是错误的，我尝试了你们提出的建议。他们帮助我理解了这个话题，我在发现正确的结构定义后尝试了他们。谢谢你。

但是异常保持不变。也许我在代码中有不止一个错误。所以我的问题又来了，希望现在是正确的，并且比以前有更多的信息。不得不 Foo 一些事情（关于公司），但语义保持不变。

我真的没有 h 文件或源代码。我加入这个项目很晚，我只是在做兼职。其他人正在用 C++/CLI 对本机调用进行编程，并且成功了。所以我附上了下面的代码。c++/CLI 代码下方是更改后的 Java 代码。

## c++/CLI:

```
typedef void (__stdcall *TFooInterface) (
   LONGLONG *APrgId,
   void *input,
   void *output,
   double value,
   HANDLE AAppHandle,
   HANDLE AProgessBar,
   char *AText, 
   char **ReturnText
   );

//-APrgID is a ID, which tells the Method, what type of processing it should do.
//-The void Pointers both take a TNativeFOO Structure. One is for the input, the other one is for the output.
//-The double-value is a Parameter for the algorithm.
//-The Handle Parameters are for a programm, the dll was created for. They give status about the processing or something like that. We now use the dll in an other context, so they aren't needed anymore.
//-char *AText amd. char **ReturnText are, also not needed anymore. They are for exception handling as far as I know. We handle the Exception in the new Context more general.

typedef struct {
   double         *Data;
   long           Items;
   unsigned char  *String;
   long           StringCounts;
   double         Value1, Value2;
   char           *FileName;
   char           *DataObject;
   char           *Comment;
   bool           Valid;
} TNativeFoo;

//-*Data is a double Array holding the data to process in TFooInterface
//-Items is the lenght of Data
//-*String and StringCounts are not needed anymore, because the dll is used in another way. I can't tell what it is for.
//-Value1, Value2 are Parameters used in the algorithm
//-FileName is for storing the result. Isn't used.
//-DataObject, Comment is also never used. I can't tell what it is for.
//-Valid is a success-flag of the algorithm.

void FooClass::FooIt(double[] FooData, HMODULE hFooLib)
{

    TNativeFoo Input, Output; //Declaration of the Structures   
    LONGLONG PrgID;
    LONGLONG ID;
    double value;

    double[] OutputData = new double[FooData.length];
    ID =-35547318716283305;

    //setting up the Structures 

    memset(&Input, 0, sizeof(TNativeFoo));
    memset(&Output, 0, sizeof(TNativeFoo));

    Output.Data = new double[FooData.length];
    Input.Data =  &(FooData[0]);
    Input.Items = Output.Items = FooData.length;
    Input.Value1 = Output.Value1 = 1.3;
    Input.Value2 = Output.Value2 = 2.3;
    Input.Valid = Output.Valid = true;

    FooInterface = (TFooInterface) GetProcAddress(hFooLib, "FooInterface");
    FooInterface(&ID, &Input, &Output, value, 0, 0, "", NULL);

    for (long i=0; i<Output.Items; i++)
    {
        OutputData[i]= Output.Data[i];
    }

    ...

} 
```

## Java 定义：

```
public interface Foodll extends StdCallLibrary {

    Foodll INSTANCE = (Foodll) Native.loadLibrary("foodll.dll", Foodll.class);

    //Structure
    public static class TNativeFoo extends com.sun.jna.Structure {

        public TNativeFoo(){
            setAlignType(Structure.ALIGN_NONE);
        }
        public TNativeFoo(com.sun.jna.Pointer pointer, int offset) {
            super(pointer.share(offset));
            setAlignType(Structure.ALIGN_NONE); //Tested all align-types. I was told this is the one used by the dlls
            read();
        }
        public TNativeFoo(TNativeProfile struct) {
            super(struct.getPointer());
            setAlignType(Structure.ALIGN_NONE); //Tested all align-types. I was told this is the one used by the dlls
            read();
        }
        public static class ByReference extends TNativeFoo implements com.sun.jna.Structure.ByReference {
            ByReference() {}
            ByReferenceTNativeFoo struct){super(struct.getPointer(),0);}
        }
       public static class ByValue extends TNativeFoo implements com.sun.jna.Structure.ByValue {
            ByValue() {}
            ByValueTNativeFoo struct){super(struct.getPointer(),0);}
        }
        public Pointer Data;
        public double[] getData() {
            if (this.Data == null) return null;
            return this.Data.getDoubleArray(0, Items.intValue());
        }
        public void setData(double[] data) {
            if (this.Data == null) {
                this.Data = new Memory(data.length * 8);
            }
            this.Data.write(0, data, 0, data.length);
        }
        public NativeLong Items;
        public String String;
        public NativeLong StringCounts = new NativeLong(0);
        public double Value1;
        public double Value2;
        public String FileName;
        public String DataObject;
        public String Comment;
        public boolean Valid;
    }

    NativeLong FooInterface(DoubleByReference prgid, TNativeFoo input, TNativeFoo output, double value, Pointer aAppHandle, Pointer aProgessBar, String AText, String[] ReturnText);
} 
```

## Java 调用：

```
public class FooInvocationClass
{
        public static FooInvocationMethod(double[] fooData, ID)
        {
                Foodll foodllJnaLib = Foodll.INSTANCE;

                Foodll.TNativeFoo outputFoo = new Foodll.TNativeFoo();
                Foodll.TNativeFoo inputFoo = new Foodll.TNativeFoo();

                inputFoo.setData(fooData);
                outputFoo.setData(new double[fooData.length]);
                inputFoo.Items = outputFoo.Items = new NativeLong(fooData.length);

                inputFoo.String = outputFoo.String = "";
                inputFoo.StringCounts = outputFoo.StringCounts = new NativeLong(0);
                inputFoo.Value1 = outputFoo.Value1 = 0.1;
                inputFoo.Value2 = outputFoo.Value2 = 0.3;

                Double ID =-35547318716283305;
                double value = 0.025;
                impDriveFiltJnaLib.ProfileFilterInterface(new DoubleByReference(ID), input, output, value, null, null, null, null);

                Double[] outDataAlt1 = outputFoo.getDate();
        }
} 
```

## 编辑 2

在我解决了 dll 中的文件错误问题后，异常发生了变化。必须再次复制 dll。这解决了无法加载 dll 的问题。

```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x027047b8, pid=800, tid=7584
#
# JRE version: 7.0_04-b22
# Java VM: Java HotSpot(TM) Client VM (23.0-b21 mixed mode, sharing windows-x86 )
# Problematic frame:
# C  [FooDll.dll+0x47b8]  FooInterface+0x2288
#
# Failed to write core dump. Minidumps are not enabled by default on client versions of Windows
#
# An error report file with more information is saved as:
# E:\Programme\apache-tomcat-7.0.27\bin\hs_err_pid800.log
#
# If you would like to submit a bug report, please visit:
#   http://bugreport.sun.com/bugreport/crash.jsp
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
# 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:05:25.813

我有两个建议：-

1.  您应该尝试使用 jnaerator 为给定的 c/c++ 标头生成 java 代码。（这将是一个很好的开始）。

2.  根据环境，您的本机 double/float 大小将不同于 Java double/float。即本机双精度可能等于Java 浮点数。所以你也需要检查一下。

因此，您需要使用不同的结构组合对自己进行一些分析，以获得原生想要的东西。如果你不通过exact，那么它将导致崩溃。

也请发布您的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:53:10.113

为什么您的结构不使用对齐方式？这是您崩溃的最可能原因。验证 Java 中的字段偏移量（Structure.toString() 会告诉您）与本机代码中的字段偏移量相同。

`PointerByReference`旨在传递给被调用者将指针的值写入调用者传递的地址的函数。虽然您的用法在技术上是正确的，但它实际上混淆了您的实际意图。

如果您的结构包含*任何*类型的指针，您应该从 的类型映射开始`Pointer`，然后根据需要调整类型映射。 `PointerByReference`永远*不*适合作为结构字段。

```
 public static class TNativeFoo extends com.sun.jna.Structure {

       public TNativeFoo (){ }
       public TNativeFoo(com.sun.jna.Pointer pointer, int offset) {
            super(pointer.share(offset));
            read();
        }
        public TNativeFoo(TNativeFoo struct) {
            super(struct.getPointer());
            read();
        }
        // NOTE: use Java conventions for field names, please
        private Pointer buffer;
        public Pointer data = new Memory(Pointer.SIZE);
        public NativeLong items;
        public Pointer irrelevantStringArray = new Memory(Pointer.SIZE);
        public NativeLong stringsCounts = new NativeLong(0);

        public double[] getData() { 
            Pointer p = data.getPointer(0);
            if (p == null) return null;
            return p.getDoubleArray(items.intValue());  
        }
        public void setData(double[] data) {
            Pointer p = this.data.getPointer(0);
            if (p == null) {
               p = buffer = new Memory(data.length * 8);    
               this.data.setPointer(0, buffer);
            }
            p.write(0, data, 0, data.length);
        }
    }

    NativeLong FooInterface(TNativeFoo input, TNativeFoo output);
} 
```

请注意， Double.SIZE 是双精度位的大小，而不是字节，因此您分配的大小是实际需要的大小的 8 倍。

# ios - UIViewAnimationTransitionFlipFromRight - 替代显示卡片？

> ID：10688121
> 
> 赞同：0
> 
> 时间：2012-05-21T15:26:58.840
> 
> 标签：ios, scroll, playing-cards

在屏幕上显示单张扑克牌的最佳方法是什么...

当用户刷卡时，现有卡片会滚动关闭，同时新卡片会滚动？

UIScrollView 是最好的选择吗，我也许可以将所有扑克牌放在一张恶作剧表中？

现在我的扑克牌由 52 个独立的 png 加上后部.png 组成

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:30:56.337

看看[iCarousel](https://github.com/nicklockwood/iCarousel)！！它支持多种不同类型的滚动模式，也非常流畅。

# ruby-on-rails - 查询当前可用场地

> ID：10688122
> 
> 赞同：0
> 
> 时间：2012-05-21T15:27:05.480
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一系列场地，这些场地 has_many OpenTimes 来判断场地当前是否在一周的这个时间开放。我想查询所有当前开放的场所。

我目前有一个`venue.rb`称为“def active”的方法，它通过 open_times 并检查是否`Time.now`在 open_time 的 :start 和 :end 字段的范围内。

如何创建提供所有当前开放场所的查询？

我希望创建一个类似于`Venue.all.currently_available`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:08:35.230

尝试这个：

```
# in Venue class
def available?
  open_times.where(':now BETWEEN open_times.start AND open_times.end', now: Time.now).exists?
end 
```

**UPD：**要查询所有开放的场地，请使用：

```
def self.currently_available
  joins(:open_times).
  where(':now BETWEEN open_times.start AND open_times.end', now: Time.now).
  uniq
end 
```

称呼：`Venue.currently_available`

# r - 中文谷歌搜索结果编码

> ID：10688126
> 
> 赞同：1
> 
> 时间：2012-05-21T15:27:34.593
> 
> 标签：r, encoding, character-encoding, google-search, rcurl

全部

我一直在研究用于谷歌搜索数据挖掘的**R**程序。
到目前为止，我的代码运行良好，除了繁体中文编码问题。我在linux环境下工作...

```
Google <- function(input)
  {
   require(XML)
   require(stringr)
   require(RCurl)
   hits <- GoogleHits(input)
   if( hits >= 1000){
      start.num = seq(0,900,100) 
  }else if(hits < 1000){
      start.num = seq(0,hits,100) 
  }
  for(i in 1:length(start.num)){
       start = start.num[i] 
       url <-paste("https://www.google.com/search?as_epq=",input,
       "&as_occt=title&num=100&ie=UTF-8&start=",start, sep = "")   

   CAINFO = paste(system.file(package="RCurl"), "/CurlSSL/ca-bundle.crt", sep = "")
   script <- getURL(url, followlocation = TRUE, cainfo = CAINFO)

   # using htmlParse() to re-organize the whole structure
   # the Chinese encoding shows quite well here 
   # (but the structure is not a vector)     
   doc <- htmlParse(script)

   # Wanna extract out the searched keyword
   # which is tagged by "<b>keyword</b>"
   # here, I take the keyword "統計" for example
   extract <- str_extract_all(html_str, "<b>統計</b>")

   # here is the problem... which extract only takes a vector as an argument
   # so below will return an error
   print (extract)

}
  } 
```

因此，我遇到的问题都包含在评论中。

1) 如果不使用**htmlParse()**，提取的数据无法呈现为可识别的汉字

2）如果我尝试将数据转换为向量（通过应用**script <- lapply(url, getURL)**），虽然可以使用**str_extract_all()**方法，但出现编码问题......

另外，这里的中文我指的是**繁体中文**

任何意见或建议都非常感谢！
提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T13:19:59.687

我发现了错误！我！
所以我是来回答这个问题的。

问题是给定**url 链接**中的参数！

由于中文的编码是UTF-8，
所以有两个参数是必然需要的，
**oe=UTF-8&ie=UTF-8**！！
（在谷歌的开发者网站上，
它说**oe=UTF-8**不需要指定，
这就是我跳过这部分的原因......）

# c++ - 在 C++ 中实现复数幂函数？

> ID：10688134
> 
> 赞同：2
> 
> 时间：2012-05-21T15:28:04.407
> 
> 标签：c++, class, operator-overloading

就像标题所说的那样，我正在尝试实现一个运算符^(int n)，它将计算一个复数的 n 次方。我知道这`this`是一个指向当前类对象的指针，所以我想出了这段代码：

```
 class Complex{
    protected:
      float a,b;
    public:
      Complex() {a=0;b=0;}
      Complex(float x, float y){a=x;b=y;}
      void set(float x, float y){a=x;b=y;}
      Complex operator*(Complex C){
                Complex temp;
                temp.a=a*C.a-b*C.b;
                temp.b=a*C.b+b*C.a;
                return temp;
      }
      Complex operator^(int n){
                Complex ONE=Complex(1,0);
                if (n<=0) return ONE;
                return ((*this)*((*this)^(n-1)));
      }
      void Display(){
                cout<<a<<' '<<b<<endl;
      }
      };
      int main() {
          Complex C;
          C.set(2,0);
          C=C^3;
          C.Display();
      } 
```

C.Display() 应该打印`8 0`，但是当我在 eclipse 中运行时它显示`2 0`。请告诉我为什么会这样。如果有人能告诉我如何`ONE`在第 15 行创建一个常量类对象，如 Java 中的 BigInteger.ONE，我也非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:35:32.357

你知道有一个[std::complex](http://en.cppreference.com/w/cpp/numeric/complex)模板类型，它有自己的[std::pow 特](http://en.cppreference.com/w/cpp/numeric/complex/pow)化吗？

```
#include <complex>
#include <iostream>

int main() {

  std::complex<double> c(2,0);
  std::complex<double> c3 = pow(c, 3);
  std::cout << c3 << "\n";
} 
```

生产

> (8,0)

此外，`operator^`是按位异或。重用它作为幂运算符将导致非常混乱的代码。

除此之外，您的代码会产生您期望的结果，因此问题一定出在其他地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:43:23.320

> 如果有人能告诉我如何在第 15 行使 ONE 成为像 Java 中的 BigInteger.ONE 这样的常量类对象，我也非常感谢。

把它放在你的复杂声明中：

```
class Complex {
   ...
   const static Complex ONE;
}; 
```

并且，将其放在您的复杂声明之外：

```
const Complex Complex::ONE(1,0); 
```

如果您将您的 Complex 声明放在一个头文件（例如 Complex.hpp）中，您应该将第二行（Complex::ONE 定义）*恰好放在一个*源代码文件（例如 Complex.cpp）中。

# monodevelop - 编辑布局文件时出错

> ID：10688135
> 
> 赞同：1
> 
> 时间：2012-05-21T15:28:05.593
> 
> 标签：monodevelop, xamarin.android

自从更新到 MonoDevelop 3.0.1 版后，我一直无法使用布局文件。当我创建一个新的布局文件，然后尝试从“源”选项卡中对其进行编辑时，我收到以下错误：

```
System.InvalidOperationException: Layout not yet loaded
at Xamarin.AndroidDesigner.DesignerSession.SetLayoutXml (System.String xml, Boolean allowUndo) [0x000bf] in /Users/builder/data/lanes/monodevelop-mac-3.0.1/6642975f/source/md-addins/MonoDevelop.MonoDroid/Xamarin.AndroidDesigner/Xamarin.AndroidDesigner/DesignerSession.cs:353 
at MonoDevelop.MonoDroid.Gui.LayoutSourceEditorView.SaveContent () [0x00025] in /Users/builder/data/lanes/monodevelop-mac-3.0.1/6642975f/source/md-addins/MonoDevelop.MonoDroid/MonoDevelop.MonoDroid/Gui/AndroidDesignerView.cs:641 
at MonoDevelop.MonoDroid.Gui.LayoutSourceEditorView.Deselected () [0x00000] in /Users/builder/data/lanes/monodevelop-mac-3.0.1/6642975f/source/md-addins/MonoDevelop.MonoDroid/MonoDevelop.MonoDroid/Gui/AndroidDesignerView.cs:670 
at MonoDevelop.Ide.Gui.SdiWorkspaceWindow.SetCurrentView (Int32 newIndex) [0x00032] in /Users/builder/data/lanes/monodevelop-mac-3.0.1/6642975f/source/monodevelop/main/src/core/MonoDevelop.Ide/MonoDevelop.Ide.Gui/SdiWorkspaceWindow.cs:571 
at MonoDevelop.Ide.Gui.SdiWorkspaceWindow+<AddButton>c__AnonStoreyB0.<>m__169 (System.Object sender, System.EventArgs e) [0x00033] in /Users/builder/data/lanes/monodevelop-mac-3.0.1/6642975f/source/monodevelop/main/src/core/MonoDevelop.Ide/MonoDevelop.Ide.Gui/SdiWorkspaceWindow.cs:488 
at MonoDevelop.Components.Tab.OnActivated (System.EventArgs e) [0x0000d] in /Users/builder/data/lanes/monodevelop-mac-3.0.1/6642975f/source/monodevelop/main/src/core/MonoDevelop.Ide/MonoDevelop.Components/Tabstrip.cs:396 
at MonoDevelop.Components.Tab.Activate () [0x00000] in /Users/builder/data/lanes/monodevelop-mac-3.0.1/6642975f/source/monodevelop/main/src/core/MonoDevelop.Ide/MonoDevelop.Components/Tabstrip.cs:244 
at MonoDevelop.Ide.Gui.SdiWorkspaceWindow.ActiveDocumentChanged (System.Object sender, System.EventArgs e) [0x0000b] in /Users/builder/data/lanes/monodevelop-mac-3.0.1/6642975f/source/monodevelop/main/src/core/MonoDevelop.Ide/MonoDevelop.Ide.Gui/SdiWorkspaceWindow.cs:501 
at (wrapper delegate-invoke) <Module>:invoke_void__this___object_EventArgs (object,System.EventArgs)
at (wrapper delegate-invoke) <Module>:invoke_void__this___object_EventArgs (object,System.EventArgs)
at (wrapper delegate-invoke) <Module>:invoke_void__this___object_EventArgs (object,System.EventArgs)
at (wrapper delegate-invoke) <Module>:invoke_void__this___object_EventArgs (object,System.EventArgs)
at (wrapper delegate-invoke) <Module>:invoke_void__this___object_EventArgs (object,System.EventArgs)
at (wrapper delegate-invoke) <Module>:invoke_void__this___object_EventArgs (object,System.EventArgs)
at (wrapper delegate-invoke) <Module>:invoke_void__this___object_EventArgs (object,System.EventArgs)
at MonoDevelop.Ide.Gui.Workbench.OnDocumentChanged (System.Object s, System.EventArgs a) [0x0000b] in /Users/builder/data/lanes/monodevelop-mac-3.0.1/6642975f/source/monodevelop/main/src/core/MonoDevelop.Ide/MonoDevelop.Ide.Gui/Workbench.cs:606 
at MonoDevelop.Ide.Gui.DefaultWorkbench.OnActiveWindowChanged (System.Object sender, System.EventArgs e) [0x00075] in /Users/builder/data/lanes/monodevelop-mac-3.0.1/6642975f/source/monodevelop/main/src/core/MonoDevelop.Ide/MonoDevelop.Ide.Gui/DefaultWorkbench.cs:749
at Gtk.Notebook.SwitchPageSignalCallback (IntPtr arg0, IntPtr arg1, UInt32 arg2, IntPtr gch) [0x00000] in <filename unknown>:0 
```

我还没有发现表明其他人正在经历这种情况的错误。这可能是我的环境中的某种配置问题吗？我正在为 Android 4.2.1.196198126 使用 Mono。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:18:20.013

此问题已在 MonoDevelop 3.0.2 版中得到解决。 [http://monodevelop.com/Download/Release_Notes/Release_Notes_for_MonoDevelop_3.0.2](http://monodevelop.com/Download/Release_Notes/Release_Notes_for_MonoDevelop_3.0.2)

# r - 如何修复 data.frame 列名中的空格（删除空格，注入点）？

> ID：10688137
> 
> 赞同：65
> 
> 时间：2012-05-21T15:28:14.060
> 
> 标签：r, dataframe

导入文件后，我总是尝试从列名中删除空格，以便更轻松地引用列名。

除了使用转换然后删除此命令创建的额外列之外，还有更好的方法吗？

这是我现在使用的：

```
names(ctm2)
#tranform function does this, but requires some action
ctm2<-transform(ctm2,dymmyvar=1)
#remove dummy column
ctm2$dymmyvar <- NULL
names(ctm2) 
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2014-08-06T06:26:17.637

为此目的，存在更优雅和通用的解决方案：

```
tidy.name.vector <- make.names(name.vector, unique=TRUE) 
```

`make.names()`从字符向量中生成语法上有效的名称。语法上有效的名称由字母、数字和点或下划线字符组成，并以字母或点开头，后跟数字。

此外，标志`unique=TRUE`允许您避免在新列名中可能出现的重复。

作为代码来实现

```
d<-read_delim(urltxt,delim='\t',)
names(d)<-make.names(names(d),unique = TRUE) 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2018-11-30T14:37:09.933

有一个非常有用的包，称为`janitor`它使清理列名非常简单。它删除所有唯一字符并将空格替换为`_`.

```
library(janitor)

#can be done by simply
ctm2 <- clean_names(ctm2)

#or piping through `dplyr`
ctm2 <- ctm2 %>%
        clean_names() 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2012-05-21T15:34:21.243

要仅替换每列中的第一个空格，您还可以执行以下操作：

```
names(ctm2) <- sub(" ", ".", names(ctm2)) 
```

或替换所有空格（这似乎更有用）：

```
names(ctm2) <- gsub(" ", "_", names(ctm2)) 
```

或者，如第一个答案中所述（尽管不是以修复所有空格的方式）：

```
spaceless <- function(x) {colnames(x) <- gsub(" ", "_", colnames(x));x}
newDF <- spaceless(ctm2) 
```

其中 x 是您的 data.frame 的名称。我更喜欢使用“_”来避免“。”的问题。作为 ID 的一部分。

关键是 gsub 不会在模式匹配的第一个实例处停止。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-08-15T19:39:18.580

像这样分配名称。这效果最好。它将名称中的所有空格替换为下划线。

`names(ctm2)<-gsub("\\s","_",names(ctm2))`

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-07-02T15:55:32.760

到目前为止我发现的最佳解决方案是

```
names(ctm2) %<>% stringr::str_replace_all("\\s","_") %>% tolower 
```

归功于评论者和其他答案

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2018-07-04T11:39:51.237

`dplyr::select_all()`可用于重新格式化列名。此示例用下划线替换空格和句点并将所有内容转换为小写：

```
iris %>%  
  select_all(~gsub("\\s+|\\.", "_", .)) %>% 
  select_all(tolower) %>% 
  head(2)
  sepal_length sepal_width petal_length petal_width species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-08-15T19:51:34.657

或者，您可以使用该`stringr`软件包获得相同的结果。

`names(ctm2) <- names(ctm2) %>% stringr::str_replace_all("\\s","_")`

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2021-01-15T14:41:56.760

截至 2021 年 1 月：简洁且不使用额外库的 drplyr 解决方案是

```
df %<>% dplyr::rename_all(make.names) 
```

信用归评论者所有。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2020-01-20T21:30:40.057

在一段`dplyr`代码中更改列的名称通常比在创建数据框后重命名列更方便。管道在`rename_all()`这些情况下非常有用：

```
ctm2 %>% rename_all(function(x) gsub(" ", "_", x)) 
```

上面的代码将用下划线替换每个列名中的所有空格。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-09-02T10:46:48.993

有一种简单的方法可以删除 data.table 中列名中的空格。您必须将数据框转换为数据表。

```
setnames(x=DT, old=names(DT), new=gsub(" ","",names(DT))) 
```

`Country Code`将转换为`CountryCode`

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-05-21T15:30:32.873

只需分配给`names(ctm2)`：

```
 names(ctm2) <- c("itsy", "bitsy", "eeny", "meeny") 
```

或以数据驱动的方式：

```
 names(ctm2) <- paste("myColumn", 1:ncol(ctm2), sep="") 
```

另一种可能性是编辑您的源文件...

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-05-02T12:31:25.183

您还可以在 R 中使用 make 名称和 gsub 函数的组合。

```
names(ctm2)<- gsub("\\.","_", make.names(names(ctm2), unique = T)) 
```

上面的代码一次会做两件事：

1.  它将为所有列创建唯一的名称 - 例如，相同的名称将被转换为唯一的，例如 c("ab","ab") 将被转换为 c("ab","ab2")
2.  它将用下划线替换点。当您尝试选择具有下划线的列名而不是带有点的列名时，它变得容易（只需双击名称）。选择带点的列名非常困难。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2020-03-12T00:21:26.567

如果您使用 read.csv() 导入数据（将所有空格“”替换为“.”），则可以使用下划线“_”替换这些数据：

```
names(df) <- gsub("\\.", "_", names(df)) 
```

# maven - 为什么要为 Jenkins 使用 SonarQube 插件，而不是简单地使用 maven 目标声纳：声纳？

> ID：10688139
> 
> 赞同：22
> 
> 时间：2012-05-21T15:28:28.367
> 
> 标签：maven, hudson, jenkins, sonarqube

我想使用 Jenkins 为 Maven 2 项目启动 SonarQube 分析。我首先`sonar:sonar`在构建配置中使用了目标。

但我刚刚找到了 Jenkins 的 SonarQube 插件。为什么要使用它？这是一个更好的做法，为什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-21T15:45:12.790

你当然可以做一个简单的`mvn sonar:sonar`，这将工作。

另一方面，Jenkins 的 SonarQube 插件将使配置更容易。例如，您将能够在一个地方（Jenkins 的配置部分）定义有关您的 SonarQube 服务器（URL、数据库用户和密码）或多个 SonarQube 服务器的信息，这样您就不必到处重复了。

该插件还提供动态运行 SonarQube 分析的能力（无需 Maven）：您只需提供一些强制性属性（例如） `sonar.projectKey`，`sonar.projectVersion`插件将为您透明地启动 Java Standalone Runner（这很有帮助对于不依赖 Maven 构建的 Java 以外的其他语言）。

所以如果你只是做一些测试，你真的不需要这个插件。但是，如果您要设置 Jenkins 的生产实例，那么最好使用 SonarQube 插件。

# wpf - 将文本框文本绑定到图像 canvas.leftProperty

> ID：10688141
> 
> 赞同：0
> 
> 时间：2012-05-21T15:28:42.193
> 
> 标签：wpf, xaml, data-binding

如何将文本框的文本绑定到代码和 XAML 中图像的 Canvas.GetLeft() 属性的值？

文本框1画布1图像1

```
<TextBox Name="textBox1" Width="100" Text="{Binding ElementName=image1, Path=Canvas.LeftProperty}"></TextBox> 
```

不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T15:30:05.080

这是一个[附加属性](http://msdn.microsoft.com/en-us/library/ms749011.aspx)，您需要括号，并且您使用正确的 DP 名称，而不是字段：

```
Path=(Canvas.Left) 
```

[（在 MSDN](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.path.aspx)上阅读这样的语法细节）

# c++ - Debug 和 Release 版本之间可能出现的差异？

> ID：10688145
> 
> 赞同：4
> 
> 时间：2012-05-21T15:29:00.440
> 
> 标签：c++

我今天在一次采访中被要求列出调试和发布版本之间*可能出现的四个差异。*我想它们是指行为上的差异，而不是诸如调试信息之类的差异。我只能说出两个：

1.  由于某些函数未内联，调试构建通常要慢得多。
2.  由于速度差异，在具有竞争条件的多线程程序中，这些竞争条件可能仅在两个构建中的一个中变得明显。

我还能说出哪些其他差异？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T15:34:24.237

以下是一些差异的摘要：http: [//msdn.microsoft.com/en-us/library/aa236698%28v=vs.60%29.aspx](http://msdn.microsoft.com/en-us/library/aa236698%28v=vs.60%29.aspx)。这包括：

*   堆布局（使用调试内存分配器）
*   宏（包括断言语句，以及“#ifndef NDEBUG”中包含的任何内容，在某些情况下可能会有很大的不同——例如，我知道一些 boost 库在调试模式下编译时会向结构添加额外的字段，这可以是用于执行完整性检查）
*   优化（主要在调试版本中禁用）
*   初始化和错误指针：未初始化的变量在您分配给它们之前具有未定义的状态；但在调试版本中，它们通常会被初始化为某个已知状态（例如全零或全 #CCCCCCC 等）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T15:40:54.530

除了你的两个答案，这里还有四个：

1.  [_DEBUG 与 NDEBUG](https://stackoverflow.com/questions/2290509/debug-vs-ndebug)
2.  链接器在调试和发布期间使用不同的库
3.  调试版本还生成用于调试的符号
4.  代码最终可能会被优化掉，因此，在某些情况下，您可能会在发布期间对某些构造函数的调用较少，这可能会导致一些令人讨厌的错误。这是一个例子：

> ```
> Object x(3);
> Object y;
> y = x; 
> ```

相对：

> ```
> Object x(3);
> Object y = x; 
> ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T15:35:17.957

另一点是许多库在调试时启用了额外的检查。具有讽刺意味的是，这可能意味着代码在调试构建中有效，但在发布构建中无效：

想象一个分配函数，由于性能原因，它在调试版本中清零内存，但在发布版本中不清零。如果随后读取此变量的值而不进行初始化，则调试版本会看到明确定义的（零）值，而发布版本可以看到任何值。

相反，调试构建检查当然可以捕获未定义的行为，例如通过检查访问是否`[]`在定义的范围内。

# android - 发送 HttpPost 请求时出现 SocketTimeOutException

> ID：10688148
> 
> 赞同：2
> 
> 时间：2012-05-21T15:29:11.533
> 
> 标签：android, http, request, apache-httpclient-4.x

我的应用程序与 Facebook 一起使用，并使用 JSON 参数发布请求。请求发送了约 7-8 分钟，然后我捕获了 SocketTimeOutException。10 分钟后，我可以再次发送请求。

这是代码：

```
public static String httpTPRequest(String url, String params) {
    String response = Static.EMPTY;
    HttpPost httpPost = new HttpPost(url);
    httpPost.addHeader("Content-Type", "application/json");
    HttpParams httpParams = new BasicHttpParams();
    DefaultHttpClient httpClient = new DefaultHttpClient(httpParams);
    HttpConnectionParams.setConnectionTimeout(httpParams, HTTP_TIMEOUT);
    HttpConnectionParams.setSoTimeout(httpParams, HTTP_TIMEOUT);

    try {
        httpPost.setEntity(new StringEntity(params, "UTF-8"));
        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity entity = httpResponse.getEntity();
        if (entity != null) {
            response = EntityUtils.toString(entity);
        }
    } catch (Exception e) {
        Debug.log(TAG, "tp server request:" + e.getMessage());
    }

    return response;
} 
```

为什么会发生？

堆栈跟踪

```
SocketTimeoutException:Http::Socket stack:org.apache.harmony.luni.platform.OSNetworkSystem.connectStreamWithTimeoutSocketImpl(Native Method)
Http::Socket stack: org.apache.harmony.luni.platform.OSNetworkSystem.connectStreamWithTimeoutSocket(OSNetworkSystem.java:131)
Http::Socket stack: org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:247)
Http::Socket stack: org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:535)
Http::Socket stack: java.net.Socket.connect(Socket.java:1054)
Http::Socket stack: org.apache.http.conn.scheme.PlainSocketFactory.connectSocket(PlainSocketFactory.java:117)
Http::Socket stack: org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:129)
Http::Socket stack: org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
Http::Socket stack: org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
Http::Socket stack: org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:348)
Http::Socket stack: org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
Http::Socket stack: org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
Http::Socket stack: org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
Http::Socket stack: com.saymeow.saymeow.utils.Http.httpTPRequest(Http.java:194)
Http::Socket stack: java.lang.Thread.run(Thread.java:1096)
Http::Socket stack: com.saymeow.saymeow.requests.ApiRequest$1.run(ApiRequest.java:83)
Http::SocketTimeoutException: Socket is not connected 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-21T16:07:22.683

如果 params 是 JSON 字符串，您可能需要替换：

```
httpPost.setEntity(new StringEntity(params,"UTF-8")); 
```

和

```
httpPost.setEntity(new ByteArrayEntity(params.getBytes("UTF8"))); 
```

# python - 使用 zip() 旋转列表

> ID：10688159
> 
> 赞同：4
> 
> 时间：2012-05-21T15:30:02.430
> 
> 标签：python, list

我有一组从数据库返回的记录，格式如下：

```
data = [
    ["date", "value1a", "value2a", "value3a", ...],
    ["date", "value1b", "value2b", "value3b", ...]
] 
```

我想把那组行变成一个列表，比如

```
[
    [("date", "value1a"), ("date", "value1b"), ... ],
    [("date", "value2a"), ("date", "value2b"), ... ]
] 
```

我知道`zip()`会做这种事情，但我不清楚如何将日期输入每条记录（并使它们成为元组）。从数据库返回的行的长度并不总是相同的，但我会知道每次调用的预期长度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T19:18:49.220

```
data = [["date_a", "1a", "2a", "3a"], 
        ["date_b", "1b", "2b", "3b"]]

print zip(*(zip(itertools.repeat(ls[0]), ls[1:]) for ls in data)) 
```

给

```
[(('date_a', '1a'), ('date_b', '1b')),
 (('date_a', '2a'), ('date_b', '2b')),
 (('date_a', '3a'), ('date_b', '3b'))] 
```

有关一些有用的变化，请参阅注释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T16:15:19.313

编辑：这是基于原始问题，假设数据将位于单个列表中，而不是多个输入列表中。对问题的编辑清楚地表明情况并非如此，因此我建议您遵循[Janne Karila 的解决方案](https://stackoverflow.com/a/10691255/722121)。

假设您知道有多少不同的值，这是一个很好的解决方案，使用`itertools`' [`grouper()`recipe](http://docs.python.org/library/itertools.html#recipes)：

```
import itertools

def grouper(n, iterable, fillvalue=None):
     args = [iter(iterable)] * n
     return itertools.zip_longest(fillvalue=fillvalue, *args)

data = ["date", "1a", "2a", "3a", "1b", "2b", "3b", "1c", "2c", "3c"]
first = data.pop(0)
print([list(zip(itertools.repeat(first), items)) for items in zip(*grouper(3, data))]) 
```

给我们：

```
[
    [('date', '1a'), ('date', '1b'), ('date', '1c')], 
    [('date', '2a'), ('date', '2b'), ('date', '2c')], 
    [('date', '3a'), ('date', '3b'), ('date', '3c')]
] 
```

请注意，`None`如果没有足够的值，这将用 s 填充列表。

当然，如果只想循环遍历它，例如不显示它，您可以使用[生成器推导而不是列表推导。](https://www.youtube.com/watch?v=t85uBptTDYY)例如：

```
(zip(itertools.repeat(first), items) for items in zip(*grouper(3, data))) 
```

请注意，我使用的是 Python 3.x，所以在 2.x 下，无论我在哪里使用`zip()`你可能想要`itertools.izip()`的，并且`itertools.zip_longest()`变成`itertools.izip_longest()`.

请注意，这样做的更好方法 - 假设您知道什么*定义*了应该在第一个列表中的值，应该在第二个列表中的值，等等......

```
import itertools
import operator

data = ["date", "1a", "2a", "3a", "1b", "2b", "3b", "1c", "2c", "3c"]
first = data.pop(0)

print([list(zip(itertools.repeat(first), items)) for _, items in itertools.groupby(sorted(data), operator.itemgetter(0))]) 
```

产生：

```
[
    [('date', '1a'), ('date', '1b'), ('date', '1c')], 
    [('date', '2a'), ('date', '2b'), ('date', '2c')], 
    [('date', '3a'), ('date', '3b'), ('date', '3c')]
] 
```

自然，这仅适用于给定的示例，假设您的真实数据不同，您将需要更改`operator.itemgetter(0)`为定义您的项目应分组到哪个列表的函数。

请注意，我们可能值得封装我们的前缀工作：

```
def prefix(iterable, prefix):
    """Returns every element of an iterable prefixed with a given value."""
    #prefix("ABCDEFG", "x") --> ("x", "A"), ("x", "B"), ("x", "C"), ("x", "D"), ...
    return zip(itertools.repeat(prefix), iterable) 
```

然后我们有简单的：

```
(prefix(items, first) for items in zip(*grouper(3, data))) 
```

和

```
(prefix(items, first) for _, items in itertools.groupby(sorted(data), operator.itemgetter(0))) 
```

哪个更具可读性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T15:31:34.503

对第一个元素使用 itertools 重复：

```
zip(itertools.repeat(ls[0]), ls[1:]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-25T07:32:06.227

这也可以通过简单的列表理解技术来实现

```
data = [    ["date1", "value1a1", "value2a1", "value3a1"],
            ["date2", "value1b2", "value2b2", "value3b2"]
       ]
result = map(list, zip(*[[(x[0], x[i]) for x in data] for i in range(1,len(x))]))

[
  [('date1', 'value1a1'), ('date1', 'value2a1'), ('date1', 'value3a1')],
  [('date2', 'value1b2'), ('date2', 'value2b2'), ('date2', 'value3b2')]
] 
```

# java - 如何执行分面搜索？

> ID：10688160
> 
> 赞同：6
> 
> 时间：2012-05-21T15:30:02.720
> 
> 标签：java, lucene, information-retrieval, faceted-search

我想知道如何使用 lucene.facet 执行分面搜索。我将准确地解释我想要做什么：我有一个 htmlfiles 分类（类似于 ODP），我希望给定一个查询，按类别和每个类别的命中数显示结果。有没有用 lucene 描述的例子？

**编辑：**通过在每个文档中添加一个类别字段，我已经获得了类别的结果。我想要的是结果显示为：

```
Cat1 N1
Cat2 N2
  ... 
```

代替：

```
Cat1
Cat1
...    xN1 times
Cat1
Cat2
...    xN2 times
Cat2
... 
```

此外，此类别字段仅指分类树的级别，我想通过例如能够选择分类中的搜索深度来利用分类结构（我不知道这是否清楚。 .)。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T09:07:24.937

由于 solr 和 lucene 自 3.0 起就合并在一起了，我强烈建议使用 solr 而不是普通的 lucene 来进行分面搜索。

您不必将整个 solr 与 http 服务器一起使用。

试试[EmbeddedSolrServer](http://wiki.apache.org/solr/Solrj#EmbeddedSolrServer)

# c# - 使用服务帐户获取 Windows 服务列表

> ID：10688161
> 
> 赞同：0
> 
> 时间：2012-05-21T15:30:03.100
> 
> 标签：c#, .net, windows-services

我尝试获取所有 Windows 服务 + 服务帐户的列表

例如：

```
servicexyz.exe;Local Service
servicezyx.exe;ADUser123 
```

我已经尝试过 ServiceController 但找不到获取服务帐户的方法或属性...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:38:40.827

用于`System.Management`通过本机 WMI 获取此信息 - 使用`Win32_Service`我在上面引用的“可能重复”中演示的类。

这种技术可用于许多系统级信息，这些信息表面上看起来在 .Net Framework 中不可用。

# .net - VS2005+ 中托管 C++ 包装器 DLL 中的并排错误

> ID：10688164
> 
> 赞同：3
> 
> 时间：2012-05-21T15:30:10.363
> 
> 标签：.net, visual-studio-2005, winsxs

我有一个带有 .NET 包装器的本机 C++ 库，全部内置于 Visual Studio 2003 和 2005 中。我们最近将 .NET 包装器库移植到 VS2005，但它不起作用。.NET 包装库是混合模式的，具有本地 C++ 和托管扩展类，以及一些本地程序集。在所有情况下都假设一个发布二进制文件。

VS2003 .NET dll 完美运行，没有任何抱怨，但到目前为止我无法使用 VS2005。我在本机库上构建了其他本机应用程序，因此问题似乎受限于链接器设置和围绕 .NET 库的动态链接规则。

.net 库正在使用 C++ 的托管扩展 (/clr:oldSyntax)，因此某些选项在属性表中受到限制。

我原来的问题是运行时错误 R6034: `An application has made an attempt to load the C runtime library incorrectly`。通过在程序集中包含嵌入式清单已解决此问题。异常跟踪如下：

```
Unhandled Exception: System.IO.FileLoadException: A dynamic link library (DLL) initialization routine failed. (Exception from HRESULT: 0x8007045A)
   at Corp.Blah.BlahConsole.Program.Main(String[] args) 
```

在程序集中嵌入清单后，我收到一个新错误。问题标题中的并排错误来自 Dependency Walker。全文：

```
Error: The Side-by-Side configuration information for "s:\release\MDM3NET80.DLL" contains errors. This application has failed to start because the application configuration is incorrect. Reinstalling the application may fix this problem (14001).
Warning: At least one delay-load dependency module was not found.
Warning: At least one module has an unresolved import due to a missing export function in a delay-load dependent module. 
```

据我所知，与 Kernel32.dll 部分相关的延迟加载警告在不同版本的 Windows 中已发生变化，但与我的应用程序无关，尤其是 MPR.DLL、IESHIMS.DLL 和 WER.DLL。这些警告似乎并不重要。

尝试使用小型控制台应用程序加载 .NET dll 会产生`System.IO.FileLoadException`：

```
Unhandled Exception: System.IO.FileLoadException: Could not load file or assembly 'BLAH, Version=5.0.0.22, Culture=neutral, PublicKeyToken=ffbc9a05441709bc' or one of its dependencies. This application has failed to start because the application configuration is incorrect. Reinstalling the application may fix this problem. (Exception from HRESULT: 0x800736B1)
File name: 'BLAH, Version=5.0.0.22, Culture=neutral, PublicKeyToken=ffbc9a05441709bc' ---> System.Runtime.InteropServices.COMException (0x800736B1): This application has failed to start because the application configuration is incorrect. Reinstalling the application may fix this problem. (Exception from HRESULT: 0x800736B1)
   at Corp.Blah.BlahConsole.Program.Main(String[] args) 
```

此错误发生在开发机器以及其他机器上，因此我不希望 Visual Studio 尝试使用错误版本的 MSCRT dll。

我从构建的 DLL 中提取了以下程序集：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
  <assemblyIdentity name="Corp.Blah.BlahNet">
  </assemblyIdentity>
  <dependency>
    <dependentAssembly>
      <assemblyIdentity type="win32" name="Microsoft.VC80.CRT" version="8.0.50727.762" processorArchitecture="x86" publicKeyToken="1fc8b3b9a1e18e3b">
      </assemblyIdentity>
    </dependentAssembly>
  </dependency>
</assembly> 
```

指示的 CRT dll 可以在 WINSxS 目录下找到`x86_Microsoft.VC80.CRT_1fc8b3b9a1e18e3b_8.0.50727.762_x-ww_6b128700`，以及许多其他版本。据我所知，这意味着库的正确版本应该按照[此链接的建议在运行时链接](http://buffered.io/posts/resolving-side-by-side-configuration-issues)。

我尝试了各种摆弄链接器和清单设置的方法，包括以下内容：

*   使用和不使用嵌入式清单进行构建。添加清单可修复 R6034 错误，但会出现 FileLoadException/side-by-side 问题。
*   将 MSCRT dll 放在输出文件夹中并尝试链接到它们，而不是静态链接 .lib 文件。
*   将代码生成运行时库从 /MD 更改为 /MT（/clr:oldSyntax 项目不支持，我仍然需要支持 VS2003，因此无法升级）。
*   属性 -> 链接器 -> 生成清单：是（默认），否 -（相同的结果）
*   尝试将 .NET 包装器移植到 VS2010 并链接到 VS2005 本机二进制文件 - 适用相同的问题和错误消息。

我经历了许多类似的问题和论坛帖子，到目前为止，没有一个提供的解决方案有效。任何人都可以帮忙吗？我对这个有点迷失了。

### 来自事件查看器的附加信息

在系统事件查看器中，错误按来源报告：SideBySide，全文：

> 为 S:\release\BlahNet.dll 生成激活上下文失败。参考错误信息：操作成功完成。

看起来像是 Daily WTF 的候选人。

### 更新：尝试从头开始没有运气

我通过从头开始构建 VS2005 项目文件并导入源进行了另一次尝试。我想当密钥签名系统出现故障时，我可能会做一些事情，如此[处](http://www.conceptualinertia.net/aoakenfo/signing-ccli-assemblies)所述。`FileLoadException`在尝试了建议的密钥签名方法后，我在尝试使用 DLL 时仍然得到相同的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:35:16.373

这些错误的原因被证明是相当不直观的。

.Net DLL 封装的本机库由各种模块组成，每个模块都有自己的 DLL，每个模块都封装了第三方库或提供类似插件的功能。其中一些本机 DLL 是在没有清单的情况下链接的。

虽然 .Net 包装器和插件之间没有直接链接，但缺少清单似乎会导致运行时错误 (R6034)。链接到这些库的本机应用程序没有类似的运行时错误，因此在加载本机 DLL 时，.Net 程序集的程序加载程序的行为必须不同。

告诉链接器包含所有本机库的清单似乎可以解决问题并且不会损坏本机应用程序。

# jetty - 如何阻止jetty runner执行

> ID：10688165
> 
> 赞同：1
> 
> 时间：2012-05-21T15:30:12.180
> 
> 标签：jetty

我正在使用 jettyrunner 来执行我的战争文件。我正在使用命令 java -jar jetty runner ex.war。但是我通过从 java 执行这个命令从我的 java 应用程序运行这个码头服务器。我的问题是它第一次运行良好，但是第二次如果我再次使用相同的代码执行另一个war文件，它执行旧的war。我找到了旧的码头服务器继续运行的原因。我怎么能从java中停止这个服务器以启动码头服务器进行另一场战争。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T12:29:32.927

一种选择应该是：

[http://wiki.eclipse.org/Jetty/Howto/Secure_Termination](http://wiki.eclipse.org/Jetty/Howto/Secure_Termination)

另一个是使用 ShutdownHandler：

[http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/tree/jetty-server/src/main/java/org/eclipse/jetty/server/handler/ShutdownHandler.java](http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/tree/jetty-server/src/main/java/org/eclipse/jetty/server/handler/ShutdownHandler.java)

或者不要像java代码那样直接使用jetty-runner，而只是编写一个小的嵌入式用法：

[http://wiki.eclipse.org/Jetty/Tutorial/Embedding_Jetty](http://wiki.eclipse.org/Jetty/Tutorial/Embedding_Jetty)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-20T13:37:55.057

事实证明，jetty-runner.jar 没有停止使用`stop-port`and运行的现有 jetty 进程的功能`stop-key`。

[我在https://github.com/jetty-project/jetty-documentation/blob/master/src/docbkx/administration/runner/jetty-runner.xml](https://github.com/jetty-project/jetty-documentation/blob/master/src/docbkx/administration/runner/jetty-runner.xml)中找到了答案

> 然后，要从不同的终端停止码头，您需要提供相同的端口和关键信息。为此，您需要本地安装 jetty、`jetty-maven-plugin` `jetty-ant`插件，或编写自定义类

幸运的是，我正在实施 gradle build，因此`jetty-ant`满足了我的需求。

# c# - ReportViewer asp.net 网络表单，销售报告。单击以展开行详细信息。C＃

> ID：10688173
> 
> 赞同：0
> 
> 时间：2012-05-21T15:30:43.137
> 
> 标签：c#, asp.net, reportviewer, webforms

我正在尝试做一个销售报告，列出每个订单旁边有一个小加号图标，一旦单击订单行应该展开以显示订单详细信息。我第一次使用reportviewer 并让它显示基本的订单信息。

我现在想要的是每行在单击以显示订单详细信息时展开。因此，第 1 行可能会列出买家姓名、地址等，点击后您会看到他们购买的商品。

鉴于我对这种报告完全陌生（在使用此报告查看器之前从未听说过 Tablix），是否有一种相对简单的方法来显示这些数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:37:14.400

你检查了[http://www.gotreportviewer.com/](http://www.gotreportviewer.com/)吗？

# visual-studio-2010 - 如何从 send.Message 获取返回值并将返回值作为第二条消息的一部分包含在 MSMQ 中？

> ID：10688174
> 
> 赞同：0
> 
> 时间：2012-05-21T15:30:49.303
> 
> 标签：visual-studio-2010, c#-4.0, windows-server-2008, msmq

我对 MSMQ 4.0 很陌生。我陷入了以下情况；服务 A 获取用户详细信息并返回用户 ID。然后服务 B 使用用户 ID 获取账单详细信息。现在我必须对这些步骤进行排队。我打算使用事务队列。有人可以帮我1）从第一条消息中获取ID并将其包含在第二条消息中。2）如果至少一个步骤失败，我必须回滚（事务队列为我执行）重试或 5 次，如果仍然失败，则将其移动到 VerifyAdminQueue 以供管理员验证。我不喜欢使用死信队列等，

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:53:08.180

使用 MSMQ 队列构建的服务是真正的单向服务。这意味着没有内置的响应概念。有很多方法可以使用 MSMQ 实现请求-响应通信模式，但所有这些方法都需要您自己构建响应并将响应发送回调用者。

使用单向操作，回滚非常简单，实际上 MSMQ 会回滚消息传输中的任何失败步骤。然而，更复杂的操作（例如请求-响应）在 MSMQ 中缺乏任何事务的概念，因此跨多个消息传输步骤的任何回滚都需要您编写补偿代码。

# c# - 如何在 C# 中实现取消共享任务：s

> ID：10688181
> 
> 赞同：6
> 
> 时间：2012-05-21T15:30:59.823
> 
> 标签：c#, multithreading, cancellation

总而言之，这是一个关于在 C# 中取消 Task:s 的复杂案例的设计/最佳实践的问题。如何实现共享任务的取消？

作为一个最小的例子，让我们假设以下内容；我们有一个长期运行的、可合作取消的操作“工作”。它接受一个取消标记作为参数，如果它被取消则抛出。它对某些应用程序状态进行操作并返回一个值。两个 UI 组件独立需要其结果。

在应用程序状态不变的情况下，应缓存 Work 函数的值，如果正在进行一次计算，则新请求不应开始第二次计算，而是开始等待结果。

任何一个 UI 组件都应该能够在不影响其他 UI 组件任务的情况下取消它的任务。

到目前为止你和我在一起吗？

以上可以通过引入一个Task缓存来完成，该缓存将真正的Work任务包装在TaskCompletionSources中，然后将其Task:s返回给UI组件。如果 UI 组件取消它的任务，它只会放弃 TaskCompletionSource 任务，而不是底层任务。这一切都很好。UI 组件创建 CancellationSource 和取消请求是一个正常的自上而下的设计，在底部有合作的 TaskCompletionSource 任务。

现在，到了真正的问题。应用状态发生变化时怎么办？让我们假设让“工作”函数在状态副本上运行是不可行的。

一种解决方案是监听任务缓存（或附近）中的状态变化。如果缓存有底层任务使用的 CancellationToken，即运行 Work 函数的任务，它可以取消它。这可能会触发所有附加的 TaskCompletionSources Task:s 的取消，因此两个 UI 组件都将获得 Canceled 任务。这是某种自下而上的取消。

有没有首选的方法来做到这一点？是否有一种设计模式可以在某处描述它？

可以实现自下而上的取消，但是感觉有点奇怪。UI 任务是使用 CancellationToken 创建的，但由于另一个（内部）CancellationToken 而被取消。此外，由于令牌不相同，因此不能仅在 UI 中忽略 OperationCancelledException - 这将（最终）导致在外部 Task:s 终结器中引发异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:23:37.093

这是我的尝试：

```
// the Task for the current application state
Task<Result> _task;
// a CancellationTokenSource for the current application state
CancellationTokenSource _cts;

// called when the application state changes
void OnStateChange()
{
    // cancel the Task for the old application state
    if (_cts != null)
    {
        _cts.Cancel();
    }

    // new CancellationTokenSource for the new application state
    _cts = new CancellationTokenSource();
    // start the Task for the new application state
    _task = Task.Factory.StartNew<Result>(() => { ... }, _cts.Token);
}

// called by UI component
Task<Result> ComputeResultAsync(CancellationToken cancellationToken)
{
    var task = _task;
    if (cancellationToken.CanBeCanceled && !task.IsCompleted)
    {
        task = WrapTaskForCancellation(cancellationToken, task);
    }
    return task;
} 
```

和

```
static Task<T> WrapTaskForCancellation<T>(
    CancellationToken cancellationToken, Task<T> task)
{
    var tcs = new TaskCompletionSource<T>();
    if (cancellationToken.IsCancellationRequested)
    {
        tcs.TrySetCanceled();
    }
    else
    {
        cancellationToken.Register(() =>
        {
            tcs.TrySetCanceled();
        });
        task.ContinueWith(antecedent =>
        {
            if (antecedent.IsFaulted)
            {
                tcs.TrySetException(antecedent.Exception.GetBaseException());
            }
            else if (antecedent.IsCanceled)
            {
                tcs.TrySetCanceled();
            }
            else
            {
                tcs.TrySetResult(antecedent.Result);
            }
        }, TaskContinuationOptions.ExecuteSynchronously);
    }
    return tcs.Task;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:57:01.677

听起来你想要一组贪婪的任务操作——你有一个任务结果提供者，然后构造一个任务集来返回第一个完成的操作，例如：

```
// Task Provider - basically, construct your first call as appropriate, and then 
//   invoke this on state change

public void OnStateChanged()
{
    if(_cts != null)
       _cts.Cancel();

    _cts = new CancellationTokenSource();
    _task = Task.Factory.StartNew(() =>
       {
           // Do Computation, checking for cts.IsCancellationRequested, etc
           return result;
       });
}

// Consumer 1

var cts = new CancellationTokenSource();
var task = Task.Factory.StartNew(() =>
  {
       var waitForResultTask = Task.Factory.StartNew(() =>
          {
              // Internally, this is invoking the task and waiting for it's value
              return MyApplicationState.GetComputedValue();
          });

       // Note this task cares about being cancelled, not the one above
       var cancelWaitTask = Task.Factory.StartNew(() =>
         {
              while(!cts.IsCancellationRequested)
                 Thread.Sleep(25);

              return someDummyValue;
         });

       Task.WaitAny(waitForResultTask, cancelWaitTask);

       if(cancelWaitTask.IsComplete)
          return "Blah"; // I cancelled waiting on the original task, even though it is still waiting for it's response
       else
          return waitForResultTask.Result;
  }); 
```

现在，我还没有完全测试这一点，但它应该允许您通过取消令牌来“取消”等待任务（从而强制“等待”任务首先完成并点击`WaitAny`），并允许您“取消” “计算任务。

另一件事是找出一种让“取消”任务等待而不会出现可怕阻塞的干净方法。我认为这是一个好的开始。

# drupal - 在toolbar.tpl.php中获取$breadcrumb变量 - Drupal 7

> ID：10688183
> 
> 赞同：1
> 
> 时间：2012-05-21T15:31:06.687
> 
> 标签：drupal, drupal-7, drupal-theming, drupal-templates

我想在toolbar.tpl.php（管理工具栏）中使用$breadcrumb 变量。page.tpl.php 在toolbar.tpl.php 之后处理所以

hook_preprocess_page(){} 和 hook_preprocess_toolbar(){} 没用

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T18:26:38.557

您可以使用[`drupal_get_breadcrumb()`](http://api.drupal.org/api/drupal/includes!common.inc/function/drupal_get_breadcrumb/7)和的组合自己构建面包屑[`theme_breadcrumb()`](http://api.drupal.org/api/drupal/includes!theme.inc/function/theme_breadcrumb/7)，如下所示：

```
$breadcrumb = theme('breadcrumb', array('breadcrumb' => drupal_get_breadcrumb())); 
```

# linq - 使用 LINQ 循环会话变量？

> ID：10688184
> 
> 赞同：4
> 
> 时间：2012-05-21T15:31:09.177
> 
> 标签：linq, session

所以我对 LINQ 还是比较陌生，所以请耐心等待。我正在尝试检查会话变量，如果变量名称不包含名称为“Selected”的键，则将其值设置为 null。

这就是我所拥有的，尽管我可能不接近：

```
Session.Keys.Cast<string>().Where(k => !k.Contains("Selected")).ToList().ForEach(k => k = null); 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T15:34:47.637

您拥有的 LINQ 将密钥设置为空。我相信这是您实际设置值所需的：

```
Session.Keys.Cast<string>()
            .Where(k => !k.Contains("Selected"))
            .ToList()
            .ForEach(k => Session[k] = null);
                          ^ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T15:37:04.593

这是完整的扩展 LINQ 表单

```
Session.Keys
  .Cast<string>()
  .Where(k => !k.Contains("Selected")
  .ToList()
  .ForEach(k => Session[k] = null); 
```

对于这种特殊情况，我发现了 LINQ 的混合，并且`foreach`更具可读性：

```
foreach (var key in Session.Keys.Cast<string>().Where(k => !k.Contains("Selected").ToList())) {
  Session[key] = null;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:33:07.547

这是另一种功能更强大的解决方案：

```
Session = Session.ToDictionary(it => it.Key, 
              it => (it.Key as string).Contains("Selected") ? it.Value : null); 
```

权衡是它创建了一个新字典。

# git - 如何在 GitHub 上合并要点？

> ID：10688185
> 
> 赞同：28
> 
> 时间：2012-05-21T15:31:11.677
> 
> 标签：git, version-control, github

我在 GitHub 上有一个要点，有人分叉并对其进行了更改。我喜欢他们的变化。

有没有办法将更改合并回我原来的要点？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-21T15:36:29.720

gist 的运行方式与任何其他存储库一样。所以假设你已经克隆了类似 git://gist.github.com/2322786.git 的东西：

```
$ git clone git@gist.github.com:2322786.git 
```

（如果你只是想在不推送的情况下尝试这个，你可以使用`git://gist.github.com/2322786.git`，它将演示合并原理并匿名工作，但不允许你推送。）

现在您想合并来自 git://gist.github.com/2661995.git 的更改。将其添加为附加遥控器：

```
$ git remote add changes git://gist.github.com/2661995.git
$ git fetch changes 
```

然后像这样合并更改：

```
$ git merge changes/master 
```

你应该准备好了。无论新要点是在以前的某个时间点从您的要点分叉出来还是完全不相关，这都应该有效。

考虑到 Romain 的评论，您将发出`push`：

```
$ git push 
```

这仅在您的原始克隆 URL 允许写入时才有效。

# objective-c - 播放 m4a 文件的音频单元

> ID：10688195
> 
> 赞同：1
> 
> 时间：2012-05-21T15:32:02.543
> 
> 标签：objective-c, core-audio, audiounit, aac, m4a

我已经为这项任务工作了 12 天，但我找不到任何解决方案请帮助

我应该加载大约 80 个 m4a 文件并使用包含混音器和 remoteIO 单元的 augraph 播放其中一些文件，这就是我加载文件的方式

```
OSStatus result;
for (int i = 0; i < [filePaths count]; i++) {
    NSMutableArray *linearr=[[NSMutableArray alloc] init];
    for (int j = 0; j < [[filePaths objectAtIndex:i] count]; j++) {
        NSString *str=[[filePaths objectAtIndex:i] objectAtIndex:j];

        CFURLRef audioFileURL = CFURLCreateFromFileSystemRepresentation (NULL, (const UInt8 *)[str cStringUsingEncoding:[NSString defaultCStringEncoding]] , strlen([str cStringUsingEncoding:[NSString defaultCStringEncoding]]), false);
        ExtAudioFileRef audiofile;
        ExtAudioFileOpenURL(audioFileURL, &audiofile);
        assert(audiofile);
        OSStatus err;
        AudioStreamBasicDescription fileFormat;
        UInt32 size = sizeof(fileFormat);
        err = ExtAudioFileGetProperty(audiofile, kExtAudioFileProperty_FileDataFormat, &size, &fileFormat);

        AudioFileID aFile;
        //size = sizeof(aFile);
        PropertySize =sizeof(PacketsToRead);
        err = ExtAudioFileGetProperty(audiofile, kExtAudioFileProperty_AudioFile, &PropertySize, &aFile);
        AudioFileTypeID fileType;
        PropertySize = sizeof(fileType);
        err = AudioFileGetProperty(aFile, kAudioFilePropertyFileFormat, &PropertySize, &fileType);
        AudioStreamBasicDescription clientFormat;
        bzero(&clientFormat, sizeof(clientFormat));
        clientFormat.mChannelsPerFrame = 2;
        clientFormat.mBytesPerFrame = 4;
        clientFormat.mBytesPerPacket = clientFormat.mBytesPerFrame;
        clientFormat.mFramesPerPacket = 1;
        clientFormat.mBitsPerChannel = 32;
        clientFormat.mFormatID = kAudioFormatLinearPCM;
        clientFormat.mSampleRate = 44100.00;
        clientFormat.mFormatFlags =kLinearPCMFormatFlagIsSignedInteger | kAudioFormatFlagIsNonInterleaved; //kLinearPCMFormatFlagIsFloat | kAudioFormatFlagIsNonInterleaved;

        err = ExtAudioFileSetProperty(audiofile, kExtAudioFileProperty_ClientDataFormat, sizeof(clientFormat), &clientFormat);

        SInt64 numFrames = 0;
        PropertySize = sizeof(numFrames);
        err = ExtAudioFileGetProperty(audiofile, kExtAudioFileProperty_FileLengthFrames, &PropertySize, &numFrames);
        NSNumber *pc = [NSNumber numberWithLongLong:numFrames];
        [[packetCount objectAtIndex:i] replaceObjectAtIndex:j withObject:pc];
        // create the buffers for reading in data
        bufferList = malloc(sizeof(AudioBufferList) + sizeof(AudioBuffer) * (clientFormat.mChannelsPerFrame - 1));
        bufferList->mNumberBuffers = clientFormat.mChannelsPerFrame;
        for (int ii=0; ii < bufferList->mNumberBuffers; ++ii) {
            bufferList->mBuffers[ii].mDataByteSize = sizeof(float) * numFrames;
            bufferList->mBuffers[ii].mNumberChannels = 2;
            bufferList->mBuffers[ii].mData = malloc(bufferList->mBuffers[ii].mDataByteSize);
        }

        UInt32 rFrames = 0;
        rFrames =(UInt32)numFrames;
        err = ExtAudioFileRead(audiofile, &rFrames, bufferList);
        [linearr addObject:[NSData dataWithBytes:bufferList->mBuffers[1].mData length:numFrames]];
        err = ExtAudioFileDispose(audiofile);

}
    [audioData addObject:linearr];
} 
```

我就是这样玩的：

```
UInt32 *buslist;
buslist=( UInt32*)[[[audioData objectAtIndex:0] objectAtIndex:4]bytes ]; 
```

在渲染回调函数中：

```
for (int i = 0 ; i < ioData->mNumberBuffers; i++){
     UInt32 *au3=au->mBuffers[0].mData;
     AudioBuffer buffer = ioData->mBuffers[i];
     UInt32 *frameBuffer = buffer.mData;
     for (int j = 0; j < inNumberFrames; j++)
     {
         frameBuffer[j] = buflist[counter];
         if(counter>=529200)
             counter=0;
         else
             counter++;
     }}} 
```

现在，当我播放声音时，我会以双倍速度播放第一部分，然后第二部分只会失真。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:23:18.050

我遇到了完全相同的问题；

传入声音的采样率较低，因此我分配的数组对于 auGraph 的较高采样率来说不够大，而且太快且太短。

确保分配一个数组来读取文件，如下所示：

sarray->frames = totalFramesInFile * graphSampleRate / fileAudioFormat.mSampleRate;

# objective-c - 监控传入字节 OS X

> ID：10688196
> 
> 赞同：0
> 
> 时间：2012-05-21T15:32:03.380
> 
> 标签：objective-c, macos, cocoa, osx-lion, packet-sniffers

我正在为 OS X 构建一个网络实用程序。我已经阅读了 Apple 的文档，但我找不到允许我的应用程序监视传入字节的框架。谁能指出我正确的方向？感谢您的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:44:00.463

要获取网络上的统计信息，您可以使用[`sysctl`系统调用](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/Manpages/man3/sysctl.3.html#//apple_ref/doc/man/3/sysctl)。这是相当薄的记录；StackOverflow上的[另一个答案](https://stackoverflow.com/questions/1126790/how-to-get-network-adapter-stats-in-linux-mac-osx)给出了一个简短的示例，有关更多详细信息，我建议您查看[netstat 源代码](http://opensource.apple.com/source/network_cmds/network_cmds-356.8/netstat.tproj/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:44:20.597

我认为这样的事情可以用

[http://www.wireshark.org/](http://www.wireshark.org/)或[http://www.tastycocoabytes.com/cpa/](http://www.tastycocoabytes.com/cpa/)

在 Linux 中，您可以简单地收听与您的网卡关联的文件。

但我不认为这可以在 OS X 上轻松完成。但确实必须有一些方法，想想 LittleSnitch。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:44:47.540

您可以使用[libpcap](http://www.tcpdump.org/pcap3_man.html)，这是一个可移植的库，用于进行 tcpdump、Wireshark 等使用的数据包捕获。它不是官方的 Apple 库，但它是 BSD 许可的，因此使用它应该没有任何问题。

# php - 如何突出显示 HTML 中的内容？

> ID：10688197
> 
> 赞同：-3
> 
> 时间：2012-05-21T15:32:05.237
> 
> 标签：php, jquery, html, css

我在同一页面上创建了链接。此页面的内容位于底部，锚选项卡位于顶部。

当有人点击顶部链接（ancho）时，我想突出显示内容区域 5 秒钟。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:35:00.003

看看 jQuery 和 Effects-Plugin。

[http://docs.jquery.com/UI/Effects/Highlight](http://docs.jquery.com/UI/Effects/Highlight)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:39:30.700

您可以通过多种方式进行操作，例如绑定 onHashChange 然后更改背景颜色：

```
$(window).bind('hashchange', function(){
    $(".highlight").css("background","#AFA");
    setTimeout(function(){
        $(".highlight").css("background","transparent");
    },5000);
});​ 
```

[http://jsfiddle.net/X8kBj/1/](http://jsfiddle.net/X8kBj/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:42:24.897

利用`delay()`

```
$('#id-of-anchor').click(function(){

 $("#your-div").css('background','red').delay(5000).css('background','transparent');
 return false;    

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T15:38:19.330

给每条内容一个唯一的id，如下：

```
<div id="content_1"> ... </div> 
```

然后使用 jQuery 为每个链接设置事件：

```
$("div").delegate("#content_1", "click", function() {
  $('div.content_1').effect("highlight", {}, 3000);
}); 
```

或者你可以使用 .on() 或 .live() 但你明白了。

# javascript - 在 CDN 失败时加载本地 JS/CSS 的 HTML if 语句

> ID：10688205
> 
> 赞同：7
> 
> 时间：2012-05-21T15:32:33.983
> 
> 标签：javascript, html, performance, web

从 CDN 或任何外部服务器加载 CSS/JS 文件时，有可能（即使概率很低）由于外部故障而丢失文件。在这种情况下，html 页面将因缺少适当的 CSS 和 JS 而损坏。

是否有在 CDN 失败时加载本地版本的实用方法？

```
<link rel="stylesheet" href="http://cdn.com/style.css" type="text/css" />
IF (not loaded style.css){
<link rel="stylesheet" href="/css/style.css" type="text/css" media="screen" />
} 
```

对于 JS 来说会更容易，因为我们可以测试一个 JS 函数（在 JS 文件中提供）；然后，在失败时加载本地文件。例如，测试，如果 jQuery 库可用。

但是，我很想知道是否有实用的方法！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T15:52:45.843

我会这样做。

在样式表中创建一个类`ui-helper-hidden`，然后添加一个 div 作为页面上的第一个元素；

```
<body><div class="ui-helper-hidden"></div><!-- rest of html --></body> 
```

在您检查以确保您的 CDN javascript 文件已加载后，然后使用这段代码**说明我正在使用 jquery**

```
<script>
    // CSS Fallback
    $(function () {
        if ($('.ui-helper-hidden:first').is(':visible') === true) {
            $('<link rel="stylesheet" type="text/css" href="/pathtocss/nameofstylesheet.css" />').appendTo('head');
        }
    });
</script> 
```

这将检查应该隐藏的元素是否存在。如果它没有隐藏，那么您就知道您的 css 文件没有从 CDN 加载。

我通过 CDN 将此方法用于[jQuery 和 jQuery UI](http://timjames.me/jquery-and-jquery-ui-fallbacks)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:47:29.393

对于 Javascript，您可以在构建动态脚本时监听[`onload`](http://www.quirksmode.org/dom/events/load.html)和事件。[`onerror`](http://www.quirksmode.org/dom/events/error.html)但是，在这些相同的页面中，它显示为 CSS。

动态加载 CSS 的唯一可靠方法是通过 AJAX 进行。您*可以*通过动态链接标签加载样式，但如果没有这些事件，您将根本不知道它们是否已加载。您可以对样式进行民意调查，但它是 hackish IMO。

另一种方法是让服务器读取这些 CDN 文件。如果它们很好，请打印链接的 url。但是，如果这些链接已失效，请改为打印本地 url。这将更可靠，并将您的逻辑卸载到服务器。这假定您有权访问服务器。

或者更好的是，首先使用本地版本！有了良好的缓存，带宽将不是问题

# javascript - 使用 grails 和 javascript 执行 ajax 时出错

> ID：10688208
> 
> 赞同：0
> 
> 时间：2012-05-21T15:32:48.513
> 
> 标签：javascript, jquery, grails

我在客户端有这个jquery函数......

```
$('#add-car').on('click', function() {
             $.ajax({
                     type: 'POST',
                     url: 'cars/',
                     data: {brand: 'brand', model: 'model', price: 100,
                           registryYear:1999},
                     success: function(data) { console.log(data)},
                     dataType: 'json'
                   });
            }); 
```

而这个 Grails 代码在服务器端

```
 class UrlMappings {

   static mappings = {
           "/cars/$id?"(controller: "cars") {
                   action = [GET:"list", POST:"save", DELETE:"delete", PUT:"edit"]
           }
           "/$controller/$action?/$id?"{
                   constraints {
                           // apply constraints here
                   }
           }

           "/"(view:"/index")
           "500"(view:'/error')
   } 
```

}

```
 import grails.converters.JSON

class CarsController {

 def index() {
     render ( Car.findAll() as JSON )
 }

 def save() {
     def json = request.JSON
     def car = new Car(json)
     car.save()
     render (json)
 }

 def delete() {
     def car = Car.findById(params.id)
     car?.delete()
     render (car as JSON)
 }

 def edit() {
     def car = Car.findById(params.id)
             bindData(car, request.JSON)
     render (car.save() as JSON)
 }
 } 
```

但是当按下按钮#add-car 时，它什么也没有返回......我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T07:34:28.447

好吧，我没有在 grails 中编码，
但您最接近的 url 映射似乎是这个`"/cars/$id?"`
，我假设需要一个 ID，但是从您的 javascript 代码中，您没有发回任何名为`Id`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T07:22:10.637

这是关于调试方法的。

请检查请求是否到达您的服务器。您可以通过将一些日志“在此处运行”添加到您在控制器上请求的操作中来做到这一点。

如果打印了“在此处运行”，则请求已发送，您必须找出服务器未返回预期结果的原因。

如果未打印日志，则意味着您必须重新检查您的 javascript。使用[Firebug](http://getfirebug.com/)可能有助于发现一些棘手的 javascript 错误。

* * *

顺便说一句，我认为你应该在你的 javascript 中使用“jQuery”而不是“$”符号。这是为了避免与其他库发生冲突，例如：

```
jQuery('#add-car').click(function() {
....
            }); 
```

# fxcop - FxCop 分析错误：Key 需要大于 0

> ID：10688213
> 
> 赞同：0
> 
> 时间：2012-05-21T15:33:16.997
> 
> 标签：fxcop

我目前正在尝试为旧版 WPF 应用程序设置代码分析。作为其中的一部分，我正在运行 FxCop 10.0，但我的一些 DLL 收到错误，所有这些都成功构建。

我得到的错误是：

![FxCop 错误](../Images/b11ea408d631354e2e271ea6d47ade66.png)

当我得到这个时，它通常是在一个`get`或`set`财产上，似乎没有任何明显的原因说明为什么会发生这种情况。我似乎无法在示例应用程序中重新创建它。在集合中导致此错误的一段代码示例如下：

```
Application.Current.Dispatcher.BeginInvoke(DispatcherPriority.Normal, new Action(() =>
{
    OnPropertyChanged("MyProperty");
})); 
```

在上面的代码中，如果我删除了 Dispatcher 代码，FxCop 成功地分析了代码，但是将其保留会导致抛出错误。还有其他类似代码的实例运行良好。有谁知道可能导致此错误的原因是什么？

# asp.net-mvc - 在 MVC3 中加密和解密查询字符串

> ID：10688214
> 
> 赞同：0
> 
> 时间：2012-05-21T15:33:32.577
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我正在使用 MVC3。我有几个不需要身份验证的页面，但这些页面有可能被篡改的查询字符串。我计划在发送给用户时加密这些 url，并在他们点击它时将其解密，在 MVC3 中加密和解密查询字符串的最佳方法是什么？给我一个指针如果有任何我可以重用的模块......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:10:12.607

为什么不相信另一种存储机制而不是查询字符串？您可以通过 POST 操作传递信息，有几种方法可以做到这一点，例如缓存或其他。Post 自动将该信息放在请求标头上，并且对用户隐藏，如果您的站点通过 SSL 连接，该信息也会被加密。

您可以通过集成的 MVC 安全功能（例如 @Html.AntiForgeryToken()）提高站点的安全性，防止恶意软件请求，这可以防止恶意站点试图绕过您的系统冒充真实请求。简而言之，这意味着当表单发送到客户端时，表单标题上会打印一个唯一 ID，如果 ID 不等于服务器期望的 ID，则忽略该请求。

这是一个有趣的帖子，可以帮助你。

[https://sites.google.com/site/muazkh/asp-net-mvc-security-and-hacking-defense-in-depth](https://sites.google.com/site/muazkh/asp-net-mvc-security-and-hacking-defense-in-depth)

此致！

# model-view-controller - 如何使用 PyQt 将许多值进出对话框

> ID：10688215
> 
> 赞同：0
> 
> 时间：2012-05-21T15:33:39.350
> 
> 标签：model-view-controller, dialog, pyqt

我有一个带有复杂对话框的便携式应用程序，该对话框显示具有许多（超过 50 个）可以更改的不同设置值的用户选项卡。用户可以设置这些值，然后按 OK 或 Cancel。

如果用户按下 OK，我希望应用程序将更改存储在模型中，但如果用户按下取消，我希望应用程序忘记所做的任何更改。

让价值进入和退出对话的最佳策略是什么？

我知道如何使用 QDataWidgetMapper 将模型直接映射到小部件，但是如果用户单击取消，我会遇到问题 - 我必须撤消所做的所有更改。另一方面，如果我创建了一个与模型分开存储值的特定于对话框的对象，那么我必须将模型中的所有值复制到对象中，然后如果用户按下确定，则将它们再次复制出来。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:45:51.490

[`QDataWidgetMapper`](http://qt-project.org/doc/qt-4.8/qdatawidgetmapper.html)非常适合这种情况，它有两个[提交策略](http://qt-project.org/doc/qt-4.8/qdatawidgetmapper.html#submitPolicy-prop)。`AutoSubmit`和`ManualSubmit`。在您的情况下，您可以在用户按下时使用and`ManualSubmit`显式调用，或者在用户按下时根本不提交。`submit()``OK``Cancel`

# r - 事先知道要 clusterExport 的对象

> ID：10688218
> 
> 赞同：7
> 
> 时间：2012-05-21T15:33:47.663
> 
> 标签：r, foreach, parallel-processing

我是使用并行包的新手，并且已经开始探索它们以加快我的一些工作。我经常遇到的一个烦恼是，`foreach`当我没有`clusterExport`相关的函数/变量时，该命令会引发问题。

# 例子

我知道下面的示例不一定需要`foreach`使其快速，但为了说明起见，我将使用它。

```
library(doParallel)
library(parallel)
library(lubridate)
library(foreach)

cl <- makeCluster(c("localhost", "localhost", "localhost","localhost"), type = "SOCK")
registerDoParallel(cl, cores = 4)

Dates <- sample(c(dates = format(seq(ISOdate(2010,1,1), by='day', length=365), format='%d-%m-%Y')), 500, replace = TRUE)

foreach(i = seq_along(Dates), .combine = rbind) %dopar% dmy(Dates[i])

Error in dmy(Dates[i]) : task 1 failed - "could not find function "dmy"" 
```

如您所见，有一个错误提示`dmy`找不到该函数。然后我必须继续添加以下内容：

```
clusterExport(cl, c("dmy")) 
```

所以我的问题是，除了查看错误以获取有关导出什么的线索之外，是否有一种更优雅的方法可以预先知道要导出哪些对象，或者有没有办法在运行之前与所有从属共享全局环境`foreach`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:01:09.293

无需像那样手动导出单个包功能。您可以使用函数的`.packages`参数`foreach`来加载所需的包，因此所有包函数都可用于您的`%dopar%`表达式。

# xslt - XSL 对来自不同节点的数字进行排序

> ID：10688222
> 
> 赞同：1
> 
> 时间：2012-05-21T15:33:59.973
> 
> 标签：xslt, sorting

我需要从位于我的 xml 源中不同节点的数字构造一个字符串，但需要注意的是数据速率节点顺序将是随机的，并且起始数字必须以至少 600 开头。如果没有 600，则开始800。

```
<datarate rate="200" />
<datarate rate="600" />
<datarate rate="300" />
<datarate rate="400" />
<datarate rate="800" />
<datarate rate="1000" />

http://example.com/src/600/800/ 
```

我尝试过根据组进行排序，但无济于事。有人有想法吗？

感谢您的任何帮助，您可以提供！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:19:37.047

使用 XSLT 2，您可以这样做：

```
<xsl:template match="/">
   <xsl:for-each select="//datarate[number(@rate) ge 600]">
      <xsl:sort select="@rate" data-type="number"/>
      <xsl:value-of select="@rate"/>
      <xsl:if test="not(position() eq last())">
         <xsl:text>, </xsl:text>
      </xsl:if>
   </xsl:for-each>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:04:21.360

如果您预先知道阈值，您可以像这样进行非常简单的转换：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="text" encoding="UTF-8"/>

    <xsl:template match="/">
        <xsl:apply-templates select="//datarate">
            <xsl:sort select="@rate" data-type="number"/>
        </xsl:apply-templates>
    </xsl:template> 

    <xsl:template match="datarate[@rate &lt; 600]"/>

    <xsl:template match="datarate">
        [<xsl:value-of select="@rate"/>]
    </xsl:template>
</xsl:stylesheet> 
```

由于您需要检查是否存在 a`600`并`800`在未找到时用作阈值`600`，因此您可以这样：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="text" encoding="UTF-8"/>

   <xsl:variable name="threshold">
       <xsl:choose>
           <xsl:when test="//datarate[@rate = 600]">600</xsl:when>
           <xsl:otherwise>800</xsl:otherwise>
       </xsl:choose>
   </xsl:variable>

   <xsl:template match="/">
       <xsl:apply-templates select="//datarate">
           <xsl:sort select="@rate" data-type="number"/>
       </xsl:apply-templates>
   </xsl:template>  

   <xsl:template match="datarate[@rate &lt; $threshold]"/>

   <xsl:template match="datarate">
       [<xsl:value-of select="@rate"/>]
   </xsl:template>
</xsl:stylesheet> 
```

如果可能既没有 a`600`也没有 a，`800`您可能希望在`$threshold`变量声明中添加更多逻辑。

ps 没有关于您希望如何构造字符串的详细信息，我只是打印了`@rate`包含在`[]`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T02:30:48.527

**这个简短而简单的转换**（根本没有使用明确的条件指令—— no `xsl:choose`, no `xsl:when`, no `xsl:otherwise`）：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="/*">
  <t>
    <xsl:apply-templates select="*">
     <xsl:sort select="@rate" data-type="number"/>
    </xsl:apply-templates>
  </t>
 </xsl:template>

 <xsl:template match=
  "datarate
     [not(@rate >= 600)
     or
      not(../*[@rate = 600]) and not(@rate >= 800)
     ]"/>
</xsl:stylesheet> 
```

**当应用于提供的 XML 文档时**（包装到单个顶部元素中以形成良好的格式）：

```
<t>
    <datarate rate="200" />
    <datarate rate="600" />
    <datarate rate="300" />
    <datarate rate="400" />
    <datarate rate="800" />
    <datarate rate="1000" />
</t> 
```

**产生想要的正确结果**：

```
<t>
   <datarate rate="600"/>
   <datarate rate="800"/>
   <datarate rate="1000"/>
</t> 
```

**当应用于以下稍有变化的 XML 文档时**（没有 600 的比率，但有 601 和 650 的比率）：

```
<t>
    <datarate rate="200" />
    <datarate rate="601" />
    <datarate rate="650" />
    <datarate rate="300" />
    <datarate rate="400" />
    <datarate rate="800" />
    <datarate rate="1000" />
</t> 
```

**再次产生正确的结果：**

```
<t>
   <datarate rate="800"/>
   <datarate rate="1000"/>
</t> 
```

# php - PHP Zend 导出带有 401 Unauthorized 错误消息的谷歌文档

> ID：10688223
> 
> 赞同：0
> 
> 时间：2012-05-21T15:34:08.043
> 
> 标签：php, zend-framework, export-to-excel, google-docs, google-docs-api

我在将 Google Docs（电子表格）导出到 xls 文件并保存到我们自己的服务器时遇到问题。

成功将文件上传到 Google Docs 后，但在下载时以某种方式收到 401 错误消息。

```
Fatal error:  Uncaught exception 'Zend_Gdata_App_HttpException' with message 'Expected response code 200, got 401
<HTML>
<HEAD>
<TITLE>Unauthorized</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1>Unauthorized</H1>
<H2>Error 401</H2>
</BODY>
</HTML> 
```

这是我们的 PHP 代码，希望有人能帮助我指出哪里出了问题。

任何想法都会受到高度欢迎。

```
<?php

// set credentials for ClientLogin authentication
$google_user = 'xxxxx'; // Your google account username
$google_pass = 'xxxxx'; // Your google account password

$service = Zend_Gdata_Docs::AUTH_SERVICE_NAME; 
$httpClient = Zend_Gdata_ClientLogin::getHttpClient($google_user, $google_pass,$service);
$docs = new Zend_Gdata_Docs($httpClient);

// Uploading file to Google Docs works perfectly as below
//$newDocumentEntry = $docs->uploadFile('test.txt', 'order-123456','text/plain', Zend_Gdata_Docs::DOCUMENTS_LIST_FEED_URI);

$path = "/var/www/vhosts/googledocs";

$docsQuery = new Zend_Gdata_Docs_Query();
$docsQuery->setTitle("My Spreadsheet Name");
$docsQuery->setTitleExact(false);
$feed = $docs->getDocumentListFeed($docsQuery);

foreach ($feed->entries as $entry) {
    $docID = $entry->getId();
    $docTitle = $entry->getTitle();  

    if($entry->getTitle() == "My spreadsheet File Name"){
        $strURL = $entry->content->getSrc() . '&exportFormat=xls&format=xls';            
        $data = $docs->get($strURL);
        file_put_contents($path."test.xls", $data);
    }
}

?> 
```

更新 - 2012 年 5 月 23 日

我们终于通过如下调整代码让它工作了：它对某人有用！

```
foreach($feed as $entry): 
        if($entry->getTitle() == 'My Spreadsheet File Name'){
            $path = "/var/www/vhosts/regustouchstone.com/subdomains/docs/httpdocs/googledocs";
            $strURL = "https://spreadsheets.google.com/feeds/download/spreadsheets/Export?key=".basename($entry->id)."&exportFormat=xls&format=xls";

            try{            
                $data = $service->get($strURL)->getBody();              
                $fp = fopen($path."/test.xls", "w+");
                                fwrite($fp, $data);
                                fclose($fp);                
            }catch(Zend_Exception $e) {
                echo "<br /><br /> ERROR <br />";
                echo $e->getMessage();
            }
        }
    endforeach; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:06:43.670

$strUrl 是否正确且一致地编码，例如是否所有的“&”都被编码为“&”？

此外，如果下载链接的服务器是[http://spreadsheets.google.com](http://spreadsheets.google.com)（而不是[http://docs.google.com](http://docs.google.com)），您可能需要对电子表格服务进行身份验证：

```
$spreadsheetClient = Zend_Gdata_ClientLogin::getHttpClient($google_user, $google_pass, Zend_Gdata_Spreadsheets::AUTH_SERVICE_NAME);
$spreadSheetService = new Zend_Gdata_Spreadsheets($spreadsheetClient);
...
// download the spreadsheet
$data = $spreadSheetService->get($strURL); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T10:58:45.280

我们有一个解决方案如下：

```
foreach($feed as $entry): 
        if($entry->getTitle() == 'My Spreadsheet File Name'){
            $path = "/var/www/vhosts/regustouchstone.com/subdomains/docs/httpdocs/googledocs";
            $strURL = "https://spreadsheets.google.com/feeds/download/spreadsheets/Export?key=".basename($entry->id)."&exportFormat=xls&format=xls";

            try{            
                $data = $service->get($strURL)->getBody();              
                $fp = fopen($path."/test.xls", "w+");
                                fwrite($fp, $data);
                                fclose($fp);                
            }catch(Zend_Exception $e) {
                echo "<br /><br /> ERROR <br />";
                echo $e->getMessage();
            }
        }
    endforeach; 
```

# ios - 如何以这种形式“lat，long”从xml获取坐标

> ID：10688224
> 
> 赞同：0
> 
> 时间：2012-05-21T15:34:13.003
> 
> 标签：ios, xml, xcode, annotations, coordinates

我已经成功地从 xml 文件中获得了注释：

```
 double realLatitude = [[[anns objectAtIndex:i] objectForKey:@"Latitude"] doubleValue];

    double realLongitude = [[[anns objectAtIndex:i] objectForKey:@"Longitude"] doubleValue];

    MyAnnotation *myAnnotation = [[MyAnnotation alloc] init];
    CLLocationCoordinate2D theCoordinate;
    theCoordinate.latitude = realLatitude;
    theCoordinate.longitude = realLongitude;
    myAnnotation.coordinate=CLLocationCoordinate2DMake(realLatitude,realLongitude); 
```

xml 文件如下所示：

```
<key>Latitude</key>
<string>60.490275</string>
<key>Longitude</key>
<string>22.255962</string> 
```

但现在我有一个大的坐标点列表，如下所示：

```
<key>Coordinates</key>
<string>27.864849695000,70.080733147000</string> 
```

我需要改变我的代码工作吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:41:44.827

Assuming that `anns` is the array with the parsed `xml` elements:

```
NSString *coordinates = [[anns objectAtIndex:i] objectForKey:@"Coordinates"];
double realLatitude = [[[coordinates componentsSeparatedByString:@","] objectAtIndex:0] doubleValue];
double realLongitude = [[[coordinates componentsSeparatedByString:@","] objectAtIndex:1] doubleValue]; 
```

# javascript - 谷歌图表显示金钱而 不是百分比

> ID：10688225
> 
> 赞同：7
> 
> 时间：2012-05-21T15:34:13.137
> 
> 标签：javascript, formatting, google-visualization

给定饼图的数据：

```
data = new google.visualization.arrayToDataTable([
    ['Sales', 'Revenue Distribution'],
    ['Author', 5],
    ['Company', 2],
    ['Tax', 0.4],
    ['Payment Processors', 0.9]
]);
drawChart(); 
```

我怎样才能让它显示为美元金额？无论是在工具提示中还是在实际图表本身中（两者都更可取！）

例如，理想情况下这会起作用：

```
data = new google.visualization.arrayToDataTable([
    ['Sales', 'Revenue Distribution'],
    ['Author', '$5'],
    ['Company', '$2'],
    ['Tax', '$0.4'],
    ['Payment Processors', '$0.9']
]);
drawChart(); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-21T16:18:26.237

这是可能的，它将应用于切片和工具提示。您需要包含的是一个[数字格式化程序](https://developers.google.com/chart/interactive/docs/gallery/table#Formatters)。

关键是在“创建”图表之前应用以下内容。

```
var formatter = new google.visualization.NumberFormat({
    prefix: '$'
});
formatter.format(data, 1);

var options = {
    pieSliceText: 'value'
}; 
```

这首先创建格式化程序并将其应用于数据，然后下一个选项强制饼图显示格式化值，而不是计算的百分比。你可以看到它在[这个 jsfiddle](http://jsfiddle.net/cchana/FN36W/)中工作。

受到此处答案的启发和改编：以[编程方式格式化谷歌图表](https://stackoverflow.com/questions/7298685/formatting-google-charts-programmatically)

# vb.net - 读取文本文件并在 Visual Basic.NET 中的不同标签上写入

> ID：10688227
> 
> 赞同：-1
> 
> 时间：2012-05-21T15:34:18.957
> 
> 标签：vb.net, file, label

我想读取一个文本文件并将这些行写在不同的标签上。是否可以生成标签？

我尝试使用带有 label1、label2、label3、label4 名称的四个标签，但我不知道如何创建一个循环来读取文件的每一行并将其写入每个不同的标签中。第一个标签中的第一行，第二个标签中的第二行等。

我试过的：

```
Do Until fread.EndOfStream
    line = fread.ReadLine()
    parti = line.Split("_")
    ora.Text = parti(1)

    data.Text = parti(2)

    If Len(parti(3)) > 10 Then
        mesaj.Text = Microsoft.VisualBasic.Left(parti(3), 25) & "..."

    Else
        mesaj.Text = parti(3)

    End If

Loop 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:55:29.563

尝试使用此代码创建标签并将标签放在表单上。

```
Dim label As New Label
label.Text = "label"
Me.Controls.Add(label) 
```

# php - 当我尝试从 codeigniter URL 中删除“Index.php”时，我被重定向到 domain.ltd（在 chrome 中）

> ID：10688236
> 
> 赞同：1
> 
> 时间：2012-05-21T15:34:45.717
> 
> 标签：php, .htaccess, codeigniter, url, url-rewriting

我试图通过从我的 URL 中删除 index.php 来使我的网站的 URL 更清晰（并且对 SEO 友好），但发生了意外的结果，这是我的 .htaccess 文件：

```
<IfModule mod_rewrite.c>
<IfModule mod_rewrite.c>

    RewriteEngine On
    RewriteBase /

    ### Canonicalize codeigniter URLs

    RewriteRule ^(site(/index)?|index(\.php)?)/?$ / [L,R=301]
    RewriteRule ^(.*)/index/?$ $1 [L,R=301]

    # Removes trailing slashes (prevents SEO duplicate content issues)
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.+)/$ $1 [L,R=301]

</IfModule>

<IfModule !mod_rewrite.c>

    # Without mod_rewrite, route 404's to the front controller
    ErrorDocument 404 /index.php

</IfModule> 
```

控制器是：site.php。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:40:58.533

## 尝试三件事：

1.  您是否从 config.php 文件中删除了 index.php

2.  您是否尝试过直接使用 CI 提供的 htacces？

3.  设置`$config['uri_protocol']`为`'AUTO';`OR`QUERY_STRING`

## 直接来自用户指南：

[http://codeigniter.com/user_guide/general/urls.html](http://codeigniter.com/user_guide/general/urls.html)

> 删除 index.php 文件
> 
> 默认情况下，index.php 文件将包含在您的 URL 中：
> 
> `example.com/index.php/news/article/my_article`
> 
> You can easily remove this file by using a .htaccess file with some simple rules. Here is an example of such a file, using the "negative" method in which everything is redirected except the specified items:
> 
> ```
> RewriteEngine on
> RewriteCond $1 !^(index\.php|images|robots\.txt)
> RewriteRule ^(.*)$ /index.php/$1 [L] 
> ```
> 
> In the above example, any HTTP request other than those for index.php, images, and robots.txt is treated as a request for your index.php file.

# search - 获取 Google 讨论搜索结果

> ID：10688238
> 
> 赞同：0
> 
> 时间：2012-05-21T15:34:50.047
> 
> 标签：search, web-scraping

我想去获取谷歌讨论搜索检索到的结果，像[这样](https://www.google.com/search?q=diablo%203&hl=en&prmd=imvns&source=lnms&ei=qFi6T7f3FYzotQb58uSDCA&sa=X&oi=mode_link&ct=mode&cd=1&ved=0CFEQ_AUoAA&biw=1366&bih=273#q=diablo%203&hl=en&prmd=imvns&source=lnms&tbm=dsc&ei=q1i6T4aKLY6D-wamn7G7Cg&sa=X&oi=mode_link&ct=mode&cd=5&ved=0CHMQ_AUoBA&prmdo=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=88fe818faaaa8276&biw=1366&bih=273)。请注意左下角的讨论选项卡。

我更喜欢使用 Python 和 Google[自定义搜索 API](https://developers.google.com/custom-search/docs/start)，但我不确定它们是否支持讨论搜索，所以欢迎使用任何选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T03:59:06.380

似乎没有任何方式可以定制 API 结果以获取“讨论”结果，但 API 可以按文件类型过滤，那么为什么不尝试使用 aq 查询来查找论坛生成的 RSS 提要呢？

```
https://www.googleapis.com/customsearch/v1?key= your key &cx= your_id &q=diablo 3 forum RSS&fileType=rss&alt=json 
```

许多人倾向于拥有最新/最后的帖子提要，并且监控这些内容的变化应该会产生良好的数据流。

# actionscript-3 - Startdrag 不是函数

> ID：10688250
> 
> 赞同：0
> 
> 时间：2012-05-21T15:35:25.483
> 
> 标签：actionscript-3

```
this.addEventListener(MouseEvent.MOUSE_DOWN,function(e:MouseEvent){this.startDrag(false,null);}); 
```

嗨，我想知道为什么上述不起作用？我试图在屏幕上拖动精灵。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:04:22.903

在舞台上创建一个精灵，添加实例名称框，将代码添加到第一帧：

```
box.addEventListener(MouseEvent.MOUSE_DOWN, startMove);

function startMove(evt:MouseEvent):void {
   box.startDrag();
}

box.addEventListener(MouseEvent.MOUSE_UP, stopMove);

function stopMove(e:MouseEvent):void {
   box.stopDrag();
} 
```

我认为您的示例不起作用，因为事件侦听器处理程序中的“this”范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:05:00.430

如果您删除`this.`; 它会起作用的。这是一个范围问题，因为您使用的是匿名函数。您可以使用`currentTarget`事件的 ，如果您添加相同的侦听器，这也允许您使其他框也可拖动。

*注意：*作为事件侦听器很难删除匿名函数，并且可能导致内存泄漏，因此最好的方法是使用对命名函数的引用：

```
box.addEventListener(MouseEvent.MOUSE_DOWN, handleMouseEvent);
box.addEventListener(MouseEvent.MOUSE_UP, handleMouseEvent);

function handleMouseEvent(event:MouseEvent):void 
{
    switch(event.type)
    {
       case MouseEvent.MOUSE_DOWN:
       {
         DisplayObject(event.currentTarget).startDrag();
         break;
       }
       case MouseEvent.MOUSE_UP:
       {
         DisplayObject(event.currentTarget).stopDrag();
         break;
       }
   }
} 
```

# esb - WSO2 ESB 服务编排

> ID：10688251
> 
> 赞同：1
> 
> 时间：2012-05-21T15:35:26.060
> 
> 标签：esb, wso2, orchestration

你好 WSO2 社区和你好 Stackoverflow，

我从 ESB 开始对 SOA 套件的测试进展顺利：现在 ESB 识别外部服务，创建返回正确结果的正确代理。

> **解决了**
> 
> 关于这一点，我有两个问题：第一个是“尝试一下”功能引发了异常：
> 
> ```
> "Cannot find dispatch method for {http://schemas.xmlsoap.org/soap/envelope/}Envelope 
> ```
> 
> [tagOpened]/soapenv:Text[tagClosed]"
> 
> 当我尝试发送为代理的 Web 服务的模拟服务创建的 SOAP 封装时。
> 
> 无论如何，如果我从外部客户端（在 Netbeans 上创建）尝试代理服务，它会很好用。
> 
> 回答
> 
> *对于第一部分，原因很可能是跨域问题，因为 try-它是通过​​浏览器的 java 脚本存根发送消息。您会注意到，当服务本身托管在 ESB 本身中时，这很有效，因为请求通过同一个域。这就是为什么，虽然它可以通过正常的客户端调用完美地工作，但它不能通过 try-it 工作。*

第二个问题是我无法协调两个服务。我的目标是将第一个服务的输入发送到第二个服务，然后发送给用户。

我正在编写 Tharindu Mathew 建议的教程：现在一切对我来说都是有意义的，除了一件事：XSLT 转换。

这是教程建议您创建的输出序列：

```
<outSequence xmlns="http://ws.apache.org/ns/synapse">
   <switch source="get-property('STATE')">
      <case regex="PERSON_INFO_REQUEST">
         <log level="full">
            <property name="sequence" value="outSequence - STATE 01 - response from PersonInfoService" />
         </log>
         <xslt key="xslt">
            <property name="amount" expression="get-property('ORG_AMOUNT')" />
         </xslt>
         <log level="full">
            <property name="sequence" value="outSequence - STATE 01 - request for CreditService" />
         </log>
         <property name="STATE" value="CREDIT_REQUEST" />
         <send>
            <endpoint key="CreditEpr" />
         </send>
      </case>
      <case regex="CREDIT_REQUEST">
         <log level="full">
            <property name="sequence" value="outSequence - STATE 02 - response from CreditService" />
         </log>
         <send />
      </case>
   </switch>
</outSequence> 
```

现在，关注第一个 switch 案例的 XSLT 节点，您可以看到对于 amount 属性只有一个 get。所以我认为我们有一个来自 in sequence 的 XML 来说明 ID，并且这得到了 amount 属性（我不知道它做了什么）。

本教程然后建议：

> 要创建对此 CrediService 的请求，我们将以下 XSLT 与 XSLT 中介一起使用。请注意，我们使用存储在此 XSLT 中的 ORG_ID 作为 XSLT 参数，并且还使用了 XSLT 中介。

这是教程中显示的 XSLT：

```
<xsl:stylesheet version="2.0" 
        xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
        xmlns:fn="http://www.w3.org/2005/02/xpath-functions"
        xmlns:ns="http://samples.esb.wso2.org"
        xmlns:ax21="http://samples.esb.wso2.org/xsd"
        exclude-result-prefixes="ns fn">
<xsl:param name="amount"/>
<xsl:output method="xml" omit-xml-declaration="yes" indent="yes"/>

<xsl:template match="/">
  <xsl:apply-templates select="//ns:getResponse" />
</xsl:template>

<xsl:template match="ns:getResponse" xmlns:ns="http://samples.esb.wso2.org">
<sam:credit xmlns:sam="http://samples.esb.wso2.org" xmlns:xsd="http://samples.esb.wso2.org/xsd">
    <sam:info>
        <xsd:amount><xsl:value-of select="$amount"/></xsd:amount>
        <xsd:personInfo>
            <xsd:address><xsl:value-of select="ns:return/ax21:address"/></xsd:address>
            <xsd:id><xsl:value-of select="ns:return/ax21:id"/></xsd:id>
            <xsd:name><xsl:value-of select="ns:return/ax21:name"/></xsd:name>
        </xsd:personInfo>
    </sam:info>
</sam:credit>
</xsl:template>
</xsl:stylesheet> 
```

我被要求将一个类似的文件放入 WSO2 ESB 的资源目录中，但该文件从未在教程中使用过：

> 将示例 zip 中的 personToCredit.xslt 复制到 WSO2 ESB 的资源目录。

---------小括号----------

声明后也没有使用 WSDL 文件：

> 将示例 zip 中的 CreditProxy.wsdl 复制到 WSO2 ESB 的资源目录中。

我在配置/治理注册表中找不到 WSDL 文件，也不知道如何解决它，所以我选择内联指定它。

---------小括号结束----------

这句话后面是 XSLT 文件文本。我现在的主要问题是：

**我应该把这个 XSLT 放在哪里？我不知道将 XSLT 中介器放在哪里，也不知道如何构建它。我应该依赖注册表吗？**

一个完美的答案可能是输出序列的代码，以及建议的与 XSLT 中介的指定连接。

OverTheBitStair

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T04:45:06.280

嗨 OverTheBitStair（好昵称！），

对于第一部分，原因很可能是跨域问题，因为 try-它是通过​​浏览器的 java 脚本存根发送消息。您会注意到，当服务本身托管在 ESB 本身中时，这很有效，因为请求通过同一个域。这就是为什么，虽然它可以通过正常的客户端调用完美地工作，但它不能通过 try-it 工作。

对于第二部分，简短的回答是肯定的，这是可能的。就 ESB 而言，我们将其称为轻量级编排引擎，而不是作为中介引擎。这意味着对于轻量级和短期（<1 天）流程，我们可以使用 ESB 解决编排需求，而无需引入业务流程服务器。

为此，我们使用这种称为服务链的方法。它所做的是引入一种从初始服务调用中获取一些输出并在后续调用中使用它的方法。文章[WSO2 ESB by example - Service Chaining](http://wso2.org/library/articles/2011/01/wso2-esb-by-example-service-chaining)应该可以帮助您了解您正在寻找的实现细节。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T19:31:16.103

如果您创建一个服务链场景，其中您的代理服务调用另外两个服务并将结果返回给代理服务的调用者，它看起来像这样：

调用者 --> 代理服务 -- seq_A --> Service1 -- seq_B --> Service2 -- seq_C --> (代理服务响应) --> 调用者

在这种情况下，seq_A 将是代理服务的 in 序列，seq_C 是代理服务的 out 序列，seq_B 是另一个命名序列。

seq_A 的输入，即消息体，将是代理服务的输入。seq_A 将在末尾包含一个发送中介，并且在序列中的那个点，消息上下文将成为 Service1 的输入。发送中介还指向要为回复执行的 seq_B。

在 seq_B 开始时，消息正文包含来自 Service1 的输出。如果要在服务调用之前保留一些消息数据，则需要将其保存在上下文的属性中。在 seq_B 结束时，您将有一个发送中介；此时消息正文应包含对 Service2 的输入，如果 seq_C 是代理服务的输出序列，则发送调解器在这种情况下不需要指向显式回复序列 - 默认情况下将使用该序列。

当 seq_C 正在执行时，此时消息体是来自 Service2 的响应。同样，如果您需要在调用 Service2 之前使用/组合某些数据，则需要将其保存到属性中。

根据每个步骤所需的输入和转换的特定需求，处理起来可能相当简单或有点麻烦。还应该考虑的是在错误场景中需要发生什么，因为这可能会增加一些额外的复杂性，具体取决于要求。

# nginx - nginx根指向错误的文件夹

> ID：10688253
> 
> 赞同：3
> 
> 时间：2012-05-21T15:35:31.630
> 
> 标签：nginx

不认为这是一个复杂的问题，但我没有解决它。

我很乐意将 www.mydomain.com/phpMyAdmin/ 指向 /var/www/phpMyAdmin/htdocs/

我这样做了：

```
server {
    listen 80;
    server_name     localhost;

    location /phpMyAdmin {
            root    /var/www/phpMyAdmin/htdocs/;

            index   index.php;

            #access_log      /var/www/phpMyAdmin/logs/access.log;
            #error_log       /var/www/phpMyAdmin/logs/error.log;
    }

    location ~ \.php$ {
            include fastcgi_params;
            try_files $uri =404;
            fastcgi_pass unix:/var/www/sockets/www.socket;
    }
} 
```

但是调用 www.mydomain.com/phpMyAdmin 时的结果是它试图调用

```
/var/www/phpMyAdmin/htdocs/phpMyAdmin/index.php 
```

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-01T07:17:26.530

这很容易。

Nginx 将`$uri`位置附加到`root`指令（`$document_root`变量）。
您可以改用`alias`指令：

```
location /phpMyAdmin {
 index   index.php;
 alias    /var/www/phpMyAdmin/htdocs/;
 access_log      /var/www/phpMyAdmin/logs/access.log;
 error_log       /var/www/phpMyAdmin/logs/error.log;
} 
```

但是，phpMyAdmin 将不起作用，因为它不是静态文件。
我相信，您需要在 /phpmyadmin 中指定 php 的位置：
`location ~ /phpMyAdmin/\.php$`

# objective-c - 滚动到 UIScrollview 的中心单击 UIButton 以编程方式添加已编辑

> ID：10688255
> 
> 赞同：0
> 
> 时间：2012-05-21T15:35:37.027
> 
> 标签：objective-c, ios5

我有一个 UIbuttons 滚动视图的滚动视图，如下所示：

```
-(void) loadCompeticionSlide{

    float x=0;

    for (int i = 0; i < [categoriasArray count]; i++) {

        NSDictionary *categoria = [categoriasArray objectAtIndex:i];

        UIButton *btn = [UIButton buttonWithType:UIButtonTypeRoundedRect];

        NSString *titleString  = [categoria valueForKey:@"competicion"];  // get button title

        btn.titleLabel.font = [UIFont boldSystemFontOfSize:11.0];

        CGSize fontSize = [titleString sizeWithFont:[UIFont systemFontOfSize:11.0]];

        CGRect currentFrame = btn.frame;

        CGRect buttonFrame = CGRectMake(x, currentFrame.origin.y, fontSize.width + 22.0, fontSize.height + 12.0);

        [btn setFrame:buttonFrame];

        x = x + fontSize.width + 35.0;

        [btn setTitle:titleString forState: UIControlStateNormal];

        int idc = [[categoria valueForKey:@"idc"]intValue];

         [btn addTarget:self action:@selector(cambiarCompeticion:) forControlEvents:UIControlEventTouchUpInside];

         [btn setTag:idc];

        [self.competicionSlide addSubview:btn];

    }

    //[competicionSlide setBackgroundColor:[UIColor whiteColor]];
    competicionSlide.contentSize = CGSizeMake(350,35);
    competicionSlide.layer.cornerRadius = 11;
    competicionSlide.layer.masksToBounds = YES;

} 
```

然后，在添加的选择器 cambiarCompeticion: 中，我点击了按钮，这里我需要使用 scrollRectToVisible: 将点击的 UIButton 滚动到包含它的 UIScrollview 的中心，但我不知道该怎么做。

这是由按钮选择触发的选择器方法，我理解 scrollRectToVisible: 必须被调用：

```
-(void)cambiarCompeticion:(UIButton*)boton{

    int idCompeticion;

    idCompeticion = boton.tag;

    switch (idCompeticion) {
        case 1:
            [self tablaLigaRegular];
            break;

        case 5:
            [self tablaCoparey];
            break;

        case 10:
            [self tablaPlayOff];
            break;    

           }

} 
```

这是图像中的详细信息，在第一张图像中，蓝色箭头表示部分隐藏的左按钮的先前状态，并且一旦单击它就会移动到滚动视图的中间：

![在此处输入图像描述](../Images/7f62e6daaafdbcdaea8cc02001027af0.png)

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:35:00.023

您的**boton**参数（来自*cambiarCompeticion:*选择器）具有您需要的一切。像这样调用（假设“competicionSlide”是一个 UIScrollView）：

```
[self.competicionSlide scrollRectToVisible:boton.frame]; 
```

祝你好运 ！

# ruby-on-rails - # 的未定义方法页面 kaminari“页面”错误。rails_admin

> ID：10688256
> 
> 赞同：1
> 
> 时间：2012-05-21T15:35:58.657
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongoid, kaminari, rails-admin

我正在使用 rails_admin。当我去某个资源时。通过输入网址

```
localhost:3000/admin/rule 
```

比它给我这个错误。代码是：

```
scope = Rule.all
scope.page(1).per(2) 
```

. 上面的代码写在 rails_admin gem.in 一个名为 mongoid.rb 的文件中，该文件位于 adapters 文件夹中。完整的日志是：

```
NoMethodError (undefined method `page' for #<Array:0xcea7408>):
mongoid (2.4.8) lib/mongoid/criteria.rb:385:in  `method_missing'
/home/usman/.rvm/gems/ruby-1.9.2-p290@system/bundler/gems/kaminari-809105ad782a/lib/kaminari/models/mongoid_extension.rb:11:in `page'
/home/usman/.rvm/gems/ruby-1.9.2-p290@system/bundler/gems/rails_admin-069819944cc9/lib/rails_admin/adapters/mongoid.rb:37:in `all'
/home/usman/.rvm/gems/ruby-1.9.2-p290@system/bundler/gems/rails_admin-069819944cc9/app/controllers/rails_admin/main_controller.rb:127:in `get_collection'
/home/usman/.rvm/gems/ruby-1.9.2-p290@system/bundler/gems/rails_admin-069819944cc9/app/controllers/rails_admin/main_controller.rb:39:in `list_entries'
/home/usman/.rvm/gems/ruby-1.9.2-p290@system/bundler/gems/rails_admin-069819944cc9/lib/rails_admin/config/actions/index.rb:30:in `block (2 levels) in <class:Index>' 
```

我应该怎么做才能解决这个错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-10T10:34:03.647

我一直在使用 Mongoid 时断时续地遇到这个问题。有时在 RailsAdmin 中刷新页面会修复它。

我发现问题是 Kaminari 的钩子没有在我的环境中初始化，所以依赖 Kaminari 扩展方法的模型没有它们可用。

我只是从[Kaminari 的 railtie](https://github.com/amatsuda/kaminari/blob/master/lib/kaminari/railtie.rb)中取出以下行并将其放在我的[rails_admin 初始化程序](https://github.com/sferik/rails_admin/blob/master/lib/generators/rails_admin/templates/initializer.erb)的顶部：

```
Kaminari::Hooks.init 
```

现在事情似乎对我有用。但是，我不知道为什么 ActiveSupport 回调没有运行该代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T16:48:41.527

你不能调用**Kaminari**方法`Array`，因为`Rule.all`会返回`Array`。

所以你必须做这样的事情：`Rule.page(1).per(2)`

以下是**Kaminari**用法的文档和示例：

[https://github.com/amatsuda/kaminari](https://github.com/amatsuda/kaminari)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-27T13:55:59.467

用这个

```
Kaminari.paginate_array(Rule.all).page(params[:page]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-14T23:15:56.300

Kader的解决方案很棒！唯一的事情是我发现我必须添加 .per 才能使其工作。

```
Kaminari.paginate_array(Rule.all).page(params[:page]).per(PER_PAGE_RECORDS) 
```

# javascript - 从图像 src 生成缩略图

> ID：10688257
> 
> 赞同：1
> 
> 时间：2012-05-21T15:36:08.750
> 
> 标签：javascript, orientation, aspect-ratio

我需要根据幻灯片生成一些拇指。这个拇指是从每张幻灯片的 img src 直接/动态生成的。

现在我正在为拇指库生成这样的代码：

```
<ul id="galThumb">
<li id="thumb0"><img src="path-to-image" title="Image[0]"></li>
<li id="thumb1"><img src="path-to-image" title="Image[1]"></li>
<li id="thumb2"><img src="path-to-image" title="Image[2]"></li>
...
<li id="thumbn"><img src="path-to-image" title="Image[n]"></li>
</ul> 
```

li 元素保持浮动以与它们形成水平线。

我的问题是用户可以上传任何图像大小和方向的图像，而我无法正确控制拇指的方向。我需要所有的拇指都有特定的大小。例如，60x45 像素。

当用户上传垂直图像或具有不同比例的任何其他图像时，我有一条不规则的拇指线，其中垂直图像占据宽度并且较大的图像高于其他图像。如何在不裁剪图像的情况下获得相等的高度和宽度的拇指？或者只是裁剪一下以适应垂直方向？

我在这里搜索了很多，发现了一些有用的脚本，但没有一个能达到这个目标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T18:59:19.027

我喜欢[jQuery NailThumb](http://www.garralab.com/nailthumb.php)。它非常可定制且易于使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:42:16.940

You could assign the images as backgrounds, then use CCS3 background-size: cover to make it fill the thumbs perfectly. Then use an IE filter for backwards compatibility.

This article explains it best: [http://css-tricks.com/perfect-full-page-background-image/](http://css-tricks.com/perfect-full-page-background-image/)

This would not require any JavaScript.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:39:33.537

您可以使用 jQuery 指定每个图像的宽度/高度。循环遍历`<li>`元素，获取每个图像的纵横比，为每个图像设置相同的高度，并根据纵横比设置 with。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-22T00:44:00.050

试试我在这里提到的这个简单的功能：[https ://stackoverflow.com/a/14731922/382536](https://stackoverflow.com/a/14731922/382536)

```
/**
* Conserve aspect ratio of the orignal region. Useful when shrinking/enlarging
* images to fit into a certain area.
*
* @param {Number} srcWidth Source area width
* @param {Number} srcHeight Source area height
* @param {Number} maxWidth Fittable area maximum available width
* @param {Number} maxHeight Fittable area maximum available height
* @return {Object} { width, heigth }
*/
function calculateAspectRatioFit(srcWidth, srcHeight, maxWidth, maxHeight) {

    var ratio = Math.min(maxWidth / srcWidth, maxHeight / srcHeight);

    return { width: srcWidth*ratio, height: srcHeight*ratio };
} 
```

# css - 我想让两个 div 扩展到一个容器 div 的宽度，但是我有水平空间

> ID：10688261
> 
> 赞同：0
> 
> 时间：2012-05-21T15:36:37.110
> 
> 标签：css, html, width, liquid

我有一个简单的网页，在一个容器 div 中有两个 div。

```
<div id="container">
  <div id="left"></div>
  <div id="right"></div>
</div>

#container {
  height: 50px;
  width: 100%;
}

#left, #right {
  float: left;
  height: 100%;
  line-height: 100%;

} 
```

两者并排，不需要随着内容扩展，因为内容不会填充 div，但 div 需要具有相同的填充量并填充#container div。*我之前并不清楚，但是两个 div 需要具有相同的填充，但宽度不同。一个包含姓名，另一个包含电子邮件地址，因此第二个要长得多。*

我无法让 div 填充容器 div 的宽度。#right div 后面有一个空格。

此外，一切都基于百分比，而不是固定的布局，仅 CSS。

看起来很简单，所以有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:43:08.803

您目前没有在两个浮动元素上设置宽度。添加一个解决了所有问题：

```
#container {
  overflow: hidden;
  background: green;
}

#left, #right {
  float: left;
  box-sizing: border-box;
  width: 50%;
  padding: 5% 10%;
  text-align: center;
}

#left  { background: red  }   
#right { background: blue }
​ 
```

小提琴：http: [//jsfiddle.net/u4G7c/1/](http://jsfiddle.net/u4G7c/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:42:11.503

```
<div id="container">
  <div id="left"></div>
  <div id="right"></div>
</div>

#container {
  height: 50px;
  width: 100%;
}

#left, #right {
  float: left;
  width:46%; padding:2%;
  height: 96%;
  line-height: 100%;

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T15:43:58.330

没有边框和填充，给`DIV`sa `width`。`50%`如果您需要边框和填充，请将它们设置`width`为`50%`并设置`box-sizing`为`border-box`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T01:38:10.840

我做了一些更改，但最重要的是`#right`删除`float: left`然后[添加`overflow: hidden`](http://colinaarts.com/articles/the-magic-of-overflow-hidden/#making-room-for-floats).

**见：http:** [//jsfiddle.net/thirtydot/2AS58/](http://jsfiddle.net/thirtydot/2AS58/)

**HTML：**

```
<div id="container">
    <div id="left">left</div>
    <div id="right">right@sdfgsdfsdf.com</div>
</div>​ 
```

**CSS：**

```
#container {
    border: 1px solid red;
    margin: 10px;
}

#left, #right {
    padding: 10px;
    height: 30px;
    line-height: 30px;
    border: 1px solid blue;
}
#left {
    float: left;
}
#right {
    overflow: hidden;
}​ 
```

# gwt - 如何在 GWT 中创建单元格浏览器

> ID：10688268
> 
> 赞同：0
> 
> 时间：2012-05-21T15:37:21.093
> 
> 标签：gwt

我正在尝试创建一个单元浏览器，从[GWT Showcase获得帮助](http://gwt.google.com/samples/Showcase/Showcase.html#!CwCellBrowser)

在这里我正在创建 CellBrowser

```
 final MultiSelectionModel<MyDTO> selectionModel = new MultiSelectionModel<MyDTO>();

        CellBrowser cellBrowser = new CellBrowser(new ContactTreeViewModel(selectionModel), null); 
```

我没有得到的是，什么是 ContactTreeViewModel？我已经阅读了 GwtShowcase 中的类 contacttreeviewmodel ，但无法理解，它到底是什么

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:51:17.007

这是您的*视图模型*，即树视图和您的实际模型之间的接口（用 MVC 或 MVP 的说法）。（`CellBrowser`a 相同`CellTree`）将询问您`TreeViewModel`树的节点（以`NodeInfo`对象的形式）、它们的子节点、如何显示它们（关联的`Cell`）、如何*选择*它们（关联的`SelectionModel`：您可以在其中拥有一棵树只能从第 2 级选择节点，和/或第 2 级每个*分支*只能选择一个节点，或任何节点，或...），最后如何更新它们（the `ValueUpdater`）。

基本上（免责声明：这是对流程的简化！），树中的每一层都是 a`CellList`负责`NodeInfo`的。将`setDataDisplay`与 相关联，`CellList`以便`NodeInfo`模型的更改可以反映在树中，然后、`Cell`和都具有与 a 相同的行为。要求您提供它们以设置. 扩展节点时，会要求您提供与扩展节点关联的节点，并使用它来创建新的.`ProvidesKey``SelectionModel``ValueUpdater``CellList``CellBrowser``NodeInfo``CellList``CellBrowser``TreeViewModel``NodeInfo``CellList`

因此，来自 Showcase 是将联系人（模型）显示为树`ContactTreeViewModel`的特定实现。`TreeViewModel`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:40:58.477

GWT 展示是您可以使用代码示例做什么的示例。

我认为在尝试从头开始理解这样的代码之前，您应该阅读单元小部件的文档。

这是文档，阅读它，然后重新尝试理解代码。

[https://developers.google.com/web-toolkit/doc/latest/DevGuideUiCellWidgets#available](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiCellWidgets#available)

# cocoa - 从带有视图的 xib 加载无边框窗口

> ID：10688270
> 
> 赞同：0
> 
> 时间：2012-05-21T15:37:39.813
> 
> 标签：cocoa, nsview, nswindow

我正在尝试从程序中的 .xib 加载无边框窗口。`[[[NSWindow]] initWithContentRect:styleMask:backing:defer:]`我可以通过如下覆盖加载无边框窗口：

```
- (id)initWithContentRect:(NSRect)contentRect styleMask:(NSUInteger)aStyle backing:(NSBackingStoreType)bufferingType defer:(BOOL)flag {

    self = [super initWithContentRect:contentRect styleMask:NSBorderlessWindowMask backing:bufferingType defer:flag];
    if (!self) {
        return nil;
    }

    [self setOpaque:NO];
    [self setHasShadow:YES];
    [self setLevel:NSFloatingWindowLevel];
    [self setBackgroundColor:[NSColor clearColor]];
    [self setAlphaValue:1.0];

    // Ignore events
    [self setIgnoresMouseEvents:YES];

    return self;    
} 
```

当调用另一个包含`[self orderFront:self];`的方法时，会显示一个窗口。但是，我有一个单独的 .xib 文件，其中创建了一个我想在调用此方法时显示的窗口。我将文件的所有者设置为 NSApplication 并且窗口本身属于包含上述代码的类。当我用 调用方法时 `[self orderFront:self];`，如何在 xib 中加载窗口并显示它而不是此类创建窗口？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:58:45.823

如果我了解您要执行的操作，则可以使用从单独的 nib（或 xib）文件加载`NSWindowController`。`NSWindow`子类 NSWindowController，并把你的控制器代码放在那里。在 xib 文件中创建该对象并将其设置为文件的所有者。将 NSWindow 链接到 NSWindowController 的代理出口。

然后就很简单了：

```
NSWindowController * windowController = [[[YourWindowClass alloc] initWithWindowNibName:@"YourWindowClass"] autorelease];
NSWindow * sheet = [windowController window]; 
```

# oracle - 是否可以选择 DENSE_RANK() 字段的最大值作为字段？

> ID：10688272
> 
> 赞同：0
> 
> 时间：2012-05-21T15:37:42.227
> 
> 标签：oracle, plsql

我的选择之一以：

```
DENSE_RANK() OVER(ORDER BY a.distance, a.state || a.idnum, a.taxid, a.location) row_num 
```

给结果集一个行号，会有重复。

我想知道如何在同一个选择中使用类似或相关的语句来包含一个字段highest_row_num 来获取由上述语句创建的所有row_num 字段中的最高的一个。任何的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:58:41.353

你可以这样做：

```
select v.*, max(row_num) over () as max_row_num
from 
( select ...,
  DENSE_RANK() OVER(ORDER BY a.distance, a.state || a.idnum, a.taxid, a.location) row_num
  from ...
) 
```

# sql-server - sql server 备份脚本

> ID：10688274
> 
> 赞同：12
> 
> 时间：2012-05-21T15:37:46.070
> 
> 标签：sql-server, sql-server-2008

我尝试为我的一个非常小的 sql server express 2008 数据库编写备份脚本。我的要求是每晚做一次完整备份，保留最后五个备份。这是我写的一个尝试，并希望得到关于我是否做得对的反馈？感谢你的协助。

```
 declare @backupfilename nvarchar(100)
    set @backupfilename='c:\...location..\filename_'+convert(varchar(10),getdate(),112) + '.bak'

    BACKUP DATABASE [dbname] TO  DISK = @backupfilename 
    WITH  RETAINDAYS = 5, NOFORMAT, NOINIT,  NAME = N'Full Database Backup Name', NOSKIP,
    NOREWIND, NOUNLOAD,  STATS = 10
    GO
    declare @backupSetId as int
    select @backupSetId = position from msdb..backupset where database_name=N'dbname'
    and backup_set_id=(select max (backup_set_id) from msdb..backupset where 
    database_name=N'dbname' )
    if @backupSetId is null begin raiserror(N'Verify failed. Backup information for database  
    ''dbname'' not found.', 16, 1) end
    RESTORE VERIFYONLY FROM  DISK =@backupfilename  WITH  FILE = @backupSetId,  NOUNLOAD,  NOREWIND
    GO 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-21T19:47:31.547

我强烈推荐[Ola 的备份存储过程](http://ola.hallengren.com/sql-server-backup.html)。它们得到很好的支持并且非常坚固。如果您对使用它们感到不舒服，您至少可以在编写自己的例程时看看它们。

# api - 如何在 Amazon cloudfront API 上执行 POST 请求

> ID：10688278
> 
> 赞同：2
> 
> 时间：2012-05-21T15:38:02.760
> 
> 标签：api, amazon-cloudfront

如何向 Amazon cloudfront API 发出 POST 控制请求？在文档中它说：

```
Send a CloudFront control API request that is similar to the following example.

POST /2012-05-05/origin-access-identity/cloudfront HTTP/1.1
[Required headers]  

<?xml version="1.0" encoding="UTF-8"?>
<CloudFrontOriginAccessIdentityConfig xmlns="http://cloudfront.amazonaws.com/doc/2012-05-05/">
  <CallerReference>20120229090000</CallerReference>   
  <Comment>Your comments here</Comment>
</CloudFrontOriginAccessIdentityConfig> 
```

我四处寻找一些信息，但我不知道该怎么做。我可以通过像[这里](https://stackoverflow.com/questions/9802788/call-a-rest-api-in-php "这里")这样的卷曲请求来做些什么吗？

非常感谢任何帮助！此刻我感到有些失落。

非常感谢！

***更新***

我现在做这样的事情，仍然没有工作..有什么帮助吗？

```
<?php
$xml = 'POST /2012-05-05/origin-access-identity/cloudfront HTTP/1.1
Host: cloudfront.amazonaws.com
Authorization: [AWS authentication string]
Date: [time stamp]
[Other required headers]    

<?xml version="1.0" encoding="UTF-8"?>
<CloudFrontOriginAccessIdentityConfig xmlns="http://cloudfront.amazonaws.com/doc/2012-05-05/">
   <CallerReference>ref</CallerReference>
   <Comment>The comment.</Comment>
</CloudFrontOriginAccessIdentityConfig>
';

$opts = array(
    'http'=>array(
        'method'=>'POST',
        'header'=>"Content-Type: text/plain\r\n" .
            $auth."\r\n",
        'content'=>$xml
    )
);

$context = stream_context_create($opts);
$url = 'https://cloudfront.amazonaws.com/2012-05-05/origin-access-identity/cloudfront';
$fp = fopen($url, 'r', false, $context);
fpassthru($fp);
$response = stream_get_contents($fp);
print_r($response);
fclose($fp);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T03:54:02.320

FireFox 附加海报必须提供帮助。 [https://addons.mozilla.org/en-US/firefox/addon/poster/](https://addons.mozilla.org/en-US/firefox/addon/poster/) 其他类似工具： [是否有允许向网页发送任意 POST 数据的 Firefox 扩展（或任何其他浏览器）？](https://stackoverflow.com/questions/725998/are-there-firefox-extension-or-any-other-browser-that-allow-to-send-arbitrary)

# c# - asp.net 网站中的 webbrowser 类

> ID：10688281
> 
> 赞同：2
> 
> 时间：2012-05-21T15:38:13.777
> 
> 标签：c#, asp.net, webbrowser-control

我有一个要求，需要访问网页并对其进行截图。

为此，我必须创建一个 ASP.NET，以便用户可以输入网站 URL。

我试图创建一个 Web 浏览器控件.. 但后来意识到我无法在 asp.net 网站中创建 Web 浏览器控件..

我正在尝试做这样的事情[http://pietschsoft.com/post/2008/07/C-Generate-WebPage-Thumbmail-Screenshot-Image.aspx](http://pietschsoft.com/post/2008/07/C-Generate-WebPage-Thumbmail-Screenshot-Image.aspx)有人可以帮助我如何开始，因为我知道我们只能在 Windows 窗体中使用 Web 浏览器组件，而不能在网站上使用。

我不确定我的问题是不是太傻了，我错过了什么..有人可以帮助我吗

PS：如果我的问题不清楚，请告诉我。我会尝试更具体！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-07-04T13:59:48.677

我们需要添加带有线程的网络浏览器，否则我们将 **无法实例化 ActiveX 控件“8856f961-340a-11d0-a96b-00c04fd705a2”，因为当前线程不在单线程单元中。**错误

这是我们可以让 webbrowser 在 asp.net 网页中工作的方式

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Threading;
using System.Windows.Forms;

/// <summary>
/// Summary description for CustomBrowser
/// </summary>
public class CustomBrowser
{
    public CustomBrowser()
    {
        //
        // TODO: Add constructor logic here
        //
    }

    protected string _url;
    string html = "";
    public string GetWebpage(string url)
    {
        _url = url;
        // WebBrowser is an ActiveX control that must be run in a
        // single-threaded apartment so create a thread to create the
        // control and generate the thumbnail
        Thread thread = new Thread(new ThreadStart(GetWebPageWorker));
        thread.SetApartmentState(ApartmentState.STA);
        thread.Start();
        thread.Join();
        string s = html;
        return s;
    }

    protected void GetWebPageWorker()
    {
        using (WebBrowser browser = new WebBrowser())
        {
            //  browser.ClientSize = new Size(_width, _height);
            browser.ScrollBarsEnabled = false;
            browser.ScriptErrorsSuppressed = true;
            browser.Navigate(_url);

            // Wait for control to load page
            while (browser.ReadyState != WebBrowserReadyState.Complete)
                Application.DoEvents();

            html = browser.DocumentText;

        }
    }

} 
```

在网页中

```
CustomBrowser browser = new CustomBrowser();
string s = browser.GetWebpage("http://localhost:8781/WebSite3/Default3.aspx");
Response.Write(s); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T15:46:05.313

您可以在 ASP.net 中使用 WebBrowser 控件服务器端。只需添加对 System.Windows.Forms 的引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T00:09:06.440

您可能可以使用 Web 处理程序文件 (.ashx) 而不是 .aspx。这将允许您在没有网络表单的情况下使用网络浏览器控件。

# ios - 使用远程 IO 针对设定长度的节拍器录制

> ID：10688286
> 
> 赞同：4
> 
> 时间：2012-05-21T15:38:36.067
> 
> 标签：ios, core-audio, audioqueue, remoteio

我能够创建我想要的 avaudioplayer 和 avaudiorecorder 的确切功能，但当然遇到了延迟问题。因此，在阅读了网络上的几乎所有文章并查看了大量示例代码之后，我仍然不确定如何实现以下目标：

1.  用户选择使用预卷/倒计时录制 2 小节长（每小节 4 拍）的样本
2.  用户点击记录
3.  节拍器开始，以 4 拍计（第一拍重音）
4.  该应用程序会在下一个小节开始时自动开始录制
5.  应用程序在第 3 小节结束时自动关闭录制（2 小节 + 前贴片）
6.  然后，用户可以播放他们的录音或删除它并重新开始。

因此，使用 avaudioplayer 和 avaudiorecorder，我只需使用 audacity 将节拍器设置为正确的 bpm（为应用程序设置 bpm）创建了一个“caf”。然后我设置并播放 avaudioplayer 并使用 audiodidfinishsuccessfully 委托方法，执行一些逻辑来启动录音机，重新启动播放器，保持循环计数等以关闭录音和音频。

正如我所提到的，我几乎能够实现我所追求的用户体验，但延迟问题是不可接受的。

我一直在使用音频单元和远程 IO，并设置了一个带有播放回调和记录器回调等的项目，但现在面临如何根据上述描述进行这项工作的问题。我正在尝试为初学者解决以下问题：

1.  如果我创建一个 1 beat caf 文件，我如何利用音频单元和远程 IO 播放 x 节拍然后停止？
2.  我如何进行前卷并在 4 拍后开始录音回调

谁能给我一些想法或指出我正确的方向。正如我所提到的，我已经进行了大量研究，包括购买核心有声读物，阅读 atastypixel.com、timbolstad.com 等上的每篇文章，并浏览了苹果文档。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-03-21T16:12:37.870

我启动了一个 NSTimer。使用基于 BPM（每分钟节拍数）/60 的值。因此，如果用户想要记录一个包含计数的 2 小节文件，可能会执行以下操作：

```
//timer interval=100BPM/60secs per minute
timerInterval=100/60;

    metroTimer = [NSTimer scheduledTimerWithTimeInterval:timerinterval target:self selector:@selector(blinkMetroLight) userInfo:nil repeats:YES];

 - (void)blinkMetroLight
    {

        if(beatNumber == 0)
        {
            beatNumber = 1;

        }
        else if (beatNumber == 5)
        {
            [self audioProcessorStart];
        }
        if (beatNumber == 8)
        {

                [self audioProcessorStop];
                [metroTimer invalidate]; metroTimer = nil;
        }

    beatNumber++ 
    } 
```

# php - 使用 jQuery 进行简单的电子邮件验证

> ID：10688289
> 
> 赞同：2
> 
> 时间：2012-05-21T15:38:54.510
> 
> 标签：php, jquery

我有一个使用 PHP 动态生成的表单。

电子邮件有多个字段。当表单加载预先填充的数据时，我想进行一个非常基本的电子邮件验证。那些包含格式错误的电子邮件的字段需要突出显示并禁用表单提交。

到目前为止，这是我所拥有的，但我不确定如何让这一切正常工作。

**JS**

```
function validateEmail(email) {
    var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
    return emailReg.test( email );
}

$("#mySubmitButton").click(function() {
    var email = jQuery("input[name=\'email[]\']").val();
    if (!validateEmail(email)) {
        event.preventDefault();
        $(this).css("border","1px solid red");
        alert("Bad email. Please correct before submitting.");
    }
}); 
```

**PHP**

```
$pairs = array_filter(explode(",", $_POST['email']));

foreach( $pairs as $pair ) {

   $i++;

   echo '<input type="text" name="email['.$i.']" value="'.$output['1'].'">

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:46:20.917

您可以像这样验证所有电子邮件

```
jQuery("input[type=text][name^=email]").each(function()
{
  if(!validateEmail($(this).val()))
  {
    alert("Email not validated,");
    //here you can figure out the invalid emails
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:40:37.910

```
var email = jQuery("input[type=text][name^=email]").val(); 
```

`[name^=email]`将选择所有以电子邮件*开头*`text`和类型为.

详情见**[这里](http://api.jquery.com/attribute-starts-with-selector/)**_

来自电子邮件验证检查**[这里](https://stackoverflow.com/questions/46155/validate-email-address-in-javascript)**

# ios - xcode 和 waze 集成

> ID：10688290
> 
> 赞同：5
> 
> 时间：2012-05-21T15:39:01.590
> 
> 标签：ios, xcode

我正在尝试将我的**应用程序**与[waze](http://www.waze.com/)集成。

有谁知道我如何调用位智并发送坐标？

我没有找到任何关于它的 API 或其他信息..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-20T12:37:00.987

```
- (void) navigateToLatitude:(double)latitude
                  longitude:(double)longitude
{
   if ([[UIApplication sharedApplication] canOpenURL:[NSURL URLWithString:@"waze://"]]) {
      //Waze is installed. Launch Waze and start navigation
      NSString *urlStr = [NSString stringWithFormat:@"waze://?ll=%f,%f&navigate=yes", latitude, longitude];
      [[UIApplication sharedApplication] openURL:[NSURL URLWithString:urlStr]];
   } else {
      //Waze is not installed. Launch AppStore to install Waze app
      [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http://itunes.apple.com/us/app/id323229106"]];
   }
} 
```

# php - 如何在 Magento 中重写类别 URL？

> ID：10688291
> 
> 赞同：0
> 
> 时间：2012-05-21T15:39:03.343
> 
> 标签：php, magento, routes

我有以下类别结构：

默认
->myCategory1
-->SubCat11
---->Category111
---->Category112
-->SubCat12
........
->myCategory2
-->SubCat21
---->Some_category

现在我的类别网址是

```
http://<host_name>/myCategory1/SubCat11/Category11 
```

或者

```
http://<host_name>/myCategory2/SubCat21/Some_category 
```

我想做这样的类别网址结构：

```
http://<host_name>/SubCat11/Category111 
```

或者

```
http://<host_name>/SubCat21/Some_category 
```

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:48:22.257

因为您实际上是在尝试向后执行此操作，所以在 Magento 中没有可预见的方法来执行此操作。

您也许可以在 .htaccess 文件中重写 URL。您通常会按如下方式创建规则：

```
RewriteRule ^/SubCat11/Category111/ /Category111/SubCat11 [L,R=301] 
```

这似乎相当麻烦。也许可以使用通配符进行改进：

```
RewriteRule ^/([^/]+)/([^/]+)/ /$2/$1 [L,R=301] 
```

# sql - JPQL：按日期分组

> ID：10688292
> 
> 赞同：0
> 
> 时间：2012-05-21T15:39:07.587
> 
> 标签：sql, oracle, hibernate, jpa, jpql

我有一张表，每天都有几条记录，每条记录都有一个代表日期时间的列。我想选择每天的记录数，所以我想在`JPQL`如下查询中创建：

```
SELECT COUNT(*) FROM ORDERS o GROUP BY TRUNC(o.ORDER_DATE) 
```

不幸的是，`JPQL`没有像`TRUNC`...这样的功能 :( 我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-02-07T08:55:06.117

使用演员表！那可行

```
@Query("select new DBClass(COUNT(c.field1) as count,cast(c.created as date)) from Table c GROUP BY cast(c.created as date)") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:51:43.310

我不确定它是否有效，但是您是否使用了方法功能？它会像

```
Expression<Date> truncExpr = cb.function("TRUNC",Date.class,orders.get("orderDate"),"MM");
criteria.groupBy(truncExpr); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:03:04.523

Hibernate 在解释 JPQL 查询时理解它所知道的任何函数。如果你使用的方言理解 TRUNC，你会没事的。如果没有，请创建一个自定义方言来注册该 TRUNC 函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-08T19:25:26.570

我认为这应该是诀窍：

```
SELECT COUNT(*) FROM ORDERS o GROUP BY FUNC('TRUNC', o.ORDER_DATE) 
```

# java - 如何在eclipse中管理多个包？

> ID：10688297
> 
> 赞同：2
> 
> 时间：2012-05-21T15:39:29.777
> 
> 标签：java, eclipse, package, explorer

> **可能重复：**
> [如何在 Eclipse 包资源管理器中查看分层包结构](https://stackoverflow.com/questions/3915961/how-to-view-hierarchical-package-structure-in-eclipse-package-explorer)

如果我有很多包，如何在 Eclipse 中组织它们？我希望它们都在同一个工作区中，并且我希望能够快速来回移动。所以，如果我有包 A、B、C、D、E，我希望它们在像“A thru E”这样的文件夹中，然后我有包“F、G、H、I、J”，我想要它们在像“F thru J”这样的文件夹中......我该怎么做？我不想将它们放在单独的工作区中，也不想在包资源管理器中单独列出所有这些包。我想让我的包浏览器保持整洁，我只想随时显示三到四个包。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:44:36.853

包 AE 有什么共同点吗？如果是这样，只需为他们创建一个单独的项目 - 同样为 FJ 创建一个项目。不过，我不会*随意*开始这样做- 如果您看到 10 个包裹真的很重要吗？我每天使用的次数远不止这些，而且它不会打扰我。

但是，我*确实*发现使用分层包表示而不是平面表示会有所不同 - 这使得管理大量涉及深层“层次结构”的包变得更加容易*。*尽管就语言/JVM 而言，包层次结构是平坦的，但它对*我*作为开发人员来说很有意义。

# jquery - 使用 jQuery Mobile App 登录时的安全问题对话框

> ID：10688300
> 
> 赞同：0
> 
> 时间：2012-05-21T15:39:41.633
> 
> 标签：jquery, user-interface, jquery-mobile, dialog

我目前正在寻找一种更好的方法来做到这一点。我必须在我正在使用的这个应用程序上创建一系列基于风险的安全性对话框弹出窗口。我用 simpledialog2 设置了对话框，但我知道可能有更好的方法，也许只有一个内容动态变化的对话框？此外，对于这些单独的对话框，我遇到了将最后一个对话框设置为关闭的问题，它也会关闭下一个对话框。如果有人知道在这种情况下什么是最好的，我将非常感谢您的帮助。我花了几天的时间研究并没有找到关于这个主题的任何信息。谢谢！

这是代码：

```
$(document).delegate('#security-questions', 'click', function() {
            $('<div>').simpledialog2({
              mode: 'blank',
              headerText: 'Security Questions',
              headerClose: true,
              blankContent : 
                "<div class='question-content'><p>Please choose 5 of the following security questions and provide answers:</p><div data-role='fieldcontain'><select name='question-one-select' id='question-one-select'><option value='None'>Please choose a question:</option><option value='1'>What is your favorite pizza topping?</option><option value='2'>Who is the person you admire the most?</option><option value='3'>Who is your favorite actor, actress or celebrity?</option><option value='4'>What is your favorite television show?</option><option value='5'>What is the name of the first person you were romantically interested in?</option></select></div><div id='firstq-div' data-role='fieldcontain'><input type='text' name='question-one' id='question-one' placeholder='Answer' /></div><a href='#' id='second-question' data-role='button' data-rel='dialog'>Next</a></div>"
            });
        });

        $(document).delegate('#second-question', 'click', function() {
            $('<div>').simpledialog2({
              mode: 'blank',
              headerText: 'Question 2',
              headerClose: true,
              blankContent : 
                "<div class='question-content'><div data-role='fieldcontain'><select name='question-two-select' id='question-two-select'><option value='None'>Please choose a question:</option><option value='1'>What is your favorite pizza topping?</option><option value='2'>Who is the person you admire the most?</option><option value='3'>Who is your favorite actor, actress or celebrity?</option><option value='4'>What is your favorite television show?</option><option value='5'>What is the name of the first person you were romantically interested in?</option></select></div><div id='secondq-div' data-role='fieldcontain'><input type='text' name='question-two' id='question-two' placeholder='Answer' /></div><a href='#' id='third-question' data-role='button' data-rel='dialog'>Next</a></div>"
            });
        });

        $(document).delegate('#third-question', 'click', function() {
            $('<div>').simpledialog2({
              mode: 'blank',
              headerText: 'Question 3',
              headerClose: true,
              blankContent : 
                "<div class='question-content'><div data-role='fieldcontain'><select name='question-three-select' id='question-three-select'><option value='None'>Please choose a question:</option><option value='1'>What is your favorite pizza topping?</option><option value='2'>Who is the person you admire the most?</option><option value='3'>Who is your favorite actor, actress or celebrity?</option><option value='4'>What is your favorite television show?</option><option value='5'>What is the name of the first person you were romantically interested in?</option></select></div><div id='thirdq-div' data-role='fieldcontain'><input type='text' name='question-three' id='question-three' placeholder='Answer' /></div><a href='#' id='fourth-question' data-role='button' data-rel='dialog'>Next</a></div>"
            });
        });

        $(document).delegate('#fourth-question', 'click', function() {
            $('<div>').simpledialog2({
              mode: 'blank',
              headerText: 'Question 4',
              headerClose: true,
              blankContent : 
                "<div class='question-content'><div data-role='fieldcontain'><select name='question-four-select' id='question-four-select'><option value='None'>Please choose a question:</option><option value='1'>What is your favorite pizza topping?</option><option value='2'>Who is the person you admire the most?</option><option value='3'>Who is your favorite actor, actress or celebrity?</option><option value='4'>What is your favorite television show?</option><option value='5'>What is the name of the first person you were romantically interested in?</option></select></div><div id='fourthq-div' data-role='fieldcontain'><input type='text' name='question-four' id='question-four' placeholder='Answer' /></div><a href='#' id='fifth-question' data-role='button' data-rel='dialog'>Next</a></div>"
            });
        });

        $(document).delegate('#fifth-question', 'click', function() {
            $('<div>').simpledialog2({
              mode: 'blank',
              headerText: 'Question 5',
              headerClose: true,
              blankContent : 
                "<div class='question-content'><div data-role='fieldcontain'><select name='question-five-select' id='question-five-select'><option value='None'>Please choose a question:</option><option value='1'>What is your favorite pizza topping?</option><option value='2'>Who is the person you admire the most?</option><option value='3'>Who is your favorite actor, actress or celebrity?</option><option value='4'>What is your favorite television show?</option><option value='5'>What is the name of the first person you were romantically interested in?</option></select></div><div id='fifthq-div' data-role='fieldcontain'><input type='text' name='question-five' id='question-five' placeholder='Answer' /></div><a href='#' id='finish-question' data-role='button' data-rel='dialog'>Done</a></div>"
            });
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T08:53:04.867

在回答关闭问题时，您需要调用该方法来关闭当前对话框。最简单的方法是在`$.mobile`. 在打开后续对话框的处理程序开始处，在打开下一个对话框之前关闭当前

简化代码示例：

```
$( '#dialog2' ).click( function(){
  // close the current dialog
  $.mobile.sdCurrentDialog.close();

  // open the next one
  $('<div>').simpledialog2( {...} );
}); 
```

要替换当前内容，请将您的处理程序更改为仅使用 updateBlank() 方法。

```
$( '#dialog2' ).click( function(){
  // update the contents in the current blank-mode dialog
  $.mobile.sdCurrentDialog.updateBlank( '<p>The next question</p>...' );
}); 
```

这一切都清楚地记录在文档的第 3 页上。转到 simpledialog2 的主页。只需单击主菜单链接即可`Methods, Events and Data`到达此处：[http ://dev.jtsage.com/jQM-SimpleDialog/demos2/event.html](http://dev.jtsage.com/jQM-SimpleDialog/demos2/event.html)

# sql-server - 排除 t-sql 中的多个值

> ID：10688301
> 
> 赞同：0
> 
> 时间：2012-05-21T15:39:42.497
> 
> 标签：sql-server, tsql

我有一个非常大的 sql 语句，我必须对其进行修改。在其中一个表中有四个 int 列，我必须排除 2 个集合。如果我只想排除一个表的值，这很简单，请使用 except 语句。我可以做这个：

```
select *
from Table Z
except(
select *
from Table Z
where (A= 2 and B= 10 and C= 3 and D= 90) 
or (A= 2 and B= 17 and C= 100 and D= 90)) 
```

但是我无法使用 where 语句让它工作。我只希望排除这两组组合。在真实的语句中，有一个连接六个不同的表和 select 中的各种 case 语句。

我已经尝试了一些东西，但似乎没有任何效果。

任何想法将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T15:43:40.857

为什么复杂`EXCEPT`？这不起作用吗？：

```
SELECT  *
FROM Table Z
WHERE NOT (  ( A= 2 and B= 10 and C= 3 and D= 90) 
          OR ( A= 2 and B= 17 and C= 100 and D= 90)
          ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:44:16.347

只需使用`NOT`运算符：

```
SELECT * 
  FROM Table Z 
 WHERE NOT ((A = 2 and B = 10 and C = 3 and D = 90)  
            OR (A = 2 and B = 17 and C = 100 and D = 90)) 
```

或者，应用[德摩根定律](http://en.wikipedia.org/wiki/De_Morgan%27s_laws)，

```
SELECT * 
  FROM Table Z 
 WHERE (NOT (A = 2 and B = 10 and C = 3 and D = 90))
   AND (NOT (A = 2 and B = 17 and C = 100 and D = 90)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:43:21.703

尝试不要在例如

```
SELECT * FROM Table1 WHERE Table1.ID NOT IN (SELECT ID FROM Table1 WHERE Somewhereclause) 
```

在你的情况下：

```
select *
from Table Z
WHERE Z.ID NOT IN (
select ID
from Table Z
where (A= 2 and B= 10 and C= 3 and D= 90) 
or (A= 2 and B= 17 and C= 100 and D= 90)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T15:44:37.883

这里有两种方法：

```
SELECT * FROM TABLE Z 
    WHERE Z.ID NOT IN 
    (SELECT ID FROM TABLE Z WHERE (A= 2 AND B= 10 AND C= 3 AND D= 90) OR (A= 2 AND B= 17 AND C= 100 AND D= 90)) 
```

第二种方式可能会表现得更好......不是 IN 可能有问题：

```
SELECT * FROM TABLE Z
    LEFT JOIN TABLE Z2
    ON 
    Z.Id = Z2.ID
    WHERE (Z2.A= 2 AND Z2.B= 10 AND Z2.C= 3 AND Z2.D= 90) OR (Z2.A= 2 AND Z2.B= 17 AND Z2.C= 100 AND Z2.D= 90)) WHERE Z2 IS NOT NULL 
```

密切关注第二个...我不是 100% 确定它。我会先尝试第一个，如果你有性能问题，只使用第二个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T15:47:45.180

这将为您提供与示例查询相同的结果，并且只需要一个 SELECT 语句。

```
SELECT *
FROM Table_Z
WHERE NOT (A= 2 and B= 10 and C= 3 and D= 90) 
   AND NOT (A= 2 and B= 17 and C= 100 and D= 90) 
```

# java - 如何在 Java 的 tableview 中创建一个 qcombobox？

> ID：10688305
> 
> 赞同：0
> 
> 时间：2012-05-21T15:39:53.350
> 
> 标签：java, qt, qtableview, qcombobox

我有一个 5 列的表格视图（模型）。在其中一个中，我想在组合框中显示 2 个选项。选项是预先确定的，所以我认为没有必要使用委托。我错了吗？

```
for (int state=0; state <3; state++)
{
    QStandardItem item = new QStandardItem();
    item.setEditable( false );
    item.setTextAlignment( Qt.AlignmentFlag.AlignCenter );

    switch (state)
    {
        case 0: 
            item.setText( "Column 0" );
            item.setEditable( true );
            break;
        case 1:
            item.setText( "Column 1" );
            item.setEditable( true );
            break;
        case 2:
            //create a new combobox
            break;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T20:03:53.980

我认为您必须（或至少应该）使用委托。委托是将视图（tableview 基本上是一个布局并通过模型+委托检索其内容）与模型连接的对象。该模型不（它不应该）对其内容的呈现方式负责。这就是委托的作用——当视图要求它这样做时，它会将数据（模型）“转换”为可呈现的实体。模型不能（也不应该）为其数据声明视图。

# windows-phone-7 - 在我的网络浏览器中插入 cookie

> ID：10688314
> 
> 赞同：0
> 
> 时间：2012-05-21T15:40:43.327
> 
> 标签：windows-phone-7

我在 30 分钟前发布的旧帖子已删除所有回复。首先，我想为我的英语向所有版主道歉，因为我每次在这个论坛上写东西时都纠正了我 :)。

好的，基本上问题是我需要在我的 WebBrowser Cookies 中添加一个令牌，用于主要使用 webviews 完成的银行应用程序。我编写了一个显示 cookie 的测试网页。我试着这样击球：

```
private void MainPage_Loaded(object sender, RoutedEventArgs e)
        {

            string testCookies = "http://devlbpaccescomptewp7.clicmobile.com/test-read-cookie.html?timeStamp=";
            testCookies += DateTime.Now.Millisecond;
            Cookie cookie = new Cookie("cookie", "lol");
            Uri test = new Uri(testCookies, UriKind.Absolute);
            CookieContainer cc = new CookieContainer();
            cc.Add(test,cookie);

            HttpWebRequest req = (HttpWebRequest)HttpWebRequest.Create(testCookies);
            req.UserAgent = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.0.3705;)";
            req.Method = "POST";
            req.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
            req.CookieContainer = cc;

            //HttpWebResponse myWebResponse = (HttpWebResponse)req.get
            req.BeginGetResponse(new AsyncCallback(ReadWebRequestCallback), req); 

            uriList = new List<Uri>();

           // wB.Navigate(test);
           // wB.Navigate(new Uri(home, UriKind.Absolute));
           wB.Navigating += new EventHandler<NavigatingEventArgs>(wB_Navigating);
        }

        private void ReadWebRequestCallback(IAsyncResult callbackResult)
        {
            HttpWebRequest myRequest = (HttpWebRequest)callbackResult.AsyncState;
            HttpWebResponse myResponse = (HttpWebResponse)myRequest.EndGetResponse(callbackResult);

            using (StreamReader httpwebStreamReader = new StreamReader(myResponse.GetResponseStream()))
            {
                string results = httpwebStreamReader.ReadToEnd();
                Deployment.Current.Dispatcher.BeginInvoke(() => wB.NavigateToString(results));

            }
            myResponse.Close();
        } 
```

我在 wb.NavigateToString 行上得到了 UnauthorizedAccessExeption。

有人已经看到了吗？

谢谢，雷诺

编辑：我更正了 conserned 线以使其工作！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:50:27.887

由于您的回调在不同的线程上，您需要使用 Dispatcher 来修改 UI。

```
Deployment.Current.Dispatcher.BeginInvoke(() => wb.NavigateToString(results)); 
```

# php - How to select documents with specific elements in MongoDB with PHP?

> ID：10688325
> 
> 赞同：0
> 
> 时间：2012-05-21T15:41:00.793
> 
> 标签：php, mongodb, select, count, find

I have the following structure of a mongo document:

```
{
 "_id": ObjectId("4fba2558a0787e53320027eb"),
 "replies": {
    "0": {
      "email": ObjectId("4fb89a181b3129fe2d000000"),
      "sentDate": "2012-05-21T11: 22: 01.418Z",
      "type": "one"
    } 
    "1": {
     "email": ObjectId("4fb89a181b3129fe2d000000"),
     "sentDate": "2012-05-21T11: 22: 01.418Z",
      "type": "two"
    } 
    "2" ....
 }

} 
```

How do I select only documents containing only specific type of replies, for example "type":"one"? Thank you!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T08:39:29.960

它就像这样工作，我第一次尝试在它上面做一个小组：

```
$cursor = $db->foo->find(
    array('replies.type' => 'one'), array('replies.sentDate')
); 
```

也许它会帮助像我这样的人。键“0”、“1”……没有任何作用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-21T16:13:12.517

`$elemMatch`在 mongo 文档中 查看我认为它会有所帮助。[http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24all](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24all)

你可以试试这个：

```
t.find({replies: {$elemMatch: { "type": "one" } } }); 
```

# php - 加入两个 MySQL 表并使用 php 对结果进行分组

> ID：10688338
> 
> 赞同：2
> 
> 时间：2012-05-21T15:42:13.913
> 
> 标签：php, mysql, html-table

我有以下代码来填充表格中的城市。

```
$cities_query = "SELECT city_name FROM city_selection";
$cities_result = mysql_query($cities_query);

echo "<table>";
while ($row = mysql_fetch_assoc($cities_result))
{
    echo "<tr>";
    echo "<td>".$row['city_name'] . "</td>";
    echo "</tr>";
}
echo "</table>"; 
```

现在我需要按地区对每个城市进行分组，所以我创建了一个名为的表，并在新表的新列中`city_region_selection`添加了一个。`Foreign key``"region_id"``city_selection table``region_id`

我现在正在努力使用 PHP 在一个漂亮的 html 表中呈现这些数据。

甚至可以先用 region_name 填充一个表格行，然后再填充一些包含该地区城市的子行？详情请看这张图片：

![http://oi48.tinypic.com/2uq0z9x.jpg](../Images/90c899a0de47e5dd539644acabd1e85b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:54:33.843

你只需要做一点预处理：

```
/* SQL
   SELECT
      city_name,
      region_name
   FROM
      city_selection
      NATURAL JOIN city_region_selection
SQL */

$regions = array();
while ($result->fetch()) {
   if (!isset($regions[$result->region_name])) {
      $regions[$result->region_name] = array();
   }
   $regions[$result->region_name][] = $result->city_name;
} 
```

* * *

## 具有 SQL 焦点的替代方法

```
/* SQL
   SELECT
      region_name,
      GROUP_CONCAT(city_name SEPARATOR ',') cities
   FROM
      city_selection
      NATURAL JOIN city_region_selection
   GROUP BY
      region_name
*/

$regions = array();
while ($result->fetch()) {
   $regions[$result->region_name] = explode(',', $result->city_name);
} 
```

* * *

## 帮助

请注意，`while`语法只是被删节了。你可能会用

```
while ($row = mysql_fetch_assoc($cities_result)) {
   $regions[$row['region_name']] = explode(',', $row['city_name']);
} 
```

... 例如

一旦`regions`构建，只需执行以下操作：

```
foreach ($regions as $region => $cities) {
   echo "<tr><td>$region</td></tr>";
   foreach ($cities as $city) {
      echo "<tr><td class="tabbed">$city</td></tr>";
   }
} 
```

# php - 在 SQL 中使用 PHP 为 DATETIME 转换日期

> ID：10688340
> 
> 赞同：7
> 
> 时间：2012-05-21T15:42:18.170
> 
> 标签：php, mysqli, sqldatatypes, type-conversion

我有一个 PHP 论坛，它采用格式中的日期 `dd/mm/yyyy hh:mm:ss`。但是，我需要将它作为 DATETIME 插入到 SQL 中，格式为`yyyy-mm-dd hh:mm:ss`. 如何转换这些数据？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-21T16:03:01.690

您的日期时间格式错误：`dd/mm/yyyy hh:mm:ss`. 大概你的意思`d/m/Y H:i:s`

如果您有 5.3+ 版本，则可以安全地将日期时间转换为另一种格式。这是一个例子：

```
$timestamp = '31/05/2001 12:22:56';
$timestamp = DateTime::createFromFormat('d/m/Y H:i:s', $timestamp);
echo $timestamp->format('Y-m-d H:i:s'); 
```

或者如果您喜欢更程序化的方式：

```
$timestamp = '31/05/2001 12:22:56';
$timestamp = date_create_from_format('d/m/Y H:i:s', $timestamp);
echo date_format($timestamp, 'Y-m-d H:i:s'); 
```

小心以前的建议。有些是完全错误的，有些可能会导致错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T15:46:44.323

您可以使用 strtotime 和 date 来修改格式。

```
$new_date = date( "Y-m-d H:i:s", strtotime( $old_date ) ); 
```

这样做是获取您的旧日期 ( `dd/mm/yyyy hh:mm:ss`)，将其转换为 unix 时间戳，然后可以与 php date 函数一起使用将日期格式化为所需的格式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T15:46:44.040

几种可能的方法中的两种：

1.  在代码中转换，然后将转换后的值传递给mysql：`$mysqldate = date( 'Y-m-d H:i:s', $phpdate );`
2.  让 mysql 使用它的内置函数来完成这项工作： `$query = "UPDATE table SET datetimefield = FROM_UNIXTIME($phpdate) ...";`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T15:50:40.027

如果您可以从上述格式中获得日期时间，那么您只需要使用以下功能。

```
function localToMysql($dateTime){
  $date_chunks = explode('/', $dateTime);
    $time_chunks = explode(' ', $date_chunks[2]);
    $final_format = $time_chunks[0] . "-" . $date_chunks[1] . "-" . $date_chunks[0] . " " . $time_chunks[1]; 
```

返回 $final_format；}

# java - How can I use a method inside an activity from external class in java

> ID：10688342
> 
> 赞同：0
> 
> 时间：2012-05-21T15:42:22.307
> 
> 标签：java, android, android-activity, android-context

Is it possible to call a method of `Activity` from the regular Java class?

This is the method in the activity:

```
public void showMessage(String mensaje) {
   AlertDialog.Builder builder = new AlertDialog.Builder(this);
   builder.setMessage("Are you sure you want to exit?")
          .setCancelable(false)
          .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
              public void onClick(DialogInterface dialog, int id) {
                   dialog.cancel();
              }
          })
          .setNegativeButton("No", new DialogInterface.OnClickListener() {
              public void onClick(DialogInterface dialog, int id) {
                   dialog.cancel();
              }
          });
   AlertDialog alert = builder.create();
   alert.show(); 
```

This is the method of the code in the external (simple java) class:

```
public void write(String importanChange) {
    Context context = //Here I dont know what to do here (It's my question,
                  //but I tried other aproaches but all failed                     
    ((MyActivity)mContext).showMessage(message); 
```

The reason is that I have a framework that detects changes on a simulation (Android Aplication) and later this simulation notifies to this framework changes and it decides whether the change is important or not.

So if the change is important the framework must execute the showMessage method in the activity.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:45:42.437

您应该将您的方法定义`public static void write(String importantChange)`为`public void write(String importantChange)`

将您的方法设置为“静态”意味着您不必实例化包含您的方法的类来使用此方法。

编辑：我刚刚看到你的“编辑”。因此，要在您的方法中使用 Context，我建议您将上下文作为方法的参数传递，如下所示：`public void write(String importantChange, Context context)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:11:30.693

由于`AlertDialog`不需要，`Context`您可以选择创建实用方法：

```
public static void showMessage(String message) {
    ...
}

public void write(String importanChange) {
    MyActivity.showMessage(msg);
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T18:53:54.113

尝试这个，

例如：

```
Activity Class:

      public class MyActivity extends Activity {

                    onCreate(.....){

               }

         public void go(){

         //Some code

     }

Java External Class in the same package:

public class MyDemo {

     MyActivity ac;
                   public MyDemo(MyActivity ac) {

                           this.ac = ac;
                     }

                 public void foo() {

                          ac.go();    // Access the activity's method
                   }

     } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T10:06:34.237

```
public static void showMessage(String importantMensaje){         
        final String mensajeAMostrar = importantMessage;
        Runnable runnable = new Runnable() {
            public void run() {
                handler.post(new Runnable() { // This thread runs in the UI
                    public void run() {
                        MyActivity.builder.setMessage(mensajeAMostrar)
                        .setCancelable(false)
                        .setPositiveButton("Of Course", new DialogInterface.OnClickListener() {
                         public void onClick(DialogInterface dialog, int id) {
                              dialog.cancel();
                         }
                        });
                        AlertDialog alert = MyActivity.builder.create();
                        alert.show();
                    }
                });
            }
        };
        new Thread(runnable).start(); 
 } 
```

# java - 在 Eclipse m2e 中，如何引用工作空间项目？

> ID：10688344
> 
> 赞同：32
> 
> 时间：2012-05-21T15:42:25.997
> 
> 标签：java, eclipse, maven, m2e

如何使用 Eclipse *m2e*引用另一个工作区项目？

我必须在项目设置中添加项目依赖项吗？但在这种情况下，依赖项不会显示在 pom.xml 中。

如果我在 pom 中设置它们，它不会引用工作区中的项目，而是引用本地存储库中的 jar。好烦，有大神帮忙吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-05-22T06:13:14.617

执行此操作的正确方法如下：

*   仅使用 POM 文件中的依赖项部分，不要摆弄 Eclipse 项目引用。右键单击项目，然后选择*Maven > Update Project Configuration*将项目重置为 Maven 默认设置。这样，*m2e*就拥有依赖项的所有权。
*   确保所有引用的项目都在 Eclipse 中打开并启用了 Maven*特性*。
*   检查每个项目的 Maven 设置，确保*groupId*、*artifactId*和*version*与您在 Eclipse 中打开的项目匹配。因此，如果您依赖的项目在 Eclipse 中具有*1.0.0-SNAPSHOT*版本，请确保依赖项目的 POM 文件在*依赖项部分引用了**1.0.0-SNAPSHOT*版本。
**   为每个项目启用*工作区分辨率。*右键单击项目，然后*Maven > Enable Workspace Resolution*。*   最后，如果项目仍然没有解决，再次右键单击项目，然后*Maven > 更新项目**

 *这应该可以解决您的问题。如果在此之后，您的依赖项仍然从文件系统中引用，请再次检查*groupId*、*artifactId*，尤其是每个依赖项的*版本*。

还要检查您的项目中是否没有任何错误 - 尝试运行 Maven 安装。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-05-18T12:48:59.813

我会走得更远。如果您**曾经**运行`mvn eclipse:eclipse`过您的项目，那么您可能遇到了麻烦。我的 Eclipse 项目中有一个“*引用的库*”部分和一个“ *Maven 依赖项*”部分，库版本相互冲突，导致 Eclipse 和我自己不可避免地感到困惑。

我发现最安全的方法是从命令行运行`mvn eclipse:clean`，然后返回 Eclipse，刷新项目，“确定”出现问题对话框，然后转到*Maven > Update Project*。这为我解决了一切。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-05-21T00:51:11.780

当 eclipse 搞砸了导入和删除多个项目时，您可能需要重建 maven 存储库的索引。这是我做过的一种方式。

1.  检查引用的项目是否被eclipse正确识别为maven项目。

    在菜单栏中，单击`Window -> Show View -> Other...`
    'Show View' 窗口弹出时，选择`Maven -> Maven Repositories`
    In Maven Repositories 窗口，您应该在 中看到您的项目为 jar 文件`Local Repositories -> Workspace Projects`
    如果在 中找不到您的项目`Workspace Projects`，请右键单击`Workspace Projects`并选择`Rebuild Index`。

2.  更新引用项目的 maven

    右键单击引用项目，`Maven -> Update Project... -> OK`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-03T04:31:25.457

您还需要确保您正在运行正确的目标。

如果您不运行**安装**目标，那么它将不会被复制到您的存储库并且不会编译。

要了解有关目标的更多信息，请查看[https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html](https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-07-07T09:28:49.390

感谢@nwinkler 的回应，主要问题是匹配版本号。

一个常见的场景是，如果您正在开发一组彼此版本锁定的项目 - 例如，一个项目和一组库项目的耦合不是很松散，这样库 API 可能会在一个相关应用项目版本使用的版本，但可能会以与应用项目的过去或未来版本不兼容的方式更改。

在这种配置中设置 Maven 依赖项的正确方法（也是推荐的做法）是让应用程序使用特定版本的库 - 例如，如果您重建旧版本的应用程序，它将使用它以前编译的库版本。

将应用程序项目的 POM 库依赖项设置为发布版本（可以说`1.0.0`），并且在将应用程序和库项目设置为 SNAPSHOT 版本（可以说`2.0.0-SNAPSHOT`）处理下一个版本时，m2e 将无法正确解析库版本，并且可能会下载旧版本，因此尝试使用诸如“Open Decleration”之类的 Eclipse 功能将针对下载 jar（有时甚至没有源附件），这可能会很烦人。

解决此问题的一种方法是将应用程序 POM 依赖项版本设置为一个范围，因此`1.0.0`您将依赖`[1.0.0-)`. 有了这样的开放范围，m2e 会很高兴地找到您的工作区库项目。但是您希望在提交、构建和发布之前将其设置回“正确”版本——这很容易出错。

我的解决方案是使用构建配置文件并为 m2e 设置自定义配置文件，如下所示：

*   使用属性将依赖项版本设置为要发布的版本：

```
...

<properties>
<my.library.version>1.0.0</my.library.version>
</properties>

<dependencies>
  <dependency>
    <groupId>my.group</groupId>
    <artifactId>my.library</artifactId>
    <version>${my.library.version}</version>
  </dependency>
</dependencies>

... 
```

*   然后添加一个配置文件部分，其中包含一个默认情况下不执行任何操作的活动配置文件，以及一个使用范围覆盖库版本属性的 Eclipse 特定配置文件：

```
...

<profiles>
    <profile>
        <id>default</id>
        <activation><activeByDefault></activeByDefault></activation>
    </profile>

    <profile>
        <id>eclipse</id>
        <properties>
            <my.library.version>[1,)</my.library.version>
        </properties>
    </profile>
</profiles>

... 
```

*   最后转到您的项目属性，并在“Maven”下将“eclipse”键入“Active Maven Profiles”：

[![在此处输入图像描述](../Images/3cbed719a05c65f49975d649faf38aa6.png)](https://i.stack.imgur.com/1T8uJ.png)

*   然后“应用并关闭”。

然后 Eclipse m2e 将始终看到版本范围，并将解析来自 eclipse 项目的依赖项（即使您在本地 Maven 存储库中安装了该库，因为 Eclipse 项目将具有更高的版本号），但其他构建器将看到原始，严格，版本号。*

# php - 如何从 PHP 中的外部必需文件访问常量？

> ID：10688347
> 
> 赞同：0
> 
> 时间：2012-05-21T15:42:43.337
> 
> 标签：php, oop, constants, required, class-constants

如果我将常量保留在类代码中，我会制作这个类，但我想从用户可以注释或取消注释 c 常量值的外部文件访问它们。

这种方式效果很好，但我不希望用户在代码中翻来覆去：

```
class passwordStringHandler
{

# const PWDALGO = 'md5';
# const PWDALGO = 'sha1';
# const PWDALGO = 'sha256';
# const PWDALGO = 'sha512';
const PWDALGO = 'whirlpool';

  /* THIS METHOD WILL CREATE THE SALTED USER PASSWORD HASH DEPENDING ON WHATS BEEN
    DEFINED    */

function createUsersPassword()
{

$userspassword = 'Te$t1234';

$saltedpassword='';    

if ((defined('self::PWDALGO')) && (self::PWDALGO === 'md5'))
{
    $saltedpassword = md5($userspassword . $this->pwdsalt);
    echo("The salted md5 generated hash is: " . $saltedpassword . "<br>");
    return $saltedpassword;

}elseif ((defined('self::PWDALGO')) && (self::PWDALGO === 'sha1')){
    $saltedpassword = sha1($userspassword . $this->pwdsalt);
    echo("The salted sha1 generated hash is: " . $saltedpassword . "<br>");
    return $saltedpassword;

}elseif ((defined('self::PWDALGO')) && (self::PWDALGO === 'sha256')){
    $saltedpassword = hash('sha256', $userspassword . $this->pwdsalt);
    echo("The salted sha256 generated hash is: " . $saltedpassword . "<br>");
    return $saltedpassword;

}elseif ((defined('self::PWDALGO')) && (self::PWDALGO === 'sha512')){
    $saltedpassword = hash('sha512', $userspassword . $this->pwdsalt);
    echo("The salted sha512 generated hash is: " . $saltedpassword . "<br>");
    return $saltedpassword;

}elseif ((defined('self::PWDALGO')) && (self::PWDALGO === 'whirlpool')){
    $saltedpassword = hash('whirlpool', $userspassword . $this->pwdsalt);
    echo("The salted whirlpool generated hash is: " . $saltedpassword . "<br>");
    return $saltedpassword;

}

else

    echo("No password algro is defined! Edit the [<strong>PWDALGO</strong>] options in the <strong>systemConfiguration.php</strong><br>");  
    return false;

} 
```

这可以正常工作，因为它被硬编码到类文件中：

我希望它使用这个来工作：

```
require ("../configs/systemConfiguration.php");   
class passwordStringHandler
{ 
```

我在 if /else 语句中不断得到 else ，它无法找到是否定义了 PWDALGO 。

或者这样

```
class passwordStringHandler
{
require ("../configs/systemConfiguration.php"); 
```

我不知道这是否可能，因为我不断收到错误，我认为您不能在类范围内包含或要求文件。

将来，如果我让它工作，我想要一个安装脚本来检查服务器以查看可用的加密类型并列出供用户选择首选加密方法的列表，然后为他们自动设置. 并且以后可以从管理控制面板更改加密方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:36:22.063

听起来您希望这些常量跨越对象（类），而**不是**仅限于`passwordStringHandler`类。

如果*是*这种情况，我建议您使用[`define()`](http://php.net/manual/en/function.define.php)而不是`const`.

像这样：

**系统配置.php**

```
define('PWDALGO', 'whirlpool'); 
```

**密码字符串处理程序.php**

```
require ("../configs/systemConfiguration.php");

class passwordStringHandler
{
    if ((defined('PWDALGO')) && (PWDALGO === 'md5')) 
```

更多信息： [define() vs const](https://stackoverflow.com/questions/2447791/define-vs-const)

# c++ - 数据交换的设计模式

> ID：10688348
> 
> 赞同：1
> 
> 时间：2012-05-21T15:42:57.207
> 
> 标签：c++, oop, qt, design-patterns, signals-slots

我有一组虚拟设备 (D)。设备可以交叉连接（假设，物理连接）：

D1——D2

D2——D3

每个链接可能会有不同的延迟。

每个设备都包含一组可以生成一些数据的虚拟子设备。子设备可以组织成逻辑连接。子设备将传输真实的字节数据。

我使用 C++，Qt。我尝试使用信号槽机制，QSignalMapper，但我没有找到好的解决方案。

请帮助我建立清晰的抽象。我可以使用任何设计模式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T11:23:58.073

您应该定义一个`Link`类来模拟类之间的物理链接。最有趣的问题是，如何连接您的设备并使用信号和插槽模拟延迟？

我的建议是：实现一个`send(QByteArray data)`插槽，将数据排入内部队列（模拟线路），并将超时设置为给定的默认延迟，并带有可选的抖动。然后超时会触发一个信号，其中包含从队列中弹出的数据。

如果你想模拟设备之间的路由器，你应该考虑到队列中的数据越多，延迟就越大，因为需要重新传输。为了近似模拟这一点，您可以根据当前队列长度设置超时值。

以此为开端：

```
class Link : public QObject
{
    Q_OBJECT

public:
    Link(Device *from, Device *to) :
        QObject(to), m_from(from), m_to(to)
    {
        //make my life dependant on both "from" and "to" objects
        connect(from, SIGNAL(destroyed()), SLOT(deleteLater()));

        //connect to the signals and slots of the devices
        connect(from, SIGNAL(send(QByteArray,Device*)),
                this, SLOT(  send(QByteArray,Device*)));
        connect(this, SIGNAL(receive(QByteArray,Device*,int)),
                to,   SLOT(  receive(QByteArray,Device*,int)));
    }

public slots:
    void send(QByteArray data, Device *receiver) {
        Message msg(data, 0, qobject_cast<Device*>(sender()), receiver);
        send(msg);
    }
    void send(Message msg) {
        msg.hops++; // here we increase the hops counter
        m_queue.enqueue(msg);
        QTimer::signalShot(m_delay, this, SLOT(timeout()));
    }

signals:
    void receive(QByteArray data, Device *sender, int hops);
    void forward(Message);

private slots:
    void timeout() {
        receive(m_queue.dequeue());
    }
    void receive(Message msg) {
        if(msg.receiver == m_to)
            // msg reached destination!
            emit receive(msg.data, msg.sender, msg.hops);
        else
            // forward to next link
            emit forward(msg);
    }

private:
    static const int m_delay = 100; // delay set to 100 ms
    QQueue<Message> m_queue;
    Device *m_from, *m_to;
}; 
```

类型`Message`定义如下：

```
struct Message {
    QByteArray data;
    int hops;
    Device *sender;
    Device *receiver;
    Message(data, hops, sender) : data(data), hops(hops),
                                  sender(sender), receiver(receiver) {}
}; 
```

然后像这样创建设备和链接：

```
// Create devices:
Device *d1 = new Device(this);
Device *d2 = new Device(this);

// Create link:
Link *d1d2 = new Link(d1, d2); 
```

或带有转发规则的链接：

```
// Create devices:
Device *d1 = new Device(this);
Device *d2 = new Device(this);
Device *d3 = new Device(this);

// Create links:
Link *l1 = new Link(d1, d2);
Link *l2 = new Link(d2, d3);

// Create forwarding rule:
connect(l1, SIGNAL(forward(Message)), l2, SLOT(send(Message))); 
```

然后d1 发送的每个数据（当它发出信号时`send(QByteArray)`）将延迟 100 ms 传输到`receive(QByteArray)`d2 的插槽。如果数据不是用于 d2，则`forward(Message)`发出信号，该信号必须被另一个链接捕获（请参阅转发规则）。然后它被视为新的传入消息并传递给 d3。

请注意，真实网络的功能并非如此。您需要实施路由策略来完全模拟这样的设置；这是相当困难的。

另请注意，我没有测试此代码。;)

这种方法不会模拟将数据分成小段（每个大约 1.5 KB）。要模拟真实的以太网设置，您也需要这样做。如果您需要，请在评论中询问，我可能会扩展课程。

# django - 从 Django 应用程序/项目执行 shell 命令

> ID：10688352
> 
> 赞同：0
> 
> 时间：2012-05-21T15:43:15.293
> 
> 标签：django, django-models, django-forms

我希望能够从 Django 应用程序执行一些 shell 命令`mkvirtualenv`，`createdb`例如，这些进程可能会在以后进入 Django celery 任务。我认为使用 system() 从 Django/Apache 执行 shell 命令是不安全的，所以我的问题是从 django 应用程序执行 shell 命令的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:40:23.427

要在后台启动 shell 进程，您可以使用该[`subprocess`](http://docs.python.org/library/subprocess.html#using-the-subprocess-module)模块。

# android - *Android 错误*-令牌上的语法错误，错误的构造

> ID：10688356
> 
> 赞同：0
> 
> 时间：2012-05-21T15:43:31.900
> 
> 标签：android

我是新手，这是我第一次尝试做一个 android 应用程序。我正在尝试做石头、剪纸和剪刀，我知道我还没有完成代码，但我遇到了一些错误......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:59:43.303

我看到一些可能是问题的地方，但可能给你带来麻烦的地方是你有

```
else (computerplay.equals("5")) 
```

你错过了`if`，你需要类似的东西

```
else if(computerplay.equals("5")) 
```

在几个地方。

此外，您需要引用布局中的 TextView，而不是

```
 TextView tv = new TextView(this); 
```

你需要类似的东西

```
 TextView tv = (TextView) findViewById(R.id.textview); 
```

并且不要调用 setContentView(tv)。

# variables - 梳理CSV文件powershell

> ID：10688358
> 
> 赞同：0
> 
> 时间：2012-05-21T15:43:31.713
> 
> 标签：variables, powershell, csv

所以这是背景故事，我试图以几种不同的方式验证数据。我查询了一个数据库并将该数据导出到 csv。

然后使用 powershell 我运行以下命令

```
$staleDates = Import-Csv DataAudit.csv | Where-Object { $_.asOfDate -ne "" } | Foreach-Object { $_.AsOfDate = $_.AsOfDate -as [datetime]; $_ } | Where-Object {$_.asOfDate -lt $measuredDate}

$nullDates = Import-Csv DataAudit.csv | Where-Object {$_.asOfDate -eq ""}

$percentTooLarge = Import-Csv DataAudit.csv | Foreach-Object { $_.SumHoldingPercent = $_.SumHoldingPercent -as [float]; $_ } | Where-Object { $_.SumHoldingPercent -gt 100 }

$percentTooSmall = Import-Csv DataAudit.csv | Where-Object {$_.SumHoldingPercent -ne "" } | Foreach-Object { $_.SumHoldingPercent = $_.SumHoldingPercent -as [float]; $_ } | Where-Object {$_.SumHoldingPercent -lt 99.99999 } 
```

有没有办法可以将这 4 个变量的结果组合成一个 csv，然后我可以通过电子邮件将其作为不良数据报告发送出去？

另外，我正在使用 Powershell v1.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:01:27.103

以下应该有效：

```
$badData = Import-Csv DataAudit.csv | Where-Object { $_.asOfDate -ne "" } | Foreach-Object { $_.AsOfDate = $_.AsOfDate -as [datetime]; $_ } | Where-Object {$_.asOfDate -lt $measuredDate}
$badData += Import-Csv DataAudit.csv | Where-Object {$_.asOfDate -eq ""}
$badData += Import-Csv DataAudit.csv | Foreach-Object { $_.SumHoldingPercent = $_.SumHoldingPercent -as [float]; $_ } | Where-Object { $_.SumHoldingPercent -gt 100 }
$badData += Import-Csv DataAudit.csv | Where-Object {$_.SumHoldingPercent -ne "" } | Foreach-Object { $_.SumHoldingPercent = $_.SumHoldingPercent -as [float]; $_ } | Where-Object {$_.SumHoldingPercent -lt 99.99999 }

$badData | Export-CSV -NoTypeInformation -Path allBadData.csv 
```

# c# - 在 .net 4.0 中并行化网络爬虫的最佳实践

> ID：10688359
> 
> 赞同：3
> 
> 时间：2012-05-21T15:43:40.170
> 
> 标签：c#, web-crawler

我需要通过代理下载很多页面。构建多线程网络爬虫的最佳实践是什么？

Parallel.For\Foreach 是足够好还是更适合繁重的 CPU 任务？

你对下面的代码有什么看法？

```
var multyProxy = new MultyProxy();

   multyProxy.LoadProxyList();

   Task[] taskArray = new Task[1000];

        for(int i = 0; i < taskArray.Length; i++)
        {
            taskArray[i] = new Task( (obj) =>
                {                                                             
                       multyProxy.GetPage((string)obj);
                },

            (object)"http://google.com"
            );
            taskArray[i].Start();
        }

   Task.WaitAll(taskArray); 
```

它的工作很糟糕。它非常慢，我不知道为什么。

这段代码也不好用。

```
 System.Threading.Tasks.Parallel.For(0,1000, new System.Threading.Tasks.ParallelOptions(){MaxDegreeOfParallelism=30},loop =>
            {
                 multyProxy.GetPage("http://google.com");
            }
            ); 
```

好吧，我认为我做错了什么。

当我启动我的脚本时，它仅以 2%-4% 使用网络。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T15:56:57.143

您基本上正在为 IO 绑定任务使用 CPU 绑定线程 - 即。即使您正在并行化您的操作，它们本质上仍然在使用 ThreadPool 线程，该线程主要用于 CPU 绑定操作。

基本上，您需要使用异步模式来下载数据以将其更改为使用 IO 完成端口 - 如果您使用的是 WebRequest，那么 BeginGetResponse() 和 EndGetResponse() 方法

我建议查看 Reactive Extensions 来执行此操作，例如：

```
IEnumerable<string> urls = ... get your urls here...;
var results = from url in urls.ToObservable()
             let req = WebRequest.Create(url)
             from rsp in Observable.FromAsyncPattern<WebResponse>(
                  req.BeginGetResponse, req.EndGetResponse)()
             select ExtractResponse(rsp); 
```

如果这是您所追求的，ExtractResponse 可能只是使用 StreamReader.ReadToEnd 来获取字符串结果

您还可以查看使用 .Retry 运算符，如果遇到连接问题等，您可以轻松地重试几次......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:51:30.763

在 main 方法的开头添加：

```
System.Net.ServicePointManager.DefaultConnectionLimit = 100; 
```

因此，您将不会受到少量并发连接的限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:50:06.400

当您使用大量连接时，这可能会对您有所帮助（添加到 app.config 或 web.config）：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.net>
    <connectionManagement>
      <add address="*" maxconnection="50"/>
    </connectionManagement>
  </system.net>
</configuration> 
```

设置您的并发连接数而不是 50

在[http://msdn.microsoft.com/en-us/library/fb6y0fyc.aspx了解更多信息](http://msdn.microsoft.com/en-us/library/fb6y0fyc.aspx)

# .net - IBM DB2 数据库的实体框架 web.config 连接字符串

> ID：10688362
> 
> 赞同：1
> 
> 时间：2012-05-21T15:43:47.517
> 
> 标签：.net, asp.net-mvc-3, entity-framework-4.1, db2

进行了广泛搜索，但似乎还找不到 web.config 文件的连接字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:49:09.650

您需要一个 IBM db2 驱动程序：

[http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/index.jsp?topic=/com.ibm.swg.im.dbclient.adonet.doc/doc/c0054118.html](http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/index.jsp?topic=/com.ibm.swg.im.dbclient.adonet.doc/doc/c0054118.html)

或者您可以使用不是很快的 oledb 驱动程序，对于连接字符串，您可以查看：

[http://www.connectionstrings.com/ibm-db2](http://www.connectionstrings.com/ibm-db2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:47:34.580

您面临的问题是什么？您不能为给定的数据库创建 conn 字符串吗？你看过[http://www.connectionstrings.com/](http://www.connectionstrings.com/)吗？

# java - 使用 Jersey 解组 xml 标签

> ID：10688369
> 
> 赞同：1
> 
> 时间：2012-05-21T15:44:27.867
> 
> 标签：java, rest, jersey

我有这个xml：

```
<?xml version="1.0" encoding="utf-8"?>
 <ProductItem xmlns="http://providers.natinst.com/pdi-rest/1.0/meta/" urn="urn:product-item:910796-76" url="http://immix-test2.natinst.com/pdi-rest/1.0/en-US/product-item/910796-76.xml">
<partNumber>910796-76</partNumber>
<inventoryItemId>560427</inventoryItemId>
<nicInventoryItemId>765430</nicInventoryItemId>
<name />
<description>LABVIEW CORE 2 SELF-PACED ONLINE TRAINING (6 MONTHS ACCESS)</description>
<isCustomerFacing>true</isCustomerFacing>
<itemType>CE</itemType>
<partType>Training Program</partType>
<bookingsClassName />
<bookingsClassCode />
<lifecyclePhase>Released</lifecyclePhase>
<salesClass />
<firstOrderableDate />
<locale>en-US</locale>
<ngpmProductHierarchy />
<productRevisions url="http://immix-test2.natinst.com/pdi-rest/1.0/en-US/product-item/910796-76/productRevisions.xml" />
<serviceOptionsForProduct url="http://immix-test2.natinst.com/pdi-rest/1.0/en-US/product-item/910796-76/serviceOptionsForProduct.xml" />
<serviceOptionsByService url="http://immix-test2.natinst.com/pdi-rest/1.0/en-US/product-item/910796-76/serviceOptionsByService.xml" />
<productFeatures url="http://immix-test2.natinst.com/pdi-rest/1.0/en-US/product-item/910796-76/productFeatures.xml" />
 </ProductItem> 
```

我正在尝试获取描述标签。这是我的java代码。

```
package com.ni.apps.elearningrest.client;

import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;

import javax.xml.bind.annotation.XmlElementWrapper;

@XmlRootElement(name = "ProductItem")
public class DescriptionDTO {

    private String description;
    private String uri;

    @XmlElement(name = "description")
    public String getDescription() {
        return this.description;
    }

    public void setDescription(String description) {
        this.description = description;
    }               
} 
```

但我不断收到“意外元素（uri：”http://providers.natinst.com/pdi-rest/1.0/meta/，local：“ProductItem”）。预期的元素是 <{}ProductItem>" 错误。我可以做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T19:03:03.127

虽然您可以在`@XmlRootEleemnt`和`@XmlElement`注释上指定命名空间属性，但我建议使用该`@XmlSchema`注释来指定默认命名空间。

**com/ni/apps/elearningrest/client/package-info.java**

```
@XmlSchema( 
    namespace = "http://providers.natinst.com/pdi-rest/1.0/meta/", 
    elementFormDefault = XmlNsForm.QUALIFIED) 
package com.ni.apps.elearningrest.client; 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2010/08/jaxb-namespaces.html](http://blog.bdoughan.com/2010/08/jaxb-namespaces.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:48:43.750

尝试将命名空间添加到 JAXB 注释：

`@XmlRootElement(name = "ProductItem", namespace="http://providers.natinst.com/pdi-rest/1.0/meta/")`

# jquery - 仅在不存在时加载 jQuery 时出现问题

> ID：10688374
> 
> 赞同：3
> 
> 时间：2012-05-21T15:44:39.427
> 
> 标签：jquery, dynamic

我正在使用代码[博客中的代码，这与](http://samespirit.net/ricky/2010/06/21/only-load-jquery-if-not-already-present/)[此 SO 问题](https://stackoverflow.com/questions/6708716/can-a-javascript-check-for-jquery-and-load-it-if-not-already-present)的答案中的代码非常相似。

我的问题是*jQuery 包含的代码很好*，但由于某种原因，它之后的脚本无法识别 jQuery 已加载。我究竟做错了什么？

[我已将代码放在 jsFiddle 中。](http://jsfiddle.net/JfWeG/)

```
if (!window.loadjQueryOnce)
{
    function loadjQueryOnce(jQueryVersion)
    {
        jQueryVersion = typeof(jQueryVersion) != 'undefined' ? jQueryVersion : "1.7.2";

        if (typeof jQuery === "undefined") {
            var script_tag = document.createElement('script');
            script_tag.setAttribute("type","text/javascript");
            script_tag.setAttribute("src",
              "http://ajax.googleapis.com/ajax/libs/jquery/" + jQueryVersion + "/jquery.min.js")
            document.getElementsByTagName("head")[0].appendChild(script_tag);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:53:29.720

问题是您没有等待在 HTML 中调用之前执行脚本。[请参阅此示例](http://jsfiddle.net/yHfq4/)，该示例使用您提到的博客中的代码。您需要将依赖 jQuery 的代码放在`main`函数中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:50:10.283

当您将该`loadjQueryOnce('1.7.2')`行移至检查 jQuery 的上方时，jQuery 已正确加载。 [http://jsfiddle.net/JfWeG/2/](http://jsfiddle.net/JfWeG/2/) 所以，我不确定你在哪里进行检查，但代码确实有效。

如果您想确保在加载依赖于它的 JS 文件之前加载 jQuery，那么要么更改您的函数以在加载 jQuery 之后加载那些，或者在每个使用它的脚本之前对 jQuery 执行检查。

```
// Load jQueryUI
if (!jQuery) loadjQueryOnce();
loadjQueryUI();

if (!jQuery) loadjQueryOnce();
loadjQueryDepedentScript(); 
```

它很笨重，但它有效。如果您让我们更好地了解您这样做的原因，我们也许可以帮助您找到更好的解决方案。

您最好的选择是创建一个模板，其中 jQuery 是头中加载的第一件事：

```
<html>
    <head>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        ...
    </head> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:52:52.783

看起来是时间问题。如果您在检查之前创建一个小的延迟，它工作正常。

```
<script type="text/javascript">
setTimeout(function() {
    if (typeof jQuery === "undefined") {
        alert('Not recognizing jQuery');
    }
}, 100);​
</script> 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/JfWeG/3/)**。

# emacs - 在 emacs 中定位库与查找库

> ID：10688376
> 
> 赞同：2
> 
> 时间：2012-05-21T15:44:45.737
> 
> 标签：emacs

emacs`locate-library`和in有什么区别？`find-library`

我可以运行`locate-library` `Enter` `sql`并将完整路径写入状态字符串。

但`find-library` `Enter` `sql`返回：（`find-library-name: Can't find library sql`写入`*Messages*`缓冲区）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:16:28.033

*   `locate-library`显示将由 a 使用的库名称和路径`load-library`（它可能是已编译的`.elc`）
*   `find-library`返回库**源**（如果找不到则失败`.el`）

# linux - 使用 linux cut 将一个字段分成两个

> ID：10688379
> 
> 赞同：2
> 
> 时间：2012-05-21T15:44:53.803
> 
> 标签：linux, cut

我的日志文件中有几个字段，我已经能够使用以下脚本将它们转换为 CSV。

```
#!/bin/bash
INPUT=/home/MSC11/khanm/wwwp11dorganiser.co.uk_log
OUTPUT="/home/MSC11/khanm/output-$(basename $INPUT | cut -d'.' -f1).csv"
# field names
s=1
ip=
dt=
method=
target=
protocol=
statuscode=
reference=
echo -n "Processing..."
# empty output file
>$OUTPUT
# read input line by line
while IFS= read -r line
do
   # get data
    ip=$(cut -d" " -f1<<<"$line")
    dt=$(cut -d" " -f4<<<"$line")
    method=$(cut -d" " -f6<<<"$line")
    target=$(cut -d" " -f7<<<"$line")
    protocol=$(cut -d" " -f8<<<"$line")
    statuscode=$(cut -d" " -f9<<<"$line")
    reference=$(cut -d" " -f11<<<"$line")
    # write cvs formatted output
    echo "${s},${ip},${dt},${target},${method},${protocol},${statuscode},${reference}" >>$OUTPUT
    # update counter
    s=$(( ++s ))
done < "$INPUT" 
echo "done."
echo "Total ${s} line processed and wrote to $OUTPUT cvs file." 
```

变量“dt”的格式为 29/Nov/2007:20:42:09。我想把它分成两部分。一个日期格式为 2007 年 11 月 29 日，第二个日期格式为 20:42:09。我已经解决了剪切命令，但我无法做到这一点。任何帮助，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T16:20:26.343

```
cut -d: -f1 <<< $dt
29/Nov/2007
cut -d: -f2- <<< $dt
20:42:09 
```

# c - 类似于 scanf 的函数中的内存泄漏问题

> ID：10688381
> 
> 赞同：3
> 
> 时间：2012-05-21T15:45:01.897
> 
> 标签：c, memory, memory-management, memory-leaks, valgrind

在下面的代码中，我试图重新创建`scanf`以读取所有内容，`stdin`并在换行符处中断，返回字符串中读取的所有字符。

但问题是代码会泄漏一些内存，尤其是在`realloc`被调用时。

我也想知道为什么`gets`使用危险功能

`test.c: warning: the 'gets' function is dangerous and should not be used.`

我的代码：-

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define MAX_BUF_LEN 128
#define __cdecl

//0 - Success
//-1 - Error in input
//1 - Error
__cdecl int read_input(char *s,int len){

char c,*t;
int l,i=0;

if(s==NULL || len < 1)
    return -1;

while((c=getchar()) != '\n'){

    //check if sufficient memory
    //required + used > assigned 
    l=strlen(s);
    if(l + 2 > len){

        len += l + MAX_BUF_LEN;     //realloc max to avoid subsequent realloc as its costly!

        t = realloc(s,len);
        if(t!=NULL)
            s = t;
        else
            return 1;               //No space to store content
    }

    s[i++] = c;

}

s[i++] = '\0';      //Null terminate the Buffer
return 0;   
}

int main(int argc,char* argv[]){

int len = 5+1;
char *s = calloc(len,sizeof(char));

printf("Enter your name\n");

if(!read_input(s,len))
    printf("Hi %s\n",s);

free(s);

return 0;
} 
```

瓦尔格林：

```
nimish:~/Desktop$ gcc -g -Wall test.c -o test
nimish~/Desktop$ clear && valgrind ./test  --leak-check=full

==3670== Memcheck, a memory error detector
==3670== Copyright (C) 2002-2010, and GNU GPL'd, by Julian Seward et al.
==3670== Using Valgrind-3.6.1 and LibVEX; rerun with -h for copyright info
==3670== Command: ./test --leak-check=full
==3670== 
Enter your name
Nimish Nicolus
==3670== Conditional jump or move depends on uninitialised value(s)
==3670==    at 0x4027029: strlen (mc_replace_strmem.c:282)
==3670==    by 0x804850E: read_input (test.c:23)
==3670==    by 0x80485CD: main (test.c:51)
==3670== 
==3670== Invalid read of size 1
==3670==    at 0x40831BF: vfprintf (vfprintf.c:1623)
==3670==    by 0x40891BF: printf (printf.c:35)
==3670==    by 0x80485E6: main (test.c:52)
==3670==  Address 0x41a5028 is 0 bytes inside a block of size 6 free'd
==3670==    at 0x402695A: realloc (vg_replace_malloc.c:525)
==3670==    by 0x8048537: read_input (test.c:28)
==3670==    by 0x80485CD: main (test.c:51)
==3670== 
==3670== Invalid read of size 1
==3670==    at 0x40A93A8: _IO_file_xsputn@@GLIBC_2.1 (fileops.c:1317)
==3670==    by 0x408346F: vfprintf (vfprintf.c:1623)
==3670==    by 0x40891BF: printf (printf.c:35)
==3670==    by 0x80485E6: main (test.c:52)
==3670==  Address 0x41a502c is 4 bytes inside a block of size 6 free'd
==3670==    at 0x402695A: realloc (vg_replace_malloc.c:525)
==3670==    by 0x8048537: read_input (test.c:28)
==3670==    by 0x80485CD: main (test.c:51)
==3670== 
==3670== Invalid read of size 1
==3670==    at 0x40A93BF: _IO_file_xsputn@@GLIBC_2.1 (fileops.c:1317)
==3670==    by 0x408346F: vfprintf (vfprintf.c:1623)
==3670==    by 0x40891BF: printf (printf.c:35)
==3670==    by 0x80485E6: main (test.c:52)
==3670==  Address 0x41a502b is 3 bytes inside a block of size 6 free'd
==3670==    at 0x402695A: realloc (vg_replace_malloc.c:525)
==3670==    by 0x8048537: read_input (test.c:28)
==3670==    by 0x80485CD: main (test.c:51)
==3670== 
==3670== Invalid read of size 1
==3670==    at 0x40A9330: _IO_file_xsputn@@GLIBC_2.1 (fileops.c:1349)
==3670==    by 0x408346F: vfprintf (vfprintf.c:1623)
==3670==    by 0x40891BF: printf (printf.c:35)
==3670==    by 0x80485E6: main (test.c:52)
==3670==  Address 0x41a5028 is 0 bytes inside a block of size 6 free'd
==3670==    at 0x402695A: realloc (vg_replace_malloc.c:525)
==3670==    by 0x8048537: read_input (test.c:28)
==3670==    by 0x80485CD: main (test.c:51)
==3670== 
==3670== Invalid read of size 1
==3670==    at 0x40A933C: _IO_file_xsputn@@GLIBC_2.1 (fileops.c:1348)
==3670==    by 0x408346F: vfprintf (vfprintf.c:1623)
==3670==    by 0x40891BF: printf (printf.c:35)
==3670==    by 0x80485E6: main (test.c:52)
==3670==  Address 0x41a502a is 2 bytes inside a block of size 6 free'd
==3670==    at 0x402695A: realloc (vg_replace_malloc.c:525)
==3670==    by 0x8048537: read_input (test.c:28)
==3670==    by 0x80485CD: main (test.c:51)
==3670== 
Hi Nimis
==3670== Invalid free() / delete / delete[]
==3670==    at 0x4025BF0: free (vg_replace_malloc.c:366)
==3670==    by 0x80485F2: main (test.c:54)
==3670==  Address 0x41a5028 is 0 bytes inside a block of size 6 free'd
==3670==    at 0x402695A: realloc (vg_replace_malloc.c:525)
==3670==    by 0x8048537: read_input (test.c:28)
==3670==    by 0x80485CD: main (test.c:51)
==3670== 
==3670== 
==3670== HEAP SUMMARY:
==3670==     in use at exit: 139 bytes in 1 blocks
==3670==   total heap usage: 2 allocs, 2 frees, 145 bytes allocated
==3670== 
==3670== LEAK SUMMARY:
==3670==    definitely lost: 139 bytes in 1 blocks
==3670==    indirectly lost: 0 bytes in 0 blocks
==3670==      possibly lost: 0 bytes in 0 blocks
==3670==    still reachable: 0 bytes in 0 blocks
==3670==         suppressed: 0 bytes in 0 blocks
==3670== Rerun with --leak-check=full to see details of leaked memory
==3670== 
==3670== For counts of detected and suppressed errors, rerun with: -v
==3670== Use --track-origins=yes to see where uninitialised values come from
==3670== ERROR SUMMARY: 23 errors from 7 contexts (suppressed: 11 from 6) 
```

编辑：- 请参考下面附上的新代码

新代码：-

```
__cdecl int read_input(char **s,int len){

char c,*t;
int l,i=0;

if((*s)==NULL || len < 1)
    return -1;

while((c=getchar()) != '\n'){

    //check if sufficient memory
    //required + used > assigned 
    l=strlen((*s));
    if(l + 2 > len){

        len += l + MAX_BUF_LEN;     //realloc max to avoid subsequent realloc as its costly!

        t = realloc((*s),len);
        if(t!=NULL)
            (*s) = t;
        else
            return 1;               //No space to store content
    }

    *((*s)+i++) = c;

}

*((*s)+i) = '\0';       //Null terminate the Buffer
return 0;   
} 
```

瓦尔格林：

```
==4767== Memcheck, a memory error detector
==4767== Copyright (C) 2002-2010, and GNU GPL'd, by Julian Seward et al.
==4767== Using Valgrind-3.6.1 and LibVEX; rerun with -h for copyright info
==4767== Command: ./test --leak-check=full
==4767== 
Enter your name
Nimish Nicolus
==4767== Conditional jump or move depends on uninitialised value(s)
==4767==    at 0x4027029: strlen (mc_replace_strmem.c:282)
==4767==    by 0x8048516: read_input (test.c:23)
==4767==    by 0x80485DE: main (test.c:51)
==4767== 
Hi Nimish Nicolus
==4767== 
==4767== HEAP SUMMARY:
==4767==     in use at exit: 0 bytes in 0 blocks
==4767==   total heap usage: 2 allocs, 2 frees, 145 bytes allocated
==4767== 
==4767== All heap blocks were freed -- no leaks are possible
==4767== 
==4767== For counts of detected and suppressed errors, rerun with: -v
==4767== Use --track-origins=yes to see where uninitialised values come from
==4767== ERROR SUMMARY: 6 errors from 1 contexts (suppressed: 11 from 6) 
```

它仍然给出了一些问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T15:54:30.640

以下是[手册](http://linux.die.net/man/3/gets)对`gets`问题的说明：

> 永远不要使用gets()。因为在事先不知道数据的情况下不可能知道gets()会读取多少个字符，而且因为gets()会继续存储超过缓冲区末尾的字符，所以使用起来非常危险。它已被用来破坏计算机安全。请改用 fgets()。

发生泄漏问题是因为指针`s`是按值传递的，因此任何更改（包括重新分配后的赋值）都是针对其*副本*而不是原始指针进行的。结果，`s`释放只释放最初分配的内存，泄漏`realloc`-ed 内存。要解决此问题，请更改`read_input`为采用指向指针的指针，如下所示：

```
int read_input(char **ps,int len) 
```

传递`&s`给`read_input`, 并在函数体`(*ps)`中代替使用。`s`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T15:55:10.973

您没有将指针返回到分配的缓冲区。所以，`free(s)`是没有做你期望的。`realloc`不保证在同一位置提供额外的空间。因此，缓冲区可以移动。一种解决方案是传递一个指向指针的指针或返回指针而不是返回指针`int`并使用 NULL 来指示错误。

PS - 还有其他问题，这是非常不安全的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T15:55:14.963

在循环中，您使用：

```
l=strlen(s); 
```

但`s`在循环中的任何地方都没有以 null 终止。因此，随后当您调用它时`strlen()`，它不会给您期望的结果，这可能是内存泄漏的原因。因此，请确保在循环中以 null 终止字符串。

`gets`很危险，因为它允许您阅读的内容超出您分配的空间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-21T15:57:33.683

gets() 是危险的，因为它不知道缓冲区实际有多大，因此它不能防止大输入行上的缓冲区溢出。对于坏人来说，缓冲区溢出是一种非常常见的攻击向量。使用 fgets() 和 stdin 作为第一个参数，它允许您指定缓冲区的大小。

# transactions - 基于事务的归档容器

> ID：10688382
> 
> 赞同：0
> 
> 时间：2012-05-21T15:45:06.610
> 
> 标签：transactions, filesystems, archive

我正在创建一个在插入特定 USB 密钥时运行的 Windows 服务。它的作用很简单：联系 FTP 服务器，下载一些文件，并将它们存储在 USB 上的（加密）存档中。可以使用提供给客户端的工具以只读方式打开存档（但这与我的问题无关）。

该服务用于使 USB 与主服务器保持同步（很像 Dropbox，但只有下载和同步文件夹位于可移动媒体上）。存档可以增长到几 GB。大约 1GB 的文件每周在大约 400 个用户的密钥上更新。

*由于整个更新过程对用户来说是透明的，当数据被写入存档时，他们拔掉*USB的可能性是不可忽略的（即使我发出了某种尖叫、华而不实的警告：**不要拔掉**）。损坏存档需要重新完整下载，这意味着在已经加载的服务器上浪费了大量带宽。

所以基本上我需要对存档的写入进行*交易*。如果他们失败了也没关系，只要他们不让容器处于不一致的状态。该文件要么完全写入，要么*不是*. 如果容器实际上没有“看到”文件，则文件被部分写入也没关系。

**问题就在这里：** 如何始终保证数据的一致性？具体来说，如何使 IO 操作作为事务工作？你有什么建议？我应该自己实现一些东西吗？还是已经有提供这种功能的容器？

这是我到目前为止所得到的：

*   **创建一个新存档，在提交时重命名**：不可能，存档太大。
*   **Zip / Tar / 7z**：不合适，写入失败会损坏存档
*   **Truecrypt**：不合适，因为它需要文件系统驱动程序（用户*没有*的管理员权限）。
*   **任何需要将文件系统映射到文件的事情**：不合适，很确定如果没有管理员身份就无法做到这一点，但如果可能的话，那就太好了。
*   **将文件存储在 SQLite DB 中**：它是 ACID，因此这确实是一个解决方案。但是，由于 SQLite 的 BLOB 容量有限，因此需要拆分文件。不是很优雅，但我准备好了。SQLite 的事务日志在存储大 blob 时也会变得非常大。
*   **自己实施**：我宁愿尽可能避免这样做，但我不害怕这样做。我只是觉得这个话题很复杂。

如果这个问题太笼统，请将其移至 SU 或其他地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:17:38.160

您可能想尝试使用 svn 或 git 之类的东西来下载加密的差异；如果文件损坏，它们通常可用于在本地重建文件。或者只是下载差异并使用补丁来生成最新的文件版本。

如果用户在写入数据的过程中拔下闪存驱动器，则会出现其他问题。许多是不可靠的（在闪存块级别，而不是文件系统级别），并且可能被损坏到 NTFS 或 EXT3 等日志文件系统无法恢复的程度。这里有更多细节：[https ://superuser.com/questions/290060/can-flash-memory-be-physically-damaged-if-power-is-interrupted-while-writing](https://superuser.com/questions/290060/can-flash-memory-be-physically-damaged-if-power-is-interrupted-while-writing)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:47:07.180

这很简单，真的。写入临时，如果写入完成则设置为主，否则删除并重试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:11:08.347

也许我们的[SolFS](http://www.eldos.com/solfs/)（应用程序版）会起作用。SolFS 在容器文件中提供了一个虚拟文件系统，它支持数据写入的日志模式，这有助于保持文件系统的完整性。

# javascript - 为谷歌自定义搜索框的商业版本提供占位符或值？

> ID：10688387
> 
> 赞同：2
> 
> 时间：2012-05-21T15:45:38.653
> 
> 标签：javascript, search

如何在我的 Google 自定义搜索框的付费版本中输入占位符或值？

我尝试使用 Google 提供的普通 API 脚本插件，如下所示：

```
<h5>SEARCH ON THIS SITE</h5></h6>
<div id="cse-search-form" style="width: 100%;">Loading ...</div>

<script type="text/javascript">
    google.load('search', '1', {language : 'en'});
    google.setOnLoadCallback(function() {
        var customSearchOptions = {};
        var imageSearchOptions = {};
        imageSearchOptions['layout'] = google.search.ImageSearch.LAYOUT_CLASSIC;
        customSearchOptions['enableImageSearch'] = true;
        customSearchOptions['imageSearchOptions'] = imageSearchOptions;  
        var customSearchControl = new google.search.CustomSearchControl(
        '312312312313123321312231:9cjokpdtmuaey', customSearchOptions);
        customSearchControl.setResultSetSize(
            google.search.Search.FILTERED_CSE_RESULTSET);
        var options = new google.search.DrawOptions();
        options.enableSearchboxOnly("search.htm");
        customSearchControl.draw('cse-search-form', options);
    }, true);
</script> 
```

我发布的代码中是否有任何可见的错误？

[我在这里](https://stackoverflow.com/questions/7857154/default-value-in-the-search-box-of-the-google-custom-search/10687999#10687999)的表格上找到了一个类似的问题，但是答案并没有解决我的问题：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T15:39:53.803

这是解决方案：

```
 <div id="cse-search-form" style="width:100%;"></div>
  <script src="http://www.google.com/jsapi" type="text/javascript"></script>
  <script type="text/javascript">
    google.load('search', '1', {language : 'en', style : google.loader.themes.SHINY});
    google.setOnLoadCallback(function() {
      var customSearchOptions = {};  var customSearchControl = new google.search.CustomSearchControl(
        'XXXXXXXXXXXXXXXXXXXXX:xxxxxxxxxxx', customSearchOptions);
      customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
      var options = new google.search.DrawOptions();
      options.setSearchFormRoot('cse-search-form');
      customSearchControl.draw('cse', options);
      customSearchControl.setSearchCompleteCallback(this,function(){
        jQuery('#main').hide();
        jQuery('#cse').show();
        var query = jQuery('input.gsc-input').val();
        jQuery('#cse:not(.processed)').prepend('<h1 id="page-title" class="title"><span class="left">Search</span>:<span class="right"></span></h1>').addClass('processed');
        jQuery('#cse .right').html(' ' + query);
      });
        jQuery('input.gsc-input:not(.placeholder)').val('Search').addClass('placeholder');
        // Focus on search box block.
        jQuery('input.gsc-input').bind('focus', function(){
         if (jQuery(this).val() == 'Search'){
        jQuery(this).val('');
         }
         }).bind('blur', function(){
           if (jQuery(this).val() === ''){
          jQuery(this).val('Search');
           }
        });
    }, true);
  </script> 
```

# python - Python从csv中删除负数条目/行

> ID：10688389
> 
> 赞同：2
> 
> 时间：2012-05-21T15:45:41.087
> 
> 标签：python, linux, csv, awk, matplotlib

我有一个不断增长的 csv 文件，如下所示：

```
143100, 2012-05-21 09:52:54.165852
125820, 2012-05-21 09:53:54.666780
109260, 2012-05-21 09:54:55.144712
116340, 2012-05-21 09:55:55.642197
125640, 2012-05-21 09:56:56.094999
122820, 2012-05-21 09:57:56.546567
124770, 2012-05-21 09:58:57.046050
103830, 2012-05-21 09:59:57.497299
114120, 2012-05-21 10:00:58.000978
-31549410, 2012-05-21 10:01:58.063470
90390, 2012-05-21 10:02:58.108794
81690, 2012-05-21 10:03:58.161329
80940, 2012-05-21 10:04:58.227664
102180, 2012-05-21 10:05:58.289882
99750, 2012-05-21 10:06:58.322063
87000, 2012-05-21 10:07:58.391256
92160, 2012-05-21 10:08:58.442438
80130, 2012-05-21 10:09:58.506494 
```

当生成文件的服务出现 API 连接失败时，会出现负数。我已经在使用 matplotlib 来绘制数据，但是人为的负数极大地扭曲了图表。我想找到所有负面条目并删除相应的行。在任何时候，负数都不能真正代表任何真实数据。

在 Bash 我会做类似的事情：

```
awk '{print $1}' original.csv | sed '/-/d' > new.csv 
```

但这很混乱，而且往往很慢，如果我能提供帮助，我真的不想在我的 python 图形脚本中嵌入 bash 命令。

谁能指出我正确的方向？

编辑：

这是我用来读取/绘制数据的代码：

```
import matplotlib
matplotlib.use('Agg')                                          
from matplotlib.mlab import csv2rec                           
import matplotlib.pyplot as plt                               
import matplotlib.dates as mdates                              
from pylab import *                                         

output_image_name='tpm.png'                   

data = csv2rec('counter.log', names=['packets', 'time'])   
rcParams['figure.figsize'] = 10, 5                              
rcParams['font.size'] = 8                                       

fig = plt.figure()                                              

plt.plot(data['packets'], data['time'])                      

ax = fig.add_subplot(111)                                       
ax.plot(data['time'], data['tweets'])                         
hours = mdates.HourLocator()                                    
fmt = mdates.DateFormatter('%D - %H:%M')                       
ax.xaxis.set_major_locator(hours)                               
ax.xaxis.set_major_formatter(fmt)                               

ax.grid()                                                

plt.ylabel("packets")                                         
plt.title("Packet Log: Packets Per Minute")         

fig.autofmt_xdate(bottom=0.2, rotation=90, ha='left')         

plt.savefig(output_image_name) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T15:53:42.427

Python 习惯用法是使用生成器表达式来过滤行：

```
sys.stdout.writelines(line for line in sys.stdin if not line.startswith('-')) 
```

或者在处理上下文中：

```
filtered = (line for line in sys.stdin if not line.startswith('-'))
for line in filtered:
    # ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:58:11.547

我不会重写文件，而是在读取时过滤数据，即在绘图之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:59:06.220

该程序打开您的 csv 文件，删除以负整数开头的行，并将其保存到不同的文件中。如果需要，您可以在同一个文件上稍作修改覆盖它。

```
with open('data.csv', 'r') as f:
    with open('data2.csv', 'w') as g:
        for row in f:
            if row[0] != '-':
                g.write(row) 
```

# javascript - 光滑的网格标题行搞砸了

> ID：10688391
> 
> 赞同：0
> 
> 时间：2012-05-21T15:45:48.813
> 
> 标签：javascript, jquery, slickgrid

我在光滑的网格标题上有一个过滤器。当我使用 setColumns 函数隐藏一列时，标题行会变得混乱。过滤器相互重叠。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:03:33.950

自己想出了解决方案。

函数 setColumns 正在重新初始化显示，并在顶部添加了额外的标题行。因此，在设置列之前必须删除现有的标题行。

我在调用 setColumns 之前写了以下行：

```
$('.slick-headerrow-column').remove(); 
```

# php - 带有外键的php搜索引擎

> ID：10688396
> 
> 赞同：-1
> 
> 时间：2012-05-21T15:46:15.313
> 
> 标签：php, mysql

我的搜索功能

```
 <?php
    $i=0;
    $column_name = 'title'; // column to search by
    $k =$_GET['k'];
    $terms = explode(" ",$k);
    //connect before calling mysql_real_escape_string
    mysql_connect("localhost","","");
    mysql_select_db("test");
    $query ="SELECT bookid,title,author 
    FROM  books WHERE";
    foreach ($terms as $each){
        $i++;
        $each = '%' . $each . '%'; // add wildcard
        $each = mysql_real_escape_string($each); // prevent sql injection
        if($i==1)
            $query .= " $column_name LIKE '$each' ";
        else
            $query .= " OR $column_name LIKE '$each' ";

    }

    echo 'QUERY: ' . $query;

    $query = mysql_query($query) OR DIE(mysql_error());

//Code below is for using the relationships table assuming you have a column name id that
//references to the relationships table. Also, you should add a index on the column id.

$results = "";

while($row = mysql_fetch_array($query)) {
  $results .= '<li>
                <a href="book-relationships.php?id='.$row['id'].'">'.$row['title'].'  author: '.$row['author'].'</a>
              </li>';
}

$results = '<ul>' . $results . '</ul>';

echo $results; 
```

我需要帮助在搜索时将一个数据库与另一个链接起来，这个数据库列出了所有在搜索中出现的书籍，然后将它们与另一个名为关系的表进行比较，并打印出与搜索的书籍有关系的书籍的标题。

当搜索运行时，这是在浏览器中产生的

```
QUERY: SELECT id,title,author FROM books WHERE title LIKE '%jarrads%' Unknown column 'id' in 'field list' 
```

任何帮助将不胜感激我 100% 被卡住了

图式

书籍 - bookid、title、author、yearpublished、publisher..... 关系 - relationshipid、bookOne、bookTwo、关系、relationshiplikes、relationshipdislikes

bookOne 和 bookTwo，与 bookid 相关

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:50:19.447

您的查询中有错误，因为错误消息指出：

`Unknown column 'id' in 'field list'`

检查您的表格`books`以获取有效字段的列表。实现此目的的一种方法是运行以下查询：

`SHOW CREATE TABLE books;`

# asp.net-mvc - div元素内的文本滚动

> ID：10688397
> 
> 赞同：1
> 
> 时间：2012-05-21T15:46:15.223
> 
> 标签：asp.net-mvc

我已经使用 div 在 mvc3 中创建了一个多框助手，所有项目看起来都很完美，垂直滚动也很好，但是当我在 div 内慢慢向下滚动时，一些文本看起来很模糊，如果我让它走几秒钟，它会调整并且文本是可见的好的。这看起来好像我在滚动时缓冲数据。

有什么建议么？

这是我在 div 上使用的 css

```
 border: gray 1px solid;
 width: 350px;
 height: 150px;
 float: left;
 overflow-y: scroll;
 background-color: White; 
```

# silverlight - Silverlight 与 Extjs

> ID：10688399
> 
> 赞同：1
> 
> 时间：2012-05-21T15:46:33.673
> 
> 标签：silverlight, extjs

我没有使用过 extJS 和 Silverlight。考虑到我必须研究的要求 - 有没有办法在 extJS 中托管 Silverlight 应用程序。我查看了 Sencha 论坛，但没有找到任何方向。

希望你们中的任何人之前都处理过这个问题？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:22:16.080

Ext-JS 是一个 JavaScript 框架，允许您动态创建 HTML 页面。Silverlight 是一个在 HTML 文档中嵌入交互式内容的插件，打包为 XAP。这种嵌入是通过 HTML`object`标签实现的。

您当然可以使用 Ext-JS 来动态添加`object`标签到页面并动态加载 XAP 文件。所以我会说答案是，是的，您可以使用 ExtJS 托管 Silverlight 内容。

# javascript - “window.location.href”和“window.location.hash”有什么区别？

> ID：10688401
> 
> 赞同：52
> 
> 时间：2012-05-21T15:46:35.207
> 
> 标签：javascript, jquery, hash, href, window.location

我学习了新的**“window.location.hash”**并在我的 jquery 代码中尝试了而不是**“window.location.href”**，它们都给出了相同的结果。

代码在这里：

```
window.location.href = ($(e.currentTarget).attr("href"));
window.location.hash = ($(e.currentTarget).attr("href")); 
```

它们之间有什么区别？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-05-21T15:49:10.873

对于像这样的网址`http://[www.example.com]:80/search?q=devmo#test`

**hash**返回 URL 中 # 符号之后的部分，包括 # 符号。您可以侦听 hashchange 事件以获取支持浏览器中哈希更改的通知。

```
Returns: #test 
```

**href**返回整个 URL。

```
Returns: http://[www.example.com]:80/search?q=devmo#test 
```

[**阅读更多**](https://developer.mozilla.org/en/DOM/window.location)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-21T15:49:09.187

例如对其进行测试`http://stackoverflow.com/#Page`

```
href = http://stackoverflow.com/#Page 
```

```
hash = #Page 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-21T15:47:38.987

href 是网址

hash 只是 url 之后的锚点

[http://www.xxxxxxx.com#anchor](http://www.xxxxxxx.com#anchor)

[http://www.xxxxxxx.com#anchor](http://www.xxxxxxx.com#anchor)是href

“#anchor”是哈希

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-21T15:48:17.677

`hash`并且`href`都是[`window.location`](https://developer.mozilla.org/en/DOM/window.location)对象的属性。`hash`是从 on 开始的 URL 的一部分`#`（如果没有，则为空字符串`#`），while`href`是整个 URL 的字符串表示形式。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-06-18T10:24:11.763

`window.location.href`这是和之间的区别的简单示例`window.location.hash`

对于网址`http://www.manm.com/member/#!create`：

*   参考资料：`http://www.manam.com/member/#!create`
*   哈希：`#!create`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-21T15:48:24.753

hash 属性返回 URL 的锚点部分，包括井号 (#)。

# c# - 使用 SQL Server 2005 中的字段写入 PDF

> ID：10688403
> 
> 赞同：1
> 
> 时间：2012-05-21T15:46:36.367
> 
> 标签：c#, asp.net, sql-server-2005, pdf

我正在使用 SQL Server 2005 运行一个 asp.net 4 / c# 站点，并希望将 SQL Server 中的列值写入其中已经包含内容的 PDF 文件（我想个性化您从记录的在我网站的页面中）

是否有一个简单的教程可以看，或者这是一个更大的工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:57:14.260

这里有两个部分：

1.  从数据库中读取数据（例如，使用 ADO.NET、Entity Framework 等）
2.  将该数据写入 PDF 文档（使用一些免费或商业 PDF 工具，如 iTextSharp、SharpPDF、XPDF、Docotic.Pdf 等）

您可以查看详细描述这两个部分的[这篇文章。](http://bitmiracle.com/blog/write-data-from-a-database-to-pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:25:48.020

好吧，我认为你有几个选择。

例如，您可以[使用 iTextSharp 基于模板创建 PDF 文档](http://www.johnnycode.com/blog/2010/03/05/using-a-template-to-programmatically-create-pdfs-with-c-and-itextsharp/)。在这种情况下，模板就是您提到的现有凭证。您必须通过识别字段或类似的方式来替换其中的信息。[使用PDFSharp](http://pdfsharp.com/)也可以完成类似的操作。

使用 iTextSharp 时请特别注意其许可协议，因为它是 AGPL，这意味着您的软件也必须是 GPL/AGPL。

现在，如果您想避免与 PDF 对象和 API 交互，您还有另一种选择。即创建一个 RDLC 本地报告，并[从您的代码隐藏中直接将其导出为 PDF](http://forums.asp.net/t/1556522.aspx/2/10)。在这种情况下，它不会基于现有的凭证，而是从头开始创建。

# date - 日期功能

> ID：10688404
> 
> 赞同：0
> 
> 时间：2012-05-21T15:46:42.200
> 
> 标签：date, php

我想打印特定日期的 7 天跨度。我尝试阅读 php 手册并尝试了几件事。没有任何结果。

```
<?php
function add_date($givendate,$day=0,$mth=0,$yr=0) {
      $cd = strtotime($givendate);
      $newdate = date('Y-m-d h:i:s', mktime(date('h',$cd),
                                            date('i',$cd), 
                                            date('s',$cd), 
                                            date('m',$cd)+$mth,
                                            date('d',$cd)+$day, 
                                            date('Y',$cd)+$yr));
      return $newdate;
}

?> 
```

但这并没有给我任何日期。除了今天的日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:01:30.183

您可以使用 DateTime 类：

例如：

```
$today = new DateTime("now");

$yesterday = $today->modify('-1 day');
$yesterday = get_object_vars($yesterday);
echo $yesterday['date']."<br>";

$twoDaysAgo = $today->modify('-1 day');
$twoDaysAgo = get_object_vars($twoDaysAgo);
echo $twoDaysAgo['date']; 
```

# .net - Microsoft.Office.Core 方法签名问题

> ID：10688408
> 
> 赞同：0
> 
> 时间：2012-05-21T15:47:00.297
> 
> 标签：.net, com, office-interop, boo

编译使用互操作的 Boo 项目时出现以下错误：

```
textbox = _ActiveWorkSheet.Shapes.AddTextbox(MsoTextOrientation.msoTextOrientationHorizontal, left, top, width, height) 
```

*方法 'Microsoft.Office.Interop.Excel.Shapes.AddTextbox(Microsoft.Office.Core.MsoTextOrientation, single, single, single, single)' 的最佳重载与参数列表 '(Microsoft.Office.Core .MsoTextOrientation，单，单，单，单）'。(BCE0017)*

如您所见，签名相同，问题似乎在于识别 MsoTextOrientation。

我为 2010 安装了 PIA，可以添加对 COM“Microsoft Office 14.0 对象库”的引用，并可以从中导入 Microsoft.Office.Core 命名空间。它只是在方法签名处分崩离析。

我正在使用 Sharpdevelop 3.2.1 中嵌入的 boo 编译器版本 0.9.1.3287。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:12:10.017

好的，

事实证明，将 Microsoft.Office.Core 命名空间引入项目有两种方法：

1.  从 COM 导入“Microsoft Office 14.0 对象库”（在您的参考资料中显示为“Office”）
2.  从 GAC 导入“办公室”（在您的参考资料中显示为“办公室”）

我不知道为什么它在 GAC 添加参考列表中被列为“办公室”而不是“Microsoft.Office.Core”。这就是为什么我错过了它并最终转而查看 COM，并看到命名空间导入良好，我认为一切都很好......

我不太了解如何处理来自不同程序集的相同命名空间，但是这些类型是否有可能被标记为不兼容只是一个 boo/Sharpdevelop 问题？我希望更多的人会遇到这个问题，因为它发生在 Visual Studio/C#...

# c# - 创建一个透明的图片框类

> ID：10688410
> 
> 赞同：1
> 
> 时间：2012-05-21T15:47:22.193
> 
> 标签：c#, winforms, picturebox

我的问题是我想在按钮上放置一个带有 png 的图片框，但 WinForms 似乎不支持那里的透明度。1\. 是的，我试过 Parent 2\. 是的，我试过 Color.Transparent

[我](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/f43ed61e-6e15-41f8-801d-1e908810eed2/)最后一次尝试也没有工作，我对此一无所知。也许你可以帮助我。然而，这是我迄今为止最接近的尝试。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Drawing;

namespace Parameter2
{
    public class TransPicturebox : Control
    {
        public TransPicturebox()
        {
            this.SetStyle(ControlStyles.AllPaintingInWmPaint | ControlStyles.OptimizedDoubleBuffer | ControlStyles.ResizeRedraw | ControlStyles.SupportsTransparentBackColor | ControlStyles.UserPaint, true);
            this.BackColor = Color.Transparent;
        }

        private Image _Image;

        public Image Image
        {
            get
            {
                return _Image;
            }
            set
            {
                _Image = value;
            }
        }

        private bool _autoscale = true;

        public bool AutoScale
        {
            get
            {
                return _autoscale;
            }
            set
            {
                _autoscale = value;
            }
        }

        protected override void OnPaint(PaintEventArgs e)
        {
            base.OnPaint(e);

            if (_Image != null) //keep from crashing if there is no image
            {
                if (_autoscale)
                {
                    //Auto Scale the image to fit in the text box
                    Rectangle rectangle = new Rectangle();
                    Size size = this.Image.Size;
                    float num = Math.Min((float)(((float)base.ClientRectangle.Width) / ((float)size.Width)), (float)(((float)base.ClientRectangle.Height) / ((float)size.Height)));
                    rectangle.Width = (int)(size.Width * num);
                    rectangle.Height = (int)(size.Height * num);
                    rectangle.X = (base.ClientRectangle.Width - rectangle.Width) / 2;
                    rectangle.Y = (base.ClientRectangle.Height - rectangle.Height) / 2;

                    e.Graphics.DrawImage(_Image, rectangle);
                }
                else
                {
                    e.Graphics.DrawImage(_Image, new Point(0, 0));
                }
            }
        }
    }
} 
```

# javascript - pjax beforesend 被多次调用？

> ID：10688411
> 
> 赞同：0
> 
> 时间：2012-05-21T15:47:21.913
> 
> 标签：javascript

我正在使用 pjax，如果表单有未保存的更改，我想使用 beforesend 调用向用户显示一条消息。我正在使用以下 javascript 代码

```
$(document).on('pjax:beforeSend', function() { 
    if (isDirty) {
        alreadyHandled = true;
        return confirm('You have unsaved changes! Are you sure you want to continue?');
        }
        return true;
    }); 
```

它返回多个窗口，我不知道为什么。为什么它多次显示同一个窗口，我该怎么做才能确保它只抛出一次？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:40:10.093

事实证明，我多次将 pjax 绑定到相同的事件。只需通过应用程序并更加小心我的 jquery 选择器就可以解决问题。

# wxpython - Python 框架 - 列表框

> ID：10688412
> 
> 赞同：1
> 
> 时间：2012-05-21T15:47:24.660
> 
> 标签：wxpython

下面的代码创建了一个带有列表框的框架以进行拖放。我想了解下一行中的代码..

FileAndTextDropTarget 是一个类..这个类是用 2 个函数调用的——OnFileDrop 和 OnTextDrop..我的问题是如何在没有传递参数文件或文本的情况下调用 OnFileDrop 或 OnTextDrop..

self.dt = FileAndTextDropTarget(self.OnFileDrop, self.OnTextDrop)

**代码：**

```
class DropTargetFrame(wx.Frame):
    pdb.set_trace()
    def __init__(self, parent, id=wx.ID_ANY, title="", 
                 pos=wx.DefaultPosition, size=wx.DefaultSize,
                 style=wx.DEFAULT_FRAME_STYLE,
                 name="DropTargetFrame"):
        super(DropTargetFrame, self).__init__(parent, id,
                                              title, pos,
                                              size, style,
                                              name)

        # Attributes
        choices = ["Drag and Drop Text or Files here",]
        self.list = wx.ListBox(self, 
                               choices=choices)
        self.dt = FileAndTextDropTarget(self.OnFileDrop,
                                        self.OnTextDrop)

        self.list.SetDropTarget(self.dt)

        # Setup
        self.CreateStatusBar()

    def OnFileDrop(self, files):
        self.PushStatusText("Files Dropped")
        for f in files:
            self.list.Append(f)

    def OnTextDrop(self, text):
        self.PushStatusText("Text Dropped")
        self.list.Append(text)

class FileAndTextDropTarget(wx.PyDropTarget):
    """Drop target capable of accepting dropped files and text"""
    def __init__(self, file_callback, text_callback):
        assert callable(file_callback)
        assert callable(text_callback)
        super(FileAndTextDropTarget, self).__init__()

        # Attributes
        self.fcallback = file_callback # Drop File Callback
        self.tcallback = text_callback # Drop Text Callback
        self._data = None
        self.txtdo = None
        self.filedo = None

        # Setup
        self.InitObjects()

    def InitObjects(self):
        """Initializes the text and file data objects"""
        self._data = wx.DataObjectComposite()
        self.txtdo = wx.TextDataObject()
        self.filedo = wx.FileDataObject()
        self._data.Add(self.txtdo, False)
        self._data.Add(self.filedo, True)
        self.SetDataObject(self._data)

    def OnData(self, x_cord, y_cord, drag_result):
        """Called by the framework when data is dropped on the target"""
        if self.GetData():
            data_format = self._data.GetReceivedFormat()
            if data_format.GetType() == wx.DF_FILENAME:
                self.fcallback(self.filedo.GetFilenames())
            else:
                self.tcallback(self.txtdo.GetText())

        return drag_result 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:33:49.180

据我了解，当您调用“SetDropTarget”时，您告诉 wxPython 在 GUI 的该部分上监视鼠标事件。TextDataObject 和类似的包含“智能”以了解它支持什么格式以及如何在它到达那里时呈现它（根据 wxPython 演示）。

所以当你选择一些东西并开始拖动它时，wxPython 可以分辨出来。也可以看看：

*   [http://xoomer.virgilio.it/infinity77/wxPython/Widgets/wx.DropTarget.html](http://xoomer.virgilio.it/infinity77/wxPython/Widgets/wx.DropTarget.html)
*   [http://xoomer.virgilio.it/infinity77/wxPython/Widgets/wx.DataObject.html](http://xoomer.virgilio.it/infinity77/wxPython/Widgets/wx.DataObject.html)

# javascript - 关于 replaceText 函数

> ID：10688423
> 
> 赞同：1
> 
> 时间：2012-05-21T15:48:11.017
> 
> 标签：javascript, jquery

在下面的 jQuery replaceText 函数中，有人可以向我解释一下该行的`remove.length && $(remove).remove();`作用吗？我不明白 && 这里的用法。

```
$.fn.replaceText = function( search, replace, text_only ) {  
  return this.each(function(){  
    var node = this.firstChild,  
      val,  
      new_val,  
      remove = [];  
    if ( node ) {  
      do {  
        if ( node.nodeType === 3 ) {  
          val = node.nodeValue;  
          new_val = val.replace( search, replace );  
          if ( new_val !== val ) {  
            if ( !text_only && /</.test( new_val ) ) {  
              $(node).before( new_val );  
              remove.push( node );  
            } else {  
              node.nodeValue = new_val;  
            }  
          }  
        }  
      } while ( node = node.nextSibling );  
    }  
    remove.length && $(remove).remove();  
  });  
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:51:18.953

由于短路的方式，只有在*true-ish*`$(remove).remove();`时才会被`remove.length`评估。

 *由于`remove`被声明为一个数组，所以基本上和下面的一样：

```
if(remove.length != 0)
   $(remove).remove(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:53:26.117

这里的`&&`意思是只有在不为 0`$(remove).remove()`时才会执行。`remove.length`

这是因为 the`&&`是一个短路运算符，因此如果它之前的评估为假，它将不会评估它之后的任何内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T15:59:23.140

尽管您对它的作用有一些正确的答案：

```
if(remove.length) // length is bigger than 0 (in this context)
   $(remove).remove(); 
```

我必须说代码很**愚蠢**，jQuery 知道如何处理空集。
所以当`$(remove).length == 0`代码`$(remove).remove();`什么都不做的时候。

您可以简单地使用它而无需`if`：

```
$(remove).remove(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T15:51:59.877

它说 ：

如果 remove.length 返回 0 以外的值（相当于 false），则删除该元素

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T15:53:37.120

它确保设置了“删除”对象

```
if(remove.length != 0) 
```

这样它就不会尝试删除不存在的东西。在 jQuery 中，如果对象 $(remove) 不存在，.length 函数将返回 0，这与 javascript 中的 False 一致。

如果它确实存在（remove.length > 0），那么它将使用 .remove() 函数将其删除。命名肯定是模棱两可的。

它基本上是一个内联条件语句，通过在不存在的对象上调用 .remove() 来防止异常。*

# solr - Solr 无法为 JSP 提供服务，管理界面 404s

> ID：10688426
> 
> 赞同：2
> 
> 时间：2012-05-21T15:48:21.427
> 
> 标签：solr, jetty, openjdk

我在使用 solr 时遇到问题。我在带有 OpenJDK 的 Ubuntu 上运行它：

```
>> java -version
java version "1.6.0_22"
OpenJDK Runtime Environment (IcedTea6 1.10.2) (6b22-1.10.2-0ubuntu1~11.04.1)
OpenJDK 64-Bit Server VM (build 20.0-b11, mixed mode) 
```

管理界面应该由 Jetty 7 提供服务，它根据以下说明安装在 solr/example 文件夹中：[http ://wiki.apache.org/solr/SolrJetty#Update_Jetty](http://wiki.apache.org/solr/SolrJetty#Update_Jetty)

在使用“start.jar”启动 solr 时，我看到以下内容：

```
>> java -jar
2012-05-21 14:03:01.121:WARN:oejd.ContextDeployer:ContextDeployer is deprecated. Use ContextProvider
2012-05-21 14:03:01.126:WARN:oejd.WebAppDeployer:WebAppDeployer is deprecated. Use WebAppProvider 
```

...此时该过程结束。

如果我改为使用“jetty7.jar”，则 solr 会启动并运行，但在尝试访问 localhost:8983/solr/ 的管理界面时，我会看到以下内容：

```
HTTP ERROR 404

Problem accessing /solr/. Reason:

    Servlet Not Initialized
Caused by:

javax.servlet.UnavailableException: Servlet Not Initialized 
```

命令行上的输出如下：

```
>> java -jar jetty7.jar 
2012-05-21 14:03:01.121:WARN:oejd.ContextDeployer:ContextDeployer is deprecated. Use ContextProvider
2012-05-21 14:03:01.126:WARN:oejd.WebAppDeployer:WebAppDeployer is deprecated. Use WebAppProvider
2012-05-21 14:03:01.129:INFO:oejs.Server:jetty-7.6.3.v20120416
2012-05-21 14:03:01.238:INFO:oejw.WebInfConfiguration:Extract jar:file:/var/lib/solr/apache-solr-3.6.0/example/webapps/solr.war!/ to /tmp/jetty-0.0.0.0-8983-solr.war-_solr-any-/webapp
2012-05-21 14:03:02.518:INFO:oejw.StandardDescriptorProcessor:NO JSP Support for /solr, did not find org.apache.jasper.servlet.JspServlet
2012-05-21 14:03:02.565:INFO:oejsh.ContextHandler:started o.e.j.w.WebAppContext{/solr,file:/tmp/jetty-0.0.0.0-8983-solr.war-_solr-any-/webapp/},file:/var/lib/solr/apache-solr-3.6.0/example/webapps/solr.war
May 21, 2012 2:03:02 PM org.apache.solr.core.SolrResourceLoader locateSolrHome
INFO: JNDI not configured for solr (NoInitialContextEx) 
```

我认为“NO JSP Support for /solr, did not find org.apache.jasper.servlet.JspServlet”是罪魁祸首。

任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:09:27.757

最终破解它：我意识到我没有从码头文件夹中复制 start.ini 和 start.jar 并且那里有一些需要的配置。

# javascript - 连续动画显示或隐藏元素而不褪色

> ID：10688429
> 
> 赞同：0
> 
> 时间：2012-05-21T15:48:38.987
> 
> 标签：javascript, html

我想依次显示和隐藏两个页面元素。

这是代码：

```
$(document).ready(function() {  
    var continuous = function () {
    setTimeout(function() { $("#Mass_alert").css('display','block'); $("#Devotion_alert").css('display','none'); },1500);
    setTimeout(function() { $("#Mass_alert").css('display','none'); $("#Devotion_alert").css('display','block'); },1500);
    };
    setInterval(continuous,500); 
}); 
```

这是 HTML：

```
 <div id="Mass_alert" class="alert" style="position: relative; top: 3px; margin: 0 auto; text-align: center; width:100%; height: 20px;">Mass alert</div>
  <div id="Devotion_alert" class="alert" style="position: relative; top: 3px; margin: 0 auto; text-align: center; width:100%; height: 20px;">devotion alert</div> 
```

我得到正确的效果一次。我应该在上面的代码中进行哪些更改才能产生持续的效果。我不想使用fadeToggle，因为我实际上需要`display:none`设置。如果我不这样做，那么就会为隐藏元素留下空间，这会干扰其他元素的放置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:05:06.880

尝试：

```
setInterval(function () {
  $('#Mass_alert, #Devotion_alert').toggle();
}, 1500); 
```

与：

```
<div id="Mass_alert" class="alert" style="position: relative; top: 3px; margin: 0 auto; text-align: center; width:100%; height: 20px;">Mass alert</div>
<div id="Devotion_alert" class="alert" style="position: relative; top: 3px; margin: 0 auto; text-align: center; width:100%; height: 20px; display: none;">devotion alert</div>​ 
```

演示：http: [//jsfiddle.net/qxMdA/1/](http://jsfiddle.net/qxMdA/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:00:36.120

试着来回切换。

```
var a = false;
$(document).ready(toggle);
function toggle() {
    if (a) {
        $("#Mass_alert").css('display','block'); $("#Devotion_alert").css('display','none'); 
    }
    else
    {
        $("#Mass_alert").css('display','none'); $("#Devotion_alert").css('display','block'); 
    }

    a = !a;

    setTimeout(toggle, 1500);
} 
```

# ember.js - 向 Ember.StateManager 发送操作：goToState 是强制性的吗？

> ID：10688436
> 
> 赞同：1
> 
> 时间：2012-05-21T15:49:01.743
> 
> 标签：ember.js

在 Ember.StateManager 的文档中说：“在一个动作方法内部，给定的状态应该委托其 StateManager 上的 goToState 调用”。这是否意味着如果我发送一个动作消息，我必然需要转换到另一个状态。是否可以保持相同的状态，但通过发送动作来完成某些任务？例如，我处于“加载”状态并运行两个操作“预处理”和“显示”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T02:55:39.437

非常简单：一个动作消息可以但不必转换到另一个状态。

您没有问过但相关且重要的事情：调用or方法是`goToState`一个坏主意和坏设计。`enter``exit`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:12:27.490

通常在处理状态图时，您可以做任何您想做的事情。在事件处理程序中切换状态不是强制性的。一个常见的情况是显示取消/保存对话框的事件处理程序。您可以轻松地将对话框放在事件处理程序中的页面上，并根据按下的按钮进行相应的处理。

一个单独的问题是每个事件处理程序基本上是否*应该*进入另一个状态。在上述场景中，您当然可以进入“确认”状态，state-enter 方法将显示对话框，并且会有两个处理程序，每个按钮一个。这些处理程序将依次转到其他州。

我认为这两种设计选择同样有效，至少在那种情况下是这样。 *如果* 你选择为每个动作实现一个单独的状态，你最终会得到很多小而简洁的状态。 *如果*您选择在事件处理程序本身中做一些事情，您的状态会更大，但它们会更少。

我要说的一件事是**，如果**事件处理程序变得复杂，您可能最好使用新状态。另外，要保持一致。

对于您的特定场景，如果我没看错，您希望加载数据，然后根据事件更改显示以显示数据。在这种情况下，我会使用新的状态。

所以你按下一个按钮来启动这个过程

*   在事件处理程序中，进入某种“MyDataSection”状态
*   初始子状态是“loadData”
*   'loadData' 的进入状态方法开始加载过程
*   'loadData' 中的事件处理程序 'dataLoaded' 在数据加载时进行处理；这意味着您需要在数据加载时触发一个事件
*   “dataLoaded”事件进入“显示”状态
*   show state 显示视图（或删除活动指示器等）并处理来自显示的任何事件。

这里的好处是，如果你有多种方式可以到达应用程序的这个部分，所有导致这个部分的操作只需要进入这个状态，一切都会发生同样的事情。另请注意，由于视图事件处理程序处于显示状态，如果用户在数据加载时点击按钮，则不会发生任何事情。

# iphone - iOS 界面方向

> ID：10688441
> 
> 赞同：0
> 
> 时间：2012-05-21T15:49:20.800
> 
> 标签：iphone, ios, xcode, interface, orientation

如何在不覆盖 UIViewController 方法的情况下启用界面旋转：

```
-(BOOL)shouldAuorotateToInterfaceOrientation 
```

我的应用程序中没有 UIViewController 类，只有 UIView。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:04:34.183

如果您没有控制器，则必须先创建一个控制器才能正常工作。在设置 *.plist 文件中，您有两个选项，称为“支持的界面方向”和“支持的界面方向 (iPad)”。启用您想要支持的那些。

然后在你想要支持方向的 UIViewControllers 上，你必须重写`-(BOOL)shouldAuorotateToInterfaceOrientation`以返回`YES`你想要支持的方向并编写所有必要的绘图代码以将所有内容放置在适当的位置。

# ssis - 通过 SQL Server 作为作业运行时，SSIS 包失败

> ID：10688443
> 
> 赞同：2
> 
> 时间：2012-05-21T15:49:29.583
> 
> 标签：ssis

第一次海报。

我创建了一个 SSIS 包，它读取文本文件并将数据放在 SQL Server 的表中。当我在 VS2005 中运行它时，它将数据插入表中没有问题。如果我在 SQL 中运行作业来调用 SSIS 包，它会失败并且我收到附加错误。

我对这一切都很陌生，所以我的技能不是很好，但我正在试一试！！（我已从错误消息中删除了服务器名称和我的登录凭据）

错误信息

> 日期、来源、严重性、步骤 ID、服务器、作业名称、步骤名称、通知、消息、持续时间、Sql 严重性、Sql 消息 ID、操作员发送电子邮件、操作员网络发送、操作员分页、重试次数 2012 年 5 月 21 日 15:33 :28,importsCallDataTest,Error,0,importsCallDataTest,(作业结果),,作业失败。作业由用户调用 运行的最后一步是步骤 1 (importsData)。,00:00:01,0,0,,,,0 05/21/2012 15:33:28,importsCallDataTest,Error,1, ,importsCallDataTest,importsData,,作为用户执行：\SYSTEM。....00.4035.00 适用于 32 位版权所有 (C) Microsoft Corp 1984-2005。版权所有。开始时间：下午 3:33:28 进度：2012-05-21 15:33:28.71 来源：数据流任务
> 验证：完成 0% 完成进度进度：2012-05-21 15:33:28.71 来源：数据流任务验证：完成 50% 完成进度进度：2012-05-21 15:33:28.84 来源：数据流任务验证： 100% 完成 结束进度 进度：2012-05-21 15:33:28.85 来源：数据流任务验证：0% 完成 结束进度进度：2012-05-21 15:33:28.85 来源：数据流任务验证：50%完成结束进度进度：2012-05-21 15:33:28.87 来源：数据流任务验证：100% 完成结束进度进度：2012-05-21 15:33:28.87
> 来源：数据流任务准备执行：0% 完成结束进度进度：2012-05-21 15:33:28.87 来源：数据流任务准备...包执行失败...步骤失败。,00： 00:01,0,0,,,,0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:54:03.143

SQL Server 作业由 SQL Server 代理的帐户运行。

您必须检查此帐户是否有权访问该文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T03:45:40.300

在创建包时，您还应该保存源和目标的凭据。在创建包时，您必须使用 Sql Server Agents 帐户登录。

还可以尝试：--首先部署包，然后制定作业计划。--为 SSIS 包创建新的 CREDENTIAL 和代理，并使用此代理而不是 sql server 代理帐户。

# objective-c - 带有渐变层的 UIButton 不突出显示

> ID：10688444
> 
> 赞同：1
> 
> 时间：2012-05-21T15:49:35.477
> 
> 标签：objective-c, ios

创建了一个带有渐变层的按钮：

```
//MyGradient creates and returns gradient layers
CAGradientLayer *gradient = [MyGradient blueGradient];

//MyButton is a subclassed UIButton which adds some attributes
MyButton *testButton = [MyButton buttonWithType:UIButtonTypeCustom];
testButton.frame = CGRectMake(10, 10, 150, 50);
[testButton addTarget:self action:@selector(testButton:) forControlEvents:UIControlEventTouchUpInside];

[gradient setFrame:testButton.bounds];

testButton.clipsToBounds = YES;
[testButton.layer insertSublayer:gradient atIndex:0];    

[self.view addSubview:testButton]; 
```

按下时如何使图像突出显示？我找到了一些示例代码，它们继承了 UIButton 并覆盖了 drawRect: 方法。有没有更简单的方法让按钮突出显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:26:19.073

您的按钮没有图像 - 所以没有什么可以突出显示的。

将图像（如果需要，渐变图像）设置为按钮的背景......即使您没有为 UIControlStateHighlighted 设置图像，按钮也会“突出显示” - 基本上，iOS 会反转颜色。

此外，如果您只需要水平/仅垂直渐变，您可能需要检查此功能：[resizableImageWithCapInsets](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html#//apple_ref/occ/instm/UIImage/resizableImageWithCapInsets%3a)

玩得开心 ！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:05:58.177

没有内置的方法可以做到这一点。要么重载 UIButton 并`drawRect`根据按钮的状态自己绘制渐变，要么为两种状态创建 2 个渐变图像并使用`setBackgroundImage:image forState:UIControlStateNormal`/ `UIControlStateHighlighted`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:07:47.523

最简单的做法是将渐变放入图像文件（最好可调整大小）并使用以下代码：

```
[testButton setImage:normalStateImage forState:UIControlStateNormal];
[testButton setImage:highlightStateImage forState:UIControlStateHighlighted]; 
```

# jsf-2 - javax.faces.context.ExceptionHandlerFactory java.lang.IllegalArgumentException

> ID：10688445
> 
> 赞同：1
> 
> 时间：2012-05-21T15:49:39.813
> 
> 标签：jsf-2, myfaces

```
May 21, 2012 6:48:06 PM org.apache.myfaces.webapp.AbstractFacesInitializer initFaces
SEVERE: An error occured while initializing MyFaces: javax.faces.context.ExceptionHandlerFactory
java.lang.IllegalArgumentException: javax.faces.context.ExceptionHandlerFactory

May 21, 2012 6:48:09 PM com.sun.facelets.FaceletViewHandler handleRenderException
SEVERE: Error Rendering View[/login.jsp]
com.sun.facelets.FaceletException: Error Parsing /login.jsp: Error Traced[line: 1] The markup in the document preceding the root element must be well-formed.

May 21, 2012 6:48:09 PM org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet Faces Servlet threw exception
com.sun.facelets.FaceletException: Error Parsing /login.jsp: Error Traced[line: 1] The markup in the document preceding the root element must be well-formed. 
```

# symfony - 如何从扩展中访问会话？

> ID：10688446
> 
> 赞同：1
> 
> 时间：2012-05-21T15:49:46.780
> 
> 标签：symfony

如果你想从控制器访问会话，你可以使用`this->get('session');`.

但是它是如何在扩展中工作的呢？

我尝试在 services.xml 中配置它并调整 __construct($session) 方法：

```
<service id="myService" class="%myServie.class%">
    <argument type="service" id="session"/>
</service> 
```

没用。（空对象）

我尝试从请求中达到它：

```
$request = Request::createFromGlobals();
$session = $request->getSession(); 
```

没用。（空对象）

目前我正在为我的方法提供我在控制器中检索的会话，但我对这个解决方案不满意（我认为这是一个肮脏的解决方案）。

你如何以正确的方式做到这一点？

问候， Senad

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:00:39.957

您可以通过多种方式解决此问题。一种方法是使用在整个框架中使用的依赖注入。

如果您将会话传递给您的扩展构造函数，那么您就是将会话“注入”到类中。

### 示例代码

```
class MyService
{
    public function __construct($session)
    {
        // ...
    }
}

class MyController extends Controller
{
    public function exampleAction()
    {
        $myService = new MyService($this->get('session'));
    }
} 
```

Symfony 2 提供了一种自动注入此会话的方法。为此，您需要创建一个服务：

### services.yml 示例代码

```
services:
    myService:
        class: %myService.class%
        arguments: ["@session"] 
```

然后在您的控制器中，您可以获得服务：

```
$myService = $this->get('myService'); 
```

# scala - scala Either.RightProjection 混淆（用于理解去糖）

> ID：10688447
> 
> 赞同：12
> 
> 时间：2012-05-21T15:49:52.637
> 
> 标签：scala, for-loop, monads, either

我可以`=`在 scala 中使用 an 进行理解（如[SLS的第](http://www.scala-lang.org/docu/files/ScalaReference.pdf)[**6.19**](http://www.scala-lang.org/docu/files/ScalaReference.pdf)节中所述），如下所示：

## 选项

假设我有一些功能`String => Option[Int]`：

```
scala> def intOpt(s: String) = try { Some(s.toInt) } catch { case _ => None }
intOpt: (s: String)Option[Int] 
```

然后我可以这样使用它

```
scala> for {
   |     str <- Option("1")
   |     i <- intOpt(str)
   |     val j = i + 10    //Note use of = in generator
   |   }
   |   yield j
res18: Option[Int] = Some(11) 
```

据我了解，这基本上等同于：

```
scala> Option("1") flatMap { str => intOpt(str) } map { i => i + 10 } map { j => j }
res19: Option[Int] = Some(11) 
```

也就是说，嵌入式生成器是将 a 注入`map`到一系列`flatMap`调用中的一种方式。到现在为止还挺好。

## 无论是.RightProjection

**我真正想做的是**：*使用与前面使用`Either`monad*的示例类似的理解。

但是，如果我们在类似的链中使用它，但这次使用`Either.RightProjection`monad/functor，它就不起作用：

```
scala> def intEither(s: String): Either[Throwable, Int] = 
  |      try { Right(s.toInt) } catch { case x => Left(x) }
intEither: (s: String)Either[Throwable,Int] 
```

然后使用：

```
scala> for {
 | str <- Option("1").toRight(new Throwable()).right
 | i <- intEither(str).right //note the "right" projection is used
 | val j = i + 10
 | }
 | yield j
<console>:17: error: value map is not a member of Product with Serializable with Either[java.lang.Throwable,(Int, Int)]
              i <- intEither(str).right
                ^ 
```

这个问题与右投影期望作为其`flatMap`方法的参数的函数有关（即它期望一个`R => Either[L, R]`）。但是修改为不调用`right`第二个生成器，它仍然不会编译。

```
scala>  for {
 |        str <- Option("1").toRight(new Throwable()).right
 |        i <- intEither(str) // no "right" projection
 |          val j = i + 10
 |      }
 |      yield j
<console>:17: error: value map is not a member of Either[Throwable,Int]
              i <- intEither(str)
                            ^ 
```

## 大混乱

但现在我变得双重困惑。以下工作正常：

```
scala> for {
 |       x <- Right[Throwable, String]("1").right
 |       y <- Right[Throwable, String](x).right //note the "right" here
 |     } yield y.toInt
res39: Either[Throwable,Int] = Right(1) 
```

但这不会：

```
scala> Right[Throwable, String]("1").right flatMap { x => Right[Throwable, String](x).right } map { y => y.toInt }
<console>:14: error: type mismatch;
 found   : Either.RightProjection[Throwable,String]
 required: Either[?,?]
              Right[Throwable, String]("1").right flatMap { x => Right[Throwable, String](x).right } map { y => y.toInt }
                                                                                             ^ 
```

我认为这些是等价的

*   到底是怎么回事？
*   如何将`=`生成器嵌入到一个 for 理解中`Either`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T16:06:22.707

您无法将 嵌入到`=`理解中的事实与Jason Zaugg 报告的[这个问题有关；](https://issues.scala-lang.org/browse/SI-5793?focusedCommentId=57583&page=com.atlassian.jira.plugin.system.issuetabpanels%3acomment-tabpanel#comment-57583)解决方案是右偏`Either`（或创建一个与其同构的新数据类型）。

对于您的巨大困惑，您错误地扩展了糖。脱糖

```
for {
  b <- x(a)
  c <- y(b)
} yield z(c) 
```

是

```
x(a) flatMap { b =>
 y(b) map { c =>
  z(c) }} 
```

并不是

```
x(a) flatMap { b => y(b)} map { c => z(c) } 
```

因此，您应该这样做：

```
scala> Right[Throwable, String]("1").right flatMap { x => Right[Throwable, String](x).right map { y => y.toInt } }
res49: Either[Throwable,Int] = Right(1) 
```

### 脱糖更有趣（`j = i + 10` 问题）

```
for {
  b <- x(a)
  c <- y(b)
  x1 = f1(b)
  x2 = f2(b, x1)
  ...
  xn = fn(.....)
  d <- z(c, xn)
} yield w(d) 
```

被脱糖成

```
x(a) flatMap { b =>
  y(b) map { c =>
    x1 = ..
    ...
    xn = ..
    (c, x1, .., xn) 
  } flatMap { (_c1, _x1, .., _xn) =>
    z(_c1, _xn) map w }} 
```

因此，在您的情况下，具有未定义`y(b)`的结果类型。`Either``map`

# wif - 在没有 LoadUserProfile = True 的情况下运行 WIF 会引发空错误

> ID：10688448
> 
> 赞同：0
> 
> 时间：2012-05-21T15:49:53.243
> 
> 标签：wif, acs

我在我的网站中使用 WIF SSO 进行身份验证。一切都在开发环境中完美运行。但是在部署时我遇到了问题

> 消息：数据保护操作不成功。这可能是由于没有为当前线程的用户上下文加载用户配置文件，这可能是线程模拟时的情况。ExceptionStackTrace：在 System.Security.Cryptography.ProtectedData.Protect(Byte[] userData, Byte[] optionalEntropy, DataProtectionScope 范围) 在 Microsoft.IdentityModel.Web.ProtectedDataCookieTransform.Encode(Byte[] value)

搜索 abt this issue 将我引向这个 stackoverflow 问题 [Is it possible to run WIF without LoadUserProfile = True](https://stackoverflow.com/questions/5464146/is-it-possible-to-run-wif-without-loaduserprofile-true) 我添加了提到的代码，但现在我得到了

> 值不能为空

我得到**e.ServiceConfiguration.ServiceCertificate** ServiceCertificate null。我的问题是这是什么类型的证书，我在哪里可以在我的配置中定义它。我是否需要在 ACS 上放置相同的证书。

这是我的配置部分

```
<microsoft.identityModel>
    <service>
      <audienceUris>
        <add value="http://localhost:9494/" />
      </audienceUris>      
      <federatedAuthentication>
        <wsFederation passiveRedirectEnabled="true" issuer="https://devworks-sb.accesscontrol.appfabriclabs.com/v2/wsfederation" realm="http://localhost:9494" requireHttps="false" />
        <cookieHandler requireSsl="false" />
      </federatedAuthentication>
      <applicationService>
        <claimTypeRequired>
          <!--Following are the claims offered by STS 'https://devworks-sb.accesscontrol.appfabriclabs.com/'. Add or uncomment claims that you require by your application and then update the federation metadata of this application.-->
          <claimType type="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name" optional="true" />
          <claimType type="http://schemas.microsoft.com/ws/2008/06/identity/claims/role" optional="true" />
          <!--<claimType type="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier" optional="true" />-->
          <!--<claimType type="http://schemas.microsoft.com/accesscontrolservice/2010/07/claims/identityprovider" optional="true" />-->
        </claimTypeRequired>
      </applicationService>
      <issuerNameRegistry type="Microsoft.IdentityModel.Tokens.ConfigurationBasedIssuerNameRegistry, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
        <trustedIssuers>
          <add thumbprint="BE9D0A516BEC2BC820C23D5C2EA79F068C094382" name="https://devworks-sb.accesscontrol.appfabriclabs.com/" />
        </trustedIssuers>
      </issuerNameRegistry>      
    </service>   </microsoft.identityModel> 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T05:47:26.967

您提到的第一件事是部署后出现问题，对吗？在您的 web.config 中，您是否将 AudienceUris 更改为[http://whatever_service_name.cloudapp.net](http://whatever_service_name.cloudapp.net)？

```
<audienceUris>
    <add value="http://localhost:9494/" /> <== This is  wrong
 </audienceUris> 
```

接下来，您在 e.ServiceConfiguration.ServiceCertificate 中关于证书的问题为 NULL，请验证以下内容：

A. Endpoint 被添加到你的应用服务定义中：

B. 证书指纹在服务配置中设置

C. 证书在 web.config 中设置，上面是正确的

D. 最后在您的 web.config 中添加以下内容，以便可以通过指纹搜索证书：

```
<serviceCertificate>
   <certificateReference x509FindType="FindByThumbprint" findValue="CERT_THUMB" />
</serviceCertificate> 
```

研究这两个非常有用的资源：

[http://www.jimandkatrin.com/CodeBlog/post/Troubleshooting-Azure-issues.aspx](http://www.jimandkatrin.com/CodeBlog/post/Troubleshooting-Azure-issues.aspx)

[http://blogs.msmvps.com/marcelmeijer/blog/2012/05/04/windows-azure-wif-access-control-acs/](http://blogs.msmvps.com/marcelmeijer/blog/2012/05/04/windows-azure-wif-access-control-acs/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T07:42:20.517

根本原因可能是您使用的是 DPAPI（WIF 的默认配置）。请尝试对应用程序进行一些修改以在 Windows Azure 中运行。我建议您查看[http://msdn.microsoft.com/en-us/IdentityTrainingCourse_WIFonWAZLab2010](http://msdn.microsoft.com/en-us/IdentityTrainingCourse_WIFonWAZLab2010)以获取教程。

此致，

明旭。

# winforms - 如何恢复最小化形式

> ID：10688450
> 
> 赞同：4
> 
> 时间：2012-05-21T15:49:58.520
> 
> 标签：winforms, windows-7

这是一个如此平凡的问题，我认为我可以立即解决它，但没有。我的表单大小和位置在退出时保存在应用程序设置中，以便下次运行应用程序时恢复。如果用户在最小化表单时关闭表单，我将无法恢复到正常状态。表单恢复为最小化，单击任务栏按钮什么也不做。我在 FormClosing 事件中保存了位置和大小，但如果表单被最小化，我将保存最小化的大小（160、40）和位置（-32000、-32000），这对于恢复表单是完全不正确的。我想强制表单从不恢复最小化，而是恢复到最后的正常大小和位置。不知何故，我必须在表单最小化并保存之前捕获大小和位置，然后在 FormClosing 上，如果表单最小化，则不保存大小和位置。这可能不是100％清楚，

FormClosing 处理程序：

```
 private void MainForm_FormClosing(object sender, FormClosingEventArgs e)
    {
        Settings.Default.WindowLocation = Location;
        Settings.Default.WindowSize = Size;
        Settings.Default.WindowState = WindowState;
        Settings.Default.Save();
    } 
```

恢复代码：

```
 private void RestoreWindow()
    {
        Location = Settings.Default.WindowLocation;
        if(Location.X == 0 && Location.Y == 0)
            StartPosition = FormStartPosition.CenterScreen;

        Size = Settings.Default.WindowSize;

        WindowState = FormWindowState.Normal;

        if(Size.Width > Screen.PrimaryScreen.WorkingArea.Width)
        {
            Location = new Point(0, Location.Y);
            Size = new Size(Screen.PrimaryScreen.WorkingArea.Width, Size.Height);
        }

        if(Size.Height > Screen.PrimaryScreen.WorkingArea.Height)
        {
            Location = new Point(Location.X, 0);
            Size = new Size(Size.Width, Screen.PrimaryScreen.WorkingArea.Height);
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:01:44.170

如果表单不处于正常状态，则不应保存表单的`Location`or ：`Size`

```
private void MainForm_FormClosing(object sender, FormClosingEventArgs e)
{
  if (this.WindowState == FormWindowState.Normal) {
    Settings.Default.WindowLocation = Location;
    Settings.Default.WindowSize = Size;
  }
  Settings.Default.WindowState = WindowState;
  Settings.Default.Save();
} 
```

您的还原窗口例程没有完全意义。如果要使表格居中，为什么要保存位置？以最小化模式启动程序*可能是*不可取的，在这种情况下，我会将其默认为`Normal`：

```
private void RestoreWindow()
{
  this.Location = Settings.Default.WindowLocation;
  this.Size = Settings.Default.WindowSize;

  // check for size or location off-screen, etc.

  if ((FormWindowState)Settings.Default.WindowState == FormWindowState.Minimized)
    this.WindowState = FormWindowState.Normal;
  else
    this.WindowState = Settings.Default.WindowState;
} 
```

如果您需要恢复窗口的*最后*正常位置，则可以使用`OnResizeEnd`覆盖来保存设置：

```
protected override void OnResizeEnd(EventArgs e) {
  if (this.WindowState == FormWindowState.Normal) {
    Properties.Settings.Default.Location = this.Location;
    Properties.Settings.Default.Size = this.Size;
  }
  base.OnResizeEnd(e);
} 
```

那么你的闭幕式就是：

```
protected override void OnFormClosing(FormClosingEventArgs e) {
  Properties.Settings.Default.WindowState = this.WindowState;
  Properties.Settings.Default.Save();
  base.OnFormClosing(e);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:07:25.403

仅当 Form.WindowState 属性与 FormWindowState.Minimized 不同时，将窗体的大小和位置分别存储在 Form.Resize 事件处理程序和 Form.Move 事件处理程序中的局部变量中。然后将大小和位置变量的内容保存在设置中，在 FormClosing 事件处理程序中。

# html - 我怎样才能摆脱细胞之间的大空间？

> ID：10688451
> 
> 赞同：0
> 
> 时间：2012-05-21T15:49:59.650
> 
> 标签：html, css, html-table

我有一个网站[http://pigymunk.co.uk](http://pigymunk.co.uk)，如您所见，该表有一些故障，即 2 个单元格之间的间隙很大。谁能帮忙找出这个毛病？

```
<table border="0" align="center" width="300" style="float:center" cellspacing="0">
<tr>
   <td><img src="http://www.pigymunk.co.uk/jackw.png" alt="JackW" style="align:"middle"/></td>
   </tr>
<tr>
   <td><a href="http://pigymunk.co.uk/?page_id=2" target="_self"><img src="http://www.pigymunk.co.uk/About%20icon.png" alt="About" style=" align:"middle"/></a>    </td>
   <td><a href="http://pigymunk.co.uk/?page_id=76" target="_self"><img src="http://www.pigymunk.co.uk/Blog%20icon.png" alt="Blog" style=" align:"middle"/></a></td> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:59:43.013

您可以更改第一个单元格的 colspan 属性以跨越其他列。请注意具有`<td colspan="4">`. 尝试这个：

```
<table border="0" align="center" width="300" style="float:center" cellspacing="0">
<tr>
   <td colspan="4"><img src="http://www.pigymunk.co.uk/jackw.png" alt="JackW" style=" align:"middle"/></td>
</tr>
<tr>
   <td><a href="http://pigymunk.co.uk/?page_id=2" target="_self"><img src="http://www.pigymunk.co.uk/About%20icon.png" alt="About" style=" align:"middle"/></a></td>
   <td><a href="http://pigymunk.co.uk/?page_id=76" target="_self"><img src="http://www.pigymunk.co.uk/Blog%20icon.png" alt="Blog" style=" align:"middle"/></a></td>
   <td><a href="http://facebook.com/jackweatherilt" target="_self"><img src="http://www.pigymunk.co.uk/Faceb%20icon.png" alt="Facebook" align:"middle"/></a></td>
   <td><a href="http://pigymunk.co.uk/distractions" target="_self"><img src="http://www.pigymunk.co.uk/distractions.png" alt="Demos" align:"middle"/></a></td>
</tr>
</table> 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/Ws6ZH/)**。

顺便说一句，您可能需要考虑更新代码并摆脱不推荐使用的属性，例如`align="center"`内联 CSS 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:01:49.900

快速修复：将第一个更改`<td>`为`<td colspan="4">`.

您的表格第一行有一个单元格，第二行有四个单元格。这违反了 HTML 表格模型原则，所以所有的赌注都没有了。在实践中发生的事情就是您在此处看到的：第一个单元格（大图像）被视为仅属于第一列。

这可以在例如 Firefox Web Developer Extension 中看到，它具有在所有单元格周围绘制边框的功能。

# jquery - jQuery BannerRotator 在一个页面上工作，但在另一个页面上不工作

> ID：10688454
> 
> 赞同：1
> 
> 时间：2012-05-21T15:50:15.243
> 
> 标签：jquery, html, wordpress, jquery-ui

我希望有人能帮忙。

我有一个横幅旋转器，可以在一页上正常工作，但在另一页上却不行。我刚刚将代码从一页复制并粘贴到另一页，并更改了路径，以便它们指向正确的位置。我已经检查过一切都是一样的，并且我使用了 W3 断开链接检查器并且链接都很好。但是，旋转器只会在一页上播放：[http](http://www.electrickiwi.co.uk/test/bannerRotator/index.html) ://www.electrickiwi.co.uk/test/bannerRotator/index.html 。

我希望它在[http://www.electrickiwi.co.uk](http://www.electrickiwi.co.uk)上工作，但似乎无法让它工作。

有没有人对可能出现的问题有任何想法？

谢谢！

罗斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:53:31.577

不工作的页面有一个与未定义方法“可拖动”相关的JS错误，这显然会导致其他JS无法工作。您是否可能忘记添加预期的 JS 库？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T15:56:40.903

您的页面抛出 javascript 错误，例如：

*   加载资源失败：服务器响应状态为 404（未找到）[http://www.electrickiwi.co.uk/jquery.fancybox.css](http://www.electrickiwi.co.uk/jquery.fancybox.css)
*   加载资源失败：服务器响应状态为 404
    （未找到）
    [http://www.electrickiwi.co.uk/wp-content/plugins/active-share-by-orangesoda/share-dropdown.js?ver =1.0](http://www.electrickiwi.co.uk/wp-content/plugins/active-share-by-orangesoda/share-dropdown.js?ver=1.0)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T15:58:08.703

像 jQueryUI 这样的 jQuery 扩展的工作方式是在`$`加载脚本时添加到内存中的 jQuery 对象。

如果你重新加载另一个 jQuery.js 副本，它将初始化自身并覆盖`$`内存中的 jQuery 对象。

我看到你在那个页面上有jquery.js和jquery.min.js，如果页面加载jquery.js或者jquery.min.js之后，jquery-ui-1.8.16.custom.min.js，最新的副本内存中的 jQuery 对象`$`将没有可拖动的功能，导致控制台中的 JavaScript 错误。

确认脚本加载的顺序。

# python - 如何使用pyramid_traversalwrapper？

> ID：10688458
> 
> 赞同：0
> 
> 时间：2012-05-21T15:50:36.117
> 
> 标签：python, pyramid

我是金字塔和遍历概念的新手。我有一个使用遍历的基本对象模型，但是对象不知道位置，因此请阅读此页面上的金字塔文档[http://docs.pylonsproject.org/projects/pyramid/en/1.0-branch/narr/ resources.html#location-aware](http://docs.pylonsproject.org/projects/pyramid/en/1.0-branch/narr/resources.html#location-aware)它谈到了使用 pyramid_traversalwrapper。

按照说明，我在主要内容中添加了以下几行：

```
config = Configurator(root_factory=Root)
config.registry.registerAdapter(ModelGraphTraverser, (Interface,),
                            ITraverser) 
```

我的遍历树对象的其余部分如下所示：

```
class Root(object):
    def __init__(self, request):
        pass                    

    def __getitem__(self, key):
        if key == 'users':
            return UserList()
        raise KeyError 

class UserList():
    def __getitem__(self, key):
        users = {'a':None,'b':None, 'c':None} 
        if key in users:
            return User()
        raise KeyError

class User(object):
    def __init__(self):
        pass
    def __getitem__(self, key):
        if (key == 'channels'):
            return Channels()
    def GET(self):
        return Response("got user") 
```

当我运行代码时，它似乎在解析 url 时使用了 ModelGraphTraverser，但是我必须做些什么才能让我的模型能够感知位置，比如知道`__parent__`等等`__name__`？我必须添加包装类吗？如果是这样，我该怎么做？pyramid_traversalwrapper 应该使管理变得`__parent__`轻松`__name__`，但我不知道如何利用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T08:08:56.407

`pyramid_traversalwrapper`遍历时自动设置对象的`__name__`和`__parent__`属性（否则您必须手动执行此操作）。

这意味着您可以在视图中使用对象的这些属性。以你为例：

```
@view_config(context='Channels')
def some_view(context, request):
    user = context.__parent__
    userlist = user.__parent__
    print user.__name__  # Prints a, b or c
    print userlist.__name__  # Prints 'users' 
```

# installation - dotnetInstaller 应在注册表检查失败时终止

> ID：10688463
> 
> 赞同：0
> 
> 时间：2012-05-21T15:50:49.087
> 
> 标签：installation, setup-deployment, bootstrapper, dotnetinstaller

在执行 dotNetInstaller bootStrapper 期间，我有一个非常基本的要求，即在找不到注册表项时终止安装过程。我正在安装 WebApplication 并希望在没有 IIS 的情况下安装失败。

但它不起作用。这是我的配置文件。

![在此处输入图像描述](../Images/cdd1a123433d5c2ad88a9918eba7e5e7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T19:28:29.097

安装检查不会终止任何事情，它会通知引导程序是否应该安装组件。DNI 不支持基于某些条件终止安装。

# asynchronous - 不断从流中检索信息

> ID：10688464
> 
> 赞同：2
> 
> 时间：2012-05-21T15:50:53.197
> 
> 标签：asynchronous, stream, infinite-loop

Facebook、Google plus 或其他信息网站如何不断地从流中检索信息？我想有一个异步恢复，但他是如何不断得到的？这就像一个无限循环？

使用了哪种技术？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:34:58.810

有几种不同的方法可以在网络上近乎实时地显示更新。以下是一些最常见的：

## 短轮询

解决该问题的最简单方法是在短时间内连续轮询服务器（因此得名）。这意味着每隔几秒钟，客户端代码就会向服务器发送一个异步请求并显示结果。这种方法的缺点是，如果更新发生的频率低于查询服务器的频率，那么客户端会做很多工作而收效甚微。根据轮询频率，在服务器上发生事件和客户端接收到事件之间也可能存在轻微延迟。

## 长轮询

短轮询的下一个进化步骤是所谓的长轮询，其中客户端 JavaScript 在页面加载后立即向服务器发出异步请求。服务器仅在进行更新时才响应请求，一旦响应到达客户端，就会立即触发另一个请求。这种方法的关键部分是异步请求可以等待服务器很长时间。

长轮询节省了带宽和计算时间，因为只有在服务器发生更改时才处理响应。它确实需要更复杂的服务器端逻辑，但它确实允许在客户端进行近乎即时的更新。

这个问题有一个不错的样本：[如何实现基本的“长轮询”？](https://stackoverflow.com/questions/333664/simple-long-polling-example-code)

## 网络套接字

WebSockets 是一种相对较新的技术，允许以类似于标准网络套接字的方式进行双向通信。服务器或客户端可以通过套接字发送消息，触发连接另一端的事件。尽管这样很好，但浏览器支持还不够广泛，不足以使其成为可靠的解决方案。

对于当前的 WebSocket 规范，请查看[RFC 6455](https://www.rfc-editor.org/rfc/rfc6455)。

# android - 以编程方式在方向更改时调整 EditText 的大小

> ID：10688465
> 
> 赞同：1
> 
> 时间：2012-05-21T15:50:56.973
> 
> 标签：android, android-layout, android-edittext, android-orientation

我正在尝试以编程方式调整`EditText`手机方向变化时的大小，这就是我目前所拥有的：

```
private final float editTextWidthLandscap = 380;
private final float editTextWidthPortrait = 220;

@Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);
    Resources r = getResources();
    float px;
    if (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE) {
        px = TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, editTextWidthLandscap, r.getDisplayMetrics());
        input.setWidth((int) px); // input is an EditText 
        Toast.makeText(this, "landscape", Toast.LENGTH_SHORT).show();
    } else if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT){
        px = TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, editTextWidthPortrait, r.getDisplayMetrics());
        input.setWidth((int) px);  // input is an EditText
        Toast.makeText(this, "portrait", Toast.LENGTH_SHORT).show();
    }
} 
```

我的清单文件中也有这个（以防万一）：

```
 <activity
        android:name=".Results"
        android:configChanges="keyboardHidden|orientation"
        android:theme="@android:style/Theme.NoTitleBar"
        android:windowSoftInputMode="stateHidden" >
    </activity> 
```

奇怪的是它显示的`Toast`很好，但似乎忽略了该`input.setWidth()`声明。如果有人能解释为什么`EditText`没有调整大小和/或给我指点我如何能够正确地做到这一点，将不胜感激。

**编辑：**

这是 EditText 所在的 XML 文件的一部分

```
 <LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="80dp"
    android:background="@color/purple"
    android:gravity="center_horizontal|center_vertical"
    android:orientation="horizontal" >

    <EditText
        android:id="@+id/input"
        android:layout_width="220dp"
        android:layout_height="50dp"
        android:background="@drawable/search_bar"
        android:hint="@string/input_hint"
        android:inputType="text|textNoSuggestions"
        android:maxLines="1"
        android:minHeight="50dp"
        android:minWidth="220dp"
        android:selectAllOnFocus="true"
        android:singleLine="true"
        android:textColor="@color/black_grey"
        android:textSize="16.67sp" />

    <Button
        android:id="@+id/search_button"
        android:layout_width="65dp"
        android:layout_height="50dp"
        android:background="@drawable/search_button" />
</LinearLayout> 
```

**编辑2：（解决方案）**

我仍然不知道究竟`input.setWidth()`是什么，但我发现我必须使用`LayoutParams`这个问题。下面是现在为我工作的代码：

```
 private final float editTextWidthLandscap = 380;
    private final float editTextWidthPortrait = 220;
    private final float editTextHeight = 50;

    @Override
    public void onConfigurationChanged(Configuration newConfig) {
        super.onConfigurationChanged(newConfig);
        Resources r = getResources();
        float widthpx;
        float heightpx = TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, editTextHeight, r.getDisplayMetrics());;
        if (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE) {
            widthpx = TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, editTextWidthLandscap, r.getDisplayMetrics());
            LinearLayout.LayoutParams lp = new LinearLayout.LayoutParams((int) Math.round(widthpx), (int) Math.round(heightpx));
            trademarkTextfield.setLayoutParams(lp);
        } else if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT) {
            widthpx = TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, editTextWidthPortrait, r.getDisplayMetrics());
            LinearLayout.LayoutParams lp = new LinearLayout.LayoutParams((int) Math.round(widthpx), (int) Math.round(heightpx));
            trademarkTextfield.setLayoutParams(lp);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:20:40.727

我不确定为什么大小没有以编程方式更改，但是，您可能希望对横向模式使用不同的布局文件。只需创建一个名为“layout-land”的新文件夹并将您的 layout.xml 文件放入其中（具有相同的 id 和文件名）并相应地更改大小。

根据您的情况，这可能不是最佳解决方案，但它只是另一种选择......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T09:05:34.923

根据我自己的经验，有时我们倾向于过度思考不良行为的原因。我不止一次地发现，我认为理所当然的事情并非如此。

您应该检查这两种情况的 px 参数是否真的不同。我知道这是一个基础知识，但可能`applyDimension`没有按您期望的方式工作，或者在其他地方定义了一些最小宽度，您只需点击它即可。

您还应该在调用`getWidth()`之前和之后调用`setWidth()`。为什么？因为也许该功能正在工作并且系统确实认为宽度已经改变并且问题出在其他地方。

# javascript - 如何将 jQuery UI 对象声明为 addListener Google Map 事件？

> ID：10688469
> 
> 赞同：0
> 
> 时间：2012-05-21T15:51:36.573
> 
> 标签：javascript, jquery-ui, google-maps-api-3

我的街景嵌入到一个信息窗口框中。全景图在信息窗口*domready*后加载，带有 addListener 事件。

我想修改对象`event.addListener(infowindow, 'domready', function()`并将其替换`$('#dialogStreetview')`为单击标记时打开的 jQuery UI 对话框对象。我尝试了`event.addListener($('#dialogStreetview'), 'domready', function()`其他事情，但是当对话框准备就绪时，什么都没有触发。

如何指向这个 jQuery 对话框对象（jQuery UI 事件、其他 jQuery 或 JS 动作）？谢谢你。

```
google.maps.event.addListener(marker, 'click', function() {
    infowindow.open(map, marker);
    $( "#dialogStreetview" ).dialog();
});
var pano = null;

//INFOWINDOW

google.maps.event.addListener(infowindow, 'domready', function() {
    if (pano != null) {
        pano.unbind("position");
        pano.setVisible(false);     
    }
    var pano = new google.maps.StreetViewPanorama(document.getElementById("content"), {
        navigationControl: true,
        enableCloseButton: false,
        addressControl: false,
        visible: true,
        linksControl: false
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:58:12.823

您可以使用`dialogopen`对话框的事件：

```
$("#dialogStreetview").on("dialogopen", function(event, ui) { 
```

代替

```
google.maps.event.addListener(infowindow, 'domready', function() { 
```

`dialogopen`打开 jQuery UI 对话框时触发该事件.... [docs here](http://jqueryui.com/demos/dialog/#event-open)

# html - 关于在页面内容下放置页脚，内容边框底部可见

> ID：10688472
> 
> 赞同：0
> 
> 时间：2012-05-21T15:51:43.537
> 
> 标签：html, css

我希望我的页脚直接出现在包含 Dropbox 影子的内容下方，必须显示内容的底部边框，但页脚应该出现在下方，或者换句话说，在内容下方，我可以在我的页面中放置一个页脚但不知道如何将页脚推到内容边框可见的内容下方

任何有关这方面的帮助都会对我有用

我需要在 html4 中而不是在 html 5 中完成

我已经为样式表中的页脚执行了以下操作，现在可以将页脚推到内容下方，但我不希望页脚的宽度在窗口调整大小时调整，页脚宽度必须为 100% 无论如何什么，在 Internet Explorer 中无法使用位置：绝对，任何帮助将不胜感激

```
#footer
{ 
position:absolute;
top:718px;
z-index:-1;
width:100%;
left:0; 
height:100px;
background: #EDEDED ;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:53:45.610

使用 CSS 的 z-index：

```
#content {z-index: 10;}
footer {z-index: 1;} 
```

（注意 HTML5 元素“页脚”）

# c# - IIS 64 位 Com dll

> ID：10688475
> 
> 赞同：4
> 
> 时间：2012-05-21T15:52:15.647
> 
> 标签：c#, iis, dll, com, interface

您好我正在开发一个应用程序，我需要通过 Web 服务访问 com DLL。

我在 win 7 上运行 IIS 7 并使用 vs2010 进行开发。

在开发环境中一切正常，但是当我在本地主机上发布到 IIS 以进行进一步测试时，我收到以下错误：

> System.Runtime.InteropServices.COMException：检索具有 CLSID {29345FBB-4DE7-4838-9464-5A886B775677} 的组件的 COM 类工厂失败，原因是以下错误：80040154。

我查了一下，发现如果我将我的应用程序池设置更改为“启用 32 位应用程序”为真。这将绕过错误，我这样做了，现在我收到以下错误：

> 无法将“ComName.ComClassClass”类型的 COM 对象转换为接口类型“ComName._ComClass”。此操作失败，因为 IID 为“{003B251B-6F4E-42A5-8111-11DB41F1D14A}”的接口的 COM 组件上的 QueryInterface 调用因以下错误而失败：不支持此类接口（来自 HRESULT 的异常：0x80004002 (E_NOINTERFACE)） .

我完全不知道在哪里看，用谷歌搜索它似乎找不到答案，有没有人知道发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:08:47.333

COM dll 需要在 IIS 服务器上注册。安装安装该 COM dll 的软件或使用 regsvr32.exe "C:..\yourdll.dll" 自己手动安装

* * *

[窗口标题] RegSvr32

[内容]

要注册模块，您必须提供二进制名称。

用法：regsvr32 [/u] [/s] [/n] [/i[:cmdline]] dllname

/u - 注销服务器

/s - 静音；不显示任何消息框

/i - 调用 DllInstall 并传递一个可选的 [cmdline]；与 /u 一起使用时调用 dll 卸载

/n - 不调用 DllRegisterServer；此选项必须与 /i 一起使用

* * *

如果您认为它已经注册，请取消注册并重新注册，也许做一个 iisreset :)

示例（假设您的 dll 直接在 C:\ 中）：

**C:>regsvr32.exe /u thecomdll.dll**

**C:>regsvr32.exe thecomdll.dll**

# c - LD_PRELOAD 和外部变量

> ID：10688478
> 
> 赞同：2
> 
> 时间：2012-05-21T15:52:31.997
> 
> 标签：c, linux, gcc, x86-64, glibc

说，我想修改`mmap`. 因此，我为此创建了一个新的共享对象文件，并使用 LD_PRELOAD 来代替原来的`mmap`. 但是，我需要引用一个变量，即我的程序文件。我怎样才能做到这一点？我在某处读到了关于弱引用的信息。这就是这样做的方法。我不认为你可以使用`extern`，因为你编译共享库而不是你的程序。对此有何建议？

其次，是否`LD_PRELOAD`只影响`mmap`您的代码中的使用，或者例如`mmap`从您的代码使用的标准库`libc.so`中调用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:58:23.400

使用`LD_PRELOAD`将影响对必须动态定位的函数的*任何*调用，无论它是在您自己的代码中还是在您的代码加载的共享库中。您可以使用它`LD_DEBUG`来查看事物在哪里找到符号。看一眼：

```
$ LD_DEBUG=help ls 
```

这将向您显示可用的调试选项。请注意，`ls`这里可以是任何动态链接的可执行文件。

我不确定您问题的第一部分是否完全确定。您是否尝试过使用`dlsym()`来查找变量？

# c++ - 堆优化（但不限于）单线程使用

> ID：10688479
> 
> 赞同：15
> 
> 时间：2012-05-21T15:52:32.637
> 
> 标签：c++, c, heap-memory

我在我的一个项目中使用自定义堆实现。它由两个主要部分组成：

1.  固定大小块堆。即只分配特定大小的块的堆。它分配更大的内存块（虚拟内存页或来自另一个堆），然后将它们划分为原子分配单元。

    它快速执行分配/释放（在 O(1) 中）并且没有内存使用开销，不考虑外部堆施加的东西。

2.  全局通用堆。它由上述（固定大小）堆的桶组成。WRT 请求的分配大小，它选择适当的存储桶，并通过它执行分配。

    由于整个应用程序是（大量）多线程的 - 全局堆在其操作期间**锁定**了适当的存储桶。

    **注意**：与传统堆相比，此堆不仅需要分配大小，还需要释放大小。这允许在没有搜索或额外内存开销（例如保存分配块之前的块大小）的情况下识别适当的存储桶。虽然不太方便，但在我的情况下这是可以的。此外，由于“桶配置”在编译时是已知的（通过 C++ 模板 voodoo 实现） - 适当的桶在编译时确定。

到目前为止，一切看起来（和工作）都很好。

最近我研究了一种算法，该算法会大量执行堆操作，并且自然会受到堆性能的显着影响。剖析显示其性能受到**锁定**的很大影响。也就是说，堆本身的工作速度非常快（典型的分配只涉及一些内存取消引用指令），但由于整个应用程序是多线程的 - 适当的存储桶受临界区保护，临界区依赖于**互锁**指令，这些指令很多较重。

同时，我通过为该算法提供自己的专用堆来解决此问题，该堆不受关键部分的保护。但这在代码级别施加了几个问题/限制。例如需要在堆栈深处传递上下文信息的地方可能需要堆。也可以使用 TLS 来避免这种情况，但这可能会在我的特定情况下导致重新进入的一些问题。

这让我想知道：是否有一种已知的技术可以为（但不限于）单线程使用优化堆？

**编辑：**

特别感谢 @Voo 建议检查 google 的 tcmalloc。

它似乎或多或少地与我所做的类似（至少对于小物体）。但此外，它们通过维护每个线程**缓存**解决了我遇到的确切问题。

我也想过这个方向，但我考虑过维护 per-thread **heaps**。然后释放从属于另一个线程的堆中分配的内存块有点棘手：应该将它插入某种锁定队列中，并且应该通知另一个线程，并异步释放挂起的分配。异步释放可能会导致问题：如果该线程由于某种原因很忙（例如执行激进的计算） - 实际上不会发生内存释放。此外，在多线程场景中，解除分配的成本要高得多。

OTOH 缓存的想法似乎更简单，更有效。我会努力解决的。

非常感谢。

**PS：**

确实 google 的 tcmalloc 很棒。我相信它的实现与我所做的非常相似（至少是固定大小的部分）。

但是，为了迂腐，我的堆有一个优势。根据文档，tcmalloc 会产生大约 1% 的开销（渐近），而我的开销是 0.0061%。准确地说是 4/64K。

:)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T16:05:00.697

一种想法是为每个线程维护一个内存分配器。从全局内存池中为每个分配器预先分配相当大的内存块。设计你的算法来分配来自相邻内存地址的大块（稍后会详细介绍）。

当给定线程的分配器内存不足时，它会从全局内存池中请求更多内存。此操作需要锁定，但发生的频率应该远低于您当前的情况。当给定线程的分配器释放它的最后一个字节时，将该分配器的所有内存返回到全局内存池（假设线程已终止）。

这种方法往往会比您当前的方法更早地耗尽内存（内存可以保留给一个永远不需要它的线程）。这是一个问题的程度取决于您的应用程序的线程创建/生命周期/销毁配置文件。您可以以增加复杂性为代价来缓解这种情况，例如，通过引入一个信号，表明给定线程的内存分配器内存不足，并且全局池已用尽，其他内存分配器可以通过释放一些内存来响应。

这种方案的一个优点是它倾向于消除[错误共享](http://en.wikipedia.org/wiki/False_sharing)，因为给定线程的内存将倾向于在连续的地址空间中分配。

附带说明一下，如果您还没有阅读过它，我建议任何实现自己的内存管理的人阅读[IBM 的内部内存管理文章。](http://www.ibm.com/developerworks/linux/library/l-memory/)

**更新**

如果目标是为多线程环境优化非常快速的内存分配（而不是自己学习如何去做），请查看备用内存分配器。如果目标是学习，也许可以查看他们的源代码。

*   [囤积](http://www.hoard.org/)
*   [tcmalloc](http://goog-perftools.sourceforge.net/doc/tcmalloc.html)（感谢[Voo](https://stackoverflow.com/users/144746/voo)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T07:35:46.963

阅读 Jeff Bonwicks 关于平板分配器和 vmem 的经典论文可能是个好主意。原始的平板分配器听起来有点像你在做什么。尽管对多线程不是很友好，但它可能会给您一些想法。

[Slab 分配器：对象缓存内核内存分配器](http://static.usenix.org/publications/library/proceedings/bos94/full_papers/bonwick.a)

然后他用 VMEM 扩展了这个概念，这肯定会给你一些想法，因为它在多 cpu 环境中具有非常好的行为。

[Magazines 和 Vmem：将 Slab 分配器扩展到许多 CPU 和任意资源](http://static.usenix.org/event/usenix01/bonwick.html)

# sencha-touch-2 - Sencha Touch Label - 它有 Tap 事件吗？

> ID：10688484
> 
> 赞同：6
> 
> 时间：2012-05-21T15:52:55.693
> 
> 标签：sencha-touch-2

我正在尝试使用 sencha touch 2 构建一个抽认卡应用程序。我有一个显示问题的标签，它占据了整个屏幕，我想要它，以便当用户点击标签时显示答案。标签是否有“点击”事件？它在我使用按钮时有效，但在我使用标签时无效。

另一种方法是如果我可以让按钮在标签顶部透明。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T18:46:57.800

你可以这样做 ：

```
label.element.on({
    tap : function(e, t) { ... }
}); 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-28T06:55:53.217

使用 sencha touch 将点击事件绑定到“标签”控件的另一种方法。

```
{
    xtype : 'label',
    html : 'my name is abc',
    listeners : 
    {
        element : 'element',
        tap : function(e, t) 
         {
           alert('1 pressed');
         }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T19:32:44.220

`Ext.Label`不是为了`tap`举办活动而设计的。但是，您仍然可以通过`tap`标签 HTML 元素上的事件来实现它，例如：

`label.getContentEl().on{'tap', handler_function,this}`

但是**Sencha Touch**不提供`tap`事件 on `Ext.Label`，它是 的子级`Ext.Component`，因此当您尝试在标签上使用点击事件时，这不是最佳做法。

更好的方法是使用`Ext.Button`以下 2 个配置：

```
{
  ui: 'plain',
  cls: 'btnCls',
} 
```

并在您的 CSS 中，将其背景设置为透明。

# sql - 响应插入执行操作

> ID：10688492
> 
> 赞同：0
> 
> 时间：2012-05-21T15:53:28.003
> 
> 标签：sql, sql-server-2008

我试图弄清楚是否可以在 SQL Server 中编写自动脚本/函数/事件来处理以下问题：

“将新行添加到表 X 时，将表 Y 行复制到表 Z”

SQL Server 是否处理此类功能，还是我必须在 C# 等外部程序中执行此操作？

非常感谢 - kcross

编辑：关于这个问题的更多细节。表 X = 一个普通的数据库表，存储了用户信息的行。表 Y = 固定行的数据库表，用于存储实时数据（如平面的 GPS 坐标）表 X。问题需要将新行添加到表 X 时的实时数据。该表将存储该数据，并且该表中相应的新行和数据通过标识号链接。

因此，当将新行添加到表 X 时，创建一个脚本，该脚本自动将 Y 的实时数据复制到新行表 Z [并存储相应的标识符，以便表 X 的新行可以匹配表 Z 的相应行（s )]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:54:45.413

您可以为此使用触发器。

```
CREATE TRIGGER dbo.CopyYToZ
ON dbo.X
FOR INSERT
AS
BEGIN
  SET NOCOUNT ON;

  INSERT dbo.Z SELECT <cols> FROM dbo.Y WHERE ...
END
GO 
```

我会提供更多细节，但你并没有真正提供任何问题，所以......

# android - 无法为亚马逊应用内购买请求商品数据

> ID：10688495
> 
> 赞同：2
> 
> 时间：2012-05-21T15:53:34.667
> 
> 标签：android, in-app-purchase, kindle-fire, amazon-appstore

我正在尝试为 Amazon App Store 设置应用内购买，但在尝试请求商品数据时遇到了问题。我在 Kindle Fire 上调试。这是我的代码和我在 LogCat 中看到的内容：

```
@Override
public void onStart() {

    super.onStart();
    PurchasingManager.registerObserver( new AmazonPurchasingObserver( getActivity() ) );
    PurchasingManager.initiateItemDataRequest( SKU_SET );
} 
```

LogCat 输出：

```
05-21 10:46:30.399: D/PurchasingManager(10474): In App Purchasing SDK - Sandbox Mode: PurchasingObserver registered: com.myapp.android.service.amazon.AmazonPurchasingObserver@406129f0
05-21 10:46:30.407: D/SandboxRequestHandler(10474): In App Purchasing SDK - Sandbox Mode: sendItemDataRequest
05-21 10:46:30.423: W/ActivityManager(1409): Unable to start service Intent { act=com.amazon.testclient.iap.itemData flg=0x10000000 (has extras) }: not found 
```

因此，如果 Kindle 还没有针对上述意图的服务，那么在哪里`com.amazon.testclient.iap.itemData`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-21T21:46:27.090

Amazon 在下载的 zip 的工具目录中包含一个“AmazonSDKTest.apk”文件。在沙盒环境中进行测试之前，需要将其安装在设备上。

# python - 尝试在 Apache/mod_wsgi 上设置 Bottle-powered Web 应用程序时出现错误 404

> ID：10688498
> 
> 赞同：4
> 
> 时间：2012-05-21T15:53:45.390
> 
> 标签：python, apache, mod-wsgi, bottle

我是初学者程序员。我开始使用 Python 和 Bottle 来制作一个小型 Web 应用程序来打印表单，到目前为止一切都很好。真正的问题是配置 Apache 和`mod_wsgi`，据我所知几乎没有。

**我的问题**：我不断收到此错误：

> 未找到错误404
> 
> 抱歉，请求的 URL /factura/ 导致错误：未找到

在工作中，他们给了我重定向到 IP:port 的地址；经过几天阅读 Apache 文档并通过网络查看示例后，我设法设置了配置，因此我的 VirtualHost 不会破坏其他已经运行的虚拟主机。配置如下所示（基于瓶子教程部署部分）：

```
Listen port
NameVirtualHost IP:port

<VirtualHost IP:port>
    ServerName IP:port

    WSGIDaemonProcess factura processes=1 threads=5
    WSGIScriptAlias / /var/www/factura/app.wsgi

    <Directory /var/www/factura>
        WSGIProcessGroup factura
        WSGIApplicationGroup %{GLOBAL}
        Order deny,allow
        Allow from all
    </Directory>
</VirtualHost> 
```

我`app.wsgi`的几乎与 Bottle 教程-部署部分中的相同。我只添加了一行`sys.stdout = sys.stderr`：

```
import sys, os, bottle

# Change working directory so relative paths (and template lookup) work again
sys.path = ['/var/www/factura'] + sys.path
os.chdir(os.path.dirname(__file__))

# Error output redirect
# Exception KeyError in 'threading' module
sys.stdout =  sys.stderr

import factura
application = bottle.default_app() 
```

下面是一些与 Bottle 相关的 python 代码：

```
from lib import bottle

app = bottle.Bottle()

#serves files in folder 'static'
@app.route('/static/:path#.+#', name='static')
def ...

@app.route("/factura")
@bottle.view("factura")
def ...

@app.route("/print_factura", method="POST")
def ... 
```

我已经阅读了与此类似的其他一些问题，但我无法看到我错过了什么。我想问题出在`app.wsgi`?

**更新**

文件结构

```
/var/www/factura/       ## .py files
                /views  ## here is the web template
                /static ## .css and .js of template
                /lib    ## package with bottle and peewee source files
                /data   ## inkscape file to play with
                /bin    ## backup stuff in repo, not used in code 
```

Apache 错误日志只显示

`Exception KeyError: KeyError(-1211426160,) in <module 'threading' from '/usr/lib/python2.6/threading.pyc'> ignored` 这是来自 wsgi/python 问题的警告，[wsgi 问题 197无害](http://code.google.com/p/modwsgi/issues/detail?id=197)

**更新 2**工作
添加`@app.route("/factura/")`注意斜线，随着应用程序导入的更改，`from factura import app as application`这两者一起使其工作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T16:26:40.263

如果您明确创建应用程序：

```
app = bottle.Bottle() 
```

那么你应该将它导入你的`app.wsgi`而不是`application = bottle.default_app()`：

```
from factura import app as application 
```

但重要的是这一点。在您的 WSGI 文件中，您执行`import bottle`，但在应用程序代码文件中，您执行`from lib import bottle`. 正如您所解释的，您有两个 Bottle 副本：一个安装在服务器范围内，另一个安装在`lib`目录下。

这就是你收到的原因`404 Not Found`。您实际上是在使用库的一个实例（创建`app`），然后给 Apache 一个*与库的不同实例*`default_app`不同的（ ） ！

 *当您开始返回正确的时，它开始正常工作`app`。*

# facebook - 获取 facebook 的索引电影、音乐、学校等

> ID：10688500
> 
> 赞同：3
> 
> 时间：2012-05-21T15:53:58.547
> 
> 标签：facebook, api, facebook-graph-api, indexing

有没有办法让所有 facebook 的索引内容在我自己的网站上使用（也许通过他们的 API）？他们基本上不会让用户输入自己喜欢的电影，而是从建议列表中进行选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:12:05.357

您可以尝试[搜索 API](http://developers.facebook.com/docs/reference/api/#searching)。它应该允许您传递部分名称并按类别过滤，以便您可以为自动完成字段生成列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:09:52.957

不，没有办法。另外，实际上没有清单。他们为您更新的任何电影、地点、歌曲创建页面/链接:)

# linux - 如何使用命令行将 swf 转换为 mp4/flv 左右？

> ID：10688503
> 
> 赞同：4
> 
> 时间：2012-05-21T15:54:07.037
> 
> 标签：linux, ffmpeg, flash, flv

我将使用 linux 中的批处理线将 swf 转换为 mp4/flv 左右。

我试过**ffmpeg**、**mencoder**或 perl 脚本**FLV::info**。但是所有这些都只是将 swf 中的视频（可能由 H.263 左右编码）转换为新视频，但**没有电影剪辑**，更不用说动作脚本了。

我发现[moyea](http://www.moyeamedia.com/swf-to-video-sdk/)似乎符合我的需求（但是，我需要 linux 的），但是有没有免费的方法可以做到这一点？

非常感谢。

# javascript - 从数组中在谷歌地图上放置多个标记

> ID：10688509
> 
> 赞同：5
> 
> 时间：2012-05-21T15:54:32.423
> 
> 标签：javascript, google-maps, geocode

我正在尝试在从数组提供的地图上放置多个标记。现在只有我的初始点加载（纽约）。

```
var geocoder;
var map;
var markersArray = [];

//plot initial point using geocode instead of coordinates (works just fine)
  function initialize() {
    geocoder = new google.maps.Geocoder();
     latlang = geocoder.geocode( { 'address': 'New York City'}, function(results, status) { //use latlang to enter city instead of coordinates 
            if (status == google.maps.GeocoderStatus.OK) {
                map.setCenter(results[0].geometry.location);
                marker = new google.maps.Marker({
                map: map,
                position: results[0].geometry.location
                });
            markersArray.push(marker);
            }
            else{
            alert("Geocode was not successful for the following reason: " + status);
            }
        });
    var myOptions = {
        center: latlang, zoom: 5, mapTypeId: google.maps.MapTypeId.SATELLITE,
        navigationControlOptions: {
            style: google.maps.NavigationControlStyle.SMALL
        }
    };
     map = new google.maps.Map(document.getElementById("map_canvas"),
        myOptions);

  }

///////////////////////////////////////////////////////////
//Everything below this line is for attempting to plot the markers

  var locationsArray = ['Pittsburgh','Chicago', 'Atlanta'];

  function plotMarkers(){
for(var i = 0; i < locationsArray.length; i++){
  codeAddresses(locationsArray[i]);
}
  }

  function codeAddresses(address){
    geocoder.geocode( { 'address': address}, function(results, status) { 
            if (status == google.maps.GeocoderStatus.OK) {
                map.setCenter(results[0].geometry.location);
                marker = new google.maps.Marker({
                map: map,
                position: results[0].geometry.location
                });
            //markersArray.push(marker); 
            }
            else{
            alert("Geocode was not successful for the following reason: " + status);
            }
  });
  } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T16:05:46.990

您实际上并没有`plotMarkers`在上面的代码段中调用任何地方！当我添加到初始化的末尾（在定义地图之后）它工作得很好！[http://jsfiddle.net/T5aKE/](http://jsfiddle.net/T5aKE/)

```
 ...
         map = new google.maps.Map...
         plotMarkers();
       ... 
```

# xml - 如何使用 XSLT 删除这个棘手的 XML 重复节点？

> ID：10688511
> 
> 赞同：2
> 
> 时间：2012-05-21T15:54:36.550
> 
> 标签：xml, xslt

我想从*同一个父节点中删除**连续*的重复节点，并且它也有*完全相同的子*节点。

 ****输入场景一：**

```
<myroot>
    <nodeA id="a">
        <section id="i">  
            <item1 id="0" method="create"> 
                <somechild>a</somechild>
            </item1>

            <item1 id="1" method="create">
                <otherchild>a</otherchild>
            </item1>
        </section>        

        <section id="i">
            <item1 id="0" method="create"> <!-- second consecutive create, we remove this -->
                <somechild>a</somechild>
            </item1>
            <item1 id="0" method="create"> <!-- third consecutive create, but children have different value , so we don't remove this -->
                <somechild>bbb</somechild>
            </item1>
            <item1 id="3" method="create">
                <other>xx</other>    
            </item1>

            <item1 id="0" method="change"> 
                <otherchild>a</otherchild>
            </item1>
        </section>
    </nodeA>

    <nodeA id="b">
        <section id="i">  
            <item1 id="0" method="create"> 
                <somechild>a</somechild>
            </item1>

            <item1 id="1" method="create">
                <otherchild>a</otherchild>
            </item1>
        </section>        

        <section id="i">
            <item1 id="0" method="create"> <!-- second consecutive create, we remove this -->
                <somechild>a</somechild>
            </item1>
            <item1 id="0" method="create"> <!-- third consecutive create, but children have different value , so we don't remove this -->
                <somechild>bbb</somechild>
            </item1>
            <item1 id="3" method="create">
                <other>xx</other>    
            </item1>

            <item1 id="0" method="change"> 
                <otherchild>a</otherchild>
            </item1>
        </section>
    </nodeA>

    <nodeB id="b">
        <section id="i">  
            <item1 id="0" method="create"> 
                <somechild>a</somechild>
            </item1>

            <item1 id="1" method="create">
                <otherchild>a</otherchild>
            </item1>
        </section>        

        <section id="i">
            <item1 id="0" method="create"> <!-- second consecutive create, we remove this -->
                <somechild>a</somechild>
            </item1>
            <item1 id="0" method="create"> <!-- third consecutive create, but children have different value , so we don't remove this -->
                <somechild>bbb</somechild>
            </item1>
            <item1 id="3" method="create">
                <other>xx</other>    
            </item1>

            <item1 id="0" method="change"> 
                <otherchild>a</otherchild>
            </item1>
        </section>
    </nodeB>
</myroot> 
```

我的结果：

```
<myroot>
    <nodeA id="a">
        <section id="i">
            <item1 id="0" method="create">
                <somechild>a</somechild>
            </item1>
            <item1 id="1" method="create">
                <otherchild>a</otherchild>
            </item1>
        </section>
        <section id="i">
            <item1 id="0" method="create">
                <somechild>bbb</somechild>
            </item1>
            <item1 id="3" method="create">
                <other>xx</other>
            </item1>
            <item1 id="0" method="change">
                <otherchild>a</otherchild>
            </item1>
        </section>
    </nodeA>
    <nodeA id="b">
        <section id="i"/>
        <section id="i"/>
    </nodeA>
    <nodeB id="b">
        <section id="i"/>
        <section id="i"/>
    </nodeB>
</myroot> 
```

**预期输出：**

```
<myroot>
    <nodeA id="a">
        <section id="i">  
            <item1 id="0" method="create"> 
                <somechild>a</somechild>
            </item1>

            <item1 id="1" method="create">
                <otherchild>a</otherchild>
            </item1>
        </section>        

        <section id="i">
            <item1 id="0" method="create"> 
                <somechild>bbb</somechild>
            </item1>
            <item1 id="3" method="create">
                <other>xx</other>    
            </item1>

            <item1 id="0" method="change"> 
                <otherchild>a</otherchild>
            </item1>
        </section>
    </nodeA>

    <nodeA id="b">
        <section id="i">  
            <item1 id="0" method="create"> 
                <somechild>a</somechild>
            </item1>

            <item1 id="1" method="create">
                <otherchild>a</otherchild>
            </item1>
        </section>        

        <section id="i">
            <item1 id="0" method="create"> 
                <somechild>bbb</somechild>
            </item1>
            <item1 id="3" method="create">
                <other>xx</other>    
            </item1>

            <item1 id="0" method="change"> 
                <otherchild>a</otherchild>
            </item1>
        </section>
    </nodeA>

    <nodeB id="b">
        <section id="i">  
            <item1 id="0" method="create"> 
                <somechild>a</somechild>
            </item1>

            <item1 id="1" method="create">
                <otherchild>a</otherchild>
            </item1>
        </section>        

        <section id="i">
            <item1 id="0" method="create"> 
                <somechild>bbb</somechild>
            </item1>
            <item1 id="3" method="create">
                <other>xx</other>    
            </item1>

            <item1 id="0" method="change"> 
                <otherchild>a</otherchild>
            </item1>
        </section>
    </nodeB>
</myroot> 
```

在上面的第一个场景中：只有第二个连续创建具有相同的孩子，而第三个连续的`create`方法有不同的孩子，这就是我们只删除第二个的原因。

第二个输入场景（更多变化）：

```
<myroot>
    <nodeB id="a">
        <cell id="i">              
            <item2 id="1" method="create">
                <otherchild>a</otherchild>
            </item2>

            <item2 id="0" method="create"> 
                <otherchild>a</otherchild>
            </item2>

            <item2 id="1" method="modify">
                <otherchild>a</otherchild>
            </item2>        
        </cell>        

        <cell id="i">
            <item2 id="1" method="modify"> <!-- second consecutive modify, we remove this -->
                <otherchild>a</otherchild>
            </item2>

            <item2 id="1" method="modify"> <!-- third consecutive modify, BUT different chldren, we do NOT remove this -->
                <otherchild>a</otherchild>
                <somechild>aa</somechild>
            </item2>

            <item2 id="1" method="delete" /> 

            <item2 id="0" method="create"> 
                <somechild>bbb</somechild>
            </item2>

            <item2 id="1" method="delete" /> <!-- second consecutive delete, we remove this -->

            <item2 id="3" method="create">
                <other>xx</other>    
            </item2>

            <item2 id="1" method="delete" />  <!-- third consecutive delete, we remove this -->           
        </cell>
    </nodeB>
</myroot> 
```

**输出：**

```
<myroot>
    <nodeB id="a">
        <cell id="i">              
            <item2 id="1" method="create">
                <otherchild>a</otherchild>
            </item2>

             <item2 id="0" method="create"> 
                <otherchild>a</otherchild>
            </item2>

            <item2 id="1" method="modify">
                <otherchild>a</otherchild>
            </item2>        
        </cell>        

        <cell id="i">
            <item2 id="1" method="modify">
                <otherchild>a</otherchild>
                <somechild>aa</somechild>
            </item2>

            <item2 id="1" method="delete" /> 

            <item2 id="0" method="create"> 
                <somechild>bbb</somechild>
            </item2>           
        </cell>
    </nodeB>
</myroot> 
```

**不在这方面工作：**

```
 <myroot>     
        <node1 id="a">
            <section id="i">
                <item1 id="0" method="start">
                    <somechild>a</somechild>
                </item1>
                <item1 id="0" method="start"> <!-- this one is successive from the previous so we eliminate -->
                    <somechild>a</somechild>
                </item1>
                <item1 id="0" method="stop"/>                
                <item1 id="0" method="start"> <!-- this will be treated as new starting point -->
                    <somechild>a</somechild>
                </item1>
            </section>  

            <section id="i">
                <item1 id="0" method="start"> <!-- this one is successive from the previous so we eliminate -->
                    <somechild>a</somechild>
                </item1>
            </section>                
        </node1>
    </myroot>

output:

    <myroot>     
        <node1 id="a">
            <section id="i">
                <item1 id="0" method="start">
                    <somechild>a</somechild>
                </item1>
                <item1 id="0" method="start"> <!-- this one is successive from the previous so we eliminate -->
                    <somechild>a</somechild>
                </item1>
                <item1 id="0" method="stop"/>                          
            </section>                  
            <section id="i"/>                              
        </node1>
    </myroot>

The correct output should be:

    <myroot>     
        <node1 id="a">
            <section id="i">
                <item1 id="0" method="start">
                    <somechild>a</somechild>
                </item1>                   
                <item1 id="0" method="stop"/>                
                <item1 id="0" method="start"> <!-- this will be treated as new starting point -->
                    <somechild>a</somechild>
                </item1>
            </section>                  
            <section id="i" />                   
        </node1>
    </myroot> 
```

任何人都可以帮助我使用 XSLT 进行这个棘手的删除吗？非常感谢。

约翰

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T17:01:57.930

这是一个 XSLT 2.0 示例样式表，应该可以完成这项工作，或者至少让您了解 using`deep-equal`可以如何提供帮助：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  version="2.0">

  <xsl:strip-space elements="*"/>
  <xsl:output indent="yes"/>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* , node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/*/*/*/*[some $el in (preceding-sibling::* , preceding::*) satisfies deep-equal(., $el)]"/>

</xsl:stylesheet> 
```

[编辑] 有了新的要求，我没有办法解决这个问题，`deep-equal`所以我写了一个新的样式表，它使用`for-each-group`and `deep-equal`：

```
<xsl:stylesheet 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  version="2.0">

  <xsl:strip-space elements="*"/>
  <xsl:output indent="yes"/>

  <xsl:template match="@* | node()" name="identity">
    <xsl:copy>
      <xsl:apply-templates select="@* , node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/*/*">
    <xsl:copy>
      <xsl:variable name="first-in-group" as="element()*">
        <xsl:for-each-group select="*" group-by="concat(node-name(.), '|', @id)">
          <xsl:for-each-group select="current-group()/*" group-by="concat(@id, '|', @method)">
            <xsl:sequence 
              select="for $pos in 1 to count(current-group())
                      return current-group()[$pos]
                              [every $item 
                              in subsequence(current-group(), 1, $pos - 1) 
                              satisfies not(deep-equal($item, current-group()[$pos]))] "/>
          </xsl:for-each-group>
        </xsl:for-each-group>
      </xsl:variable>
      <xsl:apply-templates select="@*"/>
      <xsl:apply-templates>
        <xsl:with-param name="first-in-group" select="$first-in-group" tunnel="yes"/>
      </xsl:apply-templates>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/*/*/*/*">
    <xsl:param name="first-in-group" tunnel="yes"/>
    <xsl:if test="$first-in-group intersect .">
      <xsl:call-template name="identity"/>
    </xsl:if>
  </xsl:template>

</xsl:stylesheet> 
```

使用该样式表 Saxon 9.4，当应用于示例时

```
<myroot>
    <nodeA id="a">
        <section id="i">  
            <item1 id="0" method="create"> 
                <somechild>a</somechild>
            </item1>

            <item1 id="1" method="create">
                <otherchild>a</otherchild>
            </item1>
        </section>        

        <section id="i">
            <item1 id="0" method="create"> <!-- second consecutive create, we remove this -->
                <somechild>a</somechild>
            </item1>
            <item1 id="0" method="create"> <!-- third consecutive create, but children have different value , so we don't remove this -->
                <somechild>bbb</somechild>
            </item1>
            <item1 id="3" method="create">
                <other>xx</other>    
            </item1>

            <item1 id="0" method="change"> 
                <otherchild>a</otherchild>
            </item1>
        </section>
    </nodeA>

    <nodeA id="b">
        <section id="i">  
            <item1 id="0" method="create"> 
                <somechild>a</somechild>
            </item1>

            <item1 id="1" method="create">
                <otherchild>a</otherchild>
            </item1>
        </section>        

        <section id="i">
            <item1 id="0" method="create"> <!-- second consecutive create, we remove this -->
                <somechild>a</somechild>
            </item1>
            <item1 id="0" method="create"> <!-- third consecutive create, but children have different value , so we don't remove this -->
                <somechild>bbb</somechild>
            </item1>
            <item1 id="3" method="create">
                <other>xx</other>    
            </item1>

            <item1 id="0" method="change"> 
                <otherchild>a</otherchild>
            </item1>
        </section>
    </nodeA>

    <nodeB id="b">
        <section id="i">  
            <item1 id="0" method="create"> 
                <somechild>a</somechild>
            </item1>

            <item1 id="1" method="create">
                <otherchild>a</otherchild>
            </item1>
        </section>        

        <section id="i">
            <item1 id="0" method="create"> <!-- second consecutive create, we remove this -->
                <somechild>a</somechild>
            </item1>
            <item1 id="0" method="create"> <!-- third consecutive create, but children have different value , so we don't remove this -->
                <somechild>bbb</somechild>
            </item1>
            <item1 id="3" method="create">
                <other>xx</other>    
            </item1>

            <item1 id="0" method="change"> 
                <otherchild>a</otherchild>
            </item1>
        </section>
    </nodeB>
</myroot> 
```

输出

```
<myroot>
   <nodeA id="a">
      <section id="i">
         <item1 id="0" method="create">
            <somechild>a</somechild>
         </item1>
         <item1 id="1" method="create">
            <otherchild>a</otherchild>
         </item1>
      </section>
      <section id="i">
         <item1 id="0" method="create"><!-- third consecutive create, but children have different value , so we don't re
move this --><somechild>bbb</somechild>
         </item1>
         <item1 id="3" method="create">
            <other>xx</other>
         </item1>
         <item1 id="0" method="change">
            <otherchild>a</otherchild>
         </item1>
      </section>
   </nodeA>
   <nodeA id="b">
      <section id="i">
         <item1 id="0" method="create">
            <somechild>a</somechild>
         </item1>
         <item1 id="1" method="create">
            <otherchild>a</otherchild>
         </item1>
      </section>
      <section id="i">
         <item1 id="0" method="create"><!-- third consecutive create, but children have different value , so we don't re
move this --><somechild>bbb</somechild>
         </item1>
         <item1 id="3" method="create">
            <other>xx</other>
         </item1>
         <item1 id="0" method="change">
            <otherchild>a</otherchild>
         </item1>
      </section>
   </nodeA>
   <nodeB id="b">
      <section id="i">
         <item1 id="0" method="create">
            <somechild>a</somechild>
         </item1>
         <item1 id="1" method="create">
            <otherchild>a</otherchild>
         </item1>
      </section>
      <section id="i">
         <item1 id="0" method="create"><!-- third consecutive create, but children have different value , so we don't re
move this --><somechild>bbb</somechild>
         </item1>
         <item1 id="3" method="create">
            <other>xx</other>
         </item1>
         <item1 id="0" method="change">
            <otherchild>a</otherchild>
         </item1>
      </section>
   </nodeB>
</myroot> 
```

所以希望所有你想被删除的东西都被删除了，你想保留的东西都被保留了。**

# javascript - 转义双引号 javascript

> ID：10688513
> 
> 赞同：-1
> 
> 时间：2012-05-21T15:54:41.600
> 
> 标签：javascript

我正在尝试在 iPhone 上查看时运行某种图像格式，而在其他情况下运行一些 flash 视频

```
var uagent = navigator.userAgent.toLowerCase();

 if (uagent.search("iphone") > -1){

  document.write("<img src=http://www.demiads.com/images/bc-1300119669-722.gif />");    }
else{   

document.write("<object classid=clsid:d27cdb6e-ae6d-11cf-96b8-444553540000 
codebase=http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0 width=728 height=90 id=lang align=middle style=margin-left:3px;>   
 <param name=allowScriptAccess value=sameDomain />      
 <param name=allowFullScreen value=false />         
 <param name=movie value=http://koha.net//repository/reklamat/17_05_12_131575_koha.net_hej_reveal_675x88px.swf /> 
 <param name=quality value=high /> 
 <param name=bgcolor value=#ffffff /> 
 <param name=wmode value=transparent />     
<embed src=http://koha.net//repository/reklamat/17_05_12_131575_koha.net_hej_reveal_675x88px.swf 
quality=high WMODE=transparent bgcolor=#ffffff width=728 height=90 
name=ifm_al align=middle allowScriptAccess=sameDomain 
allowFullScreen=false type=application/x-shockwave-flash 
pluginspage=http://www.macromedia.com/go/getflashplayer /> 
</object>"); 

 } 
```

测试时效果很好，但广告系统没有在发布商网站上显示它。我检查了一个网站的源代码，我注意到每当找到 " 或 ' 时都会添加一个 \，从而使其不起作用！我试图尽量减少 " 或 ' 的使用，但这是我所能做到的去。有没有办法解决这个问题？先感谢您。

结果

```
 if (uagent.search(\"iphone\") > -1){

 document.write(\"<img src=http://www.demiads.com/images/bc-1300119669-722.gif />\");    }
 else{   

   document.write(\"<object classid=clsid:d27cdb6e-ae6d-11cf-96b8-444553540000 
   codebase=http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0      width=728 height=90 id=lang align=middle style=margin-left:3px;>   
   <param name=allowScriptAccess value=sameDomain />      
   <param name=allowFullScreen value=false />         
   <param name=movie value=http://koha.net//repository/reklamat/17_05_12_131575_koha.net_hej_reveal_675x88px.swf /> 
   <param name=quality value=high /> 
   <param name=bgcolor value=#ffffff /> 
   <param name=wmode value=transparent />     
   <embed src=http://koha.net//repository/reklamat/17_05_12_131575_koha.net_hej_reveal_675x88px.swf 
   quality=high WMODE=transparent bgcolor=#ffffff width=728 height=90 
   name=ifm_al align=middle allowScriptAccess=sameDomain 
   allowFullScreen=false type=application/x-shockwave-flash 
   pluginspage=http://www.macromedia.com/go/getflashplayer /> 
   </object>\"); 

     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:56:17.813

为什么缺少这些属性`""`？您知道您可以使用单引号，例如：

```
document.write('<img src="bc-1300119669-722.gif" />'); 
```

# html - 在不知道高度和宽度的情况下用背景图像填充 SVG 路径

> ID：10688516
> 
> 赞同：2
> 
> 时间：2012-05-21T15:54:52.900
> 
> 标签：html, svg, background-image

我可以创建一个包含填充的 SVG 路径的 SVG 图像，正如这个问题中已经提到的：[Fill SVG path element with a background-image](https://stackoverflow.com/questions/3796025/fill-svg-path-element-with-a-background-image)

SVG 看起来像这样：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events" version="1.1">
    <g transform="translate(0, 0) rotate(0)" opacity="1">
        <defs>
            <pattern id="img_patrickComp_patrick_cv1_Graphic3" height="313" width="468"  patternTransform="translate(0, 0) scale(1, 1) rotate(0)" patternUnits="userSpaceOnUse">
                <image x="0" y="0" opacity="1" height="313" width="468" xlink:href="http://www.bittbox.com/wp-content/uploads/2008/04/free_hires_wood_texture_5.jpg" />
            </pattern>
        </defs>
        <path fill="url(#img_patrickComp_patrick_cv1_Graphic3)" stroke="Blue" d="M 86,100L 298,394L 289,710L 100,610L 100,400L 46,400 z" />
    </g>
</svg> 
```

（SVG 链接：http: [//jsfiddle.net/2UFtV/](http://jsfiddle.net/2UFtV/)）

是否可以在不知道图像宽度和高度的情况下创建相同的纹理 SVG？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T08:08:24.420

If you want to preserve the raster image at it's native dimensions you need to know the dimensions yes.

# c - 模仿 printf

> ID：10688522
> 
> 赞同：0
> 
> 时间：2012-05-21T15:55:19.867
> 
> 标签：c, printf

以下代码有什么问题？我们怎样才能使函数 print() 像 printf 一样工作？

```
#include <stdio.h>
#include<stdarg.h>

void print(char *format,...)
{
    va_list args;
    va_start(args,format);
    printf(format,args);
}

int main() {
   print("%d %s",5,"le");
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T15:58:22.500

如果您需要传递可变参数，请[`vprintf`](http://en.cppreference.com/w/cpp/io/c/vfprintf)改用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T15:59:00.580

你需要 vprintf 那里。看看这个问题，它有一个类似的问题：[printf 和 vprintf 函数系列有什么区别，什么时候应该使用一个而不是另一个？](https://stackoverflow.com/questions/1485805/whats-the-difference-between-the-printf-and-vprintf-function-families-and-when)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-21T15:58:15.257

您可能需要查看[vprintf](http://www.manpagez.com/man/3/vfprintf/)。该函数（和相关函数）允许您传递变量参数列表，并且它们处理格式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T16:03:43.327

首先，`va_end()`如果使用`va_start()`.

`printf()`如果你想使用 a`va_list`作为参数，你不能使用。看看 [`vprintf()`](http://www.manpagez.com/man/3/vprintf/)。

例子：

```
void print(char *format,...)
{
    va_list args;
    va_start(args,format);
    vprintf(format,args);
    va_end(args);
} 
```

# cocos2d-iphone - CCDirector setDeviceOrientation 进 cocos2d v2.0rc1

> ID：10688523
> 
> 赞同：1
> 
> 时间：2012-05-21T15:55:31.037
> 
> 标签：cocos2d-iphone

在我的应用程序中将我的 cocos2d 1.0.1 更新为 2.0rc1 之前，我正在调用 [[CCDirector sharedDirector] setDeviceOrientation:(ccDeviceOrientation)currentOrientation]; 当检测到方向上的一个变化时进入某些场景，然后根据 currentOrientation 以纵向或横向加载其他场景。

但现在我不知道我该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-21T17:41:57.550

`Orientation setOrientation ( Orientation orientation )`
CCDirector 回调以更改设备方向。

CCDirector 想要更改的方向的定义。

返回 应用程序的实际方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:22:44.700

打开 AppDelegate.m 并找到这个方法：

```
// Supported orientations: Landscape. Customize it for your own needs
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return UIInterfaceOrientationIsLandscape(interfaceOrientation);
} 
```

为您的应用支持的所有方向返回 YES。

# c# - 需要有关提高 c# 代码性能的建议

> ID：10688524
> 
> 赞同：1
> 
> 时间：2012-05-21T15:55:32.713
> 
> 标签：c#, .net, arrays, performance

我有funcion，它被非常频繁地调用。该函数内部有两个嵌套*的 for*循环。每个 for 循环都从 0 迭代到 900。代码如下所示：

```
 for (int j = 0; j < width; j++)
            {
                for (int k = 0; k < height; k++)
                {
                    switch (Dim2[j * width + k])
                    {
                        case 0:
                            cwA = Dim0[j * width + ((k == (height - 1)) ? 0 : (k + 1))];
                            ccwA = Dim0[((j == (width - 1)) ? 0 : (j + 1)) * width + k];
                            oppA = Dim0[((j == (width - 1)) ? 0 : (j + 1)) * width + ((k == (height - 1)) ? 0 : (k + 1))];
                            cwB = Dim3[j * width + ((k == (height - 1)) ? 0 : (k + 1))];
                            ccwB = Dim3[((j == (width - 1)) ? 0 : (j + 1)) * width + k];
                            oppB = Dim3[((j == (width - 1)) ? 0 : (j + 1)) * width + ((k == (height - 1)) ? 0 : (k + 1))];
                            break;

                        case 1:
                            cwA = Dim0[((j == (width - 1)) ? 0 : (j + 1)) * width + k];
                            ccwA = Dim0[j * width + ((k == 0) ? (height - 1) : (k - 1))];
                            oppA = Dim0[((j == (width - 1)) ? 0 : (j + 1)) * width + ((k == 0) ? (height - 1) : (k - 1))];
                            cwB = Dim3[((j == (width - 1)) ? 0 : (j + 1)) * width + k];
                            ccwB = Dim3[j * width + ((k == 0) ? (height - 1) : (k - 1))];
                            oppB = Dim3[((j == (width - 1)) ? 0 : (j + 1)) * width + ((k == 0) ? (height - 1) : (k - 1))];
                            break;

                        case 2:
                            cwA = Dim0[((j == 0) ? (width - 1) : (j - 1)) * width + k];
                            ccwA = Dim0[j * width + ((k == (height - 1)) ? 0 : (k + 1))];
                            oppA = Dim0[((j == 0) ? (width - 1) : (j - 1)) * width + ((k == (height - 1)) ? 0 : (k + 1))];
                            cwB = Dim3[((j == 0) ? (width - 1) : (j - 1)) * width + k];
                            ccwB = Dim3[j * width + ((k == (height - 1)) ? 0 : (k + 1))];
                            oppB = Dim3[((j == 0) ? (width - 1) : (j - 1)) * width + ((k == (height - 1)) ? 0 : (k + 1))];
                            break;

                        case 3:
                            cwA = Dim0[j * width + ((k == 0) ? (height - 1) : (k - 1))];
                            ccwA = Dim0[((j == 0) ? (width - 1) : (j - 1)) * width + k];
                            oppA = Dim0[((j == 0) ? (width - 1) : (j - 1)) * width + ((k == 0) ? (height - 1) : (k - 1))];
                            cwB = Dim3[j * width + ((k == 0) ? (height - 1) : (k - 1))];
                            ccwB = Dim3[((j == 0) ? (width - 1) : (j - 1)) * width + k];
                            oppB = Dim3[((j == 0) ? (width - 1) : (j - 1)) * width + ((k == 0) ? (height - 1) : (k - 1))];
                            break;
                    }
                    woll = (((oppB + ccwB) + cwB) + Dim3[j * width + k]) > 0;
                    collision = ((Dim0[j * width + k] == oppA) && (cwA == ccwA)) && (Dim0[j * width + k] != cwA);
                    Dim6[j * width + k] = (short)(3 - Dim2[j * width + k]);
                    if (woll || collision)
                    {
                        Dim4[j * width + k] = Dim0[j * width + k];
                    }
                    else
                    {
                        Dim4[j * width + k] = _phase ? cwA : ccwA;
                    }
                }
            } 
```

执行这些 for 循环大约需要 0.1 秒，这太慢了。我已经用一维数组替换了二维数组，这显着提高了性能。代码还有其他性能改进吗？如果我将它迁移到 C++ 会更快吗？我应该使用任何其他语言进行数组操作吗？你有什么建议？
在此先感谢，
山姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:59:08.833

`height - 1`将诸如, `j + 1`, `width - 1`,之类的东西重构`j * width`为变量，因此它们只计算一次。会有一点帮助。实际上，您可以添加到此列表中：

```
(j == (width - 1)) ? 0 : (j + 1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:59:11.497

你可以在这个项目中使用[不安全](http://msdn.microsoft.com/en-us/library/chfa2zb8%28v=vs.71%29.aspx)的上下文吗？您应该能够通过使用指针而不是索引数组来显着提高性能，因为每次从数组中读取时，您将不再需要 .Net 的数组边界检查等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T15:59:47.143

> > 如果我将它迁移到 C++ 会更快吗？

如果由 C++ native 引用，它应该。
为什么
1\. 没有垃圾收集器
2\. 没有内存重新对齐
3\. 没有 CLR

然而，CLR 可以在托管代码中进行优化，等效的本机代码应该更快。这就是大多数 BCL CPU 密集型逻辑采用本机代码（由[MethodImplOptions](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.methodimploptions.aspx) .InternalCall 装饰）的确切原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T16:18:51.370

另一种解决方案，尤其是对于具有多核的现代计算机，可能是将外部 for 循环更改为对[Parallel.For](http://msdn.microsoft.com/en-us/library/system.threading.tasks.parallel.for.aspx)的调用。

不过，您应该首先进行此处建议的其他优化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T16:22:50.853

您可以通过拥有 3 个内部循环副本来完全删除`j == 0`和测试。如果您将第一次和最后一次迭代从循环中剥离，`j == (width - 1)`您可以对 执行相同的操作。`k`当然，如果你两者都做，你会有 9 个内部代码副本，这不是很好，我不会特别推荐 - 删除条件取决于`k`应该有更大的效果，和/因为你可以移动无论如何，条件取决于`j`内部循环之外。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-21T16:07:03.737

如果您需要显着加速，也许您应该考虑使用多线程，至少对于外循环。另外，请确保您没有使用[溢出检查](http://blog.kjeldby.dk/2009/04/overflow-checked-and-unchecked/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-21T15:59:49.717

我不是 C# 专家，但我会尝试将所有“静态”计算和循环（内联条件和乘法）放在循环之外。

# c# - 我是否必须为需要映射到我的 ViewModel 的每个实体对象和属性调用 Mapper.Map()？

> ID：10688526
> 
> 赞同：3
> 
> 时间：2012-05-21T15:55:54.967
> 
> 标签：c#, asp.net-mvc-3, automapper

```
public ViewResult Details(string strap)
{
    var parcel = _service.GetProperty(strap);
    var owners = _service.GetOwners(parcel);
    var other_characteristics = _service.GetOtherCharacteristics(parcel);
    var viewModel = new PropertyViewModel();

    Mapper.Map(parcel, viewModel);
    Mapper.Map(owners, viewModel.Owners);
    Mapper.Map(other_characteristics.DELINEATED_DISTRICT, viewModel.DELINEATED_DISTRICT);

    return View(viewModel);
} 
```

我觉得我应该能够设置我的代码以允许这成为我需要编写的全部内容。AutoMapper 将处理剩下的事情。或者也许写得更少。

```
 Mapper.Map(parcel, viewModel);
    Mapper.Map(owners, viewModel);
    Mapper.Map(other_characteristics.DELINEATED_DISTRICT, viewModel); 
```

这是我重写的 Configure() 方法。在我首先写这个问题时，我还没有添加 DELINEATED_DISTRICT 的映射。

```
 protected override void Configure()
    {
     //TODO: Add Mappings from Models to Data Objects 

        CreateMap<Property, PropertyViewModel>();
        CreateMap<IEnumerable<Owner>, PropertyViewModel>();
        //Names are the same in domain and viewModel

    } 
```

# 视图模型

```
 public class PropertyViewModel
        {

            public PropertyViewModel()
            {
                Owners = new List<Owner>();
                Characteristics = new List<Characteristics>();

            }

            public string STRAP { get; set; }
            public string PROPERTY_ID { get { return String.Format("{0}-{1}-{2}", STRAP.Substring(0, 4), STRAP.Substring(4, 2), STRAP.Substring(6, 4)); }  }
            public string SITUS { get; set; }
            public string MAILING_ADDRESS { get; set; }
            public string PROPERTY_USE { get; set; }
            public string SUBDIVISION { get; set; }
            public string DSCR { get; set; }
            public string LAND_AREA { get; set; }
            public string INCORPORATION { get; set; }
            public string SEC_TWP_RGE { get; set; }
            public string CENSUS { get; set; }
            public string DELINEATED_DISTRICT { get; set; }

            public IList<Owner> Owners { get; set; }
            public IList<Characteristic> Characteristics {get;set;}

        } 
```

# 楷模

```
public class Property
{
    [Key]        
    public string STRAP { get; set; }
    public string PROPERTY_ID {get;set;}
    public string SITUS { get; set; }
    public string MAILING_ADDRESS { get; set; }
    public string PROPERTY_USE { get; set; }
    public string SUBDIVISION { get; set; }
    public string DSCR { get; set; }
    public string LAND_AREA { get; set; }
    public string INCORPORATION { get; set; }
    public string SEC_TWP_RGE { get; set; }
    public string CENSUS { get; set; }
}

public class Owner
{
    [Key]
    public string OWNER_ID {get;set;}
    public string STRAP {get;set;}
    public string NAME {get;set;}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:20:27.287

您必须使用 `Mapper.Map(parcel, viewModel);`映射没有其他方式。对不起。

# objective-c - 时间的 UIDatePicker 返回非常奇怪的结果

> ID：10688527
> 
> 赞同：2
> 
> 时间：2012-05-21T15:56:04.913
> 
> 标签：objective-c, ios, nsdate, nsuserdefaults, nsdatepicker

我搜索了论坛，有很多关于 UIDatePicker 奇怪行为的帖子，但没有一个解决方案解决了我的问题。

我有一个简单的 UIDatePicker 初始化如下：

```
self.picker = [[UIDatePicker alloc] init];
self.picker.datePickerMode = UIDatePickerModeTime;
self.picker.calendar = [NSCalendar currentCalendar];
self.picker.timeZone = [NSTimeZone localTimeZone];
self.picker.date = self.initialDate;
[self.view addSubview:self.picker]; 
```

这是在一个简单视图的 viewDidLoad 方法中完成的（没有 xib，没有界面构建器，只是普通代码）。

现在我有一个按钮，它可以检索日期并“处理”它。

```
NSDate* selected = self.picker.date;
NSLog(@"%@", selected);

NSDateComponents* components = [self.picker.calendar components:(NSHourCalendarUnit | NSMinuteCalendarUnit | NSSecondCalendarUnit) fromDate:selected];
NSLog(@"0001-01-01 %02i:%02i:%02i +0000", components.hour, components.minute, components.second);

[components setSecond:0];
NSLog(@"0001-01-01 %02i:%02i:%02i +0000", components.hour, components.minute, components.second);

selected = [self.picker.calendar dateFromComponents:components];
NSLog(@"%@", selected); 
```

由于日期选择器不允许用户设置秒，我只想将它们重置为零（因为我需要稍后比较日期）。

当我选择“16:00”（即下午 4:00）时，日志输出为：

```
2012-05-21 17:43:48.428 Green Thumb[26828:fb03] 0001-01-01 14:55:36 +0000
2012-05-21 17:43:48.428 Green Thumb[26828:fb03] 0001-01-01 16:00:56 +0000
2012-05-21 17:43:48.429 Green Thumb[26828:fb03] 0001-01-01 16:00:00 +0000
2012-05-21 17:43:48.429 Green Thumb[26828:fb03] 0001-01-01 14:54:40 +0000 
```

因此，从选择器获取的原始日期完全关闭。从组件中获取的时间（根据拾取器的日期创建）是正确的，更正的时间也是正确的。但是，当我将组件放回 NSDate 实例时，一切又变得一团糟（但有所不同）。

我和谷歌我们都没有想法，所以我希望我们能在这里创造一些新的想法！

提前致谢， LetzFlow

PS：我正在使用 iPhone 5.1 Simulator 进行测试。

编辑＃1：

我已经找到了实际问题，但我再次陷入困境：

我已经追踪到以下几点：我将日期存储在 NSUserDefaults 对象中。

```
NSUserDefaults defaults = [NSUserDefaults standardUserDefaults];
[defaults setValue:[NSNumber numberWithFloat:[time timeIntervalSince1970]] forKey:@"notification.time"]; 
```

在这里我再次把它们拿出来：

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSNumber num = [defaults valueForKey:@"notification.time"];
NSDate* time = [NSDate dateWithTimeIntervalSince1970:[num floatValue]]; 
```

有趣的是：进去的不是出来的！但为什么？:)

编辑＃2：最后但并非最不重要的是我自己解决了它。谢天谢地，因为这是有史以来最愚蠢的错误。NSTimeInterval 不是浮点数，而是双精度数。到目前为止，我从未遇到过使用浮点数将其保存在 NSUserDefaults 中的任何问题，这似乎引发了错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:02:42.070

您的 NSLog 语句似乎格式错误（即“0001-01-01”部分）。试试这个：

```
NSString *output = [NSDateFormatter localizedStringFromDate:selected
                                                  dateStyle:NSDateFormatterShortStyle 
                                                  timeStyle:NSDateFormatterShortStyle];

NSLog(@"%@", output); 
```

# objective-c - 未命名变量的内存管理

> ID：10688528
> 
> 赞同：4
> 
> 时间：2012-05-21T15:56:05.263
> 
> 标签：objective-c, ios4, memory-management, memory-leaks

当我创建要分配给属性的变量时，我可以执行以下操作（假设属性为`@property (nonatomic,retain) UILabel *myLabel;`）：

```
UILabel *temp = [[UILabel alloc] init];
self.myLabel = temp;
[temp release]; 
```

在以下`temp`未使用的情况下会发生什么？

```
self.myLabel = [[UILabel alloc] init];
[myLabel release]; 
```

这是假设我会添加一个`[myLabel release];`由于`dealloc`属性。

这会是正确的内存管理吗？在第二个示例中，行`myLabel`后是否保留计数为 2 `init`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T16:02:35.713

第二个可能碰巧起作用，但不正确。第一行调用`setMyLabel:`. 设置 ivar 可能会发生这种情况，但可能不会。它可能会做各种各样的事情（它可能会制作副本，可能会将信息存储在其他地方，等等）。您的第二行发布了一个`ivar`. 如果设置器恰好按照您假设的方式实现，那么您会很幸运并且它会起作用。但这不是正确的内存管理。

第一个例子是正确的。您还可以使用自动释放池来简化事情。更好的做法是将您的代码移至 ARC，它可以更快、更轻松地解决所有这些问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-21T16:01:59.210

分配给`retain`属性将自动调用`retain`分配给的对象（并调用`release`前一个对象）。所以是的，之后

```
self.myLabel = [[UILabel alloc] init]; 
```

`[myLabel retainCount]`将返回 2，一个`init`来自分配属性，一个来自分配属性。因此，您应该添加`autorelease`到上面的行，或者`release`在函数退出之前调用。

# php - 关于非常简单但安全的登录的想法

> ID：10688529
> 
> 赞同：0
> 
> 时间：2012-05-21T15:56:15.197
> 
> 标签：php, html, security, login

我想要一个非常简单的登录功能集成到我服务器上的表单中。它将仅用于一页。您登录以便将文件上传到服务器。我目前使用Linux。有谁知道我可以从哪里开始。我在服务器上有 HTTPS/SSL 证书，所以它会有所帮助。但我真的不想变得复杂，只需要保持安全即可。想法？希望我在正确的地方。我想使用 PHP 来做到这一点。目标是在不使用 SQL 的情况下创建登录，因为它仅适用于一两个用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:00:04.700

您可以只使用 htaccess 对目录进行密码保护（cpanel/plesk 使这很容易做到），或者为您的用户提供一个 FTP 帐户来上传文件。

任何一个都可以快速轻松地设置，FTP 更安全（假设密码合理）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:07:36.463

就像是，

```
$hash = "precomputed hash of your password";
if (crypt($_POST['password'], '$6$rounds=5000$usesomesillystringforsalt$') == $hash)  {
   ...
} 
```

不需要数据库。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-21T16:00:59.427

这很简单，您只需要过滤输入，以便您的脚本从 sql 注入中保存，如果您想在同一页面上构建此功能，那么您必须使用适当的条件来检查传入的帖子数据，

php的`FILTER_SANITIZE_(check string,password,number,or other things)`这种方式很方便

# javascript - jQM自动完成如何获取用于回调的值？

> ID：10688531
> 
> 赞同：0
> 
> 时间：2012-05-21T15:56:22.027
> 
> 标签：javascript, jquery, jquery-mobile, autocomplete

我目前正在使用 JQM 自动完成功能，我可以在回调函数中访问标签 $a.text() 但不能访问值...如何访问值字段？

我的 JSON 结构是

```
{
    "label": "TEST CLIENT ONE",
    "value": {
        "internalCustomerID": 1,
        "contactName": "DASDASDASD",
        "name": "TEST CLIENT ONE",
        "address": "SESAME STREET",
    }
}
$("#textinput2").autocomplete({
                target: $('#suggestions'),
                source: jsData,
                callback: function(e) {
                    var $a = $(e.currentTarget);
                    console.log("Selected a: " +$a);
                    $('#textinput2').val($a.text());
                    $('#textarea2').val(jsData[id].value.internalCustomerID+' '+jsData[id].value.address);
                    $("#textinput2").autocomplete('clear');
                },
                minLength: 1
            }); 
```

我想这样做而不必再次在数组中搜索标签...我正在使用[http://www.andymatthews.net/read/2012/03/27/jQuery-Mobile-Autocomplete-now-available](http://www.andymatthews.net/read/2012/03/27/jQuery-Mobile-Autocomplete-now-available)作为我的自动完成。

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:52:41.247

转义您的 JSON 并将其放入 href 部分（因此它看起来像 #{x:1,y:2}，而不是将其转义回来，如下所示：

```
 callback: function(e) {//on each suggested item after it's clicked
            var a = $(e.currentTarget);
           var hDec = str2array(a.attr('href').substr(1));
        now.we.have.an.array(hDec[0],  hDec[1]);
            $('#sym_suggest').val(a.text());
            $("#sym_suggest").autocomplete('clear').val(""); 
        }, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T09:29:50.200

默认情况下，jqm 自动完成将您填充的“值”放在您给他的“链接”的末尾（在自动完成功能中）。

为了克服这个我添加到`"jqm.autoComplete-1.3.js"`文件中`line 27: (in the a tag)`

```
data-id="'+ value.value + 
```

然后在你的回调函数中你可以做：`$a.attr("data-id")`得到你的价值。

希望这可以帮助！

# jquery - 选择单选按钮后运行函数

> ID：10688541
> 
> 赞同：2
> 
> 时间：2012-05-21T15:57:23.133
> 
> 标签：jquery, radio-button

我还没有找到一篇真正询问单选按钮被选中的帖子。我不是在检查价值，只是当有人选择任何按钮时。

这是我所拥有的：

```
function turnSubmitBlue() {
$('.formSubmit').css('backgroundColor','#08aae4');
}

$('input:checkbox').each.change(function(){
if ($(this).attr('checked')) {
checkForThreeRadioBtns()
 };
});

function checkForThreeRadioBtns() {
        if (($('input[name=group1]:checked')) && ($('input[name=group2]:checked')) && ($('input[name=group3]:checked'))) {
            turnSubmitBlue();
            }
} 
```

我的想法是，在页面加载时，没有选择任何内容，我必须等到每个组中的一个被选中，然后通过提交按钮上的颜色更改来指示提交。（如果他们在从每个组中选择一个收音机之前点击提交，我确实会运行验证）。

一旦选择了三个按钮，运行函数以更改提交蓝色，显示其他内容（已经正常工作）。一旦他们点击提交，提交按钮就会变成灰色并显示结果。

此时，将始终选择三个，因此我只需要在发生更改时（通过单击不同的单选按钮）运行一个函数来更改提交按钮。

我的函数 checkForThreeRadioBtns() 应该确保在所有三个组中选择每个无线电中的一个，如果是，则触发函数运行 turnSubmitBlue()。

我一直在尝试让 jquery 检查单选按钮更改的那一刻，但到目前为止还没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:58:43.133

尝试如下，

```
$('input:checkbox').change(function(){
   if (this.checked) {
     checkForThreeRadioBtns();
   };
}); 
```

也尝试改变你的 if 条件，如下所示，

```
if ($('input[name=group1]:checked').length && 
        $('input[name=group2]:checked').length && 
        $('input[name=group3]:checked').length) 
```

**完整代码：**

```
function turnSubmitBlue() {
    $('.formSubmit').css('backgroundColor','#08aae4');
}

$('input:checkbox').change(function(){
   if (this.checked) {
     checkForThreeRadioBtns();
   };
});

function checkForThreeRadioBtns() {
    if ($('input[name=group1]:checked').length && 
          $('input[name=group2]:checked').length && 
            $('input[name=group3]:checked').length) {
        turnSubmitBlue();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:02:12.813

```
$('input[type=checkbox]').on('change', function(){
   if (this.checked) {
     checkForThreeRadioBtns()
   };
});

function checkForThreeRadioBtns() {
   if ($('input[name=group1]').is(':checked') && 
       $('input[name=group2]').is(':checked') && 
       $('input[name=group3]').is(':checked')) {
            turnSubmitBlue();
   }
} 
```

# php - HTML 下拉查询

> ID：10688545
> 
> 赞同：0
> 
> 时间：2012-05-21T15:57:47.453
> 
> 标签：php, html, sql, database

我希望从下拉菜单中为我的用户提供一个选项，以选择他们想要运行的查询，然后在单击菜单时触发查询运行。我在想类似的东西......

姓名-----地址----销售人员----完整报告--

因此，例如，如果用户从菜单中单击完整报告选项，它将触发此查询。

```
'SELECT DISTINCT jsfdName.baseData AS Name, jsfdAddr.baseData as Address, 
jsfdZip.baseData   AS Zip, jsfdCity.baseData AS City, jsfdState.baseData AS State,   
jsfdEmail.baseData AS Email,jsfdPhone.baseData AS Phone, jsfdPerson.baseData AS Person, 
jsfdContacted.baseData AS Contacted
FROM jos_sobipro_field_data AS jsfdName
JOIN jos_sobipro_field_data AS jsfdAddr USING(sid)
JOIN jos_sobipro_field_data AS jsfdZip USING(sid)
JOIN jos_sobipro_field_data AS jsfdCity USING(sid)
JOIN jos_sobipro_field_data AS jsfdState USING(sid)
JOIN jos_sobipro_field_data AS jsfdEmail USING(sid)
JOIN jos_sobipro_field_data AS jsfdPhone USING(sid)
JOIN jos_sobipro_field_data AS jsfdPerson USING(sid)
JOIN jos_sobipro_field_data AS jsfdContacted USING(sid)
WHERE jsfdName.fid = 36 AND jsfdAddr.fid = 37 AND jsfdZip.fid=38 AND jsfdCity.fid = 39     
AND jsfdState.fid = 41 AND jsfdEmail.fid = 65 AND jsfdPhone.fid = 46 AND jsfdPerson.fid  
= 66 AND jsfdContacted.fid = 63 AND sid > 900'; 
```

有任何想法吗？我也试图在一个文件中完成这一切，因为我希望它受到密码保护，以便只有用户才能访问它。谢谢你们的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:51:35.587

我假设您了解 php、html 和 sql 的基础知识。我只会告诉你如何选择哪个查询。

对于 html，我将其用于下拉列表：

```
<select name="report">
    <option value="1">Full Report</option>
    <option value="2">Some Other Report</option>
</select> 
```

您可以根据需要使用不同的值重复此操作。

现在对于 php（选择查询）：

```
<?php
switch($_POST['report']) {
    case "1":
        $query = "SOME QUERY TEXT WOULD GO HERE";
        break;
    case "2":
        $query = "TEXT FOR A DIFFERENT QUERY HERE";
        break;
    default:
        //DO SOMETHING HERE IF THE VALUE IS NOT RECOGNIZED
        break;
}
//NOW RUN THE QUERY WITH $query as the string
?> 
```

您可以根据需要添加任意数量`case`的 s 以满足您的需要。

# cmake - 如何在 CMake 中配置可移植并行构建？

> ID：10688549
> 
> 赞同：65
> 
> 时间：2012-05-21T15:58:06.027
> 
> 标签：cmake, parallel-builds

无论使用哪种构建工具，是否有可能以某种方式进行并行构建？

在 Unix 下，我们可以添加`make -jN`其中 N 是线程数，在 Windows 下，我添加到`CXX_FLAG "/MP"`其中，然后在 Visual Studio 中用于并行构建......（？）我怎样才能使我的版本`CMAKE_MAKE_PROGRAM`不总是在我扩展时运行 CMake？

什么是通用解决方案？

我想出了这个：

```
# Add some multithreaded build support
MARK_AS_ADVANCED(MULTITHREADED_BUILD)
set(MULTITHREADED_BUILD 12 CACHE STRING "How many threads are used to build the project")
if(MULTITHREADED_BUILD)
    if(${CMAKE_GENERATOR} MATCHES "Unix Makefiles")
            message(STATUS ${CMAKE_BUILD_TOOL})
            set(CMAKE_MAKE_PROGRAM "${CMAKE_MAKE_PROGRAM} -j${MULTITHREADED_BUILD}")
            message(STATUS "Added arguments to CMAKE_BUILD_TOOL: ${CMAKE_MAKE_PROGRAM}")
    elseif(MSVC)
      set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /MP")
      message(STATUS "Added parallel build arguments to CMAKE_CXX_FLAGS: ${CMAKE_CXX_FLAGS}")
    endif()
endif() 
```

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2018-06-15T22:49:35.053

使用 CMake 3.12，这是可能的。从[发行说明](https://cmake.org/cmake/help/latest/release/3.12.html#command-line)：

> 获得的`cmake(1)`构建项目 ( `cmake --build`)`--parallel [<jobs>]`和`-j [<jobs>]`指定并行构建级别的选项。它们映射到本机构建工具的相应选项。

[正如 dkg 所提到的](https://stackoverflow.com/questions/10688549/how-do-i-configure-portable-parallel-builds-in-cmake#comment92443646_50883540)，您还可以设置环境变量`CMAKE_BUILD_PARALLEL_LEVEL`。

CMake 文档的链接：

*   *[建立一个项目](https://cmake.org/cmake/help/latest/manual/cmake.1.html#build-tool-mode)*
*   *[CMAKE_BUILD_PARALLEL_LEVEL](https://cmake.org/cmake/help/latest/envvar/CMAKE_BUILD_PARALLEL_LEVEL.html)*

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-06-30T07:55:09.463

如果你有 CMake v2.8.8 或更高版本，你可以使用[**Ninja**](https://ninja-build.org/)作为[GNU**`make`**](https://www.gnu.org/software/make/)的替代品：

```
mkdir build
cd    build
cmake -G Ninja ..
ninja              # Parallel build (no need -j12) 
```

或者

```
mkdir build
cd    build
cmake -G Ninja ..
cmake --build .    # Parallel build using Ninja 
```

如您所见，无需使用`CMAKE_MAKE_PROGRAM`，构建默认并行运行，根据可用的 CPU 内核优化作业数量。

Ninja 基于低级 JSON 配置来加速启动阶段。因此它的 JSON 配置不容易手动编写，我总是使用高级工具/IDE 生成它：

*   [CMake v2.8.8](https://cmake.org/pipermail/cmake/2012-April/049955.html) (2012)
*   [Qt Creator v2.6](https://www.slicer.org/wiki/Documentation/Labs/Ninja#Using_it) (2012)
*   [KDevelop v4.6](https://www.kdevelop.org/46/kdevelop-460-final-released) (2013)
*   [Linux 上的介子](https://en.wikipedia.org/wiki/Meson_(software)#Usage)(2013)
*   [...在https://github.com/ninja-build/ninja/wiki/List-of-generators-produce-ninja-build-files](https://github.com/ninja-build/ninja/wiki/List-of-generators-producing-ninja-build-files)查看 Ninja 配置的生成器

由于 C++ 构建通常需要大量内存，因此您的计算机必须提供与 CPU 内核数量一样多的内存。

[正如Ruslan](https://stackoverflow.com/users/673852/ruslan)所指出的，CMake [3.12](https://github.com/Kitware/CMake/releases/tag/v3.12.0) (2018) 有一个[新选项](https://cmake.org/cmake/help/v3.12/release/3.12.html#command-line) `cmake --build -j <N>`，可以将构建限制为`<N>`核心（作业），从而限制内存消耗（另请参阅[文档](https://cmake.org/cmake/help/v3.12/manual/cmake.1.html#build-tool-mode)）。如果您使用较旧的 CMake 版本，您仍然可以使用`cmake --build -- -j <N>`. 该选项`--`告诉 CMake 将其余部分直接传递给底层构建器工具，这里是 Ninja。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-09-01T09:33:08.693

现在使用 cmake 并行构建非常简单。您可以在使用“cmake --build”时添加“-j jobs_number”。例如：

```
cmake --build . -j 24 
```

更多细节可以在 CMAKE 手册中找到：[https ://cmake.org/cmake/help/latest/manual/cmake.1.html#build-tool-mode](https://cmake.org/cmake/help/latest/manual/cmake.1.html#build-tool-mode)

> --parallel [], -j [] 构建时使用的最大并发进程数。如果省略，则使用本机构建工具的默认编号。
> 
> 如果设置了 CMAKE_BUILD_PARALLEL_LEVEL 环境变量，则在未给出此选项时指定默认并行级别。
> 
> 一些原生构建工具总是并行构建。使用值 1 可用于限制单个作业。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-25T03:33:44.583

你不能做这个跨平台。-jN 选项是 make 的一个参数，而不是生成的 Makefile 的一部分。但是，您可以让 CMake 生成一个 Bash 脚本，该脚本使用 -jN 为您的项目运行 make（该脚本在其中查找您拥有的内核数）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-30T11:29:27.710

我已经决定为基于 - 的生成器编写`parallelmake.sh`脚本。`Unix Makefiles`这是在这里完成的：[https ://github.com/gabyx/ApproxMVBB](https://github.com/gabyx/ApproxMVBB)

以及 CMake 文件中的相关部分：

[https://github.com/gabyx/ApproxMVBB/blob/master/CMakeLists.txt#L89](https://github.com/gabyx/ApproxMVBB/blob/master/CMakeLists.txt#L89)

```
# Add some multithreaded build support =====================================================================================================
MARK_AS_ADVANCED(MULTITHREADED_BUILD)
SET(MULTITHREADED_BUILD ON CACHE BOOL "Parallel build with as many threads as possible!")
if(MULTITHREADED_BUILD)
    if(${CMAKE_GENERATOR} MATCHES "Unix Makefiles")
            file(COPY ${ApproxMVBB_ROOT_DIR}/cmake/parallelmake.sh DESTINATION ${PROJECT_BINARY_DIR}
                FILE_PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE
                NO_SOURCE_PERMISSIONS
            )
            SET(CMAKE_MAKE_PROGRAM "${PROJECT_BINARY_DIR}/parallelmake.sh")
            MESSAGE(STATUS "Set make program to ${PROJECT_BINARY_DIR}/parallelmake.sh")
    elseif(MSVC)
      SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS}" "/MP")
      MESSAGE(STATUS "Added parallel build arguments to CMAKE_CXX_FLAGS: ${CMAKE_CXX_FLAGS}")
    endif()
endif()
# ======================================================================================================================================== 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-11-24T20:32:17.687

正如上面已经提到的，可以使用`--parallel [<jobs>]`（或`-j [<jobs>]`）CMake 选项来并行构建解决方案。

但我想指出，在 Windows 中，一个命令

```
cmake.exe --build --parallel <jobs> 
```

使用以下参数启动根 MSBuild 进程：

```
msbuild.exe /m:<jobs> /p:CL_MPCount=1 <another-useful-arguments> 
```

这意味着将启动多个 MSBuild 进程——`/maxcpucount:<jobs>`也就是`/m:<jobs>`. 但是它们中的每一个都最多运行一个编译器进程（有关更多详细信息，请参[见此链接](https://gitlab.kitware.com/cmake/cmake/-/issues/20564)）。换句话说，每个 MSBuild 最多可以同时编译一个源文件。

为了克服这一限制，可以通过以下方式调用 CMake：

```
cmake.exe --build --parallel <n_msbuild> -- /p:CL_MPcount=<n_cl> 
```

这种方法设置[`/MP`选项](https://docs.microsoft.com/en-us/cpp/build/reference/mp-build-with-multiple-processes?view=msvc-150)从而允许在每个 MSBuild 实例下有多个编译器进程。

* * *

并记录在案。要配置从 Visual Studio GUI 运行的构建，需要转到*Settings*：

*   选项*“项目和解决方案 → 构建和运行 → 构建并行项目的最大数量”*会影响`maxcpucount`.
*   Option *"Projects and Solutions → VC++ Project Settings → Build → Maximum Concurrent C++ Compilations"* represents the default boundary to `/MP`.

# iis-7 - 使用 MSBuild 扩展包和 IIS7 任务的权限问题

> ID：10688556
> 
> 赞同：2
> 
> 时间：2012-05-21T15:58:23.290
> 
> 标签：iis-7, msbuild, msbuildextensionpack

我试图在扩展包中使用 iis7 web 任务。我无法成功使用该任务（具有我的上帝级别管理员访问权限），但我的问题是我无法将它与必须运行它的用户（服务用户）一起使用。

```
<Target Name="CheckForSite">
<Message Text="Site:              $(Site)" />
<Message Text="Application:       $(Application)" />
<Message Text="Server:            $(Server)" />
<Message Text="PhysicalPath:      $(PhysicalPath)"/>

<!-- Check if the site exists -->
<MSBuild.ExtensionPack.Web.Iis7Website TaskAction="CheckExists"
                                       Name="$(Site)"
                                       MachineName="$(Server)"
                                       >
  <Output TaskParameter="Exists" PropertyName="SiteExists"/>
</MSBuild.ExtensionPack.Web.Iis7Website>

<Message Text="Site Exists: $(SiteExists)" Condition="$(SiteExists)"/>
<Message Text="Site does not exist: $(SiteExists)" Condition="(!$(SiteExists))"/> 
```

我收到错误：错误：UnauthorizedAccessException：由于以下错误，从机器检索具有 CLSID {2B72133B-3F5B-4602-8952-803546CE3344} 的远程组件的 COM 类工厂失败：80070005

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T19:55:11.013

这是拒绝访问异常。尝试将 Username="username" UserPassword="password" 属性添加到 MSBuild.ExtensionPack.Web.Iis7Website 任务中。用户应该是目标机器上的管理员。

就我而言，我在域通信方面遇到了问题。我的服务器与我的用户域位于不同的域中。它是由我们的基础架构团队修复的。我在事件日志中发现了这个问题。首先检查事件日志是否有任何相关问题。

# url - 实时对象 URL

> ID：10688561
> 
> 赞同：0
> 
> 时间：2012-05-21T15:58:57.313
> 
> 标签：url, facebook-opengraph

对象 URL (og:url) 应该/必须可用多长时间？仅在我将操作发送到 Facebook 时或更长时间/永远？

拉尔夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:11:44.000

理想情况下，您的对象 URL 应该在产品的整个生命周期内都存在——希望是无限期的。

但是，如果 facebook 无法为您的 URL 检索元数据，它将继续使用上次看到的元数据。

# msbuild - MSBuild 脚本dependsOnTargets 执行顺序

> ID：10688567
> 
> 赞同：3
> 
> 时间：2012-05-21T15:59:16.507
> 
> 标签：msbuild

我的构建脚本中有这一行

```
<Target Name="Deploy" DependsOnTargets="ServicesInstall;SitesTransfer" > 
```

我想知道的是，在这个例子中，目标的执行顺序是什么。此外，如果 ServiceInstall 具有依赖项，它们会在 SiteTransfer 之前还是之后执行。换句话说，执行是以深度优先还是广度优先的方式完成的？

谢谢，

萨钦

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T22:13:32.397

作为一个实验，我尝试了这个：

```
<Target Name="Deploy" DependsOnTargets="ServicesInstall;SitesTransfer" />
<Target Name="ServicesInstall" DependsOnTargets="ServicesInstallDependency">
   <Message Text="ServicesInstall" />
</Target>
<Target Name="ServicesInstallDependency">
   <Message Text="ServicesInstallDependency" />
</Target>
<Target Name="SitesTransfer">
   <Message Text="SitesTransfer" />
</Target> 
```

这是输出：

```
...
1>ServicesInstallDependency:
1>  ServicesInstallDependency
1>ServicesInstall:
1>  ServicesInstall
1>SitesTransfer:
1>  SitesTransfer
... 
```

但是，我怀疑确切的顺序是不确定的。它没有记录在[msdn](http://msdn.microsoft.com/en-us/library/ee216359.aspx)上。

换句话说，msbuild 只会保证您指定的约束得到满足。如果你需要保证`SitesTransfer`它的依赖在之前执行过`ServicesInstall`，你应该`ServicesInstall`makedepend on `SitesTransfer`。

# javascript - JavaScript 扩展数组

> ID：10688569
> 
> 赞同：0
> 
> 时间：2012-05-21T15:59:29.880
> 
> 标签：javascript, jquery, arrays, underscore.js

我有一个对象数组。在循环期间，我将不同的属性附加到每个条目。

我的问题 - 我如何确保每个条目都具有每个条目的所有属性？

让我们考虑一下：

```
var myArray = [{A: 1}, {B: 2}, {C: 3}]; 
```

现在我想运行一些优雅的单线来将此数组转换为：

```
[{A: 1, B:2, C: 3}, {A: 1, B:2, C: 3}, {A: 1, B:2, C: 3}] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T16:03:39.557

如果没有库，优雅的单线会有点困难。但如果你有某种`extend`功能，那么它可能是：

```
myArray.map(function(v) { return extend.apply(null, [{}].concat(myArray)); }); 
```

该`extend`函数需要组合多个对象（作为单独的参数传递）。jQuery as 中就有这样的功能`jQuery.extend`，underscore.js 也有。

# .htaccess - 301 从动态重定向到 .html。想要404原版

> ID：10688578
> 
> 赞同：0
> 
> 时间：2012-05-21T15:59:50.813
> 
> 标签：.htaccess

如果在错误的地方，我很抱歉。我有人做了 301 重定向，动态页面被重定向到显示 .html。（www.printe-z.com/computer-checks 到 www.printe-z.com/computer-checks.html）他们认为现在应该为原始页面使用自定义 404 页面；www.printe-z.com/computer-checks。你怎么看？让它保持原样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:02:44.323

如果页面已移动，则使用 301。如果将其全部删除，则使用 404。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:02:10.510

301 更适合这种情况，特别是对于搜索引擎：它们会将您的旧网址与新网址相关联，以便您保持网页排名。

访问您的旧链接的人也将受益，因为他们将被自动重定向到新网址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:04:55.017

301 告诉 googlebot 等爬虫，原始页面`moved permanently`到目标页面。所以保持原样。

供您参考，大多数 URL 重写都是使用 301 永久重定向完成的。`domain.com`还将访问者发送到`www.domain.com`是使用 301 重定向的示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T17:42:39.967

人们可能已经为旧网址添加了书签，或者网站上可能有指向旧网址的链接。除非您确定不再是这种情况，否则您永远不能，您可以删除 301。但这是一个完美的世界。

如果 301 是维护负担，或者有其他负面影响，并且 301 已经存在了一段时间（> 1 年），您可以将它们移除。但如果不是就这样吧。

# scala - play2 让 Enumeratee 将一个 Promise 转换为另一个 Promise

> ID：10688581
> 
> 赞同：2
> 
> 时间：2012-05-21T16:00:17.470
> 
> 标签：scala, playframework, playframework-2.0, iterate

我正在尝试掌握在 Play 2 中使用 Iteratees 流式传输彗星结果的方法。我已经掌握了从回调创建枚举器和从地图创建枚举器的句柄。我的问题是 Enumeratee.map，这需要一个函数，该函数接受纯输入并返回纯输出（例如[doc](https://github.com/playframework/Play20/wiki/Enumeratees)中的 String 到 Int 的转换）。我想做的是接受一个纯粹的输入并返回一个结果的承诺。毕竟，枚举器向枚举器提供承诺，枚举器将一个枚举器转换为另一个枚举器，因此应该有一种方法可以使枚举器映射到承诺。

现在，让我举一个例子来说明这一点。假设我有一个 http 请求，其中包含要在我的数据库中查询的 ID 列表。假设这些 id 表示数据库表中的行，请求对这些行执行一组（长）计算，然后返回一组表示计算的 json 对象。由于我有很长的事情要做，所以一次流式传输一个 ID 会很酷，所以我希望有一个枚举管道：

1.  查询数据库中的一行（返回该行的承诺）
2.  对行进行长时间计算（取一行并返回计算的承诺）
3.  将长计算转换为 JSON
4.  &> 将此输出到 Play 2 提供的 Comet 枚举对象

1 有点简单，我可以构造一个带有 fromCallback 的枚举器，它将返回查询结果的承诺。3 也有点简单，因为它是一个简单的 Enumeratee.map

但是我无法理解如何实现步骤 2 的枚举对象的 applyOn。我可以理解我已经构建了一个新的迭代对象，它从“内部”迭代对象获得承诺，flatMap 长计算并返回新的承诺。我没有得到的是如何在给定奇怪的 applyOn 签名的情况下做到这一点：`def applyOn[A](it: Iteratee[To, A]): Iteratee[From, Iteratee[To, A]]`

有人可以帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T22:06:31.070

主 Enumeratee.mapM[E] 上有一个方法，它采用 f: E => Promise[NE] 并返回 Enumeratee[E, NE]

[https://github.com/playframework/Play20/blob/master/framework/src/play/src/main/scala/play/api/libs/iteratee/Enumeratee.scala#L150](https://github.com/playframework/Play20/blob/master/framework/src/play/src/main/scala/play/api/libs/iteratee/Enumeratee.scala#L150)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:47:41.217

`applyOn`当您认为 enumeratee 与右侧的 iteratee 组合时，签名更有意义，例如 in `enumerator |>> (enumeratee &> iteratee)`。iteratee 具有类型`Iteratee[E, A]`，并且 enumerator 需要 a`Iteratee[Promise[E], Iteratee[E, A]`以便可以提取内部 iteratee。所以`applyOn`必须 a`Iteratee[E, A]`并返回 a `Iteratee[Promise[E], Iteratee[E, A]`。

这是一个实现的概要。它定义了一个阶跃函数，该函数接受输入并返回预期结果。然后递归地遍历承诺元素。

```
import play.api.libs.concurrent._
import play.api.libs.iteratee._

def unpromise[E]: Enumeratee[Promise[E], E] = new Enumeratee[Promise[E], E] {
  def applyOn[A](inner: Iteratee[E, A]): Iteratee[Promise[E], Iteratee[E, A]] = {
    def step(input: Input[Promise[E]], i: Iteratee[E, A]): Iteratee[Promise[E], Iteratee[E, A]] = {
      input match {
        case Input.EOF => Done(i, Input.EOF)
        case Input.Empty => Cont(step(_, i))
        case Input.El(pe) =>
          val pe2 = pe.map(e => i.feed(Input.El(e))).flatMap(identity)
          val i2 = Iteratee.flatten(pe2)
          i2.pureFlatFold(
            (a, e2) => Done(i2, Input.Empty),
            k => Cont(step(_, i2)),
            (msg, e2) => Done(i2, Input.Empty))
      }
    }
    // should check that inner is not done or error - skipped for clarity
    Cont(step(_, inner))
  }
} 
```

我正在丢弃`e2`，因此可能有更多代码来确保某些输入不会丢失。

# ssis - oledb目的地中的两个保持身份有什么区别

> ID：10688583
> 
> 赞同：3
> 
> 时间：2012-05-21T16:00:30.887
> 
> 标签：ssis

在 OLE DB 目标编辑器中保持身份和在 OLE DB 目标中快速加载保持身份有什么区别？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T16:10:23.993

当您使用快速加载时，您可以选择保留记录的身份。因此，如果您将表 A 中的行插入表 B 并且表 B 具有标识字段，如果您选中“保留标识”，它将忽略表 B 上的标识生成规则并在表 A 上插入标识值。

示例（假设表 B 为空，ID 为 identity(1,1) 字段：

```
TableA ID's   TableB keep identity off    TableB keep identity on
10                   1                              10
11                   2                              11
12                   3                              12 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T21:44:19.480

我假设您在谈论 OLE DB 目标编辑器之间的区别

![OLE DB 目标编辑器](../Images/33d46dd405a781cd6e91b5302e4309f6.png)

和相应的属性？

![OLE DB 目标属性](../Images/78c5b710cbf6d548db2cd605b2f5c2f7.png)

他们是一样的东西。第二个图像是在 XML 中从对象序列化出来的内容，而前者是 BIDS/SSDT 对这些属性的表示。您可以通过打开或关闭其中一个并观察相同的更改反映在另一个中来验证这一点。

一般来说，SSIS 中对象的属性将始终向您展示未经修饰的事实，但列出的项目可能并不总是有用或命名良好。对于这些项目，SSIS 团队通常会提供定制的编辑器来处理或配置组件。

# html - Css：min-height 解释为高度（iPhone webapp）

> ID：10688584
> 
> 赞同：1
> 
> 时间：2012-05-21T16:00:33.043
> 
> 标签：html, css, iphone-web-app

我*基于 iWebKit 的 framework 构建了一个 iPhone webb 应用程序*。我目前正在集成一个 CSS div 滑块来改进页面（div）之间的导航，除了一件事之外，一切都很好。

似乎我应该为包含滑动对象的 div 设置一个固定的高度值。这些对象将包含相当多的内容并且尺寸谨慎，因此默认情况下 div/页面必须垂直扩展。出于某种原因，**浏览器似乎将 min-height 解释为高度，并且没有扩展 div 以显示所有内容。**我意识到某处可能有一个小错误，我忘记添加或删除。请通过为我指出这些来帮助我。谢谢

包含幻灯片的包装器：

```
#contentWrapper {
float: left;
min-height:305px;
position: relative;
margin:0px;
padding-bottom:0px;
display:block !important;
} 
```

在每个滑动 obj 上添加的类

```
.additional-block {
height:auto;
position: absolute;
padding-bottom:30px;
display:block !important;
} 
```

**现场演示：** [http](http://utvecklingspunkten.se/heightIssue.php) ://utvecklingspunkten.se/heightIssue.php 点击“点击”查看实际出现的问题；文本在 305 像素以下被截断。该问题出现在所有浏览器中，包括 iPhone 版 Safari。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:04:20.163

这是`overflow: hidden`您的“content2” div 上的冲突。设置这意味着容器可以溢出，所以它确实如此。（删除 min-height 会告诉你，否则它会是 0 像素高。）

删除溢出设置会产生我认为你想要的效果。

# iphone - 检测视图控制器

> ID：10688585
> 
> 赞同：0
> 
> 时间：2012-05-21T16:00:35.097
> 
> 标签：iphone, ios4, ios5, uiviewcontroller, detect

我有一个应用程序，它处理很多功能，也有很多导航。

我在我的应用程序中使用了很多 BOOL。我知道它没有效率。所以我想删除这些 BOOL 来创建更高效​​、更干净的应用程序。

这是我的问题。例如，假设我有 3 个 UIViewController。

测试1，测试2，测试3

我需要从 Test1 和 Test2 视图 Controllers 导航到 Test3 。此外，如果我从 Test1 导航到 Test3 View Controller，我需要执行一个方法，如果我从 Test2 导航到 Test3，我需要执行另一个方法。

目前我正在做的是，我正在使用 Globals.h 和 Globals.m 类来解决这个问题。我在 Globals 中创建了一个 BOOL 并在 Test1 中启用了该 BOOL 值，然后我在 Test3 中检查了该 BOOL 值并执行了我想要的方法。

这只是一个例子。我有很多视图控制器和应用程序的很多行为。所以我在 Globals 中创建了很多 BOOL，并在不同的类中使用它们。因此，在一个应用程序中处理大量布尔值是一件很痛苦的事情，而且也不好。那么任何人都可以帮助我如何克服这个问题。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:17:53.460

尝试使用导航控制器的 viewControllers 属性。

[UINavigationController 参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html)

我的意思是，当视图控制器加载时，您需要根据它的来源完成特定操作，抓取视图控制器数组并查看位置 n - 2 处的对象（其中 n 是数组中的元素数） . 然后使用 isKindOfClass 方法测试该对象的类的类型并执行适当的操作。

粗略的例子：

-（无效）viewDidLoad {

```
 [super viewDidLoad];

 NSArray *viewControllers = [[self navigationController] viewControllers];

 int parentIndex = [viewControllers count] - 2;
 UIViewController *parentVc = [viewControllers objectAtIndex:parentIndex];

 if ([parentVc isKindOfClass:ClassA.class]) {
  //action
 }
 else if ([parentVc isKindOfClass:ClassB.class]) {
  //different action
 }
 else ... etc 
```

}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:20:10.120

就像@mrunal 说的你可以使用 isKindOfClass。只是想通了一些代码。

```
// self is Test3

if ([self.presentingViewController isKindOfClass:[Test1ViewController class]]) {
    // Run your method for Test1 - Test 3 here.
} 
```

如果您正在推送或呈现模式，则需要获取实际的 viewController，因为 presentingViewController 将是 UINavigationController。我就是这样做的。

```
// self is Test3

if ([self.presentingViewController.childViewControllers.lastObject isKindOfClass:[Test1ViewController class]]) {
    // Run your method for Test1 - Test 3 here.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T16:12:38.390

您还可以使用***NSObject***方法[***isKindOfClass***](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html)检查类。

您还可以找到该方法说明中给出的示例。

在这里您可以比较对象是哪种类，并据此执行您的操作。

为此，您每次都可以将***自己的引用传递给 Controller3，并且可以将其存储为******id***类型。

希望这会对您的代码有所帮助。

# php - 我应该为 mp3 使用哪种 mime 类型

> ID：10688588
> 
> 赞同：123
> 
> 时间：2012-05-21T16:00:37.163
> 
> 标签：php, mp3, mime-types

我正在尝试决定选择哪种 mime 类型来返回 mp3 数据（由 php 提供）

根据这个 mime 类型列表：[http ://www.webmaster-toolkit.com/mime-types.shtml](http://www.webmaster-toolkit.com/mime-types.shtml)

```
.mp3    audio/mpeg3
.mp3    audio/x-mpeg-3
.mp3    video/mpeg
.mp3    video/x-mpeg 
```

这些有什么区别，我应该使用哪个？

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2012-05-21T16:03:47.047

您最好的选择是使用[RFC 定义](https://www.rfc-editor.org/rfc/rfc3003)的mime-type `audio/mpeg`。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2015-01-19T09:38:35.710

我遇到了 mime 类型以及对少数文件类型进行测试的问题。看起来每个浏览器都会发送特定文件的 mime 类型的变体。我试图用开源 php 类上传 mp3 和 zip 文件，我发现：

*   火狐 (mp3): 音频/mpeg
*   火狐 (zip): 应用程序/zip
*   铬 (mp3)：音频/mp3
*   Chrome (zip)：应用程序/八位字节流
*   歌剧（mp3）：音频/mp3
*   Opera (zip)：应用程序/八位字节流
*   IE (mp3)：音频/mpeg
*   IE (zip): application/x-zip-compressed

因此，如果您需要上传多种文件类型，最好进行一些测试，以便每个浏览器都可以上传文件并通过 mime 类型检查。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-05-21T16:02:34.450

使用`.mp3 audio/mpeg`，这是我一直使用的。我猜其他人只是别名。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-07-02T08:28:46.220

您应该始终使用**audio/mpeg**，因为 firefox 无法播放**audio/mpeg3**文件

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-06-27T04:34:04.513

[标准](https://www.rfc-editor.org/rfc/rfc3003)方法是在您的 PHP[标头](http://php.net/manual/en/function.header.php)函数中使用类似`audio/mpeg`这样的东西...

`header('Content-Type: audio/mpeg');`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-09T02:39:46.783

根据这个答案，mp3 文件有时会抛出奇怪的 mime 类型：[https ://stackoverflow.com/a/2755288/14482130](https://stackoverflow.com/a/2755288/14482130)

如果您正在执行某些用户验证，请不要像上面建议的那样允许“application/octet-stream”或“application/x-zip-compressed”，因为它们可能包含 .exe 或其他潜在危险文件。

为了验证 mime 类型何时给出假阴性，您可以按照这个答案[https://stackoverflow.com/a/52570299/14482130](https://stackoverflow.com/a/52570299/14482130)使用fleep 来完成验证。

# regex - gvim搜索使用正则表达式匹配多个字符

> ID：10688592
> 
> 赞同：2
> 
> 时间：2012-05-21T16:00:55.627
> 
> 标签：regex, search, vim

我正在尝试在 gvim 中搜索以下模式：

```
arrayA[*].entryx 
```

希望它会匹配以下内容：

```
arrayA[size].entryx  
arrayA[i].entryx
arrayA[index].entryx 
```

但即使文件中存在上述行，它也会打印消息说找不到模式。

```
arrayA[.].entryx 
```

仅匹配 arrayA[i].entryx 即 [] 大括号之间只有一个字符。

我应该怎么做才能匹配 [] 大括号之间的多个字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:25:00.320

这是 PCRE 表达式的详细信息

```
/arrayA\[[^]]*]\.entryx/
         ^^^^^            # 0 or more characters before a ']'
       ^^      ^^         # Escaped '[' & '.'
              ^           # Closing ']' -- does not need to be escaped
 ^^^^^^          ^^^^^^   # Literal parts 
```

如果你想找`arrayA[X].entryx`哪里，至少有一个字符在`[]`，
你需要替换 `\[[^]]*`为`\[[^]]\+`

ps：注意我的编辑——我已经把它改成了`\*`——`*`你也不能逃避它。
但是，你需要逃避`+` `:-)`

* * *

`Update`关于您的评论：
虽然我的评论回答了您关于`]`广泛转义的问题，但
有关更多详细信息，请查看[Perl 字符类](http://perldoc.perl.org/perlrecharclass.html)详细信息。
具体来说，`Special Characters Inside a Bracketed Character Class`节。角色启动字符类 (CCL)
后，需要转义的规则会发生变化。`[`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:06:39.790

`*`重复前一个字符；并`[`开始一个字符类。所以，你需要更多类似的东西：

```
/arrayA\[[^]]*]\.entryx/ 
```

这会查找文字`[`、一系列零个或多个字符，而不是`]`文字`]`、文字`.`和`entryx`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:29:38.653

永远记住，在 VIM 中您需要转义一些特殊字符，例如`[`, `]`, `{`,`}`和`.`. 如前所述，`*`重复上一个字符，使用这个你可以简单地使用`/arrayA\[.*\]\.entryx`，但是这个`*`是贪婪的字符，它可能会匹配一些奇怪的东西，将以下行添加到你的文件中，你会明白：`arrayA[size].entryx = arrayB[].entryx`

“更安全”的正则表达式是：

```
/arrayA\[.\{-\}\]\.entryx 
```

`.\{-\}`以非贪婪的方式匹配任何角色，女巫在某些情况下更安全。

# ruby-on-rails - Rmagick SVG 转换不同于 ImageMagick

> ID：10688595
> 
> 赞同：4
> 
> 时间：2012-05-21T16:01:02.530
> 
> 标签：ruby-on-rails, heroku, svg, imagemagick, rmagick

这是我的测试的链接： http: [//pestnow.herokuapp.com/tester/svg](http://pestnow.herokuapp.com/tester/svg) 左边的图像是 SVG，右边的是 PNG 转换。这是转换的极其简单的代码：

```
def self.svg_to_png(svg)
  img = Magick::Image::from_blob(svg)
  return img[0].to_blob {self.format = 'PNG'}
end 
```

我一直在努力解决这个问题，并在这里回答了这个问题：[SVG to PNG Conversion with ImageMagick does not handle defs?](https://stackoverflow.com/questions/10658872/svg-to-png-conversion-with-imagemagick-doesnt-handle-defs) 这个问题与让 IM 正确进行转换有关。它确实，从命令行使用一个简单的“convert test.svg test.png”

但是 RMagick 转换的工作方式不同。在我的本地开发机器上，我确实使用 RVG 支持编译了 ImageMagick，并且修复了命令行。但我不知道如何让 RMagick 以同样的方式使用它。

此外，我希望它是我需要在我的代码中做的事情，而不是服务器上需要的某些功能，因为这个应用程序托管在 heroku 上，我无法控制他们如何安装 IM。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T23:35:47.633

我应该回来报告的。

是的，Heroku 有 IM，但他们不支持它。它只是他们使用的（我相信）Ubuntu 的长期支持版本的一部分。我们来回讨论了几次，他们说他们将来可能会升级它，以及其他 linux libs / utils，但没有明确的时间表。我的猜测是，也许在下一个堆栈上。

在那之前，我已经停止在我的 SVG 中使用符号，并且不得不在转换顺序上做一些技巧，但在大多数情况下，我的工作正常。另一条建议是确保您使用的是 Heroku 在您的 Dev box 上使用的 IM 的 EXACT 版本。省了很多心痛。

# java - 从 Java 中的数据库流式传输视频

> ID：10688597
> 
> 赞同：0
> 
> 时间：2012-05-21T16:01:21.947
> 
> 标签：java, database, video, jmf

我必须从数据库中流式传输一些视频。我计划使用 Java Media Framework，因为我从查询结果中获取 Blob 对象，但显然 JMF 无法从流中播放视频，而只能从 URL 中播放。有谁知道如何解决这个问题？如果 JMF 无法解决，有人可以推荐我一个不同的框架吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:58:02.553

您可以[注册一个协议处理程序](http://java.sun.com/developer/onlineTraining/protocolhandlers/)，然后在 JMF 中使用这个特殊的 URL。在我看来，注册协议处理程序有点复杂，但互联网上有很多[例子](http://accu.org/index.php/journals/1434)。

# javascript - 正则表达式：匹配之间

> ID：10688598
> 
> 赞同：0
> 
> 时间：2012-05-21T16:01:25.207
> 
> 标签：javascript, regex

我有一个示例字符串：

> iasfa345.12isnhf 纬度：46.7132N，经度：116.997W EFONA345.55SDF

我需要从中提取 116.997 和 46.7132。

我只设法得到：

```
x.match(/Long: .{7}/g)
x.match(/Lat: .{6}/g) 
```

但它包括 Long: 或 Lat: 我稍后需要 substr() 。

完美的解决方案是匹配“Lat:”和“N or S”之间以及“Long:”和“W or E”之间的任何数字和单个点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:09:31.893

您可以使用`exec`*^([[MDN]](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp/exec))*方法：

```
var str = 'iasfaisnhf Lat: 46.7132N, Long: 116.997W EFONASDF',
    latPattern = /Lat: (\d*\.\d+)/,
    longPattern = /Long: (\d*\.\d+)/;​​​​​​​​​​​​​​​​​​​​​​​​​​

alert(latPattern.exec(str)[1]);
alert(longPattern.exec(str)[1]); 
```

如果您需要方向指示器，就像您需要的那样，模式将是：

*   `/Lat: (\d*\.\d+)(N|S)/`
*   `/Long: (\d*\.\d+)(E|W)/`

方向指示符将位于返回的对象的索引 2 处`exec`。

这是一个[工作示例](http://jsfiddle.net/bFysk/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:03:30.067

对于这种格式，您可以使用：

```
var str = "iasfaisnhf Lat: 46.7132N, Long: 116.997W EFONASDF";
var values = str.replace(/[^\d.,]/g, "").split(',');

values[0] == "46.7132"
values[1] == "116.997" 
```

[**现场演示**](http://jsfiddle.net/WJcpD/1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T16:08:39.547

```
Lat:\s?(.*?)N 
```

提取第一组，它将包含纬度。

```
Long:\s?(.*?)W 
```

提取第一组，它将包含经度。

# python - 成功安装 NumPy，但无法使用 virtualenv 访问

> ID：10688601
> 
> 赞同：0
> 
> 时间：2012-05-21T16:01:31.947
> 
> 标签：python, ubuntu, numpy, virtualenv

我已经在 Ubuntu 上成功安装了 NumPy；但是，当在 virtualenv 中时，NumPy 不可用。我一定遗漏了一些明显的东西，但我不明白为什么在从 virtualenv 中使用 python 时我不能导入 NumPy。任何人都可以帮忙吗？我使用 Python 2.7.3 作为我的系统范围的 python 并在我的 virtualenv 中。在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:07:19.260

您必须将其安装在您的虚拟环境中。最简单的方法是：

1.  源 [virtualenv]/bin/activate
2.  点安装 numpy

# vb6 - 用 vb6 连接字符串

> ID：10688602
> 
> 赞同：2
> 
> 时间：2012-05-21T16:01:32.943
> 
> 标签：vb6, textbox, concatenation

我正在尝试在 vb6 中连接。不支持运算符 += ，我想做类似下面的代码。当程序处理此代码时，我想向文本框添加更多字符串。谁能建议将 += 更改为？我知道 & 可以在将一个字符串添加到另一个字符串时使用，但它是我在这里工作的示例，这似乎不合适。

谢谢。

```
 If (strHomeNo <> "") Then
        txtPhoneNums = "Home: " + strHomeNo
    End If
    If (strMobileNo <> "") Then
        txtPhoneNums += "Mobile: " + strMobileNo
    End If
    If (strWorkNo <> "") Then
        txtPhoneNums += "Work: " + strWorkNo
    End If
    If (txtPhoneNums <> "") Then
        txtPhoneNums.ForeColor = vbBlack
        txtPhoneNums.FontBold = False
    End If
Else
     txtPhoneNums.Text = "NO CONTACT DETAILS"
     txtPhoneNums.ForeColor = vbRed
     txtPhoneNums.FontBold = True 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T16:03:27.337

将 ：

```
txtPhoneNums = txtPhoneNums & "Work: " & strWorkNo 
```

不行？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T16:03:18.553

在 VB6 中，您可以将字符串与`&`您所说的运算符连接起来。我不记得有速记`&=`（已经有一段时间了），所以你需要：

```
txtPhoneNums = txtPhoneNums & "Mobile: " & strMobileNo 
```

不要认为有更好的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T16:33:14.857

@David 和 @Brant 的答案是正确的。然而，如果你发现自己做了很多连接，那么你可以建立一个类来让事情变得更容易。类似于：txtPhoneNums.Add("Mobile:", strMobileNo)。我使用一个来构建我的 SQL 语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-19T13:37:23.440

VB6 用于`&`连接字符串

# xamarin.android - 如何在 Android 布局元素中绑定多个属性

> ID：10688603
> 
> 赞同：2
> 
> 时间：2012-05-21T16:01:44.363
> 
> 标签：xamarin.android, mvvmcross

我正在使用 MvvmCross 将我的 ViewModel 数据绑定到 Android View 布局。

从 SimpleBinding 示例中，我可以看到要将值绑定到属性，我这样做：

```
 <EditText
    android:hint="Subtotal"
    android:gravity="left"
    android:inputType="numberDecimal"
    android:maxLines="1"
    android:numeric="decimal"        
    local:MvxBind="{'Text':{'Path':'SubTotal','Converter':'Float'}}"
  /> 
```

因此 Text 绑定到 ViewModel 的 SubTotal 属性。但是如何绑定多个属性？在我的例子中，我想将一个名为 HigherLower 的 ViewModel 属性绑定到布局元素的 TextColor 属性。我无法添加另一个 MvxBind，也无法将 MvxBind 设置为数组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T18:08:33.933

The format of the JSON used in the binding expression is a Dictionary of named [MvxJsonBindingDescription](https://github.com/slodge/MvvmCross/blob/master/Cirrious/Cirrious.MvvmCross.Binding/Binders/Json/MvxJsonBindingDescription.cs)s

```
public class MvxJsonBindingDescription
{
    public string Path { get; set; }
    public string Converter { get; set; }
    public string ConverterParameter { get; set; }
    public string FallbackValue { get; set; }
    public MvxBindingMode Mode { get; set; }
} 
```

This is used with:

*   the dictionary Key name being the target (View) property for the binding.
*   the binding `Path` property being the source (DataContext) property for the binding - if `Path` is not specified then the whole DataContext itself is the binding source.

For Activity/View level axml the DataContext is the ViewModel - but for sub-View axml then the DataContext will normally be a child object of the ViewModel - e.g. inside a ListView the DataContext might be an item inside a List or ObservableCollection owned by the ViewModel.

* * *

To specify multiple bindings you can use JSON like:

```
 {
      'TargetProperty1':{'Path':'SourceProperty1'},
      'TargetProperty2':{'Path':'SourceProperty2'}
 } 
```

For your particular example this might be:

```
local:MvxBind="
       {
          'Text':{'Path':'SubTotal','Converter':'Float'}, 
          'TextColor':{'Path':'HigherLower','Converter':'MyColorConverter'}
       }" 
```

where your ViewModel is something like:

```
public class MyViewModel : IMvxViewModel
{
     public float SubTotal { get; set; }

     public bool HigherLower { get; set; }

     // more code here
} 
```

and your converter is something like:

```
public class MyColorConverter : MvxBaseColorConverter
{
    protected override MvxColor Convert(object value, object parameter, CultureInfo culture)
    {
        return ((bool)value) ? new MvxColor(255,0,0) : new MvxColor(0,255,0);
    }
} 
```

and where that converter is initialized during Setup - e.g. see how the properties of the [Converters](https://github.com/slodge/MvvmCross/blob/master/Sample%20-%20TwitterSearch/TwitterSearch.Core/Converters/Converters.cs) class are used in [TwitterSearch](https://github.com/slodge/MvvmCross/blob/master/Sample%20-%20TwitterSearch/TwitterSearch.UI.Droid/Setup.cs)

* * *

One sample that shows Multiple Bindings at work is BestSellers - see Click and Text bound in the list item [https://github.com/slodge/MvvmCross/blob/master/Sample%20-%20BestSellers/BestSellers/BestSellers.Droid/Resources/Layout/ListItem_Category.axml](https://github.com/slodge/MvvmCross/blob/master/Sample%20-%20BestSellers/BestSellers/BestSellers.Droid/Resources/Layout/ListItem_Category.axml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:22:33.153

Path':'HigherLower你必须这样做：

```
local:MvxBind="{'Text':{'Path':'SubTotal','Converter':'Float'}, 'TextColor':{'Path':'HigherLower','Converter':'Color'}}" 
```

请注意：

```
bind="{ 'Text':{xx}, 'Other':{yy} }" 
```

# mysql - 树格式的 MYSQL 输出或添加级别（父子）

> ID：10688608
> 
> 赞同：3
> 
> 时间：2012-05-21T16:01:53.013
> 
> 标签：mysql, sql, tree, format, parent-child

下面是我桌子上的东西。

## 我的表

```
++++++++++++++++++++
Parent   +  Child
++++++++++++++++++++
  C1     +    G1
  C1     +    G2
  C1     +    G3
  G3     +    D1
  G3     +    D2
  C1     +    G4
  G4     +    D3
  G4     +    D4
  C2     +    G5
  C2     +    G6
  C2     +    G7
  C2     +    G8
 ++++++++++++++++++++ 
```

什么，我想要如下使用MYSQL。

```
C1
  G1
  G2
  G3
    D1
    D2
  G4
    D3
    D4

C2
  G5
  G6
  G7
  G8 
```

请让我知道这在 MYSQL 中是否可行。输出类似于**TREE**。

## 更新 1

**如果我得到像下面这样的新表也很好，这样我就可以使用[这个例子](http://explainextended.com/2009/03/17/hierarchical-queries-in-mysql/)。**

```
++++++++++++++++++++++++++++++++++++++++
Parent   +  Child   + PLevel  + CLevel
++++++++++++++++++++++++++++++++++++++++
  C1     +    G1    +   1    +   2
  C1     +    G2    +   1    +   2
  C1     +    G3    +   1    +   2
  G3     +    D1    +   2    +   3
  G3     +    D2    +   2    +   3
  C1     +    G4    +   1    +   2
  G4     +    D3    +   2    +   3
  G4     +    D4    +   2    +   3
  C2     +    G5    +   1    +   2
  C2     +    G6    +   1    +   2
  C2     +    G7    +   1    +   2
  C2     +    G8    +   1    +   2
++++++++++++++++++++++++++++++++++++++++ 
```

**注意：**我从 1 开始级别（例如，我从 0 开始级别）。如果我得到这个级别从 0 开始的新表也可以。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T04:30:18.933

首先为计算级别创建递归函数。

```
function fn_CalcLevel(int @ID) 
As Begin
  Declare @ParentID int
  Select @ParentID = ParentID From Table1 where ID = @ID

  IF (@ParentID IS NULL) Return 1 Else Return 1+fn_CalcLevel(@ParentID)
End 
```

然后创建您的查询，如下所示

```
Select *, fn_CalcLevel(Table1.ID) as Level
From Table1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:32:31.587

MySQL 和 RDBMS 通常不擅长这种结构。您可能必须使用客户端递归来执行此操作。

如果递归仅限于三个深度，就像您的示例一样，您可以使用连接来完成，但对于更深的树来说它不是很可扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T13:50:52.390

尽管您不能使用单个查询，但可以使用存储过程...唯一的前提条件是，您需要在现有示例表中再添加 2 条记录以表示“C1”和“C2”是顶层...添加一条记录，其中“父”字段为空白，子级别为“C1”，另一个为“C2”。这将“准备”最顶层的父级。对于后续的层次关联，否则你没有顶层层次的起始“基础”。它还需要一个“主键”列（我在此脚本中将其创建为“IDMyTable”，它只是 1-x 连续的，但假设您的表上有一个自动增量列可供使用）。

我已经包含了所有输出列以显示它是如何构建的，但此例程的前提是根据预期的列输出创建一个表，但在构建时还额外保存下游的分层表示。为了确保它们在层变深时保持正确的方向，我连接了“ID”列——你会看到它在最终结果集中是如何工作的。

然后，在最终结果集中，我根据层次结构数据的深度预先填充空间。

循环将根据在前面结果集中找到的父记录添加任何记录，但前提是尚未添加 ID（防止重复）...

要查看循环顺序是如何不断附加的，您可以运行最后一个查询而不使用 order by，并查看每次迭代如何限定并添加上一个层次结构级别...

```
-- --------------------------------------------------------------------------------
-- Routine DDL
-- Note: comments before and after the routine body will not be stored by the server
-- --------------------------------------------------------------------------------
DELIMITER $$

CREATE DEFINER=`root`@`localhost` PROCEDURE `GetHierarchy2`()
BEGIN
    -- prepare a hierarchy level variable 
    set @hierlvl := 00000;

    -- prepare a variable for total rows so we know when no more rows found
    set @lastRowCount := 0;

    -- pre-drop temp table
    drop table if exists MyHierarchy;

    -- now, create it as the first level you want... 
    -- ie: a specific top level of all "no parent" entries
    -- or parameterize the function and ask for a specific "ID".
    -- add extra column as flag for next set of ID's to load into this.
    create table MyHierarchy as
    select 
            t1.IDMyTable,
            t1.Child AS Parent,
            @hierlvl as IDHierLevel,
            cast( t1.IDMyTable as char(100)) FullHierarchy
        from
            MyTable t1
        where
                t1.Parent is null
            OR t1.Parent = '';

    -- how many rows are we starting with at this tier level
    set @lastRowCount := ROW_COUNT();

    -- we need to have a "primary key", otherwise our UPDATE
    -- statement will nag about an unsafe update command
    alter table MyHierarchy add primary key (IDMyTable);

    -- NOW, keep cycling through until we get no more records
    while @lastRowCount > 0 do

        -- NOW, load in all entries found from full-set NOT already processed
        insert into MyHierarchy
            select 
                    t1.IDMyTable,
                    t1.Child as Parent,
                    h1.IDHierLevel +1 as IDHierLevel,
                    concat_ws( ',', h1.FullHierarchy, t1.IDMyTable ) as FullHierarchy
                from
                    MyTable t1
                        join MyHierarchy h1
                            on t1.Parent = h1.Parent
                    left join
                        MyHierarchy h2
                            on t1.IDMyTable = h2.IDMyTable
                where
                    h2.IDMyTable is null;

        set @lastRowCount := row_count();

        -- now, update the hierarchy level
        set @hierLevel := @hierLevel +1;

    end while;

    -- return the final set now
    select 
            *, concat( lpad( ' ', 1 + (IDHierLevel * 3 ), ' ' ), Parent ) as ShowHierarchy
        from MyHierarchy
        order by FullHierarchy;

END 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-13T15:17:50.757

如果你稍微调整一下你的表，你可以使用类似的东西：

```
 SELECT Child,CONCAT(LPAD('',Clevel,' '),Child),etc from tablename 
```

重组是您需要将根节点作为父节点为 0 的行。您可以添加自己的父/子/C 级别的排序以获得所需的序列。

我知道这是几年前的事了，但它可能会为其他人节省一些精力！

# android - 如何从apk文件中获取android应用程序名称

> ID：10688613
> 
> 赞同：5
> 
> 时间：2012-05-21T16:02:10.847
> 
> 标签：android

如何在 android 环境之外以编程方式从 apk 文件中获取 android 应用程序名称？我尝试解析 androidmanifest.xml 但它只显示包名称（有时可能不是很丰富）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-01-11T10:48:19.980

如果您使用的是 Linux，此命令将为您提供应用程序名称：

```
aapt dump badging your.apk | sed -n "s/^application-label:'\(.*\)'/\1/p" 
```

您必须先安装`aapt`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-06T12:55:59.230

也可以用 apktool 来完成。

```
#!/bin/sh
if [ -z "$1" ]; then echo ${0##*/} useage: ${0##*/} /path/to/your.apk; exit; fi
APKTOOL=$(which apktool apktool.sh | head -1); if [ -z "$APKTOOL" ]; then echo "Error: Could not locate apktool wrapper script."; exit; fi
TMPDIR="/tmp/apktool"
rm -Rf $TMPDIR
$APKTOOL d -q -f -s --force-manifest -o $TMPDIR $1
LABEL=$(cat $TMPDIR/res/values/strings.xml | grep 'string name="title"' | sed -e 's/.*">//' -e 's/<.*//')
rm -Rf $TMPDIR
echo ${LABEL} 
```

# ipad - 工具栏在自定义 UIViewController 中不可见

> ID：10688615
> 
> 赞同：4
> 
> 时间：2012-05-21T16:02:18.893
> 
> 标签：ipad, xcode4, xamarin.ios, monodevelop

我正在为 iPad 使用 monotouch 创建一个主细节应用程序。在我添加的主视图中，自定义 UIViewController。这个 UIViewController 在顶部有一个工具栏和 2 个 UITableView。我只能看到第一个 UITableView。我在底部看不到工具栏和其他 UItableView。

我不确定是否需要打开任何东西或配置任何东西来启用可见性。

我为每个表格视图和工具栏创建了出口。

如果有人能对此有所了解，我将不胜感激。

请看图片。

![在此处输入图像描述](../Images/8e196ef4d2e495ef46e4abe4c910b13f.png)

谢谢

巴兰辛尼亚

更新：我有 AppDelegate 代码如下

```
[Register ("AppDelegate")]
public partial class AppDelegate : UIApplicationDelegate
{
    // class-level declarations
    UIWindow window;
    UISplitViewController splitViewController;

    public override bool FinishedLaunching (UIApplication app, NSDictionary options)
    {
        // create a new window instance based on the screen size
        window = new UIWindow (UIScreen.MainScreen.Bounds);

        var controller = new RootViewController ();

        var navigationController = new UITabbedViewController();
        var detailViewController = new UIDetailViewTabbedBarController();
        splitViewController = new UISplitViewController ();
        splitViewController.WeakDelegate = detailViewController;
        splitViewController.ViewControllers = new UIViewController[] {
            navigationController,
            detailViewController
        };

        window.RootViewController = splitViewController;
        navigationController.DetailViewController = detailViewController;
        // make the window visible
        window.MakeKeyAndVisible ();

        return true;
    }
} 
```

我的导航控制器是具有 2 个 UIViewController 的 UITabbedView 控制器。我在其中一个 UIViewController 中添加了工具栏和 2 个表视图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T00:52:18.023

我通过调整界面生成器中的自动调整部分来让它工作，标记左，右和上红线并取消标记底部红线，然后一切看起来都很好。

我对 UITableView 做了同样的事情，我在顶部标记了红线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T09:23:09.080

对于工具栏，请尝试在您的 uiviewcontroller 上实现一次（它可以反过来（第一个为假，第二个为真）

```
public override void ViewWillAppear (bool animated) {
        base.ViewWillAppear (animated);
        this.NavigationController.SetNavigationBarHidden (true, animated);
    }

    public override void ViewWillDisappear (bool animated) {
        base.ViewWillAppear (animated);
        this.NavigationController.SetNavigationBarHidden (false, animated);
    } 
```

对于表格，2 个表格视图是否在彼此下方列出？（在viewbuilder中让第一个tableview不那么高，它会在你运行应用程序时自动适应数据量）

# javascript - Javascript：用标题替换锚点

> ID：10688623
> 
> 赞同：1
> 
> 时间：2012-05-21T16:02:54.130
> 
> 标签：javascript, anchor, title

有没有办法使用javascript将锚中的文本替换为标题文本？

```
 <a href="#" title="3pk Cotton Boxer Shorts (13 - 14 Years)">3pk Cotton Boxer Short...</a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T16:15:15.143

如果您想对所有链接执行此操作，请尝试以下操作：

```
var link = document.getElementsByTagName('a');
for(var i =0;i<link.length;i++) {
    link[i].innerHTML = link[i].title;
} 
```

**[​jsFiddle 示例](http://jsfiddle.net/j08691/GNn24/1/)**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T16:10:41.100

为什么，当然有。只需将`innerHTML`锚的属性设置为等于`title`属性即可。

不过，我很好奇：为什么你一开始就没有正确的文字？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T16:15:07.273

```
var links = document.links;

for (var i = 0; i < links.length; i++)
    links[i].innerHTML = links[i].attributes['title'].value; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T16:23:29.783

使用`textContent`属性：

```
var anchor_list = document.getElementsByTagName('a'); // or however you'd like to select the target <a>'s
for(var i = 0; i < anchor_list.length; ++i) {
    var a = anchor_list[i];
    if(typeof a.textContent != "undefined") {
        a.textContent = a.title;
    } else {
        a.innerText = a.title; // old IE support
    }
} 
```

`innerHTML`如果标题中有尖括号，可能无法按预期执行，因为它可能被解析为 HTML。

# silverlight - Silverlight：同一项目中自定义控件的样式

> ID：10688625
> 
> 赞同：1
> 
> 时间：2012-05-21T16:02:56.633
> 
> 标签：silverlight, silverlight-4.0

我有一个带有自定义控件的 Silverlight 应用程序，该控件`MyDataGrid`具有`DataGrid`一些额外的功能。

这是使用它的项目的一部分。它还需要自定义样式。我可以将样式添加到我的样式资源字典并设置`TargetType="sdk:DataGrid"`哪个有效。

但是，我的样式依赖于`MyProperty`特定于 的属性`MyDataGrid`，因此编辑器中会出现警告。更重要的是，无法在设计器中预览样式。

但是，它们在代码运行时确实有效。

我的问题是：*有没有办法将本地控件拉入资源字典，而不是创建一个单独的项目，将其编译为 .dll，然后拉入该程序集？*

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T18:45:02.357

听起来您制作了一个自定义控件，但您尚未为其定义默认样式。尝试以下操作：

1.  在您的项目中，在名为 Themes 的根级别添加一个文件夹。
2.  在 Themes 文件夹中，添加一个名为 generic.xaml 的 ResourceDictionary。
3.  将所有 MyDataGrid 样式添加到 generic.xaml。
4.  确保其中一种样式是隐式样式（在这里使用 BasedOn 是一个很好的解决方案）。
5.  在 MyDataGrid 的默认构造函数中，添加以下行`DefaultStyleKey = typeof(MyDataGrid);`

如果您想从代码访问样式的一部分（在 XAML 中定义），您应该将该 XAML 项命名为“PART_something”。设计工具了解 PART_* 语法，并且这向库使用者表明，如果您重新模板控件，则必须定义以 PART_ 为前缀的所需部分。

以下是有关如何[定义自定义控件](http://www.silverlightshow.net/items/Creating-a-Silverlight-Custom-Control-The-Basics.aspx)的基础知识。

# mysql - 支持 Memcache 的 MySQL 集群

> ID：10688627
> 
> 赞同：1
> 
> 时间：2012-05-21T16:03:01.140
> 
> 标签：mysql, caching, memcached, cluster-computing, high-availability

我一直在阅读有关 MySQL Cluster 7 的信息，并且似乎对 memcache 存储引擎有一些支持。

实现是否需要应用程序中的任何自定义代码（向 memcache 发出请求），或者它是否集成到我可以

```
select cars.* from cars WHERE cars.id = 100 
```

而 MySQL cluster + memcache 将能够“自动”首先查看 memcache 缓存，如果没有命中，请查看 MySQL？

与更新一样明智 - 我是否必须在每次修改时手动设置内存缓存中的数据，或者是否有一种机制可以为我做这件事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:14:53.200

Memcached 不会提供您描述的功能。Memcached 是键值存储，不会自动缓存任何查询结果。您需要编写代码来存储结果。一些框架使这更容易。

MySQL 的查询缓存可以缓存查询结果，但您仍然在使用 MySQL。

MySQL 的 NDB 集群是一个集群内存存储引擎，由于负载平衡和分区，它能够非常快速地提供关系数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T23:25:21.680

查看此博客以了解有关 MySQL 集群的 memcached API 的实现和功能的更多信息：http: [//www.clusterdb.com/mysql-cluster/scalabale-persistent-ha-nosql-memcache-storage-using- mysql集群/](http://www.clusterdb.com/mysql-cluster/scalabale-persistent-ha-nosql-memcache-storage-using-mysql-cluster/)

本质上，API 是作为 memcached 服务器的插件实现的，然后可以通过 memcached 命令直接与数据节点通信，而无需通过 SQL 层 - 让您可以非常快速地本地访问数据，具有完全的持久​​性和可扩展性，写入吞吐量和模式或无模式数据存储

# java - 使用 javamail api 从 gmail 服务器删除电子邮件

> ID：10688630
> 
> 赞同：-1
> 
> 时间：2012-05-21T16:03:08.933
> 
> 标签：java, jakarta-ee, jakarta-mail

```
import com.sun.mail.pop3.POP3Folder;
import com.sun.mail.pop3.POP3SSLStore;
import javax.mail.Session;
import javax.mail.Flags;
import javax.mail.Message;
import java.util.Date;
import java.text.SimpleDateFormat;
import java.util.StringTokenizer;
import javax.mail.internet.MimeMessage;
import java.io.FileOutputStream;
import java.io.File;
import java.io.ObjectOutputStream;
import java.io.Writer;
import java.net.URL;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.Store;
import javax.mail.Folder;
import java.util.Properties;
import javax.mail.URLName;

/**
 * This class is responsible for deleting e-mails.
 *
 * @author <a href="mailto:fzammetti@omnytex.com">Frank W. Zammetti</a>.
 */public class deletemail {

    private static final String SMTP_HOST_NAME = "smtp.gmail.com";
    private static final int SMTP_HOST_PORT = 465;
    private static final String SMTP_AUTH_USER = "examplemail@gmail.com";
    private static final String SMTP_AUTH_PWD  = "examplepassword";
 private Session session;
    private POP3SSLStore store;
    private String username;
    private String password;
    private POP3Folder folder;
        URLName  url;
    public static void main(String[] args) throws Exception{
       new deletemail().test();
    }

    public void test() throws Exception{
       try{
        Properties pop3props = new Properties();
        //----------------------------------------------
          String SSL_FACTORY = "javax.net.ssl.SSLSocketFactory";
        Properties pop3Props = new Properties();
        pop3Props.setProperty("mail.pop3.socketFactory.class", SSL_FACTORY);
        pop3Props.setProperty("mail.pop3.socketFactory.fallback", "false");
        pop3Props.setProperty("mail.pop3.port", "995");
        pop3Props.setProperty("mail.pop3.socketFactory.port", "995");
        username="examplemail@gmail.com";
        password="examplepassword";
        url = new URLName("pop3", "pop.gmail.com", 995, "", username, password);
        session = Session.getInstance(pop3Props, null);
        store = new POP3SSLStore(session, url);
        store.connect();
        folder = (POP3Folder) store.getFolder("INBOX");
        folder.open(Folder.READ_WRITE);
       Message message[] = folder.getMessages();
         System.out.println(message.length);
    for (int i=0, n=message.length; i<n; i++) {
         message[i].setFlag(Flags.Flag.DELETED, true);
        System.out.println("hello world");

    }
         folder.close(true);
        store.close();
   }
     catch (Exception e) {

      e.printStackTrace();

    }
 finally {
      try {
        if (folder != null) {
          folder.close(true);
        }
        if (store != null) {
          store.close();
        }
      } catch (Exception e) { }

  }
    }
} 
```

在执行此程序消息后，首先让收件箱包含 10 条消息 message.length=10。长度减少到 0，但是当我打开我的 gmail 帐户时，邮件仍然存在并且它们不会从收件箱中删除

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-12-11T19:20:08.590

问题是 GMail 没有遵循删除电子邮件的 IMAP 约定。

根据[https://javaee.github.io/javamail/FAQ#gmaildelete](https://javaee.github.io/javamail/FAQ#gmaildelete)你必须：

1.  用标志标记消息`[Gmail]/Trash`，
2.  导航到该标签并将`DELETED`该电子邮件的标志设置为 true，
3.  关闭文件夹（将删除标志设置为 true）。

假设您在数组中有电子邮件，您必须执行以下操作：

```
 Folder trashFolder = this.open("[Gmail]/Trash", true);
        for (Message m : messages) {
            m.getFolder().copyMessages(new Message[]{m}, trashFolder);
        }
        this.close(trashFolder, true);

        trashFolder = this.open("[Gmail]/Trash", true);
        for (Message m : trashFolder.getMessages()) {
            m.setFlag(Flags.Flag.DELETED, true);
        }
        this.close(trashFolder, true); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-21T17:24:21.213

这个[Gmail 帮助页面](http://support.google.com/mail/bin/answer.py?hl=en&answer=77657&topic=1668982&path=1668981-1669053&ctx=leftnav)可能解释了发生了什么。

# objective-c - 从另一个类访问 TableViewController

> ID：10688636
> 
> 赞同：0
> 
> 时间：2012-05-21T16:03:31.553
> 
> 标签：objective-c, cocoa

我是objective-c 的初学者，想实现一个简单的GUI：A`MyMainWindowController`带有相应的xib，其中包含一个表格和一个简单的`Add`按钮。

```
@interface MyMainWindowController : NSWindowController
{
}
@end 
```

控制器的实现代码几乎是空的（预定义的 initWithWindow 和 windowDidLoad）。是这样定义的`AddressTvc`：

```
@interface AddressTvc : NSObject <NSTableViewDataSource>
{
  @private
    IBOutlet NSTableView *myTableView;
    NSMutableArray *list;
}
- (IBAction)add:(id)sender;
@end 
```

这工作正常。我可以单击`Add`按钮并在表中插入一个新行。

![在此处输入图像描述](../Images/92edde62436f4cdcac28e9b7d330f349.png)

当可见时，它似乎`AddressTvc`是自动创建的（由 IB？） 。`MyMainWindowController`我想在 to 的代码中引用，`MyMainWindowController`这样`AddressTvc`我就可以用后台线程检索到的一些数据来填充表格。这应该通过调用`- (IBAction)add:(id)sender;`方法来完成。

我试图在`AddressTvc`里面创建一个，`MyMainWindowController`但随后对象被初始化了两次。我确定我必须将它连接到 IB 中的某个地方，但不知道在哪里执行此操作...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T07:36:08.630

*在您的MyMainWindowController*类中创建一个可以指向您的表视图控制器类的插座。

例如

```
@interface MyMainWindowController : NSWindowController
{
    IBOutlet AddressTvc *myTVC 
}
@end 
```

然后只需从文件所有者控制+拖动到界面生成器中的表视图控制器的实例，您现在可以在窗口控制器代码中访问它。

# java - 如何在java中删除以前的计时器？

> ID：10688643
> 
> 赞同：2
> 
> 时间：2012-05-21T16:04:04.503
> 
> 标签：java, timer

我已经实现了一个计时器来调用我的 alert() 方法。从数据库中检索计时器的持续时间。当我将持续时间设置为 1 分钟时，计时器每隔一分钟调用一次 alert()。当我再次将持续时间设置为 5 分钟时，1 分钟计时器不会停止。所以现在我有 2 个正在运行的计时器。如何删除以前的计时器？谢谢。

```
private void getDuration() 
{       
    durationTimer = new javax.swing.Timer(durationDB, new ActionListener() 
    {               
        public void actionPerformed(ActionEvent e) 
        {       
            alert();      
        }     
    });                 
    durationTimer.stop();

    try
    {   
        // Connection to the database
        Class.forName("com.mysql.jdbc.Driver");
        Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/smas","root","root");
        Statement stmt = con.createStatement();
        ResultSet rs = stmt.executeQuery("SELECT * FROM alertduration");    

        while (rs.next()) 
        {
            durationDB = rs.getInt("duration");     
        }   

        con.close();            
    }

    catch(Exception ea)
    {
        JOptionPane.showMessageDialog(watchlist, "Please ensure Internet Connectivity ", "Error!", JOptionPane.ERROR_MESSAGE);
    }           

    durationTimer = new javax.swing.Timer(durationDB, new ActionListener() 
    {               
        public void actionPerformed(ActionEvent e) 
        {       
            alert();      
        }     
    });         

    durationTimer.start(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T16:06:29.237

完成第一个计时器后调用 stop() 方法。将计时器设为全局并重用它，而不是每次持续时间更改时都创建一个新计时器，这也可能是值得的。请参阅：[http ://docs.oracle.com/javase/6/docs/api/javax/swing/Timer.html](http://docs.oracle.com/javase/6/docs/api/javax/swing/Timer.html)

例子：

```
durationTimer = new javax.swing.Timer(duration, new ActionListener() {               
    @Override
    public void actionPerformed(ActionEvent e) {       
        alert();
    }     
});                 

durationTimer.start();

//wait for duration to change
durationTimer.stop();
durationTimer.setDelay(duration);
durationTimer.start(); 
```

# php - 蛞蝓还需要吗？

> ID：10688645
> 
> 赞同：0
> 
> 时间：2012-05-21T16:04:15.517
> 
> 标签：php, html, web

我总是用***slugifizer***将实体的主要信息（例如标题、名称）转换为不包含空格、特殊字符等的 slug。

现在我不小心忘记了***slugifizer***，即使有空格它也能正常工作。

这个时候还需要蛞蝓吗？

当然除了 IE 用户...

问候

PS：我不想开始讨论这个话题。我只是想知道是否所有现代浏览器（当然还有后端）都可以处理一个**非 slugged 值**可能导致的所有问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:09:08.737

蛞蝓主要是为了 SEO 价值。

URL 不能包含空格或其他保留字符。如果您在 URL 中放置空格并且它可以工作，那是因为浏览器对您很好，而不是因为它是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:14:10.927

当您尝试复制/粘贴 URL 时，这很糟糕。例如，尝试在任何 Messenger 上向某人发送未经清理的 URL。它很可能会破坏格式，收件人无法正确单击它。此外，许多电子邮件服务提供商倾向于解析 URL 以在其上添加超链接，这可能会使电子邮件收件人收到格式错误的 URL...

# php - PHP 数组 stdClass 对象 - 回声值

> ID：10688650
> 
> 赞同：15
> 
> 时间：2012-05-21T16:04:28.963
> 
> 标签：php, arrays, stdclass

所以我将此数组保存在变量 title`$arr`中。我想获取或回显 [slug] 的值

```
Array ( [0] => stdClass Object ( [term_id] => 11 
                                 [name] => Community Service 
                                 [slug] => community-service 
                                 [term_group] => 0 
                                 [term_taxonomy_id] => 11 
                                 [taxonomy] => category 
```

所以我想要这样的东西

> 回声 $arr [蛞蝓]

然后将显示“社区服务”。我确信这很容易，但我不知道如何从数组 stdClass 中获取值并将其回显到页面上。谢谢你。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-05-21T16:07:42.263

该数组`$arr`包含 1 个项目，它是一个对象。您必须使用`->`语法来访问它的属性。

`echo $arr[0]->slug;`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-19T09:26:26.330

对不起，但你可以做一些更优雅的事情。

```
foreach ($array as $obj)
{
    // Here you can access to every object value in the way that you want
    echo $obj->term_id;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-30T05:17:10.363

尝试以下简单的代码...

```
echo $arr[0]->slug; 
```

它应该可以工作，因为您的数组仅包含一个对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-27T13:36:04.637

它应该工作 `echo $arr->{0}->slug`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-19T11:01:33.917

您可以像这样将 stdClass 对象转换为 php 数组并打印任何值。

```
$php_array = json_encode($stdClass_object);
$php_array = json_decode($php_array,true);
echo "<pre>";print_r($php_array); 
```

# c# - 动态 PropertyGrid 属性

> ID：10688656
> 
> 赞同：8
> 
> 时间：2012-05-21T16:04:56.623
> 
> 标签：c#, .net, propertygrid

因此，对于我正在进行的这个项目，我们决定使用 .NET PropertyGrid 控件。根据用户在 ListView 控件中选择的项目，propertygrid 将使用在运行时构建的对象进行填充。

因此，如果他们选择 ListView 中的第一项，例如“Base”，PropertyGrid 将显示该组件的属性，例如其尺寸。然后他们选择“顶部”，它将在 PropertyGrid 中显示颜色。无论哪种方式，列表中的每一项都是一个“组件”对象。

基本上，当一个 ListView 项目被选中时，一个循环遍历数据集以查找与该选定组件对象相关联的属性，然后被扔到显示在 propertygrid 中的 propertybag 类中。

我想弄清楚的是，由于这些组件和属性都是一个类，我如何动态确定哪些属性应该显示为下拉菜单、图像框或文本字段。

我正在使用 Visual Studios 2010 / C#.NET，对于动态属性生成，我使用的是 Tony Allowatt 在 CodeProject 上发现的显然很流行的“Property Bag”类。我唯一能想到的可能是在数据库中添加一个额外的属性列，并用它来告诉 PropertyBag 要添加什么数据类型？这似乎是一个热门话题，但我很难弄清楚如何与动态构建的对象结合使用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T22:16:18.223

它本身并不是一个答案，但我也一直在努力打造这样一个野兽。这是stackoverflow关于该主题的最大热门......

[如何在运行时修改 PropertyGrid（添加/删除属性和动态类型/枚举）](https://stackoverflow.com/questions/313822/how-to-modify-propertygrid-at-runtime-add-remove-property-and-dynamic-types-enu)

[如何在属性网格中显示动态对象？](https://stackoverflow.com/questions/3491556/how-to-display-a-dynamic-object-in-property-grid)

[PropertyGrid 和对象的动态类型](https://stackoverflow.com/questions/1884851/propertygrid-and-dynamic-types-of-objects)

起初我虽然实际上需要基于 Expando 对象的动态对象，但对我来说事实并非如此。你可能想确保你不会落入那个陷阱。

在我的情况下，我真正需要的是一个自定义对象的集合，这些对象可以添加一组可变的属性。其中每个属性都是三种自定义类型（stringType、rangeType 或 enumType）之一的实例化。一旦我意识到“动态”属性不会是任意类类型，该项目就变成了对三个 stackoverflow 示例中讨论的代码的简单改动。问题[如何在运行时修改 PropertyGrid（添加/删除属性和动态类型/枚举）](https://stackoverflow.com/questions/313822/how-to-modify-propertygrid-at-runtime-add-remove-property-and-dynamic-types-enu)几乎是我最终得到的直接示例。

希望我的杂谈能帮助你找到你的道路......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-07-03T06:37:03.553

对于 wpf，这可能会解决整个问题：链接到源[https://xceed.com/forums/topic/propertygrid-dictionary-not-displaying-values-using-icustomtypedescriptor/](https://xceed.com/forums/topic/propertygrid-dictionary-not-displaying-values-using-icustomtypedescriptor/)

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Runtime.CompilerServices;

[RefreshProperties(RefreshProperties.All)]
public class DictionaryPropertyGridAdapter<TKey, TValue> : ICustomTypeDescriptor, INotifyPropertyChanged
{
    #region Fields

    private readonly IDictionary<TKey, PropertyAttributes> propertyAttributeDictionary;

    private readonly IDictionary<TKey, TValue> propertyValueDictionary;

    #endregion

    #region Constructors and Destructors

    public DictionaryPropertyGridAdapter(
        IDictionary<TKey, TValue> propertyValueDictionary,
        IDictionary<TKey, PropertyAttributes> propertyAttributeDictionary = null)
    {
        this.propertyValueDictionary = propertyValueDictionary;
        this.propertyAttributeDictionary = propertyAttributeDictionary;
    }

    #endregion

    #region Events

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion

    public AttributeCollection GetAttributes()
    {
        return TypeDescriptor.GetAttributes(this, true);
    }

    public string GetClassName()
    {
        return TypeDescriptor.GetClassName(this, true);
    }

    public string GetComponentName()
    {
        return TypeDescriptor.GetComponentName(this, true);
    }

    public TypeConverter GetConverter()
    {
        return TypeDescriptor.GetConverter(this, true);
    }

    public EventDescriptor GetDefaultEvent()
    {
        return TypeDescriptor.GetDefaultEvent(this, true);
    }

    public PropertyDescriptor GetDefaultProperty()
    {
        return null;
    }

    public object GetEditor(Type editorBaseType)
    {
        return TypeDescriptor.GetEditor(this, editorBaseType, true);
    }

    public EventDescriptorCollection GetEvents(Attribute[] attributes)
    {
        return TypeDescriptor.GetEvents(this, attributes, true);
    }

    public PropertyDescriptorCollection GetProperties(Attribute[] attributes)
    {
        ArrayList properties = new ArrayList();
        foreach (var kvp in this.propertyValueDictionary)
        {
            properties.Add(
                new DictionaryPropertyDescriptor(
                    kvp.Key,
                    this.propertyValueDictionary,
                    this.propertyAttributeDictionary));
        }

        PropertyDescriptor[] props = (PropertyDescriptor[])properties.ToArray(typeof(PropertyDescriptor));

        return new PropertyDescriptorCollection(props);
    }

    public object GetPropertyOwner(PropertyDescriptor pd)
    {
        return this;
    }

    EventDescriptorCollection ICustomTypeDescriptor.GetEvents()
    {
        return TypeDescriptor.GetEvents(this, true);
    }

    PropertyDescriptorCollection ICustomTypeDescriptor.GetProperties()
    {
        return ((ICustomTypeDescriptor)this).GetProperties(new Attribute[0]);
    }

    //[NotifyPropertyChangedInvocator]
    protected virtual void OnPropertyChanged([CallerMemberName] string propertyName = null)
    {
        this.PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
    }

    public class PropertyAttributes
    {
        public string Category { get; set; }

        public string Description { get; set; }

        public string DisplayName { get; set; }

        public bool IsReadOnly { get; set; }
    }

    internal class DictionaryPropertyDescriptor : PropertyDescriptor
    {
        #region Fields

        private readonly IDictionary<TKey, PropertyAttributes> attributeDictionary;

        private readonly TKey key;

        private readonly IDictionary<TKey, TValue> valueDictionary;

        #endregion

        #region Constructors and Destructors

        internal DictionaryPropertyDescriptor(
            TKey key,
            IDictionary<TKey, TValue> valueDictionary,
            IDictionary<TKey, PropertyAttributes> attributeDictionary = null)
            : base(key.ToString(), null)
        {
            this.valueDictionary = valueDictionary;
            this.attributeDictionary = attributeDictionary;
            this.key = key;
        }

        #endregion

        public override string Category => this.attributeDictionary?[this.key].Category ?? base.Category;

        public override Type ComponentType => null;

        public override string Description => this.attributeDictionary?[this.key].Description ?? base.Description;

        public override string DisplayName => this.attributeDictionary?[this.key].DisplayName ?? base.DisplayName;

        public override bool IsReadOnly => this.attributeDictionary?[this.key].IsReadOnly ?? false;

        public override Type PropertyType => this.valueDictionary[this.key].GetType();

        public override bool CanResetValue(object component)
        {
            return false;
        }

        public override object GetValue(object component)
        {
            return this.valueDictionary[this.key];
        }

        public override void ResetValue(object component)
        {
        }

        public override void SetValue(object component, object value)
        {
            this.valueDictionary[this.key] = (TValue)value;
        }

        public override bool ShouldSerializeValue(object component)
        {
            return false;
        }
    }
} 
```

对于视图模型

```
class classViewModel : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;
    protected void OnPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }
    private IDictionary<string, object> Variables { get; set; } = new ConcurrentDictionary<string, object>();
    private DictionaryPropertyGridAdapter<string, object> _selectedObj;
    public DictionaryPropertyGridAdapter<string, object> SelectedObj
    {
        get
        {

            this.Variables["Bool"] = false;
            this.Variables["Int"] = 200;
            this.Variables["Float"] = 200.5;
            this.Variables["String"] = "help";
            _selectedObj = new DictionaryPropertyGridAdapter<string, object>(this.Variables);

            return _selectedObj;
        }
        set {
            _selectedObj = value;
            OnPropertyChanged(nameof(this.SelectedObj));
        }
    }
} 
```

和 xml

```
<Window x:Class="testPropertyGrid.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:testPropertyGrid"
    xmlns:wpftoolkit="http://schemas.xceed.com/wpf/xaml/toolkit"
    mc:Ignorable="d"
    Title="MainWindow" Height="350" Width="525">
<Window.Resources>
    <local:classViewModel x:Key="ViewModel"/>
</Window.Resources>
<Grid>
    <wpftoolkit:PropertyGrid Name="propertyGrid1" SelectedObject="{Binding SelectedObj ,Source={StaticResource ViewModel}}">

    </wpftoolkit:PropertyGrid>
</Grid> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-15T10:53:05.403

我相信[此链接](http://www.codeproject.com/Articles/193462/Using-PropertyGrid-to-Display-and-Edit-Dynamic-Obj)将为您提供体面的输入来解决您的问题。希望它有帮助。

**编辑以包含链接的内容：**

动态属性声明：

```
dynamic employee = new BusinessObject(); 
employee.FirstName = "John"; 
employee.LastName = "Doe"; 
```

支持动态属性的类：

```
public class BusinessObject : DynamicObject 
{
     private readonly IDictionary<string, object> dynamicProperties = 
         new Dictionary<string, object>();

     public override bool TryGetMember(GetMemberBinder binder, out object result)
     {
          var memberName = binder.Name;
          return dynamicProperties.TryGetValue(memberName, out result);
     }

     public override bool TrySetMember(SetMemberBinder binder, object value)
     {
          var memberName = binder.Name;
          dynamicProperties[memberName] = value;
          return true;
     }
} 
```

# file - TFS InvokeMethod Delete 对路径的访问被拒绝

> ID：10688660
> 
> 赞同：0
> 
> 时间：2012-05-21T16:05:16.883
> 
> 标签：file, tfs, unc

我正在尝试调用 invokemethod 来删除放置文件夹中的文件。但是，我收到拒绝访问路径的消息。在使用 invokmethod 之前，我也在做复制目录和删除目录。复制和删除目录都没有权限问题。我猜 invokemethod 使用不同的用户帐户。很感谢任何形式的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:52:16.353

当您使用该文件时，您还将收到拒绝访问错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:38:41.697

默认情况下，构建代理使用网络服务的构建服务帐户运行。您可能希望将其更改为域帐户，例如[TFSBuild](http://msdn.microsoft.com/en-us/library/ms253149.aspx)，以便您可以在需要构建工件的路径上分配写入权限。

然后确保*TFSBuild*正在运行构建服务并且是[Project Collection Build Service Accounts的成员](http://msdn.microsoft.com/en-us/library/cc668757.aspx)

![在此处输入图像描述](../Images/5d344e2e8690fe83dd12a454dff282df.png)

# batch-file - SQLPLUS BAT 文件

> ID：10688661
> 
> 赞同：1
> 
> 时间：2012-05-21T16:05:18.130
> 
> 标签：batch-file, sqlplus

我有一个在 oracle 上运行脚本的 BAT 文件：

```
sqlplus myuser/mypassword@mydatabase @C:\runthisfile.sql 
```

我想将此分发给其他用户（不一定知道如何修改 BAT 文件）。

我希望 dos 提示要求用户输入他们的用户和密码（显然我不想给他们我的连接详细信息）。尝试了所有类型的组合，但所发生的只是我最终得到`SQL>.....`.

我难住了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:39:39.643

您可以使用`SET`带有`/P`参数的命令，以便在批处理文件运行期间提示用户输入文本，例如：

```
SET /P variable=Please enter text 
```

然后，这将`variable`在返回之前填充他们键入的任何内容。

```
@ECHO OFF
SET /P uname=Username:
SET /P pass=password: 
```

这是一个简单的程序，它将首先提示输入用户名，然后是密码。然后，您应该能够将其作为参数传递给 sqlplus：

```
sqlplus %uname%/%pass%@mydatabase @C:\runthisfile.sql 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T08:25:54.823

关于 SQLPlus 停止，什么都不做：

有时 SQLPlus 以 ... 结束，意思是等待更多的东西。

尝试在 SQL 文件的末尾添加“/”（不带引号）以执行它。

我希望它会有所帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-06T07:35:38.520

这是无需手动输入用户名和密码即可打开 SQLPLUS 的非常简单的代码。

**sqlplus -L 用户名/密码**

例如：*sqlplus -L Rak4ak@sun64/rk4*

为了理解 ：

sqlplus [ [] [{登录 | /nolog}] [] ]

是： [-C ] [-L] [-M ""] [-NOLOGINTIME] [-R ] [-S]

```
-C <version>   Sets the compatibility of affected commands to the
               version specified by <version>.  The version has
               the form "x.y[.z]".  For example, -C 10.2.0
-L             Attempts to log on just once, instead of
               reprompting on error.
-M "<options>" Sets automatic HTML markup of output.  The options
               have the form:
               HTML [ON|OFF] [HEAD text] [BODY text] [TABLE text]
               [ENTMAP {ON|OFF}] [SPOOL {ON|OFF}] [PRE[FORMAT] {ON|OFF}]
-NOLOGINTIME   Don't display Last Successful Login Time.
-R <level>     Sets restricted mode to disable SQL*Plus commands
               that interact with the file system.  The level can
               be 1, 2 or 3\.  The most restrictive is -R 3 which
               disables all user commands interacting with the
               file system.
-S             Sets silent mode which suppresses the display of
               the SQL*Plus banner, prompts, and echoing of
               commands. 
```

是：{[/][@] | / } [AS {SYSDBA | 系统管理员 | 系统管理 | 系统备份 | 系统开发 | SYSKM}] [版本=值]

```
Specifies the database account username, password and connect
identifier for the database connection.  Without a connect
identifier, SQL*Plus connects to the default database.

The AS SYSDBA, AS SYSOPER, AS SYSASM, AS SYSBACKUP, AS SYSDG,
and AS SYSKM options are database administration privileges. 
```

# php - php mysql查询数组在每个数组索引中存储2个字段

> ID：10688664
> 
> 赞同：1
> 
> 时间：2012-05-21T16:05:33.613
> 
> 标签：php, mysql, arrays

当我尝试`mysql_fetch_row`创建的数组在每个索引处包含我选择的 2 个字段时。我想问一下为什么会这样？

```
<?php
  $categoryid = $_GET['id']; 
  include('connect.php');

  $query = "SELECT
           Categories_SubCategories.IdCategory,Categories_SubCategories.idSub_Category,
           Categories.Name, Sub_Categories.Name from Categories_SubCategories JOIN 
           Categories on Categories.idCategory = Categories_SubCategories.idCategory  
           JOIN Sub_Categories on Categories_SubCategories.idSub_Category =
           Sub_Categories.idSub_Category
           WHERE Categories_SubCategories.IdCategory = $categoryid";

  $result = mysql_query($query);
  $rows = mysql_num_rows($result);

  for($i=0; $i<$rows; $i++){
     $display = mysql_fetch_row($result);
     echo "$display[3]";
  }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:09:10.360

替换`mysql_num_rows`为`mysql_fetch_array`或`mysql_fetch_assoc`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:17:28.000

大多数 PHP 程序员`while()`在想要使用`mysql_fetch_array()`.

看看这个示例代码：

```
$query = mysql_query("SELECT id,name FROM tbl_members");
if (mysql_num_rows($query)) {
    while ($result = mysql_fetch_array($query)) {
        echo('User #'.$result['id'].' is: '.$result['name'].'<br />');
    }
}

// Output can be something like this:
// User #1 is: John
// User #2 is: Sarah 
```

# android - 具有嵌套列表视图滚动的线性布局

> ID：10688670
> 
> 赞同：3
> 
> 时间：2012-05-21T16:05:53.893
> 
> 标签：android, listview, android-layout, scrollview, android-linearlayout

我有一个带有嵌套列表视图的 LinearLayout，如下所示：

```
<LinearLayout ... >
    <LinearLayout>
    </LinearLayout>
    <ListView>
    </ListView>
</LinearLayout> 
```

问题是列表视图拥有滚动条（因此只有列表视图中的内容是可滚动的），但我实际上希望父 LinearLayout 拥有滚动条（因此使整个内容可滚动）。

在 ScrollView 中包装父 ListView 尚未成功，因为 ScrollView 无法识别 ListView 高度（看起来像是在运行时呈现的）

谢谢

编辑：已解决我的完美解决方案是使用**MergeAdapter**，正如 Barak 所建议的那样

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:18:40.767

您可以使用 CommonWares [MergeAdapter](https://github.com/commonsguy/cwac-merge)，它允许您定义视图和列表适配器，将它们倒入 MergeAdapter 并得到一个列表适配器，其中包含您放入的所有内容，并且它作为一个列表滚动。

我给出的关于 MergeAdapter 的先前回答是[这里](https://stackoverflow.com/a/10535980/1105376)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:16:57.027

只要列表视图中没有太多项目，您就可以将列表视图替换为表格视图。您仍然可以以与列表视图相同的方式将子视图与 tableview 一起使用，只是无法以与 listview 相同的方式对其进行数据绑定，并且项目也不会回收。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:23:47.433

由于列表视图旨在包含比可以显示更多的项目，因此高度永远不会超过屏幕尺寸（最佳情况），这是控件的意图，但我想你可以强制它更大，这通常看起来是个坏主意有很多原因。

我怀疑你应该做的是创建一个自定义列表视图适配器，并根据列表中的位置创建你想要的视图，这将允许所有项目像你想要的那样滚动。

[每行具有不同视图类型的列表视图](https://stackoverflow.com/questions/4777272/android-listview-with-different-layout-for-each-row)

这可能会也可能不会起作用，具体取决于您到底要做什么，否则您可能只想将视图添加到滚动视图中的线性视图，而不是列表视图。

它仅取决于用例（列表视图中有多少项目、内存问题等）以及其他视图的目的是什么。

# iphone - 在 GPUImage 中实现一个简单的自适应阈值

> ID：10688672
> 
> 赞同：1
> 
> 时间：2012-05-21T16:05:57.320
> 
> 标签：iphone, ios, opengl-es, opencv

我正在开发一个 iPhone 应用程序来识别图片中的一些众所周知的符号。我基本上遵循这些教程[http://aishack.in/tutorials/sudoku-grabber-with-opencv-detection/](http://aishack.in/tutorials/sudoku-grabber-with-opencv-detection/)和[http://sudokugrab.blogspot.it/2009/07/how-does-it-all- work.html](http://sudokugrab.blogspot.it/2009/07/how-does-it-all-work.html)，使用 OpenCv 进行模板匹配和 GPUImage 进行图像处理。

当所有图像都具有相同的亮度级别时，我可以调整*GPUImageLuminanceThresholdFilter*的阈值并且一切正常，但是，当然，我不能确定亮度。

所以，我需要一个简单的自适应阈值滤波器，就像那些教程中的那个，它计算每个像素周围区域的亮度。

GPUImageAdaptiveThresholdFilter不符合我的需要，因为它检测并锐化边缘，而我需要增强符号*。*

我怎样才能实现那种过滤器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T16:35:43.187

被问到，很棒的 Brad Larson 为框模糊添加了一个模糊大小属性，并修改了自适应阈值过滤器，所以它按预期工作！谢谢@BradLarson！

# php - 如何让 Zend 根据上下文自动切换视图和布局？

> ID：10688680
> 
> 赞同：0
> 
> 时间：2012-05-21T16:06:38.290
> 
> 标签：php, iphone, zend-framework, mobile

我有一个移动网站，我为 iPhone 和其他 iOS 设备添加了检测。iOS 页面需要与常规页面不同的布局和视图（实际上是针对较旧的移动设备）。所以，我有一些代码可以进行移动检测，那部分很简单。我想做的是让 Zend 在检测到 iOS 设备时自动找到并使用正确的布局和视图，但事实证明这非常困难......

我需要它尽快启动并运行，所以我做了一个快速而肮脏的黑客攻击：在每个动作函数中，我有一个简单的 If 语句来检测是否设置了 iOS 布尔标志（这发生在控制器的 init 中） ，如果是，则显式覆盖布局和视图。现有代码（在操作中）：

```
if ($_SESSION['user']['iPhone']) {
    $this->_helper->layout->setLayout('osriphone'); // 'osr' is the name of the app
    $this->_helper->viewRenderer->setRender('iphone/index');
} 
```

所以这行得通，但它有点丑陋和hacky，必须放在每个动作中，并且必须设置每个动作的渲染器等等。我开始阅读Zend ContextSwitch，这似乎正是我应该做的事情使用（我对 Zend 还是有点陌生​​），所以我开始弄乱它，但不太明白。

在控制器的初始化中，我正在初始化 ContextSwitch，为“iphone”添加上下文并将后缀设置为“iphone”，现在我想做的是有一个地方可以检测用户是否是iOS 设备并将上下文设置为“iphone”，这应该使其自动使用正确的布局和视图。新代码（在控制器的初始化中）：

```
$this->_helper->contextSwitch()->initContext();
$contextSwitch = $this->_helper->getHelper('contextSwitch');
$contextSwitch->addContext('iphone', array('suffix' => 'iphone'));
$contextSwitch->setAutoDisableLayout(false);
if ($_SESSION['user']['iPhone']) {
    //$this->_currentContext = 'iphone'; // Doesn't work.
    //$contextSwitch->initContext('iphone'); // Doesn't work.
    //$contextSwitch->setContext('iPhone'); // Not the function I'm looking for...
    // What to put here, or am I barking up the wrong tree?
} 
```

我在 contextSwitcher 上做了一些阅读，似乎有很多东西，例如将其设置为特定于每个特定操作（我不需要；这需要在我的应用程序中的每个操作上发生），并通过修改所有链接到 /osr/format/iphone 之类的东西来切换上下文（我也不需要或不想要它；它已经是一个移动站点，我希望布局/视图切换到对用户完全透明，并且只从后端处理，就像我快速而肮脏的黑客一样）。对于我的快速而肮脏的 hack，这些似乎基本上是等量的代码。所以...有人有什么建议吗？我真的希望只有一行像“$contextSwitch->setContext('iphone');” 我可以在控制器初始化中的 If 语句中使用，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T19:47:35.353

我不使用 Zend ContextSwitch 所以我真的帮不上忙，但是你可以在你的控制器中使用一些继承来在几行中设置所有布局。尽管它可能仍被归类为“黑客”，但它是一种更好的黑客

现在，每当您执行一个动作时，Zend 首先会首先触发框架内的许多其他函数，例如路由、preDispatch、动作助手等。它还会在动作之后触发一些事情，例如 PostDispatch。这可以用于您的优势。

首先创建一个名为“mainController”的控制器，让它扩展 Zend_Controller_action 并在这个控制器中创建一个名为 predispatch() 的函数。将您的普通控制器扩展到 mainController。由于我们现在有一个名为 predispatch() 的函数，Zend 会在每个控制器上自动触发它，如果你在那里进行 iPhone/iOS 检查，它将自动在每个控制器上的每个操作上执行，只要你不覆盖控制器中的方法（您可以将此方法设为最终方法以防止这种情况发生）。您可以在 maincroller 中使用大量不同的非 Zend 函数和/或帮助程序，以使代码尽可能紧凑和可重用，请参阅下面的示例代码：

```
<?php
/**
*Maincontroller
*/
class MainController extends Zend_Controller_Action
{
    /**
    * Predispatch function is called everytime an action is called
    */
    final public function preDispatch(){
        //for security reasons, make sure that no one access mainController directly
        $this->request = $this->getRequest();
        if (strtolower($this->request->controller)=='main')
            $this->_redirect('/index/index/');

        //Check for iPhone
        if ($_SESSION['user']['iPhone']) {
            $this->_helper->layout->setLayout('osriphone'); // 'osr' is the name of the app
            $this->_helper->viewRenderer->setRender('iphone/index');
        }
    }
 }

<?php
/**
*Othercontroller
*/
class OtherController extends MainController
{
    /**
    * The correct layout for IndexAction is already set by the inherited preDispatch
    */
    public function indexAction(){
        /* YOUR CODE HERE */
    }
 } 
```

为了更好地了解调度过程，请查看以下链接（两者中的图片相同）： http: [//nethands.de/download/zenddispatch_en.pdf](http://nethands.de/download/zenddispatch_en.pdf)

[http://img.docstoccdn.com/thumb/orig/22437345.png](http://img.docstoccdn.com/thumb/orig/22437345.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T07:53:28.623

好的，我想我想出了如何将其放入插件中：

插件：

```
//This is my own namespace for ZF 1.x library, use your own
class My_Controller_Plugin_Ios extends Zend_Controller_Plugin_Abstract {

    public function preDispatch(Zend_Controller_Request_Abstract $request) {
        parent::preDispatch($request);

        if ($_SESSION['user']['iPhone']) {
            $this->_helper->layout->setLayout('osriphone');
            $this->_helper->viewRenderer->setRender('iphone/index');
        }
    }
} 
```

在 application.ini 中注册插件

```
resources.frontController.plugins.ios = "My_Controller_Plugin_Ios" 
```

我想这就是它的全部。虽然您可能想查看[userAgent 插件](http://framework.zend.com/manual/en/zend.application.available-resources.html#zend.application.available-resources.useragent)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T20:03:03.397

ContextSwitch 对请求对象中的“格式”属性进行操作（默认情况下）。您需要在应用程序中的某个位置设置它

```
$requestObject->setParam('format', 'iphone'). 
```

我会将它设置在引导程序中，或者更恰当地说，一个控制器插件，但它的去向实际上取决于您的应用程序。

# javascript - 如何在 Raphael 中获取绘制的矩形元素？

> ID：10688685
> 
> 赞同：1
> 
> 时间：2012-05-21T16:07:08.490
> 
> 标签：javascript, svg, raphael

我想知道使用 Raphael.js 绘制元素的方法是什么。我尝试使用 getById 但它根本不起作用。请帮助我克服这个问题。

//当用户点击圆圈时，我正在获取圆圈 ID 并想要获取 //矩形，它也具有与圆圈相同的 ID，但具有不同的前缀。

```
function addCircleClick(obj)
{
    obj.click(function(event)
    {
        alert(paper+" getRect ID 1"+this.id);.
        var getRect; 
        try
        {
            var getRect  = paper.getById(this.id);////This below line(paper.getById(this.id)) is not working,even Circle object i am not able  to get
        }
        catch(e)
        {
            alert(e);//Issue here
        } 
        alert("getRect ID 2 "+getRect); 
        obj.attr({"stroke":"red"});  
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:14:47.313

我认为您的问题是您正在尝试使用示例中所示的纸张。希望这可以帮助你。

```
var paper = Raphael("field1", 240, 400, actions);

var attrs = {
        fill: "#FFF"    
    };

function actions() {
    var that = this;  
    var circle = that.circle(50,50,10);
    circle.attr(attrs);

    circle.click(function(event) {
        console.log(this.id); //elements id
        console.log(that.getById(this.id)); //clicked element
        console.log(paper.getById(this.id)); //doesn't work
    });
}; 
```

编辑：重新阅读您的问题，并认为我可能误解了它。无论如何，我不太确定您获得具有不同前缀的相同 ID 是什么意思。每个元素都有唯一的编号 id。

# mongodb - 简单的 mongo 文档上的复杂逻辑查询

> ID：10688686
> 
> 赞同：2
> 
> 时间：2012-05-21T16:07:08.550
> 
> 标签：mongodb, mapreduce

我正在努力在 mongo 中对非常基本的数据类型形成复杂的逻辑查询。基本上我可以拥有数百万个用户属性，所以我的基本 mongo 文档是：

```
{
   name: "Gender"
   value: "Male"
   userId : "ABC123"
}

{
   name: "M-Spike"
   value: 0.123
   userId : "ABC123"
} 
```

我想做的是搜索 findAll userId where {name : "Gender, value: "Male"} AND { name : "m-spike", value : { $gt : 0.1} }

我曾尝试使用聚合框架，但查询的复杂性是有限的，基本上我是对所有条件进行 ORing 并按 sampleId 计算结果（它复制了一个基本的 AND）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:37:35.807

我可以看到一种方法，因为 N 是您要查询的属性数（在您的示例中 N 为 2）。尝试这样的事情：

```
 db.collection.aggregate(
      [  {  $match:  {$or: [ 
                        {"name":"M-Spike","value":{$gt:.1}},
                        {"name":"Gender","value":"Male"}
                           ] 
                     } 
         },   
         {  $group: { _id:"$userId",total:{$sum:1}}  
         },
         { $project: { _id:1, 
                       matchedAttr : { $eq: ["$total",2] }   
                     } 
         }
      ]
 ) 
```

你会回来：

```
{
    "result" : [
        {
            "_id" : "XYZ123",
            "matchedAttr" : false
        },
        {
            "_id" : "ABC123",
            "matchedAttr" : true
        }
    ],
    "ok" : 1
} 
```

现在，如果您有 2 个通过 "$or" 匹配的条件，那么您将返回与这两个条件都匹配的 _id 为真。因此，对于五个条件，您的 $match: $or 数组将有五个条件对，最后一个 $project 转换将是`$eq: ["$total",5]`

该解决方案内置的假设是您不能有重复的条目（即_id 不能有“M-Spike”：.5 和“M-Spike”：.2。如果可以，那么这将不起作用。

# c# - 没有OpenGL和其他库的粒子系统

> ID：10688687
> 
> 赞同：2
> 
> 时间：2012-05-21T16:07:10.257
> 
> 标签：c#, graphics2d, particles, particle-system

我必须用 C# 在粒子系统上编写程序，并且我正在使用 Visual Studio 2010。我不能使用任何像 OpenGl 这样的库，......我只能使用 C# 中的 Graphisc 库。我试图阅读一些教程和讲座，但我仍然不知道如何实现它。

谁能帮我理解我应该如何分解我的问题？或者指导我一些有用的教程？这对我来说是新的，我有点卡住了。

**我的任务：**

> 从点发生器对一个简单的间歇泉形状的发光粒子进行编程，将粒子视为不同颜色的点，在平行投影中在黑色背景上的单个轨道上移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:19:12.897

查找，`BackgroundWorker`最好`RenderTargetBitmap`在 WPF 中执行此操作

伪代码

```
backgroundWorker()
{
    while(isRunning)
    {
        update()
        draw()
    }
 }

 update()
 {
     for each all particles
     {
         update gravity and/or relativity to other particles
     }
 }

 draw()
 {
     clear bitmap

     for each all particles
     {
         draw your particle
     }

     set it to your container
 } 
```

这是基于游戏循环

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:19:20.710

虽然不是一个完整的答案，但如果这是我的任务，我将如何解决这个问题：

1.  找到一种方法来渲染单个粒子（可能是一个点或一个球）。我建议从 WPF 开始。
2.  找到一种以编程方式“移动”该粒子的方法（即随着时间的推移在不同的地方渲染它）。
3.  创建一个`Particle`可以存储其当前状态（位置、速度、加速度）并且可以移动（即`SetPosition`... `SetVelocity`）的类
4.  创建一个`World`表示 3 维空间的类并跟踪其中的所有粒子。`World`它将了解物理定律，并负责在粒子当前状态下移动它们。
5.  创建一堆`Particle`具有相同初始起始位置但随机初始加速度向量的 s。将那些`Particle`s 添加到`World`. 从那时起，他们将`World`自动更新他们的位置。
6.  应用您在第 1 步和第 2 步中学到的知识，以`World`图形方式表示其所有内容`Particle`s。

**编辑：**第 7 步将是“循环运行第 6 步”。noHDD 提供的循环代码是一个非常好的基础框架：不断`update`的世界*状态*，然后`draw`是结果。

# groovy - 相当于 process.text 的错误？

> ID：10688688
> 
> 赞同：7
> 
> 时间：2012-05-21T16:07:14.253
> 
> 标签：groovy

您可以使用 .text[获取整个输出流：](http://groovy.codehaus.org/Process+Management)

```
def process = "ls -l".execute()
println "Found text ${process.text}" 
```

是否有一个简洁的等价物来获取错误流？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T16:10:07.807

您可以使用`waitForProcessOutput`需要两个附加项（[此处的文档](http://groovy.codehaus.org/groovy-jdk/java/lang/Process.html#waitForProcessOutput%28java.lang.Appendable,%20java.lang.Appendable%29)）

```
def process = "ls -l".execute()
def (output, error) = new StringWriter().with { o -> // For the output
  new StringWriter().with { e ->                     // For the error stream
    process.waitForProcessOutput( o, e )
    [ o, e ]*.toString()                             // Return them both
  }
}
// And print them out...
println "OUT: $output"
println "ERR: $error" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-10-26T14:35:54.163

根据 tim_yates 的回答，我在 Jenkins 上进行了尝试，发现这个问题有多个分配：[https ://issues.jenkins-ci.org/browse/JENKINS-45575](https://issues.jenkins-ci.org/browse/JENKINS-45575)

所以这很有效，而且也很简洁：

```
def process = "ls -l".execute()
def output = new StringWriter(), error = new StringWriter()
process.waitForProcessOutput(output, error)
println "exit value=${process.exitValue()}"
println "OUT: $output"
println "ERR: $error" 
```

# c# - 模态表单在辅助监视器上显示时失去控制框功能

> ID：10688701
> 
> 赞同：0
> 
> 时间：2012-05-21T16:07:49.317
> 
> 标签：c#, modal-dialog

我有与本文中描述的完全相同的问题：

[http://social.msdn.microsoft.com/Forums/en/winforms/thread/bb67bf2d-4f6b-49a1-a107-18b11520bf8e](http://social.msdn.microsoft.com/Forums/en/winforms/thread/bb67bf2d-4f6b-49a1-a107-18b11520bf8e)

谁能提供一些想法？非常感谢！

从上面的链接复制：

> *如果我使用 将表单显示为模态`ShowDialog`，它会显示在我的主监视器上，并且在那里表现良好（最大化、最小化等）。*
> 
> *如果我在第二台或第三台显示器上移动表单，然后将其最大化，则上面的整个栏停止工作：从左侧（系统菜单）到右侧（恢复或最小化或关闭），包括中间（双击栏不恢复）。*
> 
> *在某些情况下，当我越过表单栏时，鼠标光标会变为“大小”。并且左键单击和移动确实会调整表单的大小！*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-25T12:46:23.937

在我将`Form.FormBorderStyle`属性更改为`FixedSingle`or`Fixed3D`或之前，我在左侧的第二个屏幕上遇到了同样的问题`FixedDialog`。`Form_SizeChanged`可以像这样在事件处理程序中更改此属性：

```
Private Sub Form1_SizeChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.SizeChanged
        If Me.WindowState = FormWindowState.Maximized Then
            Me.FormBorderStyle = Windows.Forms.FormBorderStyle.Fixed3D
else
            Me.FormBorderStyle = Windows.Forms.FormBorderStyle.Sizable
End if 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-13T20:22:08.257

正如他们在上面链接中的 msdn 站点上观察到的那样，如果您的第二台显示器配置在主显示器的左侧，但不会在右侧配置时，就会发生这种情况。

这发生在 VS2010 和 VS2012 中，包括 C# 和 VB.NET。

1) 创建一个 Windows 窗体应用程序

2）在表单中添加一个按钮

3）对于按钮代码的按钮单击处理程序：

```
    私人无效按钮1_Click（对象发送者，EventArgs e）
    {
        表格 f = 新表格（）；
        f.ShowDialog();
    }

```

4) 运行应用程序，单击按钮。将第二个窗体拖到另一个监视器上，然后最大化。

5) 所有标题栏按钮：最小化、恢复/最大化、关闭现在都被禁用，但您可以通过右键单击上下文菜单恢复。在主显示器上最大化不会这样做。

# django - Django 重新组合游标结果

> ID：10688704
> 
> 赞同：1
> 
> 时间：2012-05-21T16:08:07.177
> 
> 标签：django, django-templates, cursor

使用 Django，我有一个相当复杂的 SQL 查询，它工作正常并返回我想要的结果，所以我不想尝试使用 Django 的模型查询符号来重现它。

我将我的结果传递给我的模板，并且能够使用以下符号显示它们：

`{% for line in myresults %}
...
{{ line.0 }}
...
{{ line.1 }}
etc.
{% endfor %}`

**有没有办法在这个结果集上使用重组标签？**

如果我尝试：

`{% regroup myresults by myresults.0 as mylist %}
{% for item in mylist %}
{{ item.grouper }}
{% for line in item.list %}
...
{{ line.0 }}
{{ line.1 }}
etc.`

我像以前一样得到所有结果（没有任何重新组合），但没有得到 item.grouper（我所看到的只是“无”作为一个组而不是我的多个组）

**这是语法问题还是我正在尝试一些不适合重组功能的东西？**

我已经以正常方式对对象列表使用了重组，但上面的内容让我很难过。

有什么建议么？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T16:21:07.187

与`{% regroup myresults by myresults.0 as mylist %}`您按列表中的第一项分组时，`myresults` 您必须按项目的某些字段分组。

下一个示例来自[这里](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs)：

```
cities = [
    {'name': 'Mumbai', 'population': '19,000,000', 'country': 'India'},
    {'name': 'Calcutta', 'population': '15,000,000', 'country': 'India'},
    {'name': 'New York', 'population': '20,000,000', 'country': 'USA'},
    {'name': 'Chicago', 'population': '7,000,000', 'country': 'USA'},
    {'name': 'Tokyo', 'population': '33,000,000', 'country': 'Japan'},
] 
```

...并且您想显示按国家/地区排序的分层列表，如下所示：

```
India
    Mumbai: 19,000,000
    Calcutta: 15,000,000
USA
    New York: 20,000,000
    Chicago: 7,000,000
Japan
    Tokyo: 33,000,000 
```

您可以使用`{% regroup %}`标签按国家/地区对城市列表进行分组。以下模板代码片段将完成此操作：

```
{% regroup cities by country as country_list %}

<ul>
{% for country in country_list %}
    <li>{{ country.grouper }}
    <ul>
        {% for item in country.list %}
          <li>{{ item.name }}: {{ item.population }}</li>
        {% endfor %}
    </ul>
    </li>
{% endfor %}
</ul> 
```

# jar - 如何在 Java Web 项目中部署 Ruby 类

> ID：10688705
> 
> 赞同：0
> 
> 时间：2012-05-21T16:08:12.843
> 
> 标签：jar, jruby, zk, warbler

我正在尝试在 JRuby 和 Java 应用程序之间创建一个混合体，以便可以一次迁移单个组件。我现在要做的非常简单，这里是 Ruby 类：require 'java'

```
java_package 'eu.netprophecy.test'

class RubyViewModel
  java_signature 'String getGreeting()'
  def getGreeting
    puts "Hello, ZK, from Ruby!"
  end
end 
```

我希望能够从 ZK 项目中使用此视图模型：

```
<?page title="Hello, Ruby!" contentType="text/html;charset=UTF-8"?>
<zk>
<window title="Hello Ruby!!" border="normal" width="200px"     apply="org.zkoss.bind.BindComposer"
    viewModel="@id('vm') @init('eu.netprophecy.test.RubyViewModel')">

<label value="@load(vm.greeting)"/>

</window>
</zk> 
```

我尝试使用 .class 创建一个 jar `marbler`，但是它将带有 java 字节码的 .class 文件放在前面有项目名称的目录中，弄乱了预期的包结构（在这种情况下，我得到 EJB/eu/netprophecy/test/RubyViewModel，这意味着我无法在 Java 代码中使用生成的 Java 类）。

有谁知道这是否可能，是否有更好的方法，或者我是否必须手动创建 jar？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T18:53:36.097

您需要从您的 ruby​​ 类生成一个 java 类，这完全有可能（即使没有预编译）`become_java!`，只需确保在呈现视图（或编译）之前执行 ruby​​ 脚本我不确定你在使用什么）。

```
class RubyViewModel
  java_signature 'String getGreeting()'
  def getGreeting
    puts "Hello, ZK, from Ruby!"
  end
end

require 'jruby/core_ext'
RubyViewModel.become_java! # returns a java.lang.Class 
```

您可以使用以下方法检查方法是否存在（java方式）：

```
RubyViewModel.java_class.getDeclaredMethods.map { |method| method.to_s } 
```

# c - 这是拦截系统调用的好方法吗？

> ID：10688707
> 
> 赞同：12
> 
> 时间：2012-05-21T16:08:23.470
> 
> 标签：c, linux, gcc, x86-64, glibc

我正在写一个工具。该工具的一部分将是它能够记录系统调用的参数。好吧，我可以`ptrace`用于此目的，但`ptrace`速度很慢。我想到的一个更快的方法是修改 glibc。但这变得越来越困难，因为 gcc 神奇地插入了自己的内置函数作为系统调用包装器，而不是使用 glibc 中定义的代码。使用`-fno-builtin`也无济于事。

所以我想出了写一个共享库的想法，它包括每个系统调用包装器，例如`mmap`然后在调用实际的系统调用包装器函数之前执行日志记录。例如`mmap`下面给出了我的样子的伪代码。

```
int mmap(...)
{
 log_parameters(...);
 call_original_mmap(...);
 ...
} 
```

然后我可以使用 LD_PRELOAD 首先加载这个库。你认为这个想法会奏效，还是我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T22:48:35.640

您在用户空间中想象的任何方法都无法与任何应用程序无缝协作。对您来说幸运的是，已经支持在内核中执行您想要执行的操作。Kprobes 和 Kretprobes 允许您检查机器在系统调用之前和之后的状态。

此处的文档： [https ://www.kernel.org/doc/Documentation/kprobes.txt](https://www.kernel.org/doc/Documentation/kprobes.txt)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T02:32:09.353

正如其他人所提到的，如果二进制文件是静态链接的，则动态链接器将跳过任何使用 libdl 拦截函数的尝试。相反，您应该考虑自己启动该过程，并绕道您希望拦截的函数的入口点。

这意味着你自己启动进程，拦截它的执行，并重写它的内存，在内存中函数定义的开头放置一个跳转指令到你控制的新函数。

如果你想拦截实际的系统调用并且不能使用`ptrace`，你要么必须找到每个系统调用的执行站点并重写它，要么你可能需要覆盖内存中的系统调用表并过滤掉除你想控制的过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T20:26:12.760

来自用户空间的所有系统调用都通过一个中断处理程序切换到内核模式，如果你找到这个处理程序，你可能可以在那里添加一些东西。

**编辑**我发现这个[http://cateee.net/lkddb/web-lkddb/AUDITSYSCALL.html](http://cateee.net/lkddb/web-lkddb/AUDITSYSCALL.html)。Linux 内核：2.6.6–2.6.39、3.0–3.4 支持系统调用审计。这是一个必须启用的内核模块。如果不让人感到困惑，也许你可以查看这个模块的源代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T17:46:48.473

如果您正在开发的代码与流程相关，有时您可以在不破坏现有代码的情况下开发替代实现。如果您正在重写一个重要的系统调用并且想要一个功能齐全的系统来调试它，这将很有帮助。

对于您的情况，您正在重写 mmap() 算法以利用令人兴奋的新功能（或使用新功能进行增强）。除非您在第一次尝试时一切都正确，否则调试系统并不容易：无功能的 mmap() 系统调用肯定会导致系统无功能。一如既往，有希望。

通常，保留剩余的算法并在旁边构建替代算法是安全的。您可以通过使用用户 ID (UID) 作为决定使用哪种算法的条件来实现这一点：

```
if (current->uid != 7777) {
/* old algorithm .. */
} else {
/* new algorithm .. */
} 
```

除了 UID 7777 之外的所有用户都将使用旧算法。您可以使用 UID 7777 创建一个特殊用户来测试新算法。这使得测试与流程相关的关键代码变得更加容易。

# regex - 我想要一个只匹配带有一个句点的域名的正则表达式

> ID：10688708
> 
> 赞同：0
> 
> 时间：2012-05-21T16:08:25.990
> 
> 标签：regex, url

我希望它捕捉到类似的东西`somedomain.com/folder/path`，但不是类似的东西`domain.sub.other.com`。到目前为止，我的正则表达式几乎是完整的，它只是没有筛选出多域 url：

```
^(.*)://(?!(.{2,3})\.(.*)(.{2,3})(.*) 
```

有什么办法可以筛选出多个时期？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:10:53.197

而不是`.{2,3}`，你想要这样的东西：`[^.]{2,3}`- 这从特定匹配中排除句点（无需转义，因为它在正则表达式的上下文中没有特殊含义）。总的来说，你会有类似的东西：

```
://[^.]+\.[^.]{2,3}(/.*)? 
```

除非很明显，您这样做会丢失 *.info 之类的东西....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:05:23.827

找到了一个适用于各种测试场景的解决方案：

```
^(.*)://([^.]+)\.([^(\?|/|\r|\n|\.)]+)((/|\?|$)+)(.*)$ 
```

在这里，第二组到最后一组与潜在的正斜杠、问号或字符串结尾匹配，与它之前的组一起工作，不允许包含“。”的匹配项。

所以最终的效果是它只匹配具有两部分域的 URL，例如“domain.com”，并且对字符串长度没有任何限制。

# jquery - preventDefault 仍然滚动到页面顶部

> ID：10688712
> 
> 赞同：0
> 
> 时间：2012-05-21T16:08:35.917
> 
> 标签：jquery, preventdefault

我有以下代码，当您单击链接时，除了触发和警报之外，它应该可以阻止任何事情发生。链接目标已取消，但单击链接可滚动至页面顶部。我怎样才能阻止这种行为？谢谢

```
$('a#target').click(function(event){
    event.preventDefault();
    alert('End of demo');
}); 
```

更新我的链接如下所示：

```
<a href="#">Submit</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:12:37.353

不，preventDefault 不应该停止任何事情，它应该完全按照它所说的去做 - 阻止默认操作。即，如果您单击带有href 的链接，它将阻止浏览器的默认操作，即转到该链接。

如果要停止附加到该链接的所有其他事件，则必须在事件处理程序结束时返回 false 并确保该事件处理程序在任何其他事件之前执行。

**更新：**

感谢您发布链接和 href 值。我敢打赌，发生的事情是 JavaScript 在点击处理程序被触发之前遇到了错误。正如对此答案的第一条评论正确表明的那样 - preventDefault 也应该防止链接跳转到页面内的锚点。如果不是，那么做它的工作，那么它可能是因为在页面的其他地方有一个 JavaScript 错误。

说了这么多，你确定你发布了正确的 HTML 吗？

```
$('a#target').click(... 
```

将点击处理程序附加到如下所示的链接：

```
<a href="#" id="target">Submit</a> 
```

最后一个想法——如果一个锚元素只通过 JavaScript 附加了动作，那么为什么要指定选项 href 属性呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-13T17:17:01.847

它可以通过简单的设置来修复 `href='#!'`

因为不会有 id='!' 的元素 它不会跳到任何地方。

# input - 控制器选择

> ID：10688715
> 
> 赞同：0
> 
> 时间：2012-05-21T16:08:42.747
> 
> 标签：input, xna

在我的标题屏幕中，我有一个代码说第一个使用 A 的控制器是 PlayerIndex.one。这是代码：

```
 public override void HandleInput(InputState input)
    {
        for (int anyPlayer = 0; anyPlayer <4; anyPlayer++)
        {
            if (GamePad.GetState((PlayerIndex)anyPlayer).Buttons.A == ButtonState.Pressed)
            {
                FirstPlayer = (PlayerIndex)anyPlayer;

                this.ExitScreen();
                AddScreen(new Background());
            }
        }
    } 
```

我的问题是：如何在其他课程中使用“FirstPlayer”？（没有这个，对这段代码没有兴趣）我尝试了 Get Set 的东西，但我无法让它工作。我需要把我的代码放在另一个班级吗？你用其他代码来做这个吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:24:06.107

您可以创建一个静态变量：SelectedPlayer，然后将第一个玩家分配给它！

然后你可以通过这个类调用第一个玩家，

例如

```
class GameManager
{
   public static PlayerIndex SelectedPlayer{get;set;}
      ..
      ..
       ..
} 
```

在你的代码循环之后，你可以说：

```
GameManager.SelectedPlayer = FirstPlayer; 
```

我希望这会有所帮助，如果您的代码更清晰，那将更容易帮助:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T09:56:31.917

好的，所以要正确地做到这一点，你将不得不重新设计一点。

首先，您应该检查**新**的游戏手柄输入（即，您应该仅在新按下“A”时才退出屏幕）。为此，您应该存储以前和当前的游戏手柄状态：

```
 private GamePadState currentGamePadState;
    private GamePadState lastGamePadState;

    // in your constructor
    currentGamePadState = new GamePadState();
    lastGamePadState = new GamePadState();

    // in your update
    lastGamePadState = currentGamePadState;
    currentGamePadState = GamePad.GetState(PlayerIndex.One); 
```

真正需要做的是修改处理输入的类。HandleInput 函数的基本功能应该移到输入类中。输入应该有一组函数来测试新的/当前的输入。例如，对于您发布的案例：

```
 public Bool IsNewButtonPress(Buttons buton)
    {
        return (currentGamePadState.IsButtonDown(button) && lastGamePadState.IsButtonUp(button));
    } 
```

然后你可以写：

```
 public override void HandleInput(InputState input)
    {
        if (input.IsNewButtonPress(Buttons.A)
        {
            this.ExitScreen();
            AddScreen(new Background());
        }
    } 
```

**注意：这仅适用于一个控制器。要扩展实现，您需要执行以下操作：**

```
 private GamePadState[] currentGamePadStates;
    private GamePadState[] lastGamePadStates;

    // in your constructor
    currentGamePadStates = new GamePadState[4];
    currentGamePadStates[0] = new GamePadState(PlayerIndex.One);
    currentGamePadStates[1] = new GamePadController(PlayerIndex.Two);
    // etc.
    lastGamePadStates[0] = new GamePadState(PlayerIndex.One);
    // etc.

    // in your update
    foreach (GamePadState s in currentGamePadStates)
    {
        // update all of this as before...
    }
    // etc. 
```

现在，您想要测试每个控制器的输入，因此您需要通过编写一个函数来概括，该函数在检查数组中的每个 GamePadState 是否按下按钮后返回一个 Bool。

Check out the [MSDN Game State Management Sample](http://create.msdn.com/en-US/education/catalog/sample/game_state_management) for a well developed implementation. I can't remember if it supports multiple controllers, but the structure is clear and can easily be adapted if not.

# mysql - 使用 Hive 中另一个表中的数据填充外部表

> ID：10688720
> 
> 赞同：0
> 
> 时间：2012-05-21T16:09:27.340
> 
> 标签：mysql, hive

我有一张包含大量数据的表格。调用此表 A。我想创建一个外部表（例如表 B），其中包含来自表 A 的某些列的数据。我尝试使用“创建表为”（CTAS），但收到 CTAS 不适用于外部表的错误. 我怎么能做这个简单的工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T15:55:57.567

您可以通过简单地将表 A 中的所有内容插入到表 B 中来执行此操作，选择要复制的列。假设您已经有了表 A，它应该看起来像这样：

```
CREATE EXTERNAL TABLE table_b
(column_one type, column_three type)
LOCATION 'location_you_need_to_give';

INSERT OVERWRITE TABLE table_b
SELECT (column_one, column_three) FROM table_a; 
```

其中 column_one 和 column_three 是 table_a 中要复制的列，而 location_you_need_to_give 是外部位置（HDFS 路径，或者如果您使用 amazon elastic map reduce，则为 S3 路径），您希望 table_b 存储数据。

# iphone - 如何使用具有不同节点的 NSXMLParser 解析 XML？

> ID：10688724
> 
> 赞同：0
> 
> 时间：2012-05-21T16:09:35.540
> 
> 标签：iphone, objective-c, xml-parsing

我知道它可能看起来像 XML Parsing 帖子的副本，但我真的无法理解节点和委托方法如何表现。我有一个 XML ..

```
<?xml version="1.0" encoding="UTF-8"?>
<ParticipantService>
    <Response>
        <CourseProperties>
            <CourseTitle>AICC_Flash_Workshop_PPT_to_web_examples</CourseTitle>
            <CourseCode>123456</CourseCode>
            <Availability>Open</Availability>
            <Status>In Progress</Status>
            <ImageLink>HTTP://lmsstaging.2xprime.com/images/inprogress_icon.png</ImageLink>
            <CategoryCode>0</CategoryCode>
            <CategoryDesc>General</CategoryDesc>
        </CourseProperties>
        <CourseProperties>
            <CourseTitle>Behaviours</CourseTitle>
            <CourseCode>OBIUS</CourseCode>
            <Availability>Open</Availability>
            <Status>In Progress</Status>
            <ImageLink>HTTP://lmsstaging.2xprime.com/images/inprogress_icon.png</ImageLink>
            <CategoryCode>0</CategoryCode>
            <CategoryDesc>General</CategoryDesc>
        </CourseProperties>
        <CourseProperties>
            <CourseTitle>Customer Service Skills (Part - one)</CourseTitle>
            <CourseCode>css_1</CourseCode>
            <Availability>Open</Availability>
            <Status>In Progress</Status>
            <ImageLink>HTTP://lmsstaging.2xprime.com/images/inprogress_icon.png</ImageLink>
            <CategoryCode>0</CategoryCode>
            <CategoryDesc>General</CategoryDesc>
        </CourseProperties> 
```

……

我的要求是将相关课程详细信息存储到相应的数组中。所以我声明了六个 nsmutablearray，但对如何从 XMl 中检索数据感到困惑。我正在尝试这种方式

在foundCharacters 方法中，我将字符串的值附加为

```
videoUrlLink = [NSMutableString stringWithString:string]; 
```

在 didEndElement 方法中

```
if ([elementName isEqualToString:@"CourseTitle"]) {
        [courseDetailList addObject:string];

    } 
```

但在 XMl 结束时，我只能在数组中存储一个值。如果我在某个地方出错了，请告诉我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:29:42.790

我假设您有一个名为 的类`Course`，并且一个`Course`对象具有`title`、`code`等的属性`availability`。

制作一个 iVar `currentCourse`。

然后，在您的`parser:didStartElement:namespaceURI:qualifiedName:attributes:`（注意：确实**开始**，而不是结束！）方法中：

```
if ([elementName isEqualToString:@"CourseProperties"]) {
    //create a new course object
    currentCourse = [[Course alloc] init];
} 
```

这为后续课程的所有属性提供了上下文。在该`didEndElement:`方法中，您基本上对所有课程属性执行此操作：

```
if ([elementName isEqualToString:@"CourseTitle"]) {
    [currentCourse setTitle:string];
} 
```

最后但并非最不重要的一点是，一旦`CourseProperties`找到结束标签，将新课程保存在某处（也在`didEndElement:`）：

```
if ([elementName isEqualToString:@"CourseProperties"]) {
    //create a new course object
    [allMyCourses addObject:currentCourse];
    currentCourse = nil;
} 
```

# c# - 保持 C# 应用程序运行

> ID：10688727
> 
> 赞同：0
> 
> 时间：2012-05-21T16:09:40.443
> 
> 标签：c#, asp.net, windows-services, filesystemwatcher

我正在构建一个使用 FileSystemWatcher 并在后台运行的 Windows 服务。

我不想每次要调试时都继续卸载和安装服务，所以想在将其移入服务之前在普通程序中进行大部分开发。但我对此很陌生，当我运行它时，它只是穿过块并退出。

什么是保持程序运行的好方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T16:13:50.100

[http://einaregilsson.com/run-windows-service-as-a-console-program/](http://einaregilsson.com/run-windows-service-as-a-console-program/)

我之前使用它来调试我的服务作为控制台应用程序，基于它是否在交互式用户环境中运行。

```
public partial class DemoService : ServiceBase
{
    static void Main(string[] args)
    {
        DemoService service = new DemoService();

        if (Environment.UserInteractive)
        {
            service.OnStart(args);
            Console.WriteLine("Press any key to stop program");
            Console.Read();
            service.OnStop();
        }
        else
        {
            ServiceBase.Run(service);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:13:14.600

```
while (true)
{
  // Execute your program's functionality here.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:54:30.597

不久前我写了一个由 7 部分组成的系列文章，标题为：[构建 Windows 服务](http://csharptest.net/837/building-a-windows-service-part-1-getting-started/)。它涵盖了构建服务的所有复杂性，使其易于调试和自行安装。

我正在寻找的基本功能集如下：

*   构建一个也可以从控制台使用的服务
*   服务启动/关闭和其他活动的正确事件记录
*   使用命令行参数允许多个实例
*   自行安装服务和事件日志
*   服务异常和错误的正确事件记录
*   控制启动、关闭和重启选项
*   处理自定义服务命令、电源和会话事件
*   自定义服务安全和访问控制

最终结果是一个 Visual Studio 项目模板，它通过一个步骤创建了一个工作服务，并完成了上述所有操作。这对我来说是一个很好的节省时间。

请参阅[构建 Windows 服务 - 第 7 部分：最后润色](http://csharptest.net/990/building-a-windows-service-part-7-finishing-touches/)以获取项目模板和安装说明的链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T17:38:47.270

这是来自 MSDN @ [http://msdn.microsoft.com/en-us/library/7a50syb3(v=vs.80).aspx?ppud=4](http://msdn.microsoft.com/en-us/library/7a50syb3(v=vs.80).aspx?ppud=4)的文档。我之前尝试过它，它可以在 .NET Framework 3.x 下运行。目前，我找不到关于它的描述性注释。

使用编译指示 #If DEBUG 进行调试，例如控制台输出。另一个是使用 Debug 对象。

如果您对此有任何疑问，请说出来。我也许能够找到我的笔记或自己制作一个 Windows 服务应用程序，只是为了看看 MSDN 上的步骤是否仍然有效。

# php - zip文件的校验和

> ID：10688729
> 
> 赞同：8
> 
> 时间：2012-05-21T16:09:51.753
> 
> 标签：php, zip, checksum

我目前正在开发一个上传一组文件的工具，然后使用 md5 校验和将文件与上传的最后一批文件进行比较，并告诉您哪些文件已更改。

对于常规文件，这工作正常，但一些上传的文件是 zip 档案，几乎总是发生变化，即使其中的文件是相同的。

有没有办法执行不同类型的校验和来检查这些文件是否已更改，而无需单独解压缩每个文件，然后单独比较每个文件的内容。

这是我当前的功能

```
function check_if_changed($date, $folder, $filename)
{
  $dh = opendir('./wp-content/uploads/Base/');
  while (($file = readdir($dh)) !== false) {
    $folders[] = $file;
  }
  sort($folders);
  $position = array_search($date, $folders);
  $prev_folder = $folders[$position - 1];
  if ($prev_folder == '.' || $prev_folder == '..')
    { return true;}
  $newhash = md5_file('./wp-content/uploads/Base/'.$date.'/'.$folder.'/'.$filename);
  $oldhash = md5_file('./wp-content/uploads/Base/'.$prev_folder.'/'.$folder.'/'.$filename);
  if ($oldhash != $newhash){
    return true;
  }
  return false;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T17:06:33.853

在 zip 存档中，每个“文件”都存储有元数据，如上次修改时间、文件名、文件大小（以字节为单位）等......以及重要的部分 - *crc32 校验和*。

基本上，您可以以二进制方式对 zip 存档进行操作，找到每个文件的元数据头并将校验和与先前存储的校验和进行比较。您无需进行任何解压缩即可访问 zip 存档中的元数据。这将非常快。

[http://en.wikipedia.org/wiki/Zip_(file_format)](http://en.wikipedia.org/wiki/Zip_%28file_format%29)

**编辑**- 实际上，ZipArchive 提供了这个功能。见： [http ://www.php.net/manual/en/ziparchive.statindex.php](http://www.php.net/manual/en/ziparchive.statindex.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:11:56.357

您可以仅提取 ZIP 文件的文件部分，然后对它们进行哈希处理，但是您也必须删除元信息！

所以提取文件确实是最简单的解决方案。

# javascript - 使用动态名称初始化对象 - coffeescript/node.js/javaScript

> ID：10688732
> 
> 赞同：0
> 
> 时间：2012-05-21T16:10:15.870
> 
> 标签：javascript, node.js, coffeescript

我正在尝试构建一个我事先不知道插件的插件系统。使用 browserify 中的 'require' 初始化对象。如下：

```
class.coffee:

   class MyClass
    name: "my-class"
    constructor: ->

    @getName: ->
        return @name

  exports.plugin = new MyClass 
```

然后从我的调用文件中：

```
pluginName = # from a config file
{ plugin } = require './#{pluginName}.coffee'
console.log plugin
console.log plugin.getName() 
```

第一个记录器调用给了我：

```
MyClass{ name="my-class" } 
```

第二个失败了，但是 plugin.getName 不是一个函数。

任何帮助/指导表示赞赏。我不是 JS 开发人员，也是 coffeescript/node.js 的新手。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:35:16.683

你不应该有`@`before `getName`。

在 JS 中拥有`@`相当于 this

```
MyClass.getName = function(){
  return this.name;
}; 
```

但在这种情况下，`getName`是类本身的函数，而不是 MyClass 实例。

没有`@`, 像这样，`getName: ->`JS 是这样的：

```
MyClass.prototype.getName = function(){
  return this.name;
} 
```

# asp.net-mvc - 当 DataAnnotation 遇到 EF T4 POCO 会发生什么？

> ID：10688733
> 
> 赞同：1
> 
> 时间：2012-05-21T16:10:17.470
> 
> 标签：asp.net-mvc, entity-framework, poco, t4

我想要一些使用 EF T4 POCO 生成器生成的模型的建议，并像 MVC 项目中的 /Models 中的普通模型一样利用其中的验证属性。

背景：我们正在尝试设计一个 web 应用程序，2 或 3 名开发人员将致力于它。它采用 Scrum 风格，在构建 Web 应用程序时，我们会定期从客户那里获得需求修改。表、列和关系可能会相应改变。

我们的方法：我们希望使用 EF T4 POCO Generation，因为每次在数据库中添加新表和列时，EF T4 都会自动更新 POCO 模型。我们希望将这些 POCO 模型用作 MVC 项目的模型层（在不同的 Models.dll 中并将其包含到项目中，而不是坐在 MVC 项目的 /Models/ 文件夹中）。

问题：我们想为模型类和属性添加属性。但是，EF T4 将覆盖模型类，我们不能（也不认为我们应该）将这些属性添加到这些模型中。我们不知道什么是正确的方法。

我只能想到在 MVC 项目的包装 ViewModels 中制作属性。它们包含 EF T4 完成的 Models.dll 中的所有必要模型。然后把属性放在前面。但在我看来，击败 DRY 原则很丑陋。你会怎么做？提前感谢您的想法！

--- 编辑 --- 我确实在这里找到了一个很酷的技巧[来](https://stackoverflow.com/questions/5128303/how-to-add-validation-to-my-pocotemplate-classes)帮助我的包装想法。但是，我没有提及它，因为我想开放地查看不同的建议并进行比较:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:00:13.047

使用伙伴课程。您的 EF 类作为部分生成。创建另一个部分类并使用`MetadataType`属性对其进行注释。

```
[MetadataType(typeof(FriendMeta))]
public partial class Friend
{
} 
```

然后可以在buddy类的同名属性中添加数据注解属性。

```
public class FriendMeta
{
    [DisplayName("First Name")]
    public string FirstName { get; set; }

    [DisplayName("Last Name")]
    public string LastName { get; set; }

    [DisplayName("Date of Birth")]
    public DateTime BrithDate { get; set; }
} 
```

ASP.NET MVC 元数据提供程序将为您选择这些属性。

# android - 使用 asmack 向 gtalk 发送多条聊天消息；乱序

> ID：10688734
> 
> 赞同：2
> 
> 时间：2012-05-21T16:10:21.973
> 
> 标签：android, xmpp, smack, google-talk, asmack

我对 asmack（从[https://github.com/Flowdalic/asmack](https://github.com/Flowdalic/asmack)获得）和谷歌服务感到厌烦。我尝试使用服务**“gmail.com”**向我的 gtalk 发送多个数据包（以聊天消息的形式） ，但我收到的消息**乱序**..

下面是连续发送 15 个数据包（“聊天消息”）的代码

```
 String to = "testing@gmail.com"  // eg: gtalk ID

   for(int i =1;i<15;i++){
         Message msg = new Message(to, Message.Type.chat); 
         msg.setBody(i+"");
         connection.sendPacket(msg);
      } 
```

这是我在运行两次时进入 gtalk 的原因。

[![乱序聊天消息](../Images/5ca7a9958aeb7f9249f6cf75de0f0206.png)](https://i.stack.imgur.com/UuahV.png) 我做错了什么..有人可以帮我吗？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T01:07:43.280

来自[RFC-6120](https://www.rfc-editor.org/rfc/rfc6120#section-10.1)：

> XMPP 服务器必须确保按顺序处理从连接的客户端或远程服务器通过给定输入流接收的节和其他 XML 元素。

（阅读规范了解更多细节）

但是，这并不意味着您的服务器或客户端都已正确实现。首先假设服务器是正确的，然后在 asmack 中查找排队问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-04T08:24:48.100

与其将您的消息作为数据包发送，不如使用 Chat 类将它们作为聊天消息发送：

```
Chat chat = connection.getChatManager().createChat(String userJID, MessageListener listener);
chat.sendMessage(string); 
```

不要每次都创建一个新的聊天（也许这是你的代码的错误，你在每次迭代中继续创建一个新的 Message 对象），将第一个语句保留在你的 for 循环之外

# android - phonegap：上传不带标题信息的图片

> ID：10688736
> 
> 赞同：0
> 
> 时间：2012-05-21T16:10:34.977
> 
> 标签：android, file, cordova, upload, header

我正在使用以下代码从 android avd 上传图片。

```
 var options = new FileUploadOptions();
        options.fileKey="file";
        options.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1);
        options.mimeType="text/plain";
        var filename = imageURI.substr(imageURI.lastIndexOf('/')+1);
        var upload_url="http://example.com";
        alert(upload_url);
        alert(filename);

        var params = new Object();
        params.value1 = "test";
        params.value2 = "param";

        options.params = params;
        options.chunkedMode = false;
        options=null;

        var ft = new FileTransfer();
        ft.upload(imageURI, upload_url, picUploadSuccess, picUploadFailed,options); 
```

但是此代码在文件中添加了一些额外的标头信息。像下面 -- ***** Content-Disposition: form-data; 名称=“值1”；

测试 -- ***** 内容配置：表单数据；名称=“值2”；

参数 -- ***** 内容处置：表单数据；名称=“文件”；filename="1.jpg" 内容类型：image/jpeg

因此，当文件存储到服务器中时，它不能作为 JPEG 图像打开。我发现选项对象负责添加那些额外的标头信息。我通过分配 null 尝试不使用选项对象。但文件中仍然没有额外的信息。

期待上传文件的建议，文件中没有任何额外信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:26:37.207

尝试

```
options.mimeType="text/jpeg"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:43:43.753

好吧，如果您取出这些行：

```
var params = new Object();
params.value1 = "test";
params.value2 = "param";
options.params = params; 
```

你不会看到：

```
--* Content-Disposition: form-data; name="value1"; test 
--* Content-Disposition: form-data; name="value2"; param 
```

了。但是，您仍然会看到：

```
--* Content-Disposition: form-data; name="file"; filename="1.jpg" Content-Type: image/jpeg 
```

因为 Web 服务器需要知道如何处理传入的文件。我相信问题出在网络服务器端，即接收文件的脚本。

# java - 使用斯坦福 CoreNLP 解决共指 - 无法加载解析器模型

> ID：10688739
> 
> 赞同：9
> 
> 时间：2012-05-21T16:10:59.937
> 
> 标签：java, nlp, stanford-nlp

我想做一个非常简单的工作：给定一个包含代词的字符串，我想解析它们。

例如，我想将句子“玛丽有一只小羊羔。她很可爱”。在“玛丽有一只小羊羔。玛丽很可爱。”。

我曾尝试使用斯坦福 CoreNLP。但是，我似乎无法启动解析器。我已经使用 Eclipse 在我的项目中导入了所有包含的 jar，并且我已经为 JVM (-Xmx3g) 分配了 3GB。

错误非常尴尬：

> 线程“主”java.lang.NoSuchMethodError 中的异常：edu.stanford.nlp.parser.lexparser.LexicalizedParser.loadModel(Ljava/lang/String;[Ljava/lang/String;)Ledu/stanford/nlp/parser/lexparser/词法解析器；

我不明白那个 L 来自哪里，我认为这是我问题的根源......这很奇怪。我试图进入源文件，但那里没有错误的参考。

代码：

```
import edu.stanford.nlp.semgraph.SemanticGraphCoreAnnotations.CollapsedCCProcessedDependenciesAnnotation;
import edu.stanford.nlp.dcoref.CorefCoreAnnotations.CorefChainAnnotation;
import edu.stanford.nlp.dcoref.CorefCoreAnnotations.CorefGraphAnnotation;
import edu.stanford.nlp.ling.CoreAnnotations.NamedEntityTagAnnotation;
import edu.stanford.nlp.ling.CoreAnnotations.PartOfSpeechAnnotation;
import edu.stanford.nlp.ling.CoreAnnotations.SentencesAnnotation;
import edu.stanford.nlp.ling.CoreAnnotations.TextAnnotation;
import edu.stanford.nlp.ling.CoreAnnotations.TokensAnnotation;
import edu.stanford.nlp.trees.TreeCoreAnnotations.TreeAnnotation;
import edu.stanford.nlp.ling.CoreLabel;
import edu.stanford.nlp.dcoref.CorefChain;
import edu.stanford.nlp.pipeline.*;
import edu.stanford.nlp.trees.Tree;
import edu.stanford.nlp.semgraph.SemanticGraph;
import edu.stanford.nlp.util.CoreMap;
import edu.stanford.nlp.util.IntTuple;
import edu.stanford.nlp.util.Pair;
import edu.stanford.nlp.util.Timing;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import java.util.Properties;

public class Coref {

/**
 * @param args the command line arguments
 */
public static void main(String[] args) throws IOException, ClassNotFoundException {
    // creates a StanfordCoreNLP object, with POS tagging, lemmatization, NER, parsing, and coreference resolution 
    Properties props = new Properties();
    props.put("annotators", "tokenize, ssplit, pos, lemma, ner, parse, dcoref");
    StanfordCoreNLP pipeline = new StanfordCoreNLP(props);

    // read some text in the text variable
    String text = "Mary has a little lamb. She is very cute."; // Add your text here!

    // create an empty Annotation just with the given text
    Annotation document = new Annotation(text);

    // run all Annotators on this text
    pipeline.annotate(document);

    // these are all the sentences in this document
    // a CoreMap is essentially a Map that uses class objects as keys and has values with custom types
    List<CoreMap> sentences = document.get(SentencesAnnotation.class);

    for(CoreMap sentence: sentences) {
      // traversing the words in the current sentence
      // a CoreLabel is a CoreMap with additional token-specific methods
      for (CoreLabel token: sentence.get(TokensAnnotation.class)) {
        // this is the text of the token
        String word = token.get(TextAnnotation.class);
        // this is the POS tag of the token
        String pos = token.get(PartOfSpeechAnnotation.class);
        // this is the NER label of the token
        String ne = token.get(NamedEntityTagAnnotation.class);       
      }

      // this is the parse tree of the current sentence
      Tree tree = sentence.get(TreeAnnotation.class);
      System.out.println(tree);

      // this is the Stanford dependency graph of the current sentence
      SemanticGraph dependencies = sentence.get(CollapsedCCProcessedDependenciesAnnotation.class);
    }

    // This is the coreference link graph
    // Each chain stores a set of mentions that link to each other,
    // along with a method for getting the most representative mention
    // Both sentence and token offsets start at 1!
    Map<Integer, CorefChain> graph = 
      document.get(CorefChainAnnotation.class);
    System.out.println(graph);
  }
} 
```

完整的堆栈跟踪：

> 添加注释器标记化添加注释器 ssplit 添加注释器 pos 加载 POS 模型 [edu/stanford/nlp/models/pos-tagger/english-left3words/english-left3words-distim.tagger] ... 从训练有素的标注器 edu/stanford/ 加载默认属性nlp/models/pos-tagger/english-left3words/english-left3words-distim.tagger 从 edu/stanford/nlp/models/pos-tagger/english-left3words/english-left3words-distim.tagger 读取词性标注模型 ...完成 [2.1 秒]。完成 [2.2 秒]。添加注释器引理添加注释器 ner 从 edu/stanford/nlp/models/ner/english.all.3class.distim.crf.ser.gz 加载分类器...完成 [4.0 秒]。从 edu/stanford/nlp/models/ner/english.muc.dissim.crf.ser.gz 加载分类器...完成 [3.0 秒]。从 edu/stanford/nlp/models/ner/english.conll.dissim.crf.ser.gz 加载分类器...完成 [3.3 秒]。在线程“main”java.lang.NoSuchMethodError 中添加注释器解析异常：edu.stanford.nlp.parser.lexparser.LexicalizedParser.loadModel(Ljava/lang/String;[Ljava/lang/String;)Ledu/stanford/nlp/parser /lexparser/词法分析器；在 edu.stanford.nlp.pipeline.ParserAnnotator.loadModel(ParserAnnotator.java:115) 在 edu.stanford.nlp.pipeline.ParserAnnotator.(ParserAnnotator.java:64) 在 edu.stanford.nlp.pipeline.StanfordCoreNLP$12.create (StanfordCoreNLP.java:603) at edu.stanford.nlp.pipeline.StanfordCoreNLP$12.create(StanfordCoreNLP.java:585) at edu.stanford.nlp.pipeline.AnnotatorPool.get(AnnotatorPool.java:62) at edu.stanford .nlp.pipeline.StanfordCoreNLP.construct(StanfordCoreNLP.java:329) 在 edu.stanford.nlp.pipeline.StanfordCoreNLP.(S​​tanfordCoreNLP.java:196) 在 edu.stanford.nlp。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T18:56:07.057

是的，从 Java 1.0 开始，L 就是一个奇怪的 Sun 东西。

`LexicalizedParser.loadModel(String, String ...)`是添加到解析器的新方法，目前没有找到。我怀疑这意味着您的类路径中有另一个版本的解析器正在被使用。

试试这个：在任何 IDE 外部的 shell 中，给出这些命令（适当地给出 stanford-corenlp 的路径，并将 : 更改为 ; 如果在 Windows 上：

```
javac -cp ".:stanford-corenlp-2012-04-09/*" Coref.java
java -mx3g -cp ".:stanford-corenlp-2012-04-09/*" Coref 
```

解析器加载并且您的代码对我来说正确运行 - 只需要添加一些打印语句，这样您就可以看到它做了什么:-)。

# c# - 程序集签名密钥已过期

> ID：10688744
> 
> 赞同：5
> 
> 时间：2012-05-21T16:11:33.527
> 
> 标签：c#, assembly-signing

我使用 sn 工具创建了一个密钥来对项目中的程序集进行签名。我注意到密钥在 4 个月前过期，但 Visual Studio 并没有抱怨这一点，并且仍然对 dll 进行签名。我的客户在安装这些组件时会受到影响吗？（如果重要，一些程序集会提交给 GAC）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T16:17:18.303

[强名称密钥不会过期](http://msdn.microsoft.com/en-us/magazine/cc163583.aspx#S4)。

您可能正在考虑[Code Signing certificate](http://msdn.microsoft.com/en-us/library/ff699202.aspx)，确实如此。

# mongodb - 用于高效大规模图遍历的数据库

> ID：10688745
> 
> 赞同：1
> 
> 时间：2012-05-21T16:11:33.673
> 
> 标签：mongodb, networking, graph, database

我有一个大型的二分有向图数据集（约 2000 万个元素）。在目前的使用中，我运行的遍历算法每次运行会达到约 500,000 个节点。算法工作，但历史上运行从文本文件加载到内存的数据。

文本文件似乎是一种不好的方法，所以我将数据作为邻接列表传输到 mongoDB，即。

```
{ _id: 1, children: [2, 3] }
{ _id: 2, children: [4] }
{ _id: 3, children: [5, 6, 7] } 
```

这可行，但我觉得该模型对我正在做的事情效率低下。*在伪代码中，从 _ id: 1*开始的广度优先搜索的查询结构如下所示：

```
children = getChildren(_id = 1)
for child in children
    grandchildren = getChildren(_id = child)
    // etc., either recursively or as a nested loop 
```

我对数据库的问题是没有逻辑连接节点。每个查询都必须遍历索引树，如果我没记错的话，它是 O(log N)。加载后文本文件的方法是 O(1)，因为我可以制定一些简单的查找规则来直接指向节点子节点。

**TL;DR**有没有办法使用数据库在 O(1) 时间内遍历大型网络？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:35:25.317

您可以尝试使用NoSQL 图形数据库[Neo4J 。](http://neo4j.org/)我没有使用它，但它承诺高性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:36:31.813

MongoDB 不是一个多用途数据库。您显然对使用专用的*专用*图形数据库感兴趣。将 MongoDB 用于此类图形和相关搜索算法是不可行的。

# ruby - 安装自制软件的问题

> ID：10688746
> 
> 赞同：0
> 
> 时间：2012-05-21T16:11:34.670
> 
> 标签：ruby, homebrew

我正在尝试在 mac 上安装自制软件，但我不能，有这个问题。

```
ruby -e "$(curl -fsSL https://raw.github.com/gist/323731)"
curl: (6) Couldn't resolve host 'raw.github.com' 
```

我该如何解决这个问题并安装。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:21:18.933

只需导航到[https://raw.github.com/gist/323​​731](https://raw.github.com/gist/323731)：

> 此脚本已被移动。 [https://github.com/mxcl/homebrew/blob/master/Library/Contributions/install_homebrew.rb](https://github.com/mxcl/homebrew/blob/master/Library/Contributions/install_homebrew.rb)

这是一个全新的安装指南：[https ://github.com/mxcl/homebrew/wiki/Installation](https://github.com/mxcl/homebrew/wiki/Installation)

* * *

更新：现在安装说明移至：[http ://brew.sh/](http://brew.sh/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T06:12:15.257

将其粘贴到终端提示符处。

```
ruby <(curl -fsSkL raw.github.com/mxcl/homebrew/go) 
```

或者帮自己一个忙并安装到 /usr/local

```
mkdir homebrew && curl -L https://github.com/mxcl/homebrew/tarball/master | tar xz --strip 1 -C homebrew 
```

或者干脆

```
curl -Lsf http://github.com/mxcl/homebrew/tarball/master | tar xz --strip 1 -C /usr/local 
```

有关详细信息，请参阅[https://github.com/mxcl/homebrew/wiki/Installation 。](https://github.com/mxcl/homebrew/wiki/Installation)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T03:03:52.687

[http://blog.wyeworks.com/2012/4/13/my-osx-rails-installation-using-homebrew-and-rbenv-step-by-step#comments](http://blog.wyeworks.com/2012/4/13/my-osx-rails-installation-using-homebrew-and-rbenv-step-by-step#comments)

这个博客是相当有帮助的一步一步。我也过得很艰难。我必须在“选项1”下下载雪豹版本才能进行原始下载，其余的安装还可以，除了现在我有路径错误

# javascript - Jquery追加到（通过id动态）

> ID：10688748
> 
> 赞同：1
> 
> 时间：2012-05-21T16:11:40.787
> 
> 标签：javascript, jquery

假设我有 id 参数和两个选择框的功能

```
<select id="one" onchange="Fill(2)"></select>
<select id="two" onchange="Fill(3)"></select>
<select id="three"></select> 
```

我的功能

```
function Fill(id){  
//some manupulation
$('<option/>').val(substr[0]).html(substr[1]).appendTo('#two');
} 
```

但不是做很多

```
if(id==2) {$('<option/>').val(substr[0]).html(substr[1]).appendTo('#two');}
if(id==3) {$('<option/>').val(substr[0]).html(substr[1]).appendTo('#three');} 
```

我想要类似的东西

```
$('<option/>').val(substr[0]).html(substr[1]).appendTo(DYNAMIC); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T16:13:46.340

您可以通过使用 id 等来使其更容易`select-1`，`select-2`然后使用`'#select-' + id`.

否则，您需要一个从数字映射到拼写数字的映射对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T16:13:48.737

```
function Fill(id){  
  var index = {
    1: 'one',
    2: 'two',
    3: 'three'; 
  };
  $('<option/>').val(substr[0]).html(substr[1]).appendTo('#' + index[id]);
  // or just, but in this case you need to change the *id* pattern like opt_1, opt_2 etc
  $('<option/>').val(substr[0]).html(substr[1]).appendTo('#opt_' + id);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:14:49.313

比你想象的要容易:)

```
<select id="select-1" onchange="Fill(2)"></select>
<select id="select-2" onchange="Fill(3)"></select>
<select id="select-3"></select>

function Fill(id){ // 
    //some manupulation
    $('<option/>').val(substr[0]).html(substr[1]).appendTo('select-' + id);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T16:18:27.920

将此行添加到 Fill 函数的顶部：

```
 var DYNAMIC = $(this); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T17:06:01.403

我将接受 David Thomas 的建议：

```
<select id="one" onchange="Fill(this);"></select>
<select id="two" onchange="Fill(this);"></select>
<select id="three"></select> 
```

填充函数定义为：

```
function Fill(select) {
    $('<option />').val(/*..*/).html(/*..*/).appendTo($(select));
} 
```

然后，您可以为您的选择提供您想要的任何 id，并且您不必查询 DOM 来查找对象。

# c# - 单击其菜单条组件时如何识别表单的活动实例

> ID：10688750
> 
> 赞同：1
> 
> 时间：2012-05-21T16:11:53.953
> 
> 标签：c#, winforms, mdi, mdichild

我正在为 MDI 应用程序构建一种原型。我有一个名为 mainForm 的主窗体和一些其他子窗体，它们都是 childForm 类的所有实例。我的 childForm 类的这些实例都有一个基本的 MenuStrip，带有一些 form\close、print 等 toolStripMenuItems。

在单击时，如何确定 childForm 类的哪个实例持有激活的 toolStripMenuItem？

编辑：以下破折号评论

伪代码如下所示：

```
Form myNewForm = new Form()
MenuStrip myNewMenu = new MenuStrip()
...
myNewForm.Controls.Add(myNewMenu)
myNewForm.MainMenuStrip = myNewMenu 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:49:30.020

对破折号表示敬意，这应该作为答案发布。

我将假设您在菜单项的单击事件中...

```
Control s = sender as Control;//the sender object from the click event
ChildForm activeForm = s.FindForm() as ChildForm; 
```

这将给出您正在寻找的表单的特定实例。

或者，按钮单击事件应该从 ChildForm 类本身实现，这意味着在任何单击事件期间，您的“this”运算符实际上应该是被激活的 ChildForm 类的特定实例。

```
ChildForm activeForm = this; 
```

这是一个完全不必要的任务，但确实说明了这一点。如果您的菜单条位于其他一些自定义用户控件容器上，则情况并非如此，在这种情况下，您将需要这样的东西。

```
ChildForm activeForm = this.ParentForm; 
```

ParentForm 属性对于“ContainerControl”是唯一的，它被定义为可以包含其他控件的控件，并且它标识了显示容器的基本“表单”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T12:35:13.767

鉴于我的原始评论和您的更新，以下内容对我有用：

```
 Form newChildForm = new Form();
  newChildForm.Name = "ChildForm";
  MenuStrip newMenu = new MenuStrip();

  ToolStripItem newItem = newMenu.Items.Add("New Item");
  newItem.Click += new EventHandler(newItem_Click);

  newChildForm.Controls.Add(newMenu);
  newChildForm.MainMenuStrip = newMenu;

  newChildForm.Show(); 
```

然后，在事件处理程序中：

```
void newItem_Click(object sender, EventArgs e)
{
  ToolStripItem clickedItem = sender as ToolStripItem;

  MenuStrip parentMenu = clickedItem.Owner as MenuStrip;

  Form childForm = parentMenu.FindForm() as Form;
  //childForm.Parent is also "ChildForm";

} 
```

你有什么不一样的吗？

# jsf - h:commandbutton vs h:commandlink

> ID：10688755
> 
> 赞同：15
> 
> 时间：2012-05-21T16:12:13.543
> 
> 标签：jsf, jsf-2, commandbutton, commandlink

我们正在使用 JSF-2.1.7 并以我们所有的形式发布请求。我试图证明是否使用`<h:commandButton>`或`<h:commandLink>`。`<h:commandLink>`(href )的外观`<a/>`可以使用样式和 jQuery 来控制。

推荐哪个`<h:commandButton>`？`<h:commandLink>`有什么真正的优势吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-21T16:19:03.997

除了生成的标记和外观之外，没有任何功能差异。`<h:commandButton>`生成一个 HTML`<input type="submit">`元素并`<h:commandLink>`生成一个`<a>`使用 JavaScript 提交表单的HTML 元素。两者都用于提交表单。附加样式与功能无关。

使用`<h:commandButton>`if you need a submit**按钮**并使用`<h:commandLink>`if you need a submit**链接**。如果这对你没有*意义*，那么我不知道。如果您无法决定使用哪一个，只需选择从 UI 角度来看最有意义的一个。如果您不确定，请咨询网页设计师。

`<h:commandLink>`顺便说一句，和之间的区别`<h:outputLink>`更有趣。此处已对此进行了详细回答：[何时应该使用 h:outputLink 而不是 h:commandLink？](https://stackoverflow.com/questions/4317684/when-should-i-use-houtputlink-instead-of-hcommandlink)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T16:20:01.277

对于表单，我更喜欢 h:commandbutton

h:commandbutton 就像 HTML 中的一个按钮，您可以在其中设置支持 bean 的操作。h:commandlink 就像 HTML 中的链接（标签 a），您还可以在其中设置支持 bean 的操作

要在 JSF 中使用 css 样式，可以使用属性“styleClass”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-04-08T16:46:58.813

简而言之，我的建议是`<h:commandButton type="submit">`主要（默认）提交按钮和`<h:commandLink>`任何附加按钮（例如过滤器、排序、查找、预览、生成密码......）的混合。

冗长的解释如下：

首先，一些背景：人们可能还应该意识到不同的`<h:commandButton>` `type`属性。（该`type`属性直接转换为生成的`<input type="">`属性。）我在任何地方都没有发现这一点，但一些测试表明：

*   `type="submit"` *（如果省略，则默认为这个）*执行表单的正常“提交”行为（即发布表单）以及`action`and/or `actionListener`。
*   `type="reset"`执行正常的“重置”行为（即清除/重置表单字段）**而不**调用任何`action`和/或`actionListener`s。
*   `type="button"`生成一个按钮（显然`<input type="button">`比`<button>`标签更受限制）**而不**调用任何`action`和/或`actionListener`s。

除了重置字段之外，后两者似乎仅对激活例如 Javascript 有用。他们不发布表格。

所以要回答这个问题：**在表单上下文中：**

*   `<h:commandButton>`（相当于`<h:commandButton type="submit">`，记住）通常是最有用的，尤其是当大多数浏览器现在实现在按下时激活在表单的 DOM 树中找到的第一个提交按钮`Enter`。这可能会改善表单的用户体验

例如，使用以下方式登录会更快一些：

1.  *用户名* `Tab` *密码* `Enter`

与

2.  *用户名* `Tab` *密码*... 将手从键盘移到鼠标，寻找指针并在按钮上定位，单击。

还要记住，任何`<input>`按钮（可选的 CSS 样式）仍然可以通过键盘通过`Tab`ing 到达，直到`<a>`（CSS 样式的按钮）具有焦点，然后`Spacebar`.

*   但是，对于应该执行其他操作而不是提交（或“只是”清除字段）的表单上的其他按钮，`<h:commandLink>`会更合适。这仍然可以通过键盘通过`Tab`ing 来达到，直到`<a>`（CSS 样式的按钮）具有焦点，然后`Enter`. **请注意**，这与使用 生成的按钮不一致，`<h:commandButton>`这些按钮可能是 CSS 样式的，看起来相同，但浏览器 ( `Tab`... `Spacebar`) 的处理方式不同。

这是一般性解释，**但您可能需要注意一些问题......**

当`<h:commandButton type="submit">`表单上没有按钮时，只有一个`<h:commandLink>`按钮（甚至根本没有按钮），当用户按下`Enter`表单时仍然提交，但没有`action{Listener}`运行的好处。这可能不是太大的问题，因为表单值存储在支持 bean 中并在页面加载时再次显示，因此除了服务器往返之外，用户通常不会注意到任何问题。但这可能不是您想要`Enter`的处理方式....目前我能想到的唯一方法是`onSubmit`在表单上放置一个事件，`<h:commandLink>`通过 Javascript 激活您的默认按钮.... Arghhhh ！

您还应该确保您的 CSS 样式选择器是正确的。

*   `A.mystyle`应用于`<h:commandLink>`；
*   `INPUT[type=submit].mystyle`到`<h:commandButton type="submit">`;
*   `INPUT[type=reset].mystyle`到`<h:commandButton type="reset">`;
*   `INPUT[type=button].mystyle`到`<h:commandButton type="button">`;

这些当然可以与逗号连接，作为单个样式定义的选择器。或者，如果您想冒险将其他东西设置为*mystyle*按钮，则可以省略`A`/`INPUT`说明符。但是，我已经按照上面的方式设置了按钮的样式，因此我也可以使用它：

*   `SPAN.mystyle`禁用链接或按钮时的定义（例如通过`disabled`属性） - 这允许您为禁用的按钮提供淡化（灰色）的外观。

我也遇到了一些高度差异（Button 上的行高与 Link 上的内容高度 - 如果您的按钮包含背景图像作为图标而不是文本，这可能是一个问题），并且在处理方式`:before`/`:after`伪类方面也存在一些细微差异. 我要说的是：在`<h:commandButton>`s 和`<h:commandLink>`s 上测试和重新测试你的 CSS 以确保它们看起来（基本上）相同！

这是我的摘要备忘单：

```
JSF <h:commandButton <h:commandButton <h:commandButton <h:commandLink>
                      type="submit"> type="reset"> type="button">

转换为 <input <input <input <a>
                      type="submit"> type="reset"> type="button">
提交表单 POST no，清除 flds no POST
Javascript 事件 是 是 是 是
action{Listener} 是 否 否 是
输入表格激活是 否 否 否
Tab...+Enter 激活 YES(*) YES YES YES
Tab...+空格激活 YES(*) YES YES no
突出显示选项卡焦点：
- Firefox 32 是 不 不 不
- Chrome 41 是 是 是 是
- Internet Explorer 11 是 是 是 是
- Opera 28 是 是 是 否 (*)

（*=Opera 28 似乎不允许使用制表符（或 Alt+箭头）来激活超链接。）

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-29T16:15:43.717

如果我错了，请纠正我，但这两者之间的第一个区别是事实，它`<h:commandButton>`不需要在浏览器中启用 JavaScript。如果您的网页 JS 很重，那么您可以使用`<h:commandLink>`，否则最好保持 JS 免费，以防您的用户想要使用 Tor 浏览器之类的东西并且您可以接受。第二个是这两者在网页中的行为方式。`<h:commandLink>`只会做它应该做的事情，或者有时也会从具有注释的支持 bean 中触发一个方法`@PostConstruct`。虽然`<h:commandButton>`也可能触发内联 JavaScript，这可能导致从支持 bean 触发其他方法。但是它也会自动刷新视图。

# ios - 是否可以成为 Canvas 应用程序和 iPhone 应用程序？

> ID：10688761
> 
> 赞同：0
> 
> 时间：2012-05-21T16:12:49.047
> 
> 标签：ios, facebook

根据 Facebook 文档，您需要成为 Canvas 应用程序才能执行请求并访问其他漂亮的功能。但 Facebook 要求您使用 Facebook Credits 才能成为 Canvas 应用程序。这似乎与 Apple 的 App Store 冲突，因为应用内购买将使用 Apple 的支付方式而不是 Facebook Credits。

有谁知道在这种情况下如何解决 Apple 和 Facebook 之间的付款问题？任何一家公司都允许开发者使用对方的支付方式吗？如果您是 HTML5 混合应用而不是原生应用，情况会发生变化吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:37:25.097

根据 Facebook，您必须在原生 iOS 应用程序中使用 iTunes 付款而不是 Facebook Credits。看这里：[https ://developers.facebook.com/docs/credits/](https://developers.facebook.com/docs/credits/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:19:09.917

当用户通过画布访问您的应用程序时（无论是在网络上还是在移动网络浏览器中的“移动网络”上），所有付款都应使用 Facebook Credits 处理。当用户通过其原生 iOS 应用程序访问您的应用程序时，应使用 Apple 的支付系统处理付款。

# php - 数据库中存储在 Drupal 6 中的内容类型字段的位置

> ID：10688762
> 
> 赞同：1
> 
> 时间：2012-05-21T16:12:53.057
> 
> 标签：php, sql, drupal-6, drupal-7

我需要访问内容类型的特定字段，以便我可以相应地排序和显示我想要的内容。我没有可用的 Views 模块，因为我没有安装权限，所以我必须使用查询和一些 php 魔术来完成此操作。

我收到了一些关于 Drupal 7 字段表名的非常有用的信息，但似乎字段值的组织/约定以及它们的存储位置自 6 以来发生了变化。

我在 Drupal 7 中发现每个内容类型字段都存储在自己单独的表中。假设我有一个名为 group 的字段，表名将是“field_data_field_group”。

然而，当我尝试在我的 Drupal 6 站点上使用这个约定时，它说这个表不存在。

我的问题是存储的表字段的名称是什么？还是与 Drupal 7 完全不同的系统？谢谢参观。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:25:37.513

对于 Drupal 6，请查看以下几个地方：

1.  在 Drupal 6 数据库中，查找名为**content_[your_field_name]**的表，例如 content_field_brief_description。执行 SELECT * 以查看该字段表的哪些行（如果存在）。

2.  查找名为**content_type_[your_content_type]**的表，例如 content_type_resource。对那个表做同样的事情，看看你在那个表中是否有任何列作为字段，除了可能与该内容类型相关联的标题/正文。

让我们知道这是否有效！

* * *

编辑：

示例代码：

```
$result = db_query("SELECT * FROM {table_name}");
while ($row = db_fetch_array($result)) {
   // do something like drupal_set_message(var_dump($row));
} 
```

保持大括号不变，但只需将其替换为您当前使用的表名......

# sql-server - 如何查看 HQL 最终查询

> ID：10688764
> 
> 赞同：1
> 
> 时间：2012-05-21T16:12:56.637
> 
> 标签：sql-server, hibernate, jpql

我正在尝试运行以下查询并获得空指针异常。我已经验证了它`WHERE lockedTimestamp <= (GETDATE() - CAST('00:06' AS datetime)`是有效的 msSQL，因为我可以手动运行它并且它会正常工作。看起来 HQL（Hibernate Query Language）可能不喜欢它。关于如何调试这个有什么想法吗？

```
Query query = this.em.createQuery("SELECT c FROM Content c WHERE lockedTimestamp <= (GETDATE() - CAST('00:06' AS datetime))"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:18:44.863

`EntityManager.createQuery`[期望JPQL](http://docs.oracle.com/javaee/6/tutorial/doc/bnbuf.html)中的查询字符串（不是 HQL，也不是 SQL）。JPQL 没有定义`CAST`函数。

我将计算 Java 中的时间戳限制，并将其作为参数传递给查询：

```
Date limit = ...;
this.em.createQuery("SELECT c FROM Content c WHERE lockedTimestamp <= ?")
       .setParameter(0, limit); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:36:34.837

为什么不使用更明显和直观的计算，例如

```
SELECT c FROM Content c WHERE lockedTimestamp <= DATEADD(MINUTE, -6, GETDATE()); 
```

? 我认为这在 JPQL 中也无效，但更多的是一般查询本身，以防其他用户偶然发现这个问题......

顺便说一句，为什么不将此查询放在存储过程中呢？当然hibernate可以调用存储过程，那么它不需要尝试解释或反向工程您的查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T16:59:12.017

要**调试**sql，您可以通过在 hibernate 配置属性中添加配置**hibernate.show_sql=true**来显示启动 Hibernate 的查询。

查询将显示在控制台中，这是 hibernate 对数据库进行的确切查询。

# r - 使用 R、Hyndman 预测包和 quantmod

> ID：10688766
> 
> 赞同：3
> 
> 时间：2012-05-21T16:13:01.830
> 
> 标签：r, quantmod

不知道我在这里做错了什么。我在 R 中运行以下代码：

```
require(quantmod)
require(forecast)
getSymbols('FAGIX', from='2001-01-06', to=Sys.Date())
y <-Ad(FAGIX)
plot(forecast(y)) 
```

它似乎部分工作，但我收到一条警告消息。此外，该图不再显示日期。这里可能有一个简单的解决方案，但我没有看到。

警告消息：在 if (class(y) == "data.frame" | class(y) == "list" | class(y) == 中：条件的长度 > 1，并且只使用第一个元素

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T16:26:11.527

警告是因为 xts 对象的类是一个二元素字符向量 ( `c("xts","zoo")`)，并且`ets`最终被调用的函数隐式假定传递给它的对象的类将只有一个元素类。

像这样的东西可能更健壮一点：

```
any(class(y) %in% c("data.frame","list","matrix","mts")) 
```

无论如何，在这种情况下，您可以放心地忽略警告，因为测试是检查对象是否是单变量时间序列，在您的示例中就是这样。

# firefox - 使用Firefox将文本保留在div中

> ID：10688767
> 
> 赞同：0
> 
> 时间：2012-05-21T16:13:06.527
> 
> 标签：firefox, text, overflow

请用 Firefox 和 Chrome 打开这个小提琴。

[http://jsfiddle.net/mattdevo/5bdDd/](http://jsfiddle.net/mattdevo/5bdDd/)

您可能会注意到，文本在 Firefox 中流过 div。

我的错误是什么？（删除强标签没有帮助......）

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:24:02.183

仅使用 Firefox 显示类型会导致不兼容，这很正常。

如果你删除

```
display:-moz-box; 
```

这在 FF 中和 Chrome 中一样有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T16:26:34.703

你正在使用`display:-moz-box;`; 如果你真的需要它，你还应该添加`-moz-box-orient: vertical;`

# javascript - 如何使用prototype.js 在一段文本之后插入内容？

> ID：10688773
> 
> 赞同：0
> 
> 时间：2012-05-21T16:13:40.873
> 
> 标签：javascript, html, prototypejs

我正在尝试使用prototype.js 插入一段html 代码

当我以 html 元素为目标时，我已经能够做到这一点，例如

```
$('footer').insert({top: '<div id="footer_inner"><small>CompanyName, LLC</small></div>'}) 
```

是否可以在文本之后插入 div，例如

### 詹姆斯麦卡锡 (level3)

是否可以针对文本级别3？并在其后插入一个块html？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:22:40.797

当然。只需`after`用作的第一个参数`insert()`：

```
$('level3').insert({after: '<p>HTML goes here</p>'}); 
```

# ios - Cocos2d 游戏在 CCCallFunc 后不久崩溃

> ID：10688789
> 
> 赞同：0
> 
> 时间：2012-05-21T16:15:18.347
> 
> 标签：ios, xcode, cocos2d-iphone

**情况：**
在 CCCallFunc 之后不久，我遇到了一些神秘的崩溃。简而言之，我们有一个按钮。该按钮有一个标签，以便以后识别它。当按钮被按下时，我们运行一些动作来动画它，当动画完成时，我们 CCCallFunc 另一个方法来转换到另一个场景。我们在 CCCallFunc 之后不久就崩溃了。来源和错误如下。

**崩溃点（在 cocos2d 源中）：**

```
// From CCActionInstant.m of cocos2d
-(void) execute
{
    /*** EXC_BAD_ACCESS on line 287 of CCActionInstant.m ***/
    [targetCallback_ performSelector:selector_];
}
@end 
```

**线程 1 的快照：**
![线程 1 堆栈](../Images/a75ad14c2964c2de4234161d968ba51b.png)

**我的代码：**
下面是取自 MenuLayer.m 的一些源代码（一个显示按钮的简单菜单）。

```
// from MenuLayer.m
// …

@implementation MenuLayer

-(id) init{

    if((self=[super init])) {

    /****** Create The Play Button (As a CCMenu) ********/
        CCSprite *playSprite = [CCSprite spriteWithFile:@"playbutton.png"];

        CCMenuItemSprite *playItem = [CCMenuItemSprite itemFromNormalSprite:playSprite selectedSprite:nil target:self selector:@selector(animateButton:)];
        playItem.tag = 3001;
        playItem.position = ccp(160.0f, 240.0f);

        CCMenu *menu = [CCMenu menuWithItems:playItem, nil];
        menu.position = ccp(0.0f, 0.0f);
        [self addChild:menu z:0];

    }
}

// ...

- (void)animateButton:(id)sender{

    /*** Run an animation on the button and then call a function ***/
    id a1 = [CCScaleTo actionWithDuration:0.05 scale:1.25];
    id a2 = [CCScaleTo actionWithDuration:0.05 scale:1.0];
    id aDone = [CCCallFunc actionWithTarget:self selector:@selector(animationDone:)];
    [sender runAction:[CCSequence actions:a1,a2,aDone, nil]];

}
- (void)animationDone:(id)sender{

    /*** Identify button by tag ***/
    /*** Call appropriate method based on tag ***/
    if([(CCNode*)sender tag] == 3001){

    /*** crashes around here (see CCActionInstant.m) ***/
        [self goGame:sender];
    }
}

-(void)goGame:(id)sender{

        /*** Switch to another scene ***/
    CCScene *newScene = [CCScene node];
    [newScene addChild:[StageSelectLayer node]];

        if ([[CCDirector sharedDirector] runningScene]) {
            [[CCDirector sharedDirector] replaceScene:newScene]];
        }else {
            [[CCDirector sharedDirector] runWithScene:newScene];
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:19:09.053

只是一种预感。除了检查内存泄漏，尝试安排一个 0 秒间隔的选择器，而不是直接发送 goGame 消息。我怀疑导演的 replaceScene 会清理场景和与之相关的所有对象。这反过来可能会使 CCCallFunc 操作处于未定义状态。虽然通常它工作正常 - 也就是说，这只是粗略的，内存 - 分别是对象生命周期管理方面的另一个迹象。

顺便说一句，如果您至少支持 iOS 4，请使用 CCCallBlock 而不是 CCCallFunc。这样更安全、更清洁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T19:22:12.823

使用 CCCallFuncN 代替 CCCallFun。

CCCallFuncN 将节点作为参数传递，CCCallFun 的问题是您丢失了节点的引用。

我用 CCCallFuncN 测试你的代码并且工作正常。

# doctrine-orm - Doctrine2：从对象 X 到对象 X 的多对多

> ID：10688793
> 
> 赞同：0
> 
> 时间：2012-05-21T16:15:40.287
> 
> 标签：doctrine-orm, many-to-many

我尝试为用户设置“关注”功能，以便用户可以关注用户。

我尝试通过添加多对多关系来做到这一点：

```
@ORM\ManyToMany(targetEntity="User",inversedBy="User",fetch="LAZY",cascade={"persist"})
@ORM\JoinTable=(name="user_followers",
joinColumns={
  @ORM\JoinColumn(name="user_id", referencedColumnName="id")
},
inverseJoinColumns={@JoinColumn(name="follower_id",referencedColumnName="id")}
) 
```

现在，学说创建了一个表 user_user，只有一个字段 user_id。

我真的不知道如何声明这一点。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T17:23:39.590

我自己找到了解决方案。

您实际上可以使用自引用多对多解决方案。从教义网站：

```
<?php
/** @Entity */
class User
{
    // ...

    /**
     * @ManyToMany(targetEntity="User", mappedBy="myFriends")
     */
    private $friendsWithMe;

    /**
     * @ManyToMany(targetEntity="User", inversedBy="friendsWithMe")
     * @JoinTable(name="friends",
     *      joinColumns={@JoinColumn(name="user_id", referencedColumnName="id")},
     *      inverseJoinColumns={@JoinColumn(name="friend_user_id", referencedColumnName="id")}
     *      )
     */
    private $myFriends;

    public function __construct() {
        $this->friendsWithMe = new \Doctrine\Common\Collections\ArrayCollection();
        $this->myFriends = new \Doctrine\Common\Collections\ArrayCollection();
    }

    // ...
} 
```

[http://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/reference/association-mapping.html#many-to-many-self-reference](http://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/reference/association-mapping.html#many-to-many-self-referencing)

# javascript - 创建填充选择标签的循环

> ID：10688794
> 
> 赞同：0
> 
> 时间：2012-05-21T16:15:43.263
> 
> 标签：javascript, jquery

```
function buildOrder(data) {
    var $fragment;
    $fragment = $('<div/>');
    for (var i = 0; i < data.length; i++) {
        $fragment.append('<div class="row-container"><div class="row cupcake-row">' + data[i].name + '</div><div class="clear"></div></div>');
    }
    $('#review-section').append($fragment);
} 
```

我本质上想添加一个标签，其中包含使用 for 循环动态创建的 50 个选项。但我不确定将它添加到`<div class="row-container"/>` 我知道的 php 中的语法是什么我只会在中间抛出循环并回显选项，但这在 javascript 中不起作用。

编辑：

它看起来像这样：

```
$fragment.append('<div class="row-container"><div class="row cupcake-row">' + data[i].name + '</div><select><option value="1">1</option> etc...</select><div class="clear"></div></div>'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:26:59.623

您可以将函数传递给`.append`并在那里执行循环：

```
$("<div>").append(function() {
  var $select = $("<select>");
  for(var i = 1; i <= 50; i++) {
    $("<option>").text(i).val(i).appendTo($select);
  }
  return $select;
});

// returns a jQuery object with one div element (with children):
// <div>
//   <select>
//     <option value="1">1</option>
//     ...
//   </select>
// </div> 
```

* * *

混合到您的代码中，它将类似于：

```
var $fragment = $("<div>");

for (var i = 0; i < data.length; i++) {
    var $container = $("<div>").addClass("row-container")
                               .appendTo($fragment);

    $("<div>").addClass("row cupcake-row")
              .text(data[i].name)
              .appendTo($container);

    $("<div>").append(function() {
      var $select = $("<select>");
      for(var i = 1; i <= 50; i++) {
        $("<option>").text(i).val(i).appendTo($select);
      }
      return $select;
    }).appendTo($container);

    $("<div>").addClass("clear")
              .appendTo($container);
}

$("#review-section").append($fragment); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:19:12.210

根据您发布的代码：

```
function buildOrder(data) {
    var $fragment;
    $fragment = '<div><div class="row-container">';
    for (var i = 0; i < data.length; i++) {
        $fragment += '<div class="row cupcake-row">' + data[i].name + '</div><div class="clear"></div>';
    }
    $fragment += '</div></div>';
    $('#review-section').append($fragment);
} 
```

但是在您发布的代码中与您的帖子标题不匹配，您提到`select`标签的地方以及您尝试使用的代码中`div`。

如果你想创建一个`select`，那么类似：

```
function buildOrder(data) {
        var $fragment;
        $fragment = '<div class="row-container"><select>'; // taking select within your div
        for (var i = 0; i < data.length; i++) {
            // adding options to select
            $fragment += '<option value="'+ data[i].name +'">' + data[i].name + '</option>';
        }
        $fragment += '</select></div>'; // end select and div
        $('#review-section').append($fragment);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:22:57.340

尝试这样的事情

```
function buildOrder(data) {
    var $fragment = $('<div></div>');
    var options = [];

    for (var i = 0; i < data.length; i++) {
        options.push('<div class="row-container"><div class="row cupcake-row">' + data[i].name + '</div><div class="clear"></div></div>');
    }
    $fragment.html(options.join("\n"));

    $('#review-section').append($fragment);
} 
```

# spring - 在 Spring 中使用凭据对异步 Web 请求进行排队

> ID：10688799
> 
> 赞同：1
> 
> 时间：2012-05-21T16:16:15.537
> 
> 标签：spring, asynchronous, credentials

我对 Spring 比较陌生，并试图在服务器上排队一组 web 请求（以便加热 memcached）。我不清楚如何转移当前请求的凭据，以便在我放入队列的未来 Web 请求中使用。我见过一些调度解决方案（TaskExecutor、ApplicationEventMultitasker 等），但不清楚它们是否/如何处理凭据，因为这似乎是这项任务中最复杂的部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:25:22.473

直接是不可能的。安全凭证被存储在`ThreadLocal`其中，这意味着一旦请求被转发到另一个线程，凭证就会丢失。您所能做的（这实际上可能对您的设计有益）是直接传递凭据，方法是将它们包装在`Callable`/`Runnable`或您使用的任何机制中。

# c++ - _wtoi return zero：输入零还是非数字输入？

> ID：10688805
> 
> 赞同：4
> 
> 时间：2012-05-21T16:17:03.623
> 
> 标签：c++, visual-c++

[_wtoi](http://msdn.microsoft.com/en-us/library/yd5xkb5c%28v=vs.100%29.aspx)当无法转换输入，因此输入不是整数时，返回零。但同时输入可以为零。这是一种确定输入错误还是零的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:54:52.530

这是 C++，您应该使用它`stringstream`来进行转换：

```
#include <iostream>
#include <sstream>

int main()
{
   using namespace std;

   string s = "1234";
   stringstream ss;

   ss << s;

   int i;
   ss >> i;

   if (ss.fail( )) 
   {
        throw someWeirdException;
   }
   cout << i << endl;

   return 0;
} 
```

boost's 存在一个更清洁、更简单的解决方案`lexical_cast`：

```
#include <boost/lexcal_cast.hpp>

// ...
std::string s = "1234";
int i = boost::lexical_cast<int>(s); 
```

如果您坚持使用C，`sscanf`可以干净地做到这一点。

```
const char *s = "1234";
int i = -1;

if(sscanf(s, "%d", &i) == EOF)
{
    //error
} 
```

你也可以使用`strtol`它需要一点思考的警告。是的，对于评估为零的字符串和错误，它都会返回零，但它还有一个（可选）参数`endptr`，它将指向转换后的数字之后的下一个字符：

```
const char *s = "1234";
const char *endPtr;
int i = strtol(s, &endPtr, 10);

if (*endPtr != NULL) {
    //error
} 
```

# cakephp - Cakephp habtm 深度条件

> ID：10688807
> 
> 赞同：0
> 
> 时间：2012-05-21T16:17:18.083
> 
> 标签：cakephp, cakephp-2.1

假设你有这些模型关系：

提供 HABTM 类别

您将如何构建查找条件来查找所有至少有一个报价的类别。同时，Offer 应该是 Offer.enabled => 1。因此，请找到至少启用了一项优惠的所有类别。检查报价模型的条件有很多，但是一旦我可以检查启用，我想我将能够检查任何其他字段。

我可以将 habtm 模型绑定到 Category，但在这种情况下，我无法检查 Offer.enabled 条件。也许以某种方式使用可包含？sql查询将是：

```
SELECT DISTINCT Category.nome from categories as Category
LEFT JOIN categories_offers AS CategoriesOffer
ON (CategoriesOffer.category_id = Category.id)
LEFT JOIN offers as Offer ON (CategoriesOffer.offer_id = Offer.id)
WHERE Offer.enabled = 1 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T09:41:38.277

`conditions`仅在`Offer.enabled = 1`. 取自[书中](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#hasandbelongstomany-habtm)。例如：

```
class Category extends Model {
    public $hasAndBelongsToMany = array(
        'Offer' => array(
            'conditions' => array( 'Offer.enabled' => 1 )
        )
    );
} 
```

# mysql - SQL server openquery - “键列信息不足或不正确。更新影响的行太多。”

> ID：10688813
> 
> 赞同：0
> 
> 时间：2012-05-21T16:17:37.243
> 
> 标签：mysql, sql, sql-server-2008, openquery

我正在尝试从 Micrsoft SQL 服务器运行删除查询以清除远程 mySQL 表中的表。

查询是：

```
delete from OPENQUERY(WEB_DB,'select id,university_name,college_name from table_name'); 
```

这是返回错误：

> 链接服务器“WEB_DB”的 OLE DB 提供程序“MSDASQL”返回消息“键列信息不足或不正确。更新影响了太多行。”。消息 7345，级别 16，状态 1，第 1 行链接服务器“WEB_DB”的 OLE DB 提供程序“MSDASQL”无法从表“select id,university_name,college_name from table_name”中删除。更新不符合架构要求。

用于创建表的 SQL 如下：

```
CREATE TABLE IF NOT EXISTS `table_name` (
  `pk` int(11) AUTO_INCREMENT,
  `studentid` int(11) default NULL,
  `university_name` varchar(255) default NULL,
  `college_name` varchar(255) default NULL,
  CONSTRAINT PRIMARY KEY(`pk`)
); 
```

有趣的是，它似乎确实删除了远程数据库记录的某些部分，应该有 ~900，第一次运行删除命令会将其减少到 ~700，所以看起来限制大约是 200 行？！

非常感谢任何帮助。

谢谢乔娜

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:31:46.620

如果您尝试删除远程表中的所有行，为什么不：

```
DELETE WEB_DB...table_name; 
```

或者，如果这是您经常做的事情，为什么不在另一端放置一个存储过程来调用呢？

你也可以试试：

```
EXEC ('delete table_name') AT WEB_DB; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-27T12:35:13.137

要使用 openquery 清除 mysql 中的表，您应该尝试以下操作：

```
EXEC('TRUNCATE TABLE table_name') AT WEB_DB 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-26T19:15:13.720

下面的语法为我解决了它：

```
EXEC ('delete table_name where a in (1,2,3)') AT linked_server 
```

# c# - 如何在 javascript 中获取 HttpWebRequest 范围？

> ID：10688815
> 
> 赞同：3
> 
> 时间：2012-05-21T16:17:58.927
> 
> 标签：c#, javascript

我正在做一个项目，我应该从一个来源获取一半图像，从另一个来源获取另一半图像，然后将它们合并在一起。

在 c# 中它的工作原理是这样的：

```
HttpWebRequest request1 = (HttpWebRequest)WebRequest.Create("URL");
request1.AddRange(0, 10000);
HttpWebRequest request2 = (HttpWebRequest)WebRequest.Create("URL2");
request2.AddRange(10000, 20000); 
```

然后我读取流，将它们合并到缓冲区中，然后将缓冲区写入文件。

现在我必须创建一个做同样事情的插件，据我所知，我可以使用 javascript 为 firefox 创建一个扩展。

你认为可以在javascript中做同样的事情还是我应该搜索另一种方法？我什至不知道如何创建插件所以我不知道我是否可以使用一些编程语言（也许我什至可以使用 c# 或 java 直接创建一个 firefox 插件）你能给我一些提示吗？多谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T16:31:33.200

是的，您绝对可以使用 ajax

给你

[关联](http://www.ioncannon.net/programming/1506/range-requests-with-ajax/)

```
 $(function() {
  $.ajax({
    url: 'range-test.txt',
    headers: {Range: "bytes=618-647"},
    success: function( data ) { $('#results').html( data ); }
  });
}); 
```

# facebook-graph-api - Facebook 图形 API/用户墙上的点赞和帖子

> ID：10688817
> 
> 赞同：0
> 
> 时间：2012-05-21T16:18:04.123
> 
> 标签：facebook-graph-api, facebook-like

我正在使用 facebook graph API 来“喜欢”其他 FBPage 上的一些内容。但是当我这样做时，用户墙上没有通知。所以我的问题是：我是否必须单独在墙上发布类似：“用户 xxxx 喜欢 yyyy”的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:11:42.170

你检查过活动日志吗？它必须在那里显示？

有时确实会发生喜欢不会立即显示，甚至根本不会在时间线上显示的情况。在测试我的画布应用程序时发生了一两次。

# email - Jenkins 可以发送多于一封电子邮件吗？

> ID：10688818
> 
> 赞同：4
> 
> 时间：2012-05-21T16:18:13.653
> 
> 标签：email, jenkins, jenkins-plugins

构建后我想触发两封电子邮件。

第一个是发送到 SharePoint 服务器的电子邮件。SharePoint 上传其附件。此邮件的主题必须与要上传的 SharePoint 文件夹匹配。

第二个是给团队的邮件。所以，它应该有很好的主题而不是文件夹名称。

我怎样才能让詹金斯发送两封电子邮件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T16:44:15.553

没有提供此功能的插件。您有两种选择来完成此功能。您可以实现自己的插件。一个好的起点可能是[email-ext 插件](https://wiki.jenkins-ci.org/display/JENKINS/Email-ext+plugin)。

或者，您可以使用实际构建触发第一封电子邮件，然后让 Jenkins 触发一个单独的虚拟构建来发送第二封电子邮件。这不会那么优雅，但更容易，因为您不需要自己实现任何功能。根据您希望电子邮件包含的确切内容，您可能必须将一些数据从第一个构建传输到第二个构建（例如，通过参数化构建）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-15T11:19:37.480

一种廉价的替代方法是创建“shell 脚本”构建步骤，例如：（如果在 *nix 平台上）

```
echo "Please Mr. SharePoint, would you be so kind to attach my file(s) ? 
      Thanks!" | mail -s "<folder name>" -a ${WORKSPACE}/target/artifacts/myfile sharepoint@example.com 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-17T07:51:17.110

您还可以添加新触发器，并可以选择将包含新内容的新电子邮件发送到收件人列表。

# .net - 如何使用带有客户端证书的 HTTPS 传输使用证书签署 WCF 消息

> ID：10688819
> 
> 赞同：5
> 
> 时间：2012-05-21T16:18:22.307
> 
> 标签：.net, wcf, web-services, ssl

编辑：

我最终确定 IClientMessageInspector 似乎没有反映消息签名，所以当我实际上在我的请求中获得签名时，我并不知道。所以现在我的新问题，真正的问题......

**如何配置 WCF 客户端以提供 SSL 客户端证书并签署 SOAP 标头？**

```
var myBinding = new BasicHttpBinding();
myBinding.Security.Mode = BasicHttpSecurityMode.TransportWithMessageCredential;
myBinding.Security.Transport.ClientCredentialType = HttpClientCredentialType.Certificate;
myBinding.Security.Message.ClientCredentialType = BasicHttpMessageCredentialType.Certificate; 
```

这将导致标头具有已签名的时间戳。但是，不再提供客户端证书，并且我没有通过 SSL。如果我将第二行更改为：

```
myBinding.Security.Mode = BasicHttpSecurityMode.Transport; 
```

然后我通过了 SSL，但我的 SOAP 标头不再具有签名块。

有什么办法可以让我获得 HttpWebRequest 以便我可以像这样手动附加 SSL 客户端证书？

```
webRequest.ClientCertificates.Add(certLoader.Load(@"c:\somecert.pfx")); 
```

* * *

## 原始问题

我正在开发一个 WCF 客户端，该客户端需要与第三方提供的服务互操作，该第三方使用 Forum Sentry 网络设备来保护访问。它们需要 SSL 和传输级别的客户端证书，以及 o:Security 元素，其签名使用标头中的证书。我可以通过标准绑定实现其中一个或另一个，但我似乎无法同时实现两者。理想情况下，他们希望使用与 SSL 客户端证书不同的证书对消息进行签名，但他们说我们可以使用相同的证书进行 SSL 客户端身份验证和对消息进行签名。

在这一点上，我愿意做任何事情来完成这项工作，包括在必要时使用 CustomBinding。

我可以使用以下命令使 SSL 部分正常工作：

```
var myBinding = new BasicHttpBinding();
myBinding.Security.Mode = BasicHttpSecurityMode.Transport;
myBinding.Security.Transport.ClientCredentialType = HttpClientCredentialType.Certificate;
var url = "https://blah.com/services/somservice";
EndpointAddress ea = new EndpointAddress(url);
var client = new SoapClient(myBinding, ea);
var certLoader = new CertificateLoader("password");
client.ClientCredentials.ClientCertificate.Certificate = certLoader.Load(@"c:\somecert.pfx");
var resp = client.somemethod(ref profile, new RequestType { version = RequestTypeVersion.Item100 }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:41:03.073

请发布一个样品工作肥皂（例如供应商提供的一个）。顺便说一句，有比使用自定义绑定更剧烈的动作:)

编辑：要同时使用传输和消息安全性，您需要自定义绑定。谷歌的“wcf 绑定转换器”会自动执行此操作。在自定义绑定而不是 http 元素中将其更改为 https 并使用属性 requirevlientcertificate。对不起拼写我在手机上

编辑：

```
var c = new CustomBinding();            
MessageSecurityVersion version = MessageSecurityVersion.WSSecurity10WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10;
var sec = SecurityBindingElement.CreateCertificateOverTransportBindingElement(version);
c.Elements.Add(sec);
c.Element.Add(new TextMessageEncodingBindingElement() { MessageVersion = MessageVersion.Soap11 };)
c.Elements.Add(new HttpsTransportBindingElement() { RequireClientCertificate = true }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T13:55:54.617

这很丑陋，但可以完成工作。如果您在调试器中查看这些自定义绑定中的每一个的元素，您会发现即使它们的堆栈底部都有一个 HttpsTransportBindingElement，TransportWithMessageCredential 实例也会将 RequireClientCertificate 设置为 false 和几个其他私有成员与设置为假的证书有关。Transport 实例会将这些成员设置为 true。这显然是 WCF，IMO 中的错误。

下面的代码从 customTransportSecurityBinding 中获取“好”的 HttpsTransportBindingElement，并替换 customMessageCredentialBinding 中的“坏”元素。然后，您将修改后的 customMessageCredentialBinding 传递给您的客户端构造函数。

```
 var transportSecurityBinding = new BasicHttpBinding();
    transportSecurityBinding.Security.Mode = BasicHttpSecurityMode.Transport;
    transportSecurityBinding.Security.Transport.ClientCredentialType = HttpClientCredentialType.Certificate;
    transportSecurityBinding.Security.Message.ClientCredentialType = BasicHttpMessageCredentialType.Certificate;
    var customTransportSecurityBinding = new CustomBinding(transportSecurityBinding);

    var messageCredentialBinding = new BasicHttpBinding();
    messageCredentialBinding.Security.Mode = BasicHttpSecurityMode.TransportWithMessageCredential;
    messageCredentialBinding.Security.Transport.ClientCredentialType = HttpClientCredentialType.Certificate;
    messageCredentialBinding.Security.Message.ClientCredentialType = BasicHttpMessageCredentialType.Certificate;
    var customMessageCredentialBinding = new CustomBinding(messageCredentialBinding);

    // replace transport binding element from message credential binding with the transportSecurityBinding transport binding
    // which will include the cert for SSL mutual auth.
    customTransportSecurityBinding.Elements[customTransportSecurityBinding.Elements.Count - 1] = customMessageCredentialBinding.Elements[customMessageCredentialBinding.Elements.Count - 1];

var client = new SomeSoapClient(customTransportSecurityBinding, ea); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-10T11:45:38.940

如果有人为上述答案寻找 app.config 版本的自定义绑定：

```
<bindings>
      <customBinding>
        <binding name="SignedMessageBinding">
          <security messageSecurityVersion="WSSecurity10WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10" /> 
          <textMessageEncoding messageVersion="Soap11" />
          <httpsTransport requireClientCertificate="true"  />
        </binding>
      </customBinding>
</bindings> 
```

# asp.net - 制作一个可在 ASP.Net 中的多个页面上使用的弹出窗口

> ID：10688825
> 
> 赞同：2
> 
> 时间：2012-05-21T16:18:40.823
> 
> 标签：asp.net, asp.net-ajax

我在 ASP 中有两个 Web 表单页面，一个用于查看记录，另一个用于编辑它。我想在每个链接上都有一个链接，它会弹出一个框以允许编辑记录上的某个属性。如果我只将它放在 Edit 页面上，我会使用 UpdatePanel，但如果我还想将它放在 View 页面上，我将不得不复制和粘贴代码。有没有办法让代码在一个区域中可以从两个页面引用和使用？

*编辑*：我知道我可以制作一个自定义控件来处理它，尽管它会在页面首次加载时包含页面上的所有 HTML，而不是在单击链接时。

*Edit2*：我想避免在页面首次加载时呈现弹出窗口的内容，但现在我意识到这只是在回发发生之前不绑定任何数据的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T15:32:31.377

您可以为这两个页面使用 MasterPage，并将带有 UpdatePanel 的弹出窗口放在母版页上，这样您就可以从两个页面访问它。

希望能帮助到你。如果它解决了您的问题，请不要忘记支持它。谢谢.. ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T15:36:09.000

使面板的大部分成为用户控件 (ascx)。然后在你需要它的两个页面上放一个薄的包装纸。大部分代码都在 ascx 和 ascx.vb 中，不需要编写两次。

# qt - 在 OpenGL 中为 Qt 项目绘制轴文本标签

> ID：10688827
> 
> 赞同：0
> 
> 时间：2012-05-21T16:18:44.130
> 
> 标签：qt, opengl, text, drawing, rendering

我在左下角有一个 x、y、z 轴，让用户了解方向。我想用适当的 x、y 和 z 标签标记这些轴。

我知道我不想使用 Glut 来完成这个，因为它已经过时了，我想知道我是否可以利用 QPainter 来帮助标记这些轴。

注意：我看过这个，但发现太多了：http: [//nehe.gamedev.net/tutorial/bitmap_fonts/17002/](http://nehe.gamedev.net/tutorial/bitmap_fonts/17002/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:39:59.573

您可以使用 QPainter 在任何绘图设备上绘制文本。QGLWidget 就是这样一个绘图设备；QPainter 然后将使用 OpenGL 来绘制文本（或任何你想绘制的东西）。猜测您正在使用 QGLWidget 来绘制场景，您可以将 QPainter 的内容放在您的paintEvent 的末尾：

```
MyGLWidget::paintEvent(QPaintEvent *event)
{
    // draw OpenGL scene
    // ...

    // draw labels:
    QPainter p(this);
    p.drawText(..., ..., "X");
    p.drawText(..., ..., "Y");
    p.drawText(..., ..., "Z");
    p.end();
} 
```

还可以查看[Qt OpenGL Overpainting Example](http://qt-project.org/doc/qt-4.8/opengl-overpainting.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:46:45.720

因为（您说过）由于某种原因您无法访问 QPainter，所以您需要某种用于 OpenGL 的字体渲染库。您可以使用[FTGL ，也可以使用](http://homepages.paradise.net.nz/henryj/code/)[freetype 2](http://www.freetype.org/freetype2/index.html)制作自己的渲染器。从 Qt 4.8.1 版开始，应该可以使用[QRawFont](http://qt-project.org/doc/qt-4.8/qrawfont.html)访问单个字形（无需直接处理 freetype），这可以使您自己的字体渲染例程更容易实现。

如果您的对象是 QPaintDevice 或 QGLWidget，则使用 QPainter。它可能比传统的纹理字体慢，但它会让你（免于）另一个编码难题。

# c++ - 大写单词的最快方法

> ID：10688831
> 
> 赞同：8
> 
> 时间：2012-05-21T16:18:54.473
> 
> 标签：c++, boost, stdstring

使用 C++ 大写单词（std::string）的最快方法是什么？

在使用带有 -O3 标志的 g++ 4.6.3 的 Debian Linux 上，此函数使用`boost::to_lower`将在 AMD Phenom(tm) II X6 1090T 处理器 (3200 MHz) 上的单个执行线程中在大约 24 秒内大写 81,450,625 个字。

```
void Capitalize( std::string& word )
{
    boost::to_lower( word );
    word[0] = toupper( word[0] );
} 
```

这个函数使用`std::transform`大约 10 秒做同样的事情。我在测试之间清除了虚拟机，所以我不认为这种差异是侥幸：

`sync && echo 3 > /proc/sys/vm/drop_caches`

```
void Capitalize( std::string& word )
{
    std::transform(word.begin(), word.end(), word.begin(), ::tolower);
    word[0] = toupper( word[0] );
} 
```

有更快的方法吗？我不想为了速度而失去可移植性，但是如果有更快的方法可以在 std C++ 或带有 boost 的 std C++ 中工作，我想尝试一下。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-06-23T12:26:13.757

在处理不能保证输入为大写的 DNA 序列以及`boost::to_upper`代码中的瓶颈在哪里时，有这个确切的问题。更改为：

```
template<typename T_it>
void SequenceToUpperCase( T_it begin, T_it end )
{
    // Convert to upper: clear the '32' bit, 0x20 in hex. And with the
    // inverted bit string (~).
    for ( auto it = begin; it != end; ++it )
        *it &= ~0x20;
} 
```

带来了巨大的速度提升。我确信可以通过例如一次翻转 8 个字节来进一步优化，但是使用上面的代码，大写对我们来说几乎是瞬时的。对于小写：做：

```
 *it |= 0x20; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T17:37:03.387

使其更快的几种方法：
1\. 不要使用`to_lower`，它很慢。也不要使用`if`s，创建一个包含 256 个条目的表，这些条目从字符映射到其小写版本，另一个表用于大写。
2.不要使用`transform`，取一个指向第一个字符的指针并循环直到空终止符。
3\. 如果内存不是问题，请使用映射 2 个字符序列的表。在这种情况下，您将需要另一个处理终止的表。
4.如果你能在汇编中做到这一点，它会快得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T17:16:53.397

如果大写是一个**真正**的瓶颈，那么使用手写循环和内联 toupper/tolower 函数编写自己的大写实现。如有必要，请使用 ASM。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-09T16:57:04.827

我有一个实现，我发现它比 std::transform 更快，在 g++ -03 Fedora 18 中编译。

```
以秒为单位的表演时间：
转换耗时：11 秒
我的实施耗时：2 s
测试数据大小 = 26*15*9999999 个字符

```

```
inline void tolowerPtr(char *p) ;

inline void tolowerStr(std::string& s)
{char* c=const_cast<char*>(s.c_str());
size_t l = s.size();
  for(char* c2=c;c2<c+l;c2++)tolowerPtr(c2); 
};

inline void tolowerPtr(char *p) 
{
switch(*p)
{
  case 'A':*p='a'; return;
  case 'B':*p='b'; return;
  case 'C':*p='c'; return;
  case 'D':*p='d'; return;
  case 'E':*p='e'; return;
  case 'F':*p='f'; return;
  case 'G':*p='g'; return;
  case 'H':*p='h'; return;
  case 'I':*p='i'; return;
  case 'J':*p='j'; return;
  case 'K':*p='k'; return;
  case 'L':*p='l'; return;
  case 'M':*p='m'; return;
  case 'N':*p='n'; return;
  case 'O':*p='o'; return;
  case 'P':*p='p'; return;
  case 'Q':*p='q'; return;
  case 'R':*p='r'; return;
  case 'S':*p='s'; return;
  case 'T':*p='t'; return;
  case 'U':*p='u'; return;
  case 'V':*p='v'; return;
  case 'W':*p='w'; return;
  case 'X':*p='x'; return;
  case 'Y':*p='y'; return;
  case 'Z':*p='z'; return;
};
return ;
}

void testtransform( std::string& word )
{
std::string word2=word; 
time_t t;
time_t t2;
time(&t);
std::cout << "testtransform: start " << "\n";
int i=0;
for(;i<9999999;i++) 
{    word2=word;
    std::transform(word2.begin(), word2.end(), word2.begin(), ::tolower);
}
time(&t2);
std::cout << word2 << "\n";
std::cout << "testtransform: end " << i << ":"<< t2-t << "\n";
}

void testmytolower( std::string& word )
{
std::string word2=word; 
time_t t;
time_t t2;
time(&t);
std::cout << "testmytolower: start " << "\n";
int i=0;
for(;i<9999999;i++)
{   word2=word;
    cstralgo::tolowerStr(word2);
}
time(&t2);
std::cout << word2 << "\n";
std::cout << "testmytolower: end " << i << ":"<< t2-t << "\n";
}

int main(int argc, char* argv[])
{
   std::string word ="ABCDEFGHIJKLMNOPQRSTUVWXYZ";
   word =word+word+word+word+word+word+word+word+word+word+word+word+word+word+word;
   testtransform( word);
   testmytolower( word);
   return 0;
} 
```

我很高兴知道性能是否可以进一步提高。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-23T14:35:41.157

I would use a for loop to go through the entire string, character by character, parsing them to a function to convert to uppercase. To hopefully speed things up, I'll write the capitalisation function in assembly. The C++ component of the application would be like so:

```
#include <iostream>
#include <string>

extern "C" char asm_capt(char x);

using namespace std;

int main(void)
{
    string str;
    cin >> str;
    string tmp = str;

    for(int i=0; i<str.length(); i++){

        tmp.at(i) = asm_capt(str.at(i));
    }

} 
```

Now comes the assembly part; I'll assume you are using Windows and the MASM compiler. The code should be saved within a .asm source file, and included in the project with MASM build settings:

```
.model flat
.code
_asm_capt proc

    mov rax, rcx
    cmp rax, 61h
    jl already_capt

    sub rax, 20h
    ret

    already_capt:

    ret

_asm_capt endp
end 
```

Essentially, it checks if the character (in hexadecimal) is less than 0x61, which would imply, if you only use letters, that it is already capitalised. otherwise, the value is decreased by 0x20, which moves it to the lower case equivalent. (See ASCII table.)

* * *

**Note:** By default, the return parameter is stored in the RAX register; the first parameter passed by C++ to assembly is stored in RCX.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-10-03T09:17:58.580

Required pseudocode would be:

```
 for(int i=0 to given_str.length)

{ upper[i]=(char*)given_str[i]-32;  // in ascii tbl, any lower case char - upper case char=32

}

return upper; 
```

# php - 如果我想将 PHP/MySQL“测验”应用程序迁移到独立项目，我应该使用什么方法？

> ID：10688832
> 
> 赞同：-1
> 
> 时间：2012-05-21T16:18:58.403
> 
> 标签：php, windows

我为学习目的开发了一个基于 PHP / MySQL 的测试引擎。我想将此功能迁移到一个独立的应用程序，用于无法在 Web 上公开发布的内容。

总的来说，我对 PHP 作为一门语言非常流利，并且使用它感到非常自在。你们中的任何人都可以建议一些更简单的开发路径可供选择吗？我考虑过 C#，但我认为除了来自 PHP 的语言的学习曲线（命名空间、公共/私有函数等）之外，这对于我想做的事情来说可能有点过头了。

tl;dr：如果您已经熟悉 PHP，那么编写独立 Windows 应用程序最简单的语言是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:23:34.643

为什么不运行本地 Web 服务器并在那里运行您的工具？它不在公共网络上，因此您可以将敏感代码保持在离线状态，而无需触摸您的代码。您可以使用[Xampp](http://www.apachefriends.org/en/xampp.html)等工具在 PC 上快速安装所需的所有 Web 服务器工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:25:45.397

[http://www.exeoutput.com/](http://www.exeoutput.com/)

这将使您的 php 网站成为可执行文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:21:41.040

我会推荐 Java，因为它很简单，而且 MySQL 很容易使用它。但总的来说，在开发桌面应用程序时，您不会找到太多类似于 PHP 的语言。

# ruby - Ruby Mongo：如何禁用某些集合的日志记录？

> ID：10688840
> 
> 赞同：0
> 
> 时间：2012-05-21T16:19:24.247
> 
> 标签：ruby, mongodb, mongoid

我正在使用 Mongoid 与 MongoDB 进行交互。在开发过程中，我通常喜欢查看 Mongo 正在做什么的日志。但是，有一种情况是我根本不想看到过多的冗余日志记录。在这种特定情况下，如何禁用日志记录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T19:23:21.643

似乎没有任何干净的方法可以在每个集合的基础上控制 Mongoid 的日志记录。但是，出于您的目的，如果您能够识别各个呼叫，则可以通过提高级别来暂时关闭日志记录。希望这足以满足您的目的。

```
require 'test_helper'

def dont_log(temp_level = Logger::Severity::UNKNOWN)
  logger = Rails.logger
  old_level, logger.level = logger.level, temp_level
  yield
  logger.level = old_level
end

class LogDoTest < ActiveSupport::TestCase
  def setup
    LogDo.delete_all
    LogDont.delete_all
  end

  test "log do dont" do
    LogDo.create(text: 'Log me')
    dont_log{ LogDont.create(text: 'Dont log me') }
  end
end 
```

# ruby - 如何使用 ruby 将 ec2 实例详细信息传递给 sqlite db？

> ID：10688841
> 
> 赞同：1
> 
> 时间：2012-05-21T16:19:28.217
> 
> 标签：ruby, activerecord, sqlite, amazon-ec2, amazon-web-services

我有以下代码：

```
require 'rubygems'
require 'aws-sdk'
require 'sqlite3'
require 'active_record'

db = SQLite3::Database.new('awsec2.db')

ActiveRecord::Base.establish_connection(
  :adapter=> "sqlite3",
  :database=> "awsec2")

ActiveRecord::Schema.define do
  create_table :instances do |t|
   t.column :instance_id, :string
   t.column :status, :string
  end
end

ACCESS_KEY_ID = '.......................'
SECRET_ACCESS_KEY = '....................'

ec2 = AWS::EC2.new(:access_key_id => ACCESS_KEY_ID, :secret_access_key => SECRET_ACCESS_KEY)

ec2.instances.inject({}) { |m, i| m[i.id] = i.status; m } # How to pass those items to the instances table 
```

如何将ec2.instances方法收集的数据存储到数据库表中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T01:19:52.510

这是亚马逊制作的[元数据查询工具。](http://aws.amazon.com/code/1825?_encoding=UTF8&jiveRedirect=1)它只是一个从[元数据 url](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/AESDG-chapter-instancedata.html)获取数据的帮助脚本。

# python - 尝试安装 Scrapy - 错误：找不到“openssl.exe”

> ID：10688843
> 
> 赞同：5
> 
> 时间：2012-05-21T16:19:32.443
> 
> 标签：python, pip, scrapy, pyopenssl

关于如何解决这个问题的任何想法？我正在使用 pip 在 Win XP Pro SP 3 机器上安装 Scrapy。我在机器上安装了 Python 2.7。pyOpenSSL 似乎有问题。我收到“找不到‘openssl.exe’”错误。

这是我的日志文件。由于其中的 URL，我不得不对其进行一些修改。

* * *

```
Requirement already satisfied (use --upgrade to upgrade): Scrapy in c:\python27\lib\site-packages\scrapy-0.14.4-py2.7.egg

Requirement already satisfied (use --upgrade to upgrade): Twisted>=2.5 in c:\python27\lib\site-packages (from Scrapy)

  Downloading from URL pypi.python.org/packages/source/w/w3lib/w3lib-1.2.tar.gz#md5=f929d5973a9fda59587b09a72f185a9e (from pypi.python.org/simple/w3lib/)
  Running setup.py egg_info for package w3lib

    running egg_info
    creating pip-egg-info\w3lib.egg-info
    writing pip-egg-info\w3lib.egg-info\PKG-INFO
    writing top-level names to pip-egg-info\w3lib.egg-info\top_level.txt
    writing dependency_links to pip-egg-info\w3lib.egg-info\dependency_links.txt
    writing manifest file 'pip-egg-info\w3lib.egg-info\SOURCES.txt'
    warning: manifest_maker: standard file '-c' not found

    reading manifest file 'pip-egg-info\w3lib.egg-info\SOURCES.txt'
    writing manifest file 'pip-egg-info\w3lib.egg-info\SOURCES.txt'
  Source in c:\ray\dist\pip-1.1\build\w3lib has version 1.2, which satisfies requirement w3lib (from Scrapy)
Downloading/unpacking pyOpenSSL (from Scrapy)

  Downloading from URL pypi.python.org/packages/source/p/pyOpenSSL/pyOpenSSL-0.13.tar.gz#md5=767bca18a71178ca353dff9e10941929 (from pypi.python.org/simple/pyOpenSSL/)
  Running setup.py egg_info for package pyOpenSSL

    running egg_info
    creating pip-egg-info\pyOpenSSL.egg-info
    writing pip-egg-info\pyOpenSSL.egg-info\PKG-INFO
    writing top-level names to pip-egg-info\pyOpenSSL.egg-info\top_level.txt
    writing dependency_links to pip-egg-info\pyOpenSSL.egg-info\dependency_links.txt
    writing manifest file 'pip-egg-info\pyOpenSSL.egg-info\SOURCES.txt'
    warning: manifest_maker: standard file '-c' not found

    error: Could not find 'openssl.exe' 
```

命令 python setup.py egg_info 的完整输出：

```
running egg_info

creating pip-egg-info\pyOpenSSL.egg-info

writing pip-egg-info\pyOpenSSL.egg-info\PKG-INFO

writing top-level names to pip-egg-info\pyOpenSSL.egg-info\top_level.txt

writing dependency_links to pip-egg-info\pyOpenSSL.egg-info\dependency_links.txt

writing manifest file 'pip-egg-info\pyOpenSSL.egg-info\SOURCES.txt'

warning: manifest_maker: standard file '-c' not found

error: Could not find 'openssl.exe' 
```

* * *

```
Command python setup.py egg_info failed with error code 1 in C:\Ray\dist\pip-1.1\build\pyOpenSSL

Exception information:
Traceback (most recent call last):
  File "C:\Python27\lib\site-packages\pip-1.1-py2.7.egg\pip\basecommand.py", line 104, in main
    status = self.run(options, args)
  File "C:\Python27\lib\site-packages\pip-1.1-py2.7.egg\pip\commands\install.py", line 245, in run
    requirement_set.prepare_files(finder, force_root_egg_info=self.bundle, bundle=self.bundle)
  File "C:\Python27\lib\site-packages\pip-1.1-py2.7.egg\pip\req.py", line 1009, in prepare_files
    req_to_install.run_egg_info()
  File "C:\Python27\lib\site-packages\pip-1.1-py2.7.egg\pip\req.py", line 225, in run_egg_info
    command_desc='python setup.py egg_info')
  File "C:\Python27\lib\site-packages\pip-1.1-py2.7.egg\pip\__init__.py", line 256, in call_subprocess
    % (command_desc, proc.returncode, cwd))
InstallationError: Command python setup.py egg_info failed with error code 1 in C:\Ray\dist\pip-1.1\build\pyOpenSSL 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T02:45:27.397

您可以转到[http://pypi.python.org/pypi/pyOpenSSL/0.13](http://pypi.python.org/pypi/pyOpenSSL/0.13)并下载 Windows 安装程序，然后继续您的 scrapy 安装。

# maven - 在 Jetty 中部署多个战争

> ID：10688846
> 
> 赞同：0
> 
> 时间：2012-05-21T16:19:43.973
> 
> 标签：maven, plugins, deployment, jetty

我正在使用 jetty maven 插件来部署一些战争。我有 2 个模块： moduleA.war 在端口 8180 moduleB.war 在端口 8380

当我使用 maven jetty 插件部署战争时，两个 webapps 都试图在端口 8180 上运行，即使我正在为这两个应用程序设置连接器。这是我执行此操作的 pom 配置：

```
<plugin>
            <groupId>org.mortbay.jetty</groupId>
            <artifactId>jetty-maven-plugin</artifactId>
            <version>7.1.3.v20100526</version>
            <configuration>
                <connectors>
                    <connector implementation="org.eclipse.jetty.server.nio.SelectChannelConnector">
                        <port>8180</port>
                        <name>instance_8180</name>                      
                    </connector>
                    <connector implementation="org.eclipse.jetty.server.nio.SelectChannelConnector">
                        <port>8380</port>
                        <name>instance_8380</name>
                    </connector>
                </connectors>                   
                <contextHandlers>
                    <!-- <contextHandler implementation="org.mortbay.jetty.plugin.JettyWebAppContext"> -->
                    <contextHandler implementation="org.eclipse.jetty.webapp.WebAppContext">
                        <war>/${project.build.directory}/user-mgmt-web-1.0-SNAPSHOT.war</war> 
                        <contextPath>/user-mgmt-web</contextPath>
                        <connectorNames>
                            <item>instance_8180</item>
                        </connectorNames>
                    </contextHandler>
                    <!-- <contextHandler implementation="org.mortbay.jetty.plugin.JettyWebAppContext"> -->
                    <contextHandler implementation="org.eclipse.jetty.webapp.WebAppContext">
                        <war>/${project.build.directory}/services-web-1.0-SNAPSHOT.war</war> 
                        <contextPath>/services-web</contextPath>
                        <connectorNames>
                            <item>instance_8380</item>
                        </connectorNames>
                    </contextHandler>
                </contextHandlers>
                <stopPort>80</stopPort>
                <stopKey>stop</stopKey>
            </configuration>
            <executions>
                <execution>
                    <id>start-container</id>
                    <phase>pre-integration-test</phase>
                    <goals>
                        <goal>stop</goal>
                        <goal>run</goal>
                    </goals>
                    <configuration>
                        <scanIntervalSeconds>0</scanIntervalSeconds>
                        <daemon>true</daemon>
                    </configuration>
                </execution>
                <execution>
                    <id>stop-container</id>
                    <phase>post-integration-test</phase>
                    <goals>
                        <goal>stop</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

我想知道如何使部署的第二个 webapp 从其分配的端口开始。当我运行它时，当容器完成初始化第二个 webapp 时，我得到一个地址已经在使用中的错误。

阿萨内

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T05:48:23.347

我认为具有两个不同端口的两个不同模块仅在多个实例中工作，在您的情况下，仅激活第一个端口号为第一个端口设置空闲超时。

```
<port>8180</port>
<maxIdleTime>"put your time"</maxIdleTime> 
```

然后启动另一个端口。

如果上面不起作用，请尝试下面的这个

在你的 jetty.xml 添加新的连接器

```
<!-- original connector on port 8080 -->
<Call name="addConnector">
  <Arg>
      <New class="org.eclipse.jetty.server.nio.SelectChannelConnector">
        <Set name="host"><Property name="jetty.host" /></Set>
        <Set name="port"><Property name="jetty.port" default="8080"/></Set>
        <Set name="maxIdleTime">300000</Set>
        <Set name="Acceptors">2</Set>
        <Set name="statsOn">false</Set>
        <Set name="confidentialPort">8443</Set>
    <Set name="lowResourcesConnections">20000</Set>
    <Set name="lowResourcesMaxIdleTime">5000</Set>
      </New>
  </Arg>
</Call>

<!-- new connector on port 8081 --> 
<Call name="addConnector">
  <Arg>
      <New class="org.eclipse.jetty.server.nio.SelectChannelConnector">
        <Set name="host"><Property name="jetty.host" /></Set>
        <Set name="port"><Property name="jetty.port" default="8081"/></Set>
        <Set name="maxIdleTime">300000</Set>
        <Set name="Acceptors">2</Set>
        <Set name="statsOn">false</Set>
    <Set name="lowResourcesConnections">20000</Set>
    <Set name="lowResourcesMaxIdleTime">5000</Set>
      </New>
  </Arg>
</Call> 
```

# ubuntu - Ubuntu Unity：与全局菜单栏集成

> ID：10688847
> 
> 赞同：4
> 
> 时间：2012-05-21T16:19:57.467
> 
> 标签：ubuntu, ubuntu-unity, ubuntu-12.04

在 Ubuntu Unity 下运行时，我可以从哪里开始研究如何为非 Gtk 应用程序添加菜单栏集成？使用诸如“ubuntu unity menu bar integration”之类的关键字进行一些快速的 Google 搜索并没有发现任何有趣的东西。

很高兴知道是否要为例如 SDL 应用程序创建菜单，或者我是否想将 GNUstep 的菜单集成到 Unity 中。

* * *

看起来我需要调查“dbusmenu”项目和“com.canonical.dbusmenu”界面。有人对此有很好的文档吗？

* * *

[此代码](http://java-swing-ayatana.googlecode.com/svn-history/r10/trunk/jayatana/jayatana/org_java_ayatana_ApplicationMenu.c)中提供了一些有用的代码，这些代码将 Java Swing 菜单与 DBusMenu 集成在一起。它来自[java-swing-ayatana](http://code.google.com/p/java-swing-ayatana)项目，该项目似乎旨在改进 Swing 应用程序与 Ubuntu 的集成。

* * *

[我在MiniDbus-Menu](https://bitbucket.org/ivucica/minidbus-menu/overview)中写了一些代码。（是的，我不小心将存储库命名不一致。起诉我。:-) 它附带了一些关于我在 README.md 中的探索的注释。

不幸的是，代码还没有工作，所以这个问题仍然悬而未决。**我很想知道我在代码中做错了什么！**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T11:53:31.953

[您可以在Ask Ubuntu](http://askubuntu.com)中阅读此问题：

*   [如何向 python 非 GTK、非 QT 应用程序添加对全局菜单的支持](https://askubuntu.com/questions/98692/how-to-add-support-for-the-global-menu-to-a-python-non-gtk-non-qt-app)

dbusmenu-glib 的作者 Ted Gould 给出了一些关于如何将您的应用程序菜单连接到全局菜单栏的指示。我可以改写他的答案，但我认为您最好实际阅读链接的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-08T04:33:20.450

要使其与 Java 应用程序一起使用，请查看此博客上的解决方案 2：

[将 Java Swing 应用程序与 Unity 全局菜单集成](http://hanynowsky.wordpress.com/2012/05/12/integration-of-java-swing-applications-with-unity-global-menu-in-ubuntu-12-04/)

# iphone - 如何从 AppDelegate 上的 TabBarController 获取 ViewController？

> ID：10688848
> 
> 赞同：12
> 
> 时间：2012-05-21T16:19:57.810
> 
> 标签：iphone, ios, ipad, ios5

我使用iOS5故事板，我的初始视图控制器是`TabBarController`，view1&view2&view3&view4有四种关系，那么，我怎样才能得到view3的视图控制器呢？

我试过：

```
[[[[self.window.rootViewController navigationController] tabBarController] viewControllers] objectAtIndex:2]; 
```

但它不起作用...

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-05-21T16:39:20.553

您说您的初始（根）视图控制器是 UITabBarController 但您指的是带有导航控制器和标签栏控制器的视图控制器。您是否在视图控制器层次结构中混淆了？

编辑：

如果您的根视图控制器实际上只是一个选项卡栏控制器，并且您想获得第三个选项卡，则代码如下：

```
[[((UITabBarController *)self.window.rootViewController) viewControllers] objectAtIndex:2]; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-04T10:41:54.777

```
[self.tabBarController setSelectedIndex:2]; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-11-11T14:33:42.333

试试这个方法

在任何视图控制器中

```
 YourViewController *yourViewController= (YourViewController*)  [self.tabBarController.viewControllers objectAtIndex:3]; 
```

这将返回您的视图控制器对象。将其转换为您的视图控制器，您就可以使用它了。跑就跑

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-02-06T11:34:41.733

斯威夫特 4.0

```
let viewC = self?.tabBarController.viewControllers.first // will give single Navigation Controller on index 0
let viewC = self?.tabBarController?.viewControllers// will give array of Navigation Controller 
```

此外，您可以检查 Visible ViewController

```
if let nav = viewC as? UINavigationController {
   if nav.visibleViewController is YourViewControllerName{
        // Do Code
     }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-01-23T14:41:54.653

```
 UIViewController *loginViewController=self.window.rootViewController;

   UITabBarController *controller=loginViewController.tabBarControllerObj;

   UIViewController *selectedController=controller.selectedViewController; 
```

从中您将获得选定的视图控制器。

要获取所有视图控制器，只需替换

```
NSArray *viewControllers = [controller viewControllers]; 
```

# apple-push-notifications - APNS 服务器的 IP 地址范围？

> ID：10688852
> 
> 赞同：9
> 
> 时间：2012-05-21T16:20:11.867
> 
> 标签：apple-push-notifications

是否有人拥有 Apple 推送通知服务使用的所有 IP 地址的完整列表？

我知道 Apple 使用内容交付网络来分发这些请求，并且 DNS 查找将返回靠近请求者位置的服务器 - 我遇到的问题是定位所有这些处理美国内容的服务器。

例如：

```
$ nslookup gateway.push.apple.com

Non-authoritative answer:
canonical name = gateway.push-apple.com.akadns.net.

Address: 17.172.238.216
Address: 17.172.238.224
Address: 17.172.238.226 
```

等等

每次我查询 DNS 时，此列表都会更改 - 但所有地址似乎都在同一个 17.172.238.x 范围内 - 但不能保证明天或下周我会看到不同的范围。

但是，对于测试推送服务器，我已经在不同的子网中获得了结果。有时我会得到一组地址：

```
$ nslookup gateway.sandbox.push.apple.com

Non-authoritative answer:
canonical name = gateway.sandbox.push-apple.com.akadns.net.

Address: 17.149.34.66
Address: 17.149.34.65 
```

其他时候，我会得到这些地址：

```
Address: 17.172.233.65
Address: 17.172.233.66 
```

我将使用 Apple 推送通知服务的服务器将位于公司防火墙后面，我需要为生产和测试网关打开端口 2195 和 2196——但是，我的防火墙团队需要特定的 IP 地址而不是主机名.

我担心如果我只是要求防火墙团队允许我到目前为止看到的 IP 地址，那么当 DNS 服务器决定提供不同的范围时，我的服务器将在一天或一周后停止工作。

如果有人有生产和测试环境的完整列表，我将不胜感激。

**更新：** 我曾尝试要求防火墙团队打开 Apple 的整个 IP 块 (17.0.0.0/8)，但他们不会为我这样做——我需要稍微缩小地址范围。

**最终更新 - 2016 年 10 月 16 日**

即使这个问题已经结束，我想我会添加一个注释来解释我的最终解决方案 - 这不是任何寻找答案的人想要听到的。我永远无法超越 CDN 使用的不断变化的地址，所以我最终放弃并从 Rackspace 租用了外部服务器。我得到了最小的服务器，唯一运行在它上面的是一个端口转发器，它监听 2195 和 2916 并将连接发送到 Apple。

我在 Rackspace 服务器上使用了一个简单的 iptables 配置，只允许来自公司网关的 2195/2916 连接，然后让我的防火墙团队在外部服务器上打开到静态 IP 地址的路径。防火墙团队很高兴，实现了单一路径，外部服务器可以连接到 Apple 使用的整个 17.0.0.0/8 范围。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-21T16:22:40.437

来自[Apple 的文档](http://developer.apple.com/library/ios/#technotes/tn2265/_index.html%23//apple_ref/doc/uid/DTS40010376-CH1-TNTAG41)（强调添加的有趣部分）：

> 推送提供程序、iOS 设备和 Mac 计算机通常位于防火墙后面。要发送通知，您需要打开 TCP 端口 2195。要访问反馈服务，您需要打开 TCP 端口 2196。通过 Wi-Fi 连接到推送服务的设备和计算机需要打开 TCP 端口 5223。
> 
> 推送服务的IP地址范围可能会发生变化；期望提供商将通过主机名而不是 IP 地址进行连接。推送服务使用负载平衡方案，为相同的主机名生成不同的 IP 地址。*但是，整个 17.0.0.0/8 地址块已分配给 Apple，因此您可以在防火墙规则中指定该范围。*

17.0.0.0/8 是 17.0.0.1 到 17.255.255.254 的 CIDR 表示法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-30T22:36:19.533

不幸的是，官方的答案是没有官方的答案:)——除非你考虑到苹果公司相当草率的做法，即简单地允许所有流量到 17.0.0.0/8。Apple 开发人员支持在第一个答案中提供了与*vcsjones*相同的文档链接。

对于我的特殊情况，在过去几周定期检查 DNS 后，我已将 IP 地址缩小到这些范围。请记住，**这些仅对美国中西部地区有效**，因为 Apple 的 CDN 将返回一组最接近进行查询的服务器的地址。

对于 gateway.push.apple.com，我在防火墙上打开端口 2195 和 2196 用于：

```
17.149.35.0 / 24
17.172.238.0 / 24 
```

对于 gateway.sandbox.push.apple.com，我在防火墙上打开端口 2195 和 2196 用于：

```
17.149.34.66
17.149.34.65
17.172.233.65
17.172.233.66 
```

由于这些地址显然会发生变化，因此我为我的应用程序构建了一些监控，以检测何时无法访问 APNS 服务器（并回退到这些地址范围而不是使用 DNS）。这不是理想的解决方案，但它现在可以工作，直到我可以与我的公司网络/防火墙团队一起制定解决方案......

# java - 使用 JWNL 使用 WordNet 提取词干 - 无法安装字典

> ID：10688854
> 
> 赞同：1
> 
> 时间：2012-05-21T16:20:20.237
> 
> 标签：java, api, dictionary, filenotfoundexception, wordnet

我正在尝试使用带有 JWNL API 的 WordNet 来阻止字符串。当我尝试加载字典时，它给了我一个 FileNotFoundException。

这是初始化字典的代码：

```
public static void Initializer(){
    try {
        JWNL.initialize(new FileInputStream("file_properties.xml"));
        dictionary = Dictionary.getInstance();
        morphPro = dictionary.getMorphologicalProcessor();
    }
    catch(FileNotFoundException e){
        e.printStackTrace();

    } catch (JWNLException e) {
        e.printStackTrace();
    }
} 
```

这就是我得到的：

```
net.didion.jwnl.JWNLException: Unable to install net.didion.jwnl.dictionary.FileBackedDictionary
    at net.didion.jwnl.util.factory.Element.install(Element.java:34)
    at net.didion.jwnl.JWNL.initialize(JWNL.java:169)
    at Algorithms.Stemmer.Initializer(Stemmer.java:54)
    at Algorithms.Stemmer.WordStemmer(Stemmer.java:33)
    at Algorithms.Stemmer.StringStemmer(Stemmer.java:26)
    at GUI.ButtonListener.actionPerformed(ButtonListener.java:167)
    at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
    at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(Unknown Source)
    at java.awt.Component.processMouseEvent(Unknown Source)
    at javax.swing.JComponent.processMouseEvent(Unknown Source)
    at java.awt.Component.processEvent(Unknown Source)
    at java.awt.Container.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$000(Unknown Source)
    at java.awt.EventQueue$1.run(Unknown Source)
    at java.awt.EventQueue$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
Caused by: net.didion.jwnl.JWNLException: The properties file must specify a dictionary path
    at net.didion.jwnl.util.factory.AbstractValueParam.create(AbstractValueParam.java:34)
    at net.didion.jwnl.dictionary.FileBackedDictionary.install(FileBackedDictionary.java:111)
    at net.didion.jwnl.util.factory.Element.install(Element.java:32) 
```

我很确定它与路径有关，但我无法确切找出问题所在，因为我更改了`properties.xml`要使用的文件`C:\WordNet\2.1\dict\`- 所以应该没问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-30T19:15:04.847

将版本号更改为`file_properties.xml`正确的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-04T11:49:50.987

我也遇到了同样的问题。错误是：

```
gate.creole.ResourceInstantiationException: net.didion.jwnl.JWNLException: Unable to install net.didion.jwnl.dictionary.FileBackedDictionary
    at gate.wordnet.JWNLWordNetImpl.init(JWNLWordNetImpl.java:62)
    at gate.Factory.createResource(Factory.java:432)
    at gate.Factory.createResource(Factory.java:139)
    at WordNetApp.main(WordNetApp.java:45)
Caused by: net.didion.jwnl.JWNLException: Unable to install net.didion.jwnl.dictionary.FileBackedDictionary
    at net.didion.jwnl.util.factory.Element.install(Element.java:34)
    at net.didion.jwnl.JWNL.initialize(JWNL.java:169)
    at gate.wordnet.JWNLWordNetImpl.init(JWNLWordNetImpl.java:57)
    ... 3 more
Caused by: net.didion.jwnl.JWNLException: The properties file must specify a dictionary path
    at net.didion.jwnl.util.factory.AbstractValueParam.create(AbstractValueParam.java:34)
    at net.didion.jwnl.dictionary.FileBackedDictionary.install(FileBackedDictionary.java:111)
    at net.didion.jwnl.util.factory.Element.install(Element.java:32)
    ... 5 more
Caused by: net.didion.jwnl.JWNLException: Could not create a file manager of type class net.didion.jwnl.princeton.file.PrincetonRandomAccessDictionaryFile
    at net.didion.jwnl.dictionary.file_manager.FileManagerImpl.create(FileManagerImpl.java:98)
    at net.didion.jwnl.util.factory.AbstractValueParam.create(AbstractValueParam.java:32)
    ... 7 more
Caused by: 
```

> java.io.FileNotFoundException: C:\Program Files\WordNet\index.verb

```
(The system cannot find the file specified)
        at java.io.RandomAccessFile.open(Native Method)
        at java.io.RandomAccessFile.<init>(Unknown Source)
        at net.didion.jwnl.princeton.file.PrincetonRandomAccessDictionaryFile.openFile(PrincetonRandomAccessDictionaryFile.java:76)
        at net.didion.jwnl.dictionary.file.AbstractDictionaryFile.open(AbstractDictionaryFile.java:58)
        at net.didion.jwnl.dictionary.file.DictionaryCatalog.open(DictionaryCatalog.java:45)
        at net.didion.jwnl.dictionary.file.DictionaryCatalogSet.open(DictionaryCatalogSet.java:34)
        at net.didion.jwnl.dictionary.file_manager.FileManagerImpl.<init>(FileManagerImpl.java:71)
        at net.didion.jwnl.dictionary.file_manager.FileManagerImpl.create(FileManagerImpl.java:96)
        ... 8 more 
```

所以我发现了问题。在那个 properties.xml 中，我给出了错误的路径：

`<param name="dictionary_path" value="C:/Program Files/WordNet/"/>`

所以我将其路径更改为包含动词文件的目录：

`<param name="dictionary_path" value="C:/Program Files/WordNet/2.1/dict/"/>`

所以我的问题解决了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-15T00:31:15.383

同样你需要把data.adj等改成adj.dat的形式（当然如果你不愿意修改file_properties.xml中的版本号）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T11:00:57.290

好的，所以我发现了问题所在。它正在寻找错误的文件。我将 index.verb、index.adj 等重命名为 verb.idx... 这解决了问题，程序现在能够在字典中查找单词。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-13T09:59:39.903

jwnl 不适用于 wordnet 2.1 版本。所以尝试使用wordnet 2.0 然后它可以正常工作。

# extjs4 - 在 extjs mvc 中注册窗口卸载

> ID：10688856
> 
> 赞同：1
> 
> 时间：2012-05-21T16:20:23.940
> 
> 标签：extjs4, extjs-mvc

有谁知道如何在 ExtJS MVC 应用程序中注册窗口卸载事件。

```
Ext.EventManager.on(window, 'beforeunload', function() {
alert('cross-exit tab click AND cross-exit browser click');}); 
```

上面的代码需要放在一个javascript文件中。我不确定哪个文件应该包含上述代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T11:51:07.587

```
window.onbeforeunload = function() {
return "You have made changes, are you sure you would like to navigate away from the page?";}.bind(this); 
```

上面的代码完成了这项工作。我把它放在我的主控制器下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T17:32:58.750

将它放在 init 方法内部的控制器中：

```
init: function(){

Ext.EventManager.on(window, 'beforeunload', function() {
    this.setAllValues(false);
});

this.control({
............
.... 
```

# python - 使用 Django ORM 作为跨主机的多进程锁

> ID：10688859
> 
> 赞同：4
> 
> 时间：2012-05-21T16:20:38.037
> 
> 标签：python, django, django-orm

我在连接到公共数据库服务器的几个 Web 主机上运行 Django。该数据库包含一个简单的待处理作业表。例如

```
class Job(models.Model):

    name = models.CharField(max_length=255, null=False, help_text='task to do')
    worker = models.CharField(max_length=255, null=True, help_text='globally unique host name') 
```

我将如何使用 Django 的 ORM 来查询待处理的作业（其中 worker 为空）并自动设置工作者名称，因此没有两个 Django 进程会意外地获取同一个作业（即避免竞争条件）？

理想情况下，我只想通过查询/更新在表锁中进行包装，但 Django 的 ORM 似乎没有内置此功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:46:40.713

正如其他人所提到的，Celery 将是最好的工具。如果你不想使用 Celery：

*   如果您使用的是最新的 Django，请使用[select_for_update()](https://docs.djangoproject.com/en/dev/ref/models/querysets/#select-for-update)来查询您的 Job，然后填写 worker 字段。这就是你在 Django ORM 中想要的“表锁”。它只锁定受影响的行，因此通过允许更多并发性，它比表锁定更好。

*   如果您使用的`select_for_update()`是不可用的旧版本，请实施“锁定表”（就像 10 行一样简单）来保护您的关键部分。

# c - 将变量的内容分配给在 C 和 proC 中不起作用的指针

> ID：10688862
> 
> 赞同：0
> 
> 时间：2012-05-21T16:20:42.483
> 
> 标签：c, pointers

我在 UNIX 平台上的 C 代码中遇到以下问题。

```
 function1(short *a)
 {
    EXEC SQL begin declare section;
          short a1;
    EXEC SQL end declare section;

    EXEC SQL fetch quey_cursor
     into
          :a1;

    // More processing

    *a = a1;

 } 
```

问题是程序在这一行退出

```
 *a = a1; 
```

而且我无法进行调试。

我真的很感激任何帮助

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:37:41.140

您必须向 function1() 传递一个指向 short 的有效指针，才能使对 *a 的赋值起作用。错误出现在调用 function1() 的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:37:45.970

根据您的评论，您没有为指针分配内存。因此，当您尝试将其取消引用为 时`*a=a1`，它会崩溃。由于它只是一个指针，您可以简单地声明并将其用作：

```
function() { 
   short a; 
   function1(&a);
} 
```

注意声明和参数传递的区别。

# c# - 带有保留关键字的 C# 枚举

> ID：10688863
> 
> 赞同：33
> 
> 时间：2012-05-21T16:20:44.487
> 
> 标签：c#, .net

我正在使用 Reflector 从我的工作中打开旧的 C# 代码，我发现`enum`SQL 类中有一个如下所示：

```
public enum Column
{
     bool,
     ...
} 
```

填充了列类型，并且由于`enum`它是保留关键字而无法编译。显然有人能够在某个时候编译它。我如何让它编译？

谢谢！

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-05-21T16:22:36.560

您需要使用字符文字（`@`符号）作为前缀才能使用关键字。

[MSDN](http://msdn.microsoft.com/en-us/library/x53a06bb.aspx)（感谢@erikH）

# ssl - SSL 额外流量？

> ID：10688864
> 
> 赞同：0
> 
> 时间：2012-05-21T16:20:44.287
> 
> 标签：ssl, cryptography

我想知道使用 SSL 是否会比未加密的连接产生更多的流量。我可以想象密钥交换和密钥更新会产生一点额外的流量，但是使用对称算法应该会产生与未加密连接一样多的流量。使用对称算法加密和解密它们需要更多的计算能力，但交换数据的大小应该保持不变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:28:58.807

取决于您的不安全流量有多大。如果您的 HTTP(S) 连接带有小请求和响应（然后断开连接），那么 SSL，由于其握手，可以添加远远超过您的请求和响应的大小（每个 SSL 5-6Kb 数据/TLS 握手很容易）。但是，如果您的请求是数百 KB（甚至数兆字节）大，则可以忽略 SSL 部分。

# c++ - 二分搜索卡住了无限循环？

> ID：10688865
> 
> 赞同：2
> 
> 时间：2012-05-21T16:20:46.937
> 
> 标签：c++, infinite-loop, binary-search

我创建了这个二分搜索，但似乎每次都陷入循环。它所检查的只是一个向量。我不知道我需要改变什么，我尝试了很多不同的东西。

[1,2,4,6] 如果我搜索 4 永远不会找到它不断击中下 = 中 + 1。

```
bool SortSearch::binarySearcher(int size, int val)
{
    int lower = 0, upper = size - 1, mid;

    while (lower < upper)
    {
        mid = (lower + (upper-lower))/2;
        if (students[mid].getID() > val)
            upper = mid - 1;
        else if (students[mid].getID() < val)
            lower = mid + 1;
        else if (students[mid].getID() == val)
            return true;
        else
            return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T16:25:56.360

我相信：

```
mid = (lower + (upper-lower))/2; 
```

应该：

```
mid = lower + (upper-lower)/2; 
```

我可能会补充：

```
assert(lower <= mid && mid <= upper); 
```

此外，该：

```
return false; 
```

应该在循环之后。一旦你检查了`<`, 和`>`，剩下的唯一可能的结果就是`==`(with ints)，所以最后的`else`子句永远不会命中。（如果您使用浮点类型作为索引，那么您可能会遇到一些奇怪的情况，包括 NaN、无穷大，甚至可能是负零。）

调高编译器的警告级别。它应该警告您有关无法访问的代码和没有返回的路径。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T16:26:48.517

这个：

```
mid = (lower + (upper-lower))/2; 
```

应该是：

```
mid = lower + (upper-lower) / 2; 
```

或者只是平均值：

```
mid = (upper + lower) / 2; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T16:31:37.870

在每次迭代中打印`lower`、`upper`和的值可能很有启发性。`mid`考虑当`lower`且`upper`仅相差 1 时会发生什么 - then`mid`将被计算为等于`lower`，这意味着在下一次迭代中`lower`并且`upper`将与上一次迭代相同，从而导致无限循环条件。

# video - FFMPEG - 使用方向元数据进行移动录制

> ID：10688867
> 
> 赞同：2
> 
> 时间：2012-05-21T16:20:54.760
> 
> 标签：video, ffmpeg, orientation

当我转换 iPhone 4S 上录制的 .mov 文件时，视频旋转了 180 度。如果我在我的电脑上播放视频，它看起来是正确的。

我对来自 Android 的 .3gp 文件和来自 iPhone 4 的 .mov 文件遇到了同样的问题（它们旋转了 90 度）

我曾尝试查看 FFMPEG 的文档，但似乎我需要扫描元数据，然后将其添加到我的转换脚本中？

尝试的命令： ffmpeg -i VID_20120510_104204.mov -y -f flv -ar 44100 VID_20120510_104204.flv 还查看了 -vf %ROTATE%

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:39:51.587

这是一个用于从元数据中检测视频旋转角度的 python 脚本：[https ://github.com/danielgtaylor/qtrotate/blob/master/qtrotate.py](https://github.com/danielgtaylor/qtrotate/blob/master/qtrotate.py)

您可以将其与转换脚本一起使用。

# ruby-on-rails - 由于路由，用户配置文件控制器 Rspec 测试失败

> ID：10688869
> 
> 赞同：0
> 
> 时间：2012-05-21T16:21:04.010
> 
> 标签：ruby-on-rails, routing, rspec, devise

我在使用 Rspec 测试我的新用户个人资料页面时遇到问题。它通过浏览器工作，但 Rspec 正在爆炸。

我正在使用带有单独控制器的设计来编辑配置文件字段。

这是一个请求规范。

```
 it 'Shows the user profile with their non-private data' do
      visit user_path(@user)
      page.should have_content @user.full_name
    end 
```

失败并出现此错误：

```
 Failure/Error: visit user_path(@user)
 ActionController::RoutingError:
   No route matches {:action=>"show", :controller=>"users"} 
```

我不同意

```
#routes.rb
devise_for :users, :controllers => {:registrations => "registrations"}
  resources :users, :only => [:edit, :update, :show] 
```

更新和编辑路径助手工作得很好。

控制器动作：

```
 class UsersController < ApplicationController
      layout 'profile', :except => [:show]
      #... edit and update omitted

      def show
        @user = User.find(params[:id])
      end
    end 
```

rake 路线显示：

```
 new_user_session GET    /users/sign_in(.:format)                      devise/sessions#new
                  user_session POST   /users/sign_in(.:format)                      devise/sessions#create
          destroy_user_session DELETE /users/sign_out(.:format)                     devise/sessions#destroy
                 user_password POST   /users/password(.:format)                     devise/passwords#create
             new_user_password GET    /users/password/new(.:format)                 devise/passwords#new
            edit_user_password GET    /users/password/edit(.:format)                devise/passwords#edit
                               PUT    /users/password(.:format)                     devise/passwords#update
      cancel_user_registration GET    /users/cancel(.:format)                       registrations#cancel
             user_registration POST   /users(.:format)                              registrations#create
         new_user_registration GET    /users/sign_up(.:format)                      registrations#new
        edit_user_registration GET    /users/edit(.:format)                         registrations#edit
                               PUT    /users(.:format)                              registrations#update
                               DELETE /users(.:format)                              registrations#destroy
                     edit_user GET    /users/:id/edit(.:format)                     users#edit
                          user GET    /users/:id(.:format)                          users#show
                               PUT    /users/:id(.:format)                          users#update 
```

所以看起来设计并没有干扰我的路线，更重要的是，一切都在浏览器中运行。我在这里想念什么？

我还尝试制作一个名为 profile 而不是默认显示的成员操作，结果相同

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T12:25:10.320

这里的问题是我开始了一个新`context`块并且没有`@user`在块之前设置`it`。路线的事情只是一个红鲱鱼。

还证明如果您无法弄清楚事情，您应该离开您的代码一段时间。

# r - R - gwidgets 的谷歌滑块

> ID：10688872
> 
> 赞同：0
> 
> 时间：2012-05-21T16:21:40.377
> 
> 标签：r, google-visualization, gwidgets

我正在寻找一种方法来实现有时像 googleVis 注释时间轴中的滑块：[https ://developers.google.com/chart/interactive/docs/gallery/annotatedtimeline](https://developers.google.com/chart/interactive/docs/gallery/annotatedtimeline)

我可以通过起点和终点调整时间范围，也可以移动窗口。

gslider 仅适用于每个轨道一个滑块。一个轨道上有两个或三个滑块会更好。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T19:07:40.883

包中的`tkexamp`函数`TeachingDemos`是创建具有可使用滑块或其他 GUI 工具调整的属性（包括数据范围）的图形的一种方法。

# php - 如何在 PHP 中创建 jqplot 数据数组？

> ID：10688876
> 
> 赞同：1
> 
> 时间：2012-05-21T16:22:01.710
> 
> 标签：php, javascript, jquery, arrays, jqplot

我正在使用 ajax 连接到 PHP 脚本，然后检索 jqplot jQuery 图形库所需的图形坐标。

问题是我很难构建一个合适的 PHP 数组，然后可以将其转换为 jqplot 可以读取的 jQuery 数组。

下面是从 PHP 文件中检索数组的代码：

```
$.ajax({
    type: 'POST',
    dataType: "json",
    url: "behind_curtains.php",
    data: {
        monthSelected: month_option_selected
    },
    success: function (data) {
        var stored_data = data;
        alert(stored_data);
    }
});
return stored_data;
} 
```

这是创建 jqplot 的代码

```
jQuery.jqplot('chartdiv-data', [], {
    title: 'Plot With Options',
    dataRenderer: stored_data,
    axesDefaults: {
        labelRenderer: jQuery.jqplot.CanvasAxisLabelRenderer
    },
    axes: {
        xaxis: {
            label: "Day",
        },
        yaxis: {
            label: "data"
        }
    }
}); 
```

如果您能帮我在 behind_curtains.php 文件中创建正确的数据数组，那就太好了！

**编辑 1** 图形坐标数组应采用以下形式：

```
[[[1,2],[3,5],[5,13]]] 
```

基本上我需要以某种方式编写可以输出以该形式存储数据的数组的php代码。

谢谢

**解决方案：**

*behind_curtains.php*

我将一个数组放在一起，它只生成 [[1,2],[3,5],[5,13]] 形式的字符串。然后我将字符串存储在一个变量中，并以以下形式回显该变量：

```
echo json_encode($stored_data); 
```

在用户方面，我的代码如下所示：

```
<script type="text/javascript">
$("document").ready(function() {
        $.ajax({
            type: 'POST',
            dataType:"json",
            url: "behind_curtains.php",
            data: {
                monthSelected: month_option_selected},
            success: function(data){                    
            var stored_data = eval(data) ;  
/* generate graph! */
$.jqplot('chartdiv-weight', [stored_data], {
 title: month, 
axesDefaults: {
    labelRenderer: jQuery.jqplot.CanvasAxisLabelRenderer
  },
  axes: {
    xaxis: {
      label: "Day",
    },
    yaxis: {
      label: "data"
    }
  }   
});
        }
        });
    } 
```

`}});</script>`

希望对你有帮助，如果没有，有兴趣的请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T09:00:55.393

您可以返回，但您需要在调用`stored_data`之前声明它，如[最底部示例所示，here。](http://www.jqplot.com/deploy/dist/examples/data-renderers.html)您还必须使用：否则您不能以这种方式返回您的数据。出于同样的原因，如果您愿意，也可以改用。`AJAX``async: false``getJSON()`

在格式化检索到的数据时[，我在这里回答了一个类似的问题。](https://stackoverflow.com/a/10497512/613495)您需要相应地构建数组来表示您的数据。

*如果你能展示你的`JSON`样子，那么我可以给你一个更准确的答案。*

# android - Android 如何在 onDestroy() 后重新连接到 AsyncTask 并重新启动 onCreate()？

> ID：10688878
> 
> 赞同：5
> 
> 时间：2012-05-21T16:22:17.153
> 
> 标签：android, android-asynctask, lifecycle

我已经测试了 AsyncTasks 不会随着它们的启动活动而被破坏的声明。这是**真的**。

我让 AsyncTask`Log.i()`每 3 秒发布一条消息，持续 1 分钟。我把`Log.i()`消息放在`onDestroy()`活动的方法中。

我看到活动被破坏，但 AsyncTask 继续运行，直到它完成所有 20`Log.i()`条消息。

我很困惑。

1.  如果 AsyncTask`publishProgress()`进入了被破坏的 UI 怎么办？
    我想会发生某种异常，对吧？

2.  如果 AsyncTask 将数据存储在 的全局变量中`class Application`怎么办？
    这里不知道，NullPointer 异常？

3.  如果重新启动应用程序会怎样？
    它可能会启动一个新的 AsyncTask。它可以与仍在运行的 AsyncTask 重新连接吗？

4.  母应用销毁后，AsyncTask 是否不朽？
    也许是的，所有 LogCat 应用程序如何在 UI 应用程序不再可见或被破坏时保持记录消息？当您重新打开它们时，它们会向您显示在它“死”时生成的消息。

这一切看起来像是一场讨论，但问题就在标题中。我有这个孤立的 AsyncTask，我非常想在重新启动应用程序时重新连接它，但我不知道该怎么做。

我忘了说为什么这很重要。当方向发生变化时，应用程序会被破坏。而且我不想丢失 AsyncTask 产生的数据，我不想停止它并重新启动它。我只是希望它在方向更改完成后继续运行并重新连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:00:45.450

我希望我做对了，因为它来自一些我不再使用的旧代码（我现在使用 an`IntentService`来做这曾经做的事情）。

这是我最初在我的主目录中下载文件时所拥有的`Activity`...

```
public class MyMainActivity extends Activity {

    FileDownloader fdl = null;

    ...

    // This is an inner class of my main Activity
    private class FileDownloader extends AsyncTask<String, String, Boolean> {
        private MyMainActivity parentActivity = null;

        protected void setParentActivity(MyMainActivity parentActivity) {
            this.parentActivity = parentActivity;
        }

        public FileDownloader(MyMainActivity parentActivity) {
            this.parentActivity = parentActivity;
        }

      // Rest of normal AsyncTask methods here

    }
} 
```

关键是用来`onRetainNonConfigurationInstance()`“保存” `AsyncTask`.

```
Override
public Object onRetainNonConfigurationInstance() {

    // If it exists then we MUST set the parent Activity to null
    // before returning it as once the orientation re-creates the
    // Activity, the original Context will be invalid

    if (fdl != null)
        fdl.setParentActivity(null);
    return(fdl);
} 
```

然后我有一个调用的方法`doDownload()`，`onResume()`如果`Boolean`指示`downloadComplete`为真，则调用该方法。`Boolean`是在 的方法`onPostExecute(...)`中设置的`FileDownloader`。

```
private void doDownload() {
    // Retrieve the FileDownloader instance if previousy retained
    fdl = (FileDownloader)getLastNonConfigurationInstance();

    // If it's not null, set the Context to use for progress updates and
    // to manipulate any UI elements in onPostExecute(...)
    if (fdl != null)
        fdl.setParentActivity(this);
    else {
        // If we got here fdl is null so an instance hasn't been retained
        String[] downloadFileList = this.getResources().getStringArray(R.array.full_download_file_list);
        fdl = new FileDownloader(this);
        fdl.execute(downloadFileList);
    }
} 
```

# c# - 错误 CC1071：合约验证器调用的参数太复杂。请简化

> ID：10688883
> 
> 赞同：2
> 
> 时间：2012-05-21T16:22:30.663
> 
> 标签：c#, .net-4.0, code-contracts

任何想法是什么意思？调用看起来像：

```
Require.IsTrue(value == null || type.IsInstanceOfType(value),
    "value",
    "The specified value must be an instance of the specified type."); 
```

**升级版：**

```
[ContractArgumentValidator]
public static void IsTrue(
    Boolean condition, String paramName, String message)
{
    if(!condition)
    {
        throw new ArgumentException(message, paramName);
    }
    Contract.EndContractBlock();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:21:43.413

不要使用 || 或 && 运算符在验证器的参数中。反编译不支持。

# android - 在 android 应用程序中标记地点不在“Google Places”数据库中

> ID：10688891
> 
> 赞同：0
> 
> 时间：2012-05-21T16:22:43.003
> 
> 标签：android, google-maps, android-maps, google-places-api

我想为我的 android 应用在地图上添加标记。我确实知道该怎么做（叠加项目）。**我的问题是：**由于我手动将标记放在我已经知道纬度/经度的点上（在地图上），我想知道是否有任何方法可以在谷歌地图上获得一个地方的确切纬度和经度？现在我要求我的人去特定的地方并使用这个 ( [http://bit.ly/K4fOcy](http://bit.ly/K4fOcy) ) 应用程序来确定那个地方的纬度/经度并通过电子邮件发送给我。我使用这些纬度/经度值在应用程序中的地图上放置标记。但是我得到的纬度和经度不准确。他们有大约 300-2500m 的误差（实际规模）。
还是我应该使用 Google Places API？它是如何工作的？那些不在 Google Places 数据库中的地方呢？如何在地图上准确标记它们？如果有人指出我正确的方向，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T19:16:21.417

如果您正在使用未在 Google Places API 中表示的机构，并且希望能够直接从[http://maps.google.com/](http://maps.google.com/)提取坐标，您只需：

1.  使用地址或仅对该区域的了解在地图上查找感兴趣的位置
2.  右键单击地图并选择**这里有什么？**从上下文弹出菜单

Lat-Lng 坐标将自动填充到搜索输入框中，通常，地址也会显示在动态侧面板中（通常是街景照片）。

如果您正在寻找一种查询坐标的方法，您可以使用 Geocoder[^(开发指南)](https://developers.google.com/maps/documentation/javascript/geocoding)服务将地址转换为坐标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:39:19.840

你看过谷歌地图的地理编码 API 吗？它允许您传入一个地址，并返回一个纬度/经度对作为响应，每个响应都会返回一个准确度值，让您知道地理编码器能够解析该位置的距离。[https://developers.google.com/maps/documentation/geocoding/](https://developers.google.com/maps/documentation/geocoding/)

# javascript - 通过数据的值选择要与 D3 一起显示的数据

> ID：10688892
> 
> 赞同：0
> 
> 时间：2012-05-21T16:22:44.720
> 
> 标签：javascript, sql, asp.net, d3.js, visualization

我从 SQL 中引入数据并将其存储在隐藏标签中，然后使用 D3 作为散点图进行显示。我有一个 x 值标签、y 值标签、半径标签，然后是第四个标签，我们称之为集合标签。

基本上，我有七组数据，并且希望一次只显示一组（用户可以从下拉菜单或单选按钮中进行选择，或者选择要显示的一组，这很容易）。D3 中有没有办法说只显示设置数据 = X 的点？

到目前为止，这是我的相关设置：

```
var x_data = $('.CostImport').text().split(',');
var y_data = $('.PriceImport').text().split(',');
var r_data = $('.SalesImport').text().split(',');
var c_data = $('.ZoneImport').text().split(',');

var data = [];

for (i = 0; i < x_data.length; i++) {
   data.push({ "x": x_data[i], "y": y_data[i], "c": c_data[i], "r": r_data[i] });
}

 vis.selectAll("circle")
            .data(data)
                .enter().append("svg:circle")
                    .attr("cx", function (d) { return x(d.x) })
                    .attr("cy", function (d) { return y(d.y) })
                    .attr("stroke-width", "none")
                    .attr("fill", function (d) { return c(d.c) })
                    .attr("fill-opacity", .75)
                    .attr("r", function (d) { return r(d.r) }); 
```

目前我正在按设定值着色数据，但它太忙且重叠。我意识到我可以为每个集合加载单独的标签和数据（例如 x1_data、x2_data ......），但我希望在集合数量发生变化的情况下使其更加健壮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:31:28.993

将最后一行更改为：

```
.attr("r", function (d) { if (d.c == 3) return r(d.r); else return 0 }); 
```

完美运行。太多的 SQL 时间让我忘记了双等号。

# generics - 泛型接口的语法

> ID：10688906
> 
> 赞同：0
> 
> 时间：2012-05-21T16:23:50.343
> 
> 标签：generics, interface, c++-cli

我在 C++/CLI 中遇到了一些与我认为我知道的相反的东西：

通常，如果你将一个对象传递给一个函数，你会使用一个点来访问它的方法（这也适用于`ref`类，带有一些额外的构造函数）：

```
value class Value {
  void Print() { Console::WriteLine("Value"); }
};

void f(Value v) {
  v.Print();
} 
```

通常，通过接口将对象传递给函数会强制您将 a`^`放在参数上，并`->`在方法调用中使用：

```
interface class Base {
  void Print();
};

void f(Base ^b) {
  b->Print();
} 
```

但是，如果您`f`使用基于接口的约束进行泛型，编译器会坚持您使用`->`，但也坚持您不要`^`在参数列表中使用：

```
interface class Base {
  void Print();
};

generic <class T> where T : Base
void f(T t) {
  t->Print();
} 
```

到目前为止，我认为直接引用对象总是使用`.`，通过句柄引用它们总是使用`->`. 这似乎直接使用 a 引用一个对象`->`- 我错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:44:01.137

他们试图使 C++/CLI 语法与 C++ 语法等效，但这并不是特别成功。规则是你`.`用来访问一个*值类型*的成员，`->`来访问一个*引用类型*的成员。

第一个复杂的问题是堆栈语义。您可以放下帽子来声明引用类型的局部变量。然后自动在作用域块的末尾释放，编译器自动生成一个析构函数调用。试图使托管类型的行为类似于 C++ 类型并挽救 RAII 模式。

第二个问题是编译器允许在值类型的变量上使用帽子。这是 99% 的类型错误，特别令人讨厌，因为这在运行时非常昂贵，因为值被装箱了。

泛型使它最终变得模棱两可，类型参数可以是值类型或引用类型。这将使具体类型成为值或引用类型，直到运行时才被整理出来。请注意，在您的示例中这是允许的，值类型可以实现接口。那么规则是你总是在类型参数的变量上不加帽子地编写代码，将它们视为值类型。但是使用箭头取消引用这些变量，就好像它们是引用类型引用一样。是的，非常混乱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:12:51.743

> 到目前为止，我认为直接引用对象总是使用`.`，通过句柄引用它们总是使用`->`. 这似乎直接使用 a 引用一个对象`->`- 我错了什么？

你的第一句话是完全正确的。对于您的第二句话....您没有直接访问对象。 `T`本身将是一个句柄类型，例如`String^`.

您使用额外的复制构造函数在引用类型的参数上具有堆栈语义的想法与语言设计作斗争。我建议你停止。如果您真的想使用`.`运算符，可以尝试托管引用：`void f(RefType% p)`，它也应该适用于接口：`void f2(Base% p)`。但是克隆和处理引用类型的结果并不好，对这些类型做任何有用的事情取决于你处理原始对象而不是副本。

# visual-studio-2008 - 为什么在我的 VS2008 项目中禁用了调用浏览器？

> ID：10688909
> 
> 赞同：1
> 
> 时间：2012-05-21T16:24:14.947
> 
> 标签：visual-studio-2008

我试图理解我没有编写的 C++ DLL，查看函数调用层次结构会非常有用。

但是当我右键单击函数名称并选择调用浏览器时，所有菜单项都被禁用。

我查看了所有项目和解决方案设置，并删除了 .ncb 文件以及调试和发布目录，但没有任何效果。

谁能建议为什么会发生这种情况？

（在 Windows XP、VS2008 SP1 上运行）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:41:54.373

发布我的问题后，我重新启动了 VS，现在调用浏览器正在工作。

我想删除 .ncb 或构建目录修复它，但也需要重新启动 VS。

（与 C# 相比，C++ 的浏览和 Intellisense 似乎极其脆弱。我的 Intellisense 几周前也坏了）。

# search - 复杂的 SOLR 查询，包括 NOT 和 OR

> ID：10688910
> 
> 赞同：5
> 
> 时间：2012-05-21T16:24:32.340
> 
> 标签：search, solr, logic, boolean-logic

我对 SOLR 搜索有一些相当复杂的要求，我需要针对我的标记内容数据库执行这些要求。我需要首先将数据库过滤到与我的过滤器标签匹配的那些结果。除非它们还包含白名单中的标签，否则应删除任何具有黑名单标签的结果。

假设我想检索所有标记为“森林”或“保护”的文档。但我想排除标记为“英国”或“欧洲”的文件——除非它们也被标记为“非洲”或“亚洲”。我试图在我的 SOLR 查询中写这个：

```
tag:((forest OR conservation) AND (africa OR asia OR !uk OR !europe)) 
```

逻辑对我来说似乎是合理的，但查询不起作用。我有 46 个文档标记为“森林”或“保护”——其中一个文档也标记为“亚洲”，没有一个文档标记为“英国”或“欧洲”，但查询未返回任何结果。

我还看到了有关 SOLR 的 fq（过滤查询）参数的信息，这听起来很有用。但这似乎也无济于事。似乎是 NOT 和 OR 的组合导致 SOLR 崩溃。

我正在尝试做的事情可能吗？我的逻辑是否有缺陷？这是在 SOLR 1.4 顺便说一句 - 如果这是一个已经在某处解决的问题....

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T07:34:49.600

尝试

```
tag:((forest OR conservation) AND (africa OR asia OR (*:* AND !uk AND !europe))) 
```

# sql - 我的 JDBC 插入/更新命令有什么问题

> ID：10688911
> 
> 赞同：0
> 
> 时间：2012-05-21T16:24:34.727
> 
> 标签：sql, sql-server, jdbc, jtds

这是一个简单的预订/预订表：key 是 timeOfBooking 和 dateOfBooking 的 anId。

但是，当我尝试这样做时：插入 if-not-exist，更新 if-exist，关于与此代码链接到时间的标识符：

```
declare anId varchar[18];
declare aDate;
declare aTimeStamp;
set @anId =?;
set @aDate=?;
set @aTimeStamp=?;
if (exists (select * from Booking as t  where t.AnId = @anId ))
begin update Booking set Date = @aDate and Time = @aTimeStamp  where AnId= @anId end
else begin insert into Booking (AnId, Date, Time) values(@anId , @aDate, @aTimeStamp) end ; 
```

我最终得到 jdbc 层返回此错误：

```
'varchar' is not a recognized CURSOR option. 
```

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:29:41.730

你应该把@作为变量名

```
declare @anId varchar(18);
declare @aDate datetime;
declare @aTimeStamp datetime; 
```

# php - 将附件添加到邮件

> ID：10688912
> 
> 赞同：1
> 
> 时间：2012-05-21T16:24:35.047
> 
> 标签：php, email, header, mime, attachment

我有这个完美运行的脚本，但附件是空的（我的意思是我可以看到附件..但我加载的每个文件的大小都是 0 kb）这里是代码：

allegato 意味着附件

```
 $path = $allegato['tmp_name'];
  $fp = fopen($path, 'r');
  do //we loop until there is no data left
  {
    $data = fread($fp, 8192);
    if (strlen($data) == 0) break;
    $content .= $data;
  } while (true);
  $content_encode = chunk_split(base64_encode($content));

  $mime_boundary = "<<<--==+X[".md5(time())."]";

  $headers .= "From:".$email."\r\n"; 
  $headers .= "To: me <mail@gmail.com>\r\n"; 

  $headers .= "MIME-Version: 1.0\r\n";
  $headers .= "Content-Type: multipart/mixed;\r\n";
  $headers .= " boundary=\"".$mime_boundary."\"";

  $message .= "This is a multi-part message in MIME format.\r\n";
  $message .= "\r\n";
  $message .= "--".$mime_boundary."\r\n";

  $message .= "Content-Type: text/plain; charset=\"iso-8859-1\"\r\n";
  $message .= "Content-Transfer-Encoding: 7bit\r\n";
  $message .= "\r\n";
  $message .= "Email sent from:".$nome." \r\n";
  $message .= $messaggio."\r\n";
  $message .= "--".$mime_boundary."\r\n";

  $message .= "Content-Type: ".$allegato_type."\"\r\n";
  $message .= " name=\ ".$allegato_name."\"\r\n";
  $message .= "Content-Transfer-Encoding: base64\r\n";
  $message .= "Content-Disposition: attachment;\r\n";
  $message .= " filename=\ ".$allegato_name."\"\r\n";
  $message .= "\r\n";
  $message .= $content_encode;
  $message .= "\r\n";
  $message .= "--".$mime_boundary."\r\n";

  $ok = mail("mail@gmail.com", $object, $message, $headers);

  if($ok)
   {
     echo'<script type="text/javascript">alert("mail sent successfully ! ");</script>';
   }
 else
     { echo'<script type="text/javascript">alert("mail failed! ");</script>';} 
```

* * *

有人可以帮忙处理附件吗？（发送的每个文件都是 0 kb，我如何修复它？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T17:15:21.477

我建议使用PHPMailer！

它可从[http://sourceforge.net/projects/phpmailer/免费获得](http://sourceforge.net/projects/phpmailer/)

只需将它放在服务器上的一个目录中，包括它的主要 php，当您从 php 发送电子邮件时，您的生活就会变得愉快。

我有一个简单的开始功能，我可以提供给您以获得快速的结果：

```
require("/path/to/class.phpmailer.php");

function mail_sender($from_name,$from_email,$to_email,$subject,$mailtext,$att = false) {

    $mail = new PHPMailer();

    $mail->IsSMTP();                // set mailer to use SMTP
    $mail->Host = "localhost";      // specify main and backup server
    $mail->SMTPAuth = false;        // turn on SMTP authentication

    $mail->From = $from_email;
    $mail->FromName = $from_name;
    $mail->WordWrap = 50;           // set word wrap to 50 characters
    $mail->IsHTML(true);            // set email format to HTML
    $mail->CharSet="utf-8";  

    $mail->Subject = $subject;
    $mail->Body    = $mailtext;
    $mail->AltBody = "";

    $mail->AddAddress($to_email);

    if ($att) {
        $mail->AddAttachment("include/attachment.doc");
    }

    if(!$mail->Send())  {
           echo "Message could not be sent. <p>";
           echo "Mailer Error: " . $mail->ErrorInfo;
           exit;
    }

} 
```

# windows-ce - 带有 Windows CE 6.0 的 Microsoft Office 文档成像

> ID：10688918
> 
> 赞同：2
> 
> 时间：2012-05-21T16:25:03.603
> 
> 标签：windows-ce, ocr

我可以在Windows CE 6.0中使用[MODI 库吗？](http://office.microsoft.com/en-us/help/about-microsoft-office-document-imaging-HP001077103.aspx)否则我可以在 Windows CE 6.0 中使用哪种 OCR？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:37:38.517

Windows CE 不支持 MODI。[Nuance](http://nuance.com/)曾经有一款名为“Mobile OCR”的产品支持 CE。我不再在他们的网站上看到它，尽管[OmniPage Capture SDK](http://nuance.com/for-business/by-product/omnipage/csdk/index.htm)看起来可能是替代品。他们的网站不清楚平台支持 - 他们只是说支持“移动”和“嵌入式”，所以你可能想联系他们并询问。

# c# - 如何通过 Facebook C# SDK 获取 Facebook 的墙/新闻提要/用户图像

> ID：10688919
> 
> 赞同：0
> 
> 时间：2012-05-21T16:25:04.140
> 
> 标签：c#, facebook, facebook-graph-api

有什么线索可以让我获得 Facebook 的以下内容吗

1.  墙
2.  新闻提要
3.  用户图片

？？？我必须使用哪种请求？

我试过了

```
dynamic p = (IDictionary<string, object>)fb.Get(userID + "/posts");

dynamic p = (IDictionary<string, object>)fb.Get(userID + "/feed"); 
```

但它似乎返回同样的东西......

为了让我使用的用户

```
user = new FacebookUser();
dynamic u = (IDictionary<string, object>)fb.Get(userID);

user.ID = u.id;
user.Name = u.name;
user.FirstName = u.first_name;
user.LastName = u.last_name;
user.Link = u.link;
user.Gender = u.gender;
user.Locale = u.locale; 
```

但它没有图片链接。（[http://csharpsdk.org/docs/web/getting-started](http://csharpsdk.org/docs/web/getting-started)没有帮助）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:36:39.613

好的，伙计们，最后我找到了方法。

首先，您必须在此处导航[https://developers.facebook.com/tools/explorer](https://developers.facebook.com/tools/explorer) 进行实验 :)

从技术上讲，ypu 必须应用您拥有的所有权限并使用即[https://graph.facebook.com/your_profile_id/feed](https://graph.facebook.com/your_profile_id/feed)来获取您的提要。

权限列表可在此处获得[https://developers.facebook.com/docs/authentication/permissions/](https://developers.facebook.com/docs/authentication/permissions/)

获取用户图片的 URL，您必须像这样构建

[https://graph.facebook.com/your_profile_id/picture](https://graph.facebook.com/your_profile_id/picture)

玩得开心！:)

# eclipse - 如何将 emacs 的 Mf 和 Mb 配置为 eclipse 的 Ctrl+right 和 Ctrl+left 之类的行为？

> ID：10688922
> 
> 赞同：1
> 
> 时间：2012-05-21T16:25:16.060
> 
> 标签：eclipse, emacs, keyboard-shortcuts

我从 eclipse 到 emacs，不习惯`M-f`and的行为`M-b`。

请参阅以下 javascript 代码：

```
module.controller('Front', ['$scope', function($scope){ 
```

当我使用`Ctrl+right`时，光标会跳转到`|`代码中的：

```
|module|.|controller|('|Front|', |['|$scope|', |function|(|$scope|){| 
```

当我使用 时，光标会在这些位置`Ctrl+left`从右向左跳跃。`|`

但是在 emacs 中，Mf 是不同的：

```
module|.controller|('Front|', ['$scope|', function|($scope|){ 
```

怎么配置emacs让mf和eclipse的一模一样`Ctrl+right`，又`M-b`是一样的`Ctrl+left`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:00:40.210

我认为这些功能可以满足您的要求：

```
(defun eclipse-forward-word ()
  (interactive)
  (let ((go-back (looking-at-p "\\W")))
    (forward-word)
    (when go-back
      (backward-word))))

(defun eclipse-backward-word ()
  (interactive)
  (let ((go-forward (looking-at-p "\\<")))
    (backward-word)
    (when go-forward
      (forward-word))))

(global-set-key (kbd "<C-left>") 'eclipse-backward-word)
(global-set-key (kbd "<C-right>") 'eclipse-forward-word) 
```

# python - 在 ReportLab 中向画布元素添加超链接的最简单方法是什么？

> ID：10688923
> 
> 赞同：8
> 
> 时间：2012-05-21T16:25:19.260
> 
> 标签：python, canvas, hyperlink, reportlab

我正在使用 ReportLab 使用 Python 制作 pdf。我想在画布上添加一个形状，并让该形状充当超链接。在以下示例链接到 google.com 中制作矩形的最简单方法是什么？

```
from reportlab.pdfgen import canvas
from reportlab.lib.units import inch

c = canvas.Canvas("hello.pdf")

# move the origin up and to the left, draw square
c.translate(inch,9*inch)
# How do I make this rectangle link to google.com?
c.rect(inch,inch,1*inch,1*inch, fill=1)

c.showPage()
c.save() 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-21T16:35:58.240

`linkURL`在画布上调用：

```
c.linkURL('http://google.com', (inch, inch, 2*inch, 2*inch), relative=1) 
```

矩形是可点击区域，因此您必须将其与绘制的矩形相匹配。参数是两个坐标，`x, y`左下角和右上角的两个坐标。

在这篇博文中查看更多示例：http: [//www.hoboes.com/Mimsy/hacks/adding-links-to-pdf/](http://www.hoboes.com/Mimsy/hacks/adding-links-to-pdf/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-26T14:35:19.163

为了补充Martijn 的答案，linkURL 使用“默认”坐标系绘制一个矩形，即bottom+up/left+right。由于默认画布使用自上而下坐标，我建议您根据画布高度进行快速修复。

# java - Double.longBitsToDouble 和 Double.doubleToRawLongBits 与 NaN

> ID：10688926
> 
> 赞同：1
> 
> 时间：2012-05-21T16:25:29.010
> 
> 标签：java

为什么是

```
Double.NaN != Double.longBitsToDouble(Double.doubleToRawLongBits(Double.NaN)); 
```

尽管[SE 6 文档](http://docs.oracle.com/javase/6/docs/api/java/lang/Double.html#doubleToRawLongBits%28double%29)说明了以下内容：

> 在所有情况下，结果都是一个`long`整数，当将其提供给 `longBitsToDouble(long)`方法时，将产生一个与 的参数相同的浮点值`doubleToRawLongBits`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T16:26:33.250

但是`Double.NaN != Double.NaN`...

# svn - 在运行 .exe 之前检查 SVN 工作版本是否与 head 相同

> ID：10688927
> 
> 赞同：1
> 
> 时间：2012-05-21T16:25:31.600
> 
> 标签：svn, batch-file

嗨，我是 svn 的新手，我想编写一个 windows 命令行脚本来检查文件的工作版本是否与 head 相同，以及它是否运行 exe？如果它与工作版本不同，我想退出脚本而不运行可执行文件。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T19:23:29.000

我对 Windows cmd 批处理语言有足够的了解，知道做这样的事情几乎是不可能的。至少 Powershell 是一门完整的语言。

我可以告诉你一件事：你可以看看`svn status --show-updates file`是否`file`是最新的：

文件是最新的：

```
C> svn status --show-updates file
Status against revision:     182332 
```

文件不是最新的：

```
C> svn st -u file
        *            file
Status against revision:     182332 
```

如果您可以以某种方式使用 Windows 命令批处理语言来解析该命令的输出，则可以检查是否`file`是最新版本。

# java - 显示一个 ArrayList？

> ID：10688928
> 
> 赞同：3
> 
> 时间：2012-05-21T16:25:35.533
> 
> 标签：java, arrays, list

```
ArrayList <String> cdcollection = new ArrayList();

private void initButtonActionPerformed(java.awt.event.ActionEvent evt) {
    Collections.addAll(cdcollection, "small", "mayre", "brown", "evner", "rain" );
    initButton.setEnabled(false);

}

private void displayButtonActionPerformed(java.awt.event.ActionEvent evt) {

          for (int i = 0; i < cdcollection.size(); i++)  {
          mainTextArea.setText(cdcollection.get(i));
    }
}

private void addButtonActionPerformed(java.awt.event.ActionEvent evt) {
    cdcollection.add(cdtitleInput.getText());
}

private void removeButtonActionPerformed(java.awt.event.ActionEvent evt) {
    cdcollection.remove(cdcollection.size()-1);
} 
```

当我运行它并单击显示按钮时，只出现最后一个 cd 标题（雨）......我怎样才能让所有五个 cd 标题都出现在一行上？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T16:26:45.657

使用`Append()`代替`setText()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:28:28.833

`displayButtonActionPerformed`如下所示改变方法。

```
private void displayButtonActionPerformed(java.awt.event.ActionEvent evt) {    
    String str = "";
    for (int i = 0; i < cdcollection.size(); i++)  {
          str = str + cdcollection.get(i);
    }
    mainTextArea.setText(str);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T23:22:37.077

使用简化的 for 循环。

```
private void displayButtonActionPerformed (ActionEvent evt) {    
    for (String cd : cdcollection) {
          mainTextArea.append (cd + "\n");
    }
} 
```

它通常会防止一个错误，它通常更短并且可读性更好。

# iphone - HTML5 音频播放器适用于 safari/Chrome，但不适用于 iPhone

> ID：10688930
> 
> 赞同：1
> 
> 时间：2012-05-21T16:25:53.407
> 
> 标签：iphone, html, audio

我有一个 HTML5 音频播放器，可以在 PC 上的 Safari 上运行，但似乎不适用于（我的）iPhone (4)。这是代码：

```
`    
function loadPlayer() {
    var audioPlayer = new Audio();
    audioPlayer.controls="controls";
    audioPlayer.addEventListener('ended',nextSong,false);
    audioPlayer.addEventListener('error',errorFallback,true);
    document.getElementById("player").appendChild(audioPlayer);
    nextSong();
}
function nextSong() {
    if(urls[next]!=undefined) {
        var audioPlayer = document.getElementsByTagName('audio')[0];
        if(audioPlayer!=undefined) {
            audioPlayer.src=urls[next];
            audioPlayer.load();
            audioPlayer.play();
            next++;
        } else {
            loadPlayer();
        }
    } else {
        alert('the end!');
    }
}
function errorFallback() {
        nextSong();
}
function playPause() {
    var audioPlayer = document.getElementsByTagName('audio')[0];
    if(audioPlayer!=undefined) {
        if (audioPlayer.paused) {
            audioPlayer.play();
        } else {
            audioPlayer.pause();
        }
    } else {
        loadPlayer();
    }
}

    function stop() {
        var audioPlayer = document.getElementsByTagName('audio')[0];
        audioPlayer.pause();
        audioPlayer.currentTime = 0;
    }

function pickSong(num) {
    next = num;
    nextSong();
}

var urls = new Array();
    urls[0] = '01_horses_mouth/mp3/01\. Let The Dog See The Rabbit preface.mp3';
    urls[1] = '01_horses_mouth/mp3/02\. The Other Horse\'s Tale.mp3';
    urls[2] = '01_horses_mouth/mp3/03\. Caged Tango.mp3';
    urls[3] = '01_horses_mouth/mp3/04\. Crumbs.mp3';
    urls[4] = '01_horses_mouth/mp3/05\. Mood Elevator Reprise.mp3';
    urls[5] = '01_horses_mouth/mp3/06\. Mood Elevator.mp3';
    urls[6] = '02_dub_project/mp3/01\. Fearless Dub.mp3';
    urls[7] = '02_dub_project/mp3/02\. Original Sound Dub.mp3';
    urls[8] = '02_dub_project/mp3/03\. Rhok Shok Dub.mp3';
    urls[9] = '02_dub_project/mp3/04\. Tron Dub.mp3';
    urls[10] = '02_dub_project/mp3/05\. Eastern Fire Dub.mp3';
    urls[11] = '02_dub_project/mp3/06\. Mary Jane Dub.mp3';

var next = 0;
` 
```

任何人都可以看到任何明显会使这不适用于 iPhone 的东西吗？

还有画布元素的代码，但我已经在 iPhone 版本上隐藏了它——无论如何都是画布。我注释掉了代码，但这似乎没有什么不同，所以我猜这不是冲突。这是网站：

[http://lisadearaujo.com/clientaccess/wot-sound/indexiPad.html](http://lisadearaujo.com/clientaccess/wot-sound/indexiPad.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T09:14:18.617

在我的浏览器版本中，我隐藏了默认音频播放器，因此我可以使用自定义控件。这适用于隐藏 div 中的玩家。然而，在 iPhone 上，div 必须显示才能正常工作，即使使用自定义控件（或者它看起来如此）也是如此。

我用低 z-index 隐藏了 div，而不是 display:none。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T19:16:25.023

iPhone 上的 HTML5 音频播放器需要用户点击。

单击播放器时的工作：

```
<audio src="foo.ogg" width="200px" height="200px" /> 
```

# javascript - 数组项作为列表和嵌套列表

> ID：10688933
> 
> 赞同：-1
> 
> 时间：2012-05-21T16:25:59.330
> 
> 标签：javascript, jquery, jquery-plugins, supersized

我为每个背景页面都有一组图像，并且我正在使用一个数组来根据我单击的菜单项加载每个图像。菜单项也有子菜单，整个菜单系统应该与数组项“同步”：

html菜单：

```
Home (page 1) (menu item hidden but should be "Menu 1" if it would be displayed)

 <ul id="menu">
    <li><a href="page2">Menu 2</a></li>
    <li><a href="page3">Menu 3</a> 
          <ul id="sub-menu">
               <li><a href="page4">Menu 4</a></li>
          </ul>
    </li>
    <li><a href="page5">Menu 5</a></li>
 </ul> 
```

大批：

```
[0] 1.jpg (image for the home where the menu name item isn't displayed)
[1] 2.jpg (this should be for Menu 2)
[2] 3.jpg (this should be for Menu 3)
[3] 4.jpg (this should be for Menu 4)
[4] 5.jpg (this should be for Menu 5) 
```

当站点加载时，它会显示 [0] 1.jpg，这是主页。但是我们可以点击的第一个项目是“菜单 2”，因为“主页”按钮没有显示在菜单中，它应该转到 [1] 2.jpg。

这是我使用的 jQuery：

```
jQuery (function($) {
  $("#menu .menu li").each(function (index) {
    var item = $(this);
    $("a", item).click(function (e) {
        e.preventDefault();
        api.goTo(index+1);
    });
   });
}); 
```

使用“api.goTo(index+1);” （在这里使用超大插件）我说（或者我认为我是）在第一次单击菜单项时，转到应该是 [1] 但它不是的 index+1 ，它看起来仍然是[0] 用于主页。此外，我认为嵌套项目仍将遵循索引序列。

基本上我无法获得正确页面的正确图像。这就像我没有根据我单击的菜单项导航数组。

在这种情况下，Ps 索引是 jquery 循环中项目的基于 0 的索引

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:42:56.020

我不知道你在做什么，但是你正在使用一个变量在循环内绑定点击函数，变量会改变，结果不会是你所期望的。

也许这会有所帮助？

```
$('a', 'li').on('click', function(e) {
     e.preventDefault();
     var index = this.href.replace('page', '');
     api.goTo(index);
}); 
```

由于子菜单在点击时从 href 中获取正确的数字似乎是最简单的。

引用数组中的值时，您必须这样做：

```
var index = ['1.jpg', '2.jpg', '3.jpg'] //an array, starts with zero

var firstimage = index[0]; //this variable is now the string "1.jpg" 
```

我猜您只是将一个数字传递给该`api.goTo(number)`函数，该函数会在您的数组中找到图像链接，至少在我看来是这样吗？

# ruby-on-rails - 尝试过滤数组内嵌套哈希中的键

> ID：10688935
> 
> 赞同：0
> 
> 时间：2012-05-21T16:26:08.137
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我有以下数组：

```
[#<PatchedOpenStruct name="Kristen Stewart", id="162655167", characters=["Snow White"]>, #<PatchedOpenStruct name="Chris Hemsworth", id="770829335", ch
aracters=["The Huntsman"]>, #<PatchedOpenStruct name="Charlize Theron", id="162654733", characters=["The Queen"]>, #<PatchedOpenStruct name="Viggo Mort
ensen", id="162654541">, #<PatchedOpenStruct name="Sam Claflin", id="771073196", characters=["Prince"]>] 
```

我正在尝试从中过滤所有“名称”字段。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:52:47.123

如果您只想提取所有名称，请使用[`collect`](https://ruby-doc.org/core/Array.html#method-i-collect)（或其[`map`](https://ruby-doc.org/core/Array.html#method-i-map)别名）对数组的每个元素调用该`name`方法并将结果收集到另一个数组中：

```
names = a.collect(&:name) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T17:03:15.760

如果这些是标准的 OpenStructs，我可以想到两种方法来做到这一点。

`array_of_things.collect{|each_thing| each_thing.name}`返回所有事物的所有名称的数组。 `array_of_things.select{|each_thing| each_thing.name =~ /Kristen/}`返回名称与表达式匹配的事物数组`/Kristen/`。

# compiler-construction - 寻找多语言编译器或优化器（c、c++、java）

> ID：10688936
> 
> 赞同：2
> 
> 时间：2012-05-21T16:26:09.537
> 
> 标签：compiler-construction, multilingual, stm, optimization

简而言之，我正在寻找一种方法来编辑开源编译器或优化器，以将传统的锁实现更改为软件跨国内存事务。我有三种目标语言，C、C++ 和 Java。一个想法可能是使用 GCC，因为它现在支持 stm。问题是，我想不出一种方法来实现对 GCJ 转储的 java 字节码的这些更改。llvm 也会出现同样的问题。

tldr; 试图找到像 gcc 或 llvm 这样的编译器或优化器，我可以很容易地破解源代码或源代码的中间表示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T00:07:25.673

如果您想要一个可以解析和转换 C、C++ 和 Java 的工具，您可以考虑我们的[DMS Software Reengineering Toolkit](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)。

DMS 解析一种语言的源代码，构建 AST，允许您对这些 AST 应用程序或模式直接重写，并且可以为修改后的程序重新生成有效的源文本。源到源的转换比程序转换更容易编写，因为您必须对树的结构了解得更少才能导航/修改它。

DMS 拥有[各种方言的 Java、C、C99 和 C++11 的前端](http://www.semanticdesigns.com/Products/FrontEnds)，使 DMS 能够解析和美化这些语言，并构建完整的符号表，这对于对代码进行任何严肃的转换都是绝对必要的。对于 C 和 Java，DMS 可以提供[控制流、数据流和调用图](http://www.semanticdesigns.com/Products/DMS/FlowAnalysis.html)，它们在许多分析和转换任务中都很有用。对于 C++，DMS 具有控制流分析和数据流分析。

您应该能够通过指定作为锁定习语的模式来找到“传统”锁定实现，然后应用转换来删除它们。

# android - 无法在 xml 中设置操作栏图标

> ID：10688939
> 
> 赞同：1
> 
> 时间：2012-05-21T16:26:19.790
> 
> 标签：android, android-actionbar, android-icons

虽然我可以在我的 Java 代码中设置操作栏图标，但是当我在我的 XML 中设置它们时无法显示它们。我更喜欢在 XML 中设置它们。

以下是我实现相同目标的两次尝试 - 操作栏上的三个图标。你能解释一下为什么第二种方法会失败吗？

（注意，在我的最终版本中，我打算将三个中的两个保留在溢出菜单中，我只是想在测试期间显示所有三个。）

这个 XML：

```
<?xml version="1.0" encoding="utf-8"?>
    <menu xmlns:android="http://schemas.android.com/apk/res/android">
        <item   android:id="@+id/menuConfig"
                android:title="Configuration"
        />
        <item   android:id="@+id/menuAbout"
                android:title="About" 
        />
        <item   android:id="@+id/menuHelp"
                android:title="Help" 
        />
    </menu> 
```

而这个Java：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) 
{
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.optionsmenu, menu);

    MenuItem settings = menu.findItem(R.id.menuConfig);     
    settings.setIcon(R.drawable.settings);
    settings.setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);

    MenuItem about = menu.findItem(R.id.menuAbout);     
    about.setIcon(R.drawable.about);
    about.setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);

    MenuItem help = menu.findItem(R.id.menuHelp);       
    help.setIcon(R.drawable.help);
    help.setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);

    return true;
} 
```

产生这个显示：

![在此处输入图像描述](../Images/06c7d69f6f4c27525138ecb7f90c2240.png)

而这个 XML：

```
<?xml version="1.0" encoding="utf-8"?>
    <menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item   android:id="@+id/menuConfig"
            android:title="Configuration"
            android:icon="@drawable/settings"
            showAsAction="ifRoom"
    />
    <item   android:id="@+id/menuAbout"
            android:title="About" 
            android:icon="@drawable/about"
            showAsAction="ifRoom"
    />
    <item   android:id="@+id/menuHelp"
            android:title="Help" 
            android:icon="@drawable/help"
            showAsAction="ifRoom"
    />
</menu> 
```

而这个Java：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) 
{
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.optionsmenu, menu);

    return true;
} 
```

产生这个显示：

![在此处输入图像描述](../Images/05f98c18e0fd838bbd8e1fe6e6720bb1.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:37:22.440

没关系。

溢出菜单仅显示文本。仅当项目在操作栏中显示为操作时才使用图标。

如果您想查看操作栏中的图标，您必须使用

```
android:showAsAction="ifRoom" 
```

代替

```
showAsAction="ifRoom" 
```

# iphone - UIButton 类参考文档上的 addTarget 方法

> ID：10688940
> 
> 赞同：0
> 
> 时间：2012-05-21T16:26:24.673
> 
> 标签：iphone, ios, class, reference, uibutton

为什么我没有看到 addTarget 方法：

`[button addTarget:(id) action:(SEL) forControlEvents:(UIControlEvents)]`

关于 UIButton 类参考文档：

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIButton_Class/UIButton/UIButton.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIButton_Class/UIButton/UIButton.html)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:27:02.190

它是 UIControl 的继承方法

# ruby-on-rails - Ruby on Rails Model.find()：两个查询而不是子查询

> ID：10688944
> 
> 赞同：1
> 
> 时间：2012-05-21T16:26:34.803
> 
> 标签：ruby-on-rails, sqlite

我正在使用 Ruby on Rails 2.3.5 从我的 SQLite 数据库中接收一组模型。目前我正在使用子查询来选择我真正想要的那些：

```
find(:all, 
  :conditions => "foo.id in (
                    SELECT bar.foo_id FROM bar
                    JOIN baz
                      ON baz.bar_id = bar.id
                    WHERE baz.bla in (1, 2, 3)
                  )"
) 
```

我知道这很愚蠢，因为子查询为每一行评估相同的结果，我猜 SQLite 不够聪明，无法注意到它可以被优化。所以我想把它从查询中删除。我知道我可以简单地使用第二个从 Rails 调用它`find()`，但是考虑到子查询的返回值可能会变得比较大，我想在数据库中做所有事情，所以我不需要在数据库和 Rails。

那么，我该如何做模型`find()`并告诉它，它应该查找我的实际子查询的返回值，然后使用它的结果来比较我的其他行？我可以通过一次调用将其传递给`find()`SQLite 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T17:54:32.327

通常，您应该尝试在模型中定义您的关系。这样你就可以轻松使用 ActiveRecord 的助手

```
class Foo < ActiveRecord::Base
  self.table_name = "foo"

  has_many :bars
end

class Bar < ActiveRecord::Base
  self.table_name = "bar"

  belongs_to :foo
  has_many :bazs
end

class Baz < ActiveRecord::Base
  self.table_name = "baz"

  belongs_to :bar
end 
```

有了这些模型，您可以编写类似于以下内容的查询：

```
Foo.find(:all, :include => {:bar => :baz}, :conditions => ["#{Baz.table_name}.id IN (?)", [1,2,3]]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:48:14.383

给定以下模型：

```
class Foo < ActiveRecord::Base
  has_many :bars
  has_many :bazs, :through => :bars

  attr_accessible :title
end

class Bar < ActiveRecord::Base
  belongs_to :foo
  has_many :bazs

  attr_accessible :title
end

class Baz < ActiveRecord::Base
  belongs_to :bar

  attr_accessible :title
end 
```

你可以：

```
Foo.all(
  :joins => { :bars => :bazs },
  :conditions => { :bars => { :bazs => { :id => [1000] } } }
) 
```

`1000`您感兴趣的 Baz 的 id 在哪里。

这将生成以下 SQL：

```
SELECT "foos".* FROM "foos" INNER JOIN "bars" ON "bars"."foo_id" = "foos"."id" INNER JOIN "bazs" ON "bazs"."bar_id" = "bars"."id" WHERE "bazs"."id" IN (1000) 
```

如果你这样做是一样的：

```
Foo.all(
  :joins => { :bars => :bazs },
  :conditions => { :bazs => { :id => [1000] } }
) 
```

甚至更好，使用`through`关联：

```
Foo.all(
  :joins => [:bazs],
  :conditions => { :bazs => { :id => [1000] } }
) 
```

结果将是符合该条件的所有 Foo 记录，并且 SQL 将是相同的。

希望这能回答你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T17:33:34.813

我想知道您是否可以执行以下操作：

```
 subs = connection.select_rows("SELECT bar.foo_id FROM bar
                                   JOIN baz
                                   ON baz.bar_id = bar.id
                                   WHERE baz.bla in (1, 2, 3)")
    find(:all, :conditions => "foo.id in (#{subs.join(',')})") 
```

这就是我试图在 Rails 3 中重写的内容。

# java - 如何让一个窗口可以监听另一个窗口？

> ID：10688948
> 
> 赞同：-1
> 
> 时间：2012-05-21T16:26:38.423
> 
> 标签：java, windows, multithreading, modal-dialog, jdialog

这个怎么运作？

1.  MiWindows 类负责运行 MiOtherWindows 类。
2.  MiOtherWindows 类与更改其状态并关闭的用户进行交互。
3.  MiWindows 类检测 MiOtherWindows 类中值的变化。
4.  Class MiWindows 打印出更改。

问题是什么？MiWIndows 类没有检测到子类 MiOtherWindows 中的变化。

问题？

如何制作一个窗口我可以在不使用线程的情况下收听另一个窗口？

//------------------------------------------------ ------------------

//这里是 MiWindows 的代码

```
public class MiWindows extends JDialog {

    private JButton doing = new JButton("The Button");

    public MiWindows(SeconWindows owner) {

        doing.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent e) {
                Object value;
                try {
                    value = new MiOtherWindows(MiWindows.this).getValue();
                    if (value != null) {
                        System.out.println("Never Print this...");
                    }
                } catch (Exception x) {
                    System.out.println("exception");
                }
            }
        });
    }
} 
```

//------------------------------------------------ ------------------

//这里是 MiOtherWindows 的代码

```
public class MiOtherWindows extends JDialog {

    private JButton close = new JButton("The Button");
    private String value = null;

    public MiOtherWindows(JDialog owner) {
        super(owner);
        //super(owner, true); modal don't work

        close.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                this.value = "This is Result";
                setVisible(false);
            }
        });
    }

    public String getValue() {
        return value;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:51:38.587

更改构造函数的定义

`public VentanaCrearExamen(JDialog owner)`

到

`public VentanaCrearExamen(MiWindows owner)`

将引用存储`MiWindows`在`MiWindow`：

```
private MiWindows owner;
.....
public VentanaCrearExamen(MiWindows owner) {
    this.owner = owner;
} 
```

中定义特殊的回调方法`MiWindows`，例如

```
public void childActionPerformed(ActionEvent e) {
} 
```

现在，当发生任何事件时，`MiWindow`您可以调用回调方法`MiWindows`

```
 close.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            this.value = "This is Result";
            setVisible(false);
            owner.childActionPerformed(e);
        }
    }); 
```

许多其他解决方案也可用。我希望这个技巧可以帮助你，并且可能会给你其他的想法。

# c# - 使用 jquery ajax 在 aspx.cs 文件中调用 webmethod

> ID：10688951
> 
> 赞同：10
> 
> 时间：2012-05-21T16:26:46.177
> 
> 标签：c#, jquery, asp.net, ajax, webmethod

我有一个 default.aspx.cs，其中包含要调用的 webmethod，并且我的 js 文件包含我的 jquery ajax。我无法调用 webmethod。

这是我的 default.aspx.cs：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        string[] MyArray = new string[1];
        MyArray[0] = "My Value";

        Grid1D.DataSource = MyArray;
        Grid1D.DataBind();
    }

    [WebMethod]
    public Details[] getDetails(string columnname, string inputVal)
    {
        List<Details> list = new List<Details>();

        DbAccess dbacc = new DbAccess();

        DataTable dt = dbacc.getReportDetails(columnname, inputVal);

        foreach (DataRow row in dt.Rows)
        {
            Details _Details = new Details();
            _Details.memid = row["memid"].ToString();
            _Details.usrname = row["usrname"].ToString();
            _Details.fullname = row["fullname"].ToString();
            _Details.fname = row["fname"].ToString();
            _Details.mname = row["mname"].ToString();
            _Details.lname = row["lname"].ToString();
            _Details.bdate = row["bdate"].ToString();
            _Details.address = row["address"].ToString();
            _Details.sponsorid = row["sponsor_id"].ToString();
            _Details.parentid = row["parent_id"].ToString();
            _Details.placement = row["placement"].ToString();
            _Details.datejoined = row["date_joined"].ToString();

            list.Add(_Details);
        }

        Grid1D.DataSource = list.ToArray();
        Grid1D.DataBind();

        return list.ToArray();
    } 
```

这是我的js文件：

```
function retrieveReportData() {
    var columnName = $("#ddlFilters").val();
    var input = $("#tags").val();

    if (columnName != "Select") {

        var Data = JSON.stringify({ columnname: columnName, inputVal: input });

        alert(Data);

        $.ajax({

            url: "Default.aspx/getDetails",
            data: Data,
            type: "POST",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            success: function (mydata) {

                alert(mydata.d);
            }
        });

    }
    else 
        alert("Please choose search filter");
} 
```

您可能会注意到我正在提醒我的数据以确保我有正确的值发送到我的 web 方法。但就像我说的那样，它无法调用我的 web 方法，也没有在我的 ajax 中继续我的成功函数。帮助！谢谢！:)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-21T16:30:49.650

你的 webmethod 需要是`static`.

```
[WebMethod]
public static Details[] getDetails(string columnname, string inputVal) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-20T05:03:00.313

这是一个完整的示例，它从头到尾展示了如何使用 asp.net 页面通过 ajax 请求调用服务器端“webmethod”的整个过程。

[http://www.codeproject.com/Questions/374136/Call-Page-Method-From-Jquery-Ajax-Call](http://www.codeproject.com/Questions/374136/Call-Page-Method-From-Jquery-Ajax-Call)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T16:29:56.623

尝试设置`type`为“Get”并在 URL 中发送参数而不是 Data

```
url: "Default.aspx/getDetails/?colunmname="+colname+"&inputVal="+inputValue,
type: "GET" 
```

# c# - 从 Tansport 代理处理 Exchange 存储中的电子邮件

> ID：10688953
> 
> 赞同：0
> 
> 时间：2012-05-21T16:26:58.523
> 
> 标签：c#, exchange-server

我想通过编写自定义交换传输代理在出站电子邮件中附加一些文本。

代理中是否有一种方法可以更新 Exchange 存储上用户已发送项目文件夹中的原始邮件，并从集线器服务器执行此操作？

# windows - 在 Windows 上集成 Vim 和 Git

> ID：10688958
> 
> 赞同：3
> 
> 时间：2012-05-21T16:27:12.693
> 
> 标签：windows, git, vim

我在 Windows 机器上使用 gVim 已经有一段时间了，我喜欢它。我没有使用 Cygwin，我宁愿不安装它。我正在使用适用于 Windows 的 msysgit 版本的 Git。

我希望将 Git 集成到 gVim 中，这样我就不必经常打开 msysgit 并导航到正确的目录。我觉得集成最重要的命令真的会加速/增强我的代码开发。

是否有一个 Vim 插件可以为我做到这一点？

我终于重新安装了 Git For Windows 几次，直到我得到我想要的设置。我使用“运行 Git 并包含来自 Windows 命令提示符的 Unix 工具”安装了 Git。这似乎可以让 !git 命令主要在 Vim 中工作。这篇旧博客文章让我了解了一些问题：http: [//devlicio.us/blogs/sergio_pereira/archive/2009/05/06/git-ssh-putty-github-unfuddle-the-kitchen-sink.aspx](http://devlicio.us/blogs/sergio_pereira/archive/2009/05/06/git-ssh-putty-github-unfuddle-the-kitchen-sink.aspx)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T19:39:46.153

我知道的 Git 前端有很多：[Fugitive](https://github.com/tpope/vim-fugitive)和[VCSCommand](http://repo.or.cz/w/vcscommand.git)已经提到过，还有[vim-addon-git](https://github.com/MarcWeber/vim-addon-git)（仅限 Git）、[vcsi](https://github.com/kana/vim-vcsi/blob/master/doc/vcsi.txt)（多后端）、[scmfrontend](https://bitbucket.org/ns9tks/vim-scmfrontend)（多后端）、mine [arum](https://bitbucket.org/ZyX_I/aurum) （多后端） ，但我几乎只使用 Mercurial，因此其他人没有经过很好的测试）。

据我所知，Fugitive 和 aurum 是功能最丰富的（主要我没有的是 Fugitive 对 Git 索引的操作），VCSCommand 也不错（它是最古老的，非常流行，因此有很多已修复的错误），其他人可能具有次要优势，但是AFAIK其中一个实现的所有东西也由逃犯或金实现（当然，我的意思只是关于Git的事情）。

是的，我对这些与 msysgit 的集成程度一无所知。我的应该可以正常`system('git')`工作，但在[Windows](http://en.wikipedia.org/wiki/Microsoft_Windows) (Wine) 下只测试了 Mercurial。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:40:43.467

您可以尝试[Fugitive](https://github.com/tpope/vim-fugitive)（仅限 Git）或[VCSCommand](http://www.vim.org/scripts/script.php?script_id=90)（多后端），但我不知道它们与`msysgit`.

这可能是一个愚蠢的问题，但是：不起作用`:!git commit<CR>`？

# php - Nginx，PHP中的斜线参数

> ID：10688961
> 
> 赞同：2
> 
> 时间：2012-05-21T16:27:18.373
> 
> 标签：php, apache, symfony, nginx

安装 Symfony2 后，我正在尝试访问此 URL：

```
http://test/symfony/web/app_dev.php/ 
```

但它不起作用，因为斜杠，我得到一个 404。

这些工作正常：

```
http://test/symfony/web/app_dev.php
http://test/symfony/web/app_dev.php?/ 
```

在 Apache 中，/app_dev.php/something 和 /app_dev.php?/something 是相同的。关于如何在 Nginx 中进行这项工作的任何想法？

我尝试添加重写，但没有运气：

```
 location / {
            try_files $uri $uri/ @rewrite index.html;
    }

    location @rewrite {
            rewrite ^/(.*\.php)/(.*)$ $1?/$2;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T19:04:21.257

这就是我所拥有的，它工作正常：

```
 location / {
            # Remove app.php from url, if somebody added it (doesn't remove if asked for /app.php on the root)
            rewrite ^/app\.php/(.*) /$1 permanent;

            try_files $uri $uri/ /app.php?$query_string;
    }

    location ~ \.php$ {
            try_files $uri = 404;
            # Below is for fastcgi:
            # fastcgi_pass    127.0.0.1:9000;
            # fastcgi_index   app.php;
            # include         /etc/nginx/fastcgi_params;
            # fastcgi_param   SCRIPT_FILENAME /mnt/www/live/current/web$fastcgi_script_name;
            # fastcgi_param   SERVER_PORT 80;
            # fastcgi_param   HTTPS off;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T19:28:05.547

我终于偶然发现了一个对我有用的答案：

```
 location ~ /directory/(.*\.php)(/.*)$ {
            set $script_filename $1;
            set $path_info $2;
            fastcgi_param  PATH_INFO        $2;
            alias /place/directory/$1;
            include fastcgi_params; 
```

[https://github.com/plack/Plack/issues/281](https://github.com/plack/Plack/issues/281)

这是文档中的相关片段：请注意，它们都没有使用 nginx 提供的 FCGI 参数作为 script_name 或 path_info ，因为已知它是不正确的。

```
location / {
 set $script "";
 set $path_info $uri;
 fastcgi_pass unix:/tmp/fastcgi.sock;
 fastcgi_param  SCRIPT_NAME      $script;
 fastcgi_param  PATH_INFO        $path_info; 
```

# javascript - javascript中的二维数组总和

> ID：10688964
> 
> 赞同：0
> 
> 时间：2012-05-21T16:27:32.367
> 
> 标签：javascript

我需要经常添加一个二维数组。想法是我有一个生成的二维数组，我必须得到所有生成的数组的总和。我试着写：

```
sum+=parseFloat(twoArray[a][b]); 
```

但是脚本被阻止了，我什么也没得到。`a`它是一个循环，因此,的值`b`从浮动`0`到用户插入的变量。我已经测试了脚本，这是它中断的地方。

```
if (k>=3){                          
    for(var i=0;i<A.length;i++){
        var smaller=new Array(A.length-1);
        for(var h=0;h<smaller.length;h++){
            smaller[h]=new Array(smaller.length);
        }
        for(var a=1;a<A.length;a++){
            for(var b=0;b<A.length;b++){
                if(b<i){
                    smaller[a-1][b]=A[a][b];
                }
                else if(b>i){
                    smaller[a-1][b-1]=A[a][b];
                }
            }   
        }
        sum+=parseFloat(smaller[a][b]);
        alert (sum);
        //dam valorile
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:30:58.377

放一个

```
try {
  sum+=parseFloat(twoArray[a][b]);
} catch (e) {
   console.log(e)
} 
```

在你的循环中。

所以你会看到它在哪里被阻塞，无效的输入不会阻止剩余的求和。

当然，我想您之前正确检查过数组索引与长度。

# html - 即使用户允许，Gmail 也会隐藏外部电子邮件图片

> ID：10688965
> 
> 赞同：2
> 
> 时间：2012-05-21T16:27:43.950
> 
> 标签：html, gmail

我正在尝试在 html 电子邮件中插入带有图像的签名。我对 GMail 有一些问题（它适用于 iPhone 客户端）。

在用户接受图像之前，它们的大小已经正确，并且替代文本是可见的：

![用户允许之前的图像](../Images/497e4eada9f9647eac8b9e1ccb68df55.png)

然后每个图像的 HTML 为：

```
<img alt="Bonne" width="80" height="80"> 
```

所以这是正常的，但是当用户点击“允许此电子邮件中的图像”（不知道英文的确切标签）时，它们就会消失：

![用户允许后的图像](../Images/642544cb4b112dcb241d2c20da06e15a.png)

如果我检查元素，我可以看到添加了一些代码来隐藏它们：

```
<img src="http://demo.smartadserver.com/Shared/happy-customers/Content/images/happy.png" alt="Bonne" width="0" height="0" style="display: none !important; visibility: hidden !important; opacity: 0 !important; background-position: 80px 80px; "> 
```

不知道Gmail是做什么的，有人有想法吗？

**编辑**

原图标签：

```
<img src="http://demo.smartadserver.com/Shared/happy-customers/Content/images/unhappy.png" alt="Mauvaise" width="80" height="80" style="border : 0; width:80px; display: block;   margin-left: auto;   margin-right: auto;" hspace="10" /> 
```

全球 HTML：

```
 <center>
        <table border="0" cellpadding="0" cellspacing="0" id="backgroundTable" style="border-color:#FFFFFF" >
            <tbody>
            <tr>
                 <td valign="top">
                    <div >
                        <h4 class="h4">Si vous avez une seconde, vous pouvez évaluer ma réponse :</h4>
                    </div>
                </td>
            </tr>
            <tr>
                <td align="center" valign="top">
                    <table border="0" cellpadding="0" cellspacing="0" width="600" id="templateBody" style="border-color:#FFFFFF">
                        <tbody>
                            <tr>
                                <td valign="top" width="180" class="leftColumnContent">
                                    <table border="0" cellpadding="20" cellspacing="0" width="100%" style="border-color:#FFFFFF">
                                        <tbody><tr>
                                            <td valign="top">
                                                <a href="http://demo.smartadserver.com/Shared/happy-customers/vote/21142b09-3eab-4c07-aa64-e09e6924cd89/Happy" style="text-decoration: none;outline: none; " title="Bonne">
                                                    <img src="http://demo.smartadserver.com/Shared/happy-customers/Content/images/happy.png" alt="Bonne" width="80" height="80" style="border : none;  width:80px; display: block;   margin-left: auto;   margin-right: auto;"  />
                                                    <div style="text-align: center;">
                                                       <h4 class="h4" style="text-decoration: underline; color:#50b748; margin-bottom:0;">Bonne</h4>
                                                       <span style="color:#50b748;">Rapide, utile et agréable.</span>
                                                    </div>
                                                </a>
                                            </td>
                                        </tr>
                                    </tbody></table>
                                </td>
                                <td valign="top" width="180" class="centerColumnContent">
                                    <table border="0" cellpadding="20" cellspacing="0" width="100%" style="border-color:#FFFFFF">
                                        <tbody><tr>
                                            <td valign="top">
                                                <a href="http://demo.smartadserver.com/Shared/happy-customers/vote/21142b09-3eab-4c07-aa64-e09e6924cd89/Neutral" style="text-decoration: none;outline: none; margin-bottom:0;" title="Moyenne" >
                                                  <img src="http://demo.smartadserver.com/Shared/happy-customers/Content/images/neutral.png" alt="Moyenne" width="80" height="80" style="border : 0; display: block; width:80px;   margin-left: auto;   margin-right: auto;" >
                                                  <div   style="text-align: center;">
                                                    <h4 class="h4" style="text-decoration: underline; color:#ffd300; margin-bottom:0;" >Moyenne</h4>
                                                    <span style="color:#ffd300;">Acceptable, mais insufisant.</span>
                                                  </div>
                                                </a>

                                            </td>
                                        </tr>
                                    </tbody></table>
                                </td>
                                <td valign="top" width="180" class="rightColumnContent">
                                    <table border="0" cellpadding="20" cellspacing="0" width="100%" style="border-color:#FFFFFF">
                                        <tbody><tr>
                                            <td valign="top">
                                                <a href="http://demo.smartadserver.com/Shared/happy-customers/vote/21142b09-3eab-4c07-aa64-e09e6924cd89/Unhappy" style="text-decoration: none;outline: none;" title="Mauvaise">
                                                  <img src="http://demo.smartadserver.com/Shared/happy-customers/Content/images/unhappy.png" alt="Mauvaise" width="80" height="80" style="border : 0; width:80px; display: block;   margin-left: auto;   margin-right: auto;" hspace="10" />
                                                    <div style="text-align: center; ">
                                                    <h4 class="h4" style="text-decoration: underline; color:#be1e2d; margin-bottom:0;">Mauvaise</h4>
                                                        <span style="color:#be1e2d;">Malheureusement, je n'en suis pas satisfait.</span>
                                                    </div>
                                                </a>
                                            </td>
                                        </tr>
                                    </tbody></table>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
        </tbody>
        </table>
    </center> 
```

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-07T15:32:32.983

这种属性不是由 Gmail 添加的，而是浏览器正在使用的插件 - 特别是 AdblockPlus 插件（恰好在其过滤器中有 smartadserver.com）。您的 HTML 在 Gmail 中运行良好，否则我试了一下。

您可以通过禁用插件或从 Adblock 过滤器列表中删除 smartadserver.com 在浏览器中显示它。

但是...如果您想防止这种情况发生在其他人身上...**将图像托管在另一台服务器上，这样该域就不会被广告过滤器列入黑名单**。

还有另一个兼容性说明……一些邮件客户端不支持 png 图像格式。

# ruby-on-rails - 有没有办法使用 schema.rb 从 Rails 内部创建数据库？

> ID：10688967
> 
> 赞同：3
> 
> 时间：2012-05-21T16:27:58.733
> 
> 标签：ruby-on-rails, database, ruby-on-rails-3, activerecord

在 Rails 3.2.3 应用程序中，我需要允许管理员创建数据库并使用 schema.rb 中的表填充它。

只执行 schema.rb 中的代码是理想的。基本上，我正在寻找一种方法：

```
rake db:setup 
```

不使用“耙子”。

我还有几件事想做，比如备份数据库，我想知道是否有我可以使用的 Rails DSL，或者我是否只需要编写 SQL 并通过 ActiveRecord::Base 运行它.连接.执行。

谢谢你的尽心帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T16:39:11.000

您可以尝试从您的应用程序运行它：

```
 system("rake db:setup") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T16:37:39.367

```
rake db:setup
rake db:schema:load 
```

这将创建一个数据库（如果不存在）并将 a 加载`schema.rb`到数据库中。如果您不想使用`rake`，可以将模式存储为原始 sql 并加载它。

您可以使用[备份](https://github.com/meskyanichi/backup)gem 进行备份。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T18:01:04.657

我不知道我是否理解正确，但是

您可以使用 seed.rb 以便创建表条目，例如：

```
Person.create(email: "tom@mail.com", firstname: "Tom", phone: "0049-0") 
```

然后做一个

```
rake db:seed 
```

在控制台中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-23T01:06:11.403

您可以使用 'load "path/to/schema.rb" 加载它，它将从当前打开的连接创建数据库

# typo3 - TYPO3 Extbase storagePid

> ID：10688970
> 
> 赞同：4
> 
> 时间：2012-05-21T16:28:06.307
> 
> 标签：typo3, extbase

我需要获取实际的“一般记录存储页面 id”。我找到了以下代码片段，但即使在页面上设置了 storagePid，变量也是空的。

```
$config = $this->configurationManager->getConfiguration(Tx_Extbase_Configuration_ConfigurationManagerInterface::CONFIGURATION_TYPE_FRAMEWORK);
var_dump($config['persistence']['storagePid']); 
```

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T17:08:08.290

我不太确定，你想得到什么。您提供的代码段可以毫无问题地为您的扩展在常量中设置 storagePid，与以下代码相同`setup.txt`：

```
plugin.tx_yourext {
    persistence {
        storagePid = {$plugin.tx_yourext.persistence.storagePid}
    }
} 
```

如果您在使用提供的代码段获取 storagePid 时遇到问题，也可以修改您的`setup.txt`并确保该值也将传播到`settings`范围：

```
plugin.tx_yourext {
    persistence {
        storagePid = {$plugin.tx_yourext.persistence.storagePid}
    }
    settings {
        storagePid = {$plugin.tx_yourext.persistence.storagePid}
    }
} 
```

然后在您的控制器中，您可以使用更简单的代码来捕获它：

```
$myStoragePid = $this->settings['storagePid']; 
```

如果它对您不起作用，这意味着您没有`Constants`为 YourExt 设置正确的值和/或没有清除 BE 中的缓存。

顺便说一句：也许如果你能更具体一点，我可以发送更好的答案。

# svn - ONE MAN SHOP 的 svn 设置建议

> ID：10688971
> 
> 赞同：1
> 
> 时间：2012-05-21T16:28:07.717
> 
> 标签：svn

我对 svn 完全陌生，我最后一次使用任何类型的源代码控制是 1987 年（sccs）。我是一个单人开发团队，我使用 svn 的唯一目的是让我拥有一份正在生产中的源代码副本，以便我可以快速修复，同时拥有另一个副本来进行新功能开发。如果我发现需要立即关注的错误，我会在“快速修复”副本中修复它，将其推送到生产环境，然后将更改合并到“正在进行的开发”副本中。当我将“正在进行的开发”投入生产时，我需要重置“快速修复”副本。

我实际上开发了 3 个站点，它们有很多共同点，一些共享代码，但大多数情况下它们之间的通信方式是不同的。

我最大的困惑是术语“工作副本”和“书签”。而且我还想知道“主干”、“分支”和“标签”等术语，我什至需要它作为一个人的商店吗？

关于如何设置的任何建议？我唯一能从相关问题中了解到的是，我可能应该为所有三个站点使用 1 个存储库。除此之外，我不知道如何设置它，如果有什么不同，我会在 Mac 上使用版本。

更新：下面建议的书非常好，而且我已经把它全部理顺了（我认为）。最初的混淆是关于书签一词。原来这是一个版本（Mac）特定的术语，书签只是为工作副本添加书签。

所以这就是我想出来的，首先创建一个存储库，然后导入我的三个站点

为每个站点创建两个工作副本

```
brad/tvdco/prod
brad/tvdco/fix
brad/neeis/prod
brad/neeis/fix
brad/pdftk/prod
brad/pdftk/fix 
```

开始研究 ?/prod 工作副本中的新功能

如果我需要紧急修复，我在 ?/fix 中修复/测试，将该修复提交到存储库，然后将其导出并推送。

然后我更新 ?/prod 以将该修复程序用于新的开发。

当我准备好推送新功能时，我提交 ?/prod，导出它，向上推送，转到 ?/fix 并更新它。

从 svn 的角度来看非常直截了当。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:34:03.637

对于一个人的团队，我总是建议[git](http://git-scm.com/)，一个分布式版本控制系统。它*不需要*中央服务器，在我看来，它比 SVN 更容易设置和更灵活 --- 至少对于您描述的用例而言（我不想在这里引发一场激烈的战争:)） . `git`有一个惊人的[官方文档](http://git-scm.com/documentation)，甚至[还有关于 stackoverflow 的初学者指南](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide)。

老实说，它自己的术语是一开始就必须学习的东西。`svn`我的一些前段时间还在使用的朋友，并没有`git`轻易切换到。但是，如果您很长时间没有使用版本控制，您可能会发现`git`'s 的方法很新鲜。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:49:34.000

查看[SVN 书籍](http://svnbook.red-bean.com/nightly/en/index.html)（在线）以帮助您前进。它将向您介绍应该对您有所帮助的概念。第一章将帮助您了解术语。

很多设置都取决于您以及您希望如何使用它。大多数 repos 使用 Branch、Tag、Trunk 根设置，但这不是必需的。

# java - NullPointerException 崩溃

> ID：10688972
> 
> 赞同：-3
> 
> 时间：2012-05-21T16:28:12.303
> 
> 标签：java, android, http, crash

我遇到了一个空指针期望的崩溃。我正在让用户注册，但我不确定是否是我的后端失败了。我已经将我的应用程序指向了我的 php 文件，并且我检查了我的 Apache 日志并且它正在到达那里。

代码：

```
signUpButton.setOnClickListener(new OnClickListener(){
        public void onClick(View arg0) 
        {                       
        if (usernameText.length() > 0 &&        
                        passwordText.length() > 0 && 
                        passwordAgainText.length() > 0 &&
                        eMailText.length() > 0
                        )
                    {
                        //TODO check email adress is valid

                        if (passwordText.getText().toString().equals(passwordAgainText.getText().toString())){

                            if (usernameText.length() >= 5 && passwordText.length() >= 5) {

                                    Thread thread = new Thread(){
                                        String result = new String();
                                        @Override
                                        public void run() {
                                            result = imService.signUpUser(usernameText.getText().toString(), 
                                                    passwordText.getText().toString(), 
                                                    eMailText.getText().toString());

                                            handler.post(new Runnable(){

                                                public void run() {
                                                    if (result.equals(SERVER_RES_RES_SIGN_UP_SUCCESFULL)) {
                                                        showDialog(SIGN_UP_SUCCESSFULL);
                                                    }
                                                    else if (result.equals(SERVER_RES_SIGN_UP_USERNAME_CRASHED)){
                                                        showDialog(SIGN_UP_USERNAME_CRASHED);
                                                    }
                                                    else  if (result.equals(SERVER_RES_SIGN_UP_FAILED)) 
                                                    {
                                                        showDialog(SIGN_UP_FAILED);
                                                    }           
                                                }

                                            });
                                        }

                                    };
                                    thread.start();
                            }
                            else{
                                showDialog(USERNAME_AND_PASSWORD_LENGTH_SHORT);
                            }                           
                        }
                        else {
                            showDialog(TYPE_SAME_PASSWORD_IN_PASSWORD_FIELDS);
                        }

                    }
                    else {
                        showDialog(FILL_ALL_FIELDS);

                    }               
                }           
            });

            cancelButton.setOnClickListener(new OnClickListener(){
                public void onClick(View arg0) {
                Toast.makeText(getApplicationContext(), "Sorry! Please try again.", Toast.LENGTH_SHORT).show();
                {                   
                }               
            }});

        }

    protected Dialog onCreateDialog(int id) 
    {       

        switch (id) 
        {
            case TYPE_SAME_PASSWORD_IN_PASSWORD_FIELDS:         
                return new AlertDialog.Builder(SignUp.this)       
                .setMessage(R.string.signup_type_same_password_in_password_fields)
                .setPositiveButton(R.string.OK, new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                        /* User clicked OK so do some stuff */
                    }
                })        
                .create();          
            case FILL_ALL_FIELDS:               
                return new AlertDialog.Builder(SignUp.this)       
                .setMessage(R.string.signup_fill_all_fields)
                .setPositiveButton(R.string.OK, new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                        /* User clicked OK so do some stuff */
                    }
                })        
                .create();
            case SIGN_UP_FAILED:
                return new AlertDialog.Builder(SignUp.this)       
                .setMessage(R.string.signup_failed)
                .setPositiveButton(R.string.OK, new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                        /* User clicked OK so do some stuff */
                    }
                })        
                .create();
            case SIGN_UP_USERNAME_CRASHED:
                return new AlertDialog.Builder(SignUp.this)       
                .setMessage(R.string.signup_username_crashed)
                .setPositiveButton(R.string.OK, new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                        /* User clicked OK so do some stuff */
                    }
                })        
                .create();
            case SIGN_UP_SUCCESSFULL:
                return new AlertDialog.Builder(SignUp.this)       
                .setMessage(R.string.signup_successfull)
                .setPositiveButton(R.string.OK, new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                        finish();
                    }
                })        
                .create();  
            case USERNAME_AND_PASSWORD_LENGTH_SHORT:
                return new AlertDialog.Builder(SignUp.this)       
                .setMessage(R.string.username_and_password_length_short)
                .setPositiveButton(R.string.OK, new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                        /* User clicked OK so do some stuff */
                    }
                })        
                .create();
            default:
                return null;

        }

    }

    @Override
    protected void onResume() {
        bindService(new Intent(SignUp.this, IMService.class), mConnection , Context.BIND_AUTO_CREATE);

        super.onResume();
    }

    @Override
    protected void onPause() 
    {
        unbindService(mConnection);
        super.onPause();
    }

} 
```

LogCat：05-21 13:47:22.237：E/AndroidRuntime（522）：致命异常：主要

```
05-21 13:47:22.237: E/AndroidRuntime(522): java.lang.NullPointerException 

05-21 13:47:22.237: E/AndroidRuntime(522):  at com.mekya.SignUp$2$1$1.run(SignUp.java:113) 

05-21 13:47:22.237: E/AndroidRuntime(522):  at android.os.Handler.handleCallback(Handler.java:587) 

05-21 13:47:22.237: E/AndroidRuntime(522):  at android.os.Handler.dispatchMessage(Handler.java:92) 

05-21 13:47:22.237: E/AndroidRuntime(522):  at android.os.Looper.loop(Looper.java:123) 05-21 13:47:22.237: E/AndroidRuntime(522):   at android.app.ActivityThread.main(ActivityThread.java:4627) 

05-21 13:47:22.237: E/AndroidRuntime(522):  at java.lang.reflect.Method.invokeNative(Native Method) 

05-21 13:47:22.237: E/AndroidRuntime(522):  at java.lang.reflect.Method.invoke(Method.java:521) 

05-21 13:47:22.237: E/AndroidRuntime(522):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868) 05-21 13:47:22.237: E/AndroidRuntime(522):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626) 

05-21 13:47:22.237: E/AndroidRuntime(522):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:15:17.427

看起来`result`是`null`....

# javascript - 通过索引读取 localStorage 值

> ID：10688974
> 
> 赞同：2
> 
> 时间：2012-05-21T16:28:16.273
> 
> 标签：javascript, local-storage, sessionstorage

> `ls.getItem[i]`使用索引而不是键使 Chrome 中的 localStorage 读取性能翻倍`ls.getItem('key')`

资料来源：[这篇推文](https://twitter.com/#!/johnallsopp/status/177964915632513024)和一些人写的一些很棒的 JavaSciript 库的[演讲（幻灯片 19）。](https://docs.google.com/present/view?id=0Ac0YlG9vMA2LZHE1MnpycF8yMGZ6ZnZxa2hy&pli=1)我想这些人知道他们在说什么，所以我想知道为什么这对我不起作用：

```
localStorage.setItem(0, 'Hello world');
localStorage.getItem(0); // 'Hello World' – Works as expected
localStorage.getItem[0]; // undefined 
```

我是不是误会了什么？根据那次谈话，最后一个方法调用应该返回`'Hello world'`not `undefined`。

他们也链接到[这个 JS Bin](http://jsbin.com/ifucuc/9)，但是当通过索引读取值时，我仍然得到`undefined`.

*编辑：我知道如何使用 localStorage 正确读取索引，我在询问`getItem`索引。似乎谈话只是暗示了错误的用法？另外，我想知道为什么 32 人在没有测试的情况下转发了该用法。这些事情让我很生气。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T07:03:07.090

我的名字是克里斯，我是造成混乱的幻灯片的负责人。对于造成的混乱，我深表歉意。幻灯片有点开玩笑。让我解释一下。。

在我们小组讨论之前的几天里，发布并转发了一条推文，内容是关于将 localStorage 的读取性能提高一倍。推文是您引用的推文（[Twitter](https://twitter.com/johnallsopp/status/177964915632513024)）。然而，当我看到这条推文时，我做了一个双重考虑，因为语法对我来说看起来非常错误。我测试语法只是为了发现与您所做的相同的事情：如果您尝试访问 localStorage 中的值，此语法显然无效。

在 SXSW 的舞台上，这个神话被当作一个笑话来呈现。是的，通过在 localStorage.getItem 上引用数字索引，您可以获得双倍的性能。但是，所有值都未定义。

无论如何，似乎为了消除错误信息的传播，我设法进一步传播了它。感谢您提请我们注意这个问题！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-10-05T18:40:28.727

通过索引访问不起作用（至少在 Chrome 中）。但是你可以使用：

```
localStorage.getItem(localStorage.key(0));
```

localStorage.key(n) 返回第 n 个键的值，然后将其传递给 localStorage.getItem()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T16:51:38.543

```
localStorage.getItem(); 
```

是一个函数，因此您不能使用数组表示法访问它，而是可以使用：

```
localStorage.setItem(0, 'foo');
localStorage[0]; // 'foo' 
```

如果您使用字符串键，您可以这样做：

```
localStorage.setItem('foo', 'bar');
localStorage.foo // 'bar' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T16:34:24.827

我认为应该只是：

```
localStorage[0] 
```

这当然适用于最新版本的 Chrome。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T16:34:54.540

我不明白这是如何工作的：

```
localStorage.getItem[0]; 
```

`getItem`是一种方法，不能像那样访问。

不过，可以直接通过密钥访问 localStorage。可以这样做：

```
console.log( localStorage[0] );
console.log( localStorage['test'] ); 
```

无论它是否比方法更快，您都必须自己测试它。

[jsFiddle 在这里](http://jsfiddle.net/tdmPn/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-21T16:32:51.057

你就是不能那样做。获取项目的两种正确方法是通过`getItem`或直接通过索引`localStorage`；不是通过获得`getItem`.

[文档](https://developer.mozilla.org/en/DOM/Storage)中没有任何内容提及此功能，并且它不适用于我尝试过的任何浏览器，所以我不确定他们从哪里得到它。也许这太令人兴奋了，它提高了性能，以至于他们没有费心去检查它是否有效？

# xml - 带有条件的 XML 路径

> ID：10688975
> 
> 赞同：2
> 
> 时间：2012-05-21T16:28:28.197
> 
> 标签：xml, xpath

我有以下 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE inventory SYSTEM "books.dtd">
<inventory>
    <book num="b1">
        <title>Snow Crash</title>
        <author>Neal Stephenson</author>
        <publisher>Spectra</publisher>
        <price>14.95</price>
        <chapter>
            <title>Snow Crash - Chapter A</title>
            <paragraph>
                This is the <emph>first</emph> paragraph.
                <image file="firstParagraphImage.gif"/>
                afetr image...
            </paragraph>
            <paragraph>
                This is the <emph>second</emph> paragraph.
                <image file="secondParagraphImage.gif"/>
                afetr image...
            </paragraph>
        </chapter>
        <chapter>
            <title>Snow Crash - Chapter B</title>
            <section>
                <title>Chapter B - section 1</title>
                <paragraph>
                    This is the <emph>first</emph> paragraph of section 1 in chapter B.
                    <image file="Chapter_B_firstParagraphImage.gif"/>
                    afetr image...
                </paragraph>
                <paragraph>
                    This is the <emph>second</emph> paragraph of section 1 in chapter B.
                    <image file="Chapter_B_secondParagraphImage.gif"/>
                    afetr image...
                </paragraph>
            </section>
        </chapter>
        <chapter>
            <title>Chapter C</title>
            <paragraph>
                This chapter has no images and only one paragraph
            </paragraph>
        </chapter>
    </book>
    <book num="b2">
        <title>Burning Tower</title>
        <author>Larry Niven</author>
        <author>Jerry Pournelle</author>
        <publisher>Pocket</publisher>
        <price>5.99</price>
        <chapter>
            <title>Burning Tower - Chapter A</title>
        </chapter>
        <chapter>
            <title>Burning Tower - Chapter B</title>
            <paragraph>
                This is the <emph>second</emph> paragraph of chapter B in the 2nd book.
                <image file="Burning_Tower_Chapter_B_secondParagraphImage.gif"/>
                afetr image...
            </paragraph>
        </chapter>
    </book>
    <book num="b3">
        <title>Zodiac</title>
        <author>Neal Stephenson</author>
        <publisher>Spectra</publisher>
        <price>7.50</price>
        <chapter>
            <title>Zodiac - Chapter A</title>
        </chapter>
    </book>
    <!-- more books... -->
</inventory> 
```

如何编写以下 XmlPath 1.0：

1）如果所有书的价格不等于14.95，则退回所有书？

2）退还所有价格高于其后书籍价格的书籍。

提前致谢 。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T16:43:01.603

试试这些：

> 1）如果所有书的价格不等于14.95，则退回所有书？

```
 /inventory/book[price != 14.95]/title 
```

> 2) 将其价格大于其后书籍价格的书籍全部归还。

```
 /inventory/book[price>following-sibling::*[1]/price]/title 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T17:10:29.047

如何编写以下 XmlPath 1.0：

1）如果所有书的价格不等于14.95，则退回所有书？

```
/inventory/book[price/text() != 14.95] 
```

“/inventory/book”为您提供“inventory”节点的所有名为“books”的子元素。而“price/text() != 14.95”只是意味着对于每本书，检查一个名为“price”的子元素是否不同于 14.95。为了方便您的应用程序，您可以使用“//book”代替“/inventory/book”。"//book" 请求当前节点中所有名为 "book" 的后代元素（在本例中为根元素）

2）退还所有价格高于其后书籍价格的书籍。

```
/inventory/book[price >  following-sibling::book[position() = 1]/price] 
```

# elasticsearch - 如何使用 ElasticSearch 实现社交搜索？

> ID：10688977
> 
> 赞同：20
> 
> 时间：2012-05-21T16:28:32.667
> 
> 标签：elasticsearch

我正在尝试使用 ElasticSearch 创建具有社交功能的业务搜索。我有一个企业目录，用户可以通过不同的方式与这些企业进行交互：查看它们、检查它们等等。

当用户搜索企业时，我希望能够在结果顶部向他们展示他们的朋友与之交互的企业（或基于这些交互进行过滤）。 **设置索引以实现此目的的最佳方法是什么？**

我可以认为有一些可能的解决方案，但我是 ES 的初学者，我不确定什么会导致问题：

1.  我可以使用多租户并为每个用户创建一个单独的索引。我已经排除了这一点，因为用户数量远远大于企业数量或用户特定内容的数量。

2.  我可以为每个索引业务添加一个用户/分数对列表。每个与业务交互的用户都会在其中，分数将代表他们与业务的交互量（这对于我的过滤/排序目的来说已经足够了）。每次他们与业务互动时，我都会更新索引中的分数。这样做的问题是我只关心我朋友的活动，所以我需要想办法在为企业创建综合分数时考虑我的朋友是谁。我不知道如何在 ES 中做到这一点。

3.  我可以创建一个类似的方案，但不是记录我与企业互动的分数，而是反映我朋友与企业互动的分数。这消除了在 ElasticSearch 中为我的社交图建模的需要，但这确实意味着每当一个人与企业交互时，我都需要更新他们所有朋友的分数。这也意味着每个企业的用户/分数对列表会更大，因为它需要包括任何有朋友与企业互动的人。

4.  我能想到的最终解决方案是跟踪业务中发生的每个单独的交互，并将其添加到 ES 中的业务文档中。这对我来说似乎并不现实——它结合了其他解决方案的问题。但这可能是保持索引最新的最直接的方法。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-01T04:20:53.217

我投票支持修改后的#2。

我不会将每个用户/分数对存储在业务文档本身中，而是创建一个父/子关系。这使您可以更新孩子的分数（用户分数），而无需重新索引整个业务文档（以及所有其他用户分数）。

查看此页面以获得很棒的教程父母/孩子大约一半：[http ://www.spacevatican.org/2012/6/3/fun-with-elasticsearch-s-children-and-nested-documents/](http://www.spacevatican.org/2012/6/3/fun-with-elasticsearch-s-children-and-nested-documents/)

然后，您可以使用[has_child 过滤器](http://www.elasticsearch.org/guide/reference/query-dsl/has-child-filter.html)或[top_children 查询](http://www.elasticsearch.org/guide/reference/query-dsl/top-children-query.html)来仅查找您的朋友得分的那些企业。关于订购子文档有一些注意事项，但该教程已涵盖它，因此请确保您阅读到底部。

然后我只需对所有“非社交”排名搜索执行正常查询。

或者，您可以将所有内容放在一起，并为您的朋友得分的比赛添加助推器，以便所有内容都有适当的排名。执行两个查询并自己组合它们可能会更容易。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-15T18:41:56.507

查看 Titan [https://github.com/thinkaurelius/titan/wiki/Using-Elastic-Search](https://github.com/thinkaurelius/titan/wiki/Using-Elastic-Search)

它有一个图形引擎，可以与 Elasticsearch 作为后端一起使用。您可以像 (me) -> (friend) -[review]-> (business) 一样进行图遍历，以找到所有这些联系并调整搜索的排名。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-02T13:22:21.827

还有另一组解决方案具有非常快的优势（即利用 ES 最擅长的），但对于任何知道设计数据存储/检索系统的第一件事的人来说，这看起来很糟糕。

**如果您的“业务”索引小于“用户”索引（即 10,000 个企业，1,000,000 个用户）**

1.  创建 2 个索引：*User*和*Business*。
2.  业务索引应该有一个“数组”字段，其中包含曾经与它“交互”过的每个用户的 id（即“用户：1,4,23,26,127,8678”）
3.  用户索引应该有一个嵌套数组字段，其中包含业务 ID 和评论、签到等，位于具有元信息的嵌套对象中（即“business_id:1233,rating:7.5,checkins:21”）

当您搜索业务时，使用用户的朋友 ID（当然是 OR）对业务索引进行快速字符串查询或过滤查询。tf-idf 应该自动将您的朋友与您互动最多的企业过滤到顶部。如果您需要更多信息，只需点击用户索引即可获取您每个朋友的元数据（评分、签到等）。这应该是快速且超级高效的，因为 ES 非常擅长将数组作为单独的术语进行匹配。这就是它给你的！

如果您的“业务”索引明显大于“用户”索引，请反转模式...将用户与之交互的业务 ID 的索引数组放在用户索引上。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-05-20T20:33:07.240

只是在这里吐口水，但我想我想使用像 Neo4J 这样的图形数据库，在其中执行诸如“我的朋友已签入的企业”之类的查询并同时查询该数据库和弹性搜索并返回是微不足道的首先从您的图形数据库中获取结果。或者您可以只获取该图形查询的结果并匹配弹性搜索中的结果（匹配 id），然后对弹性搜索结果应用查询时间提升，以便它们浮动到返回结果的顶部。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-15T20:04:11.630

Solr 可以使用 GraphQuery 运算符来执行此操作。

[https://issues.apache.org/jira/browse/SOLR-7543](https://issues.apache.org/jira/browse/SOLR-7543)

它允许您将文档放入包含“node_id”字段和“edge_id”（多值）字段的索引中

有几种方法可以构建它：

1.  您可以拥有一个用户文档，其中包含朋友 ID 列表。或者
2.  您可以有一个单独的表，它是一个链接表，用于链接用户记录。

对于案例 1：索引系统中每个用户的文档，其中一个字段包含“user_id”，另一个字段包含“friend_ids”。

那时要搜索用户 555 的所有朋友将是：

```
{!graph from="user_id" to="friend_ids" maxDepth=1}user_id:555 
```

寻找用户朋友的朋友

```
{!graph from="user_id" to="friend_ids" maxDepth=2}user_id:555 
```

如果您在用户记录上有其他元数据字段，例如位置字段，您可以将其添加为遍历过滤器以查找住在波士顿的朋友。此遍历过滤器应用于每一跳。

```
{!graph from="user_id" to="friend_ids" maxDepth=2 traversalFilter="location:Boston"}user_id:555 
```

上面的查询将找到住在波士顿的朋友，这些朋友是住在波士顿的用户 555 的朋友。

# php - 重新编写javascript，使其不包含“任何地方？

> ID：10688979
> 
> 赞同：-4
> 
> 时间：2012-05-21T16:28:42.940
> 
> 标签：php, javascript, jquery

> **可能重复：**
> [转义双引号 javascript](https://stackoverflow.com/questions/10688513/escape-double-quotes-javascript)

如果这是一个愚蠢的问题，请原谅我，但是是否可以编写以下 javascript 而无需在 php、javascript 或 jquery 的任何地方实际使用 "？

```
 var uagent = navigator.userAgent.toLowerCase();

 if (uagent.search("iphone") > -1){

 document.write("<img src=http://www.demiads.com/images/bc-1300119669-722.gif />");    }
 else{   

document.write("<object classid=clsid:d27cdb6e-ae6d-11cf-96b8-444553540000 
codebase=http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0    width=728 height=90 id=lang align=middle style=margin-left:3px;>   
<param name=allowScriptAccess value=sameDomain />      
<param name=allowFullScreen value=false />         
<param name=movie value=http://koha.net//repository/reklamat/17_05_12_131575_koha.net_hej_reveal_675x88px.swf /> 
<param name=quality value=high /> 
<param name=bgcolor value=#ffffff /> 
<param name=wmode value=transparent />     
<embed src=http://koha.net//repository/reklamat/17_05_12_131575_koha.net_hej_reveal_675x88px.swf 
quality=high WMODE=transparent bgcolor=#ffffff width=728 height=90 
name=ifm_al align=middle allowScriptAccess=sameDomain 
allowFullScreen=false type=application/x-shockwave-flash 
pluginspage=http://www.macromedia.com/go/getflashplayer /> 
 </object>"); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:33:41.493

如果您尝试将 JavaScript 源代码“嵌入”到另一个文件中，也许您应该尝试使用标准 \" 语法转义其中的所有 '"' 字符。许多语言都支持它，例如 PHP、C 和 JavaScript 本身。

请注意，由于您将 \" 嵌入到字符串中，因此 "\" 字符应自行转义，因此通常您写： \\"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:33:42.827

关于javascript中字符串的一些信息：

[http://en.wikipedia.org/wiki/JavaScript_syntax#String](http://en.wikipedia.org/wiki/JavaScript_syntax#String)

简短的回答是您可以将它们从 切换`"`到`'`但不确定为什么要这样做。

# sql - 复杂的预言机查询

> ID：10688980
> 
> 赞同：1
> 
> 时间：2012-05-21T16:28:58.557
> 
> 标签：sql, oracle

我有一个非常复杂的查询需要做，但我似乎无法理解如何完成它，所以我希望有人可以帮助我。

我有两个查询需要合并为一个查询。

我的第一个查询是这样的：

```
select * from table1 t1 
join table2 t2 on t2.outcode = t1.post_code 
```

这会产生包括`LAT`和`LONG`邮政编码的结果，如下所示：

```
 Name    Postcode          Lat         Long
Taylor         CB8    53.829517    -1.780320 
```

这些只是用于测试目的的虚拟值。

我的下一个查询是这个

```
SELECT * FROM (
    SELECT t3.location_name, 
    calc_distance(t3.lat, t3.lng, t2.lat,t2.lng) as distance
    FROM table3 t3, table2 t2 
    where t2.outcode = :postcode
    order by distance) i 
where rownum = 1 
```

`calc_distance`是一个根据点的 LAT & LONG 计算距离的函数

如果我`:postcode`用`CB8`它代替会产生这些结果

```
Location_name     Distance
  NR Location         56.6 
```

我需要做的是从单个查询中生成以下输出。

```
 Name    Postcode          Lat         Long    Nearest_Loc     Distance
Taylor         CB8    53.829517    -1.780320    NR Location         56.6 
```

如果可能的话，我一生都无法弄清楚如何制作这个。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:39:17.713

你可以`ROW_NUMBER()`在这里有效地使用。通过分区`t2.outcode`和排序，`distance`我们可以找到每个输出码 ( `t3.rn = 1`) 的最小距离。

```
SELECT 
       t1.Name,
       t1.Postcode,
       t2.Lat,         
       t2.Long,    
       t3.Nearest_Loc,
       t3.Distance
From 
      table1 t1 
       INNER join table2 t2 on t2.outcode = t1.post_code
    LEFT JOIN (
               SELECT t3.location_name, 
                     calc_distance(t3.lat, t3.lng, t2.lat,t2.lng) as distance,
                     row_number() over (partition by t2.outcode 
                                        order by calc_distance(t3.lat, t3.lng, t2.lat,t2.lng) 
                                      ) rn,
                    t2.outcode
               FROM table3 t3, table2 t2 
            ) t3
     on t1.Postcode =  t3.PostCode
      and t3.rn = 1 
```

# jquery - 如何动态显示弹出消息

> ID：10688981
> 
> 赞同：0
> 
> 时间：2012-05-21T16:29:14.330
> 
> 标签：jquery, asp.net, css

我根据这篇[文章](https://stackoverflow.com/questions/659199/how-to-show-popup-message-like-in-stackoverflow)
创建了一个弹出窗口， 但我想根据访问者创建它

我在 index.aspx 页面中使用以下代码：

```
<div id='message' style="display: none;">
    <span>Wellcome 
        <%=UserName%></span> <a href="#" class="close-notify" onclick="closeNotice()">X</a>
</div> 
```

我使用 jquery 显示弹出窗口：

```
<script type="text/javascript">

$(document).ready(function() {
    $("#message").fadeIn("slow");

});

function closeNotice() {
    $("#message").fadeOut("slow");
}
</script> 
```

现在我只想在用户输入或当“editor.aspx”中的 CheckBox1.Checked 值为 true 时显示此弹出窗口...但每次加载该页面时都会弹出窗口显示（即使用户未登录）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:34:57.560

为什么不创建一个 Javascript 变量并在 !IsPostBack 上设置它的值。

<script type="text/javascript">

var postBack = <%=IsPostedBack%>// 你可以使用代码隐藏中的变量

if(postBack == false) $("#message").fadeIn("slow");

$("#message").fadeOut("slow");

</脚本>

在 Page_Load 函数中设置了 IsPostedBack。

# android - 作为 TextView 中的背景的 TransitionDrawable 无法按预期工作

> ID：10688990
> 
> 赞同：6
> 
> 时间：2012-05-21T16:29:55.670
> 
> 标签：android, android-layout, android-xml

根据问题：[Android 上视图背景颜色的动画更改](https://stackoverflow.com/questions/2614545/animate-change-of-view-background-color-in-android)我试图通过[TransitionDrawable](http://developer.android.com/reference/android/graphics/drawable/TransitionDrawable.html)资源使 TextView 在两个背景之间淡入淡出。我的过渡 xml 文件如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<transition xmlns:android="http://schemas.android.com/apk/res/android" >
    <item android:drawable="@drawable/gray_bar" />
    <item android:drawable="@drawable/green_bar" />
</transition> 
```

我尝试通过以下方式将其设置为运行时背景：

```
TextView answerBox = (TextView) findViewById(R.id.answerBox);
answerBox.setBackgroundResource(R.drawable.correct_transition);
TransitionDrawable transition = (TransitionDrawable) answerBox.getBackground();
transition.startTransition(1500); 
```

结果是 textview 从此转换：

![带有 gray_bar 背景的文本视图](../Images/befb674ef87e1dd986968e2c8f184245.png) 对此： ![带有 green_bar 背景的文本视图](../Images/5bbf9fa6ca1921c0657476d4d16212f1.png)

当整个灰色条应转换为绿色条。

两者都是 9-patch png 图像。这些是原件：

![gray_bar](../Images/c9e94191a0bba57049feb4c2eb2384f1.png) ![绿条](../Images/f40fbe4b8040ce4b0f77c856897f69a6.png)

我的猜测是绿色条正在填充灰色条内可用于文本的空间，但我不知道为什么。有什么线索吗？灰色的看起来也比它应该的大得多，但在转换之前、期间或之后不会改变大小，尽管包含的图像出现了。这可能是 9-patch 图像的问题，因为我已经测试了普通图像并且过渡效果很好。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-02T05:36:48.360

我能够重现您看到的绿色条不占用灰色条的全部空间的问题。要修复它，请使用灰色条 9-patch 并将底部和右侧的线延伸到距角落一个像素的位置。

附带说明一下，您的 9-patch 的另一个潜在问题是，随着内容高度的增加，您的图像在垂直拉伸时会出现视觉伪影。这是图像左侧黑条高度的结果，它决定了 9-patch 的哪个部分应该拉伸。对这 9 个补丁的进一步改进是将左侧的黑线减少到仅位于左边缘中心的单个像素。由于只有一个像素被标记为可拉伸的，因此如果您的可绘制对象的高度增加，这应该会给您一个很好的清晰的垂直边缘。

如果您包含您的布局代码，我也许可以帮助您解决其他尺寸问题。

# django - 为什么这个通用功能会失败？

> ID：10688993
> 
> 赞同：0
> 
> 时间：2012-05-21T16:30:01.950
> 
> 标签：django

目前，我正在尝试对这部分代码进行故障排除，它正在抛出

```
'NoneType' object has no attribute '__name__' 
```

错误，贯穿我的整个应用程序。

我将代码部分缩小到：

```
def get_internal_type(self):
    return CharField.__name__ 
```

Django的错误输出：

```
AttributeError at /joinerysoft/contacts/edit-contact/details/E0452488-1756-11E1-A97B-7071BC08AB6F/84AE3FC8-40F1-11E1-B520-7071BC08AB6F/
'NoneType' object has no attribute '__name__'
Request Method: POST
Request URL:    http://127.0.0.1:8002/joinerysoft/contacts/edit-contact/details/E0452488-1756-11E1-A97B-7071BC08AB6F/84AE3FC8-40F1-11E1-B520-7071BC08AB6F/
Django Version: 1.2.7
Exception Type: AttributeError
Exception Value:    
'NoneType' object has no attribute '__name__'
Exception Location: C:\Joinerysoft\Development\joinerysoft-directory\jmsdirectory\..\jmsdirectory\generic\models.py in get_internal_type, line 41
Python Executable:  c:\python27\python.exe
Python Version: 2.7.2
Python Path:    ['C:\\Joinerysoft\\Development\\joinerysoft-directory\\jmsdirectory', 'c:\\python27\\lib\\site-packages\\setuptools-0.6c11-py2.7.egg', 'c:\\python27\\lib\\site-packages\\virtualenv-1.7.1.2-py2.7.egg', 'C:\\Windows\\system32\\python27.zip', 'c:\\python27\\DLLs', 'c:\\python27\\lib', 'c:\\python27\\lib\\plat-win', 'c:\\python27\\lib\\lib-tk', 'c:\\python27', 'c:\\python27\\lib\\site-packages', 'c:\\python27\\lib\\site-packages\\PIL']
Server time:    Mon, 21 May 2012 17:11:16 +0100 
```

来自 manage.py 的回溯：

```
C:\Joinerysoft\Development\joinerysoft-directory\jmsdirectory>c:\python27\python.exe manage.py syncdb
Traceback (most recent call last):
  File "manage.py", line 11, in <module>
    execute_manager(settings)
  File "c:\python27\lib\site-packages\django\core\management\__init__.py", line 438, in execute_manager
    utility.execute()
  File "c:\python27\lib\site-packages\django\core\management\__init__.py", line 379, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "c:\python27\lib\site-packages\django\core\management\base.py", line 191, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "c:\python27\lib\site-packages\django\core\management\base.py", line 220, in execute
    output = self.handle(*args, **options)
  File "c:\python27\lib\site-packages\django\core\management\base.py", line 351, in handle
    return self.handle_noargs(**options)
  File "c:\python27\lib\site-packages\django\core\management\commands\syncdb.py", line 88, in handle_noargs
    sql, references = connection.creation.sql_create_model(model, self.style, seen_models)
  File "c:\python27\lib\site-packages\django\db\backends\creation.py", line 45, in sql_create_model
    col_type = f.db_type(connection=self.connection)
  File "c:\python27\lib\site-packages\django\db\models\fields\subclassing.py", line 28, in inner
    return func(*args, **kwargs)
  File "c:\python27\lib\site-packages\django\db\models\fields\subclassing.py", line 28, in inner
    return func(*args, **kwargs)
  File "c:\python27\lib\site-packages\django\db\models\fields\subclassing.py", line 28, in inner
    return func(*args, **kwargs)
  File "c:\python27\lib\site-packages\django\db\models\fields\__init__.py", line 220, in db_type
    return connection.creation.data_types[self.get_internal_type()] % data
  File "C:\Joinerysoft\Development\joinerysoft-directory\jmsdirectory\..\jmsdirectory\generic\models.py", line 40, in get_internal_type
    return CharField.__name__
AttributeError: 'NoneType' object has no attribute '__name__' 
```

# c# - 使用 BinaryWriter 查找和插入数据

> ID：10688996
> 
> 赞同：3
> 
> 时间：2012-05-21T16:30:46.923
> 
> 标签：c#, file-io, binary-data

背景：

我对 C# 相当陌生，目前正在从事一个主要用于学习的项目。我正在创建一个库来处理 Quake 和 Quake II 使用的 .PAK 文件。我可以很好地阅读和提取它们，以及编写一个空白存档，并且我正在将数据写入存档。

可以在这里找到基本规范以供参考：[http ://debian.fmi.uni-sofia.bg/~sergei/cgsr/docs/pak.txt](http://debian.fmi.uni-sofia.bg/~sergei/cgsr/docs/pak.txt)

问题：

我想寻找二进制数据部分的末尾并从给定文件中插入数据。创建空文件时，我在方法中使用 BinaryWriter，所以这就是我要用于插入的方法。根据我的发现，使用 BinaryWriter 查找和写入将在给定位置写入并覆盖现有数据。

我的目标是简单地在给定点插入数据而不会丢失任何现有数据。如果这是不可能的，我想我需要提取包含单个文件信息（名称、偏移量、长度）的整个索引，添加二进制数据，然后为我正在编写的文件附加索引和附加信息。

有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:51:24.113

不能使用 C# IO 类直接将数据插入文件。最简单的方法是将其读入缓冲区并操作缓冲区，或者将第一部分写入临时文件，然后插入新数据，然后写入文件的其余部分，然后重命名。或者，您可以在文件末尾附加一些数据并将所有内容向上移动以创建适量的可用空间，以便在其中插入数据。

看看[http://www.codeproject.com/Articles/17716/Insert-Text-into-Existing-Files-in-C-Without-Temp](http://www.codeproject.com/Articles/17716/Insert-Text-into-Existing-Files-in-C-Without-Temp)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T16:35:04.387

直接使用基于流的对象（如 FileStream）是文件级操作的更好选择。

没有办法在中间插入数据到任何文件中，您必须读取整个文件并将其与新插入的部分一起保存或复制到新文件直到插入点，添加新数据然后复制其余部分（您可以此时删除原始/重命名新）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T18:00:03.127

很难有效地进行插入。特别是如果您想对同一个流进行多次插入。您可以编写自己的`Stream`类来跟踪您所做的任何插入，并在实际上没有插入更改时假装已插入更改。例如，如果您有一个`A`at 位置 10 并且您在该位置插入一个`X`。您的类可以，而不是将插入写入流并移动所有后续字节，而是`X`在您请求位置 10 时返回，并`A`在您请求位置 11 时从基础流返回（而在基础流中它仍位于位置 10）。然后当你打电话`Flush`或`Close`在流上，整个更改的流一次全部刷新到底层流。这需要一些非常仔细的工程才能做到正确，因为您可能在插入中插入，以任何顺序插入，等等......

这是我为您编写的一些代码，它将任意字节插入流中并移动所有后续字节，而无需任何巧妙的缓存。不幸的是，它不使用 a`BinaryWriter`而是直接在`Stream`（必须是可搜索的）上工作，因为这样更容易编码。它在流的当前位置插入，然后该位置就在插入的字节之后。要插入字符串，请使用`Encoding`类将它们转换为字节。

```
public static class StreamExtensions
{
    /// <summary>
    /// Inserts the specified binary data at the current position in the stream.
    /// </summary>
    /// <param name="stream">The stream.</param>
    /// <param name="array">The array.</param>
    /// <remarks>
    /// <para>Note that this is a very expensive operation, as all the data following the insertion point has to
    /// be moved.</para>
    /// <para>When this method returns, the writer will be positioned at the end of the inserted data.</para>
    /// </remarks>
    public static void Insert(this Stream stream, byte[] array)
    {
        #region Contract
        if (stream == null)
            throw new ArgumentNullException("writer");
        if (array == null)
            throw new ArgumentNullException("array");
        if (!stream.CanRead || !stream.CanWrite || !stream.CanSeek)
            throw new ArgumentException("writer");
        #endregion

        long originalPosition = stream.Position;
        long readingPosition = originalPosition;
        long writingPosition = originalPosition;

        int length = array.Length;
        int bufferSize = 4096;
        while (bufferSize < length)
            bufferSize *= 2;

        int currentBuffer = 1;
        int[] bufferContents = new int[2];
        byte[][] buffers = new [] { new byte[bufferSize], new byte[bufferSize] };
        Array.Copy(array, buffers[1 - currentBuffer], array.Length);
        bufferContents[1 - currentBuffer] = array.Length;

        bool done;

        do
        {
            bufferContents[currentBuffer] = ReadBlock(stream, ref readingPosition, buffers[currentBuffer], out done);

            // Switch buffers.
            currentBuffer = 1 - currentBuffer;

            WriteBlock(stream, ref writingPosition, buffers[currentBuffer], bufferContents[currentBuffer]);

        } while (!done);

        // Switch buffers.
        currentBuffer = 1 - currentBuffer;

        // Write the remaining data.
        WriteBlock(stream, ref writingPosition, buffers[currentBuffer], bufferContents[currentBuffer]);

        stream.Position = originalPosition + length;
    }

    private static void WriteBlock(Stream stream, ref long writingPosition, byte[] buffer, int length)
    {
        stream.Position = writingPosition;
        stream.Write(buffer, 0, length);
        writingPosition += length;
    }

    private static int ReadBlock(Stream stream, ref long readingPosition, byte[] buffer, out bool done)
    {
        stream.Position = readingPosition;
        int bufferContent = 0;
        int read;
        do
        {
            read = stream.Read(buffer, bufferContent, buffer.Length - bufferContent);
            bufferContent += read;
            readingPosition += read;
        } while (read > 0 && read < buffer.Length);
        done = read == 0;
        return bufferContent;
    }
} 
```

要使用此方法，请将代码粘贴到与您的代码相同的命名空间中，然后：

```
Stream someStream = ...;
byte[] dataToInsert = new byte[]{ 0xDE, 0xAD, 0xBE, 0xEF };
someStream.Position = 5;
someStream.Insert(dataToInsert); 
```

既然你说你有一个`BinaryWriter`，因为你用它来创建一个空文件，为了能够使用这个类，你需要实际的`Stream`. 您可以改用静态[File.Create()](http://msdn.microsoft.com/en-us/library/system.io.file.create.aspx)和[File.Open()](http://msdn.microsoft.com/en-us/library/system.io.file.open.aspx)方法，它们会返回`FileStream`对象。如果您以后决定仍然需要 a `BinaryWriter`，则可以使用将流提供给`BinaryWriter`构造函数。要从 writer 获取流，请使用[BinaryWriter.BaseStream](http://msdn.microsoft.com/en-us/library/system.io.binarywriter.basestream.aspx)。请注意，关闭 a`BinaryWriter`也会关闭底层流，除非您使用`NonClosingStreamWrapper`MiscUtil[库](http://www.yoda.arachsys.com/csharp/miscutil/)中的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T16:52:46.930

是的，正如您所说，您不能在文件中“插入”数据。您应该使用一些读写器组合，直到插入点并写入新数据。

我不知道 .pak 格式，但我认为这个例子可以说明你。

```
 var sourceStream = System.IO.File.OpenRead("myFile.pak");
    var destStream = System.IO.File.Create("modified.pak");

    using (var reader = new System.IO.BinaryReader(sourceStream))
    {
        using (var writer = new System.IO.BinaryWriter(destStream))
        {
            while (reader.BaseStream.CanRead)
            {
                char data = reader.ReadChar();
                if (data == '?')
                {
                    writer.Write("<Found!>");
                }
                else
                {
                    writer.Write(data);
                }
            }
        }
    } 
```