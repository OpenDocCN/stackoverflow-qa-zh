# StackOverflow 问答 000671000-000671999

# iphone - 编译的 iPhone 应用程序的文件位置？

> ID：671003
> 
> 赞同：2
> 
> 时间：2009-03-22T13:19:49.850
> 
> 标签：iphone, ios-simulator, packaging, dmg

我现在正在模拟器/调试模式下编写一个 iPhone 应用程序。我想知道，在我构建它之后，二进制文件在哪里？我想将此文件发送给我的朋友，以向他展示我到目前为止所做的事情。

另外，如何将应用程序打包成 .dmg 文件？这似乎是将应用程序发送给其他人的更好格式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T15:03:59.133

你加入 iPhone 开发者计划了吗？如果是这样，您将需要您朋友的设备 ID 来生成配置文件。我建议您阅读[Publishing Applications for Testing](http://developer.apple.com/iphone/library/documentation/Xcode/Conceptual/iphone_development/145-Publishing_Applications_for_Testing/user_testing.html#//apple_ref/doc/uid/TP40007959-CH10-SW2 "发布测试应用程序")以了解更多详细信息。

您的二进制文件将位于 {Project Folder}/build/ 上，您将在其中为每个可能的选项提供一个目录：Release/Debug 和 iphoneos/iphoneSimulator。

要创建 DMG，请阅读[创建 .DMG](https://stackoverflow.com/questions/367751/creating-a-dmg)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T13:26:32.517

默认情况下，构建的结果位于`{Project Folder}/build/Debug`（如果您在该配置中构建，则为 Release）。您可以使用`hdiutil`命令行工具来生成您的应用程序的 DMG - 查看它的手册页，它非常全面。

# c# - 使用 Collat e 子句排序 | 实体框架

> ID：671008
> 
> 赞同：6
> 
> 时间：2009-03-22T13:22:51.873
> 
> 标签：c#, linq, entity-framework, linq-to-sql, linq-to-entities

我不想在 Web 服务器上使用数组排序，它应该在 SQL 服务器上完成。

Microsoft 不支持这样的查询（在 EF 中）：

```
SELECT * FROM [Table_1]
ORDER BY [Table_1].field
COLLATE SQL_SwedishStd_Pref_Cp1_CI_AS 
```

有任何想法吗？多谢指教...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T12:22:44.573

实体框架[在 Entity SQL 的 ORDER BY 中](http://msdn.microsoft.com/en-us/library/bb399723.aspx)*支持*COLLATE 子句。我不知道用 LINQ to Entities 有什么方法可以做到这一点。事实上，我不知道如何使用*任何*LINQ 提供程序来做到这一点。我不确定这是否可能。

 *# security - 如何获取站点的文件名和目录名列表？

> ID：671010
> 
> 赞同：1
> 
> 时间：2009-03-22T13:25:28.277
> 
> 标签：security, directory

你到底是怎么做到的？原因是我的 CMS 被破坏了，嗯，主要是因为用户名和密码相当普遍（我的错）。但我一直认为它是保存，因为目录名称非常不常见且难以猜测（不是通常的 /cms/ 或 /admin/）。从脚本暴力破解？或者也许是一些谷歌技巧？

更新：我的 CMS 是 PHP 的，我自己开发的。我不记得把它的链接放在任何地方，除了一次我通过 gmail 发送给我的朋友的电子邮件中。

更新 2：因为这可能被某些人用来攻击网站，请不要在答案中添加任何脚本。我的目的只是知道一般的方法，这样我就可以防止像这样的进一步攻击。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T15:47:26.173

您是否曾经通过 CMS 中的链接在某个地方冲浪？您的浏览器会发送一个referer（注意拼写错误）标头，表明您来自哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T13:31:19.310

我的猜测是，有人链接到您的 CMS URL 和一个自动（邪恶）脚本使用 Google 搜索结果寻找一些常见模式找到了它。

使用此查询在 Google 中搜索

```
link:http://www.example.com/myCmsFolder 
```

验证您的链接/页面是否包含在 Google 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T13:33:03.830

也许你在某个地方有一个行政区域的链接？

或者也许访问没有文件名的主目录会呈现目录索引？即你正在使用[mod_autoindex](http://httpd.apache.org/docs/2.2/mod/mod_autoindex.html)？

# wpf - 使用 WPF 模拟 Vista 通知图标对话框

> ID：671012
> 
> 赞同：3
> 
> 时间：2009-03-22T13:25:59.633
> 
> 标签：wpf, dialog, icons, notifications

在 Vista 中单击通知图标（例如网络或声音图标）时，您会看到一个有边框但无字幕的对话框 ( [http://i.msdn.microsoft.com/Aa511448.NotificationArea22(en-us,MSDN. 10).png](http://i.msdn.microsoft.com/Aa511448.NotificationArea22(en-us,MSDN.10).png) ):

[http://i.msdn.microsoft.com/Aa511448.NotificationArea22(en-us,MSDN.10).png](http://i.msdn.microsoft.com/Aa511448.NotificationArea22(en-us,MSDN.10).png)

如何在 WPF 中模拟这些？创建一个新窗口并将 WindowStyle 设置为 "None" 并将 ResizeMode 设置为 "CanResize" 会产生一个关闭的结果，除了框架稍微太薄并且对话框可以调整大小，这是不可取的。将 ResizeMode 设置为“NoResize”会导致窗口没有 Aero 边框（只有 2px 的细实线边框。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T13:54:55.773

诀窍是为自己添加边框。我通过将主要内容元素设为 DockPanel 并添加边框来做到这一点。您可以使用边框自定义外观以匹配 Vista 样式窗口。我不擅长颜色，所以我无法命名那个特定的颜色，但以灰色为例。

尝试以下

```
<Window x:Class="WpfApplication10.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" 
    Height="300" 
    Width="300"
    WindowStyle="None"
    ResizeMode="NoResize">
    <DockPanel>
        <Border
            BorderBrush="Gray"
            BorderThickness="5">

            <TextBlock>Here we go</TextBlock>

        </Border>
    </DockPanel>
</Window> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T10:34:00.607

我终于想通了：如果将 WindowStyle 设置为“None”，将 ResizeMode 设置为“CanResize”，那么您将获得正确的粗边框而没有标题，唯一的问题是您仍然可以调整窗口大小。

`Window`幸运的是，通过为您的实例处理 WM_NCHITTEST 可以轻松解决这个问题：

```
private IntPtr _hwnd;

protected override void OnSourceInitialized(EventArgs e) {
    _hwnd = new System.Windows.Interop.WindowInteropHelper(this).Handle;
    System.Windows.Interop.HwndSource.FromHwnd(_hwnd).AddHook(_WndProc);
    base.OnSourceInitialized(e);
}

private const int WM_NCHITTEST = 132;
private const int HTCLIENT = 1;

private IntPtr _WndProc(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled) {
    // We should only receive messages for our own window handle.
    System.Diagnostics.Debug.Assert(hwnd == _hwnd);

    if (msg == WM_NCHITTEST) {
        handled = true;
        return (IntPtr)HTCLIENT;
    }
    return IntPtr.Zero;
} 
```

通过从不让 Windows 知道光标位于边框上，我们将永远不会看到调整大小的光标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T09:02:42.223

您需要指定正确的窗口样式组合，WPF 不会公开 Windows 中可用的所有选项，但您可以使用 pinvoke 自己设置它们。

我现在不在 Vista 机器上，所以我无法测试样式组合以查看正确的外观，但样式列表（在 C# 中）在这里[http://pinvoke.net/default.aspx/user32/ GetWindowLong.html](http://pinvoke.net/default.aspx/user32/GetWindowLong.html)

在你的窗口类中：

```
[DllImport("user32.dll")]
static extern int SetWindowLong(IntPtr hWnd, int nIndex, uint dwNewLong);

[DllImport("user32.dll")]
static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int X, int Y, int cx, int cy, uint uFlags);

private const int GWL_STYLE = -16;
private const int GWL_EXSTYLE = -20;
private const UInt32 SWP_NOSIZE = 0x0001;
private const UInt32 SWP_NOMOVE = 0x0002;
private const UInt32 SWP_NOZORDER = 0x0004;
private const UInt32 SWP_NOREDRAW = 0x0008;
private const UInt32 SWP_NOACTIVATE = 0x0010;
private const UInt32 SWP_FRAMECHANGED = 0x0020;

public override void OnSourceInitialized(EventArgs e)
{
    IntPtr hwnd = new System.Windows.Interop.WindowInteropHelper(this).Handle;

    // set styles to a combination of WS_ flags and exstyles to a combination of WS_EX_ flags

    SetWindowLong(hwnd, GWL_STYLE, styles);
    SetWindowLong(hwnd, GWL_EXSTYLE, exstyles);

    // and to activate changes:
    SetWindowPos(hwnd,IntPtr.Zero,0,0,0,0,SWP_NOSIZE|SWP_NOMOVE|SWP_NOZORDER|SWP_NOACTIVATE|SWP_FRAMECHANGED);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T02:16:48.797

[此处](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/978223f6-fb7c-410e-ad5a-bfb5dd1c5735/)发布的代码中有一个解决方案。我打算直接用 XAML 来做，应该有一种方法来设置你的窗口边框的样式，让它看起来很接近。您还应该看看[这个](http://blogs.msdn.com/wpfsdk/archive/2008/09/08/custom-window-chrome-in-wpf.aspx)，以便更好地解释论坛帖子的作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T03:23:32.227

我想我会发布到目前为止我想出的东西。这非常接近：

```
<Window.Style>
    <Style TargetType="{x:Type Window}">
        <Setter Property="AllowsTransparency"       Value="True"            />
        <Setter Property="Background"           Value="{x:Null}"        />
        <Setter Property="BorderBrush"          Value="{x:Null}"        />
        <Setter Property="BorderThickness"      Value="0"           />
        <Setter Property="OverridesDefaultStyle"    Value="True"            />
        <Setter Property="ResizeMode"           Value="NoResize"        />
        <Setter Property="SizeToContent"        Value="WidthAndHeight"      />
        <Setter Property="WindowStyle"          Value="None"            />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Window}">
                    <Border BorderThickness="1" CornerRadius="4" Background="{x:Null}">
                        <Border.BorderBrush>
                            <SolidColorBrush Color="{x:Static SystemColors.WindowFrameColor}" Opacity="0.75" />
                        </Border.BorderBrush>
                        <Border BorderThickness="5" Background="{x:Null}">
                            <Border.BorderBrush>
                                <SolidColorBrush Color="{x:Static SystemColors.ActiveBorderColor}" Opacity="0.5" />
                            </Border.BorderBrush>
                            <Border BorderThickness="1" Background="White">
                                <Border.BorderBrush>
                                    <SolidColorBrush Color="{x:Static SystemColors.WindowFrameColor}" Opacity="0.75" />
                                </Border.BorderBrush>

                                <ContentPresenter />
                            </Border>
                        </Border>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</Window.Style> 
```

显然，他们使用的不仅仅是 ActiveWindowBorderColor 上的透明度来绘制边框的中间。似乎顶部 1/4 有一个白色覆盖层，而底部 3/4 有一个黑色覆盖层。此外，外边框在右侧和底部边缘有强调色。如果我真的要这样做，我会创建一个派生自 Border 的 UserControl 来处理所有类似的小细节（如果我愿意，可以调整大小）并将 Window 的样式放入资源字典中。

# macos - 什么是“符号警告”？

> ID：671018
> 
> 赞同：0
> 
> 时间：2009-03-22T13:33:27.947
> 
> 标签：macos, gcc, crash-reports

我有一个用户报告我的 Mac OS X 应用程序崩溃，他们的控制台日志报告如下：

```
Symbolication warning: error parsing FDE at 0x100052649 in:\n 
```

有没有人知道这可能是什么？我假设以某种方式从我的应用程序中删除了符号，这种方式妨碍了 Mac OS X 的崩溃报告器，但我以前从未见过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-22T14:59:39.377

老实说，我以前从未见过这个。我见过许多其他的动态链接问题，但不是这个。如果用户愿意帮助您解决此缺陷，您可能需要编写一个 shell 脚本来启用一些动态链接环境变量，然后启动您的应用程序。

```
#! /bin/bash
export DYLD_PRINT_LIBRARIES=1
export DYLD_PRINT_LIBRARIES_POST_LAUNCH=1
export DYLD_PRINT_APIS=1
export DYLD_PRINT_BINDINGS=1
export DYLD_PRINT_DOFS=1
open -a Console.app > /tmp/link-log 2>&1 
```

输出日志可能会提供一些关于正在发生的事情的提示。您还可以捕获`otool`和其他命令行实用程序的输出，以检查意外库和其他库。

你可能想用[谷歌符号](http://www.google.com/search?q=Symbolication)化来更好地了解这里发生的事情。我[从 Darwin 发现了一段有趣的代码，](http://www.google.com/search?q=Symbolication)它指向动态符号查找警告。还有一个名为[Shark](http://developer.apple.com/documentation/DeveloperTools/Conceptual/SharkUserGuide/Introduction/Introduction.html)的实用程序可能也很有趣。

祝你好运...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-10T16:02:49.777

我刚刚通过 Google 找到了这个主题，因为我遇到了同样的问题。星际争霸安装程序立即崩溃。它指向 /usr/libexec/oah/translate，它似乎工作得很好。我的猜测是，这与它无法运行的计算机运行 iDeneb 1.3（又名 Mac OS X 86，用于非 Apple 硬件）有关，而可以正常运行该应用程序的计算机具有正版豹版。

# javascript - 我们应该在 JavaScript 编码中使用长名称还是短名称？

> ID：671021
> 
> 赞同：7
> 
> 时间：2009-03-22T13:35:23.403
> 
> 标签：javascript, performance, coding-style, readability

在我的工作组中有一个关于 JavaScript 编码的讨论。有些人认为我们应该使用长名称以获得更好的可读性；其他人认为短名称应该有利于相同的在线位。

通常，它与编码约定有关。一方面认为诸如“fAutoAdjustWidth”之类的标识符是可以的，而另一些则更喜欢“fAtAjtW”。

那么，更好的方法是什么？我们是否应该为了性能而牺牲可读性？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-22T13:38:23.457

使其可读，如果您觉得生成的 JS 文件太大，请在部署生产版本之前使用许多 JS 压缩器之一，同时维护具有长名称的开发版本。

顺便提一句。如果您真的担心带宽，请使用[mod_deflate](http://httpd.apache.org/docs/2.2/mod/mod_deflate.html)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-22T13:38:10.760

如果您担心线路上的位，您可以随时在您的代码上运行压缩程序。然后，您可以使用长名称进行开发，并且可以使用具有同等功能的小得多的文件进行发布。Yahoo [YUI Compressor](http://developer.yahoo.com/yui/compressor/#work)看起来像是进行空白压缩和令牌压缩。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-22T13:57:37.763

这些人是否提倡不在他们的代码中写注释？变量名称要完全清晰且具有描述性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-22T14:23:20.870

> 而其他人更喜欢“fatAjtW”

即使“在线比特”是一个问题（事实并非如此），这样的命名约定也会使代码在项目工作的第一周后完全无法维护。

阅读代码几乎是不可能的，在编写代码时，人们将不断地考虑诸如“'fAutoAdjustWidth' 缩写为 'fAtAjtW' 还是 'fAutAtW'？”之类的事情。在编写代码时要付出巨大的精神负担，这将导致生产力大大降低。

最重要的是，在 Javascript 中，每个输入错误的名称都会获得一个新变量，这一事实加剧了问题！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-22T17:30:39.157

使用大变量名，因为它们对程序员有帮助。

要通过网络节省位，请在将 Javascript 部署到生产服务器之前将其缩小。 [Dean Edwards 的打包](http://deanedwards.me.uk/packer/)程序有一个压缩变量名的选项，这对您来说似乎是两全其美的选择。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-22T13:56:15.147

使用足以很好地描述变量和函数的长名称。

许多人需要短名称的原因之一是使文件更小，但您可以在在线上传时通过工具来做到这一点。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-22T14:01:33.790

也许担心的不是线路上的位，而是读取和重新/查看代码的开销。

我倾向于在函数内部使用短名称，并尽可能使函数名称尽可能长，但在不失去有用意义的情况下尽可能短。

毫无疑问，这是一种权衡。这取决于您是希望您的代码类似于自然语言还是更加隐式和紧凑。

一些前缀变量名称以将上下文信息注入其中。我说，如果有必要，IDE 应该提供注入功能，例如通过上下文符号在代码上进行可视化覆盖。

下一版本的 Visual Studio 将通过深入到编辑器本身的细粒度可扩展性机制，使此类注释操作变得更加容易。我还没有使用 Visual Studio 来编辑 Javascript。

我现在看到您的担忧确实是空间权衡。这永远不应该成为问题。总是总是喜欢可读性而不是在线上的位，尤其是。正如其他评论员所指出的那样，因为存在压缩。

我唯一要补充的是上面的内容，即有时使用紧凑的名称而不是过长的名称更容易理解。但是，要正确命名短名称更难。根据我的经验，长名称更容易、更快捷。

短名称的原因不应该只是数据压缩认知效率。有效的是个人的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-22T17:22:40.220

> 一方面认为诸如“fAutoAdjustWidth”之类的标识符是可以的，而另一些则更喜欢“fAtAjtW”。

'fAtAjtW' 是一种无法阅读、无法打字的恐怖。说真的，有人喜欢吗？搞笑且难以记住——是“AtAjt”还是“AutAdj”……？

'autoAdjustWidth' 将是一个合适的完整属性名称。（我根本不相信 'f' 前缀表示法，但这是另一个问题。）有时你想要一个短命变量的名字很短（例如，一个小循环中的临时变量），在这种情况下我'会亲自去'var aaw'而不是上面的噩梦。

至于性能，不会有任何区别。JavaScript 不关心变量名称的长度，并且假设您在将脚本压缩到浏览器的途中，压缩将消除较短名称的任何传输优势。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-22T13:47:15.683

我强烈建议不要使用短标识符。仅阅读您的示例就可以看出，当使用 fAtAjtW 之类的名称时，突然需要更多文档。在某些时候，它会变得几乎无法维护，这只是为了节省一些要传输的字节。

如果考虑“短”名称的唯一原因是使生成的脚本更小，从而节省一些带宽，我建议使用 gzip 压缩，这将为您节省超过几个字节的标识符。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-22T23:30:04.737

谁认为“fAtAjtW”更可取，是在他们的编程中使用某种药理学方法。fAutoAdjustWidth 非常精细，非常谨慎。Javascript 库不使用 fAtAjtW 之类的名称是有原因的。如果您担心尺寸，那么您的担心可能是错误的。但是，我建议使用某种缩小器。但是，也就是说，不要使用太长的时间；可能超过 25-30 个字符的任何内容都有些远。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-22T13:46:22.050

在不影响代码可读性的情况下使用较小的名称。更大的名字很好，但尽量只在确实让自己和他人更容易理解的地方使用它们。最后（如其他答案所述）[缩小](http://code.google.com/p/minify/)您的代码，和/或打开某种服务器压缩机制，如 apache 的 mod_gzip 或 mod_deflate 以减少流经线路的位数。

话虽如此，我会优先考虑可读性而不是变量名的紧凑性。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-05-08T13:22:57.843

长而描述性的名称。

并尝试使方法尽可能独特。这有助于导航。如果您想查找特定方法的所有用法，则与具有相同名称的另一个方法发生冲突的可能性较小。

现代 Javascript IDE 还可以进行方法重构（参见：[http](http://blue-walrus.com/2013/08/review-javascript-ides/) ://blue-walrus.com/2013/08/review-javascript-ides/ ）。如果方法被调用相同，这将非常困难。

# c# - Linq2sql 查询的问题

> ID：671024
> 
> 赞同：0
> 
> 时间：2009-03-22T13:36:38.063
> 
> 标签：c#, linq-to-sql

我在使用以下 linq2sql 查询时遇到问题：

```
public IEnumerable List(IQueryable<Enquiry> enquiries, Supplier supplier)
{

    IEnumerable result = from e in enquiries
                         let order = supplier==null ? null : e.Orders.Where(f => f.ClientId.Equals(supplier.Id)).FirstOrDefault() 
                         let enquiryUser = e.Client.ClientUsers.First()
                         select new
                         {
                             Id = e.Id,
                             Name = e.Name,
                             PublicId = EnquiryMethods.GetPublicId(e.PublicId),
                             Price = supplier==null ? 0 : EnquiryMethods.GetPrice(e, supplier),
                             What = e.WorkType.DescriptionText,
                             Where = e.EnquiryArea.DescriptionText,
                             Who = e.EnquiryType0.DescriptionText,
                             When = e.EnquiryTime0.DescriptionText,
                             PriceRange = e.EnquiryPrice0.DescriptionText,
                             DisplayPriceRange = e.EnquiryPrice0.Display,
                             NbrOrders = e.Orders.Count(),
                             Description = StringUtils.Nl2Br(e.Description??""),
                             Published = e.EnquiryPublished,
                             HasPurchased = order!=null,
                             BuyerFirstName = order!=null ? enquiryUser.FirstName : "",
                             BuyerLastName = order!=null ? enquiryUser.LastName : "",
                             BuyerPhone = order!=null ? enquiryUser.Phone : "",
                             BuyerCellphone = order!=null ? enquiryUser.Cellphone : "",
                             BuyerEmail = order!=null ? enquiryUser.Email : "",
                             EnquiryMessage = order!=null ? StringUtils.Nl2Br(order.EnquiryMessage??"") : "",
                             OrderId = order!=null ? (Guid?)order.Id : null
                         };

    return result;
} 
```

当传递非空供应商时，它可以工作文件，但是当传递供应商的空值时，我得到“NullReferenceException 未被用户代码处理”。

我的理论是 linq2sql 对 X 不满意？Y：Z 操作好像 Z (" `e.Orders.Where(f => f.ClientId.Equals(supplier.Id)).FirstOrDefault()`") 总是被评估？我解决了这个问题，`supplier==null ? Guid.Empty : supplier.Id`但我仍然无法让其余的查询工作（订单！= null 解析中断，通过评论除一个之外的所有内容来解决这个问题）。

奇怪的是 e.Orders.Where(f => f.ClientId.Equals(supplier.Id)).FirstOrDefault() 在供应商为非空且查询有效的情况下给出空值。null 和 null 有区别吗？

你会怎么写这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T14:19:06.463

我不知道这是否可行，但请尝试更改：

```
let order = supplier==null
               ? null
               : e.Orders.Where(f => f.ClientId.Equals(supplier.Id))
                         .FirstOrDefault() 
```

到

```
let order = e.Orders.Where( f => supplier != null
                                 && f.ClientId.Equals(supplier.Id) )
                    .FirstOrDefault() 
```

因为你说它在评估第二部分时有效。

# xml - 将结果存储到记录中

> ID：671029
> 
> 赞同：1
> 
> 时间：2009-03-22T13:39:33.547
> 
> 标签：xml, delphi, parsing, pascal, record

我正在解析一个 XML 文件并将结果存储在记录中，但是遇到了一些麻烦。

我试图将结果（我的 XML 标记的内容）存储到我的记录字段中。

我的记录（目前只有一组 XML 元素）。我认为 Parser.curconten 导致了问题......

```
 Type

TXMLAlert=Record
alert, desc, action:string;
end;

Var
MyXMLAlert:TXMLAlert;

MyXMLAlert.alert:=Parser.CurContent
MyXMLAlert.desc:=Parser.CurContent
MyXMLAlert.action:=Parser.CurContent 
```

以下是我的解析器代码；

```
procedure ProcessXML();
var
  Parser : TXmlParser;
  rule, alert: string;
  i:integer;
  memo1:Tmemo;

begin
  Parser := TXmlParser.Create;
  Parser.Normalize := TRUE;
  Parser.LoadFromFile ('c:\parser.xml');
  Parser.StartScan;

  while Parser.Scan do
    case Parser.CurPartType of
     ptStartTag,
    ptEmptyTag : Form1.Memo1.Lines.Add ('New Element: ' + Parser.CurName);
    ptContent  : Form1.Memo1.Lines.Add ('Content of Element ' +
    Parser.Curname + ':' + Parser.CurContent);
      end;
  Parser.Free;
end;
procedure TForm1.Button1Click(Sender: TObject);
begin
  ProcessXML();
end;

end. 
```

程序解析器很好，标签的内容显示在 memo1 中......有什么想法为什么记录没有拾取内容的结果？谢谢， Lazerspewpew

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T14:05:59.570

看起来您并没有在记录代码中的`Scan`每次调用之间进行调用`CurContent`，因此您实际上不会推进输入。您的记录代码看起来也不像您的备忘录代码那样跳过开始和结束标签。就此而言，我无法确定您在记录代码中的设置与在备忘录代码中的设置相同。在您的记录代码运行时，是否引用了已从文件加载数据`Parser`的有效实例？`TXmlParser`它已经开始扫描了吗？

随意的缩进和几个未使用的变量使得我们很难确信我们真的看到了导致您描述的问题的代码。

备忘录控件有什么作用*？*（复制和粘贴。）记录得到的是什么而不是你所期望的？

# visual-studio-2008 - ASP.NET 开发服务器无法访问

> ID：671036
> 
> 赞同：1
> 
> 时间：2009-03-22T13:49:26.643
> 
> 标签：visual-studio-2008, devforce

我一直在使用 VS2008 进行家庭项目。它涉及 WCF 和 Silverlight。直到最近，ASP.NET 开发服务器运行良好，并且可以从浏览器访问（我同时使用 FF 和 IE）。现在，浏览器似乎不再能够访问 asp.net 开发服务器。最初，我认为这是我进行的某些安装（DevForce Silverlight 和 MVC 1.0），但卸载后仍然没有解决问题。然后我尝试按照一些网站的建议禁用 IPv6，并且我没有使用代理，所以这也不是问题。

这有发生在其他人身上吗？您是否能够解决问题或至少找到原因？（我只是通过使用 IIS 绕过它）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T16:24:01.063

您是否检查了该机器上正在运行的进程列表以确保没有另一个正在运行的开发服务器实例？如果是这样，您可能必须杀死它才能让它重新开始。

另一种可能性是重新启动该机器，看看会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T06:29:13.017

显然，问题出在主机文件中。

**C:\Windows\System32\drivers\etc\hosts**

[我根据这里](http://forums.asp.net/t/1395973.aspx)的帖子设法解决了这个问题。

我选择添加**127.0.0.1 本地主机**，而不是删除或注释掉**::1 本地主机**，但我尝试了两种方法，两种解决方案都有效。

# tsql - 不带参数的动态 SQL

> ID：671041
> 
> 赞同：0
> 
> 时间：2009-03-22T13:56:26.033
> 
> 标签：tsql

我正在尝试将普通的 STP 转换为部分动态的 SQL，我需要动态部分将值设置为参数，稍后我将在 STP 的非动态部分中使用该参数。

当我在动态@stmt 内部打印它时它可以，但外面是空的

我错过了什么？

-------------------------------------------------- ------------构造语句

```
set @stmt = 'set @stringActors = cast((select actors.actor_id
    '+@from_clause+' '
    +@where_clause+' '
    +'for xml raw,type) as varchar(max)) print @stringActors'

print @stmt 
```

-------------------------------------------------- - - - - - - 执行

```
EXECUTE sp_executesql @stmt,N'
@stringActors varchar(4000) output
,@user_actor bigint
,@internal_search_actor varchar(30)
,@internal_search_route_manager     varchar(30)
,@internal_search_terminal_id       varchar(30)
,@ACTOR_TYPE_INSTITUTE int 
,@ACTOR_TYPE_LOCATION int'
,@stringActors =@stringActors
,@user_actor=@user_actor
,@internal_search_actor=@internal_search_actor
,@internal_search_route_manager=@internal_search_route_manager
,@internal_search_terminal_id=@internal_search_terminal_id
,@ACTOR_TYPE_INSTITUTE=@ACTOR_TYPE_INSTITUTE
,@ACTOR_TYPE_LOCATION=@ACTOR_TYPE_LOCATION 
```

-------------------------------------------------- --------------- STP 的其余部分（非动态）打印 @stringActors

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T14:13:14.823

在声明和分配 OUTPUT 参数时都必须指定 OUTPUT，所以我会说问题是

```
,@stringActors =@stringActors
,@user_actor=@user_actor 
```

应该

```
,@stringActors =@stringActors OUTPUT
,@user_actor=@user_actor 
```

另外，看看这个[MSDN](http://support.microsoft.com/kb/262499)

# php - 将 javascript 与 twitter API 一起使用

> ID：671042
> 
> 赞同：7
> 
> 时间：2009-03-22T13:56:33.350
> 
> 标签：php, javascript, jquery, air

我对使用 Adob​​e Air 制作 twitter 客户端很感兴趣，但我现在有点卡住了，因为我无法找到更好的方法来连接到 twitter REST API，因为它需要身份验证。

目前，客户端使用 GET 变量中的 twitter 用户名/密码（未加密）向我的服务器（使用 curl 的 php 脚本）发送请求。然后，服务器使用这些凭据向 twitter 发出请求并输出缓冲区，该缓冲区被发送回客户端，然后客户端处理/显示它。

这显然是一个可怕的安全漏洞，所以有人知道更好（更安全）的方法吗？

**仅供参考：**我正在使用 jQuery。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-22T14:07:39.627

有一些 Base64 编码工具。您可以使用其中之一。[您可以根据基本身份验证](http://en.wikipedia.org/wiki/Basic_access_authentication)规范添加带有编码的用户名和密码的标头

这是一个完全符合您要求的帖子。[http://www.aswinanand.com/blog/2009/01/http-basic-authentication-using-ajax/](http://www.aswinanand.com/blog/2009/01/http-basic-authentication-using-ajax/)。base64 使用来自[ostermiller.org的这个库进行编码](http://ostermiller.org/calc/encode.html)

```
$.ajax({    
  'url': 'http://twitter.com/action/',
  'otherSettings': 'othervalues',
  'beforeSend': function(xhr) {
    xhr.setRequestHeader("Authorization", "Basic  " + 
                          encodeBase64(username + ":" + password));
  },
  sucess: function(result) {
   alert('done');
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T14:11:49.477

我一直在考虑使用 PHP 代理服务器做类似的事情（该应用程序需要的请求比没有白名单所允许的要多，所以我需要通过单个 IP 路由请求）。

我的想法是您只发送一次用户名/密码组合，然后为用户分配一个临时会话 ID，用于将来的请求。安全地发送初始用户名/密码有点棘手，您可以使用盐对其进行加密，但我不知道 AIR 应用程序的反编译有多容易。另一种选择可能是 SSL（但我仍然不完全确定它是如何工作的）。

这是会话 id 概念的分步指南：

1.  用户向 AIR 应用程序提供 Twitter 凭据。
2.  凭据加密并发送到代理服务器。
3.  在代理上测试了身份验证。
    *   如果成功创建会话并返回要使用的 id。
        *   请注意，会话包含到期日期/时间，并且只能由一个 IP 使用。
    *   如果不成功，则向客户端返回错误。
4.  客户端存储会话 id 并在将来的请求中使用它来代替用户名/密码。
    *   例如`request.php?action=get&data=friends_timeline&sessid=a3ajh83bah35nf`
    *   每次更新都会延长会话到期时间。
5.  当用户退出应用程序时，会向代理发送终止消息并且会话无效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T14:32:19.637

你应该看看Spaz。[http://funkatron.com/spaz](http://funkatron.com/spaz) - 它是一个用 JavaScript 为 Air 编写的开源 Twitter 客户端。源代码可在 Google Code 上找到。[http://code.google.com/p/spaz/](http://code.google.com/p/spaz/)

我没有看太多源代码，但我可以看到一些元素是用 Flash/Flex 编写的。但是，我正在使用该应用程序，并且它可以正常工作。

希望这对你有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-06T23:51:15.420

Ada 是一个用 Javascript 编写的 Adob​​e Air Twitter 客户端。您可以下载它以了解它的作用：

[http://madan.org/ada](http://madan.org/ada)

Ada 的代码在 GitHub 上：

[http://github.com/sfsam/ada/tree/master](http://github.com/sfsam/ada/tree/master)

Ada uses Base64\. The nice thing about Ada is that the code base is really small so you should be able to figure it all out.

# java - 你如何在 Java 中杀死一个线程？

> ID：671049
> 
> 赞同：403
> 
> 时间：2009-03-22T14:04:34.953
> 
> 标签：java, multithreading

你如何`java.lang.Thread`在Java中杀死a？

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2009-03-22T14:06:48.443

请参阅 Sun 的此[线程，了解他们弃用的原因`Thread.stop()`](http://docs.oracle.com/javase/1.5.0/docs/guide/misc/threadPrimitiveDeprecation.html)。它详细介绍了为什么这是一种不好的方法以及应该如何安全地停止线程。

他们推荐的方式是使用共享变量作为要求后台线程停止的标志。然后可以由请求线程终止的不同对象设置此变量。

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2009-03-22T14:07:06.413

一般不会。。

您要求它使用[Thread.interrupt() 中断它正在执行的任何操作（javadoc 链接）](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html#interrupt%28%29)

一个很好的解释为什么在 javadoc 中[（java 技术说明链接）](http://docs.oracle.com/javase/7/docs/technotes/guides/concurrency/threadPrimitiveDeprecation.html)

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2012-07-09T00:04:39.723

在 Java 中，线程不会被杀死，但线程的停止是以**协作方式**完成的。线程被要求终止，然后线程可以正常关闭。

通常`volatile boolean`使用一个字段，当它被设置为相应的值时，线程会定期检查并终止该字段。

我**不会**使用 a`boolean`检查线程是否应该**终止**。如果您`volatile`用作字段修饰符，这将工作可靠，但如果您的代码变得更复杂，而是在`while`循环中使用其他阻塞方法，则可能会发生，您的代码根本**不会终止**，或者至少**需要更长**的时间可能想要。

> 某些阻塞库方法支持中断。

每个线程都已经有一个布尔标志**中断状态**，你应该利用它。它可以这样实现：

```
public void run() {
   try {
      while (!interrupted()) {
         // ...
      }
   } catch (InterruptedException consumed)
      /* Allow thread to exit */
   }
}

public void cancel() { interrupt(); } 
```

源代码改编自[Java Concurrency in Practice](http://jcip.net/)。由于该`cancel()`方法是公共的，您可以让另一个线程根据需要调用此方法。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-03-22T14:10:40.057

一种方法是设置一个类变量并将其用作哨兵。

```
Class Outer {
    public static volatile flag = true;

    Outer() {
        new Test().start();
    }
    class Test extends Thread {

        public void run() {
            while (Outer.flag) {
                //do stuff here
            }
        }
    }

} 
```

设置一个外部类变量，即上例中的flag = true。将其设置为 false 以“杀死”线程。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-04-23T12:24:39.500

有一种方法可以做到这一点。但是如果你不得不使用它，要么你是一个糟糕的程序员，要么你正在使用由糟糕的程序员编写的代码。所以，你应该考虑停止做一个糟糕的程序员或停止使用这些糟糕的代码。此解决方案仅适用于没有其他方法的情况。

```
Thread f = <A thread to be stopped>
Method m = Thread.class.getDeclaredMethod( "stop0" , new Class[]{Object.class} );
m.setAccessible( true );
m.invoke( f , new ThreadDeath() ); 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2016-01-25T18:35:36.410

我想根据积累的评论添加几个观察结果。

1.  `Thread.stop()`如果安全管理器允许，将停止线程。
2.  `Thread.stop()`很危险。话虽如此，如果您在 JEE 环境中工作并且无法控制被调用的代码，则可能有必要；请参阅[为什么不推荐使用 Thread.stop？](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/doc-files/threadPrimitiveDeprecation.html)
3.  您永远不应该停止停止容器工作线程。如果你想运行容易挂起的代码，（小心地）启动一个新的守护线程并监视它，必要时杀死它。
4.  `stop()`*在调用*线程上创建一个新`ThreadDeathError`错误，然后在*目标*线程上抛出该错误。因此，堆栈跟踪通常毫无价值。
***   在 JRE 6 中，`stop()`检查安全管理器，然后调用`stop1()`该调用`stop0()`。`stop0()`是本机代码。*   截至 Java 13`Thread.stop()`尚未删除（尚未），但`Thread.stop(Throwable)`在 Java 11 中已删除。（[邮件列表](http://mail.openjdk.java.net/pipermail/jdk-dev/2018-June/001362.html)，[JDK-8204243](https://bugs.openjdk.java.net/browse/JDK-8204243)）**

 *** * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-02-18T11:59:34.503

我会投票给`Thread.stop()`.

例如，您有一个持久的操作（如网络请求）。假设您正在等待响应，但这可能需要时间并且用户导航到其他 UI。这个等待线程现在是 a) 无用 b) 潜在问题，因为当他得到结果时，它完全没用，他将触发可能导致错误数量的回调。

所有这些，他可以进行 CPU 密集型的响应处理。作为开发人员，您甚至无法阻止它，因为您不能`if (Thread.currentThread().isInterrupted())`在所有代码中都添加行。

所以无法强行停止一个线程很奇怪。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-11-05T16:07:53.050

这个问题比较模糊。如果您的意思是“我如何编写程序以使线程在我需要时停止运行”，那么其他各种响应应该会有所帮助。但是，如果您的意思是“我的服务器出现紧急情况，我现在无法重新启动，我只需要一个特定的线程死掉，不管发生什么”，那么您需要一个干预工具来匹配监控工具，例如`jstack`.

为此，我创建了[jkillthread](https://github.com/jglick/jkillthread)。请参阅其使用说明。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-02-20T19:25:03.870

当然，在某些情况下，您正在运行某种不完全受信任的代码。（我个人通过允许上传的脚本在我的 Java 环境中执行来实现这一点。是的，到处都有安全警报响起，但它是应用程序的一部分。）在这个不幸的例子中，你首先只是通过询问脚本编写者来抱有希望尊重某种布尔运行/不运行信号。你唯一合适的故障保险是在线程上调用 stop 方法，例如，如果它运行的时间超过某个超时。

但是，这只是“体面”，而不是绝对的，因为代码可以捕获 ThreadDeath 错误（或您明确抛出的任何异常），而不是像绅士线程应该做的那样重新抛出它。因此，底线是 AFAIA，没有绝对的故障保险。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-08-20T14:37:32.703

没有办法优雅地杀死线程。

您可以尝试中断线程，一种常见策略是使用毒丸向线程发送消息以停止自身

```
public class CancelSupport {
    public static class CommandExecutor implements Runnable {
            private BlockingQueue<String> queue;
            public static final String POISON_PILL  = “stopnow”;
            public CommandExecutor(BlockingQueue<String> queue) {
                    this.queue=queue;
            }
            @Override
            public void run() {
                    boolean stop=false;
                    while(!stop) {
                            try {
                                    String command=queue.take();
                                    if(POISON_PILL.equals(command)) {
                                            stop=true;
                                    } else {
                                            // do command
                                            System.out.println(command);
                                    }
                            } catch (InterruptedException e) {
                                    stop=true;
                            }
                    }
                    System.out.println(“Stopping execution”);
            }

    } 
```

}

```
BlockingQueue<String> queue=new LinkedBlockingQueue<String>();
Thread t=new Thread(new CommandExecutor(queue));
queue.put(“hello”);
queue.put(“world”);
t.start();
Thread.sleep(1000);
queue.put(“stopnow”); 
```

[http://anandsekar.github.io/cancel-support-for-threads/](http://anandsekar.github.io/cancel-support-for-threads/)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-03-19T11:41:15.973

“杀死一个线程”不是正确使用的短语。这是我们可以实现线程优雅完成/退出的一种方法：

我使用的可运行：

```
class TaskThread implements Runnable {

    boolean shouldStop;

    public TaskThread(boolean shouldStop) {
        this.shouldStop = shouldStop;
    }

    @Override
    public void run() {

        System.out.println("Thread has started");

        while (!shouldStop) {
            // do something
        }

        System.out.println("Thread has ended");

    }

    public void stop() {
        shouldStop = true;
    }

} 
```

触发类：

```
public class ThreadStop {

    public static void main(String[] args) {

        System.out.println("Start");

        // Start the thread
        TaskThread task = new TaskThread(false);
        Thread t = new Thread(task);
        t.start();

        // Stop the thread
        task.stop();

        System.out.println("End");

    }

} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-06-23T22:59:03.417

通常，您不会杀死、停止或中断线程（或检查它是否被中断（）），而是让它自然终止。

很简单。您可以在 run() 方法中使用任何循环和（易失性）布尔变量来控制线程的活动。您也可以从活动线程返回到主线程以停止它。

这样你就可以优雅地杀死一个线程:)。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-02-18T09:32:37.490

突然终止线程的尝试是众所周知的不良编程实践和不良应用程序设计的证据。多线程应用程序中的所有线程显式和隐式共享相同的进程状态并被迫相互合作以保持一致，否则您的应用程序将容易出现难以诊断的错误。因此，开发人员有责任通过仔细和清晰的应用程序设计来保证这种一致性。

受控线程终止有两种主要的正确解决方案：

*   使用共享的 volatile 标志
*   使用 Thread.interrupt() 和 Thread.interrupted() 方法对。

可以在此处找到与线程突然终止相关的问题的详细说明以及受控线程终止的错误和正确解决方案的示例：

[https://www.securecoding.cert.org/confluence/display/java/THI05-J.+Do+not+use+Thread.stop%28%29+to+terminate+threads](https://www.securecoding.cert.org/confluence/display/java/THI05-J.+Do+not+use+Thread.stop%28%29+to+terminate+threads)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-08-04T19:42:20.097

这里有一些关于这个主题的好读物：

[您如何处理 InterruptedException？](http://www.yegor256.com/2015/10/20/interrupted-exception.html)

[干净地关闭线程](http://www.javaspecialists.eu/archive/Issue056.html)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-07-07T10:48:17.857

我没有让中断在Android中工作，所以我使用了这种方法，效果很好：

```
boolean shouldCheckUpdates = true;

private void startupCheckForUpdatesEveryFewSeconds() {
    Thread t = new Thread(new CheckUpdates());
    t.start();
}

private class CheckUpdates implements Runnable{
    public void run() {
        while (shouldCheckUpdates){
            //Thread sleep 3 seconds
            System.out.println("Do your thing here");
        }
    }
}

 public void stop(){
        shouldCheckUpdates = false;
 } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-05-21T20:47:27.107

Thread.stop 已被弃用，那么我们如何在 java 中停止线程？

始终使用中断方法和未来请求取消

1.  当任务响应中断信号时，例如阻塞队列采取方法。

```
Callable < String > callable = new Callable < String > () {
    @Override
    public String call() throws Exception {
        String result = "";
        try {
            //assume below take method is blocked as no work is produced.
            result = queue.take();
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
        return result;
    }
};
Future future = executor.submit(callable);
try {
    String result = future.get(5, TimeUnit.SECONDS);
} catch (TimeoutException e) {
    logger.error("Thread timedout!");
    return "";
} finally {
    //this will call interrupt on queue which will abort the operation.
    //if it completes before time out, it has no side effects
    future.cancel(true);
} 
```

2.  当任务没有响应中断信号时。假设任务执行的套接字 I/O 不响应中断信号，因此使用上述方法不会中止任务，future 会超时但 finally 块中的取消将无效，线程将继续监听套接字。如果由池实现，我们可以关闭套接字或在连接上调用 close 方法。

```
public interface CustomCallable < T > extends Callable < T > {
    void cancel();
    RunnableFuture < T > newTask();
}

public class CustomExecutorPool extends ThreadPoolExecutor {
    protected < T > RunnableFuture < T > newTaskFor(Callable < T > callable) {
        if (callable instanceof CancellableTask)
            return ((CancellableTask < T > ) callable).newTask();
        else
            return super.newTaskFor(callable);
    }
}

public abstract class UnblockingIOTask < T > implements CustomCallable < T > {
    public synchronized void cancel() {
        try {
            obj.close();
        } catch (IOException e) {
            logger.error("io exception", e);
        }
    }

    public RunnableFuture < T > newTask() {
        return new FutureTask < T > (this) {
            public boolean cancel(boolean mayInterruptIfRunning) {
                try {
                    this.cancel();
                } finally {
                    return super.cancel(mayInterruptIfRunning);
                }
            }

        };
    }
} 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2021-12-01T14:22:41.937

经过 15 年以上的 Java 开发，我想对全世界说一件事。

弃用`Thread.stop()`和反对使用它的所有圣战只是另一个坏习惯或设计缺陷不幸成为现实......（例如，想谈谈`Serializable`界面？）

战斗的重点是杀死一个线程会使对象进入不一致的状态。所以？欢迎来到多线程编程。您是一名程序员，您需要知道自己在做什么，是的.. 杀死一个线程会使对象处于不一致的状态。如果您担心它，请使用 a`flag`并让线程优雅地退出；但是有很多时候没有理由担心。

但是没有..如果您键入`thread.stop()`，您可能会被所有查看/评论/使用您的代码的人杀死。所以你必须在你的代码周围使用 a `flag`, call `interrupt()`, place`if(!flag)`因为你根本没有循环，最后**祈祷**你用来进行外部调用的 3rd-party 库被正确编写并且不处理`InterruptException`不当。

# wpf - 在 WPF 中引用 Access 数据库 dataset.designer 文件？

> ID：671050
> 
> 赞同：2
> 
> 时间：2009-03-22T14:05:01.770
> 
> 标签：wpf, vb.net, ms-access, datagridview, datagrid

嘿，我在我的 WPF VB 应用程序中包含了一个 MS Access 数据库，我正在尝试将数据链接到 XCEED Datagrid。我的 testerDataSet.Designer.vb 文件中有以下代码，我认为这是我应该引用的函数

```
Public ReadOnly Property Contact() As ContactDataTable
    Get
        Return Me.tableContact
    End Get
End Property 
```

我正在尝试使用它来填充我的数据网格

```
 <Grid.Resources>
        <xcdg:DataGridCollectionViewSource x:Key="cvs_contacts" Source="{Binding Path=Contact, *Source={x:Static testerDataSet}*}"/>
    </Grid.Resources>
    <xcdg:DataGridControl Margin="54,18,4,3" Name="DataGridControl1" ItemsSource="{Binding Source={StaticResource cvs_contacts}}"/> 
```

不幸的是，粗体/凝视部分给了我错误，有人知道我应该在这里使用的正确代码来引用我的源代码吗？

多谢你们！

编辑：好的，让我试着概述一下我所做的事情......我已经在我的项目中添加了一个名为“tester”的 Access 2007 数据库作为现有项目，VS 已经为我制作了 testerDataSet，并在 testerDataset 内部。 Designer.vb 我假设上面的第一个代码是我需要显示我的表格数据的代码。

基本上我的 Window1.xaml 的整个代码如下（它只是一个测试项目，看看我是否真的可以让数据库工作）

```
<Window x:Class="Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1" Height="369" Width="503" xmlns:xcdg="http://schemas.xceed.com/wpf/xaml/datagrid">
<Grid>
    <Grid.Resources>
        <xcdg:DataGridCollectionViewSource x:Key="cvs_contacts" Source="{Binding Path=Contact, Source={StaticResource testerDataSet}}"/>
    </Grid.Resources>
    <xcdg:DataGridControl Margin="54,18,4,3" Name="DataGridControl1" ItemsSource="{Binding Source={StaticResource cvs_contacts}}"/>
</Grid> 
```

我想要实现的是让数据网格显示联系人数据表中的数据。我可能在这里遗漏了一些重要的东西（我对编码很陌生=/）老实说，我很难找到合适的教程，所以我不完全确定我在做什么

再次感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-22T14:13:43.590

您能否更新您的示例以包含静态资源 testerDataSet 的代码？

您可以尝试解决此问题的一种方法是直接在命令式代码中设置绑定。

```
DataGridControl1.DataContext = testerDataSet.Contact 
```

然后你可以修改你的WPF代码如下

```
<xcdg:DataGridControl 
  Margin="54,18,4,3" 
  Name="DataGridControl1" 
  ItemsSource="{Binding}" /> 
```

这可能不是您想要的 100%，但它至少应该暂时解除对您的阻止。

# c# - c# 中的高级 GUI 和数据库

> ID：671056
> 
> 赞同：0
> 
> 时间：2009-03-22T14:08:25.647
> 
> 标签：c#, database, user-interface

您是否知道如何显示表格中的所有行，并可以单击特定行并以这种方式打开另一个窗口进行编辑？

我不知道如何创建这个。我想避免通过 Microsoft Visual Studio 2008 中的内置向导创建访问。

也许你知道我在哪里可以找到更多信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T14:17:39.527

执行一个查询，检索您要显示的记录的概览。

当您双击一行时，您检索代表该实体的记录，并将其显示在另一个窗口中......

简而言之，您可以这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T19:17:41.067

好吧，我会将 wpf 与列表框的堆栈面板一起使用

这些行被动态添加到堆栈面板。列表框包含数据绑定到 mouseclickevents 和 onchanged 事件的文本字段。

[http://dotnetslackers.com/articles/silverlight/WPFTutorial.aspx](http://dotnetslackers.com/articles/silverlight/WPFTutorial.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T14:26:34.230

对于 Web 应用程序，您可能希望将此[演练](http://msdn.microsoft.com/en-us/library/stc0szde(VS.80).aspx)视为 MSDN。您也可以在 MSDN上找到[winform 演练。](http://msdn.microsoft.com/en-us/library/aa984462(VS.71).aspx)尽管您说您更喜欢在没有设计器的情况下执行此操作，但我建议您使用设计器完成演练，并查看它生成的代码作为您如何手动完成的示例。然后，您可以根据需要调整示例以满足您的目的。如需更多参考，请尝试使用谷歌搜索“主详细信息视图”。

# firefox - Firefox addon to remove cache and cookies of one domain?

> ID：671057
> 
> 赞同：33
> 
> 时间：2009-03-22T14:08:47.270
> 
> 标签：firefox, cookies, firefox-addon, browser-cache

I use Firefox to develop a web site and at the same time to browse the web, read my gmail, etc.

The problem is every now and then I need to delete the cache and or remove the cookies of the web app, but I want to stayed logged in in the other web pages I am visiting.

Do you know a Firefox plugin (or Firefox trick) that can help with this issue?

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-22T14:40:06.990

`Preferences` → `Privacy` → `remove individual cookies`

They are grouped by domain, and you can eliminate all cookies from selected domain with one click.

![enter image description here](https://i.stack.imgur.com/AmfXY.png)

Update: `Option` → `Privacy` → `remove individual cookies`

[![enter image description here](https://i.stack.imgur.com/ofzao.png)](https://i.stack.imgur.com/ofzao.png)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-23T13:55:00.787

There are two add-ons for FF that every web developer needs and they are [Web Developer Toolbar](https://addons.mozilla.org/en-US/firefox/addon/60) and [Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843), the Firebug extension [YSlow](https://addons.mozilla.org/en-US/firefox/addon/5369) comes in very handy too.

Web Developer Toolbar has great cache and cookie control down to individual cookies. Firebug lets you mess with the DOM and CSS directly for a page and YSlow is good for page weight and response times.

Be careful having Firebug enabled for JavaScript heavy sites as they really slow down. GMail will warn you about this and tell you to turn it off. I have had a problem trying to disbable sites with the menus when the tool is embedded in the browser at the bottom but opening it in its own windows the sites menu works fine.

I personnaly also like [IE Tab](https://addons.mozilla.org/en-US/firefox/addon/1419) which means I can quickly view a page in IE without leaving FF and I can also get it to load anything that only works in IE with it.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-22T14:45:52.297

[Cookie Monster](https://addons.mozilla.org/en-US/firefox/addon/4703) might work?. Also, have you considered just using two [profiles](http://support.mozilla.com/en-US/kb/Profiles) in Firefox? You could setup two profiles with two icons and use one profile for the website and the other for the non-development. The only problem would be you can only have one open at once.

Also, two browsers (Chrome, IE, Firefox, etc) might work well too.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-22T16:17:43.543

WebDeveloper extension allows to delete cookies for domain. It also can clear cache, although for me `Ctrl-F5` is enough usually.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-02-22T06:43:31.463

I had the same problem and found a firefox addon to remove the cookies for the current site that you are displaying:

[https://addons.mozilla.org/en-US/firefox/addon/remove-cookies-for-site/](https://addons.mozilla.org/en-US/firefox/addon/remove-cookies-for-site/)

Using that I don't have to navigate the firefox menus to find my site in the list (which was too time consuming). This does not cover the cache-issue. For that there is the Ctrl+F5 other people have mentioned. It is covered in good detail here:

[What requests do browsers' "F5" and "Ctrl + F5" refreshes generate?](https://stackoverflow.com/questions/385367/what-requests-do-browsers-f5-and-ctrl-f5-refreshes-generate)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-04-13T05:19:10.157

Best solution:
1) Just Click **`CTRL+H`** and search the site.
2) right click on it and choose **`Forget About this site`** (source: [https://superuser.com/a/733154/249349](https://superuser.com/a/733154/249349) )

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-10-07T10:25:33.120

If you would like to use firefox, clear cache and cookies for one domain and stay logged in (and retain cache) at other sites, you could run a second firefox profile concurrently using the '-no-remote' parameter. I use this all the time to view sites I am building from an anonymous and administrative perspective at the same time.

One way to do this (in windows xp) is: make two profiles, then startmenu->run type 'firefox -profilemanager', untick the 'don't ask next time' box and load profile 1, then startmenu->run type 'firefox -no-remote' and load profile 2\. You should now have two seperate firefox profiles running.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-02-03T15:54:44.770

Clearing cookies for a single domain is easy with any one of a number of tools. Clearing the cache for a single domain or at the individual page level is sometimes useful, but hasn't turned out so easy for me thus far.

One specific situation is changing a meta redirect, where you can't just ctrl-F5 (you're being redirected, after all). Using a different profile isn't an acceptable general solution. Web Developer toolbar can disable the cache to test that the change is working but it's only a temporary fix, and not one that can readily be suggested to a client in order for them to view the change.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-03T15:48:04.113

I use [SQLite Manager](https://addons.mozilla.org/en-US/firefox/addon/5817) for firefox to remove single sites from cache. All you have to do is open places.sqlite in your user profile folder using this plugin and remove the site. It's not exactly an easy solution but it does work. Make sure you backup your profile 1st!

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-04-04T22:36:29.470

Ross, I have the perfect answer for you. Get on the current tab that you want cookies cleared. Click tools > Page Info. Or install [Page Info Forms & links](https://addons.mozilla.org/en-US/firefox/addon/7978 "Page Info Forms & links") for a shortcut. Then click the Security Tab. Then View Cookies button. It will bring up all the cookies for the relevant domain. Click the ones you want to delete, and click remove.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-12-31T22:08:09.453

Seems we have cookies covered here.

As for cache, the trick is to make your development server force a refresh. In httpd, you probably have some some cache directives to swap out for these:

```
 Header set Cache-Control "no-cache, must-revalidate"
   ExpiresActive On
   ExpiresDefault "now" 
```

In header:

```
<meta http-equiv="cache-control" content="no-cache, no store"/> 
```

The benefit of doing it the httpd way is that your scripts/images/css get refreshed. In that way you are not restricting yourself to just browser with web developer toolbar, you can use other browsers such as chrome that does not do the no-cache thing so easily.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-09-05T08:25:17.370

Another extension that handles the **cookie** part of the question with a little more ease than the rest is [Close'n forget](https://addons.mozilla.org/en-US/firefox/addon/closen-forget)

[https://addons.mozilla.org/en-US/firefox/addon/closen-forget](https://addons.mozilla.org/en-US/firefox/addon/closen-forget)

You can use it by toolbar button/context menu/keyboard shortcut in order to close the current page, discarding any cookies it held.
Optionally, the site can be removed from browser history and (again optionally) all the pages you visited in the current page can be removed from browser history too.

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2009-03-22T15:50:44.667

Simple solution is simple - use two different browsers.
Say chrome for your email and Firefox for dev.

Also, you have [Cookie Swap](https://addons.mozilla.org/en-US/firefox/addon/3255). but it doesn't really work quite as smoothly as you'd like.

# asp.net - .NET 示例项目设计模式 Fowler

> ID：671060
> 
> 赞同：1
> 
> 时间：2009-03-22T14:11:45.483
> 
> 标签：asp.net, design-patterns, projects, sample, poeaa

是否有使用 Martin Fowler （[企业应用程序架构模式](https://rads.stackoverflow.com/amzn/click/com/0321127420)）书中讨论的模式的示例 ASP.NET 项目？

我已经下载了 Northwind 入门工具包和 Dinner Now，它们非常好。是否还有其他人使用诸如工作单元，存储库之类的东西...

谢谢，列文卡登

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T14:27:04.387

[dofactory.com](http://www.dofactory.com/Patterns/Patterns.aspx)作为 C# 和 VB.NET GoF 模式示例。他们还有一个完整的 ASP.NET Web 应用程序示例，详细说明了这些模式的使用，尽管我认为这不是免费下载的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T14:31:06.560

你也许可以看看[cuyahoga](http://www.cuyahoga-project.org/)。它使用 NHibernate（它是 UnitOfWork 模式的实现（并且它也使用身份映射模式）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T14:35:14.163

WPF的[复合客户端应用程序指南](http://msdn.microsoft.com/en-us/library/cc707819.aspx)有一些单元测试和 nHibernate 的示例。

此外，如果您正在寻找好的 nHibernate 截屏视频，请查看 nHibernate 之[夏](http://www.summerofnhibernate.com/)

# visual-studio - Visual Studio 2008 - 显示堆

> ID：671068
> 
> 赞同：8
> 
> 时间：2009-03-22T14:14:10.143
> 
> 标签：visual-studio, visual-studio-2008, stack, heap-memory

调试时可以查看堆和栈吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-22T14:29:42.147

AFAIK，您要使用的主要窗口是MSDN 具有的 Locals ( `Ctrl`+ `Alt`+ `V`, `L`) 和 Autos ( `Ctrl`+ `Alt`+ `V`, ) 窗口：`L`

*   Locals 窗口显示当前上下文或范围的局部变量。通常，这意味着您当前正在执行的过程或功能。调试器会自动填充此窗口。在 Visual C# 中，当异常助手被禁用时，Locals 窗口也会在出现活动异常时显示一个伪变量 $exception。您可以展开伪变量以查看异常的详细信息。*   Autos 窗口显示在当前代码行和前一行代码中使用的变量。对于本机 C++，Autos 窗口也显示函数返回值。与 Locals 窗口一样，Autos 窗口由调试器自动填充。

...对于堆栈，有调用堆栈窗口（调试 -> 窗口 -> 调用堆栈）或`Ctl`+ `Alt`+ `C`。

但是，我觉得这不是你想要的。

如果您正在寻找“内存中”视图，您可以使用 Visual Studio 的内存窗口，该窗口可以从 Debug -> Windows -> Memory -> Memory x 菜单（其中 x 为 1-4）访问或`Ctrl`+ `Alt`+ `M`, 1-4。

正如一些人现在提到的，还有一些其他外部工具对内存调试非常有用（我主要使用 SysInternals 工具和 Windows 调试工具）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-22T14:29:17.453

您需要“调用堆栈窗口”... [http://msdn.microsoft.com/en-us/library/a3694ts5.aspx](http://msdn.microsoft.com/en-us/library/a3694ts5.aspx)

> 通过使用调用堆栈窗口，您可以查看当前在堆栈上的函数或过程调用。

对于堆，“内存窗口”... [http://msdn.microsoft.com/en-us/library/s3aw423e(VS.80).aspx](http://msdn.microsoft.com/en-us/library/s3aw423e(VS.80).aspx)

> 内存窗口提供了应用程序使用的内存空间的视图。

“恢复隐藏的调试器命令”也可能有用... [http://msdn.microsoft.com/en-us/library/9k643651(VS.80).aspx](http://msdn.microsoft.com/en-us/library/9k643651(VS.80).aspx)

当您进入调试内存时，其他调试器将更加有用。正如有人建议的那样，WinDbg 非常适合内存调试。我自己经常使用 IDA Pro Disassembler。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T14:22:37.813

您可以在调试时查看调用堆栈，但我认为这不是您想要的。您可能想尝试 Windbg 和 SOS，它们非常适合调试内存问题。学习曲线有点陡峭，但回报是巨大的。

[适用于 Windows 的 Microsoft 调试工具](http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T15:48:35.673

如果您出于某种原因确实想查看原始内存，您可以从“ `Debug->Windows->Memory`”打开“内存”调试窗口，并在编辑框中写入您要查看的地址。您还可以在编辑框中写入任何计算结果为地址的表达式，它会向您显示该地址，例如`&variable`

这对于实际查看变量不是很有用，因为您将很难将原始字节解析为有意义的值，但它对于您怀疑存在缓冲区溢出或内存被意外覆盖的调试情况很有用。[与data-breakpoints](http://msdn.microsoft.com/en-us/library/ktf38f66(VS.71).aspx)结合使用时特别有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-13T15:07:13.030

我知道这是一个老问题，但我想我还是会更新它......

Visual Studio 2015 带有内置于诊断工具面板的内存使用监视器。如果您在要检查的内容之前、期间和之后拍摄快照，则可以追溯查看这些快照的堆视图。

希望这可以帮助某人。

# vb.net - 如何使用 VB.NET 在访问数据库中处理数据记录（添加、编辑和删除）？

> ID：671069
> 
> 赞同：0
> 
> 时间：2009-03-22T14:14:13.153
> 
> 标签：vb.net, database-connection, commit

在 Access 2007 和 Visual Studio 2008 上工作，我已经将我的数据库连接到应用程序，并且可以查看数据网格上的数据并且可以添加或编辑或删除记录，问题是这些更改不会进入数据库，所以当我关闭时并重新打开应用程序，我找到了以前的旧数据。注意：我使用向导添加连接，而不是代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T14:21:57.783

您必须查看 OleDbDataAdapter 类，检查 UpdateCommand / InsertCommand / etc... 属性，将 OleDbCommand 分配给这些属性并确保这些命令具有适当的 SQL 语句。

我想您正在使用绑定到数据网格的数据集/数据表。当您进行更改时，将在 DataTable 对象中进行更改。对于已更改的每一行，将修改该行的 RowState 属性。

如果您调用 DataAdapter 的“Update()”方法，则 DataAdapter 将查看哪些行已更改，并为该行执行正确的 OleDbCommand。

这将确保更改保留在数据库中。
之后，您必须确保调用 DataTable 或 Dataset 的“AcceptChanges”方法。

但是，那里有很多教程...... [教程](http://www.google.be/search?hl=nl&q=dataset+dataadapter+tutorial&btnG=Google+zoeken&meta=)

# asp.net - 在哪里设置用户控制事件处理程序？

> ID：671071
> 
> 赞同：1
> 
> 时间：2009-03-22T14:15:26.067
> 
> 标签：asp.net

在页面生命周期中的哪个位置最适合为自定义用户控件引发的事件设置事件处理程序委托？

我有一个`ReportFilter`引发`ApplyFilterClicked`事件的用户控件。目前我只是`Page_Load`用来分配一个处理程序方法。

```
reportFilter.ApplyFilterClicked += reportFilter_ApplyFilterClicked; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T20:13:23.523

如果您正在动态创建用户控件，那么最合适的位置是在 Init 阶段，即创建（或应该）控件的位置。

否则，加载阶段将正常工作，并且可能是大多数人设置它们的地方。显然，您不能在此之后的任何地方设置处理程序，否则它们将永远不会被调用，因为事件处理阶段是 Load 之后的下一个阶段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T20:18:22.683

通常初始化阶段最适合创建控件，因为这将有助于控件的视图状态更新。查看此页面以获取有关页面生命周期的一些有用信息：

[http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

希望这可以帮助

# c++ - 为什么不允许将数组按值传递给 C 和 C++ 中的函数？

> ID：671074
> 
> 赞同：10
> 
> 时间：2009-03-22T14:17:39.337
> 
> 标签：c++, c, arrays, function, parameter-passing

C 和 C++ 允许将结构和对象按值传递给函数，但阻止按值传递数组。

为什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-22T14:22:28.203

在 C/C++ 中，在内部，数组作为指向某个位置的指针传递，基本上，它*是*按值传递的。问题是，复制的值表示*同一位置*的内存地址。

顺便说一下，在 C++ 中， a`vector<T>`被复制并传递给另一个函数。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-22T14:18:37.930

您可以按值传递数组，但您必须首先将其包装在结构或类中。或者干脆使用像 std::vector 这样的类型。

我认为这个决定是为了效率。大多数时候都不想这样做。这与为什么没有无符号双打的原因相同。没有相关的 CPU 指令，因此您必须使效率不高的事情很难用 C++ 之类的语言来完成。

正如@litb 提到的：“C++1x 和 boost 都将原生数组包装到提供 std::array 和 boost::array 的结构中，这是我一直喜欢的，因为它允许在结构中传递和返回数组”

数组是指向包含该数组和大小的内存的指针。请注意，它与指向数组第一个元素的指针并不完全相同。

大多数人认为您必须将数组作为指针传递并将大小指定为单独的参数，但这不是必需的。您可以传递对实际数组本身的引用，同时保持它的 sizeof() 状态。

```
//Here you need the size because you have reduced 
// your array to an int* pointing to the first element.
void test1(int *x, int size)
{
  assert(sizeof(x) == 4);
}

//This function can take in an array of size 10
void test2(int (&x)[10])
{
  assert(sizeof(x) == 40);
}

//Same as test2 but by pointer
void test3(int (*x)[10])
{
  assert(sizeof(*x) == 40);
  //Note to access elements you need to do: (*x)[i]
} 
```

有人可能会说数组的大小是未知的。这不是真的。

```
int x[10];  
assert(sizeof(x) == 40); 
```

但是堆上的分配呢？堆上的分配不返回数组。它们返回指向数组第一个元素的指针。所以 new 不是类型安全的。如果您确实有一个数组变量，那么您将知道它所包含的大小。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-22T14:21:56.333

编辑：我在下面留下了原始答案，但我相信大部分价值现在都在评论中。我已将其设为社区 wiki，因此如果参与后续对话的任何人想要编辑答案以反映该信息，请随意。

**原始答案**

一方面，它如何知道要分配多少堆栈？这对于结构和对象（我相信）是固定的，但是对于数组，它将取决于数组的大小，直到执行时才知道。（即使每个调用者在编译时都知道，也可能有不同的调用者具有不同的数组大小。）您可以在参数声明中强制使用特定的数组大小，但这似乎有点奇怪。

除此之外，正如布赖恩所说，还有效率问题。

你想通过所有这些实现什么？是否要确保原始数组的内容没有改变？

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-22T17:41:55.883

我认为数组在 C 中作为指针而不是按值传递的主要原因有 3 个。其他答案中提到了前两个：

*   效率
*   因为通常没有数组的大小信息（如果包含动态分配的数组）

但是，我认为第三个原因是由于：

*   C 从 B 和 BCPL 等早期语言演变而来，其中数组实际上是作为指向数组数据的指针实现的

Dennis Ritchie 谈到了 C 从 BCPL 和 B 等语言的早期演变，特别是数组是如何实现的，它们如何受到 BCPL 和 B 数组的影响，以及它们如何以及为什么不同（同时在表达式中保持非常相似，因为数组名称会衰减到表达式中的指针）。

*   [http://plan9.bell-labs.com/cm/cs/who/dmr/chist.html](http://plan9.bell-labs.com/cm/cs/who/dmr/chist.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-22T16:42:45.307

这是那些“只是因为”的答案之一。C++ 从 C 继承了它，并且必须遵循它以保持兼容性。为了提高效率，它在 C 中是这样做的。您很少希望在堆栈上复制一个大型数组（请记住，这里是 PDP-11）以将其传递给函数。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-22T14:27:27.473

我实际上并不知道**任何**支持按值传递**裸**数组的语言。这样做不会特别有用，并且会很快占用调用堆栈。

**编辑：**对downvoters - 如果你知道更好，请让我们都知道。

# concurrency - 业务应用程序 - 使用消息传递的悲观并发

> ID：671081
> 
> 赞同：2
> 
> 时间：2009-03-22T14:19:19.693
> 
> 标签：concurrency, messaging, optimistic, pessimistic

我们在我们的一个项目中使用消息传递来实现悲观并发。这意味着如果消息传递中断（通道中断），并发性就会下降。

*   这是在其他业务应用程序中完成的吗？
*   如果消息传递失败，您是否关闭应用程序（注销用户）？

我更多地考虑将乐观和悲观并发结合起来。那么如果悲观并发下降了，还有一个备用乐观并发......

谢谢，列文卡登

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T16:12:48.377

像往常一样，我认为答案取决于您正在构建的业务应用程序的性质。您的应用程序的 SLA 是什么？它的任务有多关键？

如果您的消息传递基础设施出现故障，除了锁定服务之外，应用程序是否继续运行？如果是这样，那么您可能有义务确保您的并发控制机制不是单点故障。

此外，实现真正分布式、容错的悲观锁定机制的主题需要[解决共识问题](http://en.wikipedia.org/wiki/Consensus_(computer_science))。大多数悲观锁定算法依赖于可以响应锁定请求的单个序列化授权（即有一个“锁定”表或者可能有一个单例锁定服务器）。

这样的设计到处都是单点故障。要回答您的第一个问题——是的，我已经看到业务应用程序使用消息传递来提供悲观锁定。然而，对于我遇到的大多数业务应用程序来说，完全解决容错问题似乎有点过头了。

乐观并发控制本质上不存在这个问题，这就是为什么它在分布式、容错应用程序中通常是首选的原因。但是，我意识到业务需求经常胜过易于实施。

如果您对该主题感兴趣，Google 已经发表了一篇关于他们的[Chubby Lock Service](http://labs.google.com/papers/chubby.html)的文章，该服务利用了[Paxos 共识协议](http://en.wikipedia.org/wiki/Paxos_algorithm)。

# java - 使用变量名作为数组索引

> ID：671088
> 
> 赞同：-2
> 
> 时间：2009-03-22T14:24:51.740
> 
> 标签：java, arrays, variables

我有几个文件放在数组中。我将文件打乱，以便可以随机顺序显示。如何知道数组索引 0 实际上是 image1.txt 或 image2.txt 或 image3.txt？提前致谢。

```
String[] a = {"image1.txt","image2.txt","image3.txt"};
List<String> files = Arrays.asList(a);
Collections.shuffle(files); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T14:28:52.227

我不确定您要做什么。

要访问混洗列表的第一个元素，请使用`files.get(0)`.

如果您想知道每个元素都去了哪里，我建议您采取另一种方法。创建一个从`0`到的整数列表`a.length() - 1`，包括和随机播放该列表。然后手动将数组置换`a`为新集合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T15:27:49.997

## 不正确 - 见解释

注意：Arrays.asList() 将使用传递的数组的内容创建一个新列表。使用 Collections.shuffle() 时，根本不会修改原始数组。

## 解释

彼得正确地指出我们 Arrays.asList() 不会复制。返回的列表“直写”回原始数组。打乱列表将打乱原始数组的内容。还值得注意的是列表是不可变的（不能添加新元素），但通常我发现 Arrays.asList() 的使用无论如何都涉及不可变列表。

```
files.get(0); // get the first elements in shuffled list, random

// as greg said
int index = files.indexOf(a[0]); // find out where "image1.txt" is in the list
files.get(index); // get "image1.txt" back from the list 
```

# javascript - 透明的谷歌齿轮场景验证

> ID：671093
> 
> 赞同：1
> 
> 时间：2009-03-22T14:28:50.043
> 
> 标签：javascript, architecture, web-applications, google-gears

我想使用谷歌齿轮，不是为了功能，而是为了优化。

即如果在浏览器端检测到齿轮，那么我们将默默地使用它在客户端进行一些优化和缓存。如果没有安装，我们只对服务器静默工作。

在我们网站的常见问题解答或帮助页面的某处，我们会告诉用户我们的网站推荐齿轮以获得最佳性能 - 但这不是必须的，我们不会使用“离线功能”。

你认为这是一个有效的 google-gears 使用场景吗？你推荐它/反对它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T01:04:51.367

对我来说，这听起来像是一个有效的使用场景......只是意识到你将无法 100% 透明地做到这一点，因为用户必须告诉 gears 允许你的网站使用它。考虑到这一点，你绝对应该让它成为一个选择（[如 gears faq 中所述](http://code.google.com/apis/gears/gears_faq.html#bestGearsPerms)），而不是在发现它已安装时尝试使用它，否则你会比性能稍差的用户更恼火有。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T23:34:11.397

我认为这是一个很好的可能性，但为什么要试图隐藏它呢？正如其他回复中提到的那样，该过程永远不会真正透明，因为在某些时候需要进行一些初始设置。与其隐藏该功能，（取决于您的项目），您可以使用它来生成有关您的应用程序的一些正面消息。

也许默认情况下，您从主服务器提供内容，但在底部或顶部，包括一个突出显示的链接（想想 Gmail 中的“最新消息”）。它可以说诸如“将性能提高 50%”之类的内容。下一页可能包含正在发生的事情的快速摘要，以及用户为什么会使用 Gears。同样，当它启动时，您可以利用这个机会炫耀“您花费开发时间在做什么”。

我理解为什么您可能希望 Gears 不显眼，但不要让用户难以在您的网站上获得最佳体验。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T23:43:12.200

Wordpress 还促进了 Gears 的使用，部分原因是为了加快操作速度 - 离线模式下的 Gmail（或至少具有有效的离线支持）也（恕我直言）更快地使用。

I say go for it - and if you can add offline support - and it makes sense - do that as well!

# architecture - 什么是信息架构？（什么）它与编程有什么关系？

> ID：671101
> 
> 赞同：2
> 
> 时间：2009-03-22T14:31:44.827
> 
> 标签：architecture, information-architecture

我已经多次遇到这个概念，但没有找到明确的解释。它是什么？跟编程有什么关系？它与我们（软件工程师/程序员）所谓的架构有什么关系？它对我有什么帮助？我怎样才能让它为我工作？最了解该主题的专业人士如何称呼？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T14:37:01.647

这是一个与系统架构双重的概念，除了该方法以信息本身为中心，而不是以处理信息的系统为中心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T14:38:50.770

决定您要呈现/管理哪些信息以及如何组织它的艺术；参考维基百科[文章](http://en.wikipedia.org/wiki/Information_architecture)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T14:41:36.190

来自维基百科，[信息架构](http://en.wikipedia.org/wiki/Information_architecture)是：

“表达在需要复杂系统的明确细节的活动中使用的信息模型或概念的艺术。” 示例包括图书馆系统、数据库、内容管理 (CMS) 系统、Web 开发、用户交互、企业架构和关键系统软件设计。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T21:56:05.103

在 .COM 繁荣时期，信息架构是每个 Web 开发宣传的“重要”部分。它表明你[读过这本书](http://oreilly.com/catalog/9780596000356/)。根据我这些天的经验，它不太明确，大多数 Web 开发人员和内容管理人员天生就明白，必须以连贯的方式排列和呈现信息，才能对用户有意义。我很想知道是否有人注意到这个短语的使用越来越少。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T03:49:59.550

## 内容和文档趋势

信息架构正在经历快速增长和关注的一个领域是技术写作和内容创作。这在许多方面与该行业的趋势有关，其中成本降低和可用性要求增加影响了[基于主题的创作](http://dita-ot.sourceforge.net/doc/ot-userguide13/xhtml/faqs/topic_authoring.html)和[单一来源出版](http://en.wikipedia.org/wiki/Single_source_publishing)的增长。

一个很好的例子是[达尔文信息类型架构](http://en.wikipedia.org/wiki/Darwin_Information_Typing_Architecture)，或 DITA。顾名思义，该模型依赖于信息架构作为管理内容的一种手段。该领域的信息架构师将了解采购和生成、管理和维护以及不断增加的发布格式和机会背景下的内容。

## 在工作中

这种特定的信息架构师角色描述需要与分析、编程和文档的许多领域重叠的技能。他们可能知道 DocBook XML、LaTeX、一些 Javascript 或 Python、分析基础知识、报告套件、SQL 或类似内容、图表和映射。他们很可能使用了 IBM 的[Information Architecture Workbench](http://dita.xml.org/product/ibm-ibm-information-architecture-workbench)，它以前称为[Task Modeler](http://dita-ot.sourceforge.net/doc/ot-userguide13/xhtml/core_vocabulary/task_modeler.html)，是 IBM DITA 工作的一部分。最重要的是，他们将从事分类和信息拓扑。

## 分类和映射

这简直是​​重复。信息架构对于寻求管理单一来源和基于主题的创作模型的专业知识的文档团队的需求不断增加，这些模型通常使用自定义组件内容管理系统 ( [CCMS](http://en.wikipedia.org/wiki/Component_content_management_system) )，并且重点关注内容和数据抵押品的[分类](http://en.wikipedia.org/wiki/Taxonomy)。随着这些需求的发展，这些 IA 将致力于整个业务内容和门户问题，这使该角色在 Web 开发方面与“传统”IA 定义保持一致。

换句话说，他们是技术作家、工程师、项目经理、团队领导和其他疯狂而奇妙的重叠角色之间的粘合剂。该资源的解释方式在组织、项目甚至团队之间会有所不同。目前，它是一个具有独特技能的角色，但它会因专业化而流行，因为它可以轻松地重叠许多不同的领域，允许许多不同的专业知识途径。我认为这对整体创新来说绝对是一件好事。

# wpf - 如何使用 linq 在树视图中搜索元素？

> ID：671107
> 
> 赞同：1
> 
> 时间：2009-03-22T14:37:31.100
> 
> 标签：wpf, linq, treeview

我正在寻找一种 linq-to-objects 方法来从 treeView 获取 TreeViewItem。

我想做这样的事情：

```
var node =
            from TreeViewItem childs in tree.Items
            where  ((int) childs.Tag) == 1000   
            select childs;

string tag = ((TreeViewItem)node).Tag.ToString(); 
```

然后我想将孩子附加到这个节点。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T14:47:25.897

您需要使用 FirstOrDefault 从查询创建的枚举中提取第一个匹配元素。在检查它不为空后，您可以像往常一样对其进行操作。

```
 var query =
        from TreeViewItem childs in tree.Items
        where  ((int) childs.Tag) == 1000   
        select childs;

 var node = query.FirstOrDefault();

 if (node != null)
 {
    ...
 } 
```

请注意，您将不再需要演员表，因为 FirstOrDefault 将返回 TreeViewItem。

# c# - C# Indexer 内存问题

> ID：671108
> 
> 赞同：2
> 
> 时间：2009-03-22T14:38:43.623
> 
> 标签：c#, stack, heap-memory, indexer

我在 main 方法中有以下代码：

```
List<Rectangle> rects = new List<Rectangle>();

for (int i = 0; i < 5; i++)
{
    rects.Add(new Rectangle(1, 1, 1, 1));
}

foreach (Rectangle item in rects)
{
    Console.WriteLine(item);
}

rects[1].Inflate(100, 100);

foreach (Rectangle item in rects)
{
    Console.WriteLine(item);
} 
```

在呈现的代码中，rects[1] 保持不变。这是因为 indexer（仍然是一种特殊方法）返回了矩形结构的*副本*。在这种情况下，元素位于*heap*上。索引器通过将新*副本放在堆栈上返回元素的新**副本*（因为 Rectangle 是值类型）。

 *到现在为止还挺好...

后来我在 Program 类中创建了一个 Rectangle 结构数组：

```
 Rectangle[] rect = new Rectangle[] { new Rectangle(1, 1, 1, 1), new Rectangle(1, 1, 1, 1) }; 
```

在主要方法中：

```
Program p = new Program();

p.rect[1].Inflate(100, 100);

foreach (var item in p.rect)
{
    Console.WriteLine(item);
} 
```

我希望 rect 数组的索引器也返回矩形结构的*副本*，但是这次更改了原始元素（也位于*堆上*）。

这是为什么？数组索引器是否以不同的方式工作？

亲切的问候 PK

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T14:43:52.113

由此您得出结论，列表上的索引器是一个方法调用，它在从方法返回时将值类型的值放在堆栈上，并且数组索引器实际上在代码中被转换为计算从开始的偏移量数组并且是直接的内存引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T14:41:53.447

是的。数组索引器表示要直接更改的变量。索引器基本上是一种带有索引参数的方法，其中应用了语法糖。

同样的差异也适用于字段和属性。

如果你从索引器返回一个引用类型，它不会有太大的不同，因为它仍然会引用同一个对象。但是当您返回一个`struct`实例（或任何值类型）时，该值在返回时被复制并且您试图修改副本，这几乎没有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T14:42:17.093

据我所知，数组的“索引器”并不是真正的索引器。数组（或者更确切地说是 Array 类型）在 .NET Framework 中不能被视为普通类型，因为它的特殊作用。（再举一个例子，数组项是协变的，与其他类型相比，这在许多情况下有助于导致异常）。它只是引用数组的第 n 个元素，因此它返回的对象实际上是存储在数组中的实际对象。只需分别对待这两个概念。它们具有相同语法的事实在这里并不重要 - 功能上有一些相似之处，但不多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T16:32:02.667

如前所述，数组是 CLI 中的特殊事物。他们没有索引器。对数组的“索引”直接转换为适当的 ldelem CIL 指令。

# ruby-on-rails - 复数和测试中的错误？

> ID：671113
> 
> 赞同：1
> 
> 时间：2009-03-22T14:40:39.440
> 
> 标签：ruby-on-rails

我有一个名为 TipoContato 的模型（表tipos_contato），如果我将它复数，它将成为tipo_contatos，所以我将它添加到变形：

```
inflect.irregular 'tipo_contato', 'tipos_contato' 
```

好的，在控制台中测试它是完美的：

```
>> TipoContato
=> TipoContato(id: integer, descricao: string, created_at: datetime, updated_at: datetime) 
```

但是，在运行测试用例时，我收到此错误：

```
ActiveRecord::StatementInvalid: Mysql::Error: Table 'contacts_test.tipo_contatos' doesn't exist: DELETE FROM `tipo_contatos` 
```

试图强制导轨识别我的桌子我试过：

```
set_table_name 'tipos_contato' 
```

我得到了同样的错误。

导轨 2.3.2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T15:11:06.760

不确定这是否是一个错误，但有一个解决方法。将fixtures 文件的名称更改为tipos_contato.yml。接下来，将其连接到单元测试中，如下所示：

```
class TipoContatoTest < ActiveSupport::TestCase
  set_fixture_class :tipos_contato => TipoContato
  ...
end 
```

这是一篇更详细地描述这一点的[帖子。](http://www.missiondata.com/blog/uncategorized/80/rails-fixtures-with-models-using-set_table_name/)

# rest - RESTful 编程到底是什么？

> ID：671118
> 
> 赞同：4102
> 
> 时间：2009-03-22T14:45:39.317
> 
> 标签：rest, http, architecture, definition

RESTful 编程到底是什么？

* * *

## 回答 #1

> 赞同：2970
> 
> 时间：2009-03-22T14:53:10.937

*REST*是 Web 的底层架构原则。Web 的惊人之处在于，客户端（浏览器）和服务器可以以复杂的方式进行交互，而客户端无需事先了解服务器及其托管的资源。关键约束是服务器和客户端都必须就使用的*媒体*达成一致，在 Web 的情况下是*HTML*。

遵循*REST*原则的 API不需要客户端了解 API 的结构。相反，服务器需要提供客户端与服务交互所需的任何信息。*HTML 表单*就是一个例子：服务器指定资源的位置和必填字段。**浏览器事先不知道在哪里提交信息，也不事先知道要提交什么信息。两种形式的信息都完全由服务器提供。**（这个原理被称为[*HATEOAS* : Hypermedia As The Engine Of Application State](https://en.wikipedia.org/wiki/HATEOAS)。）

**那么，这如何应用于*HTTP*，以及如何在实践中实现呢？**HTTP 以动词和资源为导向。主流用法中的两个动词是`GET`and `POST`，我想大家都会认识的。但是，HTTP 标准定义了其他几个标准，例如`PUT`和`DELETE`。然后根据服务器提供的指令将这些动词应用于资源。

例如，假设我们有一个由 Web 服务管理的用户数据库。我们的服务使用基于 JSON 的自定义超媒体，我们为其分配 mimetype `application/json+userdb`（也可能有一个`application/xml+userdb`和`application/whatever+userdb`- 可能支持许多媒体类型）。客户端和服务器都被编程来理解这种格式，但他们对彼此一无所知。正如[罗伊菲尔丁](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)指出的那样：

> REST API 应该花费几乎所有的描述性工作来定义用于表示资源和驱动应用程序状态的媒体类型，或定义扩展关系名称和/或现有标准媒体类型的超文本启用标记。

对基础资源的请求`/`可能会返回如下内容：

**要求**

```
GET /
Accept: application/json+userdb 
```

**回复**

```
200 OK
Content-Type: application/json+userdb

{
    "version": "1.0",
    "links": [
        {
            "href": "/user",
            "rel": "list",
            "method": "GET"
        },
        {
            "href": "/user",
            "rel": "create",
            "method": "POST"
        }
    ]
} 
```

我们从媒体的描述中知道，我们可以从称为“链接”的部分中找到有关相关资源的信息。这称为*超媒体控件*。在这种情况下，我们可以从这样的部分中得知，我们可以通过发出另一个请求来找到用户列表`/user`：

**要求**

```
GET /user
Accept: application/json+userdb 
```

**回复**

```
200 OK
Content-Type: application/json+userdb

{
    "users": [
        {
            "id": 1,
            "name": "Emil",
            "country: "Sweden",
            "links": [
                {
                    "href": "/user/1",
                    "rel": "self",
                    "method": "GET"
                },
                {
                    "href": "/user/1",
                    "rel": "edit",
                    "method": "PUT"
                },
                {
                    "href": "/user/1",
                    "rel": "delete",
                    "method": "DELETE"
                }
            ]
        },
        {
            "id": 2,
            "name": "Adam",
            "country: "Scotland",
            "links": [
                {
                    "href": "/user/2",
                    "rel": "self",
                    "method": "GET"
                },
                {
                    "href": "/user/2",
                    "rel": "edit",
                    "method": "PUT"
                },
                {
                    "href": "/user/2",
                    "rel": "delete",
                    "method": "DELETE"
                }
            ]
        }
    ],
    "links": [
        {
            "href": "/user",
            "rel": "create",
            "method": "POST"
        }
    ]
} 
```

我们可以从这个回应中看出很多。例如，我们现在知道我们可以通过`POST`ing 来创建一个新用户`/user`：

**要求**

```
POST /user
Accept: application/json+userdb
Content-Type: application/json+userdb

{
    "name": "Karl",
    "country": "Austria"
} 
```

**回复**

```
201 Created
Content-Type: application/json+userdb

{
    "user": {
        "id": 3,
        "name": "Karl",
        "country": "Austria",
        "links": [
            {
                "href": "/user/3",
                "rel": "self",
                "method": "GET"
            },
            {
                "href": "/user/3",
                "rel": "edit",
                "method": "PUT"
            },
            {
                "href": "/user/3",
                "rel": "delete",
                "method": "DELETE"
            }
        ]
    },
    "links": {
       "href": "/user",
       "rel": "list",
       "method": "GET"
    }
} 
```

我们还知道我们可以更改现有数据：

**要求**

```
PUT /user/1
Accept: application/json+userdb
Content-Type: application/json+userdb

{
    "name": "Emil",
    "country": "Bhutan"
} 
```

**回复**

```
200 OK
Content-Type: application/json+userdb

{
    "user": {
        "id": 1,
        "name": "Emil",
        "country": "Bhutan",
        "links": [
            {
                "href": "/user/1",
                "rel": "self",
                "method": "GET"
            },
            {
                "href": "/user/1",
                "rel": "edit",
                "method": "PUT"
            },
            {
                "href": "/user/1",
                "rel": "delete",
                "method": "DELETE"
            }
        ]
    },
    "links": {
       "href": "/user",
       "rel": "list",
       "method": "GET"
    }
} 
```

请注意，我们使用不同的 HTTP 动词（`GET`、`PUT`、`POST`等`DELETE`）来操作这些资源，并且我们假设客户端的唯一知识是我们的媒体定义。

进一步阅读：

*   这一页上有许多更好的答案。
*   ~~[我是如何向我的妻子解释 REST 的](http://www.looah.com/source/view/2284)。~~
*   [我是如何向我的妻子解释 REST 的](http://web.archive.org/web/20130116005443/http://tomayko.com/writings/rest-to-my-wife)。
*   [马丁·福勒的想法](http://martinfowler.com/articles/richardsonMaturityModel.html)
*   [PayPal 的 API 具有超媒体控件](https://developer.paypal.com/docs/api/)

（这个答案因为没有抓住重点而受到相当多的批评。在大多数情况下，这是一个公平的批评。我最初描述的内容更符合几年前我通常如何实现 REST首先写这个，而不是它的真正含义。我已经修改了答案以更好地代表真正的含义。）

* * *

## 回答 #2

> 赞同：803
> 
> 时间：2015-04-15T11:26:17.950

一种称为[**REST（Representational State Transfer）**](https://en.wikipedia.org/wiki/Representational_state_transfer)**的架构风格**主张 Web 应用程序应该使用**最初设想**的 HTTP 。查找应该使用请求。[,](https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods) [, 和](https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)[requests](https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)应分别用于**突变**，**创建**和**删除**。[](https://en.wikipedia.org/wiki/Representational_state_transfer)****[`GET`](https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)[`PUT``POST``DELETE`](https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)****

 ******REST 支持者倾向于使用 URL，例如

```
http://myserver.com/catalog/item/1729 
```

但 REST 架构不需要这些“漂亮的 URL”。带参数的 GET 请求

```
http://myserver.com/catalog?item=1729 
```

一点也不像 RESTful。

请记住，永远不应使用 GET 请求来更新信息。例如，将商品添加到购物车的 GET 请求

```
http://myserver.com/addToCart?cart=314159&item=1729 
```

不合适。GET 请求应该是[幂等](https://en.wikipedia.org/wiki/Idempotence)的。也就是说，发出两次请求应该与发出一次没有什么不同。这就是使请求可缓存的原因。“添加到购物车”请求不是幂等的——发出两次会将商品的两个副本添加到购物车中。在这种情况下，POST 请求显然是合适的。因此，即使是**RESTful Web 应用程序**也需要它的 POST 请求份额。

这取自 David M. Geary 的优秀书籍*Core JavaServer faces* book。

* * *

## 回答 #3

> 赞同：545
> 
> 时间：2009-03-22T19:37:57.087

RESTful 编程是关于：

*   由持久标识符标识的资源：如今，URI 是无处不在的标识符选择
*   使用一组通用动词操作资源：HTTP 方法是常见的情况——古老的`Create`, `Retrieve`, `Update`,`Delete`变成`POST`, `GET`,`PUT`和`DELETE`. 但 REST 不限于 HTTP，它只是目前最常用的传输方式。
*   为资源检索的实际表示取决于请求而不是标识符：使用 Accept 标头来控制您是否需要 XML、HTTP 甚至是表示资源的 Java 对象
*   维护对象中的状态并在表示中表示状态
*   在资源的表示中表示资源之间的关系：对象之间的链接直接嵌入在表示中
*   资源表示描述了如何使用表示以及在什么情况下应该以一致的方式丢弃/重新获取它： HTTP Cache-Control 标头的使用

就 REST 的后果和整体有效性而言，最后一个可能是最重要的。总体而言，大多数 RESTful 讨论似乎都集中在 HTTP 及其在浏览器中的使用以及其他方面。我知道 R. Fielding 在描述导致 HTTP 的架构和决策时创造了这个术语。他的论文更多地是关于资源的架构和缓存能力，而不是关于 HTTP。

如果你真的对什么是 RESTful 架构以及它的工作原理感兴趣，请阅读[他的论文](http://www.ics.uci.edu/%7Efielding/pubs/dissertation/fielding_dissertation.pdf)几遍，并阅读**整个内容，**而不仅仅是第 5 章！接下来看看[DNS 工作的原因](https://www.rfc-editor.org/rfc/rfc1034)。阅读有关 DNS 的分层组织以及引荐的工作原理。然后阅读并考虑 DNS 缓存的工作原理。最后，阅读 HTTP 规范（特别是[RFC2616](https://www.rfc-editor.org/rfc/rfc2616)和[RFC3040](https://www.rfc-editor.org/rfc/rfc3040)）并考虑缓存如何以及为什么会以这种方式工作。最终，它只会点击。对我来说，最后的启示是当我看到 DNS 和 HTTP 之间的相似性时。在此之后，开始点击了解 SOA 和消息传递接口为何具有可扩展性。

我认为理解 RESTful 和[Shared Nothing](http://db.cs.berkeley.edu/papers/hpts85-nothing.pdf)架构的架构重要性和性能影响的最重要技巧是避免陷入技术和实现细节上。关注谁拥有资源，谁负责创建/维护资源等。然后考虑表示、协议和技术。

* * *

## 回答 #4

> 赞同：412
> 
> 时间：2009-07-04T05:47:13.313

这可能是它的样子。

创建具有三个属性的用户：

```
POST /user
fname=John&lname=Doe&age=25 
```

服务器响应：

```
200 OK
Location: /user/123 
```

将来，您可以检索用户信息：

```
GET /user/123 
```

服务器响应：

```
200 OK
<fname>John</fname><lname>Doe</lname><age>25</age> 
```

修改记录（`lname`并且`age`将保持不变）：

```
PATCH /user/123
fname=Johnny 
```

`lname`要更新记录（因此`age`将是 NULL）：

```
PUT /user/123
fname=Johnny 
```

* * *

## 回答 #5

> 赞同：183
> 
> 时间：2010-10-16T21:24:42.327

一本关于 REST 的好书是[REST in Practice](http://www.amazon.co.uk/REST-Practice-Hypermedia-Systems-Architecture/dp/0596805829)。

必须阅读的是具[象状态传输 (REST)](http://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm)，并且[REST API 必须是超文本驱动的](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)

有关什么是 RESTful 服务的解释，请参阅 Martin Fowlers 文章[Richardson 成熟度模型](http://martinfowler.com/articles/richardsonMaturityModel.html)(RMM)。

![理查森成熟度模型](https://i.stack.imgur.com/FoKRB.png)

要成为 RESTful 服务，需要[将超媒体作为应用程序状态的引擎。(HATEOAS)](http://en.wikipedia.org/wiki/HATEOAS)，也就是需要在RMM中达到3级，详细[阅读文章](http://martinfowler.com/articles/richardsonMaturityModel.html)或者[qcon talk中的slides](http://www.crummy.com/writing/speaking/2008-QCon/act3.html)。

> HATEOAS 约束是 Hypermedia as the Engine of Application State 的首字母缩写。此原则是 REST 与大多数其他形式的客户端服务器系统之间的关键区别。
> 
> ...
> 
> RESTful 应用程序的客户端只需要知道一个固定的 URL 即可访问它。所有未来的动作都应该可以从包含在从该 URL 返回的资源表示中的超媒体链接中动态发现。任何可能使用 RESTful API 的客户端也应该能够理解标准化的媒体类型。（维基百科，自由的百科全书）

[Web 框架的REST Litmus 测试是针对 Web 框架](http://www.innoq.com/blog/st/2010/07/rest_litmus_test_for_web_frame.html)的类似成熟度测试。

[接近纯 REST：学会爱上 HATEOAS](http://kinderman.net/2010/06/23/approaching-pure-rest-learning-to-love-hateoas)是一个很好的链接集合。

[公共云的 REST 与 SOAP](http://herbjorn.wordpress.com/2010/11/19/rest-versus-soap-for-the-public-cloud/)讨论了 REST 的当前使用水平。

[REST 和版本](https://docs.google.com/present/view?id=dd4bk538_182f55p5x3f&ndplr=1)控制通过可修改性讨论可扩展性、版本控制、可演化性等

* * *

## 回答 #6

> 赞同：138
> 
> 时间：2012-11-18T20:46:20.347

> **什么是 REST？**
> 
> REST 代表具象状态转移。（有时拼写为“ReST”。）它依赖于无状态、客户端-服务器、可缓存的通信协议——几乎在所有情况下都使用 HTTP 协议。
> 
> REST 是一种用于设计网络应用程序的架构风格。这个想法是，不是使用复杂的机制，如 CORBA、RPC 或 SOAP 来连接机器，而是使用简单的 HTTP 在机器之间进行调用。
> 
> 在许多方面，基于 HTTP 的万维网本身可以被视为基于 REST 的架构。RESTful 应用程序使用 HTTP 请求来发布数据（创建和/或更新）、读取数据（例如，进行查询）和删除数据。因此，REST 将 HTTP 用于所有四个 CRUD（创建/读取/更新/删除）操作。
> 
> REST 是 RPC（远程过程调用）和 Web 服务（SOAP、WSDL 等）等机制的轻量级替代方案。稍后，我们将看到 REST 是多么简单。
> 
> 尽管很简单，但 REST 功能齐全；在 Web 服务中，基本上没有什么是 RESTful 架构无法完成的。REST 不是“标准”。例如，永远不会有针对 REST 的 W3C 推荐。尽管有 REST 编程框架，但使用 REST 非常简单，您通常可以使用 Perl、Java 或 C# 等语言的标准库功能“自行开发”。

当我试图找到休息的简单真正含义时，我找到了最好的参考资料之一。

[http://rest.elkstein.org/](http://rest.elkstein.org/)

* * *

## 回答 #7

> 赞同：93
> 
> 时间：2009-03-22T15:20:09.483

REST 使用各种 HTTP 方法（主要是 GET/PUT/DELETE）来操作数据。

与其使用特定的 URL 来删除方法（例如`/user/123/delete`，`/user/[id]``/user/[id]`

例如，取而代之的是一组可能类似于以下内容的 URL。

```
GET /delete_user.x?id=123
GET /user/delete
GET /new_user.x
GET /user/new
GET /user?id=1
GET /user/id/1 
```

您使用 HTTP“动词”并拥有..

```
GET /user/2
DELETE /user/2
PUT /user 
```

* * *

## 回答 #8

> 赞同：70
> 
> 时间：2009-03-22T14:53:56.787

这是一种编程，您的系统架构符合Roy Fielding 在[他的论文中提出的](http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm)[REST 风格](http://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm)。由于这是描述网络的架构风格（或多或少），所以很多人都对它感兴趣。

奖励答案：不。除非您正在研究软件架构作为学术或设计 Web 服务，否则真的没有理由听说过这个术语。

* * *

## 回答 #9

> 赞同：49
> 
> 时间：2013-07-12T16:33:02.030

我会说 RESTful 编程是关于创建遵循 REST 架构风格的系统 (API)。

我发现 M. Elkstein 博士撰写的关于 REST 的精彩、简短且易于理解的教程，并引用了大部分可以回答您的问题的基本部分：

[学习 REST：教程](http://rest.elkstein.org/)

> REST 是一种用于设计网络应用程序的*架构风格。*这个想法是，不是使用复杂的机制，如 CORBA、RPC 或 SOAP 来连接机器，而是使用简单的 HTTP 在机器之间进行调用。
> 
> *   在许多方面，基于 HTTP 的万维网本身可以被视为基于 REST 的架构。
> 
> RESTful 应用程序使用 HTTP 请求来发布数据（创建和/或更新）、读取数据（例如，进行查询）和删除数据。因此，REST 将 HTTP 用于所有四个 CRUD（创建/读取/更新/删除）操作。

我认为您不应该因为在 Stack Overflow 之外没有听说过 REST 而感到愚蠢……，我也会遇到同样的情况！回答关于[为什么 REST 现在变得越来越大的](https://stackoverflow.com/q/243388/463478)另一个 SO 问题可以缓解一些感受。

* * *

## 回答 #10

> 赞同：46
> 
> 时间：2009-03-23T17:11:58.083

如果我没有直接回答这个问题，我深表歉意，但是通过更详细的示例更容易理解所有这些。由于所有的抽象和术语，Fielding 并不容易理解。

这里有一个相当好的例子：

[解释 REST 和超文本：垃圾邮件清理机器人 Spam-E](http://www.ldodds.com/blog/archives/000337.html)

更好的是，这里有一个简单的例子的清晰解释（powerpoint 更全面，但你可以在 html 版本中获得大部分内容）：

[http://www.xfront.com/REST.ppt](http://www.xfront.com/REST.ppt)或[http://www.xfront.com/REST.html](http://www.xfront.com/REST.html)

阅读示例后，我可以理解为什么 Ken 说 REST 是超文本驱动的。不过，我实际上不确定他是否正确，因为 /user/123 是一个指向资源的 URI，而且我不清楚它是否是非 RESTful 只是因为客户端“带外”知道它。

该 xfront 文档解释了 REST 和 SOAP 之间的区别，这也很有帮助。当菲尔丁说“[那是 RPC。它尖叫 RPC。](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven) ”时，很明显 RPC 不是 RESTful，因此了解其确切原因很有用。（SOAP 是一种 RPC。）

* * *

## 回答 #11

> 赞同：38
> 
> 时间：2013-07-25T09:05:19.827

什么是 REST？

REST 用官方的话说，REST 是一种架构风格，建立在某些原则之上，使用当前的“Web”基础。有 5 个 Web 基本原理可用于创建 REST 服务。

*   原则 1：一切都是资源 在 REST 架构风格中，数据和功能被视为资源，并使用统一资源标识符 (URI) 访问，通常是 Web 上的链接。
*   原则 2：每个资源都由唯一标识符 (URI) 标识
*   原则 3：使用简单统一的接口
*   原则 4：沟通由代表完成
*   原则 5：无国籍

* * *

## 回答 #12

> 赞同：33
> 
> 时间：2009-03-22T16:36:31.517

我看到一堆答案说将有关用户 123 的所有内容放在资源“/user/123”中是 RESTful。

创造这个术语的 Roy Fielding 说[REST API 必须是超文本驱动的](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)。特别是，“REST API 不得定义固定的资源名称或层次结构”。

因此，如果您的“/user/123”路径在客户端上是硬编码的，那么它并不是真正的 RESTful。很好地使用 HTTP，也许，也许不是。但不是 RESTful。它必须来自超文本。

* * *

## 回答 #13

> 赞同：28
> 
> 时间：2013-11-22T22:49:13.677

答案很简单，Roy Fielding 写了[一篇论文。]](http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm) [1](http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm)在该论文中，他定义了 REST 原则。如果一个应用程序满足所有这些原则，那么这就是一个 REST 应用程序。

[创建术语 RESTful 是因为人们通过将非 REST 应用程序称为 REST 来用尽 REST 这个词。](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)在那之后，RESTful 一词也用尽了。[现在我们谈论的是 Web API 和超媒体 API](http://www.markus-lanthaler.com/research/third-generation-web-apis-bridging-the-gap-between-rest-and-linked-data.pdf)，因为大多数所谓的 REST 应用程序都没有满足统一接口约束的 HATEOAS 部分。

REST 约束如下：

1.  客户端-服务器架构

    因此它不适用于例如 PUB/SUB 套接字，它基于 REQ/REP。

2.  无状态通信

    所以服务器不维护客户端的状态。这意味着您不能使用服务器端会话存储，并且您必须对每个请求进行身份验证。您的客户端可能通过加密连接发送基本身份验证标头。（对于大型应用程序，很难维护许多会话。）

3.  如果可以的话，使用缓存

    因此，您不必一次又一次地处理相同的请求。

4.  统一接口作为客户端和服务器之间的通用合同

    客户端和服务器之间的合同不由服务器维护。换句话说，客户端必须与服务的实现分离。您可以通过使用标准解决方案达到此状态，例如识别资源的 IRI (URI) 标准、交换消息的 HTTP 标准、描述正文序列化格式的标准 MIME 类型、元数据（可能是 RDF 词汇、微格式等）描述消息体不同部分的语义。要将 IRI 结构与客户端分离，您必须以超媒体格式（如 HTML、JSON-LD、HAL 等）向客户端发送超链接。因此，客户端可以使用分配给超链接的元数据（可能是链接关系，RDF 词汇）通过适当的状态转换来导航应用程序的状态机，以实现其当前目标。

    例如，当客户想要向网上商店发送订单时，它必须检查网上商店发送的响应中的超链接。通过检查链接，它找到了一个用[http://schema.org/OrderAction](http://schema.org/OrderAction)描述的链接。客户端知道 schema.org 词汇，因此它知道通过激活此超链接将发送订单。因此它会激活超链接并发送`POST https://example.com/api/v1/order`带有正确正文的消息。之后，服务处理消息并以具有正确 HTTP 状态标头的结果进行响应，例如`201 - created`成功。要使用详细元数据注释消息，使用 RDF 格式的标准解决方案，例如带有 REST 词汇的[JSON-LD](http://json-ld.org/)，例如[Hydra](http://www.markus-lanthaler.com/hydra/)和特定于域的词汇，例如[schema.org](http://schema.org/)或任何其他[链接数据词汇](http://lov.okfn.org/dataset/lov/)，如果需要，可能还有自定义应用程序特定词汇。现在这并不容易，这就是为什么大多数人使用 HAL 和其他简单格式，这些格式通常只提供 REST 词汇，但不支持链接数据。

5.  构建分层系统以提高可扩展性

    REST 系统由分层组成。每一层都包含使用下一层组件服务的组件。因此，您可以毫不费力地添加新层和组件。

    例如，有一个包含客户端的客户端层，下面是一个包含单个服务的服务层。现在您可以在它们之间添加客户端缓存。之后，您可以添加另一个服务实例和负载均衡器，等等......客户端代码和服务代码不会改变。

6.  按需编码以扩展客户端功能

    此约束是可选的。例如，您可以将特定媒体类型的解析器发送到客户端，等等...为了做到这一点，您可能需要客户端中的标准插件加载器系统，或者您的客户端将耦合到插件加载器解决方案.

REST 约束导致了一个高度可扩展的系统，其中客户端与服务的实现分离。所以客户端可以重复使用，就像网络上的浏览器一样。客户端和服务共享相同的标准和词汇，因此尽管客户端不知道服务的实现细节，但它们可以相互理解。这使得创建可以找到并利用 REST 服务来实现其目标的自动化客户端成为可能。从长远来看，这些客户端可以相互交流并在任务中相互信任，就像人类一样。如果我们向此类客户端添加学习模式，那么结果将是一个或多个 AI 使用机器网络而不是单个服务器园区。所以最后伯纳斯·李的梦想：语义网和人工智能将成为现实。所以在 2030 年，我们最终会被天网终结。直到那时 ... ;-）

* * *

## 回答 #14

> 赞同：23
> 
> 时间：2014-06-15T19:02:17.153

[RESTful (Representational state transfer) API 编程是按照以下 5 个基本的软件](http://en.wikipedia.org/wiki/Representational_state_transfer)[架构风格](http://en.wikipedia.org/wiki/Architectural_style)原则以任何编程语言编写 Web 应用程序：

1.  资源（数据、信息）。
2.  [唯一的全局标识符](http://en.wikipedia.org/wiki/Globally_unique_identifier)（所有资源都由[URI](http://en.wikipedia.org/wiki/Uniform_resource_identifier)唯一标识）。
3.  [统一接口](http://en.wikipedia.org/wiki/Representational_state_transfer#Uniform_interface)- 使用简单和标准的接口 (HTTP)。
4.  表示 - 所有通信都是通过表示完成的（例如[XML](http://en.wikipedia.org/wiki/XML) / [JSON](http://en.wikipedia.org/wiki/JSON)）
5.  [无状态](http://en.wikipedia.org/wiki/Stateless_protocol)（每个请求完全隔离发生，更容易缓存和负载平衡），

换句话说，您正在通过 HTTP 编写简单的点对点网络应用程序，该应用程序通过实现 RESTful 架构来使用诸如 GET、POST、PUT 或 DELETE 之类的动词，该架构建议对每个“资源”公开的接口进行标准化。以简单有效的方式使用 Web 的当前功能（非常成功、经过验证的分布式架构），这不算什么。[它是SOAP](http://en.wikipedia.org/wiki/SOAP)、[CORBA](http://en.wikipedia.org/wiki/Common_Object_Request_Broker_Architecture)和[RPC](http://en.wikipedia.org/wiki/Remote_procedure_call)等更复杂机制的替代方案。

RESTful 编程符合 Web 架构设计，如果实施得当，它可以让您充分利用可扩展的 Web 基础架构。

* * *

## 回答 #15

> 赞同：21
> 
> 时间：2017-03-31T03:12:53.680

这是我对 REST 的基本概述。我试图展示 RESTful 架构中每个组件背后的思想，以便更直观地理解这个概念。希望这有助于为某些人揭开 REST 的神秘面纱！

REST (Representational State Transfer) 是一种设计架构，它概述了如何设计和处理网络资源（即共享信息的节点）。一般来说，RESTful 架构使得客户端（请求机器）和服务器（响应机器）可以请求读取、写入和更新数据，而客户端不必知道服务器如何操作并且服务器可以通过它返回而无需了解有关客户端的任何信息。好的，很酷......但是我们如何在实践中做到这一点？

*   最明显的要求是需要某种通用语言，以便服务器可以告诉客户端它试图对请求做什么并让服务器响应。

*   但是要找到任何给定的资源，然后告诉客户端该资源所在的位置，就需要有一种通用的方式来指向资源。这就是通用资源标识符 (URI) 的用武之地；它们基本上是查找资源的唯一地址。

但是 REST 架构并没有就此结束！虽然以上满足了我们想要的基本需求，但我们还希望有一个支持大流量的架构，因为任何给定的服务器通常处理来自多个客户端的响应。因此，我们不想让服务器记住有关先前请求的信息，从而使服务器不堪重负。

*   因此，我们强加了客户端和服务器之间的每个请求-响应对是独立的限制，这意味着服务器不必记住有关先前请求（客户端-服务器交互的先前状态）的任何信息来响应新的请求。要求。这意味着我们希望我们的交互是无状态的。

*   为了进一步减轻我们的服务器因重做最近已经为给定客户端完成的计算而造成的压力，REST 还允许缓存。基本上，缓存意味着对提供给客户端的初始响应进行快照。如果客户端再次发出相同的请求，服务器可以向客户端提供快照，而不是重做创建初始响应所需的所有计算。然而，由于它是一个快照，如果快照没有过期——服务器提前设置了一个过期时间——并且响应自初始缓存以来已经更新（即请求将给出与缓存响应不同的答案） ，客户端将不会看到更新，直到缓存过期（或缓存被清除）并且再次从头开始呈现响应。

*   关于 RESTful 架构，您在这里经常会遇到的最后一件事是它们是分层的。实际上，在讨论客户端和服务器之间的交互时，我们已经隐含地讨论了这个要求。基本上，这意味着我们系统中的每一层仅与相邻层交互。所以在我们的讨论中，客户端层与我们的服务器层交互（反之亦然），但可能还有其他服务器层帮助主服务器处理客户端不直接与之通信的请求。相反，服务器会根据需要传递请求。

现在，如果这一切听起来很熟悉，那就太好了。通过万维网定义通信协议的超文本传输​​协议 (HTTP) 是 RESTful 架构的抽象概念的实现（或者，如果您像我一样是 OOP 狂热者，则可以实现抽象 REST 类）。在这种 REST 实现中，客户端和服务器通过 GET、POST、PUT、DELETE 等进行交互，这些都是通用语言的一部分，并且可以使用 URL 来指向资源。

* * *

## 回答 #16

> 赞同：18
> 
> 时间：2012-02-01T17:23:09.747

如果我不得不将关于 REST 的原始论文缩减为 3 个简短的句子，我认为以下内容抓住了它的精髓：

1.  通过 URL 请求资源。
2.  协议仅限于您可以使用 URL 进行通信的内容。
3.  元数据作为名称-值对（发布数据和查询字符串参数）传递。

在那之后，很容易陷入关于改编、编码约定和最佳实践的争论。

有趣的是，论文中没有提到 HTTP POST、GET、DELETE 或 PUT 操作。那一定是某人后来对“统一界面”的“最佳实践”的解释。

当谈到 Web 服务时，我们似乎需要某种方法来区分基于 WSDL 和 SOAP 的架构，这会增加相当大的开销，并且可能会给接口带来不必要的复杂性。它们还需要额外的框架和开发工具才能实现。我不确定 REST 是否是区分常识接口和过度设计的接口（如 WSDL 和 SOAP）的最佳术语。但我们需要一些东西。

* * *

## 回答 #17

> 赞同：17
> 
> 时间：2012-02-01T21:20:21.110

REST 是一种架构模式和编写分布式应用程序的风格。它不是狭义的编程风格。

说您使用 REST 风格类似于说您以特定风格建造房屋：例如 Tudor 或 Victorian。作为软件风格的 REST 和作为家庭风格的 Tudor 或 Victorian 都可以通过构成它们的质量和约束来定义。例如，REST 必须具有客户端服务器分离，其中消息是自描述的。都铎式风格的房屋有重叠的山墙和屋顶，这些屋顶陡峭地倾斜着面向前的山墙。您可以阅读 Roy 的论文，以了解有关构成 REST 的约束和质量的更多信息。

与家庭风格不同，REST 一直很难得到一致和实际应用。这可能是故意的。将其实际实现留给设计者。因此，只要您满足您正在创建 REST 系统的论文中规定的约束，您就可以自由地做您想做的事情。

奖金：

整个 Web 都是基于 REST（或者 REST 是基于 Web）。因此，作为一名 Web 开发人员，您可能希望了解这一点，尽管没有必要编写好的 Web 应用程序。

* * *

## 回答 #18

> 赞同：16
> 
> 时间：2014-07-03T17:30:38.460

我认为 restful 的重点是将**有状态分离到更高层**，同时利用互联网（协议）作为**无状态传输层**。大多数其他方法都混淆了。

它是应对互联网时代编程根本变化的最佳实用方法。关于根本变化，Erik Meijer 在此处进行了讨论：http: [//www.infoq.com/interviews/erik-meijer-programming-language-design-effects-purity#view_93197](http://www.infoq.com/interviews/erik-meijer-programming-language-design-effects-purity#view_93197)。他将其概括为五种效果，并通过将解决方案设计成编程语言来提出解决方案。该解决方案也可以在平台或系统级别实现，而与语言无关。restful 可以看作是目前实践中非常成功的解决方案之一。

使用 restful 风格，您可以在不可靠的互联网上获取和操作应用程序的状态。如果当前操作未能获得正确的当前状态，则需要零验证主体来帮助应用程序继续。如果它无法操纵状态，它通常会使用多个确认阶段来保持正确。从这个意义上说，rest 本身并不是一个完整的解决方案，它需要 web 应用程序堆栈的其他部分的功能来支持它的工作。

鉴于这种观点，其余风格并不真正与互联网或 Web 应用程序相关联。它是许多编程情况的基本解决方案。它也不简单，它只是让界面变得非常简单，并且可以很好地应对其他技术。

只是我的2c。

编辑：两个更重要的方面：

*   **无国籍**具有误导性。它是关于 RESTful API，而不是应用程序或系统。系统需要有状态。Restful 设计是关于基于无状态 API 设计有状态系统。来自另一个 QA 的一些[报价](http://programmers.stackexchange.com/questions/120716/difference-between-rest-and-crud)：

    *   REST 对资源表示进行操作，每个表示由 URL 标识。这些通常不是数据对象，而是**复杂的对象抽象**。
    *   REST 代表“代表性状态转移”，这意味着它完全是关于通信和修改系统中某些资源**的状态**。
*   **幂等**性：[REST 中一个经常被忽视的部分是大多数动词的幂等性。这导致了**健壮的系统和更少**的语义精确解释的](http://programmers.stackexchange.com/questions/23386/pros-and-cons-of-restful-architecture)相互依赖性。

* * *

## 回答 #19

> 赞同：15
> 
> 时间：2016-11-30T20:05:16.560

老问题，新的回答方式。关于这个概念有很多误解。我总是试图记住：

1.  结构化 URL 和 Http 方法/动词不是 restful 编程的定义。
2.  JSON 不是宁静的编程
3.  RESTful 编程不适用于 API

我将宁静的编程定义为

> 如果应用程序以客户端理解的媒体类型提供资源（数据+状态转换控件的组合），则应用程序是宁静的

要成为一个安静的程序员，您必须尝试构建允许参与者做事的应用程序。不仅仅是暴露数据库。

只有当客户端和服务器就资源的媒体类型表示达成一致时，状态转换控制才有意义。否则就无法知道什么是控件，什么不是以及如何执行控件。IE 如果浏览器不知道`<form>`html 中的标签，那么您将没有任何东西可以提交到浏览器中的过渡状态。

我不想自我推销，但我在我的演讲[http://techblog.bodybuilding.com/2016/01/video-what-is-restful-200.html](http://techblog.bodybuilding.com/2016/01/video-what-is-restful-200.html)中将这些想法扩展得非常深入。

我演讲的摘录是关于经常提到的理查森成熟度模型，我不相信这些级别，你要么是 RESTful（3 级），要么不是，但我想强调的是每个级别在通往 RESTful 的道路上为您服务

[![注释理查森成熟度模型](https://i.stack.imgur.com/YYS7O.png)](https://i.stack.imgur.com/YYS7O.png)

* * *

## 回答 #20

> 赞同：15
> 
> 时间：2017-10-02T21:23:50.023

REST 定义了 6 个架构约束，这些约束使任何 Web 服务成为**真正的 RESTful API**。

1.  统一的界面
2.  客户端服务器
3.  无状态
4.  可缓存
5.  分层系统
6.  按需编码（可选）

[https://restfulapi.net/rest-architectural-constraints/](https://restfulapi.net/rest-architectural-constraints/)

* * *

## 回答 #21

> 赞同：14
> 
> 时间：2017-01-13T14:02:03.017

这是非常长的“讨论”，但至少可以说相当混乱。

海事组织：

1) 没有安静的编程，没有大联合和大量啤酒 :)

2) Representational State Transfer (REST) 是**[Roy Fielding 的论文中](https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm)****规定的一种架构风格。它有许多限制条件。如果您的服务/客户尊重这些，那么它就是 RESTful。**就是这个。

您可以将约束（显着）总结为：

*   无状态通信
*   尊重 HTTP 规范（如果使用 HTTP）
*   清楚地传达传输的内容格式
*   使用超媒体作为应用程序状态的引擎

**还有另一个[很好的帖子](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)很好地解释了事情。**

很多答案复制/粘贴了有效信息，混合了它并增加了一些混乱。人们在这里谈论级别，关于 RESTFul URI（没有这样的东西！），应用 HTTP 方法 GET、POST、PUT ...... REST 不是关于那个或不仅仅是那个。

例如链接 - 拥有漂亮的 API 很好，但最终客户端/服务器并不真正关心您获取/发送的链接，重要的是内容。

最后**，只要内容格式已知，任何 RESTful 客户端都应该能够使用任何 RESTful 服务。**

* * *

## 回答 #22

> 赞同：12
> 
> 时间：2016-06-03T11:35:49.920

REST === HTTP 类比是不正确的，除非您不强调它“必须”由[HATEOAS](http://restfulapi.net/hateoas/)驱动。

罗伊自己在[这里](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)清除了它。

除了初始 URI（书签）和适合目标受众（即，任何可能使用 API 的客户端都可以理解）的标准化媒体类型集之外，应该在没有任何先验知识的情况下输入 REST API。从那时起，所有应用程序状态转换必须由客户端选择服务器提供的选项来驱动，这些选项出现在接收到的表示中或用户对这些表示的操作暗示。转换可以由客户端对媒体类型和资源通信机制的了解来确定（或限制），这两者都可以在运行中（例如，按需编码）得到改进。

[这里的失败意味着带外信息正在推动交互而不是超文本。]

* * *

## 回答 #23

> 赞同：12
> 
> 时间：2017-09-15T19:47:04.400

> **REST**是一种基于 Web 标准和 HTTP 协议（​​2000 年引入）的架构风格。

在基于 REST 的架构中，一切都是资源（用户、订单、评论）。通过基于 HTTP 标准方法（GET、PUT、PATCH、DELETE 等）的通用接口访问资源。

> 在基于 REST 的架构中，您有一个 REST 服务器，它提供对资源的访问。REST 客户端可以访问和修改 REST 资源。

每个资源都应该支持 HTTP 常用操作。资源由全局 ID（通常是 URI）标识。

REST 允许资源具有不同的表示形式，例如文本、XML、JSON 等。REST 客户端可以通过 HTTP 协议（​​内容协商）请求特定的表示形式。

**HTTP 方法：**

PUT、GET、POST 和 DELETE 方法通常用于基于 REST 的架构中。下表给出了这些操作的说明。

*   GET 定义了对资源的读取访问权限，没有副作用。资源永远不会通过 GET 请求更改，例如，请求没有副作用（幂等）。
*   PUT 创建一个新资源。它也必须是幂等的。
*   DELETE 删除资源。操作是幂等的。它们可以重复而不会导致不同的结果。
*   POST 更新现有资源或创建新资源。

* * *

## 回答 #24

> 赞同：10
> 
> 时间：2014-11-10T13:37:27.487

**REST**代表**Representational state transfer**。

它依赖于无状态、客户端-服务器、可缓存的通信协议——几乎在所有情况下都使用 HTTP 协议。

REST 通常用于移动应用程序、社交网络网站、混搭工具和自动化业务流程。REST 风格强调通过有限数量的操作（动词）来增强客户端和服务之间的交互。通过为资源（名词）分配它们自己独特的通用资源指示符（URI）来提供灵活性。

[休息介绍](http://www.queryhome.com//65309/small-introduction-about-rest-api)

* * *

## 回答 #25

> 赞同：10
> 
> 时间：2014-12-06T06:54:24.233

*谈话*不仅仅是简单地*交换信息*。协议实际上被设计为不必发生对话。每一方都知道他们的特定工作是什么，因为它在协议中有所规定。协议允许纯粹的信息交换，代价是对可能的操作进行任何更改。另一方面，谈话允许一方询问另一方可以采取哪些进一步的行动。他们甚至可以两次问同一个问题并得到两个不同的答案，因为对方的状态可能在此期间发生了变化。**讲的是 RESTful 架构**。菲尔丁的论文详细说明了如果一个人想要让机器相互*交流*而不是简单地相互交流就必须遵循的体系结构*沟通*。

* * *

## 回答 #26

> 赞同：10
> 
> 时间：2016-08-24T17:57:29.140

本身不存在“RESTful 编程”这样的概念。最好称为 RESTful 范式，甚至更好的 RESTful 架构。它不是一种编程语言。这是一个范式。

[来自维基百科](https://en.wikipedia.org/wiki/Representational_state_transfer)：

> 在计算中，代表性状态转移 (REST) 是一种用于 Web 开发的架构风格。

* * *

## 回答 #27

> 赞同：9
> 
> 时间：2012-02-01T23:52:15.933

剩下的一点是，如果我们同意对基本操作（http 动词）使用通用语言，则可以配置基础设施以理解它们并适当优化它们，例如，通过使用缓存标头来实现缓存水平。

通过正确实施的 RESTful GET 操作，信息来自服务器的数据库、服务器的内存缓存、CDN、代理的缓存、浏览器的缓存还是浏览器的本地存储都无关紧要。可以使用禁食的、最容易获得的最新源。

说 Rest 只是从使用带有 action 参数的 GET 请求到使用可用的 http 动词的句法变化，这使它看起来没有任何好处，纯粹是装饰性的。关键是使用一种可以被链的每个部分理解和优化的语言。如果你的 GET 操作有副作用，你必须跳过所有的 HTTP 缓存，否则你会得到不一致的结果。

* * *

## 回答 #28

> 赞同：9
> 
> 时间：2020-05-21T11:09:17.257

这个答案是为绝对初学者准备的，让我们了解一下当今最常用的 API 架构。

了解 Restful 编程或 Restful API。首先，您必须了解 API 是什么，在非常高级的 API 上代表应用程序编程接口，它基本上是一个软件，可以被另一个软件使用，以允许应用程序相互通信。

全球使用最广泛的 API 类型是 Web API，而应用程序在收到请求时向客户端发送数据。

[![在此处输入图像描述](https://i.stack.imgur.com/w9Dz3.png)](https://i.stack.imgur.com/w9Dz3.png)

事实上，API 不仅用于发送数据，而且并不总是与 Web 开发或 javascript 或 python 或任何编程语言或框架相关。

只要软件相对独立，API 中的应用程序实际上可以有很多不同的含义。以文件系统或 HTTP 模块为例，我们可以说它们是小软件，我们可以使用它们，我们可以使用它们的 API 与它们进行交互。例如，当我们对任何编程语言的文件系统模块使用读取文件功能时，我们实际上是在使用 file_system_reading API。或者当我们在浏览器中进行 DOM 操作时，我们并没有真正使用 JavaScript 语言本身，而是浏览器向我们公开的 DOM API，因此我们可以访问它。或者甚至另一个例子，假设我们用任何编程语言（如 Java）创建一个类，然后向它添加一些公共方法或属性，然后，这些方法将成为从该类创建的每个对象的 API，因为我们为其他软件提供了与我们的初始软件（在本例中为对象）交互的可能性。S0，API 实际上比仅仅构建 Web API 具有更广泛的含义。

**现在让我们看一下构建 API 的 REST 架构。**

**代表 Representational State Transfer 的REST**基本上是一种以逻辑方式构建 Web API 的方式，使它们易于为我们自己或他人使用。

要按照 REST 架构构建 Restful API，我们只需要遵循几个原则。1.我们需要将我们的API分离成逻辑资源。2\. 然后应该使用基于资源的 URL 公开这些资源。3\. 要对数据执行不同的操作，例如读取、创建或删除数据，API 应该使用正确的 HTTP 方法而不是 URL。4\. 现在我们实际发送回客户端或从客户端接收到的数据通常应该使用 JSON 数据格式，是一些适用于它的格式标准。5\. 最后，EST API 的另一个重要原则是它们必须是无状态的。

[![在此处输入图像描述](https://i.stack.imgur.com/vZGhB.png)](https://i.stack.imgur.com/vZGhB.png)

**将 API 划分为逻辑资源：** REST 中信息的关键抽象是资源，因此我们希望在 API 中共享的所有数据都应该划分为逻辑资源。究竟什么是资源？好吧，在 REST 的上下文中，它是一个对象或具有相关数据的事物的表示。例如，像导游、用户、地点或评论这样的应用程序就是逻辑资源的例子。所以基本上任何可以命名的信息都可以是资源。不过，只需要命名，而不是动词。 [![在此处输入图像描述](https://i.stack.imgur.com/yuEng.png)](https://i.stack.imgur.com/yuEng.png)

**公开结构：**现在我们需要公开，这意味着使用一些结构化的 URL 使数据可用，客户端可以向其发送请求。例如，像这样的整个地址称为 URL。并且 this / addNewTour 被称为 API Endpoint。 [![在此处输入图像描述](https://i.stack.imgur.com/6pt7j.png)](https://i.stack.imgur.com/6pt7j.png)

我们的 API 将有许多不同的端点，如下所示

```
https://www.tourguide.com/addNewTour
https://www.tourguide.com/getTour
https://www.tourguide.com/updateTour
https://www.tourguide.com/deleteTour
https://www.tourguide.com/getRoursByUser
https://www.tourguide.com/deleteToursByUser 
```

这些 API 中的每一个都会将不同的数据发送回客户端，同时执行不同的操作。现在这些端点有**一些非常错误**的地方，因为它们确实不遵循第三条规则，即我们应该只使用 HTTP 方法来对数据执行操作。所以端点应该只包含我们的资源，而不是我们对它们执行的操作，因为它们很快就会成为维护的噩梦。

我们应该如何在实践中使用这些 HTTP 方法？好吧，让我们看看这些端点实际上应该如何以 /getTour 开头。所以这个 getTour 端点是为了获取关于一个旅游的数据，所以我们应该简单地将端点命名为 /tours 并在向这个端点发出获取请求时发送数据。所以换句话说，当客户端使用 GET HTTP 方法访问端点时， [![在此处输入图像描述](https://i.stack.imgur.com/sLq20.png)](https://i.stack.imgur.com/sLq20.png)

（我们在端点或 URL 中只有资源，没有动词，因为动词现在在 HTTP 方法中，对吧？通常的做法是始终使用复数形式的资源名称，这就是我写 /tours 或 /tour 的原因。 ) 约定是调用端点 /tours 时将返回数据库中的所有旅游，但如果我们只想要一个 ID 的旅游，比如说七个，我们在另一个斜杠之后添加七个 (/tours/7)或在搜索查询 (/tours?id=7) 中，当然，它也可以是旅游的名称而不是 ID。

HTTP 方法：这里真正重要的是端点名称如何与所有人的名称完全相同。

```
GET: (for requesting data from the server.)

https://www.tourguide.com/tours/7
POST: (for sending data to the server.)
https://www.tourguide.com/tours
PUT/PATCH: (for updating requests for data to the server.) https://www.tourguide.com/tours/7
DELETE: (for deleting request for data to the server.)
https://www.tourguide.com/tours/7 
```

PUT 和 PATCH 之间的区别-> 通过使用 PUT，客户端应该发送整个更新的对象，而使用 PATCH，它应该只发送已更改的对象部分。

通过使用 HTTP 方法，用户可以执行四种基本的 CRUD 操作，CRUD 代表 Create、Read、Update 和 Delete。

现在可能会出现如下情况：

[![在此处输入图像描述](https://i.stack.imgur.com/uNw9P.png)](https://i.stack.imgur.com/uNw9P.png)

因此，/getToursByUser 可以简单地转换为 /users/tours，因为用户号 3 的端点将类似于 /users/3/tours。

如果我们要删除特定用户的特定游览，则 URL 应类似于 /users/3/tours/7，此处用户 ID：3 和游览 ID：7。

所以真的有很多这样的组合资源的可能性。

**以 JSON 格式发送数据：**现在关于客户端实际接收的数据，或者服务器从客户端接收的数据，通常我们使用 JSON 数据格式。一个典型的 JSON 可能如下所示： [![在此处输入图像描述](https://i.stack.imgur.com/XOzTh.png)](https://i.stack.imgur.com/XOzTh.png) 在发送 JSON 数据之前，我们通常会进行一些简单的响应格式化，对此有几个标准，但其中一个非常简单的称为 Jsend。我们只需创建一个新对象，然后向其添加状态消息，以通知客户端请求是成功、失败还是错误。然后我们将原始数据放入一个名为 Data 的新对象中。

[![在此处输入图像描述](https://i.stack.imgur.com/FeuPv.png)](https://i.stack.imgur.com/FeuPv.png)

像我们在这里所做的那样将数据包装到一个额外的对象中称为 Enveloping，这是一种减轻一些安全问题和其他问题的常见做法。

**Restful API 应该始终是无状态的：**最后，RESTful API 应该始终是无状态的，这意味着在无状态的 RESTful API 中，所有状态都在客户端而不是服务器上处理。状态只是指应用程序中可能随时间变化的一段数据。例如，某个用户是否登录或在具有多个页面的列表的页面上当前页面是什么？现在，应该在客户端处理状态这一事实意味着每个请求都必须包含在服务器上处理某个请求所需的所有信息。因此，服务器永远不必为了处理当前请求而记住先前的请求。

[![在此处输入图像描述](https://i.stack.imgur.com/n4SJJ.png)](https://i.stack.imgur.com/n4SJJ.png)

假设目前我们在第五页，我们想前进到第六页。所以我们可以有一个名为 /tours/nextPage 的简单端点并向服务器提交请求，但是服务器必须确定当前页面是什么，并基于该服务器将下一页发送到客户端。换句话说，服务器必须记住之前的请求。这正是我们希望在 RESTful API 中避免的。

除了这种情况，我们应该创建一个 /tours/page 端点并将数字 6 粘贴到它以请求第 6 页 /tours/page/6 。所以服务器不需要记住任何内容，它所要做的就是按照我们的要求发回第 6 页的数据。

无状态和相反的状态是计算机科学和一般应用中非常重要的概念

* * *

## 回答 #29

> 赞同：5
> 
> 时间：2017-08-29T11:55:15.093

这一点在所有地方都很少提及，但**Richardson 的成熟度模型**是实际判断 Restful 是一个 API 的最佳方法之一。更多关于它的信息：

[理查森的成熟度模型](https://martinfowler.com/articles/richardsonMaturityModel.html)

* * *

## 回答 #30

> 赞同：4
> 
> 时间：2016-08-01T06:42:41.447

**什么是[API 测试](http://testingalert.com/api-testing/api-manual/)？**

API 测试利用编程向 API 发送调用并获得收益。它测试将被测段视为黑匣子。API 测试的目的是确认在将其协调到应用程序之前的部分的正确执行和错误处理。

**REST API**

REST：具象状态转移。

*   这是测试人员执行请求和接收响应的功能安排。在 REST API 中，交互是通过 HTTP 协议进行的。
*   REST 还允许计算机之间通过网络进行通信。
*   对于发送和接收消息，它涉及使用 HTTP 方法，并且不像 Web 服务那样需要严格的消息定义。
*   REST 消息通常接受 XML 或 JavaScript Object Notation (JSON) 形式的形式。

**4 种常用 API 方法：-**

1.  GET: – 它提供对资源的只读访问。
2.  POST：——用于创建或更新新资源。
3.  PUT： – 用于更新或替换现有资源或创建新资源。
4.  DELETE： – 用于删除资源。

**手动测试 API 的步骤：-**

要手动使用 API，我们可以使用基于浏览器的 REST API 插件。

1.  安装 POSTMAN(Chrome) / REST(Firefox) 插件
2.  输入 API 网址
3.  选择 REST 方法
4.  选择内容-标题
5.  输入请求 JSON (POST)
6.  点击发送
7.  它将返回输出响应

[自动化 REST API 的步骤](http://testingalert.com/api-testing/api-automation/)

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2019-03-27T10:11:45.960

我想说理解 REST 的一个重要组成部分在于端点或映射，例如`/customers/{id}/balance`.

您可以将这样的端点想象为从网站（前端）到数据库/服务器（后端）的连接管道。使用它们，前端可以执行在应用程序中任何 REST 映射的相应方法中定义的后端操作。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2018-12-01T12:54:01.757

编辑

阅读此处的 README，我希望您能真正获得 REST。

[https://github.com/lukepuplett/surfdude-csharp/blob/master/README.md](https://github.com/lukepuplett/surfdude-csharp/blob/master/README.md)

--

那些给出链接资源示例的答案很棒，但只是图片的一半。

因此，假设您正在设计一个网站。你写一个故事，

*我希望能够通过邮政编码搜索地址，以便我可以选择送货地址*

然后，您将构建网站以引导用户踏上这段旅程，并尝试在工作流程中将页面链接在一起。

将他们带到地址查找然后让他们将地址复制到剪贴板然后返回到送货地址表单的网站设计不会很有用。

REST API 使用我们在 Web 上认为理所当然的模式进行机器与机器交互。

即使每个地址都链接到完整地址和一些编辑链接，也不应该搜索邮政编码功能`base/addresses/{postcode}`并返回集合，因为那是死胡同；API 使用者需要猜测如何使用该地址。

相反，该功能的动机应该内置到使用它的流程中，以便旅程在开始时结束：

```
1 GET /orders/123/shipping

  200 OK { Current shipping details + link to parent + link to address picker }

2  -> GET /orders/123/shipping/addresspicker

      200 OK { Link and form for searching for a postcode }

3   -> GET /orders/123/shipping/addresspicker?postcode=tn11tl

       200 OK { List of addresses each with link to pick it }

4    -> POST /orders/123/shipping/addresspicker?postcode=tn11tl&pickNo=3

        200 OK { Current shipping details + link to parent + link to address picker } 
```

这是一个用户旅程，最后您可以看到流程对订单的影响。

HTTP 请求/响应严格来说不是 REST 的一部分，但我认为没有人见过非 HTTP REST 应用程序。

现在这些 URL 可以是任何字符集，它们只是标识符，我把它们做得很漂亮，因为它们对人们有意义。机器会使用`rel`来计算它们的工作，而不是依赖于可读的`href`.

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2020-05-20T10:54:21.600

REST API 是遵循 REST 架构约束的 API 实现。它充当接口。客户端和服务器之间的通信通过 HTTP 进行。REST API 利用 HTTP 方法在客户端和服务器之间建立通信。REST 还使服务器能够缓存提高应用程序性能的响应。客户端和服务器之间的通信是一个无状态的过程。我的意思是，客户端和服务器之间的每次通信都像是一个新的通信。

没有从之前的通信中携带的信息或记忆。因此，每次客户端与后端交互时，它都必须将身份验证信息发送给它。这使后端能够确定客户端是否有权访问数据。

通过 REST API 的实现，客户端可以与后端端点进行通信。这完全解耦了后端和客户端代码。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2020-10-21T20:10:41.620

为了在这里贡献一些新的东西，我想分享我的文章的链接，即通过实用和客观的方法来概念化 REST。

我正在介绍主要概念，例如：

*   HATEOAS - 超媒体作为应用程序状态的引擎，
*   资源和陈述，
*   可寻址性，
*   REST 中的幂等性，
*   理查森的 REST 成熟度模型。
*   媒体类型
*   API 版本控制

我还创建了一个 GitHub 项目，您可以使用 docker 轻松运行它，它涵盖了我在本文中介绍的内容。

[https://itnext.io/how-to-build-a-restful-api-a-deep-dive-into-rest-apis-215188f80854](https://itnext.io/how-to-build-a-restful-api-a-deep-dive-into-rest-apis-215188f80854)

* * *

## 回答 #35

> 赞同：-2
> 
> 时间：2013-07-25T08:36:40.933

REST 是一种分布式系统（如 WWW）软件架构风格，你可以想象它是一个精心设计的 Web 应用程序规则：一组 Internet 网页（一个虚拟状态机），其中通过点击超链接链接（状态转换)，结果是下一个网页（这意味着应用程序的下一个状态）。

REST 描述的网络系统由三部分组成：

1.  数据元素（资源、资源标识符、表示）
2.  连接器（客户端、服务器、缓存、解析器、隧道）
3.  组件（源服务器、网关、代理、用户代理）

REST 严格满足以下条件：

1.  应用程序功能的状态被拆分为资源
2.  每个资源用作超链接定位语法（即在 WWW URI 中）
3.  所有资源在具有资源转换状态的客户端之间共享一个统一的接口，包括：
    1.  一组有限的定义良好的操作（即在 HTTP GET / POST / PUT / DELETE 中）
    2.  一组有限的内容格式内容类型，可能包括可执行代码（即，在 WWW Javascript 中）

# java - 是否有适用于 Java 的 CalDAV 客户端库？

> ID：671120
> 
> 赞同：8
> 
> 时间：2009-03-22T14:46:19.970
> 
> 标签：java, calendar

我想使用 CalDAV 协议与我的日历服务器进行通信。是否有任何受支持的 Java 客户端库？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-08T22:33:13.613

试试[CalDAV4j](http://code.google.com/p/caldav4j/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-10T01:03:43.067

我使用并贡献于[ical4j-connector](http://wiki.modularity.net.au/ical4j/index.php?title=Connector)。使用源代码，我经常在未更新快照时对连接器进行修复或添加新内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-22T19:49:23.210

Calendaring and Scheduling Consortium (CalConnect) 有一个[库和工具列表](https://devguide.calconnect.org/CalDAV/libraries/)

# javascript - 在开发过程中优雅地忽略 netscape.javascript.JSException

> ID：671123
> 
> 赞同：1
> 
> 时间：2009-03-22T14:47:45.007
> 
> 标签：javascript, eclipse, applet, word-wrap, appletviewer

Eclipse 允许您使用*sun.applet.AppletViewer*调试小程序。它实际上会启动小程序，运行它并模拟完整的浏览器运行时。如果您的小程序中有 javascript 操作代码，这将导致 JSException，因为当前上下文不是真正启用 JS 的引擎。

你会如何解决这个问题？我可以看到几种可能的路径：

1.  将异常包装在 try {} catch () 中并忽略它 - 不好的做法。
2.  传递和环境标志将告诉我们当前处于调试模式的代码，因此它不会尝试执行 JS 代码 - 好的，但需要每个开发人员的手动干预。
3.  识别当前上下文不是浏览器 - 如何？
4.  找到另一个可以模拟完整浏览器行为的 AppletViewer，包括 JS - 有吗？
5.  更多的？

感谢您的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T12:33:43.027

不是故障保险，而是我设法提出的可行解决方案：

```
private void notifySelectionState(){
    JSObject jsObject = null;

    try {
        jsObject = JSObject.getWindow(applet);

        // An exception can be thrown here (hopefully) only is running in debug environment...
    } catch (JSException e) {
        // So actually what I'm doing here is checking (in a very lame fashion) for if I'm in a the browser
        // content or in the AppletViewer
    } 

    if (jsObject != null) {
        jsObject.call(...);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-19T16:42:31.853

在某些较旧的浏览器上，JSObject 将抛出通用 RuntimeExceptions 而不是 JSException。所以你可能想把你的网撒得更宽一些，并在你的包装中留下一个好的评论。

# .net - 实际上是什么导致 Session_Start 被调用？

> ID：671129
> 
> 赞同：9
> 
> 时间：2009-03-22T14:51:47.337
> 
> 标签：.net, asp.net, session

在我正在构建的一个小演示应用程序中，我将代码用于在 Global.Session_Start() 事件中初始化数据库。但是，我注意到当我在开发服务器上的调试器中运行应用程序时，此事件不会触发（尚未在其他任何地方对其进行测试）。

**问题1：**什么给了？Session_Start() 何时真正被调用？我认为这是会话开始的时候，但不是每个新请求序列的开始都会导致会话自动启动吗？当然，当我使用 F5 运行时，会话应该开始，为什么不呢。

**问题2：**初始化数据库的代码应该去哪里有更好的地方吗？我宁愿不把它放在 Application_Start 方法中，因为它在调试时并不总是被调用。

PS。通过初始化数据库，我并不是说我打开到 SqlServer 的连接并让它永远打开。我正在使用 db4o 并打开一个预构建的数据库文件。就像我说的这只是一个演示应用程序，我不担心资源管理不善或类似的事情。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T10:34:09.953

**我知道这是一篇旧帖子，但也许这会对某人有所帮助：**

session_start 不会触发，除非您实际上正在读取或写入会话对象。

如果您想使用 session_start 事件但根本不需要使用会话存储，您可以将以下内容添加到登录页面的页面指令中：

```
<%@ Page EnableSessionState="ReadOnly" %> 
```

这将导致 session_start 事件触发，而无需在会话对象中存储任何内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-22T15:33:07.893

在您访问 Session 对象之前，我不完全确定会话“开始”。否则，启动不需要的会话似乎是不必要的开销。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-22T18:14:57.457

> 嗯。。好。也许将代码放在 BeginRequest() 中是有意义的，但是有没有办法在 EndRequest() 中放置一个处理程序，以便我可以关闭数据库文件？

问题是您永远不能依赖这些事件来触发，因为 ASP.NET 运行时决定它们是否被触发，因为它们甚至可能不是必需的并且可以跳过以节省资源。

例如，Response.Redirect 使用 ThreadAbortException 取消请求的整个处理，之后的页面/控件生命周期事件将根本不会被触发，这就是为什么例如没有 End_Request 或类似的东西。

我会考虑将您的逻辑移动到不同的层（独立于 ASP.NET），并可能在页面实际请求数据库时初始化数据库？然后，您可以在需要信息的相同方法中关闭数据库文件，这将使您更加独立于应用程序/会话所处的状态。

不确定这是否是您正在寻找的信息:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-22T14:57:34.967

您使用什么会话模型？对于 SQL Server 支持的会话，它可能不会启动新会话。在 InProc 的情况下，我认为它应该可以工作。正如您所指出的，Application_Start 有时会在调试器附加之前被触发。

您使用 IIS 还是开发 Web 服务器？如果是 IIS，[本文](http://www.velocityreviews.com/forums/t119518-sessionstart-not-firing--.html)建议您需要先将其创建为应用程序。

# objective-c - 包裹 NSButton 标题

> ID：671136
> 
> 赞同：9
> 
> 时间：2009-03-22T14:57:14.627
> 
> 标签：objective-c, cocoa, macos

有什么方法可以让 NSButton 标题在宽度大于按钮宽度时换行，而不是被剪裁？

我试图有一个单选按钮，其文本可能很长并且有多行。我想到让它工作的一种方法是拥有一个 NSRadioButton 类型的 NSButton 但不能让多行文本工作。

也许我最好的选择是有一个 NSButton 后跟一个带有 mouseDown 委托功能的 NSTextView 触发 NSButton 状态？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-22T15:31:14.230

我不相信你可以。您必须进行子类化[`NSButtonCell`](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/ApplicationKit/Classes/NSButtonCell_Class/Reference/Reference.html)才能添加对此的支持。

也就是说，在按钮上包含多行文本通常是个坏主意。[按钮标签应简洁地表示执行的操作：](http://developer.apple.com/documentation/userexperience/Conceptual/AppleHIGuidelines/XHIGControls/XHIGControls.html#//apple_ref/doc/uid/TP30000359-TPXREF186)

> 按钮上的标签应该是一个动词或动词短语，描述它执行的操作——保存、关闭、打印、删除、更改密码等。如果按钮作用于单个设置，请尽可能具体地标记按钮；例如，“选择图片...”比“选择...”更有帮助，因为按钮会立即执行操作，因此不必在标签中使用“现在”（例如，立即扫描）。

你想做什么？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-02-12T11:50:42.793

我迟到了，但我仍然觉得有义务分享我的发现。

只需在按钮标题前后添加一个换行符，然后再将其分配给实际按钮 - 瞧！它现在自动换行。

这种方法的缺点是，由于我不知道的原因，在某个版本的 OS X 上编译的应用程序在新版本上运行时会向下移动一行。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-17T00:07:05.413

好吧，这就是我需要多行按钮的借口：我正在为 IBM 701 编写一个带有前面板的仿真器，并且，祝福他们，该前面板的设计者使用了多行标签。这是我的代码。你只需要继承 NSButtonCell（不是 NSButton），并且只需要重写一个方法。

```
// In Xcode 4.6 (don't know about earlier versions): Place NSButton, then double-click it
// and change class NSButtonCell to ButtonMultiLineCell.

@interface ButtonMultiLineCell : NSButtonCell

@end

@implementation ButtonMultiLineCell

- (NSRect)drawTitle:(NSAttributedString *)title withFrame:(NSRect)frame inView:(NSView *)controlView
{
    NSAttributedString *as = [[NSAttributedString alloc] initWithString:[title.string stringByReplacingOccurrencesOfString:@" " withString:@"\n"]];
    NSFont *sysFont = [NSFont systemFontOfSize:10];
    NSMutableParagraphStyle *paragraphStyle = [[[NSParagraphStyle defaultParagraphStyle] mutableCopy] autorelease];
    [paragraphStyle setAlignment:NSCenterTextAlignment];
    NSDictionary *attributes = [NSDictionary dictionaryWithObjectsAndKeys:
      sysFont, NSFontAttributeName,
      paragraphStyle, NSParagraphStyleAttributeName,
      nil];
    NSSize textSize = [as.string sizeWithAttributes:attributes];
    NSRect textBounds = NSMakeRect(0, 0, textSize.width, textSize.height);
    // using frame argument seems to produce text in wrong place
    NSRect f = NSMakeRect(0, (controlView.frame.size.height - textSize.height) / 2, controlView.frame.size.width, textSize.height);
    [as.string drawInRect:f withAttributes:attributes];
    return textBounds; // not sure what rectangle to return or what is done with it
}

@end 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-10T15:37:51.750

即使是后来，但我也觉得有义务分享。可以设置 NSButton 的 attributesTitle 属性来实现手动换行。

就我而言，如果按钮标题超过 6 个字符（Swift 3），我希望它换行：

```
if button.title.characters.count > 6 {
    var wrappedTitle = button.title
    wrappedTitle.insert("\n", at: wrappedTitle.index(wrappedTitle.startIndex, offsetBy: 6))
    let style = NSMutableParagraphStyle()
    style.alignment = .center
    let attributes = [NSFontAttributeName: NSFont.systemFont(ofSize: 19), NSParagraphStyleAttributeName: style] as [String : Any]
    button.attributedTitle = NSAttributedString(string: wrappedTitle, attributes: attributes)
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T22:53:30.993

我和索伦在一起；如果您需要更长的描述，请考虑使用工具提示，或者如果描述性文本只有几行，则使用单选选项下方的小系统字体将描述性文本放置在包装的文本字段中。否则，您可以在帮助文档中提供更多信息。

不过，想办法以简洁的方式说出你需要说的话是你最好的选择。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-05-12T08:10:03.983

截至今天，我看到这可以简单地通过 NSButton 单元格上的属性来完成：

`myButton.cell?.wraps = true`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-09T12:58:17.520

我遇到了同样的问题，并带着一颗沉沦的心尝试了这篇文章中的解决方案。（虽然我很欣赏关于通常应该保持按钮标题简短的建议，但我正在编写游戏，并且我希望多行答案的行为类似于按钮）。

有时，你不会从这里到达那里。我的理想是一个带有多行标签的 NSButton，但是因为我不能不费吹灰之力就得到它，所以我创建了一个 PseudoButton：一个行为类似于按钮的 NSControl 子类。它有一个手形光标指示“您可以单击此处”，并提供反馈：当您单击鼠标时，它会更改为 selectedControlColor，当您松开鼠标时，它会恢复正常。与尝试堆叠按钮和标签的解决方案不同，在视图顶部放置标签和图像没有问题：整个视图都是可点击区域。

```
import Cocoa

@IBDesignable

class PseudoButton: NSControl {

    @IBInspectable var backgroundColor: NSColor = NSColor.white{
        didSet{
            self.needsDisplay = true
        }
    }

    override func draw(_ dirtyRect: NSRect) {
        super.draw(dirtyRect)
        let path = NSBezierPath(rect: dirtyRect)
        backgroundColor.setFill()
        path.fill()
        NSColor.black.setStroke()
        path.lineWidth = 2
        path.stroke()
    }

    override func mouseDown(with event: NSEvent) {
        self.backgroundColor = NSColor.selectedControlColor
    }

    override func mouseUp(with event: NSEvent) {
        self.backgroundColor = NSColor.clear
        guard let action = action else {return}
    tryToPerform(action, with: self)
    //@IBAction func pseudobuttonClicked(_ sender: PseudoButton) in the ViewController class
    }

    override func resetCursorRects() {
        addCursorRect(bounds, cursor: .pointingHand)
    }

} 
```

您可以像使用故事板中的任何其他控件一样使用它：将 Pseudobutton 拖入，随意装饰它，并将其连接到 viewController 类中的适当 IBAction。

我更喜欢这个，而不是干涉 NSCell。（根据过去的经验，基于 NSCell 的黑客攻击更有可能被破解）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-10-16T06:34:59.043

这里有点晚了，这是我在标题中插入新行的代码：

```
private func calculateMultipleLineTitle(_ title: String) -> String {
    guard !title.isEmpty else { return title }
    guard let cell = cell as? NSButtonCell else { return title }
    let titleRect = cell.titleRect(forBounds: bounds)
    let attr = attributedTitle.attributes(at: 0, effectiveRange: nil)
    let indent = (attr[.paragraphStyle] as? NSMutableParagraphStyle)?.firstLineHeadIndent ?? 0
    let titleTokenArray = title.components(separatedBy: " ")  // word wrap break mode
    guard !titleTokenArray.isEmpty else { return title }
    var multipleLineTitle = titleTokenArray[0]
    var multipleLineAttrTitle = NSMutableAttributedString(string: multipleLineTitle, attributes: attr)
    var index = 1
    while index < titleTokenArray.count {
        multipleLineAttrTitle = NSMutableAttributedString(
            string: multipleLineTitle + " " + titleTokenArray[index],
            attributes: attr
        )
        if titleRect.minX+indent+multipleLineAttrTitle.size().width > bounds.width {
            multipleLineTitle += " \n" + titleTokenArray[index]
        } else {
            multipleLineTitle += " " + titleTokenArray[index]
        }
        index += 1
    }
    return multipleLineTitle
} 
```

只需将原始标题作为参数传递，它将返回多行标题。

# php - 如何从复选框中检索信息？

> ID：671138
> 
> 赞同：3
> 
> 时间：2009-03-22T14:58:52.157
> 
> 标签：php, checkbox

我的问题有点复杂。（我使用 PHP）

我有两个数组，（简单数组array[0] = string，array[1] = string...）好的，现在我将在网页中显示两个数组的内容。第一个数组包含名称和第二个图像 URL。

图像和名称已经显示（我的问题不在这里）。

但现在我想做点别的，在每个图像附近添加一个复选框，默认情况下这些复选框 r 处于活动状态。好的，现在用户可以取消选中某些收件箱；

最终目标是获取一个新数组，该数组仅包含已检查的名称和图像的值。

我想到了一些简单的事情，抓取未选中复选框的键（数量）并将它们从我的数组中取消设置。但是我不知道如何处理复选框的问题

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-22T15:03:15.280

要在 PHP 中以数组形式接收输入，您必须在 HTML 中使用括号设置它们的名称：

```
<label><input type="checkbox" name="thename[]" value="" /> The text</label> 
```

然后，当您访问 $_REQUEST['thename'] 时，您将获得一个数组。检查它以查看其格式并使用它:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T15:58:53.387

首先，我建议只有一个数组：

```
$array = array (0 => array('name' => '....', 'url' => '....')) 
```

我认为这会让你的生活更轻松。同样在 HTML 中，您还可以发送数组键

```
foreach ($yourArray as $key=>$value) {
    ...
    <INPUT type="checkbox" name="chkArr[<?php echo $key ?>]" value="1" checked/> 
```

然后在您的表单操作中，您迭代初始数组并删除未选中的数组。

```
foreach ($yourArray as $key=>$value) {   
    if (!isset($_POST['chkArr'][$key]) OR $_POST['chkArr'][$key]!='1') {
        unset($yourArray[$key]);  
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T15:06:29.017

```
<INPUT type="checkbox" name="chkArr[]" value="$num" checked/> 
```

提交表单后，您将拥有数组 $_REQUEST['chkArr']，其中您将拥有仍处于选中状态的复选框的编号。

查看哪些未选中使用`array_diff($listOfAllNums, $chkArr)`

# asp.net - asp.net 网站和默认命名空间和 LINQ Datacontext 第 2 部分

> ID：671142
> 
> 赞同：0
> 
> 时间：2009-03-22T15:02:49.730
> 
> 标签：asp.net, web, namespaces, app-code

让我试着从另一个角度问这个问题。

我注意到每次使用“网站”模型在浏览器中呈现一个 aspx 页面时，都会在临时 ASP.NET 文件中“即时”创建一个随机程序集。分析 Reflector 中的程序集表明，为任何给定的 .aspx 文件创建的类位于“ASP”命名空间下。

因此，从一个空的“临时 ASP.NET 文件”目录开始，我在 VS2008 中打开了我的 ASP.NET“网站”，并启动了默认页面。我立即观察到该文件夹​​内生成了一个随机目录。一路走下去，我发现创建了 2 个 DLL：App_Code.1lywsqqz.dll 和 App_Web_iohekame.dll。我假设网站中的所有 .aspx 页面都编译为 App_Web dll，而 App_Code 文件夹中的所有内容都编译为 App_Code.dll。

因此，如果我的 App_Code C#/VB.net 文件位于“ASP”命名空间下，并且我的 App_Web 文件是在“ASP”命名空间下创建的，为什么我仍然会收到错误消息“无法加载类型 'ASP.NothwindDataContext'？

有人说“你不需要 App_Code 文件夹中的命名空间”，但我没有尝试过，但仍然得到“无法加载类型 'NorthwindDataContext'”。

那么 App_Code 文件夹、站点的其余部分和命名空间之间发生了什么？

编辑：这是我的 .aspx 文件中的 LinqDataSource：

```
<asp:LinqDataSource ID="LinqDataSource1" runat="server" 
    ContextTypeName="NothwindDataContext" EnableUpdate="True" 
    TableName="Categories">
</asp:LinqDataSource> 
```

“NorthwindDataContext”和“ASP.NorthwindDataContext”都不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-22T15:23:35.980

C# 源文件中的类型`App_Code`，就像任何 C# 文件一样，不会放在特定的命名空间中，除非`namespace Name {...}`它周围特别声明。因此，在`MyClass`中声明的类`App_Code`将具有完全限定的类型名称`MyClass`。只是。

您可以将其引用`Web.config`为：`"MyClass, App_Code"`.

*旁注：*当您在 中使用 DBML 时`App_Code`，生成的类的名称空间在该文件中定义（打开 DBML 文件时查看属性窗口）。如果您在该文件中指定命名空间，那么您的类自然会在该命名空间中定义。请注意，这与我上面所说的并不矛盾。问题是，LINQ 数据上下文生成器处理文件并在特定命名空间中定义类。

# regex - 在 shell 或正则表达式中“匹配除这些字符串之外的所有内容”的最紧凑版本是什么？

> ID：671152
> 
> 赞同：4
> 
> 时间：2009-03-22T15:09:54.750
> 
> 标签：regex, shell, grep

Linux：我想列出一个目录及其子目录中的所有文件，除了一些字符串。为此，我一直在使用 find/grep/shell globbing 的组合。例如，我想列出除目录中的文件之外的所有文件

```
./bin
./lib
./resources 
```

我知道这可以按照[这个问题](https://stackoverflow.com/questions/322392/regex-for-matching-everything-but-a-string)和[这个其他](https://stackoverflow.com/questions/611883/regex-how-to-match-everything-except-a-particular-pattern)的所示来完成。但是这两个版本都不是笼统地解决“一切，而是这种模式”的情况。

似乎使用条件过滤结果要容易得多，但我想知道在正则表达式或外壳扩展通配符中是否有任何紧凑而优雅的方式来描述它。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-22T15:11:38.007

`yourcommand | egrep -v "pattern1|pattern2|pattern3"`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-22T15:20:14.820

使用查找的修剪选项。

```
find . -path './bin' -prune -o -path './lib' -prune -o -path './resources' -prune -o «rest of your find params» 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-22T16:57:51.043

[启用bash 的 extglob shopt 设置](http://www.faqs.org/docs/bashman/bashref_55.html)后，`!`您可以排除带有[通配符模式](http://www.faqs.org/docs/bashman/bashref_35.html)的文件。一些例子：

*   除了 bin、lib 和资源之外的所有内容

    ```
    shopt -s extglob
    ls -Rl !(bin|lib|resources)

    ```

*   `i`除了 bin 和 lib 之外的所有内容

    ```
    ls -Rl !(bin|lib|!(*i*))

    ```

    （*除了**没有*`i`' 的东西外，所有有' 的东西都一样。）**`i`**

 **# jquery - 使用 jQuery查找此 div 标签内的标签

> ID：671155
> 
> 赞同：4
> 
> 时间：2009-03-22T15:13:34.163
> 
> 标签：jquery, dom

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-22T15:19:55.710

尝试这个：

```
$(".blah").find("strong").html(); 
```

$(".blah").find("strong") 只会返回 jQuery 对象，而不是它的内容。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-22T15:22:27.793

```
var value = $('.blah strong').html(); 
```

比 pim 的答案更简单，但以同样的方式工作。它找到 .blah 的所有强标记的后代，并返回第一个的 html 内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T09:19:21.987

尝试这个

```
<script type="text/javascript">
    $(document).ready(function() {
        alert($(".blah > strong").text());
    });
</script>

    <div class="blah">
    <a href="#">
        <img src="#" /></a> <strong>blah blah</strong>
   </div> 
```

# html - 使用 cookie 同步在线和离线应用程序

> ID：671157
> 
> 赞同：1
> 
> 时间：2009-03-22T15:16:59.320
> 
> 标签：html, cookies, client-side

我正在开发一个包含在线和离线组件的应用程序，并且想就我打算如何执行此操作获得一些意见。如果这是一个荒谬的想法，请随意给我一些严厉的爱，因为我想尽可能多地学习：o）

这是我要完成的工作的大纲...

*   客户端部分执行基本的 CRUD，但表单可能会根据在线数据库中的内容而改变。
*   客户端部分可以在线或离线使用。
*   客户端部分应该很容易从一台机器移动到另一台机器（即我宁愿不必在每个客户端上设置数据库）。
*   服务器部分不需要实时同步。

我正在考虑使客户端部分成为一系列读取和写入 cookie 的 HTML 表单。表单将根据 cookie 中的内容使用 JS 生成。例如，cookie 可以存储诸如将在表单上的选择框中使用的值列表之类的内容。提交表单后，他们将写入 cookie。表单可用于提交可能会在下次加载表单时更改表单生成方式的数据......例如，我可能有一个表单允许我输入将包含在另一个表单的选择框中的选项。

服务器部分将读取这些 cookie，更新数据库，然后更新 cookie，以便下次适当地生成表单。

这听起来很疯狂吗？我会更好地寻找像谷歌齿轮这样的东西吗？任何提示、建议或想法将不胜感激！

在此先感谢 :o)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T15:30:01.490

除非在线/离线事物能够区分您的应用程序，否则我会让 Gears 处理这个问题。一般的建议是将您的精力集中在使您与众不同的功能部分，并让库处理其余部分——假设它们以您的应用程序可以接受的方式处理它。

# c# - 你可以有多个 .net 控制台（如在 Console.Writeline 中）

> ID：671163
> 
> 赞同：5
> 
> 时间：2009-03-22T15:21:59.137
> 
> 标签：c#, vb.net

在调试过程中拥有多个控制台（不是我已经拥有的多个监视器）会很方便。我在想像 Console.WriteLine(1, String1) 这样的东西，它将 String1 发送到一个控制台窗口 1，而 Console.WriteLine(2, String2) 将把 String2 发送到控制台窗口 2。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-22T15:27:36.580

没有

> 一个进程只能与一个控制台关联，因此如果调用进程已经有一个控制台，则 AllocConsole 函数会失败。进程可以使用 FreeConsole 函数将自己与其当前控制台分离，然后它可以调用 AllocConsole 来创建新控制台或 AttachConsole 以附加到另一个控制台。

[ [http://msdn.microsoft.com/en-us/library/ms681944(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms681944(VS.85)。 aspx)](http://msdn.microsoft.com/en-us/library/ms681944(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms681944(VS.85).aspx))

相反，您可以使用 WinForms 或 WPF 创建多个“控制台”窗口并编写一个简单的`WriteLine`方法来将文本附加到文本框或类似内容。

另一种选择是打开一个日志文件，并将其用作您的第二个“控制台”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-22T15:28:25.347

## 同一个应用程序中是否可以有 2 个 Windows 控制台？

不，Console 类只是 Win32 控制台思想的一个非常薄的包装器。基本上你在使用时看到的一切 `cmd.exe`。没有办法在一个进程中创建其中的 2 个。

## 我可以有 2 个类似控制台的窗口吗？

是的。基本上可以在 WPF 或 WinForms 中构建一个非常类似于控制台的类。使用它将文本吐出到命令行（如应用程序）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-11-15T19:13:45.903

我有同样的需求，我在 SO 中找到了你的问题。很多年后：）

事实上，.NET 没有这个能力，但是我们可以通过用网格分割屏幕，使用一些缓冲来模拟它。

这是一个例子：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ConsoleApp1
{
    class Program
    {
        static void print(int x, int y, int n)
        {
            for(int i = 0; i < 20; i++)
            {
                Console.CursorLeft = x; Console.CursorTop = y++;
                Console.Write(new string(n.ToString().Last(), 60));
            }
        }

        static void Main(string[] args)
        {
            var l = new List<int>(new int[] { 1, 2, 3, 4, 5, 6, 7, 8, 9 });

            while (true)
            {
                Console.Clear();
                Console.CursorVisible = false;

                for (int i = 0; i < l.Count; i++)
                {
                    print((i % 3) * 60, (i / 3) * 20, l[i]++);
                }

                Task.Delay(1000).Wait();
            }
        }
    }
} 
```

[![输出](https://i.stack.imgur.com/FGHKJ.png)](https://i.stack.imgur.com/FGHKJ.png)

因此屏幕被划分为一个 3x3 的网格，每个屏幕都使用光标位置进行更新。

它可以被打包到一个库和一个通用 API 中，就像你描述的那样：

```
Console.WriteLine(1, String1)
Console.WriteLine(2, String2) 
```

希望它可以帮助某人。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-22T15:38:03.013

您可能想要考虑多个日志附加器的想法，而不是多个控制台。我不是真正的忠实粉丝[`printf debugging`](http://www.oopweb.com/CPP/Documents/DebugCPP/Volume/techniques.html)，但有时我确实会看到一个存放多个日志文件的地方。使用类似[log4net](http://logging.apache.org/log4net/)的东西，您可以配置对应于不同类/命名空间的多个附加程序和记录器，并将它们记录到单独的文件中。您可以使用日志信息来帮助调试，使用[TextPad](http://www.textpad.com/)之类的工具在调试时查看日志文件，因为 TextPad 与 NotePad 不同，它检测并允许您查看文件打开时完成的任何更新的内容。可能还有其他编辑器也允许这样做，但我熟悉 TextPad。

# ruby-on-rails - Rails：获取父资源

> ID：671167
> 
> 赞同：0
> 
> 时间：2009-03-22T15:24:01.817
> 
> 标签：ruby-on-rails, routing

我有一个这样的 config/routes.rb 文件：

```
  map.resources :categories, :shallow => true do |cat|
    cat.resources :entries, :member => {:yes => :post, :no => :post }
  结尾

```

我的目标是使用是和否作为修改我的条目的按钮（它就像一个游戏，是和否是条目的答案）。

我希望当我单击是或否时，我将返回 category/:category_id/entries ，因为那里有漂亮的布局等。

问题是我从 entry/:entry_id 得到了 yes 方法，所以我丢失了这个条目所在的类别 ID，我不知道如何获得该类别的链接。

我想我可以尝试不使用 :shallow 参数，所以我得到了完整的路径，但我可能会在 hierarqui 中走得更远（条目可能有评论），我想通过这个简单的问题学习如何管理这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T16:32:51.057

如果您的条目是您的类别的子资源，那么模型之间可能存在父子关系，对吗？如果是这样，那么您可以使用：

```
redirect_to category_entries_path(@entry.category) 
```

在你的`yes`和`no`方法中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T16:03:17.040

在您的按钮中，您可以像这样指定类别：

```
link_to "Yes", yes_entry([@category, Entry.new]), :method => :post 
```

我不确定它是否有效，否则您可以尝试：

```
link_to "Yes", yes_entry(Entry.new, :category_id => @category), :method => :post 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T16:14:56.030

您是否尝试过[resource_controller](http://jamesgolick.com/resource_controller)？我没有使用 :shallow 选项（而且这个解决方案可能没有它），但是 resource_controller 支持某种多态资源（你可以有类似的 url：/entries、/category/3/entries、/whatever/12/entries ETC）。然后，您可以使用以下命令生成条目的 url：

```
<%= link_to 'Entries', collection_path %> 
```

但如果你的“是”和“否”方法，你只需要添加：

```
redirect_to collection_path 
```

回应“是”和“否”的行动。

# wpf - 如何在 WPF 文本框中禁用快捷方式

> ID：671168
> 
> 赞同：7
> 
> 时间：2009-03-22T15:24:53.827
> 
> 标签：wpf, textbox, keyboard-shortcuts

我想禁用 WPF TextBox 中的所有默认快捷方式。`Ctrl`+ `A`，`Ctrl`+ `V`，`Ctrl`+等快捷方式`C`。可以这样做吗？在我看来，这些快捷方式是在`KeyDown`事件之前执行的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T15:29:20.523

您可以拦截`PreviewKeyDown`事件中的击键。将`e.Handled`成员设置为`true`and 将阻止密钥的实际处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-22T15:34:50.790

```
public Window1()
{
    InitializeComponent();
    CommandManager.AddPreviewCanExecuteHandler(_textBox, _canExecute);
}

private void _canExecute(object sender, CanExecuteRoutedEventArgs e)
{
    e.CanExecute = false;
    e.Handled = true;
} 
```

以上将阻止 TextBox 说它可以处理*任何*命令。您可以通过检查`EventArgs`. 或者您可以在 XAML 中执行此操作：

```
<TextBox x:Name="_textBox">
    <TextBox.CommandBindings>
        <CommandBinding Command="ApplicationCommands.Copy" CanExecute="_canExecute"/>
    </TextBox.CommandBindings>
</TextBox> 
```

在这里，我们只是禁用了 Copy 命令的执行。Control-C 不起作用，上下文菜单或主菜单也不起作用。事实上，如果焦点在`TextBox`.

# actionscript-3 - 为 Actionscript 使用 Eclipse 模板

> ID：671170
> 
> 赞同：0
> 
> 时间：2009-03-22T15:27:41.090
> 
> 标签：actionscript-3, eclipse, actionscript, templates, code-snippets

Eclipse 中我最喜欢的特性之一是 PDT 中的模板。如果您不知道它们是什么，请考虑编写“函数”并让 Eclipse 编写所有的语法特性，并让您通过点击 tab 键从一个变量跳到另一个变量。所以我开始在 Eclipse 中编写 AS3，我想念触手可及的模板。

有没有办法可以在 Eclipse 中为 Actionscript 开发配置模板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T15:37:25.543

您为 Actionscript 使用什么 Eclipse 插件？

我正在使用包含模板的 FDT（Prefereces>FDT>Editor>Templates）。

编辑：

它不直接包含在 FLEX Builder 中。这是一种解决方法（未经测试）：

[http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&productId=2&postId=13507](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&productId=2&postId=13507)

# .net - LINQ to SQL 与 ADO.Net

> ID：671179
> 
> 赞同：30
> 
> 时间：2009-03-22T15:32:09.113
> 
> 标签：.net, linq-to-sql, ado.net

LINQ to SQL 和 ADO.net 有什么区别？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-22T15:37:46.463

ADO.NET 是 .NET Framework 的底层数据访问 API（很像 Java 中的 JDBC）。自 .NET 的第一个版本以来，它就一直存在。

LINQ to SQL 是一个建立在 ADO.NET 和新语言特性之上的数据访问框架，它使 SQL Server 数据以面向对象的编程风格本地可用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-22T20:13:28.907

您需要首先了解 LINQ 是 Microsoft 旨在使用一种工具以声明方式查询各种结构化数据的预期范式 - 想想“一环来统治它们”。LINQ to SQL 只是第一个表现形式，用于查询关系数据库。

事实上，对于 LINQ 与 SQL 的关系，微软的说法不一。我认为问题在于它已经被理解为其他抽象策略的替代品，现在它通常被视为程序员避免需要熟练掌握 SQL 的一种方式。

ADO.Net 将 OOP 视为它的本来面目，将关系数据视为它的本来面目，并希望您按照自己的条件正确地执行每一项操作。

两者的优劣势值得商榷。但是，如果您同意 Microsoft 的计算机科学向导为结构化数据查询提出了某种超抽象的东西，那么您可能希望朝这个方向前进。有迹象表明，其他软件产品供应商也愿意参与进来，因此它甚至可能最终都不是完全专有的，这将是一件好事。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-22T15:40:36.800

这两种技术之间存在相当大的差异，无法在简短的 SO 帖子中真正涵盖，但我将尝试涵盖重点

*   在 Linq2Sql 中，您将查询写入内存对象中。尽管您编写的代码在后台被转换为表达式树，并在实际运行查询的运行时被进一步转换为 SQL。在 ADO.Net 中，您可以直接构建针对服务器运行的 SQL 查询。
*   Linq2Sql 在 C# 和 VB.Net 中有直接的语言支持。ADO.Net 提供对基于字符串的查询的支持，除了原始字符串外，它还支持 0 种语言。
*   Linq2Sql 中的语言支持使查询类型安全。在 ADO.Net 中，所有查询结果都必须转换为适当的类型，这基本上消除了类型安全检查。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-22T19:16:18.247

另外，我不确定我是否在这里。但是 ADO.NET 总是“离线”处理您的数据。我认为 LINQ2SQL 正在在线处理您的数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-22T17:20:57.430

ADO.NET 是一组在 .NET 基本类库之上提供基本数据访问基础结构的类库。它还包含基本的 LINQ 基础结构，例如 Enumerable 的静态类（提供 LINQ to Object）和对关系数据（例如 IQueryable）进行基本查询的接口。

LINQ to SQL 不是数据访问框架。

ADO.NET 可以被假定为一个数据访问框架，但这可能会产生误导，因为 ADO.NET 不是一个独立的产品。ADP.NET 确实是 .NET Framework 的一部分。

LINQ to SQL 只是 LINQ 的一种实现，用作直接连接和映射到 SQL Server 的数据提供者。在 LINQ to SQL 之下，在 System.Data.SqlClient 命名空间中包含大量 ADO.NET 类的用法，因此它是在 ADO.NET 之上实现的，但专注于访问 SQLServer 并且它是特定于访问 SQLServer 的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-25T11:36:44.977

> 下图概述了 ADO.NET LINQ 技术如何与高级编程语言和启用 LINQ 的数据源相关联。
> 
> [![LINQ 和 ADO.NET](https://i.stack.imgur.com/9LTmt.gif)](https://i.stack.imgur.com/9LTmt.gif)
> [（来源：[microsoft.com](http://i.msdn.microsoft.com/dynimg/IC176601.gif)）]

>

> 来自[http://msdn.microsoft.com/library/vstudio/bb399365](http://msdn.microsoft.com/library/vstudio/bb399365)

LINQ 帮助您将 ADO.NET 集成到编译器可以评估的代码部分，并帮助您使用 IntelliSense 等。因此，使用 LINQ，您可以更轻松地使用 ADO.NET...

# c - Pthread 条件信号 - 未按预期工作

> ID：671199
> 
> 赞同：5
> 
> 时间：2009-03-22T15:55:53.407
> 
> 标签：c, synchronization, pthreads

我正在做一个项目并尝试使用 `pthread_cond_wait()`和 `pthread_cond_signal()`同步两个线程。

我的代码看起来像这样：

```
pthread_mutex_t lock_it = PTHREAD_MUTEX_INITIALIZER;
pthread_cond_t write_it = PTHREAD_COND_INITIALIZER;

   int main(int argc, char**argv)
  {

     pthread_t t_send_segments, t_recv_acks;

     pthread_create(&t_send_segments, NULL, send_segments, (void*)NULL);
     pthread_create(&t_recv_acks,     NULL, recv_acks,     (void*)NULL);

     pthread_join(t_recv_acks, (void**)NULL);

     pthread_mutex_destroy(&lock_it);
     pthread_cond_destroy(&write_it);
}

 void* send_segments(void *v) {
    for(;;) {
       pthread_mutex_lock(&lock_it);
       printf("s1\n");
       printf("s2\n");
       pthread_cond_wait(&write_it, &lock_it);
       printf("s3\n");
       printf("s4\n");
       printf("s5\n"); 
       pthread_mutex_unlock(&lock_it);
    }
    return 0;
 }

 void* recv_acks(void *v) {
    for(;;) {
       pthread_mutex_lock(&lock_it);
       printf("r1\n");
       pthread_cond_signal(&write_it);
       printf("r2\n");
       pthread_mutex_unlock(&lock_it);
    }  
    return 0;
 } 
```

预期的输出是：

```
s1
s2
r1
s3
s4
s5
s1
s2
r2
r1
s3
s4
s5

(etc) 
```

我的输出根本不遵循这种模式。显然我在某处有逻辑错误，但我不明白在哪里。为什么`recv_acks()`线程在遇到- 因为总是首先执行（因为我创建线程的顺序）并且总是在临界区之后执行，所以它在命中时并不*总是*屈服？`pthread_cond_signal()``pthread_cond_wait()``cond_wait()`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-22T16:52:03.680

该`pthread_cond_signal`函数不会导致当前线程屈服，也不会释放互斥锁。它所做的只是重新启动一个在条件下挂起的线程`pthread_cond_wait`。这只是意味着被唤醒的线程可用于调度，它不会立即执行。线程调度程序将在将来的某个时间安排它。

此外，仅仅因为 s-thread 已被唤醒并正在竞争互斥锁，这并不意味着它将获得下一个互斥锁。互斥锁不一定对所有请求它的线程都是公平的。根据`pthread_mutex`手册页：“`pthread_mutex_lock`锁定给定的互斥锁。如果互斥锁当前被解锁，则它被锁定并由调用线程拥有，并`pthread_mutex_lock`立即返回。” 因此，r-thread 可以在其循环中旋转多次，在被调度程序换出之前多次愉快地解锁和重新锁定互斥锁。这意味着如果调度程序在释放互斥锁的短暂时间内碰巧中断了 r 线程，则 s 线程将只有在互斥锁上获得机会。

为了实现您想要的输出，两个线程都需要使用条件来控制它们的执行，并在暂停自己之前互相发出信号。但是，这可能是也可能不是您真正想要对您的实际项目执行的操作。

另一个注意事项：创建线程的顺序并不重要。创建线程不会产生创建线程。因此，主线程可能会在任何一个线程被调度之前创建两个线程，并且线程调度程序可以自由地调度其中一个线程以供接下来执行。如果 s-thread 确实首先在您的平台上运行，那恰好是您平台上的实现行为，而不是应该依赖的东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-22T16:02:57.167

我似乎记得在某处读过`pthread_cond_signal()`实际上不会导致线程立即屈服的地方。由于`pthread_cond_signal()`不释放锁，调用它的线程必须继续执行，直到它释放锁，*然后*它才会屈服并允许发出信号的线程从`pthread_cond_wait()`.

如果是这样的话，那么我认为你的输出看起来像

```
s1
s2
r1
r2
s3
s4
s5 
```

等等......如果不是这样，您可能需要将实际输出编辑到您的问题中以获得准确的答案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-22T18:03:42.337

你在错误地使用条件。我不完全理解你想要什么，但你想要做的看起来很像一个典型的同步问题，称为生产者/消费者问题，可以像我之后那样在条件下实现。

您应该查看一下以了解如何使用条件。问题如下：我有两个线程，一个将数据写入固定大小的缓冲区，另一个从缓冲区读取数据。如果缓冲区已满，则第一个线程无法写入更多数据，如果缓冲区为空，则第二个线程无法读取。

```
#include <stdlib.h>
#include <stdio.h>

#include <pthread.h>

#define BUFFER_SIZE 4 

int buffer_nb_entries = 0; 

pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER; 
pthread_cond_t cond = PTHREAD_COND_INITIALIZER; 

void send(){
for(;;){
  pthread_mutex_lock(&mutex);
  while( buffer_nb_entries == BUFFER_SIZE) /* If buffer is full, then wait */
    pthread_cond_wait(&cond, &mutex); 

  /* Here I am sure that buffer is not full */
  printf("sending\n"); 
  buffer_nb_entries++;

  pthread_cond_signal(&cond); // signal that the condition has changed. 
  pthread_mutex_unlock(&mutex); 
 }
}

void receive(){
  for(;;){
    pthread_mutex_lock(&mutex); 
    while(buffer_nb_entries == 0)
      pthread_cond_wait(&cond, &mutex);
    /* Here I am sure that buffer is not empty */
    printf("receiving\n");
    buffer_nb_entries--; 
    pthread_cond_signal(&cond); 
    pthread_mutex_unlock(&mutex); 
  }

}

int main(){
  pthread_t s, r; 

  pthread_create(&s, NULL, (void *(*)(void*))send, NULL); 
  pthread_create(&r, NULL, (void *(*)(void*))receive, NULL); 

  pthread_join(s, NULL); 

} 
```

请注意，您必须在调用 pthread_cond_wait() 之前测试某些内容，如果您不这样做并且如果您之前已调用过信号函数，那么您可能会永远休眠。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-22T16:35:31.597

我认为你的麻烦来自试图用一把锁做太多事情。你应该只为一件事使用锁，这样就不会混淆你在等待什么。我建议为写信号添加第二个锁。此外，您应该为第二组消息添加第二个 cond_wait。如果你不这样做，事情运行的顺序将是随机的。这是我编辑的程序版本：

```
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>

#define NUM_MESSAGES 3
int messages = 0;
void * send_segments(void *);
void * recv_acks(void *v);
pthread_mutex_t lock_it = PTHREAD_MUTEX_INITIALIZER;
pthread_mutex_t write_mutex = PTHREAD_MUTEX_INITIALIZER;
pthread_cond_t write_cond = PTHREAD_COND_INITIALIZER;

   int main(int argc, char**argv)
  {

     pthread_t t_send_segments, t_recv_acks;

     pthread_create(&t_send_segments, NULL, send_segments, (void*)NULL);
     pthread_create(&t_recv_acks,     NULL, recv_acks,     (void*)NULL);

     pthread_join(t_recv_acks, (void**)NULL);
     pthread_join(t_send_segments, (void**)NULL);

     //pthread_mutex_destroy(&lock_it);
     //pthread_cond_destroy(&write_it);
}

 void* send_segments(void *v) {
    for(;;) {
       pthread_mutex_lock(&lock_it);
       printf("s1\n");
       printf("s2\n");
       pthread_mutex_unlock(&lock_it);

       // wait for other thread
       pthread_mutex_lock(&write_mutex);
       pthread_cond_wait(&write_cond, &write_mutex);
       pthread_mutex_unlock(&write_mutex);

       pthread_mutex_lock(&lock_it);
       printf("s3\n");
       printf("s4\n");
       printf("s5\n"); 
       pthread_mutex_unlock(&lock_it);

       // wait for other thread
       pthread_mutex_lock(&write_mutex);
       pthread_cond_wait(&write_cond, &write_mutex);
       pthread_mutex_unlock(&write_mutex);

       if (messages > NUM_MESSAGES) return( NULL );
    }
    return 0;
 }

 void* recv_acks(void *v) {
    for(;;) {
       // write first response
       pthread_mutex_lock(&lock_it);
       printf("r1\n");
       pthread_mutex_unlock(&lock_it);

       // signal other thread
       pthread_mutex_lock(&write_mutex);
       pthread_cond_signal(&write_cond);
       pthread_mutex_unlock(&write_mutex);

       // write second response
       pthread_mutex_lock(&lock_it);
       printf("r2\n\n");
       // increment count before releasing lock, otherwise the other thread
       // will be stuck waiting for a write_cond signal
       messages++;
       pthread_mutex_unlock(&lock_it);

       // signal other thread
       pthread_mutex_lock(&write_mutex);
       pthread_cond_signal(&write_cond);
       pthread_mutex_unlock(&write_mutex);

       if (messages > NUM_MESSAGES) return(NULL);
    } 
    return 0;
 } 
```

如果我运行这个程序，我会得到以下输出（请注意，为了清楚起见，我在 r2 之后添加了第二个换行符）：

```
leif@indurain:~/tmp$ ./test
s1
s2
r1
s3
s4
s5
r2

s1
s2
r1
s3
s4
s5
r2

s1
s2
r1
s3
s4
s5
r2

s1
s2
r1
s3
s4
s5
r2

leif@indurain:~/tmp$ 
```

# objective-c - 为什么我的工作表没有附加到运行它的窗口？

> ID：671204
> 
> 赞同：26
> 
> 时间：2009-03-22T15:59:58.547
> 
> 标签：objective-c, cocoa, nswindow, nswindowcontroller, cocoa-sheet

我有一个包含两个窗口的 NIB，一个是应用程序的主窗口在启动时可见，另一个是自定义工作表（因此在启动时不可见）。当需要工作表时，我的控制器调用：

`[NSApp beginSheet: sheetWindow modalForWindow: mainWindow modalDelegate: self didEndSelector: @selector(didEndSheet:returnCode:contextInfo:) contextInfo: nil];`

它显示工作表窗口并启动一个模态会话，*但*该窗口有一个标准的 Aqua 标题栏，没有“连接”到主窗口，并且可以像常规窗口一样移动。不用说，这是不可取的:-)。为什么工作表窗口不会“弹出”它运行的窗口，就像工作表通常以这种方式开始时所做的那样？

我想知道我在控制器内部开始工作表这一事实是否`-awakeFromNib`会产生影响，所以我将工作表移动到稍后可以触发的按钮动作上。这并没有改变行为。我还没有想过要尝试什么。我的目标是 10.5 SDK，使用 Xcode 3.1。

**编辑：**所以看起来我已经创建了一个模式对话框；工作表和应用程序模式对话框都使用该`-beginSheet:modalForWindow:modalDelegate:didEndSelector:contextInfo:`方法启动。但是我如何指示我的窗口应该是一个工作表而*不是*模式对话框？

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2009-03-23T08:22:08.980

几天前发生在我身上：

*   您忘记设置窗口控制器的*窗口*出口（*文件的 Nib 文件的所有者*）。正如 Nathan 所指出的，您可能会看到该`-[NSWindowController window]`方法返回 nil。
*   您还必须取消选中工作表的*启动时可见*选项。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-22T17:04:22.387

如果 mainWindow 为 nil，则工作表将显示为窗口/对话框。

# uml - 在 Visio 2003 中使用 UML 2.0 的最佳方式是什么？

> ID：671205
> 
> 赞同：6
> 
> 时间：2009-03-22T16:01:05.690
> 
> 标签：uml, visio

Visio 2003 使用UML 1.4，这意味着UML 2.0 中的一些原型根本不存在，它们需要通过手绘建模（我可能会使用Photoshop）。有谁知道来自 Microsoft 的更新或在 Visio 2003 中包含 UML 2.0（完整 - 不仅仅是类图）的插件？

我找到了这个包：[http://www.sdl.sandrila.co.uk/](http://www.sdl.sandrila.co.uk/)但从他们的“示例”屏幕截图来看，我将远离。如果他们不知道如何使用 UML，如果他们能正确实现它，我会感到惊讶；）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-22T17:01:47.273

这套用于 UML 2.0 的 Visio 模具和模板非常棒：

[http://softwarestencils.com/uml/index.html](http://softwarestencils.com/uml/index.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T12:53:28.107

如果不清楚，Microsoft 将永远不会更新对 UML 的 Visio 支持。一段时间以来，他们还没有将 Visio 视为一种软件工程工具。

我不怪他们。它甚至没有很好地处理它“支持”的 UML 部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T17:01:25.387

我正在使用[Pavel Hruby](http://www.softwarestencils.com/uml/index.html)的 UML 2.0 符号。也许你会发现它们也很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T02:44:00.207

Visio 的好处在于它只是一个绘图程序，而不是一个建模环境。所以就自己编线吧。Visio 几乎可以绘制您能想到的任何线路时间。但真正的答案是已经检查过的那个。现在微软“支持”UML，也许他们会提供更好的工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-27T12:01:23.363

这些屏幕截图只是示例图表，Sandrila SDL 不会对图表执行那种严格程度的要求。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-22T16:56:01.360

> 我找到了这个包：[http](http://www.sdl.sandrila.co.uk/) ://www.sdl.sandrila.co.uk/但从他们的“示例”屏幕截图来看，我会远离。如果他们不知道如何使用 UML，如果他们能正确实现它，我会感到惊讶；）

这似乎有点苛刻 - 在少数 UML2 屏幕截图中（而不是作为工具支持的其他符号的示例，例如 SDL、MCL 和 TTCN），您认为哪些是不正确的？图表非常难看，并且使用别名字体和线条，但这是 Visio 的功能，与模板无关。

就使用 UML 可以做什么而言，使用真正的 UML2 工具要比使用 Visio 好得多。Enterprise Architect 是一个便宜的，它背后确实有一个真正的 UML 模型。（很高兴能够说更昂贵的工具具有更少的 UI 错误和陷阱，但事实并非如此，并且大多数工具在抛光和可用性方面远远落后于更简单的图形工具，如 OmniGraffle 或 Visio）

# bash - 无处不在的变量

> ID：671211
> 
> 赞同：0
> 
> 时间：2009-03-22T16:08:12.740
> 
> 标签：bash, unix, variables

如何设置适用于任何地方的变量？我的 .bashrc 有：

```
Questions='/Users/User/Stackoverflow/Questions'

Address='My address' 
```

我的文件有：

```
$Questions
$Addres 
```

Shell 中的命令“$ cat my_file”打印“$Questions”和“$Address”，而不是“/Users/User/Stackoverflow/Questions”和“我的地址”。我想要变量的其他地方是电子邮件和浏览器。但我不能让他们工作。

*我怎样才能让我的变量在每个程序中都起作用？*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-22T16:16:21.800

`cat`不解释变量。它只是逐字节地打印出文件的内容。

如果您希望能够使用 打印出变量的值`my_file`，我建议将其更改为读取

```
echo "$Questions"
echo "$Address" 
```

然后你可以“源”它（有点像在当前的 shell 环境中运行它）

```
$ source my_file 
```

或者

```
$ . my_file 
```

您可能还必须使用`export`in `.bashrc`，如下所示：

```
export Questions='/Users/User/Stackoverflow/Questions'
export Address='My address' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T16:31:27.643

> 我怎样才能让我的变量在每个程序中都起作用？

你不能。Bash 和 cat 是两个独立的程序。您设置了一个 bash 变量，这并不意味着 cat 会像 bash 一样来解释它。`$VARNAME`是一种 shell 语法，cat 是一个不同的程序，它与 shell 几乎没有任何共享。

您可以将 shell 变量导出为环境变量，但 cat 没有被编程为替换任何文本模板，它超出了它的用途。

相反，您可以使用`sed`执行文本模板替换：

```
sed -e "s|@QUESTIONS@|$Questions|g; s|@ADDRESS@|$Address|g" file.txt 
```

这将用和shell 变量的内容替换文件中的所有实例`@QUESTIONS@`和。请注意，这些 shell 变量不能包含任何管道 ("|") 符号，因为建议使用它们作为分隔符。`@ANSWERS@``$Questions``$Address`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T06:22:00.207

您可以使用一些讨厌的黑客来让“猫”工作：

eval "$(printf 'cat << END\n%s\nEND' "$(< foo)")"

其中“foo”是包含您希望扩展 bash 参数的文本的文件。该解决方案基本上只是将文本转换为此处的文档，该文档确实扩展了 bash 参数。

```
cat <<END
[your text]
END 
```

* * *

限制：

文本文件中不能有一行只有“END”，否则解决方案会中断。它会认为文本文件中带有“END”的行结束了here文档而不是printf命令中的END，并且输出将提前结束。

待定：

这是你**不应该做的事情**。如果您想制作模板文件，请查找为此构建的模板系统。你不应该强暴 bash 去做一些它不适合做的事情。它是一种脚本语言，而不是模板系统。它的构建是为了解析具有明确定义的语法的脚本，而不是任意的文本文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-22T16:11:49.877

你不能。为了做到这一点，您需要每个电子邮件客户端编写者、每个浏览器编写者、每个实用程序编写者的合作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-22T16:10:53.573

键入`env`查看变量是否存在。

如果是这样，请尝试使用`${VAR_NAME}`.

重新迭代后，我现在看到了您的问题。你只是不能有一个文本文件，`cat`它的内容和期望环境变量被解析。你就是不能。

如果它是一个 bash 脚本文件，并且您要运行它，您可以`echo`取出变量，然后按照您的意愿对其进行解析。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-22T16:38:47.017

根据您对[Paul Tomblin 的回答](https://stackoverflow.com/questions/671211/variables-that-work-everywhere/671216#671216)的评论：

> 你确定吗？我听说你可以在 Emacs 中拥有各种东西，比如 RSS 阅读器。也许，有更好的合作。我是 VIM 用户，所以我不知道。如果有人知道 Emacs 是否在程序之间有很好的合作，请不要犹豫，分享你的知识。– UnixBasics（3 分钟前）

你想要（或者你会满意）一个可以扩展你的环境变量的编辑器吗？

这是一个不同的（即更简单和可能的）问题。

* * *

在纯理论层面上，我想一个被黑的文件系统可以做你想做的事，但它肯定会破坏各种二进制存储。因此，我们为文本（可扩展）和非文本文件类型添加了文件系统标志。而且我们需要一种方法让文件系统知道要扩展的变量集，以及令人作呕的......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T23:37:21.580

只需添加到您的 ~/.profile 或 ~/.bashrc：

```
export Questions='/Users/User/Stackoverflow/Questions'
export Address='My address' 
```

# eclipse-plugin - Eclipse RCP - 如何打开启动配置对话框

> ID：671212
> 
> 赞同：4
> 
> 时间：2009-03-22T16:08:41.973
> 
> 标签：eclipse-plugin, eclipse-rcp

如何通过命令在 RCP 应用程序中打开启动配置对话框（例如在项目上按 mouse_right - 运行方式 - 运行配置）？或任何其他方式，但首选命令。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T05:06:16.083

如果您`ALT+SHIFT+F1`在“创建、管理和运行配置”中键入“”，[插件 Spy](http://www.eclipse.org/pde/incubator/spy/)会告诉您它是[`LaunchConfigurationsDialog`](http://kickjava.com/src/org/eclipse/debug/internal/ui/launchConfigurations/LaunchConfigurationsDialog.java.htm)

在 Eclipse 源代码中快速搜索表明它是通过[`DebugUITools.openLaunchConfigurationDialogOnGroup()`](http://kickjava.com/src/org/eclipse/debug/ui/DebugUITools.java.htm#367)

```
 final int[] result = new int[1];
         Runnable JavaDoc r = new Runnable JavaDoc() {
             /**
              * @see java.lang.Runnable#run()
              */
             public void run() {
                 LaunchConfigurationsDialog dialog = (LaunchConfigurationsDialog) LaunchConfigurationsDialog.getCurrentlyVisibleLaunchConfigurationDialog();
                 if (dialog != null) {
                     dialog.setInitialSelection(selection);
                     dialog.doInitialTreeSelection();
                     if (status != null) {
                         dialog.handleStatus(status);
                     }
                     result[0] = Window.OK;
                 } else {
                     dialog = new LaunchConfigurationsDialog(shell, DebugUIPlugin.getDefault().getLaunchConfigurationManager().getLaunchGroup(groupIdentifier));
                     dialog.setOpenMode(LaunchConfigurationsDialog.LAUNCH_CONFIGURATION_DIALOG_OPEN_ON_SELECTION);
                     dialog.setInitialSelection(selection);
                     dialog.setInitialStatus(status);
                     result[0] = dialog.open();
                 }
             }
         };
         BusyIndicator.showWhile(DebugUIPlugin.getStandardDisplay(), r);
         return result[0]; 
```

这应该给你足够的材料来开始。

[![](https://i.stack.imgur.com/Ydp8X.png)](https://i.stack.imgur.com/Ydp8X.png)
[（来源：[eclipse.org](http://help.eclipse.org/stable/topic/org.eclipse.platform.doc.isv/guide/images/lcd.png)）]

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-11T12:43:18.700

根据 VonC 的回答，我执行了以下操作，其中`config`只是我的`ILaunchConfigurationWorkingCopy`and`mode`的实例`"run"`：

```
DebugUITools.openLaunchConfigurationDialog(
                PlatformUI.getWorkbench().getActiveWorkbenchWindow().getShell(),
                config,
                DebugUITools.getLaunchGroup(savedConfig, mode).getIdentifier(),
                null); 
```

# eclipse - 日食着色：所有选择的背景颜色的首选项目是什么

> ID：671219
> 
> 赞同：5
> 
> 时间：2009-03-22T16:14:11.663
> 
> 标签：eclipse, colors, themes

在 Eclipse 中，当单击一个标识符（函数名或变量等）时，该标识符的背景和该标识符的所有其他出现都被赋予不同的背景颜色。

谁能告诉我，为此更改背景颜色的首选项是什么。

（最后一次在我的暗日食设置中保留）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-22T16:31:38.690

有一个名为**Annotations**的部分允许您配置**Occurrences**的背景颜色。*您可以在General* -> *Editors* -> *Text Editors* -> *Annotations*下的 Preferences 中找到它。

我必须重新启动 Eclipse 才能看到我的更改——在 Preferences 窗口中简单的**Apply**是不够的（使用 Eclipse SDK 3.4.1）。

# .net - .NET UserControl 的 MouseLeave 奇怪行为

> ID：671223
> 
> 赞同：0
> 
> 时间：2009-03-22T16:16:13.373
> 
> 标签：.net, vb.net, winforms, mouseleave

我有一个用户控件（.NET 1.1 Winforms），它有一个可点击的图片框作为按钮。

由于我有很多同时可见的用户控件，我认为如果我只在鼠标悬停在用户控件上时显示图片框并隐藏它会很好。

为此，我处理 UserControl 的 MouseEnter 和 MouseLeave 事件，隐藏和显示图片框。这很好用。

但是当可点击的图片框可见时，我无法再点击它（手形光标消失了，点击事件没有触发）。

经过一些测试，我意识到如果在 MouseLeave 处理程序上评论所有对我的图片框执行某些操作的内容......这样图片框是可点击的。

**我没有使用正确的事件？**

**还有另一种方法可以做到这一点吗？**

这是代码...

```
Private Sub NodoEstablo_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Me.pictAdd.Visible = False 
End Sub

Private Sub NodoEstablo_MouseEnters(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.MouseEnter        
    Me.pictAdd.Visible = True
End Sub 
```

有问题的事件处理程序：

```
Private Sub NodoEstablo_MouseLeaves(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.MouseLeave
    Me.pictAdd.Visible = False
End Sub 
```

更新：如果我在 MouseLeave 上调整图片框的大小（只是为了做某事），它就可以工作。到目前为止，更改 MouseLeave 中的 Visible 和 Location 阻止我单击图片框。:S

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-22T19:09:26.173

当鼠标移到您的按钮上时，会发生类似以下的情况：

1.  鼠标离开用户控件（即使它仍在控件内）并进入图片框
    *   您的`MouseLeave`事件处理程序触发，使图片框不可见
2.  因为picturebox不可见，鼠标离开picturebox进入usercontrol
    *   您的`MouseEnter`事件处理程序触发，使图片框可见
3.  因为图片框现在可见，所以过程从头开始

当我测试您的代码时，“按钮”不断闪烁（因为它的可见性一直在切换）并且无法保持足够长的可见性以记录任何点击。

解决此问题的一种方法是将您的`MouseLeaves`处理程序修改为如下所示：

```
Private Sub NodoEstablo_MouseLeaves(ByVal sender As System.Object, _
                                    ByVal e As System.EventArgs) _
                                    Handles MyBase.MouseLeave
    If Not ClientRectangle.Contains(PointToClient(Cursor.Position)) Then
        Me.pictAdd.Visible = False
    EndIf
End Sub 
```

这将检查以确保在使按钮消失之前鼠标实际上已经离开了控件。

改变图片框的大小可能打破了上述循环，但它并没有解决根本问题。

以下是需要考虑的其他一些事情（与您的问题无关）：

*   我认为建议您只覆盖`OnMouseLeaves`用户控件中的 , etc 方法，而不是订阅相应的事件。
*   Remember that handling controls this way can make it impossible for someone to use your application with a keyboard only. (i.e. the user can't `Tab` to your button and press `Enter`)

# c# - 如何在 ASP.NET MVC 中处理会话数据

> ID：671228
> 
> 赞同：2
> 
> 时间：2009-03-22T16:18:00.407
> 
> 标签：c#, asp.net-mvc, session

假设我想存储一个`language_id`在会话中调用的变量。我想我也许可以做以下事情：

```
public class CountryController : Controller
{ 
    [WebMethod(EnableSession = true)]  
    [AcceptVerbs(HttpVerbs.Post)]  
    public ActionResultChangelangue(FormCollection form)
    {
        Session["current_language"] = form["languageid"];
        return View();    
    } 
} 
```

但是当我检查会话时，它总是为空。怎么来的？在哪里可以找到有关在 ASP.NET MVC 中处理会话的一些信息？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T20:52:34.463

*与问题本身不严格相关*，但更多地作为保持控制器（合理）强类型和清洁的一种方式，我还推荐一个像类一样的 Session 外观，它将任何会话信息包装在其中，以便您在一个不错的方式。

**例子：**

```
public static class SessionFacade
{
  public static string CurrentLanguage
  {
    get
    {
      //Simply returns, but you could check for a null
      //and initialise it with a default value accordingly...
      return HttpContext.Current.Session["current_language"].ToString();
    }
    set
    {
      HttpContext.Current.Session["current_language"] = value;
    }
  }
} 
```

**用法：**

```
public ActionResultChangelangue(FormCollection form)
{
  SessionFacade.CurrentLanguage = form["languageid"];
  return View();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T17:57:38.437

它应该有效，但不是推荐的策略。也许会话状态在 IIS 或 ASP.NET 中已关闭？请参阅[此答案及其评论](https://stackoverflow.com/questions/560084/session-variables-in-asp-net-mvc/560115#560115)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T17:36:18.220

您可能还必须在 web.config 中启用会话。这里还有一篇关于会话状态和状态值的文章：

[http://www.davidhayden.com/blog/dave/archive/2008/02/06/ASPNETMVCFrameworkSessionStateStateValueWCSF.aspx](http://www.davidhayden.com/blog/dave/archive/2008/02/06/ASPNETMVCFrameworkSessionStateStateValueWCSF.aspx)

希望这可以帮助。

# c# - 使用 LINQ 扩展在 foreach 上键入约束

> ID：671229
> 
> 赞同：2
> 
> 时间：2009-03-22T16:18:38.470
> 
> 标签：c#, .net, linq

我在 SO 上的某处看到了一种方法，用于将从 foreach 循环返回的项目限制为某种类型，如果我没记错的话，使用 IEnumerable 上的 LINQ 扩展和用于类型检查的 lambda。我再也找不到它了，任何人都可以建议这是如何实现的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-22T16:24:34.073

你在找这个吗？

```
public static IEnumerable<TResult> OfType<TResult>(
    this IEnumerable source
) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-22T16:35:30.613

您可以通过调用 Where 扩展方法来做到这一点，如下所示：

```
foreach(var x in theCollection.Where(i => i.GetType() == typeof(DesiredType))
{
     // Do something to x
} 
```

但这非常有用，以至于它内置在 .NET 框架中，这就是 Chris 在上面所指出的。IEnumerable 有一个名为 OfType 的扩展方法，[在此处](http://msdn.microsoft.com/en-us/library/bb360913.aspx)记录。

要使用它，您需要执行以下操作：

```
foreach(var x in theCollection.OfType<int>())
{
     // Do something to x
} 
```

# linq - Linq/nHibernate 替代品/等价物？

> ID：671231
> 
> 赞同：1
> 
> 时间：2009-03-22T16:19:05.053
> 
> 标签：linq

我听说过一个非常好的 Linq/NHibernate 替代 OR 桥，但 darnit 不记得它的名字了。我记得他们的网站上有开发人员提供的非常有启发性的截屏视频，该工具可以用作 Linq 的替代品。

帮助！任何指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T04:02:03.413

我没有用过这个，只评估了它：[LightSpeed](http://www.mindscape.co.nz/products/LightSpeed/)。在我尝试过的所有 ORM 产品中，这是唯一一款安装完美并处理我们的 SQL 2008 数据库而没有抱怨的产品。漂亮的设计师，真的——MS 可以向他们学习。

开发人员很友好，响应速度非常快，并提供夜间构建。如果我了解他们的许可，它的价格便宜得离谱。总的来说，他们真的让你想购买他们的产品。

（不，我与他们无关，只是印象深刻。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T18:19:20.020

我想你在想[SubSonic](http://www.subsonicproject.com)

# linq - LINQ 如何在内部工作？

> ID：671235
> 
> 赞同：62
> 
> 时间：2009-03-22T16:23:44.870
> 
> 标签：linq

我喜欢在 .NET 中使用 LINQ，但我想知道它在内部是如何工作的？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-03-22T18:42:14.070

询问 LINQ 的特定方面更有意义。这有点像问“Windows 是如何工作的”。

从 C# 的角度来看，LINQ 的关键部分对我来说是：

*   表达式树。这些是将代码表示为数据。例如，表达式树可以表示“获取一个字符串参数，调用它的 Length 属性，然后返回结果”的概念。这些作为*数据*而不是作为编译代码存在的事实意味着 LINQ 提供程序（例如 LINQ to SQL）可以分析它们并将它们转换为 SQL。
*   Lambda 表达式。这些是这样的表达式：

    ```
    x => x * 2
    (int x, int y) => x * y
    () => { Console.WriteLine("Block"); Console.WriteLine("Lambda"); } 
    ```

    Lambda 表达式转换为*委托*或*表达式树*。

*   匿名类型。这些是这样的表达式：

    ```
    new { X=10, Y=20 } 
    ```

    这些仍然是静态类型的，只是编译器为您生成一个不可变的类型，其中包含属性`X`和`Y`. 这些通常与`var`允许从其初始化表达式推断局部变量的类型一起使用。

*   查询表达式。这些是这样的表达式：

    ```
    from person in people
    where person.Age < 18
    select person.Name 
    ```

    这些由 C# 编译器翻译成“普通”C# 3.0（即不使用查询表达式的形式）。之后应用重载解决方案等，这绝对是能够使用具有多种数据类型的相同查询语法的关键，而编译器不需要任何类型的知识，例如 Queryable。上面的表达式将被翻译成：

    ```
    people.Where(person => person.Age < 18)
          .Select(person => person.Name) 
    ```

*   扩展方法。这些是静态方法，可以像第一个参数类型的实例方法一样使用。例如，这样的扩展方法：

    ```
    public static int CountAsciiDigits(this string text)
    {
        return text.Count(letter => letter >= '0' && letter <= '9');
    } 
    ```

    然后可以像这样使用：

    ```
    string foo = "123abc456";
    int count = foo.CountAsciiDigits(); 
    ```

    请注意， 的实现`CountAsciiDigits`使用了另一种扩展方法，`Enumerable.Count()`.

这是大多数相关的*语言*方面。然后是标准查询运算符的实现，在 LINQ 提供程序（例如 LINQ to Objects 和 LINQ to SQL 等）中。我有一个关于如何相当简单地实现 LINQ to Objects 的演示 - 它位于 C#的[“会谈”](http://csharpindepth.com/Talks.aspx)页面上在深度网站。

LINQ to SQL 等提供程序的工作方式通常是通过`Queryable`类。它们的核心是将表达式树转换为其他查询格式，然后使用执行这些进程外查询的结果构造适当的对象。

这是否涵盖了您感兴趣的所有内容？如果您还有什么特别想知道的，只需编辑您的问题，我就可以试一试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-22T17:07:50.910

LINQ 基本上是以下 C# 3.0 离散特性的组合：

*   局部变量类型推断
*   自动属性（未在 VB 9.0 中实现）
*   扩展方法
*   lambda 表达式
*   匿名类型初始化器
*   查询理解

有关到达那里的旅程 (LINQ) 的更多信息，请观看 Anders 在 LANGNET 2008 中的视频：

[http://download.microsoft.com/download/c/e/5/ce5434ca-4f54-42b1-81ea-7f5a72f3b1dd/1-01%20-%20CSharp3%20-%20Anders%20Hejlsberg.wmv](http://download.microsoft.com/download/c/e/5/ce5434ca-4f54-42b1-81ea-7f5a72f3b1dd/1-01%20-%20CSharp3%20-%20Anders%20Hejlsberg.wmv)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-22T17:07:45.047

在简单的表单中，编译器接受您的代码查询并将其转换为一堆通用类和调用。下面，在 Linq2Sql 的情况下，使用 DbCommand、DbDataReader 等构建和执行动态 SQL 查询。

假设你有：

```
var q = from x in dc.mytable select x; 
```

它被转换为以下代码：

```
IQueryable<tbl_dir_office> q = 
    dc.mytable.Select<tbl_dir_office, tbl_dir_office>(
        Expression.Lambda<Func<mytable, mytable>>(
            exp = Expression.Parameter(typeof(mytable), "x"), 
            new ParameterExpression[] { exp }
        )
    ); 
```

大量的泛型，巨大的开销。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-22T16:50:55.303

基本上 linq 是一些语言工具（编译器）和一些框架扩展的混合体。因此，当您编写 linq 查询时，它们会使用适当的接口（例如 IQuerable）来执行。另请注意，运行时在 linq 中没有任何作用。

但是很难在简短的回答中公正地对待 linq。我建议你读一些书让自己沉浸其中。我不确定这本书是否会告诉您 Linq 的内部信息，但[Linq in Action](http://linqinaction.net/)提供了很好的实践经验。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2014-03-13T13:26:37.580

我有一个小的 C# 程序，它演示了 C# 中 LINQ 的实现。

```
class Program
{
    static void Main(string[] args)
    {
        //Eventhough we call the method here, it gets called ONLY when the for loop is executed
        var Cities = LinQFunction(new List<string>() { "Bangalore", "Mysore", "Coorg", "Tumkur", "Kerala", "TamilNadu" });

        //LinQFunction() gets callled now
        foreach(var city in Cities)
        {
            Console.WriteLine(city);
        }
    }

   //This function is called ONLY when the foreach loop iterates and gets the item from the collection
   static IEnumerable<string> LinQFunction(List<string> cities)
    {
        foreach (var item in cities)
        {
            //Return each 'item' at a time 
            yield return item;
        }
    }
} 
```

使用适当的断点。

# iphone - 如何以这种方式加载网页？

> ID：671239
> 
> 赞同：1
> 
> 时间：2009-03-22T16:25:54.227
> 
> 标签：iphone, uiwebview, ios-simulator

在 UIWebView 中，我提供了指向[http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)的链接。在模拟器中，TOC 不加载。它出现了一个空间，然后很快就隐藏了。但是，在 iPhone 上，TOC 会加载并且不会隐藏。用户必须单击隐藏目录链接。iPhone没有的模拟器在做什么？有没有办法在 iPhone 上做到这一点，所以 TOC 被隐藏了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T02:08:48.677

我不知道模拟器和设备之间的细微差别是什么（与cookie相关的东西？），但我建议您的解决方案应该是等到页面完成加载然后注入javascript来强制关闭TOC，与：

```
[webView stringByEvaluatingJavaScriptFromString:@"showHideTOC('hide');"]; 
```

# http - 您如何将 GET 和 POST 之外的任何内容从浏览器发送到您的 RESTful 应用程序？

> ID：671242
> 
> 赞同：6
> 
> 时间：2009-03-22T16:28:08.697
> 
> 标签：http, rest

我没有得到 RESTful 的东西。是的，我知道如何从浏览器向我的应用程序发送 GET 请求。它是通过 URL 链接。

```
<a href="/user/someone"> 
```

并且还可以通过form方法发送POST请求。

```
<form method="post"> 
```

除此之外，我知道浏览器有时会发送 HEAD 命令来确定页面状态，但最终用户无法控制。

那么我正在阅读的那些 DELETE 和 PUT 命令是什么？例如，如何从浏览器向 RESTful 应用程序发送 DELETE 命令？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-22T16:44:27.207

[HTML 4.01 规范](http://www.w3.org/TR/html401/)仅将[属性](http://www.w3.org/TR/html401/interact/forms.html#adef-method)描述`GET`为[有效值](http://www.w3.org/TR/html401/interact/forms.html#adef-method)。因此，在 HTML 中，目前无法描述除此之外的其他方法。`POST`[`method`](http://www.w3.org/TR/html401/interact/forms.html#adef-method)

但是[HTML 5 规范](http://www.w3.org/TR/html5/)（目前只是一个工作草案）确实将`PUT`和`DELETE`作为[有效值](http://www.w3.org/TR/html5/forms.html#attr-fs-method)。

查看用于 JavaScript ( ) 中异步请求的[XMLHttpRequest 对象规范](http://www.w3.org/TR/XMLHttpRequest/)（目前也只是一个工作草案`AJAX`），[它也支持`PUT`和`DELETE`方法](http://www.w3.org/TR/XMLHttpRequest/#method)，但没有说明当前浏览器的实际支持。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-22T16:50:48.940

为了模拟 PUT 和 DELETE，像 Rails 这样的框架会构建这样的表单：

```
<form action="/users/1/delete" method="post">
    <input type="hidden" name="_method" value="delete" />
    <input type="submit" value="Delete user 1" />
</form> 
```

这实际上是一个 POST 表单，但使用隐藏的`_method`输入来告诉服务器真正打算使用哪种方法。您也可以在任何其他 Web 框架上实现此支持。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-22T17:06:52.410

@C Moran 是对的：如果您想成为真正的 RESTful，浏览器不是理想的客户端，部分原因是缺少 和 之外的 HTTP`GET`方法`POST`。但是，如果你真的想通过浏览器来做，你可以使用 AJAX 发送`PUT`s 和`DELETE`s，例如[YUI 的连接管理器](http://developer.yahoo.com/yui/connection/)允许你指定以下任何 HTTP 方法：

*   `GET`
*   `POST`
*   `HEAD`
*   `PUT`
*   `DELETE`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-22T16:32:31.963

我听说并非所有浏览器都完全支持 DELETE 和 PUT（我没有检查它）。Rails 正在做解决方法——它发送带有包含真实方法的隐藏字段的 POST。所以它真的只使用 GET 和 POST 并且在服务器上它读取这个隐藏字段并对其做出反应。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-22T16:52:39.917

POST 不必通过表单。了解这一点以及 GET、PUT 和 DELETE 的最佳方法是使用 ReST 客户端发出 HTTP 请求并查看响应。[我建议你从http://restclient.org/](http://restclient.org/)下载漂亮的小 Python 客户端

当您熟悉 ReST 时，浏览器（到目前为止）不是您最好的工具。像上面这样的客户端将允许您“查看”您的 HTTP 请求和响应。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-22T16:44:09.003

基于 Flash 的应用程序（或 Flex）可以在较低级别上工作，例如开放式套接字。他们还可以执行 PUT/DELETE（尽管 Flex 尤其是已知存在 http 标头问题。所以我想我是说这取决于您的客户端技术。特别是，您可以嵌入一个小的 flash 对象来进行通信如果您的浏览器不支持它（或者您不想实现跨浏览器支持）。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2020-12-09T12:09:05.507

`DELETE`并且`PUT`是 HTTP 动词，比如 REST 命令将删除或更新服务器上的对象。

在浏览器中使用它们可以通过不同的方式完成。您不能通过 HTML 发送它们，但如果您想以编程方式使用它们，您可以发送 JavaScript Ajax 请求。

如果您只想探索 API 或测试一些调用，并且想从浏览器执行此操作，则可以使用[RESTED](https://github.com/esphen/RESTED)等浏览器插件for firefox。

对于手动和自动测试，您可以使用 Postman 作为功能齐全的 API 测试环境。

在 Windows 上，您可以使用 PowerShell 脚本[httprepl](https://docs.microsoft.com/en-us/aspnet/core/web-api/http-repl/)发送不同的 HTTP RESTful API 用法。

# eclipse - Eclipse 配置问题

> ID：671246
> 
> 赞同：0
> 
> 时间：2009-03-22T16:30:39.097
> 
> 标签：eclipse, configuration, package-managers

最近，我尝试更频繁地使用 Eclipse，但到目前为止我一直回避它，因为我发现安装新软件包非常困难。每当我找到并尝试安装新软件包时，错误面板都会闪烁一批配置错误。它需要这个或那个包来安装这个。当我找到那个包裹时，原来那个包裹需要另一个我没有的包裹……这对我来说是一个令人生畏的问题。

这些天我遇到了这些配置错误：

> 当前配置包含错误，此操作可能会产生不可预知的结果。
> 
> ```
>  JST Web Core Patches requires feature "org.eclipse.jst.web_core.feature ".
>   WST Server Core Patches requires feature "org.eclipse.wst.server_core.feature". 
> ```

具体来说，我正在寻求帮助以找出如何解决这些错误。（Google 中没有任何关于“org.eclipse.jst.web_core.feature”的信息页面。）

不过，更一般地说，我想知道我对 Eclipse 的内部包管理系统有哪些替代方案？（如果我做错了，并且内部系统并不像我认为的那么困难，也请告诉我！）我听说过 Pulse，但没怎么用过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T17:54:36.743

你在使用 3.4 Ganymede 吗？.. 应该为您找出并选择依赖项.. 在 3.1 中，“更新”窗口中有一个“选择必需”按钮，它应该为您找到并选择所有依赖项

# haskell - 学习 Haskell 等纯函数式语言背后的理论的参考资料？

> ID：671257
> 
> 赞同：13
> 
> 时间：2009-03-22T16:36:04.903
> 
> 标签：haskell, functional-programming

在学习 Haskell 时，我有一种感觉，作者并不总是告诉我一切，所以要真正理解它，我想知道类型系统、monad 和类似概念背后的理论。

这些概念大部分来自我听说过的类别理论，那么关于这个主题和相关主题的好书/网站有哪些？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-22T16:48:40.160

[Philip Wadler](http://homepages.inf.ed.ac.uk/wadler/)和[Simon Peyton Jones](http://research.microsoft.com/en-us/people/simonpj/)的论文应该让你开始了解 Haskell 背后的理论。[Simon Peyton Jones的《函数式编程语言的实现》](http://research.microsoft.com/en-us/um/people/simonpj/papers/slpj-book-1987/index.htm) （可在线获得）一书相当古老，但仍然很有趣。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-22T16:50:02.653

我建议查看有关该主题的一些研究论文。Philip Wadler 的“理解单子”和“函数式编程的单子”是理解单子的两个很好的起点。

您可以在[http://www.haskell.org/haskellwiki/Research_papers](http://www.haskell.org/haskellwiki/Research_papers)找到大多数链接。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-22T20:29:12.597

Haskell 有一个 Hindley Milner 类型系统。有关更多详细信息，请参阅[Wikipedia](http://en.wikipedia.org/wiki/Type_inference)和[此博客文章](http://www.codecommit.com/blog/scala/what-is-hindley-milner-and-why-is-it-cool)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-03T15:47:06.150

也许您会发现这篇[博文](http://dekudekuplex.wordpress.com/2009/01/16/learning-haskell-through-category-theory-and-adventuring-in-category-land-like-flatterland-only-about-categories/)很有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-08-03T22:12:28.470

如果您真的想了解函数式语言，Lambda 演算绝对是不可缺少的。我可以推荐[Henk Barendregt 的介绍](ftp://ftp.cs.kun.nl/pub/CompMath.Found/lambda.pdf)，以及他的[书](http://mathgate.info/cebrown/notes/barendregt.php)（全文在线）。

# php - 管理大量文件的技巧？

> ID：671260
> 
> 赞同：14
> 
> 时间：2009-03-22T16:38:05.100
> 
> 标签：php, directory-structure, file-management

关于大型项目中的文件管理和存储，这里有一些非常好的问题。

> [在 DB 中存储图像 - 是还是不是？](https://stackoverflow.com/questions/3748/storing-images-in-db-yea-or-nay)
> [您会将二进制数据存储在数据库中还是文件系统中？](https://stackoverflow.com/questions/662488/would-you-store-binary-data-in-database-or-in-file-system)

第一个有一些深刻的见解，在我的项目中，我决定走文件路线而不是数据库路线。

反对使用文件系统的一个要点是备份。但是在我们的系统中，我们有一个很棒的备份方案，所以我并不担心。

下一个路径是如何存储实际文件。而且我考虑过让文件的位置始终保持静态，并在数据库方面创建一个虚拟目录系统。所以文件的链接不会改变。

我正在构建的系统将具有一个全局文件管理，因此所有用户都可以访问所有文件。但是许多走文件路线的人谈论物理目录大小（例如，如果所有文件都在一个目录中）

所以我的问题是，在为这些静态文件创建文件夹时有哪些技巧或最佳实践方法，或者我根本不应该走虚拟目录路线。

（如果有帮助的话，该项目位于 LAMP 堆栈（PHP）上）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-22T16:49:11.207

一种方法是为每个文件分配一个唯一编号并使用它来查找实际文件位置。然后，您可以使用该编号将文件分发到文件系统中的不同目录中。例如，您可以使用类似这样的方案：

`/images/{0}/{1}/{2}`

> `{0}: file_number % 100`
> `{1}: (file_number / 100) % 100`
> `{2}: file_number`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-22T17:47:48.520

前段时间，我在一个托管大量文件的网站上遇到了这个问题。我们所做的是获取一个 GUID（这也是文件的主键字段）（例如 BCC46E3F-2F7A-42b1-92CE-DBD6EC6D6301）并存储如下文件：/B/C/C/BCC46E3F-2F7A-42b1 -92CE-DBD6EC6D6301/文件名.ext

这有一定的优势：

*   您可以在多个服务器上扩展文件服务器（并为每个服务器分配特定目录）
*   您不必重命名文件
*   您的目录保证是唯一的

希望这可以帮助！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-22T16:50:42.043

为了避免在单个目录中创建过多的条目，您可能希望基于文件名的片段创建目录。例如，如果您有一个名为 d7f5ae9​​b7c5a.png 的文件，您可能希望将其存储在 media/d7/f5/d7f5ae9​​b7c5a.png 中。如果您的文件名都是十六进制的，那么这会将单个目录中的条目数限制为 256，直到最后一级。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-22T18:08:25.150

关于apache和PHP如何管理文件我不能说太多，但是关于ext3文件系统我可以说一些。ext3 在同一目录下的大量文件似乎没有问题。我已经用多达一百万个文件对其进行了测试。在创建目录之前，确保在文件系统上启用了 dir_index 选项。您可以通过运行 dump2fs 进行检查，并通过运行 tune2fs 更改此选项。将文件散列到子目录树中仍然很有用，因为命令行工具在列出目录内容时仍然存在问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-22T17:02:16.243

1.  一个用户图像 ~ 100kb，所以让数据库中有 10 000 个用户，每个用户平均有 5 个图像，所以我们将有 5 TB 的 DB，每个图像输出将通过一个 DB 执行，这个额外的 DB 流量将减少一般数据库服务器性能。...您可以使用数据库集群来避免这种情况，但假设它很昂贵

2.  用户报告关于实时数据库的错误，（在测试中 - 一切正常），您将如何在开发人员机器上创建转储并解压它？需要多少时间？

3.  在某一时刻，您可以决定将图像放在某个 CDN 上，您的源代码会发生什么变化？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-22T16:51:29.047

我通常采用这种方法：

为您的应用程序提供一个全局设置变量，该变量指向您存储上传文件的文件夹。在您的数据库中存储文件的相对路径（相对于设置变量指向的内容）。

因此，如果文件位于 /www/uploads/image.jpg，则您的设置变量指向 /www/uploads，您的数据库行包含 image.jpg。这是一种将系统目录结构与应用程序分离的灵活方式。

此外，您可以根据与这些相关的数据库表对目录中的文件存储进行分段。假设您有一个表 user_reports 和一个表 user_photos。您将与 user_reports 相关的文件存储在 /www/uploads/user_reports 中。如果您有大量用户上传，您可以进一步实现碎片化。假设用户在 2009 年 3 月 20 日上传了一个文件，该文件名为 report.pdf，因此您将其存储在 /www/uploads/user_reports/2009/03/20/report.pdf 中。

# silverlight - 你能以编程方式告诉 Media Element 停止在 silverlight 中下载文件吗？

> ID：671262
> 
> 赞同：0
> 
> 时间：2009-03-22T16:39:39.277
> 
> 标签：silverlight, mediaelement

我在服务器上有一个完整的电影文件。我想从那个文件创建一堵媒体剪辑墙。我可以通过设置剪辑开始的位置并监听告诉我何时停止播放的标记来创建剪辑功能。但是，为了明显的性能和设计影响，我想让 Media Element 在我停止播放剪辑时停止下载文件的其余部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T18:23:06.540

不幸的是，除了将 Source 设置为 null （我假设这不是您想要的）之外，您无法直接控制 MediaElement 下载的内容。

您可以使用 HTTPWebRequest 下载文件的一部分，复制返回的 Stream 并将其设置为 MediaElement（通过 SetSource），但这仅在剪辑接近文件开头时才有效。

也可能有服务器端解决方案： - 将每个剪辑保存为单独的文件（预先工作，但会尽量减少不必要的下载）。Expression Encoder 之类的工具可能能够帮助您快速批量完成此操作。- 创建一个接受文件范围的服务器入口点，并且只将数据发送到某个点。这是一项非常重要的工作，但它使客户端完全不知道没有发送整个文件。

希望这会有所帮助，抱歉，我没有更好的答案。埃德

# django - Django 肥皂库错误

> ID：671271
> 
> 赞同：0
> 
> 时间：2009-03-22T16:46:31.337
> 
> 标签：django, web-services, soap, tostring, celementtree

在一些教程之后，我正在尝试使用 Django 制作一个小的“Hello World”网络服务，但我一遍又一遍地遇到同样的障碍。我已经定义了 view.py 和 soaplib_handler.py：

视图.py：

```
from soaplib_handler import DjangoSoapApp, soapmethod, soap_types

class HelloWorldService(DjangoSoapApp):

    __tns__ = 'http://saers.dk/soap/'

    @soapmethod(_returns=soap_types.Array(soap_types.String))
    def hello(self):
      return "Hello World" 
```

肥皂库处理程序.py：

```
from soaplib.wsgi_soap import SimpleWSGISoapApp
from soaplib.service import soapmethod
from soaplib.serializers import primitive as soap_types

from django.http import HttpResponse

class DjangoSoapApp(SimpleWSGISoapApp):

    def __call__(self, request):
        django_response = HttpResponse()
        def start_response(status, headers):
            status, reason = status.split(' ', 1)
            django_response.status_code = int(status)
            for header, value in headers:
                django_response[header] = value
        response = super(SimpleWSGISoapApp, self).__call__(request.META, start_response)
        django_response.content = "\n".join(response)

        return django_response 
```

似乎“响应=超级......”行给我带来了麻烦。当我加载映射在 url.py 中的 /hello_world/services.wsdl 时，我得到：

/hello_world/service.wsdl 'module' 对象的 AttributeError 没有属性 'tostring'

有关完整的错误消息，请参见此处： [http ://saers.dk:8000/hello_world/service.wsdl](http://saers.dk:8000/hello_world/service.wsdl)

您对我为什么会收到此错误有任何建议吗？ElementTree 在哪里定义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-22T21:44:45.260

@zdmytriv 这条线

```
soap_app_response = super(BaseSOAPWebService, self).__call__(environ, start_response) 
```

应该看起来像

```
soap_app_response = super(DjangoSoapApp, self).__call__(environ, start_response) 
```

然后你的例子有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T15:06:17.730

不确定这是否会解决您的问题，但是您的函数 hello 上的装饰器说它应该返回一个字符串数组，但实际上您返回的是一个字符串

尝试 _returns=soap_types.String 代替

射线

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-02T00:07:48.540

从我的服务中复制/粘贴：

```
# SoapLib Django workaround: http://www.djangosnippets.org/snippets/979/
class DumbStringIO(StringIO):
    """ Helper class for BaseWebService """
    def read(self, n): 
        return self.getvalue()

class DjangoSoapApp(SimpleWSGISoapApp):
    def __call__(self, request):
        """ Makes Django request suitable for SOAPlib SimpleWSGISoapApp class """

        http_response = HttpResponse()

        def start_response(status, headers):
            status, reason = status.split(' ', 1)
            http_response.status_code = int(status)

            for header, value in headers:
                http_response[header] = value

        environ = request.META.copy()
        body = ''.join(['%s=%s' % v for v in request.POST.items()])
        environ['CONTENT_LENGTH'] = len(body)
        environ['wsgi.input'] = DumbStringIO(body)
        environ['wsgi.multithread'] = False

        soap_app_response = super(BaseSOAPWebService, self).__call__(environ, start_response)

        http_response.content = "\n".join(soap_app_response)

        return http_response 
```

Django[片段](http://www.djangosnippets.org/snippets/979/)有一个错误。阅读该网址的最后两条评论。

# asp.net - 使用 jQuery 和 ASP.NET 控件的多个控件实例

> ID：671275
> 
> 赞同：2
> 
> 时间：2009-03-22T16:49:57.117
> 
> 标签：asp.net, javascript, jquery

```
<script type="text/javascript">
    $(document).ready(function() {
        $('#pHeader').click(function() {
            $('#pBody').slideToggle('fast');
        });
    });
 </script>

<asp:Panel ID="pHeader" runat="server" CssClass="cpHeader">
    <asp:Label ID="lblText" runat="server" Text="Header" />
</asp:Panel>

<asp:Panel ID="pBody" runat="server" CssClass="cpBody">
    Lorem ipsum dolor sit amet, consectetur adipisicing elit,
    sed do eiusmod tempor incididunt ut labore et dolore magna
    aliqua. Ut enim ad minim veniam, quis nostrud exercitation
    ullamco laboris nisi ut aliquip ex ea commodo consequat.
    Duis aute irure dolor in reprehenderit in voluptate velit
    esse cillum dolore eu fugiat nulla pariatur
</asp:Panel> 
```

从上面可以看出，我正在尝试实现可折叠面板。然而，以上只会工作一次。如何使多个控件可以访问它，即如果我在一个页面上有 10 个面板？

多谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T16:56:57.207

我猜你必须使用`$('.pHeader')`and`$('.pBody')`而不是`$('#pHeader')`and `$('#pBody')`如果你将 CSS 类分配`pHeader`给每个面板。

“#”字符选择在“#”符号后具有 id 的元素。这 ”。” 用于获取应用某个 CSS 类名的所有元素。

所以，这应该工作的代码：

```
<script type="text/javascript">
$(document).ready(function() {
     $('.pHeader').click(function() {
         $('.pBody').slideToggle('fast');
     });
});
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T17:14:06.543

试试这个：

```
$(function(){
  $('.cpHeader').click(function() {
    $(this).next('.cpBody').slideToggle('fast');
  });
}); 
```

如果您按 ID（例如`#pHeader`）选择，您只会影响一个节点，因为 ID 是唯一的。类旨在分配给多个节点。

还要注意缩短的第一行，jQuery 提供了它作为`$(document).ready()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T17:48:11.920

嗨，您使用 ASP.NET 遇到的主要问题是，当在自定义控件中时，控件将为每个元素创建自定义客户端 ID。为避免此陷阱，请将您拥有的代码放在这样的 ascx 自定义控件中，将服务器端内联代码放入自定义客户端 ID。这样你就可以让多个控件独立工作。

```
<asp:Panel ID="pHeader" runat="server" CssClass="cpHeader">
    <asp:Label ID="lblText" runat="server" Text="Header" />
</asp:Panel>

<asp:Panel ID="pBody" runat="server" CssClass="cpBody">
    Lorem ipsum dolor sit amet, consectetur adipisicing elit,
    sed do eiusmod tempor incididunt ut labore et dolore magna
    aliqua. Ut enim ad minim veniam, quis nostrud exercitation
    ullamco laboris nisi ut aliquip ex ea commodo consequat.
    Duis aute irure dolor in reprehenderit in voluptate velit
    esse cillum dolore eu fugiat nulla pariatur
</asp:Panel>

 <script type="text/javascript">
        $(function() {
            $('#<%=this.pHeader.ClientID %>').click(function() {
                $('#<%=this.pBody.ClientID %>').slideToggle('fast');
            });
        });
     </script> 
```

# actionscript-3 - AS3中的评估公式？

> ID：671277
> 
> 赞同：2
> 
> 时间：2009-03-22T16:50:06.290
> 
> 标签：actionscript-3, actionscript, eval

我正在玩一些 ActionScript。我想要的是我可以从一个字符串中显示一个数学函数。

例如，在我的工作 python 脚本中，我做了这样的事情：

```
formula = 'x**2 + 3*x'
for x in range( 0, 100 ):
    y = eval( formula )
    graph.display( x, y ) 
```

我想将此移植到 ActionScript，但似乎自版本 3 以来不再有 eval。无论如何我如何计算我的函数值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T13:55:05.967

在您的情况下也可能有效的方法是使用 Javascript eval 代替。你可以使用类似的东西：

`var result = ExternalInterface.call(myEvalFunctionInJS,formula)`

评估数学函数。

这是一个有点简单和有用的解决方法，因为 javascript 非常接近 actionscript。

如果将 ExternalInterface 调用放在循环中，它可能会变得迟缓。为避免这种情况，您可以在 javascript 中编写循环。（您甚至可以在 as3 中编写整个 javascript，这样您就不需要接触实际的 html 页面。）

编辑：这是一个链接。

[http://www.actionscript.org/resources/articles/745/2/JavaScript-and-VBScript-Injection-in-ActionScript-3/Page2.html](http://www.actionscript.org/resources/articles/745/2/JavaScript-and-VBScript-Injection-in-ActionScript-3/Page2.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T16:52:11.993

你必须`eval`自己写一个。您必须解析字符串并调用正确的运算符。

[这](http://danielmclaren.net/2008/09/21/eval-in-as3-tips-for-executing-dynamic-actionscript)是一个帮助您入门的链接。

Tamarin 项目有一个用 ES4 编写的 ECMAScript[解析器。](http://hg.mozilla.org/tamarin-central/file/113976971489/esc/README)试试这个。

> “你甚至可以在 as3 中编写整个 javascript，这样你就不需要接触实际的 html 页面。” 你有链接/教程吗？– 奥科曼

AS 和 JS 都基于相同的 ECMAScript 标准。所以，如果你将一个 AS3 字符串传递给一个容器，并`eval`在这个字符串上使用 JS，它应该可以正常工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-27T15:59:32.650

刚刚注意到这个问题，并意识到我在这里回答了几乎完全相同的事情：[https ://stackoverflow.com/a/11460839/1449525](https://stackoverflow.com/a/11460839/1449525)

套用我自己的话，假设您在网页中运行，您绝对可以使用[D.eval](http://www.riaone.com/products/deval/)、[AS3Eval或 ExternalInterface （如当前选择的答案所示）。](http://eval.hurlant.com/)但是，您似乎真正需要的只是这个简单 的[MathParser](http://www.flashandmath.com/intermediate/mathparser/bkde.zip)（有关 MathParser[的更多信息](http://www.flashandmath.com/intermediate/mathparser/mp1.html)）

以下是您使用 MathParser 的方法：

```
package {
    import bkde.as3.parsers.*;
    import flash.display.Sprite;
    public class MathTest extends Sprite {
        public function MathTest() {
            var parser:MathParser = new MathParser([]);
            var compiledObj:CompiledObject = parser.doCompile("(10/3)*4+10");
            var answer:Number = parser.doEval(compiledObj.PolishArray, []);

            var xyParser:MathParser = new MathParser(["x", "y"]);
            var xyCompiledObj:CompiledObject = xyParser.doCompile("(x/3)*y+10");
            var xyAnswer:Number = xyParser.doEval(xyCompiledObj.PolishArray, [10, 4]);
        }
    }
} 
```

我确信 ExternalInterface 的东西工作得很好，但我个人对跨语言通信（特别是在效率和安全性方面）以及它的尴尬性质持保留意见。我觉得在大多数情况下，一个完全包含的、相同语言的解决方案通常更可取。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-30T00:31:43.880

有点晚了，但作为参考， D.eval 库可以满足您的要求：

[http://www.riaone.com/products/deval/](http://www.riaone.com/products/deval/)

它是免费的，对我来说很好用，但没有源代码。我发现这个问题正在寻找替代的内置或源可用的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T19:24:38.650

还有一个看似废弃的项目将 Tamarin 移植到 Flash 本身：

[http://eval.hurlant.com/](http://eval.hurlant.com/)

如果取得更多进展会很棒，但现在似乎是一种好奇心。

# java - 与 xml+xslt 完美搭配的最佳 Java Web 应用程序框架是什么？

> ID：671297
> 
> 赞同：2
> 
> 时间：2009-03-22T17:03:12.810
> 
> 标签：java, xml, xslt, frameworks, wicket

我最近了解了一些关于 xml/xslt 的知识，并想在我的 web 项目中尝试一下。你会为此推荐什么框架？基本上，我想生成一个动态 xml，它将应用于客户端的 xslt 样式表。

Wicket 是我的第一个候选人，但它主要以 html 为中心。还没有设法让我的想法奏效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T21:17:56.083

Spring MVC 支持 XSLT 视图（[参考文档](http://static.springframework.org/spring/docs/2.5.x/reference/view.html#view-xslt)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T06:38:54.547

如果您希望在客户端将 XSLT 样式表应用于从服务器接收的 XML（与您所写的相反:)）您只需将纯 XML 返回给客户端

```
<?xml-stylesheet ... ?> 
```

构建嵌入。

如果您想在服务器端将 XSLT 应用于 XML 并将 HTML 返回给客户端 - 请不要打扰。我们在 21 世纪的早期就经历过这种情况——它不是非常可维护的解决方案，而且很难调试。但如果你想要（服务器端解决方案），我也推荐 SpringMVC 的 XLST 视图。还有一个名为[Cocoon的](http://cocoon.apache.org/)*经典*和核心解决方案，它实现了 XML 管道 - 从架构的角度来看它很好，但在实际项目中很难使用，如果经典 MVC 更合适的话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T06:27:55.290

试试[ReXSL](http://www.rexsl.com)，它是 XML+XSL Web 开发框架，具有经典的 MVC 模式。

# javascript - IE 上带有 ActiveXObject 的跨域 AJAX

> ID：671309
> 
> 赞同：1
> 
> 时间：2009-03-22T17:13:07.997
> 
> 标签：javascript

在 IE 上使用 ActiveXObject 对象。如何提交跨域请求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T17:36:55.850

设置服务器端代理来为您发出请求。然后使用 AJAX 调用代理（本地）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T11:20:49.660

我真的建议在处理 ajax 请求时使用 javascript 框架。这样您就不必深入了解每个浏览器的复杂性。我个人最喜欢的是 jQuery：[http ://www.jquery.com/](http://www.jquery.com/)

现在，说到跨域，你有两种情况：

*   数据只能作为 XML => 使用服务器端代理：[http ://ajaxpatterns.org/archive/Cross-Domain_Proxy.php](http://ajaxpatterns.org/archive/Cross-Domain_Proxy.php)
*   可以使用 JSONP 将数据检索为 JSON：http: [//www.ibm.com/developerworks/library/wa-aj-jsonp1/](http://www.ibm.com/developerworks/library/wa-aj-jsonp1/)

只要有可能，当涉及到 Web 浏览器时，我会推荐 JSONP，因为它很简单。但是，如果出现错误，事情会变得很棘手，所以对于 jQuery，我推荐以下插件：[http ://code.google.com/p/jquery-jsonp/](http://code.google.com/p/jquery-jsonp/)

# java - 如何更改计时器格式

> ID：671313
> 
> 赞同：1
> 
> 时间：2009-03-22T17:15:21.517
> 
> 标签：java, format, timer

我创建了计时器。如何将计时器格式更改为***秒***，以免它是长数字？谢谢

```
private long startTime  = System.currentTimeMillis();
Timer timer  = new Timer(1000, this);
timer.start();

timer.stop();
long endTime    = System.currentTimeMillis();
long timeInMilliseconds = (endTime - startTime); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-22T17:17:42.603

从毫秒除以 1000 秒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T17:45:57.467

您可以定义一个常量 SECOND 并像这样使用它：

```
new Timer(1 * SECOND, this); 
```

# .net - 从 A->Z 构建程序

> ID：671316
> 
> 赞同：6
> 
> 时间：2009-03-22T17:18:08.017
> 
> 标签：.net, build

我读了很多关于 Microsoft Dot Net 的书，学到了很多东西

*   面向对象编程
*   Windows 用户界面设计
*   使用 SQL Server 和 XML
*   调试应用程序
*   使用序列化和应用程序域
*   部署 Windows 应用程序
*   安全和许可

我知道如何做到这一切，没有完美和非常深刻，但很好。但我的问题是我无法构建应用程序。这与想法无关，我有想法。

问题是每次开始，我都不知道从哪里开始，从哪里开始，如何设计计划，在编写应用程序时或之后调试应用程序，何时实施安全性，何时部署和测试它，如果我的应用程序缺少一个步骤，如果它与其他点网框架兼容，如果它在所有平台上都能完美运行......

我觉得我在学习中缺少一些东西，这使我无法构建一个安全且受管理的整个应用程序。

我是否错过了另一本书、课程、课程？还是我的问题？所有人都可以设计计划还是仅限于其他人？最后：我该怎么办？继续学习并构建应用程序（稍后出售）或者只是兼职工作，直到我完成学习并找到一份全职工作？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-22T17:23:19.970

不要从大想开始。从小处着手。当你想得远大的时候，你就有可能吓到自己。

当我一开始的想法太大时，我永远找不到正确的起点，就像你所描述的那样，我会陷入无尽的思考圈。如果我能从一个小的、现实的、可管理的任务开始，那么我就会开始取得少量的进展。一件完成后，我就可以开始下一件了。当然，我稍后会回去调整以前的部分，但没关系。至少我开始了并且走在正确的轨道上，而不是陷入“我从哪里开始”完美主义的困境。

你怎么吃大象？一次咬一口。

**[编辑]**这是另一个想法：尝试在一周内每天编写一个简单但*完整的应用程序。*这将需要做一些 hack-y 的事情并使用三思而后行的意大利面条代码。但这也将迫使您专注于得出真正的结论并评估需要哪些功能，哪些只是功能蠕变。

我不会向很多人推荐这个。如果你这样做太久，你会养成恶劣的习惯。但是，对于您的个人心理障碍，此练习可能会有所帮助。

如果您确实决定做这样的事情，请在此处发帖，让我们都知道它是如何进行的。

祝你好运！

ps：很好的问题。我相信很多人都面临同样的情况，但不想问，因为害怕看起来很糟糕。我知道由于你描述的原因，我已经注定了我自己的许多个人项目

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T19:05:42.873

写出你想让软件做什么也很有帮助，通常这将是你的功能规范，但对于一个小应用程序来说，写下你想让它做什么就足够了。

正如 paulgreg 所说，将其分解为小的“婴儿步骤”，这样您就可以开始着手这些步骤，同时关注大局。

就像 Timbuck 所说，它有助于在行业工作，因为您可以向其他人学习并让他们为您构建（在开始时），但您也可以获得更多的编程经验，因为您可以做更多的事情！

顺便说一句：如果你不喜欢创建一些“无用的应用程序”的想法，那就想一个你自己喜欢的应用程序。肯定有人也很想拥有它，所以你可以去某个地方把它作为共享软件出售；-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-22T17:27:14.373

试着做“婴儿步”……

例如，对于地址簿，首先构建搜索，然后是创建表单，然后是更新表单，依此类推。也可以经常重构你的代码，以避免重复。

我有时会以这种方式构建应用程序的第一个和小型版本，并且在学习了我在 V1 上犯过的错误之后，我曾经构建过第二个更干净的版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-22T17:35:57.660

从您自己的小型电话簿应用程序开始，您可以在几天内完成。从头到尾看一个简单的项目会让你更清楚如何继续做一些更大的事情，然后你就走上阶梯。

实现完整系统的各个方面需要多年的经验。

祝你好运！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-22T18:19:28.617

在这个行业工作肯定有助于把很多部分放在一起。更有经验的开发人员可以指导您完成整个过程，这对您更有帮助。

真正帮助我的一件事是开发了一个我在求职过程中使用的简单笔记应用程序。我已经能够将其用作其他一些个人项目的基础，以及我在职业生涯中每天使用的工具。

一段时间后回到代码让我看到我可以在哪里做得更好。毕竟，您编写的大部分代码都必须在某个地方维护，可能不是由您自己维护。因此，如果您无法返回自己的代码并对其进行修改，请想象一下对其他人来说会是什么样子。到目前为止，就软件单元而言，我的方法是“构建一个扔掉”。

从一个新的石板开始很好，但正如你所发现的，它也可能是压倒性的。您会发现，随着您的进步，您可能想要添加其他功能。抵制这种诱惑！当然，添加某个选项似乎“容易”，但这可能会导致您走上黑暗的道路，并使您的注意力从主要目标上移开。

了解语言和技术是一回事，但掌握软件工程原理将为您提供更好的职业基础。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-22T17:25:47.733

您所阅读的内容是拼图的一部分，可以说是操作方法。你需要对大局有一个清晰的认识。为什么要解决这个问题？这是个问题吗？有替代方案，解决方法吗？我在哪些方面比竞争对手做得更好？成为你的批评者。

> 我是否错过了另一本书、课程、课程？还是我的问题？

我会说你看看软件工程原理，开发过程。另外，阅读一些关于理解需求、软件架构和设计等的内容。继续练习你学到的东西。

> 所有人都可以设计计划还是仅限于其他人？

有些人比其他人更擅长。就像在任何其他领域一样。

> 最后：我该怎么办？继续学习并构建应用程序（稍后出售）或者只是兼职工作，直到我完成学习并找到一份全职工作？

继续阅读/写作。一份工作确实有助于让您了解在专业环境中如何完成工作。您也可以在处理您的宠物项目时应用这些原则。在软件领域找到一份工作肯定会非常有价值。

# objective-c - [NSMutableDictionary setValue: value forKey: key] 是否保留 NSString 键？

> ID：671322
> 
> 赞同：6
> 
> 时间：2009-03-22T17:22:22.467
> 
> 标签：objective-c, memory-management

`NSMutableDictionary`在使用该方法添加项目时`setValue:forKey:`（我想这可以概括为 any `NSObject`）字典是否保留第二个参数`NSString`？

例如：

```
NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
NSMutableDictionary *dict = [[NSMutableDictionary alloc] init];
NSString *theString = @"hello";
int i;
for (i=0; i<[theString length]; i++){
    NSNumber *myInt = [NSNumber numberWithInt:i];
    NSString *character = [NSString stringWithFormat:@"%C",[theString characterAtIndex:i]];
    [dict setValue: myInt forKey:character];
}
[dict release];
[pool release]; 
```

显然，没有理由`myInt`在循环中释放，它被保留，`dict`所以直到代码结束才能释放。但同样如此`character`吗？我的想法是，如果`NSMutableDictionary`以其他方式存储字符串，那么可以在循环周围创建一个临时池并释放这些字符串，而不是等到字典释放。

我也很好奇为什么`retainCount`of`character`是 7fffffff 就好像它是一个`NSConstantString`，我希望`stringWithFormat`返回一个`NSString`需要保留的对象，但似乎并非如此。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T14:15:41.830

`NSString`在 Cocoa 中，参数被复制而不是保留是很常见的。那是因为你可以很容易地给字典一个`NSMutableString`. 因为字符串的值可能会改变，所以`NSDictionary`制作一个副本。

但是，无论`NSMutableDictionary`实际操作如何，您都不必担心是否`character`需要保留。一旦你将它`NSMutableDictionary`作为参数传递给它，那么决定如何存储数据确实是该类的问题，除非文档明确告诉你保留对象是你的责任。

我也不会太担心`retainCount`任何对象的。过于密切地跟踪对象的保留计数可能会导致您掉入兔子洞，这只会让您旋转轮子。

最后，我真的不认为你需要在这里创建自己的自动释放池。除非您绝对确定这`theString`会很长，或者您已经观察到 Instruments 中的内存利用率很高，否则添加自动释放池是不必要的优化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-22T17:27:41.720

您不需要保留`character`在那里，当您将其设置为键时，字典会保留它，您自己的代码不需要保留它。

您也不必担心为什么保留计数不是您所期望的。也许 Foundation 框架具有类似 Flyweight 的加载单字符实例的`NSString`实例。无论如何，如果您按照指南正确地进行了内存管理，那么无论框架在幕后做什么，您都会没事的。[http://iamleeg.blogspot.com/2008/12/cocoa-memory-management.html](http://iamleeg.blogspot.com/2008/12/cocoa-memory-management.html)

# python - 使用Python获取html文件上所有标签中href属性的值

> ID：671323
> 
> 赞同：1
> 
> 时间：2009-03-22T17:22:34.183
> 
> 标签：python, html, regex, parsing

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-22T17:43:14.087

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-22T18:00:18.757

BeautifulSoup 的另一种替代方法是 lxml ( [http://lxml.de/](http://lxml.de/) )；

```
import lxml.html
links = lxml.html.parse("http://stackoverflow.com/").xpath("//a/@href")
for link in links:
    print link 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-22T17:28:39.770

Python 中有一个标准的 HTML 解析器。结帐`htmllib`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-22T18:31:56.357

其他人没有告诉你的是，为此使用正则表达式不是一个可靠的解决方案。
在许多情况下使用正则表达式会给你错误的结果：如果有 <A> 标签被注释掉，或者页面中有包含字符串“href=”的文本，或者如果有 <textarea> 元素html 代码，以及许多其他代码。另外，href 属性可能存在于锚标签以外的标签上。

为此您需要的是[XPath](http://en.wikipedia.org/wiki/Xpath)，它是一种用于 DOM 树的查询语言，即它允许您检索满足您指定条件的任何节点集（HTML 属性是 DOM 中的节点）。
XPath 现在是一种很好的标准化语言 ( [W3C](http://www.w3.org/TR/xpath) )，并且得到所有主要语言的良好支持。我强烈建议您为此使用 XPath 而不是正则表达式。
adw 的回答显示了针对您的特定情况使用 XPath 的一个示例。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-23T00:14:53.147

如前所述：正则表达式没有解析 HTML 的能力。不要使用正则表达式来解析 HTML。不要通过围棋。不要收取 200 英镑。

使用 HTML 解析器。

但为了完整起见，主要问题是：

```
re.match ('/href="(.*)"/iU', line) 
```

您不使用“/.../flags”语法来装饰 Python 中的正则表达式。而是将标志放在单独的参数中：

```
re.match('href="(.*)"', line, re.I|re.U) 
```

另一个问题是贪婪的 '.*' 模式。如果一行中有两个href，它会很乐意吸收第一场比赛的开头“和第二场比赛的结尾”之间的所有内容。您可以使用非贪婪的 '.*?' 或者，更简单地说， '[^"]*' 只匹配第一个结束引号。

但是不要使用正则表达式来解析 HTML。真的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-22T17:57:58.513

不要将 html 内容分成几行，因为一行中可能有多个匹配项。也不要假设 url 周围总是有引号。

做这样的事情：

```
links = re.finditer(' href="?([^\s^"]+)', content)

for link in links:
  print link 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-23T07:54:07.660

好吧，为了完整起见，我将在这里添加我发现的最佳答案，我在 Mark Pilgrim 的 Dive Into Python 一书中找到了它。

下面是列出网页中所有 URL 的代码：

```
from sgmllib import SGMLParser

class URLLister(SGMLParser):
    def reset(self):                              
        SGMLParser.reset(self)
        self.urls = []

    def start_a(self, attrs):                     
        href = [v for k, v in attrs if k=='href']  
        if href:
            self.urls.extend(href)

import urllib, urllister
usock = urllib.urlopen("http://diveintopython.net/")
parser = urllister.URLLister()
parser.feed(usock.read())         
usock.close()      
parser.close()                    
for url in parser.urls: print url 
```

感谢所有的答复。

# ruby - 操作无法完成。不支持这样的接口（Ruby In Steel）

> ID：671337
> 
> 赞同：8
> 
> 时间：2009-03-22T17:29:20.720
> 
> 标签：ruby, ironruby

我为 Visual Studio 2008 安装了 Ruby In Steel 试用版，当我尝试保存 IronRuby 项目时，它一直发出警告：

> “操作无法完成。不支持这样的接口”。

我无法保存项目，只能运行它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2020-04-16T20:57:57.073

有时只需重新启动 Visual Studio 即可解决问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-22T17:36:18.237

最有可能：您的安装已损坏，或者您遇到了 VS 错误。请参阅此博客[文章](http://vsx-insider.blogspot.com/2008/02/new-custom-project-can-be-saved.html)和MS 提交的相应[错误。](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=285937)

# python - QSortFilterProxyModel.mapToSource 崩溃。没有信息为什么

> ID：671340
> 
> 赞同：1
> 
> 时间：2009-03-22T17:33:05.233
> 
> 标签：python, qt, qt4, pyqt, pyqt4

我有以下代码：

```
proxy_index = self.log_list.filter_proxy_model.createIndex(index, COL_REV)
model_index = self.log_list.filter_proxy_model.mapToSource(proxy_index)
revno = self.log_list.model.data(model_index,QtCore.Qt.DisplayRole)
self.setEditText(revno.toString()) 
```

代码在第二行崩溃了。没有引发异常。没有回溯。没有警告。我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T00:22:32.737

可能是您错误地使用了代理模型的 createIndex() 方法。通常，createIndex() 方法作为模型的 index() 方法实现的一部分被调用。

您是否尝试过调用代理模型的 index() 方法来获取代理索引，然后将其映射到源？

也许您可以在上下文中显示代码或解释您正在尝试做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-26T04:05:42.153

我遇到了同样的问题，但幸运的是使用 index () 方法而不是 David 推荐的 createIndex () 方法可以做到这一点。一般来说，在 index() 方法之外乱用 QModelIndex 的内部指针是个坏主意。即使使用您自己的模型弄乱内部指针也经常导致意外的行为，因为 Qts View 代码对用户来说非常模糊。

# java - Java中的重置计时器

> ID：671347
> 
> 赞同：1
> 
> 时间：2009-03-22T17:37:33.430
> 
> 标签：java, timer, reset

单击按钮后，我尝试根据当前时间重置计时器，但它不起作用。

```
private long startTime  = System.currentTimeMillis();
Timer timer  = new Timer(1000, this);
timer.start();

timer.stop();
long endTime    = System.currentTimeMillis();
long timeInMilliseconds = (endTime - startTime);

timer.reset(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-22T18:04:14.347

我的魔法水晶球说你正在使用 javax.swing.Timer 并且没有 reset() 方法，它被称为 restart()。

但那可能是错误的，如果你能更明确地说明你在做什么，那就太好了......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T19:23:29.820

我的程序的解决方案。谢谢大家。

```
 public class mainClass {
        private long startTime  = System.currentTimeMillis();
        Timer timer  = new Timer(1000, this);
        .....
    }

    public mainClass {
        timer.start();
    }

    //Everytime the button stop clicked, the time will stop and reset to the most current time of the system
    public actionPerformed () {
        timer.stop();
        long endTime    = System.currentTimeMillis();
        long timeInMilliseconds = (endTime - startTime);

        **startTime  = System.currentTimeMillis();** ACCEPTED
    } 
```

# macos - OSX 上的 Eclipse RCP - 如何停止记录到系统日志？

> ID：671357
> 
> 赞同：2
> 
> 时间：2009-03-22T17:54:34.137
> 
> 标签：macos, logging, eclipse-rcp, cpu, rcp

我们的 RCP 应用程序记录了相当多的日志，但只有 INFO 及更高版本输出到控制台。在 windows/linux 上这没问题，但在 OSX 上，所有日志记录似乎都传递给 syslogd，然后它决定记录什么而不记录什么，这意味着处理成千上万的 FINEST 日志消息，这使得 syslogd 使用 140% cpu 和 gobble内存。运行我们的应用程序大约 3 分钟后，syslogd 使用了 2.5gb 的内存，整个系统变得无法使用。杀死 syslogd/rebooting 是唯一的治疗方法。从控制台启动应用程序使其直接登录到控制台，没有问题。

如何停止 syslogd 处理我在 OSX 上的 RCP 日志记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T17:35:37.690

查看您的 RCP 应用程序的 RCP.App/Contents/Info.plist 文件。RCP 产品构建生成的默认文件具有 <string>-consoleLog<string>。

这可能就是为什么一切都在 syslogd 中结束的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T18:22:47.283

我对 Eclipse RCP 一点也不熟悉，但我确实对 syslog 有一些经验。您可能正在使用其中一个`local0`或`local1`作为工具进行日志记录。OSX`local0.*`指向*/var/log/appfirewall.log*和*/var/log/ipfw.log*。`local1`_ 如果您正在登录到任一设施，那么您记录的所有内容都将写入磁盘。

 *我将首先查看是否以及如何配置应用程序正在登录的 syslog 工具。*一旦确定它正在登录哪个设施，您应该能够通过编辑/etc/syslog.conf*并向 syslog 守护进程发送 HUP 信号来关闭它。阅读手册条目以[`syslogd`](http://developer.apple.com/DOCUMENTATION/DARWIN/Reference/ManPages/man8/syslogd.8.html)获取[`syslog.conf`](http://developer.apple.com/DOCUMENTATION/DARWIN/Reference/ManPages/man5/syslog.conf.5.html)详细说明。

您可能还想考虑使用更类似于 Java 的日志接口而不是 syslog。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T09:46:08.467

我也偶尔被这个咬过。我的猜测是这样的：

如果您从桌面通过 Eclipse.app 启动 Eclipse，它的控制台（stdout/stderr）将被重定向到 syslog，因此 Eclipse 本身（或使用 printf 的插件）的任何输出都将在那里结束。

尝试`./eclipse`在 Terminal.app 中调用，看看您是否在终端窗口中收到消息，而不是在 syslog 中。

但是，这当然并不能解决您实际上不希望它们中的任何一个的问题...找出谁在产生输出，然后让他们将其放入 ErrorLog 中。

不幸的是，我不再知道这发生在我身上，所以我无法测试它。祝你好运！

# objective-c - 如何在两个连接的 NSString 之间添加空格？

> ID：671360
> 
> 赞同：3
> 
> 时间：2009-03-22T17:55:36.333
> 
> 标签：objective-c, nsstring, concatenation

我有三个字符串对象：

```
NSString *firstName;
NSString *lastName;
NSString *fullName; 
```

`firstName`和的值`lastName`是从 NSTextFields 接收的。

然后我想连接两个字符串并将结果放在`fullname.`

这是我正在使用的代码：

```
fullName = [firstName stringByAppendingString:lastName]; 
```

但是，结果不会在两个名称之间放置空格（例如 JohnSmith）。

如何在空间中添加？我希望结果看起来像（约翰史密斯）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-05-21T04:06:18.767

我对其他答案的长度感到惊讶：

```
fullname = [NSString stringWithFormat:@"%@ %@", firstname, lastname]; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-22T17:57:57.297

最简单的方法是这样的：

```
fullname = [[firstName stringByAppendingString:@" "] stringByAppendingString:lastName]; 
```

即追加空格，然后追加姓氏。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-22T07:50:36.283

```
fullName = [@[firstName, lastName]
             componentsJoinedByString:@" "]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T17:58:12.710

这是正常的。您必须自己添加空间。

```
(NSString*) description { return [[[NSString alloc] 
                          initWithFormat:" %@ %@”, 
                          firstname, 
                          lastname] autorelease]; } 
```

# asp.net - 将 aspnet_users UserName 值添加到我自己的表中

> ID：671361
> 
> 赞同：0
> 
> 时间：2009-03-22T17:55:41.857
> 
> 标签：asp.net

我想将 aspnet_users 中的 UserName 插入我自己的名为 Members 的表中。我的 sqldatasource 如下所示。最后在 InsertParameters 我添加了 ProfileParameter 但它不起作用。只是为了让值继续下去，我在 insert 命令中硬编码了“testhere”值。我的 SQLDatasource 如下所示。

请帮忙 ！！！

```
 <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    OnInserted= "on_inserted"
    OnUpdated = "on_updated"

        ConnectionString="<%$ ConnectionStrings:test1ConnectionString %>" 
        DeleteCommand="DELETE FROM [member] WHERE [id] = @id" 
        InsertCommand="INSERT INTO [member] ([firstname], [lastname],[username]) VALUES (@firstname, @lastname,'testhere');
                            set @id = @@identity"  
        SelectCommand="SELECT * FROM [member] WHERE ([id] = @id)" 

        UpdateCommand="UPDATE [member] SET [firstname] = @firstname, [lastname] = @lastname WHERE [id] = @id" 
        onselecting="SqlDataSource1_Selecting">
        <SelectParameters>
            <asp:QueryStringParameter Name="id" QueryStringField="id" Type="Int32" />
        </SelectParameters>
        <DeleteParameters>
            <asp:Parameter Name="id" Type="Int32" />
        </DeleteParameters>
        <UpdateParameters>
            <asp:Parameter Name="firstname" Type="String" />
            <asp:Parameter Name="lastname" Type="String" />
            <asp:Parameter Name="id" Type="Int32" />
        </UpdateParameters>
        <InsertParameters>
         <asp:Parameter Name="id" Type=Int32 Direction=Output />
            <asp:Parameter Name="firstname" Type="String" />
            <asp:Parameter Name="lastname" Type="String" />
            <asp:ProfileParameter Name="username" Type=String /> 
        </InsertParameters>
    </asp:SqlDataSource> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-18T22:28:01.777

Okay.. as a simple one:

*   Try changing the InsertParameter (username) to be an asp:Parameter.
*   Add a asp:HiddenField control with ID of username
*   onpageload, set the value of the username hiddenfield to be Page.User.Identity.Name

Magic!

# python - 不可下标的对象

> ID：671363
> 
> 赞同：1
> 
> 时间：2009-03-22T17:57:45.393
> 
> 标签：python, image, image-processing, colors, python-imaging-library

我正在使用 PIL

```
 im = Image.open(teh_file)
    if im:
        colors = im.resize( (1,1), Image.ANTIALIAS).getpixel((0,0)) # simple way to get average color
        red = colors[0] # and so on, some operations on color data 
```

问题是，在一些（很少，特别是不知道为什么那些确切的，简单的 jpegs）上，我在“colors [0]”行上得到“不可订阅的对象”。试过：

```
if colors: 
```

变得真实并继续。

```
if len(colors): 
```

给出 'len() of unsized object'

1.  我应该申请什么条件才能获得此例外？
2.  问题的原因是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-22T18:00:57.633

来自 PIL 文档：

```
getpixel

im.getpixel(xy) => value or tuple

Returns the pixel at the given position. If the image is a multi-layer image, this method returns a tuple. 
```

所以看起来你的一些图像是多层的，有些是单层的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T18:06:25.933

如另一个答案中所述，`getpixel`返回单个值或元组。您可以通过以下方式检查类型并执行适当的操作：

```
if isinstance(colors, tuple):
    color = colors[0]
else:
    color = colors
# Do other stuff 
```

或者：

```
try:
    color = colors[0]
except: # Whatever the exception is - IndexError or whatever
    color = colors
# Do other stuff 
```

第二种方式可能更 Pythonic。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-22T19:43:35.437

好的情况是，当黑白图像没有 RGB 波段（L 波段）时，它返回一个具有像素颜色单一值的整数，而不是 rgb 值的列表。解决方案是检查波段

```
im.getbands() 
```

或者更简单的我的需要是：

```
 if isinstance(colors, tuple):
            values = {'r':colors[0], 'g':colors[1], 'b':colors[2]}
        else:
            values = {'r':colors, 'g':colors, 'b':colors} 
```

# python - Django：按目录指定基本模板

> ID：671369
> 
> 赞同：13
> 
> 时间：2009-03-22T17:59:50.910
> 
> 标签：python, django, django-templates

我正在开发一个包含多个部分和小节的 Django 站点。我想要几个深度的模板继承：整个站点的基本模板，从根基本模板继承的每个部分的基本模板，等等。这是我想要的目录结构的简化版本：

```
base.html
section1/
  base.html
section2/
  base.html
section3/
  base.html 
```

我希望所有文件`section1/`都包含类似的内容`{% extends "base.html" %}`，这意味着它们将扩展`section1/base.html`。`section1/base.html`将包含类似 的内容`{% extends "../base.html" %}`，这意味着它将扩展根级基本文件。但是，我在文档中找不到任何表明这是可能的内容，并且我无法让 Django 区分`"../base.html"`和`"base.html"`。（`{% extends "../base.html" %}`抛出错误。）我想一种解决方法是重命名所有基本文件`base_SECTIONNAME.html`，并更新从它们继承的所有文件，但我担心随着我的网站变得更大并且部分更改名称等，这可能会变得难以维护. 我更喜欢利用目录和子目录指定的自然层次结构的解决方案。

有任何想法吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-22T18:07:15.557

可能是我监督了一些事情，但是您想要的一切都可以通过 django 模板系统来完成。所有扩展调用都相对于模板目录。

1.  为了使子目录中的所有 base.html 文件扩展 base.html，您只需将 a`{% extends "base.html" %}`放入文件中。section1/base.html 看起来像这样。

    `{% extends "base.html" %}`

    `{# ... rest of your code ...#}`

2.  现在，要从 section1 获取文件以扩展*section1/base.html*，您只需将其放在`{% extends "section1/base.html" %}`它们的顶部。第 2 节、第 3 节等也是如此。

就是这么简单，但在文档中可能并不完全明显。

我希望，我理解你的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T05:00:58.450

接受的答案会起作用，但我建议使用变量名来跟踪节结构。我个人的偏好是[上下文处理器](http://docs.djangoproject.com/en/dev/ref/templates/api/?from=olddocs#writing-your-own-context-processors)。例如，如果您网站的版块组织透明地反映在 url 中，请尝试以下操作：

```
# It may be convenient to make this function live in or near your url conf.
def convert_url_path_to_folder_path(path):
    # fill in the magic here

def sub_folder_available(request):
    folder = convert_url_path_to_folder_path(request.path)
    return {'subsection': folder, 'local_base':folder+'/base.html'} 
```

然后在您的模板中，只需调用

```
{% extends local_base %} 
```

可能有十几种其他方法可以做到这一点，但主要是考虑避免将文件夹名称硬编码到模板中。这将为您带来很多好处，特别是因为如果它们恰好足够相似，您可以在部分之间拖放模板。您可能会添加插入的另一件事是：

```
def sub_folder_available(request):
    folder = convert_url_path_to_folder_path(request.path)
    # Check if local base exists:
    if os.access(folder+'/base.html',os.F_OK):
        base = folder+'/base.html'
    else:
        # revert to your global base
        base = 'base.html'
    return {'subsection': folder, 'base':base} 
```

这种策略的好处当然是你可以在完全没有任何本地基础模板的情况下启动并运行一个轻量级部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-17T11:27:47.803

你可以使用这个库：[https ://github.com/vb64/django.templates.relative.path](https://github.com/vb64/django.templates.relative.path)

只需在您的模板中编写如下：

{% load relative_path %} {% 扩展 ".base.html" %}

这将扩展模板“base.html”，位于放置模板的同一文件夹中

{% load relative_path %} {% 扩展 "...base.html" %}

扩展模板“base.html”，位于高两层

同样的事情适用于“包含”标签。

# xml - 如何使用 linq (VB 2008) 替换条件选择元素中的 xml 内容

> ID：671371
> 
> 赞同：0
> 
> 时间：2009-03-22T18:00:13.437
> 
> 标签：xml, vb.net, linq, linq-to-xml

我正在开发一个 .NET 应用程序 (VB 2008)，它从基于 Web 的 Django 应用程序中获取所有数据。

我在应用程序中使用 Linq-to-XML 和 Linq-to-objects。

一个 API 调用为我提供了以下格式的 XML 数据，我将这些数据加载到 XDocument 中。

```
<django-objects version="1.0">
    <object pk="1" model="app.person">
        <field type="CharField" name="reference_num">001</field>
        <field to="app.office" name="office" rel="ManyToOneRel">2</field>
        <field type="DateField" name="date">2008-09-03</field>
        <field type="CharField" name="surname"></field>
        <field type="CharField" name="name">Sandra</field>
        <field type="DateField" name="birthdate">1988-11-03</field>
        <field type="CharField" name="sex">F</field>
        <field type="CharField" name="marital_status">S</field>
        <field type="TextField" name="special_interests">Biking</field>
        <field type="CharField" name="identity_proof"></field>
        <field type="CharField" name="identity_proof_number"></field>
        <field type="BooleanField" name="is_active">0</field>
        <field type="DateTimeField" name="created">2008-09-03 12:46:39</field>
        <field type="DateTimeField" name="modified">2008-09-03 12:46:39</field>
        <field type="DateField" name="important_date"><None></None></field>
        <field type="DateField" name="archive_date"><None></None></field>
        <field type="CharField" name="process_status"></field>
        <field type="FileField" name="image"></field>
        <field to="auth.user" name="self_user" rel="OneToOneRel">13</field>
    </object>
    <object pk="2" model="app.person">
    .
    <!-- more similar xml //-->
    .
    </object>
    .
    .
    .
</django-objects> 
```

这是格式，API 调用返回几个`<object>`像这样的元素。此 XML 包含`<None></None>`用于表示 Null 值，例如，在上面代码块的底部，在`<field type="DateField" name="archive_date"><None></None></field>`. `<None></None>`告诉我在数据库中这个字段有一个空值。此 XDocument 中的其他`<object>`元素可能具有有效日期或`<None></None>`. 我想做的是：对于所有`<object>`where `<field type="DateField" name="archive_date">`contains`<None></None>`用 1899-01-01 替换这个空表示。

我将如何实现这一目标？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T20:46:00.607

这样的事情呢？

```
XElement djangoElement = XElement.Load(@"c:\django.xml");

IEnumerable<XElement> archiveDateElements = from fieldElement in djangoElement.Elements("object").Elements("field")
                                            where fieldElement.Attribute("type") != null && 
                                                fieldElement.Attribute("type").Value == "DateField" &&
                                                fieldElement.Attribute("name") != null &&
                                                fieldElement.Attribute("name").Value == "archive_date"
                                        select fieldElement;

foreach (var archiveDateElement in archiveDateElements)
{
    XElement noneElement = archiveDateElement.Element("None");

    if (noneElement != null)
    {
        noneElement.ReplaceWith("1899-01-01");
    }
} 
```

PS 抱歉 - 刚刚注意到您所追求的是 VB.NET。但我想这些相似之处可能会为您指明正确的方向。

# asp.net - 在符合 FDCC 的工作站上进行 VS 开发

> ID：671379
> 
> 赞同：4
> 
> 时间：2009-03-22T18:07:48.177
> 
> 标签：asp.net, fips

我有一个启用了 FIPS 140-1（1 级）的 FDCC 兼容工作站。

现在，我无法在我的机器上运行/调试任何 VS 2005/2008 应用程序

我在浏览器上收到以下错误消息

**解析器错误消息：此实现不是 Windows 平台 FIPS 验证的加密算法的一部分。**

错误指向 default.aspx.cs 文件的第 1 行

使用系统；

成功调试/运行我的应用程序的唯一方法是将以下注册表项设置为 0

HKLM\System\CurrentControlSet\Control\Lsa\fipsalgorithmpolicy

我知道在 XP SP2 上有一些不符合 FIPS 的加密算法，但我根本没有使用加密。就此而言，该解决方案仅包含 .cs 文件中带有默认代码的 default.aspx 页面，即使该页面也无法运行。

所以我的问题是为什么网页无法加载，以及为什么错误指向第 1 行“使用系统；” 陈述？

我的下一个问题是在我没有注册表编辑权限的情况下，如何在符合 FIPS 的锁定机器上进行开发

谢谢库德鲁尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-20T21:17:00.223

显然，除了使用非 fips 加密算法之外，仅在 webconfig 中使用 debug="true" 可能会导致在 .NET 2.0 Web 应用程序中发生这种情况

```
<system.web>
    <compilation debug="true">
</system.web> 
```

另外，如果您使用的是视图状态，那么您还需要在 web.config 的 system.web 部分中使用此密钥：

```
<machineKey validationKey="AutoGenerate,IsolateApps" decryptionKey="AutoGenerate,IsolateApps" validation="3DES" decryption="3DES"/> 
```

所以实际上你不能在符合 FIPS 的机器上以调试模式运行应用程序。我恳请您的组策略管理员为开发机器关闭此功能，或者至少允许您打开和关闭它，以便您仍然可以在启用 fips 强制的情况下测试运行。这可以追溯到关于在没有完全管理员权限的机器上开发的辩论，这是没有管理员权限突然出现的那种障碍和烦恼的一个典型例子......但我离题了。

这里有一些关于这个 FIPS 东西的参考文章：

[http://blogs.msdn.com/shawnfa/archive/2005/05/16/417975.aspx](http://blogs.msdn.com/shawnfa/archive/2005/05/16/417975.aspx)

[http://blogs.msdn.com/shawnfa/archive/2008/03/14/disabling-the-fips-algorithm-check.aspx](http://blogs.msdn.com/shawnfa/archive/2008/03/14/disabling-the-fips-algorithm-check.aspx)

[http://support.microsoft.com/default.aspx?scid=kb;EN-US;811833](http://support.microsoft.com/default.aspx?scid=kb;EN-US;811833)

[http://support.microsoft.com/kb/911722](http://support.microsoft.com/kb/911722)

[http://blogs.iis.net/webtopics/archive/2009/07/20/parser-error-message-this-implementation-is-not-part-of-the-windows-platform-fips-validated-cryptographic-算法-当-net-page-has-debug-true.aspx](http://blogs.iis.net/webtopics/archive/2009/07/20/parser-error-message-this-implementation-is-not-part-of-the-windows-platform-fips-validated-cryptographic-algorithms-when-net-page-has-debug-true.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-25T13:04:16.863

我们在我们的位置也遇到过同样的问题。简而言之，Web 表单中的视图状态数据是使用不符合 FIPS 的 AES 算法的 RijndaelManaged 实现加密的。最简单的解决方案是将以下（或类似的）行添加到指定 3DES 加密的 web.config 文件中。3DES 符合 FIPS 标准。

<machineKey validationKey="AutoGenerate,IsolateApps" decryptionKey="AutoGenerate,IsolateApps" validation="3DES" decryption="3DES"/>

[您可以在http://csrc.nist.gov/groups/STM/cavp/index.html](http://csrc.nist.gov/groups/STM/cavp/index.html)获得有关各种 FIPS 兼容算法的更多信息。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T19:30:44.437

[似乎有一个与使用 MD5 的 WFC 相关的修补程序。](http://support.microsoft.com/kb/935434)

# iphone - 转移应用商店中 iPhone 应用的所有权

> ID：671382
> 
> 赞同：126
> 
> 时间：2009-03-22T18:10:18.203
> 
> 标签：iphone, app-store

我和我的团队有一个应用程序，我们将很快提交给商店，但我们知道我们将在不久的将来将该应用程序出售给另一家公司。有没有人有将应用程序的所有权转移到另一个帐户的经验？

具体来说，当我将应用程序出售给另一家公司时......

*   我们如何将应用程序移至他们的帐户（机制是什么）？
*   我的用户是否仍能获得更新（由新所有者发布）而无需重新购买/重新下载应用程序？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-06-10T22:24:23.523

从 2013 年 6 月 11 日开始，这已正式成为可能。以下是官方说明：

亲爱的开发者，

现在可以在 iTunes Connect 中将应用程序从一个开发者转移到另一个开发者，例如在收购之后或分销协议到期时。转移应用程序的所有权不会影响应用程序在 App Store 上的可用性。所有评分和评论都将被转移，您的客户将继续访问所有可用的应用程序更新。

要转移应用程序，请转到iTunes Connect 上[管理您的应用程序模块中的应用程序摘要页面，然后单击转移应用程序。](http://www.apple.com/itunes/go/itunesconnect/manageApps)确保：

• 您的帐户处于活动状态

• 您已接受最新版本的合同

• 您的应用至少有一个已获批准的版本

• 您的应用处于可供销售、无效二进制、已拒绝、开发者拒绝或开发者已从销售中移除状态

• 任何相关的应用内购买都处于准备提交、准备销售、已拒绝、开发人员已从销售中删除或已批准状态

• 您知道收件人的团队代理的 Apple ID 和他们的团队 ID。

有关应用程序传输的更多信息，请参阅 iTunes Connect 上的视频教程。要查找有关应用程序传输的常见问题的答案，请参阅 iTunes Connect 上的常见问题解答。

问候， App Store 团队

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-04-07T04:06:46.913

***更新：此答案已过时。它在编写时似乎是正确的。没有必要反对它，但也不要相信它！***

* * *

官方回答是否**。**来自[iTunes Connect 常见问题解答](https://itunesconnect.apple.com/WebObjects/iTunesConnect.woa/wo/5.0.0.9.1.7.1.1.1.1)：

> **我将我的应用程序卖给了另一个开发者，并且无法再在 App Store 上分发。我可以将应用转移到新开发者的 iTunes Connect 帐户吗？**
> 
> 目前，无法将应用转移到其他开发者帐户。如果您希望通过另一个开发者帐户销售该应用程序，您需要从当前 iTunes Connect 帐户中删除该应用程序并在新的 iTunes Connect 帐户下上传该应用程序。
> 
> 将应用程序上传到新的 iTunes Connect 帐户将使当前客户无法接收应用程序的自动和免费更新。所有客户评论、评级和排名信息也将被重置。

FutureTap 开发人员 Ortwin Gentz 在购买 WhereTo? 时提供的其他资源证实了这一点。来自复杂软件：

[上一集转移一个 iPhone 应用程序](http://www.futuretap.com/blog/transferring-an-iphone-app-last-episode)

[刻在石头上转移一个 iphone 应用程序](http://www.futuretap.com/blog/carved-in-stone-transferring-an-iphone-app)

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2010-04-24T22:09:14.760

跟进：毕竟：这是可能的（截至 2010 年 3 月下旬）。

我还没有阅读有关此问题的所有评论或其他线程，因此这可能已过时，但似乎它基本上与 appStore 的 iTunes 相关结构有关。

你不能成为披头士和滚石乐队的一员……

无论如何，最终，一位同事设法解决了问题，我们让我们的应用程序（它在我的私人单一开发帐户下运行）在一个新的企业帐户下运行。我们保持了我们的评级，我们在应用商店的类别中排名第一，总而言之，它进展顺利（在与苹果公司打了几个小时的电话之后）。

据我所知，主要问题是那些帮助台人员知道事情会发生变化，但他们不知道何时以及如何发生变化。可能是由于 iPad 的到来和相关的时间线）。反正。这是可能的，而且非常容易。发送您的请求，等待几周（现在可能需要几天），然后您就可以进行转移了。但是有一个问题：他们的迁移代码中可能存在一些错误，因为苹果在迁移后混合了开发/主帐户的名字和姓氏。好吧，谁在乎。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2011-05-16T23:44:36.640

我在这方面有自己的经验，我从 Apple Developer Relations 得到的答案（虽然花了一个月的时间才收到电子邮件回复，而后续电话花了 6 周时间）是（简而言之）他们目前不提供将单个应用程序从一个开发者帐户转移到另一个帐户的任何方式。

他这样做的方式是说进行这种转移只有一个“选项”，即从当前使用的帐户中删除应用程序，然后以相同名称从新帐户重新提交到 Apple 商店（但它会有一个新的应用商店 ID）。我指出（他承认）这会删除任何现有的用户评论，破坏现有用户的升级路径，破坏 iAd、应用内购买和游戏中心集成。所以这根本不是一个解决方案。

他还说，不可能将所有应用程序的所有权转移到另一个现有帐户（它们似乎缺乏移动单个应用程序的粒度）。但是，如果我想将我所有的应用程序交给另一个人，可以通过创建一个公司（可能是 S-Corp，尽管他没有建议），将我的帐户所有权转移给 S-Corp（这是允许的）如果我是部分所有者），然后将 s-corp 出售给新所有者。（对吧？）

我计划采用的方法如下（我将根据我的成功进行更新），在我的具体情况下，我有一个付费应用程序（.99），我正试图转移给另一个所有者：

1.  我将使用相同的 AppID 创建一个轻量级应用程序，该 AppID 旨在通知用户该应用程序已更改所有者，并提供指向应用程序商店的链接，他们可以在其中下载新应用程序。启动时会将他们的 UDID 的散列形式上传到服务器（我现在必须维护），将他们列为以前的客户。

2.  我会将这个新的轻量级应用程序上传到我现有的帐户，作为对其他现有应用程序的升级（这样当用户更新时，他们将被标记为现有客户，显示一条解释情况的消息，以及指向新应用）

3.  我会将我的付费应用程序转换为具有某些功能的轻量级应用程序，但需要在应用程序内购买 0.99 才能获得全部功能。此外，这个新应用程序将检查我的服务器以查看 UDID 是否在现有客户数据库中，如果是，则为他们提供完整功能（无需进行应用内购买）。

……啊！:) 这对客户来说是一种丑陋的体验，对开发人员来说是一大堆工作……但这是 Apple 提供的唯一选择。（虽然，我不确定它是否会起作用，因为他们完全有可能会从商店拒绝我的轻量级“更新”应用程序，从而也阻止黑客升级路径）

**更新**：对于我试图向其提交申请的人来说，工作量太大。最终没有按计划进行。认为它可能仍然可以工作，并且很想听听任何尝试或成功的人的意见:)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-06-24T21:45:27.167

iTunesConnect 现在允许在某些应用程序限制的情况下进行应用程序传输（目前不允许使用 iCloud 或推送通知应用程序。当然，本地通知是可以的。）

请参阅有关应用程序传输的 iTunesConnect 常见问题解答... [https://itunesconnect.apple.com/WebObjects/iTunesConnect.woa/wo/10.0.0.9.1.0.9.1.5.10.1](https://itunesconnect.apple.com/WebObjects/iTunesConnect.woa/wo/10.0.0.9.1.0.9.1.5.10.1)

如果您的 iTunesConnect 登录具有“法律”角色权限，您只能发起或接受转移。

**转移后：** teamId和**bundleID****根本**不会改变。任何应用内购买 ID 也不会。

在我公司的开发人员帐户中，我现在看到一个应用程序，其 TeamID.BundleID 与我在从另一家公司购买的源代码中看到的完全相同（并且该源代码是单独提供的，而不是通过 Apple）...

```
ex. BundleID = com.<some-other-company>.<purchased-app-name> 
```

这个 bundleId 现在列在我在 iTunesConnect 的配置文件中列出的其他应用程序中。我只是为我新购买的应用程序创建了新的开发和分发/临时配置文件。然后我将新的配置文件下载到 Xcode 中，就像您自己的任何应用程序一样。

相当无痛。谢谢苹果。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-09-08T11:41:28.747

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-06-11T06:39:23.610

从现在开始，现在可以使用 iTunesConnect。

> 现在可以在 iTunes Connect 中将应用程序从一个开发者转移到另一个开发者，例如在收购之后或分销协议到期时。转移应用程序的所有权不会影响应用程序在 App Store 上的可用性。所有评分和评论都将被转移，您的客户将继续访问所有可用的应用程序更新。要转移应用程序，请转到 iTunes Connect 上管理您的应用程序模块中的应用程序摘要页面，然后单击转移应用程序。确保：
> 
> *   您的帐户处于活动状态
> *   您已接受最新版本的合同
> *   您的应用至少有一个已获批准的版本
> *   您的应用处于可供销售、无效二进制、已拒绝、开发者拒绝或开发者已从销售状态中删除任何
>     关联
> *   应用内购买处于“准备提交”、“准备出售”、“已拒绝”、“开发者已从销售中移除”或“已批准”状态
> *   您知道收件人的团队代理及其团队 ID 的 Apple ID。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-22T22:57:49.900

据我了解，这是可以做到的，但它需要 iTunes Store 团队的手动干预，可能需要几个月的时间，并且可能会涉及您的应用在任何一个帐户下都没有销售的一些时期。如果您知道您的客户将是谁，只需将其放在他们的帐户下即可。如果没有，请记住将来翻转应用程序并非易事，并相应地调整您的业务模式。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-02-03T13:23:46.807

除了我认识到的已经提到的事情之外，可能会出现某些问题，这些问题在 AppStore 指南或文档中没有提到。

我发现有订阅的应用程序存在几个问题（截至 2015 年 1 月不可转让）。在尝试转移应用程序后，我通过 iTC 开发人员支持中心（即帮助部分）中的常见问题解答发现了以下内容（链接到[常见问题解答](https://itunespartner.apple.com/en/apps/faq/App%20Transfer_Troubleshooting)部分）...

> 您**不能转移**包含或使用以下内容的应用程序：
> 
> *   任何版本的应用程序中的 iCloud 权利
> *   任何版本的应用程序中的存折权利
> *   与收件人应用程序之一的 SKU 匹配的 SKU，包括以前删除的 SKU
> *   与收件人应用程序之一的应用内购买产品 ID 匹配的应用内购买产品 ID，包括之前删除的应用内购买
> *   已批准的自动续订、非续订或免费订阅应用内购买，包括之前删除的应用内购买订阅 与其他 Mac 应用共享应用程序组容器目录的沙盒 Mac 应用也无法转移。
> 
> **要传输任何这些类型的应用程序，接收方必须将应用程序创建为新应用程序。当前客户、评分和评论无法转移到新应用。**

**通常**的要求是：

> 要转移应用程序，请确保：
> 
> *   转让方和接收方拥有活跃的开发者账户并接受当前有效的所有主协议的最新版本
> *   该应用程序至少有一个已获批准的版本
> *   应用程序处于可供销售、无效二进制、已拒绝、开发者拒绝或开发者已从销售中移除状态
> *   任何关联的应用内购买都处于准备提交、准备销售、已拒绝、开发人员已从销售中删除或已批准状态
> *   您知道接收方团队代理的 Apple ID 及其团队 ID 如果应用程序使用 iAd，则转让方和接收方必须已接受所有 iAd 合同的最新版本。

希望这有助于**在您尝试转移应用程序之前**避免发生意外。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-06-11T04:33:37.343

从 2013 年 6 月开始就可以了。您可以非常轻松地将应用程序转移给其他开发人员 - 这是 Apple 的[官方常见问题解答](https://itunesconnect.apple.com/WebObjects/iTunesConnect.woa/wa/jumpTo?page=faqIndex&group=app_transfer)（适用于注册开发人员）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-07-12T00:48:58.110

猜猜我迟到了，但苹果刚刚在 iTunes Connect 中添加了一个按钮来做到这一点。登录您的 iTunes Connect 帐户，转到“管理应用程序”并单击您要转移的应用程序。在右上角的部分，有一个按钮可以立即转移您的应用程序。

干杯!

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-04-01T18:27:19.130

来自 iTunes Connect 的最新更新：

> **我将我的应用程序卖给了另一个开发者，并且无法再在 App Store 上分发它。我可以将应用转移到新开发者的 iTunes Connect 帐户吗？**
> 
> 不可以，您不能将应用转移到 iTunes Connect 上的另一个开发者帐户。要将应用程序添加到另一个帐户，请从当前帐户中删除该应用程序并将其上传到新的 iTunes Connect 帐户。
> 
> 请注意，将应用程序上传到新的 iTunes Connect 帐户将使当前客户无法接收应用程序的自动和免费更新。所有客户评论、评级和排名信息将被重置。您将无法在旧帐户中重复使用应用名称和 SKU。如果您已上传二进制文件或将应用程序与 iAd Network 一起使用，您的 Bundle ID 也将不可重复使用。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2010-03-11T16:41:31.273

由于目前不支持所有权转让并且属于“例外流程”，因此不要将其视为您的操作模式是有道理的。

您面临的最大问题是：该应用程序与开发者帐户绑定，并且您希望在转移应用程序后保留您的开发者帐户。

因此，为什么不设置一个*新*的开发者帐户，其唯一目的是成为该应用程序的持有者，并且当您出售该应用程序时，您只需将开发者帐户凭据转移给新所有者即可。

此时，他们可以更新姓名、地址、公司名称、银行信息等。

当然，您的转让合同中会有一些措辞解释，在此期间，您从 Apple 获得的任何资金将如何转给新所有者（在此设置一个时间限制——比如 90 天——这样他们就不会占用永远更新信息。）

我没有尝试过，但这似乎是一个可行的解决方案。同样，问题是该应用程序与开发者帐户绑定，您不想转移您的帐户。因此，这只是有意义™。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-24T00:48:46.833

还有一些额外的考虑：

如果您只是可以在幕后切换应用程序的所有权，从而更改合同，而不是应用程序本身，那么您可能会没事。

但如果你只是要转移你的源代码，应用程序的未来所有者将不得不用他自己的证书对其进行签名，这基本上会将应用程序呈现为一个“新”应用程序。

用户将丢失他们的设置（如果您的应用程序进行了一些配置持久性）并且他们将丢失应用程序商店中的应用程序历史记录（排名等）。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-06-11T05:05:01.147

根据苹果今天（iOS 7 发布后）的新公告，这已成为可能。它说：“应用程序现在可以在 iTunes Connect 中从一个开发者转移到另一个开发者，例如在收购之后或分销协议到期时。转移应用程序的所有权不会影响应用程序在 App Store 上的可用性。所有评级和评论将被转移，您的客户将继续有权访问所有可用的应用程序更新。”

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-03-22T19:07:09.470

据我所知，没有办法将应用程序转移给不同的用户/公司。我认为该应用程序应该从一开始就在您的客户帐户中。否则，您可能也会遇到付款问题（支付给您的人而不是您的客户）。

为什么不在发布之前将应用程序卖给客户。如果他们想在它发布之前看到它运行，只需向他们发送一个使用临时证书构建的版本。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-11-17T08:23:26.670

有帮助的东西：

[2014 年 9 月 5 日发布的带有新 itunesconnect UI 的 Apple 站点文档](https://developer.apple.com/library/ios/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/Chapters/TransferringAndDeletingApps.html)

[使用 github 传输代码](http://www.sitepoint.com/transfer-ownership-ios-app/)

注意：**使用代理角色账户**，**也许你应该先点击“协议、税务和银行”来申请合同**。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-09-08T14:03:33.523

我不相信您可以将所有权转移到另一个帐户。但一个简单的解决方案是将 URL 方案添加到您的应用程序，以允许将数据从您的应用程序传输到您的客户将使用相同源发布的新应用程序。

不过，新应用程序必须是免费的（也许是精简版？），这样您的老客户就不会被迫再次购买。我能看到的唯一真正的缺点是，从营销的角度来看，新应用程序基本上会重新开始，这当然不是一件小事！

Mobile Orchard 有一篇关于从 Lite 到付费版本的应用程序的数据迁移的文章，您可能会感兴趣：

[使用自定义 URL 处理程序的 Lite-to-paid iPhone 应用程序数据迁移](http://www.mobileorchard.com/lite-to-paid-iphone-application-data-migrations-with-custom-url-handlers/)

# hardware - 处理器的路数是什么意思

> ID：671383
> 
> 赞同：3
> 
> 时间：2009-03-22T18:11:22.520
> 
> 标签：hardware, cpu

我正在做一些硬件工作，但我不知道 4 路处理器和 8 路处理器之间有什么区别。可以请任何人澄清方式是什么意思吗？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T18:13:15.357

CPU 核心数。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-04T23:43:13.593

不对！！！8路处理实际上是4核......称为四核，4路处理实际上是双核处理器

# asp.net - 浏览器无限期等待服务器

> ID：671393
> 
> 赞同：1
> 
> 时间：2009-03-22T18:20:31.453
> 
> 标签：asp.net, timeout

我对长时间运行的页面有疑问。ASP.NET 页面大约需要 20 分钟才能生成并提供给浏览器。

服务器成功完成响应（根据日志和 ASP.NET Web 跟踪），我假设将其发送到浏览器。但是，浏览器永远不会收到该页面。它（IE8 和 Firefox 3 两者）一直在旋转（我已经让它运行了几个小时，没有任何反应）。

此问题仅出现在共享主机服务器上。当我在开发机器或内部服务器上运行相同的应用程序时，一切正常。

我试过提琴手和数据包嗅探，看起来服务器没有发回任何东西。它甚至不发送保持活动的数据包。然而，我尝试过的两种浏览器都不会在预定义的超时期限后超时（我相信在 IE 中为 1 小时，不确定在 Firefox 中是什么）。

最后一个数据包服务器从浏览器发送回 ACK 到 POST。

我已经从不同的客户端机器上尝试过这个，以确保它不是我机器上的损坏配置。

我怎样才能进一步诊断这个问题？为什么浏览器不会超时，即使没有保持活动的数据包？

ps服务器是Windows 2003，所以是IIS6。它曾经在共享主机上运行良好，但他们改变了一些东西（当他们搬到新位置时）并且它坏了。试图弄清楚是什么。

pps 我知道我可以更改页面设计以避免页面花费这么长时间才能获得服务。我会这样做，但我也想找到这个问题的原因。我想继续关注这个问题，并避免页面可能的替代设计（使用 AJAX 或其他任何东西）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T18:42:13.803

检查服务器的连接超时（在网站属性页面上）。

更好的方法是发送请求，在服务器上开始计算，并使用 Javascript 计时器为页面提供服务，该计时器不断向自身发送请求。回发时，此页面检查服务器进程是否已完成。当进程仍在运行时，它会用另一个计时器进行响应。完成后，它会重定向到结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-14T09:49:02.913

你能澄清一下你是如何解决这个问题的吗？好像我也有同款。我收到 .docx 报告，两个浏览器（IE10 和 Fx37）都无限期地等待响应（继续旋转）。但它在 VS2012 的 IIS Express 和我的本地主机 IIS7 上运行良好。虽然服务器有IIS6.1

当它在 localhost 上运行时，只需几分钟即可获得报告。

# java - 我在哪里可以找到 Java 反编译器？

> ID：671394
> 
> 赞同：22
> 
> 时间：2009-03-22T18:21:45.007
> 
> 标签：java, decompiler

[http://www.kpdus.com/jad.html#download](http://www.kpdus.com/jad.html#download)？

上面指向 JAD（Java 反编译器）的链接不起作用。还有其他地方可以找到Java反编译器吗？

# c - 用于 c 或 c++ 的简单 2d 跨平台图形库？

> ID：671395
> 
> 赞同：42
> 
> 时间：2009-03-22T18:22:38.017
> 
> 标签：c, graphics, cross-platform

如标题所示，我需要一个跨平台的 2d 图形库，并提供简单的功能，如 Basic；本质上，我只需要为像素绘制某种颜色——我不需要硬件加速或任何类型的 3d 支持。我找到了几个，但它们不是跨平台的。

有人知道我的解决方案吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-03-22T18:36:45.050

[SDL](http://www.libsdl.org/)呢？

也许它对于您的需求来说有点太复杂了，但它肯定是跨平台的。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-05T05:19:56.733

我是否错过了一些想知道为什么没有人建议使用[OpenGL](http://www.opengl.org)的东西？将它用于 2d 将非常简单。OP 只想为像素着色。它不会比 glBegin/glColor/glVertex/glEnd 更简单。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-22T18:24:14.877

*   [qt 5](https://doc.qt.io/qt-5/)
*   [GTK+](http://www.gtk.org/)
*   [开罗](http://cairographics.org/)
*   还有更多...

[没有特别的顺序。]但是，如果您有任何其他要求，请告诉我们。顺便说一句：我不只是在这里发布谷歌查询的结果，我已经使用了所有这些（和 SDL——我在 SDL 中编写了我的前几款游戏 :) 我想说没有一组要求，很难选择在列出的那些之中。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-22T20:36:37.460

**重量级：**

*   GTK
*   QT
*   WxWidgets

**轻的：**

*   FLTK
*   狐狸
*   总热量
*   Lua IUP
*   终极++
*   dlib

**没有 GUI 小部件的绘图框架：**

*   SDL
*   开罗

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-05T04:20:11.883

[http://www.allegro.cc/](http://www.allegro.cc/)

[http://en.wikipedia.org/wiki/Allegro_library](http://en.wikipedia.org/wiki/Allegro_library)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-09-06T15:49:44.983

我遇到的一个简洁的引擎是[Angel-Engine](http://code.google.com/p/angel-engine/)。来自项目网站的信息：

*   跨平台功能（Windows 和 Mac）
*   Actors（具有颜色、形状、响应、属性等的游戏对象）
*   透明纹理
*   “动画”（以定义的间隔交换纹理）
*   刚体物理
    *   聪明的程序员可以用它做软体物理
*   声音
*   多种字体的文本渲染
*   粒子系统
*   一些基本的人工智能（状态机和寻路）
*   配置文件处理
*   日志记录
*   从鼠标、键盘或 Xbox 360 控制器输入
    *   绑定来自配置文件的输入
*   Python 脚本
    *   游戏内控制台

一些用户（包括我）已经成功（没有任何重大问题）在 linux 下编译它。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-22T18:34:29.440

我会推荐[DISLIN](http://www.dislin.de)。它是跨平台的，支持多种语言，并且具有非常直观的例程命名。

另外，刚刚注意到没有人提到[PLPLOT](http://plplot.sourceforge.net/)，也是跨平台的，多语言的......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-15T03:52:07.697

您可以使用的毕加索图形库：跨平台

[https://code.google.com/p/picasso-graphic/](https://code.google.com/p/picasso-graphic/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-03-02T15:31:13.583

.Net 的跨平台 2D 图形库是[Little Vector Library](http://littlevectorlibrary.blogspot.co.uk/) 您可以将它与 Unity 3D（推荐）或 Xamarin 结合使用，例如，在各种平台上创建 2D 图形。

# apache-flex - 在 Flex 应用程序中使用外部 SWF - 复制 MovieClip？

> ID：671397
> 
> 赞同：1
> 
> 时间：2009-03-22T18:23:49.310
> 
> 标签：apache-flex, actionscript-3

我正在开发一个使用许多对象的 Flex 应用程序，例如在 Flash 中创建的 LED、灯泡、仪表。这些对象内部由几个小的 MovieClip 组成，并且内部有自己的逻辑。最初的要求之一是对象必须在运行时加载，因此它们被导出为 SWF，而不是 SWC。但是，当我们尝试复制加载的 SWF 时遇到了问题。事实证明，MovieClip 类既没有复制构造函数，也没有允许我们克隆现有 MovieClip 的方法。这样我们最终每次都从 hdd 加载一个对象，这会带来很多开销。像 ActionScript 3 这样的语言是否可能没有这样的机制？我们错过了什么吗？如果不是，我是否更正了唯一的解决方案是使用 Flash 组件工具包，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T18:52:28.693

加载 MovieClip 后，是否可以使用 getDefinitionByName() ，如此处所示？

[http://livedocs.adobe.com/flex/3/langref/flash/utils/package.html#getDefinitionByName()](http://livedocs.adobe.com/flex/3/langref/flash/utils/package.html#getDefinitionByName())

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T07:52:04.883

另一种解决方案：

```
 private function duplicateImg(sourceLoaderInfo:LoaderInfo, target:Image):void
    {
        var ba:ByteArray = sourceLoaderInfo.bytes;          
        var dupCliploader:Loader = new Loader();

        dupCliploader.contentLoaderInfo.addEventListener(
          Event.COMPLETE, bytesLoaded);

        dupCliploader.loadBytes(ba);
    }

    private function bytesLoaded(event:Event):void
    {           
    var mc:MovieClip = event.currentTarget.content as MovieClip;

    _img.source = mc;
    _img.width = mc.width;
    _img.height = mc.height+5;                  
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T16:33:19.503

您是正确的，因为没有内置的方法来复制影片剪辑。然而，有变通办法。在我看来，最简单的方法是提供电影剪辑类。

您不必进行实际的课程。在需要复制的最上面的影片剪辑上设置链接时，只需在类字段中写入任何名称。所以你的 LED 电影剪辑的名称，灯泡的另一个名称等。

好处是现在您有了一个可以从中启动对象的类。

不，当您抓取其中一个影片剪辑时，您可以使用以下方法复制它：

```
public function DuplicateDisplayObject(dO:DisplayObject):DisplayObject
{
    if(dO == null)
        return null;
    var dOClass:Class = Object(dO).contructor;
    return DisplayObject(new dOClass());
} 
```

这假设您实际上可以首先获得其中一个影片剪辑的原因。请注意，它不会复制影片剪辑的状态。另一个更重要的注意事项是，这仅在您将影片剪辑链接到类时才有效。这些类不必存在（flash 将为您创建空类）。

其他解决方案可能是：

*   编译类而不包括它们（参见 flex 编译器的“external-library-path”标签），并在运行时加载它们（来自 swf）。
*   将类编译为 RSL（运行时共享库​​），swc 将在运行时加载。

Adobe 有更多关于如何做到这一点的信息，应该很容易在他们的网站上找到。

一个更奇特的解决方案是复制对象的字节码。不确定这是否适用于显示列表中的某些内容，正确地不是。

关于使用 getDefinitionByName() 的解决方案：如果我没记错的话，你仍然需要给电影剪辑假类，因为 getQualifiedClassName 只返回电影剪辑类。但我可能是错的。

# pattern-matching - 确定两个或多个摘要是否相似

> ID：671398
> 
> 赞同：0
> 
> 时间：2009-03-22T18:23:52.100
> 
> 标签：pattern-matching, neural-network, similarity, fuzzy

问题如下：

我有一个摘要，通常在 20 到 50 个单词之间，我想将其与其他相对相似的摘要进行比较。摘要所指的一般类别和地理位置是已知的。

例如，如果来自同一地区的人们正在撰写关于建造房屋的文章，我希望能够列出这些摘要，并且在一定程度上确定他们实际上指的是建造房屋而不是建造车库或后院游泳池。

该数据集目前大约有 50 000 个文档，每天大约有 200 个文档的增长速度。

首选语言是 Python、PHP、C/C++、Haskell 或 Erlang，无论哪种语言都能完成工作。另外，如果您不介意，我想了解选择特定语言的原因。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-19T05:31:38.593

您可以尝试使用一些字符串相似度度量，例如 Jaccard 和 Dice，但不是计算字符重叠，而是计算单词重叠。例如，使用 Python，您可以使用以下内容：

```
def word_overlap(a, b):
    return [x for x in a if x in b]

def jaccard(a, b, overlap_fn=word_overlap):
    """
    Jaccard coefficient (/\ represents intersection), given by :
        Jaccard(A, B) = (A /\ B) / (|a|) + (|b|) - (A /\ B)
    """
    c = overlap_fn(a, b)
    return float(len(c)) / (len(a) + len(b) - len(c))

jaccard("Selling a beautiful house in California".split(), "Buying a beautiful crip in California".split()) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-11T14:29:53.250

由于 python 对集合有很好的原生支持，我们可以将[JGs 代码](https://stackoverflow.com/questions/671398/determining-if-two-or-more-summaries-are-similar/1149292#1149292)修改为，

```
def jaccard(a, b):
    """
    Jaccard coefficient (/\ represents intersection), given by :
        Jaccard(A, B) = (A /\ B) / (|a|) + (|b|) - (A /\ B)
    """
    c = a.intersection(b)
    return float(len(c)) / (len(a) + len(b) - len(c))

jaccard(set("Selling a beautiful house in California"), set("Buying a beautiful crip in California")) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-22T19:37:51.423

你可以看看[WEBSOM 项目](http://websom.hut.fi/websom/)。

尽管他们的网站今年还没有完全更新，但正在解决的问题非常相似。由于他们正在处理与 10 年前类似（甚至更多）的数据量，因此今天您几乎可以在手机上运行这些算法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-22T19:41:14.223

没有真正可以选择的特定语言。您正在尝试查找语义相似性。这是一个非常大的区域。您可能对这篇论文感兴趣：

[基于语料库和基于知识的文本语义相似度测量](http://www.cse.unt.edu/~rada/papers/mihalcea.aaai06.pdf)

# javascript - js写没有空白页

> ID：671402
> 
> 赞同：0
> 
> 时间：2009-03-22T18:26:24.793
> 
> 标签：javascript, on-the-fly

嘿，我知道我问这个问题似乎完全是个傻瓜，但我真的从来不知道，我发现没有什么能帮助我。我使用 javascript 生成了这个字符串，我想将它附加到我现有的网页上。我用过 document.write(); 或者只是 document.getElementbyId('').append(); 我只是无法将文档附加到我选择的 id ...

我有：

```
<p><div id="dT">Bienvenido, Hoy es :: <div id="fecha" class="reloj"></div></div></p> 
```

我想在 :: 之后附加结果字符串

js 在一个单独的文件中，但它开始在加载时工作。

* * *

**编辑回答**

我没有，但我只是尝试过，仍然没有任何反应，甚至没有错误=/这就是我所做的：

```
x = Hoy + " " + es + " dia " + dia + " del " + yr;

document.getElementbyId('dT').innherHTML += x; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T18:40:09.237

似乎您有一些拼写错误，JS 区分大小写，正确的函数名称是`getElementById`（大写“B”）并且您必须设置`innerHTML`属性不是“innherHTML”：

```
document.getElementById('dT').innerHTML += x; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T18:43:40.743

如果您想在页面加载时将文本放在那里，请使用 document.write：

```
<p><div id="dT">Bienvenido, Hoy es :: <div id="fecha" class="reloj">
<script type="text/javascript">

x = Hoy + " " + es + " dia " + dia + " del " + yr;

document.write(x);

</script>
</div></div></p> 
```

您也可以设置 innerHTML 属性，但是您必须确保脚本在浏览器读取元素后运行。您还必须在 getElementById 调用中使用元素的 id：

```
x = Hoy + " " + es + " dia " + dia + " del " + yr;

document.getElementById('fecha').innerHTML = x; 
```

编辑：
如果您希望文本显示在同一行，您可能需要将 div 更改为跨度：

```
<p><div id="dT">Bienvenido, Hoy es :: 
<span id="fecha" class="reloj"></span>
</div></p> 
```

# python - 内存效率：一个大字典还是小字典的字典？

> ID：671403
> 
> 赞同：38
> 
> 时间：2009-03-22T18:27:48.957
> 
> 标签：python, memory, dictionary, performance

我正在用 Python (2.6) 编写一个应用程序，它要求我使用字典作为数据存储。

我很好奇拥有一本大字典是否更节省内存，或者将其分解为许多（很多）较小的字典，然后拥有一个包含对所有较小字典的引用的“索引”字典。

我知道列表和字典通常会产生很多开销。我在某处读到，python 在内部分配了足够的空间，字典/列表项的 # 是 2 的幂。

我对 python 还很陌生，我不确定是否还有其他类似的意外内部复杂性/惊喜，这对于我应该考虑的普通用户来说并不明显。

困难之一是知道 2 系统的力量如何计算“项目”？每个 key:pair 是否计为 1 个项目？知道这一点似乎很重要，因为如果您有一个 100 项的整体字典，那么将分配 100^2 项空间。如果您有 100 个单项字典（1 个键：对），那么每个字典只会分配 1^2（也就是没有额外分配）？

任何明确列出的信息都会非常有帮助！

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-03-22T19:43:19.743

三个建议：

1.  **使用一本字典。**
    它更容易，更直接，并且其他人已经为您优化了这个问题。在您实际测量您的代码并将性能问题追溯到这部分之前，您没有理由不做简单直接的事情。

2.  **后期优化。**
    如果您*真的很*担心性能，那么将问题抽象为一个类来包装您最终使用的任何查找机制并编写代码来使用该类。如果您发现需要其他数据结构以获得更高的性能，您可以稍后更改实现。

3.  **阅读哈希表。**
    字典是[哈希表](http://en.wikipedia.org/wiki/Hash_table)，如果您担心它们的时间或空间开销，您应该阅读它们是如何实现的。这是基本的计算机科学。简而言之，哈希表是：

    *   平均情况**O(1)**查找时间
    *   **O(n)**空间（预计大约**2n**，取决于各种参数）

    我不知道你在哪里读到它们是**O(n^2)**空间，但如果它们是，那么它们就不会像今天在大多数语言中那样广泛、实用。哈希表的这些良好属性有两个优点：

    1.  **O(1)**查找时间意味着您不会为拥有更大的字典而支付查找时间成本，因为查找时间不取决于大小。
    2.  **O(n)**空间意味着您不会从将字典分解成更小的部分获得任何好处。空间与元素的数量成线性关系，所以很多小字典不会比一个大字典占用更少的空间，反之亦然。**如果它们是O(n^2)**空间，这将是不正确的，但幸运的是，它们不是。

    以下是一些可能有帮助的资源：

    *   关于哈希表的[维基百科文章](http://en.wikipedia.org/wiki/Hash_table)给出了哈希表中使用的各种查找和分配方案的一个很好的列表。
    *   [GNU Scheme 文档](http://www.gnu.org/software/mit-scheme/documentation/mit-scheme-ref/Resizing-of-Hash-Tables.html)很好地讨论了您可以期望哈希表占用多少空间，包括关于为什么*“哈希表使用的空间量与表中的关联数成正比”的*正式讨论。这可能会让你感兴趣。

    如果您发现确实需要优化字典实现，可以考虑以下几点：

    *   这是 Python 字典的 C 源代码，以防您需要所有详细信息。这里有丰富的文档：
        *   [dictobject.h](http://svn.python.org/view/python/trunk/Include/dictobject.h?revision=59564&view=markup)
        *   [dictobject.c](http://svn.python.org/view/python/trunk/Objects/dictobject.c?revision=68128&view=markup)
    *   这是一个[python实现](http://pybites.blogspot.com/2008/10/pure-python-dictionary-implementation.html)，以防你不喜欢阅读C。
        （感谢[Ben Peterson](https://stackoverflow.com/users/33795/benjamin-peterson)）
    *   Java Hashtable类[文档](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Hashtable.html)讨论了负载因子如何工作，以及它们如何影响散列占用的空间。请注意，在您的负载因子和您需要重新散列的频率之间需要*权衡*。重新哈希可能会很昂贵。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-22T19:12:25.620

如果你使用的是 Python，你真的不应该首先担心这种事情。*只需以最适合您*需求的方式构建您的数据结构，而不是计算机的。

这有点过早优化的味道，而不是性能改进。如果确实存在瓶颈，请分析您的代码，但在那之前，只需让 Python 做它所做的事情并专注于实际的编程任务，而不是底层机制。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-22T19:19:15.697

“简单”通常比“聪明”好，特别是如果您没有经过测试的理由超越“简单”。无论如何，“内存效率”是一个模棱两可的术语，当您考虑持久化、序列化、缓存、交换以及其他人已经考虑过的一大堆其他东西时，需要权衡取舍，因此在大多数情况下您不会需要。

稍后再考虑“正确处理它的最简单方法”。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-22T19:36:51.597

过早的优化 bla bla，不要这样做 bla bla。

我认为你误解了两个额外分配的*力量*。我认为它只是两个的*乘数*。x*2，不是 x^2。

我在各种 python 邮件列表中多次看到这个问题。

关于记忆，这里是一个这样的讨论的释义版本（有问题的帖子想要存储数亿个整数）：

1.  如果您只想测试成员资格，set() 比 dict() 更节省空间
2.  gmpy 有一个位向量类型类，用于存储密集的整数集
3.  字典保持在 50% 到 30% 之间，一个条目大约为 12 个字节（尽管实际数量会因平台而有所不同）。

所以，你拥有的对象越少，你要使用的内存就越少，你要做的查找就越少（因为你必须在索引中查找，然后在实际值中进行第二次查找） .

像别人说的，profile看你的瓶颈。保持成员资格 set() 和值 dict() 可能会更快，但您将使用更多内存。

我还建议将其重新发布到特定于 python 的列表中，例如 comp.lang.python，其中充满了比我更有知识的人，他们会为您提供各种有用的信息。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-29T10:37:13.420

如果您的字典太大以至于无法放入内存，您可能需要查看[ZODB](http://www.ibm.com/developerworks/aix/library/au-zodb/)，这是一个非常成熟的 Python 对象数据库。

db 的“根”具有与字典相同的接口，您不需要一次将整个数据结构加载到内存中，例如，您可以通过提供开始和结束键仅迭代结构的一部分。

它还提供事务和版本控制。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-22T19:19:59.190

老实说，无论是在性能还是内存使用方面，您都无法分辨出两者的区别。除非您要处理数千万或更多的项目，否则性能或内存影响只是噪音。

从你第二句话的措辞来看，一本大字典听起来是你的第一个倾向，并且与你试图解决的问题更匹配。如果这是真的，那就去吧。关于 Python，您会发现，每个人都认为“正确”的解决方案几乎总是尽可能清晰和简单。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-22T19:03:03.240

很多时候，字典的字典除了性能原因之外很有用。即，它们允许您存储有关数据的上下文信息，而无需在对象本身上有额外的字段，并使查询数据子集的速度更快。

在内存使用方面，一个大字典比多个小字典使用更少的内存是有道理的。请记住，如果您正在嵌套字典，则每增加一层嵌套都会使您需要分配的字典数量大致翻倍。

在查询速度方面，由于需要的查找次数增加，多个 dicts 将花费更长的时间。

所以我认为回答这个问题的唯一方法是让你分析你自己的代码。但是，我的建议是使用使您的代码最干净和最容易维护的方法。在 Python 的所有特性中，字典可能是为了获得最佳性能而进行了最严格的调整。

# performance - 实体框架和性能

> ID：671405
> 
> 赞同：2
> 
> 时间：2009-03-22T18:28:07.177
> 
> 标签：performance, entity-framework

我正在尝试使用实体框架开发我的第一个 Web 项目，虽然我喜欢使用 linq 而不是编写 sql 的方式，但我确实有一些严重的性能问题。我在一个表中有很多未处理的数据，我想对其进行一些转换，然后插入到另一个表中。我遍历所有对象，然后将它们插入到我的新表中。我需要做一些小的比较（这就是我需要将数据插入另一个表的原因），但是对于性能测试，我已经删除了它们。下面的代码（大约需要设置 12-15 个属性）花费了 21 秒，这是相当长的时间。它通常这么慢吗，我可能会做错什么？

```
DataLayer.MotorExtractionEntities mee = new DataLayer.MotorExtractionEntities();
List<DataLayer.CarsBulk> carsBulkAll = ((from c in mee.CarsBulk select c).Take(100)).ToList();

foreach (DataLayer.CarsBulk carBulk in carsBulkAll)
{
    DataLayer.Car car = new DataLayer.Car();
    car.URL = carBulk.URL;
    car.color = carBulk.SellerCity.ToString();
    car.year = //... more properties is set this way

    mee.AddToCar(car);
}
mee.SaveChanges(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T20:31:14.377

您不能使用实体框架创建批量更新。

假设您需要使用如下 SQL 语句更新表中的行：

```
UPDATE table SET col1 = @a where col2 = @b 
```

使用 SQL，这只是到服务器的一次往返。使用实体框架，您（至少）有一次往返加载所有数据的服务器，然后您修改客户端上的行，然后它将*逐行*发送回。

这会减慢速度，特别是如果您的网络连接受到限制，并且您的行数不止几行。

因此，对于这种更新，存储过程仍然效率更高。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T19:11:32.783

我已经对实体框架进行了很多试验，但没有看到任何真正的性能问题。

您的代码的哪一行导致了很大的延迟，您是否尝试过调试它并只是测量哪种方法花费的时间最多？

此外，您的数据库结构的复杂性可能会减慢实体框架的速度，但不会达到您所说的速度。您的数据库结构中是否存在一些“无限循环”？如果没有数据库结构，真的很难说哪里出了问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T19:40:01.030

您可以在直接 SQL 中尝试相同的方法吗？

问题可能与您的数据库有关，而不是与实体框架有关。例如，如果您有大量索引和大量检查约束，则插入可能会变慢。

我还看到了插入从未备份过的数据库的问题。事务日志无法回收并且正在疯狂增长，导致单个插入需要几秒钟。

直接在 SQL 中尝试此操作会告诉您问题是否确实出在 EF 上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T19:58:19.783

我想我解决了这个问题。我一直在本地运行该应用程序，并且数据库位于另一个国家/地区（邻国，但绝不会更少）。我尝试将应用程序加载到服务器并从那里运行它，然后只用了 2 秒而不是 20 秒。我尝试传输 1000 条记录，耗时 26 秒，这是一个相当大的更新，尽管我没有知道这是否是将 1000 条记录保存到数据库的“常规”速度？

# exception - 显示友好的错误消息

> ID：671406
> 
> 赞同：11
> 
> 时间：2009-03-22T18:28:35.757
> 
> 标签：exception, custom-errors

我很好奇是否有人考虑过**桌面应用程序**错误消息中的措辞。作为一名开发人员，我总是戴上我的程序员帽子，并以一种看起来像机器人在与用户交谈的方言展示它。

例如：

*   **无法**打开文件___
*   无法**检索**设置文件
*   **更新数据库**时出错****
***   **无法设置**____*   发生未知错误**

 **这些都没有说“友好的应用程序”。有没有人知道用较少机器人语言表达错误的任何资源或方法 - 对于常见错误，如 IO 问题、数据库问题、空引用等。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-22T19:02:24.303

Windows 桌面设计指南中有[相当广泛的关于错误消息的文章。](http://msdn.microsoft.com/en-us/library/windows/desktop/dn742471.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-22T19:05:08.023

[Apple 对在其人机界面指南](http://developer.apple.com/library/ios/Documentation/UserExperience/Conceptual/MobileHIG/UIElementGuidelines/UIElementGuidelines.html#//apple_ref/doc/uid/TP40006556-CH13-SW1)中编写良好的警报消息有话要说。

*   简短而具体
*   告诉我们如何解决这个问题
*   不要倾斜，告诉我们它出了问题，如果它有
*   避免让错误感觉是我们的错

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-22T18:36:22.320

您作为示例发布的消息对开发人员的意义大于对最终用户的意义。

对于作为用户向我抛出的任何类型的错误，我觉得很烦人的一件事是，当我不知道它为什么会发生时。这就是为什么此类错误消息应包含一些有关该问题的信息，以供非程序员理解。就像打开文件失败一样，可以检查文件是否存在、权限是否正常或给定的路径是否在网络上。

Jeff Atwood也有[一篇关于有趣错误消息的精彩博文](http://www.codinghorror.com/blog/archives/001238.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-22T18:34:19.737

这里的信息不多，但您应该知道一些链接：

[http://blogs.msdn.com/brada/archive/2004/01/28/64255.aspx](http://blogs.msdn.com/brada/archive/2004/01/28/64255.aspx)

[http://msdn.microsoft.com/en-us/library/ms229056.aspx](http://msdn.microsoft.com/en-us/library/ms229056.aspx)

一般来说，最好把事情说清楚

*   问题的原因是什么
*   可以做些什么来修复/补救它

我的观点：我认为最常见的“坏”错误是忘记了第二个子弹。第二个最常见的错误是为第一个项目符号提供的信息不足（例如“找不到文件” - 哪个文件？！？）

# .net - 为什么反编译 .NET IL 代码这么容易？

> ID：671407
> 
> 赞同：18
> 
> 时间：2009-03-22T18:30:51.070
> 
> 标签：.net, bytecode, cil, decompiling, intermediate-language

与反编译本机 x86 二进制文件相比，为什么将 .NET IL 代码反编译为源代码如此容易？（Reflector 大部分时间都产生了相当不错的源代码，而反编译 C++ 编译器的输出几乎是不可能的。）

是因为 IL 包含很多元数据吗？还是因为 IL 是比 x86 指令更高的抽象？我做了一些研究，发现了以下两篇有用的文章，但它们都没有回答我的问题。

*   [MSIL 反编译器理论](http://www.codeproject.com/KB/msil/msil-decompiler.aspx)
*   [C 反编译器 - 快速入门](http://www.hex-rays.com/manual/primer.shtml)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-22T19:20:20.360

我想你已经掌握了最重要的部分。

*   正如您所说，还有更多可用的元数据。我不知道 C 或 C++ 编译器发出的详细信息，但我怀疑*IL*中包含更多名称和类似信息。只需看看反编译器对特定堆栈帧中的内容的了解，例如 - 就 x86 而言，您只知道堆栈是如何*使用*的；在 IL 中，您知道堆栈的内容*代表*什么（或者至少是类型 - 而不是语义！）
*   同样，正如您已经提到的，IL 是比 x86 更高级别的抽象。x86 不知道方法或函数调用、事件或属性等是什么。IL 中仍然包含所有这些信息。
*   通常，C 和 C++ 编译器的优化程度远高于（例如）C# 编译器。这是因为 C# 编译器假定大部分优化仍然可以在以后执行 - 由 JIT。*在某些方面，C# 编译器不要*尝试做太多优化是有意义的，因为 JIT 可以使用各种信息，但 C# 编译器不能使用。优化后的代码更难反编译，因为它远离原始源代码的自然表示。
*   IL 被设计为 JIT 编译；x86 被设计为在本机执行（诚然通过微代码）。JIT 编译器需要的信息与反编译器所需的信息相似，因此反编译器使用 IL 更容易。在某些方面，这实际上只是对第二点的重申。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-22T19:17:12.287

有很多事情可以让逆向工程变得相当容易。

*   类型信息。这是巨大的。在 x86 汇编器中，您必须根据变量的使用方式来推断变量的类型。

*   结构体。有关应用程序结构的信息在 il disassemblies 中提供更多信息。这与类型信息相结合，为您提供了惊人的数据量。此时您的工作水平相当高（相对于 x86 汇编器）。在本机汇编程序中，您必须根据数据的使用方式来推断结构布局（甚至它们是结构的事实）。并非不可能，但更耗时。

*   名字。知道事物的名称可能很有用。

这些东西结合起来，意味着你有很多关于可执行文件的数据。与本机代码的编译器相比，Il 基本上在更接近源代码的水平上工作。一般来说，字节码工作的级别越高，逆向工程就越容易。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-22T18:36:01.073

C# 和 IL 几乎是一对一的映射。（对于一些较新的 C# 3.0 功能，情况就不那么好了。）映射的紧密性（以及 C# 编译器中缺少优化器）使得事情变得如此“可逆”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-22T19:21:55.143

扩展布赖恩的正确答案

如果您认为所有 IL 都很容易反编译，我建议您编写一个重要的 F# 程序并尝试反编译该代码。F# 做了很多代码转换，因此从实际发出的 IL 和原始代码库的映射非常差。恕我直言，与 C# 或 VB.Net 相比，查看反编译的 F# 代码并取回原始程序要困难得多。

# c++ - Emacs 中的代码浏览、重构、自动完成

> ID：671412
> 
> 赞同：27
> 
> 时间：2009-03-22T18:34:06.787
> 
> 标签：c++, emacs

我最近切换到 Emacs，但仍在寻找解决方法。我用 C++ 编写代码，想知道有哪些工具可以扩展 Emacs 以支持代码浏览（查找符号等）、重构和代码完成。我听说过：

*   雪松
*   电子标签
*   示波器

但我很困惑我需要什么。有些地方说 cedet 提供了所有功能，但其他地方说我需要调用 etags 才能使 cedet 正常工作。

有人可以帮我解决这个问题吗？我需要所有这些工具吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-22T20:45:56.237

也许你会发现我关于 Cedet 的文章很有用[。](http://xtalk.msk.su/~ott/en/writings/emacs-devenv/EmacsCedet.html)Cedet 支持 etags、gtags、cscope 和其他工具。

但是缺少重构。您可能需要查看[Xrefactory](http://www.xref.sk/xrefactory/main.html)工具（但它不是免费的）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-22T18:43:15.940

**Cscope**作为“查找符号”使用工具非常好。它非常快。
**Etags**将向您展示您的类层次结构，并将帮助您找到方法定义/声明。

所以这两个工具是必须的，而且它们是独立的。

**赛德。**它是上面这两个工具的替代品，具有附加功能。因此，您可以选择 cscope/etags 或 cedet。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-04-05T06:47:51.983

对于重构，在阅读了 emacs 黑客 Xah Lee 的[这篇文章](http://xahlee.org/emacs/find_replace_inter.html)后，我开始专门使用 emacs 来完成此任务和相关任务。

有关自动完成功能，请参阅[此 SO 帖子](https://stackoverflow.com/questions/750267/python-emacs-completion)。就个人而言，多年来我发现[yasnippet](http://code.google.com/p/yasnippet/)非常有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-22T21:52:04.177

gtags ( [http://www.gnu.org/software/global/](http://www.gnu.org/software/global/) ) 也可用，而且使用起来可能更简单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-22T21:18:20.310

就个人而言，我不喜欢cedet。它使 Emacs 需要一个小时才能加载。自动完成功能对我来说从来都不是很好。我不需要它的项目管理，也不需要它的 UML 特性。我唯一想念的是 Emacs 代码浏览器，它非常有用但需要 cedet

我建议你只使用 cscope 和 etags 看看你喜欢它们。熟悉 emacs 后，您可以稍后安装 cedet。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-25T23:33:38.177

我写了[一篇](http://www.wolinlabs.com/blog/emacs.global.speedbar.html)关于使用 Global/gtags 和 Speedbar 进行代码浏览的博客文章，您可能会觉得这很有用......（我还认为 CEDET 有点慢......而且设置起来非常复杂=）

# .net - 如何在代码中定义 Structuremap 命名实例

> ID：671418
> 
> 赞同：11
> 
> 时间：2009-03-22T18:37:09.853
> 
> 标签：.net, structuremap

我想在代码中创建一个 Structuremap 命名实例，没有配置文件

我希望能够像这样创建实例：

```
var namedInjector = ObjectFactory.GetNamedInstance<IInjectable>("Other"); 
```

我无法在代码中定义这种类型。我找到[了这个](http://www.codebucket.org/archive/2008/08/10/three-ways-to-register-dependencies-with-structuremap-2.4.9.aspx)示例，但它使用以前版本的旧语法并将命名实例定义为：

```
.ForRequestedType<MementoType>()
.AddConcreteType<ConcreteType>(instanceName) 
```

在最新的结构图版本中，没有采用实例名称的 .AddConcreteType(instanceName) 方法。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-22T20:21:15.050

我相信你需要类似的东西：

```
class MyRegistry : Registry {
    public MyRegistry() {
        this.ForRequestedType<IFoo>()
            .TheDefaultIsConcreteType<Bar>()
            .AddInstances( x => {
                x.OfConcreteType<Blap>().WithName("abc");
            });
    }
}
...
ObjectFactory.Configure(x=>x.AddRegistry<MyRegistry>());
IFoo test1 = ObjectFactory.GetInstance<IFoo>(); // Bar
IFoo test2 = ObjectFactory.GetNamedInstance<IFoo>("abc"); // Blap
...
interface IFoo {}
public class Bar : IFoo {}
public class Blap : IFoo {} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-12T08:16:11.147

用新语法的话来说：

```
 For<IEncryptionService>()
                .AddInstances(x => { x.OfConcreteType<AdvancedEncryptionService>().Named("Advanced"); })
                .Use<EncryptionService>(); 
```

# f# - Seq 模块上的静态扩展方法

> ID：671420
> 
> 赞同：30
> 
> 时间：2009-03-22T18:39:18.053
> 
> 标签：f#, extension-methods

根据[这篇文章](http://codebetter.com/blogs/matthew.podwysocki/archive/2008/09/10/object-oriented-f-extension-everything.aspx)，F# 支持对象实例和静态类的扩展方法。例如：

```
module CollectionExtensions = 
    type System.Linq.Enumerable with   
        static member RangeChar(first:char, last:char) = {first .. last}

open ExtensionFSharp.CollectionExtensions 
```

如果我键入`System.Linq.Enumerable.`，静态方法将`RangeChar`出现在我的 Intellisense 窗口中。

我想向`for_alli`Seq 模块添加一个静态方法。我将上面的代码修改如下：

```
module SeqExtensions =
    type Microsoft.FSharp.Collections.Seq with   (* error on this line *)
        static member for_alli f l =
            l
            |> Seq.mapi (fun i x -> i, x)
            |> Seq.for_all (fun (i, x) -> f i x) 
```

尽管两个代码片段具有相同的结构，`SeqExtensions`但无法编译。F# 突出显示该单词`Seq`并返回错误“未定义类型'Seq'”。

**如何在 Seq 模块上创建静态扩展方法？**

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-22T18:57:02.677

要扩展 F#*模块*，只需创建另一个具有相同名称的模块：

```
module Seq =
    let myMap f s = seq { for x in s do yield f x }

Seq. // see your stuff here alongside normal stuff 
```

# c++ - C++ STL 向量：从索引中获取迭代器？

> ID：671423
> 
> 赞同：223
> 
> 时间：2009-03-22T18:41:33.697
> 
> 标签：c++, stl, vector, iterator

所以，我写了一堆代码，通过 index[] 访问 stl 向量中的元素，但现在我只需要复制向量的一部分。看起来`vector.insert(pos, first, last)`是我想要的功能......除了我只有第一个和最后一个整数。有什么好方法可以获取这些值的迭代器吗？

* * *

## 回答 #1

> 赞同：328
> 
> 时间：2009-03-22T18:42:49.903

试试这个：

```
vector<Type>::iterator nth = v.begin() + index; 
```

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2009-03-22T18:58:57.540

@dirkgently 提到的方式`( v.begin() + index )`对于向量来说既好又快

但最通用的方式和随机访问迭代器的工作时间也是恒定的。 [`std::advance`](http://en.cppreference.com/w/cpp/iterator/advance)`( v.begin(), index )`

**编辑**
用法上的差异：

```
std::vector<>::iterator it = ( v.begin() + index ); 
```

或者

```
std::vector<>::iterator it = v.begin();
std::advance( it, index ); 
```

在@litb 注释之后添加。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2011-08-04T08:33:57.967

还;`auto it = std::next(v.begin(), index);`

*更新：需要符合 C++11x 的编译器*

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-08-23T17:18:06.963

您始终可以使用[`std::advance`](http://en.cppreference.com/w/cpp/iterator/advance)在恒定时间内将迭代器移动一定数量的位置：

```
std::vector<int>::iterator it = myvector.begin();
std::advance(it, 2); 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-03-26T21:43:43.260

实际上 std::vector 是为了在需要时用作 C 选项卡。（据我所知，C++ 标准要求向量实现 -[替换维基百科中的数组](http://en.wikipedia.org/wiki/Vector_(STL)#Replacement_for_arrays)）例如，按照我的说法，这样做是完全合法的：

```
int main()
{

void foo(const char *);

sdt::vector<char> vec;
vec.push_back('h');
vec.push_back('e');
vec.push_back('l');
vec.push_back('l');
vec.push_back('o');
vec.push_back('/0');

foo(&vec[0]);
} 
```

当然，要么 foo 不能复制作为参数传递的地址并将其存储在某个地方，要么你应该确保在你的程序中永远不要在 vec 中推送任何新项目，或者请求更改其容量。或风险分段错误...

因此，在您的示例中，它导致

```
vector.insert(pos, &vec[first_index], &vec[last_index]); 
```

# drupal - 如何在 Drupal 中存储用户的名字和姓氏？

> ID：671426
> 
> 赞同：4
> 
> 时间：2009-03-22T18:42:42.430
> 
> 标签：drupal, drupal-6

我在 Drupal 的创建/编辑用户表单中看不到名字或全名字段。我正在使用 Drupal 6。如何在其中存储用户的全名？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-22T19:39:53.603

您需要为此启用 Profile 模块。此模块允许您向用户添加字段。

请参阅[手册中有关该模块的信息](http://drupal.org/handbook/modules/profile)，以及[此处的一些不错的说明](http://www.packtpub.com/article/managing-users-profiles-drupal6-social-networking)（在“向用户配置文件中添加特殊属性”下）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T19:38:03.560

Drupal 支持完全可配置的配置文件。打开模块（它在核心中）并导航`/admin/user/profile`到添加/编辑字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T19:38:49.130

使用 Drupal 的内置[配置文件模块](http://drupal.org/handbook/modules/profile)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T05:16:06.257

我意识到每个人都在建议配置文件模块，并且我同意如果您没有太多的用户配置文件字段并且没有太多用户，这将在足够小的站点上正常工作......但它可能在较大的站点上是一个猪.

我还要指出[Content Profile](http://drupal.org/project/content_profile)模块，它允许您创建节点类型并使用它以这种方式扩展用户信息，它还具有为您提供 CCK 的宽度和广度来创建字段的优点，而不是被个人资料的有限选择所困扰。

# c++ - 如何在 C++/Linux 中执行外部命令？

> ID：671461
> 
> 赞同：21
> 
> 时间：2009-03-22T19:10:00.523
> 
> 标签：c++, linux, command-line

我只想知道在 C++ 中执行外部命令的最佳方法是什么，如果有输出，我该如何获取？

**编辑**：我想我不得不告诉我我是这个世界上的新手，所以我想我需要一个可行的例子。例如，我想执行如下命令：

```
ls -la 
```

我怎么做？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-22T19:13:29.143

使用该[`popen`](http://opengroup.org/onlinepubs/007908775/xsh/popen.html)功能。

示例（不完整，生产质量代码，无错误处理）：

```
FILE* file = popen("ls", "r");
// use fscanf to read:
char buffer[100];
fscanf(file, "%100s", buffer);
pclose(file); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-22T19:46:28.300

一个例子：

```
#include <stdio.h>

int main() {
    FILE * f = popen( "ls -al", "r" );
    if ( f == 0 ) {
        fprintf( stderr, "Could not execute\n" );
        return 1;
    }
    const int BUFSIZE = 1000;
    char buf[ BUFSIZE ];
    while( fgets( buf, BUFSIZE,  f ) ) {
        fprintf( stdout, "%s", buf  );
    }
    pclose( f );
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-03-23T02:03:11.840

`popen`绝对可以完成您正在寻找的工作，但它有一些缺点：

*   它在您正在执行的命令上调用 shell（这意味着您需要清除任何用户提供的命令字符串）
*   它仅在一个方向上起作用，您可以为子流程提供输入，也可以读取其输出。

如果您想调用子流程并提供输入和捕获输出，那么您必须执行以下操作：

```
int Input[2], Output[2];

pipe( Input );
pipe( Output );

if( fork() )
{
    // We're in the parent here.
    // Close the reading end of the input pipe.
    close( Input[ 0 ] );
    // Close the writing end of the output pipe
    close( Output[ 1 ] );

    // Here we can interact with the subprocess.  Write to the subprocesses stdin via Input[ 1 ], and read from the subprocesses stdout via Output[ 0 ].
    ...
}
else
{    // We're in the child here.
     close( Input[ 1 ] );
     dup2( Input[ 0 ], STDIN_FILENO );
     close( Output[ 0 ] );
     dup2( Output[ 1 ], STDOUT_FILENO );

     execlp( "ls", "-la", NULL );
} 
```

当然，您可以根据需要将 替换为`execlp`任何其他 exec 函数。

# apache-flex - Flex 中的控件何时可寻址？

> ID：671468
> 
> 赞同：0
> 
> 时间：2009-03-22T19:16:24.050
> 
> 标签：apache-flex

关于更改不同视图堆栈面板上的控件，我在使用 Flex 时遇到了一些麻烦。在运行时，某些控件不可访问并返回为空。这是一个示例结构：

```
viewstack1
   canvasPeople
      datagridPeople
   canvasDetails
      tabNavigator1
         canvasPersonDetail
             txtLastname
         canvasPersonOptions
             comboboxOccupation 
```

我在 datagrid1 中设置了一个“单击”处理程序以激活 canvasB（viewstack1.selectedChild = canvasB）和详细信息选项框（tabNavigator1.selectedChild = canvasPersonOptions）。前者工作正常，但后者返回有关访问空对象的错误，因为在用户单击 People 数据网格中的项目时，tabNavigator1 为空，它下面的任何控件也是空的。（虽然它的父级（canvasDetails）是可寻址的。）目前这是一个很小的应用程序，所以它不像是在等待加载项目。有没有办法控制 Flex 如何呈现控件，以便在用户看到它们之前就可以访问它们？我不知道这是否特定于 viewStack 控件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T19:33:54.320

是的，这被称为“创建策略”，它是所有 Container 类的属性。要做我们正在寻找的东西，您可以使用“全部”的创建策略；“自动”是默认值。

ContainerCreationPolicy.AUTO 的 creationPolicy 意味着容器延迟创建部分或全部后代，直到需要它们，这个过程称为延迟实例化。此策略会产生最佳启动时间，因为最初创建的 UIComponents 较少。但是，当用户第一次导航到应用程序的其他部分时，这会引入导航延迟。导航器容器（例如 Accordion、TabNavigator 和 ViewStack）通过立即创建所有子级来实现 ContainerCreationPolicy.AUTO 策略，但要等待创建子级的更深的后代，直到它成为导航器容器的选定子级。

ContainerCreationPolicy.ALL 的 creationPolicy 意味着导航器容器会立即为每个孩子创建更深的后代，而不是等到该孩子被选中。对于 VBox 容器等单视图容器，ContainerCreationPolicy.AUTO 和 ContainerCreationPolicy.ALL 策略之间没有区别。

更多信息在这里：

[http://livedocs.adobe.com/flex/3/html/layoutperformance_04.html](http://livedocs.adobe.com/flex/3/html/layoutperformance_04.html)

但请注意这一点：Flex 选择 AUTO 作为默认设置是有原因的。如果你的应用变大，createPolicy=all 下的初始化时间会很大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T19:31:42.640

子组件的创建由 creationPolicy 属性控制。在 Flex 3 文档页面[“关于 creationPolicy 属性”](http://livedocs.adobe.com/flex/3/html/help.html?content=layoutperformance_05.html)中有详细描述。

如果将该属性设置为“all”，则 ViewStack 容器的每个子组件将在 ViewStack 创建后立即创建。TabNavigator 也是如此。当然，这可能会对性能产生一些影响，文档中也对此进行了描述。

# regex - 一个 div 类的正则表达式

> ID：671473
> 
> 赞同：0
> 
> 时间：2009-03-22T19:17:55.560
> 
> 标签：regex

如果我在 HTML 中有一个具有 class="blah user_foo" 的 div，那么获取“foo”位的 Match() 正则表达式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T19:21:40.947

如果该`class`属性是所需`div`元素的唯一属性，并且该`class`值始终具有上述结构（固定`blah`和 then `user_`*`foobar`*），则可以使用此正则表达式：

```
<div\s+class\s*=\s*"blah user_([^"\s]+) 
```

否则试试这个正则表达式：

```
<div\s+(?:[^>"']+|"[^"]*"|'[^']*')*\bclass\s*=\s*"blah user_([^"\s]+) 
```

该表达式`(?:[^>"']+|"[^"]*"|'[^']*')*`还考虑了一个普通`>`的被允许作为属性值。

**编辑**    使用前瞻断言优化正则表达式以减少回溯：

```
<div\s+(?:(?:(?!class)[^>"']+(?:"[^"]*"|'[^']*')?)\s+)*class\s*=\s*"blah user_([^"\s]+) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T19:23:54.390

```
/<div\s(?:[^>'"]*|".*?"|'.*?')*?\bclass\s*=\s*"blah user_(.*?)"/i 
```

以上处理空白；和类规范之前的其他事情。

它不处理`class='single-quoted-something'`; 你可以通过反向引用来做到这一点。它也不处理格式错误的 HTML。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T19:24:20.210

我不确定哪种语言使用 Match()，但它可能看起来像这样：

```
<div[^>]+class="blah user_([^"]+)" 
```

根据语言的不同，'foo' 可能存储在 \1、$1 或完全其他的东西中。

# c# - 将一条长线分成两个操作是否合适？

> ID：671475
> 
> 赞同：1
> 
> 时间：2009-03-22T19:19:29.237
> 
> 标签：c#, coding-style

整理一些我认为是令人困惑的换行结构的代码：

```
return
       CommonContext.HttpWebService.DownloadXml(configuration.MethodUrl(APIMethods.CharacterSheet),
                                                         postData); 
```

如果它在一行上，它显然会很长以至于无法阅读。就目前而言，粗略一瞥我并不清楚“return”和“postData”与长线有何关系。CommonContext 和 APIMethods 是静态类，配置是局部变量。

考虑到这一点，我可能会在两行中写下相同的内容，如下所示：

```
string methodUrl = configuration.MethodUrl(APIMethods.CharacterSheet);
return CommonContext.HttpWebService.DownloadXml(methodUrl, postData); 
```

这是吐出代码的有效方法还是有更好的方法？在本例中，我使用的是 C# 2.0。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-22T19:22:23.723

是的。通常这是一件好事。它使代码更具自记录性（具有良好的变量名称）并且还使调试更容易（允许在第一行放置断点，并且当从第一行抛出异常时，您可以立即区分它而不是单个线路情况）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-22T19:23:31.897

是的，这绝对是重构代码的有效方式。如果您想使用调试器或记录器在`methodUrl`传递给`DownloadXml`.

另一个额外的好处是你给这个值一个*name*。*通过同时解释其含义*，这可能会有很大帮助。如果有很多参数，这可能特别重要 - 能够快速浏览调用站点的参数列表和方法声明的参数列表并根据名称很好地猜测发生了什么真的很有帮助.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T19:23:06.357

可读性高于一切。没有任何程序会因为太多行而导致用户运行速度太慢而失败。

# c - 如何在文件系统中找到循环？

> ID：671490
> 
> 赞同：6
> 
> 时间：2009-03-22T19:28:33.693
> 
> 标签：c, linux

如何在 Linux 中找到文件系统中的循环？我正在索引所有文件以使搜索快速（O（1））......我正在使用c编程语言通过使用dir.h中的库函数来实现......我可以扫描整个文件系统但它进入如果文件系统中存在循环，则为循环（示例循环挂载）...如何在文件系统中找到循环..当文件系统中存在循环时，我已经看到 updatedb 命令报告...我不明白逻辑...任何人都可以帮助找到解决方案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-22T19:39:53.277

防止重新扫描图中节点的一般方法是在传递节点时标记节点，然后忽略标记的节点。如果您不想修改正在扫描的图形，这不是非常实用，因此您需要一种在外部标记节点的方法。我能想到的在 linux 下执行此操作的最简单方法是为您访问的每个目录存储一个设备/inode。然后，当您查看目录时，首先检查您是否还没有看到任何具有相同设备/inode 的目录。这不仅处理循环，还处理相互合并的树。

要获取设备/inode 编号，请查看 stat/fstat 函数以及 stat 结构的 st_dev 和 st_ino 成员。

为了存储数据，您可能希望查看[哈希表](http://www.cl.cam.ac.uk/~cwc22/hashtable/)或二叉树。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T16:53:38.830

顺便提一句。您不需要在文件系统中搜索循环。

您正在索引整个磁盘。因此，您不需要遵循符号链接，因为每个文件都必须能够以正常方式访问（没有符号链接）。如果某个磁盘被多次挂载，您只需要检查挂载点，只需忽略挂载的其余点即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T19:40:48.110

我在这里找到了关于[在 DAG 中查找循环的](http://coding.derkeiler.com/Archive/General/comp.theory/2004-02/0473.html)有趣评论：

> Steinar H. Gunderson 写道：
> 
> > 2004 年 2 月 26 日星期四 00:28:32 +0100，Orlondow 写道：
> > 
> > > ...也转载于 IIC 的 Cormen-Leiserson-Rivest。哪个最容易找到。
> > 
> > 是的，我实际上有 Cormen 等人，但是当我想要循环检测时，我从未想过查找“强连接组件”。谢谢，我会看看它。:-)
> 
> 要在有向图中找到一个循环（您不关心哪个循环），只要存在一个循环，您就不需要过度使用 SCC。普通的旧深度优先搜索 DFS（在 CLRS 的同一章中）就足够了。

因此，粗略地说，当您遍历目录树时，创建一个 DAG，它表示树的结构，其中节点处的数据引用文件的 inode。然后，您只需检查以确保您不会多次访问节点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-22T20:04:23.827

也许我在这里有点昏暗，但不是您可以创建循环的两种方式：

*   通过创建符号链接
*   通过安装两次

为了解决这些问题，您可以在开始索引之前获取挂载列表，以及除第一个 fs 之外的所有挂载，并且您可以在索引过程中遇到链接时忽略它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-22T20:09:31.490

简单的方法。只需对目录树进行深度优先树遍历，在您前进的过程中保留一堆节点。在您访问的每个节点上，如果该节点已经在堆栈中，则您有一个循环。

```
 // here's a stack of nodes
node stack[1000];

walk(node, level){
    if (node in stack[0..level-1]) then there is a cycle
    else
        stack[level] = node
        for each subnode x of node
            walk(x, level+1)
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T02:38:16.483

正如其他人所说，如果您意识到路径是文件名的一部分，则文件系统中没有循环之类的东西，除非它是循环符号链接。

例如，如果您将某个发行版（比如说 Debian）引导到一个循环设备，甚至是一个目录，然后在 Debian 机器上执行此操作，那么您现在已经复制了很多东西。

例如，假设您正在运行 Debian Lenny，并将它的最小副本引导到 /lenny。

/lenny/usr/* 将与 /usr/* 相同。没有“便宜”的方法可以避免这种情况。

由于您已经在每个节点上调用了 stat() （我假设您正在使用 ftw() / ftw64() ，您也可以：

*   让 ftw() 的回调将节点的名称插入到数组中，该数组具有可以存储不太可能发生冲突的文件哈希的结构成员。md5 不会为此而削减它。
*   根据该摘要和文件名（不是路径）更新哈希表。

这不会加快您的扫描速度，但会大大减少搜索所需的时间。

如果您正确使用线程并设置关联，则哈希和索引可能发生在一个核心上，而另一个是 i/o 绑定的（当多个核心可用时）。

但是，“仅”检查重复的挂载并不能解决问题，而且我确信您的程序会想要返回所有名为“foo”的文件的位置，即使有四个相同的副本要提及。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-22T19:35:08.733

这更典型地称为“循环”。所以你要实现“循环检测”。有很多方法可以做到这一点；我不知道这是否适合家庭工作，但一种简单但不一定是最佳的方法是通过指针追逐。

# web-crawler - Robots.txt：只允许主要 SE

> ID：671491
> 
> 赞同：24
> 
> 时间：2009-03-22T19:30:08.977
> 
> 标签：web-crawler, robots.txt

有没有办法配置 robots.txt 以便该站点只接受来自 Google、Yahoo! 的访问？和 MSN 蜘蛛？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-22T19:38:08.787

```
用户代理： *
不允许： /
用户代理：Googlebot
允许： /
用户代理：Slurp
允许： /
用户代理：msnbot
不允许：

```

[Slurp](http://help.yahoo.com/l/us/yahoo/search/webcrawler/slurp-02.html)是雅虎的机器人

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-22T19:35:01.617

为什么？

任何作恶的人（例如，收集电子邮件地址以发送垃圾邮件）都会忽略 robots.txt。因此，您只会阻止合法的搜索引擎，因为 robots.txt 合规性是自愿的。

但是——如果你仍然坚持这样做——这就是`User-Agent:`robots.txt 中的那一行。

```
User-agent: googlebot
Disallow: 

User-agent: *
Disallow: / 
```

当然，还有您希望从中获得流量的所有其他搜索引擎的行。[Robotstxt.org](http://www.robotstxt.org/)有一个部分列表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-06-23T01:01:02.977

根据您所谈论的国家/地区，有超过 3 个主要搜索引擎。Facebook 似乎做得很好，只列出了合法的：[https ://facebook.com/robots.txt](https://facebook.com/robots.txt)

所以你的 robots.txt 可以是这样的：

```
User-agent: Applebot
Allow: /

User-agent: baiduspider
Allow: /

User-agent: Bingbot
Allow: /

User-agent: Facebot
Allow: /

User-agent: Googlebot
Allow: /

User-agent: msnbot
Allow: /

User-agent: Naverbot
Allow: /

User-agent: seznambot
Allow: /

User-agent: Slurp
Allow: /

User-agent: teoma
Allow: /

User-agent: Twitterbot
Allow: /

User-agent: Yandex
Allow: /

User-agent: Yeti
Allow: /

User-agent: *
Disallow: / 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T19:07:18.087

众所周知，robots.txt 是爬虫必须遵守的标准，因此只有表现良好的代理才会这样做。所以，放不放都无所谓。

如果您有一些数据，您也没有在网站上显示，您可以更改权限并提高安全性。

# jquery - jQuery live() 删除 iPhone 触摸事件属性？

> ID：671498
> 
> 赞同：6
> 
> 时间：2009-03-22T19:34:20.543
> 
> 标签：jquery, iphone, touch, live

我在[PhoneGap](http://phonegap.com/)应用程序中的链接上绑定实时事件。该事件确实成功触发（由`alert()`ing 确认），但似乎任何触摸数据都没有像应有的那样附加到事件对象。这发生在所有触摸事件上 - `touchstart`、`touchmove`和`touchend`。

```
$('a').live('touchend', function(event) {
  event.preventDefault();
  alert(event.touches.length); // event.touches should be populated!
}); 
```

有任何想法吗？我是 jQuery.live() 的 SOL 吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-01-30T21:02:49.007

实际上，您可以使用 .live 方法。由于 jQuery 在内部处理事件的方式，您没有 event.touches 属性。为了“修复”事件，jQuery 克隆了该事件。这样做时，出于性能原因，它只复制有限数量的属性。但是，您仍然可以通过 event.originalEvent 属性访问原始事件对象。

因此，您的示例代码需要如下所示：

```
$('a').live('touchend', function(event) {
  event.preventDefault();
  console.log(event.originalEvent.touches.length);
}); 
```

以下是复制过来的属性：http: [//github.com/jquery/jquery/blob/master/src/event.js#L411](http://github.com/jquery/jquery/blob/master/src/event.js#L411)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T11:44:28.607

[Events/live](http://docs.jquery.com/Events/live)当前不支持触摸事件。

从文档中：

> 可能的事件值：click、dblclick、mousedown、mouseup、mousemove、mouseover、mouseout、keydown、keypress、keyup
> 
> 目前不支持：blur、focus、mouseenter、mouseleave、change、submit

如果适合您的需要，您可能要考虑尝试使用 click ，或者您可以切换到使用[livequery](http://docs.jquery.com/Plugins/livequery)，这可能会支持它。（livequery 是 live 最初基于的，我不确定为什么它不支持所有相同的事件）

# python - 如何在 Python 中进行“基于性能”（基准）的单元测试

> ID：671503
> 
> 赞同：11
> 
> 时间：2009-03-22T19:36:55.467
> 
> 标签：python, linux, unit-testing, benchmarking

假设我的代码库具有尽可能高的单元测试覆盖率。（超过某个点，增加覆盖率并没有很好的投资回报率。）

接下来我要测试性能。对代码进行基准测试以确保新提交不会不必要地减慢速度。我对 Safari对提交减速的[零容忍政策](http://webkit.org/projects/performance/index.html)非常感兴趣。我不确定这种对速度的承诺水平对于大多数项目是否具有良好的投资回报率，但我至少希望收到速度倒退发生的警报，并能够对此做出判断。

环境是 Linux 上的 Python，对 BASH 脚本也适用的建议会让我非常高兴。（但 Python 是主要焦点。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-22T19:40:24.757

如果可能，您将希望在系统级别进行性能测试 - 在上下文中测试整个应用程序，使用尽可能接近生产使用的数据和行为。

这并不容易，而且更难实现自动化并获得一致的结果。

此外，您不能使用虚拟机进行性能测试（除非您的生产环境在虚拟机中运行，即使这样，您也需要在没有其他任何东西的主机上运行虚拟机）。

当您说进行性能单元测试时，这可能很有价值，但前提是它用于诊断确实存在于系统级别（不仅仅是开发人员头脑中）的问题。

此外，单元测试中的单元性能有时无法反映它们在上下文中的性能，因此它可能根本没有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-05T18:03:46.673

虽然我同意在系统级别测试性能最终更相关，但如果您想为 Python 进行 UnitTest 样式的负载测试，FunkLoad [http://funkload.nuxeo.org/](http://funkload.nuxeo.org/)正是这样做的。

当您尝试加快代码库中的特定操作时，微基准测试就占有一席之地。完成后续性能单元测试是一种有用的方法，可以确保您刚刚优化的此操作不会在未来提交时无意中降低性能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-22T19:44:06.090

MarkR 是对的……进行真实世界的性能测试是关键，并且在单元测试中可能有些躲闪。话虽如此，看看`cProfile`标准库中的模块。它至少有助于让您从提交到提交的过程中相对了解事情的运行速度，并且您可以在单元测试中运行它，当然您会在包括开销在内的细节中获得结果单元测试框架本身。

但是，总而言之，如果您的目标是零容忍，那么您将需要比这更强大的东西......单元测试中的 cProfile 根本不会削减它，并且可能会产生误导。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T00:46:55.613

当我进行性能测试时，我通常有一套数据输入的测试套件，并测量程序处理每个数据需要多长时间。

您可以每天或每周记录性能，但我发现在实现所有功能之前担心性能并不是特别有用。

如果性能太差，那么我打破[cProfile](http://docs.python.org/library/profile.html#module-pstats)，使用相同的数据输入运行它，并尝试查看瓶颈在哪里。

# security - 在 Groovy/Grails 中不安全地使用用户提供的 GString:s

> ID：671512
> 
> 赞同：4
> 
> 时间：2009-03-22T19:39:24.510
> 
> 标签：security, grails, groovy, gstring

Groovy 中的 GString 概念非常强大（参见[http://groovy.codehaus.org/Strings+and+GString](http://groovy.codehaus.org/Strings+and+GString)）。

GStrings 让您可以执行以下操作：

```
world = "World"
println "Hello ${world}"
# Output: Hello World
println "1+2 = ${1+2}"
# Output: 1+2 = 3
println "${System.exit(-1)}"
# Program terminated 
```

我试图弄清楚使用 Groovy GString:s 是否会在代码中引入类似于 SQL 注入攻击的安全问题。

在上面的示例中，代码是由程序的作者编写的，因此 System.exit(-1) 命令的执行不能被视为安全漏洞，因为它是作者声明的意图。

假设我正在编写一个 Grails Web 应用程序，其中用户输入来自表单字段（读取 POST/GET 参数）和数据库表（使用 GORM）。让我们假设攻击者控制了作为 POST/GET 请求发送到服务器的内容和数据库中的内容。

我的应用程序中的代码如下所示：

```
def str1 = params.someParameterControlledByTheAttacker
def str2 = SomeGORMPersistedObject.get(1).somePropertyFieldControlledByTheAttacker
render "Hello! Here is some text: ${str1} and ${str2}" 
```

攻击者有什么办法可以在上述情况下执行代码？为什么？为什么不？我最初的假设是 GString 的使用总是安全的。请随时证明我错了。请尽可能具体。

**更新#1：**为了保持讨论的重点，请忽略代码中的任何 HTML-XSS 问题，因为这个问题是关于服务器端的代码执行，而不是客户端。

**更新#2：**有人指出“过滤掉不需要的字符串通常是个好主意”。虽然过滤掉“潜在的坏字符”肯定可以让您避免某些类别的安全问题，但编写即使没有过滤也安全的代码会更好。您可以将其与 Java JDBC API 中 PreparedStatements 的用法进行比较——正确使用 PreparedStatements 可以**保证**您免受某些类型的注入攻击。过滤您的 SQL 输入可能会给您相同的结果，但使用 PreparedStatements 严格控制过滤方法恕我直言。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T05:17:35.317

No, you won't have any *new* problems introduced by the GString mechanism, because the formation of GStrings is a "compile time" phenomenon. While their value may be determined (and changed) at run time their *form* is not.

Another way of looking at it: anything you can do with GStrings could be done with a closure and string concatenation, with exactly the same semantics; GStrings are just syntactic sugar. Unless you are worried about closures (or, heaven forbid, string concatenation) you shouldn't worry about GStrings.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T20:27:15.597

使用给定的代码示例，不存在安全问题。str1 和 str2 只是调用了它们的 toString 方法，并且 GString 上的默认 toString 方法没有安全漏洞。

除非您（程序作者）为“somePropertyFieldControlledByTheAttacker”定义了 getter 以实际对值的内容进行评估，否则它是安全的。

发生安全漏洞的唯一方法是程序作者添加一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T18:23:38.143

再想一想，看起来你的使用很好，因为你只是评估你定义为变量的局部变量，但字符串仍然必须清除特殊字符，但不是像“System.exit(-1)”这样的东西，因为除非 ${} 在字符串中围绕它，否则它将一直将其视为字符串。

**最佳实践似乎是从字符串中删除所有特殊字符，例如“${}”，因为您不必在代码中使用它们就容易受到它们的攻击。**

但是，如果它从不以嵌套方式评估字符串，那你很好，所以我不能 100% 确定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T01:57:35.230

我相当确定作为参数（在控制器中）传入的对象是纯字符串，因此它们不会在运行时被评估（就像 GStrings 那样）。此外，我做了一些实验，似乎要将这些转换为 GStrings，您需要做一些非常粗糙的工作。这是可行的，但需要很多杂耍。

简而言之，它可能不是安全漏洞。

It's still a really, really, really good idea to strip out special characters, at least in strings where they aren't needed... although determining this is 'left as an exercise to the reader'. But as long as you're conscious that all user-generated data (data pulled from the web or from the DB) is suspect, you'll be a lot safer.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T02:11:41.623

you may have a cross-site scripting vulnerability in the above code- make sure you call .encodeAsHTML(), or a bad guy can mess with ya.

# ruby - 我是否理解这个 Ruby grep 示例中的事件顺序？

> ID：671520
> 
> 赞同：1
> 
> 时间：2009-03-22T19:41:44.207
> 
> 标签：ruby, grep

我试图了解 grep 在此示例中的工作原理。该代码有效，但我不能 100% 确定事件发生的顺序，或者我是否正确理解何时何地返回的内容。

```
cars = [:Ford, :Toyota, :Audi, :Honda]
ucased_cars = cars.collect do |c| 
c.to_s 
end
.grep(/^Ford/) do |car| 
puts car.upcase 
car.upcase 
end
puts "ucased:" + ucased_cars.to_s 
```

我认为正在发生的是：

1.  我定义了一个符号数组
2.  我用一个块调用 collect 方法，该块导致汽车数组的每个符号元素 c 被转换为块内的字符串。
3.  collect 返回一个字符串数组
4.  grep 在 collect 返回的字符串数组上调用，并且 grep 在每个数组元素 car 上调用自己的块，匹配搜索模式，导致元素被打印、大写并作为数组的一部分返回。
5.  grep 返回一个大写字符串数组，将其分配给“ucased_cars”
6.  数组 ucased_cars 在打印之前必须转换为字符串。

就第 4 步而言，以下哪项最能描述 grep 的工作原理：

[A] grep 查找与模式匹配的所有字符串。grep 在这个匹配数组上调用块。grep 将块的结果返回给调用函数。

[B] grep 查找与模式匹配的第一个字符串。grep 调用此匹配的块。这个块的返回值暂时堆积在某个地方。grep 搜索数组的下一个元素。如果匹配，则 grep 调用此匹配的块。grep 将此块的返回值添加到返回值的临时“存储”中。grep 查看下一个数组元素，直到找不到更多匹配项。然后 grep 将堆积的返回值传递回调用函数。

我的结论：

[A] 似乎更有意义。

[B] 似乎有很多不必要的捏造，似乎没有效率或不太可能。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-22T19:56:30.193

首先，[这里是 grep 的文档](http://www.ruby-doc.org/core/classes/Enumerable.html#M003152)

让我清理你的代码并逐个解释

```
# 1
cars = [:Ford, :Toyota, :Audi, :Honda]

# 2
ucased_cars = cars.collect do |c| 
  c.to_s
end.grep(/^Ford/) do |car|  # 3
  puts car.upcase # 4
  car.upcase # 5
end
# 6

# 7
puts "ucased:" + ucased_cars.to_s 
```

1.  声明符号数组

2.  使用 collect 将符号转换为字符串。你得到`["Ford", "Toyota", "Audi", "Honda"]`

3.  将此字符串数组输入 grep。任何与正则表达式匹配的项目都`/^Ford/`将被馈送到块中

4.  该块打印出它得到的大写字符串

5.  该块返回大写的字符串，然后 grep 将其作为“匹配值”

6.  来自 grep 的返回值（这是一个包含所有“匹配值”的数组）被分配给`ucased_cars`，它是`["FORD"]`，因为这是唯一匹配正则表达式的东西。

7.  然后它被打印出来。对数组执行 a`to_s`只会打印所有像这样卡在一起的元素。这不是很有用，你最好打印`ucased_cars.inspect`

要回答有关 grep 如何在幕后工作的问题...

上面的文档页面显示了 grep 本身的 C 源代码。它基本上是这样做的：

*   分配一个新的 ruby​​ 数组（动态大小）
*   调用`rb_iterate`遍历源代码中的每个元素，传入一些特定于 grep 的代码。
*   `rb_iterate`也被`collect`,`each_with_index`和一堆其他的东西使用。

正如我们知道 collect/each/etc 是如何工作的，我们不需要在源代码中做更多的探索，我们有我们的答案，它是你的 [B]。

为了更详细地解释，它这样做：

1.  创建一个新数组来保存返回值。
2.  从源中获取下一项
3.  如果它与正则表达式匹配：
    *   如果给出了一个块，则调用该块，并且无论该块返回什么，都将其放入返回值中。
    *   如果没有给出块，则将该项目放入返回值中
4.  转到 2，重复直到源中没有更多项目。

至于您对“A似乎更有意义”的评论-我不同意。

这个想法是块对*每个*元素做一些事情。如果它首先扫描源，然后将匹配数组传递给块，那么您的块将不得不调用`each`自身，这会很麻烦。

其次，效率会更低。例如，如果您的块调用`return`或引发错误，会发生什么？在它当前的化身中，您不必扫描源的其余部分。如果它已经预先扫描了整个源列表，那么您将浪费所有这些努力。

# iphone - 故障运行泄漏仪器

> ID：671527
> 
> 赞同：0
> 
> 时间：2009-03-22T19:45:44.307
> 
> 标签：iphone, memory-leaks, simulator

安装 3.0 SDK 后，我无法运行 Leaks Instrument。NDA 免责声明我不认为这是 3.0 SDK 问题，只是配置问题。因此，我正在寻找有关配置相关工具的建议，而不是 3.0 SDK 本身。

这是我看到的行为的细分。

我的应用程序编译为操作系统版本 2.2。我可以在运行 2.2、2.2.1、3.0 的模拟器和设备上以调试模式从 XCode 中运行它。

如果我使用 Performance Tools -> Leaks 启动它，我会从操作系统收到一条错误消息，“应用程序 xxxx 意外退出”、“忽略、报告、重新启动”。如果我单击“忽略”，将会发生以下两种情况之一，或者泄漏告诉我它无法附加，或者泄漏停止响应输入并且我必须强制退出。有趣的是模拟器从 3.0 操作系统开始。

如果我手动启动仪器并附加到正在运行的 2.2 模拟器，它会显示相同的行为。

如果我将泄漏附加到 iPhone 设备上，它可以工作。

似乎一旦我启动 Leaks，我的应用程序将不会在模拟器中运行，直到我进行新的构建。

让我的模拟器/泄漏/Xcode 同步备份的任何想法？

谢谢，杰夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T01:29:47.917

我偶然发现了自己的答案。我让应用程序针对 3.0 SDK 版本构建，然后运行 ​​Leaks Instrument。现在，当我针对 2.2 SDK 构建应用程序时，Leak Instrument 就可以工作了。它看起来像是一个“摇动手柄”来修复的经典案例。

# iphone - iPhone内存管理问题（在for语句的视图中添加子视图）

> ID：671541
> 
> 赞同：1
> 
> 时间：2009-03-22T20:06:25.223
> 
> 标签：iphone, objective-c, memory-management, view

我需要向视图添加更多视图以处理多个网址和标签上的点击。我尝试在 for 语句中做到这一点。我的代码是这样的：

```
// we have a UITabbarViewController for holding amongs other the parentViewController
UITabBarController *tabbedViewController = [[UITabBarController alloc] init];

// create the parentViewController
ParentViewController *parentViewController = [[ParentViewController alloc] initWithNibName:@"parentViewController" bundle:nil];
[parentViewController.view setNeedsDisplay];

// add parentViewController into tabbedViewController
tabbedPlayerViewController.viewControllers = [NSArray arrayWithObjects: ... parentViewController, nil];

// All the things are inside a UINavigationController
// push the view
[self.navigationController pushViewController:tabbedViewController animated:YES];

// setting up  the views individually...
// not listed here

for (NSDictionary *url in urls) {

        // init my controller with a nib file 
        UIViewController *webadressViewController = [[WebadressViewController alloc] initWithNibName:@"WebadressViewController" bundle:nil]; 

        // position the view ...
        // ... not listed here

        // add webaddress to parent view
        [parentViewController.view addSubview: webaddressViewController.view];

}

[parentViewController release];
[tabbedViewController release]; 
```

我想我可能有一些内存管理问题，因为 webaddressViewController 有 1 作为保留计数，所以它需要在我的代码中的某个地方释放。但是，如果我在 for 块中释放它，所有子视图都会消失。

我的问题是如何释放这些对象？

（正如我看到的问题如下：当我在 parentViewController 上调用 addSubview 时，它将拥有 webaddressViewController.view 但不拥有 webaddressController 本身。因此，如果我释放 webaddressViewController 它的视图也会消失。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T18:56:58.837

您正在为每个 url 创建一个 webAdressViewController，但您并没有保留这些视图控制器，以便以后可以释放它们。如果你想这样编码，你还需要保留一个 webAdressViewControllers 数组作为该代码所属的任何对象的属性 - 然后在其 dealloc 方法中释放它们。

但我想知道你为什么首先创建 webAdressViewControllers ？除了创建视图的代码之外，您在 webAdressViewController 类中是否有任何代码？（如果你现在说的是释放控制器，我怀疑不是。）如果你以后不需要控制器，为什么不直接创建视图，然后将它们添加为子视图并释放它们？这将使您免于保留大量不需要的视图控制器。

您还需要将选项卡式视图控制器保留为属性，并在 dealloc 中释放它。

parentViewController 有两个保留计数 - 一次用于分配初始化，两次用于添加到数组中。如果您不需要自己再次直接访问此控制器（即，如果选项卡式控制器完成了您需要的所有视图 cmanagement），那么您应该释放它一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T21:18:28.157

您应该在发送`addSubView`消息后立即释放循环内的每个视图。`parentViewController.view`将保留视图并将它们作为其`dealloc`.

如果您在此之前释放它们，则视图将被释放。

相反，您应该保留您的 parentViewController。这是拥有您创建的视图的视图控制器。当您释放它时，它将释放您添加所有其他视图的视图 - 依次释放它们。

当用户关闭 parentView 控制器时，您会释放它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T23:05:40.223

使用自动释放池，它会在不再需要时释放您分配的对象。

```
UIViewController *webadressViewController = [[[WebadressViewController alloc] initWithNibName:@"WebadressViewController" bundle:nil] autorelease]; 
```

或者，在循环的最后一行添加 release 语句（推荐）：

```
[webaddressViewController release]; 
```

如果你有一个紧密的循环，就像你在这里一样，如果你使用传统的分配/释放模式，效率会更高。

如果您将代码保持原样，则会发生内存泄漏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T19:07:48.657

虽然可能与手头的问题无关，但请注意 UINavigationController 不支持推送 UITabBarController。请参阅[此 SO 问题](https://stackoverflow.com/questions/576764/tab-bar-controller-inside-a-navigation-controller-or-sharing-a-navigation-root-v)（和答案）。

# python - 你有 Unipath-0.2.0.tar.gz 的副本吗？

> ID：671542
> 
> 赞同：0
> 
> 时间：2009-03-22T20:07:01.260
> 
> 标签：python

我需要在我的系统上安装这个库的副本，因为我的软件依赖于这个库。

不幸的是，目前不可能通过easy_install安装它：

```
andrea@puzzle:~$ sudo easy_install Unipath
[sudo] password for andrea: 
Searching for Unipath
Reading http://pypi.python.org/simple/Unipath/
Reading http://sluggo.scrapping.cc/python/unipath/
Download error: (-2, 'Name or service not known') -- Some packages may not be found!
Reading http://sluggo.scrapping.cc/python/unipath/
Download error: (-2, 'Name or service not known') -- Some packages may not be found!
Best match: Unipath 0.2.0
Downloading http://sluggo.scrapping.cc/python/unipath/Unipath-0.2.0.tar.gz
error: Download error for http://sluggo.scrapping.cc/python/unipath/Unipath-0.2.0.tar.gz: (-2, 'Name or service not known') 
```

我认为`sluggo.scrapping.cc`. 我怎样才能得到这个库？

我在谷歌上搜索了一面镜子，但没有找到。你知道是否有其他地方可以下载这个库？

或者......你有这个图书馆的副本，你可以把它发给我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-22T21:19:08.420

我发现[这篇](http://groups.google.com/group/python-file-system-discuss/browse_thread/thread/a421d749eff8a230/4eacafbf70b6c04b?hl=en&q=unipath+python#4eacafbf70b6c04b)新闻组帖子是我的 Mike Orr（Unipath 的创建者）写的。在最后一句话中，他说他正在将项目从[旧服务器](http://sluggo.scrapping.cc)转移到 Bitbucket。因此，移动完成后问题可能会得到解决。

Mike Orr 消息的日期为 2009 年 3 月 10 日，在撰写本文时是 2009 年 3 月 29 日，我还可以在[http://bitbucket.org/slugo/unipath上看到源代码](http://bitbucket.org/sluggo/unipath)

**解决方法**

我在我的旧系统的备份存档中找到了一个 .egg 文件。我把文件上传到网上。

但我认为它只为那些拥有 python 2.5 的人解决了这个问题。要安装它，请使用：

```
easy_install http://trash-cli.googlecode.com/files/Unipath-0.2.1-py2.5.egg 
```

我希望 sluggo.scrapping.cc 服务器上的问题能很快得到解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T14:37:52.557

我联系了原作者，他确认我的 DNS 条目有问题，他会解决它。

他还将最新的 tarball 上传到 pypi，所以现在您可以使用`easy_install Unipath`.

# asp.net - dotNET 中的 SQL 参数

> ID：671543
> 
> 赞同：0
> 
> 时间：2009-03-22T20:08:19.010
> 
> 标签：asp.net, sql-server-2005

这里有一个小问题......

```
string SQL = @"INSERT INTO [Answers] ([UserID],[QuestionID],[SelectedIndex]) 
  VALUES(@uid,@qid,@sin)";
    SqlParameter[] par = new SqlParameter[] { 
    new SqlParameter("@uid",this.userid),
    new SqlParameter("@qid",this.questionid),
    new SqlParameter("@sin",this.qOptions.SelectedIndex)
    }; 
```

这不起作用......为什么不呢？我不知道，但第一个是 SQL（microsoft 2005）中的 bigint，而在 dotNET 方面它是一个 int ...第二个是 SQL 唯一标识符，而它是 dotNEWT 中的一个字符串，但它以这种方式工作，我有经验.. 第三个是 SQL 中的整数和 dotNET 中的 int ...由于 dotNET 没有任何重大故障，我的主要故障是什么？:) 提前谢谢你 sargeant :)))

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T20:16:45.387

`uniqueidentifier`我相信应该映射到`Guid`而不是`string`。如果你`Guid`改为 a 会发生什么（仅用于测试值）？有关映射列表，请参阅[`SqlDbType`枚举文档](http://msdn.microsoft.com/en-us/library/system.data.sqldbtype.aspx)。

*顺便说一句，如果你说它以何种方式*不起作用，它也会有所帮助。当您报告问题时，这*总是一个好主意。*它会抛出异常吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T20:21:26.187

[SqlGuid 的隐式运算符](http://msdn.microsoft.com/en-us/library/system.data.sqltypes.sqlguid.op_implicit.aspx)需要 a `Guid`，而不是`int`. 或者，[还有`String`,`Byte[]`和的显式构造函数`int`。](http://msdn.microsoft.com/en-us/library/system.data.sqltypes.sqlguid.sqlguid.aspx)

# c# - 哪个控件执行类型转换：GridView还是数据源控件？

> ID：671552
> 
> 赞同：0
> 
> 时间：2009-03-22T20:16:45.793
> 
> 标签：c#, .net, asp.net, ado.net

假设我们将 GridView 数据绑定到 ObjectDataSource 控件，然后执行查询。

A) 我意识到显示的 GridView 字段是 String 类型，但是 GridView 是否也知道底层数据源值是什么类型（对于特定的 GridView 列）？

* 因此，如果数据源将使用一堆整数填充 GridView，则必须将这些整数转换为字符串，然后才能在 GridView 中显示。哪个控件将执行转换，GridView 还是 ObjectDataSource/SqlDataSource 控件？

B) 不管是GridView 还是ObjectDataSource 执行转换，该转换是如何执行的？只需在对象上调用 ToString() ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T00:20:06.550

下面是绑定列控件的代码（通过反射器）：

```
 if (this.formatting.Length == 0)
 {
     return dataValue.ToString();
 }
 return string.Format(CultureInfo.CurrentCulture, this.formatting, new object[] { dataValue }); 
```

*   this.formatting：格式字符串，是 Henk 解释的。
*   dataValue：一个对象变量，它是绑定属性的值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T23:46:29.690

格式化（包括转换）由 GridView 完成。您可以通过查看每列的 DataFormatString 属性来看到这一点。这使用一般的 .NET 复合格式，例如 string.Format() 或 Console.Writeline()。它默认为 ToString()。但 DataFormatString 将接受 dd-mm-yyyy 作为 DateTime 列。

# xsd - 如何将 XSD 转换为 Ecore (EMF)

> ID：671555
> 
> 赞同：9
> 
> 时间：2009-03-22T20:19:11.857
> 
> 标签：xsd, eclipse-plugin, eclipse-emf, eclipse-emf-ecore

`.xsd`将-files转换为 -files 的最佳方法是什么`.ecore`？

有 Eclipse 插件吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-23T17:01:26.580

这对我有用：

*   新建 -> 项目...
*   Eclipse 建模框架 -> EMF 项目
*   **模型导入器：** *XML 模式*
*   **模型 URI**：*[选择 xsd 文件]*

要在 xsd 更改时重新验证 .ecore-File：

*   右键单击*.genmodel* -文件
*   **重新加载...**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-23T12:11:09.457

如果您不想每次将模式导入为 ECore 模型时都创建新的 MDT 项目，那么还有另一种方法可以做到这一点：

*   新建 -> **EMF 生成器模型**（在“Eclipse 建模框架”中）
*   *按下一步*
*   选择文件夹并**指定文件名**（必须具有扩展名“genmodel”）
*   *按下一步*
*   选择“ **XML Schema** ”作为模型导入器
*   *按下一步*
*   选择**XSD的 URI**
*   （或者，如果要生成 .xsd2ecore 地图文件，请选择复选框“创建 XML 架构到 Ecore 地图”）
*   *按下一步*
*   选择所有需要的**根包**
*   *按**完成***

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-01-06T10:41:36.550

一个示例类。我没有清理进口。

```
 import org.eclipse.emf.common.util.URI;

import java.io.IOException;
import java.util.Collection;
import java.util.Iterator;

import org.eclipse.emf.ecore.*;
import org.eclipse.xsd.*;
import org.eclipse.xsd.ecore.XSDEcoreBuilder;
import org.eclipse.emf.ecore.resource.Resource;
import org.eclipse.emf.ecore.resource.ResourceSet;
import org.eclipse.emf.ecore.resource.impl.ResourceSetImpl;
import org.eclipse.emf.ecore.xmi.*;
import org.eclipse.emf.ecore.xmi.impl.XMIResourceFactoryImpl;
import org.eclipse.emf.edit.ui.*;

public class Xsd2Ecore {

    public static void main(String[] args) {
        Xsd2Ecore x2e = new Xsd2Ecore();
        x2e.go("UMLVersions/V1.0.0/UML2XMI.xsd", "UMLVersions/V1.0.0/UML2100.xmi");
    }

    public void go(String sourcename, String targetname) {

        System.out.println("Starting");

        XSDEcoreBuilder xsdEcoreBuilder = new XSDEcoreBuilder();
        ResourceSet resourceSet = new ResourceSetImpl();
        Collection eCorePackages = xsdEcoreBuilder.generate(URI.createFileURI(sourcename));

        resourceSet.getResourceFactoryRegistry().getExtensionToFactoryMap().put("xmi", new XMIResourceFactoryImpl());
        Resource resource = resourceSet.createResource(URI.createFileURI(targetname));

        for (Iterator iter = eCorePackages.iterator(); iter.hasNext();) {
            EPackage element = (EPackage) iter.next();
            resource.getContents().add(element);
        }

        try {
            resource.save(null);
        } catch (IOException e) {
            e.printStackTrace();
        }

        System.out.println("Finished");

    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-12T12:33:34.213

你有没有尝试过

```
eclipse –console –noExit –noSplash -data C:\temp\emf-ws
    -application org.eclipse.xsd.ecore.importer.XSD2GenModel 
```

它为您的 XSD 集生成 .ecore 和 .genmodel。

# iphone - 为什么 Apple 的 SDK 文档不包含 UI*？

> ID：671559
> 
> 赞同：2
> 
> 时间：2009-03-22T20:21:49.540
> 
> 标签：iphone, cocoa-touch, uiwebview, uitextfield

[例如，UIWebView、UIColor 或 UITextField 在http://developer.apple.com/search.php](http://developer.apple.com/search.php)或 Xcode 附带的文档中没有条目。这些记录在某处吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-22T21:02:06.650

iPhone OS 文档集绝对可以在 Xcode 附带的文档中找到（iPhone SDK 下载）。不过，您可能需要下载它。

[替代文字 http://img.skitch.com/20090322-miff6sdtterr48pkbcjwh75pun.jpg](http://img.skitch.com/20090322-miff6sdtterr48pkbcjwh75pun.jpg)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T13:28:04.783

此文档可在 iPhone 开发者中心获得。

1.  转到[developer.apple.com](http://developer.apple.com)
2.  在顶部，选择 Dev Centers 并选择[iPhone Dev Center](http://developer.apple.com/iphone/)
3.  打开[iPhone 参考资料库](http://developer.apple.com/iphone/library/navigation/index.html)
4.  点击左侧的[UIKit](http://developer.apple.com/iphone/library/navigation/Frameworks/CocoaTouch/UIKit/index.html)

# asp.net-mvc - 每个视图的公共方法？ASP.MVC 中的默认 ActionResult 和路由

> ID：671561
> 
> 赞同：1
> 
> 时间：2009-03-22T20:22:35.247
> 
> 标签：asp.net-mvc, asp.net-routing

我正在试验 ASP.NET MVC 和路由。

似乎 MVC 在我想创建视图的任何时候都强制我向控制器添加一个公共方法。例如：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        return View();
    }

    public ActionResult About()
    {
        return View();
    }

    //... a public method for every view.. :(
} 
```

我不想为每个视图创建一个公共方法。默认情况下，除非另有说明，否则我希望系统中所有视图的“返回 View()”行为。

例如，HTTP GET：

```
site.com/about
site.com/features
网站.com/
site.com/testimonials
site.com/contact-us

```

就目前而言，我必须补充：

```
HomeController.About()
HomeController.Features()
HomeController.Index()
HomeController.Testimonials()
HomeController.ContactUs() 
```

所有结果都是“返回 View()”。这是我的问题，我试图消除为简单视图创建公共操作方法。

对于需要额外处理的视图，例如 HTTP POST 上的“联系我们”页面，用于：

```
site.com/contact-us

```

我想专门在控制器中添加一个方法来发送 SMTP 消息。

* * *

以下是我正在尝试做的更简洁的示例：

```
public class HomeController{

   public ActionResult ShowBasicView(){
     //HTTP GET:
     //site.com/about
     //site.com/features
     //site.com/
     //site.com/testimonials

     //All URLs above map to this action

     return View();
   }

   [AcceptVerbs(HttpVerbs.Post)]
   public ActionResult ContactUs(FormCollection data){

     //HTTP POST:
     //site.com/contact-us

     //POST URL maps here.

     SmtpClient.Send(new MailMessage()) //etc...
     return View()
   }

} 
```

谢谢，布赖恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T21:51:37.373

从您的编辑中获得 ShowBasicView 的潜在问题是，由于视图的隐式连接，这些 url 中的每一个都将返回相同的视图，即：

> \Views\Home\ShowBasicView.aspx

现在，这可能是您想要的，尽管它可能不太可能。

您可以通过以下路线进行设置：

```
routes.MapRoute(  
  "ShowBasic",
  "{id}",
  new { controller = "Home", action = "ShowBasicView", id = "home" }
); 
```

并将您的控制器修改为：

```
public class HomeController: Controller{

  public ActionResult ShowBasicView(string pageName){
    // Do something here to get the page data from the Model, 
    // and pass it into the ViewData
    ViewData.Model = GetContent(pageName);

    // All URLs above map to this action
    return View();
  }
} 
```

或者，如果内容在视图中被硬编码，您可以尝试：

```
public class HomeController: Controller{

  public ActionResult ShowBasicView(string pageName){
    // All URLs above map to this action
    // Pass the page name to the view method to call that view.        
    return View(pageName);
  }
} 
```

您可能还必须为基本 URL 添加路由，因为 ShowBasic 路由只会针对具有字符串值的 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T12:18:05.897

您可以在控制器中添加以下方法，它

```
protected override void HandleUnknownAction(string actionName)
{
    try{
       this.View(actionName).ExecuteResult(this.ControllerContext);
    }catch(Exception ex){
       // log exception...
       base.HandleUnknownAction(actionName);
    }
} 
```

# wpf - 将关闭命令绑定到 Tabcontrol 数据模板中的按钮的问题

> ID：671564
> 
> 赞同：1
> 
> 时间：2009-03-22T20:27:34.923
> 
> 标签：wpf, prism, command, tabcontrol, binding

我正在使用复合应用程序指导模式来构建我的 WPF 应用程序。在我的 Shell 中，我有一个 tabcontrol，其中包含一个用于将视图动态加载到该区域的区域。视图被加载到 TabControl 中的新选项卡中。

```
 <TabControl     
      AutomationProperties.AutomationId="MainTabControl" 
      cal:RegionManager.RegionName="{x:Static inf:RegionNames.MainRegion}" 
      Width="Auto" Height="Auto" Margin="10,10,0,0" 
      HorizontalAlignment="Stretch"                            
      IsSynchronizedWithCurrentItem="True"
      ItemTemplate="{StaticResource TabItemTemplate}"
SelectionChanged="TabControl_SelectionChanged"> 
```

我有一个用于实现 CloseButton 的 DataTemplate“TabItemTemplate”。我不知道如何将 DataTemplate 中的按钮命令绑定到 PresentationModel 中的关闭命令。如果我将命令绑定到 CompositCommand，则执行该命令。但随后我必须找出关闭按钮被按下的选项卡，并且只在该 PresentationModel 中执行 closeCommand。下面是数据模板。

```
<DataTemplate x:Key="ClosableTabItemTemplate">
            <DockPanel Width="120">
                <Button 
                    Command="inf:CloseCommands.CloseCommand"
                    Content="X"
                    Cursor="Hand"
                    DockPanel.Dock="Right"
                    Focusable="False"
                    FontFamily="Courier" 
                    FontSize="9"
                    FontWeight="Bold"  
                    Margin="0,1,0,0"
                    Padding="0"
                    VerticalContentAlignment="Bottom"
                    Width="16" Height="16" 
                    />
                <ContentPresenter 
        Content="{Binding}" 
        VerticalAlignment="Center" 
        />
            </DockPanel>
        </DataTemplate> 
```

有谁知道如何解决这个绑定问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-29T15:09:33.997

我在学习 Prism 时遇到了同样的问题，并通过使用元素绑定解决了这个问题。

```
<Button Content="x" Command="{Binding ElementName=Scooby, Path=Content.DataContext.CloseCommand}" /> 
```

其中 Scooby 是我的 shell 窗口的名称，而*CloseCommand*是 Shell 的 ViewModel 中的 Prism *DelegateCommand*。

我想我应该在这里添加它，因为它会展示您解决方案的另一种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T22:30:43.130

您应该绑定到视图模型上的命令实例，例如由属性公开的 DelegateCommand，或者将 CommandParameter 绑定到 TabItem 的 DataContext 以便可以将共享命令传递给项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T06:39:21.387

我找到了解决这个问题的方法。问题是当我将 UserControl 绑定到 TabControl 时，只有 contentpane 的 datacontext 设置为 usercontrol，并且 headerpane 的 datacontext 仍然为空。但是，如果我定义了两个数据模板，一个用于项目，一个用于内容，然后将presentationModel 添加到该区域，则会填充项目和内容的dataContext。然后我可以在 itemTemplate 中绑定到presentationModel 中的delegateCommand 属性。

# url - 让 Google 索引动态 PHP 页面

> ID：671565
> 
> 赞同：0
> 
> 时间：2009-03-22T20:27:38.700
> 
> 标签：url, indexing, sitemap

我计划建立一个链接不是设置 HTML 页面（例如 mypage.com/contact_me.html）而是动态（profile.php?uid=32320&mode=2）的网站。

我怎样才能让谷歌索引这样的网站，以便每个个人资料（就像 facebook 所做的那样）在谷歌上单独索引？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-22T20:30:55.680

谷歌可以很好地找到这样的动态页面（假设它可以通过链接找到它们）。

如果您偏执，您可以随时提供[XML 站点地图。](http://www.sitemaps.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T20:58:14.337

谷歌有一个[网站可以帮助网站管理员](http://www.google.com/webmasters/tools/)更好地索引他们的页面以及一些您可能会发现有价值的[分析工具](http://www.google.com/analytics/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T20:57:49.640

使用[URL 重写](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html)使页面对搜索引擎更有意义。Google 将遵循的带有查询字符串的动态 URL 的数量和深度存在限制（但它会遵循一些）。

# html - 其他语言的类似 CL-WHO 的 HTML 模板？

> ID：671572
> 
> 赞同：11
> 
> 时间：2009-03-22T20:31:07.693
> 
> 标签：html, common-lisp, templating

Common Lisp 家伙有他们的[CL-WHO](http://www.weitz.de/cl-who/)，这使得 HTML 模板与“主要”语言集成，从而使任务更容易。对于那些不知道 CL-WHO 的人来说，它看起来像这样（示例来自 CL-WHO 的网页）：

```
(with-html-output (*http-stream*)
(:table :border 0 :cellpadding 4
  (loop for i below 25 by 5
     do (htm
         (:tr :align "right"
          (loop for j from i below (+ i 5)
                do (htm
                    (:td :bgcolor (if (oddp j)
                                    "pink"
                                    "green")
                         (fmt "~@R" (1+ j)))))))))) 
```

你知道其他语言的类似库吗？我所知道的（模仿 CL-WHO）是Python 的[Brevé](http://breve.twisty-industries.com/)。我对 Perl 风格特别感兴趣，但有趣的是其他语言如何处理将 HTML 集成到它们的语法中。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-23T09:21:02.710

对于[CPAN](http://search.cpan.org)产品，请查看以下内容（按字母顺序）...

*   [建造者](http://search.cpan.org/dist/Builder/)
*   [HTML::AsSubs](http://search.cpan.org/dist/HTML-Tree/lib/HTML/AsSubs.pm)
*   [HTML::小](http://search.cpan.org/dist/HTML-Tiny/)
*   [马尔卡普尔](http://search.cpan.org/dist/Markapl/)
*   [模板::声明](http://search.cpan.org/dist/Template-Declare/)
*   [XML::生成器](http://search.cpan.org/dist/XML-Generator/)

使用提供的 CL-WHO 示例的表格部分（减去罗马数字和 s/background-color/color/ 在此处将代码压缩到屏幕宽度！）....

## 建造者

```
use Builder;
my $builder = Builder->new;
my $h = $builder->block( 'Builder::XML' );

$h->table( { border => 0, cellpadding => 4 }, sub {
   for ( my $i = 1; $i < 25; $i += 5 ) {
       $h->tr( { align => 'right' }, sub {
           for my $j (0..4) {
               $h->td( { color => $j % 2 ? 'pink' : 'green' }, $i + $j );
           }
       });
   } 
});

say $builder->render; 
```

## HTML::AsSubs

```
use HTML::AsSubs;

my $td = sub {
    my $i = shift;
    return map { 
        td( { color => $_ % 2 ? 'pink' : 'green' }, $i + $_ )
    } 0..4;
};

say table( { border => 0, cellpadding => 4 },
    map { 
        &tr( { align => 'right' }, $td->( $_ ) ) 
    } loop( below => 25, by => 5 )
)->as_HTML; 
```

## HTML::小

```
use HTML::Tiny;
my $h = HTML::Tiny->new;

my $td = sub {
    my $i = shift;
    return map { 
        $h->td( { 'color' => $_ % 2 ? 'pink' : 'green' }, $i + $_ )
    } 0..4;
};

say $h->table(
    { border => 0, cellpadding => 4 },
    [
        map { 
            $h->tr( { align => 'right' }, [ $td->( $_ ) ] )  
        } loop( below => 25, by => 5 )    
    ]
); 
```

## 马尔卡普尔

```
use Markapl;

template 'MyTable' => sub {
    table ( border => 0, cellpadding => 4 ) {
       for ( my $i = 1; $i < 25; $i += 5 ) {
           row ( align => 'right' ) {
               for my $j ( 0.. 4 ) {
                   td ( color => $j % 2 ? 'pink' : 'green' ) { $i + $j }
               }
           }
       } 
    }
};

print main->render( 'MyTable' ); 
```

## 模板::声明

```
package MyTemplates;
use Template::Declare::Tags;
use base 'Template::Declare';

template 'MyTable' => sub {
    table {
        attr { border => 0, cellpadding => 4 };
        for ( my $i = 1; $i < 25; $i += 5 ) {
            row  {
                attr { align => 'right' };
                    for my $j ( 0..4 ) {
                        cell {
                            attr { color => $j % 2 ? 'pink' : 'green' } 
                            outs $i + $j;
                        }
                    }
            }
        } 
    }
};

package main;
use Template::Declare;
Template::Declare->init( roots => ['MyTemplates'] );
print Template::Declare->show( 'MyTable' ); 
```

## XML::生成器

```
use XML::Generator;
my $x = XML::Generator->new( pretty => 2 );

my $td = sub {
    my $i = shift;
    return map { 
        $x->td( { 'color' => $_ % 2 ? 'pink' : 'green' }, $i + $_ )
    } 0..4;
};

say $x->table(
    { border => 0, cellpadding => 4 },
    map { 
        $x->tr( { align => 'right' }, $td->( $_ ) )  
    } loop( below => 25, by => 5 )    
); 
```

*以下可用于在 HTML::AsSubs / HTML::Tiny / XML::Generator 示例中生成“循环”....*

```
sub loop {
    my ( %p ) = @_;
    my @list;

    for ( my $i = $p{start} || 1; $i < $p{below}; $i += $p{by} ) {
        push @list, $i;
    }

    return @list;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-23T02:28:38.613

[Perl 基金会](http://www.perlfoundation.org/)当前资助的项目之一（Perl 6 的轻量级[Web 框架](http://www.perlfoundation.org/ilya_carl_and_stephen_a_lightweight_web_framework_for_perl_6)）具有可工作的 Perl6 代码，该代码[提供了类似的界面](http://blogs.gurulabs.com/stephen/2009/03/tagspm-for-the-perl-6-web-proj.html)：

```
use Tags;
say show {
    html {
        head { title { 'Tags Demo' } }
        body {
            outs "hi";
            ul :id<numberlist> {
                outs "A list from one to ten:";
                for 1..10 {
                    li :class<number>, { $_ }
                }
            }
        }
    }
} 
```

[浏览或克隆github](http://github.com/masak/web/tree/master)上的当前代码。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-22T20:51:03.293

Perl 的 CGI 模块支持这样的东西。

```
use CGI ':standard';
use Lisp::Fmt 

print header();

print table( { -border => 1, -cellpading => 4},
    loop({ below => 25, by=> 5}, sub {
        my $i = shift;
        tr( {-align => 'right'} ,
            loop({ from => $i, below $i + 5}, sub {
                my $j = shift;
                td({-bgcolor => ($oddp eq $j ? 'pink' : 'green')}
                    fmt("~@R", 1+$j);
            })
        )
    }); 
```

我试图让它保持 lispy，所以你必须自己实现一个 lispy`loop`函数。我并没有真正编写公共列表，所以我希望我正确理解了您的代码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-22T23:57:23.063

有[stan](http://www.kieranholland.com/code/documentation/nevow-stan/)：*一种类似 s-expression 的语法，用于在纯 python 中表达 xml*，来自[Divmod 的 Nevow](http://divmod.org/trac/wiki/DivmodNevow)。我认为这是你想要的。链接教程中的一个示例：

```
t = T.table[
           T.tr[
               T.td[ "Name:" ],
               T.td[ original.name ]
           ],
           T.tr[
               T.td[ "Email:" ],
               T.td[T.a(href='mailto:%s' % original.email)[ original.email ] ]
           ],
           T.tr[
               T.td[ "Password:" ],
               T.td[ "******" ]
           ],
       ] 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-22T22:35:54.430

Perl 的标准[CGI](http://search.cpan.org/dist/CGI.pm/CGI.pm)模块可以做类似的事情：

```
#!/usr/bin/perl

use strict;
use warnings;
use CGI qw/:standard/;

print 
    start_html("An example"),
    h1(
        {
            -align => "left",
            -class => "headerinfo",
        },
        'this is an example'
    ),
    "The CGI module has functions that add HTML:",
    ul( map li($_),
        ("start_html",
        "h1, h2, h3, etc.",
        "ol, ul, li",
        "ol, ul, li",
        "table, tr, th, td")
    ),
    "and many more.",
    end_html(); 
```

这会产生：

```
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
<title>An example</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
</head>
<body>
<h1 class="headerinfo" align="left">this is an example</h1>The CGI module has functions that add HTML:<ul><li>start_html</li> <li>h1, h2, h3, etc.</li> <li>ol, ul, li</li> <li>ol, ul, li</li> <li>table, tr, th, td</li></ul>and many more.
</body>
</html> 
```

li 部分可以这样重写

```
print ol(map li($_), @list); 
```

如果你有一个列表或数组。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-28T21:23:22.963

## Clojure

Clojure 中有许多受 CL-WHO 启发的 HTML 生成库（正如人们所料，Clojure 是一个 Lisp）。以下是使用[Compojure](http://github.com/weavejester/compojure/tree/master)和[cl-format](http://github.com/tomfaulhaber/cl-format/tree/master)附带的 HTML 库的方法：

```
(use 'compojure.html
     'com.infolace.format)

(html
 [:table {:border 0 :cellpadding 4}
  (map (fn [tds] [:tr {:align "right"} tds])
       (partition 5 (map (fn [num color]
                           [:td {:bgcolor color}
                            (cl-format nil "~@R" (inc num))])
                         (range 25)
                         (cycle ["green" "pink"]))))]) 
```

Compojure 的 HTML 库很好地利用了 Clojure 的文字哈希映射作为属性/值对，并且对标签使用文字向量而不是所有内容的列表有助于标签突出一点，并避免对宏魔术的一些需求。

`partition`将集合分解为若干个元素的组。 `cycle`生成一个无限重复的集合元素列表。这些加上`range`并`map`帮助您避免显式循环和计数器变量。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T16:32:44.253

[JavaScript 就是这样](http://elzr.com/posts/hyperscript)。它如下所示：

```
T.div({ className: "content"},
      T.p("Some ", T.u("paragraph")),
      T.p("Another paragraph")) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-07-22T21:20:44.837

## 哈斯克尔

Haskell 有一个与 CL-WHO 没有什么不同的 HTML 组合库。然而，惰性函数式编程方法确实导致了与 Common Lisp 中的循环设施大不相同的惯用迭代结构：

```
import Data.Char
import Data.List
import Text.Html
-- from http://fawcett.blogspot.com/2007/08/roman-numerals-in-haskell.html
import RomanNumerals

-- Simple roman numeral conversion; returns "" if it cannot convert.
rom :: Int -> String
rom r = let m = toRoman r
        in (map toUpper . maybe "" id) m

-- Group a list N elements at a time.
-- groupN 2 [1,2,3,4,5] == [[1,2],[3,4],[5]]
groupN n [] = []
groupN n xs = let (a, b) = splitAt n xs in a : (groupN n b)

pink = "pink" -- for convenience below; green is already covered by Text.Html

rom_table = table ! [border 0, cellpadding 4] << trs
    where
      -- a list of <tr> entries
      trs = map (rom_tr . map rom_td) rom_array

      -- generates a <tr> from a list of <td>s
      rom_tr tds = tr ! [align "right"] << tds

      -- generates a <td> given a numeral and a color
      rom_td (r, c) = td ! [bgcolor c] << r

      -- our 5 x 5 array (list x list) of numerals and colors
      rom_array = (groupN 5 . take 25) rom_colors

      -- a theoretically infinite list of pairs of roman numerals and colors
      -- (practically, though, the roman numeral library has limits!)
      rom_colors = zip (map rom [1..]) colors

      -- an infinite list of alternating green and pink colors
      colors = cycle [green, pink]

main = let s = prettyHtml rom_table 
       in putStrLn s 
```

我应该注意 Text.Html 中还有一个小组合库，用于使用“above”和“beside”运算符来计算行/列跨度来组合表格，但是在应用属性来精确复制这个示例方面有点过于简单，并且我们不需要花哨的行和列拆分。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-06-22T18:02:55.063

有[html-tags](http://wiki.call-cc.org/egg/html-tags)，一个[鸡计划](http://call-cc.org)扩展。html-tags 生成 [X]HTML 或 SXML。

这是一个示例（使用循环扩展并考虑字符串输出）：

```
(<table> border: 0 cellpadding: 4
  (string-intersperse
   (loop for i below 25 by 5
         collect
         (<tr> align: "right"
               (string-intersperse
                (loop for j from i below (+ i 5)
                      collect
                      (<td> bgcolor: (if (odd? j)
                                         "pink"
                                         "green")
                            (+ 1 j)))))))) 
```

我会添加指向循环和 html-utils 扩展（基于 html-tags 构建）的链接，但 stackoverflow 认为我是垃圾邮件发送者，并且只允许我发布最多两个链接。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-02-19T20:17:14.407

Racket 的内置[XML 库](https://docs.racket-lang.org/xml/index.html)具有此功能。它能够从“X 表达式”生成 XML/HTML。例如：

```
#lang racket
(require xml)

(define my-name "XYZ")
(define my-list '("One" "Two" "Three"))
(define my-html
  `(html
     (head (title "Hello!")
           (meta ((charset "utf-8"))))
     (body (h1 "Hello!")
           (p "This is a paragraph.")

           ;; HTML attributes.
           (p ((id "some-id")
               (class "some-class"))
              "This is another paragraph.")
           (p "This is a link: " (a ((href "https://example.com")) "Example"))

           ;; Unquoting.
           (p "My name is: " ,my-name ".")
           (p ,(string-append "My name is: " my-name "."))  ; Same thing.

           (ul (li "One")
               (li "Two")
               (li "Three"))
           ;; Programatically generate the same list as above.
           (ul ,@(map (lambda (x)
                        `(li ,x))
                      my-list))

           ,(comment "This is a HTML comment."))))

(displayln (string-append "<!DOCTYPE html>"
                          (xexpr->string my-html))) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-21T13:47:36.333

[domonic](https://pypi.org/project/domonic/)是一个 python 库，它使用魔法方法和 dunders 来尝试和支持这种东西......

```
from domonic.html import *
mydom = html(body(h1('Hello, World!')))
print(f"{mydom}") 
```

文档... [https://domonic.readthedocs.io/packages/html.html](https://domonic.readthedocs.io/packages/html.html)

```
pip install domonic 
```

# javascript - 使用 javascript jQuery 突出显示 html 中的文本

> ID：671574
> 
> 赞同：3
> 
> 时间：2009-03-22T20:31:31.733
> 
> 标签：javascript, jquery

我想以编程方式突出显示 ap 标签中的所有关键字（不区分大小写）

如果关键字是

```
var keywords = "hello,thanks, goodbye" // this should be an array
<p>hello world</p> 
```

你好应该以蓝色突出显示

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T20:38:35.927

我认为您正在寻找[jQuery highlight](http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html)插件。

加载后，您可以执行以下操作：

```
var words = "hello,thanks, goodbye";
var keywords = words.split(',');
for(var x = 0; x < keywords.length; x++) {
    $(selector).highlight($.trim(keywords[x]));
} 
```

`selector`您要在文档中查找的元素在哪里。如果您希望对整个页面进行操作，只需将`'body'`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2011-03-07T21:14:30.517

对于宽松的 jQuery 高亮插件，您可能需要考虑[http://www.frightanic.com/2011/02/27/lenient-jquery-highlight-plugin-javascript/](http://www.frightanic.com/2011/02/27/lenient-jquery-highlight-plugin-javascript/)

# c# - NHibernate ISet 与 IList

> ID：671575
> 
> 赞同：14
> 
> 时间：2009-03-22T20:31:47.660
> 
> 标签：c#, nhibernate

在大多数 NIBerate 示例中，他们使用 ISET 而不是 IList。我知道两者之间的基本区别，*即* **一组是唯一的**。但是，我不确定他们为什么在延迟加载时使用 ISet 而不是 IList。

(Iesi.Collections.Generic)ISet 比 IList 有什么优势？延迟加载时的特殊性。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-22T20:41:36.140

我相信这主要是由于 NHibernate 的 java 传统。

请参阅[有关持久性集合的常见问题解答条目](http://www.hibernate.org/359.html#A9)。特别提到默认情况下 Java 如何包含比 C# 更多的集合，并且它们特别映射到 ISet。

我相信大多数示例使用它的原因主要是因为这在 Java 中更常见，并且示例是从 Java 移植的。（一些样本使用 set 而不是真的需要它是一个集合......）

话虽如此，集合与列表存在明显差异。行为是不同的，因此在某些用例中，集合的行为更合适。对于延迟加载，这允许您减少对事物加载顺序的限制，因此您可以潜在地加载更少的信息并保持接口合同到位。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-22T20:38:23.183

集合接口仅表示生成的集合可以是：

1.  会员资格测试
2.  以任意顺序枚举（可能会改变）

列表接口表示第一个，但第二个更强，排序定义明确，除非有指示，否则不会改变。

通过使用限制较少的合同（集合），您可以使用更多的自由（例如，您可以按任何顺序加载集合，使用您的类的人不应该关心此顺序是否一致）

我在这里掩盖了这样一个事实，即该集合进一步确保了它不能包含重复项（这是对实施者的限制）。但是，如果您需要存储此类实例，则集合将是不可接受的，因此这不再是问题，而是成为积极因素。消费者的工作变得更加容易，因为他们不必担心存在重复，这已经为他们提供了保证。

# ajax - 如何在 Web 应用程序中对用户进行排队？

> ID：671577
> 
> 赞同：2
> 
> 时间：2009-03-22T20:33:25.720
> 
> 标签：ajax, web-applications, queue

我有一个通过 9 针串行连接与本地 UI 控制的机器人，我想通过网页控制它，但任何时候都应该只有一个用户能够与之交互。我仍在考虑如何在 Web 服务器和本地 PC 之间使用 WCF 通信，以后可能会问这个问题。现在，我正准备让 Web 服务器和前端对想要控制机器人的用户进行排队，先到先得。

到目前为止，我唯一想到的就是按照用户请求控制机器人的顺序存储用户会话，然后使用 AJAX 让每个人知道何时轮到他们。我想向用户显示他们在队列中的位置，并在其他人完成时将用户在队列中移动，放弃他们的会话或在轮到他们时超时。

这似乎是正确的想法吗？您是否已经这样做了并且有一个有效的好方法？我愿意听听它是如何在任何平台上完成的，只要这些概念也适用于使用 ASP.NET 完成它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T17:53:14.840

在我看来，Web 应用程序是多用户和大规模并发的。因此，我不确定 Web 应用程序是否是您问题的最佳答案。

但是，我认为可以通过管理在多个客户端之间共享的唯一令牌（例如在令牌环网络上）来管理 webapp 上的问题。

在客户端，就像聊天系统一样，您必须保持客户端的连接打开。为此，我认为您必须实现[Periodic Refresh Ajax 模式](http://ajaxpatterns.org/Periodic_Refresh)。

还要检查“服务器推送的内容”系统，例如[Comet](http://en.wikipedia.org/wiki/Comet_(programming))（我知道它只是在一段时间前是 Java，但我很确定有一个 .net 等价物可用）。

这是一个快速的描述：

> 在 Web 开发中，Comet 是描述 Web 应用程序模型的新词，在该模型中，长期持有的 HTTP 请求允许 Web 服务器将数据推送到浏览器，而无需浏览器显式请求它

这里还有[一篇关于 Comet on Ajaxian 的有趣文章](http://ajaxian.com/archives/comet-a-new-approach-to-ajax-applications)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-22T23:34:24.810

事实上，有一种解决方案是 .NET 远程处理。

该定义作为令牌是正确的，或者假设应该传递一个对象。

# vim - 如何使终端上的 VIM 窗口完整？

> ID：671583
> 
> 赞同：14
> 
> 时间：2009-03-22T20:39:28.327
> 
> 标签：vim

> **可能重复：**
> [如何在 vim 中运行终端？](https://stackoverflow.com/questions/1236563/how-to-run-a-terminal-inside-of-vim)

我可以使用 split 和 vsplit 很好地设置我的工作区并打开...但我想简单地将其中一个拆分用作终端窗口。我知道打开一个额外的 xterm 并有策略地放置它可能能够实现这一点，但很多时候我被远程连接到一个窗口，并且我的手开始因终端之间的 alt 选项卡而受伤。

更新：根据下面的建议，我想出的最好的方法是使用 screen 并且实际上让 vim 占据了它的一个窗口。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-07-02T00:09:57.860

我使用：[http ://code.google.com/p/conque/wiki/Usage](http://code.google.com/p/conque/wiki/Usage)

您可以键入 :split new 和 :ConqueTerm bash。你有一个工作终端窗口。:)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-22T21:07:40.617

[考虑在GNU Screen](http://www.gnu.org/software/screen/)中同时运行 Vim 和 shell 。[Vim wiki](http://vim.wikia.com/wiki/GNU_Screen_integration)有关于集成 Vim 和 Screen的信息。Screen 支持拆分成类似于 Vim 的“窗口”。有关更紧密的 Vim+Screen 集成的示例，请参见[此处。](http://technotales.wordpress.com/2007/10/03/like-slime-for-vim/)

将 Vim 缓冲区直接绑定到外部交互式命令行应用程序是许多人长期以来一直想要的功能，但由于 Vim 的实现方式，显然它有点难以做到，而且 Vim 开发人员不愿意改变这一点（可以说是有充分理由的）。

但也有一些成功的故事。特别是 Lisp 社区试图在 Vim 中重现 Emacs 的 SLIME（交互式 Lisp 提示符）。有关示例，请参见[VimClojure](http://www.vim.org/scripts/script.php?script_id=2501)和[Limp](http://mikael.jansson.be/hacking/limp/docs/)。其中一个可能会被更改为运行 shell，但这需要一些工作。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-27T18:22:44.467

vimshell补丁听起来像您正在寻找的东西[。](http://www.wana.at/vimshell/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-22T20:52:33.927

如果你在 vim 中，你可以用 ":sh" 命令退出到一个子 shell，然后用 "exit" 回到 vim。或者您可以暂停 vim 并使用 control-Z 返回您启动它的原始 shell，然后使用“fg”（前景）返回 vim。

或者你可以安装一个[“vim-shell”](http://www.wana.at/vimshell/)插件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T07:03:52.943

扩展[Brian Carper 的答案](https://stackoverflow.com/questions/671583/how-does-one-make-a-vim-window-a-full-on-terminal/671615#671615)，您可以将其放入您的 `~/.screenrc`：

```
startup_message off
# Launch 2 screens on startup
split
# Have bash login so $PATH will be updated
screen -t Vim bash -l -c 'vim' 0
focus
screen -t canvas bash -l
# switch focus back to vim
focus up 
```

然后当你输入 时`screen`，你会在顶部有一个 Vim 窗口，在底部有一个 bash 窗口。您可以使用 切换屏幕窗口 `<C-a><Tab>`。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-12-16T17:20:07.453

vim 的 conque shell 也可以做到这一点。

![在此处输入图像描述](https://i.stack.imgur.com/tzoRE.jpg)

[http://www.vim.org/scripts/script.php?script_id=2771](http://www.vim.org/scripts/script.php?script_id=2771)

[http://code.google.com/p/conque/](http://code.google.com/p/conque/)

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-03-22T20:43:52.983

恐怕你将不得不放弃这个 - 在 vi​​m 中没有办法做到这一点。

# silverlight - Silverlight 中的 ViewModel 集合绑定

> ID：671586
> 
> 赞同：0
> 
> 时间：2009-03-22T20:43:03.093
> 
> 标签：silverlight, collections, listbox

我有两个列表框，一个包含所有项目，一个包含活动项目。

我有一个 observablecollection，其中我的所有项目都绑定到所有项目的列表框。我将什么绑定到另一个列表框？我是否需要创建一个新集合并整理出活动的集合。当我添加一个新的活动项目时，我需要添加到这两个集合中。

我正在寻找的行为是将一个新项目添加到所有项目的集合中，以便更新两个列表框。有可能做这样的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T20:48:21.457

如果您有两个集合，您可以订阅主集合上的 CollectionChanged 事件并使用通知来同步另一个列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T21:29:33.620

[您应该可以使用CollectionView](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionview.aspx)来执行此操作。CollectionView 封装了排序和过滤。

在您的情况下，如果您创建一个 CollectionView 过滤掉主集合上的非活动项目并将第二个列表绑定到该视图，那么您应该很高兴。

编辑：如果我阅读了完整的标题并意识到他在谈论 Silverlight... Silverlight 没有 ICollectionView 的公共实现，也没有 CollectionViewSource，而且只有 Datagrid 使用该接口。投票赞成的人应该取消它，这不是问题的好答案。

回到绘图板，我猜。现在我会说我会有两个集合，并监听第一个（完整的）上的事件 - 添加/删除活动项目时从第二个添加/删除 - 添加/删除 PropertyChanged 处理程序添加/删除的项目和 - 当 Active 属性更改时添加/删除到第二个集合/从第二个集合中删除。它很混乱，但是当您需要通过谓词过滤的集合时，它可能足够可打包以重用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T09:40:08.217

我会使用两个集合，主列表和活动项目列表。然后订阅主列表上的[集合更改事件，处理所有](http://msdn.microsoft.com/en-us/library/system.collections.specialized.inotifycollectionchanged.collectionchanged.aspx)[操作](http://msdn.microsoft.com/en-us/library/system.collections.specialized.notifycollectionchangedaction.aspx)

此外，您需要向项目对象添加一个事件，以便您可以处理项目从活动变为非活动的情况，反之亦然，因为集合更改事件仅在集合更改时触发，而不是在它包含的内容发生更改时触发。

# tcp - 对 TCP 数据包格式化有什么好的建议吗？

> ID：671588
> 
> 赞同：2
> 
> 时间：2009-03-22T20:44:19.703
> 
> 标签：tcp

我正在为手机创建一个应用程序，它通过 TCP 连接将加速度测量值发送到服务器。

我想尽可能地减少消息长度，但同时我想让它成为可以扩展的当前格式，而不会在修改接收器解析机制时遇到很多痛苦。

在开始时，我以以下格式发送一个字符串：

```
##measurementTime#AccelerationX#AccelerationY#AccelerationZ 
```

但是在实施后不久，我在消息中添加了一些其他数据，我意识到如果我必须经常修改格式将花费很多时间。

我在考虑 XML，但它增加了很多负载，我当然想避免（测量值每 100-250 毫秒发送一次）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-22T22:30:04.910

我想以[InSciTek Jeff 的回答](https://stackoverflow.com/questions/671588/any-good-advice-for-tcp-packet-formatting/671603#671603)为基础。这就是通常所说的*标签长度​​值编码*。这个想法是第一个代码是*标签*，它告诉你如何解释这个值。第二个代码是*长度*，它告诉您值中有多少字节。这是进行可扩展二进制编码的好方法，并且在 MPEG 编码中被大量使用。

我会在一个好的功能二进制协议上添加更多提示/要求：

1.  在每条消息中包含一个*版本号，说明消息的协议版本*
2.  [以网络字节顺序](http://en.wikipedia.org/wiki/Network_byte_order#Endianness_in_networking)编码每个多字节字段
3.  仔细考虑每个字段的大小
4.  考虑对整数使用多字节编码方案：我找不到好的参考，但想法是，如果有更多字节，则最高位为 1，如果这是最后一个字节，则最高位为 0，每个字节中的低七位字节包含值。
5.  将所有内容作为字节打包到网络上，而不是结构

第一个真的很重要。更重要的是您计划更改并仔细决定协议将如何更改。如果客户端不支持版本号，则不应尝试解释消息。绝不！

当涉及到稳定的实现时，第五个非常重要。我已经为嵌入式设备编写了很多二进制协议实现，使用打包结构是我最后悔的错误。我有太多与忘记字节交换数字字段或不打包结构有关的缺陷。只需编写一个不错的字节打包和解包原语库，对其进行彻底测试，然后认真地使用它。

如果您在设计和实现协议时考虑到这些原则，那么当您必须支持和扩展时，它会让您的生活变得更加轻松。我强烈推荐的最后一件事是为您的协议编写一个解析器，例如[Wireshark](http://wireshark.org/)。它还将使部署、测试和支持变得更容易。只需确保在考虑之前完全理解编写这样一个解剖器以及部署一个解剖器可能产生的法律影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T20:57:32.387

如果您需要完全坚持使用 ASCII 文本类型流，则一项建议是发送简单的键名/值对。键名用于描述每个值传达的字段名称，类似于原始提案：

```
##keyName1=value1#keyName2=value2# 
```

或者，您可以以二进制标记格式发送数据，例如：

```
<tagCodeNum><lengthInBytes><tagValueAsBytes> 
```

其中 tagCodeNum 可能是一个字节或一个字，而长度是一个字节或一个字，具体取决于您的需要。这种格式的想法是接收者可以通过代码识别它理解的字段，然后也可以跳过它不知道如何解码的标签。这样，编码变得可扩展。如果您需要将多个标签分组为逻辑消息，我会将一组这些二进制编码的标签包装在整个消息层次结构中：

```
<messageCodeNum><lengthInBytes><tag><tag><tag> 
```

上面的标签是上述标签结构的复制，长度描述了所有标签组合在一起的字节长度。

*注意：如果您考虑这种结构，它与 XML 类型的结构并没有太大的不同，但它更加简洁和受限，因此解码起来几乎是微不足道的。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T20:57:05.493

如果您想减小大小，我真诚地建议将您的数据包结构更改为二进制格式，这也将允许根据您如何分隔数据包轻松扩展。

您可以在以下范围内做一些事情：

> n 字节开始+大小
> n 字节时间
> 2-8 字节 x
> 2-8 字节 y
> 2-8 字节 z

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T21:43:12.370

考虑一些优化的东西：
- 只发送与前一个值的差值；
- 不时发送一个完整的帧；
- 不要使用 xml，做你的结构定义；

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-22T22:44:34.423

> 我在考虑 XML，但它增加了很多负载

您可以改用 JSON。它不会像二进制格式那样紧凑，但比 XML 紧凑得多。并且您可以轻松扩展数据格式。

# c - C 动态字符串长度

> ID：671593
> 
> 赞同：5
> 
> 时间：2009-03-22T20:48:00.803
> 
> 标签：c, string, dynamic

在 C 中创建动态字符串有不同的方法（长度不断变化）。经过一些谷歌搜索，这样做的主要方法是使用[realloc()](http://opengroup.org/onlinepubs/007908775/xsh/realloc.html)。

我实现这一点的一种方法是为每个节点使用带有 32 字节块的链表。

我想知道除了使用 realloc() 和链表之外是否有更好的方法来解决这个问题，以及每种方法的优缺点是什么。

**编辑**我这样做的原因是因为我从套接字*recv()*接收动态数据，并且正在寻找一种灵活的存储方式，而不分配大量不需要的数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-22T20:52:28.280

您可以重新分配到不同的预定义大小。例如，当缓冲区已满时，将其大小加倍。

使用链表是个好主意，但数据不是连续的（`printf`例如，您不能将整个结构传递给 ）并且索引需要更多计算（O(N)）。一个主要优点是附加字符串（在任一端）是 O(1)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T21:12:20.543

我认为您正在寻找[Scatter-Gather I/O](http://en.wikipedia.org/wiki/Vectored_I/O)，您要寻找的功能是[readv()](http://www.opengroup.org/onlinepubs/009695399/functions/readv.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-22T21:23:27.957

使用 32 字节块意味着数据和开销之间的比率很糟糕 - 您的指针在链表中，并且至少（可能更多）来自内存分配器。我强烈建议分配更大的内存块并以指数方式增长以适应并查看这是否会导致问题。只有遇到问题我才会走链表路线。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-22T21:17:08.050

如果你确实使用 realloc()，不要在每个 realloc 上添加固定数量的空间，因为这样生成长度为 n 的字符串的成本将是 O(n^2)（realloc 可能会分配一个新区域并且在那里复制数据，即它的复杂性不是恒定的，而是 O(n))。最简单的方法是在每个 realloc 上将缓冲区大小加倍，然后摊销成本仍然是 O(n)。

# asp.net - 级联下拉列表

> ID：671598
> 
> 赞同：0
> 
> 时间：2009-03-22T20:53:40.557
> 
> 标签：asp.net, asp.net-ajax

我在我的页面上使用了许多下拉列表，并且我正在将我的项目从 .net 2003 迁移到 .net 2008。我想 Ajaxify 我的页面，使用级联下拉列表是否合乎逻辑？级联下拉列表会带来任何意外问题吗？顺便说一句，如果我使用 Cascading Dropdownlist，我使用 pagemethods，而不是 webservices？Pagemethods 有什么问题吗？或者你有什么建议而不是 Cascading Dropdownlist？我不想使用 3.party 组件，感谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T23:55:47.857

ASP.NET AJAX 工具包没有任何问题。有用。如果您不在另一个页面上使用相同的下拉菜单，那么使用 pagemethod 它们会容易得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T00:15:02.117

对于级联下拉列表，我唯一可以说的是，如果它们调用的 WebMethod 出现问题，它们会更难调试，因为它们只会返回神秘的错误消息。但是，一旦您意识到这就是正在发生的事情，这是修复它的一个非常快速的步骤。

否则，它们工作得很好，并节省了大量的管道代码来启用/禁用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-06T07:14:29.340

```
@using (Html.BeginForm("Index", "Home", new { ReturnUrl = ViewBag.ReturnUrl }, FormMethod.Post, new { id = "LoginForm", autocomplete = "off" })) 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2018-04-06T06:19:38.860

```
routes:
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Web.Routing;

namespace PrivateExchange
{
    public class RouteConfig
    {
        public static void RegisterRoutes(RouteCollection routes)
        {
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
            routes.MapRoute(
                name: "MediaResourcePopup",
                url: "Home/MediaResourcePopup/{wid}/{uiconf_id}/{cache_st}/{entry_id}/{targetId}",
                defaults: new
                {
                    controller = "Home",
                    action = "MediaResourcePopup"
                });

            //routes.MapRoute(
            //name: "BridgeFront",
            //url: "{BridgeFront}/{LaunchBridgeFront}/{user}",
            //defaults: new { controller = "BridgeFront", action = "LaunchBridgeFront", user = "keenan" }
            //);

            routes.MapRoute(
               name: "Message",
               url: "Message/{action}/{id}",
               defaults: new { controller = "Message", action = "Index", id = UrlParameter.Optional }
           );
            routes.MapRoute(
                name: "Plan",
                url: "Plan/{action}/{id}",
                defaults: new { controller = "Plan", action = "Index", id = UrlParameter.Optional }
            );

            routes.MapRoute(
                name: "Enrollment",
                url: "Enrollment/{action}/{id}/{memberCodes}",
                defaults: new { controller = "Enrollment", action = "Index", id = UrlParameter.Optional, memberCodes = UrlParameter.Optional }
            );

            routes.MapRoute(
                name: "UserManagement",
                url: "UserManagement/{action}/{id}",
                defaults: new { controller = "UserManagement", action = "Index", id = UrlParameter.Optional }
            );

            routes.MapRoute(
                name: "Employee",
                url: "Employee/{action}/{id}",
                defaults: new { controller = "Employee", action = "Index", id = UrlParameter.Optional }
            );

            routes.MapRoute(
                name: "Dependent",
                url: "Dependent/{action}/{id}",
                defaults: new { controller = "Dependent", action = "List", id = UrlParameter.Optional }
            );
            routes.MapRoute(
                name: "DecisionSupport",
                url: "DecisionSupport/{action}/{id}",
                defaults: new { controller = "DecisionSupport", action = "Index", id = UrlParameter.Optional }
            );
            routes.MapRoute(
                name: "Package",
                url: "Package/{action}/{id}",
                defaults: new { controller = "Package", action = "List", id = UrlParameter.Optional }
            );

            routes.MapRoute(
                name: "Home",
                url: "Home/{action}/{id}",
                defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional,type=UrlParameter.Optional }
            );

            routes.MapRoute(
               name: "KCaresHome",
               url: "Home/{action}",
               defaults: new { controller = "Home", action = "Login", type = UrlParameter.Optional }
           );

            routes.MapRoute(
                name: "Root",
                url: "{id}",
                defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
            );
            routes.MapRoute(
                name: "Default",
                url: "{controller}/{action}/{id}",
                defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
            );

            routes.MapRoute(
                name : "SSO",
                url : "SSO/SSO/{id}",
                defaults: new { controller = "SSO", action = "SSO" }
                );

            routes.MapRoute(
                name: "Upload",
                url: "Upload/{action}/{id}",
                defaults: new { controller = "Upload", action = "Index", id = UrlParameter.Optional }
            );

 1\. List item

enter code here
        }

} 
```

# web2py - 无法解压缩 web2py_win.zip。WINZIP 说它是无效的 zip 格式

> ID：671600
> 
> 赞同：0
> 
> 时间：2009-03-22T20:56:27.100
> 
> 标签：web2py

WINZIP 12.0 和 WINRAR 都无法打开 web2py_win.zip 1.59 版他们都说 zip 格式无效。

请告知该怎么做。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T20:59:26.877

[获得 7-Zip](http://www.7-zip.org/)它可以处理任何事情。[我刚刚从这里](http://www.web2py.com/examples/default/download)下载了 web2py_win.zip并且使用普通的 ol XP 将其作为压缩文件夹打开没有问题。我认为您应该重新尝试下载/打赌它被中断了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T21:02:50.613

我有时会注意到服务器在下载过程中断开连接或在下载文件时发送错误的内容长度标头，而我只得到文件的一部分。所以尝试重新下载或从其他来源下载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T21:31:25.193

如果您通过 FTP 下载，请确保以二进制模式进行下载，而不是 Ascii...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-01T06:06:34.780

[当前版本（1.66.2）似乎工作](http://www.web2py.com/examples/static/web2py_win.zip)

# multithreading - 多线程或多处理

> ID：671607
> 
> 赞同：8
> 
> 时间：2009-03-22T21:01:09.960
> 
> 标签：multithreading, multiprocessing

我正在为 Linux 设计一个专用的系统日志处理守护进程，它需要强大且可扩展，并且我正在讨论多线程与多进程。

多线程的明显反对意见是复杂性和讨厌的错误。由于 IPC 通信和上下文切换，多进程可能会影响性能。

“Unix 编程的艺术”在[这里](http://www.faqs.org/docs/artu/ch07s03.html#id2923889)讨论了这一点。

您会推荐基于进程的系统（如 Apache）还是多线程方法？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-24T22:28:28.813

它们都可以以自己的方式变得复杂和复杂。

你可以做任何一个。从宏观上看，你选择哪一个可能并不重要。重要的是你做得如何。所以：

做你最有经验的事情。或者，如果你领导一个团队，那就做团队最有经验的事情。

---穿线！---

我做过很多线程编程，我喜欢其中的一部分，也有一部分我不喜欢。我学到了很多东西，现在通常可以编写一个多线程应用程序而不会太痛苦，但它确实必须以非常具体的方式编写。即：

1) 它必须用非常明确定义的数据边界来编写，这些边界是 100% 线程安全的。否则，任何可能发生的情况都会发生，而且当你有一个调试器时，它可能不会发生。另外，调试线程代码就像窥视薛定谔的盒子……通过查看那里，其他线程可能有也可能没有有时间处理更多。

2) 它必须用对机器施加压力的测试代码编写。许多多线程系统仅在机器承受很大压力时才显示它们的错误。

3）必须有一些非常聪明的人拥有数据交换代码。如果有任何方法可以创建快捷方式，一些开发人员可能会创建它，并且您将遇到错误的错误。

4) 必须有包罗万象的情况，以最少的麻烦重置应用程序。这是针对由于某些线程问题而中断的生产代码。简而言之：演出必须继续。

- -跨进程！ - -

我对基于进程的线程的经验较少，但最近一直在 Windows 中做一些跨进程的东西（其中 IPC 是 Web 服务调用...... WOO！），它相对干净和简单，但我遵循一些规则这里也是。总的来说，进程间通信将不会出错，因为程序可以很好地接收来自外部世界的输入……而且这些传输机制通常是异步的。反正...

1) 定义清晰的流程边界和沟通机制。通过 TCP 或 Web 服务或管道或任何其他方式的消息/事件，只要边界清晰，并且在这些边界处有大量验证和错误检查代码。

2) 为瓶颈做好准备。代码宽恕非常重要。我的意思是，有时您将无法写入该管道。您必须能够重新排队并重试这些消息，而应用程序不会锁定/抛出异常。

3) 通常会有更多的代码，因为跨进程边界传输数据意味着您必须以某种方式对其进行序列化。这可能是问题的根源，尤其是当您开始维护和更改该代码时。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-22T22:31:53.470

你遗漏了太多细节。实际上，就您已经说过的内容而言，选择是无关紧要的，多线程本质上没有什么比多处理更容易出错的了；你错过了为什么这些技术有这样的声誉。如果您不共享数据，那么不会有太大问题（当然，可能还有一些其他问题，但我们需要详细信息来决定这些问题）。此外，在什么平台上，在像 UNIX 这样的操作系统上，进程是非常轻量级的也很重要。

但是，还有其他问题需要考虑吗？您将在什么样的系统上运行？您绝对不想在单处理器系统上生成多个进程，因为您不会获得太多好处，这取决于您可以指定的其他一些细节。如果您描述了您要解决的问题的性质，我们可以提供进一步的帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-22T21:07:59.850

取决于您要使用的编程语言（以及哪些库）。我个人会选择多线程，因为我知道与线程相关的问题（以及如何解决它们）。

如果您想在多台机器上运行守护程序并在它们之间分配负载，多处理可能会对您有所帮助，但我认为这不是一个主要问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T22:06:05.717

如果您想要稳健性，请使用多处理。

这些进程将在它们之间共享日志记录负载。迟早，日志记录请求会遇到错误并使记录器崩溃。使用多处理，您只会丢失一个进程，因此只会丢失一个日志记录请求（由于错误，您无论如何都无法处理）。

多线程很容易崩溃，因为一个致命的错误会破坏您的单个进程。

多处理在某些方面在技术上更具挑战性，因为您必须在进程之间平衡工作负载，这可能需要使用共享内存。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-22T21:11:00.373

您是否需要在更新频繁且 IPC 过于昂贵的实例之间共享更新数据？在这种情况下，多线程可能会更好。否则，您必须权衡单独进程的健壮性或线程创建/通信的简易性对您来说是否更重要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-28T18:19:08.117

感谢大家的反馈。

我决定采用类似于 Apache Web 服务器的多进程架构。这些过程将在多处理器/核心系统上很好地扩展。将使用管道或套接字进行通信。

进程将准备好在进程池中使用，因此没有进程生成成本。

与我将获得的稳健性相比，性能损失可以忽略不计。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T22:17:24.410

一个问题是是否有必要这样做。我不知道您的要求的详细信息，但是使用单线程应用程序`select(2)`可能适合您的需求，并且没有进程或线程的缺点。这要求您能够将所有 I/O 集中到一个中心位置，最有可能通过回调分派到其他模块，但这并不难，除非您有很多库想要自己做 I /O 并且不能以这种方式重组。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-02T12:47:06.837

好吧，我们最终将它实现为一个多进程系统，其中包含用于 IPC 的管道和一个根据需要生成进程的簿记员。类似于 Apache httpd。它完美地工作。

# haskell - Haskell：如何将一个句柄的内容实时传送到另一个句柄

> ID：671610
> 
> 赞同：5
> 
> 时间：2009-03-22T21:02:25.870
> 
> 标签：haskell, io, monads

我正在编写一个以交互方式运行外部子进程的程序，我需要输出句柄的内容在可用时立即输出到标准输出。我尝试过这样的事情：

```
main = do processInfo <- createProcess (proc "ghci" []){std_out = CreatePipe,
                                                    std_in  = CreatePipe }
       case processInfo of
          (Just hIn, Just hOut, _, _) -> do mainloop hIn hOut
                                          hClose hIn
                                          hClose hOut
       _                              -> do error "Unable to start process"

mainloop :: Handle -> Handle -> IO ()
mainloop inh outh = 
    do ineof <- hIsEOF outh
       if ineof
          then return ()
          else do inpStr <- hGetLine outh
                  putStrLn inpStr
                  mainloop inh outh 
```

但这不起作用，因为它只能逐行识别输出，因此进程输出句柄上的任何未由换行符终止的输出都不会显示。我用 hGetContents 尝试过同样的事情，但它产生了相同的结果。我已经阅读了 System.Process 和 System.IO 的文档，并没有真正找到任何结论。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T03:48:12.050

`hSetBuffering`是你要找的，默认（至少在 Unix 上）是行缓冲。在启动主循环之前在标准输入上使用它

```
hSetBuffering hIn NoBuffering 
```

如果您想立即在输出端查看结果，还可以选择在输出句柄上。但是请注意，禁用缓冲会大大降低性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T23:06:22.873

我是一个 Haskell 新手，但我记得最近遇到过一个按字符处理输入的示例。hSetBuffering[可能](http://www.zvon.org/other/haskell/Outputio/hSetBuffering_f.html)是您正在寻找的吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-25T05:26:16.177

缓冲是一回事，但您也在使用`gGetLine`它将等待整行（或文件结尾）。`hGetChar`如果您当时真的想阅读一个字符，请考虑使用。顺便说一句，克服缓冲的另一种方法是使用`hFlush`.

# java - 如何从 J2EE Web 应用程序中的用户输入中删除预定义字符？

> ID：671613
> 
> 赞同：1
> 
> 时间：2009-03-22T21:04:52.760
> 
> 标签：java, web-applications, servlet-filters

我们有一个使用 Spring MVC 的 J2EE Web 应用程序。我们对 Web 应用程序有一个新要求，我们必须从用户输入中删除某些预定义字符。例如，假设应用程序应该从所有用户输入中删除“<”。我想出了两种方法来满足这个要求：

1.  JSP 级别：识别每个允许用户输入的 jsp，然后通过客户端处理删除字符。

2.  Servlet Filter ：使用过滤器并拦截请求对象。在这里，我可以使用以下两种方法中的一种：

    2.1：重写request.getParameter方法，在里面写字符移除逻辑。每当调用此方法时，它都会返回过滤后的结果。

    2.2：在过滤级别，扫描参数图，过滤需要的字符。然后编写一个 setParameter 方法并在请求参数映射中设置新值。

您建议采用哪种方法？过滤器对性能有影响吗？如果您能想到更好的方法，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T21:09:55.307

如果您愿意，您可以进行客户端过滤，但**您绝对不应该依赖它。**客户端可以关闭 Javascript。他们也可以发布他们喜欢的内容。客户端验证很方便。它不能替代服务器端验证。

至于使用 servlet 过滤器，我不确定我是否是它的忠实粉丝。看起来（我在这里可能是错的）你试图保护自己免受懒惰、健忘或只是简单无能的开发人员的伤害。

此外，如果您在任何时候都允许使用 HTML（就像这个网站一样），那么您就不能将这种事情作为通用规则。这种事情应该在你进行所有其他验证的地方处理。如果您真的担心它，请围绕它进行单元测试。

Servlet 过滤器似乎很笨拙，并且可能对此有问题。

您正在使用 Spring MVC。您是否在 Spring 的验证器后面使用任何特定的验证框架？无论如何，恕我直言，这是处理此类问题且易于单元测试的正确位置[原文如此]。

我认为这是处理这类事情的正确点。

话虽如此，如果您真的倾向于这种方法，我看不出有任何技术原因为什么您不能在 servlet 过滤器中使用 setParameter 执行此操作。我当然会在 servlet 请求上覆盖 setParameter 。你能做到吗？即使你可以我也不会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T21:36:44.557

我会把问题转到面子上。问题是用户在字段中输入 < 之类的字符，还是当您在网页上再次打印它们时没有转义它们？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T21:11:56.923

我建议您为此使用正则表达式。

至于放在哪里，听起来像是业务逻辑，所以servlet过滤器或jsp级别听起来不是一个好主意。

是的，它会损害性能，但不会引起注意或关键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-22T16:45:55.343

我刚刚阅读了另一篇 StackOverflow 文章，它可能对使用 Servlet 过滤器有所帮助：

[使用 Servlet 过滤器修改请求参数](https://stackoverflow.com/questions/1413129/modify-request-parameter-with-servlet-filter)

如果您可以使一个足够通用的过滤器来根据您的需要清理数据，那么使用 servlet 过滤器似乎是合理的。

# vb.net - VB.NET 有匿名函数吗？

> ID：671631
> 
> 赞同：15
> 
> 时间：2009-03-22T21:19:59.807
> 
> 标签：vb.net, anonymous-methods

从我在 google 上可以找到的内容来看，VB.NET 只有一个语句 lambda，而不是多语句匿名函数。但是，我阅读的所有文章都在谈论旧版本的 VB.NET，我找不到比 vs2008 beta 1 或 2 更新的任何东西。

所以问题是：我如何在 VB.NET 中做到这一点？

C#代码：

```
private void HandleErrors( Action codeBlock ){
    try{
        codeBlock();
    }catch(Exception e){
        //log exception, etc
    }
}

HandleErrors(() => {
    var x = foo();
    x.DoStuff();
    etc
}); 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2011-05-22T23:44:54.923

它在 VB10 中：

```
Dim food = New With {
    .ID = 1,
    .Name = "Carrot",
    .Type = (
        Function(name As String)
            If String.IsNullOrEmpty(name) Then Return String.Empty

            Select Case name.ToLower()
                Case "apple", "tomato": Return "Fruit"
                Case "potato": Return "Vegetable"
            End Select

            Return "Meat"
        End Function
    )(.Name)
}
Dim type = food.Type 
```

或者，对应于您的代码：

```
Sub HandleErrors(codeBlock As Action)
    Try
        codeBlock()
    Catch e As Exception
        ' log exception, etc.
    End Try
End Sub

HandleErrors(Sub()
        Dim x = foo()
        x.DoStuff()
        ' etc.
    End Sub) 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-22T21:25:42.210

Visual Basic .NET 只有 lambda 表达式。

它在当前版本中不支持“匿名代表”，但在 VS2010 中它会（并且在多行上）。

现在唯一的选择是在某处声明您的方法并使用 Addressof 运算符传递它。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-22T21:25:33.957

VB9 只有单行匿名函数。我们在 VB10 中添加了完整的语句和多行 lambda。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-26T10:24:23.480

在此示例中，我有一个操作列表，但只想从 ID 匹配的（T）列表中找到一个：

```
Return operations.Find(Function(p) p.OperationID = operationID) 
```

operationID 是传入方法的局部变量，而 operations 是通用列表。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-06-20T13:10:10.597

Anonymous 不是委托或函数，它是一种强大的动态类型

你可以使用泛型函数

```
Sub Main()
      Dim PersonDynamicType = AnonyFunc(New With {.Name = "david", .Family = "Fisher"})
      Console.Write(PersonDynamicType.Name)
End Sub

Function AnonyFunc(Of t)(v As t) As t
      Return v
End Function 
```

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2012-02-06T14:05:07.270

这是不准确的。VB.NET 实际上确实有匿名方法。这是一个例子：

```
Private Function JsonToObject(Of T)(Value As String) As T
    Dim JavaScriptSerializer As New System.Web.Script.Serialization.JavaScriptSerializer()
    Return JavaScriptSerializer.Deserialize(Of T)(Value)
End Function

Dim People As Generic.List(Of Person) = JsonToObject(Of Generic.List(Of Person))(Json) 
```

# delphi - 有没有人用 Delphi 来编程 VST 的？

> ID：671636
> 
> 赞同：9
> 
> 时间：2009-03-22T21:25:23.460
> 
> 标签：delphi, vst

有没有人使用 Delphi 来编写 Virtual Studio Technology 插件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-23T10:18:25.223

是的，使用 Christian Budde 的 ASIO 和 VST 框架，这可能是进入 Delphi 的最简单方法，可在此处获得[http://sourceforge.net/projects/delphiasiovst/](http://sourceforge.net/projects/delphiasiovst/)。

他有很多真实的例子（即不仅仅是简单的，最小的延迟），在 KVR 的开发者论坛上（[http://www.kvraudio.com/forum/viewforum.php?f=33](http://www.kvraudio.com/forum/viewforum.php?f=33)）你会发现一个使用它并讨论它的人数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T04:53:48.420

好吧，我没有，但是有[Delphi VST SDK](http://www.axiworld.be/vst.html)，所以我认为至少 Frederic Vanmol 有。也有样品，所以这对你来说应该是一个很好的起点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-02T08:49:39.373

是的。有几个人使用 Delphi 发布了商业和免费的 VST 插件。Delphi 制作的插件的一些例子是[Glitch](http://illformed.org/plugins/glitch/)、[Poise](http://www.onesmallclue.com/poise.php)和[Jamstix](http://www.rayzoon.com/)

当开始在 Delphi 中投影 VST 插件时，这些链接可能很有用

*   [Tobybear 的 Delphi VST 模板](http://www.tobybear.de/d_template.html)
*   [德尔福 ASIO 和 VST 软件包](http://sourceforge.net/projects/delphiasiovst/)
*   Frederic Vanmol[对 VST SDK 的 Delphi 翻译](http://www.axiworld.be/vst.html)

# c++ - 使用 getchar() 和 -O3 的奇怪行为

> ID：671639
> 
> 赞同：0
> 
> 时间：2009-03-22T21:27:29.227
> 
> 标签：c++, c, getchar

我有这两个功能

```
 void set_dram_channel_width(int channel_width){
      printf("one\n");
          getchar();
    }

    void set_dram_transaction_granularity(int cacheline_size){
      printf("two\n");
          getchar();
    }
    //output:
    one
    f //my keyboard input
    two
    one
    f  //keyboard input
    two
    one
    f  //keyboard input
    //No more calls 
```

然后我将功能更改为：

```
 void set_dram_channel_width(int channel_width){
      printf("one\n");
    }

    void set_dram_transaction_granularity(int cacheline_size){
      printf("two\n");
      getchar();
    }
    //output
    one
    two 
    f //keyboard input
    //No more calls 
```

这两个函数都由外部代码调用，两个程序的代码是相同的，只是更改 getchar() 我得到了这两个不同的输出。这是可能的还是我的代码中确实有问题？

谢谢

这是我使用 GDB 得到的输出**

*对于第一个代码*

```
(gdb) break mem-dram.c:374
Breakpoint 1 at 0x71c810: file build/ALPHA_FS/mem/dramsim/mem-dram.c, line 374.
(gdb) break mem-dram.c:381
Breakpoint 2 at 0x71c7b0: file build/ALPHA_FS/mem/dramsim/mem-dram.c, line 381.
(gdb) run -d ./tmp/MyBench2/ 
one
f
[Switching to Thread 47368811512112 (LWP 17507)]

Breakpoint 1, set_dram_channel_width (channel_width=64)
(gdb) c
Continuing.
two
one
f

Breakpoint 2, set_dram_transaction_granularity (cacheline_size=64)
(gdb) c
Continuing.

Breakpoint 1, set_dram_channel_width (channel_width=8)
374     void set_dram_channel_width(int channel_width){
(gdb) c
Continuing.
two
one
f 
```

*对于第二个代码*

```
(gdb) break mem-dram.c:374
Breakpoint 1 at 0x71c7b6: file build/ALPHA_FS/mem/dramsim/mem-dram.c, line 374.
(gdb) break mem-dram.c:380
Breakpoint 2 at 0x71c7f0: file build/ALPHA_FS/mem/dramsim/mem-dram.c, line 380.
(gdb) run
one
two
f
[Switching to Thread 46985688772912 (LWP 17801)]

Breakpoint 1, set_dram_channel_width (channel_width=64)
(gdb) c
Continuing.

Breakpoint 2, set_dram_transaction_granularity (cacheline_size=64)
(gdb) c
Continuing.

Breakpoint 1, set_dram_channel_width (channel_width=8)
(gdb) c
Continuing. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-22T21:46:55.670

由于您还没有提供外部代码（还没有？），这里有一个猜测。

```
while(some condition) {
    foo1();
    foo2();
} 
```

*   foo1 打印 ' `one`' 然后等待一些输入。你输入' `f[enter]`'。
*   foo1 消耗“ `f`”。
*   foo2 打印 'two' 然后使用`[enter]`（换行符）。
*   然后你回到开始，这一切又发生了。

在您的第二个版本中， foo1() 不再读取任何内容。

所以：

*   foo1 打印 ' `one`'
*   foo2 打印 ' `two`' 然后等待一些输入。你输入' `f[enter]`'
*   foo2 消耗 ' `f`'

剩下的唯一问题是为什么它会停止。为了帮助你，我们必须看看到底`(some condition)`是什么。

请注意，在`getchar()`不保留结果的情况下调用是相当不寻常的（如 中所示`c = getchar();`）。你有这样做的理由吗？

一个有用的 C 习惯用法是：

```
(void) getchar(); 
```

强制转换为 void 表明程序员知道他们正在丢弃返回值。

# file - 如何比较批处理文件中的两个文件？

> ID：671642
> 
> 赞同：17
> 
> 时间：2009-03-22T21:30:33.353
> 
> 标签：file, comparison, batch-file, if-statement

如何比较批处理文件中的两个文件，并根据它们是否匹配执行操作？我试过类似的东西：

```
if file1.txt NEQ file2.txt goto label 
```

但它比较的是实际字符串“file1.txt”而不是文件。我已经阅读了 COMP 命令，但如果我将它放在 if 语句中，它似乎不起作用。有人知道怎么做这个吗？抱歉，但我很少使用批处理文件，并且对它们没有什么经验。

提前致谢。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-22T21:35:40.377

我相信您可以使用“FC”命令然后检查错误级别。这是一些代码：

```
@echo off
:main
fc c:\filename r:\filemame > nul
if errorlevel 1 goto error

:next
echo insert next CD
pause
goto main

:error
echo failed check 
```

（来自[http://www.computing.net/answers/dos/batch-file-command/15753.html](http://www.computing.net/answers/dos/batch-file-command/15753.html)）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-22T21:32:39.510

看起来 COMP 程序实际上相当容易使用。在雅虎答案上看到[这个问题。](http://answers.yahoo.com/question/index?qid=20080827151752AARwoYC)

请注意，运行`comp /?`将打印程序的帮助文本（`/?`与使用任何本机 Windows 命令行程序指定参数一样）。这会输出您在上面链接的问题的答案中看到的相同文本。

来自雅虎答案的内容：

```
C:\>comp /? 
Compares the contents of two files or sets of files. 

COMP [data1] [data2] [/D] [/A] [/L] [/N=number] [/C] [/OFF[LINE]] 

data1 Specifies location and name(s) of first file(s) to compare. 
data2 Specifies location and name(s) of second files to compare. 
/D Displays differences in decimal format. 
/A Displays differences in ASCII characters. 
/L Displays line numbers for differences. 
/N=number Compares only the first specified number of lines in each file. 
/C Disregards case of ASCII letters when comparing files. 
/OFF[LINE] Do not skip files with offline attribute set. 

To compare sets of files, use wildcards in data1 and data2 parameters. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-05T23:18:34.617

我使用以下示例根据文件差异构建报告：

```
set %Batch_Work_Space_Dir%=folder for your batch file and temp resource files
set file_1=name of file
set file_2=name of file

fc %file_1% %file_1%t > %Batch_Work_Space_Dir%\Are_They_Different.txt

powershell -command "(Get-Content %Batch_Work_Space_Dir%\Are_They_Different.txt) | select -skip 1 | Set-Content %Batch_Work_Space_Dir%\Are_They_Different.txt"
set /p Diff_Found=<%Batch_Work_Space_Dir%\Are_They_Different.txt
if %Diff_Found:~0,17%" == "FC: no difference" (
  execute commands
 ) 
```

# java - 为添加实例初始化块而创建的匿名类的意外后果

> ID：671644
> 
> 赞同：4
> 
> 时间：2009-03-22T21:31:37.437
> 
> 标签：java, anonymous-class

这是一个关于 Java 代码的问题，例如：

```
List<String> list = new ArrayList<String>() {{add("hello"); add("goodbye");}} 
```

程序员匿名扩展 ArrayList 只是为了插入实例初始化块。

问题是：如果程序员的唯一目的仅仅是为了达到以下目的：

```
List<String> list = new ArrayList<String>();
list.add("hello");
list.add("goodbye"); 
```

那么第一种方式的意外后果是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-22T21:40:43.843

执行此类代码（在一般情况下）的危险在于您可能会破坏`equals()`方法。那是因为有两个通用模板`equals()`：

```
public boolean equals(Object ob) {
  if (!(ob instanceof MyClass)) return false;
  ...
} 
```

和

```
public boolean equals(Object ob) {
  if (ob.getClass() != getClass()) return false;
  ...
} 
```

第一个仍然适用于您正在谈论的匿名子类，但第二个不会。事实是，第二个被认为是最佳实践，因为 instanceof 不一定是**可交换**的（意思`a.equals(b)`可能不等于`b.equals(a)`）。

但是，在这种情况下，特别是`ArrayList`使用`AbstractList.equals()`仅检查另一个对象是否为`instanceof`interface的方法`List`，所以你很好。

然而，这是需要注意的。

我的建议是稍微不同：

```
List<String> list = new ArrayList<String>(
    Arrays.asList("hello", "goodbye")
); 
```

当然它更罗嗦，但你不太可能以这种方式遇到麻烦，因为结果类是“纯”的`ArrayList`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T09:03:13.890

我认为这里的大问题是您正在创建周围类的内部类。您创建的列表将隐含*this*对外部类的引用。

这通常不是问题。但是，如果你序列化这个对象（我特别想使用[XStream](http://xstream.codehaus.org/)，因为我自己也遇到过），那么序列化的表单将包含序列化的外部类。这根本不是您通常所期望的，并且可能导致异常行为！

我经常使用上述初始化模式。只要您了解内部类机制，就不是问题。顺便提一句。我不认为平等问题是超越一般派生平等实现的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T10:32:35.720

对代码性能和/或内存的影响可以忽略不计（即使是可测量的）。

这里真正的打击是你让人们停下来，即使是一拍，思考“这家伙在做什么？”

如果我在阅读您的代码时必须这样做 1,000 次，则存在性能问题。

代码应该易于阅读——只要满足所有性能、完整性和标准要求。

您很可能会成为维护代码的人。善待未来的自己，让代码尽可能容易阅读。如果你要做一些像这样花哨的东西，有充分的理由并在代码中记录它。如果唯一的原因是为了炫耀你作为程序员的能力，那么你在程序员的真正工作上就失败了：让困难变得简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T22:23:41.697

第一种方法对性能也不利。大量匿名类使内存混乱是不好的。启动时也会变慢。

# agile - 敏捷是否经过科学证明？

> ID：671656
> 
> 赞同：18
> 
> 时间：2009-03-22T21:43:24.197
> 
> 标签：agile, methodology

是否有任何科学研究将敏捷与其他软件开发方法进行了比较？我认为敏捷是一种很好的工作方式，但它有什么科学依据吗？

我正在寻找类似的东西，除了[这项](http://www.infoq.com/news/2009/03/TDD-Improves-Quality)研究只涉及 TDD。有没有关于敏捷的研究？

我问这个是因为我遇到了一个敏捷狂热者，他声称敏捷工作方式比所有其他工作方式产生的软件更好。他提出这是一个事实，我不认为这是事实。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-22T22:10:29.403

科学的？嗯，我对 Alistair Cockburn 的工作印象深刻。[在这里](http://itc.conversationsnetwork.org/shows/detail175.html)听他说

> 当 IBM 要求他为面向对象项目编写方法论时，Alistair Cockburn 已经做了 16 年的硬件设计师和研究人员。**在过去的十年里，他一直在研究和撰写有关软件开发的文章，并了解到一些最成功的项目都有最简单的流程。**2001 年，他和其他 16 位软件开发重量级人物开会讨论所谓的轻量级方法，其中一个成果是敏捷软件开发宣言，其中包括四个价值声明：个人和交互优于流程和工具；工作软件优于综合文档；合同谈判中的客户协作；并响应变化而不是遵循计划。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-11-16T21:19:20.733

**Scrum 的某些方面有支持性的经验证据。**已经对 Scrum 的不同部分进行了大量的实证研究。我听说 Jeff Sutherland（[http://jeffsutherland.com/scrum/](http://jeffsutherland.com/scrum/) scrum 的发明者）在他的演讲中提到了很多具体的研究和观察。

一般来说，敏捷只是一个总称，旨在让不同的政治团体保持适度的快乐。**不要期望看到实验证明所有“敏捷”的一般性。它太模糊了，没有用。**

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-22T21:46:01.553

[来自 NCSU 的 Laurie Williams](http://collaboration.csc.ncsu.edu/laurie/)发表了很多关于结对编程有效性的非常有趣的研究，然后开始处理敏捷的更多方面。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-02-27T00:03:26.027

[本文](http://davidfrico.com/rico08b.pdf)分析了敏捷与传统方法的投资回报率 (ROI)。它基于已发表研究的实际结果。

从摘要：

> 敏捷方法的投资回报率是昂贵的传统方法的四倍，比廉价的方法低两倍，最好的敏捷方法和传统方法的投资回报率相同。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-17T04:17:26.893

不，它没有经过科学或其他方式的证明。要“证明”它意味着：

*   从分析的角度证明其有效性。
*   证明它在实践中有效，然后推断其有效性

分析方法是不可行的，因为我们在这里处理的是人而不是简单的系统。你不能将团队和组织正式化。

另一方面，已经进行了实证研究，但结果尚无定论。例如，Robert Glass 在他的《软件创意 2.0》一书中展示了一些有趣的结果。

所以不，敏捷没有得到证明。差远了。:-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-16T21:26:18.473

我认为不可能“证明”这样的事情。

我会更进一步，并说我认为通过这样的研究来研究“软件开发生产力”问题是不可能的。这主要是为什么我们所有的证据**真的**必须继续的所有证据都是有经验的人告诉我们的（不幸的是，每个人对各种方法都有不同的看法）。

原因很简单：人与人是完全不同的。坐下一个由 5 人组成的团队进行几个月的项目（我猜，这比大多数研究所能管理的要多；让我们看看有人资助几个月的开发时间），你一定会完全得到不同的结果。问题是，这里没有办法区分许多不同的因素：

1.  个人程序员的能力。
2.  程序员的奉献精神/努力。
3.  使用工具的经验。
4.  担任团队领导者的能力（仅仅遵循一种方法是不够的。如果有人不知道如何管理团队，那么方法就不会真正得到很好的体现）。

而且可能还有更多的因素。

所以我想说的是，不要相信那些“证明”一种方法/工具/任何东西比其他方法更好的研究。他们几乎不可能做到。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-16T22:04:48.990

向我证明的是瀑布的统计失败，即应用于软件开发的[科学管理。](http://en.wikipedia.org/wiki/Scientific_management)敏捷，作为一种运动，只是对这一经验证据的一种回答（例如参见 CHAOS 报告）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-26T23:19:18.643

InfoQ 对 Linda Rising的[采访在](http://www.infoq.com/interviews/rising-on-placebos)一定程度上解决了你的问题。她谈到了安慰剂的有效性和我们对医学的信念，以及这些相同的事情如何与软件开发相关。基本上，我们在敏捷社区中是否给自己一个“糖丸”？

**采访摘录**

> 科学是关于实验的，关于在短时间内持有一个想法并对其进行测试，然后检查该测试的结果以找出该假设是否成立。这就是敏捷的真正意义所在。敏捷是关于小实验。我现在相信我们所做的一切，不仅仅是软件开发，我们的生活应该是一系列的小实验。
> 
> 我们引入每一个可能的利益相关者，我们引入客户，我们引入用户，测试人员与开发人员一起工作。我们一直在仔细检查那些糖丸。它真的有效吗？你怎么看？你对结果满意吗？那是唯一能拯救我们的东西——敏捷本身。这一系列的小实验。

# c++ - Windows Mobile 命令行编译器

> ID：671657
> 
> 赞同：1
> 
> 时间：2009-03-22T21:43:48.720
> 
> 标签：c++, windows-mobile

针对 Windows Mobile 的 C/C++ 程序的命令行编译器的名称是什么？

我安装了 Visual Studio 2008 Professional，我需要能够从命令行编译程序。我检查了 Visual Studio 中的项目属性，它显示了所有传递给编译器的参数，但它没有显示编译器本身的名称。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T22:01:09.223

命令行 C++ 编译器的名称是 cl.exe

windows ce 的可执行文件通常位于

> %ProgramFiles%\Microsoft Visual Studio 9.0\VC\ce\bin\x86_arm\cl.exe

x86_arm 可以根据特定的架构替换为 x86_mips 或 x86_sh。

以下是有关 Windows CE/移动命令行编译器的更多信息：http: [//msdn.microsoft.com/en-us/library/aa448630.aspx](http://msdn.microsoft.com/en-us/library/aa448630.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-22T22:09:14.260

JaredPar 有关于 的实际位置的答案`cl.exe`，但根据您需要做什么，您可能需要考虑从命令行调用 devenv -

```
Microsoft (R) Visual Studio Version 9.0.21022.8.
Copyright (C) Microsoft Corp. All rights reserved.

Use:
devenv  [solutionfile | projectfile | anyfile.ext]  [switches]

The first argument for devenv is usually a solution file or project file.
You can also use any other file as the first argument if you want to have the
file open automatically in an editor. When you enter a project file, the IDE
looks for an .sln file with the same base name as the project file in the
parent directory for the project file. If no such .sln file exists, then the
IDE looks for a single .sln file that references the project. If no such single
.sln file exists, then the IDE creates an unsaved solution with a default .sln
file name that has the same base name as the project file.

Command line builds:
devenv solutionfile.sln /build [ solutionconfig ] [ /project projectnameorfile [     /projectconfig name ] ]

etc... 
```

这给您带来的潜在优势是您可以从命令行驱动编译，但它将使用项目/解决方案中定义的设置。这样，您就不必使生成文件与在 IDE 中对项目所做的更改保持同步。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-22T06:05:46.017

在 Visual Studio 中，打开工具/选项/“项目和解决方案”/“VC++ 目录”对话框，从平台下拉列表中选择适当的值（例如“Windows Mobile 6 Professional SDK (ARMV4I)”）。现在切换“显示目录”下拉列表中的各种值（例如“可执行文件”、“包含文件”、“参考文件”、“库文件”），并记下每个列表中出现的目录。这些是命令行工具所需的目录。

然后，您可以创建一个批处理文件，为 Windows Mobile 开发设置命令行环境：

```
SET PATH=[Executable Files separated by semicolons]
SET INCLUDE=[Include Files separated by semicolons]
SET LIBPATH=[Reference Files separated by semicolons]
SET LIB=[Library Files separated by semicolons] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T15:50:07.617

MSBuild 也运行良好。

执行完全重建的示例命令。你的论点可能会有所不同。

```
C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe  /t:Rebuild /p:Configuration="Release";Platform="Windows Mobile 5.0 Pocket PC SDK (ARMV4I)"; /v:normal /m "C:\MySolutions\MySolution.sln" 
```

# c++ - Qt窗口关闭时如何释放内存？

> ID：671659
> 
> 赞同：1
> 
> 时间：2009-03-22T21:45:13.630
> 
> 标签：c++, qt, memory-management, opencv

我目前正在 Qt、OpenCv、Mac os X 中创建一个程序。我有一个主窗口，然后打开一个单独的窗口。我在构造函数中向新窗口传递了几个矩阵克隆：

```
ImageWindow *imageWin = new ImageWindow( 
   cvCloneMat(getData->getMasterRawMat(1)), 
   cvCloneMat(getData->getMasterRawMat(2)), 
   cvCloneMat(getData->getMasterRawMat(3)), 
   cvCloneMat(getData->getMasterRawMat(4)) );
imageWin->show(); 
```

当新窗口关闭时，我如何解除分配（我在哪里调用 cvReleaseMat ）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T02:14:33.203

你可以在你的[closeEvent()](http://doc.trolltech.com/4.5/qwidget.html#closeEvent)中做到这一点。或者，如果您使用[Qt::WA_DeleteOnClose](http://doc.trolltech.com/4.5/qt.html#WidgetAttribute-enum)作为您的[小部件属性](http://doc.trolltech.com/4.5/qwidget.html#setAttribute)，小部件将在关闭时被删除，这意味着您可以在析构函数中放置一些清理例程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T11:17:58.840

考虑使用[RAII 习惯用法](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)和[智能指针](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/smart_ptr.htm)，您无需记住何时释放分配的内存。

# sql - Rails ActiveRecord：插入包含不可打印/奇怪字符的文本

> ID：671663
> 
> 赞同：-2
> 
> 时间：2009-03-22T21:47:07.697
> 
> 标签：sql, ruby-on-rails, ruby, activerecord, sanitize

我正在从抓取的网络中插入一些文本到我的数据库中。字符串中的某些字段具有不可打印/奇怪的字符。例如，

```
if text is "C__O__?__P__L__E__T__E", 
then the text in the database is stored only as "C__O__" 
```

我知道 h()、strip_tags()... sanitize、... 等等。但我不想清理这个 SQL。activerecord 正确记录 SQL，在 phpMySQL 中运行时，查询正确执行。在 SQL 查询生成和执行之间发生了一些事情。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T10:17:05.507

只需将字符串中的问号替换为包含问号的字符串即可，我也没有找到任何其他方式：

["C__O__?__P__L__E__T__E", '?']

完美运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T22:46:43.747

嗯.. 使用 CGI 转义，我发现进入系统的角色不是我预期的那样。它不是问号 (%3F) 而是问号 (%D5)。

```
C__%D5__M__P__L__%80___T__%80__
C__%3F__M__P__L__%3F___T__%3F__ 
```

***最终，我在保存之前删除了不可打印的字符。***

```
gsub(/[^[:print:]]/, '') 
```

**只有在删除字符串中的无效字符后，我才能正确保存该项目。其他解决方案都没有奏效，部分原因是事先没有清楚地理解这个问题。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T23:30:16.810

你能用“\？”转义问号吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-06T21:26:18.830

我知道这已经很晚了，但是当我们尝试将文件处理为实际使用 ISO-8859-1 字符编码的 UTF-8 时，我遇到了同样的问题。我怀疑您在抓取时遇到了类似的问题，您假设编码错误，最终导致事情失败。

# javascript - 如何加载与 html 混合的 JavaScript

> ID：671666
> 
> 赞同：0
> 
> 时间：2009-03-22T21:49:15.413
> 
> 标签：javascript, iframe

所以我需要从一个远程页面中提取一些 JavaScript，该页面具有（毫无价值的）HTML 和（有用的）JavaScript。该页面称为[http://remote.com/data.html](http://remote.com/data.html)，看起来像这样（我知道这很疯狂）：

```
<html>
<body>
    <img src="/images/a.gif" />
    <div>blah blah blah</div><br/><br/>
    var data = { date: "2009-03-15", data: "Some Data Here" };

</body>
</html> 
```

所以，我需要在我的本地页面中加载这个数据变量并使用它。

我更喜欢完全使用客户端代码。我想，如果我可以将这个页面的 HTML 放入一个本地 JavaScript 变量中，我就可以解析出 JavaScript 代码，`eval`在上面运行并很好地使用这些数据。所以我想在 iframe 中加载远程页面，但我似乎无法在 DOM 中找到 iframe。为什么不？：

```
<script>
    alert(window.parent.frames.length);
    alert(document.getElementById('my_frame'));
</script>

<iframe name="my_frame" id='my_frame' style='height:1px; width:1px;' frameBorder=0 src='http://remote.com/data.html'></iframe> 
```

第一个警报显示`0`，第二个`null`，这是没有意义的。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T21:59:34.750

您是否尝试过切换顺序 - 即首先是 iframe，然后是脚本？该脚本在 iframe 插入 DOM 之前运行。

此外，这在类似情况下对我有用：给 iframe 一个 onload 处理程序：

```
<iframe src="http://example.com/blah" onload="do_some_stuff_with_the_iframe()"></iframe> 
```

最后但同样重要的是，请注意跨站脚本问题——iframe 可能已加载，但您的 JS 可能无法访问它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T09:46:37.280

一种选择是使用 XMLHttpRequest 来检索页面，尽管它[显然](http://en.wikipedia.org/wiki/XMLHttpRequest#Cross-site_HTTP_requests)目前仅用于跨站点请求。

我了解您可能想要制作一个使用客户端互联网连接来检索 html 页面的工具（出于安全或法律原因），因此这是一个合理的希望。

如果您最终需要在服务器端执行此操作，那么可能是一个简单的 php 页面，该页面将 url 作为查询并返回包含字符串中脚本的 json 块。这样，如果您确实发现需要过滤掉某些网站，您只需在一个地方执行此操作。

不可避免的问题是一些用户会怀有敌意，然后他们就有了滥用 JavaScript 代理的许可。因此，最安全的选择可能是在服务器上进行所有处理，并且不允许某些 javascript 函数调用（eval、http 请求等）。

# reload - Apache HTTPD 重新加载

> ID：671667
> 
> 赞同：23
> 
> 时间：2009-03-22T21:49:16.163
> 
> 标签：reload, apache

有谁知道在 Apache HTTPD 进行重新加载时（比如说，这需要 5 秒钟）它是否仍然可以在那段时间内处理请求？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-22T22:08:59.750

首先，您说重新加载，但假设您的意思是“重新加载”或“重新启动”：

```
 /my/path/to/httpd restart 
```

*   导致当前的 httpd 进程退出，这意味着服务器在一段时间内似乎已关闭，因为没有服务任何请求。

在另一边重新加载：

```
 /my/path/to/httpd reload 
```

*   不会导致当前服务器退出，这意味着连接永远不会被拒绝，因此服务器永远不会向下看（但会很慢一段时间）
*   将导致所有长时间运行的 httpd 守护进程请求退出

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-22T21:52:48.980

据我所知，没有。然而，有一个优雅的重启可以阻止子节点停止中间请求，我认为这可以解决这个问题。

[http://httpd.apache.org/docs/2.2/stopping.html](http://httpd.apache.org/docs/2.2/stopping.html)

# c# - OutputCache 行为异常

> ID：671669
> 
> 赞同：2
> 
> 时间：2009-03-22T21:51:29.857
> 
> 标签：c#, .net, asp.net, caching

```
protected void Page_Load(object sender, EventArgs e)
{Label1.Text = DateTime.Now.ToString();} 
```

如果我编译这个新创建的应用程序后，浏览器B1首先请求Cache.aspx，那么接收页面上显示的时间是10.16:20。如果说 10 秒后，我刷新 B1 的 Cache.aspx（通过单击按钮导致回发），则将显示时间 10.16.30，并且在所有后续回发中，将始终显示 10.16.30（直到 1 小时过去） ）。如果在 B1 首次请求 Cache.aspx 几分钟后，浏览器 B2 也请求相同的页面，那么在第一次收到该页面时，B2 的 Cache.aspx 将显示时间 10.16.20，而在所有后续 B2 的回发中，时间为 10.16:30将改为显示。

A）因此，Asp.net 似乎生成了两个缓存版本的 Cache.aspx（因此代码执行了两次），一个缓存页面提供给第一次请求 Cache.aspx 的浏览器，第二个缓存页面提供给浏览器哪个只刷新他们的Cache.aspx？

B）由于我的书从未提到过这种行为，我想知道您是否得到相同的行为或者我的网络环境再次“独特”？

C）创建同一页面的两个副本（因此执行代码两次）似乎是在浪费时间，那么为什么 Asp.Net 会这样运行——它背后一定有一些推理/好处？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T22:15:19.907

一个完整的猜测，但大概缓存被整个请求（查询字符串参数等）隔离......即使“none”关闭键/值对，大概“GET”仍然算作不同一个帖子”？？？

尝试使用简单链接（`<a href...>`等）而不是 ASP.NET 按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T09:35:55.377

如果我尝试 if (ispostback) begin response.cache.setcachebility(nocache) end

然后按钮单击每次都会更新标签。

# html - 列表背景颜色在 IE7 中搞砸了

> ID：671680
> 
> 赞同：0
> 
> 时间：2009-03-22T21:59:51.503
> 
> 标签：html, css, internet-explorer

我将一些无序的 HTML 列表及其标题设置为在 Firefox 中如下所示：

[替代文字 http://img24.imageshack.us/img24/711/screenshot001nij.png](http://img24.imageshack.us/img24/711/screenshot001nij.png)

不幸的是，在 IE7 中，它们看起来像这样：

[替代文字 http://img11.imageshack.us/img11/8343/screenshot002e.png](http://img11.imageshack.us/img11/8343/screenshot002e.png)

相关的 HTML 是

```
<div class="list-column">
    <h4>Types de pêche</h4>
    <ul>
        <li>Pêche en lac</li>
        <li>Pêche en Rivière</li>
    </ul>
</div> 
```

CSS是：

```
.list-column {
  float: left;
  margin-right: 20px;
  width: 20em;
}

div.list-column h4 {
  background-color: #FDD041;
  padding: 5px !important;
}

ul li {
  background-image: url(images/arrow.gif);
  background-position: 0 11px;
  background-repeat: no-repeat;
  list-style-image: none;
  list-style-position: outside;
  list-style-type: none;
  margin-bottom: 6px;
  margin-left: -20px;
  margin-top: 2px;
  padding: 2px 0 2px 18px;
} 
```

我怀疑包含列表的 div 向左浮动的事实可能是我问题的根源，但我不确定如何解决 IE7 中显示不佳的问题？

**更新：** 我尝试在 'ul' 元素中添加一个 'zoom: 1' 属性，以查看给元素 'layout' 是否可以解决 IE 中的问题，但它没有。

问题绝对与圆角无关。我暂时关闭了它们，但它并没有改变 IE 中的任何东西（除了角落的外观）。

谢谢，唐

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-22T23:30:31.957

IE 和其他浏览器有不同的默认样式表。

IE 通过在 <ul> 上放置“margin-left”来缩进列表项。其他浏览器在 <ul> 上放置了一个'padding-left'。

因此，如果您想在所有浏览器中看起来都一样，请在 <ul> 上显式设置 'margin-left' 和 'padding-left'。在您的情况下，您需要添加类似“margin: 0; padding: 24px” 在你的“div.list-column ul, ul.round” 规则。

（IE 中的默认列表 'margin-left' 准确地说是 '30pt'。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T22:28:37.520

一个常见的解决方案是设置元素的宽度。这将使 IE 的所有内容都在该宽度的范围内。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T22:29:22.930

我认为这是 IE-7 自动缩进 li 最简单的调试方法是安装 IE-8；切换到兼容的 ie-7 模式。然后从工具菜单启动开发者工具

然后，您可以检查各个元素并检查是否应用了隐藏的填充或边距

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T22:39:26.777

我认为它可能取决于 ie 和 firefox 上的不同默认填充。如果您还没有这样做，请尝试在您的代码中使用 reset.css。

Ps 在 ie8 中你有类似于 firebug 的开发者工具。尝试使用它们，看看您是否无法理解问题...

# kindle - 我想将 Fritz z-machine 解释器移植到 Amazon Kindle。这甚至可能吗？

> ID：671683
> 
> 赞同：11
> 
> 时间：2009-03-22T22:01:15.183
> 
> 标签：kindle, z-machine

我希望能够在 Amazon Kindle 2 上播放互动小说作品。为此，我需要将[Fritz 解释器移植](http://frotz.sourceforge.net/)到 Kindle。到目前为止，我还没有找到任何讨论 Kindle 应用程序开发的地方。这样的事情存在吗？我在哪里可以找到更多信息？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-10-29T19:36:14.203

已经有一个网络应用程序。kindle 支持 javascript 吗？如果是这样，这可能值得一试： http: [//parchment.toolness.com/](http://parchment.toolness.com/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-02-26T17:50:46.410

是的，KDK 允许这样的应用程序，你只需要用 Java (1.4) 编写它，但除此之外你可以自由地这样做（这将是 KDK 的一个很酷的用途，你应该申请 beta 程序）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-22T22:17:10.997

[这个扭转一切](http://igorsk.blogspot.com/)的博客是关于kindle hacking的。（毕竟它是一个 linux 机器）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-01-13T16:10:32.450

除了羊皮纸，还有[http://www.web-adventures.org](http://www.web-adventures.org)

这是一个极简的纯 HTML 网站，应该可以在包括 Kindle 在内的任何设备上很好地呈现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T14:54:27.240

您可以将其构建为 Web 应用程序并使用 Kindle 浏览器进行播放。

[http://johnaugust.com/archives/2009/kindle-formatting-for-web-geeks](http://johnaugust.com/archives/2009/kindle-formatting-for-web-geeks)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-08T21:30:33.930

由于 Kindle 开发工具包 (KDK) 是基于 Java 的，或许一个很好的起点是基于 Java 的 Z 机器解释器，例如[http://zmpp.sourceforge.net/](http://zmpp.sourceforge.net/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-10-19T11:43:56.853

这里有一个开源项目：http: [//adq.livejournal.com/109224.html](http://adq.livejournal.com/109224.html)但它在 KDK 之外，因为 KDK 没有被广泛使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-01-29T02:35:13.763

看起来 Antiquarian Productions 的 Jimmy Maher 已经完成了 Z-Machine 到 Kindle 的移植，实际上有一本书要出售： http: [//maher.filfre.net/King/](http://maher.filfre.net/King/)

不幸的是（好吧，部分不幸），看起来他是一家商业企业，即使在越狱的 Kindle 上，他也不会发布他的端口的源代码供其他人使用。

# .net - SubSonic 动态模式：SelectList

> ID：671693
> 
> 赞同：0
> 
> 时间：2009-03-22T22:16:19.640
> 
> 标签：.net, subsonic, dynamic-schema

## 设想

我正在为我的最新项目使用 SubSonic。首先要做的事；这个项目仅限于使用 .net 3.0 并且 SubSonic 非常棒。我喜欢它。

但是，我在自定义方面遇到了一些麻烦。客户要求我们使用两个 SQL Server 2005 数据库，其中一个将复制另一个，减去一些列。

乍一看，这似乎很简单。但是，SubSonic 默认抓取所有列，导致 SQLExceptions。我想*优雅地*逐个表地限制选择列表。

例如，下面的代码可以解决问题，但我宁愿每次新查询时都不需要这样做：

```
Query q = Post.Query().WHERE(Post.Columns.PageId, page_id);
if(UsingReplicatedDB)
    q.SetSelectList(ReplicatedPostColumnList);
return q.ExecuteReader(); 
```

## 问题

上述方法使我的代码膨胀，并且不适用于`FetchByX`SubSonic 生成的内置方法。有没有办法在一个表格的基础上优雅地设置**默认的 SelectList ？**

## 笔记

我曾尝试在运行时在我的部分类中从模式中删除列，但是看起来像`ColNameColumn`在集合中查找特定索引的列，`Columns`所以我的计划被挫败了。

## 我知道我知道

请不要“你是个白痴，你为什么要这样做？” 答案。我知道很可能有更好的方法，这似乎有点老套，但这就是我要说的。我需要一个不纠缠的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T03:03:13.943

我不认为有一个简单的方法可以让这个工作。您可以创建两个指向每个 DB 的 SubSonic 提供程序，然后根据情况，使用 SubSonic 对象来填充单独的模型。但是 SubSonic 并不能按照您想要的方式工作，因为它与 db 架构紧密相关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T14:24:04.773

你在这里确实有一个非常棘手的情况。即使您确实找到了一种方法来让您的查询根据您使用的数据库版本来获取列，您现在也必须弄清楚您在业务模型或 UI 中的任何地方都在使用哪个数据库，这样您就不会引用哪些列不存在。

我建议使用两个 SubSonic 提供程序，然后让 Generated 类各自实现一个接口，该接口包含两个类共有的列的属性以及您计划用于与数据库交互的 Subsonic 方法，例如 Save( );.

有时，当您想自定义某些东西以使其按您希望的方式工作时，您需要编写一些自定义代码:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T18:50:16.847

如果您愿意使用 3.0（即将发布），我很乐意与您合作解决一些 TT 模板修复程序，这些修复程序可以做到这一点（忽略 rep 列）。用我的名字在 gmail 上联系我——我一直想这样做 :)。

3.0 还允许您使用 Linq 和我们的 neq 查询工具 - 但我想确保它不会破坏您正在做的事情。

# c# - 将凭据传递给 Sql Report Server 2008

> ID：671694
> 
> 赞同：21
> 
> 时间：2009-03-22T22:16:48.063
> 
> 标签：c#, asp.net, reporting-services, ssrs-2008

我是 C# 的新手，我的英语不太好 - 如果我错过了一点，请提前道歉。

`ReportService`我试图建立一个带有控件的 ASP.NET 网站。您可能已经知道，SSRS 2008 不允许匿名登录。因此，我尝试将凭据传递给 SSRS，SSRS 将存储在我的网页中，以便用户无需登录即可查看报告。

我找到了下面的代码并将其放在我的`WebForm`，但我遇到了报告参数的问题。

*   如果报告参数有默认值，则以下代码可以正常工作。

*   但是，如果我尝试更改参数的值，则整个页面都会
    刷新，并且在我单击“查看报告”按钮之前，所有
    参数都会重置为默认值或空值。

关于如何避免刷新整个页面或将登录信息传递给 SSRS 的任何建议？提前非常感谢。

```
using System;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;
using System.Net;
using Microsoft.Reporting.WebForms;

public partial class _Default : System.Web.UI.Page 
{
    protected void Page_Load(object sender, EventArgs e)
    {
        ReportViewer1.Width = 800;
        ReportViewer1.Height = 600;
        ReportViewer1.ProcessingMode = ProcessingMode.Remote;
        IReportServerCredentials irsc =new CustomReportCredentials("administrator", "MYpassworw", "domena");
        ReportViewer1.ServerReport.ReportServerCredentials = irsc;
        ReportViewer1.ServerReport.ReportServerUrl = new Uri("http://192.168.0.1/ReportServer/");
        ReportViewer1.ServerReport.ReportPath = "/autonarudzba/listanarudzbi";
        ReportViewer1.ServerReport.Refresh();
    }
}

public class CustomReportCredentials : IReportServerCredentials
{
     private string _UserName;
     private string _PassWord;
     private string _DomainName;

     public CustomReportCredentials(string UserName, string PassWord, string DomainName)
     {
        _UserName = UserName;
        _PassWord = PassWord;
        _DomainName = DomainName;
     }

     public System.Security.Principal.WindowsIdentity ImpersonationUser
     { 
        get { return null; } 
     } 

     public ICredentials NetworkCredentials
     {
        get { return new NetworkCredential(_UserName, _PassWord, _DomainName); }
     }

     public bool GetFormsCredentials(out Cookie authCookie, out string user,
      out string password, out string authority)
     {
        authCookie = null;
        user = password = authority = null;
        return false;
     }
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-22T23:04:23.517

我真的没有弄乱 SSRS - 但我的 ASP.NET 帽子告诉我，您可能希望将这些东西包装在一个`if (!IsPostBack)`块中，以防止它在页面刷新时运行。我的猜测是`ReportViewer1.ServerReport.Refresh()`再次拉取默认值。

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!this.IsPostBack) 
    {
        ReportViewer1.Width = 800;
        ReportViewer1.Height = 600;
        ReportViewer1.ProcessingMode = ProcessingMode.Remote;
        IReportServerCredentials irsc =new CustomReportCredentials("administrator", "MYpassworw", "domena");
        ReportViewer1.ServerReport.ReportServerCredentials = irsc;
        ReportViewer1.ServerReport.ReportServerUrl = new Uri("http://192.168.0.1/ReportServer/");
        ReportViewer1.ServerReport.ReportPath = "/autonarudzba/listanarudzbi";
        ReportViewer1.ServerReport.Refresh();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T08:45:26.357

我创建了新功能，并在属性、事件、reportViewer 的设计视图中选择了它。（在选择 INIT i 中）

之后，页面正常工作，我可以更改参数值。

Default.aspx 现在看起来像：

```
 </head>
      <body>
        <form id="form1" runat="server">
         <div>
            <rsweb:ReportViewer ID="ReportViewer1" runat="server" onload="Admir">
            </rsweb:ReportViewer>
         </div>
       </form>
    </body> 
```

Default.aspx.cs 看起来像这样

```
 public void Admir(object sender, EventArgs e)
    {
        ReportViewer1.Width = 800;
        ReportViewer1.Height = 600;
        ReportViewer1.ProcessingMode = ProcessingMode.Remote;
        IReportServerCredentials irsc = new CustomReportCredentials("administrator", "mypass", "domena");
        ReportViewer1.ServerReport.ReportServerCredentials = irsc;
        ReportViewer1.ServerReport.ReportServerUrl = new Uri("http://192.168.0.1/ReportServer/");
        ReportViewer1.ServerReport.ReportPath = "/autonarudzba/listanarudzbi";
        ReportViewer1.ServerReport.Refresh();

    }
    protected void Page_Load(object sender, EventArgs e)
    {

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-23T18:45:29.273

您可以在页面加载事件中使用以下代码来提供参数

```
ReportParameter[] reportParameterCollection = new ReportParameter[1]; //Array size describes the number of paramaters.
reportParameterCollection[0] = new ReportParameter();
reportParameterCollection[0].Name = "ACCMGR";   //Give Your Parameter Name
reportParameterCollection[0].Values.Add("12"); //Pass Parametrs's value here.
ReportViewer1.ServerReport.SetParameters(reportParameterCollection);
ReportViewer1.ServerReport.Refresh(); 
```

我希望这对你有用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-09T06:26:26.123

我已经找到了解决方案。您必须先设置凭据，然后必须为 reportviewer 设置参数。

```
 rvCommon.ProcessingMode = ProcessingMode.Remote;
        rvCommon.ServerReport.ReportServerUrl = new System.Uri("SSRSReportServerURL");
        rvCommon.ServerReport.ReportPath = "/Report Parts/CustomerMainReport2" ;

        Microsoft.Reporting.WebForms.ReportParameter[] RptParameters = new Microsoft.Reporting.WebForms.ReportParameter[1];
         rvCommon.ServerReport.ReportServerCredentials = new ReportCredentials("username", "password", "");

        RptParameters[0] = new Microsoft.Reporting.WebForms.ReportParameter("CustomerId", "1");
        rvCommon.ServerReport.SetParameters(RptParameters);
        rvCommon.ServerReport.Refresh(); 
```

# javascript - Javascript .onchange 限制

> ID：671701
> 
> 赞同：0
> 
> 时间：2009-03-22T22:27:03.390
> 
> 标签：javascript, javascript-events

当我开始开发越来越复杂的 Javascript 解决方案时，我想知道 javascript 给了我什么样的选项来监控我的环境中的变化。我见过这么多的解决方案，它们不断 ping 他们想要监控的任何元素，但是对于任何类型的资源密集型应用程序（或任何情况，取决于开发人员的标准），它们变得臃肿且过于陈旧而无法成为可行的方法. 这让我想到了我的问题，“javascript 的 onchange 事件有什么限制？”。具体来说，现在我正在尝试监视窗口的大小。有没有办法利用 .onchange 事件来处理这样的事情？你会如何解决这个问题？

谢谢！我很想听听大家怎么说。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-22T22:32:33.017

onchange 属性是一个 DOM 属性。它不是由 Javascript 提供的。[W3schools 报告说，根据他们关于 onchange 事件的页面](http://www.w3schools.com/jsref/jsref_onchange.asp)，只有一些元素支持它的使用：

> 受以下 HTML 标记支持：

```
<input type="text">, <select>,
<textarea> 
```

> 受以下 JavaScript 对象支持：
> 
> 文件上传、选择、文本、文本区域

如果你想监视窗口的大小，你基本上有两个选择： - 使用 onresize 属性 - 设置一个通过轮询检查的间隔。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-22T22:35:32.463

可以使用[onresize](http://www.w3schools.com/jsref/jsref_onresize.asp)监视窗口的大小。

正如 Rahul 所说，onchange 事件适用于文件上传、选择、文本和文本区域。然而，它只会在焦点从项目转移到其他东西上并且内容发生变化时才会触发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T22:56:51.977

试试[jQuery](http://jquery.com/)吧，它小巧而强大。

jQuery 有两个对你有用的函数：[width()](http://docs.jquery.com/CSS/width)和[height()](http://docs.jquery.com/CSS/height)

示例（基于上面链接的文档中的示例）：

```
function showWidth(ele, w) {
    $("someDiv").text("The width for the " + ele + 
                " is " + w + "px.");
}

$('#someElement').change(function () { 
  showWidth("document", $(document).width()); 
}); 
```

当然，这同样适用于 height()。祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T08:56:08.713

```
window.onresize=function(){
    exampleFunction();
} 
```

我就是这样做的。我对onchange不是很热衷，如果你用JS改变了元素，你也可以在同一个JS中调用事件。（为什么喜欢：JS -> element -> JS，什么时候可以去：JS -> element and JS）

# arrays - 交换键和数组值对

> ID：671702
> 
> 赞同：1
> 
> 时间：2009-03-22T22:27:11.767
> 
> 标签：arrays, language-agnostic, text-processing

我有一个这样布局的文本文件：

```
1   a, b, c
2   c, b, c
2.5 a, c 
```

我想反转键（数字）和值（CSV）（它们由制表符分隔）来产生这个：

```
a   1, 2.5
b   1, 2
c   1, 2, 2.5 
```

（请注意 2 如何不与 c 重复。）

我不需要这个确切的输出。输入中的数字是有序的，而值不是。必须对输出的键和值进行排序。

我怎样才能做到这一点？我可以访问标准的 shell 实用程序（awk、sed、grep...）和 GCC。如果需要，我可能可以获取其他语言的编译器/解释器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T23:32:50.157

如果你有python（如果你在linux上你可能已经有）我会使用一个简短的python脚本来做到这一点。请注意，我们使用集合来过滤掉“双重”项目。

编辑为更接近请求者的要求：

```
import csv
from decimal import * 
getcontext().prec = 7

csv_reader = csv.reader(open('test.csv'), delimiter='\t')

maindict = {}
for row in csv_reader:
    value = row[0]
    for key in row[1:]:
        try:
            maindict[key].add(Decimal(value))
        except KeyError:
            maindict[key] = set()
        maindict[key].add(Decimal(value))

csv_writer = csv.writer(open('out.csv', 'w'), delimiter='\t')

sorted_keys = [x[1] for x in sorted([(x.lower(), x) for x in maindict.keys()])]
for key in sorted_keys:
    csv_writer.writerow([key] + sorted(maindict[key])) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T22:41:43.650

如果您可以使用 perl，我会尝试。一次循环输入一行。拆分选项卡上的行，然后拆分逗号上的右侧部分。将值推入一个关联数组，其中字母作为键，值是另一个关联数组。第二个关联数组将扮演集合的一部分，以消除重复。

读取输入文件后，根据关联数组的键进行排序，循环并输出结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T23:17:04.097

这是php中的一个小实用程序：

```
// load and parse the input file
$data = file("path/to/file/");
foreach ($data as $line) {
    list($num, $values) = explode("\t", $line);
    $newData["$num"] = explode(", ", trim($values));
}
unset($data);

// reverse the index/value association
foreach ($newData as $index => $values) {
    asort($values);
    foreach($values as $value) {
        if (!isset($data[$value]))
            $data[$value] = array();
        if (!in_array($index, $data[$value]))
            array_push($data[$value], $index);
    }
}

// printout the result
foreach ($data as $index => $values) {
    echo "$index\t" . implode(", ", $values) . "\n";
} 
```

没有真正优化或好看，但它的工作原理......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T04:49:39.180

这是一个 awk(1) 和 sort(1) 的答案：

您的数据基本上是一个多对多数据集，因此第一步是使用每行一个键和一个值对数据进行规范化。我们还将交换键和值以指示新的主字段，但这并不是绝对必要的，因为较低的部分不依赖于顺序。我们使用制表符或 [spaces],[spaces] 作为字段分隔符，因此我们在键和值之间以及值之间拆分制表符。这将在值中嵌入空格，但从前后修剪它们：

```
awk -F '\t| *, *' '{ for (i=2; i<=NF; ++i) { print $i"\t"$1 } }' 
```

然后我们要应用您的排序顺序并消除重复项。我们使用 bash 功能将制表符指定为分隔符 (-t $'\t')。如果您使用的是 Bourne/POSIX shell，则需要使用 '[tab]'，其中 [tab] 是文字选项卡：

```
sort -t $'\t' -u -k 1f,1 -k 2n 
```

然后，把它放回你想要的形式：

```
awk -F '\t' '{ 
    if (key != $1) { 
        if (key) printf "\n";
        key=$1;
        printf "%s\t%s", $1, $2
    } else {
        printf ", %s", $2
    }
  }
  END {printf "\n"}' 
```

将它们完全通过管道传输，您应该获得所需的输出。我使用 GNU 工具进行了测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T05:14:27.513

```
# use Modern::Perl;
use strict;
use warnings;
use feature qw'say';

our %data;

while(<>){
  chomp;
  my($number,$csv) = split /\t/;
  my @csv = split m"\s*,\s*", $csv;
  push @{$data{$_}}, $number for @csv;
}

for my $number (sort keys %data){
  my @unique = sort keys %{{ map { ($_,undef) } @{$data{$number}} }};
  say $number, "\t", join ', ', @unique;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T05:18:11.497

这是一个使用 CPAN 的 Text::CSV 模块而不是手动解析 CSV 字段的示例：

```
use strict;
use warnings;
use Text::CSV;

my %hash;
my $csv = Text::CSV->new({ allow_whitespace => 1 });

open my $file, "<", "file/to/read.txt";

while(<$file>) {
  my ($first, $rest) = split /\t/, $_, 2;
  my @values;

  if($csv->parse($rest)) {
    @values = $csv->fields()
  } else {
    warn "Error: invalid CSV: $rest";
    next;
  }

  foreach(@values) {
    push @{ $hash{$_} }, $first;
  }
}

# this can be shortened, but I don't remember whether sort()
# defaults to <=> or cmp, so I was explicit
foreach(sort { $a cmp $b } keys %hash) {
  print "$_\t", join(",", sort { $a <=> $b } @{ $hash{$_} }), "\n";
} 
```

请注意，它将打印到标准输出。我建议只重定向标准输出，如果你扩展这个程序，确保使用它`warn()`来打印任何错误，而不是仅仅`print()`ing 它们。此外，它不会检查重复条目，但我不想让我的代码看起来像 Brad Gilbert 的，即使对于 Perlite 来说也有点古怪。

# c++ - 数组索引越界行为

> ID：671703
> 
> 赞同：48
> 
> 时间：2009-03-22T22:27:15.010
> 
> 标签：c++, c, arrays

为什么 C/C++ 会在数组索引越界的情况下进行区分

```
#include <stdio.h>
int main()
{
    int a[10];
    a[3]=4;
    a[11]=3;//does not give segmentation fault
    a[25]=4;//does not give segmentation fault
    a[20000]=3; //gives segmentation fault
    return 0;
} 
```

我知道它正在尝试访问分配给进程或线程的内存`a[11]`，`a[25]`以防`a[20000]`.

为什么编译器或链接器不给出错误，他们不知道数组大小吗？如果没有，那么如何`sizeof(a)`正常工作？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-03-22T22:29:49.450

问题是 C/C++ 实际上并没有对数组进行任何边界检查。这取决于操作系统来确保您访问的是有效内存。

在这种特殊情况下，您要声明一个基于堆栈的数组。根据特定的实现，在数组边界之外访问将只访问已分配堆栈空间的另一部分（大多数操作系统和线程为堆栈保留一定部分的内存）。只要您碰巧在预先分配的堆栈空间中玩耍，一切都不会崩溃（注意我没有说工作）。

最后一行发生的情况是，您现在访问的内存超出了为堆栈分配的部分内存。因此，您正在索引未分配给您的进程或以只读方式分配的内存部分。操作系统看到这一点并向进程发送段错误。

这是 C/C++ 在边界检查方面如此危险的原因之一。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-22T22:33:45.637

段错误不是您的 C 程序的预期操作，它会告诉您索引超出范围。相反，这是未定义行为的意外结果。

在 C 和 C++ 中，如果您声明一个数组，如

```
type name[size]; 
```

您只能访问索引从`0`到 的元素`size-1`。超出该范围的任何内容都会导致未定义的行为。如果索引接近范围，则很可能您读取了自己程序的内存。如果索引大部分超出范围，很可能您的程序将被操作系统杀死。但你不知道，任何事情都有可能发生。

为什么 C 允许这样做？好吧，C 和 C++ 的基本要点是不提供具有成本性能的特性。C 和 C++ 多年来一直用于高性能关键系统。C 已被用作内核和程序的实现语言，在这些语言中，超出数组边界的访问对于快速访问内存中相邻的对象很有用。让编译器禁止这样做是徒劳的。

为什么它不警告呢？好吧，您可以将警告级别设置得很高，并希望编译器能够宽恕。这称为*实施质量*(QoI)。如果某些编译器使用开放行为（例如，未定义的行为）来做一些好事，那么它在这方面具有良好的实现质量。

```
[js@HOST2 cpp]$ gcc -Wall -O2 main.c
main.c: In function 'main':
main.c:3: warning: array subscript is above array bounds
[js@HOST2 cpp]$ 
```

相反，如果它会在看到阵列越界访问时格式化您的硬盘 - 这对它来说是合法的 - 实施的质量将会相当糟糕。[我喜欢在ANSI C 基本原理](http://www.lysator.liu.se/c/rat/a.html#1)文档中阅读这些内容。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-22T22:30:21.290

如果您尝试访问您的进程不拥有的内存，通常只会出现分段错误。

在这种情况下`a[11]`（顺便说一下），您看到的是您的进程*确实*拥有但不属于数组`a[10]`的内存。远非如此，它可能完全不在你的记忆中。*`a[]``a[25000]``a[]`*

 *更改`a[11]`要隐蔽得多，因为它会默默地影响不同的变量（或在函数返回时可能导致不同分段错误的堆栈帧）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-22T22:30:47.373

C没有这样做。操作系统的虚拟内存子系统是。

在您只是稍微超出范围的情况下，您正在处理为您的*程序*分配的内存（在这种情况下是在堆栈调用堆栈上）。在您远远超出范围的情况下，您正在处理未交给程序的内存并且操作系统正在引发分段错误。

在某些系统上，还有一个操作系统强制执行的“可写”内存概念，您可能正在尝试写入您拥有但被标记为不可写的内存。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-22T22:40:22.937

只是补充一下其他人所说的话，您不能依赖程序在这些情况下简单地崩溃，如果您尝试访问超出“数组边界”的内存位置，则无法保证会发生什么。就像您执行以下操作一样：

```
int *p;
p = 135;

*p = 14; 
```

那只是随机的；这可能有效。可能不会。不要这样做。防止此类问题的代码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-23T02:38:11.243

正如 litb 所提到的，一些编译器可以在编译时检测到一些越界的数组访问。但是编译时的边界检查不会捕获所有内容：

```
int a[10];
int i = some_complicated_function();
printf("%d\n", a[i]); 
```

为了检测到这一点，必须使用运行时检查，并且在 C 中避免使用它们，因为它们会影响性能。即使在编译时知道 a 的数组大小，即[sizeof](http://en.wikipedia.org/wiki/Sizeof) (a)，如果不插入运行时检查，它也无法防止这种情况发生。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-23T04:11:50.860

据我了解问题和评论，您了解为什么当您越界访问内存时*会*发生不好的事情，但您想知道为什么您的特定编译器没有警告您。

编译器可以向您发出警告，并且许多编译器会以最高警告级别发出警告。然而，编写该标准是为了允许人们为各种设备运行编译器，以及具有各种功能的编译器，因此该标准要求尽可能少，同时保证人们可以做有用的工作。

有几次标准要求某种编码风格会产生诊断。还有其他几次标准不需要诊断。即使需要进行诊断，我也不知道标准在任何地方说明了确切的措辞。

但你在这里并不完全处于寒冷之中。如果您的编译器没有警告您，Lint 可能会。此外，还有许多工具可以检测堆上阵列的此类问题（在运行时），其中最著名的工具之一是 Electric Fence（或[DUMA](http://duma.sourceforge.net/)）。但即使是 Electric Fence 也不能保证它会捕获所有溢出错误。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-22T22:32:45.060

这不是 C 问题，而是操作系统问题。您的程序已被授予一定的内存空间，您在其中执行的任何操作都可以。分段错误仅在您访问进程空间之外的内存时发生。

并非所有操作系统都为每个进程提供单独的地址空间，在这种情况下，您可以在没有警告的情况下破坏另一个进程或操作系统的状态。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-07-16T16:04:32.223

C 哲学始终是信任程序员。而且不检查边界也可以让程序运行得更快。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-09-03T03:54:13.030

正如 JaredPar 所说，C/C++ 并不总是执行范围检查。如果您的程序访问分配的数组之外的内存位置，您的程序可能会崩溃，或者它可能不会因为它正在访问堆栈上的其他一些变量。

要回答有关 C 中 sizeof 运算符的问题：您可以可靠地使用 sizeof(array)/size(array[0]) 来确定数组大小，但使用它并不意味着编译器将执行任何范围检查。

我的研究表明，C/C++ 开发人员认为你不应该为不使用的东西付费，他们相信程序员知道他们在做什么。（请参阅已接受的答案：[Accessing an array out of bounds 没有错误，为什么？](https://stackoverflow.com/questions/1239938/accessing-an-array-out-of-bounds-gives-no-error-why)）

如果您可以使用 C++ 而不是 C，也许使用向量？您可以在需要性能时使用 vector[]（但没有范围检查），或者更优选地使用 vector.at() （以性能为代价进行范围检查）。请注意，如果 vector 已满，它不会自动增加容量：为了安全起见，请使用 push_back()，它会在必要时自动增加容量。

有关矢量的更多信息：[http ://www.cplusplus.com/reference/vector/vector/](http://www.cplusplus.com/reference/vector/vector/)

# .net - 策略服务器的意义何在？（银光）

> ID：671704
> 
> 赞同：0
> 
> 时间：2009-03-22T22:28:24.807
> 
> 标签：.net, silverlight, policy-server

我一直在搞乱 Silverlight 套接字，在摸索我的连接被拒绝的原因后，我意识到我需要设置一个策略服务器。Silverlight 连接到由套接字连接指定的主机上的策略服务器端口。策略服务器返回一个 XML 文件，指定允许对该主机的访问。

我是否正确理解这一点？这有什么意义？难道任何恶意用户都不能简单地忽略策略文件并为所欲为吗？

[替代文字 http://www.netortech.com/Content/policy.jpg](http://www.netortech.com/Content/policy.jpg)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T22:47:27.193

[报价](http://msdn.microsoft.com/en-us/library/cc197955(VS.95).aspx)：

> > 用于跨域通信需要防范几种可用于利用 Web 应用程序的安全漏洞。跨站点伪造是一类漏洞，当允许跨域调用时会成为威胁。该漏洞利用恶意 Silverlight 控件在用户不知情的情况下将未经授权的命令传输到第三方服务。为防止跨站点请求伪造，默认情况下 Silverlight 仅允许对除图像和媒体之外的所有请求进行源站点通信。例如，托管在[http://contoso.com/mycontrol.aspx](http://contoso.com/mycontrol.aspx)的 Silverlight 控件默认只能访问同一域上的服务 - 例如[http://contoso.com/service.svc](http://contoso.com/service.svc)，但不能访问[http上的服务://fabrikam.com/service.svc](http://fabrikam.com/service.svc). [这可以防止托管在http://contoso.com](http://contoso.com)域上的恶意 Silverlight 控件对托管在[http://fabrikam.com](http://fabrikam.com)域上的服务调用未经授权的操作。
> > 
> > 要使 Silverlight 控件能够访问另一个域中的服务，该服务必须明确选择加入以允许跨域访问。通过选择加入，服务声明其公开的操作可以由 Silverlight 控件安全地调用，而不会对服务存储的数据造成潜在的破坏性后果。

* * *

编辑：基于评论/问题...

我只会给出我对这种情况的可能不完美的理解，但这对我来说很有意义。

浏览器通常会限制它可以将您路由到的内容，因为它很难访问除提供 http 页面的主机之外的任何主机。无论讨论什么资源都是如此。这些约束需要通过推理应用于在浏览器/网页上下文中运行的任何其他内容，包括 Silverlight。所以这只是推断允许外部引用的现有机制。

我不确定您打算如何区分“服务”和“套接字”。一般服务使用套接字；主机上有一些进程（服务或其他）正在监视端口上的连接；一种类型的连接是套接字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T16:17:56.607

我终于找到了这样做的一个很好的理由。

Silverlight 应用程序有可能非常快速地分发/执行。例如，作为热门网站上的广告。在这种情况下，某人很容易使用 Silverlight 应用程序对主机进行 DoS 攻击，只需将其提供给广告提供商即可。但是，由于所有 Silverlight 应用程序都会首先检查主机的策略文件，因此它限制了这种攻击可以针对的主机和服务。

# java - 如何在 Clojure 中使 Java 类不可变？

> ID：671706
> 
> 赞同：8
> 
> 时间：2009-03-22T22:28:59.673
> 
> 标签：java, lisp, clojure, immutability, priority-queue

我想将 java 的 PriorityQueue 类包装在 clojure 中，以便在我的程序的另一部分中使用。我想弄清楚的是，是否有任何方法可以以 lispy 的方式执行此操作并使优先级队列不可变。有什么好的方法可以做到这一点，或者我只是将 PriorityQueue 用作可变数据结构会更好？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-22T23:15:32.710

我认为没有一种简单的方法可以将可变数据结构包装为不可变数据结构。当新版本可以巧妙地与旧版本共享数据时，不可变数据结构变得高效，如果不访问`PriorityQueue`.

如果你真的想要一个持久的优先级队列[，这个线程](http://groups.google.com/group/clojure/browse_frm/thread/627b215a728e77ea/)可能会很有趣。那些似乎有线性时间插入，所以如果这是一个问题，也许你必须寻找另一个实现。

编辑：再想一想，持久优先级队列的简单实现就是将 (prio, value) 对存储在排序集中。像这样的东西：

```
(defn make-pqueue []
  (sorted-set))

(defn pqueue-add [pq x prio]
  (conj pq [prio x]))

(defn pqueue-peek [pq]
  (first pq))

(defn pqueue-pop [pq]
  (let [top (first pq)]
    (disj pq top))) 
```

当然，上面的代码非常有限（例如，没有多个条目），但它说明了这个想法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-23T12:32:08.770

您不能自动使可变类不可变。人们总是可以直接调用java类并对其进行变异。

要强制不变性，您可以在 clojure 中实现它，或者扩展 java 类并在所有可变方法实现中抛出异常。

# c++ - 修改 Boost::Graph 中的顶点属性

> ID：671714
> 
> 赞同：38
> 
> 时间：2009-03-22T22:31:01.307
> 
> 标签：c++, boost, graph, properties, boost-graph

我试图弄清楚如何使用 boost::graph 来存储一些信息。但是，我希望将信息绑定到每个顶点。盯着库的文档会发现（a）写得不好的文档，或者（b），我显然不像我想象的那样擅长 C++。选择两个。

我正在寻找一个简单的示例使用。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2010-03-16T20:19:13.323

捆绑的属性易于使用：

```
using namespace boost;

struct vertex_info { 
    std::string whatever; 
    int othervalue; 
    std::vector<int> some_values; 
};

typedef adjacency_list<vecS, vecS, undirectedS, vertex_info> graph_t;

graph_t g(n);

g[0].whatever = "Vertex 0";

[...] 
```

等等。

另请参阅[文档](http://www.boost.org/doc/libs/1_42_0/libs/graph/doc/bundles.html)。

另一种非常有用的顶点属性是外部属性。您可以声明`std::vectors`适当的大小并将它们用作属性。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-04T12:18:48.907

我不喜欢 boost::graph 的嵌套模板属性方法，所以我为所有内容编写了一个小包装器，它基本上允许将任何结构/类作为顶点/边缘属性。可以访问访问结构成员的属性。

为了保持灵活性，这些结构被定义为模板参数。

这里的代码：

```
/* definition of basic boost::graph properties */
enum vertex_properties_t { vertex_properties };
enum edge_properties_t { edge_properties };
namespace boost {
    BOOST_INSTALL_PROPERTY(vertex, properties);
    BOOST_INSTALL_PROPERTY(edge, properties);
}

/* the graph base class template */
template < typename VERTEXPROPERTIES, typename EDGEPROPERTIES >
class Graph
{
public:

    /* an adjacency_list like we need it */
    typedef adjacency_list<
        setS, // disallow parallel edges
        listS, // vertex container
        bidirectionalS, // directed graph
        property<vertex_properties_t, VERTEXPROPERTIES>,
        property<edge_properties_t, EDGEPROPERTIES>
    > GraphContainer;

    /* a bunch of graph-specific typedefs */
    typedef typename graph_traits<GraphContainer>::vertex_descriptor Vertex;
    typedef typename graph_traits<GraphContainer>::edge_descriptor Edge;
    typedef std::pair<Edge, Edge> EdgePair;

    typedef typename graph_traits<GraphContainer>::vertex_iterator vertex_iter;
    typedef typename graph_traits<GraphContainer>::edge_iterator edge_iter;
    typedef typename graph_traits<GraphContainer>::adjacency_iterator adjacency_iter;
    typedef typename graph_traits<GraphContainer>::out_edge_iterator out_edge_iter;

    typedef typename graph_traits<GraphContainer>::degree_size_type degree_t;

    typedef std::pair<adjacency_iter, adjacency_iter> adjacency_vertex_range_t;
    typedef std::pair<out_edge_iter, out_edge_iter> out_edge_range_t;
    typedef std::pair<vertex_iter, vertex_iter> vertex_range_t;
    typedef std::pair<edge_iter, edge_iter> edge_range_t;

    /* constructors etc. */
    Graph()
    {}

    Graph(const Graph& g) :
        graph(g.graph)
    {}

    virtual ~Graph()
    {}

    /* structure modification methods */
    void Clear()
    {
        graph.clear();
    }

    Vertex AddVertex(const VERTEXPROPERTIES& prop)
    {
        Vertex v = add_vertex(graph);
        properties(v) = prop;
        return v;
    }

    void RemoveVertex(const Vertex& v)
    {
        clear_vertex(v, graph);
        remove_vertex(v, graph);
    }

    EdgePair AddEdge(const Vertex& v1, const Vertex& v2, const EDGEPROPERTIES& prop_12, const EDGEPROPERTIES& prop_21)
    {
        /* TODO: maybe one wants to check if this edge could be inserted */
        Edge addedEdge1 = add_edge(v1, v2, graph).first;
        Edge addedEdge2 = add_edge(v2, v1, graph).first;

        properties(addedEdge1) = prop_12;
        properties(addedEdge2) = prop_21;

        return EdgePair(addedEdge1, addedEdge2);
    }

    /* property access */
    VERTEXPROPERTIES& properties(const Vertex& v)
    {
        typename property_map<GraphContainer, vertex_properties_t>::type param = get(vertex_properties, graph);
        return param[v];
    }

    const VERTEXPROPERTIES& properties(const Vertex& v) const
    {
        typename property_map<GraphContainer, vertex_properties_t>::const_type param = get(vertex_properties, graph);
        return param[v];
    }

    EDGEPROPERTIES& properties(const Edge& v)
    {
        typename property_map<GraphContainer, edge_properties_t>::type param = get(edge_properties, graph);
        return param[v];
    }

    const EDGEPROPERTIES& properties(const Edge& v) const
    {
        typename property_map<GraphContainer, edge_properties_t>::const_type param = get(edge_properties, graph);
        return param[v];
    }

    /* selectors and properties */
    const GraphContainer& getGraph() const
    {
        return graph;
    }

    vertex_range_t getVertices() const
    {
        return vertices(graph);
    }

    adjacency_vertex_range_t getAdjacentVertices(const Vertex& v) const
    {
        return adjacent_vertices(v, graph);
    }

    int getVertexCount() const
    {
        return num_vertices(graph);
    }

    int getVertexDegree(const Vertex& v) const
    {
        return out_degree(v, graph);
    }

    /* operators */
    Graph& operator=(const Graph &rhs)
    {
        graph = rhs.graph;
        return *this;
    }

protected:
    GraphContainer graph;
}; 
```

使用它，您可以访问如下属性：

```
struct VertexProperties {
    int i;
};

struct EdgeProperties {
};

typedef Graph<VertexProperties, EdgeProperties> MyGraph;

MyGraph g;

VertexProperties vp;
vp.i = 42;

MyGraph::Vertex v = g.AddVertex(vp);

g.properties(v).i = 23; 
```

当然，您可能对图形结构有其他需求，但是修改上面的代码应该很容易。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T21:36:41.037

下面是我用来将一些属性附加到顶点、边和图形的代码。请注意，顶点名称和图形名称是预定义的属性（完整列表请参见 boost/properties.hpp），因此`vertex_name_t`和`graph_name_t`已经定义。但是，`vertex_location_t`、`edge_length_t`和`graph_notes_t`是我自己的属性，因此需要定义。我从各种示例和文档中拼凑出这段代码，我不确定具体是做什么`BOOST_INSTALL_PROPERTY`的，但代码似乎工作正常。

```
// Define custom properties
enum vertex_location_t { vertex_location };
enum edge_length_t     { edge_length     };
enum graph_notes_t     { graph_notes     };

namespace boost
{
    BOOST_INSTALL_PROPERTY(vertex, location);
    BOOST_INSTALL_PROPERTY(edge,   length  );
    BOOST_INSTALL_PROPERTY(graph,  notes   );
}

// Define vertex properties:  vertex name and location
typedef property<vertex_name_t,     string,
        property<vertex_location_t, Point3> >
VertexProperties;

// Define edge properties:  length
typedef property<edge_length_t, double> EdgeProperties;

// Define graph properties:  graph name and notes
typedef property<graph_name_t,  string,
        property<graph_notes_t, string> >
GraphProperties;

// Define a graph type
typedef adjacency_list
<
    vecS,       // edge container type
    vecS,       // vertex container type
    undirectedS,
    VertexProperties,
    EdgeProperties,
    GraphProperties
> Graph; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T21:43:56.693

我发现这些例子非常有用。在 Windows 上，它将位于您的 \Program Files\boost\boost_1_38\libs\graph\example 目录中。

kevin_bacon2.cpp 使用顶点属性来存储演员的名字。

您的顶点和边属性可以存储在常规结构或类中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T06:08:32.173

我认为 Boost.Graph 有一个非常好的文档，但对于这件事的初学者来说并不是真正的。所以这里有一个例子，我希望它足够简单！

```
//includes

// Create a name for your information
struct VertexInformation
{
  typedef boost::vertex_property_type type;
};

// Graph type, customize it to your needs
// This is when you decide what information will be attached to vertices and/or edges
// of MyGraph objects
typedef boost::adjacency_list<boost::vecS, boost::vecS, boost::bidirectionalS,
  boost::property<VertexInformation, double> > MyGraph;

int main()
{
  MyGraph graph;

  // Create accessor for information
  typedef boost::property_map<MyGraph, VertexInformation>::type  InformationAccessor;
  InformationAccessor information( get( VertexInformation(), graph ) );

  // Create a vertex (for example purpose)
  typedef boost::graph_traits<MyGraph>::vertex_descriptor MyVertex;
  MyVertex vertex = add_vertex( graph );

  // Now you can access your information
  put( information, vertex, 1\. );

  // returns 1 !
  get( information, vertex );
  return 0;
} 
```

# .net - 弃用某些方法/类型

> ID：671727
> 
> 赞同：3
> 
> 时间：2009-03-22T22:40:05.060
> 
> 标签：.net, compiler-construction, static-analysis

为了防止使用某些成员（或类型），有一种方法可以将它们标记为已过时（有时将来会完全删除它们）。

但是有没有办法弃用已编译的第三方程序集的成员（或类型）？或者，至少，在使用它们时确保（或发出警告）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T22:50:20.930

您是否考虑过制定[自定义代码分析/FxCop 规则](http://www.binarycoder.net/fxcop/)？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T00:06:13.900

从到目前为止的答案中您可以看出，没有一种很好的内置方法可以做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T00:04:25.137

我想您可以子类化整个库（或至少是您使用的部分），然后以您喜欢的任何方式弃用它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T23:34:20.793

您也可以为此使用[NDepend](http://www.ndepend.com/)

# .net - .NET --- 文本框控件 - 等到用户完成输入

> ID：671728
> 
> 赞同：16
> 
> 时间：2009-03-22T22:40:22.157
> 
> 标签：.net, vb.net, textbox

大家好，

是否有内置方法可以知道用户何时在文本框中完成输入？（在点击选项卡或移动鼠标之前）我有一个发生在 textchanged 事件上的数据库查询，并且一切正常。但是，我注意到当然有一点延迟，因为如果用户快速输入文本框，程序正忙于对每个字符进行查询。所以我希望的是一种查看用户是否完成输入的方法。因此，如果他们键入“a”并停止，则会触发一个事件。但是，如果他们键入“一直”，则事件会在 y 键后触发。

我有一些想法在我脑海中浮现，但我确信它们不是最有效的。就像测量自上次 textchange 事件以来的时间一样，如果它大于某个值，那么它将继续运行我的其余程序。

让我知道你的想法。

语言：VB.NET 框架：.Net 2.0

--编辑澄清“完成打字”

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-22T22:44:26.873

一种方法：

1.  创建一个`Timer`具有`Interval`X 毫秒的

    间隔应该是300ms左右；超过正常的击键时间，以及完成和更新发生之间的合理等待时间

2.  在输入的`TextChanged`事件中，`Stop()`然后`Start()``Timer`

    `Timer`如果它已经在运行，这将重新启动，因此如果用户继续以正常速度输入，每次更改都会重新启动计时器。

3.  在计时器的`Tick`事件中，`Stop()`and`Timer`执行长事务

4.  可选：处理`Leave`and`KeyDown`事件，以便离开控件或按下`Enter`将and`Stop()`执行`Timer`长事务。

如果文本已更改，并且用户在 X 毫秒内未进行任何更改，这将导致更新。

您正在考虑的“测量自上次更新以来的时间”方法的一个问题是，如果最后一次更改很快进行，则不会发生更新，并且不会有任何后续更改触发另一次检查。

**注意：**`TextBox` es 和`Timer`s之间必须是一对一的配对；如果您打算使用多个输入来执行此操作，我会考虑构建一个`UserControl`包装此功能的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-05-05T22:51:27.627

对于那些在 .NET 2.0 中需要类似功能的人，我在这里制作了一个从 TextBox 派生并使用相同方法的控件。希望对您有所帮助

```
public partial class TextBox : System.Windows.Forms.TextBox
{

    private ManualResetEvent _delayMSE;
    public event EventHandler OnUserStopTyping;
    private delegate bool TestTimeout();

    public TextBox()
    {
        _delayMSE = new ManualResetEvent(false);
        this.TextChanged += new EventHandler(TextBox_TextChanged);
    }

    void TextBox_TextChanged(object sender, EventArgs e)
    {

        _delayMSE.Set();
        Thread.Sleep(20);
        _delayMSE.Reset();

        TestTimeout tester = new TestTimeout(TBDelay);
        tester.BeginInvoke(new AsyncCallback(Test), tester);

    }

    private void Test(IAsyncResult pResult)
    { 
        bool timedOut = (bool)((TestTimeout)pResult.AsyncState).EndInvoke(pResult);
        if (timedOut)
        {
            if (OnUserStopTyping != null)
                OnUserStopTyping(this, null);
        }
    }

    private bool TBDelay()
    { 
        return !_delayMSE.WaitOne(500, false); 
    }

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-23T16:07:28.737

我最终尝试了 Scott Weinstein 的回答，尽管它需要对线程、委托和基本 lambda 语法有更深入的了解。而且效果很好。他的原始答案不是纯粹的复制粘贴，所以我不得不做一些尝试才能让它发挥作用。

我在 Thread.Sleep 中添加的时间很少，因为我注意到如果用户键入速度非常快但某些击键之间的随机延迟很小，则调用方法可能会发生两次。您还必须添加对 WindowsBase 程序集的引用才能使用 Dispatcher。

我使用 1.5 秒来等待用户端输入。

```
 // use manual reset event to Q up waiting threads.
    // each new text changed event clears the Q
    // only the last changed will hit the timeout, triggering the action
    private ManualResetEvent _delayMSE;
    private Func<bool> TBDelay;
    private delegate void ActionToRunWhenUserStopstyping();

    public Form1()
    {
        InitializeComponent();

        _delayMSE = new ManualResetEvent(false);
        TBDelay = () => !_delayMSE.WaitOne(1500, false);
    }

    private void textBox1_TextChanged(object sender, EventArgs e)
    {
        _delayMSE.Set(); 

        // open the ResetEvent gate, to discard these delays    
        Thread.Sleep(20);
        // let all pending through the gate    
        _delayMSE.Reset();
        // close the gate
        TBDelay.BeginInvoke(res =>    
        {        
            // callback code        
            // check how we exited, via timeout or signal.        
            bool timedOut = TBDelay.EndInvoke(res);
            if (timedOut)
                Dispatcher.CurrentDispatcher.Invoke(
                    new ActionToRunWhenUserStopstyping(DoWhatEverYouNeed), 
                    DispatcherPriority.Input);
        }, null);
    }

    private void DoWhatEverYouNeed()
    {
        MessageBox.Show(textBox1.Text);
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-22T22:43:39.607

这取决于您所说的“完成输入”是什么意思。有一个事件可以让您知道用户何时离开了该特定控件的焦点。此外，还有一个更改甚至可以告诉您文本何时更改。你可以做的是捕获两件事：

1) 失去焦点

2）每次用户更改文本时，启动一个计时器，例如 20 秒，如果用户在该时间内完成，则用户“完成”打字。也就是说，如果用户在那段时间内没有做任何事情，则假设用户“完成”。

如果发生这两件事中的任何一个，那么用户就完成了，请确保适当地停止并重新启动计时器。显然，您可以更改超时。

这完全取决于您要如何定义它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-22T23:18:02.177

我过去成功使用的方法使用手动重置事件和异步调用来检测用户何时停止输入。代码看起来像这样

```
// use manual reset event to Q up waiting threads.
// each new text changed event clears the Q
// only the last changed will hit the timeout, triggering the action
private ManualResetEvent _delayMSE;
private Func<bool> TBDelay = () => !_delayMSE.WaitOne(600, false);
private void TextBox_TextChanged(object sender, TextChangedEventArgs e)
{
    SendOrPostCallback ActionToRunWhenUserStopsTyping = o =>
    {
        // ...
    };

    _delayMSE.Set(); // open the ResetEvent gate, to discard these delays
    Thread.Sleep(0); // let all pending through the gate
    _delaySearchMSE.Reset(); // close the gate
    TBDelay.BeginInvoke(res =>
    {
        // callback code
        // check how we exited, via timeout or signal.
        bool timedOut = TBDelay.EndInvoke(res);
        if (timedOut)
            Dispatcher.Invoke(DispatcherPriority.Input, 
                            ActionToRunWhenUserStopstyping,null);
    }, null);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-14T05:59:30.257

'vb.net语言'全局声明

```
Public Tawal as integer 
```

'关于 timer1 属性

```
Timer1.enable = true
Timer1.inverval =1000 
```

'关于程序

```
Timer1.start()
if Tawal <2 then T awal =0
if Tawal >3 then 
   Call FillGrid
   Timer1.stop()
end if 
```

# python - 是否有一个 Python 库可以在不编写太多代码的情况下构建用户界面？

> ID：671741
> 
> 赞同：7
> 
> 时间：2009-03-22T22:49:11.387
> 
> 标签：python, user-interface, sqlite, gtk, glade

几年以来，我一直在用 Python 编写编辑前端，我厌倦了每次都对窗口或对话框的每个 UI 细节进行微观管理。

有没有一种技术可以让我指定 GTK+ Glade 设计的界面与 SQLite 数据库的表和记录之间的关系来完成所有中间人的工作？它应该让我免于手动编写事件处理程序、输入评估器和视图更新的工作。

有问题的技术只是示例，但我想尽可能坚持使用 Python。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T02:53:13.517

除了已经提到的之外，我还可以添加：

*   [猕猴桃](http://www.async.com.br/projects/kiwi/api/kiwi.html)
*   [uxpython](http://www.uxpython.com/)
*   [pygtk](http://www.pygtk.org/)
*   [树松](http://code.google.com/p/treethon/)

我从来没有使用过它们中的任何一个，所以没有任何建议，但是，就其价值而言，我已经使用了至少 2 个直接构建在 pygtk 上的复杂程序，它们在 Windows 和 Linux 中都可以运行。

我认为 Kiwi 是其中唯一一个支持 db 的（通过与 SQLAlchemy、SQLObject 或 Storm 的接口），但如果你不能在任何其他框架中使用其中一个 ORM，我会感到惊讶。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-22T22:58:54.857

PyQt 及其模型可以为您自动执行其中的一些任务（在一定程度上偏离课程，例如用数据库中的数据填充小部件并处理大多数小部件行为、缓冲等）。

如果您想要一种更加面向对象的方法来处理 SQL，您可以查看面向 ORM 的解决方案（例如 SQLAlchemy）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-23T00:37:12.157

[Dabo](http://dabodev.com/)建立在 wxPython 之上，因此您可能不喜欢它，但它的设计目的是使将 GUI 与数据库联系起来变得容易，所以如果您还没有的话，我建议您检查一下。特别是，它有很好的工具将小部件与数据联系起来，并处理许多常见的 GUI 开发案例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T00:04:16.540

[wxGlade](http://en.wikipedia.org/wiki/WxGlade)可能会有所帮助，虽然我自己没有使用过它，所以我不会根据经验说话。

[Boa Constructor](http://en.wikipedia.org/wiki/Boa_constructor)显然有一个 wxPython GUI 构建器，还有[PythonCard](http://pythoncard.sourceforge.net/)，尽管这两个项目的开发似乎已经停滞不前。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T15:34:32.850

特质可能是您的一个不错的选择。 [http://code.enthought.com/projects/traits/docs/html/TUIUG/index.html](http://code.enthought.com/projects/traits/docs/html/TUIUG/index.html)

尽管将 UI 映射到对象很简单，但合并 SQLAlchemy 以实现持久性似乎并不太牵强。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-27T21:41:51.913

有一本关于wxPython的好书，《wxPython in Action》，对于其他一些解决方案来说是不能说的。不敲别人。过去我曾成功地使用 wxPython 进行开发，它附带了一组很棒的演示应用程序，其中包含您可以随意借用的源代码。

我为 wxPython 应用程序找到的最好的 UI 设计师是一个商业的，Anthemion DialogBlocks。它是由 wxPython 程序员之一编写的，物有所值。UI 设计的其他解决方案包括 wxGlade（我发现它有用但没有特色）和 Boa Constructor（没用过）。Wing IDE 可能也有一个。我相信，Stani 的 Python 编辑器捆绑了 wxGlade。还有很多其他项目并没有真正起作用或相当陈旧。

就 SQL 自动化而言，正如另一位回答者所说，我会研究 SQL alchemy，但小型应用程序的学习曲线可能太多，最好直接使用 odbc。最好的 odbc api 是 Django 使用的，pyodbc。

自从我使用这些工具开发以来已经有一段时间了，所以每个工具可能都有更新的东西，但在当时，这些工具在我看来绝对是最好的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T15:43:44.200

我在 wxPython 上取得了很多成功，但那是几年前的事了，可能会有更好的新解决方案......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-19T09:39:09.880

好的，这是一个非常规的解决方案，但为自己编写一个代码生成器。[我已经用Mako](http://www.makotemplates.org/)做过几次了。因此，在我的情况下，我会自动检查一个表，它包含哪些列以及类型并从中生成类。它需要更多的前期工作，但完全符合您的要求，并且可以在后续项目中重复使用。

# windows - 在 Windows 下安全地调用具有管理员权限的命令

> ID：671746
> 
> 赞同：0
> 
> 时间：2009-03-22T22:56:33.710
> 
> 标签：windows, sysadmin

我需要从用户帐户启动的软件中准时调用需要管理员权限的命令（`net share`， ...）。`netsh`

在 Unix 变体下，我会在我的用户模式软件旁边安装一个小而谨慎地编写的带有 suid 位的脚本，它会调用所需的命令。

Microsoft Windows 下的等效最佳实践是什么？我对 Vista 友好但与 XP 兼容的解决方案特别感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T23:02:00.513

一种方法是让服务以管理权限运行。然后从您的应用程序中，告诉服务调用这些命令。我假设您不希望用户被要求知道管理凭据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T23:47:30.763

正如 BobbyShaftoe 所说，在 Windows 中解决此问题的规范方法是通过服务，因为默认情况下服务在 LocalSystem 帐户下执行。任何其他方法都需要以管理员用户身份登录，这需要凭据。

对于 Vista，您需要的额外信息是客户端应用程序需要通过某种形式的 IPC 与服务对话，这种形式可以跨越会话边界，因为在 Vista 上，控制台和服务位于不同的会话中。在这种情况下使用的普通 IPC 方法是命名管道。

同样的解决方案在 XP 中也可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T00:22:25.500

您可以使用 WinAPI 函数[LogonUser](http://msdn.microsoft.com/en-us/library/aa378184(VS.85).aspx)和 [CreateProcessAsUser](http://msdn.microsoft.com/en-us/library/ms682429(VS.85).aspx)以编程方式启动具有不同访问权限的新进程。

对于您的场景，我将使用所需的`net`命令编写一个批处理脚本，如果需要，创建一个新的 cmd.exe 进程，以获取脚本名称作为参数。

此解决方案要求您以某种方式将 LogonUser 中使用的凭据存储在应用程序中，因此可能存在安全风险。

# checksum - 为什么各种项目的下载都有哈希码或校验和？

> ID：671755
> 
> 赞同：3
> 
> 时间：2009-03-22T23:00:38.147
> 
> 标签：checksum, hashcode

从 Internet 下载各种可执行文件或 zip 文件时，我从未使用过校验和。我知道它用于检查一致性并增加一些安全性。但是，当您从 Apache 或 Microsoft 等受人尊敬的项目下载时，是否有必要。我们中有多少人真正使用校验和或哈希码来验证内容？

仅供参考，如果我偏离 StackOverflow 可接受的内容太远，请告诉我。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-22T23:05:48.257

当下载完整性至关重要的文件时（例如linux发行版的iso），我倾向于md5sum下载以防万一。

来源可能是可信的，但您永远不知道您自己的 NIC 硬件何时开始出现故障。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-22T23:19:08.943

另一个用途是验证您已经拥有的文件是否与可从可信来源下载的文件相同（即未更改、未损坏和最新）。

如果发生这种情况

*   您之前已下载该文件
*   您从另一个站点获取了文件
*   您从网络共享中获取了文件
*   有人给了你 CD / 闪存驱动器 / 等上的文件
*   您使用了一些其他方法来避免潜在的长时间下载

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T23:02:21.807

确保您下载的文件是好的文件，而不是其他人恶意修改的文件。正如Apache 中的信息所说[：](http://httpd.apache.org/dev/verification.html)

"*任何攻击者都可以创建一个公钥并将其上传到公钥服务器。然后他们可以创建一个由这个假密钥签名的恶意版本。然后，如果你尝试验证这个损坏版本的签名，它会成功，因为密钥不是‘真正的’密钥。因此，您需要验证此密钥的真实性。* ”

要验证您可以按照[此处](http://httpd.apache.org/download.cgi#verify)的步骤操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-22T23:02:43.460

这样您就可以检查文件的完整性。我用它所有的时间。您基本上只需在文件上运行一些将产生 MD5 校验和或使用任何散列方法的程序，然后查看两个校验和是否匹配。如果不是，那么文件是不同的。但是，请注意，可能有两个文件产生相同的校验和，但是比较两个相同大小的文件时遇到这种情况的可能性非常低，除非您正在设计示例。

这非常有用。我最近发现了一个 CD 刻录程序的错误；我一直对特定计算机上的特定文件有问题。最后我只是比较了CD文件和原电脑上的文件的校验和，它们不同，我能够解决问题！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-22T23:03:16.283

恕我直言，仅当您下载了一个大文件并想在重新下载之前检查它是否已损坏（即，如果应用程序未正确安装）时，它才有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T01:18:54.863

尽管您选择从受信任的来源（例如 Apache.org）下载，但您的下载请求可能会由[镜像](http://en.wikipedia.org/wiki/Mirror_(computing))站点提供。有问题的受信任站点确实拥有满足所有请求的资源，因此镜像具有重要的功能。但是，受信任站点不一定对镜像站点具有完全控制权，并且镜像所有者（或第三方）可能会用恶意代码替换镜像的可执行文件。通过根据下载的文件验证受信任源的哈希值，您可以确保它在传输过程中没有更改（无论出于何种原因）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-23T01:34:11.800

它用于完整性原因（特别是在 ftp 站点上，您可能错误地以 ascii 模式下载）。此外，它可以用来验证下载没有被更改，假设您从位置 a 下载并从位置 b 获取校验和（通常下载来自镜像，并且来自官方站点的哈希）。

但是，出于完整性目的，对文件进行签名将比仅对其进行散列更有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-23T01:49:24.370

我在 Mac OS X 上使用[MacPorts ，它是一个基于源代码的包管理器；](http://www.macports.org)每个 Portfile 都包含有关如何在 Mac OS X 上下载、修补、编译和安装软件的说明。 Portfile 中包含要下载的特定版本 tarball 的校验和。这有助于确保文件的完整性，避免许多可能的问题；有时，人们会在不增加版本号的情况下更新 tarball，这可能会导致补丁无法应用或代码在某些情况下中断，或者有时包可能会损坏，或者攻击者可能会篡改软件你会安装它。

所以，我不得不说，是的，我每次安装软件时都会使用校验和（虽然我的包管理器会自动为我做，但我不直接做）。即使您从一个受人尊敬的项目手动下载，您也希望从更快、更近的镜像下载代码本身，然后根据从更受信任的主服务器下载的副本验证校验和；这有助于使攻击更加困难，因为必须破坏多台服务器，而不仅仅是一个镜像。

# c++ - 关系运算符实现困境

> ID：671760
> 
> 赞同：4
> 
> 时间：2009-03-22T23:04:07.187
> 
> 标签：c++

我正在设计几个需要支持运算符`!=`、`>`、`<=`和的类`>=`。这些运算符将在运算符`==`和`<`.

`std::rel_ops`在这个阶段，我需要在继承¹和强制我的消费者“手动”使用²之间做出选择。

[1] 继承（可能的实现）：

```
template<class T> class RelationalOperatorsImpl
{
    protected:
    RelationalOperatorsImpl() {}
    ~RelationalOperatorsImpl() {}

    friend bool operator!=(const T& lhs, const T& rhs) {return !(lhs == rhs);}
    friend bool operator>(const T& lhs, const T& rhs) {return (rhs < lhs);}
    friend bool operator<=(const T& lhs, const T& rhs) {return !(rhs < lhs);}
    friend bool operator>=(const T& lhs, const T& rhs) {return !(lhs < rhs);}
};

template<typename T> class Foo : RelationalOperatorsImpl< Foo<T> >
{
    public:
    explicit Foo(const T& value) : m_Value(value) {}

    friend bool operator==(const Foo& lhs, const Foo& rhs) {return (lhs.m_Value == rhs.m_Value);}
    friend bool operator<(const Foo& lhs, const Foo& rhs) {return (lhs.m_Value < rhs.m_Value);}

    private:
    T m_Value;
}; 
```

[2]`std::rel_ops`胶水：

```
template<typename T> class Foo
{
    public:
    explicit Foo(const T& value) : m_Value(value) {}

    friend bool operator==(const Foo& lhs, const Foo& rhs) {return (lhs.m_Value == rhs.m_Value);}
    friend bool operator<(const Foo& lhs, const Foo& rhs) {return (lhs.m_Value < rhs.m_Value);}

    private:
    T m_Value;
};

void Consumer()
{
    using namespace std::rel_ops;

    //Operators !=, >, >=, and <= will be instantiated for Foo<T> (in this case) on demand.
} 
```

我基本上是在尝试避免代码重复。关于哪种方法“感觉”更好的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-22T23:30:14.737

您是否考虑过使用[boost](http://www.boost.org/doc/libs/1_38_0/libs/utility/operators.htm)并让您的类继承自`boost::less_than_comparable<T>`and `boost::equality_comparable<T>`？这类似于您的第一个建议，有一些优点和缺点。优点：避免代码重复；缺点：创建对 boost 的依赖。

由于 boost 是一个非常常见的 C++ 库（如果你还没有使用它，你应该认真考虑开始使用它），这个缺点是暗淡的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T04:27:32.417

我认为`std::rel_ops`这很好，但首先要考虑一件事：`std::rel_ops`提供运算符作为模板函数，接受相同类型的两个参数。因为大多数转换（包括例如算术提升和用户定义的转换）在模板参数推导发生时不会执行，这意味着您将无法在`!=`此类转换中使用任何这些附加运算符（例如）。

例如，如果你有一个`MyInt`试图表现得像一个普通整数的类，你可能已经编写了转换函数/构造函数或模板化运算符，这样你就可以做到

```
MyInt x, y;

x < 5;
9 == x; 
```

然而，

```
x > 5;
30 <= x; 
```

将不起作用（使用`std::rel_ops`），因为这两个参数的类型不同，因此模板参数推导将失败。

# sql - Oracle 9i：如何使用元数据确定索引是否是集群的？

> ID：671766
> 
> 赞同：1
> 
> 时间：2009-03-22T23:07:42.573
> 
> 标签：sql, oracle, metadata

这个问题几乎总结了这一点，但我会提供更多细节。

我*几乎*可以安全地假设 Oracle 数据库中的任何主键索引都是集群的。但我不是一个假设。此外，用户可能创建了一个*不是*主键的聚集索引。如果是这样的话，我真的很想知道。

因此，为了*真正*彻底，我想记住（不是我忘记或任何事情），如何从 Oracle 元数据中确定索引是否是集群的。

（而且，像往常一样，谷歌就像在垃圾填埋场扎根，寻找你妈妈读过的老式动作漫画 #1，因为她当时认为它没用。）

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T12:00:45.197

Oracle 没有 SQL Server 那样的“聚集索引”概念。一般来说，Oracle 表是“堆”，其中的数据没有特定的顺序存储。有一种特殊类型的表称为[INDEX ORGANIZED](http://download.oracle.com/docs/cd/B19306_01/server.102/b14220/schema.htm#sthref1047)表，它（顾名思义）是一个像索引一样组织的表。但是，在 Oracle 中，大多数表**都不**是索引组织的——而我的理解是 SQL Server 中的大多数表**都**具有聚集索引。

不要试图将所有的 Oracle 表声明为组织的索引以模拟 SQL Server；适合一个 DBMS 的东西不一定适合另一个 DBMS。我建议您阅读[Oracle 数据库概念指南](http://download.oracle.com/docs/cd/B19306_01/server.102/b14220/toc.htm)以了解 Oracle 的工作原理。

索引组织表由 ALL_TABLES 和 USER_TABLES 中的 IOT_TYPE = 'IOT' 标识。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T23:19:16.587

在 SQL Server 世界中称为聚集索引在 Oracle 世界中称为索引组织表。[表元数据在此处描述](http://download.oracle.com/docs/cd/B28359_01/server.111/b28320/statviews_2105.htm#i1592091)的 all_tables 或 user_tables 系统视图中可用。浏览该链接后，我的猜测是，您可以通过检查 IOT_TYPE 列是否为非空来确定表是索引组织的。

# php - 当您只进行一次选择时，使用准备好的 Select 语句会更好吗？

> ID：671768
> 
> 赞同：4
> 
> 时间：2009-03-22T23:08:52.900
> 
> 标签：php, sql, pdo, prepared-statement

我目前正在使用 PDO 在 PHP 中编写一个 CRUD 类。

我喜欢prepared statements提供的安全性，但我听说它们也阻止了mysql等数据库使用queryCache。

当您一次只做一个选择时，使用准备好的 Select 语句会更好吗？或者只是 $pdo->quote() 从安全角度来看就足够了（或者有任何其他优势，比如缓存？）。

我所有的更新、删除和插入都是使用准备好的语句完成的。我只是对选择感到好奇。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-22T23:29:01.477

MySQLPerformanceBlog.com 在一篇关于“ [Prepared Statements](http://www.mysqlperformanceblog.com/2006/08/02/mysql-prepared-statements/) ”的文章中做了一些基准测试。彼得扎伊采夫写道：

> 我做了一个简单的基准测试（使用 SysBench）来查看使用标准语句、准备好的语句的简单查询（单行点选择）的性能，并从查询缓存中提供服务。Prepared statements 提供 2290 个查询/秒，这明显优于标准语句的 2000 个，但当从查询缓存提供结果时，它仍然远低于 4470 个查询/秒。

这似乎是说使用准备好的语句的“开销”是它们比使用直接查询执行*快*14.5% ，至少在这个简单的测试中是这样。相对差异可能会随着更复杂的查询或更大的结果集而减小。

考虑到服务器的双重往返和其他因素，准备好的查询会更快，这似乎违反直觉。彼得的基准缺乏细节。无论如何，您应该运行自己的测试，因为您运行的查询类型以及您的环境和硬件绝对是重要的因素。

至于查询缓存，过去确实是prepared statements 与缓存查询结果不兼容，但是这已经改变了。请参阅MySQL 文档中的“[查询缓存如何操作”：](http://dev.mysql.com/doc/refman/5.1/en/query-cache-how.html)

> 在 MySQL 5.1.17 之前，prepared statements 不使用查询缓存。从 5.1.17 开始，prepared statements 在某些条件下使用查询缓存，这取决于准备方法： ...

文档继续描述这些条件。去读吧。

我建议使用准备好的语句进行`SELECT`查询。在将变量插入 SQL 语句时引用变量会很有效，前提是您始终如一地这样做。但即使是引用也可能有一些微妙的安全漏洞，例如多字节字符集（参见 MySQL 错误 # [8378](http://bugs.mysql.com/bug.php?id=8378)）。在这些情况下，以安全的方式使用准备好的查询会更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T23:12:06.543

是的，使用准备好的语句。我严重怀疑您是否会遇到性能问题，因为准备好的语句比普通的文字查询运行得慢得多。但是，在 mysql 上，您似乎是正确的。尽管如此，我还是会选择准备好的陈述。

这是一个参考： [http ://www.mysqlperformanceblog.com/2006/08/02/mysql-prepared-statements/](http://www.mysqlperformanceblog.com/2006/08/02/mysql-prepared-statements/)

虽然，如果你担心缓存，你可能想看看[memcached 之](http://www.danga.com/memcached/)类的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T23:18:15.217

这是我的理解，正如以下讨论所证实的那样：[这里](http://www.usenet-forums.com/php-general/394519-php-prepared-statement.html)

> 普通查询被视为单个字符串，被解析、执行并返回。故事结局。将准备好的语句作为模板字符串，进行解析和缓存。然后将变量传递给它，就像函数调用一样。
> 
> 缓存一次查询的成本往往比直接执行要多一点。当您跳过编译步骤时，节省会在以后的调用中出现。您可以为每个重复查询保存编译量。

因此，简而言之，在 MySQL 上，如果您只执行一次查询，准备它只会增加不必要的额外处理量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-22T23:20:53.993

准备好的语句通常被认为是更好的做法。

我建议阅读有关准备好的语句及其实用性和优于传统普通普通插值字符串查询的[MySql 文章。](http://dev.mysql.com/tech-resources/articles/4.1/prepared-statements.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-22T23:26:14.650

您是在应用程序生命周期中只选择“一次”，还是每次调用函数“一次”？

因为如果是后者，您仍然应该从准备好的语句中的缓存中受益。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-22T23:27:51.543

只是提醒一下 MySQL > 5.1.17[确实使用](http://dev.mysql.com/doc/refman/5.1/en/query-cache.html)查询缓存来准备语句。

从代码 POV 来看，我相信准备好的语句在很大程度上是可读性、可维护性等方面的方法......

不使用它们的一个原因是会以某种频率调用昂贵的查询。（查询需要花费大量时间才能运行，并且对查询缓存有真正的好处）。

# database - 有一个没有整数主键的数据库表有什么好的理由吗？

> ID：671773
> 
> 赞同：5
> 
> 时间：2009-03-22T23:12:37.990
> 
> 标签：database, primary-key

虽然我犯了这个罪，但在我看来，没有任何充分的理由让表没有身份字段主键。

优点： - 无论您是否愿意，您现在都可以唯一地识别表中的每一行，这是以前无法做到的 - 如果没有表上的主键，您将无法进行 sql 复制

缺点： - 表的每一行额外的 32 位

例如，考虑需要将用户设置存储在数据库表中的情况。您有一列用于设置名称和一列用于设置值。不需要主键，但是对于您创建的任何表来说，拥有一个整数标识列并将其用作主键似乎是最佳实践。

除了大小之外还有其他原因每个表不应该只有一个整数标识字段吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-22T23:18:36.887

当然，单数据库解决方案中的一个示例是，如果您有一个国家表，使用[ISO 3166-1-alpha-2 国家代码](http://www.iso.org/iso/english_country_names_and_code_elements)作为主键可能更有意义，因为这是一个国际标准，并且查询更具可读性（例如`CountryCode = 'GB'`，相对于`CountryCode = 28`）。类似的论点可以应用于[ISO 4217 货币代码](http://www.iso.org/iso/support/faqs/faqs_widely_used_standards/widely_used_standards_other/currency_codes/currency_codes_list-1.htm)。

在使用复制的 SQL Server 数据库解决方案中，`UNIQUEIDENTIFIER`密钥会更有意义，因为某些类型的复制需要 GUID（如果有多个源数据库，也更容易避免密钥冲突！）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-23T00:17:39.503

*不需要*代理键的表的最明显示例是多对多关系：

```
CREATE TABLE Authorship (
  author_id INT NOT NULL,
  book_id   INT NOT NULL,
  PRIMARY KEY (author_id, book_id),
  FOREIGN KEY (author_id) REFERENCES Authors (author_id),
  FOREIGN KEY (book_id) REFERENCES Books (book_id)
); 
```

在设计标记系统时，我也更喜欢自然键：

```
CREATE TABLE Tags (
  tag VARCHAR(20) PRIMARY KEY
);

CREATE TABLE ArticlesTagged (
  article_id INT NOT NULL,
  tag        VARCHAR(20) NOT NULL,
  PRIMARY KEY (article_id, tag),
  FOREIGN KEY (article_id) REFERENCES Articles (article_id),
  FOREIGN KEY (tag) REFERENCES Tags (tag)
); 
```

`tag_id`这比使用代理“ ”键有一些优势：

*   您可以确保标签是唯一的，而无需添加多余的`UNIQUE`约束。
*   您可以防止两个不同的标签具有完全相同的拼写。
*   引用标签的从属表已经有标签文本；他们无需加入即可`Tags`获取文本。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-22T23:16:19.807

每个表都应该有一个主键。它是整数、GUID 还是“设置名称”列都没有关系。类型取决于应用程序的要求。理想情况下，如果要将表连接到另一个表，最好使用 GUID 或整数作为主键。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-22T23:18:56.337

是的，有充分的理由。您可以拥有语义上有意义的真实密钥，而不是人为的身份密钥。此外，为多对多表设置单独的自动递增主键也不是一个好主意。出于某些原因，您可能希望选择 GUID。

话虽如此，我通常使用自动递增的 64 位整数作为主键。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-22T23:23:18.433

每个表都应该有一个主键。但它不需要是单个字段标识符。以财务系统为例，您可能将日记帐表上的主键作为日记帐 ID 和行号。这将为每一行生成唯一的组合（日记帐 ID 将是其自己表中的主键）

您的主键需要定义如何将表链接到其他表。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-22T23:24:51.440

我不认为每个表都需要一个主键。有时您只想通过*它们的*主键“连接”两个表的内容。

所以你有一个表`users`和一个表`groups`（每个都有主键），你有第三个表`users_groups`，只有两个列（用户和组），其中用户和组相互连接。

例如，用户 = 3 和组 = 6 的行会将主键为 3 的用户链接到主键为 6 的组。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-22T23:25:22.437

不将主键定义为身份的一个原因是将主键定义为 GUID 或填充有外部生成的值。

一般来说，每一个本身具有语义意义的表都应该有主键，而主键应该没有语义意义。实现多对多关系的连接表本身没有意义，因此它不需要这样的主键（它已经通过它的值有一个）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-22T23:22:16.003

要成为一个正确规范化的表，每一行应该只有一个可识别的键。许多表已经具有自然键，例如唯一的发票号。我同意，尤其是在存储如此便宜的情况下，在所有表上都有一个自动编号/身份键几乎没有开销，但在这种情况下，这是真正的键。

如果用于参考数据，我个人不使用此方法的另一个领域，通常我们有一个描述和一个值

```
Code, Description
'L', 'Live'
'O', 'Old'
'P', 'Pending' 
```

在这种情况下，将代码设置为主键可确保没有重复，并且更易于阅读。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-12-11T14:12:54.587

自然主键和代理主键之间的*关键区别*（对不起）是自然键的值包含信息，而代理键的值不包含信息。

为什么这很重要？那么自然主键根据定义保证是唯一的，但它的值通常*不能*保证保持不变。当它改变时，你必须在多个地方更新它。

代理键的值没有实际意义，只是用于标识该行，因此永远不需要更改。它是模型的一个特征，而不是域本身。

所以我要说代理键不合适的唯一地方是关联表，它只包含引用其他表中行的列（大多数多对多关系）。该表携带的唯一信息是两行（或多行）之间的关联，并且它已经仅由代理键值组成。在这种情况下，我会选择一个复合主键。

如果这样的表具有包语义，或者带有有关关联的附加信息，我将添加一个代理键。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-13T16:59:09.267

主键总是一个好主意。它允许非常快速和轻松地加入表格。它帮助可以读取系统表的外部工具进行连接，从而允许不太熟练的人通过拖放创建自己的查询。它还使参照完整性的实现变得轻而易举，这从一开始就是一个好主意。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-10-11T11:07:35.957

我确信为网络巨头工作的一些非常聪明的人会这样做。虽然我不知道为什么他们自己的原因，但我知道 PK-less 表有意义的 2 种情况：

*   导入数据。该表是临时的。插入和全表扫描需要尽可能快。此外，我们需要接受重复记录。稍后我们将清理数据，但导入过程需要工作。
*   DBMS 中的分析。识别一行没有用——如果我们需要这样做，那不是分析。我们只需要一个看起来像表格的非关系、冗余、可怕的 blob。我们将通过编写适当的 SQL 查询来构建汇总表或物化视图。

Note that these cases have good reasons to be non-relational. But normally your tables should be relational, so... yes, they need a primary key.

# bug-tracking - 漏洞维护系统

> ID：671777
> 
> 赞同：0
> 
> 时间：2009-03-22T23:14:30.997
> 
> 标签：bug-tracking

我最近花了很多时间阅读有关调试的信息。不断引用的方面之一不仅仅是错误跟踪系统，而是错误解决过程。我读到有人写下对问题的看法（有效或无效），测试将确定给定的修复方法是否有效，等等。

所以我在想，“嘿，这是个好主意”

我现在使用 Mantis，它似乎没有这种能力（没有滥用它的领域）。Mantis 非常适合作为错误记录器。但我认为，我正在寻找界面更复杂的东西。

# 例子

假设我的错误是“裤子掉了”。然后我想将此信息记录为...

“裤子掉了，2009年2月32日25点61分，我走进房间，裤子掉了！”

开发商一...

假设1：裤子太大。

测试一：系上腰带。

可能的解决方案 1：购买皮带。

结果 = ?? 结果 ？？？

测试2：穿上你妹妹的裤子。

可能的解决方案 2：在她上学的时候偷走她的房间并拿走她所有的裤子！

结果 = ??，日期/时间 = ???

开发商 2...

假设 2：你的裤子上有洞。

测试1：照亮他们。

可能的解决方案：购买新裤子。

结果 = ???，日期/时间 = ???

* * *

现在，这是一个愚蠢的例子。但我认为拥有作为软件工具会很棒。是否存在，如果存在，它叫什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T23:24:13.253

相信我：你真的不想维护你的错误，这就是为什么你找不到“错误维护系统”:-)

抱歉……忍不住了。关于您问题的实际内容：我个人只是在票的评论历史记录中跟踪所有这些信息。大多数情况下，我使用[trac](http://trac.edgewall.org/)是因为它的简单性，但也可以在需要时链接到源代码（至少在文件级别，我希望它能够识别代码，以便您可以指向 AST）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T00:09:36.670

您可以使用[Testopia](http://www.mozilla.org/projects/testopia/)，它是[Bugzilla](http://www.bugzilla.org/)的扩展。当然，这也意味着您需要使用 Bugzilla。

取自 Testopia 网站：

Testopia 是 Bugzilla 的测试用例管理扩展。它旨在成为跟踪测试用例的通用工具，允许测试组织将错误报告与其测试用例运行结果集成。尽管它在设计时考虑了软件测试，但它可用于跟踪工程过程中几乎所有内容的测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T00:11:56.180

我们也使用 Mantis，就像 Peter Becker 所描述的那样，我们使用注释来描述关于 bug 的工作。这通常是有效的，因为大多数错误没有这么长的历史。

如果一个 bug 的工作变得如此复杂以至于需要自己的会议和会议记录，我们通常会在我们的主要工作计划系统中创建一个任务并在那里进行讨论（来自 Mantis 的链接）。这至少对我们有用。

无论如何，我会警惕试图明确支持特定工作流程的系统，因为这些系统也会将您锁定在他们期望的工作流程中。在寻找错误的过程中，工作流程可能因错误而异...

最后，请注意，Mantis 还允许您编辑您的评论。因此，您可以更改旧注释以避免混淆错误报告。

# c - sizeof(Array) 是如何工作的

> ID：671790
> 
> 赞同：66
> 
> 时间：2009-03-22T23:20:23.947
> 
> 标签：c, arrays

c如何在运行时找到数组的大小？有关数组大小或数组边界的信息在哪里存储？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-03-22T23:31:29.867

`sizeof(array)`完全由 C 编译器实现。到程序链接时，看起来像是`sizeof()`对您的调用已转换为常量。

示例：当您编译此 C 代码时：

```
#include <stdlib.h>
#include <stdio.h>
int main(int argc, char** argv) {
    int a[33];
    printf("%d\n", sizeof(a));
} 
```

你得到

```
 .file   "sz.c"
    .section        .rodata
.LC0:
    .string "%d\n"
    .text
.globl main
    .type   main, @function
main:
    leal    4(%esp), %ecx
    andl    $-16, %esp
    pushl   -4(%ecx)
    pushl   %ebp
    movl    %esp, %ebp
    pushl   %ecx
    subl    $164, %esp
    movl    $132, 4(%esp)
    movl    $.LC0, (%esp)
    call    printf
    addl    $164, %esp
    popl    %ecx
    popl    %ebp
    leal    -4(%ecx), %esp
    ret
    .size   main, .-main
    .ident  "GCC: (GNU) 4.1.2 (Gentoo 4.1.2 p1.1)"
    .section        .note.GNU-stack,"",@progbits 
```

中间`$132`是数组的大小，132 = 4 * 33。请注意，没有`call sizeof`指令 - 不像`printf`，这是一个真正的函数。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-23T00:01:05.147

sizeof 是 C99 之前的 C++ 和 C 中的纯编译时间。从 C99 开始，有可变长度数组：

```
// returns n + 3
int f(int n) {
    char v[n + 3];

    // not purely a compile time construct anymore
    return sizeof v;
} 
```

这将评估`sizeof`操作数，因为`n`在编译时还不知道。这*仅*适用于可变长度数组：其他操作数或类型仍然在编译时进行 sizeof 计算。特别是，在编译时已知维度的数组仍然像在 C++ 和 C89 中一样处理。因此，返回的值`sizeof`不再是编译时常量（常量表达式）。你不能在需要这样一个值的地方使用它——例如在初始化静态变量时，除非编译器特定的扩展允许它（C标准允许实现对它视为常量的内容进行扩展）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-22T23:24:22.130

`sizeof()`仅适用于固定大小的数组（可以是静态的、基于堆栈的或在结构中）。

如果将其应用于使用`malloc`（或 C++ 中的新）创建的数组，您将始终获得指针的大小。

是的，这是基于编译时间信息。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-22T23:29:19.073

`sizeof`给出变量的大小，而不是您指向的对象的大小（如果有的话）。`sizeof(arrayVar)`当且仅当`arrayVar`在范围内声明为数组而不是指针时，才会返回以字节为单位的数组大小。

例如：

```
char myArray[10];
char* myPtr = myArray;

printf("%d\n", sizeof(myArray)) // prints 10 
printf("%d\n", sizeof(myPtr)); // prints 4 (on a 32-bit machine) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-22T23:25:27.460

sizeof(Array) 在编译时查找，而不是在运行时查找。不存储信息。

您是否对实施边界检查感兴趣？如果是这样，有许多不同的方法可以解决这个问题。

# jquery - jQuery tablesorter + 调整列宽

> ID：671791
> 
> 赞同：10
> 
> 时间：2009-03-22T23:20:48.893
> 
> 标签：jquery, resize, tablesorter

是否有一个用于调整表列大小的[jQuery](http://en.wikipedia.org/wiki/JQuery)插件，可与 tablesorter 一起使用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-10-31T05:22:04.167

你应该试试[colResizable](http://quocity.com/colresizable)插件。它允许手动调整列的大小，而且它的大小很小（2.8 KB），并且不需要任何其他库或样式表。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-07-05T21:00:02.313

看起来[Flexigrid](http://www.flexigrid.info/)拥有您可能想要的一切。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-06-09T09:49:57.357

用于添加可调整大小列的一个非常简单的插件是[SimpleResizableTable.js](http://robau.wordpress.com/2011/08/16/unobtrusive-table-column-resize-with-jquery-as-plugin/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T01:15:49.037

看起来[jquery.kiketable.colsizable 可以满足](http://www.ita.es/jquery/jquery.kiketable.colsizable.htm)您的需要。

另一个看起来不错的是[Ingrid，即 jQuery Datagrid](http://www.reconstrukt.com/ingrid/)。它具有更多功能，并且可以在不使用 tablesorter 的情况下对列进行排序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-04T10:39:38.167

可以使用 jQuery UI Resizable 插件来调整列的大小。该插件不能直接调整 TH 元素的大小，但更好的是 COLGROUP > COL 元素，这使得浏览器渲染速度非常快并启用了正确的 HTML。

更多评估、现场演示和完整代码可以在博客文章*[Resizable Table Columns with jQuery UI](http://ihofmann.wordpress.com/2012/07/31/resizable-table-columns-with-jquery-ui/)*中找到。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T03:41:27.503

如果您没有找到 tablesorter 的插件，[jQuery Grid Plugin](http://www.trirand.com/blog/)（仍处于 alpha 阶段）会调整列的大小。

# validation - Microsoft 代码合同框架有多成熟？

> ID：671809
> 
> 赞同：43
> 
> 时间：2009-03-22T23:31:34.903
> 
> 标签：validation, .net-4.0, code-contracts, microsoft-contracts

微软最近在 DevLabs 上发布了他们的[Code Contracts框架，并获得了商业许可。](http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx)我们有兴趣在我们的项目中使用它们（主要是 C#，一些 C++/CLI）来逐步替换所有自定义验证代码，但我很想知道在我们承诺之前其他人使用它的经验，具体来说：

*   您认为该框架对于大型复杂的商业项目是否足够成熟？

*   你在使用过程中遇到了什么问题？

*   你从中得到了什么好处？

*   目前是否比它的价值更痛苦？

我意识到这是一个有点主观的问题，因为它需要意见，但鉴于这个框架是 .NET 4.0 的一个非常重要的部分，并且会（可能）改变我们所有人编写验证代码的方式，我希望这个问题将被留下愿意收集有关该主题的经验，以帮助我对一个具体的、可回答的问题做出决定：

> 我们应该下个月开始使用它吗？

请注意，我们不提供代码 API，仅提供 Web 服务，因此对于大多数代码破坏兼容性而言，抛出的异常类型不是问题。然而，由于我希望更多的人能从这篇文章及其答案中受益，因此任何关于这个领域的细节都非常受欢迎。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2010-08-09T02:07:48.310

对此的最后一次成熟响应是在 2009 年，.NET 4 已经发布。我想我们该更新了：

**对于您的 Debug 版本，代码契约可能已经足够成熟了。**

我意识到这在某种程度上是从“无害”到“几乎无害”的升级。

[Code Contracts 主页](http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx "代码合同主页")链接到 PDF 格式的完整文档。该文档在第 5 节中概述了使用指南。总而言之，**您可以选择您**对合约工具在您的发布版本中重写您的 IL 的感觉有多勇敢。

我们正在使用“不要重写我的 Release IL”模式。

到目前为止，我最喜欢这个意想不到的好处：代码更少，因此**要测试**的代码也更少。你所有的保护条款都消失了。

```
if(arg != null) { 
    throw new ArgumentNullException("arg"); 
}
// Blank line here insisted upon by StyleCop 
```

变成：

```
Contract.Requires(arg != null); 
```

你的功能更短。**你的意图更清楚。**而且，您不再需要编写名为 ArgumentShouldNotBeNull 的测试来达到 100% 的覆盖率。

到目前为止，我遇到了两个问题：

*   我有一个依赖于合同失败的单元测试来成功。您可能会争辩说测试的存在是一个错误，但我想以测试的形式记录这一特殊的禁令。我的构建服务器上的测试失败了，因为我没有安装这些工具。解决方法：安装工具。

*   我们使用了两种重写 IL 的工具：[Code Contracts](http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx "代码合同主页")和[PostSharp](http://www.sharpcrafters.com/postsharp "SharpCrafters PostSharp")。他们相处得不太好。PostSharp 的 2.0.8.1283 解决了这个问题。不过，我会谨慎评估*任何*两种 IL 重写工具如何相处。

到目前为止，利大于弊。

解决其他答案中提出的过时问题：

*   Code Contracts 的文档非常详尽，但遗憾的是 PDF 格式。
*   至少有一个由 Microsoft 托管的[代码合同论坛。](http://social.msdn.microsoft.com/Forums/en-US/codecontracts/threads/)
*   如果您有任何 VS2010 许可证，Code Contracts 标准版是免费的。
*   .NET 4 出来了。在实现通用集合接口时，我遇到了微软的合同。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-26T20:11:10.953

在一个小型但中等复杂的独立项目中，我自己一直在玩代码协定，该项目需要从一些 BCL 类继承并使用其他类。

当您在仅使用自己的代码和原始类型的完全隔离的环境中工作时，合同看起来很棒，但是一旦您开始使用 BCL 类（在 .NET 4.0 之前没有自己的合同），验证者就无法检查它们是否会违反任何要求/确保/不变量，因此您会收到很多关于潜在未满足约束的警告。

另一方面，它确实发现了一些无效或可能不满足的约束，这些约束可能是真正的错误。但是很难找到这些，因为噪音太大，很难找出可以修复的那些。可以通过使用假设机制来抑制来自 BCL 类的警告，但这有点弄巧成拙，因为这些类将来会有合同，并且假设会降低它们的价值。

所以我的感觉是，就目前而言，因为在 3.5 中我们正在尝试构建一个验证者没有充分理解的框架，所以可能值得等待 4.0。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-23T13:31:19.520

从[这个线程](http://social.msdn.microsoft.com/Forums/en-US/pex/thread/14115b4d-52c1-4e93-89cd-19db3fd86756/ "这个线程")来看，我会说它还不够成熟，无法用于企业级项目。我自己没有使用过它，但人们仍然会遇到错误，这些错误会使你的合同关键项目停止。这似乎是一个非常棒的框架，他们提供的示例视频令人兴奋，但我会等待：

*   **社区论坛的存在。**您将希望能够与其他开发人员讨论您遇到的不可避免的问题，并且您想知道有相当强大的开发人员基础可以与他们讨论解决方案。
*   **成功的试点项目发布。**一般来说，当微软研究院发布了他们认为已经成熟到可以用于商业项目的东西时，他们会与组织合作进行试点，然后将该项目开源作为概念证明和试运行的所有主要功能。这会给大多数常见的合同场景都涵盖并有效的信心。
*   **更完整的文档。**简单明了，在某些时候，您会想要使用 Microsoft Code Contracts 无法完成的合同来做一些事情。您希望能够快速而清晰地推断出您的方案*尚不受支持。*当前的文档将让您不断猜测和尝试不同的事情，但在我看来，这将导致大量时间浪费。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-27T13:58:29.157

还不够成熟。

一旦微软发布了价格实惠的 VS 版本，它就会立即发布，但如果没有静态代码分析，它就根本不可用。

拥有它的 VS 版本非常昂贵，只有少数人能够负担得起。

令人遗憾的是，微软用他们的定价政策扼杀了这个惊人的想法。我希望代码合同会成为主流，但他们不会。

史诗般的失败。

# c - 在C中找到整数中最高设置位（msb）的最快/最有效方法是什么？

> ID：671815
> 
> 赞同：141
> 
> 时间：2009-03-22T23:37:22.877
> 
> 标签：c, algorithm, optimization, bit-manipulation

如果我有一些整数 n，并且我想知道最高有效位的位置（也就是说，如果最低有效位在右边，我想知道最左边的位是 1 的位置），找出最快/最有效的方法是什么？

我知道 POSIX 支持`ffs()`在 strings.h 中找到第一个设置位的方法，但似乎没有相应的`fls()`方法。

是否有一些我想念的非常明显的方法？

如果您不能使用 POSIX 函数来实现可移植性，那该怎么办？

编辑：一个适用于 32 位和 64 位架构的解决方案怎么样（许多代码清单似乎只适用于 32 位整数）。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-03-23T15:16:34.103

[海合会有](http://gcc.gnu.org/onlinedocs/gcc-4.8.0/gcc/Other-Builtins.html)：

```
-- 内置函数：int __builtin_clz (unsigned int x)
     返回 X 中前导 0 位的数量，从最多开始
     重要位的位置。如果 X 为 0，则结​​果未定义。

 -- 内置函数：int __builtin_clzl (unsigned long)
     类似于`__builtin_clz'，除了参数类型是`unsigned
     长'。

 -- 内置函数：int __builtin_clzll (unsigned long long)
     类似于`__builtin_clz'，除了参数类型是`unsigned
     长长'。
```

我希望它们被翻译成对您当前平台相当有效的东西，无论是那些花哨的位旋转算法之一，还是一条指令。

* * *

如果您的输入*可以*为零，则一个有用的技巧是`__builtin_clz(x | 1)`：无条件地设置低位而不修改任何其他使输出`31`为`x=0`，而不更改任何其他输入的输出。

为避免需要这样做，您的另一个选择是特定于平台的内在函数，如 ARM GCC `__clz`（不需要标头）或`_lzcnt_u32`支持该`lzcnt`指令的 CPU 上的 x86。（请注意，在较旧的 CPU 上`lzcnt`解码`bsr`而不是故障，这会为非零输入提供 31-lzcnt。）

不幸的是，没有办法可移植地利用非 x86 平台上的各种 CLZ 指令，这些指令确实将 input=0 的结果定义为 32 或 64（根据操作数宽度）。x86`lzcnt`也这样做，同时`bsr`生成一个位索引，除非您使用`31-__builtin_clz(x)`.

（“未定义的结果”不是 C 未定义的行为，只是一个未定义的值。它实际上是指令运行时目标寄存器中的任何内容。AMD 记录了这一点，英特尔没有，但英特尔的 CPU 确实实现了这种行为。但它*不是*您分配给的 C 变量中的任何内容，当 gcc 将 C 转换为 asm 时，事情通常不是这样工作的。另请参阅[为什么打破 LZCNT 的“输出依赖关系”很重要？](https://stackoverflow.com/questions/21390165/why-does-breaking-the-output-dependency-of-lzcnt-matter/)）

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2011-02-11T15:31:26.587

由于 2^N 是仅设置第 N 位 (1 << N) 的整数，因此找到最高设置位的位置 (N) 是该整数的整数对数基数 2。

[http://graphics.stanford.edu/~seander/bithacks.html#IntegerLogObvious](http://graphics.stanford.edu/~seander/bithacks.html#IntegerLogObvious)

```
unsigned int v;
unsigned r = 0;

while (v >>= 1) {
    r++;
} 
```

这种“显而易见”的算法可能对每个人都不是透明的，但是当你意识到代码重复右移一位直到最左边的位被移走（注意 C 将任何非零值视为真）并返回数字时轮班，这是完全合理的。这也意味着即使设置了多个位，它也可以工作——结果始终是最高有效位。

如果您在该页面上向下滚动，则会出现更快、更复杂的变化。但是，如果您知道您正在处理具有许多前导零的数字，那么简单的方法可能会提供可接受的速度，因为 C 中的位移相当快，并且简单的算法不需要索引数组。

**注意：**当使用 64 位值时，使用特别聪明的算法要格外小心；其中许多仅适用于 32 位值。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2009-03-23T00:00:51.713

假设您在 x86 和游戏中使用一些内联汇编程序，英特尔提供了一条[`BSR`](https://c9x.me/x86/html/file_module_x86_id_20.html)指令（“位扫描反向”）。在*某些*x86 上它[很快](https://gmplib.org/~tege/x86-timing.pdf)（在其他上微编码）。从手册：

 *> 在源操作数中搜索最高有效设置位（1 位）。如果找到最高有效位 1，则将其位索引存储在目标操作数中。源操作数可以是寄存器或内存位置；目标操作数是一个寄存器。位索引是源操作数位 0 的无符号偏移量。如果内容源操作数为 0，则目标操作数的内容未定义。

（如果您使用的是 PowerPC，则有类似的`cntlz`（“计算前导零”）指令。）

gcc 的示例代码：

```
#include <iostream>

int main (int,char**)
{
  int n=1;
  for (;;++n) {
    int msb;
    asm("bsrl %1,%0" : "=r"(msb) : "r"(n));
    std::cout << n << " : " << msb << std::endl;
  }
  return 0;
} 
```

另请参阅这个[内联汇编器教程](https://doc.lagout.org/network/alp-folder/alp-ch09-inline-asm.pdf)，它显示（第 9.4 节）它比循环代码快得多。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-03-22T23:49:25.843

这有点像寻找一种整数对数。有一些小技巧，但我已经为此制作了自己的工具。目标当然是速度。

我的认识是 CPU 已经有一个自动位检测器，用于整数到浮点数的转换！所以用那个。

```
double ff=(double)(v|1);
return ((*(1+(uint32_t *)&ff))>>20)-1023;  // assumes x86 endianness 
```

此版本将值转换为双精度值，然后读取指数，它会告诉您该位的位置。花哨的移位和减法是从 IEEE 值中提取适当的部分。

使用浮点数稍微快一点，但浮点数只能给你前 24 位的位置，因为它的精度更小。

* * *

为了安全地做到这一点，在 C++ 或 C 中没有未定义的行为，请使用`memcpy`指针转换来代替类型双关语。编译器知道如何有效地内联它。

```
// static_assert(sizeof(double) == 2 * sizeof(uint32_t), "double isn't 8-byte IEEE binary64");
// and also static_assert something about FLT_ENDIAN?

double ff=(double)(v|1);

uint32_t tmp;
memcpy(&tmp, ((const char*)&ff)+sizeof(uint32_t), sizeof(uint32_t));
return (tmp>>20)-1023; 
```

或者在 C99 及更高版本中，使用`union {double d; uint32_t u[2];};`. 但请注意，在 C++ 中，联合类型双关语仅在某些编译器上作为扩展支持，在 ISO C++ 中不支持。

* * *

这通常比前导零计数指令的特定于平台的内在函数要慢，但可移植的 ISO C 没有这样的功能。一些 CPU 还缺少前导零计数指令，但其中一些可以有效地将整数转换为`double`. 但是，将 FP 位模式键入回整数可能会很慢（例如，在 PowerPC 上，它需要存储/重新加载，并且通常会导致加载-命中-存储停顿）。

该算法可能对 SIMD 实现有用，因为更少的 CPU 具有 SIMD `lzcnt`。x86 只有[AVX512CD才有这样的指令](https://github.com/HJLebbink/asm-dude/wiki/VPLZCNTD_Q)

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2009-03-23T00:32:11.123

这应该是闪电般的速度：

```
int msb(unsigned int v) {
  static const int pos[32] = {0, 1, 28, 2, 29, 14, 24, 3,
    30, 22, 20, 15, 25, 17, 4, 8, 31, 27, 13, 23, 21, 19,
    16, 7, 26, 12, 18, 6, 11, 5, 10, 9};
  v |= v >> 1;
  v |= v >> 2;
  v |= v >> 4;
  v |= v >> 8;
  v |= v >> 16;
  v = (v >> 1) + 1;
  return pos[(v * 0x077CB531UL) >> 27];
} 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2011-12-11T07:43:13.517

Kaz Kylheku 在这里

我针对超过 63 位数字（gcc x86_64 上的 long long 类型）对两种方法进行了基准测试，远离符号位。

（我碰巧需要这个“找到最高位”来做某事，你看。）

我实现了数据驱动的二进制搜索（密切基于上述答案之一）。我还手动实现了一个完全展开的决策树，它只是带有立即操作数的代码。没有循环，没有表格。

决策树 (highest_bit_unrolled) 的基准测试速度提高了 69%，但二进制搜索具有显式测试的 n = 0 情况除外。

二进制搜索对 0 情况的特殊测试仅比没有特殊测试的决策树快 48%。

编译器、机器：（GCC 4.5.2、-O3、x86-64、2867 Mhz Intel Core i5）。

```
int highest_bit_unrolled(long long n)
{
  if (n & 0x7FFFFFFF00000000) {
    if (n & 0x7FFF000000000000) {
      if (n & 0x7F00000000000000) {
        if (n & 0x7000000000000000) {
          if (n & 0x4000000000000000)
            return 63;
          else
            return (n & 0x2000000000000000) ? 62 : 61;
        } else {
          if (n & 0x0C00000000000000)
            return (n & 0x0800000000000000) ? 60 : 59;
          else
            return (n & 0x0200000000000000) ? 58 : 57;
        }
      } else {
        if (n & 0x00F0000000000000) {
          if (n & 0x00C0000000000000)
            return (n & 0x0080000000000000) ? 56 : 55;
          else
            return (n & 0x0020000000000000) ? 54 : 53;
        } else {
          if (n & 0x000C000000000000)
            return (n & 0x0008000000000000) ? 52 : 51;
          else
            return (n & 0x0002000000000000) ? 50 : 49;
        }
      }
    } else {
      if (n & 0x0000FF0000000000) {
        if (n & 0x0000F00000000000) {
          if (n & 0x0000C00000000000)
            return (n & 0x0000800000000000) ? 48 : 47;
          else
            return (n & 0x0000200000000000) ? 46 : 45;
        } else {
          if (n & 0x00000C0000000000)
            return (n & 0x0000080000000000) ? 44 : 43;
          else
            return (n & 0x0000020000000000) ? 42 : 41;
        }
      } else {
        if (n & 0x000000F000000000) {
          if (n & 0x000000C000000000)
            return (n & 0x0000008000000000) ? 40 : 39;
          else
            return (n & 0x0000002000000000) ? 38 : 37;
        } else {
          if (n & 0x0000000C00000000)
            return (n & 0x0000000800000000) ? 36 : 35;
          else
            return (n & 0x0000000200000000) ? 34 : 33;
        }
      }
    }
  } else {
    if (n & 0x00000000FFFF0000) {
      if (n & 0x00000000FF000000) {
        if (n & 0x00000000F0000000) {
          if (n & 0x00000000C0000000)
            return (n & 0x0000000080000000) ? 32 : 31;
          else
            return (n & 0x0000000020000000) ? 30 : 29;
        } else {
          if (n & 0x000000000C000000)
            return (n & 0x0000000008000000) ? 28 : 27;
          else
            return (n & 0x0000000002000000) ? 26 : 25;
        }
      } else {
        if (n & 0x0000000000F00000) {
          if (n & 0x0000000000C00000)
            return (n & 0x0000000000800000) ? 24 : 23;
          else
            return (n & 0x0000000000200000) ? 22 : 21;
        } else {
          if (n & 0x00000000000C0000)
            return (n & 0x0000000000080000) ? 20 : 19;
          else
            return (n & 0x0000000000020000) ? 18 : 17;
        }
      }
    } else {
      if (n & 0x000000000000FF00) {
        if (n & 0x000000000000F000) {
          if (n & 0x000000000000C000)
            return (n & 0x0000000000008000) ? 16 : 15;
          else
            return (n & 0x0000000000002000) ? 14 : 13;
        } else {
          if (n & 0x0000000000000C00)
            return (n & 0x0000000000000800) ? 12 : 11;
          else
            return (n & 0x0000000000000200) ? 10 : 9;
        }
      } else {
        if (n & 0x00000000000000F0) {
          if (n & 0x00000000000000C0)
            return (n & 0x0000000000000080) ? 8 : 7;
          else
            return (n & 0x0000000000000020) ? 6 : 5;
        } else {
          if (n & 0x000000000000000C)
            return (n & 0x0000000000000008) ? 4 : 3;
          else
            return (n & 0x0000000000000002) ? 2 : (n ? 1 : 0);
        }
      }
    }
  }
}

int highest_bit(long long n)
{
  const long long mask[] = {
    0x000000007FFFFFFF,
    0x000000000000FFFF,
    0x00000000000000FF,
    0x000000000000000F,
    0x0000000000000003,
    0x0000000000000001
  };
  int hi = 64;
  int lo = 0;
  int i = 0;

  if (n == 0)
    return 0;

  for (i = 0; i < sizeof mask / sizeof mask[0]; i++) {
    int mi = lo + (hi - lo) / 2;

    if ((n >> mi) != 0)
      lo = mi;
    else if ((n & (mask[i] << lo)) != 0)
      hi = mi;
  }

  return lo + 1;
} 
```

快速而肮脏的测试程序：

```
#include <stdio.h>
#include <time.h>
#include <stdlib.h>

int highest_bit_unrolled(long long n);
int highest_bit(long long n);

main(int argc, char **argv)
{
  long long n = strtoull(argv[1], NULL, 0);
  int b1, b2;
  long i;
  clock_t start = clock(), mid, end;

  for (i = 0; i < 1000000000; i++)
    b1 = highest_bit_unrolled(n);

  mid = clock();

  for (i = 0; i < 1000000000; i++)
    b2 = highest_bit(n);

  end = clock();

  printf("highest bit of 0x%llx/%lld = %d, %d\n", n, n, b1, b2);

  printf("time1 = %d\n", (int) (mid - start));
  printf("time2 = %d\n", (int) (end - mid));
  return 0;
} 
```

仅使用-O2，差异会变得更大。决策树几乎快四倍。

我还对天真的位移代码进行了基准测试：

```
int highest_bit_shift(long long n)
{
  int i = 0;
  for (; n; n >>= 1, i++)
    ; /* empty */
  return i;
} 
```

正如人们所期望的那样，这仅对少数人来说很快。在确定 n == 1 的最高位为 1 时，它的基准测试速度提高了 80% 以上。但是，在 63 位空间中随机选择的数字中有一半设置了第 63 位！

在输入 0x3FFFFFFFFFFFFFFF 上，决策树版本比在 1 上的要快很多，并且比移位器快 1120%（12.2 倍）。

我还将针对 GCC 内置函数对决策树进行基准测试，并尝试混合输入，而不是针对相同的数字重复。可能会出现一些粘滞分支预测，可能还有一些不切实际的缓存场景，这使得它在重复时人为地更快。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-03-22T23:46:27.130

虽然我可能只在绝对需要最佳性能时才使用这种方法（例如，编写某种涉及位板的棋盘游戏 AI），但最有效的解决方案是使用内联 ASM。请参阅[此博客文章](http://www.barik.net/archive/2004/11/25/185507/)的优化部分以获取带有解释的代码。

> [...]，`bsrl`汇编指令计算最高有效位的位置。因此，我们可以使用以下`asm`语句：
> 
> ```
> asm ("bsrl %1, %0" 
>      : "=r" (position) 
>      : "r" (number)); 
> ```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-03-23T03:21:45.957

```
unsigned int
msb32(register unsigned int x)
{
        x |= (x >> 1);
        x |= (x >> 2);
        x |= (x >> 4);
        x |= (x >> 8);
        x |= (x >> 16);
        return(x & ~(x >> 1));
} 
```

1个寄存器，13条指令。信不信由你，这通常比上面提到的 BSR 指令快，后者在线性时间内运行。这是对数时间。

来自[http://aggregate.org/MAGIC/#Most%20Significant%201%20Bit](http://aggregate.org/MAGIC/#Most%20Significant%201%20Bit)

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-12-01T01:17:13.527

关于什么

```
int highest_bit(unsigned int a) {
    int count;
    std::frexp(a, &count);
    return count - 1;
} 
```

?

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2011-07-08T14:20:26.307

以下是本页当前给出的算法的一些（简单）基准......

该算法尚未针对 unsigned int 的所有输入进行测试；所以在盲目使用之前先检查一下；）

在我的机器上 clz (__builtin_clz) 和 asm 效果最好。asm 似乎比 clz 更快...但这可能是由于简单的基准测试...

```
//////// go.c ///////////////////////////////
// compile with:  gcc go.c -o go -lm
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

/***************** math ********************/

#define POS_OF_HIGHESTBITmath(a) /* 0th position is the Least-Signif-Bit */    \
  ((unsigned) log2(a))         /* thus: do not use if a <= 0 */  

#define NUM_OF_HIGHESTBITmath(a) ((a)               \
                  ? (1U << POS_OF_HIGHESTBITmath(a))    \
                  : 0)

/***************** clz ********************/

unsigned NUM_BITS_U = ((sizeof(unsigned) << 3) - 1);
#define POS_OF_HIGHESTBITclz(a) (NUM_BITS_U - __builtin_clz(a)) /* only works for a != 0 */

#define NUM_OF_HIGHESTBITclz(a) ((a)                    \
                 ? (1U << POS_OF_HIGHESTBITclz(a))  \
                 : 0)

/***************** i2f ********************/

double FF;
#define POS_OF_HIGHESTBITi2f(a) (FF = (double)(ui|1), ((*(1+(unsigned*)&FF))>>20)-1023)

#define NUM_OF_HIGHESTBITi2f(a) ((a)                    \
                 ? (1U << POS_OF_HIGHESTBITi2f(a))  \
                 : 0)

/***************** asm ********************/

unsigned OUT;
#define POS_OF_HIGHESTBITasm(a) (({asm("bsrl %1,%0" : "=r"(OUT) : "r"(a));}), OUT)

#define NUM_OF_HIGHESTBITasm(a) ((a)                    \
                 ? (1U << POS_OF_HIGHESTBITasm(a))  \
                 : 0)

/***************** bitshift1 ********************/

#define NUM_OF_HIGHESTBITbitshift1(a) (({   \
  OUT = a;                  \
  OUT |= (OUT >> 1);                \
  OUT |= (OUT >> 2);                \
  OUT |= (OUT >> 4);                \
  OUT |= (OUT >> 8);                \
  OUT |= (OUT >> 16);               \
      }), (OUT & ~(OUT >> 1)))          \

/***************** bitshift2 ********************/
int POS[32] = {0, 1, 28, 2, 29, 14, 24, 3,
             30, 22, 20, 15, 25, 17, 4, 8, 31, 27, 13, 23, 21, 19,
             16, 7, 26, 12, 18, 6, 11, 5, 10, 9};

#define POS_OF_HIGHESTBITbitshift2(a) (({   \
  OUT = a;                  \
  OUT |= OUT >> 1;              \
  OUT |= OUT >> 2;              \
  OUT |= OUT >> 4;              \
  OUT |= OUT >> 8;              \
  OUT |= OUT >> 16;             \
  OUT = (OUT >> 1) + 1;             \
      }), POS[(OUT * 0x077CB531UL) >> 27])

#define NUM_OF_HIGHESTBITbitshift2(a) ((a)              \
                       ? (1U << POS_OF_HIGHESTBITbitshift2(a)) \
                       : 0)

#define LOOPS 100000000U

int main()
{
  time_t start, end;
  unsigned ui;
  unsigned n;

  /********* Checking the first few unsigned values (you'll need to check all if you want to use an algorithm here) **************/
  printf("math\n");
  for (ui = 0U; ui < 18; ++ui)
    printf("%i\t%i\n", ui, NUM_OF_HIGHESTBITmath(ui));

  printf("\n\n");

  printf("clz\n");
  for (ui = 0U; ui < 18U; ++ui)
    printf("%i\t%i\n", ui, NUM_OF_HIGHESTBITclz(ui));

  printf("\n\n");

  printf("i2f\n");
  for (ui = 0U; ui < 18U; ++ui)
    printf("%i\t%i\n", ui, NUM_OF_HIGHESTBITi2f(ui));

  printf("\n\n");

  printf("asm\n");
  for (ui = 0U; ui < 18U; ++ui) {
    printf("%i\t%i\n", ui, NUM_OF_HIGHESTBITasm(ui));
  }

  printf("\n\n");

  printf("bitshift1\n");
  for (ui = 0U; ui < 18U; ++ui) {
    printf("%i\t%i\n", ui, NUM_OF_HIGHESTBITbitshift1(ui));
  }

  printf("\n\n");

  printf("bitshift2\n");
  for (ui = 0U; ui < 18U; ++ui) {
    printf("%i\t%i\n", ui, NUM_OF_HIGHESTBITbitshift2(ui));
  }

  printf("\n\nPlease wait...\n\n");

  /************************* Simple clock() benchmark ******************/
  start = clock();
  for (ui = 0; ui < LOOPS; ++ui)
    n = NUM_OF_HIGHESTBITmath(ui);
  end = clock();
  printf("math:\t%e\n", (double)(end-start)/CLOCKS_PER_SEC);

  start = clock();
  for (ui = 0; ui < LOOPS; ++ui)
    n = NUM_OF_HIGHESTBITclz(ui);
  end = clock();
  printf("clz:\t%e\n", (double)(end-start)/CLOCKS_PER_SEC);

  start = clock();
  for (ui = 0; ui < LOOPS; ++ui)
    n = NUM_OF_HIGHESTBITi2f(ui);
  end = clock();
  printf("i2f:\t%e\n", (double)(end-start)/CLOCKS_PER_SEC);

  start = clock();
  for (ui = 0; ui < LOOPS; ++ui)
    n = NUM_OF_HIGHESTBITasm(ui);
  end = clock();
  printf("asm:\t%e\n", (double)(end-start)/CLOCKS_PER_SEC);

  start = clock();
  for (ui = 0; ui < LOOPS; ++ui)
    n = NUM_OF_HIGHESTBITbitshift1(ui);
  end = clock();
  printf("bitshift1:\t%e\n", (double)(end-start)/CLOCKS_PER_SEC);

  start = clock();
  for (ui = 0; ui < LOOPS; ++ui)
    n = NUM_OF_HIGHESTBITbitshift2(ui);
  end = clock();
  printf("bitshift2\t%e\n", (double)(end-start)/CLOCKS_PER_SEC);

  printf("\nThe lower, the better. Take note that a negative exponent is good! ;)\n");

  return EXIT_SUCCESS;
} 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-08-16T06:33:17.217

这里有一些过于复杂的答案。仅当输入已经是 2 的幂时才应使用 Debruin 技术，否则有更好的方法。对于 2 个输入的功率，Debruin 绝对是最快的，甚至比`_BitScanReverse`我测试过的任何处理器都快。但是，在一般情况下，`_BitScanReverse`（或在编译器中调用的任何内在函数）是最快的（在某些 CPU 上，它可以进行微编码）。

如果内在函数不是一个选项，这里是处理一般输入的最佳软件解决方案。

```
u8  inline log2 (u32 val)  {
    u8  k = 0;
    if (val > 0x0000FFFFu) { val >>= 16; k  = 16; }
    if (val > 0x000000FFu) { val >>= 8;  k |= 8;  }
    if (val > 0x0000000Fu) { val >>= 4;  k |= 4;  }
    if (val > 0x00000003u) { val >>= 2;  k |= 2;  }
    k |= (val & 2) >> 1;
    return k;
} 
```

请注意，与大多数其他答案不同，此版本最后不需要 Debruin 查找。它计算就地位置。

但是，表可能更可取，如果您重复调用它足够多次，缓存未命中的风险就会因表的加速而黯然失色。

```
u8 kTableLog2[256] = {
0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
};

u8 log2_table(u32 val)  {
    u8  k = 0;
    if (val > 0x0000FFFFuL) { val >>= 16; k  = 16; }
    if (val > 0x000000FFuL) { val >>=  8; k |=  8; }
    k |= kTableLog2[val]; // precompute the Log2 of the low byte

    return k;
} 
```

这应该会产生此处给出的任何软件答案的最高吞吐量，但如果您只是偶尔调用它，则更喜欢像我的第一个片段这样的无表解决方案。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2011-10-14T12:29:54.900

我需要一个例程来执行此操作，并且在搜索网络（并找到此页面）之前，我提出了基于二进制搜索的自己的解决方案。虽然我确信以前有人这样做过！它以恒定的时间运行，并且可以比发布的“明显”解决方案更快，尽管我没有提出任何伟大的主张，只是出于兴趣而发布它。

```
int highest_bit(unsigned int a) {
  static const unsigned int maskv[] = { 0xffff, 0xff, 0xf, 0x3, 0x1 };
  const unsigned int *mask = maskv;
  int l, h;

  if (a == 0) return -1;

  l = 0;
  h = 32;

  do {
    int m = l + (h - l) / 2;

    if ((a >> m) != 0) l = m;
    else if ((a & (*mask << l)) != 0) h = m;

    mask++;
  } while (l < h - 1);

  return l;
} 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-11-24T09:44:41.070

C 中使用逐次逼近的版本：

```
unsigned int getMsb(unsigned int n)
{
  unsigned int msb  = sizeof(n) * 4;
  unsigned int step = msb;
  while (step > 1)
 {
    step /=2;
    if (n>>msb)
     msb += step;
   else
     msb -= step;
 }
  if (n>>msb)
    msb++;
  return (msb - 1);
} 
```

优点：无论提供多少，运行时间都是恒定的，因为循环的数量总是相同的。（使用“unsigned int”时有 4 个循环）

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2015-05-21T12:32:17.160

那是某种二进制搜索，它适用于各种（无符号！）整数类型

```
#include <climits>
#define UINT (unsigned int)
#define UINT_BIT (CHAR_BIT*sizeof(UINT))

int msb(UINT x)
{
    if(0 == x)
        return -1;

    int c = 0;

    for(UINT i=UINT_BIT>>1; 0<i; i>>=1)
    if(static_cast<UINT>(x >> i))
    {
        x >>= i;
        c |= i;
    }

    return c;
} 
```

完成：

```
#include <climits>
#define UINT unsigned int
#define UINT_BIT (CHAR_BIT*sizeof(UINT))

int lsb(UINT x)
{
    if(0 == x)
        return -1;

    int c = UINT_BIT-1;

    for(UINT i=UINT_BIT>>1; 0<i; i>>=1)
    if(static_cast<UINT>(x << i))
    {
        x <<= i;
        c ^= i;
    }

    return c;
} 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2011-07-09T08:14:18.067

扩展 Josh 的基准......可以如下改进 clz

```
/***************** clz2 ********************/

#define NUM_OF_HIGHESTBITclz2(a) ((a)                              \
                  ? (((1U) << (sizeof(unsigned)*8-1)) >> __builtin_clz(a)) \
                  : 0) 
```

关于 asm：请注意有 bsr 和 bsrl（这是“长”版本）。正常的可能会快一点。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2015-01-12T19:05:36.007

[c99](/questions/tagged/c99 "显示标记为“c99”的问题")给了我们[`log2`](http://en.cppreference.com/w/c/numeric/math/log2)。这消除了`log2`您在此页面上看到的所有特殊酱实现的需要。您可以像这样使用标准的`log2`实现：

```
const auto n = 13UL;
const auto Index = (unsigned long)log2(n);

printf("MSB is: %u\n", Index); // Prints 3 (zero offset) 
```

An `n`of 也`0UL`需要防范，因为：

> 返回 -∞ 并引发 FE_DIVBYZERO

我写了一个示例，其中任意设置`Index`为`ULONG_MAX`此处的检查：[https ://ideone.com/u26vsi](https://ideone.com/u26vsi)

* * *

[ehemient 的 gcc 唯一答案](https://stackoverflow.com/a/673781/2642059)的[视觉工作室](/questions/tagged/visual-studio "显示标记为“视觉工作室”的问题")推论是：

```
const auto n = 13UL;
unsigned long Index;

_BitScanReverse(&Index, n);
printf("MSB is: %u\n", Index); // Prints 3 (zero offset) 
```

[`_BitScanReverse`](https://docs.microsoft.com/en-us/cpp/intrinsics/bitscanreverse-bitscanreverse64)状态[的文档](https://docs.microsoft.com/en-us/cpp/intrinsics/bitscanreverse-bitscanreverse64)`Index`是：

> 加载找到的第一个设置位 (1) 的位位置

在实践中，我发现 if `n`is `0UL`that[`Index`设置为`0UL`](http://rextester.com/SRJCV19895)，就像对于 an `n`of一样`1UL`。`n`但是在 an of的情况下，文档中唯一保证的`0UL`是返回是：

> 如果没有找到设置位，则为 0

因此，与上面的优选实现类似，在这种情况下`log2`，应检查返回值是否设置`Index`为标记值。我在这里再次编写了一个使用`ULONG_MAX`此标志值的示例：[http ://rextester.com/GCU61409](http://rextester.com/GCU61409)

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2014-05-26T08:48:19.703

正如上面的答案所指出的，有多种方法可以确定最高有效位。但是，正如还指出的那样，这些方法可能是 32 位或 64 位寄存器所独有的。[**stanford.edu bithacks 页面**](http://graphics.stanford.edu/~seander/bithacks.html#IntegerLogObvious)提供了适用于 32 位和 64 位计算的解决方案。通过一些工作，它们可以结合起来提供一个可靠的跨架构方法来获得 MSB。我在 64 位和 32 位计算机上编译/工作的解决方案是：

```
#if defined(__LP64__) || defined(_LP64)
# define BUILD_64   1
#endif

#include <stdio.h>
#include <stdint.h>  /* for uint32_t */

/* CHAR_BIT  (or include limits.h) */
#ifndef CHAR_BIT
#define CHAR_BIT  8
#endif  /* CHAR_BIT */

/* 
 * Find the log base 2 of an integer with the MSB N set in O(N)
 * operations. (on 64bit & 32bit architectures)
 */
int
getmsb (uint32_t word)
{
    int r = 0;
    if (word < 1)
        return 0;
#ifdef BUILD_64
    union { uint32_t u[2]; double d; } t;  // temp
    t.u[__FLOAT_WORD_ORDER==LITTLE_ENDIAN] = 0x43300000;
    t.u[__FLOAT_WORD_ORDER!=LITTLE_ENDIAN] = word;
    t.d -= 4503599627370496.0;
    r = (t.u[__FLOAT_WORD_ORDER==LITTLE_ENDIAN] >> 20) - 0x3FF;
#else
    while (word >>= 1)
    {
        r++;
    }
#endif  /* BUILD_64 */
    return r;
} 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2016-12-30T01:17:58.867

我知道这个问题很老了，但是我自己实现了一个*msb()*函数，我发现这里和其他网站上提供的大多数解决方案不一定是最有效的 - 至少对于我个人对效率的定义（另见下面的***更新***）。原因如下：

大多数解决方案（尤其是那些采用某种二进制搜索方案或从右到左进行线性扫描的朴素方法的解决方案）似乎忽略了这样一个事实，即对于任意二进制数，没有多少以非常长的序列开头的零。事实上，对于任何位宽，所有整数中有一半以**1**开头，其中四分之一以**01**开头。看到我要说的了吗？我的论点是，从最高有效位位置开始到最低有效位（从左到右）的*线性扫描*并不像乍一看那样“线性”。

可以显示¹，对于任何位宽，需要测试的平均位数最多为 2。这转化为***O(1)***相对于位数的*摊销*时间复杂度(!) .

 *当然，最坏的情况仍然是***O(n)***，比使用类似二进制搜索的方法得到的***O(log(n))***更糟糕，但是由于最坏的情况很少，因此对于大多数应用程序来说它们可以忽略不计（***更新***：不完全：可能很少，但它们可能发生的概率很高 - 请参阅下面的***更新***）。

这是我提出的“天真的”方法，至少在我的机器上胜过大多数其他方法（32 位整数的二进制搜索方案总是需要*log* [2] (32) = 5 步，而这个愚蠢的算法需要更少平均超过 2 个） - 抱歉这是 C++ 而不是纯 C：

```
template <typename T>
auto msb(T n) -> int
{
    static_assert(std::is_integral<T>::value && !std::is_signed<T>::value,
        "msb<T>(): T must be an unsigned integral type.");

    for (T i = std::numeric_limits<T>::digits - 1, mask = 1 << i; i >= 0; --i, mask >>= 1)
    {
        if ((n & mask) != 0)
            return i;
    }

    return 0;
} 
```

***更新***：虽然我在这里写的对于*任意*整数来说都是完全正确的，其中每个位组合都是同样可能的（我的速度测试只是测量了确定*所有*32 位整数的 MSB 所需的时间），现实生活中的整数，对于将调用哪个这样的函数，通常遵循不同的模式：例如，在我的代码中，此函数用于确定*对象大小*是否为 2 的幂，或者查找大于或等于*对象大小*。我的猜测是，大多数使用 MSB 的应用程序涉及的数字远小于整数可以表示的最大数字（对象大小很少使用*size_t中的所有位*）。在这种情况下，我的解决方案实际上会比二分搜索方法执行得更差 - 所以后者可能应该是首选，即使我的解决方案将更快地循环遍历*所有*整数。
**TL;DR：**现实生活中的整数可能会偏向于这个简单算法的最坏情况，这将使其最终表现更差 - 尽管事实上它对于真正任意整数的*摊销* ***O(1) 。***

¹论证如下（粗略）：设***n***为位数（位宽）。总共有*2 ^(n 个)*整数，可以用***n***位表示。有*2 ^(n - 1 个)***以1**开头的整数（第一个**1**是固定的，剩余的*n - 1*位可以是任何值）。这些整数只需要一次循环即可确定 MSB。此外，有*2* *^(n - 2 个)***以01**开头的整数，需要 2 次迭代，*2* *^(n - 3 个)***以001**开头的整数，需要 3 次迭代，依此类推。

 *******如果我们对所有可能的整数求和所有需要的迭代并将它们除以*2 ^(n （整数的总数），我们得到确定)****n***位整数的 MSB 所需的平均迭代次数：

*(1 * 2 ^(n - 1) + 2 * 2 ^(n - 2) + 3 * 2 ^(n - 3) + ... + n) / 2 ^n*

[这一系列平均迭代实际上是收敛的，并且对于***n***向无穷大的限制为 2](http://www.wolframalpha.com/input/?i=limit%20Sum%5Bi%202%5E(n%20-%20i),%20%7Bi,%201,%20n%7D%5D%20%2F%202%5En%20for%20n%20towards%20infinity)

因此，朴素的从左到右算法实际上对于任意位数具有***O(1)****的摊销*常数时间复杂度。

 ** * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-03-22T23:51:08.493

想想按位运算符。

我第一次误解了这个问题。您应该生成一个 int 并设置最左边的位（其他位为零）。假设 cmp 设置为该值：

```
position = sizeof(int)*8
while(!(n & cmp)){ 
   n <<=1;
   position--;
} 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2017-05-27T20:35:03.083

哇，那是很多答案。我不抱歉回答一个老问题。

```
int result = 0;//could be a char or int8_t instead
if(value){//this assumes the value is 64bit
    if(0xFFFFFFFF00000000&value){  value>>=(1<<5); result|=(1<<5);  }//if it is 32bit then remove this line
    if(0x00000000FFFF0000&value){  value>>=(1<<4); result|=(1<<4);  }//and remove the 32msb
    if(0x000000000000FF00&value){  value>>=(1<<3); result|=(1<<3);  }
    if(0x00000000000000F0&value){  value>>=(1<<2); result|=(1<<2);  }
    if(0x000000000000000C&value){  value>>=(1<<1); result|=(1<<1);  }
    if(0x0000000000000002&value){  result|=(1<<0);  }
}else{
  result=-1;
} 
```

这个答案与另一个答案非常相似......哦，好吧。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2012-10-14T20:36:04.150

由于这是“另一种”方法，因此将其放入，似乎与已经给出的其他方法不同。

返回`-1`if `x==0`，否则返回`floor( log2(x))` （最大结果 31）

将问题从 32 位减少到 4 位，然后使用表格。也许不优雅，但务实。

`__builtin_clz`这是我因为便携性问题不想使用时使用的。

为了使其更紧凑，可以改为使用循环来减少，每次将 4 添加到 r，最多 7 次迭代。或者一些混合，例如（对于 64 位）：循环减少到 8，测试减少到 4。

```
int log2floor( unsigned x ){
   static const signed char wtab[16] = {-1,0,1,1, 2,2,2,2, 3,3,3,3,3,3,3,3};
   int r = 0;
   unsigned xk = x >> 16;
   if( xk != 0 ){
       r = 16;
       x = xk;
   }
   // x is 0 .. 0xFFFF
   xk = x >> 8;
   if( xk != 0){
       r += 8;
       x = xk;
   }
   // x is 0 .. 0xFF
   xk = x >> 4;
   if( xk != 0){
       r += 4;
       x = xk;
   }
   // now x is 0..15; x=0 only if originally zero.
   return r + wtab[x];
} 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2017-10-26T13:41:10.450

另一张海报提供了一个使用**字节范围查找的****查找表**。如果您想获得更多性能（以 32K 内存而不是仅 256 个查找条目为代价），这里有一个使用**15 位查找表**的解决方案，在**C# 7** for **.NET**中。

 ******有趣的部分是初始化表。由于它是我们在进程生命周期中想要的一个相对较小的块，因此我通过使用`Marshal.AllocHGlobal`. 如您所见，为了获得最佳性能，整个示例均以原生方式编写：

```
readonly static byte[] msb_tab_15;

// Initialize a table of 32768 bytes with the bit position (counting from LSB=0)
// of the highest 'set' (non-zero) bit of its corresponding 16-bit index value.
// The table is compressed by half, so use (value >> 1) for indexing.
static MyStaticInit()
{
    var p = new byte[0x8000];

    for (byte n = 0; n < 16; n++)
        for (int c = (1 << n) >> 1, i = 0; i < c; i++)
            p[c + i] = n;

    msb_tab_15 = p;
} 
```

该表需要通过上面的代码进行一次性初始化。它是只读的，因此可以共享单个全局副本以进行并发访问。使用此表，您可以快速查找整数**log [2]**，这就是我们在这里寻找的所有整数宽度（8、16、32 和 64 位）。

请注意，表条目`0`是未定义“最高设置位”概念的唯一整数，其值为`-1`。这种区别对于正确处理下面代码中的 0 值高位字是必要的。事不宜迟，以下是各种整数原语的代码：

**ulong（64位）版本**

```
/// <summary> Index of the highest set bit in 'v', or -1 for value '0' </summary>
public static int HighestOne(this ulong v)
{
    if ((long)v <= 0)
        return (int)((v >> 57) & 0x40) - 1;      // handles cases v==0 and MSB==63

    int j = /**/ (int)((0xFFFFFFFFU - v /****/) >> 58) & 0x20;
    j |= /*****/ (int)((0x0000FFFFU - (v >> j)) >> 59) & 0x10;
    return j + msb_tab_15[v >> (j + 1)];
} 
```

**uint（32 位）版本**

```
/// <summary> Index of the highest set bit in 'v', or -1 for value '0' </summary>
public static int HighestOne(uint v)
{
    if ((int)v <= 0)
        return (int)((v >> 26) & 0x20) - 1;     // handles cases v==0 and MSB==31

    int j = (int)((0x0000FFFFU - v) >> 27) & 0x10;
    return j + msb_tab_15[v >> (j + 1)];
} 
```

**上述各种重载**

```
public static int HighestOne(long v) => HighestOne((ulong)v);
public static int HighestOne(int v) => HighestOne((uint)v);
public static int HighestOne(ushort v) => msb_tab_15[v >> 1];
public static int HighestOne(short v) => msb_tab_15[(ushort)v >> 1];
public static int HighestOne(char ch) => msb_tab_15[ch >> 1];
public static int HighestOne(sbyte v) => msb_tab_15[(byte)v >> 1];
public static int HighestOne(byte v) => msb_tab_15[v >> 1]; 
```

这是一个完整的、有效的解决方案，它代表了 .NET 4.7.2 上的最佳性能，我将其与专门的性能测试工具进行了比较。其中一些在下面提到。测试参数是所有 65 位位置的均匀密度，即**0 ... 31/63**加值`0`（产生结果 -1）。*目标索引位置下方*的位是随机填充的。测试仅适用于**x64**，发布模式，启用了 JIT 优化。

*我的正式回答到此结束；以下是与我运行的测试相关的替代测试候选人的一些随意注释和源代码链接，以验证上述代码的性能和正确性。*

* * *

上面提供的版本，编码为 Tab16A 在多次运行中始终是赢家。这些不同的候选人，以积极的工作/临时形式，可以在[这里](https://pastebin.com/pTP2315J)、[这里](https://pastebin.com/jRe0m44P)和[这里找到](https://pastebin.com/Eu3AyBLh)。

> ```
> 1 名候选人。HighestOne_Tab16A 622,496
>  2名候选人。HighestOne_Tab16C 628,234
>  3 名候选人。HighestOne_Tab8A 649,146
>  4 名候选人。HighestOne_Tab8B 656,847
>  5 名候选人。HighestOne_Tab16B 657,147
>  6 名候选人。HighestOne_Tab16D 659,650
>  7 _highest_one_bit_UNMANAGED.HighestOne_U 702,900
>  8 de_Bruijn.IndexOfMSB 709,672
>  9 _old_2.HighestOne_Old2 715,810
> 10 _test_A.HighestOne8 757,188
> 11 _old_1.HighestOne_Old1 757,925
> 12 _test_A.HighestOne5（不安全）760,387
> 13 _test_B.HighestOne8（不安全）763,904
> 14 _test_A.HighestOne3（不安全）766,433
> 15 _test_A.HighestOne1（不安全）767,321
> 16 _test_A.HighestOne4（不安全）771,702
> 17 _test_B.HighestOne2（不安全）772,136
> 18 _test_B.HighestOne1（不安全）772,527
> 19 _test_B.HighestOne3（不安全）774,140
> 20 _test_A.HighestOne7（不安全）774,581
> 21 _test_B.HighestOne7（不安全）775,463
> 22 _test_A.HighestOne2（不安全）776,865
> 23 名候选人。HighestOne_NoTab 777,698
> 24 _test_B.HighestOne6（不安全）779,481
> 25 _test_A.HighestOne6（不安全）781,553
> 26 _test_B.HighestOne4（不安全）785,504
> 27 _test_B.HighestOne5（不安全）789,797
> 28 _test_A.HighestOne0（不安全）809,566
> 29 _test_B.HighestOne0（不安全）814,990
> 30 _highest_one_bit.HighestOne 824,345
> 30 _bitarray_ext.RtlFindMostSignificantBit 894,069
> 31 名候选人。HighestOne_Naive 898,865
> ```

值得注意的是 `ntdll.dll!RtlFindMostSignificantBit`via P/Invoke 的糟糕表现：

```
[DllImport("ntdll.dll"), SuppressUnmanagedCodeSecurity, SecuritySafeCritical]
public static extern int RtlFindMostSignificantBit(ulong ul); 
```

这真的太糟糕了，因为这是整个实际功能：

```
 RtlFindMostSignificantBit:
        bsr rdx, rcx  
        mov eax,0FFFFFFFFh  
        movzx ecx, dl  
        cmovne      eax,ecx  
        ret 
```

我无法想象源自这五行的糟糕性能，因此必须归咎于托管/本地转换惩罚。令我感到惊讶的是，与 128 字节（和 256 字节） （8 位）查找表相比，测试确实偏爱 32KB（和 64KB） `short`（16 位）直接查找表。`byte`我认为以下内容与 16 位查找相比更具竞争力，但后者始终优于此：

```
public static int HighestOne_Tab8A(ulong v)
{
    if ((long)v <= 0)
        return (int)((v >> 57) & 64) - 1;

    int j;
    j =  /**/ (int)((0xFFFFFFFFU - v) >> 58) & 32;
    j += /**/ (int)((0x0000FFFFU - (v >> j)) >> 59) & 16;
    j += /**/ (int)((0x000000FFU - (v >> j)) >> 60) & 8;
    return j + msb_tab_8[v >> j];
} 
```

我要指出的最后一件事是，我的 deBruijn 方法没有表现得更好，这让我感到非常震惊。这是我以前普遍使用的方法：

```
const ulong N_bsf64 = 0x07EDD5E59A4E28C2,
            N_bsr64 = 0x03F79D71B4CB0A89;

readonly public static sbyte[]
bsf64 =
{
    63,  0, 58,  1, 59, 47, 53,  2, 60, 39, 48, 27, 54, 33, 42,  3,
    61, 51, 37, 40, 49, 18, 28, 20, 55, 30, 34, 11, 43, 14, 22,  4,
    62, 57, 46, 52, 38, 26, 32, 41, 50, 36, 17, 19, 29, 10, 13, 21,
    56, 45, 25, 31, 35, 16,  9, 12, 44, 24, 15,  8, 23,  7,  6,  5,
},
bsr64 =
{
     0, 47,  1, 56, 48, 27,  2, 60, 57, 49, 41, 37, 28, 16,  3, 61,
    54, 58, 35, 52, 50, 42, 21, 44, 38, 32, 29, 23, 17, 11,  4, 62,
    46, 55, 26, 59, 40, 36, 15, 53, 34, 51, 20, 43, 31, 22, 10, 45,
    25, 39, 14, 33, 19, 30,  9, 24, 13, 18,  8, 12,  7,  6,  5, 63,
};

public static int IndexOfLSB(ulong v) =>
    v != 0 ? bsf64[((v & (ulong)-(long)v) * N_bsf64) >> 58] : -1;

public static int IndexOfMSB(ulong v)
{
    if ((long)v <= 0)
        return (int)((v >> 57) & 64) - 1;

    v |= v >> 1; v |= v >> 2;  v |= v >> 4;   // does anybody know a better
    v |= v >> 8; v |= v >> 16; v |= v >> 32;  // way than these 12 ops?
    return bsr64[(v * N_bsr64) >> 58];
} 
```

[在这个 SO question](https://stackoverflow.com/questions/2589096/find-most-significant-bit-left-most-that-is-set-in-a-bit-array)上有很多关于 deBruijn 方法的优越和伟大的讨论，我倾向于同意。我的猜测是，虽然 deBruijn 和直接查找表方法（我发现最快）都必须进行表查找，并且都具有非常小的分支，但只有 deBruijn 具有 64 位乘法运算。我只测试了`IndexOfMSB`这里的功能——不是 deBruijn——`IndexOfLSB`但我希望后者的机会更好，因为它的操作更少（见上文），我可能会继续将它用于 LSB。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2015-10-17T17:13:56.910

请注意，您要做的是计算整数的整数 log2，

```
#include <stdio.h>
#include <stdlib.h>

unsigned int
Log2(unsigned long x)
{
    unsigned long n = x;
    int bits = sizeof(x)*8;
    int step = 1; int k=0;
    for( step = 1; step < bits; ) {
        n |= (n >> step);
        step *= 2; ++k;
    }
    //printf("%ld %ld\n",x, (x - (n >> 1)) );
    return(x - (n >> 1));
} 
```

请注意，您可以尝试一次搜索超过 1 位。

```
unsigned int
Log2_a(unsigned long x)
{
    unsigned long n = x;
    int bits = sizeof(x)*8;
    int step = 1;
    int step2 = 0;
    //observe that you can move 8 bits at a time, and there is a pattern...
    //if( x>1<<step2+8 ) { step2+=8;
        //if( x>1<<step2+8 ) { step2+=8;
            //if( x>1<<step2+8 ) { step2+=8;
            //}
        //}
    //}
    for( step2=0; x>1L<<step2+8; ) {
        step2+=8;
    }
    //printf("step2 %d\n",step2);
    for( step = 0; x>1L<<(step+step2); ) {
        step+=1;
        //printf("step %d\n",step+step2);
    }
    printf("log2(%ld) %d\n",x,step+step2);
    return(step+step2);
} 
```

这种方法使用二分搜索

```
unsigned int
Log2_b(unsigned long x)
{
    unsigned long n = x;
    unsigned int bits = sizeof(x)*8;
    unsigned int hbit = bits-1;
    unsigned int lbit = 0;
    unsigned long guess = bits/2;
    int found = 0;

    while ( hbit-lbit>1 ) {
        //printf("log2(%ld) %d<%d<%d\n",x,lbit,guess,hbit);
        //when value between guess..lbit
        if( (x<=(1L<<guess)) ) {
           //printf("%ld < 1<<%d %ld\n",x,guess,1L<<guess);
            hbit=guess;
            guess=(hbit+lbit)/2;
            //printf("log2(%ld) %d<%d<%d\n",x,lbit,guess,hbit);
        }
        //when value between hbit..guess
        //else
        if( (x>(1L<<guess)) ) {
            //printf("%ld > 1<<%d %ld\n",x,guess,1L<<guess);
            lbit=guess;
            guess=(hbit+lbit)/2;
            //printf("log2(%ld) %d<%d<%d\n",x,lbit,guess,hbit);
        }
    }
    if( (x>(1L<<guess)) ) ++guess;
    printf("log2(x%ld)=r%d\n",x,guess);
    return(guess);
} 
```

另一种二分查找方法，也许更易读，

```
unsigned int
Log2_c(unsigned long x)
{
    unsigned long v = x;
    unsigned int bits = sizeof(x)*8;
    unsigned int step = bits;
    unsigned int res = 0;
    for( step = bits/2; step>0; )
    {
        //printf("log2(%ld) v %d >> step %d = %ld\n",x,v,step,v>>step);
        while ( v>>step ) {
            v>>=step;
            res+=step;
            //printf("log2(%ld) step %d res %d v>>step %ld\n",x,step,res,v);
        }
        step /= 2;
    }
    if( (x>(1L<<res)) ) ++res;
    printf("log2(x%ld)=r%ld\n",x,res);
    return(res);
} 
```

因为你会想要测试这些，

```
int main()
{
    unsigned long int x = 3;
    for( x=2; x<1000000000; x*=2 ) {
        //printf("x %ld, x+1 %ld, log2(x+1) %d\n",x,x+1,Log2(x+1));
        printf("x %ld, x+1 %ld, log2_a(x+1) %d\n",x,x+1,Log2_a(x+1));
        printf("x %ld, x+1 %ld, log2_b(x+1) %d\n",x,x+1,Log2_b(x+1));
        printf("x %ld, x+1 %ld, log2_c(x+1) %d\n",x,x+1,Log2_c(x+1));
    }
    return(0);
} 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2021-12-14T08:01:04.980

有一个建议在 C 中添加位操作函数，特别是前导零有助于找到最高位集。见[http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2827.htm#design-bit-leading.trailing.zeroes.ones](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2827.htm#design-bit-leading.trailing.zeroes.ones)

它们有望在可能的情况下作为内置实现，因此确保这是一种有效的方式。

这类似于最近添加到 C++（`std::countl_zero`等）中的内容。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2018-01-24T15:55:34.027

我假设您的问题是针对整数（下面称为 v ）而不是无符号整数。

```
int v = 612635685; // whatever value you wish

unsigned int get_msb(int v)
{
    int r = 31;                         // maximum number of iteration until integer has been totally left shifted out, considering that first bit is index 0\. Also we could use (sizeof(int)) << 3 - 1 instead of 31 to make it work on any platform.

    while (!(v & 0x80000000) && r--) {   // mask of the highest bit
        v <<= 1;                        // multiply integer by 2.
    }
    return r;                           // will even return -1 if no bit was set, allowing error catch
} 
```

如果你想让它在不考虑符号的情况下工作，你可以添加一个额外的 'v <<= 1;' 在循环之前（并相应地将 r 值更改为 30）。如果我忘记了什么，请告诉我。我还没有测试它，但它应该工作得很好。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2021-03-09T20:41:46.943

这看起来很大，但与循环相比，它的工作速度非常快，感谢 bluegsmith

```
int Bit_Find_MSB_Fast(int x2)
{
    long x = x2 & 0x0FFFFFFFFl;
    long num_even = x & 0xAAAAAAAA;
    long num_odds = x & 0x55555555;

    if (x == 0) return(0);

    if (num_even > num_odds)
    {
        if ((num_even & 0xFFFF0000) != 0) // top 4
        {
            if ((num_even & 0xFF000000) != 0)
            {
                if ((num_even & 0xF0000000) != 0)
                {
                    if ((num_even & 0x80000000) != 0) return(32);
                    else
                        return(30);
                }
                else
                {
                    if ((num_even & 0x08000000) != 0) return(28);
                    else
                        return(26);
                }
            }
            else
            {
                if ((num_even & 0x00F00000) != 0)
                {
                    if ((num_even & 0x00800000) != 0) return(24);
                    else
                        return(22);
                }
                else
                {
                    if ((num_even & 0x00080000) != 0) return(20);
                    else
                        return(18);
                }
            }
        }
        else
        {
            if ((num_even & 0x0000FF00) != 0)
            {
                if ((num_even & 0x0000F000) != 0)
                {
                    if ((num_even & 0x00008000) != 0) return(16);
                    else
                        return(14);
                }
                else
                {
                    if ((num_even & 0x00000800) != 0) return(12);
                    else
                        return(10);
                }
            }
            else
            {
                if ((num_even & 0x000000F0) != 0)
                {
                    if ((num_even & 0x00000080) != 0)return(8);
                    else
                        return(6);
                }
                else
                {
                    if ((num_even & 0x00000008) != 0) return(4);
                    else
                        return(2);
                }
            }
        }
    }
    else
    {
        if ((num_odds & 0xFFFF0000) != 0) // top 4
        {
            if ((num_odds & 0xFF000000) != 0)
            {
                if ((num_odds & 0xF0000000) != 0)
                {
                    if ((num_odds & 0x40000000) != 0) return(31);
                    else
                        return(29);
                }
                else
                {
                    if ((num_odds & 0x04000000) != 0) return(27);
                    else
                        return(25);
                }
            }
            else
            {
                if ((num_odds & 0x00F00000) != 0)
                {
                    if ((num_odds & 0x00400000) != 0) return(23);
                    else
                        return(21);
                }
                else
                {
                    if ((num_odds & 0x00040000) != 0) return(19);
                    else
                        return(17);
                }
            }
        }
        else
        {
            if ((num_odds & 0x0000FF00) != 0)
            {
                if ((num_odds & 0x0000F000) != 0)
                {
                    if ((num_odds & 0x00004000) != 0) return(15);
                    else
                        return(13);
                }
                else
                {
                    if ((num_odds & 0x00000400) != 0) return(11);
                    else
                        return(9);
                }
            }
            else
            {
                if ((num_odds & 0x000000F0) != 0)
                {
                    if ((num_odds & 0x00000040) != 0)return(7);
                    else
                        return(5);
                }
                else
                {
                    if ((num_odds & 0x00000004) != 0) return(3);
                    else
                        return(1);
                }
            }
        }
    }
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2015-06-29T10:21:10.360

编码：

```
 // x>=1;
    unsigned func(unsigned x) {
    double d = x ;
    int p= (*reinterpret_cast<long long*>(&d) >> 52) - 1023;
    printf( "The left-most non zero bit of %d is bit %d\n", x, p);
    } 
```

或者通过设置 Y=1 得到 FPU 指令 FYL2X (Y*Log2 X) 的整数部分

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2019-12-14T11:53:45.743

这是适用于**GCC**和**Clang的****C**快速解决方案；准备好复制和粘贴。

 ****```
#include <limits.h>

unsigned int fls(const unsigned int value)
{
    return (unsigned int)1 << ((sizeof(unsigned int) * CHAR_BIT) - __builtin_clz(value) - 1);
}

unsigned long flsl(const unsigned long value)
{
    return (unsigned long)1 << ((sizeof(unsigned long) * CHAR_BIT) - __builtin_clzl(value) - 1);
}

unsigned long long flsll(const unsigned long long value)
{
    return (unsigned long long)1 << ((sizeof(unsigned long long) * CHAR_BIT) - __builtin_clzll(value) - 1);
} 
```

还有一点改进的**C++**版本。

```
#include <climits>

constexpr unsigned int fls(const unsigned int value)
{
    return (unsigned int)1 << ((sizeof(unsigned int) * CHAR_BIT) - __builtin_clz(value) - 1);
}

constexpr unsigned long fls(const unsigned long value)
{
    return (unsigned long)1 << ((sizeof(unsigned long) * CHAR_BIT) - __builtin_clzl(value) - 1);
}

constexpr unsigned long long fls(const unsigned long long value)
{
    return (unsigned long long)1 << ((sizeof(unsigned long long) * CHAR_BIT) - __builtin_clzll(value) - 1);
} 
```

该代码假定`value`不会是`0`. 如果要允许0，则需要修改它。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2019-06-15T22:20:41.887

我卑微的方法很简单：

MSB(x) = INT[Log(x) / Log(2)]

翻译：x的MSB是（Base x的Log除以Base 2的Log）的整数值。

这可以轻松快速地适应任何编程语言。在你的计算器上试一试，看看它是否有效。

* * *

## 回答 #30

> 赞同：-3
> 
> 时间：2021-01-28T01:59:37.993

使用 VPTEST(D, W, B) 和 PSRLDQ 指令的组合来关注包含最高有效位的字节，如下所示，在 Perl 中使用这些指令的仿真可以在以下位置找到：

[https://github.com/philiprbrenan/SimdAvx512](https://github.com/philiprbrenan/SimdAvx512)

```
if (1) {                                                                        #TpositionOfMostSignificantBitIn64
  my @m = (                                                                     # Test strings
#B0       1       2       3       4       5       6       7
#b0123456701234567012345670123456701234567012345670123456701234567
 '0000000000000000000000000000000000000000000000000000000000000000',
 '0000000000000000000000000000000000000000000000000000000000000001',
 '0000000000000000000000000000000000000000000000000000000000000010',
 '0000000000000000000000000000000000000000000000000000000000000111',
 '0000000000000000000000000000000000000000000000000000001010010000',
 '0000000000000000000000000000000000001000000001100100001010010000',
 '0000000000000000000001001000010000000000000001100100001010010000',
 '0000000000000000100000000000000100000000000001100100001010010000',
 '1000000000000000100000000000000100000000000001100100001010010000',
);
  my @n = (0, 1, 2, 3, 10, 28, 43, 48, 64);                                     # Expected positions of msb

  sub positionOfMostSignificantBitIn64($)                                       # Find the position of the most significant bit in a string of 64 bits starting from 1 for the least significant bit or return 0 if the input field is all zeros
   {my ($s64) = @_;                                                             # String of 64 bits

    my $N = 128;                                                                # 128 bit operations
    my $f = 0;                                                                  # Position of first bit set
    my $x = '0'x$N;                                                             # Double Quad Word set to 0
    my $s = substr $x.$s64, -$N;                                                # 128 bit area needed

    substr(VPTESTMD($s, $s), -2, 1) eq '1' ? ($s = PSRLDQ $s, 4) : ($f += 32);  # Test 2 dwords
    substr(VPTESTMW($s, $s), -2, 1) eq '1' ? ($s = PSRLDQ $s, 2) : ($f += 16);  # Test 2 words
    substr(VPTESTMB($s, $s), -2, 1) eq '1' ? ($s = PSRLDQ $s, 1) : ($f +=  8);  # Test 2 bytes

    $s = substr($s, -8);                                                        # Last byte remaining

    $s < $_ ? ++$f : last for                                                   # Search remaing byte
     (qw(10000000 01000000 00100000 00010000
         00001000 00000100 00000010 00000001));

    64 - $f                                                                     # Position of first bit set
   }

  ok $n[$_] eq positionOfMostSignificantBitIn64 $m[$_] for keys @m              # Test
 } 
```

# c# - 如何为 ObservableCollection 创建 CollectionView 在银光

> ID：671818
> 
> 赞同：8
> 
> 时间：2009-03-22T23:44:04.920
> 
> 标签：c#, silverlight

我正在使用 silverlight，我想提交一个 ObservableCollection。

所以我开始关注 ICollectionView，因为 Silverlight 中没有 CollectionViewSource，它包含的方法和事件数量非常多。我已经搜索了一段时间，我想知道是否有人有 ICollectionView 实现的示例代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-19T20:54:48.750

CollectionViewSource 现在在 Silverlight 3 中可用。在[此处](http://www.silverlightplayground.org/post/2009/07/10/Silverlight-30-RTW-The-CollectionViewSource.aspx)查看有关此内容的好文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T02:48:11.437

不幸的是，ICollectionView 仅用于 Silverlight 2.0 中的 DataGrid，它唯一的实现是 ListCollectionView，它是 System.Windows.Controls.Data 的内部。

如果你没有绑定到 DataGrid，ICollectionView 不会给你太多，因为据我所知，基本控件（例如列表框）没有使用它，因为它是在 Data 控件程序集中而不是在核心中定义的.

这与 WPF 有很大的不同。

但就您的问题而言，包含 DataGrid 的程序集确实有一个实现，如果您想了解它是如何完成的，它可能会对您有所帮助。最坏的情况，反射器是你的朋友...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T05:56:43.947

如果要对 ObservableCollection 进行数据绑定，一种方法是使用值转换器。

另一种方法是在 ViewModel CLR 对象中使用 LINQ，该对象将基于 ViewModel 中的属性进行过滤，如下所示（参见底部的实现方法 UpdateFilteredStores()）：

```
namespace UnitTests
{
    using System.Collections.Generic;
    using System.Collections.ObjectModel;
    using System.Collections.Specialized;
    using System.ComponentModel;
    using System.Linq;

    public class ViewModel : INotifyPropertyChanged
    {
        private string name;

        public ViewModel()
        {
            this.Stores = new ObservableCollection<string>();

            this.Stores.CollectionChanged += new NotifyCollectionChangedEventHandler(this.Stores_CollectionChanged);

            // TODO: Add code to retreive the stores collection
        }

        #region INotifyPropertyChanged Members

        public event PropertyChangedEventHandler PropertyChanged;

        #endregion

        public ObservableCollection<string> Stores { get; private set; }

        public IEnumerable<string> FilteredStores { get; private set; }

        public string Name 
        { 
            get
            {
                return this.name;
            }

            set
            {
                this.name = value;

                if (this.PropertyChanged != null)
                {
                    this.PropertyChanged(this, new PropertyChangedEventArgs("Name"));
                }

                this.UpdateFilteredStores();
            }
        }

        private void Stores_CollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
        {
            this.UpdateFilteredStores();
        }

        private void UpdateFilteredStores()
        {
            this.FilteredStores = from store in this.Stores
                                  where store.Contains(this.Name)
                                  select store;

            if (this.PropertyChanged != null)
            {
                this.PropertyChanged(this, new PropertyChangedEventArgs("FilteredStores"));
            }
        }
    }
} 
```

# jpa - REQUIRES_NEW 注释方法在没有事务的情况下执行？

> ID：671820
> 
> 赞同：1
> 
> 时间：2009-03-22T23:46:11.967
> 
> 标签：jpa, ejb-3.0, jta, jboss-mdb

我有一个无状态 bean 负责将实体持久化到数据库中。这个无状态 bean 由消息 bean 的 onMessage 方法调用。连线的事情是，在第一条消息上一切正常，但在下一条消息上，负责持久化的方法在事务外部调用，即使该方法使用 REQUIRES_NEW 注释。

```
@TransactionAttribute(TransactionAttributeType.REQUIRES_NEW)
public StateChange persistChange(long deviceId, ...) {

    ...

    StateChange change = new StateChange(...);
    em.persist(change);
    em.refresh(change); // To provoke the error

    return change;
} 
```

调用 refresh 会触发以下异常：

> 引起：javax.persistence.TransactionRequiredException：没有事务正在进行

有任何想法吗？我对 JTA 还很陌生，所以我可能错过了一些重要的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T20:56:20.073

我尝试了很多来解决它，大约 16 个小时后它似乎正在工作。我不确定到底是什么伎俩，但它可能是升级到 Glassfish 2.1。

终于又可以晚上睡觉了！

# java - Java数组问题

> ID：671827
> 
> 赞同：0
> 
> 时间：2009-03-22T23:50:49.960
> 
> 标签：java, arrays

我在数组中放了几个元素（例如 5 个元素） 数组的第一个元素 index[0] 将自动显示，无需用户单击按钮。

单击按钮后，它将打印数组的下一个元素，并且过程继续进行，直到数组的最后一个元素。每次单击按钮时，都会在 txt 文件中写入一个文件。

我的问题是，例如有 5 个数组元素（单击按钮时成功显示），但是只有四个文件写入 txt 文件。如何使它成为五个...帮助...我在一条死路上:-(

```
public class mainFrame extends JFrame implements ActionListener {
   ........
   private JButton answer1 = new JButton();
   String [] a = {"a","b","c","d","e"}
   in fileNumber = 0; 
   }

public mainFramme (){
  System.out.println(a.get(fileNumber))
  fileNumber++;
  answer1.addActionListener(this); 
  }

 public void actionPerformed(ActionEvent e) {     
    if (e.getSource==answer1) {
       System.out.println(a.get(fileNumber))
       try {
       .....
       fout = new FileOutputStream ("myfile.txt",true);
       Filename = new File(files.get(fileNumber));      
       new PrintStream(fout).println (Filename);
       new PrintStream(fout).println ("Answer 1");
       fileNumber++;      
       }
       ...
   } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T00:00:42.353

你的问题出在这里：

```
public mainFramme (){
  System.out.println(a.get(fileNumber))
  fileNumber++
  answer1.addActionListener(this); 
  } 
```

您在按下按钮之前递增 fileNumber，因此它等于 1。数组从 Java 中的 0 开始索引，这意味着要获取使用*数组*[0] 的数组中的第一个元素 - 看到 fileNumber 将等于 1，您将获取数组的*第二个*元素 - 因此缺少第一个元素。

**编辑由于评论：**

好的，那么您是否在文件输出流上调用了 flush() 和 close() 方法？'flush' 确保流中的任何数据在关闭之前都被写出。如果您发布整个 actionPerformed 方法可能会有所帮助。

您发布的一些代码也不理想（即新的 PrintStream 东西）

也许这可能会有所帮助：

```
public void actionPerformed(ActionEvent e) {
   if(e.getSource() == answer1) {
       try {
           PrintWriter output = new PrintWriter(new FileOutputStream(fileName.txt));

           // Write stuff to file using output.printLn();
           output.flush();
           output.close();
        }catch (IOException e) { // exception handling }
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T23:58:35.183

在构造函数中，你有

```
System.out.println(a.get(fileNumber))
fileNumber++; 
```

在我看来，您正在将一个字符串打印到标准输出（即屏幕）而不将其写入文件。我敢打赌，这就是为什么您缺少文件中的一个数组元素的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T00:00:36.067

在创建第一个文件（对于第 0 个元素）之前增加 filenumber 值。这导致 4 个文件，即索引 1-4 中的元素。未创建第 0 个文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T00:01:59.510

您缺少一堆分号-我不确定这是否导致问题（甚至不应该运行）

确保需要分号的每一行都有它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T00:24:08.163

其他人基本上已经回答了，但是从您的评论中我认为还不清楚。您会自动将第一个字符串显示到屏幕上，而不是文件上。最好将文件操作移出 actionPerformed() 方法。按照您编写的方式，仅在按下按钮时才调用文件操作，而第一个字符串绝不是这种情况。

这可能更清楚：

```
public class mainFrame extends JFrame implements ActionListener {
    ........
    private JButton answer1 = new JButton();
    String [] a = {"a","b","c","d","e"}
    in fileNumber = 0; 
}

public mainFrame (){
    nextString();
    answer1.addActionListener(this); 
}

public void actionPerformed(ActionEvent e) {     
    if (e.getSource==answer1) nextString();
}

private void nextString() {
    try {
        .....
        System.out.println(a.get(fileNumber))
        fout = new FileOutputStream ("myfile.txt",true);
        Filename = new File(files.get(fileNumber));      
        new PrintStream(fout).println (Filename);
        new PrintStream(fout).println ("Answer 1");
        fileNumber++;      
    }
    ...
} 
```

# version-control - 与 VisualStudio + Xcode 一起使用的源代码控制？

> ID：671829
> 
> 赞同：1
> 
> 时间：2009-03-22T23:53:09.267
> 
> 标签：version-control

除了我在工作中使用的 [Perforce] 之外，我对源代码控制知之甚少。我正在寻找具有以下功能的产品..

*   自由
*   集中式（运行在局域网上的服务器）
*   与 Microsoft Visual Studio 的良好集成（内置/免费插件？）
*   与 Apple Xcode 的良好集成（内置/免费插件？）

有很多符合这些标准吗？你会选择什么？

感谢您的任何意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T23:58:25.447

Xcode 内置了对 SVN、CVS 和 Perforce 的支持。

Visual Studio 有一个适用于大多数源代码控制系统的插件。一个免费的 svn 是[Ankhsvn](http://ankhsvn.open.collab.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T23:54:31.837

SVN 听起来是您唯一的选择。不过，我会质疑你为什么认为你需要一个集中式服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T23:55:31.570

那么颠覆是第一个想到的。

*   视觉工作室的 Ankhsvn/visual svn
*   [http://developer.apple.com/tools/subversionxcode.html](http://developer.apple.com/tools/subversionxcode.html)用于 xcode

# java - 休眠不反映变化

> ID：671830
> 
> 赞同：1
> 
> 时间：2009-03-22T23:53:09.393
> 
> 标签：java, hibernate, jakarta-ee, struts

我有一个使用 Hibernate 访问 MYSQL DB 的 struts 应用程序。我有许多对数据库进行更改的页面。这些更改顺利进行，数据在数据库中更新。但是，当浏览到应该显示此更新信息的页面时，它通常不存在，即使在几次页面刷新后它仍然不存在。最终它会出现。我假设这与休眠缓存数据有关，但是如何确保数据是最新的？我曾假设，当这一切都通过休眠会话时，它会接受变化？我用来进行更新的代码是：

```
 hSession = HibernateUtil.getSessionFactory().getCurrentSession();
    Transaction tx = hSession.getTransaction();
    tx.begin();
    hSession.update(user) ; 
```

然后再次将该用户拉出：

```
org.hibernate.Session hSession = HibernateUtil.getSessionFactory()
.getCurrentSession();
 Transaction tx = hSession.beginTransaction();
 User u= (User) hSession.load(User.class, userID); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T00:05:18.957

信息太少，无法真正给出答案。但有几点需要检查：

*   您正在使用事务。你是否正确地提交了它们？也许在某些时候您的代码看不到更改，因为尚未提交（或者因为读取代码在另一个使用先前状态的事务中）。

*   缓存也可能是个问题。要检查，您可以在每次更改数据库 (Session.flush()) 后显式刷新缓存。这可能会降低性能，但可能会帮助您缩小问题范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T00:02:17.263

这可能是[二级（会话工厂）休眠缓存](http://www.hibernate.org/hib_docs/reference/en/html/performance-cache.html)的结果。

缓存*应该*是透明的，并且可以与您提供的代码一起正常工作，但通常在以下情况下会出现问题：

1.  您正在运行一个机器集群，并且没有办法让配置的缓存相互失效
2.  您正在休眠之外更新数据库。

确定它是否是二级缓存问题的最简单方法是在您的休眠配置中完全禁用缓存。如果是缓存，您可以配置集群以相互了解，以便他们可以自动管理缓存，或者如果是外部休眠更新的问题，您可以使用[休眠 api手动使缓存项无效](http://www.hibernate.org/hib_docs/v3/api/)

# c# - 是否有访问 C++ 本机 COM 函数以与 C# 互操作的最佳实践？

> ID：671837
> 
> 赞同：1
> 
> 时间：2009-03-22T23:57:28.697
> 
> 标签：c#, c++, com, interop, native

是否有访问 C++ 本机 COM 函数以与 C# 互操作的最佳实践？

例如，如果我有 100 个与核心窗口组件交互的 C++ 方法（基本上是本机库）。

我想基本上用 C# 为这些 C++ 方法制作一个包装器，所以我所有新雇用的员工都可以使用它而不是 C++ 等。C++ 代码是遗留的，让我害怕，所以我只想处理一次。每种方法的方法是否都有相应的 C# 方法？事实上，还有其他方法可以做到这一点吗？

我可以有某种包装子系统吗？你们一般是怎么做的？

另外，是否有任何性能考虑等？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T00:18:05.807

如果您的 C++ 方法位于 COM 对象中，那么您可以使用 C# 中的 COM 互操作。请参阅[CLR Inside Out: Introduction to COM Interop](http://msdn.microsoft.com/en-us/magazine/cc163494.aspx)以获得很好的介绍。

如果这些 C++ 方法更像是传统的 API 调用，那么您将需要使用 Platform Invoke（即 PInvoke）。这需要在 C# 中为非托管（C++ 函数）创建托管原型。[平台调用教程](http://msdn.microsoft.com/en-us/library/aa288468.aspx)是一个很好的起点。

就性能考虑而言，通常不必担心太多。从 C# 调用*可能*比直接从 C++ 调用要慢一些，这在很大程度上是由于封送数据。除非您调用的代码处于关键循环中，否则您不会注意到任何差异。

这实际上取决于那些本机函数的作用。您必须在非托管和托管世界之间共享数据越多，该过程就变得越困难。如果没有有关您的特定功能的更多信息，很难说出您可能会在哪里遇到问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T00:08:11.400

使用 COM 互操作来包装库。然后，您可以或多或少地将 C++ 代码视为可以以正常方式调用的[.NET本机代码。](http://en.wikipedia.org/wiki/.NET_Framework)

# .net - .NET 在结构和类之间进行选择

> ID：671847
> 
> 赞同：4
> 
> 时间：2009-03-23T00:03:09.727
> 
> 标签：.net

**重复：** [我什么时候应该使用结构而不是类？](https://stackoverflow.com/questions/85553/when-should-i-use-a-struct-instead-of-a-class/85656)

只是想知道是否有人可以提供一些建议或示例，说明何时最好在 .NET 中对类使用结构，反之亦然

我已经完成了一些背景阅读并了解了两者之间的区别，即结构存储在堆栈上，类存储在堆上等。但是还没有找到一些明确的例子，其中一个比另一个更有利。

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T00:20:50.137

引用[同一个问题的好答案](https://stackoverflow.com/questions/85553/when-should-i-use-a-struct-instead-of-a-class/85656#85656)（[我什么时候应该使用结构而不是类？](https://stackoverflow.com/questions/85553/when-should-i-use-a-struct-instead-of-a-class/85656)）：

> MSDN 有答案：[在类和结构之间选择。](http://msdn.microsoft.com/en-us/library/ms229017.aspx)
> 
> 基本上，该页面为您提供了一个包含 4 项的清单，并说除非您的类型满足所有标准，否则使用一个类。
> 
> 除非类型具有以下所有特征，否则不要定义结构：
> 
> *   它在逻辑上表示单个值，类似于原始类型（整数、双精度等）。
> *   它的实例大小小于 16 字节。
> *   它是不可变的。
> *   它不必经常装箱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T00:05:15.477

使用 a `class`，除非您有非常具体的理由使用 a `struct`。有关某些具体原因，请参阅 [有关结构的问题。](https://stackoverflow.com/questions/667285/questions-about-structs)

**编辑：**`struct` a over a 的一个可能优势`class`是您永远无法拥有`null`实例。请参阅[有没有办法要求提供给方法的参数不为空？](https://stackoverflow.com/questions/754330/is-there-a-way-to-require-that-an-argument-provided-to-a-method-is-not-null/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T00:06:21.310

我更喜欢类。

```
Structure TestStruct
    Dim Name as String
End Structure

Dim x as TestStruct

If x Is Nothing Then 
'ALWAYS returns false. A class would return true. Nullability, baby. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T00:18:53.183

我为你找到了这个页面。它解释了在哪里使用一个或另一个，每个的优点和缺点。

[http://www.jaggersoft.com/pubs/StructsVsClasses.htm](http://www.jaggersoft.com/pubs/StructsVsClasses.htm)

问候！！！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T00:19:22.480

非常基本的指南，甚至不是 .NET 特定的：

除非您需要非常小、非常简单的容器，否则对所有内容都使用 CLASS。如果你不想要属性或函数，你应该使用一个类。

我认为结构的一个很好的例子是当您需要创建一个项目数组时，但这些项目是 int 和 string 的“对”。像这样基本的东西

# c - 不合逻辑的基准测试？

> ID：671848
> 
> 赞同：-1
> 
> 时间：2009-03-23T00:03:45.403
> 
> 标签：c, optimization, loops, benchmarking

我目睹了以下奇怪的行为。我有两个功能几乎相同 - 它们测量执行某个操作所需的周期数。在一个函数中，在循环内我增加了一个变量；在其他什么都没有发生。这些变量是易变的，因此它们不会被优化掉。这些是功能：

```
unsigned int _osm_iterations=5000;

double osm_operation_time(){
    // volatile is used so that j will not be optimized, and ++ operation
    // will be done in each loop
    volatile unsigned int j=0;
    volatile unsigned int i;
    tsc_counter_t start_t, end_t;
    start_t = tsc_readCycles_C();
    for (i=0; i<_osm_iterations; i++){
       ++j;
    }
    end_t = tsc_readCycles_C();
    if (tsc_C2CI(start_t) ==0 || tsc_C2CI(end_t) ==0 || tsc_C2CI(start_t) >= tsc_C2CI(end_t))
         return -1;
    return (tsc_C2CI(end_t)-tsc_C2CI(start_t))/_osm_iterations;
}

double osm_empty_time(){
    volatile unsigned int i;
    volatile unsigned int j=0;
    tsc_counter_t start_t, end_t;
    start_t = tsc_readCycles_C();
    for (i=0; i<_osm_iterations; i++){
        ;
    }
    end_t = tsc_readCycles_C();
    if (tsc_C2CI(start_t) ==0 || tsc_C2CI(end_t) ==0 || tsc_C2CI(start_t) >= tsc_C2CI(end_t))
        return -1;
    return (tsc_C2CI(end_t)-tsc_C2CI(start_t))/_osm_iterations;
} 
```

那里有一些非标准功能，但我相信你会管理的。

问题是，第一个函数返回**4**，而第二个函数（据说做的更少）返回**6**，尽管第二个显然比第一个做的少。

这对任何人都有意义吗？

实际上，我创建了第一个函数，这样我就可以减少测量第二个函数的循环开销。你知道如何做到这一点（因为这种方法并没有真正削减它）？

我在 Ubuntu 上（我认为是 64 位）。

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T00:11:47.973

我可以在这里看到几件事。一是两个循环的代码看起来相同。其次，编译器可能会意识到变量`i`和变量`j`将始终具有相同的值并优化其中一个。您应该查看生成的程序集，看看到底发生了什么。

另一种理论是，对循环内部主体的更改影响了代码的可缓存性——这可能会将其移动到缓存行或其他一些东西上。

由于代码如此琐碎，您可能会发现很难获得准确的时序值，即使您进行 5000 次迭代，您可能会发现时间在您使用的时序代码的误差范围内。现代计算机可能可以在不到一毫秒的时间内运行它——也许你应该增加迭代次数？

要在 gcc 中查看生成的程序集，请[指定 -S 编译器选项](http://www.delorie.com/djgpp/v2faq/faq8_20.html)：

> 问：如何查看 GCC 生成的汇编代码？
> 
> 问：如何创建一个可以同时查看 C 代码及其汇编翻译的文件？
> 
> 答：使用 -S（注意：大写的 S）开关切换到 GCC，它会将汇编代码发送到扩展名为 .s 的文件中。例如，以下命令：
> 
> gcc -O2 -S -c foo.c
> 
> 将生成的汇编代码留在文件 foo.s 中。
> 
> 如果您想查看 C 代码及其转换为的程序集，请使用如下命令行：
> 
> gcc -c -g -Wa,-a,-ad [其他 GCC 选项] foo.c > foo.lst
> 
> 这会将组合的 C/程序集列表输出到文件 foo.lst。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T01:25:35.753

有时很难猜测这种事情，尤其是由于迭代次数很少。但是，可能发生的一件事是增量可以在一个空闲的整数执行单元上执行，从而获得一些轻微的并行度，因为它与 i 的值没有关系。

由于您提到这是 64 位操作系统，因此几乎可以肯定所有这些值都在寄存器中，因为 x86_64 架构中有更多寄存器。除此之外，我会说执行更多迭代，看看结果有多稳定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T01:27:03.347

如果你真的想测试一段代码的操作（`"j++;"`在这种情况下），你实际上最好执行以下操作：

1/ 在两个单独的可执行文件中执行此操作，因为可执行文件中的位置可能会影响代码。

2/ 确保你使用 CPU 时间而不是经过的时间（我不确定是什么`"tsc_readCycles_C()"`给了你）。这是为了避免 CPU 加载其他任务而导致错误结果。

3/ 关闭编译器优化（例如，`"gcc -O0"`）以确保`gcc`不会放入任何可能会影响结果的花哨的东西。

4/ 如果使用实际结果，则无需担心`volatile`，例如放置：

```
printf ("%d\n",j); 
```

在循环之后，或者：

```
FILE *fx = fopen ("/dev/null","w");
fprintf (fx, "%d\n", j);
fclose (fx); 
```

如果您根本不想要任何输出。我不记得 volatile 是对编译器的*建议还是强制执行。*

5/ 5,000 次迭代似乎有点偏低，“噪音”可能会影响读数。也许更高的价值会更好。如果您正在计时一段较大的代码并且您只是`"j++;"`作为占位符包含在内，这可能不是问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T06:02:37.053

当我运行与此类似的测试时，我通常：

1.  确保时间至少以秒计，最好是（小）几十秒。
2.  让程序运行一次，调用第一个函数，然后调用第二个函数，然后再调用第一个函数，然后再调用第二个函数，以此类推，看看是否有奇怪的缓存预热问题。
3.  多次运行程序以查看运行时间的稳定性。

我仍然无法解释您观察到的结果，但是如果您确定您的功能已正确识别（例如，鉴于之前存在复制粘贴错误，情况并非不言而喻），然后查看汇编器输出是剩下的主要选项。

# css - CSS属性优先的原因？

> ID：671851
> 
> 赞同：1
> 
> 时间：2009-03-23T00:04:57.727
> 
> 标签：css, standards

我实际上知道浏览器倾向于如何呈现以下示例（基于 Opera 9.5 和 Firefox 3.0 的结果），但我不明白它们背后的原因。

举这个例子，

```
<style type="text/css">
#outer{color:red;}
.inner{color:blue;}
</style>

<div id="outer" class="outer">
    <div id="inner" class="inner">
        <span>testing</span>
    </div> 
</div> 
```

结果是蓝色文本。

但是，现在看这个例子，

```
<style type="text/css">
#outer span{color:red;}
.inner span{color:blue;}
</style>

<div id="outer" class="outer">
    <div id="inner" class="inner">
        <span>testing</span>
    </div> 
</div> 
```

文本现在是红色的。

最后试试这个

```
<style type="text/css">
#outer span{color:red;}
#inner span{color:blue;}
</style>

<div id="outer" class="outer">
    <div id="inner" class="inner">
        <span>testing</span>
    </div> 
</div> 
```

我们再次有蓝色文本。

这种方法有特定的原因吗？

（抱歉标题不清楚，这是我能做到的最好的。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T00:24:48.350

W3C[详细解释](http://www.w3.org/TR/CSS21/cascade.html#cascade)了 CSS 应该如何级联和优先。对于您的确切情况，这就是正在发生的事情：

1.  虽然 "color" 是一个继承属性，但内部选择器以 span 本身为目标，因此它具有优先权。

2.  由于它们现在都以 span 为目标，因此更具体的一个（id 选择器）现在优先。

3.  它们现在都同样具体，因此稍后出现的声明优先。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T01:42:31.533

**在示例 1**中，span 元素不是直接定位的，因此我们必须研究如何处理[CSS 继承](http://www.w3.org/TR/CSS21/cascade.html#inheritance)。颜色是一个继承属性，所以我们需要查看 span 的最近父元素来确定颜色。在您的示例 1 中，类 (.inner) 定义了蓝色并将该继承传递给跨度。

**在示例 2**中，两个规则都直接针对 span 元素，因此我们必须查看[CSS Cascade](http://www.w3.org/TR/CSS21/cascade.html#cascade)以确定针对该元素的哪些规则最具体。具有 ID 选择器的规则获胜。

**在示例 3**中，我们再次调用 CSS Cascade 规则，并且由于两个特性相同，最后一个规则获胜。

请注意，在这种情况下：

```
 #outer {color: red; }
 span {color: blue; } 
```

文本将是蓝色的。这是因为第二条规则直接针对元素，因此不调用 CSS Cascade。

更多阅读：

*   [CSS 特殊性战争](http://www.stuffandnonsense.co.uk/archives/css_specificity_wars.html)
*   [了解特异性](http://snook.ca/archives/html_and_css/understanding_c/)
*   [扑克玩家的 CSS](http://iamacamera.org/default.aspx?id=95)

注意和披露：我撰写了第三篇博文。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T00:09:57.433

我希望这个解释有帮助：

EX 1）因为这些是一般规则，所以它应用直接父级 .inner 的颜色

EX 2) ID 比类更具体（因为只有一个元素具有给定 ID）因此 id 选择器被认为更具体和重要

EX 3）因为这两条规则同样具体，所以它选择最后一条规则

达科

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T00:15:19.247

级联（CSS 中的“C”）定义明确，可以明确定义哪些规则优先（包括允许重要的、用户和代理规则）。

但规则也不简单（具有指定大层次结构的复杂匹配）。

级联的最后一步是声明的文档顺序，最后获胜。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T00:22:52.410

在第一个示例中，第一个样式适用于外部 div。内部 div 然后继承此样式，但第二种样式适用于内部 div，因此它会覆盖继承的样式。

在第二个示例中，两种样式都适用于跨度。第一种样式优先，因为 id 比类更具体。

在第三个示例中，两种样式也适用于跨度。由于它们具有相同的特异性，因此最后一种样式优先，因为它是最后一种。

[您可以在此处](http://css.maxdesign.com.au/selectutorial/advanced_conflict.htm)阅读有关如何确定优先级的更多信息。

# apache-flex - 在一帧之后执行功能的最佳方法？

> ID：671857
> 
> 赞同：2
> 
> 时间：2009-03-23T00:07:18.080
> 
> 标签：apache-flex, actionscript-3, flash, timing

对于 Flash Player 9+ 的 ActionScript3，在恰好一帧之后调用“一次性”函数的最佳方式是什么？

我知道 Timer 类及其用途，以及 Flex UIComponents 上的 callLater 方法（浏览源代码，在这种情况下看起来效率不高）。我也知道 setTimeout（在 flash.utils 中）。

Timer 类和 setTimeout 实用程序都是基于时间的，那么我们如何保证我们的函数会在一帧之后被调用呢？

从我有限的测试来看，传递给 setTimeout 的函数似乎只在至少一帧后执行（尝试将延迟设置为 0）。但这不能保证。

当然，我们可以从 DisplayObject 侦听 Event.ENTER_FRAME 事件，但这对于一次性延迟函数调用来说似乎是多余的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T01:13:14.893

Flex 旨在抽象出 Flash Player 的基于帧的特性，因此您不会找到太多可以帮助您解决问题的方法。最好的方法是按照您的建议收听 ENTER_FRAME 。如果这太过分了（我不确定你为什么这么认为），你可以创建一个辅助类，它接受一个 DisplayObject 和 Function 作为参数，它会自动为你添加/删除 ENTER_FRAME 事件侦听器。

```
public class NextFrameCommand() {

    private var functionToCall : Function;

    public function NextFrameCommand(dObj: DisplayObject, func : Function) {
        functionToCall = func;
    }

    public function start() : void {
        dObj.addEventListener(Event.ENTER_FRAME, onEnterFrame);
    }

    private function onEnterFrame(e : Event) : void {
        e.target.removeEventListener(Event.ENTER_FRAME, onEnterFrame);
        functionToCall.call();
    }

} 
```

我还没有测试过那个代码，但希望你能明白......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T17:28:21.273

使用 Theo 和 brd6644 提供的解决方案，我带来了这个。它允许多个函数（带参数）在下一帧按顺序排列和执行。

```
public class DelayedFunctionQueue
{
    protected var queue:Array;
    protected var dispatcher:Sprite;

    public function DelayedFunctionQueue()
    {
        queue = new Array();
        dispatcher = new Sprite();
    }

    public function add( func:Function, ... args ):void
    {
        var delegateFn:Function = function():void
        {
            func.apply( null, args );
        }
        queue.push( delegateFn );
        if ( queue.length == 1 )
        {
            dispatcher.addEventListener( Event.ENTER_FRAME, onEF, false, 0, true );
        }
    }

    protected function onEF( event:Event ):void
    {
        dispatcher.removeEventListener( Event.ENTER_FRAME, onEF, false );
        queue = queue.reverse();
        while ( queue.length > 0 )
        {
            var delegateFn:Function = queue.pop();
            delegateFn();
        }
    }
} 
```

可能对某人有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T00:19:41.793

一种方法是查看您的项目设置为每秒多少帧，并让 setTimeout 函数在该设置内延迟 1 帧时间。

因此，如果您的项目设置为每秒 24 帧，则在 setTimeout 中延迟 42 毫秒。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T01:15:49.007

```
var timerSprite:Sprite = new Sprite();

timerSprite.addEventListener(Event.ENTER_FRAME, oneFrameHandeler);

function oneFrameHandeler(e:Event):void
{
   timerSprite.removeEventListener(Event.ENTER_FRAME, oneFrameHandeler);
   timerSprite = null;

   trace("one frame later!")
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-10-21T16:27:25.550

ENTER_FRAME 并不过分——这样的事情很简单

```
addEventListener(Event.ENTER_FRAME, function(e:Event):void
{
    removeEventListener(Event.ENTER_FRAME, arguments["callee"]);
    onceOffFunction();
} 
```

# javascript - 如果 xml 节点中没有值，如何让我的小部件不崩溃？

> ID：671861
> 
> 赞同：1
> 
> 时间：2009-03-23T00:09:52.237
> 
> 标签：javascript, xml, return-value, yahoo-widgets

我正在获取一个 xml 文件并希望从中获取数据。xml 的来源并不重要，但我必须得到的某个字段是：

```
tracks = xmlDoc.getElementsByTagName("track");
variable = tracks.item(i).childNodes.item(4).childNodes.item(0).nodeValue; 
```

现在这就像一个魅力，除非节点中没有价值。所以如果结构是这样的：

```
<xml>
 <one>
  <two>nodeValue</two>
 </one>
 <one>
  <two></two>
 </one>
</xml> 
```

小部件将在第二个“one”节点上崩溃，因为“two”节点中没有值。控制台说：

```
TypeError: tracks.item(i).childNodes.item(4).childNodes.item(0) has no properties 
```

关于如何让小部件只将空视为空字符串（null、空或“”）而不是崩溃的任何想法？我在猜测*data*、*getValue()*、*text*或其他内容。

使用

```
var track= xmlDoc.getElementsByTagName('track')[0];
var info= track.getElementsByTagName('artist')[0];
var value= info.firstChild? info.firstChild.data : ''; 
```

不起作用并返回“TypeError：track has no properties”。那是从第二行调用艺术家的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T00:31:02.593

在访问其数据之前测试“两个”节点是否有一个子节点。

childNodes.item(i)（或 JavaScript 简单形式 childNodes[i]）通常应该避免，它有点脆弱，因为空白文本节点位于预期的确切位置。

我会做类似的事情：

```
var tracks= xmlDoc.getElementsByTagName('track')[0];
var track= tracks.getElementsByTagName('one')[0];
var info= track.getElementsByTagName('two')[0];
var value= info.firstChild? info.firstChild.data : ''; 
```

（如果你事先不知道'one'和'two'的标记名，你总是可以使用'getElementsByTagName('*')'来获取所有元素，只要你不需要支持IE5，其中这不起作用。）

An alternative to the last line is to use a method to read *all* the text inside the node, including any of its child nodes. This doesn't matter if the node only ever contains at most one Text node, but can be useful if the tree can get denormalised or contain EntityReferences or nested elements. Historically one had to write a recurse method to get this information, but these days most browsers support the DOM Level 3 textContent property and/or IE's innerText extension:

```
var value= info.textContent!==undefined? info.textContent : info.innerText; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T01:30:30.623

without a dtd that allows a **one** element to contain an empty **two** element, you will have to parse and fiddle the text of your xml to get a document out of it.

Empty elements are like null values in databases- put in something, a "Nothing" or "0" value, a non breaking space, anything at all- or don't include the **two** element.

Maybe it could be an **attribute** of **one**, instead of an element in its own right. Attributes can have empty strings for values. Better than phantom elements .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T15:30:41.400

Yahoo! Widgets does not implement all basic javascript functions needed to be able to use browser-code in a widget.

instead of using:

```
tracks = xmlDoc.getElementsByTagName("track");
variable = tracks.item(i).childNodes.item(4).childNodes.item(0).nodeValue; 
```

to get values it's better to use Xpath with a direct conversion to string. When a string is empty in Yahoo! Widgets it doesn't give any faults, but returns the 'empty'. innerText and textContent (the basic javascript way in browsers, used alongside things like getElementsByTagName) are not fully (or not at all) implemented in the Yahoo! Widgets Engine and make it run slower and quite awfully react to xmlNodes and childNodes. an easy way however to traverse an xml Document structure is using 'evaluate' to get everything you need (including lists of nodes) from the xml.

After finding this out, my solution was to make everything a lot easier and less sensitive to faults and errors. Also I chose to put the objects in an array to make working with them easier.

```
 var entries = xmlDoc.evaluate("lfm/recenttracks/track");
            var length = entries.length;
            for(var i = 0; i &lt; length; i++) {
                var entry = entries.item(i);
                var obj = {
                    artist: entry.evaluate("string(artist)"),
                    name: entry.evaluate("string(name)"),
                    url: entry.evaluate("string(url)"),
                    image: entry.evaluate("string(image[@size='medium'])")
                    };
                posts[i] = obj;
            } 
```

# ant - ANT：按优先级顺序复制具有相同文件的多个文件集的内容

> ID：671867
> 
> 赞同：3
> 
> 时间：2009-03-23T00:14:57.997
> 
> 标签：ant, build-process, build

我正在尝试构建一个 Web 应用程序，它从多个位置获取它的类文件。这些位置可以包含相同的类文件。我需要能够指定优先级，以便在复制类时某些位置优先于其他位置。

我们有单独的 ant 脚本来构建 WAR 文件。这个构建是为了在我开发时在任何更改的类中进行热交换。所以这个构建必须很快。

例如，我的两个上课地点是：

*   /垃圾桶
*   /构建/类

我希望将这两个目录中的类复制到：/web/WEB-INF/classes

但是，如果这两个位置都包含相同的类文件，例如：

*   /bin/com/ben/Test.class
*   /build/classes/com/ben/Test.class

我希望 /bin 中的文件始终优先。

所以在示例中：

*   文件：/bin/com/ben/Test.class，将被复制。
*   文件：/build/classes/com/ben/Test.class 将被忽略。

我当前的脚本如下所示：

```
<sync todir="${deploy}/WEB-INF/classes" verbose="true">
    <fileset dir="bin"/>
    <fileset dir="build/classes"/>
</sync> 
```

这可行，但每次运行脚本时，悬空文件都会被删除。我也不确定是否保证这里有任何优先级。

任何援助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T01:03:07.790

悬空文件被删除是指已经在“${deploy}/WEB-INF/classes”目录中的文件吗？

同步将清除目标目录中的现有文件，如果您不希望发生这种情况，我建议使用复制。

至于拥有更高优先级的文件夹，您可以多次复制并覆盖现有文件。

```
 <copy todir="${deploy}/WEB-INF/classes" verbose="true">
    <fileset dir="build/classes"/>
  </copy>

  <copy todir="${deploy}/WEB-INF/classes" verbose="true"  overwrite="true">
    <fileset dir="bin"/>
  </copy> 
```

现在，test.class 将从 build/classes 复制，然后被 bin 中的 test.class 覆盖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T08:15:12.367

在我看来这是一个非常糟糕的主意，因为如果你有问题，他们会很费时间去发现。但如果你真的想这样做，这里有一个可能的解决方案

```
<war [...] duplicate="preserve">
    [...]
    <classes dir="bin"/>
    <classes dir="build/classes"/>
</war> 
```

# c# - 防止循环引用

> ID：671869
> 
> 赞同：0
> 
> 时间：2009-03-23T00:15:14.363
> 
> 标签：c#, architecture

我创建了一个包装器项目，用于与 3rd 方 API 对话。

在另一个项目中，我们将其命名为 MyBusinessLayer.csproj。它通过添加包装器项目作为项目引用来使用此 API，以便它可以使用各种类通过 HttpRequest / HttpResopnse 调用 API 方法。

现在我需要通过调用一个名为 UpdateRequest.cs 的包装类来进行批量更新，并遍历我们数据库中的每条记录，并使用每条记录中的一些字段进行 API 调用来更新每条记录。

问题是这样的：

1）我想在我的包装项目中创建像 BulkUpdateRequest.cs 一样的东西。
2）问题是它必须将一个通用的对象列表带入构造函数。这个通用的对象列表（我从数据库中提取的记录），对象的 .cs 驻留在 MyBusinessLayer.csproj 中，因为它代表我的数据库中该表的每个记录的表和实例。如果我将这些对象的通用列表发送到我的包装器。BulkUpdate.cs 类执行循环和发送更新通用列表中所有这些记录的请求，我刚刚介绍了循环引用，因为 MyBusinessLayer.csproj 正在引用 MyWrapperProject.csproj。然后 MyWrapperProject.csproj 引用 MyBusinessLayer.csproj 中的一个类，因为它'

所以我猜想防止循环引用发生的最佳方法是什么？我想我可以改为在 MyBusinessLogic.csproj 中创建 BulkUpdate 逻辑，这样，我只是引用 UpdateRequest.cs 并在我在 MyBusinessLayer.cs 中创建的某个类中执行循环，并且只使用我们包装器中的 UpdateRequest.cs 类项目，而不是将任何 MyBusinessLayer 类发送到该包装器项目。

我希望这是有道理的...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T00:28:25.953

我将在假设您引用的“对象的通用列表”是在您的 MyBusinessLayer 项目中定义的某种类型而不是 System.Object 的情况下进行操作。我想你这么说。

一个解决方案是让 MyBusinessLayer 和 MyWrapperProject 都依赖于第三个项目 (MyAbstractDefinitions)，其中包含 IDatabaseObject.cs 和从 IDatabaseObject 派生的任何其他接口类型。MyBusinessLayer 和 MyWrapperProject 都不应该依赖于表示数据库中记录的这个对象的具体实现。这两个项目都应该依赖于一个抽象的定义。

# php - 在 PHP 中最有效地对数组中的 x 和 y 坐标进行排序？

> ID：671871
> 
> 赞同：1
> 
> 时间：2009-03-23T00:15:37.870
> 
> 标签：php, optimization, sorting

目前我有一个数组，其中包含不同位置的 x 和 y 坐标。

前任。

```
$location[0]['x'] = 1; $location[0]['y'] = 1 
```

这表明 id 0 的位置为 (1,1)。

有时我想按 x 对这个数组进行排序，有时按 y 排序。

目前我正在使用`array_multisort()`对我的数据进行排序，但我觉得这种方法效率低下，因为每次在排序之前，我必须`$location`在调用`array_multisort()`命令。

有谁知道更好的方法来做到这一点？即使像这样存储数据也可能是个坏主意？任何建议都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T00:30:32.563

您可以使用[usort()](http://php.net/usort)来选择数组元素的比较方式。

```
// sort by 'y'
usort($location, 'cmp_location_y');

// or sort by 'x'
usort($location, 'cmp_location_x');

// here are the comparison functions
function cmp_location_x($a, $b) {
    return cmp_location($a, $b, 'x');
}

function cmp_location_y($a, $b) {
    return cmp_location($a, $b, 'y');
}

function cmp_location($a, $b, $key) {
    if ($a[$key] == $b[$key]) {
        return 0;
    } else if ($a[$key] < $b[$key]) {
        return -1;
    } else {
        return 1;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T16:16:16.423

你想继续使用多重排序。

我对 usort 和 array_multisort 做了一个快速的基准测试。即使只有 10 个多排序，构建索引也比 usort 快。在 100 个元素时，它的速度大约快 5 倍。在大约 1000 个元素处，改进水平以更快的幅度下降。用户函数调用太慢了。我正在运行 5.2.6

```
$count = 100;

for ($i = 0; $i < $count; $i++)
{
  $temp = array('x' => rand(), 'y' => rand());
  $data[] = $temp; 
  $data2[] = $temp; 
}

function sortByX($a, $b) { return ($a['x'] > $b['x']); }

$start = microtime(true);
usort($data, "sortByX");
echo (microtime(true) - $start) * 1000000, "<br/>\n";

$start = microtime(true);
foreach ($data2 as $temp)
  $s[] = $temp['x'];
array_multisort($s, SORT_NUMERIC, $data2);
echo (microtime(true) - $start) * 1000000, "<br/>\n"; 
```

PHP 目前没有像 ruby​​ 这样的 array_pluck 函数。完成后，您可以替换此代码

```
foreach ($data2 as $temp)
    $s[] = $temp['x'];` 
```

和

```
$s = array_pluck('x', $data2); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T02:13:03.377

就像 jcinacio 所说的那样。使用这个类，您可以真正存储和排序各种数据，而不仅仅是不同维度的位置。您可以根据需要实现其他方法，例如删除等。

```
class Locations {
    public $locations = array();
    public $data = array();
    public $dimensions = 2;

    public function __construct($dimensions = null)
    {
        if (is_int($dimensions))
            $this->dimensions = $dimensions;
    }

    public function addLocation()
    {
        $t = func_num_args();

        if ($t !== $this->dimensions)
            throw new Exception("This Locations object has {$this->dimensions} dimensions");

        $args = func_get_args();

        for ($i = 0; $i < $t; $i++)
            $this->locations[$i][] = $args[$i];

        return $this;
    }

    public function sortByDimension($dimension = 1) 
    {
        if ($dimension > $this->dimensions)
            throw new Exception("Wrong number of dimensions");

        --$dimension;

        $params[] = &$this->locations[$dimension];

        for ($i = 0, $t = $this->dimensions; $i < $t; $i++) {
            if ($i === $dimension)
                continue;

            $params[] = &$this->locations[$i];
        }

        call_user_func_array('array_multisort', $params);

        return $this;
    }
} 
```

测试数据：

```
$loc = new Locations(3);

$loc
    ->addLocation(1, 1, 'A')
    ->addLocation(2, 3, 'B')
    ->addLocation(4, 2, 'C')
    ->addLocation(3, 2, 'D')
;
$loc->sortByDimension(1);
var_dump($loc->locations);
$loc->sortByDimension(2);
var_dump($loc->locations); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-23T00:32:33.760

保留您拥有的数组和多重排序，将结构更改为以下内容将消除对先前传递的需要：

```
$locations = array( 
    'x' => $x_coordinates,
    'y' => $y_coordinates,
    'data' => $data_array
); 
```

然后只需在所有列上使用 array_multisort() 。

# windows - 什么是唯一识别计算机的好方法？

> ID：671876
> 
> 赞同：63
> 
> 时间：2009-03-23T00:19:13.293
> 
> 标签：windows, macos, uniqueidentifier

我正在开发一些桌面软件供客户转售。客户希望限制软件，以便注册码将特定于一台且仅一台计算机。

除了使用网卡中的 MAC 之外，还有其他技术（适用于 Windows 和 Mac OS X）来唯一识别计算机吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-03-23T00:40:31.633

另一种解决方案是使用带有**[加密狗](http://en.wikipedia.org/wiki/Dongle#Copy_protection)**的许可技术。这是一个插入主机上的 USB 或其他 I/O 端口的小型设备，用作激活软件的唯一物理密钥。

第三种解决方案是提供**许可证管理器**。也就是说，当软件启动时，它会查询网络上的服务器（无论是在客户的 LAN 上，还是在您的公司通过 Internet 访问），以验证客户对该软件的使用是否合法。这是“并发许可”的一个很好的解决方案，因此客户可以在许多主机上安装您的软件，但您许可它在有限数量的主机上同时使用。 [FLEXnet Publisher](http://www.acresso.com/products/fnp/flexnet-publisher-overview.htm)是许可证管理解决方案的一个示例。

网卡的 MAC 地址是我上次为一家许可软件在特定主机上运行的公司工作时使用的解决方案。

但是，我想提醒您：如果您进行这种类型的许可，您必须预料到跟踪客户的许可将成为一项**持续的管理工作。**一旦您有几百个客户，您会惊讶于收到要求更改密钥的电话的频率

> “我们将服务器升级为千兆网络适配器，但现在许可证无法使用，因为新适配器具有不同的 MAC 地址。”

否则客户可能会更换他们的整台机器，并且需要更新的许可证才能在新机器上运行您的软件。在我工作的公司，我们几乎每天都会接到这些电话。

如果您给他们一个新密钥，您还需要相信客户停止在旧计算机（或网络适配器）上使用您的软件。如果你一开始就不能相信他们会遵守许可证，你怎么能相信他们会扔掉旧钥匙呢？

如果您不计划如何支持此管理活动，请不要以这种方式许可您的产品。你只会给那些本来会合作的好客户带来不便。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-09-17T17:57:44.387

最好的方法是在 Windows 中使用 C# 获取 UUID

[唯一识别 Windows 机器的最佳方法](http://www.nextofwindows.com/the-best-way-to-uniquely-identify-a-windows-machine)

```
public string GetUUID()
{
    var procStartInfo = new ProcessStartInfo("cmd", "/c " + "wmic csproduct get UUID")
    {
        RedirectStandardOutput = true,
        UseShellExecute = false,
        CreateNoWindow = true
    };

    var proc = new Process() { StartInfo = procStartInfo };
    proc.Start();

    return proc.StandardOutput.ReadToEnd().Replace("UUID", string.Empty).Trim().ToUpper();
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-23T00:25:38.143

我会在这里扮演魔鬼的拥护者，告诉你这样的事情可能不是在“公共”讨论的最佳事情。

话虽如此，看看其他人可能做了什么，并可能改进（或采取一部分）它。正如您所说，MAC 地址可能可以使用。我听说 Windows 和其他程序使用硬盘驱动器信息（序列号）——根据[这个站点](http://www.aumha.org/win5/a/wpa.php)，Windows 激活检查 10 个不同的项目并将它们变成一个唯一的密钥。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-01-23T16:58:51.537

我正在玩弄的想法是使用一些与硬件相关的序列号或唯一 ID 并将它们散列在一起。

升级的东西：-内存-MAC（可以被欺骗，USB适配器被插入等）

不经常升级的东西：-CPU -BIOS -Motherboard

使用 WMIC 可能是获取一些信息的好方法，我会首先获取不经常更改的东西作为首选和首选，我希望能够识别至少 2 个序列号或设备以用于生成注册密钥。

```
wmic cpu get DeviceId /format:value 
```

这将获取 CPU ID，您可以运行该命令：

1 - CPU (cpu:DeviceID) 2 - 主板 (baseboard:serialnumber) 3 - BIOS (bios:serialnumber)

如果您没有得到至少 2 个填充值，则抓取

4 - 网络适配器 - (nic:MACAddress) 5 - RAM - (memphysical:SerialNumber)

根据您的业务逻辑，您可以使用前两个可用的序列号来创建您的注册号，如果您始终遵循相同的顺序，那么在重新安装时注册号仍然有效，但是如果设备发生更改或用户尝试在辅助计算机上安装使注册号无效的 ID 更改。为了减少技术支持电话的数量，您使用指纹识别的硬件数量最少，并且如果您尝试对最不可能升级的项目进行指纹识别，则会进一步减少头痛。我的偏好是上面的顺序。

您可以使用 Diffie-Hellman 密钥交换方案让用户生成一个私有/公共密钥对，并将其硬件 ID 作为有效负载，然后将此信息传递到注册服务器，注册服务器将使用公共/私有密钥解密有效载荷并计算注册密钥以返回给最终用户。我喜欢使用 JWT 来回传递信息，而公钥包含在 JWT 的有效负载中。希望有帮助。

上面提到了 UUID，这是一个好主意，您可以通过使用 Windows cmd.exe 中的以下命令来获得它：

```
wmic csproduct get UUID /format:value 
```

免责声明这些命令仅适用于我认为 2000 及更高版本的 Windows，但您需要验证，它们可能适用于 2000 以下的系统，但那时我真的尽量不支持这些设备。祝你好运。*看起来 WMI 正在被弃用以支持 powershell，因此为了使这篇文章保持最新状态，这里是 power shell 命令。

```
Get-CimInstance -ClassName Win32_Processor | Select SerialNumber

Get-CimInstance -ClassName Win32_BaseBoard | Select SerialNumber

Get-CimInstance -ClassName Win32_Bios | Select SerialNumber

Get-NetAdapter -Physical | Where-Object Status -like Up | Select-Object MacAddress

Get CimInstance -ClassName Win32_PhysicalMemory | Select SerialNumber 
```

网络适​​配器 cmdlet 将仅检查物理适配器，因此无法使用和操纵虚拟适配器，我喜欢使用第一个已启动或正在使用的适配器，以便由于安装原因无法交换备用 NIC。

在 Mac 上：

```
system_profiler | grep "Serial Number (system)" 
```

在 Linux (debian) 上：

```
sudo dmidecode -t system | grep "Serial Number" 
```

dmidecode 和 system_profiler 有其他组件，它可以从类似于 windows 中的 wmic 获取序列号。我不在 Mac 上工作，所以我无法确认确切的规格列表，但创建一个 LCD 列表（最小公分母），所有三个命令都可以访问的部件的序列号放在一起并整理到最不可能要升级或更改的部件。然后，前 2-3 个哈希数字的组合可以形成一个更强大的唯一机器 ID，并且即使在更新了操作系统的设备上也可以激活跨平台应用程序。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-23T01:01:58.213

如果您假设一台计算机由许多最终可以更换的部件组成，那么没有确定的方法可以唯一地识别一台计算机。

一些硬件部分——MAC 地址、HDD 磁盘序列号，甚至主板序列号等——是一些很好的“唯一性”来源，但您可能知道，如果客户决定升级许可证所依赖的部分……请做好准备一些客户支持。另外要记住的是，某些部分可能会被欺骗（MAC 就是其中之一）。

在线许可证检查是另一种好方法 - 您可以管理服务器端的所有内容，甚至可以为它定义自己的规则（每个客户端/安装有多少许可证、并发性等），但要注意的重要一点是，当无法建立连接？

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-23T01:43:32.247

我只会使用 MAC 地址生成请求密钥，然后要求用户向您的客户端注册。您的客户将拥有一个特殊的应用程序，该应用程序接受该请求密钥并生成一个激活密钥，然后用户可以使用该激活密钥来激活软件。一旦激活，该软件就可以正常工作了——无需偶尔打电话回家进行验证等。

如果这是一个真正的要求。我的首要任务是尝试说服客户这是一个坏主意。

原因是这些方案实际上**永远不会**阻止您的代码被破解。但是，它们确实使您真正客户的生活更加艰难。我发现很难想到任何其他行业会不遗余力地用永远无法实现其目标的计划来惹恼真正的客户（当然，除了政府服务:-)。

如果你**必须**这样做，我只是做一个象征性的努力来履行合同义务（但是不要告诉你的客户）。将 MAC 地址（如果`$DEITY`计算机没有网卡，则为随机数）作为请求密钥，并使用程序将`XOR`其与 ASCII 字符串一起获取激活密钥，这似乎是一种可行的方法。我还会存储这两个密钥，因为如果他们只是更改网卡（甚至主板），您不希望软件停用 - 他们仍然将其视为同一台计算机，并且如果软件停止工作，他们将不高兴。

无论如何，您的代码都会被破解（除非程序是垃圾，我敢肯定不是这种情况） - 如果您的客户的公司以某种方式变得无响应，这种方法将为您的真正客户提供将他们的软件转移到另一台机器的途径（放弃支持，倒闭，等等）。

**所有**依赖硬件唯一性的方案的主要问题是客户可能会选择更改该硬件：

*   将其磁盘内容幻影到更大的硬盘会导致 HD 序列号发生变化。
*   使用 CPU 序列号意味着升级到最新的 Intel bigmutha CPU 会杀死您的软件。
*   使用 MAC 地址意味着他们无法更改其 NIC。

这些都可以通过使用这些值在安装时创建一个密钥来修复，并且只检查该密钥，而不是六个月后更改的值。这意味着您必须存储请求和激活值，但升级不需要您的用户完成重新激活其软件的过程。相信我，他们会因为你不得不这样做而鄙视你。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-01-23T11:26:28.840

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography

“MachineGuid”密钥是在 Windows 安装过程中唯一生成的，无论任何硬件交换如何，它都不会改变（除了更换安装操作系统的可引导硬盘驱动器）。我不确定这一点。

**我的建议**

您可以使用该 MachineGuid、硬盘序列号、主板序列号和 UUID。一起使用 SHA 256 或任何其他 HASH 函数对其进行 HASH。

**UUID** - wmic csproduct 获取 UUID

**MachineGuid** - HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography

**硬盘序列号**- wmic diskdrive 获取序列号

**BIOS 序列号**- wmic bios 获取序列号

**主板序列号**- wmic 基板获取序列号

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-05-21T17:52:43.167

可以创建用户必须输入一次的序列号。它应该包括用户的电子邮件地址（类似于 someuser@mailprovider.com-9828372-398232）。这将阻止许多人试图篡改它或将其提供给其他人。在激活过程中，软件应检查在线数据库是否存在序列号。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-02-06T19:47:10.760

使用主板唯一序列号怎么样？

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-06-09T14:10:29.503

打开注册表并导航到

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography

找到名为“MachineGuid”的密钥，该密钥是在安装 Windows 期间唯一生成的，无论进行任何硬件交换（除了更换安装操作系统的可引导硬盘驱动器），它都不会改变。这意味着如果您想继续跟踪每个操作系统的安装，这是另一种选择。除非您重新安装 Windows，否则它不会改变。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-23T00:29:19.663

据我所知，曾经有一个序列号印在 CPU 上；此信息（PSN，奔腾序列号）已被弃用。这些信息可能仍然存在，但至少在 P3 世界中它已经消失了。此外，我认为在 NIC 上为主机使用的主接口选择 MAC 地址的明显选择应该被认为是一种真正的可能性。除非您的客户不期望以太网接口出现在他们出售的主机上。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-23T01:21:47.900

您可能会考虑使用第三方许可实用程序，该实用程序更有可能获得此“正确”，并且还为您（或您的客户）在需求发生变化时提供额外的选项（而且它们不是总是如此吗？）。我会提到一些具体的名字，但我真的不是很熟悉它们。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-05-04T07:50:50.023

我对此有一些经验。在我的解决方案中，我们在向客户销售产品时发布服务密钥。

在客户端安装应用程序时，它通过读取客户端机器的主板序列来生成一个密钥。客户应该将服务密钥和安装时生成的密钥通过电子邮件发送给我们的组织以激活产品。

我们在问题激活密钥的组织中维护一个管理应用程序。我们只为特定服务密钥的密钥提供一个激活密钥。

我们卖了很多份，它运行没有问题。但后来我们发现有些电脑没有提供主板序列号。这些机器返回空值作为主板序列号。我们仍然试图解决这个问题。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-08-22T02:40:49.147

或者您可以简单地没有激活代码，并确保您拥有写入 EULA 的审核权，并不时行使您的审核权。

为甲骨文创造奇迹。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-03-21T06:45:06.030

如何散列任何有烧毁的 SN、硬盘驱动器、proc、ram 等的东西......这个散列将保留在计算机中，直到它的部件被更换。

# php - 我可以用 PHP 检测 IE6 吗？

> ID：671890
> 
> 赞同：48
> 
> 时间：2009-03-23T00:24:26.167
> 
> 标签：php, internet-explorer-6, cross-browser

有没有办法使用 PHP 来检测页面是否正在使用 IE6 加载？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-03-23T00:33:45.707

尝试检查他们的用户代理`'MSIE 6.'`。

```
$using_ie6 = (strpos($_SERVER['HTTP_USER_AGENT'], 'MSIE 6.') !== FALSE); 
```

这是基于[此用户代理信息](http://www.useragentstring.com/pages/Internet%20Explorer/)。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-23T00:28:20.290

您可以通过这种方式检测带有 HTML 的 IE6

```
<!--[if IE 6]>
// ie6 only stuff here
<![endif]--> 
```

~~[这是一个关于如何在 PHP](http://www.studioyucca.com/2008/10/01/detecting-ie6-in-php/)~~ ^([Way Back Machine](http://web.archive.org/web/20081221042900/http://www.studioyucca.com/2008/10/01/detecting-ie6-in-php/))`$_SERVER["HTTP_USER_AGENT"]`中完成的链接，但我在解析IE6时看到了许多误报

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-23T03:31:03.847

此页面上的许多基于用户代理的答案都不太可靠，因为 Opera 通常使用包含“MSIE 6.0”的用户代理字符串来标识自己，例如：

```
Mozilla/4.0 (compatible; MSIE 6.0; X11; Linux i686; en) Opera 9.51 
```

*这会影响 Opera 5 到 9 甚至 Opera 10 的所有版本，并且可以在 Opera 中打开或关闭。 [请参阅此页面](http://www.useragentstring.com/pages/Opera/)。*

我见过的一种常见方法是测试“MSIE”和“Opera”。例如，

```
if (preg_match('/\bmsie 6/i', $ua) && !preg_match('/\bopera/i', $ua))
  echo "We have IE6!"; 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-09-11T10:20:51.147

好吧，PHLAK...

我认为这个更好：P

```
 if(preg_match('/msie [2-6]/i',$_SERVER['HTTP_USER_AGENT'])) {
   // if IE<=6
  } else {
   //if IE>6
  } 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-03-23T00:46:48.560

您可以将[get_browser](http://php.net/get_browser)与[更新的 browscap.ini 文件](http://browsers.garykeith.com/downloads.asp)一起使用。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-09-13T22:52:31.927

就像其他人所说的那样，仅检查用户代理**就会**出现误报......所以为什么不**同时**使用用户代理检查和条件评论。

例如...

```
<? if (preg_match('/\bmsie 6/i', $_SERVER['HTTP_USER_AGENT']) { ?>
  <!--[if IE 6]>
    // ie6 only stuff here
  <![endif]-->
<? } ?> 
```

这样您就不会将这些不必要的代码发送回大多数浏览器......但在误报的情况下仍然是安全的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-23T00:58:17.410

您*可以*使用 HTTP User-Agent 标头，但如果可能，我强烈建议您不要这样做。User-Agent 标头很难准确解析，并且通过简单的字符串匹配往往会出现误报——甚至忽略浏览器伪装成其他浏览器的问题。例如 Jeremy 的“MSIE 6”。string 将匹配 IE Mobile，这与 IE6 非常不同，您通常不想将它们混为一谈。

另外，当您将不同的 HTML 发送到不同的浏览器时，您必须使用“Vary”标头（这会降低缓存的效率）以避免缓存将错误的页面发送到不同的浏览器。

因此，如果您能找到另一个地方进行浏览器差异化，那绝对是最好的。Ólafur 的条件注释方法通常是更改 JavaScript 和 HTML 标记/CSS 链接的最简单方法。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-01-04T00:03:21.290

您可以将它用于许多浏览器，但它很耗时，有时还会误报...

```
function do_stylesheet_link() {
// Picks up appropriate css file depending on the user-agent

//  if ( stristr($_SERVER['HTTP_USER_AGENT'], 'Firefox') ) {
//echo '<link rel="stylesheet" href="css/firefox.css" type="text/css" />'; }    

//elseif ( stristr($_SERVER['HTTP_USER_AGENT'], 'Chrome') ) {
//echo '<link rel="stylesheet" href="css/chrome.css" type="text/css" />'; }

//elseif ( stristr($_SERVER['HTTP_USER_AGENT'], 'Safari') ) {
//echo '<link rel="stylesheet" href="css/safari.css" type="text/css" />'; }

//elseif ( stristr($_SERVER['HTTP_USER_AGENT'], 'Opera') ) {
//echo '<link rel="stylesheet" href="css/opera.css" type="text/css" />'; }

    if ( stristr($_SERVER['HTTP_USER_AGENT'], 'MSIE 6.') )  {
echo '<link rel="stylesheet" href="css/ie6.css" type="text/css" />'; }

elseif ( stristr($_SERVER['HTTP_USER_AGENT'], 'MSIE 7.') ) {
echo '<link rel="stylesheet" href="css/ie7.css" type="text/css" />'; }

elseif ( stristr($_SERVER['HTTP_USER_AGENT'], 'MSIE 8.') ) {
echo '<link rel="stylesheet" href="css/ie8.css" type="text/css" />'; }

else {
echo '<link rel="stylesheet" href="css/style.css" type="text/css" />';
} 
```

}

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-03-28T09:31:53.967

`if(substr($_SERVER['HTTP_USER_AGENT'],0,34)=="Mozilla/4.0 (compatible; MSIE 6.0;") echo "I am stupid IE6";`

IE 6 总是以 "Mozilla/4.0 (compatible; MSIE 6.0;" 开头，IE 7,8 中间有 "MSIE 6"...

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-23T01:39:46.733

谢谢大家，我最终创建了以下函数并根据需要调用它：

```
// IE6 Check
function isIE() {
  $userAgent = strtolower($_SERVER['HTTP_USER_AGENT']);
  if (ereg("msie 6.0", $userAgent)) {
    return true;
  } else {
    return false;
  }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-06-25T16:07:22.777

列出的方法通常会标记带有某些插件的浏览器（例如，MathPlayer；以及一些恶意软件工具栏）。

我发现一个更可靠的方法是：

```
if( preg_match('/^Mozilla\/4\.0 \(compatible; MSIE 6/', $_SERVER['HTTP_USER_AGENT']) != 0 ) 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-11-23T19:41:05.140

更简单的东西：

```
if(stristr(strtolower($_SERVER['HTTP_USER_AGENT']), "msie 6.0")) {
    // IE6? Aren't you out of fashion yet?
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-06-06T15:36:23.147

```
function isIE($versions=array()) {
    if (!empty($versions))
        $versions = '('.implode('|',$versions).')';
    else
        $versions = '1?\d';
    $ua = $_SERVER['HTTP_USER_AGENT'];
    $is_not_opera = false===stripos($ua, 'opera');
    return $is_not_opera && preg_match('/\bmsie '.$versions.'\./i', $ua);
} 
```

使用：

```
$is_ie = isIE(); //Any version
$is_ie_7 = isIE(array(7)); //IE 7
$is_old_id = isIE(array(6,7));//IE 7 and 8 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-04-22T21:32:13.173

非常有帮助的线程。我用它来隐藏`<?xml>`IE6 的声明。原来 IE6 只检查文档的第一行是否有 doctype 嗅探，这意味着如果`<?xml>`字符串存在，IE6 将在 quirks 模式下呈现，而不管`<?xml>`声明后面的 doctype

我不确定包含歌剧检查是否重要，但无论如何都包含它。

```
//check if IE 6 or less
$not_lte_ie6 = true;
$ua = strtolower($_SERVER['HTTP_USER_AGENT']);
if(strpos($ua,'msie') !== FALSE) {
    if(strpos($ua,'opera') === FALSE) {
        if(preg_match('/(?i)msie [1-6]/',$ua)) $not_lte_ie6 = false;
    }
}
if ($not_lte_ie6)
    echo "<?xml version='1.0' encoding='UTF-8'?>\n"; 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-12-01T02:21:53.247

```
function isOldIE() {
    // don't support IE6 or below
    return preg_match('/MSIE [1-6]/', $_SERVER['HTTP_USER_AGENT']);
} 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-09-29T22:21:26.240

函数是 preg_match() 而不是 preg()，但是很好！

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2010-01-26T16:55:00.607

注意 IE8 还在其用户代理字符串中指定它与 IE6 兼容。

# macos - 无法将所有 GNU Unix 手册与 Mac 中的所有 Unix 手册进行比较

> ID：671893
> 
> 赞同：1
> 
> 时间：2009-03-23T00:24:50.487
> 
> 标签：macos, unix, manuals

我想通过 sdiff 比较所有 GNU Unix 手册和 Mac 的 Unix 手册。

例如，我不知道您如何浏览所有 Mac 的 Unix 手册，然后将它们保存到文件中。

当手册在两个文件中时，可以通过以下代码进行比较

```
sdiff <(file1) <(file2) 
```

也许，有一些 Unix 命令名称的索引，以便我们可以执行以下操作

```
sdiff <(man *[in the index]) <(man *[in the index]) 
```

**您如何将所有 GNU Unix 手册与 Mac 中的所有 Unix 手册进行比较？**

**[编辑]**

Mac 的手册位于 /usr/share/man/man[1-9]/*。当我尝试捕捉它们时，我遇到了它们的编码问题。

另一个问题是找到 Coreutils 手册的位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T02:13:20.133

GNU 意味着 (G)NU 是 (N)ot (U)nix。GNU 无论如何都不是基于 UNIX，它不可能是由于版权和许可问题。

大多数 GNU 文档都是以 texinfo 格式编写的（Debian 后来根据用户需要手册页将其转换为 roff (man) 格式）。该文档绝不是基于 BSD 文档，GNU 中的所有内容都是从头开始编写的。

试图在两者之间进行区分就像将字典与同义词库进行区分。您会发现它们都包含许多相同的单词，但是完全不同的人所写的完全不同的书。

该文档无法充分解释 GNU 和 BSD（以及扩展为 MacOS）之间的差异。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T02:50:55.597

您的目标是确定各种程序的不同 BSD 与 GNU/Linux 版本的不同参数，这将有些乏味。值得注意的是，所有命令还有其他变体。有 system V 版本、BSD 版本和 GNU 版本，Mac 使用所有 3 的混合。无论如何，作为起点，文件本身充满了您不感兴趣的格式化宏。管道man 通过 'col -b' 的输出来获取你可以比较的数据。在生成命令列表方面，你可以 ls -1 /bin /usr/bin' 然后这样的事情会让你大部分时间：

```
while read command ; do
    man $command | col -b > output1
    man ./path/to/GNU/$command | col -b > output2
    diff  output1 output2  |  grep  '^[ ]*-' > $command.diffs
 done<<EOF
 diff
 grep
 sort
 ...
 ...
 EOF 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T00:53:49.043

所有手册页都存在于 /usr/share/man/*; 我不确定您要在这里完成什么。Mac 在 BSD 上运行，因此大多数应用程序将与您在 BSD 机器上找到的应用程序相同。如果您仍想这样做，则需要在 *nix 中获取与 Mac 中相同的应用程序的手册页以及相同的版本（因为手册页可以更改）。是的，我会说做一个 diff /usr/share/man/man[0-9]/* 和来自 linux 盒子的所有手册页的扩展 tar。

# vb6 - 比 Visual Basic 6 更简单？

> ID：671895
> 
> 赞同：7
> 
> 时间：2009-03-23T00:26:55.490
> 
> 标签：vb6

几年前我用VB6编程，我非常喜欢它，因为它非常简单和快速，当VB.net出来时，我放弃了它，因为他们改变了很多东西。我想知道这些年来是否有一种新的语言或 IDE 可以以比 VB6 更容易和更快的方式帮助编程。我对学术/个人问题不太感兴趣，例如非常高性能、通过操作系统的强大移动性、开源等。我想知道是否有一些东西可以编写中小型桌面应用程序。以一种非常简单快捷的方式。

对不起，如果我的英语不是很清楚。

编辑回答 Nicholas：好吧，我必须承认我没有过多地尝试 VB.Net，我有点失望，因为我必须学习很多新东西，而且我不久前已经学习了 VB6（在那一刻）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-23T00:29:46.543

VB.Net 是 VB6 的自然发展，在线上有很多免费的工具和资源可供入门。Microsoft 甚至提供免费的开发环境以及免费的数据库，用于在您的应用程序中进行开发/捆绑。

查看[此网站](http://www.microsoft.com/Express/)以获取有关所有免费 Microsoft 软件的信息和下载链接。

另外，您说您尝试过 VB.Net 但不喜欢它——我很想知道为什么？是的，有一点学习曲线，但互联网上丰富的入门信息肯定会有所帮助。一开始我对 .NET（尤其是 ASP.Net）有点不知所措，没有看到切换/学习一门新语言的价值。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-23T00:28:53.237

我一直觉得 Microsoft Access 是满足这种要求的最佳选择。

编辑 - 我意识到这不是一个政治正确的答案。但是内置数据库的总包，一个*很棒的*GUI 开发包，一个很棒的报告生成器（例如，远远优于水晶报表），表格和查询的简单开发，都放在一个友好的包中，使它几乎微不足道一起发展。对于快速开发，它是我用过的最好的。

FWIW, 我做 Java, C++, C, VB4/6, ASP, JSP, Perl, PHP, CSS/DHTML, JavaScript, Pascal, Fortran, Kenemy and Kurtz Basic, BAL, unix shell scripting, Oracle, mySql, RPG III, COBOL，一些专有的东西，各种宏，各种分布式技术，作业控制语言，CPL 等等。由于可扩展性的限制，我退出了 Access 开发。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-23T01:09:00.630

[Powerbasic](http://www.powerbasic.com/)可能符合您的喜好 -

[http://www.powerbasic.com/](http://www.powerbasic.com/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T00:27:54.207

[Python](http://www.python.org/)是最容易学习和使用的语言之一。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-23T01:13:51.867

FLEX / AS3 / MXML / AIR (tnx [le dorfier](https://stackoverflow.com/users/31641/le-dorfier) ) 非常接近多年前的 VB6 感觉。但能理解 CSS 之类的东西，并生成可在任何平台（或带有 AIR 的桌面）上的浏览器中运行的输出。您编写代码并运行它，编码周期非常快。AS3 至少和 VB6 一样强大，还有无数的附加组件和库来支持各种应用程序，所有主要的 Web 服务、数据库界面、动画、视频、3D、自动生成 PHP 代码等等……等等……

Flex Builder 3对学生和教育工作者**免费**。

[替代文字 http://www.infoworld.com/infoworld/img/17TC-adobe-flex-builder.jpg](http://www.infoworld.com/infoworld/img/17TC-adobe-flex-builder.jpg)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-23T00:52:28.157

Microsoft 有一种新的 BASIC 方言，称为[Small Basic](http://msdn.microsoft.com/en-us/devlabs/cc950524.aspx)。从网站：

> Small Basic 是... 一种在友好且引人入胜的开发环境中易于学习的小型编程语言，Small Basic 使编程变得轻而易举。...
> 
> Small Basic 的灵感来源于原始的 BASIC 编程语言，并且基于 Microsoft .NET 平台。它真的很小，只有 15 个关键字......
> 
> Small Basic 开发环境 ...提供强大的现代环境功能，如 Intellisense™ ...

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-23T01:01:58.650

蟒蛇或红宝石。

动态语言有许多优点（和缺点），但对于您提出的建议，它们似乎很完美。我会推荐高级工具包的 python 或 ruby​​ 绑定作为完美的环境。例如，Qt 库提供了您需要的大部分功能，而动态语言让您可以轻松进行实验

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-23T12:06:37.740

与 Visual Basic 6 相比，VB.NET 的前两个版本存在严重的缺陷。然而，大多数这些问题自 Visual Studio 2005 以来已得到修复。今天，对于新项目，我觉得使 VB6 如此易于使用的一切都可以通过VB.NET 加上您获得新的语言结构和 .NET 框架。还有重构和 VB Power Pak，它带回了旧的简单易用的打印引擎。

当然，这涉及到学习曲线。但只不过是从 QuickBASIC/PDS 到 VB 1 的飞跃。如果您必须维护或转移一个较旧的项目，那么 VB6 和 VB.NET 之间的差异会更加严重。

最后是支持 VB 编译器的 Mono 项目。这为微软决定再次倒退提供了一定程度的相对豁免权。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-23T01:10:21.203

你可以试试[FreeBASIC](http://www.freebasic.net/)。
它的语法与 VB*非常*相似，它是一个积极开发的开源项目，它也可以跨不同平台移植。

[你可以在这里](http://www.freebasic.net/index.php/gallery)下载，[这里](http://www.freebasic.net/index.php/download)有几个典型的作品。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-23T01:11:04.167

如果还没有完成，我会推荐 python。它是最容易学习的语言之一。

我的第一语言是 Pascal，我认为它也是最简单的语言之一，随着 Delphi 再次流行，我认为它是 VB6 的一个很好的替代品。

尽管普遍认为，我一直发现 Delphi 比 VB 更容易。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-23T02:31:20.947

看看[Lua](http://lua.org)

*   非常小的核心语言，整个文档是一个单一的（非常易读的）网页。您可以在一个周末轻松学习基础知识。
*   非常好的（小）书，有很好的提示。
*   非常有帮助的社区。
*   非常快，无论是使用标准字节码 VM 还是 JIT。
*   在游戏中使用很多，既因为它快速且易于嵌入到应用程序中，又因为它易于向有兴趣扩展游戏的玩家解释。
*   可读来源。
*   MIT 许可证，随心所欲，无附加条件。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-23T01:04:09.643

也许[Clarion](http://www.softvelocity.com/index.htm)就是您要找的东西？就个人而言，我没有太多的经验，但你可以构建一些几乎没有编码技能的不错的应用程序。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-23T03:03:12.930

我认为 C# 是一种非常好的语言，可以快速轻松地编写 GUI 应用程序。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-09-19T16:52:43.973

虽然这可能不是您问题的完整答案，但我建议您花一些时间学习更复杂的语言（Objective-C、Java、C# 等）。凭借您在 OOP 设计模式等方面学习的经验，将来您将不必到处寻找“最简单”的编程语言。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-02-15T02:40:50.493

正如我所经历的那样，visual basic.NET 比 VB6 更容易并且具有完整的功能。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-09-27T18:43:02.443

我最近弄乱了 Microsoft Lightswitch，发现它非常像 VB。绑定到数据库并生成表单、网格等非常快。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-07-21T16:00:19.063

在提出这个问题十多年后，最好的答案是......

...继续使用 VB6 编程语言。

VB6 仍然适用于 Windows 10 和 Windows Server 2019。就像它自 Windows 98 以来一样。

微软对 VB6 的支持政策在这里[VB6 support policy](https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-basic-6/visual-basic-6-support-policy)

# multithreading - 缺少 OpenMP 功能：线程优先级

> ID：671902
> 
> 赞同：1
> 
> 时间：2009-03-23T00:30:27.117
> 
> 标签：multithreading, openmp, thread-priority

任何人都可以考虑一下。OpenMP 功能可调整 cpu 肌肉以处理哑铃。在我对 openmp 的研究中，我们无法设置线程优先级来执行具有强大肌肉的块代码。只有一种方法（_beginthreadex 或带有 5 个参数的 CreateThread 函数）来创建具有最高优先级的线程。

这里有一些关于这个问题的代码：

这是手动设置。

```
int numberOfCore = ( execute __cpuid to obtain number of cores on your cpu ).

HANDLES* hThreads = new HANDLES[ numberOfCore ];
hThreads[0] = _beginthreadex( NULL, 0, someThreadFunc, NULL, 0, NULL );

SetThreadPriority( hThreads[0], HIGH_PRIORITY_CLASS );

WaitForMultipleObjects(...); 
```

这是我想看到这部分：

```
#pragma omp parallel
{
#pragma omp for ( threadpriority:HIGH_PRIORITY_CLASS )
 for( ;; ) { ... }
} 
```

或者

```
#pragma omp parallel
{
// Generally this function greatly appreciativable.
_omp_set_priority( HIGH_PRIORITY_CLASS );
#pragma omp for
 for( ;; ) { ... }
} 
```

我不知道是否有办法使用 openmp 设置优先级，请告知我们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T00:35:13.177

您可以`SetThreadPriority`在循环体中执行此操作，而无需 OpenMP 的特殊支持：

```
for (...)
{
  DWORD priority=GetThreadPriority(...);
  SetThreadPriority(...);
  // stuff
  SetThreadPriority(priority);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-08T22:14:17.840

简单的测试揭示了意想不到的结果：我在 Visual Studio 2010 (Windows 7) 中运行了一个简单的测试：

```
 #include <stdio.h>
    #include <omp.h>
    #include <windows.h>

    int main()
    {
        int tid, nthreads;

        SetThreadPriority(GetCurrentThread(), THREAD_PRIORITY_ABOVE_NORMAL);

        #pragma omp parallel private(tid) num_threads(4)
        {
            tid = omp_get_thread_num();
            printf("Thread %d: Priority = %d\n", tid, GetThreadPriority(GetCurrentThread()));
        }

        printf("\n");

        #pragma omp parallel private(tid) shared(nthreads) num_threads(4)
        {
            tid = omp_get_thread_num();

            #pragma omp master
            {
                printf("Master Thread %d: Priority = %d\n", tid, GetThreadPriority(GetCurrentThread()));
            }
        }

        #pragma omp parallel num_threads(4)
        {
            SetThreadPriority(GetCurrentThread(), THREAD_PRIORITY_ABOVE_NORMAL);
        }

        printf("\n");

        #pragma omp parallel private(tid) num_threads(4)
        {
            tid = omp_get_thread_num();
            printf("Thread %d: Priority = %d\n", tid, GetThreadPriority(GetCurrentThread()));
        }

        return 0;
    } 
```

输出是：

```
 Thread 1: Priority = 0
    Thread 0: Priority = 1
    Thread 2: Priority = 0
    Thread 3: Priority = 0

    Master Thread 0: Priority = 1

    Thread 0: Priority = 1
    Thread 1: Priority = 1
    Thread 3: Priority = 1
    Thread 2: Priority = 1 
```

说明：OpenMP 主线程以主线程优先级执行。其他 OpenMP 线程保持正常优先级。手动设置 OpenMP 线程的线程优先级时，线程保持该优先级。

# hosting - 寻找具有良好代码块支持的博客站点

> ID：671912
> 
> 赞同：12
> 
> 时间：2009-03-23T00:38:54.540
> 
> 标签：hosting, blogs

以前可能有人问过这个问题，但我使用搜索系统找不到任何相关的帖子。

我正在寻找一个可以托管我自己的博客的网站。不幸的是，我发现没有一个具有在我们自己的 stackoverflow 上发现的那种代码块友好性（不是您必须手动将 < 和 > 转换为`&lt;`and的代码块`&gt;`）。

如果答案是“没有，呃！”，而我注定要安装自己的博客软件，那么我应该使用哪个“编码器博客”——知道我希望它超级简单建立。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T00:49:16.293

我结合使用[BlogEngine.NET](http://www.dotnetblogengine.net/)、Windows Live Writer 和 WLW 扩展来格式化/放置我的博客中的代码块。

[Scott Hanselman在此处](http://www.hanselman.com/blog/BestCodeSyntaxHighlighterForSnippetsInYourBlog.aspx)有一篇关于此主题的博文。

这里有一个非常棒的客户端（基于 jQuery）代码格式化程序，您[可能还想查看它](http://startbigthinksmall.wordpress.com/2008/10/30/beautyofcode-jquery-plugin-for-syntax-highlighting/)，这听起来与博客软件无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T00:45:11.000

我使用 appengine 和[博客](http://bloog.billkatz.com/)主要是因为这个功能（而且因为我可以随心所欲地扩展它）。好消息是它相对容易设置和免费。如果您的博客有足够的流量超过免费帐户的限制，您就有可能从中取回您的钱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T00:50:49.487

我一直在努力在 Blogger 上格式化代码，直到我找到[了这个方便的实用程序](http://formatmysourcecode.blogspot.com/)。这不是一个完美的解决方案，但它还有很长的路要走。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-02T04:38:34.917

这个 css 脚本可能对所有人都有用 - 它不适用于语法突出显示，但可以很好地以原始格式呈现源代码：

```
 <pre style="font-family: Andale Mono, Lucida Console, Monaco, fixed, monospace; 
                color: #000000; background-color: #eee;
                font-size: 12px; border: 1px dashed #999999;
                line-height: 14px; padding: 5px; 
                overflow: auto; width: 100%">
       <code style="color:#000000;word-wrap:normal;">

            <<<<<<<YOUR CODE HERE>>>>>>>

       </code>
 </pre> 
```

**如何使用 ：**

1.  将此片段粘贴到文本编辑器中，
2.  将您的代码粘贴到 <<<<<<>>>>>> 块中。
3.  全部复制并
4.  粘贴到博客（或任何其他）帖子编辑器中的 HTML 视图。

**优点：**简单易用，配置少，易于重新配置，无需额外软件

# actionscript-3 - Actionscript 将背景转换为透明

> ID：671915
> 
> 赞同：0
> 
> 时间：2009-03-23T00:41:01.617
> 
> 标签：actionscript-3, colors

该函数的目的是将背景转换为透明然后返回位图数据，但似乎不起作用。代码如下：

```
 private function transparentConverter( source:BitmapData, threshold:Number = 0.1 ):BitmapData
        {
            var bitmapData:BitmapData = new BitmapData( source.width, source.height, true, 0x00000000  );
            bitmapData.lock();
            var color:uint = source.getPixel( 0, 0 );

            var x:uint, y:uint;
            for ( y = 0; y < source.height; y++ )
            {
                for ( x = 0; x < source.width; x++ )
                {
                    var c1:uint = source.getPixel( x, y );
                    var c2:uint = color;
                    var rx:uint = Math.abs((( c1 & 0xff0000 ) >> 16 ) - (( c2 & 0xff0000 ) >> 16 ));
                    var gx:uint = Math.abs((( c1 & 0xff00) >> 8 ) - (( c2 & 0xff00 ) >> 8 ));
                    var bx:uint = Math.abs(( c1 & 0xff ) - ( c2 & 0xff ));

                    var dist:uint = Math.sqrt( rx*rx + gx*gx + bx*bx );

                    if ( dist <= threshold )
                    {
                        bitmapData.setPixel32( x, y, 0x00000000 );
                    }else
                        {
                            bitmapData.setPixel32( x, y, c1 );
                        }
                }
            }
            bitmapData.unlock();
            return bitmapData;
        } 
```

请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T19:33:09.850

你可以试试这个：

```
// This bitmapData should be defined for real, wherever you get that from ...
var source:BitmapData;  

if(source == null)
   trace("The source cannot be empty");

// Here you get the transformed BitmapData
var destination:bitmapData = transparentConverter( source );

// You apply it to a Bitmap in order to visualize it
var viewBitmap:Bitmap = new Bitmap(destination);

// You add the Bitmap to the stage so you can see it
addChild(viewBitmap); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T00:31:04.143

西奥，谢谢你的努力。我认为问题是函数运行时间太长。在我尝试您的脚本后，会出现一条警告消息。它说程序需要超过 15 秒才能运行并告诉我停止运行。

我认为该功能应该还可以，但是，也许不太实用。

Theo，再次感谢您的时间和建议。

我认为这个问题可以结束了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T09:53:45.860

Theo，该函数似乎可以运行，但是需要一些时间，但是没有返回位图数据。

我通过以下代码接收 bitmpadata：

```
bitmapData = transparentConverter( bitmapData );
var bitmap:Bitmap = new Bitmap( bitmapData );
image1.source = bitmap; 
```

图像不出现。

而且，我可以追踪（c1），并且得到一长串数据。感谢您的答复。

# javascript - Web 应用程序中的排序

> ID：671919
> 
> 赞同：1
> 
> 时间：2009-03-23T00:46:03.367
> 
> 标签：javascript, ajax, sorting

随着功能强大的客户端 javascript 小部件的日益普及，我很好奇什么时候是在客户端严格处理数据排序的最佳时间，利用 YUI 中的小部件，以及何时发出请求后端并让它通过数据库查询或其他方式处理排序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T00:48:29.697

这取决于数据量 - 最好的办法是测试并查看哪个更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T00:49:30.583

这实际上取决于您要排序的内容，客户端是否需要所有数据或仅需要排序的子集，以及排序的实际成本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T00:55:32.410

就个人而言，我可能会在回发时对其进行排序。但是如果你所有的数据都显示在页面上，那么通过 JS 排序可能会提供一个响应更快的 UI。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T01:20:26.157

要考虑的另一件事是，如果您想进行分组排序或按值排序，然后将该值转换为人类可读的内容（即 unixtime），那么在服务器上进行排序可能会更快更简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T01:30:54.837

除特殊情况外，请在浏览器中排序。例外情况是不合理的长列表、需要主机资源的奇怪排序规则、javascript 编码技能不足等。但是从不必要的往返中没有什么好处。

向用户下载比舒适滚动更多的数据很少有意义；并且这种大小的列表在浏览器中应该可以很舒服地排序。

# c++ - C++ 定义、声明和赋值究竟是什么？

> ID：671925
> 
> 赞同：14
> 
> 时间：2009-03-23T00:50:22.250
> 
> 标签：c++, variable-assignment, terminology, declare

我倾向于交替使用定义、声明和分配这些词，但这似乎对某些人造成冒犯。这是合理的吗？我应该只在第一次分配给变量时使用声明这个词吗？或者还有更多的东西吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-23T00:57:05.137

定义是描述值或函数的地方，即准确地告诉编译器或程序员它是什么，例如

```
int foo()
{
  return 1;
}

int var; // or, e.g. int var = 5; but this is clearer. 
```

声明告诉编译器或程序员该函数或变量存在。例如

```
int foo();
extern int var; 
```

赋值是指设置变量的值，通常使用 = 运算符。例如

```
a = b;
a = foo(); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-23T00:54:50.943

定义和声明是相似的，但分配是非常不同的。

在这里，我声明（或定义）一个变量：

```
int x; 
```

在这里，我为该变量赋值：

```
x = 0; 
```

在这里，我在一个声明中同时做这两个：

```
int x = 0; 
```

**笔记**

并非所有语言都支持在一个语句中声明和赋值：

**T-SQL**

```
declare x int;
set x = 0; 
```

某些语言要求您在声明时为变量赋值。此要求允许语言的编译器或解释器推断变量的类型：

**Python**

```
x = 0 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-23T00:55:17.013

使用正确的术语很重要，否则人们不会知道你在说什么，或者错误地认为你不知道你在说什么。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T00:54:51.630

这些术语在各种语言的标准中通常具有精确的含义。在这种情况下，不应将它们混为一谈。

例如在 c 中：

*   一个函数可能只*定义*一次（当你说它做什么时），但它也可以在此之前*声明*（当你说它接受什么参数以及它返回什么类型时）。

*   *同样，当您说出它是什么类型时，就会声明*一个变量，并且每个范围仅发生一次。但是你可以重复*赋值。*（一些语言还区分*初始化*（在声明时给变量一个值）和*赋值*（稍后更改值）。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-23T01:39:10.790

差异可能看起来很微妙，但它们很重要。并非每种语言都有相同的区别，但在 C++ 中，**变量声明**使编译器知道变量的类型和名称

```
int i; 
```

**变量定义**分配存储空间并为变量指定初始值。

```
i = 1; 
```

您可以像通常那样将变量声明和定义组合到一个语句中。

```
int x = 1; 
```

在函数内声明变量也会为变量留出内存，所以下面的代码隐式定义变量`a`作为其声明的一部分。

```
int main()
{
    int a;
    return 0;
} 
```

由于变量`a`是由编译器自动定义的，它将包含分配给它的内存位置中的任何值。这就是为什么在您明确为它们分配已知值之前使用自动变量是不安全的。

每当您更改程序中变量的值时，都会发生赋值**。**

```
x = 2;
x++;
x += 4; 
```

**函数声明**，类似于变量声明，使编译器知道函数签名。这允许您在定义之前调用源代码中的函数，而不会导致编译器错误。

```
int doSomething(float x); 
```

**函数定义**指定函数的返回类型、名称、参数列表和指令。这些元素中的前三个必须与函数声明相匹配。一个函数只能在给定程序中定义一次。

```
int doSomething(float x)
{
    if( x < 0 )
    {
        x = -x;
    }
    return static_cast<int>(x);
} 
```

您可以将函数声明和定义合二为一，但您必须在程序中的任何位置调用该函数之前这样做。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-09-17T16:47:07.810

一般作用： **定义=声明+保留空间。**

定义、声明和赋值有两种情况：

1.  对于变量。
2.  对于函数。

* * *

对于**变量**：

--**定义：**
告诉编译器为变量保留内存。

```
int x; 
```

--**声明：**
告诉编译器该变量定义在别处。

```
extern int x; 
```

--**赋值：**
告诉编译器将值放入变量中。

```
x = 0; 
```

* * *

对于**功能**：

--**定义：**

```
int functionDef(int x){
  int x;  
  ...  
  ...  
  ...  
  return x;  
} 
```

--**声明：** 只是函数的原型。

```
int functionDef(int x); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-23T14:04:28.223

正确答案取决于您所谈论的语言。计算机语言通常有特定的术语，要么是因为语言规范，要么是因为围绕该语言发展起来的社区。在我使用 COBOL 时，它的术语与更主流的语言（在更接近语言开发主流而非主流业务的语言的意义上）有很大不同。Forth 开发了一些奇怪的术语。

如果你懂英语，你通常可以从它的正常含义中很好地了解一个单词的含义，但不要太依赖它。跨语言或语言社区的特定单词也是如此。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-02-09T21:11:39.007

如前所述，这可能取决于语言。我认为这真的取决于这些词是否用于类之类的东西。对于这里讨论的大多数数据类型，这个问题可能没有太大的相关性。在 C++ 中（参见[c++ - What is the difference between a definition and a declaration?](https://stackoverflow.com/questions/1410563/what-is-the-difference-between-a-definition-and-a-declaration)），一个类或结构总是只有一个定义，但可以声明零次或多次。没有定义就不能声明一个类。所以“声明”可能是“使用”的同义词。

在大多数语言中，简单类型（如整数）不需要像类那样定义。

# .net-3.5 - .NET 世界中的静态编译

> ID：671933
> 
> 赞同：17
> 
> 时间：2009-03-23T00:55:05.063
> 
> 标签：.net-3.5, static, compilation

我将为拥有 WinXP 机器的客户端编写一个小型桌面应用程序，并且他们不会安装 .NET 框架（至少对我来说不是）。

所以我的选择仅限于 C++ 或 VB6，它们听起来都不是很好。我记得那天读到 Mono 提出了一个静态编译器，但最近我唯一能找到的是 Miguel de Icaza 关于游戏引擎静态编译的条目，目的是在 iPhone 上运行应用程序 - 而不是我的想到了。

是否有任何免费或商业产品可以让我静态编译我的 .net 3.5 winform 应用程序？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-23T00:58:48.737

您可以尝试使用[Remotesoft Salamander。](http://www.remotesoft.com/linker/)

它完全符合您的要求。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-02-25T23:32:31.133

Mono 极大地改进了对 Ahead of Time 编译 (AOT) 的支持，假设您愿意/能够以 Mono 而不是 .Net 运行时为目标，那么几乎可以静态编译任何 CIL 应用程序。

总体而言，这是否是一个好主意完全取决于应用程序和您的限制。

例如，Novell 现在发布了 MonoTouch，这是一个完全 AOT 编译和链接的 CLI 实现，允许 .Net 应用程序（不仅仅是游戏）在 iPhone 上针对 CocoaTouch 框架运行。

这些相同的 AOT 技术可用于编译不需要 .Net 或 Mono 运行时作为先决条件的 Winforms 应用程序。有很多与 AOT 相关的性能权衡（正面和负面），所以如果没有尽职调查，我不会继续前进。

* * *

*编辑：*

回答 John Saunders 关于“为什么不为他们安装它？”的问题。这实际上提出了您可能需要 AOT 编译的一个原因。引导程序。

为了安装任何东西，你必须运行一个可执行文件。您可以分发 MSI（将隐式启动 msiexec.exe），也可以分发 exe。MSI 虽然功能强大，但开发人员的体验非常糟糕。因此，您可以使用 .NET 构建您的引导程序（AOT 编译消除了运行时依赖），它会在安装您的应用程序之前安装任何必要的先决条件（例如 .NET）。

此外，一些公司可能需要发布不需要用户安装任何东西（静默或其他方式）的可下载可执行文件。

还有一个：安装 .NET 需要管理权限。AOT 可以让您绕过对您的应用程序的要求。

同样，这是否是一个好主意完全取决于应用程序和您的约束。

# wpf - MarkupExtension 作为模板中的计算属性

> ID：671941
> 
> 赞同：4
> 
> 时间：2009-03-23T00:59:25.643
> 
> 标签：wpf, templates, markup-extensions

有这样的 MarkupExtension

```
public class Extension1 : MarkupExtension
{
    private static int _counter = 0;

    public override object ProvideValue(IServiceProvider serviceProvider)
    {
        return string.Format("Item {0}", _counter++);
    }
} 
```

和这个 XAML

```
<ListBox>
  <ListBoxItem Content="{my:Extension1}"></ListBoxItem>
  <ListBoxItem Content="{my:Extension1}"></ListBoxItem>
  <ListBoxItem Content="{my:Extension1}"></ListBoxItem>
</ListBox> 
```

我得到这样的清单：

```
Item 1
Item 2
Item 3 
```

现在我尝试使用此样式生成相同的列表

```
<Style TargetType="ListBoxItem">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="ListBoxItem">
                <TextBox Text="{my:Extension1}"></TextBox>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

并且有了这样的 XAML

```
<ListBox ItemsSource="{StaticResource data}"></ListBox> 
```

我明白了

```
Item 0
Item 0
Item 0 
```

所以 {my:Extension1} 只评估了一次。我可以创建一个将为每个项目评估的计算属性吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-23T02:33:29.197

> 尝试从 ProvideValue 返回一个对象而不是字符串

Phil 走在了正确的轨道上……实际上，如果您的标记扩展是从模板调用的`this`，则您需要返回。`ProvideValue`这将导致为模板生成的每个控件评估标记扩展。要确定调用`ProvideValue`是否来自模板，您需要检查目标对象：在模板中，它的类型为`System.Window.SharedDp`. 我为此写了[一篇博文](http://www.thomaslevesque.com/2009/08/23/wpf-markup-extensions-and-templates/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T03:03:28.203

然后，您假设每次创建新的列表框项时都会重新处理控制项模板定义。出于性能原因，情况并非如此。第一次创建它要快得多，然后每次都克隆它。因此你没有得到你想要的结果。调用扩展的结果被缓存和重用。

为了解决这个问题，您需要返回动态而不是静态的东西。尝试从 ProvideValue 返回一个对象而不是一个字符串。返回的对象本身将包含一个计数器，当对该对象调用 ToString 时，它会返回计数器的字符串版本。

# c# - 在 C#/GDI+ 中从 Format8bppIndexed 转换为 Format24bppRgb

> ID：671953
> 
> 赞同：6
> 
> 时间：2009-03-23T01:11:09.877
> 
> 标签：c#, gdi+

好的，我有一个来自外部应用程序的 8 位索引格式的图像。我需要将此图像转换为完全相同大小的 24 位格式。

我尝试创建一个大小相同且类型为 Format24bppRgb 的新位图，然后使用 Graphics 对象在其上绘制 8 位图像，然后将其保存为 Bmp。这种方法不会出错，但是当我打开生成的图像时，BMP 标头具有各种时髦的值。高度和宽度是巨大的，此外，压缩标志和其他一些标志有有趣的（和大的）值。不幸的是，我的特殊要求是将此文件传递给特定的打印机驱动程序，该驱动程序需要具有特定标题值的 24 位图像（我试图通过 GDI+ 实现）

有人知道将索引文件“上转换”为未索引的 24 位文件的示例吗？如果不是一个例子，我应该从哪条路径开始编写自己的？

-Kevin Grossnicklaus kvgros@sseinc.com

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-23T03:46:17.850

我使用下面的代码将图像从 8bpp“上转换”为 24bpp。使用十六进制编辑器检查生成的 24bpp 文件并与 8bpp 文件进行比较显示两个文件的高度和宽度没有差异。也就是说，8bpp 的图像是 1600x1200，24bpp 的图像具有相同的值。

```
 private static void ConvertTo24(string inputFileName, string outputFileName)
    {
        Bitmap bmpIn = (Bitmap)Bitmap.FromFile(inputFileName);

        Bitmap converted = new Bitmap(bmpIn.Width, bmpIn.Height, PixelFormat.Format24bppRgb);
        using (Graphics g = Graphics.FromImage(converted))
        {
            // Prevent DPI conversion
            g.PageUnit = GraphicsUnit.Pixel
            // Draw the image
            g.DrawImageUnscaled(bmpIn, 0, 0);
        }
        converted.Save(outputFileName, ImageFormat.Bmp);
    } 
```

标题中的其他所有内容看起来都很合理，并且图像在我的系统上显示相同。你看到了什么“时髦的价值观”？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-06-07T22:36:08.480

这是我的转换代码。注意源图像和结果图像之间的分辨率匹配。

```
 private void ConvertTo24bppPNG(Stream imageDataAsStream, out byte[] data)
    {
        using ( Image img = Image.FromStream(imageDataAsStream) )
        {
            using ( Bitmap bmp = new Bitmap(img.Width, img.Height, PixelFormat.Format24bppRgb) )
            {
                // ensure resulting image has same resolution as source image
                // otherwise resulting image will appear scaled
                bmp.SetResolution(img.HorizontalResolution, img.VerticalResolution);

                using ( Graphics gfx = Graphics.FromImage(bmp) )
                {
                    gfx.DrawImage(img, 0, 0);
                }

                using ( MemoryStream ms = new MemoryStream() )
                {
                    bmp.Save(ms, ImageFormat.Png);
                    data = new byte[ms.Length];
                    ms.Position = 0;
                    ms.Read(data, 0, (int) ms.Length);
                }
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T02:39:14.750

您创建的位图与输入的宽度和高度相同，但生成的 BMP 更大，这似乎很奇怪。你能发布一些代码吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T03:35:34.130

问题可能是源图像和输出图像的 Vertical- 和 Horizo​​ntalResolution 之间的差异。如果您加载分辨率为 72 DPI 的 8bpp 索引位图，然后创建一个新的 24bpp 位图（默认分辨率将为 96 DPI ......至少在我的系统上），然后使用 Graphics.DrawImage 到新的位图，您的图像将显示为略微放大和裁剪。

话虽如此，我不知道如何*正确*创建输出位图和/或图形对象以在保存时正确缩放。我怀疑这与使用英寸而不是像素等通用比例创建图像有关。

# css - CSS：class 和 id 可以互换吗？

> ID：671954
> 
> 赞同：1
> 
> 时间：2009-03-23T01:13:10.667
> 
> 标签：css, class

我知道其他人询问过在 CSS 文件中使用 class 和 id，例如

[分区：类与 ID](https://stackoverflow.com/questions/84378/div-class-vs-id)

所以我知道 class 和 id 之间的语义和句法差异：id 应该用于只使用一次的元素，而 class 应该用于共享共同属性的元素。

但这不是硬性规定，不是吗？对多个元素使用 id 有什么害处？还是只为一个人使用一个课程？毕竟，“一个元素”不只是一个集合（类），里面只有一个东西吗？

如果我违反规则，浏览器的 CSS 解释器会抛出错误吗？我还没有看到它发生。

那么为什么我们同时拥有 id 和 class 呢？为什么不只是一种或另一种并称其为好？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-23T01:16:26.947

不允许重复 ID；尽管您的浏览器可能关心也可能不关心，但这个概念毫无意义——如果有重复，它怎么可能是一个 ID？;-)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T01:15:23.390

如果你这样做，CSS 不会抱怨，但如果你想通过它的 id 抓取一个元素，Javascript 肯定会抱怨。

真正的答案是，一个对象和一个对象的标识符与可以应用于多个对象的标识符之间存在语义差异。虽然你可以打破规则，但最好不要这样做。

两者之间还有另一个区别，一个 (X)HTML 元素允许应用多个类，如下所示：

```
<div class="foo bar"></div> 
```

你不能用 ids 做到这一点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-23T05:51:43.477

在回答“为什么我们在 CSS 中同时使用类和 id，当您被允许拥有一个类的单个实例时？”这个问题时，请这样看。

我们*不需要*CSS 的 ID。我们*可以*只使用类的单个实例。

但是我们需要 JavaScript 的 ID。那么，为什么不在 CSS 中使用它们呢？

想象一个存在 ID，但仅用于 JavaScript 的世界。

你必须这样编码：

```
<div id="wrapper" class="wrapper">
    <div id="nav" class="nav">

    </div>
</div> 
```

等等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T01:27:34.330

CSS 不是问题（您只需在其中定义样式），而是文档有效性。

id 旨在**唯一标识**一个元素（无论出于何种目的使用它），因此当您有两个具有相同 ID 的元素时，不会有好事发生。

请记住，“id”属性并不是专门用于 CSS 样式（至少不是作为一个类），而是用于其他东西 - 特别是 JavaScript！

如果我不知道我会得到什么作为回报，我不会使用“document.getElementById()”...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-23T01:50:42.697

如果给定类中只有一个元素，则不会造成任何伤害。在这种情况下，区别只是语义上的，因为您所做的只是模拟一个 id。但是，如果您有多个具有相同 id 的元素，则会在页面验证、**CSS 定位**和 Javascript 对该 id 的引用方面遇到问题。最好按预期使用 id 和 class 属性，以便在设置页面样式时获得最大的灵活性。请记住，您可以拥有一个具有唯一 id 的元素，*并*使其同时属于一个或多个类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T01:25:06.113

关于它有很多话要说。您已经知道 id an class 的语义含义，所以我只讨论一种情况 - 不包括 javascript - 何时使用 id 会有所不同：您可以引用具有 id 的元素以使用锚点或外部链接在页面内导航：`<a href="http://www.site.com/home.html#news>`如果您想直接转到 id="news" 的元素，可以链接 html 文档的特定元素。显然，你不能用类来处理它，因为类不是唯一的。因此，出于这个和其他原因，拥有一个标识文档内元素的属性很重要。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-23T01:31:33.743

ID 对于您知道每个页面都是唯一的元素很有用。

例如：

*   菜单（#menu）
*   放置主要内容的中央列 (#content)
*   放置外部链接的右列 (#external-links)

对于这些元素，您可能需要非常具体的规则（精确的、非相对的宽度和位置）。

现在，这些元素中的每一个都将包含某种类型对象的多个实例：

*   # 菜单将包含 .menu-items

*   # 中央将包含 .articles

*   # 外部链接将包含 .external-link

这个子元素不是唯一的，但它们的布局属性是......因此使用类。

这些子元素中的每一个都可能有子类（如 .featured-article），甚至有些可能有一个 ID（#current-menu-item）。

当然，您总是可以使用类代替 ID，但我认为使用 ID 可以清楚地了解哪些元素是唯一的，哪些不是。此外，我更喜欢在我的类属性中使用较少的空格分隔名称，以使它们具有合理的可读性。

# asp.net - ASP.NET 客户端时间

> ID：671964
> 
> 赞同：5
> 
> 时间：2009-03-23T01:19:43.070
> 
> 标签：asp.net

我希望能够根据用户的当前时区显示时间。我将在我的数据库中以 UTC 格式存储时间，但希望将这些时间标准化为客户的时区。到目前为止，似乎最可行的选项是捕获客户端时间，然后确定该时间与当前 UTC 之间的差异，并在渲染时使用该增量来标准化时间。我想知道是否有任何更直接的选项可用于检测 UTC 时间并将其标准化为请求客户端机器的时间。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T01:27:17.450

我会使用 javascript dateObject.getTimezoneOffset()。即使他们的时间没有准确设置，希望他们已经设置了他们的时区：

> [http://www.w3schools.com/jsref/jsref_getTimezoneOffset.asp](http://www.w3schools.com/jsref/jsref_getTimezoneOffset.asp)

您可以使用此值来计算服务器时间和客户端时间之间的偏移量。（正如杰森在下面的评论中有用地指出的那样）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T01:44:42.277

除了使用 getTimezoneOffset 之外，或者不使用 getTimezoneOffset，您应该考虑允许用户在他们的配置文件中指定首选时区。例如，用户可能在一个时区访问，但可能更喜欢在他的家乡时区看到时间。

此外，如果这与调用 JavaScript 函数一样简单，那么网站将永远不必询问您的时区。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T01:44:59.200

更好的方法是为每个用户存储用户所在的确切时区（并且可选地）允许他们选择是否遵守夏令时（如果它适用于他们的时区。）当然，您可以自动填写如果需要，可以使用 DST 信息（基于时区）。

您必须将这部分作为注册的一部分，或者可能在他们的“选项”中。

# syntax - 使用 PowerShell 将选项卡写入文件

> ID：671965
> 
> 赞同：21
> 
> 时间：2009-03-23T01:19:52.227
> 
> 标签：syntax, powershell

我需要在 PowerShell 中回显数组的一系列元素，但在元素之间提供各种分隔符，所以我正在使用；

```
 Add-Content -Path $tempInputDir\testoutput.log -value ($($fields[0]) + "   "+
        $($fields[1])  + "    " + $($fields[2]) + " " + $($fields[3])    + "    "+
        $($fields[15]) + "    " + $($fields[17]))
} 
```

我需要能够添加制表符和空格字符，正如您从上面的代码中看到的那样，我刚刚通过在双引号之间物理添加制表符和空格来完成此操作，但我确信这会导致问题。

将这些字符回显到文件的正确方法是什么？我在某处读到“'t”可以使用，但这似乎不起作用？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-03-23T01:37:44.740

您可以``t`在双引号字符串中使用制表符。您还可以将上述简化为：

```
"$($fields[0])   $($fields[1])   $($fields[2]) $($fields[3])  $($fields[15])  $($fields[17])" | Add-Content $tempInputDir\testoutput.log 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-23T07:10:20.573

将指定字段与选项卡连接在一起：

```
[string]::join("`t", (0..3,15,17 | % {$fields[$_]})) 
```

# c# - 从 lambda 表达式中检索属性名称

> ID：671968
> 
> 赞同：570
> 
> 时间：2009-03-23T01:24:30.420
> 
> 标签：c#, linq, lambda, expression-trees

通过 lambda 表达式传入时，是否有更好的方法来获取属性名称？这是我目前拥有的。

例如。

```
GetSortingInfo<User>(u => u.UserId); 
```

只有当属性是字符串时，它才会通过将其转换为成员表达式来工作。因为并非所有属性都是字符串，所以我必须使用对象，但它会为那些返回一元表达式。

```
public static RouteValueDictionary GetInfo<T>(this HtmlHelper html, 
    Expression<Func<T, object>> action) where T : class
{
    var expression = GetMemberInfo(action);
    string name = expression.Member.Name;

    return GetInfo(html, name);
}

private static MemberExpression GetMemberInfo(Expression method)
{
    LambdaExpression lambda = method as LambdaExpression;
    if (lambda == null)
        throw new ArgumentNullException("method");

    MemberExpression memberExpr = null;

    if (lambda.Body.NodeType == ExpressionType.Convert)
    {
        memberExpr = 
            ((UnaryExpression)lambda.Body).Operand as MemberExpression;
    }
    else if (lambda.Body.NodeType == ExpressionType.MemberAccess)
    {
        memberExpr = lambda.Body as MemberExpression;
    }

    if (memberExpr == null)
        throw new ArgumentException("method");

    return memberExpr;
} 
```

* * *

## 回答 #1

> 赞同：386
> 
> 时间：2009-03-23T04:14:10.170

我最近做了一个非常相似的事情来创建一个类型安全的 OnPropertyChanged 方法。

这是一个返回表达式的 PropertyInfo 对象的方法。如果表达式不是属性，则会引发异常。

```
public PropertyInfo GetPropertyInfo<TSource, TProperty>(
    TSource source,
    Expression<Func<TSource, TProperty>> propertyLambda)
{
    Type type = typeof(TSource);

    MemberExpression member = propertyLambda.Body as MemberExpression;
    if (member == null)
        throw new ArgumentException(string.Format(
            "Expression '{0}' refers to a method, not a property.",
            propertyLambda.ToString()));

    PropertyInfo propInfo = member.Member as PropertyInfo;
    if (propInfo == null)
        throw new ArgumentException(string.Format(
            "Expression '{0}' refers to a field, not a property.",
            propertyLambda.ToString()));

    if (type != propInfo.ReflectedType &&
        !type.IsSubclassOf(propInfo.ReflectedType))
        throw new ArgumentException(string.Format(
            "Expression '{0}' refers to a property that is not from type {1}.",
            propertyLambda.ToString(),
            type));

    return propInfo;
} 
```

使用该`source`参数以便编译器可以对方法调用进行类型推断。您可以执行以下操作

```
var propertyInfo = GetPropertyInfo(someUserObject, u => u.UserID); 
```

* * *

## 回答 #2

> 赞同：223
> 
> 时间：2009-03-23T05:39:54.317

我发现另一种方法是对源和属性进行强类型化并显式推断 lambda 的输入。不确定这是否是正确的术语，但这是结果。

```
public static RouteValueDictionary GetInfo<T,P>(this HtmlHelper html, Expression<Func<T, P>> action) where T : class
{
    var expression = (MemberExpression)action.Body;
    string name = expression.Member.Name;

    return GetInfo(html, name);
} 
```

然后这样称呼它。

```
GetInfo((User u) => u.UserId); 
```

瞧，它起作用了。

* * *

## 回答 #3

> 赞同：154
> 
> 时间：2010-05-26T20:04:42.017

我正在玩同样的事情并解决了这个问题。它没有经过全面测试，但似乎可以处理值类型的问题（您遇到的一元表达式问题）

```
public static string GetName(Expression<Func<object>> exp)
{
    MemberExpression body = exp.Body as MemberExpression;

    if (body == null) {
       UnaryExpression ubody = (UnaryExpression)exp.Body;
       body = ubody.Operand as MemberExpression;
    }

    return body.Member.Name;
} 
```

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2012-06-23T17:27:14.827

```
public string GetName<TSource, TField>(Expression<Func<TSource, TField>> Field)
{
    return (Field.Body as MemberExpression ?? ((UnaryExpression)Field.Body).Operand as MemberExpression).Member.Name;
} 
```

这处理成员和一元表达式。不同之处在于，`UnaryExpression`如果您的表达式表示值类型，您将获得 a，而`MemberExpression`如果您的表达式表示引用类型，您将获得 a。一切都可以转换为对象，但值类型必须装箱。这就是存在 UnaryExpression 的原因。[参考。](https://stackoverflow.com/a/12975480/967315)

为了可读性（@Jowen），这是一个扩展的等价物：

```
public string GetName<TSource, TField>(Expression<Func<TSource, TField>> Field)
{
    if (object.Equals(Field, null))
    {
        throw new NullReferenceException("Field is required");
    }

    MemberExpression expr = null;

    if (Field.Body is MemberExpression)
    {
        expr = (MemberExpression)Field.Body;
    }
    else if (Field.Body is UnaryExpression)
    {
        expr = (MemberExpression)((UnaryExpression)Field.Body).Operand;
    }
    else
    {
        const string Format = "Expression '{0}' not supported.";
        string message = string.Format(Format, Field);

        throw new ArgumentException(message, "Field");
    }

    return expr.Member.Name;
} 
```

* * *

## 回答 #5

> 赞同：48
> 
> 时间：2018-09-13T01:13:08.767

使用 C# 7 模式匹配：

```
public static string GetMemberName<T>(this Expression<T> expression)
{
    switch (expression.Body)
    {
        case MemberExpression m:
            return m.Member.Name;
        case UnaryExpression u when u.Operand is MemberExpression m:
            return m.Member.Name;
        default:
            throw new NotImplementedException(expression.GetType().ToString());
    }
} 
```

例子：

```
public static RouteValueDictionary GetInfo<T>(this HtmlHelper html, 
    Expression<Func<T, object>> action) where T : class
{
    var name = action.GetMemberName();
    return GetInfo(html, name);
} 
```

[更新] C# 8 模式匹配：

```
public static string GetMemberName<T>(this Expression<T> expression) =>
    expression.Body switch
    {
        MemberExpression m =>
            m.Member.Name,
        UnaryExpression u when u.Operand is MemberExpression m =>
            m.Member.Name,
        _ =>
            throw new    NotImplementedException(expression.GetType().ToString())
    }; 
```

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2015-12-02T17:10:58.273

现在在 C# 6 中，您可以像这样简单地使用[nameof](https://msdn.microsoft.com/en-us/library/dn986596.aspx)`nameof(User.UserId)`

这有很多好处，其中之一是这是在[编译时](https://stackoverflow.com/a/26573179/57883)完成的，而不是运行时。

[https://msdn.microsoft.com/en-us/magazine/dn802602.aspx](https://msdn.microsoft.com/en-us/magazine/dn802602.aspx)

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2013-12-12T02:11:08.590

这是获取结构/类/接口/委托/数组的字段/属性/索引器/方法/扩展方法/委托的字符串名称的一般实现。我已经使用静态/实例和非泛型/泛型变体的组合进行了测试。

```
//involves recursion
public static string GetMemberName(this LambdaExpression memberSelector)
{
    Func<Expression, string> nameSelector = null;  //recursive func
    nameSelector = e => //or move the entire thing to a separate recursive method
    {
        switch (e.NodeType)
        {
            case ExpressionType.Parameter:
                return ((ParameterExpression)e).Name;
            case ExpressionType.MemberAccess:
                return ((MemberExpression)e).Member.Name;
            case ExpressionType.Call:
                return ((MethodCallExpression)e).Method.Name;
            case ExpressionType.Convert:
            case ExpressionType.ConvertChecked:
                return nameSelector(((UnaryExpression)e).Operand);
            case ExpressionType.Invoke:
                return nameSelector(((InvocationExpression)e).Expression);
            case ExpressionType.ArrayLength:
                return "Length";
            default:
                throw new Exception("not a proper member selector");
        }
    };

    return nameSelector(memberSelector.Body);
} 
```

这个东西也可以写成一个简单的`while`循环：

```
//iteration based
public static string GetMemberName(this LambdaExpression memberSelector)
{
    var currentExpression = memberSelector.Body;

    while (true)
    {
        switch (currentExpression.NodeType)
        {
            case ExpressionType.Parameter:
                return ((ParameterExpression)currentExpression).Name;
            case ExpressionType.MemberAccess:
                return ((MemberExpression)currentExpression).Member.Name;
            case ExpressionType.Call:
                return ((MethodCallExpression)currentExpression).Method.Name;
            case ExpressionType.Convert:
            case ExpressionType.ConvertChecked:
                currentExpression = ((UnaryExpression)currentExpression).Operand;
                break;
            case ExpressionType.Invoke:
                currentExpression = ((InvocationExpression)currentExpression).Expression;
                break;
            case ExpressionType.ArrayLength:
                return "Length";
            default:
                throw new Exception("not a proper member selector");
        }
    }
} 
```

我喜欢递归方法，尽管第二种方法可能更容易阅读。可以这样称呼它：

```
someExpr = x => x.Property.ExtensionMethod()[0]; //or
someExpr = x => Static.Method().Field; //or
someExpr = x => VoidMethod(); //or
someExpr = () => localVariable; //or
someExpr = x => x; //or
someExpr = x => (Type)x; //or
someExpr = () => Array[0].Delegate(null); //etc

string name = someExpr.GetMemberName(); 
```

打印最后一个成员。

笔记：

1.  对于像 之类的链式表达式`A.B.C`，将返回“C”。

2.  这不适用于`const`s、数组索引器或`enum`s（不可能涵盖所有情况）。

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2012-06-12T23:11:23.953

.Length有一个极端情况`Array`。虽然“长度”作为属性公开，但您不能在任何先前提出的解决方案中使用它。

```
using Contract = System.Diagnostics.Contracts.Contract;
using Exprs = System.Linq.Expressions;

static string PropertyNameFromMemberExpr(Exprs.MemberExpression expr)
{
    return expr.Member.Name;
}

static string PropertyNameFromUnaryExpr(Exprs.UnaryExpression expr)
{
    if (expr.NodeType == Exprs.ExpressionType.ArrayLength)
        return "Length";

    var mem_expr = expr.Operand as Exprs.MemberExpression;

    return PropertyNameFromMemberExpr(mem_expr);
}

static string PropertyNameFromLambdaExpr(Exprs.LambdaExpression expr)
{
         if (expr.Body is Exprs.MemberExpression)   return PropertyNameFromMemberExpr(expr.Body as Exprs.MemberExpression);
    else if (expr.Body is Exprs.UnaryExpression)    return PropertyNameFromUnaryExpr(expr.Body as Exprs.UnaryExpression);

    throw new NotSupportedException();
}

public static string PropertyNameFromExpr<TProp>(Exprs.Expression<Func<TProp>> expr)
{
    Contract.Requires<ArgumentNullException>(expr != null);
    Contract.Requires<ArgumentException>(expr.Body is Exprs.MemberExpression || expr.Body is Exprs.UnaryExpression);

    return PropertyNameFromLambdaExpr(expr);
}

public static string PropertyNameFromExpr<T, TProp>(Exprs.Expression<Func<T, TProp>> expr)
{
    Contract.Requires<ArgumentNullException>(expr != null);
    Contract.Requires<ArgumentException>(expr.Body is Exprs.MemberExpression || expr.Body is Exprs.UnaryExpression);

    return PropertyNameFromLambdaExpr(expr);
} 
```

现在示例用法：

```
int[] someArray = new int[1];
Console.WriteLine(PropertyNameFromExpr( () => someArray.Length )); 
```

如果`PropertyNameFromUnaryExpr`不检查`ArrayLength`，“someArray”将被打印到控制台（编译器似乎生成对支持 Length*字段*的直接访问，作为一种优化，即使在调试中也是如此，因此是特殊情况）。

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2014-09-25T03:39:18.550

[这是Cameron 提出的方法](https://stackoverflow.com/questions/671968/retrieving-property-name-from-lambda-expression#answer-672212)的更新。第一个参数不是必需的。

```
public PropertyInfo GetPropertyInfo<TSource, TProperty>(
    Expression<Func<TSource, TProperty>> propertyLambda)
{
    Type type = typeof(TSource);

    MemberExpression member = propertyLambda.Body as MemberExpression;
    if (member == null)
        throw new ArgumentException(string.Format(
            "Expression '{0}' refers to a method, not a property.",
            propertyLambda.ToString()));

    PropertyInfo propInfo = member.Member as PropertyInfo;
    if (propInfo == null)
        throw new ArgumentException(string.Format(
            "Expression '{0}' refers to a field, not a property.",
            propertyLambda.ToString()));

    if (type != propInfo.ReflectedType &&
        !type.IsSubclassOf(propInfo.ReflectedType))
        throw new ArgumentException(string.Format(
            "Expresion '{0}' refers to a property that is not from type {1}.",
            propertyLambda.ToString(),
            type));

    return propInfo;
} 
```

您可以执行以下操作：

```
var propertyInfo = GetPropertyInfo<SomeType>(u => u.UserID);
var propertyInfo = GetPropertyInfo((SomeType u) => u.UserID); 
```

扩展方法：

```
public static PropertyInfo GetPropertyInfo<TSource, TProperty>(this TSource source,
    Expression<Func<TSource, TProperty>> propertyLambda) where TSource : class
{
    return GetPropertyInfo(propertyLambda);
}

public static string NameOfProperty<TSource, TProperty>(this TSource source,
    Expression<Func<TSource, TProperty>> propertyLambda) where TSource : class
{
    PropertyInfo prodInfo = GetPropertyInfo(propertyLambda);
    return prodInfo.Name;
} 
```

你可以：

```
SomeType someInstance = null;
string propName = someInstance.NameOfProperty(i => i.Length);
PropertyInfo propInfo = someInstance.GetPropertyInfo(i => i.Length); 
```

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2013-06-20T18:09:44.603

我发现一些深入研究/的[建议答案](https://stackoverflow.com/a/2916344/1037948)没有捕获嵌套/子属性。`MemberExpression``UnaryExpression`

ex)`o => o.Thing1.Thing2`返回`Thing1`而不是`Thing1.Thing2`.

如果您尝试使用 EntityFramework ，这种区别很重要`DbSet.Include(...)`。

我发现只是解析`Expression.ToString()`似乎工作正常，而且相对较快。我将它与`UnaryExpression`版本进行了比较，甚至`ToString`下车`Member/UnaryExpression`看看是否更快，但差异可以忽略不计。如果这是一个糟糕的主意，请纠正我。

## 扩展方法

```
/// <summary>
/// Given an expression, extract the listed property name; similar to reflection but with familiar LINQ+lambdas.  Technique @via https://stackoverflow.com/a/16647343/1037948
/// </summary>
/// <remarks>Cheats and uses the tostring output -- Should consult performance differences</remarks>
/// <typeparam name="TModel">the model type to extract property names</typeparam>
/// <typeparam name="TValue">the value type of the expected property</typeparam>
/// <param name="propertySelector">expression that just selects a model property to be turned into a string</param>
/// <param name="delimiter">Expression toString delimiter to split from lambda param</param>
/// <param name="endTrim">Sometimes the Expression toString contains a method call, something like "Convert(x)", so we need to strip the closing part from the end</param>
/// <returns>indicated property name</returns>
public static string GetPropertyName<TModel, TValue>(this Expression<Func<TModel, TValue>> propertySelector, char delimiter = '.', char endTrim = ')') {

    var asString = propertySelector.ToString(); // gives you: "o => o.Whatever"
    var firstDelim = asString.IndexOf(delimiter); // make sure there is a beginning property indicator; the "." in "o.Whatever" -- this may not be necessary?

    return firstDelim < 0
        ? asString
        : asString.Substring(firstDelim+1).TrimEnd(endTrim);
}//--   fn  GetPropertyNameExtended 
```

*（检查分隔符甚至可能是矫枉过正）*

## 演示（LinqPad）

演示+对比代码——https: [//gist.github.com/zaus/6992590](https://gist.github.com/zaus/6992590)

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2016-02-17T22:42:33.047

我正在为 C# 6 之前的项目使用扩展方法，为那些针对 C# 6 的项目使用[nameof() 。](https://msdn.microsoft.com/en-us/library/dn986596.aspx)

```
public static class MiscExtentions
{
    public static string NameOf<TModel, TProperty>(this object @object, Expression<Func<TModel, TProperty>> propertyExpression)
    {
        var expression = propertyExpression.Body as MemberExpression;
        if (expression == null)
        {
            throw new ArgumentException("Expression is not a property.");
        }

        return expression.Member.Name;
    }
} 
```

我称之为：

```
public class MyClass 
{
    public int Property1 { get; set; }
    public string Property2 { get; set; }
    public int[] Property3 { get; set; }
    public Subclass Property4 { get; set; }
    public Subclass[] Property5 { get; set; }
}

public class Subclass
{
    public int PropertyA { get; set; }
    public string PropertyB { get; set; }
}

// result is Property1
this.NameOf((MyClass o) => o.Property1);
// result is Property2
this.NameOf((MyClass o) => o.Property2);
// result is Property3
this.NameOf((MyClass o) => o.Property3);
// result is Property4
this.NameOf((MyClass o) => o.Property4);
// result is PropertyB
this.NameOf((MyClass o) => o.Property4.PropertyB);
// result is Property5
this.NameOf((MyClass o) => o.Property5); 
```

它适用于字段和属性。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2009-03-23T05:19:27.750

好吧，没有必要打电话`.Name.ToString()`，但大致就是这样，是的。您可能需要的唯一考虑是是否`x.Foo.Bar`应该返回“Foo”、“Bar”或异常 - 即您是否需要迭代。

（重新评论）有关灵活排序的更多信息，请参见[此处](http://groups.google.com/group/microsoft.public.dotnet.languages.csharp/msg/7d931ec0e2356d21)。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2017-07-24T23:27:59.263

如果你想获得多个字段，我会离开这个函数：

```
/// <summary>
    /// Get properties separated by , (Ex: to invoke 'd => new { d.FirstName, d.LastName }')
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="exp"></param>
    /// <returns></returns>
    public static string GetFields<T>(Expression<Func<T, object>> exp)
    {
        MemberExpression body = exp.Body as MemberExpression;
        var fields = new List<string>();
        if (body == null)
        {
            NewExpression ubody = exp.Body as NewExpression;
            if (ubody != null)
                foreach (var arg in ubody.Arguments)
                {
                    fields.Add((arg as MemberExpression).Member.Name);
                }
        }

        return string.Join(",", fields);
    } 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2019-11-25T09:28:45.630

这可能是最佳的

```
public static string GetPropertyName<TResult>(Expression<Func<TResult>> expr)
{
    var memberAccess = expr.Body as MemberExpression;
    var propertyInfo = memberAccess?.Member as PropertyInfo;
    var propertyName = propertyInfo?.Name;

    return propertyName;
} 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2011-02-03T09:34:47.687

我在 ObjectStateEntry 上创建了一个扩展方法，以便能够以类型安全的方式将（实体框架 POCO 类的）属性标记为已修改，因为默认方法只接受一个字符串。这是我从属性中获取名称的方法：

```
public static void SetModifiedProperty<T>(this System.Data.Objects.ObjectStateEntry state, Expression<Func<T>> action)
{
    var body = (MemberExpression)action.Body;
    string propertyName = body.Member.Name;

    state.SetModifiedProperty(propertyName);
} 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2012-05-10T21:02:49.450

我已经完成了`INotifyPropertyChanged`类似于下面的方法的实现。这里的属性存储在下面显示的基类中的字典中。当然并不总是希望使用继承，但是对于视图模型，我认为它是可以接受的，并且在视图模型类中提供了非常干净的属性引用。

```
public class PhotoDetailsViewModel
    : PropertyChangedNotifierBase<PhotoDetailsViewModel>
{
    public bool IsLoading
    {
        get { return GetValue(x => x.IsLoading); }
        set { SetPropertyValue(x => x.IsLoading, value); }
    }

    public string PendingOperation
    {
        get { return GetValue(x => x.PendingOperation); }
        set { SetPropertyValue(x => x.PendingOperation, value); }
    }

    public PhotoViewModel Photo
    {
        get { return GetValue(x => x.Photo); }
        set { SetPropertyValue(x => x.Photo, value); }
    }
} 
```

稍微复杂一点的基类如下所示。它处理从 lambda 表达式到属性名称的转换。请注意，这些属性实际上是伪属性，因为只使用了名称。但它对视图模型和对视图模型属性的引用看起来是透明的。

```
public class PropertyChangedNotifierBase<T> : INotifyPropertyChanged
{
    readonly Dictionary<string, object> _properties = new Dictionary<string, object>();

    protected U GetValue<U>(Expression<Func<T, U>> property)
    {
        var propertyName = GetPropertyName(property);

        return GetValue<U>(propertyName);
    }

    private U GetValue<U>(string propertyName)
    {
        object value;

        if (!_properties.TryGetValue(propertyName, out value))
        {
            return default(U);
        }

        return (U)value;
    }

    protected void SetPropertyValue<U>(Expression<Func<T, U>> property, U value)
    {
        var propertyName = GetPropertyName(property);

        var oldValue = GetValue<U>(propertyName);

        if (Object.ReferenceEquals(oldValue, value))
        {
            return;
        }
        _properties[propertyName] = value;

        RaisePropertyChangedEvent(propertyName);
    }

    protected void RaisePropertyChangedEvent<U>(Expression<Func<T, U>> property)
    {
        var name = GetPropertyName(property);
        RaisePropertyChangedEvent(name);
    }

    protected void RaisePropertyChangedEvent(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }

    private static string GetPropertyName<U>(Expression<Func<T, U>> property)
    {
        if (property == null)
        {
            throw new NullReferenceException("property");
        }

        var lambda = property as LambdaExpression;

        var memberAssignment = (MemberExpression) lambda.Body;
        return memberAssignment.Member.Name;
    }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2015-01-02T00:44:29.023

这是另一个答案：

```
public static string GetPropertyName<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper,
                                                                      Expression<Func<TModel, TProperty>> expression)
    {
        var metaData = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData);

        return metaData.PropertyName;
    } 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2017-04-20T12:00:05.600

[这是根据此答案](https://stackoverflow.com/a/672212/5301903)获取 PropertyInfo 的另一种方法。它消除了对对象实例的需要。

```
/// <summary>
/// Get metadata of property referenced by expression. Type constrained.
/// </summary>
public static PropertyInfo GetPropertyInfo<TSource, TProperty>(Expression<Func<TSource, TProperty>> propertyLambda)
{
    return GetPropertyInfo((LambdaExpression) propertyLambda);
}

/// <summary>
/// Get metadata of property referenced by expression.
/// </summary>
public static PropertyInfo GetPropertyInfo(LambdaExpression propertyLambda)
{
    // https://stackoverflow.com/questions/671968/retrieving-property-name-from-lambda-expression
    MemberExpression member = propertyLambda.Body as MemberExpression;
    if (member == null)
        throw new ArgumentException(string.Format(
            "Expression '{0}' refers to a method, not a property.",
            propertyLambda.ToString()));

    PropertyInfo propInfo = member.Member as PropertyInfo;
    if (propInfo == null)
        throw new ArgumentException(string.Format(
            "Expression '{0}' refers to a field, not a property.",
            propertyLambda.ToString()));

    if(propertyLambda.Parameters.Count() == 0)
        throw new ArgumentException(String.Format(
            "Expression '{0}' does not have any parameters. A property expression needs to have at least 1 parameter.",
            propertyLambda.ToString()));

    var type = propertyLambda.Parameters[0].Type;
    if (type != propInfo.ReflectedType &&
        !type.IsSubclassOf(propInfo.ReflectedType))
        throw new ArgumentException(String.Format(
            "Expression '{0}' refers to a property that is not from type {1}.",
            propertyLambda.ToString(),
            type));
    return propInfo;
} 
```

可以这样调用：

```
var propertyInfo = GetPropertyInfo((User u) => u.UserID); 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2017-05-12T07:20:28.477

我已经更新了[@Cameron 的答案](https://stackoverflow.com/a/672212/75500)，包括一些针对`Convert`类型化 lambda 表达式的安全检查：

```
PropertyInfo GetPropertyName<TSource, TProperty>(
Expression<Func<TSource, TProperty>> propertyLambda)
{
  var body = propertyLambda.Body;
  if (!(body is MemberExpression member)
    && !(body is UnaryExpression unary
      && (member = unary.Operand as MemberExpression) != null))
    throw new ArgumentException($"Expression '{propertyLambda}' " +
      "does not refer to a property.");

  if (!(member.Member is PropertyInfo propInfo))
    throw new ArgumentException($"Expression '{propertyLambda}' " +
      "refers to a field, not a property.");

  var type = typeof(TSource);
  if (!propInfo.DeclaringType.GetTypeInfo().IsAssignableFrom(type.GetTypeInfo()))
    throw new ArgumentException($"Expresion '{propertyLambda}' " + 
      "refers to a property that is not from type '{type}'.");

  return propInfo;
} 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2017-10-20T15:47:48.310

从 .NET 4.0 开始，您可以使用它[`ExpressionVisitor`](https://msdn.microsoft.com/en-us/library/system.linq.expressions.expressionvisitor(v=vs.110).aspx)来查找属性：

```
class ExprVisitor : ExpressionVisitor {
    public bool IsFound { get; private set; }
    public string MemberName { get; private set; }
    public Type MemberType { get; private set; }
    protected override Expression VisitMember(MemberExpression node) {
        if (!IsFound && node.Member.MemberType == MemberTypes.Property) {
            IsFound = true;
            MemberName = node.Member.Name;
            MemberType = node.Type;
        }
        return base.VisitMember(node);
    }
} 
```

以下是您如何使用此访问者：

```
var visitor = new ExprVisitor();
visitor.Visit(expr);
if (visitor.IsFound) {
    Console.WriteLine("First property in the expression tree: Name={0}, Type={1}", visitor.MemberName, visitor.MemberType.FullName);
} else {
    Console.WriteLine("No properties found.");
} 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2019-10-03T11:42:21.013

```
static void Main(string[] args)
{
    var prop = GetPropertyInfo<MyDto>(_ => _.MyProperty);

    MyDto dto = new MyDto();
    dto.MyProperty = 666;

    var value = prop.GetValue(dto);
    // value == 666
}

class MyDto
{
    public int MyProperty { get; set; }
}

public static PropertyInfo GetPropertyInfo<TSource>(Expression<Func<TSource, object>> propertyLambda)
{
    Type type = typeof(TSource);

    var member = propertyLambda.Body as MemberExpression;
    if (member == null)
    {
        var unary = propertyLambda.Body as UnaryExpression;
        if (unary != null)
        {
            member = unary.Operand as MemberExpression;
        }
    }
    if (member == null)
    {
        throw new ArgumentException(string.Format("Expression '{0}' refers to a method, not a property.",
            propertyLambda.ToString()));
    }

    var propInfo = member.Member as PropertyInfo;
    if (propInfo == null)
    {
        throw new ArgumentException(string.Format("Expression '{0}' refers to a field, not a property.",
            propertyLambda.ToString()));
    }

    if (type != propInfo.ReflectedType && !type.IsSubclassOf(propInfo.ReflectedType))
    {
        throw new ArgumentException(string.Format("Expression '{0}' refers to a property that is not from type {1}.",
            propertyLambda.ToString(), type));
    }

    return propInfo;
} 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2021-05-25T08:32:45.987

如果您可以参考 efcore，则可以使用[GetPropetyAccess() 。](https://github.com/dotnet/efcore/blob/ac2bb48b10ecf1289b568a94b7a35e8075c6d787/src/EFCore/Infrastructure/ExpressionExtensions.cs#L151)

```
using Microsoft.EntityFrameworkCore.Infrastructure;

var propertyInfo = lambda.GetPropetyAccess(); //PropertyInfo
var propertyName = propertyInfo.Name; 
```

# asp.net - App_Code 和 web.config

> ID：671985
> 
> 赞同：3
> 
> 时间：2009-03-23T01:39:43.910
> 
> 标签：asp.net, web, web-config, app-code

假设我在 App_Code 中有一个类 (MyClass.cs)（使用 ASP.NET 网站，而不是项目）。没有为该类分配命名空间。

如何使该类在网站 .aspx 页面中有效？我需要在 web.config 文件中添加什么，我需要将它放在哪里？

我是<添加程序集标签还是<添加类型？

由于程序集标签需要版本、文化和公钥，我不确定这些值在编译时是什么。

我只是添加一个类型标签吗？我在哪里把它放在 web.config 中？

**编辑：** 好的，我找到了部分答案。我收到错误是因为“ [http://localhost/MyFolder](http://localhost/MyFolder) ”未在 IIS 中设置为“应用程序”。但是，我有一堆文件夹，“ [http://localhost/MyFolder2](http://localhost/MyFolder2)、[http://localhost/MyFolder3](http://localhost/MyFolder3)等......

新问题：有什么方法可以不让 MyFolder 成为一个应用程序，并且仍然让它正常运行？我听说过“codesubdirectories”标签，它有用吗？我应该把它放在哪里？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T01:45:15.520

在网站中，您的 App_code 文件夹中不需要名称空间。无需进入 web.config 即可引用 app_code 文件夹中的类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T06:30:14.633

这是首次引入 asp.net 2.0 网站时出现的动态编译的那些记录不充分的方面之一。

但是，对于您的特定问题的实际答案将需要您告诉我们更多关于您正在尝试对 App_Code 中的类做什么。大多数时候，您不必担心命名空间或程序集名称即可在页面中使用这些类。您只需使用类名，编译器就会弄清楚并为您连接所有内容。

我遇到的最大例外是使用我放入 app_code 的 Web 控件时。对于那些您需要在 aspx 页面中使用 @Register 指令的人...并且为此您需要程序集名称和命名空间。

app_code 中的文件被编译成一个名为“__code”的程序集（请注意，它有两个下划线，而不是一个）。当您需要 Register 指令或 web.config 中的程序集名称时，您可以使用这些名称。

但是，据我所知，您将无法在 register 指令或某些需要命名空间的 web.config 设置中使用类，除非您已将该类显式包装在命名空间块中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-15T22:06:03.847

Check the properties of the code file in Solution Explorer.

I had a situation where one of the .cs code files had "Content" selected for the Build Action. All the other files in App_Code were compiling fine but not this one.

Changed the Build Action to "Compile" and it started working as expected.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T01:45:54.550

我认为你根本不需要做任何事情。这就是网站“项目”的工作方式。App_Code 中的任何内容都会被编译。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T14:05:35.660

通过您的编辑，您是否尝试过将 App_Code 文件夹移动到站点的根目录？

```
/App_Code
/MyFolder
/MyFolder2
/MyFolder3 
```

这可能会解决您的问题。

您还可以查看 Scott Guthrie 的提示/技巧：

> [使用 VS 2005 Web 应用程序创建子 Web 项目](http://weblogs.asp.net/scottgu/archive/2006/08/16/tip_2f00_trick_3a00_-creating-sub_2d00_web-projects-using-the-vs-2005-web-application-project-option.aspx)

尽管这确实使用了 Web 应用程序项目，而不是网站。

Looking at the [CodeSubDirectories](http://msdn.microsoft.com/en-us/library/54dwfbb7.aspx) config element - you probably could use this - it would need to be defined in the root web.config I guess.

Also, note that the <assembly> references only need to contain version, culture and public key details if the assemblies are strongly named (and so have those values).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T06:44:13.163

检查以确保课程是公开的，也许？

# excel - 为 Excel 模型构建用户界面

> ID：671990
> 
> 赞同：1
> 
> 时间：2009-03-23T01:43:53.743
> 
> 标签：excel, user-interface

我建立了一个用于分析房地产交易的 Excel 模型。我想创建一个用户界面来覆盖模型，以便可以将文件分发给客户以评估潜在投资

该界面将提供两个主要功能：1）通过创建易于遵循的输入页面来增强用户体验。然后输入的数据将流向模型，从中生成报告供用户查看。2）通过限制用户访问底层模型来保护模型的知识产权。用户将无法查看或编辑 Excel 文件中的公式。

我相信这可以使用 MS Acess/Visual Basics 来完成，但我希望找到一个看起来更专业的程序。任何人都可以建议可以创建这种类型的用户界面的程序/编程语言吗？

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T01:50:27.037

您不必使用 Access，VBA（Visual Basic For Applications）直接内置在 Excel 中。有[好书](http://www.techbookreport.com/tbr0037.html)和大量的网络资源。您的主要问题似乎是 UI 不专业 - 我不同意，开箱即用它看起来像 5-10 年前开发的应用程序，但它仍然可以工作并且看起来还不错。

如果您想要一个非常流畅的界面，我建议您查看 WPF 并将其集成到 Excel 中。然而，要做到这一点，有一个很大的学习曲线，我会得到一个基本的用户界面，向你的客户展示/销售，然后问他们想要什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T02:24:34.177

我想我的第一个问题是您对开发的了解程度如何？您在帖子中确实没有回避这一点。

如果您使用 Excel 2007，有一些方法可以在 Excel 中隐藏菜单命令并删除很多当前界面并用您自己的界面替换它。它看起来像 Excel，功能也像 Excel，但是，功能区界面看起来大不相同。另一边只是添加一个选项卡或菜单并在那里有你的命令。听起来你想使用 Excel 作为你的 UI，但是用你的函数替换命令。

如果您想隐藏您的 IP，并且您决定使用 VBA，那么您的代码将存储在 Excel 电子表格中，任何知道如何打开 VBA 编辑器的人都可以访问。

如果您决定在 .NET 中执行此操作，则您的功能存在于 Excel 外部的程序集中，并且 .NET 运行时会在您打开电子表格时加载它。在 Excel 中进行任何探索都无法帮助他们找到您的“代码”。

有很多代码示例可以帮助您解决这两个问题。如果您决定使用 .NET，我会推荐 VB.NET。从纯语法的角度来看，VB.NET 可以很好地处理许多办公室编程“怪癖”，并且可以帮助您加快开发速度。这是[办公开发网站](http://msdn.microsoft.com/en-ca/office/aa905363.aspx)，您可以在做出决定之前去获取信息。

此外，根据[本文](http://en.wikipedia.org/wiki/Visual_Studio_Tools_for_Office)，您需要购买 Visual Studio Professional 2008 或 2005 才能获得图形设计师等。如果这不可行或负担得起，那么开始使用 VBA 可能不是一个坏主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T01:17:15.740

关于我的开发知识，我是新手。我熟悉 VB 的基础知识，但对我心目中的 UI 类型进行实际开发已经超出了我的能力范围。我计划聘请开发人员来创建 UI，但在此之前，我需要决定将要构建的语言。

MrTelly，克里斯，我很感激你的建议。

我目前正在寻找愿意合作确定构建 UI 并执行开发的最佳语言的熟练开发人员。如果您有任何建议或想自己讨论该项目，可以通过 phtwright@gmail.com 与我联系。

# c# - 我有什么理由不应该从 C# 开始

> ID：671991
> 
> 赞同：12
> 
> 时间：2009-03-23T01:44:17.457
> 
> 标签：c#, .net, php, ruby

我认为我倾向于将 C# 和 .net 作为学习 Web 开发的集中语言。我想学习良好的编程基础知识，并且我已经看过几乎所有其他内容。我将其缩小为 C#、Python、Ruby 和 PHP 四个。是否有理由远离 C#（而且我认为成本问题不会真正适用于我的独立开发人员的情况，但我可能完全错了）。有什么想法吗？

**我意识到这些都是很棒的语言，所以我不想问哪个是最好的。然而，Ruby 会成为第一语言的可行替代方案，还是它与 Rails 以及非正统的方法相结合有太多的“幕后魔力”？我确实喜欢我所看到的语言。**

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-23T01:48:50.207

这可能会导致一场激烈的战争，但我认为 C# 是一种非常好的语言，可以从 Web 开发开始。

它是一种功能齐全的面向对象语言，并且是静态类型和编译的。它有很好的文档记录，并且拥有庞大的开发者社区。

如果您绝对必须在 Linux/Apache 上运行并且不想使用 Mono，那将是不使用 C# 的原因。除此之外，我认为没有令人信服的理由不这样做，尤其是使用 ASP.NET MVC，它可以让您远离 WebForms 模型。

这并不是说 WebForms 一定不好，但有些人可能会反对 WebForms，因为它引入了其他 Web 开发平台不具备的抽象。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-23T02:08:00.987

如果您使用 C# 进行 Web 开发，根据您对 Web 技术的经验，我强烈建议您先使用 ASP.NET MVC，然后再使用 ASP.NET Web 窗体。

ASP.NET Web Forms 是构建 ASP.NET 应用程序的原始风格，并试图抽象出很多细节。它允许您构建应用程序而无需了解幕后发生的事情（发布数据、状态管理）。在我看来，这些抽象虽然一开始让事情变得简单，但当您进入更复杂的场景时开始“泄漏”（正如[本教程所证明](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/Truly-Understanding-Viewstate.aspx)的那样）。

另一方面，[ASP.NET MVC可以更轻松地构建更“接近金属”的网站，同时仍然保持您的生产力。](http://asp.net/mvc)如果您想要对生成的 HTML 进行绝对控制，并且不惧怕 cookie、表单标签、发布和查询字符串数据之类的东西，那么您可能会更喜欢 ASP.NET MVC。

当然，两者都知道是有好处的。但是，如果我现在开始，我可能会从 MVC 开始并转向 Forms（然后意识到它有多糟糕并退回 :)）。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-03-23T13:27:05.737

没有“最好的语言”。你使用一种工具来达到它的目的，这就是为什么有几种工具。

**既然您的问题是“为什么不学习 C#”**，我会说：

*   如果您打算使用其他操作系统，那么 Windows（单声道无法比较）。
*   如果在环境中工作或与对 .net 不友好的人一起工作（例如：银行、科学家）
*   如果您在环境中工作或与其他优秀技术专家一起工作（永远不要低估对优秀大师的使用）。
*   如果您认为自由软件如此重要以至于使用 MS 产品不值得。
*   如果您不喜欢 MS Visual Studio（在没有良好 IDE 的情况下使用 c# 工作会很痛苦）。
*   如果您计划编写 .net 不适合的东西（例如嵌入式设备、脚本、实时、容错系统、人工智能等）。
*   如果您是 Web 开发人员并且买不起 Windows Server 许可证。
*   如果您想学习非常基础的编程，包括简单的功能和快速而肮脏的脚本。

现在，我使用 PHP、Python、Java 和 C# 进行编程。Python 是我选择的语言，但 c# 确实是第一个吸引我的 MS 编程工具：它干净且高效。真的，这是关于你想做什么，而不是宗教问题。

做出你的选择。

就是说，C# 很烂，Python 很烂。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-23T01:53:42.987

我同意 C# 是一门非常完整的语言，它的语法简洁且可扩展。已经有大量可用的 Web 资源，但它很大，但它有效地将您与作为您的平台的 windows 联系在一起。对于网络来说，这是一个重要的考虑因素。在桌面上，windows 是王道，但对于 web 服务器市场来说，它几乎没有那么占主导地位。

另一个问题是，如果您正在查看网络上的富媒体，则必须考虑 Flash 和/或 Silverlight。如果您使用 C#，那么您就可以在不学习其他语言的情况下使用 Silverlight。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-23T01:51:53.647

不用担心费用。该编译器与 Fx SDK 的其余部分一起免费使用，您甚至可以[免费下载 Visual Studio](http://www.microsoft.com/express/vcsharp/)。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-03-23T02:07:46.853

学习 C# 的缺点是它将您与专有平台和软件堆栈联系在一起。现在有 Mono，它在实现大部分 C# 和 .Net 方面做得很好，但主要和最完整的实现是微软的，它是非免费的。

我使用 C# 的程度不足以讨论它在 Ruby 或 Python 方面的技术优势。然而，我可以说，除了自由软件提供的其他好处（在别处详细讨论）之外，学习使用自由软件甚至为自由软件做出贡献是很有教育意义的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-23T11:35:06.053

c# 是一门很好的语言，因为：

1.  这是一种非常好的非常干净的语言
2.  它有一个优秀的库（.NET 框架）。这是选择语言时要考虑的最重要的事情之一。
3.  它非常受欢迎，您将始终能够从社区中找到您正在寻找的答案。
4.  如果您了解 c#，那么您几乎了解 VB.NET。
5.  c# 在语法上类似于 Java。学习c#不会教你Java的库，但是如果你想进入Java阵营，它会大大降低学习曲线。
6.  c# 在语法上类似于 c++。同样，它使用不同的库，并且与 c++ 不同，您可以获得内存管理；但是如果您决定使用 c++，学习曲线应该会有所降低。

至于网...

ASP.NET webforms 为你做了很多神奇的事情。ASP.NET MVC（刚刚发布）对您几乎没有任何作用。对于学习，MVC 是更好的选择。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-23T02:00:57.430

C# 是一门很棒的语言。而且由于您是通过网络而不是桌面应用程序使用它，因此您不必担心是多平台的，因为代码在您的服务器上运行并且输出交付给客户端。话虽如此，您将不得不找到 Windows 托管（有时可能会更贵一些）或使用单声道（这并不是最新的软件）。不过，缺点是最小的，拿一份特快版然后去吧！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-23T02:02:13.077

我认为部署成本可能是另一回事，即如果您的项目需要水平扩展，并添加更多服务器以实现负载平衡，甚至是地理分布的服务器。通常 Windows 托管会比 linux 运行更多（甚至不考虑火焰战争的原因）。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-23T12:50:16.777

如果您正在进行 Web 开发，C# 非常适合开始。但是，我建议您不要从 Web 开发开始编程。Web 开发很难做到正确。比小命令行的东西更难。我建议您获得一些良好的命令行编程经验，然后升级到 GUI，然后再转到 Web。网络上有一大堆你需要担心的事情。您必须了解 3 种语言（HTML、JS、C#（或在此处插入您的服务器端语言））。另外，您必须担心所有浏览器的怪癖和东西。这甚至没有进入数据库。这通常在大多数 Web 应用程序中使用，但会打开另外一罐蠕虫。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-23T02:22:58.283

考虑到到目前为止的所有答案，我想我会看看提到的所有四种语言。

虽然我在 PHP 方面做了很多开发，并且遗憾地继续这样做，但我认为 PHP 从来都不是一门伟大的语言（尽管它有一些很棒的元素），而且现在没有太多的意义来学习它。它仍然非常容易上手，但我认为总的来说，PHP 是一个“坏习惯”。

Python 是一门很棒的语言，但对我来说，Ruby 就是 Python 的全部，甚至更多。我个人会选择Ruby。

C# 也是一门很棒的语言，但是虽然我使用 C# 还不够自信，但我觉得 Ruby 是一个更好的选择。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-23T02:40:17.757

没有理由特别远离 C#。它和任何语言一样好。Stackoverflow 以它为例，因此它可以在一个成功的网站上运行，您可以在其中获得工作编程。

如果您将编程作为一种爱好或您自己有限的预算，或者您想为编译器/语言的开发做出贡献，那么专有的东西将是一个考虑因素。我猜这些都不是。（*编辑：正如其他人指出的那样，存在 C# 的开源环境。*）

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-23T11:28:46.130

这取决于几件事。填充了 C# 和 .Net，并且这些工具非常简单（与 Java 相比！Java 开发人员在这里讨论......）但 Windows 托管与 LAMP（包括 Ruby、Python 和 PHP）相比价格昂贵。

对我来说，这一切都取决于您要使用的工具。对于 Web 服务等，我会使用 C#，但对于简单的网站 PHP，因为它很容易。

这也取决于您所在地区的就业市场……在南非，您可以获得*更多*的 C# 工作，而没有多少 PHP 等。当然，如果您是自由职业者，您将很难找到工作。

对我来说，Ruby 再次对我个人的东西有好处，但你在这里找不到任何 Ruby 工作。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-23T12:52:41.967

我的建议？了解自己的差异。和他们两个一起玩。如果您有一个项目，请在其中编写一个原型。否则，您将永远受制于他人的偏见。

ASP.net (C#) 和 Ruby on Rails 用于知名网站，因此任何一个都不会出错。我还可以建议您尝试使用[django](http://www.djangoproject.com/)进行 Python 编程吗？这是我更喜欢的网络编程。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-03-23T12:55:09.137

我是一名 C# .Net 开发人员，我认为这很棒，但我会强调 Asp.Net WebForms 中的一个危险。它与大多数其他 web 框架不同，并且在幕后做了很多魔法。正如其他人所说，ASP.Net MVC 可能更内嵌于其他 Web 框架（例如 Rails）。Web Forms 将 webdev 的许多细节抽象出来，如果你想成为 web 开发人员，你最终需要知道这些细节。所以是的，C# 很棒，但我会从 MVC 开始，然后可能会查看 Web 表单。还强烈鼓励研究其他语言和框架，总有东西要学。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-03-24T09:48:19.670

在商业上，我是一名 C# 开发人员。我喜欢 C#。C# 是一种很棒的强类型语言。安装 Resharper 后，我可以在代码中快速构建我的想法，并根据我的意愿灵活运用。

当我每天晚上回家时，我都会使用 Ruby。尽管我没有重构支持（嗅探）。我发现我在 Ruby 中比在 C# 中更有效率。

几年来，我一直在编写一个大型 ASP.Net 应用程序。我们实现了 MVC 来尝试从模型中解开视图。总觉得我在与框架作斗争，而不是在使用它。用于执行 Web 应用程序的最新 .Net 框架是基于 Rails 的……仅仅落后了几年。我喜欢这种语言。我喜欢 CLR。我不太热衷于.Net。

我发现 ruby​​ 社区友好而充满活力。rails 开源社区提供了大量的教程和插件，使您可以轻松上手并轻松组合您的应用程序。

要考虑的另一件事（就选择要学习的语言而言）是 ruby​​ 是一种面向对象的语言。甚至类也是对象。C# 是一种面向类的语言，即。它为您提供了一种创建对象的方法。首先定义一个类。（不完全正确..您可以使用 codedom 在内存中生成程序集..但这绝非易事）。

这似乎是一个微妙的点，但有区别.. 在您获得 Ruby 或 smalltalk 等 OO 语言的经验之前，它是什么并不明显。一旦你感受到了通过在运行时混合功能等来构建对象的自由，你就会发现你必须在 C# 中做的所有“变通”都消失了。没有接口的安全网一开始看起来确实很可怕。

总之，我会学习红宝石..

*   如果您是编程新手（完全），我会从[http://pine.fm/LearnToProgram/](http://pine.fm/LearnToProgram/)
*   然后我会学习BDD（RSpec）并尽快感染测试。
*   然后我会使用 Rails 教程和屏幕投射，直到我睁大眼睛

唯一的问题是 .. 如果您从 ruby​​ 开始，然后再转到 C#，您会发现自己一直在“啊！这在 ruby​​ 中会容易得多”。我知道我知道。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-04-05T19:42:32.310

这实际上取决于您要达到的目标。我两者都编程，老实说，如果你想以编程为职业，我的 .NET 编程报酬是我的两倍。我为 PHP 开发工作的客户类型不是支付很多费用的类型（通常选择 PHP 是基于节省一些 $$$）。.NET 似乎在大公司中更加根深蒂固。

只是我的观察...

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-23T12:33:28.143

除了在那些与“邪恶的微软”对抗的社会群体（甚至地理区域）中不受欢迎之外，没有任何缺点。

语言（更好的 .NET 平台）非常好。一件重要的事情是它正在非常积极地开发，导致一些人难以跟上。但比起长达一年的停滞，我宁愿有快速的发展。

您可以考虑检查您所在地区的雇主更喜欢哪些技术堆栈。

考虑到许可成本，您可以考虑以下几点：如果是小型站点，您可以免费使用 Visual Studio Express/SQL Server Express，这就足够了。如果您想出一些主要的交通繁忙的项目，您可能会找到一种赚取收入并支付许可费用的方法。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-27T17:44:29.533

2009 年学习 C# 很棒。

回到过去，当我进入专业领域时，语言环境非常不同。我使用 C 和 Modula 3（Pascal 替代语言）进行专业编码。

我的观点是，我会为随着时间的推移而改变的技术环境做出计划，并在你的职业生涯发展中对此进行计划。

学习多个平台是实现这一目标的好方法。例如，您可以将 C#/.NET 作为主要技能，但也可以使用 JAVA。当一个新平台出现时，您可以将其添加为您的过渡或备用技能。

# ruby-on-rails - 有没有办法将 map.root 更改为指向“/”以外的内容？

> ID：671994
> 
> 赞同：2
> 
> 时间：2009-03-23T01:44:45.693
> 
> 标签：ruby-on-rails, passenger

我有 apache 2.2，mod_rails 在[http://localhost](http://localhost)运行。我想在[http://localhost/](http://localhost/) **railsBlog**上拥有我的 rails 应用程序。所以，我所做的是，我创建了一个虚拟主机：

```
  服务器名称本地主机
  DocumentRoot /Library/WebServer/Documents
  RailsEnv 开发
  RailsBaseURI /railsBlog

```

现在，由于 URL 是[http://localhost/](http://localhost/) **railsBlog**，服务器将**railsBlog**视为我传入的控制器，这不是我想要的。所以当我去[http://localhost/](http://localhost/) **railsBlog** /home/index. 这不会进入我的“主”控制器和“索引”视图，因为它试图进入“ **railsBlog** ”控制器（不存在）和“主”视图（不存在）。

我认为解决此问题的一种方法是将 map.root 重新定义为**/railsBlog**，一切都会好起来的。但是怎么做？

我可以解决这个问题的另一种方法是将 config/routes.rb 修改为：

```
map.connect ' railsBlog /:controller/:action/:id'

```

但是，这意味着每次部署到不同位置时都必须更改此文件。

或者，有没有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T02:02:59.393

您可以在 config/environment.rb （或特定环境文件之一）中放置这样的行

```
config.action_controller.relative_url_root = "/railsBlog" 
```

您还应该将目录符号链接`publc`到 web 目录的根目录，例如：

```
ln -s /rails/railsBlog/public /webroot/ 
```

这全部来自乘客文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T21:26:01.783

只是添加到以前的答案......这是文档的网址：

[http://www.modrails.com/documentation/Users%20guide.html#deploying_rails_to_sub_uri](http://www.modrails.com/documentation/Users%20guide.html#deploying_rails_to_sub_uri)

此外，如果您遇到损坏的图像、CSS、资源链接的错误，这里有一些信息......

[http://www.modrails.com/documentation/Users%20guide.html#sub_uri_deployment_uri_fix](http://www.modrails.com/documentation/Users%20guide.html#sub_uri_deployment_uri_fix)

基本上它说您应该始终使用 rails 辅助函数（image_tag、javascript_include_tag 和 stylesheet_link_tag），而不是手动编码 url。这些将使用您设置的子 uri 自动生成正确的 URL。

这使您可以轻松地将应用程序移动到另一个子 uri 或移出子 uri 配置，而无需更改所有引用。

这样做的一个好处是您可以使用一个虚拟服务器语句通过多个 RailsBaseURI 行来部署多个应用程序。这对于我们正在尝试构建的应用程序非常有用。

# delphi - 在 Delphi 的 TDBGrid 中查找当前行

> ID：671995
> 
> 赞同：8
> 
> 时间：2009-03-23T01:44:58.187
> 
> 标签：delphi, tdbgrid

有没有办法找出 TDBGrid 中的哪一行是当前行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T04:55:55.437

我不确定我是否理解你的问题，但我会尝试回答，也许你可以澄清这是否不是你要问的。

由于 TDBGrid 与 DataSource 相关联，因此当前行与数据源中的当前行相同。您可以通过查看主键值或 RecNo 属性来查询 DataSource，以确定哪条记录是当前记录。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T16:30:39.197

你可以这样做：

1 - 定义一个作为 TDBGrid 副本的本地类（这将允许您访问私有方法）：

```
type
  THackDBGrid = class(TDBGrid); 
```

2 - 然后您可以转换为本地定义的类，并从私有方法中提取，如下所示：

```
function TfrmMain.GetFieldValue(colnum : integer): string;
begin
  Result := THackDBGrid(grdMain).GetFieldValue(colnum);
end; 
```

或者，要获取第 # 行：

```
function CurrentRowNumber: integer;
  Result := THackDBGrid(grdMain).Row;
end; 
```

这种技术在其他情况下也很有用，但我不能声称功劳。 [我从这里得到的](http://delphi.about.com/od/oopindelphi/l/aa082603a.htm)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T05:14:22.367

如果您不想依赖数据源来提供记录计数和当前记录（例如，因为您在远程服务器上使用单向游标），那么访问底层网格控件属性的技术可以使用。

请参阅类似 StackOverflow 问题的[答案。](https://stackoverflow.com/questions/294342/counting-the-rows-in-a-tdbgrid/294372#294372)************************************