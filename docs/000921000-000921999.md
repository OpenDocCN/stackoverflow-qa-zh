# StackOverflow 问答 000921000-000921999

# c++ - 如何解决 Visual Studio 中的链接错误 2005？

> ID：921001
> 
> 赞同：0
> 
> 时间：2009-05-28T14:02:07.233
> 
> 标签：c++, visual-studio-2005, linker

```
error LNK2005: "public: __thiscall std::basic_ostream<char,struct std::char_traits<char> >::basic_ostream<char,struct std::char_traits<char> >(class std::basic_streambuf<char,struct std::char_traits<char> > *,bool)" (??0?$basic_ostream@DU?$char_traits@D@std@@@std@@QAE@PAV?$basic_streambuf@DU?$char_traits
@D@std@@@1@_N@Z) already defined in msvcprtd.lib(MSVCP80D.dll)  libcpmtd.lib 
```

当我尝试在子项目中包含`/clr`选项和选项时出现此错误。`/MDd`

单独地，所有项目都成功构建，但是当我构建主项目时，它显示上述错误。

如何解决这一问题？

我完全生气了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T00:13:32.990

确保您所有的单个项目都使用相同的运行时库进行编译，这在以下内容中指定：

```
Properties -> C/C++ -> Code Generation -> Runtime Library 
```

如果您正在使用，请`/MDd`确保所有其他项目也是如此。否则，当您在主项目中将它们全部链接在一起时，它将导入多个版本的运行时库，从而导致您观察到的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:16:31.387

看起来您正在将静态编译的库与 dll 链接？`msvcprtd.lib`是一个静态库，用于`STL`编译时链接的`/MDd`.

Libcmptd.lib 是一个`CRT`在您指定`/MTd`.

[请参阅此处](http://msdn.microsoft.com/en-us/library/abx4dbyh(VS.80).aspx)以了解哪个设置使用了哪些库。

检查您的构建设置，使它们都相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T14:18:49.603

链接器说他看到该符号在多个目标文件/库中定义。

*尝试*找出哪些导出它（例如使用dumpbin），找出原因（某些标准库是否静态链接？）以及是否需要它。

对于这种特定情况：

这个操作符是内联的（它会导致*你的*项目定义它）和从 msvcprtd.dll 导出。您可以通过将符号声明为 来解决此问题`__declspec(dllimport)`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T14:20:11.113

使用动态或静态链接运行时库：

LIBCPMTD.LIB - 多线程、静态链接

MSVCPRTD.LIB - 多线程、动态链接（MSVCP80D.DLL 的导入库）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-26T04:29:20.047

当我们有两个头文件的相同定义并在 main 中使用时会发生***此错误 当您在两个头文件中具有不同的变量和函数名称时，此错误将解决***

 *# c# - 设置与高度/宽度相关的图像 DPI C#

> ID：921003
> 
> 赞同：6
> 
> 时间：2009-05-28T14:02:15.017
> 
> 标签：c#, image

我正在编写一个应用程序来将一些图像发送给第三方，并且图像必须是 200x200 DPI。图像是位图，尺寸为 500 宽和 250 高。

我第一次用第三方测试图像时，我的分辨率不正确。我只是习惯于`image.SetResolution(200,200)`将其正确设置为 200x200。然而，这只是改变了图像的分辨率标签，并没有根据我的第三方技术联系人正确调整图像的高度和宽度。

是否有一个我可以使用的比率，以便对于每个 X 单位我增加分辨率，我只增加相应的高度或宽度 Y 单位？我认为我可以只增加分辨率而不必增加高度或宽度。

谢谢你，亚伦。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-28T14:12:28.850

以数字方式存储的图像没有有意义的 DPI 概念。DPI 在物理设备上再现图像时发挥作用。

您需要根据物理设备的 DPI 调整图像大小，以及该设备上所需的输出大小。

例如，如果打印机告诉您他们需要 300dpi 的图像来填充 4in x 4in 的空间，那么您将为他们提供大小为 1200x1200 像素的位图。此图像在 300dpi 输出设备上的物理尺寸为 4 英寸 x 4 英寸。在 600dpi 设备上，相同图像的输出尺寸为 2in x 2in。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:11:13.737

在处理数字图像时，您通常指的是 PPI，即每英寸像素数。DPI 与数字图像分辨率没有直接关系。

因此，如果您查看 200 像素 x 200 像素 @ 200PPI 的图像，您将获得 1 英寸 x 1 英寸的图像。

# visual-c++ - 从 C++-CLI 中的指针函数返回多维数组

> ID：921005
> 
> 赞同：2
> 
> 时间：2009-05-28T14:02:48.667
> 
> 标签：visual-c++, visual-studio-2008, c++-cli

我编写了以下代码从指针函数返回多维数组。该函数的输入参数是一维数组，输出是指向多维数组的指针。

```
double  **function( array< double>^ data,int width,int height ) {
    int i;
    double **R = new double *[height];
    for (i=0;i<=height;i++)
        R[i]=new double [width];

    // ....

    return R;
}

int main( void ) {
    int M=2, N=10, i,j;
    // define multimensional array 2x10

    array< array< double >^ >^ input = gcnew array< array< double >^ >(M);

    for (j=0; j<input->Length; j++) {
        input[j]=gcnew array<double>(N);}
        double **result1 = new double *[N];
        for(i=0; i<=N; i++)
            result1[i]=new double [M];
        double **result2 = new double *[N];
        for(i=0; i<=N; i++)
            result2[i]=new double [M];

        //............

        // send first row array of multidimensional array to function

        result1=function(input[0],M,N);

        // send second row array of multidimensional array to function

        result2=function(input[1],M,N);

        for (i=0;i<=N;i++)
            delete R[k];
        delete R;}*/

    return 0;
 } 
```

我在 Visual Studio 2008 中成功构建了这个程序。当我调试这段代码时，程序计算了 result1 pinter 变量，但在计算 result2 的函数中：

```
R=new double *[height];
for (i=0; i<=height; i++)
    R[i]=new double [width]; 
```

Visual Studio 给出此错误：

> stdeneme.exe 中发生了“System.Runtime.InteropServices.SEHException”类型的未处理异常
> 附加信息：外部组件已引发异常。

不幸的是我不知道该怎么做。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T14:21:13.653

一目了然，我看到一个错误

```
for (i=0;i<=height;i++)
 {
 R[i]=new double [width];
 } 
```

您已分配 R[height] 但循环变为 height+1

你应该写循环

```
for (i=0; i<height; i++) 
```

我看到的另一件事是，当你想破坏你的矩阵时，你写

```
delete R[k]; 
```

但应该是

```
delete [] R[k]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T14:16:23.210

`<=`s是你的问题。有效的数组索引从`0`到`N-1`。分配给`result1[N]`是访问冲突 - 这是它抱怨的异常。

# entity-framework - 实体框架加载错误

> ID：921023
> 
> 赞同：0
> 
> 时间：2009-05-28T14:05:20.003
> 
> 标签：entity-framework, load, loaddata

我有这个查询

```
this.FixturePartidoPuntaje.Load();     

var partidos = from q in this.FixturePartidoPuntaje
               where ( q.FixturePartido.Equipo.EquipoId.Equals(equipoId) ||
                      q.FixturePartido.Equipo1.EquipoId.Equals(equipoId)) &&
                      q.puntaje > 0
               select q; 
```

这里最重要的是，这是一个 Jugador Entity。

我如何加载`FixturePartido`和 ius 孩子？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T14:08:53.633

使用`.Include()`命令：

```
var partidos = from q in this.FixturePartidoPuntaje.Include("children")
               where (q.FixturePartido.Equipo.EquipoId.Equals(equipoId) ||
                      q.FixturePartido.Equipo1.EquipoId.Equals(equipoId)) &&
                      q.puntaje > 0
               select q; 
```

这里的“孩子”是您想要包含的导航属性的名称，如果我没有记错的话……

# zend-framework - 在注册表中注册 Zend 数据库适配器

> ID：921024
> 
> 赞同：37
> 
> 时间：2009-05-28T14:06:01.203
> 
> 标签：zend-framework, zend-db

我希望在引导期间在注册表中注册对主数据库适配器的引用，以便可以在我的站点的其他地方使用它（特别是授权操作）。

我已经实现了一个丑陋的修复，我创建了一个数据库表对象并在其上调用 getAdapter() 方法并通过它。但是，这是一种不好的做法，我希望它可以通过注册表提供。

有谁知道如何做到这一点？任何帮助或正确方向的指示都将不胜感激！

干杯斯图尔特

附言。我使用 Zend Framework 1.8。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-11-24T00:09:56.500

如果您使用 Zend Framework 1.8+，并使用命令行工具创建项目，那么它就像在`application.ini`配置文件中注册数据库设置一样简单。

```
resources.db.adapter = "PDO_MYSQL"
resources.db.params.host = "your.database.host"
resources.db.params.dbname = "database_name"
resources.db.params.username = "username"
resources.db.params.password = "password"
resources.db.isDefaultTableAdapter = true 
```

如果您的数据库设置前面有`resources.db`您甚至不需要在`Bootstrap.php`文件中执行任何操作，因为它会为您完成。此外，通过将`isDefaultTableAdapter`设置设置为`true`，您可以在应用程序的任何位置获取数据库适配器的实例。

```
$dbAdapter = Zend_Db_Table::getDefaultAdapter();
$authAdapter = new Zend_Auth_Adapter_DbTable($dbAdapter); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-29T13:05:17.817

感谢您的回复。我决定更改已接受的答案并发布我最终使用的解决方案 - 最后非常简单！

这基本上是基于**Dcaunt 的**评论......

在引导类中..

```
protected function _initDb()
{
    $resource = $bootstrap->getPluginResource('db');

    $db = $resource->getDbAdapter();

    Zend_Registry::set("db", $db);
} 
```

然后在其他地方访问...

```
$dbAdapter = Zend_Registry::get("db"); 
```

感谢您的帮助，希望这对其他人有所帮助。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-29T13:21:54.710

你错过了最好的东西:)

如果你使用 Zend_Db_Table 模型（你应该是）等，那么你可以设置一个默认适配器 - 这样当你实例化一个模型时它会处理它的数据库连接 - 这样你就不需要将它保存在注册表中或打扰关于通过模型运行查询之前的连接。

如果需要，我确实将它保存在注册表中以供以后使用 - 但我可能会删除它

```
protected function _initDB()
{
    // Check that the config contains the correct database array.
    if ($this->_config->db) {

        // Instantiate the DB factory
        $dbAdapter = Zend_Db::factory($this->_config->db);

        // Set the DB Table default adaptor for auto connection in the models
        Zend_Db_Table::setDefaultAdapter($dbAdapter);

        // Add the DB Adaptor to the registry if we need to call it outside of the modules.
        Zend_Registry::set('dbAdapter', $dbAdapter);
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-08-27T16:05:57.103

我的2美分...

如何获取默认数据库适配器：

从引导程序：

```
<?php    
$dbResource = $this->getPluginResource('db');
db = $dbResource->getDbAdapter();
var_dump($db);
?> 
```

从控制器有两种方法：

```
<?php
// Method 1
$bootstrap = $this->getInvokeArg('bootstrap');
$dbResource = $bootstrap->getPluginResource('db');
$dbAdapter = $dbResource->getDbAdapter();
var_dump($dbAdapter);

// Method 2
$dbAdapter = Zend_Db_Table::getDefaultAdapter();
var_dump($dbAdapter);
?> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T14:11:57.883

检查 zend 文档：15.5.3.3。在注册表中存储数据库适配器

[http://framework.zend.com/manual/en/zend.db.table.html](http://framework.zend.com/manual/en/zend.db.table.html)

```
$db = Zend_Db::factory('PDO_MYSQL', $options);
Zend_Registry::set('my_db', $db);

// Later...

$table = new Bugs(array('db' => 'my_db')); 
```

你正在寻找类似的东西？

编辑：
要从 ini 文件加载配置，请使用：
[parse_ini_file($inifile)](http://se.php.net/parse_ini_file)

```
;configuration.ini
host = 127.0.0.1
user = username
password = blabla

;yourfile.php
$options = parse_ini_file('configuration.ini');

$db = Zend_Db::factory('PDO_MYSQL', $options); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T15:48:13.603

我的引导程序中有一个方法可以将适配器添加到注册表。我更喜欢更清洁的解决方案，但它有效：

```
protected function _initRegistry(){

    $this->bootstrap('db');
    $db = $this->getResource('db');

    $db->setFetchMode(Zend_Db::FETCH_OBJ);

    Zend_Registry::set('db', $db);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-28T15:59:04.300

这是我所做的：

在引导程序内部：

```
define('CONFIG_FILE', '../config/general.ini');
define('APP_MODE', 'development'); 
```

初始化器内部：

```
 /**
 * Initialize data bases
 * 
 * @return void
 */
public function initDb ()
{
    $options = Zend_Registry::get('conf');
    $db = Zend_Db::factory($options->database);
    $db->query(new Zend_Db_Expr('SET NAMES utf8'));
    Zend_Registry::set('db', $db);
}

public function initConfig ()
{
    if (file_exists(CONFIG_FILE) && is_readable(CONFIG_FILE)) {
        $conf = new Zend_Config_Ini(CONFIG_FILE, APP_MODE);
        Zend_Registry::set('conf', $conf);
    } else {
        throw new Zend_Config_Exception('Unable to load config file');
    }
} 
```

最后我的配置文件如下所示：

```
[production]
database.adapter         = pdo_Mysql
database.params.host     = db.example.com
database.params.username = dbuser
database.params.password = secret
database.params.dbname   = dbname

; Overloaded configuration from production

[development : production]
database.params.host     = localhost
database.params.username = root
database.params.password = 
```

看一眼：

*   [Zend_Db::Factory()](http://framework.zend.com/manual/en/zend.db.html#zend.db.adapter.connecting.factory)
*   [Zend_Config_Ini](http://framework.zend.com/manual/en/zend.config.adapters.ini.html)
*   [Zend_Registry](http://framework.zend.com/manual/en/zend.registry.html#zend.registry.using.storing)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-09T06:44:40.080

如果您使用 Zend Framework 1.8，只需在您的控制器/动作中执行以下操作：

```
class CreateorderController extends Zend_Controller_Action
{
    public function testAction()
    {
        //more code
        $users_obj = new Default_Model_Users(); //this would load the model using the Default namespace
        //more code
    }
} 
```

我的 Defaul_Model_Users 类看起来像这样：

```
<?php
/**
 * application/models/Users.php
 */
class Default_Model_Users extends Zend_Db_Table
{
    protected $_table;

    public function getTable()
    {
        if(null === $this->_table) {
            $this->_table = new Default_Model_DbTable_Users();
        }
        return $this->_table;
    }

    public function fetchAll()
    {
        $result = $this->getTable()->fetchAll();

        return $result;
    }
} 
```

在 DbTable 目录中找到直接与数据库表“交互”的模型部分将如下所示：

```
<?php
/**
 * application/models/DbTable/Users.php
 */
class Default_Model_DbTable_Users extends Zend_Db_Table_Abstract
{
    /** Table name */
    protected $_name = 'users';

    public function init()
    {
        $this->_db->setFetchMode(Zend_Db::FETCH_OBJ);
    }
} 
```

然后我会得到 Zend Framework 生成的相同的 application.ini 和这个小添加：

```
resources.db.adapter               = "PDO_MYSQL"
resources.db.params.host           = "localhost"
resources.db.params.dbname         = "mydb"
resources.db.params.username       = "root"
resources.db.params.password       = "password" 
```

**这就是我在无需更改引导文件的情况下所做的。**

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-09-24T17:54:26.093

我不想使用注册表来存储我应该能够访问的对象，所以我做了一点挖掘。事实证明，引导程序被注册为前端控制器参数“bootstrap”，可以从您的任何控制器访问，如[Zend_Application](http://framework.zend.com/manual/en/zend.application.theory-of-operation.html)手册页中所述。

因此，在您的控制器类中，您可以获得已在您的 ini 文件中定义的 db 适配器，如下所示：

```
$bootstrap = $this->getInvokeArg('bootstrap');
$resource = $bootstrap->getPluginResource('db');
$db = $resource->getDbAdapter(); 
```

# java - 关于 Java 中私有静态嵌套类的合成访问器的 Eclipse 警告？

> ID：921025
> 
> 赞同：50
> 
> 时间：2009-05-28T14:06:06.727
> 
> 标签：java, eclipse, nested-class, java-synthetic-methods

我的同事建议使一些 Eclipse 代码格式和警告设置更加严格。这些更改中的大多数都是有意义的，但我在 Java 中得到了这个奇怪的警告。这是一些重现“问题”的测试代码：

```
package com.example.bugs;

public class WeirdInnerClassJavaWarning {
    private static class InnerClass
    {
        public void doSomething() {}
    }

    final private InnerClass anInstance;

    {
        this.anInstance = new InnerClass();   // !!!
        this.anInstance.doSomething();
    }
}
// using "this.anInstance" instead of "anInstance" prevents another warning,
// Unqualified access to the field WeirdInnerClassJavaWarning.anInstance 
```

与 !!! 在 Eclipse 中使用我的新警告设置给我这个警告：

> 对封闭构造函数 WeirdInnerClassJavaWarning.InnerClass() 的访问由合成访问器方法模拟。提高其知名度将提高您的绩效。

这是什么意思？当我将“私有静态类”更改为“受保护的静态类”时，警告消失了，这对我来说毫无意义。

* * *

**编辑：**我终于想出了“正确”的修复方法。这里真正的问题似乎是这个嵌套的私有静态类缺少公共构造函数。这一调整删除了警告：

```
package com.example.bugs;

public class WeirdInnerClassJavaWarning {
    private static class InnerClass
    {
        public void doSomething() {}
        public InnerClass() {}
    }

    final private InnerClass anInstance;

    {
        this.anInstance = new InnerClass();
        this.anInstance.doSomething();
    }
} 
```

我希望该类是一个私有嵌套类（因此没有其他类可以访问它，包括封闭类的子类）并且我希望它是一个静态类。

我仍然不明白为什么使嵌套类受保护而不是私有是解决“问题”的另一种方法，但这可能是 Eclipse 的一个怪癖/错误。

（抱歉，为了更清楚，我应该称它为 NestedClass 而不是 InnerClass。）

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-28T14:37:32.013

You can get rid of the warning as follows:

```
package com.example.bugs;

public class WeirdInnerClassJavaWarning {
    private static class InnerClass {
        protected InnerClass() {}  // This constructor makes the warning go away
        public void doSomething() {}
    }

    final private InnerClass anInstance;
    {
        this.anInstance = new InnerClass(); 
        this.anInstance.doSomething();
    }
} 
```

As others have said, Eclipse is complaining because a private class with no explicit constructor cannot be instantiated from outside, except via the synthetic method that the Java compiler creates. If you take your code, compile it, and then decompile it with [jad](http://en.wikipedia.org/wiki/JAD_(JAva_Decompiler)) (*), you get the following (reformatted):

```
public class Test {
  private static class InnerClass {
    public void doSomething() {}
    // DEFAULT CONSTRUCTOR GENERATED BY COMPILER:
    private InnerClass() {}

    // SYNTHETIC METHOD GENERATED BY THE JAVA COMPILER:    
    InnerClass(InnerClass innerclass) {
      this();
    }
  }

  public Test() {
    anInstance.doSomething();
  }

  // Your instance initialization as modified by the compiler:
  private final InnerClass anInstance = new InnerClass(null);
} 
```

If you add a protected constructor, the synthetic code is unnecessary. The synthetic code is theoretically, I suppose, slower by a minescule amount than non-synthetic code using a public or protected constructor.

(*) For jad, I linked to a Wikipedia page ... the domain that hosted this program has expired, but Wikipedia links to another that I have not tested myself. I know there are other (possibly more recent) decompilers, but this is the one I started using. Note: It *complains* when decompiling recent Java class files, but it still does a good job.

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-08-30T17:27:09.653

By the way, the setting to turn the warning off is in the Java Errors/Warnings page under "Code style" and is called:

> Access to a non-accessible member of an enclosing type

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-28T14:11:26.433

您不能从 WeirdInnerClassJavaWarning 实例化 InnerClass。它是私有的，JVM 不会让你这样做，但 Java 语言（出于某种原因）会。

Therefore, javac would make an additional method in InnerClass that would just return new InnerClass(), therefore permitting you to create InnerClass instances from WeirdInnerClassJavaWarning.

i don't think you really need to get rid of it because the perfomance drop would be inmeasureably tiny. However, you can if you really want to.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-28T14:52:36.617

> > I still don't understand why making the nested class protected rather than private is another method of fixing the "problem", but maybe that is a quirk/bug of Eclipse

That is not a quirk/bug of Eclipse, just a feature of Java. The [Java Language Specification, 8.8.9](http://java.sun.com/docs/books/jls/third_edition/html/classes.html#8.8.9) says:

> ... if the class is declared protected, then the default constructor is implicitly given the access modifier protected ...

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-08-21T15:27:12.177

To help folks out, here is what you get if you use the original class code in the question with

```
javac -XD-printflat WeirdInnerClassJavaWarning.java -d tmp 
```

Raw output, compiler added the comments. Note the addition of the synthetic package private class and constructor.

```
public class WeirdInnerClassJavaWarning {
    {
    }

    public WeirdInnerClassJavaWarning() {
        super();
    }
    {
    }
    private final WeirdInnerClassJavaWarning$InnerClass anInstance;
    {
        this.anInstance = new WeirdInnerClassJavaWarning$InnerClass(null);
        this.anInstance.doSomething();
    }
}

class WeirdInnerClassJavaWarning$InnerClass {

    /*synthetic*/ WeirdInnerClassJavaWarning$InnerClass(WeirdInnerClassJavaWarning$1 x0) {
        this();
    }

    private WeirdInnerClassJavaWarning$InnerClass() {
        super();
    }

    public void doSomething() {
    }
}

/*synthetic*/ class WeirdInnerClassJavaWarning$1 {
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T14:19:49.647

You should be able to get rid of it by using the default scope instead of private or protected, i.e.

```
static class InnerClass ... 
```

It's also worth noting that my placing your cursor on the line of code with the warning and pressing ctrl-1, Eclipse may be able to fix this automatically for you.

# database - 使用 Oracle Auto Segment Space Management 的优点/缺点是什么？

> ID：921026
> 
> 赞同：1
> 
> 时间：2009-05-28T14:06:39.207
> 
> 标签：database, oracle, oracle10g

我一直在考虑将我们的许多 Oracle 表空间转换为使用自动段空间管理。

我知道这有助于管理免费列表等，但我很好奇是否有人看到使用此选项的任何缺点？主要优势？

我们的环境在某种程度上是 OLTP 和数据仓库之间的混合体，其中一些表很大且相当静态，到具有大量更新和分区的超过 7 亿行的表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T14:24:18.233

的要点`ASSM`是为您动态自动`Oracle`选择`PCTUSED`，您不再可以控制它。

`PCTUSED``non-free`告诉块中应该有多少空间才能`free`再次变成（`free`这里意味着能够接受新插入的行）

如果您从未为您的数据库微调此参数，那么您可能会从`ASSM`.

# data-structures - 是否有任何工具可以在树数据结构中查找重复部分？

> ID：921027
> 
> 赞同：0
> 
> 时间：2009-05-28T14:06:49.453
> 
> 标签：data-structures, tree

我正在寻找一种在树数据结构中查找重复节点的工具（使用 Freemind 来映射数据结构，但我会满足于任何我可以导出通用数据树的东西......）

这个想法是我可以将树分解成可以重复的模块，从而简化树的结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T14:52:07.320

我只会有一个子树表。

深度优先走树。在每个节点，访问完子节点后，如果表中存在等价节点，则将当前节点替换为表中的那个。如果表中没有等效节点，则将当前节点添加到表中。

这样做吗？我相信这被称为共同子表达式消除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:17:25.003

防止树中的重复节点实际上不是更好吗？为什么树中需要重复节点？

# asp.net - Safari 中视图状态 MAC 的验证失败

> ID：921028
> 
> 赞同：0
> 
> 时间：2009-05-28T14:07:48.470
> 
> 标签：asp.net, safari, viewstate

我有一个使用表单身份验证的网络应用程序。当我执行以下步骤时

1.  让登录cookie过期
2.  单击需要登录用户的链接
3.  用户被重定向到登录页面
4.  点击浏览器后退按钮
5.  用户再次被重定向到登录页面
6.  使用有效的用户名/密码登录

我收到此异常视图状态 MAC 验证失败。如果此应用程序由 Web Farm 或集群托管，请确保配置指定相同的 validationKey 和验证算法。AutoGenerate 不能在集群中使用。

这种情况只出现在 safari（windows 和 mac）中。safari 与其他浏览器的根本区别在于，当我们在第 4 步中单击返回按钮时，safari 再次显示登录页面，而其他浏览器显示用户正在处理的前一个页面。

请在这方面提供帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T05:15:42.547

从 Safari v 5.1.4 开始，我们遇到了与视图状态类似的问题。

我们的问题是因为我们在 window.onload 事件期间提交了一个表单，然后重定向到一个新页面。提交第二页时，我们会得到您报告的 peroration。

当我们提交第二页时，我们确定 safari 5.1.4 和 5.1.5 正在发送前一页的视图状态，这会导致验证错误

请参阅我在此线程[ASP.NET Viewstate with Safari 5.x中的回复](https://stackoverflow.com/questions/9892840/asp-net-viewstate-with-safari-5-x)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-16T06:12:13.533

虽然我在日志中看到了让我相信我面临与您相同的问题的错误，但我还无法在示例应用程序中重现该错误。我的猜测是来自超时页面的视图状态信息正在提交到登录页面，这是无效的。为了纠正这个问题，可以在登录页面生命周期（可能是 Page_Init）的早期放置一些东西，以便识别何时重定向到登录页面（可能通过引用）并绕过视图状态验证。

# c# - 组合题

> ID：921031
> 
> 赞同：0
> 
> 时间：2009-05-28T14:08:54.753
> 
> 标签：c#, permutation

我有一个像下面这样的数组

```
int[] array = new array[n];// n may be 2,3,4 
```

N = 4 的示例

```
int[] array = new array[4];

array[0] = 2;
array[1] = 4;
array[2] = 6;
array[3] = 8; 
```

我如何在不使用 linq 的情况下计算该数组的所有未重复组合？

2,4,6,8
2,4,8,6
2,8,6,4
2,6,4,6
8,6,4,2
2,4,6,8
..........
_ ………………
_

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T14:19:26.373

这是一个使用迭代器的[非常灵活的 C# 实现。](http://www.interact-sw.co.uk/iangblog/2004/09/16/permuterate)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:21:35.807

好吧，鉴于您正在寻找所有不重复的组合，这意味着将有 N 个！这样的组合......（所以，在你的情况下，N！= 4！= 24个这样的组合）。

当我正在发布这个时，dommer 指出了一个很好的实现。

请注意，对于较大的 N 值，它会变得非常慢（因为有 N! 排列）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T14:25:52.757

想想世界上两种可能的状态，看看这是否能说明问题。

1）我的数组中没有重复（即数组中的每个数字都是唯一的）。在这种情况下，有多少种可能的*排列*？

2）阵列中有一个单一的重复。所以，在你在第一部分计算的排列数量中，有多少只是重复的

嗯，为简单起见，让我们采用一个三元素数组

1,3,5有多少种排列？

1,3,5

1,5,3

3,1,5

3,5,1

5,1,3

5,3,1

所以六个排列

现在如果我们将列表更改为 1,5,5 会发生什么？

我们得到

1,5,5

5,1,5

5,5,1

我对您的问题是，您如何通过阶乘来表达这一点？

也许尝试用一个四元素数组写出所有排列，看看灯泡是否熄灭？

# javascript - jQuery 表到 CSV 导出

> ID：921037
> 
> 赞同：30
> 
> 时间：2009-05-28T14:10:19.883
> 
> 标签：javascript, jquery

我正在使用 jQuery 表到 CSV 插件。我已经更改了弹出窗口，以便它告诉浏览器下载 CSV 文件。

它是：

```
function popup(data) {
  var generator = window.open('', 'csv', 'height=400,width=600'); 
  generator.document.write('<html><head><title>CSV</title>'); 
  generator.document.write('</head><body >'); 
  generator.document.write('<textArea cols=70 rows=15 wrap="off" >'); 
  generator.document.write(data); 
  generator.document.write('</textArea>'); 
  generator.document.write('</body></html>'); 
  generator.document.close();
  return true; 
} 
```

我已将其更改为：

```
function popup(data) {
  window.location='data:text/csv;charset=utf8,' + encodeURIComponent(data);
  return true; 
} 
```

它在大多数情况下都有效。它仍然需要您找到您的电子表格软件，并创建自己的文件名……因为它会创建一个奇怪的文件名（例如：14YuskG_.csv.part）。

关于如何改进这一点的任何建议？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-28T15:51:12.990

找到了一个可行的解决方案（在[http://www.topsemtips.com/2008/11/save-html-table-to-excel-using-jquery/](http://www.topsemtips.com/2008/11/save-html-table-to-excel-using-jquery/)的帮助下）：

我将功能更改为：

```
function popup(data) {
    $("#main div.inner").append('<form id="exportform" action="export.php" method="post" target="_blank"><input type="hidden" id="exportdata" name="exportdata" /></form>');
    $("#exportdata").val(data);
    $("#exportform").submit().remove();
    return true; 
} 
```

并创建了文件 export.php：

```
<?php

    header("Content-type: application/vnd.ms-excel; name='excel'");
    header("Content-Disposition: filename=export.csv");
    header("Pragma: no-cache");
    header("Expires: 0");

    print $_REQUEST['exportdata'];

?> 
```

**更新：** 一个对 IE7 更友好的版本：

```
<?php

    header('Content-Type: application/force-download');
    header('Content-disposition: attachment; filename=filename.csv');

    print $_POST['exportdata'];

?> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-08-03T11:14:27.717

感谢您的提问和回答，对我来说效果很好。这是我正在使用的解决方案的（几乎相同的）ASP.Net 版本：

将 table2CSV.js 弹出函数更改为：

```
function popup(data) {
       $("body").append('<form id="exportform" action="CsvExport.ashx" method="post" target="_blank"><input type="hidden" id="exportdata" name="exportdata" /></form>');
       $("#exportdata").val(data);
       $("#exportform").submit().remove();
       return true;
} 
```

注意从 export.php 到 .ashx 通用处理程序的变化。

通用处理程序代码：

```
 public void ProcessRequest (HttpContext context) {
    context.Response.ContentType = "application/force-download";
    context.Response.AddHeader("content-disposition", "filename=filename.csv");

    context.Response.Write(context.Request.Form["exportdata"]);
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-28T15:00:46.833

我不建议以这种方式“下载”CSV 数据。IE7 只允许地址栏中最多包含 2000 个字符，因此您的文件被截断的可能性很高。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-14T21:29:56.330

不兼容所有浏览器，但不需要服务器端！[使用 JSFiddle](http://jsfiddle.net/TdWgC/3/)尝试下面的代码，并告诉我们它是否在您的浏览器中运行。

```
$('<a></a>')
    .attr('id','downloadFile')
    .attr('href','data:text/csv;charset=utf8,' + encodeURIComponent(data))
    .attr('download','filename.csv')
    .appendTo('body');

$('#downloadFile').ready(function() {
    $('#downloadFile').get(0).click();
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-09T20:40:37.880

我强烈推荐使用[http://datatables.net/extras/tabletools/](http://datatables.net/extras/tabletools/)，它使玩表格变得非常容易

# opengl - Java 有没有好的 3d 软件渲染器？

> ID：921039
> 
> 赞同：0
> 
> 时间：2009-05-28T14:10:58.073
> 
> 标签：opengl, rendering, java-3d

我有一台 CPU 性能良好但 GPU（集成显卡）速度较慢的 PC。我注意到一些商业游戏使用他们的软件渲染器而不是 OpenGL 或 DirectX 效果更好。我正在制作一个使用 JOGL/LWJGL 访问 OpenGL 的 Java 应用程序。要启用软件渲染选项，我应该查看纯 Java 软件渲染器，还是仅使用本机软件的 OpenGL 实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T14:26:41.553

您可以安装[Mesa 3D](http://www.mesa3d.org/)。这个 OSS 项目为 Windows 提供了一个基于软件渲染器的 OpenGL 驱动程序。

# .net - 如何将多个报告附加在一起？

> ID：921049
> 
> 赞同：7
> 
> 时间：2009-05-28T14:12:53.640
> 
> 标签：.net, crystal-reports, report, subreports

我有许多报告既需要单独运行，也需要作为一个组运行。

我已经创建了这些报告，并希望我可以创建一个表单，我可以在其中将 report1、report2、report3 等附加在一起，而无需创建不同的报告并将所有这些报告作为子报告。

这可能吗？

* * *

编辑：我在 .NET WinForms 控件中显示它，但它也将被导出为 PDF，也许还有 DOC、XLS 等......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T14:15:31.543

创建第三个报告，其中前 N 个报告在标题中一个接一个地设置为子报告。为什么这对您来说不是一个好选择？

可能你可以后附加。输出格式是什么？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T14:19:33.157

如果您想要更动态的解决方案，请使用 Kieveli 建议的选项并根据用户的选择显示和隐藏子报表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-15T16:01:18.393

绝对最好的做法是使用子报表，减少编码，减少麻烦。

# comments - Java源文件中注释的最佳实践？

> ID：921050
> 
> 赞同：5
> 
> 时间：2009-05-28T14:12:55.653
> 
> 标签：comments

这不一定*是*Java，但这是我正在处理的。*另外，我不太关心那些方法和细节，我想知道整个类文件。*

对于给定的类文件，我真正需要在评论中包含哪些内容？在我的公司，我真正能想到的唯一事情是：

*   版权/许可
*   类做什么的描述
*   最后修改日期？

还有什么需要提供的吗？

我听到的一件合乎逻辑的事情是将作者排除在标题之外，因为它与已经通过源代码控制提供的信息是多余的。

**更新：** JavaDoc 可以在这里假设，但我真的更关心包含内容方面的好处的细节，无论是可以挖掘的最终元数据，还是更松散的，为什么等等......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-28T14:15:25.803

> 我听到的一件合乎逻辑的事情是将作者排除在标题之外，因为它与已经通过源代码控制提供的信息是多余的。

最后修改日期也是**多余的**

我使用一小组*文档模式*：

*   始终记录有关线程安全的信息
*   总是记录不变性
*   带有示例的 javadoc
*   @Deprecation 使用**WHY**和**HOW**替换带注释的元素
*   保持评论最少

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-28T14:15:18.050

对“最后修改日期”说不 - 这也属于源代码管理。

其他两个都很好。基本上专注于*有用*的文本 - 类做什么，关于线程安全的任何警告，预期用法等。

实施意见通常应该是关于你为什么要做一些不明显的事情——因此应该很少见。（例如，这可能是因为某些 API 以不寻常的方式运行，或者因为您可以使用一个有用的快捷方式，但不是立即显而易见。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T14:15:40.887

为了您自己和未来的开发人员的理智，您真的应该编写[Javadocs](http://java.sun.com/j2se/javadoc/writingdoccomments/index.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T14:38:14.057

当你觉得需要写注释来解释某些代码的作用时，提高代码的可读性，这样就不需要注释了。您可以通过重命名方法/字段/类以具有更有[意义的名称，并使用](http://tottinge.blogsome.com/meaningfulnames/)[组合方法模式](http://codebetter.com/blogs/jeremy.miller/archive/2006/12/03/Composed-Method-Pattern.aspx)将较大的方法拆分为较小的方法来做到这一点。

如果即使经过你所有的努力，代码也不是不言自明的，例如*为什么*必须编写一些不明显的代码的原因在代码中并不清楚，那么[通过写注释来道歉](http://butunclebob.com/ArticleS.TimOttinger.ApologizeIncode)。（有时你可以通过编写一个失败的测试来记录原因，如果有人改变了不明显但正确的代码来做明显但错误的事情。但除此之外有一个评论也是有用的。我在前面加上这样的前缀评论通常带有“// HACK：”或“// XXX：”。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T14:16:53.867

类目的的总体描述，每个字段的描述和每个方法的约定。Javadoc 格式运行良好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-30T19:11:56.087

如果您将组件的所有权分配给特定的开发人员或团队，则所有者应记录在组件源或 VCS 元数据中。

# c# - SqlDataReader - 结果集缓存？

> ID：921088
> 
> 赞同：2
> 
> 时间：2009-05-28T14:19:42.907
> 
> 标签：c#, sql-server, sqldatareader

当您使用 SqlDataReader 时，返回集是否完全由 ExecuteReader 步骤确定，或者您是否可以通过在读取时写入源表来影响您获得的结果？这是一个非常粗糙的伪代码示例。

```
sc = new SqlCommand("select * from people order by last, first",db) ;
sdr = sc.ExecuteReader() ;

while (sdr.read())
{
    l = (string) sdr["last"] ;
    k = (string) sdr["key"] ;
    if (l.Equals("Adams")) 
    {
       sc2 = new SqlCommand("update people set last = @nm where key = @key") ;
       sc2.Parameters.Add(new SqlParameter("@nm", "Ziegler"));
       sc2.Parameters.Add(new SqlParameter("@key", k));
       sc2.ExecuteNonQuery() ;
    }
} 
```

我在其他环境中看到了很多由于写入您正在阅读的表而导致的错误。这里记录 k 从列表的顶部 (Adams) 被撞到底部 (Ziegler)。我假设（哈！）SqlDataReader 是免疫的。真的？错误的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T14:22:30.577

这取决于您的[事务隔离级别](http://msdn.microsoft.com/en-us/library/aa259216(SQL.80).asp)或其他锁定提示，但 iirc 默认情况下从 sql server 中的表读取会锁定这些记录，因此您发布的代码将死锁（sc2 最终将超时）或更新将进入事务日志，在您的阅读器完成之前不会写入任何内容。我不记得我的头顶上是哪个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T14:26:27.340

我看到的一个问题是，当阅读器打开时，它拥有数据库连接，当阅读器打开时，没有其他东西可以使用它。所以唯一可能的方法是使用不同的数据库连接，它仍然取决于事务级别

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T14:27:47.713

如果您想假设读取的数据不会被这些更新改变，您是否可以将数据读取到临时对象容器中，然后在完成所有读取之后，*然后*进行更新？这会使问题变得没有意义。

当然，从“这到底是如何工作的”的角度来看，我确实发现这个问题很有趣。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T14:30:47.690

如果您想在迭代查询结果时进行更新，您可以将其全部读入 DataSet。

我知道你没有问这个问题，而且我也知道这是伪代码，但请务必将你的 sc、sdr 和 sc2 变量包装在 using () 语句中，以确保它们被正确处理。

# asp.net - 无法在 asp.net 网格模板列中绑定

> ID：921090
> 
> 赞同：1
> 
> 时间：2009-05-28T14:20:01.910
> 
> 标签：asp.net, telerik

我无法访问数据字段。我收到错误消息：Eval()、XPath() 和 Bind() 等数据绑定方法只能在数据绑定控件的上下文中使用。

我可以获取值，但使用 <%# getOpenJobs((string)Eval("ParentPart")) %> 但如果它通过条件，我需要在 if 中使用它来显示一个特定的图片。有没有更好的方法来做到这一点，或者我只是错过了一些简单的东西？

```
 <telerik:GridTemplateColumn UniqueName="hasOpenJobs" HeaderText="">
                <ItemTemplate>
                        <% if (getOpenJobs((string)Eval("ParentPart")) > 1)
                           { %>
                            <img src="../images/job-icon.gif" alt="Open Jobs" />
                         <%} %>
                </ItemTemplate>
            </telerik:GridTemplateColumn> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T14:30:34.087

在这些情况下，我通常在代码隐藏中创建一个方法来发回最终生成的 HTML。例如

```
<ItemTemplate>
<%# GetJobImageHtml((string)Eval("ParentPart")) %>
</ItemTemplate> 
```

然后在方法中执行您需要的任何逻辑`GetJobImageHtml()`并返回一个 HTML 字符串。

# jquery - 从一个项目遍历到父 td 和 tr 在一个单元格中单击

> ID：921094
> 
> 赞同：2
> 
> 时间：2009-05-28T14:20:30.270
> 
> 标签：jquery

我在 html 表格的每一行的表格单元格中有一个链接（锚点）标签。单击此锚标记时，我想使用 jquery（最好）遍历父 td 和 tr 并获取对它的对象引用。

我怎样才能在这里最好地使用 jquery 在 dom 中导航\遍历。

我可以做这样的方法，但不确定 jquery 是否有更好的方法。

```
function findRowNumber(element) 
{ 
  // element is a descendent of a tr element

  while(element.tagName.toLowerCase() != "tr") 
  {
   element = element.parentNode; // breaks if no "tr" in path to root
  }

  return element.rowIndex;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T14:34:03.223

这正是“[最接近](http://docs.jquery.com/Traversing/closest#expr)”的用途。

```
$(this).closest('td');
$(this).closest('tr'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T14:26:31.380

在锚点的 click() 函数中，只需使用这些：

```
$(this).parents('td:first')
$(this).parents('tr:first') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T14:43:11.863

.closest 很简洁，但最近才引入（jQuery 1.3 或更新版本）。如果您绑定到旧版本的 JQuery，请遵循其他答案。

# c# - 如何使用 Facebook API 发送邀请请求？

> ID：921098
> 
> 赞同：5
> 
> 时间：2009-05-28T14:21:18.333
> 
> 标签：c#, facebook

我想从我用 C# 编写的 Facebook 应用程序发送邀请请求。

这是我尝试过的：

```
_fbService.API.notifications.sendEmail(DataList1.DataKeys[e.Item.ItemIndex].ToString(),"Invitation to play a game", "You are invited to play the game",""); 
```

这不起作用，它只发送通知，而不是请求。
我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-05T07:32:19.960

如果您询问如何向未授权您的应用程序的用户发送邀请（即不邀请您的应用程序用户使用新功能或参与活动），那么您不能使用 API。

从 API 文档 - [Notifications.sendEmail](https://developers.facebook.com/docs/reference/rest/notifications.sendEmail/)：

> 向已授权您的应用程序并授予其电子邮件扩展权限的指定用户发送电子邮件。

允许这样做的 API 函数是[Notifications.sendRequest](https://developers.facebook.com/docs/reference/rest/notifications.sendRequest/)，但它已被禁用，可能是出于滥用和安全性的考虑。有关替代方法，请参阅文档。

# c# - 如何创建 ADO.NET 实体框架 ObjectContext 扩展

> ID：921106
> 
> 赞同：1
> 
> 时间：2009-05-28T14:22:39.063
> 
> 标签：c#, .net, entity-framework

我想创建[Cesar de la Torre 的博客文章](http://blogs.msdn.com/cesardelatorre/archive/2008/09/04/updating-data-using-entity-framework-in-n-tier-and-n-layer-applications-short-lived-ef-contexts.aspx)中描述的上下文扩展方法。

但我不确定如何声明包含我的扩展方法的类。

[格里夫汤森](http://grifftownsend.blogspot.com/2008/08/small-extension-to-entity-framework.html)写道：

> 如果我包含对此类的引用（或在我的命名空间中有该类），则任何 ObjectContext 引用都将能够执行这些扩展：
> 
> ![ADO.NET Entity Framework 扩展方法 intellisense](https://4.bp.blogspot.com/_wtz1ml2FXzY/SLtQloSs0KI/AAAAAAAAABI/X5RSyF3awxQ/s400/ExtensionScreen.png)
> 
> 如果您查看上面照片中的工具提示，您应该能够看到我现在可以干净地访问我添加到我创建的 EntitySet 的任何函数。

如何声明包含我的扩展方法的类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:00:09.067

你只需要声明一个静态类：

```
public static class MyExtensions
{
    // extension methods go here
} 
```

# linq - 使用 LINQ 进行任意排序

> ID：921107
> 
> 赞同：2
> 
> 时间：2009-05-28T14:22:46.473
> 
> 标签：linq, sorting, entities

假设我们有一个具有属性 att1 和 att2 的实体，其中 att1 可以具有值 a、b、c，而 att2 可以具有值 1、2、3。是否可以使用 LINQ，以便我们可以通过应用任意排序规则对集合中的项目进行排序，而无需实现 IComparable。我面临的问题是业务要求在集合中的某些屏幕上以一种方式排序，而在其他屏幕上以其他方式排序。例如，规则可以声明需要对项目进行排序，以便首先列出“b”，然后是“a”，然后是“c”，并且在每个组中，首先是“3”，然后是“1”，然后是“2”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T14:27:12.423

当然。您可以使用`OrderBy`谓词，该谓词或多或少地返回您喜欢的任意“排序顺序”。例如：

```
objectsWithAttributes.OrderBy(x =>
{
    // implement your "rules" here -- anything goes as long as you return
    // something that implements IComparable in the end.  this code will sort
    // the enumerable in the order 'a', 'c', 'b'

    if (x.Attribute== 'a')
        return 0;
    else if (x.Attribute== 'c')
        return 1;
    else if (x.Attribute== 'b')
        return 2;
}).ThenBy(x =>
{
    // implement another rule here?
}); 
```

# perl - Perl 的 GetOpt::Long 接受开关的缩写是一个错误吗？

> ID：921109
> 
> 赞同：4
> 
> 时间：2009-05-28T14:22:52.900
> 
> 标签：perl, getopt

这是我为测试命令行参数处理而编写的一个简单脚本：

```
use Getopt::Long;

my $help = 0;

GetOptions(
'help|h|?' => \$help,
) or die "Error!";

print "OK\n"; 
```

我得到的结果如下：

```
D:\>perl test.pl --help
OK

D:\>perl test.pl --hell
Unknown option: hell
Error! at test.pl line 10.

D:\>perl test.pl --he
OK

D:\>perl test.pl --hel
OK 
```

有没有人注意到这一点？这种行为（接受他和他而不是帮助）是一个潜在的错误吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-28T14:26:13.783

这是[此处记录的功能](http://perldoc.perl.org/Getopt/Long.html#Case-and-abbreviations)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-28T14:26:31.257

不，是故意的。它接受选项的最短非歧义版本，因此如果您有另一个选项“--hex”，它不会接受“--he”，但会接受“--hel”。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-28T15:18:09.093

这是一个[特点](http://perldoc.perl.org/Getopt/Long.html#Case-and-abbreviations)。只要结果不模棱两可，选项可以被缩写。如果您不想要这种行为，可以通过[配置](http://perldoc.perl.org/Getopt/Long.html#Configuring-Getopt%3a%3aLong)禁用它。

如果这是一个错误，检查它是否是已知错误的地方是rt.cpan.org[的](http://rt.cpan.org)[错误队列](http://rt.cpan.org/Public/Dist/Display.html?Name=Getopt-Long)。

# c# - 如何获取窗口中“X”按钮的坐标？

> ID：921111
> 
> 赞同：0
> 
> 时间：2009-05-28T14:23:17.067
> 
> 标签：c#, .net, winforms, wndproc

出于某种原因，我需要检测用户何时实际单击了 X 按钮。我到目前为止是这样的：

```
 protected override void WndProc(ref Message m)
    {
        if (m.Msg == (int)0xa1) //WM_NCLBUTTONDOWN
        {
            Point p = new Point((int)m.LParam);
            p = this.PointToClient(p);
            if (p.X > 680)
            {
                //do what I need to do...
            }
        }

        base.WndProc(ref m);
    } 
```

基本上，我会注意“WM_NCLBUTTONDOWN”消息，即鼠标单击窗口的非客户区。然后，我从 LParam 获取 X 和 Y 坐标，最后将其转换为屏幕坐标。所以在这一点上，我知道用户点击了非客户区，我知道表单上的位置。

我的问题是，如何判断这些坐标是否在 X 按钮上。目前，我正在对 680 进行硬编码，因为这适用于当前窗口大小（它不是很大），但问题是我使用的是 Windows 7，它的 X 按钮比 XP 大，所以显然硬编码是不可行的选项。此外，我什至没有为 Y 坐标编码，所以如果有人点击窗口的右边缘，也会触发该代码。所以...有人有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T14:33:12.333

假设您有一个“确定”和一个“取消”按钮，为什么不在单击其中一个按钮时设置一个值。然后在窗体的 Closing 事件中，如果没有设置这个值，就知道 X 按钮被点击了。除非有其他方法可以关闭我不知道的表格...

编辑：

您可以在单击按钮时更改表单的 DialogResult 属性，而不是使用全局布尔值。我不确定单击 X 按钮时的 DialogResult 值是多少，但您必须尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:45:37.647

如果您测试 WM_NCHITTEST 消息，该消息应该会告诉您鼠标何时悬停在关闭按钮上。

# c# - c# Winforms：刷新 GUI 的一部分（包含 1 个或多个控件）

> ID：921118
> 
> 赞同：1
> 
> 时间：2009-05-28T14:25:17.437
> 
> 标签：c#, winforms, controls, user-controls

我有一个可以在我的 GUI 中覆盖多个 C# 用户控件的控件。该控件具有半透明背景，以便将 GUI 的部分“灰显”，并且该类看起来像这样：

```
public greyOutControl: UserControl
{
    // Usual stuff here

    protected overide OnPaint()
    {
        paintBackround();

        base.OnPaint();
    }
} 
```

目前，控件有时会陷入循环并不断重新绘制背景，使半透明颜色显得越来越不透明。

我解决这个问题的想法如下（广义上）：

1) 确定 grayOutControl 位于什么控件之上 2) 在这些控件上调用 Refresh() 以更新显示 3) 继续绘制 grayOutControl。

我的问题是：如何确定 grayOutControl 重叠的控件？或者有没有办法只刷新 grayOutControl 覆盖的 GUI 部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T14:38:02.247

为什么不跟踪透明控件并在绘制所有其他控件后绘制它们？在 Z 顺序顶部绘制任何内容不应导致重新绘制其他控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:29:58.770

我看不到找到重叠控件的直接方法。我认为您可能需要检查整个控制树才能找出答案。关于刷新，可以使用`Control.Invalidate(Rectangle)`方法指定刷新哪个部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-09T07:32:37.463

我发现这个问题的解决方案是以编程方式拍摄被覆盖区域的屏幕截图，然后使用该图像作为被覆盖控件的背景。然后，这允许您将 alpha 叠加层放入 OnPaint() 方法内的图像中，并让控件正确地绘制自身。

这确实有一个缺点，即背景不会在重叠控件中更新，但除非有许多事件处理程序在观察是否有变化然后更新重叠控件，否则我看不到任何解决问题的方法。有时我后悔没有尝试使用 WPF！

# jquery - iPhone/Android/BlackBerry 上的 jQuery

> ID：921130
> 
> 赞同：29
> 
> 时间：2009-05-28T14:27:16.573
> 
> 标签：jquery, iphone, android, browser, blackberry

我目前没有任何要测试的设备。我想我稍后会开始使用模拟器。

我们正在寻求提供移动支持。我想知道 jQuery 甚至 javascript 如何在各自的浏览器中呈现。

什么有效？什么没有？有小费吗？建议？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-28T14:34:35.780

我在 iPhone 上使用过 jQuery。请记住，Mobile Safari 不是官方支持的 jQuery 浏览器。但它与 Safari 足够接近，大多数东西都能正常工作。

如果我没记错的话，mousedown 事件在 mouseup 发生之前不会发生，此时两者都会触发。我的猜测是大多数事情都会奏效，但你需要仔细测试一切。

我的经验是更改 DOM 出乎意料的慢。在模拟器上飞行的东西可以在设备上拖动。（你提到你会使用模拟器——不要相信你在他们身上获得的性能。）

jQuery 可能有点矫枉过正。我最终依赖于 XUI，它为您提供了很多 jQuery 的东西，但更轻量级，并且还为您提供了触摸事件。[http://github.com/brianleroux/xui/tree/master](http://github.com/brianleroux/xui/tree/master)

* * *

ppk 已开始测试移动浏览器。[http://www.quirksmode.org/m/w3c_core.html](http://www.quirksmode.org/m/w3c_core.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-10-22T22:29:05.027

今天遇到这个，记得在这里阅读你的帖子。以为我会为任何对 iPhone 的 jQuery 项目感兴趣的人提供链接：

[http://jqtouch.com/](http://jqtouch.com/)

还没有机会尝试它，但它似乎在浏览器中复制了许多 iPhone 界面元素。我认为它显示了一些承诺，并使用了很多 jQuery 约定。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-02T18:11:48.157

Do not expect jquery to work much at all on Blackberry. The default browser is very limited in terms of JavaScript and page rendering.

Though opera on Blackberry might be a different story...

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-23T18:58:41.113

您可以使用这个新库：[http ://www.sencha.com/](http://www.sencha.com/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-04-19T21:30:22.843

我经常在 i-phone 上使用 JQTouch，觉得它很棒。它不适用于Android。JQuery 非常非常慢（Android 2.0 HTC Desire 和 Legend），因此 JQTouch 受到影响。此外，动画效果很差，比我的 Mac 上的每晚 WebKit 更差，后者相当闪烁……你明白了，但没有 i-phone 那样流畅。我真的很喜欢 Android 平台和 JQTouch，但它们不能很好地结合在一起。

G*

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-11-12T17:23:04.660

Android 与 iPhone 上的 JQTouch 的好处在于，您可以通过一些工作来交换默认的 theme.css，这样您的网站在 iPhone 上看起来就像一个 iPhone 应用程序，但在 android 上却是一个更通用的移动网站。为手机用户提供他们所期望的东西，而您几乎不需要任何工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-22T10:54:12.897

我正在为 Android/iPhone 使用 JQTouch。它看起来很棒而且功能强大。加载屏幕和快捷方式图标不像 iphone 那样安装，动画也不起作用，但它提供了一个很好看的模板。

# javascript - JavaScript 命名约定

> ID：921133
> 
> 赞同：260
> 
> 时间：2009-05-28T14:28:03.703
> 
> 标签：javascript, naming-conventions

我知道关于哪种命名约定最适合 JavaScript 存在很多争议（也许不是争议，但至少是争论）。

你如何命名你的变量、函数、对象等？

我会留下我自己的想法，因为我已经很久没有做 JS（只有几年），而且我刚刚收到一个请求，要创建一个带有命名约定的文档，以便在我们的工作项目中使用. 所以我一直在寻找（google-ing），并且有很多不同的意见。

我读过的关于 JS 的书籍本身也使用不同的命名约定，但他们都同意一点：“找到适合你的，并坚持下去。” 但是现在我已经阅读了很多，我发现我喜欢其他一些方法比我现在习惯的要好一些。

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2009-05-28T14:33:43.800

我遵循[Douglas Crockford 的](https://www.crockford.com/code.html)JavaScript 代码约定。我还使用他的[JSLint](http://www.jslint.com/)工具来验证是否遵循这些约定。

* * *

## 回答 #2

> 赞同：161
> 
> 时间：2011-04-12T18:39:17.010

正如杰夫所说，[克罗克福德所说](http://crockford.com/javascript/code.html)的很好。

我遵循的唯一例外（并且已经被广泛使用）是使用 $varname 来指示 jQuery（或任何库）对象。例如

`var footer = document.getElementById('footer');`

`var $footer = $('#footer');`

* * *

## 回答 #3

> 赞同：114
> 
> 时间：2011-04-12T19:33:12.460

您可以遵循此[Google JavaScript 样式指南](https://google.github.io/styleguide/jsguide.html#naming)

通常，使用 functionNamesLikeThis、variableNamesLikeThis、ClassNamesLikeThis、EnumNamesLikeThis、methodNamesLikeThis 和 SYMBOLIC_CONSTANTS_LIKE_THIS。

[编辑：请参阅JavaScript Style Guides And Beautifiers](http://addyosmani.com/blog/javascript-style-guides-and-beautifiers/)的精美集合。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-06-06T19:04:18.873

我想尝试的一种约定是使用“the”前缀命名静态模块。看一下这个。当我使用别人的模块时，很难看出我应该如何使用它。例如：

```
define(['Lightbox'],function(Lightbox) {
  var myLightbox = new Lightbox() // not sure whether this is a constructor (non-static) or not
  myLightbox.show('hello')
}) 
```

我正在考虑尝试一种约定，其中静态模块使用“the”来表示它们的存在。有没有人见过比这更好的方法？看起来像这样：

```
define(['theLightbox'],function(theLightbox) {
  theLightbox.show('hello') // since I recognize the 'the' convention, I know it's static
}) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-28T14:35:06.870

我认为除了一些语法限制之外；命名约定推理在很大程度上与语言无关。我的意思是，支持 c_style_functions 和 JavaLikeCamelCase 的论点同样可以反过来使用，只是语言用户倾向于遵循语言作者。

话虽如此，我认为大多数库都倾向于大致遵循 Java CamelCase 的简化。我发现[道格拉斯·克罗克福德的建议](http://javascript.crockford.com/style1.html)对我来说足够有品味。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T14:48:59.463

这是一个个人问题，可能取决于您的工作方式。有些人喜欢把变量类型放在变量的开头，比如“str_message”。有些人喜欢在单词之间使用下划线（“my_message”），而另一些人喜欢用大写字母（“myMessage”）分隔它们。

我经常与其他人一起使用大型 JavaScript 库，因此函数和变量（函数内部的私有变量除外）必须以服务名称开头以避免冲突，例如“guestbook_message”。

简而言之：在我看来，英文、小写、组织良好的变量和函数名称更可取。名称应该描述它们的存在而不是简短。

# wpf - 不能在 WPF 项目中使用“this”关键字或某些对象（需要标识符）

> ID：921134
> 
> 赞同：0
> 
> 时间：2009-05-28T14:28:37.337
> 
> 标签：wpf, visual-studio-2008

我有一个 WPF 项目。当我添加一个类和一个方法并写“this.”时，我没有智能感知。Visual Studio 的底部选项卡中有一条消息，提示需要标识符，但这没有意义。

此外，我无法访问某些方法/对象。举个例子：

```
 DbProviderFactory factory =      DbProviderFactories.GetFactory("System.Data.OleDb"); 
```

当我尝试访问变量时，没有出现智能感知（得到关于标识符的相同消息）。

有谁知道这是为什么？更糟糕的是，我也有这个问题：[http ://social.msdn.microsoft.com/Forums/en-US/vswpfdesigner/thread/701934bc-5237-40df-aa54-f768debf4e59](http://social.msdn.microsoft.com/Forums/en-US/vswpfdesigner/thread/701934bc-5237-40df-aa54-f768debf4e59)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T14:35:30.880

您是否尝试过重新启动 Visual Studio，我发现它的智能感知存在这样的问题。如果您继续使用该实例，它是否可以编译，如果是这样，可能只需要重新启动应用程序。

如果类是静态的，则使用“this”，this 标识符将不起作用。

我刚刚在我的 VS2008 实例中输入了您的确切代码，我得到了智能感知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:36:24.793

你的类或方法是静态的吗？如果是这样，您将无法使用“this”关键字调用任何实例成员或属性。如果要在静态方法中使用成员或属性，它们也必须是静态的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T14:39:18.890

根据我的经验，当您编写的类的代码无法编译时，Intellisense 经常会失败。因此，原因可能是不同代码行中的语法错误或缺少项目引用或 using 语句。

我无法为您提供的错误链接提供帮助。由于这肯定意味着 WPF 表单无法编译，因此 Intellisense 无法正常工作。

# html - 将 XSD 转换为 HTML 的免费工具

> ID：921135
> 
> 赞同：3
> 
> 时间：2009-05-28T14:28:38.163
> 
> 标签：html, xsd

有没有好的免费软件工具可以帮助我将 XSD 转换为 HTML？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-07-07T14:55:18.253

这不是一种完全自动化的方法，而是： 在 Internet Explorer 中使用 XSL 打开任何 XML 文件，然后查看源代码。源代码将采用 HTML 格式。其他浏览器只会在您查看源代码时返回 XML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:34:01.303

您可以使用 XSL 将您的 XSD 转换为 (X)HTML。[例如，此](http://serprest.pt/ws/xsd2forms/xsl/simple.xsl)样式表从 XSD 创建 HTML 表单。但这实际上取决于您到底想做什么。

# database - 是否推荐在 Oracle 表空间中使用统一的扩展区大小？

> ID：921136
> 
> 赞同：4
> 
> 时间：2009-05-28T14:28:44.997
> 
> 标签：database, oracle, oracle10g

自从 Oracle 8i 发布以来，我一直在使用 Oracle。那时我是数据库的新手，并且被告知在定义表空间时最好使用恒定大小的范围大小。

从我所读到的，似乎今天使用 10/11g，Oracle 可以自动为您管理这些数据块大小，并且它可能无法保持数据块大小不变。我可以很容易地看到这如何更有效地使用磁盘空间，但这是它们的缺点。我想也许是时候在这件事上放下过去了。（假设我过去的教学首先是正确的）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T16:54:23.050

是的，除了非常不寻常的情况，是时候放下过去并使用新的 Oracle 范围管理功能了。使用本地管理的表空间 (LMT) 和自动范围大小调整，您不必再考虑这些东西。

作为一名 DBA，可变区大小一开始让我很担心，因为在 7.3 天里，我花了很多时间重组表空间，以消除由非零百分比增加的区分配导致的碎片。（并且您需要非零百分比增加，因为根据创建数据库时使用的数据库块大小，您的最大范围数被限制在不同级别）但是，Oracle 使用一种算法来确定范围大小增加的速率和幅度有效消除碎片。

此外，忘记您听说过的关于如何使表或索引适合单个数据块的最佳配置，或者您可以通过扩展数据块配置以某种方式管理 i/o 的任何事情——这从来都不是真的。在字典管理的表空间时代，在字典表中管理数千个扩展区可能会受到一些惩罚，但 LMT 使用位图，这不是问题。Oracle 缓冲块，而不是段扩展。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T14:50:30.320

如果您有无限的磁盘空间和即时访问时间，那么您根本不必关心范围。

您只需制作每张表`INITIAL 100T NEXT 100T MAXEXTENTS UNLIMITED PCTINCREASE 0`，而忘记明年的范围`300`。

当您的磁盘空间不是无限的*或*访问时间不同时，就会出现问题。

Extents 是为了应对数据稀疏性：当你的数据是碎片化的时候，你就会有`HDD`头从一个地方跳到另一个地方，这需要时间。

理想的情况是让每个表的所有数据都驻留在一个区段中，而将最常连接的表的数据驻留在下一个区段中，因此可以按顺序读取所有内容。

请注意，访问时间还包括确定数据所在位置所需的访问时间。如果您的数据非常稀疏，则需要额外查找范围字典。

如今，磁盘空间不再重要，而访问时间仍然很重要。

这就是`Oracle`创建范围管理的原因。

就使用的空间而言，这比手工制作的范围布局效率低，但在访问时间方面效率更高。

因此，如果您有足够的磁盘空间（即您的数据库将占用不到一半的磁盘空间数`5`年），那么只需使用自动扩展。

# iphone - 负数的 iPhone 键盘布局？

> ID：921138
> 
> 赞同：6
> 
> 时间：2009-05-28T14:28:49.020
> 
> 标签：iphone, keyboard-layout

我的用户需要输入纬度和经度，当然我需要验证输入的值是合法的纬度/经度值。我想要一个键盘布局，可以为我做一些事情（消除字母字符、标点符号等，只留下数字和 +/-）。数字键盘似乎没有这样做（缺少 +/-），SDK 附带的任何其他键盘布局也没有。有谁知道是否有一种方法可以在不使用我自己的键盘输入法和越狱手机的情况下提供这种功能？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-02-01T00:46:14.187

我知道这是答案太晚了，但这个话题仍然与我有关。因此，我希望以下内容对遇到此页面的人有所帮助。

Bryan S. Gruver 发布了一个完整的 Xcode 项目，lambdabunny 可以稍微修改它以实现他们的目标。你可以在这里找到它：http: [//brygruver.squarespace.com/blog/2009/10/1/creating-a-custom-number-pad.html](http://brygruver.squarespace.com/blog/2009/10/1/creating-a-custom-number-pad.html)

**更新** Squarespace 链接现已断开。另一种选择是： [https ://github.com/lnafziger/Numberpad](https://github.com/lnafziger/Numberpad)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T21:57:18.773

如何在 UITextView 旁边放置一个“+/-”按钮来切换输入文本的符号？或者出现在左侧的“+”按钮，每次点击它时，按钮标签都会从“+”切换到“-”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T14:37:55.117

你不必越狱。如果您创建一个视图来模拟键盘，那么您仍然遵循 SDK 规则。

# asp.net - 在服务器上运行的 jquery 和 html 元素

> ID：921144
> 
> 赞同：1
> 
> 时间：2009-05-28T14:30:33.917
> 
> 标签：asp.net, jquery

我有一个包含在用户控件（标题）中的元素。这个 div 包括里面的子 div。其中之一包括用户选项。用户选项 div () 显示登录用户的用户名，以及与已登录用户相关的几个链接，例如注销、设置等。“user_options”div 绝对位于“header”div 中。

现在，在登录页面本身，我想隐藏这个 div，因为用户被带到那里，因为她/他没有登录。在这种情况下，我将 runat="server" 属性添加到“user_options” div 和我在.aspx页面的page_load事件中携带check in，看是不是用户登录如下；

```
if check_user_loggedin() then
  user_options.attributes("style") = "display:none;"
  ' also tried this with user_options.visible = false and 
else
  user_options.attributes("style") = "display:block;" 
  ' in this one, I even tried the whole positioning css e.g. display:block; positon:absolute; left:100px; etc...
end if 
```

现在有了这段代码，当我运行项目时，它在我不想显示 div 的地方工作正常 - 它被成功隐藏。但是在我需要显示 div 的那些页面中，它仍然显示在页面的最左上角，并且其中其他“div”元素的 jquery click 事件也不起作用。

我认为它与执行顺序或页面事件周期有关，但您能建议任何解决方法吗？

========= 编辑 =========================
这是 CSS：

```
 #user_options
    {
        position:absolute;
        top:18px;
        right:10px;
        width:200px;
        color:#ffffff;
        text-align:right;
    } 
```

这是 HTML：

```
<div id="user_options" **runat="server"**>
    <strong><a class="whiteLink" href="#"><%=MyNamespace.Users.getUsernameFromCookie%></a></strong> | <a class="whiteLink" href="usr_logout.aspx">logout</a> | <a class="whiteLink" href="#">settings</a> | <a class="whiteLink" href="#">help</a>
</div> 
```

这是用户控制中的代码：

```
Private _displayUserOptions As Boolean
Public Property displayUserOptions() As Boolean
    Get
        Return _displayUserOptions
    End Get
    Set(ByVal value As Boolean)
        _displayUserOptions = value
    End Set
End Property

Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    If displayUserOptions Then
        user_options.Attributes("style") = "display:none;"
    Else
        user_options.Attributes("style") = "display:block;"
    End If
End Sub 
```

这就是我在 HTML 页面中调用以显示用户控件的内容

```
<uc1:x_layout_top ID="x_layout_top1" runat="server" displayUserOptions="false" /> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-29T14:52:49.380

在我们使用 ASP.NET 4.0 和 ClientIdMode="Static" 之前，我建议使用唯一的类名来解决这个问题。

```
<div id="user_options" runat="server" class="user_options">.... 
```

因为那时你可以 a) 使用后面的代码来访问`user_options`，然后使用 jQuery 和 CSS 来访问**`.user_options`**，而不是**`#user_options`**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T14:40:52.897

您的问题可能源于嵌套命名容器。当您的用户控件放置在页面上并且 div 被赋予 runat="server" 属性时，它可能会将 div 命名为 ID="ctrl00_user_options" 之类的名称。

作为替代方案，如果您使用 Membership 提供程序框架，您可以使用 loginname 控件来控制是否显示用户名。否则，您可以在标记中执行类似的操作（假设有一个名为*user*的变量可用于页面：

```
<script type="text/javascript">
$(function() { if (user) { $("#<%= user_options.ClientID %>").hide();});
</script> 
```

# c# - 为什么这个继承的视图不渲染？

> ID：921152
> 
> 赞同：1
> 
> 时间：2009-05-28T14:32:01.870
> 
> 标签：c#, .net, asp.net-mvc

我尝试了以下方法：

我有一个包含这些文件的共享库 (.dll)：

*   意见
    *   搜索
        *   PowerSearch.aspx
        *   PowerSearch.aspx.cs
        *   PowerSearch.aspx.designer.cs

PowerSearch.aspx 文件包含我的 html 代码。PowerSearch.aspx.cs 文件包含以下内容：

```
using System.Web.Mvc;
using CommonProject.Web.Shared.Controllers;

namespace CommonProject.Web.Shared.Views.Search
{
    public partial class PowerSearch : ViewPage<SearchViewData>{}
} 
```

和设计师我catually 甚至不关心因为它没有被使用反正。

没有什么花哨的，只是一个强类型的视图。
我基本上从我的 asp.net mvc 项目中提取了一个现有的工作视图，将它放在一个单独的库中并更改名称空间以包含“共享”一词，如“这将在多个 mvc 项目之间共享”。

然后在我原来的 asp.net mvc 项目中，我创建了相同的结构，只是现在 aspx 页面只包含 asp @Page 规则。

匹配的 cs 文件包含：

```
using System.Web.Mvc;
using CommonProject.Web.Shared.Controllers;

namespace CommonProject.Web.DRE.Views.Search
{
    public partial class PowerSearch : CommonProject.Web.Shared.Views.Search.PowerSearch { }
} 
```

没有编译错误，也没有运行时异常。只有一个巨大的空白页...

有人有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T14:40:04.613

确保程序集 (dll) 在您引用的 bin 文件夹中。还可以尝试将程序集命名空间添加到您的 web.config 中，否则您的视图将无法找到继承的页面。

```
<页面>
      <命名空间>
        <add namespace="CommonProject.Web.Shared"/>

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T19:09:29.267

.aspx 文件的源代码是什么样的？确保您在 page 指令中继承您的视图，如下所示：

```
<%@ Page Title="" Inherits="CommonProject.Web.Shared.Views.Search.PowerSearch" %&> 
```

此外，如果您不想在页面指令中指定整个命名空间，可以将其添加到 web.config 中的 <namespaces /> 部分：

```
<add namespace="CommonProject.Web.Shared.Views.Search"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T18:39:55.177

尝试将 ASPX 页面添加到类库中有多少困难？！当您选择“添加新项目...”时，它不在默认列表中。

我知道将控制器和模型存储在单独的库 DLL/程序集中是可以的，但我很确定存储或共享视图并不是那么简单。问题是默认视图引擎正在磁盘上的特定文件夹中查找视图（~/Views/Controller/ViewName.as[pc]x 或 ~/Views/Shared/ViewName.as[pc]x）。使用库 DLL，编译器实际上并不知道它可以对您的 ASPX 文件做什么。它不是代码，所以除非您设置了“构建操作”，否则它只会忽略它。有各种“内置操作”，但我认为您唯一的选择是“复制”和“作为资源嵌入”。Copy 不会复制到您需要的文件夹（ASP.NET MVC Web 项目中的 Views 文件夹），为您做到了（需要做一些工作）。

Hammett（Castle Monorail）的名声（现在是一名 MS 员工）提出了一个示例，该示例允许您使用自定义 VirtualPathProvider 类将视图存储在库程序集中，该类能够挖掘 DLL 并拉出视图（嵌入为资源）。示例应用程序现在只是一个概念，因此您可能会遇到一些障碍，但它似乎可以工作并且看起来是一个令人兴奋的方向。您可以在他的博客上找到它：[MEF 和 ASP.NET MVC 示例](http://blogs.msdn.com/hammett/archive/2009/04/23/mef-and-asp-net-mvc-sample.aspx)。下载代码并进行一些探索。

这篇博客文章[ASP.NET MVC Plugins](http://www.wynia.org/wordpress/2008/12/05/aspnet-mvc-plugins/)与上述作者不同，但它对主题进行了另一次检查，并指向 StackOverflow 上的另一篇文章，其中提出了类似的问题：[Using VirtualPathProvider to load ASP.NET MVC来自 DLL 的视图](https://stackoverflow.com/questions/236972/using-virtualpathprovider-to-load-aspnet-mvc-views-from-dlls)。

我看过Phil Haaaaaaaaaaaaaaaaaack 的一篇关于在数据库中存储视图的帖子。它使用 Ruby 脚本而不是 Web 表单，所以我不能 100% 确定您是否可以调整他的示例以满足您的需求。在此处查看：为[存储在数据库中的 ASP.NET MVC 视图编写脚本](http://haacked.com/archive/2009/04/22/scripted-db-views.aspx)。

# silverlight - Silverlight TreeView 检测节点扩展

> ID：921155
> 
> 赞同：1
> 
> 时间：2009-05-28T14:32:35.707
> 
> 标签：silverlight, treeview

我一定遗漏了一些明显的东西 - 我如何检测何时在 Silverlight TreeView 中展开节点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-20T07:19:31.247

此外，treeviewitems 有一个我目前正在使用的扩展事件，但您必须附加到您添加的每个节点。

```
AddHandler t.Expanded, AddressOf TreeViewItem_Expanded 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T11:42:49.807

不幸的是，“SelectedItemChanged”还不是一个路由事件。所以你能得到的最接近的是使用这个：

```
treeView.AddHandler(TreeView.MouseLeftButtonUpEvent, new MouseButtonEventHandler(OnMouseLeftButtonUp), true);

    void OnMouseLeftButtonUp(object sender, MouseButtonEventArgs e)
    {
        if (e.OriginalSource is Path)
        {
            Path p = e.OriginalSource as Path;
            if (p.Name == "CheckedVisual" || p.Name == "UncheckedVisual")
            {
            }
        }
    } 
```

# windows - Windows 中的 CD 弹出通知

> ID：921156
> 
> 赞同：2
> 
> 时间：2009-05-28T14:32:38.623
> 
> 标签：windows

我的程序需要知道用户何时弹出 cd 光盘。在 Windows 中是否有某种通知？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T14:57:41.897

对于非 .NET 语言，为 WM_DEVICECHANGE 消息添加消息处理程序并检查 DBT_DEVICEREMOVECOMPLETE 的 WPARAM。LPARAM 指向一个 DEV_BROADCAST_HDR 结构；它的 dbch_devicetype 成员给出了设备类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T14:43:03.330

这是一些 VB 代码，向您展示了它是如何完成的。

```
Shared Sub Main(ByVal args() As String)
        Dim we As New WMIEvent
        Dim w As ManagementEventWatcher = Nothing
        Dim q As WqlEventQuery
        Dim observer As New ManagementOperationObserver

        ' Bind to local machine
        Dim opt As New ConnectionOptions
        opt.EnablePrivileges = True 'sets required privilege
        Dim scope As New ManagementScope("root\CIMV2", opt)

        Try
            q = New WqlEventQuery
            q.EventClassName = "__InstanceModificationEvent"
            q.WithinInterval = New TimeSpan(0, 0, 1)

            ' DriveType - 5: CDROM
            q.Condition = "TargetInstance ISA 'Win32_LogicalDisk'" & _
                " and TargetInstance.DriveType = 5"
            w = New ManagementEventWatcher(scope, q)

            ' register async. event handler
            AddHandler w.EventArrived, AddressOf we.CDREventArrived
            w.Start()

            ' Do something usefull,block thread for testing
            Console.ReadLine()
        Catch e As Exception
            Console.WriteLine(e.Message)
        Finally
            w.Stop()
        End Try

    End Sub 'Main

    ' Dump all properties
    Public Sub CDREventArrived(ByVal sender As Object, ByVal e As EventArrivedEventArgs)
        ' Get the Event object and display it
        Dim pd As PropertyData = e.NewEvent.Properties("TargetInstance")

        If Not (pd Is Nothing) Then
            Dim mbo As ManagementBaseObject = pd.Value '

            ' if CD removed VolumeName == null
            If Not (mbo.Properties("VolumeName").Value Is Nothing) Then
                Console.WriteLine("CD has been inserted")
            Else
                Console.WriteLine("CD has been ejected")
            End If
        End If

    End Sub 'CDREventArrived 
```

# javascript - 删除禁用表单字段的禁用属性 onClick

> ID：921161
> 
> 赞同：12
> 
> 时间：2009-05-28T14:33:19.057
> 
> 标签：javascript

我有一个表单域，它一开始是禁用的，并且有一个 onClick 来启用它。onClick 不会触发（至少在 FF 中），简单的 alert(1); 也不会触发。

hacky 版本是在其“看起来”被禁用（灰色样式）和 onClick 的位置显示一个虚假的表单字段，隐藏它并显示启用的正确字段，但这很难看。

**示例代码**

这有效：

```
<input type="text" id="date_end" value="blah" onClick="this.disabled=true;"> 
```

这有效：

```
<label for="date_end_off" onClick="document.getElementById('date_end').disabled=false">Test</label>
<input type="text" id="date_end" value="blah" onClick="alert(1);" disabled> 
```

这失败了：

```
<input type="text" id="date_end" value="blah" onClick="alert(1);" disabled> 
```

这失败了：

```
<input type="text" id="date_end" value="blah" onClick="document.getElementById('date_end').disabled=false" disabled> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-29T06:59:49.880

我在另一个论坛上遇到了这个帖子，所以我想我必须以不同的方式去做。

[http://www.webdeveloper.com/forum/showthread.php?t=186057](http://www.webdeveloper.com/forum/showthread.php?t=186057)

> Firefox，也许还有其他浏览器，禁用表单字段上的 DOM 事件。从禁用的表单字段开始的任何事件都将被完全取消，并且不会向上传播 DOM 树。如果我错了，请纠正我，但是如果您单击禁用的按钮，则事件的来源是禁用的按钮，并且单击事件完全消失了。浏览器实际上不知道按钮被点击，也不会传递点击事件。就好像你在点击网页上的一个黑洞。

**解决方法：**

1.  设置日期字段的样式，使其看起来好像已禁用。
2.  制作一个带有位值的隐藏“use_date”表单字段，以确定在处理过程中是否使用日期字段。
3.  向日期字段的 onClick 添加新功能，这将更改样式类以显示为启用并将“use_date”值设置为 1。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-03T16:25:10.907

使用`readonly`代替`disabled`

至少对于复选框，这使它们*看起来*被禁用但行为正常（在 Google Chrome 上测试）。您必须抓住点击并酌情阻止事件的默认操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-29T12:41:57.573

使用 jQuery，我将一个事件处理程序附加到我的输入控件的父级。

```
<script type="text/javascript">
    $(function() {
        // disable all the input boxes
        $(".input").attr("disabled", true);

        // add handler to re-enable input boxes on click
        $("td:has(.input)").click(function() {
            $(".input", this).removeAttr("disabled");
        });
    });
</script> 
```

我所有的输入控件都有“输入”类，它们存在于自己的表格单元格中。如果您至少将输入标签包装在一个 div 中，那么这也应该在没有表格的情况下工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-11-05T13:34:17.900

引用[Quirksmode.org](http://www.quirksmode.org/dom/events/click.html)：

*“禁用的表单字段上的单击事件不会在 Firefox 和 Safari 中触发事件。Opera 会触发 mousedown 和 mouseup 事件，但不会触发 click 事件。IE 会触发表单上的 mousedown 和 mouseup，但不会单击。所有这些实现都是认为是正确的。”*

Quirksmode 的兼容性表非常适合查找有关此类问题的更多信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-03T10:42:33.940

我最近遇到了一个非常类似的问题，并通过将输入放在 div 中并将 onClick 移动到 div 来解决它。

```
<div onClick="myEnableFunction('date_end');">
<input type="text" id="date_end" value="blah" disabled>
</div> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T14:47:03.990

不要在输入字段的 onClick 的值中实现 onClick 事件的逻辑。这可能就是为什么它在 Firefox 中不起作用的原因。而是将函数定义为 onClick 的值。例如：

```
<input type="text" id="date_end" value="blah" onClick="doSomething()" disabled>

<script type="text/javascript">
  function doSomething()
  {
    alert("button pressed");
  }
</script> 
```

JQuery 也值得研究。您可以使用它来添加或删除元素和其他各种东西的属性。例如，您可以通过编写如下函数从输入字段中删除禁用：

```
<script type="text/javascript">
      function doSomething()
      {
        alert("button pressed");
         $("#date_end").removeAttr('disabled'); //removes the disabled attribut from the  
                                                //element whose id is 'date_end'
      }
</script> 
```

或者您可以按如下方式添加它：

```
$("#date_end").attr('disabled','true'); 
```

Jquery 网站在[这里](http://jquery.com/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-03-12T19:33:52.243

If you simply want to prevent the user from typing data in your field, but instead want the field to `populate` on an event, my hack solution was to not disable the input field at all, but instead after running my `onclick` or `onfocus` functions, to call `blur()` so the user can not edit the field.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-09T11:57:06.730

In order to enable a disabled element on the client side, lets say in response to a checkbox checked or something, I ended up having to use a combination of JS and jQuery, see below:

```
//enable the yes & no RB 
function enable()
{
        var RBNo = "rbnBusinessType";
        var RBYes = "rbnBusinessType";

        //jQuery approach to remove disabled from containing spans            
        $("#" + RBYes).parent().removeAttr('disabled');
        $("#" + RBNo).parent().removeAttr('disabled');

        //enable yes and no RBs
        document.getElementById(RBYes).disabled = false;
        document.getElementById(RBNo).disabled = false;               

} 
```

After postback then, you'll need to access the request like the following in order to get at the values of your client side enabled elements:

this._Organization.BusinessTypeHUbZoneSmall = Request.Params["rbnBusinessTypeHUbZoneSmall"] == rbnBusinessTypeHUbZoneSmallYes.ID;

Inspiration taken from: [https://stackoverflow.com/questions/6995738/asp-javascript-radiobutton-enable-disable-not-included-in-postback-ajax for more information](https://stackoverflow.com/questions/6995738/asp-javascript-radiobutton-enable-disable-not-included-in-postback-ajax%20for%20more%20information)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-09-08T12:31:59.707

您可以在禁用的输入上添加一个 div：检查一下

```
 <div onclick="javascript:document.forma.demo1.disabled=false;" style="border:0px solid black; padding:00px;">
    <input type=text name="demo1" disabled style="width:30;">
  </div> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-28T14:37:29.330

在点击时启用禁用元素会破坏禁用的目的，你不觉得吗？如果您真的想要您描述的行为，只需将其设置为“禁用”并在单击时删除这些样式。

# vb.net - 将 LINQ 与快速版本的 Visual Studio 一起使用

> ID：921167
> 
> 赞同：2
> 
> 时间：2009-05-28T14:35:00.817
> 
> 标签：vb.net, visual-studio, visual-studio-2008

是否可以在 Visual Studio 的快速版本中使用 LINQ？我计划重构我的项目以使用 LINQ，但我是团队中唯一拥有 Visual Studio Pro 副本的人。如果有人使用 express 版本必须修改我的代码，这会导致任何问题吗？

**编辑** 我意识到图形工具在快速版本中不可用，所以我的问题与这些无关。我对实际代码更感兴趣，我认为它会起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T14:38:15.117

是的，它会起作用。

从[Visual C# Express 2008 页面](http://www.microsoft.com/express/vcsharp/)：

> 使用 LINQ（语言集成查询）构建应用程序，它将 SQL Server、XML 和对象的数据查询功能添加到 Visual C#

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:57:52.347

我在 VB Express 2008 页面上找到了相同的信息

[http://www.microsoft.com/express/vb/Default.aspx](http://www.microsoft.com/express/vb/Default.aspx)

> 使用 LINQ（语言集成查询）构建应用程序，它将 SQL Server、XML 和对象的数据查询功能添加到 Visual Basic

# javascript - 如何在javascript中构建关系结构？

> ID：921173
> 
> 赞同：1
> 
> 时间：2009-05-28T14:35:58.227
> 
> 标签：javascript, oop, relational

我在数据库中有 2 个表：

1-元素：

*   元素ID
*   元素名称

2- 方法：

*   方法ID
*   元素ID
*   方法数据

所以元素和方法之间是一对多的关系，

我使用 asp.net 加载这些表数据，

我想要做的是将这些数据发送到我的 javascript，而 javascript 将对这些数据执行一些功能。

例如，将遍历所有元素并获取每个元素方法并对每个方法数据做一些事情。

我试图将其作为 jaascript 中的类，但发现我自己写了很多东西，

前 2 个类，用于元素和方法，然后是 2 个数组 1- 用于元素 2- 用于方法

在方法数组中我写了这个：

```
this.findByElementId = function(elementId) {
    var result = [];
    for (var i = 0; i < this.methods.length; i++) {
        if (elementId === this.methods[i].methodElement) {
            result.push(this.methods[i]);
        }
    }
    return result;
} 
```

这使我的代码变慢了。

我的问题是如何在 javascript 中表示这种关系结构以获得更专业的代码和更快的处理速度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T14:46:25.617

我自己从未尝试过这些东西，但是人们已经为 JavaScript 编写了 LINQ 式库，例如[JSINQ](http://www.codeplex.com/jsinq)。（该页面还链接到页面底部的更多 JS LINQ 库。）

它声称您可以“针对 JavaScript 数组、DOM 节点列表或您自己的可枚举类型编写任意复杂的查询”，这听起来就像您想要的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T16:40:25.497

```
function Element() {
this.id;
this.type;
this.methods = new Array(); 
```

}

```
function Method() {
    this.id;
    this.methodType;
    this.methodData;
    this.methodElement;
    this.methodRank;
} 
```

# c# - 如何确保整数的除法总是四舍五入？

> ID：921180
> 
> 赞同：250
> 
> 时间：2009-05-28T14:37:42.293
> 
> 标签：c#, math

我想确保在必要时总是将整数除法四舍五入。还有比这更好的方法吗？有很多铸造正在进行。:-)

```
(int)Math.Ceiling((double)myInt1 / myInt2) 
```

* * *

## 回答 #1

> 赞同：680
> 
> 时间：2009-05-29T16:06:18.587

更新：这个问题是[我 2013 年 1 月博客的主题](http://ericlippert.com/2013/01/28/integer-division-that-rounds-up)。谢谢你的好问题！

* * *

使整数算术正确是困难的。正如迄今为止充分证明的那样，当你尝试做一个“聪明”的把戏时，你犯错的可能性很大。而且当发现缺陷时，更改代码来修复缺陷*而不考虑修复是否破坏了其他东西*并不是一个好的解决问题的技术。到目前为止，我认为针对这个完全不特别困难的问题发布了五种不同的不正确整数算术解决方案。

处理整数算术问题的正确方法——即增加第一次得到正确答案的可能性的方法——是仔细处理问题，一步一步解决，并使用良好的工程原理来做所以。

**首先阅读您要替换的规范。**整数除法的规范明确指出：

1.  除法将结果四舍五入为零

2.  当两个操作数具有相同符号时结果为零或正，当两个操作数具有相反符号时结果为零或负

3.  如果左操作数是可表示的最小 int，而右操作数是 –1，则会发生溢出。[...] 是否抛出 [an ArithmeticException] 或溢出未报告，结果值是左操作数的值，是实现定义的。

4.  如果右操作数的值为零，则抛出 System.DivideByZeroException。

我们想要的是一个整数除法函数，它计算商但*总是向上舍*入，而不是*总是向零舍*入。

**所以为那个函数写一个规范。**我们的函数`int DivRoundUp(int dividend, int divisor)`必须为每个可能的输入定义行为。这种未定义的行为令人深感担忧，所以让我们消除它。我们会说我们的操作有这个规范：

1.  如果除数为零，则操作抛出

2.  如果除数为 int.minval 且除数为 -1，则操作抛出

3.  如果没有余数——除法是“偶数”——则返回值是整数商

4.  否则返回*大于商的**最小*整数，也就是说，它总是向上取整。

 *现在我们有了一个规范，所以我们知道我们可以提出一个**可测试的设计**。假设我们添加了一个额外的设计标准，即仅使用整数算术来解决问题，而不是将商计算为双精度数，因为“双精度”解决方案已在问题陈述中明确拒绝。

那么我们必须计算什么？显然，为了满足我们的规范，同时只保留整数算术，我们需要知道三个事实。首先，整数商是多少？第二，除法没有余数吗？第三，如果不是，整数商是向上还是向下舍入计算的？

现在我们有了规范和设计，我们可以开始编写代码了。

```
public static int DivRoundUp(int dividend, int divisor)
{
  if (divisor == 0 ) throw ...
  if (divisor == -1 && dividend == Int32.MinValue) throw ...
  int roundedTowardsZeroQuotient = dividend / divisor;
  bool dividedEvenly = (dividend % divisor) == 0;
  if (dividedEvenly) 
    return roundedTowardsZeroQuotient;

  // At this point we know that divisor was not zero 
  // (because we would have thrown) and we know that 
  // dividend was not zero (because there would have been no remainder)
  // Therefore both are non-zero.  Either they are of the same sign, 
  // or opposite signs. If they're of opposite sign then we rounded 
  // UP towards zero so we're done. If they're of the same sign then 
  // we rounded DOWN towards zero, so we need to add one.

  bool wasRoundedDown = ((divisor > 0) == (dividend > 0));
  if (wasRoundedDown) 
    return roundedTowardsZeroQuotient + 1;
  else
    return roundedTowardsZeroQuotient;
} 
```

这聪明吗？不，漂亮吗？不，短？不。根据规范正确吗？*我相信是这样，但我还没有完全测试过。*不过看起来还不错。

我们是这里的专业人士；使用良好的工程实践。研究您的工具，指定所需的行为，首先考虑错误情况，然后**编写代码以强调其明显的正确性。**当您发现错误时，请考虑您的算法是否存在严重缺陷，然后再随机开始交换比较方向并破坏已经有效的东西。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2010-11-13T22:51:11.737

到目前为止，这里的所有答案似乎都过于复杂。

在 C# 和 Java 中，对于正除数和除数，您只需执行以下操作：

```
( dividend + divisor - 1 ) / divisor 
```

资料来源：[数字转换，Roland Backhouse，2001](http://www.cs.nott.ac.uk/~rcb/G51MPC/slides/NumberLogic.pdf)

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2009-05-29T02:32:45.377

## 基于 int 的最终答案

对于有符号整数：

```
int div = a / b;
if (((a ^ b) >= 0) && (a % b != 0))
    div++; 
```

对于无符号整数：

```
int div = a / b;
if (a % b != 0)
    div++; 
```

## 这个答案的理由

整数除法 ' `/`' 被定义为向零舍入（规范的 7.7.2），但我们想要四舍五入。这意味着否定答案已经正确四舍五入，但需要调整肯定答案。

非零肯定答案很容易检测到，但答案零有点棘手，因为它可以是负值的四舍五入或正值的四舍五入。

最安全的选择是通过检查两个整数的符号是​​否相同来检测答案何时应该是肯定的。在这种情况下，两个值的整数 xor 运算符 ' `^`' 将产生 0 符号位，这意味着非负结果，因此检查`(a ^ b) >= 0`确定结果在舍入之前应该是正数。另请注意，对于无符号整数，每个答案显然都是肯定的，因此可以省略此检查。

剩下的唯一检查是是否发生了任何舍入，这`a % b != 0`将完成这项工作。

## 得到教训

算术（整数或其他）并不像看起来那么简单。任何时候都需要仔细思考。

此外，虽然我的最终答案可能不像浮点答案那样“简单”或“明显”甚至可能“快速”，但它对我来说具有很强的救赎品质；我现在已经对答案进行了推理，所以我实际上确定它是正确的（直到有更聪明的人告诉我不然——*偷偷地瞥了一眼埃里克的方向*——）。

为了对浮点答案有同样的确定感，我必须做更多（并且可能更复杂）考虑是否存在浮点精度可能会妨碍的任何条件，以及是否`Math.Ceiling`可能在“恰到好处”的输入上出现了一些不受欢迎的东西。

## 走过的路

替换（注意我用 替换了第二个`myInt1`，`myInt2`假设这就是你的意思）：

```
(int)Math.Ceiling((double)myInt1 / myInt2) 
```

和：

```
(myInt1 - 1 + myInt2) / myInt2 
```

唯一需要注意的是，如果`myInt1 - 1 + myInt2`溢出您正在使用的整数类型，您可能无法得到您期望的结果。

*这是错误的原因*：-1000000 和 3999 应该给出 -250，这给出 -249

**编辑：**
考虑到这与负值的其他整数解决方案具有相同的错误`myInt1`，因此执行以下操作可能更容易：

```
int rem;
int div = Math.DivRem(myInt1, myInt2, out rem);
if (rem > 0)
  div++; 
```

这应该在`div`仅使用整数运算时给出正确的结果。

*这是错误的原因*：-1 和 -5 应该给出 1，这给出 0

**编辑（再一次，带着感觉）：**
除法运算符向零舍入；对于阴性结果，这是完全正确的，因此只有非阴性结果需要调整。还考虑到无论如何`DivRem`只执行 a`/`和 a `%`，让我们跳过调用（并从简单的比较开始，以避免在不需要时进行模计算）：

```
int div = myInt1 / myInt2;
if ((div >= 0) && (myInt1 % myInt2 != 0))
    div++; 
```

*这是错误的原因*：-1 和 5 应该给出 0，这给出 1

（在我为最后一次尝试辩护时，当我的大脑告诉我我迟到了 2 小时睡觉时，我不应该尝试一个合理的答案）

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-05-28T14:50:12.957

使用扩展方法的绝佳机会：

```
public static class Int32Methods
{
    public static int DivideByAndRoundUp(this int number, int divideBy)
    {                        
        return (int)Math.Ceiling((float)number / (float)divideBy);
    }
} 
```

这也使您的代码具有超级可读性：

```
int result = myInt.DivideByAndRoundUp(4); 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-05-28T14:40:33.083

你可以写一个助手。

```
static int DivideRoundUp(int p1, int p2) {
  return (int)Math.Ceiling((double)p1 / p2);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T14:40:26.860

您可以使用以下内容。

```
a / b + ((Math.Sign(a) * Math.Sign(b) > 0) && (a % b != 0)) ? 1 : 0) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-30T06:05:33.557

对于有符号或无符号整数。

`q = x / y + !(((x < 0) != (y < 0)) || !(x % y));`

对于有符号的股息和无符号的除数。

`q = x / y + !((x < 0) || !(x % y));`

对于无符号股息和有符号除数。

`q = x / y + !((y < 0) || !(x % y));`

对于无符号整数。

`q = x / y + !!(x % y);`

零除数失败（与本机操作一样）。

不能溢出。

优雅而正确。

理解行为的关键是识别截断、下限和上限划分的差异。C#/C++ 在本机被截断。当商为负数时（即运算符符号不同），则截断是一个上限（负数较小）。否则截断是一个下限（不太积极）。

因此，如果有余数，如果结果为正，则加 1。模数是相同的，但您改为添加除数。地板是相同的，但你在相反的条件下减去。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-30T07:09:56.750

我认为你的意思是从零开始。没有任何铸件，使用该`Math.DivRem()`功能

```
/// <summary>
/// Divide a/b but always round up
/// </summary>
/// <param name="a">The numerator.</param>
/// <param name="b">The denominator.</param>
int DivRndUp(int a, int b)
{
    // remove sign
    int s = Math.Sign(a) * Math.Sign(b);
    a = Math.Abs(a);
    b = Math.Abs(b);
    var c = Math.DivRem(a, b, out int r);
    // if remainder >0 round up
    if (r > 0)
    {
        c++;
    }
    return s * c;
} 
```

如果综述意味着无论符号如何总是向上，那么

```
/// <summary>
/// Divide a/b but always round up
/// </summary>
/// <param name="a">The numerator.</param>
/// <param name="b">The denominator.</param>
int DivRndUp(int a, int b)
{
    // remove sign
    int s = Math.Sign(a) * Math.Sign(b);
    a = Math.Abs(a);
    b = Math.Abs(b);
    var c = Math.DivRem(a, b, out int r);
    // if remainder >0 round up
    if (r > 0)
    {
        c+=s;
    }
    return s * c;
} 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2019-11-03T20:25:52.243

上面的一些答案使用浮点数，这是低效的，真的没有必要。对于无符号整数，这是对 int1/int2 的有效答案：

```
(int1 == 0) ? 0 : (int1 - 1) / int2 + 1; 
```

对于已签名的整数，这将是不正确的

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2012-06-20T15:47:20.293

这里所有解决方案的问题是他们需要演员或他们有一个数字问题。转换为 float 或 double 始终是一种选择，但我们可以做得更好。

当您使用来自@jerryjvl 的答案代码时

```
int div = myInt1 / myInt2;
if ((div >= 0) && (myInt1 % myInt2 != 0))
    div++; 
```

存在舍入误差。1 / 5 会四舍五入，因为 1 % 5 != 0。但这是错误的，因为只有将 1 替换为 3 时才会进行四舍五入，因此结果为 0.6。当计算给我们的值大于或等于 0.5 时，我们需要找到一种方法进行四舍五入。上例中模运算符的结果范围为 0 到 myInt2-1。仅当余数大于除数的 50% 时才会进行舍入。所以调整后的代码是这样的：

```
int div = myInt1 / myInt2;
if (myInt1 % myInt2 >= myInt2 / 2)
    div++; 
```

当然我们在 myInt2 / 2 也有一个舍入问题，但是这个结果会给你一个比这个站点上其他的更好的舍入解决方案。

# c# - 使用 C# WinForms 突出显示选定的自定义控件

> ID：921181
> 
> 赞同：1
> 
> 时间：2009-05-28T14:37:52.810
> 
> 标签：c#, winforms, custom-controls, highlighting, selected

我创建了一个自定义控件（该控件用于拖放），我想将焦点和选定事件添加到控件。两者都需要在视觉上不同。所以我计划为这两个事件实现一个窗口样式。为了获得焦点，我使用 Paint 事件中的以下代码在控件周围绘制了一条实线和一条虚线。

```
 if (Image != null)
     {            
        if (ContainsFocus)
        {
           // Draw a dotted line inside the client rectangle
           Rectangle insideRectangle = ClientRectangle;
           insideRectangle.Inflate(-2, -2);
           insideRectangle.Width--;
           insideRectangle.Height--;
           Pen p = new Pen(Color.Black, 1);
           p.DashStyle = DashStyle.Dot;
           g.DrawRectangle(p, insideRectangle);

           // Draw a solid line on the edge of the client rectangle
           Rectangle outsideRectangle = ClientRectangle;
           outsideRectangle.Width--;
           outsideRectangle.Height--;               
           p.DashStyle = DashStyle.Solid;
           g.DrawRectangle(p, outsideRectangle);

           Color transparentLightBlue = Color.FromArgb(100, Color.LightBlue);
           Brush solidBrush = new SolidBrush(transparentLightBlue);
           g.FillRectangle(solidBrush, ClientRectangle);
        }            
     } 
```

对于 Focus 事件，我只想突出显示图像（类似于 Windows 资源管理器）。我的第一次尝试是添加以下代码。

```
Color transparentLightBlue = Color.FromArgb(100, Color.LightBlue);
Brush solidBrush = new SolidBrush(transparentLightBlue);
g.FillRectangle(solidBrush, ClientRectangle); 
```

这可以填充矩形，但是我只想突出显示图像本身而不是整个矩形。我有使用两个不同图像的想法，但是图像是提供给我的，我没有存储它们。

所以我的问题是：如何获得具有焦点突出显示的控件图像的最佳方法是什么？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-24T22:27:05.367

由于您的图像不透明，您可以用透明的高亮颜色覆盖它。类似的[东西](https://stackoverflow.com/questions/4503210/draw-semi-transparent-overlay-image-all-over-the-windows-form-having-some-contro)。

# wpf - WPF将整数转换为图像而无需数据库绑定

> ID：921184
> 
> 赞同：0
> 
> 时间：2009-05-28T14:38:04.213
> 
> 标签：wpf

使用以下代码，我从数据库中检索整数列表并将它们转换为标志图像

```
 <ComboBox Name="ComboBox1" ItemSource="{Binding Path=NumberList">
        <ComboBox.ItemTemplate>
            <DataTemplate>
                <Image Source="{Binding Path=Numbers, Converter={StaticResource myValueFlagConverter}}" />
            </DataTemplate>
        </ComboBox.ItemTemplate>
    </ComboBox> 
```

如果我想要一个值为 1 到 3 的 ComboBox 而不绑定到 DB 中的 NumberList，我将如何使用我的转换器使用下面的简单示例作为起点，或者绑定到本地数组或其他东西？

```
 <ComboBox Name="ComboBox2" >
        <ComboBoxItem>1</ComboBoxItem>
        <ComboBoxItem>2</ComboBoxItem>
        <ComboBoxItem>3</ComboBoxItem>
    </ComboBox> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T14:44:27.773

不知道我理解你想要做什么，但我想它可能是这样的：

ComboBox1.ItemSource = new List() { 1, 2, 3};

```
 <ComboBox Name="ComboBox1">
        <ComboBox.ItemTemplate>
            <DataTemplate>
                <Image Source="{Binding Converter={StaticResource myValueFlagConverter}}" />
            </DataTemplate>
        </ComboBox.ItemTemplate>
    </ComboBox> 
```

# wcf - WCF MSMQ 回调函数

> ID：921185
> 
> 赞同：3
> 
> 时间：2009-05-28T14:38:10.373
> 
> 标签：wcf, callback, msmq

我有一个使用 MSMQ 通过 WCF 将对象发送到另一个服务的系统。该服务可以很好地提取消息并对其进行处理。但我现在遇到的问题是我需要向调用系统发送响应。
例子：

1.  创建客户对象
2.  填充信息
3.  通过 MSMQ 使用 WCF 将消息发送到服务
4.  使用 Windows 服务从队列中提取消息
5.  在 windows 服务上调用 Customer.Insert() 方法
6.  我现在需要将新的客户 ID 发送回此处的调用应用程序。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T15:09:09.190

正如 Emmanuel 指出的那样——MSMQ 消息是设计为单向的，实际上没有响应。

您最好的解决方案是有一个响应队列，“其他服务”可以将他的响应消息放入其中。然后，您的客户将不得不监视该队列，例如不时检查一次（每分钟，每 30 分钟 - 对您有意义的任何事情），并处理这些消息。

没有双工（双向）MSMQ 通道 - 但您可以轻松地为两个方向创建一对单独的队列。

马克

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-12T10:11:11.420

您可以使用 msmq 的双工通信，但不能使用本机通信，请查看[我的文章](http://www.codeproject.com/KB/WCF/duplexmsmq.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T15:00:10.067

MSMQ 操作需要一种方式，我能想到的接收消息的唯一方法是让您的调用应用程序也托管响应服务，因为没有双工 MSMQ 绑定。

# bash - 无法在 Zsh 中找到替代 Bash 的命令

> ID：921186
> 
> 赞同：3
> 
> 时间：2009-05-28T14:38:12.247
> 
> 标签：bash, zsh, tab-completion, git-completion

我把最新的 git-completion.bash 放到我的 .zshrc 中，我得到了

```
/Users/Masi/bin/shells/git/git-completion.bash:2116: command not found: complete
/Users/Masi/bin/shells/git/git-completion.bash:2118: command not found: complete 
```

线条是

```
 complete -o bashdefault -o default -o nospace -F _git git 2>/dev/null \
     || complete -o default -o nospace -F _git git 
 complete -o bashdefault -o default -o nospace -F _gitk gitk 2>/dev/null \
     || complete -o default -o nospace -F _gitk gitk 
```

**哪个命令可以替代 Bash 在 Zsh 中的完整功能？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T14:44:30.953

我确实认为这是一个问题，因为`complete`它是[内置的 Bash 命令](http://www.gnu.org/software/bash/manual/bashref.html#Programmable-Completion-Builtins)。它是 Bash 的可编程完成功能的一部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-26T19:59:33.837

Bash 和 Zsh 有不同的补全系统。使用带有 zsh 的 bash 完成功能可能是可能的，但只能通过兼容层。我建议你阅读`man zshcompsys`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-12T17:30:22.950

Git 的完成脚本也已更新为与 ZSH 一起使用。最新版本应该“正常工作”。

# sql - 如何加入存储过程？

> ID：921190
> 
> 赞同：55
> 
> 时间：2009-05-28T14:38:53.540
> 
> 标签：sql, sql-server-2005-express

我有一个不带参数的存储过程，它返回两个字段。存储过程汇总了应用于租户的所有事务，并返回余额和租户的 ID。

我想使用它通过查询返回的记录集，并且我需要将它的结果加入到租户的 id 中。

这是我当前的查询：

```
SELECT t.TenantName, t.CarPlateNumber, t.CarColor, t.Sex, t.SSNO, t.Phone, t.Memo,
        u.UnitNumber,
        p.PropertyName
FROM tblTenant t
    LEFT JOIN tblRentalUnit u
    ON t.UnitID = u.ID

    LEFT JOIN tblProperty p
    ON u.PropertyID = p.ID

ORDER BY p.PropertyName, t.CarPlateNumber 
```

存储过程是这样的：

```
SELECT tenant.ID AS TenantID, SUM(ISNULL(trans.Amount,0)) AS TenantBalance FROM tblTenant tenant
    LEFT JOIN tblTransaction trans
    ON tenant.ID = trans.TenantID
    GROUP BY tenant.ID 
```

我也想将存储过程中的余额添加到其中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-28T15:03:25.940

将 SP 的结果插入到临时表中，然后加入：

```
CREATE TABLE #Temp (
    TenantID int, 
    TenantBalance int
)

INSERT INTO #Temp
EXEC TheStoredProc

SELECT t.TenantName, t.CarPlateNumber, t.CarColor, t.Sex, t.SSNO, t.Phone, t.Memo,
    u.UnitNumber, p.PropertyName
FROM tblTenant t
INNER JOIN #Temp ON t.TenantID = #Temp.TenantID
... 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-05-28T14:55:45.487

我实际上喜欢上一个答案（不要使用 SP），但是如果您出于某种原因与 SP 本身相关联，则可以使用它来填充临时表，然后加入临时表。请注意，您将在那里花费一些额外的开销，但这是我能想到的使用实际存储过程的唯一方法。

同样，您最好将来自 SP 的查询内联到原始查询中。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-05-28T14:53:03.777

简短的回答是“你不能”。您需要做的是使用子查询，或者您可以将现有的存储过程转换为表函数。将其创建为函数将取决于您需要它的“可重用性”程度。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-28T15:43:54.297

您的存储过程可以很容易地用作视图。然后你可以将它加入到你需要的任何其他东西上。

SQL：

```
CREATE VIEW vwTenantBalance
AS

 SELECT tenant.ID AS TenantID, SUM(ISNULL(trans.Amount,0)) AS TenantBalance 
 FROM tblTenant tenant
 LEFT JOIN tblTransaction trans
 ON tenant.ID = trans.TenantID
 GROUP BY tenant.ID 
```

您可以执行任何声明，例如：

```
SELECT t.TenantName, t.CarPlateNumber, t.CarColor, t.Sex, t.SSNO, t.Phone, 
    t.Memo, u.UnitNumber, p.PropertyName, TenantBalance
FROM tblTenant t
LEFT JOIN tblRentalUnit u
 ON t.UnitID = u.ID
LEFT JOIN tblProperty p
 ON u.PropertyID = p.ID
LEFT JOIN vwTenantBalance v 
 ON t.ID = v.tenantID
ORDER BY p.PropertyName, t.CarPlateNumber 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-08-29T05:00:00.767

已经回答了，最好的解决方法是将存储过程转换为 SQL 函数或视图。

简短的回答是，您不能直接在 SQL 中加入存储过程，除非您使用存储过程的输出创建另一个存储过程或函数到临时表中并加入临时表。

我将通过将您的存储过程转换为 SQL 函数来回答这个问题，并向您展示如何在您选择的查询中使用它。

```
CREATE FUNCTION fnMyFunc()
RETURNS TABLE AS
RETURN 
(
  SELECT tenant.ID AS TenantID, 
       SUM(ISNULL(trans.Amount,0)) AS TenantBalance 
  FROM tblTenant tenant
    LEFT JOIN tblTransaction trans ON tenant.ID = trans.TenantID
  GROUP BY tenant.ID
) 
```

现在要在您的 SQL 中使用该函数...

```
SELECT t.TenantName, 
       t.CarPlateNumber, 
       t.CarColor, 
       t.Sex, 
       t.SSNO, 
       t.Phone, 
       t.Memo,
       u.UnitNumber,
       p.PropertyName
FROM tblTenant t
    LEFT JOIN tblRentalUnit u ON t.UnitID = u.ID
    LEFT JOIN tblProperty p ON u.PropertyID = p.ID
    LEFT JOIN dbo.fnMyFunc() AS a
         ON a.TenantID = t.TenantID
ORDER BY p.PropertyName, t.CarPlateNumber 
```

如果您希望从上述 SQL 中将参数传递给您的函数，那么我建议您使用`CROSS APPLY`or `CROSS OUTER APPLY`。

[在这里](https://stackoverflow.com/questions/1139160/when-should-i-use-cross-apply-over-inner-join)阅读。

干杯

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-08-09T10:30:39.583

我解决了编写函数而不是过程并在 SQL 语句中使用 CROSS APPLY 的问题。此解决方案适用于 SQL 2005 及更高版本。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-28T14:55:30.840

我希望你的存储过程没有做游标循环！

如果没有，请从您的存储过程中获取查询并将该查询集成到您在此处发布的查询中：

```
SELECT t.TenantName, t.CarPlateNumber, t.CarColor, t.Sex, t.SSNO, t.Phone, t.Memo,
        u.UnitNumber,
        p.PropertyName
        ,dt.TenantBalance
FROM tblTenant t
    LEFT JOIN tblRentalUnit u ON t.UnitID = u.ID
    LEFT JOIN tblProperty   p ON u.PropertyID = p.ID
    LEFT JOIN (SELECT ID, SUM(ISNULL(trans.Amount,0)) AS TenantBalance
                   FROM tblTransaction
                   GROUP BY tenant.ID
              ) dt ON t.ID=dt.ID
ORDER BY p.PropertyName, t.CarPlateNumber 
```

如果您在存储过程中执行的不仅仅是查询，请创建一个临时表并将存储过程执行到该临时表中，然后在查询中加入该表。

```
create procedure test_proc
as
  select 1 as x, 2 as y
  union select 3,4 
  union select 5,6 
  union select 7,8 
  union select 9,10
  return 0
go 

create table #testing
(
  value1   int
  ,value2  int
)

INSERT INTO #testing
exec test_proc

select
  *
  FROM #testing 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-10-10T01:38:42.570

这对你来说是个糟糕的主意。

使用别名，从您的服务器创建一个新的链接服务器到它自己的别名。

现在你可以这样做：

```
select a.SomeColumns, b.OtherColumns
from LocalDb.dbo.LocalTable a
inner join (select * from openquery([AliasToThisServer],'
exec LocalDb.dbo.LocalStoredProcedure
') ) b
on a.Id = b.Id 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-28T14:55:35.723

为什么不在你的 SQL 中执行计算呢？

```
SELECT 
  t.TenantName
  , t.CarPlateNumber
  , t.CarColor
  , t.Sex
  , t.SSNO
  , t.Phone
  , t.Memo
  , u.UnitNumber
  , p.PropertyName
  , trans.TenantBalance
FROM tblTenant t
     LEFT JOIN tblRentalUnit u ON t.UnitID = u.ID
     LEFT JOIN tblProperty p ON u.PropertyID = p.ID
     INNER JOIN (
       SELECT tenant.ID AS TenantID, SUM(ISNULL(trans.Amount,0)) AS TenantBalance 
       FROM tblTenant tenant
            LEFT JOIN tblTransaction trans ON tenant.ID = trans.TenantID
       GROUP BY tenant.ID
     ) trans ON trans.ID = t.ID
ORDER BY 
  p.PropertyName
  , t.CarPlateNumber 
```

# ajax - Google AJAX API 加载器返回 null

> ID：921196
> 
> 赞同：0
> 
> 时间：2009-05-28T14:39:51.073
> 
> 标签：ajax, api, loader

我们一直在使用谷歌 AJAX API 加载器（根据她的 IP 获取客户端的位置），如下所述：

code.google.com/apis/ajax/documentation/#ClientLocation

早些时候，当 API 加载器包含在任何文件中时
，它会使用有关客户端的数据填充 google.loader.ClientLocation 属性

但两天前我发现它返回null。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-15T10:44:57.127

嗯..我发现的原因是 API 无法解析我的 IP。我不知道为什么...我发现它可以与其他 IP 一起正常工作。

# javascript - 从 xhr 对象获取请求 url

> ID：921198
> 
> 赞同：46
> 
> 时间：2009-05-28T14:40:08.467
> 
> 标签：javascript

有没有办法从 xhr 对象中提取请求 url？我可以通过 channel 属性在 firebug 中看到 url，但你不能使用 javascript 来查询它。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2011-11-27T18:25:11.413

如果您使用的是 jQuery，您可以利用 AJAX 请求中的“beforeSend”函数来修改 jqXHR 对象。IE，

```
$.ajax({
...
url: "http://some/url",
beforeSend: function(jqxhr, settings) { jqxhr.requestURL = "http://some/url"; },
...
}); 
```

传递给各种回调的 jqXHR 对象将具有该变量 ，`jqXHR.requestURL`您可以访问该变量。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2014-11-04T00:31:52.783

使用以下 hack 不需要包装器：

```
var xhrProto = XMLHttpRequest.prototype,
    origOpen = xhrProto.open;

xhrProto.open = function (method, url) {
    this._url = url;
    return origOpen.apply(this, arguments);
}; 
```

用法：

```
var r = new XMLHttpRequest();
r.open('GET', '...', true);
alert(r._url); // opens an alert dialog with '...' 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-31T23:36:10.057

我希望我能正确理解你的问题。

用您自己的对象包装您的 XHR 对象以允许这种功能应该相当简单。

下面是一个过于简化的例子：

```
// Assumption: GetXHR() returns a new XHR object, cross browser.

function HTTPGet(url, onStartCb, onCompleteCb)
{
  var xhr = GetXHR();
  // Construct your own xhr object that contains the url and the xhr object itself.
  var myXhr = { xhr: xhr, url: url };

  xhr.onreadystatechange = function()
  {
     if (xhr.readyState == 4 && xhr.status == 200)
     {
        onCompleteCb(myXhr);
     }
  };

  xhr.open("GET", url);
  onStartCb(myXhr);
  xhr.send(null);
} 
```

我没有对此进行过广泛的测试，但它应该可以工作，并且通过一些修改（错误处理、传递参数等），您应该能够将此示例变成一个功能齐全的解决方案。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-28T14:59:06.103

根据[https://developer.mozilla.org/en/XmlHttpRequest](https://developer.mozilla.org/en/XmlHttpRequest)`channel` ，如果你有提升的权限，你确实可以得到；但是，`channel`它是非标准的（可能在其他浏览器中不起作用），并且确实[http://www.w3.org/TR/XMLHttpRequest/](http://www.w3.org/TR/XMLHttpRequest/)上的 W3C 规范没有提及`channel`或任何其他“提取请求 URL”的方式。因此，我怀疑没有办法在浏览器之间合理地做到这一点。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-06-28T09:12:38.973

一些可能有用的相关属性是：

* * *

**xhr2**

`XMLHttpRequest.responseURL`- [https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseURL](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseURL)。

IE 不支持此功能。

* * *

**拿来**

如果您使用[fetch](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)，您可以使用`Response.url`- [https://developer.mozilla.org/en-US/docs/Web/API/Response/url](https://developer.mozilla.org/en-US/docs/Web/API/Response/url)。

IE 不支持此功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-12-18T21:07:27.387

我也需要这个，因为我在执行 URL 请求的 for 循环。

由于通常在调用 XMLHttpRequest 对象上的 open 方法之前您有 URL 请求，因此您可以在 xml 对象上分配一个随机属性（在我的例子中是属性 url）：

```
var xml = new XMLHttpRequest();
xml.onreadystatechange = function() {
    if ( xml.readyState == 4) {
        console.log(xml.url); // equal to originalUrl
    }
};
xml.open("GET", originalUrl, true);
xml.url = originalUrl;
xml.send(); 
```

# websphere - 在 websphere 上部署应用程序时出现 mqjbnd05 错误

> ID：921199
> 
> 赞同：2
> 
> 时间：2009-05-28T14:40:23.583
> 
> 标签：websphere, message-queue, ibm-mq

我全新安装了 Wesphere 6.1 Fixpack 23。我部署了一个需要 MQSeries JMS 队列的应用程序。我设置了一个基于 MQSeries 提供者的请求和回复队列以及一个基于 MQSeries 提供者的队列连接工厂。当部署的应用程序尝试访问队列时，我收到以下错误。

任何援助将不胜感激。谢谢！

[5/28/09 10:33:42:538 EDT] 00000033 ServletWrappe E SRVE0068E：在 servlet 的服务方法之一中抛出未捕获的异常：espaapp。抛出异常：org.springframework.web.util.NestedServletException：处理程序处理失败；嵌套**异常是 java.lang.UnsatisfiedLinkError: *mqjbnd05 (Not found in java.library.path)* 原因：java.lang.UnsatisfiedLinkError: mqjbnd05 (Not found in java.library.path)** 在 java.lang.ClassLoader.loadLibraryWithPath(ClassLoader.java:953) 在 java.lang.ClassLoader.loadLibraryWithClassLoader(ClassLoader.java:922) 在 java.lang.System.loadLibrary(System.java:451) 在 com.ibm。 mq.MQSESSION.loadLib(MQSESSION.java:1028) 在 com.ibm.mq.server.MQSESSION$1.run(MQSESSION.java:246) 在 java.security.AccessController.doPrivileged(AccessController.java:192) 在 com。 ibm.mq.server.MQSESSION.(MQSESSION.java:243) 在 java.lang.J9VMInternals.initializeImpl(Native Method) 在 java.lang.J9VMInternals.initialize(J9VMInternals.java:177) 在 com.ibm.mq.MQSESSIONServer .getMQSESSION(MQSESSIONServer.java:68) 在 com.ibm.mq.MQSESSION.getSession(MQSESSION.java:508) 在 com.ibm.mq.MQManagedConnectionJ11.(MQManagedConnectionJ11.java:213) 在 com.ibm.mq.MQBindingsManagedConnectionFactoryJ11 ._createManagedConnection(MQBindingsManagedConnectionFactoryJ11.java:186) 在 com.ibm.mq.MQBindingsManagedConnectionFactoryJ11.createManagedConnection(MQBindingsManagedConnectionFactoryJ11.java:225) 在 com.ibm.mq.StoredManagedConnection.(StoredManagedConnection.java:84) 在 com.ibm.mq.MQSimpleConnectionManager。在 com.ibm.mq.MQQueueManagerFactory.obtainBaseMQQueueManager(MQQueueManagerFactory.java:795) 在 com.ibm.mq.MQQueueManagerFactory.procure(MQQueueManagerFactory.java:709) 在 com.ibm.mq.MQQueueManagerFactory 的 allocateConnection(MQSimpleConnectionManager.java:173) .constructQueueManager(MQQueueManagerFactory.java:664) 在 com.ibm.mq.MQQueueManagerFactory.createQueueManager(MQQueueManagerFactory.java:160) 在 com.ibm.mq.MQQueueManager.(MQQueueManager.java:550) 在 com.ibm.mq.MQSPIQueueManager .(MQSPIQueueManager.java:62）在 com.ibm.mq.jms.MQConnection.createQM(MQConnection.java:2427) 在 com.ibm.mq.jms.MQConnection.createQMXA(MQConnection.java:1806) 在 com.ibm.mq.jms.MQQueueConnection .(MQQueueConnection.java:105) 在 com.ibm.mq.jms.MQQueueConnection.(MQQueueConnection.java:66) 在 com.ibm.mq.jms.MQXAQueueConnection.(MQXAQueueConnection.java:59) 在 com.ibm.mq .jms.MQXAQueueConnectionFactory.createXAQueueConnection(MQXAQueueConnectionFactory.java:82) 在 com.ibm.ejs.jms.JMSManagedQueueConnection.createConnection(JMSManagedQueueConnection.java:123) 在 com.ibm.ejs.jms.JMSManagedConnection.(JMSManagedConnection.java:315)在 com.ibm.ejs.jms.JMSManagedQueueConnection.(JMSManagedQueueConnection.java:71) ... 更多java:1806) 在 com.ibm.mq.jms.MQQueueConnection.(MQQueueConnection.java:105) 在 com.ibm.mq.jms.MQQueueConnection.(MQQueueConnection.java:66) 在 com.ibm.mq.jms.MQXAQueueConnection .(MQXAQueueConnection.java:59) 在 com.ibm.mq.jms.MQXAQueueConnectionFactory.createXAQueueConnection(MQXAQueueConnectionFactory.java:82) 在 com.ibm.ejs.jms.JMSManagedQueueConnection.createConnection(JMSManagedQueueConnection.java:123) 在 com.ibm .ejs.jms.JMSManagedConnection.(JMSManagedConnection.java:315) 在 com.ibm.ejs.jms.JMSManagedQueueConnection.(JMSManagedQueueConnection.java:71) ... 更多java:1806) 在 com.ibm.mq.jms.MQQueueConnection.(MQQueueConnection.java:105) 在 com.ibm.mq.jms.MQQueueConnection.(MQQueueConnection.java:66) 在 com.ibm.mq.jms.MQXAQueueConnection .(MQXAQueueConnection.java:59) 在 com.ibm.mq.jms.MQXAQueueConnectionFactory.createXAQueueConnection(MQXAQueueConnectionFactory.java:82) 在 com.ibm.ejs.jms.JMSManagedQueueConnection.createConnection(JMSManagedQueueConnection.java:123) 在 com.ibm .ejs.jms.JMSManagedConnection.(JMSManagedConnection.java:315) 在 com.ibm.ejs.jms.JMSManagedQueueConnection.(JMSManagedQueueConnection.java:71) ... 更多com.ibm.ejs.jms.JMSManagedQueueConnection.createConnection(JMSManagedQueueConnection.java:123) 上 com.ibm.ejs.jms.JMSManagedConnection.(JMSManagedConnection.java:315) 上的 MQXAQueueConnectionFactory.createXAQueueConnection(MQXAQueueConnectionFactory.java:82)。 ibm.ejs.jms.JMSManagedQueueConnection.(JMSManagedQueueConnection.java:71) ... 更多MQXAQueueConnectionFactory.createXAQueueConnection(MQXAQueueConnectionFactory.java:82) 在 com.ibm.ejs.jms.JMSManagedQueueConnection.createConnection(JMSManagedQueueConnection.java:123) 在 com.ibm.ejs.jms.JMSManagedConnection.(JMSManagedConnection.java:315) 在 com. ibm.ejs.jms.JMSManagedQueueConnection.(JMSManagedQueueConnection.java:71) ... 更多

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T21:05:07.207

这有帮助吗？ [连接到队列管理器时发生 java.lang.UnsatisfiedLinkError](http://www-01.ibm.com/support/docview.wss?uid=swg21248900)

此外，在 JMS -> 队列连接工厂部分中，选择您的队列连接工厂并检查您的“传输类型”是否设置为“绑定”或“客户端”

我把我的换给了客户，这似乎有很大帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T11:56:06.070

这种错误通常是由于传递`null`给`port`或`host`连接`QManager`工厂而发生的。尝试在执行期间检查所有参数。通常 MQ 不需要 mqjbnd05 库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T07:25:06.570

尝试找到这个文件

```
libmqjbnd05.so 
```

将其添加到 JVM 的 LIBPATH 中，然后重试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-09T20:44:26.243

转到 WebSphere 管理控制台。环境 -> WebSphere 变量。查找 MQ_INSTALL_ROOT 并将其值修改为您的 MQ 安装目录 [MQ Home]。

# asp.net - System.Net.WebException：请求被中止

> ID：921207
> 
> 赞同：0
> 
> 时间：2009-05-28T14:42:16.200
> 
> 标签：asp.net, web-services, webmethods

首先，让我澄清一下我们正在使用的平台。我们有一个 ASP.NET 2.0 应用程序调用一个 Web 服务，该服务是在 webMethods（现为 SoftwareAG）集成服务器 7.1.2 上创建并托管的。

在中等数量的尝试下，我们遇到的问题似乎每 10-20 分钟发生一次。.NET 应用程序尝试调用 Web 服务并收到“ *System.Net.WebException：请求已中止：请求已取消*”错误消息。发生此问题时，集成服务器上没有记录错误。

任何帮助/建议将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:15:04.387

这看起来很糟糕……而且信息很少。

我认为您将不得不使用其他工具进行分析...

会不会是请求在途中的某个地方停止了？[也许您可以尝试使用wireshark](http://www.wireshark.org/)
遵循请求？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-27T13:48:29.623

您在集成服务器上检查了哪些日志并应用了日志级别？例如，您可以检查是否可以建立 HTTP 连接。

# unix - 我能知道 scp 命令在 unix 中的退出状态吗

> ID：921210
> 
> 赞同：3
> 
> 时间：2009-05-28T14:43:06.947
> 
> 标签：unix, ssh, scp

在使用 scp 命令在 perl 中进行编程时，如果你告诉我哪个退出值（除 0-成功，1-错误）是什么我的生活会很简单，我就会 面临 scp 命令的退出状态

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T14:50:24.343

从[这里](http://support.attachmate.com/techdocs/2116.html)：

```
0   Operation was successful
1   General error in file copy
2   Destination is not directory, but it should be
3   Maximum symlink level exceeded
4   Connecting to host failed.
5   Connection broken
6   File does not exist
7   No permission to access file.
8   General error in sftp protocol
9   File transfer protocol mismatch
10  No file matches a given criteria
65  Host not allowed to connect
66  General error in ssh protocol
67  Key exchange failed
68  Reserved
69  MAC error
70  Compression error
71  Service not available
72  Protocol version not supported
73  Host key not verifiable
74  Connection failed
75  Disconnected by application
76  Too many connections
77  Authentication cancelled by user
78  No more authentication methods available
79  Invalid user name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T14:47:25.380

链接：[scp 返回码](http://support.attachmate.com/techdocs/2116.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T14:48:29.620

在处理 shell 命令和类似程序时，0 几乎总是成功返回码。

# php - 使用 metaWeblog.newPost 到 Drupal 的 PHPXMLRPC 博客文章：方法参数数量错误

> ID：921214
> 
> 赞同：1
> 
> 时间：2009-05-28T14:44:12.297
> 
> 标签：php, xml-rpc

我正在尝试将一个简单的文本字符串发布到我的 drupal 站点。它需要使用 metaWeblog.newPost 完成，因为 blogger.newPost 将所有文本设置为标题。我已经试过那个了。

到目前为止，我已经得到了这个：

```
 require_once('xmlrpc-v1.174.inc');

$appkey     = "0001000";
$blogid     = "blog";

$username   = "xxxx";
$password   = "xxxx";
$text       = "testing";
$boolean    = "true";

$content['title'] = "Testen van metaWeblog.newPost";
$content['description'] = $text;

$oMessage = new xmlrpcmsg('metaWeblog.newPost');

$oMessage->addParam( new xmlrpcval( $blogid , 'string' ));
$oMessage->addParam( new xmlrpcval( $username , 'string' ));
$oMessage->addParam( new xmlrpcval( $password , 'string' ));
$oMessage->addParam( $content , 'struct' );
$oMessage->addParam( new xmlrpcval( $boolean , 'boolean' ));

$oClient = new xmlrpc_client("http://example.nl/drupal/xmlrpc.php");

$oClient->setDebug(0);

$oResponse = $oClient->send( $oMessage );

if ($oResponse->faultCode() ) {
    $xWebserviceOutput = $oResponse->faultString();
}
else
{
    $oValue = $oResponse->value();
    $xWebserviceOutput = $oValue->scalarval();
}

echo $xWebserviceOutput; 
```

我已经使用过这个文档：

[http://www.sixapart.com/developers/xmlrpc/metaweblog_api/metaweblognewpost.html](http://www.sixapart.com/developers/xmlrpc/metaweblog_api/metaweblognewpost.html) [http://expressionengine.com/wiki/How_to_add_an_entry_using_PHP_and_Metaweblog_API/](http://expressionengine.com/wiki/How_to_add_an_entry_using_PHP_and_Metaweblog_API/) [http://api.drupal.org/api/function/blogapi_metaweblog_new_post/6](http://api.drupal.org/api/function/blogapi_metaweblog_new_post/6)

它产生的错误如下：

```
Server error. Wrong number of method parameters. 
```

有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T16:49:38.193

解决方案：

```
require_once('xmlrpc-v1.174.inc');

$client = new xmlrpc_client( "http://example.nl/drupal/xmlrpc.php" );
$f = new xmlrpcmsg("metaWeblog.newPost",
    array(
        new xmlrpcval( "blog", "string"), // BlogID (Ignored)
        new xmlrpcval( "xxxx", "string"), // User
        new xmlrpcval( "xxxx", "string"),    // Pass
        new xmlrpcval( // body
        array(
            "title" => new xmlrpcval("Testen van metaWeblog", "string"),

        ), "struct"),
        new xmlrpcval(true, "boolean") // publish
    )
);

$oResponse = $client->send($f);

for ($i = 0; $i < $f->getNumParams(); $i++) {
    $e = $f->getParam($i);
    echo $e->scalarval();
}

$xWebserviceOutput;

if ($oResponse->faultCode() ) {
    $xWebserviceOutput = $oResponse->faultString();
}
else
{
    $oValue = $oResponse->value();
    $xWebserviceOutput = $oValue->scalarval();
}

echo $xWebserviceOutput; 
```

# c# - 使用 C# 和 VS2008 将 linq 转换为 xml

> ID：921217
> 
> 赞同：2
> 
> 时间：2009-05-28T14:44:28.693
> 
> 标签：c#, .net, xml, linq

XML 格式

```
<status>
 <webresponse>
  <properties>
   <props>
    <imghandle>
     <image handle=1234>
      <imagetag>somewhere</imagetag>
     </image>
    </imghandle>
   </props>
   <props>
    <imghandle>
     <image handle=1235>
      <imagetag>somewhere1</imagetag>
     </image>
    </imghandle>
   </props>
  </properties>
 </webresponse>
</status> 
```

以上是第三方返回给我的 xml 示例。我正在尝试使用 Linq to XMl 来构建我的对象，并且我正在尝试导航到`<imghandle>/<image handle=1234>`. 我可以用 Xpath 做到这一点，但是当我执行以下操作时，我得到 object ref not set 错误

```
from c in searchXMLResult.Descendants("props")
select c.Element("imghandle").Element("image").Attribute("handle"); 
```

PS：我知道我的 xml 格式没有很好的可读性，在这里提问时如何放置 XML 部分？

更新 1：所以在激怒了第 3 方之后，我终于得到一个答案，说我正在使用的数据已经过时，他们给了我看起来像这样的新格式化数据

```
<status>
     <webresponse>
      <properties>
       <props>
        <imghandle>
         <image handle="1234">
          <imagetag>somewhere</imagetag>
         </image>
        </imghandle>
        <owner>
          <image handle="ABcf">
          </image>
        </owner>
       </props>
       </properties>
     </webresponse>
    </status> 
```

我尝试了 Kevin Thige 的建议，看看下面的用户建议，我得到一个对象引用错误。不能在 2 个不同部分下有相同的元素不能与 Linq to XML 一起使用吗？IE

```
from c in searchXMLResult.Descendants("props") 
```

选择 c.Element("imghandle").Element("image").Attribute("handle");

和/或

```
from c in searchXMLResult.Descendants("props") 
```

选择 c.Element("owner").Element("image").Attribute("handle")

Update2：这是我获取并保存到磁盘的 xml

```
<?xml version="1.0" encoding="utf-8"?>
<status>
  <webresponse>
    <properties>
      <props>
        <imghandle>
          <image handle="537">
            <imagetag>SFO</imagetag>
          </image>
        </imghandle>
        <owner>
          <image handle="User-2">
            <firstname>
            </firstname>
            <lastname>Site Administrator</lastname>
            <username>admin</username>
          </image>
        </owner>
        <creationdate>2009-03-06T18:07:57Z</creationdate>
        <summary>
        </summary>
      </props>
      <status>HTTP/1.1 200 OK</status>
    </properties>
  </webresponse>
</status> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T14:52:52.717

下面的代码对我有用，一旦我在'handle'属性值周围加上引号：

```
XDocument xdoc = XDocument.Parse(@"
<status>
 <webresponse>
  <properties>
   <props>
    <imghandle>
     <image handle='1234'>
      <imagetag>somewhere</imagetag>
     </image>
    </imghandle>
   </props>
   <props>
    <imghandle>
     <image handle='1235'>
      <imagetag>somewhere1</imagetag>
     </image>
    </imghandle>
   </props>
  </properties>
 </webresponse>
</status>
");

var v = from c in xdoc.Descendants("props")
select c.Element("imghandle").Element("image").Attribute("handle"); 
```

编辑：如果不修改输入以使 xml 有效，我不知道您可以使用 XDocument 或 XmlDocument 对象做什么。如果您尝试加载无效的 xml，两者都会抛出异常。

EDIT2：第二个 xml 示例仍然无效:(。标签`<image handle='ABcf'>`未关闭。

# subsonic - 使用哪个 SubSonic 3 模板

> ID：921218
> 
> 赞同：4
> 
> 时间：2009-05-28T14:44:30.767
> 
> 标签：subsonic, subsonic3

编辑：现在有一个[文档页面](http://subsonicproject.com/docs/Selecting_Templates)，所以这个问题无关紧要，也已经过时了。阅读文档而不是这个问题。

一个月左右以来，我一直在玩弄 SubSonic 3 代码生成，我有兴趣从其他人那里获得一些关于他们使用哪种模板以及为什么使用的反馈。

编辑：Rob 一直在写关于不同模板的博客，所以我添加了帖子的链接

## ActiveRecord - [Rob 博客中的更多详细信息](http://blog.wekeroad.com/subsonic/subsonic-30-activerecord/)

**优点**

*   支持流行且易于理解的模式
*   允许从 2.2 版轻松迁移
*   ActiveRecord 的内置测试（见下面 Rob 的回答）
*   实现存储库模式

**缺点**

*   在它生成的对象中被认为是重量级的

## 简单 -[来自 Rob 博客的更多详细信息](http://blog.wekeroad.com/subsonic/subsonic-30-the-simplerepository/)

**优点**

*   生成 POCOS
*   实现存储库模式

**缺点**

*   为所有类生成一个巨大的单个文件，这会使浏览生成的源变得很痛苦

## 先进的

**优点**

*   生成的文件结构比简单的要整洁得多
*   生成 POCOS
*   实现存储库模式

**缺点**

*   ?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T18:20:21.753

一切都使用 Repo - 它是所有模板的核心，现在位于 SubSonic 的核心代码中。我无法帮助您进行选择，但我可以说的是 ActiveRecord 将为您提供最多的选择。

我还没有与人分享的一件事（我很快会）是 ActiveRecord 的内置测试。在您的测试项目中，只需使用“Test”作为您的连接字符串，AR 模板就不会命中您的数据库。此外，您可以使用静态“设置”方法将测试记录泵入内存列表。

添加/更新/删除所有内存中的东西。

就“重”而言 - 我喜欢认为“容易”胜过。它没有比 ActiveRecord 更容易的了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T14:50:04.033

选择高级模板，因为它将允许您使用存储库模式。我主要选择高级模板，因为我喜欢文件结构（易于维护）并想使用存储库模式。

# javascript - 未定义变量的 Javascript 错误

> ID：921220
> 
> 赞同：1
> 
> 时间：2009-05-28T14:45:23.870
> 
> 标签：javascript, firefox

我有一个问题，即一个方法得到一个未定义的变量错误，即使我在调用之前检查了未定义的变量。

```
// Sets focus and text-select to the passed in element.
idNav.prototype.setFocusFromVar = function(r) {
    document.activeInputArea = r;   // my variable for tracking focus
    r.focus();    // error happens here (line 274 of idNav.js)
    r.select();
} 
```

错误发生在 r.focus 线上。

在我调用该方法的两个地方，我使用类似于以下的模式，在调用者中带有一个局部变量 r。

```
if (!r)
    return;

this.setFocusFromVar(r); 
```

但错误仍然存​​在。当 r 不为 null 或未定义时，它是我网页上表格中的输入元素。

我继续在 idNav.js 的第 274 行得到 r is undefined，这是 r.focus 行。该方法的所有调用者也在同一个 js 文件中。

我错过了什么？

此错误在 Firefox 中间歇性发生，我尚未在 IE 中测试此特定错误。

EDTA: r 确实显示为未定义，并且错误的堆栈跟踪显示：

```
setFocusFromVar()(undefined)IDNav.js (line 275)
dhandler(Object originalEvent=Event keydown type=keydown)IDNav.js (line 100)
newTrigger()(Object originalEvent=Event keydown type=keydown)jquery.hotkeys.js (line 1)
F()()jquery.js (line 19)
F()(Object originalEvent=Event keydown type=keydown)jquery.js (line 19)
F()()jquery.js (line 19)
[Break on this error] r.focus(); 
```

dhandler 是我检查过的方法之一，似乎很好（没问题）。不过，我会再看一下以确保：

它用于处理向下箭头和输入键，以便在我的输入元素表中导航。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T15:02:06.753

根据您对问题的描述，在我看来，有时会在没有进行完整性检查的情况下调用它。我会将健全性检查放在函数内部而不是外部。

但是，您可能还想首先知道您是如何绕过它的。我将按如下方式修改函数以检查 Firebug 中出了什么问题：

```
idNav.prototype.setFocusFromVar = function(r) {
    if (!r) {
        return;  // Set the breakpoint here
    }
    document.activeInputArea = r;
    r.focus();
    r.select();
} 
```

然后，当您遇到断点时，您可以查看 Firebug 的堆栈跟踪以确定您是如何获得该函数的，而无需检查 r 是否已定义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T15:00:45.650

我建议在函数内移动（或复制）您的健全性检查，如下所示：

```
idNav.prototype.setFocusFromVar = function(r) {
    if (!r)
        return;

    document.activeInputArea = r;   // my variable for tracking focus
    r.focus();    // error happens here (line 274 of idNav.js)
    r.select();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T14:57:36.857

您应该测试该变量不为 null 且不等于`undefined`。

这是一篇关于在 Javascript 中测试变量是否存在的[好文章](http://www.esqsoft.com/javascript-help/javascript-testing-defined-undefined-variables.htm)。它列出了各种方法以及每种方法的优缺点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T14:58:17.917

我很少使用 if(!r) 来测试变量是否未定义。

我更喜欢使用 if(typeof(r)=='undefined') 或 if(r!=null)。

r 的值取决于它的声明和做作。

*   变量 r; => 未定义但可测试为 null（r==null 将返回 true）
*   变量 r="测试"; => 字符串测试
*   变量 r=null; => 空；

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T14:50:57.027

我不舒尔，但你不应该调用 if(r==undefined) 而不是 if(!r) 吗？我总是这样...

# java - Hibernate - PropertyNotFoundException：找不到getter

> ID：921239
> 
> 赞同：12
> 
> 时间：2009-05-28T14:50:04.313
> 
> 标签：java, hibernate

我有一个如下所示的类：

```
public class MyClass {
    private String dPart1;

    public String getDPart1() {
        return dPart1;
    }

    public void setDPart1(String dPart1) {
        this.dPart1 = dPart1;
    }
} 
```

我的休眠映射文件按如下方式映射属性：

```
<property name="dPart1" not-null="true"/> 
```

我收到以下错误：

```
org.hibernate.PropertyNotFoundException: Could not find a getter for dPart1 in class com.mypackage.MyClass
        at org.hibernate.property.BasicPropertyAccessor.createGetter(BasicPropertyAccessor.java:282)
        at org.hibernate.property.BasicPropertyAccessor.getGetter(BasicPropertyAccessor.java:275)
        at org.hibernate.mapping.Property.getGetter(Property.java:272)
        at org.hibernate.tuple.entity.PojoEntityTuplizer.buildPropertyGetter(PojoEntityTuplizer.java:247)
        at org.hibernate.tuple.entity.AbstractEntityTuplizer.<init>(AbstractEntityTuplizer.java:125)
        at org.hibernate.tuple.entity.PojoEntityTuplizer.<init>(PojoEntityTuplizer.java:55)
        at org.hibernate.tuple.entity.EntityEntityModeToTuplizerMapping.<init>(EntityEntityModeToTuplizerMapping.java:56)
        at org.hibernate.tuple.entity.EntityMetamodel.<init>(EntityMetamodel.java:302)
        at org.hibernate.persister.entity.AbstractEntityPersister.<init>(AbstractEntityPersister.java:434)
        at 
```

看来hibernate不喜欢我的大写。我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-28T14:56:44.487

```
<property name="DPart1" not-null="true"/> 
```

应该管用...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-28T14:57:30.570

对于名为“dPart1”的属性，休眠将尝试名为“getDpart1”而不是“getDPart1”IIRC的getter

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-28T15:33:14.117

你不能像一个字段一样访问它吗？

访问="字段"

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-06T13:08:10.440

我得到了解决方案

请将 dPart1 设置为 dpart1 并再次更改 getter 和 setter..

它现在对我有用。

记住也要更改xml。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-04T15:40:18.260

```
private String rptausu;

public String getRptausu() {
    return rptausu;
}

public void setRptausu(String rpta) {
    rptausu = rpta;
} 
```

映射：

```
 <property name="prtausu" /> 
```

正常工作

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-22T06:30:50.670

从我所见，Hibernate（至少版本 3.2.4）将期望像 dPart 这样的属性有一个名为 getdPart 的 getter：d 保持小写。也看看 dfa 的回答——我猜其他版本可能会期待 getDpart 。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-01T08:20:11.683

setter & getter 应该是这样的

```
getdPart1()
setdPart1(....) 
```

如果通过 Eclipse 之类的 IDE 生成，这就是 setter 和 getter 的生成方式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-01-17T10:31:40.690

对于属性私有整数 carId；

setter 和 getter 应该是

getCarId() setCarId(整数 carId)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-10T06:56:47.457

在我最初使用的我自己的案例中，属性的命名约定很重要

```
private String newimsi, getNewImsi(); 
```

以上失败了同样的例外

> 属性未找到异常

直到我在它起作用之前纠正到下面

```
getNewimsi(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-03-10T04:25:53.547

最佳实践不是我们自己创建 getter/setter，而是使用 Eclipse Shortcut(Alt+Shift+S) 为 bean/pojo 中定义的变量创建相同的。

命名约定很重要。

# c# - 更改视图根文件夹

> ID：921241
> 
> 赞同：0
> 
> 时间：2009-05-28T14:50:09.727
> 
> 标签：c#, .net, asp.net-mvc

有没有办法将视图的根文件夹更改为 bin/views 文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:11:54.223

您可以子类型化 WebFormsViewEngine：

```
public class MyViewEngine : WebFormViewEngine
{
    public MyViewEngine() {
        MasterLocationFormats = new[] {
            "~/bin/Views/{1}/{0}.master",
            "~/bin/Views/Shared/{0}.master"
        };

        ViewLocationFormats = new[] {
            "~/bin/Views/{1}/{0}.aspx",
            "~/bin/Views/{1}/{0}.ascx",
            "~/bin/Views/Shared/{0}.aspx",
            "~/bin/Views/Shared/{0}.ascx"
        };

        PartialViewLocationFormats = ViewLocationFormats;
    }
} 
```

然后编辑 Global.asax 以使用它：

```
 private void Application_Start(object sender, EventArgs e)
    {
        RegisterRoutes(RouteTable.Routes);
        // replace default WebForms view engine.
        ViewEngines.Engines.Remove(ViewEngines.Engines.OfType<WebFormViewEngine>().Single());
        ViewEngines.Engines.Add(new Namespace.MyViewEngine());
    } 
```

# asp.net - ASP.NET 成员资格配置工具 - 更改密码？

> ID：921243
> 
> 赞同：1
> 
> 时间：2009-05-28T14:50:18.150
> 
> 标签：asp.net, web-config, membership

如何使用 ASP.NET 配置工具更改我的用户密码？我不能，我猜是因为我需要对 web.config 做点什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T15:01:48.173

ASP.NET 配置工具不支持更改密码。您需要在您的应用程序中实现这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:03:07.313

我不确定你能不能。配置工具看起来不像是设置为以这种方式使用的。

写下用户的信息，删除他/她，然后重新创建个人资料是否可以接受？或者你会丢失数据吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:21:25.590

您只能提供重置密码的选项。你为什么不这样做？那更好。

# iphone - 在可可触摸中使用忙碌指示器切换视图

> ID：921246
> 
> 赞同：0
> 
> 时间：2009-05-28T14:50:53.843
> 
> 标签：iphone, objective-c, cocoa-touch

我正在从包含从网络下载的照片的 tableview 触摸单元加载视图。我设置了一个忙碌指示器，当单元格被触摸时调用，然后在 viewdiddisappear 方法中将其关闭，但是当您触摸单元格时，当单元格被触摸时仍然有很长的停顿，然后忙碌指示器只显示一个第二然后它加载视图。显然我做错了。执行此操作的最佳方法是什么，以便在暂停之前先打开忙碌指示灯？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T18:36:50.253

您可以预先创建繁忙指示器并将其设置为隐藏在每个表格单元格中。如果您正在利用 UITableView 的单元格缓存，那么在任何给定时间只有几个单元格浮动，因此开销不会太多。一旦您从 tablview 获得选择事件，在执行任何其他操作之前取消隐藏指示器并为其设置动画。

我还发现，通过自己设置/取消设置隐藏标志（并在开始动画之前进行）而不是使用“停止时自动隐藏”功能，启动和停止微调器动画时速度略有提高。这可能只是我的眼睛在耍花招，但它似乎更灵活。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T14:35:14.797

谢谢你的建议。我最终这样做的方式是使用多线程。具体使用“操作”。现在完美运行。

# asp.net-mvc - 基本控制器中的 ASP.NET 重定向

> ID：921248
> 
> 赞同：5
> 
> 时间：2009-05-28T14:51:08.540
> 
> 标签：asp.net-mvc

我创建了一个基本控制器，它覆盖了 Initialize 并设置了一个 cookie 并将一些数据保存在数据库中。在这里，我还需要检查是否设置了 cookie，以及它是否没有重定向到错误页面。

该站点的用户来自另一个站点上的商店定位器，该站点将商店 ID 传递给我，我将其设置在 cookie 中。我需要确保存储了一个 ID，如果没有将它们传递给错误或返回以选择商店。

我在基本控制器中重定向或显示此错误时遇到问题。我什至尝试了控制器的构造函数。下面是我在 Initialize override 中尝试的代码，但此时 ControllerContext 为空？

```
 if (StoreID == null)
        {
            View("StoreError").ExecuteResult(ControllerContext);
            return;
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T15:37:09.553

下面的伎俩...

```
requestContext.HttpContext.Response.Redirect("/home/storeError"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T21:23:23.007

我建议创建一个 Action 来检查 OnActionExecuting 方法中的 Cookie 并重定向到正确的操作方法。

明确说明：[MVC - 在构造函数内部重定向](https://stackoverflow.com/questions/4793452/mvc-redirect-inside-the-constructor)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T15:41:28.703

我认为正确的方式

```
 Return RedirectToAction("StoreError","Home"); 
```

不？

# delphi - Delphi中的字体平滑

> ID：921249
> 
> 赞同：20
> 
> 时间：2009-05-28T14:51:15.667
> 
> 标签：delphi, fonts, truetype, smoothing

我有理由在 Delphi 表单上需要一个带有大字体的标签，并注意到它的曲线仍然略微呈锯齿状。我将其与 MSWord 中相同的大小和字体进行了比较，后者更加流畅。经过研究，我发现了可以让我平滑字体的代码，但它很乱，我想知道是否有更好的方法？查看 VCL 源代码，TFont 似乎与 NONANTIALIASED_QUALITY 结合在一起，这相当令人沮丧......

谢谢布里

```
procedure TForm1.SetFontSmoothing(AFont: TFont);
var
  tagLOGFONT: TLogFont;
begin
  GetObject(
    AFont.Handle,
    SizeOf(TLogFont),
    @tagLOGFONT);
  tagLOGFONT.lfQuality  := ANTIALIASED_QUALITY;
  AFont.Handle := CreateFontIndirect(tagLOGFONT);
end;

procedure TForm1.FormCreate(Sender: TObject);
var
  I : integer;
begin
  For I :=0 to ComponentCount-1 do
    If Components[I] is TLabel then
      SetFontSmoothing( TLabel( Components[I] ).Font );
end; 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-28T16:17:16.993

您可以欺骗 VCL 创建您自己的继承自`TLabel`. *这是概念验证代码，使用 Delphi 4 进行了测试，应该可以帮助您入门。*

`TLabel`为您自己的班级创建一个新单元：

```
unit AntiAliasedLabel;

interface

uses
  Windows, Messages, SysUtils, Controls, StdCtrls, Graphics;

type
  TLabel = class(StdCtrls.TLabel)
  private
    fFontChanged: boolean;
  public
    procedure Paint; override;
  end;

implementation

procedure TLabel.Paint;
var
  LF: TLogFont;
begin
  if not fFontChanged then begin
    Win32Check(GetObject(Font.Handle, SizeOf(TLogFont), @LF) <> 0);
    LF.lfQuality := ANTIALIASED_QUALITY;
    Font.Handle := CreateFontIndirect(LF);
    fFontChanged := TRUE;
  end;
  inherited;
end;

end. 
```

现在修改包含标签的表单单元`AntiAliasedLabel`，**在** `StdCtrls`. `AntiAliasedLabel.TLabel`这会导致在通常创建的位置创建您自己的类`StdCtrls.TLabel`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-28T21:35:53.933

恕我直言，VCL 应该检查系统默认字体平滑并在运行时将其应用为默认值。如果不是，至少它应该默认为更合理的平滑。在这种情况下，有人可能会争辩说，ClearType 会是一个更好的默认值，考虑到现在 > 50% 的显示器是 LCD（并且超过 50% 的机器运行 XP 或更高版本）。

这是一个公认的 hack（正如 Ken White 所提到的，如果有替代方案，这不是最好的方法），但我需要一种方法来全局修复这个包含数百个第 3 方组件类型的表单（使组件继承不切实际）。

我更改了Graphics.pas中的默认字体质量，TFont.GetHandle如下：

// lfQuality := DEFAULT_QUALITY;

lf质量：= 5；// ***(HACK)*** CLEARTYPE_QUALITY，强制清除类型

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-10-21T11:57:29.383

来自： http: [//objectmix.com/delphi/725245-tlabel-antialiasing-possibile-3.html](http://objectmix.com/delphi/725245-tlabel-antialiasing-possibile-3.html)

“只需使用支持字体平滑的字体即可解决此问题。Delphi 使用（或至少曾经使用）MS Sans Serif 作为默认值，它不支持平滑（ClearType 或其他）。如果您将字体设置为 Tahoma（最适合XP）或 Segoe UI（最适合 Vista），您将根据 Delphi 应用程序中的系统设置自动获得字体平滑。”

经证实，它使用 Delphi XE 和 Win7 运行良好。现在正忙于更改我所有的字体；-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T15:04:32.990

最简单的方法是基于 TLabel 创建自己的组件，例如 TSmoothLabel 或 TAntiAliasedLabel，并将平滑代码添加到其中。然后你使用你的组件而不是标准的 TLabel。

# c# - 计算分层对象列表中所有项目的方法

> ID：921251
> 
> 赞同：4
> 
> 时间：2009-05-28T14:52:17.430
> 
> 标签：c#, c#-3.0, recursion, hierarchy

我有一个简单的类定义为：

```
public class MyClass
{
   //Some properties
   public List<MyClass> SubEntries { get; set; }
   //Some more properties
} 
```

在另一堂课中，我有一个上述类型的列表。目前，我有严重的精神障碍。我只需要遍历列表并计算 MyClass 的所有出现次数。由于 SubEntries 属性可以包含 0 个或多个条目，而这些条目本身可以包含 0 个或多个条目，我觉得我需要某种递归方法，除非 LINQ 提供了一种机制来执行此操作。

任何释放这种心理日志堵塞的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-28T14:55:05.940

假设您不介意沿树递归，并假设列表始终为非空且没有循环：

```
public class MyClass
{
    public List<MyClass> SubEntries { get; set; }

    public int SubEntryCount
    {
        get { return 1 + SubEntries.Sum(x => x.SubEntryCount); }
    }
} 
```

您可能想要重命名它，以便清楚它是子条目的*总数*，而不仅仅是直系子条目。

# java - 如何使用 Java 从 Internet 下载和保存文件？

> ID：921262
> 
> 赞同：456
> 
> 时间：2009-05-28T14:53:59.157
> 
> 标签：java, download

有一个在线文件（例如`http://www.example.com/information.asp`）我需要抓取并保存到目录中。我知道有几种方法可以逐行获取和读取在线文件 (URL)，但是有没有办法使用 Java 下载和保存文件？

* * *

## 回答 #1

> 赞同：577
> 
> 时间：2009-05-28T15:16:07.693

试试[Java NIO](http://en.wikipedia.org/wiki/New_I/O)：

```
URL website = new URL("http://www.website.com/information.asp");
ReadableByteChannel rbc = Channels.newChannel(website.openStream());
FileOutputStream fos = new FileOutputStream("information.html");
fos.getChannel().transferFrom(rbc, 0, Long.MAX_VALUE); 
```

使用**可能**`transferFrom()`比从源通道读取并写入该通道的简单循环更有效。许多操作系统可以直接从源通道将字节传输到文件系统缓存中，而无需实际复制它们。

 **[在这里](http://docs.oracle.com/javase/7/docs/api/java/nio/channels/FileChannel.html)查看更多信息。

**注意**： transferFrom 中的第三个参数是要传输的最大字节数。 `Integer.MAX_VALUE`最多传输 2^31 个字节，`Long.MAX_VALUE`最多允许 2^63 个字节（比现有的任何文件都大）。

* * *

## 回答 #2

> 赞同：523
> 
> 时间：2011-08-23T04:12:19.710

使用 Apache [Commons IO](http://commons.apache.org/proper/commons-io/javadocs/api-2.4/org/apache/commons/io/FileUtils.html#copyURLToFile(java.net.URL,%20java.io.File))。它只是一行代码：

```
FileUtils.copyURLToFile(URL, File) 
```

* * *

## 回答 #3

> 赞同：125
> 
> 时间：2014-06-04T15:16:33.553

更简单[的非阻塞 I/O](https://en.wikipedia.org/wiki/Non-blocking_I/O_(Java))使用：

```
URL website = new URL("http://www.website.com/information.asp");
try (InputStream in = website.openStream()) {
    Files.copy(in, target, StandardCopyOption.REPLACE_EXISTING);
} 
```

* * *

## 回答 #4

> 赞同：86
> 
> 时间：2009-05-28T15:16:47.240

```
public void saveUrl(final String filename, final String urlString)
        throws MalformedURLException, IOException {
    BufferedInputStream in = null;
    FileOutputStream fout = null;
    try {
        in = new BufferedInputStream(new URL(urlString).openStream());
        fout = new FileOutputStream(filename);

        final byte data[] = new byte[1024];
        int count;
        while ((count = in.read(data, 0, 1024)) != -1) {
            fout.write(data, 0, count);
        }
    } finally {
        if (in != null) {
            in.close();
        }
        if (fout != null) {
            fout.close();
        }
    }
} 
```

您需要处理可能在此方法之外的异常。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2017-12-01T17:18:19.690

这是一个简洁、易读、仅限 JDK 的解决方案，具有正确关闭的资源：

```
static long download(String url, String fileName) throws IOException {
    try (InputStream in = URI.create(url).toURL().openStream()) {
        return Files.copy(in, Paths.get(fileName));
    }
} 
```

两行代码，没有依赖。

这是一个[完整的文件下载器示例](https://github.com/JanStureNielsen/so-downloader)程序，带有输出、错误检查和命令行参数检查：

```
package so.downloader;

import java.io.IOException;
import java.io.InputStream;
import java.net.URI;
import java.nio.file.Files;
import java.nio.file.Paths;

public class Application {
    public static void main(String[] args) throws IOException {
        if (2 != args.length) {
            System.out.println("USAGE: java -jar so-downloader.jar <source-URL> <target-filename>");
            System.exit(1);
        }

        String sourceUrl = args[0];
        String targetFilename = args[1];

        long bytesDownloaded = download(sourceUrl, targetFilename);

        System.out.println(String.format("Downloaded %d bytes from %s to %s.", bytesDownloaded, sourceUrl, targetFilename));
    }

    static long download(String url, String fileName) throws IOException {
        try (InputStream in = URI.create(url).toURL().openStream()) {
            return Files.copy(in, Paths.get(fileName));
        }
    }    
} 
```

如[so-downloader 存储库](https://github.com/JanStureNielsen/so-downloader)自述文件中所述：

运行文件下载程序：

```
java -jar so-downloader.jar <source-URL> <target-filename> 
```

例如：

```
java -jar so-downloader.jar https://github.com/JanStureNielsen/so-downloader/archive/main.zip so-downloader-source.zip 
```

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2009-05-28T15:01:05.210

下载文件需要您阅读它。无论哪种方式，您都必须以某种方式浏览文件。您可以从流中按字节读取它，而不是逐行读取：

```
BufferedInputStream in = new BufferedInputStream(new URL("http://www.website.com/information.asp").openStream())
byte data[] = new byte[1024];
int count;
while((count = in.read(data, 0, 1024)) != -1)
{
    out.write(data, 0, count);
} 
```

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2014-11-28T14:18:28.067

此答案几乎与所选答案完全相同，但有两个增强：它是一种方法，它关闭了 FileOutputStream 对象：

```
 public static void downloadFileFromURL(String urlString, File destination) {
        try {
            URL website = new URL(urlString);
            ReadableByteChannel rbc;
            rbc = Channels.newChannel(website.openStream());
            FileOutputStream fos = new FileOutputStream(destination);
            fos.getChannel().transferFrom(rbc, 0, Long.MAX_VALUE);
            fos.close();
            rbc.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    } 
```

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2015-02-01T23:22:13.080

使用 Java 7+ 时，使用以下方法从 Internet 下载文件并将其保存到某个目录：

```
private static Path download(String sourceURL, String targetDirectory) throws IOException
{
    URL url = new URL(sourceURL);
    String fileName = sourceURL.substring(sourceURL.lastIndexOf('/') + 1, sourceURL.length());
    Path targetPath = new File(targetDirectory + File.separator + fileName).toPath();
    Files.copy(url.openStream(), targetPath, StandardCopyOption.REPLACE_EXISTING);

    return targetPath;
} 
```

文档在[这里](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#copy(java.nio.file.Path,%20java.nio.file.Path,%20java.nio.file.CopyOption...))。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2013-04-21T08:06:49.713

```
import java.io.*;
import java.net.*;

public class filedown {
    public static void download(String address, String localFileName) {
        OutputStream out = null;
        URLConnection conn = null;
        InputStream in = null;

        try {
            URL url = new URL(address);
            out = new BufferedOutputStream(new FileOutputStream(localFileName));
            conn = url.openConnection();
            in = conn.getInputStream();
            byte[] buffer = new byte[1024];

            int numRead;
            long numWritten = 0;

            while ((numRead = in.read(buffer)) != -1) {
                out.write(buffer, 0, numRead);
                numWritten += numRead;
            }

            System.out.println(localFileName + "\t" + numWritten);
        } 
        catch (Exception exception) { 
            exception.printStackTrace();
        } 
        finally {
            try {
                if (in != null) {
                    in.close();
                }
                if (out != null) {
                    out.close();
                }
            } 
            catch (IOException ioe) {
            }
        }
    }

    public static void download(String address) {
        int lastSlashIndex = address.lastIndexOf('/');
        if (lastSlashIndex >= 0 &&
        lastSlashIndex < address.length() - 1) {
            download(address, (new URL(address)).getFile());
        } 
        else {
            System.err.println("Could not figure out local file name for "+address);
        }
    }

    public static void main(String[] args) {
        for (int i = 0; i < args.length; i++) {
            download(args[i]);
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2009-05-28T15:29:17.603

就我个人而言，我发现[Apache 的 HttpClient](http://hc.apache.org/httpclient-3.x/index.html)能够胜任我在这方面需要做的所有事情。 [这](http://hc.apache.org/httpclient-3.x/tutorial.html)是一个关于使用 HttpClient 的很棒的教程

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2015-08-01T22:51:51.273

这是基于[Brian Risk 的](https://stackoverflow.com/a/27190621/449553)另一个 Java 7 变体，使用了*try-with*语句：

```
public static void downloadFileFromURL(String urlString, File destination) throws Throwable {

    URL website = new URL(urlString);
    try(
        ReadableByteChannel rbc = Channels.newChannel(website.openStream());
        FileOutputStream fos = new FileOutputStream(destination);
       ) {

        fos.getChannel().transferFrom(rbc, 0, Long.MAX_VALUE);
    }
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-03-19T16:53:32.700

可以使用 Apache`HttpComponents`而不是[Commons IO](https://commons.apache.org/proper/commons-io/)下载文件。此代码允许您根据其 URL 下载 Java 文件并将其保存在特定目的地。

```
public static boolean saveFile(URL fileURL, String fileSavePath) {

    boolean isSucceed = true;

    CloseableHttpClient httpClient = HttpClients.createDefault();

    HttpGet httpGet = new HttpGet(fileURL.toString());
    httpGet.addHeader("User-Agent", "Mozilla/5.0 (Windows NT 6.3; WOW64; rv:34.0) Gecko/20100101 Firefox/34.0");
    httpGet.addHeader("Referer", "https://www.google.com");

    try {
        CloseableHttpResponse httpResponse = httpClient.execute(httpGet);
        HttpEntity fileEntity = httpResponse.getEntity();

        if (fileEntity != null) {
            FileUtils.copyInputStreamToFile(fileEntity.getContent(), new File(fileSavePath));
        }

    } catch (IOException e) {
        isSucceed = false;
    }

    httpGet.releaseConnection();

    return isSucceed;
} 
```

与单行代码相比：

```
FileUtils.copyURLToFile(fileURL, new File(fileSavePath),
                        URLS_FETCH_TIMEOUT, URLS_FETCH_TIMEOUT); 
```

此代码将让您更好地控制流程，让您不仅可以指定超时时间，还可以指定`User-Agent`值`Referer`，这对许多网站来说都是至关重要的。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-05-21T01:43:37.350

这里有许多优雅而有效的答案。但是简洁会让我们丢失一些有用的信息。特别是，人们**通常不想将连接错误视为 Exception**，并且可能希望以不同的方式处理某种与网络相关的错误——例如，决定我们是否应该重试下载。

这是一种不会为网络错误抛出异常的方法（仅适用于真正的异常问题，例如格式错误的 url 或写入文件的问题）

```
/**
 * Downloads from a (http/https) URL and saves to a file. 
 * Does not consider a connection error an Exception. Instead it returns:
 *  
 *    0=ok  
 *    1=connection interrupted, timeout (but something was read)
 *    2=not found (FileNotFoundException) (404) 
 *    3=server error (500...) 
 *    4=could not connect: connection timeout (no internet?) java.net.SocketTimeoutException
 *    5=could not connect: (server down?) java.net.ConnectException
 *    6=could not resolve host (bad host, or no internet - no dns)
 * 
 * @param file File to write. Parent directory will be created if necessary
 * @param url  http/https url to connect
 * @param secsConnectTimeout Seconds to wait for connection establishment
 * @param secsReadTimeout Read timeout in seconds - trasmission will abort if it freezes more than this 
 * @return See above
 * @throws IOException Only if URL is malformed or if could not create the file
 */
public static int saveUrl(final Path file, final URL url, 
  int secsConnectTimeout, int secsReadTimeout) throws IOException {
    Files.createDirectories(file.getParent()); // make sure parent dir exists , this can throw exception
    URLConnection conn = url.openConnection(); // can throw exception if bad url
    if( secsConnectTimeout > 0 ) conn.setConnectTimeout(secsConnectTimeout * 1000);
    if( secsReadTimeout > 0 ) conn.setReadTimeout(secsReadTimeout * 1000);
    int ret = 0;
    boolean somethingRead = false;
    try (InputStream is = conn.getInputStream()) {
        try (BufferedInputStream in = new BufferedInputStream(is); OutputStream fout = Files
                .newOutputStream(file)) {
            final byte data[] = new byte[8192];
            int count;
            while((count = in.read(data)) > 0) {
                somethingRead = true;
                fout.write(data, 0, count);
            }
        }
    } catch(java.io.IOException e) { 
        int httpcode = 999;
        try {
            httpcode = ((HttpURLConnection) conn).getResponseCode();
        } catch(Exception ee) {}
        if( somethingRead && e instanceof java.net.SocketTimeoutException ) ret = 1;
        else if( e instanceof FileNotFoundException && httpcode >= 400 && httpcode < 500 ) ret = 2; 
        else if( httpcode >= 400 && httpcode < 600 ) ret = 3; 
        else if( e instanceof java.net.SocketTimeoutException ) ret = 4; 
        else if( e instanceof java.net.ConnectException ) ret = 5; 
        else if( e instanceof java.net.UnknownHostException ) ret = 6;  
        else throw e;
    }
    return ret;
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-05-06T17:07:04.433

[underscore-java](https://github.com/javadev/underscore-java)库`U.fetch(url)`中有一个方法 , 。

文件*pom.xml*：

```
<dependency>
  <groupId>com.github.javadev</groupId>
  <artifactId>underscore</artifactId>
  <version>1.74</version>
</dependency> 
```

代码示例：

```
import com.github.underscore.U;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;

public class Download {
    public static void main(String[] args) throws IOException {
        Files.write(Paths.get("data.bin"),
            U.fetch("https://stackoverflow.com/questions"
                + "/921262/how-to-download-and-save-a-file-from-internet-using-java").blob());
    }
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-05-20T23:50:50.397

总结（并以某种方式完善和更新）以前的答案。以下三种方法实际上是等效的。（我添加了明确的超时，因为我认为它们是必须的。没有人希望下载在连接丢失时永远冻结。）

```
public static void saveUrl1(final Path file, final URL url,
    int secsConnectTimeout, int secsReadTimeout))
    throws MalformedURLException, IOException {

    // Files.createDirectories(file.getParent()); // Optional, make sure parent directory exists
    try (BufferedInputStream in = new BufferedInputStream(
         streamFromUrl(url, secsConnectTimeout,secsReadTimeout));
         OutputStream fout = Files.newOutputStream(file)) {

            final byte data[] = new byte[8192];
            int count;
            while((count = in.read(data)) > 0)
                fout.write(data, 0, count);
        }
}

public static void saveUrl2(final Path file, final URL url,
    int secsConnectTimeout, int secsReadTimeout))
    throws MalformedURLException, IOException {

    // Files.createDirectories(file.getParent()); // Optional, make sure parent directory exists
    try (ReadableByteChannel rbc = Channels.newChannel(
             streamFromUrl(url, secsConnectTimeout, secsReadTimeout)
        );
        FileChannel channel = FileChannel.open(file,
             StandardOpenOption.CREATE,
             StandardOpenOption.TRUNCATE_EXISTING,
             StandardOpenOption.WRITE)
        ) {

        channel.transferFrom(rbc, 0, Long.MAX_VALUE);
    }
}

public static void saveUrl3(final Path file, final URL url,
    int secsConnectTimeout, int secsReadTimeout))
    throws MalformedURLException, IOException {

    // Files.createDirectories(file.getParent()); // Optional, make sure parent directory exists
    try (InputStream in = streamFromUrl(url, secsConnectTimeout,secsReadTimeout) ) {
        Files.copy(in, file, StandardCopyOption.REPLACE_EXISTING);
    }
}

public static InputStream streamFromUrl(URL url,int secsConnectTimeout,int secsReadTimeout) throws IOException {
    URLConnection conn = url.openConnection();
    if(secsConnectTimeout>0)
        conn.setConnectTimeout(secsConnectTimeout*1000);
    if(secsReadTimeout>0)
        conn.setReadTimeout(secsReadTimeout*1000);
    return conn.getInputStream();
} 
```

我没有发现显着差异，对我来说一切似乎都是正确的。它们安全高效。（速度上的差异似乎几乎没有关系——我将 180 MB 从本地服务器写入 SSD 磁盘的时间大约在 1.2 到 1.5 秒之间波动）。它们不需要外部库。所有这些都可以使用任意大小和（根据我的经验）HTTP 重定向。

`FileNotFoundException`此外，如果找不到资源（通常是错误 404）以及`java.net.UnknownHostException`DNS 解析失败，则全部抛出；其他IOException对应传输过程中的错误。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-05-27T10:57:51.797

以下是使用 Java 代码从 Internet 下载电影的示例代码：

```
URL url = new
URL("http://103.66.178.220/ftp/HDD2/Hindi%20Movies/2018/Hichki%202018.mkv");
    BufferedInputStream bufferedInputStream = new  BufferedInputStream(url.openStream());
    FileOutputStream stream = new FileOutputStream("/home/sachin/Desktop/test.mkv");

    int count = 0;
    byte[] b1 = new byte[100];

    while((count = bufferedInputStream.read(b1)) != -1) {
        System.out.println("b1:" + b1 + ">>" + count + ">> KB downloaded:" + new File("/home/sachin/Desktop/test.mkv").length()/1024);
        stream.write(b1, 0, count);
    } 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-08-19T21:25:10.200

简单使用存在问题：

```
org.apache.commons.io.FileUtils.copyURLToFile(URL, File) 
```

如果您需要下载和保存非常大的文件，或者一般情况下如果您需要在连接断开时自动重试。

在这种情况下，我建议使用 Apache HttpClient 以及 org.apache.commons.io.FileUtils。例如：

```
GetMethod method = new GetMethod(resource_url);
try {
    int statusCode = client.executeMethod(method);
    if (statusCode != HttpStatus.SC_OK) {
        logger.error("Get method failed: " + method.getStatusLine());
    }
    org.apache.commons.io.FileUtils.copyInputStreamToFile(
        method.getResponseBodyAsStream(), new File(resource_file));
    } catch (HttpException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
    method.releaseConnection();
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-07-12T20:25:02.903

[您可以使用netloader for Java](https://github.com/intlink/netloader)在一行中执行此操作：

```
new NetFile(new File("my/zips/1.zip"), "https://example.com/example.zip", -1).load(); // Returns true if succeed, otherwise false. 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-01-28T09:59:56.540

这可以读取Internet上的文件并将其写入文件。

```
import java.net.URL;
import java.io.FileOutputStream;
import java.io.File;

public class Download {
    public static void main(String[] args) throws Exception {
         URL url = new URL("https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png");  // Input URL
         FileOutputStream out = new FileOutputStream(new File("out.png"));  // Output file
         out.write(url.openStream().readAllBytes());
         out.close();
    }
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-05-15T17:31:05.257

java.net.http.HttpClient 上使用授权的解决方案：

```
HttpClient client = HttpClient.newHttpClient();

HttpRequest request = HttpRequest.newBuilder()
        .GET()
        .header("Accept", "application/json")
        // .header("Authorization", "Basic ci5raG9kemhhZXY6NDdiYdfjlmNUM=") if you need
        .uri(URI.create("https://jira.google.ru/secure/attachment/234096/screenshot-1.png"))
        .build();

HttpResponse<InputStream> response = client.send(request, HttpResponse.BodyHandlers.ofInputStream());

try (InputStream in = response.body()) {
    Files.copy(in, Paths.get(target + "screenshot-1.png"), StandardCopyOption.REPLACE_EXISTING);
} 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2017-11-16T11:36:51.113

如果您在代理后面，您可以在 Java 程序中设置代理，如下所示：

```
Properties systemSettings = System.getProperties();
systemSettings.put("proxySet", "true");
systemSettings.put("https.proxyHost", "HTTPS proxy of your org");
systemSettings.put("https.proxyPort", "8080"); 
```

如果您不在代理后面，请不要在代码中包含上面的行。当您在代理后面时下载文件的完整工作代码。

```
public static void main(String[] args) throws IOException {
    String url = "https://raw.githubusercontent.com/bpjoshi/fxservice/master/src/test/java/com/bpjoshi/fxservice/api/TradeControllerTest.java";
    OutputStream outStream = null;
    URLConnection connection = null;
    InputStream is = null;
    File targetFile = null;
    URL server = null;

    // Setting up proxies
    Properties systemSettings = System.getProperties();
        systemSettings.put("proxySet", "true");
        systemSettings.put("https.proxyHost", "HTTPS proxy of my organisation");
        systemSettings.put("https.proxyPort", "8080");
        // The same way we could also set proxy for HTTP
        System.setProperty("java.net.useSystemProxies", "true");
        // Code to fetch file
    try {
        server = new URL(url);
        connection = server.openConnection();
        is = connection.getInputStream();
        byte[] buffer = new byte[is.available()];
        is.read(buffer);

        targetFile = new File("src/main/resources/targetFile.java");
        outStream = new FileOutputStream(targetFile);
        outStream.write(buffer);
    } catch (MalformedURLException e) {
        System.out.println("THE URL IS NOT CORRECT ");
        e.printStackTrace();
    } catch (IOException e) {
        System.out.println("I/O exception");
        e.printStackTrace();
    }
    finally{
        if(outStream != null)
            outStream.close();
    }
} 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2020-05-30T22:04:55.157

使用新渠道的第一种方法

```
ReadableByteChannel aq = Channels.newChannel(new url("https//asd/abc.txt").openStream());
FileOutputStream fileOS = new FileOutputStream("C:Users/local/abc.txt")
FileChannel writech = fileOS.getChannel(); 
```

使用 FileUtils 的第二种方法

```
FileUtils.copyURLToFile(new url("https//asd/abc.txt", new local file on system("C":/Users/system/abc.txt")); 
```

第三种方法使用

```
InputStream xy = new ("https//asd/abc.txt").openStream(); 
```

这就是我们可以使用基本 Java 代码和其他第三方库下载文件的方式。这些仅供快速参考。请使用上述关键字谷歌以获取详细信息和其他选项。

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2017-07-01T19:52:59.707

```
public class DownloadManager {

    static String urls = "[WEBSITE NAME]";

    public static void main(String[] args) throws IOException{
        URL url = verify(urls);
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        InputStream in = null;
        String filename = url.getFile();
        filename = filename.substring(filename.lastIndexOf('/') + 1);
        FileOutputStream out = new FileOutputStream("C:\\Java2_programiranje/Network/DownloadTest1/Project/Output" + File.separator + filename);
        in = connection.getInputStream();
        int read = -1;
        byte[] buffer = new byte[4096];
        while((read = in.read(buffer)) != -1){
            out.write(buffer, 0, read);
            System.out.println("[SYSTEM/INFO]: Downloading file...");
        }
        in.close();
        out.close();
        System.out.println("[SYSTEM/INFO]: File Downloaded!");
    }
    private static URL verify(String url){
        if(!url.toLowerCase().startsWith("http://")) {
            return null;
        }
        URL verifyUrl = null;

        try{
            verifyUrl = new URL(url);
        }catch(Exception e){
            e.printStackTrace();
        }
        return verifyUrl;
    }
} 
```

# reporting-services - Reporting Services 2008 是否支持单个对象的多个数据源？

> ID：921265
> 
> 赞同：2
> 
> 时间：2009-05-28T14:54:18.267
> 
> 标签：reporting-services, datasource, ssrs-2008

即您可以在一个表中拥有多个数据源，或者如果您想要该功能，您还需要使用子报表吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:00:20.207

我最近在 SSRS 2008 中开发了几个新的类似仪表板的报表，我不得不使用子报表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-12T09:56:37.180

不

[http://blogs.technet.com/sqlman/archive/2009/03/01/reporting-services-combining-different-datasets-to-be-displayed-in-a-single-table-in-ssrs.aspx](http://blogs.technet.com/sqlman/archive/2009/03/01/reporting-services-combining-different-datasets-to-be-displayed-in-a-single-table-in-ssrs.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T16:41:51.950

您可以在报告定义级别指定多个数据源。您的桌子可以使用所有这些。

# .net - 如何比较在 SSIS 包中转换的两个表的数据

> ID：921268
> 
> 赞同：0
> 
> 时间：2009-05-28T14:55:26.907
> 
> 标签：.net, ssis, ironpython

一个表已被 ETLed 到另一个表。我的任务是以编程方式验证两个表之间的数据。

我现在面临的困难之一是：如何使用我可以从派生列任务中获得的表达式并与源和目标进行验证。或者换句话说，我如何使用表达式在代码中工作。

任何想法....高度赞赏

萨加尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-05T14:32:28.513

设置一列，其中包含每行的 CHECKSUM()。在两个表之间进行左外连接。如果右侧有任何空值，则说明有问题。

# c# - 自定义列表共享点的验证

> ID：921271
> 
> 赞同：1
> 
> 时间：2009-05-28T14:55:32.990
> 
> 标签：c#, sharepoint

我已经创建了一个自定义列表作为 sharepoint 中的一项功能。

我需要对某些字段进行一些验证。我创建了一个继承自 SPItemEventReceiver 的类

并且需要实现方法：

```
public override void ItemAdding(SPItemEventProperties properties) 
```

我该从哪里拿走它？我如何访问列表项等...

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T15:06:51.707

有很多关于这方面的样本。比如[这个](http://www.davehunter.co.uk/Blog/Lists/Posts/Post.aspx?List=f0e16a1a-6fa9-4130-bcab-baeb97ccc4ff&ID=116)。

它使用以下代码片段验证电子邮件列：

```
public override void ItemAdding(SPItemEventProperties properties)
{
    base.ItemAdding(properties);

    // only perform if we have an Email column
    if (properties.AfterProperties["Email"] != null)
    {
        // test to see if the email is valid
        if (!IsValidEmailAddress(properties.AfterProperties["Email"].ToString()))
        {
            // email validation failed, so display an error
            properties.Status = SPEventReceiverStatus.CancelWithError;
            properties.Cancel = true;
            properties.ErrorMessage = "Please enter a valid email address";

        }
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T17:22:16.010

这是一个不错的选择：

SharePoint 中的正则表达式字段验证 .. www.codeplex.com/SharePointRegEx

它是一个自定义字段，允许添加正则表达式来验证用户输入的值。它还有一个“错误消息”字段。

# wpf - CS2000：编译器初始化意外失败

> ID：921276
> 
> 赞同：1
> 
> 时间：2009-05-28T14:56:13.333
> 
> 标签：wpf, .net-3.5, xml-serialization

我有一个 WPF .NET 3.5 SP1 应用程序，此时至少有数百台（如果不是数千台）机器正在使用它。应用程序在启动时加载的 XML 中存储一个树结构。当我尝试通过序列化加载 xml 时，轰隆隆。它只发生在一台最终用户机器上。他拥有管理员权限、充足的磁盘空间、内存等。

在我将其视为机器问题或防病毒/间谍软件并让他的 IT 部门参与（一个艰苦的过程）之前，我想看看是否有更好的方法来追踪它并获取更多信息。由于 XmlSerialization 是黑盒式的，我不确定作为开发人员我还能做更多的事情。或者我可以吗？

任何提示表示赞赏，下面的完整错误。

> 无法生成临时类（结果=1）。错误 CS2000：编译器初始化意外失败 - '没有足够的存储空间来完成此操作。'

```
Stack Trace: 

   at System.Xml.Serialization.Compiler.Compile(Assembly parent, String ns, XmlSerializerCompilerParameters xmlParameters, Evidence evidence)
   at System.Xml.Serialization.TempAssembly.GenerateAssembly(XmlMapping[] xmlMappings, Type[] types, String defaultNamespace, Evidence evidence, XmlSerializerCompilerParameters parameters, Assembly assembly, Hashtable assemblies)
   at System.Xml.Serialization.TempAssembly..ctor(XmlMapping[] xmlMappings, Type[] types, String defaultNamespace, String location, Evidence evidence)
   at System.Xml.Serialization.XmlSerializer.GenerateTempAssembly(XmlMapping xmlMapping, Type type, String defaultNamespace)
   at System.Xml.Serialization.XmlSerializer..ctor(Type type, String defaultNamespace)
   at System.Xml.Serialization.XmlSerializer..ctor(Type type)
   at Internal.Objects.TreeSetItemManager.LoadTreeItems(String fileName) in TreeSetItemManager.cs:line 41
   at SPA.Windows.MasterWindow.OnInitialized(EventArgs e)
5/28/2009 10:16:20 Message:
External component has thrown an exception.Details:
   at MS.Win32.UnsafeNativeMethods.ITfThreadMgr.Activate(Int32& clientId)
   at System.Windows.Input.TextServicesContext.RegisterTextStore(DefaultTextStore defaultTextStore)
   at System.Windows.Input.DefaultTextStore.get_Current()
   at System.Windows.Input.TextServicesContext.SetFocusOnDefaultTextStore()
   at System.Windows.Input.InputMethod.EnableOrDisableInputMethod(Boolean bEnabled)
   at System.Windows.Input.TextServicesManager.Focus(DependencyObject focus)
   at System.Windows.Input.KeyboardDevice.ChangeFocus(DependencyObject focus, Int32 timestamp)
   at System.Windows.Input.KeyboardDevice.TryChangeFocus(DependencyObject newFocus, IKeyboardInputProvider keyboardInputProvider, Boolean askOld, Boolean askNew, Boolean forceToNullIfFailed)
   at System.Windows.Input.KeyboardDevice.Focus(DependencyObject focus, Boolean askOld, Boolean askNew)
   at System.Windows.Input.KeyboardDevice.Focus(IInputElement element)
   at System.Windows.Interop.HwndKeyboardInputProvider.FilterMessage(IntPtr hwnd, Int32 message, IntPtr wParam, IntPtr lParam, Boolean& handled)
   at System.Windows.Interop.HwndSource.InputFilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
   at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
   at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)
   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:43:28.187

即使他有管理员权限，%TEMP% 指向那台机器的哪个位置？您可以在那里手动创建/删除文件吗？

其次，与后续机器相比，故障机器中有多少内存？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-06T01:05:39.573

您可以尝试预先生成 XML 序列化程序集（使用 sgen.exe 或使用项目属性的“构建”窗格中的选项）并与您的应用程序一起发布它们。这样，它们就不需要在运行时生成，而且你不会得到那个异常

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-09T02:37:11.330

[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/s8a9yf84.aspx)说您应该修复或重新安装 .NET Framework SDK。你可以试试看它是否有帮助？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-29T21:26:28.573

更新。

该问题最终与 Cisco 的安全代理软件和 Xenocode 执行的混淆处理发生冲突。如果从等式中删除其中一个或另一个，则不会发生异常。我也尝试了很多方法来解决它，但无济于事。因此，我对 Xenocode 进行了查询（与 Cisco 的交流完全是浪费时间）。也许他们可以了解正在发生的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T15:48:28.903

提示：我们在使用 .NET 编译转换的 XSLT 中遇到了类似的 msxsl:script 标记问题。请注意，您报告的错误发生在序列化程序的编译方法中。

您已检查磁盘空间和权限，但进程用户可能不是管理员，例如 asp.net 进程。

警告：使用 msxsl:script 时，Microsoft .NET XslCompiledTransform 类会导致几个问题。XslCompiledTransform 在临时文件夹中创建一个 DLL 并将其锁定在内存中。

1.  ASP.NET 进程可能无权访问临时文件夹，XSLT 将失败。
2.  临时 DLL 不是临时的，而是保留在文件夹中：每个使用 msxsl:script 的转换都有一个 DLL。最终，服务器的硬盘驱动器被填满。
3.  DLL 被锁定在内存中，导致严重的内存泄漏。

不要将 msxsl:script 与 Microsoft .NET XslCompiledTransform 类一起使用。相反，使用扩展对象在 XSLT 之外调用 C# 或 VB.NET 方法。请参阅 Microsoft 关于 [XSLT Extension Objects](http://msdn.microsoft.com/en-us/library/tf741884.aspx)的文档。

( [http://dev.ektron.com/kb_article.aspx?id=482](http://dev.ektron.com/kb_article.aspx?id=482) )

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-06T01:19:37.003

鉴于错误消息指出“没有足够的存储空间来完成此操作。”，我猜问题不是因为具有 XML 文件的位置空间不足或没有权限。我的猜测是，临时程序集的中间文件被删除的临时位置实际上是导致问题的原因。

.NET 中的 XmlSerialization 使用代码生成来创建 C# 源代码，然后对其进行编译（最终使用 CSharpCodeProvider，它是 CodeDom 的一部分。）CodeDom 编译源代码与命令行 csc.exe 编译器非常相似，因此通常是临时的中间目标文件需要在生成最终程序集之前在磁盘上创建（不管它是否是内存中的程序集。）

我会弄清楚这些临时文件的放置位置，并确保驱动器有足够的空间。确保有问题的用户在生成这些临时文件的地方也没有任何类型的空间配额，就好像他已经使用了他的配额一样，这也可能导致存储空间异常。这些文件的临时位置可通过应用程序 .config 文件中的 XmlSerializerSection 进行配置，因此如果确实存在空间问题，您可以尝试将它们临时重定向到有足够空间的驱动器（以及读取/写入/删除权限）当前用户。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-06T20:45:07.597

一些调查表明，通过“存储”，系统指的是进程的*内存*而不是磁盘空间。

鉴于 XmlSerializer 将从 C# 代码在内存中创建程序集，看起来这可能是一个开始的地方。一些需要调查的事情可能包括：

*   XML 对象图是否很大？（我承认，如果是问题所在的序列化而不是反序列化，这更有可能是一个问题......）
*   这个工作站的内存配置有什么异常吗？是否有许多其他进程正在运行、没有剩余的虚拟内存或其他一些异常压力？

在任何情况下，+1 建议预编译 XML，如果这是必须要走的预设配置样式数据。

# .net - WinForms中的Control vs UserControl？

> ID：921278
> 
> 赞同：34
> 
> 时间：2009-05-28T14:56:25.063
> 
> 标签：.net, winforms, user-controls, controls

.NET WinForms 中的 Control 和 UserControl 有什么区别？我想创建一个自定义控件，但我应该从哪个继承？我过去一直使用 Control 没有任何问题，但是创建自定义控件的“推荐”方式是什么？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-28T15:07:48.927

这是一篇关于这个问题的好文章。[用户控制](http://www.akadia.com/services/dotnet_user_controls.html)

然而简而言之

控件要么是继承的，要么是完全自定义的。您自己编写和处理许多事件。您甚至可以通过使用 GDI+ 绘图来控制绘制控件的方式和时间。

UserControl 是一组控件，这些控件放在一起以某种方式使用。例如，您可以放置​​一个包含文本框、复选框等的 GroupBox。当您必须在多个表单或选项卡上/中放置同一组控件时，这很有用。注意：您也可以为 UserControls 编写一些自定义事件和绘图。

# sql - 尴尬的 DAO 字符串操作问题

> ID：921281
> 
> 赞同：3
> 
> 时间：2009-05-28T14:56:33.083
> 
> 标签：sql, ms-access, dao

我正在使用旧版 vb6 产品，我遇到了一个问题，即我需要通过 DAO 从数据库表中获取完整路径的文件名部分。我在这里无法访问 VBA 函数，所以我专门寻找 MS Access SQL。我无法在查询后删除一些额外的代码。除了修改 SQL，我**无法**更改/重构解决方案。

现在，DAO 没有任何功能`instrrev`或`replace`功能，所以我非常有限。

有什么猜测吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T15:59:11.757

您应该能够使用内置的 vba 函数，如`instr`, `replace`,`mid`等。

有一个“沙盒”模式可能会阻止它们 - 请参阅如何取消阻止它们[http://support.microsoft.com/kb/294698](http://support.microsoft.com/kb/294698)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:08:43.343

假设您无法更改实际的数据库。. .

我能想到的唯一一件事（我在这个问题上被大脑破坏了，对不起，伙计）是使用重复调用 instr，嵌套在 iif 语句中，例如替换对 inStrRev 的调用

```
SELECT IIf(InStr([FileName],""\"")>0,Mid$([Filename],InStrRev([Filename],""\"")+1),[Filename]) FROM Table1 
```

你会有一个完全疯狂的

```
SELECT IIf(InStr([FileName],""\"")>0,Mid$([Filename],iif(InStr(1, [FileName], ""\"") > 0, iif(InStr(2, [FileName], ""\"") > 0, iif(InStr(3, [FileName], ""\"") > 0, iif(InStr(4, [FileName], ""\"") > 0, iif(InStr(5, [FileName], ""\"") > 0, iif(InStr(6, [FileName], ""\"") > 0, iif(InStr(7, [FileName], ""\"") > 0, iif(InStr(8, [FileName], ""\"") > 0, iif(InStr(9, [FileName], ""\"") > 0, 1, InStr(9, [FileName], ""\"")), InStr(8, [FileName], ""\"")), InStr(7, [FileName], ""\"")), InStr(6, [FileName], ""\"")), InStr(5, [FileName], ""\"")), InStr(4, [FileName], ""\"")), InStr(3, [FileName], ""\"")), InStr(2, [FileName], ""\"")), InStr(1, [FileName], ""\""))),[Filename]) from table1 
```

这适用于深度为 10 个左右子文件夹的路径。如果您认为 10 个子文件夹太少，我有一点 vba 来生成您需要的任何深度的语句。

```
Function BuildNestedIIfs(ByVal depth As Integer, byval maxDepth as integer) As String
    Dim locator As String
    If depth < maxDepth Then
        locator = "InStr(" & depth & ", [FileName], """"\"""")"
        Build = "iif(" & locator & " > 0, " & Build(depth + 1, maxDepth) & ", " & locator & ")"
    Else
       Build = "0"
    End If
End Function 
```

这是淫秽的，但应该工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:47:30.670

我曾经做过很多 DAO 编程，但那是 10 到 15 年前...

您可以更改 DAO 以调用 Access QueryDef 然后在那里修复它吗？

# sql - 比较 T-SQL Between 和 '<' '>' 运算符的性能差异？

> ID：921282
> 
> 赞同：19
> 
> 时间：2009-05-28T14:56:38.620
> 
> 标签：sql, sql-server, performance

我已经尝试通过搜索引擎、MSDN 等进行搜索。但什么也做不了。抱歉，如果之前有人问过这个问题。使用 T-SQL“Between”关键字或使用比较运算符之间是否存在性能差异？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-28T14:58:31.270

您可以通过在这两种情况下检查查询计划来轻松地检查这一点。我知道这没有区别。BETWEEN 和“<”和“>”之间存在逻辑差异...... BETWEEN 是包容性的。它相当于“<=”和“=>”。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-08T01:11:19.473

`>=`查询引擎在和之间转换`<=`（看看查询计划），所以在实践中它们是相同的，理论上`>= <=`更快，因为引擎不必翻译。祝你好运，但注意到不同之处。

无论如何我都在使用，我发现它更容易阅读

具有大量比较的非常复杂的查询/嵌套视图可能会受益于更改为`>= <=`，因为这可能会通过减少重构查询所花费的时间来防止优化超时（只是一个理论，未经我测试，我从未注意到它）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-27T04:34:28.003

当人们给代码做你自己的测试时，你需要做一个更大的子集/重复测试来解释被加载到内存中的索引，等等......在得出结论之前。这是具有更大表和 10 次迭代的相同代码

```
DECLARE
    @Startdatetime datetime ,
    @Diff int = 0 ,
    @Addrowcount int = 1000 ,
    @ptr int = 1;

SET NOCOUNT ON;

--Create a tempory table to perform our tests on
DROP TABLE dbo.perftest

CREATE TABLE dbo.perftest( id int NOT NULL
                                       IDENTITY(1 , 1)
                                       PRIMARY KEY ,
                           mytext nvarchar( 50 )NOT NULL );

--Now add some sample rows

SET @Addrowcount = 20000;

WHILE(@Addrowcount > 0)

    BEGIN

        INSERT INTO dbo.perftest( mytext )
        VALUES( 'thetext' );

        SET @Addrowcount = @Addrowcount - 1;

    END;

WHILE @ptr < 10 -- do this a few times to account for indexes being loaded into memory

BEGIN

    SELECT @Startdatetime = GETDATE();

    -- do method 1 here

    SELECT mytext
      FROM dbo.perftest
      WHERE(id >= (100 + (@ptr * 1000)))
       AND (id <= (500 + (@ptr * 1000)));

    --end method1

    SELECT @Diff = DATEDIFF( millisecond , @Startdatetime , GETDATE());

    PRINT ':Method 1: ' + CAST(@Diff AS nvarchar( 20 )) + ' ms';

    --reset start time

    SELECT @Startdatetime = GETDATE();

    --do method2 here

    SELECT mytext
      FROM dbo.perftest
      WHERE id BETWEEN (300 + (@ptr * 1000))
        AND (800 + (@ptr * 1000));

    --end method2

    SELECT @Diff = DATEDIFF( millisecond , @Startdatetime , GETDATE());

    PRINT ':Method 2: ' + CAST(@Diff AS nvarchar( 20 )) + ' ms';

    SET @ptr = @ptr + 1

END 
```

为您提供一组非常不同的结果：

```
--Method 1    -- 10 ms
--Method 2    -- 33 ms
--Method 1    -- 40 ms
--Method 2    -- 26 ms
--Method 1    -- 23 ms
--Method 2    -- 23 ms
--Method 1    -- 13 ms
--Method 2    -- 16 ms
--Method 1    -- 13 ms
--Method 2    -- 20 ms
--Method 1    -- 6 ms
--Method 2    -- 16 ms
--Method 1    -- 26 ms
--Method 2    -- 16 ms
--Method 1    -- 13 ms
--Method 2    -- 13 ms
--Method 1    -- 16 ms
--Method 2    -- 13 ms 
```

我会从这个（仍然非常不科学的）测试中说，无论哪种方式都没有太大区别。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T12:41:36.257

我还对使用 (>= 和 <=) 与使用 between 关键字时是否存在性能差异感兴趣。（我来自 dotnet 背景，喜欢 >= 样式运算符）。
这是我使用的脚本：

```
DECLARE
    @Startdatetime datetime ,
    @Diff int = 0 ,
    @Addrowcount int = 1000;

SET NOCOUNT ON;

--Create a tempory table to perform our tests on

CREATE TABLE dbo.perftest( id smallint NOT NULL
                                       IDENTITY(1 , 1)
                                       PRIMARY KEY ,
                           mytext nvarchar( 50 )NOT NULL );

--Now add some sample rows

SET @Addrowcount = 1000;

WHILE(@Addrowcount > 0)

    BEGIN

        INSERT INTO dbo.perftest( mytext )
        VALUES( 'thetext' );

        SET @Addrowcount = @Addrowcount - 1;

    END;

SELECT @Startdatetime = GETDATE();

-- do method 1 here

SELECT mytext
  FROM dbo.perftest
  WHERE(id >= 100)
   AND (id <= 900);

--end method1

SELECT @Diff = DATEDIFF( millisecond , @Startdatetime , GETDATE());

PRINT ':Method 1: ' + CAST(@Diff AS nvarchar( 20 )) + ' ms';

--reset start time

SELECT @Startdatetime = GETDATE();

--do method2 here

SELECT mytext
  FROM dbo.perftest
  WHERE id BETWEEN 100
    AND 900;

--end method2

SELECT @Diff = DATEDIFF( millisecond , @Startdatetime , GETDATE());

PRINT ':Method 2: ' + CAST(@Diff AS nvarchar( 20 )) + ' ms'; 
```

结果是：

> 方法一：140 毫秒
> 
> 方法 2：70 毫秒

因此，使用 between 似乎可以提高性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-09T22:09:17.423

实际上。我只是尝试使用我的一些数据进行验证。BETWEEN 等价于 ">=" 和 "<"。例如：在 '05/01/2010' 和 '05/30/2010' 之间：您只能在 5/1/2010 00:00:00 到 5/29/2010 23:59:59 之间获取数据。尝试使用“Order by [TimeField] desc”查询您的表，您将看到结果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T15:07:06.137

在这里相互比较的两个运算符根本不同，因此生成的执行计划也可能不同（尽管不能保证）。

决定因素是应用比较运算符的列的数据分布（选择性）。这与统计信息一起将决定是否使用索引等。

希望这是有道理的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-03T16:28:27.310

在更复杂的查询中，您无法事先知道要与之比较的最小值或最大值，那么使用 BETWEEN 几乎等同于使用 >= 和 <= 运算符。

但是，当您事先确切知道您的最小值和最大值是什么时，不使用 BETWEEN 运算符而是将所需结果与最小值以下的 1 个数字和最大值以上的 1 个数字进行比较会更便宜。

```
SELECT n.Number FROM dbo.Numbers AS n
WHERE n.Number BETWEEN 1 AND 100 
```

几乎等同于：

```
SELECT n.Number FROM dbo.Numbers AS n
WHERE n.Number >= 1 AND n.Number <= 100 
```

其中每一行分别针对 >、< 和 = 进行比较。

宁可这样做：

```
SELECT n.Number FROM dbo.Numbers AS n
WHERE n.Number > 0 AND n.Number < 101 
```

其中每一行仅针对 > 和 < 进行比较。

# javascript - 是否可以在 JavaScript 中克隆 html 元素对象？

> ID：921290
> 
> 赞同：118
> 
> 时间：2009-05-28T14:58:03.737
> 
> 标签：javascript, jquery

我在表格中有一个 html 元素（如选择框输入字段）。现在我想复制对象并从副本中生成一个新对象，并使用 JavaScript 或 jQuery。我认为这应该以某种方式起作用，但我现在有点无能为力。

像这样的东西（伪代码）：

```
oldDdl = $("#ddl_1").get(); 

newDdl = oldDdl;

oldDdl.attr('id', newId);

oldDdl.html(); 
```

* * *

## 回答 #1

> 赞同：311
> 
> 时间：2009-05-28T15:01:18.957

使用原生 JavaScript：

```
newelement = element.cloneNode(bool) 
```

其中布尔值指示是否克隆子节点。

[这是 MDN 上的完整文档](https://developer.mozilla.org/en-US/docs/Web/API/Node/cloneNode)。

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2009-05-28T14:59:21.737

使用您的代码，您可以使用[cloneNode()](https://developer.mozilla.org/en-US/docs/Web/API/Node/cloneNode)方法在纯 JavaScript 中执行以下操作：

```
// Create a clone of element with id ddl_1:
let clone = document.querySelector('#ddl_1').cloneNode( true );

// Change the id attribute of the newly created element:
clone.setAttribute( 'id', newId );

// Append the newly created element on element p 
document.querySelector('p').appendChild( clone ); 
```

或者使用 jQuery [clone()](http://docs.jquery.com/Manipulation/clone)方法（不是最有效的）：

```
$('#ddl_1').clone().attr('id', newId).appendTo('p'); // append to where you want 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-09-28T00:23:22.050

是的，您可以复制一个元素的子元素并将它们粘贴到另一个元素中：

```
var foo1 = jQuery('#foo1');
var foo2 = jQuery('#foo2');

foo1.html(foo2.children().clone()); 
```

证明：http: [//jsfiddle.net/de9kc/](http://jsfiddle.net/de9kc/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T15:00:16.790

在 jQuery 中实际上非常简单：

```
$("#ddl_1").clone().attr("id",newId).appendTo("body"); 
```

当然改变 .appendTo() ......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-28T00:45:18.297

您可以使用**clone()**方法创建一个副本..

```
$('#foo1').html( $('#foo2 > div').clone())​; 
```

[在这里提琴](http://jsfiddle.net/sushanth009/dYUUC/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-01-08T21:43:59.433

获取要克隆的元素的 HTML `.innerHTML`，然后通过`createElement()`...创建一个新对象

```
var html = document.getElementById('test').innerHTML;
var clone = document.createElement('span');
clone.innerHTML = html; 
```

通常，*clone() 函数必须由 cloner 编码或理解*。例如，让我们克隆这个：`<div>Hello, <span>name!</span></div>`. 如果我删除克隆的`<span>`标签，它是否也应该删除原始的跨度标签？如果两者都被删除，则对象引用被克隆；如果只删除一组，则对象引用是全新的实例化。在某些情况下，您需要一个，而在其他情况下，您需要另一个。

通常，在 HTML 中，您会希望克隆的任何内容在引用上都是独立的。确保正确包含这些新引用的最佳方法是在新元素中重新运行相同的 innerHTML 并让浏览器重新理解。比努力解决您的问题更好，您应该确切地知道它是如何进行克隆的......

**完整的工作演示：**

```
function cloneElement() {
    var html = document.getElementById('test').innerHTML;
    var clone = document.createElement('span');
    clone.innerHTML = html;
    document.getElementById('clones').appendChild(clone);
}
```

```
<span id="test">Hello!!!</span><br><br>

<span id="clones"></span><br><br>

<input type="button" onclick="cloneElement();" value="Click Here to Clone an Element">
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-28T00:30:27.343

试试这个：

```
$('#foo1').html($('#foo2').children().clone()); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-09-25T01:38:38.657

Vanilla JS 方法来处理你想要做的事情

```
const oldDdl = document.querySelector('#ddl_1');

const newDdl = oldDdl.cloneNode(true);

oldDdl.setAttribute('id','newId');

const oldDdlHtml = oldDdl.innerHTML; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-28T15:01:08.673

在一行中：

```
$('#selector').clone().attr('id','newid').appendTo('#newPlace'); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-09-28T00:33:37.610

您需要选择“#foo2”作为选择器。然后，使用 html() 获取它。

这是html：

```
<div id="foo1">

</div>
<div id="foo2">
    <div>Foo Here</div>
</div>​ 
```

这是javascript：

```
$("#foo2").click(function() {
    //alert("clicked");
    var value=$(this).html();
    $("#foo1").html(value);
});​ 
```

这是jsfiddle：http: [//jsfiddle.net/fritzdenim/DhCjf/](http://jsfiddle.net/fritzdenim/DhCjf/)

# iphone - 离线学习 iPhone 开发需要什么？

> ID：921297
> 
> 赞同：1
> 
> 时间：2009-05-28T14:58:42.283
> 
> 标签：iphone, offline

我有一个为期一周的假期，但没有“网络访问”。我有兴趣学习 iPhone 开发。为了完全离线学习和开发 iPhone 应用程序，我应该下载哪些应用程序、教程、文档等？在我仍然可以访问网络的情况下，我需要采取什么步骤来准备我的 iPhone 以加载应用程序吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T15:39:35.507

斯坦福 iPhone 编程课程是一个播客，下载后不需要网络访问（尽管您编写的一些示例程序需要）。

[CS193P - iPhone 编程](http://www.stanford.edu/class/cs193p/cgi-bin/index.php)

这是一个相当完整的介绍，当你完成后你将能够编写真正的程序，而且它可能比你在一周内合理吸收的内容更多。当前的课程内容是为 2.x SDK 编写的，所以不用担心 beta 3.0 的混乱。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-29T05:37:30.813

*您真正*需要的唯一东西是 Mac 和 SDK。如果您注册为开发人员，请下载 2.2.1 或更新的 3.0 测试版。2.2.1 版本非常适合继续学习，至少在您想开始上传应用程序之前是这样。确保通过订阅下载您需要的文档。点击Help->Documentation，在左侧可以看到文档集。如果您不确定，请单击订阅您想要的或全部。

[http://developer.apple.com/iphone/index.action](http://developer.apple.com/iphone/index.action)

您现在拥有开始学习所需的一切。如果您想尝试在 iPhone 上安装程序，您需要获得开发者证书并生成您的密钥。这很棘手，需要时间才能做好。如果您不想这样做，只需使用 SDK 中包含的 iPhone 模拟器即可。在您离开之前，从 developer.apple.com 站点下载 Hello World 程序并尝试在 SDK 中运行它。如果您可以“构建并运行”并查看 iPhone 模拟器，那么您应该已经设置好了。

如果您是 Objective-C 的新手，请阅读 Aaron Hillegass 的“Cocoa Programming for Mac OS X (3rd Edition)”。教学风格很棒，​​他很好地解释了基础知识。这本书的目标是桌面编程，但没有更好的 Objective-C 介绍。

[http://www.amazon.com/exec/obidos/ASIN/0321503619/](https://rads.stackoverflow.com/amzn/click/com/0321503619)

如果您需要更多特定于 iPhone 的内容，请阅读 Dave Mark 和 Jeff LaMarche 的“Beginning iPhone Development”。他们有非常深入的例子。教学风格不是很清晰，章节很长很复杂，但是很透彻。

[http://www.amazon.com/exec/obidos/ASIN/1430216263/](https://rads.stackoverflow.com/amzn/click/com/1430216263)

如果您需要另一本书，请从 Pragmatic Programmers 获取“iPhone SDK 开发”。这是一本测试版的书，所以会有一些错误，但风格更清晰，章节更容易消化。

[http://www.pragprog.com/titles/amiphd/iphone-sdk-development](http://www.pragprog.com/titles/amiphd/iphone-sdk-development)

这些书中的任何一本都将花费您超过一周的时间来消化，但它们是很好的起点。当您无法再阅读时，下载斯坦福播客也没有什么坏处，但它们不能作为独立的指南。不要忘记下载他们所有的 PDF 文件，其中有一些很棒的练习。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:02:07.673

请参阅我对这个问题的回答：

[https://stackoverflow.com/questions/332039/getting-started-with-iphone-development/332057#332057](https://stackoverflow.com/questions/332039/getting-started-with-iphone-development/332057#332057)

您的问题非常接近重复。

是的，您的手机必须设置为特定的开发模式。所有这些都在 SDK 文档中进行了解释。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T15:03:07.407

我会更新你的 SDK 和 iTunes/iPhone 固件。我还会下载教程的播客。最后，这里有一个很棒的[链接](http://www.stanford.edu/class/cs193p/cgi-bin/index.php)，指向您可以下载和使用的大量 PDF。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T15:11:32.430

1.  SDK 带有来自[http://developer.apple.com/iphone/index.action的文档](http://developer.apple.com/iphone/index.action)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-13T10:24:17.907

根据我的说法，roseindia 是一个很好的线下课程，但它非常昂贵，你可以去参加像 edumobile.org 这样的在线课程，这是一个很好的网站，因为它涵盖了你需要知道的所有基本概念，所以您可以毫无困难地为您的个人 iPhone 制作自己的应用程序。

# c# - 如何生成一个临时 Zip 文件，然后在下载后自动删除它？

> ID：921308
> 
> 赞同：5
> 
> 时间：2009-05-28T15:00:40.250
> 
> 标签：c#, asp.net, zip

我有一个下载页面，其中有 3 个下载选项：Word、Zip 和 PDF。有一个包含`.doc`文件的文件夹。当用户单击页面上的 Zip 选项时，我希望 ASP.NET 将包含文件的`.doc`文件夹压缩到一个临时`.zip`文件中。然后客户端将从服务器下载它。用户下载完成后，临时 Zip 文件应自行删除。

如何使用 ASP.NET 2.0 C# 做到这一点？

注意：我知道如何使用 C# ASP.NET 2.0 压缩和解压缩文件以及从系统中删除文件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-29T01:54:10.527

使用[DotNetZip](http://dotnetzip.codeplex.com)，您可以将 zip 文件直接保存到 Response.OutputStream。无需临时 Zip 文件。

```
 Response.Clear();
    // no buffering - allows large zip files to download as they are zipped
    Response.BufferOutput = false;
    String ReadmeText= "Dynamic content for a readme file...\n" + 
                       DateTime.Now.ToString("G");
    string archiveName= String.Format("archive-{0}.zip", 
                                      DateTime.Now.ToString("yyyy-MMM-dd-HHmmss")); 
    Response.ContentType = "application/zip";
    Response.AddHeader("content-disposition", "attachment; filename=" + archiveName);
    using (ZipFile zip = new ZipFile())
    {
        // add a file entry into the zip, using content from a string
        zip.AddFileFromString("Readme.txt", "", ReadmeText);
        // add the set of files to the zip
        zip.AddFiles(filesToInclude, "files");
        // compress and write the output to OutputStream
        zip.Save(Response.OutputStream);
    }
    Response.Flush(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-21T09:51:40.117

从数据库和 Zip 下载表格并下载 删除以在需要使用 ICSharpCode.SharpZipLib.Zip 的类中使用此代码

```
 if (ds.Tables[0].Rows.Count > 0)
            {
                // Create the ZIP file that will be downloaded. Need to name the file something unique ...
                string strNow = String.Format("{0:MMM-dd-yyyy_hh-mm-ss}", System.DateTime.Now);
                ZipOutputStream zipOS = new ZipOutputStream(File.Create(Server.MapPath("~/TempFile/") + strNow + ".zip"));
                zipOS.SetLevel(5); // ranges 0 to 9 ... 0 = no compression : 9 = max compression

                // Loop through the dataset to fill the zip file
                foreach (DataRow dr in ds.Tables[0].Rows)
                {
                    byte[] files = (byte[])(dr["Files"]);
                    //FileStream strim = new FileStream(Server.MapPath("~/TempFile/" + dr["FileName"]), FileMode.Create);
                    //strim.Write(files, 0, files.Length);
                    //strim.Close();
                    //strim.Dispose();
                    ZipEntry zipEntry = new ZipEntry(dr["FileName"].ToString());
                    zipOS.PutNextEntry(zipEntry);
                    zipOS.Write(files, 0, files.Length);
                }
                zipOS.Finish();
                zipOS.Close();

                FileInfo file = new FileInfo(Server.MapPath("~/TempFile/") + strNow + ".zip");
                if (file.Exists)
                {
                    Response.Clear();
                    Response.AddHeader("Content-Disposition", "attachment; filename=" + file.Name);
                    Response.AddHeader("Content-Length", file.Length.ToString());
                    Response.ContentType = "application/zip";
                    Response.WriteFile(file.FullName);
                    Response.Flush();
                    file.Delete();
                    Response.End();
                }
            } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:43:20.913

您需要手动将 zip 文件流式传输给用户，然后在流式传输完成后删除该文件。

```
try
{
    Response.WriteFile( "path to .zip" );
}
finally
{
    File.Delete( "path to .zip" );
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T22:08:31.463

我通过将其添加到流代码的末尾来解决我的问题：

```
Response.Flush();
Response.Close();
if(File.Exist(tempFile))
{File.Delete(tempFile)}; 
```

# asp.net - 寻求有关创建简单网站安装程序的建议

> ID：921311
> 
> 赞同：0
> 
> 时间：2009-05-28T15:00:49.173
> 
> 标签：asp.net, sql-server, installation

我只是把这个扔掉，以征求社区的意见。

我们正在为一个 Web 应用程序创建一个安装程序，它将安装我们的 Web 应用程序并提供一个数据库。数据库可以在 Web 服务器或远程计算机上。我们还将为用户提供指向现有数据库的选项。安装程序将通过允许用户在每个 Web 服务器上安装解决方案并仅指向现有数据库来启用 Web 场部署。

但是，此安装程序针对的是非技术人员。因此，我们正努力使其尽可能简单，但也适应任何环境差异（网站、虚拟目录、数据库位置等）。

有没有人对创建一个 esy 非技术安装程序有任何想法，它也允许可能需要的灵活性？

我们应该强迫用户选择一个现有的网站还是创建一个新的网站？
我们是否只是假设网站存在并安装在虚拟目录中？我们应该检查什么样的 pre-req 检查？该应用程序依赖于 ASP.NET 3.5 和 SQL 2005/2008。
如果 pre-req 检查失败，应用程序是否会失败？等等等等

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T20:26:54.617

您可以提供“默认安装”和“自定义安装”。

默认将是设置它所需的最低用户输入，并且使用自定义，您可以提供上面提到的每一个选项。理想情况下，您希望非技术用户只需单击“完成”。（即默认使用提供的 sql db 在 localhost 上创建新网站）

至于检查要求，是的，如果找不到先决条件，安装应该会失败。我认为你在那里越具体和详细，你在路上就会越好。如果您可以提供详细的错误消息，甚至可以在用户想要报告错误时让应用程序打电话回家，这将使问题的故障排除变得更加容易。

您检查的先决条件类型取决于他们选择的选项。验证网站是否存在，框架版本是否正确，sql版本是否正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T20:52:02.303

需要考虑的先决条件检查

1.  Windows 版本和 IIS 存在
    据我所知，ASP.NET 依赖于 IIS，只要安装了它，它就可以在 XP Pro 或 Server 版本的 Windows 上运行
2.  用户组
    运行安装程序的用户必须有足够的权限来配置 Web 服务器。
3.  已安装所需版本的 .NET Framework，并且将站点配置为使用该版本的 ASP.NET
4.  安装了所需的数据库服务器，并且用于访问服务器的凭据具有创建和/或附加数据库所需的权限。可能是用户将有权配置 IIS，但不能配置数据库，

# sql - SQL 更新语句构造——对效率的影响

> ID：921313
> 
> 赞同：1
> 
> 时间：2009-05-28T15:01:02.717
> 
> 标签：sql, rdbms

如果您向 RDBMS 提交更新语句，其中 column_name = value 映射的顺序与文件的物理布局不匹配，它是否会影响（理论上）更新操作的效率？

我主要是出于好奇而问，我很清楚这可能影响不大。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T15:03:43.163

如果您的数据库引擎太差以至于无法在这种情况下优化更新，那么您肯定会担心更严重的问题：-(。IOW，*最好*没有效果-这是实现质量的问题DB引擎，但它是如此微不足道，如果不是这样，我会感到震惊和惊讶。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:23:37.927

不。

但是，您可以采取一些措施来提高 UPDATE 效率，包括仅更新需要更新的行和列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:28:51.257

我可以说，在 SQL Server 和 Oracle 中，这是在“执行计划”阶段“计划出来的”，并且在更改参数顺序时您不会注意到性能变化。我无法与其他一些“较少企业”数据库（SqlLite、Firebird、Pervasive）交谈，但我希望所有数据库在将 SQL 语句解析为数据库操作时都会执行这些步骤。

# sql - 如何使列允许空序列或唯一序列

> ID：921318
> 
> 赞同：3
> 
> 时间：2009-05-28T15:01:44.133
> 
> 标签：sql, sql-server

我已经看到了一些网络搜索和对此的回应，但似乎它们都涉及视图。

如何调整列以使其仅允许 NULL 或唯一值？

在我的例子中，有一个包含库存项目的表，其中只有服务器项目有一个序列号。其余为空。我想对输入相同的连续剧实施某种控制。

此外，我无法重新设计架构，因为我正在为仍然存在的站点编写新的前端。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T15:07:09.067

在 MySQL 中，`UNIQUE`也可以为空的列允许任意数量的空值（在所有引擎中）。因此，如果您使用的是 MySQL，只需将 UNIQUE 约束添加到感兴趣的列。这种行为是 SQL 标准，也受 PostgreSQL 和 SQLite 支持（显然 Oracle 仅用于单列`UNIQUE`约束，尽管我无法确认这一点）。

但是，这种 SQL 标准行为不一定适用于所有其他 RDBMS 引擎，例如 SQL Server 或 DB2；如果您指定需要支持的引擎，我们可能会提供更具体的建议。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T15:07:30.253

`SQL Server`允许创建`UNIQUE`接受`NULL`值的索引，尽管这需要一些技巧。

创建一个仅选择非`NULL`列的视图并`UNIQUE INDEX`在视图上创建：

```
CREATE VIEW myview
AS
SELECT  *
FROM    mytable
WHERE   mycolumn IS NOT NULL

CREATE UNIQUE INDEX ux_myview_mycolumn ON myview (mycolumn) 
```

请注意，您需要在视图而不是表上执行`INSERT`'s 和's。`UPDATE`

您可以使用`INSTEAD OF`触发器来执行此操作：

```
CREATE TRIGGER trg_mytable_insert ON mytable
INSTEAD OF INSERT
AS
BEGIN
        INSERT
        INTO    myview
        SELECT  *
        FROM    inserted
END 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T15:28:37.900

如果您使用的是 MS SQL Server **2008**，那么您可以使用过滤的唯一索引来实现此目的。请查看[此论坛主题](http://www.dbforums.com/microsoft-sql-server/1634254-unique-where-not-null.html)以了解详细信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T15:06:37.337

你能从前端验证吗？在插入或提交数据之前，请确保它是唯一的或 NULL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T15:09:04.930

你可以用触发器来代替......

索引列但没有唯一约束 允许空值 在表上粘贴一个触发器，在 INSERT 和 UPDATE 上检查您尝试插入的列值是 NULL 还是表中不存在

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T15:09:08.953

我不知道您使用的是什么数据库，但是在 Postgres 中，您可以定义一个“插入或更新之前”触发器，该触发器可以返回一个特殊值来拒绝插入。如果没有本地方法来执行此操作，您可以使用它在您的表上强制执行这样的约束。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T15:10:45.003

这是什么平台？

对于 SQL Server，请参阅此[博客文章](http://blogs.msdn.com/sqlcat/archive/2005/12/20/506138.aspx)，其中展示了一种使用索引视图的技术。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-08T08:34:29.690

对于 Sql Server 2008，这里是由 MattB 链接的过滤索引解决方案的副本。我写在这里是为了确保人们不会错过它：

```
CREATE UNIQUE NONCLUSTERED INDEX [UniqueExceptNulls]
ON [Customers] (SSN)
WHERE [SSN] IS NOT NULL 
```

# java - 搜索 unicode 字符串

> ID：921319
> 
> 赞同：0
> 
> 时间：2009-05-28T15:01:47.847
> 
> 标签：java, string, unicode, encoding, comparison

我正在一个将 unicode 字符串作为输入的应用程序中工作。我成功地获得了作为列表的单词集。现在我需要在列表中的给定字符串集中搜索输入字符串。我试图将给定的字符串与列表中的每个字符串进行比较，但只获取无法识别的字符作为输出。我认为问题在于 unicode 处理。有没有合适的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:27:16.937

Java 使用 unicode（字符串在内部是 UTF-16，但处理所有 Unicode，有关更多信息，请参阅[API](http://java.sun.com/javase/6/docs/api/java/lang/Character.html#unicode)）。如果您遇到“无法识别的字符”问题，您可能读取了错误编码的输入或以错误的方式存储。

如果没有给出任何源代码，就无法提供更具体的帮助，抱歉。

# silverlight - 如何使 Silverlight 自定义控件的属性数据可绑定？

> ID：921321
> 
> 赞同：3
> 
> 时间：2009-05-28T15:01:51.183
> 
> 标签：silverlight, data-binding, controls

我创建了一个自定义的 silverlight 控件，它由两个日期选择器和一个组合框组成。我想让组合框数据可绑定，并且我知道我需要使用 DependencyProperty。我不确定的是如何构建它。这是我拥有的代码：

```
#region ItemsSource (DependencyProperty)

    /// <summary>
    /// ItemsSource to bind to the ComboBox
    /// </summary>
    public IList ItemsSource
    {
        get { return (IList)GetValue(ItemsSourceProperty); }
        set { SetValue(ItemsSourceProperty, value); }
    }
    public static readonly DependencyProperty ItemsSourceProperty =
        DependencyProperty.Register("ItemsSource", typeof(int), typeof(DateRangeControl),
          new PropertyMetadata(0));

    #endregion 
```

问题是我看到的所有示例都是针对文本或背景等简单属性的，它们需要字符串、整数或颜色。由于我试图绑定到组合框 ItemsSource，它需要一个 IEnumerable，我不知道如何为此构建属性。我使用了 IList。

有人可以让我知道我是否走在正确的道路上并给我一些指示吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T11:21:54.983

我发现您发布的代码有问题。实例访问者和你注册 DP 时定义的类型需要一致。如果您将 typeof(int) 更改为 typeof(IList)，您现有的代码应该可以工作。

但通常最好的做法是使用满足属性要求的最低级别的类型。基于此，如果您想创建集合属性，请使用 IEnumerable，除非您确实需要 IList 提供的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T00:27:07.580

你不能只用这个吗？

```
 public IEnumerable ItemsSource
    {
        get
        {
            return (IEnumerable)GetValue(ItemsSourceProperty);
        }
        set
        {
            SetValue(ItemsSourceProperty, value);
        }
    }

    public static readonly DependencyProperty ItemsSourceProperty = DependencyProperty.Register("ItemsSource", typeof(IEnumerable), typeof(DateRangeControl), new PropertyMetadata(null)); 
```

IEnumerable 可以在 System.Collections.Generic 中找到

# java - Java 使用 BeanBinding Netbeans 更新 JList

> ID：921324
> 
> 赞同：3
> 
> 时间：2009-05-28T15:02:41.137
> 
> 标签：java, netbeans, binding, jlist, classcastexception

我在 JFrame 中有这个 JList（比如 MyList）。我正在使用 Netbeans6 GUI 构建器，并为此列表设置了绑定。

运行时，绑定工作正常，并且 MyList 已正确填充。

现在，我正在寻找一种从按钮单击上的另一个文本框中向此列表添加更多数据的方法。但是这里存在问题：

没有绑定我将使用“getModel()”函数为 JList 提取 ListModel，并使用“addElement()”向其中添加元素。

但是，当我使用绑定时。我尝试提取 ListModel 并将其映射到 DefaultListModel 我得到以下异常：

```
Exception in thread "AWT-EventQueue-0" java.lang.ClassCastException: org.jdesktop.swingbinding.JListBinding$BindingListModel cannot be cast to javax.swing.DefaultListModel 
```

所以我的问题是，如何向已经绑定到其他数据源的 MyList 添加更多元素？

有人有任何线索吗？任何帮助将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-03T13:19:01.700

您必须修改 JList 绑定到的 List。并且这个 List 必须是一个 Observable 列表才能注册更改。绑定的要点是您不再操作组件的模型，而是操作它们的底层数据类型。

# unit-testing - NUnit中的执行顺序是什么？

> ID：921332
> 
> 赞同：15
> 
> 时间：2009-05-28T15:04:16.750
> 
> 标签：unit-testing, nunit

我一直在做一些关于测试驱动开发的研究，发现它很酷。

我遇到的一件事是，当您编写测试时，您的设置和测试方法（[Setup] 和 [Test]）有一个执行顺序。

您在测试时是否可以使用其他方法，如果是，它们的执行顺序是什么，例如 dispose 之类的？我看到了测试夹具设置，但对那个不太熟悉。

例子：

当我运行测试时，它首先执行[Setup]，然后运行[Test]，当它进入下一个测试时，它再次运行[Setup]，然后进入[Test]。

如果有帮助，我正在使用 NUnit。

这是我设置的截断示例：

```
using NUnit.Framework;

    namespace TestingProject
    {
        [TestFixture]
        public class CustomerService_Tests
        {
            public string MyAccount = string.Empty;

            [SetUp]
            public void Setup()
            {
                MyAccount = "This Account";
            }

            [Test]
            public void Validate_That_Account_Is_Not_Empty()
            {
                Assert.That(!string.IsNullOrEmpty(MyAccount));
            }

            [Test]
            public void Validate_That_Account_Is_Empty()
            {
                Assert.That(string.IsNullOrEmpty(MyAccount));
            }
        }
    } 
```

所以，当我运行测试时，它会进行设置，然后是第一个测试，然后是设置，然后是第二个测试。

我的问题是在测试时我可以使用哪些其他类型，例如 [Setup] 和 [Test] 以及这些的执行顺序是什么。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-28T15:06:33.907

使用 NUnit（不确定其他）你有以下执行顺序：

测试夹具设置

设置

测试

拆除

设置

测试

拆除

TestFixtureTearDown

每次运行测试时，它总是按该顺序执行。

如果你看一下下面的代码，你会看到我所说的内容的精确复制品。您甚至可以复制并粘贴此代码，它应该可以工作（使用 NUnit，不确定它是否可以与其他人一起工作）。

如果您在调试模式下运行它，并在每个方法上放置一个断点，您可以在调试时看到执行顺序。

```
using NUnit.Framework;

namespace Tester
{
    [TestFixture]
    public class Tester
    {
        public string RandomVariable = string.Empty;

        [TestFixtureSetUp]
        public void TestFixtureSetup()
        {
            //This gets executed first before anything else
            RandomVariable = "This was set in TestFixtureSetup";
        }

        [SetUp]
        public void Setup()
        {
            //This gets called before every test
            RandomVariable = "This was set in Setup";
        }

        [Test]
        public void MyTest1()
        {
            //This is your test...
            RandomVariable = "This was set in Test 1";
        }

        [Test]
        public void MyTest2()
        {
            //This is your test...
            RandomVariable = "This was set in Test 2";
        }

        [TearDown]
        public void TestTearDown()
        {
            //This gets executed after your test gets executed. 
            //Used to dispose of objects and such if needed
            RandomVariable = "This was set in TearDown";
        }

        [TestFixtureTearDown]
        public void TestFixtureTearDown()
        {
            //Executes Last after all tests have run.
            RandomVariable = "This was set in TestFixtureTearDown";

        }

    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T15:16:18.347

对于您在其中进行测试的每个类，一个测试夹具，您可以指定 4 种特殊方法。方法的名称并不重要，但您需要使用以下四个属性之一标记方法以识别它们。

约定要求您将方法称为与属性相同的方法，但正如我所说，属性是重要的一点。

请注意，我在这里描述的属性是在[NUnit](http://www.nunit.org)中找到的，但在大多数单元测试框架中都使用了类似的属性（如果不相同）。

属性是：

*   测试夹具设置
*   TestFixtureTearDown
*   设置
*   拆除

前两个与整个班级有关。使用该`TestFixtureSetUp`属性标记的方法在类中的第一个测试之前运行一次。

在执行完类中的所有测试后，将`TestFixtureTearDown`执行一次带有该属性标记的方法。

您可以使用这两个来准备所有测试都相同的通用数据结构，并且不会被任何测试修改（这很重要）。

最后两个`SetUp`和`TearDown`用于标记将在每个单独测试之前和之后运行的两个方法。

标记`SetUp`为的方法在每次测试之前调用，标记为的方法`TearDown`在每次测试之后调用。您可以使用这些来准备通用数据结构，尽管它们对于每个测试都是相同的，但它们会被部分或全部测试更改，因此最好为每个测试准备一个新的副本。

将这些方法的执行布置为伪代码为我们提供了以下顺序：

```
execute TestFixtureSetUp, if present
for each test do
    execute SetUp, if present
    execute actual test
    execute TearDown, if present
execute TestFixtureTearDown, if present 
```

这些属性的使用完全是可选的。你不需要为了拥有a`SetUp`而拥有a `TearDown`，反之亦然。它们只是您可能想要执行代码的点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T15:07:51.687

查看[NUnit 文档](http://www.nunit.org/index.php?p=attributes&r=2.2.10)。

“属性”下右侧的菜单描述了 [Setup]、[Test] 和您在开发测试时可以使用的其他属性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-16T15:06:02.267

NUnit 3.0 对单元测试属性进行了一些更改，如下[所示](https://github.com/nunit/docs/wiki/SetUp-and-TearDown-Changes)：

> **TestFixtureSetUpAttribute 和 TestFixtureTearDownAttribute**继续支持作为测试夹具中 OneTimeSetUpAttribute 和 OneTimeTearDownAttribute 的同义词，但**已弃用。**
> 
> 由于 SetUpAttribute 和 TearDownAttribute 以两种不同的方式使用，因此不可能简单地在 **SetUpFixture**中弃用它们。在这种情况下，它们**已被禁止**，这是一个突破性的变化。

因此，执行顺序如下：

*   一次性设置
*   设置
*   测试
*   拆除
*   设置
*   测试
*   拆除
*   一次性拆除

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T15:17:48.827

请注意，最佳实践是保持单元测试用例彼此独立。因此它们可以被理解、修改和独立运行。

有些人认为设置和拆卸也是一种不好的做法。有关原因，请参见以下链接：

*   [http://jamesnewkirk.typepad.com/posts/2007/09/why-you-should-.html](http://jamesnewkirk.typepad.com/posts/2007/09/why-you-should-.html)
*   [http://www.agileprogrammer.com/dotnetguy/articles/SetupTeardown.aspx](http://www.agileprogrammer.com/dotnetguy/articles/SetupTeardown.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-14T14:43:03.483

在 NUnit 2.5.1 中，执行顺序再次发生了变化。我同意 unittest 绝不能相互干扰。

# python - 如何使用派生自 Python 列表类的类

> ID：921334
> 
> 赞同：6
> 
> 时间：2009-05-28T15:05:13.830
> 
> 标签：python, class

这是问题 912526 -[如何在 Python 中将大量变量传入和传出函数？](https://stackoverflow.com/questions/912526/how-do-i-pass-lots-of-variables-to-and-from-a-function-in-python).

在我正在编写的程序中有很多变量需要传递，从我之前的问题中我了解到我应该将这些变量放入类中，然后传递类。

其中一些变量以重复的形式出现——对于薄膜计算，我需要跟踪多个层的光学特性（折射率、吸收、厚度等）。

存储像这样的变量以创建从 Python 列表派生的类以存储每个包含单个层的变量的类集的最佳方法是什么？然后将处理从列表派生的类中的层集的函数，以及处理该类中的特定层的函数？有没有更好的方法可以用一个班级来做到这一点？

在以下示例中使用两类方法，我可以进行设置，以便可以使用如下语句访问变量

```
n1 = layers[5].n 
```

这是最好的方法，对吧？

```
#Test passing values to and from functions

class Layers(list):

    def add(self,n,k,comment):
        self.append( OneLayer(n,k,comment) )

    def input_string(self):
        input_string = []
        for layer in self:
            vars = layer.input_string()
            for var in vars:
                input_string.append( var )
        return input_string

    def set_layers(self,results):
        for layer,i in enumerate(self):
            j = i*layer.num_var
            layer.set_layer( *results[j:j+2] )

class OneLayer(object):

    def __init__(self,n,k,comment):
        self.n = n
        self.k = k
        self.comment = comment

    def input_string(self):
        return [['f','Index of Refraction',self.n], ['f','Absorption',self.k],['s','Comment',self.comment]]

    def set_layer(self,n,k,comment):
        self.n = n; self.k=k; self.comment = comment

    def num_var(self):
        return 3

if __name__ == '__main__':
    layers = Layers()

    layers.add(1.0,0.0,'This vacuum sucks')
    layers.add(1.5,0.0,'BK 7 Glass')

    print layers[0].n
    print layers.input_string()
    layers[1].set_layer(1.77,0.0,'Sapphire')
    print layers.input_string() 
```

我从这个测试程序得到以下输出：

```
1.0
[['f', 'Index of Refraction', 1.0], ['f', 'Absorption', 0.0], ['s', 'Comment', 'This vacuum sucks'], ['f', 'Index of Refraction', 1.5], ['f', 'Absorption', 0.0], ['s', 'Comment', 'BK 7 Glass']]
[['f', 'Index of Refraction', 1.0], ['f', 'Absorption', 0.0], ['s', 'Comment', 'This vacuum sucks'], ['f', 'Index of Refraction', 1.77], ['f', 'Absorption', 0.0], ['s', 'Comment', 'Sapphire']] 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T15:31:42.293

您的代码中有几个问题：

1.如果您进行任何列表操作，结果将是一个原生列表：

```
layers1 = Layers()
layers2 = Layers()
layers1 + layers2 -> the result will be a native list 
```

2.为什么要定义input_string当你可以覆盖[`__repr__`](http://docs.python.org/reference/datamodel.html#object.__repr__)或[`__str__`](http://docs.python.org/reference/datamodel.html#object.__str__)

3.为什么在这种情况下你甚至必须从列表中派生？如果您希望您的类的行为与列表完全一样，您只需要从列表中派生。但在您的情况下，您似乎正在寻找一个容器。为了让你的类表现得类似于列表，你需要做的就是覆盖一些特殊的 python 方法[http://docs.python.org/reference/datamodel.html#emulating-container-types](http://docs.python.org/reference/datamodel.html#emulating-container-types)

```
class Layers(object):
    def __init__(self, container=None):
        if container is None:
            container = []
        self.container = container

    def add(self,n,k,comment):
        self.container.append([n,k,comment])

    def __str__(self):
        return str(self.container)

    def __repr__(self):
        return str(self.container)

    def __getitem__(self, key):
        return Layers(self.container[key])

    def __len__(self):
        return len(self.container)

>>> l = Layers()
>>> l.add(1, 2, 'test')
>>> l.add(1, 2, 'test')
>>> l
[[1, 2, 'test'], [1, 2, 'test']]
>>> l[0]
[1, 2, 'test']
>>> len(l)
2 
```

# javascript - 如何测量具有溢出内容的 div 的宽度

> ID：921335
> 
> 赞同：2
> 
> 时间：2009-05-28T15:05:51.503
> 
> 标签：javascript, yui

我有一个宽度为 200px 的 div。里面有设置为**不**换行的文本。所以有溢出。我需要获取 div 内容的宽度，包括溢出。

我将它用于 YUI 自动完成下拉菜单。如果结果的宽度大于 div 的宽度，我希望下拉菜单水平增长。

如何获取内容的宽度（不是 css 宽度，所以 offsetWidth 不起作用）包括溢出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:19:17.140

使用 scrollWidth / scrollHeight 属性。

# jquery - 单击后通过ajax延迟加载单个选择框选项的正确方法

> ID：921338
> 
> 赞同：3
> 
> 时间：2009-05-28T15:06:20.613
> 
> 标签：jquery, ajax, select, webkit, onclick

我有一个选择框，仅在单击时才应填充。所涉及的查询需要很长时间，因此我将其从页面上显示的标准数据中分离出来。

我已经实现了执行`loadMyData(element, id)`ajax 请求并将数据作为 JSON 返回的函数。然后它填充选择框。

事件绑定到元素，如下所示：

```
<select onclick="loadMyData(this, 1)">
</select> 
```

并且选择框填充如下：

```
$.each(data, function(index, optionData) {
  select.options[element.options.length] 
             = new Option(optionData.Text, optionData.Value);
}); 
```

在基于 Gecko 的浏览器上有效，但在 Webkit 浏览器（safari 和 chrome）上，当我单击选择框时，在 ajax 请求之前显示一个空的下拉框，在响应之后，下拉框不会刷新。必须在选择框外单击并再次单击它才能看到更新的“选项”。

有没有办法强制它刷新内容？还是简单地自动选择第一个并隐藏下拉框？

**尝试 onfocus 并发现相同的结果。onmouseover 有效，但“不可用”。onchange 不可行，因为选择框在其初始状态下为空。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T06:31:14.507

一些想法：

1.  不要使用标准的 html 选择框——你的应用程序不会优雅地降级。

2.  使用一些点击劫持 - 有一个透明的 div OVER 选择框 - IE 的问题

3.  使用复选框来允许“非标准”答案，这将填充选择框并使其可点击（未禁用）

4.  我最喜欢：缓存查询结果并立即填充选择框。在选择框附近提供另一个“引用选项”按钮以通过 AJAX 重新加载选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T06:50:50.350

像往常一样，这里的坏浏览器是 IE 6 及更低版本，因为它在选择选项上有这个只读的东西，所以处理它的唯一方法是替换整个选择。

**索引.php**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="es">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>lazy loading thing</title>
        <script src="js/jquery.js" type="text/javascript"></script>
        <script src="js/script.js" type="text/javascript"></script>
    </head>
    <body>
        <form>
            <p>
                <span id="replaceMe"><select name="drinks">
                    <option>oh well... click me...</option>
                </select></span>
            </p>
        </form>
    </body>
</html> 
```

**脚本.js**

```
$(function() {
     $('#replaceMe').one('click', replaceIt);
});

function replaceIt(e) {
    $(this).html('now wait...');
    $.post('options.php', {}, replaceItHandler, 'json');
}

function replaceItHandler(options) {
    var select = '<select name="drinks">';
    $.each(options, function(i, option) {
        select += '<option value="' + option.data + '">' + option.label + '</option>';
    });
    select += '</select>';
    $('#replaceMe').html(select);
} 
```

**选项.php**

```
<?php
$options[] = array('data' => 0, 'label' => 'Water');
$options[] = array('data' => 0, 'label' => 'Wine');
$options[] = array('data' => 0, 'label' => 'Beer');
$options[] = array('data' => 0, 'label' => 'Coke');
echo json_encode($options);
?> 
```

很明显，您可以使用 PHP 或类似的 JSON 或发送整个选择，这是您的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-05T09:19:10.917

在 Safari 上，问题是它应该是 onchange 的 onclick 事件。

在这里看到解决方案：[http ://munteanutraian.info/forum/?p=5](http://munteanutraian.info/forum/?p=5)

# jquery - 使用 jquery 自动滚动另一个网格

> ID：921352
> 
> 赞同：2
> 
> 时间：2009-05-28T15:08:03.527
> 
> 标签：jquery

我有两个具有相同行数（也相同高度）的网格。这两个网格都有垂直滚动（使用样式溢出）

当我在第二个表格上执行垂直滚动时，我希望第一个网格自动向上/向下滚动相同的行数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T15:57:34.223

这是你可以做到的。如果您有水平滚动条，它甚至可以工作：

```
$(function(){
    $("#grid1").scroll(function(){
        $("#grid2")
            .attr('scrollTop', $(this).attr('scrollTop'))
            .attr('scrollLeft', $(this).attr('scrollLeft'));
    });
}); 
```

此代码假定“grid1”和“grid2”分别是包含表的 DIV 的 ID。

# c# - 我可以在 .Net 和 WPF 中执行此操作吗？

> ID：921358
> 
> 赞同：2
> 
> 时间：2009-05-28T15:09:09.563
> 
> 标签：c#, .net, wpf, vba, vb6

我们有一个集成了 VBA 的第三方应用程序。这一切都允许我们打开一个包含 UI 的 vb6 ActiveX DLL，并将应用程序实例传递给 vb6 DLL。

```
' Instantiate the SMTree UI.
Set oSMTree = CreateObject("SMTree.clsMain")

' Start it up.
oSMTree.cMain Application 
```

然后在 VB6 应用程序中，主要看起来像：

```
Public Sub Main(app As ACNProfessionalAB.CMerchman)

    Set oACNApplication = app

End Sub 
```

有没有办法创建一个可以以相同方式调用的 WPF 应用程序并传入调用应用程序实例，这样我就不必继续使用 VB6？

提前致谢！富有的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T15:37:34.677

如果您可以通过 .Net 中的 COM 互操作创建对象，那么您应该能够分配对该对象的引用，因为接口将是相同的。

只需通过将生成互操作 dll 的项目引用屏幕添加 ActiveX dll 作为引用，然后使用上述现有代码在 xaml.vb 文件中分配引用。

# java - 使用 JSF 时有时会丢失 http GET 参数

> ID：921359
> 
> 赞同：0
> 
> 时间：2009-05-28T15:09:28.050
> 
> 标签：java, http, jsf, servlets

我有一个 servlet 过滤器，可以处理 vanilla servlet 和`JSF`页面的错误。

如果检测到错误，用户将被重定向到错误页面，他可以在其中提供反馈。然后我尝试读取`ErrorBean`对象中的值。但是，有时错误不存在 - 存在错误的可能性为 50-50。

当我使用

```
FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap() 
```

它有时会返回一个包含 1 个条目的地图，有时会返回一个空地图。在每种情况下，id 都是在 http 级别传递的。

我无法真正重现造成这种情况的原因。这是相关代码（辅助方法+省略了空实现）。ErrorFilter 映射在`/*`，ErrorBean 是由 JSF 管理的会话范围 bean。

**错误过滤器**

```
public class ErrorFilter implements Filter 
{
  public void doFilter(ServletRequest req, ServletResponse resp, FilterChain chain) throws ServletException, IOException 
  {
    HttpServletRequest hreq = (HttpServletRequest) req;
    HttpServletResponse hres = (HttpServletResponse) resp;

    try 
    {
      chain.doFilter(req, resp);
    } 
    catch (IOException e) 
    {
      handleError(e, hreq, hres);
    } 
    catch (ServletException e) 
    {
      handleError(e, hreq, hres);
    } 
    catch (RuntimeException e) 
    {
      handleError(e, hreq, hres);
    }
  }

  private static void handleError(Throwable e, HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException 
  {
    final RequestInfo requestInfo = new RequestInfo(getUri(req), req.getSession().getId(), null, null, UserFactory.getUser(), InetAddress.getByName(req.getRemoteAddr()));
    String token = new DecimalFormat("00000000").format(Math.abs(RANDOM.nextInt() % Integer.MAX_VALUE));
    //log msg
    //send mail in a different thread

    if (!req.getRequestURI().startsWith("/faces/error.jsp")) 
    {
      resp.sendRedirect("/faces/error.jsp?token=" + token);
    } 
    else 
    {
      //log that an infite loop occurred
      throw new ServletException(crapMsg, e);
    }
  }
} 
```

**错误豆**

```
public class ErrorBean implements Serializable 
{
  private String feedback;
  private String lastToken;

  public String getLastErrorCode() 
  {
    return "your token: " + getToken();
  }

  private String getToken() 
  {
    final String token = (String) FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get("token");
    //here the "token" returns null although it is sent via get.

    if (token != null) 
    {
        if (!token.equals(lastToken)) 
        {
          // reset data on token change.
          feedback = null;
        }
        lastToken = token;
    }

    return lastToken;
  }

  public void setFeedback(String feedback) 
  {
    this.feedback = feedback;
  }

    public String getFeedback() 
    {
      if (feedback == null) 
      {
        feedback = getDefaultMessage();
      }

      return feedback;
    }

  public void send()
  {
    sendMail(lastToken,feedback);
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T09:47:32.147

从我谦虚的角度来看，当请求已经被重定向时，Faces Context 应该在第一次看到参数变化：`resp.sendRedirect("/faces/error.jsp?token=" + token);`

但是，当您发出其他请求时，Faces 会使用其导航系统进行操作并重定向页面，显然过滤器正在执行`chain.doFilter(req,resp);`该操作，这会授权 JSF 导航模型执行，从而删除您的请求参数。

我的建议是您可以将其添加到另一个会话值中，这样操作起来会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:13:29.990

我不认为 FacesContext 在 Servlet 过滤器中可用。在点击 FacesServlet（创建 FacesContext）之前，过滤器不会运行吗？

尝试阅读：[http ://www.thoughtsabout.net/blog/archives/000033.html](http://www.thoughtsabout.net/blog/archives/000033.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T16:08:12.113

在比 JSF 本身更大的任何内容（例如，来自 webapp 框架）的上下文中，错误页面通常不是 JSF 的良好候选者。是的，FaceContext 不是您可以随时使用的东西。它由 Faces Servlet 创建以处理 JSF 请求，并在请求完成时被丢弃。它不再具有从请求到请求的长期持久性。

此外，URL 在 JSF 中的意义与它们在大多数 Web 应用程序中的意义完全不同。它们更像是用于跟踪对话的句柄，而不是请求或显示哪个页面的绝对指示。

# iphone - iPhone 内存管理 didReceiveMemoryWarning

> ID：921360
> 
> 赞同：3
> 
> 时间：2009-05-28T15:09:40.733
> 
> 标签：iphone, memory-management

好的......

我正在 iPhone 上实现一个简单的 OpenGL ES 应用程序，并且我最近添加了 Pinch Media Analytics。这样做有助于发现内存管理问题，我不完全确定如何处理它。

在一个完美的世界中，我的应用程序 - 在 didFinishLoading 中加载 PNG 和 .CAF 文件将启动，加载它的所有资源，并且运行良好。

但是，如果我的程序崩溃（在我集成 Pinch Media 库时发生）或者如果我运行 Safari 并打开一堆页面然后启动我的游戏，游戏将崩溃回到菜单，因为它不在记忆。

在我对系统进行硬重置之前，此问题将一直存在。

您上网的默认答案是实现 didReceiveMemoryWarning 方法，如下所示....

```
- (void)didReceiveMemoryWarning
{ 
  // default behavior is to release the view if it doesn't have a superview.

  // remember to clean up anything outside of this view's scope, such as
  // data cached in the class instance and other global data.
  [super didReceiveMemoryWarning];
} 
```

但这并没有真正的帮助，因为保留内存的其他程序不是我的。我不想发表我自己的观点是吗？是否有关于如何处理这种情况和/或在 didReceiveMemoryWarning 事件中发生什么的很好的描述？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T16:15:49.537

欢迎来到没有虚拟机的共享内存池……在这里你可以做的不多，但有一些事情（这实际上可能是你的错，你可以完全修复它）。出于这个原因，游戏开发人员经常建议他们的客户在运行它们之前重新启动，所以如果你真的需要大量内存才能发挥作用，你可能需要在同一条船上。

当然，您应该尽量减少自己的内存占用。但是你也应该尽量避免过多的内存碎片。有时问题不在于没有记忆；只是没有足够大的块。有时最好使用 Mutable 并不断修改它，而不是生成新的不可变对象。对于大型 NSString 尤其如此，它确实会浪费内存。

请记住，它`UIImage +imageNamed:`会在您发布后保留图像，因此如果您不再需要它们，则需要清除它们。在释放它之前将其名称设置为 nil 以停止缓存。

确保在 Instruments 下运行您的应用程序。你吃的记忆可能比你想象的要多。

不要忘记自动释放池。如果您在单个事件循环中生成大量自动释放的对象，则可能需要定期排空池，以免内存激增。内存峰值可能会导致内存需求适中的程序突然被杀死。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T15:58:44.237

如果你只有一个视图，那么你唯一能做的就是释放任何你不使用的数据，然后延迟加载它们。

如果您有多个视图，那么如果它们不可见，它们可能会被释放。如果发生这种情况，相应的控制器将被`setView:`发送`nil`。我通过立即释放所有`IBOutlet`变量来处理这种情况，以便在再次从其加载视图时正确设置它们`xib`。

这是我在具有 >6 个视图的普通非 OpenGL ES 应用程序中采用的方法，即使我在导航视图中的 4 级深并且所有以前的控制器都将其视图设置为时，它也能始终如一地工作`nil`- 没有崩溃我向后导航，尽管在重新加载视图时会有延迟。

如果您还没有找到它，在模拟器中有一个菜单项可以模拟内存警告，这比在真实设备中强制发生这种情况更容易。也就是说，它并不能取代在真实设备中测试相同的场景——只是让测试更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T01:58:39.423

您可以尝试使用压缩的 PVRTC 而不是 PNG，以节省一些空间（可能会降低性能）。

这里有一个不错的小教程：

[http://iphonedevelopment.blogspot.com/2008/12/preparations-for-porting-nehe-lesson-06.html](http://iphonedevelopment.blogspot.com/2008/12/preparations-for-porting-nehe-lesson-06.html)

请记住，您必须重写一些 OpenGL 调用来处理这种不同的压缩纹理。

[免责声明：我不是 OpenGL ES 优化大师。不是一个looooong镜头。]

# asp.net - 为什么 ScriptResource.axd 被压缩，即使 IIS 压缩被禁用？

> ID：921361
> 
> 赞同：5
> 
> 时间：2009-05-28T15:10:01.683
> 
> 标签：asp.net, iis, gzip, http-compression

我在 IIS 6.0 上运行 ASP.NET 应用程序。通常我对动态和静态文件都打开了压缩。但是，我暂时关闭了压缩，但“ScriptResource.axd”仍然是压缩发送的。这感觉不像是错误配置，因为“WebResource.axd”没有被压缩。

ScriptResource 和 WebResource 有什么区别，前者仍然是压缩的？它是如何被压缩的？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T17:40:25.140

Web 资源由[AssemblyResourceLoader](http://msdn.microsoft.com/en-us/library/system.web.handlers.assemblyresourceloader.aspx)类处理，该类旨在检索程序集资源并将它们提供给 Web 浏览器。*默认情况下不*压缩Web 资源。

脚本资源由[ScriptResourceHandler](http://msdn.microsoft.com/en-us/library/system.web.handlers.scriptresourcehandler.aspx)类处理，该类处理对通过 ScriptManager 类引用的嵌入式脚本文件的所有请求。默认情况下，脚本资源*会*自动使用 GZIP 压缩以进行 HTTP 传递。

# function - 有什么方法可以检查是否定义了 VBScript 函数？

> ID：921364
> 
> 赞同：15
> 
> 时间：2009-05-28T15:10:29.170
> 
> 标签：function, asp-classic, vbscript, defined

这大概只是一厢情愿...

有什么方法可以在调用之前检查是否定义了 ASP/VBScript 函数？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-09-11T22:43:55.703

这是我的解决方案，其工作原理相同，但hacky-ness非常独立：

```
Function FunctionExists( func_name )
    FunctionExists = False 

    On Error Resume Next

    Dim f : Set f = GetRef(func_name)

    If Err.number = 0 Then
        FunctionExists = True
    End If  
    On Error GoTo 0

End Function 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-28T15:27:23.473

这是一种有点笨拙的方法，因为它依赖于设置“On Error Resume Next”，但您可以执行以下操作：

```
On Error Resume Next
Dim objRef1, objRef2
Set objRef1 = GetRef("DoStuff1")
If objRef1 Is Nothing Then
    Call objRef1
Else
    MsgBox "DoStuff1 is not defined!"
End If

Set objRef2 = GetRef("DoStuff2")
If objRef2 Is Nothing Then
    MsgBox "DoStuff2 is not defined!"
Else
    Call objRef2
End If

Sub DoStuff1
    MsgBox "DoStuff1!"
End Sub 
```

如果您尝试获取指针的子函数或函数不存在（如 DoStuff2 的情况），则对 GetRef 的调用将生成异常。然后，您可以检查引用是否按预期设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-17T11:06:09.677

提供的答案是正确的，我只是做了一个简单的修改，`Err.Clear`根据提供的答案添加和压缩函数。

我还将函数重命名为更合适的名称，以反映它可用于检查函数和子例程是否存在的事实。

```
Function ProcExists(ByVal ProcName)

 On Error Resume Next
  Set ProcName = GetRef(ProcName)
  ProcExists   = (Err.Number = 0)
  Err.Clear
 On Error GoTo 0

End Function 
```

# c++ - 如何在编译时使用预处理器计算和存储哈希？

> ID：921367
> 
> 赞同：1
> 
> 时间：2009-05-28T15:11:07.720
> 
> 标签：c++, macros, c-preprocessor, trace

我有一个本机 C++ 程序，它使用“事件队列”在不同线程上执行函数。我在堆上分配了一个“事件”类，并将它放在我的一个线程队列中执行。

这一切都很好，但是很难追溯这些“事件”的起源。我希望每个“事件”都存储一些与其来源有关的信息。现在我使用内在`_ReturnAddress()`的，但我也想要文件名字符串和行号。我可以使用宏来安排我的“事件”。

当然，我不想为拥有这些字符串付出代价。

有没有办法让预处理器建立并转储以归档“id”=>“file，line”的映射，其中“id”每次我的宏扩展时都会增加一些唯一的数字？我可以将该 ID 存储为我的来源。

或者也许计算一个非常短的文件名哈希，以便我可以在运行时使用它？

欢迎任何想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T15:23:44.027

对于您可以使用的 ID`__COUNTER__.`

来自[http://msdn.microsoft.com/en-us/library/b0084kay(VS.80).aspx](http://msdn.microsoft.com/en-us/library/b0084kay(VS.80).aspx)：

> 展开为一个整数，从 0 开始，每次在编译器中使用时递增 1。

`__FILE__`并可`__LINE__`用于跟踪事件的分配位置。

但是为什么要追溯这些事件的起源呢？如果这是出于调试目的，您可能希望在特殊调试模式下将使用 StackWalk64 收集的堆栈跟踪嵌入到您的类中 - 它会为您提供更多有用的信息，而不仅仅是原产地。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T15:32:16.957

编写自己的预处理器。

不必那么难，只需解析 .cpp 文件并搜索您自己定义的一些语法。找到它时，将文件名和行（预处理器必须计算新行数）附加到某个日志文件。不过，它必须将您自己的宏扩展为 c++。将所有内容写入一个临时文件，然后将其传递给“真正的”编译器。

干杯！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T15:55:02.793

查看[Boost.Preprocessor](http://www.boost.org/doc/libs/1_39_0/libs/preprocessor/doc/index.html)。它是一组仅包含头文件的宏，用于使用标准 C 预处理器执行强大的功能。

它非常复杂（我没有声称理解它）但我认为它可以做你想做的事。[此处](http://www.boost.org/doc/libs/1_39_0/libs/preprocessor/doc/index.html)和[此处](http://www.boostpro.com/tmpbook/preprocessor.html)的文档。

# regex - 如何在 Linux 上使用正则表达式在文件中查找信息

> ID：921370
> 
> 赞同：0
> 
> 时间：2009-05-28T15:11:17.547
> 
> 标签：regex, linux, shell, scripting

我有一个文件，里面有很多行。其中一个看起来像：

```
set auto_upgrade {1 2 3 4} 
```

该列表可以包含更多数字。

现在，在一个 shell 脚本中，我想查看这个文件并找出列表中的最后一个数字是什么。在上面的例子中，它应该找到 4。我有一个正则表达式来找到这个：

```
set auto_upgrade {\([0-9] \)*\([0-9]\{1,\}\)} 
```

第二组包含我需要的内容。但是，我该如何使用这个正则表达式？我尝试了*sed*但它返回带有替换的完整文件。我只想要第二组。

在此先感谢，巴特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T15:26:52.273

首先，在安静模式下启动 sed：它不应该打印任何东西，除非被告知这样做（这就是 flag `-n`）。然后仅在进行替换时才打印（即模式修饰符`p`）

```
sed -n 's/set auto_upgrade {\([0-9] \)*\([0-9]\{1,\}\)}/\2/p' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:16:34.477

就像是

猫文件名 | perl -pe 's/^.* (\d+)\}/$1/'

应该管用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:20:05.097

```
sed 's/.*\([0-9]\+\)}/\1/g' 
```

替换部分中的“\1”与组匹配。即（忽略转义和引号）

```
sed s/pattern1(pattern2)/\1/g 
```

将返回 pattern2 的匹配部分

# javascript - 如何在 jQuery 中将 JSON 字符串转换为 JavaScript 对象？

> ID：921374
> 
> 赞同：32
> 
> 时间：2009-05-28T15:12:11.443
> 
> 标签：javascript, jquery, json

我的数据库中有一个字符串，我想将其拉入我的页面并转换为 JavaScript 对象。

```
[
{id: 1,title: "Long Event",
       start: new Date(2009, 5, 6, 14, 0),end: new Date(2009, 5, 11)},
{id: 2,title: "Repeating Event",
       start: new Date(2009, 5, 2)},
{id: 3,title: "Meeting",
       start: new Date(2009, 5, 20, 9, 0)},
{id: 4,title: "Click for Facebook",
       start: new Date(2009, 5, 27, 16),end: new Date(2009, 5, 29),
       url: "http://facebook.com/"}
] 
```

如何使用 jQuery 做到这一点？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2010-07-27T02:36:33.780

从 jQuery 1.4.1 开始，您可以在本地执行此操作

```
jQuery.parseJSON 
```

请参阅[jQuery 文档](http://api.jquery.com/jQuery.parseJSON/)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-30T08:46:28.693

“官方” json2.js 脚本包括 2 种方法：一种将安全地将任何 JSON 字符串解析为对象（JSON.parse），另一种将对象转换为 JSON 字符串（JSON.stringify）

可以在[此处](https://github.com/douglascrockford/JSON-js)找到该脚本。

在我上面的帖子中，我建议使用 eval()，但实际上有一种更好的方法来评估 JSON（如果您不想使用 json2.js 脚本）：

```
var obj = (new Function("return " + json))(); 
```

使用 json2.js 脚本：

```
var obj = JSON.parse(json); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T15:14:22.983

eval() 怎么样？

var obj = eval(jsonString);

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T15:15:13.217

看看[JQuery-json](http://code.google.com/p/jquery-json/)插件

```
var thing = {plugin: 'jquery-json', version: 1.3};

var encoded = $.toJSON(thing);              //'{"plugin": "jquery-json", "version": 1.3}'
var name = $.evalJSON(encoded).plugin;      //"jquery-json"
var version = $.evalJSON(encoded).version;  // 1.3 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T15:16:12.543

你看过[jquery-json](http://code.google.com/p/jquery-json/)插件吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T15:17:23.913

利用

```
jQuery.getJSON(url, data, callback)
```

或传递“json”作为`type `parameter:``

```
`jQuery.get( url, data, callback, type )`
```

`same applies to:`

```
jQuery.post( url, data, callback, type )
```

***如果您从 ajax 请求中获取“字符串”**

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-30T08:56:47.643

虽然您可以使用 eval 命令，但您需要先检查它的安全性。我用：

```
var data = !(/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.
           test(source.replace(/"(\\.|[^"\\])*"/g, '')))     
           && eval('(' + source + ')'); 
```

那应该可以（它已经从原始版本中进行了一些调整）。关键是检查 JSON 字符串以防止函数和其他实际可执行代码偷偷溜走。（第一个正则表达式很重要）。

也就是说，JSON 插件非常好。

# eclipse - 如何从 Eclipse 在 Tomcat 中运行 Maven 项目

> ID：921380
> 
> 赞同：41
> 
> 时间：2009-05-28T15:13:12.970
> 
> 标签：eclipse, tomcat, maven-2

我正在运行一个多层次的 Maven 项目。它有 webapps 打包为 WAR，它依赖于打包为 JAR 文件的组件

我所做的大部分代码更改都属于那些 JAR 文件。

要测试更改，我需要重新打包 JAR 和 WAR 并在外部部署到 tomcat 中。

我尝试使用 sysdeo-tomcat-maven-eclipse 插件，但它没有按预期工作。

请告知是否有人有解决此问题的方法

谢谢高拉夫

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2011-12-09T08:40:07.900

**使用 Maven Eclipse 集成插件**

如果您遇到问题，我发现尝试使用命令行工具*mvn*进行调试很有帮助。根据经验，如果它在命令行构建时没有错误，那么您可以在 Eclipse 中运行它（但 tomcat 也有问题，因此您可能需要每隔一段时间清理工作目录并清除缓存）。

除此之外，我真的推荐使用 Maven Eclipse 集成插件！我使用来自 Sonatypes 插件仓库[http://m2eclipse.sonatype.org/sites/m2e](http://m2eclipse.sonatype.org/sites/m2e)的版本。eclipse repo 上有一个更新的集成，但它的工作方式不同，我还没有时间研究它的用途。

如果您的项目是模块化的，那么将根项目设置为一个简单项目（没有 Java，没有 Java EE）可能会有所帮助。然后将子项目作为简单的 Java 项目导入（同样没有 Java EE）。您仍然可以激活依赖管理并通过项目运行构建目标。

![导入模块](https://i.stack.imgur.com/ES5cq.png)

您只需要按依赖项选择目标项目所需的子模块。

![选择要作为子项目包含的依赖项](https://i.stack.imgur.com/QwU68.png)

对于任何构建war文件的项目，激活java ee的构面并在*可用的进一步配置*下配置上下文根（这只能完成一次，为什么屏幕截图中缺少该选项，所以做对了）。

![选择你想要的方面](https://i.stack.imgur.com/PdfFr.png)

然后为您的 facated 项目设置部署程序集。所有同级项目（在您的工作区中处于活动状态）都应添加到部署程序集中，您还需要将*Maven 依赖*项的*构建路径条目*添加到部署程序集。设置完成后，您可以使用 Run on server 指令来启动您的 Web 应用程序。

 *![设置部署程序集](https://i.stack.imgur.com/eqQFl.png)

我发现在编写 maven 项目时始终保持纯 java 模式很有用。Eclipse 中的任何智能视图都只会掩盖幕后发生的事情，无论如何您都可以通过激活 facated 项目来访问特定的编辑器！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-28T15:19:05.160

我使用 eclipse webtools 插件，并从中运行我的 Tomcat。它有一个发布 jar 的重新发布方法（如果没有，您只需清理目录并重新发布）。

在 pom 文件中，您应该有以下几行，以便自动支持 webtools

```
<build>
    ...
    <plugins>
        <plugin>
            <artifactId>maven-eclipse-plugin</artifactId>
            <configuration>
                <wtpversion>1.5</wtpversion>
                ...
            </configuration>
        </plugin>
        ...
    </plugins>
    ...
</build> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-13T13:23:45.467

**使用 Maven Eclipse 集成插件和 Web Runner**

设置一个 facated 项目（已在另一个答案中描述），使用最新的 Maven Eclipse 集成插件。这应该位于协作下的 Eclipse 版本的更新站点。在我的例子中，Indigo - `http://download.eclipse.org/releases/indigo`(/Collaboration/Maven Integration for Eclipse)。

作为内置服务器的替代方案，内置服务器在更新部署程序集（对于 tomcat）中的工作区依赖项时经常失败，我建议使用类似于 maven 指令 jetty:run 的 maven jetty 插件的Sonatype Web Application Launcher *Webby 。*您可以在 sonatypes 更新站点找到插件 M2e Webby - 的插件`http://m2eclipse.sonatype.org/sites/m2e-webby/`。安装此插件后，您可以*运行配置*并从位于`{project}/target/m2e-webby`.

![在此处输入图像描述](https://i.stack.imgur.com/nPa35.png)

我建议将（默认）嵌入式码头容器之一配置为 servlet-api 的提供者。如果必须测试特定的运行时，可以通过浏览到服务器主目录并选择适当的提供程序来轻松配置外部容器。

我遇到的缺点很小：

*   Web 应用程序必须手动关闭，没有“重启”。
*   每个 Web 应用程序都必须在单独的端口上运行，它们不共享容器实例。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-09-22T17:05:31.997

使用上述配置的当前版本的 m2eclipse 插件，您会收到“无法从 JAR 文件“file:..g/workspace/.metadata/.plugins”中读取 TLD“META-INF/c.tld”错误。

您需要从已部署的项目 lib/ 文件夹中删除 servlet-api.jar 和 jsp-api.jar 以修复上述错误，并设置自定义构建配置，以免这两个文件复制到部署目录。

# visual-studio - 链接（随机？）因可视化调试 DLL 而失败

> ID：921383
> 
> 赞同：2
> 
> 时间：2009-05-28T15:13:58.367
> 
> 标签：visual-studio, debugging, linker

我在 Visual 2005 或 2008 下经常遇到这个问题：

当我编译一堆 DLL（本机 C、C++、托管）时，有时它们中的一些不能与某些 microsoft debug DLL 正确链接。输出没有提及任何内容（没有警告，没有错误）。直到我启动我的程序并在没有更多解释的情况下得到“未找到模块异常”时，我才能意识到这一点。

当我使用 Dependency Walker 打开我的 Dll 时，有些缺少**MSVCR90D.DLL**和**MSVCP90D.DLL**。如果我在一个幸运的时刻，我只需要重建损坏的 dll 来获得一个有效的。在最坏的情况下，重建会产生另一个损坏的 dll，直到一个神秘的时刻（几小时或几天后）得到一个有效的 dll……听起来很疯狂，不是吗？

有效的 dll 具有这种路径：

*c:\windows\winsxs\x86_microsoft.vc90.debugcrt_1fc8b3b9a1e18e3b_9.0.30729.1_x-ww_f863c71f\MSVCP90D.DLL*

这让我发疯！...有什么想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:20:20.133

使用 /MT 而不是 /MD 构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-08T22:06:13.467

也许它对使用哪个 dll 感到困惑。在 C:\Program files\Visual Studio 下搜索？？？对于 MSVCR90D.DLL，它应该在 C:\Program files\Visual Studio???\sdk...\bin 我不确定你有什么版本。然后在您的环境 PATH 中，设置该路径以查看该 bin 路径。

我已经看到很多次有许多同名的 dll 并且程序混淆了它应该与哪个链接。试试看是否有帮助

珍妮特

# java - Java String 数组：有方法的大小吗？

> ID：921384
> 
> 赞同：163
> 
> 时间：2009-05-28T15:14:03.033
> 
> 标签：java, arrays, string

我来自 php 背景，在 php 中，有一个`array_size()`函数可以告诉你数组中有多少元素被使用。

`String[]`数组有类似的方法吗？谢谢。

* * *

## 回答 #1

> 赞同：288
> 
> 时间：2009-05-28T15:17:26.333

是`.length`的，（类似属性，不是方法）：

```
String[] array = new String[10];
int size = array.length; 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-05-28T15:17:16.410

```
array.length 
```

它实际上是数组的最终成员，而不是方法。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-12-30T22:23:30.400

此外，请注意，如果您有一个多维数组，您可以通过将“[0]”附加到您正在查询的数组中来获取相应的维度，直到您到达适当的轴/元组/维度。

使用以下代码可能会更好地解释这一点：

```
public class Test {
    public static void main(String[] args){
        String[][] moo = new String[5][12];

        System.out.println(moo.length); //Prints the size of the First Dimension in the array
        System.out.println(moo[0].length);//Prints the size of the Second Dimension in the array
    }

} 
```

产生输出：

```
5
12 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-05-28T15:17:21.357

array.length 最终属性

它是公共的和最终的财产。它是最终的，因为 Java 中的数组在大小上是不可变的（但在元素的值上是可变的）

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-05-28T15:17:34.943

数组是对象，它们有一个长度字段。

字符串[] 哈哈 = {"olle", "bulle"};

haha.length 为 2

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-05-28T15:18:12.150

在 java 中有一个`length`字段，您可以在任何数组上使用它来找出它的大小：

```
 String[] s = new String[10];
    System.out.println(s.length); 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-05-28T21:01:12.240

如果你想要一个函数来做到这一点

```
Object array = new String[10];
int size = Array.getlength(array); 
```

如果您不知道您有什么类型的数组，例如 int[]、byte[] 或 Object[]，这将很有用。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2015-06-15T22:31:15.023

`String`长度和`array`澄清之间存在差异：

```
int a[] = {1, 2, 3, 4};
String s = "1234";

a.length //gives the length of the array

s.length() //gives the length of the string 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-05-28T15:53:35.153

答案是“全部”。Java 数组分配有固定数量的元素槽。“长度”属性会告诉你有多少。该数字在阵列的生命周期内是不可变的。对于可调整大小的等价物，您需要 java.util.List 类之一 - 您可以在其中使用 size() 方法找出正在使用的元素数量。

但是，有 "In use" 和*In Use*。在类对象数组中，您可以拥有元素为空对象的元素槽，因此即使它们计入长度属性，但大多数人的定义，它们并没有被使用（YMMV，取决于应用程序）。没有用于返回空/非空计数的内置函数。

列表对象还有另一个“使用中”的定义。为了避免过度创建/破坏底层存储结构，这些类中通常有一些填充。它在内部使用，但不计入返回的 size() 方法。如果您尝试在不扩展列表的情况下访问这些项目（通过 add 方法），您将获得非法索引异常。

因此对于列表，您可以为非空、已提交元素、所有已提交元素（包括空元素）或所有元素（包括当前分配的扩展空间）设置“使用中”。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-11-16T06:33:43.280

以上所有答案都是正确的。需要注意的重要一点是数组具有长度属性，但没有长度方法。每当您在 java 中使用字符串和数组时，您可能面临的三个基本模型是：

1.  字符串 s=new String("vidyasagar");
    System.out.println(s.length()); // 在这种情况下，我们只使用 String。字符串没有长度属性。我们必须使用 length() 方法。
2.  整数[] s=新整数[10]；System.out.println(s.length); //这里我们使用数组的长度属性。
3.  字符串[] s=新字符串[10]；
    System.out.println(s.length); // 这里即使数据类型是字符串，它也不是单个字符串。s 是字符串数组的引用。所以我们使用数组的长度属性来表示该数组可以容纳多少个字符串。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-28T15:27:06.627

不是你问题的真正答案，但如果你想要一个可以增长和缩小的数组，你不应该在 java 中使用数组。最好使用[ArrayList](http://java.sun.com/j2se/1.5.0/docs/api/java/util/ArrayList.html)或其他 List 实现。

然后你可以调用它的 size() 来获取它的大小。

# javascript - 在 IE 的嵌套 iframe 中访问 javascript 函数

> ID：921387
> 
> 赞同：4
> 
> 时间：2009-05-28T15:14:13.093
> 
> 标签：javascript, iframe

我目前有一个页面结构，它由一个包含 iframe(iframe0) 的页面(Parent) 组成，在该 iframe 内部我有另一个 iframe(iframe1)。在 iframe1 中，我有一个试图从 Parent 调用的 javascript 函数。在 Firefox/Chrome/Safari 中，我可以使用以下代码调用此函数：

```
 frames["iframe0"]["iframe1"].functionName(); 
```

但是，在 Internet Explorer 中，上述代码不起作用，并返回错误“对象不支持此属性或方法”。我尝试了一些其他方法来访问该方法，它们都返回相同的错误。

```
 window.frames.iframe0[iframe1].functionName();
 window.iframe0.iframe1.functionName();
 window.frames.iframe0.frames.iframe1.functionName(); 
```

我什至尝试在 iframe0 中调用一个函数，该函数在 iframe1 中调用该函数，但它甚至不起作用。

任何人都知道如何访问嵌套在 2 级深度的 iframe 中的 javascript 函数？

谢谢。

**更新：** 在进一步研究问题后，我发现我正在处理的问题与我所问的无关。ylebre 在下面给出的答案回答了我提出的问题，我将在那里标记为答案。我可能会开始另一个更详细地描述我的问题的问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-29T19:51:42.550

我提供了一个使用 3 个 HTML 文件的示例。最外层是 test.html，它有一个包含 iframe1.html 的 iframe。反过来，iframe1.html 包含一个包含 iframe2.html 的 iframe。我希望这是您想到的那种设置。

基本上，您可以使用 iframe.contentWindow.myfunc(); 调用 iframe 函数；

使用 contentWindow.document，您可以访问第二级 iframe。

示例函数“doit()”调用父级、第一个 iframe 和第二个 iframe 中的函数。

希望这可以帮助！

```
<!------- test.html -------->
<html>
<head>
    <script type="text/javascript">
        function parent_function() {
            alert('parent');
        }
        function doit() {
            parent_function();
            document.getElementsByTagName('iframe')[0].contentWindow.iframe1_function();
            document.getElementsByTagName('iframe')[0].contentWindow.document.getElementsByTagName('iframe')[0].contentWindow.iframe2_function();
        }
    </script>
</head>
<body>
main
<a href="javascript:doit();">do it</a>
<iframe src='iframe1.html'>
</body>
</html>

<!------- iframe1.html -------->
<html>
<head>
    <script type="text/javascript">
        function iframe1_function() {
            alert('iframe1');
        }
    </script>
</head>
<body>
frame1
<iframe src='iframe2.html'>
</body>
</html>

<!------- iframe2.html -------->
<html>
<head>
    <script type="text/javascript">
        function iframe2_function() {
            alert('iframe2');
        }
    </script>
</head>
<body>
frame2
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-10T21:35:36.460

A fast way to select an iframe is to select it in the dom explorer, then in the js console, you can run `$0.contentWindow.myFunction()`

# javascript - 任何人都知道用于 html 的 javascript 删除工具

> ID：921391
> 
> 赞同：2
> 
> 时间：2009-05-28T15:14:58.787
> 
> 标签：javascript, html

我在使用 Ebay 模板时遇到问题，如果我尝试上传它，我会说它不能包含 javascript，我假设它在图片翻转选项中（鼠标悬停图片放大工具）任何帮助将不胜感激，我不是真正的Java直观。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T15:16:07.863

只需删除`<script>`和`</script>`标签之间的任何内容。或者也许在这里发布代码片段，以便我们告诉您要删除的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T15:55:49.970

模板里面应该有一个 HTML 文件。

1.  搜索 ... 零件并如前所述将其删除。
2.  搜索 onmouseover="..."、onmouseout="..." 以及通常看起来像的任何实例，删除 onsomeevent="dosomething" 部分。

# excel - 从 .NET 导出本机 Excel 2007 文件

> ID：921395
> 
> 赞同：0
> 
> 时间：2009-05-28T15:15:14.917
> 
> 标签：excel, asp.net-2.0

有谁知道可以帮助我将 GridView 的简单内容导出为本机 Excel 2007 格式（即 OpenOfficeXML 格式）的资源。

我已经看到过像[Matt Berseth 的](http://mattberseth.com/blog/2007/04/export_gridview_to_excel_1.html)解决方案，事实上我已经使用了一段时间，但是它带有一个由 Excel 2007 产生的恼人警告，[正如这里所记录](http://blogs.msdn.com/vsofficedeveloper/pages/Excel-2007-Extension-Warning.aspx)的那样，源于没有生成原生 Excel 文件的事实；而是HTML。

我最初的研究表明，xlsx 文件的核心是 zip 文件，但我不知道如何生成这些文件或其中包含什么。

任何建议（或教程）将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T15:43:31.677

[SpreadsheetGear for .NET](http://www.spreadsheetgear.com/)可以读取和写入本机 xls 和 xlsx 文件，并且比其他解决方案更易于使用（花费更少的时间），因为它具有类似 Excel 的 API，因此您无需了解任何有关 Open XML 的知识。

您可以在此处查看一些实时 ASP.NET（C# 和 VB）Excel 报告示例，并[在](https://www.spreadsheetgear.com/downloads/register.aspx)[此处](http://www.spreadsheetgear.com/support/samples/excel.aspx)下载评估版。

免责声明：我拥有 SpreadsheetGear LLC

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:17:50.437

[CarlosAg](http://www.carlosag.net/Tools/ExcelXmlWriter/)有一个运行良好的 ExcelXML 编写器。它不是原生的 excel 2007 格式文件，但可以在 excel 2007 中读取。

您将需要编写一个小方法来手动进行导出，但 API 非常简单。您将创建一个工作表对象，然后是一个行对象，然后是一个单元格对象。你可以遍历你的数据并输出它。网站上的例子相当不错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:29:00.990

我更喜欢使用微软自己的**[Open XML Format SDK](http://www.microsoft.com/downloads/details.aspx?FamilyId=C6E744E5-36E9-45F5-8D8C-331DF206E0D0&displaylang=en)**。它是免费的，由 Microsoft 发布，它创建真正的*.xlsx*文件。

您可以在[此处找到参考文档](http://msdn.microsoft.com/en-us/library/bb448854(office.14).aspx)，如您所见，它使用起来非常简单。

# msbuild - web.config 文件部分替换

> ID：921396
> 
> 赞同：0
> 
> 时间：2009-05-28T15:15:31.080
> 
> 标签：msbuild, web-deployment-project

我有一个使用外部文件替换 web.config 部分的 Web 部署项目。（这是更改连接字符串部分）。手动构建时，web.config 部分替换工作正常，但作为 TFS 构建的一部分构建时，该部分不会被替换。我在构建日志中找不到任何错误或警告。

可能的原因是什么，或者我该如何“调试”这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-28T18:06:11.660

您是否考虑过使用 Web.Config 从单独文件中提取部分的功能？您像这样引用外部文件（这是我用于加载具有我的连接字符串部分的文件的代码）：

```
<connectionStrings configSource="WebCS.config"/> 
```

然后可以将连接字符串部署为单独的文件：

```
 <connectionStrings>
       <add name="ConnString" connectionString="Data Source=<server>;Initial Catalog=<DB>;User ID=<ID>;Password=<pwd>" providerName="System.Data.SqlClient"/>
 </connectionStrings> 
```

这样，您根本不必担心更改 web.config 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:34:29.043

我不确定这是否会有所帮助....但这是一种无需替换整个配置部分即可添加/更新连接字符串的方法。

```
 public static void SaveConfigVal(string connectionString, string connName)
        {

            System.Configuration.ExeConfigurationFileMap fileMap = new System.Configuration.ExeConfigurationFileMap();
            fileMap.ExeConfigFilename = GetConfigFileName();
            //System.Configuration.Configuration config = System.Configuration.ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
            System.Configuration.Configuration config = System.Configuration.ConfigurationManager.OpenMappedExeConfiguration(fileMap, ConfigurationUserLevel.None);
            // Retrieve the section group
            ConnectionStringSettings keyValue = config.ConnectionStrings.ConnectionStrings[connName];

            // If the key already exists, just replace
            if (keyValue != null)
            {
                keyValue.ConnectionString = connectionString;
            }
            else
            {
                // Add a new key if the setting doesn't exist
                config.ConnectionStrings.ConnectionStrings.Add(new ConnectionStringSettings(connName, connectionString));
            }

            config.Save(ConfigurationSaveMode.Modified);// (ConfigurationSaveMode.Modified);
            ConfigurationManager.RefreshSection("ConnectionStrings");
        }

        private static string GetConfigFileName()
        {
            //return config file name....
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-22T00:50:31.303

如果您正在使用或可以升级到 Visual Studio 2010，则可以利用新的 web.config 转换来根据所选配置更改 web.config。

[http://msdn.microsoft.com/en-us/library/dd465318.aspx](http://msdn.microsoft.com/en-us/library/dd465318.aspx)

# unix - ping 命令的退出状态

> ID：921398
> 
> 赞同：21
> 
> 时间：2009-05-28T15:15:48.597
> 
> 标签：unix

`exit status`我的 Perl 脚本在尝试使用该`ping`命令时卡住了。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-28T15:20:48.947

根据[这个](http://linux.about.com/od/commands/l/blcmdl8_ping.htm)网站：

> 如果 ping 根本**没有收到任何回复**数据包，它将以**代码 1**退出。如果同时指定了数据包计数和截止日期，并且在截止日期到达时收到的数据包少于计数，它也会以代码 1 退出。在**其他错误时，它会以代码 2 退出**。**否则，它会以****代码 0**退出。这使得可以使用退出代码来查看主机是否处于活动状态。

列出结果：

*   成功：代码 0
*   无回复：代码 1
*   其他错误：代码 2

请注意，我链接到的页面显示“Linux/Unix ping 命令”，但其他系统，甚至可能是 Linux 和 Unix 的变体，可能会改变这个值。

如果可能的话，我会在有问题的系统上进行测试，以确保您拥有正确的系统。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-10-02T02:56:01.940

值得在您的操作系统上对此进行一些测试。例如在 OSX 上

**已启动的可解析主机**

```
ping -c 1 google.com ;  echo $? 
```

回复：

```
PING google.com (173.194.38.14): 56 data bytes
64 bytes from 173.194.38.14: icmp_seq=0 ttl=51 time=16.878 ms

--- google.com ping statistics ---
1 packets transmitted, 1 packets received, 0.0% packet loss
round-trip min/avg/max/stddev = 16.878/16.878/16.878/0.000 ms 
```

退货

```
0 
```

**已关闭/不响应 ping 的可解析主机**

```
ping -c 1 localhost  ;  echo $? 
```

回复：

```
PING stuart-woodward.local (127.0.0.1): 56 data bytes

--- stuart-woodward.local ping statistics ---
1 packets transmitted, 0 packets received, 100.0% packet loss 
```

回报：

```
2 
```

**不可解析主机**

```
ping -c 1 sdhjfjsd  ;  echo $? 
```

回复：

```
ping: cannot resolve sdhjfjsd: Unknown host 
```

回报：

```
68 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-28T15:19:57.153

> 如果从指定主机至少听到一个响应，则 ping 实用程序返回退出状态为零；如果传输成功但未收到响应，则状态为 2；如果发生错误，则为另一个值（来自 ）。

[http://www.manpagez.com/man/8/ping](http://www.manpagez.com/man/8/ping)

实际返回值可能取决于您的系统。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-17T12:18:25.290

成功的连接将始终返回**代码 0**，而失败的连接将始终返回**代码 1 及以上**。

要对此进行测试，请尝试此代码段

```
#!/bin/bash
light_red='\e[1;91m%s\e[0m\n'                     
light_green='\e[1;92m%s\e[0m\n'                   
ping -c 4 -q google.comz                          
if [ "$?" -eq 0 ]; then                           
  printf "$light_green" "[ CONNECTION AVAILABLE ]"
else                                              
  printf "$light_red" "[ HOST DISCONNECTED ]"     
fi 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-06-02T13:28:06.013

您还应该考虑到，例如，如果 ping 收到“网络无法访问”的 icmp 回复，它将被视为回复，因此返回成功状态 0（在 windows 上使用 cygwin ping 测试）。因此，对于测试主机是否还活着并且 IMO 是否存在错误并没有真正有用。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-28T15:21:05.297

`man ping`从命令行尝试。返回值列在底部附近。

# ruby - Ruby，Splat 的源代码？

> ID：921403
> 
> 赞同：8
> 
> 时间：2009-05-28T15:16:14.620
> 
> 标签：ruby, splat

昨天有人问起 splat 运算符，我想看看源代码……那是用 C 写的还是用 Ruby 写的？它会在哪里找到？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T15:30:58.397

一些快速的谷歌搜索发现它是在[eval.c](http://www.ruby-doc.org/doxygen/1.8.4/eval_8c-source.html)中实现的。您可以在文件中的几个位置找到对“splat”的引用，但我对 Ruby 的内部工作原理不够熟悉，无法理解它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-08-02T01:57:14.297

从 Ruby 2.4 开始，splat 运算符在核心 Ruby 文档中的记录很差。不过，它是该语言的核心功能，splat 运算符的源代码可以`vm_eval.c`在[`rb_yield_splat(VALUE values)`](https://github.com/ruby/ruby/blob/1f67a3900fbd45482ed36ad3b148b321307c1576/vm_eval.c#L1015-L1025).

的[单元测试](https://github.com/ruby/ruby/blob/5b593e388931490c1e2246d0347c892440167b2c/spec/rubyspec/optional/capi/kernel_spec.rb#L219-L233)使`rb_yield_splat`正在发生的事情更清楚：

```
it "yields with passed array's contents" do
  ret = nil
  @s.rb_yield_splat([1, 2]) { |x, y| ret = x + y }
  ret.should == 3
end 
```

# xcode - vim 中类似 XCode 的自动完成（没有选项卡）？

> ID：921416
> 
> 赞同：8
> 
> 时间：2009-05-28T15:17:50.247
> 
> 标签：xcode, vim, autocomplete

问候。我已经使用 vim 多年了，最近我开始玩弄 XCode。我真正喜欢 XCode 的一件事是它会**自动**完成单词**而无需**我点击`<TAB>`.

例如，在下面的这张图片中，我只需要输入`NSSObj`，其余的都是自动填写的，不需要特殊的按键。

![替代文字](https://content.screencast.com/users/natemurray/folders/Jing/media/8c5dcc35-6908-4dd4-9bd8-7aea1e315e5a/00000005.png)

我想在 vim 中重现这种效果。

需要明确的是，这个问题不是关于如何让 tab/omni-completion 在 vi​​m 中工作。我已经让 tab/omni 完成工作得很好，这不是问题。问题是：有谁知道如何让 vim 在*我输入时*自动完成？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-28T20:43:59.810

vimscripts 有一个名为[autocomplpop.vim](http://www.vim.org/scripts/script.php?script_id=1879)的插件，它可以满足您的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-24T08:56:40.903

另一种选择是 Shougo 制作的名为[neocomplcache](https://github.com/Shougo/neocomplcache)的 vim 脚本。

# visual-studio - ASP.NET 开发人员多久不使用 Visual Studio 设计模式？

> ID：921419
> 
> 赞同：5
> 
> 时间：2009-05-28T15:17:52.323
> 
> 标签：visual-studio, designmode

我们正在开发一个 ASP.NET 应用程序。我们聘请了一家外部 UI 设计公司，并且在很大程度上对他们的工作非常满意。他们向我们“交付”的是可点击的屏幕——带有 ASPX 文件、图像、母版页等的 Visual Studio 解决方案。这些屏幕没有连接到任何数据源。他们有虚拟数据，这样我们就可以看到 UI 是如何工作的。

我们遇到的一个问题是我们的开发人员习惯于使用 Visual Studio 设计模式。当我们将它们拉入设计模式时，我们从 UI 公司收到的页面有时会出现问题。顾问的开发人员在不使用设计模式的情况下对这些屏幕进行编码。

我们假设他们会使用设计模式，但合同中没有具体说明。这是不是太过分了？是不是有很多 ASP.NET 开发工作从不经过 VS 设计模式？

* * *

### 第三方编辑：

> **建议：**回答这个问题的人应该说明他们正在使用哪个版本的 Visual Studio，因为 Microsoft 废弃了 VS2005 和更早的设计器中的代码库，并将其替换为他们购买 Expression 产品时购买的代码库。两者完全无关，新的*要好得多*。-[约翰桑德斯](https://stackoverflow.com/users/76337/john-saunders)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-28T15:20:20.210

您使用 Visual Studio 的次数越多，您对设计模式的依赖就越少。复杂的 UI 往往会使设计视图看起来很糟糕。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-28T15:19:52.413

我（和同行）从不使用设计模式，原因有两个：

*   我在 VS 2003 中学会了不要触摸设计模式，因为您的 HTML 是由 VS 管理的。（虽然自 2008 年以来不再存在，但曾经被咬过......）

*   渲染可能需要很长时间。

从工具箱和手动代码拖放要快得多。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-28T15:20:59.803

***实际上，我***发现使用设计器的 ASP.NET 开发人员非常少见。众所周知，Visual Studio 设计器不擅长生成干净的标记。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-28T15:23:16.167

我*从不*使用设计模式，可能是因为它曾经把我的标记弄乱了。加上我做了很多动态渲染，所以没有意义。而且我只使用 CSS 进行格式化，我不希望 VS 乱来。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-28T15:21:49.507

由于过去的糟糕经历，许多人从未使用过它。在使用现代控件时，我发现 VS2008 中的设计模式几乎没有问题，这些控件是最新的并且具有良好的设计器支持。

另一方面，由于早期的问题，许多自定义服务器控件*没有*良好的设计器支持，因此在设计模式中的用处要小得多，因为早期的设计器代码库已被一个好的设计器代码库替换。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-28T15:21:57.603

我几乎从不使用设计模式。它通常会创建丑陋的 HTML，并称我为肛门，但我真的很喜欢干净的 HTML。如果这意味着手动编码，那就这样吧。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-28T15:23:38.597

我更喜欢手动操作，我喜欢控制。

如果我想看结果，F5。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-28T15:25:54.913

我几乎从不使用设计模式。对我来说，最大的原因是因为我在记事本中学习了网页设计/开发，所以我习惯（并且很舒服）使用代码。设计模式让我感到不舒服，因为我永远不确定 VS 会在 HTML 等方面做出什么决定。此外，我无法想象开发人员会使用设计模式来学习几乎同样多的 ASP.NET 和 VB/C# .

我唯一一次使用设计模式是自动配置 GridView 或类似的东西。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-28T15:29:50.253

设计模式在这里受到了很大的打击，但让我指出它*非常*适合学习新控件。当您不熟悉 ASP.NET 或正在使用新的控件库时，设计模式是天赐之物，原因有两个：

1.  您可以在属性编辑器上修改属性并立即看到它们的反映。对于列表容器类型的控件尤其如此，其中整个布局可能取决于一个属性。运行您的应用程序五次以查看所有五种布局是非常乏味的。
2.  具有复杂行为的控件（让我们面对现实吧，这就是您使用控件的原因，对吗？）通常在其智能标签中内置了很多配置。注意到控件右上角的小 [>] 箭头了吗？点击它。它可能会帮助你很大的时间。对于配置 DataSources 尤其如此，其语法非常细致。

当我第一次学习使用 Telerik 控件时，我非常依赖它们提供的智能标签，这些标签**非常**强大和完整。从中，您可以看到生成了什么样的 ASPX 标记并学习在设计模式之外工作。我是一个边做边学的人，所以在第一次使用某些东西时，我更喜欢这种方法来查看文档。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-28T15:49:36.220

你知道，我什至从未意识到我 100% 的时间都在使用源屏幕。我通常在VS2005中开发。

每当我真正打开设计模式时，都是偶然的，我尝试在源视图呈现之前点击它。我从来没有对设计模式印象深刻，发现它很慢并且添加了很多不必要的标记。我还发现智能感知和属性窗口意味着我不需要 GUI 来开发。

当您尝试添加任何嵌套项目时，设计模式也可能是一场噩梦。因为我们一直在为使用 IE6 的客户进行开发，所以我们一直在使用表格进行格式化，因此我们不需要不同的 DIV 定义。仅单击空单元格可能会很困难，并且调整列的大小可能会花费很长时间。

对于网格中的模板字段之类的东西，我什至不知道如何在设计视图中进行设置！

话虽如此，每次都为 Windows 应用程序设计模式！

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-28T16:26:33.353

我使用的是VS2008，我从不使用设计视图。我发现代码视图比设计器更容易且响应更快。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-28T15:23:39.940

设计模式越来越好，我想说随着时间的推移，它可能会变得更加普遍，并且设计模式工具会不断改进。我为设计模式设计了所有组件，但我仍然手动完成大部分代码 - 它允许更好地控制代码布局，并且最终不会产生自动格式化的混乱，然后我必须深入研究找出需要做出哪些改变。我知道将来我的组件可能会被开发人员使用，他们的大部分设计都是通过拖放完成的，现在解决这个问题比在活动结束后回来做更容易。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-28T16:05:42.537

当然，我正在做 MVC 的东西，但我从不使用它——我是用 PHP 和代码编辑器“长大”的，它仍然对我很好。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-28T16:18:57.300

我正在使用两个不同版本的 .NET（2003 和 2005）。2003年写的一些表格，2003年不能再编辑了，安装需要在2003年维护，所以我用KEDIT来编辑这些表格。一个应用程序中的某些表单对于 .NET 编辑器来说太大了，无论如何我更喜欢强大的编辑器。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-28T15:26:56.453

我在设计模式下工作没有问题。一个例外是不支持的 asp:Repeaters，或者倾向于覆盖我的手动列定义的 GridViews。

另一种情况是，如果我重命名控件，VS 会尝试进行完整的项目扫描，然后失败。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-28T16:09:40.410

我们主要使用代码视图。我们在 VS 2008 中发现的设计模式有很多错误。由于某种原因，XML 控件倾向于拒绝随机字符集，并且 VS 在尝试在屏幕上呈现所有内容时通常会运行缓慢。我主要使用代码视图。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-28T16:36:45.470

传统上，WYSIWYG 设计人员生成的代码很差，CSS 和#INCLUDEd 文件的渲染也很差，因此它们的用途有限，因此开发人员倾向于手动编写代码。此外，这些工具允许您在不真正了解自己在做什么的情况下走一定的距离，这对于网络教程和个人主页来说很好，但是一旦您想要额外程度的控制，您就会陷入困境 - 当您有无论如何都要求助于“在引擎盖下”。

尽管工具随着时间的推移而改进，但许多开发人员对手工编码非常满意，以至于他们几乎忘记了设计视图——我当然不记得我上次使用它是什么时候了。我敢肯定，在很多情况下，此类工具可能真正有用，但我们在没有并且不想担心何时何地可以最好地使用此类功能时做得很好。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-28T19:22:00.987

我们的 UI 很复杂，我们无法在 VS2005 中使用设计模式。

我唯一一次接触设计模式是做一个快速而肮脏的原型或内部应用程序。

我多久不使用设计模式？99% 的时间。

# matrix - LAPACK/BLAS 或其他地方是否有 Fortran 子程序来计算 LDL 分解？

> ID：921422
> 
> 赞同：2
> 
> 时间：2009-05-28T15:18:57.907
> 
> 标签：matrix, linear-algebra, lapack, decomposition

就像标题说的那样，我需要为我的正定矩阵A形成cholesky LDL分解（就像普通的cholesky，但是L的一个对角线，D是对角矩阵）。我在 Lapack 中发现只有一个函数可以做到这一点，但它说矩阵 A 必须是三对角矩阵。在一些免费的子程序库（如 lapack）中是否有某种功能可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-14T05:19:33.913

查看 LAPACK 中的 SSPTRF 函数：

> 用途
> =======
> 
> SSPTRF 使用 Bunch-Kaufman 对角旋转方法计算以压缩格式存储的实对称矩阵 A 的因式分解：
> 
> A = U*D*U**T 或 A = L*D*L* *T
> 
> 其中 U（或 L）是置换和单位上（下）三角矩阵的乘积，而 D 是对称的，并且具有 1×1 和 2×2 对角块的对角块。

此外，Golub 和 van Loan 的“矩阵计算”一书提供了一种用于进行分解的算法。在我的第三版中，它位于第 138 页，第 4.1.2 节“对称性和 LDL^T 分解”。

# c# - NHibernate：插入后需要使用@@identity 更新对象ID

> ID：921431
> 
> 赞同：1
> 
> 时间：2009-05-28T15:20:04.923
> 
> 标签：c#, asp.net-mvc, nhibernate

我第一次使用 NHibernate 并且正在苦苦挣扎。在第一个网页上，我开始了一个表格。我想保存并导航到第二页。如何使用新插入行的 ID 更新我的 RequestForm 对象？当我调用重定向时，它仍然为 0，尽管数据已保存到数据库中。

这是我的控制器代码：

```
 [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult New(RequestForm form)
    {
        // contract
        if (form == null)
        {
            throw new ArgumentException("Cannot be null", "form");
        }

        // validate the form
        form.Validate(ModelState);

        // if valid, save & continue
        if (ModelState.IsValid)
        {
            var request = new Request();
            form.Update(request);
            repository.Save(request);
            return RedirectToAction("Edit", "Request", new {id = form.ID});
        }

        // if not valid, return new form
        return View("New", form);
    } 
```

这是存储库代码：

```
 public void Save(T entity)
    {
        using (ISession session = GetSession())
        using (ITransaction transaction = session.BeginTransaction())
        {
            session.SaveOrUpdate(entity);
            transaction.Commit();
        }
    } 
```

这是映射文件的相关区域：

```
<class
  name="Request"
  table="Data_Requests"
  dynamic-update="true">

<id 
  name="Id" 
  type="Int32" 
  access="property"
  column="RequestId"
  unsaved-value="0">
  <generator class="native"/>
</id> 
```

感谢您阅读我的问题。我敢肯定，一旦您知道自己在做什么，答案就很容易:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T15:23:25.650

您是否尝试过设置`<generator class="identity"/>`. 它应该适用于本机，但谁知道......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T16:41:25.850

好的 - 愚蠢的错误

```
return RedirectToAction("Edit", "Request", new {id = form.ID}); 
```

应该

```
return RedirectToAction("Edit", "Request", new {id = request.ID}); 
```

# javascript - 如何做可本地化的javascript？

> ID：921433
> 
> 赞同：0
> 
> 时间：2009-05-28T15:20:16.343
> 
> 标签：javascript, localization

我有一个使用大量 javascript 的 Web 应用程序，并且像往常一样，有很多文本常量将显示给嵌入在代码本身中的用户。

您认为实现本地化的最佳方式是什么？
我知道我需要从代码中删除这些字符串并用常量替换它们，这些常量将被定义到某个外部位置。

对于服务器端，ASP.Net 提供了一些非常简洁的功能来处理这个问题。
在 Javascript 中最好的方法是什么？

我最好的想法是有一个 JS 文件，其中包含网站 JS 的所有字符串常量（对于每种语言，我都有不同的副本），然后在每个页面上，我首先包含这个脚本，之前所有其他人。
这似乎是最集中的方式，也浪费最少的带宽。

还有其他更好的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T16:03:58.300

你的方法是有道理的。细节：

我会在一个对象中拥有每种语言的字符串。

本地化={“猫”：“聊天”，“狗”：“chien”}；

然后在代码中：

本地化[“猫”]

键和数组表示法（而不是更常见的对象点表示法）的引号是为了避免与 JavaScript 保留字冲突。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:21:56.640

以下是我们的做法（在 ASP.net 中），与您提到的内容大致相同： 1) 创建了两个 javascript 文件：一个定义了站点所需的所有 javascript 函数/DOM 操作，第二个称为Messages.js：它定义了所有需要本地化的字符串文字，例如 var ALERT_MSG = "Alert message in english"。

2) 创建不同版本的 Messages.js，为我们支持的每个区域设置一个版本，并对字符串进行本地化。本地化的 js 文件使用 messages.locale.js 命名约定命名（例如，messages.fr-FR.js）。

3) 在“ScriptManager”中包含 js 文件并为 Messages.js 文件提供 ResourceUICultures：这可确保在 html 输出中嵌入正确的本地化文件（如果您不使用 ASP.net，则可以构建此基本功能通过进行一些文化嗅探并包含适当的 js 文件）。

4）瞧！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T15:32:07.067

有一个[gettext 库](http://code.google.com/p/gettext-js/wiki/MainDocumentation)，但我没有使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T15:52:13.877

你的方法听起来足够好。

如果您有很多字符串并且您担心文件的庞大性，您可能需要考虑一个脚本，该脚本通过连接代码 javascript 和语言环境 javascript 然后应用像[Minify](http://code.google.com/p/minify/)之类的东西来为每种语言创建一个 javascript 文件。

您会在发布上浪费一些 CPU 周期，但会节省一些往返行程......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-15T07:06:37.823

有一个用于本地化 JavaScript 应用程序的库：[https ://github.com/wikimedia/jquery.i18n](https://github.com/wikimedia/jquery.i18n)

正如几乎所有其他人所建议的那样，字符串存储在 JSON 文件中，但它还有更多功能：

可以做参数替换，支持性别（巧妙处理他/她）、数字（巧妙处理复数，包括有多个复数形式的语言），以及一些语言需要的自定义语法规则。

唯一的要求是 jQuery。

# c# - 处理 C# WebService 异常

> ID：921436
> 
> 赞同：2
> 
> 时间：2009-05-28T15:20:27.963
> 
> 标签：c#, web-services, exception

当我在我的 C# WebService 中抛出异常（SoapException，真正的异常作为内部异常）时，客户端收到带有以下消息的异常。我可以压制所有的 HTML 内容，只用我想要的消息发送异常。

这不是完整的信息，只是我不想摆脱的部分。

```
The request failed with the error message:
--
<html>
    <head>
        <title>Runtime Error</title>
        <style>
         body {font-family:"Verdana";font-weight:normal;font-size: .7em;color:black;} 
         p {font-family:"Verdana";font-weight:normal;color:black;margin-top: -5px}
         b {font-family:"Verdana";font-weight:bold;color:black;margin-top: -5px}
         H1 { font-family:"Verdana";font-weight:normal;font-size:18pt;color:red }
         H2 { font-family:"Verdana";font-weight:normal;font-size:14pt;color:maroon }
         pre {font-family:"Lucida Console";font-size: .9em}
         .marker {font-weight: bold; color: black;text-decoration: none;}
         .version {color: gray;}
         .error {margin-bottom: 10px;}
         .expandable { text-decoration:underline; font-weight:bold; color:navy; cursor:hand; }
        </style>
    </head>

    <body bgcolor="white">

            <span><H1>Server Error in '/MyWeb.Service' Application.<hr width=100% size=1 color=silver></H1>

            <h2> <i>Runtime Error</i> </h2></span>

            <font face="Arial, Helvetica, Geneva, SunSans-Regular, sans-serif ">

            <b> Description: </b>An application error occurred on the server. The current custom error settings for this application prevent the details of the application error from being viewed.
            <br><br>

            <b>Details:</b> To enable the details of this specific error message to be viewable on the local server machine, please create a <customErrors> tag within a "web.config" configuration file located in the root directory of the current web application. This <customErrors> tag should then have its "mode" attribute set to "RemoteOnly". To enable the details to be viewable on remote machines, please set "mode" to "Off".<br><br>

            <table width=100% bgcolor="#ffffcc">
               <tr>
                  <td>
                      <code><pre>

<!-- Web.Config Configuration File -->

<configuration>
    <system.web>
        <customErrors mode="RemoteOnly"/>
    </system.web>
</configuration></pre></code>

                  </td>
               </tr>
            </table>

            <br>

            <b>Notes:</b> The current error page you are seeing can be replaced by a custom error page by modifying the "defaultRedirect" attribute of the application's <customErrors> configuration tag to point to a custom error page URL.<br><br>

            <table width=100% bgcolor="#ffffcc">
               <tr>
                  <td>
                      <code><pre>

<!-- Web.Config Configuration File -->

<configuration>
    <system.web>
        <customErrors mode="On" defaultRedirect="mycustompage.htm"/>
    </system.web>
</configuration></pre></code>

                  </td>
               </tr>
            </table>

            <br>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:24:54.353

这取决于，如果您使用 WCF，您可以定义自定义异常。您希望客户端看到的所有异常都必须是 FaultException 类型。

您的自定义异常如下所示：

```
 [DataContract]
    public class CustomFault
    {
       public CustomFault()
       {
       }

        public CustomFault(string message)
        {
            Message = message;
        }

        [DataMember]
        public string Message { get; private set; }
    } 
```

你抛出你的自定义异常是这样的：

```
throw new FaultException<CustomFault>(new CustomFault("your custom message")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:26:59.760

我不认为你得到你正在考虑的错误。看起来您的客户无法访问您的服务并获得网页错误，获取该 html 并将其包装在一个肥皂异常中。由于您的 Web 服务不可访问，因此您无法在代码中执行任何操作来处理它。你能在浏览器中成功加载你的 WSDL 吗？

# asp.net - 有人可以解释一下 VistaDB 吗？

> ID：921438
> 
> 赞同：5
> 
> 时间：2009-05-28T15:20:41.273
> 
> 标签：asp.net, vistadb

我看到它越来越多地弹出并没有真正理解它的目的？我只能在桌面本地开发时使用它吗？

或者我可以将商业站点放在使用 VistaDB 的 Win2003 的服务器上吗？它比使用 SQL DB 更快吗？它安全吗？

使困惑...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T15:38:09.490

VistaDB 是 Microsoft 提供的轻量级数据库系统的 .NET 替代品：Jet (Microsoft Access)、MSDE、Sql Server CE 或 Sql Server Express。您可以在任何需要数据库的 .NET 应用程序中使用它，并且您并不真正想要拥有客户端/服务器数据库的开销。

VistaDB 是一个嵌入式数据库（其他一些嵌入式数据库是 SQLite 和 FireBird）。这基本上意味着您的数据库对最终用户完全“不可见”。例如，他们不需要安装像 SQL Server 这样的客户端/服务器数据库。部署 VistaDB 很简单。您所需要的只是数据库文件和对应用程序中 VistaDB 运行时 DLL 的引用。

使用 VistaDB 作为后端的商业应用程序是[Graffiti CMS](http://graffiticms.com/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-29T22:11:33.123

您可能还想查看[有关 VistaDB 的 StackOverflow 主题](https://stackoverflow.com/questions/55273/what-are-the-advantages-of-vistadb)。

没有什么比 SQL Server 更快的了。如果您认为 SQL Server 太慢，您可能做错了什么。它非常快。100% 托管的引擎在所有方面都不会比 SQL Server 更快。

减少资源 - 是的

更易于部署 - 是（xcopy 部署）

桌面数据库 - 是的，您可以将其用于应用程序的桌面开发。有些人还将它用于共享驱动器上的多用户应用程序。网站是您无法安装服务或不想为托管帐户上的 SQL Server 访问支付额外费用的另一个目标。

安全性 - VistaDB 在您的应用程序中运行。没有用户安全的概念，因为您直接加载它。

并发性 - 取决于您的应用程序。我们支持多个进程访问同一个数据库，但某些操作仍然存在您必须在代码中处理的锁定问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T15:30:49.737

据我所知，他们的网站[http://www.vistadb.net/](http://www.vistadb.net/)：

*   您可以将其用于开发和商业目的
*   它不是服务器，它是您的网站/应用程序的程序集
*   我的**猜测**是，由于它不是一个功能齐全的 SQL 服务器，它应该在资源上更快更轻
*   不知道它有多安全，但他们说你可以把它放在“中等信任”的网站上。

# c - 如何在 GTK 应用程序中嵌入 Flash 播放器？

> ID：921439
> 
> 赞同：6
> 
> 时间：2009-05-28T15:20:43.173
> 
> 标签：c, linux, gtk, flash, embedded-flashplayer

`c`有没有人尝试将Adob​​e FlashPlayer 嵌入到编写的应用程序中`Gtk`？

可能吗？有什么好的开始吗？

PS：我不想将`WebKit`或`Gecko`渲染引擎嵌入到我的应用程序中！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T08:26:05.680

GStreamer 有一个 flash 插件。Gnash 和 klash 也是免费的 swf 播放器。您可以从这个应用程序开始。该代码是免费使用的:)

问候

# entity-framework - 行插入顺序实体框架

> ID：921442
> 
> 赞同：16
> 
> 时间：2009-05-28T15:20:54.360
> 
> 标签：entity-framework, transactions, insert

我正在使用事务在多个表中插入多行。对于这些行，我想按顺序添加这些行。在调用 SaveChanges 时，所有行都被乱序插入。

当不使用事务并在每次插入后保存更改时确实保持顺序，但我真的需要所有条目的事务。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-28T16:06:36.123

实体框架中的插入/更新和删除顺序取决于实体框架中的许多东西。

例如，如果您在新类别中插入新产品，我们必须在产品之前添加类别。

这意味着，如果您有大量更改，那么我们必须首先满足局部排序约束，这确实是我们所做的。

您在上下文中执行操作的顺序可能与这些规则相冲突。例如，如果您这样做：

```
ctx.AddToProducts(
   new Product{
      Name = "Bovril",
      Category = new Category {Name = "Food"}
   }
); 
```

效果是首先将产品添加（到上下文中），然后当我们遍历图表时，我们也添加了类别。

即在上下文中的插入顺序是：

```
Product
Category 
```

但由于参照完整性约束，我们必须在尝试插入数据库之前像这样重新排序：

```
Category
Product 
```

所以这种本地重新排序是不可协商的。

但是，如果没有像这样的本地依赖项，理论上您可以保留排序。不幸的是，我们目前不跟踪“何时”将某些内容添加到上下文中，并且出于效率原因，我们不跟踪实体以保留列表等结构。因此，我们目前无法保留不相关插入的顺序。

但是我们最近还在讨论这个问题，所以我很想知道这对你有多重要？

希望这可以帮助

亚历克斯

项目经理实体框架团队

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-23T00:49:08.800

我正在过这座桥。我正在用 EF 替换 NHibernate，我遇到的问题是如何将列表插入数据库。如果我将项目添加到这样的列表中（在伪代码中）：

list.Add(testObject); list.Add(testObject1);

我目前不能保证在运行“SaveChanges”时获得相同的订单。这是一种耻辱，因为我的列表对象（即链表）知道它的创建顺序。使用引用链接在一起的对象必须以相同的顺序保存到数据库中。不知道你为什么提到你正在“辩论”这个。=)

# php - 在变量中正确使用引号输出 JavaScript

> ID：921450
> 
> 赞同：-1
> 
> 时间：2009-05-28T15:21:56.497
> 
> 标签：php, javascript, html, quotes

我正在使用以下代码创建一大块 HTML/JavaScript：

```
$result = mysql_query("SELECT * FROM posts WHERE userid = '$user_id' ORDER BY DATE desc LIMIT 5")or die (mysql_error());

while ($row = mysql_fetch_array($result))
{

    $source = $row[source];
    $source = "'$source'";

    $p = $p.'<div id="red-div"><div id="smartass"><div id="image"><img src="thumbs/'.$user_image.'" /></div><div id="playsong"><a href="#" onclick="playsong(';
    $p = p.$source;
    $p = $p.'); return false;"><img src="play.png" width="16" height="16" border="0" /></a>'.$row[artist].' - '.$row[title].'</div></div><div id="post-comment">'.$row[comment].'</div><div id="post-date">'.$row[date].'</div></div><div id="dotted-line"></div>';

} 
```

然后，我使用以下代码更新页面的一部分：

```
parent.document.getElementById('posts').innerHTML = '<?php echo $p; ?>'; 
```

出于某种原因，无论我如何引用或`$source`进入`playsong('')`；我失去了`''`导致`playsong();`类似的东西`playsong(theSongVariable);`，这当然不起作用。

我如何正确引用或输出`''`以确保它们留在`playsong('')`;？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T15:29:22.207

如果可能，您应该使用[`json_encode`](http://docs.php.net/json_encode)构建 JavaScript 字符串声明并将`htmlspialchars`其用作 HTML 属性值：

```
$onclick = 'playsong('.json_encode($row['source']).'); return false';
$p .= '<div id="red-div"><div id="smartass"><div id="image"><img src="thumbs/'.htmlspecialchars($user_image).'" /></div>';
$p .= '<div id="playsong"><a href="#" onclick="'.htmlspecialchars($onclick).'"><img src="play.png" width="16" height="16" border="0" /></a>';
$p .= htmlspecialchars($row[artist].' - '.$row[title]).'</div></div>';
$p .= '<div id="post-comment">'.htmlspecialchars($row['comment']).'</div>';
$p .= '<div id="post-date">'.$row['date'].'</div></div><div id="dotted-line"></div>'; 
```

哦，[ID 在文档中必须是唯一的](http://www.w3.org/TR/html401/struct/global.html#adef-id)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T15:26:36.643

您是否尝试过在 $p 字符串上使用[addlashes函数。](http://www.php.net/manual/en/function.addslashes.php)我认为它的主要目的与为数据库构建查询有关，但它也可能适用于您的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T15:48:59.110

根据您使用它们的上下文，有不同的方法可以转义字符串。

在您的具体情况下，您应该使用：

`echo json_encode(htmlspecialchars($p, ENT_QUOTES, *your charset*));`

[htmlspecialchars](http://us2.php.net/htmlspecialchars)可帮助您转义 HTML 序列，这样您就不会出现`</script>`Javascript 部分等时髦的东西。

[json_encode](http://us2.php.net/json_encode)确保您的字符串作为 JavaScript 序列是有效的。

这些是非常重要的安全概念，否则如果您在您的网站上授予用户特殊权限，则会出现[XSS](http://en.wikipedia.org/wiki/Cross-site_scripting)甚至[XSRF等严重问题。](http://en.wikipedia.org/wiki/Cross-site_request_forgery)

在我们讨论这个主题时，请确保您的 $user_id 是经过验证的值，否则您很容易受到[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)的攻击。例如，$user_id 可以是“1”或“1”=“1”。

Hth

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T15:26:40.557

编辑：也不应该

```
$p = p.$source; 
```

是

```
$p = $p.$source; 
```

顺便说一句，不要忘记您可以使用 .= 运算符。像

```
$p .= $source; 
```

编辑2：尝试使用输出您的 $p 进行分析（将 < 更改为 <

```
echo htmlspecialchars($p); 
```

编辑删除 JS 行。显然不是从 <?php ?> 块中输出的。（应该先喝我的咖啡）

# sql-server - 用于极长期数据归档的技术解决方案？

> ID：921451
> 
> 赞同：13
> 
> 时间：2009-05-28T15:21:56.527
> 
> 标签：sql-server, archiving, historical-db

对于极长期的数据归档，例如 25 到 100 年，是否有任何好的技术解决方案？

不知何故，我不太相信 SQL 2000 备份文件将在 25 到 100 年内用于法庭案件或历史学家。

这是客户的要求，而不仅仅是猜测。

这类似于尝试通过备份 ENIAC 或读取 Atari Writer 字处理文件来尝试做一些有用的事情。硬件不再存在，存储介质可能已损坏，使用该技术的专业人员可能不再存在，等等。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T16:26:19.487

实际上，在无酸纸上打印可能是比任何更先进的技术更好的解决方案。与基于 100 年历史的媒体访问硬件、技术和标准、100 年历史的磁盘/文件的任何数字数据存储相比，超过 100 年的 IT 技术更有可能实现高速扫描和加载打印格式标准和 100 年前的数据编码标准。

不同意？我有一整个阁楼，里面装满了乙烯基 CD、8 轨、盒式磁带、软盘（4 种不同的密度！）。而且他们只有20岁！（好的，8 轨接近 30）。

事实是，只有一种数据存储和归档技术经受住了 100 年或更长时间的时间考验，并且仍然可以经济高效地检索，那就是在物理介质上的写入/打印。

我的建议？在经过测试之前不要相信任何存档策略，到目前为止只有一个通过了 100 年的测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T15:40:09.390

您需要转换为文本——也许是 XML。

然后将其上传到云端，制作存档副本等。

我认为您需要选择一种多模式方法。

如果您有预算：[http ://www.archives.gov/era/papers/thic-04.html](http://www.archives.gov/era/papers/thic-04.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-28T15:34:37.483

<笑话>打印出来。</笑话>

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T15:29:52.500

将数据写入平面文件（每个表一个文件或将多个表汇总到一个文件中），将它们写入高端存档 CD。100 年后，他们将不得不将这些数据加载到他们拥有的任何“数据库”中，因此需要进行一些手动转换，因此将一个好的模式脚本转储到单个文件中将有助于穷人试图读取这些文件并制作适当的连接。

**EDIT** 为客户提供服务合同，确保他们每年都使用最新的档案技术。这可能是件好事 $

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T15:48:42.837

我建议您咨询该领域的专业公司。

您可能还对这篇文章感兴趣： [长期数据保留策略](http://www.computerweekly.com/Articles/2007/10/16/227474/strategies-for-long-term-data-retention.htm)

与其中一家公司/组织交谈可能会有所帮助

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-06T01:55:20.503

我不知道是否有人不再阅读此线程，但对此有一个非常好的解决方案。

有一家名为 Millenniata 的新公司，其产品名为**M-Disc。** M-Disc 本质上是一种由类似岩石的材料制成的 DVD，估计保质期为**1,000 年以上**。你必须有一个特殊的 DVD 刻录机来刻录 DVD，但它并不昂贵。加上任何普通的 DVD 阅读器都可以读取它们。我在 BYU 有一位教授帮助组建了这家公司，这是一项非常酷的技术。祝你好运。

[链接到 M-Disc 网站](http://millenniata.com/)

# bash - 如何使用 cat 进行编程？

> ID：921455
> 
> 赞同：23
> 
> 时间：2009-05-28T15:22:26.993
> 
> 标签：bash, command-line, code-golf

在这部[xkcd 漫画](http://xkcd.com/378/)中： ![真正的程序员](https://imgs.xkcd.com/comics/real_programmers.png "真正的程序员在开始时就设置了通用常数，这样宇宙就会进化到包含他们想要的数据的磁盘。")

他们提到真正的程序员使用`cat`. 好吧，我在问自己：你怎么能用这个`cat`命令来编程？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-05-28T15:26:35.393

```
$ cat > hello.c
#include <stdio.h>

main(void) {
    printf("Hello, world.\n");
}
^D
$ gcc hello.c
$ ./a.out
Hello, world. 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-05-28T15:32:20.857

不，`echo`显然更好：

```
echo 'main(){puts("Hello world\n");}'  | gcc -xc - 
```

即使您想使用`cat`（猫科动物毕竟很棒），为什么还要将源代码放入磁盘？只需将`cat`' 的输出重定向到编译器，就像这种`echo`情况一样。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-07-27T15:13:24.637

`gcc`? 真正的程序员使用`cat` *and* `xxd`：

```
$ cat | xxd -r > a.out
0000000: cefa edfe 0700 0000 0300 0000 0200 0000  ................
0000010: 0b00 0000 a803 0000 8500 0000 0100 0000  ................
0000020: 3800 0000 5f5f 5041 4745 5a45 524f 0000  8...__PAGEZERO..
0000030: 0000 0000 0000 0000 0010 0000 0000 0000  ................
<lot of other stuff>
0003090: 0a00 0000 0b00 0000 2000 6479 6c64 5f73  ........ .dyld_s
00030a0: 7475 625f 6269 6e64 696e 675f 6865 6c70  tub_binding_help
00030b0: 6572 005f 5f64 796c 645f 6675 6e63 5f6c  er.__dyld_func_l
00030c0: 6f6f 6b75 7000 6479 6c64 5f5f 6d61 6368  ookup.dyld__mach
00030d0: 5f68 6561 6465 7200 5f4e 5841 7267 6300  _header._NXArgc.
00030e0: 5f4e 5841 7267 7600 5f5f 5f70 726f 676e  _NXArgv.___progn
00030f0: 616d 6500 5f5f 6d68 5f65 7865 6375 7465  ame.__mh_execute
0003100: 5f68 6561 6465 7200 5f65 6e76 6972 6f6e  _header._environ
0003110: 005f 6d61 696e 0073 7461 7274 005f 6578  ._main.start._ex
0003120: 6974 005f 7075 7473 0000 0000            it._puts....
^D
$ chmod 755 ./a.out
$ ./a.out
Hello, world. 
```

顺便说一句，我不知道这`0xFEEDFACE`是 Mach-O 二进制文件中的神奇数字……很酷。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-12-14T05:25:53.260

![我可以有编程语言吗？](https://i.stack.imgur.com/KSeaw.jpg)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-28T15:26:24.053

我想你可能错过了这个笑话。关键是那`cat`不是编辑器；这只是一种将文本一次性放入文件的方法，无需编辑或更正。你写一次，就是这样。

如果你正在处理其他事情，你能更清楚吗？

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-28T15:27:54.563

笑话是你不编辑，你只是使用`cat`并且也许（如果你会变得迟钝）`echo`......。例如：

```
echo "#stdio.h\n int main(int argc, char **argv){\nprintf(\"hello World\\n\");\nreturn(0);\n}" > helloworld.c 
```

然后

```
cat helloworld.c 
```

重复。

**（另外，我一定很无聊去打字）**

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-22T14:05:26.693

有[一本](http://www.shlomifish.org/humour/bits/Mastering-Cat/)关于这个主题的书。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-07-27T15:04:39.503

让我们看看我们能走多远。

所有这些的输出将是：

```
你好世界

```

```
$ perl -E"$(cat)"
say 'Hello World'
^D 
```

```
$ test=$(cat); perl -E"$test"
say 'Hello World'
^D 
```

```
$ cat | perl -M5.010
say 'Hello World'
^D 
```

```
$ cat > test; test=$(cat test); perl -E"$test"
say 'Hello World'
^D 
```

```
$ cat > test; test=$(cat test)$(cat); perl -E"$test"
say
^D
'Hello World'
^D 
```

```
$ cat > test; test=$(cat test); perl -E"$test$(cat)"
say
^D
'Hello World'
^D 
```

```
$ cat > test; test=$(cat test); perl -E"$(cat)$test"
'Hello World'
^D 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-12T11:50:26.220

我窃取了接受和投票最多的答案，并将其与 echo 答案结合起来，但如果编译成功，我添加了自动条件执行。

```
$ cat | gcc -xc - && ./a.out
#include <stdio.h>

main(void) {
    printf("Hello, world.\n");
}
^D
Hello, world. 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-06-06T18:48:07.063

[检查这篇](https://rstcenter.com/forum/14753-writing-linux-programs-raw-binary.rst)文章

这篇文章有点过时了，因为它对 vsyscall 页面的位置做出了某些假设。但是如果你有一个运行 2.5.53 内核的 linux 副本，你应该能够运行类似的东西：

```
/bin/echo -ne '\x7f\x45\x4c\x46\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x03\x00\x01\x00\x00\x00\x74\x80\x04\x08\x34\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x34\x00\x20\x00\x02\x00\x28\x00\x00\x00\x00\x00\x01\x00\x00\x00\x74\x00\x00\x00\x74\x80\x04\x08\x74\x80\x04\x08\x19\x00\x00\x00\x19\x00\x00\x00\x05\x00\x00\x00\x00\x10\x00\x00\x01\x00\x00\x00\x8d\x00\x00\x00\x8d\x90\x04\x08\x8d\x90\x04\x08\x05\x00\x00\x00\x05\x00\x00\x00\x06\x00\x00\x00\x00\x10\x00\x00\xb0\x04\xb3\x01\xb9\x8d\x90\x04\x08\xb2\x05\xe8\x90\x63\xfb\xf7\xb0\x01\xb3\x00\xe8\x87\x63\xfb\xf7\x54\x65\x73\x74\x0a' > foo.bin
chmod +x foo.bin
./foo.bin
# would print "Test" 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-12-14T06:18:42.000

请参阅有关 Real Programmers 的 Wikipedia 文章。你可以在网上找到教程。最好先了解汇编（非常了解）。

“真正的程序员不使用 IDE，他们使用 cat > a.out 编写程序”（也就是说，他们从头到尾编写机器可读的二进制文件，没有任何错误）。

# delphi - 替换文件中的字符（更快的方法）

> ID：921456
> 
> 赞同：3
> 
> 时间：2009-05-28T15:22:30.037
> 
> 标签：delphi, file, replace, ascii

我们经常用另一个“好”字符替换文件中不需要的字符。

界面是：

```
procedure cleanfileASCII2(vfilename: string; vgood: integer; voutfilename: string); 
```

用我们可以调用的空格替换所有不受欢迎的内容， cleanfileASCII2(original.txt, 32 , clean.txt)

问题是这需要相当长的时间。有比显示的更好的方法吗？

```
procedure cleanfileASCII2(vfilename: string; vgood: integer; voutfilename:
string);
var
  F1, F2: file of char;
  Ch: Char;
  tempfilename: string;
  i,n,dex: integer;
begin
   //original
    AssignFile(F1, vfilename);
    Reset(F1);
    //outputfile
    AssignFile(F2,voutfilename);
    Rewrite(F2);
      while not Eof(F1) do
      begin
        Read(F1, Ch);
        //
          n:=ord(ch);
          if ((n<32)or(n>127))and (not(n in [10,13])) then
             begin // bad char
               if vgood<> -1 then
                begin
                ch:=chr(vgood);
                Write(F2, Ch);
                end
             end
           else   //good char
            Write(F2, Ch);
      end;
    CloseFile(F2);
    CloseFile(F1);
end; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T16:12:03.837

问题与您如何处理缓冲区有关。内存传输是任何操作中最昂贵的部分。在这种情况下，您正在逐字节查看文件。通过更改为块读取或缓冲读取，您将实现速度的巨大提升。请注意，正确的缓冲区大小会根据您读取的位置而有所不同。对于网络文件，您会发现由于 TCP/IP 强加的数据包大小，非常大的缓冲区可能效率较低。即使这对于来自 gigE 的大数据包也变得有点模糊，但一如既往，最好的结果是对其进行基准测试。

为了方便起见，我从标准读取转换为文件流。您可以使用块读取轻松地做同样的事情。在这种情况下，我拿了一个 15MB 的文件并通过你的例程运行它。对本地文件执行操作花费了 131,478 毫秒。使用 1024 缓冲区，需要 258 毫秒。

```
procedure cleanfileASCII3(vfilename: string; vgood: integer; voutfilename:string);
const bufsize=1023;
var
  inFS, outFS:TFileStream;
  buffer: array[0..bufsize] of byte;
  readSize:integer;
  tempfilename: string;
  i: integer;
begin
   if not FileExists(vFileName) then exit;

   inFS:=TFileStream.Create(vFileName,fmOpenRead);
   inFS.Position:=0;
   outFS:=TFileStream.Create(vOutFileName,fmCreate);
   while not (inFS.Position>=inFS.Size) do
      begin
      readSize:=inFS.Read(buffer,sizeof(buffer));
      for I := 0 to readSize-1 do
          begin
          n:=buffer[i];
          if ((n<32)or(n>127)) and (not(n in [10,13])) and (vgood<>-1) then
             buffer[i]:=vgood;
          end;
      outFS.Write(buffer,readSize);
      end;
   inFS.Free;
   outFS.Free;
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:07:37.590

多项改进：

1.  缓冲数据，读取 2k 或 16k 或类似大小的块
2.  使用查找表

这是一个未经测试的刺（现在我面前没有编译器）：

```
procedure cleanfileASCII2(vfilename: string; vgood: integer; voutfilename: string);
var
    f1, f2: File;
    table: array[Char] of Char;
    index, inBuffer: Integer;
    buffer: array[0..2047] of Char;
    c: Char;
begin
    for c := #0 to #31 do
        table[c] := ' ';
    for c := #32 to #127 do
        table[c] := c;
    for c := #128 to #255 do
        table[c] := ' ';
    table[#10] := #10; // exception to spaces <32
    table[#13] := #13; // exception to spaces <32

    AssignFile(F1, vfilename);
    Reset(F1, 1);
    AssignFile(F2,voutfilename);
    Rewrite(F2, 1);
    while not Eof(F1) do
    begin
        BlockRead(f1, buffer, SizeOf(buffer), inBuffer);
        for index := 0 to inBuffer - 1 do
          buffer[index] := table[buffer[index]];
        BlockWrite(f2, buffer, inBuffer);
    end;
    Close(f2);
    Close(f1);
end; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T16:04:48.467

缓冲是做到这一点的正确方法。我修改了您的代码以查看差异：

```
procedure cleanfileASCII2(vfilename: string; vgood: integer; voutfilename:
string);
var
  F1, F2: file;
  NumRead, NumWritten: Integer;
  Buf: array[1..2048] of Char;
  Ch: Char;
  i, n: integer;
begin
    AssignFile(F1, vfilename);
    Reset(F1, 1); // Record size = 1
    AssignFile(F2, voutfilename);
    Rewrite(F2, 1); // Record size = 1
    repeat
      BlockRead(F1, Buf, SizeOf(Buf), NumRead);
      for i := 1 to NumRead do
      begin
        Ch := Buf[i];
        //
        n := ord(ch);
        if ((n<32)or(n>127))and (not(n in [10,13])) then
        begin // bad char
         if vgood <> -1 then
         begin
           ch := chr(vgood);
           Buf[i] := Ch;
         end
        //else   //good char
         //Write(F2, Ch);
        end;
      end;
      BlockWrite(F2, Buf, NumRead, NumWritten);
    until (NumRead = 0) or (NumWritten <> NumRead);
    CloseFile(F1);
    CloseFile(F2);
end; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T15:28:29.697

您可以缓冲输入和输出，以便将一大块字符（甚至整个文件，如果它不是太大）读入数组，然后处理数组，然后将整个数组写入输出文件。

在大多数情况下，磁盘 IO 是瓶颈，如果可以少做大读取而不是大量小读取，速度会更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T15:47:58.097

我是这样做的，确保文件 I/O 在处理之前一次性完成。该代码可以用于更新 unicode，但它可以处理令人讨厌的文本字符，例如 null，并为您提供 TStrings 功能。布里

```
procedure TextStringToStringsAA( AStrings : TStrings; const AStr: Ansistring);
// A better routine than the stream 'SetTextStr'.
// Nulls (#0) which might be in the file e.g. from corruption in log files
// do not terminate the reading process.
var
  P, Start, VeryEnd: PansiChar;
  S: ansistring;
begin
  AStrings.BeginUpdate;
  try
    AStrings.Clear;

    P := Pansichar( AStr );
    VeryEnd := P + Length( AStr );

    if P <> nil then
      while P < VeryEnd do
      begin
        Start := P;
        while (P < VeryEnd) and not CharInSet(P^, [#10, #13]) do
         Inc(P);
        SetString(S, Start, P - Start);
        AStrings.Add(string(S));
        if P^ = #13 then Inc(P);
        if P^ = #10 then Inc(P);
      end;
  finally
    AStrings.EndUpdate;
  end;
end;

procedure TextStreamToStrings( AStream : TStream; AStrings : TStrings );
// An alternative to AStream.LoadFromStream
// Nulls (#0) which might be in the file e.g. from corruption in log files
// do not terminate the reading process.
var
  Size : Integer;
  S    : Ansistring;
begin
  AStrings.BeginUpdate;
  try
    // Make a big string with all of the text
    Size := AStream.Size - AStream.Position;
    SetString( S, nil, Size );
    AStream.Read(Pointer(S)^, Size);

    // Parse it
    TextStringToStringsAA( AStrings, S );
  finally
    AStrings.EndUpdate;
  end;
end;

procedure LoadStringsFromFile( AStrings : TStrings; const AFileName : string );
// Loads this strings from a text file
// Nulls (#0) which might be in the file e.g. from corruption in log files
// do not terminate the reading process.
var
  ST : TFileStream;
begin
  ST := TFileStream.Create( AFileName, fmOpenRead + fmShareDenyNone);
  // No attempt is made to prevent other applications from reading from or writing to the file.
  try
    ST.Position := 0;
    AStrings.BeginUpdate;
    try
      TextStreamToStrings( ST, AStrings );
    finally
      AStrings.EndUpdate;
    end;

  finally
    ST.Free;
  end;
end; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T16:00:59.583

不要在不知道在哪里的情况下尝试优化。

您应该使用 Sampling Profiler (delphitools.info) 来了解瓶颈在哪里。它很容易使用。

在循环之前预先计算 vgood chr 转换。

此外，您不需要一些转换：Ord() 和 Chr()。始终使用“Ch”变量。

```
if not (ch in [#10, #13, #32..#127]) then 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-10T19:02:53.297

可能最简单的方法是：

1.  制作另一个文件（临时）
2.  将基本文件的所有内容复制到临时文件中。文件（一行一行）
3.  检测它何时读取要替换的字符或单词并停止复制
4.  输入您的编辑（到临时文件）
5.  继续并完成将基本复制到临时文件
6.  重写（删除）基本文件的内容
7.  将行从临时文件复制到基本文件
8.  完毕！

如果对这篇文章有帮助，请投票+1

# c# - C# Powershell。每次脚本执行后是否有必要拆除管道。

> ID：921467
> 
> 赞同：0
> 
> 时间：2009-05-28T15:25:30.590
> 
> 标签：c#, powershell, automation

我看到[CodeProject.com 上的 Jean-Paul Mikkers 异步 poweshell 示例](http://www.codeproject.com/KB/threads/AsyncPowerShell.aspx?display=Mobile&fid=407636&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=3533784&fr=1)正在拆除管道并在每次脚本执行后重新创建它。有谁知道这样做是否有特定原因，或者每次都需要重新创建管道。

我已经用我自己的例子多次尝试执行它，但可能会产生连锁效应，而我只执行几次 100-1000 次就看不到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T13:24:55.360

我有（单元测试）代码，它创建一个运行空间来创建多个管道，没有一个被处理，依次为^(1 。)

这一切运行没有问题。

当然，如果管道改变了运行空间的状态（例如，添加变量、更改目录、加载管理单元……），那么这可能会影响管道的结果。

摘要：“有必要吗？”：没有。但您可能会发现它提供了更好/更差的性能（这个问题的答案会因 PSH 版本而异）。除非您发现创建管道会影响性能，否则请遵循为您的应用程序提供最简单设计的方法。

* * *

¹一个待办事项清单 :-)

# sql - SQL Server 2005 代理不工作

> ID：921469
> 
> 赞同：1
> 
> 时间：2009-05-28T15:26:00.030
> 
> 标签：sql, sql-server-2005, sql-server-agent

Sql server 2005 服务包 2 版本：9.00.3042.00

所有维护计划都因相同的错误而失败。

错误的详细信息是：-

* * *

执行维护计划

*   执行维护计划。test7（错误）消息执行失败。有关详细信息，请参阅维护计划和 SQL Server 代理作业历史记录。

高级信息部分显示以下内容；

## 作业“test7.Subplan_1”失败。(SqlManagerUI)

程序位置：在 Microsoft.SqlServer.Management.SqlManagerUI.MaintenancePlanMenu_Run.PerformActions()

此时 Windows 事件日志中出现以下内容：事件类型：错误事件源：SQLISPackage 事件类别：无事件 ID：12291 日期：28/05/2009 时间：16:09:08 用户：'DOMAINNAME\username' 计算机：SQLSERVER4 描述：包“test7”失败。

# 还有这个：

事件类型：警告事件源：SQLSERVERAGENT 事件类别：作业引擎事件 ID：208 日期：28/05/2009 时间：16:09:10 用户：N/A 计算机：SQLSERVER4 描述：

## SQL Server 计划作业“test7.Subplan_1”（0x96AE7493BFF39F4FBBAE034AB6DA1C1F）-状态：失败-调用时间：2009-05-28 16:09:02-消息：作业失败。作业由用户 'DOMAINNAME\username' 调用。最后运行的步骤是步骤 1 (Subplan_1)。

SQl 代理日志中根本没有任何条目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T16:41:16.880

这可能没有任何意义，但您可能会在 ServerFault.com 上获得更多帮助，因为它们是开放的。

# java - 为什么 Java 人经常默默消费异常？

> ID：921471
> 
> 赞同：82
> 
> 时间：2009-05-28T15:26:26.657
> 
> 标签：java, exception, exception-handling

我以前从未做过任何认真的 Java 编码，但我根据我现有的技能（Delphi 和 C#）学习了语法、库和概念。我几乎不明白的一件事是，我见过这么多代码在`printStackTrace`这样之后默默地消耗异常：

```
 public void process() {
        try {
            System.out.println("test");
        } catch(Exception e) {
            e.printStackTrace();
        }
    } 
```

在我遇到的几乎所有 Java 文章和项目中都有类似的代码。根据我的知识，这是非常糟糕的。异常几乎总是应该像这样转发到外部上下文：

```
 public void process() {
        try {
            System.out.println("test");
        } catch(Exception e) {
            e.printStackTrace();
            throw new AssertionError(e);
        }
    } 
```

大多数情况下，异常最终应该在属于底层框架（例如 Java Swing）的最外层循环中处理。为什么在 Java 世界中这样的编码看起来像是常态？我很困惑。

根据我的背景，我更愿意*完全*删除 printStackTrace 。我会简单地重新抛出一个未处理的 aka `RuntimeException`（或者，甚至更好，`AssertionError`），然后在最合适的位置捕获并记录它：框架最外层循环。

```
 public void process() {
        try {
            System.out.println("test");
        } catch(Exception e) {
            throw new AssertionError(e);
        }
    } 
```

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2009-05-28T15:44:45.390

我一直认为，这类似于以下场景：

> *“一个人被枪杀了。*
> 
> *他屏住呼吸，有足够的力气坐公交车。*
> 
> *10 英里后，这名男子下了公共汽车，走了几个街区就死了。”*

当警察找到尸体时，他们对刚刚发生的事情一无所知。他们最终可能有，但要困难得多。

更好的是：

> *“一个人被枪杀了，他立刻死了，尸体就在刚刚发生谋杀的地方。”*

当警察到达时，所有证据都已准备就绪。

如果一个系统要失败，最好是[快速失败](http://en.wikipedia.org/wiki/Fail-fast)

解决问题：

1.  无知。

2.  懒惰

**编辑：**

当然，catch 部分很有用。

如果可以在例外情况下完成某些事情，那就应该这样做。

对于给定的代码，这可能不是一个例外，可能是预期的（在我的类比中，它就像一件防弹夹克，而那个人首先在等待射击）。

是的，catch 可以用来[抛出适合抽象的异常](http://www.google.com/search?q=Effective+Java+Throw+exceptions+appropriate+to+the+abstraction)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-05-28T15:30:04.840

这通常是由于 IDE 提供了一个有用的“快速修复”，它将有问题的代码包装在带有异常处理的 try-catch 块中。这个想法是你实际上做某事，但懒惰的开发人员没有。

这是不好的形式，毫无疑问。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-28T15:56:04.400

这是一个典型的[稻草人论点](http://en.wikipedia.org/wiki/Straw_man)。 `printStackTrace()`是调试辅助工具。如果您在博客或杂志上看到它，那是因为作者对说明异常处理以外*的一点更感兴趣。*如果您在生产代码中看到它，那么该代码的开发人员是无知或懒惰的，仅此而已。它不应该被视为“java 世界”中常见做法的一个例子。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-05-28T15:28:57.497

1.  Java 强制您显式处理所有异常。如果您的代码调用的方法被声明为抛出 FooException 和 BarException，您的代码**必须**处理（或抛出）这些异常。唯一的例外是*RuntimeException*，它像忍者一样沉默。
2.  许多程序员都很懒惰（包括我自己），打印堆栈跟踪非常容易。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-05-28T15:28:17.137

因为**Checked Exceptions**是一个失败的实验

（也许 printStackTrace() 是**真正的问题**？:)

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-05-28T15:31:56.397

我发现这样做通常有两个原因

1.  程序员很懒
2.  程序员想要保护组件的入口点（正确或错误）

我不认为这是仅限于 Java 的现象。我也经常在 C# 和 VB.Net 中看到这样的编码。

从表面上看，它非常令人震惊，看起来很糟糕。但实际上这并不是什么新鲜事。它一直发生在使用错误代码返回值与异常的 C++ 应用程序中。但不同之处在于，忽略可能致命的返回值与调用返回 void 的函数看起来并没有什么不同。

```
Foo* pFoo = ...;
pFoo->SomeMethod(); // Void or swallowing errors, who knows? 
```

这段代码看起来更好，但如果 SomeMethod() 说返回一个 HResult，它在语义上与吞下一个异常没有什么不同。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-28T23:59:16.373

我不得不说，我对暗示这种松懈的错误处理行为是 Java 程序员的基本内容的语气有点反感。当然，Java 程序员可能很懒惰，就像其他程序员一样，而且 Java 是一种流行的语言，所以你可能会看到很多代码吞入异常。

此外，正如在其他地方所指出的，Java 强制声明检查异常存在可以理解的挫败感，尽管我个人对此没有意见。

我想我的问题是，您正在浏览网络上的一堆文章和代码片段，而没有考虑上下文。事实是，当你写一篇技术文章试图解释某些特定 API 是如何工作的，或者如何开始使用某些东西时，你很可能会跳过代码的某些方面——不直接的错误处理与您所展示的内容相关的可能是处置的候选者，尤其是在示例场景中不太可能发生异常的情况下。

写这种性质的文章的人必须保持合理的信噪比，而且我认为相当公平，这意味着他们必须假设你对你正在开发的语言有一些基础知识；如何正确处理错误以及许多其他事情。如果您看到一篇文章并注意到缺少适当的错误检查，那很好；只需确保当您将这些想法（当然，绝不是确切的代码本身，对吗？）合并到您的生产代码中时，您将处理作者明智地遗漏的所有这些点点滴滴，以最重要的方式适合您正在开发的内容。

我确实对非常高级的介绍性文章有疑问，这些文章轻而易举地解决了这些问题而从未返回过它们，但请注意，Java 程序员在错误处理方面并没有某种特定的“思维方式”。我知道很多你心爱的 C# 程序员也懒得处理所有的问题。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-05-28T16:00:58.023

System.out print 或 e.printStackTrace() - 这意味着使用 System.out 通常是一个危险信号，意味着有人没有费心去做勤奋的工作。除了桌面 Java 应用程序之外，大多数 Java 应用程序最好使用日志记录。

如果方法的失败模式是无操作，则吃异常是完全可以的，无论您是否记录原因（和存在）。然而，更典型的是，catch 子句应该采取某种异常行动。

重新抛出异常最好是在您使用 catch 清理在必要信息仍然可用的级别上的部分工作时，或者当您需要将异常转换为更适合调用者的异常类型时。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-28T15:30:10.940

只有当 catch 块真的为空时，它才会被静默消耗。

就文章而言，除了如何处理异常之外，它们可能更有趣地证明了其他一点。他们只想直截了当并拥有尽可能短的代码。

显然你是对的，如果异常要被“忽略”，至少应该记录它们。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-28T22:04:18.070

正如其他人指出的那样，您看到这种情况的原因是以下三个原因之一：

1.  IDE 生成了 try-catch 块
    *   代码已复制并粘贴
    *   开发人员将堆栈跟踪放入调试，但从未回来正确处理异常

最后一点是最不可能发生的。我这样说是因为我认为没有人真正以这种方式进行调试。使用调试器单步调试代码是一种更简单的调试方法。

[在Joshua Bloch 撰写的](http://my.safaribooksonline.com/9780137150021)[*Effective Java*](http://my.safaribooksonline.com/9780137150021)的第 9 章中可以找到关于在 catch 块中*应*该做什么的最佳描述。[](http://my.safaribooksonline.com/9780137150021)

 ** * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-29T06:53:39.253

恐怕大多数 java 程序员不知道如何处理异常，并且总是认为它是一种烦恼，会减慢他们对“名义”情况的编码速度。当然，他们完全错了，但很难让他们相信正确处理异常很重要。每次遇到这样的程序员（经常发生），我都会给他两个阅读条目：

*   著名的 Java 思维
*   Barry Ruzek 的一篇简短而有趣的文章可在此处获得：www.oracle.com/technology/pub/articles/dev2arch/2006/11/effective-exceptions.html

顺便说一句，我强烈同意捕获一个类型化的异常以重新抛出它嵌入到 RuntimeException 中是愚蠢的：

*   如果你抓住它，处理它。
*   否则，请更改您的方法签名以添加您将/无法处理的可能异常，以便您的调用者有机会自己完成。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-05-28T15:39:21.220

如果程序员做对了他的工作，你应该经常看到这一点。忽略异常是一种不好的做法！但是有些人可能会这样做以及更合适的解决方案有一些原因：

*   “这不会发生！” 当然，有时你“知道”这个异常不会发生，但它仍然更适合重新抛出运行时异常，并将发生的异常作为“原因”，而不是仅仅忽略它。我敢打赌它会在未来的某个时候发生。;-)

*   原型代码 如果您只是输入您的内容以查看它是否有效，您可能希望忽略所有可能发生的异常。这是我做一些懒惰捕获（Throwable）的唯一情况。但是如果代码变成有用的东西，我会包括适当的异常处理。

*   “我不知道该怎么办！” 我看到了很多代码，尤其是库代码，它们吞下了发生的异常，因为在应用程序的这一层无法进行适当的处​​理。不要这样做！只需重新抛出异常（通过在方法签名中添加 throws 子句或将异常包装到特定于库的异常中）。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-05-29T11:47:26.600

检查异常和接口的组合导致代码必须处理永远不会被抛出的执行。（这同样适用于普通继承，但它更常见，更容易用接口解释）

原因：接口的实现可能不会抛出（检查）接口规范中定义的异常以外的异常。出于这个原因，接口的创建者不知道实现接口的类的哪些方法实际上可能需要抛出异常，他们可能会指定所有方法都可能抛出至少一种类型的异常。示例：JDBC，其中所有内容及其祖母都被声明为抛出 SQLException。

但实际上，实际实现的许多方法根本不会失败，因此在任何情况下，它们都不会抛出异常。调用此方法的代码仍必须以某种方式“处理”异常，最简单的方法是吞下异常。没有人愿意用永远不会执行的看似无用的错误处理来弄乱他的代码。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-05-28T15:44:09.460

您应该始终转发它或在现实世界中适当地处理它。许多文章和教程将简化他们的代码以了解更重要的点，最容易简化的事情之一是错误处理（除非你正在写一篇关于错误处理的文章 :)）。由于 java 代码将检查异常处理，因此放置一个简单的静默（或日志记录语句）catch 块是提供工作示例的最简单方法。

如果您在除示例代码之外的任何内容中发现此内容，请随时将代码转发到 TDWTF，尽管他们现在可能有太多示例：)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-05-28T15:32:05.040

在 C# 中，所有异常都是运行时异常，但在 Java 中，您有运行时异常和检查异常，您必须在方法中捕获或声明它们。如果您调用任何最后具有“抛出”的方法，您必须捕获那里提到的异常，或者您的方法也必须声明这些异常。

Java 文章通常只打印堆栈跟踪或有注释，因为异常处理与文章的主题无关。但是，在项目中，应该根据异常的类型对其进行处理。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-01-31T20:12:11.383

因为他们还没有学会这个技巧：

```
class ExceptionUtils {
    public static RuntimeException cloak(Throwable t) {
        return ExceptionUtils.<RuntimeException>castAndRethrow(t);
    }

    @SuppressWarnings("unchecked")
    private static <X extends Throwable> X castAndRethrow(Throwable t) throws X {
        throw (X) t;
    }
}

class Main {
    public static void main(String[] args) { // Note no "throws" declaration
        try {
            // Do stuff that can throw IOException
        } catch (IOException ex) {
            // Pretend to throw RuntimeException, but really rethrowing the IOException
            throw ExceptionUtils.cloak(ex);
        }
    }
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-05-28T22:26:51.303

异常的真正意义在于简化错误处理并将其与错误检测分开。这与用错误代码表示错误相反，错误处理代码分散在各处，每个可能失败的调用都应检查返回代码。

如果异常代表错误（大多数情况下），通常最合理的处理方法是退出并将处理留给上层。如果添加了一些有意义的语义，则应考虑重新抛出不同的异常，即，此错误是不寻常的系统故障/临时（网络）问题/这是客户端或服务器端错误等。

在所有错误处理策略中，最无知的是隐藏或简单地打印错误消息并继续前进，因为什么都没发生。

* * *

Sun 的人希望代码更明确，并迫使程序员编写哪些异常可以由哪种方法抛出。这似乎是正确的举动——任何人都会知道给定原型的任何方法调用会得到什么回报（它可能返回这种类型的值或抛出指定类（或其子类）之一的实例）。

但事实证明，许多无知的 Java 程序员现在将异常处理视为一种语言错误/“功能”，需要一种解决方法，并以最糟糕或几乎最糟糕的方式编写代码：

*   在不适合决定如何处理它的上下文中立即处理该错误。
*   它会默默地显示或忽略，即使进一步的代码没有机会正常运行，计算也会继续。
*   方法的调用者无法区分它是否成功完成。

* * *

如何写出“正道”比？

*   指示可以在方法头中抛出的每个异常基类。AFAICR Eclipse 可以自动完成。
*   使方法原型中的抛出列表有意义。长列表毫无意义，“抛出异常”是懒惰的（但在您不太关心异常时很有用）。
*   当编写“错误的方式”时，简单的“抛出异常”比“try{ ... } catch(Exception e) { e.printStackTrace(); }”要好得多，占用的字节更少。
*   如果需要，重新抛出链式异常。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-06-09T12:15:44.950

请永远不要将已检查的异常包装在未检查的异常中。

如果您发现自己处理了您认为不应该处理的异常，那么我的建议是您可能在错误的抽象级别上工作。

我将详细说明：已检查和未检查的异常是两种截然不同的野兽。检查的异常类似于返回错误代码的旧方法......是的，它们比错误代码更难处理，但它们也有优势。未经检查的异常是编程错误和严重的系统故障……换句话说就是异常异常。当试图解释什么是异常时，很多人陷入了彻底的混乱，因为他们不承认这两个非常不同的案例的区别。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-05-28T15:33:40.777

正如所指出的，调用 printStackTrace() 并不是真正的静默处理。

这种异常“吞下”的原因是，如果你不断地将异常向上传递，你仍然必须在**某个地方**处理异常或让应用程序崩溃。因此，在信息转储发生的级别处理它并不比在信息转储的顶层处理它差。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-05-28T16:17:51.033

它的懒惰实践 - 真的没什么。

它通常在您真的不关心异常时完成 - 而不是增加您的手指工作。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-05-28T16:19:06.613

当您无法从异常中恢复但并不严重时，您通常会吞下异常。一个很好的例子是关闭数据库连接时可以抛出的 IOExcetion。如果发生这种情况，你真的想崩溃吗？这就是 Jakarta 的 DBUtils 有 closeSilently 方法的原因。

现在对于您无法恢复但很关键的检查异常（通常是由于编程错误），不要吞下它们。我认为应该在最接近问题根源的地方记录异常，因此我不建议删除 printStackTrace() 调用。您将希望将它们转换为 RuntimeException 的唯一目的是不必在您的业务方法中声明这些异常。确实，使用高级业务方法（例如 createClientAccount() 抛出 ProgrammingErrorException（读取 SQLException））是没有意义的，如果您的 sql 中有拼写错误或访问错误的索引，您将无能为力。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-05-28T21:51:24.493

我不同意重新抛出检查异常是一个更好的主意。捕捉意味着处理；如果你必须重新抛出，你不应该抓住。在这种情况下，我会将 throws 子句添加到方法签名中。

我会说将已检查的异常包装在未检查的异常中（例如，Spring 将已检查的 SQLException 包装到其未检查层次结构的实例中的方式）是可以接受的。

日志记录可以被认为是处理。如果将示例更改为使用 log4j 记录堆栈跟踪而不是写入控制台，这是否可以接受？变化不大，IMO。

真正的问题是什么被认为是异常的和可接受的恢复程序。如果您无法从异常中恢复，您能做的最好的事情就是报告失败。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-05-28T15:35:00.727

我认为开发人员还尝试考虑在特定上下文中“做正确的事”的重要性。很多时候扔掉代码或者向上传播异常不会买任何东西，因为异常是致命的，你还不如通过“做错事”来节省时间和精力。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-05-28T15:34:39.043

如果您希望在当前方法的范围之外处理您的异常，您实际上不需要捕获它，而是将“抛出”语句添加到方法签名中。

您看到的 try/catch 语句仅出现在程序员明确决定就地处理异常并因此不再进一步抛出异常的代码中。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-05-29T00:11:46.347

根据经验，吞下异常在未打印时主要是有害的。如果您崩溃，它有助于引起注意，有时我会故意这样做，但只需打印异常并继续可以让您找到问题并修复它，但通常不会对使用相同代码库的其他人产生负面影响.

我实际上很喜欢Fail-Fast/Fail-HARD，但至少打印出来。如果你真的“吃”了一个例外（这是真正什么都不做：{}）它会花费某人 DAYS 才能找到它。

问题是Java 迫使您捕获许多开发人员知道不会被抛出的东西，或者不关心它们是否被抛出。最常见的是 Thread.sleep()。我意识到这里有可能导致线程问题的漏洞，但通常你知道你并没有打断它。时期。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-05-29T11:32:54.993

使用 catch Exception 的原因可能有很多。在许多情况下，这是一个坏主意，因为您还捕获了 RuntimeExceptions - 而且您不知道发生这种情况后底层对象将处于什么状态？遇到意外情况，这总是很困难的事情：你能相信其余的代码在之后不会失败。

您的示例打印了堆栈跟踪，因此至少您将知道根本原因可能是什么。在更大的软件项目中，记录这些内容是一个更好的主意。并希望日志组件不会抛出异常，否则您可能会陷入无限循环（这可能会杀死您的 JVM）。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-07-11T14:59:07.943

如果您有一个已检查的异常并且您不想在方法中处理它，您应该让该方法抛出异常。只有在你打算用它做一些有用的事情时才捕获并处理异常。仅仅记录它在我的书中并不是很有用，因为用户很少有时间阅读日志以查找异常或知道如果抛出异常该怎么办。

虽然包装异常是一种选择，但我不建议您这样做，除非；您正在抛出一个不同的异常来匹配现有的接口，或者真的没有办法抛出这样的异常。

顺便说一句：如果你想重新抛出一个检查异常，你可以这样做

```
try {
   // do something
} catch (Throwable e) {
   // do something with the exception
   Thread.currentThread().stop(e); // doesn't actually stop the current thread, but throws the exception/error/throwable
} 
```

注意：如果您这样做，您应该确保该方法的 throws 声明是正确的，因为在这种情况下编译器无法为您执行此操作。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-02-10T10:13:43.680

想象一下，您有 200 万行要处理。每行有 10 列。您知道只有 10 行在某些列中有一个字符，该字符不正确且不重要，并且适用于后续步骤的非处理项目。您是否检查每列的所有行以搜索此字符？包裹静默方法成本较低。当然，您有不同的方法来处理这种情况。但其中之一是一种无声的方法。

* * *

## 回答 #29

> 赞同：-2
> 
> 时间：2009-05-28T15:58:23.880

因为这是最佳实践。我以为每个人都知道。
但冷酷的事实是，没有人真正了解如何处理异常。C 错误处理风格更有意义。

# php - 包含文件的全部内容并回显它

> ID：921479
> 
> 赞同：16
> 
> 时间：2009-05-28T15:27:05.847
> 
> 标签：php, echo

我需要回显包含文件的全部内容。我尝试了以下方法：

```
echo "<?php include ('http://www.example.com/script.php'); ?>";

echo "include (\"http://www.example.com/script.php\");"; 
```

但两者都不起作用？PHP 支持这个吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-28T15:29:46.543

做就是了：

```
include("http://www.mysite.com/script.php"); 
```

或者：

```
echo file_get_contents("http://www.mysite.com/script.php"); 
```

笔记：

*   由于网络延迟或其他服务器速度较慢，这可能会降低您的页面速度。
*   这需要`allow_url_fopen`为您的 PHP 安装打开。一些主机将其关闭。
*   这不会给你 PHP 代码，它会给你 HTML/文本输出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T16:13:33.660

最短的方法是：

```
readfile('http://www.mysite.com/script.php'); 
```

这将直接输出文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T15:29:17.637

Echo 将某些内容打印到输出缓冲区 - PHP 不会对其进行解析。如果您想包含某些内容，请执行此操作

```
include ('http://www.mysite.com/script.php'); 
```

当您编写 PHP 源代码时，您不需要打印出 PHP 源代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-09T17:38:30.530

这可能不是您问题的确切答案，但是您为什么不关闭 echo 语句，插入您的 include 语句，然后添加一个新的 echo 语句呢？

```
<?php
  echo 'The brown cow';
  include './script.php';
  echo 'jumped over the fence.';
?> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T15:30:45.760

不太确定你在问什么，但你不能真正通过 http 包含一些东西并期望看到代码，因为服务器会解析文件。

如果“script.php”是一个本地文件，你可以尝试类似：

```
$file = file_get_contents('script.php');
echo $file; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-22T14:30:01.710

Matt 是正确的，`readfile()`但它也可能有助于某人查看 [fpassthru 的 PHP 文件处理函数手册条目](http://php.net/manual/en/function.fpassthru.php)

```
<?php

$f = fopen($filepath, 'r');

fpassthru($f);

fclose($f);

?> 
```

# javascript - 在pdf中使用javascript获取用户名

> ID：921486
> 
> 赞同：3
> 
> 时间：2009-05-28T15:28:15.203
> 
> 标签：javascript, pdf

我想知道是否可以获取登录到计算机的帐户的用户名。我想打印打印出 pdf 文件的人的用户名。

我正在考虑尝试获取 %username% 环境变量。似乎不可能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-29T06:29:30.797

在 Acrobat JavaScript 中，许多本地系统参数被视为特权。用户的登录名就是其中之一。为了访问“身份”对象，必须从受信任的上下文中执行 JavaScript 代码。PDF 中的代码不符合条件。或者至少它通常不会。如果本地系统用户已明确授予 PDF 权限，则它可以访问特权数据。但显然这不是一个通用的解决方案。通常，“身份”对象只能由文件夹级自动化脚本访问。

汤姆·帕克 www.pdfscripting.com

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T18:09:01.837

看看身份对象。

```
 name = identity.name; //gives you the user name that the user entered in the Identity preferences panel
   userName = identity.loginName; //login name as registered by the operating system 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:57:19.577

这在某种程度上可能是服务器端的。这是[Apache/Unix 的 NTLM 身份验证模块](http://modntlm.sourceforge.net/)，[这是 Apache/Windows 的一个](http://mod-auth-sspi.sourceforge.net/)。

# c# - 如何为 SharePoint 网站中的任何更改创建每日摘要警报

> ID：921509
> 
> 赞同：5
> 
> 时间：2009-05-28T15:31:40.547
> 
> 标签：c#, sharepoint, sharepoint-2007, alert, alerts

我最近收到要求某人接收关于 SharePoint 网站内任何更改的每日摘要警报；每个站点都有一个负责其站点内容的所有者。

我们目前的工作方式是为站点内的每个列表/库自动设置警报。

```
// Get the Lists on this Site
SPListCollection siteLists = currentSite.Lists;
foreach (SPList list in siteLists)
{
    if (!list.ToString().Equals("Master Page Gallery"))
    {
        if (list.ReadSecurity == 1) // user has read access to all items
        {
            // Create an Alert for this List
            Guid alertID = currentUser.Alerts.Add(list, SPEventType.All, SPAlertFrequency.Daily);

            // Set any additional properties
            SPAlert newAlert = currentUser.Alerts[alertID];
        }
    }
} 
```

这会产生两个问题：

1.  用户创建了许多不同的警报。理想：只有一封包含每日摘要的电子邮件。
2.  必须设置某种监视器来检查站点中的新列表或库，并自动为用户设置警报。

**问：如何为站点中的所有更改创建每日摘要警报？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-11T14:31:02.630

我相信您正在寻找的解决方案可以通过审计框架获得。审计在 SP 中非常强大，不幸的是很容易被输出淹没。

Audit 是 SPSite、SPWeb、SPList 和 SPItem 属性上可用的属性。

使用此属性调整特定的审计标志（使用 .Audit.AuditFlags 属性）以满足您的需求（具体情况取决于您如何定义“更改”，但几乎任何您能想到的东西都可用）。

[MSDN 上提供了有关SPAudi 对象](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spaudit.aspx)的详细信息。

一旦您定义了要审核的内容/位置，您就必须将该信息返回给您的用户。

默认情况下，SP 会设置一些在网站集级别可用的漂亮报告（[网站集的 URL]/_layouts/Reporting.aspx?Category=Auditing）。这些可能会满足您的需求。

您最初的解决方案提到了通过电子邮件向用户发送警报。鉴于大多数用户希望将他们的信息集中在电子邮件中（尽管他们的 MySite 是放置报告链接的好地方！），您将需要做更多的工作。

您可以使用SPAuditQuery 和SPAuditEntryCollection 对象通过对象模型提取所需的审计信息。同样，[MSDN 提供了一些](http://msdn.microsoft.com/en-us/library/bb466223.aspx)关于如何使用这些对象的信息。

我建议设置一个在一天结束时运行的自定义 SPJobDefinition，以通过电子邮件向用户发送其站点的审核报告。Andrew Connell在他的博客上对[如何设置自定义作业进行了很好的解释。](http://www.andrewconnell.com/blog/articles/CreatingCustomSharePointTimerJobs.aspx)

**总结一下：**

*   为有问题的 SPWeb 启用审核
*   使用SPAuditQuery 和SPAuditEntryCollection 为每个SPWeb 创建报告
*   创建一个每晚运行的 SPJobDefinition 以通过电子邮件将报告发送给每个 SPWeb 所有者

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-12T09:55:43.247

在站点上启用审核策略之前要考虑的一件事是您添加的性能开销。

我建议在这里尽可能少地保留足迹！

我的意思是，如果您只希望从某个内容类型或某个列表中获取此信息，请确保仅在这些 CT 或列表上启用信息策略！

还将日志记录保持在最低限度。例如，如果您只对视图感兴趣，而不是删除或恢复，则只记录这些事件！

在大型网站上，我已经看到审核非常垃圾的性能！

还要注意这里的一些注意事项：即使您可以对列表启用审核（如在非文档库中），许多事件（例如查看事件）并未专门针对列表项记录！这在任何地方都没有描述（事实上，我什至在 MSDN 文章中看到 Ted Pattison 提到项目级别审计），但我直接从 CSS 和产品团队那里得知，由于性能问题，项目级别审计在 SP2007 中没有实现。相反，您只需在日志中获得一个列表事件，指定该列表已被触及。

文档被跟踪得相当好，但是我发现在发布页面上审核视图事件（在 API 中被视为文档而不是列表项）存在问题，具体取决于审核的设置方式和位置（例如，如果审核策略是使用继承的CT 的）所以这是需要注意的。

[编辑：昨天围绕这个做了一些测试，更糟糕的是：事实上，只有在你设置了站点级别的审计策略时，**才会跟踪****发布页面！**如果您对列表或内容类型（甚至是从具有策略的内容类型继承的内容类型）设置策略，则根本不会收到**任何**SPAudiItemType.Document 级别的事件。将其设置在站点上，您将获得太多审核！例如。视图将触发 x2 视图事件，更新也是如此，因此您最终会记录太多。它绝对看起来像一个错误，当策略被放在列表和 CT 上时，没有任何审计......]

 ****这里的主要信息是：小心你记录的内容，因为它会影响你的网站性能测试你期望记录的内容是否真的被记录了！

安德斯拉斯克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-13T09:47:22.743

Well, it is not a case that there is no item level auditing. The item level auditing is implemented but you have to turn it ON for specific item. If list item exists you can get its instance and turn ON auditing the same as you do this to lists. The problem is that how to turn it ON when the ListItem is created. Maybe workflow could help?

# c# - 为什么 ReadOnlyCollection<> 不包含 FindAll()、FindFirst()、

> ID：921511
> 
> 赞同：7
> 
> 时间：2009-05-28T15:31:46.773
> 
> 标签：c#, collections, readonly-collection

根据 FxCop 的建议和我的个人倾向，我一直在鼓励我正在执教的团队尽可能地使用 ReadOnlyCollections。如果只是这样列表的收件人不能修改他们的内容。在他们的理论中，这是面包和黄油。问题是 List<> 接口更丰富地公开了各种有用的方法。他们为什么做出这样的选择？

您是否只是放弃并返回可写集合？您是否返回只读集合，然后将它们包装在可写品种中？啊啊啊。

* * *

更新：谢谢我熟悉框架设计指南，这就是团队使用 FxCop 来执行它的原因。然而，这个团队正在使用 VS 2005（我知道，我知道），所以告诉他们 LINQ/Extension 方法可以解决他们的问题，这让他们很难过。

他们了解到 List.FindAll() 和 .FindFirst() 比编写 foreach 循环更清晰。现在我正在推动他们使用 ReadOnlyCollections 他们失去了这种清晰度。

也许有一个我没有发现的更深层次的设计问题。

-- 对不起，原帖应该提到了 VS2005 的限制。我住了这么久，我只是没有注意到。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T15:35:17.060

[.NET Framework 设计指南第二版](http://www.moserware.com/2008/12/private-life-of-public-api.html)的第 8.3.2 节：

> **务必**使用`ReadOnlyCollection<T>`、 的子类`ReadOnlyCollection<T>`，或者在极少数情况下`IEnumerable<T>`用于表示只读集合的​​属性或返回值。

我们使用 ReadOnlyCollections 来表达我们返回集合的意图。

`List<T>`为方便起见，您所说的方法已添加到 .NET 2.0 中。在 C# 3.0 / .NET 3.5 中，您可以使用扩展方法（也可以使用 LINQ 运算符）重新启用所有这些方法`ReadOnlyCollection<T>`（或任何`IEnumerable<T>`方法），因此我认为没有任何动机将它们本地添加到其他类型。由于扩展方法的存在现在可用但不在 2.0 中，因此它们完全存在于 List 上的事实只是一个历史记录。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-28T15:45:03.360

首先，`ReadOnlyCollection<T>`确实实现了`IEnumerable<T>`and `IList<T>`。使用 .NET 3.5 和 LINQ 中的所有扩展方法，您可以访问原始`List<T>`类中几乎所有的查询功能，这是您无论如何都应该使用的`ReadOnlyCollection<T>`。

话虽如此，您最初的问题使我提出了一些建议...

退货`List<T>`是糟糕的设计，所以它不应该是一个比较点。 `List<T>`应该用于实现，但对于接口，`IList<T>`应该返回。[框架设计指南](https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/)特别指出：

“**不要**在公共 API 中使用`ArrayList`或使用。” `List<T>`（第 251 页）

如果考虑到这一点，`ReadOnlyCollection<T>`与 相比绝对没有劣势`List<T>`。这两个类都实现`IEnumerable<T>`和`IList<T>`，它们是无论如何都应该返回的接口。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T15:36:46.840

我不知道为什么最初没有添加它们。但是现在我们有了 LINQ，我当然认为没有理由在未来的语言版本中添加它们。您提到的方法现在可以很容易地写在 LINQ 查询中。这些天来，我几乎对所有事情都使用 LINQ 查询。实际上，我更经常对拥有这些方法感到恼火，`List<T>`因为它与我编写的扩展方法冲突`IEnumerable<T>`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T02:29:49.690

我认为杰夫的答案有点包含您需要的答案；而不是`ReadOnlyCollection<T>`，返回它的子类...您自己实现的一个子类，以包含您想要使用的方法，而无需升级到 VS2008/LINQ。

# java - 如何使用 JPA 注释映射一组字符串对象？

> ID：921517
> 
> 赞同：6
> 
> 时间：2009-05-28T15:32:17.020
> 
> 标签：java, hibernate, jpa

```
@Entity
public class TestClass implements Serializable{
    private Integer id;
    private Set<String> mySet;

    @Id
    @GeneratedValue
    public Integer getId() {
        return id;
    }
    @OneToMany(cascade={CascadeType.ALL})
    public Set<String> getMySet() {
        return mySet;
    }
} 
```

我收到以下错误。

```
Caused by: org.hibernate.AnnotationException: Use of @OneToMany or @ManyToMany targeting an unmapped class: TestClass.mySet[java.lang.String] 
```

或者如果我离开 @OneToMany

`org.hibernate.MappingException: Could not determine type for: java.util.Set, at table: test_class, for columns: [org.hibernate.mapping.Column(my_sets)`]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T15:43:29.680

你会在[这里](https://stackoverflow.com/questions/287201/how-to-persist-a-property-of-type-liststringin-jpa)找到一个相当不错的答案。列表的规则也适用于集合。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-30T00:01:08.677

哦哦，我不得不做这个。

```
@CollectionOfElements(targetElement = String.class) 
```

# php - 如何修复“没有合适的节点”错误？

> ID：921526
> 
> 赞同：0
> 
> 时间：2009-05-28T15:34:34.910
> 
> 标签：php, mysql, upload, nodes

我有一个带有图片上传器的网站，每当用户尝试上传图片时，他们都会收到以下错误消息：

“没有合适的节点可以满足您的请求。”

我已经联系了托管公司（mosso），他们说这对他们来说没什么。知道是什么导致了这个问题，我能做些什么来解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-26T01:25:00.770

有几个原因可能会导致您收到有关请求的“没有合适的节点”错误。在[http://nosuitablenodes.com](http://nosuitablenodes.com)上对这个问题进行了更全面的讨论。这是一个摘要：

> 首先，这是来自负载平衡器的错误消息，用于将流量引导到您站点的可用后端服务器。这意味着没有可用的后端资源来生成请求的内容。这是一条默认消息，基本上意味着该站点当前不可用。

想想你网站的资源。静态 HTML？动态创建页面内容的脚本语言？DB支持的网站？在每个级别，都有可能导致负载均衡器（产生错误消息）超时并返回此消息的资源。

你能做什么？（真正的问题！）

首先，联系您站点的系统管理员。有权访问负载平衡器的系统管理员将能够查明导致错误情况的服务。

作为网站所有者，您可以自己做一些事情来纠正这种情况。在负载均衡器后面添加更多资源（对于托管站点，这可能超出您的控制范围）如果您无法控制资源（即，您正在使用托管服务提供商）：确定实际原因，然后：

1.  Web Server) 优化配置以支持更多连接
2.  文件系统/服务器）将静态内容移动到 CDN，在脚本引擎中使用字节码缓存来减少磁盘读取
3.  脚本引擎）优化脚本引擎以使用字节码缓存
4.  数据库）优化查询或移动到专用数据库实例
5.  远程资源）尽量减少对远程资源的依赖，或尽可能优化它们

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T15:45:09.380

我很确定这对您的托管公司来说是个问题，因为它与集群服务器有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-06T10:09:09.753

您需要实现某种进度条。他们将空闲超时设置得足够低，以至于上传失败而没有一些持续的反馈。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-19T21:11:40.277

这是一个非常烦人的问题。确保加入其他人并在新的 Rackspace Cloud 问题列表中投票解决问题：http: [//feedback.rackspacecloud.com/forums/71021-product-feedback/suggestions/997177-eliminate-the-dreaded-no-合适的节点错误？参考=标题](http://feedback.rackspacecloud.com/forums/71021-product-feedback/suggestions/997177-eliminate-the-dreaded-no-suitable-nodes-error?ref=title)

# linq-to-sql - 使用 LinqtoSql，它何时/如何将您的对象映射到表？

> ID：921529
> 
> 赞同：0
> 
> 时间：2009-05-28T15:34:56.360
> 
> 标签：linq-to-sql

使用 LINQ To SQL，该过程如何/何时将您的对象/实体映射到您的表？

它是否在后台创建了自己的 ADO.NET 代码？它是强类型的吗？

SQL 参数是否考虑了列大小/类型？（nvarchar 500 等）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T15:47:45.977

创建 DBML 文件时，它会生成标有属性的标准 .NET 类。它是强类型的，并且尊重外键约束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:49:17.657

我无法查看我当前的项目，但您可以创建一个示例 DBML 文件并查看它在后台执行的操作？

# python - 在 Python 中检索所有 Cookie

> ID：921532
> 
> 赞同：20
> 
> 时间：2009-05-28T15:35:09.013
> 
> 标签：python, cookies

如何在不知道它们的名字的情况下用 Python 读回所有的 cookie？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-28T16:11:27.707

不确定这是否是您要查找的内容，但这是一个简单的示例，您将 cookie 放入 cookiejar 并读回：

```
from urllib2 import Request, build_opener, HTTPCookieProcessor, HTTPHandler
import cookielib

#Create a CookieJar object to hold the cookies
cj = cookielib.CookieJar()
#Create an opener to open pages using the http protocol and to process cookies.
opener = build_opener(HTTPCookieProcessor(cj), HTTPHandler())

#create a request object to be used to get the page.
req = Request("http://www.about.com")
f = opener.open(req)

#see the first few lines of the page
html = f.read()
print html[:50]

#Check out the cookies
print "the cookies are: "
for cookie in cj:
    print cookie 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-28T15:55:15.710

放入`os.environ['HTTP_COOKIE']`数组：

```
#!/usr/bin/env python

import os

 if 'HTTP_COOKIE' in os.environ:
  cookies = os.environ['HTTP_COOKIE']
  cookies = cookies.split('; ')
  handler = {}

  for cookie in cookies:
   cookie = cookie.split('=')
   handler[cookie[0]] = cookie[1] 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-05-27T21:10:44.147

这可能正是您正在寻找的。

蟒蛇 3.4

```
import requests

r = requests.get('http://www.about.com/')
c = r.cookies
i = c.items()

for name, value in i:
    print(name, value) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-28T15:38:04.637

查看`Cookie:`您获得的 HTTP 响应中的标头，`Cookie`使用标准库中的模块解析它们的内容。

# xml - XML 声明标签是否区分大小写？

> ID：921533
> 
> 赞同：10
> 
> 时间：2009-05-28T15:35:12.833
> 
> 标签：xml, encoding, utf-16

我有一个可能是一个非常简单、深奥的问题，但我在任何地方都找不到答案，我需要对此非常确定。

我有来自不同供应商的各种 XML 文件。供应商之一为我提供了一个 XML 文件，其中包含日文字符。最初，我在处理 XML 文件时遇到了问题（我使用的是[MSXML SDK](http://msdn.microsoft.com/en-us/library/ms760399(VS.85).aspx)）。字符会出现错误。我发现如果将以下内容添加到 XML 文件中，一切都会很好。

```
<?xml version="1.0" encoding="UTF-16"?> 
```

所以我要求供应商将其添加到他们的文件中。但是他们用小写的编码添加了它：

```
<?xml version="1.0" encoding="utf-16"?> 
```

当我使用这个声明加载这个新文件时，我遇到了与没有这个声明时相同的问题。

我想要弄清楚（肯定）是该编码属性是否区分大小写（或者是其他问题）。**他们将“utf-16”与“UTF-16”放在一起重要吗？**

**更新**：在这些发布答案的人的建议下，我设置并执行了测试。一个文件为小写 utf-16，另一个为大写。除此之外，文件是相同的。**这没有解决问题**，也不是问题。我的结论是 MSXML 不区分大小写，因为在答案中发布的规范指出。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-28T15:40:15.943

我想问题不是真的“*标准*区分大小写吗？” *但是“ MSXML SDK*中的编码是否区分大小写？”

来自[bytes.com](http://bytes.com/groups/xml/665394-encoding-directive-case-sensitive)：

> XML 规范说处理器“应该”不区分大小写地匹配编码名称。“应该”是一个技术术语，不如“必须”强，但我看不出处理器不这样做的任何原因。

然而，我们知道这在实践中可能并不总是正确的。如果您可以同时尝试两者，请这样做并告诉我们结果如何。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-28T15:38:59.330

从[XML 规范](http://www.w3.org/TR/2008/REC-xml-20081126/#charencoding)：

```
XML processors SHOULD match character encoding names in a case-insensitive way 
```

[因此，根据RFC 2119](http://www.ietf.org/rfc/rfc2119.txt)，不需要但建议不区分大小写：

> 3.  应该这个词，或形容词“推荐”，意味着在特定情况下可能存在忽略
>     特定项目的正当理由，但在选择不同的课程之前必须理解并
>     仔细权衡全部含义。

# performance - nHibernate 以及它如何访问数据库，参数是否考虑类型/大小？

> ID：921538
> 
> 赞同：0
> 
> 时间：2009-05-28T15:36:48.913
> 
> 标签：performance, nhibernate

nHibernate 是否创建包含列的所有详细信息的代码？

我知道使用常规的 ado.net，如果您的 sql 参数具有列详细信息，例如：列名、大小、sqltype，它会提高性能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T16:19:49.187

我没有对代码进行深入分析，但是，是的，似乎确实如此。例如，`SqlClientDriver`实现方法如下：

```
public static void SetParameterSizes(IDataParameterCollection parameters, SqlType[] parameterTypes)
private static void SetDefaultParameterSize(IDbDataParameter dbParam, SqlType sqlType)
private static void SetVariableLengthParameterSize(IDbDataParameter dbParam, SqlType sqlType)
public override IDbCommand GenerateCommand(CommandType type, SqlString sqlString, SqlType[] parameterTypes)
{
    IDbCommand command = base.GenerateCommand(type, sqlString, parameterTypes);
    if (IsPrepareSqlEnabled)
    {
        SetParameterSizes(command.Parameters, parameterTypes);
    }
    return command;
} 
```

如果您确实需要检查此源代码，则可以使用源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T01:17:08.163

为什么不自己回答这个问题并使用一个驱动程序来记录和转发所有被 Hibernate 吐出的 SQL。

# msbuild - 在我的解决方案中创建递归地将文件夹复制到多个项目的 MSBuild 任务

> ID：921540
> 
> 赞同：0
> 
> 时间：2009-05-28T15:37:06.560
> 
> 标签：msbuild

我是 MSBuild 的新手，我尝试阅读网上的几个资源，但我错过了一些东西..

这就是我想要的：

*   执行时递归地将目录结构从我机器上的（硬编码/配置）路径复制到解决方案中的一组项目的构建任务
*   然后编译（发布/调试，我想我可以制作两组）
*   最好当我在 VS 中按 f5 时调用此过程，并且可以从发布/调试下拉列表中选择（当然名称不同）。

我还没有得到什么：

*   我在哪里放置我的 .proj 文件？在我的根目录（我的 sln 文件在哪里）？
*   我怎样才能让VS把它捡起来（绑定到f5）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-03T13:54:06.213

查看[Copy Task](http://msdn.microsoft.com/en-us/library/3e54c37h.aspx)示例，了解如何递归地复制文件结构。

# excel - 免费的 VB6/VBA 分析器和最佳 Excel 实践

> ID：921543
> 
> 赞同：5
> 
> 时间：2009-05-28T15:37:57.540
> 
> 标签：excel, vba, vb6, profiling

我们有很多通过 VBA 和 Excel 生成的报告。只有一小部分报告是实际计算 - 大部分工作是 sql 调用和单元格的格式化/写入。其中最长的需要几个小时，大多数需要大约 20-30 分钟。

VBA/Excel 代码插入到 VB6 桌面应用程序使用的 dll 中 - 在这里进行所有 sql 调用。虽然我确信这里还有改进的余地，但我并不关心这个 - 桌面应用程序相当活泼。

两个 VBA 函数被大量使用：它们被称为 GetRange 和 SetupCell，它们几乎总是一起出现。GetRange 函数是 Excel.Range 对象的包装器。它需要一张纸，以及范围范围的 4 个值。它的主要用途是选择要编辑的单元格。似乎没有太多机会优化它，但这是最好的方法吗？

它的合作伙伴是SetupCell。这需要一个 Excel.Range 对象、文本和有关单元格的十几个参数（字体、边框等）。这些参数中的大多数都是可选的布尔值，但同样，这似乎非常浪费。其中一些可以在死后设置，但有些取决于单元格中包含的值。

这些函数中包含相当多的代码，主要是 if 语句和工作不会感谢我发布它。

我想我有两个问题：**有没有更好的方法，它是什么**，**是否有免费的分析器可以用来查看大部分时间是在这里还是在 dll 中？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-31T22:17:01.263

几个小时的报告是荒谬的。

如果问题是 VBA，请购买“Professional Excel Development”（stephen Bullen、Rob Bovey 等人）：这有一个名为 PerfMon 的免费 VBA 分析器。

如果问题是 Excel 计算，请参阅[http://msdn.microsoft.com/en-us/library/aa730921.aspx?ppud=4](http://msdn.microsoft.com/en-us/library/aa730921.aspx?ppud=4)

但我猜这个问题是与逐个单元格引用事物相关的高开销：你应该总是一次在大块单元格中工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T18:29:42.373

这不是分析器的建议，但它是加快 Excel 宏的建议，这些宏正在花费时间更新屏幕。通过在宏运行时关闭屏幕更新，我得到了很好的结果：设置 Application.ScreenUpdating= False，并且[还使用了许多其他类似的设置](http://blogs.msdn.com/excel/archive/2009/03/12/excel-vba-performance-coding-best-practices.aspx)。只需确保在宏完成后再次打开它们：P

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T15:52:47.400

您是否考虑过使用实际的报告解决方案？你的后端数据库是什么？如果您使用的是 MSSQL 2000 或更高版本，那么您可以免费使用相当不错的报告解决方案。[SQL Server 报告服务](http://msdn.microsoft.com/en-us/library/ms159106.aspx)。

听起来好像报告花费了大部分时间来格式化单元格。这可能是报告看起来如此缓慢而桌面应用程序却没有的原因。

或者，如果您事先知道格式并且它是相当静态的，您可以预先格式化工作表以减少一些工作。

我也会把它扔在那里。大多数报告解决方案将允许条件格式等，但由于它们旨在工作，因此性能将比使用 Excel 做的要好得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T18:35:34.077

它不是免费的，但您可以使用它进行概要分析。我怀疑演示将足以满足您的需求：[http ://www.aivosto.com/vbwatch.html](http://www.aivosto.com/vbwatch.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-03T15:49:33.820

听起来 VBA 代码（或写入工作表的 VB 代码）是逐行执行的，这可能需要很长时间，而且设计很差。一次性写入 Excel 作为变体。数据全部导入后格式化工作表。谢谢罗斯

# asp.net - 在经典 ASP 和 ASP.Net 之间共享登录系统

> ID：921550
> 
> 赞同：12
> 
> 时间：2009-05-28T15:39:00.330
> 
> 标签：asp.net, security, asp-classic

客户使用经典的 ASP 登录到其基于 Web 的后台。

我已经编写了一个新的 ASP.Net 应用程序以包含在后台，我需要利用已经存在的登录系统，这样当他们在那里登录时，他们不需要在新的 ASP 中再次登录.Net 应用程序。

登录名和密码以明文形式存储在 SQL Server 数据库中，我可以从我的 ASP.Net 应用程序访问。

整合这些系统的有效方法是什么？

我目前最好的想法是：在我的 ASP.Net 应用程序的链接中，我链接到一个“网关”登录页面，其中包含他们的用户 ID 和一个散列密码 + 查询字符串中的公共秘密。然后我将它与数据库中用户的密码进行比较......但问题是，如果这个查询字符串被截获，它可以用于访问 asp.net 站点，而实际上并不知道用户名和密码......

我很可能忽略了一些简单的事情。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T15:43:31.397

我认为你的想法是正确的。

您可能已经知道，经典的 asp 和 asp.net 不能共享相同的会话状态，因此您确实需要一种从一个登录到另一个的机制。

我要做的是：当有人登录时，为该用户创建一个唯一的 GUID，并将其保存在数据库中。当您从一个站点跳转到另一个站点时，将该 GUID 传递到查询字符串中。当您尝试将它们自动登录到其他站点时，请查看该 GUID 并查看它是否附加到任何人。如果是，请登录。

这样，您就不会传递任何用户可以猜测或解密的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T15:41:54.287

经典的 ASP 系统是如何保持登录状态的？到目前为止，“捎带”将是你最好的选择。

我工作过的所有经典 ASP 系统都使用 cookie 来跟踪身份验证信息，因此只需阅读它们并与您可以访问的数据库进行比较。

* * *

由于信息存储在经典 ASP 会话中，您是否可以将“重定向页面”添加到作为新模块“入口”的经典 ASP 端，并使其将有用数据作为 cookie 写入，或者触发 POST 到您的起始页？通过使用 cookie 或 POST 请求，您可以最大限度地减少对 url “劫持”允许某人在没有用户名/密码的情况下进入 ASP.net 站点的担忧。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-04T12:38:04.593

你担心 MITM 类型的攻击是正确的，可能是通过 DNS 缓存中毒或类似的。根据您的情况，通过向跨应用程序边界传递的登录令牌添加时间约束来减轻这种潜在影响可能就足够了。

“数据库方法中的 GUID”是我自己过去成功使用的方法，既用于在共享同一身份验证数据库的两个应用程序之间传递用户，也用于“密码重置电子邮件”类型的场景。您可以通过在记录中添加一个指定添加 GUID 的日期的列来“过期”，并修改您的应用程序代码以仅登录少于 x 分钟/小时/天的 GUID 身份验证。

另一种方法是通过连接以下内容来避免数据库中的其他字段：

```
UserId + [Value representing current time to nearest x minute / hour /day] + Salt 
```

..对其进行散列，然后在另一个应用程序上复制您的算法并比较两个生成的值。

总的来说，我认为您提出的解决方案适合该问题。这当然不是太复杂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T15:42:03.740

您不能通过表单而不是通过查询字符串提交吗？这将消除它在 url 中被拦截的可能性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T16:26:38.363

如果拦截是一个严重的问题，那么您需要通过 HTTPS 运行该站点。否则，使用密码散列的 UserID + Nonce 是相当强的。

或者，您可以让 ASP 应用程序在登录成功后添加 GUID 会话 cookie，并将该 GUID 存储在数据库表中。您的 ASP.NET 可以从 cookie 中查找 GUID 以查看是否已实现登录。如果您在表中包含 ASP 会话 cookie 值，您可以合理地确保当前 ASP 会话与创建 GUID 时使用的会话相同。

# delphi - DeCAL 和德尔福 2009

> ID：921551
> 
> 赞同：4
> 
> 时间：2009-05-28T15:39:00.580
> 
> 标签：delphi, delphi-2009, decal

有人在 Delphi 2009 中试用过[DeCAL吗？](http://sourceforge.net/projects/decal/)

我正在考虑从 2007 年升级，但我的代码非常依赖于 DeCAL ......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T15:47:42.090

这是适用于 Delphi 2009 的 DeCAL 版本。 [https://cc.embarcadero.com/Item/26159](https://cc.embarcadero.com/Item/26159)

还有一个使用泛型重写 DeCAL 的方法，但这需要你重写你的代码。[https://cc.embarcadero.com/Item/26124](https://cc.embarcadero.com/Item/26124)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T09:58:25.260

很高兴看到 DECAL 中还有生命！

过去我用它做了很多原型设计，但结果证明它对于最终实现来说太慢了

# c# - C# 中的高效图像处理

> ID：921557
> 
> 赞同：11
> 
> 时间：2009-05-28T15:40:28.190
> 
> 标签：c#, .net, asp.net, image

我正在使用这些`System.Drawing`类从用户上传的照片中生成缩略图和带水印的图像。上传原件后，用户还可以使用 jCrop 裁剪图像。我已经从其他人那里接管了这段代码，并希望对其进行简化和优化（它被用于高流量的网站）。

前一个人有静态方法，它接收一个位图作为参数并返回一个，内部分配和处置一个`Graphics`对象。我的理解是，一个`Bitmap`实例包含内存中的整个图像，而`Graphics`基本上是一个绘制操作队列，并且它是幂等的。

该过程目前的工作方式如下：

*   接收图像并将其存储在临时文件中。
*   接收作物坐标。
*   将原始位图加载到内存中。
*   从原始位图创建一个新的位图，应用裁剪。
*   在新位图上做一些疯狂的亮度调整，也许（？）返回一个新位图（我宁愿不碰这个；指针算法比比皆是！），让我们称之为 A。
*   从生成的位图创建另一个位图，应用水印（我们称之为 B1）
*   从 A 创建一个 175x175 的缩略图位图。
*   从 A 创建一个 45x45 的缩略图位图。

这似乎是很多内存分配；我的问题是：重写部分代码并重用`Graphics`实例，实际上是创建管道是个好主意吗？实际上，我只需要内存中的 1 张图像（原始上传），其余的可以直接写入磁盘。所有生成的图像都需要裁剪和亮度转换，以及该版本独有的单一转换，从而有效地创建操作树。

有什么想法或想法吗？

哦，我可能应该提一下，这是我第一次真正使用 .NET，所以如果我说的有些混乱，请耐心等待并给我一些提示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T15:48:27.643

这个过程似乎是合理的。每个图像在保存到磁盘之前都必须存在于内存中——因此每个版本的缩略图都将首先存在于内存中。确保其有效工作的关键是 Dispose 您的 Graphics 和 Bitmap 对象。最简单的方法是使用 using 语句。

```
using( Bitmap b = new Bitmap( 175, 175 ) )
using( Graphics g = Graphics.FromBitmap( b ) )
{
   ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T01:05:04.260

重用 Graphics 对象可能不会带来显着的性能提升。

底层 GDI 代码简单地为您在 RAM（内存 DC）中加载的位图创建设备上下文。

您操作的瓶颈似乎是从磁盘加载图像。

为什么要从磁盘重新加载图像？如果它已经在 RAM 中的字节数组中，它应该在上传时存在 - 您可以在字节数组上创建一个内存流，然后从该内存流创建一个位图。

换句话说，将它保存到磁盘，但不要重新加载它，只需从 RAM 中对其进行操作。

此外，您不需要创建新的位图来应用水印（取决于它是如何完成的。）

您应该分析操作以查看需要改进的地方（或者即使需要改进。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T00:22:59.053

不久前我完成了一个类似的项目并进行了一些实际测试，看看如果我重用 Graphics 对象而不是为每个图像旋转一个新对象，性能是否会有所不同。就我而言，我正在处理大量图像的稳定流（“批次”中> 10,000）。我发现通过重用 Graphics 对象确实获得了轻微的性能提升。

我还发现通过在 Graphics 对象中使用 GraphicsContainers 可以轻松地将不同的状态交换进/出对象，因为它用于执行各种操作，我得到了轻微的增加。（具体来说，我必须在每张图像上应用裁剪并绘制一些文本和一个框（矩形）。）我不知道这对你需要做的事情是否有意义。您可能想查看 Graphics 对象中的 BeginContainer 和 EndContainer 方法。

就我而言，差异很小。我不知道您是否会在实施中获得或多或少的改进。但是由于重写代码会产生成本，因此您可能需要考虑完成当前设计并在重写之前进行一些性能测试。只是一个想法。

您可能会发现一些有用的链接：

[使用嵌套图形容器](http://msdn.microsoft.com/en-us/library/a4sf8bx4.aspx)
[GraphicsContainer 类](http://msdn.microsoft.com/en-us/library/system.drawing.drawing2d.graphicscontainer.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T16:40:25.213

我只是随便把它扔在那里，但如果你想要一个快速“指南”来了解处理图像的最佳实践，请查看 Paint.NET 项目。有关进行图像处理的免费高性能工具，请查看[AForge.NET](http://code.google.com/p/aforge/)。

AForge 的好处是允许您执行很多这些步骤，而无需每次都创建新的位图。如果这是针对网站的，我几乎可以保证您正在使用的代码将成为应用程序的性能瓶颈。

# java - 转换提要的几个节点内容的有效方法

> ID：921558
> 
> 赞同：0
> 
> 时间：2009-05-28T15:40:45.770
> 
> 标签：java, xml, xslt, rss, atom-feed

*   我需要“代理”一个提要
*   并保留大部分节点未受破坏
*   并通过调用一些java方法来转换几个已知节点的内容
*   并返回转换后的提要

当然，我更愿意避免 - 将整个提要加载到内存中 - 转换其他节点 - 性能不佳

这是一种java管道！

感谢您的建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T17:57:23.013

谢谢大家的回答：这是最终结果

```
TransformerFactory tFactory = TransformerFactory.newInstance();
InputStream xslt = FeedSecurityException.class.getResourceAsStream("/filter.xslt");
Transformer transformer = tFactory.newTransformer(new StreamSource(xslt));
transformer.transform(new StreamSource(input), new StreamResult(ouput)); 
```

而 XSLT 为一种节点调用 java 方法并保持其他节点不变

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:java="http://xml.apache.org/xslt/java">

<xsl:output method="xml" encoding="UTF-8" indent="yes" omit-xml-declaration="no" />

<xsl:template match="CHANGED_NODE">
    <xsl:element name="CHANGED_NODE">
        <xsl:value-of select="java:com.mypackage.MyClass.tranformContent(.)"/>
   </xsl:element>
</xsl:template>

<xsl:template match="node()|@*">
<xsl:copy><xsl:apply-templates select="node()|@*"/></xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:51:42.723

好吧，我不知道“不加载到内存中”，但如果你想转换 xml，你应该考虑**[xslt](http://en.wikipedia.org/wiki/Xslt)**和**[xpath](http://www.ibm.com/developerworks/library/x-javaxpathapi.html)**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T19:49:02.727

这是我使用的东西：

```
import javax.xml.transform.Transformer;
import javax.xml.transform.TransformerFactory;
import javax.xml.transform.dom.DOMSource;
import javax.xml.transform.dom.DOMResult;
import org.w3c.dom.Document;
...
TransformerFactory mTransformFactory = TransformerFactory.newInstance();
cTransformer = mTransformFactory.newTransformer(new StreamSource(new StringReader(StringUtil.readFromResource("/foo.xslt"))));
Document mResultDoc = XmlUtil.createDocument();
Document mResultDoc = XmlUtil.parseXmlFile("foo.xml");
transformer.transform(new DOMSource(source), new DOMResult(mResultDoc)); 
```

由于您想避免内存开销，您应该将 DOMSource 和 DOMResult 使用替换为 SAX 等效项。String 和 XML util 类的用法从上下文中应该是显而易见的。

# django - Perl 中的哪个 MVC 框架有自己的独立服务器？

> ID：921559
> 
> 赞同：4
> 
> 时间：2009-05-28T15:40:47.643
> 
> 标签：django, perl, model-view-controller, testing, frameworks

我正在用 Perl 创建一个用于回归测试的自动化测试框架。我想发布测试机器的结果。我之前使用过 django，服务器无需安装即可独立运行。Perl 中的哪个 MVC 框架有自己的独立服务器？基本上，哪个 Perl MVC 框架最接近 django 的服务器功能和 DRY（不要重复自己）原则？

PS我不会用python重写我的框架

PSS 我不会使用 Perl 框架和 django 作为 MVC

（服务器上没有 python :( ）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-28T16:13:00.713

Catalyst 带有一个内置的测试服务器 - 查看[Catalyst::Manual::Tutorial](http://search.cpan.org/~hkclark/Catalyst-Manual-5.8000/lib/Catalyst/Manual/Tutorial.pod)了解更多详细信息。[这](http://search.cpan.org/~hkclark/Catalyst-Manual-5.8000/lib/Catalyst/Manual/Tutorial/03_MoreCatalystBasics.pod#Test_Run_The_Application)看起来是一个不错的起点。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-28T21:38:15.487

每个流行的 Perl Web 框架都带有自己的服务器：Catalyst、CGI::Application、Jifty。最受欢迎和追随 DRY 的是 Catalyst（不知道 Jifty 中的 DRY）。

还有像 Smolder 这样的测试结果聚合器。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-29T00:26:47.207

[Catalyst](http://search.cpan.org/perldoc?Catalyst)带有它自己的服务器`script/myapp_server.pl`。您也可以使用内置服务器在没有反向代理的情况下进行部署，但在这种情况下，建议使用[Catalyst::Engine::HTTP::Prefork](http://search.cpan.org/perldoc?Catalyst::Engine::HTTP::Prefork)：`CATALYST_ENGINE='HTTP::Prefork' script/myapp_server.pl`

我相信[Jifty](http://search.cpan.org/perldoc?Jifty)也有一个内置的开发服务器，就像[Squatting](http://search.cpan.org/perodoc?Squatting)一样，但我没有使用过它们中的任何一个。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T16:04:13.540

也许[是催化剂](http://www.catalystframework.org/)。我不知道它是否有独立服务器，但它是带有 MVC 的 Perl，

# asp.net - 以编程方式在 ie7 中打开一个新选项卡

> ID：921560
> 
> 赞同：4
> 
> 时间：2009-05-28T15:41:06.567
> 
> 标签：asp.net, javascript, internet-explorer-7, tabs

我正在使用 c#、Aspnet 3.5 和 Ajax 2.0 开发 Web 应用程序。

问题 - 我在 ie7 中运行 Application_1。无论客户端设置是什么，我都想以编程方式在新选项卡中从 Application_1 开始运行 Application_2。

到目前为止，我一直在使用 Application_1 在新窗口中打开 Application_2

```
ScriptManager.RegisterStartupScript(this, typeof(Page), UniqueID, "window.open('theurl',' width=800, height=500'); ", true); 
```

我想做类似的事情来打开一个新标签。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T15:45:16.120

不幸的是，无法控制窗口是在新选项卡还是新窗口中打开。这是无法在代码中覆盖的用户设置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T15:47:22.607

如果您有兴趣，这是微软的理由。

*“关于脚本，除了今天的多个窗口可用之外，没有“target='_tab'”功能或从脚本直接访问选项卡。我们正在努力平衡从脚本打开的窗口是否打开的默认行为，如新框架或标签。”*

*   [IE博客](http://blogs.msdn.com/ie/archive/2005/05/26/422103.aspx)

您可以通知您的用户，按住 ctrl+shift 并单击链接将在新选项卡中打开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T16:09:31.440

正如保罗已经指出的，这不能通过任何脚本或代码来完成。

我认为最好让您的用户决定（通过他们各自的浏览器设置）他们希望如何打开新页面 - 在新窗口中或在同一窗口的新选项卡中。

# php - 在金字塔结构中生成随机玩家力量 (PHP)

> ID：921570
> 
> 赞同：4
> 
> 时间：2009-05-28T15:42:55.283
> 
> 标签：php, random

对于在线游戏（MMORPG），我想创建具有随机强度值的角色（玩家）。角色越强大，这种类型的存在就越少。

例子：

*   12,000实力1名选手
*   10,500 力量 2 名球员
*   8500实力3人
*   6000实力4人
*   3000实力5人

实际上，我需要从 1.1 到 9.9 的浮动渐进强度值，但对于这个例子，用整数强度来解释它更容易。

你知道我如何用 PHP 编写代码吗？当然，我需要 mt_rand() 来生成随机数。但是我怎样才能实现这种金字塔结构呢？

它是什么功能？根函数、指数函数、幂函数还是对数函数？

提前致谢！

它在图表中应该如下所示：

[金字塔图 http://img7.imageshack.us/img7/107/pyramidy.jpg](http://img7.imageshack.us/img7/107/pyramidy.jpg)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T17:48:09.023

您可以模拟一种分布，例如您使用对数函数描述的分布。以下将返回 1.1 到 9.9 之间的随机强度值：

```
function getRandomStrength() 
{
    $rand = mt_rand() / mt_getrandmax();
    return round(pow(M_E, ($rand - 1.033) / -0.45), 1);
} 
```

超过 1000 次运行`S`的分布（强度值在哪里）：

```
S | Count
--+------
1 -  290
2 -  174
3 -  141
4 -  101
5 -  84
6 -  67
7 -  55
8 -  50
9 -  38 
```

## 笔记：

此答案已更新为包含强度值 1.1（由于舍入，之前未包含）并修复了[`mt_getrandmax()`](http://us2.php.net/manual/en/function.mt-getrandmax.php)函数的名称

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T15:49:01.887

最简单的方法是为随机数应该去的地方提供“带”。在您的示例中，您有 15 名玩家，因此您可以拥有：

```
rand < 1/15, highest strength
1/15 < rand < 3/15, second highest
3/15 < rand < 6/15, third highest
6/15 < rand < 10/15, fourth highest
10/15 < rand < 15/15, lowest strength 
```

您还可以使用您允许的每个波段的“最大”数量来参数化这样的函数，当波段被填充时，它被包含在下一个最低的现有波段中（除​​了底部波段，它将被包含在下一个最高的波段中） ) 以确保只有一定数量的每个具有随机分布。

从我的评论中编辑添加：

要获得浮动范围金字塔结构，最好的函数很可能是对数。公式：

```
11 - log10(rand) 
```

可以工作（log10 是以 10 为底的对数），因为这会给出如下范围：

```
1 < rand < 10 = 9 < strength < 10
10 < rand < 100 = 8 < strength < 9
100 < rand < 1000 = 7 < strength < 8
etc. 
```

但是 rand 需要在 1 到 10^10 的范围内，这需要很多随机性（比大多数随机生成器可以管理的要多）。要获得这种范围内的随机数，您可以将一些相乘。3个随机数可以管理它：

```
11 - log10(rand1 * rand2 * rand3) 
```

rand1 的范围为 1-10000，rand2 和 rand3 的范围为 1-1000。不过，这会使分布略微偏离正确的金字塔（我相信更有可能在中心有数字），因此它可能不合适。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T16:04:42.790

我认为 workmad3 已经开始了，但有一个问题 - 您需要跟踪您的存储桶大小以及它们是否已满。随机数生成器不能保证这一点。您需要分配您的桶值（强度）和大小（人数），并让您的随机生成器告诉您将玩家放入哪个桶 - 如果该桶已满，则“溢出”到下一个较低的桶。

至于为给定的强度值分配桶大小，这是一个棘手的问题（我认为你真正在做什么）。所需分布的特征至关重要。如果你想要一个线性下降（金字塔形状暗示），一条形式的线

```
strength = max_strength - m(number_characters) 
```

会工作。改变 m 的值会改变线路下降的速度，并且基本上会限制您的最大总字符数。如果您正在寻找一种更复杂的方式来降低强度值，您可以使用抛物线或双曲线 - 这些曲线稍微复杂一些，但会给您带来截然不同的特征。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T15:58:59.573

像这样的东西

```
<?php

$rand = rand(1,10);

switch ($rand) {

case 1:
echo "band 1";
break;

case 2:
case 3:
echo "band 2";
break;

case 4:
case 5:
case 6:
echo "band 3";
break;

default:
echo "band 4";
break;

}

?> 
```

波段 1 最强，波段 4 最弱。

当然这是基本的，你会想要重构它以使用循环而不是硬编码开关，但你明白了:)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-28T15:49:25.927

生成一个介于 0 和 40000 之间的随机数，如果它在 0 和 12000 之间，分配强度 1，在 12000 和 22500 之间分配 2 等。

编辑：对于 0 到 10 之间的渐进值，使用 0 到 100 之间的随机数的平方根，然后从 10 中减去

*   兰德->力量
*   0-1 -> 9.9 -> 9 (1%)
*   2-4 -> 9 -> 8 (2%)
*   ...
*   81 - 100 -> 1 - 0 (19%)

对于 1.1 和 9.9 之间的结果，公式将是伪代码）

强度 = 10 - sqrt(rand(1..79))

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-28T16:20:04.427

在这种情况下，使用百分比可能是最简单的。

从您的示例中大约是（转换为数组以便以后使用）：

```
$strength[1] = .3;  // start with a key of 1
$strength[2] = .26;
$strength[3] = .21;
$strength[4] = .15;
$strength[5] = .08; 
```

这样，您可以生成一个随机数，`mt_rand()`然后除以可能的最大值，得到一个介于 0 和 1 之间的数字：

```
$rand = mt_rand() / mt_getrandmax(); // rand is some random value between 0 and 1 
```

然后您可以使用`foreach`语句来隔离每种情况：

```
$comparisonPercentage = 1;
$selectedLevel = count($strength); // covers the case where mt_rand() returns 0
foreach($strength as $level => $currentPercentage) 
{
    $comparisonPercentage -= $currentPercentage;
    if ($rand >  $comparisonPercentage) 
    {
        $selectedLevel = $level;
        break;
    }
}

// $selectedLevel contains the level you need... 
```

如果您这样做，则只需在`$strength`需要调整百分比时更改数组。

# java - SSLEngine 并关闭

> ID：921579
> 
> 赞同：2
> 
> 时间：2009-05-28T15:44:05.407
> 
> 标签：java, networking, ssl, nio, sslengine

我已经实现了一个帮助模块，它让我从与 SSL 一起使用的通道中获取干净的数据并将加密数据写入其中：这是相关的接口（我在该类中也有一些非抽象方法，所以没有说对我来说，“DataProvider 应该是一个接口”；））：

```
public abstract class DataProvider {
    // Notify the bytes read from the net
    public abstract void readFromNet(ByteBuffer b);
    // Gets the bytes to write into the net
    public abstract void writeToNet(ByteBuffer b);
    // Add a message to send
    public abstract boolean addMessage(byte[] data);
    // Obtains the application data received
    public abstract byte[] getReceivedApplicationData();
    // True if there is something to actually send over the wire
    public abstract boolean dataToSend();
    // True if we should close the channel
    public abstract boolean shouldClose();
    // Notify our intention to shut down the connection
    public abstract void shutDown(SelectionKey sk);
    // Set the interest op set for the channel
    public abstract void setInterestOps(SelectionKey sk);
} 
```

我有一个用于 SSL 的抽象基类的实现。在测试该实现时，我编写了两个函数：在一个函数中，我收到一条带有 SocketChannel 的消息，用于发送数据的 SSLSocket 关闭连接，在另一个中，我使用 SocketChannel 发送一条消息，以此启动关闭。现在，问题是用于接收数据的 SSLSocket 没有关闭，即使我已经发布了这些步骤：

1.  engine.closeOutbound()
2.  engine.wrap()
3.  channel.write(data) （是的，我确定我已经发送了使用 wrap() 获得的所有数据
4.  选择用于读取入站 close_notify 的通道

问题是选择器卡在第 4 步。

在另一个测试中（SSLSocket 关闭连接）我没有问题。

请注意，我已将 shouldClose 实现为：

```
return engine.isOutboundDone() && engine.isInboundDone(); 
```

所以我需要一个传入的 close_notify 才能关闭，即使我已经初始化了关闭（我不知道这是否正确：最终我可以用 更改它`return engine.isOutboundDone()`）

这是我的 SSLSocket 端代码：

```
Socket toRead = socket.accept();
toRead.setSoTimeout(0);
InputStream is = toRead.getInputStream();
ByteArrayOutputStream bos = new ByteArrayOutputStream();
String read = "";
byte[] barray = new byte[1024];
while (read.length() < toSend.length() * 2) {
    int bytesRead = is.read(barray);
    bos.write(barray, 0, bytesRead);
    read = new String(bos.toByteArray());
}
assertEquals(toSend + toSend, read);
assertTrue(toRead.isClosed()); 
```

最后一个断言被违反。

最初我认为这是因为没有与 toRead 关联的“后台”线程，所以我应该对其进行读/写以消耗传入的内容`close_notify`，然后最终关闭套接字，但即使这样也没有帮助。

任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-07-17T02:21:29.617

很晚的答案，但如果您已经发送了一个，则不需要等待 close_notify，请参阅 RFC 2246。但是您应该得到一个。你没有说你在 close_notify 上选择的准确程度。

注意您的代码没有意义。只有关闭套接字才会关闭*它*。`isClosed()`指的是套接字，而不是连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T17:37:30.673

我建议`is.close();`在拳头断言之前添加。

请注意，我建议的这段小代码不会关闭套接字。它应该关闭 InputStream。

# combobox - 同步组合框

> ID：921582
> 
> 赞同：0
> 
> 时间：2009-05-28T15:44:33.907
> 
> 标签：combobox, synchronized

如何获得 2 个同步组合框，以便更改一个的索引会自动更改另一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:48:12.527

我不知道您使用的是什么语言，但是对于 .NET 之类的东西，您将进入组合框的 SelectedIndexChanged 事件并在其中放置：

`Combobox1.SelectedIndex = ComboBox2.SelectedIndex`反之亦然。

注意：您要确保您的盒子的 AutoPostback 属性设置为 True。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:48:26.957

这取决于框架/语言/工具包/平台，以及许多其他特性，但基本思想是相同的：

只需监听两个组合框上的“选定项目已更改”事件/信号/等，当一个更改时，适当设置另一个。

# algorithm - 是否有一种有效的方法来确定叶节点是否可以从有向无环图中的另一个任意节点到达？

> ID：921588
> 
> 赞同：3
> 
> 时间：2009-05-28T15:45:22.203
> 
> 标签：algorithm, optimization, graph, directed-acyclic-graphs

[维基百科：有向无环图](http://en.wikipedia.org/wiki/Directed_acyclic_graph)

不确定叶节点是否仍然是正确的术语，因为它不是真正的树（每个节点可以有多个子节点，也可以有多个父节点），而且我实际上正在尝试找到所有根节点（这实际上只是语义问题，如果你反转所有边的方向，它们将是叶节点）。

现在我们只是遍历整个图（可以从指定的节点访问），但这有点贵，所以我想知道是否有更好的算法来做这件事。我在想的一件事是我们跟踪已经访问过的节点（在遍历不同的路径时）并且不重新检查这些节点。

还有其他算法优化吗？

我们还考虑过保留一个该节点是其后代的根节点的列表，但如果我们需要检查它是否在每次添加、移动或更改节点时都发生变化，那么维护这样一个列表似乎也会相当昂贵。删除。

编辑：

这不仅仅是查找单个节点，而是查找作为端点的所有节点。

也没有节点的主列表。每个节点都有一个它的子节点和它的父节点的列表。（嗯，这并不完全正确，但是提前从数据库中提取数百万个节点的成本非常高，并且可能会导致 OutOfMemory 异常）

编辑2：

可能会或可能不会改变可能的解决方案，但该图是最底层的，因为最多有几十个根节点（我试图找到）和数百万个（可能是数千万或数亿个）叶节点（我'我开始）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T15:59:50.087

有几种方法可能会更快，具体取决于您的结构，但总的来说，您需要的是遍历。

深度优先搜索，遍历每条可能的路线，跟踪已经访问过的节点。这是一个递归函数，因为在每个节点上，您必须分支并尝试它的每个子节点。如果您不知道以哪种方式查找对象，则没有更快的方法，您只需尝试每种方式！你肯定需要跟踪你已经去过的地方，否则会很浪费。它应该要求按节点数量的顺序进行完全遍历。

广度优先搜索类似，但在“继续”之前访问节点的每个子节点，因此会建立与所选根的距离层。如果预计目的地靠近根节点，这可能会更快。如果预计它会一直沿着一条路径前进，那么它会更慢，因为它会迫使您遍历所有可能的边缘。

您可能保留一个已知根节点的列表是对的，但权衡是您基本上必须在更改图形时进行搜索。如果您很少更改图表，这是可以接受的，但如果您更改图表的频率超过了生成此信息所需的频率，那么成本当然太高了。

编辑：信息更新。听起来我们实际上是在寻找两个任意节点之间的路径，根/叶语义不断切换。DepthFirstSearch (DFS) 从一个节点开始，然后对每个未访问的子节点进行递归。如果找到目标节点，则中断。由于递归评估的方式，这将一直沿着“左”路径遍历，然后在到达“右”路径之前枚举该距离处的节点。如果目标节点可能是右边的第一个子节点，那么这是耗时且低效的。广度优先一步一步走，在继续前行之前覆盖所有孩子。因为您的图表像树一样底部很重，所以两者的执行时间大致相同。

当图表底部很重时，您可能对反向遍历感兴趣。从目标节点开始往上走，因为这个方向的节点相对较少。只要节点的父节点通常比子节点多，这个方向就会快得多。你也可以结合这些方法，一个上一个下一个，然后比较节点列表，然后在中间的某个地方会面。（如果您忽略每一步完成两倍的工作，这种组合可能看起来最快）。

但是，由于您说您的图表存储为子列表列表，因此您没有真正的方法可以向后遍历图表。一个节点不知道它的父节点是什么。这是个问题。要修复它，您必须通过在图形更新中添加该数据或通过创建整个结构的副本（您所说的太大）来让节点知道它的父节点是什么。它将需要重写整个结构，这听起来可能是不可能的，因为此时它是一个大型数据库。有很多工作要做。 [http://en.wikipedia.org/wiki/Graph_(data_structure)](http://en.wikipedia.org/wiki/Graph_(data_structure))

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T15:50:01.977

只需着色（跟踪）访问的节点。

Python中的示例：

```
def reachable(nodes, edges, start, end):
  color = {}
  for n in nodes:
    color[n] = False
  q = [start]
  while q:
    n = q.pop()
    if color[n]:
      continue
    color[n] = True
    for adj in edges[n]:
      q.append(adj)
  return color[end] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T13:26:31.723

对于一个顶点x，你想计算一个位数组f(x)，每个位对应一个根顶点Ri，1(resp 0)表示“x可以(resp不能)从根顶点Ri到达。

您可以将图形划分为一个“上”集合 U，其中包含所有目标根 R，如果 x 在 U 中，则 x 的所有父级都在 U 中。例如，距离最近的 Ri <=D 的所有顶点的集合.

保持 U 不要太大，并为 U 的每个顶点 x 预先计算 f。

然后，对于查询顶点 y：如果 y 在 U 中，则您已经有了结果。否则，递归地对 y 的所有父节点执行查询，缓存每个访问顶点 x 的值 f(x)（例如在地图中），因此您不会计算两次值。f(y) 的值是其父值的按位或。

# c# - SQL Server 数据库的最大连接数

> ID：921594
> 
> 赞同：1
> 
> 时间：2009-05-28T15:45:55.450
> 
> 标签：c#, sql-server-2005, database-connection

一个用户到 SQL Server 2005 的最大连接数是多少？我在尝试在不同线程中建立与数据库的多个连接时遇到 C# 代码问题。大约五个线程后，其他线程中的连接开始超时。如果我知道一个用户的确切连接数，即使它是一个，也将有助于了解我一次可以加载多少个线程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T15:50:19.497

5个连接，你开始超时？这闻起来像是连接未关闭和/或并发问题（锁/死锁）。我的服务可以产生线程并生成超过 100 个连接而没有任何问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T16:02:54.993

长镜头，5 个连接听起来你可能有许可问题。您使用的 SQL 实例是否受限于并发连接数？（这不是我必须处理的事情。我知道有 CAL 许可计划，如果您使用 SQL Server Express 版本，可能会有限制。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:50:54.970

除了每个用户允许的连接数之外，最好确保在完成连接后立即有效地关闭连接，以确保连接池不会很快用完。

# nhibernate - hql 会给你编译时错误吗？

> ID：921598
> 
> 赞同：0
> 
> 时间：2009-05-28T15:46:56.553
> 
> 标签：nhibernate

hql 会给你像标准查询这样的编译时错误吗？

我记得听说其中一种方法没有（除了原始 SQL）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:50:01.913

最简洁的答案是不。由于 HQL 本质上是一个字符串，因此您需要一个 IDE 来解析它并确定您是否做错了什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-10T13:17:27.020

Hibernate 中的任何查询构建，无论是 HQL 还是 Critieras，都不会产生编译时错误。不过，您可以使用 NamedQuery 注释以静态方式声明静态 HQL 查询。这将在启动应用程序时提供缓存和有效性检查，因为 hibernate 的会话工厂将在第一次启动时读取所有 NamedQueries。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:51:24.220

条件查询*可能不会*给您编译时错误，这样的事情会出错

```
ICriteria crit = sess.CreateCriteria(typeof(Cat));
crit.SetMaxResults("50"); /* wrong parameter type */
List cats = crit.List(); 
```

这样的事情不会

```
IList cats = sess.CreateCriteria(typeof(Cat))
.Add( Expression.Like("Naem", "Fritz%") ) /* misspelled property */
.Add( Expression.Between("Weight", minWeight, maxWeight) )
.List(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T15:50:06.830

HQL 不会给您编译时错误，因为它仅在编译时被视为字符串。“类似条件查询”是什么意思？

# java - 声明依赖 即使没有在任何地方使用依赖项？

> ID：921599
> 
> 赞同：19
> 
> 时间：2009-05-28T15:47:05.947
> 
> 标签：java, maven-2, dependencies

我们正在使用 Maven 2.1.0。我有多个完全独立的模块，但仍然有许多共同的依赖关系。像 log4J，但有些模块不需要它。我想知道在该`<dependencyManagement>`部分的一个父文件中声明所有常见依赖项是否是一个好主意，还是有更好的方法来处理这个问题？

关于 的后续问题`<dependencyManagement>`。如果我在 parent 的部分声明了 Log4J，`<dependencyManagement>`而子项目不使用它，它是否会被包含在内？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-07-30T15:26:56.097

如果你有一个父项目，你可以在父 pom 的 dependencyManagement 部分声明所有依赖项及其版本。这*并不*意味着所有项目都会使用所有这些依赖项，它意味着如果一个项目确实声明了依赖项，它将继承配置，因此它只需要声明依赖项的 groupId 和 artifactId。您甚至可以在父项的 dependencyManagement 中声明您的子项目，而无需引入循环。

请注意，您也可以通过在 pluginManagement 部分中声明插件来对插件进行类似操作。这意味着任何声明插件的孩子都将继承配置。

例如，如果您有 4 个项目，*parent*，*core*，*ui*和*utils*，您可以在 parent 中声明所有外部依赖和内部项目版本。然后，子项目为它们声明的任何依赖项继承该配置。如果所有模块都具有相同的版本，甚至可以在父模块中声明为属性。

一个示例父级如下：

```
<project>
  <modelVersion>4.0.0</modelVersion>
  <groupId>name.seller.rich</groupId>
  <artifactId>parent</artifactId>
  <version>1.0.0</version>
  <packaging>pom</packaging>
  <dependencyManagement>
    <dependencies>
      <dependency>
        <groupId>commons-io</groupId>
        <artifactId>commons-io</artifactId>
        <version>1.4</version>
      </dependency>
      <dependency>
        <groupId>name.seller.rich</groupId>
        <artifactId>ui</artifactId>
      <version>${project.version}</version>
      </dependency>
      <dependency>
        <groupId>name.seller.rich</groupId>
        <artifactId>core</artifactId>
        <version>${project.version}</version>
      </dependency>
      <dependency>
        <groupId>name.seller.rich</groupId>
        <artifactId>utils</artifactId>
        <version>${project.version}</version>
      </dependency>
    </dependencies>
  </dependencyManagement>
  <modules>
    <module>utils</module>
    <module>core</module>
    <module>ui</module>
  </modules>
</project> 
```

并且 utils、core 和 ui 项目继承了所有相关版本。实用程序：

```
<project>
  <modelVersion>4.0.0</modelVersion>
  <groupId>name.seller.rich</groupId>
  <artifactId>utils</artifactId>
  <!--note version not declared as it is inherited-->
  <parent>
    <artifactId>parent</artifactId>
    <groupId>name.seller.rich</groupId>
    <version>1.0.0</version>
  </parent>
  <dependencies>
    <dependency>
      <groupId>commons-io</groupId>
      <artifactId>commons-io</artifactId>
    </dependency>
  </dependencies>
</project> 
```

核：

```
<project>
<modelVersion>4.0.0</modelVersion>
<groupId>name.seller.rich</groupId>
<artifactId>core</artifactId>
<parent>
  <artifactId>parent</artifactId>
  <groupId>name.seller.rich</groupId>
  <version>1.0.0</version>
</parent>
<dependencies>
  <dependency>
    <groupId>name.seller.rich</groupId>
    <artifactId>utils</artifactId>
  </dependency>
</dependencies> 
```

用户界面：

```
<project>
  <modelVersion>4.0.0</modelVersion>
  <groupId>name.seller.rich</groupId>
  <artifactId>ui</artifactId>
  <parent>
    <artifactId>parent</artifactId>
    <groupId>name.seller.rich</groupId>
    <version>1.0.0</version>
  </parent>
  <dependencies>
    <dependency>
      <groupId>name.seller.rich</groupId>
      <artifactId>core</artifactId>
    </dependency>
  </dependencies>
</project> 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-08-20T15:44:06.983

我写了一份[最佳实践](http://motlin.com/2011/maven-best-practices/)清单。这是最重要的。

*   始终使用[maven-enforcer-plugin](http://maven.apache.org/plugins/maven-enforcer-plugin/usage.html)
    *   强制[依赖收敛](http://maven.apache.org/enforcer/enforcer-rules/dependencyConvergence.html)
        *   否则，您可能依赖于两个不同的 jar，它们都依赖于 log4j。在编译时使用哪一个取决于您不必记住的一组规则。它们都可以（！）导出为传递依赖项。
    *   需要[插件版本](http://maven.apache.org/enforcer/enforcer-rules/requirePluginVersions.html)（适用于所有插件，甚至是内置插件）
        *   在父 pom 的 pluginManagement 中定义它们以定义版本
        *   否则，新版本的 maven-surefire-plugin 可能会破坏您的构建
*   在父 pom 中使用 dependencyManagement 以在所有模块中一致地使用版本
*   定期运行[mvn 依赖：分析](http://maven.apache.org/plugins/maven-dependency-plugin/analyze-mojo.html)
    *   您可能会在编译时获得直接依赖的传递依赖。如果是这样，将其添加到您需要的版本的 pom 中很重要。这与执行器插件很好地配合。
    *   It's possible that you're declaring extra dependencies that you don't use. This doesn't work properly 100% of the time, especially with libraries that are designed to have optional pieces (i.e. slf4j-api gets detected properly, but slf4j-log4j12 fails).

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-28T15:58:18.950

每个模块都应该有自己的 POM，并在其中声明自己的依赖项。这不仅跟踪外部依赖关系，还跟踪内部依赖关系。

当您使用 Maven 构建项目时，它会整理出所有内容。因此，如果许多模块（可能全部）依赖于 log4j，那么它只会被包含一次。如果您的模块依赖于不同版本的 log4j，则会出现一些问题，但这种方法通常可以正常工作。

[建立一个内部存储库（如Artifactory](http://sourceforge.net/projects/artifactory/)）并在内部使用它也很有用（如果有超过 1-2 个开发人员一起工作） 。它使处理不在公共存储库中的库变得更加容易（只需将其添加到您的内部存储库！），您还可以使用构建工具将您自己的代码构建推送到那里，这样其他人就可以使用这些模块而无需签出代码（在大型项目中有用）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T18:04:54.467

> 关于 的后续问题。如果我在 parent 的部分声明了 Log4J，而子项目不使用它，它是否会被包含在内？

不。依赖管理只设置默认版本和可能的范围（我已经看到这似乎是被继承的，似乎不是被继承的，所以你需要自己查看这个）。要在子模块中包含依赖项，您需要将其声明为模块的依赖项并省略版本元素。您可以覆盖子模块中的默认值，只需在子模块的 POM 的依赖项元素中包含版本号。

> 我有多个完全独立的模块，但仍然有许多共同的依赖关系。

在这种情况下，是和否。

对于作为一个统一项目一起构建、版本控制和部署的模块，例如组成单个 Web 应用程序的模块，绝对可以。当您决定迁移到依赖项的新版本时，您想减轻在多个 POM 中更改版本的麻烦。当您需要排除某些传递依赖项时，它还可以节省您的工作量。如果您在该部分中声明依赖项及其排除项，则不必在多个 POM 中维护排除项。

对于不直接相关但在公司内的单个团队中构建的模块，您可能需要考虑为通用库（如测试实用程序、日志记录实用程序等）声明默认版本，以保持团队使用标准版本的您已定义为最佳实践的一部分的工具。请记住，当您对一组新的通用库进行标准化时，您总是可以增加超级 POM 的版本。您在标准化库和工具与项目特定库和工具之间划清界限的位置取决于您，但您的团队应该很容易找到它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-12T18:49:40.917

我们为所有项目使用一个带有dependencyManagement 块的公共父级。随着我们将更多项目移动到 maven 中，这种情况开始出现问题 - 如果一个项目需要不同的版本，那么我们必须将其声明为所有子项的依赖项，或者为每个相关子项显式定义版本。

我们正在尝试一个模型，将dependencyManagement 从我们的共同父级中分离出来，然后将我们的公司dependencyManagement pom 导入顶级项目pom。这使我们能够有选择地定义覆盖公司默认值的项目默认值。

这是原始场景：

```
A   defines version 1.0 of foo.jar as the corporate default
B   child of A
C1, C2, C3  children of B
D1, D2, D3 children of C1, C2, C3 respectively 
```

如果 D1 和 D2 需要 foo.jar 的 1.1 版本，那么我们的选择曾经是：

1.  将 foo.jar 版本 1.1 声明为 B 中的依赖项，使 C1、C2、C3 和 D3 似乎也依赖于版本 1.1
2.  将 foo.jar 版本 1.1 声明为 D1 和 D2 中的依赖项，将依赖项声明移动到我们项目层次结构中更深的多个位置。

这是我们正在尝试的：

```
A   defines version 1.0 of foo.jar as the corporate default
B   dependencyManagement: imports A, declares a default of foo.jar version 1.1
C1, C2, C3  children of B
D1, D2, D3 children of C1, C2, C3 respectively 
```

现在 D1 和 D2 只需声明对 foo.jar 的依赖，并从 B 的 dependencyManagement 块中选择 1.1 版本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T15:58:00.777

在一个多模块项目中，我将任何常见的依赖项放在父 pom.xml 的元素中。我不确定如果模块与同一个项目不相关，这是否是最佳实践。

# c# - 如何处理 ViewModel 中的 Validation.Error 而不是 View 背后的代码？

> ID：921601
> 
> 赞同：7
> 
> 时间：2009-05-28T15:47:23.840
> 
> 标签：c#, wpf, validation, mvvm

我试图让 WPF 验证在 MVVM 模式中工作。

在我的视图中，我可以验证这样的文本框，它由代码隐藏方法“HandleError”处理，效果很好：

```
<TextBox Width="200"
         Validation.Error="HandleError">
    <TextBox.Text>
        <Binding Path="FirstName"
             NotifyOnValidationError="True"
             Mode="TwoWay">
            <Binding.ValidationRules>
                <validators:DataTypeLineIsValid/>
            </Binding.ValidationRules>
        </Binding>
    </TextBox.Text>
</TextBox> 
```

但是，我想通过 DelegateCommand 在我的 ViewModel 中处理验证，但是当我尝试使用以下代码时，我得到了显式错误“ **'{Binding HandleErrorCommand}' 不是有效的事件处理程序方法名称。只有实例方法在生成的或代码隐藏的类是有效的。** "

是否有任何解决方法，以便我们可以在 MVVM 模式中处理验证？

**看法：**

```
<TextBox Width="200"
         Validation.Error="{Binding HandleErrorCommand}">
    <TextBox.Text>
        <Binding Path="FirstName"
             NotifyOnValidationError="True"
             Mode="TwoWay">
            <Binding.ValidationRules>
                <validators:DataTypeLineIsValid/>
            </Binding.ValidationRules>
        </Binding>
    </TextBox.Text>
</TextBox> 
```

**视图模型：**

```
#region DelegateCommand: HandleError
private DelegateCommand handleErrorCommand;

public ICommand HandleErrorCommand
{
    get
    {
        if (handleErrorCommand == null)
        {
            handleErrorCommand = new DelegateCommand(HandleError, CanHandleError);
        }
        return handleErrorCommand;
    }
}

private void HandleError()
{
    MessageBox.Show("in view model");
}

private bool CanHandleError()
{
    return true;
}
#endregion 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-28T19:43:24.503

我不知道这是否会帮助你，但我会提供它。

另外，我使用的是 Silverlight，而不是 WPF。

我没有在我的视图中指定任何验证，无论是在后面的代码中还是在 xaml 中。我的视图只有数据绑定到 ViewModel 上的属性。

我所有的错误检查/验证都由 ViewModel 处理。当我遇到错误时，我设置了一个 ErrorMessage 属性，该属性也绑定到视图。ErrorMessage 文本块（在视图中）有一个值转换器，如果错误为空或为空，它将隐藏它。

以这种方式做事可以很容易地对输入验证进行单元测试。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-29T18:56:18.277

这是一种使用 Expression Blend 3 行为的方法。我写了一个 ValidationErrorEventTrigger 因为内置的 EventTrigger 不适用于附加的事件。

**看法：**

```
<TextBox>
<i:Interaction.Triggers>
    <MVVMBehaviors:ValidationErrorEventTrigger>
        <MVVMBehaviors:ExecuteCommandAction TargetCommand="HandleErrorCommand" />
    </MVVMBehaviors:ValidationErrorEventTrigger>
</i:Interaction.Triggers>
<TextBox.Text>
    <Binding Path="FirstName"
             Mode="TwoWay"
             NotifyOnValidationError="True">
        <Binding.ValidationRules>
            <ExceptionValidationRule />
        </Binding.ValidationRules>
    </Binding>
</TextBox.Text> 
```

**ViewModel：（**可以保持不变，但这里看看我如何在使用异常验证规则时挖掘验证参数以找到错误消息）

```
 public ICommand HandleErrorCommand
    {
        get
        {
            if (_handleErrorCommand == null)
                _handleErrorCommand = new RelayCommand<object>(param => OnDisplayError(param));
            return _handleErrorCommand;
        }
    }

    private void OnDisplayError(object param)
    {
        string message = "Error!";
        var errorArgs = param as ValidationErrorEventArgs;
        if (errorArgs != null)
        {
            var exception = errorArgs.Error.Exception;
            while (exception != null)
            {
                message = exception.Message;
                exception = exception.InnerException;
            }
        }
        Status = message;
    } 
```

**验证错误事件触发器：**

```
public class ValidationErrorEventTrigger : EventTriggerBase<DependencyObject>
{
    protected override void OnAttached()
    {
        Behavior behavior = base.AssociatedObject as Behavior;
        FrameworkElement associatedElement = base.AssociatedObject as FrameworkElement;

        if (behavior != null)
        {
            associatedElement = ((IAttachedObject)behavior).AssociatedObject as FrameworkElement;
        }
        if (associatedElement == null)
        {
            throw new ArgumentException("Validation Error Event trigger can only be associated to framework elements");
        }
        associatedElement.AddHandler(Validation.ErrorEvent, new RoutedEventHandler(this.OnValidationError));
    }
    void OnValidationError(object sender, RoutedEventArgs args)
    {
        base.OnEvent(args);
    }
    protected override string GetEventName()
    {
        return Validation.ErrorEvent.Name;
    }
} 
```

# iphone - iPhone 2G 和 3G 之间的内存分配

> ID：921607
> 
> 赞同：0
> 
> 时间：2009-05-28T15:47:56.757
> 
> 标签：iphone

在我为 iPhone 应用程序构建的一个版本中，我无意中创建了一个变量，该变量在其上方范围内隐藏了一个变量。这是无意的，但编译是因为 Objective-C 显然允许在 if 块及其包含方法之间隐藏变量。

当我发出这段代码时，使用 iPhone 3Gs 的人立即遇到了问题，但使用 2Gs 的人没有任何明显的问题。

有谁碰巧知道这两种型号是否存在实际的操作系统差异？不知何故，2G 有编译时、静态内存分配吗？

这是一个很大的困惑，因为我只有一个 2G 的开发设备，从来没有遇到过问题，即使理论上，代码不应该像预期的那样工作。

现在，还有一些其他的不同之处在于 3G 使用的是针对 AdHoc 构建的构建，而 2G 使用的是针对发布的构建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T21:52:16.287

应该没有任何区别，它们使用相同的处理器，我相信相同的 RAM。它们实际上是同一个平台。操作系统实际上是相同的——如果你强制它，iPhone 3G IPSW 可以恢复到 2G（反之亦然）并且它会完美运行（请注意，如果你解压缩 IPSW 并查看它包含 NOR 文件的 iPhone 内部版本两个平台）。

这可能是巧合，因为您的用户可能拥有不同版本的操作系统，或者可能是您的临时构建和发布之间的差异。

# c# - 用于 LINQ 查询的 VB 和 IGrouping

> ID：921616
> 
> 赞同：0
> 
> 时间：2009-05-28T15:49:02.667
> 
> 标签：c#, vb.net, linq

我正在转换 ac# LINQ 示例：

```
var query = from m in typeof(string).GetMethods()
            where m.IsStatic == true
            orderby m.Name
            group m by m.Name into g
            orderby g.Count()
            select new { name = g.Key, overloads = g.Count() }; 
```

在上面的 C# 中，g 是一个 IGrouping，但在下面的 VB 中，它是一个 IEnumerable，因此 g.Key 没有解析。

```
Dim query = From m In GetType(String).GetMethods() _
            Where m.IsStatic = True _
            Order By m.Name _
            Group m By m.Name Into g = Group _
            Order By g.Count _
            Select name = g.Key, [overloads] = g.Count() 
```

我如何在VB中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T16:05:54.910

我想你想要的是这样的：

```
Dim query = From m In GetType(String).GetMethods() _
                        Where m.IsStatic = True _
                        Group m By m.Name Into g = Group _
                        Order By Name, g.Count _
                        Select New With {.MethodName = Name, .Overloads = g.Count()} 
```

希望有帮助。

# linux - 有类似 Linux 的 WMI 的东西吗？

> ID：921617
> 
> 赞同：17
> 
> 时间：2009-05-28T15:49:14.273
> 
> 标签：linux, wmi

我喜欢整个 WMI 概念，我真的可以在 Linux 下使用它（在某些脚本中）。Linux系统有类似的东西吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-31T15:22:00.993

Windows Management Instrumentation (WMI) 是 Microsoft对[分布式管理任务组的](http://www.dmtf.org/home)[WBEM](http://www.dmtf.org/standards/wbem)（基于 Web 的企业管理）标准的实现。这些标准可用于多种 *nix 系统。举个例子，这里有一个在 Linux 系统上启用 WBEM的[SourceForge 项目。](http://sourceforge.net/projects/sblim)有一个标准称为 CIM（通用信息模型），由 DTMF 描述如下：

> CIM 为系统、网络、应用程序和服务的管理信息提供通用定义，并允许供应商扩展。CIM 的通用定义使供应商能够在整个网络的系统之间交换语义丰富的管理信息。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-28T16:04:35.550

并不真地。您是在使用 WMI 来获取系统参数、查询进程、更改配置、监控系统事件还是什么？

`/proc`内核通过文件系统和文件系统公开了许多信息和可调旋钮`/sys`。没有查询语言，只是有组织的目录和文件层次结构。其中一些文件是只读的、读写的或只写的；他们中的一些人`poll`能够。

一些服务可能有自定义客户端来动态查询和更新配置——我想到了chrony [，](http://chrony.sunsite.dk/)`chronyc`但即使是最基本的`init`也有`initctl`。[像HAL](http://freedesktop.org/wiki/Software/hal)这样的新服务可以通过[D-Bus](http://www.freedesktop.org/wiki/Software/dbus)进行内省和操作。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-07-31T14:20:51.963

[OpenLMI](http://www.openlmi.org/)似乎正是为这个目的而设计的……它提供了监视和控制基于 Linux 的服务器的工具。

还有适用于 GNU/Linux 的[WBEM](https://en.wikipedia.org/wiki/Web-Based_Enterprise_Management)代理（如[OpenPegasus](http://www.openpegasus.org)）。

实际上，OpenLMI 似乎使用 Pegasus 作为外部接口。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-11-24T19:27:54.630

我不敢苟同，但是是的，有。获取 FWTS 并运行

```
fwts wmi - 
```

您将看到它是如何实现的以及可以读取/修改的内容。

更多信息：[https ://wiki.ubuntu.com/Kernel/Reference/WMI](https://wiki.ubuntu.com/Kernel/Reference/WMI)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T15:54:12.343

看一下 /proc 接口。你可以在那里得到很多系统信息。还有许多用于收集系统信息的优秀实用程序。sysstat 软件包始终是我这些天安装的第一件事。

编辑：您也可以随时查询 SNMP。默认情况下会暴露很多信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-09T11:17:56.627

也许它可能对你有帮助。看看这篇文章：[http ://www.aldeid.com/wiki/Wmic-linux](http://www.aldeid.com/wiki/Wmic-linux)

# java - 将 Long 转换为 BigDecimal

> ID：921621
> 
> 赞同：40
> 
> 时间：2009-05-28T15:49:28.657
> 
> 标签：java, bigdecimal

我怎样才能`Long`投到`BigDecimal`？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-05-28T15:51:21.397

您必须创建一个新的`BigDecimal`.

```
BigDecimal d = new BigDecimal(long); 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-28T16:07:06.170

为了完整起见，您可以使用：

```
// valueOf will return cached instances for values zero through to ten
BigDecimal d = BigDecimal.valueOf(yourLong); 
```

0 - 10 是 java 6 的实现，不确定以前的 JDK

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-08-16T09:02:20.207

**你不应该使用 BigDecimal d = new BigDecimal(long); ！！**

BigDecimal 中 long 的实现并不精确。对于金融应用来说，这是至关重要的！

但是 String 参数的实现更好！所以使用类似的东西：

```
new BigDecimal(yourLong.toString()); 
```

[在http://www.parleys.com/](http://www.parleys.com/)上有一个关于这个的讨论。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-28T15:50:44.910

你不能投。你可以创建一个新的`BigDecimal`。如果你有非原始的 Long，你可以`long`从`Long`using中得到 a 。`Long.getLongValue()`

```
BigDecimal bigD = new BigDecimal(longVal); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T15:52:43.140

您需要创建一个新的 BigDecimal 对象

```
 Long test = new Long (10);
  BigDecimal bigD = new BigDecimal(test.longValue()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T15:52:01.457

你必须创建一个新的 bigDecimal

[怎么做](http://java.sun.com/j2se/1.4.2/docs/api/java/math/BigDecimal.html#valueOf(long))

# c# - Sitecore 投票模块 - 无法访问或删除投票

> ID：921629
> 
> 赞同：1
> 
> 时间：2009-05-28T15:50:46.127
> 
> 标签：c#, sitecore

我已将最新版本的 Sitecore Polls 模块（版本 3.0.0 rev 090414）安装到我的 Sitecore 6 rev 090120 安装中。

我无法访问或删除我在安装后创建的投票节点，当我尝试在内容编辑器中访问或删除它们时收到错误消息。

另外查看反射器中的二进制文件，看起来命令命名空间中没有定义 DeletePoll 命令。

我已经尝试联系 Sitecore 支持，但他们只是将我推荐给了 SDN 的共享源模块论坛。

有没有其他人经历过这种情况，如果有，你是如何解决的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T12:19:56.753

这些问题似乎是由我们的 web.config 文件中的错误引起的。检查它看起来像是使用了对以前版本的 polls 模块的引用。删除它们至少解决了无法删除民意调查的问题。

# html - 元素是否缓存？

> ID：921630
> 
> 赞同：0
> 
> 时间：2009-05-28T15:50:47.280
> 
> 标签：html, performance, caching

当我向 Privoxy 检查我的浏览器从一个站点下载的内容时，似乎构成页面的所有元素（CSS、JS、图标等）每次都重新下载，即。浏览器不会缓存它们（抱歉，新用途不允许包含 URL）：

```
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <TITLE>My Site</TITLE>
    <meta name="keywords" lang="fr" content="whatever">
    <meta name="Description" lang="fr" content="whatever">

    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <meta name="Category" content="Internet"> 
    <meta name="revisit-after" content="2 days">
    <meta name="author" content="webmaster@example.com">
    <meta name="identifier-URL" content="http://www.example.com">
    <meta name="robots" content="index, follow">
    <meta name="classification" content="Internet">
    <meta name="distribution" content="global">

    <meta name="geography" content="Paris">
    <meta name='language' content='fr'><meta http-equiv='content-language' content='fr'><meta name='rating' content='General'>

    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <link rel="alternate" type="application/rss+xml" title="My RSS" href="http://www.example.com/rss.php" />

    <link rel="shortcut icon" href="favicon.ico">
    <link rel="icon" href="animated_favicon1.gif" type="image/gif">

    <link rel="stylesheet" href="miseenforme.css" type="text/css">
    <link rel="stylesheet" href="css/screen2009.css" type="text/css">
    <!--[if lte IE 6]>
    <link rel="stylesheet" href="css/screen2009-ie6.css" type="text/css">
    <![endif]-->

    <style type="text/css">@import url(jscalendar-1.0/calendar-blue.css);</style>
    <script type="text/javascript" src="jscalendar-1.0/calendar.js"></script>

    <script type="text/javascript" src="jscalendar-1.0/lang/calendar-fr.js"></script>
    <script type="text/javascript" src="jscalendar-1.0/calendar-setup.js"></script>

    <script type="text/javascript" src="jquery-1.2.6.pack.js"></script>
    <script type="text/javascript" src="jquery.scrollTo-min.js"></script>
    <script type="text/javascript" src="jquery.autogrow.js"></script>
    <script type="text/javascript" src="fonctionsjs.js?maj=v1"></script>
</head> 
```

事实上，我在这个 HTML 标头中没有看到任何与缓存相关的指令。

有人可以确认浏览器（IE、Firefox、Chrome）不会缓存任何内容，除非在 HTML 标头中告知？

我们是否需要配置浏览器来强制它们缓存元素？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:57:29.170

短版：不要更改浏览器，发送正确的缓存相关 HTTP 标头*信息。

长版：如果您没有明确告诉浏览器缓存什么以及如何缓存，您可以让浏览器自行选择。此类设置是可配置的，并且因用户和浏览器而异，但通常您可以期望浏览器积极缓存图像、js 和 css，而不是 html（这非常粗略，只是我的经验）。但是，依靠浏览器来解决它是不合理的，如果您在乎的话，您需要明确地告诉它们，并且您还需要使用响应标头而不是元标记来执行此操作，因为元标记根本不被尊重。

长版的短版：缓存很*复杂*。我建议你在谷歌上搜索你选择的语言平台的教程。

* * *

**不是*html头标签的内容，是HTTP头的内容

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T15:57:30.637

你确定它们没有被缓存吗？如果您的服务器没有为静态元素输出缓存控制标头，浏览器仍会针对每个元素向服务器发出 HTTP 请求（带有缓存文件的时间戳）。然后服务器应该以 304 状态响应，而不是修改。所以文件本身不会再次传输，但这个请求-响应可能正是您在 Privoxy 中看到的。

要保存请求，您必须配置服务器以设置缓存控制标头。但是，请注意，您服务器上的更改可能不会反映在客户端上，因此您需要在更改时重命名您的 css/静态文件，以确保所有客户端都使用最新版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:55:38.627

缓存（没有服务器配置或其他明确说明）通常是许多项目的浏览器设置。如果您没有设置足够大的缓存，或者您禁用了缓存，或者您的浏览器不确定它是同一个文件，或者任何其他可能性，它将重新下载这些项目。

您可以设置一些服务器控件。如果您让我们知道您正在运行什么服务器，您可能会得到更好的答案...

最后，您可以查看[http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html)和[http://www.web-caching.com/mnot_tutorial/how.html](http://www.web-caching.com/mnot_tutorial/how.html)了解更多信息。

* * *

根据[您的回复](https://stackoverflow.com/questions/921630/are-elements-cached-or-not/922855#922855)（我猜那是您的新名字……）您想查看您的 Apache 设置。我从来没有使用过 Apache，所以我不知道从哪里开始......

你还想看看我和其他人链接到的一些文章。这不是一个简单的话题。[一篇文章](http://www.web-caching.com/mnot_tutorial/how.html)已链接到几次。（提示提示）

作为一名 PHP 程序员，我对此不是 100% 确定的，但我敢打赌 PHP 有办法覆盖服务器的缓存标头设置。可能值得在这里或 php.net 研究。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T16:05:10.807

我认为首先要检查的是 - 您的浏览器中是否禁用了缓存？

AFAIK，浏览器会缓存大多数页面元素，除非服务器响应中的浏览器设置或 HTTP 标头禁用此缓存。

第二件事是在输出中插入与缓存相关的标头，以便专门指示浏览器缓存所有可用信息（在一段时间内）。

[这是一个关于缓存主题的优秀教程](http://www.web-caching.com/mnot_tutorial/how.html)，有助于消除关于浏览器缓存究竟如何工作的许多误解。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T20:04:43.007

使用[YSlow](http://developer.yahoo.com/yslow/)来确定您应该采取哪些措施来提高页面加载性能。它还告诉您应该做些什么来最大化客户端缓存（即在浏览器中）。

# ruby - Ruby 专家：你能帮助/建议改进这行 ruby 代码吗？

> ID：921640
> 
> 赞同：1
> 
> 时间：2009-05-28T15:52:19.243
> 
> 标签：ruby, string

拆分制表符分隔文件后，我在字符串变量中有所需的值。不幸的是，这个文件的来源是我无法控制的。

以下是该值可能包含的三个确切示例：

1.  “ 5.344”
2.  “-2.345”
3.  “-.977”

注意空格，小数点前面没有'0'，双引号在字符串中。一旦我的字段变量中有每个，这就是我目前正在做的事情：

```
int_val = BigDecimal(value_as_string.gsub(/-\./,"-0.").gsub(/\"/,'').strip).round(0).to_i 
```

我需要将每一个四舍五入到最接近的整数（.to_i 向下舍入）。任何更好的想法将不胜感激，因为我可以提供帮助，但这很臭！？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T15:55:34.993

```
def round(s)
    s.to_f.round
end

round("5.344") # 5
round("-2.345") # -2
round("-.977") # -1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T11:19:05.380

This expression will clean the string, removing everyting but digits, - or decimal dot in the first gsub and the second gsub will add a 0 before the . (keeping the - sign if it exists)

```
some_value.gsub(/[^-\.0-9]/, '').gsub(/^(-?)(\.)/,'\10\2') 
```

Then you will need to round it, with to_f.round should be enough. So the final thing would look like

```
def myround(value)
  value.gsub(/[^-\.0-9]/, '').gsub(/^(-?)(\.)/,'\10\2').to_f.round
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T05:54:47.540

```
def round(str)
  val = BigDecimal(str.gsub(/-\./,"-0.").gsub(/\"/,'').strip)

  if val < 0 then
    return val.floor.to_i
  else
    return val.ceil.to_i
  end
end 
```

# c# - 如何使用 linq 获取列表的差异 和具有 byte[] 属性的匿名类型？

> ID：921646
> 
> 赞同：1
> 
> 时间：2009-05-28T15:53:55.277
> 
> 标签：c#, linq, extension-methods

我是 Linq 和扩展方法的新手，我想我还不能掌握所有扩展方法的使用。

我正在读取一堆文件，在读取一个文件后，我将文件的哈希值存储到数据库中（文件名发生变化，并且它们被移动）。定期，我想检查一个目录并根据它们的哈希值读取我还没有的任何文件。因此，我添加了一个扩展方法来获取文件的 SHA256 哈希：

```
public static byte[] GetSHA256Hash(this FileInfo file)
{
    using (FileStream fs = new FileStream(file.FullName, FileMode.Open))
    {
        using (SHA256 hasher = new SHA256Managed())
        {
            return hasher.ComputeHash(fs);
        }
    }
} 
```

因此，我查询我的数据库并获取我已经阅读的哈希列​​表，检查所有文件的目录，然后我想找出哪些不在我已阅读的文件列表中。我很肯定 filesRead 中的 byte[] 与我的扩展方法返回的哈希匹配。

```
//Get list of hashes that have been read
List<byte[]> filesRead = GetReadFiles();

// I also need the file name, directory, etc so I can pass 
// that info on to the next method that actually reads the file
var filesOnDisk = (new DirectoryInfo("c:\\dirtocheck").GetFiles("*"))
    .Where(file => file.LastWriteTime > new DateTime(2009, 01, 01))
    .Select(fileinfo => new { File = fileinfo, Hash = fileinfo.GetSHA256Hash() });

var filesToProcess = filesOnDisk
    .Where(file => !filesRead.Contains(file.Hash))
    .Select(fileinfo => fileinfo.File).ToList<FileInfo>(); 
```

我的问题是没有文件被过滤掉。我将 filesRead 中的哈希值与 filesToProcess 中文件的哈希值进行了比较，它们匹配。我只是不明白。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T16:00:35.777

是的，埃里克说的。filesRead.Contains 不会按照您的预期进行。[尝试引入一个实现相等](http://ikriv.com:8765/en/prog/info/dotnet/ObjectEquality.html)的新结构或类，以便包含不进行引用比较，而是进行值比较。

# utf-8 - 如何制作 flex（词法扫描仪）来读取 UTF-8 字符输入？

> ID：921648
> 
> 赞同：4
> 
> 时间：2009-05-28T15:54:05.307
> 
> 标签：utf-8, lexical-analysis, flex-lexer

似乎[flex](https://github.com/westes/flex)不支持 UTF-8 输入。每当扫描仪遇到非 ASCII 字符时，它就会停止扫描，就像它是 EOF 一样。

有没有办法强制 flex 吃掉我的 UTF-8 字符？我不希望它真正匹配 UTF-8 字符，只是在使用 '.' 时吃掉它们。图案。

有什么建议吗？

**编辑**

最简单的解决方案是：

任何 [\x00-\xff]

并使用“任何”而不是“。” 在我的规则中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T16:03:54.103

我自己一直在研究这个并阅读 Flex 邮件列表，看看是否有人考虑过。让 Flex 读取 unicode 是一件复杂的事情……

可以进行 UTF-8 编码，而大多数其他编码（16s）将导致驱动自动机的大量表。

目前常用的方法是：

> 我所做的只是编写匹配单个 UTF-8 字符的模式。它们看起来像下面这样，但您可能想重新阅读 UTF-8 规范，因为我很久以前就写过这个了。
> 您当然需要组合这些，因为您需要 unicode 字符串，而不仅仅是单个字符。

```
UB [\200-\277] %% 
[\300-\337]{UB}                   { do something } 
[\340-\357]{UB}{2}                { do something } 
[\360-\367]{UB}{3}                { do something } 
[\370-\373]{UB}{4}                { do something } 
[\374-\375]{UB}{5}                { do something } 
```

取自邮件列表。

在进一步研究之后，我可能会考虑为 UTF-8 支持创建一个合适的补丁。对于大型 .l 文件，上述解决方案似乎无法维护。而且真的很丑！您可以使用类似于创建“。”的范围。替换规则以匹配所有 ASCII 和 UTF-8 字符，但仍然相当难看。

**希望这可以帮助！**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-30T13:34:15.643

编写一个否定字符类也可能有帮助：

[\n \t] 返回空白；[^\n \t] 重新运行 NON_WHITESPACE

# iphone - 实现 NSRunLoop

> ID：921658
> 
> 赞同：1
> 
> 时间：2009-05-28T15:55:59.640
> 
> 标签：iphone, nstimer

好的，我已经阅读了有关为什么使用 NSRunLoop 而不是 NSTimer 调用来运行游戏循环并保持良好的帧速率的文章。

但是我在任何讨论中都没有看到在哪里创建 NSRunLoop。

应该把它放在 didFinishLoading 的末尾吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T16:23:56.887

调用时会自动为您生成运行循环`NSApplicationMain`。您可以使用以下任一方法访问运行循环：

```
runloop = [NSRunLoop mainRunLoop];
runloop = [NSRunLoop currentRunLoop]; 
```

* * *

您链接到的论坛中的代码如下所示：

```
// Yield to system calls (touches, etc.) for one ms.
while (CFRunLoopRunInMode(kCFRunLoopDefaultMode, 0.002, NO) == kCFRunLoopRunHandledSource); 
```

上的文档`CFRunLoopRunInMode`：

> ```
> SInt32 CFRunLoopRunInMode (   
>     CFStringRef 模式，
>     CFTimeInterval 秒，
>     布尔返回AfterSourceHandled
> );
> 
> ```
> 
> 在特定模式下运行当前线程的 CFRunLoop 对象。
> 
> ## 参数
> 
> ### 模式
> 
> 要运行的运行循环模式。…</p>
> 
> ### 秒
> 
> 运行运行循环的时间长度。…</p>
> 
> ### returnAfterSourceHandled
> 
> 一个标志，指示运行循环是否应在处理一个源后退出。…</p>

这意味着`CFRunLoopRunInMode`获取当前线程运行循环并处理所有等待的输入。（喜欢触摸......）。

`while(… == kCFRunLoopRunHandledSource)`确保处理所有事件。

只需按原样使用代码，这是可行的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-05T14:51:23.197

本质上，NSRunLoop 是一个

> ***事件驱动模式***

这个开源项目

> [https://github.com/wuyunfeng/LightWeightRunLoop](https://github.com/wuyunfeng/LightWeightRunLoop)

除了使用***IO Multiplexing***实现 NSRunLoop 之外，还有一些 Runloop-Relative Fundation API，例如在其他线程、***Timer***、***URLConnection***等上***执行选择器（或延迟一些时间）***

 **# bash - 在后台运行 lynx -dump？

> ID：921661
> 
> 赞同：3
> 
> 时间：2009-05-28T15:56:37.253
> 
> 标签：bash, background-process, lynx, job-control

我有一个`mystuff`包含如下行的 bash 脚本

```
lynx -dump http://example.com >tmpfile 
```

并且脚本工作正常，包括这部分，*除非*我以非交互方式运行它：

```
$ ./mystuff &
[1] 3712
$ jobs
[1]+ Stopped 
```

作业已停止。我发现猞猁是罪魁祸首。即使直接从 bash 提示符运行此命令也会导致作业立即停止：

```
$ lynx -dump http://example.com >tmpfile &
[1] 1836
$ jobs
[1]+ Stopped 
```

为什么 lynx 不在后台运行？我怎样才能解决这个问题？

**编辑：**

我使用 lynx 是因为我不想解析原始 HTML。`wget`和的区别在于`lynx -dump`lynx 会渲染 HTML；它将隐藏所有标签，很好地排列文本等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T16:01:29.257

Lynx 想与您的终端交谈，但不能，因此它会执行 SIGSTP（tty 输入）并等待您将进程置于前台。

正如上面的mgb所说：使用wget。`wget -O tmpfile http://example.com`与上面对 lynx 所做的事情相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T15:58:31.447

不是您要寻找的答案，但您可以改用[wget](http://www.gnu.org/software/wget/)吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T17:30:33.490

在我的系统上，您的 lynx 命令按原样工作。试试这个，看看会发生什么：

```
lynx -dump -term=xterm http://example.com >tmpfile & 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-09T16:20:01.190

我们很幸运地运行了 lynx --source http_setting://whatever|bash。

作为 bash 运行允许后台进程绕过使用我的个人凭据运行且没有 tty 差异。

# java - 如何使用 Maven 将 Implementation-Version 值添加到 jar 清单？

> ID：921667
> 
> 赞同：35
> 
> 时间：2009-05-28T15:57:51.197
> 
> 标签：java, maven-2, build-process, jar, manifest

我想在我的 jar 文件中的清单中添加一个 Implementation-Version 行，以反映 POM 版本号。我一生都无法弄清楚如何使用 jar 插件来做到这一点。

这可能吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-05-28T16:12:22.620

您将使用 Maven 存档器：

```
<plugins>
    <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-jar-plugin</artifactId>
      <configuration>
        <archive>
          <manifest>
            <addDefaultImplementationEntries>true</addDefaultImplementationEntries>
          </manifest>
        </archive>
      </configuration>
    </plugin>
  </plugins> 
```

这会将以下内容添加到清单文件中：

```
Implementation-Title: ${pom.name}
Implementation-Version: ${pom.version}
Implementation-Vendor-Id: ${pom.groupId}
Implementation-Vendor: ${pom.organization.name} 
```

# .net - LINQ to MySql 数据提供程序

> ID：921669
> 
> 赞同：2
> 
> 时间：2009-05-28T15:58:05.220
> 
> 标签：.net, mysql, linq, linq-to-sql

在快速谷歌之后，我找不到任何有希望的东西，所以我想知道是否有人知道那里是否有一个好的/广泛使用的 LINQ to MySql 数据提供程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T16:01:34.153

它不存在。目前有一个名为 DBLinq 的项目作为 Mono Olive 项目的一部分来添加对其他提供程序的支持，但目前唯一有效的服务器是 Microsoft 的 SQL Server。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-20T11:32:41.983

我们提供特定于 MySQL 的 LINQ to SQL 技术实现。[在此处](http://www.devart.com/dotconnect/linq.html)
查看其功能。

# javascript - 使用 Showdown.js 渲染 WMD 的浏览器相关问题？

> ID：921670
> 
> 赞同：4
> 
> 时间：2009-05-28T15:58:12.443
> 
> 标签：javascript, jquery, internet-explorer, firefox, wmd

这应该很容易（至少似乎没有其他人遇到类似的问题），但我看不出它在哪里出问题。

我将 Markdown 文本存储在我的应用程序页面上输入的数据库中。使用 WMD 输入文本，实时预览看起来正确。

在另一个页面上，我正在检索降价文本并使用 Showdown.js 将其转换回 HTML 客户端进行显示。

假设我有这段文字：

```
The quick **brown** fox jumped over the *lazy* dogs.

1\. one
1\. two 
4\. three
17\. four 
```

我在我的 jQuery 文档就绪事件中使用这段 Javascript 来转换它：

```
var sd = new Attacklab.showdown.converter();
$(".ClassOfThingsIWantConverted").each(function() {
   this.innerHTML = sd.makeHtml($(this).html());
} 
```

我怀疑这是我的问题所在，但它*几乎*可以工作。

在 FireFox 中，我得到了我的预期：

敏捷的**棕色**狐狸跳过了*懒惰*的狗。

1.  一
2.  二
3.  三
4.  四

但在 IE（7 和 6）中，我得到了这个：

敏捷的**棕色**狐狸跳过了*懒惰*的狗。1\. 一 1\. 二 4\. 三 17\. 四

显然，IE 正在删除我的降价代码中的中断并将它们转换为空格。当我查看原始代码的源代码时（在脚本运行之前），容器 DIV 中存在中断。

我究竟做错了什么？

**更新**

它是由 IE innerHTML/innerText “怪癖”引起的，我之前应该在 ASP.Net 页面上使用数据绑定控件提到这一点 - 显然还有很多不同的解决方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T20:03:58.097

导致问题的是 Internet Explorer innerHTML/innerText “怪癖”。对于所有未标记为 的元素`<pre>`，IE 会在将它们交给 Javascript 之前为它们去除空格。

我不能只在`<pre>`标签中留下带有 markdown 文本的元素，因为这样 Showdown 生成的 HTML 就不会正确显示。解决方案是将其暂时包装在 a 中`<pre>`，然后进行更改。

ASP.Net 代码现在看起来像这样：

```
<div class="ClassOfThingsIWantConverted">
    <pre><%# Eval("markdowntext") %></pre>
</div> 
```

Javascript/jQuery 看起来像这样：

```
var sd = new Attacklab.showdown.converter();
$(".ClassOfThingsIWantConverted").each(function() {
   this.html(sd.makeHtml($("pre",this).text()));
} 
```

现在在两个浏览器上都可以正常工作...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-02T18:13:54.680

[无论有没有 jQuery，Showdown 都很](http://mathiasbynens.be/notes/showdown-javascript-jquery)容易使用。这是一个 jQuery 示例：

```
// See http://mathiasbynens.be/notes/showdown-javascript-jquery for a plain JavaScript version as well
$(function() {
 // When using more than one `textarea` on your page, change the following line to match the one you’re after
 var $textarea = $('textarea'),
     $preview = $('<div id="preview" />').insertAfter($textarea),
     converter = new Showdown.converter();
 $textarea.keyup(function() {
  $preview.html(converter.makeHtml($textarea.val()));
 }).trigger('keyup');
}); 
```

# eclipse - 如何告诉 Eclipse 3.4 WTP 在 JSP 保存时不重启 Tomcat？

> ID：921684
> 
> 赞同：11
> 
> 时间：2009-05-28T16:00:38.163
> 
> 标签：eclipse, tomcat, eclipse-wtp

每当我在我的 WTP 项目中保存 JSP 文件时，Eclipse 都会重新启动它的 Tomcat 实例。这有点让我发疯。我不想完全禁用自动重新加载，我只是不想在保存不需要重新启动的文件时发生这种情况。

我不确定 Eclipse WTP 在这方面是如何工作的。这可能是我的项目结构吗？JSP 文件位于 WEB-INF/jsp 中。

（[这个 SO 问题](https://stackoverflow.com/questions/712232/stop-eclipse-restarting-my-web-app-on-file-save)与我的类似，但没有足够的答案）

编辑：我希望自动重新加载发生，但不适用于不需要它的文件保存。当我保存 JSP 时，没有理由让 Tomcat 重新启动。因此，如果可能的话，我正在寻找的是一种更智能的重新加载方式。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-29T14:39:58.427

打开 server.xml（如果您不知道它在哪里，请使用 ++ 快捷方式`Ctrl`）`Shift`。`R`找到适当的上下文标签并将 reloadable 设置为 false。这样，Tomcat 可以在 Eclipse 不重新启动的情况下进行热代码替换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-11-28T21:51:30.370

我已经向 Eclipse 提交了一个补丁，允许您为每个服务器指定是否希望它添加默认启用或禁用“自动重新加载”的新模块。他们正在考虑为 Eclipse 的下一个版本打补丁。

您可以通过在此处投票支持此补丁来提供帮助：[https ://bugs.eclipse.org/bugs/show_bug.cgi?id=363892](https://bugs.eclipse.org/bugs/show_bug.cgi?id=363892)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-16T13:50:55.927

面临同样的问题，将 reloadable 设置为 false 也禁用 java 类的重新加载。我已经解决了将我的 eclipse 项目的 web-inf/lib 文件夹移动到另一个文件夹的问题。这是wtp错误。

[重量级](http://wiki.eclipse.org/WTP_Tomcat_FAQ#Why_does_my_context_reload_after_I_publish_a_change_that_only_involves_a_changed_JSP.3F)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T08:00:57.893

禁用应用程序的自动重新加载。您链接到的问题的答案中提到了它。（家伙说要启用它，但这会导致您观察到的行为。改为禁用它！）

# c# - ASP.NET 中继器问题（+ 关于最佳实践的问题）

> ID：921688
> 
> 赞同：4
> 
> 时间：2009-05-28T16:01:05.607
> 
> 标签：c#, asp.net, repeater

我对 ASP.NET 还很陌生，最近我发现了中继器。有些人使用它们，其他人不使用，我不确定哪种解决方案是最佳实践。

根据我的经验，它使简单的操作（显示列表）变得简单，但是一旦你想做更复杂的事情，复杂性就会爆炸，逻辑明智。

也许只是我和我对这个概念的理解很差（这很有可能），所以这是我想要做什么和我的问题的一个例子：

* * *

**问题**：我想显示位于文件夹中的文件列表。

**解决方案**：

```
String fileDirectory = Server.MapPath("/public/uploaded_files/");
String[] files = Directory.GetFiles(fileDirectory);
repFiles.DataSource = files;
repFiles.DataBind(); 
```

和

```
<asp:Repeater ID="repFiles" runat="server" OnItemCommand="repFiles_ItemCommand" >
        <ItemTemplate>
           <a href="/public/uploaded_files/<%# System.IO.Path.GetFileName((string)Container.DataItem) %>" target="_blank">View in a new window</a> 
           <br />
        </ItemTemplate>  
</asp:Repeater> 
```

这工作正常。

* * *

**新问题**：我希望能够删除这些文件。

**解决方案**：我在项目模板中添加了一个删除链接：

```
<asp:LinkButton ID="lbFileDelete" runat="server" Text="delete" CommandName="delete" /> 
```

我抓住了这个事件：

```
 protected void repFiles_ItemCommand(object source, RepeaterCommandEventArgs e)
        {
            if (e.CommandName == "delete")
            {
                // ... blah
            }
        } 
```

……然后呢？知道 e.Item.DataItem 为空（我运行了调试器），我如何获取要从此处删除的文件路径。

当我可以使用循环来完成同样的事情时，我是否只是浪费了使用中继器的时间，这同样简单，只是 - 可能 - 不那么优雅？

与其他解决方案相比，使用中继器的真正优势是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T16:13:15.707

您绝对可以在显示时处理 LinkBut​​ton 事件。您可以像这样将 CommandArgument 添加到您的 LinkBut​​ton：

```
<asp:LinkButton CommandArgument="<%# (string)Container.DataItem %>" ID="lbFileDelete" runat="server" Text="delete" CommandName="delete" /> 
```

然后在你的代码中你可以这样做：

```
string path = e.CommandArgument.ToString(); 
```

一般来说，我是Repeater控件的粉丝。它使您能够使用有限的代码和对生成的 HTML 的高级控制来快速重复操作。我更喜欢它而不是 GridView 和其他更复杂的控件，因为您可以根据需要进行更精细的调整来生成输出。

我更喜欢它而不是循环，因为我相信如果您不将大量 HTML 附加到代码中以生成生成的 HTML，您可以更快地开发，并且错误更少。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:13:47.780

对于显示事物列表，Repeater 通常比 GridViews、DataLists 和它们的其他对应物更快。中继器最适合显示，而不是添加和编辑记录，尽管您可以手动连接使用中继器进行 CRUD 操作所需的内容。

在您的示例中，您需要将文件路径绑定到链接按钮的 CommandArgument 属性。然后，您应该可以在事件处理程序中使用 e.CommandArgument 访问路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T16:15:53.483

中继器比类似选项更快、更灵活，因为中继器不添加自己的代码。在某种程度上，它们是一个美化的 for 循环，尽管我认为使用中继器可能会更好，因为它将所有 html 代码保存在同一个地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T21:11:09.630

中继器摇滚。尤其是包含此类功能的用户控件的中继器。

无论如何，CommandArgument 技巧非常有效，尤其是当您只需要一个参数时。另一个技巧是将事物连接到单独的处理程序（而不是 ItemCommand 处理程序），然后使用发送方返回项目并获取其他数据。IE：

```
<asp:LinkButton CommandArgument="<%# (string)Container.DataItem %>" ID="lbFileDelete" runat="server" Text="delete" OnClick="DeleteFile" />
<asp:Hidden runat="server" id="FileId" value="<%# DataBinder.Eval(Container.DataItem, "ID") %> 
```

然后在代码隐藏中：

```
protected void DeleteFile(object sender, EventArgs e)
{
   LinkButton clicked = (LinkButton)sender;
   Control container = clicked.NamingContainer;
   int id = int.Parse(((Hidden)container.FindControl("FileId")).Value);
   //do stuff with the id, etc.
} 
```

在更复杂的场景中非常方便。坦率地说，在 ASP.NET 中，我从来没有发现很多东西不能用中继器和一点独创性来完成。

# air - 在 AIR 应用程序的 Badge 安装中强制安装位置

> ID：921692
> 
> 赞同：0
> 
> 时间：2009-05-28T16:01:40.567
> 
> 标签：air

通过徽章安装安装 AIR 应用程序时，有没有办法强制安装位置？我们不希望用户修改应用程序的安装位置。

问候，桑迪普

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-27T04:25:34.607

学会了艰难的方式 - 没有办法做到这一点！:(

# c++ - 如何加快 C++ 链接时间

> ID：921693
> 
> 赞同：18
> 
> 时间：2009-05-28T16:01:47.977
> 
> 标签：c++, linker, visual-c++

有什么办法可以优化 MS Visual Studio C++ (2005) 中的链接时间？我们使用 Xoreax Incredibuild 来加快编译速度，但没有链接。

目前每个链接大约需要 30 秒。当我打开增量链接时，大约需要 35-40 秒。（无论我是否使用 incredibuild 编译项目）

有什么办法，如何分析链接器并观察需要多长时间？或者任何并行链接的工具？或者任何代码优化技巧以加速链接器？

感谢您的回复卢德克伏迪加

* * *

编辑：

感谢您的第一次回复和其他信息：

*   整个程序优化和链接时代码生成已经关闭。
*   尽可能使用 PIMPL 成语
*   其他静态库已通过#pragma comment(lib, "pathToLib") 包含在内。（也因为更容易维护]
*   硬件：四核 q6600，8GB 内存，3x WD raptor raid 0。Windows Vista 64bit

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-28T16:15:48.197

我不知道有任何并行链接工具；我知道 Incredibuild 不允许这样做。

工具箱中用于避免链接时间的最大工具是适当的抽象级别。如果你的链接时间很长，可能是因为对象对其他对象了解太多。将它们解耦是关键——通过抽象接口（可能使用 PIMPL 范例），或者通过其他方法，例如事件传递。

通过 Project Dependencies 链接项目的开销也相当高。如果您的目标平台仅为 Win32 或主要是 Win32，您可以考虑使用标头通过 #pragma comment(lib, "pathToLib") 链接您的依赖库。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-28T16:08:12.550

如果您可以在没有优化的情况下生活，请关闭链接时间代码生成（删除 /GL 开关或在属性 c/c++ -> 优化 -> 整个程序优化。对于链接器删除 /ltcg 或使用链接时间代码生成设置）。这将使编译器变慢，因为现在代码生成发生在编译期间。

我已经看到使用 /GL+/LTCG 构建需要数小时的项目，而无需花费几秒钟（例如：[http ://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/750ed2b0-0d51 -48a3-bd9a-e8f4b544ded8](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/750ed2b0-0d51-48a3-bd9a-e8f4b544ded8) )

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T16:11:40.593

您是否考虑过改进硬件？
您是否使用单独的物理硬盘进行构建？您使用哪种驱动器？

作为一般建议：投入一些内存，获取[Velociraptor](http://www.wdc.com/en/products/Products.asp?DriveID=459)，仅将源和构建目录放在那里，再次测量。如果这有帮助，请考虑使用 RAID 0。

我听说从 XP 内核升级到 W2K3 内核显着改善了构建时间，这可能是由于更好的内存管理和缓存。

作为更改代码的建议，您可以将一些功能移动到 DLL，并并行链接。但我不会仅仅为了缩短构建时间而做出这样的改变。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-07T02:06:16.303

有一些关于[使用 IncrediBuild 改进链接时间的一般设置建议](http://xoreax.helpserve.com/index.php?/Knowledgebase/Article/View/16)

您还可以跳过静态库的链接，您不会使用[IncrediLink分发它们](http://www.xoreax.com/webhelp/pages/advanced_incredilink.htm)

我们发现添加签名后构建步骤会阻止 IncrediBuild 处理后续项目，在构建后添加评论应该会有所帮助

```
rem IncrediBuild_AllowOverlap 
```

请参阅[IncrediBuild_AllowOverlap 文档](http://www.xoreax.com/webhelp/pages/advanced_incredibuild_allowoverlap.htm)

# ruby-on-rails - 如何使用配置文件改进 rails helper 方法？

> ID：921694
> 
> 赞同：0
> 
> 时间：2009-05-28T16:01:50.160
> 
> 标签：ruby-on-rails, configuration, external, helper

我的 application_helper.rb 文件中有一个 rails 助手，如下所示：

```
def external_link(name)
    url = external_links[name]
    if url.blank?
        Rails.logger.error "No URL defined for external link [#{name}]!"
        return "[URL undefined]"
    end
    return url
end 
```

'external_links' 变量是一个应该来自外部文件的哈希值。该文件可以是简单的 ruby​​ 哈希或简单的 YML 配置。

也许我遗漏了一些东西——我认为我可以在外部文件中以 ruby​​ 语法定义哈希，并从 environment.rb 中“要求”它，但这不会在帮助程序中公开哈希变量。

如何将 ruby​​ 哈希外部化，使其在应用程序帮助方法中“在范围内”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T16:14:17.670

我使用[Application Config](http://code.google.com/p/application-config/)，它可以让我像这样设置 RAILS_ROOT/config/application_config.yml ：

```
 development: &defaults
    items_per_page: 25
    secure_with_basic_auth: false
    base_url: development.com
  test:
    <<: *defaults
    base_url: test.com
  production:
    <<: *defaults
    base_url: production.com 
```

然后像这样引用它们：

```
 class FooController < ApplicationController
    def index
      @base_url = property(:base_url)
    end
  end 
```

还有[AppConfig 插件](http://jarmark.org/projects/app-config/)，看起来更好，但我还没有尝试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T16:11:54.757

按照您的指示使用基本的 YML 文件，然后通过以下方式加载它：

```
config = YAML::load_file(RAILS_ROOT+'/config/external_urls.yml') 
```

然后您可以相应地通过“config”对象访问它。如果文件在请求之间没有更改，您可以缓存此文件加载以供以后使用（因此不会在每次使用时打开和解析），但这是一种性能优化，对于概念验证并不重要。

# jquery - 使用 jquery 从具有嵌套表的表中选择顶级列

> ID：921695
> 
> 赞同：1
> 
> 时间：2009-05-28T16:02:36.100
> 
> 标签：jquery

我有以下 html 结构（已生成且无法更改）：

```
<table id='tableID'>
<tbody>
    <tr>
        <td>
            <table>...</table>
        </td>
        <td>
            <table>...</table>
        </td>
        <td>
            <table>...</table>
        </td>
    </tr>
    <tr>
        <td>
            <table>...</table>
        </td>
        <td>
            <table>...</table>
        </td>
        <td>
            <table>...</table>
        </td>
    </tr>
    ....
</tbody>
</table> 
```

我要做的是获取所有外行，并为外行中的每一列操作内容。所以我有类似的东西：

```
var rows = $("#tableID > tbody > tr");
$.each(rows, function(n, row)
{
     var columns = row.children("td");
     if (columns.length > 0) {
          $.each(columns, function (i, column)
          {
               //do stuff
          });
     }
}); 
```

我遇到的问题是，当我得到孩子的 tds 时，它太贪婪了，并且也从嵌套表中抓取了 tds。有谁知道我可以如何限制这一点，以便我只从外部表的当前行获取 tds？或者有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T16:18:52.637

您可能会不必要地循环两次。如果想法是修改不属于嵌套表的每个单元格，那么这应该可行。

```
var cells = $("#tableID > tbody > tr > td");
$.each(cells, function(n, cell){     
   //do stuff          
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T16:22:26.810

```
var rows = $("#tableID > tbody > tr");
rows.each(function(n, row)
{
     $(row).children().each( // td implicit, since tr should only contain td
        function (i, column) {
           //do stuff
           // Note, if you don't need a reference to row inside the function,
           // you can loop directly over the tds by adding > td to the first
           // selector and skip the outer loop.
        });
     }
}); 
```

# linq - 在 Linq 选择语句中拆分字符串

> ID：921696
> 
> 赞同：1
> 
> 时间：2009-05-28T16:02:36.413
> 
> 标签：linq, linq-to-sql

我试图在 linq 查询中拆分字符串。我收到一条错误**消息“无法识别的表达式节点：ArrayIndex”**。有谁知道如何实现这一目标？我的代码示例是：

```
List<Task> Result= (from t in TaskDB.Tasks
                                       select new Task
                                       {
                                           Description = t.Description.Split('-')[0].ToString(),
                                           Id = ts.id,
                                       }).ToList(); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T16:13:16.033

问题是`select`您的查询部分无法转换为 SQL 以在服务器上执行（因此出现“无法识别的表达式节点”错误）。尝试这样的事情，它可以确保在客户端执行必要的代码：

```
var result = (from t in TaskDB.Tasks.AsEnumerable()
              select new Task
              {
                  Description = t.Description.Split('-')[0].ToString(),
                  Id = ts.id,
              }).ToList(); 
```

这里的技巧只是`AsEnumerable`在选择项目之前调用扩展方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:12:53.913

你真的需要在服务器端进行字符串拆分吗？除非你真的需要在查询中使用它，或者如果它只传输字符串的第一部分会节省大量带宽，我会在“LINQ to SQL”部分中获取它，然后对其进行后期处理使用 LINQ 到对象。像这样的东西：

```
List<Task> Result= TaskDB.Tasks.AsEnumerable() // Don't do the rest in SQL!
                               .Select(t => new Task
         {
              Description = t.Description.Split('-')[0].ToString(),
              Id = t.id,
         }).ToList(); 
```

（在列稍微多一点的 IDE 中格式化会更容易:)

# asp.net - ASP.NET 母版页 + pageLoad() = 杀死 jquery？

> ID：921697
> 
> 赞同：1
> 
> 时间：2009-05-28T16:02:44.010
> 
> 标签：asp.net, jquery, master-pages

在我的 MasterPage 中，我有一个 ScriptManager，它对我的​​ jquery.js 文件有一个 ScriptReference。这一直没有问题，所有使用 jquery 的内容页面都可以正常工作。

最近，我在 MasterPage 的末尾添加了以下 javascript 脚本块：

`function pageLoad(sender, args) {
}`

通过简单地添加上面的 pageLoad 方法，我的任何内容页面都不会执行任何 jquery 代码。为什么只在母版页中有一个 pageLoad 会产生这种效果？

提前感谢您的任何见解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T16:29:33.147

您可能会发现以下有关 pageLoad 的讨论很有帮助。

[http://encosia.com/2009/03/25/document-ready-and-pageload-are-not-the-same/](http://encosia.com/2009/03/25/document-ready-and-pageload-are-not-the-same/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:05:05.023

看起来在我的母版页中使用 Sys.Application.add_init()*而不是 document.ready() 或 pageLoad()*解决了我的问题。

关于我的问题的详细信息可能太长了，但如果我尝试至少简述正在发生的事情，它可能会对其他人有所帮助。

我的母版页有一个包含 ASP.NET TreeView 控件的“导航”内容模板。我想在回发后保留 TreeView 的滚动位置（其中有很多节点）。为此，我在 TreeView 控件周围的 div 的 onscroll 事件上附加了对以下 js 函数的调用：

```
function SetDivScrollPosition() {
var strCook = document.cookie;
if (strCook.length > 0) {
    var cookies = strCook.split(";");
    for (var i = 0; i < cookies.length; i++) {
        var mySplit = cookies[i].split("=");
            document.getElementById(mySplit[0].replace(" ", "")).scrollTop = mySplit[1];
    }
} 
```

}

但是，我在其他内容页面中也有其他可滚动的 div，我还想在回发（全部或部分）之后跟踪这些可滚动位置。所以，我要做的就是从这些内容页面的 document.ready() 函数中调用 SetDivScrollPosition()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-21T23:49:22.247

您的页面（或包含的 .js 文件）的呈现版本是否可能已经定义了 pageLoad 方法？如果是这种情况，那么您的页面可能已经定义了两次 pageLoad，这将导致您描述的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T16:04:55.643

为什么你不能只使用：

```
$(document).ready(function() {
   // do that funky thing
} 
```

# ms-access - 如何密码保护复选框？

> ID：921710
> 
> 赞同：2
> 
> 时间：2009-05-28T16:06:03.177
> 
> 标签：ms-access, vba, checkbox

我对 access 2003 中的复选框有疑问

我的表单上有 4 个复选框和其中一个框，我想限制，因此只有提供正确密码的用户（例如（report1））才能选中该框。我在标有管理员密码的复选框旁边有一个小文本框。

我不确定如何在访问中设置此验证。我右键单击复选框，转到属性并查看验证规则，但不确定从那里去哪里。如果适用，我知道我的 VB 代码将是什么，如果有帮助，我会包括在内

代码片段 If txtpassword.text = "report1" then closedsftleader.yes = true else msgbox.show "管理密码不正确，请重试"

万一

甚至不确定这段代码是否可行，但它是一个想法。请尽可能提供帮助。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T19:54:28.443

您是否考虑过锁定或禁用此特定复选框？例如：

```
Private Sub Form_Current()
    Me.closedsftleader.Enabled = (Me.txtpassword = "Report1")
End Sub

Private Sub txtpassword_AfterUpdate()
    Me.closedsftleader.Enabled = (Me.txtpassword = "Report1")
End Sub 
```

像这样禁用对于您的用户来说很容易理解，而不是似乎无法单击的复选框，此外，将其更改为引用全局变量或用户名也很容易。

我一般为控件设置标签属性，允许我根据用户和/或密码批量隐藏或启用控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T16:09:14.230

您想在文本框上添加一个事件（我相信它是“更改”事件），然后根据文本框的内容启用/禁用文本框。

附带说明一下，这是一种用于保护表单内容的奇怪设计。您可能需要考虑强制用户登录您的 Access 应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T16:09:32.610

如果文本框没有正确的密码，您可以处理复选框的 OnClick 事件并且不允许更改。

# javascript - Ajax.request 抛出语法错误，但返回正确的值

> ID：921711
> 
> 赞同：0
> 
> 时间：2009-05-28T16:06:25.517
> 
> 标签：javascript, ajax, syntax, prototypejs

我有一堆执行得很好的 Ajax 请求，但最终在我的浏览器中出现语法错误。

任何人都可以在下面看到我的请求有什么问题吗？

```
function getName(refId)
{
    var resp = '';
    new Ajax.Request('/servlet/GetName',
    {
        method:'post',
        parameters: {'requestType':'ref',
                 'value':refId},
        onSuccess:function(transport)
        {
            setName((String(transport.responseText)).trim());
        }
    });
} 
```

编辑：这似乎也只在第一次被调用时抛出错误。如果我清除控制台，我不会继续收到错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T19:09:51.267

我在 Firefox 中使用 xmlhttprequest 查询非 xml 时也遇到了语法错误。Firefox 尝试将响应解析为 xml，并记录错误，但仍然可以正常工作。

就我而言，我将其添加到服务器端的 php 中：
header('Content-Type: text/plain');

有人在这里报告了客户端修复：
[jQuery .getJSON Firefox 3 Syntax Error Undefined](https://stackoverflow.com/questions/335409/jquery-getjson-firefox-3-syntax-error-undefined)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T12:07:36.170

根据[W3Schools](http://www.w3schools.com/HTMLDOM/dom_obj_window.asp)的说法，window 对象中没有根属性。也许如果你使用

```
new Ajax.Request(document.domain + '/servlet/GetName', ... 
```

它会更好地工作。

编辑，啊-我应该学会阅读。它确实有效，但会引发语法错误。语法错误！= 没有实现的属性...对不起！但无论如何我都会让我的帖子留下来。;)

# xcode - 当我开始“构建和调试”时如何将命令行开关传递给 XCode

> ID：921718
> 
> 赞同：0
> 
> 时间：2009-05-28T16:08:04.733
> 
> 标签：xcode, macos

我有一个 XCode 项目，我可以用它“构建和调试”。但是，当我“构建和调试”时，如何传递“命令行开关”以便 XCode 使用该命令行开关调用？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T16:13:45.563

在可执行文件组中，您可以获取可执行文件的信息，并在参数选项卡中设置参数和环境变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T16:09:55.853

如果您想将额外的编译器标志传递给编译器，请打开您的项目设置，找到名为**Other C Flags**的设置，然后添加所需的编译器开关。

# ruby-on-rails - has_many 在另一边是否需要 belongs_to？

> ID：921723
> 
> 赞同：8
> 
> 时间：2009-05-28T16:08:16.777
> 
> 标签：ruby-on-rails, associations

如果`Parent has_many :children`，**必须** `Child :belongs_to :parent`？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-28T16:09:22.080

不，`belongs_to`没有必要。这意味着您将无法从两个方向查询关联，但如果这不是您的应用程序的要求，则没有必要。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-28T16:16:11.567

正如科迪所说，这不是强制性的 - 但将是 90% 的情况。

[有关ActiveRecord 关联，](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)请参阅Rails API 文档。当您指定`has_many`或`belongs_to`时，一堆（辅助）方法将添加到您的 Rails 模型类中。上面的页面显示了以表格格式自动添加的特定方法。因此，如果您只指定关联的一端，例如 Child，您将只能使用 Child 模型中的那些相应方法。

# .net - 如何强制围绕复选框而不是复选框控件上的文本绘制焦点轮廓？

> ID：921739
> 
> 赞同：1
> 
> 时间：2009-05-28T16:10:00.890
> 
> 标签：.net, winforms

通常，在窗体上的控件中切换时，当焦点设置为 CheckBox 控件时，文本会被勾勒以显示焦点。

我正在使用没有文本的 CheckBox（因此只显示该框）。如何强制在框而不是文本周围绘制焦点轮廓？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T16:36:22.587

看看 - 只是给你一个想法：

```
public class MyCheckBox : CheckBox
{
  public MyCheckBox()
  {
    // AutoSize is virtual - so you should not call it here, just demo
    AutoSize = false;
    // You need padding to make the base.OnPaint() method leaving you some space
    Padding = new Padding( 2, 2, 0, 0 );
    Size = new Size( 17, 16 );
  }

  protected override void OnPaint( PaintEventArgs pevent )
  {
    base.OnPaint( pevent );
    if( !Focused )
    {
      return;
    }
    using( var pen = new Pen( Color.Black ) )
    {
      pen.DashStyle = DashStyle.Dot;
      pevent.Graphics.DrawRectangle( pen, new Rectangle( 0, 0, 16, 15 ) );
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T16:15:10.383

我认为您必须派生自己的“无文本复选框”才能正确识别控件的边界。

听起来可能很复杂，但应该不会太难，我想。在学习 .NET 1.x 时，我创建了一些花哨的复选框，但我不记得关心焦点矩形。

# windows - Windows 等同于 UNIX pwd

> ID：921741
> 
> 赞同：445
> 
> 时间：2009-05-28T16:11:11.967
> 
> 标签：windows, cmd, pwd

如何在命令提示符下找到 Windows 上的本地路径？

* * *

## 回答 #1

> 赞同：551
> 
> 时间：2009-05-28T16:13:36.127

这将在控制台中打印它：

```
echo %cd% 
```

或将此命令粘贴到 CMD 中，然后您将拥有`pwd`：

```
(echo @echo off
echo echo ^%cd^%) > C:\WINDOWS\pwd.bat 
```

* * *

## 回答 #2

> 赞同：152
> 
> 时间：2009-05-28T16:12:19.903

它`cd`用于“当前目录”。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2011-01-08T13:32:40.713

以管理员身份打开记事本并写入：

```
@echo %cd% 
```

将其保存在c:\windows\system32\ 中，名称为“pwd.cmd”（注意不要保存pwd.cmd.txt）

然后你有 pwd 命令。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2014-12-11T15:13:14.680

```
cd , 
```

它将给出当前目录

```
D:\Folder\subFolder>cd ,
D:\Folder\subFolder 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2016-04-26T23:47:49.233

`cd`没有任何参数相当于`pwd`在 Unix/Linux 上。

从输入的控制台输出`cd /?`：

```
Displays the name of or changes the current directory.

[...]

Type CD without parameters to display the current drive and directory. 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-05-11T02:41:17.353

在 PowerShell`pwd`中是一个别名，[`Get-Location`](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-location?view=powershell-6)因此您可以`pwd`像在 bash 中一样简单地在其中运行

也可以像这样从 cmd 调用它，`powershell -Command pwd`尽管`cd`或者`echo %cd%`在 cmd 中可以正常工作

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T16:17:03.203

嗯 - pwd 在 Vista 上为我工作......

最终**编辑**：它适用于 Vista，因为 WinAvr 安装了 pwd.exe 并将 \Program Files\WinAvr\Utils\bin 添加到我的路径中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-31T13:40:59.727

```
C:\Documents and Settings\Scripter>echo %cd%
C:\Documents and Settings\Scripter

C:\Documents and Settings\Scripter> 
```

对于 Unix 使用`pwd`命令

[当前工作目录](http://scripterworld.blogspot.com/2009/08/unix-pwd-command-tells-you-where-you.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-03-02T10:16:19.297

你可以输入

```
cd 
```

它将返回您当前的路径。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-05-28T17:53:59.543

使用以下命令

```
dir | find "Directory" 
```

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2016-03-11T23:48:21.453

你可以简单地把“。” 点符号。我有一个需要路径的 cmd 应用程序，并且我已经在所需的目录中，并且我使用了点符号。

希望能帮助到你。

# oop - 教老狗新把戏

> ID：921757
> 
> 赞同：4
> 
> 时间：2009-05-28T16:12:56.923
> 
> 标签：oop, procedural

我有一位出色的经理，他当时是一名程序编码向导。他现在面临着管理一个在 .Net 和 Java 中都使用面向对象编程的团队。他很难理解我们讨论的许多模式和术语。我想知道 SO 成员在帮助他人完成这种过渡方面有什么经验。

我也在寻找很棒的程序 -> OOP 代码示例，这些示例可以向他展示如何将程序代码重写为 OOP。我向他提供了相反的情况，这意味着我采用了 OO 代码并将其转化为程序性代码，但我正在寻找其他人可能使用过的代码示例，这些示例被发现对学习有效。

最后，人们可以推荐任何为正在经历这种转变的人而写的书，我们将不胜感激。

我不确定这是否构成社区维基。如果是这样我可以改变它。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T16:19:17.567

Martin Fowler 的《[重构](http://books.google.com/books?id=1MsETFPD3I0C&dq=martin+fowler+refactoring&printsec=frontcover&source=bn&hl=en&ei=77geSpi1Lp36tgPC-cmMCQ&sa=X&oi=book_result&ct=result&resnum=5)》一书全是关于如何采用过程代码并将其重构为更加面向对象的小步骤、可管理的步骤。我发现它对您描述的那种事情非常有用。如果我没记错的话，这些示例都是用 Java 编写的，但很容易应用于其他环境。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:21:40.353

我一直不明白为什么人们谈论 OOP 或程序，就好像它们是相互排斥的。我的意思是，在 OOP 中你有你的类等，但类方法通常是程序化的。它们只是花哨的函数调用。我使用 C/Pascal 多年，其中大部分内容仍然适用于 OOP 语言。任何介绍 Java 或 .NET 的书都会有足够的示例来帮助他快速掌握基本的 OOP 术语。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T16:25:59.847

我最好的经历是参与讨论代码。假设您有代码审查或设计会议，这些设置可能是最能说明问题的地方。

（假设您正在做出色的 OO 设计，而不仅仅是将过程代码包装到命名空间类中。但是 Fowler 的“重构”书将为您很好地诊断。）

注意：不一定是CW，恕我直言。

# database-design - 条件动作的数据库设计

> ID：921766
> 
> 赞同：2
> 
> 时间：2009-05-28T16:13:54.923
> 
> 标签：database-design, scripting, conditional

我正在开发一个向导类型的应用程序，以允许用户构建简单的“脚本”，这些脚本基本上可以根据特定条件执行操作。他们构建的脚本将存储在数据库中，并且修改将很常见，因此某种只进文本生成不是一种选择。我的程序将此内部数据库结构转换为我需要的实际脚本输出，因此只要他们修改脚本，我就会重新生成输出。

我正在寻找一些关于能够存储这些信息的良好数据库结构的建议。我目前有一个工作，但我只是好奇我是否错过了任何可以使它更清晰的明显内容。任何建议表示赞赏。

为了提供更多细节，下面是用户可以通过在 GUI 中选择条件和操作创建的“脚本”类型的通用示例：

```
if ($variableA == 100 && $variableB > 25 && $variableC < 10)
{
    performAction();
    performAnotherAction();
    if ($variableC == 0)
    {
        performYetAnotherAction();
    }
    else if ($variableC == 1 || $variableC == 2)
    {
        performEvenMoreActions();
    }
}
else
{
    performDefaultAction();
} 
```

关于什么是可能的和不可能的一些注释，只是为了清楚：

*   “if”条件句可以附加任意数量的“else if”条件句，以及可选的“else”。
*   每个条件可以有任意数量的“测试”（`$variableA == 100`等），但是每个测试都可以被认为是表示为`(<variable>,<operator>,<test value>)`，无需担心更复杂的条件。
*   即使每个条件可以有任意数量的测试，它们总是会被同一个布尔运算符连接起来。也就是说，如果条件中有多个测试，它们要么总是由 连接`&&`，要么总是由 连接`||`，没有混合。
*   条件可以无限嵌套，因此需要某种层次结构。
*   在条件句中可能有任意数量的动作，它们必须按照它们定义的顺序执行。动作可以简单地表示为函数名称，无需担心任何其他“动作类型”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T16:31:36.683

每当我不得不存储/操作“类似代码”的东西时，我总是会走上 XML 路线。

主要原因是在层次结构中表达然后计算类似 (a and b and (c or (d and e))) 的东西要容易得多。

在您的示例中，嵌套是条件句，例如。（很粗略，仅供参考）

```
<if>
    <expression />
    <true>
        <action />
    </true>
    <false>
        <if>
            <expression />
            <true>
                <action />
            </true>
        </if>
    </false>
</if> 
```

如果您使用的是 SQL2005+，它具有 HierarchyId 数据类型，您可以使用它而不是 XML 格式来维护层次结构，它对于获取与节点相关的所有数据等更有用。

注意：这绝不是一个完整的答案，甚至不是部分答案，只是抛出一些经验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T16:33:06.320

您没有描述使用 SQL 获取或搜索脚本片段的任何要求，因此无需分解脚本。

所以我不会尝试将脚本巧妙地存储在数据库中。相反，只需将整个脚本存储在文本 BLOB 中，并将脚本视为一个相对于其存储的单个原子值。

您对脚本所做的任何操作都将在您的应用程序中完成，因此您需要一个解析器。所以选择一个易于解析的简单语法。我建议使用 Python、XML 或您自己的领域特定语言。

FWIW，我在数据库和解析器方面都有丰富的经验。就您描述的项目而言，这不是一项非常艰巨的任务，只是完全没有必要。

底线：代码就是代码，数据就是数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T16:46:38.867

您可以使用对其父节点的引用来表示每个节点，然后加入父节点以使子节点退出。这是在关系数据库中表示层次结构的标准方法。

或者，如果每个规则都是离散的，您可以用文本或 XML 格式表示它，并将规则存储在一个 blob 中。如果您正在处理大量这些规则，您可能需要考虑使用现成的基于 Rete-derivative 的规则引擎，例如 Ilog。

# c# - Form_Load 事件未在从另一个表单类继承的表单上触发

> ID：921770
> 
> 赞同：2
> 
> 时间：2009-05-28T16:14:53.003
> 
> 标签：c#, winforms

我有一个从另一个表单继承的 winforms 表单。

例如

```
class StartForm : aSyncDialog 
```

aSyncDialog 有一个 onload 事件

```
protected override void OnLoad(EventArgs e) 
```

我注意到 StartForm 中的加载事件没有触发，但 OnLoad 事件触发了。

```
private void StartForm_Load(object sender, EventArgs e) 
```

知道为什么吗？我需要在父类或子类中添加一些东西以使其运行吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T16:18:34.040

确保从 aSyncDialog 中的 OnLoad 覆盖中调用 base.OnLoad(e)

原因是 Form 类中的 OnLoad 方法引发了 Load 事件。

当您在 aSyncDialog 中重写 OnLoad 方法并且不调用 base.OnLoad 时，不会引发事件，因此 aSyncDialog 的子类没有要处理的任何事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:27:08.440

在 System.Windows.Form 类中，方法 OnLoad 实际调用了与 Load 事件相关联的所有事件处理程序。由于您正在覆盖 OnLoad 的实现，因此永远不会调用事件处理程序（在您的情况下为 StartForm_Load）。

要使其正常工作，您需要按照 Patrick 的建议调用 Base.OnLoad。作为实践，您应该在覆盖时始终调用基方法，除非您知道您明确不希望基方法运行。

# wpf - 什么时候放弃 MVVM 才有意义？

> ID：921775
> 
> 赞同：5
> 
> 时间：2009-05-28T16:16:07.963
> 
> 标签：wpf, mvvm

在学习 WPF 时，我一直专注于仅将**MVVM 模式**应用于应用程序。

但是，我注意到**对于某些功能[，例如验证](https://stackoverflow.com/questions/921601/how-can-i-handle-a-validation-error-in-my-viewmodel-instead-of-my-views-code-beh)**，很难或不可能保持对 MVVM 模型的真实性。很多时候，只需将**x:Name**粘贴在元素上并在**代码隐藏事件处理程序**中更改它即可立即解决问题。

**您在放弃 MVVM 模式**方面有哪些实际经验？

*   什么时候放弃 MVVM 才有意义？例如，您是否制定了规则，如果应用程序具有一定的复杂性，您将使用它，否则您不会？
*   什么时候放弃 MVVM**以后会削弱你**（例如，我可以想象如果你想升级你的应用程序以使用复合应用程序库，如果你在代码中包含所有逻辑，那么注入 ViewModels 和容器的整个概念将不起作用
*   什么时候放弃 MVVM**无关紧要**，例如，我可以想象你不想/不需要测试的代码可以在后面的代码中，而你的基本结构仍然是 MVVM 并通过模拟测试等运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T17:59:38.080

如果仅与视图相关，我认为代码隐藏很好。它不会破坏 MVVM，因为重要的是层的分离。如果您的虚拟机不知道视图，那么我认为您使用 XAML 或代码并不重要。您尝试最小化代码隐藏，因为它通常在 XAML 中更简洁且更易于执行，但有时几行代码比很多 XAML 更简洁。例如，绑定键盘的所有键。您可以在 XAML 或 5 行代码中键入 101 个键绑定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T19:29:30.630

在 MVVM 之后，我还没有遇到任何不可能做的事情。有些事情是困难的，是的，但是一旦找到解决方案，困难就消失了。每当您遇到困难的事情时，请记住您在这种模式中的两个“大炮”：附加行为和服务。将这两个概念牢牢地控制在您的控制之下，您可以使用代码隐藏做任何事情，而您不能以更干净、对 MVVM 友好的方式来做。这里棘手的部分只是找到最好的、最可重用的设计……但这在任何代码中都是正确的。

什么时候放弃 MVVM 才有意义？这取决于你对放弃的定义，但简单的答案是**从不**。如果您遇到了一个特定问题并且没有时间找到一个干净的解决方案，那么务实的做法是放弃该**问题区域**的模式，而不是完全按照您的复杂性示例所暗示的那样。

什么时候放弃 MVVM 会削弱你？当您必须维护应用程序时。

什么时候放弃 MVVM 无关紧要？演示/示例程序、丢弃/简单实用程序等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T16:34:07.597

我没有放弃 MVVM 模式，因为我从未完全应用它！

由于历史背景，我公司仍然使用 C 原生库，封装在托管库中，用于 C# 和 WPF 程序。无法使用绑定，并且无法实现 INotifyPropertyChanged 等某些行为，因为更改是在某些深度 C 方法中完成的……如此深度的重构不是一种选择！

所以一方面，我知道严格遵循 MVVM 可能会很痛苦。

另一方面，恕我直言，我认为 MVVM 是 WPF 的一个很好的模式，应该尽可能多地使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-21T00:30:36.733

MVVM 只是一个建议。如果你不喜欢，你不必使用它。它声称的许多优势仍然需要证明。但是你总是可以从中借鉴一些好的想法。

# c# - 如何通过代理服务器将 Winform 连接到 Internet

> ID：921778
> 
> 赞同：2
> 
> 时间：2009-05-28T16:16:22.220
> 
> 标签：c#, winforms, .net-2.0, proxy

我正在用 C# 和 .Net 2.0 编写一个使用 Web 服务的桌面应用程序，并且我正在为应用程序位于代理服务器后面的情况做准备，就像[这个问题中的示例](https://stackoverflow.com/questions/127241/net-client-app-how-to-reach-web-services-in-case-of-proxy)一样。

这是一个好主意，将以相同的方式设置我的 app.config，但现在我想通过提供用户名和密码来测试连接。我拥有的代理服务器仅用于测试，并不会真正阻止我连接到互联网。

我意识到像 Netbeans 或 Visual Studio 这样的应用程序（仅举几例）通过在其选项或偏好表单中提供整个部分来认真对待代理内容，我也想做同样的事情。我还在读到通过 socks4 或 socks5 实现连接有点困难。那么你能分享一下你对此的了解吗？

谢谢阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T01:32:39.283

**通过代理服务器连接到 Web 服务**
[http://www.codeproject.com/KB/webservices/web_service_by_proxy.aspx](http://www.codeproject.com/KB/webservices/web_service_by_proxy.aspx)

示例代码：

```
' Search button: do a search, display number of results 
Private Sub btnSearch_Click(ByVal sender As System.Object, _
  ByVal e As System.EventArgs) Handles btnSearch.Click 

' Create a Google Search object 
Dim s As New Google.GoogleSearchService 

Try 

' google params 
Dim strLicenceseKey As String = "google license key" ' google license key 
Dim strSearchTerm As String = "Bruno Capuano" ' google license key 

' proxy settings 
Dim cr As New System.Net.NetworkCredential("user", "pwd", "MyDomain") 
Dim pr As New System.Net.WebProxy("127.0.1.2", 80) 

pr.Credentials = cr 
s.Proxy = pr 

' google search
Dim r As Google.GoogleSearchResult = s.doGoogleSearch(strLicenceseKey, _
  strSearchTerm, 0, 10, True, "", False, "", "", "")
' Extract the estimated number of results for the search and display it
Dim estResults As Integer = r.estimatedTotalResultsCount 

MsgBox(CStr(estResults))

Catch ex As System.Web.Services.Protocols.SoapException

MsgBox(ex.Message)

End Try

End Sub 
```

# php - 如何在 MAMP 上安装 ImageMagick？

> ID：921780
> 
> 赞同：3
> 
> 时间：2009-05-28T16:16:43.810
> 
> 标签：php, imagemagick, mamp, imagick

我正在使用 MAMP（由 Apache/MySQL/PHP 组成的沙箱）运行 OSX Leopard。我按照本教程使用 MacPorts 安装了 ImageMagick： [http ://www.brybot.ca/archives/getting-imagemagick-and-more-to-work-with-mamp-on-os-x/](http://www.brybot.ca/archives/getting-imagemagick-and-more-to-work-with-mamp-on-os-x/)

然后我将 extension=imagick.so 添加到 php.ini 但 PHP 无法识别它。它不断告诉我：

```
Fatal error: Class 'imagick' not found 
```

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2018-08-22T10:11:24.297

这个问题很老，但我今天遇到了问题，它似乎比以前更容易。
此解决方案使用带有 MAMP 4 和[Homebrew](https://brew.sh/)的 OSX 10.13 。

*   通过运行安装 Image Magick `brew install imagemagick`。
*   打开文件`/Applications/MAMP/bin/php/[yourPhpVersionThere]/conf/php.ini`。
*   搜索该行`;extension=imagick.so`，并删除';' 在行的开头。
*   重启 MAMP

你完成了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T11:53:29.347

注意：*Imagemagick*和*Imagick*不**一样**！虽然 Imagemagick 是一个用于操作图像的 CLI 套件/lib，[但 Imagick](http://pecl.php.net/package/imagick)是一个 PHP Wrapper 类，可以在 PHP 中原生使用 Imagemagick（读作不使用 exec() 或类似方法......）。

关于安装 Imagemagick 和 Imagick@OSX 的恕我直言的好指南就是[这个](http://www.adamstacey.co.uk/2010/06/28/installing-image-magick-and-imagick-for-php-for-mamp/)。

*更新*

试试这个指南：[Imagick for MAMP-Pro 安装指南](https://github.com/jdlx/install_Imagick_on_MAMP/wiki/Imagick-for-MAMP-Pro---installation-guide) （这是我稍微更详细的分支：[Mamp-Imagick-Manual](https://github.com/0xPr0xy/Mamp-Imagick-Manual)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T16:24:12.673

您可能需要按照 macports 安装说明将 /opt/local 和 /opt/local/bin 添加到 PATH 变量中。

如果您已经这样做了，那么找出 MacPorts 将 imagemagic 库放在哪里并将其复制到您的 PHP 安装的扩展目录（或创建从扩展目录到文件的链接）。

默认情况下，MacPorts 将编译和安装东西以与其他 MacPorts 库一起使用，因此在编译以使用非 MacPorts 库时，您可能需要移动文件并稍微调整路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T16:23:28.743

（大小写 php 区分大小写吗？如果我[用谷歌搜索一下](http://www.google.be/search?q=imagick+php)，它`Imagick`是大写的 i。）下载 image-magick 就足够了吗？[如果我](http://pecl.php.net/package/imagick)没看错，你还需要一个用于 image-magick 的 php 包装器。

# javascript - 如何以对象为成员循环遍历纯 JavaScript 对象

> ID：921789
> 
> 赞同：1739
> 
> 时间：2009-05-28T16:18:14.620
> 
> 标签：javascript, loops

如何遍历 JavaScript 对象中的所有成员，包括作为对象的值？

例如，我怎样才能遍历这个（访问每个“your_name”和“your_message”）？

```
var validation_messages = {
    "key_1": {
        "your_name": "jimmy",
        "your_msg": "hello world"
    },
    "key_2": {
        "your_name": "billy",
        "your_msg": "foo equals bar"
    }
} 
```

* * *

## 回答 #1

> 赞同：2215
> 
> 时间：2009-05-28T16:20:58.153

```
for (var key in validation_messages) {
    // skip loop if the property is from prototype
    if (!validation_messages.hasOwnProperty(key)) continue;

    var obj = validation_messages[key];
    for (var prop in obj) {
        // skip loop if the property is from prototype
        if (!obj.hasOwnProperty(prop)) continue;

        // your code
        alert(prop + " = " + obj[prop]);
    }
} 
```

* * *

## 回答 #2

> 赞同：866
> 
> 时间：2011-04-20T22:04:46.220

在 ECMAScript 5 下，您可以组合`Object.keys()`和`Array.prototype.forEach()`：

```
var obj = {
  first: "John",
  last: "Doe"
};

//
//	Visit non-inherited enumerable keys
//
Object.keys(obj).forEach(function(key) {

  console.log(key, obj[key]);

});
```

* * *

## 回答 #3

> 赞同：412
> 
> 时间：2017-01-09T14:22:42.237

在**ES6/2015**中，您可以循环访问这样的对象（使用[箭头函数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions)）：

```
Object.keys(myObj).forEach(key => {
  console.log(key);        // the name of the current key.
  console.log(myObj[key]); // the value of the current key.
}); 
```

[JS斌](https://jsbin.com/feribofaqa/edit?html,js,console,output)

在**ES7/2016**中，您可以使用[`Object.entries`](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/entries)而不是`Object.keys`循环访问这样的对象：

```
Object.entries(myObj).forEach(([key, val]) => {
  console.log(key); // the name of the current key.
  console.log(val); // the value of the current key.
}); 
```

以上也可以作为**单线**：

```
Object.entries(myObj).forEach(([key, val]) => console.log(key, val)); 
```

[jsbin](https://jsbin.com/tokotusuze/1/edit?html,js,console,output)

如果您还想遍历嵌套对象，可以使用**递归**函数 (ES6)：

```
const loopNestedObj = obj => {
  Object.keys(obj).forEach(key => {
    if (obj[key] && typeof obj[key] === "object") loopNestedObj(obj[key]); // recurse.
    else console.log(key, obj[key]); // or do something with key and val.
  });
}; 
```

[JS斌](https://jsbin.com/ruravuhelu/edit?html,js,console,output)

与上面的函数相同，但使用**ES7** `Object.entries()`而不是`Object.keys()`：

```
const loopNestedObj = obj => {
  Object.entries(obj).forEach(([key, val]) => {
    if (val && typeof val === "object") loopNestedObj(val); // recurse.
    else console.log(key, val); // or do something with key and val.
  });
}; 
```

`Object.entries()`在这里，我们循环遍历嵌套对象更改值并使用结合[`Object.fromEntries()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/fromEntries)（**ES10/2019** ）一次性返回一个新对象：

```
const loopNestedObj = obj =>
  Object.fromEntries(
    Object.entries(obj).map(([key, val]) => {
      if (val && typeof val === "object") [key, loopNestedObj(val)]; // recurse
      else [key, updateMyVal(val)]; // or do something with key and val.
    })
  ); 
```

另一种循环对象的方法是使用 **for ... in**和**for ... of**。请参阅[vdegenne 写得很好的答案](https://stackoverflow.com/a/46386334/1612318)。

* * *

## 回答 #4

> 赞同：394
> 
> 时间：2010-05-19T20:58:52.660

这个问题

```
for (var key in validation_messages) {
   var obj = validation_messages[key];
   for (var prop in obj) {
      alert(prop + " = " + obj[prop]);
   }
} 
```

是您还将循环遍历原始对象的原型。

有了这个，您将避免它：

```
for (var key in validation_messages) {
   if (validation_messages.hasOwnProperty(key)) {
      var obj = validation_messages[key];
      for (var prop in obj) {
         if (obj.hasOwnProperty(prop)) {
            alert(prop + " = " + obj[prop]);
         }
      }
   }
} 
```

* * *

## 回答 #5

> 赞同：101
> 
> 时间：2012-09-16T12:11:21.690

使用[Underscore.js 的`_.each`](http://underscorejs.org/#each)：

```
_.each(validation_messages, function(value, key){
    _.each(value, function(value, key){
        console.log(value);
    });
}); 
```

* * *

## 回答 #6

> 赞同：60
> 
> 时间：2009-05-28T18:03:06.250

如果你使用递归，你可以返回任何深度的对象属性——

```
function lookdeep(object){
    var collection= [], index= 0, next, item;
    for(item in object){
        if(object.hasOwnProperty(item)){
            next= object[item];
            if(typeof next== 'object' && next!= null){
                collection[index++]= item +
                ':{ '+ lookdeep(next).join(', ')+'}';
            }
            else collection[index++]= [item+':'+String(next)];
        }
    }
    return collection;
}

//example

var O={
    a:1, b:2, c:{
        c1:3, c2:4, c3:{
            t:true, f:false
        }
    },
    d:11
};
var lookdeepSample= 'O={'+ lookdeep(O).join(',\n')+'}';

/*  returned value: (String)
O={
    a:1, 
    b:2, 
    c:{
        c1:3, c2:4, c3:{
            t:true, f:false
        }
    },
    d:11
}

*/ 
```

* * *

## 回答 #7

> 赞同：57
> 
> 时间：2017-09-24T03:34:18.803

> 这个答案是这篇文章中提供的解决方案的集合，并带有一些[性能反馈](https://jsperf.com/es7-and-misc-loops)。我认为有两个用例，OP 没有提到他是否需要访问密钥才能在循环过程中使用它们。

## **一、需要访问的密钥**

**✔`of`和`Object.keys`方法**

```
let k;
for (k of Object.keys(obj)) {

    /*        k : key
     *   obj[k] : value
     */
} 
```

**✔`in`方法**

```
let k;
for (k in obj) {

    /*        k : key
     *   obj[k] : value
     */
} 
```

*谨慎使用这个，因为它可以打印原型的属性`obj`*

**✔ ES7 方法**

```
for (const [key, value] of Object.entries(obj)) {

} 
```

*但是，在编辑时我不推荐 ES7 方法，因为 JavaScript 在内部初始化了很多变量来构建这个过程（参见反馈以获得证明）。除非你不是在开发一个值得优化的大型应用程序，否则没关系，但如果优化是你的首要任务，你应该考虑一下。*

## **二、我们只需要访问每个值**

**✔`of`和`Object.values`方法**

```
let v;
for (v of Object.values(obj)) {

} 
```

* * *

## 关于测试的更多反馈：

*   缓存`Object.keys`或`Object.values`性能可以忽略不计

例如，

```
const keys = Object.keys(obj);
let i;
for (i of keys) {
  //
}
// same as
for (i of Object.keys(obj)) {
  //
} 
```

*   例如`Object.values`，在 Firefox 中使用带有缓存变量的本机`for`循环似乎比使用`for...of`循环快一点。但是，区别并不那么重要，Chrome 的运行`for...of`速度比原生`for`循环快，所以我建议`for...of`在处理`Object.values`任何情况（第 4 次和第 6 次测试）时使用。

*   在 Firefox 中，`for...in`循环非常慢，所以当我们想在迭代期间缓存键时，最好使用`Object.keys`. 另外，Chrome 以相同的速度运行这两种结构（第一次和最后一次测试）。

您可以在此处查看测试：[https ://jsperf.com/es7-and-misc-loops](https://jsperf.com/es7-and-misc-loops)

* * *

## 回答 #8

> 赞同：34
> 
> 时间：2009-05-28T16:20:56.063

```
for(var k in validation_messages) {
    var o = validation_messages[k];
    do_something_with(o.your_name);
    do_something_else_with(o.your_msg);
} 
```

* * *

## 回答 #9

> 赞同：33
> 
> 时间：2012-09-05T06:17:28.187

AgileJon 答案的优化和改进版本：

```
var key, obj, prop, owns = Object.prototype.hasOwnProperty;

for (key in validation_messages ) {

    if (owns.call(validation_messages, key)) {

        obj = validation_messages[key];

        for (prop in obj ) {

            // Using obj.hasOwnProperty might cause you headache if there is
            // obj.hasOwnProperty = function(){return false;}
            // but 'owns' will always work
            if (owns.call(obj, prop)) {
                console.log(prop, "=", obj[prop]);
            }
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2018-07-03T11:37:56.737

p 是值

```
for (var key in p) {
  alert(key + ' => ' + p[key]);
} 
```

或者

```
Object.keys(p).forEach(key => { console.log(key, p[key]) }) 
```

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2017-08-07T13:22:54.210

在 ES7 中，你可以这样做：

```
for (const [key, value] of Object.entries(obj)) {
  //
} 
```

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2009-05-28T16:21:10.870

```
for(var key in validation_messages){
    for(var subkey in validation_messages[key]){
        //code here
        //subkey being value, key being 'yourname' / 'yourmsg'
    }
} 
```

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2019-01-21T12:33:46.473

有几种方法可以做到这一点...

**1)**两层 for...in 循环...

```
for (let key in validation_messages) {
   const vmKeys = validation_messages[key];
   for (let vmKey in vmKeys) {
      console.log(vmKey + vmKeys[vmKey]);
   }
} 
```

**2)**使用`Object.key`

```
Object.keys(validation_messages).forEach(key => {
   const vmKeys = validation_messages[key];
   Object.keys(vmKeys).forEach(key => {
    console.log(vmKeys + vmKeys[key]);
   });
}); 
```

**3)**递归函数

```
const recursiveObj = obj => {
  for(let key in obj){
    if(!obj.hasOwnProperty(key)) continue;

    if(typeof obj[key] !== 'object'){
      console.log(key + obj[key]);
    } else {
      recursiveObj(obj[key]);
    }
  }
} 
```

并称它为：

```
recursiveObj(validation_messages); 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2016-11-24T19:43:29.497

另外一个选项：

```
var testObj = {test: true, test1: false};
for(let x of Object.keys(testObj)){
    console.log(x);
} 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2016-02-23T20:57:18.437

这是 AgileJon 解决方案的改进和递归版本（[演示](https://jsfiddle.net/94dj6cap/)）：

```
function loopThrough(obj){
  for(var key in obj){
    // skip loop if the property is from prototype
    if(!obj.hasOwnProperty(key)) continue;

    if(typeof obj[key] !== 'object'){
      //your code
      console.log(key+" = "+obj[key]);
    } else {
      loopThrough(obj[key]);
    }
  }
}
loopThrough(validation_messages); 
```

该解决方案适用于各种不同的深度。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2017-07-28T12:49:22.973

一个月前刚刚完成的[ECMAScript 2017引入了 Object.values()。](https://en.wikipedia.org/wiki/ECMAScript#8th_Edition_-_ECMAScript_2017)所以现在你可以这样做：

```
let v;
for (v of Object.values(validation_messages))
   console.log(v.your_name);   // jimmy billy 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2012-12-14T09:59:58.217

我无法让之前的回答完全符合我的要求。

在玩弄了这里的其他回复之后，我做了这个。这很hacky，但它有效！

对于这个对象：

```
var myObj = {
    pageURL    : "BLAH",
    emailBox   : {model:"emailAddress", selector:"#emailAddress"},
    passwordBox: {model:"password"    , selector:"#password"}
}; 
```

...这段代码：

```
// Get every value in the object into a separate array item ...
function buildArray(p_MainObj, p_Name) {
    var variableList = [];
    var thisVar = "";
    var thisYes = false;
    for (var key in p_MainObj) {
       thisVar = p_Name + "." + key;
       thisYes = false;
       if (p_MainObj.hasOwnProperty(key)) {
          var obj = p_MainObj[key];
          for (var prop in obj) {
            var myregex = /^[0-9]*$/;
            if (myregex.exec(prop) != prop) {
                thisYes = true;
                variableList.push({item:thisVar + "." + prop,value:obj[prop]});
            }
          }
          if ( ! thisYes )
            variableList.push({item:thisVar,value:obj});
       }
    }
    return variableList;
}

// Get the object items into a simple array ...
var objectItems = buildArray(myObj, "myObj");

// Now use them / test them etc... as you need to!
for (var x=0; x < objectItems.length; ++x) {
    console.log(objectItems[x].item + " = " + objectItems[x].value);
} 
```

...在控制台中产生这个：

```
myObj.pageURL = BLAH
myObj.emailBox.model = emailAddress
myObj.emailBox.selector = #emailAddress
myObj.passwordBox.model = password
myObj.passwordBox.selector = #password 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2017-04-13T15:07:23.847

我认为值得指出的是 jQuery 很好地解决了这个问题`$.each()`。

请参阅：[**.each()**](https://api.jquery.com/each/)

**例子：**

```
$('.foo').each(function() {
    console.log($(this));
}); 
```

`$(this)`是对象内的单个项目。`$('.foo')`如果您不想使用 jQuery 的选择器引擎，请切换到一个变量。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2018-11-28T08:59:29.580

```
var obj = {
    name: "SanD",
    age: "27"
}
Object.keys(obj).forEach((key) => console.log(key,obj[key]));
```

要遍历 JavaScript*对象*，我们可以使用 forEach 并优化代码，我们可以使用箭头函数。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2021-07-23T02:40:39.040

```
var validation_messages = {
    "key_1": {
        "your_name": "jimmy",
        "your_msg": "hello world"
    },
    "key_2": {
        "your_name": "billy",
        "your_msg": "foo equals bar"
    }
}
for (var i in validation_messages) {
    console.log("i = \"" + i + "\"");
    console.log("validation_messages[\"" + i + "\"] = ");
    console.log(validation_messages[i]);
    console.log("\n");
    for (var j in validation_messages[i]) {
        console.log("j = \"" + j + "\"");
        console.log("validation_messages[\"" + i + "\"][\"" + j + "\"] = \"" + validation_messages[i][j] + "\"");
        console.log("\n");
    }
    console.log('\n');
} 
```

输出：

```
i = "key_1"
validation_messages["key_1"] = 
{
  your_name:"jimmy",
  your_msg:"hello world"
}

j = "your_name"
validation_messages["key_1"]["your_name"] = "jimmy"

j = "your_msg"
validation_messages["key_1"]["your_msg"] = "hello world"

i = "key_2"
validation_messages["key_2"] = 
{
  your_name:"billy",
  your_msg:"foo equals bar"
}

j = "your_name"
validation_messages["key_2"]["your_name"] = "billy"

j = "your_msg"
validation_messages["key_2"]["your_msg"] = "foo equals bar" 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2020-10-19T08:25:29.537

# 为每个2

（在[这里](https://gomakethings.com/the-es6-way-to-loop-through-objects-with-vanilla-javascript/)找到）：

```
var lunch = {
    sandwich: 'ham',
    age: 48,
};
lunch.forEach2(function (item, key) {
    console.log(key);
    console.log(item);
}); 
```

代码：

```
if (!Object.prototype.forEach2) {
    Object.defineProperty(Object.prototype, 'forEach2', {
        value: function (callback, thisArg) {
            if (this == null) {
                throw new TypeError('Not an object');
            }
            thisArg = thisArg || window;
            for (var key in this) {
                if (this.hasOwnProperty(key)) {
                    callback.call(thisArg, this[key], key, this);
                }
            }
        }
    });
} 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2022-02-04T13:41:54.693

使用[lodash _.forEach](https://lodash.com/docs/4.17.15#forEach)：

```
_.forEach({ 'a': 1, 'b': 2 }, function(value, key) {
  console.log(key, value);
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-08-22T01:24:56.110

对我有用的解决方案如下：

```
_private.convertParams = function(params){
    var params = [];
    Object.keys(values).forEach(function(key) {
        params.push({"id":key, "option":"Igual", "value":params[key].id})
    });
    return params;
} 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2020-05-13T22:01:54.760

# 奇特一号——深度穿越

```
JSON.stringify(validation_messages,(field,value)=>{
  if(!field) return value;

  // ... your code

  return value;
}) 
```

在这个解决方案中，我们使用[替换](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify)器，它允许深度遍历整个对象和嵌套对象 - 在每个级别上，您将获得所有字段和值。如果您需要获取每个字段的完整**路径，请查看**[此处](https://stackoverflow.com/a/61693085/860099)。

```
var validation_messages = {
    "key_1": {
        "your_name": "jimmy",
        "your_msg": "hello world"
    },
    "key_2": {
        "your_name": "billy",
        "your_msg": "foo equals bar",
        "deep": {
          "color": "red",
          "size": "10px"
        }
    }
}

JSON.stringify(validation_messages,(field,value)=>{
  if(!field) return value;

  console.log(`key: ${field.padEnd(11)} - value: ${value}`);

  return value;
})
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2020-06-19T07:17:52.163

使用 ES8 Object.entries() 应该是一种更紧凑的方式来实现这一点。

```
Object.entries(validation_messages).map(([key,object]) => {

    alert(`Looping through key : ${key}`);

    Object.entries(object).map(([token, value]) => {
        alert(`${token} : ${value}`);
    });
}); 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2020-07-06T03:34:00.690

## 在 2020 年，您需要不可变和通用的函数

这将遍历由子对象、数组和字符串组成的多维对象并应用自定义函数：

```
export const iterate = (object, func) => {
  const entries = Object.entries(object).map(([key, value]) =>
    Array.isArray(value)
      ? [key, value.map(e => iterate(e, func))]
      : typeof value === 'object'
      ? [key, iterate(value, func)]
      : [key, func(value)]
  );
  return Object.fromEntries(entries);
}; 
```

用法：

```
const r = iterate(data, e=>'converted_'+e);
console.log(r); 
```

* * *

## 回答 #27

> 赞同：-7
> 
> 时间：2013-06-24T07:27:25.007

在我的情况下（基于上述），任何数量的级别都是可能的。

```
var myObj = {
    rrr: undefined,
    pageURL    : "BLAH",
    emailBox   : {model:"emailAddress", selector:"#emailAddress"},
    passwordBox: {model:"password"    , selector:"#password"},
    proba: {odin:{dva:"rr",trr:"tyuuu"}, od:{ff:5,ppa:{ooo:{lll:'lll'}},tyt:'12345'}}
};

function lookdeep(obj,p_Name,gg){
    var A=[], tem, wrem=[], dd=gg?wrem:A;
    for(var p in obj){
        var y1=gg?'':p_Name, y1=y1 + '.' + p;
        if(obj.hasOwnProperty(p)){
           var tem=obj[p];
           if(tem && typeof tem=='object'){
               a1=arguments.callee(tem,p_Name,true);
               if(a1 && typeof a1=='object'){for(i in a1){dd.push(y1 + a1[i])};}
            }
            else{
               dd.push(y1 + ':' + String(tem));
            }
        }
    };
    return dd
};

var s=lookdeep(myObj,'myObj',false);
for (var x=0; x < s.length; ++x) {
console.log(s[x]+'\n');} 
```

结果：

```
["myObj.rrr:undefined",
"myObj.pageURL:BLAH",
"myObj.emailBox.model:emailAddress",
"myObj.emailBox.selector:#emailAddress",
"myObj.passwordBox.model:password",
"myObj.passwordBox.selector:#password",
"myObj.proba.odin.dva:rr",
"myObj.proba.odin.trr:tyuuu",
"myObj.proba.od.ff:5",
"myObj.proba.od.ppa.ooo.lll:lll",
"myObj.proba.od.tyt:12345"] 
```

# java - 将信息从 Java（Servlet）传递到 CGI 方法？

> ID：921791
> 
> 赞同：2
> 
> 时间：2009-05-28T16:18:39.593
> 
> 标签：java, servlets, cgi

我有这个从表单中获取信息的 java servlet，然后我需要获取该信息并将其传递给 .exe 程序中的特定方法并获取该方法返回的值。

有什么好方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T17:24:12.427

我必须在我的一个项目中这样做，但我们使用的是 Linux 而不是 Windows。这是如何去做的一般蓝图。

您将需要：

1.  使用将您的 .exe CGI 文件设置为外部进程`Runtime.getRuntime().exec(filename, env)`
2.  在外部进程中设置对输入流和错误流的引用。

    ```
    InputStream fromCgi = p.getInputStream();
    InputStream errorStream = p.getErrorStream(); 
    ```

3.  然后将外部进程输入流中的字节复制到 servlet 输出流中。

    ```
    IOUtils.copy(fromCgi, response.getOutputStream()); //using apache commons io
    ```

注意：需要在所有部分之间放置很多胶水，但这是如何将 CGI 包装在 Servlet 中的一般策略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T16:22:51.333

如果“.exe 程序”是指 DLL，则可以使用[JNI](http://en.wikipedia.org/wiki/Java_Native_Interface)从 Java 调用其中的方法。

这是不平凡但可行的。

# python - 在python中学习解析器

> ID：921792
> 
> 赞同：12
> 
> 时间：2009-05-28T16:18:45.943
> 
> 标签：python, parsing

我记得我读过一个解析器，你只需要提供一些示例行，它就知道如何解析一些文本。

它只是确定两行之间的差异以了解可变部分是什么。我以为它是用python编写的，但我不确定。有谁知道那是什么图书馆？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-28T20:17:54.183

可能您的意思是*[TemplateMaker](http://code.google.com/p/templatemaker/)*，我还没有尝试过，但它建立在经过充分研究的*最长公共子串*算法之上，因此应该可以合理地工作......如果您对不同（更复杂）的方法感兴趣，您可以轻松找到Google Scholar 上的很多资料都使用查询“包装归纳”或“模板归纳”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T17:20:43.027

可以想象，您可能是指[牧师](http://sourceforge.net/project/showfiles.php?group_id=81259)？

# nhibernate - 类型安全和休眠

> ID：921800
> 
> 赞同：1
> 
> 时间：2009-05-28T16:19:17.800
> 
> 标签：nhibernate

是否可以创建 100% 类型安全的编译时检查代码？

甚至标准似乎都使用字符串引用“用户名”来引用列名，但如果你输入“用户名aa”，它会在运行时失败，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T16:22:36.857

开箱即用，没有。看起来有一个名为[nhlambdaextensions](http://code.google.com/p/nhlambdaextensions/)的项目可能是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-02T10:30:35.903

好消息：您可以通过 Nhibernate3 获得它

见[http://nhibernate.info/blogs/nhibernate/archive/2009/12/17/queryover-in-nh-3-0.aspx](http://nhibernate.info/blogs/nhibernate/archive/2009/12/17/queryover-in-nh-3-0.aspx)

# c++ - 这种模式的重点是什么：使用结构来包含单个方法

> ID：921806
> 
> 赞同：8
> 
> 时间：2009-05-28T16:20:50.667
> 
> 标签：c++, struct

在我们的代码中，我们有很多这种模式的案例：

```
class outerClass
{
    struct innerStruct
    {
        wstring operator()( wstring value )
        {
            //do something
            return value;
        }
    };

    void doThing()
    {
        wstring initialValue;
        wstring finalValue = innerStruct()( initialValue );
    }
}; 
```

这样做有什么好处：

```
class outerClass
{
    wstring changeString( wstring value )
    {
        //do something
        return value;
    }

    void doThing()
    {
        wstring initialValue;
        wstring finalValue = changeString( initialValue );
    }
}; 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-28T16:22:17.637

带有 operator() 的结构通常称为函子，有效地充当“函数对象”。您可以将这些函子与许多 API（尤其是 STL）一起使用，比使用典型的函数指针更容易和更健壮。函子是对象，它们可以包含状态，并在构造过程中被参数化以创建一个自包含的专用处理程序。

我假设很多时候，您在 outerClass 中的代码想要使用这些库函数（即 std::for_each），因此开发了这种模式以使其变得微不足道。如果您从不使用函子，那么是的，这种语法毫无意义且难以阅读（并且可以按照您的建议替换）。

编辑：您可能喜欢关于 operator() 的[问题 317450 。](https://stackoverflow.com/questions/317450/why-override-operator)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T18:17:07.297

这是模板化谓词的优化步骤。

这不是函子比函数更容易使用的问题。两者在 boost 和 STL 上下文中的工作方式几乎相同。

它们的不同之处在于模板实例化。

想象一个需要谓词的简单模板函数

```
template< typename Predicate >
void  DoSomething( Predicate func )
{
  func();
} 
```

使用**函数将使用****函数指针**实例化模板实例。

```
void changeString();

DoSomething( &changeString );

// This creates a template instantiation expecting a pointer to a function.
// The specific pointer may be evaluated at runtime.

// void DoSomething( void(func*)() ); 
```

使用**仿函数**将实例化具有**特定仿函数类型**的模板实例。

```
struct changeString
{
    void operator() ();
}

DoSomething( changeString() );

// This creates a template instantiation expecting an instance of the struct.
// The exact function being called is now known at compile time.

// void DoSomething( changeString ); 
```

有了仿函数，具体的功能现在已经很好地定义了，传入的结构很可能没有被使用，并且可以被优化出来。

# .net - 清除收藏集 - 先清除所有物品，还是一次性清除所有物品？

> ID：921809
> 
> 赞同：1
> 
> 时间：2009-05-28T16:21:06.423
> 
> 标签：.net, list, collections, dictionary

假设我有一个本身包含集合的集合；例如，字典（字符串，列表（MyClass））。如果我想完全清除集合，在清除父集合之前清除每个单独的子集合是否有意义，如下所示：

```
For Each ListDef As KeyValuePair(Of String, List(Of MyClass)) In MasterDictionary
    Dim ThisList As List(Of MyClass) = ListDef.Value
    ThisList.Clear()
Next

MasterDictionary.Clear() 
```

或者这真的只是简单地完成了：

```
MasterDictionary.Clear() 
```

我问是否有**任何理由**——性能、安全性、清晰度等——使用第一种方法。我通常自己使用第二种方法，因为我假设它隐含地实现了第一种方法的作用。但是我们都知道有时假设是多么危险。因此这个问题。

**编辑**：今天，在我自己的应用程序中，我看到了令人信服的证据表明在某些情况下第一种方法可能更可取。在我的应用程序中，当用户单击标有“加载数据”的按钮时，会填充一些全局集合（包含列表的字典，如上面的示例代码）。当用户单击“卸载数据”重新开始时，以前我使用上面的第二种方法清除这些集合。

问题是当用户第二次单击“加载数据”时，应用程序会突然变得非常慢。最终它会再次完成对集合的填充，但速度很慢。在我终于尝试了上面的第一种方法之前，我无法弄清楚如何解决这个问题。现在重新加载和重新填充集合就像第一次加载它们一样快。

根据到目前为止发布的答案，听起来我必须有“其他代码”引用子集合；但是，在我看来，它不像我那样。我引用这些孩子的唯一地方是我迭代他们的父母的地方；如果父母被清除，那么他们应该没有代码知道的孩子，对吗？

希望有人可以帮助我了解这些参考资料是如何仍然存在的，或者我忽略了正在发生的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T16:28:54.427

在这两种情况下，您都没有处理子集合中包含的单个元素的任何处置问题。在这种情况下，两者应该是相同的。

存在差异的一个地方是其他代码是否直接引用了任何单个子集合。如果您在另一部分代码中持有对 List(Of MyClass) 之一的引用，则第一种方法将清除列表中的元素（并影响您的其他代码）。第二种方法不会这样做，因为它会单独留下 List。

如果没有保存其他引用，则第二种方法只是等待 GC 清理元素。在这两种情况下，单个引用都将由 GC 处理，因此性能差异可以忽略不计。就个人而言，我会使用第二种方法，因为我相信它更清晰（并且更容易编写），并且在大多数情况下效果不会那么令人惊讶，特别是如果您在其他地方使用该列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:25:55.087

如果没有其他对“子”集合的引用，则“父”集合上的 Clear() 将导致子集合（以及其中的项目）最终被清理。我想说，只要没有子集合的元素实现 IDisposable，你就是安全的，因为这意味着它们有一些资源锁定，并且不正确地处理它们可能会导致问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T16:25:21.517

这取决于您的代码是如何使用的。

如果您在某处有其他代码引用任何 List(Of MyClass) ，那么显然，这些列表对于使用第一种方法的其他代码将是空的，而在第一种方法中则不是这样。

如果有任何性能差异，我不知道，我想找出答案的最好方法是尝试分析它。人们可能会认为第一种方法最初使用更多的 CPU 功率，但在 GC 轮期间可能更少 - 但实际上这是一个分析有意义的情况:)。

# php - Zend Framework 不允许我包含 Google Maps API

> ID：921811
> 
> 赞同：4
> 
> 时间：2009-05-28T16:21:11.757
> 
> 标签：php, zend-framework, google-maps

我遇到了这个问题：

我想使用引导程序中的 HeadScript Helper 将 Google Maps API 添加到我的 Zend Framework 应用程序：

```
$view->headScript()
->appendFile('/static/js/jquery-1.3.2.min.js')
->appendFile('/static/js/jquery-ui-1.7.1.min.js')
->appendFile("http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAfINi4Ug3nkoREt524GX3ABSFqzY8bf3muCS1IE0M5aBPGVvVxRRzm1PmTbIwi_tXaNcSoONdlIx_sA"); 
```

但是由于某种原因，每次我尝试这个时，我都会收到一个空的警报框作为错误。现在奇怪的部分是，当我使用纯 HTML 插入具有相同密钥的相同脚本时，来自 Google 的“错误密钥”不是问题：

```
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAfINi4Ug3nkoREt524GX3ABSFqzY8bf3muCS1IE0M5aBPGVvVxRRzm1PmTbIwi_tXaNcSoONdlIx_sA" type="text/javascript"></script> 
```

我没有收到那个空的警报框。你有过类似的经历吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T16:54:34.657

我有同样的问题 - ZF 自动编码脚本 URI，所以 & 变成 &

尝试

```
$view->headScript()
->appendFile('/static/js/jquery-1.3.2.min.js')
->appendFile('/static/js/jquery-ui-1.7.1.min.js')
->appendFile("http://maps.google.com/maps?file=api&v=2&key=ABQIAAAAfINi4Ug3nkoREt524GX3ABSFqzY8bf3muCS1IE0M5aBPGVvVxRRzm1PmTbIwi_tXaNcSoONdlIx_sA"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T16:32:19.380

奇怪的是，我只能想象实际输出的内容存在细微差别——您是否比较了两种方法的输出源（使用 headScript 帮助程序，并且只是硬编码脚本标签）并查看是否有任何细微差别？

# javascript - jQuery 浏览器 不透明度问题

> ID：921814
> 
> 赞同：2
> 
> 时间：2009-05-28T16:22:00.790
> 
> 标签：javascript, jquery, html, internet-explorer

我的 IE 有问题。我有一个具有这种样式的图层，可以使其透明和全屏。

```
position:absolute;
top: 0px;
left: 0px;
right: 0px;
bottom: 0px;
background-color: #000000;
filter:alpha(opacity=50); 
-moz-opacity: 0.5; 
opacity: 0.5;
z-index: 1; 
```

我使用 JQuery 方法 fadeIn 和 fadeOut 来显示和隐藏它。好吧，在 Opera 中一切都很好，但 IE7 只是覆盖了样式并将其设置为 100% 不透明度。它甚至会褪色！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T16:33:45.180

Peter-Paul Koch 有[一篇关于不透明度的精彩文章](http://www.quirksmode.org/css/opacity.html)。一般来说，quirksmode.org 是我解决浏览器兼容性问题的第一个地方；PPK 进行了大量研究。也就是说，您看起来拥有所有正确的样式 - jquery 的淡入淡出实现是否没有做正确的事情，即使您给它一个目标不透明度？

你能通过将声明的 CSS 设置为完全不透明但可见：false 来解决问题，然后使用[fadeto](http://docs.jquery.com/Effects/fadeTo)来达到目标​​不透明度吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-26T09:14:43.293

请使用：

```
.abc{
opacity: 0.5;
-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)"; // first! for ie8
 filter: alpha(opacity=50);     // second! for other ie versions
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T21:11:41.283

当我需要做特定于 IE 的事情时，我通常会选择 IE6 和 7 中内置的过滤器。不过，请注意仅将其提供给 IE。涂一点肘部油脂，我认为您也可以使用 jQuery 制作自定义动画。

```
*object*.style.filter='progid:DXImageTransform.Microsoft.Alpha(style=*value*,opacity=*value*)'; 
```

[MSDN：不透明度属性](http://msdn.microsoft.com/en-us/library/ms532910%28VS.85%29.aspx)

# c# - SQL中的“动态”表？

> ID：921815
> 
> 赞同：2
> 
> 时间：2009-05-28T16:22:15.813
> 
> 标签：c#, .net, tsql, database-design, entity-attribute-value

我目前正在为一个网站的想法弄乱一些东西 - 我非常想让我的用户创建保存数据的“表”，然后允许他们查询这些数据（以一种比写起来更令人讨厌的方式SQL 查询，希望比使用 excel 更容易）。

到目前为止，我的想法是在我的数据库中使用几个表来表示这一点 - 一个表表示一个表，一个表表示表的列，一个表表示表中的每一行，最后一个表表示值. 类似于（伪 SQL）的东西：

```
CREATE TABLE 'Tables' (
   Id INT NOT NULL PRIMARY KEY,
   NAME VARCHAR(255)
)

CREATE TABLE 'TableColumns' (
   Id INT NOT NULL PRIMARY KEY,
   TableId INT NOT NULL FOREIGN KEY ON 'Tables',
   NAME VARCHAR(255)
)

CREATE TABLE 'TableRows' (
   Id INT NOT NULL PRIMARY KEY,
   TableId INT NOT NULL FOREIGN KEY ON 'Tables',
   RowNumber INT NOT NULL
)

CREATE TABLE 'TableValues' (
   RowId INT NOT NULL PRIMARY KEY,
   ColumnId INT NOT NULL PRIMARY KEY,
   Value VARCHAR(255)
) 
```

（请注意，TableValues 表在这里有 2 个主键字段，它应该代表一个“复合”主键，不要太在意我的语法不是合法的 SQL，它只是应该显示这个想法）。

我对此进行了一些测试，并能够成功地进行简单的查询（简单的过滤、排序等）。我这样做的方法是首先查询 TableRows 表 - 为了进行过滤，我然后过滤掉了列与条件不匹配的行，并且为了排序，我根据列的内容对 RowIds 进行了排序（由指定的排序指定）。生成按所需顺序排列的行 ID 列表，从这里开始只是选择需要的内容。

所有这一切都很好，但从这里开始我有点卡住了。我希望能够以某种方式表示不同的数据类型（这确实是我的主要问题），然后再研究如何进行连接。

在考虑所有这些时，我开始怀疑是否有更好的方法来做到这一点。请注意，这里的性能当然是一个因素，但我不打算支持具有数十万行的虚拟表，每个虚拟表可能大约 1000 行 - 当然整个系统需要能够处理许多这些。

我知道我总是可以在我的数据库中实际创建表，并在 C# 中动态创建查询来完成此操作，同样使用 SQL 查询进行查询 - 但是我从来都不喜欢让用户对我的数据库“构建”查询像这样 - 在我看来，这似乎会导致出现许多错误的路径 - 在最坏的情况下最终允许用户以一种或另一种方式杀死数据库。

此外，我的问题变成了如何以从 C# 角度来看有意义的方式来处理这个问题。到目前为止，我认为我倾向于使用 LINQ，然后创建自己的扩展方法来应用所需的功能——即扩展 IQueryable 的 ExtensionMethods。

所以我真正想要的是一些关于如何做到这一点的想法，关于如何调整性能的想法，关于如何处理表中单独数据类型的想法（当然将类型存储在 tablecolumn 中，但是如何实际存储该值，以便我可以按它过滤、排序等？- 不只是在我的 tablevalues 表上添加“TextValue”、“MoneyValue”等列）。最后但并非最不重要的一点是，希望在这里进行一些很好的讨论——我至少认为这是一个有趣的话题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T16:48:23.637

出于某种原因，每个人都会在某个时候遇到这个想法。

这似乎是对的，它应该工作。

它会。有点。

关于 TheDailyWTF 的评论是有道理的。在 DBMS 之上重新实现 DBMS 确实不是一个好主意。像这样的元数据会给你

*   表现不佳的系统
*   维护的噩梦

如果您真的需要这种灵活性（是吗？），您最好花时间实现允许您将元数据存储在某些表中并为数据库中的实际表生成模式的层。

我知道这种系统有几个例子：

*   [Microsoft OSLO](http://msdn.microsoft.com/en-us/oslo/default.aspx)（特别是存储库系统）
*   [ASAM-ODS](http://www.asam.net/index.php?option=com_content&task=view&id=117&Itemid=207)服务器架构（查找 ASAM-ODS 包）

我相信还有其他人。

这种设计的好处是您的数据库最终实际上是有意义的，并且它使用 RDBMS 来发挥其优势。此外，由于一旦创建表后这种配置不应该一直发生，它允许用户在需要时微调数据库（主要在索引方面）。

对于您提出的那种系统，我真的强烈认为唯一正确的答案是**don't**。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-28T16:48:53.480

这是一个有趣的想法，但是随着时间的推移，以这种方式使用 SQL 可能会非常痛苦。
如果我理解正确，您希望用户能够定义数据结构，然后将数据保存到这些结构中。您还希望能够查询它。我认为可能还有其他几种方法可以解决这个问题；

*   使用 XML 怎么样？允许每个用户为每个“表”存储一个 XML 文件，并且只维护它的模式。每个“行”都是一个带有子元素的 XML 元素。您可以选择将 XML 粘贴在 SQL 中，或者仅通过其他方式存储它。这不适用于大型数据集，但对于数千条记录来说，速度非常快；我在 C# 中使用 20+MB XML 文件进行了一些测试，并且能够在不到 1 秒的时间内创建、读取和解析它们。使用 LINQ to XML，您甚至可以构建相当复杂的查询和连接。我不会将 XML 用于大型企业系统，但您会惊讶于它在具有大量内存和快速处理器的现代机器上能走多远——而且它具有无限的灵活性。
*   你能改用面向对象的数据库（马蒂斯等）吗？我自己没有这些经验，但我认为你可以很容易地做一些类似于 XML 方法但性能更好的事情。
*   Amazon Simple DB：如果我没记错的话，这本质上是一个您可以使用的基于名称/值对的数据库。您的应用程序是否可以在后台使用它来避免您不得不处理所有管道？如果您必须为 SQL Server 付费，那么 Amazon DB 可能更便宜，并且有能力进行大规模扩展，但没有关系查询之类的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T17:31:41.647

您在原始问题中显示的设计是[实体-属性-值](http://en.wikipedia.org/wiki/Entity-attribute-value_model)设计的变体。

一些人表达的不耐烦可能是因为几乎每个数据库开发人员都“发现”了这种设计，并试图将它用于你正在使用它的目的——一个支持可扩展数据库的灵活系统，而不会带来不便使用`CREATE TABLE`和`ALTER TABLE`。

但是EAV有很多缺点。这只是一个：您如何使任何给定的列成为强制性的（相当于`NOT NULL`约束）？

关系数据库假定您*预先知道*表，并且您可以定义它们。RDBMS 不是用于完全动态关系或具有完全可变属性集的关系的正确工具。为此还有许多其他技术，例如 XML、[RDF](http://www.openrdf.org/)或[CouchDB](http://couchdb.apache.org/)。

另请参阅我对“[下一代数据库](https://stackoverflow.com/questions/282783/the-next-gen-databases/282813#282813)”的回答。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T16:27:31.683

冒着大量反对票的风险，为什么不让他们安装 MS Access？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T16:40:19.457

我在 Microsoft 的 Outlook Business Contact Manager 加载项中遇到了类似的方法。他们处理字段类型的方式是有一个表来定义每个字段的类型，然后他们将实际字段值存储在一个只包含 Varbinary 列的表中。与 varbinary 的转换由字段类型表控制。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T16:50:23.197

一旦以非常通用且因此极其相似的方式存储数据，我就为系统做了一些事情。

系统写的少，读的多，而且为了取出数据而进行的复杂连接使系统变得很慢。

现在我知道这违背了所有数据库实践，但是，我对每个“表”的数据进行了非规范化处理，并在数据库中物理创建了一个名为 Table_1、Table_2 的表。

我基于 Tables 表上的触发器创建和删除了 Table_1 和 Table_2，我使用 TableColumns 表上的触发器向这些表添加和删除了列，使用 TableRows 表上的触发器插入和删除了行，并使用 TableValues 表上的触发器更新了值.

是的，正如预期的那样，我们的写入性能大大降低了，但我们的读取性能（这在当时非常重要）得到了极大的提升，因为我们可以直接从这些“非规范化”表中读取。

因此，基本上您实际上可以在示例中创建和删除表，并相应地添加和删除列。您可以创建您需要的实际数据类型的列，然后您可以在其中存储您想要的任何内容。

可能会使您编写的查询更容易，并且您只为您的用户查看一个表。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-28T16:47:42.220

我不确定为什么所有的仇恨和没有人真正试图回答你的问题。即使它最终是一个“你将如何实施 Google Docs”的问题，它仍然是一个公平的问题。

假设你已经考虑过你是否真的想这样做（我假设所有的仇恨都是关于的），这至少是一个更好的主意：

```
DATA_TABLE {
    TABLEID INT,
    INT1 INT,
    INT2 INT,
    VARCHAR1 VARCHAR(255),
    ... etc
} 
```

然后将元数据存储在某处，记录特定 TABLEID 的名称、使用的字段及其面向用户的名称等。连接很容易支持，因为它们只是数据表上的自连接。是否将所述元数据存储在数据库或其他位置取决于您。

这种方法可以很好地工作（我可以证明许多成功的 .com 网站都使用了这种模式，我参与过和/或认识的人都是），但为了获得最佳性能，我建议使用 CHAR 而不是 VARCHAR ，对齐你的元组，使它们适合页面，等等。

我认为这与 dsteele 的回答相当（非常）相似

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-28T18:00:48.907

SharePoint 在 SQL Server 之上执行此操作以及更多操作。我将研究 SharePoint 如何使用 SQL Server。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-28T17:41:41.457

您肯定希望简化这一点 - 允许您的用户创建表，可能在 TEMPDB 中。只需将模式后缀添加到“CREATE TABLE”d 表中，您就可以避免让它们对 REAL 系统表进行扩展。使您也可以轻松过滤它们。问题是大多数数据库不允许非 dba 创建表，因此需要一些预先设置。您甚至可以专门为此在您的数据库中创建一个模式，并在您的数据库支持的情况下限制大小和表大小限制。

不要重新发明轮子。

这样做，您将自动获得连接、联合等以及与 Crystal Reports 和其他不需要深入了解您的特定模式的工具的接口。

# actionscript-3 - 在 Flash AS3 中，是否可以在不检测 MouseClick 的情况下检测 DoubleClick 操作？

> ID：921819
> 
> 赞同：2
> 
> 时间：2009-05-28T16:22:33.957
> 
> 标签：actionscript-3, events, mouse, double-click, event-handling

我有 2 个彼此不相关的单独事件，每个事件分别附加到 Mouseclick 和 Doubleclick 事件响应。但是，在运行时，我发现即使双击，Mouseclick 操作仍然会被激活。

我一直在尝试找到一个可行的解决方案，其中 Mouseclick 和 Doubleclick 可以相互独立地共存，但到目前为止还没有运气。我什至尝试过让 mouseclick eventresponse 在启动前等待几毫秒（以便用户有机会双击），但这也不是最有效的解决方案。

**有没有人有任何想法？或者可以指出我可以更好地了解如何在 Flash 中捕获 Mouseclick 和 Doubleclick 事件响应的地方？**

我一直在环顾四周，但未能找到足够深入的内容来提及每个事件响应的实际工作方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-10-08T20:35:08.360

无需使用计时器。请按照以下说明操作：

```
someMovieClip.doubleClickEnabled = true;   
someMovieClip.addEventListener(MouseEvent.DOUBLE_CLICK, someFunction);

function someFunction(e:MouseEvent):void {   
    someMovieClip.removeEventListener(MouseEvent.CLICK, clickFunction);    
    // statement for double click action         
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T16:35:14.880

我认为您将不得不使用计时器，这是区分两者的唯一方法。AS 的单线程事件驱动特性存在一些问题，您必须注意；我想我会这样实现它：

```
var timer:Timer = new Timer(100,1);
private function clickHandler(event:MouseEvent):void
{     
    timer.addEventListener(TimerEvent.TIMER, singleClickHandler);
    timer.start();
}

private function doubleClickHandler(event:MouseEvent):void
{
    timer.stop();
    ...
}

private function singleClickHandler(event:TimerEvent):void
{

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-22T13:55:33.217

这样，您只需杀死（想要的）点击事件。正如他所说，两个处理程序彼此不认识，所以你不能为别人杀死处理程序，这是非常糟糕的做法。

据我了解，他两者都想要。因此，“doubleClickEnabled”应该会导致 clickEvent 处理延迟，因此如果同时发生第二次点击，它可以被 doubleClick 事件替换。

但事实并非如此，这两个事件都会被触发。这种行为是出乎意料的——一旦为 InteractiveObject 启用了“doubleClickEnabled”，每次单击都应该有明显的延迟，因为 doubleClick 处理程序仍在等待可能的第二次单击。如果等待时间结束，则会触发正常的点击事件。

仍然有同样的问题，没有巧妙的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T16:41:26.867

我的经验是，这至少部分是设计使然。从 UI 的角度来看，这很容易带来很大的风险。在任何情况下，用户都不一定擅长快速单击以向您提供区别。如果他们不确定点击是否正确，他们可能会重新点击太快，以至于您无法区分。

想一想当您双击时在任何 ol' 应用程序中会发生什么（因为我认为这种情况并不少见）。当我现在正在输入此内容时，如果我双击文本中的其他位置，则会选择并突出显示一个单词，并且光标会消失；它可能在第一次单击后被定位，然后被双击处理程序取消。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-01T09:22:38.563

由于双击速度是由用户设置的，如果用户将双击速度设置为非常慢[1](http://raghuonflex.wordpress.com/2007/08/10/assigning-different-behaviors-on-click-doubleclick/) ，则计时器可能无法工作。

一种解决方法可能是在 500 毫秒（Windows 中的默认时间）内通过两次单击实现您自己的双击。

根据第一次单击的作用，您可以反转第一次单击的行为。例如，如果第一次单击使文件夹反转颜色，则第二次单击可以打开文件夹并取消反转它。

# javascript - 我们如何使用 jQuery 返回元素的 css 属性？

> ID：921821
> 
> 赞同：1
> 
> 时间：2009-05-28T16:22:39.557
> 
> 标签：javascript, jquery

jQuery 最强大的功能之一是选择页面上的任何项目，如下所示：

```
$(".block").css("border","3px solid red"); 
```

如何获取所选项目的值，如宽度高度和左上偏移？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T16:25:29.580

使用[`width`](http://docs.jquery.com/CSS/width),[`height`](http://docs.jquery.com/CSS/height)和[`position`](http://docs.jquery.com/CSS/position)或[`offset`](http://docs.jquery.com/CSS/offset):

```
var elem = $(".block");
var elemWidth = elem.width();
var elemHeight = elem.height();
var elemPosition = elem.position();
var elemOffset = elem.offset(); 
```

如有更多问题，请先查看[jQuery 文档](http://docs.jquery.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T16:26:13.743

```
var height = $(".block").css("height");
alert(height); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T16:28:20.603

就像@Gumbo 说的那样，你可以获得高度和位置。如果您对其他 css 属性感兴趣，您将获得如下值：

```
var border = $(".block").css("border") 
```

但是对于高度和宽度，最好使用 height() 和 width() 函数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T16:27:11.123

尝试这个：

```
$(".block").css("border","3px solid red").offset().top
$(".block").css("border","3px solid red").offset().left 
```

jQuery 中的CSS/ [offset()](http://docs.jquery.com/CSS/offset)

# oracle - 能否使 JBoss JDBC 连接失效，使其不会从连接池中重新获得？

> ID：921830
> 
> 赞同：3
> 
> 时间：2009-05-28T16:24:44.917
> 
> 标签：oracle, jdbc, jboss, connection-pooling

我有一种情况，JDBC 连接将它所连接的 Oracle 会话置于特定状态（即 DBMS_FLASHBACK 启用模式）。此模式的退出可能会失败（至少在理论上），这意味着会话错误地处于该状态。在这种情况下，连接可以返回到池中，并由另一个线程获得，Oracle 会话仍处于 DBMS_FLASHBACK 启用模式。

我已经证明这确实会发生。(JBoss 4.2.1)

理想的做法是在模式退出失败时捕获 SQLException，并将连接标记为“坏”，这样一旦它返回到池中，JBoss 就会破坏连接并创建一个新连接。

但是我找不到任何方法来标记立即销毁的连接。有谁知道一种方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T06:22:15.610

您的 Oracle 数据库连接配置应该包含一个异常排序器：

```
<exception-sorter-class-name>org.jboss.resource.adapter.jdbc.vendor.OracleExceptionSorter</exception-sorter-class-name> 
```

如果连接可以重用或必须断开连接，这将尝试确定何时发生异常。这是在尽最大努力的基础上，并非在所有情况下都有效。我对生产安装的偏好是将[所有异常标记为致命](https://jira.jboss.org/jira/browse/JBAS-3754)。为此，只需将异常排序器设置为`org.jboss.resource.adapter.jdbc.GenericExceptionSorter`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:13:24.477

这是一个很好的问题，我不知道完整的答案，但一些调查途径是从 JBoss 故障转移机制开始，它测试连接的有效性。文档在[这里](http://www.jboss.org/community/wiki/JBossJCADatabaseFailover)。然后在测试有效性的 SQL 中，如果连接处于启用 DBMS_FLASHBACK 的模式下，如果可以放入会失败的东西，那应该让 JBoss 丢弃连接。它可能会测试下一个连接请求，而不是在它返回池时进行测试，尽管这应该是可以接受的。

# css - 这个 CSS 值是什么意思？

> ID：921835
> 
> 赞同：0
> 
> 时间：2009-05-28T16:25:46.647
> 
> 标签：css, css-position

在查看网页的源代码时，我遇到了这个 CSS，应用于按钮内的 span：

```
.whatever button span {
    position: absolute;
    left: -1e+7px;
} 
```

是什么`left: -1e+7px;`意思？这是我应该注意的一些技巧吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T16:32:34.747

它似乎是[科学记数法](http://en.wikipedia.org/wiki/Scientific%5Fnotation)（在这种情况下，为 -10,000,000 像素）。据我所知，CSS 不允许使用科学记数法（[标准](http://www.w3.org/TR/CSS21/syndata.html#numbers)中没有它，但在 Google 搜索[“css 科学记数法”时出现了几个对 Batik（SVG 引擎）](http://www.google.com/search?q=css+scientific+notation)**不**支持它的投诉）。我猜想一些 CSS 解析器确实支持这种表示法，尽管它不是标准的一部分，但如果是这样，我找不到关于*哪些*解析器支持它的信息。

为了安全起见，我会避免在您自己的样式表中使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:48:20.393

来自关于数字的 CSS2 规范

* * *

某些值类型可能具有整数值（用 ~integer~ 表示）或实数值（用 ~number~ 表示）。实数和整数仅以十进制表示法指定。一个~integer~由一个或多个数字“0”到“9”组成。~number~ 可以是 ~integer~，也可以是零个或多个数字，后跟一个点 (.)，后跟一个或多个数字。整数和实数前面都可以用“-”或“+”表示符号。-0 相当于 0，不是负数。

* * *

IE 接受科学计数法。Firefox 忽略它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T16:28:05.940

CSS是否支持科学计数法？他们是否试图将一千万像素的按钮放在一边，也许是为了有一个不可见的默认按钮？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T16:29:24.643

这是[科学记数法](http://en.wikipedia.org/wiki/Scientific_notation)，意思是 -1*10^7 = -10000000。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T16:31:55.590

[根据W3C 验证器](http://jigsaw.w3.org/css-validator/)，这不是有效的 CSS ：

```
.whatever button span    Value Error : position attempt to find a semi-colon before the property name. add it
.whatever button span    Value Error : left Unknown dimension 1e 
```

如果您在`;`之后添加缺少的`position: absolute`内容，您仍然会得到：

```
whatever button span     Value Error : left Unknown dimension 1e 
```

# c++ - 如何在win32 C/winapi中检查目录是否可写？

> ID：921847
> 
> 赞同：1
> 
> 时间：2009-05-28T16:27:55.677
> 
> 标签：c++, windows, winapi

我知道两种不可靠的方法：

*   _access() - 不适用于目录（仅检查存在）
*   CreateFile() - 在虚拟商店存在的情况下给出误报（AFAIK）

最有用的是代码示例，因为 win32 ACL 访问函数非常复杂。请不要发布指向 msdn 的链接，我一直在那里，但我一生都无法弄清楚我应该如何处理所有这些 DACL、SACL 和安全描述符——我在一个跨平台应用程序上工作它需要这个特定的功能，否则与平台无关。比访问 Windows ACL 更简单的解决方案非常受欢迎。

编辑：您可以放心地假设应用程序运行时目录权限不会更改。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T20:52:28.467

您可以在清单文件 ( [http://www.codeguru.com/csharp/csharp/cs_misc/designtechniques/article.php/c15455/](http://www.codeguru.com/csharp/csharp/cs_misc/designtechniques/article.php/c15455/) ) 中为您的应用程序禁用**位置虚拟化**- 这应该使*CreateFile*对您的目的足够可靠。

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T16:32:51.827

在任何操作系统上都没有可靠的方法，因为可以在测试它们和实际写入文件之间更改权限。

# visual-studio - 改变输出路径

> ID：921853
> 
> 赞同：1
> 
> 时间：2009-05-28T16:29:11.913
> 
> 标签：visual-studio, visual-studio-2008

我有多个 Web 项目（请不要问我为什么其中有多个命名空间，我没有创建它。哈哈）并且需要将 dll 编译到主 Web 项目。问题是我无法提供磁盘目录路径，因为我们在另一台机器上构建并且该目录路径不同。

有没有办法可以通过项目名称动态设置输出路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T16:37:31.460

我认为您可能想查看各个项目的构建后事件（在“构建事件”选项卡下的项目的“属性”中查看）。在那里，您可以创建复制文件的事件，并通过 {TargetPath} 和 {ProjectPath} 等变量表达路径，这些变量对于不同的设置会有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-01T16:06:40.267

复制语句就像构建事件中的魅力一样。但是，如果您需要上几个文件夹，您可以在“构建”选项卡下的“输出”路径中执行类似的操作。

..\bin\调试\

# ruby-on-rails - Rails 在使用 redirect_to 时抛出错误：back

> ID：921854
> 
> 赞同：0
> 
> 时间：2009-05-28T16:29:22.647
> 
> 标签：ruby-on-rails, redirect, undefined

每当我使用：

```
redirect_to :back 
```

在我的 Rails 控制器中，我收到以下错误：

> SubmissionController:0xb7a37764 的未定义方法“object_url”

我还将在下面粘贴应用程序跟踪：

> /usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/polymorphic_routes.rb:112:in `__send__' /usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/polymorphic_routes.rb:112:in` polymorphic_url' /usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2 /lib/action_controller/base.rb:628:in `url_for' /usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:1085:in` redirect_to' /usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:1080:in `redirect_to'
> 
> app/controllers/submission_controller.rb:38:in `show'

我很确定这不是语法错误，而是更深层次的错误。可能在更新期间出现问题或其他什么。任何想法将不胜感激！

感谢您的关注。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-13T18:11:34.423

我认为在这种情况下你不应该使用“redirect_to”，只需使用“:back”。例如：

是 JavaScript 实用程序获取历史记录中上一个 URL 的简写。

# c# - 将窄类型转换为更宽类型以节省内存并保持高精度计算是一个糟糕的主意吗？

> ID：921858
> 
> 赞同：5
> 
> 时间：2009-05-28T16:29:55.813
> 
> 标签：c#, performance, memory, casting, decimal

我正在处理财务数据，所以它有很多并且需要相对高精度（64 位浮点或更宽）。

我工作场所的标准做法似乎是将所有这些都表示为 c# 十进制类型，这是一个 128 位宽的浮点数，专门用于支持四舍五入的自由 base10 操作。

由于 64 位足够宽以保持代表性精度，因此将数据转换为更广泛的类型以进行所有计算（mult、div、add 等）然后回到 64 位以存储在内存中（这是它花费的地方）是荒谬的吗？大多数时候）？

供参考：内存绝对是这里的限制资源。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-28T16:49:48.580

使用十进制（128 位）而不是双精度（64 位）和浮点数（32 位）通常与大小无关。跟基地有关。虽然 double 和 float 是浮点型*二进制*点类型，但 decimal 是一种浮点型*小数点*类型 - 正是这种特性使它可以准确地表示像 0.1 这样的数字，而 float/double 则不能。

我们不能没有 64 位十进制类型没有概念上的原因，在许多情况下这确实足够了 - 但在出现这种类型或您自己编写之前，*请*不要使用“更短的"（和二进制浮点）类型的浮点数/双精度数，用于财务计算。如果你这样做，你就是在自找麻烦。

如果您建议编写一种可以转换为十进制/从十进制转换并且仍然是浮点十进制类型的存储类型，那么即使它无法进行任何计算，这听起来也是一个潜在的好主意。如果您曾经被要求转换一个您无法准确表示的十进制值，您在考虑该怎么做时需要非常小心。老实说，我有兴趣看到这样的类型。唔...

（正如其他答案所表明的那样，在执行此操作之前，我真的要确保是数字占用了内存。如果您*不需*要这样做，那么推测性地引入额外的复杂性毫无意义。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T16:57:09.407

64bit 浮点数无法保持财务数据的精度。这不是空间问题，而是数据类型使用哪种数字系统的问题；double 使用 base-2，decimal 是 base-10，base-2 不能表示精确的 base-10 小数，即使它有 1000 位精度。

不相信我？运行这个：

```
double d = 0.0;
for (int i = 0; i < 100; i++)
    d += 0.1;
Console.WriteLine(d);

> 9.99999999999998 
```

如果您需要以 10 为底的计算，则需要小数类型。

（编辑：该死的，又被 Jon Skeet 打败了……）

如果十进制类型确实是瓶颈，您可以使用大量便士（或 1/8 美分或任何您的单位）而不是十进制美元。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T16:33:40.923

您应该使用分析器来查看哪些对象占用了大量内存。如果您的十进制对象是罪魁祸首，那么我会说是的。否则你只是在猜测。Profiler 肯定会告诉你。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T16:49:15.820

如果您不介意性能下降，将您的数字存储在 64 位，将它们转换为十进制类型进行计算，并将结果转换回 64 位是完全合理的。

在我工作的地方，我们需要这种精确度，所以这正是我们在这里所做的。通过强制转换，我们的速度提高了两个数量级，但我们永远不必担心浮点运算中的大错误。如果没有强制转换，计算可能会非常不准确，具体取决于数字的范围和正在执行的计算类型。

[有关浮点运算的更多信息，以及为什么错误会蔓延到您的计算中，请参阅http://docs.sun.com/source/806-3568/ncg_goldberg.html](http://docs.sun.com/source/806-3568/ncg_goldberg.html)上的“每个计算机科学家应该了解的关于浮点运算的知识”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T17:51:33.010

正如大多数其他帖子已经指出的那样，在 128 位十进制和 64 位浮点表示之间进行转换并不是始终保持准确性的转换。

但是，如果您正在处理金融股的价格，您可以考虑将它们表示为整数（便士的数量）而不是十进制值（小数美元的数量）。以便士为单位执行所有财务计算，然后仅在请求时以小数形式向外界公开。

另一种方法可能是提高系统的算法效率，而不是“压缩”存储类型。您真的需要一次在内存中存储所有数据吗？你能以某种方式虚拟化它吗？

如果不是，考虑到您正在管理的数据量，您可能需要考虑以减少冗余的方式组织数据。例如，并非每只股票都有一个历史价格（有些公司存在的时间还不够远）。因此，将您的数据组织为按天（或按年）排列的股票价格字典，而不是每只股票的表格结构。可能还有其他选择，具体取决于您的数据如何可用以及您打算如何使用它执行计算。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T16:33:04.747

如果 64 位浮点确实足以代表您想要的精度，这似乎非常合理。正如您所说，额外精度小数通常纯粹用于最大限度地减少多次操作的累积误差。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T16:35:11.433

您需要进行数值分析，看看这种做法（保持 128 位）是否荒谬，或者只是懒惰，或者真的有必要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-28T16:56:15.150

“只是添加更多内存”是可以接受的答案吗？

正确编码和测试在这些表示之间移动值的建议方法涉及多少成本。将这个成本与将更多内存装入一台应用程序作为 64 位进程运行的机器进行比较。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-28T16:58:40.653

来自MSDN decimal：浮点类型和十进制类型之间没有隐式转换；因此，必须使用强制转换来在这两种类型之间进行转换。

在您使用的情况下，看起来需要进行演员表。

话虽如此，了解这里的大多数其他人在用浮点表示货币的问题上所提出的问题是非常重要的。

您可以考虑创建/查找可用于您的系统的 64 位 BCD（二进制编码十进制）实现。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-01-13T21:18:05.840

相同的双精度数转换为小数，然后转换为 byte[]，然后压缩占用 c.2x 更少的空间（我刚刚使用几个压缩库对此进行了测试：Blosc 带默认值，lz4，zlib 带或不带随机播放，带随机播放的小数是最好的）。

一种选择是将压缩的小数存储在内存或磁盘上，因为现在 CPU 正在挨饿。在此处查看许多演示文稿：http: [//blosc.org/docs/](http://blosc.org/docs/)

# javascript - 在 JavaScript 中按名称调用函数？

> ID：921861
> 
> 赞同：0
> 
> 时间：2009-05-28T16:31:14.577
> 
> 标签：javascript, jquery

我正在尝试下一个代码但没有成功

HTML

```
<a id="addBookButton" href="javascript:showForm('addBookButton','add-book','activateAddBookForm');" class="addA"><span>Add Book</span></a>

Javascript

function showForm(button,form,callback) {
    $("#"+button).hide();
        $("#"+form).show();
        callback();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T16:33:16.400

您可以将对该函数的引用传递给您的 showForm 函数。

```
<a id="addBookButton" href="javascript:showForm('addBookButton','add-book',activateAddBookForm);" class="addA"><span>Add Book</span></a> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:33:13.763

试试这个：

```
function showForm(button,form,callback) {
    $("#"+button).hide();
    $("#"+form).show();
    if (typeof this[callback] == "function") this[callback]();
} 
```

你通过值传递函数，而不仅仅是它的名称：

```
<a id="addBookButton" href="javascript:showForm('addBookButton','add-book',activateAddBookForm);" class="addA"><span>Add Book</span></a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T16:33:13.950

将您的 a 标签更改为：

```
<a id="addBookButton" href="#" onclick="showForm('addBookButton','add-book','activateAddBookForm'); return false;" class="addA"><span>Add Book</span></a> 
```

注意`onclick`处理程序，以及`return false;`onclick 内的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T16:33:30.923

```
function showForm(button,form,callbackName) {
    $("#"+button).hide();
    $("#"+form).show();
    var callback = window.callbackName;
    if(typeof callback === 'function') {
        callback();
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T16:39:10.287

```
<a id="addBookButton" onclick="javascript:showForm('addBookButton','add-book','activateAddBookForm');" class="addA"><span>Add Book</span></a> 
```

Javascript

```
function showForm(button,form,callback) {
  // Your Code
}

function callFunction(){
  document.getElementById('addBookButton').onclick();
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-28T16:35:05.537

一种选择是将函数作为引用而不是作为字符串传递，因此：

```
... javascript:showForm('addBookButton','add-book', activateAddBookForm); .... 
```

或继续使用字符串：

```
function showForm(button,form,callback) {
    $("#"+button).hide();
        $("#"+form).show();
        new Function(callback + '();')();
} 
```

# migration - 从 ASP.NET 2.0 迁移到 ASP.NET 3.5 的令人信服的理由

> ID：921862
> 
> 赞同：4
> 
> 时间：2009-05-28T16:31:26.840
> 
> 标签：migration, asp.net-2.0, asp.net-3.5

如果这是一个重复的问题，请原谅我。我搜索了 StackOverflow 并没有找到我的问题的答案，所以就到这里。

我们目前有一个运行 ASP.NET 2.0 并运行 AJAX Extensions 1.0 和 SQL Server 2005 的 Web 应用程序，部署在 IIS 6 上并在 VS2005 中开发。一切都很好，但我正在努力寻找令人信服的迁移理由。我们服务的客户端通常不允许浏览器中的插件，因此 Silverlight 不是我们迁移的理由。此外，我们近期没有任何迁移到 SQL Server 2008 的计划，而且 ASP.NET MVC 也不在工作中。

这是我迁移的原因。我希望人们对他们发表评论或添加到列表中：

*   我想使用较新的 .NET 东西（我认为其他开发人员也会这样做。也吸引未来的员工）
*   想要让技术保持最新。
*   扩展方法
*   WebControls 中的 PageMethods
*   WCF
*   LINQ 可能（我们目前将 AutoSproc 用于 DAL）
*   ASP.NET AJAX 内置于 ASP.NET 3.5（虽然不是什么大问题）
*   VS.NET 2008 JavaScript 智能感知

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T16:49:01.173

我最喜欢的部分是：

*   Lambda 表达式
*   System.Data.Linq 命名空间中可用的函数：Where(...)、OrderBy(...)、ForEach(...)
*   扩展方法（向所有 IEnumerable 添加“ToDelimitedString(...)”！）
*   Visual Studio 2008 在 HTML/web 语法和调试方面更好，包括前面提到的 Javascript 智能感知和调试。

这些中的每一个都允许您以更高效的方式编写代码。
它在很大程度上消除了样板文件“foreach”、“if x != null”和其他无聊的构造。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:38:55.920

javascript 智能感知是对之前任何东西的*巨大*改进。但与此同时，它仍然以一些非常壮观的方式失败。总而言之，这是一个很好的步骤，但不是我能够随心所欲地使用的东西。

扩展方法和 linq（linq to objects 和 lambdas，不仅仅是 linq to sql）非常酷，但是由于您已经设置了 orm，因此您也不会随意使用它们。

WCF 没问题，但您可能不会为它重新编写现有服务。

我认为最大的原因是让您的员工开心并吸引优秀的新员工。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T17:50:51.843

LINQ 是升级的一个理由，即使您不更换 DAL，或者暂时不更换。在我最近一直在开发的产品中，我们的开发计划是这样的，暂时没有空间将我们的 DAL 更改为基于 LINQ 的，但即便如此，我还是找到了使用 LINQ-to-Objects 和/ 或 LINQ-to-XML 在我接触的大约 60% 的类中，我喜欢它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T16:57:56.660

从商业角度来看，您绝对没有理由升级。

从开发人员的角度来看，您绝对有充分的理由进行升级。

请记住，SQL 2008 与 SQL 2005 不向后兼容，这意味着，如果您在 SQL 2008 中开发某些东西，那么您的 2005 平台很可能会对此感到厌烦。我最近刚刚使用 SSIS 包体验了这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T02:16:53.167

Everything still runs on .NET 2.0, it's just library and language enhancements and an improved IDE experience, which are made to increase productivity. Increased productivity = justification.

I use LINQ all the time now, every single day. It's not just for your DAL. It's about querying anything, with the same API over top. More generally, lamba expressions provide you with the ability to do some things that are very complicated and take a lot more code without them. Anonymous types are very useful as well.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T17:09:52.800

提到的所有观点都是有效的。

但作为一个开发者，面对这样的问题，我总是从另一面问自己。

什么是**不**从 ASP.NET 2.0 迁移到 ASP.NET 3.5 的令人信服的理由？我发现更容易让自己有动力升级。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T01:26:06.513

免费的Microsoft ASP.net Chart 控件和新版Ajax 工具包都需要3.5。如果我没错的话。

# tsql - 为什么我的类型化数据集不喜欢临时表？

> ID：921864
> 
> 赞同：10
> 
> 时间：2009-05-28T16:31:40.113
> 
> 标签：tsql, stored-procedures, visual-studio-2008, strongly-typed-dataset, sql-server-2005-express

我正在尝试向我的 SQL Server 2005 Express 中的存储过程添加一个表适配器。但是，存储过程使用名为#temp 的临时表。创建表适配器时，Visual Studio 抱怨“未知对象'#temp'”并说存储过程返回 0 列。这是有问题的，因为我将该存储过程与水晶报表一起使用，并且需要这些列。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-28T17:53:44.380

奇怪。根据[这个](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataset/thread/fe76d511-64a8-436d-9c16-6d09ecf436ea)你添加

```
IF 1=0 BEGIN
    SET FMTONLY OFF
END 
```

在 SP 的 AS 部分之后到 SP 并且它可以工作。Visual Studio 现在已经没有问题了。我不知道为什么会这样，或者为什么会起作用，但确实如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-15T15:39:38.447

这可能是一个旧线程并且找到了答案，但是当有人进入您的存储过程并看到这段代码时，他真的不明白。还有另一种正确执行此操作的方法，即简单地将表声明为如下变量：

```
DECLARE @temp TABLE  
(
    SomeText1 nvarchar(255),
    SomeText2 nvarchar(255)
) 
```

另外，不要忘记在最后删除 DROP TABLE。

PS：如果您确实需要使用临时表，因为您需要创建它，那么您必须编写上一个答案中给出的代码。希望这可以帮助。

# facebook - Facebook 为 iframe 应用添加个人资料框

> ID：921873
> 
> 赞同：1
> 
> 时间：2009-05-28T16:33:07.320
> 
> 标签：facebook, iframe, profile

我有一个 iframe 应用程序，它只有一个画布页面。我需要将配置文件框与此应用程序集成。许多教程让您在配置文件框设置下编辑默认 FBML，但该选项不再存在。我很好奇如何为我的 iframe 应用程序设置默认 FBML，以及如何允许用户将我的应用程序的配置文件框添加到他们的配置文件中。

谢谢。-特洛伊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T21:46:48.720

我遇到了类似的情况。很明显，配置文件框不能包含 iframe（甚至 fb:iframe）。它也不能包含外部脚本链接。

看起来您可以使用 FBJS 在某些内容中进行 ajax，但总体而言，您应该使用配置文件框来“输入”您的画布。

# nhibernate - nHibernate 怎么可能没有 100% 的编译时间测试？

> ID：921880
> 
> 赞同：1
> 
> 时间：2009-05-28T16:33:31.017
> 
> 标签：nhibernate

关于 nHibernate 困扰我的一件事是它没有经过 100% 的编译时间测试。

如果我重命名数据库表中的一列，并更新该表的映射文件，当我点击编译时，我应该在我引用该列名的所有查询代码（hql/标准等）中得到错误，以及它是如何拼写错误。

使用 ORM 的全部意义（无论如何对我来说）是数据库更改不会破坏我的查询。

换句话说，我将在编译时收到需要修复的通知，而不是运行时错误等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T18:45:45.540

为了实现你想要的，我认为你最好的解决方案是结合使用[Fluent NHibernate](http://fluentnhibernate.org/)和[nhlambdaextensions](http://code.google.com/p/nhlambdaextensions/)。Fluent NHibernate 将为您提供对映射文件的类型安全检查（因此，如果您更改实体的属性，如果您不更改映射类的属性，编译器将抛出错误）。lambda 函数扩展将通过 Criteria API（不是 HQL，因为那只是魔术字符串 SQL-with-objects）为您提供类型安全的查询。

为了澄清你的问题，你说：

> 如果我更改数据库表中的列（重命名），并更新该表的映射文件，当我点击编译时，我应该在引用该列名称的所有查询代码（hql/criteria 等）中出现错误，并且它是如何拼写错误的。

仅更改数据库端应该不会破坏任何内容（假设您还在 XML 映射文件中进行了更改）。您的代码*不*引用`column="first_name"`映射的部分，它引用了该`name="FirstName"`部分。如果您不更改实体，只要您更新映射文件，重命名数据库中的列（例如从“ `firstname`”到“ ”）不会中断查询。`first_name`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:03:00.737

你应该看看[Castle ActiveRecord](http://www.castleproject.org/activerecord/index.html)。我以前使用过它，它让您不必担心映射文件（.hml）。它使您可以在类级别定义上进行更改，并且映射文件通常不会受到影响。

如果您正在编写错误的查询，那听起来像是设计问题，而不是 nHibernate 问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T19:09:39.577

如果属性名称没有更改，您将不会收到错误，因为大多数人在 NHibernate 中使用 HQL 进行查询。但是，如果您更改属性名称而不是 HQL，您确实会得到损坏的查询，例如：

```
FROM User Where User.Surname = 'bob' 
```

将 Surname 属性更改为 Lastname，它将中断。这是 NHibernate 中缺乏的一个功能，但对于 contrib 来说是一个很好的项目——一个 Subsonic 风格的查询界面。[这是一个](http://code.google.com/p/nhibernatequeryhelper/)类似的项目，但仍然使用 HQL。

如上所述，[ActiveRecord](http://www.castleproject.org/activerecord)和[Fluent NHibernate](http://fluentnhibernate.org/)最接近 NHibernate 的类型检查。正如您所期望的那样，两者都强制您从它们的基类继承您的类，并且[ActiveRecord](http://www.castleproject.org/activerecord)不用于生产用途 - Ayende 在一段视频中说过，该视频旨在成为 NHibernate 的原型设计工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T16:38:55.530

Hibernate 基于映射配置使用动态字节码生成来创建映射类。

ORM 的基本点是启用对象和关系系统之间的自动魔法映射（桥梁）。因此：ORM。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T16:54:53.390

如果你想强烈键入你的对象而不是使用 xml 配置，如果没有正确测试，这可能会导致很多运行时问题，我会研究 FluentNHibernate，它有约定映射，允许你将你的类映射到代码中的数据。让我的生活更轻松，尤其是当我第一次开始使用 NHibernate 时，希望我在知道如何使用 xml 正确映射之前找到它

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T19:28:20.430

NHibernate 是否具有与 Java 版本的模式验证器等效的功能？在这种情况下，您可以在构建过程中添加一个步骤来构建会话工厂并运行验证器——构建会话工厂还应该编译命名查询，从而也验证它们。

嗯，看起来它支持这样的东西：http: [//nhibernate.info/blog/2008/11/22/nhibernate-schemavalidator.html](http://nhibernate.info/blog/2008/11/22/nhibernate-schemavalidator.html)

注意，这意味着如果您的开发数据库不可用，您的构建过程将无法工作——我认为这是一件坏事。

# c# - EventHandler 创建的 C# Windows 窗体立即消失

> ID：921888
> 
> 赞同：1
> 
> 时间：2009-05-28T16:34:30.577
> 
> 标签：c#, winforms, multithreading, .net-2.0, event-handling

我不知道为什么会这样，但是当我在 EventHandler 中创建一个新表单时，它会在方法完成后立即消失。

这是我的代码。为了清楚起见，我对其进行了编辑，但从逻辑上讲，它是完全相同的。

```
static void Main()
{
    myEventHandler = new EventHandler(launchForm);
    // Code that creates a thread which calls
    // someThreadedFunction() when finished.
}

private void someThreadedFunction()
{
    //Do stuff

    //Launch eventhandler
    EventHandler handler = myEventHandler;
    if (handler != null)
    {
        handler(null, null);
        myEventHandler = null;
    }
}

private void launchForm(object sender, EventArgs e)
{
    mf = new myForm();
    mf.Show();
    MessageBox.Show("Do you see the form?");
}

private myForm mf;
private EventHandler myEventHandler; 
```

只要 MessageBox 显示“您看到表单了吗？”，新表单就会显示。有没有。只要我点击确定，表格就会消失。

我错过了什么？我认为通过将新表单分配给类变量，它会在方法完成后保持活动状态。显然，事实并非如此。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T16:39:11.957

我认为问题在于您正在从自定义线程而*不是*UI 线程执行处理程序中的代码，这是必需的，因为它操作 Windows 消息泵。您想使用`Invoke`此处的方法来确保表单在 UI 线程上得到并显示。

```
private void launchForm(object sender, EventArgs e)
{
    formThatAlreadyExists.Invoke(new MethodInvoker(() =>
    {
        mf = new myForm();
        mf.Show();
        MessageBox.Show("Do you see the form?");
    }));
} 
```

请注意，这假定您已经有一个 WinForms 对象（称为`formThatAlreadyExists`）并使用`Application.Run`. 此外，可能有更好的地方将`Invoke`调用放入您的代码中，但这至少是一个可以使用的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T16:38:38.243

我认为如果您在线程上创建表单，则该表单归该线程所有。创建任何 UI 元素时，应始终在主 (UI) 线程上完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T16:40:07.587

这看起来好像您不在表单 sta 线程上，所以一旦您显示表单它就消失了并且线程完成它的工作它会自我杀死它，因为没有任何引用线程。它不是最好的解决方案，但如果你需要一个代码示例，你可以使用 showdialog() 而不是 show 来完成它保持状态，我将这个完全相同的过程用于“加载......”表单

```
public class Loading
{
    public delegate void EmptyDelegate();
    private frmLoadingForm _frmLoadingForm;
    private readonly Thread _newthread;
    public Loading()
    {
        Console.WriteLine("enteredFrmLoading on thread: " + Thread.CurrentThread.ManagedThreadId);
        _newthread = new Thread(new ThreadStart(Load));
        _newthread.SetApartmentState(ApartmentState.STA);
        _newthread.Start();
    }

    public void Load()
    {
        Console.WriteLine("enteredFrmLoading.Load on thread: " + Thread.CurrentThread.ManagedThreadId);
        _frmLoadingForm = new frmLoadingForm();
        if(_frmLoadingForm.ShowDialog()==DialogResult.OK)
        {

        }
    }

    /// <summary>
    /// Closes this instance.
    /// </summary>
    public void Close()
    {
        Console.WriteLine("enteredFrmLoading.Close on thread: " + Thread.CurrentThread.ManagedThreadId);
        if (_frmLoadingForm != null)
        {
            if (_frmLoadingForm.InvokeRequired)
            {
                _frmLoadingForm.Invoke(new EmptyDelegate(_frmLoadingForm.Close));
            }
            else
            {
                _frmLoadingForm.Close();
            }
        }
        _newthread.Abort();
    }
}
public partial class frmLoadingForm : Form
{

    public frmLoadingForm()
    {
        InitializeComponent();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T16:38:04.190

是

```
dbf.Show(); 
```

错字？应该是这个吗？

```
mf.Show(); 
```

除了您打算展示的表格之外，您还展示了另一种表格吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T18:38:16.873

您在非 UI 线程上创建了一个窗口。当线程中止时，它会带走你的窗口。故事结局。在传递一个委托的主窗体上执行调用，该委托将执行在 UI 线程上创建消息框的方法。由于 MessageBox 是一个模态窗口，如果不希望 launchForm 方法阻塞后台线程，请创建一个具有所需 UI 的自定义表单并在其上调用 show()，而不是 ShowDialog()。

# wpf - MVVM Tabcontrol 更改选项卡

> ID：921893
> 
> 赞同：0
> 
> 时间：2009-05-28T16:35:40.917
> 
> 标签：wpf, mvvm, viewmodel

我正在用 wpf 开发一个 mvvm 应用程序。如果文本框有文本，则刚刚添加了一个要求以阻止用户更改选项卡。

在视图模型中完全做到这一点的最佳方法是什么？我不知道如何阻止 tabitem，因为 tabcontrol 中没有要绑定的依赖对象命令，我是否需要滚动自己的 tabcontrol 并围绕 SelectionChanged 事件构建 ICommand？

我应该简单地（eegad..不要说）将代码放在 SelectionChanged 事件中视图后面的代码中吗？

我有没有想到的替代方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T21:42:32.577

您可以考虑将每个 TabItems 的 IsEnabled 属性绑定到 ViewModel 中的一个属性（例如 ViewModel.TabsEnabled），并在文本框有文本时将该属性设置为 False。这样，您就可以从 ViewModel 启用/禁用这些选项卡，而无需为该特定视图提供代码隐藏文件。

这意味着您的视图中将包含以下内容（假设您的 ViewModel 是一个名为 ViewModel 的静态类）：

```
<TabItem IsEnabled="{Binding Source={x:Static local:ViewModel.TabsEnabled}}"/> 
```

然后，当其中一个文本框有内容时，您只需在 ViewModel 上设置 TabsEnabled 属性；有几种方法可以做到这一点，但如果它们绑定到您的 ViewModel，您应该有很多机会来监听更改并根据需要设置 TabsEnabled。

# javascript - 打开 JavaScript 文件时 Visual Studio 2008 崩溃？

> ID：921894
> 
> 赞同：5
> 
> 时间：2009-05-28T16:36:06.720
> 
> 标签：javascript, visual-studio, visual-studio-2008

每当我尝试打开特定的 JavaScript 文件时，Visual Studio Team system 2008 都会崩溃且没有任何错误消息。我在 social.msdn 上找到[了](http://social.msdn.microsoft.com)[这个](http://social.msdn.microsoft.com/Forums/en-US/vssetup/thread/ef159e96-beea-4ac4-babe-5543bc355304)帖子，但安装 KB958502 修补程序并没有解决问题。

有没有其他人经历过这个并解决了它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T21:08:49.353

您是否安装[了适用于 Visual Studio 2008 的 PowerCommands](http://code.msdn.microsoft.com/PowerCommands "http://code.msdn.microsoft.com/PowerCommands")？如果是这样，请查看此帖子以获取帮助：

> [修复：Visual Studio 2008 的 PowerCommands 崩溃 IDE](http://blog.jasonbunting.com/PermaLink,guid,d578f8c3-e975-4fca-8100-404db4de8af2.aspx "修复：Visual Studio 2008 的 PowerCommands 崩溃 IDE")

当我打开一些 JavaScript 文件时，同样的事情也发生在我身上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T15:57:19.427

由于这与我上次的“答案”不同，因此我正在创建另一个帖子/条目。

我确实在去年参与的一个项目中不时经历过这种情况。我使用[**MochiKit**](http://www.MochiKit.com "MochiKit 让 JavaScript 不那么糟糕")作为我的工具包，所以要考虑到这一点。

基本上，我在一个名为 common.js 的文件中有一些这样的代码，它在全局范围内运行：

```
if(typeof(DomEvent) == "undefined") {
   DomEvent = {};
   var domEventNames = [
      "onabort", "onblur", "onchange", "onclick", "ondblclick", "onerror", "onfocus", 
      "onkeydown", "onkeypress", "onkeyup", "onload", "onmousedown", "onmousemove", 
      "onmouseout", "onmouseover", "onmouseup", "onreset", "onresize", "onscroll", 
      "onselect", "onsubmit", "onunload"
   ];
   // forEach is a MochiKit function; functionality should be obvious
   forEach(domEventNames, function(eventName) {
      DomEvent[eventName] = eventName;
   });
} 
```

因此，它基本上动态地构建一个分配给变量的`DomEvent`对象，并在该对象上创建与它所持有的值同名的属性（常见浏览器事件的字符串表示形式）。

现在，我希望 Intellisense 帮助我处理其他文件中的 API，因此在其他文件中，我将在文件顶部包含以下行：

```
/// <reference path="common.js"/> 
```

这告诉 Visual Studio 从该 JavaScript 文件“导入”API，以便在使用此声明的文件中与 Intellisense 一起使用。

所以我推测，由于我在上面展示的 common.js 文件中的代码动态构建了一个全局变量的值，Visual Studio 对此很感兴趣。*我对这个假设感觉相当好，因为 JavaScript 代码本身是正确的，并且只有在*我使用该 XML 注释来协助 Intellisense时，Visual Studio 才会崩溃。如果我删除它，则没有问题。

希望对您或其他人有所帮助。

# ruby-on-rails - 您是否有任何理由不希望在关联中使用 foreign_key？

> ID：921899
> 
> 赞同：2
> 
> 时间：2009-05-28T16:37:00.337
> 
> 标签：ruby-on-rails, database, foreign-keys, associations

如果你有

```
Parent
 has_many :children

Child 
```

是否有任何理由`belongs_to :parent`不希望在子项（对父项）和相应项上使用外键？

什么时候，如果有的话，你不希望你的孩子能够访问它的父母吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T17:02:39.943

这是一个权衡。反对外键的通常论点是外键的索引在插入/更新/删除时会产生一些性能开销。 *就像任何索引一样。*

但是，当您通过该列进行搜索时，索引也会带来很大的好处。

```
SELECT * FROM Child WHERE parent_id = :id 
```

也不要低估搜索孤儿和清理 bollixed 引用的开销，这是省略外键约束的必然结果。

```
-- Typical chore: searching for orphaned child rows.

SELECT c.* FROM Child c LEFT OUTER JOIN Parent p 
  ON (c.parent_id = p.parent_id) 
WHERE p.parent_id IS NULL; 
```

还有一些数据库设计*不能*使用外键，例如多态关联或实体-属性-值。但这些设计本身就是反模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T16:41:33.980

表现。插入子记录以确定是否存在父记录时会产生成本。您仍然可以访问父记录（假设您在子表中有一个 parentID 列，只是没有参照完整性）。

# c# - 使用自定义属性

> ID：921901
> 
> 赞同：0
> 
> 时间：2009-05-28T16:37:08.573
> 
> 标签：c#, linq, custom-attributes

我正在观看有关 [LINQ][1] 的视频并遇到了一个问题。在此视频中，Mike 使用了一些自定义属性作为数据库名称，这对我不起作用。

我的代码（效果很好）：

```
class MyContext : DataContext
{
    public MyContext(string conStr) : base(conStr)
    {
    }
}

class Program
{
    static void Main(string[] args)
    {
        MyContext ctx = new MyContext("server=.;database=AdventureWorks;Integrated Security=SSPI");
        Console.WriteLine(ctx.Connection.ConnectionString);
        ctx.ExecuteCommand("insert into _table (a, b) select {0}, {1}", "5", "B");

        Console.WriteLine("That's it!");
        Console.ReadLine();
    }
} 
```

我希望它是怎样的（注意在创建对象 ctx 时缺少数据库参数，以及 MyContext 类之前数据库名称的附加自定义属性）：

```
[Database(Name="AdventureWorks")]
class MyContext : DataContext
{
    public MyContext(string conStr) : base(conStr)
    {
    }
}

class Program
{
    static void Main(string[] args)
    {
        MyContext ctx = new MyContext("server=.;Integrated Security=SSPI");
        Console.WriteLine(ctx.Connection.ConnectionString);
        ctx.ExecuteCommand("insert into _table (a, b) select {0}, {1}", "5", "B");

        Console.WriteLine("That's it!");
        Console.ReadLine();
    }
} 
```

这会引发异常“无效的对象名称 _table”，就像我不会定义任何数据库名称一样。我错过了什么吗？这是我第一次使用自定义属性，...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T16:47:14.857

您仍然需要阅读该属性。您必须使用反射来解析 myContextConstructor 中的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T16:56:15.197

查看使用设计器从 VS 创建的上下文，它在类中有一个静态成员：

```
private static System.Data.Linq.Mapping.MappingSource mappingSource = new AttributeMappingSource(); 
```

这里是 Context 类的开头：

```
 [Database(Name = "Blah")]
    public partial class TestDataContext : System.Data.Linq.DataContext
    {

        private static System.Data.Linq.Mapping.MappingSource mappingSource = new AttributeMappingSource();

    #region Extensibility Method Definitions
    partial void OnCreated();
    partial void InsertAdmin(Admin instance);
    partial void UpdateAdmin(Admin instance);
    partial void DeleteAdmin(Admin instance);
    partial void InsertUser(User instance);
    partial void UpdateUser(User instance);
    partial void DeleteUser(User instance);
    #endregion

        public TestDataContext() : 
                base(global::TestStuff.Properties.Settings.Default.FraudAnalystConnectionString, mappingSource)
        {
            OnCreated();
        }

        public TestDataContext(string connection) : 
                base(connection, mappingSource)
        {
            OnCreated();
        }

        public TestDataContext(System.Data.IDbConnection connection) : 
                base(connection, mappingSource)
        {
            OnCreated();
        }

        public TestDataContext(string connection, System.Data.Linq.Mapping.MappingSource mappingSource) : 
                base(connection, mappingSource)
        {
            OnCreated();
        }

        public TestDataContext(System.Data.IDbConnection connection, System.Data.Linq.Mapping.MappingSource mappingSource) : 
                base(connection, mappingSource)
        {
            OnCreated();
        } 
```

那只是构造函数...不是整个类...但是要亲自查看，只需在选择创建 Linq to Sql Classes 模板后从服务器资源管理器中拖动表格即可。

# iphone - 这个错误在 xcode 调试器窗口中意味着什么？

> ID：921905
> 
> 赞同：0
> 
> 时间：2009-05-28T16:38:14.673
> 
> 标签：iphone, xcode

```
[Session started at 2009-05-28 22:36:25 +0600.]
2009-05-28 22:36:29.400 FlashCards[4440:20b] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: '-[UITableViewController loadView] loaded the "indexView" nib but didn't get a UITableView.'
2009-05-28 22:36:29.407 FlashCards[4440:20b] Stack: (
    2517688651,
    2422246971,
    2517688107,
    2517688170,
    818121900,
    816648934,
    816688492,
    816684429,
    816681688,
    817870076,
    837317240,
    837317032,
    837315376,
    837314643,
    2517182914,
    2517189668,
    2517191928,
    829005112,
    829005309,
    816175835,
    816221412,
    9384,
    9238
) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T16:41:24.557

这意味着你有一个 UITableViewController，但它的视图实际上并不是一个 UITableView。前几天有这个。检查控制器的类在接口生成器中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T18:45:56.643

你可以在 gdb 中做

信息符号 9384

关于 cocoawithlove 的非常有用的提示：

[http://cocoawithlove.com/2008/10/debugging-tips-for-objective-c.html](http://cocoawithlove.com/2008/10/debugging-tips-for-objective-c.html)

# c# - 是否可以在 C# 中将两个相似的类函数包装到一个类中？

> ID：921906
> 
> 赞同：2
> 
> 时间：2009-05-28T16:38:30.350
> 
> 标签：c#

我正在使用 C# 中的 SqlConnection 和 AdomdConnection 对象。

SqlConnection 构造自：DbConnection、ICloneable。

AdomdConnection 由：Component、IDbConnection、IDisposable、ICloneable 构成。

我希望我可以使用通用接口或类类型来传递，但这似乎不是一个选项，因为我可以说它们不共享通用类型。

它们都有类似的方法，我需要调用它们，但是因为我将围绕调用它们编写一些逻辑，因为我想将它们包装到它们自己的类中，然后调用该类并让它担心底层类型。

最初，我认为我可以使用这样的东西：

```
public class ConnectionWrapper {
  protected object _Conn;

  public ConnectionWrapper(object Conn) {
   _Conn = Conn;
  }

  public void Open() {
   if (_Conn is SqlConnection) {
    ((SqlConnection) _Conn).Open();
   } else if (_Conn is AdomdConnection) {
    ((AdomdConnection) _Conn).Open();
   }
  }
 } 
```

但我不禁想知道没有更好的方法来做到这一点。

我遇到了 TypeMap 类（参见问题 298976），这将是一种更易读的方法，但我不知道如何使用返回值，但仍然想知道是否有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-28T16:40:30.753

使用[`IDbConnection`](http://msdn.microsoft.com/en-us/library/system.data.idbconnection.aspx)- 这两种类型都通用。

`SqlConnection`继承自`DbConnection`其进而实现`IDbConnection`接口。该接口也由`AdomdConnection`.

因此，您可以使用`IDbConnection`接口来表示这两种类型

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:44:17.750

> SqlConnection 构造自：DbConnection、ICloneable。

是的，它是，但`DBConnection`它本身扩展和实现`Component, IDbConnection, IDisposable`

所以你可以处理这两个对象`IDbConnection`

# web-applications - 您希望/应该监控 Web 应用程序的哪些内容

> ID：921913
> 
> 赞同：2
> 
> 时间：2009-05-28T16:39:37.760
> 
> 标签：web-applications, monitoring, dashboard

在构建 Web 应用程序（不是构建在任何特定框架上）时，我想构建一套“完整”的工具来监控它。

显然有一些很棒的工具可用于监控数据库或 Web 服务器或应用程序服务器......但我想构建一个仪表板，让管理员用户监控系统的整体健康/状态。

我已经注意到以下要监控的事情，但我确信还有更多我可能忽略的事情。

作为记录，有问题的应用程序是建立在 LAMP 堆栈上的，并且只有注册用户（100 - 5,000？）才能访问索引页面之外的页面。其他表格/日志包含（或将包含）报告以下内容所需的数据。

**目前考虑的项目：**

*   用户：（活跃，已注册）
*   业务对象：（计数......例如，联系人数量、帐户数量、托管服务数量）
*   注册：（登陆次数、注册尝试次数、注册成功次数、帐户删除次数）
*   丢失密码：（请求的数量，以及针对哪个用户）
*   登录尝试：（失败次数）（可能是用户 ID，以查看字典攻击是否正在进行）
*   电子邮件：（# 发送（由系统/用户））（例如，如果系统成为垃圾邮件引擎，则捕获）
*   HTTP 404 错误：（错误数，哪些页面）
*   HTTP 500 错误：
*   Hits: (# of IP/Referer, by page)
*   数据库查询：（查询数，表数）

还有什么遗漏或有帮助的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T16:42:09.047

拥有某种错误跟踪系统来记录任何调用的错误或警告。

# c# - C# WPF 中的只读复选框

> ID：921921
> 
> 赞同：21
> 
> 时间：2009-05-28T16:41:24.510
> 
> 标签：c#, wpf, binding, checkbox

我遇到了一个棘手的问题，我想从一个复选框中获得一些稍微不寻常的行为，但似乎无法弄清楚。任何建议都将受到欢迎。我想要的行为是：

1.  CheckBox 已启用并可供用户单击，IsChecked 表示存储在数据结构中的绑定布尔值
2.  用户单击 CheckBox 导致 click 事件触发，但数据结构中的绑定值未更新，并且 CheckBox 的视觉表示未更新，但已禁用以停止进一步单击
3.  点击事件触发消息发送到需要一些时间响应的远程设备
4.  远程设备响应导致数据结构更新为新值，然后绑定更新 isChecked 状态并重新启用 CheckBox 以供进一步单击

我遇到的问题是，虽然 OneWay 数据绑定在单击 CheckBox 时不更新数据结构，但视觉表示确实发生了变化（我认为这很奇怪，IsChecked 现在不应该像指向数据结构）。

我可以反转 Click() 事件中的更改并在那里进行禁用，但这很混乱。我还可以使用数据结构值的 set 属性来设置 isEnabled 值，该值也必然会重新启用 CheckBox，但这似乎也很混乱。

有没有一种干净的方法可以做到这一点？也许使用派生的 CheckBox 类？如何停止更新视觉表示？

谢谢

埃德

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-09-06T04:02:04.300

数据绑定到[IsHitTestVisible](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/c66f5138-3afc-4419-9dbc-bba2c89bfc69)属性怎么样？

例如，假设一个 MVVM 方法：

1.  将*IsReadOnly*属性添加到您的视图模型，最初设置为 true 以允许单击。
2.  将此属性绑定到 CheckBox.IsHitTestVisible。
3.  第一次单击后，更新您的视图模型以将此值设置为 false，以防止任何进一步的单击。

我没有这个确切的要求，我只需要一个始终只读的复选框，它似乎很好地解决了这个问题。另请注意下面 Goran 关于*Focusable*属性的评论。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2019-11-21T10:56:05.460

这个答案不是你的问题，但它回答了标题中的问题。

WPF 中的复选框没有该`IsReadOnly`属性。但是，类似的行为是通过使用属性 `IsHitTestVisible="False"`和`Focusable="False"`

```
 <CheckBox IsHitTestVisible="False"
                Focusable="False"/> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-28T17:24:08.183

我认为没有必要为此创建一个完整的控件。您遇到的问题来自这样一个事实，即您看到“支票”的地方实际上并不是复选框，而是一颗子弹。如果我们查看 CheckBox 的[ControlTemplate](https://stackoverflow.com/questions/921921/a-read-only-checkbox-in-c-wpf)，我们可以看到这是如何发生的（尽管我更喜欢 Blend 模板）。作为其中的一部分，即使您对 IsChecked 属性的绑定设置为 OneWay，它仍会在 UI 中更新，即使它没有设置绑定值。

因此，解决此问题的一种非常简单的方法是仅修改相关复选框的 ControlTemplate。

如果我们使用 Blend 来获取控件模板，我们可以在 ControlTemplate 中看到表示实际复选框区域的 Bullet。

```
 <BulletDecorator SnapsToDevicePixels="true"
                         Background="Transparent">
            <BulletDecorator.Bullet>
                <Microsoft_Windows_Themes:BulletChrome Background="{TemplateBinding Background}"
                                                       BorderBrush="{TemplateBinding BorderBrush}"
                                                       IsChecked="{TemplateBinding IsChecked}"
                                                       RenderMouseOver="{TemplateBinding IsMouseOver}"
                                                       RenderPressed="{TemplateBinding IsPressed}" />
            </BulletDecorator.Bullet>
            <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                              Margin="{TemplateBinding Padding}"
                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                              RecognizesAccessKey="True" />
        </BulletDecorator> 
```

在这里，IsChecked 和 RenderPressed 是实际使“检查”出现的原因，因此要修复它，我们可以从 ComboBox 上的 IsChecked 属性中删除绑定，并使用它来替换 Bullet 的 IsChecked 属性上的 TemplateBinding。

这是一个演示所需效果的小示例，请注意，要保持 Vista CheckBox 外观，需要将 PresentationFramework.Aero dll 添加到项目中。

```
<Window x:Class="Sample.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Microsoft_Windows_Themes="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero"
    Title="Window1"
    Height="300"
    Width="300">
<Window.Resources>
    <SolidColorBrush x:Key="CheckBoxFillNormal"
                     Color="#F4F4F4" />
    <SolidColorBrush x:Key="CheckBoxStroke"
                     Color="#8E8F8F" />
    <Style x:Key="EmptyCheckBoxFocusVisual">
        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate>
                    <Rectangle SnapsToDevicePixels="true"
                               Margin="1"
                               Stroke="Black"
                               StrokeDashArray="1 2"
                               StrokeThickness="1" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="CheckRadioFocusVisual">
        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate>
                    <Rectangle SnapsToDevicePixels="true"
                               Margin="14,0,0,0"
                               Stroke="Black"
                               StrokeDashArray="1 2"
                               StrokeThickness="1" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="CheckBoxStyle1"
           TargetType="{x:Type CheckBox}">
        <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
        <Setter Property="Background"
                Value="{StaticResource CheckBoxFillNormal}" />
        <Setter Property="BorderBrush"
                Value="{StaticResource CheckBoxStroke}" />
        <Setter Property="BorderThickness"
                Value="1" />
        <Setter Property="FocusVisualStyle"
                Value="{StaticResource EmptyCheckBoxFocusVisual}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type CheckBox}">
                    <BulletDecorator SnapsToDevicePixels="true"
                                     Background="Transparent">
                        <BulletDecorator.Bullet>
                            <Microsoft_Windows_Themes:BulletChrome Background="{TemplateBinding Background}"
                                                                   BorderBrush="{TemplateBinding BorderBrush}"
                                                                   RenderMouseOver="{TemplateBinding IsMouseOver}" />
                        </BulletDecorator.Bullet>
                        <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          Margin="{TemplateBinding Padding}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          RecognizesAccessKey="True" />
                    </BulletDecorator>
                    <ControlTemplate.Triggers>
                        <Trigger Property="HasContent"
                                 Value="true">
                            <Setter Property="FocusVisualStyle"
                                    Value="{StaticResource CheckRadioFocusVisual}" />
                            <Setter Property="Padding"
                                    Value="4,0,0,0" />
                        </Trigger>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Foreground"
                                    Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</Window.Resources>
<Grid>
    <StackPanel>
        <CheckBox x:Name="uiComboBox"
                  Content="Does not set the backing property, but responds to it.">
            <CheckBox.Style>
                <Style TargetType="{x:Type CheckBox}">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type CheckBox}">
                                <BulletDecorator SnapsToDevicePixels="true"
                                                 Background="Transparent">
                                    <BulletDecorator.Bullet>
                                        <Microsoft_Windows_Themes:BulletChrome Background="{TemplateBinding Background}"
                                                                               BorderBrush="{TemplateBinding BorderBrush}"
                                                                               RenderMouseOver="{TemplateBinding IsMouseOver}"
                                                                               IsChecked="{Binding MyBoolean}">
                                        </Microsoft_Windows_Themes:BulletChrome>
                                    </BulletDecorator.Bullet>
                                    <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                      Margin="{TemplateBinding Padding}"
                                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                      RecognizesAccessKey="True" />
                                </BulletDecorator>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="HasContent"
                                             Value="true">
                                        <Setter Property="FocusVisualStyle"
                                                Value="{StaticResource CheckRadioFocusVisual}" />
                                        <Setter Property="Padding"
                                                Value="4,0,0,0" />
                                    </Trigger>
                                    <Trigger Property="IsEnabled"
                                             Value="false">
                                        <Setter Property="Foreground"
                                                Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </CheckBox.Style>
        </CheckBox>

        <TextBlock Text="{Binding MyBoolean, StringFormat=Backing property:{0}}" />

        <CheckBox IsChecked="{Binding MyBoolean}"
                  Content="Sets the backing property." />
    </StackPanel>
</Grid>
</Window> 
```

以及后面的代码，以及我们支持的布尔值：

```
public partial class Window1 : Window, INotifyPropertyChanged
{
    public Window1()
    {
        InitializeComponent();

        this.DataContext = this;
    }
    private bool myBoolean;
    public bool MyBoolean
    {
        get
        {
            return this.myBoolean;
        }
        set
        {
            this.myBoolean = value;
            this.NotifyPropertyChanged("MyBoolean");
        }
    }

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(String info)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(info));
        }
    }

    #endregion
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-01-23T19:15:31.730

对于 Checkbox/RadioButton，我还需要关闭 AutoCheck 功能，我想在不自动检查控件的情况下处理 Click 事件。我在这里和其他线程上尝试了各种解决方案，但对结果不满意。

所以我深入研究了 WPF 正在做什么（使用反射），我注意到：

1.  CheckBox 和 RadioButton 都继承自 ToggleButton 控件原语。它们都没有 OnClick 功能。
2.  ToggleButton 继承自 ButtonBase 控件原语。
3.  ToggleButton 覆盖 OnClick 函数并执行以下操作： this.OnToggle(); base.OnClick();
4.  ButtonBase.OnClick 执行 'base.RaiseEvent(new RoutedEventArgs(ButtonBase.ClickEvent, this));'

所以基本上，我需要做的就是覆盖 OnClick 事件，不要调用 OnToggle，然后执行 base.RaiseEvent

这是完整的代码（请注意，这也可以很容易地修改为 RadioButtons）：

```
using System.Windows.Controls.Primitives;

public class AutoCheckBox : CheckBox
{

    private bool _autoCheck = false;
    public bool AutoCheck {
        get { return _autoCheck; }
        set { _autoCheck = value; }
    }

    protected override void OnClick()
    {
        if (_autoCheck) {
            base.OnClick();
        } else {
            base.RaiseEvent(new RoutedEventArgs(ButtonBase.ClickEvent, this));
        }
    }

} 
```

我现在有一个不会自动检查的 CheckBox，并且仍然会触发 Click 事件。另外，当我以编程方式更改 IsChecked 属性时，我仍然可以订阅 Checked/Unchecked 事件并在那里处理事情。

最后一点：与在 Click 事件中执行 IsChecked != IsChecked 之类的其他解决方案不同，在您以编程方式设置 IsChecked 属性之前，这不会导致 Checked/Unchecked/Indeterminate 事件触发。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-09-16T05:07:57.047

这是我编写的用于执行类似操作的类，出于类似的原因（仍然照常引发所有 Click 和 Command 事件，但默认情况下不会更改绑定源并且不会自动切换。不幸的是它仍然有点击时动画淡入，如果点击处理代码最终没有改变 IsChecked，这有点奇怪。

```
public class OneWayCheckBox : CheckBox
{
    private class CancelTwoWayMetadata : FrameworkPropertyMetadata
    {
        protected override void Merge(PropertyMetadata baseMetadata,
                                      DependencyProperty dp)
        {
            base.Merge(baseMetadata, dp);

            BindsTwoWayByDefault = false;
        }
    }

    static OneWayCheckBox()
    {
        // Remove BindsTwoWayByDefault
        IsCheckedProperty.OverrideMetadata(typeof(OneWayCheckBox),
                                           new CancelTwoWayMetadata());
    }

    protected override void OnToggle()
    {
        // Do nothing.
    }
} 
```

用法：

```
<yourns:OneWayCheckBox IsChecked="{Binding SomeValue}"
                       Command="{x:Static yourns:YourApp.YourCommand}"
                       Content="Click me!" /> 
```

（请注意，IsChecked 绑定现在默认是单向的；如果需要，您可以将其声明为 TwoWay，但这会导致部分问题。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-03T08:23:22.343

迟到的答案，但我只是遇到了寻找其他东西的问题。你想要的根本不是一个行为异常的复选框，你想要的是一个外观不寻常的按钮。更改控件的外观总是比更改其行为更容易。这些方面的事情应该做（未经测试）

```
<Button Command="{Binding CommandThatStartsTask}">
    <Button.Template>
        <ControlTemplate>
            <CheckBox IsChecked="{Binding PropertySetByTask, Mode=OneWay}" />
        </ControlTemplate>
    </Button.Template>
</Button> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-07T18:45:30.720

我一直在尝试创建我的通用 ReadOnlyCheckBox 样式/模板，但我在绑定到数据时遇到了问题。在示例中，您直接绑定到 ControlTemplate 定义中的数据，但这当然不是我真正想要的，因为我希望能够像这样声明新的复选框：

```
 <CheckBox x:Name="uiComboBox" Content="Does not set the backing property, but responds to it."
Style="{StaticResource ReadOnlyCheckBoxStyle}" IsChecked="{Binding MyBoolean}"  Click="uiComboBox_Click"/> 
```

当然，当我这样做然后将项目符号上的事件触发器设置为 IsChecked 的 TemplateBinding 时，我完全拥有我开始的内容！我想我不明白为什么直接在项目符号中设置绑定与设置 IsChecked 然后绑定到它不同，TemplateBinding 不只是引用正在创建的控件的属性中设置的内容的一种方式吗？即使数据没有更新，点击如何触发 UI 更新？是否有 Click I can override 的触发器来停止更新？

我得到了所有 DictionaryResource 的东西工作正常，所以我很高兴，为指针欢呼。

我很好奇的另一件事是是否可以通过在样式中使用 BasedOn 参数来减少我的 Control/Style 模板，那么我只会覆盖我实际需要更改的东西，而不是声明很多我认为的东西无论如何都是标准模板的一部分。我可能会玩这个。

干杯

编

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-29T05:13:20.797

当您不希望它时，使用验证来阻止布尔值被切换 - [http://www.codeproject.com/KB/WPF/wpfvalidation.aspx](http://www.codeproject.com/KB/WPF/wpfvalidation.aspx)

这比其他答案或钩住 Clicked 要少得多

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-08-31T13:01:54.407

如果它对任何人有帮助，我发现的一个快速而优雅的解决方案是挂钩 Checked 和 Unchecked 事件并根据您的标志操纵值。

> ```
>  public bool readOnly = false;
> 
>     private bool lastValidValue = false;
> 
>     public MyConstructor()
>     {
>         InitializeComponent();
> 
>         contentCheckBox.Checked += new
>         RoutedEventHandler(contentCheckBox_Checked);
>         contentCheckBox.Unchecked += new
>         RoutedEventHandler(contentCheckBox_Checked);
>     }
> 
>     void contentCheckBox_Checked(object sender, RoutedEventArgs e)
>     {
>         if (readOnly)
>             contentCheckBox.IsChecked = lastValidValue;
>         else
>             lastValidValue = (bool)contentCheckBox.IsChecked;
>     } 
> ```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-03-21T15:43:48.093

将 CheckBox 包装在 ContentControl 中。使 ContentControl IsEnabled=False

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2018-08-20T07:15:00.303

这两个属性是 – IsHitTestVisible 和 Focusable 将这两个属性设为 False。这使得 WPF 中的只读复选框。因此 WPF 中只读复选框的最终 XAML 语句如下所示：

# python - Python 和 Qt - 函数重载

> ID：921929
> 
> 赞同：0
> 
> 时间：2009-05-28T16:42:12.060
> 
> 标签：python, function, reloading

我有一个从 QtGui.QDialog 继承的应用程序类。我必须重新加载显示功能但保存功能。我从 C# 中得到这个想法。在那里我可以做这样的事情：

```
static void show()
{
  // My code...
  base.show();
} 
```

我想做类似的事情，但使用 python 和 qt (PyQt)。我可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T17:00:09.887

检查[super()](http://docs.python.org/dev/library/functions.html#super)函数，但请注意一些[陷阱](http://www.artima.com/weblogs/viewpost.jsp?thread=236275)。

# amazon-web-services - 是否所有云（例如 AWS）仍然过于“公开”，无法供内部企业使用？

> ID：921930
> 
> 赞同：2
> 
> 时间：2009-05-28T16:42:14.337
> 
> 标签：amazon-web-services, cloud

我们将 AWS 用作一种开发者游乐场 --- 打开服务器以测试应用程序部署，并使用各种非生产数据执行，然后再次将其关闭。

我们还使用 AWS 作为 TFS 的主机。（因为不知何故我们的源代码“不是生产数据” 总而言之，它很棒，我会推荐它用于公司工作，但这个想法似乎在这里没有任何吸引力。企业非常不愿意把他们的数据“线外”

AWS 及其竞争对手缺少什么使其成为适合私人合作使用的环境。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T17:25:30.333

IMO EC2 非常适合企业使用 - 只要您在发生中断时将所有关键数据备份到场外，无论如何您都希望为内部系统这样做。亚马逊强制执行的最低安全级别远高于许多传统托管服务提供商提供的安全级别，也高于我合作过的许多内部商店。由于您拥有对操作系统的完全访问权限，因此您可以添加任意多的额外安全级别。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T16:47:21.237

Ubuntu 提供了一个云解决方案，如果管理层担心信息会超出企业防火墙之外，您可以在您的网络中运行该解决方案。

详细信息可在以下网址找到：[http ://www.ubuntu.com/products/whatisubuntu/serveredition/cloud](http://www.ubuntu.com/products/whatisubuntu/serveredition/cloud)

从他们的网站：

> Ubuntu Enterprise Cloud 在防火墙内带来了类似 Amazon EC2 的基础设施功能。Ubuntu Enterprise Cloud 由 Eucalyptus 提供支持，Eucalyptus 是 EC2 新兴标准的开源实现。该解决方案旨在简化为任何规模的企业构建和管理内部云的过程，从而使公司能够创建自己的自助服务基础架构。

# sql - 为什么插入和加入 #temp 表更快？

> ID：921931
> 
> 赞同：14
> 
> 时间：2009-05-28T16:42:23.883
> 
> 标签：sql, sql-server, sql-server-2005, tsql

我有一个看起来像的查询

```
SELECT
 P.Column1,
 P.Column2,
 P.Column3,
 ...
 (
   SELECT
       A.ColumnX,
       A.ColumnY,
       ...
   FROM
      dbo.TableReturningFunc1(@StaticParam1, @StaticParam2) AS A
   WHERE
      A.Key = P.Key
   FOR XML AUTO, TYPE  
 ),
 (
   SELECT
       B.ColumnX,
       B.ColumnY,
       ...
   FROM
      dbo.TableReturningFunc2(@StaticParam1, @StaticParam2) AS B
   WHERE
      B.Key = P.Key
   FOR XML AUTO, TYPE  
 )
FROM
(
   <joined tables here>
) AS P
FOR XML AUTO,ROOT('ROOT') 
```

P 有 ~ 5000 行 A 和 B ~ 4000 行

此查询的运行时性能约为 10 分钟以上。

但是将其更改为：

```
SELECT
 P.Column1,
 P.Column2,
 P.Column3,
 ...
INTO #P

SELECT
 A.ColumnX,
 A.ColumnY,
 ...
INTO #A     
FROM
 dbo.TableReturningFunc1(@StaticParam1, @StaticParam2) AS A

SELECT
 B.ColumnX,
 B.ColumnY,
 ...
INTO #B     
FROM
 dbo.TableReturningFunc2(@StaticParam1, @StaticParam2) AS B

SELECT
 P.Column1,
 P.Column2,
 P.Column3,
 ...
 (
   SELECT
       A.ColumnX,
       A.ColumnY,
       ...
   FROM
      #A AS A
   WHERE
      A.Key = P.Key
   FOR XML AUTO, TYPE  
 ),
 (
   SELECT
       B.ColumnX,
       B.ColumnY,
       ...
   FROM
      #B AS B
   WHERE
      B.Key = P.Key
   FOR XML AUTO, TYPE  
 )
FROM #P AS P
FOR XML AUTO,ROOT('ROOT') 
```

性能约为 4 秒。

这没有多大意义，因为默认情况下插入临时表然后执行连接的成本似乎更高。我的倾向是 SQL 对子查询执行了错误的“连接”类型，但也许我错过了它，无法指定用于相关子查询的连接类型。

有没有办法通过索引和/或提示不使用#temp 表/@table 变量来实现这一点？

编辑：请注意 dbo.TableReturningFunc1 和 dbo.TableReturningFunc2 是内联 TVF，而不是多语句，或者它们是“参数化”视图语句。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-28T16:45:44.627

您的程序正在重新评估中的每一行`P`。

您对临时表所做的实际上是缓存存储过程生成的结果集，从而无需重新评估。

插入临时表很快，因为它不会生成`redo`/ `rollback`。

连接也很快，因为有一个稳定的结果集允许使用一个`Eager Spool`或一个创建一个临时索引`Worktable`

您可以使用 's 重用没有临时表的过程`CTE`，但为了有效，`SQL Server`需要具体化`CTE`.

您可以*尝试*使用`ORDER BY`内部子查询来强制它执行此操作：

```
WITH    f1 AS
        (
        SELECT  TOP 1000000000
                A.ColumnX,
                A.ColumnY
        FROM    dbo.TableReturningFunc1(@StaticParam1, @StaticParam2) AS A
        ORDER BY
                A.key
        ),
        f2 AS
        (
        SELECT  TOP 1000000000
                B.ColumnX,
                B.ColumnY,
        FROM    dbo.TableReturningFunc2(@StaticParam1, @StaticParam2) AS B  
        ORDER BY
                B.Key
        )
SELECT  … 
```

，这可能会导致`Eager Spool`优化器生成。

但是，这远不能得到保证。

有保证的方法是在`OPTION (USE PLAN)`您的查询中添加一个并将对应的包装`CTE`到`Spool`子句中。

请参阅我的博客中的此条目以了解如何执行此操作：

*   [**在子查询中生成 XML**](http://explainextended.com/2009/05/28/generating-xml-in-subqueries/)

这很难维护，因为每次重写查询时都需要重写计划，但这很好用并且非常有效。

不过，使用临时表会容易得多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-02-21T02:53:54.087

[此答案需要与 Quassnoi 的文章http://explainextended.com/2009/05/28/generating-xml-in-subqueries/](http://explainextended.com/2009/05/28/generating-xml-in-subqueries/)一起阅读

通过 CROSS APPLY 的明智应用，您可以强制内联 TVF 的缓存或快捷方式评估。此查询立即返回。

```
SELECT  *
FROM    (
        SELECT  (
                SELECT  f.num
                FOR XML PATH('fo'), ELEMENTS ABSENT
                ) AS x
        FROM    [20090528_tvf].t_integer i
        cross apply (
            select num
            from [20090528_tvf].fn_num(9990) f
            where f.num = i.num
            ) f
) q
--WHERE   x IS NOT NULL -- covered by using CROSS apply
FOR XML AUTO 
```

您还没有提供真实的结构，因此很难构建有意义的东西，但该技术也应该适用。

如果将 Quassnoi 文章中的多语句 TVF 更改为内联 TVF，则计划会变得更快（至少一个数量级），并且计划会神奇地简化为我无法理解的东西（太简单了！）。

```
CREATE FUNCTION [20090528_tvf].fn_num(@maxval INT)  
RETURNS TABLE
AS RETURN 
        SELECT  num + @maxval   num
        FROM    t_integer 
```

统计数据

```
SQL Server parse and compile time: 
   CPU time = 0 ms, elapsed time = 0 ms.

(10 row(s) affected)
Table 't_integer'. Scan count 2, logical reads 22, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.

 SQL Server Execution Times:
   CPU time = 0 ms,  elapsed time = 2 ms. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T17:02:35.123

这是您的子查询引用您的外部查询的问题，这意味着必须为外部查询中的*每一行*编译和执行子查询。您可以使用派生表，而不是使用显式临时表。为了简化您的示例：

```
SELECT P.Column1,
       (SELECT [your XML transformation etc] FROM A where A.ID = P.ID) AS A 
```

如果 P 包含 10,000 条记录，则 SELECT A.ColumnX FROM A where A.ID = P.ID 将被执行 10,000 次。
您可以改为使用派生表，如下所示：

```
SELECT P.Column1, A2.Column FROM  
P LEFT JOIN 
 (SELECT A.ID, [your XML transformation etc] FROM A) AS A2 
 ON P.ID = A2.ID 
```

好吧，不是那个说明性的伪代码，但基本思想与临时表相同，只是 SQL Server 在内存中完成了整个事情：它首先选择“A2”中的所有数据并在内存中构造一个临时表，然后加入它。这样您就不必自己选择它来进行 TEMP。

只是在另一个可能更直接有意义的情况下为您提供该原则的示例。考虑员工和缺勤信息，您希望在其中显示每位员工记录的缺勤天数。

**坏：（**运行与数据库中的员工一样多的查询）

```
SELECT EmpName, 
 (SELECT SUM(absdays) FROM Absence where Absence.PerID = Employee.PerID) AS Abstotal        
FROM Employee 
```

**好：（**只运行两个查询）

```
SELECT EmpName, AbsSummary.Abstotal
FROM Employee LEFT JOIN
      (SELECT PerID, SUM(absdays) As Abstotal 
       FROM Absence GROUP BY PerID) AS AbsSummary
ON AbsSummary.PerID = Employee.PerID 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T20:46:05.017

使用中间 Temp 表可能会加快查询速度有几个可能的原因，但在您的情况下，最有可能的是正在调用的函数（但未列出）可能是多语句 TVF，而不是内联 TVF . 多语句 TVF 对其调用查询的优化是不透明的，因此优化器无法判断是否有任何机会重用数据或其他逻辑/物理运算符重新排序优化。因此，它所能做的就是在每次包含查询应该生成具有 XML 列的另一行时重新执行 TVF。

简而言之，多语句 TVF 会挫败优化器。

通常的解决方案，按（典型）偏好的顺序是：

1.  将有问题的多语句 TVF 重写为内联 TVF
2.  将函数代码内嵌到调用查询中，或
3.  将有问题的 TVF 数据转储到临时表中。这就是你所做的......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T17:12:27.037

考虑将`WITH common_table_expression`结构用于您现在拥有的子选择或临时表，请参阅[http://msdn.microsoft.com/en-us/library/ms175972(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms175972(SQL.90).aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T20:00:20.317

> 这没有多大意义，因为插入临时表然后进行连接的成本似乎应该更高 de> 这没有多大意义，因为插入临时表的成本似乎更高默认情况下，表然后执行连接应该更高。错误。

使用临时表，您可以明确指示 Sql Server 使用哪个中间存储。但是，如果您将所有内容都存储在一个大查询中，Sql Server 将自行决定。差异并不是那么大。在一天结束时，无论您是否将其指定为临时表，都会使用临时存储。

在您的情况下，临时表工作得更快，那么为什么不坚持使用它们呢？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-27T05:55:14.367

我同意，临时表是一个好概念。当表中的行数增加时，例如 4000 万行，我想通过应用与其他表的连接来更新表上的多个列，在这种情况下，我总是更喜欢使用通用表表达式来更新 select 语句中的列case 语句，现在我的 select 语句结果集包含更新的行。使用 case 语句使用 select 语句将 4000 万条记录插入临时表对我来说需要 21 分钟，然后创建索引需要 10 分钟，所以我的插入和索引创建时间需要 30 分钟. 然后我将通过将临时表更新的结果集与主表连接来应用更新。更新 4000 万条记录中的 1000 万条记录需要 5 分钟，因此我对 1000 万条记录的总体更新时间几乎是 35 分钟，而 Common table 表达式需要 5 分钟。在这种情况下，我的选择是公用表表达式。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-05-28T21:03:42.047

If temp tables turn out to be faster in your particular instance, you should instead use a table variable.

There is a good article here on the differences and performance implications:

[http://www.codeproject.com/KB/database/SQP_performance.aspx](http://www.codeproject.com/KB/database/SQP_performance.aspx)

# calendar - 将 MOSS 日历 Web 部件链接到共享 Exchange 日历

> ID：921932
> 
> 赞同：0
> 
> 时间：2009-05-28T16:42:39.907
> 
> 标签：calendar, web-parts, moss

是否可以将 MOSS 日历 Web 部件链接到共享的 Outlook/Exchange 日历，以便两者都反映更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T16:44:13.193

您可以链接日历本身，您是否尝试仅链接 Web 部件中显示的视图？

# c# - 从 C# 中的打开文件对话框中排除文件扩展名

> ID：921937
> 
> 赞同：5
> 
> 时间：2009-05-28T16:43:50.900
> 
> 标签：c#, visual-studio, openfiledialog

我试图在我的 C# openFileDialog 上放置一个过滤器，排除某些文件扩展名。例如，我希望它显示目录中不是 .txt 文件的所有文件。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T16:51:34.707

我不认为这是可能的。过滤器的设置方式是您可以选择要显示的文件，但我认为没有办法显示“除...之外的所有文件”。想一想，你有没有在 Windows 中看到有这个的打开文件对话框？我想我从来没有见过。

您最好的选择是让他们选择所有文件，然后提示用户他们是否选择了不允许的文件，或者将其过滤到您可以处理的所有可能文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:52:16.500

使用 BCL OpenFileDialog 没有直接的方法来执行此操作。

我可以想到几个选项：

1）制作一个过滤器，其中包含您想要支持的所有类型。这是我的建议，因为这是进行此类操作的最常见方式。

2) 使用与此[自定义 OpenFileDialog 实现](http://www.codeproject.com/KB/dialog/OpenFileDialogEx.aspx?fid=356223&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=26)类似的东西。然后，如果所选文件具有 .txt 扩展名，您可以覆盖 OnFileNameChanged() 方法以禁用“打开”按钮。

3) 让用户选择一个 .txt 文件，抛出一个错误对话框，然后重新打开文件对话框。不过，这对我来说感觉很笨重，而且不太好......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T16:46:25.373

[通过 Google 搜索“OpenFileDialog”找到](http://en.csharp-online.net/Select_a_file_with_OpenFileDialog)

编辑：很抱歉没有扩展 EXCLUDE 方面。你可能不需要走到这个极端，但它会满足你的需求......

*   对用户可以选择的所有文件进行递归目录搜索。（希望这是一小组文件夹。）
*   唯一标识这些文件的扩展名。（System.IO.Path.GetExtension() 和 Linq 的 .Distint() 方法在这里可能很好用）
*   从列表中删除“.txt”条目。
*   通过循环这些扩展来构造一个过滤器字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T16:55:16.493

恐怕这是不可能的。你要么必须

*   a) 包括一长串应允许的所有扩展名，或

*   b) 允许所有扩展名，然后使用简单的签入代码重新打开对话框，如果所选文件具有扩展名`.txt`.

另外，您能否为这个问题提供更多背景信息？我无法设想一个我可能明确需要*排除*某个扩展名的场景。在几乎所有情况下，您可能无法仅使用过滤器（也许还有一点代码检查）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T17:34:54.637

这是一种完全不同的方法，您不太可能使用。

不要使用 OpenFileDialog，而是分析您需要的特定功能并创建您自己的对话框。您可以轻松地提供您想要的任何过滤，但随后困难转移到实施和维护新 UI。

我不建议您这样做，但有时用户会坚持他们需要什么。

另一种选择：不要使用对话框，而是想出完全不同的东西，非常适合应用程序。这可能是不可能的，但是我们对应用程序知之甚少。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-29T02:18:32.520

您不能设置过滤器以从文件对话框中**排除扩展名。**

`FileOk`但是，您可以在对话框上为事件实现委托。此事件在用户选择的文件将被接受之前触发，并且事件参数提供了一个`Cancel`您可以设置为禁止选择的属性。

它不像实际上使错误的文件不可见那样优雅，但它允许您禁止选择错误的文件类型。

PS：不要忘记向用户反馈文件不被接受的原因，否则他们可能会想知道为什么当他们选择“txt”文件时对话框没有关闭。

# javascript - jquery 查找所有精确的 td 匹配项

> ID：921940
> 
> 赞同：8
> 
> 时间：2009-05-28T16:45:05.720
> 
> 标签：javascript, jquery

```
$('#servertable td:eq(' + server + ')') 
```

这仅找到 1 个（我认为首先）匹配，如何找到所有匹配项。顺便提一句。td:contains 对我不起作用。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-28T17:43:52.340

`eq`期望数字索引只返回一行。如果你想通过它的内容来匹配一个 td，你必须使用[:contains](http://docs.jquery.com/Selectors/contains#text)选择器。说“它不起作用”并把它扔掉并不是解决问题的正确方法，因为选择器（很可能）没有错（请注意它的大小写敏感，可能是它......）

无论如何，如果您有这样的表：

```
<table>
  <tr>
    <td>Hello</td>
    <td>World</td>
  </tr>
  <tr>
    <td>World</td>
    <td>Hello</td>
  </tr>
  <tr>
    <td>Hello</td>
    <td>Hello</td>
  </tr>
</table> 
```

这个 jQuery 代码：

```
$(function() {
    $("td:contains('Hello')").css('color','red');
}); 
```

将所有带有“Hello”的单元格变为红色。[演示](http://jsbin.com/uzoxi)。

如果您需要不区分大小写的匹配，您可以使用以下[`filter`](http://docs.jquery.com/Traversing/filter)函数执行此操作：

```
$(function() {
    var search = 'HELLO'.toLowerCase();
    $("td").filter(function() {
        return $(this).text().toLowerCase().indexOf(search) != -1;
    }).css('color','red');
}); 
```

如果您需要匹配单元格的*确切*内容，您可以使用类似于上面的内容：

```
$(function() {
    var search = 'HELLO'.toLowerCase();
    $("td").filter(function() {
        return $(this).text().toLowerCase() == search;
    }).css('color','red');
}); 
```

以上是不区分大小写的（通过在比较时将搜索和内容都变为小写），否则如果您想要区分大小写，您可以删除它们。[演示](http://jsbin.com/ofeca)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T17:38:06.407

我可能是错的，但[:eq 位置选择器](http://docs.jquery.com/Core/eq)采用整数*n*并找到第*n 个*匹配元素。

因此，如果您说 td:eq(1) - 您将获得表中的第二个 TD 元素（第二个，因为第一个索引为零/0）。

我的猜测是您不想使用[:contains 选择器](http://docs.jquery.com/Selectors/contains)，因为您正在寻找完全匹配的字符串并且不想要部分匹配。

我不知道 jquery 有一个内置的选择器可以满足您的需求（如果是，请纠正我）。您可以添加一个作为扩展名或使用另一种方法，例如属性选择器来为您进行搜索。

如果您能够控制生成的 HTML，则可以向每个 TD 添加一个 ID 属性，如下所示：

```
 <table id="servertable" border="1">
        <thead>
            <tr><th>Server</th><th>Memory</th></tr>
        </thead>
        <tbody>
            <tr><td id="server_mars">Mars</td><td>4 GB</td></tr>
            <tr><td id="server_venus">Venus</td><td>1 GB</td></tr>
            <tr><td id="server_jupiter">Jupiter</td><td>2 GB</td></tr>
            <tr><td id="server_uranus">Uranus</td><td>8 GB</td></tr>
            <tr><td id="server_mars_2010">Mars_2010</td><td>4 GB</td></tr>
        </tbody>
    </table>
    <form>
        <label for="server">Find:</label><input type="text" id="server" />
        <button id="find">Find</button>
    </form> 
```

以下属性选择器将在表中找到正确的 TD：

```
 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
   <script type="text/javascript">
    $(document).ready(function() {
        $("#find").click(function() {
            var server = $("#server").val();
            $("#servertable td").css("background-color", "");  // reset 
            $("#servertable td[id='server_" + server.toLowerCase() + "']").css("background-color", "#FFFF00");  
            return false;
        });
    });
   </script> 
```

如果您想要定位具有您正在寻找的 TD 的整个行，您可以添加其他选择器：

```
 $("#servertable tbody tr").css("background-color", "");
      $("#servertable tbody tr:has(td[id='server_" + server.toLowerCase() + "'])").css("background-color", "#FFFF00"); 
```

tbody 标签并不是完全必要的，它只是帮助区分表体中的行和表头中的行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-09T17:15:16.957

试试 :containsExact

[http://wowmotty.blogspot.com/2010/05/jquery-selectors-adding-contains-exact.html](http://wowmotty.blogspot.com/2010/05/jquery-selectors-adding-contains-exact.html)

```
 $.extend( $.expr[":"], {
 containsExact: $.expr.createPseudo ?
  $.expr.createPseudo(function(text) {
   return function(elem) {
    return $.trim(elem.innerHTML.toLowerCase()) === text.toLowerCase();
   };
  }) :
  // support: jQuery <1.8
  function(elem, i, match) {
   return $.trim(elem.innerHTML.toLowerCase()) === match[3].toLowerCase();
  },

 containsExactCase: $.expr.createPseudo ?
  $.expr.createPseudo(function(text) {
   return function(elem) {
    return $.trim(elem.innerHTML) === text;
   };
  }) :
  // support: jQuery <1.8
  function(elem, i, match) {
   return $.trim(elem.innerHTML) === match[3];
  },

 containsRegex: $.expr.createPseudo ?
  $.expr.createPseudo(function(text) {
   var reg = /^\/((?:\\\/|[^\/]) )\/([mig]{0,3})$/.exec(text);
   return function(elem) {
    return RegExp(reg[1], reg[2]).test($.trim(elem.innerHTML));
   };
  }) :
  // support: jQuery <1.8
  function(elem, i, match) {
   var reg = /^\/((?:\\\/|[^\/]) )\/([mig]{0,3})$/.exec(match[3]);
   return RegExp(reg[1], reg[2]).test($.trim(elem.innerHTML));
  }

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T16:47:24.280

```
$('#servertable td') 
```

将找到所有 td 元素，但并不完全清楚您的期望。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-17T21:28:28.027

我也遇到了和原作者一样的问题。正如保罗最初的问题提出者一样。我可以使用哪个选择器来匹配基于元素内容的相等性检查的元素。至少我认为这就是他所做的（就像我一样）试图实现的目标，这也可以解释为什么他（以及我）不能使用包含，因为 ra170 在他的评论中指出的明显原因。无论如何，如果有人碰巧在这里寻找该问题的答案，这里是它的简短答案：

jQuery 默认没有这样的匹配器。解决方案是定义自己的匹配器。要解决手头的问题，请参阅 Motte 的这篇出色的博客[文章](http://wowmotty.blogspot.com/2010/05/jquery-selectors-adding-contains-exact.html)。

# javascript - JavaScript REST 客户端库

> ID：921942
> 
> 赞同：118
> 
> 时间：2009-05-28T16:45:57.543
> 
> 标签：javascript, jquery, rest

是否有一个 JavaScript 库可以让我执行所有的 REST 操作，比如（`GET`、、over或）？`POST``PUT``DELETE``HTTP``HTTPS`

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2009-05-28T17:19:34.417

您实际上并不需要特定的客户端，大多数库都相当简单。例如，在 jQuery 中，您可以`$.ajax`使用您想要发出的请求类型调用泛型函数：

```
$.ajax({
    url: 'http://example.com/',
    type: 'PUT',
    data: 'ID=1&Name=John&Age=10', // or $('#myform').serializeArray()
    success: function() { alert('PUT completed'); }
}); 
```

您可以`PUT`用`GET`/ `POST`/`DELETE`或其他任何东西替换。

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2009-06-02T02:05:39.267

虽然您可能希望使用诸如优秀的[jQuery](http://jquery.com/)之类的库，但您不必这样做：所有现代浏览器都通过[XMLHttpRequest API](http://en.wikipedia.org/wiki/XMLHttpRequest)在其 JavaScript 实现中很好地支持 HTTP ，尽管它的名称不限于 XML 表示.

下面是在 JavaScript 中发出同步 HTTP PUT 请求的示例：

```
var url = "http://host/path/to/resource";
var representationOfDesiredState = "The cheese is old and moldy, where is the bathroom?";

var client = new XMLHttpRequest();

client.open("PUT", url, false);

client.setRequestHeader("Content-Type", "text/plain");

client.send(representationOfDesiredState);

if (client.status == 200)
    alert("The request succeeded!\n\nThe response representation was:\n\n" + client.responseText)
else
    alert("The request did not succeed!\n\nThe response status was: " + client.status + " " + client.statusText + "."); 
```

这个例子是同步的，因为这使它更容易一些，但使用这个 API 也很容易发出异步请求。

网上有成千上万的关于学习 XmlHttpRequest 的页面和文章——他们通常使用术语 AJAX——不幸的是我不能推荐一个具体的。不过，您可能会发现[此参考资料](http://www.w3.org/TR/XMLHttpRequest/)很方便。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-01-16T14:16:55.603

你可以使用我刚刚制作的这个 jQuery 插件 :) [https://github.com/jpillora/jquery.rest/](https://github.com/jpillora/jquery.rest/)

支持基本 CRUD 操作、嵌套资源、基本身份验证

```
 var client = new $.RestClient('/api/rest/');

  client.add('foo');
  client.foo.add('baz');
  client.add('bar');

  client.foo.create({a:21,b:42});
  // POST /api/rest/foo/ (with data a=21 and b=42)
  client.foo.read();
  // GET /api/rest/foo/
  client.foo.read("42");
  // GET /api/rest/foo/42/
  client.foo.update("42");
  // PUT /api/rest/foo/42/
  client.foo.delete("42");
  // DELETE /api/rest/foo/42/

  //RESULTS USE '$.Deferred'
  client.foo.read().success(function(foos) {
    alert('Hooray ! I have ' + foos.length + 'foos !' );
  }); 
```

如果您发现错误或想要新功能，请将它们发布在存储库的“问题”页面中

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-03-03T12:57:30.280

jQuery 有[JSON-REST](http://plugins.jquery.com/project/Rest)插件，带有 REST 风格的 URI 参数模板。根据其描述的使用示例如下：`$.Read("/{b}/{a}", { a:'foo', b:'bar', c:3 })`变成“/bar/foo?c=3”的GET。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-08-08T06:26:25.610

作为参考，我想添加有关 ExtJS 的信息，如 Manual: [RESTful Web Services](http://www.sencha.com/learn/legacy/Manual:RESTful_Web_Services)中所述。简而言之，使用方法来指定 GET、POST、PUT、DELETE。例子：

```
Ext.Ajax.request({
    url: '/articles/restful-web-services',
    method: 'PUT',
    params: {
        author: 'Patrick Donelan',
        subject: 'RESTful Web Services are easy with Ext!'
    }
}); 
```

如果需要 Accept 标头，可以将其设置为所有请求的默认值：

```
Ext.Ajax.defaultHeaders = {
    'Accept': 'application/json'
}; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-03-10T14:38:53.557

您可以尝试使用与流行的[Restangular](https://github.com/marmelab/restful.js)类似的语法来尝试使用与框架无关的 RESTful 客户端 restful.js。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-02-15T07:21:47.950

您还可以使用诸如 Backbone.js 之类的 mvc 框架来提供数据的 javascript 模型。对模型的更改将转换为 REST 调用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-28T16:53:42.083

Dojo 确实如此，例如通过 JsonRestStore，请参阅[http://www.sitepen.com/blog/2008/06/13/restful-json-dojo-data/](http://www.sitepen.com/blog/2008/06/13/restful-json-dojo-data/)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-18T13:40:48.607

您可以使用[http://adodson.com/hello.js/](http://adodson.com/hello.js/)它有

1.  休息 API 支持
2.  内置支持许多网站 google、facebook、dropbox
3.  它支持 oAuth 1 和 2 支持。

# sql-server - SQL Server 2005+ 对象加密的缺点？

> ID：921943
> 
> 赞同：1
> 
> 时间：2009-05-28T16:45:59.697
> 
> 标签：sql-server, encryption

对于远程部署产品附带的数据库，通过 MS SQL Server 2005 和 2008 中的 WITH ENCRYPTION 子句加密所有代码对象（过程、函数、视图）是否有任何缺点？

其优点是阻止该领域的“定制”变化，这些变化解决了一个需求，同时创造了更多。目标不是保护 IP 或数据，而是在无法管理更改对象的权利时帮助防止未经授权的代码更改（安全性不在开发人员手中，但修复他人引起的问题的责任是）。

采用这种方法可能会导致哪些新问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T17:09:04.687

Microsoft 专门为此目的创建了此功能。我能看到的唯一缺点是保护很弱；它可以被公开可用的脚本规避，并且可以使用 SQL Profiler 查看解密过程的明文。但它仍应起到有效的威慑作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T03:49:25.840

有许多工具可以解密 SQL Server 中的存储过程。有一种名为 SQL Shield 的商用工具可以改变加密机制，使揭示和更改源代码变得更加困难。但是，我必须说加密程序使维护变得更加困难：比较、制作差异等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T17:30:55.940

出于您指出的原因并阻止逆向工程，我们在部署到 200 多个站点的企业产品中实施了加密。

在我们的案例中，麻烦多于其价值。我们的客户从未真正改变过任何东西，这让我们很难在现场调试问题。Profiler 不会为您提供加密所有内容时所需的详细信息。我们经常需要加载 SPROC 等的未加密版本来调试问题。

此外，验证您的架构是否与您期望的版本一致变得更加困难。大多数差异工具无法区分加密对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T20:00:15.093

你走错了路。WITH ENCRYPTION 是 SQL 2000 天以来的一个过时选项。绕过它的方法是众所周知的，任何具有[最低谷歌搜索技能](http://msdn.microsoft.com/en-us/library/ms187926.aspx)的人都可以发现。正确的方法是使用[代码签名](http://msdn.microsoft.com/en-us/library/ms345102.aspx). 最好的方法是创建一个证书，签署程序，然后删除私钥。这样，任何人，甚至你，都可以在不破坏签名的情况下更改代码。这并不妨碍任何人修改程序，但一旦修改，他们就会破坏签名印章并且篡改是显而易见的。您可以更进一步，并确保程序本身无权执行其目的（即无法读取尝试访问的表），但权限来自它们的签名（授予用于签署它们的证书所需的权利）。这样，如果他们篡改代码，不仅会破坏密封，还会导致系统停止。解释这些行动的后果通常是一种足够强大的威慑力。

# moss - 如何决定在 MOSS 网站模板/定义中放入什么

> ID：921948
> 
> 赞同：0
> 
> 时间：2009-05-28T16:46:42.813
> 
> 标签：moss, list, definition

在决定要在 MOSS 站点定义中包含哪些元素（即列表、库等）时，是否有关于如何最好地做出此决定的经验法则？

将不胜感激任何人的建议。

一切顺利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T18:41:29.633

这是我做过几次的事情：

*   复制存在的定义之一。
*   以我需要的方式修改这个副本，删除列表和所有其他我不需要的东西。
*   创建将向站点添加功能的功能。
*   在站点模板中包含这些功能。

我认为功能（和解决方案）比在网站上添加功能的其他东西更好。

# visual-studio-2008 - 并行运行单元测试

> ID：921953
> 
> 赞同：9
> 
> 时间：2009-05-28T16:48:01.593
> 
> 标签：visual-studio-2008

有谁知道是否有办法在 Visual Studio 中并行运行不同的 [TestMethods]？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-12-07T12:28:14.950

几天前，Team Test 团队发布了一篇关于在多 CPU/核心机器上并行执行单元测试的博客文章。您可以在此处阅读您要查找的信息：

[http://blogs.msdn.com/vstsqualitytools/archive/2009/12/01/executing-unit-tests-in-parallel-on-a-multi-cpu-core-machine.aspx](https://web.archive.org/web/20190118141933/https://blogs.msdn.microsoft.com/vstsqualitytools/2009/12/01/executing-unit-tests-in-parallel-on-a-multi-cpucore-machine/)

享受！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:36:46.253

[NUnit 2.5](http://nunit.com/index.php?p=releaseNotes&r=2.5)可以选择支持并行运行单元测试。这与 VS 内置的单元测试框架无关，但可以使用正确的插件在 VS 中运行 NUnit 测试。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-06-03T21:20:07.000

Visual Studio 中的 MSTest 并行运行单元测试。运行测试时 VSTestHost（运行单元测试的进程）在单独的线程上执行每个单元测试。

# sql-server - 从treeview的1000中轻松找到SQL Server Management Studio中的一个存储过程？

> ID：921955
> 
> 赞同：23
> 
> 时间：2009-05-28T16:48:04.230
> 
> 标签：sql-server, ssms

我们的数据库即将达到 1000 个存储过程。尽管我们很明智并为存储过程的命名创建了一个很好的方案，但是在滚动和滚动和滚动时寻找所需的存储过程可能会有点令人沮丧。如果我知道我正在寻找的存储过程的确切名称，那么快速识别并修改它会很棒

例如，如果我想在树形视图中找到 p_Blah_Blah 并打开它进行修改，是否有命令在新窗口中启动 p_Blah_Blah 进行编辑？或者可能是一个插件，它将存储过程的视图限制为您正在搜索的内容？有谁想写插件吗？:)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-28T16:50:38.250

您可以过滤树，右键单击“存储过程”选择“过滤器”和“过滤器设置”。

作为一般规则，我们使用命名约定来处理上下文，例如，所有用户存储过程都被命名：`usp_user_*`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-09T05:13:14.057

在这里查看 redgate 工具，他们有一个免费的搜索工具，让这类东西变得轻而易举：

[http://www.red-gate.com/products/sql-development/sql-search/](http://www.red-gate.com/products/sql-development/sql-search/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T16:52:18.747

在 Management Studio 2005 中，您可以右键单击存储过程文件夹（以及其他文件夹）来设置过滤器，然后您可以输入您要查找的全部或部分名称。

如果您只想了解参数的详细信息（或表的行等），则可以在查询窗口中键入对象名称，突出显示它，然后按 alt-F1 调用对象的 sp_Help。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T16:53:25.967

EXEC sp_HelpText '你的过程名称'

然后继续修改它。

# ajax - 是否有太多 AJAX 之类的东西？由于 AJAX，您如何处理屏幕大小调整？

> ID：921963
> 
> 赞同：1
> 
> 时间：2009-05-28T16:49:31.887
> 
> 标签：ajax, asp.net-ajax

**Q1: 是不是有太多 ajax 之类的东西？**

说明：我一直看到程序员使用 Ajax/jQuery 等，我认为它甚至不需要。我为公司的高级管理人员（年龄 55 岁以上）构建了一个报告工具，并且不得不重构许多页面并实际从中取出 ajaxy 的东西。这些事情是要在需求中处理还是我们正在考虑 AJAX 过度杀伤？

* * *

**Q2：你如何处理屏幕大小调整？**

说明：我有一个具有多级主详细信息功能的页面。您可以将其称为向下钻取接口，该接口也允许 CRUD 操作。在某些情况下，我使用 UpdatePanels。有时由于浏览器重新绘制页面，焦点会丢失。你怎么处理这样的事情？

* * *

如果需要，我可以提供有关 Q2 的更多详细信息。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T16:59:45.673

我认为 Ajax 绝对是太多了。许多开发人员没有意识到它远非免费。您正在使用与服务器的连接，可能会根据服务器保持活动设置从头开始建立新连接。

如果您在服务器上使用 PHP 之类的语言，情况会变得更糟，因为 PHP 必须为每个连接从头开始重新加载代码。

至于失去对屏幕调整大小的关注。你能设置一个记录当前焦点的变量，然后在窗口调整大小时重置焦点吗？

# c# - 如何创建通用 DataContext 工厂？

> ID：921970
> 
> 赞同：0
> 
> 时间：2009-05-28T16:50:55.910
> 
> 标签：c#, linq-to-sql, generics, datacontext

我正在构建一个`Repository<T>`支持 Linq to SQL 的通用类，并且我想为 DataContext 使用工厂模式，因为目前我必须将正确的上下文传递给构造函数。

有谁知道如何确定正确的 DataContext 类型`T`，`T`Linq to Sql 表在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T16:55:24.357

你真的不需要。

只需接收一个 DataContext，您就可以使用`GetTable<T>()`.

# haskell - 什么是 zygo/meta/histo/para/futu/dyna/whatever-morphisms？

> ID：921972
> 
> 赞同：29
> 
> 时间：2009-05-28T16:51:18.297
> 
> 标签：haskell, functional-programming, combinators, category-theory

如果没有广泛的范畴理论知识的人可以访问它们的示例，是否有一个列表？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-28T17:03:27.803

[Bananas、Lenses、Envelopes 和 Barbed Wire (PDF) 的函数式编程](http://eprints.eemcs.utwente.nl/7281/01/db-utwente-40501F46.pdf)也应该有所帮助。这个符号会有点毛茸茸，但读几遍你应该能够击倒你的那个列表。

另外，看看递归方案[（存档）](https://web.archive.org/web/20140713010615/http://comonad.com/reader/2009/recursion-schemes/) [博客文章](http://comonad.com/reader/2009/recursion-schemes/)，博主计划很快单独展示每一个，所以请定期查看它——我猜。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-11T15:13:47.677

Edward Kmett 最近发布了[递归方案的现场指南](http://comonad.com/reader/2009/recursion-schemes/)，也许它有帮助？

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-28T17:25:30.223

从学习变质开始；这些是最容易掌握的。你已经知道一个：`foldr`！

然后去找变形（`unfoldr`）和变形。然后才去查看其他 Wikipedia 文章/论文；到那时他们会更容易理解。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-04-18T10:53:58.293

在此处查看 Tim Williams 关于递归方案的幻灯片：

[http://www.timphilipwilliams.com/slides.html](http://www.timphilipwilliams.com/slides.html)

他们解释了所有的 *-morphisms 以及每个的激励例子。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-28T16:52:45.360

这是一个开始：[维基百科“递归方案”类别。](http://en.wikipedia.org/wiki/Category:Recursion_schemes)

# jquery - Firefox/jQuery 没有读取 img 元素的任何属性

> ID：921974
> 
> 赞同：0
> 
> 时间：2009-05-28T16:52:08.683
> 
> 标签：jquery, firefox, attributes

所以我试图结合两个图片库，[Galleria](http://devkick.com/lab/galleria/)和[Lightbox](http://leandrovieira.com/projects/jquery/lightbox/)。它应该工作的方式是 Lightbox 将从锚标记中读取*href*，而 Galleria 将从以下代码中的图像标记中读取*src ：*

```
<a href="./public/images/gallery/2.JPG">
<img class="replaced" src="./public/images/gallery/2.JPG"/>
</a> 
```

我正在尝试提取 src 的属性值并将其用作 href 的值。就目前而言，一旦我开始工作，我就必须重新编写代码。

这就是我拉出属性值的方式

```
var imageSrc = image.attr('src'); 
```

现在我已经在 FF2、FF3 中对其进行了测试，但它们都没有读取该值。在 Chrome 和 IE 中，它读取值。我在想的是图像是在 jQuery 中创建的，所以也许 Firefox 的阅读速度太快了，而 jQuery 还没有时间创建图像？

有什么想法吗？

谢谢，
列维

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T17:07:22.057

您是否在准备好的活动中结束通话？

```
$(document).ready(function(){
    var imageSrc = $('img.replaced').attr('src');
}); 
```

请注意，如果您有多个共享“已替换”类的图像，则需要从每个图像中读取 src。上述方法仅适用于单个图像，如果要读取多个图像的属性，请使用：

```
$(document).ready(function(){
    var imageSrc = $('img.replaced').each(function(){
        $(this).attr('src');
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T16:55:14.000

那么你如何选择图像？

尝试：

```
$('.replaced').each(function(){
   var imageSrc = $(this).attr('src');
   //alert(imageSrc) /*  for IE  */
   console.log(imageSrc);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T16:55:36.493

检查以下内容：

*   你定义`image`正确吗？你是如何给这个赋值的？
*   您是否要求在`image`代表该图像的 DOM 元素的位置之后的值？
*   您是否确保将脚本放在正文的末尾，就在结束`</body>`标记之前？（如果你不这样做，你可能会得到一个空引用，并且任何 Javascript 执行都将终止。）

很有可能它与这三个问题之一有关。

# asp.net - 使用 LINQ 填充模型

> ID：921977
> 
> 赞同：0
> 
> 时间：2009-05-28T16:52:23.660
> 
> 标签：asp.net, linq, unit-testing, linq-to-sql

我试图找出一种将模型类从 LINQ 填充到 SQL 生成对象的清晰方法。我的目标是让我的模型和 LinqModel 分开。假设我有以下型号：

```
public class Person {
    public List<Account> Accounts {get; set;}
}
public class Account {
    public List<Purchase> Purchases {get; set;}
}
public Purchase {
    public String Whatever {get; set;}
} 
```

现在，我还拥有由 LINQ to SQL 生成的几乎相同的数据模型。因此，如果我想填充一个 Person 对象，我将在 DataContext 部分类中添加一个 getter 方法：

```
public Person GetPersonByID(int personID) {
    ....
} 
```

我们如何在应用程序的其余部分填充此 Person 对象及其子属性，如下所示：

```
public Person GetPersonByID(int personID) {
    Person res = 
        from p in Persons 
        select new Person() {
            Accounts = (
                from a in p.Accounts
                select new Account() {
                    Purchases = (
                        from m in p.Purchases
                        select new Purchase() {
                            Whatever = m.Whatever
                        }
                    ).ToList()
                }
            ).ToList()
        }
    return res;
} 
```

因此，对于每个子属性，我们需要扩展查询。我真正希望的是，如果我能做更多这样的事情：

```
public Person GetPersonByID(int personID) {
    return new Person( this.Persons.SingleOrDefault( p => p.ID == personID ) );
}
....
public class Person {
    public Person(DataModels.Person p) {
        Accounts = (from a in p.Accounts select new Account(a)).ToList();
    }
}
public class Account {
    public Account(DataModels.Account a) {
        Purchases = (from r in a.Purchases select new Purchase(r)).ToList();
    }
}
public class Purchase {
    public Purchase(DataModels.Purchase r) {
        Whatever = r.Whatever
    }
} 
```

这更易于管理，但初始 GetPersonByID 调用不会返回填充这些子对象所需的数据。有没有办法解决？

或者有没有更好的替代方法来使用 LINQ to SQL 填充模型对象？

*** 抱歉，如果我的代码示例不完全正确*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T17:19:29.940

您正在寻找的东西称为“持久性无知”。

它是设计的重要属性，特别是在 DDD（领域驱动设计）圈子中。

例如，您可以使用 LinqToSQL 的 XML 映射功能来实现它，其中您不生成数据类并向 LTS 指示如何将您的域类（帐户、购买等）直接映射到数据库。

由于 LinqToSQL 在映射选项方面的功能有限（特别是缺少值对象、继承映射的限制以及缺少多对多关系支持），它可能适用于您的情况，也可能不适用。

如果您有 LTS 生成的类和上述的域类，另一种选择是查看[Automapper](http://automapper.codeplex.com/)，它可以帮助您摆脱一些重复性工作。

# sql-server - 使用 T-SQL 进行模糊匹配

> ID：921978
> 
> 赞同：77
> 
> 时间：2009-05-28T16:52:26.033
> 
> 标签：sql-server, tsql, fuzzy-search

我有一张带有个人数据的表格**Persons**等等。有很多列，但这里曾经感兴趣的是：`addressindex`，`lastname`以及向下钻到公寓门口的唯一地址`firstname`在哪里。`addressindex`因此，如果我有“如下所示”的两个人，`lastname`其中一个`firstnames`是相同的，那么他们很可能是重复的。

我需要一种列出这些重复项的方法。

```
tabledata:

personid     1
firstname    "Carl"
lastname     "Anderson"
addressindex 1

personid     2
firstname    "Carl Peter"
lastname     "Anderson"
addressindex 1 
```

如果我要在所有列上完全匹配，我知道该怎么做，但我需要模糊匹配才能使用（来自上面的示例）结果如下：

```
Row     personid      addressindex     lastname     firstname
1       2             1                Anderson     Carl Peter
2       1             1                Anderson     Carl
..... 
```

关于如何以一种好的方式解决这个问题的任何提示？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-03-16T04:27:55.093

我发现 SQL Server 提供给您进行模糊匹配的东西非常笨拙。使用 Levenshtein 距离算法和一些加权，我自己的 CLR 函数真的很幸运。使用该算法，我创建了一个名为 GetSimilarityScore 的 UDF，它接受两个字符串并返回一个介于 0.0 和 1.0 之间的分数。匹配值越接近 1.0 越好。然后，使用 >=0.8 左右的阈值进行查询以获得最可能的匹配项。像这样的东西：

```
if object_id('tempdb..#similar') is not null drop table #similar
select a.id, (
    select top 1 x.id
   from MyTable x
   where x.id <> a.id
   order by dbo.GetSimilarityScore(a.MyField, x.MyField) desc
) as MostSimilarId
into #similar
from MyTable a

select *, dbo.GetSimilarityScore(a.MyField, c.MyField)
from MyTable a
join #similar b on a.id = b.id
join MyTable c on b.MostSimilarId = c.id 
```

只是不要用非常大的桌子来做。这是一个缓慢的过程。

这是 CLR UDF：

```
''' <summary>
''' Compute the distance between two strings.
''' </summary>
''' <param name="s1">The first of the two strings.</param>
''' <param name="s2">The second of the two strings.</param>
''' <returns>The Levenshtein cost.</returns>
<Microsoft.SqlServer.Server.SqlFunction()> _
Public Shared Function ComputeLevenstheinDistance(ByVal string1 As SqlString, ByVal string2 As SqlString) As SqlInt32
    If string1.IsNull OrElse string2.IsNull Then Return SqlInt32.Null
    Dim s1 As String = string1.Value
    Dim s2 As String = string2.Value

    Dim n As Integer = s1.Length
    Dim m As Integer = s2.Length
    Dim d As Integer(,) = New Integer(n, m) {}

    ' Step 1
    If n = 0 Then Return m
    If m = 0 Then Return n

    ' Step 2
    For i As Integer = 0 To n
        d(i, 0) = i
    Next

    For j As Integer = 0 To m
        d(0, j) = j
    Next

    ' Step 3
    For i As Integer = 1 To n
        'Step 4
        For j As Integer = 1 To m
            ' Step 5
            Dim cost As Integer = If((s2(j - 1) = s1(i - 1)), 0, 1)

            ' Step 6
            d(i, j) = Math.Min(Math.Min(d(i - 1, j) + 1, d(i, j - 1) + 1), d(i - 1, j - 1) + cost)
        Next
    Next
    ' Step 7
    Return d(n, m)
End Function

''' <summary>
''' Returns a score between 0.0-1.0 indicating how closely two strings match.  1.0 is a 100%
''' T-SQL equality match, and the score goes down from there towards 0.0 for less similar strings.
''' </summary>
<Microsoft.SqlServer.Server.SqlFunction()> _
Public Shared Function GetSimilarityScore(string1 As SqlString, string2 As SqlString) As SqlDouble
    If string1.IsNull OrElse string2.IsNull Then Return SqlInt32.Null

    Dim s1 As String = string1.Value.ToUpper().TrimEnd(" "c)
    Dim s2 As String = string2.Value.ToUpper().TrimEnd(" "c)
    If s1 = s2 Then Return 1.0F ' At this point, T-SQL would consider them the same, so I will too

    Dim flatLevScore As Double = InternalGetSimilarityScore(s1, s2)

    Dim letterS1 As String = GetLetterSimilarityString(s1)
    Dim letterS2 As String = GetLetterSimilarityString(s2)
    Dim letterScore As Double = InternalGetSimilarityScore(letterS1, letterS2)

    'Dim wordS1 As String = GetWordSimilarityString(s1)
    'Dim wordS2 As String = GetWordSimilarityString(s2)
    'Dim wordScore As Double = InternalGetSimilarityScore(wordS1, wordS2)

    If flatLevScore = 1.0F AndAlso letterScore = 1.0F Then Return 1.0F
    If flatLevScore = 0.0F AndAlso letterScore = 0.0F Then Return 0.0F

    ' Return weighted result
    Return (flatLevScore * 0.2F) + (letterScore * 0.8F)
End Function

Private Shared Function InternalGetSimilarityScore(s1 As String, s2 As String) As Double
    Dim dist As SqlInt32 = ComputeLevenstheinDistance(s1, s2)
    Dim maxLen As Integer = If(s1.Length > s2.Length, s1.Length, s2.Length)
    If maxLen = 0 Then Return 1.0F
    Return 1.0F - Convert.ToDouble(dist.Value) / Convert.ToDouble(maxLen)
End Function

''' <summary>
''' Sorts all the alpha numeric characters in the string in alphabetical order
''' and removes everything else.
''' </summary>
Private Shared Function GetLetterSimilarityString(s1 As String) As String
    Dim allChars = If(s1, "").ToUpper().ToCharArray()
    Array.Sort(allChars)
    Dim result As New StringBuilder()
    For Each ch As Char In allChars
        If Char.IsLetterOrDigit(ch) Then
            result.Append(ch)
        End If
    Next
    Return result.ToString()
End Function

''' <summary>
''' Removes all non-alpha numeric characters and then sorts
''' the words in alphabetical order.
''' </summary>
Private Shared Function GetWordSimilarityString(s1 As String) As String
    Dim words As New List(Of String)()
    Dim curWord As StringBuilder = Nothing
    For Each ch As Char In If(s1, "").ToUpper()
        If Char.IsLetterOrDigit(ch) Then
            If curWord Is Nothing Then
                curWord = New StringBuilder()
            End If
            curWord.Append(ch)
        Else
            If curWord IsNot Nothing Then
                words.Add(curWord.ToString())
                curWord = Nothing
            End If
        End If
    Next
    If curWord IsNot Nothing Then
        words.Add(curWord.ToString())
    End If

    words.Sort(StringComparer.OrdinalIgnoreCase)
    Return String.Join(" ", words.ToArray())
End Function 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-28T17:05:07.800

除了这里的其他好信息，您可能需要考虑使用通常被认为比[SOUNDEX更好的](http://en.wikipedia.org/wiki/Soundex)[双变](http://en.wikipedia.org/wiki/Double_Metaphone)音语音算法。

Tim Pfeiffer 在他的文章[Double Metaphone Sounds Great Convert the C++ Double Metaphone algorithm to T-SQL](https://www.itprotoday.com/software-development/double-metaphone-sounds-great)中详细介绍了 SQL 中的实现（最初在[SQL Mag](https://web.archive.org/web/20091207025605/http://www.sqlmag.com:80/Articles/ArticleID/26094/pg/1/1.html "http://www.sqlmag.com:80/Articles/ArticleID/26094/pg/1/1.html 的存档")中，然后在[SQL Server Pro](https://web.archive.org/web/20130725060153/http://sqlmag.com:80/t-sql/double-metaphone-sounds-great "http://sqlmag.com/t-sql/double-metaphone-sounds-great 的存档")中）。

这将有助于匹配有轻微拼写错误的名称，例如*Carl* vs. *Karl*。

**更新**：实际的可下载代码似乎消失了，但这[是在 github repo 上找到的一个实现](https://github.com/mb16/geocoderNet/blob/master/build/sql/doubleMetaphone.sql)，它似乎克隆了原始代码

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-03-14T09:55:29.900

从 Master Data Services 的第一个版本开始，您可以访问比 SOUNDEX 实现的更高级的模糊逻辑算法。因此，只要您安装了 MDS，您就可以在**mdq**模式（MDS 数据库）中找到一个名为**Similarity()的函数。**

 **有关其工作原理的更多信息：http: [//blog.hoegaerden.be/2011/02/05/finding-similar-strings-with-fuzzy-logic-functions-built-into-mds/](http://blog.hoegaerden.be/2011/02/05/finding-similar-strings-with-fuzzy-logic-functions-built-into-mds/)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-28T16:56:46.803

我会使用 SQL Server 全文索引，这将允许您进行搜索并返回不仅包含单词而且可能有拼写错误的内容。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-03-13T09:04:15.643

我个人使用[Jaro-Winkler](http://en.wikipedia.org/wiki/Jaro-Winkler)算法的 CLR 实现，它似乎工作得很好——它对长度超过 15 个字符的字符串有点困难，不喜欢匹配电子邮件地址，但其他方面都很好——可以找到完整的实现指南[这里](http://isolvable.blogspot.com/2011/05/jaro-winkler-fast-fuzzy-linkage.html)

如果您由于某种原因无法使用 CLR 函数，也许您可​​以尝试通过 SSIS 包运行数据（使用模糊转换查找） - 详细信息[在此处](http://www.sqlservercentral.com/articles/Integration+Services+%28SSIS%29/65616/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-09-18T07:59:32.463

**代码的第 2 部分对于 Redfilter 答案中的链接：**

**参考资料：**
[https ://github.com/mb16/geocoderNet/blob/master/build/sql/doubleMetaphone.sql](https://github.com/mb16/geocoderNet/blob/master/build/sql/doubleMetaphone.sql)

```
BEGIN
                        SET @MP1 = @MP1 + 'N'
                        SET @MP2 = @MP2 + 'KN'
                    END
                                    ELSE
                    BEGIN
                        SET @MP1 = @MP1 + 'KN'
                        SET @MP2 = @MP2 + 'KN'
                    END
                END
                            SET @CurrentPosition = @CurrentPosition + 2
                    END

                    --'tagliaro'
                    ELSE IF (dbo.fnStringAt((@CurrentPosition + 1),@Word,'LI')=1) AND 
(dbo.fnSlavoGermanic(@Word)=0)
                    BEGIN
                SET @MP1 = @MP1 + 'KL'
                SET @MP2 = @MP2 + 'L'
                            SET @CurrentPosition = @CurrentPosition + 2
                    END

                    -- -ges-,-gep-,-gel-, -gie- at beginning
            -- This call to fnStringAt() is the 'worst case' in number of values passed. A UDF that used DEFAULT values instead of
                        -- a multi-valued argument would require ten DEFAULT arguments for EP, EB, EL, etc. (assuming the first was not defined with a DEFAULT).
                    ELSE IF ((@CurrentPosition = 1)
                            AND ((SUBSTRING(@Word,@CurrentPosition + 1,1) = 'Y') 
                                    OR (dbo.fnStringAt((@CurrentPosition + 
1),@Word,'ES,EP,EB,EL,EY,IB,IL,IN,IE,EI,ER')=1)) )
                    BEGIN
                SET @MP1 = @MP1 + 'K'
                SET @MP2 = @MP2 + 'J'
                            SET @CurrentPosition = @CurrentPosition + 2
                    END

                    -- -ger-,  -gy-
                    ELSE IF (((dbo.fnStringAt((@CurrentPosition + 1), @Word, 'ER')=1) OR 
(SUBSTRING(@Word,@CurrentPosition + 1,1) = 'Y'))
                                    AND (dbo.fnStringAt(1, @Word, 'DANGER,RANGER,MANGER')=0)
                                            AND (dbo.fnStringAt((@CurrentPosition - 1), @Word, 
'E,I,RGY,OGY')=0) )
                    BEGIN
                SET @MP1 = @MP1 + 'K'
                SET @MP2 = @MP2 + 'J'
                            SET @CurrentPosition = @CurrentPosition + 2
                    END

                    -- italian e.g, 'biaggi'
                    ELSE IF (dbo.fnStringAt((@CurrentPosition + 1),@Word,'E,I,Y')=1) OR 
(dbo.fnStringAt((@CurrentPosition - 1),@Word,'AGGI,OGGI')=1)
                    BEGIN
                            --obvious germanic
                            IF ((dbo.fnStringAt(1,@Word,'VAN ,VON ,SCH')=1)
                                    OR (dbo.fnStringAt((@CurrentPosition + 1),@Word,'ET')=1))
                BEGIN
                    SET @MP1 = @MP1 + 'K'
                    SET @MP2 = @MP2 + 'K'
                END
                            ELSE
                BEGIN
                                    --always soft if french ending
                                    IF (dbo.fnStringAt((@CurrentPosition + 1),@Word,'IER ')=1)
                    BEGIN
                        SET @MP1 = @MP1 + 'J'
                        SET @MP2 = @MP2 + 'J'
                    END
                                    ELSE
                    BEGIN
                        SET @MP1 = @MP1 + 'J'
                        SET @MP2 = @MP2 + 'K'
                    END
                END
                            SET @CurrentPosition = @CurrentPosition + 2
                    END

            ELSE
            BEGIN
                        IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'G')
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 2
                END
                        ELSE
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 1
                END
                SET @MP1 = @MP1 + 'K'
                SET @MP2 = @MP2 + 'K'
            END
        END

        ELSE IF @CurrentChar = 'H'
        BEGIN
                    --only keep if first & before vowel or btw. 2 vowels
                    IF (((@CurrentPosition = 1) OR 
(dbo.fnIsVowel(SUBSTRING(@Word,@CurrentPosition - 1,1))=1)) 
                            AND (dbo.fnIsVowel(SUBSTRING(@Word,@CurrentPosition + 1,1))=1))
                    BEGIN
                SET @MP1 = @MP1 + 'H'
                SET @MP2 = @MP2 + 'H'
                            SET @CurrentPosition = @CurrentPosition + 2
            END
                    --also takes care of 'HH'
                    ELSE 
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 1
            END
        END

        ELSE IF @CurrentChar = 'J'
        BEGIN
                    --obvious spanish, 'jose', 'san jacinto'
                    IF (dbo.fnStringAt(@CurrentPosition,@Word,'JOSE')=1) OR 
(dbo.fnStringAt(1,@Word,'SAN ')=1)
                    BEGIN
                            IF (((@CurrentPosition = 1) AND (SUBSTRING(@Word,@CurrentPosition 
+ 4,1) = ' ')) OR (dbo.fnStringAt(1,@Word,'SAN ')=1) )
                BEGIN
                    SET @MP1 = @MP1 + 'H'
                    SET @MP2 = @MP2 + 'H'
                END
                            ELSE
                            BEGIN
                    SET @MP1 = @MP1 + 'J'
                    SET @MP2 = @MP2 + 'H'
                            END
                            SET @CurrentPosition = @CurrentPosition + 1
                    END

                    ELSE IF ((@CurrentPosition = 1) AND 
(dbo.fnStringAt(@CurrentPosition,@Word,'JOSE')=0))
            BEGIN
                SET @MP1 = @MP1 + 'J'
                --Yankelovich/Jankelowicz
                SET @MP2 = @MP2 + 'A' 
                        --it could happen!
                        IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'J') 
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 2
                END
                        ELSE
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 1
                END
            END
                    ELSE
            BEGIN
                            --spanish pron. of e.g. 'bajador'
                            IF( (dbo.fnIsVowel(SUBSTRING(@Word,@CurrentPosition - 1,1))=1)
                                    AND (dbo.fnSlavoGermanic(@Word)=0)
                                            AND ((SUBSTRING(@Word,@CurrentPosition + 1,1) = 'A') OR 
(SUBSTRING(@Word,@CurrentPosition + 1,1) = 'O')))
                BEGIN
                    SET @MP1 = @MP1 + 'J'
                    SET @MP2 = @MP2 + 'H'
                END
                            ELSE
                BEGIN
                                    IF (@CurrentPosition = @WordLength)
                    BEGIN
                        SET @MP1 = @MP1 + 'J'
                        SET @MP2 = @MP2 + ''
                    END
                                    ELSE
                    BEGIN
                                            IF ((dbo.fnStringAt((@CurrentPosition + 1), @Word, 
'L,T,K,S,N,M,B,Z')=0) 
                                                            AND (dbo.fnStringAt((@CurrentPosition - 1), @Word, 
'S,K,L')=0))
                        BEGIN
                            SET @MP1 = @MP1 + 'J'
                            SET @MP2 = @MP2 + 'J'
                        END
                    END
                END
                        --it could happen!
                        IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'J') 
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 2
                END
                        ELSE
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 1
                END
            END
        END

        ELSE IF @CurrentChar = 'K'
        BEGIN
                    IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'K')
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 2
            END
                    ELSE
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 1
            END
            SET @MP1 = @MP1 + 'K'
            SET @MP2 = @MP2 + 'K'
        END

        ELSE IF @CurrentChar = 'L'
        BEGIN
                    IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'L')
                    BEGIN
                            --spanish e.g. 'cabrillo', 'gallegos'
                            IF (((@CurrentPosition = (@WordLength - 3)) 
                                    AND (dbo.fnStringAt((@CurrentPosition - 
1),@Word,'ILLO,ILLA,ALLE')=1))
                                             OR (((dbo.fnStringAt((@WordLength - 1),@Word,'AS,OS')=1) 
OR (dbo.fnStringAt(@WordLength,@Word,'A,O')=1)) 
                                                    AND (dbo.fnStringAt((@CurrentPosition - 
1),@Word,'ALLE')=1)) )
                            BEGIN
                    SET @MP1 = @MP1 + 'L'
                    SET @MP2 = @MP2 + ''
                                SET @CurrentPosition = @CurrentPosition + 2
                            END
                ELSE
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 2
                    SET @MP1 = @MP1 + 'L'
                    SET @MP2 = @MP2 + 'L'
                END
            END
                    ELSE
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 1
                SET @MP1 = @MP1 + 'L'
                SET @MP2 = @MP2 + 'L'
            END
        END

        ELSE IF @CurrentChar = 'M'
        BEGIN
                     --'dumb','thumb'
                    IF (((dbo.fnStringAt((@CurrentPosition - 1), @Word,'UMB')=1)
                            AND (((@CurrentPosition + 1) = @WordLength) OR 
(dbo.fnStringAt((@CurrentPosition + 2),@Word,'ER')=1)))

                                    OR (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'M') )
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 2
            END
                    ELSE
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 1
            END
            SET @MP1 = @MP1 + 'M'
            SET @MP2 = @MP2 + 'M'
        END

        ELSE IF @CurrentChar = 'N'
        BEGIN
                    IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'N')
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 2
            END
                    ELSE
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 1
            END
            SET @MP1 = @MP1 + 'N'
            SET @MP2 = @MP2 + 'N'
        END

        ELSE IF @CurrentChar = 'Ñ'
        BEGIN
                        SET @CurrentPosition = @CurrentPosition + 1
            SET @MP1 = @MP1 + 'N'
            SET @MP2 = @MP2 + 'N'
        END

        ELSE IF @CurrentChar = 'P'
        BEGIN
                    --What about Michelle Pfeiffer, star of Grease 2? Price-Pfister?, Pfizer?
                    --Don't just look for an 'F' next, what about 'topflight', helpful, campfire, leapfrog, stepfather
                    --Sorry, Mark Knopfler, I don't know how to help you
                    IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'H')

                OR ((@CurrentPosition = 1) AND 
(SUBSTRING(@Word,@CurrentPosition + 1,1) = 'F') AND 
(dbo.fnIsVowel(SUBSTRING(@Word,@CurrentPosition+2,1))=1))
                    BEGIN
                SET @MP1 = @MP1 + 'F'
                SET @MP2 = @MP2 + 'F'
                            SET @CurrentPosition = @CurrentPosition + 2
                    END

                    --also account for "campbell", "raspberry"
                    ELSE 
            BEGIN
                IF (dbo.fnStringAt((@CurrentPosition + 1),@Word, 'P,B')=1)
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 2
                END
                        ELSE
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 1
                END
                SET @MP1 = @MP1 + 'P'
                SET @MP2 = @MP2 + 'P'
            END
        END

        ELSE IF @CurrentChar = 'Q'
        BEGIN
                    IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'Q')
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 2
            END
                    ELSE
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 1
            END
            SET @MP1 = @MP1 + 'K'
            SET @MP2 = @MP2 + 'K'
        END

        ELSE IF @CurrentChar = 'R'
        BEGIN
            --QQ: Will SQL short circuit eval? Otherwise, I could try to read before string begins here...
                    --french e.g. 'rogier', but exclude 'hochmeier'
                    IF ((@CurrentPosition = @WordLength)
                            AND (dbo.fnSlavoGermanic(@Word)=0)
                                    AND (dbo.fnStringAt((@CurrentPosition - 2), @Word, 'IE')=1) 
                                            AND (dbo.fnStringAt((@CurrentPosition - 4), @Word, 
'ME,MA')=0))
            BEGIN
                SET @MP1 = @MP1 + ''
                SET @MP2 = @MP2 + 'R'
            END
                    ELSE
            BEGIN
                SET @MP1 = @MP1 + 'R'
                SET @MP2 = @MP2 + 'R'
            END

                    IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'R')
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 2
            END
                    ELSE
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 1
            END
        END

        ELSE IF @CurrentChar = 'S'
        BEGIN
                    --special cases 'island', 'isle', 'carlisle', 'carlysle'
                    IF (dbo.fnStringAt((@CurrentPosition - 1), @Word, 'ISL,YSL')=1)
                    BEGIN
                            SET @CurrentPosition = @CurrentPosition + 1
                    END

                    --special case 'sugar-'
                    ELSE IF ((@CurrentPosition = 1) AND (dbo.fnStringAt(@CurrentPosition, 
@Word, 'SUGAR')=1))
                    BEGIN
                SET @MP1 = @MP1 + 'X'
                SET @MP2 = @MP2 + 'S'
                            SET @CurrentPosition = @CurrentPosition + 1
                    END

                    ELSE IF (dbo.fnStringAt(@CurrentPosition, @Word, 'SH')=1)
                    BEGIN
                            --germanic
                            IF (dbo.fnStringAt((@CurrentPosition + 1), @Word, 
'HEIM,HOEK,HOLM,HOLZ')=1)
                BEGIN
                    SET @MP1 = @MP1 + 'S'
                    SET @MP2 = @MP2 + 'S'
                END
                            ELSE
                BEGIN
                    SET @MP1 = @MP1 + 'X'
                    SET @MP2 = @MP2 + 'X'
                END
                            SET @CurrentPosition = @CurrentPosition + 2
                    END

                    --italian & armenian
                    ELSE IF (dbo.fnStringAt(@CurrentPosition, @Word, 'SIO,SIA')=1) OR 
(dbo.fnStringAt(@CurrentPosition, @Word, 'SIAN')=1)
                    BEGIN
                            IF (dbo.fnSlavoGermanic(@Word)=0)
                BEGIN
                    SET @MP1 = @MP1 + 'S'
                    SET @MP2 = @MP2 + 'X'
                END
                            ELSE
                BEGIN
                    SET @MP1 = @MP1 + 'S'
                    SET @MP2 = @MP2 + 'S'
                END
                            SET @CurrentPosition = @CurrentPosition + 3
                    END

                    --german & anglicisations, e.g. 'smith' match 'schmidt', 'snider' match 'schneider'
                    --also, -sz- in slavic language altho in hungarian it is pronounced 's'
                    ELSE IF (((@CurrentPosition = 1) 
                                    AND (dbo.fnStringAt((@CurrentPosition + 1), @Word, 'M,N,L,W')=1))
                                            OR (dbo.fnStringAt((@CurrentPosition + 1), @Word, 'Z')=1))
                    BEGIN
                SET @MP1 = @MP1 + 'S'
                SET @MP2 = @MP2 + 'X'
                            IF (dbo.fnStringAt((@CurrentPosition + 1), @Word, 'Z')=1)
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 2
                END
                            ELSE
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 1
                            END
                    END

                    ELSE IF (dbo.fnStringAt(@CurrentPosition, @Word, 'SC')=1)
                    BEGIN
                            --Schlesinger's rule
                            IF (SUBSTRING(@Word,@CurrentPosition + 2,1) = 'H')
                BEGIN
                                    --dutch origin, e.g. 'school', 'schooner'
                                    IF (dbo.fnStringAt((@CurrentPosition + 3), @Word, 
'OO,ER,EN,UY,ED,EM')=1)
                                    BEGIN
                                            --'schermerhorn', 'schenker'
                                            IF (dbo.fnStringAt((@CurrentPosition + 3), @Word, 'ER,EN')=1)
                                            BEGIN
                            SET @MP1 = @MP1 + 'X'
                            SET @MP2 = @MP2 + 'SK'
                        END
                                            ELSE
                        BEGIN
                            SET @MP1 = @MP1 + 'SK'
                            SET @MP2 = @MP2 + 'SK'
                        END
                                    SET @CurrentPosition = @CurrentPosition + 3
                    END
                                    ELSE
                    BEGIN
                                            IF ((@CurrentPosition = 1) AND 
(dbo.fnIsVowel(SUBSTRING(@Word,3,1))=0) AND (SUBSTRING(@Word,3,1) <> 'W'))
                        BEGIN
                            SET @MP1 = @MP1 + 'X'
                            SET @MP2 = @MP2 + 'S'
                        END
                                            ELSE
                        BEGIN
                            SET @MP1 = @MP1 + 'X'
                            SET @MP2 = @MP2 + 'X'
                        END
                                    SET @CurrentPosition = @CurrentPosition + 3
                                    END
                END

                            ELSE IF (dbo.fnStringAt((@CurrentPosition + 2), @Word, 'I,E,Y')=1)
                            BEGIN
                    SET @MP1 = @MP1 + 'S'
                    SET @MP2 = @MP2 + 'S'
                                SET @CurrentPosition = @CurrentPosition + 3
                            END
                            ELSE
                BEGIN
                    SET @MP1 = @MP1 + 'SK'
                    SET @MP2 = @MP2 + 'SK'
                                SET @CurrentPosition = @CurrentPosition + 3
                            END
                    END

                    ELSE 
            BEGIN
                        --french e.g. 'resnais', 'artois'
                IF ((@CurrentPosition = @WordLength) AND 
(dbo.fnStringAt((@CurrentPosition - 2), @Word, 'AI,OI')=1))
                BEGIN
                    SET @MP1 = @MP1 + ''
                    SET @MP2 = @MP2 + 'S'
                END
                        ELSE
                BEGIN
                    SET @MP1 = @MP1 + 'S'
                    SET @MP2 = @MP2 + 'S'
                END

                        IF (dbo.fnStringAt((@CurrentPosition + 1), @Word, 'S,Z')=1)
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 2
                END
                        ELSE
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 1
                END
            END
        END

        ELSE IF @CurrentChar = 'T'
        BEGIN
                    IF (dbo.fnStringAt(@CurrentPosition, @Word, 'TION,TIA,TCH')=1)
                    BEGIN
                SET @MP1 = @MP1 + 'X'
                SET @MP2 = @MP2 + 'X'
                            SET @CurrentPosition = @CurrentPosition + 3
            END

                    ELSE IF (dbo.fnStringAt(@CurrentPosition, @Word, 'TH,TTH')=1) 
                    BEGIN
                            --special case 'thomas', 'thames' or germanic
                            IF (dbo.fnStringAt((@CurrentPosition + 2), @Word, 'OM,AM')=1) 
                                    OR (dbo.fnStringAt(1, @Word, 'VAN ,VON ,SCH')=1) 
                            BEGIN
                    SET @MP1 = @MP1 + 'T'
                    SET @MP2 = @MP2 + 'T'
                END
                            ELSE    
                BEGIN
                    SET @MP1 = @MP1 + '0'
                    SET @MP2 = @MP2 + 'T'
                            END
                            SET @CurrentPosition = @CurrentPosition + 2
                    END

            ELSE
            BEGIN
                        IF (dbo.fnStringAt((@CurrentPosition + 1), @Word, 'T,D')=1)
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 2
                END
                        ELSE
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 1
                END
                SET @MP1 = @MP1 + 'T'
                SET @MP2 = @MP2 + 'T'
            END
        END

        ELSE IF @CurrentChar = 'V'
        BEGIN
                    IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'V')
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 2
            END
                    ELSE
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 1
            END
            SET @MP1 = @MP1 + 'F'
            SET @MP2 = @MP2 + 'F'
        END

        ELSE IF @CurrentChar = 'W'
        BEGIN
                    --can also be in middle of word
                    IF (dbo.fnStringAt(@CurrentPosition, @Word, 'WR')=1)
                    BEGIN
                SET @MP1 = @MP1 + 'R'
                SET @MP2 = @MP2 + 'R'
                            SET @CurrentPosition = @CurrentPosition + 2
                    END

                    ELSE IF ((@CurrentPosition = 1) 
                            AND ((dbo.fnIsVowel(SUBSTRING(@Word,@CurrentPosition + 1,1))=1) 
OR (dbo.fnStringAt(@CurrentPosition, @Word, 'WH')=1)))
                    BEGIN
                            --Wasserman should match Vasserman
                            IF (dbo.fnIsVowel(SUBSTRING(@Word,@CurrentPosition + 1,1))=1)
                BEGIN
                    SET @MP1 = @MP1 + 'A'
                    SET @MP2 = @MP2 + 'F'
                END
                            ELSE
                BEGIN
                                    --need Uomo to match Womo
                    SET @MP1 = @MP1 + 'A'
                    SET @MP2 = @MP2 + 'A'
                END
                            SET @CurrentPosition = @CurrentPosition + 1
                    END

                    --Arnow should match Arnoff
                    ELSE IF (((@CurrentPosition = @WordLength) AND 
(dbo.fnIsVowel(SUBSTRING(@Word,@CurrentPosition - 1,1))=1)) 
                            OR (dbo.fnStringAt((@CurrentPosition - 1), @Word, 
'EWSKI,EWSKY,OWSKI,OWSKY')=1) 
                                            OR (dbo.fnStringAt(1, @Word, 'SCH')=1))
                    BEGIN
                SET @MP1 = @MP1 + ''
                SET @MP2 = @MP2 + 'F'
                            SET @CurrentPosition = @CurrentPosition + 1
            END

                    --polish e.g. 'filipowicz'
                    ELSE IF (dbo.fnStringAt(@CurrentPosition, @Word, 'WICZ,WITZ')=1)
                    BEGIN
                SET @MP1 = @MP1 + 'TS'
                SET @MP2 = @MP2 + 'FX'
                            SET @CurrentPosition = @CurrentPosition + 4
            END
    -- skip it
                    ELSE 
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 1
            END
        END

        ELSE IF @CurrentChar = 'X'
        BEGIN
                    --french e.g. breaux
                    IF (NOT((@CurrentPosition = @WordLength) 
                            AND ((dbo.fnStringAt((@CurrentPosition - 3), @Word, 'IAU,EAU')=1) 
                                            OR (dbo.fnStringAt((@CurrentPosition - 2), @Word, 
'AU,OU')=1))) )
            BEGIN
                SET @MP1 = @MP1 + 'KS'
                SET @MP2 = @MP2 + 'KS'
            END

                    IF (dbo.fnStringAt((@CurrentPosition + 1), @Word, 'C,X')=1)
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 2
            END
                    ELSE
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 1
            END
        END

        ELSE IF @CurrentChar = 'Z'
        BEGIN
                    --chinese pinyin e.g. 'zhao'
                    IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'H')
                    BEGIN
                SET @MP1 = @MP1 + 'J'
                SET @MP2 = @MP2 + 'J'
                            SET @CurrentPosition = @CurrentPosition + 2
            END
                    ELSE
            BEGIN
                            IF ((dbo.fnStringAt((@CurrentPosition + 1), @Word, 'ZO,ZI,ZA')=1) 
                                    OR ((dbo.fnSlavoGermanic(@Word)=1) AND ((@CurrentPosition > 
1) AND SUBSTRING(@Word,@CurrentPosition - 1,1) <> 'T')))
                            BEGIN
                    SET @MP1 = @MP1 + 'S'
                    SET @MP2 = @MP2 + 'TS'
                            END
                            ELSE
                BEGIN
                    SET @MP1 = @MP1 + 'S'
                    SET @MP2 = @MP2 + 'S'
                END
                        IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'Z')
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 2
                END
                        ELSE
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 1
                        END
            END
        END

            ELSE
        BEGIN
                        SET @CurrentPosition = @CurrentPosition + 1
        END
    END

        --only give back 4 char metaphone
        IF (LEN(@MP1) > 4)
    BEGIN
        SET @MP1 = LEFT(@MP1, 4)
    END
        IF (LEN(@MP2) > 4)
    BEGIN
        SET @MP2 = LEFT(@MP2, 4)
    END
    IF @MP2 = @MP1
    BEGIN
        SET @MP2 = ''
    END

    INSERT @DMP(Metaphone1,Metaphone2) VALUES( @MP1, @MP2 )
    RETURN
END
GO;
------------------------------------------------------------------------
IF OBJECT_ID('fnDoubleMetaphoneScalar') IS NOT NULL BEGIN DROP FUNCTION 
fnDoubleMetaphoneScalar END
GO;
CREATE FUNCTION fnDoubleMetaphoneScalar( @MetaphoneType int, @Word varchar(50) )
RETURNS char(4)
AS
BEGIN
        RETURN (SELECT CASE @MetaphoneType WHEN 1 THEN Metaphone1 
WHEN 2 THEN Metaphone2 END FROM fnDoubleMetaphoneTable( @Word ))
END 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-28T16:56:55.977

您可以使用 SQL Server 中的 SOUNDEX 和相关的 DIFFERENCE 函数来查找相似的名称。MSDN 上的参考资料在[这里](http://msdn.microsoft.com/en-us/library/ms187384.aspx)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-24T18:46:02.017

关于重复数据删除，你的字符串拆分和匹配是很好的第一次切割。如果有关于数据的已知项目可以用来减少工作量和/或产生更好的结果，那么利用它们总是好的。请记住，对于重复数据删除，通常不可能完全消除手动工作，尽管您可以通过尽可能多地自动捕获然后生成“不确定案例”报告来简化这一工作。

关于名称匹配：SOUNDEX 的匹配质量很差，对您尝试做的工作类型尤其不利，因为它会匹配离目标太远的东西。最好使用双变音位结果和 Levenshtein 距离的组合来执行名称匹配。通过适当的偏差，这非常有效，并且可能在对您的已知信息进行清理后用于第二次通过。

您可能还想考虑使用 SSIS 包并查看模糊查找和分组转换 (http://msdn.microsoft.com/en-us/library/ms345128(SQL.90).aspx)。

使用 SQL 全文搜索 (http://msdn.microsoft.com/en-us/library/cc879300.aspx) 也是一种可能，但可能不适合您的特定问题域。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-09-18T07:58:31.557

分两部分粘贴RedFilter代码，以免链接腐烂

**参考资料：**
[https ://github.com/mb16/geocoderNet/blob/master/build/sql/doubleMetaphone.sql](https://github.com/mb16/geocoderNet/blob/master/build/sql/doubleMetaphone.sql) **Part1：**

```
--WEB LISTING 1: Double Metaphone Script

-------------------------------------
IF OBJECT_ID('fnIsVowel') IS NOT NULL BEGIN DROP FUNCTION fnIsVowel END
GO;
CREATE FUNCTION fnIsVowel( @c char(1) )
RETURNS bit
AS
BEGIN
    IF (@c = 'A') OR (@c = 'E') OR (@c = 'I') OR (@c = 'O') OR (@c = 'U') OR (@c = 'Y') 
    BEGIN
        RETURN 1
    END
    --'ELSE' would worry SQL Server, it wants RETURN last in a scalar function
    RETURN 0
END
GO;
-----------------------------------------------
IF OBJECT_ID('fnSlavoGermanic') IS NOT NULL BEGIN DROP FUNCTION fnSlavoGermanic 
END
GO;
CREATE FUNCTION fnSlavoGermanic( @Word char(50) )
RETURNS bit
AS
BEGIN
    --Catch NULL also...
    IF (CHARINDEX('W',@Word) > 0) OR (CHARINDEX('K',@Word) > 0) OR 
(CHARINDEX('CZ',@Word) > 0)
    --'WITZ' test is in original Lawrence Philips C++ code, but appears to be a subset of the first test for 'W'
    -- OR (CHARINDEX('WITZ',@Word) > 0)
    BEGIN
        RETURN 1
    END
    --ELSE
        RETURN 0
END
GO;
---------------------------------------------------------------------------------------------------------------------------------
----------------------
--Lawrence Philips calls for a length argument, but this has two drawbacks:
--1\. All target strings must be of the same length
--2\. It presents an opportunity for subtle bugs, ie fnStringAt( 1, 7, 'Search me please', 'Search' ) returns 0 (no matter what is in the searched string)
--So I've eliminated the argument and fnStringAt checks the length of each target as it executes

--DEFAULTS suck with UDFs. Have to specify DEFAULT in caller - why bother?
IF OBJECT_ID('fnStringAtDef') IS NOT NULL BEGIN DROP FUNCTION fnStringAtDef END
GO;
CREATE FUNCTION fnStringAtDef( @Start int, @StringToSearch varchar(50), 
    @Target1 varchar(50), 
    @Target2 varchar(50) = NULL,
    @Target3 varchar(50) = NULL,
    @Target4 varchar(50) = NULL,
    @Target5 varchar(50) = NULL,
    @Target6 varchar(50) = NULL )
RETURNS bit
AS
BEGIN
    IF CHARINDEX(@Target1,@StringToSearch,@Start) > 0 RETURN 1
    --2 Styles, test each optional argument for NULL, nesting further tests
    --or just take advantage of CHARINDEX behavior with a NULL arg (unless 65 compatibility - code check before CREATE FUNCTION?
    --Style 1:
    --IF @Target2 IS NOT NULL
    --BEGIN
    --  IF CHARINDEX(@Target2,@StringToSearch,@Start) > 0 RETURN 1
    -- (etc.)
    --END
    --Style 2:
    IF CHARINDEX(@Target2,@StringToSearch,@Start) > 0 RETURN 1
    IF CHARINDEX(@Target3,@StringToSearch,@Start) > 0 RETURN 1
    IF CHARINDEX(@Target4,@StringToSearch,@Start) > 0 RETURN 1
    IF CHARINDEX(@Target5,@StringToSearch,@Start) > 0 RETURN 1
    IF CHARINDEX(@Target6,@StringToSearch,@Start) > 0 RETURN 1
    RETURN 0
END
GO;
-------------------------------------------------------------------------------------------------
IF OBJECT_ID('fnStringAt') IS NOT NULL BEGIN DROP FUNCTION fnStringAt END
GO;
CREATE FUNCTION fnStringAt( @Start int, @StringToSearch varchar(50), @TargetStrings 
varchar(2000) )
RETURNS bit
AS
BEGIN
    DECLARE @SingleTarget varchar(50)
    DECLARE @CurrentStart int
    DECLARE @CurrentLength int

    --Eliminate special cases
    --Trailing space is needed to check for end of word in some cases, so always append comma
    --loop tests should fairly quickly ignore ',,' termination
    SET @TargetStrings = @TargetStrings + ','

    SET @CurrentStart = 1
    --Include terminating comma so spaces don't get truncated
    SET @CurrentLength = (CHARINDEX(',',@TargetStrings,@CurrentStart) - 
@CurrentStart) + 1
    SET @SingleTarget = SUBSTRING(@TargetStrings,@CurrentStart,@CurrentLength)
    WHILE LEN(@SingleTarget) > 1
    BEGIN
        IF SUBSTRING(@StringToSearch,@Start,LEN(@SingleTarget)-1) = 
LEFT(@SingleTarget,LEN(@SingleTarget)-1)
        BEGIN
            RETURN 1
        END
        SET @CurrentStart = (@CurrentStart + @CurrentLength)
        SET @CurrentLength = (CHARINDEX(',',@TargetStrings,@CurrentStart) - 
@CurrentStart) + 1
        IF NOT @CurrentLength > 1 --getting trailing comma 
        BEGIN
            BREAK
        END
        SET @SingleTarget = 
SUBSTRING(@TargetStrings,@CurrentStart,@CurrentLength)
    END
    RETURN 0
END
GO;
------------------------------------------------------------------------
IF OBJECT_ID('fnDoubleMetaphoneTable') IS NOT NULL BEGIN DROP FUNCTION 
fnDoubleMetaphoneTable END
GO;
CREATE FUNCTION fnDoubleMetaphoneTable( @Word varchar(50) )
RETURNS @DMP TABLE ( Metaphone1 char(4), Metaphone2 char(4) )
AS
BEGIN
    DECLARE @MP1 varchar(4), @MP2 varchar(4)
    SET @MP1 = ''
    SET @MP2 = ''
    DECLARE @CurrentPosition int, @WordLength int, @CurrentChar char(1)
    SET @CurrentPosition = 1
    SET @WordLength = LEN(@Word)

    IF @WordLength < 1 
    BEGIN
        RETURN
    END

    --ensure case insensitivity
    SET @Word = UPPER(@Word)

    IF dbo.fnStringAt(1, @Word, 'GN,KN,PN,WR,PS') = 1 
    BEGIN
        SET @CurrentPosition = @CurrentPosition + 1
    END

    IF 'X' = LEFT(@Word,1)
    BEGIN
        SET @MP1 = @MP1 + 'S'
        SET @MP2 = @MP2 + 'S'
        SET @CurrentPosition = @CurrentPosition + 1
    END

    WHILE (4 > LEN(RTRIM(@MP1))) OR (4 > LEN(RTRIM(@MP2)))
    BEGIN
        IF @CurrentPosition > @WordLength 
        BEGIN
            BREAK
        END

        SET @CurrentChar = SUBSTRING(@Word,@CurrentPosition,1)

        IF @CurrentChar IN('A','E','I','O','U','Y')
        BEGIN
            IF @CurrentPosition = 1 
            BEGIN
                SET @MP1 = @MP1 + 'A'
                SET @MP2 = @MP2 + 'A'
            END
            SET @CurrentPosition = @CurrentPosition + 1
        END
        ELSE IF @CurrentChar = 'B'
        BEGIN
            SET @MP1 = @MP1 + 'P'
            SET @MP2 = @MP2 + 'P'
            IF 'B' = SUBSTRING(@Word,@CurrentPosition + 1,1) 
            BEGIN
                SET @CurrentPosition = @CurrentPosition + 2
            END
            ELSE 
            BEGIN
                SET @CurrentPosition = @CurrentPosition + 1
            END
        END
        ELSE IF @CurrentChar = 'Ç'
        BEGIN
            SET @MP1 = @MP1 + 'S'
            SET @MP2 = @MP2 + 'S'
            SET @CurrentPosition = @CurrentPosition + 1
        END
        ELSE IF @CurrentChar = 'C'
        BEGIN
            --various germanic
            IF (@CurrentPosition > 2) 
               AND (dbo.fnIsVowel(SUBSTRING(@Word,@CurrentPosition-2,1))=0) 
               AND (dbo.fnStringAt(@CurrentPosition-1,@Word,'ACH') = 1) 
               AND ((SUBSTRING(@Word,@CurrentPosition+2,1) <> 'I') 
                AND ((SUBSTRING(@Word,@CurrentPosition+2,1) <> 'E') OR 
(dbo.fnStringAt(@CurrentPosition-2,@Word,'BACHER,MACHER')=1)))
            BEGIN
                SET @MP1 = @MP1 + 'K'
                SET @MP2 = @MP2 + 'K'
                SET @CurrentPosition = @CurrentPosition + 2
            END
            -- 'caesar'
            ELSE IF (@CurrentPosition = 1) AND 
(dbo.fnStringAt(@CurrentPosition,@Word,'CAESAR') = 1)
            BEGIN
                SET @MP1 = @MP1 + 'S'
                SET @MP2 = @MP2 + 'S'
                SET @CurrentPosition = @CurrentPosition + 2
            END
            -- 'chianti'
            ELSE IF dbo.fnStringAt(@CurrentPosition,@Word,'CHIA') = 1
            BEGIN
                SET @MP1 = @MP1 + 'K'
                SET @MP2 = @MP2 + 'K'
                SET @CurrentPosition = @CurrentPosition + 2
            END
            ELSE IF dbo.fnStringAt(@CurrentPosition,@Word,'CH') = 1
            BEGIN
                -- Find 'michael'
                IF (@CurrentPosition > 1) AND 
(dbo.fnStringAt(@CurrentPosition,@Word,'CHAE') = 1)
                BEGIN
                    --First instance of alternate encoding
                    SET @MP1 = @MP1 + 'K'
                    SET @MP2 = @MP2 + 'X'
                    SET @CurrentPosition = @CurrentPosition + 2
                END
                --greek roots e.g. 'chemistry', 'chorus'
                ELSE IF (@CurrentPosition = 1) AND (dbo.fnStringAt(2, @Word, 
'HARAC,HARIS,HOR,HYM,HIA,HEM') = 1) AND (dbo.fnStringAt(1,@Word,'CHORE') = 0)
                BEGIN
                    SET @MP1 = @MP1 + 'K'
                    SET @MP2 = @MP2 + 'K'
                    SET @CurrentPosition = @CurrentPosition + 2
                END
                --germanic, greek, or otherwise 'ch' for 'kh' sound
                ELSE IF ((dbo.fnStringAt(1,@Word,'VAN ,VON ,SCH')=1) OR 
                   (dbo.fnStringAt(@CurrentPosition-
2,@Word,'ORCHES,ARCHIT,ORCHID')=1) OR 
                   (dbo.fnStringAt(@CurrentPosition+2,@Word,'T,S')=1) OR 
                   (((dbo.fnStringAt(@CurrentPosition-1,@Word,'A,O,U,E')=1) 
OR 
                   (@CurrentPosition = 1))  
                   AND 
(dbo.fnStringAt(@CurrentPosition+2,@Word,'L,R,N,M,B,H,F,V,W, ')=1)))
                BEGIN
                    SET @MP1 = @MP1 + 'K'
                    SET @MP2 = @MP2 + 'K'
                    SET @CurrentPosition = @CurrentPosition + 2
                END
                ELSE
                BEGIN
                    --is this a given?
                    IF (@CurrentPosition > 1)   
                    BEGIN
                        IF (dbo.fnStringAt(1,@Word,'MC') = 1)
                        BEGIN
                            --eg McHugh
                            SET @MP1 = @MP1 + 'K'
                            SET @MP2 = @MP2 + 'K'
                        END
                        ELSE
                        BEGIN
                            --Alternate encoding
                            SET @MP1 = @MP1 + 'X'
                            SET @MP2 = @MP2 + 'K'
                        END
                    END
                    ELSE
                    BEGIN
                        SET @MP1 = @MP1 + 'X'
                        SET @MP2 = @MP2 + 'X'
                    END
                    SET @CurrentPosition = @CurrentPosition + 2
                END
            END
                    --e.g, 'czerny'
                    ELSE IF (dbo.fnStringAt(@CurrentPosition,@Word,'CZ')=1) AND 
(dbo.fnStringAt((@CurrentPosition - 2),@Word,'WICZ')=0)
                    BEGIN
                SET @MP1 = @MP1 + 'S'
                SET @MP2 = @MP2 + 'X'
                            SET @CurrentPosition = @CurrentPosition + 2
                    END

                    --e.g., 'focaccia'
                    ELSE IF(dbo.fnStringAt((@CurrentPosition + 1),@Word,'CIA')=1)
                    BEGIN
                SET @MP1 = @MP1 + 'X'
                SET @MP2 = @MP2 + 'X'
                            SET @CurrentPosition = @CurrentPosition + 3
                    END

                    --double 'C', but not if e.g. 'McClellan'
                    ELSE IF(dbo.fnStringAt(@CurrentPosition,@Word,'CC')=1) AND NOT 
((@CurrentPosition = 2) AND (LEFT(@Word,1) = 'M'))
                            --'bellocchio' but not 'bacchus'
                            IF (dbo.fnStringAt((@CurrentPosition + 2),@Word,'I,E,H')=1) AND 
(dbo.fnStringAt((@CurrentPosition + 2),@Word,'HU')=0)
                            BEGIN
                                    --'accident', 'accede' 'succeed'
                                    IF (((@CurrentPosition = 2) AND 
(SUBSTRING(@Word,@CurrentPosition - 1,1) = 'A')) 
                                                    OR (dbo.fnStringAt((@CurrentPosition - 
1),@Word,'UCCEE,UCCES')=1))
                    BEGIN
                        SET @MP1 = @MP1 + 'KS'
                        SET @MP2 = @MP2 + 'KS'
                    END
                                    --'bacci', 'bertucci', other italian
                                    ELSE
                    BEGIN
                        SET @MP1 = @MP1 + 'X'
                        SET @MP2 = @MP2 + 'X'
                    END
                                SET @CurrentPosition = @CurrentPosition + 3
                END
                            --Pierce's rule
                            ELSE 
                BEGIN
                    SET @MP1 = @MP1 + 'K'
                    SET @MP2 = @MP2 + 'K'
                                SET @CurrentPosition = @CurrentPosition + 2
                            END

                    ELSE IF (dbo.fnStringAt(@CurrentPosition,@Word,'CK,CG,CQ')=1)
                    BEGIN
                SET @MP1 = @MP1 + 'K'
                SET @MP2 = @MP2 + 'K'
                            SET @CurrentPosition = @CurrentPosition + 2
                    END

                    ELSE IF (dbo.fnStringAt(@CurrentPosition,@Word,'CI,CE,CY')=1)
                    BEGIN
                            --italian vs. english
                            IF (dbo.fnStringAt(@CurrentPosition,@Word,'CIO,CIE,CIA')=1)
                BEGIN
                    SET @MP1 = @MP1 + 'S'
                    SET @MP2 = @MP2 + 'X'
                END
                            ELSE
                BEGIN
                    SET @MP1 = @MP1 + 'S'
                    SET @MP2 = @MP2 + 'S'
                END
                            SET @CurrentPosition = @CurrentPosition + 2
                    END

                    ELSE
            BEGIN
                SET @MP1 = @MP1 + 'K'
                SET @MP2 = @MP2 + 'K'

                        --name sent in 'mac caffrey', 'mac gregor
                        IF (dbo.fnStringAt((@CurrentPosition + 1),@Word,' C, Q, G')=1)
                BEGIN
                                SET @CurrentPosition = @CurrentPosition + 3
                END
                        ELSE
                BEGIN
                                IF (dbo.fnStringAt((@CurrentPosition + 1),@Word,'C,K,Q')=1)
                                        AND (dbo.fnStringAt((@CurrentPosition + 1), 2, 'CE,CI')=0)
                    BEGIN
                                    SET @CurrentPosition = @CurrentPosition + 2
                    END
                                ELSE
                    BEGIN
                                    SET @CurrentPosition = @CurrentPosition + 1
                    END
                        END
            END

        END
        ELSE IF @CurrentChar = 'D'
        BEGIN
                    IF (dbo.fnStringAt(@CurrentPosition, @Word, 'DG')=1)
            BEGIN
                            IF (dbo.fnStringAt((@CurrentPosition + 2),@Word,'I,E,Y')=1)
                            BEGIN
                                    --e.g. 'edge'
                    SET @MP1 = @MP1 + 'J'
                    SET @MP2 = @MP2 + 'J'
                                SET @CurrentPosition = @CurrentPosition + 3
                            END
                            ELSE
                BEGIN
                                    --e.g. 'edgar'
                    SET @MP1 = @MP1 + 'TK'
                    SET @MP2 = @MP2 + 'TK'
                                SET @CurrentPosition = @CurrentPosition + 2
                            END
            END
                    ELSE IF (dbo.fnStringAt(@CurrentPosition,@Word,'DT,DD')=1)
                    BEGIN
                SET @MP1 = @MP1 + 'T'
                SET @MP2 = @MP2 + 'T'
                            SET @CurrentPosition = @CurrentPosition + 2
                    END
                    ELSE
            BEGIN
                SET @MP1 = @MP1 + 'T'
                SET @MP2 = @MP2 + 'T'
                            SET @CurrentPosition = @CurrentPosition + 1
            END
        END

        ELSE IF @CurrentChar = 'F'
        BEGIN
                    IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'F')
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 2
            END
                    ELSE
            BEGIN
                            SET @CurrentPosition = @CurrentPosition + 1
            END
            SET @MP1 = @MP1 + 'F'
            SET @MP2 = @MP2 + 'F'
        END

        ELSE IF @CurrentChar = 'G'
        BEGIN
                    IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'H')
                    BEGIN
                            IF (@CurrentPosition > 1) AND 
(dbo.fnIsVowel(SUBSTRING(@Word,@CurrentPosition - 1,1)) = 0)
                            BEGIN
                    SET @MP1 = @MP1 + 'K'
                    SET @MP2 = @MP2 + 'K'
                                SET @CurrentPosition = @CurrentPosition + 2
                            END
                                --'ghislane', ghiradelli
                                ELSE IF (@CurrentPosition = 1)
                                BEGIN 
                                        IF (SUBSTRING(@Word,@CurrentPosition + 2,1) = 'I')
                    BEGIN
                        SET @MP1 = @MP1 + 'J'
                        SET @MP2 = @MP2 + 'J'
                    END
                                        ELSE
                    BEGIN
                        SET @MP1 = @MP1 + 'K'
                        SET @MP2 = @MP2 + 'K'
                    END
                                SET @CurrentPosition = @CurrentPosition + 2
                            END
                            --Parker's rule (with some further refinements) - e.g., 'hugh'
                            ELSE IF (((@CurrentPosition > 2) AND (dbo.fnStringAt((@CurrentPosition 
- 2),@Word,'B,H,D')=1) )
                                    --e.g., 'bough'
                                    OR ((@CurrentPosition > 3) AND (dbo.fnStringAt((@CurrentPosition 
- 3),@Word,'B,H,D')=1) )
                                    --e.g., 'broughton'
                                    OR ((@CurrentPosition > 4) AND (dbo.fnStringAt((@CurrentPosition 
- 4),@Word,'B,H')=1) ) )
                            BEGIN
                                SET @CurrentPosition = @CurrentPosition + 2
                END
                            ELSE
                BEGIN
                                    --e.g., 'laugh', 'McLaughlin', 'cough', 'gough', 'rough', 'tough'
                                    IF ((@CurrentPosition > 3) 
                                            AND (SUBSTRING(@Word,@CurrentPosition - 1,1) = 'U') 
                                            AND (dbo.fnStringAt((@CurrentPosition - 
3),@Word,'C,G,L,R,T')=1) )
                                    BEGIN
                        SET @MP1 = @MP1 + 'F'
                        SET @MP2 = @MP2 + 'F'
                    END
                                    ELSE
                    BEGIN
                                            IF ((@CurrentPosition > 1) AND 
SUBSTRING(@Word,@CurrentPosition - 1,1) <> 'I')
                        BEGIN
                            SET @MP1 = @MP1 + 'K'
                            SET @MP2 = @MP2 + 'K'
                        END
                    END

                                SET @CurrentPosition = @CurrentPosition + 2
                            END
                    END

                    ELSE IF (SUBSTRING(@Word,@CurrentPosition + 1,1) = 'N')
                    BEGIN
                            IF ((@CurrentPosition = 2) AND (dbo.fnIsVowel(LEFT(@Word,1))=1) AND 
(dbo.fnSlavoGermanic(@Word)=0))
                            BEGIN
                    SET @MP1 = @MP1 + 'KN'
                    SET @MP2 = @MP2 + 'N'
                END
                            ELSE
                BEGIN
                                    --not e.g. 'cagney'
                                    IF ((dbo.fnStringAt((@CurrentPosition + 2),@Word,'EY')=0) 
                                                    AND (SUBSTRING(@Word,@CurrentPosition + 1,1) <> 
'Y') AND (dbo.fnSlavoGermanic(@Word)=0)) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-10-18T06:31:46.057

这样做

```
 create table person(
         personid int identity(1,1) primary key,
         firstname varchar(20),
         lastname varchar(20),
         addressindex int,
         sound varchar(10)
         ) 
```

然后创建一个触发器

```
 create trigger trigoninsert for dbo.person
         on insert 
         as
         declare @personid int;
         select @personid=personid from inserted;
         update person
         set sound=soundex(firstname) where personid=@personid; 
```

现在我能做的是我可以创建一个看起来像这样的程序

```
 create procedure getfuzzi(@personid int)
          as
         declare @sound varchar(10);
         set @sound=(select sound from person where personid=@personid;
         select personid,firstname,lastname,addressindex from person
         where sound=@sound 
```

这将返回与特定 personid 提供的名称几乎匹配的所有名称

# html - Safari 图像渲染错误

> ID：921985
> 
> 赞同：2
> 
> 时间：2009-05-28T16:54:13.923
> 
> 标签：html, css, browser, image, safari

有没有其他人遇到过这种情况。每当浏览器最初加载图像时，它只显示图像的后半部分。然后，当我将鼠标悬停在绿色部分的任何位置时，它会立即显示图像的其余部分。

你在这里看到的是一个`<div>`带有背景图像和一个`<img>`位于其中的 a `<div>`。

我在使用适用于 Windows 的 Safari 3.2.3 时遇到了这个问题，我的同事在使用 Mac 版本时已经看到了这个问题。我测试过的其他浏览器似乎都没有显示相同的错误。我在 IE8、IE7、IE6、FF3、Chrome 和 Opera 中进行了测试。

如果您听说过任何修复，请告诉我。谢谢。

[Safari 图像错误 http://www.pixelwhiskey.com/images/safari_image_bug.jpg](http://www.pixelwhiskey.com/images/safari_image_bug.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-15T18:48:05.420

如果 GIFS，请尝试使用 PNG

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T15:58:43.140

我已经看到与 IE 渲染类似的问题，通过将 height: 1% 设置为受影响的 div 或嵌套在其中的元素来解决。不过，我从未在 Safari 中见过它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-13T00:42:41.043

在 Firebug 中检查图像附近的所有元素（是的，我知道问题出在 Safari 中），并确保它们都没有因任何原因的尺寸错误，并且它们都没有过多的填充来侵占你没有的图像正确看待。另外，尝试`overflow: visible;`为附近的各种元素设置样式；我过去曾看到过鼠标悬停闪烁，但没有什么是 CSS 无法克服的。

# django - 在 Django Admin 中的内联中排序字段

> ID：921996
> 
> 赞同：6
> 
> 时间：2009-05-28T16:56:03.153
> 
> 标签：django, admin

我与 Django 中的中间对象建立了多对多关系。有什么想法可以在为中间对象显示的内联中订购 < select > 吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T17:10:59.317

您可以`fields`在内部使用`InlineModelAdmin`：

```
class FooInline(admin.StackedInline):
    model = Foo
    fields = ('field1', 'field2', 'field3') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-26T08:05:54.770

我认为这可能是您正在寻找的：

*使用 jQuery UI 拖放的可排序内联* [http://djangosnippets.org/snippets/1053/](http://djangosnippets.org/snippets/1053/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T19:31:53.480

您是否尝试过使用参数为多对多关系指定模型`through`？然后，您应该能够使用`ModelAdmin`类自定义管理员。

```
class A(models.Model):
      pass

class B(models.Model):
   m2m = models.ManyToManyField(A, through='C')

class C(models.Model):
    a = models.ForeignKey(A)
    b = models.ForeignKey(B) 
```

# iphone - 接触 UIResponder API

> ID：921998
> 
> 赞同：1
> 
> 时间：2009-05-28T16:56:13.327
> 
> 标签：iphone, cocoa-touch

所以，UIResponder 有如下方法：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
```

`touches`我的问题是，参数和之间有什么区别`[event allTouches]`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T18:24:59.027

所有的*触摸*集都存储在*event 中*。

但是，为方便起见，Apple 单独提供了**触发**touchesBegan 方法作为参数调用的触摸。

如果您搜索 [event allTouches] 并将它们与 [touches anyObject] 中的 UITouch 进​​行比较，您会找到匹配项。***************