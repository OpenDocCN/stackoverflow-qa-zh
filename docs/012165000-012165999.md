# StackOverflow 问答 12165000-12165999

# php - 如何在函数中使用无穷大参数（如 PHP 的 isset()）

> ID：12165002
> 
> 赞同：29
> 
> 时间：2012-08-28T18:07:14.567
> 
> 标签：php, function, parameters, parameter-passing, param

你知道 PHP 是如何`isset()`接受多个（也没有限制）参数的吗？

就像我可以做的：

```
isset($var1,$var2,$var3,$var4,$var5,$var6,$var7,$var8,$var9,$var10,$var11);
//etc etc 
```

我怎么能在我自己的功能中做到这一点？我将如何处理传递的无穷大参数？

他们是如何做到的呢？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-08-28T18:09:42.253

[`func_get_args`](http://php.net/manual/en/function.func-get-args.php)会做你想做的事：

```
function infinite_parameters() {
    foreach (func_get_args() as $param) {
        echo "Param is $param" . PHP_EOL;
    }
} 
```

您还可以使用`func_get_arg`来获取特定参数（它是零索引的）：

```
function infinite_parameters() {
    echo func_get_arg(2);
} 
```

但要小心检查您是否有该参数：

```
function infinite_parameters() {
    if (func_num_args() < 3) {
        throw new BadFunctionCallException("Not enough parameters!");
    }
} 
```

您甚至可以将`func_*_arg`常规参数混合在一起：

```
function foo($param1, $param2) {
    echo $param1; // Works as normal
    echo func_get_arg(0); // Gets $param1
    if (func_num_args() >= 3) {
        echo func_get_arg(2);
    }
} 
```

但是在使用它之前，请考虑一下您是否*真的*想要具有不定参数。数组不够吗？

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2014-11-04T13:44:55.127

从 PHP 5.6 开始，您可以使用令牌“ **...** ”

例子：

```
<?php
function sum(...$numbers) {
    $acc = 0;
    foreach ($numbers as $n) {
        $acc += $n;
    }
    return $acc;
}

echo sum(1, 2, 3, 4);
?> 
```

来源： http: [//php.net/manual/en/functions.arguments.php#functions.variable-arg-list](http://php.net/manual/en/functions.arguments.php#functions.variable-arg-list)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T18:09:35.143

您可以使用`func_get_args()`，它将返回一个参数数组。

```
function work_with_arguments() {
    echo implode(", ", func_get_args());
}

work_with_arguments("Hello", "World");
//Outputs: Hello, World 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T18:09:38.203

在函数内部调用`[func_get_args()](http://php.net/manual/en/function.func-get-args.php)`将返回传递给 PHP 的参数数组。

# mercurial - 在 Mercurial 中，是否可以在 Web 视图中显示 2 个修订版之间的差异？

> ID：12165004
> 
> 赞同：2
> 
> 时间：2012-08-28T18:07:32.027
> 
> 标签：mercurial

从命令行，命令将像这样运行：

```
hg diff -r250 -r260 path/to/myfile.py 
```

是否有可能在 web 视图中获得这样的视图？像[这样](http://hg.rabbitmq.com/rabbitmq-c/diff/42b43818025f/tests/test_tables.c)的差异视图，但是对于两个不成功的修订？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T20:06:48.170

目前这是不可能的（从 Mercurial 2.3 开始）。

Mercurial 2.3 版引入了并排比较视图，但它仅显示每个变更集引入的差异（即修订与其父版本之间）。

我建议使用第三方的、基于 GUI 的 diff 工具，并启用和配置 Mercurial 的[extdiff](http://mercurial.selenic.com/wiki/ExtdiffExtension)扩展以使用它。然后你可以通过 extdiff 运行你的 diff 命令：

```
hg extdiff -r250 -r260 path/to/myfile.py 
```

# php - 确定哪些用户上传了图片？

> ID：12165005
> 
> 赞同：-1
> 
> 时间：2012-08-28T18:07:41.197
> 
> 标签：php, mysql, linux, scripting, mysql5

我有一个用户数据库，我允许将他们的图像上传到他们的个人资料中。数据库中没有迹象表明每个人都将图像上传到了他们的个人资料中，而这正是我需要知道的。

有什么方法可以确定数据库中的用户已经采取了上传图片的操作吗？

欢迎对此提出所有想法。确实需要知道以便在登录时提示那些还没有登录的人。

谢谢~

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:09:49.680

您需要将图像链接到用户。
一种方法是向图像添加 user_id 键。追溯如果没有记录或跟踪哪个用户上传了图像，则没有。但是从这里开始，您可以设置您的数据库来跟踪这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:21:49.753

我们确实需要有关您网站的代码和数据库结构的更多信息。图像是如何存储的？显示用户图像的脚本有什么作用？图像首先是如何映射到用户的？

您需要做的就是显示配置文件图像的脚本正在做的事情。在您的数据库中放置另一个字段，该字段可以存储用户是否上传了图像。然后，编写另一个脚本，该脚本可以通过您的每个用户，并（使用显示个人资料图像时使用的相同方法）检查​​用户的个人资料图像是否为默认值。如果不是，请为该用户更新数据库中的新字段。

确保更新您的代码，以便任何新上传的内容也会更新此新字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:09:13.610

当他们最初上传照片时在您的数据库中设置一个布尔值（并随时更改它，例如如果他们删除照片），然后检查该布尔值以查看您是否应该显示提示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T18:17:13.443

您的网站上有用户，这意味着您可以通过他们的 cookie 或会话跟踪登录的用户。

当用户登录时，php 脚本应该为每个用户创建一个唯一的 cookie 值并将其放入数据库，然后读取 cookie 或会话并检查哪些用户拥有此 cookie 或会话。

要检测是哪个用户上传了图片，您可以将名为的图片表列放入`image_path`并存储上传图片的路径。添加到标识用户的同一表列中。

上传后：

`UPDATE your_table SET image_path='$path to the image' WHERE ..#then user identifier in the second column`

# mysql - 在这种情况下是否有必要转义插入值？

> ID：12165009
> 
> 赞同：1
> 
> 时间：2012-08-28T18:07:56.130
> 
> 标签：mysql, sql, insert, escaping

在将单个元组插入表时，我习惯于转义字符串，但我没有找到任何关于在插入情况下转义字符串的信息，例如：

```
INSERT INTO TABLE1 SELECT * FROM TABLE2 WHERE ... 
```

...我知道 TABLE1 和 TABLE2 必须具有相同的列（并且它们具有）。但我不确定逃跑。谁能告诉我 MySQL 在这种插入情况下是如何操作的，如果有必要，我应该如何转义字符串？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:10:28.177

在所示情况下，无需转义任何内容，因为您完全在数据库中工作。显然，当填充到 table2 中时，数据必须已经被转义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:09:15.390

不要逃避任何事情。使用支持预处理语句的解决方案（如 PDO 或 mysqli）。

**编辑**

接受 OP 不是在谈论 PHP 的可能性，我可以概括我的回答是说，无论您使用什么，请务必使用支持准备好的语句的 API。如果您使用的是 .NET 堆栈、Ruby、Python 或几乎任何可用的东西，那么您可能有一个开箱即用的 API 可以支持这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T18:13:52.423

`INSERT INTO TABLE1 SELECT * FROM TABLE2`没问题。如果您在`WHERE ...`部件中有任何用户输入，则需要以您熟悉的相同方式对其进行转义。

# c# - 带有 MonoDevelop 的 System.TypeLoadException

> ID：12165014
> 
> 赞同：2
> 
> 时间：2012-08-28T18:08:10.153
> 
> 标签：c#, f#, mono, monodevelop, linux-mint

[昨天我按照这个答案](https://askubuntu.com/questions/181142/how-do-i-install-monodevelop-2-10-or-later-on-12-04)中建议的步骤在我的 Linux Mint 13 设置上安装了 MonoDevelop 3.0 。但是，当我尝试创建任何提供的类型的新解决方案时，我收到以下错误：

```
An error has occurred.

A type load exception has occurred.

System.TypeLoadException: A type load exception has occurred.
  at (wrapper managed-to-native) System.Reflection.MonoCMethod:InternalInvoke (System.Reflection.MonoCMethod,object,object[],System.Exception&)
  at System.Reflection.MonoCMethod.Invoke (System.Object obj, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture) [0x00000] in <filename unknown>:0 
```

这个错误是什么意思，我该如何解决？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T15:21:04.213

我的一台开发机器设置为双启动 Windows 7 和 Ubuntu 12.04，由于我只在 Ubuntu 上安装了 Monodevelop 2.8，我想我会按照您引用的答案（来自 askubuntu）中的步骤进行操作。

当我运行该`sudo apt-add-repository ppa:directhex/ppa`命令时，我收到一条大警告消息，说 PPA 始终包含最新的、*可能不稳定*的 Monodevelop 源，并建议改用[badgerports.org](http://badgerports.org)的 PPA 。Badgerports 只使用稳定的、经过测试的源——在撰写本文时，它有 Monodevelop 版本`3.0.3.2+dfsg-1~dhx1~precise1`。

所以，我点击`Ctrl+C`取消`apt-add-repository`命令，而是按照这些[说明设置 Badgerports PPA](http://badgerports.org/help.html)。之后，我运行命令来更新本地包数据库并安装 Monodevelop：

```
sudo apt-get update
sudo apt-get install monodevelop 
```

一旦安装了 monodevelop，我就可以启动它并创建/构建/调试一个新的 C# 示例项目而不会出现问题。

要安装 F# 加载项，我在顶级菜单之一（我认为是“工具”）下找到了一个“加载项”选项，展开了树的“语言绑定”节点，选择了 F# 语言绑定并单击“安装”。那时，我能够毫无问题地创建/构建/调试一个新的 F# 项目。

警告：我从 Windows/VS2010 复制了一个现有的 F# 项目，然后尝试构建/调试它。我遇到了一个与您类似的错误，然后 Monodevelop 严重崩溃（我不得不处理`kill`这个过程）。

如果您在从 Badgerports 安装 Monodevelop 后无法正常工作，您应该联系 Mono 和 Monodevelop 开发人员，让他们对此进行调查——该异常消息让我相信这可能是 Mono 中的一个错误，但也可能是触发它的 Monodevelop 中的一个错误。

# java - 如何在android中解析json字符串

> ID：12165015
> 
> 赞同：2
> 
> 时间：2012-08-28T18:08:12.847
> 
> 标签：java, android, eclipse, json, httpresponse

我是安卓新手。我对 Android 中的 JSON 解析略知一二。我正在解析一个 twitter 提要，我想在其中解析名为“user”的标签，其中包含`profile_image_url`和`screen_name`.

JSON 提要在[这里](https://api.twitter.com/1/statuses/user_timeline.json?screen_name=@Samanthaprabhu2&count=50)。这是我的代码：

```
JSONParser jParser = new JSONParser();

// getting JSON string from URL
JSONObject json = jParser.getJSONFromUrl(url);

try {
    // Getting Array of Contacts

    contacts = json.getJSONArray(USER);

    // looping through All Contacts
    for(int i = 0; i < contacts.length(); i++){
        JSONObject c = contacts.getJSONObject(i);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:11:18.060

您可以在 Android中使用[JSONObject 。](http://developer.android.com/reference/org/json/JSONObject.html)

```
 JSONParser jParser = new JSONParser();

    // getting JSON string from URL
    String jsonString = jParser.getJSONFromUrl(url).tostring();

    JSONArray json= new JSONArray(jsonString);

    try {

        // looping through All Contacts
            for(int i = 0; i < json.length(); i++){
              JSONObject contacts = json.getJSONObject(i);

                JSONObject user = contacts.getJSONObject("user");

                String imageUrl = user.getString("profile_image_url");
                String screenName = user.getString("Screen_name");

            }
        }catch(Exception e)
   {
   } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:11:36.203

您可以使用`json.org`允许轻松处理 JSON 文件的库，这些库包含在 Android 中。

但是，您可以使用它`Gson from Google, or Jackson`来执行此操作....

**看到这个网站非常有帮助：**

[http://www.vogella.com/articles/AndroidJSON/article.html](http://www.vogella.com/articles/AndroidJSON/article.html)

上面的这个站点还解释了 twitter Json 解析..

**例如：**

```
 JSONObject jsonObject = jsonArray.getJSONObject(i);
    jsonObject.getString("name"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T18:48:10.027

使用`Gson`. 检查[用户指南](https://sites.google.com/site/gson/gson-user-guide)。

示例模型：

```
Class User
{
   public String profile_image_url;
   public String screen_name;
} 
```

示例解析器：

```
Gson gson = new Gson();
User user = gson.fromJson("['profile_image_url':'the_url', 'screen_name':'the_name']", User.class); 
```

PS：确保`profile_image_url`json 中的名称与 Class 的成员名称完全相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T18:12:39.530

这是我从 Youtube 获取频道列表的代码，希望对您有所帮助

```
public void getYouTubeData(){
    StringBuilder urlString = new StringBuilder();
    HttpURLConnection urlConnection = null;
    URL url = null;
    urlString.append("http://gdata.youtube.com/feeds/api/users/CaliforniaDMV/playlists?v=2&alt=json");
    m_ytdata = new ArrayList<YoutubeChannelList.YouTubePlayListData>();

    try {
        url = new URL(urlString.toString());
    } catch (MalformedURLException e2) {
        // TODO Auto-generated catch block
        e2.printStackTrace();
    }
    try {
        urlConnection = (HttpURLConnection) url.openConnection();
    } catch (IOException e2) {
        // TODO Auto-generated catch block
        e2.printStackTrace();
    }
    try {
        urlConnection.setRequestMethod("GET");
    } catch (ProtocolException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
    urlConnection.setDoOutput(true);
    urlConnection.setDoInput(true);
    try {
        urlConnection.connect();
    } catch (UnknownHostException e) {
        e.printStackTrace();
    } catch (IOException e){
        e.printStackTrace();
    }
    InputStream inputStream = null;
    try {
        inputStream = urlConnection.getInputStream();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    String result = null;
    if(inputStream != null){
     result = convertStreamToString(inputStream);
    } else {
        Log.d("NULLLL","NULL");
    }
    try {
        inputStream.close();
    } catch (IOException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
    urlConnection.disconnect();
    try {
        final JSONObject json = new JSONObject(result);
        final JSONObject jsonentry = json.getJSONObject("feed");
        int length = jsonentry.length();
        //final JSONObject jsonarr = jsonentry.getJSONObject("entry")
        final JSONArray jsonarr = jsonentry.getJSONArray("entry");
        int len = jsonarr.length();

        //Log.d("XXX", "Length is " + length + "arry len: " + len);

        for(int loop = 0;loop<len;loop++){
            YouTubePlayListData yt = new YouTubePlayListData();
            final JSONObject inner = jsonarr.getJSONObject(loop);
            yt.setIds(inner.getJSONObject("yt$playlistId").getString("$t"));
            //yt.setVideoId(getThumbnailImage(inner.getJSONObject("yt$playlistId").getString("$t")));
            yt.setUpdated(inner.getJSONObject("updated").getString("$t").substring(0,10));
            yt.setTitles(inner.getJSONObject("title").getString("$t"));
            yt.setCount(Integer.parseInt(inner.getJSONObject("yt$countHint").getString("$t")));
            //Log.d("LOOP","id: " +inner.getJSONObject("yt$playlistId").getString("$t"));
            //Log.d("LOOP","updated: " + inner.getJSONObject("updated").toString());
            //Log.d("LOOP","title: " + inner.getJSONObject("title").getString("$t"));
            m_ytdata.add(yt);
        }
        runOnUiThread(returnRes);

    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-28T18:44:26.870

android 提供的 vanilla JSON 解析器可以解析数据，不幸的是它在内存中构建了完整的 JSON 模型（如 XML 的 DOM 解析器）——这适用于少量数据，但对于稍大的数据则不切实际，因为它分配和占用了很多记忆。

一些像 GSON oder jackson 这样的 pull parser 会更适合您的任务（jackson 声称更快，但也更重的 jars 和更多的依赖项 - 我更喜欢 GSON）

您还可以考虑简单的数据绑定库：

[https://github.com/ko5tik/jsonserializer](https://github.com/ko5tik/jsonserializer)

（罐子可从 maven central 获得）

有了它，JSON 的解析就变成了这样：

[https://github.com/ko5tik/accmeter/blob/master/src/main/java/de/pribluda/android/accmeter/file/SampleReader.java](https://github.com/ko5tik/accmeter/blob/master/src/main/java/de/pribluda/android/accmeter/file/SampleReader.java)

（只需提供 java.io.Reader 和类来填写字段）

# html - 有没有办法为记事本++、HTML编码启用智能感知？

> ID：12165017
> 
> 赞同：24
> 
> 时间：2012-08-28T18:08:16.383
> 
> 标签：html, notepad++

有没有办法为记事本++启用智能感知？

我听说最接近的东西是一个叫做fingertext的插件，但我不知道如何使用它。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-05-03T14:30:10.357

是的，NP++ v6.6.8 中有一个，默认情况下是禁用的。要启用它，请在菜单栏中导航到：

> 1.  设置
> 2.  优先
> 3.  自动完成
> 4.  勾选*“在每个输入上启用自动完成”*
> 5.  关闭

# javascript - D3：如何更改现有条形图中的数据

> ID：12165021
> 
> 赞同：4
> 
> 时间：2012-08-28T18:08:47.320
> 
> 标签：javascript, charts, d3.js, updates

我已经成功构建了我的初始条形图。现在我想使用转换向现有图表添加更多条形以获得良好的用户体验。

这是我的代码：

```
var data = [23, 85, 67, 38, 70]; //dummy, normally much more
labellist = ['label1','label2','label3','label4','label5'];

var w = 815,
    h = 500,
    labelpad = 165,
    x = d3.scale.linear().domain([0, 100]).range([0, w]),
    y = d3.scale.ordinal().domain(d3.range(data.length)).rangeBands([0, h], .2);

mySvg = d3.select("#chart")
  .append("svg");

vis = mySvg.attr("width", w + 40)
    .attr("height", h + 20)
    .append("svg:g")
    .attr("transform", "translate(20,0)");

bars = vis.selectAll("g.bar")
    .data(data)
    .enter().append("svg:g")
    .attr("class", "bar")
    .attr("transform", function(d, i) { return "translate(" + labelpad + "," + y(i) + ")"; })

bars.append("svg:rect")

    .transition()
    .duration(500)
    .attr("width", x)
    .attr("height", y.rangeBand())
    ;

var rules = vis.selectAll("g.rule")
    .data(x.ticks(10))
  .enter().append("svg:g")
    .attr("class", "rule")
    .attr("transform", function(d) { return "translate(" + x(d) + ", 0)"; });

rules.append("svg:line")
    .attr("y1", h)
    .attr("y2", h + 6)
    .attr("x1", labelpad)
    .attr("x2", labelpad)
    .attr("stroke", "black");
rules.append("svg:line")
    .attr("y1", 0)
    .attr("y2", h)
    .attr("x1", labelpad)
    .attr("x2", labelpad)
    .attr("stroke", "white")
    .attr("stroke-opacity", .3); 
```

如何以编程方式更改数据以添加和删除其他条并让现有条向上/向下滑动？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T23:17:38.870

您需要为条形数据分配某种形式的键，以便 d3 可以识别上一组中存在的键。默认是基于索引的，这可能是你想要的。

就转换而言，您希望将代码更改为以下内容：

```
bars = vis.selectAll("g.bar")
    .data(data);

bars.enter().append("svg:g")
    .attr("class", "bar")
    .append("svg:rect").

bars.transition().duration(500)
    .attr("transform", function(d, i) { 
         return "translate(" + labelpad + "," + y(i) + ")"; 
     })
    .selectAll("svg:rect")
    .attr("width", x)
    .attr("height", y.rangeBand())
;

bars.exit().transition().duration(500)
    .selectAll("svg:rect")
    .attr("height", 0)
    .remove(); 
```

“enter()”函数最好用于立即创建结构。然后使用初始选择对象（条形图）将新数据应用于所有元素。

您可能还想删除所有过时的栏。在这里，我将它们的大小调整为 0，然后将它们删除，但您可以对其进行修改以获得您想要的效果。

# java - Semaphore.acquire() 是否会因虚假唤醒而引发 InterruptedException？

> ID：12165030
> 
> 赞同：11
> 
> 时间：2012-08-28T18:09:09.367
> 
> 标签：java, semaphore, java.util.concurrent

一个看似简单的问题：我有一个[`java.util.concurrent.Semaphore`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Semaphore.html)，并且我想使用[`acquire()`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Semaphore.html#acquire()).

如果线程被中断，则指定该`acquire()`方法抛出：`InterruptedException`

> 如果当前线程：
> 
> *   在进入此方法时设置其中断状态；或者
> *   在等待许可时被打断，
> 
> 然后抛出 InterruptedException 并清除当前线程的中断状态。

但是，可能抛出的方法的常见模式`InterruptedException`是在循环中调用它们，因为线程可能会受到看起来与被中断相同的虚假唤醒的影响。例如，[文档`Object.wait(long)`](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#wait(long))说：

> 线程也可以在没有被通知、中断或超时的情况下唤醒，即所谓的虚假唤醒。虽然这在实践中很少发生，但应用程序必须通过测试应该导致线程被唤醒的条件来防范它，如果条件不满足则继续等待。换句话说，等待应该总是在循环中发生。

那么问题来`Semaphore.acquire()`了，是否会受到同样的虚假唤醒？合乎逻辑的答案是“不”，但我找不到任何证据，事实上证据似乎指向另一个方向。

查看[源代码`Semaphore`](http://hg.openjdk.java.net/jdk6/jdk6-gate/jdk/file/tip/src/share/classes/java/util/concurrent/Semaphore.java)，它似乎将实际的获取委托给一个[`AbstractQueuedSynchronizer`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/locks/AbstractQueuedSynchronizer.html)，根据[其源代码](http://hg.openjdk.java.net/jdk6/jdk6-gate/jdk/file/tip/src/share/classes/java/util/concurrent/locks/AbstractQueuedSynchronizer.java)委托给`LockSupport.park()`.

明确提到虚假唤醒的[文档`LockSupport.park()`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/locks/LockSupport.html#park())`AbstractQueuedSynchronizer.doAcquireInterruptably()`，但似乎只是检查`Thread.interrupted()`然后 throw的实现`InterruptedException`。

所以，除非我遗漏了一些东西（这很有可能），否则它似乎`Semaphore.acquire()` **会**抛出`InterruptedException`虚假？

那是对的吗？更重要的是，我能做些什么吗？我可以使用`Semaphore.acquireUninterruptably()`，但我不想要一个不间断的等待，只是一个不会被虚假中断的等待。有没有其他选择？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T18:19:12.887

是“虚假唤醒”而不是“虚假中断”：“一个线程也可以在没有被通知、中断或超时的情况下唤醒，即所谓的虚假唤醒。” 在虚假唤醒期间没有抛出 InterruptedException。正如您在评论中所说：线程唤醒但未设置中断标志。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T18:24:02.707

我想如果你考虑一下`Semaphore.acquire()`API，你会意识到它不可能有虚假的唤醒，主要是因为调用者无法区分“虚假”和“正常”，因此该方法是*无用*的。

# google-app-engine - 为什么 GAE 文件系统是只读的？

> ID：12165035
> 
> 赞同：-1
> 
> 时间：2012-08-28T18:09:16.503
> 
> 标签：google-app-engine, filesystems, readonly

> **可能重复：**
> [Google App Engine 是否允许在服务器上创建文件和文件夹？](https://stackoverflow.com/questions/2693081/does-google-app-engine-allow-creation-of-files-and-folders-on-the-server)

我不喜欢 GAE 的这个功能。为什么 GAE 的文件系统是只读的？有时我需要将信息存储在 xml 文件中，有时还需要将一些数据保存在文本文件中。谁能解释一下为什么 GAE 提供只读文件系统？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T02:51:05.657

请记住，任何 App Engine 应用程序都可能在许多数据中心的许多不同机器上运行许多副本。如果您可以将文件写入文件系统，则必须在所有正在运行的实例以及从那一刻起创建的每个新实例上一致地复制该文件。

您可以使用 blobstore（正如 Bugs 指出的那样，它可以自己提供文件而不会打扰您的应用程序）、结合 memcache 的数据存储（这通常足够快）、Google 的 Cloud Storage（与 Amazon 的 S3 非常相似并且可以也可以自己提供文件）甚至是您通过 http 访问的外部服务（例如 S3）。

您可以在字符串上生成 XML 文件并将其存储。当有人点击你的`/myfile.xml`时，你需要做的就是读回它（从你存储它的任何地方）并提供它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:15:18.230

你的问题之前已经回答过了。看看[Google App Engine 是否允许在服务器上创建文件和文件夹？](https://stackoverflow.com/questions/2693081/does-google-app-engine-allow-creation-of-files-and-folders-on-the-server)

如果您需要永久存储文件，我建议您使用 blobstore（[Java](https://developers.google.com/appengine/docs/java/blobstore/overview)、[Python](https://developers.google.com/appengine/docs/python/blobstore/)、[Go ）。](https://developers.google.com/appengine/docs/go/blobstore/)

# email - 发生错误/异常时如何从 jBoss 发送电子邮件？

> ID：12165044
> 
> 赞同：1
> 
> 时间：2012-08-28T18:09:38.713
> 
> 标签：email, jboss, error-handling

我想设置我的 jBoss (4.2.3GA) 服务器，以便每次发生异常时它都可以向 Exchange 邮箱发送电子邮件，这样开发人员和管理员就可以使用他们的手机查看正在发生的事情。

有什么想法吗？

非常感谢你

查尔斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T12:58:16.053

您可以使用 log4j appender

```
log4j.appender.sendMail=org.apache.log4j.net.SMTPAppender
log4j.appender.sendMail.To=<email id>
log4j.appender.sendMail.From=</email><email id>
log4j.appender.sendMail.SMTPHost=<mail hostname>
log4j.appender.sendMail.Subject=Log4J Message
log4j.appender.sendMail.layout=org.apache.log4j.PatternLayout 
```

[log4j 文档](http://logging.apache.org/log4j/2.x/)

# ios - 应用程序仅与（lldb）崩溃？

> ID：12165054
> 
> 赞同：1
> 
> 时间：2012-08-28T18:09:57.350
> 
> 标签：ios, crash, instruments, lldb

我有一个混合了 Cocos2D 和一些 UIKit 的应用程序。我最近一直在实现一些新功能，所以内存管理可能是错误的或者某些东西正在过度释放，但是每当我通过单击主页按钮退出应用程序时，控制台就会崩溃仅使用消息（lldb）。即使我打开 NSZombiesEnabled 也没有什么不同。

我的应用程序唯一指向的是一条如下所示的行：

```
libGPUSupportMercury.dylib`gpus_ReturnNotPermittedKillClient:
0x38101094:  trap   
0x38101096:  nop 
```

我不知道这意味着什么，但我很想解决这个问题。有谁知道为什么会这样？

提前致谢！

***编辑***：我认为这是因为我在执行 unscheduleAllSelectors 和 stopAnimation 之后在 Cocos2D 的 CCDirector 上调用了暂停。如果我不调用那些 2，那么就没有 lldb 崩溃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:22:39.150

您的应用程序因违反异常而被终止。几乎可以肯定的是，在你的应用程序被转移到后台之后，你正在使用 GPU，这是非常非法的，并且会导致系统向你的应用程序发送终止信号。

当应用程序在调试器中运行并且它被外部信号（如终止信号）而不是调试器可以处理的东西（如马赫异常）杀死时，调试器只会为您提供它知道的任何信息并在程序入口点（这通常会导致调试器看起来像是在`main()`.

但是，需要注意的重要一点是，您必须在应用程序进入后台*之前*结束所有 GPU 活动。这样做的好地方是在通知处理程序中`UIApplicationWillResignActiveNotification`或在类似名称的应用程序委托回调中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:20:26.917

这可能意味着您仍在尝试在 OpenGL 中渲染内容（通过 Cocos2D），这在应用程序处于后台时是不允许的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T23:33:24.197

原来这是我与 Cocos2D 相关的问题的实际解决方法：http: [//www.cocos2d-iphone.org/forum/topic/7326](http://www.cocos2d-iphone.org/forum/topic/7326)

# python - Python Tkinter 不会与 X-Server 断开连接

> ID：12165065
> 
> 赞同：1
> 
> 时间：2012-08-28T18:10:53.600
> 
> 标签：python, tkinter

我正在使用 Python/Tkinter 编写一个应用程序，它必须定期完全终止 GUI 组件并断开与 X-Server 的连接以完成某些操作。稍后在操作完成后，重新构建 GUI。我发现我的主窗口的 destroy() 方法似乎杀死了 GUI（它不再显示在窗口管理器客户端列表中），但并没有完全关闭与 X-Server 的连接。

我可以看到一个打开的文件描述符，它是一个套接字，我很确定它是 X-Server 的通信通道（它在我创建第一个窗口后出现）。这个开放的套接字是一个交易破坏者。虽然我想我可以关闭套接字，但我担心应该做更多的工作来正确关闭与 X-Server 的连接，以便稍后重新启动它。是否有更“完整”的方式来关闭 Tkinter GUI？有什么想法吗？

# mysql - 如何在 MySQL 中获取记录数以及最小值/最大值？

> ID：12165072
> 
> 赞同：1
> 
> 时间：2012-08-28T18:11:29.743
> 
> 标签：mysql, select, max, min, record-count

我有一个搜索表单（正在运行`MySQL 5.0.88`）来深入了解产品表。搜索是两步搜索。第一次运行得到`number of results`，第二次运行得到`data of records x-y`。

默认情况下，我在所有记录中显示最小/最大价格，现在想要根据查询结果更新最小/最大值。我在想最好的方法是在初始查询中，获取记录数。

目前它看起来像这样：

```
SELECT  COUNT( a.id ) AS recordcount
        , a.nos
        , a.nos_anzeige

FROM artikelstammdaten a

WHERE 
        a.iln != "1111111111111" AND a.iln != "2222222222222" AND a.iln != "7777777777777"
    AND a.aktiv = "ja"
    AND a.artikelnummer LIKE '%name%' 
AND (a.modus = "OPEN" 
        OR a.iln IN ( 55555555555,66666666666,2222222222222 ) 
        )

GROUP BY a.iln, a.artikelnummer, a.preis_aktuell, a.artikelbezeichnung
HAVING (( sum(a.bestand) != 0 ) OR (a.nos = "ja" AND a.anzeige  = "ja" )) 
```

这给了我所有匹配的记录。

**问题**：
实际上我只想要一条记录中的记录数（~ `query.recordcount`），而不是一条一条的记录（我的尝试`COUNT`不起作用）。像这样的东西：

```
 totalrecords    min-price   max-price
  12345           9.99        1.204 
```

我可以尝试在结果集中选择最小/最大值。

**问题**：
我如何修改我的查询，所以我只得到总记录（并且可以尝试添加最小/最大值）？

谢谢！

** 编辑：**
我的表格如下所示：

```
 CREATE TABLE dummy (
`id` INT(11) NOT NULL AUTO_INCREMENT,
`iln` VARCHAR(13) NULL DEFAULT NULL,
`ean` VARCHAR(35) NULL DEFAULT NULL,
`artikelnummer` VARCHAR(35) NULL DEFAULT NULL,
`preis_ek` DECIMAL(12,2) NULL DEFAULT NULL,
`preis_vk` DECIMAL(12,2) NULL DEFAULT NULL,
`firma` VARCHAR(35) NULL DEFAULT NULL,
`nos` VARCHAR(4) NULL DEFAULT NULL,
`nos_anzeige` VARCHAR(4) NULL DEFAULT NULL,
`aktiv` VARCHAR(4) NULL DEFAULT NULL,
`modus` VARCHAR(4) NULL DEFAULT NULL,
`bestand` DECIMAL(10,0) NULL DEFAULT '0'
 ) 
```

`preis_ek`价格将是`preis_vk`我正在寻找每个的最小/最大值的位置。谢谢！

**编辑**：像这样运行查询会给我一个这样的结果集：

```
"id"    "nos"   "nos_anzeige"   "MIN(a.preis_ek)"
"1153837"   "nein"  "nein"  "25,10"
"1153797"   "nein"  "nein"  "12,40"
.... 
```

`min`如果我没记错的话，它会选择不在结果集中的每条记录

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:25:01.893

您可以使用

```
 SELECT count(recordcount), 
       Max(max_price), 
       Min(min_price) 
       FROM   (SELECT Count(a.id)   AS recordcount, 
               a.nos, 
               a.nos_anzeige, 
               Max(preis_ek) AS max_price, 
               Min(preis_ek) AS min_price 
        FROM   artikelstammdaten a 
        WHERE  a.iln != "1111111111111" 
               AND a.iln != "2222222222222" 
               AND a.iln != "7777777777777" 
               AND a.aktiv = "ja" 
               AND a.artikelnummer LIKE '%name%' 
               AND ( a.modus = "open" 
                      OR a.iln IN ( 55555555555, 66666666666, 2222222222222 ) ) 
        GROUP  BY a.iln, 
                  a.artikelnummer, 
                  a.preis_aktuell, 
                  a.artikelbezeichnung 
        HAVING ( ( Sum(a.bestand) != 0 ) 
                  OR ( a.nos = "ja" 
                       AND a.anzeige = "ja" ) )) temp 
```

# ruby-on-rails - Heroku 上偶尔出现 Postgres 错误：无法翻译主机名“ " 到地址：名称或服务未知 (PG::Error)

> ID：12165076
> 
> 赞同：7
> 
> 时间：2012-08-28T18:11:51.683
> 
> 标签：ruby-on-rails, postgresql, heroku, unicorn

我现在在 Heroku 上使用共享的 postgres（开发/免费）计划，我在日志中看到了相当多的这个错误。不过，连接到 PG 数据库通常确实有效，所以我不确定这是否在我的控制范围内。Heroku 状态页面不会列出共享数据库发生这些情况时的任何停机时间。

使用 Rails 3.1.1 和[Unicorn Web 服务器](http://unicorn.bogomips.org/)。

**错误：** 无法将主机名“pg60.sharedpg.heroku.com ( [http://pg60.sharedpg.heroku.com](http://pg60.sharedpg.heroku.com) )”转换为地址：名称或服务未知（PG::Error）

我的[Unicorn](http://unicorn.bogomips.org/)配置文件（查看 Heroku 中 Unicorn 的推荐设置后）：

```
worker_processes 3 # amount of unicorn workers to spin up
timeout 30         # restarts workers that hang for 30 seconds
preload_app true

before_fork do |server, worker|
  # Replace with MongoDB or whatever
  if defined?(ActiveRecord::Base)
    ActiveRecord::Base.connection_handler.clear_all_connections!
    ActiveRecord::Base.connection.disconnect!
    Rails.logger.info('Disconnected from ActiveRecord')
  end

  # If you are using Redis but not Resque, change this
  if defined?(Resque)
    Resque.redis.quit
    Rails.logger.info('Disconnected from Redis')
  end
end

after_fork do |server, worker|
  # Replace with MongoDB or whatever
  if defined?(ActiveRecord::Base)
    ActiveRecord::Base.establish_connection
    ActiveRecord::Base.connection_handler.verify_active_connections!
    Rails.logger.info('Connected to ActiveRecord')
  end

  # If you are using Redis but not Resque, change this
  if defined?(Resque)
    Resque.redis = ENV['REDIS_URI']
    Rails.logger.info('Connected to Redis')
  end
end 
```

**痕迹：**

```
 328 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/postgresql_adapter.rb:1032:in `initialize': could not translate host name "pg60.sharedpg.heroku.com (http://pg60.sharedpg.heroku.com)" to address: Name or service not known (PG::Error)
219 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/postgresql_adapter.rb:1032:in `new'
223 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/postgresql_adapter.rb:1032:in `connect'
225 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/postgresql_adapter.rb:301:in `initialize'
217 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `new'
235 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `postgresql_connection'

328 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/postgresql_adapter.rb:1032:in `initialize': could not translate host name "pg60.sharedpg.heroku.com (http://pg60.sharedpg.heroku.com)" to address: Name or service not known (PG::Error)
219 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/postgresql_adapter.rb:1032:in `new'
223 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/postgresql_adapter.rb:1032:in `connect'
225 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/postgresql_adapter.rb:301:in `initialize'
217 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `new'
235 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `postgresql_connection'
235 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:304:in `new_connection'
244 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:323:in `checkout_new_connection'
249 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:265:in `block (2 levels) in checkout'
225 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:261:in `loop'
238 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:261:in `block in checkout'
153 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /usr/local/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
229 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:260:in `checkout'
231 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:162:in `connection'
240 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:409:in `retrieve_connection'
249 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/abstract/connection_specification.rb:107:in `retrieve_connection'
239 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/connection_adapters/abstract/connection_specification.rb:89:in `connection'
194 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record/base.rb:703:in `table_exists?'
128 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/app.rb:38:in `<top (required)>'
116 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from config.ru:9 (http://config.ru:9):in `require'
124 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from config.ru:9 (http://config.ru:9):in `block in <main>'
179 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'
176 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'
112 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from config.ru:1 (http://config.ru:1):in `new'
115 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from config.ru:1 (http://config.ru:1):in `<main>'
168 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/unicorn-4.2.0/lib/unicorn.rb:44:in `eval'
180 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/unicorn-4.2.0/lib/unicorn.rb:44:in `block in builder'
181 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/unicorn-4.2.0/lib/unicorn/http_server.rb:691:in `call'
187 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/unicorn-4.2.0/lib/unicorn/http_server.rb:691:in `build_app!'
182 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/unicorn-4.2.0/lib/unicorn/http_server.rb:136:in `start'
178 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/gems/unicorn-4.2.0/bin/unicorn:121:in `<top (required)>'
146 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/bin/unicorn:19:in `load'
148 <13>1 2012-08-27T21:36:37+00:00 d.4122435c-cb44-421a-9a7d-a68bb10457d6 app web.1 (http://web.1) - - from /app/vendor/bundle/ruby/1.9.1/bin/unicorn:19:in `<main>' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T23:24:16.533

那是一个[DNS](http://en.wikipedia.org/wiki/Domain_Name_System)错误。极不可能与您的代码有任何关系。如果您的 Rails 应用程序和数据库都在 Heroku 中，请联系 Heroku 支持。

如果您的 Rails 应用程序在 Heroku 云*之外*运行（搜索“独角兽”一词表明它可能是这样的；*请链接到这样的东西；不是每个人都知道“独角兽”是什么*），您需要进行一些调试找出 DNS 问题出在哪里。它是您的应用程序使用的递归 DNS 服务器吗？一些更接近的缓存服务器？一些用于解析 Heroku 的 DNS 的中间服务器（不太可能）？Heroku的DNS本身？是否是丢包问题，服务器以误报响应的问题，循环集群中的一台坏服务器，......？预计会花费大量时间[`dig +trace`](http://www.madboa.com/geek/dig/)与[`traceroute`](http://en.wikipedia.org/wiki/Traceroute)or一起使用[`mtr`](http://www.bitwizard.nl/mtr/)- 假设您可以[ssh](http://en.wikipedia.org/wiki/Secure_Shell)进入。如果您有 root 权限，[`tcpdump`](http://www.tcpdump.org/)并且[`tshark`](http://www.wireshark.org/docs/man-pages/tshark.html)如果您可以访问它们，检查您正在使用的 DNS 服务器的日志也可能很有用。

如果您没有 shell 访问权限，那么您几乎必须得到与您托管的人的支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-24T22:46:16.693

Just for reference, I had the same problem (Heroku was having an issue with AWS). Here was the helpful response from customer service (08/15):

> We are occasionally seeing DNS resolution failure on our instances and we're working to solve this with AWS. The issue is really intermittent and unfortunately we're having hard time trying to identify the cause. While we're investigating, I have one workaround for this issue - currently, you're using Django's default way for the database connection - which is trying to make a new connection per request. This is pretty expensive, also this means you'll need to do DNS resolution for your every request which would increase the possibility to face this issue very unfortunately. Instead, I recommend that you use connection pooling. You can find some examples here:
> 
> [https://devcenter.heroku.com/articles/python-concurrency-and-database-connections](https://devcenter.heroku.com/articles/python-concurrency-and-database-connections)
> 
> One customer who was seeing this issue occasionally (but frequently, with Django app) saw a good improvement with the connection pooling, this should help a lot to prevent it from happening.

# windows-phone-7 - 在列表框中按列显示项目

> ID：12165081
> 
> 赞同：0
> 
> 时间：2012-08-28T18:12:13.127
> 
> 标签：windows-phone-7, windows-phone

在我的应用程序中，我已将存储在视图模型中可观察集合中的图像绑定到 xaml 上的列表框，结果是垂直滚动列表（一列），而我想在 2 列视图中显示图像。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T05:38:52.927

这就是我最终实现它的方式。保持我的图像的大小，以便在 Wrappanel 中仅将两个图像包裹在一行中，使其成为两列。

```
 <ScrollViewer>
            <ItemsControl ItemsSource="{Binding ImageList}" ItemTemplate="{StaticResource ImageTemplate}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <toolkit:WrapPanel />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
            </ItemsControl>
        </ScrollViewer> 
```

# python - 在 MediaPlayer 中使用 d-bus 播放音乐列表

> ID：12165082
> 
> 赞同：0
> 
> 时间：2012-08-28T18:12:15.317
> 
> 标签：python, dbus

这个 python 程序将播放来自 Mediaapplayer 的播放列表。当一首歌曲结束或在键盘上键入后，播放列表将播放下一首歌曲。

**输入是：**

```
#!/usr/bin/python
#-*-coding:ascii-*-

import dbus
import gobject

from dbus.mainloop.glib import DBusGMainLoop
DBusGMainLoop(set_as_default=True)
bus = dbus.SessionBus()

banshee = bus.get_object('org.mpris.MediaPlayer2.banshee',
               '/org/mpris/MediaPlayer2')
iface = dbus.Interface(banshee,'org.mpris.MediaPlayer2.Player')

loop = gobject.MainLoop()
def on_reply():
        print"Start"
def on_error():
        print"Error"
def next_song():
        print"Next Song"
        iface.Next(reply_handler=on_reply,
        error_handler=on_error)
        gobject.timeout_add(4,next_song)
def on_error(error):
        print"Error"
        loop.quit()
        next_song()
try:
        loop.run()
finally:
        print"End"
        iface.Stop() 
```

**输出：** 无

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T08:56:20.357

路径错了。正确的路径是：

banshee = bus.get_object("org.bansheeproject.Banshee", "/org/bansheeproject/Banshee/PlayerEngine")

在[下一页上](https://www.madsoft.org/2008/06/10/interfacing-banshee-10-with-dbus-and-python/)，您将获得有关该路径及其工作原理的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T06:26:34.993

您可以使用[d-feet](https://live.gnome.org/DFeet/)查看该方法在您尝试使用的界面上是否可用。

您还可以使用`dbus-monitor`来查看总线上传递了哪些消息。语法应该是这样的：

```
dbus-monitor --monitor --address <your_bus_address> 
```

您将使用上面的命令获得总线上的所有消息。要过滤，您可以执行以下操作：

```
dbus-monitor --monitor --address <your_bus_address> interface=<IF_name> path=<path_name> dest=... 
```

您不能在过滤中使用部分接口/路径名称。您始终可以使用 grep 进行一些高级过滤。

如果该方法在该接口上不可用，或者您尝试使用错误的参数类型集调用它，您通常会收到此错误。在您的调用代码中检查函数签名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T03:45:22.437

mdbus2 应该给出可用方法的列表。取自[此页面](http://www.mabishu.com/blog/2010/11/15/playing-with-d-bus-interface-of-spotify-for-linux/)：

```
$ mdbus2 org.mpris.MediaPlayer2.spotify /org/mpris/MediaPlayer2
...
[METHOD]    org.mpris.MediaPlayer2.Player.Pause() -> ()
[METHOD]    org.mpris.MediaPlayer2.Player.PlayPause() -> ()
[METHOD]    org.mpris.MediaPlayer2.Player.Stop() -> ()
[METHOD]    org.mpris.MediaPlayer2.Player.Play() -> ()
... 
```

调整示例以反映您正在与 Banshee 交互的事实。我尝试安装 Banshee 和 mdbus2 自己尝试，但安装程序脚本失败。

您也可以尝试使用 Python 的内置工具进行自省。

```
$ python
>>> from org.mpris.MediaPlayer2 import Player
>>> dir(Player) 
```

更好的是，在您的程序中删除类似的语句。您的代码体目前非常简单，您可以打印出 dir() 的结果。

```
finally:
    print"End"
    dir(iface)
    iface.Stop() 
```

# javascript - 单击链接时如何将引导轮播旋转到特定位置？

> ID：12165083
> 
> 赞同：0
> 
> 时间：2012-08-28T18:12:22.240
> 
> 标签：javascript, css, hyperlink, twitter-bootstrap, carousel

我有多个基于文本的链接，我想连接到轮播中，这样如果有人单击链接，它将轮播旋转到相应的显示。

另外，如果轮播当前在与该链接一起显示的显示器上，我想通过 CSS 使这些链接具有不同的颜色。

我是引导程序的新手，这是我第一次尝试使用它。任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T20:23:39.477

尝试使用下一个方案：

1.  [标记](http://pastebin.com/Wmv517VB)

2.  Javascript

    ```
    $("#Carousel").carousel({
        interval: 5000,
        pause: "hover"
    });

    $("#Carousel").bind("slid", function() {
        var a = $("#Carousel .item.active").index();
        $("#CarouselControls .carousel_control ").removeClass("active").eq(a).addClass("active")
    });

    $("#CarouselControls .carousel_control ").click(function() {
        var a = $(this).index();
        $("#CarouselControls .carousel_control ").removeClass("active").eq(a).addClass("active");
        $("#Carousel").carousel(a)
    }) 
    ```

# c# - 在表单提交之前显示 MVC3 [必需] 验证消息

> ID：12165085
> 
> 赞同：2
> 
> 时间：2012-08-28T18:12:38.947
> 
> 标签：c#, asp.net-mvc-3, razor, validation

我有一个具有数字和字符串属性的模型，每个属性都有 [Required] 验证注释。我也有一个相应的视图，它是这个模型的输入表单。出于某种原因，一旦加载视图，字符串属性所需的验证消息就会立即显示，而数字属性所需的验证消息仅在用户尝试提交表单时才显示（如预期的那样）。有没有人知道字符串属性上的奇怪验证行为？

*更新*

我将问题缩小到从控制器操作显示视图的“复杂”方式。在我的例子中，我有一个控制器操作 Create，负责创建一个具有许多属性的实体。由于实体具有许多属性，因此我通过服务器端向导将此过程拆分为多个步骤。以下是我的控制器操作的简化版本：

```
public ActionResult Create()
    {
        Model = new CreateEditListingViewModel();
        return View("StepOne");
    }

    [HttpPost]
    public ActionResult Create(string buttonValue, StepOneViewModel stepOneModel, StepTwoViewModel stepTwoModel, StepThreeViewModel stepThreeModel)
    {
        ActionResult nextView = null;
        CreateListingSteps step = (CreateListingSteps)Enum.Parse(typeof(CreateListingSteps), buttonValue);
        // Save the value of the step that has been submitted and redirect user to next step
        switch (step)
        {
            case CreateListingSteps.StepOne:
                Model.StepOne = stepOneModel;
                nextView = View("StepTwo");
                break;
            case CreateListingSteps.StepTwo:
                Model.StepTwo = stepTwoModel;
                nextView = View("StepThree");
                break;
            case CreateListingSteps.StepThree:
                Model.StepThree = stepThreeModel;
                nextView = View("Confirm");
                break;
        }
        return nextView;
    } 
```

显然发生的事情是，一旦用户第一次单击“下一步”按钮（在所有步骤视图中都可用），就会为所有后续表单触发验证，因此即使用户尚未提交表单，也会不希望地将字符串字段显示为无效.

![尚未提交的空白表单，显示描述字段的必填信息。 价格经常出现，因为它的数据类型不是字符串](../Images/0111e52361b3473465f5de336df27832.png)

谁能想到一个解决方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T13:35:52.643

我解决了。我所需要的只是`ModelState.Clear()`在返回新视图之前调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:14:04.963

尝试使用`String.Empty`.

# xsd - wsdl 中复杂类型的响应消息中的元素顺序错误

> ID：12165088
> 
> 赞同：1
> 
> 时间：2012-08-28T18:13:00.850
> 
> 标签：xsd, wsdl, axis

我有一个使用axis+ant+jboss生成的wsdl文件。

超类 ActionInfo wsdl 定义：

代码：

```
<complexType abstract="true" name="ActionInfo">
 <sequence>
  <element name="configUnitId" nillable="true" type="xsd:string"/>
  <element name="configUnitType" nillable="true" type="xsd:string"/>
  <element name="desc" nillable="true" type="xsd:string"/>
  <element name="errorCode" nillable="true" type="xsd:int"/>
  <element name="id" nillable="true" type="tns2:ResourceIdentityInfo"/>
  <element name="result" nillable="true" type="xsd:string"/>
  <element name="status" nillable="true" type="xsd:string"/>
 </sequence>
</complexType> 
```

子类 PushActionInfo wsdl 定义：

代码：

```
<complexType name="PushActionInfo">
<complexContent>
 <extension base="tns19:ActionInfo">
  <sequence>
   <element name="activationMethod" nillable="true" type="xsd:string"/>
   <element name="activationRequired" type="xsd:boolean"/>
   <element name="binaryContent" type="xsd:boolean"/>
   <element name="category" nillable="true" type="xsd:string"/>
   <element name="contentType" nillable="true" type="xsd:string"/>
   <element name="destinationName" nillable="true" type="xsd:string"/>
   <element name="dynamic" type="xsd:boolean"/>
   <element name="maskableContent" nillable="true" type="tns2:MaskableContentInfo"/>
   <element name="payloadName" nillable="true" type="xsd:string"/>
   <element name="postOps" nillable="true" type="impl:ArrayOf_xsd_string"/>
   <element name="pushMechanism" type="xsd:int"/>
   <element name="rollback" type="xsd:boolean"/>
   <element name="snmpEnabled" type="xsd:boolean"/>
  </sequence>
 </extension>
 </complexContent>
 </complexType> 
```

根据 WSDL 定义，预计 ActionInfo 序列属性出现在 PushActionInfo 属性之前。在这种情况下，它们是混合的。结果是：

代码：

```
PushActionInfo (current)
activationMethod
activationRequired
binaryContent
category
configUnitId – extension of ActionInfo
configUnitType - extension of ActionInfo
contentType
desc - extension of ActionInfo
destinationName
dynamic
errorCode - extension of ActionInfo
id - extension
maskableContent
payloadName
postOps
pushMechanism
result - extension of ActionInfo
rollback
snmpEnabled
status - extension of ActionInfo 
```

但我的期望是：

代码：

```
configUnitId – extension of ActionInfo
configUnitType - extension of ActionInfo
desc - extension of ActionInfo
errorCode - extension of ActionInfo
result - extension of ActionInfo
status - extension of ActionInfo
activationMethod
activationRequired
binaryContent
category
contentType
destinationName
dynamic
id - extension
maskableContent
payloadName
postOps
pushMechanism
rollback
snmpEnabled 
```

此链接[https://issues.apache.org/jira/browse/AXIS-2677](https://issues.apache.org/jira/browse/AXIS-2677)描述了 Axis 的问题。

所以我尝试使用 JbossWS+JAXB 来生成不同的 wsdl 文件。两者都按字母顺序给出响应。有没有办法改变响应元素的顺序？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:37:17.543

您可以`propOrder`在`@XmlType`注解上指定 a 来指定元素的顺序。

```
@XmlType(propOrder={"ID", "firstName", "lastName"})
public class Customer {
   ..
} 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2012/02/jaxbs-xmltype-and-proporder.html](http://blog.bdoughan.com/2012/02/jaxbs-xmltype-and-proporder.html)
*   [http://blog.bdoughan.com/2012/08/jaxbs-xmltransient-and-property-order.html](http://blog.bdoughan.com/2012/08/jaxbs-xmltransient-and-property-order.html)

# jquery - jQuery 条件语句将检查具有相同类的所有按钮的值

> ID：12165091
> 
> 赞同：0
> 
> 时间：2012-08-28T18:13:11.240
> 
> 标签：jquery, css, if-statement

我目前有一个小页面，上面有 9 个按钮。四个被分配到一个班级，五个被分配到另一个班级。在页面的整个生命周期中，5 的值可能会更改为两个值之一。我想在 jQuery 语句中创建一个 if 语句来检查属于同一类的五个按钮的值。当它们的值都等于一件事时，就会触发一个函数。

我有这个功能，我只是在创建条件语句时遇到了麻烦。

编辑：我真的不能给出所有的代码。它会占据整个页面。这是我要监视的按钮：

```
<input id="link1" type="button" value="[+] Expand" onclick="toggleVisibility('table1', 'link1')" class="expander" />
<input id="link2" type="button" value="[+] Expand" onclick="toggleVisibility('table2', 'link2')" class="expander" />
<input id="link3" type="button" value="[+] Expand" onclick="toggleVisibility('table3', 'link3')" class="expander" />
<input id="link4" type="button" value="[+] Expand" onclick="toggleVisibility('table4', 'link4')" class="expander" />
<input id="link5" type="button" value="[+] Expand" onclick="toggleVisibility('table5', 'link5')" class="expander" /> 
```

这是当这五个按钮的所有值都是“[+] Expand”时我想要触发的 jQuery 函数

```
function () { $("#bottom-wrap").addClass("absolute-bottom") } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:34:56.833

如果只有五个按钮具有相同的类，并且您希望检查所有五个按钮是否具有相同的值，您总是可以这样做：

```
var elem = $(".expander"); 

elem.on('change', function() {
    if ( elem.filter("[value='[+] Expand']").length == elem.length)
        $("#bottom-wrap").addClass("absolute-bottom");
});​ 
```

[**小提琴**](http://jsfiddle.net/yB6vM/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:42:15.417

这是一个尝试——它可能需要稍作修改。如果您提供 jsFiddle 或其他东西，我可以确保它正常工作。

```
$(".fiveClass").change(function(){ //Add an event handler to jQuery's change event
   var allSame = true;
   var first;
   $(".fiveClass").each(function(){ //Check each element with the class "fiveClass"
      if( typeof first == "undefined" ){
          first = $(this).val();//could also try .text() depending on type of DOM node
      }
      allSame = allSame && (first === $(this).text());
   }
   if( allSame ){
      //do something.
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:45:57.253

```
var first,
    same = true;

$('.class').each(function(index, element) {
    if (index == 0) first = $(this).val();
    else {
        if (first != $(this).val()) {
            same = false;
            return false;
        }
    }
});

if (same) func(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T18:24:19.473

每次其中一个更新时，您都应该检查元素的值。以下功能应该给你你想要的：

```
function buttonClassMatches(){
var firstClass;
var sameClass = true;
$('input[type="button"]').each(function(){
if(firstClass == null){firstClass = $(this).attr("class");}
if(firstClass != $(this).attr("class")){sameClass = false;}
});
if(sameClass){doYourFunction();}
} 
```

# c++ - 2个int变体之间的平均管道运算符是什么？

> ID：12165094
> 
> 赞同：0
> 
> 时间：2012-08-28T18:13:16.910
> 
> 标签：c++

具有以下代码 -

```
 enum FileOpenFlags {
    flagREAD = 1, flagWRITE = 2,
    flagCREATE = 4, flagEND = 8,
    flagAPPEND = flagWRITE | flagEND,
    };
    cout << flagAPPEND << endl; 
```

给`10`. 你能解释一下做了什么`|`吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T18:14:27.573

它对这两个值进行了[按位计算。`or`](http://en.wikipedia.org/wiki/Bitwise_OR#OR)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T18:15:26.730

`flagWRITE`的 (2) 二进制表示为 0010

`flagEND`的 (8) 二进制表示为 1000

0010 OR 1000 给你 1010 等于 10

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T18:15:25.937

它被称为[按位或](http://en.wikipedia.org/wiki/Bitwise_OR#OR)......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-28T18:18:06.320

这是一个按位“或”运算符。所以 2 和 8 的位值分别按位进行或运算。

所以：

```
 1000 (flagEND = 8) 
OR 0010 (flagWRITE = 2)
-----------
 = 1010 (flagAppend = 10) 
```

# sharepoint-2010 - 带共享点的 bxslider

> ID：12165095
> 
> 赞同：0
> 
> 时间：2012-08-28T18:13:26.913
> 
> 标签：sharepoint-2010, bxslider

我为使用 bxslider 的 sharepoint 2010 网站开发了一个 webpart。当我在英文页面中使用此 Web 部件时，它可以在阿拉伯语中呈现内容，但在页面加载完成时它会闪烁并消失。

我使用以下代码：

```
 <div style="text-align:right;margin-right:6px;height:255px;width:310px;border: 1px #B8B8B8 solid;background-color:#F3F3F4;" >

    <div>

<div class="SpotTitle1">آخــر الاخــبار 
   <img id="go-next15" src="/_catalogs/masterpage/en-us/Preview Images/perv.png" width="20" height="18" align="left" />
   <img id="go-prev15" src="/_catalogs/masterpage/en-us/Preview Images/next.png" width="20" height="18" align="left"/>
</div>
<div id="slider15" style="liststyle: none;padding:0 !important;">
<div id="News1" runat="server" class="TitleLink"></div>
<div id="News2" runat="server" class="TitleLink">
</div></div> </div></div> 
```

在 sharepoint 母版页上我使用：

```
<script type="text/javascript"> $(function(){ 
    var slider15 = $('#slider15').bxSlider({
                           controls: false  
                   });

    $('#go-prev15').click(function(){  
            slider15.goToPreviousSlide();
            return false;  
    });
    $('#go-next15').click(function(){  
            slider15.goToNextSlide(); 
                return false; 
    });

}); 
</script> 
```

任何人都知道我可以做些什么来让它在页面加载后出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T11:01:27.290

可能是 src="/_catalogs/masterpage/en-us/Preview Images/perv.png" 中的 ( en-us )

尝试将图像放入 PublishingImages 文件夹

# sql - rails active record：限制从文本列打印多少

> ID：12165097
> 
> 赞同：0
> 
> 时间：2012-08-28T18:13:30.657
> 
> 标签：sql, ruby-on-rails, postgresql, activerecord

我的用户表中有一个文本列，其中包含一个大型序列化数组。每当我在 rails 控制台中打印一个用户对象时，我都看不到任何其他字段，因为文本列打印得太多了。有没有办法限制文本列的打印量？数据库是postgres。

```
> puts User.first
> #<User id: 1, uid: "323", name: "overlord", big_serialized_array: ["dafsdfa", "dafsdf" #and it goes on for over 1000 lines ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T02:54:56.160

将此方法添加到您的类中：

```
def attribute_for_inspect(attr_name)
  value = read_attribute(attr_name)
  return super unless value.is_a?(Hash)
  value = value.inspect
  return value if value.length <= 50
  "#{value.inspect[0..50]}..."
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:31:56.713

您可以指定要打印的字符数：例如：`text[0..15]`

# asp.net-mvc-3 - 多个模型到局部视图

> ID：12165103
> 
> 赞同：1
> 
> 时间：2012-08-28T18:13:59.257
> 
> 标签：asp.net-mvc-3, asp.net-mvc-partialview

我正在自学asp .net mvc3。

我有一个使用各种模型和查找类型 db 的局部视图。我想保持它的强类型并在多个地方使用它，但我不知道如何实现它。下面的例子应该更好地解释它。这个问题可能会有点长，感谢您的耐心等待。

局部视图基本上给出了属性的一个小描述。'_PropertyExcerptPartial' 的片段如下：

```
@model Test.ViewModels.PropertyExcerptViewModel

<div>
    <h3>@Html.DisplayFor(model => model.Property.NoOfBedrooms) bedroom @Html.DisplayFor(model => model.FurnitureType.FurnitureTypeDescription) flat to Rent </h3>
…
</div> 
```

我想保持这个局部视图的强类型并在多个地方使用它。它被强类型化的模型如下：

```
public class PropertyExcerptViewModel
{
    public Property Property { get; set; }
    public FurnitureType FurnitureType { get; set; }
} 
```

该模型查找的两个2数据库如下：

```
 public class Property
 {
    public int PropertyId {get; set; }       
    ...
    public int NoOfBedrooms {get; set;}
    public int FurnishedType { get; set; }
    ...
 }

public class FurnishedType
{
    public int FurnishedTypeId { get; set; }
    public string FurnishedTypeDescription { get; set; }
} 
```

带家具的类型数据库基本上只是一个包含以下数据的查找表：1 - 带家具 2 - 不带家具 3 - 带家具 4 - 可协商

我有很多这样的查找，因为我只在属性数据库中存储了一个 int 值，可以用来查找描述。这些数据库未链接到属性数据库，家具类型的值通过函数 GetFurnitureType(id) 读取。我将 Property.FurnitureType 的存储 int 值作为 id 传递。

但是，当我尝试使用这个局部视图时遇到了一个问题，因为我不确定如何将这些多个模型从一个视图传递到局部视图。

假设我正在尝试创建一个“添加的属性”页面。这个页面基本上列出了登录用户添加的属性。为此，我创建了另一个名为 GetAddedProperties(userId) 的函数，该函数返回特定用户添加的属性。在“添加的属性”视图中，我可以调用 foreach 函数来遍历 GetAddedProperties 返回的所有属性并显示 _PropertyExcerptPartial。像这样的东西：

```
<div>
    @foreach (var item in //Not sure what to pass here)
    {
        @Html.Partial("_PropertyExcerptPartial",item)
    }
</div> 
```

但是，我不能使用局部视图来显示信息，因为它将显示存储在属性数据库中的家具类型的 int 值，并且我不确定如何获取相应的 FurnitureTypeDescription 并将其从“添加”传递给局部视图属性”页面。

任何帮助，将不胜感激。非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T19:02:25.303

你应该从设计一个真实的视图模型开始，而不是一些你给它的名字加上后缀的类，`ViewModel`然后把你的领域模型塞进去。那不是视图模型。

因此，请考虑您需要在视图中使用哪些信息并设计您的真实视图模型：

```
public class PropertyExcerptViewModel
{
    public int NoOfBedrooms  { get; set; }
    public string FurnishedTypeDescription { get; set; }
} 
```

然后调整您的部分以使用此视图模型：

```
@model Test.ViewModels.PropertyExcerptViewModel
<div>
    <h3>
        @Html.DisplayFor(model => model.NoOfBedrooms) 
        bedroom 
        @Html.DisplayFor(model => model.FurnitureTypeDescription) 
        flat to Rent 
    </h3>
    ...
</div> 
```

好的，现在我们有了一个真实的视图模型，让我们看看如何填充它。所以基本上主视图可以被强类型化为这些视图模型的集合：

```
@model IEnumerable<Test.ViewModels.PropertyExcerptViewModel>
<div>
    @foreach (var item in Model)
    {
        @Html.Partial("_PropertyExcerptPartial", item)
    }
</div> 
```

最后一点当然是主控制器，它将执行所有数据库查询和构建将传递给主视图的视图模型：

```
[Authorize]
public ActionResult SomeAction()
{
    // get the currently logged in username
    string user = User.Identity.Name;

    // query the database in order to fetch the corresponding domain entities
    IEnumerable<Property> properties = GetAddedProperties(user);

    // Now let's build the view model:
    IEnumerable<PropertyExcerptViewModel> vm = properties.Select(x => new PropertyExcerptViewModel
    {
        NoOfBedrooms = x.NoOfBedrooms,
        FurnishedTypeDescription = GetFurnitureType(x.FurnishedType).FurnishedTypeDescription
    });

    // and finally pass the view model to the view
    return View(vm);    
} 
```

如果那是您使用的 ORM，请注意 EF 的惰性特性，以免陷入[SELECT N + 1](https://stackoverflow.com/questions/97197/what-is-the-n1-selects-problem)陷阱。

# xml - Oracle/Hyperion XML 日期格式

> ID：12165104
> 
> 赞同：1
> 
> 时间：2012-08-28T18:14:03.017
> 
> 标签：xml, oracle, datetime, xsd

我刚收到一个从 Hyperion 导出的 XML 文件。XLM 如下：

```
<DueDate date="1348257648893"> 
```

该值表示 2012 年 9 月 21 日或 2012 年 9 月 21 日下午 4:00。

有谁知道这是什么格式以及如何翻译。我必须创建一个包含很多日期的新 XML 文件，并且需要能够将它们转换为正确的格式。

我尝试在 Excel 中对其进行格式化并测试了几个毫秒变体，但无法破解代码。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:38:49.313

可能是从 unix 纪元日期（1970 年 1 月 1 日）开始的毫秒数。

```
select to_date('19700101', 'YYYYMMDD') + 1348257648893/(86400*1000) from dual; 
```

# perl - 密码中的特殊字符导致 Mojolicious UA 中的基本身份验证失败

> ID：12165109
> 
> 赞同：2
> 
> 时间：2012-08-28T18:14:18.243
> 
> 标签：perl, mojolicious

以下程序在尝试访问需要基本身份验证的 https 网站时失败。

```
use Mojo::UserAgent;
my $ua = Mojo::UserAgen->new;

my $user = "foobar";
my $pass = "Cant#change";

my $url  = "https://$user:$pass\@site.foo.com";
my $tx   = $ua->get($url);

if (my $res = $tx->success) {
    say $res->body;
}
else {
    my ($message, $code) = $tx->error;
    say $code ? "$code response $message" : "Connection error: $message";
} 
```

当我使用 MOJO_USERAGENT_DEBUG=1 运行时，我得到以下输出：

```
-- Blocking request (https://foobar:cant#change@site.foo.com)
-- Connect (https:foobar:Cant:443)
Connection error: Couldn't connect 
```

使用从 CPAN 更新的 Mojolicious 3.35。不幸的是，密码可能包含“特殊字符”（ascii #!@%^& 等），并且不能将密码更改为不包含 # 的内容。Web 服务器在 Web 浏览器中正确处理请求，因此我认为这不是 Web 服务器配置问题。

那么在 Mojo 中还有其他方法可以实现这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:21:37.060

错误是你的，不是 Mojo 的。具体来说，URL 构建不正确。使固定：

```
use URI::Escape qw( uri_escape );
my $creds = uri_escape($user) . ':' . uri_escape($pass);
my $url  = 'https://' . $creds . '@site.foo.com/'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T21:43:34.007

```
use Mojo::Base -strict;
use Mojo::URL;

#1 Mojo way
my $url = Mojo::URL->new('http://google.com/')->userinfo('user:pa#ss');
say $url;

#2 or manually
use Mojo::Util qw/url_escape/;

my $auth = join ':', url_escape('user'), url_escape('pa#ss');

my $url2 = qq{http://$auth\@google.com/};
say $url2; 
```

# javascript - 如何基于 Knockout js 模型设置控件样式

> ID：12165112
> 
> 赞同：2
> 
> 时间：2012-08-28T18:14:21.817
> 
> 标签：javascript, jquery, forms, knockout.js

嗨，我有一个带有组合框的表单，用于管理多种类型的地址：

[http://jsfiddle.net/JjH3x/](http://jsfiddle.net/JjH3x/)

添加新地址时，启用这些字段以输入地址信息等。当添加或填写地址类型时，我想在组合地址类型中添加一个图标复选标记或其他内容，以便用户知道组合中的哪些地址类型已经有数据。

任何帮助将不胜感激。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:01:45.843

我已经分叉了您的 jsFiddle，并为您提供了如何完成此类事情的示例 - 您可以在这里找到它：http: [//jsfiddle.net/Mw2qr/](http://jsfiddle.net/Mw2qr/)

我所做的一些更改包括：

*   向您的函数对象添加一个新的[计算 observable](http://knockoutjs.com/documentation/computedObservables.html)调用（这是检查地址中的所有字段是否包含某些内容的方法 - 如果需要，您可以改进/扩展逻辑）`Address``isComplete`
*   我已添加`valueUpdate:'afterkeydown'`到您的表单中以获得即时验证。
*   最后，我添加了一些示例输出，说明哪些地址是完整的，哪些不是。

请注意，您不应该只依靠客户端逻辑来检查是否所有地址都已填写 - 确保您也包含一些服务器端逻辑；）

- 更新

为了回答有关如何将颜色（或任何 CSS 样式）应用于`select` `option`表示“填写”地址的元素的问题的特定部分，我对初始 jsFiddle 进行了一些调整 - 最终结果可在此处获得：[http ://jsfiddle.net/Mw2qr/1/](http://jsfiddle.net/Mw2qr/1/)

请注意，这可能是我今年最大的黑客攻击 - 似乎做你想做的事必须涉及一点 jQuery 魔法（我希望这可以使用纯粹的 knockoutJS 来解决 - 但据我所知，通过阅读`options`绑定[在文档](http://knockoutjs.com/documentation/options-binding.html)中，您想要实现的目标不受开箱即用的支持 - 但是，我的简单 hack 应该可以工作。它绝不是漂亮的，所以我希望你可能（至少）受到我的解决方案的启发，也许会来有了更优雅的东西；）

# sqlite - 带条件的 SQLITE 多表连接

> ID：12165113
> 
> 赞同：1
> 
> 时间：2012-08-28T18:14:25.733
> 
> 标签：sqlite, left-join

我有这些表：

多迪亚

```
dhid INTEGER PRIMARY KEY NOT NULL, 
dname TEXT NOT NULL, 
dfname TEXT NOT NULL, 
dage INTEGER NOT NULL, 
dadd TEXT, 
dphone INTEGER NOT NULL, 
demail TEXT NOT NULL 
```

数据

```
dtid INTEGER PRIMARY KEY NOT NULL, 
ddate INTEGER NOT NULL, 
dmonth INTEGER NOT NULL,
dyear INTEGER NOT NULL, 
dmilk INTEGER NOT NULL, 
dprice INTEGER NOT NULL default 35 , 
dmore TEXT, 
ddhid INTEGER NOT NULL 
```

价格牛奶

```
pid INTEGER PRIMARY KEY NOT NULL, 
pmonth INTEGER NOT NULL, 
pyear INTEGER NOT NULL, 
milkprice INTEGER NOT NULL, 
typeperson TEXT, 
userid INTEGER, 
gheeprice INTEGER, 
defaultprice TEXT 
```

现金数据

```
cashid INTEGER PRIMARY KEY NOT NULL,
cashdate INTEGER NOT NULL, 
cashmonth INTEGER NOT NULL, 
cashyear INTEGER NOT NULL, 
cashamount INTEGER NOT NULL, 
uid INTEGER NOT NULL, 
utype TEXT NOT NULL, 
cashtype TEXT NOT NULL, 
cashmore TEXT 
```

我想制作每月账单，我成功使用它购买了......但是在账单中我如何显示上个月的余额......我正在尝试使用它

```
 SELECT
  ddhid, dmonth, dyear, dmilk,
  userid, pmonth, pyear, milkprice, 
  uid, cashmonth, cashyear, cashamount, utype, 
  SUM(dmilk) AS totalmilk,  
  SUM(dmilk*milkprice) AS totalamount, 
  SUM(cashamount) AS totalcash
  FROM 
 doodhdata 
 LEFT JOIN pricemilk ON (
   doodhdata.ddhid = pricemilk.userid 
   AND doodhdata.dmonth = pricemilk.pmonth 
   AND doodhdata.dyear = pricemilk.pyear
 )
 LEFT JOIN cashdata ON (
   doodhdata.ddhid = cashdata.uid 
   AND doodhdata.dmonth = cashdata.cashmonth 
   AND doodhdata.dyear = cashdata.cashyear
 )
 WHERE 
   dmonth > '$mikdatem' 
   AND dyear='$mikdatey' 
   AND ddhid='$dhid' 
```

但是我想在 milkprice 为 NULL 时使用 defaultprice ......怎么可能......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T20:38:35.300

利用

```
COALESCE(milkprice, defaultprice) 
```

代替`milkprice`您的查询。

请参阅[SQLite 核心函数文档。](http://www.sqlite.org/lang_corefunc.html)

# jakarta-ee - JFXtras 和 FXML 互操作性

> ID：12165116
> 
> 赞同：2
> 
> 时间：2012-08-28T18:14:40.693
> 
> 标签：jakarta-ee, javafx, javafx-2, scenebuilder, jfxtras

在 NetBeans 中使用 JavaFX2.2 和 SceneBuilder 1.0 来利用它提供的无缝开发环境。我想添加来自 JFXtras 实验室的控件，因此，我想了解是否可以将 JFXtras 控件集成到 SceneBuilder 中。我从 Oracle 中找到了一个关于将 jar 文件加载到 SceneBuilder 以使其了解自定义控件的文档。文档声称您可能无法实际使用 SceneBuilder 中的控件，但其控件将被“通过”原样，因此您可以实际保存文件而不会丢失添加的自定义控件。嗯，我试过了，好像没用。我实际上无法加载 fxml 文件，获取有关 bean 实例化的异常失败。有没有人能够将 JFXtras 与 SceneBuilder 一起使用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T18:40:34.857

我在我的项目中使用 JFXtra，但我必须使用正确的 fx:id 和内容手动将它们添加到 FXML 代码中。然后，SceneBuilder 会保留 JFXtra 节点应位于的位置。您的 FXML 文件中是否有正确的导入和类路径？

```
<?import jfxtras.labs.scene.control.*?>
<?scenebuilder-classpath-element ../../../libraries/JFXtras2/jfxtras-labs-0.1.jar?> 
```

# javascript - 如何覆盖 jqGrid 的语言默认值？

> ID：12165118
> 
> 赞同：0
> 
> 时间：2012-08-28T18:14:42.737
> 
> 标签：javascript, jquery, jqgrid

假设我不能更改语言文件，因为我希望默认值保持不变，除了这种特殊情况。

我想更改编辑表单的标题。还假设将有其他网格将为同一个编辑表单使用不同的标题。

到目前为止，我知道编辑表单是调用这个方法启动的：

```
grid.jqGrid('editGridRow', rowID, {properties}); 
```

在文档 Wiki 中，您可以找到一段关于此的内容：

> 当作为选项传递给方法时，这些选项可以被覆盖。当传递给方法时，我们应该使用示例 bSubmit : “Submit” 而不是 $.jgrid.edit.bSubmit : “Submit”</p>

但它没有说明我必须将选项传递给*哪种方法。*'editGridRow' 没有选项参数，如果我将其作为属性传递，如下所示：

```
grid.jqGrid('editGridRow', rowID, { editCaption: "My Edit Caption" }); 
```

它不起作用。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:01:13.577

您的解决方案应该有效，但让我们尝试一下。

```
 $.jgrid.nav.addtext = "Add";
    $.jgrid.nav.edittext = "Edit";
    $.jgrid.nav.deltext = "Delete";
    $.jgrid.edit.addCaption = "Add Me";
    $.jgrid.edit.editCaption = "Edit Me"; 
```

您可以像这样覆盖它们，在 jQGrid 代码之前将其包含在您的脚本标记下，尽管它没有经过测试。

# main - 链接器使用 Boost.Test 选择“错误”的 main

> ID：12165121
> 
> 赞同：3
> 
> 时间：2012-08-28T18:14:50.147
> 
> 标签：main, static-linking, libpng, boost-test

使用 Boost.Test 时，通常不需要定义`main()`函数，因为 Boost.Test 自己提供了一个。

我最近不得不将我的项目转换为使用 3rd 方库的静态链接（在 VS2010 上）。自然，我必须链接到多个`.lib`s 以便构建成功，并且我的构建运行得很好。

然而，当我运行我的测试项目时，发生了一些非常奇怪的事情。似乎`.lib`我的一个依赖库所需的第 3 方之一（libpng）包含一个测试文件，其中`main()`定义了一个函数（`pngtest.c`如果你必须知道的话）。
由于我的项目没有`main()`功能，因此链接器选择了该功能作为我的“测试”应用程序。因此，我的测试都没有运行。

有谁知道我如何防止这种情况发生？如何告诉链接器/编译器使用 Boost.Test `main()`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T07:40:06.713

回答我自己的问题，并澄清@Tom 的回答。
事实证明，`libpng`我使用的构建脚本不是原始附带的，`libpng`而是由 OpenCV 构建系统创建的。该文件`pngtest.c`被错误地包含在构建中。

该问题的解决方案是`pngtest.c`从 libpng 构建脚本中删除。
最新的 OpenCV 版本，不再包含此文件。

有关更多详细信息，请参见此处[的 Boost 邮件列表](http://thread.gmane.org/gmane.comp.lib.boost.user/75360)和此处的[OpenCV 错误报告](http://code.opencv.org/issues/2322)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T04:14:54.493

阿迪，我也有同样的问题。看起来你已经完成了这个。感谢谷歌和你的努力，我能够弄清楚。

这里有一些信息可以完善答案：

*   讨论： [http ://boost.2283326.n4.nabble.com/Boost-Test-Linker-chooses-wrong-main-function-td4634872.html](http://boost.2283326.n4.nabble.com/Boost-Test-Linker-chooses-wrong-main-function-td4634872.html)

*   解决方案： [http ://code.opencv.org/issues/2322](http://code.opencv.org/issues/2322)

`pngtest.c`基本上，我只是从 libpng 项目中排除了该文件，然后重新编译了 OpenCV。看起来它将在 OpenCV 的下一个版本中修复。

谢谢！

# javascript - Javascript - 具有拆分功能的数组

> ID：12165122
> 
> 赞同：0
> 
> 时间：2012-08-28T18:14:53.500
> 
> 标签：javascript, arrays, split

我无法使用 Javascript 和 Split 将信息放入数组中。

```
var LigneTab= new Array(3,7); //4 Lines, 7 Items
var reg=new RegExp(" +", "g");

Ligne = ("55062 5453457.4676 236746.6682 472.4027 POA 2012-08-14 GM33P086"); //First Line
LigneTab[0]=Ligne.split(reg); //Split the line in 7 items and place it in line 0
UltraEdit.messageBox(LigneTab[0,4]]); // Debug msgbox from UltraEdit to show the item 4 'POA' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:21:56.300

在 javascript 中，这不必那么复杂：

```
var Ligne = "55062 5453457.4676 236746.6682 472.4027 POA 2012-08-14 GM33P086"
   ,LigneTab = [Ligne.split(/\s+/)];
   // now LigneTab[0] is:
   // ["55062", "5453457.4676", "236746.6682", "472.4027", ..., "GM33P086"] 
```

甚至：

```
var Ligne = "55062 5453457.4676 236746.6682 472.4027 POA 2012-08-14 GM33P086"
             .split(/\s+/);
// Ligne[0]:
// ["55062", "5453457.4676", "236746.6682", "472.4027", ..., "GM33P086"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:19:58.960

首先，将数组初始化为`[3, 7]`，然后将第零个值替换为实际需要的数组，嵌套：

```
LigneTab[0]=Ligne.split(reg); //Split the line in 7 items and place it in line 0 
```

`LigneTab`实际上也是如此`[["55062","5453457.4676","236746.6682","472.4027","POA","2012-08-14","GM33P086"], 7]`，索引 4 没有任何价值。

其次，如果它确实有 > 4 个元素，`LigneTab[0,4]`那就没有多大意义了，因为表达式

```
0, 4 
```

评估为`4`，因此您不妨只写`LigneTab[4]`.

你可能想要这个：

```
var LigneTab = Ligne.split(/\s+/);
UltraEdit.messageBox(LigneTab[4]]); // Debug msgbox from UltraEdit to show the item 4 'POA' 
```

或者，也许您打算将其作为嵌套列表，在这种情况下您想要：

```
var LigneTab[0] = Ligne.split(/\s+/);
UltraEdit.messageBox(LigneTab[0][4]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:22:29.137

考虑到您发布的代码，我不明白为什么需要二维数组。但是如果你真的需要一个，你在这里尝试的是创建和访问它的可能方法之一：

```
var LigneTab = []; // one-dimensional for now
var reg=new RegExp(" +", "g");
var Ligne = "55062 5453457.4676 236746.6682 472.4027 POA 2012-08-14 GM33P086"; 
LigneTab[0] = Ligne.split(reg); 
// Now LigneTab is two-dimensional. 
// LigneTab[0] contains another array with 7 items
UltraEdit.messageBox(LigneTab[0][4]]); 
```

# c# - System.Diagnostics.Process.Start() 的替代方案

> ID：12165125
> 
> 赞同：-1
> 
> 时间：2012-08-28T18:15:12.393
> 
> 标签：c#, process.start

由于一些未知的原因，一个可执行文件（用于使命召唤现代战争 2 的 iw4sp.exe 可执行文件）在从资源管理器启动时正常运行，但在我的应用程序中由 Process.Start() 启动时崩溃。Process.Start的任何替代品？我尝试通过将 iw4sp 作为参数传递来启动资源管理器，但同样的事情发生了。应用程序退出时出现文件丢失的代码（我仔细检查了该文件是否存在。）当我创建 . *.url 快捷方式到 exe 并从资源管理器中运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:20:26.057

创建一个 `ProcessStartInfo`，设置它`WorkingDirectory`并使用`Process.Start(processStartInfo);`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T18:18:42.077

只能`process.start`替代您的代码

```
Process.Start("cmd.exe","iw4sp.exe"); 
```

# php - 如何获得没有计数的日子

> ID：12165127
> 
> 赞同：1
> 
> 时间：2012-08-28T18:15:19.863
> 
> 标签：php, mysql

> **可能重复：**
> [在 sql 结果中填充空日期的最直接方法是什么（在 mysql 或 perl 端）？](https://stackoverflow.com/questions/75752/what-is-the-most-straightforward-way-to-pad-empty-dates-in-sql-results-on-eithe)

在 some_table 中创建的每个“记录”都有一个“日期”。

**一些表：**

```
-------------------------
id | record | my_date
-------------------------
1  | rec_a  | 2012-08-01
2  | rec_b  | 2012-08-02
3  | rec_c  | 2012-08-02
4  | rec_d  | 2012-08-04
5  | rec_e  | 2012-08-06
6  | rec_f  | 2012-08-06 
```

**我的查询：**

start_date 和 end_date 来自输入

```
SELECT
    my_date, COUNT(my_date) AS _count
FROM
    some_table
WHERE
    my_date
BETWEEN
    start_date
AND
    end_date
GROUP BY
DAY (my_date) 
```

**大批：**

```
while($result = mysql_fetch_assoc($my_query))
{
    $dataset[] = array($result['my_date'],intval($result['_count']));
}

json_encode($dataset); 
```

**这将使：**

```
["2012-08-01",1]
["2012-08-02",2]
["2012-08-04",4]
["2012-08-06",6] 
```

**获得没有这样计数的日子的最佳方法是什么？**

```
["2012-08-01",1]
["2012-08-02",2]
["2012-08-03",0] <--
["2012-08-04",4]
["2012-08-05",0] <--
["2012-08-06",6] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:23:57.070

可能最简单的方法是创建一个包含所有可能日期的表。然后，您将从该表中选择并左连接到您现有的表。

这可能看起来很老套，但这是一种非常常见的模式，尤其是在数据仓库中。

# java - 如何为不使用类的类型参数的方法应用泛型

> ID：12165136
> 
> 赞同：0
> 
> 时间：2012-08-28T18:16:00.350
> 
> 标签：java, generics

我是 Java 泛型的新手。我正在设计我的 DAO 层。我在 Spring 中使用 JPA。我有一个由所有其他 DAO 类扩展的 BaseDAO。

```
public abstract class BaseDAO<E, Id extends Serializable> implements IBaseDAO<E, Id> {

private Class<E> entityClass;

@PersistenceContext
private EntityManager entityManager;

public EntityManager getEntityManager() {
    return entityManager;
}

@SuppressWarnings("unchecked")
public BaseDAO() {
    ParameterizedType genericSuperclass = (ParameterizedType) getClass()
            .getGenericSuperclass();
    this.entityClass = (Class<E>) genericSuperclass
            .getActualTypeArguments()[0];
}

@Override
public E create(E entity) {
    entityManager.persist(entity);
    return entity;
}

//Some more methods

@Override
public List<?> executeNativeQuery(String queryString,
        Map<String, Object> param) {

//implementation goes here

    return resultList;
}

} 
```

我在将 public List executeNativeQuery(String queryString, Map param) 添加到此类时遇到问题。因为如果我必须在扩展 BaseDAO 的类 A 中使用此方法，我将不得不为基类指定类型参数“E”和“Id”。理想情况下，类型参数应该是我们要进行 db 调用的实体类。但由于此方法是本机查询方法，因此我不使用实体类。我该如何处理这种情况？

编辑：假设下面是扩展 BaseDAO 并使用 executeNativeQuery 方法的 DAO 类

公共类 MyDAO 扩展 BaseDAO{

```
public String myMethod(){

String query="select a1,a2,a3,b4 from A a, B b where a.pk=b.pk";
...
..
List<String> = executeNativeQuery(query, map, String.class);

...
..  
} 
```

}

如果我没有为 BaseDAO 指定类型参数，我仍然会得到以下错误。

java.lang.Class 不能在 org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328) 处转换​​为 java.lang.reflect.ParameterizedType

应该为 BaseDAO 传递的类型参数应该是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:25:15.243

您可以执行以下操作。

```
@Override
public <T> List<T> executeNativeQuery(String queryString,
        Map<String, Object> param, Class<T> clazz) {

//implementation goes here

    return resultList;
} 
```

在第三个参数中，您可以指定要使用的列表的类型。例如。`List<SomeEntity> result = executeNativeQuery("query", paramMap, SomeEntity.class)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T20:04:47.677

如我所见，问题出在下一行的构造函数中。

```
ParameterizedType genericSuperclass = (ParameterizedType) getClass().getGenericSuperclass(); 
```

您应该`getGenericInterfaces()[0]`改用，因为`BaseDAO`该类不从任何东西扩展（因此您`Object`作为父级）而是实现`IBaseDAO`.

# ruby-on-rails-3 - What is testing/staging environment in Rails

> ID：12165141
> 
> 赞同：3
> 
> 时间：2012-08-28T18:16:22.987
> 
> 标签：ruby-on-rails-3, staging

The development environment is obviously for developing the web app locally.

The production is the operational public website with everything as the final version.

what is the testing environment and what is the difference between that and staging environment?

and if its what I think it is, why not just deploy to an alternate website address and use that?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:41:36.290

The testing environment is an environment in which Rails will perform the tests that you write. This is a slimmer environment in which certain things are disabled such as sending emails, and loading the asset pipeline. The database in the test environment is also generally not persisted between test runs.

For more information on how and why to test your rails applications check out the [Rails Guides](http://guides.rubyonrails.org/testing.html). If you are not currently testing your applications, you should really start as it can save days of hunting for broken code, and many many headaches down the road.

Staging environments are setup to mimic most of the functionality of a production environment. The staging 'stack' should be as similar to the production environment as possible; e.g. same hardware, same OS, same installed packages, etc.

Things I generally limit when setting up a staging environment are email sending, I will use a mail interceptor to send all email to my address. Think of the staging environment as a sandbox in which to test changes to your production environment, without actually testing in production.

For most small apps, a staging environment is not always necessary. However, for a large, enterprise level application it is a must as you generally cannot afford any downtime for your production system. With the staging environment you can catch those changes before they are pushed to production.

Hope this helps.

# javascript - clearTimeout 可以删除 Javascript 中触发的超时事件的未处理回调吗？

> ID：12165145
> 
> 赞同：18
> 
> 时间：2012-08-28T18:16:35.893
> 
> 标签：javascript, javascript-events

如果我调用`clearTimeout`一个`setTimeout`已经触发但其回调仍在执行队列中的事件，是否`clearTimeout`仍会阻止该事件被处理？

换句话说，是否仍然可以在计时器触发延迟及其回调执行期间清除超时事件？

通俗地说，我的猜测是，一旦超时触发，它会将回调排队并自行销毁——`clearTimeout`使用该计时器的 id 对排队回调没有影响。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-28T18:20:20.473

我认为答案是[肯定](http://jsfiddle.net/wDdpP/)的。（我目前正在使用 Firefox。）

*编辑*——为了完整起见，我构建的测试是这样的：

```
var t1 = setTimeout(function() {
  clearTimeout(t2);
}, 0);

var t2 = setTimeout(function() {
  alert("hello world");
}, 0); 
```

这个想法是两个计时器应该在脚本块完成后立即“准备好”，并且它们应该按照请求的顺序运行。因此，“t1”应该在浏览器运行它的回调之前清除“t2”。因为没有`alert()`发生任何事情，我得出的结论是`clearTimeout()`调用“有效”，因为它阻止了第二个回调运行，即使它的计时器已经过期。

浏览器中的确切工作方式并不是我所熟悉的，因此在某些情况下可能`clearTimeout()`不会产生相同的效果。无论如何，考虑到执行模型，这似乎是非常不确定的。

# asp.net-mvc - ASP.NET MVC - MVC 职责

> ID：12165146
> 
> 赞同：3
> 
> 时间：2012-08-28T18:16:39.290
> 
> 标签：asp.net-mvc

我可能在这里分析过度了，但是根据我对 MVC 所做的所有阅读，似乎有很多关于如何做事的意见。

是否有“最佳实践”站点或文档来定义每个 MVC 的职责？

我有几个问题，请记住我使用的是 EF/Repository&UnitOfWork/Service 模式：

1）如何从服务层到视图模型获取领域对象和业务规则的验证结果（错误消息等）？

2) 我正在使用域对象和执行所有业务逻辑的服务层，然后我将域对象发送到控制器并让它们（通过 AutoMapper）将它们转换为视图的视图模型。还有哪些其他类型的事情是控制器的责任？下面的代码可以吗？控制器中的逻辑是否太多？：

```
public ActionResult SomeAction()
{
    var model = Mapper.Map<DomainObject, ViewModel>(service.QueryReposForData());
    model.SomeCollectionForSelectList = Mapper.Map<IEnumerable<DomainObject>, IEnumerable<ViewModel>>(service.QueryReposForSelectListData());
    return View(model);
} 
```

我不认为控制器中唯一的东西是一条返回视图的行，该视图具有映射到视图模型的对象图？

3) 我认为可以在 ViewModels 上设置属性来指示视图是否可以隐藏某些东西，然后在视图中执行该逻辑？例子：

```
@if(Model.DisplaySomething)
{
    <div>Something to show</div>
}
else
{
    <div>Something else to show</div>
} 
```

4）我正在考虑让我的服务在写入时将某种`TransactionResult`对象返回给控制器，以使其成为服务处理事务的责任。所以我会有一个聚合服务，它会启动一个事务（UnitOfWork）做它需要做的事情，然后返回这个`TransactionResult`可能有错误消息的？我认为我不应该让控制器负责管理事务，而是让它只是将映射到域对象的视图模型传递给服务并让它对其进行操作？

5) 另外，您想使用多少 ActionFilter？我知道这是一个巨大的可扩展点，但我经常发现自己试图将所有模型创建填充到一个过滤器中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:33:06.107

优秀的问题！

> 1）如何从服务层到视图模型获取域对象和业务规则的验证结果（错误消息等）？

我在后端使用 EntityFramework 并在我的模型和实体上实现 IValidatableObject。在模型上，我执行跨字段验证，而在实体上，我执行跨实体验证。

> 2) 我正在使用域对象和执行所有业务逻辑的服务层，然后我将域对象发送到控制器并让它们（通过 AutoMapper）将它们转换为视图的视图模型。还有哪些其他类型的事情是控制器的责任？下面的代码可以吗？控制器中的逻辑是否太多？：

这段代码很完美。控制器收集数据，将数据转换为模型并将它们提供给视图。

> 3) 我认为可以在 ViewModels 上设置属性来指示视图是否可以隐藏某些东西，然后在视图中执行该逻辑？例子：

是的，这正是 ViewModel 的用途。捕获视图呈现所需的所有数据和逻辑。

> 4）我正在考虑让我的服务在写入时将某种 TransactionResult 对象返回给控制器，以使其成为服务处理事务的责任。所以我会有一个聚合服务，它会启动一个事务（UnitOfWork）做它需要做的事情，然后返回这个可能有错误消息的 TransactionResult？我认为我不应该让控制器负责管理事务，而是让它只是将映射到域对象的视图模型传递给服务并让它对其进行操作？

我在我的项目中遇到了一些困难。最后，我把EntityFramework的SaveChanges方法移到了前端。这允许我在前端构建一个事务，然后提交一次。我的 ApiController 中执行更新、创建或删除的每个方法也会执行 SaveChanges。

我使用 ApiControllers 作为后端和实际 Controller 类之间的抽象层。详细地说，我的应用程序都使用普通控制器 (HTML) 和 ApiControllers (REST aka Web API)。两种类型的控制器共享一个用于检索数据的通用接口。

示例： http: [//pastebin.com/uL1NGGqH](http://pastebin.com/uL1NGGqH)

UnitOfWork 仍然驻留在我的后端的门面后面。我只是将 SaveChanges 暴露给前端。诸如 ValidationExceptions 之类的副作用要么由 ASP.NET MVC 自动处理，要么在自定义 ActionFilters 中捕获。

> 5) 另外，您想使用多少 ActionFilter？我知道这是一个巨大的可扩展点，但我经常发现自己试图将所有模型创建填充到一个过滤器中。

在我目前正在从事的大型 MVC 项目中，我只使用了少数 ActionFilters。这些 ActionFilters 主要用于强制安全并将异常（例如 ValidationExceptions）转换为 JSON 格式，以便我的客户端验证框架可以处理它。

题外话：你永远不能过度分析。问自己这些 MVC 的基本问题可以让你更好地掌握 MVC 的概念，并使你成为一个更好的开发人员。只要确保你在老板的时间里不要做太多;)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T18:27:55.090

这里只是基于我们的工作方式的意见。

我们让我们的控制器非常瘦，以至于几乎在所有情况下都会厌食。

对于 ViewModel，我们遵循为每个视图拥有一个 ViewModel 的模式。控制器加载它需要的任何东西，然后启动它。从那里，ViewModel 驱动一切。在我们的世界中，ViewModel 直接绑定到视图，并且不包含将/可能用于应用程序其他部分的代码。它与它需要的较大“模型”（服务层等）的任何部分进行交互，并将内容打包以供视图使用。

对于您的#3 示例，我肯定会说是的——这是我们使用 ViewModel 的方式。

同样，这一切都不是福音——只是我对我们如何处理它的看法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T18:48:48.513

同样在这里：

*   具有通用动作过滤器的基本控制器
*   验证是使用控制器内的[DataAnnotation](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.aspx)和模型验证来完成的。
*   带有注入包装上下文或特定服务层的微型控制器
*   Automapper 映射 ViewModels/EF Pocos。

我并不真正关心实现 UnitOfWork 或显式使用事务，因为 EF4 会自动为**SaveChanges**中完成的所有更改创建（如果不存在）一个新事务（[http://msdn.microsoft.com/en-us/ library/bb896325.aspx](http://msdn.microsoft.com/en-us/library/bb896325.aspx)我只有一个通用接口，将 Context 的 DbSet 公开为 IQuerable 和 Add/Delete/Find 方法。

但正如所说，这都是个人的。

# remote-desktop - 检测 RDP 连接

> ID：12165149
> 
> 赞同：3
> 
> 时间：2012-08-28T18:16:44.223
> 
> 标签：remote-desktop

我一整天都通过 RDP 连接到我的 PC（Windows XP Pro，24/7 运行）。我有一个后台进程应该在 RDP 连接上做一些事情，但我想不出办法让它检测 RDP 连接的建立。

没有创建新进程，WTSQuerySessionInformation 没有帮助（我连接到同一个永恒的 Windows 会话）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T09:55:43.760

答案[`WTSRegisterSessionNotification()`](https://docs.microsoft.com/en-us/windows/win32/api/wtsapi32/nf-wtsapi32-wtsregistersessionnotification)来自[wtsapi32.dll](https://docs.microsoft.com/en-us/windows/win32/api/wtsapi32/)。

这使您注册接收[`WM_WTSSESSION_CHANGE`](https://docs.microsoft.com/en-us/windows/win32/termserv/wm-wtssession-change)通知，其`WParam`可能是`WTS_REMOTE_CONNECT`, `WTS_REMOTE_DISCONNECT`。这样做。

这是最简单的 AutoIt 实现：

```
#include <GUIConstantsEx.au3>
#include <Date.au3>
#include <WindowsConstants.au3>

Global Const $hWTSAPI32 = DllOpen("wtsapi32.dll")
Global $i = 0, $tTime

_Main()

Func _Main()
    Local $hGUI

    ; Create GUI
    $hGUI = GUICreate("Session change detection", 600, 400)
;~  GUISetState()  ; show the window

    DllCall($hWTSAPI32, "int", "WTSRegisterSessionNotification", "hwnd", $hGUI, "dword", 1) ; NOTIFY_FOR_ALL_SESSIONS
    If @error Then 
        MsgBox(0,"", "Error calling WTSRegisterSessionNotification()")
        Exit
    EndIf

    GUIRegisterMsg(0x2B1, "WTSSESSION_CHANGE")  ; WM_WTSSESSION_CHANGE <=====================

    ; Loop until user exits
    Do
    Until GUIGetMsg() = $GUI_EVENT_CLOSE

EndFunc   ;==>_Main

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Func WTSSESSION_CHANGE($hWndGUI, $MsgID, $WParam, $LParam)
    ; WTS_REMOTE_CONNECT = 0x3, WTS_REMOTE_DISCONNECT = 0x4
    ; WTS_SESSION_UNLOCK = 0x8, WTS_SESSION_LOGON = 0x5
    If $WParam = 3 Then
        $tTime = _Date_Time_GetSystemTime()
        MsgBox(0, "Caught a notification", "Remote session connected at " & _Date_Time_SystemTimeToDateTimeStr($tTime) )
        Exit
    EndIf
EndFunc 
```

# c++ - 将“unsigned char”传递给期望 char 或 const char* 的重载函数会导致歧义

> ID：12165150
> 
> 赞同：4
> 
> 时间：2012-08-28T18:16:51.287
> 
> 标签：c++, qt

我正在使用 a`QByteArray`来存储原始二进制数据。为了存储数据，我使用了`QByteArray`append 函数。

我喜欢使用无符号字符来表示字节，因为我认为`255`比`-1`. 但是，当我尝试将零值字节附加到 a`QByteArray`时，如下所示：

```
command.append( (unsigned char) 0x00)); 
```

编译器抱怨`call of overloaded append(unsigned char) is ambiguous`. 据我了解，这是因为零可以解释为空指针，但**为什么编译器不将 unsigned char 视为 char，而不是想知道它是否是 const char***？当然，如果编译器抱怨`command.append(0)`没有任何强制转换，我会理解。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T18:27:43.237

两种重载都需要类型转换——一个从`unsigned char`to `char`，另一个从`unsigned char`to `const char *`。编译器不会尝试判断哪个更好，它只是告诉您使其明确。如果一个是完全匹配的，它将被使用：

```
command.append( (char) 0x00)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T18:31:44.070

`unsigned char`并且`char`是两种不同但可转换的类型。`unsigned char`并且`const char *`也是两种不同的类型，在这种特定情况下也可以转换。这意味着您的重载函数都不是与参数完全匹配的，但在这两种情况下，参数都可以转换为参数类型。从语言的角度来看，这两个函数同样适合调用。因此模棱两可。

您似乎认为该`unsigned char`版本应该被视为“更好”的匹配。但是语言不同意你。

确实，在这种情况下，歧义源于`(unsigned char) 0x00`一个有效的空指针常量这一事实。您可以通过引入中间变量来解决该问题

```
unsigned char c = 0x0;
command.append(c); 
```

`c`不符合空指针常量的条件，从而消除了歧义。虽然，正如@David Rodríguez - dribeas 在评论中指出的那样，您可以通过简单地将零转换为`char`而不是来消除歧义`unsigned char`。

# android - 如何将其他图像放在照片上 Android

> ID：12165151
> 
> 赞同：0
> 
> 时间：2012-08-28T18:16:52.407
> 
> 标签：android, image, bitmap

我在我的 Android 应用程序中拍照。我想在那张照片中放入其他图像，以创建对话气球、传奇人物等效果。

之后，我想将此图像保存在另一个位图中。

我尝试将我的照片作为背景图像，并在其下放置另一个 ImageViews 组件并尝试拍摄我的屏幕的 printScreen。但我认为这不是做我想做的最好的方式。

有谁能够帮我？

对不起我的英语不好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:33:05.083

你可以试试[FrameLayout](https://developer.android.com/reference/android/widget/FrameLayout.html)。

只需将照片放在背景中，然后将对话气球放在照片前面。

如果你想结合照片和气球效果，你可以使用[Bitmap](https://developer.android.com/reference/android/graphics/Bitmap.html)。

只记录效果的坐标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:22:06.587

我认为最好的选择是根据您的照片创建一个 Canvas（您需要将其作为可变位图），然后使用 将`drawBitmap()`另一个位图绘制到您的照片上（您必须将偏移量和 Xfer 模式传递给它）。

原始的可变位图现在将包含您的图像组合

# excel - 有条件的 VLOOKUP

> ID：12165152
> 
> 赞同：1
> 
> 时间：2012-08-28T18:16:56.497
> 
> 标签：excel, match, vlookup

我有两个 Excel 电子表格：

一个有一个id和一个日期另一个有一个id、两个日期和一个值

只要电子表格 1 中的日期介于电子表格 2 中的两个日期之间，我就应该匹配 ID 并返回值。

这些电子表格之间存在一一对应关系，如果未找到匹配项，则默认值为 0

第一个电子表格有很多行。是否有某种 VLOOKUP 函数可以用来获取正确的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:41:14.887

SUMPRODUCT 和数组公式是您需要的。

```
=SUMPRODUCT(--(Sheet2!$A$2:$A$2000=A2),--(Sheet2!$B$2:$B$2000<B2),--(Sheet2!$C$2:$C$2000>B2),--(Sheet2!$D$2:$D$2000)) 
```

这必须使用`CTRL`++作为数组公式`SHIFT`输入`Enter`。`{}`如果您输入正确，您将看到 excel 环绕公式。

假设：要在 A2 中检查的 ID，要在 B2 中检查的日期
订单`A`ID、`B`开始日期、`C`结束日期和`D`值（数字）中表 2 上的数据

数组公式返回一个真/假列表，然后将其相乘。仅当所有条件都是`True`返回值时（因为任何`False`答案都等于零，并且零 * 另一个数字为零）。

如果 2 个范围重叠，这将给出不正确的答案

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T17:56:48.200

有一种非常简单的方法可以实现这一点：连接您要搜索的多个字段，只要它们是唯一的，您就完成了。否则，您应该查看数组单元格。

# c# - 以编程方式按键错误

> ID：12165154
> 
> 赞同：0
> 
> 时间：2012-08-28T18:17:08.400
> 
> 标签：c#, browser, runtime-error, unhandled-exception

我有一个 C# 应用程序和一个嵌入式浏览器；它的任务是访问我的网站并右键单击一个链接并按“r”，这样就会出现属性窗口（我用代码移动鼠标）。它可以在我的笔记本电脑上完美运行，但是当我将它安装在我的电脑或任何其他设备上时，当程序执行此命令时：

```
 SendKeys.Send("r"); 
```

我开始看到一个错误告诉我：

> 应用程序中未处理的异常。请求的资源正在使用中。（HRESULT 例外：0x800700AA）

这是我在笔记本电脑上运行的代码：

```
int x = getXoffset(link);
int y = getYoffset(link);
webBrowser1.Document.Window.ScrollTo(x, y);
Linker.Win32.POINT p2 = new Linker.Win32.POINT();
webBrowser1.Focus();
p2.x = webBrowser1.Left + 10;
p2.y = webBrowser1.Top + 10;
Linker.Win32.ClientToScreen(this.Handle, ref p2);
Linker.Win32.SetCursorPos(p2.x, p2.y);
MouseOperations.GetCursorPosition();
MouseOperations.MouseEvent(MouseOperations.MouseEventFlags.LeftDown);
MouseOperations.MouseEvent(MouseOperations.MouseEventFlags.RightDown);
MouseOperations.MouseEvent(MouseOperations.MouseEventFlags.RightUp);
SendKeys.Send("r"); 
```

我应该怎么办？这个错误是什么意思？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:43:44.230

错误是因为您的 webbrowser 控件仍在导航解决方法是将 webcontrol 的调用方法调用到与您的 sendkey 关联的委托

```
 public delegate void Senddelegate();

    Senddelegate = sendyourkey;

    webBrowser1.BeginInvoke(new Senddelegate(sendyourkey));

    public void sendyourkey()
     {
      SendKeys.Send("r");
     } 
```

你必须异步调用你的 sendkey 让浏览器完成进程

# design-patterns - 模块化背后的设计模式？

> ID：12165155
> 
> 赞同：2
> 
> 时间：2012-08-28T18:17:10.147
> 
> 标签：design-patterns, modularity

嗨，我正在编写我自己的亚马逊 PHP SDK 高级 API，用于操作 DynamoDB，一个 nosql 数据库。

我发现自己为执行一项操作的单个函数编写了大约 150 行代码，包括错误检查、请求构建，当然还有注释。如果我继续这样下去，API 类很容易超过一千行，我认为这有点难以维护。

因此，我正在考虑将我的班级分成几个较小的班级，每个班级处理一组操作。比如说，表操作、项目操作和批处理操作。但是我不是软件设计模式的专家，所以这真的是模块化的好方法吗？或者是否有任何我应该遵守的设计模式并使我的代码更易于维护？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T20:13:17.430

你的问题有点主观，因为你没有提供代码，所以我们可以看到你实际上想要完成的事情。

但是，是的，您需要**将您的类分成更小的组件**，每个组件都有自己的职责。没有一个单一的模式可以说明如何准确地做到这一点，但[**单一责任原则**](http://en.wikipedia.org/wiki/Single_responsibility_principle)是一个很好的起点。这是关于[**关注点分离**](http://en.wikipedia.org/wiki/Separation_of_concerns)。

你说：

> [...] 包括错误检查、请求构建 [...]

就这样，将**错误检查**与**请求构建**分开，然后将其再次分成更小的组件，每个组件只有一个职责。您必须**只有一个理由来更改**每个组件，不能超过一个。您必须定义一个清晰的**域模型**，并为这些域对象中的每一个对象提供专用服务。

以@teresko 的答案为例：

[在 MVC 中应该如何构建模型？](https://stackoverflow.com/questions/5863870/how-should-a-model-be-structured-in-mvc)

因此，请记住，您需要[将应用程序](http://en.wikipedia.org/wiki/Multitier_architecture#Comparison_with_the_MVC_architecture)分成多个**层**。该请求是**表示层**的一部分。在现代[类似 MVC 的](http://en.wikipedia.org/wiki/Model-view-controller)应用程序中，它由控制器层和视图层组成，视图层与模型层交互，以便为给定的请求准备表示。

见：[http ://martinfowler.com/eaaCatalog/](http://martinfowler.com/eaaCatalog/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T19:43:24.023

我想我和你在同一条船上。我有很多类要维护，它们有太多的目的。看看下面的网页，这对我有帮助：http: [//www.dofactory.com/Patterns/Patterns.aspx](http://www.dofactory.com/Patterns/Patterns.aspx)。还有谷歌：SOLID (http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)。这些是针对 .NET 和面向对象编程的，但我知道 PHP 有类和对象。

# php - 尝试发送电子邮件时出现 php 错误

> ID：12165163
> 
> 赞同：3
> 
> 时间：2012-08-28T18:17:38.590
> 
> 标签：php, html, email

我正在学习 php，并且有一本书有很多示例和练习。我正在做的是关于发送电子邮件的。我将代码复制到信中，但出现错误：

```
Parse error: syntax error, unexpected T_ENCAPSED_AND_WHITESPACE, expecting T_STRING or T_VARIABLE or T_NUM_STRING in C:\website2\www\sendscript.php on line 6 
```

为什么会发生这种情况，有什么想法吗？

这是我的 PHP 脚本：

```
<?php
    if(($_POST['sender_name']=="")||($_POST['sender_email']=="")||($_POST['message']=="")){
        header("Location: sendemail.html");
        exit;
    }

    $email = "Sender's name:\t$_POST['sender_name']\n";
    $email .= "Sender's email:\t$_POST['sender_email']\n";
    $email .= "Message:\t$_POST['message']\n";
    $to = "stafford.king16@pgs.org.uk";
    $subject = "did script work?";
    $mailheaders = "From: Stafford King";
    $mailheaders .= "Reply to: $_POST['sender_email']\n";
    mail($to, $subject, $email, $mailheaders);
?>
<html>
    <head></head>
    <body>
        <h1>Email sent!</h1>
    </body>
</html> 
```

这是我的电子邮件输入表单：

```
<html>
  <head></head>
  <body>
    <form method = "post" action = "sendscript.php">
        <p><strong>Your name:</strong><br />
        <input type = "text" name = "sender_name" size = "30"</p>
        <p><strong>Your email address:</strong><br />
        <input type = "text" name = "sender_email" size = "30"</p>
        <p><strong>Message:</strong><br />
    <textarea name = "message" cols = "30" rows = "5" wrap = "virtual"></textarea></p>
        <p><input type = "submit" name = "submit" value = "send email"></p>
    </form>
  </body>
</html> 
```

多谢你们 ：）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-28T18:20:00.270

您需要将数组变量包装在大括号中`{}`或将它们连接到字符串中：

**选项1**

```
$email = "Sender's name:\t{$_POST['sender_name']}\n"; 
```

**选项 2**

```
$email = "Sender's name:\t" . $_POST['sender_name'] . "\n"; 
```

**笔记：**

使用诸如 Dreamweaver（许可费）、NetBeans 或 Eclipse（开源和免费）之类的 IDE 会立即发现这一点。尝试其中之一，而不是 Notepad 或 Notepad++。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:20:23.547

```
$email = "Sender's name:\t$_POST['sender_name']\n"; 
```

不能很好的解决。利用

```
$email = "Sender's name:\t{$_POST['sender_name']}\n"; 
```

反而。或者，您可以连接或使用`sprintf`：

```
$email = "Sender's name:\t" . $_POST['sender_name'] . "\n";
$email = sprintf("Sender's name:\t%s\n", $_POST['sender_name']); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:20:31.177

您需要拆分串联：

```
$email = "Sender's name:\t" . $_POST['sender_name'] . "\n";
$email .= "Sender's email:\t" . $_POST['sender_email'] . "\n";
$email .= "Message:\t" . $_POST['message'] . "\n"; 
```

PHP 无法像现在这样解析它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T18:25:16.417

将变量括在花括号中或将它们从双引号中取出将有助于电子邮件的正文，但不能解决您的解析错误。你的邮件标题似乎搞砸了。您需要在每一行的末尾添加一个“\n”。将第一个 $mailheader 分配更改为：`$mailheaders = "From: Stafford King\n";`

# file-upload - 表单上的文件上传：使用 Spring Roo 更新

> ID：12165164
> 
> 赞同：2
> 
> 时间：2012-08-28T18:17:39.787
> 
> 标签：file-upload, spring-roo, updatemodel

我正在为表单上的文件上传而苦苦挣扎：使用 spring roo 更新。

对于创建部分，我[在这里](http://viralpatel.net/blogs/spring-roo-save-read-blob-object-spring-roo-tutorial/)使用了 Jose Delgado 提供的 form:multi 标签。自定义 form:multi 标签将 enctype="multipart/form-data" 添加到表单中，效果很好。

问题是当您想为更新表单提供文件上传功能时。Spring Roo（也许是 spring mvc，我不知道）默认情况下会将 enctype="application/x-www-form-urlencoded" 设置为更新表单（form:update 标签）。如果我在上传表单中将 enctype 属性设置为 enctype="multipart/form-data"，那么在提交表单时服务器将执行控制器的“create”方法而不是“udpate”方法...

知道我们如何（简单地）解决这个问题吗？我已经花了相当长的时间在这上面，但我发现自己没有灵感了（也许是因为这是一天的结束，也是:)。

谢谢你的帮助，

亲切的问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T12:25:09.887

OK……看来RequestMapping有点问题。

无论出于何种原因，当 form:update 标记中的 multipart 属性设置为“true”时，方法参数设置为“POST”。

作为一种解决方法，我在 create 方法的开头检查了 _method 参数。如果它设置为“PUT”，我返回更新方法的值。

```
 @RequestMapping(method = RequestMethod.POST, produces = "text/html")
    public String create(@Valid ActionRequest actionRequest, BindingResult bindingResult, Model uiModel, HttpServletRequest httpServletRequest) {

        // Work around dispatcher bug: if the multipart attribute of the form is set to true,
        // submission of the update form routes to create method
        String toto = httpServletRequest.getParameter("_method");

        if(httpServletRequest.getParameter("_method").equals("PUT")){
            return this.update(actionRequest,bindingResult,uiModel,httpServletRequest);
        }
   ...
} 
```

# c++ - istream 和 cin.get()

> ID：12165167
> 
> 赞同：1
> 
> 时间：2012-08-28T18:17:58.870
> 
> 标签：c++, cin, istream

我对这两段代码之间的区别有疑问：

```
char buffer5[5];
cin.get(buffer5, 5);
cout << buffer5;

cin.get(buffer5, 5);
cout << buffer5; 
```

和

```
char buffer4;
while (cin.get(buffer4))
{
    cout << buffer4;
} 
```

在第一段代码中，代码获取 5 个字符并将其放入 buffer5 中。但是，由于您按下回车，调用 get() 时不会将换行符放入流中，因此程序将终止并且不会再要求您输入 5 个字符。

在第二段代码中， cin.get() 等待输入流的输入，因此循环不只是终止（我认为）。假设我在输入流中输入了“Apple”。这会将 5 个字符放入输入流中，并且循环会将所有字符打印到输出中。但是，与第一段代码不同，它不会停止，即使在两次输入之后我也可以继续输入。

为什么我可以在第二段代码而不是第一段代码中连续将字符序列输入终端？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T19:35:30.407

首先，除了`\n`在输入序列中输入换行符（在控制台上输入数据时，数据通常由控制台进行行缓冲，并且仅在按 Enter 时转发给程序（通常可以关闭此功能，但其详细信息是特定于平台的，无论如何与此问题无关）。

With this out of the way lets turn our attention to the behavior of `s.get(buffer, n)` for an `std::istream s` and a pointer to an array of at least `n` characters `buffer`. The description of what this does is quite trivial: it calls `s.get(buffer, n, s.widen('\n'))`. Since we are talking about `std::istream` and you probably haven't changed the `std::locale` we can assume that `s.widen('\n')` just returns `'\n'`, i.e., the call is equivalent to `s.get(buffer, n, '\n')` where `'\n'` is called a delimiter and the question becomes what this function does.

Well, this function extracts up to `m = 0 < n? n - 1: 0` characters, stopping when either `m` is reached or when the next character is identical to the delimiter which is left in the stream (you'd used `std::istream::getline()` if you'd wanted the delimiter to be extracted). Any extracted character is stored in the corresponding location of `buffer` and if `0 < n` a null character is stored into location `buffer[n - 1]`. In case, if no character is extracted `std::ios_base::failbit` is set.

OK, with this we should have all ingredients to the riddle in place: When you entered at least one character but less than 5 characters the first call to `get()` succeeded and left the newline character as next character in the buffer. The next attempt to `get()` more characters immediately found the delimiter, stored no character, and indicated failure by setting `std::ios_base::failbit`. It is easy to verify this theory:

```
#include <iostream>

int main()
{
    char buffer[5];
    for (int count(0); std::cin; ++count) {
        if (std::cin.get(buffer, 5)) {
            std::cout << "get[" << count << "]='" << buffer << "'\n";
        }
        else {
            std::cout << "get[" << count << "] failed\n";
        }
    }
} 
```

If you enter no character, the first call to `std::cin.get()` fails. If you enter 1 to 4 characters, the first call succeeds but the second one fails. If you enter more than 4 characters, the second call also succeeds, etc. There are several ways to deal with the potentially stuck newline character:

1.  Just use `std::istream::getline()` which behaves the same as `std::istream::get()` but also extracts the delimiter if this is why it stopped reading. This may chop one line into multiple reads, however, which may or may not be desired.
2.  To avoid the limitation of a fixed line length, you could use `std::getline()` together with an `std::string` (i.e., `std::getline(std::cin, string)`).
3.  After a successful `get()` you could check if the next character is a newline using `std::istream::peek()` and `std::istream::ignore()` it when necessary.

Which of these approaches meets your needs depends on what you are trying to achieve.

# javascript - 请解释MVC中的VC for javascript

> ID：12165168
> 
> 赞同：2
> 
> 时间：2012-08-28T18:18:04.170
> 
> 标签：javascript, model-view-controller

这真的让我很沮丧。我正在尝试构建一个没有库的自定义 JavaScript 应用程序。这主要是为了让我学习更好的核心 JavaScript 和 JavaScript 模式。我正在尝试实现 MVC 结构，并且我分别理解这些部分，但是对于我的生活，我无法弄清楚如何将视图和控制器连接在一起。例如，如果我有以下代码：

```
<div>
    <button id="button1">Click Me</button>
    <button id="button2">Click Me</button>
    <button id="button3">Click Me</button>
</div> 
```

我到底如何编写一个 controller.js 文件来监听每个按钮的点击并做出响应。特别是如果每​​个按钮都做了与其他按钮完全不同的事情。假设 button1 只是链接到 google.com，button2 打开一个模式框，而 button3 更新一个数据库表。所以每个人都在做完全独立的事情。我试图避免的是使用 jQuery 来做这样的事情。

```
$('#button1').click(function(){
       //go to google.com
});

$('#button2').click(function(){
       //open modal box
});

$('#button3').click(function(){
       //update database
}); 
```

这似乎不是很有效，尤其是在尝试使用 MVC 结构时。有没有更流畅的方法，甚至我可以遵循一些不同的设计模式来编写这是没有库的核心 JavaScript？我在网上搜寻文章，但我找到的一切都在很大程度上依赖于图书馆。

任何书籍、教程、博客文章或任何类似的东西都可以清楚地解释这样的事情，非常感谢。谁知道一旦我掌握了它的窍门，也许我会为大众写一本关于它的书。

再次感谢社区的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:56:52.360

您正在使用 Javascript 编写应用程序，遵循 MVC 设计模式，了解核心 javascript 是一个好主意，因为您必须适应 js 上的现有设计模式 :)

我首先会递归地解析 DOM，检索每个标签，然后将它们关联起来的简单点击事件代码调用 click_event 通用（和全局）函数，按钮 id 作为参数，有一个标识按钮的入口点.

然后这个通用方法（事件入口点）必须为动作选择并启动适当的控制器。

您还可以使用 2 个参数更进一步：objectId 或引用，以及事件类型。这与许多基本 GUI 上的触发事件非常相似。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-28T18:37:36.953

我并没有真正理解“MVC JavaScript 应用程序”的想法。JS 只是 webapp 的 V 的一部分。

如果您希望您的代码在多个浏览器上运行，jQuery 是您的最佳选择。

但是，我承认有些情况下你不能使用库，你必须编写简单、苗条、纯粹的 js 核心代码。了解编程语言的核心然后学习该语言的库/框架也是一个好主意。

现在，我不确定你对 js 了解多少。我一直很喜欢 w3schools 教程，你真的在​​那里得到了基础知识。对于 js 在这里：[http ://www.w3schools.com/js/default.asp](http://www.w3schools.com/js/default.asp)

如果您从那里了解一切，并且您的目标是获得更高级的 js 技能，那么您将不得不多挖一点：

[http://ejohn.org/apps/learn/](http://ejohn.org/apps/learn/) - 很好的教程，包含一些你应该知道的关于 js 的东西（对象、原型继承、声明提升概念等）。

[http://www.javascriptkit.com/javatutors/](http://www.javascriptkit.com/javatutors/) - 关于真实情况的非常实用的教程，有很好的解决方案

[http://code.google.com/p/jslibs/wiki/JavascriptTips](http://code.google.com/p/jslibs/wiki/JavascriptTips) - 有趣的 js 提示和技巧

[http://www.quirksmode.org/](http://www.quirksmode.org/) - 与学习 js 没有直接关系，但如果您打算在不同的浏览器中使用 js，则必须知道。

希望这会有所帮助

# java - Spring FileNotFoundException ..（没有这样的文件或目录）

> ID：12165171
> 
> 赞同：0
> 
> 时间：2012-08-28T18:18:15.013
> 
> 标签：java, spring, spring-mvc

我是 Spring MVC 的新手。我创建了一个新的 spring 控制器方法，它接受一个 fileoutputstream 并将 xml 写入它，如下所示：

```
@RequestMapping(value = "/xml", method = RequestMethod.GET, produces = MediaType.APPLICATION_XML_VALUE)

public final void getMappingsAsXML(HttpServletResponse response) {    
    Customer customer = getCustomerMappings();
    try {
          // Generates xml file
          xmlHelper.save(customer, new StreamResult(new FileOutputStream("/WEB-INF/content/customermapping.xml")));
          // print to browser
          // read generated file and write to response outputsteam
        } catch (XmlMappingException e) {
            e.printStackTrace();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
} 
```

但是，上面的代码会引发以下异常：

```
java.io.FileNotFoundException: /WEB-INF/content/customermapping.xml (No such file or directory)
    at java.io.FileOutputStream.open(Native Method)
    at java.io.FileOutputStream.<init>(FileOutputStream.java:194)
    at java.io.FileOutputStream.<init>(FileOutputStream.java:84) 
```

内容目录已存在于 WEB-INF 文件夹中。另外，有没有更好的方法在春季将文件写入浏览器？

[顺便说一句，我正在使用 Maven。]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:19:51.533

通过使用`/WEB-INF/content/customermapping.xml`您的路径告诉 Java 将一个名为的文件写入`customermapping.xml`驱动器*根*`WEB-INF/content`目录的目录。这听起来不像你想要的。

 *尝试删除前导`/`.

但是，将文件写入托管 Web 应用程序的同一目录中的文件可能是个坏主意，因为某些 servlet 容器（如 Tomcat）在您取消部署应用程序（使用默认设置）时会简单地删除整个目录。写入 webapp 外部的目录要好得多。*

# java - JPA / EclipseLink 延迟集合未加载

> ID：12165173
> 
> 赞同：1
> 
> 时间：2012-08-28T18:18:30.437
> 
> 标签：java, jpa, lazy-loading, eclipselink

我有一个具有此映射的用户实体：

```
@OneToMany(mappedBy = "supervisor", fetch = LAZY, cascade = [CascadeType.REFRESH])
List<Group> supervisedGroups = new ArrayList<Group>() 
```

以及具有此映射的 Group 实体：

```
@ManyToOne(fetch = LAZY, cascade = [CascadeType.REFRESH])
@JoinColumn(name = "supervisor")
User supervisor 
```

感谢存储库，我获取了用户

```
User user = userRepository.findById(id) 
```

findById 方法由事务包装（方法被事务管理器通知拦截），JPA 工作单元的持续时间与请求持续时间一样长（每个视图的会话）。

当我得到用户时，我会做一个

```
user.getSupervisedGroups() 
```

这会返回一个空列表。集合类型是 Eclipselinks 的 IndirectList，即使我调用 size() 方法，它也无济于事。

但是如果我执行

```
entitymanager.refresh(user)
user.getSupervisedGroups() 
```

然后我的列表中有 2 项...为什么？这是否意味着 EclipseLink 根本不支持对集合进行 LAZY 获取？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T12:58:00.610

我的猜测是您损坏了共享 L2 缓存中的对象。

插入此对象时，是否将正确的对象添加到集合中？我的猜测是你有一个双向的 OneToMany/ManyToOne 关系，当插入一侧而不添加到多侧时。您必须正确维护对象的关系。

见， [http ://en.wikibooks.org/wiki/Java_Persistence/Relationships#Object_corruption.2C_one_side_of_the_relationship_is_not_updated_after_updating_the_other_side](http://en.wikibooks.org/wiki/Java_Persistence/Relationships#Object_corruption.2C_one_side_of_the_relationship_is_not_updated_after_updating_the_other_side)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-06T11:07:32.753

詹姆斯的回答可能是问题的根源。另一种解决方案是禁用 EclipseLinks L2 缓存：

持久性单元属性：

```
<property name="eclipselink.cache.shared.default" value="false"/> 
```

或 JPA 2.0 持久性单元元素：

```
<shared-cache-mode>NONE</shared-cache-mode> 
```

来源：[https ://wiki.eclipse.org/EclipseLink/FAQ/How_to_disable_the_shared_cache%3F](https://wiki.eclipse.org/EclipseLink/FAQ/How_to_disable_the_shared_cache%3F)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T05:23:11.877

将您的 fetch 属性**fetch = LAZY**从两个实体更改为 fetch=FetchType.LAZY 喜欢这样**；**

```
 @OneToMany(mappedBy = "supervisor", fetch=FetchType.LAZY, cascade = CascadeType.REFRESH) 
```

# c - Kqueue 同时返回 EVFILT_READ 和 EVFILT_WRITE 但我安装了单独的 (ident,filt) 对

> ID：12165176
> 
> 赞同：4
> 
> 时间：2012-08-28T18:18:46.667
> 
> 标签：c, kqueue

我遇到了一个问题，我不确定是否是 kqueue 的预期行为，或者我做错了什么。

我需要使用 kqueue 为单个套接字文件描述符安装单独的事件。单独的事件是 (sockfd,EVFILT_READ) 和 (sockfd,EVFILT_WRITE) 的一个。但是，当我稍后从 kqueue 中提取事件时，我从 kqueue 中获得了两个事件，但这两个事件都包含（event.filter & EVFILT_READ）和（event.filter & EVFILT_WRITE）。

我需要将它们分开，否则我不知道哪个事件实际上已准备好，读取或写入？

这是我放在一起来说明问题的一些示例代码。请记住，这只是测试代码，以弄清楚为什么我在每个事件中都获得了两个过滤器标志。

```
int main(int argc, char ** argv) {
    //listening_sockfd = setup listening socket

    //setup kqueue and vars
    int kq = kqueue();
    int res = 0;
    int bufres = 0;
    struct timespec ts = {0};
    struct timespec * tsp = &ts;
    struct kevent ke2[2];

    //install read for listening socket
    struct kevent ke1;
    bzero(&ke1,sizeof(ke1));
    ke1.ident = listening_sockfd;
    ke1.flags = EV_ADD;
    ke1.filter = EVFILT_READ;
    res = kevent(kq,&ke1,1,NULL,0,tsp);

    while(1) {
        new_client:

        //wait for a client to connect
        res = kevent(kq,NULL,0,&ke1,1,NULL);
        if(res < 0) printf("%s\n", strerror(errno));

        if(res > 0) {
            //accept the client
            int clientfd = accept(skinfo.sockfd,NULL,NULL);

            //install read events for client
            bzero(&ke1,sizeof(ke1));
            ke1.ident = clientfd;
            ke1.flags = EV_ADD;
            ke1.filter = EVFILT_READ;
            res = kevent(kq,&ke1,1,NULL,0,tsp);
            if(res < 0) printf("%s\n",strerror(errno));

            while(1) {

                //wait for readable content from the client
                bzero(&ke1,sizeof(ke1));
                res = kevent(kq,NULL,0,&ke1,1,NULL);
                if(res < 0) printf("%s\n",strerror(errno));

                if(res > 0) {

                    //check for client disconnect
                    if(ke1.flags & EV_EOF) {
                        close(clientfd);
                        goto new_client;
                    }

                    //now install write events for client
                    bzero(&ke1,sizeof(ke1));
                    ke1.ident = clientfd;
                    ke1.flags = EV_ADD;
                    ke1.filter = EVFILT_WRITE;
                    res = kevent(kq,&ke1,1,NULL,0,tsp);
                    if(res < 0) printf("%s\n",strerror(errno));

                    //now wait for it to be writable - this will return
                    //immediately because the socket is writable.
                    res = kevent(kq,NULL,0,ke2,2,NULL);
                    if(res < 0) printf("%s\n",strerror(errno));

                    if(res >= 0) {
                        char buf[128];
                        printf("res: %i\n",res);

                        //we have two events from kqueue because I installed
                        //two (ident,filter) pairs.
                        int i = 0;
                        for(i; i<2; i++) {
                            printf("ident: %i\n",ke2[i].ident);
                            printf("filter[%i] %lu\n",i,ke2[i].filter);
                            printf("data: %lu\n",ke2[i].data);

                            //QUESTION: Why does EVFILT_READ && EVFILT_WRITE come
                            //back in the same event when I installed two seperate
                            //(ident,filter) pairs?
                            if(ke2[i].filter & EVFILT_READ) printf("EVFILT_READ\n");
                            if(ke2[i].filter & EVFILT_WRITE) printf("EVFILT_WRITE\n");

                            if(ke2[i].filter & EVFILT_READ) {
                                printf("readable!\n");
                                bufres = read(clientfd,buf,128);
                            }

                            if(ke2[i].filter & EVFILT_WRITE) {
                                printf("writable\n");

                                //shut off write events to stop infinite loop
                                //because the socket is writable
                                bzero(&ke1,sizeof(ke1));
                                ke1.ident = clientfd;
                                ke1.flags = EV_DELETE;
                                ke1.filter = EVFILT_WRITE;
                                res = kevent(kq,&ke1,1,NULL,0,tsp);

                                write(clientfd,buf,bufres);
                            }
                        }
                    }
                }
            }
        }
    }
} 
```

我一直无法弄清楚这一点。为什么当我安装单独的事件时，每个 kqueue 事件都包含 EVFILT_READ 和 EVFILT_WRITE？

这给我带来的真正问题是，因为这些事件总是报告 EVFILT_READ，它具有代码的副作用，总是认为有可用的读取，但实际上没有，所以对 read() 的调用将不成功并且有其他后果。请注意，此代码没有显示这些后果，这只是我编写的问题的一个示例，因此我弄清楚了这一点并继续使用我的真实代码。

有任何想法吗？

PS 这是 printf 的输出：

```
res: 2
ident: 5
filter[0] 4294967295
data: 5
EVFILT_READ
EVFILT_WRITE
readable!
writable
ident: 5
filter[1] 4294967294
data: 146988
EVFILT_READ
EVFILT_WRITE
readable!
writable 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-28T18:28:44.923

啊！我想我想通了。kqueue 文档没有说 event.filter 不包含位标志。所以我需要用 event.filter == EVFILT_READ, event.filter == EVFILT_WRITE 检查读/写。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-21T11:31:11.007

正如您所注意到的，它们不是要测试的位。

查阅 OS X 上的标题，我们发现

```
#define EVFILT_READ             (-1)
#define EVFILT_WRITE            (-2) 
```

由于`-1`都是 1 位，`x & EVFILT_READ`因此对于任何非零都为真`x`，并且`x & EVFILT_WRITE`对于`x`不等于零或一的情况为真。

# asp.net-mvc - MVC4 脚手架添加控制器给出错误“无法检索元数据...”

> ID：12165185
> 
> 赞同：25
> 
> 时间：2012-08-28T18:19:47.940
> 
> 标签：asp.net-mvc, asp.net-mvc-4, visual-studio-2012, scaffolding

我正在使用 RTM 版本的 Windows 8 和 VS 2012 Ultimate。我有一个使用 SqlCe **4.0 和代码优先实体框架模型**的 MVC4 项目。

模型很简单：

```
 public class MyThing
    {
        public int MyThingId { get; set; }

        public int UserId { get; set; }
        public string Title { get; set; }
        public string Address { get; set; }
        public string Description { get; set; }
        public DateTime Date { get; set; }
  } 
```

当我尝试使用内置脚手架创建新控制器时，我收到以下错误：

> “无法检索 MyThing 的元数据”
> 
> “不支持使用相同的 DbCompiledModel 针对不同类型的数据库服务器创建上下文。相反，为正在使用的每种类型的服务器创建单独的 DbCompiledModel。

如何让脚手架工作？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-28T18:30:38.910

通过反复试验，我找到了导致错误的代码行（它是 DbContext ctor）：

```
public class MyThingDb : DbContext
{
    // If I comment this constructor out the scaffolding works
    public MyThingDb()
        : base("DefaultConnection")
    {
    }

    public DbSet<MyThing> Things{ get; set; }
} 
```

怎么回事？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-07T09:14:59.500

在运行有关构建 MVC 音乐商店应用程序主题的教程时，我也偶然发现了这种症状。

Visual Studio 中似乎肯定存在错误。似乎触发此错误的是为连接字符串选择了一些名称，而不是默认名称。

[感谢http://forums.asp.net/t/1838396.aspx/1](http://forums.asp.net/t/1838396.aspx/1)上的用户 dwaynef找到了这个解决方法。

在添加新的脚手架控制器期间，您需要稍微详细说明一下，在 web.config 中将连接字符串的名称更改为“DefaultConnection”：

```
<connectionStrings>
     <add name="DefaultConnection" ... />
</connectionStrings> 
```

如果您有多个连接字符串 - 确保在执行操作时只有这个字符串存在。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-29T05:25:33.540

这是我的两分钱。我不相信您的解决方案实际上解决了真正的问题。真正的解决方法是向基本构造函数传递数据库名称而不是连接字符串名称，因此如果您的连接字符串是

```
<add name="MyContext" connectionString="Data Source=|DataDirectory|MyDatabase.sdf" providerName="System.Data.SqlServerCe.4.0" /> 
```

你的上下文类应该定义为

```
 public class MyContext : DbContext 
{
    public MyContext() : base("MyDatabase") { }... 
```

希望这对你和其他人有用，就像对我一样。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-06-04T23:01:00.713

这对我有用：

*   转到 web.config 中的连接字符串，更改以下内容： `providerName="System.Data.SqlClient"`

代替

`providerName="System.Data.SqlServerCe.4.0"`

*   生成你的控制器。
*   将 providerName 重命名为 " `System.Data.SqlServerCe.4.0`"。
*   运行你的项目。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-12-05T13:15:41.523

对我有用：在“添加新的脚手架项目”对话框中，我添加了一个具有任何名称的新上下文（加号）（对我来说是“ScaffoldingContext”）。然后脚手架工作。只需在 Controller 中重命名上下文即可。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-17T11:06:09.470

尝试不同的选项后，以下方法解决了错误..

如果连接字符串中的名称值与传递给构造函数的值匹配，则它可以工作。

```
 public MyThingDb()
        : base("name=MyContext")
    {
    } 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-08-15T08:51:21.103

问题可能是因为 `[NotMapped]`模型类之一中缺少属性。

因为我错过了这个属性，我很狡猾。

```
[Display(Name="Logo")]
[DataType(DataType.Upload)]
[NotMapped]
public HttpPostedFileBase Logo { set; get; } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-12-13T14:20:22.053

这有时可能是由关联属性或外键属性引起的

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-04-29T16:43:27.613

我通过在添加控制器之前按 CTRL+F5 来重建我的项目来解决这个问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-01-28T05:04:44.040

我有一个类似的问题，但它不是默认构造函数。如果您的解决方案中有多个项目，并且面向 MVC 的“Web”项目没有引用 EntityFramework，也会发生这种情况。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-07-26T08:58:35.287

对我有用的解决方案是将与连接字符串中的数据库名称相同的数据库名称传递给 dbContext 类的基本构造函数。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-05-02T10:02:07.193

改变里面的“东西”

```
public
DbSet<MyThing> Things
{ get; set; }
} 
```

到“Database1”，其中“Database1”是磁盘上数据库文件的名称，在您的`Web.config`文件中显示为“Database1.sdf”

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-06-12T13:37:34.343

在尝试使用脚手架从我的控制器创建视图时，我遇到了类似的问题。在创建视图对话框中，我只是清除了“数据上下文类”下拉菜单，然后脚手架机制措辞良好。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-03-07T07:33:48.697

这对我有用..

我使用“System.Data.SqlServerCe.4.0”注释掉了连接字符串，然后使用脚手架模板添加了控制器。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-10-19T14:18:07.193

MVC 5 / EF 6

也许你可以在旧版本中做到这一点？

1.  注释掉 web/app.config 中的连接字符串然后保存
2.  尝试创建新控制器并让 VS 创建一个“新”dbcontext 项，而不是选择您已有的
3.  点击创建
4.  删除新的 dbcontext 类
5.  用你的替换控制器 dbcontext
6.  取消注释 web / app.config 中的连接字符串，然后保存

为我工作！

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-04-13T14:01:32.007

我有同样的错误信息，但它与连接字符串无关。

这是一个非常罕见的情况，但希望这会对某人有所帮助。我的模型名称与我的命名空间名称的一部分相同。

例如：

```
namespace blah.blah.Building

public class Building 
```

我重命名了我的命名空间并修复了所有用法，然后 t4 脚手架工作了！

* * *

她是另一种可能的解决方案。您可能必须首先为“依赖”模型运行脚手架。然后逐步建立具有许多依赖关系的复杂模型。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-03-15T16:41:57.670

在您的上下文类中，当您要使用脚手架创建控制器时，您必须注释 DbConfigurationType。

```
//[DbConfigurationType(typeof(MySql.Data.Entity.MySqlEFConfiguration))]
public class NameDbContext 
{} 
```

# git - 没有出现在任何分支中但在“git show”中可用的提交发生了什么

> ID：12165190
> 
> 赞同：2
> 
> 时间：2012-08-28T18:20:09.020
> 
> 标签：git, git-branch, git-commit, git-show, git-reflog

我在裸仓库中有一个可用的提交 ID。
`git show commit id`, 显示带有更改的提交。

但是使用以下命令时不会显示相同的提交

```
git branch --contains <commit id> 
```

或者

```
git reflog show --all | grep <commit id> 
```

提交 ID 可能发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T19:33:01.280

可以创建一个分支，提交它，然后用`git branch -D`. 在这种情况下，提交会以这种方式*丢失*。Reflog 显示现有 refs 的日志。

此外，您的命令不会检查 HEAD 的 reflog。试试看`git reflog show HEAD`，如果它还没有被垃圾收集，它可能包含提交（例如，如果它已被制成分离的头部）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:23:38.797

（对不起我之前的回答，完全偏离主题）。

`git reflog``git pull`如果您或在遥控器上，每次提交都不会进行`git clone`，所以这个提交可能来自这些操作之一。

另外，我想您检查了提交是否少于 90 天，尽管它可能已经使用默认 gc 设置进行了 gced。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:36:11.743

这些提交被称为悬空提交，我相信`git fsck`会展示出来。它们仍然存在于 git 存储库中，直到`git gc`或`git prune`运行。通常，`git gc`当 repo 中有太多丢失的对象时会自动运行，并将它们打包到一个包文件中。`git gc`操作还将在一定时间之前删除 danling 提交。`git gc --prune=now`并将`git prune --expire=now`立即删除这些提交。`git config --global gc.auto 0`将禁用自动 gc 运行。

# typo3 - 将网站从typo3 移到concrete5

> ID：12165192
> 
> 赞同：-2
> 
> 时间：2012-08-28T18:20:14.507
> 
> 标签：typo3, concrete5

除了复制粘贴文本之外，还有其他方法可以将内容从typo3 移动到concrete5 吗？

最好的问候 马茨克鲁格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T21:48:10.003

也许，如果您的typo3 页面足够简单/足够大，那么编写一个从typo3 的数据库中获取数据、操作并写入concrete5 的php 脚本是可能的/值得的。但是，数据库逻辑似乎完全不同，因此可能很棘手。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T11:17:12.047

如果没有任何关于可以导入到具体的结构的信息，很难回答。但是有一些从 TYPO3 导出数据的一般可能性。

有一个扩展[l10nmgr](http://typo3.org/extensions/repository/view/l10nmgr)，旨在为翻译过程输出 TYPO3 内容。也许您可以使用 XML 并对其进行转换？

您可以只编写一个 TypoScript 模板，它会创建一个带有您需要的标签的 XML 文件。用它导出内容元素的构建应该很容易。

或者只是看看数据库并编写一个连接器，就像 kraabus 提到的那样。

# .htaccess - 仅重定向一页页面而不影响路径中带有名称的其他网址

> ID：12165193
> 
> 赞同：1
> 
> 时间：2012-08-28T18:20:16.073
> 
> 标签：.htaccess, redirect

我想重定向一个页面：

```
http://www.mysite.com/samplepage/ 
```

类似的页面`http://www.mysite.com/samplepage/samplepage2/`不应被重定向。

这是我当前的 .htaccess 代码：

```
RedirectMatch 301 ^/samplepage/ /new-samplepageurl 
```

问题：这个也重定向 url，如： `http://www.mysite.com/samplepage/samplepage2/`

我可以将重定向限制在一个确切的路径吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T18:52:12.843

尝试使用这个：

```
RedirectMatch 301 ^/samplepage/?$ /new-samplepageurl 
```

符号标记字符串的`$`结尾，并且`?`标记使尾部斜杠可选（例如，两者都`/samplepage`将`/samplepage/`被重定向）

# ios - Interface Builder 没有显示我的 IBOutlets

> ID：12165199
> 
> 赞同：0
> 
> 时间：2012-08-28T18:20:30.340
> 
> 标签：ios, xcode, interface-builder

我找到[了这个链接](https://stackoverflow.com/questions/1568930/interface-builder-and-xcode-integration-not-working/1571690#1571690)，它提供了从 finder 打开我的项目的解决方案。没运气。

我知道我的代码应该可以工作，因为我有一堆 UITextfields，其中大约一半可以工作，而其中一半没有几乎相同的代码。我怀疑我只是有太多的 IBOutlets 和 Interface Builder 就不会再向我展示了，因为我有这么多。（有 13 个标签和 12 个文本字段已经完全可用，并且正在尝试再添加 12 个文本字段）。

Interface Builder 是否有某种#-of-outlet 限制，这是一个 XCode 错误，还是 Interface Builder 中的设置我可能不小心更改了导致这种行为？

编辑：我的 .h 文件 - 我为它的可怕之处道歉。

```
#import <UIKit/UIKit.h>
#import "MatchSheet.h"
#import "Match.h"

@interface Individual : UIViewController<UIScrollViewDelegate>{
IBOutlet UIScrollView *scroller;
UILabel *label333Team1, *label333Team2, *label363Team1, *label363Team2, *labelCycleTeam1,       *labelCycleTeam2;
UILabel *label333Stacker1a, *label333Stacker1b, *label333Stacker2a, *label333Stacker2b, *label363Stacker1a, *label363Stacker1b, *label363Stacker2a, *labet363Stacker2b, *labelCycleStacker1a, *labelCycleStacker1b, *labelCycleStacker2a, *labelCycleStacker2b;

// 333 Attempts
UITextField *field333attempt1a1, *field333attempt1a2, *field333attempt1a3, *field333attempt1b1, *field333attempt1b2, *field333attempt1b3;
UITextField *field333attempt2a1, *field333attempt2a2, *field333attempt2a3, *field333attempt2b1, *field333attempt2b2, *field333attempt2b3;
// 363 Attempts
UITextField *field363attempt1a1, *field363attempt1a2, *field363attempt1a3, *field363attempt1b1, *field363attempt1b2, *field363attempt1b3;
UITextField *field363attempt2a1, *field363attempt2a2, *field363attempt2a3, *field363attempt2b1, *field363attempt2b2, *field363attempt2b3;
// Cycle Attempts
UITextField *fieldCycleattempt1a1, *fieldCycleattempt1a2, *fieldCycleattempt1a3, *fieldCycleattempt1b1, *fieldCycleattempt1b2, *fieldCycleattempt1b3;
UITextField *fieldCycleattempt2a1, *fieldCycleattempt2a2, *fieldCycleattempt2a3, *fieldCycleattempt2b1, *fieldCycleattempt2b2, *fieldCycleattempt2b3;
}

// Teams //
@property (nonatomic, strong) IBOutlet UILabel *label333Team1, *label333Team2;
@property (nonatomic, strong) IBOutlet UILabel *label363Team1, *label363Team2;
@property (nonatomic, strong) IBOutlet UILabel *labelCycleTeam1, *labelCycleTeam2;
// Stackers //
@property (strong, nonatomic) IBOutlet UILabel *label333Stacker1a, *label333Stacker1b,    *label333Stacker2a, *label333Stacker2b;
@property (strong, nonatomic) IBOutlet UILabel *label363Stacker1a, *label363Stacker1b, *label363Stacker2a, *label363Stacker2b;
@property (strong, nonatomic) IBOutlet UILabel *labelCycleStacker1a, *labelCycleStacker1b, *labelCycleStacker2a, *labelCycleStacker2b;

// Attempts //
// 333
@property (strong, nonatomic) IBOutlet UITextField *field333attempt1a1, *field333attempt1a2, *field333attempt1a3, *field333attempt1b1, *field333attempt1b2, *field333attempt1b3;
@property (strong, nonatomic) UITextField *field333attempt2a1, *field333attempt2a2, *field333attempt2a3, *field333attempt2b1, *field333attempt2b2, *field333attempt2b3;
// 363
@property (strong, nonatomic) IBOutlet UITextField *field363attempt1a1, *field363attempt1a2, *field363attempt1a3, *field363attempt1b1, *field363attempt1b2, *field363attempt1b3;
@property (strong, nonatomic) UITextField *field363attempt2a1, *field363attempt2a2, *field363attempt2a3, *field363attempt2b1, *field363attempt2b2, *field363attempt2b3;
// Cycle
@property (strong, nonatomic) IBOutlet UITextField *fieldCycleattempt1a1,  *fieldCycleattempt1a2, *fieldCycleattempt1a3, *fieldCycleattempt1b1, *fieldCycleattempt1b2, *fieldCycleattempt1b3;
@property (strong, nonatomic) UITextField *fieldCycleattempt2a1, *fieldCycleattempt2a2, *fieldCycleattempt2a3, *fieldCycleattempt2b1, *fieldCycleattempt2b2, *fieldCycleattempt2b3;

-(IBAction)switchview:(id)sender;

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T06:12:49.033

您只需将 IBOutlet 放在您的一些 UITextField 属性声明之前。在您的标题中，确保将 IBOutlet 放在所有它们的前面，如下所示：

```
// Attempts //
// 333
@property (strong, nonatomic) IBOutlet UITextField *field333attempt1a1, *field333attempt1a2, *field333attempt1a3, *field333attempt1b1, *field333attempt1b2, *field333attempt1b3;
@property (strong, nonatomic) IBOutlet UITextField *field333attempt2a1, *field333attempt2a2, *field333attempt2a3, *field333attempt2b1, *field333attempt2b2, *field333attempt2b3;
// 363
@property (strong, nonatomic) IBOutlet UITextField *field363attempt1a1, *field363attempt1a2, *field363attempt1a3, *field363attempt1b1, *field363attempt1b2, *field363attempt1b3;
@property (strong, nonatomic) IBOutlet UITextField *field363attempt2a1, *field363attempt2a2, *field363attempt2a3, *field363attempt2b1, *field363attempt2b2, *field363attempt2b3;
// Cycle
@property (strong, nonatomic) IBOutlet UITextField *fieldCycleattempt1a1,  *fieldCycleattempt1a2, *fieldCycleattempt1a3, *fieldCycleattempt1b1, *fieldCycleattempt1b2, *fieldCycleattempt1b3;
@property (strong, nonatomic) IBOutlet UITextField *fieldCycleattempt2a1, *fieldCycleattempt2a2, *fieldCycleattempt2a3, *fieldCycleattempt2b1, *fieldCycleattempt2b2, *fieldCycleattempt2b3; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T06:49:09.653

您的代码：

```
@property (strong, nonatomic) IBOutlet UITextField *field333attempt1a1, *field333attempt1a2, *field333attempt1a3, *field333attempt1b1, *field333attempt1b2, *field333attempt1b3;
@property (strong, nonatomic) UITextField *field333attempt2a1, *field333attempt2a2, *field333attempt2a3, *field333attempt2b1, *field333attempt2b2, *field333attempt2b3;

// 363
@property (strong, nonatomic) IBOutlet UITextField *field363attempt1a1, *field363attempt1a2, *field363attempt1a3, *field363attempt1b1, *field363attempt1b2, *field363attempt1b3;
@property (strong, nonatomic) UITextField *field363attempt2a1, *field363attempt2a2, *field363attempt2a3, *field363attempt2b1, *field363attempt2b2, *field363attempt2b3;

// Cycle
@property (strong, nonatomic) IBOutlet UITextField *fieldCycleattempt1a1,  *fieldCycleattempt1a2, *fieldCycleattempt1a3, *fieldCycleattempt1b1, *fieldCycleattempt1b2, *fieldCycleattempt1b3;
@property (strong, nonatomic) UITextField *fieldCycleattempt2a1, *fieldCycleattempt2a2, *fieldCycleattempt2a3, *fieldCycleattempt2b1, *fieldCycleattempt2b2, *fieldCycleattempt2b3; 
```

第 2 行、第 4 行和第 6 行代码有错误。您没有将 UITextField 定义为 IBOutlet。

将 IBOutlet 添加到 UITextFields，它肯定会起作用。

新代码：

```
@property (strong, nonatomic) IBOutlet UITextField *field333attempt1a1, *field333attempt1a2, *field333attempt1a3, *field333attempt1b1, *field333attempt1b2, *field333attempt1b3;
@property (strong, nonatomic) IBOutlet UITextField *field333attempt1a1, *field333attempt1a2, *field333attempt1a3, *field333attempt1b1, *field333attempt1b2, *field333attempt1b3;

//363
@property (strong, nonatomic) IBOutlet UITextField *field363attempt1a1, *field363attempt1a2, *field363attempt1a3, *field363attempt1b1, *field363attempt1b2, *field363attempt1b3;
@property (strong, nonatomic) IBOutlet UITextField *field363attempt2a1, *field363attempt2a2, *field363attempt2a3, *field363attempt2b1, *field363attempt2b2, *field363attempt2b3;

// Cycle
@property (strong, nonatomic) IBOutlet UITextField *fieldCycleattempt1a1,  *fieldCycleattempt1a2, *fieldCycleattempt1a3, *fieldCycleattempt1b1, *fieldCycleattempt1b2, *fieldCycleattempt1b3;
@property (strong, nonatomic) IBOutlet UITextField *fieldCycleattempt2a1, *fieldCycleattempt2a2, *fieldCycleattempt2a3, *fieldCycleattempt2b1, *fieldCycleattempt2b2, *fieldCycleattempt2b3; 
```

# python - 无序 Python 集的“顺序”

> ID：12165200
> 
> 赞同：59
> 
> 时间：2012-08-28T18:20:30.567
> 
> 标签：python, python-internals

我知道 Python 中的集合是无序的，但我对它们显示的“顺序”很好奇，因为它似乎是一致的。它们似乎每次都以相同的方式出现故障：

```
>>> set_1 = set([5, 2, 7, 2, 1, 88])
>>> set_2 = set([5, 2, 7, 2, 1, 88])
>>> set_1
set([88, 1, 2, 5, 7])
>>> set_2
set([88, 1, 2, 5, 7]) 
```

...还有另一个例子：

```
>>> set_3 = set('abracadabra')
>>> set_4 = set('abracadabra')
>>> set_3
set(['a', 'r', 'b', 'c', 'd'])
>>>> set_4
set(['a', 'r', 'b', 'c', 'd']) 
```

我只是好奇为什么会这样。有什么帮助吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-08-28T18:23:18.547

你应该观看这个[视频](https://www.youtube.com/watch?v=C4Kc8xzcA68)（虽然它是 CPython ¹特定的并且是关于字典的——但我认为它也适用于集合）。

基本上，python 对元素进行哈希处理并获取最后 N 位（其中 N 由集合的大小决定）并将这些位用作数组索引以将对象放置在内存中。然后按照它们在内存中存在的顺序生成对象。当然，当您需要解决哈希之间的冲突时，情况会变得更加复杂，但这就是要点。

另请注意，它们的打印顺序取决于您放置它们的顺序（由于冲突）。因此，如果您对传递给的列表重新排序，`set_2`如果存在键冲突，您可能会得到不同的顺序。

例如：

```
list1 = [8,16,24]
set(list1)        #set([8, 16, 24])
list2 = [24,16,8]
set(list2)        #set([24, 16, 8]) 
```

*请注意*，这些集合中保留的顺序是“巧合”，并且与冲突解决有关（我对此一无所知）。关键是 , 和 的最后 3 位`hash(8)`是`hash(16)`相同`hash(24)`的。因为它们是相同的，所以冲突解决会接管并将元素放在“备份”内存位置而不是第一个（最佳）选择中，因此是否`8`占据一个位置或`16`取决于哪个首先到达聚会并采取“最佳座位”。

如果我们用`1`,`2`和重复该示例，`3`无论它们在输入列表中的顺序如何，您都将获得一致的顺序：

```
list1 = [1,2,3]
set(list1)      # set([1, 2, 3])
list2 = [3,2,1]
set(list2)      # set([1, 2, 3]) 
```

由于`hash(1)`,`hash(2)`和的最后 3 位`hash(3)`是唯一的。

* * *

¹**注意**这里描述的实现适用于 CPython`dict`和`set`. 我认为一般描述适用于所有现代版本的 CPython，直到 3.6。但是，从 CPython3.6 开始，有一个额外的实现细节实际上保留了`dict`. 看来`set`还是没有这个属性。pypy 人（他们在 CPython 人之前就开始使用它）在[这篇博](https://morepypy.blogspot.com/2015/01/faster-more-memory-efficient-and-more.html)文中描述了数据结构。最初的想法（至少对于 python 生态系统）[存档在 python-dev 邮件列表中](https://mail.python.org/pipermail/python-dev/2012-December/123028.html)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-09-09T17:09:25.903

这种行为的原因是 Python 使用哈希表来实现字典：[https ://en.wikipedia.org/wiki/Hash_table#Open_addressing](https://en.wikipedia.org/wiki/Hash_table#Open_addressing)

键的位置由它的内存地址定义。如果您知道 Python 会为某些对象重用内存：

```
>>> a = 'Hello world'
>>> id(a)
140058096568768
>>> a = 'Hello world'
>>> id(a)
140058096568480 
```

您可以看到对象**a**每次初始化时都有不同的地址。

但对于小整数，它不会改变：

```
>>> a = 1
>>> id(a)
40060856
>>> a = 1
>>> id(a)
40060856 
```

即使我们创建具有不同名称的第二个对象，它也是一样的：

```
>>> b = 1
>>> id(b)
40060856 
```

这种方法可以节省 Python 解释器消耗的内存。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-28T18:29:57.183

AFAIK Python 集是使用[哈希表](http://en.wikipedia.org/wiki/Hash_table)实现的。项目出现的顺序取决于所使用的散列函数。在程序的同一运行中，哈希函数可能不会改变，因此您得到相同的顺序。

但是不能保证它总是使用相同的函数，并且顺序会在运行之间发生变化 - 或者如果您插入大量元素并且哈希表必须调整大小，则在同一次运行中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-28T18:23:26.137

集合基于哈希表。值的哈希值应该是一致的，因此顺序也是一致的 - 除非两个元素哈希到相同的代码，在这种情况下，插入顺序将改变输出顺序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-09T17:55:54.760

暗示[mgilson 的好答案](https://stackoverflow.com/a/12165239/908494)的关键一件事，但在任何现有答案中都没有明确提及：

小整数自己散列：

```
>>> [hash(x) for x in (1, 2, 3, 88)]
[1, 2, 3, 88] 
```

字符串散列为不可预测的值。事实上，从 3.3 开始，默认情况下，[它们是基于启动时随机分配的种子构建的](https://docs.python.org/3/using/cmdline.html#envvar-PYTHONHASHSEED)。因此，对于每个新的 Python 解释器会话，您都会得到不同的结果，但是：

```
>>> [hash(x) for x in 'abcz']
[6014072853767888837,
 8680706751544317651,
 -7529624133683586553,
 -1982255696180680242] 
```

* * *

因此，考虑最简单的哈希表实现：只是一个包含 N 个元素的数组，其中插入一个值意味着将其放入`hash(value) % N`（假设没有冲突）。你可以粗略地猜测`N`会有多大——它会比其中的元素数量大一点。当从 6 个元素的序列中创建一个集合时，N 可以很容易地为 8。

当你用 N=8 存储这 5 个数字时会发生什么？嗯，`hash(1) % 8`，`hash(2) % 8`等只是数字本身，但`hash(88) % 8`为 0。因此，哈希表的数组最终包含`88, 1, 2, NULL, NULL, 5, NULL, 7`。所以应该很容易弄清楚为什么迭代集合可能会给你`88, 1, 2, 5, 7`.

当然 Python 并不能*保证*你每次都能得到这个订单。它猜测正确值的方式的微小变化`N`可能意味着`88`最终会出现在不同的地方（或最终与其他值之一发生冲突）。而且，事实上，在我的 Mac 上运行 CPython 3.7，我得到`1, 2, 5, 7, 88`.0

同时，当您从大小为 11 的序列构建散列，然后将随机散列插入其中时，会发生什么？即使假设最简单的实现，并且假设没有冲突，您仍然不知道您将获得什么顺序。它会在 Python 解释器的一次运行中保持一致，但在您下次启动它时会有所不同。（除非您设置`PYTHONHASHSEED`为`0`，或其他一些 int 值。）这正是您所看到的。

* * *

当然，值得关注的[是集合的实际实现方式，](https://github.com/python/cpython/blob/master/Objects/setobject.c)而不是猜测。但是，根据最简单的哈希表实现的假设，您会猜到（排除冲突和哈希表扩展）究竟会发生什么。

# php - 带有 MySQL 集群的 PHP/PDO

> ID：12165203
> 
> 赞同：11
> 
> 时间：2012-08-28T18:20:43.763
> 
> 标签：php, mysql, pdo, cluster-computing

我被要求重新开发一个旧的 php Web 应用程序，该应用程序当前使用 mysql_query 函数来访问复制的数据库（4 个从属，1 个主控）。

这种重新开发的一部分将把一些数据库移动到一个 mysql 集群中。这些天我通常使用 PDO 来访问数据库，并且我试图找出 PDO 是否可以很好地与集群配合使用，但是我在网络上找不到太多有用的信息。

有人对这个有经验么？我以前从未使用过集群...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T14:37:27.603

我已经通过不同的成功程度以几种不同的方式做到了这一点。简短的回答是您的 PDO 连接应该可以正常工作。我看到的选项如下：

如果您正在使用复制，那么要么编写一个处理与各种服务器的连接的类，要么使用代理。代理可以是硬件或软件。MySQL Proxy (http://docs.oracle.com/cd/E17952_01/refman-5.5-en/mysql-proxy.html) 是我曾经使用的软件负载平衡器，并且在大多数情况下它起到了作用。它会自动在您的读者和作者之间路由流量，并像冠军一样处理故障转移。时不时地我们会编写一个查询，它会抛出它并且必须调整一些东西，但那是几年前的事了。它现在可能处于更好的状态。

另一种选择是使用标准负载平衡器并创建两个连接 - 一个用于写入器，另一个用于读取器。您的应用可以根据它尝试执行的功能来决定使用哪个连接。

最后，您可以考虑使用 MySQL 提供的 max db cluster。在此设置中，MySQL 服务器都是读取器和写入器。您只需要一个连接，但您需要一个负载均衡器来路由所有流量。如果索引不同步，Max db cluster 可能会很棘手，因此如果您使用此选项，请谨慎行事。

澄清：当我提到连接时，我的意思是连接到 MySQL 的地址和端口——不要与在同一端口上运行的并发连接混淆。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T14:51:02.073

您是否考虑过将集群隐藏在硬件或软件负载平衡器（例如 HAProxy）之后？这样，客户端代码根本不需要处理集群，它将集群视为一个虚拟服务器。

您仍然需要区分写入的应用程序和读取的应用程序。在我们的系统中，我们把从服务器放在负载均衡器后面，只读应用程序使用这个集群，而写应用程序直接访问主服务器。我们不会试图让这一切自动发生；需要更新数据库的应用程序只需使用不同的服务器主机名和用户名。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-28T18:30:40.457

为其中包含连接和查询功能的数据库编写一个包装类...

查询功能需要查看第一个单词以检测它是否是 SELECT 并使用从数据库连接，其他任何内容（INSERT、UPDATE、RENAME、CREATE 等）都需要进入 MASTER 服务器。

connect() 函数将查看从属数组并随机选择一个来使用。

你应该只在需要更新时连接到主从（大多数网页不应该更新数据库，只读取数据......确保你不会浪费时间连接到主数据库）用它）

你也可以在你的类中使用一个静态变量来保存你的数据库连接，这样连接就可以在你的数据库类的实例之间共享（即你只需要打开一次数据库连接，而不是每次调用 '$db = new DB( )')

将数据库函数抽象成这样的类也可以更容易地调试或添加特性

# emacs - 如何使用行+文件引用从emacs缓冲区复制/粘贴区域？

> ID：12165205
> 
> 赞同：4
> 
> 时间：2012-08-28T18:20:46.013
> 
> 标签：emacs, reference, line, kill, yank

我不时看到人们根据文件名和行号粘贴部分代码。就像是

```
 ;; ----- line:3391   file: simple.el.gz -----;;; 

 (if (eq last-command 'kill-region)
      (kill-append (filter-buffer-substring beg end) (< end beg))
    (kill-new (filter-buffer-substring beg end)))

 ;; ----- line:3394 --------------------------;;; 
```

这主要用于通过邮件发送对代码的评论。我可以轻松地为自己包装一个简单的函数，但我确信有人已经以一种聪明而漂亮的方式完成了这个。

谢谢。

[编辑]

因为这个功能只是偶尔需要，而且只有一个复制/粘贴操作，我最终使用了@thisirs 提出的切换版本的替代解决方案。

```
(defun kill-with-linenum (beg end)
  (interactive "r")
  (save-excursion
    (goto-char end)
    (skip-chars-backward "\n \t")
    (setq end (point))
    (let* ((chunk (buffer-substring beg end))
           (chunk (concat
                   (format "╭──────── #%-d ─ %s ──\n│ "
                           (line-number-at-pos beg)
                           (or (buffer-file-name) (buffer-name))
                           )
                   (replace-regexp-in-string "\n" "\n│ " chunk)
                   (format "\n╰──────── #%-d ─" 
                           (line-number-at-pos end)))))
      (kill-new chunk)))
  (deactivate-mark)) 
```

它基于 unicode 并产生以下输出：

```
╭──────── #3557 ─ /usr/share/emacs/24.1.50/lisp/simple.el.gz ──
│   (if (eq this-command t)
│       (setq this-command 'yank))
│   nil)
╰──────── #3559 ─ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T09:23:31.350

我想出了这个，使用包装钩：

```
(defun filter-buffer-substring-add-line (func beg end delete)
  (concat
   (format ";; line:%5d file: %s\n"
           (line-number-at-pos beg)
           (or (buffer-file-name) (buffer-name)))
   (funcall func beg end delete)
   (format "\n;; line:%5d" (line-number-at-pos end))))

(defun kill-add-line-toggle ()
  (interactive)
  (if (memq 'filter-buffer-substring-add-line
            filter-buffer-substring-functions)
      (progn
        (setq filter-buffer-substring-functions
              (delq 'filter-buffer-substring-add-line
                    filter-buffer-substring-functions))
        (message "Add line is off!"))
    (push 'filter-buffer-substring-add-line
          filter-buffer-substring-functions)
    (message "Add line is on!"))) 
```

# jsp - 是否可以在 JSTL forEach 循环中重新分配循环索引？

> ID：12165206
> 
> 赞同：1
> 
> 时间：2012-08-28T18:20:55.233
> 
> 标签：jsp, jstl, el

是否可以在循环中重新分配循环索引以跳过迭代？

玩具示例，打印数字列表`1,2,3,4,5,8,9,10`：

```
<ul>
<c:forEach var="counter" begin="${1}" end="${10}">
    <li>${counter}</li>
    <c:if test="${counter eq 5}">
        <c:set var="counter" value="${counter+2}" /> <!-- skip two iterations -->
    </c:if>
</c:forEach>
</ul> 
```

这个例子不起作用。有没有办法让它工作？

我并不是说这是一个好主意，我只想知道这是否可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:23:48.370

不。

根据具体的功能要求，您需要以不同的方式解决它。例如，仅在条件真正匹配时才打印迭代项。

```
<c:forEach var="counter" begin="${1}" end="${10}">
    <c:if test="${counter lt 6 or counter gt 7}">
        <li>${counter}</li>
    </c:if>
</c:forEach> 
```

# objective-c - 将索引传回父视图控制器

> ID：12165207
> 
> 赞同：0
> 
> 时间：2012-08-28T18:21:03.730
> 
> 标签：objective-c, xcode

NSMutableArray`detailsDataSource`和 int`detailIndex`从以下位置传递到下一个 View Controller `MainDetailViewController.m`：

```
#import "UsersDetailViewController.h"
...
- (void)swipeDetectedUp:(UISwipeGestureRecognizer *)sender
{
    UsersDetailViewController *usersController = [[self storyboard] instantiateViewControllerWithIdentifier:@"UsersController"];
    [self.navigationController pushViewController:usersController animated:NO];

    usersController.usersDataSource = [[NSMutableArray alloc] initWithArray:detailsDataSource];
    usersController.userDetailIndex = detailIndex;
} 
```

在索引中滑动`UserDetailViewController.m`：

```
- (void)swipeDetectedRight:(UISwipeGestureRecognizer *)sender
{
if (userDetailIndex != 0)
    userDetailIndex--;  
} 
```

当 swipeDetectedDown 弹回时，`MainDataViewController`需要知道要显示哪个索引处的对象：

```
- (void)swipeDetectedDown:(UISwipeGestureRecognizer *)sender
{
//jump to correct object at index, same as current object at index in this view
[self.navigationController popViewControllerAnimated:NO];
} 
```

代码建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T22:14:50.127

简单的部分是将 UsersDetailViewController 指针放入 MainDetailViewController 的属性中，以便稍后可以访问 self.usersController.usersDataSource 和 self.usersController.userDetailIndex。然后唯一的技巧是让它知道何时弹出 UsersDetailViewController。

在我以前编写的代码中，我经常尝试将 MainDetailViewController 设置为 UsersDetailViewController 的委托，并在 UsersDetailViewController 想要以编程方式关闭时调用 MainDetailViewController 中的委托方法，并同时执行 popViewControllerAnimated: 并更新 MainDetailViewController 的状态. 换句话说，总是让父母的代码弹出孩子。这是可行的，但在您通过导航控制器的后退按钮自动弹出子视图控制器的情况下则不行，所以总的来说我反对这种技术。

我认为有更好的解决方案可以让父母的代码在其孩子被弹出时被调用。也许实现一个 viewWillAppear 方法，如果 self.usersController 在那里设置，那么你知道你是从 UsersDetailViewController 回来的，此时访问另一个控制器的属性并最终清除 self.usersController。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:56:11.047

使用 NSNotificationCenter 将对象发送回 MainDataViewController...

例子：

在 UsersDetailViewController 中，使用 key=>value 对填充 NSDictionary，然后将其发送到您希望它去的地方。

```
NSArray *key = [NSArray arrayWithObject:@"myIndex"];
NSArray *object = [NSArray arrayWithObject:detailIndex];  
NSDictionary *dictionary = [NSDictionary dictionaryWithObjects:object forKeys:key];
[[NSNotificationCenter defaultCenter] postNotificationName:@"MainDataViewController" object:self userInfo:dictionary]; 
```

注意：您需要在 MainDataViewController 上设置一个标识符，称为 MainDataViewController 或您想调用的任何名称。使用 VC 名称使其更简单。

然后在 MainDataViewController 的 viewDidLoad() 方法中执行此操作。

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(receiveNotification:) name:@"MainDataViewController" object:nil]; 
```

然后使用以下方法接收通知：

```
- (void)receiveNotification:(NSNotification *) notification
{    
    if([[notification name] isEqualToString:@"MainDataViewController"])
    {       
        NSDictionary *dictionary = [NSDictionary dictionaryWithDictionary:[notification userInfo]];

        if([dictionary valueForKey:@"myIndex"]) 
        {
            // do whatever you need to do with the passed object here. In your case grab the detailIndex and use it for something...
        }             
    }
} 
```

# java - 创建文件 ..xml 中定义的名称为“..”的 bean 时出错

> ID：12165208
> 
> 赞同：1
> 
> 时间：2012-08-28T18:21:07.200
> 
> 标签：java, spring

你能帮我吗？1.我的道

```
package user.dao.impl;

import java.sql.ResultSet;
import java.sql.SQLException;

import javax.sql.DataSource;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.core.RowCallbackHandler;
import org.springframework.jdbc.datasource.DataSourceTransactionManager;
import user.domain.DboBean;

public class DboDao {
    private DataSourceTransactionManager transactionManager;
    private JdbcTemplate jdbcTemplate;

    public DboDao() {
        // TODO Auto-generated constructor stub
        super();
        DataSource datatSource = transactionManager.getDataSource();
        jdbcTemplate = new JdbcTemplate(datatSource);
    }

//Spring setter injector used
public void setTransactionManager(DataSourceTransactionManager transactionManager){
    this.transactionManager = transactionManager;
}

public DboBean read() {//String dboId
    // TODO Auto-generated method stub
    String sql = "SELECT ins_ID, ins_name FROM da_tracking "
            + "WHERE ins_ID = 3";
    final Object[] params = new Object[] {};//dboId

    //Creating object being queried
    final DboBean dboBean = new DboBean();      
    //Process query Results
    jdbcTemplate.query(sql, params, new RowCallbackHandler(){
        public void processRow(ResultSet rs) throws SQLException{
            dboBean.setDboId(rs.getString("dboId"));    
        }

    });
    return dboBean;//returns queried objects
}
} 
```

2.我的豆子：

```
 package user.domain;

 public class DboBean {

    private String dboId;
    private String dboDevName;

    public DboBean(){
        this.setDboId(dboId);
        this.setDboDevName(dboDevName);     
    }

    public String getDboId() {
        return dboId;
    }

    public void setDboId(String dboId) {
        this.dboId = dboId;
    }

    public String getDboDevName() {
        return dboDevName;
    }

    public void setDboDevName(String dboDevName) {
        this.dboDevName = dboDevName;
    }
 } 
```

我的春天：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:lang="http://www.springframework.org/schema/lang"
xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.1.xsd
http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang-3.1.xsd">

<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource"
    destroy-method="close">
    <property name="driverClassName" value="net.sourceforge.jtds.jdbc.Driver" />
    <property name="url"
        value="jdbc:jtds:sqlserver://localhost:1433;databaseName=XYDB" />
    <property name="username" value="user" />
    <property name="password" value="xyz" />            
</bean>

<bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
    <property name="dataSource" ref="dataSource" />
</bean>

<bean id="objDbo" class="user.dao.impl.DboDao">
    <property name="transactionManager" ref="transactionManager" />
</bean>

</beans> 
```

还有我的 Junit：

```
package user.dao.JUnitTest;

import junit.framework.Test;
import junit.framework.TestCase;
import junit.framework.TestSuite;

import org.apache.log4j.xml.DOMConfigurator;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.FileSystemXmlApplicationContext;
import java.lang.Object;

import user.dao.impl.DboDao;
import user.domain.DboBean;

public class JUnitDaoTest extends TestCase {
private static final String OID = "dboId";
private static final String DDN = "dboDevName";
protected static ApplicationContext appContext;
private DboDao objDao;

public JUnitDaoTest(String arg) {
    super(arg);
}

public static Test suite(){
    TestSuite suite = new TestSuite();
    suite.addTest(new JUnitDaoTest("testDboDAO"));
    return suite;       
}

public void setUp() throws Exception{
    init();
    objDao =  (DboDao) getBean("objDao");
}

public static void main(String[] args){
    junit.textui.TestRunner.run(suite());
}
//@Override
public synchronized void init(){
    if (appContext == null){
        try{
            String path = System.getProperty("user.dir");
            String slash = System.getProperty("file.separator");

            String configDir = path + slash + "config" + slash;
            DOMConfigurator.configure(configDir +  "log4j.xml");

            appContext = new FileSystemXmlApplicationContext(new String[] {configDir + "appContext.xml"});
        }catch(Exception e){
            System.err.println(e.getMessage());
        }
    }
}

protected Object getBean(String beanName){
    return appContext.getBean(beanName);
}

public void testDboDAO(){
    DboBean record = new DboBean();
    record.setDboId(OID);//setDboId(dboId);
    record.setDboDevName(DDN);

    DboBean bean = objDao.read();
    assertEquals(DDN, bean.getDboDevName());
    System.out.println("User selected [" + bean.getDboId() + ", " + bean.getDboDevName() + 
            "]");

    //objDao.delete(dboId);
    //bean = objDao.read(dboId);
    //assertEquals(null, bean.getDboDevName());
    //System.out.println("User is deleted [" + bean.getDboId() + ", " + bean.getDboDevName() + 
        //  "]");

} 
```

}

我收到此错误：创建文件 [...\config\appContext.xml] 中定义的名称为 'objDbo' 的 bean 时出错：bean 的实例化失败；嵌套异常是 org.springframework.beans.BeanInstantiationException：无法实例化 bean 类 [user.dao.impl.DboDao]：构造函数抛出异常；嵌套异常是 java.l

你有想法吗？？斑点

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:22:02.650

堆栈跟踪将解释确切的问题，它将出现在您切断的堆栈跟踪的“嵌套异常是 java.l ...”部分之后。阅读整个错误消息。

如果我猜测一下，您的`DboDao`类在构造函数中有一个空指针异常，因为您指的是一个`transactionManager`尚未设置的字段。

我建议编写这个`DboDao`类的单元测试——它根本不涉及 Spring——来测试你调用`new DboDao()`.

此外，您可能会发现让您的 DAO 类扩展 Spring 实用程序类很方便[`JdbcDaoSupport`](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/jdbc/core/support/JdbcDaoSupport.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:38:05.717

```
public class DboDao {
private DataSourceTransactionManager transactionManager;
private JdbcTemplate jdbcTemplate;

public DboDao() {
    // TODO Auto-generated constructor stub
    super();
    // problem exists here, as transactionManager is not set yet and
    // you are using Setter Based injection so `NPE`
    // you can move this code in setter method of transactionManager, to make it work. 
    DataSource datatSource = transactionManager.getDataSource(); 
    jdbcTemplate = new JdbcTemplate(datatSource);
}............. 
```

另外，我在您的代码中看到了错误的内容。在服务层使用事务管理器。并在 DboDao 中注入 dataSource。并创建 jdbcTemplate，如下所示：

```
public class DboDao {
private DataSource dataSource;  // either use @Autowire or provide xml config
private JdbcTemplate jdbcTemplate;

public DboDao() {        
    super();        
}
....// getter and setter for jdbcTemplate and dataSource

public void setDataSource(DataSource dataSource) {
    this.dataSource = dataSource;
    jdbcTemplate = new JdbcTemplate(dataSource);
} 
```

查看您的配置文件，如果您想让您的应用程序运行：在 setter 方法中初始化 dataSource 和 jdbcTemplate，因为您使用的是基于 setter 的注入。

```
public class DboDao {
    private DataSourceTransactionManager transactionManager;
    private JdbcTemplate jdbcTemplate;

    public DboDao() {
        super();            
    }

//Spring setter injector used
public void setTransactionManager(DataSourceTransactionManager transactionManager){
    this.transactionManager = transactionManager;
    // moved code from constructor
    DataSource datatSource = transactionManager.getDataSource(); 
    jdbcTemplate = new JdbcTemplate(datatSource);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:31:45.853

您的 DataSourceTransactionManager 在构造函数中使用时未设置。当 Spring 设置您的上下文时，这将导致 NPE。

您也可以只依赖注入 JdbcTemplate，因为您的事务管理器除了设置 JdbcTemplate 外没有被使用。如果出于某种原因，您不想配置 JdbcTemplate，则可以使用[init 方法](http://www.mkyong.com/spring/spring-init-method-and-destroy-method-example/)来构建它（因为它将在 Spring 提供所有依赖项后调用）。

# regex - 如何正则表达式比较破折号中的字符串？

> ID：12165212
> 
> 赞同：4
> 
> 时间：2012-08-28T18:21:21.160
> 
> 标签：regex, bash, dash-shell

出于兼容性原因，我正在移动一个 bash 脚本来破折号。以下比较是否有 POSIX/Dash 替代方案？

```
COMPARE_TO="^(lp:~?|https?://|svn://|svn\+ssh://|bzr://|bzr\+ssh://|git://|ssh://)"

if [[ $COMPARE =~ $COMPARE_TO ]]; then
    echo "WE ARE COMPARED!"
fi 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-28T18:25:49.207

你可以用一个案例。它不使用正则表达式，但使用 glob 并没有那么长

```
case $compare in
    lp:*|http://*|https://*|svn://*|svn+ssh://*|bzr://*|bzr+ssh://*|git:/*|ssh://*)
        echo "We are compared"
    ;;
esac 
```

附带说明一下，您应该[避免使用所有大写的变量名](https://stackoverflow.com/a/673940/1524545)，因为您可能会覆盖特殊的 shell 变量或环境变量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T18:54:53.187

dash 没有内置正则表达式比较，但您始终可以使用 grep：

```
if echo "$compare" | egrep -q "$compare_to"; then
    ... 
```

（请注意，我第二次@geirha 关于shell 中的大写变量的注释。）

# javascript - Facebook js代码中的访问被拒绝错误

> ID：12165215
> 
> 赞同：1
> 
> 时间：2012-08-28T18:21:39.307
> 
> 标签：javascript, facebook

在过去一周左右的时间里，我在使用 Facebook 的 js sdk 代码时遇到了零星的 javascript 错误。

这是错误：

![在此处输入图像描述](../Images/216f9653ce0d1977946fe37f9276a2d6.png)

这是代码行：

![在此处输入图像描述](../Images/41d9ea2212020a62c93237a0fde63ae0.png)

来自 Facebook 网站的 JavaScript 代码：

```
/*1345677565,173217057*/

if (window.CavalryLogger) { CavalryLogger.start_js(["p0usZ"]); }

if(!Array.isArray)Array.isArray=function(a){return Object.prototype.toString.call(a)=='[object Array]';};
if(!Array.prototype.map)Array.prototype.map=function(a,b){if(typeof a!='function')throw new TypeError();var c,d=this.length,e=new Array(d);for(c=0;c<d;++c)if(c in this)e[c]=a.call(b,this[c],c,this);return e;};if(!Array.prototype.forEach)Array.prototype.forEach=function(a,b){this.map(a,b);};if(!Array.prototype.filter)Array.prototype.filter=function(a,b){if(typeof a!='function')throw new TypeError();var c,d,e=this.length,f=[];for(c=0;c<e;++c)if(c in this){d=this[c];if(a.call(b,d,c,this))f.push(d);}return f;};if(!Array.prototype.every)Array.prototype.every=function(a,b){if(typeof a!='function')throw new TypeError();var c=new Object(this),d=c.length;for(var e=0;e<d;e++)if(e in c)if(!a.call(b,c[e],e,c))return false;return true;};if(!Array.prototype.some)Array.prototype.some=function(a,b){if(typeof a!='function')throw new TypeError();var c=new Object(this),d=c.length;for(var e=0;e<d;e++)if(e in c)if(a.call(b,c[e],e,c))return true;return false;};if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a,b){var c=this.length;b|=0;if(b<0)b+=c;for(;b<c;b++)if(b in this&&this[b]===a)return b;return -1;};
if(!Date.now)Date.now=function(){return new Date().getTime();};
window.__DEV__=window.__DEV__||0; 
```

我的代码：

```
<script>
    window.fbAsyncInit = function () {
        FB.init({
            appId: 'xxxx',
            status: true,
            cookie: true,
            xfbml: true
        });
    };

    // Load the SDK Asynchronously
    (function (d) {
        var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
        if (d.getElementById(id)) { return; }
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        ref.parentNode.insertBefore(js, ref);
    }(document));
</script> 
```

我的代码没有做任何特别的事情。它是从 Facebook 的文档中复制而来的。

任何想法发生了什么以及我如何解决这个问题？

# c# - 哪些值不能用 double 正确表示

> ID：12165216
> 
> 赞同：6
> 
> 时间：2012-08-28T18:21:40.597
> 
> 标签：c#, .net, floating-point, double, decimal

Double 数据类型无法正确表示某些以 10 为底的值。这是因为浮点数如何表示实数。这意味着在表示货币值时，应该使用十进制值类型来防止错误。（请随时纠正本序言中的错误）

我想知道的是，在标准 .Net 框架中的 64 位架构下的 Double 数据类型下出现此类问题的值是什么（如果有区别的话，C# 是什么）？

我希望答案是找到这些值的公式或规则，但我也想要一些示例值。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T18:37:50.440

任何不能写成 2 的正负幂之和的数字都不能精确地表示为二进制浮点数。

浮点数的 32 位和 64 位表示的通用[IEEE 格式施加了进一步的限制；](http://en.wikipedia.org/wiki/IEEE_floating_point)它们限制有效数和指数中的二进制位数。因此，存在最大和最小可表示数字（大约 +/- 10^308（以 10 为基数），如果有记忆的话）并且限制了可以表示的数字的精度。这种精度限制意味着，对于 64 位数字，2 的最大幂和数字中最小幂的指数之间的差值限制为 52，因此如果您的数字包含 2^52 中的项，它可以' 不包括 2^-1 中的术语。

无法用二进制浮点数精确表示的数字的简单示例包括`1/3`、`2/3`、`1/5`.

由于浮点数集（以任何表示形式）是有限的，而实数集是无限的，因此找到不能精确表示为浮点数的实数的一种算法是在以下位置选择实数随机的。实数完全可以表示为浮点数的概率是`0`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T18:29:36.550

您通常需要准备好存储在 a 中的任何值`double`都有少量错误的可能性。除非您存储一个常量值，否则它可能至少有一些错误。如果必须永远不会出现任何错误，并且值不是恒定的，那么您可能不应该使用浮点类型。

在许多情况下，您可能应该问的是，“我如何处理轻微的浮点错误？” 你会想知道哪些类型的操作会导致很多错误，哪些类型不会。您需要确保比较“相等”的两个值实际上只是确保它们“足够接近”而不是完全相等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T18:26:47.557

这个问题实际上超出了任何单一的编程语言或平台。这种不准确性实际上是二进制数据所固有的。

考虑使用双精度数，小数点左侧（从 0 开始的索引 I）的每个数字 N 表示值 N * 2^I，小数点右侧的每个数字表示值 N * 2^( -一世）。

例如，5.625（以 10 为底）将是 101.101（以 2 为底）。

鉴于此计算，对于 I 的不同值，无法计算为 2^(-I) 之和的十进制值将具有不正确的值作为双精度值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T18:42:19.270

浮点数表示为`s`，`e`并且`m`在以下公式中

```
s * m * 2^e 
```

这意味着无法使用给定表达式（以及在 和 的相应域中）表示的任何数字都无法准确`s`表示。`e``m`

基本上，您可以表示介于2 的某个幂（可能是负幂）之间`0`并乘以它们的所有数字。`2^53 - 1`

例如，`0`和之间的所有数字`2^53 - 1`都可以乘以 来表示`2^0 = 1`。您还可以通过将它们除以`2`（`.5`带分数）来表示所有这些数字。等等。

该答案并未完全涵盖该主题，但我希望它有所帮助。

# c# - 在 webdriver C# 中将 Ctrl-0 发送到 IE 9

> ID：12165227
> 
> 赞同：3
> 
> 时间：2012-08-28T18:22:17.210
> 
> 标签：c#, internet-explorer, selenium, webdriver

我试图发送 Ctrl + 0 将 IE 9 设置为 100%。

我尝试了以下代码片段：

```
IWebElement query = Driver.FindElement(By.TagName("html"));

query.SendKeys("^0");
query.SendKeys(Keys.Control + Keys.NumberPad0); 
```

我还尝试了操作对象代码：

```
 Actions action = new Actions(Driver);
 action.KeyDown(Keys.Control).SendKeys("0").KeyUp(Keys.Control).Perform(); 
```

我在 Java 中读过，WebDriver 支持 Keys.chord() 但我在 C# 中找不到它的实现。

任何想法都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T22:50:00.453

标签永远不会对`<html>`驱动程序“可见”，因此无法将密钥发送给它。以下代码适用于我：

```
IWebElement element = driver.FindElement(By.TagName("body"));
element.SendKeys(Keys.Control + "0"); 
```

但是，使用最新版本的 IEDriverServer.exe，除非您为驱动程序设置一个特殊选项以禁用对缩放设置的检测，否则您将无法做到这一点。如果您的缩放级别未设置为 100%，则`InternetExplorerDriver`构造函数将抛出异常，除非您使用以下内容实例化驱动程序：

```
InternetExplorerOptions options = new InternetExplorerOptions();
options.IgnoreZoomLevel = true;
IWebDriver driver = new InternetExplorerDriver(options); 
```

# ruby-on-rails - 使用 rail_some_route_path(nil) 渲染 404

> ID：12165232
> 
> 赞同：0
> 
> 时间：2012-08-28T18:22:32.377
> 
> 标签：ruby-on-rails, routes

假设我们有一条路线：

```
get "foo/:foo_param" =>"blahblah" , :as=>"rails_some_route" 
```

在我看来，我写道：

```
"rails_some_route_path('aa')" this give proper url => 'foo/aa' 
```

但如果一个视图（另一个 .slim 文件）意外包含 `"a href=#{rails_some_route_path(nil)}"`. 视图本身呈现为 404 。

只有路由应该被破坏，但奇怪的是页面本身呈现 404

`consider_all_requests_local`对 dev 来说是错误的

应用控制器

```
unless config.consider_all_requests_local
    rescue_from ActionController::RoutingError, :with => :render_404
    rescue_from ActionController::UnknownController, :with => :render_404
    rescue_from ActionController::UnknownAction, :with => :render_404
    rescue_from Error404, :with => :render_404
    rescue_from GoshPosh::Platform::Errors::AuthError do
      redirect_to login_path({:rd=>request.path})
    end
  end 
```

路线：

```
 unless Rails.application.config.consider_all_requests_local
    match '*not_found', :to => 'web_application#render_404'
  end 
```

# c# - ASP.NET MVC3 - 如何路由/引导用户到 .HTML 文件

> ID：12165233
> 
> 赞同：0
> 
> 时间：2012-08-28T18:22:36.480
> 
> 标签：c#, asp.net-mvc-3

我正在将 Web 表单应用程序移植到 MVC 3。大多数文件是 .HTML 文件。忽略将这些转换为视图的选项，我如何将 [?] 路由到 HTML 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:29:19.033

查看 Global.asax 并添加一个忽略：

```
routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
routes.IgnoreRoute("{resource}.html/{*pathInfo}");  // add this 
```

并注意放置它们的位置。根目录和 /contents 应该没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T18:25:26.540

您只需像引用任何其他内容文件一样引用它们。只需将它们放在命名文件夹之外（区域、模型、存储库、控制器、视图等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:27:43.790

如果您不想修改路由表，请将它们放在 Content 文件夹中并像引用任何内容文件一样引用它们。

```
<a href='@Url.Content("~/Content/path/to/file.html")'>Your html file</a> 
```

# json - 如何使用 CURL 转义部分 JSON POST 请求中的字符？

> ID：12165236
> 
> 赞同：2
> 
> 时间：2012-08-28T18:22:45.140
> 
> 标签：json, shell, post, curl, postmark

因此，我正在尝试使用名为 Postmark 的服务来发送格式化的 HTML 电子邮件。[他们在这里](http://developer.postmarkapp.com/developer-build.html)有一些 API 文档，并给出了如何使用 CURL 的示例：

```
$: curl -X POST "http://api.postmarkapp.com/email" \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-H "X-Postmark-Server-Token: ed742D75-5a45-49b6-a0a1-5b9ec3dc9e5d" \
-v \
-d "{From: 'sender@example.com', To: 'receiver@example.com', Subject: 'Postmark test', HtmlBody: '<html><body><strong>Hello</strong> dear Postmark user.</body></html>'}" 
```

所以，这一切都很好，当我使用自己的令牌时工作得很好。问题是当我添加自己的 HtmlBody 时。如果我发送一条简单的消息，它就可以正常工作。一旦我添加某些特殊字符，它就会中断。例如，如果我做这样的事情：

```
-d "{From: 'sender@example.com', To: 'receiver@example.com', Subject: 'Postmark test', HtmlBody: '<!DOCTYPE html><html><body><strong>Hello</strong> dear Postmark user.</body></html>'}" 
```

它因为`!`. 我怎样才能解决这个问题？

* * *

**更新**：正如*sourcejedi*指出的那样，我正在从 shell（bash）运行它，所以这个`!`问题现在对我来说很有意义。我将 JSON 字符串移动到一个名为 email.json 的单独文件中，并使用`-d @email.json`. 这适用于带有 的简单电子邮件`<!DOCTYPE>`，但是当我尝试加载完整的 HTML 时仍然收到以下错误：

```
{"ErrorCode":402,"Message":"Received invalid JSON input."} 
```

我相信这与其他一些特殊字符有关。当我使用`--data-urlencode @email.json`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:42:36.837

你需要使用`--data-urlencode`，所以它应该像`curl -X POST --data-urlencode`

当我测试结束时..

```
* About to connect() to api.postmarkapp.com port 80 (#0)
*   Trying 50.56.54.211... connected
> POST /email HTTP/1.1
> User-Agent: curl/7.23.1 (x86_64-pc-win32) libcurl/7.23.1 OpenSSL/0.9.8r zlib/1
.2.5
> Host: api.postmarkapp.com
> Accept: application/json
> Content-Type: application/json
> X-Postmark-Server-Token: ed742D75-5a45-49b6-a0a1-5b9ec3dc9e5d
> Content-Length: 164 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-18T01:34:33.880

发布 JSON 数据时，我曾经收到过同样的错误。我所做的是用单引号将数据括起来，并对字符串使用双引号：

所以从：

```
-d "{From: 'sender@example.com', To: 'receiver@example.com', Subject: 'Postmark test', HtmlBody: '<html><body><strong>Hello</strong> dear Postmark user.</body></html>'}" 
```

利用：

```
-d '{From: "sender@example.com", To: "receiver@example.com", Subject: "Postmark test", HtmlBody: "<html><body><strong>Hello</strong> dear Postmark user.</body></html>"}' 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T19:08:54.020

> 似乎仍然让我感到震惊，只是返回：-bash：！DOCTYPE：未找到事件

这是 bash shell 的错误。你需要逃脱！作为 \！你自己。但我认为，你最好从文件中读取。而不是`-d data`使用`-d @datafile`. （或`-d @-`从标准输入读取）。

# php - 检查字符串是否为日期

> ID：12165237
> 
> 赞同：3
> 
> 时间：2012-08-28T18:22:47.960
> 
> 标签：php

我有一些动态日期值，我试图将它们更改为人类可读的格式。我得到的大多数字符串都是格式`yyyymmdd`的，例如 20120514，但有些不是。我需要跳过那些不是那种格式的，因为它们可能根本不是日期。

如何将此类检查添加到我的代码中？

```
date("F j, Y", strtotime($str)) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T18:26:51.457

您可以将此功能用于以下目的：

```
/**
 * Check to make sure if a string is a valid date.
 * @param $str   String under test
 *
 * @return bool  Whether $str is a valid date or not.
 */
function is_date($str) {
    $stamp = strtotime($str);
    if (!is_numeric($stamp)) {
        return FALSE;
    }
    $month = date('m', $stamp);
    $day   = date('d', $stamp);
    $year  = date('Y', $stamp);
    return checkdate($month, $day, $year);
} 
```

[@资源](http://www.tim-carter.com/index.php?t=Check+if+string+is+a+date+with+PHP&Menu=2&SubMenuId=5&ItemId=72)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T18:25:27.377

为了快速检查，`ctype_digit`应该`strlen`这样做：

```
if(!ctype_digit($str) or strlen($str) !== 8) {
    # It's not a date in that format.
} 
```

你可以更彻底[`checkdate`](http://php.net/checkdate)：

```
function is_date($str) {
    if(!ctype_digit($str) or strlen($str) !== 8)
        return false;

    return checkdate(substr($str, 4, 2),
                     substr($str, 6, 2),
                     substr($str, 0, 4));
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-28T18:25:25.093

我会使用正则表达式来检查字符串是否有 8 位数字。

```
if(preg_match('/^\d{8}$/', $date)) {
    // This checks if the string has 8 digits, but not if it's a real date
} 
```

# centos - 抛出 'HPHP::RescheduleException' 的实例 - 在 CentOS 5 上编译失败

> ID：12165252
> 
> 赞同：0
> 
> 时间：2012-08-28T18:24:35.720
> 
> 标签：centos, hiphop

CentOS 5.8 --- Kenrel 2.6.18-308.11.1.el5 x86_64

这是 64 位 CentOS 5 的奇怪错误，我运气不好...

```
[ 89%] Built target ext_hhvm_static
Scanning dependencies of target hphp
[ 89%] Building CXX object src/hphp/CMakeFiles/hphp.dir/main.cpp.o
In file included from /opt/hiphop/hiphop-php/src/hphp/main.cpp:44:
/opt/hiphop/hiphop-php/src/runtime/base/compiler_id.h:16:1: warning: "COMPILER_ID"   redefined
<command-line>: warning: this is the location of the previous definition

[ 89%] Building CXX object src/hphp/CMakeFiles/hphp.dir/externals.cpp.o
Linking CXX executable hphp
Building hhvm
terminate called after throwing an instance of 'HPHP::RescheduleException'
terminate called recursively
Core dumped: Aborted
hphp failed
make[2]: *** [src/hphp/hphp] Error 255
make[1]: *** [src/hphp/CMakeFiles/hphp.dir/all] Error 2
make: *** [all] Error 2 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T23:38:06.287

现在 HHVM 是默认运行时，执行 a 并重`git pull`试。

# c# - 带有标签的 Caliburn.Micro 按惯例不具有约束力

> ID：12165253
> 
> 赞同：2
> 
> 时间：2012-08-28T18:24:35.920
> 
> 标签：c#, .net, silverlight, mvvm, caliburn.micro

我一直在 Silverlight 5 中通过约定使用 Caliburn.Micro 的绑定，我很喜欢它。这是来自 ViewModel 的示例属性：

```
private String _vmStringProp = "";
public String VmStringProp
{
    get
    {
        return _vmStringProp;
    }

    set
    {
        _vmStringProp = value;
        NotifyOfPropertyChange(() => VmStringProp);
    }
} 
```

该属性仅通过命名绑定在视图中：

```
<TextBox x:Name="VmStringProp" /> 
```

这很好用。但是，如果我将其更改为 TextBlock 或 Lable（下面的示例），则会引发异常。

```
<sdk:Label x:Name="VmStringProp" /> 
```

如果您将其更改为像普通 Silverlight 一样绑定，它可以正常工作，但我宁愿在整个项目中保持一致，而不是通过约定进行一些绑定，而另一些则根据控件类型显式绑定。有谁知道为什么我不能通过约定与标签和文本块绑定？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T19:06:09.513

Caliburn.Micro 为 WPF/SL/WP7 提供了一组默认约定，但显然不是针对每个现有控件，因此`sdk:Label`也缺少 Silverlight。

[您可以在本文末尾](http://devlicio.us/blogs/rob_eisenberg/archive/2010/12/16/caliburn-micro-soup-to-nuts-part-7-all-about-conventions.aspx)找到内置约定以及约定如何工作的大量信息。

幸运的是，添加一个新的 convection 非常容易，只需将以下代码添加到 Bootstrapper 的构造函数中：

```
public MyBootstrapper()
{
    ConventionManager
        .AddElementConvention<Label>(Label.ContentProperty, 
                                    "Content", 
                                    "DataContextChanged");  
} 
```

# php - Doctrine2 insert 静默失败，仅在某些记录上

> ID：12165254
> 
> 赞同：1
> 
> 时间：2012-08-28T18:24:36.403
> 
> 标签：php, mysql, symfony, doctrine-orm

我有以下代码，有时会导致静默失败：

```
public function updateCoreGameTableIfNecessary($coreEm)
{   
    $game = $this->getCoreGameRecord($coreEm);

    if (!$game) {

        $game = new Game();
        $game->setHomeSchool($this->getHomeSchool()->getCoreSchool($coreEm));
        $game->setDatetime($this->getDatetime()->format('Y-m-d H:i:s'));
        $game->setDate($this->getDatetime()->getTimestamp());
        $game->setTime($this->getDatetime()->format('H:i:s'));
        $game->setSport($coreEm->getRepository('VNNCoreBundle:Sport')->findOneByName($this->getSport()->getName()));
        $game->setSeason($coreEm->getRepository('VNNCoreBundle:Season')->findCurrent());
        $game->setEventType(strtolower($this->getEventType()->getName()));
        $game->setMeetName($this->getMeetName());
        $game->setRemoteUnique(md5(rand(0, 100000)));
        $game->setNotes($this->getRecap());
        $game->setHomeConfId(0); // This field is no longer used, so value doesn't matter.
        $game->setAwayConfId(0); // This field is no longer used, so value doesn't matter.
        $game->setConfStatus(''); // This field is going away as well.
    }   

    if ($this->getEventType()->getName() == 'Game') {
        $game->setHomeScore($this->getHomeScore());
        $game->setAwayScore($this->getAwayScore());
        $game->setAwaySchool($this->getAwaySchool()->getCoreSchool($coreEm));
    } else {
        $game->setPlace($this->getPlace());
        $game->setPoints($this->getHomeScore());
    }   

    $game->setOwnerId($this->getUser()->getSchool()->getCoreSchool($coreEm)->getId());
    $coreEm->persist($game);
    $coreEm->flush();

    return $game->getId();
} 
```

它总是从一个`$this`已经保存的开始。对于某些实例`$this`（即数据库中的某些记录），`$game`不会被保存。我不会得到错误或类似的东西。它只会默默地失败。

有什么调试建议吗？我想我会尝试找出这些特定记录的不同之处，但无论出于何种原因，插入似乎都不应该默默地失败。

# java - 在一个数字序列中统一 10^x 次方

> ID：12165267
> 
> 赞同：2
> 
> 时间：2012-08-28T18:25:46.527
> 
> 标签：java, scientific-notation

我有一个这样的数字序列：

```
1.687155E21
3.981457E19
0.5532155E21 
3.018843E21
2.0532155E21 
4.5532155E21
3.1637913E19 
```

我的问题是如何将两个以 10^19 结尾的数字转换为与其他数字一样（10^21）。因为在这种统一之后，我需要截断数字以仅打印 3.5 之类的东西。

在 C/C++ 中我知道如何精确地工作，但在 Java 中我不知道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:32:47.770

将所有数字除以`/ 1e19`，四舍五入到所需的小数位数：

```
168.7155
3.981457
55.32155
301.8843
205.32155
455.32155
3.1637913 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T18:34:27.830

使用 Formatter 类将它们转换为所需的科学记数法（[java.util.Formatter](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Formatter.html)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T19:25:12.780

我建议使用与 Tomasz Nurkiewicz 类似的方法，但不是除以除以，而是`1E19`使用`1E21`Formatter 将它们转换为具有所需精度的字符串（参见 count0 的注释），但不是科学格式，而是通用格式。最后只需将 E21 添加到这些字符串中。最后你应该得到（我希望，我的想法是正确的）

```
1.687155E21
0.03981457E21
0.5532155E21 
3.018843E21
2.0532155E21 
4.5532155E21
0.031637913E21 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T18:34:13.397

你不能把`E19`数字乘以`10 ^ 2 = 100`吗？

将它们归一化后`E21`，您应该能够将它们全部除以`10^21`（如果它们是浮点数），它们都将在 0-9.999 的范围内...

# ios - IOS多值设置动态值

> ID：12165269
> 
> 赞同：0
> 
> 时间：2012-08-28T18:25:53.727
> 
> 标签：ios, settings

我正在尝试使 .plist 多值中的值动态化。具体来说，我想从网站下载选项列表并使用返回的数据填充值。我已经阅读了几篇文章，指出在运行时更改应用程序包是不可能的。是否不可能使值引用应用程序包之外的数据源，例如，如果我将替代项放在 NSUserDefaults 中并从那里读取？

如果这完全不可能，还有什么替代方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:30:56.223

我所做的是将 plist 复制到文档目录中的隐藏文件夹中并使用该副本

如果文件不存在，则将其完全复制，如果存在，则进行一些合并或完全覆盖，无论您需要什么

使用 NSUserDefaults 也是一种可能

# javascript - Backbone.js - 映射标准 url 参数 - 使用多个参数

> ID：12165276
> 
> 赞同：2
> 
> 时间：2012-08-28T18:26:53.593
> 
> 标签：javascript, url, backbone.js, parameters, backbone-routing

我对backbone.js 很陌生，并试图将普通的javascript/jquery 应用程序转换为主干MVC。有了它，我来到了 Backbone.Router，我目前正在尝试用主干解决我的旧 URL 处理，但是我想和你讨论一些问题：

我的传统 URL 模式如下所示：

```
/#/lang=1&page=panorama&cats=13,3,4,6,7,8,9,10,11&pid=4 
```

这与骨干看起来如何以及如何对其进行编码？

问题是，我的传统处理方式允许我在不关心参数顺序的情况下评估我的 URL 字符串。有了骨干，这似乎是不可能的。对于我的应用程序，它需要在 url 中传递类别（参见cats=..）等，以链接到特定的应用程序位置/状态。

我已经用 pid (panorama-id) 试过了，所以模式是这样的：

```
/panorama/:id 
```

“全景”目前没有参数，而是代表应用程序中的某个页面。

如果有人为我找到解决方案，我将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:59:01.763

最佳解决方案：[https ://github.com/jhudson8/backbone-query-parameters](https://github.com/jhudson8/backbone-query-parameters)

# java - 为什么Java本身没有实现Object和Thread类的一些方法？

> ID：12165278
> 
> 赞同：2
> 
> 时间：2012-08-28T18:27:09.490
> 
> 标签：java, performance, native

为什么这些方法

```
 java.lang.Thread.currentThread(),
 java.lang.Thread.sleep(),

 java.lang.Object.notify(),

 java.lang.Object.wait()

 of Thread & Object class are not implemented in java API's itself? 
```

为什么需要制作原生方法，它们是 C/C++ 编程语言的一部分？

这背后是否有任何区域，或者java无法提供良好的性能？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-28T18:30:29.237

您将如何用 Java 编写导致当前线程休眠的代码？在某些时候，您需要委托本机代码，因为它是提供和控制线程的操作系统，而不是 Java。

它可能会帮助您理解在某个级别上，JVM 本身是用本机代码编写的，因此它可以以特定于操作系统和机器的方式与运行在其上的每个操作系统进行对话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:32:45.510

Java API本身没有实现是什么意思......

它是 Java API 的重要组成部分......我想你不明白 API 是什么意思......

现在的情况下`Threads`，它取决于运行 Java 程序的操作系统......**线程由不同的操作系统以不同的方式处理**......例如`sleep()`在 Window 和 Linux 中具有不同的时间实现......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T19:48:40.387

添加到语言比添加到库要困难得多。您可以轻松地将方法添加到类中，但添加关键字要困难得多。出于这个原因，Java 试图只将绝对最小值添加到语言中，并且可以在库中完成的任何事情都是以这种方式完成的。

使用库而不是添加到语言中的另一个原因是，在 Java 1.0 中使用 sleep()、wait() 或 notify() 似乎是个好主意，通过添加并发库在 Java 5.0 中得到了改进/替换，所以你这些天不会使用这些方法，并且用您不再使用的语言制作元素将是一种浪费。

# scala - 是否可以推迟宏扩展，直到抽象类型绑定到特定类型

> ID：12165283
> 
> 赞同：5
> 
> 时间：2012-08-28T18:27:37.730
> 
> 标签：scala, reflection, macros

我可能使用了不正确的术语，但这里是我想要实现的示例。可以说我有以下宏：

```
def generateField[T]: AnyRef =
  macro generateFieldImpl[T]

def generateFieldImpl[T: c.AbsTypeTag](c: Context): c.Expr[AnyRef] = {
/**
 * here I'm looking at the type T by reflection to see now many members it has
 * and based on that I'm generating TupleN[Array[Byte], ...](null, ...)
 * where N is number of members in class represented by type T
 */
} 
```

我打算只使用案例类作为 T。

当我将此宏与案例类一起使用时，它效果很好，但现在我想添加一个抽象级别：

```
trait WithGeneratedField[T] {
  val _myField = generateField[T]
} 
```

我遇到的问题是宏在声明特征时被扩展，此时 T 被称为抽象类型“T”。有什么方法可以推迟宏扩展，直到我将这个特性与具体的东西混合在一起？例如：

```
case class MyClass(a: String, b: Int) extends WithGeneratedField[MyClass] 
```

最后，我的目标是使用宏将生成的字段添加到案例类中。也许有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T15:03:24.197

如果这在 2.10.0 中成为可能，我会感到惊讶。

使用宏类型或宏注释（[http://scalamacros.org/future.html](http://scalamacros.org/future.html)）应该非常简单。我们将在发布 2.10.0-final 后立即着手开发这些新的宏，但很难预测 ETA。也许是 2012 年的冬天 - 2013 年的春天。

# zend-framework - 在 Zend 框架中使用 PrinceXML 的 PDF 覆盖

> ID：12165286
> 
> 赞同：0
> 
> 时间：2012-08-28T18:27:43.347
> 
> 标签：zend-framework, pdf-generation, zend-pdf, princexml

我想将 PrinceXML 的输出覆盖到文件系统中 PDF 的页面上。我将在我们的 Zend 框架环境中构建解决方案，如果可能的话，我认为我希望解决方案使用 Zend_Pdf。

有什么建议么？我想我可以使用 fpdf & fpdi 之类的东西，并通过它以某种方式引导 PrinceXML 输出；但是有没有人使用 Zend_Pdf 对 PrinceXML 的输出和静态 PDF“模板”文件进行叠加？

# c - C99：是否可以便携地确定两个指针是否指向同一个聚合？

> ID：12165288
> 
> 赞同：5
> 
> 时间：2012-08-28T18:27:49.257
> 
> 标签：c, pointers, c99, undefined-behavior

在 c99 中，我的理解是比较两个不指向同一聚合内的指针会导致未定义的行为。给定一个聚合 A、一个已知指向 A 内的指针 p_good 和一个可能指向也可能不指向 A 内的指针 p_unknown，是否有可能构造一个具有已定义行为的可移植测试，以确定比较 p_good 和p_未知？

显然，这个测试本身不能违反比较指针的限制。

我怀疑答案是否定的，但我很乐意以其他方式显示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T18:48:00.243

你评论说：

> 构建问题的另一种方法是：给定聚合“A”和指针 p 的定义，是否有可能在不违反指向不同指针的不等式测试规则的情况下回答“p 是否在 A 内”这个问题？聚集体

我能有意义地解释这一点的唯一方法是你要么有一个类型的对象，要么有`Aggregate type`一个指向一个对象的指针。那么答案很简单：

伪代码：

```
bool p_in_A = false;
for (each element in Aggregate A)
    if (&element == p)
        p_in_A = true; 
```

无法判断流浪指针是否属于未知聚合对象（或指向聚合中的“中间”元素）。

# windows-phone-7 - 在 windows phone 中使用 TabControl

> ID：12165291
> 
> 赞同：1
> 
> 时间：2012-08-28T18:28:05.557
> 
> 标签：windows-phone-7

我阅读了有关在 Windows Phone 应用程序上使用 TabControl 的文章。我可以避免它在第一次加载时着火。但是，当用户单击选项卡时， selectionChanged 会触发两次。有人可以帮助我如何解决它。提前致谢。

有我的 TabControl：

```
<cc:TabControl Grid.Row="1" SelectionChanged="tabList_SelectionChanged" x:Name="tabList">
        <cc:TabItem Height="80" Header="Events" Foreground="Black"/>
        <cc:TabItem Height="80" Header="Details" Foreground="Black"/>
        <cc:TabItem Height="80" Header="Notes" Foreground="Black" />
    </cc:TabControl> 
```

后面有cobe：

```
 public partial class Tab : PhoneApplicationPage
{
    private bool blnFristLoad=true;  
    public Tab()
    {
        InitializeComponent();
        tabList.SelectionChanged += new SelectionChangedEventHandler(tabList_SelectionChanged);
    }

private void tabList_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {

        if (blnFristLoad == false)
        {
            TabItem t = (sender as TabControl).SelectedItem as TabItem;
            t.Content = "202020";
                       }
        else blnFristLoad = false;                

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:37:16.220

这在您的代码中非常明显。您正在添加 SelectionChanged 事件处理程序两次。一个来自您的 XAML 代码，另一个来自后面的代码。当您使用 += 符号时，事件处理程序将作为单独的实例添加。

删除其中一个语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:27:10.897

请使用 Pivot 控件而不是 WindowsPhone 的 TabControl。Pivot 控件遵循手机的设计指南，外观和感觉都更好。

# netbeans - “安装程序找不到兼容的 JDK 安装，请手动指定。最低要求版本为 1.6.0”

> ID：12165296
> 
> 赞同：0
> 
> 时间：2012-08-28T18:28:27.187
> 
> 标签：netbeans, netbeans-7, netbeans-platform

我正在尝试下载 NetBeans IDE 7.2。安装时，安装程​​序显示以下消息“未找到兼容的 JDK”，然后当我单击“下一步”时，它要求我选择具有兼容 JDK 的目录。通过显示以下消息：

```
"The installer could not find a compatible JDK installation, specify it manually. The minimum required version is 1.6.0" 
```

我确定我指定的目录包含 JDK 1.8.0。但是，消息仍然存在，我无法继续。

有人可以帮忙吗？我正在使用 Windows 32 位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:30:53.283

你可以在这里得到它： [http ://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1637583.html](http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1637583.html)

使用 Windows x86 版本。文件名：jdk-7u6-windows-i586.exe

您需要完成安装，SDK将安装在：

`C:\Program Files\Java\jdk1.7.0_06`

之后启动 NetBeans 7.2 安装时，它会自动找到 JDK 位置。

# objective-c - 为什么唯一可用的 AVAssetExportSession.outputFileType = AVFileTypeQuickTimeMovie

> ID：12165297
> 
> 赞同：4
> 
> 时间：2012-08-28T18:28:35.117
> 
> 标签：objective-c, ios, avfoundation, avassetexportsession

我已经设置了一个`AVAssetExportSession`只有 2 个音频轨道，没有视频，它的播放就像我想要的那样`AVPlayer`- 但是当我去导出它时，唯一可用`outputFileType`的是`AVFileTypeQuickTimeMovie`- 为什么我不能选择音频格式？

当我`NSLog(@"%@", [session supportedFileTypes]);`得到；

```
[51330:c07] (
    "com.apple.quicktime-movie"
) 
```

这是我的代码；

```
- (AVMutableComposition *)getComposition {
    AVAsset *backingAsset = [AVAsset assetWithURL:self.urlForEightBarAudioFile];
    AVAsset *vocalsAsset = [AVAsset assetWithURL:self.recorder.url];
    AVMutableComposition *composition = [AVMutableComposition composition];
    AVMutableCompositionTrack *compositionBackingTrack = [composition addMutableTrackWithMediaType:AVMediaTypeAudio preferredTrackID:kCMPersistentTrackID_Invalid];
    AVMutableCompositionTrack *compositionVocalTrack = [composition addMutableTrackWithMediaType:AVMediaTypeAudio preferredTrackID:kCMPersistentTrackID_Invalid];

    AVAssetTrack *backingAssetTrack = [backingAsset.tracks objectAtIndex:0];
    AVAssetTrack *vocalsAssetTrack = [vocalsAsset.tracks objectAtIndex:0];

    CMTimeRange timeRange = CMTimeRangeFromTimeToTime(kCMTimeZero, backingAsset.duration);

    [compositionBackingTrack insertTimeRange:timeRange ofTrack:backingAssetTrack atTime:kCMTimeZero error:nil];
    [compositionVocalTrack insertTimeRange:timeRange ofTrack:vocalsAssetTrack atTime:kCMTimeZero error:nil];

    return composition;
}

- (IBAction)acceptRecording:(id)sender {
    AVAssetExportSession * session = [[AVAssetExportSession alloc] initWithAsset:[self getComposition] presetName:AVAssetExportPresetMediumQuality];
    NSURL *output = [self.urlForPathToEightBarRecordings URLByAppendingPathComponent:@"mix.mov"];
    session.outputURL = output;
    session.outputFileType = AVFileTypeQuickTimeMovie;

    NSLog(@"%@", [session supportedFileTypes]);
    [session exportAsynchronouslyWithCompletionHandler:^() {
        switch (session.status) {
            case AVAssetExportSessionStatusCompleted:
                NSLog(@"It's done...hallelujah");
                break;

            default:
                break;
        }
    }];
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T12:17:09.157

啊，对了，它只给我快速电影选项的原因是因为我的预设设置为`AVAssetExportPresetMediumQuality`我猜这是一个视频唯一预设。我将预设设置为`AVAssetExportPresetAppleM4A`，输出文件类型为`AVFileTypeAppleM4A`，导出成功！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-19T14:32:42.273

您可以将这些设置用于 128kbps

预设时间：AVAssetExportPresetMediumQuality

输出文件类型 AVFileTypeMPEG

格式：mp4

# mobile - 移动facebook关于需要fb登录的页面链接

> ID：12165301
> 
> 赞同：1
> 
> 时间：2012-08-28T18:29:13.633
> 
> 标签：mobile, facebook-page

我正在尝试获取指向我的应用程序的链接，以便在类似于此的移动设备上工作：

[http://m.facebook.com/angrybirds?id=314467614927](http://m.facebook.com/angrybirds?id=314467614927)

但是，我的应用中心的移动网络链接需要 Facebook 登录，而愤怒的小鸟链接则不需要。任何想法如何复制功能？

我的链接： http: [//m.facebook.com/appcenter/ansibletestapp](http://m.facebook.com/appcenter/ansibletestapp)

编辑：还向 facebook 提交了错误报告：http: [//developers.facebook.com/bugs/343512979067831](http://developers.facebook.com/bugs/343512979067831)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:18:15.623

[http://m.facebook.com/angrybirds?id=314467614927](http://m.facebook.com/angrybirds?id=314467614927)是愤怒的小鸟页面的链接。（网络版在这里： http: [//www.facebook.com/angrybirds](http://www.facebook.com/angrybirds)）

在 facebook 上使用应用程序总是需要身份验证，这是一个有效的会话，因此用户必须登录到 facebook 才能查看应用程序。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-13T16:19:53.913

它可能与您的应用程序的**“设置”->“权限”**页面`permissions`上列出的列表有关。（请参阅[App Center 指南的授权部分](https://developers.facebook.com/docs/guides/appcenter/#authorization)）。

 **> **配置权限**
> 使用这些设置输入您的应用在[应用中心](https://developers.facebook.com/docs/guides/appcenter/#authorization)显示或使用[身份验证引用时所需的权限集](https://developers.facebook.com/docs/opengraph/authentication/#referrals) [了解有关配置权限的更多信息](https://developers.facebook.com/docs/opengraph/authentication/#referrals)

在应用程序设置的该部分中列出一些`permissions`将导致在应用程序从 Facebook 上的任何链接访问之前出现 Auth Dialog。**

# ruby - 使用 imagemagick 更改图像的颜色

> ID：12165304
> 
> 赞同：17
> 
> 时间：2012-08-28T18:29:16.457
> 
> 标签：ruby, twitter-bootstrap, imagemagick, image-manipulation, rmagick

我想使用 rmagick/imagemagick 更改图像的前景色。更具体地说：我想将[黑色](https://github.com/twitter/bootstrap/blob/master/img/glyphicons-halflings.png)或[白色](https://github.com/twitter/bootstrap/blob/master/img/glyphicons-halflings-white.png) [glyphicons-halflings](https://github.com/twitter/bootstrap/blob/master/img/glyphicons-halflings.png)图标（包含在 twitter bootstrap 中）转换为深蓝色 glyphicons-halflings 图标。（如果我能指定一个 hexcolor 或 RGB 颜色就好了。）

我不知道这是否可能，但我点击了 imagemagick 文档，我唯一发现的是`convert --size 100x100 xc:skyblue glyphicons-halflings.png -composite foo.png`，问题是这仅在您指定大小并且它正在更改前景色而不是背景色时才有效。此外，它是天蓝色而不是深蓝色。

那么有谁知道如何将白色或黑色字形半身人转换为蓝色字形半身人图标？（rmagick/ruby 代码片段的奖励积分）

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-01-14T14:28:34.703

**快速回答**：

```
convert glyphicons-halflings.png -alpha extract -background blue \
-alpha shape blue-glyphicons-halflings.png 
```

![blue-glyphicons-halflings.png](../Images/09f5c6d8502bb98e51e6f1236da28a9d.png)

注意：代替`blue`，您可以使用任何命名的颜色，或 RGB，或 RGBA 等（参见[http://www.imagemagick.org/script/command-line-options.php#fill](http://www.imagemagick.org/script/command-line-options.php#fill)）。

**说明**：

我们分两步为图标“着色”：

*   从图标中提取 alpha 通道；（注意：原始图标的颜色无关紧要，我们正在提取它的 alpha 通道）
*   将上述遮罩应用在您选择的彩色背景上；

有关更多信息，请阅读以下文档：

*   [http://www.imagemagick.org/Usage/masking/#alpha_extract](http://www.imagemagick.org/Usage/masking/#alpha_extract)
*   [http://www.imagemagick.org/Usage/masking/#shapes](http://www.imagemagick.org/Usage/masking/#shapes)

PS：上述解决方案在实现jQuery ThemeRoller rewrite时研究过[https://github.com/jquery/download.jqueryui.com/issues/77](https://github.com/jquery/download.jqueryui.com/issues/77)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-17T21:51:19.477

从[http://www.imagemagick.org/Usage/color_basics/#replace](http://www.imagemagick.org/Usage/color_basics/#replace) ，您可以使用以下命令替换图像中所有不`darkblue`带的颜色：`darkblue`

`convert glyphicons-halflings.png -fill darkblue +opaque darkblue glyphicons-halflings.png`

如果您想在 ruby​​ 中执行此操作，我建议使用 Minimagick gem [https://github.com/minimagic/minimagick](https://github.com/minimagic/minimagick)，它只需`convert`在命令行上调用。根据我的经验，并非所有功能都已从命令行移植到 RMagick

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-13T15:40:55.300

除了 sguha 的答案 - 这是 Ruby 版本（尽管是 QuickMagick）：

```
require 'quick_magick'
source = "images/source.png"
dest = "images/saved.png"
foreground = "0000ff" #hex code for your colour

QuickMagick.exec3("convert #{source} -fill \"##{foreground}\" +opaque \"##{foreground}\" #{dest}") 
```

# jquery - jquery，验证器无效类在提交时应用于非空字段

> ID：12165306
> 
> 赞同：1
> 
> 时间：2012-08-28T18:29:17.733
> 
> 标签：jquery, jquery-validate

我有一个表单，我正在使用 jquery 并进行验证。我在验证中使用 errorPlacement 在缺少的必填字段周围设置边框。除了预先填写字段外，它似乎可以按我的意愿工作。提交表单时，验证标记预填充的文本字段无效。如果我给予焦点然后离开该字段，则预填充字段将全部删除边框。[请参阅http://jsfiddle.net/paries/u3Td3/8/](http://jsfiddle.net/paries/u3Td3/8/)上的示例

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:53:31.230

您可以在放置前检查错误文本。

```
 errorPlacement: function(error, element) {
        if(error.text().length>0){
            $(element).filter(':not(.valid)').addClass("invalid");
        }
    }, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:49:22.663

只需将您的 CSS 更改为 hang off of `.error`，这是 jQuery validate 默认使用的类来指示无效字段。

您的问题是由于顺序而发生的：您的`:not('.valid')`检查在添加有效类*之前运行。*如果您在示例中单击“继续”后检查预填充的输入，您会发现它们同时具有`invalid`和`valid`作为类。

[http://jsfiddle.net/u3Td3/12/](http://jsfiddle.net/u3Td3/12/)

# jquery - JQuery 验证 + 中继器 + 面板 - 验证问题

> ID：12165307
> 
> 赞同：1
> 
> 时间：2012-08-28T18:29:28.437
> 
> 标签：jquery, validation, repeater, panel

我有一个转发器控件，在转发器控件内部我有两个链接按钮（显示/隐藏将显示和隐藏面板），还有一个包含文本框的面板（它需要名字和姓氏，这是必填字段）。当我单击页面上的下一步按钮时，不会为隐藏（面板）中的字段触发验证。感谢任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T01:59:56.657

听起来您在回发期间隐藏了服务器上的面板。

```
panel1.Visible = false; 
```

如果您在服务器上隐藏面板，则文本框的标记永远不会被呈现，因此 JQuery 验证代码将看不到文本框。

考虑使用 Jquery 隐藏/显示面板：

`$("#panel1clientId").show();`或者

```
$("#panel1clientId").hide(); 
```

这样，面板标记被呈现但对用户隐藏。

# performance - 为什么 Cassandra 二级索引仅在 350k 行上如此缓慢？

> ID：12165311
> 
> 赞同：4
> 
> 时间：2012-08-28T18:29:53.773
> 
> 标签：performance, cassandra, indexing, pycassa

我有一个带有二级索引的列族。二级索引基本上是一个二进制字段，但我使用的是字符串。名为**is_exported**的字段可以是**'true'**或**'false'**。请求后，所有加载的行都用**is_exported = 'false'**更新。

我每十分钟轮询一次该列表，并在新行出现时导出它们。

但这里的问题是：我看到这个查询的时间与列表中的数据量呈线性增长，目前需要**12 到 20 秒（！！！）才能找到 5000 行**。据我了解，索引请求不应取决于 CF 中的行数，而是取决于每个索引值（基数）的行数，因为它只是另一个隐藏的 CF，例如：

```
 "true" : rowKey1 rowKey2 rowKey3 ...
    "false": rowKey1 rowKey2 rowKey3 ... 
```

我正在使用 Pycassa 来查询数据，这里是我正在使用的代码：

```
 column_family = pycassa.ColumnFamily(cassandra_pool, column_family_name, read_consistency_level=2)
    is_exported_expr = create_index_expression('is_exported', 'false')
    clause = create_index_clause([is_exported_expr], count = 5000)
    column_family.get_indexed_slices(clause) 
```

我是不是做错了什么，但我希望这个操作能更快地工作。

有什么想法或建议吗？

一些配置信息：

*   卡桑德拉 1.1.0
*   随机分区器
*   我有 2 个节点，replication_factor = 2（每台服务器都有一个完整的数据副本）
*   使用 AWS EC2，大型实例
*   临时驱动器上的软件 raid0

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:02:24.997

我不知道 Cassandra 中索引的内部结构，但我假设它的行为方式与 PostgreSQL / MySQL 类似，索引布尔值，真/假列在许多情况下是多余的。如果基数很低（true & false = 2 个唯一值）并且数据分布相当均匀，例如 ~50% true 和 ~50% false，那么数据库引擎可能会执行全表扫描（不使用索引）。

查询执行和数据集大小之间的线性关系将进一步支持 Cassandra 正在执行全表（键空间）扫描。

# r - R - 带周-年的字符串：转换为日期格式时丢失周

> ID：12165313
> 
> 赞同：5
> 
> 时间：2012-08-28T18:30:02.687
> 
> 标签：r, datetime, string-formatting

我有一个年-周格式的日期字符串，如下所示：

```
weeks.strings <- c("2002-26", "2002-27", "2002-28", "2002-29", "2002-30", "2002-31") 
```

但是，将此字符转换为 Date 类会导致丢失周标识符：

```
> as.Date(weeks.strings, format="%Y-%U")
[1] "2002-08-28" "2002-08-28" "2002-08-28" "2002-08-28" "2002-08-28"
[6] "2002-08-28" 
```

如上所示，格式被转换为与今天日期连接的年份，因此有关原始星期的任何信息都将丢失（例如，当使用 format 函数或 strptime 尝试强制转换回原始格式时。

我在帮助组中找到的一种解决方案是指定星期几：

```
as.Date(weeks.strings, format="%Y-%u %U")
[1] "2002-02-12" "2002-02-19" "2002-02-26" "2002-03-05" "2002-01-02"
[6] "2002-01-09" 
```

但看起来这会导致不正确的周编号（与原始字符串不匹配）。

任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-28T19:16:21.487

您只需要在您的工作日中添加一个工作日以`weeks.strings`使日期明确（改编自[Jim Holtman 对 R-help 的回答](http://tolstoy.newcastle.edu.au/R/e15/help/11/07/0416.html)）。

```
as.Date(paste(weeks.strings,1),"%Y-%U %u") 
```

正如评论中所指出的，如果日期跨度很长，则 Date 类是不合适的，因为 - 在某些时候 - 所选工作日将不存在于一年的第一周/最后一周。在这种情况下，您可以使用一个数字向量，其中整个部分是年份，小数部分是周/年的分数。例如：

```
wkstr <- sprintf("%d-%02d", rep(2000:2012,each=53), 0:52)
yrwk <- lapply(strsplit(wkstr, "-"), as.numeric)
yrwk <- sapply(yrwk, function(x) x[1]+x[2]/53) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T18:47:00.167

显然，没有唯一的解决方案，因为每周可以由多达 7 个不同日期中的任何一个来表示。也就是说，这是一个想法：

```
weeks.strings <- c("2002-26", "2002-27", "2002-28", "2002-29",
                   "2002-30", "2002-31")

x <- as.Date("2002-1-1", format="%Y-%m-%d") + (0:52*7)
x[match(weeks.strings, format(x, "%Y-%U"))]
# [1] "2002-07-02" "2002-07-09" "2002-07-16" "2002-07-23"
# [5] "2002-07-30" "2002-08-06" 
```

# jquery - Jquery长语法不起作用

> ID：12165322
> 
> 赞同：-4
> 
> 时间：2012-08-28T18:30:40.100
> 
> 标签：jquery, animation, syntax

我有一个 div，我希望它在单击某些内容时向下或向上滑动。我正在使用这样的函数 slideToggle() ：

```
$('.business').slideToggle(1500, 'easeOutBounce'); 
```

它可以工作，有时在 Firefox 上有点不稳定。但是，当我尝试使用以下语法时它不起作用？

```
$('.business').slideToggle({duration: 1500, easing: 'easeOutBounce'}); 
```

为什么？他们不一样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:34:12.993

不，它们不一样。[`.slideToggle()`不接受对象参数语法。](http://api.jquery.com/slideToggle/)

# javascript - Ember.js - 自动制作动作目标控制器

> ID：12165330
> 
> 赞同：4
> 
> 时间：2012-08-28T18:31:22.823
> 
> 标签：javascript, model-view-controller, ember.js

在 Ember 中，如果我使用路由器，`{{action}}`当视图由路由器创建时，任何帮助程序都会自动定位视图的控制器。

`{{actions}}`当路由器不创建视图时，如何使视图以控制器为目标。我认为设置`controller`属性会做到这一点，但似乎没有。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T21:19:01.427

您需要`controller`在指向控制器的视图上设置一个属性，并`target`在控制器上定义一个属性，如下所示：

```
App.MyController = Em.Controller.extend({
    target: function(){
        return this;
    }.property()
    ...
}); 
```

# android - Android：从特定的 -dpi 文件夹访问可绘制对象？

> ID：12165338
> 
> 赞同：6
> 
> 时间：2012-08-28T18:32:08.907
> 
> 标签：android, resources, drawable

我有两个可绘制文件夹：drawable-mdpi 和 drawable-ldpi

我想保留这个结构（即我不想将我的图像移动到 /assets），以便 Android 会根据设备密度自动选择适当的图稿，但是，有时我需要访问更大的可绘制版本在较小的设备上。

有没有办法从代码中访问 drawable-ldpi 文件夹？我认为以下可能是答案，但它不起作用：

```
 Uri path = Uri.parse("android.resource://com.example.test/res/drawable-ldpi/icon");
    imageview.setImageURI(path); //assume imageview is already initialized etc. 
```

我收到 java.io.FileNotFoundException（没有这样的文件或目录）警告（它不会崩溃，但也不会加载）。

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T03:48:41.273

可能没有太大帮助，但有 Resources.getDrawableForDensity() 但这适用于 API 15 :-(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:14:53.760

Generally, if you ever need to use the HDPI version, keep ONLY the HDPI version of the image, and the lower density phone will automatically use the HDPI drawable because it has no choice (i.e. a lower resolution image with that drawable name does not exist).

If you really need to switch between the hdpi and mdpi version I would suggest using a different filename and swapping programmatically, or showing/hiding XML elements if you prefer doing it that way... but that seems a little heavy-handed.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-03T09:08:01.817

```
ImageView image = (ImageView)findViewById(R.id.imageView);
Bitmap bm = BitmapFactory.decodeResource(getResources(),R.drawable.abc);
image.setImageBitmap(bm); 
```

尝试阅读[此链接](http://developer.android.com/intl/zh-CN/guide/practices/screens_support.html)以了解有关 hdpi 和 mdpi 概念的更多研究

# css - 溢出：自动；在 flexbox 中（新规范）

> ID：12165352
> 
> 赞同：3
> 
> 时间：2012-08-28T18:33:14.850
> 
> 标签：css, webkit, flexbox

我正在尝试将设计迁移到新的 flexbox 规范（`display: -webkit-flex;`而不是`display: webkit-box;`）。尽管`overflow: auto;`除非我在溢出的容器上设置明确的高度，否则该属性似乎被忽略了。

**工作示例：**

[旧规范的实现](http://codepen.io/WilsonPage/pen/lIeCG)

[使用新规范实施](http://codepen.io/WilsonPage/pen/kAyfv)

*我做错了什么，还是这个新规范还没有完全完成？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T18:27:30.083

半年后：我在类似的问题上苦苦挣扎，不得不说这更有可能是一个**错误**。

不幸的是，当前版本的*Chrome 25*和*Safari 6.0.2*都没有处理这种情况。

不过，如果您查看最新的*Chrome 27 金丝雀*版本，您会发现它似乎已修复。

我必须对您的示例应用的唯一一个代码更改是删除`height: 100%;`底部容器上的属性并添加为主底部容器设置的某种hack `min-height: 0;`（顺便说一句，由于某种原因也可以用`height: 0;`属性替换）。

[CodePen 分叉](http://codepen.io/pawelsledzikowski/pen/DLwby)

# algorithm - 排列的增长顺序

> ID：12165353
> 
> 赞同：0
> 
> 时间：2012-08-28T18:33:17.720
> 
> 标签：algorithm, big-o, permutation

这是一个简单的程序，可以找到给定字符串的所有排列：

```
void perm( char str[], int len )
{
if ( len == 1 )
   cout << str << endl ;
else
    for ( int i=0; i<len; i++ ) {
        swap( str[len-1], str[i] ) ;
        perm( str, len-1 ) ;
        swap( str[len-1], str[i] ) ;
    }
} 
```

这个函数的 T(n) 是多少？如何计算此函数的 Big Oh（或 Theta）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:54:38.223

For循环执行n递归，到n*T(n-1)，加上O(n)，因为你还需要交换2n次，所以

```
T(n) = n*T(n-1)+O(n)

n = 5 for sake of my keyboard

T(n) = n*T(n-1) + n  
T(n) = n*[(n-1)*T(n-2) + (n-1)] + n  
T(n) = n*[(n-1)*[(n-2)*T(n-3) + (n-2)] + (n+1)] + n  
T(n) = n*[(n-1)*[(n-2)*[(n-3)*T(n-4) + (n-3)] + (n-2)] + (n-1)] + n  
T(n-4) = 1 ----------------------^  
Simplify 
T(n) = n*[(n-1)*[(n-2)*[(n-3) + (n-3)] + (n-2)] + (n-1)] + n  
T(n) = n*[(n-1)*[(n-2)*[2(n-3)] + (n-2)] + (n-1)] + n  
T(n) = n(n-1)(n-2)*(n-3)*2 + (n-1)(n-2) + n(n-1) + n  
T(n) = n! + O(n*n!)    <--  wrong, see comment for right answer
T(n) = O(n*n!)    <--  wrong, see comment for right answer 
```

你看到模式

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T19:30:57.223

设初始输入字符串的长度为 N。

假设调用 perm(str (size = N), len=i) 所花费的时间为 T(i)

```
T(1) = N 
```

和

```
T(i > 1) = iT(i-1) + i 
```

则总时间为 T(N)，

要计算此重复的封闭形式，请参见此处：

[https://math.stackexchange.com/questions/188119/closed-form-for-t1-k-tx-xtx-1-x](https://math.stackexchange.com/questions/188119/closed-form-for-t1-k-tx-xtx-1-x)

答案是：

```
T(N) is approximately (N + e - 1)N! 
```

因此，当 N 接近无穷大时，函数的性能为：

```
O((N + e - 1)N!) = O(N(N!)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T18:35:58.273

N个项目的可能排列数是N！（阶乘），并且此代码似乎使用它输出的每个排列的 O(1) 操作。因此，建设成本为 O(N!)，相当于 O(N^N)。

或者可能是 O(N!*N)，因为对于每个排列，N 项都会打印到控制台。

# regex - 当字符串包含 ( 和 ) 时，使用 regexp_substr 提取字符串的一部分

> ID：12165354
> 
> 赞同：2
> 
> 时间：2012-08-28T18:33:20.467
> 
> 标签：regex, oracle, plsql

我想使用正则表达式在 oracle 中提取字符串的以下部分：

```
String: FN_SUM(ACCRUED_INTEREST)
Output expected: ACCRUED_INTEREST 
```

我试过 ：

```
select regexp_substr('FN_SUM(ACCRUED_INTEREST)','([^)]') from dual; 
```

这给了我 ORA-12725 错误。

任何使用正则表达式的解决方案都将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T18:46:33.703

尝试：

```
select regexp_replace('FN_SUM(ACCRUED_INTEREST)', '(.*)?\((.*)?\)(.*)?$','\2') from dual; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T12:13:13.653

为什么不使用常规替换

```
select replace( replace('fn_sum(value)'
               , substr('fn_sum(value)', 1, instr('fn_sum(value)', '(')))
               , ')') 
  from dual 
```

# java - 何时在 Swing 应用程序中显示无效输入的错误消息

> ID：12165355
> 
> 赞同：2
> 
> 时间：2012-08-28T18:33:32.680
> 
> 标签：java, swing, user-interface, error-handling

我正在使用`JFormattedTextField`for 来格式化 Swing 应用程序的整数输入。无效输入的默认行为是悄悄地（即没有错误消息）将文本字段重置为其先前的值。我想`JOptionPane`在将焦点返回到`JFormattedTextField`.

`FocusListener`我最初的解决方案是为我的文本字段实现s 。我考虑为每个实例添加相同`FocusListener`子类的实例，但由于我使用的是 NetBeans GUI Builder，因此遇到了问题。[@HovercraftFullOfEels 建议](https://stackoverflow.com/questions/12117414/how-do-i-add-the-same-listener-to-multiple-components-in-the-netbeans-gui-builde)我使用`InputVerifier`. 我已经实现了以下自定义 InputVerifier：

```
public class ValidTextFormatInputVerifier extends InputVerifier {

    @Override
    public boolean verify(JComponent jc) {
        return ((JFormattedTextField)jc).isEditValid();
    }
} 
```

`JFormattedTextField`在进一步研究这一点时，我得到了内部使用的印象`InputVerifier`。（不过，我还没有在任何地方发现这一点。）因此，我的习惯`InputVerifier`似乎是多余的。

更大的问题是文本字段仍然静默重置，没有任何错误消息。我可以在`JOptionPane.showMessageDialog()`这里添加一个电话。但是，这似乎不是显示错误消息的合适位置。不知道无效输入的`InputVerifier`确切性质，也不知道有效输入的格式，这对于提供有意义的错误消息更为关键。

想到的第一个解决方案是添加一个构造函数，该构造函数接受一个`String`包含要显示的错误消息的参数。不过，这似乎是我将错误消息逻辑放在了错误的位置。

是否有用于错误处理和向用户提供消息的通用 Java 习惯用法？您如何建议我设计我的应用程序以清晰地显示错误消息？此外，如果我决定使用不同的平台（例如命令行、移动设备等）为软件设计一个界面，我希望能够尽可能多地重用我现有的代码库。（当然，由于这主要是一个 UI 问题，因此该要求可能不像我在这里想要的那样强烈适用。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T18:39:39.440

我的第一个观点是，每当文本字段焦点丢失时向用户显示 JOptionPane 对用户来说可能非常烦人。当用户点击表单的 OK 按钮时，我会显示一条错误消息。错误消息可以包含所有错误消息的列表，也可以只包含第一个错误消息，并将错误集中在元素上。

另一种选择是使用常规`JTextField`并编写您自己的自定义验证器。当焦点改变时，您的 IntegerValidator（或其他实现）将验证输入字符串，并且 UI 可能会在字段旁边显示错误或警告图标，这与某些 Web 应用程序相同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T20:32:16.993

我会看看[JLayer](http://docs.oracle.com/javase/7/docs/api/javax/swing/JLayer.html) (Java 7) 或[JXLayer](http://java.net/projects/jxlayer/) (Java 6 & below)

这将允许您使用不同状态的真实性来装饰字段或表单。

至于什么时候。

我会从使用某种荧光笔开始，Dan 建议使用图标，这是一个好主意，再加上`JLayer`/`JXLayer`这会减少对表单的整体影响。

我会等到用户尝试提交表单，然后再显示对话框并强制焦点回到无效字段。

基本思想是允许用户在没有太多限制的情况下自由移动表单（因为并非所有人都以线性方式思考），但鼓励他们纠正他们在此过程中产生的任何可能的错误，而不必等到他们提交表单以查找错误（想想您曾经使用过的最糟糕的网络表单，不要这样做）

显然，如果他们尝试提交有错误的表单，您将希望显示错误消息并突出显示第一个违规字段

有关`JLayer`/`JXLayer`的示例，请查看[使用 JXLayer 的验证覆盖](http://www.pushing-pixels.org/2007/08/01/validation-overlays-using-jxlayer.html)以及[如何装饰组件](http://docs.oracle.com/javase/tutorial/uiswing/misc/jlayer.html)

# c# - 为什么 ItemsSource 不绑定到我的自定义 CollectionChanged 事件

> ID：12165356
> 
> 赞同：2
> 
> 时间：2012-08-28T18:33:33.313
> 
> 标签：c#, .net, windows-8

这是我遇到过的最奇怪的事情。就像在 Windows 8 MS 中删除了 CollectionViewSource 中的过滤和排序一样，我不得不自己构建一个名为`CollectionView<T>`. `CollectionView`有一个 View 类型的属性`IObservableCollection<T>`，这是我为了保持抽象而制作的自定义接口。它的定义很简单

```
public interface IObservableCollection<T> : IReadOnlyList<T>, INotifyCollectionChanged
{
} 
```

然后，我有实现此接口的内部类：

```
internal class FilteredSortedCollection<T> : IObservableCollection<T>
{
    public event NotifyCollectionChangedEventHandler CollectionChanged;

    public void RaiseCollectionChanged(NotifyCollectionChangedEventArgs args)
    {
        var copy = CollectionChanged;
        if (copy != null)
            copy(this, args);
    }

    public Func<IEnumerator<T>> RequestEnumerator { get; set; }
    public Func<int> RequestCount { get; set; }
    public Func<int, T> RequestItem { get; set; }

    public IEnumerator<T> GetEnumerator()
    {
        return RequestEnumerator();
    }

    public int Count { get { return RequestCount(); } }
    public T this[int index] { get { return RequestItem(index); } }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }
} 
```

事情一直到这里。CollectionView 过滤器和排序正确，视图按预期工作。除非我将它绑定到 ListView.ItemsSource 属性**，否则它的行为就好像它没有实现一样`INotifyCollectionChanged`**。没有人监听 Co​​llectionChanged 事件（使用调试器检查）并且**UI 不会随着添加的新元素而更新**。但是，如果我添加一些项目，然后设置 ItemsSource 属性，则 UI 会更新。就好像它是一个正常的、不可观察的列表一样。

有人知道这里会发生什么吗？我试过删除`IObservableCollection`接口，所以`FilteredSortedCollection`直接实现了`IReadOnlyList<T>`，`INotifyCollectionChanged`但是没有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T21:52:59.493

您的集合需要实现 IList。我刚刚遇到了同样的问题，我已经实现了 IList，它在我的 Windows Phone 应用程序中运行良好，但是当我尝试将视图模型用于 Windows 8 应用程序时，它没有遵守更改的事件。

我将 IList 的实现添加到我的班级，现在一切都按预期工作

# java - 具有高嵌套级别的 Java 递归

> ID：12165358
> 
> 赞同：1
> 
> 时间：2012-08-28T18:33:39.943
> 
> 标签：java, recursion

我正在用 Java 编写一个函数，它必须递归调用自己很多次（在 ~10000 的范围内）。在达到某种程度的递归（~3250 atm）之后，Java 线程就保持不变并且必须重新启动。这不受启动 jvm 的 RAM 量的影响（当前为 2GB）。

如何影响我的 jvm 可以处理的最大嵌套级别？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T18:36:28.383

按此顺序，尝试：

1.  改变你的算法（你应该能够使用堆栈和循环代替）。

2.  使用尾递归（即：改变你的语言，[scala](/questions/tagged/scala "显示标记为“scala”的问题")支持尾递归）

3.  将参数传递`-Xss1m`给 JVM 以增加堆栈大小。`1m`表示 1 MiB。

# 也可以看看

*   [Java 堆栈溢出错误 - 如何在 Eclipse 中增加堆栈大小？](https://stackoverflow.com/questions/2127217)

# ruby - `includes?` 在一个可能未分配的数组中

> ID：12165359
> 
> 赞同：1
> 
> 时间：2012-08-28T18:33:47.010
> 
> 标签：ruby, arrays

`include`如果它正在搜索的数组可能未分配，是否有一种使用方式？

我已经尝试了很多变种

```
(foo || []).include?(:bar) 
```

但没有成功

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:39:50.657

如果`foo`真的是`nil`，而不是未定义，那么`(foo || []).include?(:bar)`会做你想做的事，但是如果`foo`还没有设置任何东西，那么你会得到一个`NameError`，所以我们可以用更长的oneliner检查它......

```
defined?(foo) ? (foo || []).include?(:bar) : false 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T19:20:51.437

```
(foo ||= []).include?(:bar) 
```

那会成功的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:36:31.550

也许这个？

```
foo.includes? :bar if foo 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T16:54:28.790

由于您使用的是部分，因此将其放在部分的顶部：

```
<% foo = [] unless local_assigns.has_key?(:foo) # for Arrays %>
<% foo = {} unless local_assigns.has_key?(:foo) # for Hashes %>
<% foo = "" unless local_assigns.has_key?(:foo) # for Strings %> 
```

等等

这是检查部分中使用的变量是否已设置的正确方法。

在使用 foo 部分的视图中：

```
 <% render :partial => "foo", :locals {:a => 1, :foo => [2, 3, 4]} %>
 <% render :partial => "foo", :locals {:a => 1} %> 
```

在第一种情况下，`foo`变量将`[2,3,4]`位于 foo 部分中。

在第二种情况下，`foo`变量不会被放入，`local_assigns`因此将按照上面的代码被赋予一个默认值。

# c++ - 我自己的 C++ 框架（类似 MFC），我可以创建子窗口，但在 WM_CREATE 时无法创建编辑框

> ID：12165360
> 
> 赞同：0
> 
> 时间：2012-08-28T18:33:51.690
> 
> 标签：c++, frameworks, mfc, hook

我构建了自己的与 MFC 类似的 c++ 框架，我可以在收到 WM_CREATE 消息时创建子窗口，但我无法处理编辑框，我从[Ivan Shcherbakov 的帖子](https://stackoverflow.com/questions/11181649/create-child-window-in-wm-create-relevance-of-same-thread)中得到了这个想法，我在调用后发布了一条 WM_CREATEMYWINDOW 消息OnCreate，并在收到消息时在 OnCreateMyWindow 函数中创建一些东西，当然，它可以工作。但我想知道为什么以及如何解决这个问题。

我的 CWnd 是 CMyWindow，我创建了一个 CBT-hook 来保存新窗口的 HWND 和 CMyWindow*，然后作为 WindowManager 添加到 HWND-WINDOW 映射，消息循环回调函数 MyWndProc，通过 hWnd 参数从 WindowManger 获取 CMyWindow*，然后像CWnd类一样调用CMyWindow的消息函数OnCreate、OnSize、OnMove ...等。

CMyWindow 看起来很好用，它可以保存所有消息并做一些响应，但是它不能在 WM_CREATE 时创建一个编辑框，它是如此的连线，因为它在 WM_CREATE 时创建了一个具有任何样式的新窗口。

我用vs2010，win7构建的。

## MyWindow.h 中的 WindowManager（HWND-WINDOW 映射）

```
#define WM_CREATEMYWINDOW WM_USER + 123

//the CWindowManager is a map of HWND-CMyWindow
class CMyWindow;
//define the HWND-CMyWindow map
typedef map <HWND, CMyWindow*> CWindowMap;
typedef pair<HWND, CMyWindow*> WindowPair;
typedef map <HWND, CMyWindow*>::iterator WndIterator;
typedef pair<WndIterator, bool> IterBool;

class CWindowManager : private CWindowMap
{
private:
    CWindowManager(void);
    ~CWindowManager(void);
public:
    bool Add(CMyWindow* pwnd);  //add a window to map
    bool Remove(HWND hwnd);     //remove a window by hwnd
    void Clear();               //remove all items
    CMyWindow* Find(HWND hwnd); //find the window by hwnd

public:
    //get CWindowManager instance as singleton pattern
    static CWindowManager * GetInstance();
}; 
```

## CMyWindow 类与 MFC 的 CWnd 类似

```
class CMyWindow
{
public:
    CMyWindow(void);
    ~CMyWindow(void);

    inline HWND GetSafeHwnd();  //get HWND
    //Create a window
    bool Create( HINSTANCE hInstance,
                TCHAR * szWindowName,
                       DWORD dwStyle,
                          RECT& rect,
                     HWND hParentWnd,
                         HMENU hMenu,
                     LPVOID lpParam);
    //add the window to WindowManager
    void Attach(HWND hwnd);
    //remove the window from WindowManager
    void Dettach();

    //process the WM_CREATE message
    virtual int OnCreate(LPCREATESTRUCT ps);
    /*
        other message function
    */
    //process the WM_CREATEMYWINDOW message
    virtual void OnCreateMyWindow();
protected:
    HWND _hwnd;
    HINSTANCE _hInst;
}; 
```

## MyWindow.cpp 中的 WindowManager 和 CBT-HOOK 部分

```
#include "StdAfx.h"
#include "LockEx.h"
#include "MyWindow.h"

//window class name
static TCHAR * _MY_WINDOW_CLASS_NAME_ = L"MYWINDOWCLASS";

//window-proc
LRESULT CALLBACK MyWindowProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam);

///an Mutex-Lock class for keep current hwnd of new window, but you can ignore it when using single thread to crate window
static CLockEx   gLockInitWnd;
///keep current hwnd of new window
static CMyWindow * gpInitWnd = 0;
///an hook to create new window
static HHOOK ghook = 0;

///set gpInitWnd when create a new window
static void SetInitWnd(CMyWindow * pWnd)
{
    CLockEx::Scoped lock(gLockInitWnd);

    gpInitWnd = pWnd;
}

///clear gpInitWnd after new window created
static void UnsetInitWnd()
{
    CLockEx::Scoped lock(gLockInitWnd);

    gpInitWnd = 0;
}

///get the HWND of new window that is creating
static CMyWindow * GetInitPwnd()
{
    CLockEx::Scoped lock(gLockInitWnd);

    return gpInitWnd;
}

//CBT-Proc for SetWindowsHookEx
static LRESULT CALLBACK MyCBTProc(int nCode, WPARAM wParam, LPARAM lParam)
{
    if (nCode == HCBT_CREATEWND) {
        //get the new window from gpInitWnd
        CMyWindow * pwnd = GetInitPwnd();

        if (pwnd) {
            //first time call this proc
            //add this window to WindowManager
            pwnd->Attach((HWND)wParam);
            return (0);
        } else {
            //sencond time call this proc
            CREATESTRUCT * cs = ((CBT_CREATEWND *)lParam)->lpcs;
            if (!(cs->style & WS_CHILD)) {
                //we can do something here
                return (0);
            } else {
                return (1); //error, destroy the window
                            //or, maybe, CallNextHookEx
            }
        }
    } else
        return CallNextHookEx(ghook, nCode, wParam, lParam);
}

//Create a WH_CBT Hook
static bool HookCrate()
{
   HANDLE hThread = GetCurrentThread();
   DWORD dwThreadId = GetThreadId(hThread);
   if (hThread) {
        ghook = SetWindowsHookEx(
            WH_CBT,
            MyCBTProc,    //set the CBT proc
            0,
            dwThreadId);
        if (!ghook)
            return false;
   }

   return (0);
}

//Destroy WH_CBT Hook
static void HookDestroy()
{
   if (ghook) {
        UnhookWindowsHookEx(ghook);
        ghook = 0;
   }
}

///////////////////////////////////////////////
//this is a vector for keep all CMyWindow*
CWindowManager::CWindowManager(void)
{
}

CWindowManager::~CWindowManager(void)
{
    clear();
}

//insert new window
bool CWindowManager::Add(CMyWindow* pwnd)
{
    IterBool ib = insert(WindowPair(pwnd->GetSafeHwnd(), pwnd));
    return ib.second;
}

//remove a window by hwnd
bool CWindowManager::Remove(HWND hwnd)
{
    WndIterator wi = find(hwnd);

    if (wi == end( )) {
        return false;
    } else {
        erase(wi);
        return true;
    }
}

//find a window by hwnd
CMyWindow* CWindowManager::Find(HWND hwnd)
{
    WndIterator wi = find(hwnd);

    if (wi == end( )) {
        return (0);
    } else {
        return wi->second;
    }
}

//remove all items
void CWindowManager::Clear()
{
    clear();
}

//get instance as singleton pattern.
CWindowManager * CWindowManager::GetInstance()
{
    static CWindowManager wm;
    return &wm;
} 
```

## 注册窗口类，将 WndProc 设置为 MyWIndowProc

```
ATOM RegisteWindowClass(HINSTANCE hInstance, TCHAR * szClassName)
{
    WNDCLASSEX wcex;

    wcex.cbSize = sizeof(WNDCLASSEX);

    wcex.style      = CS_HREDRAW | CS_VREDRAW;
    wcex.lpfnWndProc    = MyWindowProc;
    wcex.cbClsExtra     = 0;
    wcex.cbWndExtra     = 0;
    wcex.hInstance      = hInstance;
    wcex.hIcon          = 0;
    wcex.hCursor        = LoadCursor(NULL, IDC_ARROW);
    wcex.hbrBackground  = (HBRUSH)(COLOR_WINDOW + 1);
    wcex.lpszMenuName   = 0;
    wcex.lpszClassName  = szClassName;
    wcex.hIconSm        = 0;    
    return RegisterClassEx(&wcex);
} 
```

## CMyWindow 类，请注意我在 WM_CREATE 和 WM_CREATEMYWINDOW 消息中的麻烦

```
CMyWindow::CMyWindow(void)
    : _hwnd(0)
    , _hInst(0)
{
}

CMyWindow::~CMyWindow(void)
{
}

inline HWND CMyWindow::GetSafeHwnd()
{
    return _hwnd;
}

//Craete a window
bool CMyWindow::Create( HINSTANCE hInstance,
                        TCHAR * szWindowName,
                        DWORD dwStyle,
                        RECT& rect,
                        HWND hParentWnd,
                        HMENU hMenu,
                        LPVOID lpParam)
{
    //get safe instance
    HINSTANCE hInst = hInstance;
    if (!hInstance)
        if (!hParentWnd)
            return false;
        else
            hInst = (HINSTANCE) GetWindowLong(hParentWnd, GWL_HINSTANCE);
    if (!hInst)
        return false;

    //register window class
    if (!RegisteWindowClass(hInst, _MY_WINDOW_CLASS_NAME_)) {
        DWORD dwErr = GetLastError();
        if (dwErr != ERROR_CLASS_ALREADY_EXISTS) //0x00000582
            return false;
    }

    //claim i am creating 
    SetInitWnd(this);
    //create CBT hook, then this window will add to WindowManager
    HookCrate();
    //create window
    HWND hwnd = CreateWindow(
                    _MY_WINDOW_CLASS_NAME_,
                    szWindowName,
                    dwStyle,
                    rect.left, rect.right, rect.right - rect.left, rect.bottom - rect.top,
                    hParentWnd,
                    hMenu,
                    hInstance,
                    lpParam);
    //destroy CBT hook
    HookDestroy();

    if (!hwnd)
        return false;

    _hwnd = hwnd;
    _hInst = hInst;

    //show window
    ShowWindow(_hwnd, SW_SHOW);
    UpdateWindow(_hwnd);
    return true;    
}

//add the this window to WindowManager
void CMyWindow::Attach(HWND hwnd)
{
    _hwnd = hwnd;
    CWindowManager::GetInstance()->Add(this);

    UnsetInitWnd();
}

//remove the this window to WindowManager
void CMyWindow::Dettach()
{
    CWindowManager::GetInstance()->Remove(_hwnd);
    _hwnd = 0;
}

int CMyWindow::OnCreate(LPCREATESTRUCT ps)
{
    return (0);
}

void CMyWindow::OnCreateMyWindow()
{
}

//the WndProc callback function
LRESULT CALLBACK MyWindowProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    //Get the CMyWindow instance from WindowManager by hWnd
    CMyWindow * pwnd = CWindowManager::GetInstance()->Find(hWnd);
    //can not find thi window in WindowManager
    if (!pwnd) return DefWindowProc(hWnd, message, wParam, lParam);

    switch (message)
    {
    case WM_CREATE:
        {
            //perform the OnCreate function, just like MFC's OnCreate
            int r = pwnd->OnCreate(reinterpret_cast<LPCREATESTRUCT>(lParam));
            if (r)  //some error occurred, will destory the window
                return (r);
            //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
            //I can not create any edit box in OnCreate function,
            //I must do it leater, when the window was created and
            //WM_CREATEMYWINDOW was received
            ::PostMessage(hWnd, WM_CREATEMYWINDOW, 0, 0);
        }
        break;
    /*
    case WM_.....
        other message
    case WM_.....
    */
    case WM_DESTROY:
        ::PostQuitMessage(0);
        break;
    case WM_CREATEMYWINDOW:
        //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
        //I can not create any edit box in OnCreate function,
        //I must do it when WM_CREATEMYWINDOW was received
        pwnd->OnCreateMyWindow();
        break;
    }

    return DefWindowProc(hWnd, message, wParam, lParam);
} 
```

## 现在，继承 CMyWindow 类来创建 2 个窗口，第一个窗口将创建第二个带有编辑框的窗口

```
class CMyWnd2 : public CMyWindow
{
public:
    CMyWnd2(void) : _hCmdEdit(0) {}
    ~CMyWnd2(void){}

protected:
    HWND _hCmdEdit;

    //create edit box
    virtual void OnCreateMyWindow();
};

class CMyWnd1 : public CMyWindow
{
public:
    CMyWnd1(void) {}
    ~CMyWnd1(void){}

protected:
    virtual int OnCreate(LPCREATESTRUCT ps);

    //create window2
    virtual void OnCreateMyWindow();

    CMyWnd2 _wnd2;
};

int CMyWnd1::OnCreate(LPCREATESTRUCT /*ps*/)
{
    //Can create window2, but can not crate window2's edit-boxs
    return (0);
}

//create window2 with edit box
void CMyWnd1::OnCreateMyWindow()
{
    RECT rect = {0, 0, 400, 300};

    _wnd2.Create(this->_hInst,
        0,
        WS_VISIBLE | WS_POPUP,
        rect,
        _hwnd,
        0,
        0);
}

//create edit box
void CMyWnd2::OnCreateMyWindow()
{
    RECT rect;
    GetClientRect(_hwnd, &rect);
    _hCmdEdit = CreateWindowEx(
                            WS_EX_STATICEDGE,
                            L"EDIT",
                            NULL,
                            WS_CHILD | WS_VISIBLE | WS_VSCROLL | ES_LEFT | ES_MULTILINE | ES_AUTOVSCROLL, 
                            0,
                            rect.bottom - 80,
                            rect.right - rect.left,
                            80,
                            _hwnd,
                            (HMENU) 100,
                            (HINSTANCE) GetWindowLong(_hwnd, GWL_HINSTANCE),
                            NULL);
} 
```

## 最后，WinMain 函数创建一个 CMyWnd1 的实例

```
CMyWnd1 mainwnd;
RECT rect;
rect.left = rect.top = 0, rect.right = 500, rect.bottom = 400;
mainwnd.Create(hInstance,
    L"MyWindow",
    WS_OVERLAPPEDWINDOW,
    rect,
    0,
    0,
    0);

while (GetMessage(&msg, NULL, 0, 0))
{
    if (!TranslateAccelerator(msg.hwnd, hAccelTable, &msg))
    {
        TranslateMessage(&msg);
        DispatchMessage(&msg);
    }
} 
```

## 这里一定有我错过的东西，任何人都可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T21:55:18.247

请注意，`WM_CREATE`消息是在`CreateWindow()`退货前发送的。这意味着窗口句柄成员`_hwnd`（注意：不应使用以 _ 和 __ 开头的标识符，它们是为编译器扩展保留的）尚未初始化并且包含 0。因此后续`CreateWindow()`调用失败，因为您必须传递有效的窗口句柄才能创建子窗口 (有`WS_CHILD`风格）。但是弹出窗口（`WS_POPUP`样式）是允许的。这很可能是创建 Wnd2 的原因，但没有创建编辑框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:13:56.243

我明白了，CBThook 回调函数发生了一个愚蠢的错误，当第二次调用此函数时，我拒绝了创建 WS_CHILD 样式的窗口的请求。它只需要返回一个零！请查看评论中的错误。现在它起作用了！感谢[Rost 的](https://stackoverflow.com/users/1599260/rost)提示。

```
static LRESULT CALLBACK MyCBTProc(int nCode, WPARAM wParam, LPARAM lParam)
{
    if (nCode == HCBT_CREATEWND) {
        //get the new window from gpInitWnd
        CMyWindow * pwnd = GetInitPwnd();

        if (pwnd) {
            //first time call this proc
            //add this window to WindowManager
            pwnd->Attach((HWND)wParam);
            return (0);
        } else {
            //sencond time call this proc
            return (0);

            ////
            /// below was my stupid code, 
            ////

            /*CREATESTRUCT * cs = ((CBT_CREATEWND *)lParam)->lpcs;
            if (!(cs->style & WS_CHILD)) {
                //we can do something here
                return (0);
            } else {
                return (1); //error, destroy the window
                            //or, maybe, CallNextHookEx
            }*/
        }
    } else
        return CallNextHookEx(ghook, nCode, wParam, lParam);
} 
```

# mysql - 多值属性的 DBMS 设计

> ID：12165361
> 
> 赞同：0
> 
> 时间：2012-08-28T18:33:54.443
> 
> 标签：mysql, rdbms, multivalue-database

我必须设计一个数据库，将有关打印机资源使用情况的一些信息记录在 mysql 数据库中。设计数据库的最佳方法是什么？我不想为每个学生创建一个表，因为大约有 6000 个表，并且如果要维护档案，这些表每年都会不断增长。此外，根据学生的注册号创建表格也很困难。有没有比存储打印细节的多值属性更好的方法。请提出一些解决方案。查询也应该是有效的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:42:31.657

无需为每个学生创建不同的表。只需创建一个表 STUDENT，其中将包含由他们的注册号标识的学生的个人详细信息（比如说 Regno-PrimaryKey）。

然后是另一个表资源，它将具有以下架构：-RecNo Integer PK -StudentID Foriegn 键引用到学生表中的 Regno -Usage 或 Data,Time（如果需要）

这将适用，您不必创建 6000 个或更多表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:48:26.137

您提供的信息*很少*，但这里有一个镜头：

```
create table student 
(
   registration_no    varchar(50)  not null primary key,
   first_name         varchar(50),
   last_name          varchar(50),
   registration_year  integer not null
);

create table printer
(
   printer_id    integer not null primary key,
   printer_name  varchar(50) not null,
   ip_address    varchar(50) not null,
   queue_name    varchar(50) not null
);

create unique index idx_printer_name on printer (printer_name);

create table printer_usage
(
   usage_id         integer not null primary key,
   student_reg_no   integer not null,
   printer_id       integer not null,
   usage_date       datetime not null,
   pages            integer not null
);

alter table printer_usage 
   add constraint fk_usage_student 
   foreign key (student_reg_no) references student (registration_no);

alter table printer_usage 
   add constraint fk_usage_printer 
   foreign key (printer_id) references printer (printer_id); 
```

您可能需要向表中添加更多列来存储您需要的所有内容。我只是猜测你可能想要存储的东西。

# jboss7.x - 关闭 JBoss 7 AS 和主机控制器

> ID：12165363
> 
> 赞同：1
> 
> 时间：2012-08-28T18:34:01.417
> 
> 标签：jboss7.x

我使用 JBoss 7.1.1-FINAL AS。它配置为使用默认设置以域模式启动。我使用 domain.sh 文件来启动启动 4 个 java 进程的服务器：

1.  主机控制器
2.  过程控制器
3.  服务器一
4.  服务器二

为了关闭服务器，我调用以下命令：

```
./jboss-cli.sh --connect controller=host:9999 /host=master:shutdown 
```

这会关闭 2 台服务器，即服务器 1 和服务器 2。

我想知道如何停止主机控制器和进程控制器。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T17:54:46.400

上面提到的命令是关闭服务器的命令。显然，这最近开始起作用。我不知道问题是什么。主机控制器和进程控制器也使用此命令关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:49:55.773

您可以尝试任一命令。他们都为我工作；停止所有进程。#1 是连接到控制器的简写命令。

```
./jboss-cli.sh --connect /host=master:shutdown
./jboss-cli.sh --connect controller=localhost:9999 /host=master:shutdown 
```

干杯。

# css - 带有片段的崇高文本换行选择

> ID：12165364
> 
> 赞同：42
> 
> 时间：2012-08-28T18:34:04.747
> 
> 标签：css, less, sublimetext2, sublimetext, sublimetext3

我一直在研究 Sublime 的片段、插件和宏，但似乎找不到我要找的东西。

我试图把这个：

```
.content {
    color: @blue;
} 
```

进入这个：

```
.content {
    color: darken(@blue, 5%);
} 
```

理想情况下，我可以选择`@blue`零件，点击命令，然后正确地包装整个东西。

有任何想法吗？这甚至可能吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-08-28T18:49:56.230

可以在[这里](http://sublimetext.info/docs/en/extensibility/snippets.html)看到：

工具 -> 新片段... -> 另存`darken.sublime-snippet`为`Data\Packages\User\`

```
<snippet>
    <content><![CDATA[darken($SELECTION, 5%);]]></content>
    <!-- Optional: Tab trigger to activate the snippet -->
    <tabTrigger>darken</tabTrigger>
    <!-- Optional: Scope the tab trigger will be active in -->
    <scope>source.css</scope>
    <!-- Optional: Description to show in the menu -->
    <description>Darken Snippet</description>
</snippet> 
```

和键绑定：

```
{ "keys": ["ctrl+shift+o"], 
  "command": "insert_snippet", 
  "args": { "name": "Packages/User/darken.sublime-snippet" } }, 
```

**编辑：**`$1`如果你在之后 添加会更好`$SELECTION`，然后光标将跳转到选定的单词，或者如果它没有被选中，则光标将跳转到必须写入的位置。

将上述代码段的第二行更改为：

```
<content><![CDATA[darken($SELECTION$1, 5%);]]></content> 
```

# iphone - 增加tableView的单元格大小？

> ID：12165368
> 
> 赞同：0
> 
> 时间：2012-08-28T18:34:25.073
> 
> 标签：iphone, ios, uiview, label, tableview

我有一个带有自定义单元格的 tableView，其中包含 3 个标签、名称、书籍和章节。不幸的是，我的单元格似乎不足以容纳 3 个标签，我想让它更大。我应该在下面的代码中做什么才能以最佳方式实现这一目标？/问候

tableView 中单元格的图片：[http ://tinypic.com/view.php?pic=2vrzpu9&s=6](http://tinypic.com/view.php?pic=2vrzpu9&s=6)

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"BookmarkCell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil)
{
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}
Bookmark *item = [self.items objectAtIndex:indexPath.row];

NSArray *chunks = [item.name componentsSeparatedByString: @","];

NSString *name;
NSString *book;
NSString *chapter;

if ([chunks count] > 0)
{
    name = [chunks objectAtIndex:0];
    if ([chunks count] > 1)
    {
        book = [chunks objectAtIndex:1];
        if ([chunks count] > 2)
        {
            chapter = [chunks objectAtIndex:2];
        }
    }
}

UIView * pNewContentView= [[UIView alloc] initWithFrame:cell.contentView.bounds];
CGRect labelFrame= pNewContentView.bounds;
labelFrame.size.height= labelFrame.size.height * 0.25;

UILabel* pLabel1=[[UILabel alloc] initWithFrame:labelFrame];
[pNewContentView addSubview:pLabel1];

labelFrame.origin.y= labelFrame.size.height;
UILabel* pLabel2=[[UILabel alloc] initWithFrame:labelFrame];
[pNewContentView addSubview:pLabel2];

labelFrame.origin.y= labelFrame.origin.y + labelFrame.size.height;
UILabel* pLabel3=[[UILabel alloc] initWithFrame:labelFrame];
[pNewContentView addSubview:pLabel3];

[cell.contentView addSubview:pNewContentView];

[pLabel1 setText:(name)];    
[pLabel2 setText:(book)];  
[pLabel3 setText:(chapter)];       

//cell.textLabel.text = chapter;
//cell.textLabel.text = name;
//cell.detailTextLabel.text = book;

return cell;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:39:44.283

很容易自定义 UITableViewCell 的高度

只需添加委托方法

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
    return 70; // or whatever height you need
} 
```

# azure - 在 Azure 中，cscfg 文件来自哪里？

> ID：12165378
> 
> 赞同：3
> 
> 时间：2012-08-28T18:35:01.510
> 
> 标签：azure

所以在 Azure 中，我创建了一个云服务，现在我想上传一个部署。它要求提供一个包（当然，这很简单，一个 zip 文件）和一个配置文件（.cscfg 文件）。我知道 .cscfg 文件应该定义角色、网络配置等。

但我没有 cscfg 文件。他们应该起源于哪里？我必须手写一个吗？这方面的文档充其量是[不合格的。](http://msdn.microsoft.com/en-us/library/windowsazure/ee758710.aspx)有没有办法生成一个？或者以某种方式绕过此步骤进行部署？我的方法在某种程度上一定是错误的（除非我真的必须手写一个，但我怀疑这是一个典型案例）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:46:54.410

您可以依靠 Visual Studio 来创建它，也可以使用命令行工具手动创建。

[http://www.microsoft.com/en-us/download/details.aspx?id=15658](http://www.microsoft.com/en-us/download/details.aspx?id=15658)

您还可以使用 msbuild 创建：

[http://msdn.microsoft.com/en-us/library/windowsazure/hh535755.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh535755.aspx)

# security - 我可以在 Picketlink 注销处理程序中获取用户名吗？

> ID：12165379
> 
> 赞同：3
> 
> 时间：2012-08-28T18:35:07.807
> 
> 标签：security, jboss, logout

我正在扩展 SAML2LogOutHander 以添加一些功能，并且我想确定哪个用户发送了注销请求。但是，目前我似乎无法找到获取此信息的方法。这是可用的吗？如果是这样，我将如何检索它？

# java - 文件构造函数说明

> ID：12165381
> 
> 赞同：24
> 
> 时间：2012-08-28T18:35:20.233
> 
> 标签：java, file

我无法理解以下文件构造函数。

```
public File(String parent, String child) and 
public File(File parent, String child) 
```

文件的参数`parent`和`child`含义是什么？我什么时候可以使用这些？我做过一些与文件相关的程序，但我从未使用过这些程序。我通常使用

```
public File(String pathname) 
```

我已经阅读了[Javadoc](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/File.html#File%28java.lang.String,%20java.lang.String%29)，但我不知道何时以及如何使用这些构造函数。有人可以解释并举例说明。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-08-28T18:36:49.433

## 解释

`parent`参数为文件名的父目录或`child`相对文件路径。

File实例在哪里`parent`，它是一个目录文件。字符串在哪里，就其而言`parent`，它只是那个目录`pathname`。

* * *

## 例子

考虑以下部分文件系统：

```
Documents
    Homework
    Classwork
    Tests 
```

您可以将 Documents 目录声明为文件，并将其用作`parent`其他 File 实例的 File，而不是使用“Documents\Subdir”声明每个新文件，如下所示：

```
File documents = new File("Documents");
File tests = new File("Documents/Tests"); // new File(String);

File homework = new File(documents, "Homework"); // new File(File, String)

File classwork = new File("Documents", "Classwork"); // new File(String, String) 
```

* * *

## 实际应用

以我的经验，我使用的应用程序提供的 API 包含一个方法，该方法返回允许第三方“插件”保存/读取文件的目录文件。如果没有`File(File, String)`构造函数，我需要将目录文件转换为绝对路径并将我的目标文件附加到它。

在以下示例中，`Environment.getProgramDirectory()`返回授予权限的目录文件。

```
File settingsFile = new File(Environment.getProgramDirectory(), "settings.txt"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T18:38:21.283

“父抽象路径名用于表示目录，子路径名字符串用于表示目录或文件。”如[API中所述](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/File.html#File%28java.io.File,%20java.lang.String%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T18:38:48.600

`Parent`将指向`Directory`

`Child`将是它的`Contents`..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T18:42:47.023

让我们用一些例子来解释：

假设您具有以下结构：

```
/dir1
  dir11 
```

你通常使用的构造函数`new File("/dir1/dir11")`相当于

`new File("/dir1", "dir11")`（构造函数以 2`String`作为参数）

也相当于

`new File(new File("/dir1"), "dir11")`（使用 a`File`作为第一个参数的构造函数）。

# ruby - Selenium webdriver 脚本的 Ruby 'require' 错误

> ID：12165382
> 
> 赞同：0
> 
> 时间：2012-08-28T18:35:21.230
> 
> 标签：ruby, selenium, selenium-webdriver

我正在尝试执行一个脚本来测试一些用户凭据，并且我不断收到与“要求”相关的错误。该脚本获取用户名和密码的 csv，将它们登录到站点，并将它们分组到通过/失败列表中。

我承认我没有编写脚本——它是由外部编码人员提供给我们的。我参加了一些 CS101 课程，可以解析它在做什么并针对不同的域和凭证文件进行修改，但我是一个完全的 ruby​​ 初学者。

==========================

```
require 'selenium-webdriver'
require 'rubygems'
require 'csv'

pass_file = File.open('pass.txt', 'w')
fail_file = File.open('fail.txt', 'w')
in_file = File.open('test credentials.csv', 'r')

pass_file.puts "xxxxxx"
fail_file.puts "xxxxxx"

CSV.foreach(in_file, :col_sep => ',') do |row|
  driver = Selenium::WebDriver.for :firefox
  driver.get 'https://www.xxxxxx.com/'

  driver.find_element(:id => 'UserNameEntry').send_keys row[0]
  driver.find_element(:id => 'UserPasswordEntry').send_keys row[1]
  driver.find_element(:id => 'xxxxxxlNameEntry').clear
  driver.find_element(:id => 'xxxxxxNameEntry').send_keys "xxxxxx"
  driver.find_element(:xpath => '//*[@id="cmdLoginButton"]/span').click
  driver.switch_to.window(driver.window_handles[1])
  if driver.title == "Welcome!"
    pass_file.puts row[0]
  elsif driver.title == "Login Unsuccessful"
    fail_file.puts row[0]
  end
  driver.quit
end 
```

===================

当我运行它时，起初我得到“`require': no such file to load -- selenium-webdriver (LoadError) from xxxxx.rb:1

然后我在一个论坛上读到，对宝石的要求应该是第一位的。在 require 'selenium-webdriver' 之前放置 require 'rubygems' 后，现在我收到此错误：

/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/csv.rb:308:in `initialize': can't convert File into String (TypeError) from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/csv.rb:308:in`open'来自/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/ lib/ruby/1.8/csv.rb:308:in `open_reader' from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/csv.rb:94:in`foreach'

我感到很困惑......任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:57:56.490

您需要先安装 gems，然后才能使用它们。例如，selenium-webdriver gem 可以在这里找到 [Selenium WebDriver](http://rubygems.org/gems/selenium-webdriver)

您`gem install selenium-webdriver`在终端程序中运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T13:32:21.530

1.  如果之间没有空格，`test credentials.csv`则将其删除。检查是否存在 _
2.  如果之间有空格，`test credentials.csv`则在代码中写入文件名，如下所示`in_file = File.open("test\ credentials.csv", 'r')`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T16:38:53.520

尝试从 csv 文件名中删除空格，例如：

```
in_file = File.open('test_credentials.csv', 'r') 
```

正如我从堆栈跟踪中看到的，读取 csv 文件时发生错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-18T01:09:24.750

如果您使用 Bundler，请`require bundler/setup`在顶部添加。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-02T13:25:17.967

请试试这个。

宝石更新--系统

# regex - 正则表达式解析子域并重定向

> ID：12165383
> 
> 赞同：0
> 
> 时间：2012-08-28T18:35:21.683
> 
> 标签：regex, redirect, subdomain

我一直在尝试解决这个问题将近 2 个小时，但无法让它工作，所以我希望你们中的一些人能帮助我。请注意我对 PHP 和正则表达式很陌生。

好的，所以我正在尝试设置一个重定向，该重定向将根据子域中的文本重定向到某些页面。我为我的子域设置了通配符，并且任何子域 URL 现在都重定向到包含以下代码的这个 php 文件。

因此，如果有人访问 anytexthere.domain.com，他们会到达 domain.com/redirect.php

此 php 文件将用于将它们发送到正确的相关 URL。

为此，我将使用诸如anyhere-1.domain.com 之类的子域，然后让我的代码检查在.domain 之后和之前出现在子域中的内容。如果在这种情况下等于 1，则转到与其匹配的任何 URL，依此类推。

到目前为止的代码：

```
<?php

$host = $_SERVER['SERVER_NAME'];
preg_replace('(?<=-).*?(?=\.)', $host, $matches);
$url = $matches;

switch ($url) 
{ 
case "1": 
header("Location: http://www.website.com/page-here/"); 
break; 

case "test": 
header("Location: http://www.website.com/this-is-a-test/"); 
break; 

case "another": 
header("Location: http://www.website.com/another-page-here/"); 
break; 

default:
header("Location: http://www.website.com");  
break;
} 

?> 
```

如您所见，我有一些案例使用文本，例如“另一个”而不是数字，因为如果我选择在子域中的 - 之后使用文本或数字，我将需要它来工作。

现在的这段代码给了我以下错误：

> 警告：preg_replace() [function.preg-replace]: 未知修饰符 '.' 在第 4 行的此处

和

> 警告：无法修改标头信息 - 标头已由（输出开始于此处的位置：4）在第 22 行再次在该位置发送

我相信上面的第二个错误与默认情况有关。

我真的很感激这方面的任何帮助。我花了很多时间到处搜索代码片段并对其进行测试，但我还没有让它自己工作。

谢谢，彼得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:57:55.460

你有一个小错误——你使用了 preg_replace 而不是 preg_match。此外，您需要用 / 填充正则表达式。所以应该是：

```
preg_match('/(?<=-).*?(?=\.)/', $host, $matches); 
```

顺便说一句，你没有提到你是如何让每个尝试访问 *.domain.com 的人都访问 domain.com/redirect.php.，但我假设你正在使用 htaccess 和 RewriteEngine。您可以直接在 RewriteRule 中键入它。

“标头已发送”表示某些输出已发送到浏览器。您是否将文件保存为没有 BOM 的 UTF-8？或者您在重定向之前已经向浏览器打印了一些东西？文件开头也可能有一些杂散的空格....

# asp.net-mvc - ASP MVC 单选按钮验证

> ID：12165384
> 
> 赞同：7
> 
> 时间：2012-08-28T18:35:28.437
> 
> 标签：asp.net-mvc, validation

我是 mvc 的新手，并且有几个关于 asp mvc 3 验证的问题，关于这些问题的帮助将不胜感激：

首先，我有一个模型类，它需要一些字段，如下所示：

```
[Required(ErrorMessage = "Required field")]
public UInt16 SomeField { get; set; } 
```

它正在工作，但错误消息以黑色字体显示（我希望它是红色的），而且我认为验证是在服务器端而不是客户端上进行的，我一直在阅读一些关于如何进行 javascript 验证的教程工作，但它显然不工作：

网页配置

```
<appSettings>
  <add key="ClientValidationEneabled" value="true" />
  <add key="UnobtrusiveJavaScriptEnabled" value="true" />
</appSettings> 
```

索引.cshtml

```
<script src="../../Scripts/MicrosoftAjax.js" type="text/javascript"></script>
<script src="../../Scripts/MicrosoftMvcValidation.js" type="text/javascript"></script>
@{ Html.EnableClientValidation(); } 
```

那将是我的第二个问题，让它在客户端工作。

对于某些具有`Required`验证器并具有一组与它们相关联的单选按钮的字段，如下所示

模型

```
[Required(ErrorMessage = "Required field")]
public UInt16 SomeField { get; set; } 
```

看法

```
@Html.RadioButtonFor(model => model.SomeField, 1) Label
@Html.RadioButtonFor(model => model.SomeField, 2) Label
@Html.ValidationMessageFor(model => model.SomeField) 
```

当您错过单击单选按钮时，验证消息不会显示（即使是黑色字体），如何在没有按下按钮时显示它。

ASP MVC 3 剃刀引擎

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-28T18:38:21.773

`Microsoft*.js`脚本在 ASP.NET MVC 3 中已弃用，不应再使用。你可以完全摆脱它们。如果您要升级较旧的应用程序，它们仅用于向后兼容。帮助者也是如此`Html.EnableClientValidation();`。它们被`jquery.validate`插件和不显眼的验证脚本所取代。

并且由于您在 web.config 中启用了不显眼的验证，因此为了在 MVC 3 应用程序中启用客户端验证，您需要包含`jquery.validate.js`和`jquery.validate.unobtrusive.js`脚本，`jquery`当然还有您正在使用的版本，因为这两个脚本都依赖于在上面。

```
<script type="text/javascript" src="@Url.Content("~/scripts/jquery-1.5.1.js")"></script>
<script type="text/javascript" src="@Url.Content("~/scripts/jquery.validate.js")"></script>
<script type="text/javascript" src="@Url.Content("~/scripts/jquery.validate.unobtrusive.js")"></script> 
```

关于您的代码的另一个说明是`[Required]`您应用于不可空类型 ( `ushort`) 的属性。这是没有意义的，因为不可为空的类型，就其本质而言，总是有价值的。必需属性应仅用于可为空的类型，例如：

```
[Required(ErrorMessage = "Required field")]
public ushort? SomeField { get; set; } 
```

就验证消息的颜色而言，客户端和服务器端验证都使用相同的 HTML 结构。因此，设计这些消息的外观和感觉实际上是 CSS 的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-06T07:09:47.937

像这样声明模型..使用 Nullable<>

```
[Required(ErrorMessage = "Required field")]
public  Nullable<UInt16> SomeField { get; set; } 
```

因此，当您提交表单而不检查任何单选按钮时，在编写此代码之后会出现空值

```
if (!ModelState.IsValid)
{
    return View();
} 
```

如果您没有选择任何单选按钮，那么它将返回您的视图并显示验证消息...

# java - 如何为 OSX Mountain Lion 上的应用程序设置环境变量？

> ID：12165385
> 
> 赞同：20
> 
> 时间：2012-08-28T18:35:29.870
> 
> 标签：java, eclipse, maven, environment-variables, osx-mountain-lion

自从升级到 OSX Mountain Lion 后，我在为 eclipse 和 maven 设置环境变量时遇到了一些问题。

我的目标是在 Eclipse 中运行一个 Maven 命令。此命令需要从远程存储库下载人工制品（解决依赖关系）。存储库通过 HTTPS 进行身份验证。

我遵循了[通过经过身份验证的 HTTPS 访问远程存储库的指南，](http://maven.apache.org/guides/mini/guide-repository-ssl.html "Gudie 通过经过身份验证的 HTTPS 远程访问存储库")并将以下几行添加到我的 .bash_profil 中。如果我在终端中运行 maven，一切正常。

```
export MAVEN_OPTS="-Xmx512m -Djavax.net.ssl.trustStore=/Users/myUser/.knowncerts/trust.jks -Djavax.net.ssl.trustStorePassword=trustPwd" 
```

但这仅适用于终端，不适用于应用程序。在以前的 OSX 版本中，您必须将 MAVEN_OPTS 变量添加到

```
~/.MacOSX/environment.plist 
```

（另请参阅[在 Mac OS X Lion 上设置环境变量](https://stackoverflow.com/questions/7501678/set-environment-variables-on-mac-os-x-lion)）这对 OSX Lion 非常有效。

但苹果已经改变了山狮的这种行为。我已阅读 environment.plist 不再受支持，新方法是编辑 .app 本身的 Info.plist （[Mountain Lion 中的系统环境变量在哪里设置？](https://apple.stackexchange.com/questions/57385/where-are-system-environment-variables-set-in-mountain-lion)）。看来您必须添加一个包含所有变量的[LSEnvironment字典。](http://developer.apple.com/library/ios/#documentation/general/Reference/InfoPlistKeyReference/Articles/LaunchServicesKeys.html)

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>LSEnvironment</key>
    <dict>
        <key>M2_HOME</key>
        <string>/usr/share/maven</string>
        <key>MAVEN_OPTS</key>
        <string>-Xmx512m -Djavax.net.ssl.trustStore=/Users/myUser/.knowncerts/trust.jks -Djavax.net.ssl.trustStorePassword=trustPwd</string>
    </dict>
    <key>CFBundleExecutable</key>
    <string>eclipse</string>
    <key>CFBundleGetInfoString</key>
    <string>Eclipse 3.8 for Mac OS X, Copyright IBM Corp. and others 2002, 2011\. All rights reserved.</string>
    <key>CFBundleIconFile</key>
    <string>Eclipse.icns</string>
    <key>CFBundleIdentifier</key>
    <string>org.eclipse.eclipse</string>
    <key>CFBundleInfoDictionaryVersion</key>
    <string>6.0</string>
    <key>CFBundleName</key>
    <string>Eclipse</string>
    <key>CFBundlePackageType</key>
    <string>APPL</string>
    <key>CFBundleShortVersionString</key>
    <string>3.8</string>
    <key>CFBundleSignature</key>
    <string>????</string>
    <key>CFBundleVersion</key>
    <string>3.8</string>
    <key>CFBundleDevelopmentRegion</key>
    <string>English</string>
    <key>CFBundleLocalizations</key>
    <array>
        <string>ar</string>
        <string>cs</string>
        <string>da</string>
        <string>el</string>
        <string>en</string>
        <string>es</string>
        <string>de</string>
        <string>fi</string>
        <string>fr</string>
        <string>hu</string>
        <string>it</string>
        <string>iw</string>
        <string>ja</string>
        <string>ko</string>
        <string>nl</string>
        <string>no</string>
        <string>pl</string>
        <string>pt_BR</string>
        <string>pt</string>
        <string>ru</string>
        <string>sv</string>
        <string>tr</string>
        <string>zh_HK</string>
        <string>zh_TW</string>
        <string>zh</string>
    </array>
    <key>Eclipse</key>
    <array>
        <string>-keyring</string>
        <string>~/.eclipse_keyring</string>
        <string>-showlocation</string>
    </array>
</dict>
</plist> 
```

如您所见，我更改了 Eclipse.app 的 Info.plist。但这没有用。我在 Eclipse 中启动 maven。但是 maven 无法下载工件，因为远程存储库不受信任。我认为 Eclipse 不使用我在 Info.plist 中定义的环境变量

你对如何解决这个问题有什么建议吗？

感谢您的回答！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-11T19:31:08.083

不幸的是，这似乎是在 OS X 10.8.x Mountain Lion 中设置全局环境变量的最佳选择：

*   [https://stackoverflow.com/a/588442/705157](https://stackoverflow.com/a/588442/705157)

对于临时环境变量，请在 Terminal.app 中运行此命令，然后重新启动任何需要访问该变量的应用程序：

```
launchctl setenv MYVARIABLE value 
```

要使环境变量在重新启动后`/etc/launchd.conf`保持不变，请为每个变量创建并添加这样的一行，然后重新启动整个系统：

```
setenv MYVARIABLE value 
```

这对我来说可以设置一个全局环境变量，该变量可以由 OS X 10.8.2 上的 IntelliJ IDEA CE 12.0 继承。不是很优雅，但它有效。

或者，您可以在 Terminal.app 中设置环境变量，然后从命令行启动要从中访问环境变量的应用程序。启动的应用程序将从您的终端会话继承环境。在 Terminal.app 中，设置环境变量并使用以下命令启动另一个应用程序`open -a "App Name"`：

```
export MYVARIABLE=value
open -a "IntelliJ IDEA 12 CE" 
```

这将打开 IntelliJ IDEA，我的代码可以`$MYVARIABLE`在其环境中访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:48:07.467

从这里：[https ://stackoverflow.com/a/10374886/325742](https://stackoverflow.com/a/10374886/325742)

```
#!/bin/sh
#
export MAVEN_OPTS=#MAVEN_OPTS_HERE#
LAUNCHER_JAR=/Applications/eclipse/plugins/org.eclipse.equinox.launcher_1.2.0.v20110502.jar

java \
-showversion \
-XX:MaxPermSize=256m \
-Xms1024m \
-Xmx1024m \
-Xdock:icon=/Applications/eclipse/Eclipse.app/Contents/Resources/Eclipse.icns \
-XstartOnFirstThread \
-Dorg.eclipse.swt.internal.carbon.smallFonts \
-Dosgi.requiredJavaVersion=1.5 \
-jar $LAUNCHER_JAR 
```

然后，使用[http://mathiasbynens.be/notes/shell-script-mac-apps](http://mathiasbynens.be/notes/shell-script-mac-apps)上的步骤，将上述脚本转换为可以保留在 Dock 上的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T14:15:23.707

您可以在 Maven 的“调试配置”->“环境”选项卡下直接在 Eclipse 中设置环境变量

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2018-08-04T19:55:36.230

终端窗口的命令步骤：

1.  vi ~/.bash_profile
2.  按 i（使 vi 编辑器进入编辑模式）
3.  在 vi 编辑器窗口中输入环境变量
    *   例如 export JAVA_HOME=/Users/Shared/Jenkins/Home/tools/hudson.model.JDK/java8
4.  esc 键后跟 :wq
5.  源〜/ .bash_profile

# wcf - 带有 ssl 的 WCF net.tcp

> ID：12165389
> 
> 赞同：1
> 
> 时间：2012-08-28T18:36:08.590
> 
> 标签：wcf, ssl, net.tcp

好吧，我正在尝试使用 SSL 加密设置 net.tcp 连接我有以下课程

Wcf 接口：

```
[ServiceContract()]
public interface IServer
{
    [OperationContract]
    void Send(string message);
} 
```

服务器：

```
[ServiceBehavior(InstanceContextMode = InstanceContextMode.Single, ConcurrencyMode = ConcurrencyMode.Multiple, UseSynchronizationContext = false)]
class Server : IServer
{
    readonly ServiceHost host;

    public Server()
    {
        host = new ServiceHost(this);
        host.AddServiceEndpoint(typeof(IServer), Program.GetBinding(), string.Format("net.tcp://localhost:{0}/", 1010));
        host.Credentials.ServiceCertificate.Certificate = Program.LoadCert();
        host.Open();
    }

    public void Send(string message)
    {
        Console.WriteLine(message);
    }
} 
```

程序（客户端/服务器）：

```
class Program
{
    static ChannelFactory<IServer> channelFactory;
    static IServer server;
    static RemoteCertificateValidationCallback callback = null;

    public const int MaxMessageSize = 1024 * 1024 * 2;
    public static Binding GetBinding()
    {
        NetTcpBinding binding = new NetTcpBinding();
        binding.Security.Mode = SecurityMode.Transport;
        binding.Security.Message.ClientCredentialType = MessageCredentialType.None;
        binding.ReaderQuotas.MaxArrayLength = MaxMessageSize;
        binding.ReaderQuotas.MaxBytesPerRead = MaxMessageSize;
        binding.MaxBufferSize = MaxMessageSize;
        binding.MaxReceivedMessageSize = MaxMessageSize;
        binding.MaxBufferPoolSize = binding.MaxBufferSize * 10;
        binding.TransactionFlow = false;
        binding.ReliableSession.Enabled = false;
        binding.Security.Transport.ProtectionLevel = System.Net.Security.ProtectionLevel.EncryptAndSign;
        return binding;
    }

    public static X509Certificate2 LoadCert()
    {
        X509Certificate2 cert = new X509Certificate2();
        cert.Import(@"Test2.pfx", "Test", X509KeyStorageFlags.DefaultKeySet);
        return cert;
    }

    static void Main(string[] args)
    {
        try
        {
            callback = new RemoteCertificateValidationCallback(ValidateCertificate);
            ServicePointManager.ServerCertificateValidationCallback += callback;
            Console.WriteLine("[C]lient or [S]erver?");
            ConsoleKeyInfo key = Console.ReadKey(true);
            if (key.Key == ConsoleKey.S)
            {
                StartServer();
            }
            else if (key.Key == ConsoleKey.C)
            {
                StartClient();
            }
        }
        finally
        {
            if (callback != null)
                ServicePointManager.ServerCertificateValidationCallback -= callback;
        }
    }

    private static void StartClient()
    {
        Console.WriteLine("Starting client mode!");
        Console.Write("Host:");
        string host = Console.ReadLine();
        channelFactory = new ChannelFactory<IServer>(GetBinding());

        server = channelFactory.CreateChannel(new EndpointAddress(string.Format("net.tcp://{0}:{1}/", host, 1010)));
        while (true)
        {
            Console.Write("Message:");
            server.Send(Console.ReadLine());
        }
    }

    private static void StartServer()
    {
        Console.WriteLine("Starting server mode!");
        Server server = new Server();
        Console.ReadKey();
        GC.KeepAlive(server);
    }

    public static bool ValidateCertificate(object sender, X509Certificate cert, X509Chain chain, SslPolicyErrors sslPolicyErrors)
    {
        Console.WriteLine("ValidateCertificate");
        return true;
    }
} 
```

当服务器和客户端都在同一台计算机上运行时，这可以正常工作（但 ValidateCertificate 从未像应有的那样被调用）。

但是，如果我在不同的计算机上运行它们，我会在客户端出现以下异常：

> 说明：进程因未处理的异常而终止。异常信息：System.ServiceModel.Security.SecurityNegotiationException 堆栈：
> 
> 服务器堆栈跟踪：在 System.ServiceModel.Channels.StreamSecurityUpgradeInitiatorBase.InitiateUpgrade(Stream stream) 的 System.ServiceModel.Channels.ConnectionUpgradeHelper.InitiateUpgrade(StreamUpgradeInitiator upgradeInitiator) 的 System.ServiceModel.Channels.WindowsStreamSecurityUpgradeProvider.WindowsStreamSecurityUpgradeInitiator.OnInitiateUpgrade(Stream stream, SecurityMessageProperty& remoteSecurity) , IConnection& 连接, ClientFramingDecoder 解码器, IDefaultCommunicationTimeouts defaultTimeouts, TimeoutHelper& timeoutHelper) 在 System.ServiceModel.Channels.ClientFramingDuplexSessionChannel.SendPreamble(IConnection 连接, ArraySegment`1 前导, TimeoutHelper& timeoutHelper)
> 在 System.ServiceModel.Channels.ConnectionPoolHelper.EstablishConnection(TimeSpan timeout) 在 System.ServiceModel.Channels.ClientFramingDuplexSessionChannel.OnOpen(TimeSpan timeout) 在 System.ServiceModel.Channels.ClientFramingDuplexSessionChannel.DuplexConnectionPoolHelper.AcceptPooledConnection(IConnection 连接，TimeoutHelper 和 timeoutHelper) 在 System. System.ServiceModel.Channels.ServiceChannel.OnOpen（TimeSpan 超时）处的 ServiceModel.Channels.CommunicationObject.Open（TimeSpan 超时）
> 在 System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout) 在 System.ServiceModel.Channels.ServiceChannel.CallOpenOnce.System.ServiceModel.Channels.ServiceChannel.ICallOnce.Call(ServiceChannel channel, TimeSpan timeout) 在 System.ServiceModel.Channels。 System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout) 在 System.ServiceModel 的 ServiceChannel.CallOnceManager.CallOnce(TimeSpan timeout, CallOnceManager cascade)。 Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation) at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message) at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(System.Runtime.Remoting.Messaging.IMessage, System.Runtime.Remoting.Messaging.IMessage) 在 System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(System.Runtime.Remoting.Proxies.MessageData ByRef, Int32) 在 WcfChatTest.Client.Program+IServer.Send (System.String) 在 WcfChatTest.Client.Program.StartClient() 在 WcfChatTest.Client.Program.Main(System.String[])

我配置错了什么，为什么当我提供证书时它调用“WindowsStreamSecurityUpgradeProvider”？

或者，如果其他人有一个很好的例子，如何在 net.tcp 上获得传输加密，而客户端和服务器不在同一个域中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T18:48:46.020

我解决了线上的问题

```
server = channelFactory.CreateChannel(new EndpointAddress(string.Format("net.tcp://{0}:{1}/", host, 1010))); 
```

我必须添加一个使用以下代码创建的附加参数

```
EndpointIdentity.CreateX509CertificateIdentity(certificate) 
```

# oracle - 在一个 excel 中将 pl/sql 输出写入多个 excel 工作表

> ID：12165391
> 
> 赞同：0
> 
> 时间：2012-08-28T18:36:09.810
> 
> 标签：oracle, excel, plsql, plsqldeveloper

> **可能重复：**
> [如何在 Toad for Data Analyst 中将结果导出到 Excel 的不同选项卡中？](https://stackoverflow.com/questions/2135798/how-to-export-the-result-into-different-tabs-of-excel-in-toad-for-data-analyst)

我有一个 pl/sql 代码，其中有两个过程（彼此独立），并且在执行该过程时，我希望将输出写入一个 excel 文件，但其中有两个工作表。

例如：
对于一个程序，输出应在表 1 中

对于下一个程序，输出应在表 2 中。

有人可以帮忙吗？我在用`utl_file`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T11:20:12.867

如果你真的想解决这个问题，这里有一些我在某处捡到的代码。警告：出于我的目的，我放弃了这种方法，因为我发现将 XML 数据加载到 Excel 中太慢了。尽管您丢失了漂亮的格式（在我的情况下并不重要），但加载逗号分隔值文件的速度要快得多。

要使用：

1.  调用`WORKBOOK_OPEN`以初始化表示工作簿的 CLOB。
2.  调用`WORKSHEET_OPEN`以在书中创建工作表。
3.  用于`ROW_OPEN`创建行。
4.  进行一系列调用以`CREATE_CELL`创建和填充行中的单元格。
5.  继续调用`ROW_OPEN`并`CREATE_CELL`创建行和单元格。
6.  完成工作表调用后`WORKSHEET_CLOSE`。
7.  如果您需要再次调用另一个工作表`WORKSHEET_OPEN`来打开另一个工作表，请使用`ROW_OPEN`并`CREATE_CELL`填充它。
8.  完成后，调用`WORKBOOK_CLOSE`以关闭工作簿。
9.  用于`EXPORT_WORKBOOK_TO_FILE`将工作簿写入文件。

请注意，`EXPORT_WORKBOOK_TO_FILE`使用 UTL_FILE 写入其输出，满足您使用 UTL_FILE 的要求。

分享和享受。

```
 PROCEDURE WORKBOOK_OPEN(pWorkbook  IN OUT NOCOPY CLOB) IS
  BEGIN
    pWorkbook := '<?xml version="1.0" encoding="ISO-8859-9"?>' || chr(10) ||
                 '<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"' || chr(10) ||
                           'xmlns:o="urn:schemas-microsoft-com:office:office"' || chr(10) ||
                           'xmlns:x="urn:schemas-microsoft-com:office:excel"' || chr(10) ||
                           'xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"' || chr(10) ||
                           'xmlns:html="http://www.w3.org/TR/REC-html40">' || chr(10) ||
                   '<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">' || chr(10) ||
                     '<WindowHeight>8580</WindowHeight>' || chr(10) ||
                     '<WindowWidth>15180</WindowWidth>' || chr(10) ||
                     '<WindowTopX>120</WindowTopX>' || chr(10) ||
                     '<WindowTopY>45</WindowTopY>' || chr(10) ||
                     '<ProtectStructure>False</ProtectStructure>' || chr(10) ||
                     '<ProtectWindows>False</ProtectWindows>' || chr(10) ||
                   '</ExcelWorkbook>' || chr(10) ||
                   '<Styles>' || chr(10) ||
                     '<Style ss:ID="Default" ss:Name="Normal">' || chr(10) ||
                       '<Alignment ss:Vertical="Bottom"/>' || chr(10) ||
                       '<Borders/>' || chr(10) ||
                       '<Font/>' || chr(10) ||
                       '<Interior/>' || chr(10) ||
                       '<NumberFormat/>' || chr(10) ||
                       '<Protection/>' || chr(10) ||
                     '</Style>' || chr(10) ||
                     '<Style ss:ID="s22">' || chr(10) ||
                       '<Font x:Family="Swiss" ss:Bold="1" ss:Underline="Single"/>' || chr(10) ||
                     '</Style>' || chr(10) ||
                   '</Styles>';
  END WORKBOOK_OPEN;  

  PROCEDURE WORKBOOK_CLOSE(pWorkbook IN OUT NOCOPY CLOB) IS
  BEGIN
    pWorkbook := pWorkbook || '</Workbook>';
  END WORKBOOK_CLOSE;

  PROCEDURE WORKSHEET_OPEN(pWorkbook          IN OUT NOCOPY CLOB,
                           pstrWorksheet_name IN            VARCHAR2) IS
  BEGIN
    --
    -- Create the  worksheet
    --
    pWorkbook := pWorkbook || '<Worksheet ss:Name="' || pstrWorksheet_name || '"><Table>';
  END WORKSHEET_OPEN;

  PROCEDURE WORKSHEET_CLOSE(pWorkbook IN OUT NOCOPY CLOB) IS
  BEGIN
    pWorkbook := pWorkbook || '</Table></Worksheet>';
  END WORKSHEET_CLOSE;

  PROCEDURE ROW_OPEN(pWorkbook IN OUT NOCOPY CLOB) IS
  BEGIN
    pWorkbook := pWorkbook || '<Row>';
  END ROW_OPEN;

  PROCEDURE ROW_CLOSE(pWorkbook IN OUT NOCOPY CLOB) IS
  BEGIN
    pWorkbook := pWorkbook || '</Row>' || chr(10);
  END row_close;

  PROCEDURE CREATE_CELL(pWorkbook          IN OUT NOCOPY CLOB,
                        pstrCell_contents  IN            VARCHAR2) IS
  BEGIN
    pWorkbook := pWorkbook || '<Cell><Data ss:Type="String"> ' ||
                  pstrCell_contents || ' </Data></Cell>';
  END CREATE_CELL;

  PROCEDURE EXPORT_WORKBOOK_TO_FILE(pstrDirectory_name IN VARCHAR2,
                                    pstrFilename       IN VARCHAR2,
                                    pWorkbook          IN CLOB)
  IS
      nChunk_size    CONSTANT BINARY_INTEGER := 32767;
      strChunk       VARCHAR2(32767);
      nPos_chr10     NUMBER;
      nWorkbook_len  NUMBER;
      fHandle        UTL_FILE.FILE_TYPE;
      nPos           NUMBER := 1;
  BEGIN
      nWorkbook_len  := DBMS_LOB.GETLENGTH(pWorkbook);
      fHandle := UTL_FILE.FOPEN(pstrDirectory_name, pstrFilename, 'W', nChunk_size);

      WHILE nPos < nWorkbook_len LOOP
        strChunk := dbms_lob.substr(pWorkbook, nChunk_size, nPos);
        EXIT WHEN strChunk IS NULL;

        nPos_chr10 := INSTR(strChunk, CHR(10), -1);
        IF nPos_chr10 != 0 THEN
          strChunk := SUBSTR(strChunk, 1, nPos_chr10 - 1);
        END IF;

        UTL_FILE.PUT_LINE(fHandle, strChunk, TRUE);

        nPos := nPos + LEAST(LENGTH(strChunk)+1, nChunk_size);
      END LOOP;

      UTL_FILE.FCLOSE(fHandle);
  EXCEPTION
    WHEN OTHERS THEN
      IF UTL_FILE.IS_OPEN(fHandle) THEN
        UTL_FILE.FCLOSE(fHandle);
      END IF;

      RAISE;   
  END EXPORT_WORKBOOK_TO_FILE; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T03:16:20.900

常用方法是使用[Microsoft XML 电子表格 (XMLSS)](http://msdn.microsoft.com/en-us/library/office/aa140066%28v=office.10%29.aspx)创建文件，将内容附加到`VARCHAR`或`CLOB`.

例如，要编写一个单元格，您可以执行以下操作：

```
xmlBody := xmlBody || '<Cell><Data ss:Type="String">' || stringContent || '</Data></Cell>'; 
```

现在，要**打开一个新工作表**，您可以执行以下操作：

```
xmlBody := xmlBody || '<Worksheet ss:Name="' || yourWorksheetName || '"><Table>'; 
```

要关闭它（在附加所有内容之后）：

```
xmlBody := xmlBody || '</Table></Worksheet>'; 
```

有一些实用程序包可以让您执行此操作，或者您可以像我一样编写自己的。您只需编写函数来打开和关闭元素，例如 openRow、closeRow、openWorkbook、closeWorkbook、openWorksheet 等。

有关更多信息和示例，请参阅[代号为“Alexandria”的 Oracle PL/SQL 实用程序库。](http://code.google.com/p/plsql-utils/)

# c - Visual Studio“非法使用这种类型作为表达式”

> ID：12165392
> 
> 赞同：5
> 
> 时间：2012-08-28T18:36:11.103
> 
> 标签：c, visual-studio

我刚刚开始使用 Visual Studio（我从 Dreamspark 获得了 VS 2012，而且不久之后我又开始使用 Windows）并且遇到了一些麻烦。

我的 Source Files 文件夹下有一个名为“main.c”的文件，如下所示：

```
#include <stdio.h>

typedef struct S_s S;
struct S_s {
    void* x;
};

int main(int argc, char** argv)
{
    int N;
    scanf("%d", &N);

    S* s;
    printf("%p", s);

    return 0;
} 
```

当我尝试构建它时，它会给我以下错误消息：

```
Error   3   error C2065: 's' : undeclared identifier    c:\users\math4tots\documents\visual studio 2012\projects\algorithms\lecture1\main.c 13  1   Lecture1
Error   4   error C2065: 's' : undeclared identifier    c:\users\math4tots\documents\visual studio 2012\projects\algorithms\lecture1\main.c 14  1   Lecture1
Error   2   error C2275: 'S' : illegal use of this type as an expression    c:\users\math4tots\documents\visual studio 2012\projects\algorithms\lecture1\main.c 13  1   Lecture1 
```

有趣的是，如果我注释掉该`scanf`行，它就可以构建得很好。

我确实在“Visual C++”选项下创建了一个“空项目”，所以我不确定 VS 是否将它编译为 C 或 C++ 程序。但是，我的印象是我的代码与 C/C++ 无关，以至于它应该在 C 或 C++ 中编译。

在保持程序语义的同时，我能做些什么来构建它？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-28T18:43:13.267

代码是合法的 C++ 和合法的 C99，但不是合法的 C89。C89 中的变量声明必须出现在块的开头，因此在 C89 中使用`S* s;`after`scanf("%d", &N);` 是不行的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T18:43:29.523

没有尝试过，但旧的 C 规则（C99 之前）只允许在块的开头声明自动变量。因此，根据这些规则，干预`scanf`使声明`S* s`非法。注释掉`scanf`“修复”问题。这在 C++ 中一直是合法的。

# php - 模糊 DISTINCT 值

> ID：12165400
> 
> 赞同：8
> 
> 时间：2012-08-28T18:36:42.553
> 
> 标签：php, mysql, loops, distinct, strstr

我有一个房地产列表数据库，需要返回一个社区列表。现在我正在使用 mysql DISTINCT 它返回所有不同的值。我的问题是有很多社区名称相似：例如：

```
Park View Sub 1
Park View
Park View Sub 2
Park View Sub 3
Great Lake Sub 1
Great Lake Sub 2
Great Lake 
Great Lake Sub 3 
```

我正在寻找一个简单的 php 或 mysql 解决方案，它可以识别“Park View”和“Great Lake”已经存在并且只返回“Park View”和“Great Lake”。

我最初的想法是如何按长度获取排序顺序，以便短值位于顶部，然后使用 strstr 循环。这听起来像是一项艰巨的任务，我想知道 mysql 或 php 中是否有一个函数可以轻松执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:54:00.533

以下是您可以尝试的一些事情；大概您正在寻找完全匹配和紧密匹配。

首先寻找完全匹配。然后在 REVERSED 名称上查找 LIKE 匹配项。然后寻找具有最少额外字符的匹配项。

这是一个可以完成所有这些的查询。请注意，如果您希望这样做有效，则需要将反转的地名存储在索引列中。

```
select name 
  from (
   select name, 0 ordinal
     from place 
    where name = 'Park View'
  union
  select name, 1 ordinal
    from place 
   where Reverse(Name) like concat(Reverse('Park View'),'%')
  union
  select name, 2+length(name)
    from place
   where name like concat('Park View','%')
 ) a 
order by ordinal
   limit 1 
```

请注意此 UNION 查询如何`ordinal`用于找出最佳匹配。

在这里查看： [http ://sqlfiddle.com/#!2/76a97/9/0](http://sqlfiddle.com/#!2/76a97/9/0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:41:53.513

如果您总是有一个没有“Sub #”部分的条目，您可以执行以下操作：

```
SELECT DISTINCT neighborhood FROM table WHERE neighborhood NOT LIKE '% Sub %'; 
```

按字符串长度排序：

```
SELECT DISTINCT neighborhood FROM table ORDER BY LENGTH(neighborhood); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T22:08:30.043

下面的示例查询将使用 MySQL 为您提供指定的结果集，但它并没有真正进行“模糊匹配”，至少，这不是我描述算法的方式。（这实现了您描述的算法 - 按值排序，然后检查每个值以查看前导部分是否“匹配”先前检索到的值。）

这会找到邻域值的*前导*部分与先前检索到的行的值的“精确匹配” ，实际上并没有任何关于匹配的“模糊性”。

当查询遇到一个“不匹配”的值时，它会将这个值标记为“不匹配”。对于检索到的下一个值，它检查该值是否以先前“不匹配”的值开头；如果字符串的前导部分完全匹配，则丢弃该值。否则，该值被标记为“不匹配”值，并被保留。

这种方法使用内联视图（或 MySQL 所指的“派生表”）。最里面的内联视图（别名为 s）为我们提供了邻域不同值的排序列表。“技巧”（如果你想这么称呼它）在下一个内联视图（别名为“t”）中，我们使用 MySQL 用户变量来引用以前检索到的值。

为了避免“特殊字符”的任何问题，我们对前导字符进行相等比较。

这是整个查询：

```
SELECT t.neighborhood
  FROM (
         SELECT IF(IFNULL(LEFT(s.neighborhood,CHAR_LENGTH(@match)) <> @match,1),@match := s.neighborhood,NULL) AS neighborhood
           FROM (SELECT RTRIM(neighborhood) AS neighborhood
                   FROM mytable
                   JOIN (SELECT @match := NULL) r
                  GROUP BY neighborhood
                  ORDER BY neighborhood
                ) s
       ) t
 WHERE t.neighborhood IS NOT NULL 
```

这一切都非常简单，除了 @match 变量的初始化，以及执行当前值与前一个值比较的表达式。

如果我们不关心值中特殊字符引入的极端情况，我们可以使用更简单的 LIKE 或 REGEXP 进行比较：

```
s.neighborhood NOT LIKE CONCAT(@match,'%')

s.neighborhood NOT REGEXP CONCAT('^',@match) 
```

LIKE 运算符受下划线和百分号字符的约束，REGEXP 受正则表达式中使用的特殊字符的约束。为了避免这些问题，上面的查询使用了一个看起来有点笨拙的比较：

```
LEFT(s.neighborhood,CHAR_LENGTH(@match)) <> @match 
```

这样做是取上一个值（例如@match := 'Park View'）并将其与下一个值的前导部分（直到'Park View' 的长度）进行比较，确定它是否匹配。

* * *

这种查询方法的一个好处是返回的值保证在后续查询中的谓词中“匹配”。假设您正在使用此查询来获取社区列表，并且用户选择了一个。这将返回一组将“匹配”到每一行的值。

后续查询可以使用简单谓词（WHERE 子句）中的任何返回值来返回匹配的行。例如，如果用户选择了值“Great Lake”：

```
SELECT t.*
  FROM mytable t
 WHERE LEFT(t.neighborhood,CHAR_LENGTH('Great Lake') = 'Great Lake' 
```

在我们使用 LIKE 或 REGEXP 谓词进行匹配的情况下，我们希望在后续查询的谓词中使用相应的匹配：

```
SELECT t.*
  FROM mytable t
 WHERE t.neighborhood LIKE CONCAT('Great Lake','%')

SELECT t.*
  FROM mytable t
 WHERE t.neighborhood REGEXP CONCAT('^','Great Lake') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T18:51:08.577

您可以使用 PHP[`similar_text`](http://php.net/similar_text)来实现一个简单的解决方案。如果您对数据进行预先排序，以便首先使用较短的所需地址，则它应该可以正常工作。此外，如果“不同”地址不太相似，它会更好地工作（但您总是可以提高阈值）：

```
// if an address is 70% (or more) similar to another, it is not unique
$threshold = 70;

// list of addresses (and sorting them); this is done through the DB in your code
$addresses = array('Park View Sub 1', 'Park View', 'Park View Sub 2', 'Park View Sub 3', 'Great Lake Sub 1', 'Great Lake Sub 2', 'Great Lake', 'Great Lake Sub 3');
sort($addresses);

$unique = array();
foreach ($addresses as $address) {
    $isUnique = true;
    foreach ($unique as $u) {
        // get the similarity between the current address and each unique address
        similar_text($address, $u, $percent);
        if ($percent > $threshold) {
            // not unique; drop it
            $isUnique = false;
            break;
        }
    }
    if ($isUnique) $unique[] = $address;
} 
```

对于其他替代方案，您还可以查看 PHP 的[`levenshtein`](http://php.net/manual/en/function.levenshtein.php)and[`soundex`](http://php.net/manual/en/function.soundex.php)以及 MySQL 的[`SOUNDEX()`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_soundex).

另一种伪模糊方法是按字母顺序（通过 MySQL 或 PHP）对地址进行排序，并逐个遍历它们；如果当前地址以已经找到的唯一地址的文本开头，则删除它。这与使用实际的模糊方法非常相似，但它更直截了当：

```
// list of addresses (and sorting them); this is done through the DB in your code
$addresses = array('Park View Sub 1', 'Park View', 'Park View Sub 2', 'Park View Sub 3', 'Great Lake Sub 1', 'Great Lake Sub 2', 'Great Lake', 'Great Lake Sub 3');
sort($addresses);

$unique = array();
foreach ($addresses as $address) {
    $isUnique = true;
    foreach ($unique as $u) {
        if (substr($address, 0, strlen($u)) == $u) {
            $isUnique = false;
            break;
        }
    }
    if ($isUnique) $unique[] = $address;
} 
```

此方法仅在它们被排序时才有效，因为`Park View`需要在之前找到较短的地址`Park View Sub 1`。如果您的地址彼此*过于*相似，并且上述`similar_text`方法下降太多，您可以尝试后一种功能，因为它更严格。

# ruby-on-rails-3 - 有没有办法将 html/css 选项传递给 rails_admin 输入？

> ID：12165405
> 
> 赞同：5
> 
> 时间：2012-08-28T18:36:56.900
> 
> 标签：ruby-on-rails-3, ckeditor, rails-admin

我正在使用 rails_admin，我想在一些输入的管理部分添加一些自定义样式。有没有办法指定额外的类？

就像是：

```
 configure :title, :string do
    css_class 'my-class'
    input_html {:class => 'my-class', :toolbar => 'my-toolbar'}
  end 
```

我似乎找不到可用选项的完整列表。我知道我可以指定`hidden`, `visible`, `ckeditor true`, 和其他一两件事。

我正在使用一些额外的自定义 JS 和 CSS，但我需要能够指定一些 CSS 类以使一切按我想要的方式工作。

具体来说，我正在使用 CKEditor，并且想使用多个工具栏，一个简单的，一个高级的。我已经能够很好地配置 CKEditor，但我找不到让 Rails_admin 使用备用工具栏的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T17:05:09.993

您可以使用 :html_attributes

[https://github.com/sferik/rails_admin/blob/master/lib/rails_admin/config/fields/base.rb#L126](https://github.com/sferik/rails_admin/blob/master/lib/rails_admin/config/fields/base.rb#L126)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-01T21:37:34.200

还有**[css_class](https://github.com/sferik/rails_admin/blob/master/lib/rails_admin/config/fields/base.rb#L31)**。所以你可以有类似的东西：

```
field :your_field do
  css_class do
    # Be sure to not remove the original class 
    # set by #{self.name}_field
    "#{self.name}_field your_custom_class"
  end
end 
```

# .net - 如何获取控制面板的区域和语言设置中指定的日期/时间格式

> ID：12165409
> 
> 赞同：1
> 
> 时间：2012-08-28T18:37:28.807
> 
> 标签：.net, datetime, formatting

我正在尝试完全按照用户在 Windows 控制面板的“区域和语言”页面上指定的格式设置日期和时间。只要我使用一般格式字符串，例如“g”表示一般短日期/时间，这对于用户所做的大多数选择都是半自动的。

但我至少遇到过一个例外。如果我选择格式：“英语（美国）”和短时间：“hh:mm tt”，那么格式会忽略“hh”部分，而是使用“h:mm tt”，即单个没有前导零-数字小时。

```
 // Just testing - to be removed
 string s1 = CultureInfo.CurrentCulture.DateTimeFormat.ShortTimePattern;
 string s2 = CultureInfo.CurrentUICulture.DateTimeFormat.ShortTimePattern; 
```

将上述代码添加到我的程序中可以确认 .Net 使用的是“h:mm tt”而不是“控制面板”页面上指定的“hh:mm tt”。

我可以做些什么来让它使用指定的设置，或者自己确定设置，然后显式获取格式以使用“hh：mm tt”？

# c# - 使用 Single.TryParse 解析浮点数失败

> ID：12165412
> 
> 赞同：2
> 
> 时间：2012-08-28T18:37:43.470
> 
> 标签：c#, floating-point, tryparse

在 MSDN 上有一篇关于 Single.TryParse 的文章，其中包含此示例代码：http: [//msdn.microsoft.com/en-us/library/26sxas5t%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/26sxas5t%28v=vs.100%29.aspx)

```
// Parse a floating-point value with a thousands separator.
value = "1,643.57";
if (Single.TryParse(value, out number))
    Console.WriteLine(number);
else
    Console.WriteLine("Unable to parse '{0}'.", value); 
```

问题在文章中 TryParse 返回`true`并且字符串被转换，但是当我尝试它时，它是`false`. 我该如何解决？

* * *

**UPD：**为了简化解析，可以使用这两行：

```
NumberStyles style = System.Globalization.NumberStyles.Any;
CultureInfo culture = CultureInfo.InvariantCulture; 
```

此设置允许解析带有前导和尾随空格字符的负浮点数和字符串。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:41:39.583

你需要像这样设置文化

```
using System.Globalization;

string value = "1345,978";
NumberStyles style = System.Globalization.NumberStyles.AllowDecimalPoint;
CultureInfo culture = System.Globalization.CultureInfo.CreateSpecificCulture("fr-FR");
if (Single.TryParse(value, style, culture, out number))
   Console.WriteLine("Converted '{0}' to {1}.", value, number);
else
   Console.WriteLine("Unable to convert '{0}'.", value); 
```

来自 msdn：[Single.TryParse 方法（字符串、NumberStyles、IFormatProvider、Single%）](http://msdn.microsoft.com/en-us/library/0xh24xh4.aspx)

或者

```
float usedAmount;
// try parsing with "fr-FR" first
bool success = float.TryParse(inputUsedAmount.Value,
                              NumberStyles.Float | NumberStyles.AllowThousands,
                              CultureInfo.GetCultureInfo("fr-FR"),
                              out usedAmount);

if (!success)
{
    // parsing with "fr-FR" failed so try parsing with InvariantCulture
    success = float.TryParse(inputUsedAmount.Value,
                             NumberStyles.Float | NumberStyles.AllowThousands,
                             CultureInfo.InvariantCulture,
                             out usedAmount);
}

if (!success)
{
    // parsing failed with both "fr-FR" and InvariantCulture
} 
```

在这里回答：[C# float.tryparse 用于法国文化](https://stackoverflow.com/questions/2722831/c-sharp-float-tryparse-for-french-culture)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:39:51.627

你对你的文化有问题： **，**性格

你可以`CultureInvariant`在你的字符串中使用

# ruby-on-rails - Heroku 部署问题 - 500 内部服务器错误

> ID：12165420
> 
> 赞同：1
> 
> 时间：2012-08-28T18:38:08.977
> 
> 标签：ruby-on-rails, heroku, ruby-on-rails-3.2

我搜索了整个堆栈溢出和网络并尝试了各种修复，但我仍然无法让我的 rails 应用程序在 heroku 上运行。我一直收到“我们很抱歉，但出了点问题”。来自heroku的错误。

该应用程序在我的本地环境中运行良好。

我做了以下事情：

*   运行“heroku rake run db:migrate”
*   验证我的资产正在正确编译：[https ://devcenter.heroku.com/articles/rails3x-asset-pipeline-cedar](https://devcenter.heroku.com/articles/rails3x-asset-pipeline-cedar)
*   实现了瘦服务器并创建了一个 procfile，如下所示：[https ://devcenter.heroku.com/articles/rails3](https://devcenter.heroku.com/articles/rails3)

非常感谢您帮助分析我的 heroku 日志文件（如下）以找出导致此错误的原因。

我的应用程序在 Rails 3.2.7、Ruby 1.9.3 上运行，并使用 postgres 作为数据库

```
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_controller/metal/instrumentation.rb:40:in `block (2 levels) in render'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/core_ext/benchmark.rb:5:in `block in ms'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_controller/metal/instrumentation.rb:40:in `block in render'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_controller/metal/instrumentation.rb:83:in `cleanup_view_runtime'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/ruby-1.9.3/lib/ruby/1.9.1/benchmark.rb:295:in `realtime'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/core_ext/benchmark.rb:5:in `ms'
2012-08-28T17:55:58+00:00 heroku[router]: GET glacial-headland-3472.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=267ms status=500 bytes=643
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.7/lib/active_record/railties/controller_runtime.rb:24:in `cleanup_view_runtime'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_controller/metal/instrumentation.rb:39:in `render'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_controller/metal/implicit_render.rb:10:in `default_render'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_controller/metal/implicit_render.rb:5:in `send_action'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/abstract_controller/base.rb:167:in `process_action'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_controller/metal/rendering.rb:10:in `process_action'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/abstract_controller/callbacks.rb:18:in `block in process_action'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/callbacks.rb:414:in `_run__3080287486243242199__process_action__1142231311061748289__callbacks'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/callbacks.rb:405:in `__run_callback'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/abstract_controller/callbacks.rb:17:in `process_action'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_controller/metal/rescue.rb:29:in `process_action'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/callbacks.rb:81:in `run_callbacks'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/notifications.rb:123:in `block in instrument'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/notifications.rb:123:in `instrument'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_controller/metal/instrumentation.rb:29:in `process_action'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.7/lib/active_record/railties/controller_runtime.rb:18:in `process_action'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/abstract_controller/rendering.rb:45:in `process'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_controller/metal.rb:246:in `block in action'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/abstract_controller/base.rb:121:in `process'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7
/lib/action_controller/metal.rb:203:in `dispatch'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/routing/route_set.rb:73:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/routing/route_set.rb:36:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:68:in `block in call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `each'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/routing/route_set.rb:600:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:35:in `block in call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:34:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:34:in `catch'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/etag.rb:23:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/middleware/head.rb:14:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/conditionalget.rb:25:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/middleware/params_parser.rb:21:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/middleware/flash.rb:242:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:205:in `context'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/middleware/cookies.rb:338:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:200:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.7/lib/active_record/query_cache.rb:64:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.7/lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/callbacks.rb:405:in `_run__1576820621715372704__call__3414544984041752206__callbacks'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/callbacks.rb:405:in `__run_callback'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/callbacks.rb:81:in `run_callbacks'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/middleware/callbacks.rb:27:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/rack/logger.rb:26:in `call_app'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/rack/logger.rb:16:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/middleware/request_id.rb:22:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.7/lib/active_support/cache/strategy/local_cache.rb:72:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.7/lib/action_dispatch/middleware/static.rb:62:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:66:in `call!'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:185:in `lookup'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/engine.rb:479:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/content_length.rb:14:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/application.rb:220:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/rack/log_tailer.rb:17:in `call'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:80:in `block in pre_process'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:78:in `catch'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:78:in `pre_process'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:53:in `process'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:38:in `receive_data'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/server.rb:159:in `start'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/backends/base.rb:63:in `start'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:265:in `start'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/handler/thin.rb:13:in `run'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/commands/server.rb:70:in `start'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/commands.rb:55:in `block in <top (required)>'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/commands.rb:50:in `tap'
2012-08-28T17:55:58+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/commands.rb:50:in `<top (required)>'
2012-08-28T17:55:58+00:00 app[web.1]:   script/rails:6:in `require'
2012-08-28T17:55:58+00:00 app[web.1]:   script/rails:6:in `<main>'
2012-08-28T17:55:58+00:00 app[web.1]: 
2012-08-28T17:55:58+00:00 app[web.1]: Processing by StaticPagesController#index as HTML
2012-08-28T17:55:58+00:00 app[web.1]: 
2012-08-28T17:55:58+00:00 app[web.1]: Completed 500 Internal Server Error in 68ms
2012-08-28T17:55:59+00:00 heroku[router]: GET glacial-headland-3472.herokuapp.com/favicon.ico dyno=web.1 queue=0 wait=0ms service=8ms status=200 bytes=0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:09:53.350

我继续寻找堆栈溢出的解决方案，并在这里找到了答案； [Rails & Heroku：很抱歉，出了点问题](https://stackoverflow.com/questions/10366394/rails-heroku-were-sorry-but-something-went-wrong?rq=1)

我从资产组（和文件的 platop）中删除了我的“haml-rails”gem，这解决了我的问题。

# java - SWT Table、TableViewer、数据变化刷新表

> ID：12165424
> 
> 赞同：3
> 
> 时间：2012-08-28T18:38:24.660
> 
> 标签：java, swt

我急需一些有指导的帮助。我已经能够完成并开始使用 Tables 和 TableViewers 的代码示例。但是我没有找到任何示例来帮助我进行粒子设置。

请指导我正确的方向。

我的课程：

AHandler.java - 这允许用户从鼠标右键单击中选择数据。在执行期间，我正在调用一个单例类来将用户选择的数据添加到数组列表中。

```
ASelectedData.getInstance().add(tcRevision, selectedDataset); 
```

ASelectedData.java - 是将用户选择添加到 ArrayList 的单例类。

ABase.java - 通过单击菜单打开此对话框。该对话框应显示一个包含 ArrayList 值的表。执行其他操作的一些按钮。

我现在拥有的方式是在 ABase.java 类中创建表和表查看器。我正在从中提取表格的信息。

```
 viewer.setContentProvider(new ArrayContentProvider());
 viewer.setInput(AplotSelectedDataTable.getInstance().getArrayData()); 
```

这将使用正确的数据填充表。

但是 ABase.java 类是 MODELESS。那么为什么打开该对话框，用户可以继续使用鼠标右键选择数据并添加到数组列表中。但是我对表格进行编码的方式是我必须重新打开窗口来更新数据。

***** 编辑 *** ***** 在我的主 GUI 中，我创建了一个 TableViewer。TableViewer 创建一个表，该表在单独的类中显示来自 arraylist 的数据。问题是用户仍然能够转到主应用程序 GUI（不是我的应用程序 GUI）并在我的 GUI 仍然打开时选择更多数据。他们希望在选择表格时看到添加到表格中的新数据。**

 **问题是我无法告诉表格新数据已经到达所以刷新表格。获取数据并将其添加到 ArrayList 的 Add 方法位于 ASelectedData 类中。不是创建 tableviewer 的类。

执行 Add Method 时，我需要一种方法来告诉表刷新。问题是表和方法在两个单独的类中。

希望这更有意义

**编辑***

我使用 TableViewer 的主要 GUI

```
public AplotBaseDialog(Shell shell, TCSession theSession) Constructor

//////////////////////////////////////////////////////////////////////////
//                         createTableViewer()                          //
//////////////////////////////////////////////////////////////////////////
private TableViewer createTableViewer(Composite parent) {
   viewer = new TableViewer(parent, SWT.MULTI | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION | SWT.BORDER);
   createColumns(parent, viewer);
   Table table = viewer.getTable();
   table.setHeaderVisible(true);
   table.setLinesVisible(true);

   viewer.setContentProvider(new ArrayContentProvider());
   viewer.setInput(AplotSelectedDataTable.getInstance().getArrayData());

   // Layout the viewer
   GridData gridData = new GridData();
   gridData.verticalAlignment = GridData.FILL;
   gridData.horizontalSpan = 2;
   gridData.grabExcessHorizontalSpace = true;
   gridData.grabExcessVerticalSpace = true;
   gridData.horizontalAlignment = GridData.FILL;
   viewer.getControl().setLayoutData(gridData);
   return viewer;
 }

//////////////////////////////////////////////////////////////////////////
//                            updateTableViewer()                       //
//////////////////////////////////////////////////////////////////////////
public void updateTableViewer() {
   viewer.refresh();
} 
```

添加到其他类的代码

```
 AplotBaseDialog abd = new AplotBaseDialog(null, null);

  public void add(TCComponentItemRevision tcRevision, TCComponentDataset selectedDataset) {
   AplotDatasetData pp = new AplotDatasetData(tcRevision, selectedDataset);
   if (!dataArrayList.contains(pp)) {
      dataArrayList.add(pp);

   }
   abd.updateTableViewer();
  }// end add() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T19:02:54.837

尽管您的问题尚未完成，但我会尝试猜测您的问题：您有`TableViewer`a`Dialog`并且可以`ModelProvider`从主 GUI 编辑。现在您想知道如何更新表格，当您向模型添加内容时，是否正确？

如果是这样，您可以在对话框中提供一个可以更新`TableViewer`对话框中的方法。像这样的东西：

```
public void updateTableViewer()
{
    if(viewer != null)
        viewer.refresh();
} 
```

当您向`ModelProvider`.

如果这不是您的问题，请更新您的原始帖子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-26T06:39:33.107

在创建控件中添加这串代码可能会解决您的问题：

```
ResourcesPlugin.getWorkspace().addResourceChangeListener(new IResourceChangeListener() {
    @Override
    public void resourceChanged(IResourceChangeEvent event) {
        treeViewer.refresh();
    }
}); 
```**

# android - 清除 ListView 的视图缓存

> ID：12165430
> 
> 赞同：0
> 
> 时间：2012-08-28T18:39:14.830
> 
> 标签：android, listview

我有一个 ListView，我进行了一些复杂的编码。该列表经常随着需要不同视图的不同类型的数据而变化。在极少数情况下，我最终会得到 1 个视图被 Android 重复用于应该看起来不同的行。它似乎只在显示的数据发生根本变化时才会发生。我希望有一种方法可以以编程方式清除 ListView 的内存。这可能吗？

这是我的getView的开始：

```
@Override
        public View getView(int position, View convertView, ViewGroup parent) {
            SearchHolder holder = null;
            int type = getItemViewType(position);

            if (null == convertView) {
                holder = new SearchHolder();
                if (type == SEARCH_TYPE_FREETEXT) {
                    convertView = mInflater.inflate(R.layout.layout_search_item_freetext, null);
                    holder.txtText = (TextView) convertView.findViewById(R.id.search_itemname);
                    holder.vHeaderWrapper = (LinearLayout) convertView.findViewById(R.id.search_headerwrapper);
                    holder.txtHeader = (TextView) convertView.findViewById(R.id.search_header);
                }
                else {
                    if (items.get(position).mData == null) {
                        convertView = mInflater.inflate(R.layout.layout_loadmoreresults_white, null);
                    }
                    else {
                        convertView = mInflater.inflate(R.layout.layout_search_item, null);
                        holder.txtText = (TextView) convertView.findViewById(R.id.search_itemname);
                        holder.vHeaderWrapper = (LinearLayout) convertView.findViewById(R.id.search_headerwrapper);
                        holder.txtHeader = (TextView) convertView.findViewById(R.id.search_header);
                    }
                }
                convertView.setTag(holder);
            }
            else {
                holder = (SearchHolder)convertView.getTag();
            }
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:57:42.047

如果您对列表项使用多个布局，那么我建议每次在 getView() 方法中从 xml 中填充适当的布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:10:29.863

当您滚动列表时，ListView 会执行称为“回收”的操作，您需要做的是覆盖`getView()`更新正在回收的单个 listView 项目的方法。默认情况下，android 不会清除这些视图。查看 ListView 回收的以下链接：

[http://mobile.cs.fsu.edu/the-nuance-of-android-listview-recycling-for-n00bs/](http://mobile.cs.fsu.edu/the-nuance-of-android-listview-recycling-for-n00bs/)

如果没有代码，很难判断您是否已经知道这一点，但根据我的经验，这是造成此类问题的原因。

# html - 我希望鼠标悬停时背景为黑色，文本为白色，鼠标移出时背景为白色，文本为黑色

> ID：12165444
> 
> 赞同：0
> 
> 时间：2012-08-28T18:40:11.270
> 
> 标签：html, css, background-color

我找到了这个很棒的教程[http://tympanus.net/codrops/2011/07/12/animated-text-and-icon-menu/](http://tympanus.net/codrops/2011/07/12/animated-text-and-icon-menu/)

我遇到了一些事情：

例如，我希望鼠标悬停时背景为黑色，文本为白色，鼠标移出时背景为白色，文本为黑色。我怎样才能做到这一点？

因为每次我尝试在鼠标悬停时更改背景颜色时，文本都会在鼠标移出时获得相同的背景颜色。

感谢大家 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T18:43:18.347

尝试这个：

```
<a class="my_link" href="#">Link</a> 
```

CSS

```
.my_link {
  color: black;
  background-color: white;
}

.my_link:hover {
  color: white;
  background-color: black;
} 
```

演示：http: [//jsfiddle.net/YXPFh/](http://jsfiddle.net/YXPFh/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:46:38.280

```
<div class='your-class'>content</div>
<style type="text/css">
.your-class {
  color: black;
  background-color: white;
}
.your-class:hover {
 /* new rules */
}
</style> 
```

# ruby-on-rails - 在后台作业中完成后生成 CSV 并将其上传到 S3

> ID：12165450
> 
> 赞同：4
> 
> 时间：2012-08-28T18:40:34.420
> 
> 标签：ruby-on-rails, csv, heroku, paperclip, sidekiq

我为用户提供了通过 CSV 下载大量数据的能力。为此，我正在使用 Sidekiq 并在他们启动后将任务放到后台作业中。我在后台工作中所做的是生成一个包含所有正确数据的 csv，将其存储在其中`/tmp`，然后调用 save！在我的模型上，将文件的位置传递给回形针属性，然后该属性会关闭并存储在 S3 中。

所有这些在本地都运行良好。我现在的问题在于 Heroku，它能够根据您所在的节点在短时间内存储文件。由于 Heroku 处理这些文件的方式，我的后台作业无法找到保存的 tmp 文件。我想我正在寻找更好的方法来做到这一点。如果有某种方式可以在内存中完成所有事情，那就太棒了。唯一的问题是，当您保存模型时，回形针需要一个实际的文件对象作为属性。这是我的背景工作的样子：

```
class CsvWorker
  include Sidekiq::Worker

  def perform(report_id)
    puts "Starting the jobz!"
    report = Report.find(report_id)
    items = query_ranged_downloads(report.start_date, report.end_date)

    csv = compile_csv(items)

    update_report(report.id, csv)
  end

  def update_report(report_id, csv)
    report = Report.find(report_id)
    report.update_attributes(csv: csv, status: true)
    report.save!
  end

  def compile_csv(items)
    clean_items = items.compact
    path = File.new("#{Rails.root}/tmp/uploads/downloads_by_title_#{Process.pid}.csv", "w")
    csv_string = CSV.open(path, "w") do |csv|
      csv << ["Item Name", "Parent", "Download Count"]
      clean_items.each do |row|
        if !row.item.nil? && !row.item.parent.nil?
        csv << [
          row.item.name,
          row.item.parent.name,
          row.download_count
          ]
        end
      end
    end

    return path
  end
end 
```

*为了便于阅读，我省略了查询方法。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T05:19:00.640

我不认为 Heroku 的临时文件存储是这里的问题。围绕它的警告主要围绕以下事实： a) dynos 是短暂的，所以你写的任何东西都可以而且会在没有通知的情况下消失；b) dyno 是可互换的，因此当您运行多个 web dyno 时，请求间临时文件的存在是运气问题。但是，在任何情况下，临时文件都不会在您的工作人员运行时消失。

我注意到的一件事是，您实际上是在创建两个同名的临时文件：

```
> path = File.new("/tmp/filename", "w")
 => #<File:/tmp/filename> 
> path.fileno
 => 3 
> CSV.open(path, "w") do |csv| csv << %w(foo bar baz); puts csv.fileno end
4
 => nil 
```

您可以更改该`path =`行以仅设置文件名（而不是打开它进行写入），然后`update_report`打开文件名进行读取。当你给它一个空的、已经覆盖的、为写入而打开的文件句柄时，我还没有深入研究 Paperclip 的作用，但是改变这个流程可能会解决这个问题。

或者，您可以在内存中执行此操作：将 CSV 生成为字符串并将其作为 StringIO 提供给 Paperclip。（Paperclip 支持某些非文件对象，包括 StringIO，使用例如[Paperclip::StringioAdapter](http://rubydoc.info/gems/paperclip/Paperclip/StringioAdapter)。）尝试类似：

```
# returns a CSV as a string
def compile_csv(items)
  CSV.generate do |csv|
     # ...
  end
end

def update_report(report_id, csv)
  report = Report.find(report_id)
  report.update_attributes(csv: StringIO.new(csv), status: true)
  report.save!
end 
```

# facebook - iOS 游戏和 Facebook 游戏：相同的应用程序 ID？

> ID：12165451
> 
> 赞同：0
> 
> 时间：2012-08-28T18:40:38.427
> 
> 标签：facebook

我已经为 iOS 构建了一个使用 Facebook Connect 的游戏，我将制作同一游戏的 Facebook 版本。我是否对两个游戏使用相同的应用 ID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:32:38.363

是的，您会为两个游戏使用相同的应用程序 ID。在应用程序设置的“基本”选项卡中，您可以指定应用程序将使用的格式。这意味着您不必让您的用户对 2 个不同的应用程序进行身份验证（我假设您可能希望他们使用这两个版本）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-28T18:45:19.447

现在的情况，您无法从应用程序管理屏幕执行此操作。或者至少对于网站应用程序和 facebook 应用程序不可能使用相同的应用程序 ID（您必须输入网站的 url）

# python - 使用 lxml 和 xpath 解析 Html

> ID：12165452
> 
> 赞同：3
> 
> 时间：2012-08-28T18:40:42.923
> 
> 标签：python, xpath, html-parsing, lxml

我正在尝试将 lxml 与 python 一起使用，因为在阅读并执行谷歌建议后，将 lxml 用于其他解析包。我有以下 dom 结构，我管理编写正确的 xpath，我在 xpath 检查中仔细检查我的 xpath 以确认它的有效性。Xpath 在 Xpath Checker 上运行良好，但是当我将它与 python 中的 lxml 一起使用时，我没有得到结果，我得到的是对象而不是实际的文本。

这是我的dom结构：

```
<div class="pdsc-l">
<table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody>
<tr>
<tr>
<tr>
<tr>
<tr>
<tr>
<td width="35%" valign="top">
<font size="2" face="Arial, Helvetica, sans-serif">Brand</font>
</td>
<td width="65%" valign="top">
<font size="2" face="Arial, Helvetica, sans-serif">HTC</font>
</td>
</tr>
<tr>
<td width="35%" valign="top">
<td width="65%" valign="top"> 
```

遵循我写的 xpath 给了我我想要的东西..

```
//td//font[text()='Brand']/following::td[1] 
```

但是使用 lxml 我不会得到结果：

```
This is my code:
    rawPage = urllib2.urlopen(request)
    read = rawPage.read()
    #print read
    tree = etree.HTML(read)    
    for tr in tree.xpath("//tr"):
        print tr.xpath("//td//font[text()='Brand']/following::td[1]") 
```

这是输出

```
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>]
[<Element td at 0x10ad80b90>] 
```

我尝试了以下更改，但仍然没有得到结果，我编写的代码有 url，希望这将有助于获得更好的答案：

```
from lxml import etree
from lxml.html import fromstring, tostring
    url = 'http://www.ebay.com/ctg/111176858'
    request = urllib2.Request(url)
    rawPage = urllib2.urlopen(request)
    read = rawPage.read()
    #print read
    tree = etree.HTML(read)    
    for tr in tree.xpath("//tr"):
        t = tr.xpath("//td//font[text()='Brand']/following::td[1]")[0]
        print tostring(t) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-28T18:48:29.230

在答案中的 print 语句末尾附加 a`[0].text`应该可以满足您的需求。基本上，您的问题中打印的是`lxml.etree._Element`s 的单元素列表，它们具有类似的属性`tag`，`text`您可以使用这些属性来获取不同的属性。所以，试试

```
tr.xpath("//td//font[text()='Brand']/following::td[1]")[0].text 
```

# java - Swing 和 iText 字体渲染的区别

> ID：12165453
> 
> 赞同：1
> 
> 时间：2012-08-28T18:40:47.247
> 
> 标签：java, swing, pdf, itext

我正在构建一个应用程序，其中允许用户使用图层将文本插入 PDF 中。

可以使用应用程序设置 PDF 页面中文本的位置，该应用程序使用JPanel 内的[ICEPdf](http://www.icesoft.org/projects/ICEpdf/overview.jsf)呈现 PDF 。[选择图层的位置和大小后，应用程序使用iText](http://itextpdf.com/) (v. 5.3.2)将其呈现为 PDF 。

我面临的问题是 Swing 的字体渲染与 PDF 中的最终结果明显不同。

以下是一些屏幕截图，都在同一个边界框内使用 Helvetica 纯字体：

使用 Swing 渲染文本：

```
protected void paintComponent(Graphics g){
      //for each line...
      g.drawString(text, b0, b1);
      //b0 and b1 are computed from the selected bounding box for the text
} 
```

我有这个：

![摇摆渲染](../Images/acbcc970eb205fd10d26a3e8b8034209.png)

使用 iText 渲染文本：

```
PdfTemplate t; //PdfTemplate is created elsewhere
ColumnText ct = new ColumnText(t);
ct.setRunDirection(PdfWriter.RUN_DIRECTION_NO_BIDI);
ct.setSpaceCharRatio(1);
ct.setSimpleColumn(new Phrase(text, font), b0, b1, b3, b4, font.getSize(), Element.ALIGN_BOTTOM); 
//b0, b1, b2 and b3 are the bounding box of the text
ct.go(); 
```

我有这个：

![PDF 渲染](../Images/afd43e0076dd53d2b61ab9b5e72cdbcf.png)

那么问题来了：怎样才能让 Swing 和 iText 以完全相同的方式渲染字体呢？我可以调整 Swing 或 iText，因此无论修改什么代码，我都需要为用户提供真正的[所见即所得](http://en.wikipedia.org/wiki/WYSIWYG)体验。

我尝试了其他字体和类型，但它们之间仍然存在一些差异。我想我缺少一些配置。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T22:34:37.760

编辑：

Java 中的字体以像素为单位，而 iText 以点为单位，我们知道每英寸有 72 个点，而对于标准的 Windows 机器，每英寸有 96 个像素/dpi。

首先我们需要找到一个点和一个像素之间的区别：

```
difference = 72 / dpi
      0.75 = 72 / 96 
```

接下来我们可以将Java字体大小与差值相乘得到iText字体大小，如果java字体大小为16，那么与96dpi一起使用时iText字体大小应为12。

```
iTextFontSize = difference x javaFontSize
           12 = 0.75 x 16 
```

在 Windows 机器上 96dpi 通常是标准，但请记住，并非总是如此，您应该为每台不同的机器计算它。

* * *

原帖

我相信差异是由渲染提示引起的。

解决方案1：

最好的方法是在缓冲图像上绘制所有内容。然后缓冲图像被绘制到摆动组件，并且完全相同的缓冲图像也被绘制到 PDF，这样它们之间应该没有区别。

替代想法：

另一个可能效果不佳但与现有代码配合得更好的想法是将 swing 组件的内容直接绘制到缓冲图像，然后将缓冲图像绘制到 PDF。

以下是一个快速示例，它将使用一些不同的呈现提示将 JPanel 的内容绘制到缓冲图像。（更改提示以适合您的挥杆组件）

```
public BufferedImage createImage(JPanel panel)
{
    BufferedImage swingComponent = new BufferedImage(
            panel.getHeight(), panel.getWidth(), 
            BufferedImage.TYPE_INT_RGB);

    Graphics2D g = swingComponent.createGraphics();

    g.setRenderingHint(RenderingHints.KEY_RENDERING,
                       RenderingHints.VALUE_RENDER_QUALITY);

    g.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                       RenderingHints.VALUE_ANTIALIAS_ON);

    g.setRenderingHint(RenderingHints.KEY_INTERPOLATION,
                       RenderingHints.VALUE_INTERPOLATION_BILINEAR);

    g.dispose();
    return swingComponent; //print this to your PDF
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-18T20:23:11.497

> 那么问题来了：怎样才能让 Swing 和 iText 以完全相同的方式渲染字体呢？

*完全*一样吗？很少。假设您为两者提供相同的字体特征，渲染中可能仍然存在差异。

PDF 文件（或者实际上是文本短语）包含字体信息——系列、大小、样式等——但将文本呈现到设备的是您的 PDF 阅读器。根据您使用的程序，它可以使用平台的渲染器，也可以选择自己的一个。

AFAIK，Java Swing 使用自己的字体渲染引擎，与底层平台的渲染器不同。这使得它在跨平台看起来更加一致，但也使得文本不太可能以与任何其他程序相同的方式呈现。

知道这一点，您的选择是有限的：

*   使用同样使用 Swing 字体渲染的 PDF 阅读器。这是一个相当有限的解决方案。

*   使用您平台的渲染引擎绘制到 Swing。这听起来像是一个不确定的工作，也像是 SWT 可以解决的问题。也许你可以嵌入一个 SWT 组件？

# google-apps-script - 删除修订历史

> ID：12165454
> 
> 赞同：9
> 
> 时间：2012-08-28T18:40:52.203
> 
> 标签：google-apps-script, google-sheets

我正在使用 Google Apps 脚本对电子表格中的数据进行加密。它工作正常，但电子表格中方便的修订历史使它有点争议，因为您可以简单地查看加密之前的版本。

有没有办法删除修订历史，或者简单地防止它们被一起创建？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-05-12T20:32:02.423

不会。用于访问修订历史记录的 Drive [API](https://developers.google.com/drive/v3/reference/revisions/delete)不会删除 Google 表格上的条目。

需要注意的修订历史只有具有编辑权限的人才能查看。仅查看或评论权限无法查看修订历史记录。

一种解决方案是让用户通过 Google 表单将数据提交到一个非常狭窄的共享表，并设置一个触发器以将您未加密的非敏感元/聚合数据复制到一个更公开的表中，以供不受信任的用户和脚本访问。单元格公式 IMPORTRANGE() 也可以工作，它从输入公式的人那里获得访问权限，因此可以将数据从受限制的电子表格移动到限制较少的电子表格，而不会损害原始表格。

第二种解决方案稍微麻烦一些，但更接近您的要求，即为用户和外部脚本提供对包含工作表的驱动器文件夹的访问权限。有了文件夹的ID，脚本就可以通过[驱动api](https://developers.google.com/apps-script/reference/drive/folder)按名称搜索工作表，用户用眼睛按名称查找。您的加密脚本在完成加密后，使用[SpreadsheetApp.copy(name)复制电子表格](https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet#copyname)这将复制所有的公式、格式、数据，甚至脚本，但不会复制修订历史。传递 copy() 与原始工作表相同的名称，驱动器文件名不必是唯一的。使用 drive api 将新的电子表格移动到文件夹，它应该默认继承文件夹的共享。再次使用驱动 API 删除原始电子表格。因为所有用户和脚本都在特定文件夹 ID 中查找名为 X 的文件，所以一切仍然完全在他们期望的位置，但修订历史已消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T17:14:43.730

不幸的是，Google Apps 脚本没有提供从修订历史记录中删除项目的方法。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-03-26T17:04:18.993

复制所有电子表格，恢复到第一个版本，然后粘贴电子表格:)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-02-13T13:53:20.873

对于 Google 文档，我设法通过制作文档副本来摆脱修订历史记录。不确定这是否也适用于电子表格。

# .net - 以编程方式强制 TextBox 值从 V 到 VM？

> ID：12165471
> 
> 赞同：0
> 
> 时间：2012-08-28T18:42:15.403
> 
> 标签：.net, wpf, xaml, data-binding, mvvm

双向绑定效果很好，但在 TextBox 的情况下，它会在控件失去焦点时发生。

就我而言，我有一个简单的 UI，带有 1 个文本框和提交/取消按钮。

提交按钮在视图上设置为默认值。因此，用户可以在文本框中输入文本并点击“Enter”，这将调用提交的命令。这很好，但我需要从 TextBox 访问值，它不在 VM 中，因为 TextBox 没有失去焦点。如何强制从我的代码更新此 binging？

```
<TextBox
    Text="{Binding Comment, Mode=TwoWay}"
    Grid.Row="2"/>

<StackPanel
    Grid.Row="3"
    HorizontalAlignment="Right"
    Orientation="Horizontal">
    <Button 
        Padding="20,5"
        Margin="5"
        Command="{Binding CancelCommand}"
        Content="Cancel" IsCancel="True" />
    <Button 
        Padding="20,5"
        Margin="5"
        Command="{Binding SubmitCommand}"
        Content="Submit" IsDefault="True" />
</StackPanel> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:45:07.237

在 TextBox 绑定上使用 UpdateSourceTrigger=PropertyChanged。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:01:02.603

UpdateSourceTrigger=PropertyChanged 将导致在每次击键时更新源。这是最简单的方法。如果您不想或不需要如此频繁地更新源，您也可以通过执行以下代码强制更新：

```
 BindingExpression expression = TextBoxDescription.GetBindingExpression(TextBox.TextProperty);
        expression.UpdateSource(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T19:02:45.770

如果您不想在每次按键后而是在按下提交按钮后更新 VM，您可以在视图上使用 BindingGroup。然后在您的命令处理程序中，您首先调用 BindingGroup.Commit，然后调用 VM 上的提交方法。这不适用于通常的 VM RelayCommand，但您可以创建我称之为粘性命令的东西，以封装此功能。

粘性命令是一个小组件，它通过附加属性附加到 XAML 中的视图，注册命令处理程序，并配置为使用反射调用 VM 上的方法。如果您愿意，可以在[http://wpfglue.wordpress.com](http://wpfglue.wordpress.com)上阅读它。

# c# - 在 c#/asp.net 中直接将soap xml 发布到Web 服务

> ID：12165472
> 
> 赞同：1
> 
> 时间：2012-08-28T18:42:15.617
> 
> 标签：c#, asp.net, web-services, soap

我正在尝试将 XML 直接发布到 Web 服务，而不是使用 VS 的“添加 Web 引用...”功能。这是有充分理由的。为了获得正确的测试 XML，我记录了使用标准 Web 参考生成的内容。我使用了在这个问题[Capturing SOAP requests to an ASP.NET ASMX web service中找到的内容](https://stackoverflow.com/questions/2624621/capturing-soap-requests-to-an-asp-net-asmx-web-service)

Web 服务就是在 Visual Studio 中创建新的 Web 服务时生成的，没什么特别的。

[为了尝试传递 XML 本身，我从这个问题Client to send SOAP request and received response 中](https://stackoverflow.com/questions/4791794/c-sharp-client-send-soap-request-and-get-results)借用了代码

不幸的是，当我调用它时，我得到“远程服务器返回错误：（500）内部服务器错误。” 如果我像这样调用相同的网络方法，则为 100%

```
WebService1 ws = new WebService1();
String output = ws.HelloWorld(); 
```

然后一切正常，所以我知道该服务在部署时运行良好。我会非常感谢一些关于我做错了什么的建议=）

这是我的代码：

```
var _url = "http://localhost/simulator/webservice1.asmx";
var _action = "http://localhost/simulator/webservice1.asmx?op=HelloWorld";

String soapMessage = soapMessage = @"<?xml version='1.0' encoding='utf-8'?><soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema'><soap:Body><HelloWorld xmlns='http://tempuri.org/' /></soap:Body></soap:Envelope>";

XmlDocument soapEnvelop = new XmlDocument();
soapEnvelop.LoadXml(soapMessage);

XmlDocument soapEnvelopeXml = soapEnvelop;

HttpWebRequest webRequest = CreateWebRequest(_url, _action);
InsertSoapEnvelopeIntoWebRequest(soapEnvelopeXml, webRequest);

// begin async call to web request.
IAsyncResult asyncResult = webRequest.BeginGetResponse(null, null);

// suspend this thread until call is complete. You might want to
// do something usefull here like update your UI.
asyncResult.AsyncWaitHandle.WaitOne();

// get the response from the completed web request.
string soapResult;
using (WebResponse webResponse = webRequest.EndGetResponse(asyncResult))
using (StreamReader rd = new StreamReader(webResponse.GetResponseStream()))
{
  soapResult = rd.ReadToEnd();
} 
```

# macos - 检查 Cocoa 中的两个文件是否相同

> ID：12165474
> 
> 赞同：5
> 
> 时间：2012-08-28T18:42:20.360
> 
> 标签：macos, cocoa, file-io, nsfilemanager, nsfilewrapper

您如何有效地检查 Cocoa 中的两个文件是否相同（具有相同的数据）？

上下文：我正在编写一个程序，它接收一个文件作为输入（输入文件）并将其复制到一个目录中。如果目录已经包含同名文件（同名文件），那么只有当同名文件不同时，才应使用新名称复制输入文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T19:04:55.087

你可以使用`-[NSFileManager contentsEqualAtPath:andPath:]`.

从文档：

> 如果 path1 和 path2 是目录，则内容是每个包含的文件和子目录的列表——子目录的内容也会被比较。对于文件，这个方法检查它们是否是同一个文件，然后比较它们的大小，最后比较它们的内容。此方法不遍历符号链接，而是比较链接本身。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T08:13:35.527

当贾斯汀回答我的问题时，我在`NSFileWrapper`内部使用，所以我不能总是使用`contentsEqualAtPath:andPath:`.

如果它可以帮助任何人，这是我写的比较 a`NSFileWrapper`的内容和文件的内容：

```
- (BOOL) contentsOfFileWrapper:(NSFileWrapper*)fileWrapper equalContentsAtPath:(NSString*)path {        
    NSDictionary *fileAttrs = [[NSFileManager defaultManager] attributesOfItemAtPath:path error:nil];
    NSUInteger fileSize = [attrs fileSize];
    NSUInteger fileWrapperSize = [fileWrapper.fileAttributes fileSize];  // Will return zero if the file wrapper hasn't been written
    if (fileWrapperSize > 0 && fileSize != fileWrapperSize) return NO;

    NSData *fileData = [NSData dataWithContentsOfURL:fileURL];
    NSData *fileWrapperData = fileWrapper.regularFileContents;
    return [fileData isEqualToData:resourceData];
} 
```

正如贾斯汀建议的那样，如果我无法重建文件包装器的路径，我只会使用上述方法。如果可以的话，我会使用`contentsEqualAtPath:andPath:`.

# mysql - Mysql将字段的值限制为定义的值之一

> ID：12165479
> 
> 赞同：2
> 
> 时间：2012-08-28T18:42:37.030
> 
> 标签：mysql, validation

我正在使用mysql数据库。

我`user_type`在`USER`表中有一个字段。我想将此字段中的值限制为（'ADMIN'，'AGENT'，'CUSTOMER'）之一。

如果插入语句尝试插入上述可能值之外的任何内容，则它们应该会失败。另外，我需要默认为“客户”，在插入语句中没有指定。

我能想到的可能解决方案是使用`triggers`，但我想知道如何更有效地处理这个问题（可能在创建表 ddl 本身中？）。

任何想法，如何做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-28T18:48:06.720

这就是[列类型“枚举”](http://dev.mysql.com/doc/refman/5.0/en/enum.html)的用途。你把它当作一个字符串，在幕后它被存储为一个 int，并且必须是 DDL 中定义的值之一：

```
CREATE TABLE users (
  id int unsigned NOT NULL auto_increment primary key,
  user_type enum('ADMIN', 'AGENT', 'CUSTOMER') NOT NULL default 'CUSTOMER'
) 
```

然后像这样插入：

```
INSERT INTO users (user_type) VALUES ('ADMIN'); // success
INSERT INTO users (user_type) VALUES ('ANONYMOUS'); // failure (or '' if not "strict" mode)
INSERT INTO users (user_type) VALUES (default(user_type)); // uses default
INSERT INTO users () VALUES (); // uses default
INSERT INTO users (user_type) VALUES (NULL); // failure 
```

# 笔记

请注意，要使查询实际失败，您必须使用“SQL 严格模式”。否则，将插入一个“空字符串”值（有点特殊，因为它的数值为 0）。

引用[此文档页面](http://dev.mysql.com/doc/refman/5.0/en/server-sql-mode.html)：

> 当本手册提及“严格模式”时，是指启用 STRICT_TRANS_TABLES 或 STRICT_ALL_TABLES 中的至少一个的模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-12T13:43:02.817

我遇到了这篇文章，因为它可以追溯到有点早，我在想其他人这些天也遇到过它，并且错过了（在我看来）简单添加`CHECK`约束的更简单的方法（例如[，](https://dev.mysql.com/doc/refman/8.0/en/create-table-check-constraints.html)对于 MySQL，或者[对于](https://mariadb.com/kb/en/constraint/)MariaDB） .

在我看来，使用`CHECK`约束比使用`ENUM`和 /之类的东西要容易得多，`SET`因为当你依赖它们时，你不需要担心与整数索引等的关系。例如，当您尝试为列预设允许的整数值时，它们可能会变得很奇怪。

例如，您希望有一列的值范围为 1 到 5：

```
CREATE TABLE myTable (
  myCol INT NOT NULL
  CONSTRAINT CHECK (0 < `myCol` < 5)
); 
```

# cocos2d-iphone - 如何让子 CCSprite 在其父级之上绘制？

> ID：12165481
> 
> 赞同：6
> 
> 时间：2012-08-28T18:42:41.070
> 
> 标签：cocos2d-iphone, drawing, ccsprite

我正在尝试控制 CCSprites 一层层叠加的顺序。我会使用，但我正在为由 `zOrder`关节精灵组成的角色制作动画（一些精灵以`addChild`

基本上，我想将我的精灵作为父对象，以便它们可以继承彼此的变换，但我想确定绘制顺序。

[环顾四周](https://stackoverflow.com/questions/7245769/cocos2d-layer-hierarchy-and-draw-order)，听起来像使用 CCSprite 的`vertexZ`属性是要走的路。我试过了。我像这样设置自定义 CCSprite 的绘制方法：

```
- (void)draw
{
    glEnable(GL_BLEND);
    CHECK_GL_ERROR_DEBUG();
    glBlendFunc(GL_SRC_ALPHA, GL_ONE);
    CHECK_GL_ERROR_DEBUG();
    [super draw];
    glDisable(GL_BLEND);
} 
```

我的每个精灵现在都有一个为 0 的 zOrder 和一个唯一的 vertexZ 来按我的意愿对它们进行分层，但它不起作用：任何具有父级的精灵都不会显示！

尝试了一些东西，我发现如果我不设置vertexZ，所有的精灵都会显示出来。如果我保留 vertexZs 而不是父级，它们都会显示出来。但是设置了 vertexZs，任何子精灵都不会显示。

这里发生了什么，我怎样才能让它工作？

**更新：** 更多线索。我可以完全注释掉我对 [super draw] 的调用的 GL 函数，结果是一样的。此外，结果显示带有 vertexZ 的子精灵确实会显示，但无论它们与任何其他精灵重叠，它们都会变得不可见。紫色纸精灵是该生物左前臂精灵（在屏幕右侧）的子精灵，但应该在它上面。

![无论紫色精灵在其他精灵的上方或下方，都会有咬痕。](../Images/00ee2d1ed1a9a8e6ad9c5d2a0fe07ce9.png)

对于上面的图片，我基本上是在我的 CCLayer 中做这个的。我想要养育子女，但我想要手和纸在上面。

```
[self addChild:lUpperarm];
[self addChild:lForearm];
[self addChild:face];
[self addChild:rUpperarm];
[self addChild:rForearm];
[lForearm addChild:handAndPaper];

lUpperarm.vertexZ = -100;
lForearm.vertexZ = -99;
face.vertexZ = -98;
rUpperarm.vertexZ = -97;
rForearm.vertexZ = -96;
handAndPaper.vertexZ = -95; 
```

这就是我想要的样子。（我将最后一行更改为`[self addChild:handAndPaper]`丢失 lForearm 的转换，而不是我想要的。）

![覆盖着其他精灵的紫色纸。](../Images/bce65feb66feeb19815de430a0a2ef45.png)

**更新 2：** 有人建议我添加 zOrder 设置为 -1 的所有孩子：例如`[lForearm addChild:handAndPaper z:-1]`. 这改变了一些事情，但仍然没有解决它，唉。似乎 vertexZ 没有确定绘制顺序和/或混合错误。

![zOrder -1 的效果。](../Images/85af4cf5bb2a4d0b490298cbea82cca6.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T16:35:37.710

我在使用 Cocos2d 编写 RPG 时[处理了这个问题。](http://iphonegamekit.com/cczsprite-and-hudlevelsprite-two-cocos2d-extensions-you-need-to-know-about/)问题是阿尔法混合。如您所见，纸被左臂精灵遮住了，尽管它是透明的。由于某种原因，在使用 Cocos2d 的 vertexZ 技术时，有时会出现这个问题。要修复它，您可以尝试更改 Alpha 混合级别。尝试 0.0、0.5 和 1.0：

```
-(void) draw
{
    glEnable(GL_ALPHA_TEST);
    glAlphaFunc(GL_GREATER, 0.0f);
    [super draw];
    glDisable(GL_ALPHA_TEST);
} 
```

如果这不起作用，那么我推荐一个完整的解决方案。将所有精灵保留为同一父节点的一部分并使用常规 z 排序。这不是一个理想的解决方案，但是如果您使用“元”父节点，那么您仍然可以轻松地转换所有子节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-05T15:32:30.360

我不能确定这是你的问题，但我过去在玩 draw() 时遇到过问题，结果是我没有在通话结束时重置 blendfunc。

这是我使用的一个绘图函数，它可以进行一些具有一定透明度的基本绘图。同样，没有保证。

```
- (void) draw {
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

    ccDrawSolidPoly(vertices, 4, fillColor);

    // This is the important bit.  Must do this last.
    //
    glBlendFunc(CC_BLEND_SRC, CC_BLEND_DST);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T15:12:57.683

只添加你可以控制z-order？

```
[self addChild:lUpperarm z:1];
[self addChild:lForearm z:2];
[self addChild:face z:3];
[self addChild:rUpperarm z:4];
[self addChild:rForearm z:5];
[lForearm addChild:handAndPaper z:6]; 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-08-30T06:44:23.093

设置更高的 z 值以将对象设置在顶部。并降低 z 值以设置在后面..

# symfony - 如何在 Symfony 2 和 Twig 中包含 CSS 文件？

> ID：12165485
> 
> 赞同：67
> 
> 时间：2012-08-28T18:43:04.133
> 
> 标签：symfony, twig

我正在玩**Symfony2 ，并且在****Twig**模板中遇到了包括**CSS**和**JS**文件在内的问题。

 **我有一个名为的包`Webs/HomeBundle`，里面`HomeController`有一个`indexAction`渲染树枝模板文件的包：

```
public function indexAction()
{
    return $this->render("WebsHomeBundle:Home:index.html.twig");
} 
```

所以这很容易。现在我想做的是在这个 Twig 模板中包含一些 CSS 和 JS 文件。模板如下所示：

```
<!DOCTYPE html>
<html>
<head>  
    {% block stylesheets %}
        <link href="{{ asset('css/main.css') }}" type="text/css" rel="stylesheet" />
    {% endblock %}
</head>
<body>
</body>
</html> 
```

我想包含的文件，`main.css`文件位于：

```
Webs/HomeController/Resources/public/css/main.css 
```

所以我的问题基本上是，我到底如何在 Twig 模板中包含简单的 CSS 文件？

我正在使用 Twig`asset()`函数，它只是没有找到正确的 CSS 路径。另外，我在控制台中运行此命令：

```
app/console assets:install web 
```

这创建了一个新文件夹

```
/web/bundles/webshome/... 
```

这只是链接到

```
src/Webs/HomeController/Resources/public/ 
```

对？

# 问题

1.  您将**资产**文件、JS、CSS 和图像放在哪里？可以把它们放在`Bundle/Resources/public`文件夹里吗？这对他们来说是正确的位置吗？
2.  您如何使用资产功能将这些**资产**文件包含在您的 Twig 模板中？如果它们在公用文件夹中，我该如何包含它们？
3.  我应该配置其他东西吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-08-28T19:10:01.290

`asset()`除了将捆绑路径传递给功能之外，您所做的一切都是正确的。

根据[文档](http://symfony.com/doc/current/book/templating.html#including-stylesheets-and-javascripts-in-twig)- 在您的示例中，这应该如下所示：

```
{{ asset('bundles/webshome/css/main.css') }} 
```

**提示**：您也可以使用`--symlink`密钥调用 assets:install，这样它就会在 web 文件夹中创建符号链接。`js`这在您经常应用或更改时非常有用`css`（这样您的更改，应用到`src/YouBundle/Resources/public`将立即反映在`web`文件夹中，无需`assets:install`再次调用）：

```
app/console assets:install web --symlink 
```

此外，如果您希望在子模板中**添加**一些资产，您可以调用`parent()`Twig 块的方法。在你的情况下，它会是这样的：

```
{% block stylesheets %}
    {{ parent() }}

    <link href="{{ asset('bundles/webshome/css/main.css') }}" rel="stylesheet">
{% endblock %} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-05-31T10:08:44.907

您可以使用 %stylesheets% （资产特征）标签：

```
{% stylesheets
    "@MainBundle/Resources/public/colorbox/colorbox.css"
    "%kerner.root_dir%/Resources/css/main.css"
%}
<link type="text/css" rel="stylesheet" media="all" href="{{ asset_url }}" />
{% endstylesheets %} 
```

您可以将路径写入 css 作为参数 (%parameter_name%)。

有关此变体的更多信息：http: [//symfony.com/doc/current/cookbook/assetic/asset_management.html](http://symfony.com/doc/current/cookbook/assetic/asset_management.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-05-27T07:35:23.870

其他答案是有效的，但[官方 Symfony 最佳实践](http://symfony.com/doc/master/best_practices/web-assets.html)指南建议使用该`web/`文件夹来存储所有资产，而不是不同的包。

> 将您的网络资产分散在数十个不同的捆绑包中会使管理它们变得更加困难。如果所有应用程序资产都在一个位置，您的设计师的生活将会轻松得多。
> 
> 模板还受益于集中您的资产，因为链接更加简洁[...]

我建议您只将微资产放在微包中，例如仅在按钮包中的按钮需要的几行样式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-26T10:30:09.187

如果您使用**Silex**，请将**Symfony 资产**添加为依赖项：

```
composer require symfony/asset 
```

然后您可以注册**Asset Service Provider**：

```
$app->register(new Silex\Provider\AssetServiceProvider(), array(
    'assets.version' => 'v1',
    'assets.version_format' => '%s?version=%s',
    'assets.named_packages' => array(
        'css' => array(
            'version' => 'css2',
            'base_path' => __DIR__.'/../public_html/resources/css'
        ),
        'images' => array(
            'base_urls' => array(
                'https://img.example.com'
            )
        ),
    ),
)); 
```

然后在 head 部分的**Twig**模板文件中：

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    {% block head %}
    <link rel="stylesheet" href="{{ asset('style.css') }}" />
    {% endblock %}
</head>
<body>

</body>
</html> 
```**

# c# - Lucene.net 和部分“以”开头的短语搜索

> ID：12165488
> 
> 赞同：3
> 
> 时间：2012-08-28T18:43:11.907
> 
> 标签：c#, lucene.net, lucene

我希望在大量城市名称上构建一个自动完成的文本框。搜索功能如下：我想要对多词短语进行“开始于”搜索。例如，如果用户输入了“chicago he”，则只需要返回“Chicago Heights”等位置。
我正在尝试为此使用Lucene。我在理解如何实现这一点时遇到问题。

我已经尝试过我认为应该可行的方法：

我已经用 KeywordAnalyzer 索引了位置（我已经尝试过 TOKENIZED 和 UN_TOKENIZED）：

```
doc.Add(new Field("Name", data.ToLower(), Field.Store.YES, Field.Index.TOKENIZED, Field.TermVector.NO)); 
```

并通过以下方式搜索它们（我还尝试了各种其他查询/分析器/等）：

```
var luceneQuery = new BooleanQuery();
var wildcardQuery = new WildcardQuery(new Term("Name", "chicago hei*"));
luceneQuery.Add(wildcardQuery, BooleanClause.Occur.MUST); 
```

我没有得到任何结果。将不胜感激任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T19:44:13.253

为此，您需要使用设置为您的字段编制索引，该`Field.Index.NOT_ANALYZED`设置与您使用的 UN_TOKENIZED 相同，因此它应该可以工作。这是我快速制作的一个工作样本进行测试。我正在使用 Nuget 上的最新版本

```
IndexWriter iw = new IndexWriter(@"C:\temp\sotests", new StandardAnalyzer(Lucene.Net.Util.Version.LUCENE_29), true);

Document doc = new Document();
Field loc = new Field("location", "", Field.Store.YES, Field.Index.NOT_ANALYZED);
doc.Add(loc);

loc.SetValue("chicago heights");
iw.AddDocument(doc);

loc.SetValue("new-york");
iw.AddDocument(doc);

loc.SetValue("chicago low");
iw.AddDocument(doc);

loc.SetValue("montreal");
iw.AddDocument(doc);

loc.SetValue("paris");
iw.AddDocument(doc);

iw.Commit();

IndexSearcher ins = new IndexSearcher(iw.GetReader());

WildcardQuery query = new WildcardQuery(new Term("location", "chicago he*"));

var hits = ins.Search(query);

for (int i = 0; i < hits.Length(); i++)
    Console.WriteLine(hits.Doc(i).GetField("location").StringValue());

Console.WriteLine("---");

query = new WildcardQuery(new Term("location", "chic*"));
hits = ins.Search(query);

for (int i = 0; i < hits.Length(); i++)
    Console.WriteLine(hits.Doc(i).GetField("location").StringValue());

iw.Close();
Console.ReadLine(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T22:34:21.163

保证“开始于”搜索的唯一方法是在索引字符串的开头放置一个分隔符，因此“钻石戒指”的索引类似于“lucenedelimiter diamond ring lucenedelimiter”。这可以防止出现“著名的钻石岭度假村”的搜索出现在搜索“钻石 ri*”中。

# php - 将 GET 链接转换为漂亮的链接

> ID：12165494
> 
> 赞同：0
> 
> 时间：2012-08-28T18:43:21.407
> 
> 标签：php, api, codeigniter, get-request

我在我的新 Web 应用程序中使用 Codeigniter，我在页面中有一个表单，它通过 post 将数据发送到服务器，该服务器将用户返回到我的网站，但参数通过 get 带有丑陋的链接，例如 example.com/ id=12&code=Xxxx

如果可能的话，我想做的是如何将那些丑陋的链接转换为友好的链接（example.com/12/Xxxx）

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:46:09.270

您不能将 GET 表单直接转换为漂亮的 URL。它们将自动成为`?key=val`格式。

您最好的选择是使用重定向标头将 GET 转换为漂亮的 URL。

例如：

```
$firstPart = $_GET['myKey'];
$secondPart = $_GET['mySecondKey'];
header('Location: ' . $requestURL . '/' . $firstPart . '/' . $secondPart); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T22:25:08.347

获取参数基本上是任何[Web API](http://en.wikipedia.org/wiki/Application_programming_interface#Web_APIs)的标准，因此您可能会发现最终会大量使用它们，而不是为每个 API 创建[一个](http://en.wiktionary.org/wiki/middleman)*中间人*。

在 index.php 的同一级别创建一个新文件夹（通常是您的站点根目录）。将此文件夹称为`middleman`

`middleman`将文件夹添加到文件**中**`.htaccess`不应通过 index.php 路由的项目列表中

 **现在，对于您使用的每个 API，您都可以在文件夹中创建一个新的 .php 文件，该`middleman`文件将所有请求转换为您的站点可以理解的请求。

然后，您将外部 API 指向[http://yoursite.com/middleman/api_name.php](http://yoursite.com/middleman/api_name.php)

创建中间人的原因是[Code Igniter 消除了 get 数组](http://codeigniter.com/user_guide/libraries/input.html)，因此如果您尝试在 Code Igniter 内部执行请求并将其格式化为有意义的内容，则它会在您处理请求之前被删除，因此我们必须在 Code Igniter 范围之外执行转换.

示例文件可能如下所示：
**mysite.pingback.php**

```
<?php
    $from = $_GET['ip'];
    $time = $_GET['time'];
    $post = $_GET['id'];

    header('location: ../mysite/pingback/'.$from.'/'.$post.'/'.$time);
?> 
```

非常简单的文件。但这也意味着当对外部 API 进行更改时，它不会影响您的 Code Igniter 应用程序的工作方式，因为您只需更改中间人即可。**

# ios5 - 生产推送通知生成

> ID：12165496
> 
> 赞同：0
> 
> 时间：2012-08-28T18:43:26.653
> 
> 标签：ios5, push-notification

我已经成功创建了推送通知开发证书，但现在我需要创建生产证书。我该如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:46:29.627

编程指南？[http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ProvisioningDevelopment/ProvisioningDevelopment.html#//apple_ref/doc/uid/TP40008194-CH104-SW1](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ProvisioningDevelopment/ProvisioningDevelopment.html#//apple_ref/doc/uid/TP40008194-CH104-SW1)

# javascript - 单击时从表单中删除特定文本

> ID：12165499
> 
> 赞同：0
> 
> 时间：2012-08-28T18:43:33.517
> 
> 标签：javascript, forms, text

基本上我想创建一个函数，当单击文本时，它会在表单上打印“id”。并且当它再次被点击时，只有那个'id'被删除（之前点击/打印的'id'仍然存在）。

我到目前为止的打印脚本：

```
function imprime01(obj) {
        document.form2.text.value = document.form2.text.value +  obj.title;
         } 
```

div

```
<div onclick="imprime01(this);" title="240 ">240</div>
<div onclick="imprime01(this);" title="230 ">230</div>
<div onclick="imprime01(this);" title="220 ">220</div> 
```

所以我想要的是：当我单击 240、230 时，它会在表单上打印“240 230”，而当我再次单击“240”时，它只会从表单中删除“240”。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:51:24.763

有很多方法可以做到这一点。

我会将您的 ID 存储在一个数组中。在您的单击处理程序中，测试数组中是否存在 id，如果存在则将其删除，否则添加它。然后将数组中的所有 id 写入您的文本框中：

```
var idList = [];
function imprime01(obj) {
    var id = obj.title;
    var idIndex = idList.indexOf(id);
    if (idIndex > -1) {
        idList.splice(idIndex, 1);
    }
    else {
        idList.push(id);
    }
    document.form2.text.value = idList.join(" ");
 } 
```

这可能比简单的字符串替换更复杂一些，但它为您提供了稍后可能有用的其他功能。例如，如果您的程序的另一部分需要知道选择了哪些 id，则它们已经在数组中可用。

**编辑：**您可以在单击处理程序中动态生成它，而不是将数组存储在变量中`string.split(" ")`：

```
function imprime01(obj) {
    var id = obj.title;
    var idList = document.form2.text.value.split(" ");
    var idIndex = idList.indexOf(id);
    if (idIndex > -1) {
        idList.splice(idIndex, 1);
    }
    else {
        idList.push(id);
    }
    document.form2.text.value = idList.join(" ");
 }​ 
```

**工作演示：http:** [//jsfiddle.net/gilly3/qWRct/](http://jsfiddle.net/gilly3/qWRct/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:49:34.487

用途`replace`及`indexOf`功能：

```
var str = document.form2.text.value;
if(str.indexOf(obj.title) != -1)
    document.form2.text.value = str.replace(obj.title,""); 
else
    document.form2.text.value = str +  obj.title; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:53:50.080

见[http://jsfiddle.net/BdEMx/](http://jsfiddle.net/BdEMx/)

```
function imprime01(obj) {
    var arr=document.form2.text.value?document.form2.text.value.split(' '):[];
    var i=arr.indexOf(obj.title);
    if(i===-1){
        arr.push(obj.title);
    }else{
        arr.splice(i,1);
    }
    document.form2.text.value = arr.join(' ');
} 
```

`title`您不应该仅仅因为您想加入其中一些属性而在属性末尾添加空格。

# dll - InjectTouchInput API 的 C++/CLI 应用程序。LNK2028 和 LNK2019 错误

> ID：12165502
> 
> 赞同：1
> 
> 时间：2012-08-28T18:43:53.893
> 
> 标签：dll, linker, c++-cli

我正在尝试在 Visual Studio 2012（在 Win8 Release Preview 上）中构建一个 C++/CLI 库，以使用C# 中的[InitializeTouchInjection](http://msdn.microsoft.com/en-us/library/windows/desktop/hh802880%28v=vs.85%29.aspx)和[InjectTouchInput函数。](http://msdn.microsoft.com/en-us/library/windows/desktop/hh802881%28v=vs.85%29.aspx)

我这样定义我的班级

```
// MultiTouchWrapper.h
namespace MultiTouchWrapper {

    public ref class MultiTouchInjection
    {
            public:
            static bool InitializeMultiTouch(int maxCount);
            static bool InjectMultiTouch(int count, float *x, float *y, int *id);
    };
} 
```

并实现功能

```
//MultiTouchWrapper.cpp

#include "stdafx.h"
#include "MultiTouchWrapper.h"

namespace MultiTouchWrapper{
    bool  MultiTouchInjection::InitializeMultiTouch(int maxCount){
        if(InitializeTouchInjection(maxCount, TOUCH_FEEDBACK_DEFAULT)) return true;
        return false;
    } 
    bool  MultiTouchInjection::InjectMultiTouch(int count, float *x, float *y, int *id){
        POINTER_TOUCH_INFO *contacts = new POINTER_TOUCH_INFO[count];
        for(int i=0; i<count; i++){
            contacts[i].pointerInfo.pointerType = PT_TOUCH;
            contacts[i].pointerInfo.pointerId = id[0];
            contacts[i].pointerInfo.ptPixelLocation.y = (LONG)y[0];
            contacts[i].pointerInfo.ptPixelLocation.x = (LONG)x[0];
            contacts[i].touchFlags = TOUCH_FLAG_NONE;
            contacts[i].touchMask = TOUCH_MASK_NONE;

        }
        if(InjectTouchInput(count, contacts)) return true; //defined like this to avoid a warning about BOOL vs bool.
        return false;
    } 
```

在 stdafx.h 我包括`<windows.h>`，它给出了`InitializeTouchInjection`和`InjectTouchInput`through的定义`<WinUser.h>`。

我遇到的问题是，当我尝试构建这个库时，两个函数都出现错误 LNK2028 和 LNK2019：

```
Error   1   error LNK2028: unresolved token (0A00003B) "extern "C" int __stdcall InjectTouchInput(unsigned int,struct tagPOINTER_TOUCH_INFO const *)" (?InjectTouchInput@@$$J18YGHIPBUtagPOINTER_TOUCH_INFO@@@Z) referenced in function "public: static bool __clrcall MultiTouchWrapper::MultiTouchInjection::InjectMultiTouch(int,float *,float *,int *)" (?InjectMultiTouch@MultiTouchInjection@MultiTouchWrapper@@$$FSM_NHPAM0PAH@Z)    C:\Users\mediascape\documents\visual studio 2012\Projects\MultiTouchWrapper\MultiTouchWrapper\MultiTouchWrapper.obj MultiTouchWrapper
Error   2   error LNK2028: unresolved token (0A000063) "extern "C" int __stdcall InitializeTouchInjection(unsigned int,unsigned long)" (?InitializeTouchInjection@@$$J18YGHIK@Z) referenced in function "public: static bool __clrcall MultiTouchWrapper::MultiTouchInjection::InitializeMultiTouch(int)" (?InitializeMultiTouch@MultiTouchInjection@MultiTouchWrapper@@$$FSM_NH@Z) C:\Users\mediascape\documents\visual studio 2012\Projects\MultiTouchWrapper\MultiTouchWrapper\MultiTouchWrapper.obj MultiTouchWrapper
Error   3   error LNK2019: unresolved external symbol "extern "C" int __stdcall InitializeTouchInjection(unsigned int,unsigned long)" (?InitializeTouchInjection@@$$J18YGHIK@Z) referenced in function "public: static bool __clrcall MultiTouchWrapper::MultiTouchInjection::InitializeMultiTouch(int)" (?InitializeMultiTouch@MultiTouchInjection@MultiTouchWrapper@@$$FSM_NH@Z)  C:\Users\mediascape\documents\visual studio 2012\Projects\MultiTouchWrapper\MultiTouchWrapper\MultiTouchWrapper.obj MultiTouchWrapper
Error   4   error LNK2019: unresolved external symbol "extern "C" int __stdcall InjectTouchInput(unsigned int,struct tagPOINTER_TOUCH_INFO const *)" (?InjectTouchInput@@$$J18YGHIPBUtagPOINTER_TOUCH_INFO@@@Z) referenced in function "public: static bool __clrcall MultiTouchWrapper::MultiTouchInjection::InjectMultiTouch(int,float *,float *,int *)" (?InjectMultiTouch@MultiTouchInjection@MultiTouchWrapper@@$$FSM_NHPAM0PAH@Z) C:\Users\mediascape\documents\visual studio 2012\Projects\MultiTouchWrapper\MultiTouchWrapper\MultiTouchWrapper.obj MultiTouchWrapper 
```

我不知道该怎么办。我尝试在配置属性 >> C/C++ >> 命令行菜单中包含 /LD。我尝试`__cdecl`在高级菜单中将调用约定更改为，但它总是恢复为`__stdcall`.

有关如何解决这些链接器错误的任何帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T14:15:26.920

我没有链接到 user32.lib 文件。对于那些想知道需要做什么的人，我用[这个问题](https://stackoverflow.com/questions/5683710/wstring-lpcwstr-in-shellexecute-give-me-error-lnk2028-lnk2019)作为参考来弄清楚去哪里以及问题是什么。

# java - 如何提类路径

> ID：12165505
> 
> 赞同：0
> 
> 时间：2012-08-28T18:44:08.273
> 
> 标签：java, classpath

如何在以下代码中提及类的路径？

```
Class cl=Class.forName("SomeClass"); 
```

如果“SomeClass”位于调用类的同一目录中，则此方法效果很好。但是如何检查来自不同目录的类，我看到了类似的语法`xxxx.yyyy.class`，但无法弄清楚那些'x's 和'y's 代表什么。请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:45:48.040

使用[完全限定的类名。](http://docs.oracle.com/javase/tutorial/java/package/namingpkgs.html)例如，要使用包[`String`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html)中的 Java SE 类执行此操作`java.lang`：

```
Class clazz = Class.forName("java.lang.String"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:45:55.660

那些`xxx`和`yyy`代表包名称。包通常由磁盘上与包同名的目录表示。创建类文件时，您可以通过`package xxx.yyy`在文件顶部说明来指定该类所在的包。

在没有包名的情况下引用`"SomeClass"`将尝试加载`SomeClass`在默认包中命名的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:52:11.820

使用 Class.forName 尽管确保您处理可能的 ClassNotFoundException 异常。这是一个运行时异常，因此并不意味着您需要捕获它。这就是您如何知道您的班级路径是否正确。问题是，如果它找不到类，你的代码可能会发生有趣的事情。

```
Class.forName(com.my.package.ClassName) 
```

# .net - AxMSHFlexGrid 和 MSHFlexGrid 之间的区别

> ID：12165507
> 
> 赞同：0
> 
> 时间：2012-08-28T18:44:24.460
> 
> 标签：.net, com, vb6-migration

我正在对多年前用 VB6 编写的古老应用程序进行一些维护。在某些时候，它被迁移到 VB.NET，几乎没有任何变化。我不知道他们是如何或为什么做到这一点的。

源代码管理中的项目包含对警告“”的引用`Interop.MSHierarchicalFlexGridLib`并`AXInterop.MSHierarchicalFlexGridLib`带有警告`<The system cannot find the reference specified>`。该项目包含超过 102 个错误（如果您是 Visual Studio 2008 的新手，这是错误列表中显示的最大错误数）。

我删除了这两个损坏的引用并添加了对 Microsoft Hierarchical Flex Grid 6.0 COM 控件的引用。这更正了对 的所有引用`MSHierarchicalFlexGridLib.MSHFlexGrid`，将错误数量减少到 64 个。剩余的错误是对`AxMSHierarchicalFlexGridLib`命名空间的未解析引用的结果，几乎完全在 Designer 代码中。起初我认为这可能只是一些`Import`技巧（重命名命名空间），但控件的名称也以“Ax”（`AxMSHierarchicalFlexGridLib.AxMSHFlexGrid`）为前缀。我猜“Ax”只是代表“Active X”并且指的是完全相同的控件，但在我去更改大部分 Designer 代码中的 60 多个引用之前，我想了解更多。到目前为止，我的 Google-fu 让我失望了。

**问题：**

*   是`AxMSHierarchicalFlexGridLib.AxMSHFlexGrid`一样的 `MSHierarchicalFlexGridLib.MSHFlexGrid`吗？

*   如果相同，为什么设计器更改名称，简单地查找-替换对重命名命名空间的所有引用是否安全？（另外，第二个参考`AXInterop.MSHierarchicalFlexGridLib`来自哪里？）

*   如果不一样，我缺少的 COM 控件的名称是什么？

**另一个奖励问题：**

源代码管理中的项目似乎只包含对互操作的引用，而不是对 COM 对象的引用。我可以相信，不知道自己在做什么的人设法偶然发现了一些“有效”的东西，但以防万一……Vis​​ual Studio 的许多自动化向导、工具等有什么办法吗？参与？我想确保这种情况不会重复。

谢谢

PS 我只是从头开始重写这个项目，但是仅 frmMain 代码文件（我不敢说“类”）就包含近 17,000 行，所以这项工作需要的时间比我允许的要多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:37:33.130

如前所述，名称以 AxInterop 开头的程序集通常由 Aximp.exe 工具自动生成。它创建了一个从 Winform 的 AxHost 类派生的控件，并支持在窗体上放置 ActiveX 控件。

考虑到 MSHFlexGrid（一个 VB6 控件）的使用年限，您可能希望将 DLL 签入到源代码控制中，这样您就不会再次丢失它。

# c# - 连通分量标注算法优化

> ID：12165510
> 
> 赞同：3
> 
> 时间：2012-08-28T18:44:28.787
> 
> 标签：c#, algorithm, optimization, image-processing

我需要一些帮助来优化我的 CCL 算法实现。我用它来检测图像上的黑色区域。在 2000x2000 上需要 11 秒，这差不多。我需要将运行时间减少到可能达到的最低值。另外，我很高兴知道是否有任何其他算法可以让你做同样的事情，但比这个更快。所以这是我的代码：

```
 //The method returns a dictionary, where the key is the label
    //and the list contains all the pixels with that label
    public Dictionary<short, LinkedList<Point>> ProcessCCL()
    {
        Color backgroundColor = this.image.Palette.Entries[1];
        //Matrix to store pixels' labels
        short[,] labels = new short[this.image.Width, this.image.Height];
        //I particulary don't like how I store the label equality table
        //But I don't know how else can I store it
        //I use LinkedList to add and remove items faster
        Dictionary<short, LinkedList<short>> equalityTable = new Dictionary<short, LinkedList<short>>();
        //Current label
        short currentKey = 1;
        for (int x = 1; x < this.bitmap.Width; x++)
        {
            for (int y = 1; y < this.bitmap.Height; y++)
            {
                if (!GetPixelColor(x, y).Equals(backgroundColor))
                {
                    //Minumum label of the neighbours' labels
                    short label = Math.Min(labels[x - 1, y], labels[x, y - 1]);
                    //If there are no neighbours
                    if (label == 0)
                    {
                        //Create a new unique label
                        labels[x, y] = currentKey;
                        equalityTable.Add(currentKey, new LinkedList<short>());
                        equalityTable[currentKey].AddFirst(currentKey);
                        currentKey++;
                    }
                    else
                    {
                        labels[x, y] = label;
                        short west = labels[x - 1, y], north = labels[x, y - 1];
                        //A little trick:
                        //Because of those "ifs" the lowest label value
                        //will always be the first in the list
                        //but I'm afraid that because of them
                        //the running time also increases
                        if (!equalityTable[label].Contains(west))
                            if (west < equalityTable[label].First.Value)
                                equalityTable[label].AddFirst(west);
                        if (!equalityTable[label].Contains(north))
                            if (north < equalityTable[label].First.Value)
                                equalityTable[label].AddFirst(north);
                    }
                }
            }
        }
        //This dictionary will be returned as the result
        //I'm not proud of using dictionary here too, I guess there 
        //is a better way to store the result
        Dictionary<short, LinkedList<Point>> result = new Dictionary<short, LinkedList<Point>>();
        //I define the variable outside the loops in order 
        //to reuse the memory address
        short cellValue;
        for (int x = 0; x < this.bitmap.Width; x++)
        {
            for (int y = 0; y < this.bitmap.Height; y++)
            {
                cellValue = labels[x, y];
                //If the pixel is not a background
                if (cellValue != 0)
                {
                    //Take the minimum value from the label equality table 
                    short value = equalityTable[cellValue].First.Value;
                    //I'd like to get rid of these lines
                    if (!result.ContainsKey(value))
                        result.Add(value, new LinkedList<Point>());
                    result[value].AddLast(new Point(x, y));
                }
            }
        }
        return result;
    } 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:31:13.673

您可以将图片拆分为多个子图片并并行处理它们，然后合并结果。1 pass：4 个任务，每个任务处理一个 1000x1000 的子图片 2 pass：2 个任务，每个任务处理来自 pass 1 的 2 个子图片 3 pass：1 个任务，处理 pass 2 的结果

对于 C#，我推荐[Task Parallel Library (TPL)](http://msdn.microsoft.com/en-us/library/dd460717.aspx)，它允许轻松定义相互依赖和等待的任务。以下代码项目文章为您提供了对 TPL 的基本介绍：[通过 C# 的任务并行化基础知识](http://www.codeproject.com/Articles/189374/The-Basics-of-Task-Parallelism-via-C)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T20:32:23.423

我将一次处理一条扫描线，跟踪每次黑色像素运行的开始和结束。

然后，我会在每条扫描线上将其与前一行的运行进行比较。如果当前行上的运行与前一行上的运行不重叠，则它表示一个新的 blob。如果上一行的运行与当前行的运行重叠，它将获得与前一行相同的 blob 标签。等等等等。你明白了。

我会尽量不使用字典等。根据我的经验，随机停止程序表明这些事情可能会使编程变得越来越容易，但由于`new`-ing 会导致严重的性能成本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-12T18:36:22.597

问题在于*GetPixelColor(x, y)*，访问图像数据需要很长时间。Set/GetPixel 函数在 C# 中非常慢，所以如果你需要大量使用它们，你应该使用 Bitmap.lockBits 来代替。

```
private void ProcessUsingLockbits(Bitmap ProcessedBitmap)
{
    BitmapData bitmapData = ProcessedBitmap.LockBits(new Rectangle(0, 0, ProcessedBitmap.Width, ProcessedBitmap.Height), ImageLockMode.ReadWrite, ProcessedBitmap.PixelFormat);
    int BytesPerPixel = System.Drawing.Bitmap.GetPixelFormatSize(ProcessedBitmap.PixelFormat) / 8;
    int ByteCount = bitmapData.Stride * ProcessedBitmap.Height;
    byte[] Pixels = new byte[ByteCount];
    IntPtr PtrFirstPixel = bitmapData.Scan0;
    Marshal.Copy(PtrFirstPixel, Pixels, 0, Pixels.Length);
    int HeightInPixels = bitmapData.Height;
    int WidthInBytes = bitmapData.Width * BytesPerPixel;
    for (int y = 0; y < HeightInPixels; y++)
    {
        int CurrentLine = y * bitmapData.Stride;
        for (int x = 0; x < WidthInBytes; x = x + BytesPerPixel)
        {
            int OldBlue = Pixels[CurrentLine + x];
            int OldGreen = Pixels[CurrentLine + x + 1];
            int OldRed = Pixels[CurrentLine + x + 2];
            // Transform blue and clip to 255:
            Pixels[CurrentLine + x] = (byte)((OldBlue + BlueMagnitudeToAdd > 255) ? 255 : OldBlue + BlueMagnitudeToAdd);
            // Transform green and clip to 255:
            Pixels[CurrentLine + x + 1] = (byte)((OldGreen + GreenMagnitudeToAdd > 255) ? 255 : OldGreen + GreenMagnitudeToAdd);
            // Transform red and clip to 255:
            Pixels[CurrentLine + x + 2] = (byte)((OldRed + RedMagnitudeToAdd > 255) ? 255 : OldRed + RedMagnitudeToAdd);
        }
    }
    // Copy modified bytes back:
    Marshal.Copy(Pixels, 0, PtrFirstPixel, Pixels.Length);
    ProcessedBitmap.UnlockBits(bitmapData);
} 
```

这是访问像素数据的基本代码。

我做了一个函数来把它转换成一个二维矩阵，它更容易操作（但慢一点）

```
 private void bitmap_to_matrix()
    {
        unsafe
        {
            bitmapData = ProcessedBitmap.LockBits(new Rectangle(0, 0, ProcessedBitmap.Width, ProcessedBitmap.Height), ImageLockMode.ReadWrite, ProcessedBitmap.PixelFormat);
            int BytesPerPixel = System.Drawing.Bitmap.GetPixelFormatSize(ProcessedBitmap.PixelFormat) / 8;
            int HeightInPixels = ProcessedBitmap.Height;
            int WidthInPixels = ProcessedBitmap.Width;
            int WidthInBytes = ProcessedBitmap.Width * BytesPerPixel;
            byte* PtrFirstPixel = (byte*)bitmapData.Scan0;

            Parallel.For(0, HeightInPixels, y =>
            {
                byte* CurrentLine = PtrFirstPixel + (y * bitmapData.Stride);

                for (int x = 0; x < WidthInBytes; x = x + BytesPerPixel)
                {
                    // Conversion in grey level                       
                    double rst = CurrentLine[x] * 0.0721 + CurrentLine[x + 1] * 0.7154 + CurrentLine[x + 2] * 0.2125;

                    // Fill the grey matix
                    TG[x / 3, y] = (int)rst;
                }
            });               
        }
    } 
```

以及代码所在的网站 [“高性能SystemDrawingBitmap”](http://www.techder.com/2013/03/high-performance-systemdrawingbitmap.html)

感谢作者的出色工作！希望这会有所帮助！

# c# - Reg Ex 查找至少四个空格或一个制表符或混合

> ID：12165515
> 
> 赞同：0
> 
> 时间：2012-08-28T18:45:05.077
> 
> 标签：c#, regex

我想在 C# 中使用 Regex 捕获以下模式并将其替换为单词“Merged”

字符应至少有四个空格或一个制表符。但是它们可以混合

`space space space` - 无效 - '未合并'

`space space space space` - 有效 - '合并'

`space space space space space`- 有效 - '合并'

`space <tab>` - 有效 - '合并'

`<tab><tab>`- 有效 - '合并'

`space<tab><tab>space`- 有效 - '合并'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:51:39.350

以下应该有效：

```
[ ]*\t[ \t]*|[ ]{4,} 
```

我用空格`[ ]`来表示清楚发生了什么，但如果你去掉方括号，它也会起作用。

解释：

```
 [ ]*      # any number of spaces
  \t        # a single tab
  [ \t]*    # any number of spaces or tabs
|         # OR
  [ ]{4,}   # 4 or more spaces 
```

示例：[http ://www.rubular.com/r/MJYp80iEN1](http://www.rubular.com/r/MJYp80iEN1)

这是一个替代方法，它使用前瞻来检查条件，然后匹配任意数量的空格或制表符：

```
(?=[ ]*\t|[ ]{4})[ \t]+ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:51:57.470

`{4,}| *\t[ \t]*`

`{4,}`表示 4 个或更多空格
`|`交替 - 就像`OR`上面的选项和低于
`*`零个或多个空格的所有内容之间的运算符（在下面的制表符之前）
`\t`一个制表符
`[ \t]*`零个或多个制表符或制表符之后的空格（在上面的制表符之后）

这些是每个 之后的单个空格`[`。

这允许空格和制表符的任意组合，只要至少有一个制表符，这就是您的问题的阅读方式。如果选项卡场景中有其他限制，请发表评论，我会更新答案。

```
var result = Regex.Replace(input, @" {4,}|[ \t]*\t[ \t]*", "Merged"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:52:33.237

我会尝试这个正则表达式：

`[ \t]*( {4}|*\t)[ \t]*`

它检查核心条件（至少四个空格或一个制表符），并匹配任意数量的周围制表符或空格（这样您就可以替换所有制表符/空格空白）。

# datagridview - 更改表单控件后 DataGridView 停止显示

> ID：12165517
> 
> 赞同：0
> 
> 时间：2012-08-28T18:45:15.693
> 
> 标签：datagridview, datatable

我创建了一个相当简单的表格；它会打开一个 Excel 文件，并根据该电子表格的内容填充一个数据表。完成版本 1，经过测试、调试 - 它工作正常。一旦加载功能完成，我表单上的 datagridview 就会显示数据。

版本 2 需要一个“验证”按钮，其背后有逻辑，所以我补充说，测试，调试......并注意到数据不再出现在 datagridview 中。我看不到我为更改加载逻辑所做的任何事情，也看不到表定义等。

所以，我恢复到版本 1 的保存副本（为什么，是的，我以前做过 - 嘿！）；它仍然像以前一样工作，在加载结束时显示数据。

一旦我向表单添加任何控件，数据就不再显示。有趣的是，我还在 Form1.Designer.cs 中收到了一堆警告：从未使用过“CSVScanApp.Form1.FileName”字段 有趣/巧合的是，数据表中的每一列都会重复。

我知道你会想看代码，所以这里是：

```
 public Form1()
    {
        try
        {
            InitializeComponent();
            cxApp = new cExcel.Application();
            dsScanRows = new DataSet();
            dtScanTable = dsScanRows.Tables.Add();
            dtScanTable.Columns.Add("FileName", typeof(string));
            dtScanTable.Columns.Add("Company", typeof(string));
            dtScanTable.Columns.Add("LeaseNo", typeof(string));
            dtScanTable.Columns.Add("DocDate", typeof(string));
            dtScanTable.Columns.Add("Function", typeof(string));
            dtScanTable.Columns.Add("Category", typeof(string));
            dtScanTable.Columns.Add("DocType", typeof(string));
            dtScanTable.Columns.Add("Integration", typeof(string));
            dtScanTable.Columns.Add("ScanDate", typeof(string));
            // Category "codes" and their corresponding full names
            CtgyDict.Add("DataSheet", "Data Sheet");
            CtgyDict.Add("Surface", "Surface/ROW/Pipeline Agreements");
            CtgyDict.Add("TitleReport", "Title Report");
            CtgyDict.Add("MapPlats", "Map & Plats");

        }
        catch (Exception ex)
        {
            MessageBox.Show("Error(s) encountered:" + crlf + ex.Message);
        }
        finally
        {
        }
    } 
```

以及来自加载按钮的逻辑，它实际上将 Excel 解析到数据表中：

```
 private void btnLoad_Click(object sender, EventArgs e)
    {
        try
        {
            cxWB = cxApp.Workbooks.Open(tbSourceFile.Text, 0, true, 5, "", "", true,
                cExcel.XlPlatform.xlWindows, "", false, false, 0, false, 1, 0); // open Read-Only
            cExcel.Sheets cxSheets = cxWB.Worksheets;
            cExcel._Worksheet cxSheet = (cExcel._Worksheet)cxSheets.get_Item(1); // Sheet 1
            cExcel.Range cxRange = cxSheet.UsedRange;
            int iRowMax = cxRange.Rows.Count;
            int iRow;
            string sFileName, sLease,sDocDate,sCategory,sCtgyName,sDocType;
            Double dblDocDate;
            string sCompany = tbCompany.Text; // specs said "CompanyNN", but were wrong...
            string sScanDate = tbScanDate.Text; // hope it's correctly entered...  :p
            dataGridView1.DataSource = null; // reset from any previous data
            dtScanTable.Clear(); // make sure this starts empty
            // loop through each row in the source
            for (iRow = 2; iRow <= iRowMax; iRow++)
            {
                sFileName = (string)(cxRange.Cells[iRow, iSourceColFileName] as cExcel.Range).Value2;
                if (sFileName == null | sFileName == "")
                { } // ignore blank rows
                else
                {
                    sLease = sFileName.Split('_')[0]; // e.g., 100845.00A_1.pdf --> 100845.00A
                    dblDocDate = Convert.ToDouble((cxRange.Cells[iRow, iSourceColDocDate] as cExcel.Range).Value2);
                    sDocDate = DateTime.FromOADate(dblDocDate).ToShortDateString();
                    //if (sDocDate == "") { sDocDate = sScanDate; } // default to today???
                    sCategory = (string)(cxRange.Cells[iRow, iSourceColCtgy] as cExcel.Range).Value2;
                    try
                    {
                        sCtgyName = CtgyDict[sCategory];
                    }
                    catch
                    {
                        sCtgyName = sCategory; // i.e., not in the replacement list
                    }
                    sDocType = (string)(cxRange.Cells[iRow, iSourceColDocType] as cExcel.Range).Value2;
                    dtScanTable.Rows.Add(sFileName,sCompany,sLease,sDocDate,sFunction,sCtgyName,sDocType,sIntegration,sScanDate);
                }
            }
            dataGridView1.DataSource = dtScanTable;
            btnValidate.Enabled = true;
        }
        catch (Exception ex)
        {
            MessageBox.Show("Error(s) encountered:" + crlf + ex.Message);
            btnSave.Enabled = false;
        }
    } 
```

而且，在 Form1.Designer.cs 中，这些是与警告相关联的行，这些行仅在我向表单添加控件后才会显示：

```
 private System.Windows.Forms.DataGridViewTextBoxColumn FileName;
    private System.Windows.Forms.DataGridViewTextBoxColumn Company;
    private System.Windows.Forms.DataGridViewTextBoxColumn LeaseNo;
    private System.Windows.Forms.DataGridViewTextBoxColumn DocDate;
    private System.Windows.Forms.DataGridViewTextBoxColumn Function;
    private System.Windows.Forms.DataGridViewTextBoxColumn Category;
    private System.Windows.Forms.DataGridViewTextBoxColumn DocType;
    private System.Windows.Forms.DataGridViewTextBoxColumn Integration;
    private System.Windows.Forms.DataGridViewTextBoxColumn ScanDate; 
```

如果相关，则在该块之后添加与新验证按钮对应的新行。

我显然在我的头上，在这里; 我以某种方式，在某个地方做了一些事情——但根本无法想象是什么，也无法想象如何克服这一点。（幸运的是，原始版本和修改版本都创建了我需要的输出，所以这并不紧急 - 但它让我发疯，网格不会显示我的数据！）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-26T15:12:13.910

它又发生了 - 显然，VS 中有一个错误（我现在使用的是 2012，但上面的原始事件是 VS2010）。我不知道这是否仅在您在代码中定义 datagridview 属性时才会出现，或者它是否总是发生 - 但是向我的表单添加另一个控件会清除 FormDesigner.cs 中的一堆代码，您只需将其放入背部。

因此，解决方案涉及 (1) 备份副本和 (2) 使用良好的文本比较工具。

# android - 来自 Android 设备的高能效视频流

> ID：12165519
> 
> 赞同：2
> 
> 时间：2012-08-28T18:45:21.983
> 
> 标签：android, video-streaming, power-management, battery

我正在对从安卓设备的前置摄像头到本地服务器的视频流进行一些实验。目前我打算使用WiFi。我将来可能会转向蓝牙 4.0。

我正在寻找与协议选项（TCP、UDP、...？）和视频编解码器相关的见解、经验、DO 和 DON'T 以及其他我应该考虑的想法。图像质量应该足以在服务器端运行计算机视觉算法，例如人脸和物体检测、识别和跟踪。最大的担忧是权力。我想确保流媒体尽可能节能。我理解更高的电源效率意味着更低的帧速率。

此外，我需要发送视频帧而不直接在屏幕上显示它们。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:44:29.747

你没有提到你是否会在设备上进行编码或解码。

一些提示：UDP 通常会减少耗电量，尤其是在网络条件恶化的情况下：请参阅[http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.134.5517&rep=rep1&type=pdf](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.134.5517&rep=rep1&type=pdf) 查看更多关于这个在谷歌上

一般来说，就编解码器而言，就编码和解码所需的功率而言，您可以说顺序是 H264 > MPEG4 > H.263。

比特率越高，解码所需的功率就越大，但编解码器的差异比比特率的差异更大。我这样说是因为要获得与使用 H.263 的 H.264 流相同的质量，您需要更高的比特率。但是，在该比特率下的 h.263 应该比在较低比特率下的 H.264 消耗更少的功率。所以不要跨编解码器应用它。只需在选择的编解码器上使用尽可能低的比特率/帧率。

在编码过程中，虽然非常低的比特率会使编码器工作得更加努力，因此会增加功耗。所以编码比特率应该很低，但不能太低以至于编码器被拉伸。这意味着选择一个合理的比特率，它不会产生连续的块状流，但会产生不错的流输出。

在每个编解码器中，如果您可以控制编码，那么您也可以控制解码能力。以下适用于两者：即去块，B 图片将增加功率要求。保持较低的配置文件 [H.264 的基线、MPEG4 的简单配置文件和 H.263 的基线] 将导致编码和解码中的功率要求更低。如果可以，在 MPEG4 中关闭 4MV 支持。使流更易于解码。请记住，每一项都会对质量产生影响，因此您必须找到可接受的质量。

此外，除非您可以真正测量功耗，否则我不确定您是否需要对工具集进行非常精细的调整。只需坚持较低的配置文件就足够了。

捕获期间的视频质量越差，编码期间所需的功率就越多。因此，明亮的视频需要较少的编码工作，而低光视频需要更多的功率。

无需将视频发送到屏幕。您通过套接字接收视频并使用该数据做任何您想做的事情。那取决于你。您不必解码和显示它。

编辑：添加一些我能想到的东西

一般来说，编解码器的选择及其配置文件将是影响视频编码/解码系统功耗的最大因素。

最大的不同可能来自设备配置。如果您在设备中具有特定编解码器的硬件加速器，则使用这些硬件加速器可能比使用软件编解码器更便宜。因此，虽然 H.264 在软件中可能需要比 MPEG4 更多的功率，但如果设备在硬件中具有 H.264，那么它可能比在软件中的 MPEG4 便宜。所以检查你的设备硬件能力。

视频分辨率也很重要。较小的视频编码成本更低。当运行较小的分辨率时，您可以以较低的速度为您的设备计时。

# magento - Magento Front Page类别显示

> ID：12165520
> 
> 赞同：3
> 
> 时间：2012-08-28T18:45:23.420
> 
> 标签：magento

我正在尝试自定义我在 Themeforest 购买的 Blanco Magento 主题，

我想用静态图像在首页显示一些类别（不是全部），有人知道怎么做吗？

非常感谢！

PS：Magento 是 1.7

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-30T19:10:58.233

如果您需要在主页或任何 CMS 页面上显示产品，这可以轻松完成，然后执行以下操作：

a) 创建一个新的产品类别，您想在所需页面上显示它并记下生成的类别 ID（假设 id = 4）

b) 转到 Admin->CMS->Pages 并选择您想要的页面

要添加任何图像，请添加带有以下 src 的 img 标签

src="{{media url="image_path"}}"

{{block type="catalog/product_list" name="home.catalog.product.list" alias="products_homepage" category_id="4" template="catalog/product/list.phtml"}}

而已

希望这可以帮助！！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T09:04:07.607

您可以将以下代码放入 PHTML 文件中，并使用 XML 或您想要的其他方式将其包含在您的首页中。就静态图像而言，您可以从管理员添加类别图像，该图像将从给定的代码中显示 -

代码是：

```
<?php
# CategoryIDs to be display on Front Page...
$_viewCategories = array(3, 4, 5);

# Categories Counter...
$counter = count($_viewCategories);

# Get Category Model
$getCategoryModel = Mage::getModel('catalog/category');

?>
    <div class="categoryList">
<?php
for($i = 0; $i < $counter; $i++)
{
    // Load Categories...
    $getCategoryModel->load($_viewCategories[$i]);

    $getParentCategoryName = $getCategoryModel->getName();
    # echo "Parent Category Name : ".$getParentCategoryName;
    ?>
    <div class="categoryListContainer">
        <div class="categoryListHeading"><?php echo ucwords(strtolower($getParentCategoryName)); ?></div>
        <?php
        $getChildren = $getCategoryModel->getChildren();

        $subCategories = explode(",", $getChildren);
            $j = 0;
            foreach ($subCategories as $_child) {
              if($j >= 2){ break; }
                ?>
                <div style="float:left; width:205px; <?if($j == 1):?>margin-left:25px;<?php endif; ?>"  align="center">
                <?php

                    $subCategoryDetail = Mage::getModel("catalog/category")->load($_child);
                    echo "<a href='".$subCategoryDetail->getUrl()."' title='".$subCategoryDetail->getName()."'>";
                    echo "<div class='categoryListImg'><img src='".$subCategoryDetail->getImageUrl()."' height='120px' width='120px' alt='".$subCategoryDetail->getName()."' /></div>";
                    echo "<div class='categoryListCaption'>";
                    echo "<span class='catName'><span>".$subCategoryDetail->getName()."</span></span>";
                    echo "</div>";
                    echo "</a>";
                ?></div>
                <?php
              $j++;
            }
        ?>
    </div>
    <?php
}
 ?>
 </div> 
```

这是你可以用自己的风格自己管理的风格:)

希望对您有所帮助！

谢谢 ：）

# eclipse - 如何在 Eclipse 中找到对没有源代码的外部类的引用？

> ID：12165521
> 
> 赞同：1
> 
> 时间：2012-08-28T18:45:24.180
> 
> 标签：eclipse, search

如果我还没有打开一个引用该类的文件，是否有一种直接的方法可以在我的代码中找到对外部库（没有源的 jar）中的类的引用？

例如，假设我想在我的代码中找到所有引用，`System.out.println()`但我还没有打开使用`println`. 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:51:09.180

`Ctrl`您可以通过++ （在 Mac 上为`Shift`++ ）打开任何类型（类或接口） 。当类/接口源打开时，选择该类中的方法或字段（实例变量），右键单击，然后选择*References*。`T``Command``Shift``T`

 *如果您没有源代码，您将看到类文件编辑器的“找不到源”窗口。如果您尚未启用“带有编辑器的链接”图标，请启用它或选择*导航*菜单、*显示在*、*包资源管理器*。然后在包资源管理器中，选择该类中的方法或字段（实例变量），右键单击并选择*References*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:36:53.483

It would be possible to do this using a [`File Search`](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.user/reference/ref-45.htm). Press `Ctrl` + `H` and put in `System.out.println`. Adjust the scope of the search according to your needs (I usually set it to `Enclosing Project` or `Selected Resource`).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:48:01.853

我知道这样做的唯一方法是执行以下（不完全简单）序列：

1.  通过添加引用来打开和编辑现有类，例如，`System.out.println()`
2.  组织导入 ( `ctrl-shift-o`)
3.  将光标放在`println`并键入`ctrl-shift-g`或搜索、参考、工作区。
4.  关闭类而不保存它。*

# android - 带有单选按钮的 Android 对话框

> ID：12165522
> 
> 赞同：0
> 
> 时间：2012-08-28T18:45:30.970
> 
> 标签：android, android-dialog

Android中是否有办法显示一个对话框，其中已根据环境变量设置选择了一个单选按钮？

我写了以下代码。它似乎没有任何错误，我很确定它会执行，但是当显示对话框时，没有选择任何单选按钮：

```
switch (shape)
{
    case SQUARE:
        bigCircle.setSelected (false);
        smSircle.setSelected (false);
        if (size == BIG)
        {
            bigSquare.setSelected (true);
            smSquare.setSelected (false);
        }
        else
        {
            bigSquare.setSelected (false);
            smSquare.setSelected (true);
        }
        break;

    case CIRCLE:
        bigSquare.setSelected (false);
        smSquare.setSelected (false);
        if (size == BIG)
        {
            bigCircle.setSelected (true);
            smCircle.setSelected (false);
        }
        else
        {
            bigCircle.setSelected (false);
            smCircle.setSelected (true);
        }
}

dialog.show(); 
```

有什么建议么？？

谢谢，
R。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:03:41.230

您是否为对话框创建自己的自定义布局？（我假设由于变量 bigCircle，smSquare ...）

看看 AlertDialog.Builder 的方法[setSingleChoiceItems (ListAdapter adapter, **int checkedItem** , DialogInterface.OnClickListener listener)](http://developer.android.com/reference/android/app/AlertDialog.Builder.html#setSingleChoiceItems%28android.widget.ListAdapter,%20int,%20android.content.DialogInterface.OnClickListener%29)也许这会是更好的方法......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:54:38.323

您需要带有所需视图的自定义对话框。也许您可以查看带有单选列表的 APIDemos->app->alerdialogs-> 警报对话框。根据您的要求修改布局。

你可以在你的对话框中扩展自定义 ui，它可以包含复选框、单选按钮或几乎任何东西。

# javascript - 使用 2 个下拉列表显示/隐藏分区

> ID：12165524
> 
> 赞同：0
> 
> 时间：2012-08-28T18:45:41.523
> 
> 标签：javascript, html

我对 javascript 和 jquery 完全陌生。目前我想用 2 个下拉列表创建一个简单的显示隐藏功能。我将在代码下面进一步解释。如果可以，请尝试下面的代码，它可以帮助您更好地理解我的问题。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
  <title></title>

<style type="text/css">
.hide {
  display:none;
}
</style>

<script  type="text/javascript">

function PriceCharts(charts1){
 var PriceCharts=charts1.options;
 for (var a=1;a<=500;a++){
  if (document.getElementById(PriceCharts[a].value)){
   document.getElementById(PriceCharts[a].value).style.display=PriceCharts[a].selected?'block':'none';
  }
 }
}

function IndicatorCharts(charts2){
 var IndicatorCharts=charts2.options;
 for (var b=1;b<=500;b++){
  if (document.getElementById(IndicatorCharts[b].value)){
   document.getElementById(IndicatorCharts[b].value).style.display=IndicatorCharts[b].selected?'block':'none';
  }
 }
}

</script>
</head>

<body>
<div style="width:800px;border:1px solid black">
Price Chart<select onchange="PriceCharts(this);">
<option value="" ></option>
<option value="PriceCharts1" >1 day</option>
<option value="PriceCharts2" >5 days</option>
</select>
</div>
</div>
<div style="width:800px;height:300px;border:1px solid black">

<div id="PriceCharts1" class="hide" >
Indicator Chart 1<select onchange="IndicatorCharts(this);">
<option value="" ></option>
<option value="IndicatorCharts1" >Indicator 1</option>
<option value="IndicatorCharts2" >Indicator 2</option>
</select>
<div style="height:250px;border:1px solid black">
1 day price chart
</div>
</div>

<div id="PriceCharts2" class="hide">
Indicator Chart 2<select onchange="IndicatorCharts(this);">
<option value=""></option>
<option value="IndicatorCharts3" >Indicator 3</option>
<option value="IndicatorCharts4" >Indicator 4</option>
</select>

<div style="height:250px;border:1px solid black">
5 day price chart
</div>
</div>
</div>
</body>
</html> 
```

目前，问题是我想要第二个下拉列表的内容，即“Indicator Chart”可以替换“Pirce Chart”的内容。例如，当我在第一个下拉列表中单击“1 day”时，第二个下拉列表（1），即“Indicator Chart 1”和“1 day price chart”将显示在一个div中. 如果现在我点击“指标图表 1”列表中的“指标 1”，我希望“指标 1”替换“1 天价格图表”。如果我单击“指标图表 1”列表中的空白选项，它将显示“1 天价格图表”。而且，如果我单击“价格图表”中的任何选项，我希望每个选项中的“指标图表”将其选项设置为空白并始终显示相关的价格图表。

我知道这有点复杂和麻烦……但这对我来说非常重要。请帮帮我......我已经搜索了整个晚上的解决方案......

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T21:23:42.207

我的建议是使用[jquery](http://docs.jquery.com/Main_Page)，它会让你的生活更轻松（我在下面提供了一些链接）。现在，我不确定这就是你要找的东西，但请告诉我。我使用 jsfiddle提供了一个[DEMO HERE 。](http://jsfiddle.net/Mz4SN/54/)

代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
  <title></title>

<style type="text/css">
div{
    width:800px;
    border:1px solid black;
    display:block;
}
#pcDiv{
    width:800px;
    border:1px solid black;
}
.content{
 height:250px;   
}
#priceChart1, #priceChart2, #indicatorChartInfo1, #indicatorChartInfo2{
 display:none;   
}

</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script  type="text/javascript">
$(document).ready(function(){   //MAKES SURE DOCUMENT IS READY
    $("#pcSelect").change(function() {   
        //.change(function(){ similar to ONCHANGE
        // WHEN USING JQUERY, MAKE SURE TO USE '$(this)' instead of 'this'
        //I also used filter/index to find which option was selected
      var index= $(this).children(":selected").index();
            if(index!=0){
               $("#pcDiv").siblings().hide();
               $("#priceChart" + index).show();
            }
            else{
                $("#pcDiv").siblings().hide();
            }
    });  

    $("#priceChart1>select, #priceChart2>select").change(function(){
        var index= $(this).children(":selected").index();
        $(this).siblings().show();

          if(index!=0){
              $(this).siblings().text($(this).children(":selected").text());
          }
          else{
                $(this).siblings().hide();
          }
    });
});​
</script>
</head>

<body>
<div id="pcDiv">
Price Chart   
    <select id="pcSelect">
        <option>--Choose--</option> <!--CAN SAY WHATEVER YOU LIKE -->
        <option>1 day</option>
        <option>5 days</option>
    </select>
</div>

<div id="priceChart1">
    Indicator Chart 1
    <select>
        <option></option>
        <option>Indicator 1</option>
        <option>Indicator 2</option>
    </select>

    <div id="indicatorChartInfo1" class="content">
    Info1
    </div>
</div>

<div id="priceChart2">
Indicator Chart 2
    <select>
        <option></option>
        <option>Indicator 3</option>
        <option>Indicator 4</option>
    </select>

    <div id="indicatorChartInfo2" class="content">
    Info2
    </div>
</div>
</body>
</html> 
```

链接：

*   [jquery.com](http://www.jquery.com)
*   [教程](http://www.impressivewebs.com/jquery-tutorial-for-beginners/)

# iphone - 使用多个对象对 NSMutableArray / Dictionary 进行排序

> ID：12165525
> 
> 赞同：0
> 
> 时间：2012-08-28T18:45:42.450
> 
> 标签：iphone, ios, xcode, nsmutablearray, nsmutabledictionary

我有一个我认为我过于复杂的问题。

我需要制作 NSMutableArray 或 NSMutableDictionary。我将添加至少两个对象，如下所示：

```
NSMutableArray *results = [[NSMutableArray alloc] init];

[results addObject: [[NSMutableArray alloc] initWithObjects: [NSNumber numberWithInteger:myValue01], @"valueLabel01", nil]]; 
```

这给了我需要的数组，但是在添加了所有对象之后，我需要能够按第一列（整数 - myValues）对数组进行排序。我知道当有键时如何排序，但我不确定如何添加键或者是否有另一种方法来对数组进行排序。

稍后我可能会向数组中添加更多对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:47:12.217

快速参考这个问题的另一个很好的答案：

[如何使用 sortedArrayUsingDescriptors 对 NSMutableArray 进行排序？](https://stackoverflow.com/questions/1844031/how-to-sort-nsmutablearray-using-sortedarrayusingdescriptors)

在这些情况下，NSSortDescriptors 可以成为你最好的朋友 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:52:20.930

您在这里所做的是创建一个包含两个元素的列表：[NSNumber numberWithInteger:myValue01] 和 @"valueLabel01"。在我看来，您想保留记录，每条记录都有一个数字和一个字符串？您应该首先创建一个包含数字和字符串的类，然后考虑排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:56:05.167

sortedArrayUsingComparator: 方法不适合你吗？就像是：

```
- (NSArray *)sortedArray {
    return [results sortedArrayUsingComparator:(NSComparator)^(id obj1, id obj2)
    {
        NSNumber *number1 = [obj1 objectAtIndex:0];
        NSNumber *number2 = [obj2 objectAtIndex:0];
        return [number1 compare:number2]; }];
    } 
```

# javascript - javascript: 查找/替换正则表达式帮助 - 粗体、斜体和特定字符

> ID：12165530
> 
> 赞同：1
> 
> 时间：2012-08-28T18:45:57.313
> 
> 标签：javascript, regex, replace, bold, italic

HTML/概念：

```
 <textarea id="input"></textarea>        
    <button onclick="format()">submit</button>
    <textarea id="output"></textarea> 
```

我经常需要为客户将文档转换为 html，而且我厌倦了不得不查找/替换 + 手动更改/添加适当的 HTML。所以我寻找了我梦想中的格式化程序，但找不到任何东西（如果你知道合适的格式化程序，请发布），所以我想我会用 javascript 编写自己的格式化程序。这非常简单，但我不熟悉正则表达式并且遇到了一些麻烦，这是我能够使用我在其他帖子中找到的正则表达式拼凑而成的内容：

```
 var email = /(\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,6})/gim;
    var url = /(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
    var br = /(\r\n|\n|\r)/gm;

    function format() {

        var input = $('#input').val();

        var check1 = input.replace(br,"<br>");
        var check2 = check1.replace(url,'<a href="$1" target="blank">$1</a>');
        var check3 = check2.replace(email, '<a href="mailto:$1">$1</a>' );
        var check4 = check3.replace(etc, ...);

        var output = check4;
        $('#output').val(output);
    } 
```

还有几件事我想做，但似乎无法找到/编写正确的正则表达式，这些是：

1.  找到任何粗体字符，并用适当的 html/css 替换它们
2.  找到任何斜体字符，并用适当的 html/css 替换它们
3.  查找特定字符（©、“、”、ñ 等）并将它们替换为适当的字符/实体，即：

    ```
     [&#169; , " , " , &ntilde; , etc] 
    ```

如果这已得到解答，我深表歉意，但我似乎找不到这些位（也许我问错了问题？），找到粗体/斜体以及替换特定字符/实体的任何帮助都会很棒！另外，如果我以错误的方式解决这个问题，请叫我出来。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T05:48:02.077

好吧，正如@sourcejedi 指出的那样，看起来粗体/斜体并不是一个真正的选择。但我想出了如何用正则表达式查找/替换我需要的所有其他内容。同样，这是一项非常具体的任务，我碰巧经常要做（将通常很长的 [通常是西班牙语 w/重音字符] google doc 文件转换为 html），以防其他人在同一/类似的船，这就是我最终得到的：

HTML：

```
 <textarea id="input" cols="50" rows="10"></textarea><br>
    <button onclick="format()">format!</button><br>
    <textarea id="output" cols="50" rows="10"></textarea><br> 
```

Javascript：

```
 function format() {

        var input = document.getElementById('input').value; // get input txt 
        var output = document.getElementById('output');     //target ouput txt box
        var i = input;                                      

        var email = /(\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,6})/gim;
        var url = /(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
        var br = /(\r\n|\n|\r)/gm;

        i = i.replace(br, '<br>'+'\n'); 
        i = i.replace(url, '<a href="$1" target="blank">$1</a>'); 
        i = i.replace(email, '<a href="mailto:$1">$1</a>' );
        i = i.replace( /\u2018|\u2019|\u201A|\uFFFD/g, "'" );
        i = i.replace( /\u201c|\u201d|\u201e/g,  '"' );
        i = i.replace( /\u02C6/g, '^' );
        i = i.replace( /\u2039/g, '<' );
        i = i.replace( /\u203A/g, '>' );
        i = i.replace( /\u2013/g, '-' );
        i = i.replace( /\u2013/g, '-' ); 
        i = i.replace( /\u2022/g, '<span style="padding-left:15px;">&#38;'+'#8226;</span>' ); 
        i = i.replace( /\u00C9/g, '&#38;'+'Eacute;' ); // E w/accent
        i = i.replace( /\u00CD/g, '&#38;'+'Iacute;' ); // I w/accent
        i = i.replace( /\u00D3/g, '&#38;'+'Oacute;' ); // O w/accent
        i = i.replace( /\u00DA/g, '&#38;'+'Uacute;' ); // U w/accent
        i = i.replace( /\u00DD/g, '&#38;'+'Yacute;' ); // Y w/accent
        i = i.replace( /\u00D1/g, '&#38;'+'Ntilde;' ); // Nye
        i = i.replace( /\u00E1/g, '&#38;'+'aacute;' ); // a w/accent
        i = i.replace( /\u00E9/g, '&#38;'+'eacute;' ); // e w/accent
        i = i.replace( /\u00ED/g, '&#38;'+'iacute;' ); // i w/accent
        i = i.replace( /\u00F3/g, '&#38;'+'oacute;' ); // o w/accent
        i = i.replace( /\u00FA/g, '&#38;'+'uacute;' ); // u w/accent
        i = i.replace( /\u00FD/g, '&#38;'+'yacute;' ); // y w/accent
        i = i.replace( /\u00F1/g, '&#38;'+'ntilde;' ); // nye
        i = i.replace( /\u2014/g, '&#38;'+'#8212;' );  // mdash
        i = i.replace( /\u2026/g, '...' );      // elipses
        i = i.replace( /\u00A9/g, '&#38;'+'#169;' );   // copyright logo
        i = i.replace( /\u00AE/g, '&#38;'+'#174;' );      // restricted logo
        i = i.replace( /\u2122/g, '&#38;'+'#8482;' );  // trade mark logo
        i = i.replace( /\u00BC/g, '&#38;'+'#188;' );   // 1/4
        i = i.replace( /\u00BD/g, '&#38;'+'#189;' );   // 1/2
        i = i.replace( /\u00BE/g, '&#38;'+'#190;' );   // 3/4
        i = i.replace(/[\u02DC|\u00A0]/g, " "); // speacial spaces characters            

        output.innerHTML = i;
    } 
```

...对于那些真正感兴趣的人，这里有一个带有可调参数的版本（预加载电子邮件，使用自定义 CSS 添加包装器 div，target=blank 切换，mailto 切换，缩小等） [http://jsfiddle.net/N4vrE/](http://jsfiddle.net/N4vrE/)

# django - 如何在 Django 的设置文件中指定多个“init_command”

> ID：12165534
> 
> 赞同：9
> 
> 时间：2012-08-28T18:46:10.790
> 
> 标签：django, mysql-python

我有以下设置用于连接到 Django 中的 MySQL 数据库。

```
'default': {
    'NAME' : MYSQL_DB_NAME,
    #'ENGINE' : 'mysql',
    'ENGINE' : 'django.db.backends.mysql',
    'USER' : 'ccurvey',
    'PASSWORD' : MYSQL_PASSWORD,
    'HOST' : MYSQL_HOST,
    'PORT' : '',
    'OPTIONS' : {
        'init_command' : 'set storage_engine=INNODB',
        },
    }, 
```

到目前为止，一切都很好。

如果我想在我的“init_command”中添加另一个“set”命令，咒语是什么

```
 'init_command' : ('set storage_engine=INNODB',
                           'set transaction isolation level read committed'), 
```

给我“connect() 参数必须是字符串，而不是元组”

```
 'init_command' : ('set storage_engine=INNODB; set transaction isolation level read committed;'), 
```

给我

```
_mysql_exceptions.ProgrammingError: (2014, "Commands out of sync; you can't run this command now") 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-07-23T12:43:46.637

对我来说有效的是：

```
{ 'init_command': 'set storage_engine=InnoDB; \
                   set session transaction isolation level read committed'} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T18:50:19.930

不是：

```
 "init_command": 'set storage_engine=INNODB,    \
                  set transaction isolation level read committed;', } 
```

这是：

```
 "init_command": 'set storage_engine=INNODB,    \
                  SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED', } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-28T09:35:07.460

@ChrisCurvey's solution is OKay for me.

*ENV: Python3.7.3 + Django2.2.1*

```
'OPTIONS': {
    'init_command': 'SET default_storage_engine=INNODB, sql_mode="STRICT_TRANS_TABLES" ',
    'charset': 'utf8mb4',
}, 
```

# css - Twitter Bootstrap 下拉菜单在折叠的导航栏中创建额外的插入符号

> ID：12165544
> 
> 赞同：2
> 
> 时间：2012-08-28T18:46:49.213
> 
> 标签：css, drop-down-menu, twitter-bootstrap, responsive-design

我正在使用[Twitter Bootstrap](http://getbootstrap.com)

并且`dropdown menu`in有问题`collapsed navbar`。

通过单击右上角的按钮打开菜单，可以在折叠版本中打开菜单。

仅当屏幕折叠到足以显示导航栏的折叠版本时，才会创建额外的插入符号。

如何解决这个问题，看不到下拉菜单上方的额外插入符号？

我不想在`Category`菜单上方看到奇怪的插入符号。

[演示](http://jsfiddle.net/inspired_jw/aBt89/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:41:59.630

这是由 Bootstrap 导航的默认样式引起的。删除它的最简单方法是通过将此 CSS 类放置在引导 CSS 文件后加载的 CSS 中的某个位置来覆盖创建此样式的样式。

```
.nav li.dropdown ul.dropdown-menu:before, .nav li.dropdown ul.dropdown-menu:after {
  display: none;
} 
```

# command-line-arguments - 将带空格的文件名传递给 pstotxt3.exe

> ID：12165554
> 
> 赞同：1
> 
> 时间：2012-08-28T18:47:23.640
> 
> 标签：command-line-arguments, postscript

我有一个将 postscript 文件转换为文本的 exe，现在问题是当输入文件名包含空格时，它会显示“GPL Ghostscript 9.00：不可恢复的错误，退出代码 1”，但当输出文件不包含空格时没有问题。我在 bat 文件中运行以下命令

pstotxt3.exe -bboxes -输出“2dh 21za1.1jp.ps.pstotext.txt”“2dh 21za1.1jp.ps”

其中 2dh 21za1.1jp.ps.pstotext.txt 是输出文件名，2dh 21za1.1jp.ps 是输入文件名

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T07:06:14.790

尝试双引号输入文件名。我不熟悉 pstotxt3，但它看起来像是将 GS 作为一个单独的进程运行，并将输入文件名作为命令行参数传递。pstotxt3 命令行上的 " 标记被命令处理器剥离，因此当 GS 看到文件名时，它认为它们是多个开关。

所以我建议： pstotxt3.exe -bboxes -output "2dh 21za1.1jp.ps.pstotext.txt" ""2dh 21za1.1jp.ps""

但这只是一个猜测。你能发布完整的错误吗？

# perl - perl如何使用exists来检查哈希是否在哈希数组中

> ID：12165555
> 
> 赞同：0
> 
> 时间：2012-08-28T18:47:24.433
> 
> 标签：perl, hash, exists

我有两个哈希数组：AH1 和 AH2。

```
$AH1 = [  
          {
            'id' => 123,  
            'name' => abc
          },  
          {
            'id' => 456,  
            'name' => def
          },  
          {
            'id' => 789,  
            'name' => ghi
          },  
          {
            'id' => 101112,  
            'name' => jkl
          },  
          {
            'id' => 1389,  
            'name' => mno
          }  
        ];  

$AH2 = [  
          {
            'id' => 123,  
            'name' => abc
          },  
          {
            'id' => 1389,  
            'name' => mno
          },  
          {
            'id' => 779,  
            'name' => ghi
          }  
        ]; 
```

如何使用 Perl**存在**函数打印 AH2 中的 AH1 的哈希值？或者不必在数组中迭代。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:56:43.483

`exists`按索引定位，它们是 0,1,2，而不是 123,1389,779。`exists`没办法。

此外，您必须遍历两个数组（一种或另一种方式），除非您将其中一个数组切换为散列。

```
$HH2 = {
   123 =>  {
             'id' => 123,  
             'name' => abc
           },  
   1389 => {
            'id' => 1389,  
            'name' => mno
           },  
   779  => {
             'id' => 779,  
             'name' => ghi
           }
}; 
```

事实上，切换是解决这个问题的最简单方法。

```
my %HH2 = map { $_->{id} => $_ } @$AH2;
for (@$AH1) {
    print "$_->{id} in both\n"
       if $HH2{ $_->{id} };
} 
```

它也非常有效：您只对每个数组进行一次迭代。

# winapi - MultiByteToWideChar 是可重入的还是线程安全的？

> ID：12165558
> 
> 赞同：2
> 
> 时间：2012-08-28T18:47:49.913
> 
> 标签：winapi, unicode, thread-safety

我的应用程序中的多个线程将调用 MultiByteToWideChar 将 UTF-8 转换为 wchar_t 字符串。我一直无法找到任何说明此函数是可重入还是线程安全的文档。如果不需要，我想避免同步对此方法的调用。有谁知道答案或如何找到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:02:38.923

该函数是线程安全的......但我没有明确的链接来证明它！

[关于这个线程](http://social.msdn.microsoft.com/Forums/en-US/vclanguage/thread/6398cda5-5393-4b16-b8dc-5bbf8902033f/)有一些讨论 ......但一般来说，规则是如果 API 调用没有一些特定的上下文（例如句柄），则使用其他显式线程规则（即整个 GDI 层）调用它) 那么它应该是线程安全的。

不过，在文档中更明确地指出这一点肯定会很好。

# java - 我无法在我的 Spring Web Flow 项目中使用休眠模式

> ID：12165564
> 
> 赞同：0
> 
> 时间：2012-08-28T18:48:12.093
> 
> 标签：java, spring, hibernate, spring-webflow

我无法在我的 Spring Web Flow 项目中进行休眠。我不断让 sessionFactory 工作。有人可以告诉我为什么这给了我一个错误

这是我的项目中的文件列表：

```
activation-1.1.jar
antlr-2.7.6.jar
aopalliance-1.0.jar
asm-3.1.jar
asm-attrs-1.5.3.jar
aspectjrt-1.6.8.jar
aspectjweaver-1.6.8.jar
cas-client-core-3.2.1.jar
cglib-2.2.jar
commons-beanutils-1.8.0.jar
commons-codec-1.4.jar
commons-collections-3.1.jar
commons-dbcp.jar
commons-digester-1.8.1.jar
commons-email-1.0.jar
commons-fileupload-1.1.1.jar
commons-io-1.1.jar
commons-lang-2.5.jar
commons-logging-1.1.1.jar
commons-pool.jar
dom4j-1.6.1.jar
dumbster-1.6.jar
ehcache-1.2.3.jar
files.txt
hibernate-3.2.6.ga.jar
hibernate-annotations-3.5.0-Final.jar
hibernate-commons-annotations-3.2.0.Final.jar
hibernate-core-3.5.0-Final.jar
hibernate-entitymanager-3.5.0-Final.jar
hibernate-jpa-2.0-api-1.0.0.Final.jar
hibernate-search-3.0.0.GA.jar
hibernate-validator-4.0.2.GA.jar
hsqldb-1.8.0.10.jar
httpclient-4.1.2.jar
httpclient-cache-4.1.2.jar
httpcore-4.1.2.jar
httpmime-4.1.2.jar
icu4j-2.6.1.jar
jackson-core-asl-1.5.3.jar
jackson-mapper-asl-1.5.3.jar
javassist-3.9.0.GA.jar
jaxb-api-2.1.jar
jaxb-impl-2.1.3.jar
jaxen-1.1.1.jar
jcl-over-slf4j-1.5.10.jar
jdom-1.0.jar
joda-time-1.6.jar
joda-time-jsptags-1.0.2.jar
jstl-1.2.jar
jta-1.1.jar
list.txt
log4j-1.2.15.jar
lucene-core-2.3.2.jar
lucene-highlighter-2.0.0.jar
mail-1.4.jar
mysql-connector-java-5.0.5.jar
org.springframework.aop-3.1.1.RELEASE.jar
org.springframework.asm-3.1.1.RELEASE.jar
org.springframework.aspects-3.1.1.RELEASE.jar
org.springframework.beans-3.1.1.RELEASE.jar
org.springframework.binding-2.3.1.RELEASE.jar
org.springframework.context-3.1.1.RELEASE.jar
org.springframework.context.support-3.1.1.RELEASE.jar
org.springframework.core-3.1.1.RELEASE.jar
org.springframework.expression-3.1.1.RELEASE.jar
org.springframework.faces-2.3.1.RELEASE.jar
org.springframework.instrument-3.1.1.RELEASE.jar
org.springframework.instrument.tomcat-3.1.1.RELEASE.jar
org.springframework.jdbc-3.1.1.RELEASE.jar
org.springframework.jms-3.1.1.RELEASE.jar
org.springframework.js-2.3.1.RELEASE.jar
org.springframework.js.resources-2.3.1.RELEASE.jar
org.springframework.orm-3.1.1.RELEASE.jar
org.springframework.oxm-3.1.1.RELEASE.jar
org.springframework.test-3.1.1.RELEASE.jar
org.springframework.transaction-3.1.1.RELEASE.jar
org.springframework.web-3.1.1.RELEASE.jar
org.springframework.webflow-2.3.1.RELEASE.jar
org.springframework.web.portlet-3.1.1.RELEASE.jar
org.springframework.web.servlet-3.1.1.RELEASE.jar
org.springframework.web.struts-3.1.1.RELEASE.jar
persistence-api-1.0.jar
quartz-1.5.2.jar
slf4j-api-1.5.10.jar
slf4j-log4j12-1.5.10.jar
spring-security-cas-3.1.0.RELEASE.jar
spring-security-config-3.0.3.RELEASE.jar
spring-security-config-3.1.0.RELEASE.jar
spring-security-core-3.1.0.RELEASE.jar
spring-security-crypto-3.1.0.RELEASE.jar
spring-security-ldap-3.1.0.RELEASE.jar
spring-security-openid-3.1.0.RELEASE.jar
spring-security-remoting-3.1.0.RELEASE.jar
spring-security-taglibs-3.1.0.RELEASE.jar
spring-security-web-3.1.0.RELEASE.jar
spring-tx-3.0.5.RELEASE.jar
stax-api-1.0-2.jar
tiles-api-2.1.3.jar
tiles-core-2.1.3.jar
tiles-jsp-2.1.3.jar
tiles-servlet-2.1.3.jar
urlrewritefilter-3.1.0.jar
validation-api-1.0.0.GA.jar
xalan-2.6.0.jar
xml-apis-1.3.02.jar
xmlParserAPIs-2.6.2.jar
xom-1.0.jar 
```

这是我的错误：

```
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in ServletContext resource [/WEB-INF/spring/database.xml]: Invocation of init method failed; nested exception is java.lang.IncompatibleClassChangeError: Implementing class
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:848)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:790)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
    ... 56 more
Caused by: java.lang.IncompatibleClassChangeError: Implementing class
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2818)
    at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1159)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1647)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
    at java.lang.Class.getDeclaredConstructors0(Native Method)
    at java.lang.Class.privateGetDeclaredConstructors(Class.java:2406)
    at java.lang.Class.getConstructor0(Class.java:2716)
    at java.lang.Class.getDeclaredConstructor(Class.java:2002)
    at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:104)
    at org.springframework.orm.hibernate3.LocalSessionFactoryBean.newConfiguration(LocalSessionFactoryBean.java:818)
    at org.springframework.orm.hibernate3.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:549)
    at org.springframework.orm.hibernate3.AbstractSessionFactoryBean.afterPropertiesSet(AbstractSessionFactoryBean.java:188)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:52:53.800

您正在使用`hibernate-3.2.6.ga.jar`和`hibernate-core-3.5.0-Final.jar`。那是很不一样的。尝试使用较新`hibernate ga`的 .

# objective-c - 如何从 html 字符串中获取描述文本？

> ID：12165576
> 
> 赞同：-3
> 
> 时间：2012-08-28T18:49:16.233
> 
> 标签：objective-c, ios, cocoa-touch

> **可能重复：**
> [解析 HTML iPhone](https://stackoverflow.com/questions/6396901/parse-html-iphone)

我是 iPhone 开发的新手，我想要标签之后和之前的文本

谁能建议

tenpDesc 的打印说明：

```
<p><a href="http://news.yahoo.com/blogs/lookout/isaac-hurricane-163319596.html"><img src="http://l1.yimg.com/bt/api/res/1.2/Vjy6kqzuLBWRutEELYQRoQ--/YXBwaWQ9eW5ld3M7Zmk9ZmlsbDtoPTg2O3E9ODU7dz0xMzA-/http://media.zenfs.com/en_us/News/Reuters/2012-08-28T142918Z_1781079790_GM1E88S1QC101_RTRMADP_3_STORM-ISAAC.JPG" width="130" height="86" alt="New Orleans resident Whipple watches waves crash on the shore of Lake Pontchartrain as Tropical Storm Isaac approaches New Orleans" align="left" title="New Orleans resident Whipple watches waves crash on the shore of Lake Pontchartrain as Tropical Storm Isaac approaches New Orleans" border="0" /></a>Tropical Storm Isaac is now Hurricane Isaac. The slow-moving storm, with maximum sustained winds of 75 mph, achieved hurricane status at approximately 12:20 p.m. ET on Tuesday, the National Hurricane Center said: ...RECONNAISSANCE DATA INDICATE ISAAC FINALLY ACHIEVES HURRICANE STATUS...REPORTS FROM AN AIR FORCE RESERVE HURRICANE HUNTER AIRCRAFT INDICATE THAT MAXIMUM WINDS ASSOCIATED WITH ISAAC HAVE [...]</p><br clear="all"/> 
```

谢谢

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-08-28T18:54:04.907

这需要解析并且在 Objective-C 中不是原生的。您必须编程或找到一个 3rd 方解析器（我个人不知道）。

# objective-c - 未从 Core Data 获取数据

> ID：12165584
> 
> 赞同：0
> 
> 时间：2012-08-28T18:50:00.740
> 
> 标签：objective-c, ios, cocoa-touch, core-data, nsfetchrequest

我正在使用 Core Data 为我的应用程序存储一些信息。我有一个包含 8 个实体的 .xcdatamodeld 文件，我将它们提取到不同的视图中。

在其中一个 viewController 中，我调用了其中的三个。像这样：

```
 AppDelegate *appDelegate = (AppDelegate *) [[UIApplication sharedApplication]delegate];

managedObjectContext = appDelegate.managedObjectContext;

NSManagedObjectContext *moc = [self managedObjectContext];

NSEntityDescription *entiAll = [NSEntityDescription entityForName:@"AllWeapons" inManagedObjectContext:moc];
NSFetchRequest *frAll = [[NSFetchRequest alloc] init];
[frAll setEntity:entiAll];
NSError *error = nil;
arrAll = [moc executeFetchRequest:frAll error:&error];
displayArray = [[NSMutableArray alloc]initWithArray:arrAll];

NSEntityDescription *entiRange = [NSEntityDescription entityForName:@"WeaponsRanged" inManagedObjectContext:moc];
NSFetchRequest *frRanged = [[NSFetchRequest alloc] init];
[frRanged setEntity:entiRange];
NSError *errorRanged = nil;
arrRange = [moc executeFetchRequest:frRanged error:&errorRanged];
NSLog(@"%i, %i", [arrRange count], [[moc executeFetchRequest:frRanged error:&errorRanged] count]);

NSEntityDescription *entiMelee = [NSEntityDescription entityForName:@"WeaponsMelee" inManagedObjectContext:moc];
NSFetchRequest *frMelee = [[NSFetchRequest alloc] init];
[frMelee setEntity:entiMelee];
NSError *errorMelee = nil;
arrMelee = [moc executeFetchRequest:frMelee error:&errorMelee];
NSLog(@"%i, %i", [arrMelee count], [[moc executeFetchRequest:frMelee error:&errorMelee] count]); 
```

问题是中间那个（填充 arrRange-array 的那个）不起作用..

arrAll 使用所有正确的数据注销，arrMelee 使用所有正确的数据注销（x4 出于某种原因，不知道这是否相关：S），但 arrRange 作为空数组注销。 `[arrRange count];`给我 0，即使我知道那里有很多数据。我在模拟器上运行了这段代码，找到了 .sqlite 文件，在 Firefox 的 SQLite 管理器中打开它，看到了正确的数据，40 行。

我进入 appDelegate，在必要时填充 CoreData，并看到以 JSON 格式下载数据的方法也成功地将其发送到 sqlite。

在这里，我用来自 json 的数据填充 CoreData：

```
[self deleteAllObjects:@"WeaponsRanged"];
NSManagedObjectContext *context = [self managedObjectContext];

for(NSDictionary *item in jsonWeaponRanged)
{
    WeaponsRanged *wr = [NSEntityDescription insertNewObjectForEntityForName:@"WeaponsRanged" 
                    inManagedObjectContext:context];
    ///***///
    wr.recoil = [item objectForKey:@"Recoil"];
    ///***///

     NSError *error;
    if(![context save:&error])
        NSLog(@"%@", [error localizedDescription]);
} 
```

如果我在这里，`NSLog(@"%@ - %@", wr.recoil, [item objectForKey:@"Recoil"]);`我会得到正确的数据。（两者数据相同）

所以。正确的数据显然在核心中。但是我的 NSFetchRequest 或其他东西失败了。我在 Objective-C 上很菜鸟，所以这可能是我糟糕的代码语法再次引人注目。我意识到我应该再次使用东西等，而不是一直创建新对象。但是 cmon，这是我的第一个应用程序。如果这确实是问题，我可能会学习。但我被困住了。

有时我得到数据，有时我没有。有点奇怪。我重新启动了该应用程序，并从中获取了数据，但现在我没有……我还没有找到模式……

任何人？还是有另一种方式从实体请求数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T23:17:34.707

我有一些建议，太大了，无法评论。

1) 在创建 WeaponsRanged 之后，尝试读回它们：

```
for(NSDictionary *item in jsonWeaponRanged)
{
    WeaponsRanged *wr = [NSEntityDescription insertNewObjectForEntityForName:@"WeaponsRanged" 
                    inManagedObjectContext:context];
    NSLog(@"IS WR Realized? %@", wr ? @"YES" : @"NOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO WR");
    ///***///
    wr.recoil = [item objectForKey:@"Recoil"];
    ///***///

     NSError *error;
    if(![context save:&error])
        NSLog(@"%@", [error localizedDescription]);
}

// Now lets see if we can retrieve them:
{
    NSEntityDescription *entiRange = [NSEntityDescription entityForName:@"WeaponsRanged" inManagedObjectContext:context];
    NSFetchRequest *frRanged = [[NSFetchRequest alloc] init];
    [frRanged setEntity:entiRange];
    NSError *errorRanged = nil;
    arrRange = [context executeFetchRequest:frRanged error:&errorRanged];
    NSLog(@"Wrote %i items, read back %i items", [jsonWeaponRanged count], [arrRange count] );
} 
```

2）在读取WeaponsRanged的viewController中，在mod上的fetch之前添加一个assert：

```
 NSLog(@"IS moc set? %@", moc ? @"YES" : @"NOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO MOC"); 
```

编辑：

3) 在您访问 MOC 的任何地方传播语句：

```
assert([NSThread isMainThread]); 
```

[如果您在谷歌之前没有使用过断言并阅读该主题。这些是开发人员在潜在问题出现在 gui 或其他地方之前找出潜在问题的强大工具。它们通常被编译出来用于发布/分发版本。]

如果线程不是主线程，这将强制异常，然后让您通过跟踪堆栈跟踪来追踪原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:03:41.003

没关系！这是我自己该死的错（又一次..）。

问题出现在我提供的代码之前，事实证明，当问题出现时，数据从未在 .sqlite 文件中。

这就是我所拥有的：

我通过 json-request 从互联网收集数据。我已经告诉该应用程序通过互联网检查数据的“版本”，如果数据已过时，则重新下载。

首先，我下载所有数据，然后将它们添加到 Core Data 中自己的实体中。下载后，我清除下载数据的当前Core Data实体。所以在每个 add-method 的顶部，它说 ie `[self deleteAllObjectsOfEntity:@"WeaponsRanged"];`，我的整个问题是，在`addMelee`-method 中，它还说`[self deleteAllObjectsOfEntity:@"WeaponsRanged"];`而不是`@"WeaponsMelee"`，因此删除了所有远程武器，然后将近战添加到近战实体中。这也证明了我提到的另一个问题，即 arrMelee 注销了应有的数据的四倍。

The reason it sometimes worked was that the downloading is not happening in any ordered mode. So the `addRanged` was sometimes called before the `addMelee`. If ranged comes first, it clears the arrRanged, and fills it up with correct data, and THEN melee comes, and clears it out. When melee was called first, it cleared arrRanged and filled additional data to arrMelee, and THEN ranged comes and tries to clear an empty entity, and then fills it up with correct data.

The solution was obviously to change the entity deleted when adding it, as it was the wrong one.

Sorry.... :)

# c++ - 发现 char* 参数大小

> ID：12165585
> 
> 赞同：2
> 
> 时间：2012-08-28T18:50:02.080
> 
> 标签：c++, function, parameters, char

我有一个函数，它有一个`char*`as 参数来从函数内部接收一些信息。( `int foo(char* param1)`)

我怎样才能确定这个参数有足够的分配空间来接收我需要输入的所有信息？我可以确定它是否是一个有效的指针，但我还没有找到一种方法来确定分配给参数的大小/长度。

我无法更改功能（无法添加其他带有大小的参数）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T18:54:00.220

AFIAK，C++ 没有任何工具来验证分配给指针的空间量。如果输入指向一个以 NULL 结尾的字符数组（即一个 c 字符串），那么您可以使用 strlen()。通常，C 和 C++ 中的这些类型的函数必须详细说明参数的预期内容。该函数通常是在调用者遵守记录的合同的情况下实现的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T18:52:58.060

如果我正确理解了这个问题，那么您将无法确定与指针关联的有效内存的大小。如果这是指向一个数据数组，这是传递大小参数的常用方法，但如果您没有该选项，您将不知道您将访问什么

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-28T18:58:46.767

简单的回答：你不能。

稍微复杂一点的 C 风格答案：如果该字符数组有一个终止 NUL (0) 字节，则可以使用`strlen()`.

特定于操作系统的答案：如果数组的内存是使用 获得的`malloc()`，您可以分别使用`malloc_size()`和`malloc_usable_size()`至少在 OS X 和 Linux 上。在 Windows 上，对于使用 Microsoft C 运行时的应用程序，有该`_msize()`功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T19:12:45.767

你不能确定。并不真地。您可以对指针有效性进行的唯一实际检查是检查它是否不是`NULL`.

就知道缓冲区`param1`指向的大小而言，唯一想到的是这个愚蠢的黑客。在调用函数之前，将缓冲区的大小放在指向的缓冲区的开头`param1`。然后，将数据复制到缓冲区中，完成检查后覆盖大小。

像这样：

```
*(unsigned int*)param1 = buf_size;
foo(param1);

int foo(char* param1)
{  
    if (0 == param1)
    {
        // fail
    }

    unsigned int buf_size = *(unsigned int*)param1;

    if (buf_size < whateverlimit)
    {
        // fail
    }

    // copy data into the buffer
} 
```

我尚未编译此代码，因此可能需要进行一些更正。

# drupal-7 - 自动打开 Colorbox 模态窗口

> ID：12165586
> 
> 赞同：0
> 
> 时间：2012-08-28T18:50:07.783
> 
> 标签：drupal-7, colorbox

我在 Drupal 7 中使用 Colorbox 模块。我正在打开一个外部网站。我可以通过链接使其工作。单击[此处](http://www.betararetearepublic.com/)，然后单击底部中间列的“颜色框弹出窗口”链接。客户端希望在页面打开时自动打开。我创建了一个块并添加了以下代码（来自 colorbox 站点）。

```
<script type="text/javascript">
// Display a welcome message on first visit, and set a cookie that expires in 30 days:
if (document.cookie.indexOf('visited=true') === -1) {
    var expires = new Date();
    expires.setDate(expires.getDate()+30);
    document.cookie = "visited=true; expires="+expires.toUTCString();
    jQuery.colorbox({html:"URL goes here", width:887, height:638});
}
</script> 
```

但它不起作用。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T03:45:23.820

您需要等到 DOM 准备好：

```
<script type="text/javascript">
$(document).ready(function(){
// Display a welcome message on first visit, and set a cookie that expires in 30 days:
if (document.cookie.indexOf('visited=true') === -1) {
    var expires = new Date();
    expires.setDate(expires.getDate()+30);
    document.cookie = "visited=true; expires="+expires.toUTCString();
    jQuery.colorbox({href:"URL goes here", width:887, height:638});
}
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T21:37:34.090

您需要将**open**参数设置为**true**。

所以你可以写：

```
jQuery.colorbox({href:"URL goes here", width:887, height:638, open: true}); 
```

这记录在这里： [http ://www.jacklmoore.com/colorbox](http://www.jacklmoore.com/colorbox)

# protocol-buffers - Avro 模式演变是否需要同时访问旧模式和新模式？

> ID：12165589
> 
> 赞同：14
> 
> 时间：2012-08-28T18:50:26.637
> 
> 标签：protocol-buffers, avro

如果我使用模式版本 1 序列化对象，然后将模式更新到版本 2（例如通过添加字段） - 以后反序列化对象时是否需要使用模式版本 1？理想情况下，我只想使用模式版本 2，并让反序列化对象具有在对象最初序列化后添加到模式中的字段的默认值。

也许一些代码会更好地解释......

*架构1：*

```
{"type": "record",
 "name": "User",
 "fields": [
  {"name": "firstName", "type": "string"}
 ]} 
```

*架构2：*

```
{"type": "record",
 "name": "User",
 "fields": [
  {"name": "firstName", "type": "string"},
  {"name": "lastName", "type": "string", "default": ""}
 ]} 
```

使用通用的非代码生成方法：

```
// serialize
ByteArrayOutputStream out = new ByteArrayOutputStream();
Encoder encoder = EncoderFactory.get().binaryEncoder(out, null);
GenericDatumWriter writer = new GenericDatumWriter(schema1);
GenericRecord datum = new GenericData.Record(schema1);
datum.put("firstName", "Jack");
writer.write(datum, encoder);
encoder.flush();
out.close();
byte[] bytes = out.toByteArray();

// deserialize
// I would like to not have any reference to schema1 below here
DatumReader<GenericRecord> reader = new GenericDatumReader<GenericRecord>(schema2);
Decoder decoder = DecoderFactory.get().binaryDecoder(bytes, null);
GenericRecord result = reader.read(null, decoder); 
```

导致 EOFException。`jsonEncoder`在 AvroTypeException 中使用结果。

我知道如果我将 schema1 和 schema2 都传递给`GenericDatumReader`构造函数，它将起作用，但我不想保留所有先前模式的存储库，并且还以某种方式跟踪用于序列化每个特定对象的模式。

我还尝试了代码生成方法，首先使用从 schema1 生成的 User 类序列化到文件：

```
User user = new User();
user.setFirstName("Jack");
DatumWriter<User> writer = new SpecificDatumWriter<User>(User.class);
FileOutputStream out = new FileOutputStream("user.avro");
Encoder encoder = EncoderFactory.get().binaryEncoder(out, null);
writer.write(user, encoder);
encoder.flush();
out.close(); 
```

然后将模式更新到版本 2，重新生成 User 类，并尝试读取文件：

```
DatumReader<User> reader = new SpecificDatumReader<User>(User.class);
FileInputStream in = new FileInputStream("user.avro");
Decoder decoder = DecoderFactory.get().binaryDecoder(in, null);
User user = reader.read(null, decoder); 
```

但它也会导致 EOFException。

只是为了比较，我正在尝试做的似乎与protobufs一起工作......

*格式：*

```
option java_outer_classname = "UserProto";
message User {
    optional string first_name = 1;
} 
```

连载：

```
UserProto.User.Builder user = UserProto.User.newBuilder();
user.setFirstName("Jack");
FileOutputStream out = new FileOutputStream("user.data");
user.build().writeTo(out); 
```

添加可选的 last_name 以格式化、重新生成 UserProto 和反序列化：

```
FileInputStream in = new FileInputStream("user.data");
UserProto.User user = UserProto.User.parseFrom(in); 
```

正如预期的那样，`user.getLastName()`是空字符串。

可以用 Avro 完成这样的事情吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-10-17T20:37:26.907

Avro 和 Protocol Buffers 有不同的处理版本控制的方法，哪种方法更好取决于您的用例。

在协议缓冲区中，您必须用数字显式标记每个字段，并且这些数字与字段的值一起存储在二进制表示中。因此，只要您从未在后续模式版本中更改数字的含义，您仍然可以解码以不同模式版本编码的记录。如果解码器看到它无法识别的标签号，它可以简单地跳过它。

Avro 采用了不同的方法：没有标签编号，二进制布局完全由执行编码的程序决定——这是编写者的模式。（记录的字段只是一个接一个地存储在二进制编码中，没有任何标记或分隔符，并且顺序由编写器的模式确定。）这使编码更加紧凑，并且您不必手动维护标记在架构。但这确实意味着要阅读，您必须知道写入数据的确切模式，否则您将无法理解它。

如果知道作者的模式对于解码 Avro 至关重要，那么读者的模式就是在它之上的一层美好。如果您在需要读取 Avro 数据的程序中进行代码生成，您可以从阅读器的模式中进行代码生成，这样您就不必在每次编写器的模式更改时都重新生成它（假设它的更改方式可以得到解决）。但这并不能使您不必了解作者的架构。

## 优点缺点

Avro 的方法在您拥有大量已知具有完全相同架构版本的记录的环境中非常有用，因为您可以在文件开头的元数据中包含架构，并且知道接下来的一百万条记录都可以使用该模式进行解码。这在 MapReduce 环境中经常发生，这就解释了为什么 Avro 会脱离 Hadoop 项目。

Protocol Buffers 的方法可能更适合 RPC，其中单个对象通过网络发送（作为请求参数或返回值）。如果您在这里使用 Avro，您可能有不同的客户端和不同的服务器，它们都具有不同的架构版本，因此您必须使用它正在使用的 Avro 架构版本标记每个二进制编码的 blob，并维护架构注册表。那时你可能已经使用了 Protocol Buffers 的内置标记。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-04T00:24:26.260

要执行您想要执行的操作，您需要通过允许空值使 last_name 字段成为可选字段。last_name 的类型应该是 ["null", "string"] 而不是 "string"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T07:12:29.067

我试图规避这个问题。我把它放在这里：

我也尝试过使用两个模式，一个模式只是使用 Avro 的反射 API 将另一列添加到另一个模式。我有以下架构：

```
Employee (having name, age, ssn)
ExtendedEmployee (extending Employee and having gender column) 
```

我假设之前有对象的文件`Employee`现在也有`ExtendedEmployee`对象，我试图将该文件读取为：

```
 RecordHandler rh = new RecordHandler();
    if (rh.readObject(employeeSchema, dbLocation) instanceof Employee) {
        Employee e = (Employee) rh.readObject(employeeSchema, dbLocation);
        System.out.print(e.toString());
    } else if (rh.readObject(schema, dbLocation) instanceof ExtendedEmployee) {
        ExtendedEmployee e = (ExtendedEmployee) rh.readObject(schema, dbLocation);
        System.out.print(e.toString());
    } 
```

这解决了这里的问题。但是，我很想知道是否有一个 API，我们可以在其中提供`ExtendedEmployee`模式来读取对象`Employee`。

# java - Java - 如何测试一些代码？

> ID：12165593
> 
> 赞同：1
> 
> 时间：2012-08-28T18:51:14.577
> 
> 标签：java, testing, junit, data-conversion

我不是在寻找这个问题的答案，而只是简要说明如何做到这一点。这是考试过去试卷中的一个问题。

它指出： 用英语描述一系列测试，您可以使用这些测试来测试代码以实现`NumberCoversion`该类。您的测试应涵盖上述定义中描述的所有条件。

我不会编写类的规范，但它包含以下内容：它必须`String`作为输入和输出，接受两个参数并`null`在数字无效时返回等。

这个问题值得 10%，所以我只需要写一系列的东西，比如： 确保构造函数只接受两个 int 类型的参数，而不是其他任何东西，例如 double 或接受 3 个参数。

是否值得用英语/伪代码编写可能的 JUnit 测试方法。

这是用英语写测试的正确方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:55:24.927

我认为目标是描述一个测试用例来检查问题中的每个规范，同时避免尝试测试受语言结构限制的事物（例如错误的参数数量/类型）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:02:35.127

用英语描述如果你写测试你会做什么。通常它是`NumberConversion`类的用法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T19:26:35.417

根据问题，您需要用英语描述测试。我认为跳到 JUnit 单元测试不仅仅是被要求。`NumberConversion`如果我回答了这个问题，我会从查看该类的定义开始。我将描述使用有效输入的测试以及使用无效输入的测试。对于每个测试，请描述您将如何确保`NumberConversion`该类按预期运行，包括预期的错误条件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T13:16:32.827

作为一个可能合适的例子......

如果规格是：

*   接受一个字符串作为输入
*   字符串可以是任意大的非负整数
*   如果字符串不是非负整数，则抛出异常

然后我可能会回答以下问题：

*   我将使用“42”作为输入进行测试，以检查该方法是否适用于“正常”数字
*   我将使用“0”作为输入进行测试，以检查该方法是否适用于边缘案例编号
*   我将使用“9223372036854775808”（比 Long.MAX_VALUE 多 1 个）作为输入进行测试，以检查该方法是否适用于大于 Java 提供的固定长度整数的数字
*   我会用“-1”作为输入进行测试，并确保抛出异常，因为负输入无效
*   我会以“0xa”作为输入进行测试，并确保抛出异常，因为十六进制输入无效
*   我会以“0.1”作为输入进行测试，并确保抛出异常，因为非整数输入无效

# php - 为什么我会失去我的 data in the $_POST?

I am writing a script that will take some form data and present it in a PDF or some other printable format. At the bottom of the form is a "New Line" button. When you click t

> ID：12165599
> 
> 赞同：-2
> 
> 时间：2012-08-28T18:51:53.083
> 
> 标签：php, html, forms, post

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:02:10.000

看起来您正在添加具有相同 ID 的多个字段。在你的循环中，你有这个：

```
<input type= "text" id= "qty" name= "<?php echo('qty_'.$n); ?>" maxlength "10" value= "<?php if (isset($qty[$n])) echo ($qty[$n]); ?>"/>
<textarea id= "desc" name=  "<?php echo('desc_'.$n); ?>" value= "<?php if (isset($desc[$n])) echo ($desc[$n]); ?>"></textarea>
<input type= "text" id= "unit_price" name=  "<?php echo('unit_price_'.$n); ?>" maxlength= "10" value= "<?php if (isset($unit_price[$n])) echo ($unit_price[$n]); ?>" />
<input type= "text" id= "line_total" name=  "<?php echo('line_total_'.$n); ?>" maxlength= "10" value= "<?php if (isset($line_total[$n])) echo ($line_total[$n]); ?>" /> 
```

当循环运行不止一次时，这会产生相同 id 的多个实例，这是无效的 html，并且可以解释您遇到的问题。我建议做这样的事情：

```
 <input type="text" name="qty[]" id="<?php echo('qty_'.$n); ?>" maxlength="10" value="<?php if (isset($qty[$n])) echo ($qty[$n]); ?>"/>
    <textarea name="desc[]" id="<?php echo('desc_'.$n); ?>" value="<?php if (isset($desc[$n])) echo ($desc[$n]); ?>"></textarea>
    <input type="text" name="unit_price[]" id="<?php echo('unit_price_'.$n); ?>" maxlength="10" value="<?php if (isset($unit_price[$n])) echo ($unit_price[$n]); ?>" />
    <input type="text" name="line_total[]" id= "<?php echo('line_total_'.$n); ?>" maxlength="10" value="<?php if (isset($line_total[$n])) echo ($line_total[$n]); ?>" /> 
```

你会注意到我交换了名字和身份证。允许多个名称。更重要的是，如果你像我一样添加方括号，具有相同名称的字段将作为数组返回，这使得在后端处理它们变得非常容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:59:38.053

试试看：

```
<textarea id= "desc" name=  "<?php echo('desc_'.$n); ?>"><?php if (isset($desc[$n])) echo ($desc[$n]); ?></textarea> 
```

# python - Python 中自定义错误处理程序的正确命名范围

> ID：12165601
> 
> 赞同：1
> 
> 时间：2012-08-28T18:51:53.440
> 
> 标签：python, error-handling

我正在尝试为我的应用程序编写一个错误处理类。每次都需要包含错误处理程序的完整路径吗？下面是我的代码。

appname/appname/model/error.py

```
class UserError(Exception):
  """ User errors
  """

  def __init__(self, value):
    self.value = value

  def __str__(self):
    return repr(self.value) 
```

我的课堂功能：

```
from error import UserError

def doSomething(
  """ Some function
  """
  if (value == 2):
    pass
  else:
    raise UserError('Value is not 2') 
```

从我的应用程序中调用如下： from error import UserError

```
try:
  print names['first']
except appname.model.error.UserError as e:
  print e 
```

升起时：

```
>> appname.model.error.UserError: 'No file specified' 
```

我是否必须一直将其称为“appname.model.error.UserError”？或者有没有办法将此错误称为 UserError 甚至 error.UserError？我在哪里调整这个范围？如果我更改应用程序的目录结构（甚至名称），这似乎不是一个好主意，不是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:56:52.873

你可以这样做：

```
from appname.model.error import UserError 
```

# ruby-on-rails - 在 Windows 上获取虚拟机 IP 地址

> ID：12165604
> 
> 赞同：0
> 
> 时间：2012-08-28T18:52:00.040
> 
> 标签：ruby-on-rails, vmware, virtual-machine

我在 Windows7 上运行 Debian VMware 虚拟机。我正在虚拟机上开发 Rails Web 应用程序，我想从 vm 外部访问应用程序 (localhost:3000)，即从 Windows。

有没有办法做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:17:50.487

这实际上取决于来宾和主机之间的虚拟网络适配器的设置方式。假设您没有更改任何内容，默认情况下它们将被桥接。在您的虚拟机中从终端运行：

```
ifconfig 
```

这将为您提供应该能够从 Windows 主机访问的虚拟接口的 IPv4 地址（通常为 10.xxx）。您应该能够将其放入具有`:3000`端口的主机上的浏览器中并访问它。

如果您修改了网络适配器，情况可能会有所不同。例如，将其设置为 NAT 会给它一个物理网络上的地址；即 192.xxx，但访问它的方式相同。仅主机网络也很可能提供 10.xxx 地址，但也应提供访问权限。

# javascript - 在 Javascript 中使用闭包

> ID：12165608
> 
> 赞同：2
> 
> 时间：2012-08-28T18:52:14.217
> 
> 标签：javascript, function, closures

我遇到了这个javascript代码。

```
var digit_name = function() {
    var names = ['zero', 'one','two'];
    return function(n) {
        return names[n];
    };
}();

alert(digit_name(1)); 
```

输出为**一**。我知道内部函数被分配给变量**digit_name**。外层函数代码后第6行需要加括号是什么？谁能说出到底发生了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-28T18:54:46.010

添加的括号使外部函数执行，如果你省略它，它会将外部函数分配给你`digit_name`而不是内部函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T18:54:58.243

您看到的结尾`()`使该外部函数立即执行。因此`digit_name`最终存储了生成的内部函数，而不是指向外部函数的指针。

有关更多信息，请参阅：[javascript 中自执行函数的目的是什么？](https://stackoverflow.com/questions/592396/what-is-the-purpose-of-a-self-executing-function-in-javascript)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T18:57:42.463

让我们给这些函数起一些名字，以便更好地理解发生了什么：

```
var digit_name = function outer() {
    var names = ['zero', 'one','two'];
    return function inner(n) {
        return names[n];
    };
}();

alert(digit_name(1)); 
```

所以，这里有两个函数在起作用：`inner`和`outer`. 您正在定义一个名为 的函数`outer`，其目的是创建一个捕获`names`数组的闭包范围，并定义并返回另一个可以访问此闭包的函数。第 6 行的括号表示*调用函数*，因此分配给`digit_names`变量的值不是*外部*函数，而是*内部*函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T18:58:32.243

`var digit_name = function() {...};` =>`digit_name`是一个函数

`var digit_name = function() {...}();`=>`digit_name`是函数返回的对象

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-28T18:57:07.647

```
var digit_name = function() { // Create outer function
    var names = ['zero', 'one','two']; // Define names array, this is done when the outer function is ran
    return function(n) { // Return the new inner function, which gets assigned to digit_name
        return names[n];
    };
}(); // Execute the outer function once, so that the return value (the inner function) gets assigned to digit_name 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-28T19:04:33.790

这里有两个非常快速的过程。

如果我们要这样写：

```
function makeDigitReader () { var names; return function (n) { return names[n]; }; }
var myDigitReader = makeDigitReader(); 
```

您会正确猜测 myDigitReader 将被赋予内部函数。

他们正在做的是跳过一步。通过添加括号，他们所做的是在定义函数的那一刻触发函数。

所以你正在发生这种情况：

```
var myDigitReader = function () {
    var names = [...];
    return function (n) { return names[n]; };
};

myDigitReader = myDigitReader(); 
```

看看发生了什么？您已将内部函数作为新值返回给曾经是外部函数的值。所以外部函数不再存在，但内部函数仍然可以访问`names`数组。

您也可以返回对象而不是函数。并且这些对象属性/函数也可以访问最初在函数内部的内容。

通常，您会看到这些立即调用的函数用括号括起来`var myClosure = (function() { return {}; }());`。

如果您打算运行一个而不将其返回值分配给一个值，那么您需要将它放在括号中，或者在它的前面添加某种操作数，以使编译器对其进行评估。

```
!function () { doStuffImmediately(); }(); // does stuff right away
function () { doStuffImmediately(); }(); // ***ERROR*** it's an unnamed function 
```

希望这能回答您可能遇到的所有问题。

# javascript - Extjs 4仪表图表，如何动态更改最大限制值？

> ID：12165613
> 
> 赞同：1
> 
> 时间：2012-08-28T18:52:45.077
> 
> 标签：javascript, extjs, extjs4

我有以下仪表图，商店是从 xml 文件加载的。

```
var gaugechart = Ext.create('Ext.chart.Chart', {
        xtype: 'chart',
        width: 600,
        height: 200,
        insetPadding: 20,
        flex: 1,
        renderTo: 'gaugeDiv',
        store: store,
        axes: [{
            type: 'gauge',
            position: 'gauge',
            minimum: 0,
            maximum: 100,
            steps: 10,
            margin: 7
        }], 
```

最大值为 100，但我想使用商店中值的最大值。注意：商店中有实际值和最大值，例如 [{actually:5},{max:10}]

我想要一个使用这些值的仪表。如何更改此最大值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T04:05:49.027

使用`gaugechart.axes`枚举和设置任何轴`minimum`的`maximum`值。

# php - 提交表单时拖放要上传的文件

> ID：12165616
> 
> 赞同：0
> 
> 时间：2012-08-28T18:52:55.610
> 
> 标签：php, jquery, html, upload, drag-and-drop

我正在尝试实现拖放文件选择，以便在提交表单后同步上传文件。我知道常规文件上传如何使用 HTML 和 PHP。我希望能够处理 PHP 中的文件以及 $_FILES 数组中的文件。

我做了一些研究并查看了几个插件，但几乎所有插件都在将文件放入窗口后上传文件，或者不使用传统的 html 表单。

任何类型的帮助，如想法、片段或插件将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T21:35:26.527

出于安全原因，无法通过 JavaScript 设置文件输入的文件属性。看到[这个 jsfiddle](http://jsfiddle.net/vapocalypse/czZwJ/)。

因此，您不能通过拖放为文件输入选择文件，您必须通过单击“浏览文件”按钮直接通过文件输入选择文件。

您可以做的是为表单实现一个 onUpload 方法，当用户单击提交按钮时，通过 AJAX 上传文件。然后，当上传完成后，您提交带有其他数据的表单。

请参阅[此小提琴](http://jsfiddle.net/vapocalypse/G9QbX/)以了解如何通过 AJAX 上传文件。该代码具有拖放处理并将二进制文件转换为BASE64。您需要通过发布数据来创建 AJAX 位。要检查文件是否已完成，请创建一个要调用的函数`setInterval`，以检查所有上传是否已完成。

干杯，阿波克

# php - 使用 protection=validation 解密 .ASPXAUTH Cookie

> ID：12165619
> 
> 赞同：12
> 
> 时间：2012-08-28T18:53:23.857
> 
> 标签：php, asp.net, encryption, mcrypt, rijndael

很长一段时间以来，我一直在尝试破译 ASP .ASPXAUTH cookie 并使用 PHP 对其进行解密。我的理由很大，我需要这样做，别无选择。到目前为止，在 PHP 中，我已经成功地从这个 cookie 中读取数据，但是在它被加密时我似乎无法做到这一点。不管怎样，就这样吧……

首先，您需要更改服务器的 Web.config 文件（需要将保护设置为验证）：

```
 <authentication mode="None">
        <forms name=".ASPXAUTH" protection="Validation" cookieless="UseCookies" timeout="10080" enableCrossAppRedirects="true"/>
    </authentication> 
```

然后在同一域的 PHP 脚本中，您可以执行以下操作来读取数据，这是一个非常基本的示例，但就是证明：

```
$authCookie = $_COOKIE['_ASPXAUTH'];
echo 'ASPXAUTH: '.$authCookie.'<br />'."\n";//This outputs your plaintext hex cookie
$packed = pack("H*",$authCookie);
$packed_exp = explode("\0",$packed);//This will separate your data using NULL
$random_bytes = array_shift($packed_exp);//This will shift off the random bytes
echo print_r($packed_exp,TRUE); //This will return your cookies data without the random bytes 
```

这会破坏 cookie，或者至少是未加密的数据：

![http://i.stack.imgur.com/stisu.jpg](../Images/08df6313220e227942b549a3dacc97d8.png)

现在我知道我可以获取数据，我从我的 Web.config 中删除了 'protection="validation"' 字符串，并尝试使用 PHP mcrypt 对其进行解密。我尝试了无数方法，但这是一个有前途的例子（失败了）......

```
define('ASP_DECRYPT_KEY','0BC95D748C57F6162519C165E0C5DEB69EA1145676F453AB93DA9645B067DFB8');//This is a decryption key found in my Machine.config file (please note this is forged for example)
$iv = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_CBC), MCRYPT_RAND);
$decrypted = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, ASP_DECRYPT_KEY, $authCookie, MCRYPT_MODE_CBC, $iv);//$authCookie is the pack()'d cookie data 
```

然而这失败了。我已经尝试了所有零 @ 16 字节的 IV 变体。我尝试了不同的 Rijndael 尺寸（128 对 256）。我试过 base64_decode()ing，似乎没有任何效果。我在[这里找到了这个 stackoverflow 帖子](https://stackoverflow.com/questions/7387080/net-and-php-rijndael-encryption-not-matching)并开始使用使用 sha256 制作的 key/iv 的变体，但这也不是真的有效。

有人知道我应该怎么做吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T09:57:27.193

我不知道 .NET AuthCookies 是如何加密的，但我可以尝试回答。

假设加密发生在 AES CBC-IV 模式下，使用随机生成的 IV，您需要首先找出 IV 的位置。

您显示的代码片段无法工作，因为您正在生成一个随机 IV（这将是不正确的）。话虽这么说，即使你弄错了 IV，在 CBC 模式下，你只会让你的解密密文的前 16 个字节“乱码”，其余的将正确解密 - 你可以用它来测试你是否是正确地完成其余的工作。实际上，在使用随机 IV 时，它很可能会附加到密文中。要检查这是否正确，您可以尝试检查 len(ciphertext) = len(plaintext) + 16。这意味着前 16 个字节很可能是您的 IV（因此应该在尝试之前将其从密文中删除）解密）。

同样在您的代码片段中，您似乎将密钥用作 ascii 字符串，而它应该是字节数组。尝试：

```
define('ASP_DECRYPT_KEY',hex2bin('0BC95D748C57F6162519C165E0C5DEB69EA1145676F453AB93DA9645B067DFB8')); 
```

此外，这似乎是一个 32 字节的密钥，因此您需要使用 AES-256。我不知道 authcookie 长什么样，但是如果它是 base64 编码的，你显然还需要先解码。

希望这可以帮助！

注意：但是，我不建议对重要的生产代码执行此操作 - 因为如果您尝试实现自己的解密例程，就像您在此处所做的那样，可能会出现许多错误。特别是，我猜想在尝试解密之前您*必须*检查某个地方的 MAC 标签，但是在实施您自己的加密时还有许多其他事情可能出错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-11T16:15:24.807

我知道这对于 OP 来说可能是不可能的，但对于其他沿着这条路线前进的人来说，这是一个简单的选择。

1.  使用以下方法创建 .net Web 服务：

    公共 FormsAuthenticationTicket DecryptFormsAuthCookie(string ticket)
    {
    return FormsAuthentication.Decrypt(ticket);
    }

2.  从 PHP 将 cookie 传递给 Web 服务：

    $authCookie = $_COOKIE['.ASPXAUTH'];
    $soapClient = new SoapClient("http: `localhost`///Service1.svc?wsdl");
    $params= array(
    "票" => $authCookie
    );
    $result = $soapClient->DecryptFormsAuthCookie($params);

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-11T18:15:16.180

我知道用 PHP 解密在 .NET 中加密的东西是多么痛苦，反之亦然。

我最终不得不自己编写 Rijndael 算法（从另一种语言翻译过来）。

这里是算法源代码的链接：http: [//pastebin.com/EnCJBLSY](http://pastebin.com/EnCJBLSY)

在源代码的末尾有一些使用示例。

但是在 .NET 上，加密时应该使用零填充。也用ECB模式测试它，我不确定CBC是否有效。

祝你好运，希望它有所帮助

***编辑：**算法在加密时返回十六进制字符串，并且在解密时也期望十六进制字符串。*

# xcode - 在拆分视图中模态关闭 MWPhotoBrowser 视图控制器

> ID：12165620
> 
> 赞同：2
> 
> 时间：2012-08-28T18:53:27.280
> 
> 标签：xcode, uisplitviewcontroller, modalviewcontroller, ipad

遇到障碍，希望在这里有所了解。

**概述：** 通用应用程序。iPhone部分效果很好。iPad 部分有一个拆分视图控制器。主视图是一个表格视图（左侧），用户在其中选择一行并显示其详细信息（右侧）。很标准的东西。

我正在使用 Xcode 4.4.1 版，我的项目正在使用 Core Data、Storyboards 和 ARC。

**DetailViewController：** 在详细信息上是一个按钮，该按钮使用自定义视图按日期显示用户注释的另一个表视图（在详细信息内）。每个笔记都可以有一个与之关联的图像。如果笔记有图像，则会显示一个带有照片图标的按钮。

到目前为止的示例屏幕截图：

![示例截图 1](../Images/cb2e61366665a31d07b10e0440d56ec6.png)

**MWPhotoBrowser：** 当按下照片图标的按钮时，我调用 MWPhotoBrowser（一个以标准方式显示图像的精彩库）来显示图像。单击显示一个选定的图像，双击显示当前表格上的所有图像，首先查看所选图像。图像全屏显示。

要显示照片浏览器，我使用以下代码：

```
// Create the browser view.
MWPhotoBrowser *browser = [[MWPhotoBrowser alloc] initWithDelegate:self];

// Set browser options.
browser.wantsFullScreenLayout = YES;
browser.displayActionButton = YES;
[browser setInitialPageIndex:self.buttonRow];

UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:browser];

[self presentModalViewController:navController animated:YES]; 
```

navController 允许我包含一个带有“完成”按钮的导航控制器，该按钮调用 doneButtonPressed。

**问题：** 在我按下“完成”按钮之前，上述所有方法都运行良好。全屏照片浏览器正确关闭。不幸的是，用户按下照片图标按钮的右侧的表格视图现在消失了（黑色）。我认为在照片浏览器被模态关闭后，NotesViewController（右侧）会保留在那里。在拆分视图中调用模型视图控制器是否会导致其他视图控制器被删除？

显示问题的示例屏幕截图：

![在此处输入图像描述](../Images/e1a330ca3299ed126836a99b64af251f.png)

详细视图控制器（右侧）上的堆栈应该是 **DetailViewController > NotesViewController > 然后调用 MWPhotoBrowser 模态**。关闭照片浏览器后，我的 self.navigationController.viewControllers.count 等于 1，我希望它是 2。

这是关闭 MWPhotoBrowser 的代码：

```
- (void)doneButtonPressed:(id)sender {

if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {

    [self dismissViewControllerAnimated:YES completion:nil];
}
.
.
. 
```

希望有人可以帮助我解决这个问题。

与往常一样，非常感谢任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T15:50:48.663

我在 NoteViewController 中解决了我的问题（MWPhotoBrowser 被关闭后该区域变黑）。

在 viewWillAppear 中，我将 tableview 设置为 nil（以防止单元格过度包装）并重新加载我的表格数据。

```
self.tableView = nil;

[self.tableView reloadData]; 
```

这适用于 iPhone，并且当没有从 iPad 上的 MWPhotoBrowser 的全屏显示返回时。由于某种我不明白的原因，上面的代码导致了这个问题。我添加了额外的逻辑来检查我是否从全屏显示返回，现在一切都很好。时间允许的时候我会多研究。

# ios - 立即显示子视图/等到视图可见再继续

> ID：12165623
> 
> 赞同：0
> 
> 时间：2012-08-28T18:53:33.200
> 
> 标签：ios

我有一个启动到标签栏控制器的应用程序。当应用程序启动或从后台返回时，它会检查服务器是否对其数据进行更新。如果有可用更新，则可能需要几秒钟来获取数据并进行更新。

我想简单地呈现一个覆盖视图，告诉用户应用程序的数据正在更新，请等待几秒钟。我尝试执行此操作的方式如下：在我负责更新的班级中：

```
AppDelegate *delegate = [UIApplication sharedApplication].delegate;
[delegate.tabBarController.selectedViewController.view addSubview:updatingDataView];
[self runUpdateMethods]; 
```

问题是 updateDataView 仅在更新方法完成后才会出现在屏幕上。我怎样才能让它在更新方法开始之前出现？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T18:57:26.317

看起来您正在`[self runUpdateMethods];`主线程上运行（这将阻止您的 UI 更新）。您可能希望在后台线程上运行它。就像是：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0),
               ^{
                   [self runUpdateMethods];
               }); 
```

或者

`[self performSelectorInBackground:@selector(runUpdateMethods) withObject:nil];`

**更新**

既然你想在`[self runUpdateMethods];`完成后做一些事情，你会想做这样的事情：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0), 
^{
    [self runUpdateMethods];

    dispatch_async(dispatch_get_main_queue(), ^{
        [self doSomethingAfterUpdate];
    });    
}); 
```

这样做仍然可以让您知道何时`runUpdateMethods`返回并且不会挂起 UI。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T18:58:17.913

您的更新方法（连接）可能正在主线程上执行，这会阻止 UI 更新。您应该使用异步方法（gcd、NSThread、NSOperationQueue 等）来运行更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T18:59:46.220

你需要清空你的运行循环，以便你添加的视图将被绘制在屏幕上。在 iOs 上绘图不是实时完成的。您基本上设置了您的绘图并退出您的方法，然后运行循环实际绘制它。因此，您需要做的是将 runUpdateMethods 的执行延迟到您退出例程之后。请尝试：

```
[self performSelector:@selector(runUpdateMethods) withObject:nil afterDelay:0.0]; 
```

# python - Django聚合：两个字段相乘的总和

> ID：12165636
> 
> 赞同：61
> 
> 时间：2012-08-28T18:54:51.157
> 
> 标签：python, django, django-models, django-queryset, django-orm

我有一个这样的模型：

```
class Task(models.Model):
    progress = models.PositiveIntegerField()
    estimated_days = models.PositiveIntegerField() 
```

现在我想`Sum(progress * estimated_days)`在数据库级别进行计算。使用 Django Aggregation 我可以得到每个字段的总和，但不能得到字段乘法的总和。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2015-06-22T12:09:19.990

使用 Django 1.8 及更高版本，您现在可以将表达式传递给您的聚合：

```
 from django.db.models import F

 Task.objects.aggregate(total=Sum(F('progress') * F('estimated_days')))['total'] 
```

常量也可用，一切都可以组合：

```
 from django.db.models import Value

 Task.objects.aggregate(total=Sum('progress') / Value(10))['total'] 
```

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2013-11-10T09:22:50.847

**更新：**对于**Django >= 1.8**，请遵循@kmmbvnr 提供的答案

可以使用 Django ORM：

这是你应该做的：

```
from django.db.models import Sum

total = ( Task.objects
            .filter(your-filter-here)
            .aggregate(
                total=Sum('progress', field="progress*estimated_days")
             )['total']
         ) 
```

注意：如果两个字段的类型不同，比如`integer`& `float`，你要返回的类型应该作为第一个参数传递`Sum`

这是一个迟到的答案，但我想它会帮助寻找相同的人。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2016-03-15T23:19:19.893

解决方案取决于 Django 版本。

*   **django < 1.8**

    ```
    from django.db.models import Sum
    MyModel.objects.filter(<filters>).aggregate(Sum('field1', field="field1*field2")) 
    ```

*   **django >= 1.8**

    ```
    from django.db.models import Sum, F
    MyModel.objects.filter(<filters>).aggregate(Sum(F('field1')*F('field2'))) 
    ```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-28T21:17:12.147

**已编辑（在 Django 1.8 之后）**

从 Django 1.8 开始，您可以使用`F`：

```
from django.db.models import F. Sum

total = ( 
    Task
    .objects
    .aggregate(total=Sum(F('progress') * F('estimated_days'))) 
    ['total']
) 
```

**旧答案（在 Django 1.8 之前）**

*这个答案是在 2012 年写的，django 1.8 是在 2015 年发布的*

你有几个选择：

1.  [原始查询](https://docs.djangoproject.com/en/dev/topics/db/sql/)
2.  [Emulbreh 的无证方法](https://stackoverflow.com/a/5195517/842935)
3.  创建第三个字段`progress_X_estimated_days`并在 save overwrited 方法中对其进行更新。然后通过这个新字段进行聚合。

覆盖：

```
class Task(models.Model):
   progress = models.PositiveIntegerField()
   estimated_days = models.PositiveIntegerField()
   progress_X_estimated_days = models.PositiveIntegerField(editable=False)

   def save(self, *args, **kwargs):
      progress_X_estimated_days = self.progress * self.estimated_days
      super(Task, self).save(*args, **kwargs) 
```

# php - 图片上传代码不起作用

> ID：12165641
> 
> 赞同：0
> 
> 时间：2012-08-28T18:54:55.807
> 
> 标签：php, mysql, html

我正在尝试使用 php 中的图像上传将图像简单地放置在文件夹中，但它不起作用，请帮助我它有什么问题..thanx :)

这是我的代码`setup.php`

```
<?php include("../includes/config.php"); ?>
<?php
    if ($_SESSION["isadmin"])
    {

        $con=mysql_connect($dbserver,$dbusername,$dbpassword);
        if (!$con) { die('Could not connect: ' . mysql_error()); }

        mysql_select_db($dbname, $con);

        $result = mysql_query("SELECT * FROM setup WHERE (id=".$_SESSION["id"].")");
        while($row = mysql_fetch_array($result))
        {
            $title = $row['title'];
            $theme = $row['theme'];
        }
        mysql_close($con);
?>
<!DOCTYPE HTML>
<html>
<head>
    <title>Admdin Home</title>
    <link rel="StyleSheet" href="css/style.css" type="text/css" media="screen">
</head>
<body>
    <?php include("includes/header.php"); ?>
    <?php include("includes/nav.php"); ?>
    <?php include("includes/aside.php"); ?>
    <div id="maincontent">

        <div id="breadcrumbs">
            <a href="">Home</a> >
            <a href="">Setup</a> >
            Customization
        </div>
        <h2>Customize</h2>
        <?php
            if (isset($_GET["status"]))
            {
                if($_GET["status"]==1)
                {
                    echo("<strong>Customization Done!</strong>");
                }
                if($_GET["status"]==2)
                {
                    echo("<strong>Customization Error!!</strong>");
                }
            }
        ?>
        <form method="post"  action="setup-action.php" enctype="multipart/form-data" >
            <label>Title Of Your Organization:</label>  <input type="text" name="title" value="<?       php echo $title; ?>" /> <br /> <br />
            <label>Select Theme</label>
            <select name="theme" value="<?php echo $theme; ?>">
                <option value="Default">Default</option>
                <option value="Dark">Dark</option>
                <option value="White">White</option>
            </select>
            <br /> <br />
            <label>Choose Your Logo Here</label><input type="file" name="file"/><br /> <br />      
            <input type="submit" name="Upload" value="Upload" />
        </form>
    </div>

</body>
<?php include("includes/footer.php"); ?>
</html>
<?php
    }
    else
    {
        header("Location: ".$fullpath."login/unauthorized.php");
    }
?> 
```

这是`setup-action.php`

```
<?php include("../includes/config.php");?>
<?php
if(isset($_FILES["file"]))
{
    if ((($_FILES["file"]["type"] == "image/gif") || ($_FILES["file"]["type"] ==     "image/jpeg") || ($_FILES["file"]["type"] == "image/pjpeg"))
   && ($_FILES["file"]["size"] < 1000000))
    {
        if ($_FILES["file"]["error"] > 0)
        {
            echo "Return Code: " . $_FILES["file"]["error"] . "<br />";
        }

        if (file_exists("../graphics/" . $_FILES["file"]["name"]))
        {
            echo $_FILES["file"]["name"] . " already exists. ";
        }
        else
        {
            move_uploaded_file($_FILES["file"]["name"], "../graphics/" . $_FILES["file"]["name"]);
            echo "Stored in: " . "../graphics/" . $_FILES["file"]["name"];
        }
     }
}
else
{
    echo "Invalid file";
}
?>
<?php
    $title=$_POST["title"];
    $theme=$_POST["theme"];
    $con=mysql_connect($dbserver,$dbusername,$dbpassword);
    if (!$con) { die('Could not connect: ' . mysql_error()); }

    mysql_select_db($dbname, $con);
    $result=mysql_query("SELECT * FROM setup WHERE id=".$_SESSION['id']);
    $num_rows = mysql_num_rows($result);
    if ($num_rows > 0)
    {
        {
            mysql_query("UPDATE setup  SET title='".$title."' , theme='".$theme."'WHERE     id=".$_SESSION['id']);
            header("Location:setup.php?status=1");
        }
    }
    else {
        header("Location:setup.php?status=2");
    }
    mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T19:52:50.337

我对此并不完全确定，但我认为您需要在 move_uploaded_file 中使用 tmp_name，因为该文件在移动之前会收到一个临时名称和位置。

像这样：

```
move_uploaded_file($_FILES["file"]["tmp_name"],"your/path/".$_FILES["file"]["name"]); 
```

希望它有效......对我来说，其他一切似乎都很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T20:30:06.930

需要在 move_uploaded_file() 函数中使用上传文件的临时名称。临时名称包含保存在临时存储中的文件的路径

# xpages - Xpages 部分刷新触发完全刷新

> ID：12165643
> 
> 赞同：1
> 
> 时间：2012-08-28T18:55:05.073
> 
> 标签：xpages, xpages-ssjs

在 8.5.3 中注销时触发完全刷新。我不在乎数据是否丢失，我只想在部分刷新失败时触发完全刷新，以防用户注销或会话超时。

我有两个窗户打开。如果我按下窗口 2 上的注销按钮，然后回到窗口 1 并尝试进行部分刷新，它不会返回任何内容（只是该控件的空白值）。那么如何在用户注销时触发完全刷新呢？

我尝试了 onComplete、onStart 和 onError 客户端事件，但无法弄清楚如何知道何时发生此注销，我尝试了以下代码：

```
var strUserName = '#{javascript: @Name("[CN]", @UserName());}';
alert("Start: " + strUserName); 
```

它总是在窗口 1 中返回用户名而不是匿名用户，即使用户在窗口 2 中注销也是如此！

当部分刷新失败或返回空白值时，onError 事件永远不会触发。

任何想法或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T03:37:41.727

您是否尝试锁定数据库（匿名 = NoAccess）？然后你应该得到一个 404 并触发错误例程。

**更新**

你可以：

*   将重定向元标头添加到会话到期时启动的页面（便宜的解决方案，但可能已经捕获了大多数用例）
*   仍然锁定数据库，但给 Anonymous 权限“查看公共页面”，然后将允许匿名查看的页面标记为“可供公共访问”属性
*   确保您的部分刷新检查是否没有任何内容返回并重新加载页面（大部分工作，因为您需要更改业务逻辑） - 需要一些代码示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T09:03:23.027

onComplete 有一个弱点。值绑定在页面呈现时进行评估，而不是在部分刷新之后，如您所想。这是由于请求的工作方式。发送请求时，会绑定请求的回调（onStart、onComplete 等）。因此，客户端处理程序代码必须在刷新发生之前可用。

如果部分刷新没有使用事件处理程序（onComplete/onStart/onError）刷新项目，我认为值绑定仅在页面加载时更新。

有几种方法可以解决这个问题。

有一个客户端功能，对隐藏的（通过 CSS）xp:text/etc 进行部分刷新。显示当前用户名。使用 NodeReferenceVariable.innerHTML 获取内容。如果 Anonymous 是当前用户：

> document.location.href = 文档.location.href

您也可以执行 document.location.reload()，但这可能会导致重新发送提交。

使用[XPages 扩展库 REST 服务](http://www.openntf.org/blogs/openntf.nsf/d6plinks/NHEF-8EBBVG)。同上，如果匿名，则重新加载页面。

# jquery - 使用 Jquery 按文本而不是值选择选项项

> ID：12165645
> 
> 赞同：0
> 
> 时间：2012-08-28T18:55:15.177
> 
> 标签：jquery, html

```
<select id="State">
 <option value="Washington">WA></option>
</select> 
```

这有效

$('#State option[value="Washington"]')

但这不是

$('#State 选项[text="WA"]')

我怎样才能做到这一点？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:56:42.180

```
$('#State option:contains("WA")') 
```

[**小提琴**](http://jsfiddle.net/z27Qx/1/)

# php - 在从表单发布到其他人的脚本之前如何执行 php？

> ID：12165649
> 
> 赞同：0
> 
> 时间：2012-08-28T18:55:26.417
> 
> 标签：php, email, post

我有一个发布到 mailchimp 的联系表格 - 但在某些情况下，我也希望它发送一封电子邮件。

我考虑将`<form action="...`mailchimp 更改为我自己的页面，其中包含类似于以下内容：

```
<form action="mailchimp_url..." ...>

<? foreach($_POST as $name=>$value){?> 
    <input type="hidden" name="<? echo $name;?>" value="<? echo $value;?>"> 
<? }?> 

<? //mail the stuff I want somewhere else ?> 
```

然后我可以使用 javaScript 在页面加载时自动执行此操作。

问题是，如果这可行，它将依赖于 JavaScript，或者需要用户单击额外的按钮。

有没有更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:57:27.050

您可以先发布到自己的服务器

```
<form action="your_path" ...> 
```

然后使用[cURL](http://php.net/manual/en/book.curl.php)将相同的数据发布到 mailchimp

这是一个很好的[例子](http://davidwalsh.name/curl-post)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:00:49.450

如果您来自另一个表单，提交此代码将完成。然后你的 $_POST 将被解析。但是因为 $_POST 仅在表单发布时才存在，因此您之前无法使用它。你到底想做什么？如果您想在特定参数的表单字体中添加隐藏输入，您可以使用 $_GET 或 $_SESSION

# jquery - 获取 RFID 扫描仪输入 jQuery

> ID：12165650
> 
> 赞同：1
> 
> 时间：2012-08-28T18:55:30.070
> 
> 标签：jquery, rfid

我在我的 Web 应用程序中使用 RFID 扫描仪，我希望页面在后台监听扫描仪输入。

扫描仪读取 10 位 RFID 标签并将其作为标准键盘输入传输。页面接收到的号码始终是 10 位数字，并且总是非常快速地传输，比任何人都可以键入的速度快得多。

有没有办法用 jQuery 捕捉这 10 位数字，然后用数据库处理数字字符串？

谢谢你的帮助。

另外，据我所知，扫描仪不会在代码之前发送任何特殊的标头，除非有程序可以告诉我这一点，否则我不认为 jQuery Barcode Listener 插件是一个选项。[http://code.google.com/p/jquery-barcodelistener/](http://code.google.com/p/jquery-barcodelistener/)

但它会在扫描代码后自动按回车键。

我知道我可以只使用文本输入，但扫描仪将用于员工跟踪他们的工作时间，员工应该看不到正在输入页面的数字，因为这样可以防止篡改，只需输入其他人的号码即可为他们打卡或打卡。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:00:34.257

我没有得到问题。

您是说扫描仪将（扫描的）内容作为击键发送。

你想抓住它吗？然后只需确保`input`页面中的文本元素具有焦点。

接下来，您可以像这样得到它： `var input = $("#text_box").text();`

如果我错过了你的观点，我很抱歉。

**编辑＃1：**

> 我知道我可以只使用文本输入，但扫描仪将用于员工跟踪他们的工作时间，员工应该看不到正在输入页面的数字，因为这样可以防止篡改，只需输入其他人的号码即可为他们打卡或打卡。

好的，现在这是你的“问题”。

这很简单：您可以执行以下操作之一：

1）隐藏文本输入，只需寻找“如何隐藏元素”。此外，为了确保该元素具有焦点，您需要在 jQuery 中使用`$("text_box").focus()`.

2) 捕捉页面的按键/点击事件并记录下来。

我会去＃1。

# jquery - 异步 QUnit + Mockjax 测试中来自相同调用的多个响应

> ID：12165651
> 
> 赞同：4
> 
> 时间：2012-08-28T18:55:33.390
> 
> 标签：jquery, ajax, asynchronous, qunit, mockjax

我正在尝试使用 QUnit 和 Mockjax 测试一些 jQuery ajax 代码，并让它为不同的测试返回不同的 JSON，[如下所示](http://jsfiddle.net/nickkell/gnQn3/)：

```
$(document).ready(function() {

function functionToTest() {
    return $.getJSON('/echo/json/', {
        json: JSON.stringify({
            "won't": "run"
        })
    });
}

module("first");

test("first test", function() {

    stop();

    $.mockjax({
        url: '/echo/json/',
        responseText: JSON.stringify({
            hello: 'HEYO!'
        })
    });

    functionToTest().done(function(json) {
        ok(true, json.hello);
        start();
    });               
});

 test("second test", function() {

    stop();

    $.mockjax({
        url: '/echo/json/',
        responseText: JSON.stringify({
            hello: 'HELL NO!'
        })
    });

    functionToTest().done(function(json) {
        ok(true, json.hello);
        start();
    });

});

}); 
```

不幸的是，它为每个调用返回相同的响应，并且无法保证顺序，所以想知道如何设置它以便它与实际请求耦合并提出[这个](http://jsfiddle.net/nickkell/gnQn3/1/)：

```
$.mockjax({
    url: '/echo/json/',
    response: function(settings) {

        if (JSON.parse(settings.data.json).order === 1) {
            this.responseText = JSON.stringify({
                hello: 'HEYO!'
            });
        } else {
            this.responseText = JSON.stringify({
                hello: 'HELL NO!'
            });
        }
    }
}); 
```

这依赖于发送到服务器的参数，但是没有参数的请求呢，我仍然需要测试不同的响应？有没有办法使用 QUnit 的设置/拆卸来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:35:43.660

看起来您需要`$.mockjaxClear();`在创建另一个模拟处理程序之前调用。

Mockjax 通过更改 $.ajax 方法来工作。

在[其源代码](http://github.com/appendto/jquery-mockjax/blob/master/jquery.mockjax.js#L511)的底部，我们可以看到您正在使用的 $.mockjax 方法，这是它的公开方法之一，它只是将更多的处理程序附加到 mockHandlers 数组。

```
 $.mockjax = function(settings) {
        var i = mockHandlers.length;
        mockHandlers[i] = settings;
        return i;
    }; 
```

在 $.ajax 替换的源代码中，我们可以看到：

```
 // Iterate over our mock handlers (in registration order) until we find
    // one that is willing to intercept the request
    for(var k = 0; k < mockHandlers.length; k++) { 
```

`/echo/json/`您的问题是由于 $.ajax 方法对url数组中的第一个处理程序（因此不是最新的）模拟处理程序感到满意。

这是[我的小提琴叉子](http://jsfiddle.net/gnQn3/4/)，只需添加`$.mockjaxClear()`一行。

* * *

## 编辑：

更灵活的解决方案：

*   在任何测试函数之外，删除一个变量，该变量将具有请求处理程序的 ID 以供以后更改。
*   在需要覆盖某个处理程序的模块之前，声明一个变量（不需要初始值）以保存要修改的处理程序的备份。
*   然后在模块设置函数中使用 $.extend 将设置从 $.mockjax.handler( `<your handlerID variable>`) 复制到此备份。在模块的拆卸中，使用 $.mockjaxClear( `<your handlerID variable>`) 删除模块，然后设置`<your handlerID variable>`为其他内容。
*   现在您可以覆盖模块`setup`和各个测试函数中的处理程序。

但不要相信我的话。[看看小提琴](http://jsfiddle.net/gnQn3/8/)。

像这样灵活得多。您可以更改该处理程序并保留您可能拥有的所有其他处理程序。

它似乎确实容易出错，所以我建议要小心。

# python - 使用 Python 进行长期仪器数据采集 - 使用“While”循环和线程处理

> ID：12165652
> 
> 赞同：0
> 
> 时间：2012-08-28T18:55:34.030
> 
> 标签：python, multithreading, while-loop, data-acquisition

我将有 4 个硬件数据采集单元通过硬连线以太网 LAN 连接到单个控制 PC。此应用程序的编码将驻留在 PC 上，并且完全基于 Python。每个数据采集单元的配置相同，并且将以相同的方式从 PC 轮询。它们连接的测试盒提供我们寻求进行测试的可变输出。

这些测试是长期的（8-16 个月或更长时间），数据采集率相对较低（每分钟不到 500 个样本，可能接近 200 个）。一般工艺流程也很简单。我将遍历每个数据采集设备并：

*   从设备中读取数据；
*   对数据进行一些计算；
*   如果计算结果是一回事，请打开加热器；
*   如果他们说别的，什么也不做；
*   将数据写入磁盘和文件以供后续处理

我会等一段时间，然后再重复一遍这个过程。以下是我的问题：

1.  我计划使用一个`while TRUE:`循环来开始执行我上面概述的序列，并允许通过异常退出循环，但我欢迎任何关于我应该检查的特定异常的建议 - 甚至，这是最好的方法是什么？另一种方法可能是：一旦进入`while`循环，我可以使用`try: - except: - finally:`构造退出循环。
2.  我上面概述的过程是针对主要数据采集的东西，但是考虑到收集时间的长度，我还需要能够做其他事情：检查硬件单元是否运行正常，进行测试台上和下线根据需要等。这些“管理”功能与主循环不同，所以我想保持它们的区别。我应该在同一脚本中的不同线程中设置此活动，还是有更好的方法？

提前谢谢各位。欢迎所有反馈！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:20:11.393

我认为使用客户端-服务器模型对您有好处

它将很好地分开，因此一个脚本不会影响另一个脚本 - 状态检查/数据收集

基本上你会做什么来运行服务器以在主机上收集数据，这可能有一些用于维护的终端输入（日志记录、优雅退出等），并且数据收集 PC 将像客户端一样使用 while True 循环（可以除非被杀死，否则无限运行），并且在每台数据收集 PC 上将是服务器/客户端（取决于观点）以进行状态检查，并将数据发送到 MAIN pc，您将在其中决定做什么

此外，如果您使用 unix/linux 甚至 Windows，则只需使用 ssh 到机器并检查状态（手动或通过主机上的脚本）...取决于特定需求...

享受

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:23:46.553

您可能需要不止一个循环。如果仪器是 TCP 服务器，您可能希望在内部循环中捕获“断开连接”异常并尝试重新连接，而不是永久终止仪器线程。

不确定Python。在 C++、C#、Delphi 上，我可能会通过在生产者-消费者队列上等待超时来产生等待。如果没有发布任何内容，您概述的序列将按照您的意愿重复。如果需要发生其他一些偶尔的事情，您可以排队一条消息，指示线程向仪器发出必要的命令，或者断开连接并设置内部“不要轮询，等到指示重新连接和再次轮询'标志，或任何需要做的事情。

这种方法比停止线程并从其他线程连接只是为了偶尔做一些事情要干净。任何语言都最好避免停止/终止/重新创建线程。

# java - 声明 java.awt.FileDialog 时出错

> ID：12165653
> 
> 赞同：2
> 
> 时间：2012-08-28T18:55:34.933
> 
> 标签：java, awt

我试图在我的代码中声明一个 java.awt.FileDialog：

```
FileDialog save = new FileDialog(null, "Save file", FileDialog.SAVE); 
```

但是当我尝试运行我的代码时，我的控制台中出现以下错误：

*构造函数 FileDialog(Frame, String, int) 不明确*

有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:57:43.587

[FileDialog](http://docs.oracle.com/javase/7/docs/api/java/awt/FileDialog.html)有 2 个带有 3 个参数的构造函数。因为您将 null 作为第一个参数传递，所以编译器无法区分您想要的构造函数。

```
FileDialog(Dialog parent, String title, int mode) 
```

和

```
FileDialog(Frame parent, String title, int mode) 
```

你可以使用：

```
Frame frame = null;
FileDialog save = new FileDialog(frame, "Save file", FileDialog.SAVE); 
```

修理。

# mongodb - MongoRestore 花费的时间和 CPU 比预期的要多

> ID：12165655
> 
> 赞同：1
> 
> 时间：2012-08-28T18:55:48.053
> 
> 标签：mongodb, ubuntu, cpu-usage

我只是在恢复一个数据库，我将它转储了几分钟以进行一些更改。Mongorestore 占用了大约 100% 的 CPU 并且比预期的时间长得多。我想，这可能是由于我创建的索引，但是，即使恢复单个集合，问题也是一样的。一个集合大小约为 314MB，包含大约 185000 个文档。通常，这件事不会发生。这可能是由于我系统上的磁盘空间较少，但这也是 11GB。谁能帮帮我，这可能是什么问题？

注意：我从 mongo 客户端做事。不包括驱动程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T11:05:28.630

正如您在评论中指出的那样，这与日志记录有关，那么我建议采取几个步骤：

首先，使用日志轮换。这可以通过对数据库的命令或通过向进程发送 SIGUSR1 信号来完成，因此很容易编写脚本或定期将其作为 cron 作业启用。更多信息在这里：

[http://www.mongodb.org/display/DOCS/Logging#Logging-Rotatingthelogfiles](http://www.mongodb.org/display/DOCS/Logging#Logging-Rotatingthelogfiles)

其次，验证您的日志记录级别。从 -v = 日志级别 1 开始；-vv = log 2 等。您可以在启动时和运行时调整它。对于运行时调整，您使用[setParameter 命令](http://docs.mongodb.org/manual/reference/commands/#setParameter)：

```
// connect to the database or mongos
use admin;
// check the log level
db.runCommand({getParameter : 1, logLevel: 1})
{ "logLevel" : 0, "ok" : 1 }
// set it higher
db.runCommand({setParameter : 1, logLevel: 1})
// back to default levels
{ "was" : 0, "ok" : 1 }
db.runCommand({setParameter : 1, logLevel: 0})
{ "was" : 1, "ok" : 1 } 
```

最后，您还可以运行 --quiet 以减少一些消息传递。

# hadoop - 无法根据查询参数从 Hbase 获取数据

> ID：12165656
> 
> 赞同：1
> 
> 时间：2012-08-28T18:55:53.153
> 
> 标签：hadoop, hbase

如何从 HBase 获取数据？我有一个包含 empId、name、startDate、endDate 和其他列的表。现在我想根据 empId、startDate 和 endDate 从 HBase 表中获取数据。在普通 SQL 中，我可以使用：

```
select * from tableName where empId=val and date>=startDate and date<=endDate 
```

我如何在 HBase 中执行此操作，因为它将数据存储为键值对？关键是empId。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T15:55:03.623

获取过滤的行`HBase shell`很棘手。由于 shell 是`JRuby-based`您也可以在这里使用`Ruby`命令：

```
import org.apache.hadoop.hbase.filter.CompareFilter
import org.apache.hadoop.hbase.filter.SingleColumnValueFilter
import org.apache.hadoop.hbase.filter.BinaryComparator
import org.apache.hadoop.hbase.filter.FilterList
import java.text.SimpleDateFormat
import java.lang.Long

def dateToBytes(val)
  Long.toString(
    SimpleDateFormat.new("yyyy/MM/dd").parse(val).getTime()).to_java_bytes
end

# table properties
colfam='c'.to_java_bytes;
col_name='name';
col_start='startDate';
col_end='endDate';

# query params
q_name='name2';
q_start='2012/08/14';
q_end='2012/08/24';

# filters
f_name=SingleColumnValueFilter.new(
         colfam, col_name.to_java_bytes, 
         CompareFilter::CompareOp::EQUAL, 
         BinaryComparator.new(q_name.to_java_bytes));

f_start=SingleColumnValueFilter.new(
          colfam, col_start.to_java_bytes, 
          CompareFilter::CompareOp::GREATER_OR_EQUAL,
          BinaryComparator.new(dateToBytes(q_start)));

f_end=SingleColumnValueFilter.new(
          colfam, col_end.to_java_bytes, 
          CompareFilter::CompareOp::LESS_OR_EQUAL,
          BinaryComparator.new(dateToBytes(q_end)));

filterlist= FilterList.new([f_name, f_start, f_end]);

# get the result
scan 'mytable', {"FILTER"=>filterlist} 
```

同样在`Java`构造一个[FilterList](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/filter/FilterList.html)：

```
// Query params
String nameParam = "name2";
String startDateParam = "2012/08/14";
String endDateParam = "2012/08/24";

Filter nameFilter = 
  new SingleColumnValueFilter(colFam, nameQual, CompareOp.EQUAL,
        Bytes.toBytes(nameParam));

//getBytesFromDate(): parses startDateParam and create a byte array out of it
Filter startDateFilter = 
  new SingleColumnValueFilter(colFam, startDateQual,
        CompareOp.GREATER_OR_EQUAL, getBytesFromDate(startDateParam));

Filter endDateFilter = 
  new SingleColumnValueFilter(colFam, endDateQual,
        CompareOp.LESS_OR_EQUAL, getBytesFromDate(endDateParam));

FilterList filters = new FilterList();
filters.addFilter(nameFilter);
filters.addFilter(startDateFilter);
filters.addFilter(endDateFilter);

HTable htable = new HTable(conf, tableName);

Scan scan = new Scan();
scan.setFilter(filters);
ResultScanner rs = htable.getScanner(scan);
//process your result... 
```

# java - 为什么要从外部类访问受保护的成员？

> ID：12165657
> 
> 赞同：1
> 
> 时间：2012-08-28T18:55:56.723
> 
> 标签：java, inheritance

我正在创建以下类层次结构：

```
abstract class Shape{
    protected abstract float getArea();
    protected abstract float getVolume();
}

abstract class TwoDimentionalShape extends Shape{
    public abstract float getArea();
    protected float getVolume(){
        return 0;
    }
}

class Square extends TwoDimentionalShape {
    float width, height;
    Square(float w, float h){
        width = w;
        height = h;
    }
    public float getArea(){
        return width*height;
    }
}

public class ShapeTest {
    public static void main(String args[]){
        Shape s = new Square(3, 4);
        System.out.println(s.getVolume());
    }
} 
```

我想做的是隐藏类的功能，因为它将用于`getVolume()`类。`TwoDimentionalShape``ThreeDimentionalShape`

问题是我已经将该函数声明为受保护的，但是当我从 调用它时`main()`，程序正在运行。为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:58:59.327

受保护的在包内或包外的子类和同一包中的类中可见。看起来您的课程都在同一个包中。这就是为什么你可以看到它。

一般来说，层次结构是：

公共 - 在所有包和子类中可用

受保护 - 可在子类和同一包中使用

（默认即没有）在同一个包中可用

私人 - 可在同一个班级

可以访问（使用反射）一些您通常无法“看到”的字段/方法，尽管这不能保证并且取决于所使用的安全管理器。

我认为这个问题的第一个答案很好地解释了它 [在 Java 中，default、public、protected 和 private 之间的区别](https://stackoverflow.com/questions/215497/in-java-whats-the-difference-between-public-default-protected-and-private)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T19:00:24.293

受保护的成员和方法可以访问包和继承层次结构。由于二维没有体积，因此您应该删除该方法。

为 3 维或更大维添加`getVolume()`方法。

在类中添加`getVolume()`方法`Shape`相当于`getDesignation()`在`Person`类中添加方法，其中`getDesignation()`应在`Employee`扩展类中`Person`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T18:59:42.920

`Protected members`可以`accessed`由在包外**具有受保护成员的类**的子类......，由`law of inheritance`......

`Square``getVolume()`类从其**超类**继承了方法 **`TwoDimentionalShape`**

 **如果**在子**类的**同一个包**中还有**另一个类****没有扩展**该类，那么对于该类，该方法将不可见......我的意思是该方法将像它的私有成员一样，它看不到。 ****`Square`**`TwoDimentionalShape``getVolume()``getVolume()`******

 ******* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T19:00:06.710

> 我想要做的是隐藏 TwoDimentionalShape 类的函数 getVolume()，因为它将用于 ThreeDimentionalShape 类。

不是正确的方法。通常，超类声明/定义所有子类共有的方法。如果任何方法不应该出现在子类中，那么它应该是超类私有的。如果方法对于某些子类是通用的，但在其他子类中确实有意义，那么它可能不属于那里，应该在继承继承权的某个地方声明/定义。

并非所有的`Shape`s 都有音量。

`protected abstract float getVolume();`

不适合`Shape`。最好将其从中删除并将其`Shape`声明在一个（如`ThreeDimentionalShape`）中，它代表一个`Shape`可以有音量的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-28T19:10:48.933

你应该改变你的类树并且不要在 Shape 类中包含方法定义，因为不是每个形状都会有一个体积（甚至可能）

```
public interface class Shape{ //optional but helpful: interface instead of abstract class. not an abstract class but an interface
    public float getArea();  //not abstract, not protected
    //protected abstract float getVolume(); this should not go in here
}

abstract class TwoDimentionalShape implements Shape{ //implement instead of extend. also this can qualify as an interface instead of an abstract class
    public abstract float getArea();
}

class Square extends TwoDimentionalShape {
    float width, height;
    Square(float w, float h){
        width = w;
        height = h;
    }
    /*public float getArea(){  not needed in a twodimensionalshape
        return width*height;
    }*/
}

public class ShapeTest {
    public static void main(String args[]){
        Shape s = new Square(3, 4);
        System.out.println(s.getVolume()); //will not compile
    }
} 
```

现在您可以创建一个 3D 类：

```
abstract class ThreeDimentionalShape implements Shape{
    public abstract float getArea();
    public abstract float getVolume();  //All 3D shapes will have a volume!!
}

class Sphere extends ThreeDimentionalShape {
    float radius;
    Sphere (float radius){

    }
    public float getArea(){  not needed in a twodimensionalshape
        return {place some forgotten formula here};
    }
    public float getVolume(){  not needed in a twodimensionalshape
        return {place some forgotten formula here};
    }
} 
```********

# php - 持续拉取 MySQL 数据库值

> ID：12165661
> 
> 赞同：0
> 
> 时间：2012-08-28T18:56:10.097
> 
> 标签：php, mysql

我在 MySql 数据库表中存储了一个数字，特别是一个名为“open”的行，其字段是一个几乎连续变化的整数值。我希望能够不断地提取此值并将其显示在前端 HTML 页面上并将其放入一个表中，称为“实时值”之类的东西。我希望前端的数字无需刷新页面即可更改，并且我正在尝试弄清楚如何/是否可以做到这一点。

是否可以使用 PHP 异步将数据的值拉到前端？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:00:17.300

您需要在 HTML 本身中编写一点 JavaScript，它会定期轮询 PHP 页面。这个 PHP 页面应该访问 MySQL 数据库，检索号码并将其发回。

这是可能对您有所帮助的 Google AJAX 教程：[http ://code.google.com/edu/ajax/tutorials/ajax-tutorial.html](http://code.google.com/edu/ajax/tutorials/ajax-tutorial.html)

更简单的 PHP + AJAX 示例：

[http://simpletutorials.com/?path=tutorials/javascript/simple_ajax](http://simpletutorials.com/?path=tutorials/javascript/simple_ajax)

[http://www.w3schools.com/php/php_ajax_database.asp](http://www.w3schools.com/php/php_ajax_database.asp)

# ruby - Ruby 的 Object#taint 和 Object#trust 方法是什么？

> ID：12165664
> 
> 赞同：40
> 
> 时间：2012-08-28T18:56:30.563
> 
> 标签：ruby

[我正在阅读文档](http://www.ruby-doc.org/core-1.9.3/String.html)中有关 Ruby 字符串方法的内容并遇到了这些方法

*   `taint`
*   `trust`
*   `untaint`
*   `untrust`

我不知道它们是做什么的，我们在什么情况下使用它们？有人用过吗？例子会很好。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-08-29T05:25:35.623

`taint`并且`trust`是 Ruby 安全模型的一部分。在 Ruby 中，每个对象都有一些随身携带的标志，其中两个是 Trusted 标志和 Tainted 标志。这些标志的作用方式取决于称为安全级别的东西。安全级别存储在`$SAFE`.

程序中的每个线程和纤程都可以有自己的安全级别。安全级别范围从 0 到 4，其中 0 表示没有安全性，而 4 表示强制执行太多，它只应在您`eval`编写代码时使用。您*不能*分配`$SAFE`比现有值更低的值。此外，在 Ruby 脚本作为 setuid 运行的 UNIX 系统上，Ruby 自动将安全级别设置为 1。

# 污染

当一个对象设置了它的污染标志时，这大致意味着该对象来自不可靠的来源，因此不能用于敏感操作。当安全等级为 0 时，污点标志被忽略（但仍然设置，如果需要可以关注它）。有几种与污染相关的方法：

*   `taint`-- 使对象受到污染。除了安全级别 4，您可以在所有级别上污染对象。
*   `tainted?`-- 检查对象是否被污染。
*   `untaint`-- 去除物体上的污点。这**只能**在安全级别 0、1 和 2 中使用。

这是 pragprog 镐（[source](http://phrogz.net/ProgrammingRuby/taint.html)）中显示污染的示例：

```
# internal data
# =============
x1 = "a string"
x1.tainted?     → false
x2 = x1[2, 4]
x2.tainted?     → false
x1 =~ /([a-z])/ → 0
$1.tainted?     → false
# external data
# =============
y1 = ENV["HOME"]
y1.tainted?      → true
y2 = y1[2, 4]
y2.tainted?      → true
y1 =~ /([a-z])/  → 1
$1.tainted?      → true 
```

总而言之，您不能对受污染的数据使用危险的方法。因此，如果您在安全级别 3 中执行此操作，则会收到错误消息：

```
eval(gets) 
```

# 相信

信任要简单得多。信任与对象是否来自受信任或不受信任的来源有关 - 基本上，它是否来自低于安全级别 4 或安全级别 4 的任何东西。我不确定 Ruby 的信任到底有什么影响，但采取看这里： [http](http://www.ruby-forum.com/topic/1887006) ://www.ruby-forum.com/topic/1887006 。

* * *

这里有更多资源： [http](http://phrogz.net/ProgrammingRuby/taint.html) ://phrogz.net/ProgrammingRuby/taint.html——一些安全级别的好东西，但我认为它来自 1.8——1.9 有一个更新版本，只是在印刷版本中的书。

[http://www.ruby-forum.com/topic/79295——](http://www.ruby-forum.com/topic/79295)关于安全是否足够安全。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-29T04:03:40.243

`taint`并且`trust`每个都设置一个标志，该对象随身携带。我可以告诉（来自 ruby​​-doc.org）的唯一区别是，某些方法调用在给定受污染的对象时表现不同，而信任似乎完全取决于程序员来解释。

污染的主要目的是将用户输入标记为潜在危险，例如动态加载的脚本或 CGI 表单数据。然后，您实施清理方法，以确保对象是安全的并且在代码中的其他地方使用它们之前没有污染它们。

另请参阅“[污染 Ruby 对象的目的是什么？](https://stackoverflow.com/questions/1736161/whats-the-purpose-of-tainting-ruby-objects) ”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T06:12:01.083

I found this link to me informative about `tainted` Data in ruby.

[http://ruby.about.com/od/advancedruby/a/tainted.htm](http://ruby.about.com/od/advancedruby/a/tainted.htm)

> "Tainted" objects are those that have come from some type of user input. Either from a file, the keyboard or the network, unless the object is a literal in the program or created by the program directly, it will be tainted. The tainted flag is always there on your objects, all you have to do is check it before you do anything unsafe. If you've confirmed that the data is indeed safe, you can then untaint the object.

# android - 导入 com.amazonaws 无法解决

> ID：12165677
> 
> 赞同：3
> 
> 时间：2012-08-28T18:57:13.123
> 
> 标签：android, eclipse, amazon-web-services

我正在 Eclipse 中设置一个基于 Android 的 Amazon AWS SimpleDB 客户端（刚刚开始）。我在线上遇到错误：

```
import com.amazonaws.services.simpledb.AmazonSimpleDBClient; 
```

上面写着“无法解决导入 com.amazonaws”。

我已经在我的项目的 lib 目录中安装了 AWS SimpleDB jar 文件，并将 lib 目录添加到我的项目的构建路径中。

如何让 Eclipse 解析导入语句中的名称？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T19:43:01.807

我找到了我的问题的答案。我想我在将 lib 目录添加到我的构建路径时出错了。

这是正确的方法：

右键单击 Project -> 选择 Properties -> Java Build Path -> Libraries，然后单击 Add JARs。然后选择添加到 lib 目录的 JAR。谢谢。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-16T03:40:21.270

我今天有同样的错误。import com.amazonaws 在 Eclipse 中无法解析。

我通过在 Eclipse File -> New -> Other -> AWS Java Project 中重新创建我的项目解决了这个问题

我已经在 Eclipse 中安装了 AWS 软件开发工具包。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T19:48:53.533

您可以尝试从构建路径中删除该 jar 并将“lib”目录重命名为“libs”。“libs”目录中的 jar 文件将自动添加到构建路径中。

对我来说，“lib”目录中的 jar 不包含在 apk 中。在日食中没有问题。只有在我将项目安装在设备上之后。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-08T13:09:16.983

清洁项目是我的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-06T11:39:52.490

我通过使用以下步骤为 Eclipse 安装 AWS 工具包来修复它：

```
Install the Toolkit in Eclipse 

1\. Open 'Help' from Eclipse menu bar → Install New Software….

2\. Enter https://aws.amazon.com/eclipse in the text box labeled “Work with” at the top of the dialog.

3\. Select the required "AWS Core Management Tools" and other optional items from the list below.

4\. Click “Next.” Eclipse guides you through the remaining installation steps. 
```

安装后，清理并重建项目，然后重新启动 Eclipse。

# responsive-design - Google Ads 图片上的流畅图片行为

> ID：12165680
> 
> 赞同：1
> 
> 时间：2012-08-28T18:57:29.727
> 
> 标签：responsive-design, ads, fluid-layout

我想将[流畅的图像行为](http://www.alistapart.com/articles/fluid-images/)添加到我网站上的广告 (Google Ads) 显示的图像中，¿如何做到这一点？广告似乎是由 iframe 拉取的远程内容，因此同源策略“http://en.wikipedia.org/wiki/Same_origin_policy”适用于向图像添加流动行为的情况（或者我错了？），但我不确定，所以我在这里问这个问题。

# java - Android - 视图没有 ID - 为什么？

> ID：12165681
> 
> 赞同：3
> 
> 时间：2012-08-28T18:57:30.610
> 
> 标签：java, android, xml

我有一个类应该根据单击的按钮调用另一个活动。这是通过检查可用的 ID 来完成的。

我的问题是：传递给我的类的视图没有 id，或者更确切地说，它的值是 NO_ID。令我困惑的是，作为按钮的视图确实有一个 ID。

```
public class StrengthOrganizer extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_strength_organizer);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_strength_organizer, menu);
    return true;
}

public void notifyActivity(View view) {
    Intent intent = null;

    int id = view.getId();

    switch(id){
        case    R.id.button_log_book_launcher:
                intent = new Intent(this, LogBook.class);
                break;

        case    R.id.button_programming_launcher:
                intent = new Intent(this, Programming.class);
                break;

        case    R.id.button_visualizer_launcher:
                intent = new Intent(this, Visualizer.class);
                break;

        default:
                return;
    }

    startActivity(intent);
}
} 
```

对应的 XML 文件如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<Button android:name="@+id/button_log_book_launcher"
        android:layout_weight="1"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_gravity="center"
        android:text="@string/button_log_book_launcher"
        android:onClick="notifyActivity" />

<Button android:name="@+id/button_programming_launcher"
        android:layout_weight="1"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_gravity="center"
        android:text="@string/button_programming_launcher"
        android:onClick="notifyActivity" />

<Button android:name="@+id/button_visualizer_launcher"
        android:layout_weight="1"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_gravity="center"
        android:text="@string/button_visualizer_launcher"
        android:onClick="notifyActivity" />

</LinearLayout> 
```

如果在 XML 文件中给出了视图对象，为什么它没有 ID？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T18:59:51.217

您在 XML 中使用`android:name`而不是`android:id`分配 id。请改用后者。

# python - 带有 yield 的递归函数不返回任何东西

> ID：12165682
> 
> 赞同：1
> 
> 时间：2012-08-28T18:57:40.457
> 
> 标签：python, recursion, generator, yield

我正在尝试创建一个用于排列目的的生成器。我知道在 Python 中还有其他方法可以做到这一点，但这是为了别的。不幸的是，我无法产生这些值。你能帮我吗？

```
def perm(s,p=0,ii=0):
    l=len(s)
    s=list(s)
    if(l==1):       
        print ''.join(s)
    elif((l-p)==2):
        yield ''.join(s)
        yield ''.join([''.join(s[:-2]),s[-1],s[-2]])
    else:
        for i in range(p,l):
            tmp=s[p]
            s[p]=s[i]
            s[i]=tmp        
            perm(s,p+1,ii) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T19:03:16.393

你的行`perm(s,p+1,ii)`什么也没做，真的：就像打字一样

```
>>> perm("fred")
<generator object perm at 0xb72b9cd4> 
```

但是，如果您从该电话中屈服，即

```
 for subperm in perm(s, p+1, ii):
            yield subperm 
```

然后你会得到

```
>>> list(perm("abc"))
['abc', 'acb', 'bac', 'bca', 'cab', 'cba']
>>> list(perm("abcd"))
['abcd', 'abdc', 'acbd', 'acdb', 'adbc', 'adcb', 'bacd', 'badc', 'bcad', 'bcda', 'bdac', 'bdca', 'cabd', 'cadb', 'cbad', 'cbda', 'cdab', 'cdba', 'dabc', 'dacb', 'dbac', 'dbca', 'dcab', 'dcba']

>>> len(_)
24
>>> len(set(perm("abcd")))
24 
```

看起来不错。除此之外，我还没有测试过代码。

顺便说一句，你可以交换`s[i]`和`s[p]`; `s[i], s[p] = s[p], s[i]`不需要`tmp`变量。

PS：现在你不处理一个字符的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:13:49.557

在生成器中，任何时候你想返回一个值，你都必须`yield`. 就像你有一个递归阶乘函数，看起来像这样：

```
>>> def fact(n, result=1):
    if n==0: return result
    fact(n-1, result*n) 
```

然后你想知道为什么它不返回任何东西：

```
>>> fact(5)
>>> 
```

原因是函数被递归调用，但是值丢失了。你会想做：

```
>>> def fact(n, result=1):
    if n==0: return result
    return fact(n-1, result*n)

>>> fact(5)
120 
```

类似地，在算法的递归部分中，您可以：

```
 for i in range(p,l):
        tmp=s[p]
        s[p]=s[i]
        s[i]=tmp        
        perm(s,p+1,ii) 
```

但是，这没有`yield`任何作用，因此不会`perm(s,p+1,ii)`返回调用中的任何值（编辑：实际上，它们甚至都不会被计算）。您需要遍历递归调用的结果并依次返回每个结果：

```
 for i in range(p,l):
        tmp=s[p]
        s[p]=s[i]
        s[i]=tmp        
        for result in perm(s,p+1,ii):
            yield result 
```

# python - Flask 如何在内部加载蓝图？

> ID：12165683
> 
> 赞同：3
> 
> 时间：2012-08-28T18:57:40.713
> 
> 标签：python, flask, blueprint

我只是对 Flask 的蓝图如何导入感兴趣。它仍然会在 Flask 完成的所有工作结束时导入 python 模块，如果我是对的，python 在导入时会做两件事：在命名空间中注册模块名称，然后在需要时对其进行初始化。

因此，如果 Flask 蓝图在注册时被初始化，那么所有模块都在内存中，如果有很多蓝图要注册，内存就会被浪费，因为在一个请求中基本上你使用一个蓝图。损失不大，但还是...

但是，如果它只在命名空间中注册并且仅在需要时（当真正的请求到达它时）进行初始化，那么一次注册它们是有意义的（这是我理解的推荐方式）。这就是我猜这里的情况:) 但只是想更深入地询问和理解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T10:58:20.337

我绝对不是专家，但我最近一直在玩蓝图。

如果蓝图代码已导入当前 Python 实例，您只能在您的烧瓶应用上注册蓝图，例如：

```
from my_blueprint import blueprint_object

app.register_blueprint(blueprint_object, url_prefix='/my_blueprint') 
```

这意味着 blueprint_object 所需的所有内存都已分配，`__init__.py`与之关联的文件`my_blueprint`已评估，一切准备就绪。

我尝试尝试在该`app.before_first_request`方法中加载蓝图，但烧瓶不允许这样做，蓝图都需要在任何东西发出请求之前加载（并在此*之后*`before_first_request`有效运行，但在任何其他代码开始播放之前）。

 *蓝图旨在为烧瓶网络应用程序提供可扩展的功能。我不确定为什么加载它们会浪费资源，除非您只使用一次特定的功能，在这种情况下，您可能希望将您的应用程序重构为许多不同的您可以根据需要启动的应用程序。*

# php - Wordpress 在正确的目录中找不到 php 文件

> ID：12165686
> 
> 赞同：1
> 
> 时间：2012-08-28T18:57:43.263
> 
> 标签：php, wordpress, wordpress-theming, filepath

我正在使用 wordpress，我一直在学习一些非常好的教程并通读 codex，但我遇到了一个问题，我似乎无法在其他任何地方找到答案。最终我的计划是为我的主题的用户创建一个界面，允许他们更改模板中某些元素的颜色、宽度、定位等。基本上它将是一个 php 文件，它将生成一个 css 文档。现在，尽管它所做的只是回显一个句子。我不确定这在技术上是否是一个“插件”，但是当我尝试将它放在插件文件夹中时，我最终会遇到 404 错误。我知道文件在那里，并且我已经三次检查了路径。我也尝试直接在 url 中导航到 php 文件，但仍然出现 404 错误。我也尝试过使用插件模板。当我在插件管理器中单击“激活”时，它会呼应这句话，但是从 functions.php 文件中调用它时它根本不起作用。任何帮助是极大的赞赏。

这是我放在functions.php末尾的代码：

```
//begin template specific*******************************************************

//------the function below styles the wordpress admin menus.-------

function custom_style() {
    echo '<style type="text/css">#adminmenu .wp-menu-image img {padding: 0px !important; margin-left: -3px;}</style>';
}

add_action('admin_menu', 'register_custom_menu_page');
add_action('admin_menu', 'custom_style');

//------this function adds the template specific menu item.---------

function register_custom_menu_page() {
    add_menu_page('Epsilon', 'Epsilon', 'add_users', plugins_url('epsilon/eps-manage.php', eps-manage.php ), '',   content_url('themes/epsilon/images/eps-icon.png'), 6);
}   // this function creates the correct path as far as I can tell, but when I click the link button in the admin menu, I get the 404.

//------this function hides the editor option under the appearance menu ----------

function remove_editor_menu() {
    remove_action('admin_menu', '_add_themes_utility_last', 101);
}

add_action('_admin_menu', 'remove_editor_menu', 1); 
```

为什么我会收到此 404 错误，是否有更正确的方法来执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:05:35.887

您正在尝试合并插件和主题。plugins_url 只会加载已注册和激活（不确定是否激活 100%）插件的文件，当您正在开发主题时，最好将管理文件与主题文件夹相关联，但老实说这种类型因为你是一个初学者，所以我会把所有的东西都保存在functions.php中，并使用函数作为你菜单的回调。

# jit - 动态语言是如何 JITted 的？

> ID：12165687
> 
> 赞同：8
> 
> 时间：2012-08-28T18:57:43.450
> 
> 标签：jit, dynamic-languages

在动态语言中，动态类型代码 JIT 是如何编译成机器码的？更具体地说：编译器是否在某个时候推断出类型？还是在这些情况下严格解释？

例如，如果我有类似下面的伪代码

```
def func(arg)
    if (arg)
        return 6
    else
        return "Hi" 
```

执行平台如何在运行代码之前知道函数的返回类型是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T19:18:38.973

一般来说，它不会。但是，它可以采用任何一种类型，并为此进行优化。细节取决于它是哪种 JIT。

所谓跟踪JIT编译器对程序进行解释和观察，并记录单次运行的类型、分支等（例如循环迭代）。他们记录这些观察结果，插入（非常快）检查这些假设在执行代码时是否仍然正确，然后根据这些假设优化以下代码。例如，如果你的函数在一个循环中调用，并添加一个持续为真的参数，JIT 编译器首先会记录这样的指令（我们将忽略调用帧管理、内存分配、变量间接等。不是因为那些不重要，但因为它们占用了大量代码并且也被优化了）：

```
; calculate arg
guard_true(arg)
boxed_object o1 = box_int(6)
guard_is_boxed_int(o1)
int i1 = unbox_int(o1)
int i2 = 1
i3 = add_int(res2, res3) 
```

然后像这样优化它：

```
; calculate arg
; may even be elided, arg may be constant without you realizing it
guard_true(arg)
; guard_is_boxed_int constant-folded away
; unbox_int constant-folded away
; add_int constant-folded away
int i3 = 7 
```

防护也可以移动以允许优化早期代码，合并以减少防护，如果它们是多余的则省略，加强以允许更多优化等。如果防护失败过于频繁，或者某些代码以其他方式变得无用，则可以将其丢弃，或者至少修补以在防护失败时跳转到不同的版本。

其他 JIT 采用更静态的方法。例如，您可以进行快速、不准确的类型推断，以至少识别一些操作。一些 JIT 编译器仅在函数范围内运行（因此它们被某些人称为方法 JIT 编译器），因此它们可能无法充分利用您的代码片段（跟踪 JIT 编译器非常受欢迎的一个原因）。尽管如此，它们仍然存在——一个例子是 Mozilla 的 JavaScript 引擎[Ion Monkey](https://wiki.mozilla.org/IonMonkey)的最新版本，尽管它显然也从跟踪 JIT 中获得了灵感。您还可以插入添加并非总是有效的优化（例如内联可能稍后更改的函数）并在它们出错时将其删除。

当所有其他方法都失败时，您可以做解释器所做的事情，将对象装箱，使用指向它们的指针，标记数据，并根据标记选择代码。但这是非常低效的，JIT 编译器的全部目的是摆脱这种开销，所以它们只会在没有合理的替代方案时（或者它们仍在预热时）这样做。

# python - python - 带有时区的日期时间到纪元

> ID：12165691
> 
> 赞同：8
> 
> 时间：2012-08-28T18:57:56.540
> 
> 标签：python, datetime, timezone, epoch

在下面的代码中，我正在计算现在的纪元和当前纪元的开始。

```
import time
import pytz
from datetime import datetime

tz1 = pytz.timezone('CST6CDT')
utc = pytz.timezone('UTC')
now = pytz.UTC.localize(datetime.utcnow())
now_tz = now.astimezone(tz1)
print now_tz
print now_tz.strftime('%s')

begin_day = now_tz.replace(hour=0, minute=0, second=0)
print begin_day

print begin_day.strftime('%s') 
```

打印语句：

```
2012-08-28 13:52:21.595718-05:00
1346187141
2012-08-28 00:00:00.595718-05:00
1346137200 
```

使用 CDT 时区将纪元转换为时间戳：1346187141 - 2012 年 8 月 28 日 15:52:21、1346137200 - 2012 年 8 月 28 日 02:00:00

我希望第二个时代是一天的开始，但现在是凌晨 2 点。转换为纪元时，它看起来仍在使用本地时区 PST。

我究竟做错了什么 ？或者这可以用不同的方式完成吗？

谢谢！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-06-23T02:22:41.347

要将带有时区的日期时间转换为纪元（POSIX 时间戳）：

```
from datetime import datetime
import pytz

tz = pytz.timezone('CST6CDT')

# a datetime with timezone
dt_with_tz = tz.localize(datetime(2012, 8, 28, 19, 33, 50), is_dst=None)

# get timestamp
ts = (dt_with_tz - datetime(1970, 1, 1, tzinfo=pytz.utc)).total_seconds()
# -> 1346200430.0 
```

这是Python 3`datetime.timestamp`中时区感知对象的方法实现方式。`datetime`

要获得“现在时代”：

```
from datetime import datetime

now_epoch = (datetime.utcnow() - datetime(1970, 1, 1)).total_seconds() 
```

或者（假设`time`使用 POSIX 纪元）：

```
import time

now_epoch = time.time() 
```

获取“当前时代的开始”更为复杂，因为不同时区的当前日期可能不同：

```
from datetime import datetime, time
import pytz

tz = pytz.timezone('CST6CDT')

# get current date in given timezone
today = datetime.now(tz).date()
# -> datetime.date(2013, 6, 22)

# get beginning of current day in given timezone as a datetime with timezone
midnight = tz.localize(datetime.combine(today, time(0, 0)), is_dst=None)
# -> datetime.datetime(2013, 6, 22, 0, 0, tzinfo=<DstTzInfo 'CST6CDT'...>)

# get timestamp
ts = (midnight - datetime(1970, 1, 1, tzinfo=pytz.utc)).total_seconds()
# -> 1371877200.0 
```

请参阅[如何获取给定时区的“午夜”UTC 时间？](https://stackoverflow.com/a/11236372/4279).

假设UTC日期获得“当前时代的开始”：

```
from datetime import datetime, date

# get current date in UTC
utc_date = datetime.utcnow().date()
# -> datetime.date(2013, 6, 23)

# get timestamp
ts = (utc_date - date(1970, 1, 1)).days * 86400
# -> 1371945600 
```

请参阅[在 Python 中将 datetime.date/datetime.datetime 转换为 UTC 时间戳](https://stackoverflow.com/a/8778548/4279)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-28T19:42:22.853

**注意：我的回答完全错误。**（我想删除它，但在删除接受标志之前我无法这样做。）

请参阅[JFSebastian 的回答](https://stackoverflow.com/a/17257177/190597)。

下面的代码演示了`now_tz`我们的两种方法产生不同结果的值。

```
import calendar
import pytz
import datetime as dt

tz1 = pytz.timezone('US/Eastern')
utc = pytz.timezone('UTC')
now = utc.localize(dt.datetime(2002, 10, 28), is_dst=None)
now_tz = now.astimezone(tz1)
now_epoch = calendar.timegm(now_tz.utctimetuple())
begin_day = tz1.normalize(now_tz.replace(hour=0, minute=0, second=0))

midnight = tz1.localize(dt.datetime.combine(now_tz, dt.time(0, 0)), is_dst=None)
if begin_day != midnight:
    print(begin_day)
    # 2002-10-27 01:00:00-04:00  # my result -- is not midnight
    print(midnight)
    # 2002-10-27 00:00:00-04:00  # J.F.Sebastian's result is correct 
```

* * *

（原始答案已编辑）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-23T01:21:04.113

the latest release of [simple-date](https://github.com/andrewcooke/simple-date) (version [0.2 on pypi](https://pypi.python.org/pypi/simple-date)) will manage the details for you:

```
>>> from simpledate import *
>>> now_utc = SimpleDate(tz='UTC')
>>> now_tz = now_utc.convert(tz='CST6CDT')
>>> begin_day = now_tz.replace(hour=0, minute=0, second=0, microsecond=0)
>>> now_utc.timestamp
1371950295.777453
>>> now_tz.timestamp
1371950295.777453
>>> begin_day.timestamp
1371877200.0 
```

we can go backwards to check the timestamps (although it's clear above that switching timezone didn't change the epoch, while moving to start of day did):

```
>>> SimpleDate(1371877200.0, tz='CST6CDT')
SimpleDate('2013-06-22 00:00:00.000000 CDT', tz='CST6CDT')
>>> SimpleDate(1371877200.0, tz='UTC')
SimpleDate('2013-06-22 05:00:00.000000 UTC') 
```

# mysql - 不希望分区键成为唯一键的一部分。任何解决方法？

> ID：12165692
> 
> 赞同：1
> 
> 时间：2012-08-28T18:57:57.113
> 
> 标签：mysql

我有这种形式的插入查询：

```
on INSERT into abc values .... on DUPLICATE KEY UPDATE .... 
```

在我没有分区的原始表中，唯一键是打开的，`(subject_id, object_id)`但现在我正在分区`ts`，我被迫拥有唯一键，`(subject_id, object_id, ts)`因为 mysql 要求在所有唯一键中都有分区键。

这意味着我的插入查询将失败，因为插入具有相同的 subject_id 和 object_id（来自以前的插入），但不同的时间戳将被视为唯一的新行，并将被插入而不是所需的更新。

有什么解决方法吗？

```
CREATE TABLE `abc` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `subject_id` varchar(40) COLLATE utf8_unicode_ci NOT NULL,
  `object_id` varchar(36) COLLATE utf8_unicode_ci NOT NULL,
  `ts` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`,`ts`),
  UNIQUE KEY `userint_sub_type_obj` (`subject_id`,`object_id`, `ts`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci
/*!50100 PARTITION BY RANGE (unix_timestamp(ts))
(PARTITION p2012_08_27 VALUES LESS THAN (1346025600) ENGINE = InnoDB,
 PARTITION p2012_08_28 VALUES LESS THAN (1346112000) ENGINE = InnoDB,
 PARTITION p2012_08_29 VALUES LESS THAN (1346198400) ENGINE = InnoDB,
 PARTITION p2012_08_30 VALUES LESS THAN (1346284800) ENGINE = InnoDB,
 PARTITION p2012_08_31 VALUES LESS THAN (1346371200) ENGINE = InnoDB) */ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T21:26:38.870

简而言之，如果不使分区键成为所有唯一（因此也是主）键的一部分，我就无法添加分区。

[http://dev.mysql.com/doc/refman/5.5/en/partitioning-limitations-partitioning-keys-unique-keys.html](http://dev.mysql.com/doc/refman/5.5/en/partitioning-limitations-partitioning-keys-unique-keys.html)

上周我实际上遇到了同样的问题，试图在启用/禁用列上删除一个分区。想到了两个解决方案。

1.  您可以将时间戳移动到 meta_info 表中并对其进行分区。然后，您的具有时间条件的查找可以利用分区而不会弄乱您的 (subject_id, object_id) 键。开销当然是你需要加入。如果您的桌子很大，这可能不可行。
2.  在更新之前进行检查。不是使用 ON DUPLICATE KEY 选项，而是将操作拆分为 SELECT 以查看记录是否存在，然后根据答案执行 INSERT 或 UPDATE。

不用说，我发现这种分区限制是一个巨大的痛苦，但它似乎是 MySQL 的一个限制，经过一些谷歌 Fu 和四处询问，似乎有*简单*的方法解决它。

# javascript - 为什么我会得到这个关闭的值“结果”？

> ID：12165693
> 
> 赞同：2
> 
> 时间：2012-08-28T18:58:06.243
> 
> 标签：javascript, closures, memoization

假设我有这段代码（[小提琴](http://jsfiddle.net/2T3cD/)）旨在记忆模块：

```
var chat = {
 // Create this closure to contain the cached modules
 module: function() {
    // Internal module cache.
    var modules = {};
     console.log('in module:', name);  // <---------- "in return: result"     
    // Create a new module reference scaffold or load an
    // existing module.
    return function(name) {
      console.log('in return:', name); // <---------- "in return: derp"
      // If this module has already been created, return it.
      if (modules[name]) {
        return modules[name];
      }

      // Create a module and save it under this name
      return modules[name] = { Views: {} };
    };
  }()
};

chat.module("derp"); 
```

代码中没有任何地方提到“结果”这个短语。为什么它会在第一个控制台日志中返回该值？

`name`另外，当声明中没有指定参数时，返回函数如何获取参数的值`module: function() {}`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:01:56.280

```
console.log('in module:', name); 
```

`name`您在声明它之前正在记录。所以它正在使用[`window.name`](https://developer.mozilla.org/en-US/docs/DOM/window.name)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T19:04:26.597

```
… = function() {
    // …
    console.log('in module:', name);  // <---------- "in return: result"     
    return function(name) {…};
}(); 
```

你看，在那个立即执行的匿名函数表达式的范围内，没有变量“ `name`”。因此，将使用全局变量[`window.name`](https://developer.mozilla.org/en-US/docs/DOM/window.name)-它的值似乎`"result"`在您的情况下（jsfiddle 目标 iframe 的名称）-尝试[打开的页面](http://fiddle.jshell.net/2T3cD/show/light/)，它将记录一个空字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T19:09:57.890

仅供参考......在这个例子中的“**结果**”是JsFiddle中右下角窗口（div / iframe）的名称（或者更好地说是ID）......

正如**@Rocket** & **@Bergi**已经说过的那样......你得到了“window.name”

# c# - ContextMenuStrip FindForm 为空

> ID：12165694
> 
> 赞同：2
> 
> 时间：2012-08-28T18:58:07.147
> 
> 标签：c#, winforms, visual-studio-2008

我有`ContextMenuStrip`一个`DataGridView`。在意识到调用`cm.FindForm()`结果为 null 后，我将上下文菜单添加到网格的`ContextMenuStrip`属性中，但这并没有帮助。

我是否缺少其他一些设置以便上下文菜单`FindForm()`返回表单？

**注意**：我通过 Visual Studio 设计器添加了上下文菜单，方法是将其拖动到表单中。主菜单 (a `MenuStrip`) 也没有显示此行为，它`FindForm()`会正确返回表单。

**编辑**：对于汉斯（为什么我以我的方式做事）

我曾经将所有代码都放在一个很长的 Form1.cs 中，但这显然很难维护。我发现将所有代码分离到一个框架中，该框架对于每个组件都是一个单独的类，然后通过注入根据需要引用其他类更容易维护和遵循。

对于那些不是控件的组件，我将组件所属的表单传递给构造函数，但是对于那些是控件的组件，我发现该`FindForm()`方法是一种快捷方式。框架的基类使用`FindForm()`. **因此，每个组件都可以通过 Form 属性访问表单。**

现在我发现上下文菜单控件没有得到它的父控件集，因此`FindForm()`无法正常工作。

# javascript - CSS将百分比转换为像素

> ID：12165696
> 
> 赞同：4
> 
> 时间：2012-08-28T18:58:14.863
> 
> 标签：javascript, css

我有指定宽度和高度的“div”元素，在 CSS 中以百分比表示。
我想通过 JS 脚本获取以像素表示的宽度和高度。甚至有可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T19:05:17.947

您可以使用

```
el.clientHeight;
el.clientWidth; 
```

（`el`是对元素的引用）

[**演示**](http://jsfiddle.net/akrjM/89/)

请注意，这些属性最初是在 MS IE DHTML 对象模型中引入的。最近，它们在[CSSOM 视图模块](http://www.w3.org/TR/2008/WD-cssom-view-20080222/)中被标准化，W3C 工作草案 2008 年 2 月 22 日。

这些属性得到了广泛的支持。但是，旧的不兼容 MS 的浏览器可能不支持它们。在这些情况下，您可以使用`getComputedStyle`：

```
function findSize(el, size) {
    /* size must be 'width' or ' height' */
    return window.getComputedStyle
        ? getComputedStyle(el,null).getPropertyValue(size)
        : el['client'+size.substr(0,1).toUpperCase() + size.substr(1)] + 'px';
}
findSize(el, 'width');
findSize(el, 'height'); 
```

[**演示**](http://jsfiddle.net/akrjM/88/)

浏览器对`getComputedStyle`和`clientHeight`/`clientWidth`方式的支持至少是：

```
 | IE  | Firefox | Chrome | Safari | Opera
-----------------|-----------------------------------------
getComputedStyle | 9   | <=3     | 1      | <=4    | <=10
client           | <=5 | <=3     | 1      | <=4    | <=10 
```

^(（`<=n`意味着至少从 version 支持它`n`，但我无法测试以前的版本）)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T19:14:53.677

Use [`window.getComputedStyle()`](https://developer.mozilla.org/de/docs/DOM/window.getComputedStyle) for this

```
<div style="wdith:50%">50% width</div>​​​​​​​​​​​​​

(function() {
    var div = document.getElementsByTagName("div")[0];

    console.log(window.getComputedStyle(div, null)["width"]);
}())​ 
```

[fiddle](http://jsfiddle.net/wMdz5/)

Supported by all major browsers and IE9+. For lower versions of IE have a look at [`currentStyle`](http://msdn.microsoft.com/en-us/library/ie/ms535231%28v=vs.85%29.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T19:09:07.927

看看[**这个**](http://jsfiddle.net/TfuNC/)。

jQuery 键是：

```
$("#div").width(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-03T11:50:24.223

jQuery 键是：

```
$("#div").width($("#div").width()); 
```

# unix - 自动触发 UNIX shell 脚本

> ID：12165697
> 
> 赞同：0
> 
> 时间：2012-08-28T18:58:14.667
> 
> 标签：unix

我在名为 main.ksh（在 /home/pkawar/folder 中）的文件夹中有一个主脚本，它的输入文件 inputfile.xls（在 /home/pkawar/folder/ipfile 中）。

1.  当我运行 main.ksh 时，它使用 inputfile.xls 并将输出传送到邮件地址。

2.  inputfile.xls 通过 ftp 命令加载到路径 /home/pkawar/folder/ipfile。

当文件 inputfile.xls 成功加载时，是否可以自动运行 main.ksh 并通过邮件发送输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:11:35.587

您应该做的第一件事是编写一个脚本来执行您想做的任何事情。如果您的脚本正确执行，您可以`cron`通过`crontab`文件使用该脚本以您希望的任何时间表执行。

详情请参阅`man crontab`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:01:37.350

第一个选择是使用 cron，但从您的问题来看，您似乎不想走那条路。

我的问题是，什么是创建 *.xml 文件？是否有可能创建该文件以知道它何时完成然后调用 shell 脚本，或者更好的是，将 xml 文件即时流式传输到 shell 脚本？

# http - SSRS 计划报告 - 无 HTTP 日志条目

> ID：12165700
> 
> 赞同：0
> 
> 时间：2012-08-28T18:58:25.943
> 
> 标签：http, logging, reporting-services, schedule

我希望从生产中的 HTTP 日志中获取有关参数检索的一些统计信息。当我们通常通过报告管理器或通过 URL 执行报告时，我们已经得到了它们。但是，当通过计划运行报告时（我们在生产中设置它们以进行热身），没有任何记录....

我们还在我们的测试环境中通过计划尝试了一份报告，但没有得到任何 http 条目.. :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:36:06.033

计划报告作为 SQL Server 代理作业运行，因此如果它们没有命中 ReportServer，我一点也不感到惊讶，因此没有 HTTP 日志。

您是否查看过查询[执行日志](http://www.sqlchick.com/entries/2011/2/6/querying-the-report-server-execution-log.html)？它有非常详细的信息，并且将包含每个报告执行的条目。

# c# - 将数组转换为字符串循环问题

> ID：12165701
> 
> 赞同：0
> 
> 时间：2012-08-28T18:58:26.927
> 
> 标签：c#, .net

我有一个 foreach 循环将电子邮件地址添加到数组中。最后，我加入数组并将其推入字符串中。

当数据库中的某个人的电子邮件地址为空白时，我遇到了一个问题，这会扰乱我的逻辑。有人可以帮我解决这个问题吗？

```
TestGuy1: 
TestGuy2: 2@2.com
TestGuy3: 3@3.com 
```

使用上述信息，它会创建一个 3 长度的数组，然后将其转换为如下所示的字符串：

```
sEmailList  "2@2.com,3@3.com,"  string 
```

代码：

```
DataTable GetUserReportsToChain = objEmployee.GetUserReportsToChain(LoginID, ConfigurationManager.AppSettings.Get("Connection").ToString());

int RowCount = GetUserReportsToChain.Rows.Count;
string[] aEmailList = new string[RowCount];
int iCounter = 0;
foreach (DataRow rRow in GetUserReportsToChain.Rows)
{
    if (rRow["usrEmailAddress"].ToString() != "")
    {
        aEmailList[iCounter] = rRow["usrEmailAddress"].ToString();
        iCounter++;
        //String email = rRow["usrEmailAddress"].ToString(); 
    }
}

string sEmailList = String.Join(",", aEmailList); 
```

知道当数据库有电子邮件的空白值时如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T19:02:47.753

您想使用`List<string>`而不是固定大小的数组。或返回非空字符串的简单 LINQ 查询。

```
List<string> aEmailList = new List<string>();
foreach (DataRow rRow in GetUserReportsToChain.Rows)
{
    if (!String.IsNullOrEmpty(rRow["usrEmailAddress"].ToString()))
    {
        aEmailList.Add(rRow["usrEmailAddress"].ToString());
    }
}
string sEmailList = String.Join(",", aEmailList); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T19:08:04.270

一体

```
var sEmailList = String.Join(",", 
      GetUserReportsToChain.Rows
      .Cast<DataRow>()
      .Select(m => m["usrEmailAddress"].ToString())
      .Where(x => !string.IsNullOrWhiteSpace(x))); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T19:03:11.410

你可以试试

```
String.Join(",", aEmailList.Where(s => !string.IsNullOrEmpty(s))); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-28T19:06:25.320

您可以将 if 语句更改为：

```
if(!string.IsNullOrEmpty(rRow["usrEmailAddress"].ToString().Trim()) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-28T19:03:24.787

如果您使用的是 3.0 或更高版本：

```
String.Join(",", aEmailList.Where(s => s.Trim() != "")); 
```

# iphone - AURemoteIO - 在 iOS 5.1 上使用 Twilio 在后台接受传入的 VOIP 呼叫

> ID：12165702
> 
> 赞同：1
> 
> 时间：2012-08-28T18:58:28.223
> 
> 标签：iphone, ruby-on-rails, ios5, core-audio, twilio

在我们的系统中，我们有一个 Rails 服务器向 iphone 设备和一个固定电话发起电话会议。当我们的 iphone 应用程序在后台接收来电时，我们会看到一系列有关 AURemoteIO 初始化失败的错误消息。错误如下：

```
<0x4336000> AURemoteIO::Initialize failed: -12985 (enable 3, outf< 1 ch,  16000 Hz, Int16> inf< 1 ch,  16000 Hz, Int16>)
<0x4336000> AURemoteIO::Initialize failed: -12985 (enable 3, outf< 1 ch,  44100 Hz, Int16> inf< 1 ch,  44100 Hz, Int16>)
<0x4336000> AURemoteIO::Initialize failed: -12985 (enable 3, outf< 1 ch,  48000 Hz, Int16> inf< 1 ch,  48000 Hz, Int16>)
<0x4336000> AURemoteIO::Initialize failed: -12985 (enable 3, outf< 1 ch,  32000 Hz, Int16> inf< 1 ch,  32000 Hz, Int16>)
<0x4336000> AURemoteIO::Initialize failed: -12985 (enable 3, outf< 1 ch,  16000 Hz, Int16> inf< 1 ch,  16000 Hz, Int16>)
<0x4336000> AURemoteIO::Initialize failed: -12985 (enable 3, outf< 1 ch,   8000 Hz, Int16> inf< 1 ch,   8000 Hz, Int16>) 
```

从我们在日志消息中可以看出，这发生在 didReceiveIncomingConnection 回调之后或期间的某个时间点。这是该函数的代码：

```
-(void)device:(TCDevice*)device didReceiveIncomingConnection:(TCConnection*)connection{
    if ( _connection ){
        [self disconnect];
    }
    _connection = [connection retain];
    [_connection accept];
} 
```

不幸的是，我们从来没有达到这个`connectionDidConnect`功能。但是，这确实可以在前台正常工作。可悲的是，这是应用程序的必要要求（在后台运行）。

我们将**UIBackgroundMode**设置为**location**、**VOIP**和**audio**。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T21:48:08.070

当应用程序在后台时，您无法打开音频设备。

在[回调](https://www.twilio.com/docs/quickstart/php/ios-client/incoming-connections)中：

```
-(void)device:(TCDevice*)device didReceiveIncomingConnection:(TCConnection*)connection 
```

呼叫您应该向用户显示 UILocalNotification 告诉他们有来电，然后一旦用户“打开”通知（从而将应用程序带到前台），您应该调用：

```
[_connection accept]; 
```

# safari - Safari 阅读器中的 Cufon 问题

> ID：12165707
> 
> 赞同：1
> 
> 时间：2012-08-28T18:58:49.237
> 
> 标签：safari, cufon

事实证明，Safari Reader 以一种有趣的方式处理 Cufon。当 Safari 阅读器处理“Cufonized”文本时，它会离开画布元素，从而在输出中产生间隙。

经过进一步调查并尝试解决该问题，我发现似乎无法在不影响整个站点的情况下从开发人员端控制 safari 阅读器的输出。

有没有人有什么建议？

![在此处输入图像描述](../Images/cf66277ae0c938afd9d7da1e22f97682.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T21:04:13.230

是的，所以这是 cufon 在使用 safari“阅读器”时遇到的问题，或者大多数人都知道，显示在 ipad/iphone/ipod 浏览器上的“阅读器”按钮。

例如，假设我们有一个像这样的 cufonized h1 标签：

```
<h1>Hello World!</h1>. 
```

好吧，这就是 cufon 对它所做的，减去所有这些属性和内联样式：

```
<h1>
<cufon>
<canvas></canvas>
<cufontext>Hello</cufontext>
</cufon>
<cufon>
<canvas></canvas>
<cufontext>World!</cufontext>
</cufon>
</h1> 
```

当“阅读器”打开它时，它会显示如下内容：

_ 你好世界！。

其中“ *_* ”是由元素引起的空格。

__ 所以 __ 想象 __ 阅读 __ 文本 __ 喜欢 __ 这个！！！

恼人的！！

所以我修改了 cufon-yui.js 文件版本 1.09i 所以输出会是这样的，

```
<h1>
<beforetext>Hello World!</text>
<cufon>
<canvas></canvas>
</cufon>
<cufon>
<canvas></canvas>
</cufon>
</h1> 
```

所以当“阅读器”打开它时，它看起来像这样：

你好世界！**_ _**

空白画布出现在文本之后，所以你不会得到那种奇怪的效果。

所以这里是修复：

在第 1240 - 1259 行（对某些人来说可能不同，但很容易发现），我更改了以下内容

```
styleSheet.appendChild(document.createTextNode((
    'cufon{text-indent:0;}' +
    '@media screen,projection{' +
        'cufon{display:inline;display:inline-block;position:relative;vertical-align:middle;' +
        (HAS_BROKEN_LINEHEIGHT
            ? ''
            : 'font-size:1px;line-height:1px;') +
        '}cufon cufontext{display:-moz-inline-box;display:inline-block;width:0;height:0;text-align:left;text-indent:-10000in;}' +
                    'beforetext{display:-moz-inline-box;display:inline-block;width:0;height:0;text-align:left;text-indent:-10000in;position:absolute;left:-99999px}' +              
        (HAS_INLINE_BLOCK
            ? 'cufon canvas{position:relative;}'
            : 'cufon canvas{position:absolute;}') +
        'cufonshy.cufon-shy-disabled,.cufon-viewport-resizing cufonshy{display:none;}' +
        'cufonglue{white-space:nowrap;display:inline-block;}' +
        '.cufon-viewport-resizing cufonglue{white-space:normal;}' +
    '}' +
    '@media print{' +
        'cufon{padding:0; display:none;}' + // Firefox 2
        'cufon canvas{display:none;}' +
    'beforetext {text-indent:0;text-align:left;display:block; width:100%; height:auto}'+
    '}'
).replace(/;/g, '!important;'))); 
```

这将为新的“beforetext”元素和打印和屏幕设置样式，

在“返回函数（字体、文本、样式、选项、节点、el）”之后的第 1296 行，我添加了：

```
 var tagtype = $(el).get(0).tagName;
    if (tagtype == "BEFORETEXT"){return null;} 
```

这是为了避免在悬停选项上将 beforetext 重写为自身。

现在从第 1336 - 1353 行（同样可能不同，但很容易发现）我将其更改为

```
 if (redraw) {
        wrapper = node;
        canvas = node.firstChild;

        if (options.printable) {
            $(el).find('beforetext').append(document.createTextNode(text));
        }

    }
    else {

        wrapper = document.createElement('cufon');
        canvas = document.createElement('canvas');          
        wrapper.className = 'cufon cufon-canvas';
        wrapper.setAttribute('alt', text);
        wrapper.appendChild(canvas);

        if (options.printable) {
            var beforeText = document.createElement('beforetext');
            $(el).not(':has(beforetext)').prepend('<beforetext></beforetext>');
            $(el).find('beforetext').append(document.createTextNode(text));
        }
    } 
```

上面只添加了一次“beforetext”元素，然后在创建每个 cufon 文本时将文本附加到该元素，并在悬停选项上重新应用它，这样它就不会被擦除。

就是这样。希望这可以帮助外面的人。并随时纠正我，改进它，或找到更好的解决方案，我想知道其他更好的方法。祝大家编码愉快。

PS
对不起，很长的回复。只是试图确保有相同问题的人了解发生了什么。

# xcode - 在 xcode 4.4 中创建新的objective-c 类时没有创建头文件

> ID：12165710
> 
> 赞同：3
> 
> 时间：2012-08-28T18:59:02.243
> 
> 标签：xcode, header-files

我正在尝试使用 xcode 4.4 创建和 Objective-c 类（子类 UIViewController）。我转到 File->new 并在 ios/Cocoa Touch 下选择一个 Objective-c 类模板。它说这个选择将创建“一个带有实现和头文件的Objective-C类。”。但它只创建一个实现文件。实现文件有一个 #import 用于缺少的头文件。

我正在使用故事板。我没有选择“使用 XIB 作为用户界面”。

难道我做错了什么？如果这是一个错误，关于如何解决它的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:58:35.180

好的，我找到了解决方案。首先，我删除了在项目目录中使用 Finder 看到的头文件。然后我进入xcode并删除了实现文件。然后我重新开始并重新创建了objective-c 类。这次创建了头文件。奇怪的

# python - python在struct模块中的标准位大小

> ID：12165714
> 
> 赞同：0
> 
> 时间：2012-08-28T18:59:18.330
> 
> 标签：python

在[http://docs.python.org/library/struct.html](http://docs.python.org/library/struct.html)中，它说“<”代表标准大小的小端模式。我在这个网站上查了一下，它说标准尺寸是 16 位。

**为什么是 16 位？**

无论如何将其更改为 8 位并仍在使用小端？

此致！

问题仍然存在！

我知道 LSB 或 MSB 描述基于字节的数据组织。问题是标准大小是16位，所以python根据标准大小读取数据，然后基于LSB或MSB。如果我使用

而且，如果标准大小是 16 位长，那么为什么如果我使用“>h”，它实际上给出了正确答案，因为标准大小是 8 位？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:02:14.147

Big endian 和 little endian 对于一个字节来说并没有真正的意义。Endianness 描述了多字节类型中的字节顺序。

也就是说，您可以使用 " `<B`" 作为您的类型。这给了你小端 8 位。

# build - 在 MSBuild 中构建后调用 Publish

> ID：12165715
> 
> 赞同：3
> 
> 时间：2012-08-28T18:59:19.357
> 
> 标签：build, msbuild, publish

每次构建 WPF 应用程序时，我都会尝试调用 Publish 目标。我已经调整了 .csproj 文件以包含以下内容：

```
<Target Name="AfterBuild">
  <Message Text="Running AfterBuild..." />
  <MSBuild Projects="$(MSBuildProjectFullPath)" Properties="Configuration=$(Configuration); PublishDependsOn=" Targets="Publish" />
</Target> 
```

当我从命令行运行它时，我看到它是“Running AfterBuild...”的消息，但没有任何反应。如果我删除 '; PublishDependsOn=' 从`Properties`任务`MSBuild`中，我得到一个循环引用错误。

我在这里缺少什么魔法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T19:46:07.610

好的，我想出了如何做我想做的事。我没有尝试在 AfterBuild 中显式调用 Publish，而是将其添加到`DefaultTargets`项目中。现在它调用 Build 然后 Publish。

`<Project ToolsVersion="4.0" DefaultTargets="Build;Publish" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">`

# css - 流体-流体-流体三柱

> ID：12165716
> 
> 赞同：1
> 
> 时间：2012-08-28T18:59:27.753
> 
> 标签：css, fluid-layout

是否可以有 3 列，宽度相等，中间有 2 列，都是流动的？我能找到的所有内容都显示固定一列，或者它们具有不同的宽度。我需要它们都一样。无论我在这个页面上做什么，最后的 li 都不会一直到容器的边缘。如果我放大 li 的百分比，那么它不适合较小的分辨率。谢谢！

[页面示例在这里](http://www.kimwilddesigns.com/index_new.htm)

[CSS 在这里](http://www.kimwilddesigns.com/css/kw_styles-responsive2.css)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T18:50:55.283

It looks like you already got an answer on how to get it working, but you'll quickly run into another problem if you're going to have any sort of margin or border on these columns.

Those width percentages? They don't include border/margin - so if you add either of those, you'll once again have columns overflow.

Solution? Make sure to set `box-sizing: border-box;` - if you haven't heard of it before, Google it. It's magical!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:15:43.497

your question puzzles me a bit. On the one hand, this example shows what you sound like you're asking for:

[http://jsfiddle.net/JuamW/](http://jsfiddle.net/JuamW/)

On the other hand, the actual example of your site shows a fixed-width situation where your columns have no requirement to be fluid. If the above example doesn't give you what you need, could you provide some more context?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T19:21:40.203

我想说这都是关于计算正确的百分比。

要重新开始，请删除所有三列的边框和边距。然后将它们的宽度设置为 33.3333%，这样它们就可以完美地放入容器中。

查看您的 CSS，我可以看到中间列的边距（左右）为 3.75%，因此您必须将列宽重新计算为 100 - (3.75 * 2) / 3 = 30.833333%。

其次，切换`border`到 an`outline`以防止在布局中添加不必要的宽度。

最后让你`img`的 s 宽度为 100%，这样它们就可以很好地放入容器中。

应该在那之后完成，我使用 Firebug 在您的网站上执行所有这些更改，看起来它成功了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T19:23:26.630

如果你想把最后一个 li 拿出来，请添加：

```
#categories-wrapper ul li.students{
    float: right;
}

#categories-wrapper ul li.fine-art{
        float:left;
} 
```

将 categories-wrapper ul li:nth-child(2) 替换为：

```
#categories-wrapper ul li.gd {
margin-left: 4.25%; /* 36px / 960px */
    float: left; 
```

}

并修改：

```
#categories-wrapper ul li {
    width: 30.20833%; /* 290 / 960 */
    border: 1px solid #333;
    position: relative;
    } 
```

那是你要找的吗？

# php - 表单中的提交按钮在 php print 中不起作用

> ID：12165718
> 
> 赞同：1
> 
> 时间：2012-08-28T18:59:35.413
> 
> 标签：php, javascript, html

编辑：由评论回答，谢谢！

<form> 不能在 php 的打印中工作吗？

我一直在浏览这个页面，构建我希望它拥有的部分——我的最后一个小故障是提交按钮根本没有激活。

我有一个页面使用 jquery 隐藏包含用户提交的信息的 div - 当管理员单击按钮以显示摘要时显示这些信息。

在隐藏的 div 中，有两列 - 其中一列具有超短格式 - 管理员单击单选按钮对提交的信息进行分类。这是提交按钮根本不起作用的地方。

表格出现了，事实上，一切看起来都和预期的一样。我知道代码可以正常工作，因为我在另一个页面上自己尝试过 - 所以我假设有我没有也找不到的知识。

有什么建议吗？

```
<?php
 include('filethatconnectstothedatabase.php');
 $conn = new DatabaseConn();
 $query = ("
          SELECT *
          FROM abstracts
          WHERE visible=\"1\"
          ");
 $result = mysql_query($query);

 $numfields = mysql_num_fields($result);
 $data = array();
 $flist = array();

for($i=0;$i<$numfields;$i++)$flist[] = mysql_field_name($result,$i);
  $data[0] = $flist;
  while($row = mysql_fetch_assoc($result)){
  $data[] = $row;

print '

<div id="table-'.$row['abstractid'].'" class="hide">
   <div class="column1">
   <ul>
    <li>
   <span class="spantitle">Author:</span> ' . $row['abstract_author'] .'
   </li>

   <li><span class="spantitle">Applicant Type:</span> ' . $row['applicant_type'] .'
   </li>

   <li>
    <span class="spantitle">Presentation Type:</span> ' . $row['presentation_type'] .'
   </li>

   <li>
  <span class="spantitle">Affiliation:</span> ' . $row['author_affiliation'] .'
  </li>

  <li>
 <button data-hide-id="'.$row['abstractid'].'" class="read-abstract">
  Hide Abstract
 </button>
</li>

</ul>

<div class="clr"></div>

<form action="assign_abstract.php" method="post">

<fieldset>
  <span class="spantitle">Assign Session for abstract # '. $row['abstract_id'] .':</span>
  <input type="hidden" name="abstract_id" value="'. $row['abstract_id'] .'" />

  <br />
  <input type="radio" name="abstract_category" value="session1" />Session One:
  <br />
  Session One

  <br />
  <input type="radio" name="abstract_category" value="session2" />Session Two:
  <br />
  Session Two

  <br />
  <input type="radio" name="abstract_category" value="session3" />Session Three:
  <br />
  Session Three

  <br />
  <input type="radio" name="abstract_category" value="session4" />Session Four:
  <br />
  Session Four

  <br />
  <input type="radio" name="abstract_category" value="notapplicable" />Not Applicable

  <br />
  <br />
  <input type="button" name="submit" value="submit" />

  </fieldset>

  </form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:08:33.443

首先：您可能应该使用`<input type="submit">`- 我不确定它是否只是您粘贴到 stackoverflow 中的内容，但您缺少结束逗号和分号。您要查看的另一件事是您实际填充到值中的内容。查看您正在创建的页面的源代码，以确保没有将意外字符放入您的输出中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T19:04:29.013

表单在 php echo 和打印中工作正常。您是否尝试输入提交而不是输入按钮？例子：

```
<input type="submit" name="submit" value="submit" /> 
```

代替

```
<input type="button" name="submit" value="submit" /> 
```

# c# - RavenDB 只能通过 http？

> ID：12165723
> 
> 赞同：-3
> 
> 时间：2012-08-28T18:59:46.010
> 
> 标签：c#, .net, nosql, ravendb

我正在尝试学习 RavenDB 并使用它的 .Net 客户端。如果我没记错的话，我认为使用像 RavenDB 这样的 NoSql 数据库的主要原因是速度。它似乎非常快，因为它不是相关的。但是，当我尝试使用 RavenDB 的 .Net 客户端时，我发现所有调用都是基于 REST 的调用。这不是减慢速度吗？对于添加文档的每次调用，它都会调用 HILO，这基本上让 .Net 客户端知道哪个应该是下一个要使用的唯一编号，然后它会进行第二次调用以存储实际文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T21:04:06.673

您似乎在控制台应用程序中运行 RavenDB，并以非常短暂的方式检查发生了什么。随着时间的推移，在真实应用程序中运行 RavenDB，您会发现它针对网络使用进行了高度优化。每 X 次更新，您只能看到一次此 hilo 调用，并且 X 次根据您的实际使用场景而变化。你使用 RavenDB 的次数越多，它变得越快。

# php - HTTP post 未正确发送特殊字符

> ID：12165725
> 
> 赞同：0
> 
> 时间：2012-08-28T18:59:52.733
> 
> 标签：php, mysql, html, post, encoding

我有两个 .php 文件，一个带有文本字段的表单，您可以在其中放置要在数据库中搜索的名称，以及一个处理帖子的结果文件......

将使用以下查询搜索数据库中的名称：

```
SELECT * FROM acw_papers_web web 
INNER JOIN acw_papers_web_autores aut 
ON web.id_paper_web = aut.id_paper_web 
WHERE aut.nombre_autor_pw LIKE '%autorname%' 
ORDER BY web.probabilidad DESC 
```

问题是，当我发送帖子时，发送 lópez，它发送 lópez...

我该如何解决它...两个 .php 文件都是 utf-8 编码的...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:23:17.893

由于您没有提供太多信息，因此我无法准确指出问题所在。但这里有两种可能的解决方案：

1.  `<head>`在两个文件中设置正确的字符集：

    `<meta charset="UTF-8" />`对于 HTML5 或`<meta http-eqiv="Content-Type" content="text/html; charset=UTF-8" />`其他一切

2.  将数据库表的字符集设置为 UTF-8。在 MySQL 中：

    `ALTER TABLE acw_papers_web CHARACTER SET utf8 COLLATE utf8_general_ci;`
    `ALTER TABLE acw_papers_web_autores CHARACTER SET utf8 COLLATE utf8_general_ci;`

暂时能想到的就这么多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:24:18.577

您需要使用 urlencode() - URL-encodes string urldecode() - URL-decode 函数在 Post Request 中发送特殊字符。

# c# - 检查 null 的性能损失

> ID：12165730
> 
> 赞同：3
> 
> 时间：2012-08-28T19:00:22.703
> 
> 标签：c#, asp.net-mvc, performance, null, null-check

谁能告诉我在 c# 中检查对象或对象的属性是否为空的性能成本是多少？我正在开发一个 ASP.NET MVC 应用程序，该应用程序正在模型中完成空值检查，然后在视图中再次完成。我觉得这太过分了，但如果没有真正的性能受到影响，那么我看不出以这种方式做事有什么害处。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T19:03:42.063

如果您在渲染和初始化模型时只执行一次，我认为它是不可测量的。

但是，如果它位于计算密集型循环中，则会产生影响。

查询数据库、读/写文件等是您应该注意的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T19:05:13.820

几乎是微不足道的。这样做两次不是问题。做几十亿次可能仍然不是问题（但会表明其他一些编程问题）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T19:06:32.327

好吧，当然会有一些性能损失，检查是否为空需要一些指令......

如果您想尽量减少性能损失，请使用 ILDASM 工具查看您正在使用的方法的 CIL 代码，并检查正在发生的实际执行路径。我什至会说：确保您使用的是 Object.ReferenceEquals 之类的东西（而不是实例的 Equals 方法或相等运算符）。

# security - RSA算法如何加密和解密字符串文本？

> ID：12165732
> 
> 赞同：1
> 
> 时间：2012-08-28T19:00:26.540
> 
> 标签：security

我需要使用 RSA 算法进行加密和解密的算法。现在我有了公钥、私钥和字符串文本。问题是

1.  我需要知道如何加密它。加密文本中的每个字符或加密整个文本。
2.  密文只有数字时如何解密。如何除数解密。

ps对不起我的英语不好。= ="

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T05:50:22.567

标准方法是：

1.  生成对称算法的密钥（例如，AES）。

2.  用它们加密文本。

3.  使用 RSA 加密此密钥，例如使用 PKCS#1 表示法。

4.  组成一个包含密文、加密密钥和其他服务信息（对称算法标识符、接收者 ID 等）的输出结构。最常用的格式在[RFC 5652](https://www.rfc-editor.org/rfc/rfc5652)中注明。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-10-07T09:31:54.203

您可以从字符串中获取每个字符，将其 ascii 值加密，然后再次将其转换为文本并存储。对所有字符执行此操作。这将是您的加密文本。像解密一样明智地这样做..希望它有所帮助

# python - 如何在python中引用空dict值

> ID：12165735
> 
> 赞同：1
> 
> 时间：2012-08-28T19:00:33.697
> 
> 标签：python, dictionary

如果不是很明显，我是通过网络教程学习的新手。

我正在尝试遍历具有不同长度的字典，并将结果放在表中。我想在可能存在空值的表中放入“nothing”。

我正在尝试以下代码：

```
import os

os.system("clear")

dict1 = {'foo': {0:'a', 1:'b', 3:'c'}, 'bar': {0:'l', 1:'m', 2:'n'}, 'baz': {0:'x', 1:'y'} }
list1 = []
list2 = []
list3 = []

for thing in dict1:
    list1.append(dict1[thing][0])
print list1

for thing in dict1:
    list2.append(dict1[thing][1])
print list2

for thing in dict1:
    if dict1[thing][2] == None:
        list3.append('Nothing')
    else:
        list3.append(dict1[thing][2]) 
```

我得到以下输出/错误：

```
['x', 'a', 'l']
['y', 'b', 'm']
Traceback (most recent call last):
  File "county.py", line 19, in <module>
    if dict1[thing][2] == None:
KeyError: 2 
```

如何在字典中引用空值？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T19:03:38.360

使用`get()`. 默认会返回一个`None`

```
val = dict1[thing].get(2) 
```

或者指定你想要的默认值：

```
val = dict1[thing].get(2, 'nothing') 
```

这样，无论密钥是否存在，您都可以将有效的“无”作为后备。

```
for thing in dict1:
    list3.append(dict1[thing].get(2, 'Nothing')) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T19:04:20.497

您应该使用`in`or`not in`运算符来检查密钥是否存在：

```
if 2 not in dict[thing]:
    # do something 
```

或者，如果您真的想`None`作为后备，请使用`.get()`：

```
val = dict[thing].get(2)
if val is None:
    # do something 
```

此外，将来，您应该`is None`在比较时使用`None`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T19:07:14.247

尝试使用运算符访问不存在的密钥`[]`将始终返回一个`KeyError`. 您可以使用该`dict.get(key, default)`方法返回默认参数中指定的值，也可以在`try/except`块中访问字典，并让 except 块捕获`KeyError`异常并将“Nothing”附加到列表中。

# java - 正则表达式的这种语法是什么意思？

> ID：12165737
> 
> 赞同：-2
> 
> 时间：2012-08-28T19:00:38.207
> 
> 标签：java, regex

谁能告诉我以下 Java 代码片段中的正则表达式是什么意思：

```
String someString = …;
someString.matches("^\\d{5}-\\d{4}$"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:02:54.680

这将匹配字符串开头的 5 个十进制数字，后跟一个破折号，最后是 4 个十进制数字。

```
^ = Beginning of string
\d{n} = Match n decimal numbers
$ = End of string 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:03:01.370

来自[http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html)

五位数字，一个破折号，然后再四位数字......没有别的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T19:04:33.603

`^`表示行首。

`\d{5}`表示五位数。

`-`字面意思是“-”

`\d{4}`表示四位数。

`$`表示行尾。

所以它正在寻找一个五位数的序列，然后是一个四位数的序列，用破折号分隔，这是唯一的东西。

例子：

> 12345-6789

# php - Drupal 7 将内容类型 url 设置为自定义值

> ID：12165738
> 
> 赞同：1
> 
> 时间：2012-08-28T19:00:43.607
> 
> 标签：php, drupal, drupal-7, drupal-modules, drupal-views

我正在使用 Drupal 7 并创建了一个自定义内容类型和一个显示这些内容类型的视图。我想要做的是在预告视图中覆盖指向节点的 url。我的具体用例是这样的：

我有一个显示支持内容类型的支持视图。当我查看该页面时，我会看到我创建的支持内容类型的预告片：安全、常见问题解答、票务。安全和常见问题解答按预期链接到他们的节点。我想要完成的是，在那里有用于票务的预告片和图像，但让它链接到我的外部票务门户。本质上，我希望在创建这种类型的内容时有一个复选框，允许我链接到外部 url。我确实安装了链接模块，但我无法将该字段应用于标题的 url。

我花了一段时间在谷歌上搜索试图找到答案，但没有多大成功。如果没有什么可以做的，我不介意构建一个模块并将其提交给社区。只是想确保我没有遗漏任何东西。

提前致谢。

**更新**

以下是我使用下面给出的答案所采取的步骤：

1.  安装链接模块：[http ://drupal.org/project/link](http://drupal.org/project/link)
2.  创建一个内容类型，添加一个字段`link`
3.  `link`添加该类型的新内容并在字段中添加要链接到的 url
4.  创建视图并按该内容类型过滤
5.  在格式下，我正在`format: "grid"`使用`show: "fields"`
6.  为您在列表中`Content: link`创建的**FIRST***字段添加一个字段。设置为`Exclude from display`和`Formatter: URL, as plain text`
7.  添加标题字段并取消选择“将此字段链接到原始内容”单击“重写结果”并选择“重写该字段的输出”。`<a href="[field_link_to]">[title]</a>`在文本字段中 输入`[field_link_to]`链接字段的名称，如其下方的“替换模式”下拉列表中所述。
    *   如果您的字段列表中没有 FIRST 链接字段，则令牌将无法用于其下方的字段。
    *   在您的内容类型 > 管理字段 > 链接（编辑）> 包装标记中，确保选择“无标记”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:14:38.133

您可以使用重写选项更改视图的显示。确保您的显示类型设置为“字段”。然后包括您要显示的字段；标题，预告片，图像。

在标题字段的字段配置中，选择“重写结果”。在那里您可以输入以下内容`<a href="example.com">[title]</a>`，这应该会否决标题。

还要确保取消选中“将字段链接到它的节点”。

更新：您可能必须为此创建第二个视图...以防止编辑其他两个元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T08:38:57.397

步骤 7 在 Drupal 7.22 中有所不同

1.  标题“重写结果”>选择“将此字段作为链接输出”>链接路径下的文本字段仅为“[field_link_to]”（没有`<a href=...>`...等）

# php - 网站上的奇怪错误（可能是 303 错误？）

> ID：12165742
> 
> 赞同：0
> 
> 时间：2012-08-28T19:00:59.457
> 
> 标签：php, google-chrome, safari, web

我在 PHP 中的网站有一个奇怪的问题，但是当我访问网站的基本 URL 时，它只会在 Chrome 和 Safari 中发生。

示例 1：当我在 Chrome 上写入网站地址时，`www.generaledil2000.it`我得到了一个白页，在控制台日志中我得到了`Failed to load resource`，但是如果我将完整地址写入索引页面`www.generaledil2000.it/index.php`，则网站显示正常，一切正常。

示例 2：在地址的 safari 中`www.generaledil2000.it`我收到此错误`cfurlerrordomain:303`并且地址`www.generaledil2000.it/index.php`没有错误。

在 IE 和 Firefox 中一切正常。

有什么问题？是主机问题？除了根文件夹中的 index.php 之外，我没有任何其他文件索引。

**更新：**也许这是一个 JavaScript 错误，但我不知道如何修复它。

PS：在本地主机上使用easyphp5.3.9工作没有任何错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T12:21:52.103

我已经通过使用`.htaccess`包含以下内容的文件解决了这个问题：

```
DirectoryIndex index.php 
```

# doctrine-orm - 获取 Doctrine 2 实体插入的 SQL

> ID：12165745
> 
> 赞同：6
> 
> 时间：2012-08-28T19:01:07.223
> 
> 标签：doctrine-orm

是否可以获得 Doctrine 2 实体插入的 SQL？

例如，假设我有这个：

```
$foo = new Foo();
$foo->setName('bar');
$em->persist($foo);
$em->flush(); 
```

有没有办法在那里获取 INSERT 语句的 SQL？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2017-04-22T14:03:36.067

你可以试试 SQL-Logger：

```
$em->flush(); // to write cached stuff down and isolate the following

// activate logger
$em->getConnection()
    ->getConfiguration()
    ->setSQLLogger(new \Doctrine\DBAL\Logging\EchoSQLLogger());

$foo = new Foo();
$foo->setName('bar');
$em->persist($foo);
$em->flush();

// disable logger
$em->getConnection()
    ->getConfiguration()
    ->setSQLLogger(null); 
```

它也适用于 MySQL 以外的其他 DBMS。还有其他写入文件的可能性。看这里：

[https://www.brunsware.de/blog/symfony/monolog-doctrine-logfile.html](https://www.brunsware.de/blog/symfony/monolog-doctrine-logfile.html)

[http://vvv.tobiassjosten.net/symfony/logging-doctrine-queries-in-symfony2/](http://vvv.tobiassjosten.net/symfony/logging-doctrine-queries-in-symfony2/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-28T19:06:03.537

您可以在您的 MySQL 服务器中激活查询日志（猜是它）：在 /etc/mysql/my.ini （通常的地方）：

```
[mysqld]
log=/tmp/mysql.log 
```

然后阅读此文件，您将在其中找到每个发出的查询。

# c++ - 如何将 C++ 插件安装到 Eclipse？

> ID：12165746
> 
> 赞同：10
> 
> 时间：2012-08-28T19:01:11.820
> 
> 标签：c++, eclipse, eclipse-plugin

我有 Eclipse Helios 并想使用它编写 C++ 代码，但我一直遇到“启动失败。找不到二进制文件”错误。

我使用“mingw-get-inst-20120426”文件安装了MingW C++ 编译器，并选择了“C compiler, C++ compiler, MSYS Basic System, and MingW Developer Toolkit”。

然后我转到 Eclipse > 项目 > 属性 > C/C++ General > Paths and Symbols，然后在 Includes 选项卡中选择 GNU C++ 并添加“C:\MinGW\lib\gcc\mingw32\4.6.2\include\c++ “ 小路。

我还去了 C/C++ build > Environment 并将“C:\MinGW\bin;C:\MinGW\msys\1.0\bin”附加到 PATH 中。

然后我创建了一个 Hello World C++ 项目，选择 Toolchains 下的 MingW GCC，然后使用“锤子”图标构建项目。

但是，一旦我运行 HelloWorld 程序，它就会出现“启动失败。找不到二进制文件”错误。

这是另一个错误：

```
g++ -IC:\MinGW\lib\gcc\mingw32\4.6.2\include\c++ -O0 -g3 -Wall -c - 
fmessage-length=0 -osrc\HelloWorld.o ..\src\HelloWorld.cpp
Internal Builder: Cannot run program "g++": The system cannot find the 
file specified. 
```

我还下载了 CDT（C/C++ 开发工具）并将“功能”和“插件”文件夹转移到 eclipse 文件夹中。

有人可以逐步告诉我如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-29T01:03:04.207

**首先**，在以下示例中，所有驱动器号都应替换为系统上的相关驱动器号。**并非所有**这些步骤都是**真正必要**的，但它确实有效（而且越多越好）。

我们从稍微简单的发布配置开始——我们想让它编译。

转到项目 - 属性

查看包含目录是否正确且到位。

![在此处输入图像描述](../Images/4a40f77f3c336b84334f95f9912c4517.png)

转到项目 -- 属性 -- 运行/调试设置 -- 新 -- 主选项卡

设置为 Release 并浏览到项目的 Release 文件夹。如果未设置 exe 文件，请输入其名称。

![属性 1](../Images/9a1fd031bfe40d4754f0bdee7359a7e1.png)

切换到常用选项卡。选中分配控制台并在后台启动。**不要跑。**

![属性 2](../Images/576e7066cb555926b9ddfece026dd7e7.png)

转到项目 -- 属性 -- C/C++ 构建 -- 发现选项

工具——GCC C++ 编译器

“浏览”到 mingw bin 文件夹并选择 g++.exe 或将 mingw32-g++.exe 复制到 g++.exe

**注意：**图片指向mingw32-g++.exe请使用**g++.exe**

![财产 3](../Images/e0f89e833bbb6c7196c2d0a649584a3b.png)

右键单击项目并查看--Build Configurations--Set Active--Release 被选中。

右键项目——运行方式——运行配置。

在 C/C++ Application 下选择，指的是发布版本。然后点击运行

如果可行，我将向您展示如何设置调试属性。（更复杂）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-10-17T13:20:20.300

如今（Eclipse Juno 和更新版本），它要简单得多。你只需要：

*   安装 MinGW（包括 C++ 编译器）
*   将路径“C:\minGW\bin”和“C:\minGW\msys\1.0\bin”（或安装 MinGW 的任何位置）添加到 Windows“路径”变量
*   安装 Eclipse。如果已经安装了 Eclise，请重新启动它。它将识别 MinGW 现在可用。
*   创建一个新项目：“C++ 项目”
*   对于以下对话框中的每个项目类型，您现在应该能够选择“MinGW GCC”工具链
*   快乐编码

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T19:25:38.703

见这里：[http ://www.youtube.com/watch?v=QhvXCg2CY4Q](http://www.youtube.com/watch?v=QhvXCg2CY4Q)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-22T02:23:50.103

g++ is installed as part of MinGW. If you are getting an error in Eclipse that it cannot find g++ then your path is most likely incorrect. From a command prompt you should be able to run:

`g++ --version`

and it should display the version of g++ in the MinGW/bin directory.

Eclipse uses this path to locate the include files and the compiler. Once you get the path correct restart Eclipse and the problems listed in your question should be resolved.

# browser - 可以配置 JVM 以使浏览器仅运行受信任的小程序吗？

> ID：12165749
> 
> 赞同：1
> 
> 时间：2012-08-28T19:01:18.503
> 
> 标签：browser, applet, jvm, signed

是否可以配置浏览器和 JVM 组合，以便仅运行签名的 Applet？目的是确保 Applet 在执行之前必须经过身份验证，即使它们只访问安全的 API。

# java - Java打印List和arraylist

> ID：12165751
> 
> 赞同：2
> 
> 时间：2012-08-28T19:01:19.923
> 
> 标签：java, arrays, list

我希望有人可以帮助我解决我在 java 中遇到的一个小问题。我有一个 List 和一个 ArrayList ，我想将它们输出到一个文件中，每个文件的第一个元素彼此相邻打印。这是我到目前为止所拥有的：

```
List<String> uniqueList = new ArrayList<String>(dupMap.values());
for(String unique:uniqueList){
   out.write(unique + "\r");
}
ArrayList<Integer>subtr=new ArrayList<Integer>();
out.write("The number: " + subtr + "\r"); 
```

这将导致以下输出：

```
A
B
C
D
E
F
The number: [1, 2, 3, 4, 5, 6] 
```

但我宁愿它是这样的：

```
A The number: 1
B The number: 2 
```

...ETC。

我不确定从哪里开始如何获得这样的输出格式。我尝试将两组值都放入数组中，但我最终让自己感到困惑......这就是我最终来到这里的方式。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T19:04:28.720

只需这样做：

```
String br = System.getProperty("line.separator");
for (int i = 0, n = Math.min(uniqueList.size(), subtr.size()); i < n; i++)
    out.write(uniqueList.get(i) + " The number: " + subtr.get(i) + br); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:24:32.043

有效的方法是维护一个`HashMap`with`uniqueList`作为键和`subtr`作为值。然后遍历地图。

```
Map<String,Integer> map = new HashMap<String,Integer>();

for (int i = 0; i < uniqueList.size(); i++){
    map.put(key, subtr.get(i));
}
for (Map.Entry<String, Integer> entry : map.entrySet()) {
    out.println(entry.getKey() + " The Number : " + entry.getValue());
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T19:04:03.330

```
List<String> uniqueList = new ArrayList<String>(dupMap.values());
ArrayList<Integer>subtr=new ArrayList<Integer>();

for (int i = 0; i < uniqueList.size(); i++){
   out.write(uniqueList.get(i) + "\r");
   out.write("The number: " + subtr.get(i) + "\n");
} 
```

**注意**：这假设两个列表具有相同数量的元素。如果不是，您将迭代到`Math.min(uniqueList.size(), subtr.size())`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T19:04:58.533

这应该这样做：

```
int maxLength = Math.min(uniqueList.size(), subtr.size());
for(int i = 0; i < maxLength; i++)
{
    out.print(uniqueList.get(i) + " The number: " + subtr.get(i) + "\r");
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-28T19:05:20.950

像这样的东西：

```
List<String> uniqueList = new ArrayList<String>(dupMap.values());
ArrayList<Integer> subtr = new ArrayList<Integer>();
int length = Math.min(uniqueList.size(), substr.size());
for (int i = 0; i < length; i++) {
   out.write(uniqueList.get(i) + " The number: " + substr.get(i) + "\r");
} 
```

# node.js - 获取玉模板中`include`的返回值

> ID：12165752
> 
> 赞同：0
> 
> 时间：2012-08-28T19:01:20.777
> 
> 标签：node.js, express, socket.io, pug

我基本上试图完成的是在通过套接字连接获取数据时重用玉部分/模板。非工作示例：

```
socket.on('company_created', function(company) {
  var html = include _company;
  $('#companies ul').append(html);
}); 
```

通常我必须创建一个新`li`内容并像这样设置内容（按预期工作）：

```
$('#companies ul').append($('<li>').text(company.name)); 
```

这对于一个简单的列表来说是可以的，但是如果我有更复杂的列表和东西，这可能会很快变得混乱，而且我不得不再次编写纯 HTML，所以我想重新使用我已经存在的翡翠模板以及它们的所有优点太棒了，但还没有运气。

有什么线索吗？

PS：请不要告诉我使用 Ember、Backbone、Derby、Meteor、Angular 或任何其他工具。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:01:01.420

您可以使用`jade.compile`. 然后在客户端 javascript 中包含这些源，包括翡翠`runtime.min.js`，并在您的客户端代码中参考您的翡翠模板作为正常的 JS 函数。

例如，

**服务器.js**

```
app.get('/templates/:template.js', function (req, res) {
    var template = req.params.template;
    response.end([
        "window.templates = window.templates || {};",
        "window.templates[\"" + template + "\"] = " + jade.compile(template + ".jade", { client: true; });
    ].join("\r\n"));
}); 
```

**客户端.js**

```
$(function() { $("#placeholder").html(window.templates["content"]({user: "Daniel" })); }); 
```

**内容.jade**

```
h1: Hello #{user}! 
```

**索引.jade**

```
!!!
html
    head
        script(src='/lib/jquery/jquery.js')
        script(src='/lib/jade/runtime.min.js')
        script(src='/templates/content.js')
        script(src='/scripts/client.js')
    body
        #placeholder 
```

请注意，上面的代码可能在语法上不正确，仅用于说明该想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T15:22:53.910

我们有一个构建步骤，可以将它们编译成类似于 penartur 提到的函数。我不使用扩展或包含（无论如何都不适用于客户端 ATM），但我个人发现我们完全不需要在客户端上使用它，因为 DOM 提供了我们需要的所有分离。

# wpf - MVVM 中带有 Treeview 的 HierarchicalDataTemplate

> ID：12165754
> 
> 赞同：2
> 
> 时间：2012-08-28T19:01:36.537
> 
> 标签：wpf, xaml, binding, treeview, hierarchicaldatatemplate

我对 MVVM 和 WPF 比较陌生。我正在尝试用一个目录和它的文件/子目录填充 TreeView 控件（实际上是我解压缩的 zip 文件的内容）

在这个 SO [question](https://stackoverflow.com/questions/6415037/populate-treeview-from-list-of-file-paths-in-wpf)之后，我有以下课程：

```
namespace IFR_Full.Model
{
    public class Item
    {
        public string Name { get; set; }
        public string Path { get; set; }
    }

    public class FileItem : Item
    {
    }

    public class DirectoryItem : Item
    {
        public List<Item> Items { get; set; }

        public DirectoryItem()
        {
            Items = new List<Item>();
        }
    }

    public class TVItemProvider
    {
        public List<Item> GetItems(string path)
        {
            var items = new List<Item>();
            var dirInfo = new DirectoryInfo(path);

            foreach (var directory in dirInfo.GetDirectories())
            {
                var item = new DirectoryItem
                    {
                        Name = directory.Name,
                        Path = directory.FullName,
                        Items = GetItems(directory.FullName)
                    };
                items.Add(item);
            }

            foreach (var file in dirInfo.GetFiles())
            {
                var item = new FileItem
                {
                    Name = file.Name,
                    Path = file.FullName
                };
                items.Add(item);
            }
            return items;
        }
    }
} 
```

在我的 ViewModel 类中，我有以下属性：

```
TVItemProvider TVIP = new TVItemProvider();

private List<Item> _tvitems;
public List<Item> TVItems
{
    get { return _tvitems; }
} 
```

这是在此方法中创建的：

```
private void LoadIDMLTreeView(string path)
{
    _tvitems = TVIP.GetItems(path);
} 
```

我像这样设置 MainWindow 的标题和 DataContext：

```
...
xmlns:ViewModel="clr-namespace:IFR_Full"
xmlns:Model ="clr-namespace:IFR_Full.Model"
...

<Window.DataContext>
    <ViewModel:ExcelImportViewModel/>
</Window.DataContext> 
```

并像这样设置我的treeview xaml代码：

```
<TreeView ItemsSource="{Binding}" Name="IDMLView" Margin="10,171.74,10,8" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch">
    <TreeView.Resources>
        <HierarchicalDataTemplate DataType="{x:Type Model:DirectoryItem}" ItemsSource="{Binding Path=TVItems}">
            <TextBlock Text="{Binding Path=Name}" ToolTip="{Binding Path=Path}" />                  
        </HierarchicalDataTemplate> 
        <DataTemplate DataType="{x:Type Model:FileItem}">
     <TextBlock Text="{Binding Path=Name}" ToolTip="{Binding Path=Path}" />
    </DataTemplate>             
 </TreeView.Resources>
</TreeView> 
```

当我在调试模式下运行程序时，我可以看到 TVItems 包含适当的项目（目录和文件），但我的 TreeView 控件是空白的。

我想问题出在绑定上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:27:11.533

*   更改`<TreeView ItemsSource="{Binding}" ...`为`<TreeView ItemsSource="{Binding TVItems}" ...`

*   另外，更改为`<HierarchicalDataTemplate DataType="{x:Type local:DirectoryItem}" ItemsSource="{Binding Items}" >`

*   你的班级必须是这样的：

    ```
     public class TVItemProvider
        {

            List<object> items = new List<object>();
              DirectoryInfo dirInfo;
              public List<object> GetItems(string path)
            {
                dirInfo = new DirectoryInfo(path);
                foreach (var directory in dirInfo.GetDirectories())
                {
                    var item = new DirectoryItem
                    {
                        Name = directory.Name,
                        Path = directory.FullName,
                        Items = new TVItemProvider().GetItems(directory.FullName)
                    };
                    items.Add(item);
                }

                foreach (var file in dirInfo.GetFiles())
                {
                    var item = new FileItem
                    {
                        Name = file.Name,
                        Path = file.FullName
                    };

                    items.Add(item);
                }
                return items;
            } 
    ```

    }

*   最后将列表的类型更改为`List<object>`（全部）
    希望它会有所帮助

# mysql - 如何将分片 + 复制应用于 MySQL 关系数据库

> ID：12165758
> 
> 赞同：0
> 
> 时间：2012-08-28T19:01:47.970
> 
> 标签：mysql, sharding

我想知道，可以应用于 MySQL 或任何其他关系数据库的分片和复制的不同技术是什么？

是否有任何我应该注意的准则/规则？

基本上，我想创建一个支持分片和复制的自定义 MySQl（或其他关系数据库）。我看到的大多数网站都解释了一些处理分片/复制的技术或服务——我想理解这些概念并将它们自己应用到常规的 MySQL 数据库中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T20:52:02.707

没有为 MySQL “开箱即用”提供分片。

[规模基地](http://www.scalebase.com)（免责声明：我在那里工作）是一个完整的横向扩展解决方案的制造商，如果你愿意的话，它是一个“自动分片机”。应用程序或任何其他客户端工具（mysql、mysqldump、PHPMyAdmin...）连接到 ScaleBase 控制器，它看起来和感觉都像 MySQL，代理到“分片”网格，自动化命令路由和并行化跨数据库查询，以及合并结果 - 你不会觉得有任何区别......就像来自 1 DB 的结果一样。支持 ORDER、GROUP、LIMIT、agg 函数！根据命令和参数，路由和并行化在“控制器”内部完成。从我们客户的经验来看，我们不仅通过并行查询获得了巨大的性能改进，我们还改进了维护，考虑创建索引，向表中添加一列 - 这些也是并行化的并且运行得更快。所有这些都没有或几乎没有对代码进行任何更改。

另外 - 我邀请您查看我关于该主题的博客：http: [//database-scalability.blogspot.com/](http://database-scalability.blogspot.com/)。

PS - 我忘了提到，ScaleBase 还通过管理自动故障转移和复制数据库上的读/写拆分的前端来完成复制解决方案。

希望我有所帮助

# javascript - 禁用javascript时的onServerClick

> ID：12165760
> 
> 赞同：4
> 
> 时间：2012-08-28T19:01:56.210
> 
> 标签：javascript, html, button, server-side

我正在尝试获取一个 html 按钮来调用这样的服务器端方法：

```
<button onserverclick="onClick" runat="server">Submit</button> 
```

但是，当浏览器的 javascript 被禁用时，不会进行此调用。

我很困惑，因为我的理解是这个调用与 javascript 没有交互。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T19:16:02.933

The `__doPostBack()` method is responsible for raising a click event to the server in the background. With JavaScript disabled there's no way that's going to happen.

Here's one of the many articles that explains [how this works](http://www.evagoras.com/2011/02/10/how-postback-works-in-asp-net/). And a [related question here](https://stackoverflow.com/questions/1245033/asp-net-onserverclick-event-handler-not-called-if-using-onclick) which gives a glimpse into what code is generated behind the scenes.

# ios - 在 iOS 中打开包含视频和照片的图库

> ID：12165761
> 
> 赞同：0
> 
> 时间：2012-08-28T19:01:58.853
> 
> 标签：ios, xcode, uiimagepickercontroller

我正在使用 UIImagePickerViewController，我想打开相机胶卷。但是，在我的应用程序中，我有一个按钮可以打开我的相机胶卷，还有一个按钮可以打开我的相机。当我拍照或录制视频时，显然我想在我的相机胶卷中看到这些图像。但是，在我的应用程序中，当我开始录制视频时，他并没有出现在我的相机胶卷应用程序中。

这里有一点代码：

```
UIImagePickerController *cameraRoll = [[UIImagePickerController alloc] init];

[cameraRoll setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];

[cameraRoll setDelegate:self];
[self presentModalViewController:cameraRoll animated:YES]; 
```

目前，我无法在我的相机胶卷应用中看到我的视频。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T08:38:48.747

你可以这样做：

```
if([UIImagePickerController isSourceTypeAvailable:
                        UIImagePickerControllerSourceTypePhotoLibrary]) {

     UIImagePickerController *picker= [[UIImagePickerController alloc] init];
     picker.delegate = self;
     picker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
     picker.mediaTypes = [NSArray arrayWithObjects:(NSString *)kUTTypeMovie, (NSString *)kUTTypeImage, nil];

     [self presentModalViewController:picker animated:YES];
} 
```

在 PickerViewControllerObject "mediaTypes" 的属性上设置你想要获取的文件类型，你就准备好了。

您可以在[此处找到文档类型](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html#//apple_ref/occ/instp/UIImagePickerController/mediaTypes)。

问候，路易斯

# asp.net - 回发时错误消息被覆盖

> ID：12165764
> 
> 赞同：0
> 
> 时间：2012-08-28T19:02:09.567
> 
> 标签：asp.net, file-upload

当我将文件上传到我的服务器时，我有代码隐藏检查几种非法情况，然后我设置 asp:label 的文本以在发生错误时显示错误。

问题是即使 if 语句失败并且错误被写入标签，文件上传也会返回，从而将页面重置为其原始状态并重置消息标签。

***编辑和更新*** 在接受回发将发生后，我将错误消息加载到会话变量中，并在回发时检查了该变量是否存在错误并更新了 asp:list 以显示错误消息。

更新 asp:label 的行必须放入 PreRender 事件中，因为 Load 事件发生在回发处理之前。导致页面必须回发两次才能显示消息。

你希望这对任何人都有帮助。此外，如下所述，阅读[ASP 页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472.aspx)会产生奇迹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T20:43:21.770

我建议查看有关[Validating ASP.NET Server Controls](http://msdn.microsoft.com/en-us/library/aa479013.aspx "验证 ASP.NET 服务器控件")的非常全面的 MSDN 文章。基本上，您将向前端添加以下内容： `asp:ValidationSummary`，并`asp:CustomValidator`使用处理“非法检查”的后端代码，然后将页面设置`IsValid`为`true`或`false`，具体取决于代码隐藏中客户验证功能的结果。

此处的 SO 示例：[如何将错误消息添加到验证摘要](https://stackoverflow.com/questions/777889/on-postback-how-can-i-add-a-error-message-to-validation-summary "如何将错误消息添加到验证摘要")

# mysql - MySQL 存储过程语法问题 (Eclipse SQL Explorer)

> ID：12165779
> 
> 赞同：-1
> 
> 时间：2012-08-28T19:02:48.800
> 
> 标签：mysql, eclipse, stored-procedures, mysql-error-1064

各位晚安，

我在为 MySql 编写存储过程时遇到了麻烦，我已经阅读了一些教程，因为我更习惯于为 Sybase 编写存储过程。

这个过程在第 8 行附近有些地方不对劲。我尝试过更改大量有关它的内容并将其简化，但我仍然无法使其正常工作。

我正在通过 Eclipse SQL Explorer 插件运行此代码。

开始怀疑它是否在服务器端进行了一些设置。

谁能看到这不起作用的原因？

```
 DROP PROCEDURE IF EXISTS myDB.myProc;
     GO
     CREATE PROCEDURE myProc(
        IN p1 INT,
        IN p2 INT,
        IN p3 INT,
        IN p4 INT,
        IN p5 TEXT)
     BEGIN
        DECLARE dateToday DATETIME;
        SELECT dateToday = GETDATE();

        INSERT INTO myTable(id_p1, 
                            id_p2, 
                            id_p3, 
                            id_p4,
                            id_p5,
                            id_p6)
                    VALUES(p1,
                            p2,
                            p3,
                            p4,
                            p5,
                            dateToday);    
     END 
```

任何帮助，将不胜感激 ：）

干杯，

戴夫·麦克布

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:51:29.977

我不确定 MySQL sintax，但变量不应该是这样的吗？：

```
DECLARE @dateToday DATETIME;
Set @dateToday = NOW(); 
```

另外，我认为`Getdate()`是 for `MSSQL`，您应该使用`NOW()`in`MySQL`

# javascript - Javascript值更改

> ID：12165788
> 
> 赞同：0
> 
> 时间：2012-08-28T19:03:09.487
> 
> 标签：javascript

```
if(isset($_POST['album_title'])) {
$album_title = $_POST['album_title'];
if($_FILES['pic_nr1']['type'] == 'image/jpeg' ||
    $_FILES['pic_nr1']['type'] == 'image/jpg' ||
    $_FILES['pic_nr1']['type'] == 'image/png' ||
    $_FILES['pic_nr1']['type'] == 'image/gif' &

    $_FILES['pic_nr2']['type'] == 'image/jpeg' ||
    $_FILES['pic_nr2']['type'] == 'image/jpg' ||
    $_FILES['pic_nr2']['type'] == 'image/png' ||
    $_FILES['pic_nr2']['type'] == 'image/gif' &

    $_FILES['pic_nr3']['type'] == 'image/jpeg' ||
    $_FILES['pic_nr3']['type'] == 'image/jpg' ||
    $_FILES['pic_nr3']['type'] == 'image/png' ||
    $_FILES['pic_nr3']['type'] == 'image/gif'
    ) {

    } else {
?>
<script type="text/javascript">
    document.getElementById("error_for_js").innerHTML = "Bilžu formāts nav derīgs!    <small> GIF, JPEG, JPG, PNG ir autļauti.</small>";
</script>
<?php

    }

}
?>

<form enctype="multipart/form-data" method='post' action='' onsubmit='if(document.getElementById("titleeee").value.length < 3 ) { document.getElementById("error_for_js").innerHTML = "Albūma nosaukumam ir jābūt garākam!"; return false; } else { return true; }'  >
     <p id='error_for_js'></p>
    Albūma nosaukums: <input id='titleeee' type='text' name='album_title' /><br />

    Bilde Nr 1: <input type='file' name='pic_nr1' /><br />
    Bilde Nr 2: <input type='file' name='pic_nr2' /><br />
    Bilde Nr 3: <input type='file' name='pic_nr2' /><br />

    Aktīvs*: <select>
                <option>Jā</option>
                <option>Nē</option>
            </select><br />
    <input  type='submit' value='Pievienot' />
</form> 
```

我不明白为什么`id='error_for_js'`文件格式错误时不要改变的值，我做了`getElementById('error_for_js').innerHTML = 'new value'`；但它没有改变！？想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:11:14.773

将您的 getElementById 包装为：

```
window.onload = function() {
   document.getElementById("error_for_js").innerHTML = "Hello!";
}; 
```

或在 HTML 元素之后添加脚本。

# python - 无法调用 Biopython SeqUtils Six_frame_translations

> ID：12165791
> 
> 赞同：0
> 
> 时间：2012-08-28T19:03:16.193
> 
> 标签：python, global, biopython

执行以下代码时：

```
from Bio.SeqUtils import six_frame_translations

blah = six_frame_translations("ATCGATCGATCG")
print(blah) 
```

我收到以下错误：

```
File "C:\Python32\lib\site-packages\Bio\SeqUtils\__init__.py", line 263, in six_frame_translations
    frames[-(i+1)] = reverse(translate(anti[i:], genetic_code))
NameError: global name 'reverse' is not defined 
```

我正在使用 Python 3.23、Biopython 1.59

有什么建议么？谢谢，

查尔斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T09:59:05.870

It's a bug. Prior to August 11, 2011, the `SeqUtils` module had a function `reverse`. It was deprecated in version 1.54, and [removed in 1.58](https://github.com/biopython/biopython/commit/31783119799a6f73ab8adc75d601862d3729bac7).

From the file [`DEPRECATED`](https://github.com/biopython/biopython/blob/31783119799a6f73ab8adc75d601862d3729bac7/DEPRECATED):

> Function 'reverse' in Bio.SeqUtils was deprecated in Release 1.54, and removed in Release 1.58\. Instead just use the string's slice method with a step of minus one.

So, it looks they just failed to make this conversion in `six_frame_translations()`. You can submit a bug report to the [OBF Redmine](https://redmine.open-bio.org/projects/biopython) site, or patch it yourself and submit a pull request to the [Biopython repository](http://github.com/biopython/biopython) on GitHub.

If you're feeling especially generous, you might consider writing a unit test to automatically detect failures of this function- it'll help future users like yourself. =)

# c - OCIStmtPrepare 总是返回 OCI_INVALID_HANDLE

> ID：12165792
> 
> 赞同：0
> 
> 时间：2012-08-28T19:03:19.707
> 
> 标签：c, oracle, oracle11g

当试图在 Oracle RDBMS 上执行语句时，我总是得到`OCI_INVALID_HANDLE`状态（用 gdb 检查），因此该语句没有被执行。

可能有人可以帮助完成这项工作：

```
OCIEnv* envh;
OCISvcCtx* svch;
OCIError* errh;
sword stat;
stat = OCIExtProcGetEnv (context, &envh, &svch, &errh);
OCIStmt* stmthp;

char errbuf[512];
sb4 errcode = 0;

char * cmd = "alter session set NLS_DATE_FORMAT='dd/mm/yyyy hh24:mi:ss'";

sword status = OCIStmtPrepare(stmthp, errh, (const OraText*)cmd, (ub4) strlen(cmd), (ub4) OCI_NTV_SYNTAX, (ub4) OCI_DEFAULT);

if ( status != OCI_SUCCESS )
{
    OCIErrorGet((void*)errh, (ub4) 1, (text *) NULL, &errcode,
            (text*)errbuf, (ub4) sizeof(errbuf), OCI_HTYPE_ERROR);
    OCIExtProcRaiseExcpWithMsg((OCIExtProcContext*)context, errcode, (text*)errbuf, sizeof(errbuf));    
} 
```

`context`是`OCIExProcContext*`从 PL/SQL 传递到此外部过程的

一个没有问题的简单`OCIExtProcRaiseExcpWithMsg((OCIExtProcContext*)context, 34, (text*)"custom", 6);`工作。此外，我用 gdb 检查了所有其他指针，它们看起来相当不错。我可以错过一些初始化吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T21:25:06.063

您忘记分配语句句柄。`stmthp`您传入的变量`OCIStmtPrepare`未初始化：

```
sword status = OCIHandleAlloc((dvoid *)envh, 
                 (dvoid **) &stmthp,
                 (ub4) OCI_HTYPE_STMT,  
                 (size_t) 0, 
                 (dvoid **) 0)); 
```

# performance - 数组中的随机整数。找到连续子集的最大和

> ID：12165795
> 
> 赞同：7
> 
> 时间：2012-08-28T19:03:28.610
> 
> 标签：performance, algorithm, language-agnostic, big-o

前段时间我有一个面试问题，我从来没有得到解决方案。显然有一个“非常有效”的算法来解决它。

问题：给定一个随机正负数数组，找到总和最大的连续子集。

例子：

`[1, -7, 4, 5, -1, 5]`

这里最好的子集是`{4, 5, -1, 5}`

除了蛮力方法，我想不出任何解决方案。什么是有效的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T05:54:12.973

遍历列表，跟踪到目前为止列表元素的本地总和。
如果本地总和是迄今为止最高的总和，则记录下来。
如果本地总和达到 0 或以下，则将其重置并从下一个元素重新开始。

### 理论

如果当前子集总和大于零，它将有助于未来的子集总和，所以我们保留它。另一方面，如果当前子集总和为零或低于零，它将不会对未来的子集总和有所贡献。所以我们把它扔掉，重新开始一个新的子集总和。然后只需跟踪当前子集总和何时大于以前遇到的任何时间。

### 伪代码

`list`参数内是一个长度数组`N`。结果存储在`best_start`和中`best_end`。

```
best_sum = -MAX
best_start = best_end = -1
local_start = local_sum = 0

for i from 0 to N-1 {

    local_sum = local_sum + list[i]

    if local_sum > best_sum {
        best_sum = local_sum
        best_start = local_start
        best_end = i
    }

    if local_sum <= 0 {
        local_sum = 0
        local_start = i+1
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T19:13:05.237

将列表转换为累积和列表，`[1,-7,4,5,-1,5] to [1, -6, -2, -3, 2]`。然后遍历累积和列表，保存迄今为止的最小值以及您看到的当前值与当前最小值之间的最大差值。从[这里得到](http://www.daniweb.com/software-development/c/threads/49177/to-find-the-maximum-subset-sum-in-an-array#)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T19:38:22.070

You can answer this question from [CLRS](https://rads.stackoverflow.com/amzn/click/com/0262033844), which includes a tip:

Use the following ideas to develop a nonrecursive, linear-time algorithm for the maximum-subarray problem.

Start at the left end of the array, and progress toward the right, keeping track of the maximum subarray seen so far.

Knowing a maximum sub array of `A[1..j]`, extend the answer to find a maximum subarray ending at index `j+1` by using the following observation:

a maximum sub array of `A[1..j+1]` is either a maximum sub array of `A[1..j]` or a sub array `A[i..j+1]`, for some `1 <= i <= j + 1`.

Determine a maximum sub array of the form `A[i..j+1]` in constant time based on knowing a maximum subarray ending at index `j`.

```
max-sum = A[1]
current-sum = A[1]
left = right = 1
current-left = current-right = 1
for j = 2 to n
    if A[j] > current-sum + A[j]
        current-sum = A[j]
        current-left = current-right = j
    else
        current-sum += A[j]
        current-right = j
    if current-sum > max-sum
        max-sum = current-sum
        left = current-left
        right = current-right
return (max-sum, left, right) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-30T13:04:22.170

这是以线性时间运行的java类

```
public class MaxSumOfContinousSubset {

    public static void main(String[] args) {
        System.out.println(maxSum(1, -7, 4, 5, -1, 5));
    }

    private static int maxSum (int... nums) {
        int maxsofar = 0;
        int maxhere = 0;
        for (int i = 0; i < nums.length; i++) {
            maxhere =  Math.max(maxhere + nums[i], 0);
            maxsofar = Math.max(maxhere, maxsofar);
        }
        return maxsofar;
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-29T11:44:10.133

太糟糕了 Java 没有元组返回类型。因此，必须在方法中打印索引和总和。

```
public class Kadane {

    public static void main(String[] args) {
        int[] intArr = {-1, 3, -5, 4, 6, -1, 2, -7, 13, -3};
        findMaxSubArray(intArr);
    }

    public static void findMaxSubArray(int[] inputArray){

        int maxStartIndex=0;
        int maxEndIndex=0;
        int maxSum = Integer.MIN_VALUE; 

        int sum= 0;

        for (int currentIndex = 0; currentIndex < inputArray.length; currentIndex++) {
            int eachArrayItem = inputArray[currentIndex];

            sum+=eachArrayItem;

            if( eachArrayItem > sum){
                maxStartIndex = currentIndex;    
                sum = eachArrayItem;      
            }
            if(sum>maxSum){
                maxSum = sum;
                maxEndIndex = currentIndex;
            }
        }

        System.out.println("Max sum         : "+maxSum);
        System.out.println("Max start index : "+maxStartIndex);
        System.out.println("Max end index   : "+maxEndIndex);
    }
} 
```

这是一些无耻的营销：我设法拼凑了[一张幻灯片](https://speakerdeck.com/u/arunodhaya80/p/kadanes-maximum-subarray-problem-algorithm)，说明这是如何工作的

# mysql - 在不泄露密码的情况下授予对 mysql DB 的远程访问权限

> ID：12165797
> 
> 赞同：0
> 
> 时间：2012-08-28T19:03:34.730
> 
> 标签：mysql, remote-access

我想让一个远程站点（拥有我的其他人）访问我的服务器上受密码保护的 mysql 数据库，但我不想向他们透露实际密码。

是否可以在我的服务器上拥有 mysql 访问文件（带有用户名和 pswd），并且他们只是通过它进行连接，以便他们的站点可以访问我的 MYSQL 数据库中的数据，但我实际上并没有公开向他们透露 pswd。

也可以在只读基础上提供此类访问权限。我只是想让他们可以查询数据库，而不是下载整个数据库或对其进行更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:05:47.440

远程方将需要凭据才能对您的 MySQL 数据库执行任何操作。即使您要打开某种文件共享以让他们访问物理文件，这仍然不会让他们对文件做任何事情（并且将实际文件暴露在数据库之外*并不是*一个好主意服务器）。

为他们设置一个单独的用户帐户，为他们提供所需*的*权限。

您可以限制允许访问的 MySQL 数据库，以及它们在每个单独的数据库中可以做什么。

[https://dev.mysql.com/doc/refman/5.5/en/adding-users.html](https://dev.mysql.com/doc/refman/5.5/en/adding-users.html)

# mysql - $array 中的 SQL 保留字导致错误

> ID：12165802
> 
> 赞同：0
> 
> 时间：2012-08-28T19:03:43.290
> 
> 标签：mysql, sql, syntax-error

当我尝试插入一个包含保留字的数组时遇到问题。

我可能会说真的很奇怪，看看：

```
$sql="INSERT INTO sites (cat_id, cat_title, cat_parent, title, image, site_name, description) VALUES ('$_POST[cat_id]','$_POST[cat_title]','$_POST[cat_parent]','$title','$image','$site_name','$description')"; 
```

该数组来自我创建的opengraph fetch，但这并不重要，问题是有时当数组$title或$image上有一个保留字如“use”时，sql会返回错误“错误：您的 SQL 语法有错误；请查看相应的手册……”

就是这样：

当数组 $title = [http://techcrunch.com/2012/08/28/flipboard-hits-20-million-users-3-billion-flips-per-month/](http://techcrunch.com/2012/08/28/flipboard-hits-20-million-users-3-billion-flips-per-month/) <---- 它不起作用我收到上面的错误。

当数组为 $title = [http://techcrunch.com/2012/08/27/google-nexus-7-is-now-available-in-france-germany-and-spain/](http://techcrunch.com/2012/08/27/google-nexus-7-is-now-available-in-france-germany-and-spain/) <---- 它有效美好的！

所以我认为这可能是因为数组 $title 有时（或我正在使用的任何其他数组）中有一个“保留字”会返回错误......所以有任何方法可以保护我的数组免受这个错误的影响?

谢谢！:)

* * *

编辑：

解决方案

行！我遵循了@dystroy 和@tadman 的建议，并使用了 PDO 而不是常规的 mysql 连接......我不知道我是否完全可以防止 SQL 注入或攻击，但它用保留字解决了我的问题。现在我可以将 $array 中的任何内容插入到数据库中。

如果有人在这里遇到同样的问题，这就是我所做的（如果你们发现任何尴尬，请抱怨）：

```
$dbh = new PDO("mysql:host=MYHOST;dbname=MYDATABASE", "USER", "PASS");

$query = "INSERT INTO sites (cat_id, cat_title, cat_parent, title, image, site_name, description) VALUES (:cat_idpost, :cat_titlepost, :cat_parentpost, :titlepost, :imagepost, :site_namepost, :descriptionpost)";

$stmt = $dbh->prepare($query);

$stmt->bindParam(':cat_idpost', $cat_id);
$stmt->bindParam(':cat_titlepost', $cat_title);
$stmt->bindParam(':cat_parentpost', $cat_parent);
$stmt->bindParam(':titlepost', $titlepost);
$stmt->bindParam(':imagepost', $imagepost);
$stmt->bindParam(':site_namepost', $site_namepost);
$stmt->bindParam(':descriptionpost', $descriptionpost);

$cat_id = $_POST['cat_id'];
$cat_title = $_POST['cat_title'];
$cat_parent = $_POST['cat_parent'];
$titlepost = $title;
$imagepost = $image;
$site_namepost = $site_name;
$descriptionpost = $description;
$stmt->execute(); 
```

谢谢你们！:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:07:21.343

始终使用准备好的语句在数据库中插入字符串。永远不要简单地连接它们。

问题不仅在于保留词，还在于由于特殊值或字符引起的各种错误（或攻击）。不要试图自己逃避这一切：如果您使用准备好的语句，数据库将为您处理。

查看基于今天推荐的 PHP/MySQL ( [PDO](http://php.net/manual/en/book.pdo.php) ) 库的示例：[http ://www.php.net/manual/en/pdo.prepared-statements.php](http://www.php.net/manual/en/pdo.prepared-statements.php)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-28T19:10:35.397

转义保留字，如带重音的标题

# ruby - 此 gnuplot 代码的正确 Ruby gnuplot (rgplot) 语法是什么？

> ID：12165803
> 
> 赞同：3
> 
> 时间：2012-08-28T19:03:52.573
> 
> 标签：ruby, gnuplot

这是来自 shell 脚本（来自 Hannon Lab）的 gnuplot 命令，我想使用 rgplot gem 将绘图部分移植到 Ruby，但我未能正确使用语法。

```
set boxwidth 0.75 absolute
set size 1,1
set style fill solid 1.00 border -1
set xlabel \"read position\"
set title \"Nucleotides distribution $TITLE\" 
set ylabel \"% of total (per read position)\" 
set key outside right top vertical Left reverse enhanced autotitles columnhead nobox
set key invert samplen 4 spacing 1 width 0 height 0 
set style histogram rowstacked 
set style data histograms 
set noytics
set xtics 1
set yrange [ 0.00000 : 100.000 ] noreverse nowriteback

plot '$FILENAME' using (100.*column(13)/column(18)):xtic(1) title \"A\" lt rgb \"#5050ff\", \
       '' using (100.*column(14)/column(18)) title \"C\" lt rgb \"#e00000\", \
       '' using (100.*column(15)/column(18)) title \"G\" lt rgb \"#00c000\", \
       '' using (100.*column(16)/column(18)) title \"T\" lt rgb \"#e6e600\", \
       '' using (100.*column(17)/column(18)) title \"N\" lt rgb \"pink\"
" 
```

到目前为止，我有这个：

```
Gnuplot.open do |gp|
  Gnuplot::Plot.new(gp) do |plot|
    plot.terminal options[:terminal]
    plot.title    options[:title]
    plot.xlabel   options[:xlabel]
    plot.ylabel   options[:ylabel]
    plot.output   options[:data_out] if options[:data_out]
    plot.boxwidth "0.75 absolute"
    plot.size     "1,1"
    plot.yrange   "[0:100]"
    plot.noytics
    plot.xtics    1
    plot.key      "outside right top vertical Left reverse enhanced autotitles columnhead nobox"
    plot.key      "invert samplen 4 spacing 1 width 0 height 0"
    plot.style    "fill solid 1.00 border -1"
    plot.style    "histogram rowstacked"
    plot.style    "data histograms"

    plot.data << Gnuplot::DataSet.new([x, a]) do |ds|
      ds.title = "A"
    end
  end
end 
```

但我需要帮助才能正确...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T08:38:56.947

我终于搞定了：

```
Gnuplot.open do |gp|
  Gnuplot::Plot.new(gp) do |plot|
    plot.terminal options[:terminal]
    plot.title    options[:title]
    plot.xlabel   options[:xlabel]
    plot.ylabel   options[:ylabel]
    plot.output   options[:data_out] if options[:data_out]
    plot.ytics    "out"
    plot.xtics    "out"
    plot.yrange   "[0:100]"
    plot.xrange   "[0:#{max_len}]"
    plot.auto     "fix"
    plot.offsets  "1"
    plot.key      "outside right top vertical Left reverse enhanced autotitles columnhead nobox"
    plot.key      "invert samplen 4 spacing 1 width 0 height 0"
    plot.style    "fill solid 0.5 border"
    plot.style    "histogram rowstacked"
    plot.style    "data histograms"
    plot.boxwidth "0.75 absolute"

    plot.data << Gnuplot::DataSet.new(n) do |ds|
      ds.using = "1"
      ds.with  = "histogram lt rgb \"black\""
      ds.title = "N"
    end

    plot.data << Gnuplot::DataSet.new(g) do |ds|
      ds.using = "1"
      ds.with  = "histogram lt rgb \"yellow\""
      ds.title = "G"
    end

    plot.data << Gnuplot::DataSet.new(c) do |ds|
      ds.using = "1"
      ds.with  = "histogram lt rgb \"blue\""
      ds.title = "C"
    end

    plot.data << Gnuplot::DataSet.new(t) do |ds|
      ds.using = "1"
      ds.with  = "histogram lt rgb \"green\""
      ds.title = "T"
    end

    plot.data << Gnuplot::DataSet.new(a) do |ds|
      ds.using = "1"
      ds.with  = "histogram lt rgb \"red\""
      ds.title = "A"
    end
  end
end 
```

# c# - 使用 Table Per Hierarchy 继承在 LINQ to Entities 查询中转换为派生类型

> ID：12165805
> 
> 赞同：24
> 
> 时间：2012-08-28T19:03:58.407
> 
> 标签：c#, .net, linq, entity-framework, linq-to-entities

我有一个具有按层次结构表继承的 LINQ to 实体模型。我对基本类型有一个查询，我想做特定的类型相关逻辑。例如：

```
IQueryable<BaseType> base = ...

// this works fine
var result = base.Select(b => b is DerivedType1 ? 1 : 2).ToList();

// this doesn't compile to SQL
var result2 = base.Select(b => b is DerivedType1 ? ((DerivedType1)b).DerivedProperty : null).ToList(); 
```

有没有办法在不分别处理每个派生类型的 IQueryables 的情况下做这样的事情：

```
// I'd rather not do this:
var resultA = base.OfType<DerivedType1>().Select(d => d.DerivedProperty);
var resultB = base.OfType<DerivedType2>().Select(d => default(int?));
var result = resultA.Concat(resultB).ToList(); 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-18T16:49:47.947

`(DerivedType1)b`LINQ-to-Entities 不支持直接转换为实体类型，但`as`运算符 ( `b as DerivedType1`) 支持，因此您可以尝试：

```
var result2 = base
    .Select(b => b is DerivedType1
        ? (b as DerivedType1).DerivedProperty
        : null)
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T13:49:24.220

```
OfType<DerivedType1>() 
```

将返回一个 IEnumerable，如果可能，尝试将基本类型更改为 IEnumerable 而不是 IQueryable，使用 IQueryable 时可能会遇到一些 SQL 限制。

那当然是如果您实际上不是在查询数据库？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-23T19:15:42.467

您可以使用 EntityFramework.Extended 来提高查询的性能，而不是对 DB 进行 2 次往返。

```
var resultA = base.OfType<DerivedType1>().Select(d => d.DerivedProperty).Future();
var resultB = base.OfType<DerivedType2>().Select(d => default(int?)).Future();
var result = resultA.Concat(resultB).ToList(); 
```

在这种情况下，只执行一次到 bd 的往返行程。这个框架对 int EF 的许多其他事情非常有用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T11:55:32.983

您可以在派生类型中覆盖基类型上的方法，以提供相关的属性值。

```
public class MyBaseClass
{
    public virtual int GetSomething()
    {
        throw new NotImplementedException();
    }
}

public class MyDerivedClass1 : MyBaseClass
{
    public int SomeProperty { get; set; }

    public override int GetSomething()
    {
        return this.SomeProperty;
    }
}

public class MyDerivedClass2 : MyBaseClass
{
    public int SomeOtherProperty { get; set; }

    public override int GetSomething()
    {
        return this.SomeOtherProperty;
    }
} 
```

然后你可以：

```
var result = base.Select(b => b.GetSomething()).ToList(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T01:16:07.857

试试这个，我从来没有做过任何需要做这种事情的事情，但这应该做。此外，如果您使用`base`，首先不要因为它是关键字，但如果必须，`@base`请在名称前面使用 @ 表示它不用作关键字。

```
var resultA = base.Select(aVar =>
                            (aVar is DerivedType1) ?
                                (DerivedType)(((DerivedType1)aVar).DerivedProperty)
                                :
                                (DerivedType)(default(int?))
                        ).ToList(); 
```

# php - 如何在 nginx 中为 PHP 应用程序禁用输出缓冲

> ID：12165810
> 
> 赞同：20
> 
> 时间：2012-08-28T19:04:19.617
> 
> 标签：php, nginx, fastcgi

我们有类似这样的代码：

```
<?php
    ob_implicit_flush(true);
    ob_end_flush();

    foreach ($arrayOfStrings as $string) {
        echo time_expensive_function($string);
    }
?> 
```

在 Apache 中，这会将每个回显发送到浏览器，因为它是输出的。然而，在 nginx/FastCGI 中，由于 nginx 的工作方式（默认情况下），这不起作用。

是否可以在 nginx/FastCGI 上进行这项工作，如果可以，如何？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2014-07-29T14:04:49.770

首先 php 必须正确刷新所有内容：

```
@ob_end_flush();
@flush(); 
```

然后，我找到了两个可行的解决方案：

1) 通过 Nginx 配置：

```
fastcgi_buffering off; 
```

2) 通过 php 代码中的 HTTP 标头

```
header('X-Accel-Buffering: no'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-30T09:28:43.353

简单的解决方案：

```
fastcgi_keep_conn on; # < solution

proxy_buffering off;
gzip off; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-27T10:13:36.687

我不想关闭整个服务器或整个目录的 gzip，只是为了几个脚本，在一些特定情况下。

在任何内容被回显之前，您所需要的就是这个：

```
header('Content-Encoding: none;'); 
```

然后像往常一样进行冲洗：

```
ob_end_flush();
flush(); 
```

Nginx 似乎接受了已关闭的编码并且没有 gzip。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T19:20:42.840

在循环中添加 flush() 函数：

```
foreach ($arrayOfStrings as $string) {
  echo time_expensive_function($string);
  flush();
} 
```

它可能有效，但不一定在每次迭代中都有效（其中涉及一些魔法！）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-11T07:33:02.480

将 -flush 添加到 FastCGI 配置中，请参阅手册：

*   [http://www.fastcgi.com/mod_fastcgi/docs/mod_fastcgi.html#FastCgiServer](http://www.fastcgi.com/mod_fastcgi/docs/mod_fastcgi.html#FastCgiServer)

*   [http://www.fastcgi.com/mod_fastcgi/docs/mod_fastcgi.html#FastCgiConfig](http://www.fastcgi.com/mod_fastcgi/docs/mod_fastcgi.html#FastCgiConfig)

*   [http://www.fastcgi.com/mod_fastcgi/docs/mod_fastcgi.html#FastCgiExternalServer](http://www.fastcgi.com/mod_fastcgi/docs/mod_fastcgi.html#FastCgiExternalServer)

来自[http://mailman.fastcgi.com/pipermail/fastcgi-developers/2009-July/000286.html](http://mailman.fastcgi.com/pipermail/fastcgi-developers/2009-July/000286.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-09-19T11:06:46.010

我在脚本的开头需要这两行：

```
header('X-Accel-Buffering: no');
ob_implicit_flush(true); 
```

单独的每一行也可以工作，将它们结合起来可以让我的浏览器更快地从服务器获取结果。无法解释，只是经历过。

我的配置是带有 php-fpm 的 nginx。

# varnish - 清漆缓存日志不起作用

> ID：12165818
> 
> 赞同：11
> 
> 时间：2012-08-28T19:04:41.380
> 
> 标签：varnish

清漆日志正在返回：

```
_.vsm: No such file or directory 
```

有没有其他人见过这个？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-29T12:01:05.907

看起来**varnishlog**没有指向正确的目录，或者没有访问权限。

请检查**varnishd**的命令行选项。如果守护进程使用`-n <instancename>`参数运行，您还必须将其添加到**varnishlog**中。

第二件事，是查看varnish目录的权限。为了查看当前使用的目录，您必须登录到 root 并运行以下命令：

```
$ lsof -p <PID of varnishd> | grep vsm 
```

一旦显示出来，您只需确保完整路径对您的用户具有读取权限。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-04-15T10:27:01.687

在 Varnish 4.1 中，根本原因可能是由于读取`_.vsm`文件的权限不正确。例如：

```
# service varnishncsa start
 * Starting HTTP accelerator log deamon                                                                                                                                                               [fail] 
Can't open log - retrying for 5 seconds
Can't open VSM file (Cannot open /var/lib/varnish/dev-me/_.vsm: Permission denied 
```

Varnishncsa 从`varnishlog`用户那里工作。但`/var/lib/varnish/dev-me/_.vsm`只能从 varnish 组或 root 用户读取：

```
# ls -l /var/lib/varnish/dev-me/_.vsm
-rw-r----- 1 root varnish 84934656 Apr 15 05:58 /var/lib/varnish/dev-me/_.vsm 
```

因此，您可以通过以下方式解决此问题：

```
# usermod -a -G varnish varnishlog
# id varnishlog
uid=110(varnishlog) gid=116(varnishlog) groups=116(varnishlog),115(varnish) 
```

现在您可以启动 varnishncsa。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-29T13:37:15.197

在我们的例子中，服务器的主机名已更改。

如果您不指定实例名称，varnish 将使用主机名。它正在寻找一个包含新主机名的共享内存日志配置的目录，但该实例仍在使用旧主机名的目录运行。

重新启动清漆解决了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-17T03:50:19.840

我在尝试发出 varnishadm 命令时收到了相同的错误消息。原来我在没有停止清漆的情况下重命名了我的机器。/var/varnish/ 中有一些目录对应于 varnish 需要访问的机器名称。“sudo service varnish restart”为我解决了这个问题。

# asp.net - 如何将 HTML 呈现到 asp.net 页面？

> ID：12165820
> 
> 赞同：1
> 
> 时间：2012-08-28T19:04:47.900
> 
> 标签：asp.net, html, controls

我有一个存储页面名称和 HTML 内容的数据库。

当页面加载时，我想从数据库加载 HTML 内容并以某种方式将其呈现在页面上，我该怎么做？我应该使用什么样的控制？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T19:06:45.727

使用*[LiteralControl](http://msdn.microsoft.com/en-us/library/system.web.ui.literalcontrol.aspx)*，然后将您的 HTML 内容转储到其中。

```
string somehtml = "<div>stuff</div>";
MyLiteralControl.Text = somehtml; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T19:06:52.697

您可以使用[`<asp:LiteralControl>`](http://msdn.microsoft.com/en-us/library/system.web.ui.literalcontrol.aspx). 设置它的 Text 属性。

# windows - 在 Azure 的工作进程中解压 .GZ 文件

> ID：12165821
> 
> 赞同：1
> 
> 时间：2012-08-28T19:04:50.067
> 
> 标签：windows, azure

谁能给我一个想法，如何通过Worker实现.gz格式文件的解压。如果我尝试编写文件解压缩，那么我需要存储解压缩文件（即一个文本文件）的位置，它将被加载到天蓝色的任何位置。如何在 Windows Azure Worker 进程中指定路径，如当前执行目录。如果这种方法不起作用，那么我需要再创建一个 blob 来存储解压缩的 .gz 文件，即 txt。

-马亨斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T21:43:33.967

在您的 Worker 角色中，.gz 文件如何到达（从 Azure Blob 存储下载）取决于您，但是在该文件可用时，您可以使用[GZipStream](http://msdn.microsoft.com/en-us/library/system.io.compression.gzipstream.aspx)压缩/解压缩 .GZ 文件。您还可以在上面的链接中找到带有压缩和解压缩功能的代码示例。

这个 SO 讨论分享了一些工具和代码来解释如何使用 C# 解压缩 .GZ： [Unzipping a .gz file using C#](https://stackoverflow.com/questions/1348198/unzipping-a-gz-file-using-c-sharp)

接下来，当您将在辅助角色中使用解压缩/压缩代码时，您可以将其直接存储到本地存储（如 JcFx 建议的那样）或使用 MemoryStream 直接存储到 Azure Blob 存储。

以下 SO 文章展示了如何使用 GZipStream 将解压缩的内容存储到 MemoryStream 中，然后使用 UploadFromStream() API 直接存储到 Azure Blob 存储： [如何将 GZipStream 与 System.IO.MemoryStream 一起使用？](https://stackoverflow.com/questions/3722192/how-do-i-use-gzipstream-with-system-io-memorystream)

如果您没有与解压缩文件相关的任何操作，则最好直接存储到 Azure Blob 存储，但是如果您必须对解压缩的内容执行某些操作，则可以在本地保存以及存储到 Azure Blob 存储以供进一步使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T19:13:12.403

此示例使用 SharpZipLib 将 .gzip 文件提取到流中。从那里，您可以将其写入[Azure 本地存储](http://msdn.microsoft.com/en-us/library/windowsazure/ee758708.aspx)或 Blob 存储：

[http://wiki.sharpdevelop.net/GZip-and-Tar-Samples.ashx](http://wiki.sharpdevelop.net/GZip-and-Tar-Samples.ashx)

# excel - 更改为单元格中的粗体重复文本

> ID：12165824
> 
> 赞同：2
> 
> 时间：2012-08-28T19:05:00.673
> 
> 标签：excel, vba

我正在尝试编写一些代码来查找 excel 单元格中是否包含我要查找的单词并将其设为粗体。到目前为止，我已经编写了以下代码

```
With Worksheets("Label Print").Cells(i, J)
.Characters(Start:=InStr(.Value, “Name”), Length:=Len(“Name”)).Font.Bold = True
End With 
```

问题是如果“名称”在一个单元格中出现两次（或更多），它将仅突出显示其第一次出现。

先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T19:41:23.853

这是一个函数，它需要检查单元格和要搜索的单词，并将该单词的所有大小写加粗：

```
Public Sub BoldWord(rngCell As Range, sWord As String)

  Dim iPlace As Integer

  iPlace = InStr(1, rngCell.Value, sWord, vbTextCompare)
  Do While iPlace > 0
    rngCell.Characters(Start:=iPlace, Length:=Len(sWord)).Font.Bold = True
    iPlace = InStr(iPlace + 1, rngCell.Value, sWord, vbTextCompare)
  Loop

End Sub 
```

注 1： rngCell 必须是单个单元格。

注意 2：搜索不区分大小写...如有必要，请更改 vbTextCompare。

# sql - PostgreSQL 中的 date_trunc 5 分钟间隔

> ID：12165827
> 
> 赞同：34
> 
> 时间：2012-08-28T19:05:14.083
> 
> 标签：sql, postgresql, datetime, aggregate-functions

> **可能重复：**
> [在 Postgres 中将时间戳截断为 5 分钟的最快方法是什么？](https://stackoverflow.com/questions/7299342/what-is-the-fastest-way-to-truncate-timestamps-to-5-minutes-in-postgres)
> [具有任意精度的 Postgresql SQL GROUP BY 时间间隔（低至毫秒）](https://stackoverflow.com/questions/12045600/postgresql-sql-group-by-time-interval-with-arbitrary-accuracy-down-to-milli-sec)

我想在 PostgreSQL 中每隔 5 分钟聚合一次数据。如果我使用该`date_trunc()`功能，我可以按每小时、每月、每天、每周等间隔聚合数据，但不能像 5 分钟或 5 天这样的特定间隔。

```
select date_trunc('hour', date1), count(*) from table1 group by 1; 
```

我们如何在 PostgreSQL 中实现这一点？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-08-28T20:55:01.147

```
SELECT date_trunc('hour', date1) AS hour_stump
     , (extract(minute FROM date1)::int / 5) AS min5_slot
     , count(*)
FROM   table1
GROUP  BY 1, 2
ORDER  BY 1, 2; 
```

您可以`GROUP BY`使用两列：截断为小时的时间戳和 5 分钟的时隙。

该示例生成插槽 `0 - 11`。`1`如果您愿意，请添加`1 - 12`。
我将结果[`extract()`](https://www.postgresql.org/docs/current/functions-datetime.html#FUNCTIONS-DATETIME-EXTRACT)转换为整数，因此除法会`/ 5`截断小数位。结果：第
0 - 4 分钟 -> 时隙 0
分钟 5 - 9 -> 时隙 1
等。

此查询仅返回找到值的那些 5 分钟时段的值。*如果您想要每个*插槽的值，或者如果您想要超过 5 分钟插槽的*运行总和，请考虑以下相关答案：*

*   [PostgreSQL：“按分钟”查询的运行行数](https://stackoverflow.com/questions/8193688/postgresql-running-count-of-rows-for-a-query-by-minute/8194088#8194088)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:55:43.920

这是一个简单的查询，您可以将其包装在一个函数中，也可以在整个位置进行剪切和粘贴：

```
select now()::timestamp(0), (extract(epoch from now()::timestamptz(0)-date_trunc('d',now()))::int)/60; 
```

它会给你当前时间，以及一个从 0 到 n-1 的数字，这里 n=60。要每 5 分钟完成一次，请将该数字设为 300，依此类推。它按自一天开始以来的秒数分组。要使其从年开始、小时开始或其他任何时间开始按秒分组，请更改 date_trunc 中的“d”。

# java - 使用 Hibernate 4 生成 DDL

> ID：12165828
> 
> 赞同：1
> 
> 时间：2012-08-28T19:05:14.683
> 
> 标签：java, hibernate, ddl, hbm2ddl

当您编写一个使用 Hibernate 的应用程序并从类开始定义模型时，您如何生成包含 DDL 的脚本来设置数据库？

我知道有一个 Hibernate 工具`hbm2ddl`可用于此目的，但我找不到最新版本的 Hibernate (4.1.6)。

此外，在开发人员指南 (v4.1.6) 中，我看到有一个名为`SchemaExport`用于从映射生成 DDL 的工具。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T04:35:39.983

[Liquibase](http://www.liquibase.org/)很可能会做你想做的事。根据他们[关于 hibernate 的手册页](http://www.liquibase.org/manual/hibernate)，它会比 hbm2ddl 做得更好——我没有使用过 hbm2ddl，所以我无法支持他们的说法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-21T10:30:39.930

如果你设置了 Hibernate 会自动创建表

```
hibernate.hbm2ddl.auto=update 
```

# android - 进度对话框不会出现

> ID：12165829
> 
> 赞同：0
> 
> 时间：2012-08-28T19:05:16.787
> 
> 标签：android, dialog, progressdialog

我想在线程尝试建立连接时显示此对话框，但是当我按下启动此方法的按钮时，该对话框不会显示。

```
public void add_mpd(View view) {
    dialog = ProgressDialog.show(MainActivity.this, "", "Trying to connect...");
    new Thread(new Runnable() {
        public void run() {
            try {
                String child;
                EditText new_mpd = (EditText) findViewById(R.id.new_mpd);
                child = new_mpd.getText().toString();
                mpd = new MPD(child);
                children.get(1).add(child);

            } catch (UnknownHostException e) {
                e.printStackTrace();
            } catch (MPDConnectionException e) {
                e.printStackTrace();
            }
        }
    }
    ).start();
    adapter.notifyDataSetChanged();
    dialog.dismiss();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:09:30.183

它不会显示，因为（阻塞）工作是在另一个线程中完成的。这意味着， -class 的`start()`-method`Thread`不会阻塞。

因此，您显示对话框，线程启动，对话框立即关闭（因此关闭）。

将调用放在-method`dismiss()`的末尾，它应该可以正常工作。`run()`

* * *

以上可能对你有用，但你不应该`Thread`直接使用 -class 。它周围有包装纸，使用起来更舒适。

在 Android 中，如果您想在 UI-Thread 之外进行长期工作，您应该使用[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:11:39.340

另外，为了建立卢卡斯所说的，你可以看看这个例子。

[http://www.helloandroid.com/tutorials/using-threads-and-progressdialog](http://www.helloandroid.com/tutorials/using-threads-and-progressdialog)

```
public class ProgressDialogExample extends Activity implements Runnable {

    private String pi_string;
    private TextView tv;
    private ProgressDialog pd;

    @Override
    public void onCreate(Bundle icicle) {
            super.onCreate(icicle);
            setContentView(R.layout.main);

            tv = (TextView) this.findViewById(R.id.main);
            tv.setText("Press any key to start calculation");
    }

    @Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {

            pd = ProgressDialog.show(this, "Working..", "Calculating Pi", true,
                            false);

            Thread thread = new Thread(this);
            thread.start();

            return super.onKeyDown(keyCode, event);
    }

    public void run() {
            pi_string = Pi.computePi(800).toString();
            handler.sendEmptyMessage(0);
    }

    private Handler handler = new Handler() {
            @Override
            public void handleMessage(Message msg) {
                    pd.dismiss();
                    tv.setText(pi_string);

            }
    }; 
```

}

# datetime - VB6 中的 CDate 与 VB.NET 版本有何不同？

> ID：12165835
> 
> 赞同：2
> 
> 时间：2012-08-28T19:05:48.303
> 
> 标签：datetime, vb6, locale, .net

我们最近将一些代码从 VB6 迁移到 Net 4。其中的代码是这一行：

`If Now<CDate("28-08-2012") Then`

我们的一位客户因程序错误联系了支持人员，结果表明他的计算机在此行上产生了错误，因为他的语言环境设置为英语（美国）。当它是 VB6 时，完全相同的代码并没有被炸毁。

那么，如何解释这种差异呢？

（我刚刚完成`CDate`从网络代码中删除所有函数并用 yyyy,mm,dd`DateTime`构造函数替换它）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T21:38:08.647

我认为这里的问题是（可悲的）VB6 中对 CDate 的过度热心解析例程。将语言环境设置为英语（美国），VB6（和 VBA 就这点而言）将为这两个表达式返回相同的日期：

```
CDate("12-13-2000")
CDate("13-12-2000") 
```

他们都返回#12/13/2000#。显然，如果第一个数字不能转换为月份（例如 13），则假定它是一个月中的某一天（一个非常糟糕的假设）。

就这样。

# sql - 查询：查找来自不同用户的最近 5 个帖子

> ID：12165836
> 
> 赞同：0
> 
> 时间：2012-08-28T19:05:49.793
> 
> 标签：sql, postgresql

假设我们有一个`users`表，一个用户可以有很多`posts`（`posts`有`user_id`列）。

我想检索前 5 个用户的帖子，但每个用户只能检索一个帖子。所以，最后我想有 5 个帖子，每个帖子属于不同的用户。我怎样才能在 SQL 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:08:59.547

你应该有两张桌子

```
Table : users ; Columns : users_id , user_name
Table2: posts ; Columns : post_id , post_description , users_id 
```

现在检索所有用户，每个用户都有一个帖子

```
SELECT * FROM users as u
LEFT JOIN (SELECT * FROM posts LIMIT 1)  as p on p.users_id = u.users_id
LIMIT 5 ORDER BY ASC 
```

如果您想为每个用户获取最旧的帖子

```
SELECT * FROM users as u
LEFT JOIN (
    SELECT 
        MIN(post_id) as post_id , 
        post_description , 
        users_id  FROM posts
    )  as p on p.users_id = u.users_id
LIMIT 5 ORDER BY ASC 
```

对于最新的帖子使用 MAX(post_id) 而不是 MIN(post_id)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:11:09.337

也许它会帮助你：

```
select * 
  from users u
  join posts p on p.idUser = u.id
               and p.id = ( select max(id) from posts where p.id=u.id ) 
 ORDER BY i.id LIMIT 5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T19:15:01.047

这将为您提供最新的五个帖子（假设更高 ID 的帖子“较新”），强制每个结果来自不同的用户。

```
SELECT p.user_id, MAX(p.post_id) AS post_id 
FROM posts AS p
GROUP BY p.user_id -- get unique users
ORDER BY p.post_id DESC -- sort results by post_id number, descending
LIMIT 5 
```

使用此方法，如果需要加载其他用户或发布数据，最好在获得所需的用户ID和发布ID后单独加载。

# mysql - ADO.NET linq 到 MYSQL，orderby 不工作

> ID：12165837
> 
> 赞同：1
> 
> 时间：2012-08-28T19:05:54.973
> 
> 标签：mysql, linq, entity-framework, sql-order-by

我正在尝试根据我选择的列对查询结果进行排序。但由于某种原因，结果没有排序。结果的显示顺序与输入数据库的顺序相同。当我按行删除订单时，结果不会改变。“where”子句似乎工作正常。

```
var result = (from f in db.firmware
                      where f.firmware_branch_text != ""
                      orderby f.firmware_branch_text!=null, 
                            f.firmware_branch_text

                     select  f.firmware_branch_text                          
                     ).Distinct(); 
```

输出顺序如下：

```
2.2.2
2.2.3
2.4.1
2.4.0
3.0.0
2.6.12
2.6.13
2.6.14
2.6.15
2.0.2 
```

回答 ：

Distinct 破坏了顺序，所以我们需要在 distinct 之后进行排序：

```
var result = (from f in db.firmware
                      where f.firmware_branch_text != ""                          

                     select  f.firmware_branch_text                          
                     ).Distinct().OrderBy(a=>a); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:22:41.887

你可以简化它：

```
var result = (from f in db.firmware 
                  where f.firmware_branch_text != "" 
                  select  f.firmware_branch_text                           
                 ).Distinct().OrderBy(a=>a); 
```

# jquery - td 上的单击事件未触发

> ID：12165840
> 
> 赞同：0
> 
> 时间：2012-08-28T19:06:09.937
> 
> 标签：jquery, html-table, onclick

我正在用 PHP 生成表格并将其添加到 HTML 中，
我以这种方式将 PHP 代码添加到 HTML：

```
$('#pnametable').html(myVar); 
```

我的 PHP 代码：

```
$str="<table id='notable'>";    
while($row=mysql_fetch_array($result,MYSQL_ASSOC)){       
   $str.="<tr id='gtpname'><td class='pnotd'>".$row['pname']."</td></tr>";       
}       
$str.="</table>";` 
```

现在我的 jQuery 代码是这样的：

```
$("#notable > tbody > tr > td").click(function() {       
  alert("wdwad");      
}); 
```

请帮我找到解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T19:09:24.287

生成的数据是动态的。尝试使用“开”的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T19:09:45.050

目前还不是 100% 清楚您是如何构建表格的，但似乎您正在动态地进行构建。如果是这种情况，您需要使用[`on`](http://api.jquery.com/on/)这样的方法

```
$('#pnametable').on('click','#notable td', function(){
    alert("wdwad");
}); 
```

我假设这个客户端代码正在构建表格

```
$('#pnametable').html(myVar); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T19:11:30.323

您的 jquery 选择器已关闭。它正在寻找一个 tbody，但您的 PHP 代码没有创建一个 tbody。

您可以像这样修改 PHP：

```
$str="<table id='notable'><tbody>";    
while($row=mysql_fetch_array($result,MYSQL_ASSOC)){       
   $str.="<tr id='gtpname'><td class='pnotd'>".$row['pname']."</td></tr>";       
}       
$str.="</tbody></table>"; 
```

或者将 jquery 选择器更改为： `$("#notable > tr > td")`

# ruby - 在 ruby 中使用 sinatra-websocket gem 时连接丢失

> ID：12165841
> 
> 赞同：1
> 
> 时间：2012-08-28T19:06:20.510
> 
> 标签：ruby, html, sinatra, websocket

我想在我的社交游戏中使用 sinatra 中的 websocket，首先我想使用 em-websockets，但后来我发现了一个很好的 websockets 宝石，它使用了 em-websockets .. 它在这里被称为 sinatra-websocket .. [https://github .com/simulacre/sinatra-websocket](https://github.com/simulacre/sinatra-websocket) 我有一个问题，我在这里的 gem 示例中也发现了这个问题 [https://github.com/simulacre/sinatra-websocket/blob/master/examples/echochat.rb](https://github.com/simulacre/sinatra-websocket/blob/master/examples/echochat.rb)

问题是如果任何客户端空闲一段时间（不发送或接收）..所有连接在浏览器上都出现错误（加载时连接中断）..然后没有客户端可以通过以下方式向服务器发送任何内容网络套接字！

有谁知道发生了什么？？多谢 ！！

# xslt - 检查重复的属性值并添加前缀

> ID：12165844
> 
> 赞同：1
> 
> 时间：2012-08-28T19:06:26.180
> 
> 标签：xslt

我有一个 xml 文档：

```
<xml>
   <staff>
       <seq_no num="0">0</seq_no>
       <name>xyz</name>
   </staff>
   <staff>
       <seq_no num="1">1</seq_no>
       <name>xyz</name>
   </staff>
   <staff>
      <seq_no num="1">2</seq_no>
      <name>abc</name>
   </staff>
   <staff>
      <seq_no num="3">3</seq_no>
      <name>abc</name>
   </staff>
 </xml> 
```

如果任何 seq_no 相同，我想将数字添加到 seq_no/@num。**如果没有重复，则不会添加任何内容。**

上面的输出应该是：

```
 <xml>
     <staff>  
          <seq_no num="[1]1">0</seq_no>
          <name>xyz</name>
       </staff>
     <staff>
          <seq_no num="[2]1">1</seq_no>
          <name>xyz</name>
     </staff>
     <staff>
         <seq_no num="[3]1">2</seq_no>
         <name>abc</name>
      </staff>
     <staff>
         <seq_no num="[4]3">3</seq_no>
         <name>abc</name>
      </staff>
</xml> 
```

将 [1],[2],[3],[4] 分别添加到 seq_no/@num。我开始使用这样的匹配模板

```
<xsl:template match="seq_no/num">
<seq_no>
  <xsl:attribute name="num">
    <xsl:text>[</xsl:text><xsl:number select="." format="1" level="any"  /><xsl:text>]</xsl:text>
    <xsl:value-of select="@num"></xsl:value-of>
  </xsl:attribute>
<xsl:value-of select="."></xsl:value-of>
</seq_no>
</xsl:template> 
```

但是在控制位置以及如何检查其他 seq_no 的重复 num 时遇到麻烦...

**输入没有任何重复的数字：**

```
 <xml>
   <staff>
       <seq_no num="0">0</seq_no>
       <name>xyz</name>
   </staff>
   <staff>
       <seq_no num="1">1</seq_no>
       <name>xyz</name>
   </staff>
   <staff>
      <seq_no num="2">2</seq_no>
      <name>abc</name>
   </staff>
   <staff>
      <seq_no num="3">3</seq_no>
      <name>abc</name>
   </staff>
 </xml>. 
```

**输出应与输入相同，无需处理。**

```
 <xml>
   <staff>
       <seq_no num="0">0</seq_no>
       <name>xyz</name>
   </staff>
   <staff>
       <seq_no num="1">1</seq_no>
       <name>xyz</name>
   </staff>
   <staff>
      <seq_no num="1">2</seq_no>
      <name>abc</name>
   </staff>
   <staff>
      <seq_no num="3">3</seq_no>
      <name>abc</name>
   </staff>
 </xml> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T03:55:33.170

逻辑似乎仍然与您的输入/输出示例不匹配，但这就是我认为您正在尝试做的事情......

**XML 输入**

```
<xml>
    <staff>
        <seq_no num="0">0</seq_no>
        <name>xyz</name>
    </staff>
    <staff>
        <seq_no num="1">1</seq_no>
        <name>xyz</name>
    </staff>
    <staff>
        <seq_no num="1">2</seq_no>
        <name>abc</name>
    </staff>
    <staff>
        <seq_no num="3">3</seq_no>
        <name>abc</name>
    </staff>
</xml> 
```

**XSLT 1.0**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <!--Check for any duplicates in the doc.-->
    <xsl:variable name="vDups" select="boolean(//seq_no[@num=preceding::seq_no/@num])"/>

    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="seq_no">
        <xsl:copy>
            <xsl:choose>
                <xsl:when test="$vDups">
                    <xsl:attribute name="num">
                        <xsl:text>[</xsl:text>
                        <xsl:number level="any"/>
                        <xsl:text>]</xsl:text>
                        <xsl:value-of select="."/>                      
                    </xsl:attribute>
                    <xsl:apply-templates select="@*[not(name()='num')]|node()"/>
                </xsl:when>
                <xsl:otherwise>
                    <xsl:apply-templates select="@*|node()"/>
                </xsl:otherwise>
            </xsl:choose>
        </xsl:copy>
    </xsl:template>

</xsl:stylesheet> 
```

**XML 输出**

```
<xml>
   <staff>
      <seq_no num="[1]0">0</seq_no>
      <name>xyz</name>
   </staff>
   <staff>
      <seq_no num="[2]1">1</seq_no>
      <name>xyz</name>
   </staff>
   <staff>
      <seq_no num="[3]2">2</seq_no>
      <name>abc</name>
   </staff>
   <staff>
      <seq_no num="[4]3">3</seq_no>
      <name>abc</name>
   </staff>
</xml> 
```

可选的、更简洁的 XSLT 2.0 模板替换：

```
<xsl:template match="seq_no[$vDups]">
    <xsl:copy>
        <xsl:attribute name="num">
            <xsl:text>[</xsl:text>
            <xsl:number level="any"/>
            <xsl:text>]</xsl:text>
            <xsl:value-of select="."/>                      
        </xsl:attribute>
        <xsl:apply-templates select="@*[not(name()='num')]|node()"/>
    </xsl:copy>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T13:02:20.767

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="seq_no[/*/*/seq_no[@num = following::seq_no/@num]]">
  <seq_no num="[{count(preceding::seq_no)+1}]{.}">
   <xsl:apply-templates/>
  </seq_no>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<xml>
    <staff>
        <seq_no num="0">0</seq_no>
        <name>xyz</name>
    </staff>
    <staff>
        <seq_no num="1">1</seq_no>
        <name>xyz</name>
    </staff>
    <staff>
        <seq_no num="1">2</seq_no>
        <name>abc</name>
    </staff>
    <staff>
        <seq_no num="3">3</seq_no>
        <name>abc</name>
    </staff>
</xml> 
```

**产生想要的正确结果**：

```
<xml>
   <staff>
      <seq_no num="[1]0">0</seq_no>
      <name>xyz</name>
   </staff>
   <staff>
      <seq_no num="[2]1">1</seq_no>
      <name>xyz</name>
   </staff>
   <staff>
      <seq_no num="[3]2">2</seq_no>
      <name>abc</name>
   </staff>
   <staff>
      <seq_no num="[4]3">3</seq_no>
      <name>abc</name>
   </staff>
</xml> 
```

**当对这个 XML 文档应用相同的转换（如上）时（没有`@num`重复）：**

```
<xml>
    <staff>
        <seq_no num="0">0</seq_no>
        <name>xyz</name>
    </staff>
    <staff>
        <seq_no num="1">1</seq_no>
        <name>xyz</name>
    </staff>
    <staff>
        <seq_no num="2">2</seq_no>
        <name>abc</name>
    </staff>
    <staff>
        <seq_no num="3">3</seq_no>
        <name>abc</name>
    </staff>
</xml> 
```

**再次产生所需的正确结果：**

```
<xml>
  <staff>
    <seq_no num="0">0</seq_no>
    <name>xyz</name>
  </staff>
  <staff>
    <seq_no num="1">1</seq_no>
    <name>xyz</name>
  </staff>
  <staff>
    <seq_no num="2">2</seq_no>
    <name>abc</name>
  </staff>
  <staff>
    <seq_no num="3">3</seq_no>
    <name>abc</name>
  </staff>
</xml> 
```

# android - 使用广播接收器的一些问题

> ID：12165850
> 
> 赞同：3
> 
> 时间：2012-08-28T19:07:02.997
> 
> 标签：android, android-intent, broadcastreceiver, activity-lifecycle, intentfilter

我想`BroadcastReceiver`在我的应用程序中使用`AsyncTask`不同的结果指示器`Activities`，因此`AsyncTasks`也是如此。我认为我的方法有点错误，或者我错过了一些东西。

我在做什么：首先，在`onCreate`我将接收器注册为`BroadcastReceiver`使用该`registerReceiver`方法的过程中。我的接收器看起来像：

```
protected BroadcastReceiver myReceiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
        String msg_for_me = intent.getStringExtra("some_msg");
        Log.i("Tutorial", msg_for_me);
    }
} 
```

在我的应用程序中，我有**A 和 B 活动**。每个都有不同的接收器，它们从不同的任务中获取消息。顺便说一句，我必须澄清一点，A 活动开始 B 活动。

我在活动 A 中使用接收器，然后活动 A 使用`startActivity`. 在活动 B 中，我正在执行一个`AsyncTask`并且`onPostExecute`我正在发送一个带有 B 活动上下文的广播。但不知何故，A 活动的接收者仍然收到消息。两个接收器具有相同的内容但具有不同的名称。

所以这是我的问题：

*   我应该在方法`unregisterReceiver`上开始新活动时吗？`onPause`
*   `BroadcastReceiver`我就是这么用的，只打一个电话？每当我发送任何消息时，我都应该一次又一次地注册吗？
*   我很确定我没有将任何接收者定义为`Manifest`. 我想这是我做错了。如果这很好，我如何在发送广播时使用 IntentFilter？

如果有不确定的问题，请告诉我。任何有关 BroadcastReceiver 的线索都会很棒而且很受欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:20:34.107

1.  是的，您应该在活动暂停时取消注册广播接收器。这是潜在的泄漏。
2.  没有广播接收器不是一个呼叫。每次为注册的意图进行广播时都会调用它们。
3.  您可以像这样在 OnResume 上注册接收器以获取特定意图，

mContext.registerReceiver(iReceiver, new android.content.IntentFilter("android.intent.action.BATTERY_CHANGED"));

iReceiver 在哪里，

```
 iReceiver = new IntentReceiver();

private class IntentReceiver extends BroadcastReceiver {
    private final String LOG_TAG="IntentReceiver";

    @Override
    public void onReceive(Context arg0, Intent intent) {

    }
 } 
```

并在 OnPause 上取消注册

```
mContext.unregisterReceiver(iReceiver); 
```

# jqgrid - 使用 dataUrl 时延迟

> ID：12165851
> 
> 赞同：1
> 
> 时间：2012-08-28T19:07:05.673
> 
> 标签：jqgrid

我使用 dataUrl 选项来填充选择列表，我注意到加载选择列表选项有延迟。您可以在这里看到问题[http://jqgrid-multiselect.heroku.com/](http://jqgrid-multiselect.heroku.com/) 我想知道它是否“正常”？

更新：有一秒钟我有这样的表格： ![第一视角](../Images/4188fb186fea4f1f7fe2874c9964abe3.png)

接着

![第二种观点](../Images/0b622509d9d0f1b0efbf43475342f1b6.png)

如果编辑表单像这样“跳跃”，它看起来不太好。选择列表的宽度也会发生变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T07:35:58.307

该问题可以通过 ajaxSelectOptions:{async:false} 解决。可以在此处找到更多详细信息[如何从 jqgrid 中的 dataurl 获取行 ID 或参数以创建动态选择列表以编辑行](https://stackoverflow.com/questions/11523579/how-to-get-row-id-or-parameter-from-dataurl-in-jqgrid-to-create-a-dynamic-select/11535220#comment16062202_11535220)

# powershell - 如何在 PowerShell 中将选项标志传递给 Folder.CopyHere？

> ID：12165856
> 
> 赞同：10
> 
> 时间：2012-08-28T19:07:36.063
> 
> 标签：powershell, com

我正在尝试编写一个脚本，该脚本会自动将一堆字体以静默方式移动到[Fonts 特殊文件夹](http://technet.microsoft.com/en-us/library/ee176604.aspx)中，这样它们就可以像从资源管理器中“安装”它们一样可用（通过拖放、复制或右键单击并选择安装）。我把这`Shell.Application`部分一直到副本。

```
$FONTS = 0x14
$shell = New-Object -ComObject Shell.Application
$source = $shell.Namespace($downloaded_path)
$target = $shell.Namespace($FONTS)
$target.CopyHere($source.Items()) 
```

但是，某些系统可能已经安装了字体，我希望隐藏进度对话框并静默接受任何提示。

![安装字体](../Images/0dc1084ae42e3ec2f1e6737af8142780.png) ![字体已经安装](../Images/dc7421b3ef312238552772df498336ff.png)

所以，我正在调查[`Folder.CopyHere`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787866%28v=vs.85%29.aspx)选项标志。

*   `4`不显示进度对话框
*   `16`对于显示的任何对话框，都以“全部是”来响应。

我希望在此文件夹中支持它们（某些选项被设计忽略）。我认为这些都是十进制的，对吧？他们需要转换吗？但是我将它们传递进去，我仍然看到两个对话框。我努力了

```
$options = 4           <-- don't expect int to work
$options = 0x4         <-- thought hexidecimal would be ok, the VB documentation shows &H4&
$options = "4"         <-- string's the thing?
$options = [byte]4     <-- no luck with bytes
$options = [variant]4  <-- this isn't even a type accelerator! 
```

而且，如果我可以让一个选项起作用，我如何让两个选项都起作用？我`bor`他们在一起吗？格式化呢？

```
$options = 4 -bor 16 
```

还是我添加它们或将它们转换为十六进制？

```
$options = "{0:X}" -f (4 + 16) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T19:16:31.860

You can use `4 -bor 16`. It is hard to tell what this method expects since the type is VARIANT. I would have thought that it would take an integer value. If that doesn't work, this comment from the [MSDN topic on Folder.CopyHere](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787866%28v=vs.85%29.aspx) implies that a string should work:

```
function CopyFileProgress
{
    param( $Source, $DstFolder, $CopyType = 0 )

    # Convert the decimal to hex
    $copyFlag = [String]::Format("{0:x}", $CopyType)

    $objShell = New-Object -ComObject "Shell.Application"
    $objFolder = $objShell.NameSpace($DestLocation) 
    $objFolder.CopyHere($Source, $copyFlag)
} 
```

Although I wonder if the format string should be `"0x{0:x}"`?

Just be aware that for normal .NET flags style enums, you can pass multiple flags to a .NET (or command parameter) that is strongly typed to the enum like so:

```
$srv.ReplicationServer.Script('Creation,SomeOtherValue') 
```

Oisin has written up some info on this subject in this [blog post](http://www.nivot.org/post/2007/10/12/UsingEnumeratedTypesEnumsInPowerShell.aspx).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-15T21:02:22.940

我遇到了同样的问题，并在另一个线程中发现了这个问题，对我来说非常有效。

如果您希望它覆盖并保持沉默，请将 0x10 更改为 0x14 (docs)。

```
$destinationFolder.CopyHere($zipPackage.Items(), 0x14) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T03:21:11.377

选项`Folder.CopyHere`标志可能根本[不起作用](http://mattclingan.wordpress.com/2007/08/08/unzip-and-the-copyhere-command-with-vuseless-voptions/)。这让我很难过。我将不得不研究其中一种其他方法，所有这些方法都让我有点束手无策。

## 分离过程

在新进程中调用副本并使用[`ProcessStartInfo`](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.aspx)属性隐藏窗口。我还没有实现这个，但我想知道它是否会解决用户提示覆盖现有文件的问题？

```
Dim iProcess As New System.Diagnostics.ProcessStartInfo(AppDomain.CurrentDomain.BaseDirectory + “unzip.exe”)

iProcess.CreateNoWindow = True
Dim sArgs As String = ZippedFile
iProcess.Arguments = sArgs
iProcess.WindowStyle = ProcessWindowStyle.Hidden
Dim p As New System.Diagnostics.Process
iProcess.UseShellExecute = False
p = System.Diagnostics.Process.Start(iProcess)
p.WaitForExit(30000)
Dim s As Integer = p.ExitCode
iProcess.UseShellExecute = True

p.Dispose()
iProcess = Nothing 
```

## 循环

只[复制不存在的项目](http://social.technet.microsoft.com/Forums/en-US/winserverpowershell/thread/578a82ad-5f23-4c29-a887-92d0c6179311)。当我实际上想用同名的新字体文件更新现有字体时，这似乎失败了。

```
foreach($File in $Fontdir) {
    $fontName = $File.Name.Replace(".ttf", " Regular")
    $objFolderItem = $objFolder.ParseName($fontName);
    if (!$objFolderItem) {
      $objFolder.CopyHere($File.fullname,0x14)
    }
} 
```

## 删除现有

我正在考虑删除与我正在复制的字体同名的所有字体，然后复制该集合。虽然这有点残忍。而且我相信如果该字体因为正在使用而无法删除，还有*另一个提示。**叹*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-05-13T10:24:27.910

复制标志对我不起作用。我在安装字体脚本中设置了一个作业，该脚本检测“安装字体”窗口并将其发送`{Enter}`给它，这样我就不会覆盖现有字体。

```
Start-Job –Name DetectAndClosePrompt –Scriptblock {
  $i=1
  [void] [System.Reflection.Assembly]::LoadWithPartialName("'System.Windows.Forms")
  [void] [System.Reflection.Assembly]::LoadWithPartialName("'Microsoft.VisualBasic")
  while ($i -eq 1) { 
    $windowPrompt = Get-Process -ErrorAction SilentlyContinue |? {$_.MainWindowTitle -like "*Installing Fonts*"} 
    [Microsoft.VisualBasic.Interaction]::AppActivate($windowPrompt.ID)
    [System.Windows.Forms.SendKeys]::SendWait("{Enter}")
    sleep 2 
  }
} 
```

复制/安装所有字体后...我按名称删除了该作业。

```
Get-Job DetectAndClosePrompt | Remove-Job -Force 
```

这适用于 Windows 7、8.x 和 10。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-11T16:48:05.210

我看到了许多 Unzip 文件夹操作，但实际上没有人编写适合 Fonts 文件夹情况的解决方案。所以我自己写了！事实证明，Fonts 文件夹确实实现了 Shell.Folder.CopyHere 方法，但不支持为该方法的第二个参数传递的任何重载。为什么？谁知道！我怀疑['The Old new Thing'](http://blogs.msdn.com/b/oldnewthing/) Windows Developer blog 的 Raymond Chen 可以解释它，但我不知道答案。因此，我们需要在尝试复制它们之前智能地查找我们的字体，否则我们会收到一条讨厌的消息。

* * *

在我的代码中，我们通过使用通配符搜索检查字体名称的前四个字符是否匹配来检查字体是否存在。如果字体不存在，我们假设这是我们第一次在这个系统上安装字体并设置一个名为 $FirstInstall 的特殊标志。

从那时起，在脚本中，如果 $FirstInstall 为 true，我们将在源字体目录中安装所有字体。在随后的执行中，我们检查每个字体是否匹配，如果是，我们中止该副本。如果没有，我们继续复制。到目前为止，这似乎对我的大多数客户都有效。

干得好！

```
 <#
.SYNOPSIS
    Script to quietly handle the installation of fonts from a network source to a system

.DESCRIPTION
    We Can't just move files into the %windir%\Fonts directory with a script, as a simple copy paste from command line doesn't trigger windows to note the new font
If we used that approach, the files would exist within the directory, but the font files woudln't be registered in windows, nor would applications 
display the new font for use.  Instead, we can make a new object of the Shell.Application type (effectively an invisible Windows Explorer Windows) and use its Copy method
Which is the functional equivalent of dragging an dropping font files into the Font folder, which does trigger the font to be installed the same as if you right clicked the font
and choose install.

.PARAMETER FontPath
    The path of a folder where fonts reside on the network

.EXAMPLE
    .\Install-Fonts.ps1 -FontPath "\\corp\fileshare\Scripts\Fonts"

    Installing font...C:\temp\Noto\NotoSans-Bold.ttf
    Installing font...C:\temp\Noto\NotoSans-BoldItalic.ttf
    Installing font...C:\temp\Noto\NotoSans-Italic.ttf
    Installing font...C:\temp\Noto\NotoSans-Regular.ttf

    In this case, the fonts are copied from the network down to the system and installed silently, minus the logging seen here
    import files needed for step 1, step 2, and step 5 of the migration process.

.EXAMPLE
    .\Install-Fonts.ps1 -FontPath "\\corp\fileshare\Scripts\Fonts"

    Font already exists, skipping
    Font already exists, skipping
    Font already exists, skipping
    Font already exists, skipping
    In this case, the fonts already existed on the system.  Rather than display an annoying 'Overwrite font' dialog, we simply abort the copy and try the next file

.INPUTS
    String.

.OUTPUTS
    Console output

.NOTES
    CREATED: 06/11/2015
    Author: sowen@ivision.com

    MODIFIED:06/11/2015
    Author: sowen@ivision.com   -Reserved...

#> 
param
    ( 
        [Parameter(Mandatory)][string]$FontPath="C:\temp\Noto" 
    ) 

#0x14 is a special system folder pointer to the path where fonts live, and is needed below. 
$FONTS = 0x14

#Make a refrence to Shell.Application
$objShell = New-Object -ComObject Shell.Application
$objFolder = $objShell.Namespace($FONTS)

ForEach ($font in (dir $fontsPath -Recurse -Include *.ttf,*.otf)){

    #check for existing font (to suppress annoying 'do you want to overwrite' dialog box
    if ((($objShell.NameSpace($FONTS).Items() | where Name -like "$($font.BaseName.Split('-')[0].substring(0,4))*") | measure).Count -eq 0){
        $firstInstall = $true}

    if ($firstInstall -ne $true) {Write-Output "Font already exists, skipping"}

        else{    
        $objFolder.CopyHere($font.FullName)
        Write-Output "Installing font...$($font.FullName)"
        $firstInstall = $true
        }

    }

.\Install-Fonts.ps1 -FontPath "\\corp\fileshare\Scripts\Fonts" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-27T08:16:33.397

你可以只取你的选项的总和。我需要使用两个选项运行 CopyHere - SILENT 和 NOCONFIRMATION。请看下面的示例：

```
function Unzip-Archive($targetpath, $destination)
{    
    $shell_app=new-object -com shell.application

    $FOF_SILENT_FLAG = 4
    $FOF_NOCONFIRMATION_FLAG = 16

    $zip_file = $shell_app.namespace("$targetpath")

    #Set the destination directory for the extracts
    $destination = $shell_app.namespace("$destination")

    #unzip the files
    $destination.Copyhere($zip_file.items(), $FOF_SILENT_FLAG + $FOF_NOCONFIRMATION_FLAG)    
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-06T00:46:44.100

@FoxDeploy 的回答有几个问题，这就是它不起作用的原因。第一个问题是您还想检查 %USERPROFILE% 中的 Fonts 文件夹，否则您会看到确认对话框。第二个问题是您要避免在字体名称中使用“-”。

下面是从 CodeFonts repo 安装字体的固定版本作为示例：

```
$ErrorActionPreference = "Stop"
Add-Type -AssemblyName System.Drawing

# Clone chrissimpkins/codeface from which we will install fonts
if (!(Test-Path /GitHubSrc/codeface)){
    git clone git://github.com/chrissimpkins/codeface.git /GitHubSrc/codeface
}

#0x14 is a special system folder pointer to the path where fonts live, and is needed below. 
$FONTS = 0x14
$fontCollection = new-object System.Drawing.Text.PrivateFontCollection

#Make a refrence to Shell.Application
$objShell = New-Object -ComObject Shell.Application
$objFolder = $objShell.Namespace($FONTS)

# local path

$localSysPath = "$Env:USERPROFILE\AppData\Local\Microsoft\Windows\Fonts"
$localSysFonts = Get-ChildItem -Path $localSysPath -Recurse -File -Name | ForEach-Object -Process {[System.IO.Path]::GetFileNameWithoutExtension($_)}

$fontsPath="\GitHubSrc\codeface\fonts"
ForEach ($font in (dir $fontsPath -Recurse -Include *.ttf,*.otf)){
    if ($localSysFonts -like $font.BaseName) {
        Write-Output "SKIP: Font ${font} already exists in ${localSysPath}"
    }
    else {
        $fontCollection.AddFontFile($font.FullName)
        $fontName = $fontCollection.Families[-1].Name

        #check for existing font (to suppress annoying 'do you want to overwrite' dialog box
        if ((($objShell.NameSpace($FONTS).Items() | where Name -ieq $fontName) | measure).Count -eq 0){
            Write-Output "INST: Font ${font}"
            $objFolder.CopyHere($font.FullName)
            $firstInstall = $true
        }
        else {
            Write-Output "SKIP: Font ${font} already exists in SYSTEM FONTS"
        }
    }
    # Read-Host -Prompt "Press Enter to continue"
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-11-21T20:24:24.880

我只是通过简单地使用 + ie 来实现它

```
function Expand-ZIPFile($file, $destination)
{
    $shell = new-object -com shell.application
    $zip = $shell.NameSpace($file)
    foreach($item in $zip.items())
    {
        $shell.Namespace($destination).copyhere($item, 16+1024)
    }
} 
```

# linq - 在内部对象属性上使用 Distinct

> ID：12165857
> 
> 赞同：2
> 
> 时间：2012-08-28T19:07:36.737
> 
> 标签：linq

我有一个数据集合，其中有一个名为 Approvals 的集合。Approvals 对象有一个属性调用 ApplicationName。我想要一个所有 Distinct Approvals ApplicationNames 的列表。因此，如果我有一个包含 Nick、Nick、Jack、Daniel 的 applicationNames 的 Approvals 列表，我想返回 Nick、Jack、Daniel 的整个批准对象。或者至少只是尼克、杰克、丹尼尔的名字列表

这对我不起作用..

```
theApplicationNames = theData.Approvals.Select(c => new WebsiteApplicationInfo 
                                                    {
                                                        Name=c.ApplicationName,
                                                        ID=c.ApplicationId
                                                    }).Distinct().ToList(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:13:03.063

如果你想要一个不同名称的列表，你会使用

```
var names = theData.Approvals.Select(a => a.ApplicationName).Distinct(); 
```

这将导致所有名称的列表（可能是字符串？）。

您的版本对您“不起作用”的一个可能原因是您正在使用对象`.Distinct()`集合`WebsiteApplicationInfo`，这些对象可能没有实现正确的相等比较。但是，如果不知道您所说的“不起作用”是什么意思，我们无法确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:13:24.597

```
theData.Approvals.Select(a => a.ApplicationName).Distinct(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T19:24:50.427

如果你投射一个单一的属性，你可以区分它。如果要投影匿名类型，则需要使用 GroupBy 技巧或创建自定义 IComparer 并将其传递给 Distinct。您应该能够使用以下搜索找到相当多的解决方案：[https ://stackoverflow.com/search?q=distinctby&submit=search](https://stackoverflow.com/search?q=distinctby&submit=search)

# xamarin.ios - 如何使用 Monotouch 在 iPad 故事板应用程序中以编程方式管理视图

> ID：12165859
> 
> 赞同：0
> 
> 时间：2012-08-28T19:07:44.960
> 
> 标签：xamarin.ios

我使用最新版本的 Monotouch 创建了一个 iPad 故事板应用程序。我的第一个屏幕是登录屏幕，我只想在用户没有保存他的凭据时显示。如果凭据可用，我想导航到第二个场景的 UITabBarController。我似乎找不到任何有关如何执行此操作的文档。我尝试创建 UITabBarController 的实例并推送到它，但它不起作用。

```
homeScreen = new HomeTabBarNavigator(this.Handle);
this.NavigationController.PushViewController(homeScreen,true); 
```

HomeTabBarNavigator 是一个已经链接到其他场景的 UITabBarController。我收到以下错误：

```
[ERROR] FATAL UNHANDLED EXCEPTION: System.NullReferenceException: Object reference not set   to an instance of an object 
```

我假设我收到了这个错误，因为我没有为我的 HomeTabBarNavigator 的 ViewControllers 属性定义任何视图。我希望这些观点已经被定义，但似乎并非如此。有任何想法吗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T04:20:38.187

我能找到的最佳解决方案是在控制器上调用 PerformSegue。这是一些示例代码：

```
this.PerformSegue("LoginSegue",this); 
```

加载的控制器是 LoginController，而 LoginSegue 是一个指向 HomeTabBarNavigator 的 Segue。虽然它并不完美，但应用程序正确加载了标签栏。

我使用这个[stackoverlflow iOS 问题](https://stackoverflow.com/questions/9047146/alternative-ways-to-push-view-controllers-with-storyboard-programmatically)作为我的解决方案的基础。

# memcached - Memcache 删除也会删除数据库？

> ID：12165860
> 
> 赞同：0
> 
> 时间：2012-08-28T19:07:54.293
> 
> 标签：memcached

我正在开发使用 memcached 的客户端-服务器软件。

如果我想从 memcached 中保存的数据库中删除内容，通常需要以下哪项来实现此目标？

```
A - delete from database AND delete from memcached
B - delete from memcached (which will automatically delete from the database) 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:11:11.040

选项 A 是您想要的。

Memcache 和您的数据库是完全独立的，您可以让它们相互反映。

例如，如果您插入数据库，则还必须插入内存缓存。如果您从数据库中删除，您还必须从 memcache 中删除。

在当今的大多数框架中，这都被抽象出来了。但是，如果您手动执行此操作，则必须同时执行这两项操作以获得一致的数据。

编辑：删除我的意思是无效

# iphone - 当其他手指已经在其他 UIImageView 上时，不允许在 UIImageView 上点击手势

> ID：12165866
> 
> 赞同：1
> 
> 时间：2012-08-28T19:08:33.677
> 
> 标签：iphone, objective-c, ios, uigesturerecognizer, multi-touch

我有一个 UIView。因为有不止一个 UIImageViews。我在所有 UIImageView 中分别添加了 Tapgesture。所以当其他手指已经在其他 UIImageView 上时，我必须不允许在点击 UIImageView 时调用点击手势功能。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T19:11:22.353

您必须实现[UIGestureRecognizerDelegate](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIGestureRecognizerDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UIGestureRecognizerDelegate)方法`gestureRecognizer:shouldRecognizeSimultaneouslyWithGestureRecognizer:`并返回`NO`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:12:46.757

您是否尝试将 UIView multipleTouchesEnabled 设置为 NO？您还可以尝试继承 UIImageView 并覆盖以下方法，这样您就可以控制状态并禁止执行额外的触摸。

– touchesBegan:withEvent:

– touchesMoved:withEvent:

– touchesEnded:withEvent:

– touchesCancelled:withEvent:

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T19:11:05.680

为您拥有的所有图像添加唯一标签

当你的点击选择器被调用时，检查标签，如果它与你感兴趣的图像的标签匹配，然后继续你想做的事情，否则什么都不做

# java - 用标签解析xml

> ID：12165873
> 
> 赞同：0
> 
> 时间：2012-08-28T19:09:01.230
> 
> 标签：java, android, xml

我正在按照此示例解析 xml[示例](https://stackoverflow.com/questions/5180360/android-xml-parsing-output-in-tableview)，但是当我尝试解析 xml 时出现错误。Xml 是 Reg Variacion="20" />

我需要显示 TextView[]; 20、20、20

这是我的代码：

**MainActivity.java**

```
public class MainActivity extends Activity {

    SitesList sitesList = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        /** Create a new layout to display the view */
        LinearLayout layout = new LinearLayout(this);
        layout.setOrientation(1);

        /** Create a new textview array to display the results */

        TextView registro[];
        TextView variacion[];

        try {

            /** Handling XML */
            SAXParserFactory spf = SAXParserFactory.newInstance();
            SAXParser sp = spf.newSAXParser();
            XMLReader xr = sp.getXMLReader();

            /** Send URL to parse XML Tags */
            URL sourceUrl = new URL("http://www.bovalpo.com/cgi-local/xml_bcv.pl?URL=75");

            /** Create handler to handle XML Tags ( extends DefaultHandler ) */
            MyXMLHandler myXMLHandler = new MyXMLHandler();
            xr.setContentHandler(myXMLHandler);
            xr.parse(new InputSource(sourceUrl.openStream()));

            } catch (Exception e) {
                System.out.println("XML Pasing Excpetion = " + e);
            }

        /** Get result from MyXMLHandler SitlesList Object */
        sitesList = MyXMLHandler.sitesList;

        /** Assign textview array lenght by arraylist size */
        registro = new TextView[sitesList.getRegistro().size()];
        variacion = new TextView[sitesList.getVariacion().size()];

        /** Set the result text in textview and add it to layout */
        for (int i = 0; i < sitesList.getRegistro().size(); i++) {

            registro[i] = new TextView(this);
            registro[i].setText(sitesList.getRegistro().get(i));
            variacion[i] = new TextView(this);
            variacion[i].setText(sitesList.getVariacion().get(i));

            layout.addView(registro[i]);
            //layout.addView(category[i]);
        }

        /** Set the layout view to display */
        setContentView(layout);
    }
} 
```

**MyXMLHandler.java**

```
DefaultHandler {
    @Override public void startElement(String uri, String localName, String qName, Attributes attributes) throws SAXException {

    currentElement = true;
    if (localName.equals("root"))
    {
        /** Start */
        sitesList = new SitesList();

    } else if (localName.equals("registro")) {

        String attr = attributes.getValue("Variacion");
        String var = String.valueOf(attr);
        sitesList.setVariacion(var);
    }

    }

    @Override
    public void endElement(String uri, String localName, String qName)
            throws SAXException {

    currentElement = false;

    /** set value */
        if (localName.equalsIgnoreCase("registro"))
            sitesList.setRegistro(currentValue);

    }

    @Override
    public void characters(char[] ch, int start, int length)
            throws SAXException {

        if (currentElement) {
            currentValue = new String(ch, start, length);
            currentElement = false;
        }

    } 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:11:30.257

尝试使用**DOM PARSER**（文档对象模型）

**请参阅此链接：**

[http://tutorials.jenkov.com/java-xml/dom.html](http://tutorials.jenkov.com/java-xml/dom.html)

# sql - SQL - 非规范化

> ID：12165877
> 
> 赞同：0
> 
> 时间：2012-08-28T19:09:12.060
> 
> 标签：sql, sql-server

我正在尝试熟悉一个结构如下的新数据库：

```
CREATE TABLE [TableA] (ID int not null, Primary Key (ID))
CREATE TABLE [TableB] (ID int not null, Primary Key (ID))
CREATE TABLE [TableC] (ID int not null, ID2 int, ID3 int, ID4 int, primary key (ID),
FOREIGN KEY (ID2) REFERENCES TableA(ID), FOREIGN KEY (ID3) REFERENCES TableB(ID)) 
```

表 C 是表 A 和表 B 之间的多对多连接表。TableC.ID 是唯一的（因为它是主键）。TableC.ID4 也是唯一的，似乎没有引用任何内容。我联系了将其描述为“M1（多对1）实体的非规范化”的开发人员。我完全理解去规范化的目的（规范化数据库，然后出于性能原因故意引入异常），但是我仍然不明白这背后的原因。是否有我不知道的模式或概念？该应用程序是用 C++ 编写的，带有一些 VB.NET。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T05:31:25.967

这本身不是一个答案，只是一个相关的想法。请不要开始投票。

tableC.ID 和 tableC.ID4 之间有什么联系吗？在我的一个项目中，我遇到了类似的情况——我在用户表中有用户 ID 和用户名。两者都是唯一的，用户 ID 作为主键。有一种方法可以从该表中删除用户名，并创建一个单独的表，将用户 ID 映射到用户名。我不是规范化的忠实拥护者。所以我认为每次我需要来自包含用户名的用户表中的数据并保持我的设计原样时，触发一个连接查询是一种开销。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T05:15:14.960

如果 tableC.ID4 包含通常您必须执行附加连接或查找的值，则这是公平的非规范化。那么您是否检查了应用程序代码以查看该列的填充内容？如果它没有引用任何内容并且没有对整个行数据提供任何丰富，那么您可以安全地继续您的开发。

# iphone - 如何从 iOS 中的 -id 返回 void 语句？

> ID：12165880
> 
> 赞同：1
> 
> 时间：2012-08-28T19:09:19.817
> 
> 标签：iphone, ios, xcode, methods, void

在我的代码中，我运行一个 -(id) 代码，一般方法是返回一个字符串或布尔值。有没有办法我可以返回一个方法？在代码中，我有几个“if”语句，并希望每个“if”语句执行另一个我在其他地方有的 void 函数。那么，有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:11:15.523

无需质疑设计……</p>

你可以返回一个块或`NSInvocation`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:15:11.513

You can return a Block instead of id. Here you can find Apple's documentation about using blocks: [http://developer.apple.com/library/ios/#featuredarticles/Short_Practical_Guide_Blocks/_index.html](http://developer.apple.com/library/ios/#featuredarticles/Short_Practical_Guide_Blocks/_index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T20:08:33.220

您还可以返回 (id) 作为响应。

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T19:13:31.053

您可以返回一个选择器 (SEL)，或者更好的是，一个代码块。

# javascript - switch 语句中的 Javascript 范围

> ID：12165888
> 
> 赞同：4
> 
> 时间：2012-08-28T19:09:44.843
> 
> 标签：javascript, scope, switch-statement

我是 Javascript 新手，不了解以下行为。

1.  当 textarea 为空时，“进程”代码不会将其识别为 null，并且不会提示输入文本。

2.  当文本区域中有文本时，“处理”代码不会显示警报中的文本。看来这可能是一个范围问题我认为我所有的变量都是全局的。

**HTML 代码：**

```
<input type="button" name="btnProcessTA" onclick="myTextArea('process')" value="Process Text Area" />
<input type="button" name="btnClearTA"   onclick="myTextArea('clear')" value="Clear Text Area" />

<form id="formExample" action="" method="get">   
    <label for="textAreaField">A text area field</label>
    <textarea name="textAreaField" id="textAreaField" rows="4" cols="50"></textarea>
</form> 
```

**Javascript代码：**

```
<script type="text/javascript">
function myTextArea(op)
{
 oTextArea = document.getElementById("textAreaField"); 
 textAreaValue = oTextArea.value;           
 alert(op + "\n" + oTextArea + "\n" + textAreaValue);

 switch (op){
    case "clear":
    oTextArea.value = "";
    alert("Clearing");
    break;

    case "process":
    if (textAreaValue = "")
        alert("Would you please enter some text?"); 
    else
        alert("You entered:\n\n" + textAreaValue);
    break;

    default : alert("unknown op code");
    }
 }
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:12:11.927

要进行比较，您必须使用`==`而不是`=` :)

```
case "process":
if (textAreaValue == "")
    alert("Would you please enter some text?"); 
else
    alert("You entered:\n\n" + textAreaValue);
break; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T19:12:23.780

改变

```
if (textAreaValue = "") 
```

到

```
if (textAreaValue === "") // or == 
```

您正在执行分配而不是进行比较。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T19:14:14.697

```
if (textAreaValue = "") 
```

if 语句中的单等号被解释为赋值（它不会抛出错误，因为从技术上讲它是正确的语法，但很多人会通过使用单等号而不是双等号来犯这个错误）。如果您打算比较而不是分配，则正确的语法是三等号。

```
if (textAreaValue === "") 
```

# java - 即使我运行 mvn hibernate3:hbm2cfgxml 也没有创 建 hibernate.cfg.xml

> ID：12165890
> 
> 赞同：1
> 
> 时间：2012-08-28T19:09:50.637
> 
> 标签：java, hibernate, maven, hbm2java

当我运行 mvn hibernate3:hbm2cfgxml 它不会生成 hibernate.cfg.xml 文件。但是它会生成 pojos 和 daos 但不会生成 hibernate.cfg.xml 文件。

以下是我的 pom.xml。

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org /2001/XMLSchema-instance"=  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>com.myhadoop.app</groupId>
<artifactId>my-app-hadoop</artifactId>
<packaging>jar</packaging>
<version>1.0-SNAPSHOT</version>
<name>my-app-hadoop</name>
<url>http://maven.apache.org</url>

<dependencies>
<dependency>
  <groupId>junit</groupId>
  <artifactId>junit</artifactId>
  <version>3.8.1</version>
  <scope>test</scope>
</dependency>

<dependency>
    <groupId>org.apache.hadoop</groupId>
    <artifactId>hadoop-core</artifactId>
    <version>1.0.3</version>
</dependency>

<dependency>
    <groupId>org.hibernate </groupId>
    <artifactId>hibernate-core</artifactId>
    <version>4.1.6.Final</version>
</dependency>

<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>servlet-api</artifactId>
    <version>3.0-alpha-1</version>
</dependency>

<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-simple</artifactId>
    <version>1.6.6</version>
</dependency>

<dependency>
    <groupId>javassist</groupId>
    <artifactId>javassist</artifactId>
    <version>3.12.1.GA </version>
</dependency>
</dependencies>
<repositories>
<repository>
    <id>jBoss-Repository</id>
    <url>https://repository.jboss.org/nexus/content/groups/public/</url>
    <releases>
       <enabled>true</enabled>
    </releases>
    <snapshots>
      <enabled>false</enabled>
    </snapshots>        
 </repository>
 <repository>
    <id>mirrors.ibiblio</id>
    <url>http://mirrors.ibiblio.org/maven/mule/dependencies/maven2/</url>
    <releases>
       <enabled>true</enabled>
    </releases>
    <snapshots>
      <enabled>false</enabled>
    </snapshots>        
 </repository>
 </repositories>
 <build>
<plugins>
    <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>hibernate3-maven-plugin</artifactId>
        <version>2.2</version>
        <configuration>
            <components>
                <component>
                    <name>hbm2ddl</name>
                         <implementation>jdbcconfiguration</implementation>
                </component>
                <component>
                    <name>hbm2hbmxml</name>
                    <implementation>jdbcconfiguration</implementation>
                    <outputDirectory>src/main/java/org/dbmxml</outputDirectory>
                </component>
                <component>
                    <name>hbm2dao</name>
                    <implementation>jdbcconfiguration</implementation>
                    <outputDirectory>src/main/java</outputDirectory>
                </component>
                <component>
                    <name>hbm2java</name>
                    <implementation>jdbcconfiguration</implementation>
                    <outputDirectory>src/main/java</outputDirectory>
                </component>

                <component>
                    <name>hbm2doc</name>
                    <implementation>jdbcconfiguration</implementation>
                    <outputDirectory>src/hbm2doc</outputDirectory>
                </component>

                <component>
                    <name>hbm2ddl</name>
                    <implementation>jdbcconfiguration</implementation>
                    <outputDirectory>src/hbm2ddl</outputDirectory>
                </component>
            </components>

            <componentProperties>
                <drop>true</drop>
                <packagename>org.hbm2dao</packagename>
                <configurationfile>/src/main/resources/hibernate.cfg.xml</configurationfile>
                <propertyFile>/src/main/resources/database.properties</propertyFile>
            </componentProperties>
        </configuration>
        <dependencies>
            <dependency>
                <groupId>com.oracle</groupId>
                <artifactId>ojdbc</artifactId>
                <version>6</version>
                <scope>system</scope>
                <systemPath>D:/apps/oracle11g/product/11.2.0/dbhome_1/jdbc/lib/ojdbc6.jar</systemPath>
        </dependency>
    </dependencies>
  </plugin>
</plugins> 
```

需要在 pom.xml 中添加什么，以便我可以生成 hibernate.cfg.xml 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T05:46:17.463

根据您需要创建如下部分的[文档：](http://mojo.codehaus.org/maven-hibernate3/hibernate3-maven-plugin/hbm2cfgxml-mojo.html)

```
<component>
  <name>hbm2cfgxml</name>
  <implementation>...</implementation>
  ...
</component> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T06:18:14.210

此外，除了上述答案之外，我认为您在 POM 中有重复声明“hbm2ddl”组件。

您可以参考： [http](http://hop2croft.wordpress.com/2011/05/08/creating-java-domain-objects-with-the-maven-hibernate-plugin/#highlighter_819265) ://hop2croft.wordpress.com/2011/05/08/creating-java-domain-objects-with-the-maven-hibernate-plugin/#highlighter_819265 和 [https://forum.hibernate。 org/viewtopic.php?f=6&t=1008209&view=previous](https://forum.hibernate.org/viewtopic.php?f=6&t=1008209&view=previous)

# sql-server - 扩展 SQL Azure 表/架构的体系结构要求

> ID：12165897
> 
> 赞同：0
> 
> 时间：2012-08-28T19:10:06.117
> 
> 标签：sql-server, tsql, scalability, azure-sql-database, horizontal-scaling

我正在 SQL Azure 中设置架构/一些表，并想知道我是否需要在架构上做任何事情以提高可伸缩性，尤其是水平可伸缩性。ID应该是某种类型吗？主键是某种类型？

我希望避免未来的风险/问题......让我知道。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T21:23:52.393

我建议您阅读[Scale Out with SQL Database (en-US)](http://social.technet.microsoft.com/wiki/contents/articles/1010.scale-out-with-sql-database-en-us.aspx)一文，该文章解释了有关 SQL 数据库水平分区所需内容的详细信息。

现在，您还可以将 SQL 联合与 SQL 数据库一起使用，因此另一篇关于[使用 SQL Azure 联合进行横向扩展](http://msdn.microsoft.com/en-us/magazine/hh848258.aspx)的文章将帮助您确定可以在需要时横向扩展的最佳架构。

# ruby-on-rails - ActiveModel 基于关联验证属性

> ID：12165898
> 
> 赞同：2
> 
> 时间：2012-08-28T19:10:16.177
> 
> 标签：ruby-on-rails, validation, associations, mongoid, activemodel

我至少有2节课。一个类必须根据关联模型的属性值验证其属性之一。下面的代码是我想要的，但这只是一个想法，它不起作用。有什么方法可以实现吗？

```
class Concert
 include Mongoid::Document
 include Mongoid::Timestamps

 field :end_date, type: Date
end

class Sale
  include Mongoid::Document

  field :end_date, type: Date

  belongs_to :concert

  validates :end_date, :timeliness => {
        :before => lambda {self.concert.end_date}, 
        :after => lambda {self.concert.created_at}, 
        :before_message => 'Sale should not end before the Concert begins', 
        :after_message => 'Sale should not end after the Concert has already ended',
        :type => :date
    }
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T06:51:17.747

向销售添加验证

```
validates :end_date, :presence => true, :if => :some_checking

def some_checking
   #your validations
   #eg
   self.concert.end_date.present?
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T20:54:40.237

`self`只是一个猜测，但是您在 lambda 中的引用没有问题吗？我会去`=> lambda { |record| record.concert.end_date }`

# python - 循环填充列表

> ID：12165908
> 
> 赞同：-1
> 
> 时间：2012-08-28T19:11:07.560
> 
> 标签：python, list

我正在读取一个数据文件，我有一个包含文件行的列表，它是这样的：

```
>>> oz[:15]
[' 283283283283283283283283284284284284284284284284284284284284284284284284284\n',
' 284284284284284284284284284284284284284284284284284284284284284284284284284\n',
...
' 291291292292292292292292293293293293293293293293293293293293294294294294294\n',
' 294294294294294294294294295295   lat =  -89.5\n'] 
```

现在我想以一种聪明的方式将数字存储在这个列表中，我需要一个每 3 位数字的元素列表，但是如果我以这种方式打印输出，一切都很好：

```
for ll in range(0,60):
    for k in range(1,73+3,3):
        if k==31 and ((ll+1)%15==0): 
            break                       
        else: 
            print oz[ll][k:k+3] 
```

我得到了正确的输出，数字 283, 283,... 但是如果我尝试将它们存储在列表中，则列表中的结果是错误的：

```
DU = []

# Populate DU array
for ll in range(0,2700):
    for k in range(1,73+3,3):
        if k==31 and ((ll+1)%15==0): 
            break                       
        else: 
            DU.append(oz[ll][k:k+3]) 
```

我在填写 DU 列表时做错了什么？

编辑：我更好地解释了我想要实现的目标：我有一个具有以下格式的 oz 列表：

```
[' 283283283283283283283283284284284284284284284284284284284284284284284284284\n', ' 284284284284284284284284284284284284284284284284284284284284284284284284284\n', ' 284284284284284284284284284284284284284284284284284284284284284284284284284\n', ' 284284284284284284284284284284284284284284284284284284284284284284284284284\n', ' 284284284284284284284284284284284284284284284284284284284284284284283283283\n', ' 283283283283283283283283283283283283283283283283283283283283283283283283283\n', ' 283283283283283283283283283283283283283283283283283283283283283283283283283\n', ' 283283283283283283283283283283283283283283283283283283283283283283283283283\n', ' 283283283283283282282283283282282282282283283283283283283283283283283283283\n', ' 283283283283283283283283283283283283283283283283283283283283283284284284284\n', ' 284284284284284284284284284284284285285285285285285285285285285285285285285\n', ' 285285286286286286286286286287287287287287287288288288288288288288288288288\n', ' 288289289289289289289289289290290290290290290290290290291291291291291291291\n', ' 291291292292292292292292293293293293293293293293293293293293294294294294294\n', ' 294294294294294294294294295295   lat =  -89.5\n', ' 284284284284284284284284284284284284284284284284284284284284284284284284284\n', ' 284284284284284284284284284284283283284284284284284284284284284284284284283\n', ' 283283283283283283283283283283283283283283283283283283283283283283283283283\n', ' 283283283283283283283283283283284284284284284284284284284284284284284284284\n', ' 284284284284284284284284284284284284283283283283283283283283283283283283283\n', ' 283283283283283283283283283283283282282282282282282282282282282282282282281\n', ' 281281281281281281281281281281281281281281281281280280280280280280280280279\n', ' 279279279279279279279279279279279279279279278278278278278278278278278278278\n', ' 277277278278278278278278278278278278278278278278278278278278278278278278278\n', ' 278278279279279279279279279279279279279279279279279279279279279279279279279\n', ' 279279280280280280280280280280280280280280280280280280280281281281281281281\n', ' 281282282282282282282282283283283283283283284284284284284284285285285285285\n', ' 286286286287287287287288288288288288288289289289289289290290290290291291291\n', ' 292292292292292292293293293293293293293293293294294294294295295295295295295\n', ' 296296296296296296296297297297   lat =  -88.5\n'] 
```

我需要的是用 ['283', '283', '283', '283'] 之类的数字三元组填写一个列表，记住每 15 行有一行带有“lat ...”文本，我想脱。我希望现在更清楚了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T20:02:17.380

您目前的代码似乎很难编码我不确定您要实现的目标，但请尝试：

```
DU = []

for index, line in enumerate(oz):

   line = line.strip() if (index +1) % 15 != 0 else line.strip().split(' ')[0]

   for i in range(0,len(line)-3,3):

      DU.append(line[i:i+3]) 
```

或者您可以尝试组合答案

```
 from itertools import izip

 def grouped(iterable, n):
      "s -> (s0,s1,s2,...sn-1), (sn,sn+1,sn+2,...s2n-1), (s2n,s2n+1,s2n+2,...s3n-1), ..."
      return izip(*[iter(iterable)]*n)

 DU = []

 for index, line in enumerate(oz):

        line = line.strip() if (index +1) % 15 != 0 else line.strip().split(' ')[0]

        DU.append(map(''.join, grouped(line.strip(), 3))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:35:39.143

您可能可以在我对另一个问题的回答中使用更新中的内容来[对](https://stackoverflow.com/a/4356415/355230)每个数字中的数字字符串进行分组。`n`具体使用此代码，将数字字符串作为可迭代对象，并将(group-size) 参数的值为 3 ：

```
from itertools import izip

def grouped(iterable, n):
    "s -> (s0,s1,s2,...sn-1), (sn,sn+1,sn+2,...s2n-1), (s2n,s2n+1,s2n+2,...s3n-1), ..."
    return izip(*[iter(iterable)]*n)

digits = '283283283283283283283283284284284284284284284284284284284284284284284284284\n'

print map(''.join, grouped(digits.strip(), 3)) 
```

输出：

```
['283', '283', '283', '283', '283', '283', '283', '283', '284', '284', 
'284', '284', '284', '284', '284', '284', '284', '284', '284', '284', 
'284', '284', '284', '284', '284'] 
```

但是，我注意到您示例中的最后一行数据是：

```
'294294294294294294294294295295 lat = -89.5\n' 
```

不仅仅是一串数字，因此必须将其作为特殊情况处理。

**更新：**

好的，既然我看到了您在问题中添加的附加信息，我可以根据`grouped()`我最初建议的其他答案中的功能为您提供完整的解决方案。这通过拆分每一行数据然后忽略除第一个（通常是唯一）之外的所有数据，它始终是一串数字，然后通过进一步处理我的功能。

```
from itertools import izip

def grouped(iterable, n):
    "s -> (s0,s1,s2,...sn-1), (sn,sn+1,sn+2,...s2n-1), (s2n,s2n+1,s2n+2,...s3n-1), ..."
    return izip(*[iter(iterable)]*n)

data = [' 283283283283283283283283284284284284284284284284284284284284284284284284284\n', ' 284284284284284284284284284284284284284284284284284284284284284284284284284\n', ' 284284284284284284284284284284284284284284284284284284284284284284284284284\n', ' 284284284284284284284284284284284284284284284284284284284284284284284284284\n', ' 284284284284284284284284284284284284284284284284284284284284284284283283283\n', ' 283283283283283283283283283283283283283283283283283283283283283283283283283\n', ' 283283283283283283283283283283283283283283283283283283283283283283283283283\n', ' 283283283283283283283283283283283283283283283283283283283283283283283283283\n', ' 283283283283283282282283283282282282282283283283283283283283283283283283283\n', ' 283283283283283283283283283283283283283283283283283283283283283284284284284\n', ' 284284284284284284284284284284284285285285285285285285285285285285285285285\n', ' 285285286286286286286286286287287287287287287288288288288288288288288288288\n', ' 288289289289289289289289289290290290290290290290290290291291291291291291291\n', ' 291291292292292292292292293293293293293293293293293293293293294294294294294\n', ' 294294294294294294294294295295   lat =  -89.5\n', ' 284284284284284284284284284284284284284284284284284284284284284284284284284\n', ' 284284284284284284284284284284283283284284284284284284284284284284284284283\n', ' 283283283283283283283283283283283283283283283283283283283283283283283283283\n', ' 283283283283283283283283283283284284284284284284284284284284284284284284284\n', ' 284284284284284284284284284284284284283283283283283283283283283283283283283\n', ' 283283283283283283283283283283283282282282282282282282282282282282282282281\n', ' 281281281281281281281281281281281281281281281281280280280280280280280280279\n', ' 279279279279279279279279279279279279279279278278278278278278278278278278278\n', ' 277277278278278278278278278278278278278278278278278278278278278278278278278\n', ' 278278279279279279279279279279279279279279279279279279279279279279279279279\n', ' 279279280280280280280280280280280280280280280280280280280281281281281281281\n', ' 281282282282282282282282283283283283283283284284284284284284285285285285285\n', ' 286286286287287287287288288288288288288289289289289289290290290290291291291\n', ' 292292292292292292293293293293293293293293293294294294294295295295295295295\n', ' 296296296296296296296297297297   lat =  -88.5\n']

DU = []
for line in data:
    DU.extend(map(''.join, grouped(line.strip().split()[0], 3)))

print DU 
```

输出：

```
['283', '283', '283', '283', '283', '283', '283', '283', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '282', '282', '283', '283', '282', '282', '282', '282', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '285', '285', '285', '285', '285', '285', '285', '285', '285', '285', '285', '285', '285', '285', '285', '285', '286', '286', '286', '286', '286', '286', '286', '287', '287', '287', '287', '287', '287', '288', '288', '288', '288', '288', '288', '288', '288', '288', '288', '288', '289', '289', '289', '289', '289', '289', '289', '289', '290', '290', '290', '290', '290', '290', '290', '290', '290', '291', '291', '291', '291', '291', '291', '291', '291', '291', '292', '292', '292', '292', '292', '292', '293', '293', '293', '293', '293', '293', '293', '293', '293', '293', '293', '293', '294', '294', '294', '294', '294', '294', '294', '294', '294', '294', '294', '294', '294', '295', '295', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '283', '283', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '284', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '283', '282', '282', '282', '282', '282', '282', '282', '282', '282', '282', '282', '282', '282', '281', '281', '281', '281', '281', '281', '281', '281', '281', '281', '281', '281', '281', '281', '281', '281', '281', '280', '280', '280', '280', '280', '280', '280', '280', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '277', '277', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '278', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '279', '280', '280', '280', '280', '280', '280', '280', '280', '280', '280', '280', '280', '280', '280', '280', '280', '280', '281', '281', '281', '281', '281', '281', '281', '282', '282', '282', '282', '282', '282', '282', '283', '283', '283', '283', '283', '283', '284', '284', '284', '284', '284', '284', '285', '285', '285', '285', '285', '286', '286', '286', '287', '287', '287', '287', '288', '288', '288', '288', '288', '288', '289', '289', '289', '289', '289', '290', '290', '290', '290', '291', '291', '291', '292', '292', '292', '292', '292', '292', '293', '293', '293', '293', '293', '293', '293', '293', '293', '294', '294', '294', '294', '295', '295', '295', '295', '295', '295', '296', '296', '296', '296', '296', '296', '296', '297', '297', '297'] 
```

你可以像这样做出一个有效的、相当不可读的列表理解：

```
from itertools import chain

DU = list(chain.from_iterable(map(''.join, grouped(line.strip().split()[0], 3))
                                             for line in data)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T22:03:24.573

如何使用正则表达式匹配 3 个连续数字的集合：

```
import re

def oz_reader(oz):
    for line in oz:
        matches = re.findall(r"\d{3}", line)
        for num in matches:
            yield num 
```

请注意，该函数返回一个生成器，而不是一个列表。如果您真的需要一个带有输出的列表，只需`list`在其上使用构造函数：

```
result_list = list(oz_reader(oz)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T08:12:04.713

谢谢大家的回复，代码实际上运行良好，我在程序的另一部分遇到了问题，我只是累了，但感谢你为这段代码提供的不同可能性！

# design-patterns - 哪种设计模式更好？

> ID：12165914
> 
> 赞同：3
> 
> 时间：2012-08-28T19:11:16.623
> 
> 标签：design-patterns

当编写一个带有 2 个对象作为参数的函数时，比如比较函数或向量求和，哪种设计模式更好？

1）在objects类里面写函数，只获取第二个object。

2）用静态函数编写一个外部类，这将获得两个对象。

为什么和何时？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T19:16:49.863

在 Java 中，您可以[`Comparable.compareTo(o1)`](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html#compareTo%28T%29)代表一个对象执行它并将第二个对象作为参数：

```
apple.compareTo(orange); 
```

还有[`Comparator.compare(o1,o2)`](http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html#compare%28T,%20T%29)抽象：

```
comparator.compare(apple, orange); 
```

它们都没有被弃用，也没有一个被认为是更好的。它们都用于不同的场景：

*   如果水果有固定的、自然的“顺序”，把它放在`Fruit`课堂上
*   如果有多种不同的方法可以通过（大小、重量、颜色、味道）来比较水果，请使用多个比较器并一次使用您需要的任何一个。

您甚至可以将它们组合起来：`Fruit`只要默认顺序适合您，您就可以使用默认顺序（在内部编码）。如果有一天您需要不同的订单，请选择特定的比较器。

我相信这适用于其他类似的情况和语言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:15:28.050

恕我直言，来自 .NET 背景：**如果任何对象可能为空，请使用静态方法。**

如果第一个（左对象）一定是非空的，并且您希望继承类能够提供它们自己的相等方法的实现，请使用实例方法。

# php - 比较两个表在 printf 中都返回

> ID：12165917
> 
> 赞同：0
> 
> 时间：2012-08-28T19:11:26.097
> 
> 标签：php, compare, printf

我有这个代码：

```
{
$result = mysql_query("SELECT * FROM comments  ORDER BY date DESC");      
$myrow = mysql_fetch_array($result);

do
{

printf ("
                            <li class=''>               
                    <span class='author'>%s | %s</span>
                    <span class='title'>%s</span>
                    <a href='%s' class='website' title='%s'>Open</a>
                </li>

",$myrow["author"],$myrow["date"],$myrow["title"],$myrow["id"],$myrow["title"],$myrow["link"]);
}

while ($myrow = mysql_fetch_array($result));

} 
```

这给了我来自评论表的数据。在评论表中有一个名为：postid 的字段。如何使用另一个查询来比较评论表和新闻表？在新闻表 WHERE id=$myrow["postid"] 中。在我比较并获得新闻标题之后。如何在我的代码中将该标题放在 printf 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:22:04.820

**这不是答案，而是您在上面写的内容的更清洁的替代品。请不要投票。**

```
$result = mysql_query("SELECT * FROM comments  ORDER BY date DESC");
$myrow  = mysql_fetch_array($result);
while($myrow = mysql_fetch_array($result)) {
    echo "
        <li class=''>
            <span class='author'>{$myrow['author']} | {$myrow['date']}</span>
            <span class='title'>{$myrow['title']}</span>
            <a href='{$myrow['id']}' class='website' title='{$myrow['title']}'>Open</a>
        </li>";
} 
```

**另请注意**，`mysql_*`不推荐使用功能。PHP 有替代方案：`mysqli`和`PDO`. 如果您不确定要使用哪一个，[请阅读这篇文章](http://www.deprecatedphp.com/mysql_/)。

# python - Python 单元测试 - 比较 Python < 2.7 中可迭代的内容

> ID：12165920
> 
> 赞同：0
> 
> 时间：2012-08-28T19:11:29.903
> 
> 标签：python

如何检查自定义类数组是否按我想要的顺序排序？我知道在 Python 2.7 及更高版本中有 assertSequenceEqual，但我使用的是 Python 2.6，虽然我可以使用 forloop 来做到这一点......在 Python < 2.7 中有更好的东西我可以使用吗？

```
 actual_sorted = list.sort()

  expected_sorted = [MyClass("wed", 20), 
                     MyClass("wed", 19,),
                     MyClass("thu", 18,),
                     MyClass("wed", 17,)]

  self.assertEqual(actual_sorted, expected_sorted) # Well, this doesn't work. 
```

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:27:14.140

正如 BrenBarn 所说，您必须添加一个`__eq__`方法。在看到他的答案之前，我正在并行编写一个完整的示例：

```
import unittest

class MyClass(object):
    def __init__(self, day_name, day_num):
        self.day_name = day_name
        self.day_num = day_num

    def __eq__(self, other):
        return other.day_name == self.day_name and other.day_num == self.day_num

class ATestCase(unittest.TestCase):
    def test_foo(self):
        actual_sorted = [MyClass("wed", 20),
                           MyClass("wed", 19),
                           MyClass("thu", 18),
                           MyClass("wed", 17)]

        expected_sorted = [MyClass("wed", 20),
                           MyClass("wed", 19),
                           MyClass("thu", 18),
                           MyClass("wed", 17)]
        self.assertEqual(actual_sorted, expected_sorted)

if __name__ == '__main__':
    unittest.main() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:24:27.913

```
from operator import eq as equals
self.assertTrue(all(map(equals,actual_sorted, expected_sorted))) 
```

这将逐个元素地测试相等性。当然，`equals`如果您不希望`__eq__`在相关类上定义 an，您可能需要自己定义（而且您可能不想这样做，因为定义 an`__eq__`可能会改变程序的行为以及单元测试）。

# performance - 谷歌页面速度洞察结果不一致

> ID：12165921
> 
> 赞同：1
> 
> 时间：2012-08-28T19:11:32.100
> 
> 标签：performance, pagespeed, web-optimization

有人可以向我解释为什么谷歌使用他们自己的服务页面速度洞察结果与 api 给我不同的结果吗？[该站点使用](http://www.burro.se)[在线工具](https://developers.google.com/speed/pagespeed/insights#url=http_3A_2F_2Fwww.burro.se&mobile=false)得分 100/100，但使用[命令行](https://developers.google.com/speed/docs/insights/v1/getting_started#example_commandline)测试同一站点时，它仅得分 99/100？我知道这没什么大不了的，我不想得分 100/100，但我只是好奇为什么他们会从同一个服务中给出两个不同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T22:55:21.977

基于新数据或基础算法的改进，PageSpeed 规则和每个规则的权重一直在变化。在不同的时间点，在线工具和 API 可能使用略有不同的版本——要么是因为不同步，要么是我们正在试验一组不同的规则。因此存在差异。这也适用于 FF 和 Chrome 的 PageSpeed 扩展。

# django - 如何访问 Django 的 field.choices？

> ID：12165924
> 
> 赞同：60
> 
> 时间：2012-08-28T19:11:39.347
> 
> 标签：django, django-models

有没有办法（不使用表单）访问模型字段选择值？

我想做类似的事情`field.choices`并在视图或模板中获取值列表。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-08-28T20:05:22.783

当然。只需访问`choices`Model 字段的属性：

```
MyModel._meta.get_field('foo').choices
my_instance._meta.get_field('foo').choices 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-29T04:33:25.367

如果您要这样声明您的选择：

```
class Topic(models.Model):

    PRIMARY = 1
    PRIMARY_SECONDARY = 2
    TOPIC_LEVEL = ((PRIMARY, 'Primary'),
                  (PRIMARY_SECONDARY, 'Primary & Secondary'),)

    topic_level = models.IntegerField('Topic Level', choices=TOPIC_LEVEL,
            default=1) 
```

这真的是一个很好的方法。见：[http ://www.b-list.org/weblog/2007/nov/02/handle-choices-right-way/](http://www.b-list.org/weblog/2007/nov/02/handle-choices-right-way/)

然后你可以简单地取回选择`Topic.TOPIC_LEVEL`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-28T19:18:55.617

我认为您正在寻找`get_fieldname_display()`功能。

# clang-static-analyzer - Clang scan-build 没有在非 ARC 文件上拾取 -fno-objc-arc 标志

> ID：12165925
> 
> 赞同：1
> 
> 时间：2012-08-28T19:11:44.650
> 
> 标签：clang-static-analyzer

嗨，我有一个 XCode 项目，它是 ARCd，但使用了一些不是 ARCd 的第 3 方（AFNetworking）类。我已经针对这些文件指定了 -fno-objc-arc 标志，但是当我运行 scan-build 时，我得到了许多错误，例如：-

```
error: 'autorelease' is unavailable: not available in automatic reference counting mode 
```

在编译/检查这些不正确的类时，我可以看到 scan-build 正在使用 -fobjc-arc。

请有人建议我如何获得扫描构建以获取正确的设置？

仅供参考，我使用的是从[http://clang-analyzer.llvm.org/下载的 checker-267 版本](http://clang-analyzer.llvm.org/)

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T20:33:12.303

向 Apple 的 clang 团队提出了这个问题，他们很快就回来说这是一个已知的错误，请参阅：

[http://llvm.org/bugs/show_bug.cgi?id=13683](http://llvm.org/bugs/show_bug.cgi?id=13683)

应尽快发布新版本的检查器来解决此问题。

# css - 在样式表中将默认的基于文本的颜色代码更改为自定义 HEX

> ID：12165926
> 
> 赞同：2
> 
> 时间：2012-08-28T19:11:49.800
> 
> 标签：css

是否可以在样式表中定义默认文本颜色代码

例如：我在整个网站上都使用这种颜色，我讨厌打字。颜色：#27408B;

相反，我想要做的是将默认文本 blue 定义为 color:#27408B;

所以我可以输入border:1px solid blue；它会出现边框：1px solid #27408B;

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:15:16.063

You can use preprocessors like:

> LESS: [http://lesscss.org/](http://lesscss.org/)

or

> Sass: [http://sass-lang.com/](http://sass-lang.com/)

For example in LESS you can do this:

```
@color: #4D926F;

#header {
  color: @color;
}
h2 {
  color: @color;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:13:49.807

您想要做的事情可以通过使用 CSS 预处理器来完成。[LESS](http://lesscss.org/)、[Sass](http://sass-lang.com/)和[Stylus](http://learnboost.github.com/stylus/)是其中一些比较著名的。预处理器允许您创建变量、mixin、函数等，以帮助简化您的工作。

要创建一个变量，您需要做的就是在样式表中相应地声明它：

```
@blue = "#27408b" 
```

在上面的示例中，**@blue**是新变量的名称，而引号之间的值是**@blue**此后的真实值。

```
body {background: @blue;} /* your background will be the color #27408b */
a {color: @blue;} /* your link will be the color #27408b */
div {border: 1px solid @blue;} /* your 1px border will be the color #27408b */ 
```

# c - 访问 char 指针的不同方法有什么功能差异吗？

> ID：12165932
> 
> 赞同：3
> 
> 时间：2012-08-28T19:12:21.687
> 
> 标签：c, char

出于某种原因，我正在查看的代码有很多类似的东西

`char tmp[4];`

`memcpy(&tmp[0],foo_pointer,bar_size)`

我本来希望只是

`char tmp[4];`

`memcpy(tmp,foo_pointer,bar_size)`

我在第一种方式写它时有什么原因吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T19:15:09.600

将数组传递给函数会导致数组衰减为指向其第一个元素的指针，因此两种调用方式都是等效的

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T19:14:28.443

不，他们是平等的。

即使没有定义，前者可能更清楚`tmp`。

（为了让这个答案完整，为什么会这样，这是标准后期草案中有趣的一点：）

> (6.3.2.1p3) 除非它是运算`sizeof`符、运算符`_Alignof`或一元`&`运算符的操作数，或者是用于初始化数组的字符串字面量，否则类型为“array of *type* ”的表达式将转换为表达式类型“pointer to *type* ”指向数组对象的初始元素，不是左值。如果数组对象具有寄存器存储类，则行为未定义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T19:15:03.830

这只是风格上的不同。有些人倾向于表达他们传递给函数的值是*指针*，因此他们`&`在数组的第一个元素上使用 (addressof) 运算符。但是，这与传递数组本身相同，因为数组只能使用地址传递。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T19:17:42.980

它们是等价的，但第一个会提醒未来的读者这`tmp`是一个数组，而后者可能不会使这种区别很明显。

`tmp`当且仅当人们已经知道这是一个数组时，后者更容易阅读。否则，它更有可能误导人们将其`tmp`视为其他事物。把它归咎于在简单变量之后引入数组，或者任何你想归咎于它的东西；但是，没有额外修饰的变量通常被新手视为简单类型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-28T19:36:17.443

注意到写作可能很有用

```
&tmp[0] 
```

是多余的。它相当于

```
&(*(tmp + 0)) 
```

所以意思是：取tmp，加0，得到tmp+0指向的值，得到tmp+0指向的值的地址。也就是说，你在做无用的操作。

只需写“tmp”。

# html - 多分辨率图标

> ID：12165941
> 
> 赞同：6
> 
> 时间：2012-08-28T19:13:04.160
> 
> 标签：html, favicon

tutorialworld 中的每个人似乎都痴迷于创建多分辨率 .ico 以用作网站图标。然而，我的问题是浏览器对这些多分辨率 .ico 的支持是什么样的。常见的浏览器（Chrome、FF、Safari 和 IE7+）会以某种理智的方式处理包含两种分辨率（16x16 和 32x32）的 .ico 吗？共识似乎是大于 32x32 开始膨胀文件大小而没有提供太多好处（除了 IE9/Windows 7 以及他们对 64x64 图像所做的任何事情），至少。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:45:43.867

维基百科上有很多相当好的信息，但不是关于尺寸支持的具体信息：

[http://en.wikipedia.org/wiki/Favicon](http://en.wikipedia.org/wiki/Favicon)

但是，我认为大多数 Web 浏览器都没有超过 16x16 的图标的用例。我当然没有见过大图标，但我并不感到惊讶，因为大图标往往会扩展 url 栏、书签和标签，以至于它们占用了令人望而却步的垂直屏幕空间。我不会打扰，直到你知道它会在某个地方被使用并决定带宽是值得的。

要研究的一件事是它们是否被低视力用户的任何辅助功能使用（这是有道理的），但这里的屏幕截图（例如）：

[http://www.accessfirefox.org/Firefox_Accessibility_Themes.php](http://www.accessfirefox.org/Firefox_Accessibility_Themes.php)

尽管字体大小增加，但似乎显示相同的旧 16x16 图标。我怀疑人们不能依赖 32x32 分辨率的存在这一事实意味着没有人花时间编写代码来寻找它。

据我了解，此图标的多分辨率功能旨在针对“其他上下文”中的重用，例如[Prism](https://mozillalabs.com/en-US/prism/)（已失效）或[Air](http://www.adobe.com/products/air.html)（专有）

# sql - 学习如何编写复杂的存储过程

> ID：12165942
> 
> 赞同：1
> 
> 时间：2012-08-28T19:13:04.137
> 
> 标签：sql, sql-server, database, stored-procedures, database-administration

我正在寻找关于编写复杂存储过程以及 DBA 常用的常见技巧和最佳实践的好书和教程。

我通常只找到基本的 SQL 语句教程，我需要一些复杂数据选择的好例子，以及如何正确有效地过滤数据以在多个表之间进行选择的常见技巧。

我发布这个很难找到，因为复杂数据库通常只在大型项目中构建，而不是用于教程，但至少我想找到 DBA 应用的常用方法

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T04:30:15.177

您可以使用以下站点下载有关 SQL Server 复杂存储过程的电子书：

[1- SQL 中的复杂存储过程](http://www.ebooksdownloadfree.com/download/complex-stored-procedure-in-sql-1.html)

[2- 存储过程](http://www.ebooksdownloadfree.com/download/stored-procedures-1.html)

[3-谷歌电子书](http://books.google.com/books/about/Microsoft_SQL_Server_2005_Stored_Procedu.html?id=qf7Wuhnq3ZQC)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:47:44.493

有很多站点，但我发现[这个站点](http://blog.sqlauthority.com/author/pinaldave/)对我的 SQL Server 学习很有帮助。对于数据库开发人员来说，这是一个非常有用的网站。如果您想阅读书籍，那么您可能可以从 Microsoft 出版社中挑选。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T19:51:10.637

你应该看看[Ken Henderson 的 The Guru's Guide To Transact SQL](https://rads.stackoverflow.com/amzn/click/com/0201615762)，有点老了，但可能仍然是关于 T-SQL 的最好的书 :)

# javascript - 如何从 NPAPI 插件向 javascript 代码发送通知？

> ID：12165950
> 
> 赞同：0
> 
> 时间：2012-08-28T19:13:33.293
> 
> 标签：javascript, google-chrome, notifications, npapi

从我的角度来看，它应该是 javascript 端的一些代码，在 NPAPI 插件中设置回调函数。在 NPAPI 方面，应该以某种方式调用此回调函数，从而将通知从 NPAPI 发送到 javascript。

我正在尝试为 Chrome 浏览器执行此操作，但它应该适用于任何支持 NPAPI 的浏览器。简短的 NPAPI 和 javascript 代码示例将非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T04:38:22.650

我没有适合您的工作代码示例，但实现起来并不难。[FireBreath](http://firebreath.org)做的方式基本上是自己实现 addEventListener 和 removeEventListener；回调函数将作为 NPObject（在 NPVariant 内）出现，您只需使用所需参数在 NPObject 上调用 NPN_InvokeDefault 即可触发该回调。

这实际上并不像真正的 javascript 事件，但对于大多数用途来说它已经足够接近了。

当然，您也可以使用任何接受 NPObject 作为参数之一的方法，并以这种方式使用它来进行回调。

您可以在 FireBreath 代码库中找到示例代码，但为了简单和干燥，它被抽象了一点。

# java - 将日志文件编组为 xml 文件 - Java

> ID：12165960
> 
> 赞同：1
> 
> 时间：2012-08-28T19:13:52.377
> 
> 标签：java, xml

我有一个带有以下输出的日志文件：

```
2226:org.powertac.common.TariffSpecification::6::new::1::CONSUMPTION
2231:org.powertac.common.Rate::7::new
2231:org.powertac.common.Rate::7::withValue::-0.5
2232:org.powertac.common.Rate::7::setTariffId::6
2232:org.powertac.common.TariffSpecification::6::addRate::7
2233:org.powertac.common.Tariff::6::new::6
2234:org.powertac.common.TariffSpecification::8::new::1::INTERRUPTIBLE_CONSUMPTION
2234:org.powertac.common.Rate::9::new
2234:org.powertac.common.Rate::9::withValue::-0.5
2235:org.powertac.common.Rate::9::setTariffId::8 
```

解析文件后，具有以下模式：

```
<id>:<full_classname>::<order_of_execution>::<new_or_method>::<params> 
```

解析器工作得很好，并且符合我的期望。现在，我的目标是将相同的指令编组到`XML`文件中。我对这种任务完全不熟悉。因此，`XML`必须同时包含`new`对象和`methods`调用。我知道使用`Reflection`API`<full_classname>`来创建该类的对象：

```
Class<?> cl = Class.forName( className ); 
```

我怎么能从那个对象生成这样`XML`的文件？`Class`我是否必须有一个数据结构或一种方法来获取对象的所有方法和字段并将它们写入 xml 文件？我知道反射 API 有这样的方法，但我需要一个更通用/示例的想法来了解如何完成我的任务。我开始写下这个方法，但我不确定它是如何工作的：

```
// would send in the object to be marshalled. 
public void toXML(Object obj){
        try {
            JAXBContext context = JAXBContext.newInstance(Object.class);
            Marshaller m  = context.createMarshaller();
            m.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);

        } catch (JAXBException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    } 
```

以下是已解析文件的示例：

```
171269 org.powertac.common.Order 171417 new 4
171270 org.powertac.common.Order 171418 new 4
171271 org.powertac.common.Order 171419 new 4 
```

该`parse`方法如下所示：

```
public void parse() throws ClassNotFoundException{
    try{
        //
        // assure file exists before parsing
        //
        FileReader fr = new FileReader( this.filename );
        BufferedReader textReader = new BufferedReader( fr );
        String line;
        File input = new File("test.xml");
        //Integer id = 1;
        while(( line = textReader.readLine()) != null ){
            Pattern p = Pattern.compile("([^:]+):([^:]+)::([\\d]+)::([^:]+)::(.+)");
            Matcher m = p.matcher( line );
            if (m.find()) {
              int id = Integer.parseInt(m.group(1));
              String className = m.group(2);
              int orderOfExecution = Integer.valueOf( m.group( 3 ));
              String methodNameOrNew = m.group(4);
              String[] arguments = m.group(5).split("::");
              //
              // there is the need to create a new object
              //
              if( methodNameOrNew.compareTo( "new" ) == 0 ){
                  //
                  // inner class
                  //
                  if( className.contains("$") == true){
                      continue;

                  }
                  else if( className.contains("genco")){
                      continue;
                  }
                  System.out.println("Loading class: " + className);
                  LogEntry le = new LogEntry(id, className, orderOfExecution, methodNameOrNew, arguments.toString());

                  Serializer ser = new Persister();
                  ser.write(le, input);
                  id++;
                  System.out.printf("%s %s %d %s %d\n", id, className, orderOfExecution, methodNameOrNew, arguments.length);
              }

        }

        }
        textReader.close();
    }
    catch( IOException ex ){
        ex.printStackTrace();
    }
    catch( ArrayIndexOutOfBoundsException ex){
        ex.printStackTrace();
    } catch (SecurityException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IllegalArgumentException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (InstantiationException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IllegalAccessException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

}

public void write() throws Exception{
        File file = new File("test.xml");
        Serializer ser = new Persister();
        for(LogEntry entry : entries){
            ser.write(entry, file);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T21:01:40.540

**日志条目：**

```
@Default()
public class LogEntry
{
    private int id;
    private Object classInstance;
    private int orderOfExecution;
    private String newOrMethod;
    private List<Object> args;

    public LogEntry(int id, Object classInstance, int orderOfExecution, String newOrMethod, List<Object> args)
    {
        this.id = id;
        this.classInstance = classInstance;
        this.orderOfExecution = orderOfExecution;
        this.newOrMethod = newOrMethod;
        this.args = args;
    }

    public LogEntry() { }

    // getter / setter / toString / ... here

} 
```

**解析方法：**

```
// Here all entries are saved
private List<LogEntry> entries = new ArrayList<>();

// ...

public void parse() throws Exception
{
    // Don't compile this in a loop!
    Pattern p = Pattern.compile("([^:]+):([^:]+)::([\\d]+)::([^:]+)::(.+)");

    FileReader fr = new FileReader(this.filename);
    BufferedReader textReader = new BufferedReader(fr);
    String line;

    while( (line = textReader.readLine()) != null )
    {
        Matcher m = p.matcher(line);

        if( m.find() )
        {
            LogEntry entry = new LogEntry();
            entry.setId(Integer.valueOf(m.group(1)));

            String className = m.group(2);

            entry.setOrderOfExecution(Integer.valueOf(m.group(3)));

            String methodNameOrNew = m.group(4);
            entry.setNewOrMethod(methodNameOrNew); // required in LogEntry?

            Object[] arguments = m.group(5).split("::");
            entry.setArgs(Arrays.asList(arguments));

            if( methodNameOrNew.equals("new") )
            {
                if( className.contains("$") == true  || className.contains("genco") )
                    continue;

                createInstance(className, arguments);
            }
            else
            {
                callMethod(className, methodNameOrNew, arguments);
            }

            // XXX: for testing - set the instance 'not null'
            entry.setClassInstance("only for testing");
            entries.add(entry);
        }
    }
    textReader.close();
} 
```

* * *

**编辑：**

假设您的 parse()-Method、List 等在 Class 中`Example`：

```
@Root
public class Example
{
    private File filename = new File("test.txt");
    @ElementList
    private List<LogEntry> entries = new ArrayList<>();

    // ...

    // Only 'entries' is annotated as entry -> only it will get serialized
    public void storeToXml(File f) throws Exception
    {
        Serializer ser = new Persister();
        ser.write(this, f);
    }

    public void parse() throws Exception
    {
        // ...
    }
} 
```

注意：对于我在`entry.setClassInstance("only for testing");`上面添加的这个例子`entries.add(...)`，否则实例是`null`.

* * *

**编辑#2：** parse() 的辅助方法

```
private Object createInstance(String className, Object args[])
{
    // TODO
    return null;
}

private void callMethod(String className, String methodName, Object args[])
{
    // TODO
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:27:26.717

这是使用[简单 XML](http://simple.sourceforge.net/)库的第一次尝试：

```
@Default()
public class LogEntry
{
    private int id;
    private Object classInstance;
    private String orderOfExecution;
    private String newOrMethod;
    private String params;

    // throws 'Exception' only for testing
    public LogEntry(int id, String className, String orderOfExecution, String newOrMethod, String params) throws Exception
    {
        this.id = id;
        this.classInstance = Class.forName(className).newInstance();
        this.orderOfExecution = orderOfExecution;
        this.newOrMethod = newOrMethod;
        this.params = params;
    }

    // getter / setter 
} 
```

以及如何使 XML 脱离类`LogEntry`：

```
// Here is an example of an entry
LogEntry le = new LogEntry(3, "com.example.MyClass", "abc", "def", "ghi");

Serializer ser = new Persister();
ser.write(le, new File("test.xml")); 
```

简单 XML 非常易于使用，请参阅此处获取[教程](http://simple.sourceforge.net/download/stream/doc/tutorial/tutorial.php)和[示例](http://simple.sourceforge.net/download/stream/doc/examples/examples.php)。您可以使用 LogEntry 类中的注释自定义整个 XML，但是您也可以让`@Default()`一切为您做 :-)

# ios - 在决定要开发的 iOS 版本时应考虑哪些因素？

> ID：12165963
> 
> 赞同：2
> 
> 时间：2012-08-28T19:14:10.260
> 
> 标签：ios

我目前正处于开发 iOS 应用程序的计划阶段，我需要决定支持哪些版本。这是我的第一个应用程序，我倾向于使用 iOS 5。该应用程序将从网络中提取大部分数据，并且不会占用大量处理器。我主要担心的是，如果我为 iOS 5 或 6 开发，有些人将无法使用它。那么在做这个决定时应该考虑哪些因素呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T19:25:13.340

Apple 已经从 Mountain Lion 上使用的任何 Xcode 版本中删除了 iOS 4 模拟器，并且很可能即将完全放弃对 iOS 4 的支持。这是推测，但基于以下事实：

*   每当 iOS 6 出现时，iOS 4 可能已经快两年了；
*   iOS 4.3 放弃了对 ARMv6 设备的支持，因此继续允许构建 4.3 之前的版本会增加开发人员工具的大量维护成本；
*   iOS 4 对自动引用计数的支持较少，这几乎是一项基本功能。

这些事情不会提前公布，总有一天会有人拨动开关。

我还认为，如果您是新手，那么 iOS 4 值得避免，因为它缺少：

*   故事板；和
*   一个内置的 JSON 解析器。

前者是设计用户界面的一种更简单的方法，而后者可能是您解码网络结果所需要的，从统计上讲。

所以我会投票给 iOS 5。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:16:58.910

您应该开发尽可能低的版本，同时考虑性能要求和新版本中可能存在的任何必要功能。如果您想使用 iOS5 和 6 功能，但它们对于您的应用程序的基本功能不是必需的，您仍然可以定位 4 并针对这些功能进行条件检查以查看它们是否可供您使用。

您故意选择更高版本的主要原因之一是故意省略不支持它的设备（iPhone 3g 或更低版本和 iPad 第一代）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T19:18:07.770

1）您需要支持早期版本的iOS吗？如果你这样做了，你必须注意不要使用在你的部署目标之前发布的 API（也就是你要支持的较低版本）。

2）如果您不需要/不想支持早期版本，Apple 表示您应该始终以更高的 iOS 版本为目标，这样您就可以使用最新的 API……有些东西是您无法使用的较旧的 API。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T19:19:13.797

您希望您的应用在哪些设备上运行？如果您希望您的应用程序在较旧的设备上运行，这将影响您开发的 iOS。

此外，这里还有一张 iOS 版本使用统计图表。这将有助于决定支持什么和忽略什么。[iOS 版本使用统计](http://socialbarrel.com/statistics-show-quick-adoption-rate-of-apple-ios-5-1/34429/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-28T19:24:09.433

确实，许多用户不会完全了解当前版本的 iOS。但是，这个数字非常小。典型用户不会立即升级到最新版本，但他们通常会在 1 个月内转换。

不升级的用户非常具体。越狱用户是我能想到的最大的社区，他们通常必须等待才能升级他们的 iOS 版本。其他用户将是那些使用旧设备（例如 iPhone 2g 和 3g）的用户，新版本的 iOS 不支持这些设备。

考虑到这一点，建议始终为最高版本号编程。该代码将是最维护和最持久的。较低版本的编程通常涉及许多困难的工作，这些工作在较新版本的 iOS 中很容易完成。此外，无论何时出现新版本（想想 iOS 7、8、22？），您都必须确保您的旧代码仍然适用于新版本。这意味着您将需要访问安装了该版本的设备。

总而言之，大多数用户将使用最新版本的 iOS。

# sql - 选择if else sql

> ID：12165972
> 
> 赞同：-1
> 
> 时间：2012-08-28T19:14:49.067
> 
> 标签：sql

我有两张桌子说`T1`，`T2`一列`C`是两者共同的。我需要一个 SQL 查询，如果在其中`C`，`null`它将`T1`从其他表中进行选择。

我尝试`SELECT`在子句中写语句`THEN`但没有运行。不知道`IF ELSE`SQL中有没有子句。

```
Select C, case when c = null Then Select c from T2
from T1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T19:17:53.283

更好的是，大多数 RDBMS 都支持`COALESCE`，它允许您检查多个值并返回第一个非空值。

```
SELECT COALESCE(T1.C, T2.C) AS C
FROM T1
LEFT OUTER JOIN T2 ON T1.[Primary Key] = T2.[Primary Key] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:18:48.663

你似乎需要的是一个工会

```
select c from t1
where c is not null
union
select c from t2
where c is not null 
```

`C`现在，您从一个结果集中获取所有列`T1`，`T2`但前提是不为空。

当然，如果这过于简化了您的问题，您需要使用 join

```
 select coalesce(t1.c,t2.c) as c
      from t1
 left join t2 on (t2.id = t1.foreign_id) 
```

这假设`T2.ID`是主键并且`T1`与`T1.FOREIGN_ID`

进行左连接很重要，否则只有`T1`当行也存在于`T2`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T19:23:39.943

这是在 TransactSQL 中吗？

我喜欢第一个答案，但是您也可以这样做...

```
select case t1.C
    when null then t2.C
    else t1.C
    end as [testC]
from t1
inner join t2
on t1.PKID = t2.PKID 
```

# java - Java - 图像旋转

> ID：12165977
> 
> 赞同：10
> 
> 时间：2012-08-28T19:14:56.140
> 
> 标签：java, image, graphics, rotation, bufferedimage

我正在尝试旋转图像。我正在使用这个 Java 代码：

```
BufferedImage oldImage = ImageIO.read(new FileInputStream("C:\\workspace\\test\\src\\10.JPG"));
BufferedImage newImage = new BufferedImage(oldImage.getHeight(), oldImage.getWidth(), oldImage.getType());
Graphics2D graphics = (Graphics2D) newImage.getGraphics();
graphics.rotate(Math.toRadians(90), newImage.getWidth() / 2, newImage.getHeight() / 2);
graphics.drawImage(oldImage, 0, 0, oldImage.getWidth(), oldImage.getHeight(), null);
ImageIO.write(newImage, "JPG", new FileOutputStream("C:\\workspace\\test\\src\\10_.JPG")); 
```

但我看到了奇怪的结果：

来源：

![**源图片：**](../Images/01f656737281b5f3171e3c23a9bd4cb9.png)

结果：

[![**结果图片：**](../Images/fd5bb4abfa2ba3a3f18521e26a699569.png)](https://i.stack.imgur.com/Hfoin.jpg)

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-28T19:29:49.930

切换图像的宽度和高度是不够的。您正在使用图像的中心作为旋转原点进行旋转。只需在一张纸上尝试相同的操作，您就会发现它的工作方式相同。您还必须稍微移动纸张，这意味着应用变换来解决此问题。因此，在轮换调用之后，立即执行以下操作：

```
 graphics.translate((newImage.getWidth() - oldImage.getWidth()) / 2, (newImage.getHeight() - oldImage.getHeight()) / 2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:25:04.003

由于旋转，新图像具有不同的大小。试试这个： BufferedImage newImage = new BufferedImage( oldImage.getWidth(),oldImage.getHeight(),oldImage.getType());

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T19:29:02.420

尝试获取您在其上进行绘图的面板的范围

```
Rectangle rect = this.getBounds(); 
```

然后做：

```
graphics.rotate(Math.toRadians(90), (rect.width - newImage.getWidth()) / 2, (rect.height - newImage.getHeight()) / 2); 
```

希望可以帮助干杯！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T18:16:51.023

你可以这样写它会工作。

```
BufferedImage newImage = new BufferedImage(oldImage.getWidth(), oldImage.getHeight(), oldImage.getType()); 
```

我认为您的代码中的位置`width`和`height`错误。

# jquery - Possible "Transparent Film" effect in jQuery? I'm stumped

> ID：12165985
> 
> 赞同：0
> 
> 时间：2012-08-28T19:15:20.127
> 
> 标签：jquery, html, css, slideshow, carousel

OK, I'm in a real pickle here friends, and I need some help.

I have a website I am working on for a client of our company, but at the top of the page it involves a jQuery slideshow/infinite carousel mix that shows the CURRENT image in-between a 19-ish pixel white border on both sides and the other pieces of the carousel are supposed to be hidden under and behind a blue overlay.

When the client clicks the previous/next arrow (currently base text links that I'm going to re-position after I get this POS taken care of), the current image that is shown in the middle of the carousel on the page is supposed to slide to the left UNDER the white border and INTO the blue overlay (kind of like a transparent film effect, if you will).

Well, I'm STUMPED as to how I can get the image to slide under the border and overlay a color on top of it, ALL DYNAMICALLY without fading the entire image at once while moving to the left. It's supposed to be a super-smooth transition.

This is ULTIMATELY what it's SUPPOSED to look like:

[http://www.powellcreative.com/clients/StansellHealth/images/help.png](http://www.powellcreative.com/clients/StansellHealth/images/help.png)

This is what it looks like right now:

[http://www.powellcreative.com/clients/StansellHealth/](http://www.powellcreative.com/clients/StansellHealth/)

Mind the crudeness of the current look and feel, it's still in the base development stages from the PSD, but this stumps me. Please help

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:26:39.617

我创建了一个非常快速但不起作用的示例来向您展示可以使用的技术：

[http://jsfiddle.net/gdgKQ/1/](http://jsfiddle.net/gdgKQ/1/)

基本上，您想使用两个绝对定位、部分透明的 div 在您正在使用的合成中创建电影效果。如果我有时间并且它很有用，我可以添加一些 JavaScript 来向您展示实际效果。

# jakarta-ee - HTTPS in EE6/Servlet Container

> ID：12165988
> 
> 赞同：0
> 
> 时间：2012-08-28T19:15:41.763
> 
> 标签：jakarta-ee, servlets

Is there a way to retrieve the https port of the EE6/Servlet Container in a standard way? If not maybe a method to convert an URL in a standard way to use https?

I know I could use a security constraint in web.xml, but the behavior is not configurable at runtime as far as I know.

Maybe it is a bad idea to allow the user or admin to choose whether to use https or not?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T21:45:54.420

我认为不可能使用标准 API。如果是 TomCat Server，我通过解析 server.xml 看到了一些变通方法。

# magento - magento：保存或查看设置缓慢

> ID：12165989
> 
> 赞同：0
> 
> 时间：2012-08-28T19:15:42.613
> 
> 标签：magento

我们已经审查了我们的 magento 性能。没关系，现在在限制范围内；）

有2个例外

但！更改和编辑设置（进入系统、配置）非常缓慢：查看和更改几乎是不可能的。

将产品添加到购物车也需要 10 秒。

关于我可以设置的特殊索引的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T10:28:48.817

将 APC 缓存添加到 Magento 后端听起来 mysql 正在苦苦挣扎 - 尝试运行 mysqltuner.pl 以获得一些提示

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T11:45:41.773

谢谢比恩。我们正在考虑添加 APC。谢谢。它是否也加快了后端？

向您更新我们的问题。我们安装了 Jirafe 插件。发生的事情是它无法连接并仅在 30 秒后超时。

我们为此向 Jirafe 提交了错误报告。不要认为一个真实的商业网站应该比实际销售更优先提供一些日志记录和报告框架。

# jquery - 将主干集合 / javascript 对象与来自服务器的新模型相结合

> ID：12165992
> 
> 赞同：3
> 
> 时间：2012-08-28T19:15:52.593
> 
> 标签：jquery, asp.net-mvc-3, backbone.js, underscore.js

我有一个谷歌地图对象上的位置集合，存储在主干集合中：

```
var Location = Backbone.Model.extend({
    defaults: {
        latitute: "",
        longitude: "",
        visited: false;
    },
});

var LocationCollection = Backbone.Collection.extend({
    model: Location,
    url: 'api/locations'
}); 
```

在地图上单击每个点时，位置模型属性“已访问”设置为 true。

位置的原始集合来自数据库（基于地图的边界），它不存储任何“访问”信息，只是范围内的位置列表。

当用户通过移动、放大/缩小等更改谷歌地图的边界时，我需要在新参数中检索一个全新的位置列表，然后以某种方式将该列表与现有集合同化，添加新位置，但是为现有的保留访问过的属性？

我希望这不是太模糊，但是从哪里开始呢？jQuery 有没有办法将复杂对象从一个集合映射到另一个集合？或者拆分集合，将访问信息发送回服务器并在那里合并它们会更有意义吗？还是 Backbone 集合会记住“访问过”的值，并且只使用新属性更新集合中的值？

对不起，我以为我知道这些东西，但我从来没有做过这样的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:43:55.940

这是可能的。基本上，我假设如下。用户有一堆位置。他们单击，位置属性更改为`visited = true;`

当他们缩小时，您`fetch()`现在在视图中的新模型但您也不希望那些旧位置重置为`visited = false;`服务器将基本上计算视图的尺寸并提供一堆位置模型。

如果这是您想要的，您需要做的就是`fetch()`使用以下选项拨打电话：`add:true`.

```
collection.fetch({
    add: true
}); 
```

当您将`add:true`选项传递给您的`fetch()`呼叫时，它不会重置集合（从而擦除您访问的数据）。相反，它只会添加集合中尚不存在的模型。因此，如果您已经有 locations.id = 1, 2, 3 并且您的服务器返回 locations.id = 1, 2, 3, 4, 5, 6 ... 只有 4, 5, 6 将添加到您现有的集合中. 1、2、3的visited = true（或false）数据应该保持不变。

# php - 如何在 PHP 中用“正常”替换“不同”？

> ID：12165996
> 
> 赞同：3
> 
> 时间：2012-08-28T19:16:12.300
> 
> 标签：php, wordpress

我正在使用 WP-property（一个 wordpress 插件），并试图使用一个变量作为模板中的链接。我正在使用以下代码：

```
<a href="<?php echo $property['download1link']; ?>" target="_blank"><?php echo   $property['download1tekst']; ?></a> 
```

但是，链接不起作用，因为“-”不同。我该如何解决这个问题（/将 - 替换为正常的 - ）？

现在输出（ndash）：

```
http://ouwejan.hostbeats.com/wp%E2%80%93content/uploads/2012/07/NVM_Goed%E2%80%93gevoel%E2%80%93NVM_Label_fc11.jpg 
```

输出应该是：

```
http://ouwejan.hostbeats.com/wp-content/uploads/2012/07/NVM_Goed-gevoel-NVM_Label_fc11.jpg 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:19:13.187

见`str_replace()`：

[http://php.net/str_replace](http://php.net/str_replace)

例子：

```
echo str_replace( 'badchar', '-', $variable ); 
```

或者，对于更高级的替换，`preg_replace()`：

[http://php.net/manual/en/function.preg-replace.php](http://php.net/manual/en/function.preg-replace.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:23:51.640

首先到这个页面： [http](http://slayeroffice.com/tools/ascii/) ://slayeroffice.com/tools/ascii/ 找到坏“-”的ascii号。您只需将“–”粘贴在页面顶部的左侧框中，然后单击 [==] 按钮

我认为是8211，那么你这样做：

```
<?php echo str_replace( chr(8211) , '-' , $property['download1link'] ); ?> 
```

# mysql - mySQL union 允许不匹配

> ID：12165999
> 
> 赞同：0
> 
> 时间：2012-08-28T19:16:32.903
> 
> 标签：mysql

我正在尝试编写一个查询，该查询将提取一些产品信息和照片，如果产品有的话。

```
select
    prod.pID, prod.Manufacturer_Name, prod.pUPC, prod.pNum, prod.pPrice, prod.pSalesPrice, prod.pSalesDate, prod.pSalesEndDate, prod.pSale,
    GROUP_CONCAT(photoName) as photos
from
    ds_products as prod
    inner join ds_photos as pics on pics.objectID=prod.pID
where
   pics.photoFlag =2
group by 
   prod.pID 
```

这样做的问题是没有照片的产品会被排除在结果集中之外。我需要添加和/或更改什么以允许未出现在照片表中的产品显示在结果中？

谢谢

*编辑*

我尝试了 LEFT JOIN 而不是内部但得到了相同的结果集。如果我只运行：

```
select
    prod.pID, prod.Manufacturer_Name, prod.pUPC, prod.pNum, prod.pPrice, prod.pSalesPrice, prod.pSalesDate, prod.pSalesEndDate, prod.pSale
from
    ds_products as prod 
```

我得到大约 600k 的结果。内连接和或左连接查询得到大约 190k 的结果。还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:18:57.130

使用外连接

```
select
    prod.pID, prod.Manufacturer_Name, prod.pUPC, prod.pNum, prod.pPrice, prod.pSalesPrice, prod.pSalesDate, prod.pSalesEndDate, prod.pSale,
    GROUP_CONCAT(photoName) as photos
from
    ds_products as prod
    LEFT join ds_photos as pics on pics.objectID=prod.pID
where
   pics.photoFlag =2 OR pics.photoFlag is NULL
group by 
   prod.pID 
```

我添加了一个条件，检查没有相应图片的产品的 photoFlag 是否为空 这是工作小提琴：[http ://sqlfiddle.com/#!2/c2a9c/1/0](http://sqlfiddle.com/#!2/c2a9c/1/0)

欲了解更多信息：[http ://dev.mysql.com/doc/refman/5.0/en/outer-join-simplification.html](http://dev.mysql.com/doc/refman/5.0/en/outer-join-simplification.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:19:11.983

您需要像这样使用 LEFT JOIN 而不是 INNER JOIN

```
select
    prod.pID, prod.Manufacturer_Name, prod.pUPC, prod.pNum, prod.pPrice, prod.pSalesPrice, prod.pSalesDate, prod.pSalesEndDate, prod.pSale,
    GROUP_CONCAT(photoName) as photos
from
    ds_products as prod
    LEFT JOIN ds_photos as pics on pics.objectID=prod.pID
group by 
   prod.pID 
```

注意我还删除了你的 where 子句，因为这是在 pics 表中寻找一个会限制结果集的值。