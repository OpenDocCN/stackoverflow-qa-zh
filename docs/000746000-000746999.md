# StackOverflow 问答 000746000-000746999

# c - C - GLFW 窗口在 Debian 上没有打开

> ID：746000
> 
> 赞同：1
> 
> 时间：2009-04-14T01:25:01.720
> 
> 标签：c, opengl, debian

我正在尝试在 Debian 上开始使用 GLFW，我尝试编译并运行一个示例程序，但它拒绝运行。在几个 printf 语句的帮助下，我发现当程序尝试打开 GLFW 窗口时它失败，然后退出 - 但我不知道为什么。任何帮助都会很棒。

```
#include <stdlib.h>    // For malloc() etc.
#include <stdio.h>     // For printf(), fopen() etc.
#include <math.h>      // For sin(), cos() etc.
#include <GL/glfw.h>   // For GLFW, OpenGL and GLU

//----------------------------------------------------------------------
// Draw() - Main OpenGL drawing function that is called each frame
//----------------------------------------------------------------------

void Draw( void )
{
    int    width, height;  // Window dimensions
    double t;              // Time (in seconds)
    int    k;              // Loop counter

    // Get current time
    t = glfwGetTime();

    // Get window size
    glfwGetWindowSize( &width, &height );

    // Make sure that height is non-zero to avoid division by zero
    height = height < 1 ? 1 : height;

    // Set viewport
    glViewport( 0, 0, width, height );

    // Clear color and depht buffers
    glClearColor( 0.0f, 0.0f, 0.0f, 0.0f );
    glClear( GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT );

    // Set up projection matrix
    glMatrixMode( GL_PROJECTION );    // Select projection matrix
    glLoadIdentity();                 // Start with an identity matrix
    gluPerspective(                   // Set perspective view
        65.0,                         // Field of view = 65 degrees
        (double)width/(double)height, // Window aspect (assumes square pixels)
        1.0,                          // Near Z clipping plane
        100.0                         // Far Z clippling plane
    );

    // Set up modelview matrix
    glMatrixMode( GL_MODELVIEW );     // Select modelview matrix
    glLoadIdentity();                 // Start with an identity matrix
    gluLookAt(                        // Set camera position and orientation
        0.0, 0.0, 10.0,               // Camera position (x,y,z)
        0.0, 0.0, 0.0,                // View point (x,y,z)
        0.0, 1.0, 0.0                 // Up-vector (x,y,z)
    );

// **** Draw a circle of points ***

// Save the current modelview matrix on the stack
glPushMatrix();

// Translate (move) the points to the upper left of the display
glTranslatef( -4.0f, 3.0f, 0.0f );

// Rotate the points about the z-axis and the x-axis
glRotatef( 35.0f * (float)t, 0.0f, 0.0f, 1.0f );
glRotatef( 60.0f * (float)t, 1.0f, 0.0f, 0.0f );

// Now draw the points - we use a for-loop to build a circle
glColor3f( 1.0f, 1.0f, 1.0f );
glBegin( GL_POINTS );
for( k = 0; k < 20; k ++ )
{
    glVertex3f( 2.0f * (float)cos( 0.31416 * (double)k ),
                2.0f * (float)sin( 0.31416 * (double)k ),
                0.0f );
}
glEnd();

// Restore modelview matrix
glPopMatrix();

// **** Draw a circle of lines ***

// Save the current modelview matrix on the stack
glPushMatrix();

// Translate (move) the lines to the upper right of the display
glTranslatef( 4.0f, 3.0f, 0.0f );

// Rotate the points about the z-axis and the x-axis
glRotatef( 45.0f * (float)t, 0.0f, 0.0f, 1.0f );
glRotatef( 55.0f * (float)t, 1.0f, 0.0f, 0.0f );

// Now draw the lines - we use a for-loop to build a circle
glBegin( GL_LINE_LOOP );
for( k = 0; k < 20; k ++ )
{
    glColor3f( 1.0f, 0.05f * (float)k, 0.0f );
    glVertex3f( 2.0f * (float)cos( 0.31416 * (double)k ),
                2.0f * (float)sin( 0.31416 * (double)k ),
                0.0f );
}
glEnd();

// Restore modelview matrix
glPopMatrix();

// **** Draw a disc using trinagles ***

// Save the current modelview matrix on the stack
glPushMatrix();

// Translate (move) the triangles to the lower left of the display
glTranslatef( -4.0f, -3.0f, 0.0f );

// Rotate the triangles about the z-axis and the x-axis
glRotatef( 25.0f * (float)t, 0.0f, 0.0f, 1.0f );
glRotatef( 75.0f * (float)t, 1.0f, 0.0f, 0.0f );

// Now draw the triangles - we use a for-loop to build a disc
// Since we are building a triangle fan, we also specify a first
// vertex for the centre point of the disc.
glBegin( GL_TRIANGLE_FAN );
glColor3f( 0.0f, 0.5f, 1.0f );
glVertex3f( 0.0f, 0.0f, 0.0f );
for( k = 0; k < 21; k ++ )
{
    glColor3f( 0.0f, 0.05f * (float)k, 1.0f );
    glVertex3f( 2.0f * (float)cos( 0.31416 * (double)k ),
                2.0f * (float)sin( 0.31416 * (double)k ),
                0.0f );
}
glEnd();

// Restore modelview matrix
glPopMatrix();

// **** Draw a disc using a polygon ***

// Save the current modelview matrix on the stack
glPushMatrix();

// Translate (move) the polygon to the lower right of the display
glTranslatef( 4.0f, -3.0f, 0.0f );

// Rotate the polygon about the z-axis and the x-axis
glRotatef( 65.0f * (float)t, 0.0f, 0.0f, 1.0f );
glRotatef( -35.0f * (float)t, 1.0f, 0.0f, 0.0f );

// Now draw the polygon - we use a for-loop to build a disc
glBegin( GL_POLYGON );
for( k = 0; k < 20; k ++ )
{
    glColor3f( 1.0f, 0.0f, 0.05f * (float)k );
    glVertex3f( 2.0f * (float)cos( 0.31416 * (double)k ),
                2.0f * (float)sin( 0.31416 * (double)k ),
                0.0f );
}
glEnd();

// Restore modelview matrix
glPopMatrix();

// **** Draw a single quad ***

// Save the current modelview matrix on the stack
glPushMatrix();

// Rotate the quad about the y-axis
glRotatef( 60.0f * (float)t, 0.0f, 1.0f, 0.0f );

// Now draw the quad
glBegin( GL_QUADS );
glColor3f( 1.0f, 0.0f, 0.0f );
glVertex3f( -1.5f, -1.5f, 0.0f );
glColor3f( 1.0f, 1.0f, 0.0f );
glVertex3f(  1.5f, -1.5f, 0.0f );
glColor3f( 1.0f, 0.0f, 1.0f );
glVertex3f(  1.5f,  1.5f, 0.0f );
glColor3f( 0.0f, 0.0f, 1.0f );
glVertex3f( -1.5f,  1.5f, 0.0f );
glEnd();

// Restore modelview matrix
glPopMatrix();
}

//----------------------------------------------------------------------
// main() - Program entry point
//----------------------------------------------------------------------

int main( int argc, char **argv )
{
int    ok;             // Flag telling if the window was opened
int    running;        // Flag telling if the program is running

// Initialize GLFW
glfwInit();
// Open window
ok = glfwOpenWindow(
    100, 100,          // Width and height of window
    8, 8, 8,           // Number of red, green, and blue bits for color buffer
    8,                 // Number of bits for alpha buffer
    24,                // Number of bits for depth buffer (Z-buffer)
    0,                 // Number of bits for stencil buffer
    GLFW_WINDOW        // We want a desktop window (could be GLFW_FULLSCREEN)
);

        printf("here");
// If we could not open a window, exit now
if( !ok )
{
    glfwTerminate();
    return 0;
}
printf("not here");

// Set window title
glfwSetWindowTitle( "My OpenGL program" );

// Enable sticky keys
glfwEnable( GLFW_STICKY_KEYS );

// Main rendering loop
do
{
    // Call our rendering function
    Draw();

    // Swap front and back buffers (we use a double buffered display)
    glfwSwapBuffers();

    // Check if the escape key was pressed, or if the window was closed
    running = !glfwGetKey( GLFW_KEY_ESC ) &&
              glfwGetWindowParam( GLFW_OPENED );
}
while( running );

// Terminate GLFW
glfwTerminate();

// Exit program
return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T04:15:36.020

你确定是 glfwOpenWindow 失败了吗？我不知道为什么会这样，也许您的 z 缓冲区使用了太多位？这是我唯一能想到的。

尝试这个

```
GLFWvidmode dvm;
glfwGetDesktopMode(&dvm);
glfwOpenWindow(winWidth, winHeight, dvm.RedBits, dvm.GreenBits, dvm.BlueBits, 0, 0, 0, GLFW_WINDOW); 
```

看看它是否仍然失败。

# wcf - 当 SSL 位于 IIS 场 (WCF) 前面的代理上时，如何使用 Forms Auth？

> ID：746009
> 
> 赞同：0
> 
> 时间：2009-04-14T01:32:36.397
> 
> 标签：wcf, soap, ssl, wcf-binding, ws-security

这是我的场景：

我有一个实际安装了 SSL 证书的代理，它位于负载平衡网络场的前面。每个 IIS 服务器都没有 SSL，因此我无法通过 wsHttp 绑定使用传输安全性。我没有调查 basicHttp，因为我们希望提供带有此解决方案的 SOAP 1.2。除此之外，我的网络团队不允许在消息级别使用任何证书进行加密。（我敢肯定，仅此一项就可以解决我的困境）

我的安全组要求我们使用表单身份验证（成员资格提供程序）。

最终的解决方案必须允许 SSL 通过前端代理，但某种类型的 WCF 绑定将复杂性封装在配置文件中。

我正在使用允许通过明文发送用户名/密码的自定义绑定，但是当我尝试通过 https 连接时，我得到了通常的“http 预期”uri 错误。

如何通过代理使用 SSL 从客户端应用程序安全地连接到 Web 服务，但没有在 IIS 上安装 SSL 并利用 WCF 堆栈 + 表单身份验证？

我对 WCF 并不陌生，但是这种非常自定义的设置似乎让我不确定要求是否允许任何类型的“简单”解决方案。

先感谢您！

**编辑：** 我终于完成了这项工作，并决定写一篇简短的博客[文章](http://toranbillups.com/blog.aspx/archive/2009/04/14/How-to-fake-Transport-Security-in-WCF)，其中包含编写自定义绑定所需的完整源代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T11:08:27.137

我认为这类似于许多人在 IIS 中的实际服务位于 SSL 卸载设备之后时想要通过 SSL 提供 WCF 服务时遇到的问题。在这种情况下，以下两页应该可以帮助您：

[http://blog.hackedbrain.com/archive/2006/09/26/5281.aspx](http://blog.hackedbrain.com/archive/2006/09/26/5281.aspx)

[http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/87a254c8-e9d1-4d4c-8f62-54eae497423f/](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/87a254c8-e9d1-4d4c-8f62-54eae497423f/)

基本上，您需要对 WCF 撒谎并说服务是安全的，即使流量将通过 HTTP（在服务和代理之间）进行。

# vb.net - 使用 VB.NET 的任何区域的 Decimal.toString()

> ID：746013
> 
> 赞同：2
> 
> 时间：2009-04-14T01:35:00.930
> 
> 标签：vb.net, formatting, locale, currency, region

我有一个处理货币的应用程序。出于显示目的，我使用了漂亮的 VB FormatCurrency 函数，该函数将根据操作系统的区域设置进行格式化。所以，如果在法国你可能会得到 123.45，而在美国你会得到 123.45。

要对这些金额执行计算，我使用 CDec() 转换为十进制。

我的问题是，当我使用 toString() 将 Decimal 转换为 String 时，它会根据当前设置的区域进行格式化。我需要能够始终将小数转换为美国的字符串表示形式，即带小数点。

我以为我可以做类似的事情： .toString("#0.00")

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T01:42:11.413

尝试：

```
value.ToString("C", CultureInfo.InvariantCulture) 
```

更多信息在这里：http:
[//msdn.microsoft.com/en-us/library/dwhawy9k.aspx](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)

“C”用于格式化货币，但您可以使用许多不同的格式字符串。如果您真的希望将其格式化为“美国”而不是不变的文化，您可以这样做：

```
value.ToString("C", CultureInfo.CreateSpecificCulture("en-US")) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T13:31:10.350

这

```
 Dim dec As Decimal = 1.25D
    Dim s As String
    s = dec.ToString("C2", System.Globalization.CultureInfo.CreateSpecificCulture("en-US")) 
```

产生 1.25 美元

这

```
 s = dec.ToString("N2", System.Globalization.CultureInfo.CreateSpecificCulture("en-US")) 
```

产生 1.25

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T01:40:18.907

尝试将 InvariantCulture 传递给您的 ToString() 方法：

```
Dim dec As Decimal = 1.25D
dec.ToString(System.Globalization.CultureInfo.InvariantCulture);
//writes 1.25 
```

# powershell - 如何从 PowerShell 调用显式实现的接口方法？

> ID：746014
> 
> 赞同：8
> 
> 时间：2009-04-14T01:35:16.220
> 
> 标签：powershell, casting, explicit-interface

代码：

```
add-type @"
    public interface IFoo
    {
        void Foo();
    }

    public class Bar : IFoo
    {
        void IFoo.Foo()
        {
        }
    }
"@ -Language Csharp

$bar = New-Object Bar
($bar -as [IFoo]).Foo() # ERROR. 
```

错误：

> 方法调用失败，因为 [Bar] 不包含名为“Foo”的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-08T14:36:47.133

你可以做类似的事情

```
$bar = New-Object Bar
[IFoo].GetMethod("Foo").Invoke($bar, @()) 
```

您从对象中获取（的*反射*表示）成员并调用[重载](http://msdn.microsoft.com/en-us/library/a89hcwhh.aspx)。太糟糕了，但必须这样做。显式实现的属性等的类似方法。`IFoo``Type`[`Invoke`](http://msdn.microsoft.com/en-us/library/a89hcwhh.aspx)

`@()`如果该方法接受参数，它们当然会放在上面代码中逗号之后的数组中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-17T17:17:38.797

我为 PowerShell v2.0 写了一些东西，可以很容易地以自然的方式调用显式接口：

```
PS> $foo = get-interface $bar ([ifoo])
PS> $foo.Foo() 
```

看：

[http://www.nivot.org/2009/03/28/PowerShell20CTP3ModulesInPracticeClosures.aspx](http://www.nivot.org/2009/03/28/PowerShell20CTP3ModulesInPracticeClosures.aspx)（存档[在这里](https://web.archive.org/web/20170707062517/http://www.nivot.org/blog/post/2009/03/28/PowerShell20CTP3ModulesInPracticeClosures)）。

它通过生成一个动态模块来实现对接口的调用。解决方案是纯 powershell 脚本（没有讨厌的 add-type 技巧）。

-Oisin

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T02:29:17.477

坏消息：这是一个错误。

[https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=249840&SiteID=99](https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=249840&SiteID=99)

# sql - 如何在 Eclipse DTP 中运行多个 .sql 文件

> ID：746016
> 
> 赞同：0
> 
> 时间：2009-04-14T01:37:00.317
> 
> 标签：sql, eclipse, stored-procedures

我有一个 .sql 脚本文件列表，用于创建使用 Eclipse DTP 开发的存储过程。目前要创建/更新所有这些存储过程，我必须从数据透视图中一一打开和运行。

有没有办法创建一个批处理文件来运行脚本

```
 run createSP1.sql
    run createSP2.sql
    ...
    run createSPn.sql 
```

并在 Eclipse DTP 中运行它以利用那里定义的数据库连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T02:22:03.487

为什么不创建一个批处理文件，将所有`.sql`文件合并到一个`procs.sql`文件中作为构建过程的一部分。我不知道您在哪个平台上运行，但在 Windows 中，您可以拥有一个 .bat 文件，它可以执行以下操作：

```
type *.sql > proc.sql 
```

然后将其应用到数据库，为什么不在 Eclipse 之外执行它并通过命令行连接到数据库。您可以将这一切捆绑为一个批处理文件，该文件从源代码管理中获取最新版本的存储过程，将它们合并到一个文件中，然后将其应用于数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T18:52:47.887

## 第一部分

据我所知，Eclipse DTP 的开发人员还没有通过 Eclipse 控制台视图实现命令行 SQL 执行接口。

请参阅 eclipse DTP 开发者论坛上的以下 URL [http://dev.eclipse.org/newslists/news.eclipse.dtp/msg00304.html](http://dev.eclipse.org/newslists/news.eclipse.dtp/msg00304.html)

## 第二部分

当 Eclipse DTP 人员正在处理它时，您可以使用特定于数据库的工具来加载主 SQL 文件（所有 SQL proc 文件附加在一起）

有一些特定于数据库的控制台工具可以加载您的主 SQL 文件命令行。（即，用于 Oracle 的 SQL*Plus，用于 Apache Derby 的 ij）

## 第三部分

对 DOS 批处理的改进是使用 Cygwin bash 或 python 或 perl 将所有 sql 文件合并到一个主文件中。

我发现 UNIX 中可用的文本处理工具（awk、sed、cat...）非常适合这类事情。

# javascript - javascript 提示 - 在默认文本中添加变量

> ID：746019
> 
> 赞同：16
> 
> 时间：2009-04-14T01:37:38.820
> 
> 标签：javascript, prompt

对于 javascript 提示：

```
prompt("Message", "default value in the text field"); 
```

是否可以将变量添加到默认值中？

例如：

```
var default = 'default value';
prompt("Message", +default+"and other values"); 
```

上面的示例不起作用，因为它在文本字段中显示“NaN 和其他值”。我希望该字段显示“默认值和其他值”。我想知道正确的方法是什么。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-14T01:41:10.043

愚蠢的我。这是解决方案：

```
var default = 'default value';
prompt("Message", default+"and other values"); 
```

在默认变量之前有一个前导加号。

# database-design - 数据库主键-> 身份字段和名称字段？

> ID：746029
> 
> 赞同：1
> 
> 时间：2009-04-14T01:43:15.343
> 
> 标签：database-design, primary-key

我所有的表都有`Id`某种类型的字段（`UserId, PostId, FooId`等）。我通常把它*设为 Primary Key*。

我有一张桌子叫做`Countries`. 它有

```
CountryId SMALLINT
Name VARCHAR(100)  -- Yes, english country names only, in this column.
AndSomeOtherFields. 
```

现在，我知道`Name`必须是独一无二的。所有国家名称都是唯一的。`PrimaryKey`如果我制作==`CountryId ASC` *和 ，* 它是好/坏/ru-roh`Name ASC`吗？

如果它很好，有人可以解释为什么它更好，而不仅仅是`Id`PK？只是它确保了数据的完整性（例如，表中不存在两个国家名称）。如果不好..为什么？

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T01:48:52.863

制作主键`CountryId` *并* `Name`不能确保名称是唯一的。它只是确保每个`CountryId`-`Name` *对*都是唯一的，并且显然`CountryId`已经是唯一的，是一个“ID”。因此，您仍然可以拥有，例如`1-US`和`19-US`，因为这些对是唯一的。

将它们都设为主键的唯一原因是，如果您经常执行在 Where 子句中同时使用 CountryId 和 Name 的查询。*默认情况下*，主键创建一个聚集索引，该索引对表进行物理排序，因此它可以非常快速地根据这些谓词查找行。

要提出的另一个重点是，在您的特定示例中，您正在存储一个国家列表，该列表a）非常短，b）变化不大。无论您做什么，对该表的查找都将*非常快。*即使 SQL Server 每次都必须进行全表扫描，您也可能不会注意到。您不必担心页面碎片。您可以跳过 ID 列并将 用`Name`作主键。

或者，如果您想保留一个 ID，但也只强制国家名称的唯一性，您可以在名称列上[放置一个唯一约束。](http://databases.about.com/od/sqlserver/a/unique.htm)

在一个答案中很难涵盖主键、聚集索引和一般索引的问题，过于深入。以下是一些很好的入门资源：

*   [什么时候应该使用主键？](http://www.sql-server-performance.com/faq/primary_key_index_clustered_p1.aspx)
*   [聚集和非聚集索引数据结构简介](http://www.sql-server-performance.com/articles/per/index_data_structures_p1.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T01:49:08.167

将名称变为 PK 并不总是最好的解决方案，我相信 CountryId 足以作为您表的 PK，但是如果 Name 是一个字段，您将使用它来查询 ie: selects,joins ，您应该索引这个字段以这种方式通过该字段进行查询过滤将大大提高它的速度

祝你好运 ：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T01:56:20.023

在列上创建**唯一索引**`Name`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T01:50:47.663

我唯一能想到的很明显：你的索引会大一点。话虽如此，这没什么大不了的，因为您的桌子只会存储国家/地区。但是，你为什么想要这样的索引呢？如果您按**CountryId**排序，那么按**Name**将其排序为第二个字段是没有意义的。您将始终得到相同的订单。

确实是个坏主意的一件事是让外键指向一个大的主键，因此，请确保如果您使用该主键，您指向*国家*/地区的外键仍然只使用**CountryId**列。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T01:51:02.857

众所周知，国名会发生变化，而不会改变国家的身份。这表明该名称不应成为 PK 的一部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T01:51:22.453

如果您需要强制唯一性，请使用约束。

# eclipse - 如何创建自定义 Eclipse 语法荧光笔

> ID：746031
> 
> 赞同：40
> 
> 时间：2009-04-14T01:43:35.823
> 
> 标签：eclipse, eclipse-plugin, syntax-highlighting

我一直在为一种新语言开发编译器。我认为能够在语法感知环境中展示它的开发会很好。该语言有相当多的自定义关键字，其结构与 Java 或 C/C++ 等常见语言有很大不同。

如何为 Eclipse 开发自定义语法高亮器？我已经看到一些对一些插件的引用，但是文档对于我初学者的需求来说还不够全面。

我有我的语言的语法/RE，以及相关关键字的列表。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-14T04:57:46.730

听起来您正在处理 DSL（域特定语言）。您正在寻找的内容与[XText](http://wiki.eclipse.org/Xtext)完全一样。这是该页面的摘录：

> Xtext 是用于开发外部文本 DSL 的框架/工具。只需使用 Xtext 的简单 EBNF 语法语言描述您自己的 DSL，生成器就会创建一个解析器、一个 AST 元模型（在 EMF 中实现）以及一个功能齐全的 Eclipse 文本编辑器。

另外，请查看[此视频](http://blip.tv/file/1923363)，该视频是对其中一位幕后人员的采访。我相信你会从这里拿走它:-)

您可能还想查看[这个插件](http://colorer.sourceforge.net/eclipsecolorer/index.html)。不完全是您正在寻找的东西，但可能是一个不错的开始。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-14T02:02:35.203

Eclipse 框架使用一个相当复杂的文档模型来进行语法着色（他们称之为着色，而不是突出显示），它不像在其他编辑器中那么简单。

如果您真的想尝试并弄乱它，您可能需要阅读[Eclipse 插件开发人员指南中的以下内容](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/editors_highlighting.htm)。

*（上面的链接现在已经失效了。[这可能是一个类似的文件](http://wiki.eclipse.org/FAQ_How_do_I_provide_syntax_coloring_in_an_editor%3F)或者[这个](https://wiki.eclipse.org/FAQ_How_do_I_write_an_editor_for_my_own_language%3F)。）*

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-10-24T12:59:51.853

这正是 LiClipse ( [http://www.liclipse.com/](http://www.liclipse.com/) ) 的目标之一：轻松使用针对 Eclipse 的语法高亮、基本代码完成、大纲等编辑器——注意它的核心（允许创建自定义语言）最近成为开源：http: [//liclipse.blogspot.com.br/2016/05/liclipse-303-providing-back-to-open.html](http://liclipse.blogspot.com.br/2016/05/liclipse-303-providing-back-to-open.html)。

添加新语言不需要Java技能（主要是在适当的位置创建一个新的.liclipse - 这是一个YAML - 文件并创建一些基本规则来说明如何划分您的语言 - 即：通常只是分离代码来自字符串的注释——并指定分区中的关键字已经可以为您提供正确的语法突出显示）。

如果您下载它，在 plugins\com.brainwy.liclipse.editor\languages 有许多示例，在[http://www.liclipse.com/text/supported_languages.html](http://www.liclipse.com/text/supported_languages.html)和[http://www有一些基本文档.liclipse.com/text/scope_definition.html](http://www.liclipse.com/text/scope_definition.html)如何做到这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-12-18T10:59:26.300

我刚刚试用了**[Eclipse Colorer](http://colorer.sourceforge.net/eclipsecolorer/index.html)**，它非常好（例如，用于突出显示、使用 VBA 文件（当然是在受限上下文中），否则不支持）。

它支持例如

*   折叠（如您所见）
*   它支持括号匹配（打开/关闭）
*   200 多个文件扩展名（见下文）

[![一些 *.cls 和 *.bas 文件的编辑器](https://i.stack.imgur.com/rlO7W.png)](https://i.stack.imgur.com/rlO7W.png)

[![首选项 - 文件类型](https://i.stack.imgur.com/PjkEq.png)](https://i.stack.imgur.com/PjkEq.png)

[他们网站上的](http://colorer.sourceforge.net/sshots/index.html)更多屏幕截图

这是支持的扩展的完整列表：

*（很难获得这些信息，因为它们没有被索引或发布在网络的某个地方，但现在也应该被 Google 和 co 找到。
我删除了这个正则表达式的所有行`^\s+<(?!(!--|prototype|filename)).+>$`以压缩完整的内容和文件的[副本`eclipse\plugins\net.sf.colorer_0.9.9\colorer\hrc\proto.hrc`](https://pastebin.com/ytcwPxY9)。
随时更新更新）*

```
 <!--  main languages  -->
  <prototype name="c" group="main" description="C">

    <filename>/\.c$/i</filename>

  <prototype name="cpp" group="main" description="C++">

    <filename>/\.(cpp|cxx|cc|hpp|h)$/i</filename>

  <prototype name="d" group="main" description="D">

    <filename>/\.(d|di)$/i</filename>

  <prototype name="asm" group="main" description="ASM">

    <filename>/\.(mac|asm|inc|i32|cod)$/i</filename>

  <prototype name="perl" group="main" description="Perl">

    <filename>/\.(pl[sx]?|pm|pod|t)$/i</filename>

  <prototype name="java" group="main" description="Java">

    <filename>/\.(java|jav|jad)$/i</filename>

  <prototype name="idl" group="main" description="IDL">

    <filename>/\.(hvs|(i|o)dl)$/i</filename>

  <prototype name="pascal" group="main" description="Pascal">

    <filename>/\.(\~?pas|dpr|dpk|inc|int|pp)$/i</filename>

  <prototype name="csharp" group="main" description="C#">

    <filename>/\.cs$/i</filename>

  <prototype name="jsnet" group="main" description="JS.NET">

    <filename weight="0.5">/\.js$/i</filename>

  <prototype name="vbnet" group="main" description="VB.NET">

    <filename>/\.vb$/i</filename>

  <!-- warning!! extensions conflict with Fortran -->
  <prototype name="forth" group="main" description="Forth">

    <filename>/\.(fth|f32|f|spf)$/i</filename>

  <prototype name="fortran" group="main" description="Fortran">

    <filename>/\.(for|f(90)?)$/i</filename>

  <prototype name="vbasic" group="main" description="Visual Basic">

    <filename>/\.(bas|vbp|frm|cls)$/i</filename>

  <prototype name="python" group="main" description="Python">

    <filename>/\.(py|pyw|pys)$/i</filename>

  <prototype name="lua" group="main" description="Lua">

    <filename>/\.(lua)$/i</filename>
  </prototype>  
  <prototype name="ruby" group="main" description="Ruby">

    <filename>/\.(rb|rbw|ruby|rake)$/i</filename>
    <filename>/Rakefile$/i</filename>

  <prototype name="scala" group="main" description="Scala">

    <filename>/\.(scala)$/i</filename>

  <prototype name="tcltk" group="main" description="Tcl/Tk/Expect">

    <filename>/\.(tcl|tk|exp)$/i</filename>

  <!--  inet languages  -->

  <prototype name="html" group="inet" description="html">

    <filename>/\.[^ptr]??html?$/i</filename>

  <prototype name="css" group="inet" description="css">

    <filename>/\.(css)$/i</filename>

  <prototype name="html-css" group="inet" description="css for html">

    <filename weight="0">/\.(css)$/i</filename>

  <prototype name="svg-css" group="inet" description="css for svg">

    <filename weight="0">/\.(css)$/i</filename>

  <prototype name="sass" group="inet" description="SASS">

    <filename>/\.(sass)$/i</filename>

  <prototype name="haml" group="inet" description="HAML">

    <filename>/\.(haml)$/i</filename>

  <prototype name="erb" group="inet" description="ERB">

    <filename weight='4'>/\.(erb|rhtml|html\.erb)$/i</filename>

  <prototype name="jsp" group="inet" description="jsp">

    <filename>/\.(jspf?|tag)$/i</filename>

  <prototype name="php" group="inet" description="php">

    <filename>/\.(php\d?|phtml|thtml|inc)$/i</filename>

  <prototype name="xhtml-trans" group="inet" description="xhtml transitional" targetNamespace="http://www.w3.org/1999/xhtml">

    <filename>/\.html?/ix</filename>
    <filename>/\.xhtml?/ix</filename>

  <prototype name="xhtml-strict" group="inet" description="xhtml strict" targetNamespace="http://www.w3.org/1999/xhtml">

    <filename>/\.html?/ix</filename>
    <filename>/\.xhtml?/ix</filename>

  <prototype name="xhtml-frameset" group="inet" description="xhtml frameset" targetNamespace="http://www.w3.org/1999/xhtml">

    <filename>/\.html?/ix</filename>
    <filename>/\.xhtml?/ix</filename>

  <prototype name="asp.vb" group="inet" description="asp - VBScript">

    <filename>/\.(as(p|a)|ht(r|x|a)|inc)$/i</filename>

  <prototype name="asp.js" group="inet" description="asp - JavaScript">

    <filename>/\.(as(p|a)|ht(r|x|a)|inc)$/i</filename>

  <prototype name="asp.ps" group="inet" description="asp - PerlScript">

    <filename>/\.(as(p|a)|ht(r|x|a)|inc)$/i</filename>

  <prototype name="adp" group="inet" description="AOLserver Dynamic Pages">

    <filename>/\.(adp)$/i</filename>

  <prototype name="svg" group="inet" description="SVG 1.0" targetNamespace="http://www.w3.org/2000/svg">

    <filename>/\.svg/ix</filename>

  <prototype name="coldfusion" group="inet" description="ColdFusion">

    <filename>/\.(cfm|cfc)$/i</filename>

  <prototype name="jScript" group="inet" description="JavaScript">

    <filename>/\.(js|mocha)$/i</filename>

  <prototype name="actionscript" group="inet" description="ActionScript">

    <filename>/\.(as)$/i</filename>

  <prototype name="vbScript" group="inet" description="VBScript">

    <filename>/\.(vbs)$/i</filename>

  <prototype name="rss" group="inet" description="rss" targetNamespace="http://purl.org/rss/1.0/">

    <filename>/\.(rss)$/i</filename>
    <filename weight='1.5'>/^rss/i</filename>

  <prototype name="htc" group="inet" description="HTC">

    <filename weight='3'>/\.(htc)$/i</filename>

  <prototype name="xbl" group="inet" description="Mozilla XBL" targetNamespace="http://www.mozilla.org/xbl">

    <filename weight='0.5'>/\.(xml)/i</filename>

  <prototype name="wml" group="inet" description="wml" targetNamespace="http://www.wapforum.org/2001/wml">

    <filename>/\.wml$/i</filename>

  <!--  xml types  -->
  <prototype name="xml" group="xml" description="xml">

    <filename>/\.(xml|gi2|gpr|ui)$/i</filename>
    <filename>/\.(wxs|fb2)$/i</filename>

  <prototype name="dtd" group="xml" description="dtd">

    <filename>/\.(dtd|ent|mod)$/i</filename>

  <prototype name="dtdcatalog" group="xml" description="dtd/sgml catalog">

    <filename>/\.(cat|soc)$/i</filename>

  <prototype name="xslt" group="xml" description="xslt 1.0" targetNamespace="http://www.w3.org/1999/XSL/Transform">

    <filename>/\.(xslt?)$/i</filename>

  <prototype name="xslt2" group="xml" description="xslt 2.0" targetNamespace="http://www.w3.org/1999/XSL/Transform">

    <filename>/\.(xslt?2?)$/i</filename>

  <prototype name="xquery" group="xml" description="xquery 1.0">

    <filename>/\.(xq)$/i</filename>

  <prototype name="xslfo" group="xml" description="xslfo 1.0" targetNamespace="http://www.w3.org/1999/XSL/Transform">

    <filename>/\.(xslfo?|fo)$/i</filename>

  <prototype name="xmlschema" group="xml" description="XML Schema" targetNamespace="http://www.w3.org/2001/XMLSchema">

    <filename>/\.(xsd?)$/i</filename>

  <prototype name="relaxng" group="xml" description="Relax NG" targetNamespace="http://relaxng.org/ns/structure/1.0">

    <filename>/\.rng/ix</filename>

  <prototype name="schematron" group="xml" description="schematron" targetNamespace="http://www.ascc.net/xml/schematron">

    <filename>/\.sch$/ix</filename>

  <prototype name="wsdl" group="xml" description="wsdl 1.1" targetNamespace="http://schemas.xmlsoap.org/wsdl/">

    <filename>/\.wsdl$/ix</filename>

  <prototype name="rdf" group="xml" description="RDF" targetNamespace="http://www.w3.org/1999/02/22-rdf-syntax-ns#">

    <filename>/\.rdf$/ix</filename>

  <prototype name="xmlcatalog" group="xml" description="XML Catalog" targetNamespace="urn:oasis:names:tc:entity:xmlns:xml:catalog">

    <filename>/\.xml$/ix</filename>

  </prototype>  
  <prototype name="docbook" group="xml" description="DocBook 4.2">

    <filename>/\.(dbk?|docbook)$/i</filename>

  <prototype name="mathml" group="xml" description="MathML2">

    <filename>/\.(math?|mml)$/i</filename>

  <!--  database languages  -->
  <prototype name="clarion" group="database" description="Clarion">

    <filename>/\.(cla|clw)$/i</filename>

  <!-- warning!! extensions conflict with Clipper -->
  <prototype name="Clipper" group="database" description="Clipper">

    <filename>/\.(ch|prg)$/i</filename>

  <prototype name="foxpro" group="database" description="FoxPro">

    <filename>/\.(prg|spr|mpr)$/i</filename>

  <prototype name="sqlj" group="database" description="SQLJ (Java sql)">

    <filename>/\.sqlj$/i</filename>

  <prototype name="paradox" group="database" description="Paradox">

    <filename>/\.sc$/i</filename>

  <prototype name="sql" group="database" description="SQL, PL/SQL">

    <filename>/\.sql$/i</filename>

  <prototype name="mysql" group="database" description="MySQL">

   <filename>/\.sql$/i</filename>

  <prototype name="Batch" group="scripts" description="Batch/Config.sys/NTcmd">

    <filename>/\.(Cmd|Bat|nt|btm|sys)$/i</filename>

  <prototype name="apache" group="scripts" description="Apache httpd.conf">

    <filename>/(httpd\.conf|srm\.conf|access\.conf|\.htaccess|apache\.conf)$/i</filename>

  <prototype name="shell" group="scripts" description="sh/ksh/bash script">

    <filename>/\.(sh|spec)$|^\./i</filename>
    <filename>/^PKGBUILD$/i</filename>

  <prototype name="avisynth" group="scripts" description="AviSynth">

    <filename>/\.(avs|avsi)$/i</filename>

  <prototype name="config" group="scripts" description="Config, INI and CTL">

    <filename>/\.(ctl|tpl|ini|cfg|inf|srg|conf|types|tab|dof|dsk|lng)$/i</filename>

  <prototype name="awk" group="scripts" description="AWK">

    <filename weight='5'>/\.awk$/i</filename>

  <prototype name="makefile" group="scripts" description="makefile">

    <filename>/(makefile | tools\.ini) | \.(mak|gmk|ds(p|w)|bp(k|r|g)$)/ix</filename>
    <filename weight='3'>/(android|application)\.mk/i</filename>

  <prototype name="qmake" group="scripts" description="Qt qmake">

    <filename>/\.pr[oif]$/i</filename>

  <prototype name="mkb" group="scripts" description="Project build file for Airplay SDK">
    <filename>/\.(mkb|mkf)$/i</filename>

  <prototype name="ant" group="scripts" description="Ant's build.xml" targetNamespace="http://jakarta.apache.org/ant/">

    <filename weight='4'>/\bbuild\.xml$/ix</filename>

  <prototype name="acapella" group="scripts" description="Acapella">

    <filename>/\.(script|proc|param|parameter)$/i</filename>

  <prototype name="qrc" group="scripts" description="qrc">

    <filename>/\.qrc$/ix</filename>

 <prototype name="m4" group="scripts" description="M4">

    <filename>/\.m4$/i</filename>

  <prototype name="linkdef" group="scripts" description="Link Defines">

    <filename weight='3'>/\.def$/i</filename>

  <prototype name="resources" group="scripts" description="Resources">

    <filename>/\.(rc|dlg)$/i</filename>

  <prototype name="javacc" group="scripts" description="Java Compiler Compiler">

    <filename>/\.(jjt?)$/i</filename>

  <prototype name="javaProperties" group="scripts" description="Java properties">

    <filename>/\.pro(p(erties)?)?$/i</filename>

  <prototype name="javapolicy" group="scripts" description="Java policy">

    <filename>/\.policy$/i</filename>

  <prototype name="asn1" group="scripts" description="ASN.1/ECN">

    <filename>/\.(asn|asn1|ecn|edm|elm|mib)$/i</filename>
    <filename>/-mib$/i</filename>

  <prototype name="lex" group="scripts" description="Lex">

    <filename>/\.(l|f?lex)+$/i</filename>

  <prototype name="yacc" group="scripts" description="YACC">

    <filename>/\.y+$/i</filename>

  <prototype name="delphiform" group="scripts" description="Delphi form">

    <filename>/\.dfm$/i</filename>

  <prototype name="pnuts" group="scripts" description="Java: Pnuts">

    <filename>/\.(pnut)$/i</filename>

    <prototype name="scons" group="scripts" description="SCons">

    <filename>/(SConstruct|SConscript)$/i</filename>

  <prototype name="rtf" group="scripts" description="RTF text">

    <filename>/\.rtf$/i</filename>

  <prototype name="TeX" group="scripts" description="TeX">

    <filename>/\.(tex|cls|sty|ltx|ltr|dtx)$/i</filename>

  <prototype name="graphviz" group="scripts" description="GraphViz dot">

    <filename>/\.dot+$/i</filename>

  <prototype name="dcl" group="scripts" description="OpenVMS DCL">

    <filename>/\.com$/i</filename>

  <prototype name="vrml" group="scripts" description="VRML">

    <filename>/\.wrl$/i</filename>

  <prototype name="wsc" group="scripts" description="wsc" targetNamespace="uri:wsc">
    <!-- NOTE! 'targetNamespace' is fictive, used only for xsd2hrc -->

    <filename>/\.wsc$/i</filename>

  <prototype name="wsf" group="scripts" description="wsf">

    <filename>/\.wsf$/i</filename>

  <prototype name="rarscript" group="scripts.install" description="RAR Install Script">

    <filename>/\.s$/i</filename>

  <prototype name="nsi" group="scripts.install" description="Nullsoft Install Script">

    <filename>/\.ns(i|h)$/i</filename>

  <prototype name="iss" group="scripts.install" description="InnoSetup script">

    <filename>/\.iss$/i</filename>

  <prototype name="isScripts" group="scripts.install" description="IS script">

    <filename>/\.rul$/i</filename>

  <!--  rare languages  -->

  <prototype name="c1c" group="rare" description="1C">

    <filename>/\.1c$/i</filename>

  <prototype name="ada" group="rare" description="Ada">

    <filename>/\.(ads|adb|adc)$/i</filename>

  <prototype name="abap4" group="rare" description="ABAP/4">

    <filename>/\.(abap4|abap)$/i</filename>

  <prototype name="AutoIt" group="rare" description="AutoIt 2.x">

    <filename>/\.aut$/i</filename>

  <!--  !! you may wish to swap next two types
  because of collision with extensions  -->
  <prototype name="dssp" group="rare" description="Dssp">

    <filename>/\.dsp$/i</filename>

  <prototype name="adsp" group="rare" description="ADSP-21xx Asm">

    <filename>/\.(dsp|sys)$/i</filename>

  <prototype name="Baan" group="rare" description="Baan">

    <filename>/\.cln$/i</filename>

  <prototype name="cobol" group="rare" description="Cobol Fixed format">

    <filename>/\.(cob|cbl)$/i</filename>

  <prototype name="cobolfr" group="rare" description="Cobol Free format">

    <filename>/\.(cob|cbl)$/i</filename>

  <prototype name="cache" group="rare" description="Cache/Open-M">

    <filename>/\.(rsa|ro|rtn|inc|int|mac|cdl)$/i</filename>

  <prototype name="cup" group="rare" description="CUP">

    <filename>/\.(cup)$/i</filename>

  <prototype name="eiffel" group="rare" description="Eiffel">

    <filename>/\.e$/i</filename>

  <prototype name="erlang" group="rare" description="Erlang">

    <filename>/\.[eh]rl$/i</filename>

  <prototype name="icon" group="rare" description="Icon">

    <filename>/\.icn$/i</filename>

  <prototype name="lisp" group="rare" description="Lisp">

    <filename>/\.(lsp|lisp|scm|elc|el)$/i</filename>

  <prototype name="mako" group="rare" description="Mako templates">

    <!-- extension conflicts with Makefile, hence weight is less than 2 -->
    <filename weight="1.5">/\.(mako|mak)$/i</filename>

  <prototype name="matlab" group="rare" description="MatLab">

    <filename>/\.m$/i</filename>

  <!-- warning!! extensions conflict with link defines -->
  <prototype name="modula2" group="rare" description="Modula2 and Oberon2">

    <filename>/\.(mod|ob2|odf|def)$/i</filename>

  <prototype name="nesc" group="rare" description="nesC">

    <filename>/\.nc$/i</filename>

  <prototype name="picasm" group="rare" description="PicAsm">

    <filename>/\.(asm|pic)$/i</filename>

  <prototype name="pl1" group="rare" description="PL1">

    <filename>/\.(pl1|pli)$/i</filename>

  <prototype name="rexx" group="rare" description="Rexx">

    <filename>/\.(rex|cmd)$/i</filename>

 <prototype name="jcl" group="rare" description="JCL">

    <filename>/\.(jcl)$/i</filename>

  <prototype name="sml" group="rare" description="Standard ML">

    <filename>/\.(sml|sig)$/i</filename>

  <prototype name="ocaml" group="rare" description="OCaml">

    <filename>/\.ml[ilpy]?$/i</filename>

  <prototype name="sicstusProlog" group="rare" description="Sicstus Prolog">

    <filename>/\.pl$/i</filename>

  <prototype name="stata" group="rare" description="STATA">

    <filename>/\.a?do$/i</filename>

  <prototype name="turboProlog" group="rare" description="Turbo Prolog">

    <filename>/\.tpl$/i</filename>

  <prototype name="verilog" group="rare" description="Verilog HDL">

    <filename weight='3'>/\.g?v$/i</filename>

  <prototype name="vhdl" group="rare" description="VHDL">

    <filename>/\.vhdl?$/i</filename>

 <prototype name="ahdl" group="rare" description="AHDL">

   <filename>/\.(tdf|tdo|ahdl)$/i</filename>

  <prototype name="z80" group="rare" description="z80asm">

    <filename>/\.za$/i</filename>

  <prototype name="asm80" group="rare" description="asm80">

    <filename>/\.a80$/i</filename>

  <prototype name="a51" group="rare" description="8051 asm">

    <filename>/\.a5(1|2)$/i</filename>

  <prototype name="avr" group="rare" description="AVR asm">

    <filename>/\.(asm|inc|avr)$/i</filename>

  <prototype name="mason" group="rare" description="mason">

    <filename>/\.(mc)$/i</filename>

  <prototype name="postscript" group="rare" description="PostScript">

    <filename>/\.((e)?ps|pfa|gsf)$/i</filename>

  <!-- flex extension conflicts -->
  <prototype name="flex" group="rare" description="FlexScript">

    <filename>/\.(src|inc|inf)$/i</filename>

  <!--  other types  -->

  <prototype name="ass" group="other" description="(Advanced) SubStation Alpha script">

    <filename>/\.(ssa|ass)$/</filename>

  <prototype name="cue" group="other" description="Cue sheet">

    <filename>/\.cue$/</filename>

  <prototype name="filesbbs" group="other" description="files.bbs">

    <filename>/(files\.bbs|descript\.ion|file_id.diz)/i</filename>

  <prototype name="diff" group="other" description="Diff/Patch">

    <filename>/\.(diff.*|patch|rej(ect)?)$/i</filename>

  <prototype name="text" group="other" description="plain text">

    <filename>/(read\.?me|\.txt$|\.rus|\.nfo|\.log|install*|*ChangeLog*|AUTHORS|COPYING|FAQ|LICENSE|TODO$)/i</filename>
    <filename>/\.spo/ix</filename>

  <prototype name="default" group="other" description="default type">
    <filename weight='1'>//</filename> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-02T09:19:49.963

您可以改用 Notepad++ 的用户定义语言功能。对于这种用例，我们通常使用 Notepad++。因为它只是一个 XML。notepad++ 还提供基于 UI 的编辑来定义您的语言特定语法。

# c++ - 灰度的glDrawPixels？

> ID：746034
> 
> 赞同：3
> 
> 时间：2009-04-14T01:45:38.940
> 
> 标签：c++, opengl

我有一个像这样渲染的图像：

```
glDrawPixels(image->width, image->height, GL_BGR, GL_UNSIGNED_BYTE, image->imageData); 
```

无论如何我可以用灰度绘制它（而不先将它加载到纹理中）？我不在乎，比如说，蓝色分量是否用于灰度值而不是 L2 范数之类的，我只需要一个快速而肮脏的输出。

GL_LUMINANCE 会很棒，只是它不适用于 3 通道图像。

* * *

@timday：

[![](https://i.stack.imgur.com/6FSpY.png)](https://i.stack.imgur.com/6FSpY.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T12:10:10.577

你可以尝试一个不正当的想法，我不知道它是否会起作用：

```
glPixelZoom(1.0f/3.0f,1.0f);
glDrawPixels(3*width,height,GL_LUMINANCE,GL_UNSIGNED_BYTE,data); 
```

即，将您的 3 通道图像视为 3 倍宽的 1 通道（灰度）图像，并通过使用 x 缩放因子压缩宽度来补偿这一点。我相信 GL 总是对缩放后的 glDrawPixels 进行最近邻采样，因此它应该根据您的需要始终如一地从每三组样本中挑选出相同的组件。

# java - JSF 支持 bean 结构（最佳实践）

> ID：746047
> 
> 赞同：121
> 
> 时间：2009-04-14T01:51:58.287
> 
> 标签：java, jsf

我希望在这篇文章中，我可以得到人们对 JSF 页面和 backing beans 之间接口的最佳实践的看法。

我永远无法解决的一件事是我的支持豆的结构。此外，我从来没有找到关于这个主题的好文章。

哪些属性属于哪些支持 bean？什么时候向给定的 bean 添加更多属性而不是创建一个新 bean 并将属性添加到它上面？对于简单的应用程序，考虑到将一个 bean 注入另一个 bean 所涉及的复杂性，整个页面只有一个支持 bean 是否有意义？支持 bean 应该包含任何实际的业务逻辑，还是应该严格包含数据？

随意回答这些问题以及可能出现的任何其他问题。

* * *

至于减少 JSF 页面和支持 bean 之间的耦合，我从不允许 JSF 页面访问任何支持 bean 属性的属性。例如，我从不允许这样的事情：

```
<h:outputText value="#{myBean.anObject.anObjectProperty}" /> 
```

我总是需要类似的东西：

```
<h:outputText value="#{myBean.theObjectProperty}" /> 
```

支持 bean 值为：

```
public String getTheObjectProperty()
{
    return anObject.getAnObjectProperty();
} 
```

例如，当我遍历一个集合时，我使用一个包装类来避免向下钻取到数据表中的对象。

总的来说，这种方法对我来说是“正确的”。它避免了视图和数据之间的任何耦合。如果我错了，请纠正我。

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2009-06-23T01:21:09.243

您可能想检查一下：[区分不同种类的 JSF 托管 bean](http://java.dzone.com/articles/making-distinctions-between)。

这是 Neil Griffin 在上述文章中定义的不同 bean 类型的描述：

*   **Model Managed-Bean**：*通常是会话范围。* 这种类型的托管 bean 参与了 MVC 设计模式的“模型”关注点。当你看到“模型”这个词时——想想 DATA。JSF 模型bean 应该是遵循JavaBean 设计模式的POJO，其中getter/setter 封装了属性。模型 bean 最常见的用例是作为数据库实体，或者简单地表示数据库查询结果集中的一组行。
*   **Backing Managed-Bean**：*通常请求范围。*这种类型的托管 bean 参与了 MVC 设计模式的“视图”关注点。backing-bean 的目的是支持 UI 逻辑，并且与 JSF 视图或 Facelet 组合中的 JSF 表单具有 1::1 的关系。尽管它通常具有带有关联 getter/setter 的 JavaBean 样式属性，但这些是 View 的属性，而不是底层应用程序数据模型的属性。JSF backing-beans 也可能有 JSF actionListener 和 valueChangeListener 方法。
*   **Controller Managed-Bean**：*通常请求范围。* 这种类型的托管 bean 参与了 MVC 设计模式的“控制器”关注点。控制器 bean 的目的是执行某种业务逻辑并将导航结果返回给 JSF 导航处理程序。JSF 控制器 bean 通常具有 JSF 操作方法（而不是 actionListener 方法）。
*   **支持 Managed-Bean**：*通常是会话或应用程序范围。* 这种类型的 bean 在 MVC 设计模式的“视图”关注点中“支持”一个或多个视图。典型的用例是向 JSF h:selectOneMenu 提供一个 ArrayList 下拉列表，该下拉列表出现在多个 JSF 视图中。如果下拉列表中的数据对用户来说是特定的，那么 bean 将保留在会话范围内。但是，如果数据适用于所有用户（例如省份的下拉列表），则 bean 将保留在应用程序范围内，以便可以为所有用户缓存它。
*   **Utility Managed-Bean**： *通常应用范围。* 这种类型的 bean 为一个或多个 JSF 视图提供某种类型的“实用程序”功能。一个很好的例子可能是可以在多个 Web 应用程序中重用的 FileUpload bean。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-14T21:04:10.560

好问题。当我搬到 JSF 时，我遭受了很多同样的困境。这实际上取决于您的应用程序。我来自 Java EE 世界，因此我建议您的支持 bean 中的业务逻辑尽可能少。如果逻辑纯粹与页面的呈现有关，那么将它放在支持 bean 中就可以了。

我相信 JSF 的（许多）优势之一实际上是您可以直接在托管 bean 上公开域对象。因此，我强烈推荐这种`<:outputText value="#{myBean.anObject.anObjectProperty}" />`方法，否则您最终会在手动公开每个属性时为自己做太多工作。此外，如果您封装了所有属性，则在插入或更新数据时会有点混乱。在某些情况下，单个域对象可能不够用。在这些情况下，我在将其暴露在 bean 上之前准备了一个*ValueObject 。*

*编辑：实际上，如果您要封装要公开的每个对象属性，我建议您改为将 UI 组件绑定到支持 bean，然后将内容直接注入组件的值中。*

就 bean 结构而言，我的转折点是当我强行忽略所有关于构建 Web 应用程序的知识并开始将其视为 GUI 应用程序时。JSF 大量模仿 Swing，因此开发 Swing 应用程序的最佳实践也主要适用于构建 JSF 应用程序。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-16T07:58:29.493

我认为您的支持 bean 最重要的是分离它们的逻辑。如果您有一个 CMS 系统的首页，我认为将每段代码放入一个 bean 是一种不好的做法，因为：

1.  豆子最终会变得很大
2.  如果其他人正在对登录页面进行故障排除，如果他们可以轻松地查找 loginBean.java 文件，则其他人更容易找到他们正在寻找的内容。
3.  有时你有一小部分功能与你的代码的其余部分明显不同，通过分离它我想你可以更容易地重新开发/扩展这个代码到更大的东西，当你已经有一个很好的 bean 时结构体。
4.  如果/当你必须做这样的声明 MyBigBean bigBean = new MyBigBean(); 而不是通过执行 LoginBean loginBean = new LoginBean(); 来使用您实际需要的 funksjonality （如果我在这里错了，请纠正我？？？）
5.  在我看来，分离你的 bean 就像分离你的方法。您不想要一个运行超过 100 行的大方法，而是将其拆分为处理其特定任务的新方法。
6.  请记住，很可能除了您之外的其他人也必须处理您的 JSF 项目。

* * *

至于耦合，我不认为允许您的 JSF 页面也访问 backingbean 中对象中的属性是一个麻烦的问题。这是 JSF 中内置的支持，实际上只是让 imo 更易于阅读和构建。您已经严格分离 MVC 逻辑。通过这样做，您可以在 backingbean 中为自己节省大量的 getter 和 setter 行。例如，我有一个由 Web 服务提供给我的非常大的对象，我需要在演示文稿中使用一些属性。如果我要为每个属性创建一个 getter/setter，我的 bean 将扩展至少 100 多行用于获取属性的变量和方法。通过使用内置的 JSF 功能，我节省了时间和宝贵的代码行。

即使问题已被标记为已回答，也只是我的 2 美分。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-14T03:20:32.113

我可能不会回答你的每一个问题，因为似乎很少有人会视情况而定。

*   在您的支持 bean 中有业务逻辑很好。这取决于你来自哪里。如果您正在实践领域驱动设计，您会很想将业务逻辑包含在支持 bean 中，或者也可能包含持久性逻辑。他们争论为什么这么愚蠢的对象。对象不仅应该携带状态，还应该携带行为。另一方面，如果您考虑传统的 Java EE 做事方式，您可能会觉得在您的支持 bean 中有数据，它也可以是您的实体 bean，以及某些会话 bean 或其他东西中的其他业务和持久性逻辑。那也很好。

*   为整个页面设置单个支持 bean 非常好。我认为仅此一项没有任何问题。这可能看起来不正确，但这取决于具体情况。

*   您的另一个问题更多地取决于您手头的情况。我更愿意在这里进行域驱动，将属性添加到现有的或为此创建一个新的 bean 可能是合适的。哪个更适合。我认为这没有什么灵丹妙药。

*   哪些属性属于哪个支持 bean。那么，它不依赖于域对象吗？或者问题可能不是那么清楚。

此外，在您给定的代码示例中，我没有看到任何巨大的好处。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-14T03:21:24.810

我不需要每页只保留一个支持 bean。这取决于功能，但大多数时候我每页有一个 bean，因为大多数情况下一个页面处理一个功能。例如，在一个页面上，我有一个注册链接（我将使用 RegisterBean 链接）和一个购物篮链接（ShoopingBasketBean）。

我确实使用了这个 <:outputText value="#{myBean.anObject.anObjectProperty}" />，因为我通常将支持 bean 作为保存数据对象的操作 bean。我不想在我的支持 bean 中编写一个包装器来访问我的数据对象的属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-13T14:23:07.870

我喜欢在没有 View 的情况下测试业务代码，因此我将 BackingBeans 视为从 View 到 Model 代码的接口。我从来没有在 BackingBean 中放置任何规则或流程。该代码进入服务或帮助程序，允许重用。

如果您使用验证器，请将它们从您的 BackingBean 中取出并从您的验证方法中引用它们。

如果您访问 DAO 来填充 Selects、Radios、Checkboxes，请始终从 BackingBean 中执行此操作。

相信我！。您可以将 JavaBean 注入到 BackingBean 中，但尝试将 BackingBean 注入到另一个中。你很快就会陷入维护和理解代码的噩梦中。

# c# - C# 属性可以接受多个值吗？

> ID：746048
> 
> 赞同：8
> 
> 时间：2009-04-14T01:52:07.660
> 
> 标签：c#, .net, properties, anti-patterns

这可能有点反模式，但是 C# 类上的属性是否可以接受多个值？

例如，假设我有一个 Public int 属性，我总是希望它返回一个 int，但我希望能够通过分配小数、整数或其他数据类型来设置属性。所以我的问题是属性是否可以接受多个值？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-14T01:55:30.850

我认为您要问的是：**[隐式](http://msdn.microsoft.com/en-us/library/z5z9kes2.aspx)****和****[显式](http://msdn.microsoft.com/en-us/library/xhbhezf4.aspx)****转换****如何为and工作？`int``decimal`**

您正在询问隐式转换，它会自动将一个对象转换为另一种定义的类型。您将无法为 an 执行此操作`int`，`decimal`因为它们已经在框架中定义，并且您无法`decimal`通过将其转换为来缩小范围`int`。但是，如果您将其用作您创建的实际对象的示例，则可以使用上面的[隐式](http://msdn.microsoft.com/en-us/library/z5z9kes2.aspx)链接，以了解有关其工作原理以及如何实现它的更多信息。

但是您始终可以使用 convert 方法将它们转换为正确的类型；

```
public int MyProperty { get; set; }
...
obj.MyProperty = Convert.ToInt32(32.0M);
obj.MyProperty = Convert.ToInt32(40.222D);
obj.MyProperty = Convert.ToInt32("42"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T01:58:59.080

**编辑：**由于操作专门绑定到属性，因此无法使用此方法。

我不相信您描述的稳健性是可能的。**在这种情况下，使用重载方法**（多态性）可能会更好。

这就是通常所说的*setter*（或 mutator），您可以重载该方法以接受多种不同类型的参数。如果您愿意，每个都将执行不同的操作。我设置它们的方式可能在语法上不正确，但我相信这是您正在寻找的一般想法。

```
public class MyClass {
  private Int32 mySomeValue;
  public void setSomeValue(Double value) { this.mySomeValue = Convert.ToInt32(value); }
  public void setSomeValue(Int32 value) { this.mySomeValue = value; }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T01:54:15.517

没有。一个属性只有一个值。您可以为它分配任何可以分配给相同类型变量的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T01:55:02.473

似乎您必须在运行时确定类型。你可以让属性接受一个对象，确定类型并采取你的行动。当然，您将不得不为您不期望的事情抛出异常。就像你说的，可能不是最好的，但可能。:)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-14T01:54:14.677

属性应该看起来有点像公共字段。创建 setter 方法，或在赋值语句中进行转换/转换，而不是在 property-setter 中。

# flash - 保存文件 ActionScript 3.0 + Jugglor 和 JSave

> ID：746057
> 
> 赞同：2
> 
> 时间：2009-04-14T01:56:23.580
> 
> 标签：flash, actionscript-3

我有一个 Flash 项目，我需要将文件保存到用户本地计算机。我曾认为 Flash 包含用于处理文件的工具，但显然这在 Flash Player 10 出现之前不会实现。

我正在使用 ActionScript 3 使用 CS3，我认为也许 Jugglor 工具 JSave 可能能够完成我想做的事情，但是在 Flash MX 之后在任何东西上使用 JSave 的文档基本上不存在。

有谁知道如何在 ActionScript 3 中使用 JSave 来保存文件或有更好的解决方案在 Flash 中保存文件？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T02:24:15.197

如果您愿意将您的应用程序从 Web 带到桌面，Adobe AIR 就是您的解决方案。通过 Adob​​e Update Manager 更新您的 Flash CS3 安装，您将能够在 Flash 应用程序中使用 Adob​​e AIR。

编辑：如果您的应用程序需要留在网络上，您可以使用 AS3 类 FileReference 来实例化操作系统下载对话框，并以这种方式将文件保存到用户的计算机上，但您将无法指定用户系统的位置创建文件或是否创建文件，因为这取决于用户决定做什么。

根据您需要完成的任务，您可以使用本地共享对象。这本质上是 Flash 的 cookie 版本。

# ruby-on-rails - environment.rb 中设置的常量在开发模式下消失

> ID：746063
> 
> 赞同：5
> 
> 时间：2009-04-14T02:01:24.580
> 
> 标签：ruby-on-rails, ruby

了解rails缓存如何工作的人可以在这里真正帮助我。这是嵌套在 Rails::Initializer.run 块内的代码：

```
config.after_initialize do
  SomeClass.const_set 'SOME_CONST', 'SOME_VAL'
end 
```

现在，如果我运行`script/server`并提出请求，一切都是花花公子。然而，在我的 Rails 应用程序的第二个请求中，一切都因一个统一的常量错误而陷入困境。在生产模式下，我可以成功发出第二个请求，这意味着常量仍然存在。

我已通过将上述内容更改为：

```
config.after_initialize do
  require 'some_class' # in RAILS_ROOT/lib/some_class.rb
  SomeClass.const_set 'SOME_CONST', 'SOME_VAL'
end 
```

但是现在这意味着每当我对 some_class.rb 进行更改时，我都必须重新启动服务器。有没有办法在环境文件中设置常量并让它们在开发模式下正常工作？为什么常量存在于第一个请求中，但不存在于以下请求中？

**更新：**由于 environment.rb 仅在 Rails 应用程序启动时读取，并且我希望在每次请求时都重新加载我的 lib 文件和模型，因此我被迫将常量移动到 some_class.rb 文件中，如下所示：

```
if Rails.env.development?
  const_set 'SOME_CONST', 'SOME_DEVELOPMENT_VAL'
end 
```

在 environment/production.rb 中，我有旧的 const_set 代码。

**更新：**下面详细介绍了使用 config.to_prepare 的更好方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-14T05:33:10.157

它仅适用于开发模式下的第一个请求，因为每个请求都会重新加载类。所以在第一个请求中，常量被设置在初始化器中，一切都很好。然后在下一个请求中，它会重新加载类而不重新运行初始化程序中的位，因此不会从那里设置常量。

它在生产模式下工作，因为不会为每个请求重新加载类，因此您不会每次都丢失那一点类状态。

因此，您可能希望在模型中或在 a 中设置`config.to_prepare`常量`config.after_initialize`。`to_prepare`在每个请求之前调用。

在模型中：

```
class SomeClass < ActiveRecord::Base
  MY_CONST = "whatever"

  # You can access MY_CONST directly, but I tend to wrap them in a class 
  # method because literal constants often get refactored into the database.
  def self.my_const
    MY_CONST 
  end
end 
```

在配置中：

```
# This will run before every single request. You probably only want this in
# the development config.
config.to_prepare do
  SomeClass.const_set 'SOME_CONST', 'SOME_VAL'
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T03:18:31.463

生产模式预加载所有类，而在开发模式中，类在读取配置文件*后根据需要加载。*在配置中手动要求它们会强制在配置阶段之前/期间读取类。

# wpf - WPF Datagrid -DataGridTemplateColumn 选项卡焦点问题

> ID：746069
> 
> 赞同：22
> 
> 时间：2009-04-14T02:04:34.447
> 
> 标签：wpf, datagrid, datagridtemplatecolumn

我正在使用 Microsoft WPF 数据网格。我注意到 WPF 数据网格 DataGridTemplateColumn 的奇怪行为。当您在网格中使用 templateColumn 并且模板列包含一些控件时，当您从前一列中选择时，焦点不会自动赋予模板列中声明的第一个元素。焦点最初设置在模板列的边框上，当我们再次进行选项卡时，焦点转到第一列。此问题的任何解决方法。当我关闭标签时，如何将焦点设置为数据网格模板列中的第一个元素。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-11-08T15:34:50.243

我们通过修改 DataGridCell 上的样式解决了这个问题：

```
<Style x:Key="DataGridCellStyle" TargetType="{x:Type DataGridCell}">
    <Setter Property="IsTabStop" Value="False"/> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-05-14T15:42:38.573

我通过处理网格的 PrepareCellForEdit 事件解决了这个问题。这是代码

```
void HODataGrid_PreparingCellForEdit(object sender, DataGridPreparingCellForEditEventArgs e)
{
      UIElement inputElement;
      ///
      /// Texbox is the first control in my template column
      ///
      inputElement = HODataGridHelper.GetVisualChild<TextBox>(e.EditingElement);
      if (inputElement != null)
      {
           Keyboard.Focus(inputElement);
      }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-27T17:09:53.110

有一个使用静态类的解决方案，并对 Xaml 进行一次更改以获取您想要关注的控件。“ [WPF DataGrid：从一个单元格切换到另一个单元格不会将焦点设置在控件上](http://iyalovoi.wordpress.com/2009/08/21/wpf-datagrid-tabbing-from-cell-to-cell-does-not-set-focus-on-control/)”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T02:31:14.277

我在 WPF datagrid codeplex 讨论中找到了一个链接 [http://www.codeplex.com/wpf/Thread/View.aspx?ThreadId=35540](http://www.codeplex.com/wpf/Thread/View.aspx?ThreadId=35540)

感谢文森特西巴尔

# asp.net - ASP.NET：滚动到控制

> ID：746070
> 
> 赞同：9
> 
> 时间：2009-04-14T02:04:35.947
> 
> 标签：asp.net, controls, scroll, focus

我在一个页面中有一个特别大的表格。当表单经过验证并且字段无效时，我想将窗口滚动到该控件。调用控件的 Focus() 似乎没有这样做。我找到了一种 JavaScript 解决方法来将窗口滚动到控件，但是 ASP.NET 中有内置的东西吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-20T19:31:46.200

```
Page.MaintainScrollPositionOnPostBack = False
Page.SetFocus(txtManagerName) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T00:00:18.933

您是否在页面上使用验证摘要？

如果是这样，ASP.NET[会呈现一些 javascript 以自动滚动到页面顶部，](https://stackoverflow.com/questions/699171/asp-net-validation-summary-causes-page-to-jump-to-top)这很可能会覆盖客户端验证的自动行为以聚焦最后一个无效控件。

另外，您是否关闭了客户端验证？

如果您查看客户端验证生成的 javascript，您应该会看到如下方法：

```
function ValidatorValidate(val, validationGroup, event) {
  val.isvalid = true;
  if ((typeof(val.enabled) == "undefined" || val.enabled != false) && 
      IsValidationGroupMatch(val, validationGroup)) {
    if (typeof(val.evaluationfunction) == "function") {
      val.isvalid = val.evaluationfunction(val);
      if (!val.isvalid && Page_InvalidControlToBeFocused == null &&
          typeof(val.focusOnError) == "string" && val.focusOnError == "t") {
        ValidatorSetFocus(val, event);
      }
    }
  }
  ValidatorUpdateDisplay(val);
} 
```

请注意对 ValidatorSetFocus 的调用，这是一个相当长的方法，它尝试将焦点设置到相关控件，或者如果您有多个错误，则使用（最终）使用以下行将焦点设置到已验证的最后一个控件：

```
if (typeof(ctrl.focus) != "undefined" && ctrl.focus != null) {
  ctrl.focus();
  Page_InvalidControlToBeFocused = ctrl;
} 
```

为了使这种行为发挥作用，理想情况下，您需要确保所有验证器都设置为客户端 - 服务器端验证器显然需要回发，这可能会影响事情（即失去焦点/位置） - 并设置 MaintainScrollPositionOnPostBack为 true 可能会导致页面重新加载到提交按钮，而不是无效的表单元素。

使用服务器端 .Focus 方法将导致 ASP.NET “在页面加载时”（即靠近页面底部）呈现一些 javascript，但这可能会被上面讨论的其他机制之一覆盖。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-14T23:59:23.633

所以我相信问题是因为我试图专注于 HtmlGenericControls 而不是 WebControls。

我刚刚结束了基于以下的解决方法：

[http://ryanfarley.com/blog/archive/2004/12/21/1325.aspx](http://ryanfarley.com/blog/archive/2004/12/21/1325.aspx) [http://www.codeproject.com/KB/aspnet/ViewControl.aspx](http://www.codeproject.com/KB/aspnet/ViewControl.aspx)

……为了时间。

```
public static void ScrollTo(this HtmlGenericControl control)
{
    control.Page.RegisterClientScriptBlock("ScrollTo", string.Format(@"

        <script type='text/javascript'> 

            $(document).ready(function() {{
                var element = document.getElementById('{0}');
                element.scrollIntoView();
                element.focus();
            }});

        </script>

    ", control.ClientID));
} 
```

用法：

```
if (!this.PropertyForm.Validate())
{
    this.PropertyForm.ErrorMessage.ScrollTo();
    failed = true;
} 
```

（虽然看起来 Page.RegisterClientScriptBlock() 已被 Page.ClientScript.RegisterClientScriptBlock() 弃用）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T02:08:01.180

添加 MaintainScrollPositionOnPostback 是最接近 ASP.NET 内置的，但不一定会跳转到无效字段。

```
<%@ Page MaintainScrollPositionOnPostback="true" %> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-06-01T10:35:41.547

非常简单的解决方案是将RequiredFieldValidator（或您正在使用的任何验证器控件）的SetFocusOnError 属性设置为true

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T02:08:23.097

您确定[Focus()](http://msdn.microsoft.com/en-us/library/system.web.ui.control.focus.aspx)不会做您所描述的事情吗？在底层，它本质上是在做“JavaScript 变通办法”——它将一些 JS 写入页面，该页面调用具有匹配 ID 的控件上的 focus()：

在页面完成处理之前最后调用 Focus() 的任何控件都将其写入页面：

```
<script type="text/javascript">
//<![CDATA[
WebForm_AutoFocus('txtFocus2');//]]>
</script> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-14T02:07:47.653

你应该看看 jQuery 和 ScrollTo 插件

[http://demos.flesler.com/jquery/scrollTo/](http://demos.flesler.com/jquery/scrollTo/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-14T23:39:37.330

我已经使用基本的[HTML 片段](http://www.w3.org/TR/html401/intro/intro.html#fragment-uri)实现了类似的功能。您只需留下一个具有已知 ID 的元素：

```
<span id="CONTROL-ID"></span> 
```

然后通过脚本，在服务器端更改 url：

```
window.location += "#CONTROL-ID"; 
```

在第一种情况下，页面不会重新加载，它只会向下滚动到控件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-02-28T15:54:35.497

粘贴以下 Javascript：

```
function ScrollToFirstError() {
        Page_ClientValidate();
        if (Page_IsValid == false) {
            var topMostValidator;
            var lastOffsetTop;
            for (var i = 0; i < Page_Validators.length; i++) {
                var vld = Page_Validators[i];
                if (vld.isvalid == false) {
                    if (PageOffset(vld) < lastOffsetTop || lastOffsetTop == undefined) {
                        topMostValidator = vld;
                        lastOffsetTop = vld.offsetTop;
                    }
                }
            }
            topMostValidator.scrollIntoView();
        }
        return Page_IsValid;
    }

    function PageOffset(theElement) {
        var selectedPosY = 0;
        while (theElement != null) {
            selectedPosY += theElement.offsetTop;
            theElement = theElement.offsetParent;
        }
        return selectedPosY;
    } 
```

然后在正在保存的按钮的 OnClientClick 中调用 ScrollToFirstError()，确保该按钮也具有 CausesValidation=true。

你有它。

# php - mysql准备好的语句参数和排序查询

> ID：746075
> 
> 赞同：2
> 
> 时间：2009-04-14T02:07:54.800
> 
> 标签：php, sql, mysql

我有一个表格，其目的是将当前显示的记录放入一个类别中。我正在通过 php 使用以下 html 代码来执行此操作：

```
<form name="categoryForm">
  <input name="radiobutton" type="radio" value="fakeapproved" />Fake (Approved)<p>
  <input name="radiobutton" type="radio" value="fakesuspected" />Fake (Suspected)<p>
  <input name="radiobutton" type="radio" value="keyword" />Forbidden Keywords<p>
  <input name="radiobutton" type="radio" value="parallelimport" />Parallel Imports
  <input name="Submit" type="submit" value="Update" onclick="handleClick(".$pk.");return false"/>
</form> 
```

目前，我只有一个 AUCTIONS 表，其中包含一个类别列，并且该列设置为我的表单中定义的类别之一。

这种方法对我需要处理的数据无效，因此我计划将其更改为每个类别都有一个单独的列，可以将其设置为 true 或 false。

我想知道的是，是否可以在我的 sql 查询中使用我的表单中定义并通过我的 javascript 函数获得的文本。

例如，更新拍卖集 $textfromfrom = true

目前，我正在使用以下准备好的语句：

```
if($cmd=="addcat"){
  $alterQuery = "UPDATE auctions SET category = ? WHERE article_no= ?";
  if ($altRecord = $con->prepare($alterQuery)) {
    $altRecord->bind_param("ss", $subcat, $pk);
    $altRecord->execute();
    $altRecord->close();
    echo "true";
  } else {
    echo "false";
  }
} 
```

有没有办法更换

```
$alterQuery = "UPDATE auctions SET category = ? WHERE article_no= ?"; 
```

$alterQuery = "更新拍卖集？= true WHERE article_no=？";

是否也可以直接执行单独的查询，即：

```
if($cmd=="addcat"){
  $alterQuery = "UPDATE auctions SET ? = true WHERE article_no= ?";
  $insertQuery = "INSERT into users (username, ?) values ?, true";
  if ($altRecord = $con->prepare($alterQuery)) {
    $altRecord->bind_param("ss", $category, $pk);
    $altRecord->execute();
  if ($insRecord = $con->prepare($insertQuery)) {
    $insRecord->bind_param("ss", $category, $username);
    $insRecord->execute();
    $insRecord->close();
  }
  $altRecord->close();
  echo "true";
} else {
  echo "false";
} 
```

我使用上述方法的理由如下：

拍卖数据库是从另一个来源导入的，我根本无法更改结构，除了在末尾添加类别。不得更改主键等。

只有4个类别

单个拍卖可能属于多个类别

拍卖表只处理拍卖。我需要一个用户表，它主要包含新的用户输入。

用户表必须能够为每个用户显示他们参与拍卖的类别。

每个用户的 users 表中不能有超过一条记录。用户名将用作主键。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T02:23:53.717

哎呀，经典的数据库非规范化即将发生。你不想这样做。您*希望*将其保留为单个列，或者，似乎需要在拍卖和类型之间创建一对多的关系。出现问题的第一个迹象是，做你想做的事没有捷径可走。

更好的方法是创建一个拍卖表和一个 categoryAuctionForm 表......

它看起来像：

```
auctions Table:
auction_id 
---------
0
1
2
3

auctions Type:
auction_type_id auction_id auction_type
1               0          something
2               0          othertype
3               0          fake
4               1          othertype
5               2          fake
6               3          fake 
```

您还可以添加更多级别的规范化，例如创建 auction_type 列。

只是我的想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T02:19:31.433

准备查询的重点是，除了数据之外，什么都不会改变。您可以为您拥有的每个类别准备不同的查询（将它们放入按类别名称索引的数组中）。但我怀疑准备查询实际上会在这里产生任何影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T03:19:06.297

> $alterQuery = "更新拍卖 SET ? = true WHERE article_no= ?";

不，您不能将查询参数用于列名。查询参数只能用于代替 SQL 表达式中的文字值*。*

您必须使用动态 SQL。也就是说，将 SQL 语句形成为字符串，并将您的应用程序变量作为列名插入到此字符串中。

# mono - 有人有在 Mono 下使用 CSLA 的经验吗？

> ID：746079
> 
> 赞同：5
> 
> 时间：2009-04-14T02:08:39.523
> 
> 标签：mono, csla

我非常尊重 Mono 和 CSLA。我想在非 Microsoft 操作系统上使用 CSLA。我接受 Mono 总是落后于 Microsoft 两步的事实，但 Mono 支持足够多的 .Net 框架来促进各种有趣的应用程序。我也意识到 Mono 不支持许多 3.0 .Net 附加功能，例如 WPF（尽管它必须在很小程度上才能使 Moonlight 起作用）。对于我目前的需求，WPF 支持并不重要，WCF 也不重要。我衷心感谢 Rocky 在 CSLA 中实施并继续维护的所有繁琐的数据绑定支持。对于许多应用程序，这是我看到 CSLA 增加实质性价值的地方。我意识到 CSLA 带来了许多其他功能，但对我来说数据绑定非常重要。我怀疑 Mono 下 CSLA 的主要兼容性问题集中在 Mono 没有实现所有 .Net 数据绑定细微差别（尤其是 DataGrids）和序列化格式差异。我对如何解决这些感知到的问题有一些想法，但我很想听听任何已经走在这条路上的人的意见。

编辑：对于它的价值，我确实在很久以前在 CSLA 论坛上发布了这个确切的问题。CSLA 社区和 Rocky 可以快速回答问题。然而，这个问题从未得到任何答案。我相信原因很简单：Rocky 长期以来一直只专注于 MS 技术。这一点我不怪他。Rocky 对 CSLA 进行了大量投资。他是仁慈的独裁者。我很感谢他让 CSLA 开源。我怀疑他有足够的问题来跟上微软世界每隔几年发生的主要 API 流失。Linux/Mac OS 可能不在他的关注范围内。它可能不应该是......目前无论如何。大多数 Linux 或 Mac OS 人员甚至从未听说过 CSLA。

您可以随时 fork 源、剥离、增强等以使其与 Mono 一起使用。如果您这样做，您将不会有 CSLA 社区在您身后（至少目前如此）。出于这个原因，我放弃了这种努力。

**更新：** Rocky 现在似乎对 Mono 很感兴趣。查看[CSLA 路线图](http://www.lhotka.net/cslanet/Roadmap.aspx)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-22T17:22:27.903

我会尝试下载 CSLA.NET 源代码并尝试在 Mono 下编译它。我自己没有做过，但可能就这么简单。您甚至可以尝试不同版本的代码，因为最新版本的 CSLA.NET 使用了许多目前可能无法转换的 .NET 新功能。我认为这将是一个有趣的开源项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-23T15:47:49.863

对于遇到此问题的任何人，CSLA 现在完全支持 Mono。现在在 CSLA 论坛上也有大量的讨论（[http://forums.lhotka.net/search/SearchResults.aspx?q=mono](http://forums.lhotka.net/search/SearchResults.aspx?q=mono)）

# svn - 撤消 SVN 删除 ./* --force

> ID：746080
> 
> 赞同：8
> 
> 时间：2009-04-14T02:10:25.010
> 
> 标签：svn, disaster-recovery

我没有意识到`svn delete`会删除我的本地副本，我只是想把它从存储库中删除。现在我所有的文件都不见了，它们也不在垃圾桶里。有什么办法可以恢复它们吗？

* * *

我应该澄清一下，这些文件*从未*进入存储库。我试图摆脱存储库中的一些旧垃圾，以便我可以将它们签入。

我在 ext3 文件系统上运行 Ubuntu。不过没关系....我设法重做我在大约 2 小时内删除的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T02:12:53.460

**没有。**

除非它们仍在被其他应用程序使用，否则抱歉。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T02:14:17.107

您不能在新目录中再次检查您正在工作的内容吗？如果您有任何未版本化的更改，那么您就是 SOL，其他任何您都可以 svn 恢复到存储库中的最新版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-30T16:12:42.317

进入文件目录，

```
svn revert "filename" 
```

将恢复本地已删除但尚未提交但已受版本控制的任何文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T05:13:45.180

您已使用“svn delete”命令并删除了本地副本。这意味着原始版本的文件仍然存在于 SVN 历史中。'svn delete' 不会从存储库中删除文件的历史记录。您可以通过以下方式恢复上一个版本

1.  检查 SVN 日志并找出“删除操作”的修订号。
2.  使用“svn checkout”检查“删除操作”之前的修订。（例如，如果删除操作的修订号是 100，则检查修订号 99） svn checkout --revision

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T05:19:45.027

根据您的 SVN 客户端，您应该能够使用 Tortoise 中调用的“显示日志”从以前的版本中获取这些文件...

只需打开日志找到该文件仍然存在的修订版并“恢复到此修订版”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T05:55:45.173

如果您在 Windows 下，您可以检查（部分）免费工具名称[零假设恢复](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.z-a-recovery.com%2F&ei=CyXkSeOYF6To6gPm2an9Cg&usg=AFQjCNGv2yUddK5QXfbWVeCWTRdDnURxlA&sig2=B-16R59M9L1TKJLkcBiGNg)。当您在 Windows 上删除文件时真的很有帮助！

或者，如果您启用了它并且您正在使用 vista，您可以在它的属性中检查文件夹的“以前的版本”。

希望能帮助到你！祝你好运。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-28T12:04:07.787

您运行命令*svn log*并获取不愉快删除的修订号。然后运行*​​svn merge -r2572:2571 svn://$PATH_WHERE_YOU_DELETED_NUMBER_WAS_ON_SVN_SERVER &LOCAL_PATH_WHERE_TO_SAVE_FILE*

其中 -r 是修订号

示例合并 -r2572:2571 svn://www.jane16.com/var/opt/svn/mypoject/Start.java C:/ecplipse/workspace/myporject/Start.java

# algorithm - 如何从字母矩阵中找到可能的单词列表 [Boggle Solver]

> ID：746082
> 
> 赞同：385
> 
> 时间：2009-04-14T02:11:33.013
> 
> 标签：algorithm, puzzle, boggle

最近我一直在我的 iPhone 上玩一个名为 Scramble 的游戏。你们中的一些人可能将这款游戏称为 Boggle。本质上，当游戏开始时，您会得到一个字母矩阵，如下所示：

```
F X I E
A M L O
E W B X
A S T U 
```

游戏的目标是找到尽可能多的单词，这些单词可以通过将字母链接在一起形成。您可以从任何字母开始，并且围绕它的所有字母都是公平的游戏，然后一旦您继续下一个字母，围绕该字母的所有字母都是公平的游戏，**除了以前使用的任何字母**。因此，例如，在上面的网格中，我可以想出单词`LOB`、`TUX`、`SEA`、`FAME`等。单词必须至少为 3 个字符，并且不超过 NxN 个字符，在这个游戏中为 16，但在某些实现中可能会有所不同. 虽然这个游戏很有趣而且让人上瘾，但我显然不太擅长它，我想通过制作一个可以给我最好的单词的程序来作弊（单词越长，你得到的分数越多）。

[![样品拼图](https://i.stack.imgur.com/qLLPp.gif)](https://i.stack.imgur.com/qLLPp.gif)
[（来源：[boggled.org](http://www.boggled.org/sample.gif)）]

不幸的是，我不太擅长算法或其效率等等。我的第一次尝试使用了[这样](http://www.freebsd.org/cgi/cvsweb.cgi/src/share/dict/web2?rev=1.12;content-type=text%2Fplain)的字典（~2.3MB），并进行了线性搜索，试图将组合与字典条目进行匹配。这需要*很*长时间才能找到可能的单词，而且由于每轮只有 2 分钟，这根本不够。

我有兴趣看看是否有任何 Stackoverflowers 可以提出更有效的解决方案。我主要在寻找使用 Big 3 Ps 的解决方案：Python、PHP 和 Perl，尽管使用 Java 或 C++ 的任何东西也很酷，因为速度是必不可少的。

**当前解决方案**：

*   亚当·罗森菲尔德，Python，~20 多岁
*   John Fouhy，Python，~3s
*   Kent Fredric, Perl, ~1s
*   Darius Bacon, Python, ~1s
*   rvarcher, VB.NET, ~1s
*   Paolo Bergantino, PHP [(live link)](http://www.rootspot.com/stackoverflow/boggle.php) , ~5s (~2s local)

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2009-04-15T02:00:37.647

我的答案与此处的其他答案一样有效，但我会发布它，因为它看起来比其他 Python 解决方案更快，因为它可以更快地设置字典。（我根据 John Fouhy 的解决方案对此进行了检查。）设置后，解决问题的时间减少了。

```
grid = "fxie amlo ewbx astu".split()
nrows, ncols = len(grid), len(grid[0])

# A dictionary word that could be a solution must use only the grid's
# letters and have length >= 3\. (With a case-insensitive match.)
import re
alphabet = ''.join(set(''.join(grid)))
bogglable = re.compile('[' + alphabet + ']{3,}$', re.I).match

words = set(word.rstrip('\n') for word in open('words') if bogglable(word))
prefixes = set(word[:i] for word in words
               for i in range(2, len(word)+1))

def solve():
    for y, row in enumerate(grid):
        for x, letter in enumerate(row):
            for result in extending(letter, ((x, y),)):
                yield result

def extending(prefix, path):
    if prefix in words:
        yield (prefix, path)
    for (nx, ny) in neighbors(path[-1]):
        if (nx, ny) not in path:
            prefix1 = prefix + grid[ny][nx]
            if prefix1 in prefixes:
                for result in extending(prefix1, path + ((nx, ny),)):
                    yield result

def neighbors((x, y)):
    for nx in range(max(0, x-1), min(x+2, ncols)):
        for ny in range(max(0, y-1), min(y+2, nrows)):
            yield (nx, ny) 
```

示例用法：

```
# Print a maximal-length word and its path:
print max(solve(), key=lambda (word, path): len(word)) 
```

**编辑：**过滤掉长度少于 3 个字母的单词。

**编辑 2：**我很好奇为什么 Kent Fredric 的 Perl 解决方案更快；结果是使用正则表达式匹配而不是一组字符。在 Python 中做同样的事情会使速度翻倍。

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2009-04-14T02:19:18.437

您将获得的最快解决方案可能涉及将您的字典存储在[trie](http://en.wikipedia.org/wiki/Trie)中。然后，创建一个三元组队列 ( *x* , *y* , *s* )，其中队列中的每个元素对应于可以在网格中拼写的单词的前缀*s ，在位置 (* *x* , *y* ) 处结束。*使用N* x *N*个元素（其中*N*是网格的大小）初始化队列，网格中的每个正方形一个元素。然后，算法进行如下：

```
当队列不为空时：
  出列一个三元组 (x, y, s)
  对于与 (x, y) 相邻的字母 c 的每个正方形 (x', y')：
    如果 s+c 是一个单词，则输出 s+c
    如果 s+c 是单词的前缀，则将 (x', y', s+c) 插入到队列中

```

如果您将字典存储在 trie 中，则可以在恒定时间内测试*s* + *c*是单词还是单词的前缀（前提是您还在每个队列数据中保留了一些额外的元数据，例如指向当前节点的指针在 trie 中），因此该算法的运行时间为 O（可以拼写的单词数）。

**[编辑]**这是我刚刚编写的 Python 实现：

```
#!/usr/bin/python

class TrieNode:
    def __init__(self, parent, value):
        self.parent = parent
        self.children = [None] * 26
        self.isWord = False
        if parent is not None:
            parent.children[ord(value) - 97] = self

def MakeTrie(dictfile):
    dict = open(dictfile)
    root = TrieNode(None, '')
    for word in dict:
        curNode = root
        for letter in word.lower():
            if 97 <= ord(letter) < 123:
                nextNode = curNode.children[ord(letter) - 97]
                if nextNode is None:
                    nextNode = TrieNode(curNode, letter)
                curNode = nextNode
        curNode.isWord = True
    return root

def BoggleWords(grid, dict):
    rows = len(grid)
    cols = len(grid[0])
    queue = []
    words = []
    for y in range(cols):
        for x in range(rows):
            c = grid[y][x]
            node = dict.children[ord(c) - 97]
            if node is not None:
                queue.append((x, y, c, node))
    while queue:
        x, y, s, node = queue[0]
        del queue[0]
        for dx, dy in ((1, 0), (1, -1), (0, -1), (-1, -1), (-1, 0), (-1, 1), (0, 1), (1, 1)):
            x2, y2 = x + dx, y + dy
            if 0 <= x2 < cols and 0 <= y2 < rows:
                s2 = s + grid[y2][x2]
                node2 = node.children[ord(grid[y2][x2]) - 97]
                if node2 is not None:
                    if node2.isWord:
                        words.append(s2)
                    queue.append((x2, y2, s2, node2))

    return words 
```

示例用法：

```
d = MakeTrie('/usr/share/dict/words')
print(BoggleWords(['fxie','amlo','ewbx','astu'], d)) 
```

输出：

> ['fa'，'xi'，'ie'，'io'，'el'，'am'，'ax'，'ae'，'aw'，'mi'，'ma'，'me'，' lo'、'li'、'oe'、'ox'、'em'、'ea'、'ea'、'es'、'wa'、'we'、'wa'、'bo'、'bu' ，'as'，'aw'，'ae'，'st'，'se'，'sa'，'tu'，'ut'，'fam'，'fae'，'imi'，'eli'，'榆树'，'elb'，'ami'，'ama'，'ame'，'aes'，'awl'，'awa'，'awe'，'awa'，'mix'，'mim'，'mil' , 'mam', 'max', 'mae', 'maw', 'mew', 'mem', 'mes', 'lob', 'lox', 'lei'，'leo'，'lie'，'lim'，'oil'，'olm'，'ewe'，'eme'，'wax'，'waf'，'wae'，'waw'，'wem' ，'wea'，'wea'，'was'，'waw'，'wae'，'bob'，'blo'，'bub'，'but'，'ast'，'ase'，'asa'，'锥子'，'awa'，'敬畏'，'awa'，'aes'，'swa'，'swa'，'sew'，'sea'，'sea'，'saw'，'tux'，'tub' ，'tut'，'twa'，'twa'，'tst'，'utu'，'fama'，'名望'，'ixil'，'imam'，'amli'，'amil'，'ambo'，' axil'，'轴'，'mimi'，'mima'，'mime'，'milo'，'英里'，'mewl'，'mese'，'mesa'，'lolo'，'lobo'，'lima'，'lime'，'limb'，'lile'，'oime'，'oleo'，'olio' , '双簧管', 'obol', 'emim', 'emil', 'east', 'ease', 'wame', 'wawa', 'wawa', 'weam', 'west', 'wese', ' wast'，'wase'，'wawa'，'wawa'，'boil'，'bolo'，'bole'，'bobo'，'blob'，'bleo'，'bubo'，'asem'，'stub' , 'stut', 'swam', 'semi', 'seme', 'seam', 'seax', 'sasa', 'sawt', 'tutu', 'tuts', 'twae', 'twas', ' twae'，'ilima'，'amble'，'axile'，'awest'，'mamie'，'mambo'，'maxim'，'mease'，'mesem'，'limax'，'limes'，'limbo'，'limbu'，'obole'，'emesa'，' embox'、'awest'、'swami'、'famble'、'mimble'、'maxima'、'embolo'、'embole'、'wamble'、'semese'、'semble'、'sawbwa'、'sawbwa' ]锯子']锯子']

注意：这个程序不输出 1 个字母的单词，或者根本不按字长过滤。这很容易添加，但与问题并不真正相关。如果可以以多种方式拼写，它还会多次输出一些单词。如果一个给定的单词可以用许多不同的方式拼写（最坏的情况：网格中的每个字母都是相同的（例如'A'）并且像'aaaaaaaaaa'这样的单词在你的字典中），那么运行时间将变成可怕的指数. 在算法完成后过滤掉重复项和排序是微不足道的。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-04-14T10:02:13.240

对于字典加速，您可以执行一个通用转换/过程来提前大大减少字典比较。

鉴于上述网格仅包含 16 个字符，其中一些是重复的，您可以通过简单地过滤掉具有无法获得的字符的条目来大大减少字典中的总键数。

我认为这是明显的优化，但看到没有人这样做我提到它。

仅在输入过程中，它就将我从 200,000 个键的字典减少到只有 2,000 个键。这至少减少了内存开销，并且肯定会映射到某个地方的速度增加，因为内存不是无限快的。

## Perl 实现

我的实现有点头重脚轻，因为我重视能够知道每个提取字符串的确切路径，而不仅仅是其中的有效性。

我在那里也有一些改编，理论上可以允许其中有孔的网格起作用，以及具有不同大小线的网格（假设你得到正确的输入并且它以某种方式排列）。

早期过滤器是迄今为止我的应用程序中最*重要*的瓶颈，正如之前所怀疑的那样，注释掉该行使其从 1.5s 膨胀到 7.5s。

执行后，它似乎认为所有单个数字都是它们自己的有效单词，但我很确定这是由于字典文件的工作方式。

它有点臃肿，但至少我重用了来自 cpan的[Tree::Trie](http://p3rl.org/Tree::Trie)

其中一些部分受到现有实现的启发，其中一些我已经想到了。

欢迎提出建设性的批评和可以改进的方法（/me 指出他从未[在 CPAN 中搜索过一个难以置信的求解器](http://p3rl.org/Games::Boggle)，但这更有趣）

**更新新标准**

```
#!/usr/bin/perl 

use strict;
use warnings;

{

  # this package manages a given path through the grid.
  # Its an array of matrix-nodes in-order with
  # Convenience functions for pretty-printing the paths
  # and for extending paths as new paths.

  # Usage:
  # my $p = Prefix->new(path=>[ $startnode ]);
  # my $c = $p->child( $extensionNode );
  # print $c->current_word ;

  package Prefix;
  use Moose;

  has path => (
      isa     => 'ArrayRef[MatrixNode]',
      is      => 'rw',
      default => sub { [] },
  );
  has current_word => (
      isa        => 'Str',
      is         => 'rw',
      lazy_build => 1,
  );

  # Create a clone of this object
  # with a longer path

  # $o->child( $successive-node-on-graph );

  sub child {
      my $self    = shift;
      my $newNode = shift;
      my $f       = Prefix->new();

      # Have to do this manually or other recorded paths get modified
      push @{ $f->{path} }, @{ $self->{path} }, $newNode;
      return $f;
  }

  # Traverses $o->path left-to-right to get the string it represents.

  sub _build_current_word {
      my $self = shift;
      return join q{}, map { $_->{value} } @{ $self->{path} };
  }

  # Returns  the rightmost node on this path

  sub tail {
      my $self = shift;
      return $self->{path}->[-1];
  }

  # pretty-format $o->path

  sub pp_path {
      my $self = shift;
      my @path =
        map { '[' . $_->{x_position} . ',' . $_->{y_position} . ']' }
        @{ $self->{path} };
      return "[" . join( ",", @path ) . "]";
  }

  # pretty-format $o
  sub pp {
      my $self = shift;
      return $self->current_word . ' => ' . $self->pp_path;
  }

  __PACKAGE__->meta->make_immutable;
}

{

  # Basic package for tracking node data
  # without having to look on the grid.
  # I could have just used an array or a hash, but that got ugly.

# Once the matrix is up and running it doesn't really care so much about rows/columns,
# Its just a sea of points and each point has adjacent points.
# Relative positioning is only really useful to map it back to userspace

  package MatrixNode;
  use Moose;

  has x_position => ( isa => 'Int', is => 'rw', required => 1 );
  has y_position => ( isa => 'Int', is => 'rw', required => 1 );
  has value      => ( isa => 'Str', is => 'rw', required => 1 );
  has siblings   => (
      isa     => 'ArrayRef[MatrixNode]',
      is      => 'rw',
      default => sub { [] }
  );

# Its not implicitly uni-directional joins. It would be more effient in therory
# to make the link go both ways at the same time, but thats too hard to program around.
# and besides, this isn't slow enough to bother caring about.

  sub add_sibling {
      my $self    = shift;
      my $sibling = shift;
      push @{ $self->siblings }, $sibling;
  }

  # Convenience method to derive a path starting at this node

  sub to_path {
      my $self = shift;
      return Prefix->new( path => [$self] );
  }
  __PACKAGE__->meta->make_immutable;

}

{

  package Matrix;
  use Moose;

  has rows => (
      isa     => 'ArrayRef',
      is      => 'rw',
      default => sub { [] },
  );

  has regex => (
      isa        => 'Regexp',
      is         => 'rw',
      lazy_build => 1,
  );

  has cells => (
      isa        => 'ArrayRef',
      is         => 'rw',
      lazy_build => 1,
  );

  sub add_row {
      my $self = shift;
      push @{ $self->rows }, [@_];
  }

  # Most of these functions from here down are just builder functions,
  # or utilities to help build things.
  # Some just broken out to make it easier for me to process.
  # All thats really useful is add_row
  # The rest will generally be computed, stored, and ready to go
  # from ->cells by the time either ->cells or ->regex are called.

  # traverse all cells and make a regex that covers them.
  sub _build_regex {
      my $self  = shift;
      my $chars = q{};
      for my $cell ( @{ $self->cells } ) {
          $chars .= $cell->value();
      }
      $chars = "[^$chars]";
      return qr/$chars/i;
  }

  # convert a plain cell ( ie: [x][y] = 0 )
  # to an intelligent cell ie: [x][y] = object( x, y )
  # we only really keep them in this format temporarily
  # so we can go through and tie in neighbouring information.
  # after the neigbouring is done, the grid should be considered inoperative.

  sub _convert {
      my $self = shift;
      my $x    = shift;
      my $y    = shift;
      my $v    = $self->_read( $x, $y );
      my $n    = MatrixNode->new(
          x_position => $x,
          y_position => $y,
          value      => $v,
      );
      $self->_write( $x, $y, $n );
      return $n;
  }

# go through the rows/collums presently available and freeze them into objects.

  sub _build_cells {
      my $self = shift;
      my @out  = ();
      my @rows = @{ $self->{rows} };
      for my $x ( 0 .. $#rows ) {
          next unless defined $self->{rows}->[$x];
          my @col = @{ $self->{rows}->[$x] };
          for my $y ( 0 .. $#col ) {
              next unless defined $self->{rows}->[$x]->[$y];
              push @out, $self->_convert( $x, $y );
          }
      }
      for my $c (@out) {
          for my $n ( $self->_neighbours( $c->x_position, $c->y_position ) ) {
              $c->add_sibling( $self->{rows}->[ $n->[0] ]->[ $n->[1] ] );
          }
      }
      return \@out;
  }

  # given x,y , return array of points that refer to valid neighbours.
  sub _neighbours {
      my $self = shift;
      my $x    = shift;
      my $y    = shift;
      my @out  = ();
      for my $sx ( -1, 0, 1 ) {
          next if $sx + $x < 0;
          next if not defined $self->{rows}->[ $sx + $x ];
          for my $sy ( -1, 0, 1 ) {
              next if $sx == 0 && $sy == 0;
              next if $sy + $y < 0;
              next if not defined $self->{rows}->[ $sx + $x ]->[ $sy + $y ];
              push @out, [ $sx + $x, $sy + $y ];
          }
      }
      return @out;
  }

  sub _has_row {
      my $self = shift;
      my $x    = shift;
      return defined $self->{rows}->[$x];
  }

  sub _has_cell {
      my $self = shift;
      my $x    = shift;
      my $y    = shift;
      return defined $self->{rows}->[$x]->[$y];
  }

  sub _read {
      my $self = shift;
      my $x    = shift;
      my $y    = shift;
      return $self->{rows}->[$x]->[$y];
  }

  sub _write {
      my $self = shift;
      my $x    = shift;
      my $y    = shift;
      my $v    = shift;
      $self->{rows}->[$x]->[$y] = $v;
      return $v;
  }

  __PACKAGE__->meta->make_immutable;
}

use Tree::Trie;

sub readDict {
  my $fn = shift;
  my $re = shift;
  my $d  = Tree::Trie->new();

  # Dictionary Loading
  open my $fh, '<', $fn;
  while ( my $line = <$fh> ) {
      chomp($line);

 # Commenting the next line makes it go from 1.5 seconds to 7.5 seconds. EPIC.
      next if $line =~ $re;    # Early Filter
      $d->add( uc($line) );
  }
  return $d;
}

sub traverseGraph {
  my $d     = shift;
  my $m     = shift;
  my $min   = shift;
  my $max   = shift;
  my @words = ();

  # Inject all grid nodes into the processing queue.

  my @queue =
    grep { $d->lookup( $_->current_word ) }
    map  { $_->to_path } @{ $m->cells };

  while (@queue) {
      my $item = shift @queue;

      # put the dictionary into "exact match" mode.

      $d->deepsearch('exact');

      my $cword = $item->current_word;
      my $l     = length($cword);

      if ( $l >= $min && $d->lookup($cword) ) {
          push @words,
            $item;    # push current path into "words" if it exactly matches.
      }
      next if $l > $max;

      # put the dictionary into "is-a-prefix" mode.
      $d->deepsearch('boolean');

    siblingloop: foreach my $sibling ( @{ $item->tail->siblings } ) {
          foreach my $visited ( @{ $item->{path} } ) {
              next siblingloop if $sibling == $visited;
          }

          # given path y , iterate for all its end points
          my $subpath = $item->child($sibling);

          # create a new path for each end-point
          if ( $d->lookup( $subpath->current_word ) ) {

             # if the new path is a prefix, add it to the bottom of the queue.
              push @queue, $subpath;
          }
      }
  }
  return \@words;
}

sub setup_predetermined { 
  my $m = shift; 
  my $gameNo = shift;
  if( $gameNo == 0 ){
      $m->add_row(qw( F X I E ));
      $m->add_row(qw( A M L O ));
      $m->add_row(qw( E W B X ));
      $m->add_row(qw( A S T U ));
      return $m;
  }
  if( $gameNo == 1 ){
      $m->add_row(qw( D G H I ));
      $m->add_row(qw( K L P S ));
      $m->add_row(qw( Y E U T ));
      $m->add_row(qw( E O R N ));
      return $m;
  }
}
sub setup_random { 
  my $m = shift; 
  my $seed = shift;
  srand $seed;
  my @letters = 'A' .. 'Z' ; 
  for( 1 .. 4 ){ 
      my @r = ();
      for( 1 .. 4 ){
          push @r , $letters[int(rand(25))];
      }
      $m->add_row( @r );
  }
}

# Here is where the real work starts.

my $m = Matrix->new();
setup_predetermined( $m, 0 );
#setup_random( $m, 5 );

my $d = readDict( 'dict.txt', $m->regex );
my $c = scalar @{ $m->cells };    # get the max, as per spec

print join ",\n", map { $_->pp } @{
  traverseGraph( $d, $m, 3, $c ) ;
}; 
```

用于比较的 Arch/执行信息：

```
model name      : Intel(R) Core(TM)2 Duo CPU     T9300  @ 2.50GHz
cache size      : 6144 KB
Memory usage summary: heap total: 77057577, heap peak: 11446200, stack peak: 26448
       total calls   total memory   failed calls
 malloc|     947212       68763684              0
realloc|      11191        1045641              0  (nomove:9063, dec:4731, free:0)
 calloc|     121001        7248252              0
   free|     973159       65854762

Histogram for block sizes:
  0-15         392633  36% ==================================================
 16-31          43530   4% =====
 32-47          50048   4% ======
 48-63          70701   6% =========
 64-79          18831   1% ==
 80-95          19271   1% ==
 96-111        238398  22% ==============================
112-127          3007  <1% 
128-143        236727  21% ============================== 
```

## 关于正则表达式优化的更多抱怨

我使用的正则表达式优化对多解词典毫无用处，而对于多解词典，您需要一个完整的词典，而不是预先修剪过的词典。

然而，这就是说，对于一次性解决方案，它真的很快。（Perl 正则表达式在 C 中！:)）

以下是一些不同的代码添加：

```
sub readDict_nofilter {
  my $fn = shift;
  my $re = shift;
  my $d  = Tree::Trie->new();

  # Dictionary Loading
  open my $fh, '<', $fn;
  while ( my $line = <$fh> ) {
      chomp($line);
      $d->add( uc($line) );
  }
  return $d;
}

sub benchmark_io { 
  use Benchmark qw( cmpthese :hireswallclock );
   # generate a random 16 character string 
   # to simulate there being an input grid. 
  my $regexen = sub { 
      my @letters = 'A' .. 'Z' ; 
      my @lo = ();
      for( 1..16 ){ 
          push @lo , $_ ; 
      }
      my $c  = join '', @lo;
      $c = "[^$c]";
      return qr/$c/i;
  };
  cmpthese( 200 , { 
      filtered => sub { 
          readDict('dict.txt', $regexen->() );
      }, 
      unfiltered => sub {
          readDict_nofilter('dict.txt');
      }
  });
} 
```

```
           s/iter 未过滤 过滤
未过滤 8.16 -- -94%
过滤 0.464 1658% --

```

[ps：8.16 * 200 = 27 分钟。]

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2009-04-14T04:27:46.070

您可以将问题分为两部分：

1.  某种搜索算法，将枚举网格中可能的字符串。
2.  一种测试字符串是否为有效单词的方法。

理想情况下，(2) 还应该包括一种测试字符串是否是有效单词前缀的方法——这将允许您修剪搜索并节省大量时间。

Adam Rosenfield 的 Trie 是 (2) 的解决方案。它很优雅，可能是您的算法专家更喜欢的，但是使用现代语言和现代计算机，我们可能会有点懒惰。此外，正如 Kent 建议的那样，我们可以通过丢弃网格中不存在字母的单词来减小字典大小。这是一些蟒蛇：

```
def make_lookups(grid, fn='dict.txt'):
    # Make set of valid characters.
    chars = set()
    for word in grid:
        chars.update(word)

    words = set(x.strip() for x in open(fn) if set(x.strip()) <= chars)
    prefixes = set()
    for w in words:
        for i in range(len(w)+1):
            prefixes.add(w[:i])

    return words, prefixes 
```

哇; 恒定时间前缀测试。加载您链接的字典需要几秒钟，但只需要几秒钟:-)（请注意`words <= prefixes`）

现在，对于第 (1) 部分，我倾向于用图表来思考。所以我将构建一个看起来像这样的字典：

```
graph = { (x, y):set([(x0,y0), (x1,y1), (x2,y2)]), } 
```

ie`graph[(x, y)]`是您可以从 position 到达的一组坐标`(x, y)`。我还将添加一个虚拟节点`None`，它将连接到所有内容。

构建它有点笨拙，因为有 8 个可能的位置，并且您必须进行边界检查。这是一些相应笨拙的python代码：

```
def make_graph(grid):
    root = None
    graph = { root:set() }
    chardict = { root:'' }

    for i, row in enumerate(grid):
        for j, char in enumerate(row):
            chardict[(i, j)] = char
            node = (i, j)
            children = set()
            graph[node] = children
            graph[root].add(node)
            add_children(node, children, grid)

    return graph, chardict

def add_children(node, children, grid):
    x0, y0 = node
    for i in [-1,0,1]:
        x = x0 + i
        if not (0 <= x < len(grid)):
            continue
        for j in [-1,0,1]:
            y = y0 + j
            if not (0 <= y < len(grid[0])) or (i == j == 0):
                continue

            children.add((x,y)) 
```

此代码还建立了`(x,y)`对应字符的字典映射。这让我可以将职位列表变成一个词：

```
def to_word(chardict, pos_list):
    return ''.join(chardict[x] for x in pos_list) 
```

最后，我们进行深度优先搜索。基本程序是：

1.  搜索到达特定节点。
2.  检查到目前为止的路径是否可能是单词的一部分。如果没有，请不要进一步探索此分支。
3.  检查到目前为止的路径是否是一个单词。如果是这样，请添加到结果列表中。
4.  探索到目前为止不属于路径的所有孩子。

Python：

```
def find_words(graph, chardict, position, prefix, results, words, prefixes):
    """ Arguments:
      graph :: mapping (x,y) to set of reachable positions
      chardict :: mapping (x,y) to character
      position :: current position (x,y) -- equals prefix[-1]
      prefix :: list of positions in current string
      results :: set of words found
      words :: set of valid words in the dictionary
      prefixes :: set of valid words or prefixes thereof
    """
    word = to_word(chardict, prefix)

    if word not in prefixes:
        return

    if word in words:
        results.add(word)

    for child in graph[position]:
        if child not in prefix:
            find_words(graph, chardict, child, prefix+[child], results, words, prefixes) 
```

运行代码为：

```
grid = ['fxie', 'amlo', 'ewbx', 'astu']
g, c = make_graph(grid)
w, p = make_lookups(grid)
res = set()
find_words(g, c, None, [], res, w, p) 
```

并检查`res`以查看答案。这是为您的示例找到的单词列表，按大小排序：

```
 ['a', 'b', 'e', 'f', 'i', 'l', 'm', 'o', 's', 't',
 'u', 'w', 'x', 'ae', 'am', 'as', 'aw', 'ax', 'bo',
 'bu', 'ea', 'el', 'em', 'es', 'fa', 'ie', 'io', 'li',
 'lo', 'ma', 'me', 'mi', 'oe', 'ox', 'sa', 'se', 'st',
 'tu', 'ut', 'wa', 'we', 'xi', 'aes', 'ame', 'ami',
 'ase', 'ast', 'awa', 'awe', 'awl', 'blo', 'but', 'elb',
 'elm', 'fae', 'fam', 'lei', 'lie', 'lim', 'lob', 'lox',
 'mae', 'maw', 'mew', 'mil', 'mix', 'oil', 'olm', 'saw',
 'sea', 'sew', 'swa', 'tub', 'tux', 'twa', 'wae', 'was',
 'wax', 'wem', 'ambo', 'amil', 'amli', 'asem', 'axil',
 'axle', 'bleo', 'boil', 'bole', 'east', 'fame', 'limb',
 'lime', 'mesa', 'mewl', 'mile', 'milo', 'oime', 'sawt',
 'seam', 'seax', 'semi', 'stub', 'swam', 'twae', 'twas',
 'wame', 'wase', 'wast', 'weam', 'west', 'amble', 'awest',
 'axile', 'embox', 'limbo', 'limes', 'swami', 'embole',
 'famble', 'semble', 'wamble'] 
```

该代码需要（字面意思）几秒钟来加载字典，但其余部分在我的机器上是即时的。

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-07-01T02:52:15.740

我在 Java 中的尝试。读取文件和构建 trie 大约需要 2 秒，解决难题大约需要 50 毫秒。我使用了问题中链接的字典（它有一些我不知道的英文单词，例如 fae、ima）

```
0 [main] INFO gineer.bogglesolver.util.Util  - Reading the dictionary
2234 [main] INFO gineer.bogglesolver.util.Util  - Finish reading the dictionary
2234 [main] INFO gineer.bogglesolver.Solver  - Found: FAM
2234 [main] INFO gineer.bogglesolver.Solver  - Found: FAME
2234 [main] INFO gineer.bogglesolver.Solver  - Found: FAMBLE
2234 [main] INFO gineer.bogglesolver.Solver  - Found: FAE
2234 [main] INFO gineer.bogglesolver.Solver  - Found: IMA
2234 [main] INFO gineer.bogglesolver.Solver  - Found: ELI
2234 [main] INFO gineer.bogglesolver.Solver  - Found: ELM
2234 [main] INFO gineer.bogglesolver.Solver  - Found: ELB
2234 [main] INFO gineer.bogglesolver.Solver  - Found: AXIL
2234 [main] INFO gineer.bogglesolver.Solver  - Found: AXILE
2234 [main] INFO gineer.bogglesolver.Solver  - Found: AXLE
2234 [main] INFO gineer.bogglesolver.Solver  - Found: AMI
2234 [main] INFO gineer.bogglesolver.Solver  - Found: AMIL
2234 [main] INFO gineer.bogglesolver.Solver  - Found: AMLI
2234 [main] INFO gineer.bogglesolver.Solver  - Found: AME
2234 [main] INFO gineer.bogglesolver.Solver  - Found: AMBLE
2234 [main] INFO gineer.bogglesolver.Solver  - Found: AMBO
2250 [main] INFO gineer.bogglesolver.Solver  - Found: AES
2250 [main] INFO gineer.bogglesolver.Solver  - Found: AWL
2250 [main] INFO gineer.bogglesolver.Solver  - Found: AWE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: AWEST
2250 [main] INFO gineer.bogglesolver.Solver  - Found: AWA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: MIX
2250 [main] INFO gineer.bogglesolver.Solver  - Found: MIL
2250 [main] INFO gineer.bogglesolver.Solver  - Found: MILE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: MILO
2250 [main] INFO gineer.bogglesolver.Solver  - Found: MAX
2250 [main] INFO gineer.bogglesolver.Solver  - Found: MAE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: MAW
2250 [main] INFO gineer.bogglesolver.Solver  - Found: MEW
2250 [main] INFO gineer.bogglesolver.Solver  - Found: MEWL
2250 [main] INFO gineer.bogglesolver.Solver  - Found: MES
2250 [main] INFO gineer.bogglesolver.Solver  - Found: MESA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: MWA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: MWA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: LIE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: LIM
2250 [main] INFO gineer.bogglesolver.Solver  - Found: LIMA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: LIMAX
2250 [main] INFO gineer.bogglesolver.Solver  - Found: LIME
2250 [main] INFO gineer.bogglesolver.Solver  - Found: LIMES
2250 [main] INFO gineer.bogglesolver.Solver  - Found: LIMB
2250 [main] INFO gineer.bogglesolver.Solver  - Found: LIMBO
2250 [main] INFO gineer.bogglesolver.Solver  - Found: LIMBU
2250 [main] INFO gineer.bogglesolver.Solver  - Found: LEI
2250 [main] INFO gineer.bogglesolver.Solver  - Found: LEO
2250 [main] INFO gineer.bogglesolver.Solver  - Found: LOB
2250 [main] INFO gineer.bogglesolver.Solver  - Found: LOX
2250 [main] INFO gineer.bogglesolver.Solver  - Found: OIME
2250 [main] INFO gineer.bogglesolver.Solver  - Found: OIL
2250 [main] INFO gineer.bogglesolver.Solver  - Found: OLE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: OLM
2250 [main] INFO gineer.bogglesolver.Solver  - Found: EMIL
2250 [main] INFO gineer.bogglesolver.Solver  - Found: EMBOLE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: EMBOX
2250 [main] INFO gineer.bogglesolver.Solver  - Found: EAST
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WAF
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WAX
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WAME
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WAMBLE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WAE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WEA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WEAM
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WEM
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WEA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WES
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WEST
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WAE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WAS
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WASE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: WAST
2250 [main] INFO gineer.bogglesolver.Solver  - Found: BLEO
2250 [main] INFO gineer.bogglesolver.Solver  - Found: BLO
2250 [main] INFO gineer.bogglesolver.Solver  - Found: BOIL
2250 [main] INFO gineer.bogglesolver.Solver  - Found: BOLE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: BUT
2250 [main] INFO gineer.bogglesolver.Solver  - Found: AES
2250 [main] INFO gineer.bogglesolver.Solver  - Found: AWA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: AWL
2250 [main] INFO gineer.bogglesolver.Solver  - Found: AWE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: AWEST
2250 [main] INFO gineer.bogglesolver.Solver  - Found: ASE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: ASEM
2250 [main] INFO gineer.bogglesolver.Solver  - Found: AST
2250 [main] INFO gineer.bogglesolver.Solver  - Found: SEA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: SEAX
2250 [main] INFO gineer.bogglesolver.Solver  - Found: SEAM
2250 [main] INFO gineer.bogglesolver.Solver  - Found: SEMI
2250 [main] INFO gineer.bogglesolver.Solver  - Found: SEMBLE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: SEW
2250 [main] INFO gineer.bogglesolver.Solver  - Found: SEA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: SWA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: SWAM
2250 [main] INFO gineer.bogglesolver.Solver  - Found: SWAMI
2250 [main] INFO gineer.bogglesolver.Solver  - Found: SWA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: SAW
2250 [main] INFO gineer.bogglesolver.Solver  - Found: SAWT
2250 [main] INFO gineer.bogglesolver.Solver  - Found: STU
2250 [main] INFO gineer.bogglesolver.Solver  - Found: STUB
2250 [main] INFO gineer.bogglesolver.Solver  - Found: TWA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: TWAE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: TWA
2250 [main] INFO gineer.bogglesolver.Solver  - Found: TWAE
2250 [main] INFO gineer.bogglesolver.Solver  - Found: TWAS
2250 [main] INFO gineer.bogglesolver.Solver  - Found: TUB
2250 [main] INFO gineer.bogglesolver.Solver  - Found: TUX 
```

源代码由 6 个类组成。我会在下面发布它们（如果这不是 StackOverflow 上的正确做法，请告诉我）。

### gineer.bogglesolver.Main

```
package gineer.bogglesolver;

import org.apache.log4j.BasicConfigurator;
import org.apache.log4j.Logger;

public class Main
{
    private final static Logger logger = Logger.getLogger(Main.class);

    public static void main(String[] args)
    {
        BasicConfigurator.configure();

        Solver solver = new Solver(4,
                        "FXIE" +
                        "AMLO" +
                        "EWBX" +
                        "ASTU");
        solver.solve();

    }
} 
```

### gineer.bogglesolver.Solver

```
package gineer.bogglesolver;

import gineer.bogglesolver.trie.Trie;
import gineer.bogglesolver.util.Constants;
import gineer.bogglesolver.util.Util;
import org.apache.log4j.Logger;

public class Solver
{
    private char[] puzzle;
    private int maxSize;

    private boolean[] used;
    private StringBuilder stringSoFar;

    private boolean[][] matrix;
    private Trie trie;

    private final static Logger logger = Logger.getLogger(Solver.class);

    public Solver(int size, String puzzle)
    {
        trie = Util.getTrie(size);
        matrix = Util.connectivityMatrix(size);

        maxSize = size * size;
        stringSoFar = new StringBuilder(maxSize);
        used = new boolean[maxSize];

        if (puzzle.length() == maxSize)
        {
            this.puzzle = puzzle.toCharArray();
        }
        else
        {
            logger.error("The puzzle size does not match the size specified: " + puzzle.length());
            this.puzzle = puzzle.substring(0, maxSize).toCharArray();
        }
    }

    public void solve()
    {
        for (int i = 0; i < maxSize; i++)
        {
            traverseAt(i);
        }
    }

    private void traverseAt(int origin)
    {
        stringSoFar.append(puzzle[origin]);
        used[origin] = true;

        //Check if we have a valid word
        if ((stringSoFar.length() >= Constants.MINIMUM_WORD_LENGTH) && (trie.containKey(stringSoFar.toString())))
        {
            logger.info("Found: " + stringSoFar.toString());
        }

        //Find where to go next
        for (int destination = 0; destination < maxSize; destination++)
        {
            if (matrix[origin][destination] && !used[destination] && trie.containPrefix(stringSoFar.toString() + puzzle[destination]))
            {
                traverseAt(destination);
            }
        }

        used[origin] = false;
        stringSoFar.deleteCharAt(stringSoFar.length() - 1);
    }

} 
```

### gineer.bogglesolver.trie.Node

```
package gineer.bogglesolver.trie;

import gineer.bogglesolver.util.Constants;

class Node
{
    Node[] children;
    boolean isKey;

    public Node()
    {
        isKey = false;
        children = new Node[Constants.NUMBER_LETTERS_IN_ALPHABET];
    }

    public Node(boolean key)
    {
        isKey = key;
        children = new Node[Constants.NUMBER_LETTERS_IN_ALPHABET];
    }

    /**
     Method to insert a string to Node and its children

     @param key the string to insert (the string is assumed to be uppercase)
     @return true if the node or one of its children is changed, false otherwise
     */
    public boolean insert(String key)
    {
        //If the key is empty, this node is a key
        if (key.length() == 0)
        {
            if (isKey)
                return false;
            else
            {
                isKey = true;
                return true;
            }
        }
        else
        {//otherwise, insert in one of its child

            int childNodePosition = key.charAt(0) - Constants.LETTER_A;
            if (children[childNodePosition] == null)
            {
                children[childNodePosition] = new Node();
                children[childNodePosition].insert(key.substring(1));
                return true;
            }
            else
            {
                return children[childNodePosition].insert(key.substring(1));
            }
        }
    }

    /**
     Returns whether key is a valid prefix for certain key in this trie.
     For example: if key "hello" is in this trie, tests with all prefixes "hel", "hell", "hello" return true

     @param prefix the prefix to check
     @return true if the prefix is valid, false otherwise
     */
    public boolean containPrefix(String prefix)
    {
        //If the prefix is empty, return true
        if (prefix.length() == 0)
        {
            return true;
        }
        else
        {//otherwise, check in one of its child
            int childNodePosition = prefix.charAt(0) - Constants.LETTER_A;
            return children[childNodePosition] != null && children[childNodePosition].containPrefix(prefix.substring(1));
        }
    }

    /**
     Returns whether key is a valid key in this trie.
     For example: if key "hello" is in this trie, tests with all prefixes "hel", "hell" return false

     @param key the key to check
     @return true if the key is valid, false otherwise
     */
    public boolean containKey(String key)
    {
        //If the prefix is empty, return true
        if (key.length() == 0)
        {
            return isKey;
        }
        else
        {//otherwise, check in one of its child
            int childNodePosition = key.charAt(0) - Constants.LETTER_A;
            return children[childNodePosition] != null && children[childNodePosition].containKey(key.substring(1));
        }
    }

    public boolean isKey()
    {
        return isKey;
    }

    public void setKey(boolean key)
    {
        isKey = key;
    }
} 
```

### gineer.bogglesolver.trie.Trie

```
package gineer.bogglesolver.trie;

public class Trie
{
    Node root;

    public Trie()
    {
        this.root = new Node();
    }

    /**
     Method to insert a string to Node and its children

     @param key the string to insert (the string is assumed to be uppercase)
     @return true if the node or one of its children is changed, false otherwise
     */
    public boolean insert(String key)
    {
        return root.insert(key.toUpperCase());
    }

    /**
     Returns whether key is a valid prefix for certain key in this trie.
     For example: if key "hello" is in this trie, tests with all prefixes "hel", "hell", "hello" return true

     @param prefix the prefix to check
     @return true if the prefix is valid, false otherwise
     */
    public boolean containPrefix(String prefix)
    {
        return root.containPrefix(prefix.toUpperCase());
    }

    /**
     Returns whether key is a valid key in this trie.
     For example: if key "hello" is in this trie, tests with all prefixes "hel", "hell" return false

     @param key the key to check
     @return true if the key is valid, false otherwise
     */
    public boolean containKey(String key)
    {
        return root.containKey(key.toUpperCase());
    }

} 
```

### gineer.bogglesolver.util.Constants

```
package gineer.bogglesolver.util;

public class Constants
{

    public static final int NUMBER_LETTERS_IN_ALPHABET = 26;
    public static final char LETTER_A = 'A';
    public static final int MINIMUM_WORD_LENGTH = 3;
    public static final int DEFAULT_PUZZLE_SIZE = 4;
} 
```

### gineer.bogglesolver.util.Util

```
package gineer.bogglesolver.util;

import gineer.bogglesolver.trie.Trie;
import org.apache.log4j.Logger;

import java.io.File;
import java.io.FileNotFoundException;
import java.util.Scanner;

public class Util
{
    private final static Logger logger = Logger.getLogger(Util.class);
    private static Trie trie;
    private static int size = Constants.DEFAULT_PUZZLE_SIZE;

    /**
     Returns the trie built from the dictionary.  The size is used to eliminate words that are too long.

     @param size the size of puzzle.  The maximum lenght of words in the returned trie is (size * size)
     @return the trie that can be used for puzzle of that size
     */
    public static Trie getTrie(int size)
    {
        if ((trie != null) && size == Util.size)
            return trie;

        trie = new Trie();
        Util.size = size;

        logger.info("Reading the dictionary");
        final File file = new File("dictionary.txt");
        try
        {
            Scanner scanner = new Scanner(file);
            final int maxSize = size * size;
            while (scanner.hasNext())
            {
                String line = scanner.nextLine().replaceAll("[^\\p{Alpha}]", "");

                if (line.length() <= maxSize)
                    trie.insert(line);
            }
        }
        catch (FileNotFoundException e)
        {
            logger.error("Cannot open file", e);
        }

        logger.info("Finish reading the dictionary");
        return trie;
    }

    static boolean[] connectivityRow(int x, int y, int size)
    {
        boolean[] squares = new boolean[size * size];
        for (int offsetX = -1; offsetX <= 1; offsetX++)
        {
            for (int offsetY = -1; offsetY <= 1; offsetY++)
            {
                final int calX = x + offsetX;
                final int calY = y + offsetY;
                if ((calX >= 0) && (calX < size) && (calY >= 0) && (calY < size))
                    squares[calY * size + calX] = true;
            }
        }

        squares[y * size + x] = false;//the current x, y is false

        return squares;
    }

    /**
     Returns the matrix of connectivity between two points.  Point i can go to point j iff matrix[i][j] is true
     Square (x, y) is equivalent to point (size * y + x).  For example, square (1,1) is point 5 in a puzzle of size 4

     @param size the size of the puzzle
     @return the connectivity matrix
     */
    public static boolean[][] connectivityMatrix(int size)
    {
        boolean[][] matrix = new boolean[size * size][];
        for (int x = 0; x < size; x++)
        {
            for (int y = 0; y < size; y++)
            {
                matrix[y * size + x] = connectivityRow(x, y, size);
            }
        }
        return matrix;
    }
} 
```

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2012-11-12T05:42:29.577

我认为您可能会花费大部分时间来尝试匹配字母网格不可能构建的单词。所以，我要做的第一件事就是尝试加快这一步，这应该能让你大部分时间到达那里。

为此，我会将网格重新表示为您正在查看的字母转换索引的可能“移动”表。

首先从整个字母表中为每个字母分配一个数字（A=0、B=1、C=2、...等等）。

让我们看这个例子：

```
h b c d
e e g h
l l k l
m o f p 
```

现在，让我们使用我们拥有的字母的字母表（通常您可能希望每次都使用相同的整个字母表）：

```
 b | c | d | e | f | g | h | k | l | m |  o |  p
---+---+---+---+---+---+---+---+---+---+----+----
 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 
```

然后你创建一个二维布尔数组，告诉你是否有某个字母转换可用：

```
 |  0  1  2  3  4  5  6  7  8  9 10 11  <- from letter
     |  b  c  d  e  f  g  h  k  l  m  o  p
-----+--------------------------------------
 0 b |     T     T     T  T     
 1 c |  T     T  T     T  T
 2 d |     T           T  T
 3 e |  T  T     T     T  T  T  T
 4 f |                       T  T     T  T
 5 g |  T  T  T  T        T  T  T
 6 h |  T  T  T  T     T     T  T
 7 k |           T  T  T  T     T     T  T
 8 l |           T  T  T  T  T  T  T  T  T
 9 m |                          T     T
10 o |              T        T  T  T
11 p |              T        T  T
 ^
 to letter 
```

现在浏览您的单词列表并将单词转换为转换：

```
hello (6, 3, 8, 8, 10):
6 -> 3, 3 -> 8, 8 -> 8, 8 -> 10 
```

然后通过在表中查找这些转换来检查是否允许这些转换：

```
[6][ 3] : T
[3][ 8] : T
[8][ 8] : T
[8][10] : T 
```

如果它们都被允许，那么就有可能找到这个词。

例如，可以在第 4 次转换（m 到 e：helMEt）时排除单词“helmet”，因为表中的该条目是错误的。

并且可以排除仓鼠这个词，因为不允许第一个（h 到 a）转换（甚至不存在于您的表中）。

现在，对于您没有消除的可能很少的剩余单词，请尝试按照您现在的方式或按照此处其他一些答案中的建议在网格中实际找到它们。这是为了避免由于网格中相同字母之间的跳跃而导致的误报。例如，表格允许使用“帮助”一词，但网格不允许使用“帮助”一词。

**关于这个想法的一些进一步的性能改进提示：**

1.  不要使用二维数组，而是使用一维数组并简单地自己计算第二个字母的索引。因此，不要像上面那样创建一个 12x12 数组，而是创建一个长度为 144 的一维数组。如果您总是使用相同的字母表（即标准英文字母表的 26x26 = 676x1 数组），即使不是所有字母都显示在您的网格中，您可以将索引预先计算到此一维数组中，您需要对其进行测试以匹配您的字典单词。例如，上面示例中“hello”的索引将是

    ```
    hello (6, 3, 8, 8, 10):
    42 (from 6 + 3x12), 99, 104, 128
    -> "hello" will be stored as 42, 99, 104, 128 in the dictionary 
    ```

2.  将想法扩展到 3D 表（表示为 1D 数组），即所有允许的 3 字母组合。这样，您可以立即消除更多单词，并将每个单词的数组查找次数减少 1：对于“hello”，您只需要 3 个数组查找：hel、ell、llo。顺便说一句，构建这张表会非常快，因为您的网格中只有 400 个可能的 3 字母移动。

3.  预先计算需要包含在表格中的网格中移动的索引。对于上面的示例，您需要将以下条目设置为“True”：

    ```
    (0,0) (0,1) -> here: h, b : [6][0]
    (0,0) (1,0) -> here: h, e : [6][3]
    (0,0) (1,1) -> here: h, e : [6][3]
    (0,1) (0,0) -> here: b, h : [0][6]
    (0,1) (0,2) -> here: b, c : [0][1]
    .
    : 
    ```

4.  还可以在具有 16 个条目的一维数组中表示您的游戏网格，并在 3 中预先计算表格。包含该数组的索引。

我敢肯定，如果你使用这种方法，你可以让你的代码运行得非常快，前提是你已经预先计算了字典并且已经加载到内存中。

顺便说一句：如果您正在构建游戏，另一件好事是立即在后台运行这些东西。开始生成和解决第一个游戏，而用户仍在查看您应用程序上的标题屏幕并让他的手指就位以按“播放”。然后在用户玩上一个游戏时生成并解决下一个游戏。这应该给你很多时间来运行你的代码。

（我喜欢这个问题，所以我可能会很想在接下来的几天里用 Java 实现我的提议，看看它实际上会如何执行......一旦我这样做了，我会在这里发布代码。）

**更新：**

好的，我今天有时间用Java实现了这个想法：

```
class DictionaryEntry {
  public int[] letters;
  public int[] triplets;
}

class BoggleSolver {

  // Constants
  final int ALPHABET_SIZE = 5;  // up to 2^5 = 32 letters
  final int BOARD_SIZE    = 4;  // 4x4 board
  final int[] moves = {-BOARD_SIZE-1, -BOARD_SIZE, -BOARD_SIZE+1, 
                                  -1,                         +1,
                       +BOARD_SIZE-1, +BOARD_SIZE, +BOARD_SIZE+1};

  // Technically constant (calculated here for flexibility, but should be fixed)
  DictionaryEntry[] dictionary; // Processed word list
  int maxWordLength = 0;
  int[] boardTripletIndices; // List of all 3-letter moves in board coordinates

  DictionaryEntry[] buildDictionary(String fileName) throws IOException {
    BufferedReader fileReader = new BufferedReader(new FileReader(fileName));
    String word = fileReader.readLine();
    ArrayList<DictionaryEntry> result = new ArrayList<DictionaryEntry>();
    while (word!=null) {
      if (word.length()>=3) {
        word = word.toUpperCase();
        if (word.length()>maxWordLength) maxWordLength = word.length();
        DictionaryEntry entry = new DictionaryEntry();
        entry.letters  = new int[word.length()  ];
        entry.triplets = new int[word.length()-2];
        int i=0;
        for (char letter: word.toCharArray()) {
          entry.letters[i] = (byte) letter - 65; // Convert ASCII to 0..25
          if (i>=2)
            entry.triplets[i-2] = (((entry.letters[i-2]  << ALPHABET_SIZE) +
                                     entry.letters[i-1]) << ALPHABET_SIZE) +
                                     entry.letters[i];
          i++;
        }
        result.add(entry);
      }
      word = fileReader.readLine();
    }
    return result.toArray(new DictionaryEntry[result.size()]);
  }

  boolean isWrap(int a, int b) { // Checks if move a->b wraps board edge (like 3->4)
    return Math.abs(a%BOARD_SIZE-b%BOARD_SIZE)>1;
  }

  int[] buildTripletIndices() {
    ArrayList<Integer> result = new ArrayList<Integer>();
    for (int a=0; a<BOARD_SIZE*BOARD_SIZE; a++)
      for (int bm: moves) {
        int b=a+bm;
        if ((b>=0) && (b<board.length) && !isWrap(a, b))
          for (int cm: moves) {
            int c=b+cm;
            if ((c>=0) && (c<board.length) && (c!=a) && !isWrap(b, c)) {
              result.add(a);
              result.add(b);
              result.add(c);
            }
          }
      }
    int[] result2 = new int[result.size()];
    int i=0;
    for (Integer r: result) result2[i++] = r;
    return result2;
  }

  // Variables that depend on the actual game layout
  int[] board = new int[BOARD_SIZE*BOARD_SIZE]; // Letters in board
  boolean[] possibleTriplets = new boolean[1 << (ALPHABET_SIZE*3)];

  DictionaryEntry[] candidateWords;
  int candidateCount;

  int[] usedBoardPositions;

  DictionaryEntry[] foundWords;
  int foundCount;

  void initializeBoard(String[] letters) {
    for (int row=0; row<BOARD_SIZE; row++)
      for (int col=0; col<BOARD_SIZE; col++)
        board[row*BOARD_SIZE + col] = (byte) letters[row].charAt(col) - 65;
  }

  void setPossibleTriplets() {
    Arrays.fill(possibleTriplets, false); // Reset list
    int i=0;
    while (i<boardTripletIndices.length) {
      int triplet = (((board[boardTripletIndices[i++]]  << ALPHABET_SIZE) +
                       board[boardTripletIndices[i++]]) << ALPHABET_SIZE) +
                       board[boardTripletIndices[i++]];
      possibleTriplets[triplet] = true; 
    }
  }

  void checkWordTriplets() {
    candidateCount = 0;
    for (DictionaryEntry entry: dictionary) {
      boolean ok = true;
      int len = entry.triplets.length;
      for (int t=0; (t<len) && ok; t++)
        ok = possibleTriplets[entry.triplets[t]];
      if (ok) candidateWords[candidateCount++] = entry;
    }
  }

  void checkWords() { // Can probably be optimized a lot
    foundCount = 0;
    for (int i=0; i<candidateCount; i++) {
      DictionaryEntry candidate = candidateWords[i];
      for (int j=0; j<board.length; j++)
        if (board[j]==candidate.letters[0]) { 
          usedBoardPositions[0] = j;
          if (checkNextLetters(candidate, 1, j)) {
            foundWords[foundCount++] = candidate;
            break;
          }
        }
    }
  }

  boolean checkNextLetters(DictionaryEntry candidate, int letter, int pos) {
    if (letter==candidate.letters.length) return true;
    int match = candidate.letters[letter];
    for (int move: moves) {
      int next=pos+move;
      if ((next>=0) && (next<board.length) && (board[next]==match) && !isWrap(pos, next)) {
        boolean ok = true;
        for (int i=0; (i<letter) && ok; i++)
          ok = usedBoardPositions[i]!=next;
        if (ok) {
          usedBoardPositions[letter] = next;
          if (checkNextLetters(candidate, letter+1, next)) return true;
        }
      }
    }   
    return false;
  }

  // Just some helper functions
  String formatTime(long start, long end, long repetitions) {
    long time = (end-start)/repetitions;
    return time/1000000 + "." + (time/100000) % 10 + "" + (time/10000) % 10 + "ms";
  }

  String getWord(DictionaryEntry entry) {
    char[] result = new char[entry.letters.length];
    int i=0;
    for (int letter: entry.letters)
      result[i++] = (char) (letter+97);
    return new String(result);
  }

  void run() throws IOException {
    long start = System.nanoTime();

    // The following can be pre-computed and should be replaced by constants
    dictionary = buildDictionary("C:/TWL06.txt");
    boardTripletIndices = buildTripletIndices();
    long precomputed = System.nanoTime();

    // The following only needs to run once at the beginning of the program
    candidateWords     = new DictionaryEntry[dictionary.length]; // WAAAY too generous
    foundWords         = new DictionaryEntry[dictionary.length]; // WAAAY too generous
    usedBoardPositions = new int[maxWordLength];
    long initialized = System.nanoTime(); 

    for (int n=1; n<=100; n++) {
      // The following needs to run again for every new board
      initializeBoard(new String[] {"DGHI",
                                    "KLPS",
                                    "YEUT",
                                    "EORN"});
      setPossibleTriplets();
      checkWordTriplets();
      checkWords();
    }
    long solved = System.nanoTime();

    // Print out result and statistics
    System.out.println("Precomputation finished in " + formatTime(start, precomputed, 1)+":");
    System.out.println("  Words in the dictionary: "+dictionary.length);
    System.out.println("  Longest word:            "+maxWordLength+" letters");
    System.out.println("  Number of triplet-moves: "+boardTripletIndices.length/3);
    System.out.println();

    System.out.println("Initialization finished in " + formatTime(precomputed, initialized, 1));
    System.out.println();

    System.out.println("Board solved in "+formatTime(initialized, solved, 100)+":");
    System.out.println("  Number of candidates: "+candidateCount);
    System.out.println("  Number of actual words: "+foundCount);
    System.out.println();

    System.out.println("Words found:");
    int w=0;
    System.out.print("  ");
    for (int i=0; i<foundCount; i++) {
      System.out.print(getWord(foundWords[i]));
      w++;
      if (w==10) {
        w=0;
        System.out.println(); System.out.print("  ");
      } else
        if (i<foundCount-1) System.out.print(", ");
    }
    System.out.println();
  }

  public static void main(String[] args) throws IOException {
    new BoggleSolver().run();
  }
} 
```

**以下是一些结果：**

对于原始问题（DGHI ...）中发布的图片中的网格：

```
Precomputation finished in 239.59ms:
  Words in the dictionary: 178590
  Longest word:            15 letters
  Number of triplet-moves: 408

Initialization finished in 0.22ms

Board solved in 3.70ms:
  Number of candidates: 230
  Number of actual words: 163 

Words found:
  eek, eel, eely, eld, elhi, elk, ern, erupt, erupts, euro
  eye, eyer, ghi, ghis, glee, gley, glue, gluer, gluey, glut
  gluts, hip, hiply, hips, his, hist, kelp, kelps, kep, kepi
  kepis, keps, kept, kern, key, kye, lee, lek, lept, leu
  ley, lunt, lunts, lure, lush, lust, lustre, lye, nus, nut
  nuts, ore, ort, orts, ouph, ouphs, our, oust, out, outre
  outs, oyer, pee, per, pert, phi, phis, pis, pish, plus
  plush, ply, plyer, psi, pst, pul, pule, puler, pun, punt
  punts, pur, pure, puree, purely, pus, push, put, puts, ree
  rely, rep, reply, reps, roe, roue, roup, roups, roust, rout
  routs, rue, rule, ruly, run, runt, runts, rupee, rush, rust
  rut, ruts, ship, shlep, sip, sipe, spue, spun, spur, spurn
  spurt, strep, stroy, stun, stupe, sue, suer, sulk, sulker, sulky
  sun, sup, supe, super, sure, surely, tree, trek, trey, troupe
  troy, true, truly, tule, tun, tup, tups, turn, tush, ups
  urn, uts, yeld, yelk, yelp, yelps, yep, yeps, yore, you
  your, yourn, yous 
```

对于在原始问题（FXIE ...）中作为示例发布的字母

```
Precomputation finished in 239.68ms:
  Words in the dictionary: 178590
  Longest word:            15 letters
  Number of triplet-moves: 408

Initialization finished in 0.21ms

Board solved in 3.69ms:
  Number of candidates: 87
  Number of actual words: 76

Words found:
  amble, ambo, ami, amie, asea, awa, awe, awes, awl, axil
  axile, axle, boil, bole, box, but, buts, east, elm, emboli
  fame, fames, fax, lei, lie, lima, limb, limbo, limbs, lime
  limes, lob, lobs, lox, mae, maes, maw, maws, max, maxi
  mesa, mew, mewl, mews, mil, mile, milo, mix, oil, ole
  sae, saw, sea, seam, semi, sew, stub, swam, swami, tub
  tubs, tux, twa, twae, twaes, twas, uts, wae, waes, wamble
  wame, wames, was, wast, wax, west 
```

对于以下 5x5 网格：

```
R P R I T
A H H L N
I E T E P
Z R Y S G
O G W E Y 
```

它给出了这个：

```
Precomputation finished in 240.39ms:
  Words in the dictionary: 178590
  Longest word:            15 letters
  Number of triplet-moves: 768

Initialization finished in 0.23ms

Board solved in 3.85ms:
  Number of candidates: 331
  Number of actual words: 240

Words found:
  aero, aery, ahi, air, airt, airth, airts, airy, ear, egest
  elhi, elint, erg, ergo, ester, eth, ether, eye, eyen, eyer
  eyes, eyre, eyrie, gel, gelt, gelts, gen, gent, gentil, gest
  geste, get, gets, gey, gor, gore, gory, grey, greyest, greys
  gyre, gyri, gyro, hae, haet, haets, hair, hairy, hap, harp
  heap, hear, heh, heir, help, helps, hen, hent, hep, her
  hero, hes, hest, het, hetero, heth, hets, hey, hie, hilt
  hilts, hin, hint, hire, hit, inlet, inlets, ire, leg, leges
  legs, lehr, lent, les, lest, let, lethe, lets, ley, leys
  lin, line, lines, liney, lint, lit, neg, negs, nest, nester
  net, nether, nets, nil, nit, ogre, ore, orgy, ort, orts
  pah, pair, par, peg, pegs, peh, pelt, pelter, peltry, pelts
  pen, pent, pes, pest, pester, pesty, pet, peter, pets, phi
  philter, philtre, phiz, pht, print, pst, rah, rai, rap, raphe
  raphes, reap, rear, rei, ret, rete, rets, rhaphe, rhaphes, rhea
  ria, rile, riles, riley, rin, rye, ryes, seg, sel, sen
  sent, senti, set, sew, spelt, spelter, spent, splent, spline, splint
  split, stent, step, stey, stria, striae, sty, stye, tea, tear
  teg, tegs, tel, ten, tent, thae, the, their, then, these
  thesp, they, thin, thine, thir, thirl, til, tile, tiles, tilt
  tilter, tilth, tilts, tin, tine, tines, tirl, trey, treys, trog
  try, tye, tyer, tyes, tyre, tyro, west, wester, wry, wryest
  wye, wyes, wyte, wytes, yea, yeah, year, yeh, yelp, yelps
  yen, yep, yeps, yes, yester, yet, yew, yews, zero, zori 
```

为此，我使用了[TWL06 Tournament Scrabble Word List](http://www.isc.ro/lists/twl06.zip)，因为原始问题中的链接不再有效。这个文件是 1.85MB，所以它有点短。该`buildDictionary`函数会抛出所有少于 3 个字母的单词。

以下是关于此性能的一些观察：

*   它比 Victor Nicollet 的 OCaml 实现的报告性能慢了大约 10 倍。这是否是由不同的算法、他使用的较短的字典、他的代码是在 Java 虚拟机中编译和运行的事实，或者是我们计算机的性能（我的是运行 WinXP 的 Intel Q6600 @ 2.4MHz）引起的，我不知道。但它比原始问题末尾引用的其他实现的结果要快得多。所以，这个算法是否优于 trie 字典，我目前不知道。

*   中使用的表格方法可以`checkWordTriplets()`很好地近似实际答案。它通过的 3-5 个单词中只有 1 个不会通过`checkWords()`测试（请参阅上面*的候选人*数与*实际单词数*）。

*   上面看不到的东西：该`checkWordTriplets()`函数大约需要 3.65 毫秒，因此在搜索过程中占主导地位。该`checkWords()`函数几乎占用了剩余的 0.05-0.20 毫秒。

*   该`checkWordTriplets()`函数的执行时间与字典大小成线性关系，几乎**与棋盘大小无关！**

*   的执行时间`checkWords()`取决于板子大小和不排除的字数`checkWordTriplets()`。

*   上面的`checkWords()`实现是我想出的最愚蠢的第一个版本。它基本上根本没有优化。但相比之下`checkWordTriplets()`它与应用程序的整体性能无关，所以我并不担心。**但是**，如果电路板尺寸变大，此功能将变得越来越慢，最终开始变得重要。然后，它也需要优化。

*   这段代码的一个好处是它的灵活性：

    *   您可以轻松更改电路板大小：更新第 10 行并将字符串数组传递给`initializeBoard()`.
    *   它可以支持更大/不同的字母，并且可以处理诸如将“Qu”视为一个字母之类的事情，而不会产生任何性能开销。为此，需要更新第 9 行以及将字符转换为数字的几个位置（目前只需从 ASCII 值中减去 65）

好的，但我认为现在这篇文章已经足够长了。我绝对可以回答您可能遇到的任何问题，但让我们将其移至评论中。

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2009-04-16T17:20:12.153

令人惊讶的是，没有人尝试过这个的 PHP 版本。

这是 John Fouhy 的 Python 解决方案的工作 PHP 版本。

尽管我从其他人的答案中得到了一些指示，但这主要是从约翰那里复制的。

```
$boggle = "fxie
           amlo
           ewbx
           astu";

$alphabet = str_split(str_replace(array("\n", " ", "\r"), "", strtolower($boggle)));
$rows = array_map('trim', explode("\n", $boggle));
$dictionary = file("C:/dict.txt");
$prefixes = array(''=>'');
$words = array();
$regex = '/[' . implode('', $alphabet) . ']{3,}$/S';
foreach($dictionary as $k=>$value) {
    $value = trim(strtolower($value));
    $length = strlen($value);
    if(preg_match($regex, $value)) {
        for($x = 0; $x < $length; $x++) {
            $letter = substr($value, 0, $x+1);
            if($letter == $value) {
                $words[$value] = 1;
            } else {
                $prefixes[$letter] = 1;
            }
        }
    }
}

$graph = array();
$chardict = array();
$positions = array();
$c = count($rows);
for($i = 0; $i < $c; $i++) {
    $l = strlen($rows[$i]);
    for($j = 0; $j < $l; $j++) {
        $chardict[$i.','.$j] = $rows[$i][$j];
        $children = array();
        $pos = array(-1,0,1);
        foreach($pos as $z) {
            $xCoord = $z + $i;
            if($xCoord < 0 || $xCoord >= count($rows)) {
                continue;
            }
            $len = strlen($rows[0]);
            foreach($pos as $w) {
                $yCoord = $j + $w;
                if(($yCoord < 0 || $yCoord >= $len) || ($z == 0 && $w == 0)) {
                    continue;
                }
                $children[] = array($xCoord, $yCoord);
            }
        }
        $graph['None'][] = array($i, $j);
        $graph[$i.','.$j] = $children;
    }
}

function to_word($chardict, $prefix) {
    $word = array();
    foreach($prefix as $v) {
        $word[] = $chardict[$v[0].','.$v[1]];
    }
    return implode("", $word);
}

function find_words($graph, $chardict, $position, $prefix, $prefixes, &$results, $words) {
    $word = to_word($chardict, $prefix);
    if(!isset($prefixes[$word])) return false;

    if(isset($words[$word])) {
        $results[] = $word;
    }

    foreach($graph[$position] as $child) {
        if(!in_array($child, $prefix)) {
            $newprefix = $prefix;
            $newprefix[] = $child;
            find_words($graph, $chardict, $child[0].','.$child[1], $newprefix, $prefixes, $results, $words);
        }
    }
}

$solution = array();
find_words($graph, $chardict, 'None', array(), $prefixes, $solution);
print_r($solution); 
```

如果您想尝试一下，这是一个[实时链接。](http://www.rootspot.com/stackoverflow/boggle.php)虽然在我的本地机器上大约需要 2 秒，但在我的网络服务器上需要大约 5 秒。无论哪种情况，它都不是很快。尽管如此，它仍然非常可怕，所以我可以想象时间可以大大减少。任何有关如何实现这一目标的指示将不胜感激。PHP 缺少元组使坐标难以使用，而我无法理解到底发生了什么也没有任何帮助。

**编辑**：一些修复使它在本地花费不到 1 秒。

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2009-04-15T08:02:46.293

对VB不感兴趣？:) 我无法抗拒。我解决这个问题的方式与这里介绍的许多解决方案不同。

我的时间是：

*   将字典和单词前缀加载到哈希表中：0.5 到 1 秒。
*   找词：平均不到 10 毫秒。

编辑：网络主机服务器上的字典加载时间比我的家用电脑长约 1 到 1.5 秒。

我不知道随着服务器负载的增加，时间会恶化到什么程度。

我将我的解决方案写成 .Net 中的网页。[myvrad.com/boggle](http://www.myvrad.com/boggle/default.aspx)

我正在使用原始问题中引用的字典。

字母不会在一个单词中重复使用。仅找到 3 个字符或更长的单词。

我正在使用所有唯一单词前缀和单词的哈希表而不是 trie。我不知道 trie's 所以我在那里学到了一些东西。除了完整的单词之外，创建一个单词前缀列表的想法最终让我的时间减少到一个可观的数字。

阅读代码注释以获取更多详细信息。

这是代码：

```
Imports System.Collections.Generic
Imports System.IO

Partial Class boggle_Default

    'Bob Archer, 4/15/2009

    'To avoid using a 2 dimensional array in VB I'm not using typical X,Y
    'coordinate iteration to find paths.
    '
    'I have locked the code into a 4 by 4 grid laid out like so:
    ' abcd
    ' efgh
    ' ijkl
    ' mnop
    ' 
    'To find paths the code starts with a letter from a to p then
    'explores the paths available around it. If a neighboring letter
    'already exists in the path then we don't go there.
    '
    'Neighboring letters (grid points) are hard coded into
    'a Generic.Dictionary below.

    'Paths is a list of only valid Paths found. 
    'If a word prefix or word is not found the path is not
    'added and extending that path is terminated.
    Dim Paths As New Generic.List(Of String)

    'NeighborsOf. The keys are the letters a to p.
    'The value is a string of letters representing neighboring letters.
    'The string of neighboring letters is split and iterated later.
    Dim NeigborsOf As New Generic.Dictionary(Of String, String)

    'BoggleLetters. The keys are mapped to the lettered grid of a to p.
    'The values are what the user inputs on the page.
    Dim BoggleLetters As New Generic.Dictionary(Of String, String)

    'Used to store last postition of path. This will be a letter
    'from a to p.
    Dim LastPositionOfPath As String = ""

    'I found a HashTable was by far faster than a Generic.Dictionary 
    ' - about 10 times faster. This stores prefixes of words and words.
    'I determined 792773 was the number of words and unique prefixes that
    'will be generated from the dictionary file. This is a max number and
    'the final hashtable will not have that many.
    Dim HashTableOfPrefixesAndWords As New Hashtable(792773)

    'Stores words that are found.
    Dim FoundWords As New Generic.List(Of String)

    'Just to validate what the user enters in the grid.
    Dim ErrorFoundWithSubmittedLetters As Boolean = False

    Public Sub BuildAndTestPathsAndFindWords(ByVal ThisPath As String)
        'Word is the word correlating to the ThisPath parameter.
        'This path would be a series of letters from a to p.
        Dim Word As String = ""

        'The path is iterated through and a word based on the actual
        'letters in the Boggle grid is assembled.
        For i As Integer = 0 To ThisPath.Length - 1
            Word += Me.BoggleLetters(ThisPath.Substring(i, 1))
        Next

        'If my hashtable of word prefixes and words doesn't contain this Word
        'Then this isn't a word and any further extension of ThisPath will not
        'yield any words either. So exit sub to terminate exploring this path.
        If Not HashTableOfPrefixesAndWords.ContainsKey(Word) Then Exit Sub

        'The value of my hashtable is a boolean representing if the key if a word (true) or
        'just a prefix (false). If true and at least 3 letters long then yay! word found.
        If HashTableOfPrefixesAndWords(Word) AndAlso Word.Length > 2 Then Me.FoundWords.Add(Word)

        'If my List of Paths doesn't contain ThisPath then add it.
        'Remember only valid paths will make it this far. Paths not found
        'in the HashTableOfPrefixesAndWords cause this sub to exit above.
        If Not Paths.Contains(ThisPath) Then Paths.Add(ThisPath)

        'Examine the last letter of ThisPath. We are looking to extend the path
        'to our neighboring letters if any are still available.
        LastPositionOfPath = ThisPath.Substring(ThisPath.Length - 1, 1)

        'Loop through my list of neighboring letters (representing grid points).
        For Each Neighbor As String In Me.NeigborsOf(LastPositionOfPath).ToCharArray()
            'If I find a neighboring grid point that I haven't already used
            'in ThisPath then extend ThisPath and feed the new path into
            'this recursive function. (see recursive.)
            If Not ThisPath.Contains(Neighbor) Then Me.BuildAndTestPathsAndFindWords(ThisPath & Neighbor)
        Next
    End Sub

    Protected Sub ButtonBoggle_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles ButtonBoggle.Click

        'User has entered the 16 letters and clicked the go button.

        'Set up my Generic.Dictionary of grid points, I'm using letters a to p -
        'not an x,y grid system.  The values are neighboring points.
        NeigborsOf.Add("a", "bfe")
        NeigborsOf.Add("b", "cgfea")
        NeigborsOf.Add("c", "dhgfb")
        NeigborsOf.Add("d", "hgc")
        NeigborsOf.Add("e", "abfji")
        NeigborsOf.Add("f", "abcgkjie")
        NeigborsOf.Add("g", "bcdhlkjf")
        NeigborsOf.Add("h", "cdlkg")
        NeigborsOf.Add("i", "efjnm")
        NeigborsOf.Add("j", "efgkonmi")
        NeigborsOf.Add("k", "fghlponj")
        NeigborsOf.Add("l", "ghpok")
        NeigborsOf.Add("m", "ijn")
        NeigborsOf.Add("n", "ijkom")
        NeigborsOf.Add("o", "jklpn")
        NeigborsOf.Add("p", "klo")

        'Retrieve letters the user entered.
        BoggleLetters.Add("a", Me.TextBox1.Text.ToLower.Trim())
        BoggleLetters.Add("b", Me.TextBox2.Text.ToLower.Trim())
        BoggleLetters.Add("c", Me.TextBox3.Text.ToLower.Trim())
        BoggleLetters.Add("d", Me.TextBox4.Text.ToLower.Trim())
        BoggleLetters.Add("e", Me.TextBox5.Text.ToLower.Trim())
        BoggleLetters.Add("f", Me.TextBox6.Text.ToLower.Trim())
        BoggleLetters.Add("g", Me.TextBox7.Text.ToLower.Trim())
        BoggleLetters.Add("h", Me.TextBox8.Text.ToLower.Trim())
        BoggleLetters.Add("i", Me.TextBox9.Text.ToLower.Trim())
        BoggleLetters.Add("j", Me.TextBox10.Text.ToLower.Trim())
        BoggleLetters.Add("k", Me.TextBox11.Text.ToLower.Trim())
        BoggleLetters.Add("l", Me.TextBox12.Text.ToLower.Trim())
        BoggleLetters.Add("m", Me.TextBox13.Text.ToLower.Trim())
        BoggleLetters.Add("n", Me.TextBox14.Text.ToLower.Trim())
        BoggleLetters.Add("o", Me.TextBox15.Text.ToLower.Trim())
        BoggleLetters.Add("p", Me.TextBox16.Text.ToLower.Trim())

        'Validate user entered something with a length of 1 for all 16 textboxes.
        For Each S As String In BoggleLetters.Keys
            If BoggleLetters(S).Length <> 1 Then
                ErrorFoundWithSubmittedLetters = True
                Exit For
            End If
        Next

        'If input is not valid then...
        If ErrorFoundWithSubmittedLetters Then
            'Present error message.
        Else
            'Else assume we have 16 letters to work with and start finding words.
            Dim SB As New StringBuilder

            Dim Time As String = String.Format("{0}:{1}:{2}:{3}", Date.Now.Hour.ToString(), Date.Now.Minute.ToString(), Date.Now.Second.ToString(), Date.Now.Millisecond.ToString())

            Dim NumOfLetters As Integer = 0
            Dim Word As String = ""
            Dim TempWord As String = ""
            Dim Letter As String = ""
            Dim fr As StreamReader = Nothing
            fr = New System.IO.StreamReader(HttpContext.Current.Request.MapPath("~/boggle/dic.txt"))

            'First fill my hashtable with word prefixes and words.
            'HashTable(PrefixOrWordString, BooleanTrueIfWordFalseIfPrefix)
            While fr.Peek <> -1
                Word = fr.ReadLine.Trim()
                TempWord = ""
                For i As Integer = 0 To Word.Length - 1
                    Letter = Word.Substring(i, 1)
                    'This optimization helped quite a bit. Words in the dictionary that begin
                    'with letters that the user did not enter in the grid shouldn't go in my hashtable.
                    '
                    'I realize most of the solutions went with a Trie. I'd never heard of that before,
                    'which is one of the neat things about SO, seeing how others approach challenges
                    'and learning some best practices.
                    '
                    'However, I didn't code a Trie in my solution. I just have a hashtable with 
                    'all words in the dicitonary file and all possible prefixes for those words.
                    'A Trie might be faster but I'm not coding it now. I'm getting good times with this.
                    If i = 0 AndAlso Not BoggleLetters.ContainsValue(Letter) Then Continue While
                    TempWord += Letter
                    If Not HashTableOfPrefixesAndWords.ContainsKey(TempWord) Then
                        HashTableOfPrefixesAndWords.Add(TempWord, TempWord = Word)
                    End If
                Next
            End While

            SB.Append("Number of Word Prefixes and Words in Hashtable: " & HashTableOfPrefixesAndWords.Count.ToString())
            SB.Append("<br />")

            SB.Append("Loading Dictionary: " & Time & " - " & String.Format("{0}:{1}:{2}:{3}", Date.Now.Hour.ToString(), Date.Now.Minute.ToString(), Date.Now.Second.ToString(), Date.Now.Millisecond.ToString()))
            SB.Append("<br />")

            Time = String.Format("{0}:{1}:{2}:{3}", Date.Now.Hour.ToString(), Date.Now.Minute.ToString(), Date.Now.Second.ToString(), Date.Now.Millisecond.ToString())

            'This starts a path at each point on the grid an builds a path until 
            'the string of letters correlating to the path is not found in the hashtable
            'of word prefixes and words.
            Me.BuildAndTestPathsAndFindWords("a")
            Me.BuildAndTestPathsAndFindWords("b")
            Me.BuildAndTestPathsAndFindWords("c")
            Me.BuildAndTestPathsAndFindWords("d")
            Me.BuildAndTestPathsAndFindWords("e")
            Me.BuildAndTestPathsAndFindWords("f")
            Me.BuildAndTestPathsAndFindWords("g")
            Me.BuildAndTestPathsAndFindWords("h")
            Me.BuildAndTestPathsAndFindWords("i")
            Me.BuildAndTestPathsAndFindWords("j")
            Me.BuildAndTestPathsAndFindWords("k")
            Me.BuildAndTestPathsAndFindWords("l")
            Me.BuildAndTestPathsAndFindWords("m")
            Me.BuildAndTestPathsAndFindWords("n")
            Me.BuildAndTestPathsAndFindWords("o")
            Me.BuildAndTestPathsAndFindWords("p")

            SB.Append("Finding Words: " & Time & " - " & String.Format("{0}:{1}:{2}:{3}", Date.Now.Hour.ToString(), Date.Now.Minute.ToString(), Date.Now.Second.ToString(), Date.Now.Millisecond.ToString()))
            SB.Append("<br />")

            SB.Append("Num of words found: " & FoundWords.Count.ToString())
            SB.Append("<br />")
            SB.Append("<br />")

            FoundWords.Sort()
            SB.Append(String.Join("<br />", FoundWords.ToArray()))

            'Output results.
            Me.LiteralBoggleResults.Text = SB.ToString()
            Me.PanelBoggleResults.Visible = True

        End If

    End Sub

End Class 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2009-06-26T05:37:53.167

一看到问题陈述，我就想到了“Trie”。但是看到其他几位海报使用了这种方法，我寻找另一种方法只是为了与众不同。唉，Trie 方法表现更好。我在我的机器上运行了 Kent 的 Perl 解决方案，在调整它以使用我的字典文件之后，它运行了**0.31秒。**我自己的 perl 实现需要**0.54**秒才能运行。

这是我的方法：

1.  创建一个转换哈希来模拟合法的转换。

2.  遍历所有 16^3 个可能的三个字母组合。

    *   在循环中，排除非法转换并重复访问同一个方格。形成所有合法的 3 字母序列并将它们存储在哈希中。
3.  然后遍历字典中的所有单词。

    *   排除太长或太短的词
    *   在每个单词上滑动一个 3 字母窗口，看看它是否在步骤 2 中的 3 字母组合中。排除失败的单词。这消除了大多数不匹配。
    *   如果仍然没有消除，请使用递归算法来查看是否可以通过在拼图中创建路径来形成单词。（这部分很慢，但不经常调用。）
4.  打印出我找到的单词。

    我尝试了 3 个字母和 4 个字母的序列，但是 4 个字母的序列减慢了程序的速度。

在我的代码中，我使用 /usr/share/dict/words 作为我的字典。它是 MAC OS X 和许多 Unix 系统的标准配置。如果需要，您可以使用其他文件。要破解不同的谜题，只需更改变量@puzzle。这很容易适应更大的矩阵。您只需要更改 %transitions 哈希和 %legalTransitions 哈希。

该解决方案的优势在于代码短，数据结构简单。

这是 Perl 代码（我知道它使用了太多全局变量）：

```
#!/usr/bin/perl
use Time::HiRes  qw{ time };

sub readFile($);
sub findAllPrefixes($);
sub isWordTraceable($);
sub findWordsInPuzzle(@);

my $startTime = time;

# Puzzle to solve

my @puzzle = ( 
    F, X, I, E,
    A, M, L, O,
    E, W, B, X,
    A, S, T, U
);

my $minimumWordLength = 3;
my $maximumPrefixLength = 3; # I tried four and it slowed down.

# Slurp the word list.
my $wordlistFile = "/usr/share/dict/words";

my @words = split(/\n/, uc(readFile($wordlistFile)));
print "Words loaded from word list: " . scalar @words . "\n";

print "Word file load time: " . (time - $startTime) . "\n";
my $postLoad = time;

# Define the legal transitions from one letter position to another. 
# Positions are numbered 0-15.
#     0  1  2  3
#     4  5  6  7
#     8  9 10 11
#    12 13 14 15
my %transitions = ( 
   -1 => [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],
    0 => [1,4,5], 
    1 => [0,2,4,5,6],
    2 => [1,3,5,6,7],
    3 => [2,6,7],
    4 => [0,1,5,8,9],
    5 => [0,1,2,4,6,8,9,10],
    6 => [1,2,3,5,7,9,10,11],
    7 => [2,3,6,10,11],
    8 => [4,5,9,12,13],
    9 => [4,5,6,8,10,12,13,14],
    10 => [5,6,7,9,11,13,14,15],
    11 => [6,7,10,14,15],
    12 => [8,9,13],
    13 => [8,9,10,12,14],
    14 => [9,10,11,13,15],
    15 => [10,11,14]
);

# Convert the transition matrix into a hash for easy access.
my %legalTransitions = ();
foreach my $start (keys %transitions) {
    my $legalRef = $transitions{$start};
    foreach my $stop (@$legalRef) {
        my $index = ($start + 1) * (scalar @puzzle) + ($stop + 1);
        $legalTransitions{$index} = 1;
    }
}

my %prefixesInPuzzle = findAllPrefixes($maximumPrefixLength);

print "Find prefixes time: " . (time - $postLoad) . "\n";
my $postPrefix = time;

my @wordsFoundInPuzzle = findWordsInPuzzle(@words);

print "Find words in puzzle time: " . (time - $postPrefix) . "\n";

print "Unique prefixes found: " . (scalar keys %prefixesInPuzzle) . "\n";
print "Words found (" . (scalar @wordsFoundInPuzzle) . ") :\n    " . join("\n    ", @wordsFoundInPuzzle) . "\n";

print "Total Elapsed time: " . (time - $startTime) . "\n";

###########################################

sub readFile($) {
    my ($filename) = @_;
    my $contents;
    if (-e $filename) {
        # This is magic: it opens and reads a file into a scalar in one line of code. 
        # See http://www.perl.com/pub/a/2003/11/21/slurp.html
        $contents = do { local( @ARGV, $/ ) = $filename ; <> } ; 
    }
    else {
        $contents = '';
    }
    return $contents;
}

# Is it legal to move from the first position to the second? They must be adjacent.
sub isLegalTransition($$) {
    my ($pos1,$pos2) = @_;
    my $index = ($pos1 + 1) * (scalar @puzzle) + ($pos2 + 1);
    return $legalTransitions{$index};
}

# Find all prefixes where $minimumWordLength <= length <= $maxPrefixLength
#
#   $maxPrefixLength ... Maximum length of prefix we will store. Three gives best performance. 
sub findAllPrefixes($) {
    my ($maxPrefixLength) = @_;
    my %prefixes = ();
    my $puzzleSize = scalar @puzzle;

    # Every possible N-letter combination of the letters in the puzzle 
    # can be represented as an integer, though many of those combinations
    # involve illegal transitions, duplicated letters, etc.
    # Iterate through all those possibilities and eliminate the illegal ones.
    my $maxIndex = $puzzleSize ** $maxPrefixLength;

    for (my $i = 0; $i < $maxIndex; $i++) {
        my @path;
        my $remainder = $i;
        my $prevPosition = -1;
        my $prefix = '';
        my %usedPositions = ();
        for (my $prefixLength = 1; $prefixLength <= $maxPrefixLength; $prefixLength++) {
            my $position = $remainder % $puzzleSize;

            # Is this a valid step?
            #  a. Is the transition legal (to an adjacent square)?
            if (! isLegalTransition($prevPosition, $position)) {
                last;
            }

            #  b. Have we repeated a square?
            if ($usedPositions{$position}) {
                last;
            }
            else {
                $usedPositions{$position} = 1;
            }

            # Record this prefix if length >= $minimumWordLength.
            $prefix .= $puzzle[$position];
            if ($prefixLength >= $minimumWordLength) {
                $prefixes{$prefix} = 1;
            }

            push @path, $position;
            $remainder -= $position;
            $remainder /= $puzzleSize;
            $prevPosition = $position;
        } # end inner for
    } # end outer for
    return %prefixes;
}

# Loop through all words in dictionary, looking for ones that are in the puzzle.
sub findWordsInPuzzle(@) {
    my @allWords = @_;
    my @wordsFound = ();
    my $puzzleSize = scalar @puzzle;
WORD: foreach my $word (@allWords) {
        my $wordLength = length($word);
        if ($wordLength > $puzzleSize || $wordLength < $minimumWordLength) {
            # Reject word as too short or too long.
        }
        elsif ($wordLength <= $maximumPrefixLength ) {
            # Word should be in the prefix hash.
            if ($prefixesInPuzzle{$word}) {
                push @wordsFound, $word;
            }
        }
        else {
            # Scan through the word using a window of length $maximumPrefixLength, looking for any strings not in our prefix list.
            # If any are found that are not in the list, this word is not possible.
            # If no non-matches are found, we have more work to do.
            my $limit = $wordLength - $maximumPrefixLength + 1;
            for (my $startIndex = 0; $startIndex < $limit; $startIndex ++) {
                if (! $prefixesInPuzzle{substr($word, $startIndex, $maximumPrefixLength)}) {
                    next WORD;
                }
            }
            if (isWordTraceable($word)) {
                # Additional test necessary: see if we can form this word by following legal transitions
                push @wordsFound, $word;
            }
        }

    }
    return @wordsFound;
}

# Is it possible to trace out the word using only legal transitions?
sub isWordTraceable($) {
    my $word = shift;
    return traverse([split(//, $word)], [-1]); # Start at special square -1, which may transition to any square in the puzzle.
}

# Recursively look for a path through the puzzle that matches the word.
sub traverse($$) {
    my ($lettersRef, $pathRef) = @_;
    my $index = scalar @$pathRef - 1;
    my $position = $pathRef->[$index];
    my $letter = $lettersRef->[$index];
    my $branchesRef =  $transitions{$position};
BRANCH: foreach my $branch (@$branchesRef) {
            if ($puzzle[$branch] eq $letter) {
                # Have we used this position yet?
                foreach my $usedBranch (@$pathRef) {
                    if ($usedBranch == $branch) {
                        next BRANCH;
                    }
                }
                if (scalar @$lettersRef == $index + 1) {
                    return 1; # End of word and success.
                }
                push @$pathRef, $branch;
                if (traverse($lettersRef, $pathRef)) {
                    return 1; # Recursive success.
                }
                else {
                    pop @$pathRef;
                }
            }
        }
    return 0; # No path found. Failed.
} 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2009-10-07T12:59:10.623

我知道我已经很晚了，但我不久前用**PHP**做了一个——也只是为了好玩......

[http://www.lostsockdesign.com.au/sandbox/boggle/index.php?letters=fxieamloewbxastu在](http://www.lostsockdesign.com.au/sandbox/boggle/index.php?letters=fxieamloewbxastu)**0.90108 秒内** 找到 75 个单词（133 分）

 **`F.........X..I..............E............... A......................................M..............................L............................O............................... E....................W............................B..........................X A..................S..................................................T.................U....`

给出程序实际在做什么的一些指示 - 每个字母是它开始查看模式的地方，而每个“。” 显示了它试图采取的路径。'.' 越多。它搜索得越远。

如果您想要代码，请告诉我...它是 PHP 和 HTML 的可怕组合，从来没有想过要见识见识，所以我不敢在这里发布它：P

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2009-11-19T07:06:12.983

我花了 3 个月的时间来解决 10 个最佳点密集 5x5 Boggle 板问题的解决方案。

该问题现已解决，并在 5 个网页上进行了全面披露。有问题请联系我。

棋盘分析算法使用显式堆栈通过具有直接子信息的有向无环字图和时间戳跟踪机制伪递归地遍历棋盘方格。这很可能是世界上最先进的词典数据结构。

该方案每秒在四核上评估大约 10,000 个非常好的电路板。（9500+ 点）

父网页：

DeepSearch.c - [http://www.pathcom.com/~vadco/deep.html](http://www.pathcom.com/~vadco/deep.html)

组件网页：

最佳记分牌 - [http://www.pathcom.com/~vadco/binary.html](http://www.pathcom.com/~vadco/binary.html)

高级词典结构 - [http://www.pathcom.com/~vadco/adtdawg.html](http://www.pathcom.com/~vadco/adtdawg.html)

董事会分析算法 - [http://www.pathcom.com/~vadco/guns.html](http://www.pathcom.com/~vadco/guns.html)

并行批处理 - [http://www.pathcom.com/~vadco/parallel.html](http://www.pathcom.com/~vadco/parallel.html)

- 这种综合性的工作只会对要求最好的人感兴趣。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-04-14T02:15:05.967

首先，阅读一位 C# 语言设计者如何解决相关问题：http: [//blogs.msdn.com/ericlippert/archive/2009/02/04/a-nasality-talisman-for-the-sultana-analyst.aspx](http://blogs.msdn.com/ericlippert/archive/2009/02/04/a-nasality-talisman-for-the-sultana-analyst.aspx) .

像他一样，您可以从字典和规范化单词开始，方法是创建字典，从按字母顺序排序的字母数组到可以从这些字母拼写的单词列表。

接下来，开始从板上创建可能的单词并查找它们。我怀疑这会让你走得很远，但肯定有更多的技巧可以加快速度。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-04-14T02:16:28.133

随着搜索的继续，您的搜索算法是否会不断减少单词列表？

例如，在上面的搜索中，您的单词只能以 13 个字母开头（有效地减少了一半的起始字母）。

当您添加更多字母排列时，它会进一步减少可用的单词集，从而减少必要的搜索。

我会从那里开始。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-04-14T02:20:32.523

我必须更多地考虑一个完整的解决方案，但作为一个方便的优化，我想知道是否值得根据所有字典中的单词，并使用它来确定搜索的优先级。我会选择单词的开头字母。因此，如果您的字典包含“印度”、“水”、“极端”和“非凡”等词，那么您的预计算表可能是：

```
'IN': 1
'WA': 1
'EX': 2 
```

然后按照共性的顺序搜索这些 digrams（先 EX，然后 WA/IN）

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2009-04-14T02:25:19.470

我建议根据单词制作一棵字母树。树将由一个字母结构组成，如下所示：

```
letter: char
isWord: boolean 
```

然后你建立树，每个深度添加一个新字母。换句话说，第一层是字母表；然后从这些树中的每一个中，还有另外 26 个条目，依此类推，直到您拼出所有单词。挂在这棵解析树上，它会让所有可能的答案更快地查找。

使用此解析树，您可以非常快速地找到解决方案。这是伪代码：

```
BEGIN: 
    For each letter:
        if the struct representing it on the current depth has isWord == true, enter it as an answer.
        Cycle through all its neighbors; if there is a child of the current node corresponding to the letter, recursively call BEGIN on it. 
```

这可以通过一些动态编程来加速。例如，在您的示例中，两个“A”都在“E”和“W”旁边，它们（从它们击中它们的点开始）将是相同的。我没有足够的时间来真正拼出这个代码，但我认为你可以收集这个想法。

另外，如果您在 Google 上搜索“Boggle solver”，我相信您会找到其他解决方案。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2010-08-24T04:12:00.127

只是为了好玩，我在 bash 中实现了一个。它不是超快，但合理。

[http://dev.xkyle.com/bashboggle/](http://dev.xkyle.com/bashboggle/)

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-04-14T03:53:51.207

好笑。由于同一个该死的游戏，我几天前几乎发布了同样的问题！然而我没有，因为只是在谷歌搜索[boggle solver python](http://www.google.com/search?client=safari&rls=en-us&q=boggle+solver+python&ie=UTF-8&oe=UTF-8)并得到了我想要的所有答案。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2010-01-03T19:04:29.473

我意识到这个问题的时间已经过去了，但是由于我自己正在研究求解器，并且在谷歌搜索时偶然发现了这个问题，我想我应该发布对我的参考，因为它似乎与其他一些不同。

我选择为游戏板使用平面数组，并从板上的每个字母进行递归搜索，从有效邻居遍历到有效邻居，如果当前字母列表在索引中具有有效前缀，则扩展搜索。在遍历当前单词的概念时，是板中的索引列表，而不是组成单词的字母。检查索引时，将索引转换为字母并完成检查。

索引是一个蛮力字典，有点像特里树，但允许对索引进行 Pythonic 查询。如果“cat”和“cater”这两个词在列表中，你会在字典中得到这个：

```
 d = { 'c': ['cat','cater'],
     'ca': ['cat','cater'],
     'cat': ['cat','cater'],
     'cate': ['cater'],
     'cater': ['cater'],
   } 
```

所以如果 current_word 是 'ca' 你知道它是一个有效的前缀，因为`'ca' in d`返回 True （所以继续板遍历）。如果 current_word 是 'cat' 那么你知道它是一个有效的词，因为它是一个有效的前缀并且也`'cat' in d['cat']`返回 True。

如果感觉这样允许一些看起来不太慢的可读代码。像其他人一样，这个系统的开销是读取/构建索引。解决董事会几乎是噪音。

代码位于[http://gist.github.com/268079](http://gist.github.com/268079)。它是故意垂直和幼稚的，有很多明确的有效性检查，因为我想理解这个问题，而不是用一堆魔法或晦涩难懂的东西来处理它。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2013-04-08T00:19:13.950

我用 C++ 编写了我的求解器。我实现了一个自定义树结构。我不确定它可以被认为是一个特里，但它是相似的。每个节点有 26 个分支，每个字母 1 个。我与我的字典的分支平行地遍历了boggle board的分支。如果字典中不存在该分支，我将停止在 Boggle 板上搜索它。我将板上的所有字母转换为整数。所以'A' = 0。因为它只是数组，所以查找总是 O(1)。每个节点存储它是否完成了一个单词以及它的子节点中存在多少个单词。当找到单词时修剪树以减少重复搜索相同单词。我相信修剪也是 O(1)。

CPU：奔腾 SU2700 1.3GHz
内存：3GB

在 < 1 秒内加载 178,590 个单词的字典。
在 4 秒内解决 100x100 Boggle (boggle.txt)。找到约 44,000 个单词。
解决 4x4 Boggle 的速度太快，无法提供有意义的基准。:)

[快速 Boggle 求解器 GitHub 存储库](https://github.com/themachineswillwin/fast-boggle-solver)

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2015-03-24T06:54:00.210

给定一个具有 N 行和 M 列的 Boggle 板，让我们假设以下内容：

*   N*M 远大于可能的单词数
*   N*M 远大于可能的最长单词

在这些假设下，该解决方案的复杂度为 O(N*M)。

我认为以多种方式比较这个示例板的运行时间没有抓住重点，但为了完整起见，这个解决方案在我的现代 MacBook Pro 上的完成时间不到 0.2 秒。

该解决方案将为语料库中的每个单词找到所有可能的路径。

```
#!/usr/bin/env ruby
# Example usage: ./boggle-solver --board "fxie amlo ewbx astu"

autoload :Matrix, 'matrix'
autoload :OptionParser, 'optparse'

DEFAULT_CORPUS_PATH = '/usr/share/dict/words'.freeze

# Functions

def filter_corpus(matrix, corpus, min_word_length)
  board_char_counts = Hash.new(0)
  matrix.each { |c| board_char_counts[c] += 1 }

  max_word_length = matrix.row_count * matrix.column_count
  boggleable_regex = /^[#{board_char_counts.keys.reduce(:+)}]{#{min_word_length},#{max_word_length}}$/
  corpus.select{ |w| w.match boggleable_regex }.select do |w|
    word_char_counts = Hash.new(0)
    w.each_char { |c| word_char_counts[c] += 1 }
    word_char_counts.all? { |c, count| board_char_counts[c] >= count }
  end
end

def neighbors(point, matrix)
  i, j = point
  ([i-1, 0].max .. [i+1, matrix.row_count-1].min).inject([]) do |r, new_i|
    ([j-1, 0].max .. [j+1, matrix.column_count-1].min).inject(r) do |r, new_j|
      neighbor = [new_i, new_j]
      neighbor.eql?(point) ? r : r << neighbor
    end
  end
end

def expand_path(path, word, matrix)
  return [path] if path.length == word.length

  next_char = word[path.length]
  viable_neighbors = neighbors(path[-1], matrix).select do |point|
    !path.include?(point) && matrix.element(*point).eql?(next_char)
  end

  viable_neighbors.inject([]) do |result, point|
    result + expand_path(path.dup << point, word, matrix)
  end
end

def find_paths(word, matrix)
  result = []
  matrix.each_with_index do |c, i, j|
    result += expand_path([[i, j]], word, matrix) if c.eql?(word[0])
  end
  result
end

def solve(matrix, corpus, min_word_length: 3)
  boggleable_corpus = filter_corpus(matrix, corpus, min_word_length)
  boggleable_corpus.inject({}) do |result, w|
    paths = find_paths(w, matrix)
    result[w] = paths unless paths.empty?
    result
  end
end

# Script

options = { corpus_path: DEFAULT_CORPUS_PATH }
option_parser = OptionParser.new do |opts|
  opts.banner = 'Usage: boggle-solver --board <value> [--corpus <value>]'

  opts.on('--board BOARD', String, 'The board (e.g. "fxi aml ewb ast")') do |b|
    options[:board] = b
  end

  opts.on('--corpus CORPUS_PATH', String, 'Corpus file path') do |c|
    options[:corpus_path] = c
  end

  opts.on_tail('-h', '--help', 'Shows usage') do
    STDOUT.puts opts
    exit
  end
end
option_parser.parse!

unless options[:board]
  STDERR.puts option_parser
  exit false
end

unless File.file? options[:corpus_path]
  STDERR.puts "No corpus exists - #{options[:corpus_path]}"
  exit false
end

rows = options[:board].downcase.scan(/\S+/).map{ |row| row.scan(/./) }

raw_corpus = File.readlines(options[:corpus_path])
corpus = raw_corpus.map{ |w| w.downcase.rstrip }.uniq.sort

solution = solve(Matrix.rows(rows), corpus)
solution.each_pair do |w, paths|
  STDOUT.puts w
  paths.each do |path|
    STDOUT.puts "\t" + path.map{ |point| point.inspect }.join(', ')
  end
end
STDOUT.puts "TOTAL: #{solution.count}" 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2018-07-21T09:40:35.243

该解决方案还提供了在给定板上搜索的方向

算法：

```
1\. Uses trie to save all the word in the english to fasten the search
2\. The uses DFS to search the words in Boggle 
```

输出：

```
Found "pic" directions from (4,0)(p) go  → →
Found "pick" directions from (4,0)(p) go  → → ↑
Found "pickman" directions from (4,0)(p) go  → → ↑ ↑ ↖ ↑
Found "picket" directions from (4,0)(p) go  → → ↑ ↗ ↖
Found "picked" directions from (4,0)(p) go  → → ↑ ↗ ↘
Found "pickle" directions from (4,0)(p) go  → → ↑ ↘ → 
```

代码：

```
from collections import defaultdict
from nltk.corpus import words
from nltk.corpus import stopwords
from nltk.tokenize import word_tokenize

english_words = words.words()

# If you wan to remove stop words
# stop_words = set(stopwords.words('english'))
# english_words = [w for w in english_words if w not in stop_words]

boggle = [
    ['c', 'n', 't', 's', 's'],
    ['d', 'a', 't', 'i', 'n'],
    ['o', 'o', 'm', 'e', 'l'],
    ['s', 'i', 'k', 'n', 'd'],
    ['p', 'i', 'c', 'l', 'e']
]

# Instead of X and Y co-ordinates
# better to use Row and column
lenc = len(boggle[0])
lenr = len(boggle)

# Initialize trie datastructure
trie_node = {'valid': False, 'next': {}}

# lets get the delta to find all the nighbors
neighbors_delta = [
    (-1,-1, "↖"),
    (-1, 0, "↑"),
    (-1, 1, "↗"),
    (0, -1, "←"),
    (0,  1, "→"),
    (1, -1, "↙"),
    (1,  0, "↓"),
    (1,  1, "↘"),
]

def gen_trie(word, node):
    """udpates the trie datastructure using the given word"""
    if not word:
        return

    if word[0] not in node:
        node[word[0]] = {'valid': len(word) == 1, 'next': {}}

    # recursively build trie
    gen_trie(word[1:], node[word[0]])

def build_trie(words, trie):
    """Builds trie data structure from the list of words given"""
    for word in words:
        gen_trie(word, trie)
    return trie

def get_neighbors(r, c):
    """Returns the neighbors for a given co-ordinates"""
    n = []
    for neigh in neighbors_delta:
        new_r = r + neigh[0]
        new_c = c + neigh[1]

        if (new_r >= lenr) or (new_c >= lenc) or (new_r < 0) or (new_c < 0):
            continue
        n.append((new_r, new_c, neigh[2]))
    return n

def dfs(r, c, visited, trie, now_word, direction):
    """Scan the graph using DFS"""
    if (r, c) in visited:
        return

    letter = boggle[r][c]
    visited.append((r, c))

    if letter in trie:
        now_word += letter

        if trie[letter]['valid']:
            print('Found "{}" {}'.format(now_word, direction))

        neighbors = get_neighbors(r, c)
        for n in neighbors:
            dfs(n[0], n[1], visited[::], trie[letter], now_word, direction + " " + n[2])

def main(trie_node):
    """Initiate the search for words in boggle"""
    trie_node = build_trie(english_words, trie_node)

    # print the board
    print("Given board")
    for i in range(lenr):print (boggle[i])
    print ('\n')

    for r in range(lenr):
        for c in range(lenc):
            letter = boggle[r][c]
            dfs(r, c, [], trie_node, '', 'directions from ({},{})({}) go '.format(r, c, letter))

if __name__ == '__main__':
    main(trie_node) 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2012-05-13T12:01:07.627

我已经[在 OCaml 中实现了一个解决方案](https://github.com/VictorNicollet/Boggle)。它将字典预编译为 trie，并使用两个字母的序列频率来消除永远不会出现在单词中的边缘，以进一步加快处理速度。

它在 0.35 毫秒内解决了您的示例板（另外还有 6 毫秒的启动时间，这主要与将 trie 加载到内存中有关）。

找到的解决方案：

```
["swami"; "emile"; "limbs"; "limbo"; "limes"; "amble"; "tubs"; "stub";
 "swam"; "semi"; "seam"; "awes"; "buts"; "bole"; "boil"; "west"; "east";
 "emil"; "lobs"; "limb"; "lime"; "lima"; "mesa"; "mews"; "mewl"; "maws";
 "milo"; "mile"; "awes"; "amie"; "axle"; "elma"; "fame"; "ubs"; "tux"; "tub";
 "twa"; "twa"; "stu"; "saw"; "sea"; "sew"; "sea"; "awe"; "awl"; "but"; "btu";
 "box"; "bmw"; "was"; "wax"; "oil"; "lox"; "lob"; "leo"; "lei"; "lie"; "mes";
 "mew"; "mae"; "maw"; "max"; "mil"; "mix"; "awe"; "awl"; "elm"; "eli"; "fax"] 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2014-10-16T07:06:26.720

Node.JS JavaScript 解决方案。在不到一秒的时间内计算所有 100 个唯一单词，其中包括阅读字典文件 (MBA 2012)。

输出：
["FAM","TUX","TUB","FAE","ELI","ELM","ELB","TWA","TWA","SAW","AMI","SWA" ,"SWA","AME","SEA","SEW","AES","AWL","AWE","SEA","AWA","MIX","MIL","AST"," ASE","MAX","MAE","MAW","MEW","AWE","MES","AWL","LIE","LIM","AWA","AES","BUT" ,"BLO","WAS","WAE","WEA","LEI","LEO","LOB","LOX","WEM","OIL","OLM","WEA"," WAE","WAX","WAF","MILO","EAST","WAME","TWAS","TWAE","EMIL","WEAM","OIME","AXIL","WEST","TWAE","LIMB","WASE ","WAST","BLEO","STUB","BOIL","BOLE","LIME","SAWT","LIMA","MESA","MEWL","AXLE","FAME", "ASEM","MILE","AMIL","SEAX","SEAM","SEMI","SWAM","AMBO","AMLI","AXILE","AMBLE","SWAMI","AWEST ","AWEST","LIMAX","LIMES","LIMBU","LIMBO","EMBOX","SEMBLE","EMBOLE","WAMBLE","FAMBLE"]EAST","WAME","TWAS","TWAE","EMIL","WEAM","OIME","AXIL","WEST","TWAE","LIMB","WASE","WAST" ,"BLEO","STUB","BOIL","BOLE","LIME","SAWT","LIMA","MESA","MEWL","AXLE","FAME","ASEM"," MILE","AMIL","SEAX","SEAM","SEMI","SWAM","AMBO","AMLI","AXILE","AMBLE","SWAMI","AWEST","AWEST" ,"LIMAX","LIMES","LIMBU","LIMBO","EMBOX","SEMBLE","EMBOLE","WAMBLE","FAMBLE"]EAST","WAME","TWAS","TWAE","EMIL","WEAM","OIME","AXIL","WEST","TWAE","LIMB","WASE","WAST" ,"BLEO","STUB","BOIL","BOLE","LIME","SAWT","LIMA","MESA","MEWL","AXLE","FAME","ASEM"," MILE","AMIL","SEAX","SEAM","SEMI","SWAM","AMBO","AMLI","AXILE","AMBLE","SWAMI","AWEST","AWEST" ,"LIMAX","LIMES","LIMBU","LIMBO","EMBOX","SEMBLE","EMBOLE","WAMBLE","FAMBLE"]"TWAE","EMIL","WEAM","OIME","AXIL","WEST","TWAE","LIMB","WASE","WAST","BLEO","STUB","BOIL" ","BOLE","LIME","SAWT","LIMA","MESA","MEWL","AXLE","FAME","ASEM","MILE","AMIL","SEAX", "SEAM","SEMI","SWAM","AMBO","AMLI","AXILE","AMBLE","SWAMI","AWEST","AWEST","LIMAX","LIMES","LIMBU ","LIMBO","EMBOX","SEMBLE","EMBOLE","WAMBLE","FAMBLE"]"TWAE","EMIL","WEAM","OIME","AXIL","WEST","TWAE","LIMB","WASE","WAST","BLEO","STUB","BOIL" ","BOLE","LIME","SAWT","LIMA","MESA","MEWL","AXLE","FAME","ASEM","MILE","AMIL","SEAX", "SEAM","SEMI","SWAM","AMBO","AMLI","AXILE","AMBLE","SWAMI","AWEST","AWEST","LIMAX","LIMES","LIMBU ","LIMBO","EMBOX","SEMBLE","EMBOLE","WAMBLE","FAMBLE"]"WEST","TWAE","LIMB","WASE","WAST","BLEO","STUB","BOIL","BOLE","LIME","SAWT","LIMA","MESA ","MEWL","AXLE","FAME","ASEM","MILE","AMIL","SEAX","SEAM","SEMI","SWAM","AMBO","AMLI", "AXILE","AMBLE","SWAMI","AWEST","AWEST","LIMAX","LIMES","LIMBU","LIMBO","EMBOX","SEMBLE","EMBOLE","WAMBLE ","FAMBLE"]"WEST","TWAE","LIMB","WASE","WAST","BLEO","STUB","BOIL","BOLE","LIME","SAWT","LIMA","MESA ","MEWL","AXLE","FAME","ASEM","MILE","AMIL","SEAX","SEAM","SEMI","SWAM","AMBO","AMLI", "AXILE","AMBLE","SWAMI","AWEST","AWEST","LIMAX","LIMES","LIMBU","LIMBO","EMBOX","SEMBLE","EMBOLE","WAMBLE ","FAMBLE"]SAWT","LIMA","MESA","MEWL","AXLE","FAME","ASEM","MILE","AMIL","SEAX","SEAM","SEMI","SWAM" ,"AMBO","AMLI","AXILE","AMBLE","SWAMI","AWEST","AWEST","LIMAX","LIMES","LIMBU","LIMBO","EMBOX"," SEMBLE","EMBOLE","WAMBLE","FAMBLE"]SAWT","LIMA","MESA","MEWL","AXLE","FAME","ASEM","MILE","AMIL","SEAX","SEAM","SEMI","SWAM" ,"AMBO","AMLI","AXILE","AMBLE","SWAMI","AWEST","AWEST","LIMAX","LIMES","LIMBU","LIMBO","EMBOX"," SEMBLE","EMBOLE","WAMBLE","FAMBLE"]LIMAX","LIMES","LIMBU","LIMBO","EMBOX","SEMBLE","EMBOLE","WAMBLE","FAMBLE"]LIMAX","LIMES","LIMBU","LIMBO","EMBOX","SEMBLE","EMBOLE","WAMBLE","FAMBLE"]

代码：

```
var fs = require('fs')

var Node = function(value, row, col) {
    this.value = value
    this.row = row
    this.col = col
}

var Path = function() {
    this.nodes = []
}

Path.prototype.push = function(node) {
    this.nodes.push(node)
    return this
}

Path.prototype.contains = function(node) {
    for (var i = 0, ii = this.nodes.length; i < ii; i++) {
        if (this.nodes[i] === node) {
            return true
        }
    }

    return false
}

Path.prototype.clone = function() {
    var path = new Path()
    path.nodes = this.nodes.slice(0)
    return path
}

Path.prototype.to_word = function() {
    var word = ''

    for (var i = 0, ii = this.nodes.length; i < ii; ++i) {
        word += this.nodes[i].value
    }

    return word
}

var Board = function(nodes, dict) {
    // Expects n x m array.
    this.nodes = nodes
    this.words = []
    this.row_count = nodes.length
    this.col_count = nodes[0].length
    this.dict = dict
}

Board.from_raw = function(board, dict) {
    var ROW_COUNT = board.length
      , COL_COUNT = board[0].length

    var nodes = []

    // Replace board with Nodes
    for (var i = 0, ii = ROW_COUNT; i < ii; ++i) {
        nodes.push([])
        for (var j = 0, jj = COL_COUNT; j < jj; ++j) {
            nodes[i].push(new Node(board[i][j], i, j))
        }
    }

    return new Board(nodes, dict)
}

Board.prototype.toString = function() {
    return JSON.stringify(this.nodes)
}

Board.prototype.update_potential_words = function(dict) {
    for (var i = 0, ii = this.row_count; i < ii; ++i) {
        for (var j = 0, jj = this.col_count; j < jj; ++j) {
            var node = this.nodes[i][j]
              , path = new Path()

            path.push(node)

            this.dfs_search(path)
        }
    }
}

Board.prototype.on_board = function(row, col) {
    return 0 <= row && row < this.row_count && 0 <= col && col < this.col_count
}

Board.prototype.get_unsearched_neighbours = function(path) {
    var last_node = path.nodes[path.nodes.length - 1]

    var offsets = [
        [-1, -1], [-1,  0], [-1, +1]
      , [ 0, -1],           [ 0, +1]
      , [+1, -1], [+1,  0], [+1, +1]
    ]

    var neighbours = []

    for (var i = 0, ii = offsets.length; i < ii; ++i) {
        var offset = offsets[i]
        if (this.on_board(last_node.row + offset[0], last_node.col + offset[1])) {

            var potential_node = this.nodes[last_node.row + offset[0]][last_node.col + offset[1]]
            if (!path.contains(potential_node)) {
                // Create a new path if on board and we haven't visited this node yet.
                neighbours.push(potential_node)
            }
        }
    }

    return neighbours
}

Board.prototype.dfs_search = function(path) {
    var path_word = path.to_word()

    if (this.dict.contains_exact(path_word) && path_word.length >= 3) {
        this.words.push(path_word)
    }

    var neighbours = this.get_unsearched_neighbours(path)

    for (var i = 0, ii = neighbours.length; i < ii; ++i) {
        var neighbour = neighbours[i]
        var new_path = path.clone()
        new_path.push(neighbour)

        if (this.dict.contains_prefix(new_path.to_word())) {
            this.dfs_search(new_path)
        }
    }
}

var Dict = function() {
    this.dict_array = []

    var dict_data = fs.readFileSync('./web2', 'utf8')
    var dict_array = dict_data.split('\n')

    for (var i = 0, ii = dict_array.length; i < ii; ++i) {
        dict_array[i] = dict_array[i].toUpperCase()
    }

    this.dict_array = dict_array.sort()
}

Dict.prototype.contains_prefix = function(prefix) {
    // Binary search
    return this.search_prefix(prefix, 0, this.dict_array.length)
}

Dict.prototype.contains_exact = function(exact) {
    // Binary search
    return this.search_exact(exact, 0, this.dict_array.length)
}

Dict.prototype.search_prefix = function(prefix, start, end) {
    if (start >= end) {
        // If no more place to search, return no matter what.
        return this.dict_array[start].indexOf(prefix) > -1
    }

    var middle = Math.floor((start + end)/2)

    if (this.dict_array[middle].indexOf(prefix) > -1) {
        // If we prefix exists, return true.
        return true
    } else {
        // Recurse
        if (prefix <= this.dict_array[middle]) {
            return this.search_prefix(prefix, start, middle - 1)
        } else {
            return this.search_prefix(prefix, middle + 1, end)
        }
    }
}

Dict.prototype.search_exact = function(exact, start, end) {
    if (start >= end) {
        // If no more place to search, return no matter what.
        return this.dict_array[start] === exact
    }

    var middle = Math.floor((start + end)/2)

    if (this.dict_array[middle] === exact) {
        // If we prefix exists, return true.
        return true
    } else {
        // Recurse
        if (exact <= this.dict_array[middle]) {
            return this.search_exact(exact, start, middle - 1)
        } else {
            return this.search_exact(exact, middle + 1, end)
        }
    }
}

var board = [
    ['F', 'X', 'I', 'E']
  , ['A', 'M', 'L', 'O']
  , ['E', 'W', 'B', 'X']
  , ['A', 'S', 'T', 'U']
]

var dict = new Dict()

var b = Board.from_raw(board, dict)
b.update_potential_words()
console.log(JSON.stringify(b.words.sort(function(a, b) {
    return a.length - b.length
}))) 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2015-08-20T00:11:07.957

所以我想添加另一种 PHP 方法来解决这个问题，因为每个人都喜欢 PHP。我想做一些重构，比如对字典文件使用正则表达式匹配，但现在我只是将整个字典文件加载到 wordList 中。

我使用链表的想法做到了这一点。每个节点都有一个字符值、一个位置值和一个下一个指针。

位置值是我发现两个节点是否连接的方式。

```
1     2     3     4
11    12    13    14
21    22    23    24
31    32    33    34 
```

因此，使用该网格，我知道如果第一个节点的位置等于同一行的第二个节点位置 +/- 1，上下行的 +/- 9、10、11，则两个节点已连接。

我使用递归进行主要搜索。它从 wordList 中取出一个单词，找到所有可能的起点，然后递归地找到下一个可能的连接，记住它不能到达它已经使用的位置（这就是我添加 $notInLoc 的原因）。

无论如何，我知道它需要一些重构，并且很想听听有关如何使其更清洁的想法，但它会根据我正在使用的字典文件产生正确的结果。根据板上元音和组合的数量，大约需要 3 到 6 秒。我知道一旦我 preg_match 字典结果，那将大大减少。

```
<?php
    ini_set('xdebug.var_display_max_depth', 20);
    ini_set('xdebug.var_display_max_children', 1024);
    ini_set('xdebug.var_display_max_data', 1024);

    class Node {
        var $loc;

        function __construct($value) {
            $this->value = $value;
            $next = null;
        }
    }

    class Boggle {
        var $root;
        var $locList = array (1, 2, 3, 4, 11, 12, 13, 14, 21, 22, 23, 24, 31, 32, 33, 34);
        var $wordList = [];
        var $foundWords = [];

        function __construct($board) {
            // Takes in a board string and creates all the nodes
            $node = new Node($board[0]);
            $node->loc = $this->locList[0];
            $this->root = $node;
            for ($i = 1; $i < strlen($board); $i++) {
                    $node->next = new Node($board[$i]);
                    $node->next->loc = $this->locList[$i];
                    $node = $node->next;
            }
            // Load in a dictionary file
            // Use regexp to elimate all the words that could never appear and load the 
            // rest of the words into wordList
            $handle = fopen("dict.txt", "r");
            if ($handle) {
                while (($line = fgets($handle)) !== false) {
                    // process the line read.
                    $line = trim($line);
                    if (strlen($line) > 2) {
                        $this->wordList[] = trim($line);
                    }
                }
                fclose($handle);
            } else {
                // error opening the file.
                echo "Problem with the file.";
            } 
        }

        function isConnected($node1, $node2) {
        // Determines if 2 nodes are connected on the boggle board

            return (($node1->loc == $node2->loc + 1) || ($node1->loc == $node2->loc - 1) ||
               ($node1->loc == $node2->loc - 9) || ($node1->loc == $node2->loc - 10) || ($node1->loc == $node2->loc - 11) ||
               ($node1->loc == $node2->loc + 9) || ($node1->loc == $node2->loc + 10) || ($node1->loc == $node2->loc + 11)) ? true : false;

        }

        function find($value, $notInLoc = []) {
            // Returns a node with the value that isn't in a location
            $current = $this->root;
            while($current) {
                if ($current->value == $value && !in_array($current->loc, $notInLoc)) {
                    return $current;
                }
                if (isset($current->next)) {
                    $current = $current->next;
                } else {
                    break;
                }
            }
            return false;
        }

        function findAll($value) {
            // Returns an array of nodes with a specific value
            $current = $this->root;
            $foundNodes = [];
            while ($current) {
                if ($current->value == $value) {
                    $foundNodes[] = $current;
                }
                if (isset($current->next)) {
                    $current = $current->next;
                } else {
                    break;
                }
            }
            return (empty($foundNodes)) ? false : $foundNodes;
        }

        function findAllConnectedTo($node, $value, $notInLoc = []) {
            // Returns an array of nodes that are connected to a specific node and 
            // contain a specific value and are not in a certain location
            $nodeList = $this->findAll($value);
            $newList = [];
            if ($nodeList) {
                foreach ($nodeList as $node2) {
                    if (!in_array($node2->loc, $notInLoc) && $this->isConnected($node, $node2)) {
                        $newList[] = $node2;
                    }
                }
            }
            return (empty($newList)) ? false : $newList;
        }

        function inner($word, $list, $i = 0, $notInLoc = []) {
            $i++;
            foreach($list as $node) {
                $notInLoc[] = $node->loc;
                if ($list2 = $this->findAllConnectedTo($node, $word[$i], $notInLoc)) {
                    if ($i == (strlen($word) - 1)) {
                        return true;
                    } else {
                        return $this->inner($word, $list2, $i, $notInLoc);
                    }
                }
            }
            return false;
        }

        function findWord($word) {
            if ($list = $this->findAll($word[0])) {
                return $this->inner($word, $list);
            }
            return false;
        }

        function findAllWords() {
            foreach($this->wordList as $word) {
                if ($this->findWord($word)) {
                    $this->foundWords[] = $word;
                }
            }
        }

        function displayBoard() {
            $current = $this->root;
            for ($i=0; $i < 4; $i++) {
                echo $current->value . " " . $current->next->value . " " . $current->next->next->value . " " . $current->next->next->next->value . "<br />";
                if ($i < 3) {
                    $current = $current->next->next->next->next;
                }
            }
        }

    }

    function randomBoardString() {
        return substr(str_shuffle(str_repeat("abcdefghijklmnopqrstuvwxyz", 16)), 0, 16);
    }

    $myBoggle = new Boggle(randomBoardString());
    $myBoggle->displayBoard();
    $x = microtime(true);
    $myBoggle->findAllWords();
    $y = microtime(true);
    echo ($y-$x);
    var_dump($myBoggle->foundWords);

    ?> 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2016-05-03T17:48:27.117

我知道我在聚会上真的迟到了，但作为编码练习，我已经实现了几种编程语言（C++、Java、Go、C#、Python、Ruby、JavaScript、Julia、Lua、PHP、Perl）和我认为有人可能对这些感兴趣，所以我在这里留下链接： [https ://github.com/AmokHuginnsson/boggle-solvers](https://github.com/AmokHuginnsson/boggle-solvers)

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2018-06-19T12:21:41.077

这是在 NLTK 工具包中使用预定义单词的解决方案 NLTK 有 nltk.corpus 包，其中我们有一个名为 words 的包，它包含超过 20 万个英语单词，您可以简单地将所有单词全部用于您的程序中。

创建矩阵后，将其转换为字符数组并执行此代码

```
import nltk
from nltk.corpus import words
from collections import Counter

def possibleWords(input, charSet):
    for word in input:
        dict = Counter(word)
        flag = 1
        for key in dict.keys():
            if key not in charSet:
                flag = 0
        if flag == 1 and len(word)>5: #its depends if you want only length more than 5 use this otherwise remove that one. 
            print(word)

nltk.download('words')
word_list = words.words()
# prints 236736
print(len(word_list))
charSet = ['h', 'e', 'l', 'o', 'n', 'v', 't']
possibleWords(word_list, charSet) 
```

输出：

```
eleven
eleventh
elevon
entente
entone
ethene
ethenol
evolve
evolvent
hellhole
helvell
hooven
letten
looten
nettle
nonene
nonent
nonlevel
notelet
novelet
novelette
novene
teenet
teethe
teevee
telethon
tellee
tenent
tentlet
theelol
toetoe
tonlet
toothlet
tootle
tottle
vellon
velvet
velveteen
venene
vennel
venthole
voeten
volent
volvelle
volvent
voteen 
```

我希望你能明白。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2012-07-28T06:34:07.797

这是我的java实现：[https ://github.com/zouzhile/interview/blob/master/src/com/interview/algorithms/tree/BoggleSolver.java](https://github.com/zouzhile/interview/blob/master/src/com/interview/algorithms/tree/BoggleSolver.java)

Trie 构建耗时 0 小时 0 分钟 1 秒 532 毫秒
单词搜索耗时 0 小时 0 分钟 0 秒 92 毫秒

```
eel eeler eely eer eke eker eld eleut elk ell 
elle epee epihippus ere erept err error erupt eurus eye 
eyer eyey hip hipe hiper hippish hipple hippus his hish 
hiss hist hler hsi ihi iphis isis issue issuer ist 
isurus kee keek keeker keel keeler keep keeper keld kele 
kelek kelep kelk kell kelly kelp kelper kep kepi kept 
ker kerel kern keup keuper key kyl kyle lee leek 
leeky leep leer lek leo leper leptus lepus ler leu 
ley lleu lue lull luller lulu lunn lunt lunule luo 
lupe lupis lupulus lupus lur lure lurer lush lushly lust 
lustrous lut lye nul null nun nupe nurture nurturer nut 
oer ore ort ouphish our oust out outpeep outpeer outpipe 
outpull outpush output outre outrun outrush outspell outspue outspurn outspurt 
outstrut outstunt outsulk outturn outusure oyer pee peek peel peele 
peeler peeoy peep peeper peepeye peer pele peleus pell peller 
pelu pep peplus pepper pepperer pepsis per pern pert pertussis 
peru perule perun peul phi pip pipe piper pipi pipistrel 
pipistrelle pipistrellus pipper pish piss pist plup plus plush ply 
plyer psi pst puerer pul pule puler pulk pull puller 
pulley pullus pulp pulper pulu puly pun punt pup puppis 
pur pure puree purely purer purr purre purree purrel purrer 
puru purupuru pus push puss pustule put putt puture ree 
reek reeker reeky reel reeler reeper rel rely reoutput rep 
repel repeller repipe reply repp reps reree rereel rerun reuel 
roe roer roey roue rouelle roun roup rouper roust rout 
roy rue ruelle ruer rule ruler rull ruller run runt 
rupee rupert rupture ruru rus rush russ rust rustre rut 
shi shih ship shipper shish shlu sip sipe siper sipper 
sis sish sisi siss sissu sist sistrurus speel speer spelk 
spell speller splurt spun spur spurn spurrer spurt sput ssi 
ssu stre stree streek streel streeler streep streke streperous strepsis 
strey stroup stroy stroyer strue strunt strut stu stue stull 
stuller stun stunt stupe stupeous stupp sturnus sturt stuss stut 
sue suer suerre suld sulk sulker sulky sull sully sulu 
sun sunn sunt sunup sup supe super superoutput supper supple 
supplely supply sur sure surely surrey sus susi susu susurr 
susurrous susurrus sutu suture suu tree treey trek trekker trey 
troupe trouper trout troy true truer trull truller truly trun 
trush truss trust tshi tst tsun tsutsutsi tue tule tulle 
tulu tun tunu tup tupek tupi tur turn turnup turr 
turus tush tussis tussur tut tuts tutu tutulus ule ull 
uller ulu ululu unreel unrule unruly unrun unrust untrue untruly 
untruss untrust unturn unurn upper upperer uppish uppishly uppull uppush 
upspurt upsun upsup uptree uptruss upturn ure urn uro uru 
urus urushi ush ust usun usure usurer utu yee yeel 
yeld yelk yell yeller yelp yelper yeo yep yer yere 
yern yoe yor yore you youl youp your yourn yoy 
```

**注意：** 我在这个线程的开头使用了字典和字符矩阵。该代码是在我的 MacBookPro 上运行的，下面是有关该机器的一些信息。

型号名称：MacBook Pro
型号标识符：MacBookPro8,1
处理器名称：英特尔酷睿 i5
处理器速度：2.3 GHz
处理器数量：1
内核总数：2
L2 缓存（每个内核）：256 KB
L3 缓存：3 MB
内存：4 GB
Boot ROM 版本：MBP81.0047.B0E
SMC 版本（系统）：1.68f96

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2012-11-19T13:36:29.557

我也用Java解决了这个问题。我的实现有 269 行长，而且很容易使用。首先，您需要创建 Boggler 类的新实例，然后使用网格作为参数调用求解函数。在我的计算机上加载包含 50 000 个单词的词典大约需要 100 毫秒，它在大约 10-20 毫秒内找到单词。找到的单词存储在 ArrayList 中`foundWords`。

```
import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.URISyntaxException;
import java.net.URL;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Comparator;

public class Boggler {
    private ArrayList<String> words = new ArrayList<String>();      
    private ArrayList<String> roundWords = new ArrayList<String>(); 
    private ArrayList<Word> foundWords = new ArrayList<Word>();     
    private char[][] letterGrid = new char[4][4];                   
    private String letters;                                         

    public Boggler() throws FileNotFoundException, IOException, URISyntaxException {
        long startTime = System.currentTimeMillis();

        URL path = GUI.class.getResource("words.txt");
        BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(new File(path.toURI()).getAbsolutePath()), "iso-8859-1"));
        String line;
        while((line = br.readLine()) != null) {
            if(line.length() < 3 || line.length() > 10) {
                continue;
            }

            this.words.add(line);
        }
    }

    public ArrayList<Word> getWords() {
        return this.foundWords;
    }

    public void solve(String letters) {
        this.letters = "";
        this.foundWords = new ArrayList<Word>();

        for(int i = 0; i < letters.length(); i++) {
            if(!this.letters.contains(letters.substring(i, i + 1))) {
                this.letters += letters.substring(i, i + 1);
            }
        }

        for(int i = 0; i < 4; i++) {
            for(int j = 0; j < 4; j++) {
                this.letterGrid[i][j] = letters.charAt(i * 4 + j);
            }
        }

        System.out.println(Arrays.deepToString(this.letterGrid));               

        this.roundWords = new ArrayList<String>();      
        String pattern = "[" + this.letters + "]+";     

        for(int i = 0; i < this.words.size(); i++) {

            if(this.words.get(i).matches(pattern)) {
                this.roundWords.add(this.words.get(i));
            }
        }

        for(int i = 0; i < this.roundWords.size(); i++) {
            Word word = checkForWord(this.roundWords.get(i));

            if(word != null) {
                System.out.println(word);
                this.foundWords.add(word);
            }
        }       
    }

    private Word checkForWord(String word) {
        char initial = word.charAt(0);
        ArrayList<LetterCoord> startPoints = new ArrayList<LetterCoord>();

        int x = 0;  
        int y = 0;
        for(char[] row: this.letterGrid) {
            x = 0;

            for(char letter: row) {
                if(initial == letter) {
                    startPoints.add(new LetterCoord(x, y));
                }

                x++;
            }

            y++;
        }

        ArrayList<LetterCoord> letterCoords = null;
        for(int initialTry = 0; initialTry < startPoints.size(); initialTry++) {
            letterCoords = new ArrayList<LetterCoord>();    

            x = startPoints.get(initialTry).getX(); 
            y = startPoints.get(initialTry).getY();

            LetterCoord initialCoord = new LetterCoord(x, y);
            letterCoords.add(initialCoord);

            letterLoop: for(int letterIndex = 1; letterIndex < word.length(); letterIndex++) {
                LetterCoord lastCoord = letterCoords.get(letterCoords.size() - 1);  
                char currentChar = word.charAt(letterIndex);                        

                ArrayList<LetterCoord> letterLocations = getNeighbours(currentChar, lastCoord.getX(), lastCoord.getY());

                if(letterLocations == null) {
                    return null;    
                }       

                for(int foundIndex = 0; foundIndex < letterLocations.size(); foundIndex++) {
                    if(letterIndex != word.length() - 1 && true == false) {
                        char nextChar = word.charAt(letterIndex + 1);
                        int lastX = letterCoords.get(letterCoords.size() - 1).getX();
                        int lastY = letterCoords.get(letterCoords.size() - 1).getY();

                        ArrayList<LetterCoord> possibleIndex = getNeighbours(nextChar, lastX, lastY);
                        if(possibleIndex != null) {
                            if(!letterCoords.contains(letterLocations.get(foundIndex))) {
                                letterCoords.add(letterLocations.get(foundIndex));
                            }
                            continue letterLoop;
                        } else {
                            return null;
                        }
                    } else {
                        if(!letterCoords.contains(letterLocations.get(foundIndex))) {
                            letterCoords.add(letterLocations.get(foundIndex));

                            continue letterLoop;
                        }
                    }
                }
            }

            if(letterCoords != null) {
                if(letterCoords.size() == word.length()) {
                    Word w = new Word(word);
                    w.addList(letterCoords);
                    return w;
                } else {
                    return null;
                }
            }
        }

        if(letterCoords != null) {
            Word foundWord = new Word(word);
            foundWord.addList(letterCoords);

            return foundWord;
        }

        return null;
    }

    public ArrayList<LetterCoord> getNeighbours(char letterToSearch, int x, int y) {
        ArrayList<LetterCoord> neighbours = new ArrayList<LetterCoord>();

        for(int _y = y - 1; _y <= y + 1; _y++) {
            for(int _x = x - 1; _x <= x + 1; _x++) {
                if(_x < 0 || _y < 0 || (_x == x && _y == y) || _y > 3 || _x > 3) {
                    continue;
                }

                if(this.letterGrid[_y][_x] == letterToSearch && !neighbours.contains(new LetterCoord(_x, _y))) {
                    neighbours.add(new LetterCoord(_x, _y));
                }
            }
        }

        if(neighbours.isEmpty()) {
            return null;
        } else {
            return neighbours;
        }
    }
}

class Word {
    private String word;    
    private ArrayList<LetterCoord> letterCoords = new ArrayList<LetterCoord>();

    public Word(String word) {
        this.word = word;
    }

    public boolean addCoords(int x, int y) {
        LetterCoord lc = new LetterCoord(x, y);

        if(!this.letterCoords.contains(lc)) {
            this.letterCoords.add(lc);

            return true;
        }

        return false;
    }

    public void addList(ArrayList<LetterCoord> letterCoords) {
        this.letterCoords = letterCoords;
    } 

    @Override
    public String toString() {
        String outputString = this.word + " ";
        for(int i = 0; i < letterCoords.size(); i++) {
            outputString += "(" + letterCoords.get(i).getX() + ", " + letterCoords.get(i).getY() + ") ";
        }

        return outputString;
    }

    public String getWord() {
        return this.word;
    }

    public ArrayList<LetterCoord> getList() {
        return this.letterCoords;
    }
}

class LetterCoord extends ArrayList {
    private int x;          
    private int y;          

    public LetterCoord(int x, int y) {
        this.x = x;
        this.y = y;
    }

    public int getX() {
        return this.x;
    }

    public int getY() {
        return this.y;
    }

    @Override
    public boolean equals(Object o) {
        if(!(o instanceof LetterCoord)) {
            return false;
        }

        LetterCoord lc = (LetterCoord) o;

        if(this.x == lc.getX() &&
                this.y == lc.getY()) {
            return true;
        }

        return false;
    }

    @Override
    public int hashCode() {
        int hash = 7;
        hash = 29 * hash + this.x;
        hash = 24 * hash + this.y;
        return hash;
    }
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2012-12-10T22:56:06.300

我在c中解决了这个问题。在我的机器上运行大约需要 48 毫秒（大约 98% 的时间用于从磁盘加载字典和创建 trie）。字典是 /usr/share/dict/american-english，有 62886 个单词。

[源代码](https://github.com/ealter/Boggle-Solver)

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2013-03-08T03:17:34.593

我完美且非常快速地解决了这个问题。我把它放到一个安卓应用程序中。在 Play 商店链接中查看视频以查看它的实际效果。

Word Cheats 是一款可以“破解”任何矩阵式文字游戏的应用程序。这个应用程序旨在帮助我在单词扰频器上作弊。它可用于单词搜索、ruzzle、单词、单词查找器、单词破解、boggle 等等！

可以在这里看到 [https://play.google.com/store/apps/details?id=com.harris.wordcracker](https://play.google.com/store/apps/details?id=com.harris.wordcracker)

在视频中查看运行中的应用程序 [https://www.youtube.com/watch?v=DL2974WmNAI](https://www.youtube.com/watch?v=DL2974WmNAI)

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2013-09-23T07:49:19.377

我已经使用 DFA 算法在 C# 中解决了这个问题。您可以在以下位置查看我的代码

[https://github.com/attilabicsko/wordshuffler/](https://github.com/attilabicsko/wordshuffler/)

除了在矩阵中查找单词之外，我的算法还保存了单词的实际路径，因此在设计单词查找器游戏时，您可以检查实际路径上是否有单词。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2014-01-06T19:30:23.473

简单的排序和使用字典中的**二进制搜索怎么样？**

**在0.35 秒**内返回整个列表并且可以进一步优化（例如通过删除未使用字母的单词等）。

```
from bisect import bisect_left

f = open("dict.txt")
D.extend([line.strip() for line in f.readlines()])
D = sorted(D)

def neibs(M,x,y):
    n = len(M)
    for i in xrange(-1,2):
        for j in xrange(-1,2):
            if (i == 0 and j == 0) or (x + i < 0 or x + i >= n or y + j < 0 or y + j >= n):
                continue
            yield (x + i, y + j)

def findWords(M,D,x,y,prefix):
    prefix = prefix + M[x][y]

    # find word in dict by binary search
    found = bisect_left(D,prefix)

    # if found then yield
    if D[found] == prefix: 
        yield prefix

    # if what we found is not even a prefix then return
    # (there is no point in going further)
    if len(D[found]) < len(prefix) or D[found][:len(prefix)] != prefix:
        return

    # recourse
    for neib in neibs(M,x,y):
        for word in findWords(M,D,neib[0], neib[1], prefix):
            yield word

def solve(M,D):
    # check each starting point
    for x in xrange(0,len(M)):
        for y in xrange(0,len(M)):
            for word in findWords(M,D,x,y,""):
                yield word

grid = "fxie amlo ewbx astu".split()
print [x for x in solve(grid,D)] 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2014-12-01T05:46:14.900

```
 package ProblemSolving;

import java.util.HashSet;
import java.util.Set;

/**
 * Given a 2-dimensional array of characters and a
 * dictionary in which a word can be searched in O(1) time.
 * Need to print all the words from array which are present
 * in dictionary. Word can be formed in any direction but
 * has to end at any edge of array.
 * (Need not worry much about the dictionary)
 */
public class DictionaryWord {
    private static char[][] matrix = new char[][]{
            {'a', 'f', 'h', 'u', 'n'},
            {'e', 't', 'a', 'i', 'r'},
            {'a', 'e', 'g', 'g', 'o'},
            {'t', 'r', 'm', 'l', 'p'}
    };
    private static int dim_x = matrix.length;
    private static int dim_y = matrix[matrix.length -1].length;
    private static Set<String> wordSet = new HashSet<String>();

    public static void main(String[] args) {
        //dictionary
        wordSet.add("after");
        wordSet.add("hate");
        wordSet.add("hair");
        wordSet.add("air");
        wordSet.add("eat");
        wordSet.add("tea");

        for (int x = 0; x < dim_x; x++) {
            for (int y = 0; y < dim_y; y++) {
                checkAndPrint(matrix[x][y] + "");
                int[][] visitedMap = new int[dim_x][dim_y];
                visitedMap[x][y] = 1;
                recursion(matrix[x][y] + "", visitedMap, x, y);
            }
        }
    }

    private static void checkAndPrint(String word) {
        if (wordSet.contains(word)) {
            System.out.println(word);
        }
    }

    private static void recursion(String word, int[][] visitedMap, int x, int y) {
        for (int i = Math.max(x - 1, 0); i < Math.min(x + 2, dim_x); i++) {
            for (int j = Math.max(y - 1, 0); j < Math.min(y + 2, dim_y); j++) {
                if (visitedMap[i][j] == 1) {
                    continue;
                } else {
                    int[][] newVisitedMap = new int[dim_x][dim_y];
                    for (int p = 0; p < dim_x; p++) {
                        for (int q = 0; q < dim_y; q++) {
                           newVisitedMap[p][q] = visitedMap[p][q];
                        }
                    }
                    newVisitedMap[i][j] = 1;
                    checkAndPrint(word + matrix[i][j]);
                    recursion(word + matrix[i][j], newVisitedMap, i, j);
                }
            }
        }
    }

} 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2017-01-02T21:02:50.177

```
import java.util.HashSet;
import java.util.Set;

/**
 * @author Sujeet Kumar (mrsujeet@gmail.com) It prints out all strings that can
 *         be formed by moving left, right, up, down, or diagonally and exist in
 *         a given dictionary , without repeating any cell. Assumes words are
 *         comprised of lower case letters. Currently prints words as many times
 *         as they appear, not just once. *
 */

public class BoggleGame 
{
  /* A sample 4X4 board/2D matrix */
  private static char[][] board = { { 's', 'a', 's', 'g' },
                                  { 'a', 'u', 't', 'h' }, 
                                  { 'r', 't', 'j', 'e' },
                                  { 'k', 'a', 'h', 'e' }
};

/* A sample dictionary which contains unique collection of words */
private static Set<String> dictionary = new HashSet<String>();

private static boolean[][] visited = new boolean[board.length][board[0].length];

public static void main(String[] arg) {
    dictionary.add("sujeet");
    dictionary.add("sarthak");
    findWords();

}

// show all words, starting from each possible starting place
private static void findWords() {
    for (int i = 0; i < board.length; i++) {
        for (int j = 0; j < board[i].length; j++) {
            StringBuffer buffer = new StringBuffer();
            dfs(i, j, buffer);
        }

    }

}

// run depth first search starting at cell (i, j)
private static void dfs(int i, int j, StringBuffer buffer) {
    /*
     * base case: just return in recursive call when index goes out of the
     * size of matrix dimension
     */
    if (i < 0 || j < 0 || i > board.length - 1 || j > board[i].length - 1) {
        return;
    }

    /*
     * base case: to return in recursive call when given cell is already
     * visited in a given string of word
     */
    if (visited[i][j] == true) { // can't visit a cell more than once
        return;
    }

    // not to allow a cell to reuse
    visited[i][j] = true;

    // combining cell character with other visited cells characters to form
    // word a potential word which may exist in dictionary
    buffer.append(board[i][j]);

    // found a word in dictionary. Print it.
    if (dictionary.contains(buffer.toString())) {
        System.out.println(buffer);
    }

    /*
     * consider all neighbors.For a given cell considering all adjacent
     * cells in horizontal, vertical and diagonal direction
     */
    for (int k = i - 1; k <= i + 1; k++) {
        for (int l = j - 1; l <= j + 1; l++) {
            dfs(k, l, buffer);

        }

    }
    buffer.deleteCharAt(buffer.length() - 1);
    visited[i][j] = false;
  }
} 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2017-06-22T11:16:47.650

这是我为解决难题而提出的解决方案。我想这是最“pythonic”的做事方式：

```
from itertools import combinations
from itertools import izip
from math import fabs

def isAllowedStep(current,step,length,doubleLength):
            # for step == length -1 not to be 0 => trivial solutions are not allowed
    return length > 1 and \
           current + step < doubleLength and current - step > 0 and \
           ( step == 1 or step == -1 or step <= length+1 or step >= length - 1)

def getPairwiseList(someList):
    iterableList = iter(someList)
    return izip(iterableList, iterableList)

def isCombinationAllowed(combination,length,doubleLength):

    for (first,second) in  getPairwiseList(combination):
        _, firstCoordinate = first
        _, secondCoordinate = second
        if not isAllowedStep(firstCoordinate, fabs(secondCoordinate-firstCoordinate),length,doubleLength):
            return False
    return True

def extractSolution(combinations):
    return ["".join([x[0] for x in combinationTuple]) for combinationTuple in combinations]

length = 4
text = tuple("".join("fxie amlo ewbx astu".split()))
textIndices = tuple(range(len(text)))
coordinates = zip(text,textIndices)

validCombinations = [combination for combination in combinations(coordinates,length) if isCombinationAllowed(combination,length,length*length)]
solution = extractSolution(validCombinations) 
```

**这部分我建议您不要使用所有可能的匹配项**，但它实际上可以检查您生成的单词是否实际上构成有效单词：

```
import mechanize
def checkWord(word):
    url = "https://en.oxforddictionaries.com/search?filter=dictionary&query="+word
    br = mechanize.Browser()
    br.set_handle_robots(False)
    response = br.open(url)
    text = response.read()
    return "no exact matches"  not in text.lower()

print [valid for valid in solution[:10] if checkWord(valid)] 
```

# javascript - 在 Javascript 中使用延迟执行

> ID：746083
> 
> 赞同：3
> 
> 时间：2009-04-14T02:11:58.940
> 
> 标签：javascript

有没有人使用延迟执行 JavaScript 或者它是过去的东西？（我没有看到它在主要网站上使用）。此外，将您的 javascript 放在 head 标签中与将其放在 body 中的优缺点是什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T02:15:34.280

将 JavaScript 放在 head 标签中会减慢页面的加载时间，因为在渲染 DOM 之前必须解析、处理和执行 JS（如果它们是外部文件，还可能下载）。即使使用“defer”也不能真正避免这种情况——一些浏览器会忽略该指令，而那些确实注意的浏览器并没有像你期望的那样完全实现它。

将 JS 放在页面底部是一个很好的方法，可以通过明显的页面加载时间获得一些快速的胜利，并且还可以通过使不正确的编码更难一些来鼓励适当的 SoC 和渐进式增强。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T02:16:54.513

[http://www.websiteoptimization.com/speed/tweak/defer/](http://www.websiteoptimization.com/speed/tweak/defer/)

对于所有想了解更多关于延期执行的人。

似乎这是 HTML 4 的一个特性，所以不一定是过去的，但是由于 onload 事件几乎完成了 deferred 选项的要求，我不确定它是否有巨大的需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T02:13:42.163

最大的缺点是它在浏览器之间的实现方式截然不同。基本上，你真的不能像预期的那样使用它。

# java - Java 通用列表 >

> ID：746089
> 
> 赞同：39
> 
> 时间：2009-04-14T02:15:04.890
> 
> 标签：java, generics

为什么我们不能在java中做：

```
List<List<? extends Number>> aList = new ArrayList<List<Number>>(); 
```

即使这没关系：

```
List<? extends Number> aList = new ArrayList<Number>(); 
```

编译器错误信息是：

> `Type mismatch: cannot convert from ArrayList<List<Number>> to List<List<? extends Number>>`

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-04-14T03:56:03.337

在 Java 中，如果`Car`是 的派生类`Vehicle`，那么我们可以将所有`Cars`视为`Vehicles`; 一个`Car`是一个`Vehicle`。**然而， a `List`of`Cars`不也是 a `List`of `Vehicles`。我们说它与`List<Car>`不*协*变`List<Vehicle>`。**

Java 要求您明确告诉它何时要对通配符使用协变和逆变，由`?`标记表示。看看你的问题发生在哪里：

```
List<List<? extends Number>> l = new ArrayList<List<Number>>();
//        ----------------                          ------
// 
// "? extends Number" matched by "Number". Success! 
```

内部`List<? extends Number>`工作因为`Number`确实扩展`Number`，所以它匹配“ `? extends Number`”。到目前为止，一切都很好。下一步是什么？

```
List<List<? extends Number>> l = new ArrayList<List<Number>>();
//   ----------------------                    ------------
// 
// "List<? extends Number>" not matched by "List<Number>". These are
//   different types and covariance is not specified with a wildcard.
//   Failure. 
```

但是，组合的内部类型参数`List<? extends Number>`不匹配`List<Number>`; 类型必须*完全相同*。另一个通配符会告诉 Java 这种组合类型也应该是协变的：

```
List<? extends List<? extends Number>> l = new ArrayList<List<Number>>(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T02:38:45.537

我对Java语法不是很熟悉，但您的问题似乎是这样的：

[协方差和逆变](http://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science))

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-14T02:54:56.730

你绝对应该使用 ? 在适当的时候输入通配符，一般情况下不要避免使用它。例如：

```
public void doThingWithList(List<List<? extends Number>> list); 
```

允许您通过 a`List<Integer>`或 a `List<Long>`。

```
public void doThingWithList(List<List<Number>> list); 
```

只允许您传递声明为`List<Number>`. 是的，有一点区别，但是使用通配符是强大且**安全**的。与看起来相反，a`List<Integer>`不是 的子类，也不是可分配的`List<Number>`。也不是`List<Integer>`的子类`List<? extends Number`，这就是上面的代码无法编译的原因。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T02:42:29.957

您的语句无法编译，因为`List<? extends Number>`它的类型与`List<Number>`. 前者是后者的超类型。

你试过这个吗？在这里，我表示 List 在其类型参数中是协变的，因此它将接受`List<? extends Number>`（包括`List<Number>`）的任何子类型。

```
List<? extends List<? extends Number>> aList = new ArrayList<List<Number>>(); 
```

甚至这个。这里右侧 ArrayList 的类型参数与左侧的类型参数相同，因此差异不是问题。

```
List<List<? extends Number>> aList = new ArrayList<List<? extends Number>>(); 
```

你应该可以说

```
List<List<Number>> aList = new ArrayList<List<Number>>(); 
```

我倾向于尽可能避免使用`?`类型通配符。我发现类型注释所产生的费用不值得。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-05-18T14:15:05.997

```
List<List<? extends Number>> aList = new ArrayList<List<? extends Number>>();
aList.add(new ArrayList<Integer>()); 
```

# actionscript-3 - 如何在服务器上生成 Flash swf 的屏幕截图？

> ID：746095
> 
> 赞同：3
> 
> 时间：2009-04-14T02:16:30.737
> 
> 标签：actionscript-3, flash, screenshot

我正在使用开源工具编写一个 Flash 应用程序。我想将数据文件加载到应用程序中并在服务器上捕获舞台的屏幕截图。唯一看起来神秘的部分是在服务器上运行应用程序。事实上，我什至不在乎它是否是在服务器和浏览器中运行的同一个应用程序——如果我可以使用 flash 阶段和绘图例程在服务器端生成图像，我很高兴。如果我必须深入研究弯曲，那很好。现在我根本找不到任何起点。

我收集到 Adob​​e 有一些可能符合要求的商业产品，但我想坚持使用开源、apache 和 linux。我知道使用 haxe/neko 可能会做到这一点，但如果可能的话，我想使用更多主流工具。我要求太多了吗？

编辑/澄清：非常感谢到目前为止的回复，但我认为我的描述有点混乱。我已经使用与建议的相同的 PNGEncoder 类编写了实际的舞台抓取内容。问题实际上是在服务器端运行 swf。我不想让客户端自己截屏，因为这打开了客户端恶意提交与舞台上的内容不对应的截图的可能性，即我不希望用户上传色情. 如果我可以在服务器上运行 actionscript 代码，那么我可以从我的数据文件生成屏幕截图并确保屏幕截图与数据匹配，但我不知道如何在服务器上运行 actionscript 或 swf。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T14:18:00.347

Swfs 在客户端计算机上运行，​​而不是在服务器上。它在服务器上运行的唯一方法是在服务器上设置一个特殊的环境，以便它运行 Web 浏览器、打开页面并运行 swf。但即便如此，它也与外部用户的行为无关。

您需要在客户端运行它。就您的安全问题而言，摆脱这些问题的最佳方法是让编写实际图像的 php 只接受闪存可以加密的图像文件的加密形式。这样他们就不能简单地使用 PHP 文件来上传他们想要的任何图像，除非他们碰巧加密它的方式与您的 swf 完全相同。接下来加密 swf 本身（我推荐 SWF Shield），以便潜在的黑客无法读取代码以了解如何加密图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T17:50:01.407

我们刚刚完成了一个类似的项目，我们从加载动态数据的 SWF 渲染 JPG，我们使用[了 IECapt](http://iecapt.sourceforge.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T12:11:15.503

试试看这个： [http ://www.phpclasses.org/browse/package/4312.html](http://www.phpclasses.org/browse/package/4312.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T02:32:46.220

您是否尝试过 actionscript 打印命令？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-14T23:54:19.260

软件包中的[swfdec-thumbnailer](http://linux.die.net/man/1/swfdec-thumbnailer)怎么样`swfdec-gnome`？它用于创建 SWF 文件的缩略图，但可以通过`-s`参数接受任意大的分辨率。

编辑： swfdec-gnome 在 Ubuntu 10.10 中已被弃用，转而支持 Gnash。[这](http://techblog.floorplanner.com/2010/11/02/server-side-rendering-of-swf-images-using-gnash/)是使用 Gnash 截屏的指南（请注意，渐变等某些功能尚未得到正确支持）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-22T23:05:24.177

我知道这个问题早就死了，但我有一个类似的问题，最后写了一个脚本使用 applescript + ui 脚本来抓取 OS X 中独立 Flash 播放器的预览窗口的内部区域。你可以[在这里](http://gist.github.com/399121)从 github 上抓取它.

# java - Objective-C 主要方法中的数组。签名服务错误。纽布

> ID：746101
> 
> 赞同：2
> 
> 时间：2009-04-14T02:19:02.743
> 
> 标签：java, objective-c, arrays, memory, segmentation-fault

在Objective-C中，我应该如何最好地近似Java中我正在做的事情：

```
static private String[] array {"A", "B", "C"}; 
```

我想我需要的是一个简单的数组，我可以用一些整数索引它。欢迎提供其他建议，但请记住，如果我陷入困境，那么无论如何我都非常绝望。

作为测试，我尝试使用

```
NSArray *array = [[NSArray alloc] initWithObjects:@"A", @"B", @"C"]; 
```

在 main 方法中，但这种类型的数组不止一个，我得到 Sig 11 或 10 错误。即使我只有数组后跟 NSLog 语句，也会发生这种情况。只有一个阵列。

是不是这种类型的数组只是在main方法中行不通？我真的不明白为什么当我添加第二个数组时会导致错误。它们甚至都不大。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-14T02:27:40.523

[initWithObjects](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSArray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSArray/initWithObjects:)的参数需要以 结尾`nil`，如下所示：

```
NSArray *array = [[NSArray alloc] initWithObjects:@"A", @"B", @"C", nil]; 
```

# c# - C# WCF：在提供对服务的访问的共享库中有一个 app.config

> ID：746107
> 
> 赞同：5
> 
> 时间：2009-04-14T02:19:49.560
> 
> 标签：c#, wcf, reference

我目前有几个项目的解决方案，其中一个是 WCF 服务。我创建了另一个带有静态类的投影，该类基本上提供了通往 WCF 客户端实例的网关，如下所示：

```
public static class WSGateway
{
    public static DBInteractionGatewayClient MR_WebService
    {
        get
        {
            return new DBInteractionGatewayClient();
        } 
    }
} 
```

这样（或者我认为）我可以使用`app.config`仅在该库中的单个文件，然后其他项目可以只引用它并从该属性获取对该客户端的引用。

但问题是，当一个项目尝试访问该属性时，会抛出一个异常，告诉我我需要`app.config`在应用程序中访问，并且当我将`app.config`我的网关库复制到应用程序时，它可以工作。

* * *

有没有办法避免`app.config`在应用程序中有多个文件而在一个库中只有一个文件？

* * *

**[更新] 解决方法：**

按照[Anderson Imes](https://stackoverflow.com/questions/746107/c-wcf-having-a-single-app-config-in-a-shared-library-that-provides-access-to-th/746174#746174)的建议，现在我决定在类中对客户端参考配置进行硬编码，从而消除了对多个`app.config`s 的需要。

因此，我从这个 ( `app.config`) 翻译了我的配置：

```
<configuration>
    <system.serviceModel>
        <bindings>
            <wsHttpBinding>
                <binding name="WSHttpBinding_IDBInteractionGateway" closeTimeout="00:01:00"
                    openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
                    bypassProxyOnLocal="false" transactionFlow="false" hostNameComparisonMode="StrongWildcard"
                    maxBufferPoolSize="524288" maxReceivedMessageSize="6000000"
                    messageEncoding="Text" textEncoding="utf-8" useDefaultWebProxy="true"
                    allowCookies="false">
                    <security mode="None"/>
                    <readerQuotas maxDepth="6000000" maxStringContentLength="6000000" maxArrayLength="6000000"
                        maxBytesPerRead="6000000" maxNameTableCharCount="6000000" />
                    <reliableSession ordered="true" inactivityTimeout="00:10:00"
                        enabled="false" />
                </binding>
            </wsHttpBinding>
        </bindings>
        <client>
            <endpoint address="http://agnt666laptop:28666/DBInteractionGateway.svc"
                binding="wsHttpBinding" bindingConfiguration="WSHttpBinding_IDBInteractionGateway"
                contract="DBInteraction_Service.IDBInteractionGateway" name="WSHttpBinding_IDBInteractionGateway">
                <identity>
                    <dns value="localhost" />
                </identity>
            </endpoint>
        </client>
    </system.serviceModel>
</configuration> 
```

对此（一`static class`）：

```
public static class WSGateway
{
    private static WSHttpBinding binding;
    private static EndpointAddress endpointAddress;

    static WSGateway()
    {
        var readerQuotas = new XmlDictionaryReaderQuotas()
        {
            MaxDepth = 6000000,
            MaxStringContentLength = 6000000,
            MaxArrayLength = 6000000,
            MaxBytesPerRead = 6000000,
            MaxNameTableCharCount = 6000000
        };
        binding = new WSHttpBinding(SecurityMode.None) {MaxReceivedMessageSize = 6000000, ReaderQuotas = readerQuotas};

        endpointAddress = new EndpointAddress("http://agnt666laptop:28666/DBInteractionGateway.svc"); 
    }
    public static DBInteractionGatewayClient MR_WebService
    {
        get
        { 
            return new DBInteractionGatewayClient(binding, endpointAddress);
        }
    }
    public static void ExecuteCommand(Action<DBInteractionGatewayClient> command)
    {
        var ws = MR_WebService;
        command.Invoke(ws);
        ws.Close();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T02:50:21.110

您收到该错误的原因是 WCF 客户端代理的默认构造函数从本地配置中查找通道配置。您可以通过指定要使用/连接的绑定和地址来覆盖此行为。

这里有几个选项，每个选项都有不同的部署模型。

1.  硬编码“网关”库中的端点信息（常用术语是“代理”）。您只需返回 new DBInteractionGatewayClient(binding, address); 对于此解决方案，您只需分发您的 WSGateway 代码所在的程序集（以下称为“WSGateway 程序集”。
2.  创建一个所有站点都可以访问的通用配置文件。如果这些都是同一台机器上的服务，这很容易做到。将配置数据放在共享的公共驱动器位置并从那里读取。如果您希望所有可能的 WCF 配置可用，则需要使用 ConfigurationManager.OpenMappedExeConfiguration 方法并手动读取它并将其手动应用于您的绑定，然后再打开客户端通道。为此，您将确保您可以访问位于中心的配置文件并分发您的 WSGateway 程序集。
3.  将您的配置移动到可从所有应用程序访问的公共资源，例如数据库。这将允许您从解决方案中的任何点访问此配置数据。对于此解决方案，您将确保可以从解决方案中的所有点访问您的配置数据库并分发您的 WSGateway 程序集。

这些是我能想到的解决方案。让我们知道您决定做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-04T18:37:18.910

安德烈亚斯的回答以“p”结尾，所以我认为有些东西没有正确复制和粘贴。但它让我走上了正轨，我想出了这个。我从 MS（计算器）的示例 WCF 介绍开始。

这是在客户端应用程序上使用 app.config 的旧方法

```
 CalculatorClient client = new CalculatorClient(); 
```

这是不需要 app.config 的硬编码版本。我仔细检查了绑定部分中 app.config 中的所有值都是默认值，不需要显式复制。但是，您可以将所有这些值直接添加到`binding`.

```
 string address = "http://localhost:8000/ServiceModelSamples/Service/CalculatorService";
        WSHttpBinding binding = new WSHttpBinding();
        binding.Name = "WSHttpBinding_ICalculator"; // not sure if this is necessary.
        EndpointAddress endpointAddress = new EndpointAddress(address);
        CalculatorClient client = new CalculatorClient(binding, endpointAddress);
        return client; 
```

顺便说一句，我不知道我在用所有这些绑定做什么，我只是想让它工作！我昨天刚刚了解了 WCF……我想将整个界面放在一个 DLL 中，并且不想将 app.config 与 GUI 前端复制或合并。

# eclipse - IntelliJ IDEA 相当于 Eclipse“链接与编辑器”

> ID：746109
> 
> 赞同：80
> 
> 时间：2009-04-14T02:20:25.207
> 
> 标签：eclipse, editor, intellij-idea

在 Eclipse 中，您可以选中“Link with Editor”选项，您在当前选项卡中查看的任何源文件都将突出显示，并在 Package Explorer 视图中展开其包。

IntelliJ IDEA 8.1 中是否有与此等价的东西？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2013-04-02T22:57:27.727

在 IntelliJ IDEA 12（评论中的 13、14 和 15）中，它位于“项目”工具窗口中的齿轮图标处，正如我们的伙伴所说，**Autoscroll from source**

检查图像

![在此处输入图像描述](https://i.stack.imgur.com/0N0eN.png)

我希望这可以帮助别人:)

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2009-04-14T04:02:06.663

更新（2020，十一年后）：见“[源码导航/在工程工具窗口中定位文件](https://www.jetbrains.com/help/idea/navigating-through-the-source-code.html#scroll_to_from_source)”

> 在**`Project`**工具窗口中，右键单击**`Project`**工具栏，然后从上下文菜单中选择**`Always Select Opened File`**。
> 
> 之后，IntelliJ IDEA 将跟踪当前在活动编辑器选项卡中打开的文件，并**`Project`**自动在工具窗口中找到它。

[![https://www.jetbrains.com/help/img/idea/2019.3/project_view_context_menu.png](https://i.stack.imgur.com/en0Mo.png)](https://i.stack.imgur.com/en0Mo.png)

* * *

原始答案（2009）

那将是![autoscrollFromSource.png](https://i.stack.imgur.com/CqYee.png)：**Autoscroll from Source**。

[**从获得焦点的编辑器中的文件导航到项目工具窗口**](http://www.jetbrains.com/idea/webhelp/index.jsp?project-tool-window.html)中的相应节点。

![替代文字](https://i.stack.imgur.com/3ZGHN.gif)

[Fried Hoeben](https://stackoverflow.com/users/225771/fried-hoeben) [评论](https://stackoverflow.com/questions/746109/intellij-idea-equivalent-of-eclipse-link-with-editor/746287#comment20169192_746287)说

> 您可以从项目工具窗口的配置中到达那里。
> 它不存在于一般 IDE 设置中（至少在版本 12 中）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-24T17:11:33.697

在 2016.3 版本中，它是项目工具窗口上的一个小图标，名为 Scroll from Source。这是右侧的第一个图标[见屏幕截图](https://i.stack.imgur.com/TxzdD.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-01-23T18:37:47.430

**右键单击**项目**标题栏（项目视图）**。然后选择**“从资源自动滚动”**选项。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-22T17:25:00.713

在 Intellij 2019.3 社区编辑器中，右键单击项目视图并选中“始终选择打开的文件”项。

# winforms - F# 和 winform 控件问题

> ID：746112
> 
> 赞同：2
> 
> 时间：2009-04-14T02:23:02.377
> 
> 标签：winforms, f#, textbox

我对 F# 很陌生，我想我会开发一个简单的 winform 计算器来加强我使用 F# 和 .NET 的技能。我遇到了两个可能有非常简单的答案的问题，但是，我无法从我的资源中找到任何帮助。

首先，我希望能够将我的文本框类型更改为整数，这样当我按下“添加”按钮时，事件将添加整数而不是连接它们。例如：

btnPlus.Click.Add(fun _ -> tb1.Text <- ("2") + ("2")) 给我 22 而不是 4

如何为文本框指定整数类型或为输入到文本框中的值指定整数类型？

我的下一个问题与语法有关。我只是想知道如何向事件添加多个命令。也就是说，在上面的例子中，假设我想添加两个整数，然后打开另一个表单，然后在单击按钮后运行一个消息框。我是否只在每个命令之间包含逗号，例如：btnPlus.Click.Add(fun _ -> add integers, open form, messagebox) 还是涉及其他内容？

我为大二的问题道歉。在 F# 和 winforms 上没有足够的资源，因为在 F# 和输出（即打印、cmd 等）上有足够的资源。

谢谢，

DFM

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T02:34:28.743

我认为文本框文本始终是一个字符串，但你可以这样做

```
(2 + 2).ToString() 
```

（不太确定你在追求什么）。

至于 lambda 体内的多个语句，F# 是基于表达式的，但使用 ';' 或用于排序的换行符，例如

```
(fun _ -> doFoo(); doBar()) 
```

或者

```
(fun _ ->
    doFoo()
    doBar()
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T02:48:16.747

您只需将文本框内容解析为整数。您可以通过 Convert.ToInt32 执行此操作。

```
open System
let string1 = "254"
let string2 = "4525"
let myNum = Convert.ToInt32(string1) + Convert.ToInt32(string2) 
```

编辑：您也可以使用 Int32.TryParse(string, int32) 来做到这一点。

编辑：在 F# 中，您可以只使用“int”，例如 (int string1)。

# unit-testing - 用硒进行测试

> ID：746118
> 
> 赞同：1
> 
> 时间：2009-04-14T02:26:27.140
> 
> 标签：unit-testing, testing, selenium, automated-tests

我是一个完整的硒新手。如果我想学习如何使用它应该从哪里开始？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T05:24:21.083

我以两种不同的方式使用 Selenium：

1.  [Selenium 远程控制](http://seleniumhq.org/projects/remote-control/)- 擅长编写脚本测试来操作大量数据以访问或插入网站，因为您可以从真正的编程语言（我使用 Ruby）中操作 Selenium 命令。

2.  [Selenium IDE](http://seleniumhq.org/projects/ide/) - 擅长制作快速脚本来演示网站的问题和单路径执行。Firefox 插件集成非常出色且易于使用。非开发人员甚至可以创建和提交脚本来演示问题。

选择两种方式中的一种并编写一个脚本来在网络上做一些常规的事情（从 NHL.com 上查看最新的曲棍球比分等）。在你运行了那个超级简单的脚本之后，尝试一些更复杂的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T02:30:55.523

下载 firefox 插件开始。您可以记录、重播一些测试。有一些视频教程。

看看这个[介绍](http://www.scribd.com/doc/10154245/Selenium-Ide-Tutorial)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-25T05:17:21.450

你可以得到这本书**Selenium 2 测试工具初学者指南**。非常有用的一本书，特别适合新手。我有一个很好的经验，用它来学习 Selenium。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-22T14:21:16.917

我建议从概述[自动化 Web 测试](http://www.scribd.com/doc/3901353/automated-web-testing-with-selenium)开始，在 scribd 上使用 selenium 演示

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-17T09:49:17.897

更好的主意，启动 selenium IDE，它是像其他工具一样的记录和播放方法。

一旦熟悉了，就可以开始使用selenium RC、Grid、Webdriver了。

Selenium IDE 是 firefox 扩展。更多帮助[http://seleniumhq.org/docs/02_selenium_ide.html](http://seleniumhq.org/docs/02_selenium_ide.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-16T01:08:58.077

真的取决于你想用 Selenium 做什么。

如果您不知道自己在做什么，我绝对建议您使用 Selenium IDE，因为它会自动执行大多数操作，并为您介绍如何使用 Selenium Remote Control。

Selenium Remote Control 让您可以使用自己喜欢的语言中的 Selenium。从那里开始，这取决于您想在哪里获得帮助时使用哪种语言。我使用 Java/JUnit，只要有一些我不确定该怎么做并且 Selenium IDE 不会告诉我该怎么做的事情，我就使用 google/documentation/stackoverflow。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-10-10T14:15:42.463

除了此页面上的其他建议之外，我用来快速了解 Selenium 的最有用的网站之一是：[theautomatedtester.com 的 Selenium Training](http://www.theautomatedtester.co.uk/selenium_training.htm)

他涵盖

*   **录制和播放**，
*   **Javascript和变量**，
*   **XPath** ,
*   **正则表达式**等；

但是，我认为我只需要前几个。

此外，Selenium IDE 有许多扩展/插件/插件，因此如果您遇到任何问题，请务必检查其中的任何一个。

例如，我认为我需要开始使用 Selenium 远程控制（和 C# 中的代码），因为我想创建具有逻辑流和循环的测试......但是有一个插件可以将其合并到 IDE 中（[goto & while 循环扩展](http://51elliot.blogspot.com/2008/02/selenium-ide-goto.html)），所以我不需要！

希望这可以帮助！

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2011-04-02T16:19:24.407

从哪儿开始？

转到：[http ://seleniumhq.org/docs/](http://seleniumhq.org/docs/)

从头到尾阅读文档。

预计时间8小时。

# x11 - 您如何使用显示规格？

> ID：746119
> 
> 赞同：4
> 
> 时间：2009-04-14T02:27:15.797
> 
> 标签：x11

“X Power Tools”一书有一章“显示规格”，其中指出：

> 由于 X 客户端可以连接到网络上任何地方的显示器，因此有必要通过某种方式指定要使用的显示器。这是使用显示规范（或显示规范）完成的。
> 
> 显示规范采用以下形式：
> 
> ```
>  host:display[.screen] 
> ```

您如何在项目中使用规范？如果您的主机、显示器和屏幕是已知的，任何人都可以连接到您的屏幕吗？如果很多人都在做同一个编程项目，你如何保护或分享它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T03:17:01.623

通常，不会。默认情况下，大多数 X 服务器不会接受来自`localhost`. 如果您需要，最简单的解决方法是在`ssh`启用 X Tunneling 的情况下进入您想要运行应用程序的框。这些应用程序获得了一个`DISPLAY`似乎是 X 服务器本地的有效设置，因此一切正常。

在应用程序中使用 X Window 显示规范通常围绕在`DISPLAY`环境中查找并将其交给 X Client 库。你不必对它做任何事情。事实上，现代 X 客户端库可能能够将其从环境本身中捞出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T20:33:49.680

看

[http://tldp.org/HOWTO/Remote-X-Apps.html](http://tldp.org/HOWTO/Remote-X-Apps.html)

和

[http://tldp.org/HOWTO/XWindow-User-HOWTO/](http://tldp.org/HOWTO/XWindow-User-HOWTO/)（第 8 章）

# asp.net - ASP.NET：公开 Web 用户控件的控件

> ID：746121
> 
> 赞同：4
> 
> 时间：2009-04-14T02:27:43.567
> 
> 标签：asp.net, user-controls

我创建了一些 Web 用户控件（.ascx 文件）并将它们放入 Pages 中。用户控件中有一些文本框，我希望页面能够直接访问。

将用户控件中的这些文本框暴露给包含用户控件的页面的最简单（阅读：最少时间）方法是什么？

我知道的两个选项是从 Pages 调用 myUserControl.FindControl(id)（这甚至可以从 Pages 工作吗？），并在用户控件中编写属性以公开 TextBox 值。

两者似乎都不理想。FindControl() 要求 Page 知道用户控件中 TextBox 的 ID，从而打破封装并添加硬编码字符串，并且考虑到这些用户中的 TextBox 数量，在用户控件中编写一堆属性将非常耗时控制。

**没有办法在我的用户控件中声明这些 TextBoxes 是 public 而不是 protected**？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T02:37:16.490

（撇开关于你所描述的内容本质上与最佳实践相反的事实的明显评论......）

如果您使用的是 Web 应用程序类型的项目，则每个 UserControl 都应该有一个 Designer.cs 文件。它包含每个子控件的声明，因此您可以将访问修饰符更改为 public。

如果您使用的是网站类型的项目，您可能应该转换为 Web 应用程序。[根据 Microsoft](http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx#wapp_topic5)（并有经验支持），当您计划编写超出单个代码隐藏的大量代码时，不适合使用 Web Site 类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T02:34:06.063

如果我必须这样做，我将编写一个公开控件的公共属性。但是，通常有一种方法可以重写信息，这样您就不需要公开内部控制。如果您只需要值，请创建一个返回值的属性。如果您需要客户端 ID，也许创建一个公开值或事件的客户端对象将解决问题。请记住，一旦您将其公开，您就会暴露一份合同，而更改该合同几乎总是会很痛苦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-07T00:18:28.767

You can expose it as a property from the code behind. You'll really only be able to access it's properties from code, not from the ASP.Net designer though. This is an example in vb that exposes a DropDownList on a user control (and, it may not be a best practice but it certainly beats writing code to expose every property on the child controls):

```
''' <summary>
''' This is the exposed DropDownList for this control.
''' </summary>
''' <value></value>
''' <returns></returns>
''' <remarks></remarks>
Public ReadOnly Property DrowDownList() As DropDownList
    Get
        Return ddControlList
    End Get
End Property 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T02:32:04.430

为什么不让您的用户控制一个 TextBoxes 集合，将该集合公开为一个属性，然后在您的 Init() 方法中，将所有文本框添加到该集合中？

这样，您就有了一个集合，如果需要，您可以按 ID 搜索，而无需依赖任何页面逻辑，并且您只需公开一个属性。如果您为它创建自己的集合类，您甚至可以编写一些方便的方法来以您需要的方式访问文本框。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T02:41:05.763

从公共基类派生所有 Web 用户控件，并将此功能公开为公共方法（或方法）。您的基类可以从 UserControl（.ascx 通常的方式）派生，而您的控件又从它派生。

然后，即使使用反射看起来有点工作，你也只做一次。如果文本框是动态的，并且您想避免硬编码，这将是要走的路。

因此，如果您只需要通过 id 从父级获取文本框的值，您可以在基类中添加如下内容：

```
 public string GetTextboxValue(string id)
    {
        string textValue = string.Empty;
        Control ctl = FindControl(id);
        if (ctl.GetType() == typeof(TextBox))
            textValue = ((TextBox)ctl).Text;
        return textValue;
    } 
```

我会说走这条路线，而不是之前公开 TextBox 的建议，因为你真的只想从父级读取文本值，而不是将整个对象公开为读/写。

# coding-style - 否定相等与不相等

> ID：746123
> 
> 赞同：4
> 
> 时间：2009-04-14T02:30:19.847
> 
> 标签：coding-style

最近，我一直在阅读一些代码

```
 if (! (a == b) ) 
```

代替

```
 if ( a != b ) 
```

在某些地方。

显然，这些在逻辑上是等价的，但我想知道是否有任何特别的理由使用其中一个。

是否在某些情况下更可取，或者这只是个人风格的问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-14T02:33:24.457

我真的更喜欢

```
if ( a != b ) 
```

仅仅是因为您应该**阅读更少**，并且您可以更快地理解程序员想要传递的信息。

**请记住，程序员花在*阅读*代码上的时间比编写代码的时间要多，因此您可以做的越多，使代码更易于理解越好。**

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-14T02:34:39.493

大多数情况下，这是一个风格问题（我的偏好是'a！= b'），但如果 a 是一个没有 operator== 或 an 的类的对象，则操作可能会有实际差异运算符！=。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-14T02:33:35.987

我会避免

```
if (! (a == b) ) 
```

因为它涉及两个操作，其中有一个操作员

```
if ( a != b ) 
```

做同样的事情。第二个也更具可读性（如果只是稍微）。

我遇到的真正大问题

```
if (! (a == b) ) 
```

是不是它让我停下来想“到底是什么？” 好的代码不应该那样做。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-14T02:47:53.033

如前所述，具有运算符重载的语言通常不会对每个 == 强制使用 !=。在这种情况下， !( a == b ) 是必不可少的，因为 a != b 是未定义的。此外，在上下文中使用 !( a == b )*可能*是有意义的。虽然由于本问题其他地方给出的原因，首选较短的形式，但较长的形式在某些问题集中可能更具描述性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T02:36:44.073

您的代码应该尽可能简单，即更少的语句更好，因此 a!=b 是 3 个构造而不是 ! (a=b) 即 4。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T13:52:52.547

任何半途而废的编译器都会输出相同的代码（除非 == 和 != 已被重载，如其他地方所述），因此优化问题无关紧要。

我认为我从未在更大的条件之外见过“if(!(a==b))”，在这种情况下，不使用德摩根定理会更清楚，但我想我可以将其视为一种强调这一点的方式这两个值真的应该是相同的，如果它们不是，那就有很大的错误。然而，在下一行按喇叭“throw OmgICantBelieveThisHappenedException()”会更清楚。:-)

除了这两种情况，我必须同意“使用！=”阵营，因为当您浏览代码时会更清楚。这 '！' 很容易被忽略，尤其是在一些格式约定的情况下。

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2009-04-14T03:01:09.977

这就是德摩根定理。（奥古斯都德摩根 - 数学家）

如果(a != b)

# c# - 在运行时创建/修改枚举

> ID：746128
> 
> 赞同：9
> 
> 时间：2009-04-14T02:31:34.837
> 
> 标签：c#, enums, propertygrid

我正在创建一个程序，用户可以选择创建自己的自定义属性，这些属性最终将显示在`PropertyGrid`. 现在我不想弄乱自定义编辑器，所以我只允许已经内置编辑器的原始类型属性（ `string`, `int`, `double`,`DateTime`等`bool`） 。`PropertyGrid`

但是，我还想为用户提供创建多项选择属性的选项，他们可以在其中定义可能值的列表，这些值又将显示为`PropertyGrid`.

当我`Enum`在代码中硬编码 an 时，属性网格会自动将其属性显示`enum`为下拉列表。但是我可以在运行时创建和/或修改枚举，以便用户可以添加另一个属性选项，然后返回`PropertyGrid`并在下拉列表中查看他们的新选项？

**更新**

考虑到帕特里克的评论，我认为`Enum`s 在这种情况下不是正确的方法。那么，如何使用字符串列表来填充`PropertyGrid`项目中的下拉列表呢？那需要自定义编辑器吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-04T17:18:12.127

答案在一个简单的类中：**TypeConverter**。（是的，枚举不适合这里）。

由于我没有太多细节，我假设您有一个 PropertyGrid 通过 SelectedObject 属性“链接”到目标实例，并且您的目标实例实现 ICustomTypeDescriptor，以便您可以在运行时添加属性（即 PropertyDescriptors）。我不知道你的设计，但如果你不这样做，我建议你看看它。

现在假设您添加了一个字符串属性，并且您想让您的用户为该属性指定一组约束。您的 UI 让用户输入一组字符串，然后您会得到一个字符串列表。也许您在目标实例中保留了一个属性字典，所以让我们假设这个新列表也存储在那里。

现在，只需编写一个派生自 TypeConverter 的新转换器（在本例中可能是 StringConverter）。您必须重写 GetStandardValuesSupported 以返回 true，并重写 GetStandardValues 以返回**字符串**列表（使用 context 参数访问 Instance 属性及其字符串列表）。此转换器将由您的 PropertyDescriptor 使用 PropertyDescriptor.Converter 属性发布。

我希望这不是太模糊。如果您对此过程有具体问题，请告诉我。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T02:52:23.787

解决问题的典型工程解决方案是使用将列表作为参考数据维护在数据库中。一般来说，枚举是在编译时定义的常量，不鼓励在以后发布的代码中修改它们（更不用说运行时），因为它可能会导致 switch 语句的副作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T02:36:25.073

您可以使用您的代码创建代码，然后将其保存到临时文本文件中，然后使用它。这会很慢，因为它涉及使用 HDD。我会建议调查[反射](http://msdn.microsoft.com/en-us/library/ms173183(VS.80).aspx)。

**编辑：**我在我的一本书中找到了一个完美的例子，在这里（它很长，但如果你将它复制到 VS 中，它会更有意义）。

```
namespace Programming_CSharp
{
   using System;
   using System.Diagnostics;
   using System.IO;
   using System.Reflection;
   using System.Reflection.Emit;
   using System.Threading;

   // used to benchmark the looping approach
   public class MyMath
   {
      // sum numbers with a loop
      public int DoSumLooping(int initialVal)
      {
         int result = 0;
         for(int i = 1;i <=initialVal;i++)
         {
            result += i;
         }
         return result;
      }
   }

   // declare the interface
   public interface IComputer
   {
      int ComputeSum(  );
   }

   public class ReflectionTest
   {
      // the private method which emits the assembly
      // using op codes
      private Assembly EmitAssembly(int theValue)
      {
         // Create an assembly name
         AssemblyName assemblyName = 
            new AssemblyName(  );
         assemblyName.Name = "DoSumAssembly";

         // Create a new assembly with one module
         AssemblyBuilder newAssembly =
            Thread.GetDomain(  ).DefineDynamicAssembly(
            assemblyName, AssemblyBuilderAccess.Run);
         ModuleBuilder newModule =
            newAssembly.DefineDynamicModule("Sum");

         //  Define a public class named "BruteForceSums " 
         //  in the assembly.
         TypeBuilder myType =
            newModule.DefineType(
            "BruteForceSums", TypeAttributes.Public);

         // Mark the class as implementing IComputer.
         myType.AddInterfaceImplementation(
            typeof(IComputer));

         // Define a method on the type to call. Pass an
         // array that defines the types of the parameters,
         // the type of the return type, the name of the 
         // method, and the method attributes.
         Type[] paramTypes = new Type[0];
         Type returnType = typeof(int);
         MethodBuilder simpleMethod =
            myType.DefineMethod(
            "ComputeSum",
            MethodAttributes.Public | 
            MethodAttributes.Virtual,
            returnType,
            paramTypes);

         // Get an ILGenerator. This is used
         // to emit the IL that you want.
         ILGenerator generator = 
            simpleMethod.GetILGenerator(  );

         // Emit the IL that you'd get if you 
         // compiled the code example 
         // and then ran ILDasm on the output.

         // Push zero onto the stack. For each 'i' 
         // less than 'theValue', 
         // push 'i' onto the stack as a constant
         // add the two values at the top of the stack.
         // The sum is left on the stack.
         generator.Emit(OpCodes.Ldc_I4, 0);
         for (int i = 1; i <= theValue;i++)
         {
            generator.Emit(OpCodes.Ldc_I4, i);
            generator.Emit(OpCodes.Add);

         }

         // return the value
         generator.Emit(OpCodes.Ret);

         //Encapsulate information about the method and
         //provide access to the method's metadata
         MethodInfo computeSumInfo =
            typeof(IComputer).GetMethod("ComputeSum");

         // specify the method implementation.
         // Pass in the MethodBuilder that was returned 
         // by calling DefineMethod and the methodInfo 
         // just created
         myType.DefineMethodOverride(simpleMethod, computeSumInfo);

         // Create the type.
         myType.CreateType(  );
         return newAssembly;
      }

      // check if the interface is null
      // if so, call Setup.
      public double DoSum(int theValue)
      {
         if (theComputer == null)
         {
            GenerateCode(theValue);
         }

         // call the method through the interface
         return (theComputer.ComputeSum(  ));
      }

      // emit the assembly, create an instance 
      // and get the interface
      public void GenerateCode(int theValue)
      {
         Assembly theAssembly = EmitAssembly(theValue);
         theComputer = (IComputer) 
            theAssembly.CreateInstance("BruteForceSums");
      }

      // private member data
      IComputer theComputer = null;

   }

   public class TestDriver
   {
      public static void Main(  )
      {
         const int val = 2000;  // Note 2,000

         // 1 million iterations!
         const int iterations = 1000000;
         double result = 0;

         // run the benchmark
         MyMath m = new MyMath(  ); 
         DateTime startTime = DateTime.Now;            
         for (int i = 0;i < iterations;i++)
            result = m.DoSumLooping(val);
         }
         TimeSpan elapsed = 
            DateTime.Now - startTime;
         Console.WriteLine(
            "Sum of ({0}) = {1}",val, result);
         Console.WriteLine(
            "Looping. Elapsed milliseconds: " + 
            elapsed.TotalMilliseconds + 
            " for {0} iterations", iterations);

         // run our reflection alternative
         ReflectionTest t = new ReflectionTest(  );

         startTime = DateTime.Now; 
         for (int i = 0;i < iterations;i++)
         {
            result = t.DoSum(val);
         }

         elapsed = DateTime.Now - startTime;
         Console.WriteLine(
            "Sum of ({0}) = {1}",val, result);
         Console.WriteLine(
            "Brute Force. Elapsed milliseconds: " + 
            elapsed.TotalMilliseconds  + 
            " for {0} iterations", iterations);
      }
   }
} 
```

输出： (2000) 之和 = 2001000
循环。经过的毫秒数：
1000000 次迭代的 11468.75
总和 (2000) = 2001000
蛮力。经过的毫秒数：
1000000 次迭代为 406.25

如果您想了解更多信息，[这里是整个章节的链接。](http://oreilly.com/catalog/progcsharp/chapter/ch18.html)

* * *

## 回答 #4

> 赞同：-7
> 
> 时间：2009-04-14T02:41:29.087

您可以使用 Enum.GetNames() 和 Enum.GetValues() 检索值并动态添加新值。尽管我建议您使用列表而不是枚举或重新考虑您的设计。有些东西闻起来不对劲。

# php - php：从字符串中删除多余 的标签

> ID：746129
> 
> 赞同：5
> 
> 时间：2009-04-14T02:31:47.847
> 
> 标签：php

如何`<br> and &nbsp;`从字符串的开头和结尾删除多余的标签？

谢谢 ：）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-14T02:35:09.507

试试这个：

```
$str = preg_replace('{^(<br(\s*/)?>|&nbsp;)+}i', '', $str); //from start
$str = preg_replace('{(<br(\s*/)?>|&nbsp;)+$}i', '', $str); //from end 
```

也可以获得 XHTML`<br />`和`<br/>`表单

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T02:36:27.227

使用[preg_replace](http://us2.php.net/manual/en/function.preg-replace.php)：

```
$str = "<br>some text&nbsp;"
$str = preg_replace('/(^(<br>|&nbsp)*)|((<br>|&nbsp)*$)/i', '', $str); 
```

没有测试它，但类似的东西应该可以工作。

# linker - 自动查找内容链接的最佳方式？

> ID：746135
> 
> 赞同：4
> 
> 时间：2009-04-14T02:34:01.413
> 
> 标签：linker, web-crawler, trackback, pingback

所以，这是我发现自己正在考虑的任务。假装一下，我有大量的内容。我想查看哪些网站链接到我的内容。我知道我可以查看 TrackBack 或 PingBack，但是那些不使用能够处理它的工具的人呢？

似乎某种形式的网络爬虫寻找链接到原始文档的页面可能很有用。我向更大的社区提出的问题是，从这里开始的最佳方式是什么？TrackBack 和 PingBack 做的比我想象的要多吗？是否有服务或工具可以满足我的想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T02:36:27.493

[谷歌是你的朋友！](http://googlewebmastercentral.blogspot.com/2007/02/discover-your-links.html)

使用链接前缀：

链接：whatsite.com

是的，[trackbacks 做得更多](http://www.sixapart.com/pronet/docs/trackback_spec)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-05T13:36:04.417

如果您在日志中设置了 HTTP 引用，则可以挖掘它们。您甚至可以发现您不知道的页面。

否则，有[来自 Seomoz 的付费 Linkscape](http://www.seomoz.org/linkscape)或免费的[majesticSEO](http://www.majesticseo.com/)（如果您确认该域的所有权）。

MajesticSEO 具有[更大的反向链接索引](http://www.majesticseo.com/research/competitors-analysis.php)和[API](https://www.majesticseo.com/api.php)（需要登录！）。

# svn - 将 svn 存储库添加到现有的 git 存储库？

> ID：746151
> 
> 赞同：48
> 
> 时间：2009-04-14T02:38:59.280
> 
> 标签：svn, git, git-svn

我知道你可以通过使用 git svn init 来跟踪 git 的 svn 存储库，但是如果你想创建一个全新的存储库的话。

我的情况是我目前已经有一个现有的 git repo 并希望通过在我当前的 git repo 中将其设置为远程分支来跟踪 svn repo 的主干。

有什么建议么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-08T15:30:12.057

经过昨晚的搜索，我终于找到了答案：

[http://i-nz.net/2009/01/15/selective-import-of-svn-branches-into-a-gitgit-svn-repository/](http://i-nz.net/2009/01/15/selective-import-of-svn-branches-into-a-gitgit-svn-repository/)

看来您必须实际进入并手动编辑 .git/config 文件才能将 svn 分支添加到现有的 git 存储库。因此，根据这些说明，我必须为每个分支添加一个条目。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-08-01T19:19:36.473

这个问题的答案（[https://stackoverflow.com/a/840411](https://stackoverflow.com/a/840411)和[https://stackoverflow.com/a/7592152](https://stackoverflow.com/a/7592152)）不再适用于 Git v1.8.3.2 （[https://stackoverflow.com/ a/19833311](https://stackoverflow.com/a/19833311) )。你可以这样做：

1）在 .git/config 定义新分支：

```
[svn-remote "release-branch"]
   url = svn+ssh://xxxx@mono-cvs.ximian.com/source/branches/mono-2-2/mcs
   fetch = :refs/remotes/git-svn-release-branch 
```

2）导入SVN分支。SVN_BRANCHED_REVISION 是分支发生在 SVN 中时的修订版本。

```
$ git svn fetch release-branch -r SVN_BRANCHED_REVISION 
```

3）创建分支并将本地Git分支连接到远程分支：

```
$ git checkout -b release refs/remotes/git-svn-release-branch 
```

5) 更新

```
$ git svn rebase 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-01T13:10:33.483

您可以通过执行以下操作找到 SVN_BRANCHED_REVISION：

```
$ svn log --stop-on-copy PATH_TO_BRANCH 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T03:08:42.437

这实际上是 git svn init 所做的——其他 git svn 命令只是将事物合并在一起，等等。您可以 git svn init 和/或复制使用 git svn clone 克隆的 SVN 存储库的布局，您应该能够拉入本地分支，或获取，等等。花点时间阅读 git svn 的手册页，你应该不会有太多的麻烦来拼凑一些东西；如果你这样做了，freenode 上的#git 是一个很好的资源。所以，这应该是可能的，没有太多麻烦，但我不知道该怎么做。

# javascript - JavaScript 的语句性能问题

> ID：746152
> 
> 赞同：6
> 
> 时间：2009-04-14T02:39:23.803
> 
> 标签：javascript, performance

你们能帮我确定每个语句的性能差异吗？你会用哪一个？

1.  使用创建一个新数组

    ```
    - var new_list = new Array();  //or
    - var new_list = []; 
    ```

2.  使用附加元素

    ```
    - push('a')
    - new_list[i]; (if i know the length) 
    ```

3.  三元运算符或 `if() {} else (){}`

4.  尝试制作isodd函数，速度更快

    ```
    (! (is_even)) or (x%2!=0) 
    ```

5.  `forEach()`或正常迭代

多一个

6.  `a= b = 3;`或者`b=3; a=b;`

[编辑：我正在制作一个数学库。所以也欢迎任何性能黑客讨论:)]

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T04:04:30.650

我一直认为，由于 (x&1) 是按位运算，因此它是检查偶数/奇数而不是检查余数的最快方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T02:44:26.350

我建议您编写一个简单的脚本，例如：

```
for(var i = 0; i < 1000; i++){
  // Test your code here.
} 
```

你可以用这种方式对任何你想要的东西进行基准测试，可能在语句之前和之后添加计时函数`for`以更准确。

当然，您需要根据操作的性质调整上限（在本例中为 1000）——有些需要更多的迭代，有些则更少。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-16T05:21:13.040

所有浏览器的性能特征（尤其是在单个库函数级别）可能会有很大差异，因此很难对这些问题给出有意义的真正有意义的答案。

Anyhoo，看看*快速*的js 引擎（比如 Nitro、TraceMonkey 和 V8）

1.  `[ ]`will be faster than `new Array`--`new Array`变成下面的逻辑

    1.  `cons`=查找属性“数组”，如果找不到，抛出异常
    2.  检查是否`cons`可以用作构造函数，如果不能：抛出异常
    3.  `thisVal`= 运行时直接创建一个新对象
    4.  `res`=作为值调用`cons`传递的结果-- 这需要逻辑来区分 JS 函数和标准运行时函数（假设标准运行时函数没有在 JS 中实现，这是正常情况）。在这种情况下，是一个本地构造函数，它将创建并返回一个新的运行时数组对象。`thisVal``this``Array`
    5.  如果`res`是 undefined 或 null 那么最终结果是，`thisVal`否则最终结果是`res`. 在调用`Array`新数组的情况下，对象会被返回并被`thisVal`丢弃

    `[ ]`只是告诉 JS 引擎立即直接创建一个新的运行时数组对象，无需额外的逻辑。这意味着`new Array`有大量额外的（不是很便宜的）逻辑，并执行额外的不必要的对象分配。

2.  `newlist[newlist.length] = ...`更快（尤其是如果 newlist 不是稀疏数组），但是推送对于我来说已经足够普遍了，我期望引擎开发人员会付出相当多的努力来提高性能，这样这*可能会*及时改变。

3.  如果你有一个足够紧密的循环，那么三元运算符可能会略微获胜，但可以说这是`a = b ? c : d`vs的琐碎案例中的引擎缺陷`if (b) a = c; else a = d`

4.  仅函数调用开销就会使任何 JS 运算符的成本或多或少相形见绌，至少在理智的情况下（例如，您正在对数字而不是对象执行算术运算）

5.  语法尚未标准化，但其`foreach`最终性能将取决于大量细节；通常 JS 语义会导致看起来高效的语句效率较低——例如。比JS 语义需要枚举来建立对象上所有属性的列表（包括原型链）的列表`for (var i in array) ...`要慢得多，*然后*在通过循环发送之前检查以确保每个属性仍在对象上。哦，属性需要从整数（无论如何在数组的情况下）转换为字符串，这会耗费时间和内存。`for (var i = 0; i < array.length; i++) ...``in`

 ** * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-14T02:46:10.090

1.  两者都是本机构造函数可能没有区别。
2.  push 更快，它直接映射到本地，其中 [] 是评估的
3.  可能差别不大，但从技术上讲，他们做的事情不同，所以不是苹果对苹果
4.  x%2，跳过比较慢的函数调用
5.  我听说，虽然目前找不到链接，但迭代比 foreach 快，这让我感到惊讶。

编辑：在 #5 上，我相信原因与[this](https://stackoverflow.com/questions/660097/is-java-foreach-iteration-order-over-primitives-precisely-defined)相关，因为 foreach 是向前排序的，这需要增量器向前计数，而 for 循环在向后运行时速度非常快：

```
for(var i=a.length;i>-1;i--) {
    // do whatever
} 
```

以上略快于：

```
for(var i=0;i<a.length;i++) {
    // do whatever
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T03:44:52.147

正如其他海报所建议的那样，我认为做一些粗略的基准测试是你最好的选择......但是，我还要注意，你可能会从不同的浏览器得到非常不同的结果，因为我确信你的大部分问题是要求归结为语言结构的特定内部实现，而不是语言本身。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T04:46:47.333

该页面说推送速度较慢。 [http://dev.opera.com/articles/view/efficient-javascript/?page=2](http://dev.opera.com/articles/view/efficient-javascript/?page=2)

# cocoa - 德国版 mac os Tiger 和 About 面板

> ID：746165
> 
> 赞同：0
> 
> 时间：2009-04-14T02:46:46.670
> 
> 标签：cocoa

我有一个应用程序，现在我想用德国版编辑它，但我发现了一件有趣的事情：在老虎下我发现当关于面板显示带有日耳曼字符的信息时，如果一行无法填充字符，它会显示保留到下一行，例如： **Copyright © 2001-2009 AAA Co., LTD**，如果只能显示**Copyright © 2001-2008 AAA**，则下一行可以显示**Co., LTD**，不像10.5或其他Tiger下的语言版本，关于面板可以自动适应字符长度。我认为这可能是德国版本不太适合Tiger。但是在Tiger的德国环境下，如何在一行中显示版权...？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T03:23:30.123

您的选择是：

1.  编写一个完全自定义的关于面板。
2.  接受这是 Apple 在 Leopard 中修复的 Tiger 中的问题，并在德语本地化版权字符串中的公司名称前添加硬换行符。
3.  接受这是 Apple 在 Leopard 中修复的 Tiger 中的问题，并且什么也不做。

我会做＃3。几乎没有人同时 (a) 运行 Tiger 和 (b) 查看“关于”窗口，那么谁会注意到呢？当你最终放弃对 Tiger 的兼容性时，问题就完全消失了。

# c - C中位反转的高效算法（从MSB->LSB到LSB->MSB）

> ID：746171
> 
> 赞同：259
> 
> 时间：2009-04-14T02:48:46.230
> 
> 标签：c, algorithm, bit-manipulation

实现以下目标的最有效算法是什么：

`0010 0000 => 0000 0100`

转换是从 MSB->LSB 到 LSB->MSB。所有位必须颠倒；也就是说，这*不是*字节顺序交换。

* * *

## 回答 #1

> 赞同：516
> 
> 时间：2009-04-14T03:11:26.347

**注意**：下面的所有算法都在 C 中，但应该可以移植到您选择的语言（当它们不那么快时不要看着我 :)

## 选项

**低内存（32 位`int`，32 位机器）（从[这里](http://aggregate.org/MAGIC/#Bit%20Reversal)）：**

```
unsigned int
reverse(register unsigned int x)
{
    x = (((x & 0xaaaaaaaa) >> 1) | ((x & 0x55555555) << 1));
    x = (((x & 0xcccccccc) >> 2) | ((x & 0x33333333) << 2));
    x = (((x & 0xf0f0f0f0) >> 4) | ((x & 0x0f0f0f0f) << 4));
    x = (((x & 0xff00ff00) >> 8) | ((x & 0x00ff00ff) << 8));
    return((x >> 16) | (x << 16));

} 
```

来自著名的[Bit Twiddling Hacks 页面](http://graphics.stanford.edu/~seander/bithacks.html)：

**最快（查找表）**：

```
static const unsigned char BitReverseTable256[] = 
{
  0x00, 0x80, 0x40, 0xC0, 0x20, 0xA0, 0x60, 0xE0, 0x10, 0x90, 0x50, 0xD0, 0x30, 0xB0, 0x70, 0xF0, 
  0x08, 0x88, 0x48, 0xC8, 0x28, 0xA8, 0x68, 0xE8, 0x18, 0x98, 0x58, 0xD8, 0x38, 0xB8, 0x78, 0xF8, 
  0x04, 0x84, 0x44, 0xC4, 0x24, 0xA4, 0x64, 0xE4, 0x14, 0x94, 0x54, 0xD4, 0x34, 0xB4, 0x74, 0xF4, 
  0x0C, 0x8C, 0x4C, 0xCC, 0x2C, 0xAC, 0x6C, 0xEC, 0x1C, 0x9C, 0x5C, 0xDC, 0x3C, 0xBC, 0x7C, 0xFC, 
  0x02, 0x82, 0x42, 0xC2, 0x22, 0xA2, 0x62, 0xE2, 0x12, 0x92, 0x52, 0xD2, 0x32, 0xB2, 0x72, 0xF2, 
  0x0A, 0x8A, 0x4A, 0xCA, 0x2A, 0xAA, 0x6A, 0xEA, 0x1A, 0x9A, 0x5A, 0xDA, 0x3A, 0xBA, 0x7A, 0xFA,
  0x06, 0x86, 0x46, 0xC6, 0x26, 0xA6, 0x66, 0xE6, 0x16, 0x96, 0x56, 0xD6, 0x36, 0xB6, 0x76, 0xF6, 
  0x0E, 0x8E, 0x4E, 0xCE, 0x2E, 0xAE, 0x6E, 0xEE, 0x1E, 0x9E, 0x5E, 0xDE, 0x3E, 0xBE, 0x7E, 0xFE,
  0x01, 0x81, 0x41, 0xC1, 0x21, 0xA1, 0x61, 0xE1, 0x11, 0x91, 0x51, 0xD1, 0x31, 0xB1, 0x71, 0xF1,
  0x09, 0x89, 0x49, 0xC9, 0x29, 0xA9, 0x69, 0xE9, 0x19, 0x99, 0x59, 0xD9, 0x39, 0xB9, 0x79, 0xF9, 
  0x05, 0x85, 0x45, 0xC5, 0x25, 0xA5, 0x65, 0xE5, 0x15, 0x95, 0x55, 0xD5, 0x35, 0xB5, 0x75, 0xF5,
  0x0D, 0x8D, 0x4D, 0xCD, 0x2D, 0xAD, 0x6D, 0xED, 0x1D, 0x9D, 0x5D, 0xDD, 0x3D, 0xBD, 0x7D, 0xFD,
  0x03, 0x83, 0x43, 0xC3, 0x23, 0xA3, 0x63, 0xE3, 0x13, 0x93, 0x53, 0xD3, 0x33, 0xB3, 0x73, 0xF3, 
  0x0B, 0x8B, 0x4B, 0xCB, 0x2B, 0xAB, 0x6B, 0xEB, 0x1B, 0x9B, 0x5B, 0xDB, 0x3B, 0xBB, 0x7B, 0xFB,
  0x07, 0x87, 0x47, 0xC7, 0x27, 0xA7, 0x67, 0xE7, 0x17, 0x97, 0x57, 0xD7, 0x37, 0xB7, 0x77, 0xF7, 
  0x0F, 0x8F, 0x4F, 0xCF, 0x2F, 0xAF, 0x6F, 0xEF, 0x1F, 0x9F, 0x5F, 0xDF, 0x3F, 0xBF, 0x7F, 0xFF
};

unsigned int v; // reverse 32-bit value, 8 bits at time
unsigned int c; // c will get v reversed

// Option 1:
c = (BitReverseTable256[v & 0xff] << 24) | 
    (BitReverseTable256[(v >> 8) & 0xff] << 16) | 
    (BitReverseTable256[(v >> 16) & 0xff] << 8) |
    (BitReverseTable256[(v >> 24) & 0xff]);

// Option 2:
unsigned char * p = (unsigned char *) &v;
unsigned char * q = (unsigned char *) &c;
q[3] = BitReverseTable256[p[0]]; 
q[2] = BitReverseTable256[p[1]]; 
q[1] = BitReverseTable256[p[2]]; 
q[0] = BitReverseTable256[p[3]]; 
```

您可以将此想法扩展到 64 位`int`，或以内存换取速度（假设您的 L1 数据缓存足够大），并使用 64K 条目查找表一次反转 16 位。

* * *

## 其他

**简单的**

```
unsigned int v;     // input bits to be reversed
unsigned int r = v & 1; // r will be reversed bits of v; first get LSB of v
int s = sizeof(v) * CHAR_BIT - 1; // extra shift needed at end

for (v >>= 1; v; v >>= 1)
{   
  r <<= 1;
  r |= v & 1;
  s--;
}
r <<= s; // shift when v's highest bits are zero 
```

**更快（32 位处理器）**

```
unsigned char b = x;
b = ((b * 0x0802LU & 0x22110LU) | (b * 0x8020LU & 0x88440LU)) * 0x10101LU >> 16; 
```

**更快（64 位处理器）**

```
unsigned char b; // reverse this (8-bit) byte
b = (b * 0x0202020202ULL & 0x010884422010ULL) % 1023; 
```

如果要在 32-bit 上执行此操作`int`，只需反转每个字节中的位，并反转字节的顺序。那是：

```
unsigned int toReverse;
unsigned int reversed;
unsigned char inByte0 = (toReverse & 0xFF);
unsigned char inByte1 = (toReverse & 0xFF00) >> 8;
unsigned char inByte2 = (toReverse & 0xFF0000) >> 16;
unsigned char inByte3 = (toReverse & 0xFF000000) >> 24;
reversed = (reverseBits(inByte0) << 24) | (reverseBits(inByte1) << 16) | (reverseBits(inByte2) << 8) | (reverseBits(inByte3); 
```

* * *

## 结果

我对两个最有希望的解决方案进行了基准测试，查找表和按位与（第一个）。测试机是配备 4GB DDR2-800 和 Core 2 Duo T7500 @ 2.4GHz、4MB L2 缓存的笔记本电脑；YMMV。我在 64 位 Linux 上使用*gcc 4.3.2。*OpenMP（和 GCC 绑定）用于高分辨率计时器。

**反向.c**

```
#include <stdlib.h>
#include <stdio.h>
#include <omp.h>

unsigned int
reverse(register unsigned int x)
{
    x = (((x & 0xaaaaaaaa) >> 1) | ((x & 0x55555555) << 1));
    x = (((x & 0xcccccccc) >> 2) | ((x & 0x33333333) << 2));
    x = (((x & 0xf0f0f0f0) >> 4) | ((x & 0x0f0f0f0f) << 4));
    x = (((x & 0xff00ff00) >> 8) | ((x & 0x00ff00ff) << 8));
    return((x >> 16) | (x << 16));

}

int main()
{
    unsigned int *ints = malloc(100000000*sizeof(unsigned int));
    unsigned int *ints2 = malloc(100000000*sizeof(unsigned int));
    for(unsigned int i = 0; i < 100000000; i++)
      ints[i] = rand();

    unsigned int *inptr = ints;
    unsigned int *outptr = ints2;
    unsigned int *endptr = ints + 100000000;
    // Starting the time measurement
    double start = omp_get_wtime();
    // Computations to be measured
    while(inptr != endptr)
    {
      (*outptr) = reverse(*inptr);
      inptr++;
      outptr++;
    }
    // Measuring the elapsed time
    double end = omp_get_wtime();
    // Time calculation (in seconds)
    printf("Time: %f seconds\n", end-start);

    free(ints);
    free(ints2);

    return 0;
} 
```

**反向查找.c**

```
#include <stdlib.h>
#include <stdio.h>
#include <omp.h>

static const unsigned char BitReverseTable256[] = 
{
  0x00, 0x80, 0x40, 0xC0, 0x20, 0xA0, 0x60, 0xE0, 0x10, 0x90, 0x50, 0xD0, 0x30, 0xB0, 0x70, 0xF0, 
  0x08, 0x88, 0x48, 0xC8, 0x28, 0xA8, 0x68, 0xE8, 0x18, 0x98, 0x58, 0xD8, 0x38, 0xB8, 0x78, 0xF8, 
  0x04, 0x84, 0x44, 0xC4, 0x24, 0xA4, 0x64, 0xE4, 0x14, 0x94, 0x54, 0xD4, 0x34, 0xB4, 0x74, 0xF4, 
  0x0C, 0x8C, 0x4C, 0xCC, 0x2C, 0xAC, 0x6C, 0xEC, 0x1C, 0x9C, 0x5C, 0xDC, 0x3C, 0xBC, 0x7C, 0xFC, 
  0x02, 0x82, 0x42, 0xC2, 0x22, 0xA2, 0x62, 0xE2, 0x12, 0x92, 0x52, 0xD2, 0x32, 0xB2, 0x72, 0xF2, 
  0x0A, 0x8A, 0x4A, 0xCA, 0x2A, 0xAA, 0x6A, 0xEA, 0x1A, 0x9A, 0x5A, 0xDA, 0x3A, 0xBA, 0x7A, 0xFA,
  0x06, 0x86, 0x46, 0xC6, 0x26, 0xA6, 0x66, 0xE6, 0x16, 0x96, 0x56, 0xD6, 0x36, 0xB6, 0x76, 0xF6, 
  0x0E, 0x8E, 0x4E, 0xCE, 0x2E, 0xAE, 0x6E, 0xEE, 0x1E, 0x9E, 0x5E, 0xDE, 0x3E, 0xBE, 0x7E, 0xFE,
  0x01, 0x81, 0x41, 0xC1, 0x21, 0xA1, 0x61, 0xE1, 0x11, 0x91, 0x51, 0xD1, 0x31, 0xB1, 0x71, 0xF1,
  0x09, 0x89, 0x49, 0xC9, 0x29, 0xA9, 0x69, 0xE9, 0x19, 0x99, 0x59, 0xD9, 0x39, 0xB9, 0x79, 0xF9, 
  0x05, 0x85, 0x45, 0xC5, 0x25, 0xA5, 0x65, 0xE5, 0x15, 0x95, 0x55, 0xD5, 0x35, 0xB5, 0x75, 0xF5,
  0x0D, 0x8D, 0x4D, 0xCD, 0x2D, 0xAD, 0x6D, 0xED, 0x1D, 0x9D, 0x5D, 0xDD, 0x3D, 0xBD, 0x7D, 0xFD,
  0x03, 0x83, 0x43, 0xC3, 0x23, 0xA3, 0x63, 0xE3, 0x13, 0x93, 0x53, 0xD3, 0x33, 0xB3, 0x73, 0xF3, 
  0x0B, 0x8B, 0x4B, 0xCB, 0x2B, 0xAB, 0x6B, 0xEB, 0x1B, 0x9B, 0x5B, 0xDB, 0x3B, 0xBB, 0x7B, 0xFB,
  0x07, 0x87, 0x47, 0xC7, 0x27, 0xA7, 0x67, 0xE7, 0x17, 0x97, 0x57, 0xD7, 0x37, 0xB7, 0x77, 0xF7, 
  0x0F, 0x8F, 0x4F, 0xCF, 0x2F, 0xAF, 0x6F, 0xEF, 0x1F, 0x9F, 0x5F, 0xDF, 0x3F, 0xBF, 0x7F, 0xFF
};

int main()
{
    unsigned int *ints = malloc(100000000*sizeof(unsigned int));
    unsigned int *ints2 = malloc(100000000*sizeof(unsigned int));
    for(unsigned int i = 0; i < 100000000; i++)
      ints[i] = rand();

    unsigned int *inptr = ints;
    unsigned int *outptr = ints2;
    unsigned int *endptr = ints + 100000000;
    // Starting the time measurement
    double start = omp_get_wtime();
    // Computations to be measured
    while(inptr != endptr)
    {
    unsigned int in = *inptr;  

    // Option 1:
    //*outptr = (BitReverseTable256[in & 0xff] << 24) | 
    //    (BitReverseTable256[(in >> 8) & 0xff] << 16) | 
    //    (BitReverseTable256[(in >> 16) & 0xff] << 8) |
    //    (BitReverseTable256[(in >> 24) & 0xff]);

    // Option 2:
    unsigned char * p = (unsigned char *) &(*inptr);
    unsigned char * q = (unsigned char *) &(*outptr);
    q[3] = BitReverseTable256[p[0]]; 
    q[2] = BitReverseTable256[p[1]]; 
    q[1] = BitReverseTable256[p[2]]; 
    q[0] = BitReverseTable256[p[3]];

      inptr++;
      outptr++;
    }
    // Measuring the elapsed time
    double end = omp_get_wtime();
    // Time calculation (in seconds)
    printf("Time: %f seconds\n", end-start);

    free(ints);
    free(ints2);

    return 0;
} 
```

我在几种不同的优化中尝试了这两种方法，在每个级别运行了 3 次试验，每次试验反转了 1 亿个随机数`unsigned ints`。对于查找表选项，我尝试了按位黑客页面上给出的两种方案（选项 1 和 2）。结果如下所示。

**按位与**

```
mrj10@mjlap:~/code$ gcc -fopenmp -std=c99 -o reverse reverse.c
mrj10@mjlap:~/code$ ./reverse
Time: 2.000593 seconds
mrj10@mjlap:~/code$ ./reverse
Time: 1.938893 seconds
mrj10@mjlap:~/code$ ./reverse
Time: 1.936365 seconds
mrj10@mjlap:~/code$ gcc -fopenmp -std=c99 -O2 -o reverse reverse.c
mrj10@mjlap:~/code$ ./reverse
Time: 0.942709 seconds
mrj10@mjlap:~/code$ ./reverse
Time: 0.991104 seconds
mrj10@mjlap:~/code$ ./reverse
Time: 0.947203 seconds
mrj10@mjlap:~/code$ gcc -fopenmp -std=c99 -O3 -o reverse reverse.c
mrj10@mjlap:~/code$ ./reverse
Time: 0.922639 seconds
mrj10@mjlap:~/code$ ./reverse
Time: 0.892372 seconds
mrj10@mjlap:~/code$ ./reverse
Time: 0.891688 seconds 
```

**查找表（选项 1）**

```
mrj10@mjlap:~/code$ gcc -fopenmp -std=c99 -o reverse_lookup reverse_lookup.c
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 1.201127 seconds              
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 1.196129 seconds              
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 1.235972 seconds              
mrj10@mjlap:~/code$ gcc -fopenmp -std=c99 -O2 -o reverse_lookup reverse_lookup.c
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 0.633042 seconds              
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 0.655880 seconds              
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 0.633390 seconds              
mrj10@mjlap:~/code$ gcc -fopenmp -std=c99 -O3 -o reverse_lookup reverse_lookup.c
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 0.652322 seconds              
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 0.631739 seconds              
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 0.652431 seconds 
```

**查找表（选项 2）**

```
mrj10@mjlap:~/code$ gcc -fopenmp -std=c99 -o reverse_lookup reverse_lookup.c
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 1.671537 seconds
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 1.688173 seconds
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 1.664662 seconds
mrj10@mjlap:~/code$ gcc -fopenmp -std=c99 -O2 -o reverse_lookup reverse_lookup.c
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 1.049851 seconds
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 1.048403 seconds
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 1.085086 seconds
mrj10@mjlap:~/code$ gcc -fopenmp -std=c99 -O3 -o reverse_lookup reverse_lookup.c
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 1.082223 seconds
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 1.053431 seconds
mrj10@mjlap:~/code$ ./reverse_lookup
Time: 1.081224 seconds 
```

## 结论

**如果您担心性能**，请使用带有选项 1 的查找表（字节寻址慢）。**如果您需要从系统中挤出每个最后一个字节的内存（如果您关心位反转的性能，您可能会这样做），按位与方法的优化版本也不会太简陋。**

 **## 警告

是的，我知道基准代码是一个完整的 hack。关于如何改进它的建议非常受欢迎。我知道的事情：

*   我无权访问 ICC。这可能会更快（如果您可以对此进行测试，请在评论中回复）。
*   64K 查找表可能在一些具有大型 L1D 的现代微架构上表现良好。
*   -mtune=native 不适用于 -O2/-O3 （`ld`因一些疯狂的符号重新定义错误而炸毁），所以我不相信生成的代码适合我的微架构。
*   使用 SSE 可能有一种方法可以稍微更快地完成此操作。我不知道怎么做，但是通过快速复制、打包的按位与和 swizzling 指令，那里一定有一些东西。
*   我知道只有足够的 x86 程序集是危险的；这是 GCC 在 -O3 上为选项 1 生成的代码，所以比我更有知识的人可以检查一下：

**32 位**

```
.L3:
movl    (%r12,%rsi), %ecx
movzbl  %cl, %eax
movzbl  BitReverseTable256(%rax), %edx
movl    %ecx, %eax
shrl    $24, %eax
mov     %eax, %eax
movzbl  BitReverseTable256(%rax), %eax
sall    $24, %edx
orl     %eax, %edx
movzbl  %ch, %eax
shrl    $16, %ecx
movzbl  BitReverseTable256(%rax), %eax
movzbl  %cl, %ecx
sall    $16, %eax
orl     %eax, %edx
movzbl  BitReverseTable256(%rcx), %eax
sall    $8, %eax
orl     %eax, %edx
movl    %edx, (%r13,%rsi)
addq    $4, %rsi
cmpq    $400000000, %rsi
jne     .L3 
```

编辑：我还尝试`uint64_t`在我的机器上使用类型来查看是否有任何性能提升。性能比 32 位快约 10%，无论您是仅使用 64 位类型一次反转两个 32 位`int`类型的位，还是实际上将位反转为 64 位类型的一半，性能几乎相同。位值。汇编代码如下所示（对于前一种情况，一次反转两个 32 位`int`类型的位）：

```
.L3:
movq    (%r12,%rsi), %rdx
movq    %rdx, %rax
shrq    $24, %rax
andl    $255, %eax
movzbl  BitReverseTable256(%rax), %ecx
movzbq  %dl,%rax
movzbl  BitReverseTable256(%rax), %eax
salq    $24, %rax
orq     %rax, %rcx
movq    %rdx, %rax
shrq    $56, %rax
movzbl  BitReverseTable256(%rax), %eax
salq    $32, %rax
orq     %rax, %rcx
movzbl  %dh, %eax
shrq    $16, %rdx
movzbl  BitReverseTable256(%rax), %eax
salq    $16, %rax
orq     %rax, %rcx
movzbq  %dl,%rax
shrq    $16, %rdx
movzbl  BitReverseTable256(%rax), %eax
salq    $8, %rax
orq     %rax, %rcx
movzbq  %dl,%rax
shrq    $8, %rdx
movzbl  BitReverseTable256(%rax), %eax
salq    $56, %rax
orq     %rax, %rcx
movzbq  %dl,%rax
shrq    $8, %rdx
movzbl  BitReverseTable256(%rax), %eax
andl    $255, %edx
salq    $48, %rax
orq     %rax, %rcx
movzbl  BitReverseTable256(%rdx), %eax
salq    $40, %rax
orq     %rax, %rcx
movq    %rcx, (%r13,%rsi)
addq    $8, %rsi
cmpq    $400000000, %rsi
jne     .L3 
```

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2014-06-05T10:55:28.287

这个线程引起了我的注意，因为它处理一个简单的问题，即使是现代 CPU 也需要大量工作（CPU 周期）。有一天，我也站在那里，遇到了同样的 ¤#%"#" 问题。我不得不翻转数百万字节。但是我知道我所有的目标系统都是基于现代英特尔的，所以让我们开始优化到极致吧！！！

所以我使用了 Matt J 的查找代码作为基础。我的基准测试系统是 i7 haswell 4700eq。

Matt J 的查找位翻转 400 000 000 字节：大约 0.272 秒。

然后我继续尝试查看英特尔的 ISPC 编译器是否可以对 reverse.c 中的算术进行矢量化。

我不会让你对我的发现感到厌烦，因为我尝试了很多来帮助编译器找到东西，无论如何我最终得到了大约 0.15 秒的性能来 bitflip 400 000 000 字节。这是一个很大的减少，但对于我的应用程序来说仍然太慢了..

所以人们让我介绍世界上最快的基于 Intel 的 bitflipper。计时：

位翻转 400000000 字节的时间：0.050082 秒！！！！！！

```
// Bitflip using AVX2 - The fastest Intel based bitflip in the world!!
// Made by Anders Cedronius 2014 (anders.cedronius (you know what) gmail.com)

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <omp.h>

using namespace std;

#define DISPLAY_HEIGHT  4
#define DISPLAY_WIDTH   32
#define NUM_DATA_BYTES  400000000

// Constants (first we got the mask, then the high order nibble look up table and last we got the low order nibble lookup table)
__attribute__ ((aligned(32))) static unsigned char k1[32*3]={
        0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,
        0x00,0x08,0x04,0x0c,0x02,0x0a,0x06,0x0e,0x01,0x09,0x05,0x0d,0x03,0x0b,0x07,0x0f,0x00,0x08,0x04,0x0c,0x02,0x0a,0x06,0x0e,0x01,0x09,0x05,0x0d,0x03,0x0b,0x07,0x0f,
        0x00,0x80,0x40,0xc0,0x20,0xa0,0x60,0xe0,0x10,0x90,0x50,0xd0,0x30,0xb0,0x70,0xf0,0x00,0x80,0x40,0xc0,0x20,0xa0,0x60,0xe0,0x10,0x90,0x50,0xd0,0x30,0xb0,0x70,0xf0
};

// The data to be bitflipped (+32 to avoid the quantization out of memory problem)
__attribute__ ((aligned(32))) static unsigned char data[NUM_DATA_BYTES+32]={};

extern "C" {
void bitflipbyte(unsigned char[],unsigned int,unsigned char[]);
}

int main()
{

    for(unsigned int i = 0; i < NUM_DATA_BYTES; i++)
    {
        data[i] = rand();
    }

    printf ("\r\nData in(start):\r\n");
    for (unsigned int j = 0; j < 4; j++)
    {
        for (unsigned int i = 0; i < DISPLAY_WIDTH; i++)
        {
            printf ("0x%02x,",data[i+(j*DISPLAY_WIDTH)]);
        }
        printf ("\r\n");
    }

    printf ("\r\nNumber of 32-byte chunks to convert: %d\r\n",(unsigned int)ceil(NUM_DATA_BYTES/32.0));

    double start_time = omp_get_wtime();
    bitflipbyte(data,(unsigned int)ceil(NUM_DATA_BYTES/32.0),k1);
    double end_time = omp_get_wtime();

    printf ("\r\nData out:\r\n");
    for (unsigned int j = 0; j < 4; j++)
    {
        for (unsigned int i = 0; i < DISPLAY_WIDTH; i++)
        {
            printf ("0x%02x,",data[i+(j*DISPLAY_WIDTH)]);
        }
        printf ("\r\n");
    }
    printf("\r\n\r\nTime to bitflip %d bytes: %f seconds\r\n\r\n",NUM_DATA_BYTES, end_time-start_time);

    // return with no errors
    return 0;
} 
```

printf 用于调试..

这是主力：

```
bits 64
global bitflipbyte

bitflipbyte:    
        vmovdqa     ymm2, [rdx]
        add         rdx, 20h
        vmovdqa     ymm3, [rdx]
        add         rdx, 20h
        vmovdqa     ymm4, [rdx]
bitflipp_loop:
        vmovdqa     ymm0, [rdi] 
        vpand       ymm1, ymm2, ymm0 
        vpandn      ymm0, ymm2, ymm0 
        vpsrld      ymm0, ymm0, 4h 
        vpshufb     ymm1, ymm4, ymm1 
        vpshufb     ymm0, ymm3, ymm0         
        vpor        ymm0, ymm0, ymm1
        vmovdqa     [rdi], ymm0
        add     rdi, 20h
        dec     rsi
        jnz     bitflipp_loop
        ret 
```

该代码占用 32 个字节，然后屏蔽掉半字节。高半字节向右移动 4。然后我使用 vpshufb 和 ymm4 / ymm3 作为查找表。我可以使用单个查找表，但是在再次将半字节进行 OR 运算之前，我必须向左移动。

还有更快的翻转位的方法。但我必须使用单线程和 CPU，所以这是我能达到的最快速度。你能做一个更快的版本吗？

请不要对使用英特尔 C/C++ 编译器内部等效命令发表评论...

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-01-27T23:55:43.487

对于喜欢递归的人来说，这是另一种解决方案。

这个想法很简单。将输入除以一半并交换两半，继续直到达到单个位。

```
Illustrated in the example below.

Ex : If Input is 00101010   ==> Expected output is 01010100

1\. Divide the input into 2 halves 
    0010 --- 1010

2\. Swap the 2 Halves
    1010     0010

3\. Repeat the same for each half.
    10 -- 10 ---  00 -- 10
    10    10      10    00

    1-0 -- 1-0 --- 1-0 -- 0-0
    0 1    0 1     0 1    0 0

Done! Output is 01010100 
```

这是一个递归函数来解决它。（注意我使用了无符号整数，因此它可以用于最大 sizeof(unsigned int)*8 位的输入。

> 递归函数采用 2 个参数 - 需要反转其位的值和值中的位数。

```
int reverse_bits_recursive(unsigned int num, unsigned int numBits)
{
    unsigned int reversedNum;;
    unsigned int mask = 0;

    mask = (0x1 << (numBits/2)) - 1;

    if (numBits == 1) return num;
    reversedNum = reverse_bits_recursive(num >> numBits/2, numBits/2) |
                   reverse_bits_recursive((num & mask), numBits/2) << numBits/2;
    return reversedNum;
}

int main()
{
    unsigned int reversedNum;
    unsigned int num;

    num = 0x55;
    reversedNum = reverse_bits_recursive(num, 8);
    printf ("Bit Reversal Input = 0x%x Output = 0x%x\n", num, reversedNum);

    num = 0xabcd;
    reversedNum = reverse_bits_recursive(num, 16);
    printf ("Bit Reversal Input = 0x%x Output = 0x%x\n", num, reversedNum);

    num = 0x123456;
    reversedNum = reverse_bits_recursive(num, 24);
    printf ("Bit Reversal Input = 0x%x Output = 0x%x\n", num, reversedNum);

    num = 0x11223344;
    reversedNum = reverse_bits_recursive(num,32);
    printf ("Bit Reversal Input = 0x%x Output = 0x%x\n", num, reversedNum);
} 
```

这是输出：

```
Bit Reversal Input = 0x55 Output = 0xaa
Bit Reversal Input = 0xabcd Output = 0xb3d5
Bit Reversal Input = 0x123456 Output = 0x651690
Bit Reversal Input = 0x11223344 Output = 0x22cc4488 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-06-08T00:11:32.107

好吧，这肯定不会是像 Matt J 那样的答案，但希望它仍然有用。

```
size_t reverse(size_t n, unsigned int bytes)
{
    __asm__("BSWAP %0" : "=r"(n) : "0"(n));
    n >>= ((sizeof(size_t) - bytes) * 8);
    n = ((n & 0xaaaaaaaaaaaaaaaa) >> 1) | ((n & 0x5555555555555555) << 1);
    n = ((n & 0xcccccccccccccccc) >> 2) | ((n & 0x3333333333333333) << 2);
    n = ((n & 0xf0f0f0f0f0f0f0f0) >> 4) | ((n & 0x0f0f0f0f0f0f0f0f) << 4);
    return n;
} 
```

这与 Matt 的最佳算法完全相同，只是有一条名为 BSWAP 的小指令交换 64 位数字的字节（而不是位）。所以 b7,b6,b5,b4,b3,b2,b1,b0 变为 b0,b1,b2,b3,b4,b5,b6,b7。由于我们使用的是 32 位数字，我们需要将字节交换后的数字向下移动 32 位。这只是让我们完成交换每个字节的 8 位的任务，瞧！我们完成了。

时间安排：在我的机器上，Matt 的算法每次试验的运行时间约为 0.52 秒。我的每次试验运行时间约为 0.42 秒。我认为快 20% 还不错。

如果您担心 BSWAP 指令的可用性，[维基百科](http://en.wikipedia.org/wiki/X86_instruction_listings)将 BSWAP 指令列为 1989 年推出的 80846 添加的指令。应该注意的是，维基百科还声明该指令仅适用于 32 位寄存器，这显然不是在我的机器上，它非常适用于 64 位寄存器。

此方法对于任何整数数据类型都同样适用，因此可以通过传递所需的字节数来简单地概括该方法：

```
 size_t reverse(size_t n, unsigned int bytes)
    {
        __asm__("BSWAP %0" : "=r"(n) : "0"(n));
        n >>= ((sizeof(size_t) - bytes) * 8);
        n = ((n & 0xaaaaaaaaaaaaaaaa) >> 1) | ((n & 0x5555555555555555) << 1);
        n = ((n & 0xcccccccccccccccc) >> 2) | ((n & 0x3333333333333333) << 2);
        n = ((n & 0xf0f0f0f0f0f0f0f0) >> 4) | ((n & 0x0f0f0f0f0f0f0f0f) << 4);
        return n;
    } 
```

然后可以这样调用：

```
 n = reverse(n, sizeof(char));//only reverse 8 bits
    n = reverse(n, sizeof(short));//reverse 16 bits
    n = reverse(n, sizeof(int));//reverse 32 bits
    n = reverse(n, sizeof(size_t));//reverse 64 bits 
```

编译器应该能够优化额外的参数（假设编译器内联函数）并且在这种`sizeof(size_t)`情况下将完全删除右移。请注意，如果通过了，GCC 至少无法删除 BSWAP 和右移`sizeof(char)`。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2015-08-19T10:34:31.560

[Anders Cedronius 的回答](https://stackoverflow.com/a/24058332/780717)为拥有支持 AVX2 的 x86 CPU 的人提供了一个很好的解决方案。对于不支持 AVX 的 x86 平台或非 x86 平台，以下任一实现应该都能正常工作。

第一个代码是经典二进制分区方法的变体，其编码是为了最大限度地利用在各种 ARM 处理器上有用的 shift-plus-logic 习惯用法。此外，它使用动态掩码生成，这对于需要多条指令来加载每个 32 位掩码值的 RISC 处理器可能是有益的。x86 平台的编译器应该在编译时而不是运行时使用常量传播来计算所有掩码。

```
/* Classic binary partitioning algorithm */
inline uint32_t brev_classic (uint32_t a)
{
    uint32_t m;
    a = (a >> 16) | (a << 16);                            // swap halfwords
    m = 0x00ff00ff; a = ((a >> 8) & m) | ((a << 8) & ~m); // swap bytes
    m = m^(m << 4); a = ((a >> 4) & m) | ((a << 4) & ~m); // swap nibbles
    m = m^(m << 2); a = ((a >> 2) & m) | ((a << 2) & ~m);
    m = m^(m << 1); a = ((a >> 1) & m) | ((a << 1) & ~m);
    return a;
} 
```

在“计算机编程的艺术”的第 4A 卷中，D. Knuth 展示了巧妙的位反转方法，这些方法令人惊讶地比经典的二进制分区算法需要更少的操作。Hacker's Delight 网站上的[这份文档](http://www.hackersdelight.org/revisions.pdf)中显示了一种用于 32 位操作数的算法，我在 TAOCP 中找不到。

```
/* Knuth's algorithm from http://www.hackersdelight.org/revisions.pdf. Retrieved 8/19/2015 */
inline uint32_t brev_knuth (uint32_t a)
{
    uint32_t t;
    a = (a << 15) | (a >> 17);
    t = (a ^ (a >> 10)) & 0x003f801f; 
    a = (t + (t << 10)) ^ a;
    t = (a ^ (a >>  4)) & 0x0e038421; 
    a = (t + (t <<  4)) ^ a;
    t = (a ^ (a >>  2)) & 0x22488842; 
    a = (t + (t <<  2)) ^ a;
    return a;
} 
```

使用英特尔编译器 C/C++ 编译器 13.1.3.198，上述两个函数都能很好地自动向量化目标`XMM`寄存器。它们也可以在不费力的情况下手动矢量化。

在我的 IvyBridge Xeon E3 1270v2 上，使用自动矢量化代码，使用 0.070 秒和使用 0.068 秒对1 亿个`uint32_t`字进行位反转。我注意确保我的基准测试不受系统内存带宽的限制。`brev_classic()``brev_knuth()`

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-04-14T03:15:44.777

假设你有一个位数组，如何： 1\. 从 MSB 开始，将位一个一个地压入堆栈。2\. 将此堆栈中的位弹出到另一个数组（或者如果您想节省空间，则使用相同的数组），将第一个弹出的位放入 MSB 并从那里继续到较低有效位。

```
Stack stack = new Stack();
Bit[] bits = new Bit[] { 0, 0, 1, 0, 0, 0, 0, 0 };

for (int i = 0; i < bits.Length; i++) 
{
    stack.push(bits[i]);
}

for (int i = 0; i < bits.Length; i++)
{
    bits[i] = stack.pop();
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-04-05T22:11:35.113

原生 ARM 指令“rbit”可以用 1 个 cpu 周期和 1 个额外的 cpu 寄存器来完成，无法击败。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-12-12T06:22:29.603

**这不是人类的工作！** *...但非常适合机器*

这是 2015 年，距离第一次提出这个问题已有 6 年。编译器从此成为我们的主人，而我们作为人类的工作只是帮助他们。那么，将我们的意图传达给机器的最佳方式是什么？

位反转是如此普遍，以至于您不得不想知道为什么 x86 不断增长的 ISA 不包含一次性完成的指令。

原因：如果您将真正简洁的意图提供给编译器，位反转应该只需要**~20 个 CPU 周期**。让我向您展示如何制作 reverse() 并使用它：

```
#include <inttypes.h>
#include <stdio.h>

uint64_t reverse(const uint64_t n,
                 const uint64_t k)
{
        uint64_t r, i;
        for (r = 0, i = 0; i < k; ++i)
                r |= ((n >> i) & 1) << (k - i - 1);
        return r;
}

int main()
{
        const uint64_t size = 64;
        uint64_t sum = 0;
        uint64_t a;
        for (a = 0; a < (uint64_t)1 << 30; ++a)
                sum += reverse(a, size);
        printf("%" PRIu64 "\n", sum);
        return 0;
} 
```

使用 Clang 版本 >= 3.6、-O3、-march=native（使用 Haswell 测试）编译此示例程序，使用新的 AVX2 指令提供艺术品质量的代码，运行时间为**11 秒**，处理约 10 亿个 reverse()s。每个 reverse() 大约 10 ns，假设 2 GHz 的 CPU 周期为 0.5 ns，这使我们处于 20 个甜蜜的 CPU 周期。

*   *对于单个大型数组，您可以在访问 RAM 一次所需的时间内容纳 10 个 reverse()！*
*   *您可以在访问 L2 缓存 LUT 两次所需的时间内适应 1 reverse()。*

警告：这个示例代码应该可以作为一个不错的基准测试几年，但是一旦编译器足够聪明，可以优化 main() 以仅打印最终结果而不是真正计算任何东西，它最终将开始显示它的年龄。但现在它适用于展示 reverse()。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-04-14T07:49:09.783

当然，bit-twiddling hacks 的明显来源在这里： http: [//graphics.stanford.edu/~seander/bithacks.html#BitReverseObvious](http://graphics.stanford.edu/~seander/bithacks.html#BitReverseObvious)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-10-30T08:38:11.737

以低内存和最快的方式实现。

```
private Byte  BitReverse(Byte bData)
    {
        Byte[] lookup = { 0, 8,  4, 12, 
                          2, 10, 6, 14 , 
                          1, 9,  5, 13,
                          3, 11, 7, 15 };
        Byte ret_val = (Byte)(((lookup[(bData & 0x0F)]) << 4) + lookup[((bData & 0xF0) >> 4)]);
        return ret_val;
    } 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2011-11-09T12:17:09.380

嗯，这与第一个“reverse()”基本相同，但它是 64 位的，只需要从指令流中加载一个立即掩码。GCC 创建没有跳转的代码，所以这应该很快。

```
#include <stdio.h>

static unsigned long long swap64(unsigned long long val)
{
#define ZZZZ(x,s,m) (((x) >>(s)) & (m)) | (((x) & (m))<<(s));
/* val = (((val) >>16) & 0xFFFF0000FFFF) | (((val) & 0xFFFF0000FFFF)<<16); */

val = ZZZZ(val,32,  0x00000000FFFFFFFFull );
val = ZZZZ(val,16,  0x0000FFFF0000FFFFull );
val = ZZZZ(val,8,   0x00FF00FF00FF00FFull );
val = ZZZZ(val,4,   0x0F0F0F0F0F0F0F0Full );
val = ZZZZ(val,2,   0x3333333333333333ull );
val = ZZZZ(val,1,   0x5555555555555555ull );

return val;
#undef ZZZZ
}

int main(void)
{
unsigned long long val, aaaa[16] =
 { 0xfedcba9876543210,0xedcba9876543210f,0xdcba9876543210fe,0xcba9876543210fed
 , 0xba9876543210fedc,0xa9876543210fedcb,0x9876543210fedcba,0x876543210fedcba9
 , 0x76543210fedcba98,0x6543210fedcba987,0x543210fedcba9876,0x43210fedcba98765
 , 0x3210fedcba987654,0x210fedcba9876543,0x10fedcba98765432,0x0fedcba987654321
 };
unsigned iii;

for (iii=0; iii < 16; iii++) {
    val = swap64 (aaaa[iii]);
    printf("A[]=%016llX Sw=%016llx\n", aaaa[iii], val);
    }
return 0;
} 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2015-04-26T17:56:43.017

我很好奇明显的原始旋转会有多快。在我的机器 (i7@2600) 上，1,500,150,000 次迭代的平均值是`27.28 ns`（超过 131,071 个 64 位整数的随机集合）。

优点：所需内存少，代码简单。我会说它也没有那么大。对于任何输入（128 次算术 SHIFT 运算 + 64 次逻辑 AND 运算 + 64 次逻辑 OR 运算），所需时间都是可预测且恒定的。

我与@Matt J 获得的最佳时间进行了比较，后者的答案已被接受。如果我正确地阅读了他的答案，他得到的最好结果是迭代`0.631739`秒数`1,000,000`，这导致平均`631 ns`每次旋转。

我使用的代码片段如下：

```
unsigned long long reverse_long(unsigned long long x)
{
    return (((x >> 0) & 1) << 63) |
           (((x >> 1) & 1) << 62) |
           (((x >> 2) & 1) << 61) |
           (((x >> 3) & 1) << 60) |
           (((x >> 4) & 1) << 59) |
           (((x >> 5) & 1) << 58) |
           (((x >> 6) & 1) << 57) |
           (((x >> 7) & 1) << 56) |
           (((x >> 8) & 1) << 55) |
           (((x >> 9) & 1) << 54) |
           (((x >> 10) & 1) << 53) |
           (((x >> 11) & 1) << 52) |
           (((x >> 12) & 1) << 51) |
           (((x >> 13) & 1) << 50) |
           (((x >> 14) & 1) << 49) |
           (((x >> 15) & 1) << 48) |
           (((x >> 16) & 1) << 47) |
           (((x >> 17) & 1) << 46) |
           (((x >> 18) & 1) << 45) |
           (((x >> 19) & 1) << 44) |
           (((x >> 20) & 1) << 43) |
           (((x >> 21) & 1) << 42) |
           (((x >> 22) & 1) << 41) |
           (((x >> 23) & 1) << 40) |
           (((x >> 24) & 1) << 39) |
           (((x >> 25) & 1) << 38) |
           (((x >> 26) & 1) << 37) |
           (((x >> 27) & 1) << 36) |
           (((x >> 28) & 1) << 35) |
           (((x >> 29) & 1) << 34) |
           (((x >> 30) & 1) << 33) |
           (((x >> 31) & 1) << 32) |
           (((x >> 32) & 1) << 31) |
           (((x >> 33) & 1) << 30) |
           (((x >> 34) & 1) << 29) |
           (((x >> 35) & 1) << 28) |
           (((x >> 36) & 1) << 27) |
           (((x >> 37) & 1) << 26) |
           (((x >> 38) & 1) << 25) |
           (((x >> 39) & 1) << 24) |
           (((x >> 40) & 1) << 23) |
           (((x >> 41) & 1) << 22) |
           (((x >> 42) & 1) << 21) |
           (((x >> 43) & 1) << 20) |
           (((x >> 44) & 1) << 19) |
           (((x >> 45) & 1) << 18) |
           (((x >> 46) & 1) << 17) |
           (((x >> 47) & 1) << 16) |
           (((x >> 48) & 1) << 15) |
           (((x >> 49) & 1) << 14) |
           (((x >> 50) & 1) << 13) |
           (((x >> 51) & 1) << 12) |
           (((x >> 52) & 1) << 11) |
           (((x >> 53) & 1) << 10) |
           (((x >> 54) & 1) << 9) |
           (((x >> 55) & 1) << 8) |
           (((x >> 56) & 1) << 7) |
           (((x >> 57) & 1) << 6) |
           (((x >> 58) & 1) << 5) |
           (((x >> 59) & 1) << 4) |
           (((x >> 60) & 1) << 3) |
           (((x >> 61) & 1) << 2) |
           (((x >> 62) & 1) << 1) |
           (((x >> 63) & 1) << 0);
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2012-05-31T17:13:01.180

您可能想要使用标准模板库。它可能比上面提到的代码慢。但是，在我看来，它更清晰，更容易理解。

```
 #include<bitset>
 #include<iostream>

 template<size_t N>
 const std::bitset<N> reverse(const std::bitset<N>& ordered)
 {
      std::bitset<N> reversed;
      for(size_t i = 0, j = N - 1; i < N; ++i, --j)
           reversed[j] = ordered[i];
      return reversed;
 };

 // test the function
 int main()
 {
      unsigned long num; 
      const size_t N = sizeof(num)*8;

      std::cin >> num;
      std::cout << std::showbase << std::hex;
      std::cout << "ordered  = " << num << std::endl;
      std::cout << "reversed = " << reverse<N>(num).to_ulong()  << std::endl;
      std::cout << "double_reversed = " << reverse<N>(reverse<N>(num)).to_ulong() << std::endl;  
 } 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-04-14T04:50:24.830

**通用的**

C 代码。以 1 字节输入数据 num 为例。

```
 unsigned char num = 0xaa;   // 1010 1010 (aa) -> 0101 0101 (55)
    int s = sizeof(num) * 8;    // get number of bits
    int i, x, y, p;
    int var = 0;                // make var data type to be equal or larger than num

    for (i = 0; i < (s / 2); i++) {
        // extract bit on the left, from MSB
        p = s - i - 1;
        x = num & (1 << p);
        x = x >> p;
        printf("x: %d\n", x);

        // extract bit on the right, from LSB
        y = num & (1 << i);
        y = y >> i;
        printf("y: %d\n", y);

        var = var | (x << i);       // apply x
        var = var | (y << p);       // apply y
    }

    printf("new: 0x%x\n", new); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-09-19T22:11:36.250

以下情况如何：

```
 uint reverseMSBToLSB32ui(uint input)
    {
        uint output = 0x00000000;
        uint toANDVar = 0;
        int places = 0;

        for (int i = 1; i < 32; i++)
        {
            places = (32 - i);
            toANDVar = (uint)(1 << places);
            output |= (uint)(input & (toANDVar)) >> places;

        }

        return output;
    } 
```

小而简单（不过，仅限 32 位）。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-12-18T16:02:47.927

我认为这是反转位的最简单方法之一。请让我知道这个逻辑是否有任何缺陷。基本上在这个逻辑中，我们检查位置位的值。如果在反向位置值为 1，则设置该位。

```
void bit_reverse(ui32 *data)
{
  ui32 temp = 0;    
  ui32 i, bit_len;    
  {    
   for(i = 0, bit_len = 31; i <= bit_len; i++)   
   {    
    temp |= (*data & 1 << i)? (1 << bit_len-i) : 0;    
   }    
   *data = temp;    
  }    
  return;    
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-05-08T11:24:28.277

```
unsigned char ReverseBits(unsigned char data)
{
    unsigned char k = 0, rev = 0;

    unsigned char n = data;

    while(n)

    {
        k = n & (~(n - 1));
        n &= (n - 1);
        rev |= (128 / k);
    }
    return rev;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-06-09T17:35:01.237

我认为我知道的最简单的方法如下。`MSB`是输入并且`LSB`是“反转”输出：

```
unsigned char rev(char MSB) {
    unsigned char LSB=0;  // for output
    _FOR(i,0,8) {
        LSB= LSB << 1;
        if(MSB&1) LSB = LSB | 1;
        MSB= MSB >> 1;
    }
    return LSB;
}

//    It works by rotating bytes in opposite directions. 
//    Just repeat for each byte. 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-09-17T04:51:58.880

```
// Purpose: to reverse bits in an unsigned short integer 
// Input: an unsigned short integer whose bits are to be reversed
// Output: an unsigned short integer with the reversed bits of the input one
unsigned short ReverseBits( unsigned short a )
{
     // declare and initialize number of bits in the unsigned short integer
     const char num_bits = sizeof(a) * CHAR_BIT;

     // declare and initialize bitset representation of integer a
     bitset<num_bits> bitset_a(a);          

     // declare and initialize bitset representation of integer b (0000000000000000)
     bitset<num_bits> bitset_b(0);                  

     // declare and initialize bitset representation of mask (0000000000000001)
     bitset<num_bits> mask(1);          

     for ( char i = 0; i < num_bits; ++i )
     {
          bitset_b = (bitset_b << 1) | bitset_a & mask;
          bitset_a >>= 1;
     }

     return (unsigned short) bitset_b.to_ulong();
}

void PrintBits( unsigned short a )
{
     // declare and initialize bitset representation of a
     bitset<sizeof(a) * CHAR_BIT> bitset(a);

     // print out bits
     cout << bitset << endl;
}

// Testing the functionality of the code

int main ()
{
     unsigned short a = 17, b;

     cout << "Original: "; 
     PrintBits(a);

     b = ReverseBits( a );

     cout << "Reversed: ";
     PrintBits(b);
}

// Output:
Original: 0000000000010001
Reversed: 1000100000000000 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-09-05T21:26:32.320

另一种基于循环的解决方案，在数量较少时快速退出（在 C++ 中用于多种类型）

```
template<class T>
T reverse_bits(T in) {
    T bit = static_cast<T>(1) << (sizeof(T) * 8 - 1);
    T out;

    for (out = 0; bit && in; bit >>= 1, in >>= 1) {
        if (in & 1) {
            out |= bit;
        }
    }
    return out;
} 
```

或在 C 中用于 unsigned int

```
unsigned int reverse_bits(unsigned int in) {
    unsigned int bit = 1u << (sizeof(T) * 8 - 1);
    unsigned int out;

    for (out = 0; bit && in; bit >>= 1, in >>= 1) {
        if (in & 1)
            out |= bit;
    }
    return out;
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-04-24T08:40:30.840

似乎许多其他帖子都关注速度（即最好=最快）。简单又如何？考虑：

```
char ReverseBits(char character) {
    char reversed_character = 0;
    for (int i = 0; i < 8; i++) {
        char ith_bit = (c >> i) & 1;
        reversed_character |= (ith_bit << (sizeof(char) - 1 - i));
    }
    return reversed_character;
} 
```

并希望聪明的编译器会为你优化。

如果要反转更长的位列表（包含`sizeof(char) * n`位），可以使用此函数获得：

```
void ReverseNumber(char* number, int bit_count_in_number) {
    int bytes_occupied = bit_count_in_number / sizeof(char);      

    // first reverse bytes
    for (int i = 0; i <= (bytes_occupied / 2); i++) {
        swap(long_number[i], long_number[n - i]);
    }

    // then reverse bits of each individual byte
    for (int i = 0; i < bytes_occupied; i++) {
         long_number[i] = ReverseBits(long_number[i]);
    }
} 
```

这会将 [10000000, 10101010] 反转为 [01010101, 00000001]。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-09-26T16:51:16.053

高效可能意味着吞吐量或延迟。

在整个过程中，请参阅 Anders Cedronius 的答案，这是一个很好的答案。

为了降低延迟，我建议使用以下代码：

```
uint32_t reverseBits( uint32_t x )
{
#if defined(__arm__) || defined(__aarch64__)
    __asm__( "rbit %0, %1" : "=r" ( x ) : "r" ( x ) );
    return x;
#endif
    // Flip pairwise
    x = ( ( x & 0x55555555 ) << 1 ) | ( ( x & 0xAAAAAAAA ) >> 1 );
    // Flip pairs
    x = ( ( x & 0x33333333 ) << 2 ) | ( ( x & 0xCCCCCCCC ) >> 2 );
    // Flip nibbles
    x = ( ( x & 0x0F0F0F0F ) << 4 ) | ( ( x & 0xF0F0F0F0 ) >> 4 );

    // Flip bytes. CPUs have an instruction for that, pretty fast one.
#ifdef _MSC_VER
    return _byteswap_ulong( x );
#elif defined(__INTEL_COMPILER)
    return (uint32_t)_bswap( (int)x );
#else
    // Assuming gcc or clang
    return __builtin_bswap32( x );
#endif
} 
```

编译器输出：[https ://godbolt.org/z/5ehd89](https://godbolt.org/z/5ehd89)

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2013-06-05T10:25:26.170

伪代码中的位反转

源 -> 要反转的字节 b00101100 目标 -> 反转，也需要是无符号类型，因此符号位不会向下传播

复制到 temp 所以原始不受影响，还需要是无符号类型，以便符号位不会自动移入

```
bytecopy = b0010110 
```

LOOP8: //如果 bytecopy < 0（负数），执行 8 次测试

```
 set bit8 (msb) of reversed = reversed | b10000000 

else do not set bit8

shift bytecopy left 1 place
bytecopy = bytecopy << 1 = b0101100 result

shift result right 1 place
reversed = reversed >> 1 = b00000000
8 times no then up^ LOOP8
8 times yes then done. 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2015-08-19T08:49:24.113

这是针对 32 位的，如果我们考虑 8 位，我们需要更改大小。

```
 void bitReverse(int num)
    {
        int num_reverse = 0;
        int size = (sizeof(int)*8) -1;
        int i=0,j=0;
        for(i=0,j=size;i<=size,j>=0;i++,j--)
        {
            if((num >> i)&1)
            {
                num_reverse = (num_reverse | (1<<j));
            }
        }
        printf("\n rev num = %d\n",num_reverse);
    } 
```

以 LSB->MSB 顺序读取输入整数“num”并以 MSB->LSB 顺序存储在 num_reverse 中。

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2016-08-17T12:52:56.110

我的简单解决方案

```
BitReverse(IN)
    OUT = 0x00;
    R = 1;      // Right mask   ...0000.0001
    L = 0;      // Left mask    1000.0000...
    L = ~0; 
    L = ~(i >> 1);
    int size = sizeof(IN) * 4;  // bit size

    while(size--){
        if(IN & L) OUT = OUT | R; // start from MSB  1000.xxxx
        if(IN & R) OUT = OUT | L; // start from LSB  xxxx.0001
        L = L >> 1;
        R = R << 1; 
    }
    return OUT; 
```

# django - 带有 CheckboxSelectMultiple 的表单不验证

> ID：746173
> 
> 赞同：21
> 
> 时间：2009-04-14T02:50:17.740
> 
> 标签：django, django-forms

我有一个带有使用 CheckboxSelectMultiple 小部件的选择字段的表单：

```
foo = forms.ChoiceField(widget=forms.CheckboxSelectMultiple,
                        choices=(
                                  ("1", "ONE"),
                                  ("2", "TWO"),
                                 )) 
```

表单显示两个复选框很好，但它不验证。

如果我同时选中这两个复选框，我会收到错误消息：选择一个有效的选择。[u'1', u'2'] 不是可用选项之一

选择一个复选框也不起作用，它给了我：选择一个有效的选择。[u'1'] 不是可用的选项之一。

这里发生了什么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-14T03:52:52.393

如果您将该字段设置为 forms.MultipleChoiceField 而不是 forms.ChoiceField 它会更好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-08-03T05:25:52.877

愿这对你有帮助

```
num_choices = ( ("1", "ONE"), ("2", "TWO"), ("3", "Three"), ("4", "Four"))

num_list = forms.MultipleChoiceField(choices=num_choices, required=True, widget=forms.CheckboxSelectMultiple(), label='Select No', initial=("1", "2")) 
```

如果你想直接传递ORM对象，那么你可以试试下面的

```
num_list = forms.ModelMultipleChoiceField(Numbers.objects.all(), required=True, widget=forms.CheckboxSelectMultiple(), label='Select No') 
```

# vba - 如何总结日期计数

> ID：746177
> 
> 赞同：1
> 
> 时间：2009-04-14T02:51:30.140
> 
> 标签：vba, excel, pivot-table

我有 3 个工作表。以下是对我正在尝试做的事情的解释。EM11 EM12 EM01

以下步骤适用于工作表 EM11，但我想对工作表 EM12 和工作表 EM01 重复这些步骤

*   选择工作表 EM11
*   复制 J2:J65636 并复制 G2:G65636
*   创建一个名为 EM11-Count 的新工作表
*   将 J 列粘贴到名为 EM11-Count 的新工作表的单元格 A2 中
*   将 G 列粘贴到新工作表的单元格 B2 中。

*   名为 EM11-Count 的工作表现在的日期范围为 B2:B65636。

*   复制并粘贴您进入单元格 C1 的第一个日期
*   复制并粘贴您进入单元格 D1 的第二个日期
*   复制并粘贴您进入单元格 E1 的第三个日期
*   复制并粘贴您进入单元格 F1 的第四个日期
*   复制并粘贴您进入单元格 G1 的第五个日期
*   复制并粘贴您进入单元格 H1 的第六个日期（只有六个或七个不同的日期）

现在工作表看起来像这样

```
Col A  Col B       Col C      Col D      Col E       
                   04/1/2009  04/2/2009  04/3/2009
DPR1   04/1/2009            
DRS6   04/2/2009            
ERJ9   04/3/2009 
```

看 A2:B2。现在查看 C1:H1 以查找与您在 B2 中的日期匹配的日期。假设 C1 有匹配的日期。转到C2并输入数字1。

```
Col A  Col B       Col C      Col D      Col E       
                   04/1/2009  04/2/2009  04/3/2009
DPR1   04/1/2009   1        
DRS6   04/2/2009            
ERJ9   04/3/2009 
```

接下来看看 A3:B3。现在查看 C1:H1 以找到与 B3 中的日期匹配的日期。假设 D1 有匹配的日期。转到 D3 并输入数字 1。

```
Col A  Col B       Col C      Col D      Col E       
                   04/1/2009  04/2/2009  04/3/2009
DPR1   04/1/2009   1        
DRS6   04/2/2009              1         
ERJ9   04/3/2009 
```

接下来看看 A4:B4。现在查看 C1:H1 以找到与 B4 中的日期匹配的日期。假设 E1 有匹配的日期。转到E3并输入数字1。

```
Col A  Col B       Col C      Col D      Col E       
                   04/1/2009  04/2/2009  04/3/2009
DPR1   04/1/2009   1        
DRS6   04/2/2009              1         
ERJ9   04/3/2009                         1 
```

现在重复这个模式，直到 A:B 中的每一行都被覆盖。将出现 A:B 列中的每一行随机重复。例如，A1:B1 中的内容与 A2:B7 相同，或者 A14:B14 中的内容与 A15:B20 相同。当这些重复发生时，我想删除重复的行，但将原始行的计数/计数增加数字“1”。例如，宏完成扫描 A:B 后，工作表可能如下所示

```
Col A  Col B       Col C      Col D      Col E       
                   04/1/2009  04/2/2009  04/3/2009
DPR1   04/1/2009   12       
DRS6   04/2/2009              23            
ERJ9   04/3/2009                         57 
```

这是我目前拥有的代码。我相信你可以看到它需要做很多工作。你能帮助我吗？

```
Sub NWorksheetArrange()
    Application.Goto Reference:="R2C10:R65000C10"
    Selection.Copy
    Sheets.Add
    ActiveSheet.Paste
    Sheets("Sheet3").Select
    Sheets("Sheet3").Name = "EM11-COUNT"
    Sheets("EM11").Select
    Application.Goto Reference:="R2C7:R65000C7"
    Application.CutCopyMode = False
    Selection.Copy
    Sheets("EM11-COUNT").Select
    Range("B1").Select
    ActiveSheet.Paste
    Rows("1:1").Select
    Application.CutCopyMode = False
    Selection.Insert Shift:=xlDown
    Range("B2").Select
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T03:52:58.400

这听起来很像“数据透视表”……而 Excel 会自动执行这些操作。

像这样：[http ://screencast.com/t/gpLsU50q38](http://screencast.com/t/gpLsU50q38)

要制作构建数据透视表的宏，请执行“宏记录”...然后构建数据透视表...然后将您的代码包装在记录的数据透视表语句周围。

# asp.net - 使 ASP.NET Web 服务输出 RSS 源

> ID：746181
> 
> 赞同：0
> 
> 时间：2009-04-14T02:52:33.490
> 
> 标签：asp.net, web-services, rss

我一直在编写一些 Web 服务以供几个不同的客户端应用程序使用，并且我正在尝试编写一个简单地输出 RSS XML 提要的 Web 服务方法。

我可以使用 XmlTextWriter 对象创建 XML

然后我尝试输出到响应（就像我过去在它是一个 aspx 页面时所做的那样），但这仅适用于返回类型为 void （并且似乎仍然无法正确输出）

然后我尝试将返回类型设为字符串并使用 StringWriter 从 XmlTextWriter 输出 xml，但输出随后被包装在标签中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T03:20:03.690

显然，像往常一样创建接口和 WCF 服务的其余部分。

使用以下属性标记类

```
[ServiceBehavior(InstanceContextMode=InstanceContextMode.Single)] 
```

然后这个函数

```
public Stream GetRSS()
{
 string output;
 //output = some_text;
 MemoryStream ms = new MemoryStream(System.Text.Encoding.UTF8.GetBytes(output));
 WebOperationContext.Current.OutgoingResponse.ContentType = "text/xml";
 return ms;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T03:19:03.693

我有一些代码，但它非常适合 SO 帖子（大约 1000 行）。真的没那么难。架构很简单，您可以自己完成，但您不必这样做：您可以插入几个组件来为您创建 xml。

你应该看到这个问题：
[ASP.Net RSS feed](https://stackoverflow.com/questions/57287/asp-net-rss-feed)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T04:03:38.780

如果必须使用 ASMX，则可以返回 XmlDocument。随心所欲地构建提要 XML，然后从您的 Web 方法返回 XmlDocument。

# silverlight - 如何在代码中将 tabitem 添加到 silverlight tabcontrol

> ID：746183
> 
> 赞同：1
> 
> 时间：2009-04-14T02:53:37.497
> 
> 标签：silverlight, controls

这似乎不起作用： TabItem tabItem = new TabItem(); tabItem.Header = "新标签页"; tabItem.Content = "内容"; tabControl.Items.Add(tabItem);

有人已经将 TabItem 动态添加到 TabControl 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T15:45:09.913

为我工作

```
TabItem item = new TabItem();
item.Header = "Test Header";
item.Content = "Some Text";

Tabs.Items.Add(item); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-18T09:51:19.110

```
TabControl tc = new TabControl(); 
tc.Width = 400;
tc.Height = 300;

TabItem ti = new TabItem();
ti.Header = "Tab Header";
ti.Content = "Tab Content";

tc.Items.Add(ti);
LayoutRoot.Children.Remove(tc);
LayoutRoot.Children.Add(tc); 
```

# cocoa - mutilDocument 环境下如何禁用 Quit 功能？

> ID：746187
> 
> 赞同：0
> 
> 时间：2009-04-14T02:57:02.137
> 
> 标签：cocoa, cocoa-sheet

我有一个 mutilDocument App ，我发现当我使用以下方法打开一个窗口时：

```
[NSApp beginSheet: [MultiWin window] modalForWindow: mainWindows modalDelegate: nil didEndSelector: nil  contextInfo: nil]; 
```

mainmeny 中的 Quit func 已经高亮了，这会让用户混淆 Quit app func 可以在这个环境下工作。我想禁用该下的 Quit func，怎么办？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T12:58:47.510

您应该在窗口控制器类中实现 validateMenuItem:。查看[NSMenuValidation 协议参考](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Protocols/NSMenuValidation_Protocol/Reference/Reference.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T03:27:18.087

为菜单项添加一个插座，在 IB 中连接它，然后在开始工作表后将其设置`enabled`为，然后在工作表结束回调中设置为。`NO``YES`

# c# - C#：如何捕获全局鼠标/HID 事件

> ID：746188
> 
> 赞同：0
> 
> 时间：2009-04-14T02:59:07.110
> 
> 标签：c#, hotkeys

我希望编写一个小工具，当用户按下 Windows 按钮并向上或向下滚动鼠标滚轮时，它将捕获一个全局事件。当捕获到这样的事件时，我希望将所述输出重定向到 Win-+ 或 Win-- （加/减）的虚拟击键组合。这可以做到吗？

如果 windows 键被保留， ctrl-alt 或类似的就可以了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T03:08:50.753

由于它使用 windows 键，因此可以使用热键绑定全局捕获该键。[在msdn](http://msdn.microsoft.com/en-us/library/ms646309.aspx)上注册热键。

编辑：鼠标滚轮事件似乎不像我假设的那样被视为键，并且没有办法为它们创建全局热键。

您必须制作一个全局窗口消息挂钩并捕获 WM_MOUSEWHEEL 消息。但是您可能必须在 C/C++ 中执行此操作。完成此操作的 AC dll 如下所示，您可以从 C# 调用 Hook 和 Unhook 来启用和禁用该功能。

警告：我尚未测试此代码，仅作为演示提供。

```
#include <windows.h>

HINSTANCE myInstance;
HHOOK thehook = 0;
BOOL isWinKeyDown = FALSE;

extern "C" LRESULT __declspec(dllexport)__stdcall CALLBACK HookHandler(int nCode, WPARAM wParam, LPARAM lParam) {
    if (nCode == WM_KEYDOWN && (wParam == VK_LWIN || wParam == VK_RWIN))
        isWinKeyDown = TRUE;
    else if (nCode == WM_KEYUP && (wParam == VK_LWIN || wParam == VK_RWIN))
        isWinKeyDown = FALSE;
    else if (nCode == WM_MOUSEHWHEEL && isWinKeyDown) {
        if (HIWORD(wParam) > 0) { //mousewheel up
            CallNextHookEx(thehook, WM_KEYDOWN, VK_ADD, 0);
            CallNextHookEx(thehook, WM_KEYUP, VK_ADD, 0);
        } else { //mousewheel down
            CallNextHookEx(thehook, WM_KEYDOWN, VK_SUBTRACT, 0);
            CallNextHookEx(thehook, WM_KEYUP, VK_SUBTRACT, 0);
        }
        return 0;
    }
    return CallNextHookEx(thehook, nCode, wParam, lParam);
}
BOOL WINAPI DllMain(HINSTANCE hInstance, DWORD fwdReason, LPVOID lpvReserved) {
    switch(fwdReason)
    {
        case DLL_PROCESS_ATTACH: {
            DisableThreadLibraryCalls(hInstance);
            myInstance = hInstance;

            } break;
        case DLL_THREAD_ATTACH:
            break;
        case DLL_PROCESS_DETACH:

            break;
        case DLL_THREAD_DETACH:
            break;
    }
    return(TRUE);               // The initialization was successful, a FALSE will abort
                                // the DLL attach
}

extern "C" void __declspec(dllexport) Hook() {
    if (!thehook)
        thehook = SetWindowsHookEx(WH_CALLWNDPROC, &HookHandler, myInstance, 0);
}
extern "C" void __declspec(dllexport) UnHook() {
    if (thehook)
        UnhookWindowsHookEx(thehook);
    thehook = 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T03:02:35.667

它绝对可以通过全局挂钩来完成，[这里](http://www.codeproject.com/KB/cs/globalhook.aspx)有一个很棒的 CodeProject 示例，说明如何做到这一点。

# c# - WPF MVVM 绑定 Checkbox.IsChecked 到字典中的命名项

> ID：746189
> 
> 赞同：5
> 
> 时间：2009-04-14T03:00:00.057
> 
> 标签：c#, .net, wpf, mvvm, binding-expressions

我有一组复选框，它们都代表相同类型的不同选择（例如，它们都是不同的文件类型）。我觉得将每个复选框绑定到 ViewModel 中的单个属性是多余的，我更愿意将它们全部绑定到一个集合并使用绑定语法将每个复选框按键绑定到集合中的特定项目。我试图坚持 MVVM 模式，所以我不只是想变得懒惰并处理 Checked 事件或类似的事情。

有没有办法使用 WPF 绑定语法在集合中表达路径或键？例如，如果我`Dictionary<string, bool>`在 ViewModel 中将调用的 FileTypes 作为公共属性公开，是否有办法将其中一个复选框绑定到 FileTypes["aspx"]？如果我有一个更复杂的数据结构`Dictionary<string, Dictionary<string, int>>`怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T03:29:18.567

您几乎拥有它 - 只需在 indexer 参数周围加上引号：

```
{Binding FileTypes[aspx]} 
```

更复杂的数据结构只需要一系列索引器，例如

```
{Binding Foo[aspx][Bar]} 
```

顺便说一句，MSDN 中有一个很好的资源，在 WPF > Data > Data Binding > Binding Declarations Overview 下——向下滚动到“Binding Path Syntax”，查看可以在绑定路径中使用的符号和约定的摘要.

# silverlight - Silverlight 3：ListBox DataTemplate Horizo ntalAlignment

> ID：746190
> 
> 赞同：28
> 
> 时间：2009-04-14T03:00:48.557
> 
> 标签：silverlight, listbox, datatemplate, controltemplate

我有一个 ListBox，它的 ItemTemplate 绑定到 DataTemplate。我的问题是我无法让模板中的元素拉伸到 ListBox 的整个宽度。

```
<ListBox x:Name="listPeople" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" 
    Margin="0,0,0,0" Background="{x:Null}" SelectionMode="Extended" Grid.Row="1" 
    ItemTemplate="{StaticResource PersonViewModel.BrowserDataTemplate}" 
    ItemsSource="{Binding Mode=OneWay, Path=SearchResults}" >
</ListBox>

<DataTemplate x:Key="PersonViewModel.BrowserDataTemplate">
   <ListBoxItem HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
     <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="5,5,5,5">
       <Border Opacity=".1" x:Name="itemBorder"  Background="#FF000000"   
         HorizontalAlignment="Stretch" VerticalAlignment="Stretch" 
         CornerRadius="5,5,5,5" MinWidth="100" Height="50"/>
      </Grid>
   </ListBoxItem>
</DataTemplate> 
```

如您所见，我在网格中添加了一个边框来指示模板的宽度。我的目标是看到这个边框扩展到列表框的整个宽度。目前它的宽度由它的内容或 MinWidth 决定，这是目前唯一让它保持可见的东西。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2010-04-01T05:38:35.100

我花了一个小时试图解决这个问题。非常非常令人沮丧。您**不必**重写 ListBoxItem 的整个默认样式。我无法让它工作。最后，我通过仅覆盖**ListBox.ItemContainerStyle部分中的 Horizo** **​​ntalContentAlignment**属性解决了这个问题，例如：

 **```
 <ListBox x:Name="ClassList" ItemsSource="{Binding LineClasses}"
                     ScrollViewer.VerticalScrollBarVisibility="Visible"
                     SelectionMode="Extended"
                     ScrollViewer.HorizontalScrollBarVisibility="Hidden" HorizontalContentAlignment="Stretch"
                     HorizontalAlignment="Stretch" Loaded="ClassList_Loaded"
                     VerticalAlignment="Stretch" Grid.Row="0">
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <Setter Property="HorizontalContentAlignment" Value="Stretch"></Setter>
                    </Style>
                </ListBox.ItemContainerStyle>
                    <ListBox.ItemTemplate>

                    <DataTemplate>
                        <Border BorderBrush="Black" CornerRadius="3" Background="#FFE88D34"
                            BorderThickness="1" HorizontalAlignment="Stretch" >
                            <Grid Background="Transparent" HorizontalAlignment="Stretch" >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <TextBlock 
                                    Grid.Column="0" HorizontalAlignment="Stretch"
                                    Margin="2"                                   
                                    FontSize="10"
                                    Text="{Binding DisplayClassNm}"/>
                            </Grid>

                        </Border>
                    </DataTemplate>
                </ListBox.ItemTemplate> 
```

这对我来说是一种享受。

迈尔斯

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-04-14T18:13:02.670

为 ListBox 创建数据模板时，不应包含`<ListBoxItem>`. DataTemplate 的内容将放置在生成的容器内。您可以使用 ItemContainerStyle 控制该容器的构造方式。

ListBoxItem 的默认控件样式默认用于定义 ItemContainerStyle。此样式将 ListBoxItem.Horizo​​ntalContentAlignment 属性设置为“左”。请注意 ContentPresenter 如何将其 Horizo​​ntalAlignment 绑定到此属性。

您需要覆盖绑定到 ListBox 时生成的 ListBoxItem 容器的样式。这可以通过设置 ItemContainerStyle 来完成。将 Horizo​​ntalContentAlignment 属性设置为“Stretch”。

下面是默认的 ListBoxItem 样式。包括在内以供参考。

```
<Style x:Key="ListBoxItemStyle1" TargetType="ListBoxItem">
            <Setter Property="Padding" Value="3"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="VerticalContentAlignment" Value="Top"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="TabNavigation" Value="Local"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Grid Background="{TemplateBinding Background}">
                            <!-- VSM excluded for readability -->
                            <Rectangle x:Name="fillColor" Fill="#FFBADDE9" RadiusX="1" RadiusY="1" IsHitTestVisible="False" Opacity="0"/>
                            <Rectangle x:Name="fillColor2" Fill="#FFBADDE9" RadiusX="1" RadiusY="1" IsHitTestVisible="False" Opacity="0"/>
                            <ContentPresenter x:Name="contentPresenter" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}"/>
                            <Rectangle x:Name="FocusVisualElement" Stroke="#FF6DBDD1" StrokeThickness="1" RadiusX="1" RadiusY="1" Visibility="Collapsed"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-05T17:17:14.957

[下面](http://nileshgule.blogspot.com/2011/06/ngtweet-part-3-use-silverlight-themes.html)是使用列表框控件的控件模板和数据模板的示例。请参阅扩展列表框项目边框的 XAML 标记。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T22:57:43.890

我的 ListBoxItem 包含一个 CheckBox 并且上述解决方案对我不起作用（很可能是由于 CheckBox 的性质，而不是那些解决方案）我能够通过不绑定到复选框的“内容”属性来强制执行此功能，但是明确定义 XAML 内联：

```
<CheckBox HorizontalAlignment="Stretch" IsChecked="{Binding Path=IsSelected, Mode=TwoWay}">
    <TextBlock
        MinWidth="130"
        Margin="0,-2,0,0"
        HorizontalAlignment="Stretch"
        Text="{Binding Path=DisplayText}" />
</CheckBox> 
```

需要边距，因为 TextBox 文本未与 CheckBox 的复选标记对齐。MinWidth 也是必要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-01T18:53:22.263

我正在使用带有 VS 2012 的 Silverlight 5。我有同样的问题。我有水平列表框，其中包含我自己的自定义对象作为 ItemsSource。我想要扩展列表框项目。但它们并没有扩大。我不想为每个列表框项目提供任何硬编码宽度。我在这里尝试了所有答案，但没有任何效果。我刚刚给了 ItemsSource ={Binding Persons} DisplayMemberPath="First Name"。就这样

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-14T03:22:00.707

我在这里注意到了两件事，因为我遇到了同样的问题并且无法按照您尝试的方式解决它。

首先，您不需要在 DataTemplate 中显式放置 ListBoxItem。这是自动为您创建的，因此您实际上将 ListBoxItem 包含在为您创建的项目中。[我在Snoop](http://blois.us/Snoop/)中检查了这一点以确认。

其次，我不知道确切原因，但我也无法从对齐属性中获得拉伸行为。我将其更改为使用 Width 属性上的 RelativeSource 绑定到包含 ListBoxItem 的 ActualWidth 属性。这对我有用。

```
Width="{Binding RelativeSource={RelativeSource 
   AncestorType={x:Type ListBoxItem}}, Path=ActualWidth}" 
```

如果您需要在为您隐式创建的 ListBoxItem 上设置样式属性，请在 ListBox.ItemContainerStyle 元素内使用 Style 元素。

希望这可以帮助...

# asp.net - 有什么想法可以解决共享托管问题的 kigg 信任级别？

> ID：746193
> 
> 赞同：0
> 
> 时间：2009-04-14T03:03:51.217
> 
> 标签：asp.net, security, hosting

我试图在我的服务器上设置 KIGG，但总是遇到权限问题，我知道这是因为信任级别，godaddy 总是说[http://help.godaddy.com/article/1039](http://help.godaddy.com/article/1039)

如果有人之前遇到过同样的问题，请指教。
注意：我目前无法移动到另一个主机

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T03:15:35.137

处理它的最佳方法是在 Medium Trust 中重新编译应用程序。这假设 KIGG 可以在中等信任下运行。

[更多信息](http://msdn.microsoft.com/en-us/library/ms998341.aspx)

[如何：在 ASP.NET 2.0 中使用代码访问安全性](http://msdn.microsoft.com/en-us/library/ms998326.aspx)

# entity-framework - Linq to SQL、实体框架、存储库模式和依赖注入

> ID：746195
> 
> 赞同：1
> 
> 时间：2009-04-14T03:06:10.667
> 
> 标签：entity-framework, interface, dependency-injection

Stephan Walters 关于[MVC 和模型](http://www.asp.net/learn/mvc-videos/video-403.aspx)的视频是对这个问题标题中列出的各种主题的非常好的和轻松的讨论。未回答的注释中列出的一个问题是：

**如果您为 Linq2SQL 创建接口/存储库模式，即使您将类作为 toList 传递，Linq2SQLs 类是否仍会导致对 Linq 的依赖？**

这可能是一个简单的答案是的，但是，**您将使用什么标准机制来表示数据？**

假设您有一个由三个表（价格、文本和照片）组成的产品实体（您可以有不同地区的价格集、不同的本地化文本和不同的照片）。（听起来像是构建器模式）您会创建这些表格的一部分，将正确的价格、文本和照片抓取到一个列表中吗？由于 Lists 可能是专有的，您会使用 Dictionary 对象吗？

我感谢你的回答。我对“标准和适当”的方式非常感兴趣，而不是 101 种可能性。

另一个快速的问题：Entity Framework 准备好用于复杂的数据库了吗？Linq2SQL 喜欢许多 EF 不喜欢的构造。EF 似乎需要身份字段作为主键 (HAHA)，但似乎每个演示都这样做。我想使用 EF，但我总是无法让它工作，回退到 Linq2SQL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T03:28:57.537

如果您将 L2S 保留在 Repository 外观的另一侧（请记住，这就是 Repository 的全部 - 一个外观），那么您将应用程序的其余部分与 L2S 分离。这意味着存储库背后的代码的工作是将 L2S 转换为“域”对象、自定义类，然后存储库返回这些。

从这个意义上说，存储库正在返回完整形成的“产品”对象及其所有相关的价格、文本和照片数据。这称为聚合根。

列表应该没有问题，因为它们是 CLR 对象。

至于高级场景的 EF，由于您提到的原因，我的建议还不是。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T03:46:12.910

我用来表示数据的标准机制是数据传输对象。我永远不会跨服务边界返回 LINQ to SQL 或实体框架对象，并且我会犹豫跨任何层边界返回它。这是因为这些对象将序列化依赖于实现的数据。

# log4net - 奇怪的 Silverlight 设计器错误

> ID：746198
> 
> 赞同：2
> 
> 时间：2009-04-14T03:09:09.940
> 
> 标签：log4net

在我的项目中加载任何 Xaml 时出现以下异常：

```
'/Microsoft.VisualStudio.Xaml;Component/MS/Internal/Designer/PropertyEditing/Resources/StylesCore.Constants.xaml' value cannot be assigned to property 'Source' of object 'System.Windows.ResourceDictionary'. Could not load file or assembly 'log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=1b44e1d426115821' or one of its dependencies. The system cannot find the file specified.  Error at object 'ResourceDictionary_2' in markup file 'Microsoft.VisualStudio.Xaml;component/MS/Internal/Designer/PropertyEditing/Resources/StylesCore.xaml'.
   at System.Windows.Markup.XamlParseException.ThrowException(String message, Exception innerException, Int32 lineNumber, Int32 linePosition, Uri baseUri, XamlObjectIds currentXamlObjectIds, XamlObjectIds contextXamlObjectIds, Type objectType)
   at System.Windows.Markup.XamlParseException.ThrowException(ParserContext parserContext, Int32 lineNumber, Int32 linePosition, String message, Exception innerException)
   at System.Windows.Markup.BamlRecordReader.ThrowExceptionWithLine(String message, Exception innerException)
   at System.Windows.Markup.BamlRecordReader.ReadPropertyRecordBase(String attribValue, Int16 attributeId, Int16 converterTypeId)
   at System.Windows.Markup.BamlRecordReader.ReadPropertyConverterRecord(BamlPropertyWithConverterRecord bamlPropertyRecord)
   at System.Windows.Markup.BamlRecordReader.ReadRecord(BamlRecord bamlRecord)
   at System.Windows.Markup.BamlRecordReader.Read(Boolean singleRecord)
   at System.Windows.Markup.TreeBuilderBamlTranslator.ParseFragment()
   at System.Windows.Markup.TreeBuilder.Parse()
   at System.Windows.Markup.XamlReader.LoadBaml(Stream stream, ParserContext parserContext, Object parent, Boolean closeStream)
   at System.Windows.Application.LoadBamlStreamWithSyncInfo(Stream stream, ParserContext pc)
   at System.Windows.Application.LoadComponent(Uri resourceLocator, Boolean bSkipJournaledProperties)
   at System.Windows.Application.LoadComponent(Uri resourceLocator)
   at MS.Internal.Designer.PropertyEditing.Resources.PropertyInspectorResources.GetResources()
   at MS.Internal.Designer.PropertyEditing.PropertyInspectorHost.get_Host()
   at MS.Internal.Designer.VSDesigner.VSDesignerClientImpl.get_PropertyWindow()
   at MS.Internal.Designer.VSDesignerClient.get_PropertyWindow()
   at MS.Internal.Designer.DesignerPane.LoadDesignerView() 
```

即使我在我的解决方案中生成了一个新的 SilverLight 项目，但不会在全新的解决方案中生成，也会发生这种情况。我发现我不是唯一遇到此问题的人，并且想知道您是否对我有任何想法。

[这是来自 Google Cache 的具有相同错误的人的帖子。](http://74.125.93.104/search?q=cache:glrXLpIZMNUJ:www.codeproject.com/KB/silverlight/SilverlightLogging.aspx+'/Microsoft.VisualStudio.Xaml;Component/MS/Internal/Designer/PropertyEditing/Resources/StylesCore.Constants.xaml'+value+cannot+be+assigned+to+property+'Source'+of+object+'System.Windows.ResourceDictionary'&cd=1&hl=en&ct=clnk)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T07:55:57.943

我不知道问题的原因是什么。如果有人知道我会感兴趣的找出来！

我有一个解决方法，虽然它为我解决了它：

1.  从 Silverlight 项目中删除对使用 log4net 的任何内容的引用
2.  使用 log4net 从解决方案中删除该项目。
3.  重新加载 XAML 页面并保存解决方案。
4.  最后使用 log4net 添加项目并再次引用。

    亨里克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T03:22:59.517

堆栈跟踪表明您没有对项目中指定的 log4net 程序集的引用。解决方案是添加对它的引用，但除非您获得针对 Silverlight agCLR 运行时编译的 log4net 程序集，否则您将无法添加。

如果您不尝试在 Silverlight 应用程序中使用 log4net，另一种方法是删除尝试使用它的代码部分。再次从堆栈跟踪来看，您似乎正在设置某种初始化 log4net 的资源。尝试打开您的 Windox.xaml 并查看资源部分。如果您看到任何 log4net 的迹象，请将其删除，看看是否有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T19:57:41.283

我也收到此错误。我已经浏览了该应用程序并确保我引用了正确的版本。在 silverlight 应用程序中没有使用 log4net，仅在包含应用程序使用的 wcf 服务的 Web 项目中。看起来 log4net 必须用更安全的东西代替。log4net dll 也会导致 mstest 项目停止工作。

'/Microsoft.VisualStudio.Xaml;Component/MS/Internal/Designer/PropertyEditing/Resources/StylesCore.Constants.xaml' 值不能分配给对象'System.Windows.ResourceDictionary' 的属性'Source'。无法加载文件或程序集 'log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=1b44e1d426115821' 或其依赖项之一。该系统找不到指定的文件。标记文件“Microsoft.VisualStudio.Xaml;component/MS/Internal/Designer/PropertyEditing/Resources/StylesCore.xaml”中的对象“ResourceDictionary_2”出错。

# cocoa - 如何按此顺序将这些具有名称的对象添加到数组中？

> ID：746200
> 
> 赞同：-1
> 
> 时间：2009-04-14T03:09:42.560
> 
> 标签：cocoa

我有一些带有名称的对象，就像`button 1 , button 2 , button 11 ,button 111`，我想按这个顺序将这个对象添加到一个数组中：`button 1 ,button 2 , button 11 , button 111`，但是我发现这些对象可以按这个顺序添加数组：.`button 1 , button 11,button 111 , button 2`为什么？谢谢您的回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-24T10:32:40.823

您可以使用此代码对数组进行排序。使用[NSNumericSearch](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/c/econst/NSNumericSearch)搜索字符串中的数值。

```
NSArray * ary = [[NSArray alloc] initWithObjects:@"button 1" , @"button 2" , @"button 11" ,@"button 111", nil];

ary = [ary sortedArrayUsingComparator:^NSComparisonResult(id obj1, id obj2) {
        return [(NSString *)obj1 compare:(NSString *)obj2 options:NSNumericSearch];
    }];

NSLog(@"ary : %@", ary); 
```

和日志显示：

```
ary : (
"button 1",
"button 2",
"button 11",
"button 111"
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T03:29:43.307

在排序比较中使用[该`NSNumericSearch`选项。](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/doc/c_ref/NSNumericSearch)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-05T09:32:09.437

我使用了**NSNumericSearch|NSCaseInsensitiveSearch**组合来获得最佳结果。我希望有人会在谷歌搜索中挽救他们的生命。检查结果。

```
 NSArray * array =
    [NSArray
     arrayWithObjects:
        [NSDictionary dictionaryWithObject: @"C3" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"C1" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"C100" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"Z0" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"Z1000" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"M" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"m" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"M" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"m" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"1A4" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"A2" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"A12" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"B4" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"B6" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"B100" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"B1" forKey: @"sort"],
        [NSDictionary dictionaryWithObject: @"1a4" forKey: @"sort"],
         nil];

    NSSortDescriptor * descriptor =
    [NSSortDescriptor
     sortDescriptorWithKey: @"sort"
     ascending: YES
     comparator:
     ^NSComparisonResult(id obj1, id obj2)
     {
         return [obj1 compare: obj2 options: NSNumericSearch|NSCaseInsensitiveSearch];
     }];

    NSArray * sortedArray =
    [array
     sortedArrayUsingDescriptors:
     [NSArray arrayWithObject: descriptor]];

NSLog(@"Original array:");

for(NSDictionary * value in array)
    NSLog(@"%@", [value objectForKey: @"sort"]);

NSLog(@"Sorted array:");

for(NSDictionary * value in sortedArray)
    NSLog(@"%@", [value objectForKey: @"sort"]); 
```

**结果**

**原始数组：**

```
 C3
    C1
    C100
    Z0
    Z1000
    M
    m
    M
    m
    1A4
    A2
    A12
    B4
    B6
    B100
    B1
    1a4 
```

**排序数组：**

```
 1A4
    1a4
    A2
    A12
    B1
    B4
    B6
    B100
    C1
    C3
    C100
    M
    m
    M
    m
    Z0
    Z1000 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-14T03:20:31.647

就像您在 Finder 中拥有此名称的文件一样，它们会以相同的方式进行排序。

要获得正确的排序，您需要将它们命名为按钮 001、按钮 002、按钮 011 等。

或者，您必须编写自己的排序描述符。

[有关NSMutableArray sortUsingSelector 的信息，请参见此处：NSSortDescriptor](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/nsmutablearray_Class/Reference/Reference.html#//apple_ref/doc/uid/20000138-BBCJGCJI)的信息请参见[此处](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSSortDescriptor_Class/Reference/Reference.html#//apple_ref/occ/instm/NSSortDescriptor/compareObject:toObject:)

# ruby - Ruby 设计模式：如何制作可扩展的工厂类？

> ID：746207
> 
> 赞同：51
> 
> 时间：2009-04-14T03:12:48.247
> 
> 标签：ruby, design-patterns

好的，假设我有 Ruby 程序来读取版本控制日志文件并对数据进行处理。（我不知道，但情况是类似的，我对这些类比很感兴趣）。假设现在我想支持 Bazaar 和 Git。让我们假设程序将使用某种参数执行，该参数指示正在使用哪个版本控制软件。

鉴于此，我想创建一个 LogFileReaderFactory，它给出版本控制程序的名称将返回一个适当的日志文件读取器（从泛型子类化）来读取日志文件并吐出规范的内部表示。所以，当然，我可以制作 BazaarLogFileReader 和 GitLogFileReader 并将它们硬编码到程序中，但我希望它的设置方式是添加对新版本控制程序的支持就像添加新的类文件一样简单在带有 Bazaar 和 Git 阅读器的目录中。

因此，现在您可以调用“do-something-with-the-log --software git”和“do-something-with-the-log --software bazaar”，因为它们有日志阅读器。我想要的是可以简单地将 SVNLogFileReader 类和文件添加到同一个目录，并自动能够调用“do-something-with-the-log --software svn”，而无需对其余部分进行任何更改程序。（当然，这些文件可以使用特定的模式命名，并在 require 调用中通配。）

我知道这可以在 Ruby 中完成......我只是不知道我应该怎么做......或者我是否应该这样做。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-04-14T03:52:47.013

您不需要 LogFileReaderFactory；只需教您的 LogFileReader 类如何实例化其子类：

```
class LogFileReader
  def self.create type
    case type 
    when :git
      GitLogFileReader.new
    when :bzr
      BzrLogFileReader.new
    else
      raise "Bad log file type: #{type}"
    end
  end
end

class GitLogFileReader < LogFileReader
  def display
    puts "I'm a git log file reader!"
  end
end

class BzrLogFileReader < LogFileReader
  def display
    puts "A bzr log file reader..."
  end
end 
```

如您所见，超类可以充当自己的工厂。现在，自动注册怎么样？好吧，我们为什么不保留已注册子类的哈希值，并在定义它们时注册每个子类：

```
class LogFileReader
  @@subclasses = { }
  def self.create type
    c = @@subclasses[type]
    if c
      c.new
    else
      raise "Bad log file type: #{type}"
    end
  end
  def self.register_reader name
    @@subclasses[name] = self
  end
end

class GitLogFileReader < LogFileReader
  def display
    puts "I'm a git log file reader!"
  end
  register_reader :git
end

class BzrLogFileReader < LogFileReader
  def display
    puts "A bzr log file reader..."
  end
  register_reader :bzr
end

LogFileReader.create(:git).display
LogFileReader.create(:bzr).display

class SvnLogFileReader < LogFileReader
  def display
    puts "Subersion reader, at your service."
  end
  register_reader :svn
end

LogFileReader.create(:svn).display 
```

你有它。只需将其拆分为几个文件，并适当地要求它们。

如果您对这类事情感兴趣，您应该阅读 Peter Norvig 的[动态语言中的设计模式。](http://norvig.com/design-patterns/)他展示了有多少设计模式实际上是在解决您的编程语言中的限制或不足之处；并且使用足够强大和灵活的语言，您实际上并不需要设计模式，您只需实现您想要做的事情。他以 Dylan 和 Common Lisp 为例，但他的许多观点也与 Ruby 相关。

您可能还想看看[Why's Poignant Guide to Ruby](http://poignantguide.net/ruby/)，尤其是第 5 章和第 6 章，但前提是您可以处理超现实主义技术写作。

**编辑**：现在对 Jörg 的回答进行修改；我确实喜欢减少重复，因此不在课堂和注册中重复版本控制系统的名称。在我的第二个示例中添加以下内容将允许您编写更简单的类定义，同时仍然非常简单易懂。

```
def log_file_reader name, superclass=LogFileReader, &block
  Class.new(superclass, &block).register_reader(name)
end

log_file_reader :git do
  def display
    puts "I'm a git log file reader!"
  end
end

log_file_reader :bzr do
  def display
    puts "A bzr log file reader..."
  end
end 
```

当然，在生产代码中，您可能希望通过根据传入的名称生成常量定义来实际命名这些类，以获得更好的错误消息。

```
def log_file_reader name, superclass=LogFileReader, &block
  c = Class.new(superclass, &block)
  c.register_reader(name)
  Object.const_set("#{name.to_s.capitalize}LogFileReader", c)
end 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-14T10:40:24.520

这实际上只是在模仿 Brian Campbell 的解决方案。如果你喜欢这个，也*请*支持*他的*回答：他做了所有的工作。

```
#!/usr/bin/env ruby

class Object; def eigenclass; class << self; self end end end

module LogFileReader
  class LogFileReaderNotFoundError < NameError; end
  class << self
    def create type
      (self[type] ||= const_get("#{type.to_s.capitalize}LogFileReader")).new
    rescue NameError => e
      raise LogFileReaderNotFoundError, "Bad log file type: #{type}" if e.class == NameError && e.message =~ /[^: ]LogFileReader/
      raise
    end

    def []=(type, klass)
      @readers ||= {type => klass}
      def []=(type, klass)
        @readers[type] = klass
      end
      klass
    end

    def [](type)
      @readers ||= {}
      def [](type)
        @readers[type]
      end
      nil
    end

    def included klass
      self[klass.name[/[[:upper:]][[:lower:]]*/].downcase.to_sym] = klass if klass.is_a? Class
    end
  end
end

def LogFileReader type 
```

在这里，我们创建了一个名为 的全局方法（实际上更像是一个过程）`LogFileReader`，它与我们的模块同名`LogFileReader`。这在 Ruby 中是合法的。歧义是这样解决的：该模块将始终是首选，除非它显然是一个方法调用，即您要么将括号放在末尾（`Foo()`）或传递一个参数（`Foo :bar`）。

这是一个在 stdlib 中的一些地方使用的技巧，也在 Camping 和其他框架中使用。因为像`include`or之类的东西`extend`实际上不是关键字，而是采用普通参数的普通方法，所以您不必将实际`Module`作为参数传递给它们，您也可以将任何*计算*结果传递给 a `Module`。事实上，这甚至适用于继承，写 . 是完全合法的`class Foo < some_method_that_returns_a_class(:some, :params)`。

使用这个技巧，你可以让它看起来像是从一个泛型类继承而来，即使 Ruby 没有泛型。例如，它在委托库中使用，您可以在其中执行类似的操作`class MyFoo < SimpleDelegator(Foo)`，然后发生的情况是该`SimpleDelegator` *方法*动态创建并返回该类的匿名子`SimpleDelegator` *类*，该子类将所有方法调用委托给`Foo`该类的实例。

我们在这里使用了一个类似的技巧：我们将动态创建一个`Module`，当它混合到一个类中时，将自动将该类注册到`LogFileReader`注册表中。

```
 LogFileReader.const_set type.to_s.capitalize, Module.new { 
```

这条线有很多事情要做。让我们从右边开始：`Module.new`创建一个新的匿名模块。`module`传递给它的块成为模块的主体——它与使用关键字基本相同。

现在，继续`const_set`。这是一种设置常数的方法。所以，和说一样`FOO = :bar`，*只是*我们可以将常量的名称作为参数传入，而不必事先知道。由于我们在`LogFileReader`模块上调用该方法，因此常量将在该命名空间内定义，IOW 它将被命名为`LogFileReader::Something`。

那么，常数的名称是*什么？*嗯，它是`type`传递给方法的参数，大写。因此，当我传入 时`:cvs`，生成的常量将是`LogFileParser::Cvs`。

我们将常数设置为什么？致我们新创建的匿名模块，它现在不再是匿名的了！

所有这些实际上只是一种冗长的说法`module LogFileReader::Cvs`，只是我们事先不知道“Cvs”部分，因此不可能这样写。

```
 eigenclass.send :define_method, :included do |klass| 
```

这是我们模块的主体。在这里，我们使用`define_method`动态定义一个名为`included`. 而且我们实际上并没有在模块本身上定义方法，而是在模块的*eigenclass*上（通过我们上面定义的一个小帮助方法），这意味着该方法不会成为实例方法，而是“静态”方法（在 Java/.NET 术语中）。

`included`实际上是一个特殊的钩子方法，它被 Ruby 运行时调用，每次一个模块被包含到一个类中，并且该类作为参数传入。所以，我们新创建的模块现在有一个钩子方法，它会在它被包含在某个地方时通知它。

```
 LogFileReader[type] = klass 
```

这就是我们的钩子方法所做的：它将传递给钩子方法的类注册到`LogFileReader`注册表中。它注册它的关键是`type`来自上述`LogFileReader`方法方式的参数，由于闭包的魔力，它实际上可以在`included`方法内部访问。

```
 end
    include LogFileReader 
```

最后但并非最不重要的一点是，我们将`LogFileReader`模块包含在匿名模块中。[注意：我在原始示例中忘记了这一行。]

```
 }
end

class GitLogFileReader
  def display
    puts "I'm a git log file reader!"
  end
end

class BzrFrobnicator
  include LogFileReader
  def display
    puts "A bzr log file reader..."
  end
end

LogFileReader.create(:git).display
LogFileReader.create(:bzr).display

class NameThatDoesntFitThePattern
  include LogFileReader(:darcs)
  def display
    puts "Darcs reader, lazily evaluating your pure functions."
  end
end

LogFileReader.create(:darcs).display

puts 'Here you can see, how the LogFileReader::Darcs module ended up in the inheritance chain:'
p LogFileReader.create(:darcs).class.ancestors

puts 'Here you can see, how all the lookups ended up getting cached in the registry:'
p LogFileReader.send :instance_variable_get, :@readers

puts 'And this is what happens, when you try instantiating a non-existent reader:'
LogFileReader.create(:gobbledigook) 
```

`LogFileReader`这个新的扩展版本允许定义s 的三种不同方式：

1.  所有名称与模式匹配的类`<Name>LogFileReader`都将被自动找到并注册为`LogFileReader`for `:name`（参见：）`GitLogFileReader`，
2.  所有混合在`LogFileReader`模块中并且名称与模式匹配的类`<Name>Whatever`都将注册到`:name`处理程序（参见：）`BzrFrobnicator`和
3.  模块中混合的所有类`LogFileReader(:name)`都将为`:name`处理程序注册，无论它们的名称如何（参见：`NameThatDoesntFitThePattern`）。

请注意，这只是一个非常人为的演示。例如，它绝对*不是*线程安全的。它也可能泄漏内存。谨慎使用！

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-09-24T19:40:31.510

对布赖恩·坎贝尔的回答还有一个小建议-

实际上，您可以使用继承的回调自动注册子类。IE

```
class LogFileReader

  cattr_accessor :subclasses; self.subclasses = {}

  def self.inherited(klass)
    # turns SvnLogFileReader in to :svn
    key = klass.to_s.gsub(Regexp.new(Regexp.new(self.to_s)),'').underscore.to_sym

    # self in this context is always LogFileReader
    self.subclasses[key] = klass
  end

  def self.create(type)
    return self.subclasses[type.to_sym].new if self.subclasses[type.to_sym]
    raise "No such type #{type}"
  end
end 
```

现在我们有

```
class SvnLogFileReader < LogFileReader
  def display
    # do stuff here
  end
end 
```

无需注册

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-11-10T18:47:31.623

这也应该有效，无需注册类名

```
class LogFileReader
  def self.create(name)
    classified_name = name.to_s.split('_').collect!{ |w| w.capitalize }.join
    Object.const_get(classified_name).new
  end
end

class GitLogFileReader < LogFileReader
  def display
    puts "I'm a git log file reader!"
  end
end 
```

现在

```
LogFileReader.create(:git_log_file_reader).display 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-26T17:47:54.527

这就是我制作可扩展工厂类的方式。

```
module Factory
  class Error < RuntimeError
  end

  class Base
    @@registry = {}

    class << self
      def inherited(klass)
        type = klass.name.downcase.to_sym
        @@registry[type] = klass
      end

      def create(type, *args, **kwargs)
        klass = @@registry[type]
        return klass.new(*args, **kwargs) if klass
        raise Factory::Error.new "#{type} is unknown"
      end
    end
  end
end

class Animal < Factory::Base
  attr_accessor :name

  def initialize(name)
    @name = name
  end

  def walk?
    raise NotImplementedError
  end
end

class Cat < Animal
  def walk?; true; end
end

class Fish < Animal
  def walk?; false; end
end

class Salmon < Fish
end

duck = Animal.create(:cat, "Garfield")
salmon = Animal.create(:salmon, "Alfredo")
pixou = Animal.create(:duck, "Pixou") # duck is unknown (Factory::Error) 
```

# c++ - 在 GDI+ 中的画布上绘制图像时如何获取单词的长度和高度

> ID：746217
> 
> 赞同：1
> 
> 时间：2009-04-14T03:19:28.997
> 
> 标签：c++, gdi+, drawstring, outer-join, boundary

我在 C++ 中使用 GDI+ 在画布上绘制了一个字符串。是否有任何 API 可以获取特定字体的字符串的外层（宽度、高度）？非常感谢！非常感谢 Windows 程序员的解决方案。我写了以下代码。

```
 Bitmap bitmap(1000,1000);
    Graphics graphics(&bitmap);
    RectF rec;
    RectF useless;
    graphics.MeasureString(m_sWords, -1, m_pFont.get(), useless, &rec);
    int WordWidth = rec.Width + 1;
    int WordHeight Height = rec.Height + 1; 
```

我需要使用真实的图形来调用 MeasureString 吗？有没有办法在不创建大型图形实例的情况下获得字宽、字高？我发现这是资源消耗。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T04:04:07.327

Graphics::MeasureString 计算一个近似值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-21T14:29:47.883

为了使图片完整：可以简单地使用 GraphicsPath 完成，因为它不需要 DeviceContext，所以效果更好：

```
Dim p As New GraphicsPath

Using stringFormat As New StringFormat()
    stringFormat.Trimming = StringTrimming.EllipsisCharacter
    stringFormat.LineAlignment = StringAlignment.Center
    stringFormat.Alignment = StringAlignment.Near

    p.AddString(text, font.FontFamily, font.Style, font.SizeInPoints, Point.Empty, stringFormat)
End Using

Return p.GetBounds.Size 
```

其中文本是给定的字符串，字体是给定的字体。返回一个 SizeF 结构。我发现结果比 Graphics.MeasureString aka GdipMeasureString-API 要精确得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-20T10:38:49.323

不幸的是，您确实需要使用`Graphics`对象来执行此操作。

我使用的 C# 代码（返回 a `RectangleF`，因为我想知道宽度和高度）如下：

```
/// <summary> The text bounding box. </summary>
private static readonly RectangleF __boundingBox = new RectangleF(29, 25, 90, 40);

/// <summary>
///    Gets the width of a given string, in the given font, with the given
///    <see cref="StringFormat"/> options.
/// </summary>
/// <param name="text">The string to measure.</param>
/// <param name="font">The <see cref="Font"/> to use.</param>
/// <param name="fmt">The <see cref="StringFormat"/> to use.</param>
/// <returns> The floating-point width, in pixels. </returns>
private static RectangleF GetStringBounds(string text, Font font,
   StringFormat fmt)
{
   CharacterRange[] range = { new CharacterRange(0, text.Length) };
   StringFormat myFormat = fmt.Clone() as StringFormat;
   myFormat.SetMeasurableCharacterRanges(range);

   using (Graphics g = Graphics.FromImage(
       new Bitmap((int) __boundingBox.Width, (int) __boundingBox.Height)))
   {
      Region[] regions = g.MeasureCharacterRanges(text, font,
         __boundingBox, myFormat);
      return regions[0].GetBounds(g);
   }
} 
```

根据指定为 的边界框，这将返回`RectangleF`整个文本字符串大小的 a ，必要时自动换行`__boundingBox`。从好的方面来说，`Graphics`一旦`using`语句完成，对象就会被销毁……</p>

顺便说一句，GDI+ 在这方面似乎很不可靠。我发现它有很多错误（例如，请参阅[我的问题“Graphics.MeasureCharacterRanges 在 C#.Net 中给出错误的大小计算？”</a>）。如果您可以使用](https://stackoverflow.com/questions/2684894)[`TextRenderer.DrawText`](http://msdn.microsoft.com/en-us/library/system.windows.forms.textrenderer.drawtext.aspx)from `System.Windows.Forms`，请执行此操作。

# php - php中有指针吗？

> ID：746224
> 
> 赞同：60
> 
> 时间：2009-04-14T03:20:57.680
> 
> 标签：php, pointers

这段代码是什么意思？这是您在php中声明指针的方式吗？

```
$this->entryId = $entryId; 
```

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2009-04-14T04:20:26.227

PHP 中的变量名称以 $ 开头，因此 $entryId 是变量的名称。$this 是 PHP 面向对象编程中的一个特殊变量，它是对当前对象的引用。-> 用于访问 PHP 中的对象成员（如属性或方法），就像 C++ 中的语法一样。所以你的代码意味着：

将变量 $entryId 的值放入该对象的 entryId 字段（或属性）中。

PHP 中的 & 运算符，表示传递引用。这是一个例子：

```
$b=2;
$a=$b;
$a=3;
print $a;
print $b;
// output is 32

$b=2;
$a=&$b; // note the & operator
$a=3;
print $a;
print $b;
// output is 33 
```

在上面的代码中，因为我们使用了 & 运算符，所以 $b 指向的位置的引用存储在 $a 中。所以 $a 实际上是对 $b 的引用。

在 PHP 中，默认情况下参数是按值传递的（受 C 启发）。所以当调用一个函数时，当你传入你的值时，它们是按值复制的，而不是按引用复制的。这是大多数情况下的默认设置。但是，在定义函数时，有一种方法可以通过引用传递行为。例子：

```
function plus_by_reference( &$param ) {
      // what ever you do, will affect the actual parameter outside the function
      $param++;
}

$a=2;
plus_by_reference( $a );
echo $a;
// output is 3 
```

有许多这样的内置函数。就像排序数组的 sort() 函数会直接影响数组，不会返回另一个排序数组。

不过有一些有趣的事情需要注意。因为传值模式会导致更多的内存使用，而 PHP 是一种解释型语言（所以用 PHP 编写的程序不如编译程序快），为了使代码运行得更快并最小化内存使用，有一些调整在 PHP 解释器中。一种是惰性复制（我不确定名称）。这意味着：

当您将一个变量复制到另一个变量时，PHP 会将第一个变量的引用复制到第二个变量中。所以你的新变量，实际上是对第一个变量的引用，直到现在。该值尚未复制。但是，如果您尝试更改这些变量中的任何一个，PHP 将复制该值，然后更改该变量。这样，如果您不更改值，您将有机会节省内存和时间。

所以：

```
$b=3;
$a=$b;
// $a points to $b, equals to $a=&$b
$b=4;
// now PHP will copy 3 into $a, and places 4 into $b 
```

毕竟，如果你想把 $entryId 的值放到你的对象的 'entryId' 属性中，上面的代码会这样做，并且不会复制 entryId 的值，直到你改变它们中的任何一个，导致内存减少用法。如果您实际上希望它们都指向相同的值，请使用以下命令：

```
$this->entryId=&$entryId; 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-08-27T15:35:05.623

不，正如其他人所说，“PHP 中没有指针”。我补充说，PHP 中没有任何与 RAM_related 相关的内容。

而且所有的答案都很清楚。但是有些地方我无法抗拒！

## 有很多东西的行为类似于指针

*   [eval](http://php.net/manual/en/function.eval.php)构造（我最喜欢但也很危险）
*   [$GLOBALS](http://www.php.net/manual/en/reserved.variables.globals.php)变量
*   变量前的额外“$”符号（如**prathk**所述）
*   参考

* * *

### 第一

首先我不得不说 PHP 是一个非常强大的语言，知道有一个名为“eval”的结构，所以你可以在运行它的同时创建你的 PHP 代码！（真的很酷！）

尽管 PHP_Injection 的危险性比 SQL_Injection 更具破坏性。谨防！

例子：

**代码：**

```
$a='echo "Hello World.";';
eval ($a); 
```

**输出**

> 你好世界。

***因此，您可以从头开始***创建变量，而不是使用指针来充当另一个变量！

* * *

### 第二个

**$GLOBAL**变量非常有用，您可以使用它的键访问所有变量。

例子：

**代码：**

```
$three="Hello";$variable=" Amazing ";$names="World";
$arr = Array("three","variable","names");
foreach($arr as $VariableName)
    echo $GLOBALS[$VariableName]; 
```

**输出**

> 你好神奇世界

**注意：**其他[超全局变量](http://www.php.net/manual/en/language.variables.superglobals.php)可以在较小的范围内执行相同的技巧。

* * *

### 第三个

如果您知道自己在做什么，您可以在变量之前添加任意数量的“$”。

例子：

**代码：**

```
$a="b";
$b="c";
$c="d";
$d="e";
$e="f";

echo $a."-";
echo $$a."-";   //Same as $b
echo $$$a."-";  //Same as $$b or $c
echo $$$$a."-"; //Same as $$$b or $$c or $d
echo $$$$$a;    //Same as $$$$b or $$$c or $$d or $e 
```

**输出**

> bcdef

* * *

### 最后一个

参考非常接近指针，但您可能需要检查[此链接](http://www.php.net/manual/en/language.references.php)以获得更多说明。

示例 1：

**代码：**

```
$a="Hello";
$b=&$a;
$b="yello";
echo $a; 
```

**输出**

> 黄

示例 2：

**代码：**

```
function junk(&$tion)
{$GLOBALS['a'] = &$tion;}
$a="-Hello World<br>";
$b="-To You As Well";
echo $a;
junk($b);
echo $a; 
```

**输出**

> -你好世界
> 
> -你也是

希望能帮助到你。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-14T03:23:21.513

该语法是访问类成员的一种方式。PHP 没有指针，但它有引用。

您引用的语法与在 C++ 中从指向类的指针访问成员基本相同（而当它不是指针时使用点表示法。）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-14T04:10:25.207

要回答您问题的第二部分 - PHP 中没有指针。

在处理对象时，您通常通过引用而不是值传递 - 所以在某些方面它像指针一样操作，但通常是完全透明的。

这确实取决于您使用的 PHP 版本。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-09-11T15:44:34.503

您可以在某种程度上模拟指向实例化对象的指针：

```
class pointer {
   var $child;

   function pointer(&$child) {
       $this->child = $child;
   }

   public function __call($name, $arguments) {
       return call_user_func_array(
           array($this->child, $name), $arguments);
   }
} 
```

像这样使用：

```
$a = new ClassA();

$p = new pointer($a); 
```

如果你传递 $p ，它的行为就像一个关于方法调用的 C++ 指针（你不能直接接触对象变量，但这无论如何都是邪恶的:)）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-14T03:22:46.633

entryId 是当前类的实例属性 ($this) 而 $entryId 是局部变量

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-05-25T03:38:21.820

是的，有一些类似于 PHP 中的指针，但可能与 c 或 c++ 中发生的确切情况不匹配。以下是示例之一。

```
$a = "test";
$b = "a";
echo $a;
echo $b;
echo $$b;

//output
test
a
test 
```

这说明了 PHP 中指针的类似概念。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-14T04:39:24.233

PHP 通过引用（指针）传递数组和对象。如果你想传递一个普通的变量 Ex. $var = '嘘'; 然后使用 $boo = &$var;。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-25T01:04:56.690

PHP 可以使用类似指针的东西：

```
$y=array(&$x); 
```

现在 $y 就像一个指向 $x 的指针，并且 $y[0] 取消引用一个指针。

value array(&$x) 只是一个值，所以它可以传递给函数，存储在其他数组中，复制到其他变量等等。你甚至可以创建一个指向这个指针变量的指针。（但是，对其进行序列化会破坏指针。）

# c - 替换整数的最后一位

> ID：746227
> 
> 赞同：2
> 
> 时间：2009-04-14T03:21:46.527
> 
> 标签：c

我正在尝试用 38 替换整数的最后 2 位数字。我正在这样做，如下所示。

```
int num = 1297;
num = (num/100)*100 + 38; 
```

我假设编译器不会将 (num/100)*100 优化为 num。如果发生这种情况，那么在我上面的示例中，num 将变为 1335 而不是 1238。那么，在 C 中是否保证上述表达式不会被优化？或者有没有更好的方法用某个数字替换最后 2 位数字？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-14T03:23:47.270

```
num = num - (num % 100) + 38; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-14T04:20:20.427

优化根本不应该影响程序的结果（当然除了它的代码大小和运行时间）。当他们这样做时，通常是因为您依赖于未定义的行为。

没有理智的编译器会替换`(num/100)*100`为`num`. 优化编译器*远比*这聪明得多。`num - (num % 100)`如果这对目标平台来说是一个明智的决定，编译器可能会将其优化为 。

我总是说“你的代码越容易让编译器理解，编译器就越容易应用最合适的优化”。你知道吗？通常，编译器易于理解的代码也更易于人类理解。

# php - 在 PHP 中使用 DOMDocument 缩进

> ID：746238
> 
> 赞同：27
> 
> 时间：2009-04-14T03:25:23.117
> 
> 标签：php, xml, whitespace, indentation, domdocument

我正在使用`DOMDocument`生成一个新的 XML 文件，并且我希望文件的输出能够很好地缩进，以便人类读者易于理解。

例如，当`DOMDocument`输出此数据时：

```
<?xml version="1.0"?>
<this attr="that"><foo>lkjalksjdlakjdlkasd</foo><foo>lkjlkasjlkajklajslk</foo></this> 
```

我希望 XML 文件是：

```
<?xml version="1.0"?>
<this attr="that">
    <foo>lkjalksjdlakjdlkasd</foo>
    <foo>lkjlkasjlkajklajslk</foo>
</this> 
```

我一直在四处寻找答案，我发现的一切似乎都在试图以这种方式控制空白：

```
$foo = new DOMDocument();
$foo->preserveWhiteSpace = false;
$foo->formatOutput = true; 
```

但这似乎没有任何作用。也许这仅在读取 XML 时有效？请记住，我正在尝试编写新文档。

有什么内置的东西`DOMDocument`可以做到这一点吗？还是可以轻松完成此任务的功能？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-01-25T06:15:46.987

DomDocument 可以解决问题，我个人花了几个小时谷歌搜索并试图弄清楚这一点，我注意到如果你使用

```
$xmlDoc = new DOMDocument ();
$xmlDoc->loadXML ( $xml );
$xmlDoc->preserveWhiteSpace = false;
$xmlDoc->formatOutput = true;
$xmlDoc->save($xml_file); 
```

按这个顺序，它只是不起作用，但是，如果你使用相同的代码但按这个顺序：

```
$xmlDoc = new DOMDocument ();
$xmlDoc->preserveWhiteSpace = false;
$xmlDoc->formatOutput = true;
$xmlDoc->loadXML ( $xml );
$xmlDoc->save($archivoxml); 
```

像魅力一样工作，希望这会有所帮助

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-14T05:27:53.010

在约翰的一些帮助和我自己玩弄这个之后，似乎即使是 DOMDocument 对格式化的固有支持也不能满足我的需求。所以，我决定编写自己的缩进函数。

这是一个非常粗略的函数，我只是快速拼凑起来，所以如果有人有任何优化技巧或一般来说有什么要说的，我会很高兴听到它！

```
function indent($text)
{
    // Create new lines where necessary
    $find = array('>', '</', "\n\n");
    $replace = array(">\n", "\n</", "\n");
    $text = str_replace($find, $replace, $text);
    $text = trim($text); // for the \n that was added after the final tag

    $text_array = explode("\n", $text);
    $open_tags = 0;
    foreach ($text_array AS $key => $line)
    {
        if (($key == 0) || ($key == 1)) // The first line shouldn't affect the indentation
            $tabs = '';
        else
        {
            for ($i = 1; $i <= $open_tags; $i++)
                $tabs .= "\t";
        }

        if ($key != 0)
        {
            if ((strpos($line, '</') === false) && (strpos($line, '>') !== false))
                $open_tags++;
            else if ($open_tags > 0)
                $open_tags--;
        }

        $new_array[] = $tabs . $line;

        unset($tabs);
    }
    $indented_text = implode("\n", $new_array);

    return $indented_text;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-14T03:38:57.980

我尝试过以不同方式运行设置下面的代码`formatOutput`，`preserveWhiteSpace`唯一对输出有任何影响的成员是`formatOutput`. 你可以运行下面的脚本，看看它是否有效？

```
<?php
    echo "<pre>";
    $foo = new DOMDocument();
    //$foo->preserveWhiteSpace = false;
    $foo->formatOutput = true;
    $root = $foo->createElement("root");
    $root->setAttribute("attr", "that");
    $bar = $foo->createElement("bar", "some text in bar");
    $baz = $foo->createElement("baz", "some text in baz");
    $foo->appendChild($root);
    $root->appendChild($bar);
    $root->appendChild($baz);
    echo htmlspecialchars($foo->saveXML());
    echo "</pre>";
?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-15T20:12:26.160

本主题中的大多数答案都涉及 xml 文本流。这是使用 dom 功能执行缩进工作的另一种方法。loadXML() dom 方法将 xml 源中存在的缩进字符导入为文本节点。想法是从 dom 中删除此类文本节点，然后重新创建正确格式的文本节点（有关更多详细信息，请参见下面代码中的注释）。

xmlIndent() 函数实现为 indentDomDocument 类的方法，该类继承自 domDocument。以下是如何使用它的完整示例：

```
$dom = new indentDomDocument("1.0");
$xml = file_get_contents("books.xml");

$dom->loadXML($xml);
$dom->xmlIndent();
echo $dom->saveXML();

class indentDomDocument extends domDocument {
    public function xmlIndent() {
        // Retrieve all text nodes using XPath
        $x = new DOMXPath($this);
        $nodeList = $x->query("//text()");
        foreach($nodeList as $node) {
            // 1\. "Trim" each text node by removing its leading and trailing spaces and newlines.
            $node->nodeValue = preg_replace("/^[\s\r\n]+/", "", $node->nodeValue);
            $node->nodeValue = preg_replace("/[\s\r\n]+$/", "", $node->nodeValue);
            // 2\. Resulting text node may have become "empty" (zero length nodeValue) after trim. If so, remove it from the dom.
            if(strlen($node->nodeValue) == 0) $node->parentNode->removeChild($node);
        }
        // 3\. Starting from root (documentElement), recursively indent each node. 
        $this->xmlIndentRecursive($this->documentElement, 0);
    } // end function xmlIndent

    private function xmlIndentRecursive($currentNode, $depth) {
        $indentCurrent = true;
        if(($currentNode->nodeType == XML_TEXT_NODE) && ($currentNode->parentNode->childNodes->length == 1)) {
            // A text node being the unique child of its parent will not be indented.
            // In this special case, we must tell the parent node not to indent its closing tag.
            $indentCurrent = false;
        }
        if($indentCurrent && $depth > 0) {
            // Indenting a node consists of inserting before it a new text node
            // containing a newline followed by a number of tabs corresponding
            // to the node depth.
            $textNode = $this->createTextNode("\n" . str_repeat("\t", $depth));
            $currentNode->parentNode->insertBefore($textNode, $currentNode);
        }
        if($currentNode->childNodes) {
            $indentClosingTag = false;
            foreach($currentNode->childNodes as $childNode) $indentClosingTag = $this->xmlIndentRecursive($childNode, $depth+1);
            if($indentClosingTag) {
                // If children have been indented, then the closing tag
                // of the current node must also be indented.
                $textNode = $this->createTextNode("\n" . str_repeat("\t", $depth));
                $currentNode->appendChild($textNode);
            }
        }
        return $indentCurrent;
    } // end function xmlIndentRecursive

} // end class indentDomDocument 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-20T10:01:32.567

打印 xml 时调用哪种方法？

我用这个：

```
$doc = new DOMDocument('1.0', 'utf-8');
$root = $doc->createElement('root');
$doc->appendChild($root); 
```

(...)

```
$doc->formatOutput = true;
$doc->saveXML($root); 
```

它工作得很好，但只打印出元素，所以你必须`<?xml ... ?>`手动打印部分。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-07-23T01:05:24.337

哟偷看，

刚刚发现显然，根 XML 元素可能不包含文本子元素。这是不直观的 af 但显然，这就是例如，

```
$x = new \DOMDocument;
$x -> preserveWhiteSpace = false;
$x -> formatOutput = true;
$x -> loadXML('<root>a<b>c</b></root>');
echo $x -> saveXML(); 
```

将无法缩进。

[https://bugs.php.net/bug.php?id=54972](https://bugs.php.net/bug.php?id=54972)

所以你去，hth等。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-08-23T10:37:52.360

```
header("Content-Type: text/xml");

$str = "";
$str .= "<customer>";
$str .= "<offer>";
$str .= "<opened></opened>";
$str .= "<redeemed></redeemed>";
$str .= "</offer>";
echo $str .= "</customer>"; 
```

If you are using any extension other than `.xml` then first set the header `Content-Type` header to the correct value.

# c++ - 复制构造函数 - C++

> ID：746240
> 
> 赞同：10
> 
> 时间：2009-04-14T03:27:40.940
> 
> 标签：c++, copy, constructor

我可以通过传入指针而不是 const 引用来编写复制构造函数吗？（如果我确保我不会更改任何值，可以吗？）

像这样：

```
SampleClass::SampleClass(SampleClass* p)
{
 //do  the necessary copy functionality
} 
```

代替：

```
SampleClass::SampleClass(const SampleClass& copyObj)
{
//do the necessary copy
} 
```

提前致谢。

* * *

感谢大家。因此，如果我编写一个接收指针的构造函数（并认为这是我的复制构造函数），编译器仍然会提供默认的复制构造函数，在这种情况下我的构造函数（我认为是我的复制构造函数）不会被调用并且将调用默认的复制构造函数。知道了。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-14T03:33:50.053

是的，您可以编写一个构造函数来获取指向该对象的指针。但是，它不能称为复制构造函数。复制构造函数的*定义*要求您传递同一类的对象。如果您要传递其他任何东西，是的，它是一个构造函数，但不是一个复制构造函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T03:33:32.270

您可以编写一个将指针作为参数的构造函数。
但是复制构造函数是我们给特定构造函数的名称。
将同一类的引用（最好是 const 但不是必需的）作为参数的构造函数只是命名为复制构造函数，因为这是它有效的作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T06:31:28.130

除了它不是一个复制构造函数并且编译器将生成复制构造函数，除非你明确禁用它之外，没有什么可得到的，也没有什么可失去的。使用空指针的构造函数的正确语义是什么？这对您班级的用户有什么好处？（提示：没什么，如果她想用堆对象构造，她可以取消引用指针并使用常规的复制构造函数）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T12:41:56.897

复制构造函数在两种情况下隐式使用：

*   当您的类的实例按值传递给函数时。
*   当您的类的实例按值从函数返回时。

正如其他人所提到的，您可以使用所描述的签名（或使用 const 指针）编写构造函数，但在上述任何一种情况下都不会使用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T03:31:46.470

不，复制构造函数必须采用引用，而不是指针，如果它对按值传递等有用的话。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T03:33:52.020

根据定义，复制 ctor 使用 const 引用。虽然没有什么可以阻止您编写一个接受指针的 ctor，但它会引发一些使用引用时不存在的问题 - 例如，如果传入空指针应该/会发生什么？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-14T03:34:09.630

复制构造函数需要引用，因为值参数需要进行复制，这将调用复制构造函数，该复制构造函数将复制其参数，该参数将调用复制构造函数，...

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-14T03:34:59.737

您可以编写这样的构造函数，但从技术上讲，它不是复制构造函数。例如，STL 容器仍将使用编译器生成的复制构造函数（编译器生成一个，因为您没有编写一个）。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2011-11-03T05:43:42.497

您可以编写一个完全有效的复制构造函数，并且仍然能够传递一个为 NULL 的引用。您可以测试 NULL，但前提是您不使用构造函数初始化列表。

例子：

```
MyClass::MyClass( MyClass const& MyClassCopy )
: somevar( MyClassCopy.somevar ) // <- the init list goes here.
{
   // If MyClassCopy is NULL, the initialization above is doomed!
   // However we can check for NULL in the constructor body but
   // the initialization list must be removed ...
   if (&MyClassCopy == NULL ) throw( std::runtime_error("NULL pointer!"));
   somevar = MyClassCopy.somevar;
}

// I'll now do some very dangerous programming to
// demonstrate one way that a NULL can get through ...
MyClass* P = NULL;
MyClass A( *P ); // Bang, you're dead! 
```

据我所知，没有办法从初始化列表中检查 NULL，所以如果你认为你最终可能会遇到 NULL 通过的情况，你必须在构造函数主体中测试它并执行从那里初始化。

不要忘记 ::operator=() 函数有一些注意事项......

# jquery - jQuery : JSONP : 执行收到的信息

> ID：746249
> 
> 赞同：2
> 
> 时间：2009-04-14T03:31:53.880
> 
> 标签：jquery, jsonp

我正在使用 JSONP 从服务器获取数据。

更典型的处理方法是获取数据，然后让 javascript 确定如何处理数据（更新 div 等）

然而，服务器响应的不是简单的数据，而是需要执行的实际 jQuery 代码。如何让我的 javascript 接受该响应然后实际执行它？我已经使用 Mootools（使用 evalScripts）非常成功地做到了这一点，但我无法在 jQuery 中弄清楚。

这样做的好处是客户端代码要小得多，并且需要在浏览器中完成的工作更少。

例子：

```
$.getJSON("http://appbeacon.com/index.php?model=blah_blah_blah", function (data) {
    $.each(data, function (i, item) {
        console.log(item);
        // Need to execute "item" ??????
    });
}); 
```

示例响应（不再编码 JSON）：

```
$("#1_cmd_group").remove();
$("#2_cmd_group").remove();
$("#3_contents").html("<li>blah blah blah"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T03:35:46.850

```
eval(item); 
```

试一试

# java - java字符串到日期时间的转换问题

> ID：746259
> 
> 赞同：3
> 
> 时间：2009-04-14T03:36:33.260
> 
> 标签：java, string, datetime

我似乎看不到下面示例代码的问题。出于某种原因，似乎忽略了年份并说日期相同，如下面的输出所示。我一定错过了一些简单的东西。

2006 年 1月 28日 2007 年 1 月 16
日
星期二 2008 年 4 月 1 日星期二 00:00:00 PDT 2008 年
4 月 1 日星期二 00:00:00 PDT 2008 年
完成

```
import java.util.*;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;

    class ExampleProgram {
      public static void main(String[] args){
        DateFormat df = new SimpleDateFormat("dd/MM/yyyy");
        String d1String = "01/28/2006";
        String d2String = "01/16/2007";
        System.out.println(d1String);
        System.out.println(d2String);
        Date d1=null;
        try {
            d1 = df.parse(d1String);
        } catch (ParseException e) {                
            System.out.println(e.getMessage());
        }           
        Date d2=null;
        try {
            d2 = df.parse(d2String);
        } catch (ParseException e) {                
            System.out.println(e.getMessage());
        }
        System.out.println(d1);
        System.out.println(d2);
        System.out.println("done");
      }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T03:48:02.703

```
"dd/MM/yyyy" 
```

应该读：

```
"MM/dd/yyyy" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T12:41:04.497

正如彼得所提到的，这些字母的含义可以在此处的文档中找到： [https](https://docs.oracle.com/javase/1.5.0/docs/api/java/text/SimpleDateFormat.html) ://docs.oracle.com/javase/1.5.0/docs/api/java/text/SimpleDateFormat.html 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T13:24:57.870

它没有给您预期的原因就像彼得说`SimpleDateFormat`应该阅读`"MM/dd/yyyy"`

结果是说它们看起来相等的原因是因为使用您给它的格式，`"dd/MM/yyyy"`月份`d1String`是 28。它需要 28 - 12，加一年，16 - 12，再加一年，结果是 4（4 月），现在是 2008 年。同样的事情`d2String`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T13:13:45.930

您可以尝试将日期声明为[Date](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Date.html)对象。

# php - 我在 Zend Framework 中的哪里保存部分（视图），以便我的应用程序中的所有视图都可以访问？

> ID：746260
> 
> 赞同：14
> 
> 时间：2009-04-14T03:37:13.460
> 
> 标签：php, model-view-controller, zend-framework, zend-view

我有几个视图部分（如分页器部分），我希望它们可用于我的应用程序中的所有视图脚本。
是否有一个目录我可以将部分 vie 放入其中，并且所有人都可以使用它们？
或者，我如何定义这样的目录？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-04-14T06:24:37.473

您可以使用任何名称在视图文件夹中创建一个文件夹，并从您的视图中使用以下代码调用部分，并作为第二个参数传递将在部分中使用的值数组。

```
$this->partial('your-partial-dir/your-partial.phtml', array('var'=>$myVar)); 
```

请注意，您可以包含和渲染来自任何视图的任何局部视图，该视图将视图文件夹作为根文件夹。并且您可以使用 $this 标识符来访问部分中的变量，以引用每个变量，就好像它是部分对象的成员一样：

```
//your-partial.phtml file

$this->var; 
```

或者，您也可以创建一个视图助手——一个视图助手是一个从 Zend_View_helper 类声明和扩展的类，并且可以从视图中调用，就好像它是一个成员函数一样。

有关视图助手的更多信息，您可以参考 Zend [http://devzone.zend.com/article/3412-View-Helpers-in-Zend-Framework上的这篇文章](http://devzone.zend.com/article/3412-View-Helpers-in-Zend-Framework)

# linux - 服务器扩展如何在 X 中工作？

> ID：746263
> 
> 赞同：0
> 
> 时间：2009-04-14T03:40:17.183
> 
> 标签：linux, x11

让我们举个例子。当我运行时：

> xkbprint $DISPLAY 键盘.ps

系统中发生了什么？我想知道 X 到底是如何工作的，因为我经常收到令人讨厌的错误报告，例如

> 致命错误：无法为 /tmp/launch-NawGIk/:0 加载几何图形
> 
> ```
>  Exiting 
> ```

我知道 X11 的设计方式很容易扩展。但是怎么做？X11 协议如何工作？X 扩展如何工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T03:59:35.983

不管发生什么，我很确定这不会是你所期望的。

[xkbprint(1](http://www.xfree86.org/current/xkbprint.1.html) )的语法是

> $ xkbprint源文件*目标**文件*

 **sourcefile*应该是一个已编译的 xkb 文件 。`$DISPLAY`将解析为类似的东西`mymachine:0.0`，这不是一个非常合理的文件名。

实际上，由于您运行的是 Mac，它与它所看到的完全一致：是让 launchd 运行 X 应用程序的特殊 OS/ *X*魔法*。*错误消息意味着它没有*在该文件中*找到几何图形或显示。这并不奇怪，因为没有*名为*`/tmp/launch-NawGIk/:0 的文件`/tmp/launch-NawGIk/:0`

 ***尝试阅读手册页，看看您是否对编译的 .xkm 文件没有更多的运气。

更一般地说，如果您想初步了解 X，请[尝试这篇文章](http://www.linuxjournal.com/article/4879)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T15:06:59.623

男人 xkbprint 说：

> xkbprint comman 生成由 source 指定的 XKB 键盘描述的可打印或封装 PostScript 描述。源可以是任何已编译的键盘映射 (.xkm) 文件，其中包括几何描述或 X 显示规范。

正如查理马丁指出的那样，xkbprint 滥用您的 $DISPLAY 作为文件名。尝试更精确地指定显示，以避免文件名出现歧义。试试 man xhost。也许通过简单的“：0”可以解决问题？

# c++ - 如何针对发布构建的库 (MSVCRT.lib) 构建调试 .exe (MSVCRTD.lib)？

> ID：746298
> 
> 赞同：6
> 
> 时间：2009-04-14T04:07:35.307
> 
> 标签：c++, visual-studio, visual-c++, linker

我正在使用 Visual C++ 2008，SP1。我在调试构建配置中有一个 QT 应用程序（gui、.exe）。它设置为使用 CRT 的多线程调试 DLL 版本，即 MSVCRTD.lib。

我正在链接以发布模式构建并使用 CRT 的多线程 DLL（非调试）版本，即 MSVCRT.lib 的第 3 方库。

它链接并运行，但在启动时崩溃。链接时我收到警告：

链接：警告 LNK4098：defaultlib 'MSVCRT' 与使用其他库冲突；使用 /NODEFAULTLIB:library

我尝试设置 /NODEFAULTLIB:msvcrt.lib

但由于缺少符号，导致 5 个链接错误。

那么不可能使用两个不同的库吗？什么是替代方案？我可以从我拥有的 3rd 方库中创建一个 DLL 吗？还是第三者必须做的事情？

启动时的异常是：

“MyApp.exe 中......未处理的异常：......访问冲突读取位置 0x00000000f”

以下是应用程序运行并崩溃后的调用堆栈：

```
MyApp.exe!std::_Aux_cont::_Getcont()  + 0xa bytes   C++
MyApp.exe!std::_Iterator_base_aux::_Getmycont()  + 0x1b bytes   C++
MyApp.exe!std::_Tree<std::_Tmap_traits<std::basic_string<char,std::char_traits<char>,std::allocator<char> >,unsigned int,std::less<std::basic_string<char,std::char_traits<char>,std::allocator<char> > >,std::allocator<std::pair<std::basic_string<char,std::char_traits<char>,std::allocator<char> > const ,unsigned int> >,0> >::const_iterator::operator*()  + 0x28 bytes  C++
MyApp.exe!std::_Tree<std::_Tmap_traits<std::basic_string<char,std::char_traits<char>,std::allocator<char> >,unsigned int,std::less<std::basic_string<char,std::char_traits<char>,std::allocator<char> > >,std::allocator<std::pair<std::basic_string<char,std::char_traits<char>,std::allocator<char> > const ,unsigned int> >,0> >::iterator::operator*()  + 0xf bytes C++
MyApp.exe!std::map<std::basic_string<char,std::char_traits<char>,std::allocator<char> >,unsigned int,std::less<std::basic_string<char,std::char_traits<char>,std::allocator<char> > >,std::allocator<std::pair<std::basic_string<char,std::char_traits<char>,std::allocator<char> > const ,unsigned int> > >::operator[]()  + 0xe9 bytes    C++
MyApp.exe!ThirdPartyLib::client::`anonymous namespace'::init_xlt_mode()  + 0x5f bytes   C++
MyApp.exe!_GetCommandLineW@0()  + 0x8d8f3 bytes C++
msvcr90d.dll!_initterm(void (void)* * pfbegin=0x006c4468, void (void)* * pfend=0x006cb0b8)  Line 903    C
MyApp.exe!__tmainCRTStartup()  Line 501 + 0xf bytes C
MyApp.exe!WinMainCRTStartup()  Line 403 C
kernel32.dll!7c817067() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-14T12:56:00.920

您可以构建您的项目以链接到发布 CRT 并为您的代码启用调试信息。在“项目属性”中，转到 C++/General 并更改调试信息格式。在“优化”部分关闭优化。切换到“链接器/调试”部分并启用调试信息的生成。确保设置程序数据库文件 (PDB)。

此时，您的应用程序将为代码中的所有内容发出调试信息，并链接到非调试 DLL CRT。这使您能够在发布配置中调试应用程序，同时避免与在同一应用程序中使用多个 CRT 相关的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T04:49:29.403

在混合和匹配 Debug 和 Release 配置库时，我已经看到了类似的问题。

虽然这有时会起作用，但它也可能导致模糊的崩溃，例如您所看到的崩溃（可能是由不匹配的入口点或类似原因引起的）。

我看到的替代方案是：

*   在 Release 配置中构建您的应用程序（将其指向 MSVCRT.dll）并查看它是否有效（您将无法获得尽可能多的调试信息，但它可能有助于隔离问题的根源）。

*   如果第 3 方库是开源的，请尝试自己构建 .lib 文件的调试版本。

*   否则，请查看 Debug 版本是否在线可用，或联系供应商。

抱歉，我无法提供更多帮助。我认为从长远来看，如果您可以访问正确的库，然后尝试找出解决方法，它会更快。

# iphone - 在你冒险使用 iPhone 之前，开始如何在桌面上使用 Objective-C 编写代码会更好吗？

> ID：746299
> 
> 赞同：6
> 
> 时间：2009-04-14T04:08:36.193
> 
> 标签：iphone, objective-c

我有 C/C++ 经验，所以学习 Objective-C 对我来说并不完全陌生。但是，我注意到为 iPhone 编写应用程序并不像为桌面平台编写应用程序那么简单。在我进入 iPhone 之前，我是否应该开始在桌面上获得一些可靠的体验？我不是商业开发人员，只是将其作为一种爱好和学习目的。你的建议是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T09:59:29.370

值得一提的是，另一位 iPhone 开发新手的评论……

我的背景 - 大约 15 年前，我是一名 C 程序员，从那时起，我在技术方面有了相当多的转变 - 我现在是一名 Adob​​e Flex 开发人员，从事我的日常工作。然而，到了晚上，我正试图将自己转变为一名 iPhone 开发人员 ;-)

所以我买了一本关于 iPhone SDK 开发的书——“iPhone in Action”。我还购买了“Objective-C 2.0 中的编程”。我以为我会用这两个设置，但经过几天的阅读和练习后，很明显......我绝望地迷失了！

所以我从实用书店买了另一本书——这次是“iPhone SDK 开发”——这是一本正在进行中的书，但对我来说看起来“正确”。结果这本书让我走得更远——这是一部很棒的作品——然而，前几章的节奏很好，我能够跟上，然后突然之间，他们开始认为我可以完美地回忆起所学到的教训和程序在前面几章之后，我又开始有点挣扎——当我试图从一本书中学习一些东西时，我发现最糟糕的事情是必须不断地从一个地方跳到另一个地方，以了解我的本意正在做。

所以（是的，我知道......但请耐心等待......）我从 APress 购买了另一本书......“开始 iPhone 开发”。现在这本书没有任何假设。对于 iPhone 开发的初学者来说，这本书达到了目标。没有必要跳来跳去，最后我发现我正在进步。

然而，我发现所有三本书相互结合似乎确实为我提供了一个更完整的画面——总的来说，我有一套很棒的教程和参考资料。这本 Objective-C 的书我还没有接触太多，但我希望这就是我所需要的——该语言的参考手册；在我更深入地了解胆量之前，我不需要它。我正在慢慢摆脱那种可怕的“在最深处，我游得不太好”的感觉，我至少可以踩水。希望通过更多的划桨，我将能够触底——当然，我的信心正在恢复；-)

所以无论如何，为了解决最初的问题——就我个人而言，如果我重新做一遍，我认为我不会通过先为 Mac 构建然后再构建 iPhone 来获得任何收益。如果我先买了 APress 书，我肯定会少掉头发——对我来说，这本书对我来说完全理解了一切。我认为当时的“iPhone SDK Development”实用书是最好的备份/后续书。这是我向同事建议的路径，我相信这是一条好路径。

希望这可以帮助！

杰米。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T04:22:36.737

在进入 iPhone 开发之前拥有一些 Cocoa 经验肯定是有帮助的，但我个人不会这么费劲。学习如何使用 Cocoa 框架并熟悉它会有所帮助，但是桌面 Cocoa 编程的某些方面与 iPhone 编程无关（例如，使用 Interface Builder 进行用户界面设计）。此外，iPhone 编程的某些独特方面是普通的 Cocoa 编程无法真正让您做好准备的。（一些有经验的 Cocoa 开发者在第一次进入 iPhone 开发时仍有一定的学习曲线。）

换句话说，我建议学习普通 Cocoa 开发的基础知识，但您无需成为 Cocoa 大师就可以学习如何开发 iPhone 应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T08:55:43.913

如果你编写桌面应用程序的唯一目的是熟悉 Objective-C、cocoa 和 Xcode，那是不值得的。

从桌面应用程序开始，您将不会学到任何东西，而您不会直接在 iPhone 应用程序中学习。桌面应用程序并不比 iPhone 应用程序简单，它们只是不同而已。

如果您了解在 iPhone 开发中必须“忘掉”的桌面应用程序的特殊性，甚至可能适得其反。

当然，如果您打算进入 OS X 生态系统，那么学习这两者将是非常有价值的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T04:18:11.600

在某些方面，iPhone 对于 C/C++ 开发人员来说更简单。没有垃圾收集是大问题。如果你从桌面开始并习惯了 GC，那么当你使用 iPhone 时，你将会有一段地狱般的时光。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T08:12:32.987

在转移到 iPhone 上的 UiKit 之前，无需学习桌面 Cocoa 或从中受益。可能有一些缺点。

尽管 UIkit 和 Cocoa 之间共享了很多概念，但在桌面上学习它们并不容易。归根结底，它们并不相同。同样，iPhone 和桌面之间也有很多框架共享——在这些情况下，在手机上使用桌面版本之前没有任何好处。

只有在 iPhone 上才会遇到一些困难，而在桌面上可能会让事情变得更容易：

*   你在目标机上开发，在 iPhone 上，目标管理比较困难
*   iPhone 受内存和处理器限制
*   iPhone 上没有垃圾收集

我的观点是，最好尽快习惯这些问题，而不是在桌面上养成“坏习惯”（或者只是在使用 iPhone 时产生误解）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T10:22:31.787

最大的挑战不是学习 Cocoa 和/或 Cocoa Touch，而是 Objective-C。一旦你掌握了基础知识，Cocoa 就很简单，并且与许多其他 OO 框架相似。

我建议：

1.  关于 Objective-C 的维基百科文章：[https ://en.wikipedia.org/wiki/Objective-C](https://en.wikipedia.org/wiki/Objective-C)
2.  Wikipedia 上的“外部链接”，了解该语言的一些基础知识
3.  热可可播客：http: [//itunes.apple.com/WebObjects/MZStore.woa/wa/viewPodcast ?id=294050835](http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewPodcast?id=294050835)
4.  Cocoa Cast 播客：http: [//itunes.apple.com/WebObjects/MZStore.woa/wa/viewPodcast ?id=298413458](http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewPodcast?id=298413458)
5.  然后是 iTunes U 上的斯坦福 iPhone 应用程序编程课程：[https ://podcasts.apple.com/us/podcast/iphone-application-programming-spring-2009/id384233222](https://podcasts.apple.com/us/podcast/iphone-application-programming-spring-2009/id384233222)
6.  加入 Apple 的开发者计划：[https ://developer.apple.com](https://developer.apple.com)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T14:00:05.937

如果您有任何开发经验，您就会知道所有语言都是相似的，并且只有通过使用它才能完全了解它。

我学习新开发环境的方法是选择一个你想解决的问题（因为手机一直在你的口袋里，你可能会有一些想法），然后用你的脑袋去解决它。

有大量的苹果示例代码，这里和其他网站上的答案。从一个与您想要做的事情相距不远的工作示例应用程序开始，并随着时间的推移对其进行调整。您对一个正常工作的应用程序感到满意，立即发现问题，并且一次可以学习一些小知识。

# java - 最常用的 Java 框架有哪些？

> ID：746301
> 
> 赞同：13
> 
> 时间：2009-04-14T04:10:15.630
> 
> 标签：java, frameworks

对我来说，我将根据我的经验回答这个问题。

**因此，如果我要开始新项目，我将使用以下技术：**

1.  [AndroMDA](http://www.andromda.org/)作为[MDA](http://en.wikipedia.org/wiki/Model-driven_architecture)框架。
2.  弹簧（DI、拦截器、石英、ACEGI 等）。
3.  休眠。
4.  JSF。

**当然，您可能需要使用一些辅助框架/库，例如：**

1.  速度。
2.  中国科学院; 如果您需要 SSO。
3.  JXL；如果您需要使用 XLS 模板生成 Excel 文件的小而简单的库。
4.  流口水；这是人工智能规则引擎，它使用基于规则的方法来实现专家系统，更正确地归类为生产规则系统。

**在测试方面，我将考虑以下框架：**

1.  测试NG；您可能想在单元测试部分使用 JUnit，但 TestNG 不仅仅是一个单元测试框架；
2.  WATIR 或 SELENIUM 作为网络测试；

其他人可以建议其他选择吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-14T04:24:10.883

以下是您可以在 StackOverflow 上找到的一些问题的答案。

*   [最好的Java框架？](https://stackoverflow.com/questions/257712/)
*   [最常用的 Java Web 框架是什么？](https://stackoverflow.com/questions/742223/)
*   [Web 应用程序的最佳 java mvc 框架实现](https://stackoverflow.com/questions/309254/)
*   [市场上最好的 MVC Web 框架有哪些？](https://stackoverflow.com/questions/24450/)
*   [什么是最好的 Java 社交网络框架？](https://stackoverflow.com/questions/283922/)
*   [重型 AJAX Java 应用程序的最佳服务器端框架](https://stackoverflow.com/questions/73736/)
*   [推荐什么 Java Web 应用程序框架？](https://stackoverflow.com/questions/24596/)
*   [Java 验证框架](https://stackoverflow.com/questions/397852/)
*   [Java中的验证框架](https://stackoverflow.com/questions/580686/)
*   [Java 2D 游戏框架](https://stackoverflow.com/questions/293079/)
*   [Java/Swing 有哪些好的对接框架？](https://stackoverflow.com/questions/304874/)
*   [我应该选择哪个框架——Seam、Wicket、JSF 或 GWT？](https://stackoverflow.com/questions/745029/)
*   [Java 框架之战：Spring 和 Hibernate](https://stackoverflow.com/questions/100243/)
*   [推荐的 Java Web 服务框架](https://stackoverflow.com/questions/289977/)
*   [Java 桌面应用程序框架](https://stackoverflow.com/questions/51002/)
*   [替代 Java GUI 框架](https://stackoverflow.com/questions/286251/)
*   [Java 最好的模拟框架是什么？](https://stackoverflow.com/questions/22697/)
*   [Java 配置框架](https://stackoverflow.com/questions/25765/)

您可以通过[Google自己进行此搜索](http://www.google.com/search?q=site:stackoverflow.com+java+framework&hl=en)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T04:21:12.607

我不能确定，我将在即将到来的新项目中使用什么。除非另有说明，否则我计划在此处[和](http://willcode4beer.com/opinion.jsp?set=in_favor_of_rdd)此处[进行](http://www.thousandtyone.com/blog/ResumeDrivenDevelopmentTheHammerAndTheNail.aspx)[RDD](http://shahid.shah.org/index.php/archives/15)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T06:07:24.333

感谢 Eddie 的谷歌搜索提示。

当我问这个问题时，我偏向于 Web 应用程序开发。现在我发现这不能用一个问题来回答。所以我想最好有一个页面对 Java 框架（DI、Web、ORM）进行分类，每个类别中的链接指向 stackoverflow 中的其他问题。

然而，这可能以类似于[java-source.net](http://java-source.net/)的内容结束， 但已分类。所以我将在下面的回答中使用您的提示 Eddie：

**[ORM（对象关系映射）](http://en.wikipedia.org/wiki/Object-relational_mapping)框架：**

*   [Hibernate、iBatis、Java EE 或其他 Java ORM 工具](https://stackoverflow.com/questions/716532/hibernate-ibatis-jee-or-other-java-orm-tool)
*   [你更喜欢哪种 Java ORM，为什么？](https://stackoverflow.com/questions/452385/what-java-orm-do-you-prefer-and-why)

**[DI / IOC](http://en.wikipedia.org/wiki/Dependency_injection)框架：**

*   [接下来我应该学习什么 DI/IoC 框架？](https://stackoverflow.com/questions/582098/what-di-ioc-framework-should-i-learn-next)
*   [https://stackoverflow.com/questions/71041/which-single-ioc-di-container-would-you-recommend-using-and-why](https://stackoverflow.com/questions/71041/which-single-ioc-di-container-would-you-recommend-using-and-why)

**网络框架：**

*   [与 xml+xslt 完美搭配的最佳 Java Web 应用程序框架是什么？](https://stackoverflow.com/questions/671297/what-is-the-best-java-web-application-framework-that-goes-well-with-xmlxslt)
*   [哪个 Java Web 框架最适合 Google Guice？](https://stackoverflow.com/questions/481705/which-java-web-framework-fits-best-with-google-guice)
*   [https://stackoverflow.com/questions/309254/best-java-mvc-framework-implementation-for-web-apps](https://stackoverflow.com/questions/309254/best-java-mvc-framework-implementation-for-web-apps)
*   [哪个 Java Web 框架最适合 Web 设计人员？](https://stackoverflow.com/questions/508225/what-java-web-framework-best-accomodates-web-ui-designers)

**报告引擎：**

*   [https://stackoverflow.com/questions/238527/what-is-the-best-report-engine-for-java](https://stackoverflow.com/questions/238527/what-is-the-best-report-engine-for-java)
*   [什么是最好的免费或低成本 Java 报告库（例如 BIRT、JasperReports 等），用于制作类似报纸的报告](https://stackoverflow.com/questions/708588/what-is-the-best-free-or-low-cost-java-reporting-library-e-g-birt-jasperreport)

**测试框架：**

*   [哪个是自动 GUI 性能测试的最佳工具？](https://stackoverflow.com/questions/92679/which-is-the-best-tool-for-automatic-gui-performance-testing)
*   [Java 最好的模拟框架是什么？](https://stackoverflow.com/questions/22697/whats-the-best-mock-framework-for-java)
*   [Java 最好的模拟框架是什么？](https://stackoverflow.com/questions/22697/)

**图形用户界面库：**

*   [https://stackoverflow.com/questions/138722/which-gui-library-is-the-best-in-java](https://stackoverflow.com/questions/138722/which-gui-library-is-the-best-in-java)

**[代码覆盖](http://en.wikipedia.org/wiki/Code_coverage)工具：**

*   [https://stackoverflow.com/questions/39329/what-is-your-favourite-code-coverage-tools-free-and-non-free](https://stackoverflow.com/questions/39329/what-is-your-favourite-code-coverage-tools-free-and-non-free)

**[构建工具](http://en.wikipedia.org/wiki/Build_automation)：**

*   [您推荐哪些工具来自动构建您的应用程序？](https://stackoverflow.com/questions/191093/what-tools-do-you-recommend-to-auto-build-your-application/191147)
*   [可用的构建工具（make 等）？](https://stackoverflow.com/questions/247350/available-build-tools-make-etc)

**静态分析工具：**

*   [什么代码指标让你相信提供的代码是“糟糕的”？](https://stackoverflow.com/questions/187289/what-code-metrics-convince-you-that-provided-code-is-crappy/187330#187330)
*   [查找错误](http://findbugs.sourceforge.net/)

*如果我错过了什么，请告诉我以更新此答案。（谢谢大家）*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T04:13:59.443

不要忘记一些[静态分析](https://stackoverflow.com/questions/187289/what-code-metrics-convince-you-that-provided-code-is-crappy/187330#187330)工具，例如[Findbugs](http://findbugs.sourceforge.net/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T04:13:59.630

框架是达到目的的手段。您要完成的项目是什么？很多人使用 Spring，但对于某些人来说，一些晦涩的开源 API 可能会节省数年的编码时间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T04:22:59.623

在您获取最新和最好的或不获取之前 - 也许您应该注意您实际需要的内容，然后找到最佳匹配 ratehr，而不仅仅是获取 jar 文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-14T04:34:20.470

我也会使用这些工具来构建项目并遵守规则。

Maven构建系统

Nexus 存储库服务器

哈德逊 CI 服务器

PMD，查找错误

格纹风格

老爷车

# ruby-on-rails - ruby on rails 插件acts_as_ferret 是否有问题？

> ID：746310
> 
> 赞同：0
> 
> 时间：2009-04-14T04:14:35.260
> 
> 标签：ruby-on-rails, ruby, plugins, autosuggest, acts-as-ferret

我正在使用acts_as_ferret 对我的数据库进行非常简单的搜索。我把它放在我的“场地”模型中：

```
acts_as_ferret :fields => [:name, :city] 
```

这是在我的控制器搜索操作中：

```
@t = Venue.find_by_contents(params[:search]+'~') 
```

然后我只是渲染结果。

```
render :text => @t.to_json, :success => true, :status => :ok 
```

如果我进行快速测试：

```
http://localhost:3000/venue/list?search=The 
```

我在日志中看到正确的查询“The~”正在索引上执行。但是，我没有得到任何结果。我肯定有一些在名称字段中带有“The”一词的“Venues”。

由于这是一个非常简单的搜索并且经常使用acts_as_ferret，因此我尝试重建索引以查看它是否已损坏......没有骰子

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T06:20:10.590

是的，Ferret 以破坏索引而闻名。

我建议切换到另一个搜索插件，例如[Thinking Sphinx](http://ts.freelancing-gods.com/)。您可以[观看有关它的 Railscast](http://railscasts.com/episodes/120-thinking-sphinx)以了解更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-02T14:46:17.143

我认为问题可能在于“the”被定义为停用词——一个非常常见的词，它没有被索引，因为它只会返回每个文档。您可以配置停用词列表。

如果您在使用 Ferret 时遇到问题，我会考虑使用 Solr。

# c - 连接/打印字符串文字

> ID：746312
> 
> 赞同：2
> 
> 时间：2009-04-14T04:15:52.370
> 
> 标签：c, string

我在连接或打印字符串时遇到了一个奇怪的问题。我有一个 char * 可以设置为字符串文字的几个值之一。

```
char *myStrLiteral = NULL;
...
if(blah)
  myStrLiteral = "foo";
else if(blahblah)
  myStrLiteral = "bar"; 
```

我还有一些其他的字符串，这些字符串是从库函数中获得的，或者是输入的串联——它们要么是 malloc 的，要么是堆栈变量。当我尝试打印（或使用 strcpy() 和 strcat() 连接时，结果是相同的），即使我最后打印字符串文字，它也会打印在*我*正在构建或打印的整个字符串的初始字符上。

```
/* otherString1 contains "hello", otherString2 contains "world" */
printf("%s %s %s\n", otherString1, otherString2, myStrLiteral);

/* prints "barlo world" */ 
```

我是否误解了 C 中的字符串文字？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T04:24:46.373

检查您收到的文字是否仅包含您期望的字节：

```
void PrintBytes(const char *s)
{
    while (*s) {printf("%d ", *s); s++;}
}

PrintBytes(otherString1);
PrintBytes(otherString2);
PrintBytes(myStrLiteral); 
```

我怀疑其中一个包含嵌入式控制字符。

如果您不关心找出涉及*哪个*控制字符，您可以简单地打印每个字符串的长度。如果它比应有的长，则在某处有一个控制字符：

```
printf("%d\n%s\n", strlen(otherString1), otherString1); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T04:25:03.283

我唯一能想到的是 otherString2 包含回车，但不包含换行符。

找出答案

1.  您可以 strlen otherString2 看看它是否与您看到的相符
2.  您可以使用调试器查看 otherString2 并查看 0x0D 是否在 0x00 终止字符串之前。

# ms-access - 在 Access SQL 语句中使用表单中的函数？

> ID：746314
> 
> 赞同：1
> 
> 时间：2009-04-14T04:16:36.003
> 
> 标签：ms-access

我知道如果我在 Access 中创建一个代码模块并在其中放置一个函数，我可以运行一个嵌入了对该函数的调用的查询。但是，我想知道是否可以获得属于**表单代码部分的**函数，以便在查询中被 Access 识别。到目前为止，我找不到办法，但在我看来，这应该是可能的。

谢谢，卡梅伦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T04:21:38.910

您可以 - 必须将函数设为**PUBLIC** ，并且在运行查询时表单必须**打开。**

大多数时候，我将所有常用功能放在单独的代码模块中。

# asp.net-ajax - .net 2.0 ajax 树

> ID：746316
> 
> 赞同：1
> 
> 时间：2009-04-14T04:16:44.910
> 
> 标签：asp.net-ajax, .net-2.0, treeview

对，所以我必须在 asp.net 2.0 winforms 中构建一个 Web 应用程序。我更喜欢 3.5 MVC。因为它更干净、更精简、更现代，对我来说更有意义。我很了解 3.5 MVC，并且来自 Rails 背景，所以这个 webforms 的东西对我来说有点恶心：P。

无论如何，我需要一个支持 AJAX 的树控件，它可以在节点展开时通过 ajax 加载子树。

在 Asp MVC 中，我会做一些事情，比如制作一个表示单个节点的部分，以及一个 jQuery AJAX 触发的控制器操作，该操作呈现这些部分（子）的集合，这些部分（子）被插入到目标的子 div 的 innerHTML 中。

AFAIC，在 .net 2.0 中，我的选择是：

1.  制作一个表示单个节点的 Webforms 控件。使用 Asp AJAX 调用代码隐藏方法，该方法递归添加表示该节点子节点的控件。 **优点：**非常适合官方的 asp 2.0 框架。相当容易。**缺点：** webforms 很糟糕（：p），并且使这个网站以后升级到 3.5 变得更加困难。

2.  创建一个 webservices 方法，将子项作为 JSON 列表返回，然后在客户端 JavaScript 中将其格式化为 HTML，使用 jQuery 进行请求和格式化。**优点**：由于 json 的开销低，速度很快。更加面向未来，因为 json-webservices 很容易过渡到 MVC 控制器方法。**缺点**：需要开发更多的工作。HTML 最终与客户端 javascript 混在一起（因为没有可用的 JSON/javascript 模板），这是可怕的（恕我直言）。

3.  使用第三方网页控件。**优点**：最少的工作（最好的情况下）。**缺点**：必须评估使用哪一个。可能需要购买。学习/处理控制api等

4.  还有什么办法？

那么你们认为最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T20:00:01.643

jstree.com

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T04:33:54.620

我一直在使用 ComponentArt 的树视图。它很容易上手。控件中的 Web 服务支持目前已关闭；但是，它确实允许您查询 url，并且它需要一个简单的 xml 文档，并将其转换为客户端对象。非常容易和快速地获得一个很好的功能齐全的控制系统并快速运行。

对于服务器端，我创建了一个 ASHX 页面，它有助于将服务器端开销降至最低。

# editor - Textmate 2 发生了什么？

> ID：746319
> 
> 赞同：45
> 
> 时间：2009-04-14T04:19:09.007
> 
> 标签：editor, textmate, textmate2

Textmate 2 发生了什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-14T05:26:04.433

我几乎可以肯定，在过去 4 个月内，邮件列表中有一个帖子强烈暗示 - 或直接声明 - 到 2009 年夏天至少会有一个测试版，但我无法挖掘它起来了，所以我不确定。

老实说，我并不是很关心 TextMate。当然，我很想看看，因为新东西总是很酷；但在我看来，TextMate 只缺少 2 个大功能——拆分窗格查看和更好的撤消支持——我发现没有这些我也可以活下去。TextMate 2 可能会很棒，但是当前的 TextMate 是一个非常棒的编辑器，我并不急于 TM2 的问世。

**更新：**公开 alpha 版[将于](http://blog.macromates.com/2011/whats-next/)2011 年圣诞节前发布。

**更新：**现在[可以使用公共 alpha](http://blog.macromates.com/2011/textmate-2-0-alpha/)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-18T04:19:09.457

从[维基](http://wiki.macromates.com/FAQ/TextMate2)：

> **问：TextMate 2 还在开发中，还是已经被放弃了？**
> 
> TM2 正在积极开发中。如果此文本仍然存在，情况仍然如此。（最后更新于 2009 年 4 月 7 日。Allan 强调，还没有“即将发布”的版本。）

作者 Allan Odgaard 用[这篇文章](http://blog.macromates.com/2009/working-on-it/)更新了 TextMate 博客：

> ## 致力于它
> 
> 在过去的两年里，这个博客上的帖子已经放缓到只有涓涓细流，许多 TextMate 用户询问了 TextMate 的状态，或者公开担心它的未来。这篇博文是我很久以来在这里写的第一篇博文，旨在缓解这些担忧并回答一些最常见的问题。
> 
> 简而言之，TextMate 发展势头强劲：TextMate 2 尚未完成，但进展稳定，初具规模，即将结束。重写是一个缓慢而谨慎的过程，但其背后的想法令人兴奋。我希望在接下来的几周和几个月内公开描述一些新的抽象。此外，社区继续为 TextMate 1.5 推出新的捆绑包和功能，我一直在积压描述它们的帖子。虽然我不是写信来宣布 TextMate 2 的发布日期，但我确实希望这篇文章将是系列中的第一篇，显示出更多的透明度。
> 
> TextMate 1 的请求主要是增量添加，例如拆分视图、分块撤消和通过 SFTP 进行编辑。但 TextMate 2 不仅仅是新的表面特征。每个部分都已完全重写，以利用从版本 1 中吸取的经验教训。不仅选择了低级数据结构以提高灵活性，而且 TextMate 构建的抽象——片段、基于范围的语言语法、上下文相关的设置——经过重新考虑，比以往任何时候都更强大。在接下来的几个月里，我将尝试描述其中一些新的抽象，但现在，我知道我对所涉及的新想法感到兴奋。
> 
> 那么发展在哪里代表 2.0？在我看来，大多数模块都在接近，比如 90%。但正如他们所说，在地平线上，山看起来很小。虽然我在自己的日常工作中使用 2.0，而且基本的基础设施相当稳固，但大部分前端仍然需要工作，而且现在它都缺乏成品应用程序的吐槽和润色。希望 alpha 版本很快就会准备好，但我不能对日期做出任何承诺。
> 
> 为什么我没有更好地让世界了解情况？这确实是很多事情的结合，但主要问题是我不擅长为大量观众写作。我更喜欢非正式的对话，例如通过邮件列表或 IRC。因此，虽然我开始了很多帖子，但我最终对它们不满意，它们没有完成或发表。我正在采取措施：我已经聘请了一位技术作家来帮助恢复这个博客，我会尝试通过他更多地传达TextMate的状态和方向。
> 
> 但是，正如我所提到的，比这些问题中的任何一个更大的是 TextMate 2 不是小改款。这是一项时间很长的重大任务，其最终形式尚未完全确定。我不想炒作vaporware，也不想在我知道我能满足他们的期望之前让任何人都抱有希望。
> 
> 此外，我不想在没有机会自己实施的情况下将想法扔到互联网上。我很荣幸 TextMate 已经成为许多其他产品的灵感来源，我希望它在未来继续成为其他开发人员的典范，但我希望先看到我的想法按照我的方式完成，然后再将它们提供给竞赛。
> 
> 我正试图慢慢地转动这艘船。通过这篇文章，我希望能表明手在方向盘上。我知道我对我的计划保持沉默太久了。我无法弥补这一点，但展望未来，我的目标是做得更好。

这是官方博客文章，称公共 alpha 版本将在 2011 年圣诞节前发布。 [http://blog.macromates.com/2011/whats-next/](http://blog.macromates.com/2011/whats-next/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-14T04:35:30.310

艾伦·奥德加德（2007 年 10 月 24 日）：

> [...] 没有预计到达时间，在我确定我可以在下个月内提供（alpha/beta）版本之前，我不会谈论时间安排——因为真的，我说的越多，问的人就越多，并且不得不一遍又一遍地回答相同的问题（对我来说）精神疲惫。因此，将 TM 2.0 与 Duke Nukem Forever 放在一起，并在它发布的那一天感到非常惊讶 :)

上次我听说，它是在私人 Alpha 版中。请记住：耐心是一种美德。:)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-06-17T21:05:36.940

这是作者 Allan Odgaard[在邮件列表中最近发表的一篇文章。](http://old.nabble.com/Re%3A-TM2-p28707277.html)它揭示了当前的发展状态。

简而言之，不要期望很快。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-10-15T08:28:46.310

好吧，这个问题已经过去了 1 1/2 年。而且没有更新。而且没有消息。

我正在从 textmate 继续前进。真的很遗憾，因为它是 Mac 上最好的编辑器。但是，见鬼，即使是织梦者也放弃了它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-02T22:31:24.990

> TextMate 作者被 MacRabbit（Espresso 编辑器背后的公司）聘用，因此 Espresso 可能会成为下一个 TextMate（真可惜……）

文章中的任何地方都没有说。此外，这根本不是真的。MacRabbit 也是像 MacroMates 一样的 1 人公司。Textmate 的开发者住在丹麦；麦克兔住在比利时。

Expresso 是一个不同的编辑器，而不是 Textmate 2。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-10-07T17:04:19.017

我简直不敢相信这是真的，但我刚刚读到它计划于 2010 年 10 月末发布。

[http://wiki.macromates.com/FAQ/TextMate2](http://wiki.macromates.com/FAQ/TextMate2)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-18T23:49:50.803

不完全是这个问题的直接答案，但由于我刚刚注册了一个帐户并且没有代表点来评论答案（或者事实证明包含多个超链接），我会留下我的回复在这里为保罗和瓦西尔：

您绝对应该查看 Ciarán 的TextMate 的[ReMate Update](http://ciaranwal.sh/2007/11/07/remate-update)插件，因为它在使用 NFS 时对我来说非常宝贵。

我也强烈推荐 Ciarán 的其他 TextMate 插件 ProjectPlus (ciaranwal.sh/projectplus)

Ciarán 的最后一个插件......很可能是因为他为 TM1 开发了一些很棒的插件，他还被 Allan (wiki.macromates.com/FAQ/TextMate2) 雇用来开发 TextMate 2

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-11-09T02:55:15.720

世界上真的没有任何借口可以说服 textmate 2 不是vaporware。

即使他正在秘密编写编辑器以摧毁所有其他编辑器，但经过多年的时间以及缺乏任何可靠证据的任何真实证据，都指向糟糕的开发实践和缺乏生产产品的经验。

不幸的是，看起来 textmate 1 是侥幸，而 texmate 2 是软件世界的[中国民主](http://en.wikipedia.org/wiki/Chinese_Democracy)......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-08-01T12:39:52.250

我认为在寻找 TextMate 2 信息时，这个问题仍然是谷歌搜索的热门项目之一，但它充满了谣言和暗示，这让我感到难过。

**他们正在努力工作，**他们正在尝试做的事情非常非常努力。让他们休息一下。我什至为此写了一篇文章：[On TextMate 2](http://hiltmon.blogspot.com/2011/07/on-textmate-2.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-09-26T13:36:21.667

今天在 MacroMates 官方博客上发表了一篇标题为[What's Next的新帖子（我大胆强调）：](http://blog.macromates.com/2011/whats-next/)

> 最近有很多关于TextMate未来的猜测和担忧，主要是关于是否会有另一个主要版本。2.0 的工作开始了，虽然我们希望它可以更快地完成，但我们对它的结果感到非常满意。发展终于到了可以宣布的地步：
> 
> **今年圣诞节前，注册用户将发布一个公开的 alpha 版本。**

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2010-12-15T12:59:30.367

我现在预测，他会在今年的圣诞节给大家一个惊喜，给我们一份礼物。

对他来说，这是一个多么完美的机会，在圣诞节发布一个相对完善的非测试版，然后看着世界上的每个人都变成狗屎。

记住我的话。10天。

* * *

## 回答 #13

> 赞同：-9
> 
> 时间：2009-04-14T05:16:05.720

TextMate 作者[被 MacRabbit](http://blog.olicio.us/2008/09/28/is-espresso-in-reality-textmate-2/)（Espresso 编辑器背后的公司）聘用，因此 Espresso 可能会成为下一个 TextMate（真可惜……）

# java - 使用 Netbeans 6.5 GUI Builder 创建一个 JButton 数组

> ID：746325
> 
> 赞同：4
> 
> 时间：2009-04-14T04:21:14.900
> 
> 标签：java, netbeans, jbutton

我想用 GUI Builder 创建一个 JButtons 数组（实际上不是编写代码，而是绘制它）。我只能弄清楚如何更改元素的名称，而不是将其添加到数组中。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T14:29:25.900

[http://wiki.netbeans.org/FaqGuiControlArray](http://wiki.netbeans.org/FaqGuiControlArray)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T11:22:14.810

我认为您会发现很多“以编程方式”做的事情将超出大多数 GUI 构建器，除了特定的编程例外。

# firefox - 如何从 OS X 上的脚本远程控制 Firefox

> ID：746336
> 
> 赞同：5
> 
> 时间：2009-04-14T04:24:37.920
> 
> 标签：firefox, browser-automation

我需要编写一些访问某些网站的脚本。来自命令行的脚本会获取一些页面、发布一些表单、屏幕抓取一些信息等。

它不能真正成为像*libwww-perl*这样的库“浏览器” ，因为某些步骤可能需要用户交互（[验证码](https://en.wikipedia.org/wiki/CAPTCHA)、仅[Ajax](https://en.wikipedia.org/wiki/Ajax_%28programming%29)表单、任何交互意外等）。

我能想到的最实用的方法是在 Firefox 中远程打开一个选项卡，然后将 JavaScript 代码注入其中，这有点像[Greasemonkey](https://en.wikipedia.org/wiki/Greasemonkey)和[Selenium](https://en.wikipedia.org/wiki/Selenium_%28software%29)所做的。它不一定必须用于 Firefox，如果更容易，它可以是不同的浏览器。

那么最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T05:16:12.913

您是否考虑过[Selenium 遥控器](http://seleniumhq.org/projects/remote-control/)？我之前使用该工具自动进行浏览器交互，它运行良好，提供了很大的灵活性

根据您的具体需求，您也许可以利用[Selenium IDE](http://seleniumhq.org/projects/ide/)，这是一个易于使用的 Firefox 插件，可以轻松编写脚本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T05:21:54.147

您可以使用[XPCOM](https://developer.mozilla.org/en/XPCOM)以各种可以想象的方式扩展 Firefox。您可以编写某种与另一个进程连接的接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T04:45:25.373

我不确定“最好”的方法是什么，但一种可能性是使用 AppleScript 来完成这项工作。然而，Firefox 没有广泛的脚本功能——如果你愿意使用 Safari，可以使用 AppleScript 命令将 JavaScript 代码注入到文档中（该`do JavaScript`命令在 Safari 的脚本字典中查找，可从脚本编辑器中获得）。

此外，为了从命令行运行 AppleScripts，请使用`osascript`：

```
osascript path/to/script.scpt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T01:39:29.690

要在 OS X 上编写脚本，我推荐两种方法，它们都使用 ruby​​。第一个是[Watir](http://wtr.rubyforge.org/)，它是一个自动化测试框架，可以控制 Mac os x 上的 firefox 和 safari。

另一种可能更好的屏幕抓取方法是使用[hpricot](http://wiki.github.com/why/hpricot)，它是一个非常易于使用的 html 解析器。

在后台，Watir 使用 [JSSh - 一个用于 Firefox 的 TCP/IP JavaScript Shell 服务器](http://www.croczilla.com/jssh)来执行此操作。JSSH 允许您从远程登录会话控制浏览器。

无论你走哪条路，如果有追捕者，他们都会阻止你。这就是他们的重点:-)

# c# - 如何克服两个命名空间 System.Linq.Expressions.Expression 中的相同类型 ?

> ID：746340
> 
> 赞同：0
> 
> 时间：2009-04-14T04:25:38.477
> 
> 标签：c#, reference

我在我的应用程序中定义了一些表达式变量，并且需要引用 Microsoft.Scripting.Core。该程序集包含与主 .Net 框架中的 System.Core 程序集相同的命名空间。

我想使用 System.Core 程序集中的定义，因为它是稳定的，而 Microsoft.Scripting.Core 是 alpha。

如何告诉我的应用优先使用 System.Core 中的 System.Linq.Expressions 命名空间而不是 Microsoft.Scripting.Core 但仍然能够保留对它的引用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T04:30:00.557

如果它们是相同的命名空间但不同的程序集，那么您可能需要查看“外部别名”，但这很快就会变得非常混乱。

如果它们是不同的命名空间，那么只需使用不同的`using`指令；你也可以使用`using`别名。但是，lambdas 将始终（AFAIK）使用原始命名空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T05:24:01.100

正如 Marc 所说，这不是非常好 - 但外部别名是要走的路。

在解决方案资源管理器的“参考”部分，选择`System.Core`程序集，转到属性。更改“别名”属性以包括“syscore”，例如

```
Aliases: global,syscore 
```

然后在您要使用的任何文件的顶部`System.Linq.Expressions`，键入：

```
extern alias syscore;
using syscore::System.Linq.Expressions; 
```

这很丑陋，但至少有可能:)

作为警告，我在扩展方法和外部别名方面遇到了一些问题，[如本问题所述](https://stackoverflow.com/questions/453451/resolving-extension-methods-linq-ambiguity)。

# c# - 如何手动发送键盘扫描码？

> ID：746346
> 
> 赞同：4
> 
> 时间：2009-04-14T04:28:12.387
> 
> 标签：c#, sendkeys

我正在开发一个需要模拟 Windows 键的按键的项目。我试过 SendKeys.Send 无济于事。

具体来说，windows 键需要与按钮配合使用。也就是说，我要发送 Windows Key 和加/减。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-16T00:12:21.970

我要补充一点，**您通常不太可能在 .NET 框架中找到像这些较低级别的函数**。如果您对为什么这些建议都指向“非 C#”函数感到困惑，那么您可能可以在[P/Invoke](http://en.wikipedia.org/wiki/Platform_Invocation_Services)上使用一些详细信息。

基本上有一些方法可以定义 C# 函数，将它们“绑定”到 .NET 程序集中不存在的 Windows API 函数（相反，它们通常在 C++ 中实现并作为标准 DLL 提供）。这个过程被认为是“（Windows）平台调用”（因此是 P/Invoke）。

起初，在 C++ 和 C# 风格调用之间匹配所有数据类型可能有点不稳定，但幸运的是，还有其他一些类型已经铺平了道路。

建议的函数[SendInput](http://msdn.microsoft.com/en-us/library/ms646310%28VS.85%29.aspx)在[PInvoke.net](http://www.pinvoke.net)上有一个[PInvoke 包装器](http://www.pinvoke.net/default.aspx/user32.SendInput)。此包装类在您的程序集中可用时，将允许您像调用 C# 函数一样调用 SendInput。

PInvoke.net 基本上是一个用于 Windows 中众所周知的 API 调用的 PInvoke wiki，并且通常具有 API 调用的 C#/VB.NET 包装器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T05:09:56.687

我认为您最好的选择是使用带有[System.Windows.Forms.Keys](http://msdn.microsoft.com/en-us/library/system.windows.forms.keys.aspx)枚举的 LWin 值的[keybd_event](http://msdn.microsoft.com/en-us/library/ms646304(VS.85).aspx) keydown（称为 ExtendedKey） ，然后使用 keydown 第二个字符 (+) 和 keyup 两个键。

我不相信 SendKeys 可以将 Windows 键用作修饰符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T04:46:26.510

尝试[SendInput](http://msdn.microsoft.com/en-us/library/ms646310(VS.85).aspx)或旧的[keybd_event](http://msdn.microsoft.com/en-us/library/ms646304(VS.85).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T12:31:43.027

这可能有点矫枉过正，但您可以尝试使用[AutoItX](http://www.autoitscript.com/autoit3/)，这是一种将 AutoIt 用作 DLL 的方法。我只编写了独立的脚本，但我知道 AutoIt 可以很容易地模拟按下 Windows 键。

例如，打开运行对话框就是：

> 发送("#r") ;Win + R = 运行

# c# - .NET 和 Javascript 中的简单字符串加密

> ID：746347
> 
> 赞同：11
> 
> 时间：2009-04-14T04:28:25.337
> 
> 标签：c#, .net, javascript, string, encryption

我正在开发一个 ASP.NET MVC 应用程序，我想在其中使用 C# 在服务器上加密一个短字符串，并将其发送到客户端。

然后在客户端，它将通过 Javascript 代码解密。

关于如何实现这一点的任何想法？

您是否知道可以轻松地从 C# 转换为 Javascript 或反之亦然的简单加密算法（不必是防弹安全的）？

注意：我可以完全在 C# 中执行此操作并通过 Ajax 进行解密，但我不希望这样做，因为我想尽可能减少网站流量。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-14T05:06:22.140

听起来您想要混淆或编码，而不是加密。[Base64 编码](http://en.wikipedia.org/wiki/Base64)在这里应该可以正常工作。结果看起来与电子邮件地址完全不同，并且编码过程很快。

在 C# 中，您可以使用：

```
string emailAddress = "abc@example.com";
string encoded = Convert.ToBase64String(Encoding.UTF8.GetBytes(emailAddress)); 
```

您可以使用此 JavaScript 函数对其进行解码：

```
function Base64Decode(encoded) {
   var keyStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
   var output = "";
   var chr1, chr2, chr3;
   var enc1, enc2, enc3, enc4;
   var i = 0;

   do {
      enc1 = keyStr.indexOf(encoded.charAt(i++));
      enc2 = keyStr.indexOf(encoded.charAt(i++));
      enc3 = keyStr.indexOf(encoded.charAt(i++));
      enc4 = keyStr.indexOf(encoded.charAt(i++));

      chr1 = (enc1 << 2) | (enc2 >> 4);
      chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
      chr3 = ((enc3 & 3) << 6) | enc4;

      output = output + String.fromCharCode(chr1);

      if (enc3 != 64) {
         output = output + String.fromCharCode(chr2);
      }
      if (enc4 != 64) {
         output = output + String.fromCharCode(chr3);
      }
   } while (i < encoded.length);

   return output;
} 
```

C# 应用程序将字符串编码`abc@example.com`为`YWJjQGV4YW1wbGUuY29t`，而 JavaScript 版本将解码`YWJjQGV4YW1wbGUuY29t`回`abc@example.com`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-14T05:05:10.613

一个简单的[XOR Cipher](http://en.wikipedia.org/wiki/XOR_cipher)怎么样？

这两种实现完全兼容：

*   [简单 XOR 加密](http://www.eggheadcafe.com/tutorials/aspnet/8b53894c-a889-4914-8c46-122980cc44ae/simple-xor-encryption.aspx)(C#)
*   [JavaScript XOR 加密](http://guymal.com/mycode/xor_js_encryption/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-14T04:59:30.143

[System.Security.Cryptography](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aspx)有一堆可以使用的对称（和非对称）加密算法。（对于一些超级安全的使用[aes](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)）

您应该能够找到大多数匹配的 Javascript 实现（这里有一些 JS 中的 aes 实现）

*   [http://www.movable-type.co.uk/scripts/aes.html](http://www.movable-type.co.uk/scripts/aes.html)
*   [http://www.hanewin.net/encrypt/aes/aes.htm](http://www.hanewin.net/encrypt/aes/aes.htm)

注意：如果您打算使用基于私钥的加密，请记住，您的网页将嵌入密钥，这意味着这一切都变得毫无意义，因为任何有权访问该页面的人都可以进行解密，充其量你会让屏幕刮板的生活变得更加艰难。如果你的目标是让屏幕刮板更难，你可以使用混淆算法。对于没有 javascript 引擎的屏幕抓取工具，任何微不足道的实现都是非常不切实际的：

例如。

```
function samObsfucated()
{
    return("s" + "a" + "m" + "@" + "s" + "." + "com");
} 
```

然后 onload 使用这些函数的输出填充您的电子邮件字段。

Javascript 加密对于为用户存储密码的软件有一个非常好的用例 ala [clipperz](http://www.clipperz.com/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T04:35:44.507

就可能可行的最简单的事情而言，您似乎想要一种简单的混淆形式，而不是任何真正安全的东西。

[Rot-13](http://en.wikipedia.org/wiki/ROT13)可能就足够了，前提是您要与使用 ASCII 电子邮件地址的受众打交道。如果您需要支持 Unicode，那么您可能需要稍微复杂一些的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T04:30:17.703

您可以使用 HTTPS 加密客户端和服务器之间的所有流量吗？这可能是您会发现的最安全的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-06-05T10:26:14.613

非常简单的功能，

```
function Encrypt(value) 
{
  var result="";
  for(i=0;i<value.length;i++)
  {
    if(i<value.length-1)
    {
        result+=value.charCodeAt(i)+10;
        result+="-";
    }
    else
    {
        result+=value.charCodeAt(i)+10;
    }
  }
  return result;
}
function Decrypt(value)
{
  var result="";
  var array = value.split("-");

  for(i=0;i<array.length;i++)
  {
    result+=String.fromCharCode(array[i]-10);
  }
  return result;
} 
```

# javascript - JavaScript 翻转计数器

> ID：746353
> 
> 赞同：19
> 
> 时间：2009-04-14T04:30:03.897
> 
> 标签：javascript, animation, counter, flip

我想在我的网站上添加一个翻转计数器，类似于 Apple 用于其[10 亿应用程序倒计时](http://www.macrumors.com/2009/04/10/apple-launches-1-billion-app-countdown-promotion/)的计数器。

![在此处输入图像描述](https://i.stack.imgur.com/cHLPq.jpg)

任何人都可以让他们的 JavaScript 独立工作吗？

***如果有人可以提供工作代码，那就太好了。***

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-14T04:44:09.120

他们使用 CSS 和 JavaScript 的组合。翻转动画由类似[CSS Sprite](http://css-tricks.com/css-sprites/)的技术提供支持。

首先，他们有一个非常高的图像，称为`filmstrip.png`包含每个数字的每个翻转“状态”（0 到 9；看看[按比例缩小的细节](https://i.stack.imgur.com/jwaVW.png)，你就会明白我的意思）。

然后，在 HTML 中，每个数字由三个嵌套元素组成：

*   第一个是容器元素，它的`width`和`height`设置为单个翻转“状态”的尺寸，并且`overflow`设置为`hidden`。这个元素是相对定位的。

*   第二个元素是绝对定位的（因为第一个元素是相对定位的，所以第二个元素*相*对于第一个元素是绝对定位的）。

*   第三个元素将其`background-image`设置为`filmstrip.png`，并将其`width`设置`height`为该图像的尺寸。

然后，JavaScript 似乎迅速改变了`top`第二个元素的属性，导致不同部分`filmstrip.png`一个接一个地暴露出来，从而产生翻转动画。

史蒂夫

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-01-05T10:22:20.897

到这里，准备在你自己的网页中实现 [http://cnanney.com/journal/code/apple-style-counter-revisited/](http://cnanney.com/journal/code/apple-style-counter-revisited/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-28T16:52:25.950

我制作了一个计数器，它可以用非常少的 javascript 给它一点“大脑”：

[![在此处输入图像描述](https://i.stack.imgur.com/U3reZ.gif)](http://codepen.io/vsync/pen/dlwgj)

```
function Counter(selector, settings){
  this.settings = Object.assign({
    digits: 5,
    delay: 250, // ms
    direction: ''  // ltr is default
  }, settings||{})

  var scopeElm = document.querySelector(selector)

  // generate digits markup
  var digitsHTML = Array(this.settings.digits + 1).join('<div><b data-value="0"></b></div>')
  scopeElm.innerHTML = digitsHTML;

  this.DOM = {
    scope : scopeElm,
    digits : scopeElm.querySelectorAll('b')
  }

  this.DOM.scope.addEventListener('transitionend', e => {
    if (e.pseudoElement === "::before" && e.propertyName == 'margin-top'){
      e.target.classList.remove('blur')
    }
  })

  this.count()
}

Counter.prototype.count = function(newVal){
  var countTo, className, 
      settings = this.settings,
      digitsElms = this.DOM.digits;

  // update instance's value
  this.value = newVal || this.DOM.scope.dataset.value|0

  if( !this.value ) return;

  // convert value into an array of numbers
  countTo = (this.value+'').split('')

  if(settings.direction == 'rtl'){
    countTo = countTo.reverse()
    digitsElms = [].slice.call(digitsElms).reverse()
  }

  // loop on each number element and change it
  digitsElms.forEach(function(item, i){ 
      if( +item.dataset.value != countTo[i]  &&  countTo[i] >= 0 )
        setTimeout(function(j){
            var diff = Math.abs(countTo[j] - +item.dataset.value);
            item.dataset.value = countTo[j]
            if( diff > 3 )
              item.className = 'blur';
        }, i * settings.delay, i)
  })
}

/////////////// create new counter for this demo ///////////////////////

var counter = new Counter('.numCounter', {direction:'rtl', delay:200, digits:7})
setInterval(randomCount, 3000)

function randomCount(){
  counter.count( getRandomNum(0, 9999999))
}

function getRandomNum(min,max){
    return Math.floor(Math.random()*(max-min+1) + min)
}
```

```
.numCounter {
  display: inline-block;
  height: 90px;
  line-height: 90px;
  text-shadow: 0 0 2px #fff;
  font-weight: bold;
  white-space: normal;
  font-size: 50px;
}

.numCounter > div {
  display: inline-block;
  vertical-align: top;
  height: 100%;
}

.numCounter > div > b {
  display: inline-block;
  width: 40px;
  height: 100%;
  margin: 0 0.1em;
  border-radius: 8px;
  text-align: center;
  background: white;
  overflow: hidden;
}

.numCounter > div > b::before {
  content: ' 0 1 2 3 4 5 6 7 8 9 ';
  display: block;
  word-break: break-all;
  -webkit-transition: 0.5s cubic-bezier(0.75, 0.15, 0.6, 1.15), text-shadow 150ms;
  transition: 0.5s cubic-bezier(0.75, 0.15, 0.6, 1.15), text-shadow 150ms;
}

.numCounter > div > b.blur {
  text-shadow: 2px 1px 3px rgba(0, 0, 0, 0.2), 
               0 0.1em 2px rgba(255, 255, 255, 0.6), 
               0 0.3em 3px rgba(255, 255, 255, 0.3), 
               0 -0.1em 2px rgba(255, 255, 255, 0.6), 
               0 -0.3em 3px rgba(255, 255, 255, 0.3);
}

.numCounter > div > b[data-value="1"]::before { margin-top: -90px; }
.numCounter > div > b[data-value="2"]::before { margin-top: -180px;}
.numCounter > div > b[data-value="3"]::before { margin-top: -270px;}
.numCounter > div > b[data-value="4"]::before { margin-top: -360px;}
.numCounter > div > b[data-value="5"]::before { margin-top: -450px;}
.numCounter > div > b[data-value="6"]::before { margin-top: -540px;}
.numCounter > div > b[data-value="7"]::before { margin-top: -630px;}
.numCounter > div > b[data-value="8"]::before { margin-top: -720px;}
.numCounter > div > b[data-value="9"]::before { margin-top: -810px;}

.numCounter > div:nth-last-child(3n)::before {
  content: ",";
  display: inline;
  font-size: 1.1em;
  opacity: .6;
  color: white;
}

html, body {
  height: 100%;
}

body {
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: Arial;
}

.numCounter {
  overflow: hidden;
  padding: .4em;
  text-align: center;

  border-radius: 16px;
  background: black;
}
.numCounter b {
  color: black;
}
```

```
<div class='numCounter' data-value='1839471'></div>
```

它看起来很棒，现场表演也很好，它可以从任何数字计算到任何数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T02:35:58.267

在搜索相同的东西时，我发现了一个提供此功能的商业产品：[Sprite Countdown Flip](http://codecanyon.net/item/gaur-countdown-with-animation/2665769?ref=oberto)。

注意：我不隶属于该产品；但它做得很好，可能对某人有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-18T10:32:55.720

我推荐开源变体：[FlipclockJS](http://flipclockjs.com/)，它可能是在此事件之后创建的 :)

Github：[objectivehtml/FlipClock](https://github.com/objectivehtml/FlipClock)，可通过 NPM 和 Bower 获得（未维护）

# inversion-of-control - 使用 Autofac 有什么优点和缺点

> ID：746354
> 
> 赞同：5
> 
> 时间：2009-04-14T04:30:10.917
> 
> 标签：inversion-of-control, autofac

我读过 Autofac 说它很快。我看过所涉及的编码，它非常整洁。但我不太确定如何使用它。我用过 StructureMap，它有一个静态的 ObjectFactory。Ninject 有内核，但在 Autofac 的 Google 页面中，他们建议这样做：

```
using( var resolver = builder.Build() ){
   var whatINeed = resolver.Resolve<INeedThisService>();
} 
```

这是一个 WinForms 应用程序，所以我从上面的操作中得到了一个无效的对象状态，所以我切换到了一个全局 IContainer，并这样做了

```
 using( var resolver = Program.Container.CreateInnerContainer() )
 {
     var whatINeed = resolver.Resolve<INeedThisService>();
 } 
```

我已经使用了大约 3 或 5 次。但这有效吗？还是我应该做类似的事情

```
 var whatINeed = Program.Resolve<INeedThisService>() 
```

并在幕后

```
 internal static TServervice Resolver<TService>(){
       if(_container == null ) _container = builder.Build();
       return _container.Resolve<TService>();
 } 
```

你会使用哪个，为什么？使用 CreateInnerContainer() 也会受到惩罚吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-10T19:30:04.420

我不是 AutoFac 专家，但对其他 Ioc 容器有经验。我认为这个问题会给我一个尝试 AutoFac 的理由。

基于 Ioc 容器的设计应努力将所有代码与对容器的访问隔离开来，入口点或主机级别除外。我使用 AutoFac 和 WinForms 创建了以下示例，以展示表单如何通过其构造函数访问服务。

我不太清楚你为什么认为你需要内部容器。也许您可以发表评论，我可以提供更详细的答复。

```
static class Program
{
    [STAThread]
    static void Main()
    {
        var builder = new ContainerBuilder();
        builder.Register<TheService>().As<INeedThisService>();
        builder.Register(f => new Form1(f.Resolve<INeedThisService>())).As<Form1>();

        using (var container = builder.Build())
        {
            Application.Run(container.Resolve<Form1>());
        }

    }
}

public interface INeedThisService { }

public class TheService : INeedThisService
{
    public TheService() { Console.WriteLine("ctor ThisService"); }
}

public partial class Form1 : Form
{
    public Form1(INeedThisService service)
    {
        Console.WriteLine("ctor Form1");
        InitializeComponent();
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-11-09T05:31:22.803

1）从您提供的示例中，我可以假设您主要尝试将 IOC 容器用作服务定位器。尽管几乎所有容器都支持它，但主要用途是**依赖注入**。这意味着您应该完全避免调用 Resolve 方法并让容器为您注入所有依赖项。其中两个（服务定位器和依赖注入）之间的差异超出了本主题。

2）如果您仍想将其用作服务定位器，您可以只使用根容器（在您的情况下为*Program.Container*）而不创建内部容器。顺序是：

*   创建容器构建器
*   在构建器中注册您的组件
*   创建根容器：builder.Build()
*   访问根容器以解析组件实例

3) 容器层次结构在您需要不同范围内的单例行为的场景中很有用：

*   全局\会话\请求（Web应用程序）
*   Application \ Plugin（基于桌面插件的应用程序）

BTW Autofac 鼓励人们使用[标记上下文](http://code.google.com/p/autofac/wiki/TaggedContexts)来解决此类问题：

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-01T20:44:01.160

正如 Mark Lindell 所指出的，您通常不需要在 Autofac 应用程序中直接访问容器。

推荐的方法是在应用程序启动时访问它一次，就像 Mark 所做的那样。

随后需要创建对象的其他组件可以声明一个 IContext 类型的构造函数参数，Autofac 将自动注入该参数。

另一种不需要依赖 Autofac 程序集的方法是使用 Generated Factories，如下所述：[http ://code.google.com/p/autofac/wiki/DelegateFactories](http://code.google.com/p/autofac/wiki/DelegateFactories)

希望这可以帮助！

# c++ - C++中最好的统计库？

> ID：746364
> 
> 赞同：33
> 
> 时间：2009-04-14T04:41:07.130
> 
> 标签：c++, math, statistics

我正在寻找高性能代码（需要实时运行），最好是开源的，但如果没有免费和高性能的东西，我会花钱买一些得到很好支持和高质量的东西。

有什么建议么？

这些是我到目前为止找到的，没有特别的顺序：

[代码齿轮](http://www.codecogs.com/index.php)

[GSL](http://www.gnu.org/software/gsl/)

[头孢](http://www.boutell.com/lsm/lsmbyid.cgi/000626)

[Boost MathToolkit](http://www.boost.org/doc/libs/1_38_0/libs/math/doc/sf_and_dist/html/index.html)

[闪电战++](http://www.oonumerics.org/blitz/)

[TNT](http://math.nist.gov/tnt/)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-14T04:54:27.270

检查 mathtools.net 上的链接。[C++ 的统计库](https://web.archive.org/web/20150221155223/http://www.mathtools.net/C_C__/Statistics/index.html)页面有链接。另一个页面[http://www.thefreecountry.com/sourcecode/mathematics.shtml](http://www.thefreecountry.com/sourcecode/mathematics.shtml)列出了更多。

你检查过' [R项目](http://www.r-project.org/)'吗？我认为您可以从 C/C++ 调用“R 对象”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-08-16T08:19:11.150

我很惊讶没有人提到 ALGLIB：[http ://www.alglib.net/](http://www.alglib.net/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T14:37:14.187

[Root](http://root.cern.ch/)有很好的统计支持。至少正如我们粒子物理学类型判断这些东西一样。在 cint 解释中工作或作为本机 c++ 库工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T13:17:16.290

TNT 用于矩阵计算，但没有任何统计功能。（例如 erf、mean/std/cov 等）

我没有使用过 Boost Math Toolkit，但是浏览了文档，看起来它有相反的问题，例如很多用于标量计算的好东西，但不支持（我能找到）多变量情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T14:53:48.187

我过去使用过[IT++](http://itpp.sourceforge.net/)库，该库通过 BLAS 和 LAPACK 支持 ACML 和 MKL 例程。如果需要快速进行计算，则可以将此库与 HPC 一起使用，尽管这是一个未记录的功能，因此需要一些思考。然而，这个库的重点是矩阵计算，但是由于其出色的信号处理支持，许多普通的数学和统计函数可以在这个框架中找到。

# php - 在 php 中调试被调用 web 服务的最佳方法？

> ID：746366
> 
> 赞同：5
> 
> 时间：2009-04-14T04:42:06.147
> 
> 标签：php, debugging, phped

我有一个 n 层系统，其中前端模板层调用后端应用程序服务器。比如我需要检索一些搜索结果，前端调用后端获取结果。

模板引擎和应用服务器都是用 PHP 编写的。我目前使用 PHPed 来启动到模板引擎的调试会话，但是，当 http 请求发送到远程服务时，我的调试器只是坐下来等待 IO 完成。

我想做的是模拟 HTTP 调用，但实际上只是留在我的 PHP 进程中，将环境巨大推送到某种堆栈上，然后让我的 appserver 环境加载并处理调用。调用完成后，我执行 env pop，并在 var 中获取 http 调用的结果（例如，通过输出缓冲区）。我*可以*在同一台服务器上运行这两种服务。有没有人有任何想法或图书馆已经这样做了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T12:13:30.530

你能不运行调试器并在应用服务器中设置断点吗？两种不同的调试会话 - 一种用于捕获模板引擎调用，另一种用于捕获应用服务器中的调用。

您应该能够在模板引擎调试会话中跟踪来自应用服务器的输出。

如果无法运行两个调试会话，则通过捕获模板引擎的输出为应用服务器创建一些测试输入，并将单个调试器与您的测试应用服务器输入一起使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T10:07:57.690

这是令人尴尬的粗略，并且完全没有任何关于调试器如何工作的研究，但是您是否尝试过添加

```
 debugBreak(); 
```

在您调用的例程的入口点？（假设两个进程在同一台机器上运行）。

我已经使用这种技术重新进入了一个通过 AMFPHP 调用的进程。我有一个 PHP 文件将 Flash 文件加载到浏览器中，然后使用 AMFPHP 回调 PHP，所有这些都在同一台服务器上。当我点击 debugBreak() 行时，PhpED 重新获得控制权。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T00:03:24.263

为什么不使用 HTTP 嗅探器？类似 tcpflow 的东西。

或者，您可以将完整的 XML 记录到每个请求和响应的文件中。

不幸的是，您的问题尚不清楚您要达到的目标，因此这些只是猜测。您可能应该更清楚地说明您要解决的问题。

您可能会重构调用删除服务并使用依赖注入和模拟的代码。这将允许您通过提供“模拟”但有效的数据来隔离前端的开发。

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T13:27:07.957

我可以假设您在谈论 PHP 中缺少线程，因此该服务会停止您的程序流并停止调试器吗？有一些方法可以解决它，但它们很难，笨重和hackish。

例如，如果你使用 Zend 之类的框架来处理 HTTP 流量，你可以破解 HTTP 类以使用原始套接字来进行服务读/写而不是内置的东西，并创建一个小的任务切换器（循环 :)跟踪正在发生的事情。

您当然可以使用 fopen ( 'http://...' ) 并在循环中分块 fread ，这可以解决问题，但您需要打开流中的 http: 支持。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-24T16:56:52.660

*我对 PHP调试*了解不多，而且我不确定我是否遵循“将环境推送到某种堆栈”，但我想知道 netcat + 一些 shell 脚本是否可以用于*故障排除*？

您可以使用 netcat 来：

*   欺骗 HTTP 请求
*   像网络服务器一样工作（监听一个端口 - 选择一个端口，任何端口！）

[http://www.plenz.com/netcat-tips](http://www.plenz.com/netcat-tips)

您可以使用它在一端存根伪造的 Web 服务：

```
echo "<xml .. <node>hello php!</node>" | netcat -lp 80 ... etc 
```

...您当然可以使用它在端口上侦听以非常清楚地查看传入 Web 服务的请求是什么样的。

您可以使用带有 netcat 作为中间人的 shell 脚本，它就像您的 web 服务一样，立即返回一些通用的东西以使您的 PHP 快乐，然后将请求传递给您的实际应用服务器并记录结果？

超级简单。

[netcat 网络服务器 http://img240.imageshack.us/img240/791/netcat.jpg](http://img240.imageshack.us/img240/791/netcat.jpg)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-25T16:09:06.277

这不是开源的，但请查看[Charles](http://www.charlesproxy.com/)。它作为代理工作，是迄今为止我见过的最好的调试代理。它适用于 linux、os/x 和 windows。

几乎任何 HTTP 库都允许您指定代理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-04T06:59:36.710

[PhpED](http://www.nusphere.com/products/phped.htm)支持[并行调试会话](http://www.nusphere.com/products/php_debugger_advanced.htm)- 这意味着您可以开始调试向初始服务器发出请求的代码，然后也可以调试服务器间请求。您只需要在相应的项目中设置断点并在服务器之间传递调试器请求。通常，您可以通过将 DBGSESSID（调试器请求）变量的值及其值重新传输到第二台服务器来执行此操作。该变量可以在 $_COOKIES 和/或 $_GET 中找到（取决于您如何开始调试——从 IDE 或使用调试器工具栏）。要将变量重新传输到辅助服务器，您可以将其添加到 POST 变量或作为 URL 参数或 cookie。如果您的服务器从 get/post/cookies 中过滤掉所有内容，您无法做到这一点，请尝试嵌入 DebugBreak() 调用。确保您的所有服务器都可以通过请求中的 IP 地址找到 IDE，并允许连接回 IDE——例如 您在防火墙和 LinuxSE 中有必要的规则（购买默认此 SE 层已在所有现代 Linux 中启用）。我花了一天时间才弄清楚为什么我的服务器无法连接。

如果无法从服务器连接到 IDE（如果带有 IDE 的工作站位于不同的网络中，例如在您家中），您可以使用[ssh tunnels](http://www.nusphere.com/products/php_editor_ssh_tunnel.htm)。在这种情况下，IDE 地址当然是 localhost。

# jquery - 当 ajax 调整其上方的对象大小时，Safari 会突出显示工件

> ID：746376
> 
> 赞同：0
> 
> 时间：2009-04-14T04:47:17.520
> 
> 标签：jquery, ajax, safari

在 Safari 3.2.1 上，我观察到如果 textarea 被突出显示为活动控件，并且其上方的对象调整大小（例如，加载 img），则在 textarea 移动以适应新布局后会留下突出显示的片段。如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T15:31:58.427

这是 Safari 中的一个错误。您可能可以通过触发页面重绘（例如稍微更改背景颜色）来解决它，但我认为最好不要使用这样的黑客来修复一个小的浏览器错误。您可以在 Apple 报告该错误，并查看它是否已在 Safari 4 测试版中修复。

# c# - Internet 上的代理 Kerberos Web 服务安全性

> ID：746377
> 
> 赞同：1
> 
> 时间：2009-04-14T04:47:18.567
> 
> 标签：c#, web-services, security, kerberos

是否可以通过 Internet 对 Web 服务使用代理 Kerberos 身份验证？我正在研究已经具有 Active Directory 的环境的 Web 服务安全性。由于现有的架构，Web 服务会很繁琐，我无法控制这个架构。执行一个业务流程最多可能需要 6 个 Web 服务调用。

存在对多次身份验证以及这将产生的开销的担忧。从我对代理 kerberos 身份验证的初步阅读来看，一旦提供了用户凭据，就会返回一个 Kerberos 安全令牌，并且每个 Web 服务调用都不需要身份验证。

我正在设想一个系统，其中用户凭据通过 Web 服务调用传递到 Active Directory，并返回 Kerberos 令牌。然后，此令牌将用于所有后续 Web 服务调用。

这是可能的还是我正在切线？如果我正在切线前进，是否有首选方法？我已阅读完 Microsoft Web 服务安全性：WSE 3.0 的场景、模式和实施指南，但仍有点不清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-18T13:12:18.473

考虑利用 SAML 协议作为通过 WS-Security 交换断言的一种方式。

# windows-ce - 自定义/替换 Windows CE 5.0 任务栏？

> ID：746378
> 
> 赞同：1
> 
> 时间：2009-04-14T04:48:00.780
> 
> 标签：windows-ce, taskbar

我目前正在使用 Win CE 5.0 来更新现有平台上的一些代码。我们也有兴趣部署自定义外壳/主屏幕/应用程序启动器，我有几个问题：

1）我们正在运行标准的 CE shell，我假设它可以定制，因为源代码可通过 Platform Builder 获得。我想知道用屏幕顶部的状态栏之类的东西完全替换它会有多“痛苦”（想想 iPhone）。我在想任务切换可以由快捷键专门处理。我对此表示怀疑。

2）如果不能删除，任务栏可以调整大小并移动到屏幕顶部吗？我们基本上试图找到一种方法来为我们自己的状态栏保留屏幕顶部的前 20 左右像素行，并防止最大化的应用程序窗口在其顶部绘制。

非常感谢您的帮助。

-ksudeadeye

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-12T12:01:09.580

隐藏任务栏是一个简单的注册表更改：

```
; Hide the windows tasbar by default.
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shell\AutoHide]
""=dword:1
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shell\OnTop]
""=dword:0 
```

至于定制，你自己的，那是更多的工作，而不是我尝试过的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-27T17:11:14.663

当我找到解决方案时，我既高兴又生气，因为它比我预期的要容易。对于 2) 保留空间，您需要这样做：

```
RECT rc;
SetRect(&rc, 0, 25, GetSystemMetrics(SM_CXSCREEN),GetSystemMetrics(SM_CYSCREEN));
SystemParametersInfoW(SPI_SETWORKAREA, 0, (void*) &rc, SPIF_SENDCHANGE); 
```

使用此代码，您可以在屏幕顶部保留 25 个像素。:D

如果您有疑问，也许[这](http://leo-luo.spaces.live.com/?_c11_BlogPart_BlogPart=blogview&_c=BlogPart&partqs=cat%3DTrip%2520of%2520Mobile)可以帮助您或[this](http://social.msdn.microsoft.com/Forums/en-US/vssmartdevicesnative/thread/89d434c4-43cb-40a0-85b1-577543717add)。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-27T12:25:43.567

我有一些在 CE 5.0 中修改任务栏的经验。这不是一件容易的事，但结果确实可以为设备增添个人风格。我的任务是添加一个带有密码对话框的用户模式第二个任务栏和第二种类型的 shell 通知，以向用户栏添加图标。

最后，它只是标准的 Windows CE 编程——任务栏、通知托盘、开始按钮等就像 CE 环境中的任何其他窗口一样。

你应该从这里开始探索：C:\WINCE500\PUBLIC\SHELL\OAK\HPC\EXPLORER\TASKBAR\taskbar.cpp

小心，克隆你的代码，并为大量的调试周期做好准备。这是超过 5000 行严重的意大利面条代码。

# ruby-on-rails - 轨道形式的单选按钮标签

> ID：746387
> 
> 赞同：151
> 
> 时间：2009-04-14T04:52:49.817
> 
> 标签：ruby-on-rails, forms

我的问题与[此](https://stackoverflow.com/questions/658689/how-to-associate-labels-with-radio-buttons)类似， 但针对的是 Rails 应用程序。

我有一个带有一些单选按钮的表单，并且想将标签与它们相关联。表单助手仅将`label`表单字段作为参数，但在这种情况下，我为单个表单字段设置了多个单选按钮。我看到的唯一方法是手动创建一个标签，硬编码为单选按钮自动生成的 ID。有谁知道更好的方法吗？

例如：

```
<% form_for(@message) do |f| %>
    <%= label :contactmethod %>
    <%= f.radio_button :contactmethod, 'email', :checked => true %> Email
    <%= f.radio_button :contactmethod, 'sms' %> SMS
<% end %> 
```

这会产生类似的东西：

```
<label for="message_contactmethod">Contactmethod</label>
<input checked="checked" id="message_contactmethod_email" name="message[contactmethod]" value="email" type="radio"> Email
<input id="message_contactmethod_sms" name="message[contactmethod]" value="sms" type="radio"> SMS 
```

我想要的是：

```
<input checked="checked" id="message_contactmethod_email" name="message[contactmethod]" value="email" type="radio"><label for="message_contactmethod_email">Email</label>
<input id="message_contactmethod_sms" name="message[contactmethod]" value="sms" type="radio"> <label for="message_contactmethod_sms">SMS</label> 
```

* * *

## 回答 #1

> 赞同：237
> 
> 时间：2010-11-05T00:10:52.850

`:value`将选项传递给`f.label`将确保标签标签的`for`属性与对应的id相同`radio_button`

```
<%= form_for(@message) do |f| %>
  <%= f.radio_button :contactmethod, 'email' %> 
  <%= f.label :contactmethod, 'Email', :value => 'email' %>
  <%= f.radio_button :contactmethod, 'sms' %>
  <%= f.label :contactmethod, 'SMS', :value => 'sms' %>
<% end %> 
```

请参阅[ActionView::Helpers::FormHelper#label](https://rdoc.info/gems/actionview/6.1.4.1/ActionView/Helpers/FormHelper#label-instance_method)

> :value 选项，旨在针对 radio_button 标签的标签

* * *

## 回答 #2

> 赞同：151
> 
> 时间：2009-04-14T05:13:11.717

```
<% form_for(@message) do |f| %>
  <%= f.radio_button :contactmethod, 'email', :checked => true %> 
  <%= label :contactmethod_email, 'Email' %>
  <%= f.radio_button :contactmethod, 'sms' %>
  <%= label :contactmethod_sms, 'SMS' %>
<% end %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-29T13:19:08.310

如果您希望 object_name 以任何 ID 为前缀，您应该在表单对象上调用表单助手：

```
- form_for(@message) do |f|
  = f.label :email 
```

如果出现任何验证错误等，这还可以确保任何提交的数据都存储在内存中。

如果您无法在表单对象上调用表单助手方法，例如，如果您使用标签助手（radio_button_tag 等），您可以使用以下方法插入名称：

```
= radio_button_tag "#{f.object_name}[email]", @message.email 
```

在这种情况下，您需要手动指定该值以保留任何提交。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-03T23:00:51.240

如果传递给表单的模型已填充此属性，则使用`true`/`false`作为值将预先填充该字段：

```
= f.radio_button(:public?, true)
= f.label(:public?, "yes", value: true)
= f.radio_button(:public?, false)
= f.label(:public?, "no", value: false) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-17T15:14:37.233

这是我的项目中使用`radio`按钮及其`label`s进行评级的示例

```
<div class="rating">
  <%= form.radio_button :star, '1' %>
  <%= form.label :star, '☆', value: '1' %>

  <%= form.radio_button :star, '2' %>
  <%= form.label :star, '☆', value: '2' %>

  <%= form.radio_button :star, '3' %>
  <%= form.label :star, '☆', value: '3' %>

  <%= form.radio_button :star, '4' %>
  <%= form.label :star, '☆', value: '4' %>

  <%= form.radio_button :star, '5' %>
  <%= form.label :star, '☆', value: '5' %>
</div> 
```

# java - Java 屏幕截图小程序

> ID：746388
> 
> 赞同：3
> 
> 时间：2009-04-14T04:54:09.877
> 
> 标签：java, sdk, applet, screen-capture

我想知道是否有任何我可以使用和自定义的小程序来捕获 java 中的用户屏幕（windows 和 mac）？我看到了 jxCapture，但它只需要屏幕截图。我想使用该工具捕获屏幕（用于截屏），然后导出为 flv 格式。

我想知道什么是最好的解决方案？有没有我可以定制的applet/sdk？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T06:02:44.797

不久前我用java尝试了类似的事情，问题是你不能足够快地截图，我什至无法获得1 fps

[Java Robot createScreenCapture 性能](https://stackoverflow.com/questions/646089/java-robot-createscreencapture-performance)

# c++ - 从具有运算符重载的类派生

> ID：746391
> 
> 赞同：2
> 
> 时间：2009-04-14T04:57:08.700
> 
> 标签：c++, templates

我想创建一个行为类似于数学向量的类的集合，以便将对象乘以标量将每个字段乘以该数量等。问题是我希望字段具有实际名称，而不是被视为指数。

我最初的想法是使用重载创建一个基类 Rn，然后使用漂亮的名称创建派生类。像这样的东西：

```
#include <iostream>
#include <algorithm>
using namespace std;

template<int N, class X=double>
struct Base{
    X xs[N];

    Base(){};

    Base(X *data){
        copy(data, data+N, xs);
    }

    Base operator*= (double d){
        for(int i=0; i<N; i++){
            xs[i] *= d;
        }
        return *this;
    }

    Base operator* (double d){
        Base answer = *this;
        answer *= d;
        return answer;
    }

    //also operators for +=, +, multiplication from left, maybe [] too
};

struct Derived : public Base<2>{
    Derived(double a, double b){
        foo() = a;
        bar() = b;
    }

    double &foo(){ return xs[0]; }
    double &bar(){ return xs[1]; }
};

int main()
{
    //this is OK:
    double data[2] = {0.0, 2.0};
    Base<2> b(data);
    b = b*17.0;

    cout << b.xs[0] << endl;

    //I can't do this:
    Derived x(0.0, 2.0);
    x = x*17.0;

    cout << x.foo() << endl;

    return 0;
} 
```

每当我尝试使用需要复制的运算符时，都会出现编译器错误。gcc 给了我以下编译器错误：

```
teste.cpp: In function ‘int main()’:
teste.cpp:52: error: no match for ‘operator=’ in ‘x = x.Derived::<anonymous>.Base<N, X>::operator* [with int N = 2, X = double](1.7e+1)’
teste.cpp:31: note: candidates are: Derived& Derived::operator=(const Derived&) 
```

我认为问题在于重载函数处理不能转换为派生类的基类对象，所以我不能在派生类中使用它们。但是，我想不出解决方案。有没有办法解决这个问题，或者我应该使用完全不同的方法？

额外的问题：有什么方法可以让我使用 std::valarray 来避免输入大量的运算符重载？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T05:40:58.860

您的 Base 运算符（在本例中为 *）可以接受 Derived 对象，但它们返回一个 Base，它不能用作 Derived 默认赋值运算符中的右手操作数。解决此问题的最简单方法是向 Derive 添加一个赋值运算符，该运算符将采用 Base：

```
Derived& operator= (const Base<2>& other) 
```

您必须将它添加到任何派生类，但实现相当简单（您可以在 Base 中有一个 void CopyOtherBase 函数来执行复制，并让所有 operator= 调用它并返回 *this）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T05:45:27.333

我只会解决技术上的困难，而不是这是否是一个好主意。

问题是 Derived 的 operator* 的结果是 Base，而 Derived 的 operator=（这是默认的 operator=）不知道如何“吃掉”Base。

一个简单的解决方案是创建一个 Derived 的构造函数，该构造函数获取一个 Base，并执行正确初始化自身所需的任何操作。这将允许将 Base 即时转换为 Derived - 并且适用于所有其他期望 Base 的 Derived 运算符。

类似于-

```
Derived(const Base<2>& B) : Base<2>( B )
{
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T05:20:31.730

我认为使用枚举或静态常量来命名字段会更好

例如，静态常量 int FIELD_NAME = 0；
静态常量 int FIELD_NAME2 = 1;

而不是将其作为不同的类型（模板）进行。然后，您可以使用 std::valarray 或 boost::ublas::vector/matrix 类型来利用现有代码并获得高质量性能向量操作来启动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T13:20:58.457

[根据 MSDN](http://msdn.microsoft.com/en-us/library/4x88tzx0(VS.80).aspx)，

> 除赋值 (operator=) 外的所有重载运算符都由派生类继承。

这可能是你的问题吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T08:55:24.320

模板元编程有一个有趣的想法，可以解决数学向量的此类问题，但可能无法解决您命名零件的问题。

David Abrahams，Aleksey Gurtovoy：C++ 模板元编程：Boost 及其他领域的概念、工具和技术，Addison-Wesley，ISBN 0-321-22725-5

# hibernate - 在 Weblogic（EJB3 应用程序）中获取 Hibernate EntityManagerFactory 时出现问题

> ID：746393
> 
> 赞同：0
> 
> 时间：2009-04-14T04:57:55.297
> 
> 标签：hibernate, jpa, ejb-3.0, weblogic, ejb

**从 weblogic StartUp 类中的以下代码从 JPA 获取 EntityManagerFactory 时遇到问题**

* * *

```
 EntityManagerFactory emf =
        Persistence.createEntityManagerFactory("testEJBPU");

    logger.info("Created EntityManagerFactory");

    Context ctx = new InitialContext();

    ctx.rebind("testEJBPU", emf); 
```

* * *

**上面的代码只返回 OPenJPA EntityManagerFactory 而不是 Hibernate 我的 Presistence.xml 文件中有以下内容**

* * *

```
<?xml version="1.0" encoding="UTF-8"?>
<!--
Copyright (c) 2006 Illuminatics, Inc.
All rights reserved.
-->

<persistence xmlns="http://java.sun.com/xml/ns/persistence"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd"
             version="1.0">
    <persistence-unit name="testEJBPU" transaction-type="JTA">
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <jta-data-source>jdbc/evolvDS</jta-data-source>
        <properties>
            <property name="hibernate.ejb.cfgfile"
                      value="META-INF/hibernate.cfg.xml"/>
            <property name="hibernate.transaction.factory_class"
                      value="org.hibernate.ejb.transaction.JoinableCMTTransactionFactory"/>
            <property name="hibernate.transaction.manager_lookup_class"
                      value="org.hibernate.transaction.WeblogicTransactionManagerLookup"/>
            <property name="hibernate.cache.provider_class"
                      value="org.hibernate.cache.EhCacheProvider"/>
            <property name="hibernate.cache.jndi"
                      value="evolv-cache"/>
        </properties>
    </persistence-unit>
</persistence> 
```

* * *

**并且在应用程序启动时收到以下与 openJPA 相关的错误**

* * *

```
<Apr 14, 2009 9:48:18 AM PKT> <Critical> <WebLogicServer> <BEA-000286> <Failed to invoke startup class "binder", <1.0.0 fatal user error> org.apache.openjpa.util.UserException: A JDBC Driver or DataSource class name must be specified in the ConnectionDriverName property.
<1.0.0 fatal user error> org.apache.openjpa.util.UserException: A JDBC Driver or DataSource class name must be specified in the ConnectionDriverName property.
    at org.apache.openjpa.jdbc.schema.DataSourceFactory.newDataSource(DataSourceFactory.java:70)
    at org.apache.openjpa.jdbc.conf.JDBCConfigurationImpl.createConnectionFactory(JDBCConfigurationImpl.java:802)
    at org.apache.openjpa.jdbc.conf.JDBCConfigurationImpl.getDBDictionaryInstance(JDBCConfigurationImpl.java:568)
    at org.apache.openjpa.jdbc.meta.MappingRepository.endConfiguration(MappingRepository.java:1185)
    at org.apache.openjpa.lib.conf.Configurations.configureInstance(Configurations.java:450)
    at org.apache.openjpa.lib.conf.Configurations.configureInstance(Configurations.java:375)
    at org.apache.openjpa.lib.conf.PluginValue.instantiate(PluginValue.java:102)
    at kodo.conf.CachingMetaDataRepositoryPlugin.instantiate(CachingMetaDataRepositoryPlugin.java:29)
    at org.apache.openjpa.lib.conf.ObjectValue.instantiate(ObjectValue.java:79)
    at org.apache.openjpa.conf.OpenJPAConfigurationImpl.newMetaDataRepositoryInstance(OpenJPAConfigurationImpl.java:833)
    at org.apache.openjpa.conf.OpenJPAConfigurationImpl.getMetaDataRepositoryInstance(OpenJPAConfigurationImpl.java:828)
    at org.apache.openjpa.kernel.AbstractBrokerFactory.makeReadOnly(AbstractBrokerFactory.java:539)
    at org.apache.openjpa.kernel.AbstractBrokerFactory.readResolve(AbstractBrokerFactory.java:381)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:585)
    at java.io.ObjectStreamClass.invokeReadResolve(ObjectStreamClass.java:1033)
    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1728)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1305)
    at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1908)
    at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1832)
    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1719)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1305)
    at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1908)
    at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1832)
    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1719)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1305)
    at java.io.ObjectInputStream.readObject(ObjectInputStream.java:348)
    at weblogic.rmi.extensions.server.CBVInputStream.readObjectInternal(CBVInputStream.java:71)
    at weblogic.rmi.extensions.server.CBVInputStream.readObject(CBVInputStream.java:65)
    at weblogic.jndi.internal.JNDIHelper.copyObject(JNDIHelper.java:36)
    at weblogic.jndi.internal.WLEventContextImpl.copyObject(WLEventContextImpl.java:379)
    at weblogic.jndi.internal.WLEventContextImpl.rebind(WLEventContextImpl.java:114)
    at javax.naming.InitialContext.rebind(InitialContext.java:367)
    at com.illuminatics.test.weblogic.EntityManagerFactoryBinder.main(EntityManagerFactoryBinder.java:52)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:585)
    at weblogic.management.deploy.classdeployment.ClassDeploymentManager.invokeMain(ClassDeploymentManager.java:353)
    at weblogic.management.deploy.classdeployment.ClassDeploymentManager.invokeClass(ClassDeploymentManager.java:263)
    at weblogic.management.deploy.classdeployment.ClassDeploymentManager.access$000(ClassDeploymentManager.java:54)
    at weblogic.management.deploy.classdeployment.ClassDeploymentManager$1.run(ClassDeploymentManager.java:205)
    at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321)
    at weblogic.security.service.SecurityManager.runAs(Unknown Source)
    at weblogic.management.deploy.classdeployment.ClassDeploymentManager.invokeClassDeployment(ClassDeploymentManager.java:198)
    at weblogic.management.deploy.classdeployment.ClassDeploymentManager.invokeClassDeployments(ClassDeploymentManager.java:177)
    at weblogic.management.deploy.classdeployment.ClassDeploymentManager.runStartupsAfterAppActivation(ClassDeploymentManager.java:158)
    at weblogic.management.deploy.classdeployment.StartupClassPrelistenService.start(StartupClassPrelistenService.java:13)
    at weblogic.t3.srvr.SubsystemRequest.run(SubsystemRequest.java:64)
    at weblogic.work.ExecuteThread.execute(ExecuteThread.java:200)
    at weblogic.work.ExecuteThread.run(ExecuteThread.java:172)
> 
```

* * *

```
My EAR Structure is as:

testEJBProject.ear 
-->lib/ 
-->META-INF/ 
----->application.xml 
----->MANIFEST.MF 
-->testEJB.jar 
----->META-INF/ 
--------->hibernate.cfg.xml 
--------->INDEX.LST 
--------->MANIFEST>MF 
--------->persistence.xml 
----->com/../..* 
```

**如果有人以前遇到过，请告诉我它的解决方案！** 问候，卡齐姆·拉扎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T05:36:55.217

您设置数据源 jdbc/evolvDS 的方式似乎有问题。作为未定义 JDBC 驱动程序名称的例外。你能重新检查你的数据源配置吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T06:10:52.640

您是否在 web.xml 中使用 persistence-unit-ref 引用了持久性单元？

类似的东西

<persistence-unit-ref> <persistence-unit-ref-name>persistence/testEJBPU</persistence-unit-ref-name> ... <persistence-unit-ref>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T06:41:32.010

通过扩展`HibernatePersistenceProvider`'s 类解决了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-10T12:35:04.960

始终在 weblogic 中，您必须选择一个服务器作为目标！. 检查 AdminServer 并找到数据源定义向导的步骤。

# php - PHP表单复选框和未定义的索引

> ID：746396
> 
> 赞同：3
> 
> 时间：2009-04-14T05:00:32.187
> 
> 标签：php, mysql

提交带有未选中复选框的表单时出现“未定义索引”错误。除了对每个单独的发布值运行“isset”或“空”检查之外，还有其他方法吗？

我已经看过这个[问题](https://stackoverflow.com/questions/476426/submit-an-html-form-with-empty-checkboxes)并且很难相信这是唯一的解决方案。

下面是一些示例代码： 编辑：请注意这些不是表列的实际名称；它们被唯一命名（如“postAddress、displayPhone、student 等）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-14T05:10:54.967

您可以编写一个函数来检查复选框是否被选中：

```
function checkbox_value($name) {
    return (isset($_POST[$name]) ? 1 : 0);
} 
```

现在在您的查询中调用该函数，如下所示：

```
$sql =  'UPDATE table SET '.
        'checkbox1 = '. checkbox_value('checkbox1') .','.
        'checkbox2 = '. checkbox_value('checkbox2') .','.
        'checkbox3 = '. checkbox_value('checkbox3') .','.
        'checkbox4 = '. checkbox_value('checkbox4') .','.
        'checkbox5 = '. checkbox_value('checkbox5') .','. "LIMIT 1"; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-14T05:23:15.220

如果你想要一个开/关复选框，你可以在写复选框之前写一个隐藏值。

```
<input type="hidden" name="checkbox1" value="no" />
<input type="checkbox" name="checkbox1" value="yes" /> 
```

这将始终返回一个值，不是（默认情况下，除非默认选中复选框）或是。

您可以使用带有[FILTER_VALIDATE_BOOLEAN的](http://php.net/manual/en/filter.filters.valiate.php)[过滤器函数](http://php.net/manual/en/book.filter.php)验证输入。

如果你为此编写一个函数，比如 formCheckbox($name)，它会更容易，它带有值选项（值“on”表示默认选中复选框）、属性等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T05:05:33.983

尝试以下

```
<?php
//first part of the query
$query = "UPDATE table SET ";

$howManyCheckboxes = 5;
//for every checkbox , see if it exist , if it is, add it to the query
for($i=1;$i<=$howManyCheckboxes;$i++)
{
   if(isset($_POST['checkbox'.$i]))
   {
      $query = $query . " checkbox".$i."='".escape($_POST['checkbox'.$i])."',";
   }
}
//lets remove the last coma
$query = substr($query,0,-1);
//add the rest of the query
$query = $query . " LIMIT 1";

$result = mysql_query( $query );
if( ! $result ) echo "um, not everything went as expected.";
?> 
```

# c# - 计算 C# UdpClient.Send() 数据报中的字节数

> ID：746399
> 
> 赞同：0
> 
> 时间：2009-04-14T05:01:23.650
> 
> 标签：c#, udp, datagram

在 C# 中，为了使用 UdpClient.Send() 方法，我必须提供要发送的字节数作为参数之一。

如何在发送之前计算数据报中的字节数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T05:17:32.863

您向 UdpClient.Send() 传递一个字节数组 (Byte[])、一个整数大小和一个 IPEndPoint。如果您要发送整个字节数组，仅此而已，作为您的数据报的有效负载，您可以使用数组的 Length 属性，如下所示：

```
UdpClient udpClient = new UdpClient();
IPAddress ipAddress = Dns.Resolve("www.contoso.com").AddressList[0];
IPEndPoint ipEndPoint = new IPEndPoint(ipAddress, 11004);    

Byte[] sendBytes = Encoding.ASCII.GetBytes("Is anybody there?");
try{
    udpClient.Send(sendBytes, sendBytes.Length, ipEndPoint);
}
catch ( Exception e ){
    Console.WriteLine(e.ToString());    
} 
```

也许这里的困惑是您认为您必须计算将通过线路发送的位数？实际需要的只是有效负载的大小（您实际希望在此数据报中发送的所提供字节数组的一部分）。图书馆将完成剩下的工作。

示例和信息[在这里](http://msdn.microsoft.com/en-us/library/82dxxas0.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T05:04:53.237

不确定您使用什么语言来实现此 UDP 客户端。在 C++ 中，sizeof 运算符提供字节数。其他方法是使用 strlen() 或其 unicode 变体并乘以数据类型大小。

# c++ - 使用 Windows API 获取所有 Windows 启动进程的最佳方法是什么？

> ID：746414
> 
> 赞同：1
> 
> 时间：2009-04-14T05:11:32.377
> 
> 标签：c++, c, winapi

我知道我需要查看启动文件夹和某些注册表项。但是如何使用 Windows API 做到这一点？我有兴趣了解 Windows XP 和 Vista。谢谢你的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T07:00:45.377

没有单一的 API 可以获取系统启动时运行的*所有程序。*考虑一下[Autoruns](http://technet.microsoft.com/en-us/sysinternals/bb963902.aspx)显示的所有内容。对该程序的更新偶尔会允许它显示新的程序类别，并且由于这些是对程序的更新而不是对操作系统的更新，因此显然不是某些 API 正在更改以包含更多内容。相反，它是逐渐扩展其“自动运行程序”概念的程序。

确定*您*希望将什么视为“启动过程”，然后您可以确定可以结合哪些 API 或其他技术来找出所有这些过程是什么。

值得一看的地方包括：

*   “运行”[注册表项](http://msdn.microsoft.com/en-us/library/ms724871.aspx)，就像[AJ 提到](https://stackoverflow.com/questions/746414/what-is-the-best-way-to-get-all-windows-startup-processes-using-windows-api/746446#746446)的那样。
*   “启动”菜单，由使用的[各种常量](http://msdn.microsoft.com/en-us/library/bb762494.aspx)[`ShGetFolderPath`](http://msdn.microsoft.com/en-us/library/bb762181.aspx)及其一些相关功能给出。
*   计划在登录时运行的[任务。](http://msdn.microsoft.com/en-us/library/aa383614.aspx)
*   [服务](http://msdn.microsoft.com/en-us/library/ms685150.aspx)。

每个要点都至少包含一个指向 MSDN 上的页面的链接，该页面应该可以帮助您入门。如果您需要更多，请考虑提出一些更具体的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T05:30:01.757

我不确定这样的 API 是否存在。不过，您可以编写一个函数来做到这一点。

启动进程名称和位置存储在注册表中的以下位置：

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
<Name> <Location of EXE> 
```

您可以编写小函数来打开上述注册表并读取启动过程的详细信息。

# iphone - iPhone - 将当前视图保存为图像

> ID：746421
> 
> 赞同：24
> 
> 时间：2009-04-14T05:14:19.967
> 
> 标签：iphone

如何将当前视图作为图像从我的应用程序保存到相机胶卷？可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-14T07:47:53.390

找到了解决方案。可能会帮助某人。要将当前视图另存为图像，请执行以下操作

```
UIGraphicsBeginImageContext(pictureView.bounds.size);                  

[pictureView.layer renderInContext:UIGraphicsGetCurrentContext()]; 

UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();

UIGraphicsEndImageContext();

UIImageWriteToSavedPhotosAlbum(viewImage, nil, nil, nil); 
```

# ruby - Ruby 删除仅包含特定目录的子目录

> ID：746435
> 
> 赞同：1
> 
> 时间：2009-04-14T05:22:08.030
> 
> 标签：ruby, file-io, directory

我需要删除一堆只包含其他目录和“.svn”目录的子目录。

如果你把它看成一棵树，“叶子”只包含“.svn”目录，所以应该可以删除叶子，然后退一步，删除新叶子等等。

我认为这段代码应该做到这一点，但我被困在“某物”中的内容上。

```
Find.find('./com/') do |path|
    if File.basename(path) == 'something'
        FileUtils.remove_dir(path, true)
        Find.prune
    end
end 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T16:47:45.357

这个考虑了新的叶子（sort.reverse 条目意味着 /a/b/.svn 在 /a/b 之前处理；因此如果 /a/b 为空，它将被删除并且 size<=2 是因为使用 FNM_DOTMATCH glob 将始终返回至少 2 个条目（'.' 和 '..'））

```
require 'fileutils'

def delete_leaves(dirname)
    Dir.glob(dirname+"/**/",File::FNM_DOTMATCH).sort.reverse.each do |d|
        FileUtils.rm_rf(d) if d.match(/.svn/) or Dir.glob(d+"/*",File::FNM_DOTMATCH).size<=2  
    end  
end
delete_leaves(ARGV[0]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T06:22:15.233

这可以完成工作......但是它没有考虑到它自己的运行可能会产生新的叶子

```
#!/usr/bin/env ruby

require 'fileutils'

def remove_leaves(dir=".")
  Dir.chdir(dir) do 
    entries=Dir.entries(Dir.pwd).reject { |e| e=="." or e==".."}
    if entries.size == 1 and entries.first == ".svn"
      puts "Removing #{Dir.pwd}"
      FileUtils.rm_rf(Dir.pwd)
    else
      entries.each do |e|
        if File.directory? e
          remove_leaves(e)
        end
      end
    end
  end
end

remove_leaves 
```

# c# - C#中的数组列表

> ID：746441
> 
> 赞同：2
> 
> 时间：2009-04-14T05:26:43.603
> 
> 标签：c#, arraylist

我们可以将 ArrayLists 作为参数传递给 C# 中的方法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-14T05:31:43.047

绝对地。但是，您很少应该这样做。这些天来，您几乎应该*总是*使用泛型类型，例如`List<T>`.

此外，在声明方法的*参数*时，尽可能使用接口是值得的。例如，如果您有这样的方法：

```
public void SomeMethod(ArrayList list) 
```

然后任何调用它的人都*被迫*使用`ArrayList`. `List<T>`即使他们想使用也无法使用。另一方面，如果您将方法声明为：

```
public void SomeMethod(IList list) 
```

那么即使您的代码不知道它们，他们也可以使用泛型。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T05:29:09.357

当然，为什么不：

```
public void SomeMethod(ArrayList list)
{
    // your code here
} 
```

但是正如 Jon S. 提到的，使用接口而不是硬编码类型是首选。

```
public void SomeMethod(IList list)
{
    // your code here
} 
```

**另见**：

*   [接口（C# 编程指南）](http://msdn.microsoft.com/en-us/library/ms173156.aspx)
*   [通用接口（C# 编程指南）](http://msdn.microsoft.com/en-us/library/kwtft8ak.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T05:29:07.577

是的你可以。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T08:37:46.080

任何类型都可以作为方法的参数传递。无论是抽象的，还是接口，或值类型，或其他任何东西。

Jon Skeet 提到了接口的使用。是的，它很好，但有一个小陷阱——你不能轻易地从那个方法导航到它的用法。

# command-line - 如何显示共同的线条（反向差异）？

> ID：746458
> 
> 赞同：196
> 
> 时间：2009-04-14T05:36:44.423
> 
> 标签：command-line, diff

我有一系列文本文件，我想知道它们的共同点，而不是它们之间不同的行。命令行 Unix 或 Windows 都可以。

文件*foo*：

```
linux-vdso.so.1 =>  (0x00007fffccffe000)
libvlc.so.2 => /usr/lib/libvlc.so.2 (0x00007f0dc4b0b000)
libvlccore.so.0 => /usr/lib/libvlccore.so.0 (0x00007f0dc483f000)
libc.so.6 => /lib/libc.so.6 (0x00007f0dc44cd000) 
```

文件*栏*：

```
libkdeui.so.5 => /usr/lib/libkdeui.so.5 (0x00007f716ae22000)
libkio.so.5 => /usr/lib/libkio.so.5 (0x00007f716a96d000)
linux-vdso.so.1 =>  (0x00007fffccffe000) 
```

因此，鉴于上面的这两个文件，所需实用程序的输出将类似于`file1:line_number, file2:line_number == matching text`（只是一个建议；我真的不在乎语法是什么）：

```
foo:1, bar:3 == linux-vdso.so.1 =>  (0x00007fffccffe000) 
```

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2009-04-14T05:41:27.220

在 *nix 上，您可以使用[comm](http://www.ss64.com/bash/comm.html)。问题的答案是：

```
comm -1 -2 file1.sorted file2.sorted 
# where file1 and file2 are sorted and piped into *.sorted 
```

这是 的完整用法`comm`：

```
comm [-1] [-2] [-3 ] file1 file2
-1 Suppress the output column of lines unique to file1.
-2 Suppress the output column of lines unique to file2.
-3 Suppress the output column of lines duplicated in file1 and file2\. 
```

另请注意，如手册页中所述，在使用 comm 之前对文件进行排序很重要。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2015-01-15T09:26:29.540

[我在一个列为重复的问题](https://stackoverflow.com/questions/8581090/how-to-do-the-opposite-of-diff)上找到了这个答案。我发现[grep](https://en.wikipedia.org/wiki/Grep)比*[comm](https://linux.die.net/man/1/diff/comm)*对管理员更友好，所以如果你只想要一组匹配的行（例如，用于比较 CSV 文件）只需使用

```
grep -F -x -f file1 file2 
```

或简化的[fgrep](https://linux.die.net/man/1/diff/fgrep)版本：

```
fgrep -xf file1 file2 
```

另外，您可以使用`file2*`glob 查找与多个文件共同的行，而不仅仅是两个。

其他一些方便的变化包括

*   `-n`标志显示每个匹配行的行号
*   `-c`只计算匹配的行数
*   `-v`仅显示*file2*中不同（或使用`diff`）的行。

使用`comm`速度更快，但这种速度是以必须先对文件进行排序为代价的。作为“反向差异”，它不是很有用。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-04-14T06:05:22.653

之前在这里问过：*[Unix command to find lines common in two files](https://stackoverflow.com/questions/373810/unix-command-to-find-lines-common-in-two-files)*

您也可以尝试使用 Perl（信用[在这里](http://www.cyberciti.biz/faq/command-to-display-lines-common-in-files/)）：

```
perl -ne 'print if ($seen{$_} .= @ARGV) =~ /10$/'  file1 file2 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2014-09-08T00:47:22.677

我刚刚从答案中学习了*[comm](https://linux.die.net/man/1/comm)*命令，但我想添加一些额外的内容：如果文件未排序，并且您不想触摸原始文件，则可以通过管道输出*[sort](https://linux.die.net/man/1/sort)*命令的输出。这使原始文件保持不变。它适用于 Bash，但我不能说其他 shell。

```
comm -1 -2 <(sort file1) <(sort file2) 
```

这可以扩展为比较命令输出，而不是文件：

```
comm -1 -2 <(ls /dir1 | sort) <(ls /dir2 | sort) 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2017-04-28T10:53:38.010

最简单的方法是：

```
awk 'NR==FNR{a[$1]++;next} a[$1] ' file1 file2 
```

文件不需要排序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-02-11T21:53:17.277

仅供参考，我为 Windows 制作了一个小工具，与“grep -F -x -f file1 file2”做同样的事情（因为我在 Windows 上没有找到与此命令等效的任何东西）

这是： [http ://www.nerdzcore.com/?page=commonlines](http://www.nerdzcore.com/?page=commonlines)

用法是“CommonLines inputFile1 inputFile2 outputFile”

源代码也可用（GPL）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-12-16T14:05:30.210

在***Windows***中，您可以将[PowerShell](https://en.wikipedia.org/wiki/Windows_PowerShell)脚本与***CompareObject***一起使用：

```
compare-object -IncludeEqual -ExcludeDifferent -PassThru (get-content A.txt) (get-content B.txt)> MATCHING.txt | Out-Null #Find Matching Lines 
```

**比较对象：**

*   IncludeEqual 没有 -ExcludeDifferent：一切
*   没有 -IncludeEqual 的 ExcludeDifferent：没有

# asp.net - 在 ASP.Net 中获取会话 ID

> ID：746475
> 
> 赞同：38
> 
> 时间：2009-04-14T05:51:15.340
> 
> 标签：asp.net

如何获取所有当前会话的 ID？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-04-14T08:18:48.497

要获取会话 ID，请执行以下操作：

```
// In a user control or page
string sessionId = this.Session.SessionID; 

// In a normal class, running in a asp.net app.
string sessionId = System.Web.HttpContext.Current.Session.SessionID; 
```

您不需要：

*   制作任何数据表或循环任何东西
*   使用 SQL Server 获取会话状态
*   处理 Session_Start 或 Session_End

在无 cookie 的情况下，会话 id 是在您第一次访问 Session 对象时创建的。这无关紧要，因为一旦您访问 SessionID 属性，就会访问会话对象。

有关更多信息，请查看以下内容：

[http://msdn.microsoft.com/en-us/library/system.web.sessionstate.httpsessionstate.sessionid.aspx](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.httpsessionstate.sessionid.aspx)

注意：msdn 示例由猴子编写。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-14T05:55:14.440

您可以使用文件并在事件中`Global.asax`设置会话。`Session_Start`见下文

在`Global.asax`文件中，您可以执行以下操作：

```
protected void Session_Start(object sender, EventArgs e)
{
    Session["sid"] = Session.SessionID;
    Session["sid"] = "Test";
} 
```

然后在您的 WebForm 中，您可以获得如下所示的 Session ID 和 Value

```
protected void Page_Load(object sender, EventArgs e)
{
    Response.Write("Session ID is:" + Session.SessionID.ToString()+ "<br/>");
    Response.Write("Session value is:" + Session["sid"].ToString());
} 
```

详情见[http://www.dotnetcurry.com/ShowArticle.aspx?ID=126](http://www.dotnetcurry.com/ShowArticle.aspx?ID=126)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-14T07:45:05.330

根据[Dino Esposito](http://www.ddj.com/windows/184416793)的说法，每个会话都存储在应用程序的缓存中，通过一些工作，您可以检索此信息：

```
DataTable dt = new DataTable();
dt.Columns.Add("SessionID", typeof(string));
foreach(DictionaryEntry elem in Cache) {
    string s = elem.Key.ToString();
    if (s.StartsWith("System.Web.SessionState.SessionStateItem")) {
        DataRow row = dt.NewRow();
        char[] parms = {':'};
        string[] a = s.Split(parms);
        row["SessionID"] = a[1];
        dt.Rows.Add(row);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-16T12:43:48.457

如果您想要一种方法来存储您控制后备存储的当前会话列表，以便您可以存储有关客户端的额外数据，您可以使用列表。（我从头顶写下下面的例子）

在 global.asax.cs 文件中挂钩 Application_SessionStart：

```
static List<string> sessions = new List<string>();
static object sessionLock = new object();

void Application_SessionStart()
{
    lock (sessionLock) {
        sessions.Add(Session.SessionID);
    }
}

void Application_SessionEnd()
{
    lock (sessionLock) {
        sessions.Remove(Session.SessionID);
    }
} 
```

或者，您可以使用字典，将会话 ID 存储为键，并将有关该用户的额外数据存储为值。然后，您可以轻松地创建一个显示所有当前用户会话的页面，例如，让管理站点显示当前用户会话。

只有当您的会话是 InProc 时才会调用 SessionEnd。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T05:53:54.723

答案部分取决于您存储会话状态的位置。`Session_Start`假设您使用默认值 (inproc)，那么您可以使用 global.asax 中的和`Session_End`事件来维护当前会话 ID 的列表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T06:02:59.990

如果您将会话状态存储在 SQL Server 中，您也可以轻松地从那里获取它。

# perl - 有没有办法在 Perl 中输出非管道的调试消息？

> ID：746489
> 
> 赞同：2
> 
> 时间：2009-04-14T06:02:11.287
> 
> 标签：perl, pipe

有没有办法在 Perl 中输出非管道的调试消息？我有一个在管道中使用的 Perl 脚本，但我真的想将一些诊断信息打印到屏幕而不是管道。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-14T06:05:37.287

您是否同时管道标准输出和标准错误？如果没有，请写信给您没有管道的人:)

例如

```
print STDERR "This goes to standard error";
print STDOUT "This goes to standard output"; 
```

（如果你不提供句柄，STDOUT 当然是默认的——除非你要求 Perl 使用*不同*的默认句柄......）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T08:19:45.483

除非您在命令行上说过类似`2>&1`的话，否则 STDERR 应该会出现在屏幕上。[您可以像 Jon Skeet建议](https://stackoverflow.com/questions/746489/output-text-that-is-not-piped-in-perl/746496#746496)的那样写信给 STDERR ，也可以使用该[`warn`](http://perldoc.perl.org/functions/warn.html)功能。

# printing - 打印 X.509 数字签名

> ID：746494
> 
> 赞同：1
> 
> 时间：2009-04-14T06:05:05.307
> 
> 标签：printing, digital-signature, digital-certificate, x509

我正在使用数字证书签署交易结果，另外，我需要打印一张带有信息和数字签名的单据。

我想知道是否有专门为印刷媒体设计的 X.509 数字签名的更短表示？也许某种哈希或类似的东西......

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-22T10:19:54.027

“openssl x509”工具使用“-text”选项提供了一个漂亮、简洁、人类可读的 x.509 证书文本表示：

```
openssl x509 -noout -text -in CA_2048bit.pem 
```

输出如下所示：

```
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            00:11:22:33:44:55:66:77:88:99
        Signature Algorithm: sha1WithRSAEncryption
        Issuer: CN=Some CA, OU=Dept, O=MyOrganization, ST=Mazowieckie, C=PL
        Validity
            Not Before: Jun 17 14:24:59 2009 GMT
            Not After : Jun 17 14:24:57 2029 GMT
        Subject: CN=Some Party, OU=Dept, O=MyOrganization, ST=Mazowieckie, C=PL
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
            RSA Public Key: (2048 bit)
                Modulus (2048 bit):
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:
                    00:11
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Basic Constraints: critical
                CA:TRUE, pathlen:0
    Signature Algorithm: sha1WithRSAEncryption
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff:00:11:
        00:11:22:33 
```

由于签名和模数信息，这当然有点长。

不幸的是，所有这些数据都是验证证书真实性和使用它来分别验证通过它验证的数字签名所必需的。

没有这些证书内容的其余部分不能证明任何事情。

# javascript - 停止元素上的更多事件处理程序

> ID：746506
> 
> 赞同：30
> 
> 时间：2009-04-14T06:16:00.477
> 
> 标签：javascript, jquery, events

我正在编写一个小的 jQuery 扩展，以防止用户双击链接。

```
$.fn.preventDoubleClick = function() {
    return this.click(function() {
        var $t = $(this)
            , retVal = $t.data('active')  // check the internal flag
        ;
        if (retVal || retVal === undefined) { // if ON...
            $t.data('active', false);  // set the internal flag to OFF
            setTimeout(function() {
                $t.data('active', true);
            }, 1000);  // after 1 second, set the internal flag to ON
            console.log("allowed");
            return true;
        } else {  // if OFF...
            console.log("blocked");
            return false;
        }
    });
}; 
```

问题是如果元素上有其他点击事件处理程序，它们仍然会触发：

```
$('#myLink').click(function() {
    console.log("Clicked");
});
$('#myLink').preventDoubleClick(); 
```

现在，当您双击链接时，我在日志中得到了这个：

> 允许
> 点击
> 被阻止
> 点击

所以基本上，我需要内部的 click 函数`preventDoubleClick`来阻止所有其他事件处理程序触发。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-04-14T06:30:25.947

感谢亚当的链接，我能够看到我需要的功能：[`stopImmediatePropagation()`](http://api.jquery.com/event.stopImmediatePropagation/).

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-14T06:19:38.330

我相信您正在寻找[event.stopPropagation](http://docs.jquery.com/Types/Event#event.stopPropagation.28.29)

编辑：事实证明这不是尼克目的的正确选择。请看[他的回答](https://stackoverflow.com/questions/746506/stop-further-event-handlers-on-an-element/746533#746533)。

# c# - 基于 DataSets 的 .NET 程序：使用 Designer 工具还是自己动手？

> ID：746508
> 
> 赞同：2
> 
> 时间：2009-04-14T06:17:28.397
> 
> 标签：c#, .net-3.5, ado.net, dataset

经过长时间的思考，我决定使用 C#、.NET 3.5（使用 ADO.NET DataSets ) 和 Scimore db。

到目前为止，我已经完成了基本的基本修补，并且发现这个组合非常好而且很快。是的，“快”是我的要求，因为我们的电脑很慢。

不过我有一个问题：我应该使用 Visual Studio 设计工具来帮助我为数据绑定控件构建 GUI，还是应该手动编写它们？在简单的场景中，我发现设计器生成的代码似乎太大而无法达到目的。

它会以某种方式影响我最终应用程序的“牢度”吗？

谢谢阅读！

**编辑**对不起，我没有提到，这将是一个桌面应用程序，使用 Winforms

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T06:30:02.533

通常代码量不会影响执行速度，所以我不应该担心。因此，您应该考虑使用 Visual Studio 设计工具来构建您的 GUI。大多数情况下，您可以通过这种方式更快地构建应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T06:25:24.040

如果您希望使您的 ASP.NET 代码尽可能轻量和快速，您可能需要考虑使用[ASP.NET MVC](http://www.asp.net/mvc/)。这是用于创建 StackOverflow 的技术，它使您可以对要使用哪些数据技术来实现站点进行大量控制，并且在很大程度上避免了使用 ASP.NET 服务器控件的开销。您可能会发现这是满足您需求的绝佳选择。

# c# - NHibernate 中不区分大小写的排序顺序

> ID：746517
> 
> 赞同：6
> 
> 时间：2009-04-14T06:23:40.753
> 
> 标签：c#, nhibernate

考虑以下条件查询：

var x = SomeCriteria.AddOrder(new Order("Name", true)).L​​ist();

这将按 Name 属性对结果集进行排序，但区分大小写：

```
"A1"
"B1"
"a2" 
```

任何想法如何添加不区分大小写的顺序，因此结果“a2”将在“B1”之前结束？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-03-05T17:54:48.717

您应该能够通过订购一个为您规范化案例的投影来完成此操作。例如，Oracle 有一个“lower”函数，可以将 varchar2 和 nvarchar2 等字符串数据类型小写；所以我将使用这个 sql 函数来形成一个可以适当排序的投影。

```
var projection = Projections.SqlFunction("lower",
                                         NHibernateUtil.String,
                                         Projections.Property("名称"));

var x = SomeCriteria.AddOrder(Orders.Asc(projection)).List()

```

如果您使用的是 SQL Server，我建议使用“upper”函数而不是“lower”来提高效率。微软已经优化了它的本地代码来执行大写比较，而世界其他地方似乎已经对小写进行了优化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T06:54:20.897

Hibernate (Java) 在“Order”类上有一个“ignoreCase()”方法，但看起来 NHibernate 在它的“Order”上没有这个方法。

这就是我认为你可以做到的方式：

```
var x = SomeCriteria.AddOrder(new Order("Name", true).IgnoreCase()).List(); 
```

但不幸的是，没有 IgnoreCase()。

作为一种解决方法，您可以使用 HQL 或 SQL 查询 - 其中任何一个都应该允许您订购不区分大小写的命令。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T12:26:02.113

这可能取决于数据库服务器上的区分大小写设置。我怀疑 NHibernate 只是发出一个“ORDER BY”子句；至少，我无法想象它还能做什么。对于 SQL Server，默认排序顺序（排序规则）是字典顺序，不区分大小写。

[本文](http://vyaskn.tripod.com/case_sensitive_search_in_sql_server.htm)提供了一些在 SQL Server 中执行区分大小写搜索的技术。但是，我的建议是对代码中查询返回的列表进行排序。该解决方案保留了 NHibernate 的数据库独立性，并让您根据需要自定义排序顺序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T19:38:44.943

因为我知道对我的查询的响应总是相当小，所以我最终正常查询数据，然后使用 Linq 对它们进行排序。它可以工作，所以为什么还要调整 NHibernate ;) （使用 SQLite，顺便说一句）

# c# - UdpClient 在广播地址上接收

> ID：746519
> 
> 赞同：12
> 
> 时间：2009-04-14T06:23:53.840
> 
> 标签：c#, udp

在 c# 中，我使用的是 UdpClient.Receive 函数：

```
public void StartUdpListener(Object state)
    {
        try
        {
            udpServer = new UdpClient(new IPEndPoint(IPAddress.Broadcast, 1234));
        }
        catch (SocketException ex)
        {
            MessageBox.Show(ex.ErrorCode.ToString());
        }

        IPEndPoint remoteEndPoint = null;
        receivedNotification=udpServer.Receive(ref remoteEndPoint);
        ... 
```

但是我收到一个套接字异常，说该地址不可用，错误代码为 10049 我该怎么做才能否定这个异常？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-17T08:53:18.947

这是我目前在一个可以运行的生产应用程序中使用的一些代码的概要（我们有一些额外的内容来处理客户端是服务器应用程序在独立安装上运行的情况）。它的工作是接收消息已准备好处理的 udp 通知。正如亚当亚历山大所提到的，您唯一的问题是您需要使用 IPAddress.Any，而不是 IPAddress.Broadcast。当您想*发送*广播 UDP 数据包时，您只会使用 IPAddress.Broadcast。

设置 udp 客户端

```
this.broadcastAddress = new IPEndPoint(IPAddress.Any, 1234);
this.udpClient = new UdpClient();
this.udpClient.Client.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReuseAddress, true);
this.udpClient.ExclusiveAddressUse = false; // only if you want to send/receive on same machine. 
```

并使用回调触发异步接收的开始。

```
this.udpClient.Client.Bind(this.broadcastAddress);
this.udpClient.BeginReceive(new AsyncCallback(this.ReceiveCallback), null); 
```

希望这会有所帮助，您应该能够使其适应同步工作而不会出现太多问题。与您正在做的事情非常相似。如果在此之后您仍然收到错误，则必须有其他东西正在使用您尝试侦听的端口。

所以，澄清一下。

IPAddress.Any = 用于接收。我想监听到达任何 IP 地址的数据包。IPAddress.Broadcast = 用于发送。我想向正在收听的任何人发送一个数据包。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T06:28:21.867

出于您的目的，我相信您会想要使用 IPAddress.Any 而不是 IPAddress.Broadcast。希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T06:30:17.243

该错误意味着协议无法绑定到选定的 IP/端口组合。

我已经很久没有使用过 UDP 广播了，但我记得你需要使用不同的 IP 范围。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T06:31:22.123

您配置 UdpClient 的方式没有任何问题。您是否尝试过不同的端口号？可能 1234 已在您的系统上被其他应用程序使用。

# css - CSS 中如何使用“大于”或“>”字符？

> ID：746525
> 
> 赞同：177
> 
> 时间：2009-04-14T06:27:44.737
> 
> 标签：css, css-selectors

我在 CSS 文件中多次看到这个字符，但我不知道它是如何使用的。任何人都可以向我解释一下，并展示它们在简化页面样式方面的作用吗？

* * *

## 回答 #1

> 赞同：232
> 
> 时间：2009-04-14T06:30:51.673

这是一个 CSS 子选择器。`P > SPAN`意味着将遵循的样式应用于作为标记子级的所有 SPAN`P`标记。

请注意，“孩子”的意思是“直接后代”，而不仅仅是任何后代。`P SPAN`是*后代选择器*，将遵循的样式应用于作为`SPAN`标记的子级的所有`P`标记或作为标记的子级/后代的任何其他标记的递归子级`P`。`P > SPAN`仅适用于`SPAN`标签的子`P`标签。

* * *

## 回答 #2

> 赞同：154
> 
> 时间：2009-04-14T06:40:26.390

```
p em 
```

将匹配a 中`<em>`的任何内容`<p>`。例如，它将匹配以下`<em>`s：

```
<p><strong><em>foo</em></strong></p>
<p>Text <em>foo</em> bar</p> 
```

另一方面，

```
p > em 
```

将仅匹配`<em>`s 的直接子级`<p>`。所以它会匹配：

```
<p>Text <em>foo</em> bar</p> 
```

但不是：

```
<p><strong><em>foo</em></strong></p> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-14T06:32:16.740

这被称为子组合器：

> 添加了一个子组合器选择器，以便能够对包含在其他指定元素中的元素的内容进行样式设置。例如，假设某个类的 div 标记内的超链接的颜色为白色，因为它们具有深色背景。这可以通过使用句点将 div 与类资源组合并使用大于号作为组合符将对与 a 组合来完成，如下所示：

```
div.resources > a{color: white;} 
```

（来自[http://www.xml.com/pub/a/2003/06/18/css3-selectors.html](http://www.xml.com/pub/a/2003/06/18/css3-selectors.html)）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-14T06:33:25.457

> ```
> E > F 
> ```
> 
> 匹配作为元素 E 的子元素的任何 F 元素。

更多关于[http://www.w3.org/TR/CSS21/selector.html#child-selectors](http://www.w3.org/TR/CSS21/selector.html#child-selectors)

# crystal-reports - 如何在 VS 2005 中更改 Crystal Reports 中的自定义纸张大小？

> ID：746529
> 
> 赞同：0
> 
> 时间：2009-04-14T06:29:39.740
> 
> 标签：crystal-reports, report

如何在 VS 2005 中更改 Crystal Reports 中的自定义纸张大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-13T02:30:46.447

这是基于打印机的。您应该能够更改报告用于更改报告布局的打印机的纸张大小。尝试页面设置以获取其中一些设置。

此外，在 Crystal Reports XI 中，您可以单击部分专家中的详细信息部分，然后选择右侧的布局选项卡以更改一些设置，例如详细信息宽度大小、详细信息之间的间隙（水平、垂直）和打印方向。希望这可以帮助。

# html - 如果块元素包含另一个块元素，则将块元素更改为与 CSS 内联是错误的吗？

> ID：746531
> 
> 赞同：45
> 
> 时间：2009-04-14T06:30:06.837
> 
> 标签：html, css, w3c, xhtml

我知道将块元素放在内联元素中是错误的，但是下面的呢？

想象一下这个有效的标记：

```
<div><p>This is a paragraph</p></div> 
```

现在添加这个 CSS：

```
div {
   display:inline;
} 
```

这会造成内联元素包含块元素的情况（div 变为内联，p 默认为块）

页面元素是否仍然有效？

我们如何以及何时判断 HTML 是否有效 - 在应用 CSS 规则之前或之后？

**更新：**我从那以后了解到，在 HTML5 中，将块级元素放在链接标签中是完全有效的，例如：

```
<a href="#">
      <h1>Heading</h1>
      <p>Paragraph.</p>
</a> 
```

如果您希望将一大块 HTML 作为链接，这实际上非常有用。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-16T23:51:20.543

来自[CSS 2.1 规范](http://www.w3.org/TR/CSS2/visuren.html#anonymous-block-level)：

> 当一个内联盒包含一个流内块级盒时，内联盒（及其在同一行盒内的内联祖先）在块级盒（以及任何连续或仅由可折叠的空白和/或流外元素），将内联框分成两个框（即使任一侧为空），一个在块级框的每一侧。断点前和断点后的行盒被封闭在匿名块盒中，块级盒成为这些匿名盒的兄弟。当这样的内联盒受到相对定位的影响时，任何产生的平移也会影响内联盒中包含的块级盒。
> 
> 如果以下规则，此模型将适用于以下示例：
> 
> ```
> p    { display: inline }
> span { display: block } 
> ```
> 
> 与此 HTML 文档一起使用：
> 
> ```
> <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
> <HEAD>
>   <TITLE>Anonymous text interrupted by a block</TITLE>
> </HEAD>
>   <BODY>
>     <P>
>       This is anonymous text before the SPAN.
>       <SPAN>This is the content of SPAN.</SPAN>
>       This is anonymous text after the SPAN.
>     </P>
>   </BODY> 
> ```
> 
> P 元素包含一个匿名文本块 (C1)，后跟一个块级元素，然后是另一个匿名文本块 (C2)。生成的盒子将是一个代表 BODY 的块盒子，包含 C1 周围的匿名块盒子、SPAN 块盒子和 C2 周围的另一个匿名块盒子。
> 
> 匿名框的属性继承自封闭的非匿名框（例如，在标题“匿名块框”小节下方的示例中，即 DIV 的那个）。非继承属性有其初始值。例如匿名框的字体继承自 DIV，但边距为 0。
> 
> 在元素上设置的导致匿名块框生成的属性仍然适用于该元素的框和内容。例如，如果在上例中的 P 元素上设置了边框，则边框将围绕 C1（在行尾打开）和 C2（在行首打开）绘制。
> 
> 一些用户代理以其他方式实现了包含块的内联边框，例如，通过将此类嵌套块包装在“匿名行框”内，从而在此类框周围绘制内嵌边框。由于 CSS1 和 CSS2 没有定义这种行为，CSS1-only 和 CSS2-only 用户代理可以实现这个替代模型，并且仍然声称符合 CSS 2.1 的这一部分。这不适用于本规范发布后开发的 UA。

随心所欲。很明显，这种行为是在 CSS 中指定的，尽管它是否涵盖所有情况，还是在当今的浏览器中始终如一地实现尚不清楚。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-14T06:40:55.003

不管它是否有效，元素结构都是错误的。您不将块元素放在内联元素中的原因是浏览器可以以易于预测的方式呈现元素。

即使它没有破坏 HTML 或 CSS 的任何规则，它仍然会创建无法按预期呈现的元素。浏览器必须像 HTML 代码无效一样处理元素。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-14T06:50:06.197

HTML 和 CSS 仍然有效。理想情况下，您不必做这样的事情，但 CSS 的特定位实际上是一种方便（并且在语法上有效但在语义上无效）的方法，可以在不求助于条件样式表或会使无效的黑客攻击的情况下获得 Internet Explorer 的双边距错误你的 CSS。(X)HTML 比 CSS 具有更多的语义价值，因此 CSS 在语义上的有效性并不重要。在我看来，这是可以接受的，因为它解决了烦人的浏览器问题，而不会使您的代码无效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T06:41:09.417

HTML 独立于 CSS 进行验证，因此页面仍然有效。我相当确定 CSS 规范也没有说明它，但不要引用我的那一个。但是，我会非常小心地使用这样的技术，因为虽然它可能会在某些浏览器中按预期呈现，但您需要对它们进行全部测试——我看不出有多少保证。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T12:52:45.700

> 页面元素是否仍然有效？

HTML 意义上的“有效”，是的；HTML 对 CSS 一无所知。

然而，您在浏览器中获得的渲染在 CSS 规范中是“未定义的”，因此它可能看起来像任何东西。虽然您可以在针对特定浏览器的 CSS hacks 中包含这样的规则（您知道该浏览器如何呈现这种情况），但通常不应将其提供给浏览器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T06:35:37.400

我不知道这是否验证了任何规则，但我建议使用[W3C HTML Validator](http://validator.w3.org/)和[W3C CSS Validator](http://jigsaw.w3.org/css-validator/)来确定这一点。希望这有帮助！

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-12-13T15:31:53.477

如果您遵循某种逻辑并且最终像这样实现它，那是没有错的。工作的东西并不是因为它们很奇怪而“错误”。是的，这很不寻常，但它有帮助，这不是一个错误。这是故意的。HTML 和 CSS 应该为您服务，而不是相反，所以永远不要听评论告诉您不要仅仅因为它丑陋而这样做。

通常将解决方案称为“无效”并建议解决问题的方法很长。有时你可以重新思考你做了什么。但是你所做的事情可能有很多原因，他们没有考虑。

**我确实经常在内联中使用块。** 它是有效的并且正在工作 - 在大多数情况下它不是必需的。所以呢。记得当 XHTML 告诉我们总是在属性周围加上引号（如果你不这样做，每个人都会对你大喊大叫！），现在 HTML5 允许在没有空格的情况下省略它们。单数标签后的最后一个斜线发生了什么？“<br />”？来吧。标准改变。但是浏览器也一直支持非标准的东西。CENTER 已弃用；我们在 2013 年，它仍然有效。垂直居中的表？有时这是唯一的方法。A 中的 DIV 使其按您的计划悬停？前进吧。

专注于重要的事情。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-04-14T06:37:52.483

我认为，(x)html 是有效的，css 是有效的。结果有效吗？是的，如果它正在浏览器中按您的意愿查找。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-05-26T10:13:12.043

不，这不是一个错误的选择。我们可以根据需要使用。

# c# - 过滤提琴手以仅捕获特定域的请求

> ID：746540
> 
> 赞同：111
> 
> 时间：2009-04-14T06:32:48.330
> 
> 标签：c#, .net, windows, fiddler

我不确定如何修改 CustomRules.js 文件以仅显示对某个域的请求。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2011-09-28T19:05:33.007

这很容易做到。在过滤器选项卡上，单击“仅在过滤器包含时显示，然后键入您的域。

![在此处输入图像描述](https://i.stack.imgur.com/HRoUS.png)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-14T07:12:31.337

**编辑**

事实证明这很容易；编辑`OnBeforeRequest`添加：

```
if (!oSession.HostnameIs("www.google.com")) {oSession["ui-hide"] = "yup";} 
```

例如，过滤到谷歌。

* * *

（原始答案）老实说，我不知道这是否是 Fiddler 内置的东西（我从未尝试过），但[Wireshark](http://www.wireshark.org/)肯定会很容易做到这一点 - 当然，你会得到不同的数据（特别是对于SSL） - 所以YMMV。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-06-02T11:43:13.410

我的回答有点类似于@Marc Gravels，但是我更喜欢通过包含一些特定字符串的 url 来过滤它。

1.  您将需要[fiddler 脚本 - 它是 fiddler 的附加组件](http://www.telerik.com/docs/default-source/fiddler/addons/fiddlersyntaxsetup.exe?sfvrsn=2)。
2.  安装后转到提琴手脚本标签并将以下内容粘贴到`OnBeforeRequest`函数中。（下面的截图）

    ```
     if (oSession.url.Contains("ruby:8080") || oSession.url.Contains("localhost:53929")) {  oSession["ui-hide"] = "yup";    } 
    ```

![在此处输入图像描述](https://i.stack.imgur.com/jZbuv.png)

这样，您可以按 url 的任何部分进行过滤，无论是端口主机名还是其他。

希望这可以节省您一些时间。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-09-27T16:15:34.100

您可以使用 fiddler 中的过滤器选项卡过滤请求。请看下面的截图。如果您使用的是 google chrome，请务必在 fiddler（来自 google chrome）中使用正确的进程 ID。

[![在此处输入图像描述](https://i.stack.imgur.com/VOpP0.png)](https://i.stack.imgur.com/VOpP0.png) [![在此处输入图像描述](https://i.stack.imgur.com/PfS83.png)](https://i.stack.imgur.com/PfS83.png) [![在此处输入图像描述](https://i.stack.imgur.com/CQcKD.png)](https://i.stack.imgur.com/CQcKD.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T08:46:47.493

Fiddler 网站有[一本你可以做的很多事情的食谱`CustomRules.js`](http://fiddler2.com/Fiddler/Dev/ScriptSamples.asp)，包括如何做到这一点:)

# javascript - 添加新的事件处理程序以首先运行

> ID：746547
> 
> 赞同：4
> 
> 时间：2009-04-14T06:36:53.983
> 
> 标签：javascript, jquery, events

我一直在研究[这个问题中描述](https://stackoverflow.com/questions/746506/stop-further-event-handlers-on-an-element)的 jQuery 扩展，现在遇到了另一个问题：我需要确保我的特定事件处理程序在可能已经在元素上的任何其他事件处理程序之前运行。

添加事件时，它们看起来好像被推到队列的后面，而我真的需要我的在前面，这样可以防止其他事件运行。你怎么能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T06:53:13.023

也许你会[在这里](http://groups.google.com/group/jquery-en/browse_thread/thread/da7ee3f9c17db398/10e8cff28d3e31b5?lnk=raot)找到一些有用的东西（jquery google groups），但从我读过的内容来看，没有“易于使用”的函数来处理事件堆栈

编辑：那里也有[这个插件](http://snipplr.com/view/13556/jquery-event-stack-binder/)的链接。它被称为事件堆栈绑定器。

# c# - 如何停止当前方法调用的执行

> ID：746548
> 
> 赞同：0
> 
> 时间：2009-04-14T06:37:26.867
> 
> 标签：c#

如果发生条件，我必须停止当前方法调用的执行并返回到方法调用之前的状态。我该怎么做..假设 ai 正在执行一些示例方法并且发生条件并且我正在提示一个消息框然后我想回到这个函数调用之前的状态

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T06:53:13.740

如果我对您的理解正确，如果某些条件为真，您希望撤消对某些变量所做的更改？如果是这种情况，您将需要存储所有变量（或整个类）的副本。然后，如果您的条件成立，您必须在从函数返回之前将所有这些变量恢复到初始状态。它会是这样的：

```
// In order to clone your variable, you may need to inherit from 
// ICloneable and implement the Clone function.
bool MyFunction(ICloneable c)
{
    // 1\. Create a copy of your variable
    ICloneable clone = c.Clone();

    // 2\. Do whatever you want in here
    ...

    // 3\. Now check your condition
    if (condition)
    {
        // Copy all the attributes back across to c from your clone
        // (You'll have to write the ResetAttributes method yourself)
        c.ResetAttributes(clone);

        // Put a message box up
        MessageBox.Show("This failed!");

        // Now let the caller know that the function failed
        return false;
    }
    else
    {
        // Let the caller know that the function succeeded
        return true;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T07:08:32.627

堆上的通用回滚功能对我来说是闻所未闻的。但是您可以使用命令模式来获得撤消功能并将其用于回滚：

[http://en.wikipedia.org/wiki/Command_pattern](http://en.wikipedia.org/wiki/Command_pattern)

本质上，您将操作封装在一个对象中，该对象存储了足够的更改信息，可以撤消它。您将该对象推入堆栈，当您的条件发生时，您从堆栈中弹出所有命令对象并撤消它们。如果没有关于您的案例的更多信息，就很难提供更具体的信息或判断这是否适用于您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T06:42:08.353

在调用方法之前是否可以检查错误情况？如果是，则抛出异常。

否则，`return`一些有意义的东西（例如，如果它是一个`void`函数，则将其更改为 return a`bool`和 return `false`）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T06:44:14.260

这就是例外。您抛出异常以终止函数和任何调用者，直到到达异常处理程序。

请注意，只有在发生异常情况时才应这样做；异常不应用作“不同类型”的返回值，因为它们在代码大小（无论是否抛出）和运行时间（如果抛出）方面比正常返回的成本更高。

就返回到您之前的状态而言，*如果*您的代码和进行调用的任何库代码是以*异常安全*的方式编写的，则这是可能的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T06:52:06.737

我猜您是在谈论对象事务或事务内存。

您至少可以记录正在修改的对象的状态（分配），并在分配条件失败时在其上写入旧值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T06:54:43.457

另一种解决方案，与上述方案略有不同：

不时在您的示例方法中检查指定的条件。

```
public void MyMethod()
{
some code

if (conditionOccurred == true){ reset to the previous state and exit;}

more code
} 
```

这可能不是书上所说的，但如果你不经常使用它，它会给出非常简单易读的代码。

我可能不必提及，如果您希望能够返回到程序的状态，则需要保存程序的状态，并且您需要编写一些代码来使您返回到该状态。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-14T06:48:00.930

您可以使用[备忘录模式](http://www.dofactory.com/Patterns/PatternMemento.aspx)来实现对象回滚。从[这里](http://en.wikipedia.org/wiki/Memento_pattern)...

> 看守者将对发起者做一些事情，但希望能够撤消更改。看守人首先向发起人索要纪念品。然后它会执行它要执行的任何操作（或操作序列）。为了回滚到操作之前的状态，它将备忘录对象返回给发起者。

一旦您收到指示您应该回滚的事件，您可以撤消更改并返回给调用者。这是一些[信息。以及](http://msmvps.com/blogs/peterritchie/archive/2007/08/22/thead-abort-is-a-sign-of-a-poorly-designed-program.aspx)为什么不应该使用 Thread.Abort 的链接。

# visual-studio-2005 - 让 NUnit 测试与 Visual Studio 常规构建集成所需的最低要求是多少？

> ID：746551
> 
> 赞同：0
> 
> 时间：2009-04-14T06:38:26.303
> 
> 标签：visual-studio-2005, msbuild, nunit

我知道有很多关于这个和博客文章后的问题，但有人可以提出最简单的答案（或链接到现有问题，如果有适当的答案）以获得以下在 Visual Studio 2005 上的工作：

1.  NUnit 测试在 Visual Studio 常规构建上执行（例如，对现有 *.proj 文件的绝对最小更改以使 NUnit 包含在 MSBuild 编译中）。如果它不会使事情变得过于复杂，是否有一种将 MSBuild 社区任务项目作为二进制文件而不是安装在每台开发机器上的好方法？

2.  测试失败显示在错误列表/警告中。

3.  测试失败会停止发布编译。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T08:04:19.373

要正确执行此操作，您可能需要某种持续集成服务器，例如 TeamCity 或 Cruise Control。

然后，您可以使用以下命令将 nUnit 测试添加到您的 MsBuild 脚本

```
<!--BEGIN RUNNING UNIT TESTS-->
  <Choose>
    <When Condition=" '$(Configuration)' == 'Release' ">
      <ItemGroup>
        <TestAssemblies Include="$(BuildDir)\Builds\Release\BusinessLayer.Tests.dll" />
        <TestAssemblies Include="$(BuildDir)\Builds\Release\ResourceAccessLayer.Tests.dll" />
      </ItemGroup>
    </When>
    <Otherwise>
      <ItemGroup>
        <TestAssemblies Include="$(BuildDir)\Builds\Debug\BusinessLayer.Tests.dll" />
        <TestAssemblies Include="$(BuildDir)\Builds\Debug\ResourceAccessLayer.Tests.dll" />
      </ItemGroup>
    </Otherwise>
  </Choose>
  <UsingTask TaskName="NUnit" AssemblyFile="$(teamcity_dotnet_nunitlauncher_msbuild_task)" />
  <Target Name="Test" DependsOnTargets="Build">
    <NUnit NUnitVersion="NUnit-2.4.6" Assemblies="@(TestAssemblies)" />
  </Target>
<!--RUNNING UNIT TESTS--> 
```

您可以向目标添加条件，即如果配置为 Release 并且任务失败，则构建失败。

我认为这应该涵盖第 1 点和第 3 点

编辑：另一种方法是使用 Visual Studio 中的 pre/post build 步骤运行 nUnit 测试，这[可能](http://padcom13.blogspot.com/2008/12/running-unit-tests-during-builds-in.html)[会](http://www.csharptocsharp.com/visual-studio-automate-unit-testing)有所帮助。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T12:13:56.293

[您可以在TeamCity](http://www.jetbrains.com/teamcity/)轻松完成此操作。你甚至不需要使用 MSBuild；TeamCity 可以从解决方案文件构建，并且可以配置为运行 NUnit 测试。它执行您在第 2 点中列出的所有功能，并创建趋势图和报告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T21:19:56.463

您可能会发现此列表很有用：[http ://groups.google.com/group/nunit-discuss](http://groups.google.com/group/nunit-discuss)

# xml - XML中的方括号？

> ID：746552
> 
> 赞同：8
> 
> 时间：2009-04-14T06:38:38.877
> 
> 标签：xml, escaping, special-characters

在 XML 文档中，如何处理方括号 (] 或 [) ？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-14T06:47:47.810

方括号在 XML 中不需要特定的符号，但在用于 XSL 转换的 XPath 表达式中时，它们具有特殊的含义。

```
<root>
  <el attrib="[">[</el>
</root> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T06:46:09.390

可能有更好的解决方案。但这有效：

```
&#x005D; 
```

如：

```
<blah value="&#x005D;"></blah> 
```

再说一次，也是如此（见 Kirtan 的回答）：

```
<blah value="]"></blah> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-15T18:31:52.863

" **>** " 不需要转义。

“ **]** ”不需要转义。

" **]]>** " 需要作为 CDATA 元素的一部分进行转义。

# php - 帮助我在 Mysql 中创建庞大的数据库

> ID：746554
> 
> 赞同：0
> 
> 时间：2009-04-14T06:38:55.897
> 
> 标签：php, mysql, database

我们正在建立一个面向全球的商业网站，因为这个概念涵盖了每个国家的主要城市。

我需要 PHP Mysql People 的一些建议。

我可以为所有城市或多个数据库创建单个数据库吗？因为在这个系统中包含了一些城市之间的关系，每个分庭需要近50张用于联网的表和一些其他的表。

如果我可以为每个会议室创建单独的数据库，则需要将近 50*1000 个表，因为我们有 1000 个城市。

所以请给我如何为我的系统建立数据库的建议。

谢谢拉维

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T06:57:58.877

阅读您的问题后，我能给您的唯一建议是修改您对数据库的了解...我认为您遗漏了一些东西...网络可以帮助您解决这个问题。

无论如何，如果您有 2 个对象 City 和 Chamber 您需要 2 张桌子：

*   表1：城市
*   关系：1-n
*   表 2：腔室

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T06:59:10.903

避免使用流动表编号的数据库设计。表格不是行。每个城市都有一张新桌子是没有意义的。每个城市都有一个名称、一个位置以及许多与您的业务相关的其他共享属性。拥有一堆共享完全相同结构的表是没有意义的。我建议您为国家创建一个表格，为城市创建一个表格，为“房间”创建另一个表格。将每个城市与一个国家联系起来。如果您期望与数千个城市合作，那很好。MySQL 中的表可以轻松处理数千行，而不会占用大量服务器资源。如果每个城市都有一些独特的东西，这需要可变字段，您可能希望以不同的方式执行此操作，但可能永远不需要创建数千个表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T07:04:18.597

关系数据库设计要求：只有一个数据库。在某些情况下，将您的数据拆分到多个数据库可能是一种性能黑客的选择，由完全知道自己做什么（但您和我都不知道）的专业人士应用，但通常它只会使情况复杂化并使系统更慢更难维护。

问题是：你甚至需要肮脏的性能黑客吗？拥有数千个城市本身并不是性能问题，这完全取决于良好的索引、服务器、调优、工作负载……

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T07:08:26.060

无论城市如何，您都需要规范相同的内容。或室。

考虑这一点的一种方法是查看您需要的所有不同实体。显然，“城市”就是其中之一。您应该没有理由不能使用一张表来代表所有城市。好的，现在你可以用一个字段来确定一个房间在哪个城市。所以现在所有房间都可以在一张桌子上。这也提供了一种说法，一个房间只属于一个城市，但一个城市可以有多个房间。这称为一对多关系。

相同类型的对象（例如城市）之间的关系更为复杂。您需要明确定义关系是什么：特别是它的名称以及每一方的名称。如果您需要多对多关系，即一个城市与其他几个城市相连，您将需要另一个表来列出这些关系。探索这个有点超出了这个答案框的范围，所以我建议你找一本关于数据库设计的好书或网页，特别是关于规范化的。

# algorithm - 单调递增的二维数组

> ID：746558
> 
> 赞同：1
> 
> 时间：2009-04-14T06:40:28.513
> 
> 标签：algorithm

给出一个算法来找到一个给定元素 x（给出坐标），在一个 n×n 矩阵中，其中行和列是单调递增的。

我的想法：减少问题集的大小。

在第一列中，找到最大的元素 <= x。我们知道 x 必须在这一行或之后（下）。在矩阵的最后一列中，找到 >= x 的最小元素。我们知道 x 必须在这一行或之前。对矩阵的第一行和最后一行执行相同的操作。我们现在已经定义了一个子矩阵，如果 x 在矩阵中，它就在这个子矩阵中。现在在这个子矩阵上重复算法......沿着这些思路。

[YAAQ：又一个数组问题。]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T10:47:14.987

我认为你不能期望超过`O(N)`，这是可以实现的。（N 是矩阵的宽度）。

## 为什么你不能指望更多

想象一个这样的矩阵：

```
0 0 0 0 0 0 ... 0 0 x
0 0 0 0 0 0 ... 0 x 2
0 0 0 0 0 0 ... x 2 2
.....................
0 0 0 0 0 x ... 2 2 2
0 0 0 0 x 2 ... 2 2 2
0 0 0 x 2 2 ... 2 2 2
0 0 x 2 2 2 ... 2 2 2
0 x 2 2 2 2 ... 2 2 2
x 2 2 2 2 2 ... 2 2 2 
```

其中`x`是一个未知数（不是同一个数字，即每列中可能是一个不同的数字）。为了满足矩阵的单调性，您可以在所有位置放置 0、1 或 2 中的任何一个`x`。因此，要查找矩阵中是否有 1，您必须检查所有`x`位置，其中有 N 个。

## 如何制作`O(n)`

`number > q`想象一下，您必须为所有行找到具有（给定数字）的第一列索引。你从矩阵的右上角开始；如果您看到的数字更大，则向左走；否则下去。当你在最后一行时结束。你下来的地方就是你搜索的地方。如果他们中的任何一个有您搜索的号码，那么您已经找到了。

这个算法是`O(n)`，因为在每一步中，你要么向左要么向下。总而言之，它不能超过`N`剩余次数和`N`次数。因此是`O(n)`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T10:47:05.457

选择一个角元素，一个在其行中最大且在其列中最小的元素（或其他方式）。与 x 进行比较。根据比较结果，您可以从进一步搜索中排除行或列。

与原始矩阵相比，新矩阵的维数总和减少了 1。反复应用上述内容。在`2*n`步骤之后，您最终会得到一个`1x1`矩阵。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-14T07:22:54.230

如果“行和列单调增加”意味着每个 (row,col) 中的值增加，使得对于任何行， (rowM,col1) < (rowM,col2) < ... < (rowM,colN) < (rowM+1,col1) ...

然后，您可以将其视为从最小到最大排序的一维数组，并通过从一开始对 1/2(rows * cols) 的项目进行采样，然后对元素进行采样，进行标准二进制搜索1/4(rows * cols) 后面（如果采样的第一个元素 > x）或前面（如果采样的第一个元素 < x），依此类推。

# user-interface - 为什么 UI 编程如此耗时，您可以做些什么来缓解这种情况？

> ID：746565
> 
> 赞同：17
> 
> 时间：2009-04-14T06:43:45.230
> 
> 标签：user-interface, usability

根据我的经验，UI 编程非常耗时、昂贵（设计师、图形等）并且容易出错 - 根据定义，UI 错误或故障非常明显，令人尴尬。

你会采取什么措施来缓解这个问题？

您是否知道可以自动将 API 转换为用户界面（最好是 Web 用户界面？）的解决方案。

可能类似于 JMX 控制台

*   具有良好的默认值
*   可以用css调整
*   其中字段可以配置为单选按钮或下拉列表、文本字段或文本区域等
*   可本地化的
*   ETC

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-14T08:16:04.867

开发 UI 既费时又容易出错，因为它涉及[设计](http://en.wikipedia.org/wiki/Design)。不仅仅是视觉或声音设计，更重要的是交互设计。一个好的 API 始终是交互模型中立的，这意味着它对实际工作流、本地化和信息表示的限制最小。这背后的主要驱动力是封装和代码重用。

因此，仅从 API 中提取足够的信息来构建适合 API 使用的特定案例的良好用户界面是不可能的。

但是，有些 UI 生成器通常会根据给定的 API生成[CRUD屏幕。](http://en.wikipedia.org/wiki/Create,_read,_update_and_delete)不用说，这种生成的 UI 不太适合需要更高 UI 效率的频繁用户，在更大的系统中也不是特别容易学习，因为它们不能很好地传达系统图像或交互顺序。

创建一个好的 UI 需要付出很多努力，因为它需要根据特定的用户需求进行设计，而不是因为一些可以完全自动化的普通 API-UI 转换任务。

为了加快构建 UI 的过程并降低风险，可以建议让 UI 专业人员参与进来，或者自己了解更多关于工作的信息。不幸的是，没有捷径或魔杖，可以这么说，它会产生完全基于 API 的高质量 UI，而无需大量额外的信息和分析。

另请参阅一个很好的问题：“[为什么好的 UI 设计对一些开发人员来说如此困难](https://stackoverflow.com/questions/514083/why-is-good-ui-design-so-hard-for-some-developers)？” 这有一些非常有见地和有价值的答案，特别是：

*   无耻插上[我自己的答案](https://stackoverflow.com/questions/514083/why-is-good-ui-design-so-hard-for-some-developers/516204#516204)。

*   [Karl Fast 的回答很好](https://stackoverflow.com/questions/514083/why-is-good-ui-design-so-hard-for-some-developers/537490#537490)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-14T06:56:28.070

我不相信 UI 编程比任何其他类型的编程更耗时，也不会更容易出错。但是，UI 中的错误通常更明显。在编译器中发现错误通常要棘手得多。

UI 编程之间的一个明显区别是你在另一端有一个人，而不是另一个程序，当你编写编译器、协议解析器、调试器和其他与其他程序和计算机对话的代码时，经常会出现这种情况. 这意味着您正在与之通信的实体没有很好地指定，并且可能表现得非常不稳定。

*编辑：“不可预测”可能是一个更合适的术语。/杰斯珀*

您将 API 转换为用户界面的问题对我来说毫无意义。你在说什么？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T06:54:49.803

看起来您正在寻找“裸对象”架构模式。有各种可用的实现。

[http://en.wikipedia.org/wiki/Naked_objects](http://en.wikipedia.org/wiki/Naked_objects)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T06:55:05.060

我没有提供解决方案，但我会尝试回答原因。

所以我不代表每个人，但至少对我来说，我相信一个原因是因为程序员往往更关注功能而不是可用性，而且他们往往不太艺术。我认为他们只是倾向于具有不同类型的创造力。我发现创建正确的图形需要很长时间，而编写代码需要多长时间（尽管在大多数情况下，我没有做过任何图形要求太多的项目）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T08:30:10.340

自动生成用户界面在某种程度上是可能的，因为它可以为所需的数据输入和输出生成控件。但是 UI 设计比简单地将所需的控件放到屏幕上要复杂得多。为了创建一个可用的、用户友好的 UI，必须结合图形设计、人体工程学、心理学等学科的知识。人机交互正在成为一门学科是有原因的：创建一个像样的 UI 并非易事。

所以我认为你的问题没有真正的解决方案。UI 设计是一项复杂的任务，需要时间才能正确完成。唯一相对容易赢得时间的领域是工具：如果你有强大的工具来实现用户界面的设计，你就不必自己手动编码 UI 的每个像素。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T23:03:38.407

当您说 UI 耗时、昂贵且容易出错时，您是绝对正确的！

我发现的一个很好的折衷方案如下......

我意识到可以使用一个简单的表格（例如 JTable）来呈现大量数据（如果不是大多数），而不是不断尝试创建自定义面板和花哨的 GUI。起初它似乎并不明显，但它相当不错，可用且具有视觉吸引力。

为什么这么快？因为我能够创建一个可重用的框架，它可以接受具体模型的集合，并且可以毫不费力地在表格中呈现所有这些模型。如此多的代码重用，令人难以置信。

通过在窗口上方添加工具栏，我的框架可以添加、删除或编辑表中的条目。使用 JTables 的全部功能，我可以隐藏（通过过滤）并通过扩展各种类（但仅当/当需要时）根据需要进行排序。

每次我想显示和管理新模型时，我都会重用大量代码。我广泛使用图标（每列、每行或单元格等）来美化屏幕。我使用大图标作为窗口标题，以使每个屏幕“看起来”不同且吸引人，它总是看起来像新的和不同的屏幕，但它们背后的代码总是相同的。

起初需要大量的工作和努力来完成这个框架，但现在它得到了很大的回报。

我可以为一个全新的应用程序编写 GUI，该应用程序包含多达 30 到 50 个不同的模型，由我使用“自定义 UI 方法”所花费的时间的一小部分组成。

我建议您评估和探索这种方法！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-14T06:54:21.210

如果您已经知道或可以学习使用[Ruby on Rails](http://rubyonrails.org/)，那么[ActiveScaffold](http://activescaffold.com/)非常适合。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-14T07:06:43.910

一个原因是我们没有一个完善的 UTDD 模式——用户测试驱动开发。我也没有看到很多将用户故事映射到单元测试的好例子。例如，为什么很少有教程讨论用户故事？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-14T08:34:43.870

[ASP.NET 动态数据](http://www.asp.net/dynamicdata/)是您应该研究的东西。它满足大多数（如果不是全部）要求

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-15T23:18:27.343

这很难，因为大多数用户/客户都是愚蠢的，无法思考！:) 这很耗时，因为 UI 开发人员/设计师是如此的强迫症！:)

# c# - 在 Asp.net MVC 中处理带有强类型视图的复选框

> ID：746593
> 
> 赞同：2
> 
> 时间：2009-04-14T06:55:12.160
> 
> 标签：c#, asp.net-mvc

使用 asp.net MVC 和强类型视图处理复选框的正确（TM）方法是什么。我有一个类 'Bar' 有一个成员 'foo'。“foo”是“字节”类型。

现在我想做的是在控制器中有这样的东西：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Page( Bar bar ) 
{
   if (ModelState.IsValid)
   {    
      SaveChanges(bar);
 ... 
```

在视图中是这样的

```
<%=Html.CheckBox( "foo", Model.foo) %> 
```

当然，上面的代码不起作用，因为 DefaultModelBinder(?) 不知道如何将 Checkbox 的输出（在[此处](https://stackoverflow.com/questions/220020/how-to-handle-checkboxes-in-asp-net-mvc-forms)讨论）转换为字节，因此 ModelState.IsValid 为 false。

如何让它发挥作用？自定义模型绑定器？如何？似乎是一个简单的问题，但我未能找到如何做到这一点的全面指南。（是的，我知道我不擅长谷歌搜索:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T07:48:55.137

在您的模型中 - 将 Byte 转换为 Bool 属性。您仍然可以在数据库中存储一个字节。只需让 get/set 使用 bool 并在那里转换。

# sms - 翅膀通信服务器：提交命令状态 0x14

> ID：746594
> 
> 赞同：0
> 
> 时间：2009-04-14T06:55:37.197
> 
> 标签：sms, wcs

有没有人使用过这个工具（WCS）。某些短信未发送。日志说：

```
2007-04-14 10:59:53,490 [logica-smpp2-receiver] ERROR logica-smpp2 - Message not sent, SubmitSM command status: 0x14 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-12T09:04:57.290

如果我正确阅读了规范，命令状态 0x14 表示“消息队列已满”。

我建议： - 尝试在更长的时间内传播消息 - 询问您的 SMPP 提供商有什么限制，您可以在多长时间内发送多少条消息？对呼叫进行适当的更改，或要求他们增加您在给定时间段内可以发送的消息量。

希望这可以帮助！

# database - 有效使用差异的版本控制数据库

> ID：746595
> 
> 赞同：0
> 
> 时间：2009-04-14T06:56:22.640
> 
> 标签：database, versioning, relational-database

我有一个涉及网络投票系统的项目。当前值和相关数据存储在多个表中。历史数据将是这个项目的一个重要方面，所以我还创建了审计表，当前数据将定期移动到其中。

我发现这种策略效率很低。即使我每天只归档数据，即使在某一天只有 1 或 2 个用户进行更新，行数也会变得巨大。

我能想到的下一个替代方案是仅存储已更改的条目。这意味着必须构建逻辑来自动创建给定日期的视图。这意味着更少的存储行，但相当复杂。

我的最终想法有点不那么传统。由于历史数据将用于报告目的，因此网络用户无需快速访问。我在想我的数据库中可能没有历史数据。DB 仅代表当前状态。然后，每天，整个数据库都可以加载到对象中（用户/数据的数量相对较少），然后序列化为 XML 或 JSON 之类的东西。这些文件可能与前一天不同并被存储。事实上，SVN 可以为我做到这一点。当我想要过去一天的数据时，系统必须检索当天的版本并反序列化为对象。这显然是一项代价高昂的操作，但这里的性能并不是那么重要。我正在考虑为此使用 LINQ，我认为这会简化事情。

你会采取哪种方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T15:01:04.473

如果您基本上想知道数据的修订是如何存储在关系数据库中的，那么我会研究 wiki 是如何做到的。

Wiki 都是关于保存详细的修订历史的。他们使用简单的关系数据库进行存储。

考虑 Wikipedia 的数据库[模式](http://upload.wikimedia.org/wikipedia/commons/4/41/Mediawiki-database-schema.png)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T07:04:06.240

您是否考虑过使用真正的版本控制系统，而不是试图硬塞一个数据库来代替它？我本人对 git 很偏爱，但是有很多选择。它们都对版本之间的差异有很好的支持，并且它们往往针对这种工作负载进行了很好的优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T14:18:29.800

关于你的系统，你告诉我们的只是它涉及投票。只要您存储投票时间的时间戳，您就应该能够在任何时间点生成描述投票状态统计的报告......不是吗？

例如，假设我有一个系统可以记录最喜欢的特征（眼睛、微笑、屁股……）。如果我想知道某个特定功能在特定日期有多少票，那么我只需将时间戳小于或等于该日期的所有票数统计在该功能上即可。

如果您想了解其他事物的历史，那么您将遵循类似的方法。

我认为这就是它的完成方式。

[![替代文字](https://i.stack.imgur.com/CdBdn.jpg)](https://i.stack.imgur.com/CdBdn.jpg)

# android - 带有电话号码的安卓模拟器？

> ID：746597
> 
> 赞同：6
> 
> 时间：2009-04-14T06:56:37.710
> 
> 标签：android, emulation, identification

我正在开发一个客户端-服务器 Android 应用程序，并试图弄清楚如何明确地识别服务器的不同电话/用户。我的第一次尝试是使用 SIM 卡上的电话号码。尽管现在我想起来了，但如今，当您更换运营商时，您的电话号码发生变化的情况有多普遍？我想这取决于国与国等。

不管怎样，我一直在想，由于我没有真正的Android手机，如何更改模拟器手机的电话号码来模拟不同的用户。是否有可能或者我应该考虑其他识别方式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T13:36:00.357

`android_id`应该唯一标识设备，但是，如果您知道如何欺骗 android_id，可以更改[id](http://strazzere.com/blog/?tag=android_id)

```
import android.provider.Settings.System;

String android_id = System.getString(this.getContentResolver(), System.ANDROID_ID); 
```

在模拟器中，`android_id`没有值，因此您需要放入一个调试例程来自己分配一个值。

但是，如果您想识别用户，并让用户使用一个用户 ID 从不同设备访问您的服务，您最好为他们分配一个用户 ID，并让他们使用该用户 ID 作为他们的凭据来验证您的服务。这将让他们在许多不同的设备上使用他们的 id，除非您将其`android_id`与`android_id`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T07:40:22.613

您应该使用模拟器提供的数字。例如。通常第一个运行的模拟器的编号为 5554，第二个为 5555，依此类推。

您可以使用这些号码拨打电话，从模拟器发送短信到模拟器。我认为，这会为您的目的模拟不同的数字/用户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T17:51:23.423

SIM 卡信息被硬编码到 emulator-arm 和 emulator-x86 二进制文件中。更改电话号码 (MSISDN) 在此博客文章的末尾有详细说明：[新链接](http://blog.talosintel.com/2013/04/changing-imei-provider-model-and-phone.html)，[网络存档](https://web.archive.org/web/20150909014941/http://vrt-blog.snort.org/2013/04/changing-imei-provider-model-and-phone.html)

SIM 卡存储电话号码，每 2 位数字交换一次。所以（电话号码的前 7 个）`1555521`变成`515525%d1`二进制。虽然有点乏味，但为每次测试打补丁并不是世界末日。你也可以使用 sed：

```
cd path/to/android-sdk-linux/tools/
cp emulator-arm emulator-arm.backup
sed -i 's/515525%d1/816745%d3/g' emulator-arm 
```

这会将号码更改为 1-876-543-[端口号]。有关原因的详细信息在链接的博客文章中。

# asp.net-mvc - LINQ2SQL 的 ASP.NET MVC、jQuery/AJAX 级联下拉列表问题？

> ID：746598
> 
> 赞同：1
> 
> 时间：2009-04-14T06:56:43.717
> 
> 标签：asp.net-mvc, linq-to-sql, jquery

前提：根据第一个选择的值获取下拉列表的内容。文字数据成功返回。LINQ2SQL 数据上下文上的 LINQ 查询失败。

作为这个 MVC/LINQ/jQuery 方面的新手，我一直在争取 HOURS，试图找出我对代码的理解出了什么问题。当我对我的值进行硬编码时，一切正常，但是当我尝试查询 LINQ2SQL 数据上下文时，各种奇怪的事情开始发生，最后，当我将查询结果复制到一个新对象中时，一切都恢复正常了！请原谅我在 LINQ 方面缺乏语言能力，但是，我认为这与 LINQ2SQL 数据的“连接性”有关。当我创建另一个代表查询数据的列表时，一切都很好，但是如果我尝试使用查询数据本身，jQuery 的世界就会崩溃（而且也没有错误——这很难弄清楚）。

我基本上想要参考或解释 LINQ2SQL 的“连接性”以及如何/为什么会出现问题，尤其是在这些远程/异步调用情况下！

请参阅下面的代码 - 希望它有意义并提前感谢您:) 基本布局：

```
<script type="text/javascript">

        $(document).ready(function() {
            $("#CaseTypeCategoryId").change(function() {
                $.getJSON("/Cases/CaseNatures", { caseTypeCategoryId: $("#CaseTypeCategoryId option:selected").val() }, function(data) {
                    $("#CaseNatureId option").remove();
                    $("#CaseNatureId").fillSelect(data);
                });
            });
        });

    </script>
            <p>
                <label for="CaseTypeCategoryId">Case Type:</label>
                <%= Html.DropDownList("CaseTypeCategoryId") %>
            </p>
            <p>
                <label for="CaseNatureId">Case Nature</label>
                <select id="CaseNatureId" name="CaseNatureId></select>
            </p> 
```

控制器.aspx

最初它只是一个

```
SelectList() { new ListItem() { Text = "--Select A Case Nature--", Value = "" }}
```

它工作得很好！然后我尝试了

```
公共 JsonResult CaseNatures(int caseTypeCategoryId)
        {
            返回 this.Json(_caseService.GetCaseNatures(caseTypeCategoryId)
                        .ToList());
        }

```

这失败了 - 没有 javascript 错误，没有编译问题，直到我尝试手动将数据转储到新列表中才弄清楚，我最终决定：

```
公共 JsonResult CaseNatures(int caseTypeCategoryId)
        {
            列表 returnList = new List();
            returnList.Add(new ListItem() { Text = "--Select A Case Nature--", Value = "" });

            _caseService.GetCaseNatures(caseTypeCategoryId)
                        .ToList()
                        .ForEach(p => returnList.Add(new ListItem() { Value = p.CaseNatureId.ToString(), Text = p.CaseNatureText }));
            返回 this.Json(returnList);
        }

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T12:58:18.300

看[这里](https://stackoverflow.com/questions/746815/how-to-get-the-json-object-for-drop-down/748446#748446)- 类似的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-21T12:27:58.363

在你的句子中使用 JsonRequestBehavior.AllowGet ：

this.Json(_caseService.GetCaseNatures(caseTypeCategoryId).ToList(),JsonRequestBehavior.AllowGet);

# asp.net - 配置错误

> ID：746599
> 
> 赞同：0
> 
> 时间：2009-04-14T06:56:58.177
> 
> 标签：asp.net, configuration, windows-authentication

配置错误描述：处理服务此请求所需的配置文件期间发生错误。请查看下面的具体错误详细信息并适当地修改您的配置文件。

解析器错误消息：在应用程序级别之外使用注册为 allowDefinition='MachineToApplication' 的部分是错误的。此错误可能是由未在 IIS 中配置为应用程序的虚拟目录引起的。

源错误：

```
Line 24:             ASP.NET to identify an incoming user. 
Line 25:         -->
Line 26:        <authentication mode="Windows"/>
Line 27:     
Line 28:        <!-- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T07:06:32.117

ASP.NET 引擎建议解决此问题，这是导致此错误的最常见原因：

在 IIS 管理单元 (Inetmgr.msc) 中，右键单击您的网站，转到属性对话框，然后在虚拟目录选项卡上的“应用程序设置”下，单击“创建”为 Web 应用程序创建应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T07:01:30.710

似乎有多个 web.config 文件位于一个虚拟目录中。只需搜索虚拟目录，看看是否是这种情况；如果是，则删除不必要的 web.config 文件或将包含该 web.config 的目录也设为虚拟目录。

# python - 如何在节点属性中写＆符号？

> ID：746602
> 
> 赞同：0
> 
> 时间：2009-04-14T06:57:22.123
> 
> 标签：python, xml

我的 XML 节点中需要有以下属性值：

```
CommandLine="copy $(TargetPath) ..\..\&#x0D;&#x0A;echo dummy > dummy.txt" 
```

实际上这是在 VS2008 中生成的 .vcproj 文件的一部分。`&#x0D;&#x0A`表示换行符，因为应该有 2 个单独的命令。

我正在使用带有 minidom 的 Python 2.5 来解析 XML - 但不幸的是我不知道如何存储序列`&#x0D;`，我能得到的最好的东西是`&amp#x0D;`.

我怎样才能准确存储`&#x0D;`？

UPD：确切地说，我必须以 的形式存储不是 &，而是 \r\n 序列

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T07:04:48.970

您应该尝试将实际字符（ASCII 13 和 ASCII 10）存储在属性值中，而不是已经转义的对应字符。

* * *

编辑：看起来 minidom 没有正确处理属性值中的换行符。

尽管允许在属性值中进行文字换行，但在文档解析时将面临规范化，此时将其转换为空格。

我在这方面提出了一个错误：http: [//bugs.python.org/issue5752](http://bugs.python.org/issue5752)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T12:16:00.517

> 我正在使用带有 minidom 的 Python 2.5 来解析 XML - 但不幸的是我不知道如何存储序列

好吧，您不能专门指定您想要十六进制转义，但是根据 DOM LS 标准，实现应该将属性值中的 \r\n 自动更改为字符引用。

不幸的是，minidom 不会：

```
>>> from xml.dom import minidom
>>> document= minidom.parseString('<a/>')
>>> document.documentElement.setAttribute('a', 'a\r\nb')
>>> document.toxml()
u'<?xml version="1.0" ?><a a="a\r\nb"/>' 
```

这是minidom中的一个错误。在另一个 DOM 中尝试相同的操作（例如[pxdom](http://www.doxdesk.com/software/py/pxdom.html)）：

```
>>> import pxdom
>>> document= pxdom.parseString('<a/>')
>>> document.documentElement.setAttribute('a', 'a\r\nb')
>>> document.pxdomContent
u'<?xml version="1.0" ?><a a="a&#13;&#10;b"/>' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T07:06:42.990

& 号是 XML 中的特殊字符，因此大多数 xml 解析器需要有效的 xml 才能运行。让 minidom 为您转义与符号（实际上它应该已经转义），然后当您需要显示转​​义值时，取消转义它。

# c++ - 将指针绑定到 C++ 中的成员运算符

> ID：746604
> 
> 赞同：4
> 
> 时间：2009-04-14T06:57:54.290
> 
> 标签：c++, operators

他们有什么意义？
我从来没有将它们用于任何事情，而且我根本看不到自己需要使用它们。
我错过了他们的一些东西还是他们几乎没用？

编辑：我对它们了解不多，因此可能需要对它们进行描述...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-14T07:30:30.313

PMF（指向成员函数的指针）类似于普通（静态）函数指针，除了因为非静态成员函数需要`this`指定对象，PMF 调用语法（`.*`或`->*`）允许`this`指定对象（在左侧-手边）。

下面是一个正在使用的 PMF 示例（请注意`.*`正在使用运算符的“魔术”行：`(lhs.*opit->second)(...)`，以及创建 PMF 的语法，`&class::func`）：

```
#include <complex>
#include <iostream>
#include <map>
#include <stack>
#include <stdexcept>
#include <string>

namespace {
    using std::cin; using std::complex; using std::cout;
    using std::invalid_argument; using std::map; using std::stack;
    using std::string; using std::underflow_error;

    typedef complex<double> complexd;
    typedef complexd& (complexd::*complexd_pmf)(complexd const&);
    typedef map<char, complexd_pmf> opmap;

    template <typename T>
    typename T::reference top(T& st) {
        if (st.empty())
            throw underflow_error("Empty stack");
        return st.top();
    }
}

int
main()
{
    opmap const ops{{'+', &complexd::operator+=},
                    {'-', &complexd::operator-=},
                    {'*', &complexd::operator*=},
                    {'/', &complexd::operator/=}};

    char op;
    complexd val;
    stack<complexd> st;

    while (cin >> op) {
        opmap::const_iterator opit(ops.find(op));
        if (opit != ops.end()) {
            complexd rhs(top(st));
            st.pop();
                                        // For example of ->* syntax:
            complexd& lhs(top(st));     // complexd* lhs(&top(st));
            (lhs.*opit->second)(rhs);   // (lhs->*opit->second)(rhs);
            cout << lhs << '\n';        // cout << *lhs << '\n';
        } else if (cin.unget() && cin >> val) {
            st.push(val);
        } else {
            throw invalid_argument(string("Unknown operator ") += op);
        }
    }
} 
```

[[下载](https://gist.githubusercontent.com/cky/871303/raw/8129852ff8d333fd71336edd6f6a9c841b505fed/rpn.cc)]

它是一个使用复数而不是实数的简单 RPN 计算器（主要是因为`std::complex`它是具有重载运算符的类类型）。我已经用[clang](http://clang.llvm.org/)测试过这个；您的里程可能会因其他平台而异。

输入应为`(0,1)`. 空格是可选的，但可以添加以提高可读性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T07:08:35.497

将指针绑定到函数在各种情况下都非常有用。基本上，它允许您将函数称为变量，这使您可以在运行时选择要调用的函数。

一种用途是在“回调”中。假设我想让一些后台进程工作一段时间，并让我们知道它什么时候完成（这样我们就可以更新 GUI 或其他东西）。但有时，我们可能希望这个后台进程调用一个方法，有时，我们希望它调用不同的方法。与其编写此后台进程的两个版本，不如编写它，以便后台进程接收指向我们希望它“回调”的函数的指针。然后，当该过程完成时，它首先调用它给出的任何函数。

基本上，它只是让您在决定调用哪个方法时拥有更大的灵活性。这样，它与多态非常相似。事实上，在幕后，我相信 C++ 使用指向函数的指针来促进多态性（通过为每个类存储指向函数的不同指针表）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T07:29:30.597

如果我正确理解你的问题。为什么不？

```
struct test
{
    test* operator->() 
    { 
        std::cout << "test::operator->";
        return this; 
    }
};

test tt;
boost::bind( &test::operator ->, _1 )( tt ); 
```

# apache - Apache mod_deflate 基于 url 参数

> ID：746611
> 
> 赞同：1
> 
> 时间：2009-04-14T07:01:39.570
> 
> 标签：apache, mod-deflate

apache中的mod_deflate模块可以根据url参数而不是所有服务器请求调用吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T11:38:16.427

你的意思是，`?foo=bar`在你的网址中？除了 URL 参数等之外，也许您可​​以准确地指定您要做什么——一个小用例。一般来说，`mod_deflate`可以用`<Directory />`和`<Location />`在 Apache 中配置。

更多细节在这里： [http ://httpd.apache.org/docs/2.2/mod/mod_deflate.html](http://httpd.apache.org/docs/2.2/mod/mod_deflate.html)

当您提供更多背景信息时，我很乐意扩展我的答案。

**更新：**使用重写规则`?foo=bar`变成`/foo/bar`（或类似的——在你的应用程序中工作的任何东西）。然后使用`<Location />`来匹配和启用`mod_deflate`. 我不认为这是非常可行的。

通常，如果您将问题扩展为为什么要这样做以及您认为收益是什么，我会提出其他建议。

# svn - 如何比较一个项目版本与另一个版本中的代码行数？

> ID：746613
> 
> 赞同：1
> 
> 时间：2009-04-14T07:03:23.653
> 
> 标签：svn, diff

更具体地说，我正在寻找如何通过所有目录递归地计算目录中所有文件的行数。我可以简单地重复项目的两个不同版本，以获得比较图。

或者，由于 subversion 具有相当强大的 diff 功能，是否可以改变两个版本之间的 diff 以获得代码行的绝对差异？

任何一种解决方案都会对我有很大帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T07:11:41.230

有一些很棒的工具可以用来计算代码行数，因为它是一个[有价值的指标](http://en.wikipedia.org/wiki/Source_lines_of_code)。它们包括忽略空格和注释等选项。

只需在[谷歌上搜索](http://www.google.com/search?hl=en&num=100&q=line+count&btnG=Search)特定于您需要的线路计数器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T07:25:22.557

您没有指定您的平台，但如果它恰好是 *nix（包括 windows 下的 cygwin），您可以尝试[sloccount](http://www.dwheeler.com/sloccount/)。我将它用于多种不同的语言，并且对它非常满意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T07:12:03.883

如果你使用 .NET/Java，[NDepend](http://www.ndepend.com/Default.aspx) / [XDepend](http://www.xdepend.com/)支持这个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T07:30:35.163

我在 Windows 上使用[LocMetrics](http://www.locmetrics.com/)。免费且简单的“解压缩”部署。

# regex - Actionscript 3：在完整文件路径中转义“\\”字符时出现问题

> ID：746619
> 
> 赞同：1
> 
> 时间：2009-04-14T07:05:34.863
> 
> 标签：regex, flash, actionscript-3, actionscript

**我发现这项任务在 AS3 中具有挑战性。**

如果我遗漏了一些基本/简单的东西或一些可以做到这一点的内置方法，请原谅。我不精通正则表达式。

我有一个代表完整文件路径的**DYNAMIC**字符串，它看起来与“ **d:\temp\abc.doc** ”完全一样。我想从完整的字符串中提取**文件名部分，例如****abc.doc**。

我知道使用“fullPath.lastIndexOf("\\")”或正则表达式等技术。问题是，如果路径中有“\”，它似乎不起作用。它与“/”一起使用。无法操纵动态路径以将“\”替换为“/”或任何其他分隔符。我的解释是，由于 "\" 用于转义字符-出现在 "\" 之后的任何字符都被**actionscript**忽略。例如

```
var fullPath:String = "A\B\C";

trace(fullPath.length); //**RETURNS 3** since "\B" & "\C" 
                        // are being treated as SINGLE chars

var bSlash:int =  fullPath.lastIndexOf("\\") //RETURNS **-1** 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-14T07:23:54.493

您需要使用`A\\B\\C`（与大多数语言一样，在 AS 中，带有未转义的字符串文字`\`通过与下一个字符组合来创建转义序列）。我有一种感觉，您没有正确生成动态字符串。如果字符串应该是一个路径，那么它应该`\`在路径片段之间包含一个单独的字符，方法是使用 . 转义反斜杠`\\`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T07:15:49.363

我认为如果在你的字符串上使用 use`valueOf`属性来获取原始字符串，你可能会得到你想要的。Actionscript 3 通常创建一个大的花哨的字符串对象，它用转义字符做神奇的事情，但原始字符串更像 JavaScript/ECMA 字符串，反斜杠应该显示为单独的字符。没有测试过这个，但试试看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T06:39:44.753

正如 dirkgently 指出的那样，问题是使用字符串值而不是字符串文字。[这个](http://www.northcode.com/blog.php/2007/07/26/String-Literals-vs-String-Values)链接帮助我解决了这个问题。

# html - 如何使跨浏览器、W3C 有效、语义、非 JavaScript 圆角？

> ID：746627
> 
> 赞同：8
> 
> 时间：2009-04-14T07:09:29.300
> 
> 标签：html, css

我想制作一个*跨浏览器*（FF3、IE6、Safari、Opera）、*W3C 有效*（HTML 和 CSS 两者）、*可拉伸*（水平垂直）、*没有 JavaScript*并且使用*语义*和较小的 HTML 标记**Round CORNER**。*图像可用于 IE6。*

我已经尝试并测试了社区上可用的许多技术。但凡事都有上面提到的问题之一。如果有人知道我想要什么，请与我分享？

请记住，我想在没有任何类型的 JavaScript、jquery 或任何类型的 js 的情况下制作它。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-14T07:24:16.833

两个主要的渲染引擎已经支持 CSS3 很长一段时间了，这使得圆角变得如此简单：

```
-moz-border-radius: 5px;
-webkit-border-radius: 5px;
border-radius: 5px; 
```

当然，这对 IE6 或 7 没有任何影响~~（它适用于IE8）~~或 8 所以你需要用角落的图像来实现讨厌的堆叠分割，这不符合你的语义要求。

我不喜欢涉及 javascript 或 css-hacks 的 display-hacks - 所以我使用 CSS3 并检查 IE7 中的平方版本是否可以接受。我已经这样做了一段时间，因为 IE 也从来没有支持 PNG 透明度——这意味着你不能很好地将圆角图像覆盖在带图案的背景上。IE8 是一个很大的改进，因此问题确实开始消失 - 但我理解您希望使其在 IE6 及更高版本上运行的愿望。

**更新：最初计划包含在 IE8 中的各种 CSS3 零碎实际上已从最终版本中删除。边界半径是受害者之一。**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-14T08:16:34.523

简短的回答是，如果没有 CSS3，你将无法做任何你想做的事情——除了最新版本的浏览器之外，它没有在任何版本中实现。

所以，答案是要么使用 CSS3（如上面 Sohnee 所详述），要么学会喜欢 javascript/divs/images 解决方案。并确保当没有这些浏览器的浏览器查看它时它显示正常...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-10-04T13:07:14.327

迄今为止最好的解决方案是[CSS3Pie](http://css3pie.com/)。

它允许您使用 CSS 向 IE 添加圆角。

您可以将 CSS 边框半径用于所有其他浏览器，将 CSS3Pie 用于 IE。

它使用特定于 IE 的`behavior`样式，因此不是标准的 CSS，但它确实意味着您可以获得正确的语义 HTML（没有用于布局的虚假 div），并且您也不需要担心 JQuery 插件。

它是 Javascript (of sorts)，但只需要在 IE 上运行；所有其他浏览器都将使用普通的 CSS 来处理它，甚至不会加载 IE 特定的代码。

（顺便说一句，IE9 现在确实支持边界半径......但当然，IE6/7/8 仍然存在，并且会持续一段时间）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T08:39:56.043

这应该可以让您获得所需的结果。旧的堆叠 DIV 方法，带有单个大背景图像。您必须创建一个非常大的背景图像，例如 2000 x 2000 像素，您将在其中绘制一个圆角矩形。我建议将其保存为具有透明背景的 .GIF，以确保与 IE6 兼容，因为您要避免使用 JavaScript。请注意，在示例中，边框只是为了帮助确定元素出现的位置以及可以删除的位置。

我在 IE6、IE7、Firefox 2 和 3、Safari 和 Opera 上对其进行了测试。希望这可以帮助。

```
<html>
<head>
  <style type="text/css">
    .RoundRectInside
    {
      width: 100%;
      background: url(BigBackground.gif) top left no-repeat;
      overflow: hidden;
    }

    .RoundRectOutside
    {
      width: 20em;
      height: 20em;
      background: url(BigBackground.gif) bottom left no-repeat;
      overflow: hidden;
      position: relative;
    }

    .RoundRectTopRight
    {
      float: right;
      /* Width and Height should correspond to width and height of rounded corner */
      width: 30px;
      height: 30px;
      background: url(BigBackground.gif) top right no-repeat;
      overflow: hidden;
      position: absolute;
      top: 0;
      right: 0;
    }

    .RoundRectBottomRight
    {
      float: right;
      /* Width and Height should correspond to width and height of rounded corner */
      width: 30px;
      height: 30px;
      background: url(BigBackground.gif) bottom right no-repeat;
      overflow: hidden;
      position: absolute;
      bottom: 0;
      right: 0;
    }
  </style>
</head>

<body>
  <div class="RoundRectOutside">
    <div class="RoundRectInside">
      <div>Content goes here</div>
      <div class="RoundRectTopRight"></div>
    </div>
    <div class="RoundRectBottomRight"></div>
  </div>
</body>

</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T07:20:44.343

您可以使用[此处](http://www.ditchnet.org/wp/2007/02/10/expandable-widget-tutorial/)描述的技术（它适用于 Apple Dashboard Widget，但 HTML/CSS 应该相同）。它使用九张图片，不需要任何 JavaScript。

史蒂夫

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T07:36:12.840

我不知道你所说的语义或可拉伸圆角是什么意思，但你可以使用 Webkit 和 Firefox 的 CSS 边框半径属性，并简单地使用 PNG 图像和[这个 HTML 组件](http://www.twinhelix.com/css/iepngfix/)的组合，它添加了 PNG alpha 通道支持到IE6。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-14T08:51:33.813

我很确定 ie6/7 的最小非 js 圆角技术需要 2 个小图像（顶部和底部）和 1 个额外的 div 用于固定宽度的框，3 个小图像（底部、左侧和右侧）和 3 个额外的 div一个可变宽度的盒子。

固定宽度

```
<div class="box">
<div class="bottom">
gjkgjk
</div>
</div>

.box {background:url(image to round off the top) top left no-repeat:padding:0;}
.box .bottom {background:url(image to round off the bottom) bottom left no-repeat:margin:0;width:100px} 
```

可变宽度

```
<div class="box">
<div class="top-right">
<div class="bottom-left">
<div class="bottom-right">
gjkgjk
</div>
</div>
</div>
</div>

.box {background:url(image to round off the top-left) top left no-repeat:padding:0;}
.box .right{background:url(image to round off the top-right) top right no-repeat:padding:0;margin:0;}
.box .bottom-left {background:url(image to round off the bottom-left) bottom left no-repeat:margin:0;padding:0;}
.box .bottom-right {background:url(image to round off the bottom-right) bottom right no-repeat:margin:0;padding:0;} 
```

如果你想要一个圆形边框而不仅仅是一个圆形纯色背景，上面可以使用边框、负边距、相对/绝对位置、宽度和背景图像位置进行调整，这样它就可以工作了，但我不记得我的头顶了如何。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-14T09:01:01.063

这是迄今为止我发现的最好的。

[http://apptools.com/examples/roundedbox.php](http://apptools.com/examples/roundedbox.php)

它是一个跨浏览器，W3C 有效并且只使用**一个图像**。但我们不能以此为界。

此解决方案适用于固定宽度的边框。

它使用很少的标记`内容

` 使用有效的 css,html [http://www.askthecssguy.com/examples/roundedCorners/index.html](http://www.askthecssguy.com/examples/roundedCorners/index.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-14T09:18:14.703

如果您使用具有 alpha 透明度的 PNG8，则图像在 IE6 中可以具有透明度。需要注意的是，您只能拥有完全透明或不透明的图像（介于两者之间的任何东西都将被渲染为 100% 透明），并且您不能使用大调色板或渐变。

根据您的设计，有一种可能的解决方法，或者您可以将其与上面的 PNG8 选项结合使用。如果您的背景很简单，您可以将角落外的任何内容与背景匹配。使用这种技术，如果您使用精灵，您可以轻松地为角落使用单个图像。标记将类似于以下内容：

```
<div id="content">
     <span class="lt"></span>
     <span class="rt"></span>
     <span class="lb"></span>
     <span class="rb"></span>
</div> 
```

和CSS：

```
#content {position:relative;}

/*These styles are generic and can be reused over multiple corner types*/
.lt, .rt, .lb, .rb{
    background:url(../images/button_corners.png) no-repeat;
    width:5px;
    height:5px;
    position:absolute;
}
.lt, .rt{top:0px;}
.rt, .rb{right:0px;}
.lt, .lb{left:0px;}
.rb, .lb{bottom:0px;}

/*The following would be used specifically for #content, but you could reuse a different part of the same image for a different container or button */

#content .lt{background-position:-200px 0px;}
#content .rt{background-position:-245px 0px;}
#content .lb{background-position:-200px -45px;}
#content .rb{background-position:-245px -45px;} 
```

这种方法有优点和缺点：

**好处**

它是跨浏览器的，它适用于流动和固定布局，你可以将它用于菜单项（悬停在 IE6 中用于链接）或容器，它*不需要*JavaScript，并且使用 CSS 精灵，你可以做到使用单个图像，即使使用多个角类型。

**缺点**

它不适用于每个布局，边框可能很棘手或丑陋，它会在标记中添加一些额外的元素，如果你将它用于具有悬停效果的链接项，IE6 会有一个只能解决的悬停闪烁用一点点 JavaScript。但是，该 JavaScript 只有一行，可以包含在条件注释中：

```
<script type="text/javascript">document.execCommand("BackgroundImageCache",false,true);</script> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-14T10:02:11.150

如果您不介意仅将 Javascript 用于 IE，则可以使用条件注释和 Javascript 来动态插入 VML roundrects，以执行您想要的操作（或仅使用静态有条件注释的 VML）。CSS3 边框半径涵盖 Gecko、WebKit 和 KHTML。Opera 需要 SVG 背景图像。

这是从我的一个项目中提取的一个示例：http: [//entr0py.org/misc/reader/basic/](http://entr0py.org/misc/reader/basic/)

我被告知它仍然有一些与背景颜色相关的 WebKit 错误，但它在其他所有方面都可以正常工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-07-21T08:53:15.650

嗨，我最近不得不克服同样的问题，一个带有圆角、内边框、投影和渐变背景的可调整大小的小部件。它还必须适用于所有浏览器（包括 IE6）。

假设您正在使用 Photoshop 并正确处理您的源文件，这相当容易。总共需要 4 张图像（最多 7 张，取决于您支持 IE6 的方式），这些都可以从原始的 Photoshop 文件中切片，因此非常容易。

查看下面的链接。

[http://thatguynamedandy.com/blog/css-widget-rounded-corner-gradient-drop-shadow](http://thatguynamedandy.com/blog/css-widget-rounded-corner-gradient-drop-shadow)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-10-21T08:06:47.910

以下是一些适用于所有浏览器的方法：

*   [边框样式](http://battletech.hopto.org/html_tutorials/rounded_css_borders/more_styles.html)
*   [时髦的边框](http://www.cssplay.co.uk/boxes/snazzy2.html)
*   [粗边框](http://www.cssplay.co.uk/boxes/chunky.html)
*   [子弹角](http://www.cssplay.co.uk/boxes/curves.html)

# visual-studio-2008 - 如何在 Visual Studio 2008 中维护 VS 2005 解决方案？

> ID：746628
> 
> 赞同：1
> 
> 时间：2009-04-14T07:10:18.083
> 
> 标签：visual-studio-2008, visual-studio-2005, projects-and-solutions

我的任务是维护 Visual Studio 2005 解决方案，但我只能访问 Visual Studio 2008。每当我尝试在 Visual Studio 2008 中打开旧解决方案时，IDE 都热衷于将解决方案转换为新版本。

在这个转换过程中到底发生了什么，有没有办法阻止它（因为我需要提供代码以便它可以在 2005 年打开）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T07:20:38.837

这是 2005 解决方案文件的开头：

```
Microsoft Visual Studio Solution File, Format Version 9.00
# Visual Studio 2005 
```

这是2008年：

```
Microsoft Visual Studio Solution File, Format Version 10.00
# Visual Studio 2008 
```

除此之外，你不应该改变任何东西（在我们的例子中它就是这样工作的）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T07:26:01.960

我的建议是你应该先备份项目，然后你应该运行 VS 2008 的迁移向导。当它询问你是否要查看迁移过程中更改的所有文件的报告时，选择是。它将显示在此过程中更改的文件列表。

***在几乎所有情况下***，更改的文件仅限于版本号更改的项目文件。但是，没有硬性规定不会改变任何其他内容，您不应该依赖这一点。恕我直言，最好的方法是检查“已更改”列表中提到的每个文件中的更改。

如果唯一更改的文件是项目文件，您应该能够轻松地在 VS 2008 中维护代码。当您需要重新部署时，只需将项目文件中的版本改回即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T13:51:22.657

Jon Skeet 发表了一篇关于使 VS2008 解决方案与 VS2005 共存的[帖子。](http://msmvps.com/blogs/jon_skeet/archive/2007/11/20/vs2005-and-vs2008-co-existence.aspx)

[正如@Igor Brejc](https://stackoverflow.com/questions/746628/how-can-i-maintain-a-vs-2005-solution-in-visual-studio-2008/746642#746642)所描述的，解决方案文件的版本号会略有不同。但是，也对项目文件进行了一些更改。这些更改在[本文中进行了描述，其中还有一个漂亮的 VS2005-VS2008 转换器应用程序可用](http://www.emmet-gray.com/Articles/ProjectConverter.htm)：

```
+==========================+====================+==========================+
| Element                  | VS2005             | VS2008                   |
+==========================+====================+==========================+
| Tools Version            | absent             | 3.5                      |
+--------------------------+--------------------+--------------------------+
| Product Version          | 8.0.50727          | 9.0.21022                |
+--------------------------+--------------------+--------------------------+
| Old Tools Version        | absent             | 2.0 (if converted)       |
+--------------------------+--------------------+--------------------------+
| Target Framework Version | absent             | 2.0                      |
+--------------------------+--------------------+--------------------------+
| Bootstrapper             | .NET Framework 2.0 | .NET Framework 2.0 (x86) |
+--------------------------+--------------------+--------------------------+
| Import Project           | $(MSBuildBinPath)  | $(MSBuildToolsPath)      |
+--------------------------+--------------------+--------------------------+ 
```

上述链接中的应用程序会将 VS2008 解决方案中的解决方案和项目文件转换为 VS2005，反之亦然。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T07:19:15.253

首先，据我所知，只有项目文件被更改。目前我遇到的情况，基本上只是改了版本号，插入了目标框架。您只需更改版本即可轻松将项目文件转换回来。

运行转换并使用差异工具比较项目文件（它们是 XML 文本文件），您将立即看到差异。

# apache-flex - 对 HttpService 的 useProxy (Flex 3) 感到困惑

> ID：746634
> 
> 赞同：1
> 
> 时间：2009-04-14T07:14:30.927
> 
> 标签：apache-flex, actionscript-3, actionscript, flex3, mxml

我有一个 flex 应用程序，用户可以在其中提供资源链接。我想执行一个简单的验证并检查 url 是否真的有效（不仅仅是结构，而是实际测试链接以确保我得到 200 OK）。

我想我会只使用 HttpService 并使用 HEAD 方法，但似乎只有当你将 useProxy 设置为 true 时这才可用，但我试过了，但我仍然得到错误；所以我很确定我做错了什么......这是代码片段

```
var service:HTTPService = new HTTPService();
service.method = "HEAD"; 
service.url = url;
service.useProxy = true;
service.addEventListener(ResultEvent.RESULT, result);       
service.addEventListener(FaultEvent.FAULT, error);       
service.send(); 
```

知道我做错了什么吗？对于如何检查 url 是否有效的其他建议，我也持开放态度（我更愿意直接从 Flex 执行此操作，而不必来回访问服务器）。谢谢。

编辑（2009 年 8 月 13 日）

我通过使用 UrlLoader 并在其上分配 2 个侦听器实现了一个简单的 UrlValidator。一个用于 IOError，另一个用于 Progress。我的想法是 Progress 的行为类似于 HEAD 调用，我可以在收到一些数据后终止流。不幸的是，在 404 或 403 的情况下调用了进度事件，这违背了目的。我也在 Open 事件中尝试过这个，但得到了相同的结果。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T09:49:43.823

Adobe 的 Flex 文档指出：“当您不通过基于服务器的代理服务时，您只能使用 HTTP GET 或 POST 方法。但是，当您将 useProxy 属性设置为 true 并使用基于服务器的代理服务时，您也可以使用 HTTP HEAD、OPTIONS、TRACE 和 DELETE 方法。”

基于服务器的代理服务是指 Live Cycle Data Services

我知道 AIR 支持使用 ServiceMonitor 的 HEAD 请求，但看起来 Flex 本身并不支持。

快速搜索一下，看起来有些人使用套接字来滚动他们自己的自定义 URLLoader 类，这些类可以访问请求标头 - 您可以尝试其中一个

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T22:17:11.307

每次我尝试在各种服务器上运行您的代码时，都会遇到策略错误，因此使用 Security.loadPolicyFile(url); 可能是个好主意。首先在尝试运行此代码之前？我正被赶出办公室，但我回家后会再看看这个:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-01T13:52:57.777

`HEAD``service.useProxy`仅当设置为 时才受支持`true`。但`service.useProxy`指的`HTTPProxyService`是 BlazeDS/LCDS 中的。如果您只创建客户端应用程序，则需要设置`service.useProxy`并`false`使用`GET`或`POST`。

另一个问题是，如果您绕过`HTTPProxyService`，则必须满足以下至少一项：

*   URL 必须与您的 Flex 应用程序在同一个域中。
*   必须在托管文档的 Web 服务器上安装`crossdomain.xml`（跨域策略）文件，以允许从应用程序的域进行访问。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-14T12:18:43.457

service.method = "头";

应该是“POST”或“GET”（默认是“GET”）而不是“HEAD”

```
service.useProxy = true; 
```

没必要，去掉线...

如果 URL 可访问，您将收到一个 RESULT 事件。

# .net - 数据绑定比我想的更复杂

> ID：746660
> 
> 赞同：1
> 
> 时间：2009-04-14T07:35:41.500
> 
> 标签：.net, data-binding

我有一个表格，它将由模板中的一堆信息填充，然后交给用户填写其余部分。问题是，保存最终结果的模板和对象是 DataRows，因为它们都进出数据库（我没有架构控制），所以这似乎是一个绑定所有控件的好地方继续做更重要的事情，对吧？

我无法正确绑定控件，这部分是我的错，因为我只想将它扔到一行，让它计算出该行中的哪些列是重要的，并保留这些值，所以我经常抛出没有控件期望的所有列的行，因此它们抛出异常。但这部分是我不知道是谁的错，因为这样做：

```
inProductName.DataBindings.Add("Text", TemplateBinder, "ProductName"); 
```

其中 TemplateBinder 是一个 BindingSource 对象，其 DataSource 属性设置为我想要滴出的 DataRow，当我去显示表单时会引发异常。不太确定我应该做些什么不同 - 在我获得模板行之前，TemplateBinder 不会包含任何 DataSource，如果我必须自己管理绑定而不是设置它们并在页面顶部忘记它们，我不是从绑定中获得很多价值。

这只是一个测试，看看我正在尝试做的事情是否可行！我正在尝试向 BindingSource 传递包含我要传播到表单的值的行，暂停绑定，将其切换为表中的空白行，以便我传播的值保留在我绑定的属性中，显示表单，让用户填写它，然后再次打开绑定，以便控件中的绑定属性滴入我设置为 BindingSource 数据源的空白行。我的意思是，这不可能奏效，因为那太容易了，但如果我能做到这一点，而不是我以前的涉及 30 例 switch 语句的方法，那肯定会很好。

我不想在这里的兔子洞里走得太远。Visual Studio 中有一个诱人的按钮，表示它会自动设置所有内容，但我使用 Visual Studio 的经验表明它不喜欢不会通过 Visual Studio 更改数据库架构的想法。此外，我不知道如何从这种花哨的自动设置中获得我（或者更确切地说，我的客户）所需的灵活性（我什至看不到如何以编程方式弄乱连接字符串）。我拥有的复制粘贴代码可能与其说是杀死功能不如说是罪过，因为我在幕后进行了彻底的改变，恰好使某些非常方便的功能不方便。Copypasta 可以比重写整个应用程序更快地变成一个函数。然后如果数据库发生变化怎么办？Automagic 代码似乎更喜欢抛出异常，而不是仅仅吞下它的骄傲，如果它没有足够的信息来做某事，什么也不做。

所以，堆栈溢出，tl;博士：我想让数据绑定为我工作，而不是让我扔掉我所做的一切。我可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T07:38:53.990

我希望为此工作，您需要使用 a `DataRowView`，而不是 a `DataRow`; 尝试从而`DataView`不是从`DataTable`. 默认视图是`table.DefaultView`.

信息；当您使用 a`DataTable`作为绑定源时它起作用的原因是它`DataTable`实现`IListSource`并（从`GetList()`）返回默认视图 - 所以实际上，当您绑定到 a 时`DataTable`，您*实际上*最终会绑定到默认视图（`DataView`）。

# .net - Sharepoint 网站中适配器的异常创建类型？

> ID：746663
> 
> 赞同：0
> 
> 时间：2009-04-14T07:38:51.510
> 
> 标签：.net, sharepoint-2007, adapter, cssadapter

我在 Sharepoint 2007 中有一个网站。我使用控制适配器，特别是用于菜单和登录控制的适配器。这两个适配器驻留在一个签名的程序集中，它被部署到网站的 bin 文件夹中。浏览器

```
<browser refID="Default">
        <controlAdapters>
            <adapter controlType="System.Web.UI.WebControls.Menu"
             adapterType="NameofEnterprise.SecondName.Adapters.MenuAdapter" />
            <adapter controlType="System.Web.UI.WebControls.Login"
         adapterType="NameofEnterprise.SecondName.Adapters.LoginAdapter" />
        </controlAdapters>
    </browser> 
```

有时我会遇到以下异常，只是有时，比如说一天一两次：

```
Unable to create type 'NameofEnterprise.SecondName.Adapters.MenuAdapter'. 
```

需要记住的事情：这发生在我开发的机器上，我不知道是否有临时文件可以让框架变得疯狂。其次，我不知道框架是否正在另一个程序集中寻找适配器的类，因为我有一些程序集与这个具有相同的命名空间，也就是说：NameofEnterprise.SecondName.BusinessLayer,NameofEnterprise。 SecondName.DataLayer....

Lz你能告诉我可能是什么问题吗？我可以更具体地告诉框架程序集的名称（在浏览器中你只写类和命名空间的名称）吗？

**解决方案**

最后，我使用了您给我的 2 条建议。我认为第一件事就足够了，也就是说：

```
<system.web>
    <compilation>
      <assemblies>
        <add assembly="*<Your assembly name here>*"/>
    </assemblies>
    </compilation>
</system.web> 
```

但是我在浏览器中包含了两个程序集和公共令牌：

```
<browser refID="Default">
    <controlAdapters>
            <adapter controlType="System.Web.UI.WebControls.Menu"
             adapterType="NameofEnterprise.SecondName.Adapters.MenuAdapter", YourAssemblyName, Version=1.0.0.0, Culture=neutral, PublicKeyToken=YourPublicKeyToken"/>
    </controlAdapters> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T07:52:47.247

您应该修改您的 web.config，将您的程序集添加到程序集列表中：

```
<system.web>
    <compilation>
      <assemblies>
        <add assembly="*<Your assembly name here>*"/>
    </assemblies>
    </compilation>
</system.web> 
```

添加包含您的控件的程序集，错误应该会消失。供将来参考，临时 Internet 文件几乎与 Asp.net 错误*无关。*虽然如果它让你感觉更好，你可以清除它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T08:45:34.080

将引用添加到程序集时，使用完整的限定名称也很有用：

```
<browser refID="Default">
    <controlAdapters>
            <adapter controlType="System.Web.UI.WebControls.Menu"
             adapterType="NameofEnterprise.SecondName.Adapters.MenuAdapter", YourAssemblyName, Version=1.0.0.0, Culture=neutral, PublicKeyToken=YourPublicKeyToken"/>
    </controlAdapters> 
```

# mysql - 如何选择第一个字符的唯一列表 [MySQL]

> ID：746669
> 
> 赞同：1
> 
> 时间：2009-04-14T07:41:46.977
> 
> 标签：mysql, utf-8

我有一列包含名称列表。我只需要从名称中选择第一个（唯一）字母。对于非 utf-8 字符，以下查询效果很好：

```
SELECT DISTINCT LEFT(T1.Name, 1) AS firstLetter 
```

但是，如果名称以 UTF-8 编码字符开头，则会返回：�-sign。我想这只是 UTF-8 字符串的第一个字符。

提前致谢。

问题是如何从上面的列中正确选择完整的第一个字符。

PS：表格字符集为utf8，排序规则设置为utf8_bin，字段字符集为utf8，排序规则设置为utf8_turkish_ci。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T08:05:06.610

`LEFT(str, 1)`应该是最左边的*字符*，而不是最左边的*字节*。这意味着查询正在执行您想要的操作，即使第一个字符是多字节字符。

由于连接/编码/字体/渲染问题，我猜测 � 符号稍后会出现。尝试

```
SELECT LENGTH(LEFT(T1.Name, 1)) AS charLength 
```

LENGTH 返回一个字符串占用的**字节**`LEFT()`数，所以如果这个查询给你任何 2 或更多的结果，这意味着它确实返回了多字节字符，你的问题超出了查询本身。

如果您在命令行中执行查询，您的终端可能无法呈现字符，或者它们在其他地方被破坏。如果您使用的是脚本语言，请尝试使用该语言的字符串长度和`ord()`函数来帮助了解发生了什么。

编辑：由于您使用的是 PHP，请尝试以下操作：

```
//Store a character returned from the database in $unicodechar
$unicodechar = $row[0];

//Now print out the value of each byte in the character
for($i = 0; $i < strlen($unicodechar); $i++)
{
    echo '0x' . dechex(ord($char[$i])) . ' ';
}
echo '\n'; 
```

例如，如果结果是[这个字符](http://www.fileformat.info/info/unicode/char/011e/index.htm)，那么你应该得到“0xC4 0x9E”。如果你确实得到了这种东西，那么 PHP 正在正确地获取多字节字符，问题要么在于网页本身的编码（请参阅[此 W3C 页面](http://www.w3.org/International/O-charset)），要么浏览器/字体无法呈现该特定字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T07:48:27.413

根据文档，子字符串函数是多字节安全的。我尝试使用俄罗斯数据库。这应该可以解决问题：

```
SELECT DISTINCT SUBSTRING(T1.Name, 1, 1) AS firstLetter FROM T1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T07:55:31.390

无论是多字节还是基本 ASCII，ORD 函数都将返回最左边字符的代码[。](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_ord)您可以执行以下操作：

```
SELECT DISTINCT ORD(T1.Name) AS firstCode 
```

要取回字符，您可以使用指定 UTF-8 字符集的[CHAR](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_char)函数来获取如下内容：

```
SELECT DISTINCT CHAR(ORD(T1.NAME) USING utf8) as firstLetter 
```

# ios - 如何在 UITextView 中丢失边距/填充

> ID：746670
> 
> 赞同：539
> 
> 时间：2009-04-14T07:42:15.323
> 
> 标签：ios, iphone, cocoa-touch, uikit, uitextview

我的`UITextView`iOS 应用程序中有一个，它显示大量文本。

然后，我使用`UITextView`.

我的问题是填充`UITextView`使我的计算感到困惑，因为它似乎因我使用的字体大小和字体而异。

是否可以删除围绕内容的填充`UITextView`？

* * *

## 回答 #1

> 赞同：819
> 
> 时间：2013-09-24T17:05:03.450

对于 iOS 7.0，我发现 contentInset 技巧不再有效。这是我用来摆脱 iOS 7 中的边距/填充的代码。

这会将文本的左边缘带到容器的左边缘：

```
textView.textContainer.lineFragmentPadding = 0 
```

这会导致文本的顶部与容器的顶部对齐：

```
textView.textContainerInset = .zero 
```

两条线都需要完全删除边距/填充。

* * *

## 回答 #2

> 赞同：460
> 
> 时间：2017-02-19T22:45:34.307

# 2021 年最新版本

它是 iOS 中最愚蠢的错误之一。

这里给出的类`UITextViewFixed`, 被广泛使用，通常是**总体上最合理的解决方案**。

这是课程：

```
@IBDesignable class UITextViewFixed: UITextView {
    override func layoutSubviews() {
        super.layoutSubviews()
        setup()
    }
    func setup() {
        textContainerInset = UIEdgeInsets.zero
        textContainer.lineFragmentPadding = 0
    }
} 
```

不要忘记在 Inspector 中关闭 scrollEnabled！

1.  该解决方案在情节提要中正常工作

2.  该解决方案在运行时正常工作

# 就是这样，你完成了。

一般来说，**在大多数情况下，这应该就是您所需要的**。

即使您正在动态更改文本视图的高度**，**通常`UITextViewFixed`也可以满足您的所有需求。

（动态更改高度的一个常见示例是在用户键入时更改它。）

这是 Apple 损坏的 UITextView ......

![带有 UITextView 的界面生成器的屏幕截图](https://i.stack.imgur.com/4s7P6.png)

这里是`UITextViewFixed`：

![带有 UITextViewFixed 的界面生成器的屏幕截图](https://i.stack.imgur.com/MS5V4.png)

请注意，您当然必须...

# ...在 Inspector 中关闭 scrollEnabled！

（开启 scrollEnabled 的意思是“通过尽可能扩大底部边距，让这个视图尽可能垂直扩大。”）

* * *

# 一些进一步的问题

(1) 在一些非常不寻常的情况下动态改变高度，苹果做了一件奇怪的事情：***他们在底部增加了额外的空间***。

不完全是！这一定是 iOS 中最令人愤怒的事情之一。

如果您遇到问题，这里有一个“快速修复”，通常会有所帮助：

```
...
        textContainerInset = UIEdgeInsets.zero
        textContainer.lineFragmentPadding = 0

        // this is not ideal, but sometimes this "quick fix"
        // will solve the "extra space at the bottom" insanity:
        var b = bounds
        let h = sizeThatFits(CGSize(
           width: bounds.size.width,
           height: CGFloat.greatestFiniteMagnitude)
       ).height
       b.size.height = h
       bounds = b
 ... 
```

(2) 在极少数情况下，要修复 Apple 的另一个微妙问题，您必须添加：

```
override func setContentOffset(_ contentOffset: CGPoint, animated: Bool) {
    super.setContentOffset(contentOffset, animated: false) // sic
} 
```

(3) 可以说，我们*应该*添加：

```
contentInset = UIEdgeInsets.zero 
```

就`.lineFragmentPadding = 0`在`UITextViewFixed`.

但是......信不信由你......这在当前的iOS***中不起作用！***（检查 2021。）将来可能需要添加该行。

在 iOS 中被破坏的事实`UITextView`是所有移动计算中最奇怪的事情之一。这个问题十周年了，它仍然没有解决！

最后，这里有一个类似 Text **Field**的提示：*[Set the maximum character length of a UITextField in Swift](https://stackoverflow.com/questions/31363216/set-the-maximum-character-length-of-a-uitextfield-in-swift/43099816#43099816)*

# 完全随机提示：如何在末尾添加“...”

您经常使用“像 UILabel”一样的 UITextView。因此，您希望它使用省略号“...”截断文本

如果是这样，请添加：

```
 textContainer.lineBreakMode = .byTruncatingTail 
```

# 如果您想要*零*高度，则方便提示，什么时候根本*没有*文字

通常，您使用文本视图仅显示文本。因此，您使用行“0”表示文本视图将根据文本行数自动更改高度。

那太棒了。但是**如果根本没有文字**，那么不幸的是你得到的高度**就像有一行文字**一样！！！！文本视图永远不会“消失”。

[![在此处输入图像描述](https://i.stack.imgur.com/rPM5y.png)](https://i.stack.imgur.com/rPM5y.png)

如果你想让它“消失”，只需添加这个

```
override var intrinsicContentSize: CGSize {
    var i = super.intrinsicContentSize
    print("for \(text) size will be \(i)")
    if text == "" { i.height = 1.0 }
    print("   but we changed it to \(i)")
    return i
} 
```

[![在此处输入图像描述](https://i.stack.imgur.com/od7BI.png)](https://i.stack.imgur.com/od7BI.png)

（我把它设为“1”高度，所以很清楚那个演示中发生了什么，“0”很好。）

# UILabel 呢？

当只是显示文本时，UILabel 比 UITextView 有很多优势。UILabel 不会遇到此问答页面中描述的问题。

事实上，我们通常“放弃”而只使用 UITextView 的原因是 UILabel 很难使用。特别是要正确地向 UILabel添加**padding是非常困难的。**

事实上，这里是关于如何“最终”正确地向 UILabel 添加填充的完整讨论：向 UILabel*[添加空间/填充](https://stackoverflow.com/questions/27459746/adding-space-padding-to-a-uilabel/58876988#58876988)*。在某些情况下，如果您正在使用动态高度单元格进行困难的布局，有时最好使用 UILabel 进行困难的布局。

* * *

## 回答 #3

> 赞同：259
> 
> 时间：2009-07-26T18:59:52.760

**此解决方法是在 2009 年发布 iOS 3.0 时编写的。它不再适用。**

我遇到了完全相同的问题，最后我不得不使用

```
nameField.contentInset = UIEdgeInsetsMake(-4, -8, 0, 0); 
```

其中 nameField 是一个`UITextView`. 我碰巧使用的字体是 Helvetica 16 点。这只是我正在绘制的特定字段大小的自定义解决方案。这使得左侧偏移与左侧齐平，并且顶部偏移在我想要的位置用于绘制它的框。

此外，这似乎只适用于`UITextViews`您使用默认对齐方式的地方，即

```
nameField.textAlignment = NSTextAlignmentLeft; 
```

例如，向右对齐，`UIEdgeInsetsMake`似乎对右边缘完全没有影响。

至少，使用 .contentInset 属性允许您将字段放置在“正确”的位置，并在不偏移您的`UITextViews`.

* * *

## 回答 #4

> 赞同：87
> 
> 时间：2015-02-04T00:58:53.093

基于已经给出的一些好的答案，这里是一个纯粹的基于 Storyboard / Interface Builder 的解决方案，适用于 iOS 7.0+

为以下键设置 UITextView 的**用户定义的运行时属性：**

```
textContainer.lineFragmentPadding
textContainerInset 
```

![界面生成器](https://i.stack.imgur.com/2VzYp.png)

* * *

## 回答 #5

> 赞同：47
> 
> 时间：2012-05-08T12:36:13.957

在 iOS 5 上`UIEdgeInsetsMake(-8,-8,-8,-8);`似乎工作得很好。

* * *

## 回答 #6

> 赞同：43
> 
> 时间：2016-04-24T18:36:34.113

我肯定会避免任何涉及硬编码值的答案，因为实际边距可能会随着用户字体大小设置等而改变。

这是[user1687195 的答案](https://stackoverflow.com/questions/746670/how-to-lose-margin-padding-in-uitextview/18987810#18987810)，没有修改`textContainer.lineFragmentPadding`（因为[文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSTextContainer_Class/#//apple_ref/occ/instp/NSTextContainer/lineFragmentPadding)说明这不是预期的用途）。

**这适用于 iOS 7 及更高版本。**

```
self.textView.textContainerInset = UIEdgeInsetsMake(
                                      0,
                                      -self.textView.textContainer.lineFragmentPadding,
                                      0,
                                      -self.textView.textContainer.lineFragmentPadding); 
```

这实际上是相同的结果，只是更简洁一点，因为它不会滥用 lineFragmentPadding 属性。

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2013-09-05T09:02:31.293

**使用用户定义的运行时属性的**Storyboard 或 Interface Builder 解决方案：

屏幕截图是 iOS 7.1 和 iOS 6.1 的`contentInset = {{-10, -5}, {0, 0}}`.

![用户定义的运行时属性](https://i.stack.imgur.com/rDBdL.png)

![输出](https://i.stack.imgur.com/z0HXK.png)

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2015-06-26T15:31:44.480

所有这些答案都解决了标题问题，但我想为 OP 问题正文中提出的问题提出一些解决方案。

### 文本内容的大小

计算内部文本大小的一种快速方法`UITextView`是使用`NSLayoutManager`：

```
UITextView *textView;
CGSize textSize = [textView usedRectForTextContainer:textView.textContainer].size; 
```

这给出了总的可滚动内容，它可能大于`UITextView`' 框架。`textView.contentSize`我发现这比它实际计算文本占用的空间要准确得多。例如，给定一个空的`UITextView`：

```
textView.frame.size = (width=246, height=50)
textSize = (width=10, height=16.701999999999998)
textView.contentSize = (width=246, height=33)
textView.textContainerInset = (top=8, left=0, bottom=8, right=0) 
```

### 线高

`UIFont`有一个属性可以快速获取给定字体的行高。因此，您可以快速找到您的文本的行高`UITextView`：

```
UITextView *textView;
CGFloat lineHeight = textView.font.lineHeight; 
```

### 计算可见文本大小

确定实际可见的文本数量对于处理“分页”效果很重要。`UITextView`有一个名为的属性`textContainerInset`，它实际上是实际`UITextView.frame`和文本本身之间的边距。要计算可见框架的实际高度，您可以执行以下计算：

```
UITextView *textView;
CGFloat textViewHeight = textView.frame.size.height;
UIEdgeInsets textInsets = textView.textContainerInset;
CGFloat textHeight = textViewHeight - textInsets.top - textInsets.bottom; 
```

### 确定分页大小

最后，现在您有了可见的文本大小和内容，您可以通过从 中减去 来快速确定偏移`textHeight`量`textSize`：

```
// where n is the page number you want
CGFloat pageOffsetY = textSize - textHeight * (n - 1);
textView.contentOffset = CGPointMake(textView.contentOffset.x, pageOffsetY);

// examples
CGFloat page1Offset = 0;
CGFloat page2Offset = textSize - textHeight
CGFloat page3Offset = textSize - textHeight * 2 
```

使用所有这些方法，我没有触摸我的插图，我能够转到插入符号或我想要的文本中的任何位置。

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2015-05-05T05:24:57.290

您可以使用 的`textContainerInset`属性`UITextView`：

```
textView.textContainerInset = UIEdgeInsetsMake(10, 10, 10, 10); 
```

（上、左、下、右）

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2018-02-14T14:37:43.460

这是[Fattie 非常有用的答案](https://stackoverflow.com/questions/746670/how-to-lose-margin-padding-in-uitextview/42333832#42333832)的更新版本。它添加了两条重要的线，帮助我让布局在 iOS 10 和 11 上工作（也可能在较低的版本上）：

```
@IBDesignable class UITextViewFixed: UITextView {
    override func layoutSubviews() {
        super.layoutSubviews()
        setup()
    }
    func setup() {
        translatesAutoresizingMaskIntoConstraints = true
        textContainerInset = UIEdgeInsets.zero
        textContainer.lineFragmentPadding = 0
        translatesAutoresizingMaskIntoConstraints = false
    }
} 
```

**重要的几行是两个`translatesAutoresizingMaskIntoConstraints = <true/false>`语句！**

这令人惊讶地**消除了我所有情况下的所有利润**！

虽然不是第一响应者，但可能会出现一些奇怪的底部边距，使用接受的答案中提到`textView`的方法无法解决。`sizeThatFits`

当点击 textView 时，奇怪的底部边距突然消失了，一切看起来都应该如此，但只有在 textView 获得`firstResponder`.

[因此，我在 Stack Overflow 上](https://stackoverflow.com/questions/13186908/can-i-use-setframe-and-autolayout-on-the-same-view)读到`translatesAutoresizingMaskIntoConstraints`，在调用之间手动设置框架/边界时，启用和禁用确实有帮助。

幸运的是，这不仅适用于框架设置，还适用于`setup()`夹在两个`translatesAutoresizingMaskIntoConstraints`调用之间的两条线！

例如，这在**使用****on**计算视图框架时**非常有用**。它会返回正确的大小（以前没有）！**`systemLayoutSizeFitting``UIView`**

正如在原始答案中提到的：

*不要忘记在 Inspector 中关闭 scrollEnabled！该解决方案在情节提要中以及在运行时都可以正常工作。*

**就是这样，现在你*真的*完成了！**

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2016-10-12T06:38:16.090

对于 iOS 10，以下行适用于顶部和底部填充删除。

```
captionTextView.textContainerInset = UIEdgeInsetsMake(0, 0, 0, 0) 
```

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2018-05-24T07:54:33.497

最新的斯威夫特：

```
self.textView.textContainerInset = .init(top: -2, left: 0, bottom: 0, right: 0)
self.textView.textContainer.lineFragmentPadding = 0 
```

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2017-10-26T16:54:33.653

**对于 Swift 4、Xcode 9**

使用以下功能。它可以改变 UITextView 中文本的边距/填充：

```
public func UIEdgeInsetsMake(_ top: CGFloat, _ left: CGFloat, _ bottom: CGFloat, _ right: CGFloat) -> UIEdgeInsets 
```

所以在这种情况下是：

```
 self.textView?.textContainerInset = UIEdgeInsetsMake(0, 0, 0, 0) 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2011-03-31T23:49:05.607

做插入解决方案我仍然在右侧和底部有填充。文本对齐也引起了问题。我发现的唯一可靠的方法是将文本视图放在另一个裁剪到边界的视图中。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2018-03-04T00:19:15.610

这是一个简单的小扩展，它将从您的应用程序中的每个文本视图中删除 Apple 的默认边距。

注意：Interface Builder 仍将显示旧边距，但您的应用程序将按预期工作。

```
extension UITextView {

   open override func awakeFromNib() {
      super.awakeFromNib();
      removeMargins();
   }

   /** Removes the Apple textview margins. */
   public func removeMargins() {
      self.contentInset = UIEdgeInsetsMake(
         0, -textContainer.lineFragmentPadding,
         0, -textContainer.lineFragmentPadding);
   }
} 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2020-05-06T17:39:29.343

**对于[SwiftUI](https://developer.apple.com/xcode/swiftui/)**

如果您正在使用自己的 TextView`UIViewRepresentable`并想要控制填充，请在您的`makeUIView`函数中执行以下操作：

`uiTextView.textContainerInset = UIEdgeInsets(top: 10, left: 18, bottom: 0, right: 18)`

或任何你想要的。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2018-06-17T11:20:45.747

对我（iOS 11 和 Xcode 9.4.1）来说，神奇的是将 textView.font 属性设置为`UIFont.preferred(forTextStyle:UIFontTextStyle)`样式，也是[Fattie 提到](https://stackoverflow.com/questions/746670/how-to-lose-margin-padding-in-uitextview/42333832#42333832)的第一个答案。但是在我设置 textView.font 属性之前，Fattie 的答案不起作用。否则 UITextView 一直表现不正常。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2019-05-16T10:44:46.133

如果有人正在寻找最新的 Swift 版本，那么下面的代码可以在**Xcode 10.2**和**Swift 4.2上正常工作**

```
yourTextView.textContainerInset = UIEdgeInsets(top: 0, left: 0, bottom: 0, right: 0) 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2013-02-28T10:17:28.253

我发现了另一种方法。从 UITextView 的子视图中获取带有文本的视图并在子类的 layoutSubview 方法中进行设置：

```
- (void)layoutSubviews {
    [super layoutSubviews];

    const int textViewIndex = 1;
    UIView *textView = [self.subviews objectAtIndex:textViewIndex];
    textView.frame = CGRectMake(
                                 kStatusViewContentOffset,
                                 0.0f,
                                 self.bounds.size.width - (2.0f * kStatusViewContentOffset),
                                 self.bounds.size.height - kStatusViewContentOffset);
} 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-12-25T19:37:05.553

textView 滚动也会影响文本的位置，使其看起来不像垂直居中。通过禁用滚动并将顶部插图设置为 0，我设法使视图中的文本居中：

```
 textView.scrollEnabled = NO;
    textView.textContainerInset = UIEdgeInsetsMake(0, textView.textContainerInset.left, textView.textContainerInset.bottom, textView.textContainerInset.right); 
```

出于某种原因，我还没有弄清楚，在打字开始之前光标仍然没有居中，但是当我开始打字时，文本立即居中。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2020-01-03T17:07:52.080

如果您想设置 HTML 字符串并避免底部填充，请确保您没有使用块标签，即`div`和`p`.

就我而言，这就是原因。您可以通过将出现的块标签替换为例如标签来轻松测试它`span`。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2021-06-15T14:39:54.073

您需要在 didMoveToSuperView 上设置 inset 和 lineFragmentPadding

```
@IBDesignable class UITextViewFixed: UITextView {
    override func didMoveToSuperview() {
        super.didMoveToSuperview()
        setup()
    }
    func setup() {
        textContainerInset = UIEdgeInsets.zero
        textContainer.lineFragmentPadding = 0
    }
} 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2021-08-23T08:14:24.587

对于因为将 HTML 解析为 UITextView 而遇到此问题的任何人，只需删除由结束 p 标记“/n”引入的新行。我假设您使用**NSMutableAttributedString**：

```
if let lastCharacter = attributedString.string.last, lastCharacter == "\n" {
    attributedString.deleteCharacters(in: NSRange(location:(attributedString.length) - 1, length:1))
} 
```

* * *

## 回答 #24

> 赞同：-4
> 
> 时间：2011-08-11T21:48:18.497

```
[firstNameTextField setContentVerticalAlignment:UIControlContentVerticalAlignmentCenter]; 
```

# php - 检查PHP中是否存在目录

> ID：746672
> 
> 赞同：25
> 
> 时间：2009-04-14T07:45:43.567
> 
> 标签：php, file-io

我知道，*我知道*，这听起来*很*容易。但我似乎无法在互联网上找到正确的答案。

我发现的解决方案之一是使用`is_dir`.

```
if(is_dir($dir))
  echo 'directory exists';
else
  echo 'drectory not exist'; 
```

但这是***错误***的——这个函数所做的只是检查是否`$dir`是一个目录，它不检查目录是否存在。换句话说，如果我说：

```
$rootDir = "C:\\Documents and Settings\\test\\My Documents\\Image Directory\\Me Dog\\"; 
```

然后该函数将返回 true，即使您在 Web 服务器上找不到这样的目录。

有任何想法吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-04-14T07:47:51.423

应该可以正常工作。从`is_dir()`文档：

> **如果文件名存在并且是目录**，则返回 TRUE ，否则返回 FALSE。

好吧，无论如何，如果它不尝试这个：

```
if(file_exists($dir) && is_dir($dir)) 
```

顺便提一句。这些函数的结果缓存在统计缓存中。使用[clearstatcache()](http://www.php.net/manual/en/function.clearstatcache.php)清理该缓存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T07:50:20.013

在 is_dir() 同意路径（可能）是目录之后，您可能想要使用[opendir() 。](http://www.php.net/function.opendir)

如果 opendir() 返回的资源是有效的，你就知道你有一个目录，并且已经有一个句柄来读取它。

如果返回有效句柄，请务必调用 closedir()。

编辑：

此答案假定您将以任何一种方式打开目录。如果您只需要确保路径正常/有效，则 file_exists() 便宜得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-22T15:00:12.310

```
bool file_exists ( string $filename ) 
```

检查文件或目录是否存在。

[http://php.net/manual/en/function.file-exists.php](http://php.net/manual/en/function.file-exists.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T07:50:58.563

你可以试试这个：

```
if(is_dir($dir) && is_writeable($dir))
{
    // ...
} 
```

# visual-studio-2008 - 适用于 Visual Studio 2008 的 XML 架构设计器

> ID：746673
> 
> 赞同：7
> 
> 时间：2009-04-14T07:46:04.563
> 
> 标签：visual-studio-2008, xsd, designer

[VS 2005](http://msdn.microsoft.com/en-us/library/ms171945(VS.80).aspx)确实包含了 XSD 文件的设计器。
我在哪里可以找到 VS 2008 的版本？我只找到了[VS 2008 beta 2](http://www.microsoft.com/downloads/details.aspx?FamilyID=4de12c98-1221-4a0e-b5aa-bfc7daf02550&DisplayLang=en)的预览版。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T08:13:13.313

我建议不要将数据集编辑器用于 XML 模式，微软从 VS 2005 停止支持模式设计器是有原因的。

从 VS 2005 模式设计器生成的模式，我们遇到了无穷无尽的麻烦，以至于我们最近不得不重新设计它们。

我要么使用基本的 XML 文本编辑器和 XML 文档大纲，要么查看 XML Spy。这是我们刚刚购买的（在使用免费试用版之后）来验证和重做我们的模式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T07:50:29.937

在 VS2008 中，AFAIK 的*主要*工具是 xml 编辑器，在“XML Schema Explorer”工具栏的帮助下。除此之外，您还有“数据集设计器”，但这可能会添加特定于数据集的元素。

来自 MSFT 支持负责人的帖子在[这里](http://social.msdn.microsoft.com/Forums/en-US/vs2008prereleasexml/thread/a795d444-1c2a-42a8-9228-9e0f2f99c96a)；有*传言说*这会带外发布，但我还没有看到任何东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T13:33:31.977

微软在 2008 年发布时放弃了模式编辑器。我永远无法真正理解旧版本中发布的版本，因此损失不大。他们确实在 2007 年发布了模式编辑器，但它的级别非常低，并不比测试编辑器好多少。请参阅[MS 架构设计器](http://blogs.msdn.com/xmlteam/archive/2007/08/27/announcing-ctp1-of-the-xml-schema-designer.aspx)。

XML Spy 提供的集成有点笨拙，似乎不太适合 Visual Studio。

我们使用 Liquid XML Studio，它与 Visual Studio 无缝集成，使编写 XML Schema 变得更加容易。请参阅[XML 架构编辑器 Visual Studio 插件](http://www.liquid-technologies.com/XmlStudio/Visual-Studio-Plugin-XML-Schema-Editor.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T07:52:14.190

右键单击您的 XSD 文件并选择“打开方式...”，然后选择数据集编辑器。

（如果您还没有 .XSD 文件，请创建一个空文本文件并使用 XSD 扩展名命名）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T14:01:05.747

在这里您可以找到与错误报告相同的问题。

[无法在设计器模式 (VS2008) 中查看 XSD 文件](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=420483)

您可以在[此处找到有关该主题的更多信息](http://social.msdn.microsoft.com/Forums/en-US/xmlandnetfx/thread/84212ff1-ca41-4a86-bc0a-fe9d59b902f9?prof=required)

# jquery - 将 jQuery、jQuery UI 和 jQuery 主题与 Zend 框架集成

> ID：746676
> 
> 赞同：2
> 
> 时间：2009-04-14T07:46:35.173
> 
> 标签：jquery, zend-framework, user-interface, datepicker, themes

**更新：**这个问题指的是 Zend Framework 的旧版本。要了解如何将 jQuery 与 Zend Framework 1.9.4 (1.8+) 应用程序集成，[请参阅此问题](https://stackoverflow.com/questions/1616857/)。

* * *

我想我了解基本概念，但我一定是在某个地方出错了。我正在尝试将 jQuery、jQuery UI 和 jQuery 主题集成到我的 Zend Framework 应用程序中。

在我的引导程序中，我正在注册 jQuery 视图助手：

```
$view->addHelperPath(self::$root . '/library/ZendX/JQuery/View/Helper/', 'ZendX_JQuery_View_Helper'); 
```

在我的表单中，我有一个日期选择器元素：

```
$date = new ZendX_JQuery_Form_Element_DatePicker('date'); 
```

在我的布局中，我调用了 jQuery 视图助手：

```
<head>
    <?= $this->jQuery() ?>
</head> 
```

完成此操作后，我实际上可以使用日期选择器。唯一的问题是日历完全搞砸了。它根本无法正确显示。

据我了解，javascript 文件是自动包含的（并由 Google 托管）。因此，为了使用不同的主题（来自[ThemeRoller](http://jqueryui.com/themeroller/)），您必须在自己的服务器上托管 js 和 css 文件。为了让我的日期选择器显示不同的主题，我应该经历什么过程？

**更新：**我通过这样做让它工作。但我不确定这是否是最有效的方法。

```
<head>
<? //I couldn't get this way to work
   //$this->jQuery()->addStylesheet('http://ajax.googleapis.com/ajax/libs/jqueryui/1.7/themes/smoothness/jquery-ui.css');
   //But this way works
   $this->jQuery()->addStylesheet('/js/jquery/themes/ui-lightness/jquery-ui-1.7.1.custom.css')
              ->setLocalPath('/js/jquery/js/jquery-1.3.2.min.js')
              ->setUiLocalPath('/js/jquery/js/jquery-ui-1.7.1.custom.min.js') ?>
    <?= $this->jQuery() ?>
</head> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T08:21:43.130

使用`ZendX_JQuery_View_Helper_JQuery`视图助手（当然您也可以使用视图助手注册样式表`Zend_View_Helper_HeadStyle`，但使用 jQuery 视图助手将确保仅在启用 jQuery 时包含样式表）您可以注册从 Google CDN 提供的样式表：

```
$view->jQuery()->addStylesheet('http://ajax.googleapis.com/ajax/libs/jqueryui/1.7/themes/smoothness/jquery-ui.css'); 
```

*根据[jQuery UI ThemeRoller](http://jqueryui.com/themeroller/)库， *smoothness是主题名称。*更多主题网址请参阅[jQuery UI 1.7.1 发布公告博客文章](http://blog.jqueryui.com/2009/03/jquery-ui-171/)。*

 *顺便说一句，我建议使用 jQuery 启用视图`ZendX_JQuery::enableView($view)`。我个人认为这是更明显的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T13:11:22.693

如果您使用的是 Google CDN，您只需将 .css 文件托管在您自己的服务器上。我不知道 ZendX_Jquery 是否使用它。这应该就是让它工作的全部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-19T16:05:56.650

我认为您需要下载 jquery ui css 文件。从 zip 中提取 css 文件并在您的 zend 应用程序中本地提供它们。我将文件添加到 '[Your_zend_project_root]\public\js\'。在您的 layout.phtml 文件中，使用“addStylesheet()”方法将路径添加到本地 css 文件。您需要更改所选主题名称的特定路径。

```
<?php echo $this->jQuery()
    ->setUiVersion('1.7.2')
    ->addStylesheet('/js/jquery-ui-1.7.2/development-bundle/themes/ui-lightness/jquery-ui-1.7.2.custom.css');?> 
```

# git - 如何在存储库中搜索某个字符串的所有 Git 和 Mercurial 提交？

> ID：746684
> 
> 赞同：301
> 
> 时间：2009-04-14T07:49:49.190
> 
> 标签：git, mercurial

我有一个 Git 存储库，其中很少有分支和悬空提交。我想在存储库中搜索所有此类提交以查找特定字符串。

我知道如何获取历史中所有提交的日志，但这些不包括分支或悬垂的 blob，只是 HEAD 的历史。我想把它们全部收集起来，找到一个放错地方的特定提交。

我也想知道如何在 Mercurial 中执行此操作，因为我正在考虑切换。

* * *

## 回答 #1

> 赞同：339
> 
> 时间：2009-04-14T08:53:11.847

你可以看到悬空提交`git log -g`。

```
-g, --walk-reflogs
 Instead of walking the commit ancestry chain, walk reflog entries from
 the most recent one to older ones. 
```

因此，您可以这样做以在悬空的提交消息中查找特定字符串：

```
git log -g --grep=search_for_this 
```

或者，如果要搜索特定字符串的更改，可以使用镐搜索选项“-S”：

```
git log -g -Ssearch_for_this
# this also works but may be slower, it only shows text-added results
git grep search_for_this $(git log -g --pretty=format:%h) 
```

Git 1.7.4 将[添加 -G 选项](http://gitster.livejournal.com/48191.html)，允许您通过 -G<regexp> 来查找包含 <regexp> 的行何时被移动，而 -S 无法做到这一点。-S 只会告诉您包含字符串的总行数何时更改（即添加/删除字符串）。

最后，您可以使用 gitk 来可视化悬空提交：

```
gitk --all $(git log -g --pretty=format:%h) 
```

然后使用它的搜索功能来查找放错位置的文件。所有这些工作都假设丢失的提交没有“过期”并且被垃圾收集，如果它悬空 30 天并且您使 reflogs 过期或运行使它们过期的命令，则可能会发生这种情况。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-05-21T00:37:51.443

在 Mercurial 中，您用于`hg log --keyword`搜索提交消息中的关键字并`hg log --user`搜索特定用户。查看`hg help log`其他限制日志的方法。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-04-17T10:11:39.070

除了使用or的[Richq 答案](https://stackoverflow.com/a/746790/46058)之外：查看当前 git 维护者 Junio C Hamano 的以下博客文章`git log -g --grep=<regexp>``git grep -e <regexp> $(git log -g --pretty=format:%h)`

*   [“git log --grep”的乐趣](http://gitster.livejournal.com/30195.html)
*   [“git grep”的乐趣](http://gitster.livejournal.com/27674.html)

* * *

### 概括

[git grep](https://www.kernel.org/pub/software/scm/git/docs/git-grep.html)和[git log --grep](https://www.kernel.org/pub/software/scm/git/docs/git-log.html)都是面向*行的*，因为它们查找与指定模式匹配的行。

您可以使用`git log --grep=<foo> --grep=<bar>`（或`git log --author=<foo> --grep=<bar>`内部转换为 two `--grep`）来查找匹配**任**一模式（隐式**OR**语义）的提交。

由于是面向行的，有用的**AND**语义是用于`git log --all-match --grep=<foo> --grep=<bar>`查找在某处**同时**具有第一行匹配和第二行匹配的***提交。***

 **您可以将`git grep`多个模式（所有必须使用`-e <regexp>`表单）与（`--or`这是默认设置）`--and`、、、`--not`和。对于 grep意味着该***文件***必须具有与每个替代项匹配的行。`(``)``--all-match`

 ** * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-05-26T22:59:15.787

基于 rq 的回答，我发现这条线可以满足我的要求：

```
git grep "search for something" $(git log -g --pretty=format:%h -S"search for something") 
```

它将报告提交 ID、文件名并显示匹配的行，如下所示：

```
91ba969:testFile:this is a test 
```

...是否有人同意将其包含在标准 git grep 命令中是一个不错的选择？

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-14T08:49:10.543

任何将引用作为参数的命令都将接受`--all`手册页中记录的选项`git rev-list`，如下所示：

```
 --all
       Pretend as if all the refs in $GIT_DIR/refs/ are listed on the
       command line as <commit>. 
```

因此，例如`git log -Sstring --all`将显示所有提及`string`并且可以从分支或标签访问的提交（我假设您的悬空提交至少用标签命名）。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-20T00:42:18.807

使用 Mercurial，您可以

```
$ hg grep "search for this" [file...] 
```

还有其他选项可以缩小搜索的修订范围。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-14T08:54:33.357

不了解 git，但在 Mercurial 中，我只需将 hg log 的输出通过管道传输到一些 sed/perl/whatever 脚本，以搜索您要查找的任何内容。如果您愿意，您可以使用模板或样式自定义 hg log 的输出，以使其更易于搜索。

这将包括 repo 中的所有命名分支。Mercurial 没有像悬空的 blobs afaik 之类的东西。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-09-12T15:00:52.717

如果你是 vim 用户，你可以安装 tig (apt-get install tig)，然后使用 /，同样的命令在 vim 上搜索

[https://blogs.atlassian.com/2013/05/git-tig/](https://blogs.atlassian.com/2013/05/git-tig/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-10-27T04:24:01.257

要添加一个尚未提及的解决方案，我不得不说使用 gitg 的图形搜索框对我来说是最简单的解决方案。它将选择第一个匹配项，您可以使用 Ctrl-G 找到下一个匹配项。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-12-06T04:07:20.723

git 中的一个命令，我认为查找字符串要容易得多：

```
git log --pretty=oneline --grep "string to search" 
```

适用于 Git 2.0.4

# unix - 如何从文件中删除重复的行

> ID：746689
> 
> 赞同：17
> 
> 时间：2009-04-14T07:51:59.183
> 
> 标签：unix, command-line, duplicates

我有一个生成测试和预测输出的工具。这个想法是，如果我失败了，我可以将预测与实际输出进行比较，看看它们在哪里分歧。问题是实际输出包含一些行两次，这使`diff`. 我想删除重复项，以便我可以轻松比较它们。基本上，类似`sort -u`但没有排序。

是否有任何 unix 命令行工具可以做到这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-14T08:09:44.867

对答案的补充`uniq`，如果您不介意`sort`先检查文件，这将非常有用。如果您需要删除不相邻的行（或者如果您想在不重新排列文件的情况下删除重复项），则应该使用以下 Perl 单行代码（从[此处](http://www.unix.com/shell-programming-scripting/42005-remove-duplicated-lines-without-sort.html)窃取）：

```
cat textfile | perl -ne '$H{$_}++ or print' 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-04-14T07:53:44.890

[独特的(1)](http://unixhelp.ed.ac.uk/CGI/man-cgi?uniq)

概要

> uniq [选项]... [输入 [输出]]

描述

> 丢弃来自 INPUT（或标准输入）的所有连续相同行，但写入 OUTPUT（或标准输出）。

或者，如果您还想删除不相邻的重复行，perl 的这个片段会这样做：

```
while(<>) {
    print $_ if (!$seen{$_});
    $seen{$_}=1;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-07-18T14:09:04.317

这是一个 awk 实现，以防环境没有/允许 perl（还没有看到）！PS：如果有多个重复的行，那么这会打印重复的输出。

```
awk '{

# Cut out the key on which duplicates are to be determined.
key = substr($0,2,14)

#If the key is not seen before, store in array,else print
if ( ! s[key] )
    s[key] = 1;
else
    print key;
}' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T07:53:52.643

如果您有兴趣删除*相邻*的重复行，请使用`uniq`.

如果要删除*所有*重复的行，而不仅仅是相邻的行，那就更棘手了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T08:03:12.853

这是我在这里等待答案时想到的（尽管第一个（和接受的）答案在大约 2 分钟内出现）。我在`VIM`：

```
%s/^\(.*\)\n\1$/\1/ 
```

这意味着：在换行符之后查找与之前相同的行，并仅将它们替换为我们在第一行中捕获的内容。

`uniq`不过，肯定更容易。

# java - 自动生成值对象

> ID：746694
> 
> 赞同：3
> 
> 时间：2009-04-14T07:52:52.973
> 
> 标签：java, annotations, runtime, code-generation, compile-time

给定一个或多个接口，生成类实现的最佳方法是什么？

```
interface Vehicle
{
    Engine getEngine();
}

@Generated
class Car implements Vehicle
{
    private final Engine engine;

    public Car(Engine engine)
    {
        this.engine = engine;
    }

    public Engine getEngine()
    {
        return engine;
    }

    // generated implementation of equals, hashCode, toString, 
} 
```

类变量应该从接口的 getter 方法派生。理想情况下，将处理接口中的协变返回类型。实现应该通过使用私有最终变量和构造函数实例化来支持不变性。应该生成 equals、hashCode 和 toString 方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T13:28:45.707

更简洁的方法是使用[CGLIB](http://cglib.sourceforge.net/)在运行时动态生成类。显然，您无法浏览源文件。

如果您需要源文件，您可以尝试[codemodel](https://codemodel.dev.java.net/)并执行以下操作：

```
JCodeModel cm = new JCodeModel();
x = cm._class("foo.bar.Car");
x.field(Engine.class, "engine");
for (PropertyDescriptor pd:    Introspector.
              getBeanInfo(Vehicle.class).getPropertyDescriptors()) {
    g = x.method(JMod.PUBLIC, cm.VOID, pd.getReaderMethod().getName()); 
    g.body()...
    s = x.method(JMod.PUBLIC, cm.VOID, "set" + pd.getName());
    s.body()...
}
hc = x.method(JMod.PUBLIC, cm.VOID, "hashCode"));
hc.body()...
cm.build(new File("target/generated-sources")); 
```

或者如前所述，使用 IDE（在 Eclipse 中：菜单“Source”、“Generate hashcode() and equals()...”，即）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T08:12:56.153

在为接口实现类时，就像 eclipse 一样。

如果方法以 get 开头，则将其视为 getter 并解析该方法以提取变量名称及其类型。也为这些字段创建一个构造函数，并实现 equals、hashcode 和 toString 方法。

您可以进行正常的文件解析，或者反射也可以帮助不确定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T11:19:43.210

如果您打算做很多事情，那么您可能希望考虑 javac 中内置的注释处理器功能（回到 Java SE 1.5 中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T09:30:04.987

除了使用可以帮助您进行样板编码的现代 Java IDE 之外，您还可以使用[动态代理进行检查](https://stackoverflow.com/questions/734110/persistent-data-structures-in-java/737357#737357)

# c++ - 启动 RPC 服务器时出现“端点重复”

> ID：746702
> 
> 赞同：3
> 
> 时间：2009-04-14T07:59:57.823
> 
> 标签：c++, windows, rpc

我的程序使用 Microsoft RPC 进行进程间通信。为了准备接收 RPC 调用，程序运行以下序列：

1.  RpcServerUseProtseqEp()，然后

2.  RpcServerRegisterIf()，然后

3.  RPCServerListen()

该程序以上述顺序启动其 RPC 服务器，工作一段时间，然后终止，稍后可能由另一个程序重新启动。每次运行程序时，RpcServerUseProtseqEp() 的参数值集都是相同的。

当序列在重新启动后第一次运行时，它总是成功，但在随后的运行中 RpcServerUseProtseqEp() 返回 RPC_S_DUPLICATE_ENDPOINT （“端点是重复的。”）目前我只是忽略这个特定的错误代码并将其视为成功，然后所有其他原语通常工作正常。

使用 RpcServerUseProtseqEp() 的正确方法是什么？我应该进行任何清理以撤销注册的端点还是继续忽略 RPC_S_DUPLICATE_ENDPOINT 错误代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T09:21:46.660

我不是 RPC 专家，但我认为您可能希望在服务器终止时使用**RpcEpUnregister取消注册端点。**这个函数的文档提到了一个端点数据库，我猜它在你的服务器的实例中持续存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-26T14:25:50.797

我有同样的问题，我无法完全解决，但这段代码对我有用：

```
UCHAR* pszProtocolSequence = (UCHAR*)"ncacn_ip_tcp"; // Use RPC over TCP/IP
UCHAR* pszSecurity = NULL;
UCHAR* pszEndpoint = (UCHAR*)"9300";
UINT cMinCalls = 1;
UINT cMaxCalls = m_dwConcurrentChannels;
UINT fDontWait = FALSE;

int RPC_tries, MAX_RPC_Tries;
RPC_tries=0;
MAX_RPC_Tries=60;
do
{
    status = ::RpcServerUseProtseqEp(
    pszProtocolSequence, cMaxCalls, pszEndpoint, pszSecurity);
    Sleep(1000);
    RPC_tries+=1;
}while(status!=RPC_S_OK && RPC_tries<MAX_RPC_Tries); 
```

出于某种原因，当您重新启动 Windows 服务时，您必须等待一段时间才能再次使用 RpcServerUseProtseqEp。

# c - 隐式声明和可变参数函数之间的冲突

> ID：746707
> 
> 赞同：1
> 
> 时间：2009-04-14T08:03:47.737
> 
> 标签：c

任何人都可以确认标准对 vararg 函数的默认返回类型的规定。我正在编译以下代码：

```
int main()
{
    maw(32,3,95,38,20,15);
    return 0;
}

int maw(int a,int b,...)
{
    int *p=&b,i=0;
    while(i++<a)
       printf("\t%d",*p++);
    return 0;
} 
```

但它给出了错误：

```
foo.c:9: error: conflicting types for ‘maw’
foo.c:10: note: a parameter list with an ellipsis can’t match an empty parameter name list declaration
foo.c:4: error: previous implicit declaration of ‘maw’ was here 
```

但是如果在maw的定义过程中，如果我提到它作为`void maw(int a, int b, ...)`编译是很好的。

我可以从中看出 vararg 函数的默认返回类型可能不是`int`.

标准在这方面怎么说？谁能帮我确认一下？

* * *

我知道，如果我只是标准化代码，它将完美运行。我已经做了。没有问题。

我的观点是：这段代码有什么问题？它应该可以完美运行。像这样的代码不会运行没有任何错误吗？

```
int main()
{

abc();
.....
return 0;
}

abc()
{
.......
} 
```

当使用可变参数函数时，问题就来了。我知道标准对函数的默认声明有何规定。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-14T08:09:58.673

其他答案是正确的，关于将函数原型放在首位。

此外，为了便于移植，不要`...`使用指向最后一个（非可变参数）参数的直接指针来访问参数，因为这样您就必须关心目标平台的对齐方式和堆栈方向。相反，使用`<stdarg.h>`和`va_*`使用可变参数的宏。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T08:07:15.887

在 main() 之前声明 maw()，或者在 main() 之前声明它的原型。函数返回您分配给它们的类型，而不管参数（可变参数与否）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T08:07:39.270

问题是您在定义它之前调用了该函数，而不包括声明。如果你添加这样的一行：

```
int maw(int a, int b, ...); 
```

在你的`main()`功能之前，你会没事的。默认（“implcit”）是假设一个函数返回`int`，并且有一个空的参数列表。依赖隐式声明是不好的形式，您应该显式声明所有函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T08:08:10.097

这与返回类型无关 - 这是您声明它的事实。发表声明：

```
int maw(int a,int b,...); 
```

在您使用 main() 中的函数之前

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T09:53:48.860

正如每个答案（到目前为止）所说：为了避免错误，在使用之前声明函数，正如 Chris Jester-Young 指出的那样，使用标准机制来访问可变参数或遭受未定义行为的痛苦。

在这个例子中，并不是因为函数的返回类型而需要在这种情况下使用之前的声明，而是因为它与未声明函数的默认签名不匹配`int u()`：也就是说，一个接受未指定参数的函数返回一个`int`. 具体来说，实际定义`int maw(int,int,...)`与假设声明~~不一致~~`int maw()`，导致 GCC 说“'maw' 的类型冲突”。

你的第二个例子

```
int main() {
  abc(); ..... return 0; 
}
abc() { ....... } 
```

之所以有效，是因为后面的定义与`abc`遇到第一次调用时假定的默认签名不矛盾。但是仅仅因为它有效并不能使它成为良好的形式，因为您几乎没有从默认签名中获得类型安全。

访问可变参数（与 匹配的参数`...`）确实应该通过 的标准机制来完成`stdarg.h`，除非您正在实现一个编译器并且是该编译器的`stdarg.h`. 例如，在某些架构上，这些参数甚至可能不会在堆栈上传递，但它们仍然可以通过来自`stdarg.h`.

**编辑：**我改写了第二段，以不同的方式表达我的意思，我希望更清楚。

*编译器需要在第一次调用之前*知道该函数是可变参数的，因为在某些体系结构上，可能需要以不同于普通参数的方式传递可变参数参数。对于某些寄存器窗口 RISK 体系结构尤其如此，以及那些可能在寄存器中传递前 2 个整数和前 2 个浮点数的架构，但即使寄存器中有空间也必须将所有可变参数放在堆栈上。

对于不使用`cdecl`调用约定的函数，存在类似的在使用前声明的情况。当链接用 Pascal 或 FORTRAN 编写的模块与用 C 编写的模块时，您通常会遇到这种情况。但是，核心 DLL 导出的许多 Windows API 函数假定调用约定命名`stdcall`，如果编译器使用`cdecl`样式调用，则程序会崩溃（以及 Windows 9x 或更早版本上的整个机器）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T08:09:27.753

添加声明

```
int maw(int a,int b, ...); 
```

*在*你的`main()`功能之前。

目前，您在`main()`函数中进行的调用隐式定义了`maw()`，也就是说，编译器“猜测”什么`maw()`是返回类型是基于它在中给出的信息`main()`。如果`maw()`在调用之前声明，就不会有这个问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-30T04:32:01.283

调用实际上采用可变数量参数的隐式声明函数具有未定义的行为。

我没有看到实际引用标准相关部分的答案。对于隐式函数定义，这仅在 C89 和 C90 中允许。

从 C89，§3.3.2.2，¶4：

> 如果函数调用中带括号的参数列表之前的表达式仅包含一个标识符，并且如果该标识符没有可见的声明，则该标识符被隐式声明，就好像在包含函数调用的最里面的块中，声明
> 
> ```
> 外部 int 标识符（）；
> ```
> 
> 出现了。

在同一部分，¶6 中，它指出调用隐式声明的函数，该函数稍后被声明为采用可变数量的参数会导致未定义的行为。

> 如果表示被调用函数的表达式的类型不包含原型，则对每个参数执行整数提升，并且浮点类型的参数提升为双精度。这些称为默认参数提升。如果参数的数量与参数的数量不一致，则行为未定义。如果函数是用不包含原型的类型定义的，并且提升后的参数类型与提升后的参数类型不兼容，则行为未定义。如果函数定义的类型包含原型，并且提升后的实参类型与参数类型不兼容，或者原型以省略号 ("`, ...`")，行为未定义。

# c++ - 有没有办法使用“ostream”来覆盖现有的 std::string 实例

> ID：746735
> 
> 赞同：2
> 
> 时间：2009-04-14T08:21:56.727
> 
> 标签：c++

我知道各种 ostreams 都有自己的内部缓冲区。我必须知道是否有某种 ostream 接受实例 std::string 并在该实例上写入。

（我想避免冗余副本）

**注意：**我的问题是关于标准库的，不要向我提供其他可以做到这一点的库，我知道它们存在。:)

**编辑：**在请求更具体之后......这是我想要的，请考虑以下代码：

```
std::string str = "bla bla bla ";
std::ospecialstream o(str);
o << 34 << " bla bla";
std::cout << str; //console output : "bla bla bla 34 bla bla" 
```

我想要 ospecialstream 这样它就不会将 str 内容复制到某个内部缓冲区，而是写入 str 的同一个实例。

**编辑 #2** 我出于性能原因需要它，ostringstream 将在使用字符串创建时创建一个 memcopy，并且在检索内容时也会创建一个 memcpy。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T08:28:09.800

[`std::ostringstream`](http://www.cplusplus.com/reference/iostream/ostringstream/)标头的一部分`sstream`。

这个怎么样：

```
void appendStuff(string& in) {
   ostringstream os;
   os << 34 << " bla bla";
   in += os.str();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T08:32:41.787

如果您问是否可以更改 ostream 的缓冲，那么答案是肯定的。但是，根据您实际希望缓冲区执行的操作，这并不是一项特别简单的任务。您将需要查阅[Langer & Kreft 之](http://www.angelikalanger.com/iostreams.html)类的书以获取更多信息。

L&K 有一个如何实现无缓冲输出流的示例——它从本书的第 229 页开始。这里复现太长了，但基本上需要重新定义派生的streambuf类的overflow()方法。

请注意，这本书不能在线获得，但源代码显然是 - 有关详细信息，请参阅此[页面](http://www.angelikalanger.com/IOStreams/examples.htm)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T09:02:37.173

简短的回答：没有

长答案：是的，但这需要编写自己的`streambuf`类，然后用`rdbuf`. 此外，现在已弃用的[strstream](http://www2.roguewave.com/support/docs/leif/sourcepro/html/stdlibref/strstream.html)几乎可以满足您的需求，并且可能仍在您的编译器库中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T03:35:45.593

```
#include <iostream>
#include <string>

class intostring : public std::basic_streambuf<char> {
  std::string &str;
public:
  intostring(std::string &pstr):str(pstr) {}
  virtual std::streamsize xsputn(const char *const p, const std::streamsize n) {
    str.append(p, n);  
  }
};

int main() {
  std::string s("Original string: ");

  intostring newbuf(s);

  std::streambuf *oldbuf = std::cout.rdbuf(&newbuf);
  std::cout << "Should go to string" << std::endl;
  std::cout.rdbuf(oldbuf);  

  std::cout << "Should go to console again ... and here's the string: '" 
            << s << "'" << std::endl;
} 
```

输出：

应该再次进入控制台......这是字符串：'原始字符串：应该转到字符串'

# xml - 将图像插入 XML 文件

> ID：746736
> 
> 赞同：17
> 
> 时间：2009-04-14T08:22:38.347
> 
> 标签：xml, image

我想在 XML 文件的元素中插入图像，最好的方法是什么？您能否建议一些将图像包含到 xml 文件的好方法？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-14T08:24:22.383

最常见的方法是将二进制作为 base-64 包含在元素中。但是，这是一种解决方法，会增加文件的体积。

例如，这是字节 00 到 09（注意我们需要 16 个字节来编码 10 个字节的数据）：

```
<xml><image>AAECAwQFBgcICQ==</image></xml> 
```

*你如何*进行这种编码因架构而异。例如，对于 .NET，您可以使用`Convert.ToBase64String`, 或`XmlWriter.WriteBase64`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T08:26:54.357

我总是将字节数据转换为 Base64 编码，然后插入图像。

这也是 Word 执行此操作的方式，因为它是 XML 文件（不是 Word 是如何使用 XML 的一个很好的示例：P）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-14T08:25:41.757

由于 XML 是一种文本格式，而图像通常不是（除了一些古老和古老的格式），因此没有真正明智的方法来做到这一点。查看像 ODT 或 OOXML 之类的东西也会告诉您它们不会将图像直接嵌入到 XML 中。

但是，您可以将其转换为 Base64 或类似格式并将其嵌入到 XML 中。

但是，在这种情况下，XML 的空白处理可能会使事情变得更加复杂。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-14T08:26:50.800

XML 不是用于存储图像的格式，也不是二进制数据。我认为这完全取决于你想如何使用这些图像。如果您在 Web 应用程序中并想从那里读取它们并显示它们，我会存储 URL。如果您需要将它们发送到另一个 Web 端点，我会将它们序列化，而不是手动保存在 XML 中。请解释一下是什么场景。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-14T08:31:35.143

下面是一些取自[Kirk Evans 博客](http://blogs.msdn.com/kaevans/archive/2005/04/02/404927.aspx)的代码，演示了如何在 C# 中对图像进行编码；

```
//Load the picture from a file
Image picture = Image.FromFile(@"c:\temp\test.gif");

//Create an in-memory stream to hold the picture's bytes
System.IO.MemoryStream pictureAsStream = new System.IO.MemoryStream();
picture.Save(pictureAsStream, System.Drawing.Imaging.ImageFormat.Gif);

//Rewind the stream back to the beginning
pictureAsStream.Position = 0;
//Get the stream as an array of bytes
byte[] pictureAsBytes = pictureAsStream.ToArray();

//Create an XmlTextWriter to write the XML somewhere... here, I just chose
//to stream out to the Console output stream
System.Xml.XmlTextWriter writer = new System.Xml.XmlTextWriter(Console.Out);

//Write the root element of the XML document and the base64 encoded data
writer.WriteStartElement("w", "binData",
                         "http://schemas.microsoft.com/office/word/2003/wordml");

writer.WriteBase64(pictureAsBytes, 0, pictureAsBytes.Length);

writer.WriteEndElement();
writer.Flush(); 
```

# asp.net-mvc - 我有 15 分钟的时间向我的同事介绍 ASP.NET MVC。我应该关注哪些主题？

> ID：746740
> 
> 赞同：18
> 
> 时间：2009-04-14T08:25:46.980
> 
> 标签：asp.net-mvc

自从 ASP.NET MVC 出现在 RTM 之前，我就一直将它用于个人项目。

我正在为我的同事准备一个演示文稿，向他们介绍 ASP.NET MVC 的基本概念，并向他们展示如何在我们的环境中使用它。

我的演示文稿有 15 分钟的限制。有很多信息需要传递（特别是如果您考虑到 MVCContrib 和各种博客文章等项目）。

我应该关注哪些主题？

**一些背景：**我在一家数字机构工作。我的同事是具有 3 年以上 ASP.NET 经验的 .NET 开发人员。

**到目前为止的建议：**

*   想要切换到 ASP.NET MVC 的原因
*   路由
*   ActionResults（提供不同响应的能力）
*   请求-响应内部
*   可测试性
*   脚手架（T4 模板）
*   对 HTML 输出的细粒度控制
*   关注点分离 （）
*   ASP.NET WebForms 和 ASP.NET MVC 的区别

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-14T08:34:20.657

您只有 2 或 3 个要点的时间。

要掌握的最重要的概念是请求到达控制器，然后控制器**选择**什么视图来呈现**控制器**生成的结果。

下一个重要的概念是，当您为控制器和模型创建单元测试时，MVC 比“经典”ASP.NET 大获全胜。没有这个 MVC 只是另一种剥猫皮的方法。

最后一点，我会关注 URL 的结构，不是因为它那么重要，而是因为我们喜欢有干净感觉的东西，而 MVC Urls 可以做到这一点，这可能有助于产生积极的响应。

避免继续说没有服务器控件（这并不完全正确），因为这可能会引起负面响应。一般来说，避免提及与 ASP.NET 表单相比不做的事情（尽管不需要 Viewstate 值得顺便提一下）。您知道收益会权衡缺少（或不必要）的东西，但您的听众却没有。保持积极。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T08:28:32.480

*   路由
*   ActionResults 的灵活性
*   将不同的视图连接到同一个控制器动作（即移动视图）

单元测试的大主题对于 15 分钟的会议来说可能太大了，但是如果您的开发人员已经在使用 TDD，我会添加它

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-07-21T10:16:07.303

我必须为我的老板写报告，证明我为什么想在 webforms/Nettiers 上使用 MVC。我写了我的报告[http://ivida.co.uk/2011/05/11/mvc-nhibernate-vs-webforms-nettiers/](http://ivida.co.uk/2011/05/11/mvc-nhibernate-vs-webforms-nettiers/)

我知道你只有很短的时间跨度，但你可以从下面的列表中找到一些想法......

1.  MVC 的好处

ASP.MVC 是针对与其他开发平台相关的 Web 表单的批评而编写的。虽然 Web Forms 为开发人员提供了一个快速应用程序开发框架，并且被编写为“模仿”Win Forms 中使用的开发方法，但它使得在其他平台上实施的某些实践变得难以实施，并且被视为良好开发的基础。1.1.可测试

MVC 允许编写自动化单元和集成测试。这具有许多明显的优点。

a) 大大减少了人工测试的需要；通过显着减少手动测试的数量，创建单元测试的前期成本在下游得到了回报。

b) 可以在整个开发过程中运行；这是非常宝贵的，因为它允许开发人员确保他们不会对代码库进行重大更改。

c) 使开发人员有信心对代码库进行更改，因为测试会显示任何错误。

d) 导致代码库更加严格，因为代码在整个开发过程中已经多次测试，而不是零星的手动测试。

e) 每个测试都是封装在代码中的功能需求。如果要求只有具有角色 X 的用户才能执行活动 Y，则测试是满足此要求的证据。如果开发人员在一段时间后返回代码库，这将变得非常宝贵，因为通过运行测试可以直接查看需求。

开发人员可以根据项目的要求编写尽可能少的测试代码。如果一个项目暴露在规范的变化中，那么进行测试可以显着加快变更的实施。对于影响较小的小型开发，可以缩减自动化测试以覆盖主要创建/更新和删除场景，而不是读取场景。

编写测试本身就是一门艺术，随着时间的推移，开发人员会变得更好。无需编写任何测试代码，经验丰富的开发人员就可以在类似的时间内使用 MVC 或 Web 表单创建项目。编写测试可能会增加 20% 的开发时间，但会大大减少系统测试的时间。

进行测试还可以大大减少实施更改所需的时间，如果更改很重要，实际上可能允许更改发生在否则会被视为风险太大或太耗时的地方。

1.2.坚持良好的软件设计原则

ASP.MVC 遵循一些设计良好和可维护软件的公认原则，例如：

```
“Don’t Repeat Yourself (DRY)
“Separation of Concerns” (SoC) 
```

关注点分离（不将 UI 逻辑与底层行为混合）是帮助开发人员处理复杂性的基本原则。在同一个对象或文件中混合不同的职责（例如将大部分逻辑放在文件后面的代码中，例如处理编辑、取消和编辑回发事件）会引发维护问题，并使代码难以更改和阅读。MVC 规定了某些类型的对象应该在哪里编写，从而使生成的代码库更加清晰和易于遵循。

1.3.MVC是规范的

因为 MVC 遵循良好的软件设计原则，所以它规定了应该在哪里开发某些类型的代码。这在团队环境中很有用，因为它比 Web 表单更标准化项目结构。一旦开发人员熟悉了 MVC 项目结构，在哪里寻找某些类型的代码就变得很明显了。这将使处理其他开发人员的代码变得更加容易；a）因为处方和 b）因为运行单元测试将确保其他开发人员不会破坏现有功能。它还可以帮助开发人员决定应该在哪里开发某些类型的代码以及应该如何分离代码以便于维护。

1.4.MVC 可以轻松与 JavaScript 框架集成

自 2004 年推出 Google Suggest 以来，客户端 Web 开发发生了翻天覆地的变化。此更改与 AJAX 功能的实现有关。AJAX（异步 JavaScript 和 XML 的简写）是一组用于客户端的相关技术，用于创建丰富的交互式和响应式 Web 应用程序。使用 AJAX，Web 应用程序可以在后台从服务器异步检索数据，而不会干扰现有页面的显示和行为。AJAX 使用 HTML 和 CSS 的组合来标记和样式信息。DOM 使用 JavaScript 访问以动态显示，并允许用户与之交互，呈现的信息。

由于跨浏览器的标准合规性实施不同，这种类型的功能过去很难编程。现在这已不再是一个问题 a) 由于更好的标准合规性和 b) 更重要的是由于 JavaScript 框架（如 JQuery）的开发允许您编写适用于每个浏览器的代码。

MVC 中的“V”代表“视图”，仅处理 HTML 和 JavaScript 的前端交付。MVC 允许与 JS 框架（如 JQuery）轻松集成，并极大地简化了使用此类框架创建丰富的客户端体验。（请注意，JQuery 现在作为 ASP.NET 2010 的标准提供，Microsoft 现在正在积极地为 JQuery 代码库做出贡献，而且可能姗姗来迟）。

这种简化的集成使开发与用户在现代网站上期望的性能相匹配的用户体验变得更加容易。这是一个微妙的观点，但我认为我们不应该忽视这一点。我们的客户将越来越多地基于他们对更广泛互联网的使用，对他们如何与网站互动产生隐含的期望。现在很少有商业网站没有实现 AJAX 功能和它提供的流畅的响应式界面。不考虑开发丰富的前端，将越来越使我们的输出与客户的期望相比较不利。

1.5\. 网络消费正在发生变化（快）

摩根士丹利预测，到 2013 年中期（即 2 1/2 年内），使用移动设备访问网络的人数将超过使用固定互联网/桌面的人数。

(http://gigaom.files.wordpress.com/2010/04/mobile-chart2.png)

这与 MVC 有什么关系？我相信 MVC 是一个更好的平台，可以将内容传递到各种设备，因为它更容易实现 JS 库，并且它允许开发人员轻松控制 HTTP 响应的内容（下面将详细解释）。

1) 更容易实现 AJAX – 移动设备上的 3G 连接目前没有与宽带相媲美的带宽。AJAX 极大地提高了较慢连接时页面的性能，因为您只返回所需的数据（由浏览器格式化）而不是数据和整个页面。

2) MVC 使开发人员可以更好地控制请求返回的数据。这在实际代码示例中最为明显，但在两行代码中，开发人员可以返回整个页面（包含母版页等）、JSON（JavaScript 对象表示法），这是 AJAX 请求中选择的数据格式、XML 或任何其他格式必需的。

代码示例：

```
//Try doing this in webforms

If (IsJson)

{

return this.JSON(model);

}

Else if (IsXml)

{

return new XMLResult(model);

}

else

{

return View(model)l;

} 
```

使用 Web 窗体要实现这种级别的控制要困难得多。对 HTTP 响应中返回的内容进行严格控制可以简化一系列设备的内容开发，例如传统浏览器或智能手机应用程序，或位于其他平台（例如 SharePoint）中的应用程序。2.1.1.6.MVC 使用 RESTFul URL

MVC 使开发人员可以完全控制 URL。对于 WebForms，URL 与代码的底层文件结构相匹配。使用 MVC，您拥有所谓的“路由注册器”，它是一个将 URL 与将处理请求的资源相匹配的文件。

完全控制 URL 有两个明显的优势：

i) 如果一个项目需要人类可读的 URL 或搜索引擎优化，那么 URL 控制是一个很大的优势。考虑以下：

www.mywebapplication.com/users/alex.hardman（即检索名为 alex.hardman 的用户）

与

www.mywebapplication/users/getuser.aspx（在会话中传递的名称）或 www.mywebapplication/users/getuser.aspx?username =alex.hardman

第一个 URL（通过 MVC）更易于阅读且对搜索引擎更友好（例如，所有相同的东西都会被所有主要搜索引擎排名更高）。

ii) 完全控制 url 的第二个优势与数字人文研究数据保存的当前驱动力有关。无需赘述，数据保存的一个方面涉及“永久 url”和“唯一资源标识符”（uri）的创建。Web 表单中会话变量和视图状态的标准使用意味着同一个 url 可以引用多个数据项（其中查询参数通过视图状态输入）。结果是在这个庄园数据中访问的数据没有唯一的资源标识符（即网络上的唯一地址）。这意味着无法引用数据项，因为它在网络上没有唯一的地址，并阻止将其包含在关联数据计划和其他需要 URI 的研究计划中。

URI 和系统可以轻松返回计算机可读数据格式（如 XML（见上文））的结合使开发人员在人文数据管理和保存技术的最佳实践方面处于优势。在最近的牛津“人文研究数据库——下一步在哪里？” 研讨会非常强调使用 uri 和计算机可读数据格式管理人文研究数据。这是我们可以“出售”为对我们的研究客户明显有利的东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T11:30:07.740

查看[ASP.NET MVC 培训工具包](http://www.microsoft.com/downloads/details.aspx?FamilyID=1E0BE0B2-910A-4676-9F3A-41E4D9C0FC08&displaylang=en)。

它包括一个预先准备好的（尽管 60 分钟）演示文稿，您可以随意使用它。

它侧重于：

*   关注点分离
*   可测试性
*   控制

在这出来之前，我实际上做了类似的事情（尽管包括演示在内大约需要 45 到 60 分钟），对我们来说，关键是：

> 它使您能够重新控制 HTML 标记。

可测试性等已被充分理解，但这被视为优于标准 ASP.NET 的关键优势。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-14T14:09:37.560

你得到了各种各样的观点——我的问题是，你为什么认为你首先要使用它，你认为它将如何帮助你和你环境中的开发团队的其他成员？如果项目符号不适用于您的情况，它们将毫无用处。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T08:29:19.767

向他们解释：

1.  不再有服务器控件

2.  不再有事件机制

3.  不再有 ViewState

4.  现在他们不会使用舒适的 WebForms 并且必须学习 HTTP、HTML/CSS 和 JavaScript 的基础知识

为那些会晕倒的人准备一些药物。

(5)。现在它不是关于页面，而是关于资源（REST 模型）。URL 不会指向一个物理文件 (.aspx)，而是指向一个控制器动作，它可以返回不同类型的响应——要呈现的页面、作为 Ajax 响应的短 xml 等等。

PS 如果你有类似公司内部框架的东西，它促进了许多常见的操作，并且它是用 WebForms 构建的，你可能不会说服他们采用 MVC，因为这意味着大量的工作、思维模式的巨大变化以及可能大量的时间/成本。

编辑：对于那些要求积极点的人......

(6)。开箱即用的 SEO 友好 URL，无需第三方实用程序来重写 URL。

(7)。完全控制您的 HTML 输出。没有 ViewState 有效负载，没有注入自动生成的 ID => 干净的标记 + 更小的页面大小 => 更少的流量消耗 + 更短的响应时间。

(8)。应用程序的干净透明设计（即使是多层）的可能性。您现在可以更好地设计一个具有可理解和可跟踪数据流的体系结构，而不是在代码后面单独破解每个控件 - 从数据库层到业务逻辑，直到它到达视图。当每个控件直接进入数据库以获取一些要显示的数据时，与无处不在的 WebForms 编码风格相比要好得多。不一定是你管理一个干净的设计，但至少 MVC 概念让你现在如何正确地做它更干净。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-14T08:58:52.300

我会用路由来吸引他们的注意力，这是最明显的东西（而且它不仅限于 MVC）。然后我会查看更高级别的视图并讨论关注点分离、可测试性和可模拟性。

如果我是你，我会前往[ScottGu 的](http://weblogs.asp.net/scottgu/)博客并使用他的优秀材料:-)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-14T09:18:18.103

执行此操作的最佳方法是遵循专业 ASP.NET MVC 1.0 中的 ScottGuthries 示例章节，其中他提供了使用具有所有功能的 ASP.NET MVC 开发成熟的 Web 应用程序的演练。您可以在 20 分钟内总结该章节。

![](https://media.wiley.com/product_data/coverImage/11/04703846/0470384611.jpg)

[在此处](http://www.wrox.com/WileyCDA/Section/id-321793.html)下载 Scott Guthrie 的示例章节！

[链接文本： http](http://www.wrox.com/WileyCDA/Section/id-321793.html) ://www.wrox.com/WileyCDA/Section/id-321793.html

希望这可以帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-14T09:46:33.167

如果他们一直在使用 ASP.NET，他们可能一开始并不熟悉 MVC 体系结构，您可能不得不稍微谈一下。

由于他们都是开发人员，而您只有 15 分钟，我建议您向他们展示 File > New for ASP.NET MVC 项目并简要介绍一下脚手架。这对 MVC 来说是一个很大的卖点，因为它可以随时运行，并且您已经为迭代开发做好了准备。

之后，您可以切换到一个简单应用程序的工作演示。为此，我将使用调试器逐步完成应用程序，从 global.asax 中的路由到控制器操作以建模并最终备份到视图。这将提出有趣的问题并解释新的应用程序生命周期，包括 SoC、MVC、L2S 等。这也将隐含地突出 ASP.NET MVC 和 ASP.NET 应用程序之间的差异。

如果您有 wfetch（或 Fiddler 或 Live HTTP Headers），那么我也会显示客户端请求并突出显示视图状态的缺失并突出显示 POST/GET 动词（如果您使用 wfetch，则为 PUT/DELETE）。也许会提到这在 AJAX 应用程序中的用处。

预测有关如何迁移当前应用程序以及当前用例场景的价值主张的问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-14T10:15:10.853

15 分钟内的博客 :-)。说真的，也许专注于关注点的分离？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-14T13:20:32.373

当然首先也是最重要的是概念分离，它给出了： 1.更透明的设计，更容易理解和管理。2.约定优于配置。这加快了开发速度并减少了开发人员之间的编码/设计实践差异。3.开发模式已经融入应用程序设计本身：您开发模型，然后是控制器，然后是视图。单独更改和测试它们（可能与专门的开发人员一起）。

但是让我说，如果他们只给你 15 分钟，他们真的不想听到或使用它；）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-14T13:47:37.877

我认为，当你想展示一些新技术时，通常最好的方法是做一个简单的例子来解释一些很酷的特性。

您可以创建具有同一页面的 2 个不同视图和 2 个不同控制器的简单 mvc 应用程序示例。一个控制器可用于异步操作，第二个控制器用于正常请求。一个视图可以是普通视图，第二个视图可以是针对手机优化的视图。这是几个小时的工作，通过这个例子，你可以涵盖 asp.net mvc 的所有很酷的特性：

-路由 -可测试性 -灵活性和关注点分离

干杯

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-05-03T18:46:13.460

实际上，15 分钟不足以真正深入了解您从 MVC 中获得的任何好处。我猜与您一起工作的人最熟悉 Asp.net Web Forms。无需过多挖掘设计模式以及 MVC 为何如此出色，最容易理解的事情就是 Ajax 的易用性。

```
1\. jQuery – Ajax
2\.  Routing – SEO and No need for Custom URL rewriting 
3\.  Partial-View – showing tabular data and use server-side Ajax to sort and a client side example using jQuery 
```

大多数情况下，当我进入一直在开发 Web 表单的商店时，最常见的问题是我的控件在哪里？更具体地说，中继器或数据网格在哪里？将这种类型的演示放在一起将在 15 分钟内提供尽可能多的内容并回答更常见的问题。

# eclipse - 将 Eclipse（建模工具）中的 UML 类图映射到实际类

> ID：746745
> 
> 赞同：3
> 
> 时间：2009-04-14T08:28:30.873
> 
> 标签：eclipse, uml, reverse-engineering

我正在为 Eclipse 中的学生寻找一个“可逆向工程”的建模系统。

目前，我正在查看 Ganymede 版本中的 Eclipse 建模工具（[http://www.eclipse.org/downloads/packages/eclipse-modeling-tools-includes-incubating-components/ganymedesr2](http://www.eclipse.org/downloads/packages/eclipse-modeling-tools-includes-incubating-components/ganymedesr2)）

我对 Eclipse 中用于构建 UML 模型的 UML 建模设计表面感到满意。

但是，有谁知道如何将这些映射到代码并来回映射？

我有点被宠坏了，因为我一直在 Visual Studio 中这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-17T03:49:15.843

我不认为 Eclipse 默认提供逆向工程，但我确信像 Omondo 这样的供应商可能有（甚至是免费的）插件。

[但是我在NetBeans](http://www.netbeans.org/)（也是免费的）中看到了正向和反向工程（也适用于序列图！ ）。它看起来很实用。

# mdx - CurrentMember (MDX) 忽略切片器维度

> ID：746757
> 
> 赞同：0
> 
> 时间：2009-04-14T08:34:07.693
> 
> 标签：mdx

我在角色的 CellData 表达式中使用 CurrentMember 函数来限制通过特定维度对多维数据集的访问。这按预期工作，但有一个例外。即使使用切片器尺寸过滤掉角色无权查看的数据，字符串“#N/A”也会显示在所有单元格中。

只有在轴中包含角色限制访问的维度后，单元格的值才会按预期显示。

在我看来，CurrentMember 函数似乎忽略了切片器维度。是这样吗？我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T04:50:23.783

这取决于您如何使用过滤器进行查询。如果您正在生成子查询（使用 SSMS 或 BIDS 中的顶部过滤器区域），则 currentMember 将返回 All 成员 - 这是子查询的设计方式。如果您在 SSMS 或 BIDS 中使用较低的查询，它将使用 WHERE 子句，您应该会看到预期的结果。

如果您只是按维度成员过滤，您可能会更好地使用维度数据选项卡而不是单元格数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T13:57:52.467

严肃地说，我的建议是远离要求您使用多维数据集值限制访问的多维数据集。去过那里，这样做了，浪费了太多时间，但最终还是得到了一个不稳定的解决方案。

绝对不要在 OLAP 中使用“角色”。

# git - 在以下情况下与 git 协作的最佳实践是什么？

> ID：746758
> 
> 赞同：1
> 
> 时间：2009-04-14T08:34:07.897
> 
> 标签：git

*Bob 和 Alice 获得了对RemoteMachine*的 ssh 访问权限，他们与 ProjectA 一起工作。假设 Alice 在她的主目录中有一个 repos

```
RemoteMachine/home/alice/ProjectA 
```

而 Bob 将首先将 Alice 的 repos 克隆到（使用 --bare 可能更好）

```
RemoteMachine/home/bob/ProjectA 
```

Bob 不会直接在 RemoteMachine 中编辑 ProjectA。所以也许他想从他的远程 Repos 克隆*`RemoteMachine/home/bob/ProjectA`*到 LocalMachine（为什么不直接从 Alice 克隆 bob？也许 Alice 想直接从*`RemoteMachine/home/bob/ProjectA`*）。

```
git clone bob@RemoteMachine:/home/bob/ProjectA LocalMachine/home/bob/PrjA 
```

我的问题是：

实现这一目标的最佳做法是什么（见下文）？

*   我可以在本地编辑并推送到 RemoteMachine/home/bob 可能有：

    本地/bob/repos> git push

*   我可以在我的 LocalMachine 中运行重置命令，仍然可以反映*`RemoteMachine/home/bob`*Alice 可以从中提取

    本地/bob/repos> 重置 --hard HEAD^

*   我可以在我的 LocalMachine 中获取 Alice 更改的内容。

我不知道这些需求是否合理，所以如果您发现不合理，请提出您的需求并解释原因。如果您可以在这种情况下使用 git 命令显示工作流程，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T08:52:58.147

如果您要使用`push`，通常最好有一个从原始使用克隆的第三个存储库，`--bare`并让所有开发人员都推送到那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T01:20:32.017

你的工作流程对我来说听起来很合理。Alice 和 Bob 在 RemoteMachine 上都有自己的“可共享”存储库，并且每个人都可能从那里拉到 LocalMachine 上进行开发。当他们完成他们想要分享的内容时，他们可以将其推送到 RemoteMachine 上的存储库，在那里其他人可以看到它。我认为你遗漏的一件事是*另一件事*QA 中 Quinn 拥有的 repo。当 Alice 和/或 Bob 决定某样东西值得生产时，他们会推送到 Quinn 的仓库。Quinn 然后接受它并通过他严格的测试等运行它，最终如果它通过了，他会推出一个新包。或者，Quinn 可能是某种持续集成机器人，如 Hudson 或 CruiseControl 或其他执行自动构建和测试步骤的机器人。这个 repo，无论是 Quinn 还是 buildbot 拥有的，也可能是 Alice 和 Bob 将他们的 repos 与 pull 同步的地方*——*这是每个人开发的“规范”代码集。

就目前而言，您概述的工作流程很好。我希望这个答案有所帮助。

# ldap - 如何在 LDAP 中存储文件？

> ID：746763
> 
> 赞同：1
> 
> 时间：2009-04-14T08:37:55.627
> 
> 标签：ldap, settings

我正在寻找将配置文件存储在 LDAP 服务器中的最佳方式。我的应用程序用于将用户设置保存在 xml 文件中。用户登录已集中在 LDAP 服务器中。用户在 LDAP 服务器中存储为“inetOrgPerson”。我想将 xml 文件附加到每个用户。

最好的方法是什么？标准 LDAP 模式是否提供了一个类来存储文本文件？或者我是否应该根据自己的需要扩展架构？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T08:49:09.453

好吧，**最好**的解决方案可能是将配置值直接保存在 LDAP 模式中。LDAP 不适合存储文件或其他大型条目。

当然，您可以将整个文件作为字符串或二进制数据存储在 LDAP 目录中。但我建议您改为存储网络可访问文件的路径，并使用适当的网络文件系统来存储实际文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-11-26T23:41:51.370

在我看来，这很常见，iNetOrgPerson 条目具有用于用户图像的 jpeg 文件。语法（jpegPhot 条目）是 1.3.6.1.4.1.1466.115.121.1.25 还有二进制语法 1.3.6.1.4.1.1466.115.121.1.5 - 用于保存大部分证书的二进制语法（它们是文件）

您可能只想使用文件类定义自己的模式，并使用二进制语法。这就是我正在做的事情。

干杯，斯科特

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T09:59:34.417

抱歉，您为您的目标选择了错误的服务器。使用身份验证和目录服务器进行数据存储与为此目的使用电子邮件和日历服务器一样有意义。

此外，考虑（*在 Raymond Chen 的论点*上加上一个缺口）如果可以在 LDAP 服务器中为每个用户存储 1 个文件会发生什么。现在假设我们有两个应用程序试图保存到那个文件。因此，合乎逻辑的结论是您不能拥有一个文件，但您需要 LDAP 中的文件系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-04T11:16:00.280

据我所知，没有标准的 LDAP 模式来存储文件。最好的方法是扩展模式。只要您始终使用相同的 LDAP 服务器并且允许您配置它/它们，这应该不是问题。如果您有不同的服务器（OpenLDAP、ApacheDS、...），您必须学习如何为每个服务器执行此操作。

# apache-flex - ALT+ 快捷键发出“哔”声

> ID：746764
> 
> 赞同：1
> 
> 时间：2009-04-14T08:38:58.573
> 
> 标签：apache-flex, keyboard-shortcuts, air

我正在努力使用 air flex 应用程序。每当我单击`Alt`+ 某些东西时，vista 都会发出声音。我怀疑它与不存在的菜单栏有关。

任何想法如何禁用我的应用程序响应涉及 alt 的快捷方式？

这是代码：

```
stage.addEventListener(KeyboardEvent.KEY_UP, onKeyUp);
...
            public function onKeyUp(event:KeyboardEvent):void {
                trace("inside onKeyUp");

                if (event.altKey) {
                    if (event.keyCode == 69 /* E */) {
                        detailsBtn.dispatchEvent(new MouseEvent(MouseEvent.CLICK, true));
                    } else if (event.keyCode == 65 /* A */) {
                        andmevahetusBtn.dispatchEvent(new MouseEvent(MouseEvent.CLICK, true));
                    } else if (event.keyCode == 83 /* S */) {
                        Application.application.close();
                    } else {
                        trace("Key pressed. keyCode: " + event.keyCode + ", charCode: " + event.charCode);
                    }
                }
            } 
```

我尝试了一切：

```
event.preventDefault();
event.stopPropagation();
event.stopImmediatePropagation(); 
```

没有任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-09T06:29:37.807

It might be the operating system catching the key press, and responding to it. In which case, attempting to stop the key event inside your application won't matter.

Event processing in Flex/Flash apps does not affect Windows event processing. Stopping keypress propagation in Actionscript can only affect your app, not the operating system.

You could try two things:

*   Find why Windows is beeping due to `Alt` keypresses (might be because of an international keyboard layout, accessibility options, or who knows what), or
*   Although it doesn't quite fit your design, switch from `Alt` + `X` keypresses to `Ctrl` + `X` keypresses?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-04T11:41:28.360

尝试在 onkeypress 事件中将键码设置为 0（如果您之后不使用它）。

# c# - 如何在 vb.net 中实现值类型的 C#'as' 关键字？

> ID：746767
> 
> 赞同：12
> 
> 时间：2009-04-14T08:41:51.577
> 
> 标签：c#, .net, vb.net

我们的大部分开发都是在 vb.net 中完成的（不是我的选择），一个常用的代码模式使用“On Error GoTo”后跟“Resume Next”，这样所有数据库字段都可以使用 DirectCast() 和任何DBNull 值被忽略。

当前的代码是

```
On Error GoTo error_code
oObject.Name = DirectCast(oReader.Item("Name"), String)
oObject.Value = DirectCast(oReader.Item("Value"), Integer)
error_code:
Resume Next 
```

替换此的 C# 代码启用删除 On Error 代码将是

```
oObject.Name = oReader["Name"] as string ?? string.Empty;
oObject.Value = oReader["Value"] as int? ?? -1; 
```

问题是此 C# 代码的 vb.net 等效使用 TryCast() 只能用于引用类型（可空类型是值类型），而 C# as 关键字可用于引用和可空类型。

所以总而言之，有没有人有一个 vb.net 代码的例子，它在每个数据库字段的一行中与 C# 代码做同样的事情？

-编辑-

我已经决定了我认为在我们的案例中最好的解决方案。辅助方法不合适（由于管理），我们不能有扩展方法，因为我们只使用 .NET 2.0（尽管使用 VS 2008，所以我们得到了 If()）

```
oObject.Name = If(oReader.IsDBNull(oReader.GetOrdinal("Name")), String.Empty, oReader.GetString(oReader.GetOrdinal("Name")))
oObject.Value = If(oReader.IsDBNull(oReader.GetOrdinal("Value")), 0, oReader.GetInt32(oReader.GetOrdinal("Value"))) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-14T09:48:07.813

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T09:07:08.397

在 VB 9.0 中，“IF”是一个真正的合并操作，相当于 C# 的“??”。来源[MSDN](http://msdn.microsoft.com/en-us/library/2hxce09y.aspx "运营商")：

所以你可以使用：

```
oObject.Name = IF(oReader.Item("Name").Equals(DBNull.Value),string.Empty,DirectCast(oReader.Item("Name"), String)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T09:17:53.113

使用该`IsDbNull`方法来检查空值，而不是使用昂贵的 try-fail-handlefailure 方法。错误处理几乎总是比在条件变为错误之前捕获条件更昂贵。

（另外，错误处理应该使用异常，而不是 VB6 风格的 ON ERROR GOTO HELL...）

`If`使用看起来像这样的单行条件函数：

```
oObject.Name = If(oReader.IsDbNull(oReader.GetOrdinal("Name")), Nothing, oReader.GetString(oReader.GetOrdinal("Name"))) 
```

我更愿意编写一些帮助函数来使代码更具可读性和效率：

```
Function GetStringOrDefault(reader As DbDataReader, key As String) As String
   Dim ordinal = reader.GetOrdinal(key)
   If reader.IsDbNull(ordinal) Then
      Return Nothing
   Else
      Return reader.GetString(ordinal)
   End If
End Function 
```

用法：

```
oObject.Name = GetStringOrDefault(oReader, "Name") 
```

您也可以将它们编写为`DbDataReader`类的扩展，以使它们更具可读性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T09:02:30.293

我不认为 VB.NET 有任何模仿`??`C# 运算符功能的运算符。但是，您可以使用相当于 C# 的三元运算符 -在您的情况下[的 IIF 函数](http://msdn.microsoft.com/en-us/library/27ydhh0d(VS.80,loband).aspx)：

诚然丑陋：

```
oObject.Name = IIf(oReader.Item("Name").Equals(DBNull.Value), DirectCast(oReader.Item("Name"), String), String.Empty)
oObject.Value = IIf(oReader.Item("Value").Equals(DBNull.Value), DirectCast(oReader.Item("Value"), Integer), -1) 
```

请务必阅读我在上面提供的链接中的 Stephen Weatherford 的帖子，该帖子建议使用通用 IIf 函数从提供的参数推断类型要求。这变得很有必要，因为 IIf 函数总是返回一个对象！

更好的选择是创建一个有条件地执行此转换的函数，而不是尝试在一行中执行此操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T10:34:50.930

Everyone has added some valid points to this discussion so I thought I'd summarise the important points.

1.  VB.net TryCast() is **NOT** the same as the C# as keyword. If it was the same then there would have been no need for this question in the first place.

2.  VB.net uses the If() function for ternary operations and null coalescing operations. This is not as easy to read as the C# version (? and ?? respectivly). Try to avoid the vb.net IIf() function as this is not the same.

3.  The null coalescing code pattern does not work as we cannot use the TryCast() with nullable types so we have to use the terniary pattern.

4.  oReader.IsDBNull(oReader.GetOrdinal("Name")) is the best way to check if a value is DBNull.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T09:18:53.810

根据文档 TryCast 仅适用于引用类型。无论如何，问题可能更多在于您使用 IDataReader 而不是 trycast。

在遍历 IDataReader 中的行之前，获取列名的序数值并使用强类型 GetX 方法来检索字段值，如下所示

```
Dim name As Integer = oReader.GetOrdinal("Name")
Dim value as Integer = oReader.GetOrdinal("Value")

While reader.Read()
  oObject.Name = if(oReader.IsDbNull(name), string.Empty, oReader.GetString(name))
  oObject.Value = if(oReader.IsDbNull(value), -1, oReader.GetInt32(value)
End While

' Call Close when done reading.
oReader.Close() 
```

使用带有 3 个参数的 if 运算符使其像 C# 三元布尔运算符 eval?trueExpression:falseExpression 一样工作

这应该可以帮助您解决问题。

# msbuild - MSBuild 递归复制与 %(ConfigurationToBuild.PlatformToBuild)

> ID：746768
> 
> 赞同：1
> 
> 时间：2009-04-14T08:43:00.077
> 
> 标签：msbuild, recursion, copy

我有以下任务，由于 DestinationFiles 和 DestionationFolder 的组合不起作用，但它抓住了我想要做的概念：

```
<CreateItem Include="$(Destination)\**\*.Generated.*.*">
  <Output TaskParameter="Include" ItemName="GeneratedFiles" />
</CreateItem>

<Copy Condition=" '%(ConfigurationToBuild.FlavorToBuild)'=='Debug-All' Or '%(ConfigurationToBuild.FlavorToBuild)'=='Release-WebService' "
      SourceFiles="@(GeneratedFiles)"
      DestinationFiles="@(GeneratedFiles-&gt;'%(RecursiveDir)%(Filename)%(Extension)')"
      DestinationFolder="$(BinariesRoot)\%(ConfigurationToBuild.PlatformToBuild)\%(ConfigurationToBuild.FlavorToBuild)"
/> 
```

所以我有一组正在生成的文件（数据，而不是代码），这些文件需要复制到最终的二进制文件位置。

在这个构建中，我一次构建了 3 个配置：一个 Debug-All 版本、一个 Release-Client 版本和一个 Release-WebService。原因是保持相同的内部版本号和完全相同的代码库，同时让客户端和 WebService 项目“发布”，然后由安装项目选择。

如果我尝试使用： DestinationFiles="@(GeneratedFiles->'$(BinariesRoot)\%(ConfigurationToBuild.PlatformToBuild)\%(ConfigurationToBuild.FlavorToBuild)\%(RecursiveDir)%(Filename)%(Extension)')"

MSBuild 在 %(ConfigurationToBuild.FlavorToBuild) 部分引发错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T13:25:35.497

我找到了解决此问题的方法：即手动复制命令。所以它不那么通用并且在构建日志文件中产生更多的噪音，但至少它有效！

```
<!-- Copy the updated files to the Binariesroot to have them picked up by the Setups -->
<CreateItem Include="$(Destination)\**\*.Generated.*.sql">
  <Output TaskParameter="Include" ItemName="GeneratedSqlFiles" />
</CreateItem>
<Message Text="GeneratedSqlFiles=@(GeneratedSqlFiles)->RecursiveDir=%(RecursiveDir) Filename=%(Filename)%(Extension)" />

<CreateProperty Condition=" '%(ConfigurationToBuild.FlavorToBuild)'=='Debug'" 
                Value="$(BinariesRoot)\%(ConfigurationToBuild.PlatformToBuild)\%(ConfigurationToBuild.FlavorToBuild)" >
  <Output TaskParameter="Value" PropertyName="RealBinariesRoot" />
</CreateProperty>
<Copy Condition=" '%(ConfigurationToBuild.FlavorToBuild)'=='Debug'"
      SourceFiles="@(GeneratedSqlFiles)"
      DestinationFiles="@(GeneratedSqlFiles->'$(RealBinariesRoot)\Deployment\%(RecursiveDir)%(Filename)%(Extension)')"
/>
<CreateProperty Condition=" '%(ConfigurationToBuild.FlavorToBuild)'=='WebService'"
            Value="$(BinariesRoot)\%(ConfigurationToBuild.PlatformToBuild)\%(ConfigurationToBuild.FlavorToBuild)" >
  <Output TaskParameter="Value" PropertyName="RealBinariesRoot" />
</CreateProperty>
<Copy Condition=" '%(ConfigurationToBuild.FlavorToBuild)'=='WebService'"
      SourceFiles="@(GeneratedSqlFiles)"
      DestinationFiles="@(GeneratedSqlFiles->'$(RealBinariesRoot)\Deployment\%(RecursiveDir)%(Filename)%(Extension)')"
/> 
```

同时发现如果你有一个'.' 在 CreateItem 任务的 Include 路径中，不再填写 RecursiveDir 属性。所以有

'drive:\somefolder\subfolder\Sources\Generated***.Generated.*.sql' 将提供 %(RecursiveDir) 元数据。使用

'drive:\somefolder\subfolder\.\Sources\Generated***.Generated.*.sql'，解析为与上述相同的路径将**不**提供 %(RecursiveDir) 元数据。（注意子文件夹和 Sources 之间微妙的“.”）

当然（墨菲定律）我们使用它来指定需要构建哪个分支，使用 . 指向主分支;-)

# python - 基本的蟒蛇。关于调用函数的快速问题

> ID：746774
> 
> 赞同：0
> 
> 时间：2009-04-14T08:45:40.833
> 
> 标签：python

我在 python 中有一个基本问题，我会很高兴得到一些帮助:-)

我有两个功能。一种将文本文件转换为字典的方法。还有一个将句子分成单独的单词：

（这是函数doc.txt）

```
def autoparts():

    list_of_parts= open('list_of_parts.txt', 'r')
    for line in list_of_parts:
        k, v= line.split()
        list1.append(k)
        list2.append(v)

    dictionary = dict(zip(k, v))

def splittext(text):
    words = text.split()

    print words 
```

现在我想制作一个使用这两个功能的程序。

（这是程序.txt）

```
from functiondoc import *

# A and B are keys in the dict. The values are 'rear_bumper' 'back_seat'
text = 'A B'    # Input

# Splits the input into separate strings.
input_ = split_line(text) 
```

这是我无法正确处理的部分。我需要使用该`autoparts`函数来输出值 ( `rear_bumper back_seat`)，但我不确定如何调用该函数，所以它会这样做。我不认为这很难。但我想不通...

亲切的问候，

钍

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T08:50:01.137

一些快速要点：

*   您不应将 Python 源文件命名为“.txt”，而应使用“.py”。
*   您的缩进看起来不对，但这可能只是 Stack Overflow。
*   您需要调用该`autoparts()`函数来设置字典。
*   该`autoparts()`函数可能应该返回字典，以使其可供其他代码使用。
*   `open`输入文本文件时，应使用模式`t`说明符。在某些平台上，较低级别的 I/O 代码必须知道它正在读取文本，因此您需要告诉它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T14:27:04.430

正如人们指出的那样，您需要使用`py`python 源文件的扩展名。您的文件将成为“functiondoc.py”和“program.py”。这将使您的`import functiondoc`工作正常（只要它们在同一目录中）

该`autoparts`函数的最大问题是您从未返回任何内容。另一个大问题是您使用了错误的变量..

```
for line in list_of_parts:
    k, v = line.split()
    list1.append(k)
    list2.append(v)

# k and v are now the last line split up, *not* the list you've been constructing.
# The following incorrect line:
dictionary = dict(zip(k, v))
# ...should be:
dictionary = dict(zip(list1, list2))
# ..although you shouldn't use zip for this: 
```

您几乎*不必*使用`zip`，有时它可能很有用，但是对于创建简单的字典，这是不正确的.. 而不是做..

```
for line in list_of_parts:
    ...
dictionary = dict(zip(k, v)) 
```

..只需在循环之前创建一个空字典，然后执行 mydict[key_variable] = value_variable

例如，我可能如何编写函数..

```
def autoparts():
    # open() returns a file object, not the contents of the file,
    # you need to use .read() or .readlines() to get the actual text
    input_file = open('list_of_parts.txt', 'r')
    all_lines = input_file.read_lines() # reads files as a list (one index per line)

    mydict = {} # initialise a empty dictionary

    for line in list_of_parts:
        k, v = line.split()
        mydict[k] = v

    return mydict # you have to explicitly return stuff, or it returns None 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T09:21:19.983

除了所有其他提示和技巧之外，我认为您还遗漏了一些重要的东西：您的函数实际上需要*返回*一些东西。

当您创建`autoparts()`or`splittext()`时，想法是这将是一个您可以调用的函数，并且它可以（并且应该）回馈一些东西。

一旦确定了希望函数具有的输出，就需要将其放入`return`语句中。

例如，如果您想`splittext`返回单词列表，而不是打印它们，则需要行`return words`. 如果你希望你`autoparts`返回你建立的字典，你会使用`return dictionary`.

更准确地说（并在下面回答您的评论/问题）：您不想“返回制作字典的函数”；您想在函数内部返回字典。因此，函数的最后一行应该是`return dictionary`（在函数内部！）参见，例如，上面 dbr 的（已接受！）解决方案。

我认为你需要回到开头，阅读一本关于 Python 和一般编程的书或网站，因为你对某些概念有些生疏。一个好的（当然还有其他的）是[http://diveintopython3.ep.io/](http://diveintopython3.ep.io/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T08:58:36.887

不要先创建列表，直接去字典：

```
parts_dict={}
list_of_parts = open('list_of_parts.txt', 'r')
for line in list_of_parts:
        k, v = line.split()
        parts_dict[k] = v 
```

另外，这些键是唯一的吗？因为如果不是，某些值将被覆盖。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T09:38:21.550

到目前为止，您编写的内容存在很多问题，但您的问题是如何调用汽车零件功能。就是这样; 首先，将您的文件重命名为 functiondocs.py 和 program.py - 它们是 python，所以将它们设为 python 文件。

接下来，要调用 autoparts 函数，您只需将主程序列表从以下位置更改：

```
from functiondoc import *

# A and B are keys in the dict. The values are 'rear_bumper' 'back_seat'
text = 'A B'    # Input

# Splits the input into separate strings.
input_ = split_line(text) 
```

到：

```
from functiondoc import *

# Call the autparts function
autoparts() 
```

在我看来，看起来你是在要求我们做 CS 作业……但也许我只是愤世嫉俗 ;-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T13:06:47.180

这是您可以执行此操作的最简单方法：

```
def filetodict(filename):
    return dict(line.split() for line in open(filename))

parts = filetodict("list_of_parts.txt")
print parts 
```

这是输出：

```
{'a': 'apple', 'c': 'cheese', 'b': 'bacon', 'e': 'egg', 'd': 'donut'} 
```

文件内容：

```
a apple
b bacon
c cheese
d donut
e egg 
```

# .net - 如何扩展 VisualStudio 表单设计器

> ID：746775
> 
> 赞同：2
> 
> 时间：2009-04-14T08:46:14.857
> 
> 标签：.net, visual-studio, winforms, add-in

我想为 VisualStudio 表单设计器编写一个扩展，它会自动更正控件的某些属性：

更具体地说，我希望能够选择 a `TableLayoutPanel`，调用一些命令（菜单、宏、动词等）并以某种方式调整包含的控件的`AutoSize`、`Anchor`、`Margin`等`Padding`属性（取决于控件的类型，网格中的位置等）。

MSDN 中关于 VS 的自动化和可扩展性的文档似乎非常全面，但我找不到关于扩展表单设计器的主题。

我将不胜感激有关如何“从外部”查询/操作表单设计器中的控件的任何建议（我知道我可以派生自己的控件并为它们实现自定义设计器，但我宁愿避免这种情况...）

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T07:54:50.167

好的，我终于找到了有关该主题的一些资源：

*   [有关 Visual Studio .NET 可扩展性的资源](http://www.mztools.com/resources_vsnet_addins.aspx)
*   [HOWTO：从 Visual Studio .NET 插件操作 Windows 窗体的控件](http://www.mztools.com/articles/2005/MZ2005001.aspx)

我想，我会继续这些……

# c# - 访问另一个 c# 项目中的 excel 资源

> ID：746782
> 
> 赞同：1
> 
> 时间：2009-04-14T08:49:19.437
> 
> 标签：c#, excel, resources

我正在使用 c# (visual studio 2008) 尝试访问 Excel 电子表格中的业务逻辑。

我有以下课程..（如果我做错了，请随时批评 - 我通常是 java 开发人员 - 这是我的第一个 c# 应用程序。）

```
public class SpreadSheetClass
{
    // apologies for any typo's code written in place, not copied from an IDE...
    //
    public DataTable DoIt()
    {
        DataTable result;
        String sConnection = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=MySpreadsheet.xls;Extended Properties=Excel 8.0;";

        OleDbConnection connection = new OleDbConnection(sConnection);
        try
        {
            connection.Open();
            OleDbCommand oleDbcCommand = new OleDbCommand("SELECT * FROM SELECTION", connection); 
            OleDbDataAdapter dataAdapter = new OleDbDataAdapter();
            dataAdapter.SelectCommand = oleDbcCommand;    
            result = new DataTable();
            dataAdapter.Fill(result);
        }
        finally
        {
            connection.Close();
        }
        return result;
    }
} 
```

我使用 Add -> Existing Item -> 将电子表格添加到项目中，然后选择 .xls 文件。然后我编辑了文件的属性，说它是一个嵌入式资源，并总是将它复制到输出目录。

我可以从项目中访问电子表格。

但是，我想从项目外部运行 DoIt 方法，例如从测试项目，我得到以下异常：

“测试方法 TestProject1.UnitTest1.TestMethod1 抛出异常：System.Data.OleDb.OleDbException：Microsoft Jet 数据库引擎找不到对象 'SELECTION'。确保对象存在并且正确拼写其名称和路径名称。 。”

我确信我的问题与调用一个从另一个项目访问资源的类有关。

帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T09:08:08.550

在 .NET 中（特别是在 C# 中）最好“包装”`IDisposable`在`using`语句中实现的类：

```
using(OleDbConnection connection = new OleDbConnection(sConnection))
{
    // ...
} 
```

您基本上要做的是从程序集中提取资源（请参阅 参考资料`Assembly.GetManifestResourceStream()`），将其保存到磁盘上，然后适当地更改连接字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T09:48:21.883

> 我使用 Add -> Existing Item -> 将电子表格添加到项目中，然后选择 .xls 文件。然后我编辑了文件的属性，说它是一个嵌入式资源，并总是将它复制到输出目录。
> 
> 我可以从项目中访问电子表格。

您将另一个程序作为程序集打开，然后从中加载资源。

就像是：

```
Assembly other = Assembly.Load(name);
Stream xlsData = other.GetManifestResourceStream(resourceName); 
```

# asp.net - 有没有办法在 VS 2008 中将现有项目类型从 ASP.NET Web 应用程序更改为 ASP.NET MVC 应用程序？

> ID：746785
> 
> 赞同：1
> 
> 时间：2009-04-14T08:51:27.467
> 
> 标签：asp.net, asp.net-mvc, visual-studio-2008

因此，Visual Studio 在上下文菜单中为“添加视图”等提供 MVC 内容......

当然，我可以创建一个新的 MVC Web 应用程序项目类型并将文件从非 MVC 移动到那里，但是有没有办法在不执行该步骤的情况下更改项目类型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T08:55:54.273

您是指某种将 Web 表单应用程序转换为 MVC 的向导或工具吗？不，VS 中没有这样的工具。恐怕很难做到，因为架构完全不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T08:56:41.993

我知道没有转换工具，但使用文本编辑器应该相当简单。创建一个新的 MVC Web 应用程序。在文本编辑器中打开这两个项目文件，并将旧项目中的一组文件条目复制到新项目中。当然，不要覆盖新文件将为您创建的现有文件条目。

尽管将两者都包含在同一个应用程序中，但这会有点混乱。您必须小心路由配置。

# c# - 无法添加安全 Web 服务作为对 VS2005 项目的引用

> ID：746792
> 
> 赞同：0
> 
> 时间：2009-04-14T08:53:41.877
> 
> 标签：c#, web-services

我正在尝试将安全 Web 服务添加到 (C#) 项目作为参考，但 VS 出现以下错误：

> 无法将类型为“System.__ComObject”的 COM 对象转换为接口类型“EnvDTE.IVsExtensibility”。此操作失败，因为 IID 为“{3C536122-57B1-46DE-AB34-ACC524140093}”的接口的 COM 组件上的 QueryInterface 调用因以下错误而失败：不支持此类接口（来自 HRESULT 的异常：0x80004002 (E_NOINTERFACE)） .

有人知道这是为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T21:10:36.563

[在这里](http://www.eggheadcafe.com/aspnet_answers/vsnetide/Aug2006/post27642224.asp)找到以下诊断。最初由 Steven Cheng 回答。希望这可以帮助。

**问题描述：**

当尝试使用 Visual Studio 2005 中的“添加 Web 引用”功能针对同一 Web 服务应用程序中的多个 Web 服务端点（asmx 文件）创建 Web 服务客户端代理时。如果 Web 服务应用程序受到客户端身份验证的保护，客户端身份验证会提示客户端输入凭据，IDE 将报告以下异常：

“无法将“System.__ComObject”类型的 COM 对象转换为接口类型“EnvDTE.IVsExtensibility”。此操作失败，因为对具有 IID 的接口的 COM 组件的 QueryInterface 调用“{3C536122-57B1-46DE-AB34-ACC524140093} ' 由于以下错误而失败：不支持此类接口（HRESULT 异常：0x80004002 (E_NOINTERFACE)）。

**原因：**

这是一个纯 Visual Studio 2005 特定问题，内部设计时 COM 对象在处理将提示输入客户端凭据的服务端点时存在问题。

**目前的工作：**

1.  在外部网络浏览器中访问服务描述/WSDL 文档并将 WSDL 文档保存到本地文件系统。并针对 Visual Studio 2005 中本地保存的 WSDL 文档添加 Web 引用。

2.  使用 .net 框架中的 WSDL.exe 命令实用程序在外部创建 Web 服务客户端代理。

# jquery - 带有多个列表的 jQuery UI、可排序和 Cookie 插件

> ID：746800
> 
> 赞同：1
> 
> 时间：2009-04-14T08:56:06.813
> 
> 标签：jquery, jquery-ui, cookies, jquery-ui-sortable

我正在使用带有 cookie 插件的 jQuery UI 可排序插件来设置和获取两个可排序列表的列表。

我找到了这段代码来设置和获取 cookie：[http ://www.shopdev.co.uk/blog/sortable-lists-using-jquery-ui/#comment-6441](http://www.shopdev.co.uk/blog/sortable-lists-using-jquery-ui/#comment-6441)

它可以像我想要的那样工作一个列表，但不是两个（我已经在评论中列出了更改，但在某处失败了）。

我的猜测是我必须为 setSelector 指定第一个和第二个列表，而不是为列表使用一个类。我试过 "var setSelector = "#first, #second"; 但这并没有。

想法？

谢谢

$（函数（）{

```
// set the list selector
var setSelector = ".sortable";
// set the cookie name
var setCookieName = "listOrder";
// set the cookie expiry time (days):
var setCookieExpiry = 7;

// function that writes the list order to a cookie
function getOrder() {
    // save custom order to cookie
    $.cookie(setCookieName, $(setSelector).sortable("toArray"), { expires: setCookieExpiry, path: "/" });
}

// function that restores the list order from a cookie
function restoreOrder() {
    var list = $(setSelector);
    if (list == null) return

    // fetch the cookie value (saved order)
    var cookie = $.cookie(setCookieName);
    if (!cookie) return;

    // make array from saved order
    var IDs = cookie.split(",");

    // fetch current order
    var items = list.sortable("toArray");

    // make array from current order
    var rebuild = new Array();
    for ( var v=0, len=items.length; v<len; v++ ){
        rebuild[items[v]] = items[v];
    }

    for (var i = 0, n = IDs.length; i < n; i++) {

        // item id from saved order
        var itemID = IDs[i];

        if (itemID in rebuild) {

            // select item id from current order
            var item = rebuild[itemID];

            // select the item according to current order
            var child = $("ul" + setSelector + ".ui-sortable").children("#" + item);

            // select the item according to the saved order
            var savedOrd = $("ul" + setSelector + ".ui-sortable").children("#" + itemID);

            // remove all the items
            child.remove();

            // add the items in turn according to saved order
            // we need to filter here since the "ui-sortable"
            // class is applied to all ul elements and we
            // only want the very first!  You can modify this
            // to support multiple lists - not tested!
            $("ul" + setSelector + ".ui-sortable").filter(":first").append(savedOrd);

        }
    }
}

// code executed when the document loads
$(function() {
    // here, we allow the user to sort the items
    $(setSelector).sortable({
        cursor: 'move',
        items: 'li',
        //axis: "y",
        opacity: 0.6,
        //revert: true,
        scroll: true,
        scrollSensitivity: 40,
        placeholder: 'highlight',
        update: function() { getOrder(); }
    });

    // here, we reload the saved order
    restoreOrder();
}); 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-07T07:37:26.937

_http://code.google.com/p/cookies/

_http://noteskeeper.ru/article/save-state-jquery-ui-sortable/

```
 root = $("#sidebar");
     $('> *', root).each(function (index) {
      this.id = 'block-' + index;
     });
     root.sortable({
      cursor: 'move',
      revert: true,
      placeholder: 'ui-state-highlight'
     });

     // function that writes the list order to a cookie
     root.bind( "sortupdate", function (event, ui) {
      // save custom order to cookie
            var order = $(this).sortable('serialize');
            $.cookies.set('sortable', order);
        });

     // here, we reload the saved order
     // fetch the cookie value (saved order)
     var c = $.cookies.get('sortable');
     if (c) {
      // function that restores the list order from a cookie
      $.each(c.split('&'), function () {
       var id = this.replace('[]=', '-');
       $('#' + id).appendTo(root);
      });
     } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T14:56:11.287

你应该替换代码

`var setSelector = ".sortable";`

至

`var setSelector = "#sortable";`

# silverlight - Silverlight：删除网格中特定单元格的内容

> ID：746802
> 
> 赞同：4
> 
> 时间：2009-04-14T08:56:27.500
> 
> 标签：silverlight, grid

我有一个网格，我需要动态替换驻留在其中一个单元格中的控件。我不知道精确定位网格单元格的语法，我在哪里输入行号和列号，这样我就可以删除其中的任何内容。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-15T02:15:15.037

如果您知道控件所在的单元格和行，则可以使用 LINQ 语句来获取它。

这是一个 LINQ 语句，它将获取第 3 列第 4 行中的第一个控件。

```
var control = (from d in grid.Children
               where Grid.GetColumn(d as FrameworkElement) == 3 
                  && Grid.GetRow(d as FrameworkElement) == 4
               select d).FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T12:11:59.090

您可以使用 Grid.GetRow 和 Grid.GetColumn 方法迭代网格的子项检查其行和列值，并在值匹配时替换目标内容。这是在 WPF 中测试的示例，但应该在 Silverlight 中工作：

```
 <Grid x:Name="SampleGrid">
    <Grid.RowDefinitions>
        <RowDefinition />
        <RowDefinition />
        <RowDefinition />
        <RowDefinition />
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition />
        <ColumnDefinition />
        <ColumnDefinition />
    </Grid.ColumnDefinitions>
    <Rectangle Fill="Red" Width="20" Height="20" Grid.Row="0" Grid.Column="0" />
    <Rectangle Fill="Orange" Width="20" Height="20" Grid.Row="0" Grid.Column="1" />
    <Rectangle Fill="Yellow" Width="20" Height="20" Grid.Row="0" Grid.Column="2" />
    <Rectangle Fill="Green" Width="20" Height="20" Grid.Row="1" Grid.Column="0" />
    <Rectangle Fill="Blue" Width="20" Height="20" Grid.Row="1" Grid.Column="1" />
    <Rectangle Fill="Indigo" Width="20" Height="20" Grid.Row="1" Grid.Column="2" />
    <Rectangle Fill="Violet" Width="20" Height="20" Grid.Row="2" Grid.Column="0" />
    <Rectangle Fill="Black" Width="20" Height="20" Grid.Row="2" Grid.Column="1" />
    <Rectangle Fill="Gray" Width="20" Height="20" Grid.Row="2" Grid.Column="2" />
    <Button Grid.Row="3" Grid.ColumnSpan="3" Margin="10" x:Name="Swap" Click="Swap_Click" Content="Swap"/>
</Grid> 
```

在事件处理程序中：

```
 private void Swap_Click(object sender, RoutedEventArgs e)
    {
        Ellipse newEllipse = new Ellipse() { Fill = new SolidColorBrush(Colors.PaleGoldenrod), Width = 20d, Height = 20d };
        for (int childIndex = 0; childIndex < this.SampleGrid.Children.Count; childIndex++)
        {
            UIElement child = this.SampleGrid.Children[childIndex];
            if (Grid.GetColumn(child) == 2 && Grid.GetRow(child) == 2)
            {
                this.SampleGrid.Children.Remove(child);
                Grid.SetRow(newEllipse, 2);
                Grid.SetColumn(newEllipse, 2);
                this.SampleGrid.Children.Add(newEllipse);
            }
        }

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-16T23:14:49.993

你可以记住我在网格中添加了一个私有变量的控制：

```
private Control controlCentral = null; 
```

接下来，将添加到网格的控件分配给此变量，以便您可以使用 Remove 删除网格的控件。

下面的代码替换了第 0 行第 1 列的控件：

```
private void MostrarControlCentral(Control control)
    {
        if (control != null)
        {
            control.SetValue(Grid.RowProperty, 0);
            control.SetValue(Grid.ColumnProperty, 1);
        }

        this.LayoutRoot.Children.Remove(this.controlCentral);
        if (control != null)
        {
            this.LayoutRoot.Children.Add(control);
        }
        this.controlCentral=control;
    } 
```

# php - 使用php邮件功能防止发送的电子邮件被视为垃圾邮件

> ID：746809
> 
> 赞同：13
> 
> 时间：2009-04-14T08:57:25.500
> 
> 标签：php, header, email, email-spam

我写了一个 PHP 脚本来发送电子邮件。

我的脚本是这样的：

```
$headers =  'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
$headers .= 'From: abc@yahoo.com' . "\r\n";

// Email Variables
$toUser  = "someone@yahoo.com"; // recipient
$subject = "testing"; // subject
$body    = "<html><body><p>
             Example of including an image via html \<img\> tag:
             <br>
             <img src='../images/profile.jpg'>
             <br>
             My new picture
             <br></p></body></html>"; // content

if (mail($toUser,$subject,$body,$headers)) {
    echo "sent";
} else {
    echo "failed";
} 
```

好吧，我当然使用有效的电子邮件地址作为发件人和收件人。我确实收到了电子邮件，但它进入了垃圾邮件。所以我去谷歌研究。是因为我的“标题”脚本问题吗？如果不是，那么是什么导致我的脚本发送垃圾邮件？有什么解决办法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-22T06:57:18.990

请试试这个：

```
$headers ="From:<$from>\n";
$headers.="MIME-Version: 1.0\n";
$headers.="Content-type: text/html; charset=iso 8859-1";

mail($to,$subject,$body,$headers,"-f$from"); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-14T09:06:02.390

问题可能在于 yahoo 使用[域密钥](http://en.wikipedia.org/wiki/DomainKeys)验证，由于邮件实际上并非来自 yahoo 的服务器，因此您的应用程序可能会失败。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-14T09:10:02.087

当我曾经遇到过类似的问题时，我查看了标题，发现我的主机使用 SpamAssassin。所以我在谷歌上搜索了“SpamAssassin score”，发现了大量关于如何错误地（从而正确地）形成电子邮件的信息。

例如：[SpamAssassin 得分列表](http://spamassassin.apache.org/tests_3_2_x.html)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-14T15:31:47.317

**1.查看邮件内容**

正如其他人暗示的那样，它可能被标记为垃圾邮件，因为您的邮件看起来像垃圾邮件。

我不确定您发布的脚本是否是您正在测试的实际脚本。

如果它具有实际的邮件正文和标头，则通过 SpamAssassin 的标准安装运行此邮件会给它 4.9 的垃圾邮件分数

```
X-垃圾邮件状态：否，分数=4.9 要求=5.0 测试=BAYES_50，HTML_IMAGE_ONLY_04，
        HTML_MESSAGE,MIME_HTML_ONLY,NO_DNS_FOR_FROM,NO_RELAYS autolearn=no
        版本=3.2.5

```

由于电子邮件正文只有 HTML，因此它更有可能被大多数反垃圾邮件解决方案处理为可疑。

**2.邮件服务器的IP**

另一个值得检查的方面是您的邮件服务器的 IP 地址。任何源自动态 IP 地址的邮件都可能被视为垃圾邮件。

**3\. 黑名单**

还要检查您的 IP 地址是否列在阻止列表之一中。首先，请通过[http://www.spamhaus.org/lookup.lasso](http://www.spamhaus.org/lookup.lasso)检查您的 IP 地址。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-07-16T14:05:04.190

使用[mxtoolbox.com](http://mxtoolbox.com/)检查服务器 IP 是否被列入黑名单。该网站还可以帮助您进行一些与电子邮件相关的检查。

当然，在垃圾邮件过滤器中运行的检查清单很长。如前所述，检查电子邮件标题以获取有关垃圾邮件过滤器评级的详细信息。

希望有帮助！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-04T12:30:25.860

我遇到了同样的问题：

问题是，当您在“发件人：”部分之前指定内容类型时，邮件会作为垃圾邮件出现。

但是，如果您在内容部分之前指定“发件人：”，它会像普通邮件一样发送，让您微笑和好奇。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-11-07T06:37:36.677

```
 **This Works Perfectly fine for me**     
                        $to="reciever@reciever.com";
                        $subject="This is Your Message";
                        $from = 'Sender <noreply@sender.com>';
                        $body='Hi '.$name.', <br/><br>Now You can See Yor main in inbox';
                        $headers = "From: " .($from) . "\r\n";
                        $headers .= "Reply-To: ".($from) . "\r\n";
                        $headers .= "Return-Path: ".($from) . "\r\n";;
                        $headers .= "MIME-Version: 1.0\r\n";
                        $headers .= "Content-Type: text/html; charset=ISO-8859-1\r\n";
                        $headers .= "X-Priority: 3\r\n";
                        $headers .= "X-Mailer: PHP". phpversion() ."\r\n";
                        mail($to,$subject,$body,$headers); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-14T09:22:55.893

正如 schnalle 所说，一个问题肯定是您用于发送电子邮件的 smtp 服务器与您指定为 From 的服务器不同。. from 的域应该与您运行的服务器相同。

因此，您可以使用 yahoo 服务器发送电子邮件（检查他们是否允许 smtp 远程连接，但我猜他们允许）通过 smtp 连接，这将解决 1 个问题。

另一个是没有替代纯文本内容的 html 内容，但是，这个不太重要。

我建议你[使用 phpMailer](http://phpmailer.codeworxtech.com/ "phpMailer")，免费和开源的 php 类来发送电子邮件，易于使用（我使用它事件 o 通过 gmail 服务器发送邮件）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-22T20:50:07.213

如果您的网站域是 mydomain.com，那么在 From 标头中确保使用 someone@mydomain.com

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-05T13:27:41.880

1.  在您的服务器上尝试整理您的 SPF（Sender Policy Framework，Google for SPF 记录）记录。
2.  确保从服务器/域上的现有帐户发送电子邮件。
3.  确保您的标题中有回复地址。

这些是您可以尝试的基本操作。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-03-27T21:54:49.133

删除`Content-type: text/html`并添加`$headers .= "X-Priority: 2\nX-MSmail-Priority: high";` 以摆脱垃圾邮件。这种方法已经过尝试和测试。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-01-05T23:16:33.520

你可以试试我在这里创建的邮件类和测试文件。我已经测试了这些文件，并且可以使用不同的邮件名称向我的 hotmail 和 gmail 发送电子邮件。电子邮件被标记为垃圾邮件的主要原因是结构（标题和消息）未正确完成。在大多数情况下，是换行导致问题。

我可以使用它向 Gmail 发送带有附件的邮件。但是，附件不适用于 hotmail。希望这会有所帮助=)

你可以在[这里](http://chernkuan.blogspot.com/2010/12/php-send-mail-with-attachments-using.html)查看文件..

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-14T09:11:09.510

问题是，您发送邮件的服务器不是雅虎服务器。大多数垃圾邮件过滤器会检查它们是否匹配，否则它会（并且现在 - 或曾经）很容易伪造发件人。有没有想过为什么您会从 microsoft.com 上的 bill.gates 或您自己的邮件地址收到垃圾邮件？

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-14T09:32:14.840

你有两个解决方案：

*   通过 abc@yahoo.com 凭据使用 Yahoo 的 SMTP 从 abc@yahoo.com 发送邮件；
*   在您自己的域中使用其他来源；

# c# - 使用和持久化枚举的最佳实践

> ID：746812
> 
> 赞同：78
> 
> 时间：2009-04-14T08:58:27.293
> 
> 标签：c#, java, database, enums, persistence

我在这里看到了几个关于处理和持久化类枚举值的最佳方法的问题/讨论（例如[持久化适合枚举的数据](https://stackoverflow.com/questions/492096/persisting-data-suited-for-enums)，[如何使用 NHibernate 持久化枚举](https://stackoverflow.com/questions/256978/how-to-persist-an-enum-using-nhibernate)），我想问一下一般共识是什么.

尤其：

*   在代码中应该如何处理这些值？
*   它们应该如何保存到数据库（作为文本/作为数字）？
*   不同解决方案的权衡是什么？

*注意：我将最初包含在此问题中的解释移至答案。*

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-28T20:12:42.780

I agree with much of what you say. One thing I'd like to append, though, about the persistence of enums: I don't believe the generation of the enums at build time from the DB values is acceptable, but I also think that the runtime check is not a good solution. I'd define a third means: have a unit test which will check the values of the enum against the database. This prevents "casual" divergence, and avoids the overhead of checking the enums against the database every time the code is run.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-28T15:50:39.730

The initial article looks fine to me. Still, based on the comments, it seems some comments concerning Java enums might clarify few things.

Enum type in Java is a class by definition, but many programmers tend to forget this, because they rather relate it to "a list of allowed values" as in some other languages. It's more than that.

So, to avoid those switch statements it might be reasonable to put some code and additional methods in the enum class. There's almost never a need to create a separate "enum-like real class".

Consider also the point of documentation - do you want to document the actual meaning of your enum in the database? In the source code reflecting the values (your enum type) or in some external documentation? I personally prefer the source code.

If you want to present enum values as integers in the database due to speed or whatever reason, that mapping should also reside in the Java enum. You'll get string-name mapping by default, and I've been content with that. There's an ordinal number associated with each enum value, but using that directly as a mapping between code and database is not very bright, because that ordinal number will change if someone reorders the values in the source code. Or adds additional enum values in between existing values. Or removes some value.

(Of course, if someone changes the name of the enum in the source code, the default string-mapping goes sour too, but that's less likely to happen accidentally. And you can more easily protect against that if necessary by putting some runtime-checking and check constraints in the database as suggested here already. )

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-05-03T21:37:45.277

*I've tried to summarize my understanding. Feel free to edit this if you have any corrections. So here it goes:*

**In the code**

In the code, enums should be handled using either the language's native enum type (at least in Java and C#), or using something like the ["typesafe enum pattern"](https://stackoverflow.com/questions/5092015/advantages-of-javas-enum-over-the-old-typesafe-enum-pattern). Using plain constants (Integer or similar) is discouraged, as you lose type safety (and make it hard to understand which values are legal input for e.g. a method).

The choice between these two depends on how much additional functionality is to be attached to the enum:

*   If you want to put loads of functionality into the enum (which is good, because you avoid switch()ing on it all the time), a class is usually more appropriate.
*   On the other hand, for simple enum-like values, the language's enum is usually clearer.

In particular, at least in Java an enum cannot inherit from another class, so if you have several enums with similar behavior which you'd like to put into a superclass, you cannot use Java's enums.

**Persisting enums**

To persist enums, each enum value should be assigned a unique ID. This can be either an integer, or a short string. A short string is preferred, since it can be mnemonic (makes it easier for DBAs etc. to understand the raw data in the db).

*   In the software, every enum should then have mapping functions to convert between the enum (for use inside the software) and the ID value (for persisting). Some frameworks (e.g. (N)Hibernate) have limited suppport for doing this automatically. Otherwise, you have to put it into the enum type/class.
*   The database should (ideally) contain a table for each enum listing the legal values. One column would be the ID(see above), which is the PK. Additional columns might make sense for e.g. a description. All table columns that will contain values from that enum can then use this "enum table" as a FK. This guarantees that incorrect enum values can never be persisted, and allows the DB to "stand on its own".

One problem with this approach is that the list of legal enum values exists in two places (code and database). This is hard to avoid and therefore often considered acceptable, but there are two alternatives:

*   Only keep the list of values in the DB, generate the enum type at build time. Elegant, but means that a DB connection is required for a build to run, which seems problematic.
*   Define the list of values in the code to be authoritative. Check against the values in the DB at runtime (usually at startup), complain/abort on mismatch.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-23T15:11:12.793

In the code handling for C# you've missed out defining delcaring the 0 value. I almost without fail always declare my first value as:

```
public enum SomeEnum
{
    None = 0,
} 
```

So as to serve as a null value. Because the backing type is an integer and an integer defaults to 0 so it is massively useful in a lot of places to know if an enum has actually been programatically set or not.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-22T17:26:51.370

Java 或 C# 应始终在代码中使用枚举。免责声明：我的背景是 C#。

If the value is to be persisted to a database, the integral values of each enumeration member should be explicitly defined so that a later change in code does not accidentally alter translated enum values and thus application behavior.

Values should always be persisted to a database as integral values, to protect against enum name refactoring. Keep documentation on each enumeration in a wiki and add a comment to the database field pointing to the wiki page documenting the type. Also add XML documentation to the enum type containing a link to the wiki entry so that it is available through Intellisense.

If you use a tool to generate CRUD code it should be capable of defining an enumeration type to use for a column so that generated code objects always use enumerated members.

If custom logic needs to be applied for an enumeration member, you have some options:

*   If you have an enum MyEnum, create a static class MyEnumInfo which offers utility methods to discover additional information about the enum member, by switch statements or whatever means necessary. Appending "Info" to the end of the enum name in the class name ensures that they will be next to each other in IntelliSense.
*   Decorate the enumeration members with attributes to specify additional parameters. For example we have developed an EnumDropDown control which creates an ASP.NET dropdown filled with enumeration values, and an EnumDisplayAttribute specifies the nicely formatted display text to use for each member.

I have not tried this, but with SQL Server 2005 or later, you could theoretically register C# code with the database that would contain enum information and the ability to convert values to enums for use in views or other constructs, making a method of translating the data in a manner easier for DBAs to use.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-14T11:27:05.453

恕我直言，至于代码部分：

您应该**始终**使用“枚举”类型进行枚举，基本上，如果您这样做，您将获得很多免费赠品：类型安全、封装和避免开关、支持一些集合（例如`EnumSet`and`EnumMap`和代码清晰度）。

至于持久性部分，您始终可以保留枚举的字符串表示形式并使用 enum.valueOf(String) 方法将其加载回来。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-14T11:33:59.930

由于需要额外的空间和较慢的搜索，将枚举的文本值存储在数据库中不如存储整数。它的价值在于它比数字更有意义，但是数据库是用于存储的，而表示层是为了让事物看起来更漂亮。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-27T08:07:40.693

Well, from my experience, using enums for anything other than for passing options (as flags) to an immediate method call, results in `switch`-ing at some point.

*   If you are going to use the enum all over your code, then you might end up with code that is not so easy to maintain (the infamous `switch` statement)
*   Extending enums is a pain. You add a new enum item and end up in going through all of your code to check for all conditions.
*   With .NET 3.5, you can add extension methods to enums to make them behave a bit more like classes. However, adding real functionality this way is not so easy since it's still not a class (you would end up using `switch`-es in your extension methods if not elsewhere.

So for an enum-like entity with a bit more of functionality you should take some time and create it as a class, with several things in mind:

*   To make your class behave like an enum, you can either force each derived class to instantiate as a Singleton, or override Equals to allow value comparison of different instances.
*   If your class is enum-like, it should mean that it should contain no serializable state - deserialization should be possible from its type alone (a sort of an "ID", as you said).
*   Persistence logic should be confined to the base class only, otherwise extending your "enum" would be a nightmare. In case that you went for the Singleton pattern, you would need to ensure proper deserialization into singleton instances.

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-27T19:31:19.380

Each time you find your self using "magic numbers" in code change to enums. Besides time savings ( since magic will disappear when the bugs come ...) it will save your eyes and memory (meaningful enums make code more readable and self-documenting), since guess what - you are most probably the person to maintain and develop your own code

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-04-05T20:23:49.160

I know this is an old forum, what if the database might have other things integrating directly to it? E.g. when the resulting DB is the SOLE purpose of the code. Then, you will be defining the enums at every integration. Better then to have them in the DB. Otherwise, I agree with the original post.

# jquery - 如何获取 Json 对象以进行下拉？

> ID：746815
> 
> 赞同：2
> 
> 时间：2009-04-14T08:58:55.093
> 
> 标签：jquery, asp.net-mvc

在尝试了更多的级联下拉之后，我决定用 Jquery 来做。

这是在我的城市控制器

```
public ActionResult States(int id)  
     {
         AcademicERP.Models.AcademicERPDataContext dc = new AcademicERPDataContext();
         var states = from s in dc.States
                      where s.CountryID == id
                      select s;
         return Json(states.ToList());  
     } 
```

我试图从

城市/创建页面有脚本

```
 var ddlCountry;
var ddlStateID;

function pageLoad() {
    ddlStateID = $get("StateID");
    ddlCountry = $get("CountryID");
    $addHandler(ddlCountry, "change", bindOptions);
    bindOptions();
}
 function bindOptions() {
    ddlStateID.options.length = 0;        
    var CountryID = ddlCountry.value;
    if (CountryID) {
// some logic to call $.getJSON()
        } 
```

我在视图中有 DD

```
<%= Html.DropDownList("CountryID") %>
<select name="StateID" id="StateID"></select> 
```

那么什么是 getJSON 参数？我指的是[博客](http://stephenwalther.com/blog/archive/2008/09/07/asp-net-mvc-tip-41-creating-cascading-dropdown-lists-with-ajax.aspx)。但不工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T16:50:09.797

像这样：

```
function bindOptions() 
{
    ddlStateID.options.length = 0;
    var CountryID = ddlCountry.value;
    if (CountryID) 
    {
        var url = "/<YOUR CONTROLLER NAME>/States/" + CountryID;
        $.get(url, function(data) {
            // do you code to bind the result back to your drop down
        });
    }
} 
```

或者，我将完全通过 jQuery 来使用它，而不是使用 pageLoad：

```
$(document).ready(function() {
    $("#CountryID").change(function() {
        var strCountryIDs = "";
        $("#CountryID option:selected").each(function() {
            strCountryIDs += $(this)[0].value;
        });

        var url = "/<YOUR CONTROLLER NAME>/States/" + strCountryIDs;
        $.getJSON(url, null, function(data) {
            $("#StateID").empty();
            $.each(data, function(index, optionData) {
                $("#StateID").append("<option value='" 
                    + optionData.StateID 
                    + "'>" + optionData.StateName 
                    + "</option>");
            });
        });
    });
}); 
```

类似的东西...

# c# - 如何创建“可升级”的加密类

> ID：746816
> 
> 赞同：1
> 
> 时间：2009-04-14T08:58:57.993
> 
> 标签：c#, asp.net, security, encryption

这个想法是产生实用程序类，因此每当这些人破解目前最知名的算法并且新算法进入市场时，开发人员唯一需要做的就是添加 NewHighTechEncryptingAlgorithm_Encryptor 类并更改 NewHighTechEncryptingAlgorithm_As_String 的全局应用程序设置

这样调用将是 string myNewEncryptedString = Encryptor.Encrypt(StringToEncrypt , strAlgorithmName)

编辑：我删除了旧代码并粘贴了由 rwwilden 提供的带有调用代码的答案

我怀疑正确的措辞是“加密”而不是“加密”，因为这里没有涉及盐......根据提议的“规格”，这似乎是最好的解决方案

```
 using System;
 using System.Text;
 using System.Security.Cryptography;

 namespace GenApp.Utils.Security
 {

 /// <summary>
 /// Summary description for Encrypter
 /// </summary>
 public class Encrypter 
 {
 /// <summary>
 /// Encrypts according to the passed plain name for hasing algorithm
 /// see CryptoConfig class from MSDN for more details
 /// </summary>
 /// <param name="strPlainTxt">the plain text to encrypt</param>
 /// <param name="strAlgorithmName">The plain name of the hashing algorithm </param>
 /// <returns> the encrypted string </returns>
 public static string Encrypt ( string strPlainTxt, string strAlgorithmName )
 {
  string strHashedTxt = String.Empty;
  byte[] bytPlain = System.Text.Encoding.UTF8.GetBytes ( strPlainTxt );

  using (HashAlgorithm objAlgorithm = HashAlgorithm.Create ( strAlgorithmName ))
  {
   byte[] bytHash = objAlgorithm.ComputeHash ( bytPlain );
   strHashedTxt = Convert.ToBase64String ( bytHash );
   return strHashedTxt; 
  } 

 } //eof method 

 ///// OLD CODE - REQUIRES RECODING 
 ///// <summary>
 ///// Encrypts according to the passed plain name for hasing algorithm
 ///// see CryptoConfig class from MSDN for more details
 ///// </summary>
 ///// <param name="strPlainTxt">the plain text to encrypt</param>
 ///// <param name="strAlgorithmName">The plain name of the hashing algorithm </param>
 ///// <returns> the encrypted string </returns>
 //public static string Encrypt ( string strPlainTxt, string strAlgorithmName )
 //{
 //  string strHashedTxt = String.Empty;
 //  byte[] bytPlains = System.Text.Encoding.UTF8.GetBytes ( strPlainTxt );
 //  byte[] bytHash;
 //  //CryptoConfig objCryptoConfig = new CryptoConfig ();

 //  switch (strAlgorithmName)
 //  {
 //    case "SHA1":
 //      SHA1CryptoServiceProvider objProvForSHA1alg =
 //        (SHA1CryptoServiceProvider)CryptoConfig.CreateFromName ( strAlgorithmName );

 //      bytHash = objProvForSHA1alg.ComputeHash ( bytPlains );
 //      objProvForSHA1alg.Clear ();
 //      strHashedTxt = Convert.ToBase64String ( bytHash );

 //      break;
 //    case "MD5" :

 //      MD5CryptoServiceProvider objProvForMD5alg =
 //        (MD5CryptoServiceProvider)CryptoConfig.CreateFromName ( strAlgorithmName );

 //      bytHash = objProvForMD5alg.ComputeHash ( bytPlains );
 //      strHashedTxt = Convert.ToBase64String ( bytHash );
 //      objProvForMD5alg.Clear ();

 //      break; 

 //  } //eof switch

 //  if (String.IsNullOrEmpty ( strHashedTxt ))
 //    throw new Exception ( "Encryption provider called by invalide simple name " );

 //  return strHashedTxt;
 //} //eof method 

 } //eof class 

 class Program
 {
 static void Main ( string[] args )
 {
  string strPlainTxt = "UnEncryptedText";
  string strAlgorithmName = "SHA1"; //the type of al
  string strHashedTxt = String.Empty;

  //START WITH ONE ALGORITHM
  Console.WriteLine ( "Using the " + strAlgorithmName + " START " );
  Console.WriteLine ( "The plain text is " + strPlainTxt );
  Console.WriteLine ( "The encrypting algorithm is " + strAlgorithmName );
  strHashedTxt = Encrypter.Encrypt ( strPlainTxt, strAlgorithmName );
  Console.WriteLine ( "The hashed text is " + strHashedTxt );
  Console.WriteLine ( "Using the " + strAlgorithmName + " END " );

  //NOW CHANGE THE ALGORITHM
  strAlgorithmName = "MD5";
  Console.WriteLine ( "Using the " + strAlgorithmName + " START " );
  Console.WriteLine ( "The plain text is " + strPlainTxt );
  Console.WriteLine ( "The encrypting algorithm is " + strAlgorithmName );
  strHashedTxt = Encrypter.Encrypt ( strPlainTxt, strAlgorithmName );
  Console.WriteLine ( "The hashed text is " + strHashedTxt );
  Console.WriteLine ( "Using the " + strAlgorithmName + " END " );

  strAlgorithmName = "SHA256";
  Console.WriteLine ( "Using the " + strAlgorithmName + " START " );
  Console.WriteLine ( "The plain text is " + strPlainTxt );
  Console.WriteLine ( "The encrypting algorithm is " + strAlgorithmName );
  strHashedTxt = Encrypter.Encrypt ( strPlainTxt, strAlgorithmName );
  Console.WriteLine ( "The hashed text is " + strHashedTxt );
  Console.WriteLine ( "Using the " + strAlgorithmName + " END " );

  Console.WriteLine ( "Hit enter to exit" );
  Console.ReadLine ();
 }

 }
 } //eof namespace 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T09:07:11.030

您应该看一下[CryptoConfig](http://msdn.microsoft.com/en-us/library/system.security.cryptography.cryptoconfig.aspx)类。特别是[CreateFromName](http://msdn.microsoft.com/en-us/library/system.security.cryptography.cryptoconfig.createfromname.aspx)方法。它提供了一种基于名称（您在配置中提供）获取加密算法的方法。更改配置中的名称会自动更改使用的算法。

如果您已选择使用对称加密还是非对称加密，则应使用更具体的[SymmetricAlgorithm.Create(string)](http://msdn.microsoft.com/en-us/library/k74a682y.aspx)或[AsymmetricAlgorithm.Create(string)](http://msdn.microsoft.com/en-us/library/bf2t8ayw.aspx)方法。

由于您需要散列解决方案，因此您应该使用[HashAlgorithm.Create(string)](http://msdn.microsoft.com/en-us/library/wet69s13.aspx)。像我在下面那样实现它的原因是，当您决定使用另一种散列算法时，您不必更改任何代码。在您的代码中，您必须添加另一个`case`语句。

```
public static string Encrypt(string toEncrypt, string algorithmName)
{
    byte[] bytePlain = System.Text.Encoding.UTF8.GetBytes ( strPlainTxt );
    using (HashAlgorithm algorithm = HashAlgorithm.Create(algorithm))
    {
        byte[] byteHash = algorithm.ComputeHash(bytePlain);
        string strHashedTxt = Convert.ToBase64String (byteHash);
        return strHashedTxt;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T11:46:57.263

我建议使用 Resharper 或 Coderush 的副本来修复编码人员的失明问题 :) 框中包含大括号突出显示。

此外，这是经典或基本的接口 + 工厂模式。正如其他人所说，MEF 和 ICryptoTransform 很可能是最干净的起点，因为框架为您提供了它，但如果您想了解基础知识：

做一个界面：

```
public interface IEncrypter {
  string Encrypt(string plaintext);
} 
```

然后实现它：

```
public class MD5Encrypter : IEncrypter {
  public string Encrypt(string plaintext) {
    //code goes here.
  }
}

public class SHA1Encrypter : IEncrypter {
  public string Encrypt(string plaintext) {
    //code goes here.
  }
} 
```

然后，制作一个工厂：

```
public class EncryptionFactory {
  public static IEncrypter GetEncrypter() {
    //work out which one to return, maybe based on a config value?

    // I'm just going to return an MD5, but you'd want to use a switch statement etc
    // to decide which one to return.

    return new MD5Encrypter();
  }
} 
```

并像这样使用它：

```
IEncrypter encrypter = EncryptionFactory.GetEncrypter();
string garbageText = encrypter.Encrypt("Hello, world"); 
```

您所更改的只是工厂，或者更好的是工厂读取的配置，以使其使用其他东西。地狱，如果你真的想要的话，你可以基于一天中的时间:) 你编写的使用接口的代码并不关心对象实际上是什么——它只关心有一个: string Encrypt(string) 方法。

MEF 在某些方面为您做到了这一点。

使用这些接口还意味着您可以返回一个虚拟的、假的 IEncrypter，它什么都不做，因此您可以针对它编写单元测试，而无需实际进行加密。在这种情况下不是超级有用，但一般来说这是一个很好的做法。

此外，您可以在工厂中使用@rwwilden 的建议来生成它 - 您从配置中读取一个字符串，并使用他所说的 Asymetric/Symetric 创建方法来创建底层类.....

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T09:03:46.547

`//eof class`和`//eof namespace`垃圾有什么关系？

记录在案：您要实现的基本上是一种有限的插件架构。请参阅[MEF](http://www.codeplex.com/MEF)，了解如何做到这一点。

顺便说一句，您知道[ICryptoTransform](http://msdn.microsoft.com/en-us/library/system.security.cryptography.icryptotransform.aspx)吗？

# crystal-reports - 如何更改 vs 2005 中的水晶报表页面大小？

> ID：746825
> 
> 赞同：0
> 
> 时间：2009-04-14T09:06:19.660
> 
> 标签：crystal-reports, report

如何更改 vs 2005 中的水晶报表页面大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T09:48:55.457

报告的页面大小源自报告的打印机设置。您可以在打印机设置中更改此设置。因此，例如，如果您想要更大的表面，也许您可​​以根据需要选择更大的纸张尺寸，例如 A4 或 A3

# dataset - 如何在数据集中查找行（没有主键）

> ID：746828
> 
> 赞同：1
> 
> 时间：2009-04-14T09:07:27.007
> 
> 标签：dataset, ultrawebgrid

我使用 Ultrawebgrid- 更新事件::

```
protected void UltraWebGrid1_UpdateRow(object sender, RowEventArgs e) 
```

所以，我想更新数据表（在数据集中）中的行（在网格中更新）

数据表也没有任何主键。 *我怎样才能在这样的数据表中找到任何行？*

例如，我可以去

```
UltraGridRow oldrow = (UltraGridRow) e.Data; 
```

现在，我怎样才能找到与 相同的行（在数据集中的数据表中），`oldrow`以便我可以在数据集中更新它？

*数据表没有任何主键*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T09:22:19.717

您需要有某种方法来唯一标识数据库表中的一行。通常，数据库表将具有一个或多个字段，通过充当主键来实现此目的。从您所说的来看，听起来该表没有主键。[然而，需要有一些数据组合可以用作主键](http://en.wikipedia.org/wiki/Database_normalization)。

例如，该表可能包含用户信息，并且通过结合头发颜色、身高、体重、地址和年龄，这可能足以唯一地识别用户。为什么你想要这样做让我有点困惑，但我们可以假设你有充分的理由想要这样做。制定了这种组合后，您需要将这些人放入`where`SQL UPDATE 语句的子句中，以识别要更新的行：

```
UPDATE TABLE_WITH_NO_PRIMARY_KEY SET NAME = 'Bobby Tables'
  WHERE HAIR_COLOUR = 'RED' AND HEIGHT = '215' AND SO ON 
```

这样做的风险是您可能会遇到一个情况，即多个用户具有相同的识别特征（也许他们是双胞胎？），因此更新语句将更新两行而不是只更新一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T09:23:22.193

在这种情况下，如果您不想遍历所有行，则需要使用 LinqToDataSets。[您可以在此处](http://msdn.microsoft.com/en-us/vbasic/bb688086.aspx)和[此处](http://msdn.microsoft.com/en-us/library/bb386977.aspx)找到 LinqToDataSet 的示例。

链接文本 1：http: [//msdn.microsoft.com/en-us/vbasic/bb688086.aspx](http://msdn.microsoft.com/en-us/vbasic/bb688086.aspx)

链接文本 2：http: [//msdn.microsoft.com/en-us/library/bb386977.aspx](http://msdn.microsoft.com/en-us/library/bb386977.aspx)

# windows-xp - 是否有官方的 Windows XP 注册表参考？

> ID：746836
> 
> 赞同：4
> 
> 时间：2009-04-14T09:14:23.043
> 
> 标签：windows-xp, reference, registry

是否有官方的 Windows XP 注册表参考在线某个地方？我在 MS technet 上看到了[Win 2000](http://technet.microsoft.com/en-us/library/cc974061.aspx)和[Win 2003](http://technet.microsoft.com/en-us/library/cc778196(v=ws.10).aspx)服务器的参考资料，但我似乎找不到 XP 的参考资料。是的，我知道 Win 2000 参考就足够了（无论如何，大多数事情在 XP 中都是一样的），但如果有明确的 XP 参考，我想看看它。

编辑：我不是指 API 参考。我正在寻找有关注册表项、可能值等描述的参考。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T09:17:34.330

[http://msdn.microsoft.com/en-us/library/ms724880(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms724880(VS.85).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-25T19:24:33.200

Windows 2000 Resource Kit 附带一个名为“注册表参考”(regentry.chm) 的帮助文件。如果您有权访问此旧资源工具包，则此文件非常有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-25T19:18:45.787

[Microsoft Windows 内部，第 4 版。](https://rads.stackoverflow.com/amzn/click/com/0735619174)，第 4 章，第 1 部分：注册表*正是*您想要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T09:28:50.900

注册表只是存储数据的一种方式。它的很大一部分本质上是无证的，并且可能会发生变化。注册表的设计目的不是要严格定义，因此无法对其进行严格定义或完整的文档。

对于特定情况（例如“允许使用哪些值`HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Config\UpdateInterval`”），您可以找到供应商文档（在这种情况下是在 MSDN 中）。

# .net - OLEDB 提供程序是托管还是非托管？

> ID：746852
> 
> 赞同：0
> 
> 时间：2009-04-14T09:24:43.640
> 
> 标签：.net, sql-server

OLEDB 提供程序是托管还是非托管？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T09:32:08.040

OLEDB 顾名思义是使用 OLE 或 COM 实现和访问的。它是一种非托管技术，但您可以通过 COM/interop 以通常的方式使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T09:33:42.857

据我所知，答案是*两者*。

ADO.NET 部分是托管的 ( `System.Data.OleDb`)，但底层 OLEDB 驱动程序将是本机的。

# javascript - css、javascript——从哪里开始？

> ID：746873
> 
> 赞同：3
> 
> 时间：2009-04-14T09:32:46.290
> 
> 标签：javascript, css

我是一名拥有超过 10 年经验的 C/C++ 程序员。我也知道 python 和 perl，但我从来没有使用过这些语言进行 Web 开发。

现在由于某些原因，我想进入 Web 开发领域，作为过渡的一部分，我必须学习 css、javascript、(x)html 等。

所以我需要一个关于此类主题的良好信息来源的建议。有一段时间我不想阅读冗长的教程，我想要一些快速而肮脏的东西，一些开始的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T09:56:49.133

[您可以在A List Apart](http://www.alistapart.com/)网站上学习风格和最佳实践。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T09:41:00.140

由于您是一位经验丰富的程序员，因此您可以从Douglas Crockford[的 Javascript: The Good Parts开始学习 javascript。](https://rads.stackoverflow.com/amzn/click/com/0596517742)这是对 javascript 最好部分的简短而全面的介绍（以及相当长一段时间内您需要的几乎所有内容）。

您对 CSS 和 HTML 的处理方式必须非常不同。我建议尝试制作一个或两个静态站点，如果遇到困难，请检查参考资料。选择一个您喜欢的站点，然后尝试用 HTML 重新创建基本布局。有布局吗？试着让它看起来很漂亮。重复。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T10:02:48.073

我发现[http://htmldog.com/](http://htmldog.com/)在学习 HTML/CSS 时很有用。与许多其他网站不同，它教授符合 w3c 的 HTML 和 CSS。看别人的 CSS 也很有用。CSS 非常简单（忽略所有浏览器不兼容的问题），因此即使很少的 CSS 知识，您也可以弄清楚其他人在做什么。

Javascript更复杂。Javascript 有一个非常奇怪的对象系统（它使用原型继承），所以最好拿起一本书。Crockford 的 Javascript: The Good Parts 是一本学习 javascript 基础知识的优秀书籍。关于javascript的事情基本上是它的两个部分：语言和DOM（文档对象模型）。大多数时候，浏览器都使用 javascript，这意味着它必须通过 DOM 与 HTML 交互。许多人没有意识到 javascript 可以在 Web 浏览器之外使用。JS：Good Parts 会教你 javascript 核心，然后你可以在其他地方查找 DOM 交互。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T09:50:42.877

我强烈建议您查看[Dev Opera](http://dev.opera.com/)，它充满了最新的信息，并且非常关注网络标准。特别是，[Web 标准课程](http://dev.opera.com/articles/wsc/)是初学者入门的绝佳资源。

我真的不会依赖 W3 Schools 网站，它的内容没有保持最新，而且这些示例经常显示不好的做法。如果您知道自己在做什么，它可以作为单一技术的快速资源，但对于初学者来说，它很容易导致您走错路。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T10:30:34.653

I won't suggest w3schools for CSS and XHTML, but [htmldog.com](http://www.htmldog.com). I would suggest something about unobtrouse JavaScript for JS.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T09:55:22.960

我最喜欢的 CSS 教程网站一直是[www.htmldog.com](http://www.htmldog.com)。我如此喜欢它的原因是它不仅教你 CSS，它还教你放弃多年来可能养成的任何不良 html 习惯。在我看来，学习编写干净、语义化的 html 是真正掌握 css 的重要前提。

至于 javascript，w3schools 可能是最好的

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-14T12:38:46.017

对于 CSS，O'Reilly 的 CSS in a Nutshell 怎么样？又好又瘦。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-17T13:34:52.343

Opera 最近投入了大量精力让人们编写[大量教程](http://opera.com/wsc/)。质量很高，而且他们注重反馈（与 W3Schools 不同）。它涵盖了 HTML、CSS 和 JavaScript，我还没有找到更好的起点。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-24T21:22:39.480

安装[萤火虫](http://getfirebug.com/)。

*   它有助于检查 html。
*   您可以即时编辑 CSS。
*   有一个 JavaScript 控制台。

[这](http://net.tutsplus.com/tutorials/other/10-reasons-why-you-should-be-using-firebug/)是一篇很好的文章，解释了[firebug](http://getfirebug.com/)的一些功能。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-14T09:34:48.267

[W 3 Schools](http://www.w3schools.com/)是一个简洁的初学者/新手参考和教程网站。

该站点涵盖了 Web 开发中使用的大多数技术。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-04-14T10:24:02.907

[W3Schools](http://www.w3schools.com/) is a good place to start.

However, you might also benefit by poking around the [Mozilla Developer Centre](https://developer.mozilla.org/En) (MDC), which has lots of information about HTML, CSS, and JavaScript. I now almost exclusively use the MDC for looking things up—it has lots of examples, lots of detail (if you want to go into it), and it shows you many different things that you can do with the item you're looking up.

Also, for JavaScript, after you've learnt the basics ("[A re-introduction to JavaScript](https://developer.mozilla.org/En/A_re-introduction_to_JavaScript)" on the MDC is a good place to start), Douglas Crockford's [JavaScript page](http://javascript.crockford.com/) and John Resig's "[Learning Advanced JavaScript](http://ejohn.org/apps/learn/)" make for excellent reading.

Steve

* * *

## 回答 #12

> 赞同：-5
> 
> 时间：2009-04-14T09:34:55.287

W3Schools 网站有一个自己尝试的部分，我认为这对你来说是完美的。

[W3Schools CSS](http://www.w3schools.com/Css/default.asp)

[W3Schools Javascript](http://www.w3schools.com/JS/default.asp)

# asp.net - ASP.NET Webforms 和 Jquery - 处理 ID 修改的策略

> ID：746875
> 
> 赞同：-1
> 
> 时间：2009-04-14T09:32:59.767
> 
> 标签：asp.net, jquery

我喜欢 jQuery 并且正在使用 ASP.NET。我知道您可以使用 ClientID 进行一些圆形 ID 混搭，但是当您将脚本输出到 sepearte js 文件时，这并不能很好地工作。

我使用此方法的唯一方法是将 ClientID 存储在页面上的 javascript 变量中，然后在单独的 js 文件中使用此 id。但这并不理想。

有没有人有更好的方法来处理这个问题（除了等待 ASP.NET 4.0！）

**编辑：重复问题：**

[如何阻止 ASP.NET 更改 ID 以使用 jQuery](https://stackoverflow.com/questions/497802/how-to-stop-asp-net-from-changing-ids-in-order-to-use-jquery/498972#498972)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T09:42:53.363

当我使用嵌套的 Web 控件时，我使用类名来选择带有 jQ​​uery 的内容。以及未嵌套的控件上的 id。

# c++ - 使用具有多个顶级窗口的 MFC MDI

> ID：746879
> 
> 赞同：1
> 
> 时间：2009-04-14T09:33:46.567
> 
> 标签：c++, mfc

我正在使用多个顶级 Windows 应用程序。主窗口是一个MDIFrameWnd，我在CWinApp中放了一些代码来切换顶级窗口时切换m_pMainWnd。它工作正常，但是当我关闭一个主窗口时会触发一个断言。此断言来自 CMDIChildWnd：

```
void CMDIChildWnd::AssertValid() const
{
    CFrameWnd::AssertValid();
    ASSERT(m_hMenuShared == NULL || ::IsMenu(m_hMenuShared));
} 
```

看起来窗口被关闭释放共享菜单。我试图找出菜单在MFC框架中的发布位置，但找不到。有人可以帮我吗？谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T09:56:51.667

CMultiDocTemplate 类拥有共享菜单的所有权（它在其析构函数中破坏了 m_hMenuShared）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T02:29:46.977

我发现问题是。主框架中的菜单栏控件将破坏其 dtor 中的菜单。谢谢大家。

# asp.net - FormsAuthentication.RedirectFromLoginPage 不起作用

> ID：746880
> 
> 赞同：2
> 
> 时间：2009-04-14T09:34:15.583
> 
> 标签：asp.net

我正在使用 LoginPage。与数据库或 C# 代码相关的所有内容都运行良好，但成功登录后我无法重定向到 Home.aspx，我错过了什么吗？请帮忙。 **代码：**

**网络配置：**

```
</authentication>
<authorization>
  <deny users="*"/>

</authorization> 
```

**C#代码：**

```
protected void Button1_Click(object sender, EventArgs e)
    {
        string source = "server=localhost\\sqlexpress;Database=LogInDB;Trusted_Connection=True";
        SqlConnection con = new SqlConnection(source);
        con.Open();
        SqlCommand cmd = new SqlCommand("proc_LogIn", con);
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.Parameters.Add("@ID", SqlDbType.Int).Value = TextBox1.Text;
        cmd.Parameters.Add("@Password", SqlDbType.VarChar).Value = TextBox2.Text;
        SqlDataReader dr = cmd.ExecuteReader();
        if (dr.Read())
        {
            FormsAuthentication.RedirectFromLoginPage(TextBox1.Text, false);
                    }
        else
        {
            Response.Write("Invalid credentials");
        }

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T09:36:14.393

它应该是`<deny users="?"/>`

```
* means all 
? means unauthenticated 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T09:38:46.947

```
<authentication mode="Forms">
    <forms 
        loginUrl="login.aspx" 
        defaultUrl="home.aspx" 
        slidingExpiration="true" 
        timeout="20" name=".Auth" 
        protection="All">
    </forms>
</authentication> 
```

除了进行 Mladen 提到的设置之外，您还必须在调用该方法之前在 web.config 中进行这些设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-02T12:19:31.240

就我而言，尽管在我的 web.config 中提供了两个提供答案的代码，但仍`FormsAuthentication.RedirectFromLoginPage`导航回`loginUrl`.

这似乎是这两个线程（[1](https://forums.asp.net/t/1200058.aspx?%20FormsAuthentication%20RedirectFromLoginPage%20Problem)、[2](https://forums.asp.net/t/1155607.aspx?FormsAuthentication%20RedirectFromLoginPage%20doesn%20t%20work)）中描述的一个已知问题。正如那里的建议，使用 authCookie 和重定向的组合对我有用。

**VB.NET 代码：**

```
 FormsAuthentication.SetAuthCookie(txtUsername.Value, False)
    Response.Redirect(FormsAuthentication.DefaultUrl, False) 
```

# svn - 如何使用 svn 实现以下目标？

> ID：746895
> 
> 赞同：0
> 
> 时间：2009-04-14T09:39:46.040
> 
> 标签：svn

因此，开发人员 X 和 Y 从 svn repo 签出，修订号为 2。开发人员 Y 进行更改并提交。Dev X 进行更改并进行提交。现在我想强制执行如果他的回购不是最新的，他不应该能够提交？

我该怎么做呢？

我如何阻止用户在不进行 svn update 的情况下提交 repo 并因此覆盖 prev 开发人员的更改？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-14T09:43:06.407

SVN 会自动执行此操作，对于服务器上已更改的文件，您必须更新您的工作副本并解决所有冲突，然后才能提交。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T09:48:13.100

您不能真正强制 SVN 让程序员总是进行更新，但如果存在冲突，即。程序员 X 更改的文件已在存储库中更新，则 SVN 将需要更新以解决冲突。

换句话说，如果程序员 Y 将文件 TEST.TXT 从修订版 2 更新到修订版 3，并且程序员 X 拥有 TEST.TXT 修订版 2，并更改了该文件，当他尝试提交修订版 4 时，SVN 将强制程序员 X先更新。

但是，如果程序员 X 和 Y 在不同的文件上工作，SVN 不会强制更新。

客户端钩子可能是可能的。

您想在这里解决哪些具体问题？你为什么要这样做？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T11:47:51.287

这是有关“提交更改”的官方 Subversion 文档章节：

[http://svnbook.red-bean.com/nightly/en/svn.tour.cycle.html#svn.tour.cycle.commit](http://svnbook.red-bean.com/nightly/en/svn.tour.cycle.html#svn.tour.cycle.commit)

最后一段说您必须`svn update`在提交本地工作副本中的“过期”文件之前执行。

# asp.net - 会话中的数组列表

> ID：746898
> 
> 赞同：0
> 
> 时间：2009-04-14T09:41:08.313
> 
> 标签：asp.net

我需要在类文件中访问的页面中有一些数组列表。如何在类文件中获取这些 Arraylist？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T10:05:57.600

假设您正在谈论的这个类文件是文件背后的代码，那么您几乎可以像使用数组一样使用 Session 对象并在其中塞入一些东西。

```
Session["MyArrayList"] = new ArrayList(); 
```

并使用相同的检索

```
tmpArrayList = (ArrayList)Session["MyArrayList"]; 
```

在另一页上。

# math - 如何通过指定 alpha 混合量来计算 RGB 颜色？

> ID：746899
> 
> 赞同：63
> 
> 时间：2009-04-14T09:41:44.583
> 
> 标签：math, colors, alphablending

我正在编写一个颜色选择器，它可以从您在屏幕上指向的任何位置获取像素 RGB 值。我还希望可以选择指定我选择的颜色已经具有 alpha 值。我只是想知道如何计算结果颜色。

例如：

生成的像素颜色为 240,247,249，但我知道原始颜色的不透明度为 10%，并且位于白色 (255,255,255) 背景之上。计算出原始 RGB 值的计算方法是什么？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2009-04-14T09:53:50.887

标准混合方程为：

```
out = alpha * new + (1 - alpha) * old 
```

其中`out`和是 RGB 颜色，并且`new`是[0,1] 范围内的浮点数。`old``alpha`

所以，你有（红色）：

```
240 = 0.1 * newR + 0.9 * 255 
```

求解`newR`，我们得到：

```
newR = (240 - 0.9 * 255) / 0.1 
```

计算结果为 105。对其他组件重复此操作，您就完成了。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-04-14T09:53:10.640

我只是想知道你怎么知道它的 alpha 而不是它的 r,g,b... 除非在每种情况下使用的混合模式都是 Normal，否则你将无法计算原始值。即使一切都是理想的，你也只能近似，因为从原始到结果时可能已经发生了一些舍入。此外，当从结果返回到原始结果时，您很可能需要四舍五入。

如果混合模式是正常的，那就不太难了:-)

```
opacity*original + (1-opacity)*background = resulting pixel

original R = (resulting R - ((1-opacity)*background R)) / opacity.
original G = (resulting G - ((1-opacity)*background G)) / opacity.
original B = (resulting B - ((1-opacity)*background B)) / opacity. 
```

其中不透明度为`(alpha/100)`。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-03-18T16:48:35.300

以下伪代码解决了您的问题：

```
 CalculateSolidColorFromTransparentColor(Color color, Color background)
    {
        alpha = color.A / 255;
        oneminusalpha = 1 - alpha;

        newR = ((color.R * alpha) + (oneminusalpha * background.R));
        newG = ((color.G * alpha) + (oneminusalpha * background.G));
        newB = ((color.B * alpha) + (oneminusalpha * background.B));
    } 
```

请注意，输入颜色和背景的值以 [0..255] 表示

# c# - Asp .Net 文件缓存

> ID：746900
> 
> 赞同：1
> 
> 时间：2009-04-14T09:41:57.127
> 
> 标签：c#, asp.net, caching

有什么方法可以在不编写自己的 HttpModule 的情况下在 ASP.NET 中缓存具有资源的整个文件夹？例如：带有所见即所得编辑器 javascript 和样式的文件夹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T09:47:28.220

ASP.NET 缓存的目的是使请求不再需要被完整处理，这意味着不必查询数据库，不必生成内容，不必实例化模板，调用事件处理程序，等等。

以这种方式缓存静态对象不会提高性能，因为不需要对静态内容进行处理。ASP.NET 无论如何都不处理这些项目。IIS 可能会通过操作系统的缓存功能来缓存它们。

我应该注意，静态内容的缓存是由客户端自动完成的，因此重新访问客户端不太可能两次下载相同的对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T09:58:23.717

可以做到这一点的一种方法是使用 IIS 中的“启用内容过期”设置，您可以将该文件夹的过期日期设置为将来的某个日期。

> WYSIWYG 编辑器文件夹（右键单击）-> 属性-> HTTP 标头-> 在 IIS5/6 中启用内容过期复选框。

# c# - 获取盒装枚举的积分值

> ID：746905
> 
> 赞同：4
> 
> 时间：2009-04-14T09:43:09.650
> 
> 标签：c#, reflection, enums

我已经决定不可能通过反射执行以下（等效）枚举操作 - 因为 Enum 类没有运算符，并且发出的代码也不公开任何运算符：

```
object boxedEnum = MyEnum.Flag1 | MyEnum.Flag2;
boxedEnum &= ~MyEnum.Flag2; // Remove the flag. 
```

因此，我目前正在执行以下操作（等效）：

```
int boxedEnumValue = (int) boxedEnum;
boxedEnumValue &= ~MyEnum.Flag2;
boxedEnum = Enum.ToObject(boxedEnum.GetType(), boxedEnumValue); 
```

效果很好，唯一的问题是将 boxedEnum 转换为整数的等效代码是：

```
int boxedEnumValue = int.Parse(Enum.Format(boxedEnum.GetType(), boxedEnum, "X"), System.Globalization.NumberStyles.HexNumber); 
```

我相信你会同意这是可怕的和hacky。

所以这个问题有两个方面。如果有人能证明我错了并提供一种对盒装枚举执行二进制操作的方法，那就太棒了——否则任何避免字符串往返的方法都会受到赞赏。

[Guffa](https://stackoverflow.com/questions/746905/get-integral-value-of-boxed-enum/746928#746928 "古法的回答")给了我将枚举转换为特定类型所需的东西。我编写了一个扩展方法来完成细节：

```
 /// <summary>
    /// Gets the integral value of an enum.
    /// </summary>
    /// <param name="value">The enum to get the integral value of.</param>
    /// <returns></returns>
    public static T ToIntegral<T>(this object value)
    {
        if(object.ReferenceEquals(value, null))
            throw new ArgumentNullException("value");
        Type rootType = value.GetType();
        if (!rootType.IsEnum)
            throw new ArgumentOutOfRangeException("value", "value must be a boxed enum.");
        Type t = Enum.GetUnderlyingType(rootType);

        switch (t.Name.ToUpperInvariant())
        {
            case "SBYTE":
                return (T)Convert.ChangeType((sbyte) value, typeof(T));
            case "BYTE":
                return (T) Convert.ChangeType((byte) value, typeof(T));
            case "INT16":
                return (T) Convert.ChangeType((Int16) value, typeof(T));
            case "UINT16":
                return (T) Convert.ChangeType((UInt16) value, typeof(T));
            case "INT32":
                return (T) Convert.ChangeType((Int32) value, typeof(T));
            case "UINT32":
                return (T) Convert.ChangeType((UInt32) value, typeof(T));
            case "INT64":
                return (T) Convert.ChangeType((Int64) value, typeof(T));
            case "UINT64":
                return (T) Convert.ChangeType((UInt64) value, typeof(T));
            default:
                throw new NotSupportedException();
        }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T09:51:49.257

装箱的值永远不能原地更改。您只需将枚举拆箱，执行操作并再次将其装箱：

```
boxedEnum = (MyEnum)boxedEnum & ~MyEnum.Flag2; 
```

编辑：

如果枚举的基础类型是 int，您可以将其拆箱为 int 并将其装箱为 int。装箱的 int 稍后可以拆箱为枚举类型：

```
boxedEnum = (int)boxedEnum & ~2;

MyEnum value = (MyEnum)boxedEnum; // works both for a boxed int and a boxed MyEnum 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T09:48:27.547

```
int enumValue = (int)SomeEnum.Val1 | (int)SomeEnum.Val2;
SomeEnum e = (SomeEnum)enumValue; 
```

你想实现这样的目标吗？

# asp.net - Ajax.net 但没有脚本

> ID：746927
> 
> 赞同：0
> 
> 时间：2009-04-14T09:51:33.017
> 
> 标签：asp.net, ajax.net

我想用 ajax.net 做一些 js。如下所示：

ScriptManager.RegisterStartupScript(提交, typeof(Button), "alert", "location.href='test.aspx';", true);

如果用户关闭 javascript，它不会重定向到另一个页面。

我想知道如何设置<noscript></noscript>。

非常感谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T10:13:13.197

这里：

```
<noscript>
  <meta http-equiv="refresh" content="0; URL='no-script.aspx'">
</noscript> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T19:22:03.907

我会使用 Response.Redirect("test.aspx") ，它不需要 JavaScript，大多数现代浏览器都应该支持它。

# vb.net - 将数据或代码导出到 .png

> ID：746930
> 
> 赞同：0
> 
> 时间：2009-04-14T09:52:10.847
> 
> 标签：vb.net

如何将代码导出到 .png 以使其具有动画效果？我正在使用 VB.Net 2008 速成版。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T10:00:58.657

在代码隐藏中创建一个类似“myimage.aspx”的页面（对不起，这是 C#）

```
Bitmap bmp = new Bitmap(width, height);
Graphics gfx = Graphics.FromImage(bmp);
gfx.FillRectangle(Brushes.White, 0, 0, bmp.Width, bmp.Height); 
```

使用 gfx 在图像上绘图（参见它的方法）。然后在响应流中返回 PNG

```
MemoryStream ms = new MemoryStream();
bmp.Save(ms, System.Drawing.Imaging.ImageFormat.Png);

Response.Clear();
Response.ContentType = "image/png";
Response.BinaryWrite(ms.GetBuffer());
Response.End(); 
```

然后，您可以在 HTML 中引用它，例如

```
<img src="myimage.aspx" /> 
```

# asp.net-2.0 - 列表中命名参数的多个实例

> ID：746933
> 
> 赞同：1
> 
> 时间：2009-04-14T09:52:48.567
> 
> 标签：asp.net-2.0

我在 ASP.NET 应用程序中遇到此错误（而它在 Oracle 中运行良好）

**PLS-00703:: 列表中命名参数的多个实例**

我在这里附上了代码。它在最后一行显示错误，即*cmd.ExecuteNonQuery()*

```
 cmd.Parameters.AddWithValue("in_prog_id", 2);
    cmd.Parameters.AddWithValue("in_sllr_co_id", 1);
    cmd.Parameters.AddWithValue("in_sllr_purch_loc_nbr", 1);
    cmd.Parameters.AddWithValue("in_byr_co_id", Convert.ToInt32(co_id));
    cmd.Parameters.AddWithValue("in_byr_purch_loc_nbr", purch_loc_nbr);
    cmd.Parameters.AddWithValue("in_ing_id", ing_id);
    cmd.Parameters.AddWithValue("in_per_id", per_id);
    cmd.Parameters.AddWithValue("in_ing_purch_qty", "12");
    cmd.Parameters.AddWithValue("in_pop_sl_trck_nbr", "ECAP");
    cmd.Parameters.AddWithValue("in_pop_sl_cmnt_txt",  dstemp.Tables["ECAP"].Rows[i][6].ToString());
    cmd.Parameters.AddWithValue("in_chg_by", 1333);
    cmd.Parameters.AddWithValue("in_ing_rev_amt", dstemp.Tables["ECAP"].Rows[i][5].ToString());
    cmd.Parameters.AddWithValue("in_sl_typ", "ME");
    cmd.Parameters.AddWithValue("in_dir_sale_ind", "DIR-SL");
    cmd.Parameters.AddWithValue("in_intg_sl_ind", "N");  ***//character as input***
    cmd.ExecuteNonQuery(); 
```

这是我的方法，上面的语句在其中。

```
private void call_proc(int i, DataSet dstemp, OracleCommand cmd)
{

} 
```

我调用这个方法如下：

```
 cmd1 = conn3.CreateCommand();
    cmd1.CommandText = "pkg_sale.cre_pop_sl";
    cmd1.CommandType = CommandType.StoredProcedure;
    for (int i = 0; i < ds.Tables["ECAP"].Rows.Count; ++i)
        call_proc(i, ds, cmd1); 
```

这有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T09:57:48.837

`cmd`您是否正在为多个 SQL 语句重用该实例？

您在此处发布的内容没有重复项，因此我怀疑仅此代码会导致问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T10:03:34.360

这似乎是 Oracle 存储过程的常见错误，最常见的原因是开发人员`Parameters.Clear`在重复调用代码之前忽略了调用。

要么，要么您的一个或多个参数在其他地方重复。

**编辑（在OP的帖子之后）**

这似乎是第一种可能性，因为您在循环中调用该函数。只需清除循环函数中的参数，它应该可以工作。

请参阅[此参考](http://www.error-code.org.uk/view.asp?e=ORACLE-PLS-00703)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-18T04:04:45.403

我遇到了另一种情况，如果您使用 ODP.Net，可能会发生这种情况。如果您使用任何实用程序类来生成命令（就像我在我的项目中所做的那样），它可能会在幕后做一些“智能”工作以从存储过程中派生参数。

```
 OracleCommandBuilder.DeriveParameters((OracleCommand)command); 
```

该语句将参数注入到 Command 对象中，如果您将参数添加到同一个 cmd 对象（就像您通常所做的那样），它将有 2 个同名的参数。

# python - 将用户提供的属性（在运行时）添加到 Google App Engine 中的 Expando 类的实例？

> ID：746942
> 
> 赞同：0
> 
> 时间：2009-04-14T09:56:27.653
> 
> 标签：python, google-app-engine

通过创建从 Expando 类继承的数据存储模型，我可以使我的模型实体/实例具有动态属性。这太棒了！但我想要的是在运行时确定这些动态属性的名称。那可能吗？

例如，

```
class ExpandoTest (db.Expando):
 prop1 = db.StringProperty()
 prop2 = db.StringProperty()

entity_one = ExpandoTest()
entity_two = ExpandoTest()

# what I do not want
entity_one.prop3 = 'Demo of dynamic property'

# what I want
entity_two.<property_name_as_entered_by_user_at_runtime> = 'This
property name was entered by the user, Great!!' 
```

这可能吗？如果是这样，怎么做？我已经尝试了几种方法来做到这一点，但没有成功。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T10:35:10.273

通常，我们直接使用 setattr 函数。

```
setattr( entity_two, 'some_variable', some_value ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T10:09:51.600

刚刚找到了我自己问题的解决方案。这真的很简单，但由于我是一个 python 菜鸟，我最终发布了你在上面看到的问题。

对于我使用的代码示例，这是需要做的：

```
entity_two.__setattr(some_variable, some_value) #where some_variable is populated by user at runtime :) 
```

# language-agnostic - 单个 if 语句中谓词的正确平衡在哪里？

> ID：746956
> 
> 赞同：11
> 
> 时间：2009-04-14T10:02:30.260
> 
> 标签：language-agnostic, coding-style

我个人对以下代码没有问题

```
if (Object foo != null && !String.IsNullOrEmpty(foo["bar"]))
{
    // do something
} 
```

因为我认为以下内容过于冗长

```
if (Object foo != null)
{
    if (!String.IsNullOrEmpty(foo["bar"]))
    {
        // do something
    }
} 
```

但是，如果说有 5 个谓词并且我必须将文本包装在编辑器中以一次查看它们，那么我不会在这个观点上走得太远，是否有一条逻辑“线”来说明你有多少个谓词包含在单个 if 语句中，类似于说方法不应需要超过 7 个参数

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-14T10:55:54.607

我不认为将 if 语句重写为两个是方法，特别是如果您认为`else`在示例中添加子句会产生不同的结果。如果我想减少条件中的原子命题的数量，我会将一些有意义的因素一起考虑到它们自己的函数中，例如：

```
if(won_jackpot(obj)) ... 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-14T10:09:06.577

我认为这是不同类型的运算符和正确格式的平衡。如果所有运算符都相同（所有“和”或所有“或”），那么您可能可以将不定数量的表达式连接在一起而不会失去理解：

```
if (something() &&
    something_else() &&
    so_on() &&
    so_forth() &&
    some_more_stuff() &&
    yada() &&
    yada() &&
    yada() &&
    newman() &&
    soup_nazi() &&
    etc())
  ... 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-14T10:48:55.937

短期记忆有七个项目的容量，给予或接受两个。这意味着一个涉及超过五个不同对象的表达式可能需要一个人停下来思考一下。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-14T10:09:48.837

我不相信有一个神奇的数字。如果所有谓词一起有意义，那么我会将它们放在一起。这可能涉及将 if 语句分成两行，但我通常从不引入多余的 if 语句。但如果特别长，你应该问问自己，所有的陈述是否真的有必要。也许您可以更早地过滤掉一些值或类似的东西。最大的担忧是可读性。如果其他人难以理解，则需要重构代码。但是将代码分成两个不同的 if 语句很少会使代码更具可读性，它只会占用更多的行。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-14T10:05:41.390

不是谓词的数量，而是复杂性。只要您能以最小的努力理解代码的作用，对我来说就可以了。

除此之外，我不会更改为多个 if，但我为谓词添加了一个函数。特别是如果在多个地方使用相同数量的谓词。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-14T10:09:32.737

这取决于你在做什么。当您反转第二条语句时，它会产生不同的结果。（在它前面添加一个“not”）并且是一个非常常见的错误来源。

我已经看到了包含大约 20 个谓词的代码，它们可以工作（或者至少，工作得很好！）我使用的经验法则，如果它看起来像狗晚餐，我会考虑重构。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-14T10:07:18.827

但是，我认为没有任何规则：

1.  它是否足够复杂，以至于当您将其展示给其他人时，他们很难理解？
2.  它需要覆盖多行吗？
3.  您是否在多个“if”子句中重复条件检查？这将指向需要重构为某些方法

如果上述任何一项适用，我会重新设计它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-14T11:55:37.850

条件列表长的问题与其说是*可读性的损失，不如说是**可测试性*的损失。特别是在处理错误的方法参数时，有时请求宽恕而不是许可确实更容易（例如，请参阅[此问题](https://stackoverflow.com/questions/610883/how-to-know-if-an-object-has-an-attribute-in-python)的答案）。这样你就可以保持你的代码干净和可测试，或者修复调用者或者让他们处理产生的异常。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-14T21:10:53.523

这一切都取决于需要做什么。但是您可能想要研究的一件事会使某些算法不那么冗长，那就是 switch 语句：

```
switch (myVal)
{
    case "isThis":
    case "isThat":
    case "something else":
        doThis();
        break;
    case "another":
    case "yet another":
    case "even another":
        doThat();
        break;
    case "another one":
    case "more more":
        doThisAgain();
        break;
}
```

在 if else 语句中这样做会非常冗长。有些代码需要大量的 if 和 else 语句，有些可以被压缩，等等。永远不要为了代码源的美观而牺牲代码执行的质量。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-14T21:15:34.900

哪种方式更好？两者都不。两者的语义不同。

我同意虽然拆分使调试更容易，但条件断点也是如此:)

如果是 'AND's 或 'OR's 的简单组合超过 3 个测试，则重构它。

# apache-flex - 标签组件上的 Flex/Actionscript truncateToFit

> ID：746962
> 
> 赞同：0
> 
> 时间：2009-04-14T10:04:01.707
> 
> 标签：apache-flex, actionscript, label, truncation

我的 Flex 应用程序中有许多标签，它们的“truncateToFit”属性设置为 true。问题是，它不会在任何截断文本的末尾显示“...”，而是显示空值。

即，如果我的标签文本是：“Hello Stackoverflow！” 我可能希望我的标签看起来像这样：

“你好斯塔科夫……”

相反，它显示

“你好 Stackovnull”

任何帮助都会很有用！

[截断的外观示例](http://blog.flexexamples.com/2008/01/26/truncating-text-in-the-flex-label-control-using-the-truncatetofit-property/#more-483)

编辑： - 示例代码：

```
<mx:HBox width="200" ... >
   <mx:Label maxWidth="150" truncateToFit="true" text="Really long text.Really long text.Really long text.Really long text.Really long text" />
</mx:HBox> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T13:37:30.430

哈哈！我找到了解决方案。对不起，伙计们 - 可能是我缺乏信息，这让你们很难为 m 调试 :(

所以，无论如何 - 事实证明我有一个外部 resourceModule swf，我的应用程序加载它以从中获取本地化语言数据等 - 该文件不包含有关为截断显示哪些文本的一些数据（即“...”）所以它改为显示'null'。我将该数据添加到 Resource swf 中，并且一切都按预期工作。

感谢一百万试图帮助我的家伙。;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-02T21:38:54.867

问题是默认的 Flex 资源包之一未包含在您编译的本地化文件中。有关详细说明和修复，请参见此处：http: [//deniszgonjanin.posterous.com/flex-truncation-null-error-fix](http://deniszgonjanin.posterous.com/flex-truncation-null-error-fix)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T04:50:32.010

我刚刚尝试了您的示例代码，它运行良好。你确定不是别的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-18T05:30:25.120

所以我去嵌入了我自己的字体，它可以很好地截断，没有任何特别的问题。我不确定您是如何嵌入字体的，但这种方法对我有用。如果您正在做一些完全不同的事情，请在您的帖子中指定。

```
// Cannot name the font as one that already exists!
[Embed(source="Anonymous.ttf", fontFamily="myAnon")]
private var fontA : Class;

[Embed(source="HGRSGU.TTC", fontFamily="myFont")]
private var fontB : Class;

//...I have some code here that switches the font
var obj : Object = truncateMe.getStyle("fontFamily");
if (obj == "myAnon")
  truncateMe.setStyle("fontFamily", "myFont");
else
  truncateMe.setStyle("fontFamily", "myAnon");

<!-- My Label -->
<mx:Label maxWidth="150" truncateToFit="true" id="truncateMe"
    text="Something really long goes here" fontFamily="myFont" fontSize="20"/> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-05T03:22:16.943

如果使用多个语言环境，请确保将“en_US”添加到您的语言环境链。例如：resourceManager.localeChain = ['pt_BR', 'en_US'];

在以下位置找到解决方案：http: [//blog.flexexamples.com/2008/01/26/truncate-text-in-the-flex-label-control-using-the-truncatetofit-property/](http://blog.flexexamples.com/2008/01/26/truncating-text-in-the-flex-label-control-using-the-truncatetofit-property/)

查找 Leandro 的帖子

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-06T15:18:53.477

我今天（3 小时）在这个问题上进行了一场激烈的斗争，对于这样一个小问题来说，这太过分了。无论如何，以上提示都没有解决我的问题。我都试过了。我最终做了自己的课程，扩展了`mx.controls.Label`课程。实现如下。随意在您的项目中使用它。请注意，使用此选项时，您应该禁用 mxml 中的 truncateToFit。否则，“null”字符串将附加到您的文本中，并且不会进行截断。

代码：

```
package com.feijk.UI {
    import mx.controls.Label;

    /**
     * An extension for mx.controls.Label to truncate the text and show
     * a tooltip with the full-length content. This sub-class is meant to be
     * used when the regular truncateToFit does result in a "null" appendix
     * on the string instead of the "...". In order for this to work, I used
     * the following parameters in my mxml: 
     * 
     *  - truncateToFit = false
     *  - maxWidth = set
     *  - width = set
     * 
     * 
     * @author Tomi Niittumäki // Feijk Industries 2010
     * @NOTE: Feel free to use! :)
     */
    public class FLabel extends Label{

        // define the truncation indicator eg. ...(more) etc.
        private const TRUNCATION_INDICATOR:String = new String("...");

        /**
         * Constructor
         */
        public function FLabel(){
            super();
        }

        /**
         * The overriding method, which forces the textField to truncate
         * its content with the method truncateToFit(truncationIndicator:String)
         * and then supers the tooltip to be the original full-length text.
         */
        override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void{
            super.updateDisplayList(unscaledWidth, unscaledHeight);
            //trace("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!: "+textField.text);
            textField.truncateToFit(TRUNCATION_INDICATOR);
            super.toolTip = text;
        }

    }
} 
```

# perl - 在 Perl 中如何管理配置文件？

> ID：746972
> 
> 赞同：17
> 
> 时间：2009-04-14T10:07:25.333
> 
> 标签：perl, configuration

我有一个程序必须从 PHP 脚本中读取配置文件，通过快速搜索发现在 Perl 中有多种处理配置文件的方法：

*   [在单独的文件中配置数据](http://www.perlmonks.org/?node_id=464358)
*   [应用配置](http://search.cpan.org/dist/AppConfig/lib/AppConfig.pm)
*   [配置::常规](http://search.cpan.org/perldoc?Config::General)
*   [配置::IniFiles](http://search.cpan.org/dist/Config-IniFiles/lib/Config/IniFiles.pm)
*   [配置::范围](http://search.cpan.org/dist/Config-Scoped/lib/Config/Scoped.pm)
*   [配置::简单](http://search.cpan.org/perldoc?Config::Simple)
*   [配置读取器::简单](http://search.cpan.org/dist/ConfigReader-Simple/lib/Simple.pm)
*   和许多其他人

[Brian在这里](https://www.masteringperl.org/2013/07/new-to-configuration/)提供了一个概述。

Config::Simple 对我有用，因为现有文件类似于 INI。我很想知道人们经常在他们的代码中使用什么风格？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-14T18:00:40.453

我非常喜欢使用[YAML](http://search.cpan.org/dist/YAML/lib/YAML.pm)配置文件。我发现它们非常易读且易于操作。它们很自然地适合 Perl，主要的构造是数组和哈希。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-14T11:39:20.837

一种解决方案是使用[Config::Any](http://search.cpan.org/~bricas/Config-Any-0.17/lib/Config/Any.pm)并让用户从许多选项中进行选择。就个人而言，我更喜欢 Config::General。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-14T10:09:51.910

你要问的一个问题*是观众是什么*？也就是说，您是否乐意让您的目标受众（配置文件用户/修改器）更改 Perl 代码，或修改类似 .INI 的文件。这肯定会在某种程度上推动你的决定。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T05:57:25.003

如果受众是技术人员（习惯于格式化数据结构），那么我喜欢使用 JSON 进行配置。在你的程序中，它就像你使用 YAML 一样工作，但对我来说它更容易阅读（而且我们使用了大量的 JSON）。

如果您使用 JSON::XS，则有一个“宽松”选项，允许在文件中使用注释和尾随逗号等。

# asp.net - 修改 Web 客户端软件工厂生成模板以使用 Web 应用程序项目

> ID：746973
> 
> 赞同：0
> 
> 时间：2009-04-14T10:07:55.923
> 
> 标签：asp.net, wcsf

默认情况下，WCSF 使用网站模型，但我想将其更改为使用 Web 应用程序模型。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T07:41:38.210

看这里：http: [//msdn.microsoft.com/en-us/library/cc304890.aspx](http://msdn.microsoft.com/en-us/library/cc304890.aspx)

“...使用模板名称中带有标识符“WAP”的模板来创建使用 Web 应用程序项目模型的网站。...”

# seo - 相同页面的 SEO 问题，辅助内容略有不同（以不同语言显示）

> ID：746977
> 
> 赞同：3
> 
> 时间：2009-04-14T10:09:51.443
> 
> 标签：seo, multilingual

如果搜索引擎可以在 2-3 种变体中看到相同的页面，其中主要内容保持不变但一些次要信息不同，是否会出现任何问题？

例子。让我们想象一个论坛主题可以通过几个 URL 到达：

```
http://www.mysite.com/threads/en/12345
http://www.mysite.com/threads/de/12345
http://www.mysite.com/threads/fr/12345 
```

如您所见，主要的用户生成内容（将构成超过 90% 的可见文本）将是相同的，但一些辅助信息，如标签和链接（“查看个人资料”、“发送消息”、“报告滥用”等）将以不同的语言出现。

该组织的原因是我希望用户能够直接以他们的首选语言为页面添加书签。

那么，从 SEO 的角度来看，这种方法是好是坏？我想它会是。这些链接都属于我的网站，而不仅仅是分散在网络上各种资源上的其他副本，这有关系吗？

如果这种做事方式不好，我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T10:18:50.157

If that is all you are doing, it is likely to hurt your SEO. There is, however, a workaround. Google supports the rel="canonical" attribute to tell it what is the "real" url of the page you are linking to. I have no idea how much this affects SEO and whether other search engines support it, but this is a good place to start:

[http://googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html](http://googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T18:58:07.227

Google 会将其视为重复内容。这根本不会导致任何形式的惩罚，但只会将其中一个页面编入索引（可能是 Google 认为最好的那个页面）。

也许设置适当的语言 HTTP 标头/HTML 元标记会有所帮助，如果 Google 足够聪明，可以考虑到这一点。

# postgresql - 从 PostgreSQL 中的时间间隔获取某些星期几（周末）的数量

> ID：746980
> 
> 赞同：3
> 
> 时间：2009-04-14T10:10:01.723
> 
> 标签：postgresql, intervals, dayofweek

给定 postgres 中的 2 个时间戳，如何在不计算整个周六和周日的情况下计算时差？

或者

您如何计算给定时间间隔内的星期六和星期日的数量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T12:37:39.737

以下函数返回两个日期之间的完整周末天数。由于您需要一整天，您可以在调用函数之前将时间戳转换为日期。如果第一个日期不是严格在第二个日期之前，它会返回 0。

```
CREATE FUNCTION count_full_weekend_days(date, date)
  RETURNS int AS
$BODY$
  SELECT
    ($1 < $2)::int
      *
    (
      (($2 - $1) / 7) * 2
        + 
      (EXTRACT(dow FROM $1)<6 AND EXTRACT(dow FROM $2)>0 AND EXTRACT(dow FROM $1)>EXTRACT(dow FROM $2))::int * 2
        +
      (EXTRACT(dow FROM $1)=6 AND EXTRACT(dow FROM $2)>0)::int
        +
      (EXTRACT(dow FROM $2)=0 AND EXTRACT(dow FROM $1)<6)::int
    );
$BODY$
  LANGUAGE 'SQL' IMMUTABLE STRICT; 
```

例子：

```
SELECT COUNT_FULL_WEEKEND_DAYS('2009-04-10', '2009-04-20');
# returns 4

SELECT COUNT_FULL_WEEKEND_DAYS('2009-04-11', '2009-04-20');
# returns 3 (11th is Saturday, so it shouldn't be counted as full day)

SELECT COUNT_FULL_WEEKEND_DAYS('2009-04-12', '2009-04-20');
# returns 2 (12th is Sunday, so it shouldn't be counted as full day)

SELECT COUNT_FULL_WEEKEND_DAYS('2009-04-13', '2009-04-20');
# returns 2 
```

要获得除周末全天以外的天数，只需从上面的函数中减去天数：

```
SELECT
  '2009-04-20'::date
    -
  '2009-04-13'::date
    -
   COUNT_FULL_WEEKEND_DAYS('2009-04-13', '2009-04-20'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-08T22:16:02.737

你可能会发现这真的很有帮助：

```
CREATE OR REPLACE FUNCTION working_days(date, date) RETURNS INT AS
$$
SELECT COUNT(days)::INT
    FROM generate_series($1, $2, '1 day') AS days
    WHERE EXTRACT(DOW FROM days) NOT IN(0, 6);
$$
LANGUAGE 'sql' IMMUTABLE STRICT; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T10:29:19.290

(days/7)*2 + 最近 (days%7) 天的周六/周日数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T11:05:03.433

这应该回答您问题的第二部分：

```
create or replace function is_weekend_day(date) returns boolean
 strict immutable language 'sql'
 as $$ select case extract(dow from $1) when 0 then true when 6 then true else false end $$;

create or replace function count_weekend_days(start_date date, end_date date) returns int
 strict immutable language 'sql'
 as $$
select cast(sum(case when is_weekend_day($1 + ofs) then 1 else 0 end) as int)
from generate_series(0, $2 - $1) ofs
$$; 
```

之后进行对应就很`count_non_weekend_days`简单了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T11:19:09.000

最好的解决方案是使用日历表。这非常有用，您可以做各种有趣的事情——包括计算两个日期之间的工作日数或计算两个日期之间的假期数。

该表通常是提前填充的——比如 20 年，并适当标记了众所周知的假期的日期。如果假期发生变化，您会不时维护表格以将日期标记为假期。 [更多信息在这里](http://web.archive.org/web/20070611150639/http://sqlserver2000.databases.aspfaq.com/why-should-i-consider-using-an-auxiliary-calendar-table.html)和[这里](http://www.intelligententerprise.com/db_area/archives/1999/992112/celko.jhtml)。这使用 MS SQL Server，但也很容易移植。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T11:34:38.853

您可能会发现这篇博文很有帮助： http: [//www.depesz.com/index.php/2007/12/27/how-many-1sts-of-any-month-were-sundays-since-1901-01-01 /](http://www.depesz.com/index.php/2007/12/27/how-many-1sts-of-any-month-were-sundays-since-1901-01-01/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-02T19:26:29.103

这将计算两个日期之间某一天的数量：

```
-- 0 Sunday
-- 1 Monday
-- 2 Tuesday
-- 3 Wednesday
-- 4 Thursday
-- 5 Friday
-- 6 Saturday

WITH rng AS (
  SELECT
      'march 3 2013'::date AS start,
      'march 3 2014'::date AS end,
      0                    AS day -- Sunday
)

SELECT count(1)
FROM rng, generate_series(0, (extract(epoch from age(rng.end, rng.start)) / (60*60*24))::int) AS n
WHERE extract(dow from rng.start + (n * '1 day'::interval)) = rng.day 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-09-29T17:47:56.473

我建议您创建一个随时使用的函数，并且少写一些；)

上面的代码将创建一个计算并返回周末天数 (Sat, Sun) 的 sql 函数。就像您可以更灵活地使用此功能一样。

```
CREATE OR REPLACE FUNCTION <YourSchemaNameOptional>.count_full_weekend_days(date, date)
RETURNS bigint AS
$BODY$
        select  COUNT(MySerie.*) as Qtde
        from    (select  CURRENT_DATE + i as Date, EXTRACT(DOW FROM CURRENT_DATE + i) as DiaDate
                 from    generate_series(date ($1) - CURRENT_DATE,  date ($2) - CURRENT_DATE ) i) as MySerie
        WHERE   MySerie.DiaDate in (6,0);
$BODY$
LANGUAGE 'SQL' IMMUTABLE STRICT; 
```

之后，您可以使用该函数**仅返回**间隔中的周末天数。这是要使用的示例：

```
SELECT <YourSchemaNameOptional>.count_full_weekend_days('2017-09-11', '2017-09-25') as days; --> RES: 4 
```

此选择必须返回 4，因为第一天和第二天是星期一，并且它们之间有 2 个星期六和 2 个星期日。

现在，*要***根据需要仅返回工作日**（不包括周末），只需进行减法，如下例所示：

 *```
SELECT (date '2017-09-25' - date '2017-09-11' ) - <YourSchemaName>.count_full_weekend_days('2017-09-11', '2017-09-25'); --> RES: 14 - 4 = 10 
```

# sql - Sql Server 中浮点数的左侧

> ID：746984
> 
> 赞同：3
> 
> 时间：2009-04-14T10:13:03.230
> 
> 标签：sql, sql-server, sql-server-2005

我有一个查询返回一列浮点数，但我只对小数位前的数字感兴趣。我不想四舍五入，所以我正在寻找类似的东西：

```
1.95 = 1
1.45678 = 1
12.00 = 12
12.9999 = 12 
```

除了做一个子字符串之外，有没有一种简单的方法可以在 SqlServer 中实现这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T10:18:13.577

你可以这样做 -

```
SELECT CAST(1.230 AS INT) 
```

输出：1

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T10:17:27.273

您可以使用[地板功能](http://msdn.microsoft.com/en-us/library/ms178531.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T10:22:32.800

您可以使用`ROUND(expression, 0, 1)`截断 T-SQL 中的数字。请参阅[MSDN](http://msdn.microsoft.com/en-us/library/ms175003.aspx)以供参考。

# asp.net - ASP.NET Repeater 控件还是自定义实现？

> ID：746986
> 
> 赞同：0
> 
> 时间：2009-04-14T10:13:28.610
> 
> 标签：asp.net, user-controls, repeater

你好，

最近，我在各种网站和博客上阅读了几篇文章，其中 ASP.NET Repeater 是经验丰富的程序员最常用和接受的一种。有人实际上写道，如果他提到他经常在工作面试中使用此控件，他会更好地考虑 asp.net 程序员。我很少使用它的事实可能使我成为初学者:) 这是我在需要动态重复一些控制时使用的实现。

```
public class MyUserControl:UserControl
{
    LocalizedCheckBox chb;
    LocalizedLabel lbl;
    TextBox txt;

    public MyUserControl()
    {
        //Instantiate controls
    //do something with them
}

public bool Checked
{
    get{ return chb.Checked;}
}
public string Text
{
    get{ return txt.Text; }
}
}

public partial class MyParentControl : System.Web.UI.UserControl
{
    protected void Page_Load(object sender, EventArgs e)
    {
        //           
    }
protected override void OnInit(EventArgs e)
    {
        base.OnInit(e);

    foreach('something')
    {
        MyUserControl ctr = new MyUserControl();
        ctr.Text="some value";
        ctr.Checked= false;
        this.Panel1.Controls.Add(ctr);
    }
    }
protected void btn_Click(object sender, EventArgs e)
    {
        foreach (MyUserControl dControl in this.Panel1.Controls.OfType<MyUserControl>())
        {
            //do something
    string text = dControl.Text;
        }
    }
} 
```

即使我在 MyUserControl 上添加了事件，我也从未遇到过此代码的问题。当然，使用中继器控制也可以达到同样的效果，但我想知道为什么（或者是否）更好地使用中继器。

如果我改用中继器有什么好处？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T10:46:34.257

中继器很容易绑定到数据源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T13:12:03.330

伙计，您最好在 Net 3.5 中使用中继器或更好地使用 listvew，为什么？- 因为数据绑定到任何数据源都非常容易，使用 Eval 控制其中的控件。- 你有很多你喜欢的模板，当数据库没有返回结果时，我经常使用它，你可以在这里放一条消息来通知用户而不是显示空白屏幕。- 你可以控制渲染，你想要Tables，Div，UL，你只要命名它。

我强烈建议投资新的列表视图来重复内容。

希望这可以帮助

# image - Fortran 77 POSIX 是否符合？- 编写二进制文件

> ID：746987
> 
> 赞同：2
> 
> 时间：2009-04-14T10:13:58.313
> 
> 标签：image, file, posix, fortran77

我正在尝试从 fortran 编写二进制数据文件，但我发现常规文件接口非常有限，我想知道 Fortran 是否具有 POSIX 编译功能。

我找到了这个标准：[IEEE 1003.9-1992](http://ieeexplore.ieee.org/servlet/opac?punumber=2891)，但我不知道大多数常见编译器是否完全支持它（或者我是否必须激活任何标志）。我找不到任何实用信息，您能给我一些建议吗？

顺便说一句，我正在尝试编写图像文件，首先我想尝试使用[tga/pgm](http://orion.math.iastate.edu/burkardt/data/pgm/pgm.html)。另外我不想向外部库添加任何依赖项，谢谢！

**解决方案：**

最后我可以写[ppm 文件](http://netpbm.sourceforge.net/doc/ppm.html)了，我不得不[避免在内部循环结束时打印换行符](http://objectmix.com/fortran/360505-how-print-string-without-newline-ending-2.html#post1332439)，最终代码是这样的：

```
 subroutine imgwrite()
      implicit none
*     ******************************************************************
      include 'image.f'
*     ******************************************************************
      integer x, y, i

      write(imgunit, '(A)') 'P3'
      write(imgunit, '(I4)') imgwidth
      write(imgunit, '(I4)') imgheight
      write(imgunit, *) 255

      do 10 y=1, imgheight
        do 20 x=1,imgwidth
          write(imgunit,100) (int(imgpixels(x,y,i)*255D0), i=1,3)
20      continue
        write(imgunit,110)
10    continue

100   FORMAT(3(I4),$)
110   FORMAT((/))

      return
      end 
```

没有人在 FORTRAN 中提供有关 POSIX 的任何信息。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T10:21:06.360

TGA 是一种非常简单的格式，即使它是二进制的，所以应该可以从 FORTRAN 中编写它。但是，如果没有外部库的帮助，我不想在 FORTRAN 中尝试 TIFF、PNG、GIF 或 JPG。

您可能会发现[netpbm](http://netpbm.sourceforge.net/)格式系列中的一种更易于编写，并且可以轻松地将它们转换为 TGA 或您可能需要使用简单命令进行显示或进一步处理的任何其他格式。PBM 格式包括纯 ASCII 和二进制风格，因此即使二进制文件访问存在问题，也可以编写它们（尽管效率很低）。该工具套件包括与大约 100 种其他图像文件格式之间的转换。

**编辑：**抱歉，对于如何从 FORTRAN 编写文件，我无法提供更多帮助，但是当我上次使用该语言时，打孔卡很常见。;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-31T17:33:17.213

读写二进制文件（随机或顺序）以供其他语言使用的问题是 fortran io 系统使用文件中的其他信息。我不记得它在 f77 标准中，但肯定大多数 pc 和 unix 编译器都这样做了。

例如，如果写入二进制顺序文件

```
write(bsf) doublevariable, realvariable 
```

那么文件将包含（如果您可以读取二进制文件）

```
12<value of double><value of real>12 
```

每条记录都有记录标记，它们是在前端和末端写入的字节长度。这是必需的，因为每条记录可以具有不同的长度，并且在读取时不必读取为记录编写的所有内容。例如，如果一个人正在阅读上述内容，则可能有

```
read(bsf) doublevariable 
```

bsf 的下一次读取需要在下一条记录的开头。

因此，应该通过用 C 或任何不执行 Fortran 功能的语言编写的库来读取或写入二进制文件以与其他语言共享，

# wpf - WPF：树视图中的图标

> ID：746995
> 
> 赞同：0
> 
> 时间：2009-04-14T10:20:05.147
> 
> 标签：wpf, treeview, icons

请帮助WPF中的新手！

当 Treeview 绑定到 XML 数据文件时，我需要在 TreeViewItems 中使用图标+文本构建 TreeView。

这是我的 XML：

```
<Root>
<Node Name="AAA" Image="images/1.ico" />
<Node Name="BBB" Image="images/2.ico">
    <ChildNode Name="bbb 1" Image="images/3.ico">
        <GrandchildNode Name="b 1.1" Image="images/4.ico"/>
        <GrandchildNode Name="b 1.2" Image="images/5.ico"/>
        <GrandchildNode Name="b 1.3" Image="images/6.ico"/>
    </ChildNode>
    <ChildNode Name="bbb 2" Image="images/7.ico"/>
    <ChildNode Name="bbb 3" Image="images/8.ico">
        <GrandchildNode Name="b 3.1" Image="images/9.ico"/>
        <GrandchildNode Name="b 3.2" Image="images/10.ico"/>
    </ChildNode>
    <ChildNode Name="bbb 4" Image="images/11.ico"/>
</Node>
<Node Name="CCC" Image="images/12.ico">
    <ChildNode Name="ccc 1" Image="images/13.ico">
        <GrandchildNode Name="c 1.1" Image="images/14.ico"/>
        <GrandchildNode Name="c 2.2" Image="images/15.ico"/>
    </ChildNode>
</Node></Root> 
```

提前致谢！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T13:10:23.303

使用 TreeView.ItemTemplate 为显示所需内容的项目创建模板。

```
<TreeView ItemsSource="{Binding Source={StaticResource myItemsSource}}">
  <TreeView.ItemTemplate>
    <HierarchicalDataTemplate>
      <StackPanel Orientation="Horizontal">
        <Image Source="{Binding Image}" Margin="0,0,5,0" />
        <TextBlock Text="{Binding Name}" />
      </StackPanel>
    </HierarchicalDataTemplate>
  </TreeView.ItemTemplate>
</TreeView> 
```

编辑：我复制并快速修改了上面的 XAML，没有多想。刚刚意识到给定的绑定对您不起作用，因为您的数据源是 XML。没有时间纠正这个问题，但这个想法应该是不言而喻的，足以帮助你。

# .net - 覆盖 ASP.NET MVC 中的授权属性

> ID：746998
> 
> 赞同：83
> 
> 时间：2009-04-14T10:21:05.767
> 
> 标签：.net, asp.net-mvc, security, authentication, authorize

我有一个 MVC 控制器基类，我在其上应用了 Authorize 属性，因为我希望几乎所有的控制器（以及它们的动作）都被授权。

但是，我需要一个控制器和另一个未经授权的控制器的操作。我希望能够用`[Authorize(false)]`或其他东西来装饰它们，但这不可用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2009-04-14T11:56:23.683

编辑：由于 ASP.NET MVC 4，最好的方法就是使用内置的[AllowAnonymous](http://msdn.microsoft.com/en-us/library/system.web.http.allowanonymousattribute%28v=vs.108%29.aspx)属性。

下面的答案是指早期版本的 ASP.NET MVC

您可以使用可选的 bool 参数创建从标准 AuthorizeAttribute 继承的自定义授权属性，以指定是否需要授权。

```
public class OptionalAuthorizeAttribute : AuthorizeAttribute
{
    private readonly bool _authorize;

    public OptionalAuthorizeAttribute()
    {
        _authorize = true;
    }

    public OptionalAuthorizeAttribute(bool authorize)
    {
        _authorize = authorize;
    }

    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        if(!_authorize)
            return true;

                    return base.AuthorizeCore(httpContext);
    }
} 
```

然后您可以使用该属性装饰您的基本控制器：

```
[OptionalAuthorize]
public class ControllerBase : Controller
{
} 
```

对于任何不需要授权的控制器，只需使用带有“假”的覆盖 - 例如

```
[OptionalAuthorize(false)]
public class TestController : ControllerBase
{
    public ActionResult Index()
    {
        return View();
    }
} 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2012-04-25T12:16:47.370

似乎 ASP.NET MVC 4 通过添加[AllowAnonymous](http://msdn.microsoft.com/en-us/library/system.web.http.allowanonymousattribute%28v=vs.108%29.aspx)属性“修复”了这个问题。

[大卫海登写道](http://www.davidhayden.me/blog/asp.net-mvc-4-allowanonymous-attribute-and-authorize-attribute)：

```
[Authorize]
public class AccountController : Controller
{
    [AllowAnonymous]
    public ActionResult Login()
    {
        // ...
    }

    // ...
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-14T17:50:40.977

我个人对此的看法是拆分控制器。只需为不需要身份验证的操作创建另一个控制器。

或者你可以有：

*   `BaseController`
    不需要身份验证 - 在这里你有你所有的“基本东西”:)。

*   `BaseAuthController : BaseController`
    这里的所有操作都需要身份验证。

这样，您就可以在需要时进行身份验证，只需从特定类派生即可。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-18T07:27:16.553

如果您只想在其他授权的控制器上进行一项未经授权的操作，您可以执行以下操作：

```
public class RequiresAuthorizationAttribute : ActionFilterAttribute
{
    private readonly bool _authorize;

    public RequiresAuthorizationAttribute()
    {
        _authorize = true;
    }

    public RequiresAuthorizationAttribute(bool authorize)
    {
        _authorize = authorize;
    }

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var overridingAttributes = filterContext.ActionDescriptor.GetCustomAttributes(typeof (RequiresAuthorizationAttribute), false);

        if (overridingAttributes.Length > 0 && overridingAttributes[0] as RequiresAuthorizationAttribute != null && !((RequiresAuthorizationAttribute)overridingAttributes[0])._authorize)
            return;

        if (_authorize)
        {
            //redirect if not authenticated
            if (!filterContext.HttpContext.User.Identity.IsAuthenticated)
            {
                //use the current url for the redirect
                var redirectOnSuccess = filterContext.HttpContext.Request.Url.AbsolutePath;

                //send them off to the login page
                //var redirectUrl = string.Format("?RedirectUrl={0}", redirectOnSuccess);
                var loginUrl = LinkBuilder.BuildUrlFromExpression<HomeController>(filterContext.RequestContext, RouteTable.Routes,
                                                                                  x => x.Login(redirectOnSuccess));
                filterContext.HttpContext.Response.Redirect(loginUrl, true);
            }
        }
    }
} 
```****************