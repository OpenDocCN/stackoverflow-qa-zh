# StackOverflow 问答 000519000-000519999

# winforms - 如何防止即时调试器在 WebBrowser 控件中发生脚本错误时显示

> ID：519001
> 
> 赞同：4
> 
> 时间：2009-02-06T03:45:18.810
> 
> 标签：winforms, jit, web-controls

我在我的 Winforms 应用程序中使用了 WebBrowser 控件。当我导航到导致 JavaScript 异常的 Url 时，会显示即时 (JIT) 调试器窗口，询问您是否要调试此异常：

> （应用程序）中发生未处理的异常（“预期对象”）

即使我将WebBrowser 控件上的**ScriptErrorsSuppressed设置为****True** ，也会发生这种情况（在发布模式下） 。我只能在安装 Visual Studio 时重现该问题，因此我假设 JIT 调试器捕获了异常，然后询问您是否要调试。

我怎样才能防止这种情况发生？我要做的是捕获异常或禁用我的应用程序的 JIT 调试，**而无需重新配置 IE 或 Visual Studio。**

我们的一些用户安装了 Visual Studio，这些 JIT 弹出窗口使我们的应用程序无法使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T05:34:12.070

有关如何禁用 JIT 调试器的信息，请参阅此链接。简短版本是以管理员身份打开 Visual Studio 并导航到工具 -> 选项 -> 调试器 -> JIT 调试

[http://msdn.microsoft.com/en-us/library/k8kf6y2a.aspx](http://msdn.microsoft.com/en-us/library/k8kf6y2a.aspx)

# .net - LINQ to SQL - 有选择地改变形状的部分类

> ID：519005
> 
> 赞同：0
> 
> 时间：2009-02-06T03:46:07.170
> 
> 标签：.net, linq, linq-to-sql

**是）我有的：**

LINQ to SQL 自动生成的类，对应其 SQL 表的形状。

```
表
========
第 1 列
第 2 列

```

**我想做的事：**

扩展 TABLEA 类以包含一个新属性，该属性的相关列仅在调用特定存储过程时才会出现。存储过程返回类型将是 TABLEA。

```
表
========
第 1 列
第 2 列
newcolumn3（总是类结构的一部分，并不总是填充）   

```

**到目前为止我所做的：**

创建了一个具有属性和列属性的部分类，该类在调用存储过程时起作用。进行直接表调用时，我得到一个无效的列异常。

**我的问题是：**

如何扩展我的 LINQ to SQL 数据类以从可能不存在的列中填充属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T03:49:08.663

我不认为这是可能的。LINQ to SQL 的重点是提供返回集架构和 .NET 中的对象之间的直接映射。两个不同的返回集模式，两个不同的对象。如果返回的签名不同，您不能真正将存储过程视为返回相同的对象。它更像是“ObjectWithAdditionalInfo”。

当你开始做这些更复杂、更模糊的映射时，你需要一个真正的 ORM 工具，比如 Microsoft Entities 或 Hibernate。

# php - php 文件操作函数在我的本地主机上失败，说权限被拒绝

> ID：519008
> 
> 赞同：-1
> 
> 时间：2009-02-06T03:46:24.393
> 
> 标签：php, file-manipulation

我在 windows xp 上运行，我是管理员，
我使用他们网站上提供的最新 xampp 包，当我在 php 上使用文件操作功能时，我收到这些类型的错误...

```
Warning: chmod() [function.chmod]: Permission denied in...
Warning: opendir(/feeds) [function.opendir]: failed to open dir: Permission denied in 
```

在我可以使用这些功能之前，我需要为 apache 设置任何环境变量吗？
但我认为问题仅在于我的文件夹访问权限，但如果是这样，
我如何在 Windows 上设置文件夹的可访问性属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T03:47:56.823

您的 php 工作进程是否具有必要的权限？

确保该进程正在运行的任何用户对其正在呕吐的目录具有适当的权限。

右键文件夹，权限...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T04:12:10.927

看来我的脚本引用了一个不存在的目录，因为我刚刚指定`$dir='/feeds';`

它在我们办公室的机器上运行良好，但我想知道为什么在我家的电脑上使用相同的配置它不能

作为其他可能有同样问题的人的参考将来我的答案将是

检查并确保您将脚本指向正确的文件:)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-06T03:53:51.897

您也可以尝试在 chmod 之前设置 umask；

```
$old_mask = umask(0);
chmod('/path/to/file', 0755);
umask($old_mask); 
```

有关 umask 的更多信息，请参阅[PHP 手册](http://us2.php.net/umask)

# sql - 将子选择值与主选择中的值进行比较

> ID：519010
> 
> 赞同：0
> 
> 时间：2009-02-06T03:47:11.850
> 
> 标签：sql, ms-access, subquery

在 MS Access 中，我有一个查询，我想使用外部查询中的列作为内部查询中的条件：

```
SELECT P.FirstName, P.LastName, Count(A.attendance_date) AS CountOfattendance_date,
       First(A.attendance_date) AS FirstOfattendance_date,
       (SELECT COUNT (*) 
          FROM(SELECT DISTINCT attendance_date 
                FROM tblEventAttendance AS B 
                WHERE B.event_id=8 
                  AND B.attendance_date >= FirstOfattendance_date)
       ) AS total
FROM tblPeople AS P INNER JOIN tblEventAttendance AS A ON P.ID = A.people_id
WHERE A.event_id=8
GROUP BY P.FirstName, P.LastName
; 
```

关键点是`FirstOfattendance_date`- 我希望子选择中的比较深入使用主选择的每次迭代中的值。显然这不起作用，它会询问我`FirstOfattendance_date`何时尝试运行它的值。

我想在不诉诸VB代码的情况下做到这一点......有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T10:19:40.153

怎么样：

```
SELECT 
     p.FirstName,
     p.LastName,
     Count(a.attendance_date) AS CountOfattendance_date,
     First(a.attendance_date) AS FirstOfattendance_date,
     c.total
FROM (
     tblPeople AS p 
INNER JOIN tblEventAttendance AS a ON 
     a.people_id = p.ID) 
INNER JOIN (SELECT people_id, Count (attendance_date) As total
            FROM (
                SELECT DISTINCT people_id,attendance_date
                FROM tblEventAttendance) 
            Group By people_id) AS c ON 
     p.ID = c.people_id
GROUP BY 
     p.ID, c.total; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T04:03:21.740

你能改变吗

B.attendance_date >= FirstOfattendance_date

到

B.attendance_date >= First(A.attendance_date)

# ruby-on-rails - Rails - 流量控制问题，有没有更好的方法？

> ID：519018
> 
> 赞同：1
> 
> 时间：2009-02-06T03:52:22.337
> 
> 标签：ruby-on-rails, ruby

我正在尝试根据角色和“帖子”控制器锁定一些控制器，无论它们是否分配了任何权限。这似乎有效，但我想知道是否有一种干净的方法来处理这个问题。这就是我在应用程序控制器中所拥有的，我将其称为前置过滤器......

```
if controller_name == 'users' || 'accounts'
  unless @current_user.master? || @current_user.power?
    render :template => "layouts/no_content"
  end
elsif controller_name == 'posts'
  unless @current_user.permissions.count > 0
    render :template => "layouts/no_content"
  end
end 
```

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-06T04:20:44.277

您不应该制作代码片段来检查控制器名称以在 application.rb 中执行特定操作。您应该只在需要它们的控制器中定义过滤器之前

在 ApplicationController 中创建 2 个方法：

```
private
def require_master_or_power_user
  unless @current_user.master? || @current_user.power?
    render :template => "layouts/no_content"
  end
end

def require_some_permisions
  unless @current_user.permissions.count > 0
    render :template => "layouts/no_content"
  end
end 
```

现在将其添加为您需要的前置过滤器：

```
class UsersController < ApplicationController
  before_filter :require_master_or_power_user
  ...
end

class AccountsController < ApplicationController
  before_filter :require_master_or_power_user
  ...
end

class PostsController < ApplicationController
  before_filter :require_some_permisions
  ...
end 
```

所以 ApplicationController 定义了过滤器，但它取决于你的其他控制器是否实际使用这些过滤器。像 ApplicationController 这样的超类永远不应该根据其子类有条件地分支其执行。选择何时使用提供的行为是您首先要进行子类化的原因之一。

从代码可读性的角度来看，它也更加清晰。查看 UsersController 时，当您看到名为“require_something”的前置过滤器时，很明显会发生一些权限问题。使用您的方法，您根本无法通过查看用户控制器代码本身来判断这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T05:33:19.933

我强烈建议您遵守 MVC 和 OOP，并将尽可能多的与用户相关的逻辑移回 User 模型，如下所示：

```
class User < ActiveRecord::Base

def has_permission?
  true if self.master? || self.power? || (self.permissions.count > 1)
end 
```

那么你可以只在 application.rb 中使用一个过滤器：

```
protected

def check_template 
  render :template => "layouts/no_content" if current_user.has_permission? == true
end 
```

并按照 Squeegy 的建议在相应的控制器中或在 application_controller.rb 中的站点范围内使用 before_filter 调用它

```
before_filter :check_template 
```

如果您决定更改授予人们许可的范围，那么这种方法显然会更简洁一些，并且不那么脆弱，您只需在整个应用程序范围内进行一次更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T14:45:55.483

一个简短的手写 DSL。甚至没有检查代码的语法错误，但你会明白的。在您的应用程序控制器中：

```
before_filter :handle_requirements

def self.requirement(*controllers, &block)
  @_requirements ||= {}
  @_requirements[controllers] = block
end

def handle_requirements
  return unless @_requirements
  @_requirements.each do |controllers, proc|
    if controllers.include?(controller.controller_name)
      restrict_access unless instance_eval(&block)
    end
  end
end

def restrict_access
  render :template => "layouts/no_content"
end 
```

用法（也在您的应用程序控制器中）

```
requirement('users', 'accounts') do
  @current_user.master? || @current_user.power?
end 
```

或者，只需使用 Radar 提到的 ACL 系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T15:07:07.500

这是[RESTful_ACL](http://github.com/mdarby/restful_acl/tree/master)的插件；我开发的一个 ACL 插件/gem，并且被广泛使用。它使您可以自由地设计您认为合适的角色，并且非常透明。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T14:54:21.487

另一个值得一看的插件是我一直在使用的[角色要求。](http://code.google.com/p/rolerequirement/)我认为他们都可以做大致相同的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T07:54:18.560

我建议您为此使用 ACL 系统：http: [//github.com/ezmobius/acl_system2](http://github.com/ezmobius/acl_system2)

# .net - 在客户端系统上升级到 3.5 SP1 和 3.5 系列更新会破坏我的代码吗？

> ID：519020
> 
> 赞同：0
> 
> 时间：2009-02-06T03:52:59.717
> 
> 标签：.net, .net-3.5

我有一个使用 .NET 3.5 托管远程应用程序的服务器。它一直运行良好。在过去的几天里，我收到了大量关于用户在运行“Microsoft .NET Framework 3.5 Service Pack 1 和 .NET Framework 3.5 Family Update (KB951847) x86”更新后无法访问该应用程序的报告。

我很想在服务器上运行此更新 - 但不希望对尚未运行此 Windows 更新的用户造成任何问题。

我可以更新我的应用程序，但我从其他关于 SO 的问题中看到这不应该是一个问题 - 因为我的开发机器上没有 SP1，所以该应用程序没有使用任何依赖于 SP1 的东西。

对可能发生的事情有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T13:42:30.057

.NET 3.5 的 SP1 包括错误修复和许多新功能。
根据我的经验，从任何框架 .NET 2.0 SP1 升级到 3.0、3.0 SP1、3.5
到任何更高的框架（最高 3.5 SP1 - 还没有尝试过 4.0 测试版）不会破坏任何东西。
事实上，.NET 3.5 SP1 实际上是基于 .NET 2.0 SP1 并为其添加了功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T14:14:34.673

纯属巧合，但我没有注意到 SP1 有任何问题。如前所述，它是一个“附加”版本，这意味着它不应破坏任何 3.5 或 2.0 代码。不过，就一般原则而言，我建议先在您的电脑或开发服务器上进行测试...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T15:58:48.603

这可能是巧合 - 但在此 Windows 更新之后，一些用户在使用我们的应用程序时遇到了错误。我们的应用程序是一个点击一次的分布式应用程序。该应用程序不会更新，也无法通过控制面板从系统中删除。

微软建议删除 Local Settings\Apps 文件夹中的 2.0 文件夹

在 XP 上通常是：user/appdata/local/Apps/2.0 在 Vista 上通常是：user/appdata/local/Apps/2.0

这对我们所有遇到此问题的用户都有效。我希望这可以为其他人节省大量时间！

# javascript - 无需服务器代码的 HTML 数据处理（仅使用 Javascript）

> ID：519034
> 
> 赞同：0
> 
> 时间：2009-02-06T03:59:15.087
> 
> 标签：javascript, html, web-applications, client-side

我只是想知道是否有某种方法可以做到这一点：

我在网页中有一个表单，用户提交表单后，该页面被重定向到另一个静态 HTML 页面。

有没有任何方法可以在没有任何服务器代码帮助的情况下操作第二个 HTML 页面中的数据？

我的意思是我可以显示用户在第二页提交的表单数据吗？

当然应该有一个导航，而不是一些 Ajax 代码来加载第二个页面（使用它可以很容易地操作数据）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T04:17:46.670

您可以使用`<form>`with GET 方法转到另一个带有一些查询参数的静态 HTML 页面，然后使用 JavaScript 获取这些参数：

第一页：

```
<form method="GET" action="page2.html">
    <input type="text" name="value1"/>
    <input type="text" name="value2"/>
    <input type="submit"/>
</form> 
```

第二页：

```
<script type="text/javascript">
function getParams() {
    function decode(s) {
        return decodeURIComponent(s).split(/\+/).join(" ");
    }

    var params = {};

    document.location.search.replace(
        /\??(?:([^=]+)=([^&]*)&?)/g,
        function () {
            params[decode(arguments[1])] = decode(arguments[2]);
        });

    return params;
}

var params = getParams();

alert("value1=" + params.value1);
alert("value2=" + params.value2);
// or massage the DOM with these values
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T04:04:02.610

您可以从 JavaScript ( *window.location.search*，您仍然需要解析) 访问页面 GET 参数，并使用它来将一些验证传递给静态页面。

（我想没有办法获得 POST 内容。）

您还可以从 JavaScript 读取和设置 cookie 的值。

如果您处于“父”页面始终存在的框架集中，您可能还会在其中存储信息（跨框架脚本也很棘手，我会尽量避免这种情况）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T04:04:27.290

如果您在第一页使用 GET 操作提交表单，您将获得如下所示的 URL：

```
http://tempuri.org/Page2.html?param1=value1&param2=value2 
```

然后，您可以在 Page2.html 上使用 JavaScript 读取查询字符串参数并将它们显示在页面上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T04:05:48.537

如果您通过 GET 发送表单，是的，您可以从 js 中获取该信息。

有一个 jQuery 插件可以做到这一点，但如果你愿意，你可以自己滚动，它并不复杂。

只需获取 location.href 并使用“？”将其拆分即可

然后，使用“&”再次拆分

现在，对于每个值，用“=”分割。然后，您将拥有一个包含查询名称及其值的数组。

编辑：谷歌`javascript get querystring`找到几十个实现。

# javascript - jQuery Validator，以编程方式显示错误

> ID：519044
> 
> 赞同：4
> 
> 时间：2009-02-06T04:03:09.227
> 
> 标签：javascript, jquery

我可以做这样的事情：

```
validator.showErrors({ "nameOfField" : "ErrorMessage" }); 
```

这很好用，但是如果我尝试做这样的事情：

```
var propertyName = "nameOfField";
var errorMessage = "ErrorMessage";
validator.showErrors({ propertyName : errorMessage }); 
```

它会引发“元素未定义”错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-06T04:09:37.687

关于什么：

```
var propertyName = "nameOfField";
var errorMessage = "ErrorMessage";

var obj = new Object();
obj[propertyName] = errorMessage;

validator.showErrors(obj); 
```

* * *

值得注意的是，以下三种语法是等价的：

```
var a = {'a':0, 'b':1, 'c':2};

var b = new Object();
b['a'] = 0;
b['b'] = 1;
b['c'] = 2;

var c = new Object();
c.a = 0;
c.b = 1;
c.c = 2; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T04:59:53.637

顺便说一句，您收到“元素未定义”错误的原因是：

```
var propertyName = "test";
var a = {propertyName: "test"}; 
```

相当于..

```
var a = {"propertyName": "test"}; 
```

即，您没有将 propertyName 的值分配为键，而是将 propertyName 作为字符串分配给它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T04:08:49.403

那应该可以正常工作。也许缺少一个；在错误消息抛出一些东西之后。你用的是什么浏览器？

此警报在 IE7 上运行良好

```
<html>
<head>
    <script type="text/javascript" src="http://jqueryjs.googlecode.com/files/jquery-1.3.1.min.js"></script>
    <script type="text/javascript">
        $(function() {
            var name = "name";
            var value = "value";
            var obj = eval("({ '"+name+"' : '"+value+"' })");
            alert(obj[name]);
        });

    </script>
</head>
<body>
</body>
</html> 
```

# .net - 选择时更改 TreeViewItem 的模板

> ID：519048
> 
> 赞同：4
> 
> 时间：2009-02-06T04:04:26.433
> 
> 标签：.net, wpf, treeview, hierarchical-data, treeviewitem

我在更改用于 TreeViewItem 的 DataTemplate 时遇到了一些问题。理想情况下，我希望每个项目都包含 a `TextBlock`，然后在选择时应该包含 a `TextBox`。

到目前为止，这是我所拥有的（我以[这个问题](https://stackoverflow.com/questions/146269/change-wpf-datatemplate-for-listbox-item-if-selected)为起点）：

```
<Window>
    <Window.Resources>
        <HierarchicalDataTemplate x:Key="normal"
            ItemsSource="{Binding Path=Children}">
            <TextBlock Text="{Binding Path=Text}" />
        </HierarchicalDataTemplate>
        <HierarchicalDataTemplate x:Key="selected"
            ItemsSource="{Binding Path=Children}">
            <TextBox Text="{Binding Path=Text}" />
        </HierarchicalDataTemplate>
        <Style TargetType="{x:Type TreeViewItem}" x:Key="ContainerStyle">
            <Setter Property="ItemTemplate" Value="{StaticResource normal}" />
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="ItemTemplate" Value="{StaticResource selected}" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resource>
    <Grid>
        <TreeView ItemSource="{Binding Body}" ItemContainerStyle="{StaticResource ContainerStyle}" />
    </Grid>
</Window> 
```

发生的情况是树中只有一个节点，节点的文本是对象的类型名称。听起来绑定到节点的类型不是模板所期望的，所以它使用默认`ToString()`绑定而不是`Text`我指定的属性。

我已经在代码隐藏文件中设置了 Window 的 DataContext。我知道我的数据绑定是正确的，因为如果我`HierarchicalDataTemplate`为 TreeView 设置一个，数据就会正确显示。

我认为我的问题是我需要设置样式以外的属性`ItemTemplate`-`TreeViewItem`我使用的是正确的属性，还是应该设置其他属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T15:50:47.067

它实际上是您需要的 HeaderTemplate - 这就是控制节点本身样式的内容。就这样有一个完整的样本，这对我有用：

```
<Window x:Class="Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1" Height="300" Width="300">
<Window.Resources>
    <HierarchicalDataTemplate x:Key="normal"
                             ItemsSource="{Binding Path=Children}">
        <TextBlock Text="{Binding Path=Text}" />
    </HierarchicalDataTemplate>
    <HierarchicalDataTemplate x:Key="selected"
                             ItemsSource="{Binding Path=Children}">
        <TextBox Text="{Binding Path=Text}" />
    </HierarchicalDataTemplate>
    <Style TargetType="{x:Type TreeViewItem}"
           x:Key="ContainerStyle">
        <Setter Property="HeaderTemplate"
                Value="{StaticResource normal}" />
        <Style.Triggers>
            <Trigger Property="IsSelected"
                     Value="True">
                <Setter Property="HeaderTemplate"
                        Value="{StaticResource selected}" />
            </Trigger>
        </Style.Triggers>
    </Style>
    </Window.Resources>
    <Grid>
        <TreeView x:Name="_Tree" ItemContainerStyle="{StaticResource ContainerStyle}"/>
    </Grid>
</Window> 
```

.. 后面有一些测试代码，如下所示：

```
Imports System.Collections.ObjectModel

Class Window1

    Private Sub Window1_Loaded(ByVal sender As Object, ByVal e As System.Windows.RoutedEventArgs) Handles Me.Loaded

        Dim Root As New Node
        Root.Text = "Root"

        Dim Child As New Node
        Child.Text = "Child"
        Root.Children.Add(Child)

        Dim Nodes As New Collection(Of Node)
        Nodes.Add(Root)
        _tree.itemssource = Nodes

    End Sub

End Class

Public Class Node

    Private _Text As String
    Public Property Text() As String
        Get
            Return _Text
        End Get
        Set(ByVal Value As String)
            _Text = Value
        End Set
    End Property

    Private _Children As New Collection(Of Node)
    Public Property Children() As Collection(of node)
        Get
            Return _Children
        End Get
        Set(ByVal Value As Collection(of node))
            _Children = Value
        End Set
    End Property

End Class 
```

# views - mysql 视图

> ID：519068
> 
> 赞同：0
> 
> 时间：2009-02-06T04:12:52.373
> 
> 标签：views

我正在尝试为我创建的 2 个选择语句的 UNION 创建一个视图。

单独执行时，UNION 工作正常

但问题是当我将它作为视图执行时，只有 UNION 的第一部分被执行。

我正在使用的查询如下

```
 SELECT DISTINCT
  products.pid        AS id,
  products.pname      AS name,
  products.p_desc     AS description,
  products.p_uid      AS userid,
  products.p_loc      AS location,
  products.isaproduct AS whatisit
FROM products
UNION
SELECT DISTINCT
  services.s_id       AS id,
  services.s_name     AS name,
  services.s_desc     AS description,
  services.s_uid      AS userid,
  services.s_location AS location,
  services.isaservice AS whatisit
FROM services 
```

当我单独执行时，上述工作正常。但是当我将它用作视图时，它并没有给我服务部分的结果。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T04:16:57.360

试试这个

```
 SELECT DISTINCT
  products.pid        AS id,
  products.pname      AS name,
  products.p_desc     AS description,
  products.p_uid      AS userid,
  products.p_loc      AS location,
  products.isaproduct AS whatisit
FROM products
UNION ALL
SELECT DISTINCT
  services.s_id       AS id,
  services.s_name     AS name,
  services.s_desc     AS description,
  services.s_uid      AS userid,
  services.s_location AS location,
  services.isaservice AS whatisit
FROM services 
```

我不确定，我在我的服务器上用一张桌子试了一下，效果很好。我想它对你有用。*提示*这里唯一的区别是我使用“union all”而不是“union”

# jquery - CSS 表格单元格背景图像文本重叠

> ID：519077
> 
> 赞同：2
> 
> 时间：2009-02-06T04:15:32.103
> 
> 标签：jquery, css, jquery-plugins

我正在使用 Tablesorter Jquery 插件对表格进行排序，但样式表中指定的图像背景图像落后于列上的文本，其中列的实际内容不够长，无法将列宽推到超过标题文本。

例如，请访问此处：[http](http://tablesorter.com/docs/) ://tablesorter.com/docs/ ，然后缩小浏览器，直到向上/向下箭头位于 Age 列的文本后面。我也有类似的事情发生。

我可以将列的宽度硬编码为足够宽，但我宁愿在 CSS 文件中有一个更可重用的解决方案。

那么有谁知道如何为 . padding-right 和 margin-right 似乎没有任何效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T08:49:52.720

使用以下 CSS：

```
thead th
{
    padding-right: 20px;
} 
```

这通过创建图像所在的“空白”空间来解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T08:29:07.817

这就是现在你的单元格中的内容：

```
<th class="header">Last Name</th> 
```

背景图像设置在类标题中，因此您可以订购 asc 或 desc

我想唯一的解决方案是尝试这样的事情

```
<th class="header">
<div style="margin-right: 10px;">Last Name</div>
</th> 
```

这样，您的图像将始终位于标题的右侧希望这会有所帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T08:32:43.647

或者只是将其添加到您的 CSS 中：

```
th.header {
    padding-right: 20px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T10:56:33.493

我知道这是一个老问题，但是当我遇到同样的问题并发现 th 上的填充或边距没有帮助时，我遇到了它。

Tablesorter 在标题中为您添加了一个 div，您可以将 margin-right 添加到 div 以解决问题。

表格排序器使标题看起来像这样：

```
<th data-column="2" class="tablesorter-header">
    <div class="tablesorter-header-inner">Header Text Here</div>
</th> 
```

所以我把这个css放到了div上：

```
table.tablesorter thead tr th .tablesorter-header-inner {
    margin-right: 15px;
} 
```

# php - 使类中的每个函数都可以访问全局变量

> ID：519078
> 
> 赞同：13
> 
> 时间：2009-02-06T04:15:32.777
> 
> 标签：php, class, function, variables, global

我在名为 的全局范围内有一个变量`${SYSTEM}`，其中 SYSTEM 是一个已定义的常量。我有很多类的函数需要访问这个变量，我发现`global ${SYSTEM};`每次都声明很烦人。

我尝试声明一个类变量：`public ${SYSTEM} = $GLOBALS[SYSTEM];`但这会导致语法错误，这很奇怪，因为我有另一个类以这种方式声明类变量并且似乎工作正常。我唯一能想到的是常数没有被识别。

我已经设法通过构造函数来解决这个问题，但在求助之前我正在寻找一个更简单的解决方案。

* * *

**编辑** 全局 ${SYSTEM} 变量是一个包含许多其他子数组的数组。不幸的是，似乎没有办法使用构造函数来解决......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T13:13:21.783

这就是我在没有全局的情况下全局访问事物的方式。

```
class exampleGetInstance 
{

private static $instance;

public $value1;
public $value2;

private function initialize() 
{
    $this->value1 = 'test value';
    $this->value2 = 'test value2';

}

public function getInstance()
{
    if (!isset(self::$instance))
    {
        $class = __CLASS__;
        self::$instance = new $class();
        self::$instance->initialize();
    }
    return self::$instance;
}

}

$myInstance = exampleGetInstance::getInstance();

echo $myInstance->value1; 
```

`$myInstance`现在是对`exampleGetInstance`类实例的引用。

固定格式

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-06T07:12:27.053

好的，希望我已经掌握了您要实现的目标

```
<?php
    // the global array you want to access
    $GLOBALS['uname'] = array('kernel-name' => 'Linux', 'kernel-release' => '2.6.27-11-generic', 'machine' => 'i686');

    // the defined constant used to reference the global var
    define(_SYSTEM_, 'uname');

    class Foo {

        // a method where you'd liked to access the global var  
        public function bar() {
            print_r($this->{_SYSTEM_});
        }

        // the magic happens here using php5 overloading
        public function __get($d) {
            return $GLOBALS[$d];  
        }

    }

    $foo = new Foo;
    $foo->bar();

?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T04:49:42.300

您可以使用这样的构造函数：

```
class Myclass {
  public $classvar; 
  function Myclass() {
    $this->classvar = $GLOBALS[SYSTEM];
  }
} 
```

编辑：感谢您指出错字，彼得！

这也适用于数组。如果不需要分配，也可以参考：

```
$this->classvar =& $GLOBALS[SYSTEM]; 
```

EDIT2：以下代码用于测试此方法，它适用于我的系统：

```
<?php
define('MYCONST', 'varname');
$varname = array("This is varname", "and array?");

class Myclass {
  public $classvar;
  function Myclass() {
    $this->classvar =& $GLOBALS[MYCONST];
  }
  function printvar() {
    echo $this->classvar[0]; 
    echo $this->classvar[1];
  }
};

$myobj = new Myclass;
$myobj->printvar();
?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T04:22:50.000

成员变量的直接说明不能包含对其他变量的任何引用（`class {public $membervar = $outsidevar;}`也是无效的）。请改用构造函数。

但是，当您处理常量时，为什么不使用 php 的[常量](http://php.net/define)或[类常量](http://php.net/manual/en/language.oop5.constants.php)工具呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T05:09:37.220

您正在尝试在这里做一些非常不寻常的事情，因此您可以预期它会很尴尬。`SYSTEM`使用全局变量从来都不是一件令人愉快的事情，尤其是在使用常量选择动态名称时。就个人而言，我建议您`$GLOBALS[SYSTEM]`在任何地方使用，或者...

```
$sys = $GLOBALS[SYSTEM]; 
```

...如果您要经常使用它。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-06T04:32:46.577

您也可以尝试单例模式，虽然在某种程度上它在 OOP 圈子中不受欢迎，但它通常被称为类的全局变量。

```
<?php
class Singleton {

  // object instance
  private static $instance;

  // The protected construct prevents instantiating the class externally.  The construct can be
  // empty, or it can contain additional instructions...
  protected function __construct() {
    ...
  }

  // The clone and wakeup methods prevents external instantiation of copies of the Singleton class,
  // thus eliminating the possibility of duplicate objects.  The methods can be empty, or
  // can contain additional code (most probably generating error messages in response
  // to attempts to call).
  public function __clone() {
    trigger_error('Clone is not allowed.', E_USER_ERROR);
  }

  public function __wakeup() {
    trigger_error('Deserializing is not allowed.', E_USER_ERROR);
  }

  //This method must be static, and must return an instance of the object if the object
  //does not already exist.
  public static function getInstance() {
    if (!self::$instance instanceof self) { 
      self::$instance = new self;
    }
    return self::$instance;
  }

  //One or more public methods that grant access to the Singleton object, and its private
  //methods and properties via accessor methods.
  public function GetSystemVar() {
    ...
  }
}

//usage
Singleton::getInstance()->GetSystemVar();

?> 
```

这个例子是从维基百科稍微修改的，但你可以理解。尝试使用谷歌搜索单例模式以获取更多信息

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-02-06T04:26:35.467

我想说的前两件事对我来说很突出：

1.  你不需要变量名的括号，你可以简单地做 public $system 或 public $SYSTEM。
2.  虽然 PHP 可能并不总是需要它，但标准做法是将非数字数组索引封装在单引号或双引号中，以防您使用的字符串在某些时候变为常量。

这应该是你要找的

```
class SomeClass {
  public $system = $GLOBALS['system'];
} 
```

您还可以使用类常量，而不是

```
class SomeClass {
  const SYSTEM = $GLOBALS['system'];
} 
```

这可以在类内用'self::SYSTEM'引用，在外部用'SomeClass::SYSTEM'引用。

# c# - 客户端 Flash(SWF) 应如何与服务器端 .NET 通信？

> ID：519079
> 
> 赞同：2
> 
> 时间：2009-02-06T04:15:58.437
> 
> 标签：c#, .net, flash, actionscript-3

所以我在 IIS7 的服务器上运行了 ASP.NET。我想我会为一些静态页面和基本的动态表单使用 MVC——但大多数客户端都是用 Flash/ActionScript 编写的。

在客户端和服务器之间构建/生成代理的最简单、最简洁、最干燥的方式是什么？

我应该使用哪种格式？

*   JSON
*   肥皂
*   二进制

我应该使用哪种通信协议？

*   WCF
*   通过 MVC 控制器操作的 HTTP

我可能缺少一些格式或协议，但基本上它应该是相对有效的，不需要大量的管道代码，最好是自动生成客户端代理。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T04:47:06.970

WSDL Web 服务在 Flash 中很容易使用，在 .NET 中也很容易创建。

我还建议您至少研究一下 AMF，它是 Adob​​e 用于在客户端和服务器之间交换数据的专有二进制格式。.NET 有几个实现，包括 amf.net 和 weborb。

我从未使用过它，但我听说过关于 weborb 的非常棒的事情：[http ://www.themidnightcoders.com/products/weborb-for-net/overview.html](http://www.themidnightcoders.com/products/weborb-for-net/overview.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T05:53:53.293

我已经在 swfs 中使用了 JSON .. 使用 a3corelib 的东西非常简单

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T07:08:15.157

我对 FluorineFX.net 有过很好的体验——它看起来与 WebORB 非常相似，但它是免费和开源的。我不认为 Flash/ActionScript 支持 WCF ..

您应该注意（在我所做的研究中）没有办法从服务器向客户端发送一个打包的 - 客户端必须发出所有请求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T04:50:03.580

我们在工作中使用 Weborb。我强烈推荐它。Weborb 在两端处理序列化的方式存在一些问题。只需确保在您的 .NET 类中您的成员名称与类名称不同。

编辑：Weborb 的免费开发者版应该可以满足大多数人的需求。Weborb 具有明显的速度优势，因为它使用二进制 AMF 格式而不是 JSON 或 SOAP 进行网络通信。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-07T07:03:05.853

我第二个WebORB。它使用 AMF 协议，这是获取和输出数据的最快方式。您可以轻松地公开您的 .NET 服务并输入和输出类型对象。您可以使用 RMI 和消息传递。这是一个免费的产品，做得很好......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T23:20:04.703

WCF 支持 Flash..！完成“启用 AJAX 的 WCF 服务”和 WebInvoke(Method = "POST")

# java - 如何让一个简单的 Hello World Java 小程序在 Mac OS X 的浏览器中工作？

> ID：519080
> 
> 赞同：2
> 
> 时间：2009-02-06T04:16:01.993
> 
> 标签：java, html, macos, applet

我在 Mac OS X 10.5.6 上使用 Java SE 1.6。我的小程序代码如下：

```
import java.awt.Graphics;
import javax.swing.JApplet;

public class HelloWorld extends JApplet {

    public void paint( Graphics g ) {
            super.paint( g );
            g.drawString( "Hello World!", 25, 25 );
    }

} 
```

我将其编译为*.class*文件。我的 HTML 文件的代码如下：

```
<html>

<head>
    <title>Hello World</title>
</head>

<body>
    <applet code="HelloWorld.class" height="300" width="300">
            Your browser is ignoring the applet tag.
    </applet>
</body>

</html> 
```

如果我使用*appletviewer*运行小程序，它工作正常。但是，如果我在浏览器中打开 HTML 文件，小程序空间会出现一个正方形，但小程序不会加载。（“您的浏览器正在忽略小程序标记。”也没有出现。）浏览器状态栏显示两条消息： **Applet HelloWorld 未**加载和**加载 Java Applet 失败...** 我尝试使用 Firefox 3.0.6、Safari 3.2 的小程序.1 和 Opera 9.6.3。他们都不能加载小程序。

*如果我尝试在/Developer/Examples/Java/Applets*中打开其中一个 Java 演示小程序的 HTML ，它会在所有三个浏览器中正常加载。

在尝试将这个简单的小程序加载到浏览器中时，我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T04:41:42.020

您没有在小程序标记中指定代码库属性，所以我猜您的类找不到。

尝试启用 java 控制台输出窗口。您可以在扩展选项选项卡（带有树和许多复选框的选项卡）下的“Java 设置”（使用聚光灯）中执行此操作。也许您可以在那里看到更多信息（例如 ClassNotFoundException）。将设置设置为“启用/显示控制台”。然后它应该在您启动小程序时出现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T09:18:47.420

不幸的是，Apple 决定只为 OS X 上的 Java 6 发布 64 位 VM。这意味着必须将浏览器链接为 64 位应用程序。现在，他们都没有（据我所知）。因此，“简单”的解决方案是将 Java 5 用于您可以在 Java Preferences 应用程序中配置的小程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-14T21:53:34.027

Phil，dhiller 关于代码库的评论触发了一些对我有用的东西。如果您将“HelloWorld.class”文件与您的 HTML 文件放在同一个文件夹中，然后将您的 applet 标签设置为： `< applet code="HelloWorld.class" codebase="." align="baseline" height="300" width="300" >`，然后用您的浏览器打开该 HTML 文件，它应该可以工作。我的做到了。告诉浏览器`codebase ="."`小程序代码与 HTML 文件位于同一文件夹中。小程序加载失败，因为浏览器显然不知道类代码的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T04:29:58.627

我不是Web 编程方面的专家，但我认为applet 标签不是标准的。您必须使用带有正确 classid 的对象标记来插入小程序（或几乎任何东西）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T04:55:31.180

您没有给小程序一个容器等来显示自己。这是一个[示例 HelloWorld 小程序](http://www.michael-thomas.com/tech/java/javacert/src/MyHello_JApplet.java)：

```
/*
  File.......: MyHello_JApplet.java
  Description: Basic JApplet example.  (Run by a browser.)
  Programmer.: Michael Thomas
  Date.......: Updated 09/09/01, Orig 09/09/01

*/
import javax.swing.JApplet;
import java.awt.Graphics;
import java.awt.Container;
import java.awt.Color;

public class MyHello_JApplet extends JApplet {

  public void init() {
    Container objContainer = super.getContentPane();
    objContainer.setBackground( Color.white );
  }
  public void paint(Graphics g) {
    g.drawString("Hello World from JApplet (Swing - JApplet).",10,25);
  }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-07T06:46:55.480

感谢您的所有回答。他们中的一些人为我指出了正确的方向，以找出问题的根源。

我在 Java 首选项中打开了 Java 控制台。当我再次运行小程序时，我收到以下输出：

Java Plug-in 1.5.0
Using JRE version 1.5.0_16 Java HotSpot(TM) Client VM
MRJ Plugin for Mac OS X v1.0.1
[启动 Java Applet Security @ Fri Feb 06 23:47:20 CST 2009]
java.lang .UnsupportedClassVersionError： 在
java.security.SecureClassLoader.defineClass (SecureClassLoader.java: 124) 在 sun.applet.AppletClassLoader.findClass(AppletClassLoader.java:177) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:316) 在 sun.applet.AppletClassLoader.loadClass(AppletClassLoader.java:119)

在 java.lang.ClassLoader.loadClass(ClassLoader.java:251)
在 sun.applet.AppletClassLoader.loadCode(AppletClassLoader.java:605)
在 sun.applet.AppletPanel.createApplet (AppletPanel.java:723)
在 sun.plugin。 AppletViewer.createApplet(AppletViewer.java:1864)
在 jep.AppletFramePanel.createApplet(AppletFramePanel.java:189)
在 sun.applet.AppletPanel.runLoader(AppletPanel.java:652) 在 sun.applet.AppletPanel.run(
AppletPanel.java :326)
在 jep.AppletFramePanel.run(AppletFramePanel.java:176)
在 java.lang.Thread.run(Thread.java:613)

我在我的 Mac 上安装了 Java SE 1.6，但我猜它没有安装 1.6 插件。此外，看起来*.class*文件在创建时会带有版本号。我使用 1.6 版编译了该小程序，但尝试使用 1.5 插件运行它，从而导致*UnsupportedClassVersionError*。我重新编译了 1.5 版的小程序，并尝试在所有三个浏览器中再次运行它。像魅力一样工作。

有谁知道1.6插件是否正在开发中？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-09T18:11:55.997

只是一个注释。这个线程帮助我走上了正轨，所以我只想添加一个有用的注释。2010 年 8 月 9 日。

在 Mac OS X 10.5.8 Leopard 中，使用的 Java 版本由路径 Mac HD/Applications/Utilities/Java Preferences 中的应用程序控制

那可能以前被命名为 Java 设置？用于桌面应用程序的 Java 版本不必与浏览器中使用的版本相同。我在启动 Portecle（从命令行）时遇到问题 - 它报告“.class 文件中的版本号错误”。

截至 2010 年 8 月，Mac OS X 10.5.8 默认 Java 序列为：

*   J2SE 5.0.......32 位
*   J2SE 5.0.......32 位
*   Java SE 6.....64 位
*   J2SE 5.0.......64 位
*   J2SE 1.4.2 ...32 位

显然，我试图加载的 Java 应用程序需要 Java SE 6 64 位，因为将 Java SE 6 拖到该列表的顶部会立即解决问题，之后可以从命令行或双击或启动 Portecle portecle.jar。（万岁）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-16T00:06:02.903

不要在 HTML 文件中的类名周围加上引号。每次我引用时，小程序都不适合我。:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-08T06:48:51.090

这是你的答案

```
<html>
   <applet code="packagename.HelloWorld.class" height="300" width="300">
</html> 
```

用你的包替换包名..

# unit-testing - 你写过的最不“值得”的单元测试？

> ID：519085
> 
> 赞同：3
> 
> 时间：2009-02-06T04:18:14.703
> 
> 标签：unit-testing

在 SO 博客和播客上，Joel 和 Jeff 一直在讨论经常被忽略的单元测试特定功能根本不值得付出努力的时候。那些对简单功能进行单元测试的时候是如此复杂、不可预测或不切实际，以至于测试成本无法反映该功能的价值。在 Joel 的案例中，*如果*他们决定编写测试，该示例需要一个复杂的图像比较来简单地确定压缩质量。

在这种情况下，您遇到过哪些情况？我能想到的常见领域是 GUI、页面布局、音频测试（例如，测试以确保发出声音警告）等。

我正在寻找恐怖故事和真实世界的例子，而不是猜测（就像我刚刚做的那样）。如果您或必须编写“不可能”测试的人继续编写它，则可以加分。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-06T07:57:27.663

```
@Test
public void testSetName() {
    UnderTest u = new UnderTest();
    u.setName("Hans");
    assertEquals("Hans", u.getName());
} 
```

测试 set/get 方法只是愚蠢的，你不需要那个。如果你被迫这样做，你的架构就会有一些严重的缺陷。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-10T20:40:28.190

```
Foo foo = new Foo();
Assert.IsNotNull(foo); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T13:57:38.403

我的公司分别编写单元测试和集成测试。如果我们为数据访问类编写集成测试，它会得到全面测试。

他们将单元测试视为与集成测试相同的东西，只是它不能开箱即用（即调用数据库或 Web 服务）。然而，我们也有单元测试以及数据访问类的集成测试。

针对无法连接到数据的数据访问类进行测试有什么好处？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T13:45:09.957

在我看来，编写无用的单元测试不是单元测试的错，而是决定编写测试的程序员的错。正如播客中提到的（我相信（或其他地方）），如果一个单元测试很难创建，那么代码可能会被重构，即使它目前“有效”。

即使是“愚蠢的”单元测试有时也是必要的，即使在“get/set Name”的情况下也是如此。在处理具有复杂业务规则的客户时，一些最简单的属性可能会附加一些荒谬的警告，并且您会发现一些非常基本的功能可能会中断。

花时间编写一个复杂的单元测试意味着您已经花时间来微调您对代码的理解，并且您可能会在此过程中修复错误，即使您从未完成单元测试本身。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T07:49:42.517

有一次我写了一个单元测试来暴露一个并发错误，以响应[C2 Wiki 上的挑战](http://c2.com/cgi-bin/wiki?ExtremeProgrammingChallengeFourteenTheBug)。

事实证明，这太难了，并暗示保证并发代码的正确性在更基础的层面上得到更好的处理。

# asp.net - 知道一个好的模板化 ASP.Net 日历控件吗？

> ID：519088
> 
> 赞同：0
> 
> 时间：2009-02-06T04:19:14.123
> 
> 标签：asp.net, calendar

我正在寻找一个适合 ASP.Net 应用程序的日历控件，它允许每天都有一个“ItemTemplate”类型的声明，以便我可以列出每天发生的事情。像 Club Starter Kit 之类的东西，只是更健壮，可以处理除 DataSet 和 DataTables 之外的其他数据源。

我正在考虑修复该控件以处理其他类型的数据源，但如果我能找到一个更好的东西，我宁愿去。如果有的话，我什至可以使用某种客户端“日历”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T17:22:12.117

我们实际上已经结束了使用 Club Starter Kit ( [http://clubstarterkit.codeplex.com/](http://clubstarterkit.codeplex.com/) ) 中的日历控件，因为更新的版本完成了我们需要它们做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-16T01:52:31.660

[BaseCalendar](http://basecalendar.codeplex.com/)可能会起作用（您可以自定义所有内容）。

# google-maps - 使标记的 FlatIcons 可拖动？

> ID：519096
> 
> 赞同：0
> 
> 时间：2009-02-06T04:23:49.653
> 
> 标签：google-maps

我正在创建一个谷歌地图来显示多个点，每个点都有一个短文本标签。我找到了一个 JavaScript 库，可以让我轻松地标记标记。我还想让标记可拖动。我正在从这个例子开始工作。

~~[http://gmaps-utility-library.googlecode.com/svn/trunk/mapiconmaker/1.1/examples/createflaticon-simple.html](http://gmaps-utility-library.googlecode.com/svn/trunk/mapiconmaker/1.1/examples/createflaticon-simple.html)~~

我尝试了以下方法，但至少在 Firefox 3.04 中不起作用。

```
var newIcon = MapIconMaker.createFlatIcon({ draggable: "true", label: "12300" });

var point = new GLatLng(43.82589,-79.10040);

var marker = new GMarker(point, {icon: newIcon});

map.addOverlay(marker);

marker.enableDragging(); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-10T18:53:20.137

[http://code.google.com/apis/ajax/playground/?exp=maps#map_marker_drag](http://code.google.com/apis/ajax/playground/?exp=maps#map_marker_drag)

这应该能让你到达那里 干杯

# hibernate - 限制 Hibernate 查询中的输出数量

> ID：519097
> 
> 赞同：3
> 
> 时间：2009-02-06T04:23:54.070
> 
> 标签：hibernate, grails, groovy, frameworks, grails-orm

我在 grails 中有一个休眠查询

```
 Book.findAllByRating(4) 
```

在上面的查询中，我只想要 5 个输出。如何将输出限制为 5？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T05:32:31.153

[GORM 文档](http://grails.org/DomainClass+Dynamic+Methods)有一些这样的例子。您是否尝试过：

```
Book.findAllByRating(4, [max:5]) 
```

# java - 意外的多线程结果

> ID：519099
> 
> 赞同：8
> 
> 时间：2009-02-06T04:24:51.913
> 
> 标签：java, multithreading, concurrency

我写了几个 Java 类——`SingleThreadedCompute`并且——来`MultithreadedCompute`证明一个事实（或者我一直认为的事实！）如果你在单核机器上并行化一个以计算为中心的（无 I/O）任务，你不会获得加速。事实上，我的理解是，并行化此类任务实际上会减慢速度，因为现在您必须处理上下文切换开销。好吧，我运行了这些类，并且并行版本出乎意料地运行得更快：单线程版本在我的机器上始终以略多于 7 秒的速度运行，而多线程版本在我的机器上始终以略多于 6 秒的速度运行。谁能解释这是怎么可能的？

如果有人想自己看或尝试，这里是课程。

```
public final class SingleThreadedCompute {
    private static final long _1B = 1000000000L; // one billion

    public static void main(String[] args) {
        long startMs = System.currentTimeMillis();

        long total = 0;
        for (long i = 0; i < _1B; i++) { total += i; }
        System.out.println("total=" + total);

        long elapsedMs = System.currentTimeMillis() - startMs;
        System.out.println("Elapsed time: " + elapsedMs + " ms");
    }
} 
```

这是多线程版本：

```
public final class MultithreadedCompute {
    private static final long _1B = 1000000000L; // one billion
    private static final long _100M = _1B / 10L;

    public static void main(String[] args) {
        long startMs = System.currentTimeMillis();

        System.out.println("Creating workers");
        Worker[] workers = new Worker[10];
        for (int i = 0; i < 10; i++) {
            workers[i] = new Worker(i * _100M, (i+1) * _100M);
        }

        System.out.println("Starting workers");
        for (int i = 0; i < 10; i++) { workers[i].start(); }

        for (int i = 0; i < 10; i++) {
            try {
                workers[i].join();
                System.out.println("Joined with thread " + i);
            } catch (InterruptedException e) { /* can't happen */ }
        }

        System.out.println("Summing worker totals");
        long total = 0;
        for (int i = 0; i < 10; i++) { total += workers[i].getTotal(); }
        System.out.println("total=" + total);

        long elapsedMs = System.currentTimeMillis() - startMs;
        System.out.println("Elapsed time: " + elapsedMs + " ms");
    }

    private static class Worker extends Thread {
        private long start, end;
        private long total;

        public Worker(long start, long end) {
            this.start = start;
            this.end = end;
        }

        public void run() {
            System.out.println("Computing sum " + start + " + ... + (" + end + " - 1)");
            for (long i = start; i < end; i++) { total += i; }
        }

        public long getTotal() { return total; }
    }
} 
```

这是运行单线程版本的输出：

```
total=499999999500000000
Elapsed time: 7031 ms 
```

这是运行多线程版本的输出：

```
Creating workers
Starting workers
Computing sum 0 + ... + (100000000 - 1)
Computing sum 100000000 + ... + (200000000 - 1)
Computing sum 200000000 + ... + (300000000 - 1)
Computing sum 300000000 + ... + (400000000 - 1)
Computing sum 400000000 + ... + (500000000 - 1)
Computing sum 500000000 + ... + (600000000 - 1)
Computing sum 600000000 + ... + (700000000 - 1)
Computing sum 700000000 + ... + (800000000 - 1)
Computing sum 800000000 + ... + (900000000 - 1)
Computing sum 900000000 + ... + (1000000000 - 1)
Joined with thread 0
Joined with thread 1
Joined with thread 2
Joined with thread 3
Joined with thread 4
Joined with thread 5
Joined with thread 6
Joined with thread 7
Joined with thread 8
Joined with thread 9
Summing worker totals
total=499999999500000000
Elapsed time: 6172 ms 
```

* * *

**编辑：环境信息：**

*   Microsoft Windows XP 专业版 2002，SP3
*   戴尔精密 670
*   英特尔至强 CPU 2.80GHz，1 MB 二级缓存

不知道如何证明它是单核机器，除了说明上面的规格并注意到当我购买机器时（2005 年 8 月），单核是标准，我没有升级到多核（如果那是什一个选项...我不记得了）。如果在 Windows 中的某个地方我可以检查系统属性（显示上面的信息）以外的其他地方，请告诉我，我会检查的。

* * *

以下是连续五次 ST 和 MT 运行：

五个单线程运行：

总计=499999999500000000 经过时间：7000 毫秒

总计=499999999500000000 经过时间：7031 毫秒

总计=499999999500000000 经过时间：6922 毫秒

总计=499999999500000000 经过时间：6968 毫秒

总计=499999999500000000 经过时间：6938 毫秒

* * *

五个多线程运行：

总计=499999999500000000 经过时间：6047 毫秒

总计=499999999500000000 经过时间：6141 毫秒

总计=499999999500000000 经过时间：6063 毫秒

总计=499999999500000000 经过时间：6282 毫秒

总计=499999999500000000 经过时间：6125 毫秒

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T04:39:17.673

这可能是由于超线程和/或流水线。

[来自关于超线程的](http://en.wikipedia.org/wiki/Hyper-threading)维基百科：

> 超线程是超线程的进步。超线程（官方称为超线程技术或 HTT）是一种英特尔专有技术，用于改进在 PC 微处理器上执行的计算（一次执行多个任务）的并行化。启用了超线程的处理器被操作系统视为两个处理器而不是一个。这意味着物理上只有一个处理器，但操作系统看到两个虚拟处理器，并在它们之间共享工作负载。

来自 wikipedia [on piplining](http://en.wikipedia.org/wiki/Pipeline_(computing))：

> 在计算中，管道是一组串联的数据处理元素，因此一个元素的输出就是下一个元素的输入。管道的元素通常以并行或时间片方式执行

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T04:31:00.153

你的其他环境是什么样的？这是可重复的吗？

至少在 UNIX 机器上，像这样长时间运行的单个进程的优先级可能会降低；如果你有 10 个线程，每个线程都有自己的 CPU 片，因此不会积累太多的 CPU 时间。这样它就不会失去对精细化的优先权。总体而言，它获得了更大的总 CPU 块。

### 添加

为了完整起见，这是您的代码在 OS/X 10.5.6 下的双核 mac mini 上提供的内容

```
527 $ java MultithreadedCompute
Creating workers
Starting workers
Computing sum 100000000 + ... + (200000000 - 1)
Computing sum 0 + ... + (100000000 - 1)
Computing sum 400000000 + ... + (500000000 - 1)
Computing sum 200000000 + ... + (300000000 - 1)
Computing sum 500000000 + ... + (600000000 - 1)
Computing sum 600000000 + ... + (700000000 - 1)
Computing sum 700000000 + ... + (800000000 - 1)
Computing sum 800000000 + ... + (900000000 - 1)
Computing sum 900000000 + ... + (1000000000 - 1)
Computing sum 300000000 + ... + (400000000 - 1)
Joined with thread 0
Joined with thread 1
Joined with thread 2
Joined with thread 3
Joined with thread 4
Joined with thread 5
Joined with thread 6
Joined with thread 7
Joined with thread 8
Joined with thread 9
Summing worker totals
total=499999999500000000
Elapsed time: 3217 ms
528 $ java SingleThreadedCompute
total=499999999500000000
Elapsed time: 5651 ms
529 $ 
```

可以看到，线程不一定是顺序运行的，多线程的运行时间大约是单线程的56%，说明它正在利用线程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T05:10:49.527

我尝试按照上面评论中 Pax 的建议关闭 JIT。Pax，如果您想发布一个快速的“关闭 JIT”答案，我会相信您的解决方案。

无论如何，关闭 JIT 是有效的（这意味着它使实际结果与预期结果一致）。我不得不放弃 10 亿，因为它会永远持续下去，所以我选择了 1 亿。结果更符合我的预期。他们来了：

**五个无 JIT 单线程运行**

总计=4999999950000000 经过时间：17094 毫秒

总计=4999999950000000 经过时间：17109 毫秒

总计=4999999950000000 经过时间：17219 毫秒

总计=4999999950000000 经过时间：17375 毫秒

总计=4999999950000000 经过时间：17125 毫秒

* * *

**五个 NO-JIT 多线程运行**

总计=4999999950000000 经过时间：18719 毫秒

总计=4999999950000000 经过时间：18750 毫秒

总计=4999999950000000 经过时间：18610 毫秒

总计=4999999950000000 经过时间：18890 毫秒

总计=4999999950000000 经过时间：18719 毫秒

* * *

谢谢大家的想法和帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T05:17:20.997

十分之一秒的差异？启动时间的噪音（单独）会淹没它。写一些运行一两分钟的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T09:48:59.327

尝试消除由单线程和多线程变体执行的代码之间的 HotSpot 引起的差异：

```
public class ThreadedWorkers {
    private static final long _1B = 1000000000L; // one billion
    private static final long _100M = _1B / 10L;

    enum ThreadMode { SINGLE, SEQUENTIAL, MULTI };

    public static void main(String[] args) throws InterruptedException {
        final long startMs = System.currentTimeMillis();

        ThreadMode mode = args.length == 0 ? ThreadMode.SINGLE : ThreadMode.valueOf(args[0].toUpperCase());

        final long total = computeTotal( mode );

        System.out.println("total=" + total);

        long elapsedMs = System.currentTimeMillis() - startMs;

        System.out.println("Elapsed time: " + elapsedMs + " ms");
    }

    public static long computeTotal (ThreadMode mode) throws InterruptedException {
        Worker[] workers = new Worker[10];

        for (int i = 0; i < 10; i++)
            workers[i] = new Worker(i * _100M, (i+1) * _100M);

        switch (mode) {
            case SINGLE: {
                for (Worker worker : workers )
                    worker.run();

                break;
            } 

            case SEQUENTIAL:{
                for (Worker worker : workers ) {
                    worker.start();
                    worker.join();
                }

                break;
            }

            case MULTI: {
                for (Worker worker : workers )
                    worker.start();

                for (Worker worker : workers )
                    worker.join();

                break;
            }
        }

        System.out.println("Summing worker totals");

        long total = 0;

        for (Worker worker : workers )
            total += worker.getTotal();

        return total;
    }

    static class Worker extends Thread {
        private long start, end, total;

        public Worker(long start, long end) {
            this.start = start;
            this.end = end;
        }

        public void run() {
            System.out.println("Computing sum " + start + " + ... + (" + end + " - 1)");
            for (long i = start; i < end; i++) { total += i; }
        }

        public long getTotal() { return total; }
    }
} 
```

这仍然比顺序或单个运行得更快（在 eee pc 900 - 23 对 13 秒上大约 10 秒），即使顺序执行与 multi 相同次数的相同方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T11:50:27.270

仅仅因为它很有趣……来自 8 核服务器级机器的结果。AMD 2.7GHz上海CPU

```
Creating workers
Starting workers
Computing sum 0 + ... + (100000000 - 1)
Computing sum 100000000 + ... + (200000000 - 1)
Computing sum 300000000 + ... + (400000000 - 1)
Computing sum 500000000 + ... + (600000000 - 1)
Computing sum 600000000 + ... + (700000000 - 1)
Computing sum 200000000 + ... + (300000000 - 1)
Computing sum 800000000 + ... + (900000000 - 1)
Computing sum 700000000 + ... + (800000000 - 1)
Computing sum 900000000 + ... + (1000000000 - 1)
Computing sum 400000000 + ... + (500000000 - 1)
Joined with thread 0
Joined with thread 1
Joined with thread 2
Joined with thread 3
Joined with thread 4
Joined with thread 5
Joined with thread 6
Joined with thread 7
Joined with thread 8
Joined with thread 9
Summing worker totals
total=499999999500000000
Elapsed time: 444 ms 
```

# winapi - 知道文件夹是快捷方式的 MS Win32 API 是什么？

> ID：519102
> 
> 赞同：1
> 
> 时间：2009-02-06T04:26:26.280
> 
> 标签：winapi, api, directory, shortcuts

在 Vista 和 Windows 7 中，有很多文件夹是快捷方式，例如“C:\Users\Administrator\Application Data”，使用 FindFileFirst 串行 API 可以枚举文件夹下的所有文件，但是我们无法在 Windows 资源管理器中打开它，我会调用 CreateFile 打开 FindFileFirst 串行 API 枚举的文件夹或文件时也会出错。我想知道什么是 MS Win32 API 来知道文件夹是快捷方式吗？FILE_ATTRIBUTE_REPARSE_POINT 标志是否用于这种文件夹？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T06:25:34.353

嗯看起来好像没有 API 来检查....我当然可能是错的，这里有人写过它的格式： [http ://www.i2s-lab.com/Papers/The_Windows_Shortcut_File_Format.pdf](http://www.i2s-lab.com/Papers/The_Windows_Shortcut_File_Format.pdf)

所以也许打开文件并找到 GUID 是你必须做的？

问候弗里德里希

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T13:37:15.653

我已经知道答案了，看这个博客。 [http://blogs.msdn.com/oldnewthing/archive/2004/12/27/332704.aspx](http://blogs.msdn.com/oldnewthing/archive/2004/12/27/332704.aspx)

# c# - 将 3D 点投影到 2D 屏幕坐标

> ID：519106
> 
> 赞同：7
> 
> 时间：2009-02-06T04:27:14.063
> 
> 标签：c#, wpf, math, 3d

根据[3D Programming For Windows (Charles Petzold)](http://www.charlespetzold.com/3D/)第 7 章中的信息，我尝试编写将 Point3D 投影到包含相应屏幕坐标 (x,y) 的标准 2D 点的辅助函数：

```
public Point Point3DToScreen2D(Point3D point3D,Viewport3D viewPort )
{
    double screenX = 0d, screenY = 0d;

    // Camera is defined in XAML as:
    //        <Viewport3D.Camera>
    //             <PerspectiveCamera Position="0,0,800" LookDirection="0,0,-1" />
    //        </Viewport3D.Camera>

    PerspectiveCamera cam = viewPort.Camera as PerspectiveCamera;

    // Translate input point using camera position
    double inputX = point3D.X - cam.Position.X;
    double inputY = point3D.Y - cam.Position.Y;
    double inputZ = point3D.Z - cam.Position.Z;

    double aspectRatio = viewPort.ActualWidth / viewPort.ActualHeight;

    // Apply projection to X and Y
    screenX = inputX / (-inputZ * Math.Tan(cam.FieldOfView / 2));

    screenY = (inputY * aspectRatio) / (-inputZ * Math.Tan(cam.FieldOfView / 2));

    // Convert to screen coordinates
    screenX = screenX * viewPort.ActualWidth;

    screenY = screenY * viewPort.ActualHeight;

    // Additional, currently unused, projection scaling factors
    /*
    double xScale = 1 / Math.Tan(Math.PI * cam.FieldOfView / 360);
    double yScale = aspectRatio * xScale;

    double zFar = cam.FarPlaneDistance;
    double zNear = cam.NearPlaneDistance;

    double zScale = zFar == Double.PositiveInfinity ? -1 : zFar / (zNear - zFar);
    double zOffset = zNear * zScale;

    */

    return new Point(screenX, screenY);
} 
```

然而，在测试时，此函数返回不正确的屏幕坐标（通过将 2D 鼠标坐标与简单的 3D 形状进行比较来检查）。由于我缺乏 3D 编程经验，我不知道为什么。

块注释部分包含可能必不可少的缩放计算，但我不确定如何，本书继续介绍使用 XAML 的 MatrixCamera。最初我只想让一个基本的计算工作，不管它与矩阵相比有多么低效。

谁能建议需要添加或更改的内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T07:40:00.083

我使用[3DUtils](http://www.codeplex.com/Wiki/View.aspx?ProjectName=3DTools) Codeplex 源库创建并成功测试了一种工作方法。

真正的工作是在 3DUtils 的 TryWorldToViewportTransform() 方法中执行的。没有它，此方法将无法工作（请参阅上面的链接）。

在 Eric Sink 的文章：[Auto-Zoom](http://www.ericsink.com/wpf3d/A_AutoZoom.html)中也找到了非常有用的信息。

注意。可能有更可靠/更有效的方法，如果是这样，请将它们添加为答案。与此同时，这足以满足我的需求。

```
 /// <summary>
    /// Takes a 3D point and returns the corresponding 2D point (X,Y) within the viewport.  
    /// Requires the 3DUtils project available at http://www.codeplex.com/Wiki/View.aspx?ProjectName=3DTools
    /// </summary>
    /// <param name="point3D">A point in 3D space</param>
    /// <param name="viewPort">An instance of Viewport3D</param>
    /// <returns>The corresponding 2D point or null if it could not be calculated</returns>
    public Point? Point3DToScreen2D(Point3D point3D, Viewport3D viewPort)
    {
        bool bOK = false;

        // We need a Viewport3DVisual but we only have a Viewport3D.
        Viewport3DVisual vpv =VisualTreeHelper.GetParent(viewPort.Children[0]) as Viewport3DVisual;

        // Get the world to viewport transform matrix
        Matrix3D m = MathUtils.TryWorldToViewportTransform(vpv, out bOK);

        if (bOK)
        {
            // Transform the 3D point to 2D
            Point3D transformedPoint = m.Transform(point3D);

            Point screen2DPoint = new Point(transformedPoint.X, transformedPoint.Y);

            return new Nullable<Point>(screen2DPoint);
        }
        else
        {
            return null; 
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-10T13:33:23.650

这并没有解决有问题的算法，但它可能对遇到这个问题的人有用（就像我所做的那样）。

在 .NET 3.5 中，您可以使用[Visual3D.TransformToAncestor(Visual original)](http://msdn.microsoft.com/en-us/library/bb763860.aspx)。我使用它在我的 3D 视口上的画布上绘制线框：

```
 void CompositionTarget_Rendering(object sender, EventArgs e)
    {
        UpdateWireframe();
    }

    void UpdateWireframe()
    {
        GeometryModel3D model = cube.Content as GeometryModel3D;

        canvas.Children.Clear();

        if (model != null)
        {
            GeneralTransform3DTo2D transform = cube.TransformToAncestor(viewport);
            MeshGeometry3D geometry = model.Geometry as MeshGeometry3D;

            for (int i = 0; i < geometry.TriangleIndices.Count;)
            {
                Polygon p = new Polygon();
                p.Stroke = Brushes.Blue;
                p.StrokeThickness = 0.25;
                p.Points.Add(transform.Transform(geometry.Positions[geometry.TriangleIndices[i++]]));
                p.Points.Add(transform.Transform(geometry.Positions[geometry.TriangleIndices[i++]]));
                p.Points.Add(transform.Transform(geometry.Positions[geometry.TriangleIndices[i++]]));
                canvas.Children.Add(p);
            }
        }
    } 
```

这也考虑了模型上的任何变换等。

另请参阅：http: [//blogs.msdn.com/wpf3d/archive/2009/05/13/transforming-bounds.aspx](http://blogs.msdn.com/wpf3d/archive/2009/05/13/transforming-bounds.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T06:10:35.647

由于 Windows 坐标是 z 进入屏幕（x 交叉 y），我会使用类似的东西

```
screenY = viewPort.ActualHeight * (1 - screenY); 
```

代替

```
screenY = screenY * viewPort.ActualHeight; 
```

更正 screenY 以适应 Windows。

或者，您可以使用 OpenGL。当您设置视口 x/y/z 范围时，您可以将其保留为“本机”单位，并让 OpenGL 转换为屏幕坐标。

编辑：因为你的原点是中心。我会尝试

```
screenX = viewPort.ActualWidth * (screenX + 1.0) / 2.0
screenY = viewPort.ActualHeight * (1.0 - ((screenY + 1.0) / 2.0)) 
```

屏幕 + 1.0 从 [-1.0, 1.0] 转换为 [0.0, 2.0]。此时，除以 2.0 得到 [0.0, 1.0] 的乘法。考虑到 Windows y 从笛卡尔 y 翻转，您可以通过从 1.0 中减去前一个屏幕来从 [1.0, 0.0]（左上到左下）转换为 [0.0, 1.0]（从上到下）。然后，您可以缩放到 ActualHeight。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T05:27:34.487

1.  尚不清楚您要使用 aspectRatio 系数实现什么目标。如果该点在视野边缘，那么它应该在屏幕边缘，但如果 aspectRatio!=1 则不是。尝试设置 aspectRatio=1 并使窗口呈正方形。坐标还是不正确吗？

2.  `ActualWidth`并且`ActualHeight`似乎真的是窗口大小的一半，所以 screenX 将是 [-ActualWidth; 实际宽度]，但不是 [0; 实际宽度]。那是你要的吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T05:44:32.690

screenX 和 screenY 应该相对于屏幕中心进行计算...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T05:47:45.287

对于使用 Windows API 绘图时，原点位于屏幕左上角这一事实，我没有看到更正。我假设你的坐标系是

```
y
|
|
+------x 
```

另外，根据斯科特的问题，您的坐标系是假设原点在中心，还是在左下角？

但是，Windows 屏幕 API 是

```
+-------x
|
|
|
y 
```

您需要坐标变换才能从经典笛卡尔坐标转换到 Windows。

# jquery - jQuery 自动完成标记插件类似于 StackOverflow 的输入标记？

> ID：519107
> 
> 赞同：529
> 
> 时间：2009-02-06T04:27:57.913
> 
> 标签：jquery, autocomplete, tags

什么解决方案可以实现与 SO 用于输入标签的相同的自动完成功能？

有些插件可以处理一个单词，但我还没有看到任何可以处理多个单词的插件。

* * *

## 回答 #1

> 赞同：773
> 
> 时间：2010-04-20T11:01:54.790

按照活动、可用的演示/示例和简单性的顺序：

*   （[演示](https://github.com/yairEO/tagify#demo-page)）[https://github.com/yairEO/tagify](https://github.com/yairEO/tagify)
*   （[演示](https://aehlke.github.io/tag-it/examples.html)）[https://github.com/aehlke/tag-it](https://github.com/aehlke/tag-it)
*   （[演示](http://xoxco.com/projects/code/tagsinput/)）[https://ioncache.github.io/Tag-Handler/](https://ioncache.github.io/Tag-Handler/)
*   （[演示](http://textextjs.com/)）[http://textextjs.com/](http://textextjs.com/)
*   （[演示](http://tagedit.webwork-albrecht.de/playground.html)）[https://github.com/webworka/Tagedit](https://github.com/webworka/Tagedit)
*   （[演示](http://documentcloud.github.com/visualsearch/#demo)）[https://github.com/documentcloud/visualsearch/](https://github.com/documentcloud/visualsearch/)
*   （[演示](http://harvesthq.github.io/chosen/#multiple-select)）[http://harvesthq.github.io/chosen/](http://harvesthq.github.io/chosen/)（这不是一个真正的标签插件）
*   （演示？）[http://bootstrap-tagsinput.github.io/bootstrap-tagsinput/examples/](http://bootstrap-tagsinput.github.io/bootstrap-tagsinput/examples/)
*   （演示？）[http://jcesar.artelogico.com/jquery-tagselector/](http://jcesar.artelogico.com/jquery-tagselector/)
*   （演示？）[http://remysharp.com/wp-content/uploads/2007/12/tagging.php](http://remysharp.com/wp-content/uploads/2007/12/tagging.php)
*   （演示？）[http://pietschsoft.com/post/2011/09/09/Tag-Editor-Field-using-jQuery-similar-to-StackOverflow.aspx](http://pietschsoft.com/post/2011/09/09/Tag-Editor-Field-using-jQuery-similar-to-StackOverflow.aspx)

有关的：

*   [https://meta.stackexchange.com/questions/100669/feedback-wanted-improved-tag-editor](https://meta.stackexchange.com/questions/100669/feedback-wanted-improved-tag-editor)

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2013-02-10T07:51:20.750

**Bootstrap：**如果您使用的是 Bootstrap。这是一个非常好的选择：[Select2](http://ivaynberg.github.com/select2/)

此外，[TokenInput](http://loopj.com/jquery-tokeninput/)是一个有趣的。首先，它不依赖 jQuery-UI，其次它的配置非常流畅。

我遇到的唯一问题是本机不支持免费标记。因此，我必须将查询字符串作为响应 JSON 的一部分返回给客户端。

* * *

正如@culithay 在评论中提到的那样，TokenInput 支持许多自定义功能。并突出其他人没有的一些功能：

*   tokenLimit：允许用户选择的最大结果数。使用 null 允许无限选择
*   minChars：执行搜索前用户必须输入的最少字符数。
*   queryParam：您希望在服务器端包含搜索词的查询参数的名称

感谢 culithay 的输入。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-06T14:15:16.887

这最初回答了一个关于下载 jQuery 与通过 CDN 访问它的智慧的补充问题，CDN 不再存在......

回答关于谷歌的问题。我已经转移到通过我网站中相应的 CDN 访问 JQuery 和大多数其他此类库。

随着越来越多的人这样做，这意味着它更有可能被缓存在用户的机器上，所以我的投票赞成好主意。

自从我第一次提出这个问题以来的五年里，它已成为普遍的智慧。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-08-07T03:06:23.533

另一个优秀的插件可以在[https://documentcloud.github.io/visualsearch/找到](https://documentcloud.github.io/visualsearch/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-12-21T12:28:43.577

检查这个插件：

*   [来源](https://github.com/aehlke/tag-it)
*   [基本演示](http://aehlke.github.com/tag-it)
*   [更多示例](http://aehlke.github.com/tag-it/examples.html)

如何使用 AJAX 加载标签[https://stackoverflow.com/a/7662534/1078027](https://stackoverflow.com/a/7662534/1078027)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-05T21:23:42.477

我们刚刚在 Github 上开源了这个 jquery 插件[： tactivos/jquery-sew](https://github.com/tactivos/jquery-sew)。

# asp.net - 文件不以“%PDF-”开头

> ID：519108
> 
> 赞同：2
> 
> 时间：2009-02-06T04:28:04.310
> 
> 标签：asp.net, pdf, export

我正在将 HTML 内容导出为 PDF。

```
 System.IO.StringWriter sWriter = new System.IO.StringWriter();

    System.Web.UI.HtmlTextWriter htmlWriter = new HtmlTextWriter(sWriter);

    Response.Buffer = true;
    FormId.RenderControl(htmlWriter);
    Response.ContentType = "application/pdf";
    // Added appropriate headers
    Response.AddHeader("Content-Disposition", "inline; filename=XXX.pdf");
    Response.AddHeader("Content-Length", htmlWriter.ToString().Length.ToString());
    Response.Output.Write(sWriter.ToString());

    Response.Flush();
    Response.Close(); 
```

FormId 是我过去的内容的 Div ..

我收到错误消息，因为“文件不以 '%PDF-' 开头”

我已经包含了 Response.clear(); 输出不来

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T04:30:59.077

您在输出流中的 pdf 之前渲染出 html（如您所说的 div），因此将两者结合在一起。这会导致任何查看输出的应用程序将其解释为损坏的文件。我会尝试删除前两行：

```
Response.Buffer = true;
FormId.RenderControl(htmlWriter); 
```

如果这不能解决问题，请在所有内容之前添加一个 Response.Clear() 调用。

这一切都假设 sWriter 在此代码块的开头包含 PDF - 如果没有，更多的上下文可能会有所帮助。

一些建议：如果可能，将其移出页面到 .ashx 或其他 IHttpHandler。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T11:46:36.113

在将一些 HTML 内容写入 PDF 时，我遇到了同样的问题。

我终于发现无效的 HTML 内容导致了这个问题。

例如，`<ul>`不带结束标签的标签`</ul>`。

一旦我放入正确的结束标签，它就可以正常工作！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T04:37:59.970

在开始流式传输输出之前执行 Response.Clear()。

# c# - ToUniversalTime() 关于 Outlook 插件中的重复模式？

> ID：519123
> 
> 赞同：0
> 
> 时间：2009-02-06T04:37:53.790
> 
> 标签：c#, outlook

我正在尝试获取约会项目 RecurrencePattern 对象的 UTC 时间：

```
Outlook.RecurrencePattern r = appt.GetRecurrencePattern();
String utcDate = r.StartTime.ToUniversalTime().ToString("yyyy-MM-dd");
MessageBox.Show(utcDate); 
```

我得到的不是我期待的日期（2009-02-05），而是 1899-12-30。我注意到 Microsoft 帮助页面 ( [http://msdn.microsoft.com/en-us/library/ms526846(EXCHG.10).aspx](http://msdn.microsoft.com/en-us/library/ms526846(EXCHG.10).aspx) ) 说 StartTime 在本地日期时间内部举行 - 这是否意味着我不能使用此 DateTime 对象转换为 UTC 时间？我是否需要访问第一个约会项目并从中找出定期约会系列的开始时间？

- - 编辑 - -

实际上，r.StartTime 本身似乎返回 1899 年的日期。重复模式上的所有其他参数似乎都工作正常（除了 enddate，它也返回 1899 年的日期） - StartTime 不应默认为与原来的appt项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T04:48:46.123

仍然不确定为什么我无法获得 StartTime 对象的 UTC 时间，但事实证明可以使用 AppointmentItem 对象的 StartUTC 属性来生成重复模式。如果使用“打开系列”选项打开定期项目，则活动的 AppointmentItem 是系列中的第一个约会（即使要到达那里，用户单击系列中稍后的约会项目）。

# visual-studio - 当 Visual Studio 告诉我我的项目不支持代码时，这是什么意思？

> ID：519125
> 
> 赞同：17
> 
> 时间：2009-02-06T04:38:32.260
> 
> 标签：visual-studio

> **可能重复：**
> [设计器视图中的 Windows 窗体控件中的错误](https://stackoverflow.com/questions/369393/errors-in-windows-forms-controls-in-designer-view)

文件 'C:\Users[path removed]\ReportForm.cs' 不支持代码解析或生成，因为它不包含在支持代码的项目中。

[![替代文字](https://i.stack.imgur.com/902hx.gif)](https://i.stack.imgur.com/902hx.gif)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-30T14:41:14.100

当我重命名一个表单然后关闭并重新打开 VS 时，我遇到了这个问题。错误被抛出，我看不到设计器。我的补救措施是检查以确保项目表单正在寻找我新命名的表单而不是旧名称，如果它是旧名称，则只需删除它并添加->现有项目。

从那时起，一切都应该很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-27T12:57:57.493

对我有帮助的解决方案是我在兼容模式下运行我的 VS，并且还以管理员身份运行。

为了使其顺利运行，您必须取消选中“兼容性”和“以管理员身份运行”选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T05:30:13.577

我不认为问题在于缺乏支持代码。更有可能的是，ReportForm.cs 或 ReportForm.designer.cs 中的代码无法被 WinForms 设计器类解析。您可以通过删除所有代码并输入一些非常简单的内容并重新加载设计器来验证这一点。

例子：

```
public class ReportForm(){ 
  public ReportForm(){}
} 
```

# c++ - 制作方法模板 - C++

> ID：519132
> 
> 赞同：0
> 
> 时间：2009-02-06T04:40:40.227
> 
> 标签：c++, templates

下面的代码用于从 ASCII 代码中获取*std::string表示。*

```
string Helpers::GetStringFromASCII(const int asciiCode) const
{
    return string(1,char(asciiCode));
} 
```

它运作良好。但在我的应用程序中，我在编译时就知道 ASCII 代码。所以我会这样称呼它

```
string str =  GetStringFromASCII(175) // I know 175 at compile time 
```

问题

有什么方法可以使*GetStringFromASCII*方法成为模板，以便在编译时进行处理，并且我可以避免每次在运行时调用该函数。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T04:53:04.120

当您处理像`int`s 和`float`s 这样的原始数据类型时，这种模板元编程很有效。如果你一定需要一个字符串对象，你就不能避免调用`std::string`构造函数，并且调用不可能在编译时发生。另外，我认为您也不能将演员拖到`char`编译时间，这总而言之，这意味着模板在这里无法为您提供帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T04:50:04.703

不要将 int 常量提供给字符串转换函数，而是直接使用字符串常量：

> `string str("\xAF"); // 0xAF = 175`

顺便说一句，除了循环中的大量性能需求外，在某些 CPU 周期内交易代码可读性总体上很少有钱有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T22:20:05.223

你为什么还要为辅助函数而烦恼？

```
string s( 1, char(175) ); 
```

这就是你所需要的，而且它是你将得到的最快的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T04:49:51.333

像这样的东西怎么样：

```
#include <iostream>
#include <string>

using namespace std;

template <int asciiCode>
inline string const &getStringFromASCII()
{
  static string s(1,char(asciiCode));
  return s;
}

int main(int, char const**) {
  cout << getStringFromASCII<65>() << endl;
} 
```

**编辑**：现在返回一个参考

# c# - 墙纸循环器上的计时器

> ID：519135
> 
> 赞同：1
> 
> 时间：2009-02-06T04:41:56.577
> 
> 标签：c#, timer, software-quality

[我刚刚向Coding4Fun](http://blogs.msdn.com/coding4fun/archive/2006/11/13/1067250.aspx)项目添加了一些额外的功能。我的项目设置了一个额外的选项，允许它在 X 时间后自动更改背景。X 是从 ComboBox 设置的。但是，我知道我以一种糟糕的方式做到了这一点，因为我创建了一个以 System.Timers.Timer 作为父级的新计时器类，因此当调用 ElapsedEventHandler 中的静态方法时，我可以返回表单并调用 ChangeDesktopBackground()。

在用户定义的时间间隔内调用 ChangeDesktopBackground() 的更好方法是什么？

这是我当前的解决方案，其中涉及我将发件人转换为我继承的计时器，然后获取对表单的引用，然后调用 ChangeDesktopBackground 方法。

```
private static void timerEvent(object sender, System.Timers.ElapsedEventArgs e)
{
    ((newTimer)sender).getCycleSettingsForm().ChangeDesktopBackground();
} 
```

编辑：添加编码示例以显示当前解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T03:10:17.523

我之前写过类似的东西。System.Timers.Timer 对此太过分了。您可能应该使用 System.Windows.Forms.Timer，原因如下：

1.  您正在做的事情不必太精确。Windows 计时器只是发送到 Windows 应用程序消息泵的 WM_TIMER 消息，因此您不会获得超高的精度，但每秒更换一次壁纸是不现实的。（我写了我的，每 6 小时左右更换一次）
2.  在使用执行某种基于计时器的任务的 Windows 窗体应用程序时，如果您使用 System.Timers.Timer，您将遇到各种线程关联问题。任何 Windows 控件都与创建它的线程有关联，这意味着您只能修改该线程上的控件。Windows.Forms.Timer 将为您完成所有这些工作。（对于未来的吹毛求疵者，更换壁纸并不算数，因为这是注册表值的更改，但规则普遍适用）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T06:29:13.643

计时器可能是最直接的方法，尽管我不确定您是否正确使用了计时器。以下是我在项目中使用计时器的方式：

```
// here we declare the timer that this class will use.
private Timer timer;

//I've shown the timer creation inside the constructor of a main form,
//but it may be done elsewhere depending on your needs
public Main()
{

   // other init stuff omitted

   timer = new Timer();     
   timer.Interval = 10000;  // 10 seconds between images
   timer.Tick += timer_Tick;   // attach the event handler (defined below)
}

void timer_Tick(object sender, EventArgs e)
{
   // this is where you'd show your next image    
} 
```

然后，您将连接您的 ComboBox onChange 处理程序，以便更改 timer.Interval。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-09T14:52:53.727

我会为此使用 Microsoft 的反应式框架。只是 NuGet“Rx-WinForms”。

这是代码：

```
var subscription =
    Observable
        .Interval(TimeSpan.FromMinutes(1.0))
        .ObserveOn(this)
        .Subscribe(n => this.getCycleSettingsForm().ChangeDesktopBackground()); 
```

阻止它只是做`subscription.Dispose()`。

简单的。

# javascript - 如何检查 JavaScript 中是否定义了变量？

> ID：519145
> 
> 赞同：460
> 
> 时间：2009-02-06T04:49:12.130
> 
> 标签：javascript, dom, undefined

如何检查是否以跨浏览器方式定义的 JavaScript 变量？

我在使用 FireBug 日志编写一些 JavaScript 时遇到了这个问题。我写了一些如下代码：

```
function profileRun(f) {
    // f: functions to be profiled
    console.profile(f.constructor);
    f();
    console.profileEnd(f.constructor);
} 
```

它在 FireFox/FireBug 中运行良好，但在 IE8 RC1 中报告错误。所以，我想检查一下执行环境中是否存在***控制台变量。***

下面的代码在 FireFox 中运行良好，但在 IE8 RC1 中却不行。

```
function profileRun(f) {
    if (console != undefined) {
        console.profile(f.constructor);
    }

    f();

    if (console != undefined) {
        console.profileEnd(f.constructor);
    }
} 
```

但是，如果我这样做。它适用于 IE8 RC1。为什么？

```
function profileRun(f) {
    if (window.console != undefined) {
        console.profile(f.constructor);
    }

    f();

    if (window.console != undefined) {
        console.profileEnd(f.constructor);
    }
} 
```

有没有跨浏览器的方法来检查它？

# http - Web 服务器的最佳加载方式

> ID：519150
> 
> 赞同：0
> 
> 时间：2009-02-06T04:51:42.797
> 
> 标签：http, distributed

如果一个 Web 服务器每天要提供 100GB 的服务，最好是在 10,000 个 10MB 会话或 200,000 个 500kB 会话中这样做。

这个问题的原因是我想知道镜像内容以允许客户端利用 HTTP 的中间开始功能从许多服务器分段下载文件的站点是否有任何优势、劣势或两者都没有。（IIRC 这有点像洪流作品）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T08:50:45.200

我想不仅会议的规模很重要，而且会议的持续时间也很重要。我猜想 200,000 个小会话的寿命会比 10,000 个大会话短。一旦会话完成，资源就会被释放以再次使用。我会优化它，使会话尽可能短。

还要记住，单个服务器不能同时拥有超过几百个会话（100 - 200 是一个安全数字）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T09:14:17.447

100 GB/天不是您需要担心的数字。它的平均速度略高于 1 MBYte/秒。你可以通过旧的以太网来获得它，以正确看待这一点。现在，您的实际峰值吞吐量会高得多，可能是 10 MByte/s。不过，对于现代服务器来说，这完全没有问题。所以，我认为你不需要那些多台服务器，所以这不是拆分 10MB 下载的理由。如果您从单个服务器下载，为什么要在 10MB 下载的中间插入 19 个断开连接并重新连接序列？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T05:07:42.937

每个会话通常都会有一些开销——例如创建 TCP 连接的成本，或 HTTP 标头（如果您尚未将它们包含在 100GB 中）——所以表面上最好使用更大的会话。但也要从客户的角度考虑：通过使用多个较小的会话，他们可以并行运行下载，并可能更快地获取内容。因此，实际的“最佳”设置可能是一些中间会话大小，这当然取决于您提供的内容类型（大文件或小文件，流式或静态）以及您认为速度的重要性。没有一刀切的答案。

# visual-studio-2005 - VS 2005 IDE 有哪些 AddOns/AddIns 可用

> ID：519162
> 
> 赞同：1
> 
> 时间：2009-02-06T05:00:23.480
> 
> 标签：visual-studio-2005, add-in

我想要一份可用于 VS 2005 IDE 的插件/插件的完整列表

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T05:28:20.973

欺骗：

[适用于本机 Visual Studio 开发人员的有用加载项或插件](https://stackoverflow.com/questions/379453/useful-add-ins-or-plug-ins-for-native-visual-studio-developer)

[Microsoft Visual Studio 的推荐加载项/插件](https://stackoverflow.com/questions/2767/do-you-have-any-recommended-add-onsplugins-for-microsoft-visual-studio)

[您使用哪些 Visual Studio 加载项？](https://stackoverflow.com/questions/15784/what-visual-studio-add-ins-do-you-use)

[Visual Studio 附加库？](https://stackoverflow.com/questions/389705/visual-studio-add-on-gallery)

还有许多其他......没有明确的清单。

# c++ - 除非涉及 endl，否则返回字符串的 C++ 函数不起作用......？

> ID：519180
> 
> 赞同：0
> 
> 时间：2009-02-06T05:07:06.617
> 
> 标签：c++, string, stl

我在一个返回字符串的类中有一个函数。在这个函数内部，我只有 `cout<<endl` 在 return 语句之前添加到函数时才能让它工作。知道为什么会这样，或者我该如何解决？我在 Mac 上的 Eclipse 中运行它

在“main.cpp”中：

```
#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <cstdlib>
#include "Braid.h"
using namespace std;

static int size=3;

int main(){  
Braid * b1 = new Braid(size);
b1->setCanon();//creates canonical braid. 

cout<<"a ";
cout<<b1->getName()<<endl;
cout<<" b ";
} 
```

在“编织.h”中：

```
 public:  
        Braid(int);  
        void setCanon();  
        string getName(); 
    }; 
```

在“Braid.cpp”中：

```
string Braid::getName(){  
    string sName="";  

    /* body commented out
    for(int i=0; i<height; i++)
    {
        for(int j=2; j<(width-2); j++)
            {
                sName += boxes[i][j];
                sName += "|";
            }
        }

        */  
        //cout<<endl;
        return sName;
    } 
```

当我运行我的主代码时，没有注释该函数的主体，我得到的输出是
**“a 0|0|12|12|0|0|2|1|1|1|1|2|”**

它返回的“名称”是正确的，但它并没有通过函数调用。如果我取消注释该`//cout<<endl`行，该函数将起作用，我的输出是
**“a 0|0|12|12|0|0|2|1|1|1|1|2|
b”**

在注释掉函数体之后，它只创建一个空字符串并返回它，我的输出只有“a”，然后如果我添加 endl，我会得到预期的“a b”。

我究竟做错了什么？endl 有什么我缺少的东西吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-06T05:15:26.990

实际上*getName()*函数可能工作正常。但是，cout 会“缓存”输出（即，当内部文本缓冲区已满时，它会在屏幕上打印输出）。'endl' 刷新缓冲区并强制 cout 将文本（在缓存中）转储到屏幕。

在 main.cpp 中尝试 cout.flush()

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T05:17:25.130

也许您的终端很懒惰。尝试省略`endl`和 insert `cout.flush(`) 作为下一行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T05:27:58.480

`cout` *应*在程序结束时刷新。

```
fow@lapbert ~ % cat blah.cpp
#include <iostream>

int main() {
    std::cout << sizeof(int);
}
fow@lapbert ~ % ./a.out
4 
```

# audio - Libsox 编码

> ID：519188
> 
> 赞同：0
> 
> 时间：2009-02-06T05:11:00.387
> 
> 标签：audio, wav

如果我使用 libsox 将 wav 文件转换为：

```
&in->encoding.encoding = SOX_ENCODING_UNSIGNED;
&in->encoding.bits_per_sample = 8; 
```

使用上面的代码？

输入文件的 bits_per_sample = 16。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T05:55:58.923

所以你是说你告诉 SOX 将 16 位样本 WAV 文件作为 8 位样本文件读取？对 SOX 一无所知，我希望它将每个 16 位样本读取为两个 8 位样本……高位字节和低位字节如下：……HLHLHLHLHL……

为简单起见，我们将高位字节样本称为“A”样本。“A”样本携带动态范围较小的原始声音，因为具有额外精度的低位字节已被截断。

我们将把低位字节样本称为“B 样本”。这些将大致是随机的并编码噪声。

因此，作为结果，我们将原始声音“A”样本的频率降低了一半。这是因为在每个“A”样本之间都有一个“B”样本，这将“A”样本的速率减半。“B”样本为原始声音添加了噪音。所以我们将得到原始声音，降低一半，并带有噪音。

这是你听到的吗？

**编辑**客人评论说，目标是将 WAV 下变频为 8 位音频。阅读 SoX 的[手册页，](http://sox.sourceforge.net/libsox.html)由于 sox_read()，SoX 似乎总是在内存中使用 32 位音频。将格式传递给它只会使它尝试*从*该格式读取。

要在内存中进行下转换，请使用 sox.h 中的 SOX_SAMPLE_TO_SIGNED_8BIT 或 SOX_SAMPLE_TO_UNSIGNED_8BIT，即：

```
sox_format_t ft = sox_open_read("/file/blah.wav", NULL, NULL);
if( ft ) {
    sox_ssample_t buffer[100];
    sox_size_t amt = sox_read(ft, buffer, sizeof(buffer));
    char 8bitsample = SOX_SAMPLE_TO_SIGNED_8BIT(buffer[0], ft->clips);
} 
```

要输出下转换文件，请在写入时使用 8 位格式，而不是在读取时使用。

# wpf - 3D 图形编程初学者指南

> ID：519200
> 
> 赞同：25
> 
> 时间：2009-02-06T05:18:10.823
> 
> 标签：wpf, graphics, 3d

对于在 3D 图形编程领域经验最少（或没有经验）的人来说，最好的指南/教程/书籍/网站是什么？

我意识到 3D 图形和数学的基础知识适用于平台特定的 3D 库实现，例如 OpenGL、DirectX、WPF 等。

因此，如果答案能解释他们是否专注于特定的库实现、基础知识或两者兼而有之，那将是有用的。

问这个问题的理由：

随着 Windows Presentation Foundation (WPF) 3D 的出现，许多程序员现在可以认真考虑在他们的应用程序中使用 3D，这在几年前几乎是不可能的。

我敢肯定有很多程序员，像我一样，发现从 2D 到 3D 的飞跃非常大。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T04:10:51.987

我建议您实现一个简单的基于软件的 3d 渲染引擎。简单的东西，如线条、四边形、照明等。总体而言，您将学到更多关于 3d 编程的知识，它会为您提供关于 3d 图形及其局限性的良好说明。

这应该让你开始： http: [//www.devmaster.net/articles/software-rendering/part1.php](http://www.devmaster.net/articles/software-rendering/part1.php)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-06T05:21:49.973

如果您正在使用 WPF，那么Petzold 的[3D Programming for Windows显然是一个开始。](http://www.charlespetzold.com/3D/)

对于 Opengl，这本书可以[在线免费获得，](http://www.opengl.org/documentation/red_book/) [NeHe](http://nehe.gamedev.net/)也有教程，尽管 OpenGL 确实要求您了解变换的细节才能真正做的不仅仅是剪切和粘贴。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-06T05:20:59.507

我想我会先提供我在自己的研究中发现的这个资源：

Eric Sink[的 WPF 3D 十二天。](http://www.ericsink.com/wpf3d/)

这是一系列专注于 WPF 的文章，从初级到中级。

它专注于使用 WPF 3D 完成实际工作，而不是基本的 3D 数学等，但非常适合回答大多数 WPF 3D 程序员最终遇到的一些常见问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T05:26:03.350

我之前推荐过的一个网站是[GameDev](http://www.gamedev.net/)。它充满了 3D 游戏开发的文章和教程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T05:47:25.540

你想学做什么？构建图形/游戏引擎？或使用图形或游戏引擎？..

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T03:59:44.573

我选择了简单的路线。我正在使用可用的引擎 - www.3dgamestudio.com - 所以我可以专注于实际游戏。我觉得重新发明轮子需要太多时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-25T04:03:27.963

很好地处理事物背后的数学可能会很有用。本[教程](http://chortle.ccsu.edu/VectorLessons/vectorIndex.html)是一个很好的起点。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-06-29T10:15:08.067

我绝对推荐的一本书是Foley 和 Van Dam 的[Computer Graphics](http://www.amazon.co.uk/Computer-Graphics-reissued-2nd-Ed/dp/0201848406)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-02T19:49:21.217

这是一个很好的动手教程，可以快速入门，包括一些数学理论：[http ://www.kindohm.com/technical/wpf3dtutorial.htm](http://www.kindohm.com/technical/wpf3dtutorial.htm)

# php - 从 PHP 连接到 Microsoft SQL Server Express (2008) 时遇到问题

> ID：519203
> 
> 赞同：2
> 
> 时间：2009-02-06T05:19:06.813
> 
> 标签：php, sql-server, tsql, connect

正如标题所说，我在从 PHP 脚本连接到 MSSQL 时遇到问题。

设置： -

*   PHP 在 Apache Linux 服务器上运行。
*   Microsoft SQL Server 2008 在 XP 机器上。
*   我在 MSSQL Server 中打开了远程连接。
*   数据库 bggs 确实存在。
*   数据库正在运行（我可以看到一个绿色箭头）。
*   我在 XP 机器上没有防火墙。

如果您有任何调试问题，请随时提出。

**我正在使用以下测试脚本。**

```
<?php
    include('adodb5/adodb.inc.php');
    $db =& ADONewConnection('odbc_mssql');
    $db->debug = true;
    $dsn = "Driver={SQL Server};Server=ozmodiar;Database=bggs;";
    $db->Connect($dsn,'user','password');
    $rs = $db->Execute('select * from admin_users');
    print "<pre>";
    print_r($rs->GetRows());
    print "</pre>";
?> 
```

**得到以下结果。**

警告：odbc_connect() [function.odbc-connect]: SQL 错误：[unixODBC][Driver Manager]Data source name not found, and no default driver specified, SQL 状态 IM002 in SQLConnect in /mnt/filestore/vhost/bggs/ hr_database/Dev/includes/adodb5/drivers/adodb-odbc.inc.php 在第 60 行 (odbc_mssql)：SET CONCAT_NULL_YIELDS_NULL OFF
警告：odbc_exec()：提供的参数不是 /mnt/filestore/vhost 中的有效 ODBC-Link 资源/bggs/hr_database/Dev/includes/adodb5/drivers/adodb-odbc.inc.php on line 530 IM002: [unixODBC][Driver Manager]Data source name not found, and no default driver specified

ADOConnection._Execute(SET CONCAT_NULL_YIELDS_NULL OFF, false) % 第 1017 行，文件：adodb.inc.php ADOConnection.Execute(SET CONCAT_NULL_YIELDS_NULL OFF) % 第 62 行，文件：adodb-odbc.inc.php ADODB_odbc._connect(Driver={SQL Server};Server=192.168.70.130;Database=bggs;, sa, knd121, ) % line 524, file: adodb.inc.php ADOConnection.Connect(Driver={SQL Server};Server=192.168.70.130;Database=bggs ;, sa, knd121) % 第 9 行，文件：test_db.php

Driver={SQL Server};Server=192.168.70.130;Database=bggs;: [unixODBC][Driver Manager]未找到数据源名称，并且未指定默认驱动程序 (odbc_mssql): select * from admin_users
警告: odbc_exec():提供的参数不是 /mnt/filestore/vhost/bggs/hr_database/Dev/includes/adodb5/drivers/adodb-odbc.inc.php 中的有效 ODBC 链接资源 530 IM002：[unixODBC][Driver Manager]Data未找到源名称，并且未指定默认驱动程序

ADOConnection._Execute(select * from admin_users, false) % line 1017, file: adodb.inc.php ADOConnection.Execute(select * from admin_users) % line 10, file: test_db.php

致命错误：在第 12 行的 /mnt/filestore/vhost/bggs/hr_database/Dev/includes/test_db.php 中的非对象上调用成员函数 GetRows()

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T05:45:26.853

**免责声明：**我只从 Microsoft SQL Server 2000 查询数据，但通过 PDO_DBLIB 查询数据，尽管我相信为 ADODB 或 PDO_DBLIB 提供 freetds 驱动程序的先决条件是肯定的。

从最初的错误消息来看，您没有安装必要的驱动程序。为了让您的应用程序能够访问服务器，您需要安装 freetds，它将安装必要的驱动程序并允许您设置 ODBC 连接。查看：[http ://www.linuxjournal.com/article/6636](http://www.linuxjournal.com/article/6636)

请务必注意，您需要`tds version = x.x`在 freetds 全局配置或特定 OBDC 连接（debian 上默认为 /etc/freetds/freetds.conf）中正确设置“”，否则 freedtds 与您的服务器使用的协议将不正确脚本会爆炸。

# asp.net-mvc - MVC 路由有问题

> ID：519222
> 
> 赞同：0
> 
> 时间：2009-02-06T05:32:41.450
> 
> 标签：asp.net-mvc, routing

我正在尝试实现如下路由：

帖子/535434/这是一个帖子标题

```
posts/tagged/tags+here
// Matches {controller}/{action}/{id} - Default
// Displays all posts with the specified tags
// uses PostsController : ActionTagged(string tags)

posts?pageSize=50&pageIndex=4
// Matches {controller}/{action}/{id} - Default
// Displays all posts
// uses PostsController : Index(int? pageSize, int? pageIndex) 
```

这是我想要这样做的问题：

```
posts/39423/this-is-a-post-title-here
// Typically this is implemented using an action like 'Details'
// and would normally look like : posts/details/5 
```

我似乎无法让路由正常工作。我试过这样的事情：

```
{controller}/{id}/{description} 
```

并将默认操作设置为“显示”，它可以工作，但不允许我导航到其他命名操作，如“标记”。

我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T05:56:43.757

两件事情：

首先，您应该始终以递减的特异性对路线进行排序（例如，最具体的情况在前，最不具体的情况在后），这样路线将“通过”，如果一个不匹配，它将尝试下一个。

所以我们想在定义 {controller}/{action}/... 之前定义 {controller}/{postid}/... （必须是 postid）（可以是其他任何东西）

接下来，我们希望能够指定如果为 postid 提供的值看起来不像 Post ID，则路由应该失败并掉到下一个。我们可以通过创建一个 IRouteConstraint 类来做到这一点：

```
public class PostIDConstraint : IRouteConstraint
{ 
  public bool Match(HttpContextBase httpContext,
    Route route,
    string parameterName, 
    RouteValueDictionary values, 
    RouteDirection routeDirection)
  {
    //if input looks like a post id, return true.
    //otherwise, false
  }
} 
```

我们可以像这样将它添加到路由定义中：

```
routes.MapRoute(
    "Default",
    "{controller}/{postid}/{description}",
    new { controller = "Posts", action = "Display", id = 0 },
    new { postid = new PostIDConstraint() }
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T06:20:07.173

我不是 100% 我理解你的问题，但听起来你可以定义几个不同的路线。

```
routes.MapRoute("PostId", "posts/{id}/{title}",
    new { Controller = "Posts", Action = "DisplayPost", id = 0, title = "" },
    new { id = @"\d+" });

routes.MapRoute("TaggedPosts", "posts/tagged/{tags}",
    new { Controller = "Posts", Action = "DisplayTagged", tags = "" });

routes.MapRoute("Default", "posts",
    new { Controller = "Posts", Action = "Index" }); 
```

您可以使用正则表达式来验证参数，例如我在第一条路由中用于 id 的参数，或者如果您想要更好的验证，请执行 Rex M 发布的操作。查询字符串参数 pageSize 和 pageIndex 不需要包含在您的路由中；只要参数名称匹配，它们就会被传递给您的 Index 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T06:38:36.230

实际上没有使用作为“描述”的网址部分。例如，这篇文章是 519222，我仍然可以使用 url 找到它：Mvc Routing 遇到[问题](https://stackoverflow.com/questions/519222/this-line-is-only-used-for-seo)

# ajax - AJAX 与 JavaScript 响应

> ID：519225
> 
> 赞同：0
> 
> 时间：2009-02-06T05:34:10.947
> 
> 标签：ajax

当我们使用 AJAX 进行验证时，响应来自 xml 文件，如果是 javascript，响应来自 html 页面。

是真的还是假的？请解释这两种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T05:39:58.393

Ajax 几乎可以返回任何东西。您的特定应用程序或实现可能会返回 XML，但 Ajax 通常也会返回 JSON 和 HTML。但它可以返回 TXT​​ 或只是状态码..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T05:56:15.130

AJAX 是一个如此广泛的术语，以至于您的两个案例都可以这样称呼。基本上，来自已加载页面的每个调用都是 AJAX，即使它是通过动态创建标签或刷新 iframe 来完成的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T06:02:52.747

实际上 Ajax 只不过是一个描述正在发生的事情的术语，响应以 xml 或 html 的形式出现，具体取决于您希望它返回的内容，它是 ajax 返回的字符串，在 Javascript 中由您决定如何处理字符串，想将其解析为 XML 节点吗？想要在元素“innerHMTL”中立即显示它或想要提醒返回的字符串...... ajax 的力量不是它返回的，而是它在服务器上（远程）执行的操作，而无需发送整个页面.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T06:04:21.400

AJAX 可以有任何类型的返回文本。使用 Javascript，它可以在 DOM 对象上工作并从页面中获取任何内容。

主要区别在于，AJAX*向服务器发出请求*并返回结果。

# java - 从 java.util.logging 中分离 INFO 和 ERROR 日志

> ID：519232
> 
> 赞同：6
> 
> 时间：2009-02-06T05:38:35.057
> 
> 标签：java, logging

我正在为 Java 应用程序配置日志记录。我的目标是两个日志：一个用于所有消息，一个用于特定级别以上的消息。

该应用程序使用`java.util.logging.*`类：我按原样使用它，因此我仅限于通过`logging.properties`文件进行配置。

我没有看到以不同方式配置两个 FileHandler 的方法：我见过的文档和示例设置属性如下：

```
java.util.logging.FileHandler.level = INFO 
```

虽然我想要两个不同的处理程序以不同的级别记录到不同的文件。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T08:10:59.507

[http://java.sun.com/j2se/1.4.2/docs/guide/util/logging/overview.html](http://java.sun.com/j2se/1.4.2/docs/guide/util/logging/overview.html)很有帮助。您只能为任何单个记录器设置一个级别（从记录器上的 setLevel() 方法可以看出）。但是，您可以采用两个常见级别中的最低级别，然后以编程方式进行过滤。

不幸的是，您不能仅使用配置文件来做到这一点。要仅使用配置文件进行切换，您必须切换到[log4j](http://logging.apache.org/log4j/1.2/index.html)之类的东西，您说过这不是一个选项。

因此，我建议使用过滤器更改登录代码，如下所示：

```
class LevelFilter implements Filter {
    private Level Level;
    public LevelFilter(Level level) {
        this.level = level;
    }
    public boolean isLoggable(LogRecord record) {
        return level.intValue() < record.getLevel().intValue();
    }
} 
```

然后在第二个处理程序上，执行 setFilter(new LevelFilter(Level.INFO)) 或其他任何操作。如果您希望它是可配置的文件，您可以使用您自己制定的日志记录属性设置，并使用普通的 Properties 方法。

我认为设置两个文件处理程序和编程代码的配置代码在您完成设计后相当简单，但如果您想要更多详细信息，请添加评论，我将进行编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T07:14:00.840

我认为您应该能够仅对处理程序进行子类化，然后覆盖这些方法以允许输出根据消息的级别发送到多个文件。这将通过覆盖 publish() 方法来完成。

或者，如果您**必须**使用系统提供的 FileHandler，您可以对其执行 setFilter() 以将您自己的过滤器注入到混合中，并在该过滤器代码中，将所有消息发送到您的其他文件，如果 LogRecord 则返回 true如果 INFO 或更高级别，则导致 FileHandler.publish() 将其写入真实文件。

我不确定这是您应该使用过滤器的方式，但我不明白为什么它不起作用。

# c# - 从另一个线程写入文本框？

> ID：519233
> 
> 赞同：70
> 
> 时间：2009-02-06T05:39:13.090
> 
> 标签：c#, winforms, multithreading

我无法弄清楚如何让 C# Windows 窗体应用程序从线程写入文本框。例如，在 Program.cs 中，我们有绘制表单的标准 main()：

```
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Application.Run(new Form1());
} 
```

然后我们在Form1.cs中有：

```
public Form1()
{
    InitializeComponent();

    new Thread(SampleFunction).Start();
}

public static void SampleFunction()
{
    while(true)
        WindowsFormsApplication1.Form1.ActiveForm.Text += "hi. ";
} 
```

我会完全错了吗？

**更新**

这是bendewey提供的工作代码示例：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        new Thread(SampleFunction).Start();
    }

    public void AppendTextBox(string value)
    {
        if (InvokeRequired)
        {
            this.Invoke(new Action<string>(AppendTextBox), new object[] {value});
            return;
        }
        textBox1.Text += value;
    }

    void SampleFunction()
    {
        // Gets executed on a seperate thread and 
        // doesn't block the UI while sleeping
        for(int i = 0; i<5; i++)
        {
            AppendTextBox("hi.  ");
            Thread.Sleep(1000);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-02-06T05:47:47.440

在您的 MainForm 上创建一个函数来设置文本框检查 InvokeRequired

```
public void AppendTextBox(string value)
{
    if (InvokeRequired)
    {
        this.Invoke(new Action<string>(AppendTextBox), new object[] {value});
        return;
    }
    ActiveForm.Text += value;
} 
```

尽管在您的静态方法中您不能只调用。

```
WindowsFormsApplication1.Form1.AppendTextBox("hi. "); 
```

您必须在某处对 Form1 进行静态引用，但这并不是真正推荐或不需要的，如果是这样，您可以让您的 SampleFunction 不是静态的，那么您可以调用

```
AppendTextBox("hi. "); 
```

它将附加在不同的线程上，并在需要时使用 Invoke 调用编组到 UI。

***完整样本***

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        new Thread(SampleFunction).Start();
    }

    public void AppendTextBox(string value)
    {
        if (InvokeRequired)
        {
            this.Invoke(new Action<string>(AppendTextBox), new object[] {value});
            return;
        }
        textBox1.Text += value;
    }

    void SampleFunction()
    {
        // Gets executed on a seperate thread and 
        // doesn't block the UI while sleeping
        for(int i = 0; i<5; i++)
        {
            AppendTextBox("hi.  ");
            Thread.Sleep(1000);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-12-11T01:16:11.283

我会尽可能多地使用`BeginInvoke`而不是，除非您真的需要等到您的控件更新（在您的示例中并非如此）。在 WinForms 消息队列上发布委托并让调用代码立即继续（在您的情况下是 for 循环）。不仅发布委托，还等待它完成。`Invoke``BeginInvoke``SampleFunction``Invoke`

因此，在`AppendTextBox`您示例的方法中，您将替换`Invoke`为`BeginInvoke`：

```
public void AppendTextBox(string value)
{
    if (InvokeRequired)
    {
        this.BeginInvoke(new Action<string>(AppendTextBox), new object[] {value});
        return;
    }
    textBox1.Text += value;
} 
```

好吧，如果你想更花哨，还有这个`SynchronizationContext`类，它可以让你基本上做同样的事情`Control.Invoke/Control.BeginInvoke`，但优点是不需要知道 WinForms 控件引用。[这](http://www.codeproject.com/KB/cpp/SyncContextTutorial.aspx)是一个关于`SynchronizationContext`.

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-02-06T06:26:31.200

或者你可以这样做

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        new Thread( SampleFunction ).Start();
    }

    void SampleFunction()
    {
        // Gets executed on a seperate thread and 
        // doesn't block the UI while sleeping
        for ( int i = 0; i < 5; i++ )
        {
            this.Invoke( ( MethodInvoker )delegate()
            {
                textBox1.Text += "hi";
            } );
            Thread.Sleep( 1000 );
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-08-13T09:17:41.630

很简单，不用担心代表：

```
if(textBox1.InvokeRequired == true)
    textBox1.Invoke((MethodInvoker)delegate { textBox1.Text = "Invoke was needed";});

else
    textBox1.Text = "Invoke was NOT needed"; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-06T12:12:19.070

您需要从拥有该控件的线程执行操作。

这就是我在不添加太多代码噪音的情况下这样做的方式：

```
control.Invoke(() => textBox1.Text += "hi"); 
```

其中 Invoke 重载是[Lokad 共享库](http://abdullin.com/shared-libraries/)的一个简单扩展：

```
/// <summary>
/// Invokes the specified <paramref name="action"/> on the thread that owns     
/// the <paramref name="control"/>.</summary>
/// <typeparam name="TControl">type of the control to work with</typeparam>
/// <param name="control">The control to execute action against.</param>
/// <param name="action">The action to on the thread of the control.</param>
public static void Invoke<TControl>(this TControl control, Action action) 
  where TControl : Control
{
  if (!control.InvokeRequired)
  {
    action();
  }
  else
  {
    control.Invoke(action);
  }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-06T05:48:07.457

看看[Control.BeginInvoke](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx)方法。关键是永远不要从另一个线程更新 UI 控件。BeginInvoke 会将调用分派给控件的 UI 线程（在您的情况下为 Form）。

要获取表单，请从示例函数中删除静态修饰符并使用 this.BeginInvoke()，如 MSDN 中的示例所示。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-06T06:38:10.180

更简单的是只使用 BackgroundWorker 控件...

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-05-22T09:29:32.703

这是我为避免`CrossThreadException`和从另一个线程写入文本框所做的工作。

这是我的`Button.Click`函数-我想生成随机数量的线程，然后在该工作线程中`IDs`通过调用`getID()`方法和 TextBox 值来获取它们。

```
private void btnAppend_Click(object sender, EventArgs e) 
{
    Random n = new Random();

    for (int i = 0; i < n.Next(1,5); i++)
    {
        label2.Text = "UI Id" + ((Thread.CurrentThread.ManagedThreadId).ToString());
        Thread t = new Thread(getId);
        t.Start();
    }
} 
```

这是`getId`（workerThread）代码：

```
public void getId()
{
    int id = Thread.CurrentThread.ManagedThreadId;
    //Note that, I have collected threadId just before calling this.Invoke
    //method else it would be same as of UI thread inside the below code block 
    this.Invoke((MethodInvoker)delegate ()
    {
        inpTxt.Text += "My id is" +"--"+id+Environment.NewLine; 
    });
} 
```

# html - 为什么对 HTML 表单而不是表格使用定义列表（DL、DD、DT）标签？

> ID：519234
> 
> 赞同：87
> 
> 时间：2009-02-06T05:39:43.027
> 
> 标签：html, css, forms

我最近遇到了一些示例，它们执行以下操作：

```
<dl>
  <dt>Full Name:</dt>
  <dd><input type="text" name="fullname"></dd>
  <dt>Email Address:</dt>
  <dd><input type="text" name="email"></dd>
</dl> 
```

用于制作 HTML 表单。这是为什么？与使用表格相比有什么优势？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-02-06T07:04:26.210

我想这取决于你来确定语义，但在我看来：

应该使用与表单相关的属性，而不是定义列表。

```
<form>
  <label for="fullname">Full Name:</label>
  <input type="text" name="fullname" id="fullname">
  <label for="email">Email Address:</label>
  <input type="text" name="email" id="email">
</form> 
```

<label> 标签中的“for”属性应该引用 <input> 标签的“id”属性。请注意，当标签与字段关联时，单击标签将使关联的字段成为焦点。

您还可以使用 <fieldset> 之类的标签将表单的各个部分聚集在一起，并使用 <legend> 为字段集添加标题。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-02-06T09:09:56.660

我已经多次成功地使用了[本文中概述的技术。](http://www.sitepoint.com/fancy-form-design-css/)

我同意*sjstrutt*的观点，即您应该在表单中使用`label`和表单相关的标签`form`，但是在他的示例中概述的 HTML 通常会缺少一些代码，您可以将其用作“钩子”来使用 CSS 设置表单样式。

因此，我将我的表单标记如下：

```
<form name="LoginForm" action="thispage">
    <fieldset>
        <legend>Form header</legend>
        <ul>
            <li>
                <label for="UserName">Username: </label>
                <input id="UserName" name="UserName" type="text" />
            </li>
            <li>
                <label for="Password">Password: </label>
                <input id="Password" name="Password" type="text" />
            </li>
        </ul>
    </fieldset>
    <fieldset class="buttons">
        <input class="submit" type="submit" value="Login" />
    </fieldset>
</form> 
```

这种方法给我留下了一组易于理解的标签，其中包含足够多的钩子来以多种不同的方式设置表单样式。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-02-06T05:49:44.800

这是语义与格式问题的一个子集。定义列表说明了它们是什么，相关键/值属性的列表，但没有说明如何显示它。表格更多地说明了布局以及如何显示数据，然后是里面的数据。它通过过度指定格式和未指定格式来限制列表的格式化方式。

从历史上看，HTML 将语义与格式混为一谈。字体标签和表格是最糟糕的例子。转向 CSS 进行格式化以及从 XHTML 中去除大量纯格式化标签在某种程度上恢复了意义与格式化的分离。通过将格式分离为 CSS，您可以以多种不同的方式显示相同的 HTML，为宽浏览器、小型移动浏览器、打印、纯文本等重新格式化...

如需启蒙，请访问[CSS Zen Garden](http://www.csszengarden.com/)。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-02-06T07:23:30.867

在这种情况下，标签和输入**是**您的语义含义，它们独立存在。

想象一下，您必须阅读网页，将其加载给盲人。你不会说“好的，我这里有一个*定义列表*。第一个*词*是‘名字’。” 相反，您可能会说“好的，我们这里有一个*表单*，看起来有一*组字段*，第一个*输入**标记为*‘名称’。”

这就是语义网很重要的原因。它允许页面的内容准确地向人类和技术展示自己。例如，有[许多](http://agilewebsolutions.com/products/1Password) [浏览器](http://windowshelp.microsoft.com/Windows/en-us/help/4e72b6fb-b9ec-45f0-9263-bceb34f47e521033.mspx) [插件](https://addons.mozilla.org/en-US/firefox/addon/4775)可以帮助人们使用标准信息（姓名、电话号码等）快速填写网络表单。如果输入没有关联的标签，这些很少能很好地工作。

希望有帮助。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-07-11T10:32:41.237

使用`dl` `dt`, `dd`for 表单只是构造表单的另一种方式，以及`ul` `li`,`div`和`table`. 您可以随时将 a`label`放入`dt`. 这样，您就可以将表单特定元素保留`label`在适当的位置。

```
<form action="/login" method="post"> 
    <dl>
        <dt><label for="login">Login</label></dt>
        <dd><input type="text" name="login" id="login"/></dd>
        <dt><label for="password">Password</label></dt>
        <dd><input type="password" name="password" id="password"/></dd>  
        <dd><input type="submit" value="Add"/></dd>
    </dl>
</form> 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-02-06T05:48:58.233

定义列表具有语义意义。它们用于列出术语 (<dt>) 及其相关定义 (<dd>)。因此，在这种情况下，<dl> 比表格更准确地描绘了内容的语义含义。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-01T16:18:38.077

几乎从不使用定义列表，因为从语义上讲它们很少出现在互联网上。

在您的情况下，已发布正确的代码：

```
<form>
    <label for="fullname">Full Name:</label>
    <input type="text" name="fullname" id="fullname">
    <label for="email">Email Address:</label>
    <input type="text" name="email" id="email">
</form> 
```

您正在为所述输入创建一个带有输入和标签的表单，而不是列出单词列表并定义它们。

如果您正在做某种帮助部分，那么定义列表将是合适的，例如：

```
<dl>
    <dt>HTML</dt>
    <dd>Hypertext Markup Language</dd>
    <dt>CSS</dt>
    <dd>Cascade Stylesheets</dd>
    <dt>PHP</dt>
    <dd>Hypertext Preprocessor</dd>
</dl> 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-06T05:50:08.450

使用 <dl> 标记表单的部分原因是，使用 <dl> 比 <table> 更容易做花哨的 CSS 布局技巧。另一部分是它比表格更好地反映了表单的语义（标签/字段对列表）。

好吧，餐桌仇恨也是其中的一部分。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-06T06:09:35.290

有时，定义列表只是以所需的方式呈现信息，而表格则不然。就个人而言，我可能不会对表单使用定义列表，除非它适合网站的风格。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-02-07T05:00:58.107

几乎所有的表格*都是*表格的。你见过不是表格的表格吗？我读过的指南建议使用表格标签进行表格展示，而这正是表格、日历和电子表格的用途。现在他们使用 DD 和 DT 而不是表？网络是什么来的？！:)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-04-15T06:33:03.300

表列表数据将是这样的：

```
<table>
<tr>
	<td class="title">Name: </td>
	<td class="text">John Don</td>
</tr>
<tr>
	<td class="title">Age: </td>
	<td class="text">23</td>
</tr>
<tr>
	<td class="title">Gender: </td>
	<td class="text">Male</td>
</tr>
<tr>
	<td class="title">Day of Birth:</td>
	<td class="text">12th May 1986</td>
</tr>
</table>
```

您可以像这样使用 DL、DT、DD 标签列表数据：

```
<dl>
	<dt>Name: </dt>
	<dd>John Don</dd>

	<dt>Age: </dt>
	<dd>23</dd>

	<dt>Gender: </dt>
	<dd>Male</dd>

	<dt>Day of Birth:</dt>
	<dd>12th May 1986</dd>
</dl>
```

# javascript - 删除 HTML 元素的所有子元素的更有效方法是什么？

> ID：519268
> 
> 赞同：4
> 
> 时间：2009-02-06T05:56:33.540
> 
> 标签：javascript, html

我知道访问和操作 DOM 的成本非常高，所以我希望尽可能高效地执行此操作。我的情况是某个 div 将始终包含一个项目列表，但有时我想用一组完全不同的项目刷新该列表。在这种情况下，我可以构建新列表并将其附加到该 div，但我还需要清除 out 列表。最好的方法是什么？将innerHTML 设置为空字符串？遍历子节点并调用“removeChild”？还有什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T06:02:17.413

看看[QuirksMode](http://quirksmode.org/)。这可能需要一些挖掘，但在各种浏览器中有时只进行此操作。尽管测试是在一年多前完成的，但在大多数浏览器中设置`innerHTML`为`""`最快。

PS[这里](http://quirksmode.org/dom/innerhtml.html)是页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T06:00:43.123

将 innerHTML 设置为空字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T06:01:08.553

强调**可能**代价高昂。它并不总是昂贵的；事实上，在处理少量元素时，它可能是微不足道的。请记住，优化应该始终在最后完成，并且只有在您有明显的证据表明您想要改进的特定方面确实是您的性能瓶颈之后。

如果可能，我建议避免使用 innerHTML；很容易搞砸并对 DOM 做一些你无法从优雅中恢复的讨厌的事情。

这种方法在 99.9% 的情况下都非常快，除非您从 DOM中删除*大量层次结构块：*

```
while(ele.childNodes.length > 0) {
    ele.removeChild(ele.childNodes[ele.childNodes.length - 1])
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T15:17:11.487

我建议在您关心的浏览器上测试几个实现。不同的 Javascript 引擎有不同的性能特点，不同的 DOM 操作方法在不同的引擎上有不同的性能。提防过早的优化，提防浏览器的差异。

# alice - Alice 作为学习工具有多大用处？

> ID：519281
> 
> 赞同：1
> 
> 时间：2009-02-06T06:02:36.460
> 
> 标签：alice, block-programming

我目前正在学习，我的下一个主题是“使用 Alice 编程”。有没有人有使用这个的经验？您如何评价它作为一种学习工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T06:10:47.287

是的，我在高中的 AP Java 2 课程中使用了它。这很有趣，虽然很原始（那时，我对提升我的编程能力更感兴趣，并且不喜欢任何限制我能做的事情）。对于儿童和刚开始编程的人来说，这是一个很好的学习工具（即以前从未用任何语言编程过）。它以非常直观的方式教授基本概念，效果立竿见影。它的一个非常好的功能是您可以探索的 3d 环境。即使您正在将编程技能发展成更多东西，这也使其适用。您可以玩弄它并制作出相当不错的游戏；我希望国际象棋游戏是非常可能的！

总而言之，如果没有别的可以说你已经做到了，我认为值得学习。由于我上次使用它已经有一段时间了，所以我的回复可能有点过时，如果我说的某些内容不再正确，我深表歉意。

享受！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T06:09:42.920

对于没有编程经验的学生来说，Alice 是一个很好的工具。简单到幼稚的程度，但它明白了它的意义。许多教师都在赞叹学生在使用 Alice 101 后对编程的理解程度提高了多少。

为了充分披露，我看到爱丽丝使用过，但我自己从未使用过。我的评论来自与我交谈过的导师。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-07T20:25:20.100

我参加了一门关于 Alice 的课程，它确实可以帮助您形象化编程的概念，最重要的是，类的操作。但是我真的不推荐像我上过的那样的大学课程，因为有很多更有帮助和高效的面向对象软件可以帮助你以一种简单的方式应用你在编程课程中学到的东西，同时获得经验游戏开发和其他涉及图形和视觉对象的示例...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-08T23:36:15.803

我最近有这门课，虽然我有多年的编程经验，但真的很有趣。

在学习算法时，决定一种语言是否有用是不可能的。我提醒自己在 18 年前对我的 Turbo Pascal 课程提出同样的问题。是的，我确实从来没有以此为生，至于爱丽丝。然而，它为我提供了良好的算法基础。

**是**的，Alice 是一个很好的学习工具。您将了解函数、参数、变量设置、列表和数组以及命令函数，更不用说循环了。它也是一种 OOP 语言，因此您将了解到对象具有可以操作的属性。

这些是任何现代语言的基本原则，在其之上还有一个有趣的层，因为您最终将以 3D 动画角色和对象。

# javascript - JSONML vs. InnerHTML vs.？

> ID：519285
> 
> 赞同：2
> 
> 时间：2009-02-06T06:05:57.403
> 
> 标签：javascript, dom

首先，我是唯一使用 JSONML 的人吗？其次，您会推荐使用 JSONML 插入动态 HTML 还是 InnerHTML 更有效？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T09:47:13.293

请记住，（在 IE 中）并非每个 innerHTML 都是可写的（无论如何，innerHTML 都不是标准编译器）。如此接近于附加节点而不是插入 html，你会更好。据我所知， jsonml thingie 创建了很好的 DOM 元素。我只能建议你制作一些巨大的数据集，以两种不同的方式插入它并自己测量性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T17:32:27.533

虽然表面上用于执行类似的任务，但 JsonML 和 innerHTML 是完全不同的野兽。

innerHTML 要求您完全按照自己的意愿准备好所有标记，这意味着服务器正在呈现标记，或者您正在 JavaScript 中执行昂贵的字符串连接。

JsonML 通过 JBST 打开了客户端模板化的大门，这意味着您的模板在构建时从 HTML 标记转换为 JavaScript 模板。在运行时，您只需提供数据并最终插入 DOM 元素或替换现有元素（如果没有额外的 DOM 创建，innerHTML 无法轻松做到这一点）。重新绑定只需要请求额外的数据，而不是整个重新渲染的标记。这是可以取得很大性能提升的地方，因为标记可以与数据分开请求/缓存。

为简单起见，innerHTML 一直是 Ajax 的 HTML-Message 模式样式的首选方法。但是像 JsonFx 这样的工具集可以让使用 JsonML 和 JBST 变得同样容易，同时提供完整的浏览器端模板 Ajax 模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T10:08:29.380

JsonML 和连接的库（模板等）似乎提供了一种在客户端生成动态 HTML 的有效方式。

当我说高效时，我的意思是程序员在完成任务时不会浪费时间或精力。但是我不确定您是否要问使用 innerHTML 是否更快并且在客户端需要更少的资源。

# php - 像素绘制算法

> ID：519288
> 
> 赞同：1
> 
> 时间：2009-02-06T06:09:41.623
> 
> 标签：php, algorithm, render, pixel

我需要一个示例算法，该算法将在基于网格的（x，y）系统上一次绘制一个像素，并根据基于以某种形式提供的二进制数据的 rbg 值对它们进行着色。我正在寻找用 php 或类似 php 的语言（如 C）编写的任何东西，但它不使用任何类型的库或图形卡 api，因为我在 php 中编码。

这是我在 php 中编写的内容，它使用随机颜色值，但在 html 画布中呈现需要 15 秒：

```
<?php
$r_max = 240;
$c_max = 320;
$row = -1;//-1 to offset while
while ($row<$r_max){
    ++$row;
    for($column=0; $column<=$c_max; ++$column)
    {
    echo 'ctx.fillStyle = "rgb(', rand()%255, ',', rand()%255, ',', rand()%255, ')";';
    echo 'ctx.fillRect(', $column, ',', $row, ',1,1);';
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T06:20:35.347

不太确定我是否完全理解您的问题，但是.. PHP 具有 GD 函数，包括图像分配和 setpixel 调用、线条绘制等 ..[在这里查看](http://us3.php.net/gd)

哦，是的， [imagemagick](http://us3.php.net/manual/en/book.imagick.php)也用于更多异国情调的用途

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T06:35:07.407

您似乎正在尝试输出用于在`<canvas>`标签上绘图的 JavaScript 命令。绘制像素的更快方法可能是使用`moveTo`和`lineTo`。顺便说一句，你为什么不外循环一个 for 循环呢？

不

```
for($row=0; $row<=$r_max; ++$row) {
    for($column=0; $column<=$c_max; ++$column) {
        # draw pixel
    }
} 
```

看起来更自然？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T08:11:27.370

问题是您正在为每个像素生成代码。相反，为什么不让代码将像素信息写入您喜欢的图像格式，然后在页面中显示呢？这是（对我而言）最合理的算法解决方案......我不确定它是否适合你想要做的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T16:21:42.950

我不能使用图像格式，因为它对我的使用效率不高。我正在寻找一些示例代码，其中可能会根据数据显示图像，这样我就可以了解如何以比每次渲染 15 秒更快的速度执行我正在执行的操作。我上面包含的嵌套循环很慢。

# .net - WCF 数据合约

> ID：519295
> 
> 赞同：1
> 
> 时间：2009-02-06T06:14:34.487
> 
> 标签：.net

我有一个数据合同作为基础对象，我有两个派生的数据合同对象。

在操作合同中，我只返回基础对象。

因此，由于基础对象在服务和操作合同中表示，派生类在客户端不可见（或）不在 Web 服务中发布。？

我如何在客户端创建派生对象并通过其基础对象引用通过操作合同返回。

（或者）

如何将服务中的 datacontract 对象公开给我可以从 web 引用中使用的 web 服务，而不是在操作合同中。

谢谢晚餐

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T06:37:20.447

使用[KnownType](http://msdn.microsoft.com/en-us/library/ms730167.aspx)属性。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-06T06:38:17.497

我不确定你能不能。我看到的问题是您正在跨线路移动基类，因为这是运营合同中定义的。这意味着您使用派生类进行的任何扩展都不会通过网络移动，因为只有基类会被序列化。

编辑：阅读达沃贡的帖子后，他肯定有一点。我想这真的取决于是否期望涉及其他领域。无论如何，这是我的想法。

# python - 获取 OperationalError: FATAL: 抱歉，已经有太多客户端在使用 psycopg2

> ID：519296
> 
> 赞同：22
> 
> 时间：2009-02-06T06:15:50.147
> 
> 标签：python, postgresql, psycopg2

我收到错误 OperationalError: FATAL: sorry, too many clients have been when using psycopg2\. 完成后，我在连接实例上调用 close 方法。我不确定是什么原因造成的，这是我对 python 和 postgresql 的第一次体验，但我在 php、asp.net、mysql 和 sql server 方面有几年的经验。

编辑：我在本地运行此程序，如果连接按应有的方式关闭，那么我一次只能打开 1 个连接。我确实有一个对数据库打开的 GUI，但即使关闭我也收到此错误。在我运行我的程序后不久就发生了。我有一个我调用的函数，它返回一个打开的连接，如下所示：

psycopg2.connect(connectionString)

谢谢

最终编辑：这是我的错误，我在错误上递归调用相同的方法，一遍又一遍地打开相同的方法。这是一个漫长的一天..

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-06T06:24:20.207

这个错误意味着它所说的，有太多的客户端连接到 postgreSQL。

你应该问自己的问题：

*   你是唯一连接到这个数据库的人吗？
*   您正在运行图形 IDE 吗？
*   你用什么方法连接？
*   您是否在运行代码的同时测试查询？

这些事情中的任何一个都可能是问题所在。如果您是管理员，则可以增加客户端的数量，但如果程序将其挂起，那么这将无济于事。

有很多原因导致同时运行的客户端过多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T22:34:39.480

确保您的 db 连接命令不在任何类型的循环中。在我将 db.database() 从重复执行循环的程序中移出之前，我的脚本中出现了同样的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-09T05:38:01.543

这很简单意味着许多客户端同时向 PostgreSQL 进行事务。我在不同的 docker 容器中运行 Postgis 容器和 Django。因此，对于我的情况，重新启动数据库和系统容器解决了这个问题。

# sql - MSSQL Paging 在不应该时返回随机行

> ID：519300
> 
> 赞同：0
> 
> 时间：2009-02-06T06:19:27.457
> 
> 标签：sql, sql-server, tsql, sql-order-by, row-number

我正在尝试在 MSSQL 中进行一些基本的分页。我遇到的问题是我在（可能）具有相似值的行上对分页进行排序，并且 ORDER BY 子句返回“随机”结果，这不能很好地工作。

举个例子。

如果我有三行，并且我按“评级”对它们进行排序，并且所有评级都是 = '5' - 这些行似乎会“随机”排列自己。如何使行每次都以相同的顺序显示？

我尝试按字段上次编辑的日期时间对其进行排序，但是“评级”是反向排序的，并且再次无法按我期望的方式工作。

这是我目前使用的 SQL。我知道没有数据会让人感到困惑，所以..任何帮助都会非常有用。

```
SELECT * FROM 
(
  SELECT 
    CAST(grg.defaultthumbid AS VARCHAR) + '_' + 
    CAST(grg.garageid AS VARCHAR) AS imagename,
    (
      SELECT COUNT(imageid) 
      FROM dbo.images im (nolock) 
      WHERE im.garageid = grg.garageid
    ) AS piccount, 
    (
      SELECT COUNT(commentid) 
      FROM dbo.comments cmt (nolock) 
      WHERE cmt.garageid = grg.garageid
    ) AS commentcount,
    grg.GarageID, mk.make, mdl.model, grg.year, 
    typ.type, usr.username, grg.content, 
    grg.rating, grg.DateEdit as DateEdit,
    ROW_NUMBER() OVER (ORDER BY Rating DESC) As RowIndex 
  FROM 
    dbo.garage grg (nolock)
    LEFT JOIN dbo.users (nolock) AS usr ON (grg.userid = usr.userid)
    LEFT JOIN dbo.make (nolock) AS mk ON (grg.makeid = mk.makeid)
    LEFT JOIN dbo.type (nolock) AS typ ON (typ.typeid = mk.typeid)
    LEFT JOIN dbo.model (nolock) AS mdl ON (grg.modelid = mdl.modelid)
  WHERE 
    typ.type = 'Automobile' AND
    grg.defaultthumbid != 0 AND
    usr.username IS NOT NULL
) As QueryResults 
WHERE 
  RowIndex BETWEEN (2 - 1) * 25 + 2 AND 2 * 25
ORDER BY 
  DateEdit DESC 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T06:38:47.540

尝试按两者排序，例如：ORDER BY Rating DESC、DateEdit ASC

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T14:09:28.303

查询首先按 [Rating] 对行进行编号，然后按 [DateEdit] 对结果重新排序。可能不是你想要的。按 [RowIndex] ASC 排序应该可以解决。

```
ROW_NUMBER() OVER (ORDER BY [Rating] DESC) As [RowIndex]
...
ORDER BY [RowIndex] 
```

# perl - 如何使用菱形运算符 (<>) 读取 UTF-8？

> ID：519309
> 
> 赞同：48
> 
> 时间：2009-02-06T06:28:05.253
> 
> 标签：perl, unicode, utf-8, input

我想使用菱形运算符读取 Perl 中的 UTF-8 输入，无论它来自标准输入还是来自文件：`while(<>){...}`。

所以我的脚本应该可以通过这两种方式调用，像往常一样，给出相同的输出：

```
./script.pl utf8.txt
cat utf8.txt | ./script.pl 
```

但是输出不同！只有第二个调用（使用`cat`）似乎按设计工作，正确读取 UTF-8。这是脚本：

```
#!/usr/bin/perl -w

binmode STDIN, ':utf8';
binmode STDOUT, ':utf8';

while(<>){
    my @chars = split //, $_;
    print "$_\n" foreach(@chars);
} 
```

在这两种情况下，如何让它正确读取 UTF-8？如果可能的话，我想继续使用菱形运算符`<>`进行阅读。

**编辑：**

我意识到我可能应该描述不同的输出。我的输入文件包含这个序列：`a\xCA\xA7b`. `cat`正确输出的方法：

```
a
\xCA\xA7
b 
```

但另一种方法给了我这个：

```
a
\xC3\x8A
\xC2\xA7
b 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-02-06T06:52:09.027

尝试使用 pragma open 代替：

```
use strict;
use warnings;
use open qw(:std :utf8);

while(<>){
    my @chars = split //, $_;
    print "$_" foreach(@chars);
} 
```

您需要这样做，因为 <> 运算符很神奇。如您所知，它将从 STDIN 或 @ARGV 中的文件中读取。从 STDIN 读取没有问题，因为 STDIN 已经打开，因此 binmode 可以很好地工作。问题是从@ARGV 中的文件读取时，当您的脚本启动并调用 binmode 时，文件未打开。这会导致 STDIN 设置为 UTF-8，但当 @ARGV 有文件时，不使用此 IO 通道。在这种情况下，<> 运算符为@ARGV 中的每个文件打开一个新的文件句柄。每个文件句柄都会被重置并失去它的 UTF-8 属性。通过使用 pragma open，您可以强制每个新的 STDIN 使用 UTF-8。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-06T08:33:17.873

如果您这样做，您的脚本将起作用：

```
#!/usr/bin/perl -w

binmode STDOUT, ':utf8';

while(<>){
    binmode ARGV, ':utf8';

    my @chars = split //, $_;
    print "$_\n" foreach(@chars);
} 
```

<> 读取的魔法文件句柄被称为`*ARGV`，当你调用 readline 时它​​被打开。

但实际上，我喜欢在适当的时候明确使用`Encode::decode`和 。`Encode::encode`

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-06T08:50:27.480

`-C`您可以使用以下标志默认打开 UTF8 ：

```
perl -CSD -ne 'print join("\n",split //);' utf8.txt 
```

开关`-CSD`无条件开启UTF8；如果您简单地使用它，它将仅在相关环境变量（和）指示的情况`-C`下打开 UTF8 。有关详细信息，请参阅[perlrun](http://man.cx/perlrun)。`LC_ALL``LC_TYPE``LANG`

如果您不直接调用 perl，则不建议这样做（特别是，如果您将选项从 shebang 行传递给 perl，它可能无法可靠地工作）。在这种情况下，请参阅其他答案。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-02-02T23:44:18.647

如果您在 while 循环内调用 binmode，那么它会在读入第一行后将句柄切换到 utf8 模式。这可能不是您想要做的。

像下面这样的东西可能会更好：

```
#!/usr/bin/env perl -w
binmode STDOUT, ':utf8';
eof() ? exit : binmode ARGV, ':utf8';
while( <> ) {
    my @chars = split //, $_;
    print "$_\n" foreach(@chars);
} continue {
    binmode ARGV, ':utf8' if eof && !eof();
} 
```

使用括号对 eof() 的调用非常神奇，因为它会检查 <> 使用的伪文件句柄上的文件结尾。如有必要，它将打开下一个需要读取的句柄，这通常具有使 *ARGV 有效的效果，但不会从中读取任何内容。这允许我们在读取任何内容之前对读取的第一个文件进行 binmode。

后来，使用了 eof（不带括号）；这将检查从文件末尾读取的最后一个句柄。在我们从命令行处理每个文件的最后一行之后（或者当 stdin 到达它的结尾时），这将是真的。

显然，如果我们刚刚处理了一个文件的最后一行，调用 eof()（带括号）打开下一个文件（如果有的话），使 *ARGV 有效（如果可以的话），并测试文件结尾在下一个文件上。如果下一个文件存在，并且不在文件末尾，那么我们可以安全地在 ARGV 上使用 binmode。

# wmd - Stackoverflows WMD 系统 - 我的输入在哪里变成 HTML？

> ID：519314
> 
> 赞同：2
> 
> 时间：2009-02-06T06:31:06.340
> 
> 标签：wmd

我在 textarea 中的输入在什么阶段从原始文本变为 HTML？例如，假设我缩进 4 个空格

```
like this 
```

然后 WMD Showdown.js 将在我输入的这个文本区域下方正确呈现它。但文本区域仍然包含

```
 like this 
```

那么 PHP 服务器端是否负责将 showdown.js 所做的所有相同的事情永久转换为 SoF 数据库中的 HTML？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T06:35:38.390

这里还有一些其他的帖子，但基本上它是这样工作的。或者至少这是我在我的网站上使用 WMD 的方式；如果您有兴趣查看我的 WMD 实施，请查看我的个人资料。

1.  用户在客户端输入 Markdown，并`showdown.js`在浏览器中实时运行（纯客户端 JavaScript；没有 AJAX 或类似的东西）给用户预览。
2.  然后当用户发布到服务器时，WMD 发送 Markdown（你必须配置 WMD 来执行此操作；默认情况下，WMD 发送 HTML）。
3.  运行`showdown.js`服务器端将 Markdown 转换为 HTML。理论上，您可以使用其他方法，但尝试在服务器上获得与用户在客户端上看到的相同的转换是有意义的，而不是您想要在服务器端进行的任何 HTML 标记过滤。
4.  如前所述，您需要进行适当的 HTML 标记过滤以避免跨站点脚本 (XSS) 问题。这既重要又不平凡，所以要小心。
5.  将 Markdown 和 HTML 都保存在数据库中 - Markdown 因为如果用户想要编辑他们的帖子，您希望给他们 Markdown 和 HTML，这样您就不必每次显示答案时都将 Markdown 转换为 HTML。

这里有一些相关的帖子。

*   [将 HTML 转换回 Markdown 以在 wmd 中进行编辑](https://stackoverflow.com/questions/235224/convert-html-back-to-markdown-for-editing-in-wmd)：说明如何配置 WMD 以将 Markdown 而非 HTML 发送到服务器。
*   [Stack Overflow 上允许使用哪些 HTML 标签？](https://stackoverflow.com/questions/31657/what-html-tags-are-allowed-on-stack-overflow)：对于考虑 HTML 标记过滤很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T06:35:01.603

首先，StackOverflow 是建立在 ASP.NET 上的，但是基本上富文本框中的字符会被来回翻译。

# c# - 将 Select() 的结果转换为列表时遇到问题

> ID：519324
> 
> 赞同：1
> 
> 时间：2009-02-06T06:36:26.937
> 
> 标签：c#, .net, linq

我在这里想念什么？

我想像这样对 Select() 进行简单的调用：

```
List<int> list = new List<int>();  
//fill the list
List<int> selections = (List<int>)list.Select(i => i*i); //for example 
```

而且我一直在投射它时遇到问题。我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T06:38:43.000

Select() 将返回一个 IEnumerable<int> 类型，您必须使用[ToList() 运算符](http://www.hookedonlinq.com/ToListOperator.ashx)：

```
List<int> selections = list.Select(i => i*i).ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T06:39:26.807

Select() 不返回列表，因此您当然不能将其转换为列表。您可以改用 ToList 方法：

```
list.Select(i => i*i).ToList(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T07:34:59.393

正如其他人所说，`Select`返回一个`IEnumerable<T>`实际上不是列表的 - 它是延迟评估的迭代器块的结果。

但是，如果您正在处理列表，并且您想要一个除了投影之外什么都没有的列表，那么使用[`List<T>.ConvertAll`](http://msdn.microsoft.com/en-us/library/73fe8cwf.aspx)会更有效，因为它能够立即创建具有正确大小的新列表：

```
List<int> selections = list.ConvertAll(i => i*i); 
```

但是，除非您特别关心效率，否则我可能会坚持使用 Select，因为它可以让您与其他 LINQ 代码更加一致。

# cocoa - 如何在不删除/替换原始文件中的任何单词的情况下将字符串写入文本文件？

> ID：519333
> 
> 赞同：3
> 
> 时间：2009-02-06T06:39:02.750
> 
> 标签：cocoa

在 Cocoa 中，如何在不替换文件内容的情况下将字符串写入文本文件，例如在文件末尾写入？

例如下面的代码：

```
BOOL written = [data writeToFile:[path stringByAppendingPathComponent:@"conf.txt"] options:NSAtomicWrite error:&error]; 
```

数据（字符串）被写入文本文件，但它替换了文件的原始内容。

有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-06T06:56:46.037

使用[`NSFileHandle`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSFileHandle_Class/Reference/Reference.html).

首先调用[`-[NSFileHandle seekToEndOfFile]`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSFileHandle_Class/Reference/Reference.html#//apple_ref/doc/uid/20000304-seekToEndOfFile)寻找文件末尾。

然后使用[`-[NSFileHandle writeData:]`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSFileHandle_Class/Reference/Reference.html#//apple_ref/doc/uid/20000304-writeData_)（而不是`-[NSData writeToFile:]`）将数据附加到文件末尾。

# javascript - 浏览器不再报告 js 错误 - YUI 历史管理器

> ID：519336
> 
> 赞同：0
> 
> 时间：2009-02-06T06:39:39.490
> 
> 标签：javascript, yui, error-reporting

我正在使用 YUI 的浏览器历史管理器，并且我的浏览器不再报告运行时错误。他们仍然会在错误控制台中显示解析错误，但如果我调用一个虚假函数，例如，在某个事件处理程序中，浏览器似乎会停止所有 js 处理。当我遇到错误时，即使是萤火虫的调试器也会退出。还有人看到这个吗？还是YUI？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T07:17:46.760

我发现这个问题的唯一解决方案（我现在已经经历过几次）是创建一个全新的配置文件。我还没有确定 FF 到底出了什么问题，但我的钱花在了 Firebug、Web 开发人员工具栏和另一个扩展的奇怪组合上。如果 FF 配置文件中缺少 firebug 或 web 开发人员工具栏，则不会发生这种情况。

越来越接近将我的 Firefox 配置文件存储在 svn 中，但它每隔几个月才会发生一次，而不是在我重新创建我的配置文件后每天发生一次。

作为一个半途而废的解决方案，我现在在 Firefox 中保留了人员和开发人员资料，并在我的一个网站上保留了开发人员资料所需的扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T19:28:57.783

[原来这个问题的答案就在这里……](https://stackoverflow.com/questions/521521/yui-customevent-no-errors-being-reported)

# linux - makefile 中的 -I 和 -L 有什么区别？

> ID：519342
> 
> 赞同：64
> 
> 时间：2009-02-06T06:43:29.717
> 
> 标签：linux, makefile, linker, ld

makefile 中 -I 和 -L 标志的用途是什么？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-02-06T06:50:27.877

这些通常是链接器命令行的一部分，或者直接在目标操作中提供，或者更常见地分配给`make`将扩展为形成链接命令的变量。在这种情况下：

`-L`是包含库的目录的路径。库的搜索路径。

`-l`是您要链接到的库的名称。

例如，如果您想链接到`~/libs/libabc.a`您要添加的库：

```
-L$(HOME)/libs -labc 
```

要利用默认的隐式链接规则，请将这些标志添加到变量`LDFLAGS`中，如

```
LDFLAGS+=-L$(HOME)/libs -labc 
```

* * *

`LDFLAGS`将和分开是一个好习惯`LIBS`，例如

```
# LDFLAGS contains flags passed to the compiler for use during linking
LDFLAGS = -Wl,--hash-style=both
# LIBS contains libraries to link with
LIBS = -L$(HOME)/libs -labc
program: a.o b.o c.o
        $(CC) $(LDFLAGS) $^ $(LIBS) -o $@
        # or if you really want to call ld directly,
        # $(LD) $(LDFLAGS:-Wl,%=%) $^ $(LIBS) -o $@ 
```

即使它可能以其他方式工作，`-l...`指令也应该遵循引用这些符号的对象*。*如果链接以错误的顺序完成，一些优化（`-Wl,--as-needed`最明显的）将失败。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-02-20T08:03:11.827

要真正了解 makefile，您还需要对项目工具链的所有组件的命令行有很好的理解。make 本身不理解类似`-I`和的选项。`-L`相反，make 正在尝试创建一个命令行，该命令行将执行一个工具来将先决条件文件转换为目标文件。

通常，这是将 C 或 C++ 源文件编译为目标文件，并最终链接以获取可执行文件。

在这种情况下，您需要查看编译器的手册，尤其是与它所理解的命令行选项相关的部分。

笼统地说，这些特定选项在编译器和链接器中是相当标准的。`-I`将目录添加到编译器搜索的位置列表中以查找在`#include`一行中命名的文件，`-L`并将目录添加到链接器搜索的位置列表中以查找以该`-l`选项命名的库。

最重要的是，makefile 的“语言”是 makefile 本身的语法、已知的 shell（通常`/bin/sh`或类似的东西）、常见的 shell 命令（如`rm`、`cp`、`install`等）和特定于您的编译器和链接器的命令（例如`gcc -v --help`，在您的 shell 提示符下键入将为您提供 gcc 理解的几乎完整（并且非常长）的选项列表作为一个起点）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T13:15:31.890

需要注意的一件事是，这些是传递给编译器/链接器的选项。因此，您应该查看编译器手册页/文档以了解它们的作用。

# javascript - 如何通过 Firefox 扩展操作选定的文本

> ID：519349
> 
> 赞同：5
> 
> 时间：2009-02-06T06:46:40.550
> 
> 标签：javascript, firefox, google-chrome

我正在开发一个将处理突出显示的文本的**Firefox 扩展。**

在独立页面上，我可以通过以下方式获取所选文本：

```
selectedText = document.selection?document.selection.createRange().text; 
```

然后我会在有问题的文本区域上使用字符串操作来操作选定的文本。不幸的是，这对于插件来说是不可能的，因为我不知道用户选择的文本在哪里。

有没有办法获取选择文本的元素的名称或在没有元素名称的情况下更改选定的文本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-21T23:50:26.910

```
selectedText = content.getSelection().toString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T06:57:45.473

您需要从用户选择中获取范围对象：

```
var userSelection;
if (window.getSelection)
    userSelection = window.getSelection();
else if (document.selection)    // should come last; Opera!
    userSelection = document.selection.createRange();

var rangeObject = getRangeObject(userSelection); 
```

...

```
function getRangeObject(selectionObject) {
    if (selectionObject.getRangeAt)
        return selectionObject.getRangeAt(0);
    else { // Safari!
        var range = document.createRange();
        range.setStart(selectionObject.anchorNode, selectionObject.anchorOffset);
        range.setEnd(selectionObject.focusNode, selectionObject.focusOffset);
        return range;
    }
}

... 
```

Range 对象具有开始和结束容器节点等。

更多信息可以在 Quirksmode和 w3.org[上](http://www.quirksmode.org/dom/range_intro.html)[找到](http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html)

# sql-server - SQL Server 的全文搜索是搜索短语而不是文档的正确工具吗？

> ID：519351
> 
> 赞同：4
> 
> 时间：2009-02-06T06:46:53.873
> 
> 标签：sql-server, sql-server-2008, lucene, full-text-search

3000 万个不同的短语，而不是文档，从一个单词到 10 个单词的句子，我需要支持单词/短语搜索。基本上是什么*contains(phrase, "'book' or 'stack overflow'")*提供的。

我有一个 SQL Server 2005 实例（32 位，4 proc，4gb）针对几个全文目录，对于高基数的单词搜索，性能很糟糕。

这是我加快速度的想法，也许有人可以提供指导-

1) 升级到 2008 iFTS，64 位。Sql Server 2005 FTS 的 windows 服务永远不会超过 50mb。根据我收集到的信息，它使用文件系统缓存来查找目录索引。我在磁盘上填充的目录只有大约 300mb，那么为什么不能全部都在内存中呢？iFTS 的新内存架构（它是 sqlserver 进程的一部分）可能在这里有帮助吗？

2) 将目录扩展到多台服务器。对链接的 FTS 服务器的查询会并行运行吗？

3）由于我在这里搜索短语而不是文档，因此可能 Sql Server 的全文搜索不是答案。Lucene.NET？将目录索引放在内存驱动器上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T00:30:14.040

Lucene.Net 可以为这种应用程序提供非常高的性能以及非常简单的 API。2.3.2 版即将完成，与 2.1 版相比，它提供了额外的性能提升。虽然将 Lucene 索引放入 RAMDirectory（Lucene 的基于内存的索引结构）将提供更好的性能，但即使使用 FSDirectory（基于磁盘的索引），我们也看到了很好的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T08:54:36.097

FTS 在这种负载下吱吱作响，我有点惊讶。但是，如果事实证明确实如此，那么经典的方法（Gary Kildall 开发它是为了搜索 CD！）将是使用反转索引。我已经在一系列应用程序中使用了这种技术很长时间。它通常被称为“倒置”或“倒置”索引技术。（参见[http://en.wikipedia.org/wiki/Search_engine_indexing#Inverted_indices](http://en.wikipedia.org/wiki/Search_engine_indexing#Inverted_indices)）。该技术可以很好地扩展，我已经测试过它可以索引多达 800 万份文档。即使搜索八百万个文档，只要索引正确，它也能在三秒内得到结果。通常它比这快得多。

我使用反转索引来获取（通过 TOP x 最多可承受的数量）可能的候选者池，然后使用正则表达式对这些候选者进行强力搜索。它工作得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T15:50:33.230

作为一个开箱即用的解决方案，我更喜欢使用“Microsoft Office SharePoint Server”在文档内容中进行索引和搜索。如果您想编写自己的索引和搜索服务，一个免费的替代方案是 Lucene.Net 库。使用 Lucene.Net 编写自己的全文搜索服务将为您提供所需的所有灵活性（是的，如果您愿意，可以将索引存储在外部存储中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-29T18:51:09.260

看看[Apache Solr](http://lucene.apache.org/solr/)。它是一个使用 HTTP 接口包装 Lucene 的搜索服务器。您的每个短语都会映射到 Solr 文档。30M 的文档对于 Solr 来说并不多，因为您的文档会很短。最终性能还取决于您需要多少查询/秒。

# sql - 在 VBScript ADODB.Command 中查看参数化查询

> ID：519362
> 
> 赞同：4
> 
> 时间：2009-02-06T06:53:35.997
> 
> 标签：sql, asp-classic, vbscript, ado

在我的查询被Parameters.Append参数化*后*，如何查看它的SQL代码

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T08:10:41.083

你不能。

参数化查询不像您可以在准备好时输出的字符串那样构建。

它总是一个两步的过程：

1.  在“SELECT foo FROM foo_table WHERE id = ?”的 from 中准备一个查询，将其发送到服务器（并返回一个标识符）。
2.  将填充问号的所有参数连同准备好的语句的标识符一起发送到服务器。

两者（查询和参数）在任何时候都不会在数据库服务器之外取得联系。（这就是为什么参数化查询比手工制作的 SQL 字符串更安全的原因）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-17T21:00:32.713

您可以编写一些简单的代码，通过循环遍历参数来解析结果。这是一个 VBScript / Classic ASP 示例：

```
 queryPlain = command.CommandText
        For Each p In command.Parameters
           If (p.type = adChar) or (p.type = adBSTR) or (p.type = adDBDate) Then
                queryPlain = Replace(queryPlain , "?", "'" & p.value & "'",1,1)
            Else
                queryPlain = Replace(queryPlain , "?", p.value,1,1)
            End If
        Next 
```

这是 VB.net 的类似内容

```
 queryPlain = command.CommandText
        For Each p As SqlParameter In command.Parameters
            queryPlain = queryPlain.Replace(p.ParameterName, p.Value.ToString())
        Next 
```

现在 queryPlain 包含包含参数的 SQL。我发现这对调试很有用。

# sharepoint - 用于删除 Sharepoint 文档库中超过一天的文件的脚本

> ID：519374
> 
> 赞同：4
> 
> 时间：2009-02-06T06:59:18.170
> 
> 标签：sharepoint, document-library

我需要一个脚本，它可以删除所有早于一天的文件，并且需要每天在 Sharepoint 服务器中自动调用此脚本。我该如何做到这一点以及如何编写脚本的任何提示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T17:04:50.950

我认为更简单的方法是创建一个过期的网站集策略。将保留期设置为一天。然后，您可以将处置工作流程附加到用于清理这些文件的列表中。您应该能够在不编写任何代码的情况下完成所有这些工作。

这是一个链接，其中包含有关处置工作流程的更多信息。 [http://office.microsoft.com/en-us/sharepointserver/HA101544291033.aspx](http://office.microsoft.com/en-us/sharepointserver/HA101544291033.aspx)

谢谢，科里

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T15:48:29.090

如果您确实需要脚本而不是编写代码（例如计时器作业），请使用[Powershell](http://en.wikipedia.org/wiki/Windows_PowerShell)通过脚本引擎访问 SharePoint .NET 对象。编写脚本后，设置 Windows 计划任务以每天运行它。

在脚本中遵循[Lars](https://stackoverflow.com/questions/519374/script-to-delete-files-older-than-a-day-in-sharepoint-document-library/520133#520133)关于使用这两个查询类之一的指导。然后从查询结果中，您可以获得对要删除的每个 SPListItem 的引用。使用[SPListItem.Delete](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splistitem.delete.aspx)或[SPListItem.Recycle](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splistitem.recycle.aspx)删除项目。

下面是一个使用 SPQuery 的示例：

```
[System.Reflection.Assembly]::Load("Microsoft.SharePoint, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c")

$site = new-object Microsoft.SharePoint.SPSite("http://yoursite/")
$web = $site.OpenWeb("Web Title")
$documentLibrary = $web.Lists["Document Library Name"]

$yesterdaysDate = [Microsoft.SharePoint.Utilities.SPUtility]::CreateISO8601DateTimeFromSystemDateTime([System.DateTime]::UtcNow.AddDays(-1.0))
$query = new-object Microsoft.SharePoint.SPQuery
$query.ViewFields = "<FieldRef Name='Modified' />"
$query.Query = "<Where><Leq><FieldRef Name='Modified' /><Value Type='DateTime' IncludeTimeValue='TRUE'>" + $yesterdaysDate + "</Value></Leq></Where>"
$queryItems = $documentLibrary.GetItems($query)
foreach ($item in $queryItems)
{
    echo $item.Url
    $item.Delete()
}
$web.Dispose()
$site.Dispose() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T12:38:30.013

[您可以使用 .NET 和WSS API](http://msdn.microsoft.com/en-us/library/cc768559.aspx)在 SharePoint 中创建[自定义计时器作业](http://www.andrewconnell.com/blog/archive/2007/01/10/5704.aspx)来完成这项工作。使用[SPQuery](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spquery.aspx)类在文档库中按日期查询文件。如果您需要跨多个文档库进行查询，请使用[SPSiteDataQuery类。](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsitedataquery.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-12T10:56:41.843

这是仅删除 SharePoint 网站上超过一天的文件的 C# 代码，要每天运行它，您需要创建 SharePoint 计时器作业并在计时器作业的执行方法中添加以下代码。

```
 SPSite spSite = new SPSite("http://YourSiteUrl");
        SPWeb oWebsite = spSite.OpenWeb();
            SPListCollection collLists = oWebsite.Lists;

            foreach (SPList oList in collLists)
            {
                if (oList.BaseType == SPBaseType.DocumentLibrary)
                {
                    SPDocumentLibrary oDocumentLibrary = (SPDocumentLibrary)oList;

                    if (!oDocumentLibrary.IsCatalog && oList.BaseTemplate != SPListTemplateType.XMLForm)
                    {

                        SPListItemCollection collListItems = oDocumentLibrary.Items;

                        foreach (SPListItem oListItem in collListItems)
                        {
                            if (oListItem.File != null)
                            {
                                if ((DateTime.Now - oListItem.File.TimeCreated).TotalDays > 1)
                                {
                                   oListItem.Delet();

                                }

                            }

                      }
                    }
                }
            } 
```

# sql - 是否有用于 T-SQL 的样式检查工具，就像 FxCop 到 .net 一样？

> ID：519385
> 
> 赞同：6
> 
> 时间：2009-02-06T07:05:35.473
> 
> 标签：sql, coding-style

我正在寻找一种工具来强制执行编码样式，对 T-SQL 脚本进行验证检查。并在适用时推荐最佳实践。

在 .net 代码域中，用于此目的的工具是 FxCop。T-SQL 有对应的吗？最好是免费或开源工具。

任何人都可以解释一下吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T07:18:33.607

[电动工具](http://www.microsoft.com/downloads/details.aspx?FamilyId=DA3F11AD-BD54-4EDA-B08C-4DF84DF0D641&displaylang=en)是您最好的选择。

此外，这是一个用于验证最佳实践的 Microsoft 工具。文档指定它检查 T-SQL。它可能会也可能不会做你想做的事。

[2000](http://www.microsoft.com/downloads/details.aspx?FamilyId=B352EB1F-D3CA-44EE-893E-9E07339C1F22&displaylang=en)

[2005年](http://www.microsoft.com/downloads/details.aspx?FamilyId=DA0531E4-E94C-4991-82FA-F0E3FBD05E63&displaylang=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T11:22:04.707

您可能希望查看 RedGate 工具套件，尤其是 SQL Refactor 和 SQL Prompt。

这将以标准方式布局您的 T-SQL 代码，还使您能够自定义用于特定商店的标准。

[http://www.red-gate.com/products/SQL_Refactor/index.htm](http://www.red-gate.com/products/SQL_Refactor/index.htm)

干杯，约翰

# c# - 编写一个扫描电子商务网站并从中提取产品图片+价格+描述的C#程序

> ID：519387
> 
> 赞同：3
> 
> 时间：2009-02-06T07:06:30.870
> 
> 标签：c#, screen-scraping

我正在开发一个电子商务搜索引擎，允许您在许多电子商务网站中搜索产品。

我该如何处理这件事？

我需要一个能够扫描网站、解析其 HTML 并确定网站中哪些图像是产品图像、哪些是产品描述、哪些是产品价格的应用程序。

很高兴听到任何想法，例如。

提前致谢。

编辑：我的问题不是如何从网站获取 HTML（这称为屏幕抓取），而是更多关于如何解析该信息并了解哪些 html 包含我正在寻找的实际数据，哪些不是。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T07:11:10.173

您可能会发现[此线程](http://groups.google.com/group/DotNetDevelopment/browse_thread/thread/a7198eac90110ee/)对您的任务很有帮助。我已经概述了那里的基本步骤。这是所有在 SO 上标记为“ [Screen-scraping ”的问题的链接。](https://stackoverflow.com/questions/tagged/screen-scraping)此外，网络上有很多资料 -[谷歌](http://www.google.com/search?q=screen+scraping+.net)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T07:14:12.883

您要抓取的大多数网站（更准确地说是[网络抓取](http://en.wikipedia.org/wiki/Web_scraping)）都有用于“经销商”类型交易的合作伙伴 API。为了让您通过屏幕抓取来规避这一点，您会很快发现您的 IP 被他们的流量服务器阻止，并可能使您陷入法律困境。

这充其量在道德上是可疑的。

# struts2 - 在 struts 2 中使用 struts-tags 是强制性的。是吗？

> ID：519391
> 
> 赞同：1
> 
> 时间：2009-02-06T07:09:08.527
> 
> 标签：struts2

struts2 中是否必须使用 struts-tags。我的意思是我们不能使用以下内容：

`<td bgcolor="DEDBC6"><div align="left"><font color="#000000"><strong> Employee Name * :</strong></font></div></td> <td><input name="empname" type="text" id="empname" size="32"></td>`

**而不是跟随：**

`<s:textfield label="Employee Salary " name="empsal" required="true"/>`

我已经尝试了这两种方法，但是当我使用第一个时，我没有收到验证消息，即我在 action-validation.xml 中编写的“需要 empname”，尽管验证运行良好。 **请评论 ？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T07:20:29.813

不，这不是强制性的。事实上，很多 struts2 用户对 OGNL 非常不满意，并选择使用常规 HTML。

但是使用标准的 HTML 标签有失去一些功能的缺点，毕竟这就是为什么自定义标签首先存在的原因。即使使用标准 HTML，也可以通过控制器类上的 validate 方法进行验证。

如果您刚刚开始使用该框架，我建议您在偏离常规之前正确学习 struts 标签。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T18:31:41.267

> struts2 中是否必须使用 struts-tags。

不，但是如果您根本不使用标签*，*那么您并没有真正从 Struts 作为一个框架中获得很多东西。还不如自己做。

> 我没有收到验证消息

如果您使用自己的标记，则必须告诉它显示错误消息。例如。：

```
<s:fielderror><s:param>empcode</s:param></s:fielderror> 
```

> 请评论 ？

请停止一遍又一遍地问同样的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T23:59:21.787

我不明白你为什么需要任何标签。难道你不能只使用 Struts 生成 JSON 结果类型，然后使用 JavaScript 和 JQuery 调用你原本静态的 jsp 页面中的那些吗？

# bash - Bash 脚本 - shell 命令输出重定向

> ID：519395
> 
> 赞同：6
> 
> 时间：2009-02-06T07:11:41.530
> 
> 标签：bash, shell, scripting

有人可以帮助解释以下内容：

如果我输入：

```
a=`ls -l` 
```

然后 ls 命令的输出保存在变量中`a`

但如果我尝试：

```
a=`sh ./somefile` 
```

结果输出到 shell ( `stdout`) 而不是变量`a`

我所期望的是 shell 的结果操作试图执行`somefile`要存储在变量中的脚本''。

请指出我的理解有什么问题以及一种可能的方法。

谢谢。

编辑：

澄清一下，脚本 ' `somefile`' 可能存在也可能不存在。如果它存在，那么我希望将脚本的输出存储在“ `a`”中。如果没有，我希望将错误消息“没有这样的文件或目录”存储在 ' `a`'

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-06T07:25:02.097

我认为是因为外壳可能会附加到 /dev/tty 但我可能错了。为什么不直接在脚本上设置执行权限并使用：

```
a=`./somefile` 
```

如果要将 stderr**和**stdout 捕获到 a，只需使用：

```
a=`./somefile 2>&1` 
```

首先检查文件是否可执行：

```
if [[ -x ./somefile ]] ; then
    a=$(./somefile 2>&1)
else
    a="Couldn't find the darned thing."
fi 
```

你会注意到我正在切换到 $() 方法而不是反引号。我更喜欢 $() 因为你可以嵌套它们（例如，“ `a=$(expr 1 + $(expr 2 + 3))`”）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T07:27:42.137

您可以尝试新的和改进的命令替换方式，使用 $() 而不是反引号。

```
a=$(sh ./somefile) 
```

如果它仍然不起作用，请检查*somefile*是否实际上不是*stderr*。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T07:28:25.380

你是对的，标准输出`./somefile`存储在变量中`a`。但是，我假设 somefile 输出到 stderr。您可以`2>&1`直接使用 after重定向它`./somefile`。

# c# - 如何通过提供 X、Y 和 Windowhandle 参数手动引发事件？

> ID：519403
> 
> 赞同：0
> 
> 时间：2009-02-06T07:15:32.227
> 
> 标签：c#, events, event-handling

我们正在开发一个模块，其中我提供了 xpos、ypos、windowhandle。现在我想做的是我想在`(xpos, ypos, windowhandle)`.

例如：

给出的输入是选择一个文件意味着它将通过我的模块自动选择一个文件。

```
00010086 PWM_LBUTTONDBCLK fwKeys:MK_LBUTTON xPos:273yPos:354 
```

事件将如上所示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T07:54:19.823

伪代码..您可以修改以满足您的需要...

```
using System;
using System.Windows.Forms;
using System.Runtime.InteropServices;

public class Form1 : Form
{
   [DllImport("user32.dll",CharSet=CharSet.Auto, CallingConvention=CallingConvention.StdCall)]
   public static extern void mouse_event(long dwFlags, long dx, long dy, long cButtons, long dwExtraInfo);

   private const int MOUSEEVENTF_LEFTDOWN = 0x02;
   private const int MOUSEEVENTF_LEFTUP = 0x04;
   private const int MOUSEEVENTF_RIGHTDOWN = 0x08;
   private const int MOUSEEVENTF_RIGHTUP = 0x10;

   public Form1()
   {
   }

   public void DoMouseClick()
   {
      //Call the imported function with the cursor's current position
      mouse_event(MOUSEEVENTF_LEFTDOWN | MOUSEEVENTF_LEFTUP, X, Y, 0, 0);
   }

  //...other code needed for the application
} 
```

# c# - 如何在 C# 中删除 Windows 还原点？

> ID：519404
> 
> 赞同：4
> 
> 时间：2009-02-06T07:16:14.423
> 
> 标签：c#, windows, wmi

我正在寻找一种使用 C# 可能通过调用 WMI 来删除 Windows 还原点的方法。

任何代码片段都会非常有帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-15T03:44:18.727

谈到 Morten 所说的，您可以使用该 API。据我所知，WMI 没有提供删除还原点的方法。SRRemoveRestorePoint 可以删除还原点，前提是您有序列号。您可以通过 WMI 获得它。这是我删除还原点的代码。

```
[DllImport("Srclient.dll")]
public static extern int SRRemoveRestorePoint(int index);

private void button1_Click(object sender, EventArgs e)
{
    int SeqNum = 335;
    int intReturn = SRRemoveRestorePoint(SeqNum);
} 
```

我刚刚投入了 335，因为这是我在系统上能找到的最远的一个。计数可能从 1 开始并不断增加。所以它不像在数组中那样拥有索引那么简单。

至于获取序列号，我将代码从[Microsoft](http://support.microsoft.com/?kbid=295299)转换为 C#，这将为您提供该信息。请务必添加 System.Management 作为参考。否则此代码将无法正常工作。

```
 private void EnumRestorePoints()
    {
        System.Management.ManagementClass objClass = new System.Management.ManagementClass("\\\\.\\root\\default", "systemrestore", new System.Management.ObjectGetOptions());
        System.Management.ManagementObjectCollection objCol = objClass.GetInstances();

        StringBuilder Results = new StringBuilder();
        foreach (System.Management.ManagementObject objItem in objCol)
        {
            Results.AppendLine((string)objItem["description"] + Convert.ToChar(9) + ((uint)objItem["sequencenumber"]).ToString());
        }

        MessageBox.Show(Results.ToString());
    } 
```

我在我的盒子（顺便说一下 Vista）上测试了这个，它没有问题。还必须以管理员身份运行，但我想你已经明白了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T08:55:01.900

虽然我对 WMI 一无所知，[但此](http://www.csharphelp.com/archives2/archive334.html)资源可能会帮助您入门。它不会直接触及您的问题，但也许它会以某种方式有用。无论如何，似乎相关的 Win32/COM 函数是[SRRemoveRestorePoint](http://msdn.microsoft.com/en-us/library/aa378934.aspx)。我希望这有任何用处。

或者，如果您愿意，您可以使用[VBScript 。](http://support.microsoft.com/?kbid=295299)

# portfolio - 将代码带入编程工作面试有什么问题？

> ID：519405
> 
> 赞同：6
> 
> 时间：2009-02-06T07:17:24.780
> 
> 标签：portfolio

我对[另一个问题](https://stackoverflow.com/questions/519219/what-to-bring-to-a-programming-interview)的回答感到困惑，即您*不应该*将代码组合带到编程工作面试中。

为什么不呢？其他人[推荐](http://grok-code.com/58/the-power-of-a-programming-portfolio/)这个；[它甚至是Peopleware](https://rads.stackoverflow.com/amzn/click/com/0932633439)中的“经典”故事之一：

> “在没有先看他表演的情况下考虑雇佣一个杂耍演员是很可笑的。这只是常识。然而，当你开始雇佣工程师、设计师、程序员或团队经理时，常识规则通常会被搁置。您不会要求查看设计或程序或任何东西。其实面试就是说说而已。”</p>

那么，什么给了？当你带着代码组合出现时，有什么“战争故事”吗？或者当你采访了一个有过的候选人时？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-06T08:15:00.733

这些年来我做了很多采访，但我从来没有要求或被展示过任何代码。这不是我要找的。首先，我正在尝试确定您是否可以在团队中合作。我也很想看看你是否了解如何处理就业所暗示的所有这些妥协。对于开发人员，我希望看到你处理问题的方式，以及你在挫折后坚持不懈的顽强。

显然，我想了解一下您对编程艺术的理解程度。如果你有一项特殊技能，我会问你一些技术问题。

我永远不想看到你写的代码。我怎么能确定它是你的，没有帮助？我怎么能在面试的时候给它足够的时间去审视和欣赏它的细枝末节呢？我怎么知道你写的时间？

在平静中编写程序与在团队中工作、在压力下、不得不做出妥协、合作并决定将资源集中在哪里的技能之间存在天壤之别。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-06T07:27:39.143

我对这个问题的看法是，除非明确要求，否则您**无需**将代码组合带到面试中。它只是作为面试官可能计划的面试流程的中断。此外，你能提供什么证据证明你作品集中的代码确实是你自己的，而不是从互联网上下载的或从同事那里获取的？最后，如果您以前的代码都与新情况无关，那么投资组合有什么用处？

此外，许多公司将其员工的代码视为受合法版权保护。毕竟，您将分享您之前公司创建的软件的内部详细信息，即使您确实是自己编写的。

面试官*通常*喜欢强调潜在候选人在新公司环境中的适应能力以及他/她对他们所从事的技术的熟悉程度。许多面试官实际上可能会要求您编写一个简短的代码片段来展示您的逻辑思维以及您如何处理一般问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-06T08:12:46.790

我从来没有带过代码去面试，也从来没有人在面试时带过代码。如果我想查看代码示例，我会要求候选人在面试前提交它，这样我就有足够的时间来检查它。如果亲自交给我一个代码示例，我将没有足够的时间去了解它的实质。

如果没有要求，您是否应该提供代码示例？我说不，原因如下：当我要求你提供代码示例时，这是一个测试，我想看看你是否**失败**。在查看代码示例后，我给出了两种可能的结果：

良好的代码示例：不确定（即，如果您是 HIRE，其他因素将决定 100%）

糟糕的代码示例：不雇用

所以，既然你知道了，如果我没有要求你自愿参加那个考试，你愿意吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-06T09:51:52.893

请记住，您作为公司员工创建的代码很可能是该公司的财产 - 这是您去参加工作面试时不要将其放在口袋里的闪存驱动器上的一个非常充分的理由.

此外，如果我对你的编码方式感兴趣，我会要求你在面试时在我面前这样做，而不是审查一些罐头食品。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T07:21:56.020

我在一次工作面试中被要求提供代码。最安全的做法可能是随身携带一些示例代码/组合，因此至少在出现提示时您可以展示一些东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-06T08:20:20.457

在我的求职面试中，没有提到“为我编写代码”。更像，我们有这个问题，你会如何解决它。（通常例如使用设计模式）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-05T20:32:23.680

**tl;dr：**我总是把代码带到面试中。那里有足够多有趣的问题，你可以快速写出一些有代表性的东西，然后把它塞进你的包里。

我的作品集包括我的简历、我的 CV（一种不同类型的文档）、重要的演示幻灯片（例如从 JavaOne 下载）、代码示例（在我自己的计算机上自行创建）、有趣的设计文档（例如，如果我必须重新做，我现在会怎么做），运行时图像（从发布站点下载）等。

永远不要在你的投资组合*中*放任何东西，甚至暗示你是以前雇主的财产或知识产权。

也就是说，进行公开演示的一大好处是您可以从发布网站下载屏幕截图。当然，您必须对出版实体给予适当的合理使用权。

综上所述，我采访了那些想在这里工作但没有随身携带代码示例的人。这主要是经验因素：他们中的许多人是应届毕业生。不过，我对经验丰富的专业人士的期望要高得多。我的过滤器也很厚：我们宁愿工作过度也不愿雇佣一个坏人。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-22T19:18:45.387

工程师和程序员不必携带代码示例，因为他们已经面临技术面试。如果候选人知道他的东西，他就不会为这些问题而挣扎。没有机会伪造技术答案。候选人要么以前做过，要么没有做过。没有解释的余地​​。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-06T07:26:47.663

我认为整个概念是优秀的管理者想看看你是否会思考。我被问到谜语，并被要求在面试中解决逻辑难题。我的代码可能被复制粘贴甚至被盗。

仅仅看到一个人所经历的步骤的过程，就会让你很好地了解他们解决问题的逻辑能力。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-06T07:29:25.037

*无论如何，只有*当我喜欢这个人时，我才会要求提供代码。然后我希望它可以在公共存储库中的互联网某处可用。但是无论如何，到那时都会做出雇用/不雇用的决定。预先查看代码是没有用的，因为您永远无法确定它是由处理它的人编写的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-06T07:57:56.040

代码示例可能会让面试官“惊叹”，他们只是在寻找流行语和噱头，但受人尊敬的面试官会寻找解决问题的技能和即时推理的能力。大多数有趣的代码对于面试官来说太长而无法真正解释，并且可能会浪费掉。

也就是说，带上代码示例并不是一件坏事，只要你不把它们强加给面试官。将某些东西放在确实不能正确赞美您的好处的事情上只是一个糟糕的优先级。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-06T10:35:43.023

任何重要的软件应用程序通常都是由整个团队制作的，乍一看还不够简单。第一次向局外人展示代码时，可能不容易查看整个解决方案/项目并清楚地区分其他人编写的代码。我怀疑面试官在实际面试期间没有时间慢慢阅读和研究你的代码，并试图理解你之前工作过的应用程序的低级架构和设计。如果您希望获得积分，请准备好进行耗时的演练。

在很多情况下，我们的工作让我们更有可能进入一个已经在运行的项目；维护/增强现有代码和应用程​​序，而不是从头开始编写“漂亮”的代码。我的编码贡献通常*以部分形式交付，*用于重构和修复既*庞大又丑陋*的现有代码库。这样的东西很难以闪闪发光的自豪感来展示。

此外，正如其他人所提到的，将以前组织的源代码公开会产生许多不良的法律影响。

当我希望了解受访者的编码风格时，面试可以包括一个课外开发练习。然后，受访者将提交练习内容以供日后阅读。但在面试环节本身，就是花时间去了解面试者的性格、热情、心理和思维模式、解决问题的能力等。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-06T10:53:38.743

通过将代码带到面试中，您真的可以让自己和您的潜在雇主陷入困境。您工作的公司可能拥有您的部分/全部代码，如果他们发现他们*将*争取为他们的“损失”获得补偿。

另一次不好的是，如果新工作是与旧工作类似的角色或类似的公司。如果您跳槽并且曾经使用过您以前雇主的任何代码，那么以前的雇主可以有一个现场日，即使代码只是看了一眼然后收起来。

面试时你应该带的唯一类型的代码是 OSS 代码，即使这样，也只有当该代码实际上是在野外时。我有机会在我以前的所有雇主那里编写 GPL 代码（一些我最好的小型内部测试工具），但因为我们从未向任何人发布二进制文件，我们也没有义务发布源代码。在这种情况下，新雇主无权访问该来源，我无法向他们展示：(

# winapi - 找到notepad.exe和mspaint.exe的路径

> ID：519410
> 
> 赞同：28
> 
> 时间：2009-02-06T07:20:01.840
> 
> 标签：winapi, search, filesystems, filepath

找出notepad.exe和mspaint.exe在哪里可以在不同版本的Windows上工作的最佳方法是什么？

我是否应该通过 获取 Windows 目录[`SHGetFolderPath(NULL, CSIDL_WINDOWS, NULL, SHGFP_TYPE_CURRENT, dir)`](https://msdn.microsoft.com/en-us/library/windows/desktop/bb762181(v=vs.85).aspx)，然后遍历所有子目录以查找这两个文件？

（假设我对 Windows 文件夹之外的任何内容都不感兴趣。）

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-06T07:28:29.483

这适用于我可以访问的每个 Windows 机器（XP+）。

```
c:\> for %i in (cmd.exe) do @echo %~$PATH:i
C:\WINDOWS\system32\cmd.exe

c:\> for %i in (python.exe) do @echo %~$PATH:i
C:\Python25\python.exe 
```

很棒的是，您不必*使用*实际的`%PATH%`，您可以使用不同的环境变量替换您自己的搜索路径。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-06T14:16:30.020

如果您安装了 Microsoft Platform SDK（[2003 年 2 月的版本](http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdk-full.htm)是最后一个与 Microsoft VC6 一起工作的版本），您可以获取该`where.exe`程序（它是 38K，如果您 gzip 则只有 18K）并运行

```
where notepad.exe 
```

命令的帮助`where`：

```
WHERE [/R dir] [/Q] [/F] [/T] pattern...

Description:
    Displays the location of files that match the search pattern.
    By default, the search is done along the current directory and
    in the paths specified by the PATH environment variable.

Parameter List:
    /R       Recursively searches and displays the files that match the
             given pattern starting from the specified directory.

    /Q       Returns only the exit code, without displaying the list
             of matched files. (quite mode)

    /F       Displays the matched filename in double quotes.

    /T       Displays the file size, last modified date and time for all
             matched files.

    pattern  Specifies the search pattern for the files to match.
             Wildcards * and ? can be used in the pattern. The
             "$env:pattern" and "path:pattern" formats can also be
             specified, where "env" is an environment variable and
             the search is done in the specified paths of the "env"
             environment variable. These formats should not be used
             with /R. The search is also done by appending the
             extensions of the PATHEXT variable to the pattern.

     /?      Displays this help message.

  NOTE: The tool returns an error level of 0 if the search is
        successful, of 1 if the search is unsuccessful and
        of 2 for failures or errors.

Examples:
    WHERE /?
    WHERE myfilename1 myfile????.*
    WHERE $windir:*.*
    WHERE /R c:\windows *.exe *.dll *.bat
    WHERE /Q ??.???
    WHERE "c:\windows;c:\windows\system32:*.dll"
    WHERE /F /T *.dll 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T08:24:09.357

检查键 HKEY_CLASSES_ROOT\Applications\notepad.exe 在本地化版本上是否相同。也许键名相同，编辑/打开的值指向本地化的 exe。
例子：

英文：
HKEY_CLASSES_ROOT\Applications\notepad.exe\shell\edit\command
%SystemRoot%\system32**NOTEPAD.EXE** %1

荷兰语：
HKEY_CLASSES_ROOT\Applications\notepad.exe\shell\edit\command
%SystemRoot%\system32**kladblok.exe** %1

如果是这种情况，那么它只是要检查注册表中的那个键（mspaint 也是如此）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-03-05T15:56:02.720

类型：

%windir%\system32\notepad.exe 在路径栏中的东西

或者

C:\Windows\System32 并找到 notepad.exe

*C 是您的操作系统所在的硬盘驱动器 :)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T07:30:24.347

我认为从小处着手，您应该获取`windir`环境变量并在子文件夹`%windir%\system32\`中查找`mspaint`and `notepad`。他们很可能会在那里。

但是，如果失败了，那就求助于更暴力的搜索。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-06T07:47:13.877

通常，您只需执行它们。它们位于每个 Windows 版本的系统路径上。

您可以使用[`ExpandEnvironmentStrings`](http://msdn.microsoft.com/en-us/library/ms724265(VS.85).aspx). 您要扩展的环境变量是`WINDIR`.

在过去，您可以使用`GetWindowsDirectory`or `GetSystemDirectory`，但我认为它们已被弃用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-08T02:49:51.747

由于您使用 WinAPI 标记了问题，因此我将使用[SearchPath()](http://msdn.microsoft.com/en-us/library/aa365527(VS.85).aspx)例如以下将`path`使用结果填充变量。

```
//Get the full path to notepad
char path[MAX_PATH] = { 0 };
LPSTR* ptr = NULL;
DWORD dwRet = SearchPath(NULL, "notepad.exe", NULL, MAX_PATH, (LPSTR)path, ptr); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-06T17:59:30.863

使用 WinAPI 函数 GetWindowsDirectory() 获取 Windows 文件夹，使用 GetSystemDirectory() 获取 Windows\System 文件夹。保证至少可以与 Win95 起的所有 Windows 版本一起使用；我认为它们在 Win 3.x 中也可用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-06T07:28:26.067

尝试打开 DOS 提示符，切换到 Windows 文件夹并执行以下操作：

```
dir notepad.exe /s 
```

DOS万岁:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-05T12:15:10.157

简而言之，我发现最好的方法是检查 `Windows\System32`目录和`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths`注册表项。

更一般地说，我发现最好的方法是模仿`ShellExecuteEx`。

取自：
应用程序注册 (Windows)
[https://msdn.microsoft.com/en-us/library/windows/desktop/ee872121(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/ee872121(v=vs.85).aspx)

> 在以下位置查找该文件：
> • 当前工作目录。
> • 仅Windows 目录（不搜索子目录）。
> • Windows\System32 目录。
> • PATH 环境变量中列出的目录。
> •推荐：HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths

进一步的可能是`Start Menu\Programs\Accessories`通过使用 和 来检查 ，`SHGetFolderPath`并`CSIDL_STARTMENU := 11` 从`CSIDL_COMMON_STARTMENU := 22`lnk 文件中检索目标。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2014-08-13T17:56:23.577

转到 system32 文件夹并在“文件名”栏中键入“notepad.exe”。

# c# - 为 asp:checkbox 赋值（或任何其他参数）

> ID：519413
> 
> 赞同：2
> 
> 时间：2009-02-06T07:20:48.097
> 
> 标签：c#, .net, asp.net, .net-2.0, checkbox

我很确定这是不可能的，但无论如何我都会把它扔掉。

我在页面上有大约 10 个 asp:checkbox 控件，每次它们中的任何一个被选中/取消选中时，我都需要去更新数据库。

现在，我将所有这些都绑定到一个在 CheckedChanged 上触发的事件处理程序，然后我将发送者强制转换为 Checkbox 并获取 ID，并根据该 ID 为传递给存储过程的参数分配一个值。

是否可以为每个复选框分配一个自定义参数，所以我不必将它们的 ID 绑定到 sproc 参数值。

谢谢你。

**ps static Dictionary<> 似乎是要走的路，但是我无法从[这篇文章](https://stackoverflow.com/questions/313324/declare-a-dictionary-inside-a-static-class)中获取示例以在 .net 2.0 中工作**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T15:03:09.287

为什么不制作自己的自定义服务器复选框控件。

```
namespace CustomControls
{
    public class CustomCheckBox : CheckBox
    {
       string _myValue;
       public string MyValue
       {
           get { return _myValue; }
           set { _myValue = value; }
       }

       public CustomCheckBox()
       {
       }
    }
}

<%@ Register TagPrefix="MyControls" Namespace="CustomControls"%>
<MyControls:CustomCheckBox id="chkBox" runat="server" MyValue="value"></MyControls:CustomTextBox> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T13:55:01.950

尝试使用常规 HTML 复选框并将它们作为数组/逗号分隔列表提交可能是一个想法：

```
<input type="checkbox" id="item-1" name="items[]" value="1" />
<label for="item1">Item 1</label>
....
<input type="checkbox" id="item-n" name="items[]" value="n" />
<label for="item1">Item n</label> 
```

然后在服务器端，您可以执行以下操作：

```
string tmp = Request.Form["items[]"];
if (!string.IsNullOrEmpty(tmp)) {
    string [] items = tmp.Split(new char[]{','});
    // rest of processing, etc.
} 
```

希望这将减少您必须在服务器端执行的工作量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T07:28:15.617

您可以从它继承并添加您需要的属性。

或者使用字典将控件 ID 映射到您的数据库 ID。

编辑：[字典](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)包含键/值对列表。控件的 ID 可能是关键，而您想要的与数据库相关的“自定义参数”（我不是 100% 确定您在说什么，但字典可以存储它）可能是值。当您想获得价值时，您可以通过以下方式获得：

```
myDictionary[keyValue] 
```

声明喜欢：

```
Dictionary<string, string> myDictionary = new Dictionary<string, string>(); 
```

编辑 2：对于静态字典：

```
public static readonly IDictionary<string, string> myDictionary = new Dictionary<string, string>();

static ClassConstructor()
{
    myDictionary.Add("key1", "value1");
    myDictionary.Add("key2", "value2");
    myDictionary.Add("key3", "value3");
} 
```

# sql-server - SSRS 2008 导出到 Microsoft Word 不包括页眉和页脚

> ID：519419
> 
> 赞同：4
> 
> 时间：2009-02-06T07:25:34.000
> 
> 标签：sql-server, reporting-services, reporting, export-to-word

我有一份报告，最近从 SSRS2005 转换为 SSRS2208。

报表标题有一个背景，它是根据页码计算出来的。在报告页脚中有一个图像和两个文本框，也是根据页码计算的。

Business Intelligence Development Studio 中的报表预览显示正确，导出为 PDF 也可以正常工作。但是，当导出到 Microsoft Word 时，页眉和页脚会消失，页边距会增加约 1.5 厘米。

* * *

此问题的边距部分已在 Microsoft Connect 中报告并解决。修复应该是“在 SqlServer2008R2 CTP3 及更高版本中”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T02:37:37.217

我不知道该怎么做，但我可能有一个想法。在 SSRS 2005 中，通过导出到 Excel，您必须更改 SSRS 配置文件中的 Excel 设备信息设置以使用 SimplePageHeaders：http: [//msdn.microsoft.com/en-us/library/ms155069(SQL.90)。 aspx](http://msdn.microsoft.com/en-us/library/ms155069(SQL.90).aspx)（如何： http: [//mysqlserverblog.com/2008/01/03/sharing-export-options-for-reporting-services.aspx](http://mysqlserverblog.com/2008/01/03/changing-export-options-for-reporting-services.aspx)）

我查找了 Word 设备信息设置，但据我所知，没有这样的设置：http: [//msdn.microsoft.com/en-us/library/cc281123.aspx](http://msdn.microsoft.com/en-us/library/cc281123.aspx)

但祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T07:40:07.410

通过一些实验，似乎导出到 Word 文档功能在以下情况下不起作用

*   页眉或页脚项目具有根据页码计算的属性
*   页眉和页脚有背景图片

**简化页眉和页脚内容应该使它们出现。**

与我列出的两种情况相比，页眉和页脚不导出到 Microsoft Word 的情况可能更多。据我所知，没有办法让更复杂的页眉和页脚与导出到 Word 文档功能一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-06T13:34:00.567

我有一个报告，其中页眉和页脚已正确导出，但是在第一页上 Word 将页脚解释为不同，并且由于某种原因将其隐藏。第一页和其余页面之间似乎有一点高度差异。

如果您编辑页脚，则 Word 2007 和 2010 中的复选框允许您显示它。不知道为什么 SSRS 在第一页和其他页面之间导出它的方式不同。

# language-agnostic - 在程序中替换或替换 if..else if..else 树的最佳方法是什么？

> ID：519422
> 
> 赞同：38
> 
> 时间：2009-02-06T07:27:22.967
> 
> 标签：language-agnostic, design-patterns

这个问题的动机是我最近开始经常看到的东西，即`if..else if..else`结构。虽然它很简单并且有它的用途，但它的一些东西不断地告诉我，它可以被更细粒度、更优雅并且通常更容易保持最新的东西所取代。

为了尽可能具体，这就是我的意思：

```
if (i == 1) {
    doOne();
} else if (i == 2) {
    doTwo();
} else if (i == 3) {
    doThree();
} else {
    doNone();
} 
```

我可以想到两种简单的方法来重写它，或者通过三元（这只是编写相同结构的另一种方式）：

```
(i == 1) ? doOne() : 
(i == 2) ? doTwo() :
(i == 3) ? doThree() : doNone(); 
```

或使用 Map（在 Java 中，我也认为在 C# 中）或 Dictionary 或任何其他 K/V 结构，如下所示：

```
public interface IFunctor() {
    void call();
}

public class OneFunctor implemets IFunctor() {
    void call() {
        ref.doOne();
    }
}

/* etc. */    

Map<Integer, IFunctor> methods = new HashMap<Integer, IFunctor>();
methods.put(1, new OneFunctor());
methods.put(2, new TwoFunctor());
methods.put(3, new ThreeFunctor());
/* .. */
(methods.get(i) != null) ? methods.get(i).call() : doNone(); 
```

事实上，上面的 Map 方法是我上次最终做的，但现在我不能停止认为必须有更好的替代方案来解决这个确切的问题。

那么，还有哪些其他 - 并且最有可能更好的 - 替换 if..else if..else 的方法，你最喜欢哪一个？

## 你的想法低于这条线！

* * *

好的，以下是**你的**想法：

首先，最受欢迎的答案是 switch 语句，如下所示：

```
switch (i) {
    case 1:  doOne(); break;
    case 2:  doTwo(); break;
    case 3:  doThree(); break;
    default: doNone(); break;
} 
```

这仅适用于可以在开关中使用的值，至少在 Java 中这是一个相当大的限制因素。当然，对于简单的情况是可以接受的。

您似乎建议的另一种可能更有趣的方式是使用多态性来实现。由 CMS 链接的 Youtube 讲座是一个很好的手表，请看这里：[“The Clean Code Talks -- Inheritance, Polymorphism, & Testing”](http://www.youtube.com/watch?v=4F72VULWFvc)据我了解，这将转化为如下内容：

```
public interface Doer {
    void do();
}

public class OneDoer implements Doer {
    public void do() {
        doOne();
    }
}
/* etc. */

/* some method of dependency injection like Factory: */
public class DoerFactory() {
    public static Doer getDoer(int i) {
        switch (i) {
            case 1: return new OneDoer();
            case 2: return new TwoDoer();
            case 3: return new ThreeDoer();
            default: return new NoneDoer();
        }
    }
}

/* in actual code */

Doer operation = DoerFactory.getDoer(i);
operation.do(); 
```

谷歌谈话中有两个有趣的观点：

*   使用空对象而不是返回空值（并且请只抛出运行时异常）
*   尝试编写一个没有 if:s 的小项目。

此外，我认为值得一提的一篇文章是 CDR，他向我们提供了他的反常习惯，虽然不建议使用，但看起来非常有趣。

谢谢大家的回答（到目前为止），我想我今天可能学到了一些东西！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-06T07:31:15.720

这些构造通常可以被多态性所取代。这将为您提供更短且更简洁的代码。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-06T07:32:20.693

在面向对象的语言中，通常使用多态来替换 if。

我喜欢这个涵盖该主题的 Google Clean Code Talk：

[干净的代码谈话——继承、多态性和测试](http://www.youtube.com/watch?v=4F72VULWFvc)

> 抽象的
> 
> 您的代码是否充满了 if 语句？切换语句？你在不同的地方有相同的 switch 语句吗？当您进行更改时，您是否发现自己在多个地方对相同的 if/switch 进行了相同的更改？你有没有忘记一个？
> 
> 本演讲将讨论使用面向对象技术删除许多条件的方法。结果是更干净、更紧凑、设计更好的代码，更容易测试、理解和维护。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-06T07:31:45.017

一个 switch 语句：

```
switch(i)
{
  case 1:
    doOne();
    break;

  case 2:
    doTwo();
    break;

  case 3:
    doThree();
    break;

  default:
    doNone();
    break;
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-06T07:32:22.363

这个问题有两个部分。

**如何**根据值进行调度？使用 switch 语句。它最清楚地显示您的意图。

**何时**根据值进行调度？每个值只在一个地方：创建一个知道如何为值提供预期行为的多态对象。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-06T07:34:43.060

根据你的事物类型 if..else'ing，考虑创建对象层次结构并使用多态性。像这样：

```
class iBase
{
   virtual void Foo() = 0;
};

class SpecialCase1 : public iBase
{
   void Foo () {do your magic here}
};

class SpecialCase2 : public iBase
{
   void Foo () {do other magic here}
}; 
```

然后在您的代码中只需调用 p->Foo() 就会发生正确的事情。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-06T07:29:31.697

使用开关/外壳更清洁：p

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-06T07:30:39.013

当然，[switch](http://msdn.microsoft.com/en-us/library/06tc147t(VS.80).aspx)语句比那些 if 和 else 更漂亮。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-06T07:30:59.713

在这种简单的情况下，您可以使用开关。

否则，基于表格的方法看起来不错，只要条件足够规则以使其适用，这将是我的第二选择，尤其是在案例数量很大的情况下。

如果没有太多情况，并且条件和行为不规则，多态性将是一种选择。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-06T07:32:29.367

除了使用可以更快的 switch 语句之外，没有。If Else 清晰易读。必须在地图中查找东西会使事情变得模糊。为什么让代码更难阅读？

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-06T07:33:49.037

```
switch (i) {
  case 1:  doOne(); break;
  case 2:  doTwo(); break;
  case 3:  doThree(); break;
  default: doNone(); break;
} 
```

输入此内容后，我必须说您的 if 语句没有太大问题。就像爱因斯坦说的：“让它尽可能简单，但不要更简单”。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-02-06T08:51:49.347

我使用以下简写只是为了好玩！如果代码清晰度比输入的字符数更关心您，请不要尝试这些。

对于 doX() 始终返回 true 的情况。

```
i==1 && doOne() || i==2 && doTwo() || i==3 && doThree() 
```

当然，我尝试确保大多数 void 函数返回 1 只是为了确保这些短手是可能的。

您还可以提供作业。

```
i==1 && (ret=1) || i==2 && (ret=2) || i==3 && (ret=3) 
```

喜欢写作

```
if(a==2 && b==3 && c==4){
    doSomething();
else{
    doOtherThings();
} 
```

写

```
a==2 && b==3 && c==4 && doSomething() || doOtherThings(); 
```

如果不确定函数将返回什么，请添加 ||1 :-)

```
a==2 && b==3 && c==4 && (doSomething()||1) || doOtherThings(); 
```

我仍然发现打字比使用所有那些 if-else 更快，而且它肯定会吓到所有新手。想象一下这样的一整页语句，有 5 级缩进。

“if”在我的一些代码中很少见，我将其命名为“if-less programming”:-)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-02-06T08:59:05.230

问题中给出的示例非常简单，可以使用简单的开关。当 if-else 嵌套越来越深时，问题就来了。它们不再“清晰或易于阅读”（正如其他人所说），并且添加新代码或修复其中的错误变得越来越困难和难以确定，因为如果逻辑可能不会达到预期的结果很复杂。

我已经看到这种情况发生了很多次（开关嵌套 4 层深，数百行长——无法维护），尤其是在试图为太多不同的不相关类型做太多事情的工厂类内部。

如果您要比较的值不是无意义的整数，而是某种唯一标识符（即使用枚举作为穷人的多态性），那么您想使用类来解决问题。如果它们真的只是数值，那么我宁愿使用单独的函数来替换 if 和 else 块的内容，而不是设计某种人为的类层次结构来表示它们。最后，这可能会导致代码比原来的意大利面条更混乱。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-06T07:34:47.413

`switch`具有虚函数的语句或类作为奇特的解决方案。或指向函数的指针数组。这完全取决于条件的复杂程度，有时无法绕过这些条件。再一次，创建一系列类来避免一个 switch 语句显然是错误的，代码应该尽可能简单（但不是更简单）

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-06T08:31:53.460

我什至会说任何程序都不应该使用 else。如果你这样做，你就是在自找麻烦。您永远不应该假设它不是 X，它一定是 Y。您的测试应该单独测试每个测试并在此类测试后失败。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-06T07:34:17.383

在 OO 范例中，您可以使用良好的旧**多态性**来做到这一点。太大的 if - else 结构或 switch 结构有时被认为是代码中的异味。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-06T07:48:10.630

Map 方法是目前最好的方法。它使您可以封装语句并很好地分解事物。多态可以补充它，但它的目标略有不同。它还引入了不必要的类树。

开关的缺点是缺少中断语句并失败，并且确实鼓励不要将问题分解成更小的部分。

话虽这么说： if..else 的小树很好（事实上，几天来我一直主张有 3 个 if..else 而不是最近使用 Map）。当您开始将更复杂的逻辑放入其中时，由于可维护性和可读性而成为问题。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-06T08:50:39.443

在 python 中，我会将您的代码编写为：

```
actions = {
           1: doOne,
           2: doTwo,
           3: doThree,
          }
actions[i]() 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-06T08:56:11.460

我将这些 if-elseif-... 结构视为“关键字噪音”。虽然它的作用可能很清楚，但它缺乏简洁性；我认为简洁是可读性的重要组成部分。大多数语言都提供类似`switch`声明的东西。构建地图是一种在没有类似语言的语言中获得类似内容的方法，但它确实感觉像是一种解决方法，并且有一点开销（switch 语句转换为一些简单的比较操作和条件跳转，但是地图首先是内置在内存中，然后是查询，然后才会发生比较和跳转）。

在 Common Lisp 中，有两个内置的 switch 结构，`cond`和`case`. `cond`允许任意条件，虽然`case`只测试相等，但更简洁。

```
(条件 ((= i 1)
       （做一个））
      ((= 我 2)
       （做两个））
      ((= 我 3)
       （做三））
      （吨
       （无）））（案例一
      （1（做一个））
      （2（做两个））
      （3（做三））
      （否则（不做）））

```

当然，您可以根据`case`需要制作自己的类似宏。

在 Perl 中，您可以使用该`for`语句，可以选择使用任意标签（此处为：）`SWITCH`：

```
SWITCH: for ($i) {
    /1/ && do { do_one; last SWITCH; };
    /2/ && do { do_two; last SWITCH; };
    /3/ && do { do_three; last SWITCH; };
    do_none; }; 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2018-01-04T12:35:21.197

使用三元运算符！

三元运算符（53 个字符）：

```
i===1?doOne():i===2?doTwo():i===3?doThree():doNone(); 
```

如果（108 个字符）：

```
if (i === 1) {
doOne();
} else if (i === 2) {
doTwo();
} else if (i === 3) {
doThree();
} else {
doNone();
} 
```

开关（（甚至比 IF 更长！？！？）114 个字符）：

```
switch (i) {
case 1: doOne(); break;
case 2: doTwo(); break;
case 3: doThree(); break;
default: doNone(); break;
} 
```

这就是你所需要的！它只有一行，而且非常整洁，比 switch 和 if 短得多！

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-06T07:40:51.347

当然，这个问题与语言有关，但在许多情况下，switch 语句可能是更好的选择。一个好的 C 或 C++ 编译器将能够生成一个[跳转表](http://en.wikipedia.org/wiki/Jump_table)，这对于大量的情况会明显更快。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-02-06T08:29:39.127

如果你真的必须有一堆 if 测试，并且想要在测试为真时做不同的事情，我会推荐一个只有 if 的 while 循环——没有别的。每个 if 都进行一次测试，然后调用一个方法，然后跳出循环。没有什么比一堆堆积的 if/else/if/else 等更糟糕的了。

# data-storage - 磁卡存储容量

> ID：519431
> 
> 赞同：7
> 
> 时间：2009-02-06T07:28:51.607
> 
> 标签：data-storage, magnetic-cards

关于磁卡的通常存储容量（如 ATM 中使用的）的任何想法？

（PS：尝试谷歌搜索但没有得到任何令人满意的结果并指出）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T07:43:13.247

从[http://en.wikipedia.org/wiki/Magnetic_stripe](http://en.wikipedia.org/wiki/Magnetic_stripe)看来，该卡由三个磁道组成（如 Pax 之前提到的），磁道 1 和 3 的位密度为 210 位/英寸，而磁道2 的位密度为每英寸 75 位。

如果条带长 3.25 英寸，那么理论上它可以存储 1607 位，轨道 1 和 3 各有 682 位，轨道 2 有 243 位。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T07:32:54.513

ISO 7813 规定了轨道 1 和 2 的布局。轨道 3 包含在 ISO 4909 中。

Track 2 是银行业务常用的一种。

有关详细信息，请参阅[ISO7813](http://en.wikipedia.org/wiki/ISO_7813)和[ISO4909](http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=33583)。抱歉，没有 4909 的维基百科，您必须从 ISO 或您所在国家/地区的标准机构购买文档。

# html - CSS：向 Div 添加 Div（圆角讨论）

> ID：519449
> 
> 赞同：0
> 
> 时间：2009-02-06T07:32:56.933
> 
> 标签：html, css

我目前正在使用 CSS 和 Div 标签的组合来实现文本元素的圆角。这是我正在使用的 CSS：

```
div#installerSearch {
    float: left;
    position: relative;
    color: #000055;
    width: 154px;
    border: 1px solid #2A5390;
    padding: 8px;
    background-image: url('images/background.png');
}

div.roundAllGreen {
    position: absolute;
    width: 8px;
    height: 8px;
    background-image: url('images/roundgreenthingy.png');
}

div.roundTopLeft {
    left: -1px;
    top: -1px;
    background-position: 0px 0px;    
}

div.roundTopRight {
    right: -1px;
    top: -1px;
    background-position: -7px 0px;    
}

div.roundBottomLeft {
    left: -1px;
    bottom: -1px;
    background-position: 0px -7px;    
}

div.roundBottomRight {
    right: -1px;
    bottom: -1px;
    background-position: -7px -7px;    
} 
```

这是生成的 HTML：

```
<div id="installerSearch">
    <div class="roundAll roundTopLeft"></div>
    <div class="roundAll roundTopRight"></div>
    <div class="roundAll roundBottomLeft"></div>
    <div class="roundAll roundBottomRight"></div>
    <p> ... </p>
</div> 
```

其他人可以发现问题吗？我已经诉诸（因为缺乏更好的方法）以标记形式包含演示文稿，这使得重新主题有点困难，正如我正在尝试做的那样。

我真正想要的是能够让 CSS 为我在容器 div 中添加 div 标签。我意识到这在代码级别打破了“CSS 中无内容”规则，但考虑到我的圆角几乎没有资格作为内容，它不会在我的书中打破它。

所以我想我要问的是，有没有一种好方法可以实现相同的效果（使用图像的圆角）而不需要使用 CSS 在我的内容中引入额外的标签？这里的想法是最终得到一个 CSS 表，我可以完全换掉它，而无需修改我的模板 HTML 页面，但如果这不可能，我会接受它作为答案。看来谷歌这次完全失败了。^_^

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T08:10:49.850

简短的回答：目前[没有得到很好支持的纯 CSS](http://www.css3.info/preview/rounded-border/)方法来做到这一点。

如果您迫不及待地等待 CSS3 支持，您可能需要研究 JavaScript 替代方案。[Nifty Corners Cube](http://www.html.it/articoli/niftycube/index.html)将添加圆角，并声称甚至可以消除锯齿。[jQuery角插件](http://www.google.com/search?hl=en&q=jquery+corner)也有很多，[这一款](http://www.methvin.com/jquery/jq-corner-demo.html)做了很多不同的角效果。

你有什么特别的原因要在角落使用图像吗？如果您只需要一个圆角，您也许可以通过使用上述 JavaScript 解决方案来获得。我真的建议您查看 Nifty Corners Cube 示例。

**编辑：**如果您担心额外的标记会损害您的搜索引擎效率，那么 JavaScript 解决方案会更有意义（尽管我认为纯 CSS 的解决方案是最好的），因为额外的标记将添加到客户端。我与一些搜索引擎合作过，他们在索引内容之前故意去除脚本标签。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T18:16:57.210

> 其他人可以发现问题吗？

roundAll 和roundAllGreen 的className 的区别？

> 我已经诉诸（因为缺乏更好的方法）以标记形式包含演示文稿，这使得重新主题有点困难，正如我正在尝试做的那样。

对标记的某种干扰是不可避免的，直到 (a) IE 支持边框半径，或 (b) 单个元素上的多个背景图像成为可能。

另一种干扰较少的可能性是背景嵌套：

```
<div class="box"><div><div><div>
    Hello
</div></div></div></div>

.box { background: url(topleft.png) top left no-repeat; }
.box div { background: url(topright.png) top right no-repeat; }
.box div div { background: url(bottomleft.png) bottom left no-repeat; }
.box div div div { background: url(bottomright.png) bottom right no-repeat; } 
```

在您当前的页面中，框的宽度是固定的，因此您只能使用两个嵌套 div，一个用于顶部边缘，一个用于底部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T07:41:28.070

您可以编写 JavaScript 来为您添加这些 div。但这在 CSS 中是一个大问题，不管别人怎么说，它确实取决于内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T13:53:28.367

另一个很好用的 jquery 插件：[Anti-aliased Rounded corners with JQuery](http://blue-anvil.com/archives/anti-aliased-rounded-corners-with-jquery)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T19:09:34.703

bobinces 解决方案的一种模式：

```
<div class="box"><div><div><div>
    Hello
</div></div></div></div>

.box { background: url(topleft.png) top left no-repeat; }
.box>div { background: url(topright.png) top right no-repeat; }
.box>div>div { background: url(bottomleft.png) bottom left no-repeat; }
.box>div>div>div { background: url(bottomright.png) bottom right no-repeat; } 
```

# sql - 为什么这种外键是可能的？

> ID：519456
> 
> 赞同：0
> 
> 时间：2009-02-06T07:35:33.947
> 
> 标签：sql, sql-server, foreign-keys, database-agnostic

为什么 SQL 标准接受这个？有哪些好处？

如果有这些表：

```
create table prova_a (a number, b number);
alter table prova_a add primary key (a,b);
create table prova_b (a number, b number);
alter table prova_b add foreign key (a,b) references prova_a(a,b) ;
insert into prova_a  values (1,2); 
```

您可以插入它而不会出错：

```
insert into prova_b  values (123,null);
insert into prova_b  values (null,123); 
```

**注1**：这来自这个[答案](https://stackoverflow.com/questions/474591/which-are-the-sql-improvements-you-are-waiting-for/518195#518195)。

**注意2**：这可以避免，在两列上都设置不为空。

**备注**：我不是问避免，我感兴趣的是哪些是好处。

参考：

*   [Oracle 文档](http://download.oracle.com/docs/cd/B28359_01/server.111/b28318/data_int.htm#CNCPT1651)： *关系模型允许外键的值与引用的主键或唯一键值匹配，或者为空。如果复合外键的任何列为空，则该键的非空部分不必匹配父键的任何对应部分。*

*   [SQL Server 文档](http://technet.microsoft.com/en-us/library/ms175464.aspx)：*外键约束可以包含空值；但是，如果复合 FOREIGN KEY 约束的任何列包含空值，则会跳过对构成 FOREIGN KEY 约束的所有值的验证。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T07:42:42.450

我知道一些 DBMS 在涉及具有外键约束的外键时根本不会强制执行参照完整性。想到了 SQLite。[这里](http://www.sqlite.org/cvstrac/wiki?p=ForeignKeyTriggers)谈到了。

其他 DBMS 是不同的，我知道如果你尝试这样的事情，MS SQL Server 会抱怨。

SQLite 有它的用途，但它并不意味着在高并发情况下使用。如果您在不同的 DBMS 中看到此行为，请检查他们的文档以查看他们是否做了类似的事情。然而，大多数应该强制执行完整性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T08:39:39.340

至少你的 DEV 使用相当标准的 RDBMS 工作，即使你正在使用 SQLite 之类的东西（这是一个优秀的数据库 - 它在你的 Ipod touch 中运行！）它会清除所有这些错误 - 就像 Lint 真的. 如果您使用可以免费下载的 SQL Server Express 运行代码，您会遇到很多错误，例如...

```
Msg 8111, Level 16, State 1, Line 2
Cannot define PRIMARY KEY constraint on nullable column in table 'prova_a'.
Msg 1750, Level 16, State 0, Line 2
Could not create constraint. See previous errors. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T03:00:10.823

Oracle and SQL Server both allow NULL foreign keys, and it is easily understandable why this is necessary. Think of a tree, for instance, where every row has a parent key that references the primary key of the same table. There has to be a root node in the tree that does not have a parent, and the parent key will be null. A more tangible example: think of employees and managers. Some people in the company, and if it is only the CEO, will not have a manager. Were it not possible to set the manager id on the employee table to NULL, you would have to create a "No Manager" employee - something that is just wrong, because it has no real-life correspondence.

Now that we know this, it is obvious why your composite keys behave like they do. Logically, if part of the composite is NULL, the entire key is null. A string concatenation returns NULL if one of the pieces is NULL. There cannot be a match, and the constraint is not enforced in these cases.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T07:49:05.323

SQL 标准不接受这个；您发现了一个不强制引用完整性的 DBMS。如果您很聪明，请**立即**卸载它。至少不要将其用于生产目的。

早期的 SQL 标准 (SQL86) 没有参照完整性，而 SQL89 级别 2 修复了该问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T10:44:54.563

尝试添加此声明：

alter table prova_b 添加主键 (a,b);

这将禁止 prova_b 中的 NULLS。它还将禁止重复条目。在 Oracle 和 SQL server 中，它也会创建一个索引。该索引将加速查找和连接，但会稍微减慢插入速度。

这是你想做的吗？

至于为什么标准 SQL 允许您做一些您认为愚蠢的事情，这是一个哲学问题。大多数工具都允许一些愚蠢的选择。试图禁止所有愚蠢选择的工具通常最终会无意中禁止一些真正聪明的选择。

# ruby-on-rails - Ruby On Rails 中的路由

> ID：519457
> 
> 赞同：0
> 
> 时间：2009-02-06T07:36:43.320
> 
> 标签：ruby-on-rails

我使用脚手架创建模型和控制器。它运作良好。然后我开始编辑/删除一些控制器动作。所以我做了参与/新>参与/注册。

这不起作用，它说“未知动作”，但它确实说它有动作注册。有趣的是，如果我使用大写字母 P 去参与/注册。那么它确实有效！

我还做了 Rake 路线，即使我编辑了方法名称，仍会出现参与/新的。

我需要做些什么来定义动作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T08:07:39.157

您还需要编辑 config/routes.rb 文件并告诉 Rails 它应该如何处理参与/注册路由。在您的 routes.rb 文件中，您应该有类似的内容：

```
map.resources :participations 
```

您必须为此添加新规则：

```
map.signup '/participations/signup', :controller => 'participations', :action => 'new' 
```

塔应该这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T12:42:52.453

如果您正在使用资源，那么很容易修复。

也就是说，如果你有

> `map.resources :participations`

并且您不想像其他答案所暗示的那样使用命名路线，您有以下选择：

*   将 /participations/new 更改为 /participations/signup，但仍将 new 作为控制器中的操作

    > `map.resources :participations, :path_names => {:new => 'signup'}`

*   要使用 /participations/signup 和控制器中的操作注册：

    > `map.resources :participations, :collection => {:signup => [:get, :post]}`

如果你还想限制他们不能使用 /participations/new 动作，添加`:except => :new`到上面的语句

我建议您使用这种方式，除非您有使用命名路由的理由，因为它（至少我认为）提供了更清晰的 routes.rb。

请记住，routes.rb 是从上到下读取的，因此第一个匹配的路线将是正在使用的路线。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T09:05:43.983

维护标准的 RESTful 路由和控制器操作并将用户友好的备用路径映射到它们上并不罕见。例如，在您的情况下：

```
map.signup '/signup', :controller => 'participations', :action => 'new' 
```

然后，您的用户可以`participations#new`通过非常友好的 URL访问`http://foo.com/signup`（当然，如果您的站点位于 foo.com）。在您的控制器和视图中，您可以将此路由称为`signup_path`或`signup_url`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T07:51:06.193

如果我没记错的话，RoR 是区分大小写的，因此请确保您的控制器以小写“p”开头，并且任何操作也以小写字母开头。试试看

# deployment - 如何为 n 层部署场景配置 CSLA？

> ID：519458
> 
> 赞同：0
> 
> 时间：2009-02-06T07:37:29.590
> 
> 标签：deployment, n-tier-architecture, csla

需要

1.  在 CSLA 部署中从单层迁移到多层时所需的快速配置更改列表
2.  上述清单的详细解释
3.  A 如何列出

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-01T17:43:11.043

这取决于许多场景，例如您使用的 CSLA 版本以及您的要求。我将从阅读 RunLocal 属性开始。

谢谢 -Blake Niemyjski（[CodeSmith CSLA 模板](http://www.codesmithtools.com/generate-csla-code-with-templates.aspx)的作者）

# c# - 克隆列表

> ID：519461
> 
> 赞同：25
> 
> 时间：2009-02-06T07:41:02.017
> 
> 标签：c#, .net

我认为要克隆一个列表，您只需调用：

```
List<int> cloneList = new List<int>(originalList); 
```

但是我在我的代码中尝试了这一点，我似乎得到了暗示上述内容只是在做的效果：

cloneList = originalList... 因为对 cloneList 的更改似乎正在影响 originalList。

那么克隆List的方法是什么？

编辑：

我正在考虑做这样的事情：

```
public static List<T> Clone<T>(this List<T> originalList) where T : ICloneable
{
    return originalList.ConvertAll(x => (T) x.Clone());
} 
```

编辑2：

我采用了 Binoj Antony 建议的深拷贝代码并创建了这个扩展方法：

```
public static T DeepCopy<T>(this T original) where T : class
{
    using (MemoryStream memoryStream = new MemoryStream())
    {
        BinaryFormatter binaryFormatter = new BinaryFormatter();
        binaryFormatter.Serialize(memoryStream, original);
        memoryStream.Seek(0, SeekOrigin.Begin);
        return (T)binaryFormatter.Deserialize(memoryStream);
    }
} 
```

编辑3：

现在，假设 List 中的项目是结构。如果我打电话会有什么结果？：

```
List<StructType> cloneList = new List<StructType>(originalList); 
```

我很确定我会得到一个充满新独特物品的列表，对吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-06T07:42:12.203

这会工作...

```
List<Foo> cloneList = new List<Foo>(originalList); 
```

当您说“因为对 cloneList 的更改似乎正在影响 originalList”时。- 你的意思是更改**列表**，还是更改**项目**...

添加/删除/交换项目正在更改**列表**- 所以如果我们这样做：

```
cloneList.Add(anotherItem); 
```

你应该会发现它`cloneList`比`originalList`. 但是，如果内容是引用类型（类），那么两个列表仍然指向相同的底层对象 - 所以如果我们这样做：

```
cloneList[0].SomeObjectProperty = 12345; 
```

那么这也将显示反对`originalList[0].SomeObjectProperty`- 只有一个对象（在两个列表之间共享）。

如果这是问题所在，您将不得不克隆列表中的**对象**- 然后您将进入整个深浅问题......这是问题吗？

[对于浅拷贝，您可能可以使用与此处](https://stackoverflow.com/questions/516463/copying-a-listbaseclass-to-listderivedclass/516553#516553)的答案非常相似的东西- 只需使用`TTo = TFrom`（也许简化为单个`T`）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-06T08:10:48.667

您可以使用以下代码制作列表或任何其他支持序列化的对象的深层副本：

您也可以将它用于 v 2.0 及更高版本的任何 .NET 框架版本，并且可以应用类似的技术（删除泛型的使用）并在 1.1 中使用

```
public static class GenericCopier<T>
{
    public static T DeepCopy(object objectToCopy)
    {
        using (MemoryStream memoryStream = new MemoryStream())
        {
            BinaryFormatter binaryFormatter = new BinaryFormatter();
            binaryFormatter.Serialize(memoryStream, objectToCopy);
            memoryStream.Seek(0, SeekOrigin.Begin);
            return (T) binaryFormatter.Deserialize(memoryStream);
        }
    }
} 
```

您可以使用它来调用它

```
List<int> deepCopiedList = GenericCopier<List<int>>.DeepCopy(originalList); 
```

测试这是否有效的完整代码：

```
static void Main(string[] args)
{
    List<int> originalList = new List<int>(5);
    Random random = new Random();
    for(int i = 0; i < 5; i++)
    {
        originalList.Add(random.Next(1, 100));
        Console.WriteLine("List[{0}] = {1}", i, originalList[i]);
    }
    List<int> deepCopiedList = GenericCopier<List<int>>.DeepCopy(originalList);
    for (int i = 0; i < 5; i++)
        Console.WriteLine("deepCopiedList[{0}] value is {1}", i, deepCopiedList[i]);
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-06T08:01:08.310

我怀疑您的*实际*示例会出现问题，因为`int`它是一种值类型。例如：

```
using System;
using System.Collections.Generic;

class Test
{
    static void Main()
    {
        List<int> originalList = new List<int> { 5, 6, 7 };
        List<int> cloneList = new List<int>(originalList);

        cloneList.Add(8);
        cloneList[0] = 2;
        Console.WriteLine(originalList.Count); // Still 3
        Console.WriteLine(originalList[0]); // Still 5
    }
} 
```

但是，正如 Marc 所说，如果您的列表包含可变引用类型，则克隆列表只会采用*浅*拷贝 - 如果您改变列表引用的对象，则这些更改将通过两个列表可见。替换一个列表中的元素不会更改另一个列表中的等效元素：

```
using System;
using System.Collections.Generic;

class Dummy
{
    public int Value { get; set; }

    public Dummy (int value)
    {
        this.Value = value;
    }
}

class Test
{
    static void Main()
    {
        List<Dummy> originalList = new List<Dummy> 
        {
            new Dummy(5),
            new Dummy(6),
            new Dummy(7)
        };

        List<Dummy> cloneList = new List<Dummy>(originalList);

        cloneList[0].Value = 1;
        cloneList[1] = new Dummy(2);
        Console.WriteLine(originalList[0].Value); // Changed to 1
        Console.WriteLine(originalList[1].Value); // Still 6
    }
} 
```

要对元素类型实现的列表进行“深度克隆” `ICloneable`，请使用：

```
List<Foo> cloneList = originalList.ConvertAll(x => (Foo) x.Clone()); 
```

然而，这个克隆的真正深度将取决于`ICloneable`元素类型中的实现——`ICloneable`通常被认为是一个坏事，因为它的契约是如此模糊。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T07:58:34.697

如果列表的基础类型是*值类型*，则使用带有原始列表作为参数的 List 构造函数将起作用。对于引用类型的 List 元素，我认为您想对它们进行*深度复制*。

你可以这样做：

*（假设底层类型实现了 ICloneable）*

```
originalList.ForEach((item) =>
                       {
                         cloneList.Add((ICloneable)item.Clone());
                       }
                     ); 
```

或使用一些[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)：

```
var cloneList = originalList.Select(item => (ICloneable)item.Clone()).ToList(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T09:18:53.803

我投票不依赖对象序列化。这是昂贵且不好的做法。

```
public static TObj CloneObject<TObj>(this TObj obj)
    where TObj : ICloneable
{
    return (TObj)obj.Clone();
} 
```

上面的方法更加优雅，如果你需要一个可克隆的接口，你应该非常小心。你也可以让它通用。

```
public interface ICloneable<T> : IClonable
{
    T CloneObject();
} 
```

或者，您可以避免使用[IClonable](http://msdn.microsoft.com/en-us/library/system.icloneable.aspx)接口作为基本类型，因为它维护不善。方法名称必须更改为，因为您不能对返回类型进行重载。

```
public static List<T> CloneList(this List<T> source)
    where TObj : ICloneable
{
    return source.Select(x=>x.CloneObject()).ToList();
} 
```

就这么简单。

也许您的问题可以通过使用值类型来解决。他们总是通过副本。因此，只要您的数据结构是按值计算的，您就不必克隆任何东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-06T07:49:37.350

它[在这里](http://msdn.microsoft.com/en-us/library/fkbw11z0.aspx)特别说明项目将复制到您的新列表中。所以是的，这应该有效。使用值类型，您将获得完全的独立性。但请记住，对于引用类型，列表将是独立的，但它们将指向相同的对象。您需要深度复制列表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T07:51:59.577

```
 List list = new List ();
            List clone = new List (list);
            list.Add (new int ());
            Debug.Assert (list != clone);
            Debug.Assert (list.Count == 1);
            Debug.Assert (clone.Count == 0); 
```

这段代码完全按照我的预期工作。您是否可能更改列表中的对象？列表项**不会**被`new List(oldList)`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-06T14:16:20.223

我必须补充：如果您要使用序列化来促进深度复制，为什么要克隆每个单独的项目？只需克隆整个原始列表即可。

除非您有适当的逻辑，即您只克隆满足某些条件的节点，然后逐个节点地进行。

# c# - 是否可以在 UNIX 上运行 WS IIS？

> ID：519462
> 
> 赞同：1
> 
> 时间：2009-02-06T07:41:26.290
> 
> 标签：c#

是否可以在 UNIX 上的 IIS 中运行我的 WebService？如果没有，那我该怎么办？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T07:45:24.317

您可以尝试使用[Mono](http://www.mono-project.com)和 mod_mono for Apache。它*应该*开箱即用。据我所知，没有机会在 *nix 下运行 IIS，至少出于许可原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T08:18:44.843

我必须补充一点，一些专有类可能不可用。只有由 ECMA 定义的 .NET 类以及实现的任何 Mono 项目都可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T10:43:18.063

不，您不能在 UNIX 上运行 IIS。您可以做的是在它所属的 Windows 上运行它。

如果这是一个个人项目，那么，如果您愿意，请务必将其托付给 Mono。我不相信 Mono 已经为黄金时段做好了准备，而且太多的微软“合作伙伴”一旦变得足以与微软的核心产品竞争，就会发现自己陷入困境。

我的个人观点是（这只是一个观点，所以不要与我争论）如果 Mono 开始变得过于成功，它要么仍然是一个支持不足的死水，要么被完全摧毁。

但如果它很重要，您需要在受支持的配置中运行它。这意味着没有 Mono，没有 UNIX。

否则，当您致电 Microsoft 寻求帮助时，他们会无情地嘲笑您 :-)。

# cocoa-touch - iPhone 从 NSArray 获取 UIImageView

> ID：519467
> 
> 赞同：0
> 
> 时间：2009-02-06T07:42:55.307
> 
> 标签：cocoa-touch

首先非常感谢您点击我的问题。

我有几个 UIImageView 和一个 NSMutableArray

在.h

```
{
    IBOutlet UIImageView *img1;
    IBOutlet UIImageView *img2;
    IBOutlet UIImageView *img3;
    NSMutable Array *aImg;
}
@property(nonatomic, retian) IBOutlet UIImageView *img1;
@property(nonatomic, retian) IBOutlet UIImageView *img2;
@property(nonatomic, retian) IBOutlet UIImageView *img3;
@property(nonatomic, retain) NSMutableArray *aImg; 
```

在.m

```
-(void)viewDidLoad
{
    [super viewDidLoad];
    aImg = [NSMutableArray arrayWithObjects: img1, img2, img3, nil];
} 
```

然后在其他功能上，当我写

```
UIImageView *tmp1;
tmp1 = [aImg objectAtIndex:0]; 
```

它说 GDB：程序已加载；并显示了一些狗屎
0x92a1d688 <+0024> mov 0x20(%edx), %edi

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T08:05:43.777

是 EXC BAD ACCESS 错误吗？我敢打赌是的。这是当您尝试访问已从内存中删除或释放的对象时引起的。

这一行：

```
aImg = [NSMutableArray arrayWithObjects: img1, img2, img3, nil]; 
```

返回一个设置为自动释放的数组对象。这意味着在导致此操作的事件完成后，它将被释放。如果你不专门保留它，它将被释放，保留计数将降至零，并且对象将被释放。

然后稍后当您尝试使用该数组时，它实际上并不存在并且程序崩溃。如果您改为这样做：

```
aImg = [[NSMutableArray alloc] initWithObjects: img1, img2, img3, nil]; 
```

然后你直接初始化一个数组，这个不会自动释放。只需确保在包含此数组的类的 -(void)dealloc 方法中添加：

```
[aImg release]; 
```

阅读此文档，然后再阅读一遍。这对 iPhone 的开发非常重要。 [http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T08:00:06.300

您想保留您正在创建的数组，否则它会在之后立即释放。

```
-(void)viewDidLoad{
    [super viewDidLoad];
    aImg = [[NSMutableArray arrayWithObjects: img1, img2, img3, nil] retain];
} 
```

# apache-flex - Flex 中正确的字典/地图/树/散列容器

> ID：519482
> 
> 赞同：8
> 
> 时间：2009-02-06T07:51:59.890
> 
> 标签：apache-flex, actionscript-3

我对 Flex 的 Dictionary 越来越感到沮丧（它实际上只是一个带有字符串索引的数组）。

琐碎的事情似乎是不可能的，比如获取最后一个元素，甚至根据键迭代*排序*的容器（顺序似乎是任意的），如果给定一个带有字符串的数组，排序函数似乎会把所有东西都弄得一团糟指数。

是否有更好、更完整的 Flex 容器库？有数组、列表、队列、映射、多映射、哈希映射等的东西吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T11:51:40.093

as3ds项目有一堆用于 AS3 的[集合](http://code.google.com/p/as3ds/)类[。](http://code.google.com/p/as3ds/source/browse/#svn/trunk/src/de/polygonal/ds)我自己没有使用过它们，但它们看起来非常有能力（我可能会补充一点，专注于性能）。使用 MIT 许可证。

[Maashaack](http://code.google.com/p/maashaack/)也有一些[集合类](http://code.google.com/p/maashaack/source/browse/#svn/trunk/AS3/src/system/data)。他们使用 MPL 1.1/GPL 2.0/LGPL 2.1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T11:29:14.647

我不知道 ActionScript 3/Flex 的集合数据类型库，但我肯定会很感激。

不过，我们在 Spring ActionScript 框架中确实有一些额外的集合。我们还有一堆实用方法来处理现有数据类型。检查[https://fisheye.springframework.org/browse/se-springactionscript-as/spring-actionscript/trunk/core/src/main/actionscript/org/springextensions/actionscript/collections](https://fisheye.springframework.org/browse/se-springactionscript-as/spring-actionscript/trunk/core/src/main/actionscript/org/springextensions/actionscript/collections)和[https://fisheye 的来源。 springframework.org/browse/se-springactionscript-as/spring-actionscript/trunk/core/src/main/actionscript/org/springextensions/actionscript/utils](https://fisheye.springframework.org/browse/se-springactionscript-as/spring-actionscript/trunk/core/src/main/actionscript/org/springextensions/actionscript/utils)

我确实想指出 Dictionary 不仅仅是一个带有字符串索引的数组。那将是 ActionScript 中对象的定义。Dictionary 可以将复杂类型保存为键，而不仅仅是字符串，这是一个很大的区别。它还使用严格相等 (===) 进行键比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T11:48:21.050

虽然它不是一个完整的容器库，但在[3 磅 Monkey Brain](http://3lbmonkeybrain.blogspot.com/2008/08/sets-for-actionscript.html)上有一个用于 AS 的 HashSet 实现。我已经使用了一段时间，没有任何抱怨。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-28T14:12:58.273

不要错过[AS3Commons Collections Framework](http://sibirjak.com/osflash/projects/as3commons-collections/)，其中包括多个列表、集合、地图和树。有关其他库的比较，请访问文章[为什么我们需要 ActionScript 中的集合框架](http://sibirjak.com/osflash/blog/why-we-need-a-collection-framework-in-actionscript/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T15:58:10.427

Polygonal Labs 有一个我过去使用过的数据结构库。它面向游戏开发，这实际上意味着它是超级优化的。这包括：

多维数组、队列、堆栈、哈希表、树、二叉树、二叉搜索树、链表、堆、图、位向量

他们在所有类上实现了迭代器模式，如果你做过 Java 开发，你会非常熟悉，如果你没有做过，也很容易学习。

查看他们的网站以获取完整描述： http: [//lab.polygonal.de/ds/](http://lab.polygonal.de/ds/)

这是谷歌代码库：[http ://code.google.com/p/as3ds/](http://code.google.com/p/as3ds/)

# c# - 从字节流返回的奇怪字符？

> ID：519484
> 
> 赞同：0
> 
> 时间：2009-02-06T07:53:03.507
> 
> 标签：c#, character-encoding, bytearray

当试图在文本框中显示来自 HLDS（半条命专用服务器）的字节流时，它会显示奇怪的块状问号字符，如下所示：

```
[?] 
```

这是字节流中的示例行（用 [?] 代替奇怪的字符）：

```
CPU   In    Out   Uptime  Users   FPS    Players[?] 0.00  0.97  0.91    2806   182  297.25       1[?] 
```

这是我将字节流显示为字符串的方式：

```
byte[] bytes = listener.Receive(ref sender); // get bytes from stream
TextBox1.Text = Encoding.ASCII.GetString(bytes, 0, bytes.Length); // write to textbox 
```

字符出现在`[CR][LF]`通常应该出现的位置。为什么它显示奇怪的字符，我该怎么做才能删除奇怪的字符或纠正编码？

```
***** UPDATE ***** 
```

Jon Skeet 提供了正确的答案。日志返回 \n 换行符（不是 \r\n），并在每个流式传输的日志行末尾返回 \0。将 \n 替换为 Environment.NewLine 并将 \0 替换为 string.Empty 并且奇怪的字符消失了。谢谢乔恩。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T07:56:39.037

1.  你确定数据是纯ASCII的吗？它可能在众多代码页之一中吗？
2.  可能是因为 [CR] vs [LF] vs [CR] [LF]？
3.  你能告诉使用“玩家......”周围的字节吗？你期望看到什么？我们*也许*能够识别代码页

推测该字节位于代码页区域 (128-255) 或控制字符 (0-31) 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T07:57:40.220

您可能必须用文本框可以理解的换行符手动替换它们，或者如果还没有，您可能必须使文本框变成多行。

[Geekpedia](http://www.geekpedia.com/KB19_How-can-I-insert-a-new-line-in-a-TextBox.html)说只要确保你设置：

```
TextBox1.MultiLine = true 
```

回复后：

如果某些字符不是 CRLF，那么您需要检查如何获取它们。

查看实际输出`Encoding.ASCII.GetString()`，看看里面有什么。

您示例中的那些显然是行尾字符，因为它们将标题与数据行分开。CRLF 应该在多行文本框中工作，所以我不确定那里发生了什么（直到您验证字节内容） - 其他字符可能被替换为空格（这是一个选项）。

而且，我假设这个文本框的字体是固定的，而不是成比例的，否则它不会很好地排列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T08:08:14.613

首先，我相信如果文本框曾经收到一个字符 0，他们会认为这是数据的结尾——你可能想要特别注意这一点。

你的字节流来自哪里？它*意味着*什么编码？数据中那个点的字节是多少？

# selenium - javascript 应用程序上的 Cucumber + Selenium

> ID：519496
> 
> 赞同：6
> 
> 时间：2009-02-06T08:00:18.033
> 
> 标签：selenium, cucumber

我正在尝试学习如何最好地使用 Cucumber + Selenium。在大多数情况下，它似乎非常简单，但我想获得一些关于如何测试对话的指导。基本上我需要实现：

```
assert !60.times{
   break if ("Other Income" == @selenium.get_text("//form[@id='new_account']/h3")  rescue false); sleep 1 } 
```

标准的等待形式。如何在 Cucumber 规范中实现这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-12-18T22:58:17.517

要稍微更新一下这个答案，我强烈建议使用 Capybara：

[http://github.com/jnicklas/capybara](http://github.com/jnicklas/capybara)

能够使用 javascript 只是`gem install`遥不可及！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T12:49:16.937

查看[https://github.com/cucumber/cucumber/wiki/setting-up-selenium](https://github.com/cucumber/cucumber/wiki/setting-up-selenium)以获得相当彻底的演练，以及 Cucumber 附带的示例（[本机示例](http://github.com/cucumber/cucumber/tree/29d83d51907b8bfa455c1a2e365c72d77655e85c/examples/selenium)和[selenium 通过 webrat](http://github.com/cucumber/cucumber/tree/29d83d51907b8bfa455c1a2e365c72d77655e85c/examples/selenium_webrat)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-29T21:44:32.153

本指南已过时，即将修复，但同时您不需要 Selenium gem。此外，您必须使用 selenium-client -v=1.2.14。您不需要覆盖任何罐子。确保所有 selenium 进程都已停止并且安装了正确的版本并且它应该运行。有关硒/非硒测试的多种环境的信息仍然有效且有用。

# text - 文字不规范

> ID：519509
> 
> 赞同：0
> 
> 时间：2009-02-06T08:10:17.917
> 
> 标签：text, compression, text-parsing, similarity, identification

有人知道那里有一个库或软件可以找到文本中的不规则之处吗？例如，假设我有...

```
1.姓名1，评论
2.名称2，评论
3\. 姓名 3 , 评论
5.姓名10，评论

```

该软件或库将首先剪切它会发现相似的文本部分（很像一个压缩软件会编码重复的相似文本部分以将其压缩）但是使用容错变量它可以找到相似的文本部分，现在很像文本比较应用程序或差异/合并工具，它实际上可以突出显示它看到的不同之处。我正在考虑制作这个工具，但我不想重新发明轮子。如果有任何远程能够做到这一点的东西，我真的很想知道可能会帮助这个项目，或者至少知道不做一个。更不用说这个答案可能会帮助其他人寻找同样的东西，我认为需求对供应来说已经足够高了，这就是为什么让我难以置信我能做到的原因

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T08:29:29.003

如果你喜欢 Python，你可以试试[difflib](http://docs.python.org/library/difflib.html)。

这不是您问题的确切解决方案，但它可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T08:54:49.390

根据您想要找到或纠正的现实生活中的违规行为类型，这个问题是完全不同的。

这是您使用真实文本更新的示例：

```
1\. Lazarus Long, Get the first shot off fast.
2\. Hiro Protagonist, Greatest swordfighter[sic] in the world.
3\. Alice , Down the rabbit hole.
5\. Orem, Sink of power. 
```

在此示例中，可以使用带有查找替换功能的体面的文本编辑器来修复错误。如果您对通配符有创意，文本编辑器和十六进制编辑器可以创造奇迹。只要您的定界因素存在（. 或 ,），问题就很简单。正如您可能已经知道的那样；一旦其中一个缺失，问题就会变得更加复杂。

一个难题的例子：

```
1\. Lazarus Long, Get the first shot off fast.
 2\. Hiro Protagonist  Greatest swordfighter[sic] in the world.
3\. Alice , Down the rabbit hole.
5 . Orem, , Sink of power. 
```

我可能会分几步来解决这个问题。1.清理多余的空间。2\. 找出关键统计数据，例如每行分隔符的数量和每分隔列的平均单词数或字符数。大多数名称是一两个词，评论未知或受输入限制。3\. 查找具有统计上不可能数量的关键特征的行。4\. 尽力改正。

我知道这并不能直接解决您的问题，但也许一个想法可以解决您的问题。过去的车轮制造商可能从未完成任何设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T13:20:06.887

听起来基本上就像您想使用正则表达式来创建“理想响应”，然后将其余行与之进行比较。

Or you could write a more complicated program which would boil each line down into a Regex query, and then compare the queries to each other to see which ones are different.

# language-agnostic - 多态性如何替换循环内的 if-else 语句？

> ID：519515
> 
> 赞同：18
> 
> 时间：2009-02-06T08:11:14.157
> 
> 标签：language-agnostic, oop, loops, polymorphism, if-statement

多态性如何替换循环内的 if-else 语句或 Switch？特别是它总是可以替换 if-else 吗？我在循环中使用的大多数 if-then 都是算术比较。[这个问题就是从这个问题](https://stackoverflow.com/questions/519422/what-is-the-best-way-to-replace-or-substitute-if-else-if-else-trees-in-programs/519447#519447)衍生出来的。

```
int x;
int y;
int z;

while (x > y)
{
     if (x < z)
     {
         x = z;
     }
} 
```

这将如何与多态性一起工作？
注意：我是用 Java 编写的，但对任何 OOL 都对此感兴趣。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-06T08:21:31.187

当每种情况对应不同的类型时，多态性通常会替换 switch 语句。因此，而不是：

```
public class Operator
{
    string operation;

    public int Execute(int x, int y)
    {
         switch(operation)
         {
             case "Add":
                 return x + y;
             case "Subtract":
                 return x - y;
             case "Multiply":
                 return x * y;
             case "Divide":
                 return x / y;
             default:
                 throw new InvalidOperationException("Unsupported operation");
         }
    }
} 
```

你会有：

```
public abstract class Operator
{
    public abstract int Execute(int x, int y);
}

public class Add : Operator
{
    public override int Execute(int x, int y)
    {
        return x + y;
    }
}

// etc 
```

但是，对于您提供的比较类型的决策，多态性确实没有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T08:19:39.850

多态性在您提供的示例中并不真正适用。

看到这个[答案](https://stackoverflow.com/questions/234458/does-polymorphism-or-conditionals-promote-better-design)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T08:25:30.617

当 if 测试基本上根据对象的“类型”分配给各种方法时，多态性只能替代 if 测试。例如，如果对象是 X 类型，则调用 foo 如果它是 Y 调用 bar 等等。在这个人为的示例中，我们将使用方法 bad() 定义一个接口 DoSonething。X 和 Y 都将实现 Baz 并让它们各自的 baz() 为 X 调用 foo() 和为 Y 调用 bar()。这简单地调用 baz() 将消除对 if 测试的需要。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T09:19:43.097

在 Smalltalk 中，“if”实际上是 Boolean 中的多态方法。在以下示例中：

```
[ x>y ] whileTrue:  
  [   
    ( x<z ) ifTrue: [ x:=z ]        
  ] 
```

该`ifTrue:aBlock`消息`True`以“执行此块”和`False`“忽略此块”的形式实现，因此根据`(x<z)`评估结果，将调用任一实现。

所以在 Smalltalk 中，多态性默认替换了每个 if-else 构造:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T10:18:56.833

一种模式是拥有代表测试结果的对象和代表要执行的块的对象。结果对象具有覆盖的选择函数，因此如果 Bool 有一个 choose(T positive, Tnegative) 那么 Bool.TRUE 将返回正参数，而 Bool.FALSE 将返回负数。smalltalk-family 语言的幼稚实现就是这样工作的。

要以这种形式编码你的while循环，需要在比较x和y的结果上调用choose方法来确定是否为while循环内部调用块，并且该块还使用比较和选择来设置x 的值。更直接的翻译是选择将 x 设置为 z 的块或不执行任何操作的块；相反，它只是使用选择将 x 设置回相同的值。

显然，对于这个简单的案例来说，这是矫枉过正且效率低下的。

```
public class WantonPolymorphism {

    static class Int32 {
        final int value;
        Int32 ( final int value ) { this.value = value; }

        Compare compare ( Int32 other ) {
            // Java runs out of turtles at this point unless you use
            // an enum for every value
            if ( this.value < other.value ) return Compare.LESS;
            if ( this.value > other.value ) return Compare.GREATER;
            return Compare.EQUAL;
        }
    }

    enum Compare {
        LESS {
            <T> T choose (T less, T equal, T greater) { return less; }
        },
        EQUAL {
            <T> T choose (T less, T equal, T greater) { return equal; }
        },
        GREATER {
            <T> T choose (T less, T equal, T greater) { return greater; }
        };

        abstract <T> T choose (T less, T equal, T greater) ;
    }

    interface Block { Block execute () ; }

    /**
     * Main entry point for application.
     * @param args The command line arguments.
     */
    public static void main (String...args) {
        Block block =  new Block() {
            Int32 x = new Int32(4);
            Int32 y = new Int32(3);
            Int32 z = new Int32(2);

            public Block execute () {
                System.out.printf("x = %d, y = %d, z = %d\n", x.value, y.value, z.value);

                return x.compare(y).choose(done, done, new Block () {
                    public Block execute () {
                        x = x.compare(z).choose(x,x,z);

                        return x.compare(y).choose(done, done, this);
                    }
                });
            }

            Block done = new Block () {
                public Block execute () {
                    System.out.printf("x = %d, y = %d, z = %d\n", x.value, y.value, z.value);
                    System.exit(0);
                    return this;
                }
            };
        };

        for(;;) 
            block = block.execute();
    }
} 
```

# design-patterns - 静态类和单例模式之间的区别？

> ID：519520
> 
> 赞同：1934
> 
> 时间：2009-02-06T08:13:22.623
> 
> 标签：design-patterns, static, singleton

静态类和单例模式之间存在什么真正的（即实际的）区别？

两者都可以在没有实例化的情况下调用，都只提供一个“实例”，而且它们都不是线程安全的。还有其他区别吗？

* * *

## 回答 #1

> 赞同：1361
> 
> 时间：2009-02-06T08:17:44.423

是什么让您说单例或静态方法不是线程安全的？通常两者都*应该*实现为线程安全的。

单例和一堆静态方法之间的最大区别在于单例可以实现接口（或从有用的基类派生，尽管根据我的经验这不太常见），因此您可以传递单例，就好像它“只是另一个“ 执行。

* * *

## 回答 #2

> 赞同：514
> 
> 时间：2009-02-06T08:21:10.017

真正的答案是 Jon Skeet[在另一个论坛上的](http://bytes.com/groups/net-c/271199-diff-between-singleton-class-static-class#post1084937)。

> 单例允许访问单个创建的实例——该实例（或者更确切地说，对该实例的引用）可以作为参数传递给其他方法，并被视为普通对象。
> 
> 静态类只允许静态方法。

* * *

## 回答 #3

> 赞同：389
> 
> 时间：2012-09-11T10:22:53.063

1.  单例对象存储在**堆中**，而静态对象存储在**堆栈**中。
2.  我们可以**克隆**（如果设计者没有禁止的话）单例对象，但我们不能克隆静态类对象。
3.  单例类遵循**OOP**（面向对象原则），静态类不遵循。
4.  我们可以`interface`使用 Singleton 类实现 an，但类的静态方法（或例如 C# `static class`）不能。

* * *

## 回答 #4

> 赞同：175
> 
> 时间：2009-02-06T08:30:56.940

单例模式与静态类相比有几个优点。首先，单例可以扩展类和实现接口，而静态类不能（它可以扩展类，但不继承它们的实例成员）。单例可以延迟或异步初始化，而静态类通常在首次加载时进行初始化，从而导致潜在的类加载器问题。然而，最重要的优点是可以多态地处理单例，而不会强迫用户假设只有一个实例。

* * *

## 回答 #5

> 赞同：87
> 
> 时间：2010-12-30T20:55:55.453

`static`类不适合任何需要状态的东西。`Math`将一堆功能放在一起（或`Utils`在项目中）很有用。所以类名只是给了我们一个线索，我们可以在哪里找到函数，仅此而已。

`Singleton`是我最喜欢的模式，我用它来管理某件事。它比`static`类更灵活，并且可以维护它的状态。它可以实现接口，从其他类继承并允许继承。

`static`我在和之间选择的规则`singleton`：

如果有一堆功能应该放在一起，那`static`就是选择。任何其他需要单一访问某些资源的东西，都可以实现为`singleton`.

* * *

## 回答 #6

> 赞同：77
> 
> 时间：2015-06-01T11:42:12.967

**静态类：-**

1.  您不能创建静态类的实例。

2.  加载包含该类的程序或命名空间时，由 .NET Framework 公共语言运行时 (CLR) 自动加载。

3.  我们不能将静态类传递给方法。

4.  我们不能将静态类继承到 C# 中的另一个静态类。

5.  具有所有静态方法的类。

6.  更好的性能（静态方法在编译时绑定）

**单身人士：-**

1.  您可以创建对象的一个​​实例并重复使用它。

2.  Singleton 实例在用户请求时首次创建。

3.  您可以创建单例类的对象并将其传递给方法。

4.  单例类没有说任何继承限制。

5.  我们可以处理单例类的对象，但不能处理静态类的对象。

6.  方法可以被覆盖。

7.  需要时可以延迟加载（总是加载静态类）。

8.  我们可以实现接口（静态类不能实现接口）。

* * *

## 回答 #7

> 赞同：54
> 
> 时间：2009-02-06T08:35:14.140

静态类是只有静态方法的类，更好的词是“函数”。静态类中体现的设计风格是纯程序化的。

另一方面，Singleton 是一种特定于 OO 设计的模式。它是一个对象的实例（具有其中固有的所有可能性，例如多态性），具有一个创建过程，可确保该特定角色在其整个生命周期内只有一个实例。

* * *

## 回答 #8

> 赞同：37
> 
> 时间：2009-02-06T08:16:41.447

在单例模式中，您可以将单例创建为派生类型的实例，而使用静态类则无法做到这一点。

快速示例：

```
if( useD3D )
    IRenderer::instance = new D3DRenderer
else
    IRenderer::instance = new OpenGLRenderer 
```

* * *

## 回答 #9

> 赞同：28
> 
> 时间：2012-12-20T21:53:11.663

扩展[Jon Skeet 的答案](https://stackoverflow.com/a/519530/444639)

> 单例和一堆静态方法之间的最大区别在于，单例可以实现接口（或派生自有用的基类，尽管这不太常见 IME），因此您可以传递单例，就好像它是“只是另一个”实现一样。

在对类进行单元测试时，单例更容易使用。无论您在何处将单例作为参数（构造函数、设置器或方法）传递，您都可以替换为单例的模拟或存根版本。

* * *

## 回答 #10

> 赞同：26
> 
> 时间：2014-04-24T01:22:03.487

这是一篇好文章：http: [//javarevisited.blogspot.com.au/2013/03/difference-between-singleton-pattern-vs-static-class-java.html](http://javarevisited.blogspot.com.au/2013/03/difference-between-singleton-pattern-vs-static-class-java.html)

## **静态类**

*   具有所有**静态方法**的类。
*   更好的性能（静态方法在编译时绑定）
*   不能覆盖方法，但可以使用方法隐藏。（[Java中隐藏的方法是什么？甚至JavaDoc的解释都令人困惑](https://stackoverflow.com/questions/16313649/what-is-method-hiding-in-java-even-the-javadoc-explanation-is-confusing)）

    ```
    public class Animal {
        public static void foo() {
            System.out.println("Animal");
        }
    }

    public class Cat extends Animal {
        public static void foo() {  // hides Animal.foo()
            System.out.println("Cat");
        }
    } 
    ```

## **辛格尔顿**

*   只能实例化一次的**对象。**
*   方法可以被覆盖（[为什么 Java 不允许覆盖静态方法？](https://stackoverflow.com/questions/2223386/why-doesnt-java-allow-overriding-of-static-methods)）
*   比静态方法更容易模拟
*   更善于维持状态

总之，我只会使用静态类来保存 util 方法，而将 Singleton 用于其他所有内容。

* * *

**编辑**

*   静态类也是延迟加载的。谢谢@jmoreno（[静态类初始化什么时候发生？](https://stackoverflow.com/questions/3499214/when-does-static-class-initialization-happen)）

*   静态类的方法隐藏。谢谢@MaxPeng。

* * *

## 回答 #11

> 赞同：23
> 
> 时间：2011-08-08T03:36:34.950

单例的另一个优点是它可以很容易地序列化，如果您需要将其状态保存到磁盘或将其远程发送到某个地方，这可能是必要的。

* * *

## 回答 #12

> 赞同：19
> 
> 时间：2009-08-16T15:54:22.813

我不是一个伟大的 OO 理论家，但据我所知，我认为与 Singleton 相比，静态类唯一缺乏的 OO 特性是多态性。但是如果你不需要它，你当然可以使用静态类进行继承（不确定接口实现）以及数据和函数封装。

Morendil 的评论，“体现在静态类中的设计风格纯粹是程序性的”我可能是错的，但我不同意。在静态方法中，您可以访问静态成员，这与访问其单个实例成员的单例方法完全相同。

编辑：
我现在实际上在想，另一个区别是静态类在程序启动时*实例化**并存在于程序的整个生命周期中，而单例在某些时候被显式实例化并且也可以被销毁。

* 或者它可能在第一次使用时被实例化，这取决于语言，我认为。

* * *

## 回答 #13

> 赞同：17
> 
> 时间：2013-06-09T23:49:01.670

为了说明 Jon 的观点，如果 Logger 是静态类，则无法完成下面显示的操作。该类`SomeClass`期望将实现的实例`ILogger`传递到其构造函数中。

单例类对于依赖注入的可能很重要。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {

            var someClass = new SomeClass(Logger.GetLogger());
        }

    }

    public class SomeClass 
    {
        public SomeClass(ILogger MyLogger)
        {

        }
    }

    public class Logger : ILogger
    {
        private static Logger _logger;
        private Logger() { }

        public static Logger GetLogger()
        {
            if (_logger==null)
            {
                _logger = new Logger();
            }

            return _logger;
        }

        public void Log()
        {

        }

    }

    public interface ILogger
    {
         void Log();
    }
} 
```

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2009-02-06T09:36:26.107

好吧，单例只是一个被实例化的普通类，但只从客户端代码间接地实例化一次。静态类未实例化。据我所知静态方法（静态类必须有静态方法）比非静态更快。

编辑：
FxCop 性能规则描述：“不访问实例数据或调用实例方法的方法可以标记为静态（在 VB 中共享）。这样做之后，编译器将向这些成员发出非虚拟调用站点，这将阻止在运行时检查确保当前对象指针不为空的每个调用。这可以为性能敏感代码带来可衡量的性能提升。在某些情况下，无法访问当前对象实例表示正确性问题。
我实际上不知道这是否也适用于静态类中的静态方法。

* * *

## 回答 #15

> 赞同：12
> 
> 时间：2009-02-06T08:15:59.280

单例是实例化的，只是只有一个实例被实例化，因此*单*例中的单例。

静态类不能被它自己以外的任何东西实例化。

* * *

## 回答 #16

> 赞同：12
> 
> 时间：2018-04-28T16:12:57.000

主要区别在于：

*   单例有一个实例/对象，而静态类是一堆静态方法
*   单例可以通过接口进行扩展，而静态类则不能。
*   Singleton可以被继承，它支持SOLID原则中的开/关原则，另一方面静态类不能被继承，我们需要自己进行更改。
*   单例对象可以传递给方法，而静态类因为它没有实例，所以不能作为参数传递

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2020-01-27T10:09:25.273

## 与静态类的区别

JDK有单例和静态的例子，一方面`java.lang.Math`是带有静态方法的final类，另一方面`java.lang.Runtime`是单例类。

**单例的优点**

*   如果您需要维护状态而不是单例模式比静态类更好的选择，因为在静态类中维护状态会导致错误，尤其是在并发环境中，这可能会导致竞争条件，而没有足够的同步并行修改多个线程。

*   如果单例类是重对象，则可以延迟加载，但静态类没有这样的优势，并且总是急切地加载。

*   使用单例，您可以使用继承和多态来扩展基类、实现接口并提供不同的实现。

*   由于 Java 中的静态方法不能被覆盖，它们会导致不灵活。另一方面，您可以通过扩展来覆盖单例类中定义的方法。

**静态类的缺点**

*   为单例编写单元测试比静态类更容易，因为您可以在需要单例时传递模拟对象。

**静态类的优点**

*   静态类提供比单例更好的性能，因为静态方法是在编译时绑定的。

### 单例模式有多种实现方式，各有优缺点。

*   急切加载单例
*   双重检查锁定单例
*   按需初始化持有者成语
*   基于枚举的单例

每一个的详细描述都太冗长了，所以我只是放了一篇好文章的链接——[关于 Singleton 你想知道的一切](http://poltora.info/blog/all-you-want-to-know-about-singleton/)

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2014-04-13T12:55:41.357

从测试的角度来看，单例是更好的方法。与静态类不同，单例可以实现接口，您可以使用模拟实例并注入它们。

在下面的示例中，我将说明这一点。假设您有一个 isGoodPrice() 方法，它使用方法 getPrice() 并且您将 getPrice() 实现为单例中的方法。

提供 getPrice 功能的单例：

```
public class SupportedVersionSingelton {

    private static ICalculator instance = null;

    private SupportedVersionSingelton(){

    }

    public static ICalculator getInstance(){
        if(instance == null){
            instance = new SupportedVersionSingelton();
        }

        return instance;
    }

    @Override
    public int getPrice() {
        // calculate price logic here
        return 0;
    }
} 
```

使用 getPrice：

```
public class Advisor {

    public boolean isGoodDeal(){

        boolean isGoodDeal = false;
        ICalculator supportedVersion = SupportedVersionSingelton.getInstance();
        int price = supportedVersion.getPrice();

        // logic to determine if price is a good deal.
        if(price < 5){
            isGoodDeal = true;
        }

        return isGoodDeal;
    }
}

In case you would like to test the method isGoodPrice , with mocking the getPrice() method you could do it by:
Make your singleton implement an interface and inject it. 

  public interface ICalculator {
        int getPrice();
    } 
```

最终单例实现：

```
public class SupportedVersionSingelton implements ICalculator {

    private static ICalculator instance = null;

    private SupportedVersionSingelton(){

    }

    public static ICalculator getInstance(){
        if(instance == null){
            instance = new SupportedVersionSingelton();
        }

        return instance;
    }

    @Override
    public int getPrice() {
        return 0;
    }

    // for testing purpose
    public static void setInstance(ICalculator mockObject){
        if(instance != null ){
instance = mockObject;
    } 
```

测试类：

```
public class TestCalculation {

    class SupportedVersionDouble implements ICalculator{
        @Override
        public int getPrice() { 
            return 1;
        }   
    }
    @Before
    public void setUp() throws Exception {
        ICalculator supportedVersionDouble = new SupportedVersionDouble();
        SupportedVersionSingelton.setInstance(supportedVersionDouble);

    }

    @Test
    public void test() {
          Advisor advidor = new Advisor();
          boolean isGoodDeal = advidor.isGoodDeal();
          Assert.assertEquals(isGoodDeal, true);

    }

} 
```

如果我们采用静态方法来实现 getPrice() 的替代方案，则很难模拟 getPrice()。您可以使用 power mock 来模拟静态，但并非所有产品都可以使用它。

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2016-02-11T15:08:00.810

我同意这个定义：

> “**单一**”一词是指整个应用程序生命周期中的单个对象，因此范围是应用程序级别。
> 
> **静态**没有任何对象指针，因此范围在应用程序域级别。
> 
> 此外，两者都应该实现为线程安全的。

您可以找到其他有趣的差异：[单例模式与静态类](http://net-informations.com/faq/netfaq/singlestatic.htm)

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2012-06-27T14:03:25.470

一个显着的区别是 Singleton 附带的不同实例化。

对于静态类，它由 CLR 创建，我们无法控制它。使用单例，对象在第一个尝试访问的实例上被实例化。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2012-05-08T16:34:31.567

1.  延迟加载
2.  支持接口，以便提供单独的实现
3.  能够返回派生类型（作为延迟加载和接口实现的组合）

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2012-06-07T01:07:22.180

在许多情况下，这两者没有实际区别，特别是如果单例实例从不更改或更改非常缓慢，例如保持配置。

我想说最大的区别是单例仍然是普通的 Java Bean，而不是专门的仅静态 Java 类。正因为如此，单例在更多情况下被接受；它实际上是默认 Spring Framework 的实例化策略。消费者可能知道也可能不知道它是一个被传递的单例，它只是把它当作一个普通的 Java bean。如果需求发生变化，而单例需要变成原型，就像我们在 Spring 中经常看到的那样，它可以完全无缝地完成，而无需对消费者进行一行代码更改。

前面有人提到静态类应该是纯过程的，例如 java.lang.Math。在我看来，这样的类永远不应该被传递，它们不应该持有静态 final 作为属性以外的任何东西。对于其他一切，请使用单例，因为它更灵活且更易于维护。

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2012-06-27T09:58:38.100

我们有我们的数据库框架，可以连接到后端。为了避免跨多个用户的脏读，我们使用单例模式来确保我们在任何时间点都有可用的单个实例。

在 C# 中，静态类不能实现接口。当单个实例类需要为业务合同或 IoC 目的实现接口时，这就是我使用单例模式而不使用静态类的地方

Singleton 提供了一种在无状态场景中维护状态的方法

希望对你有帮助。。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2013-11-13T10:56:37.717

在我写的一篇文章中，我描述了我对为什么单例比静态类好得多的观点：

1.  静态类实际上不是规范类——它是一个包含函数和变量的命名空间
2.  由于违反了面向对象的编程原则，使用静态类不是一个好习惯
3.  静态类不能作为参数传递给其他类
4.  静态类不适合“懒惰”初始化
5.  静态类的初始化和使用总是很难跟踪
6.  实现线程管理很困难

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2020-05-12T12:23:25.383

*   单例类在应用程序生命周期中提供一个对象（只有一个实例），例如`java.lang.Runtime`

    而静态类只提供静态方法如`java.lang.Math`

*   Java 中的静态方法不能被覆盖，但是 Singleton 类中定义的方法可以通过扩展来覆盖。

*   单例类能够继承和多态来扩展基类，实现接口并能够提供不同的实现。而静态不是。

例如：`java.lang.Runtime`, 是 Java 中的 Singleton 类，调用`getRuntime()`方法返回与当前 Java 应用程序关联的运行时对象，但确保每个 JVM 仅一个实例。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2014-01-14T17:46:10.343

一种。序列化 - 静态成员属于该类，因此不能被序列化。

湾。尽管我们已经将构造函数设为私有，静态成员变量仍然会被携带到子类中。

C。我们不能进行延迟初始化，因为所有内容都只会在类加载时加载。

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2014-08-04T06:23:08.107

从客户端的角度来看，静态行为对客户端是已知的，但单例行为可以对客户端隐藏。客户可能永远不会知道只有一个实例，他一次又一次地玩弄。

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2015-12-30T21:05:30.237

我阅读了以下内容，并认为这也很有意义：

> **照顾生意**
> 
> 请记住，最重要的 OO 规则之一是对象对自己负责。这意味着关于类生命周期的问题应该在类中处理，而不是委托给静态等语言结构。

来自《面向对象的思维过程》第 4 版一书。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2016-10-18T18:58:58.063

1.  我们可以创建单例类的对象并将其传递给方法。

2.  单例类没有任何继承限制。

3.  我们不能处理静态类的对象，但可以单例类。

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2018-06-09T01:12:56.790

Java 中的**静态类**只有静态方法。它是功能的容器。它是基于过程编程设计创建的。

**单例类**是面向对象设计中的一种模式。Singleton 类在 JVM 中只有一个对象实例。这种模式以这样一种方式实现，即在 JVM 中始终只存在该类的一个实例。

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2014-03-31T13:33:47.667

**单个静态类**实例（即一个类的单个实例，恰好是静态或全局变量）和指向堆上类实例的**单个静态指针**之间存在巨大差异：

当您的应用程序退出时，将调用静态类实例的析构函数。这意味着如果您将该静态实例用作单例，您的单例将停止正常工作。如果仍有使用该单例的代码在运行，例如在不同的线程中，则该代码可能会崩溃。

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2017-09-08T09:47:06.657

我脑子里的区别是实现面向对象的编程（单例/原型）或函数式编程（静态）。

我们过于关注单例模式创建的对象的数量，而我们应该关注的是最终我们持有一个对象。就像其他人已经说过的那样，它可以扩展，作为参数传递，但最重要的是它是状态完整的。

另一方面，静态用于实现函数式编程。静态成员属于一个类。他们是无国籍的。

顺便说一句，您知道您可以创建单例静态类 :)

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2012-05-27T22:42:38.447

当我想要具有完整功能的类时，例如有很多方法和变量，我使用单例；

如果我想要一个只有一个或两个方法的类，例如 MailService 类，它只有一个方法 SendMail() 我使用静态类和方法。

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2017-07-07T16:22:52.693

据我了解静态类和非静态单例类之间的区别，静态只是 C# 中的非实例化“类型”，其中单例是真正的“对象”。换句话说，静态类中的所有静态成员都分配给该类型，但在 Singleton 中却位于对象之下。但请记住，静态类的行为仍然像引用类型，因为它不是像 Struct 这样的值类型。

这意味着当你创建一个单例时，因为类本身不是静态的，但它的成员是，优点是单例中引用自身的静态成员连接到实际的“对象”而不是自身的空心“类型”。现在，除了其他功能和内存使用情况之外，这种方式澄清了静态和非静态单例之间的区别，这让我感到困惑。

两者都使用作为成员的单个副本的静态成员，但 Singleton 将引用的成员包装在一个真正的实例化“对象”周围，该对象的地址除了其静态成员之外还存在。该对象本身具有可以传递和引用的属性，从而增加了价值。Static 类只是一种类型，因此除了指向其静态成员之外它不存在。这个概念在某种程度上巩固了单例与静态类的目的，超越了继承和其他问题。

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2020-01-27T23:41:02.850

单例只不过是类上的一次写入静态变量，一旦初始化，它总是引用自身的同一个实例。

因此，您不能“使用单例代替静态变量”，也不能通过使用单例来避免将状态保留在静态变量中。

*单例的优点仅在于：即使其他代码尝试重新初始化它一千次，*它也不会重新初始化。这对于像网络处理程序这样的东西来说非常棒，你知道，如果在等待响应的过程中一个实例被另一个实例替换，它会很糟糕。

除非你想要一个在任何地方都没有实例的整个应用程序——全是静态的！——那么单例对于这些我们不能依赖缺乏人为错误作为唯一保证不会被覆盖的情况是有意义的。

但请注意，单身并不能保证在任何地方都生活在国家之中。您的网络处理程序本身也可能依赖于其他单例等。现在我们有状态生活在许多单例中......太棒了。

并且没有编译器可以确保在编译时单例是所有状态或任何其他此类想法所在的位置。您可以在具有单例的类上拥有一百个静态变量。并且单例可以访问静态变量。而且编译器不会在意。

所以我会提醒任何人不要假设使用单例可以保证任何关于状态所在的位置。**它唯一的保证就是它永远是它的类的唯一实例。而这也是它唯一的优势。**

其他答案声称的单例的任何其他优势都是编译器无法保证的，并且可能因语言而异。依赖注入是一种可能依赖单例的补充模式，尽管它可能是也可能不是给定语言中的最佳解决方案或唯一解决方案。在缺乏泛型的语言中，或者对调用静态访问器和函数施加任意限制的语言中，诉诸单例模式确实可能是解决给定问题的最佳可用解决方案。

在 Swift 之类的语言中，Singleton 根本不需要获得依赖注入、可测试的代码、良好管理的状态、线程安全的访问器、多态性等。但是它对于保证单个实例仍然有用。

回顾一下：**单例只不过是一个静态变量，它可以防止存在给定类的多个实例，以及防止单个实例被新实例覆盖。**就是这样，句号，句号。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2019-06-03T21:01:32.857

带有静态类的示例

```
public class Any {

    private static Any instance = new Any();

    private Singleton() {
        System.out.println("creating");
    }
} 
```

单例模式只存在一个实例：

```
public class Singleton {

    private static Singleton instance = new Singleton();

    private Singleton() {
        System.out.println("creating");
        if (instance != null) {
            throw new RuntimeException("Imposible create a new instance ");
        }
    }
} 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2021-02-05T16:02:18.277

静态类通常用于库，如果我只需要特定类的一个实例，则使用单例。从内存的角度来看，虽然存在一些差异：通常在堆中只分配对象，分配的唯一方法是当前正在运行的方法。静态类也具有所有静态方法，并且从一开始就在堆中，因此通常静态类会消耗更多内存。

* * *

## 回答 #38

> 赞同：-1
> 
> 时间：2013-05-24T23:58:47.920

单例的一个主要优点：多态例如：使用类工厂创建实例（基于某些配置），我们希望这个对象是真正的单例。

* * *

## 回答 #39

> 赞同：-2
> 
> 时间：2016-05-09T11:31:54.540

> 两者都可以在没有实例化的情况下调用，都只提供一个“实例”，而且它们都不是线程安全的。还有其他区别吗？

这个问题是错误的，它的两个陈述。请注意：这里的静态类是指嵌套的静态类而不是只有静态方法的类。

*我假设（即静态类意味着嵌套的静态类，而不是只有静态成员的类），因为如果我看到最流行的单例实现，即 DCL 方式，它只不过是实例的静态声明和获取单例实例的静态方法。它的一种实现。所以在这种情况下，单例和只有静态成员的类有什么区别。尽管使用 Enum 可以实现其他实现。*

让我更正以下陈述：

1.  单例类可以在应用程序范围内具有单实例。嵌套的静态类可以有多个实例（参见下面的代码作为证明）。[在此处](https://docs.oracle.com/javase/tutorial/java/javaOO/nested.html)阅读嵌套类的基础知识。

2.  没有一个类本质上是线程安全的，它必须以编程方式使其成为线程安全的。它可以用于嵌套静态类和单例。

下面还有一些神话破坏者（这个问题的大多数答案都给出了这些陈述，因此认为以编程方式证明它会很好）：

1.  嵌套的静态类可以像任何其他类一样实现接口。
2.  嵌套的静态类可以扩展其他非最终类。
3.  嵌套的静态类可以有实例变量。
4.  嵌套的静态类可以有参数化的构造函数。

在下面的代码中，您可以看到嵌套静态类**NestedStaticClass**实现了接口，扩展了另一个类，具有实例变量和参数化构造函数。

```
 package com.demo.core;

    public class NestedStaticClassTest
    {
        public static void main(String[] args)
        {
            OuterClass.NestedStaticClass obj1 = new OuterClass.NestedStaticClass();
            OuterClass.NestedStaticClass obj2 = new OuterClass.NestedStaticClass();

            if(obj1 == obj2)
            {
                System.out.println("Both nested static objects are equal....");
            }
            else
            {
                System.out.println("NOT EQUAL......");
            }

            System.out.println(OuterClass.NestedStaticClass.d);

            obj1.setD(5);

            System.out.println(OuterClass.NestedStaticClass.d);

            System.out.println(obj1.sum());
        }
    }

    class OuterClass
    {
        int a =1;
        static int b = 2;

        static class NestedStaticClass extends OneClass implements Sample
        {
            int c = 3;
            static int d = 4;

            public NestedStaticClass()
            {
            }

            //Parameterized constructor
            public NestedStaticClass(int z)
            {
                c = z;
            }

            public int sum()
            {
                int sum = 0;
                sum = b + c + d + getE();
                return sum;
            }

            public static int staticSum()
            {
                int sum = 0;
                sum = b + d;
                return sum;
            }

            public int getC()
            {
                return c;
            }
            public void setC(int c)
            {
                this.c = c;
            }
            public static int getD()
            {
                return d;
            }
            public static void setD(int d)
            {
                NestedStaticClass.d = d;
            }
        }
    }

    interface Sample
    {

    }

    class OneClass
    {
        int e = 10;
        static int f = 11;

        public int getE()
        {
            return e;
        }
        public void setE(int e)
        {
            this.e = e;
        }
        public static int getF()
        {
            return f;
        }
        public static void setF(int f)
        {
            OneClass.f = f;
        }

    } 
```

* * *

## 回答 #40

> 赞同：-2
> 
> 时间：2016-08-16T20:31:03.447

我将尝试超越 WTMI 和 WTL;DR 响应。

*单例是对象的一个​​实例......句号*

您的问题从根本上是在询问一个类与该类的实例之间的区别。我认为这很清楚，不需要详细说明。

单例类一般会采取措施保证一个实例的构造；这很聪明，但不是必需的。

示例： var connection = Connection.Instance;

假设这是 Connection 类：

```
public sealed class Connection 
{
    static readonly Connection _instance = new Connection();

    private Connection() 
    {
    }

    public static Connection Instance
    {
        get
        {
           return _instance;
        }
    } 
} 
```

请注意，您可以在该类上抛出一个接口并对其进行模拟以用于测试目的，而静态类无法轻松做到这一点。

# c# - C# 强制 ListBox 更新元素

> ID：519538
> 
> 赞同：6
> 
> 时间：2009-02-06T08:22:33.603
> 
> 标签：c#, user-controls, listbox

我正在继承标准 ListBox 控件。我会收到有关添加到列表中的任何元素的更改的通知。任务是更新 ListBox 为变化的元素显示的文本。

我知道我可以删除更改的元素并再次添加它，但由于明显的原因，这似乎并不可取。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-06T08:31:16.050

不幸的是，数据绑定`ListView`不支持常规（项目）更改通知事件（`FooChanged`/ `INotifyPropertyChanged`）。但是，如果您知道更改，您可以让列表重新绑定自身。由于您是子类化，您可以调用：

```
this.RefreshItems(); 
```

或单个项目：

```
this.RefreshItem(index); 
```

否则，由于这不是公开的，您可以通过更改来模拟它`DisplayMember`：

```
lb.DisplayMember = "";
lb.DisplayMember = "Bar"; 
```

也许有点 hacky，但它可以工作，并保持当前的选择等（不像清除`DataSource`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T08:26:30.647

为什么不手动更新相关项目的文本？您也可以考虑为 ListBox 推出自己的数据绑定机制。并检查[ObjectListView](http://objectlistview.sourceforge.net/html/index.htm)看看它是否有帮助。

# jboss - 到 localhost:10.0 的 X 连接断开（显式终止或服务器关闭）

> ID：519540
> 
> 赞同：2
> 
> 时间：2009-02-06T08:23:19.310
> 
> 标签：jboss

为什么会出现这个错误。我启动了 jboss 服务器，当我尝试在 IE 中打开应用程序时出现此错误

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-20T08:24:10.913

我刚刚遇到了这个确切的问题，因为我连接到我的 linux jboss 服务器并激活了 putty 和 X 转发。在腻子中，我取消选中“连接 > SSH > X11 > 启用 X11 转发”选​​项，现在它可以工作了。希望这会对某人有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-15T14:43:51.070

我不得不从腻子会话中删除 X11 转发（JDK 1.7，Tomcat 8）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-10T01:47:06.890

我也有这个问题。好像已经举报给jboss了： [https ://jira.jboss.org/jira/browse/EMBJOPR-65](https://jira.jboss.org/jira/browse/EMBJOPR-65)

当我连接 X11 转发并尝试在 X11 转发连接打开的情况下访问管理控制台时，我一直遇到这个问题。如果我退出用户的 shell 会话，那么当我访问管理控制台时它不会杀死 jboss。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-10T02:28:08.430

另一份相关报道：http: [//community.jboss.org/message/202074#202074](http://community.jboss.org/message/202074#202074)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T08:45:50.700

好像您的 wine 配置不正确，并且无法连接到 X 服务器。

如果您不使用 Linux 或 X 服务器，请忽略此答案。

# asp.net - ASP.Net 2 中上传的文件去哪里了？

> ID：519542
> 
> 赞同：9
> 
> 时间：2009-02-06T08:23:54.897
> 
> 标签：asp.net, iis, file-upload, antivirus

我正在构建一个允许用户上传文件的门户。我需要确保这些文件不包含病毒。我理想的解决方案是让主机 OS AV 监视临时文件夹并扫描任何传入的文件。

在 ASP.Net 2 中上传文件时，它是写入临时文件夹中的磁盘，还是保留在内存中？如果写入磁盘，IIS 会锁定它以使 AV 无法删除它吗？如果它被写入磁盘，在哪里？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T17:07:26.557

这是 ASP.NET 如何处理文件的实际问题。它取决于版本，但 2.0 和所有后续版本都会在您有机会处理它们之前将上传内容写入磁盘。上面的答案实际上是错误的——2.0 以上的 ASP.NET*会将*文件写入磁盘。如果您考虑一下，将上传文件加载到内存中会给您带来 DDOS 漏洞，因为大文件会占用越来越多的服务器内存。按版本，这是 ASP.NET 的行为方式：

*   ASP.NET 1.0 和 1.1 将整个请求加载到内存中，然后您才能访问它。这意味着大文件可能会填满所有内存，导致异常并以其他方式关闭服务器。

*   ASP.NET 2.0 引入了一种用于上传的磁盘缓存方案，在客户端代码可以处理之前再次捕获并处理它。可以按如下方式访问临时文件夹：

    string uploadFolder = Path.Combine(HttpRuntime.CodegenDirInternal, "uploads");

*   从 ASP.NET 4.0 开始，上面引用的属性名称是 HttpRuntime.CodegenDir：

    string uploadFolder = Path.Combine(HttpRuntime.CodegenDir, "uploads");

至少现在它已缓存到磁盘，因此您不会遇到 1.0 和 1.1 的内存问题，但在完全检索之前您仍然无法访问它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-06T10:26:53.883

我认为理想的方法是拥有一个“传入”文件夹，该文件夹已被授予 ASP.NET 保存文件的必要权限。我从未遇到过即使在调用`SaveAs`FileUpload 控件后文件仍处于锁定状态的情况。

请注意，FileUpload 控件在您调用之前不会上传文件`SaveAs`，这是文件被持久保存到服务器上的磁盘的时间。它似乎将所有文件内容保存在一个中，在调用该方法`HttpInputStream`时将其写入磁盘。`SaveAs`

然后，您的 AV 应用程序应该可以自由扫描文件。如果出现错误，您可以向用户提供相关反馈。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T09:14:09.927

您使用的是 ASP FileUpload 服务器控件吗？

如果是这样，它将被加载到服务器内存中，直到您对其进行处理。

这是来自 MSDN；

> 保存上传文件的位置没有固有限制。但是，要保存文件，ASP.NET 进程必须有权在您指定的位置创建文件。此外，您的应用程序可能配置为需要绝对路径（而不是相对路径）来保存文件，这是一种安全措施。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T03:32:37.370

如果您对安全性很认真，另一个相关提示是确保您保存文件的文件夹位于 webroot 之上，这样用户就不能以任何方式直接访问它。您仍然可以让他们通过一些数据库工作删除他们上传的文件，即保存位置并确保每个文件都是唯一命名的（如果用户正在验证，我只需将文件名保存为 USERNAME.XYZ 其中 XYZ 是文件的扩展名.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-20T22:43:45.750

对于您的场景...我通常对任何上传/临时位置都有一个应用程序设置，默认设置在 ~/App_Data/Uploads/ 下，直到字节被持久保存到磁盘之前它对 AV 不可见。如果您真的想要主动扫描，那么您可能希望有一个多阶段队列......（另外，您将希望在 ASP.Net 中执行异步请求），如果您等待任何扫描完成。

*   您将项目推入队列以检查 30 秒（足够 AV 扫描仪的时间）
*   您将文件保存到上传目录（已检查）
*   您对队列进行了另一次服务检查，如果在 30 秒内仍然存在，则将其标记为完成/已处理
*   您的 UI 将每 10 秒检查一次队列以查看它是否已完成，然后将其呈现给用户。

我会考虑使用您的本机扫描程序将您的上传路径列入白名单，并查看是否有公开的 API 可根据请求运行手动扫描。另一种方法是使用 ClamAV/ClamWin 设置作为服务扫描程序，您可以每小时在其上运行更新（我已经为邮件系统完成了此操作），并且文件签名往往相当不错，即使在存档文件中也是如此（如果配置正确）。

此外，您可能希望使用 7z.exe（7-zip 命令行）来提取任何档案。7-zip 几乎可以提取我见过的所有档案类型，尽管它只支持新档案的几个压缩目标。

希望这会有所帮助，因为我打算将此作为评论附加到另一篇文章中，但它变得冗长。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-07T01:55:10.733

就像 Cerebrus 一样，我会告诉您 UploadFile 控件不会**向**磁盘驱动器写入任何内容，除非您告诉它这样做。

# visual-studio-2008 - 使用 GDI+ 位图

> ID：519543
> 
> 赞同：3
> 
> 时间：2009-02-06T08:23:55.207
> 
> 标签：visual-studio-2008, visual-c++, gdi+

我正在使用 GDI+ Bitmap 类将 IStream 转换为 HBITMAP。我在链接器输入中包含了 gliplus lib 文件，并且在构建路径中也包含了 dll。但是使用语句

```
Bitmap bm(lpStream,FALSE); 
```

给我一个错误**C2065: 'Bitmap' : undeclared identifier**

有人可以告诉我我在这里做错了什么。

谢谢。

*编辑*
我已经在我的实现中包含了适当的标题（gdiplus.h），我可以通过在上下文菜单中选择“转到定义”选项来查看位图的定义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T19:23:03.213

除了命名空间问题之外，使用 Gdiplus 还需要在使用之前对库进行初始化：

```
ULONG_PTR gdiplusToken;
GdiplusStartupInput startupInput;
GdiplusStartup(&gdiplusToken, &startupInput, 0); 
```

你需要持有令牌直到你使用完 Gdiplus，然后释放它：

```
GdiplusShutdown(gdiplusToken); 
```

如果库未初始化，Gdiplus 操作将失败并出现错误 GdiplusNotInitialized。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T08:27:29.443

您还需要包含相关的头文件。猜测一下，它的名称可能类似于“Bitmap.h”或“gdi+.h”。

[这里有一些关于Bitmap 类](http://msdn.microsoft.com/en-us/library/ms536314(VS.85).aspx)的更多细节。正确的头文件是“gdiplus.h”。简而言之：

```
#include "gdiplus.h"

Constructor Information 
```

> ```
> Stock Implementation  gdiplus.dll
> Header    Declared in Gdiplusheaders.h, include gdiplus.h
> Import library    gdiplus.lib
> Minimum availability  GDI+ 1.0
> Minimum operating systems  Windows 98/Me, Windows XP, Windows 2000, 
> ```
> 
> 视窗 NT 4.0 SP6

在 MSDN 的表中，它显示“Header”，它告诉您需要包含的头文件的名称。您已经介绍过的“导入库”。如果你错过了，你会得到一个链接错误。

编辑： [在这篇关于 GDI+ 入门的文章中](http://msdn.microsoft.com/en-us/library/ms533895(VS.85).aspx)，您需要指定一个命名空间“Gdiplus”。要么使用“使用命名空间 Gdiplus”，要么明确指定命名空间。

```
#include <windows.h>
#include <gdiplus.h>
using namespace Gdiplus;

VOID OnPaint(HDC hdc)
{
   Graphics graphics(hdc);
   Pen      pen(Color(255, 0, 0, 255));
   graphics.DrawLine(&pen, 0, 0, 200, 100);
} 
```

# c++ - 如何强制父窗口在子窗口“下”绘制？

> ID：519558
> 
> 赞同：2
> 
> 时间：2009-02-06T08:31:20.963
> 
> 标签：c++, c, user-interface, winapi, windows-mobile

环境是 C/C++ 下的普通 win32，没有任何花哨的 MFC 或类似的 mumbo-jumbo。我有一扇窗户，里面有几个孩子和孙子。有些孩子是奇形怪状的图标，我需要它们有透明的背景（奇形怪状的图标）。考虑一个这个伪结构：

*   家长1
    *   儿童1（正常）
    *   Child2（形状奇特的图标）
    *   Child3（正常）/Parent2
        *   孙子1（正常）
        *   Grandchild2（形状奇特的图标）

上面，Child2 和 Grandchild2 应该有透明背景（WM_ERASEBKGND 什么都不做，或者 (WNDCLASS)->hbrBackground = NULL）。现在这些图标的背景是透明的，但透明到极端——我在 Parent1 下看到了东西——桌面等。

这一切都发生在 Windows Mobile 下。

我必须为 Parent1 和 Parent2 设置任何额外的标志吗？你能提供什么好技巧吗？

如果没有人遇到类似的问题，我会感到惊讶，因为现在许多应用程序必须显示各种形状和大小的图标。

编辑：形状奇特的窗口是带有透明胶片的图标。如果父窗口不对这些特定窗口进行剪辑，但每次父窗口自己绘制时使它们无效，那就太好了。CS_PARENTDC 看起来很有希望，但还不够有希望。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T08:38:56.957

在形状奇特的窗口中，您如何处理 WM_PAINT？你是在抹掉背景吗？也许更好的解决方案是使用非矩形剪辑区域？

编辑 [SetWindowRgn 记录在这里](http://msdn.microsoft.com/en-us/library/aa930600.aspx)- 我说“剪辑区域”是不正确的，我真的在考虑这种方法。您设置了一个不规则区域，该区域是您的图标的形状，然后绘制到该区域。我认为这可能是绘制形状奇特的窗户的常用技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T09:02:13.790

如果您尝试使用 SetBkColor() 不能在 WM_PAIN 处理中为窗口指定颜色，那么它的大小是否不规则也没关系。我是否正确地回答了您的问题？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T08:42:09.137

GWES 不会使用父窗口的内容绘制任何子窗口的矩形。曾经。时期。这是设计使然。

You can either paint in the child rectangle in response to `WM_CTL...` in the parent, or subclass the child and override its `WM_PAINT` completely. That will be really tough for certain windows, such as edit controls, but it's mostly doable.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-25T17:04:26.790

I stumbled over this entry while looking for ways to force Windows CE to remove the clipping of child windows from the update region. It seems its simply not possible. As Johann Gerell mentioned GWES will always clip children. This of course makes it impossible to have transparent static fields, ever! I have tried everying. Setting a custom, non-clipped rectangular region during WM_ERASEBKGND but GWES keeps its old clipping region. I have a bunch of static controls placed over a bitmap (that is painted during WM_ERASEBKGND). Is this even possible on Windows CE?

# sql-server - Reporting Services 2008：是否可以根据报表的呈现方式更改项目属性？

> ID：519565
> 
> 赞同：3
> 
> 时间：2009-02-06T08:34:53.750
> 
> 标签：sql-server, reporting-services, reporting, export-to-word

我正在写一份报告，它可以很好地导出为 PDF。但是，它不能正确导出到 Word 文档 (.doc)。

（页眉区域中的边距被忽略，这会弄乱分页符、缺少页脚文本等）

为了解决这个问题，我想禁用、启用和/或调整我的报告中的一些项目，具体取决于它是呈现为 PDF 还是 Word 文档。

有没有办法根据报告的呈现方式设置项目属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T08:54:39.327

我认为解决您的问题的唯一方法是：在您的报告中，您可以访问 Globals.ReportServerUrl。调用报表时，您可以在 URL 中指定其呈现类型（甚至其他内容，如尺寸等）。您需要做的就是编写一些自定义代码以从 URL 中提取呈现类型，然后您就完成了。

有关所有可能的 URL 参数的更多信息，请访问此处：[http ://technet.microsoft.com/en-us/library/ms154040.aspx](http://technet.microsoft.com/en-us/library/ms154040.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-22T22:07:35.177

我有一个类似的场景，我需要在 asp.net 应用程序中使用报表查看器控件。我想出的解决方案是将工具栏隐藏在报表查看器控件中，并为各种格式（PDF、Excel 是我们目前使用的两种格式）创建自己的下拉选择器。

解决方法是，在加载报表查看器控件时，我将一个附加参数传递给我的报表，指示“RenderType=HTML”。当请求获取 PDF 版本时，我使用相同的方法，除了我使用 ServerReport.Render() 函数并将“PDF 作为 RenderType 参数传递，与 Excel 相同。

这允许我在我的报告中针对各种报告格式进行条件格式化/显示/隐藏内容。

因为报表查看器 Web 控件支持从后面的代码呈现特定页面/缩放等功能，所以很容易构建我们自己的“工具栏”来操作报表，并为我们提供了更适合我们应用程序的样式的优势，（虽然这无论如何都可以用css来完成）。它解决的另一个问题是需要活动 x 组件的奇怪打印功能，我们实现了自己的打印机制以打印机友好的方式写出报告。

希望这可以帮助。

# ruby - 返回 Ruby 正则表达式的第一个匹配项

> ID：519572
> 
> 赞同：108
> 
> 时间：2009-02-06T08:42:21.363
> 
> 标签：ruby, regex, string

我正在寻找一种在 Ruby 中对字符串执行正则表达式匹配并使其在第一次匹配时短路的方法。

我正在处理的字符串很长，看起来标准方式（`match`方法）会处理整个事情，收集每个匹配项，并返回一个包含所有匹配项的 MatchData 对象。

```
match = string.match(/regex/)[0].to_s 
```

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2009-02-06T08:53:30.203

您可以尝试[`String#[]`](https://ruby-doc.org/core-3.0.0/String.html#method-i-5B-5D)（如 中`variableName[/regular expression/]`）。

这是 IRB 的示例输出：

```
names = "erik kalle johan anders erik kalle johan anders"
# => "erik kalle johan anders erik kalle johan anders"
names[/kalle/]
# => "kalle" 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2014-04-22T15:19:20.533

您可以使用`[]`：（就像`match`）

```
"foo+account2@gmail.com"[/\+([^@]+)/, 1] # matches capture group 1, i.e. what is inside ()
# => "account2"
"foo+account2@gmail.com"[/\+([^@]+)/]    # matches capture group 0, i.e. the whole match
# => "+account2" 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-02-06T08:59:32.077

如果只有匹配的存在很重要，您可以选择

```
/regexp/ =~ "string" 
```

无论哪种方式，`match`都应该只返回第一个命中，同时`scan`搜索整个字符串。因此，如果

```
matchData = "string string".match(/string/)
matchData[0]    # => "string"
matchData[1]    # => nil - it's the first capture group not a second match 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2015-10-02T13:00:53.720

我还不确定这个功能是真棒还是完全疯狂，但你的正则表达式可以定义局部变量。

```
/\$(?<dollars>\d+)\.(?<cents>\d+)/ =~ "$3.67" #=> 0
dollars #=> "3" 
```

（取自[http://ruby-doc.org/core-2.1.1/Regexp.html](http://ruby-doc.org/core-2.1.1/Regexp.html)）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-08-27T11:32:38.680

正则表达式 (regex) 只不过是一个有限状态机 (FSM)。

FSM 试图回答“这种状态是否可能？”的问题。

它一直尝试进行模式匹配，直到找到匹配项（成功），或者直到探索了所有路径但没有找到匹配项（失败）。

关于成功，问题是“这种状态是否可能？” 已回答“是”。因此不需要进一步的匹配并且正则表达式返回。

有关此的更多信息，请参阅[此](http://www.proofwiki.org/wiki/Regular_Expressions_and_Finite_State_Machines)和[此](https://stackoverflow.com/a/525043/1243123)。

进一步：[这是一个有趣的例子](http://www.noulakaz.net/weblog/2007/03/18/a-regular-expression-to-check-for-prime-numbers/)来演示正则表达式是如何工作的。在这里，正则表达式用于检测给定数字是否为素数。这个例子是用 perl 编写的，但也可以用 ruby​​ 编写。

# vb6 - 中（）与中 $（）

> ID：519579
> 
> 赞同：13
> 
> 时间：2009-02-06T08:46:44.787
> 
> 标签：vb6

根据 VB6 中的文档，Mid() 函数返回一个变体，但 Mid$() 返回一个字符串，显然这更有效。

我的问题是：

1.  *我可以使用什么简单的测试来辨别性能差异？*[我尝试使用Perfmon](http://technet.microsoft.com/en-us/library/bb490957.aspx)监视一个执行一些字符串操作的简单应用程序，但没有明显区别。

2.  *值得担心吗？*我已经养成了使用 $-ized 函数的习惯，但我是否应该推荐团队中的每个人也使用它？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-06T08:49:44.937

不值得担心。它是 15 到 20 年前 Microsoft Basic 的残余，当时快速处理器的速度比今天的任何东西都慢几个数量级。

不过，使用 Mid$ 而不是让 VB 确定您的数据类型具有一定的审美吸引力。而且，如果您有任何循环正在执行它，例如每秒数千个 tiem，那么您的好奇心因素可能会增加。否则，恩。

[这是](http://www.shamrock-software.eu/vb.htm)衡量差异的人的链接。Mid$ 的速度大约是 Mid 的 2.5 倍。包括回到 VB4 的测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T08:59:36.947

虽然它们之间的性能可以忽略不计，但无论如何它并不是真正的差异化因素。

当需要强类型时，使用变体可能会有一些细微差别。例如，当您将变体传递给期望 ByRef 字符串的参数时会发生什么？没有什么不好的，只是发生了一些比传递地址更多的事情。

因此，如果您知道要使用字符串，那么继续使用这些函数的 $ 版本，它们的行为以及它们在其他表达式中的使用更简单且更好理解。如果你知道你需要一个变体并且你的输入是变体，那么一定要使用非 $ 版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T08:53:45.287

老实说，我认为这是微不足道的。

也许你可以尝试这样的事情。[从http://ccrp.mvps.org/](http://ccrp.mvps.org/)下载“高性能计时器对象” ，对字符串操作进行长循环（1.000.000 次左右），并测量运行时间差异。我所说的“操作”是指：s 的串联`Variant`而不是 s 的串联`String`。`Mid()`并且`Mid$()`很可能会执行相同的操作。OTOH - 你也可以测试*它*。

如果你这样做了，如果你发布结果，我会很感兴趣。

# cocoa-touch - 如何在不重新启动应用程序的情况下立即单击按钮生成新按钮？

> ID：519588
> 
> 赞同：0
> 
> 时间：2009-02-06T08:51:46.227
> 
> 标签：cocoa-touch

当我单击按钮生成器时，我正在尝试生成一个新的按钮项。它能够生成，但只有在我重新启动应用程序后才会显示在屏幕上。但我希望它立即生成并显示在当前视图中。有什么建议么？我知道这与`viewDidLoad`功能有关。无论如何请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T09:21:25.357

假设这是您创建按钮的视图控制器方法：

```
-(void)generateButton:(id)sender {
  UIButton *button = [UIbutton alloc] initWithFrame:CGRectMake(50, 50, 100, 40)];
  [self.view addSubview:button];
  [button release];
} 
```

为了可见，您必须将按钮添加为当前显示视图的子视图。在这种情况下，我将它添加到此视图控制器的主根级别视图中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T04:57:46.840

当您将子视图添加到视图时，它应该立即显示。最有可能的是，您做错了事，导致视图不应该显示。另一件事，视图如何仅在下次发布时显示？听起来你实际上是在以某种方式坚持它们，这可能会增加你正在做的任何事情造成的麻烦。如果这是 IRC，我建议您粘贴一些代码，因为没有这些，几乎无法知道您实际在做什么，这可能会造成很多麻烦。

# protocols - SPDH的词法分析器

> ID：519596
> 
> 赞同：1
> 
> 时间：2009-02-06T08:54:13.070
> 
> 标签：protocols, analyzer

我需要一些帮助来为协议 spdh 编写词法分析器。请你能给我一些想法：我必须从哪里开始编写这种协议的语法？！

Spdh 定义了在电子支付终端和银行服务器之间交换的请求和响应消息的结构。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T09:51:17.980

我从来没有写过编译器。这是我第一次使用这样的程序！我可能会使用 javacc。我不知道我还没有决定的递归下降，因为我仍在阅读编译器理论。那么我必须专注于哪些部分来编写我的分析器？

# objective-c - 是否可以在 Objective-C 中将方法作为参数传递？

> ID：519600
> 
> 赞同：23
> 
> 时间：2009-02-06T08:54:58.560
> 
> 标签：objective-c, method-signature

我有一个通过内部单个方法调用而变化的方法，我想传递它作为参数变化的方法的方法/签名......这在Objective C中是可能的还是希望太大了为了？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-06T09:12:24.050

NSInvocation 是一个用于包装对象中的方法调用的类。您可以设置选择器（方法签名），按索引设置参数。然后，您可以设置一个目标并调用 invoke 来触发调用，或者不设置目标并使用 invokeWithTarget: 在某种循环中对许多对象调用它。

我认为它有点像这样：

```
NSInvocation *inv = [[NSInvocation alloc] init];
[inv setSelector:@selector(foo:bar:)];
[inv setArgument:123 atIndex:0];
[inv setArgument:456 atIndex:1];

for (MyClass *myObj in myObjects) {
  [inv invokeWithTarget:myObj];
} 
```

或者，如果您不想将调用对象传递给此方法，您可以使用 SEL 类型来接受选择器（方法签名）。

```
-(void)fooWithMethod:(SEL)selector; 
```

*然后*将选择器分配给调用对象，以便在对象上调用它。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-08T06:05:02.163

或者，如果您正在使用该`fooWithMethod:(SEL)selector`方法，只要`[myObject performSelector:selector]`它没有其他参数就可以了。

有关详细信息，请参阅[NSObject](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/index.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-09-28T10:21:10.380

如前所述，您可以传递要调用的方法的选择器。使用选择器有不同的方法来实际调用该方法：

1.  使用`NSObject`s 和方法`performSelector:`_`performSelector:withObject:``performSelector:withObject:withObject:`
2.  使用一个`NSInvocation`对象
3.  或直接使用`objc_msgSend`或`objc_msgSend_stret`
4.  使用`IMP`你可以使用的那个方法`methodForSelector:`

使用哪一种取决于具体情况。如果性能不重要，如果您需要传入 0、1 或 2 个对象，我会继续使用 1。如果`performSelector:...`方法不匹配，我会选择 2 或 3。由于设置`NSInvocation`对象需要大量样板代码，我更喜欢 3，但我想这是个人选择的问题，除非存在性能问题。

`IMP`如果这些方法调用的性能确实很重要，我会使用 3 或 4。除非您可以缓存s ，否则 3 应该更快。但根据您的代码，这可能不可行或没有真正帮助。所以在这里你必须分析代码，看看哪一个更适合你。

# html - SHTML的目的和独特之处是什么？

> ID：519619
> 
> 赞同：133
> 
> 时间：2009-02-06T09:04:20.553
> 
> 标签：html, ssi, shtml

最近，当我看到一个带有 .shtml 扩展名的站点时，我开始了解 SHTML。

SHTML 的目的是什么，它与 HTML 和 DHTML 有何不同？

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2009-02-06T09:09:52.400

SHTML 是一个文件扩展名，它让 Web 服务器知道文件应该被处理为使用服务器端包含 (SSI)。

（HTML 是……你知道它是什么，而 DHTML 是微软对 Javascript+HTML+CSS 之类的名称）。

您可以使用 SSI 在页面中包含通用页眉和页脚，因此您不必重复代码。更改一个包含的文件会立即更新您的所有页面。您只需照常将其放入 HTML 页面中。

它嵌入在标准 XML 注释中，如下所示：

```
<!--#include virtual="top.shtml" --> 
```

它已在很大程度上被其他机制所取代，例如 PHP 包含，但一些托管包仍然支持它，仅此而已。

[您可以在此 Wikipedia 文章](http://en.wikipedia.org/wiki/Server_Side_Includes)中阅读更多内容。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-06T09:07:20.457

它只是带有[服务器端包含](http://en.wikipedia.org/wiki/Server_Side_Includes)的 HTML 。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2021-09-07T22:38:34.843

> *“既然是 2021 年，我要回答这个问题，因为最初的答案是从一个生活在 SSI 非常普遍的时代的人的角度来回答这个问题的，但是，它们在当代 Web 开发中几乎已经过时了。”*

###### *“SSI 是首字母缩写词，缩写为：`Server Side Includes`。”*

***“SHTML”***，或者***`(.shtml)`***只不过是一个简单的文件扩展名，用于向开发人员和浏览器表示当前文档是一个***“HTML Doc”***，它实现了***“Server Side Includes”***。

我觉得解释**SSI**的最好方法是将它们与 C-Languages 进行比较（不要与*C-Style Syntax*混淆）。*C-Languages*之所以成为一个很好的参考点，有两个原因：

*   A. 大多数上过计算机科学学校的软件/Web 开发人员至少“有点”熟悉其中一种 C 语言（对我来说曾经是，现在仍然是 C++）。

*   `#include`B. 语法显然源自原始 C 语言，因为它与C 语言中的语句完全相同。

* * *

##### *因此，如果您现在熟悉一门 C 语言，您可能已经对我所描述的内容有了一个很好的了解。*

##### *而且，如果我继续，我会说：*

> “它们是网页的预处理器指令，开发人员实施这些指令以保持代码干燥并保持一致的页眉和页脚，这些指令是通过标准 C 指令语法（例如，、、、、等）`#includes`实现的`#ifdef``#define``#if`

##### *那么您可能确切地知道它们是什么。*

* * *

### 如果您以前没有学习过 C 语言，那么这段摘录适合您：

在 C 语言中，有一些语法语句，用于添加库、类、接口、模板等，它们看起来像这样：

*   `#include`

*   `#define`

*   `#undef`

*   `#ifdef`

*   `#ifndef`

***ETC...***

好吧，*“简而言之”*，相同的语法是通过***“服务器端包含”在网页中实现******的***，或者***`SSI`***

* * *

*   **关键区别：** *在程序中使用 C 指令的地方，在网站中使用 SSI。*

*   **键相似性** *它们都导入程序/网站要使用的代码。*

* * *

###### SSI 如下所示：

```
 <!--
 #include ifheader="reference-page" file="header.html" else="header-alt.html" 
--> 
```

*   SSI 也有`#if`, `#else`, 等等...

### 既然我们已经确定了 SSI 的外观及其语法，我将解释它们与当代世界的关系。

我在**2021 年中**写这篇文章，所以重要的是要注意，据我所知，2012 年是最后一次更新 SSI，此外；它们由 W3C 标准化。今天我们真的不需要它们，因为我们拥有更强大的技术。第一个是模板引擎（`Pug`, `Handlebars`, 等等...，以及像`Vue`, 和`React`）。现在，如果您看到一个页面，并且它具有 SHTML 扩展名，那么它很可能是一个旧页面，并且可能需要更新。我找到并回答这个问题的原因是因为我的一位教授有一个使用 SSI 的网站，我注意到边缘没有正确加载它——标题掉到了文本正文中。看到像边缘这样的新浏览器，没有正确渲染一项已经过时的技术，这是一个很好的迹象，表明对该技术的支持正在下降，并且正在逐渐消失。总结；如果你看到***“SHTML”*** 文件扩展名——*即* `foo.shtml`——你现在知道它为什么在那里，而且你现在知道它是什么，它在那里做什么，

###### 快速的最后一点：

在 XHTML 时代，SSI 很大。但是，在当代 Dev-World 中，SSI 最好用作老师或提醒，一项技术可能非常流行，并且标准化可以由一个以标准化有史以来最具体的 Web 技术 (W3C) 着称的团体来维护，但它仍然可以以罗马的方式崩溃。SSI 是一个好主意，但是为什么 Web 是用 C++ 编写的语言编写的，而不是实际用 C++ (JavaScript) 编写的，这是有原因的。

# iis-6 - 完全信任中信任主机中的站点

> ID：519622
> 
> 赞同：0
> 
> 时间：2009-02-06T09:05:36.433
> 
> 标签：iis-6, windows-server-2003

我对 Windows 2003 服务器具有管理员访问权限。信任级别设置为中等信任，allowOverride=false。

我想知道是否有办法在配置文件中添加异常，以便一个站点可以完全信任地运行。通过使用位置标签？

如果 AppPool 在 admin 组中有一个身份，或者中等信任胜过它怎么办？

对于 PremissonSet 和 IPermission，它们是否可以仅用于为某个站点设置自定义权限，还是仅用于服务器范围的设置？我没有其他网站继承这些权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T13:06:47.430

我很抱歉，但这是一个糟糕的主意。如果您有必须完全信任的代码，则编写一个仅执行该功能的服务，并让您的（非完全信任）Web 应用程序查询该服务。坦率地说，将完全信任的 Web 应用程序放在 Internet（甚至是 Intranet）上的想法是令人恐惧的。当然，如果可能的话，更好的做法是删除完全信任要求，但当然你不能总是这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-02T18:47:04.163

需要完全信任的站点被添加到 machine.config 文件中。

# visual-studio-2008 - 使用 IStream 打开文件

> ID：519627
> 
> 赞同：0
> 
> 时间：2009-02-06T09:08:05.273
> 
> 标签：visual-studio-2008, visual-c++, mfc

我在 IStream 对象中获取文件的内容。我希望能够从获取此对象的 dll 中基于文件的扩展名（我知道扩展名和 mime 类型）在 Windows 程序中打开 IStream 内容。

有人可以告诉我如何处理这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T09:13:56.447

由于您知道文件的扩展名，因此您可能应该创建一个具有该名称的临时文件并用于`ShellExecute`获取关联的程序来打开它。Windows 中没有标准的方法可以让程序对流做任何事情。

# java - null 是 Java 关键字吗？

> ID：519631
> 
> 赞同：11
> 
> 时间：2009-02-06T09:10:11.010
> 
> 标签：java, null, keyword

是`null`Java中的关键字吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-02-06T09:12:01.210

不符合[Java 语言规范的关键字列表](http://docs.oracle.com/javase/specs/jls/se8/html/jls-3.html#jls-3.9)。另一方面，这不会编译：

```
int null = 10; 
```

[标识符规则](http://docs.oracle.com/javase/specs/jls/se8/html/jls-3.html#jls-3.8)规定：

> 标识符是 Java 字母和 Java 数字的无限长度序列，其中第一个必须是 Java 字母。标识符不能与关键字（第 3.9 节）、布尔文字（第 3.10.3 节）或空文字（第 3.10.7 节）具有相同的拼写（Unicode 字符序列）。

老实说，我不确定将其设为非关键字有什么好处。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-06T09:13:15.933

不是[*关键字*](https://docs.oracle.com/javase/specs/jls/se11/html/jls-3.html#jls-3.9)-[*空文字*](https://docs.oracle.com/javase/specs/jls/se11/html/jls-3.html#jls-3.10.7)。

~~一个[*标识符*](https://docs.oracle.com/javase/specs/jls/se11/html/jls-3.html#jls-3.8)~~（哎呀，不是）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-15T14:42:53.810

`null`是一个类似于Java`true`的字面量。`false`这些不是关键字，因为它们是某物的值。作为`null`参考变量`true`的值，是布尔变量的值。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-07T01:38:46.413

*null*是文字，与*false*、*10*和 *'\n'*是文字的意义相同。从技术上讲，它不是“关键字”，但它是一个字符串，如果编译器在 java 源文件中遇到它，编译器会对其进行特殊处理。

因此，不，您不能将变量命名为“null”。词法分析器将确定它不是标识符。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-06T09:10:47.280

不，它不是关键字。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-06T09:14:24.170

不，完整列表请参见：[Java 语言关键字](https://docs.oracle.com/javase/tutorial/java/nutsandbolts/_keywords.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T21:28:52.860

*true*和*false*也是文字。Java 琐事：*const*和*goto*是关键字。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-11T15:29:35.333

不，null 不是 Java 中的关键字。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-10-22T07:28:36.477

它代表一个特殊的值，但它不是Java中的关键字，并不意味着我们可以将它用作标识符。它被限制用作标识符，这很明显，因为我们不能将特殊值作为标识符，因为编译器会将那个词（null）视为特殊值，而不是标识符。

# python - 在 Python 中读取大文件的惰性方法？

> ID：519633
> 
> 赞同：344
> 
> 时间：2009-02-06T09:11:13.863
> 
> 标签：python, file-io, generator

我有一个非常大的 4GB 文件，当我尝试读取它时，我的计算机挂起。所以我想一块一块地读取它，在处理完每一块后将处理后的块存储到另一个文件中并读取下一块。

`yield`这些碎片有什么方法吗？

我很想有一个**懒惰的方法**。

* * *

## 回答 #1

> 赞同：507
> 
> 时间：2009-02-06T09:20:08.293

要编写惰性函数，只需使用[`yield`](http://docs.python.org/tutorial/classes.html#generators)：

```
def read_in_chunks(file_object, chunk_size=1024):
    """Lazy function (generator) to read a file piece by piece.
    Default chunk size: 1k."""
    while True:
        data = file_object.read(chunk_size)
        if not data:
            break
        yield data

with open('really_big_file.dat') as f:
    for piece in read_in_chunks(f):
        process_data(piece) 
```

* * *

另一种选择是使用[`iter`](http://docs.python.org/library/functions.html#iter)一个辅助函数：

```
f = open('really_big_file.dat')
def read1k():
    return f.read(1024)

for piece in iter(read1k, ''):
    process_data(piece) 
```

* * *

如果文件是基于行的，则文件对象已经是行的惰性生成器：

```
for line in open('really_big_file.dat'):
    process_data(line) 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2010-01-21T18:27:59.283

`file.readlines()`接受一个可选的大小参数，该参数近似于返回的行中读取的行数。

```
bigfile = open('bigfilename','r')
tmp_lines = bigfile.readlines(BUF_SIZE)
while tmp_lines:
    process([line for line in tmp_lines])
    tmp_lines = bigfile.readlines(BUF_SIZE) 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2009-02-06T09:41:29.467

**如果您的计算机、操作系统和 python 是 64 位的**，那么您可以使用[mmap 模块](http://docs.python.org/library/mmap.html)将文件的内容映射到内存中，并使用索引和切片访问它。这是文档中的一个示例：

```
import mmap
with open("hello.txt", "r+") as f:
    # memory-map the file, size 0 means whole file
    map = mmap.mmap(f.fileno(), 0)
    # read content via standard file methods
    print map.readline()  # prints "Hello Python!"
    # read content via slice notation
    print map[:5]  # prints "Hello"
    # update content using slice notation;
    # note that new content must have same size
    map[6:] = " world!\n"
    # ... and read again using standard file methods
    map.seek(0)
    print map.readline()  # prints "Hello  world!"
    # close the map
    map.close() 
```

**如果您的计算机、操作系统或 python 是 32 位的**，那么 mmap-ing 大文件可能会保留大部分地址空间并使[您](https://stackoverflow.com/questions/1661986/why-doesnt-pythons-mmap-work-with-large-files)的程序内存不足。

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2015-06-11T08:23:16.987

已经有很多很好的答案，但是如果您的整个文件在一行上并且您仍然想处理“行”（而不是固定大小的块），那么这些答案对您没有帮助。

99% 的时间，可以逐行处理文件。然后，如this [answer](https://stackoverflow.com/a/519653/628786)中所建议的，您可以将文件对象本身用作惰性生成器：

```
with open('big.csv') as f:
    for line in f:
        process(line) 
```

但是，可能会遇到没有行分隔符的非常大的文件`'\n'`（常见情况是`'|'`）。

*   转换`'|'`到`'\n'`处理前可能不是一个选项，因为它可能会弄乱可能合法包含的字段`'\n'`（例如自由文本用户输入）。
*   使用 csv 库也被排除在外，因为至少在 lib 的早期版本中，[它是硬编码来逐行读取输入的](https://docs.python.org/2/library/csv.html#csv.Dialect.lineterminator)。

对于这种情况，我创建了以下代码段 [2021 年 5 月更新，适用于 Python 3.8+]：

```
def rows(f, chunksize=1024, sep='|'):
    """
    Read a file where the row separator is '|' lazily.

    Usage:

    >>> with open('big.csv') as f:
    >>>     for r in rows(f):
    >>>         process(r)
    """
    row = ''
    while (chunk := f.read(chunksize)) != '':   # End of file
        while (i := chunk.find(sep)) != -1:     # No separator found
            yield row + chunk[:i]
            chunk = chunk[i+1:]
            row = ''
        row += chunk
    yield row 
```

[对于旧版本的python]：

```
def rows(f, chunksize=1024, sep='|'):
    """
    Read a file where the row separator is '|' lazily.

    Usage:

    >>> with open('big.csv') as f:
    >>>     for r in rows(f):
    >>>         process(r)
    """
    curr_row = ''
    while True:
        chunk = f.read(chunksize)
        if chunk == '': # End of file
            yield curr_row
            break
        while True:
            i = chunk.find(sep)
            if i == -1:
                break
            yield curr_row + chunk[:i]
            curr_row = ''
            chunk = chunk[i+1:]
        curr_row += chunk 
```

我能够成功地使用它来解决各种问题。它已经过广泛的测试，具有各种块大小。这是我正在使用的测试套件，供那些需要说服自己的人使用：

```
test_file = 'test_file'

def cleanup(func):
    def wrapper(*args, **kwargs):
        func(*args, **kwargs)
        os.unlink(test_file)
    return wrapper

@cleanup
def test_empty(chunksize=1024):
    with open(test_file, 'w') as f:
        f.write('')
    with open(test_file) as f:
        assert len(list(rows(f, chunksize=chunksize))) == 1

@cleanup
def test_1_char_2_rows(chunksize=1024):
    with open(test_file, 'w') as f:
        f.write('|')
    with open(test_file) as f:
        assert len(list(rows(f, chunksize=chunksize))) == 2

@cleanup
def test_1_char(chunksize=1024):
    with open(test_file, 'w') as f:
        f.write('a')
    with open(test_file) as f:
        assert len(list(rows(f, chunksize=chunksize))) == 1

@cleanup
def test_1025_chars_1_row(chunksize=1024):
    with open(test_file, 'w') as f:
        for i in range(1025):
            f.write('a')
    with open(test_file) as f:
        assert len(list(rows(f, chunksize=chunksize))) == 1

@cleanup
def test_1024_chars_2_rows(chunksize=1024):
    with open(test_file, 'w') as f:
        for i in range(1023):
            f.write('a')
        f.write('|')
    with open(test_file) as f:
        assert len(list(rows(f, chunksize=chunksize))) == 2

@cleanup
def test_1025_chars_1026_rows(chunksize=1024):
    with open(test_file, 'w') as f:
        for i in range(1025):
            f.write('|')
    with open(test_file) as f:
        assert len(list(rows(f, chunksize=chunksize))) == 1026

@cleanup
def test_2048_chars_2_rows(chunksize=1024):
    with open(test_file, 'w') as f:
        for i in range(1022):
            f.write('a')
        f.write('|')
        f.write('a')
        # -- end of 1st chunk --
        for i in range(1024):
            f.write('a')
        # -- end of 2nd chunk
    with open(test_file) as f:
        assert len(list(rows(f, chunksize=chunksize))) == 2

@cleanup
def test_2049_chars_2_rows(chunksize=1024):
    with open(test_file, 'w') as f:
        for i in range(1022):
            f.write('a')
        f.write('|')
        f.write('a')
        # -- end of 1st chunk --
        for i in range(1024):
            f.write('a')
        # -- end of 2nd chunk
        f.write('a')
    with open(test_file) as f:
        assert len(list(rows(f, chunksize=chunksize))) == 2

if __name__ == '__main__':
    for chunksize in [1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024]:
        test_empty(chunksize)
        test_1_char_2_rows(chunksize)
        test_1_char(chunksize)
        test_1025_chars_1_row(chunksize)
        test_1024_chars_2_rows(chunksize)
        test_1025_chars_1026_rows(chunksize)
        test_2048_chars_2_rows(chunksize)
        test_2049_chars_2_rows(chunksize) 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2012-03-31T01:50:18.347

```
f = ... # file-like object, i.e. supporting read(size) function and 
        # returning empty string '' when there is nothing to read

def chunked(file, chunk_size):
    return iter(lambda: file.read(chunk_size), '')

for data in chunked(f, 65536):
    # process the data 
```

更新：该方法在[https://stackoverflow.com/a/4566523/38592中得到了最好的解释](https://stackoverflow.com/a/4566523/38592)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-06-23T07:49:25.093

参考python的官方文档 [https://docs.python.org/3/library/functions.html#iter](https://docs.python.org/3/library/functions.html#iter)

也许这种方法更pythonic：

```
from functools import partial

"""A file object returned by open() is a iterator with
read method which could specify current read's block size"""
with open('mydata.db', 'r') as f_in:

    part_read = partial(f_in.read, 1024*1024)
    iterator = iter(part_read, b'')

    for index, block in enumerate(iterator, start=1):
        block = process_block(block)    # process your block data

        with open(f'{index}.txt', 'w') as f_out:
            f_out.write(block) 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-07-20T19:17:31.673

在 Python [3.8+](https://docs.python.org/3/whatsnew/3.8.html#assignment-expressions)中，您可以[`.read()`](https://docs.python.org/library/io.html#io.RawIOBase.read)在`while`循环中使用：

```
with open("somefile.txt") as f:
    while chunk := f.read(8192):
        do_something(chunk) 
```

当然，你可以使用任何你想要的块大小，你不必使用`8192`( `2**13`) 字节。除非您的文件大小恰好是您的块大小的倍数，否则最后一个块将小于您的块大小。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-11-06T02:15:10.477

我想我们可以这样写：

```
def read_file(path, block_size=1024): 
    with open(path, 'rb') as f: 
        while True: 
            piece = f.read(block_size) 
            if piece: 
                yield piece 
            else: 
                return

for piece in read_file(path):
    process_piece(piece) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-06T10:37:22.397

由于我的声誉低，我不允许发表评论，但是使用 file.readlines([sizehint]) SilentGhosts 解决方案应该更容易

[python文件方法](http://docs.python.org/library/stdtypes.html#file-objects)

编辑： SilentGhost 是对的，但这应该比：

```
s = "" 
for i in xrange(100): 
   s += file.next() 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-06T10:12:47.327

我的情况有点类似。目前尚不清楚您是否知道块大小（以字节为单位）；我通常不知道，但所需的记录（行）数是已知的：

```
def get_line():
     with open('4gb_file') as file:
         for i in file:
             yield i

lines_required = 100
gen = get_line()
chunk = [i for i, j in zip(gen, range(lines_required))] 
```

**更新**：谢谢 nosklo。这就是我的意思。它几乎可以工作，只是它在“块之间”丢失了一条线。

```
chunk = [next(gen) for i in range(lines_required)] 
```

这个技巧不会丢失任何线条，但看起来不太好。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-05-01T23:12:15.620

要逐行处理，这是一个优雅的解决方案：

```
 def stream_lines(file_name):
    file = open(file_name)
    while True:
      line = file.readline()
      if not line:
        file.close()
        break
      yield line 
```

只要没有空行。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2015-06-18T13:20:52.373

您可以使用以下代码。

```
file_obj = open('big_file') 
```

open() 返回一个文件对象

然后使用 os.stat 获取大小

```
file_size = os.stat('big_file').st_size

for i in range( file_size/1024):
    print file_obj.read(1024) 
```

# java - JavaMail程序中的疑问

> ID：519645
> 
> 赞同：0
> 
> 时间：2009-02-06T09:15:38.520
> 
> 标签：java, jakarta-mail

我创建了一个 java 邮件程序来发送邮件。昨天工作正常。所有邮件都在收件箱文件夹中收到，但今天收件箱没有收到邮件，所有邮件都存储在垃圾箱文件夹中。谁能知道为什么会这样？我应该怎么做才能在收件箱中收到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T09:22:43.437

这将完全取决于接收者如何对电子邮件进行分类。它可能是：

*   您已被列入垃圾邮件列表
*   您的电子邮件包含被识别为垃圾邮件的文本
*   您的电子邮件频率导致您被归类为垃圾邮件发送者
*   许多其他因素 - 我不是垃圾邮件专家！

如果幸运的话，接收电子邮件系统将有办法向读者*解释为什么*邮件被归类为垃圾邮件。这应该可以帮助您解决问题。或者，读者可以将“发件人”地址添加到“绝对不是垃圾邮件发送者”的白名单中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T09:19:51.397

也许您的邮件客户端认为您发送的邮件太多？尝试更改发件人信息/主题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T09:30:37.287

按照 SpamAssassin 提供的清单来帮助您的案例：[http ://wiki.apache.org/spamassassin/AvoidingFpsForSenders](http://wiki.apache.org/spamassassin/AvoidingFpsForSenders)

# sharepoint - 如何使用功能上传发布页面？

> ID：519662
> 
> 赞同：1
> 
> 时间：2009-02-06T09:24:27.473
> 
> 标签：sharepoint, sharepoint-2007, sharepoint-designer, publishing

我正在尝试制作一项功能以在“页面”库中上传新的发布页面，但它不能按我想要的方式工作。如果我使用 SharePoint Designer 查看库，则会显示我的发布页面，但如果我使用 Internet Explorer，则不会。

在该功能中，我配置了以下属性：ContentTypeId、ContentTye、Author、Title、FileRef、FileDirRef、FileLeafRef、FileType、LinkFilenameNoMenu、LinkFilename 和 DocIcon。在以前的功能中，我遇到了同样的问题，并且解决了放置 ContentTypeId 属性。在这种情况下，我不知道错误在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T08:30:54.103

我使用以下代码基于页面布局创建发布页面，该页面布局被认为已配置并基于内容类型。代码在您的功能的 FeatureActivated 事件处理程序中运行：

```
 using (SPWeb ParentWeb = properties.Feature.Parent as SPWeb)
    {
            PublishingWeb webpublish = PublishingWeb.GetPublishingWeb(ParentWeb);

            //retrieve the layout associated with our custom content type
            PageLayout[] layouts = webpublish.GetAvailablePageLayouts(new SPContentTypeId(MyContentTypeID));

            //first layout considered, as this is the one created by this feature
            PageLayout MyPageLayout = layouts[0];

            PublishingPageCollection PublishingPages = webpublish.GetPublishingPages();

            PublishingPage newPage = PublishingPages.Add("NewPublishingPageName.aspx", MyPageLayout);
            newPage.Title = "My first publishing page";

            newPage.ListItem.Update();

            //check-in and republish the page
            SPFile listItemFile = newPage.ListItem.File;

            //check that the file is not checked out - if it is,  check it in.
            if (listItemFile.CheckOutStatus != SPFile.SPCheckOutStatus.None)
            {
                listItemFile.CheckIn("Initial default content added.");
            }

            listItemFile.Publish("");
            listItemFile.Approve("");                
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-11T07:52:25.790

参考这些链接

[http://blog.mastykarz.nl/provisioning-publishing-pages-features-declarative-markup/](http://blog.mastykarz.nl/provisioning-publishing-pages-features-declarative-markup/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T14:45:10.013

我有一个类似的问题。事实证明，我必须发布上传的文件才能使其可见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T16:25:52.530

我有与 Tudor 类似的解决方案，我将发布该代码以防万一：

...获取 SiteCollection (SPSite)...

```
PublishingSite pSite = new PublishingSite(site);
PageLayout layout = pSite.PageLayouts["MyLayout"];

PublishingWeb pWeb = PublishingWeb.GetPublishingWeb(site);

if(pWeb.GetPublishingPages()[pWeb.PagesList.Title + "/" + "MyPage.aspx"] == null)
{
  PublishingPage page = pWeb.GetPublishingPages().Add("MyPage.aspx", layout);
  page.Title = "MyTitle";
  page.Update();
  page.CheckIn("Added MyPage.aspx");
} 
```

# mocking - 有没有办法决定 RhinoMocks 模拟何时开始录制？

> ID：519666
> 
> 赞同：2
> 
> 时间：2009-02-06T09:27:49.633
> 
> 标签：mocking, rhino-mocks

据我了解，使用RhinoMocks创建的mock对象在创建时直接进入录制状态，然后调用Replay()进入回放状态。我想手动决定模拟对象何时开始录制，或者能够暂停录制。这在 RhinoMocks 中可行吗？

谢谢/埃里克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T02:06:11.213

模拟处于录制或重播模式。他们不能处于“无”模式。

如果您不想使用 AAA 语法并且想要控制记录/重放状态，那么您必须在创建模拟后立即通过调用 mockRepository.Replay(mock) 方法手动完成。

使用 mockRepository.BackToRecord(mock,option) 方法将 mock 放回记录模式。使用 BackToRecordOptions.None 选项来防止清除您已经设置的任何期望。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T09:33:10.763

在我看来，最好使用 Arrange Act Assert 格式。

```
var mockEmailService = MockRepository.GenerateMock<IEmailService>();
mockEmailService.Expect(x => x.Send("me@home", "Subject", "Body"));

//Thing to test
var controller = MehController(mockEmailService);
controller.Meh();

mockEmailService.VerifyAllExpectations(); 
```

如果您需要在对象进入播放模式之前使用它，那么您的测试就有问题。

# python - 是否有用于 Python 和 Django 的 HAML 实现

> ID：519671
> 
> 赞同：72
> 
> 时间：2009-02-06T09:30:01.330
> 
> 标签：python, django, django-templates, haml

我碰巧偶然发现了[HAML](http://haml.info/)，这是一种用于标记内容和为 HTML 编写模板的有趣且漂亮的方法。

由于我使用 Python 和 Django 来满足我的 Web 开发需求，我想看看是否有 HAML 的 Python 实现（或一些类似的概念——不必完全相同）可用于替换 Django 模板引擎。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-12-19T21:33:50.660

您可能对 SHPAML 感兴趣：

[http://shpaml.com/](http://shpaml.com/)

我正在积极维护它。它是一个简单的预处理器，因此它不依赖于任何其他工具，例如 Genshi。我碰巧将它与 Django 一起使用，所以有一点 Django 支持，但它不应该干扰大多数其他用例。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-06T09:36:46.713

我会检查[GHRML](https://github.com/derdon/ghrml)， Genshi 的 Haml。作者承认它基本上是 Python 的 Haml，并且大部分语法是相同的（并且它在 Django 中工作）。这里有一些 GHRML 只是为了向您展示它们有多接近：

```
%html
  %head
    %title Hello World
    %style{'type': 'text/css'}
      body { font-family: sans-serif; }
    %script{'type': 'text/javascript', 'src': 'foo.js'}

  %body
    #header
      %h1 Hello World
    %ul.navigation
      %li[for item in navigation]
        %a{'href': item.href} $item.caption

    #contents
      Hello World! 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2010-07-24T11:56:45.470

我正在寻找相同的。我没有尝试过，但发现了这个：

[http://github.com/jessemiller/HamlPy](http://github.com/jessemiller/HamlPy)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-07-31T12:16:42.920

您可能对[Plim](https://github.com/2nd/Plim)感兴趣。[这是Slim](http://slim-lang.com/)的成熟 python 端口。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-10-17T17:18:24.910

这实际上并不能回答您的问题，但是 HAML 的 CSS 组件[SASS](http://sass-lang.com/)可以在任何框架中自由使用。我现在正在与 Django 一起使用它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-23T03:57:01.697

我的项目[PyHAML](https://github.com/mikeboers/PyHAML)是一个 Mako 预处理器，它为您提供非常类似于 HAML 的语法。一些 Ruby 不能很好地转换为 Python，因此存在一些差异，但精神是相同的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-04-28T02:41:06.463

我在做一些 node.js 工作时遇到了玉，当返回 Django 时，我正在寻找类似的东西。我找到[了 Pyjade](https://github.com/SyrusAkbary/pyjade "PyJade")，虽然它几乎正是我正在寻找的东西，但它在 Django 中处理错误和调试相当糟糕。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-05-04T13:22:42.363

我不确定 GHRML 位的状态是什么，因为我最近才调查它。找不到它的 repo，原始开发人员不再有时间进行维护，并且对该项目感兴趣的其他人进行了维护。任何有关此的额外信息都会有所帮助。

不幸的是，随着这些事情的发展，我开始编写自己的 HAML 样式处理器；）

[http://dasacc22.wordpress.com/2010/05/03/python-implementation-of-haml/](http://dasacc22.wordpress.com/2010/05/03/python-implementation-of-haml/)

目前它根本不适合生产使用（它现在实际上是一个 4 天大的婴儿，但在那 4 天里塞满了 60 多个小时），但任何有兴趣的人都可以在这里查看。它已经实现了一系列功能，使其可以作为玩具使用，当我在下周清理代码库时，我希望看到它取代我拥有的所有自定义 XSLT/xpath 扩展和模板。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-08-16T20:55:55.423

我刚刚制作了这个[http://github.com/fitoria/django-haml](http://github.com/fitoria/django-haml)它仍处于早期阶段，但它可以工作。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-03-02T18:46:17.037

Daniel Skinner 的项目（如上所述）似乎已重命名为 DMSL。它看起来非常强大，模拟 HAML，但允许您在其语法中使用 python 函数、lambdas、理解等：[https ://github.com/dasacc22/dmsl](https://github.com/dasacc22/dmsl)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-07-14T17:40:30.883

我会用这个，它似乎是最标准的一个：[https ://pypi.org/project/HamlPy3/0.83.0/](https://pypi.org/project/HamlPy3/0.83.0/)

假设你使用的是 Python3，你不应该在 Django、Flask 甚至独立使用它时遇到任何问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-04-06T20:02:42.777

您可能想尝试[Hypertag](http://hypertag.io/)：一种新的基于缩进的 HTML 模板语言，受到 HAML 的强烈启发。Hypertag 具有非常简洁的语法，提供完整的**Django 集成**和许多高级功能：本机自定义标签、DOM 操作、类似 Python 的导入、复杂的表达式、过滤器、控制块（for、if、try...）等等。看这里：

*   [http://hypertag.io/](http://hypertag.io/)
*   [https://github.com/mwojnars/hypertag](https://github.com/mwojnars/hypertag)

免责声明：我是作者，如果出现任何问题或疑问，我很乐意提供帮助。

# .net - 将字符串解析为整数（来吧地狱或高水位）

> ID：519675
> 
> 赞同：2
> 
> 时间：2009-02-06T09:33:49.200
> 
> 标签：.net, asp.net, vb.net

我需要维护一个旧的 VB.NET Web 应用程序。我想说，数据类型是不一致的。特别是，有些数据有时存储为整数，有时存储为字符串，我必须可靠地将字符串解析为整数。如果解析出错，它应该总是返回 0。

问题是，我不能为此使用任何 .NET/VB.NET 解析函数，但我必须依赖自制函数。

我可以使用单行标准框架调用来完成每个字符串到整数的解析任务吗？

假设有一个字符串可以为 null、空、包含像“10”这样的整数表示或包含其他内容。

我已经用一个**空的输入字符串 ""**尝试了这些：

```
CType(string, Integer) -> Conversion from string "" to type 'Integer' is not valid.
Convert.ToInt32(string) -> Input string was not in a correct format.
Integer.Parse(string) -> Input string was not in a correct format.
CInt(string) -> Conversion from string "" to type 'Integer' is not valid.
Val(string) -> Success! 
```

但即使是瓦尔也可能失败。万无一失的方法是调用自制函数：

```
 Public Function ToInteger(ByVal s As String) As Integer

        s = Trim(s)
        Dim i As Integer

        Try
            i = Val(s)
        Catch ex As Exception
            i = 0
        End Try

        Return i

    End Function 
```

我觉得这很糟糕。这很糟糕，因为：

*   我正在尝试将字符串解析为整数！这不是火箭科学，即使涉及语义
*   自制的标准并不能很好地坚持。在代码中的某个地方，您总是会发现损坏的标准框架解决方案

因此，软件中存在不必要的错误。我指责这个标准框架。除非，当然找到更好的解决方案:)

* * *

感谢所有的答案。Int32.TryParse 在这里很完美。

但是，如果您必须先将输入转换为字符串，则转换可能会失败。就像从具有可能 DBNull 值的数据库对象中读取一样。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-06T09:38:14.807

使用[`Int32.TryParse`](http://msdn.microsoft.com/en-us/library/system.int32.tryparse.aspx)并忽略返回值 - 只需使用参数中的值`out`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-06T09:39:39.860

您没有说明为什么不能使用“.NET/VB.Net 解析函数”，所以我会提出这个建议：-

```
Public Function ToInteger(ByVal s As String) As Integer
    Dim i as Integer
    Integer.TryParse(s, i)
    Return i
End Function 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T09:40:54.850

尝试[Int32.TryParse()](https://msdn.microsoft.com/en-us/library/f02979c7%28v=vs.110%29.aspx)方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T09:40:55.410

两行就够了吗？以下是 C# 代码，但我相信您可以将其移植到 VB.NET 而不会出现太多问题：

 ~~~~```
int i;
if(!Int32.TryParse(MyString, out i)) i=0; 
```~~ 

~~实际上，因为`TryParse`如果解析失败会将 i 设置为零，所以不需要 if 语句：~~

 ~~```
int i;
Int32.TryParse(MyString, out i); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T09:50:29.587

如果您正在执行大量字符串解析并且不确定字符串中可能包含什么内容，您可以尝试使用[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)。两个或三个精心挑选的正则表达式应该可以输出你正在寻找的任何东西。

[在这种情况下，像regexbuddy](http://www.regexbuddy.com)这样的工具是无价的。它允许您在 GUI 环境中为您的字符串设计一个正则表达式，您可以在其中测试它们的各种替代方案。

例如，以下将匹配字符串中任意位置的数字，并匹配以空格分隔的多个数字。

```
(\d*) 
```

正则表达式有时被认为有点吓人，但其实没必要。

# sql - 优化sql更新

> ID：519677
> 
> 赞同：0
> 
> 时间：2009-02-06T09:35:59.790
> 
> 标签：sql, sql-server, performance, sql-update

我们有 2 个名为**TableToUpdate**和**Dates**的表。我们需要通过查看其他表**Dates来更新****TableToUpdate**的 EndTimeKey 列。我们在下面运行 sql 来执行此操作，但需要很长时间才能完成。

 **表**TableToUpdate**有 6M 条记录。表**日期**有 5000 条记录。

我们如何优化它？

感谢您的回复！

```
update TableToUpdate set
EndTimeKey = DATE_NO
from Dates where EndTime = DATE 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T16:13:51.843

您可能正在更新 600 万条记录，无论如何这都不会非常快。但是，请查看您的执行计划，看看它是否使用索引。

也可以批量运行，在更新大量记录时通常更快。在数据库负载很小的下班时间进行更新，这将减少潜在的锁定问题。确保两个表之间的数据类型相同，这样您就不必进行任何隐式转换。

看看你正在更新的表，上面有没有触发器？根据触发器的编写方式，这可能会严重减慢许多记录的更新速度（特别是如果不太聪明的人决定在触发器中放置游标或循环而不是编写基于集合的代码）。

这里还有一些我要添加的东西（我也改变了它显示明确显示加入）

```
update t
set EndTimeKey = DATE_NO
from TableToUpdate t
Join Dates D on t.EndTime = d.DATE
where EndTimeKey <> DATE_NO 
```

更新已经匹配的记录没有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T18:33:07.647

有了这么多数据，您最好创建一个 SELECT 查询，该查询会生成一个包含更新值的结果集，因为您希望看到新表。接下来，通过创建表并使用 INSERT INTO 或通过更改 SELECT 添加 INTO 来创建新表，将这些选择到新表中（可能是 'NewTableToUpdate'）。

Next use sp_rename to rename 'TableToUpdate' to 'OLDTableToUpdate' and 'NEWTableToUpdate' to 'TableToUpdate' and then create the indexes as you had them on the original table.

In my experience I've found this to be the quickest means of acheiving big changes like this. HTH.

Extra thought... if you have a clustered index on your table then add an ORDER BY to your SELECT statement to ensure it is inserted into your new table in the same sequence as the clustered index. That'll speed up the index creation in a significant way.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T09:43:40.990

您可以在相关字段上设置一些索引（按相关顺序），即：endtimekey 和 endtime。不要期望太多。您可以检查的另一件事是您是否有其他限制来限制查询结果。

您还可以创建一个视图，为每个 tabletoupdate.endtimekey 返回正确的 date_no。

如果您的 dbms 确实支持这些东西，也许您可​​以编写一个存储过程 - 因为这确实会加速更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T09:43:54.187

我在这里注意到几件事，EndTimeKey 真的是关键吗？如果是这样，它可能有一个索引，如果是这样，速度（或缺乏）将更新索引，同时也进行数据的实际更新，解决方案删除索引，运行更新重新应用索引。

另一个问题可能是 Sql 的事务性质 - 当您执行此更新时，它将记录每个更改，以便在发生故障时回滚。此更新看起来非常简单，因此您可以分批应用它，即

```
update TableToUpdate setEndTimeKey = DATE_NOfrom Dates where EndTime = DATE
where TableToUpdateId between 1 and 100000 
```

这会将您的更新分成可管理的大小块 - 至少您会知道每个块需要多长时间。

另一种选择是在 EndTime 列上放置一个索引，可能它必须进行全表扫描。

真正的答案是查看正在生成的查询计划。正如您所看到的，查询可能运行缓慢的原因有很多——这些只是一些需要快速检查的原因。

# c# - 常规 Exp 而不是字符串拆分

> ID：519680
> 
> 赞同：1
> 
> 时间：2009-02-06T09:38:00.970
> 
> 标签：c#

前两天我参加了一次考试，其中一个问题是用新名称替换@之前的字母

所以在试卷中我们有 array = "toto@yahoo.com","mimi@yahoo.com".soso@yahoo.com" 所以我们应该使用 toto mimi soso 并用不同的名字替换它们我所做的是拆分字符串并取前四个字母，感谢上帝，我得到了标记。

我在想如果@之前的字母数量不固定我还能做什么？Reg Exp 还是有不同的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T09:40:23.617

您可以使用 RegEx，也可以基于 Substring、IndexOf 和连接进行字符串操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T09:41:17.437

使用正则表达式，您可以搜索 [a-zA-Z]*@ 之类的字符串，并将其替换为您想要的任何内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T09:52:01.363

我和 Treb 在一起，不要使用 RegEx 来解析电子邮件地址！

“@”的左侧可能没有任何合法字符，特别是左侧实际上可以是一个带引号的字符串，它本身可以包含一个“@”，即：

```
"Some odd e-m@il address!"@example.com 
```

[请参阅RFC 5322](https://www.rfc-editor.org/rfc/rfc5322)的第 3.4.1 节。

因此字符串拆分应该基于*最右边的*“@”符号来完成，因为它肯定不会出现在地址的域部分中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T09:43:04.003

是的，我会用正则表达式来做到这一点。

沿着 split、substring、indexof 的简单匹配技术往往很快，但是 - 正如你所发现的 - 不灵活，而且正则表达式在事物方案中无论如何都*非常*快。除非操作处于一个长循环中（因此会放大性能成本），否则我通常建议未来的灵活性和意图的清晰性值得使用正则表达式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T09:44:33.720

正则表达式可以工作，但只需按照[Brian Rasmussen](https://stackoverflow.com/questions/519680/regular-exp-instead-of-string-split/519686#519686)的建议获取 @ 的位置`IndexOf`并提取地址部分就更简单了。如有疑问，请选择更简单的（换句话说： 适用[KISS 原则](http://en.wikipedia.org/wiki/KISS_principle)）。`Substring`

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-06T10:06:57.073

这可能会有所帮助：

```
// I want to replace soso with tania
string result = Regex.Replace("soso@yahoo.com", "([a-zA-Z0-9._]*)([@][a-zA-Z0-9._]*)", "tania$2"); 
```

# c# - 用于开发皮肤应用程序的最佳框架是什么？

> ID：519685
> 
> 赞同：0
> 
> 时间：2009-02-06T09:40:09.750
> 
> 标签：c#, c++, skinning, skin, skins

我需要为 windows 开发一个应用程序，它需要支持皮肤。我正在寻找一个可以使用的框架。我宁愿不使用 QT，因为它的许可 - GPL 对我来说不是一个选项，否则它会很昂贵（我不能推迟到 3 月开发这个应用程序，那时 QT 应该去 LGPL） .

有人对我应该使用什么有任何建议吗？对我来说，语言选项是 C/C++、C#（最好是 .Net 2.0 或更低版本）或 Visual Basic。使用 quasi-CSS 进行蒙皮的东西，比如 QT，将是一个额外的好处。开源许可（LGPL、MIT 等）也将是一个奖励。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T09:54:05.213

我会认为“WPF”是（显而易见的）最佳答案 - 除非您对 .Net 2 或更低版本的偏好是牢不可破的。要使用 WPF，您将使用 .Net3-3.5 中的 C#/VB/F# 编写（或者甚至可能是即将为 .Net 推出的 IronRuby/IronPython）。

谷歌搜索“皮肤”和“WPF”，您将获得大量匹配项。WPF 中对蒙皮有隐含但非常好的支持。

例如： http: [//www.wpfdev.com/2008/04/09/creating-skins-for-wpf-controls/](http://www.wpfdev.com/2008/04/09/creating-skins-for-wpf-controls/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T09:46:22.357

如果您在谈论 C++，那么您可以查看[Ultimate++](http://www.ultimatepp.org/)，根据文档提供皮肤（从未尝试过此功能）。与其他一些小部件工具包不同，它试图利用现代 C++ 特性。而且它相当轻巧。至于许可证——“最好的”——BSD。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T14:33:59.250

看看 DevExpress DXperience .NET WinForms 控件（尤其是“DefaultLookAndFeel”和“StyleController”不记得是哪一个了）。它们非常强大，并且能够轻松地为您的应用程序编写自己的皮肤。目前有一项特别优惠，您可以免费获得 60 个 DevExpress 控件。

[http://devexpress.com/Products/Free/WebRegistration60/](http://devexpress.com/Products/Free/WebRegistration60/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T14:01:31.530

Gtk 支持主题，此链接提供更多信息来编译主题[http://dt.in.th/2008-08-25.gtk-compile-windows.html](http://dt.in.th/2008-08-25.gtk-compile-windows.html)。此外，您还会发现很多 Gtk 主题，请参见此处，例如[http://art.gnome.org/themes/gtk2](http://art.gnome.org/themes/gtk2)。

如果你想要一个商业解决方案，对于 MFC/C++ 有[BCGSoft](http://www.bcgsoft.com/)，[Codejock](http://www.codejock.com/)，对于 C#/.Net [Infragistics](http://www.infragistics.com/)。如果你打算做一些非常简单的事情，任何一个都足够了，但如果你想做更复杂的 UI，他们可能会开始变得太多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T14:44:22.240

如果您正在进行 C# 开发，并且准备使用商业产品，请再次投票给 DevExpress。

看看他们的 ExpressApp 框架产品 (XAF)。这附带了许多皮肤。演示相当不错。该框架将为 Win 和 Web 部署生成应用程序。

它并不便宜，但根据您尝试生产的应用程序，它可以为您节省一笔财富。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T07:30:23.273

我最终编写了自己的自定义皮肤支持，特定于我的应用程序。将 wxNO_BORDER 与 wxWidgets 一起使用，并从头开始编写大量控件，这给了我所需的能力。

将来，我可能会使用 QT，当它在 LGPL 或 WPF 下时，如果 DotNet 3 对我来说是一个选项。

感谢所有的回复。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-13T07:20:39.447

我认为 XAF 是现在快速开发皮肤应用程序的最佳选择，它通过单一代码库同时支持 Windows 和 Web UI。另一方面，如果性能是您非常关心的问题，那么您最好在做出最终决定之前自己尝试一下。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-06T10:53:38.867

在做出决定之前，我将尝试 Qt Designer 并尝试集成的 CSS 编辑器。

无论如何我会赌Qt4

# iphone - 如何在 setStatusBarHidden:Yes 之后设置顶部位置 = 0？

> ID：519689
> 
> 赞同：12
> 
> 时间：2009-02-06T09:40:55.863
> 
> 标签：iphone, xcode

我发现设置后

```
[[UIApplication sharedApplication] setStatusBarHidden:YES animated:NO] 
```

在`viewDidLoad`，那么如果我想将图像与顶部对齐，我需要将其位置设置为 .y = -20;

无论如何要使*顶部位置*的 y 坐标为*0*？还是隐藏状态栏后注定是-20？

谢谢阅读。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-06T15:49:36.710

我曾经遇到过类似的问题，这段代码为我解决了这个问题：

```
[viewController.view setFrame: [viewController.view bounds]]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-03-14T01:53:39.370

Justin Gallagher 的解决方案几乎是正确的，但有一个主要的副作用。

隐藏状态栏然后将视图的框架设置为其自己的边界将在当前方向上工作。*但是轮换会很丑*。例如，如果您是纵向的，将设备旋转到横向会导致整个视图的框架向右移动 256 个点，从而在屏幕上留下一个大的黑色空间。

bmoeskau 在上述评论中的解决方案（另一个副作用）避免了这个问题：

```
[self.view setFrame: [[UIScreen mainScreen] bounds]]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T09:47:27.440

我想如果你希望状态栏从一开始就被删除，你应该在 Info.plist 中添加一个 UIStatusBarHidden 项目。

[讨论@apple.com](http://discussions.apple.com/thread.jspa?threadID=1688715&tstart=0)

您还可以考虑设置 Autosizing 以调整垂直（和水平）大小

有关在 InterfaceBuilder中*单击*的内容的示例，请参见[此处的](http://cocoadevcentral.com/d/learn_cocoa/)**Add A Text View**

 *引用：

> 单击内部框中的水平线和垂直线，使它们变为实心红线。动画预览显示文本视图的内部大小将随窗口增大和缩小。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-06T09:47:40.297

检查以确保 nib 中根视图的大小正确设置为 480x320。一些模板项目会在 460x320 上创建这些模板项目以说明状态栏。如果您加载跨全屏的视图并且隐藏状态栏，它应该可以正常工作，您根本不需要做任何特别的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-18T15:41:55.903

如果您有一个嵌套在视图中的滚动视图，请确保也更改它。这段代码解决了我所有的问题。

```
[self.view setFrame: [self.view bounds]];
[self.theScroller setFrame: [self.view bounds]]; 
```

“theScroller”是我的滚动视图的名称。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-29T09:23:54.427

以下解决方案正常工作

*   在 iOS 6 和 iOS 7 上，
*   隐藏和显示状态栏，
*   纵向和横向，以及
*   即使通话状态栏可见

* * *

在您的视图控制器中，添加这些：

```
- (BOOL)prefersStatusBarHidden  // For iOS 7.0 or above.
{
    return _isStatusBarHidden;
}

// Call this method to show / hide the status bar and resize the view.
- (void)setStatusBarHidden:(BOOL)isStatusBarHidden
{
    _isStatusBarHidden = isStatusBarHidden;

    // For iOS 7.0 or above...
    if([self respondsToSelector:@selector(setNeedsStatusBarAppearanceUpdate)])
    {
        // Update status bar visibility.
        [self setNeedsStatusBarAppearanceUpdate];   // Tell the view controller that the return value of -prefersStatusBarHidden has changed.
    }
    // Otherwise...
    else
    {
        // Show or hide status bar.
        [[UIApplication sharedApplication] setStatusBarHidden:_isStatusBarHidden withAnimation:UIStatusBarAnimationNone];

        // Resize view.
        self.view.frame = [UIScreen mainScreen].applicationFrame;
    }
} 
```

这里，`BOOL _isStatusBarHidden;`是视图控制器类的成员变量。

笔记：

*   [-prefersStatusBarHidden](https://developer.apple.com/LIBRARY/IOS/documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/prefersStatusBarHidden)和[-setNeedsStatusBarAppearanceUpdate](https://developer.apple.com/LIBRARY/IOS/documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/setNeedsStatusBarAppearanceUpdate)适用于 iOS 7.0+。
*   [-applicationFrame](https://developer.apple.com/library/ios/documentation/uikit/reference/UIScreen_Class/Reference/UIScreen.html#//apple_ref/occ/instp/UIScreen/applicationFrame)返回应用程序窗口的框架。
*   要在 iOS 模拟器上测试纵向/横向方向，请使用`⌘</kbd>`←</kbd> (rotate left) and `⌘</kbd>`→</kbd> (rotate right).````
*   要在 iOS 模拟器上测试通话状态栏，请使用`⌘</kbd>`Y`.`

# colors - 色盲：你知道吗？你为它设计吗？

> ID：519692
> 
> 赞同：23
> 
> 时间：2009-02-06T09:41:26.737
> 
> 标签：colors, accessibility, color-blindness

我很好奇我们中的许多从事设计或做出设计决策的人是否听说过这个问题。

我知道有危险的颜色组合，比如绿色+红色。这可能是最流行的色盲案例之一。如果您在红色背景上有绿色文字，反之亦然，有些人将看不到任何东西。

在实践中，我还看到一个人看不到蓝色背景上的绿色文本。

应该避免哪些其他颜色组合，以及这些情况的预期频率？

让我们根据有数字的遭遇概率进行一些测距。

补充：我刚刚记得一个非常糟糕的例子，它给几乎每个人带来了问题——黑色背景上的蓝色文本。对于所有意图和目的，它都是不可读的。永远无法理解是什么可能迫使网站管理员使用这种颜色组合......

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-06T09:44:09.930

我总是在[http://www.vischeck.com/vischeck/vischeckURL.php](http://www.vischeck.com/vischeck/vischeckURL.php)中测试我的页面，以确保我没有选择非常糟糕的颜色。或者这个[http://colorfilter.wickline.org/](http://colorfilter.wickline.org/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-06T09:52:01.863

我自己是绿红型色盲，所以是的，我考虑到了这一点:)

请遵循其他人链接到的网站中提到的设计指南。但我想强调一些想法：

*   硬编码*任何*颜色可能不是一个好主意。可配置和可换肤很好。
*   特别是，将指标硬编码为“红色一 = 坏，绿色一 = 好”，可能不是一个好主意。
*   而且，将*相同*的指标硬编码为“当它是绿色的时候是好的，当它是红色的时候是坏的”绝对是一个坏主意。

（电池充电了吗？）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-06T09:45:38.943

我认为这一定很普遍，不考虑这一点的开发人员注定要锁定出奇高比例的客户。在我的工作场所，研发部门大约 30 人中，有 2 人有某种程度的色盲，还有 1 人视力受限——他需要使用 windows 的“高对比度”配色方案才能完成任何工作。一个很好的测试是在各种高对比度方案中运行您的应用程序。如果你还没有这样做，我几乎可以保证它是不可读的。您需要能够处理这样的方案以获得更好的可访问性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T09:44:59.613

我的直接老板是色盲，所以是的，我们考虑到了这一点。;-)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-06T09:46:19.753

是的，在您使用颜色来识别和/或标记事物的任何情况下，绝对需要考虑它。

经典案例是红绿灯式指示灯，一般为红、黄、绿。红色/绿色盲很常见。如果您正在创建需要遵守可访问性法规的应用程序，则必须考虑到这一点以及许多其他事情。

加拿大魁北克政府认识到这一点，他们的实际交通信号灯具有不同的形状和不同的颜色。真的有道理。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-06T09:48:19.797

网站应该满足所有人的需求，无论他们是色盲、聋哑人还是其他人。

英国皇家盲人研究所有一些关于为部分站点设计网页的有趣文章； [链接文本](http://www.rnib.org.uk/xpedio/groups/public/documents/code/public_rnib008789.hcsp)

包括颜色对比[链接文本](http://www.rnib.org.uk/xpedio/groups/public/documents/PublicWebsite/public_contrast.hcsp)

以及使用颜色来传达信息[链接文本](http://www.rnib.org.uk/xpedio/groups/public/documents/PublicWebsite/public_colouralone.hcsp)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T09:45:40.223

在 Windows 中，您可以查询系统的系统颜色。我总是使用它们。

您可以使用高对比度屏幕设置测试您的应用程序，如果一切都可读，我想没问题。

让我大开眼界的文章在这里：http: [//msdn.microsoft.com/en-us/library/bb263953.aspx](http://msdn.microsoft.com/en-us/library/bb263953.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-06T09:47:36.753

我为受第 508 条约束的美国政府部门做了一些工作，所以它确实出现了。

到目前为止，红色/绿色是最常见的形式，但也存在其他形式（特别是蓝色/黄色和单色），因此总的来说，重要的是保持高对比度。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-06T09:47:57.767

除了绿色+红色，另一种比较常见的色盲是蓝色和黄色。

我们在创建游戏时会考虑色盲。我们设计的一款游戏（Arcade Lines）以彩色球为特色，您必须在相同颜色的行中对齐。我们试图通过为色盲人提供一种特殊的皮肤来解决色盲问题，这种皮肤不仅具有不同的颜色，而且具有不同的形状（每种颜色一个形状）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-06T09:48:29.110

我可以向你推荐[这个](http://colorschemedesigner.com/)网站。它有一个配色方案选择器，在它的右下角有一个下拉菜单，用于在常见的眼睛相关问题之间切换并相应地更改方案

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-06T09:54:43.980

其实我从来没有想过这个。但是现在回想起来，我不记得我的应用程序也依赖于颜色的任何情况。文本几乎总是白色或黑色（尽管有时使用红色或绿色），背景颜色相当苍白，主要是为了一些视觉效果，而不是信息。不过，我现在会记住这一点。让网页具有高对比度并不难。:)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-06T09:55:11.980

红绿色可能是最常见的，但不是唯一的颜色缺陷类型。

一般来说，您的用户界面在被视为灰度或棕褐色调时应该仍然可见且可用。文本和背景必须具有高对比度，以允许仅通过色调而不是颜色来区分形状。

涉及颜色而不是独特的艺术/图标的视觉元素可以伴随着文本，以提供关于它们所代表的内容的更详细描述。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-08-03T01:49:43.117

Color Oracle 是一个很棒的工具，可以模拟不同类型的色盲。你可以运行你的应用程序/网站，然后运行这个应用程序——它会让你很好地了解色盲用户将如何解释你的创作。

[http://colororacle.cartography.ch/](http://colororacle.cartography.ch/)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-08-05T13:52:23.403

当我告诉我的同事按下红色按钮时，我很难发现这一点。当他说“哪个？” 我以为他只是昏暗，所以我再次告诉他.. 然后他告诉我他是色盲，我是那个觉得愚蠢的人。

他现在在铁路工作，编写信号软件。干得好，红灯永远是最重要的:)

那么你必须考虑色盲吗？可能不是，就像您不设计屏幕来支持大字体一样，但如果您想做得真正好而不是大多数可接受的工作，您应该这样做。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-04-12T23:56:17.707

我曾经写过一个内部应用程序，其中有一个散点图，其中有不同的系列，以颜色区分。我的主要用户原来是色盲（我认为是红绿色），所以我用符号的变化来补充颜色。

# nhibernate - CreateCriteria 和 MONTH

> ID：519699
> 
> 赞同：1
> 
> 时间：2009-02-06T09:44:04.000
> 
> 标签：nhibernate, criteria

是否可以在 CreateCriteria 语句中使用 MONTH？

NHibernate 是否支持 YEAR 和/或 MONTH？

我有一个 sql 语句，例如 select obs2.Lopnr from Obs obs2 where MONTH(obs2.Datum)=11)

最好的问候

垫子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T21:28:57.690

ICriteria 支持[任意 SQL 作为限制](http://nhforge.org/doc/nh/en/index.html#querycriteria-narrowing)。因此你可以这样做：

```
var criteria = session.CreateCriteria(typeof(Obs))
    .Add(Expression.Sql("MONTH({alias}.Datum) = ?", 11, NHibernateUtil.Int32);
var results = criteria.List<Obs>(); 
```

这将执行一个 SQL 查询，将 {alias} 替换为 NHibernate 用于 Obs 表的别名。当然，这限制了您对其他数据库的可移植性，因为 SQL 现在嵌入在您的查询中。

要记住的另一件事是，您在此处使用的名称是映射的属性和类名称，而不是基础列和表名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T16:20:09.707

我不相信在标准声明中这是可能的。HQL 查询支持日期函数（年、月、日），因此它们可以以这种方式使用。

# gridview - 网格视图的行数据绑定后触发按钮单击事件

> ID：519703
> 
> 赞同：1
> 
> 时间：2009-02-06T09:45:22.063
> 
> 标签：gridview, paging, custompaging

当我在我的 asp.net 页面中单击 GridView 之外的按钮时，GridView rowdatabound 事件在按钮的 OnClick 事件之前被触发。我正在使用按钮进行自定义分页，所以我需要颠倒这些事件的顺序。有什么想法吗 ？？

提前致谢，-阿米特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T10:00:59.147

可能是因为您在事件中调用`DataBind()`了 GridView 。`Page_Load`您应该注意，`Page_Load`将始终在引发回发的事件之前调用...`Button_Click`在您的情况下。

我建议阅读[ASP.NET 页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472.aspx)以了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T18:16:25.877

也许你的gridview`enableviewstate = false`

# delphi - 如何将 tiff 图像与 Delphi 合并？

> ID：519709
> 
> 赞同：1
> 
> 时间：2009-02-06T09:46:49.690
> 
> 标签：delphi, bitmap, tiff

我有 4 个小 tiff 图像，我想通过合并 4 个单个图像来生成一个大图像。有谁知道如何直接使用 Delphi 或一些可以做到的好的组件来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T09:57:06.283

您可以使用 Mike Lischke 的 GraphicEx 加载 Tiff 图像：
[http ://www.soft-gems.net/index.php?option=com_content&task=view&id=13&Itemid=33](http://www.soft-gems.net/index.php?option=com_content&task=view&id=13&Itemid=33)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T15:03:13.000

[ImageMagick](http://www.imagemagick.org/script/index.php)是一个命令行应用程序，可以对包括 tiff 在内的不同图像文件格式执行此类操作。

该 API 似乎可以从 Delphi 使用，请参阅[PascalMagick](http://www.imagemagick.org/script/api.php#pascal)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T10:03:29.360

Delphi 另一个优秀的图形库是[Graphics32](http://graphics32.org)

**编辑：**正如 Vegar 所说，看起来 Graphics32 不能用于加载 TIFF 格式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T20:23:26.253

您可以使用的另一个库是[FreeImage](http://freeimage.sourceforge.net/ "免费图片")。它支持加载和写入 TIFF 文件。注意：Delphi 包装器没有得到积极维护，但它可以工作。我们在我们的软件中使用它来显示图像的预览。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-07T10:31:46.867

[ImageEn](http://www.hi-components.com/nimageen_screenshot.asp)是 Delphi 最好的图像库之一，它是本机 VCL ;-)

# apache-flex - 如何在 swfloader 中播放 youtube 视频？

> ID：519710
> 
> 赞同：1
> 
> 时间：2009-02-06T09:46:55.803
> 
> 标签：apache-flex, video, air, youtube

我在我的空中应用程序中嵌入了一个 youtube 视频。它加载并播放得很好，但我一次不能播放多个视频，当时只能播放一个视频，你知道为什么吗？代码是：

```
url:String = "http://in.youtube.com/v/fVGk5qm6Mac&hl=en&fs=1";    
             //texturl.text=url;
            swfloader.load(url) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T21:18:52.913

您应该能够做到这一点，但就像 Christophe 提到的那样，您需要为每个要同时显示的视频创建一个 SWFLoader 实例。如果您想一个接一个地播放视频，您可以使用相同的 SWFLoader 来执行此操作。等到视频播放完毕，然后再加载新的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T11:32:46.527

我不确定，但我想如果您为要播放的每个视频创建单独的 SWFLoader 实例，那应该不是问题。如果您使用的是 1 个或多个 SWFLoader 对象，则很难从您提供的代码中分辨出来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-25T03:29:58.877

也许这会有所帮助

[示例 Youtube 到 Flex 应用程序](http://www.brentlamborn.com/examples/Flex_youtube/srcview/index.html)

# linux - 在不传输整个文件的情况下读取远程文件的块？

> ID：519719
> 
> 赞同：1
> 
> 时间：2009-02-06T09:50:10.900
> 
> 标签：linux, file, unix

是否可以通过任何 Unix 实用程序来读取远程文件的块（比如说'head'）而不是传输整个文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T09:52:30.303

您可以通过 SSH 执行远程命令

```
ssh user@server.com "head <filename>" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T09:59:19.850

1.  您可以远程提取文件的有趣部分（例如使用*dd*），然后将有趣的块传输回来。
2.  其他选择是使用 netcat：

    ```
    dd if=file skip=... bs=... count=...| nc <host> <port> 
    ```

    在接收器上：

    ```
    nc -l -p <port> | dd of=chunk 
    ```

3.  您可以将*curl*与以下选项一起使用（假设您有支持搜索的 HTTP 或 FTP）：

    *   *-r*检索字节范围
    *   *-C*从给定的偏移量开始下载

除了上面提到的之外，当然还有其他可能性。有关您的案例的更多信息可能有助于设计更智能的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T10:01:33.170

如果您了解 Python，paramiko 库应该使这相当容易做到。它是 ssh 协议的纯 Python 实现，特别是 sftp 应该允许您获取所需文件的一部分。

有关详细信息，请参阅[http://www.lag.net/paramiko/](http://www.lag.net/paramiko/)。

# java - 将 MVP 模式应用于 JDialogs

> ID：519725
> 
> 赞同：3
> 
> 时间：2009-02-06T09:52:03.487
> 
> 标签：java, swing, design-patterns, mvp

我正在编写一个 Swing 应用程序，对于[我之前的问题](https://stackoverflow.com/questions/496233/what-are-your-best-swing-design-patterns-and-tips)，我决定使用[Model-View-Presenter](http://en.wikipedia.org/wiki/Model_View_Presenter)模式将用户界面与业务逻辑分开。

当我的应用程序启动时，它会执行以下代码：

```
Model model = new BasicModel();
Presenter presenter = new Presenter(model);
View view = new SwingView(presenter);
presenter.setView(view);

presenter.init(); 
```

它创建了用户界面。事件由 生成`View`，并委托给`Presenter`。然后`Presenter`操作`Model`并相应地更新`View`。

为了处理一些事件，我需要从用户那里获取更多信息。对于这些事件，我认为 Swing 视图生成一个新`JDialog`窗口是合适的。

一种思路让我觉得这可能是原始代码中的合适代码`Presenter`：

```
public void handlePreferences() {
    Preferences prefs = view.getPreferences();
    model.setPreferences(prefs);
} 
```

也就是说，每个的内容`JDialog`应该代表一个不同的对象，该对象应该从 中检索`View`并在 中更新`Model`。然而，这留下了一个问题：我是否创建一个新`Model`的来表示`Preferences`对象和一个新`Presenter`的用于事件处理`JDialog`？

在我看来，创建一个新的`Presenter`和`Model`内部的`View`，例如，如果我想更改 UI 以使用 JSF，我不得不做很多更难移植的工作。

请随时添加评论以进行澄清。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-13T11:34:03.980

尽管具有“嵌套”设计模式并不少见，但在您的情况下并不是必需的。借鉴其他答案：

**模型**
 - 包含所有真实数据、变量、对象
 - 知道如何将其存储的数据值设置为新值
 - 响应命令（方法调用）
 - 具有方法 setPreferences(value1,value2,value3...);

**View**
 - 是应用程序的 IO，只是输出和输入
 - 它只能在自己的状态下工作
 - 它维护局部变量和对象，例如。它有 JButtons、JMenus、int 计数器 ...
 - 它知道如何通知 Presenter 状态更改
 - 它的状态对 Presenter 可见，或通过方法调用显示
 - 响应命令（方法调用）
 - 知道如何获取来自用户的偏好
 - 有方法 askForPrefs();
 - 有方法 getPrefState();

**Presenter**
 - 响应状态变化
 - 做所有决定，它告诉其他对象做什么（而不是如何做）
 - 知道什么时候需要偏好
 - 知道在哪里获得新的偏好以及把它们放在哪里
 - 有方法 newPrefsAvailable( );

> ...从用户那里获取更多信息。对于这些事件，我认为 Swing 视图生成一个新的 JDialog 窗口是合适的。

Presenter - 检查模型，确定需要新的首选项
Presenter - this.myView.askForPrefs(); //告诉视图向用户询问首选项值
View.askForPrefs - 弹出一个 JDialog 框，将 retVals 作为状态更改存储在视图中
View - this.myPresenter.newPrefsAvailable();
演示者 - 以 this.myModel.setPreferences (this.myView.getPrefState()) 响应；
Model.setPreferences - 将存储的值更改为 View.getPrefState()
Presenter - 检查模型 - 确定首选项是好的
Presenter - 继续

JDialog 被视为只是 View 的扩展，它是 View 的成员，就像 JButton 一样。模型具有权威的实际偏好值，视图具有表示 JDialog 状态的局部变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T16:23:34.507

我的建议是从根本上考虑这些“偏好”是什么。它们是底层业务逻辑的一部分吗？如果是这样，那么它们应该是模型结构的一部分。他们是否指定了用户与业务数据交互的首选方式？那么它们应该是视图的一部分。这似乎是理论上的，但根据我的经验，它最终可以省去很多麻烦。

如果你不能解决这个问题，那么保存偏好的位置会给你另一个线索。如果它们需要与被操作的数据一起保存，那么它们可能是业务逻辑的一部分。如果它们保存在用户的个人偏好文件中，那么它们不是，应该被视为视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T21:47:45.280

不，你不需要另一个“模型”只是为了偏好

只需在 JDialog 的构造函数中将演示者和模式作为参数传递。编写大型 Swing 应用程序时更容易

*   1 款
*   1 个控制器（它本身可能包含较小的控制器）
*   多个视图（但在相同的数据/模型类上）

请注意，1 个模型！= 1 个类。Swing 应用程序的“模型”实际上可以是具有共同“根”的独立“模型”类的“树”。

所以在你的情况下你需要

“全局”模型 ->（包含）“首选项”模型。

# xml - 日期时间类型

> ID：519727
> 
> 赞同：0
> 
> 时间：2009-02-06T09:53:33.780
> 
> 标签：xml, datetime, types

我已经存储了这种日期时间： 06.09.2009 12:30:45 。我一直在使用 xml 数据存储类型。我在 xml 文件中设置了“06.09.2009 12:30:45”。“06.09.2009 12:30:45”有数据类型吗？还是日期时间类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T09:59:53.953

XML 定义了多种与日期相关的原始类型，以[dateTime开头](http://www.w3.org/TR/xmlschema-2/#dateTime)

# .net - LinkedList(T) 添加方法

> ID：519732
> 
> 赞同：1
> 
> 时间：2009-02-06T09:55:02.917
> 
> 标签：.net, interface, explicit-interface

[ICollection(T)](http://msdn.microsoft.com/en-us/library/92t2ye13.aspx)接口的 Add-method已由[LinkedList(T)-](http://msdn.microsoft.com/en-us/library/he2s3bh7.aspx)类显式实现。这个集合反而有 AddFirst- 和 AddLast- 方法（等等）。显式实现的方法映射到 AddLast 方法。这有一些缺点，恕我直言，根本没有好处。两个主要缺点是：

1.  您不能在 LinkedList(T) 上使用集合初始化，因为它需要添加方法。
2.  如果您在方法中使用了一个 List(T) 并希望将其更改为使用 LinkedList(T) ，则必须将所有对 Add 的调用更新为调用 AddLast 。

我的想法是，你**永远不**应该显式地实现接口成员，除非当你知道具体类型时它们根本没有意义。例如，如果您正在实施只读 ICollection(T)，则应显式实施（并有效隐藏） Add-method。

是否还有其他不应该在框架中明确实现的方法示例？

附带说明：要解决第二个问题，您可以为 LinkedList(T) 类创建一个扩展方法“Add”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T10:01:59.177

该`Add`方法会模棱两可，因此我对显式实现感到满意...

`Queue[<T>]`并`Stack[<T>]`有类似的行为。

对于其他（非收藏）好奇的显式成员 -[`DbParameter.Precision`](http://msdn.microsoft.com/en-us/library/bb357455.aspx)和[`DbParameter.Scale`](http://msdn.microsoft.com/en-us/library/bb346921.aspx).

重新在两者之间转移问题 - 你总是可以`ToLinkedList<T>`在`IEnumerable<T>`.

或者 -`AddRange<T>`扩展方法有很长的路要走......

```
static void Main()
{
    var list = new LinkedList<int>();
    list.AddRange(1, 2, 3, 4, 5);
}
static void AddRange<T>(this ICollection<T> list, params T[] values)
{
    foreach (T value in values)
    {
        list.Add(value);
    }
} 
```

（**编辑**）如果您希望能够将其用作单个表达式，您也可以使用“流利的”API：

```
static void Main()
{
    var list = new LinkedList<int>().AddRange(1, 2, 3, 4, 5);
    // `list` is correctly a LinkedList<int> here
}
static TCollection AddRange<TCollection, TValue>(
    this TCollection collection, params TValue[] values)
    where TCollection : ICollection<TValue>
{
    foreach (TValue value in values)
    {
        collection.Add(value);
    }
    return collection;
} 
```

# ms-word - 将按钮插入 Word 文档

> ID：519737
> 
> 赞同：1
> 
> 时间：2009-02-06T09:58:07.030
> 
> 标签：ms-word, ms-office

是否可以在 word 文档中插入一个按钮并在单击此按钮时调用宏。如果您有任何类似的想法以及执行此操作的程序，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T10:08:56.587

您需要使用 VBA 来执行此操作，但这非常简单。

有一篇[MS 知识库文章](http://support.microsoft.com/kb/246299)准确描述了您想要做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T10:08:31.253

可以在 Word 文档中插入命令按钮（以及其他一些控件，如单选按钮等）。单击工具栏并启用 Visual basic。您将获得所有控制框，选择命令按钮。您可以将代码写入 VBA 脚本中。这将在单击命令按钮时执行。

# c# - 与不同的用户代理保持相同的会话

> ID：519740
> 
> 赞同：0
> 
> 时间：2009-02-06T09:58:40.867
> 
> 标签：c#, flash, session, user-agent, ashx

有没有办法在不同的用户代理上使用相同的会话。我有一个 Flash 应用程序，它在将数据发布到 myHandler.ashx 时生成一个新的会话 id（同样发生在 aspx 上）。我在这里错过了一个技巧吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T10:07:17.573

我没有使用 c# 或类似的经验，但是在使用 amfphp 进行远程处理时，您有时需要在调用中手动提供 session_id 变量，因为服务器会出于某种原因将您视为两个不同的用户，即使这一切都在经历同一个浏览器。

通常，最简单的方法是在加载时为您的 swf 提供 flashvar 中的 id。这将要求您在 html 源代码中打印 session_id，这并不理想，但这并不是什么大不了的事，因为无论如何它都可以很容易地被嗅探。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T10:08:53.763

似乎通过 flash var 传递会话 ID 似乎很常见。我自己没有这样做，但是使用这些键进行快速谷歌搜索似乎找到了一些有希望的结果：保持会话数据闪烁

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-08T10:05:52.257

看看[swfupload](http://swfupload.org/)及其在 ASP.Net 中的实现——他们使用`Global.asax`hack 来保持相同的会话。

# cocoa - NSOutlineView - 自动展开所有节点

> ID：519751
> 
> 赞同：29
> 
> 时间：2009-02-06T10:04:28.950
> 
> 标签：cocoa, nsoutlineview

我有一个`NSOutlineView`绑定到一个`NSTreeController`（如果有区别的话），我想扩展我的`-awakeFromNib()`.

我还想同时以编程方式选择第一个节点的第一个子节点。这些事情对于表格视图来说很简单，但大纲根本不适合我。

谢谢，

富有的

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-02-06T10:16:13.750

> 我想扩展我的 -awakeFromNib() 中的每个节点。

从 Mac OS X 10.5 开始，`[outlineView expandItem:nil expandChildren:YES]`.

在以前版本的 Mac OS X 中，您需要从 0 迭代到行数，使用 获取每行的项目`[outlineView itemAtRow:row]`，并将这些项目存储到数组中，然后迭代数组并将每个项目传递给`expandItem:expandChildren:`方法。（您不能混合这两个循环，因为展开一个项目及其所有后代将更改其后续兄弟的行索引；因此，您必须先收集所有顶级项目，然后在拥有所有项目后展开它们。 )

> 我还想同时以编程方式选择第一个节点的第一个子节点。

在上述之后，它将是第 1 行。

大纲视图是一种表格视图，因此您将使用 NSTableView 的方法之一：`[outlineView selectRowIndexes:[NSIndexSet indexSetWithIndex:1] byExtendingSelection:NO]`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-10-23T16:45:51.237

如果您从数据源加载，

```
dispatch_async(dispatch_get_main_queue(), ^{
  [self.outlineView expandItem:root expandChildren:YES];
}); 
```

# java - 方法签名中的Java“参数”？

> ID：519752
> 
> 赞同：114
> 
> 时间：2009-02-06T10:04:31.883
> 
> 标签：java, variadic-functions, params, method-declaration

在 C# 中，如果您希望方法具有不确定数量的参数，您可以将方法签名中的最后一个参数设置为 a `params`，以便方法参数看起来像一个数组，但允许使用该方法的每个人传递尽可能多的该类型参数如来电者所愿。

我相当确定 Java 支持类似的行为，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2009-02-06T10:06:25.703

在 Java 中它被称为[varargs](http://java.sun.com/j2se/1.5.0/docs/guide/language/varargs.html)，语法看起来像一个常规参数，但在类型后面有一个省略号（“...”）：

```
public void foo(Object... bar) {
    for (Object baz : bar) {
        System.out.println(baz.toString());
    }
} 
```

vararg 参数必须*始终*是方法签名中的**最后一个**参数，并且就像您收到该类型的数组一样被访问（例如`Object[]`，在这种情况下）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-06T10:07:18.197

这将在 Java 中解决问题

`public void foo(String parameter, Object... arguments);`

您必须添加三个点`...`，并且`varagr`参数必须是方法签名中的最后一个。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-03-31T12:46:59.983

正如之前的答案所写的那样，它是`varargs`用`ellipsis`( **...** )声明的

此外，您可以传递值类型和/或引用类型或两者混合（谷歌**自动装箱**）。此外，您可以将方法参数用作数组，如下面的`printArgsAlternate`方法所示。

## 演示代码

```
public class VarargsDemo {

    public static void main(String[] args) {
        printArgs(3, true, "Hello!", new Boolean(true), new Double(25.3), 'a', new Character('X'));
        printArgsAlternate(3, true, "Hello!", new Boolean(true), new Double(25.3), 'a', new Character('X'));
    }

    private static void printArgs(Object... arguments) {
        System.out.print("Arguments: ");
        for(Object o : arguments)
            System.out.print(o + " ");

        System.out.println();
    }

    private static void printArgsAlternate(Object... arguments) {
        System.out.print("Arguments: ");

        for(int i = 0; i < arguments.length; i++)
            System.out.print(arguments[i] + " ");

        System.out.println();
    }

} 
```

## 输出

```
Arguments: 3 true Hello! true 25.3 a X 
Arguments: 3 true Hello! true 25.3 a X 
```

# vim - 如何在 Vim 中以另一种语言的源代码中嵌入的一种语言的代码片段语法高亮显示？

> ID：519753
> 
> 赞同：20
> 
> 时间：2009-02-06T10:04:42.523
> 
> 标签：vim, syntax-highlighting, vim-syntax-highlighting

我有一个自定义 XML 文件格式，它可以在某些标签中包含代码块。

例如：

```
<Root>
    <Sql> select * from foo </Sql>
    <MoreJunk> ... </MoreJunk>
    <Python><![CDATA[
    def Bar(*args):
        return False
    ]]></Python>
</Root> 
```

如何让 Vim 对标签内的文本使用 SQL 语法高亮显示，并对`<Sql>`标签内的文本使用 Python高亮显示`<Python>`？

我知道 Vim 已经可以做到这一点，因为它正确地突出了 HTML 文件中的 Javascript。

我尝试检查 HTML 语法文件，但无法弄清楚。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-06T10:44:39.387

对于带有 python 的 XML 示例，您必须执行以下操作：

```
runtime! syntax/xml.vim
unlet b:current_syntax
syntax include @Python syntax/python.vim
syntax region pythonCode  start=+<Python>+ keepend end=+/</Python>+  contains=@Python 
```

这些行将包括 XML 语法和 Python 语法，并指定一个 Python 区域，VIM 将在其中使用 Python 语法而不是 XML 语法...

当然，所有这些在 VIM 中都有很好的记录。请参阅*:he :syn-include*了解如何包含语法文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T10:11:17.517

本[文档](http://vimdoc.sourceforge.net/htmldoc/usr_44.html)描述了如何编写自己的语法高亮。您应该能够弄清楚 HTML 语法突出显示如何与 javascript 一起工作，并以此作为参考。

# c# - 在 Resharper 中为对象和数组初始化程序获取正确的缩进

> ID：519755
> 
> 赞同：46
> 
> 时间：2009-02-06T10:05:59.057
> 
> 标签：c#, visual-studio, coding-style, formatting, resharper

现在 resharper 像这样格式化我们的代码：

```
private readonly List<Folder> folders = new List<Folder>
                                        {
                                            new Folder()
                                        }; 
```

但我希望它看起来像这样：

```
private readonly List<Folder> folders = new List<Folder>
{
    new Folder()
}; 
```

我一直在搞乱这些选项，但似乎无法让它们正确。你能帮我吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-02-06T10:33:37.037

我对匿名代表也有同样的问题。匿名委托格式的修复在[这里](http://blog.excastle.com/2007/02/07/resharper-day-7-code-formatting/)：

> 我终于找到了解决这个问题的方法。用于格式化匿名方法的选项分布在 ReSharper 选项中的两个单独页面：大括号布局和其他。“不要缩进荒谬的数量”在Other页面上，它被称为“缩进匿名方法体”。将其关闭，并将大括号选项设置为“行尾”，您会得到更好的结果：

但恐怕我不确定实例声明集合格式。:(

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-12-24T16:39:11.543

我今天刚和这个吵架。转到 ReSharper\Options\Languages\C#\Formatting Style\Other

滚动到列表底部并取消选中“缩进数组、对象和集合初始化程序块”

这对我有用。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-09-17T09:23:21.510

我还必须取消选中 ReSharper\Options\Languages\C#\Formatting Style\Other --> Align Multiline Constructs 并取消选中“数组、对象和集合初始化程序”以及此处提供的其他答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-30T21:23:56.450

对于 R# 8，在 Options -> Code Editing -> C# -> Formatting Style -> Braces Layout -> Array and object initializer 中有一个专门用于此目的的设置。

“在下一行（BSD 风格）”是该线程要求的。

# jboss - 在 JBoss 4.0.5 中声明一个 JNDI 变量

> ID：519761
> 
> 赞同：3
> 
> 时间：2009-02-06T10:08:12.470
> 
> 标签：jboss, jndi

我想在 JBoss 4.0.5 服务器中声明一个新的 JNDI 变量。有人可以解释一下如何做到这一点吗？

等待您的回复。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-13T06:43:21.797

找到这两个可以帮助的链接...

在 $CATALINA_BASE$/deploy 目录下创建一个名为 filename-service.xml 的文件，其内容如这些链接中所示

[http://www.redhat.com/docs/manuals/jboss/jboss-eap-4.2/doc/Server_Configuration_Guide/Additional_Naming_MBeans-JNDI_Binding_Manager.html](http://www.redhat.com/docs/manuals/jboss/jboss-eap-4.2/doc/Server_Configuration_Guide/Additional_Naming_MBeans-JNDI_Binding_Manager.html)

检查 jboss jira，JBPAPP-2809 以在 xmlns:jndi 中进行更正

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-13T03:01:02.363

我今天也面临这个问题。看起来想在应用服务器上添加一个简单的 jndi 条目，在 JBoss 中必须创建一个新文件 $CATALINA_BASE/conf/context.xml 并调用 MBean 来添加变量及其值。

在像 websphere 这样的服务器中，您可以在 jndi.properties 中传递新值，这是 jboss 5.0.0 以上不喜欢的。

非常糟糕的是，在 jboss/docs 中绝对没有任何文档表明该主题的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T10:52:19.760

看看[这里](http://docs.jboss.org/jbossas/guides/j2eeguide/r2/en/html/ch3.chapter.html)，特别是[这里](http://docs.jboss.org/jbossas/guides/j2eeguide/r2/en/html/ch3.chapter.html#ch3.j2ee)。您需要在应用程序的 ejb-jar.xml 文件中添加一个条目。

# c# - SQL Server (2008) 将 ArrayList 或字符串传递给 SP 用于 IN()

> ID：519769
> 
> 赞同：2
> 
> 时间：2009-02-06T10:11:56.190
> 
> 标签：c#, asp.net, sql, sql-server, database

我想知道如何将 ArrayList、List `<int`> 或 StringBuilder 逗号分隔列表传递给存储过程，以便使用 IN() 找到 ID 列表：

```
@myList varchar(50)

SELECT  *
FROM    tbl
WHERE   Id IN (@myList) 
```

在 C# 中，我目前正在将列表构建为逗号分隔的字符串；但是，例如，当使用 nvarchar(50) 作为存储过程中参数的类型时 - 我收到一个错误，因为它无法将“1,2,3”转换为它在 IN() 之间期望的 int。

有任何想法吗？非常感激。
皮特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T10:23:36.590

您可以使用用户定义的功能，例如

```
CREATE function [dbo].[csl_to_table] ( @list nvarchar(MAX) )
RETURNS @list_table TABLE ([id] INT)
AS
BEGIN
    DECLARE     @index INT,
            @start_index INT,
            @id INT

    SELECT @index = 1 
    SELECT @start_index = 1
    WHILE @index <= DATALENGTH(@list)
    BEGIN

        IF SUBSTRING(@list,@index,1) = ','
        BEGIN

            SELECT @id = CAST(SUBSTRING(@list, @start_index, @index - @start_index ) AS INT)
            INSERT @list_table ([id]) VALUES (@id)
            SELECT @start_index = @index + 1
        END
        SELECT @index  = @index + 1
    END
    SELECT @id = CAST(SUBSTRING(@list, @start_index, @index - @start_index ) AS INT)
    INSERT @list_table ([id]) VALUES (@id)
    RETURN
END 
```

它接受一个 nvarchar 逗号分隔的 id 列表，并将这些 id 的表作为整数返回。然后，您可以像这样在存储过程中加入返回的表 -

```
DECLARE @passed_in_ids TABLE (id INT)

INSERT INTO @passed_in_ids (id)
  SELECT 
    id 
  FROM
    [dbo].[csl_to_table] (@your_passed_in_csl)

SELECT *
FROM 
myTable
INNER JOIN
@passed_in_ids ids
ON
myTable.id = ids.id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T10:28:58.840

在 SQL 2008 中，有表值参数，它是解析 CSV 的友好替代方案；看这里的[例子](http://www.stephenforte.net/PermaLink,guid,07dfeb00-d0b0-47dd-9761-3b4c9f160277.aspx)。

否则，另一种选择是 xml - `xml`SQL Server 中的数据类型使您可以很容易地读取它（尽管它需要更多的传输字节）。

# c# - 在 .net (C#) windows 应用程序中从条形码扫描仪读取数据！

> ID：519771
> 
> 赞同：13
> 
> 时间：2009-02-06T10:15:03.907
> 
> 标签：c#, barcode

如何在 .net windows 应用程序中从条形码扫描仪读取数据？

有人可以给出要遵循的步骤顺序吗？我对此很陌生。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-06T10:34:35.677

查看扫描仪插孔。

如果它看起来像这样：

![](https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/MiniDIN-6_Connector_Pinout.svg/455px-MiniDIN-6_Connector_Pinout.svg.png)

，那么它就是一个`keyboard wedge`扫描仪。它就像一个键盘：只需在编辑字段中输入您的条形码。

如果它看起来像这样：

![](https://upload.wikimedia.org/wikipedia/commons/thumb/f/f7/DE9_Diagram.svg/337px-DE9_Diagram.svg.png)

，它是一个`serial port`扫描仪。

您需要创建一个实例[`System.IO.Ports.SerialPort`](https://docs.microsoft.com/en-us/dotnet/api/system.io.ports.serialport?redirectedfrom=MSDN&view=netframework-4.8)并使用它与扫描仪进行通信。

如果它看起来像这样：

[![](https://i.stack.imgur.com/ZepI7.gif)](https://i.stack.imgur.com/ZepI7.gif)
[（来源：[datapro.net](https://www.datapro.net/connectors/USB-A.gif)）]

，它是一个`USB`扫描仪。从程序员的角度来看，它可以是扫描仪，也可以`keyboard wedge`是`serial port`扫描仪。您需要查看手册，找出它并使用上述方法之一。

PS 如果你把你的扫描仪模型贴在这里会更容易，真的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T11:31:57.653

我现在使用连接到我的几个 winform（和 1 个控制台）应用程序的 Wasp USB WCS3905 条形码扫描仪，尽管没有注意到与其他品牌的 USB 扫描仪的差异。

当一个新的出现时，我总是测试的方式是启动记事本并从手头的所有东西上扫描大量代码；书籍、DVD、资产标签，但最重要的是我需要跟踪的库存。这将允许您可视化如何捕获数据。

根据我的经验，它们都像用户在键盘上连续键入每个字符，然后按“Enter”键。

对于在文本框控件中扫描的每个字符（注意：不完整的条形码），然后至少触发以下事件：
KeyDown
KeyPress
TextChanged
KeyUp

扫描结束时的 Enter 键击可用于按下表单的 AcceptButton

应该注意的是，我只在英式和美式配置的 Windows 系统上使用了这些。

G-

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-06T10:21:28.840

大多数现代条码扫描仪的作用就像键盘一样。

我之前用 C# 编写过用于扫描票证的代码 - 无需特殊技巧，只需确保输入焦点在合适的文本框中并扫描代码即可！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T14:35:38.360

如果您使用的是键盘楔子，通常设备或楔子软件允许在键盘流中添加额外字符的前缀和/或后缀。

可以使用每个表单的键预览来“侦听”前缀和后缀字符 - 当截取类似于条形码的内容时，可以将条形码文本发送到正确的编辑框或用于弹出对话框。

如果您要设置自己的编码系统，根据条码类型，您还可以在条码中嵌入特殊字符以识别正在扫描的内容，例如，以 SB^ 开头的扫描表示对库存箱的扫描。

使用键盘楔时，通常无法确定正在扫描哪种类型的条码 - 有时格式可以很方便地确定内容。

# html - 在 HTML 中裁剪图像的最佳方法是什么？

> ID：519774
> 
> 赞同：10
> 
> 时间：2009-02-06T10:16:33.187
> 
> 标签：html, css

在 HTML 中裁剪图像的最佳方法是什么？

这将类似于以下内容：

```
<img src="something.gif" x1="10" y1="10" x2="20" y2="20"> 
```

如果这不起作用，那么我将使用 GIMP。关于如何让它以编程方式工作的任何想法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-06T10:19:08.593

这就是所谓的精灵，你可以阅读[A List Apart](http://www.alistapart.com/articles/sprites/)的这篇精彩文章。

最后归结为：

```
#panel2b {
    width:50px;
    height:30px;
    background: transparent url(test-3.jpg) -96px -200px no-repeat;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T09:12:00.917

如果你有很多切片，你也可以使用[这个基于 Web 的 CSS Sprite Generator 之](http://spritegen.website-performance.org/)类的工具来创建更大的图像。

[有人在[我的类似问题](https://stackoverflow.com/questions/527336)上将我引向你的]。

# c# - 破解你自己的应用程序

> ID：519781
> 
> 赞同：7
> 
> 时间：2009-02-06T10:19:18.827
> 
> 标签：c#, security, testing, cracking

我是一名非常注重安全性的 Web 开发人员，并尝试使我的 Web 应用程序尽可能安全。

我是如何开始用 C# 编写自己的 Windows 应用程序的，而在测试 C# 应用程序的安全性时，我真的只是一个新手。

只是想知道是否有人有任何关于如何破解自己的 Windows 应用程序和编写安全代码的好的教程/自述文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T10:29:03.537

Michael Howard 的书是一个很好的起点。

*   [软件安全的 19 大罪](http://www.amazon.co.uk/Deadly-Sins-Software-Security-Programming/dp/0072260858/ref=sr_1_1?ie=UTF8&qid=1233915797&sr=8-1)（附有多种语言的示例）
*   [编写安全代码](http://www.amazon.co.uk/Writing-Secure-Second-Michael-LeBlanc/dp/0735617228/ref=sr_1_1?ie=UTF8&s=books&qid=1233915846&sr=1-1)

[这里](http://blogs.msdn.com/michael_howard/default.aspx)有大量来自 Michael Howard 博客的链接和有趣的文章

[Microsoft 有一个关于威胁评估、风险和 ASP的](http://download.microsoft.com/download/d/9/a/d9abfa8d-2207-4827-9e15.../Writing%20Secure%20Code%20--%20Best%20Practices.ppt)有趣的幻灯片演示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T10:24:23.437

除了防止缓冲区溢出、代码注入、会话劫持等所有明显的答案。人。您应该找其他人检查您的代码/软件，因为您只能考虑破解您知道如何防止的软件的方法。只是因为您找不到破解自己软件的方法，但这并不意味着其他人也可以。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T10:43:52.053

这是你很难做到的事情，我认为你是从错误的角度来解决问题的。如果您正在编写任何规模的应用程序，那么通过寻找破坏您自己软件的特定方法来尝试最终处理安全性几乎是不可能的。

这是出于多种原因。您已经以某种方式考虑您的软件。您会想到与它交互的特定方式，并且知道如何从中获得最大收益。您不会从利用它的方式来考虑它，而这对于您非常熟悉的软件来说是一件很难的事情。

另一个问题是此时的任务太大而无法处理。您发现的任何问题都可能引发许多其他问题。系统范围的安全检查远远不够精细。

您应该做的是在编写软件时考虑安全性。学习最佳实践，并从安全角度考虑您编写的每个方法和类。这与单元测试密切相关，尝试考虑哪些输入可能会使我的程序的这个特定部分中断。然后在那个级别处理他们。

在那之后，我认为这是快速响应您意识到的任何安全问题的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T10:50:26.487

你可以做的比阅读罗斯安德森的[安全工程](http://www.cl.cam.ac.uk/~rja14/book.html)书更糟糕。第一版可作为 PDF 下载，值得阅读。我还没有读过第二版，但我怀疑它更好，而且里面有更多的好东西。

请注意，这本书解释了如何从一开始就建立安全性，而不是如何破坏安全性，但对各种安全错误的阐述应该让您对从哪里开始寻找一个好主意。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T12:43:42.173

我通过自己的经历遇到的小事情。

*   不要使用动态 SQL，否则您很容易受到 SQL 注入的攻击。而是使用带参数的 SQL 查询。
*   没有像 user_id = 1、2、3 等这样的递增 id，然后在 URL 中使用它，something.aspx?user_id=1，然后我可以猜测下一个 id 和会话希望。帐户也是如此，其他敏感的东西也是如此。
*   注意 XSS（跨站点脚本）。如果您接受用户输入并直接存储它，请确保他们不能为他们的名字或其他内容插入 alert()。

这绝不是一个完整的列表。只是我最近遇到的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T10:25:27.007

为了保护您的 win 表单应用程序，请打开它并尝试做 lambda 用户不应该做的所有事情！我会解释：

如果您“说输入`yes`或`no`”，请尝试使用 AZ，0-9，因为这是一些用户试图找到一些可能有趣的堆栈跟踪所做的事情。所以把验证器放在任何地方。

注意与数据库的连接，但如果您来自网络开发人员，您应该比我更清楚:)。

最难的部分是注意内存泄漏或类似的事情，但这是在大型应用程序或开发不完善的应用程序中。

# algorithm - 我应该使用什么作为基数 31 值的校验位算法？

> ID：519787
> 
> 赞同：4
> 
> 时间：2009-02-06T10:21:54.440
> 
> 标签：algorithm, checksum

我正在使用以下一组值来创建一个 9 字符长的 base 31 值：
0123456789ABCDEFGHJKLMNPQRTUWXY

我正在考虑修改 Luhn 算法以使用我的基础。

我的问题是：

在以 10 为底的情况下，Luhn 算法将每个值在偶数位置加倍，然后如果结果大于 10，则将结果的各个数字相加。

我应该仍然将我的偶数位置值加倍，还是使用更高的乘数？

我试图防止转置字符、丢失字符、多余字符和简单的错误数字。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T11:32:08.837

我研究了 Luhn mod N 算法，但它可以验证的内容非常有限。

我决定使用货运集装箱系统的修改版本。

集装箱系统将每个值乘以 2^[位置]（位置从 0 开始），然后对结果进行模 11 以得到以 10 为底的校验位（不建议使用 10 的结果）。

在这种情况下，诀窍是找到 x^0 到 x^[length] 范围内的值，这些值不能被您在模数上使用的数字整除。

我决定使用 3^[position] 作为乘数并对总和执行模 31 以获得校验位。

例如：0369CFJMK

```
Character  0     3     6     9     C     F     J     M     K
Value      0     3     6     9     12    15    18    21    19
--------------------------------------------------------------
Multiplier 1     3     9     27    81    243   729   2187
Result     0     9     54    243   972   3645  13122 45927

Total      63972 MOD 31 = 19 
```

似乎使用这些算法，主要要求是乘数不能被基数整除，并且余数的模式不会在您要验证的代码长度内重复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T10:45:02.490

不要重新发明轮子 - 改用Luhn [mod N。](http://en.wikipedia.org/wiki/Luhn_mod_N_algorithm)

# java - 为什么 compareTo 在 Java 中的 Enum final 上？

> ID：519788
> 
> 赞同：100
> 
> 时间：2009-02-06T10:22:12.597
> 
> 标签：java, enums, comparable, compareto

Java 中的枚举实现了该`Comparable`接口。重写`Comparable`的`compareTo`方法会很好，但在这里它被标记为最终的。`Enum`'s上的默认自然顺序`compareTo`是列出的顺序。

有谁知道为什么 Java 枚举有这个限制？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2009-02-06T10:46:00.490

为了一致性，我猜......当你看到一个`enum`类型时，你知道*它*的自然顺序是声明常量的顺序。

要解决此问题，您可以轻松创建自己的`Comparator<MyEnum>`并在需要不同排序时使用它：

```
enum MyEnum
{
    DOG("woof"),
    CAT("meow");

    String sound;    
    MyEnum(String s) { sound = s; }
}

class MyEnumComparator implements Comparator<MyEnum>
{
    public int compare(MyEnum o1, MyEnum o2)
    {
        return -o1.compareTo(o2); // this flips the order
        return o1.sound.length() - o2.sound.length(); // this compares length
    }
} 
```

可以`Comparator`直接使用：

```
MyEnumComparator c = new MyEnumComparator();
int order = c.compare(MyEnum.CAT, MyEnum.DOG); 
```

或在集合或数组中使用它：

```
NavigableSet<MyEnum> set = new TreeSet<MyEnum>(c);
MyEnum[] array = MyEnum.values();
Arrays.sort(array, c); 
```

更多的信息：

*   [枚举类型的 Java 教程](http://java.sun.com/docs/books/tutorial/java/javaOO/enum.html)
*   [Sun 的枚举指南](http://java.sun.com/j2se/1.5.0/docs/guide/language/enums.html)
*   [类枚举 API](http://java.sun.com/javase/6/docs/api/java/lang/Enum.html)

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2010-07-09T17:23:05.700

提供使用源代码排序的 compareTo 的默认实现很好；最终确定是 Sun 的失误。序号已经说明了声明顺序。我同意在大多数情况下，开发人员可以对他们的元素进行逻辑排序，但有时人们希望以一种使可读性和维护性至关重要的方式组织源代码。例如：

```
 //===== SI BYTES (10^n) =====//

  /** 1,000 bytes. */ KILOBYTE (false, true,  3, "kB"),
  /** 10⁶ bytes. */   MEGABYTE (false, true,  6, "MB"),
  /** 10⁹ bytes. */   GIGABYTE (false, true,  9, "GB"),
  /** 10^(12) bytes. */  TERABYTE (false, true, 12, "TB"),
  /** 10^(15) bytes. */  PETABYTE (false, true, 15, "PB"),
  /** 10^(18) bytes. */  EXABYTE  (false, true, 18, "EB"),
  /** 10^(21) bytes. */  ZETTABYTE(false, true, 21, "ZB"),
  /** 10^(24) bytes. */  YOTTABYTE(false, true, 24, "YB"),

  //===== IEC BYTES (2^n) =====//

  /** 1,024 bytes. */ KIBIBYTE(false, false, 10, "KiB"),
  /** 2^(20) bytes. */   MEBIBYTE(false, false, 20, "MiB"),
  /** 2^(30) bytes. */   GIBIBYTE(false, false, 30, "GiB"),
  /** 2^(40) bytes. */   TEBIBYTE(false, false, 40, "TiB"),
  /** 2^(50) bytes. */   PEBIBYTE(false, false, 50, "PiB"),
  /** 2^(60) bytes. */   EXBIBYTE(false, false, 60, "EiB"),
  /** 2^(70) bytes. */   ZEBIBYTE(false, false, 70, "ZiB"),
  /** 2^(80) bytes. */   YOBIBYTE(false, false, 80, "YiB"); 
```

上面的顺序在源代码中看起来不错，但不是作者认为 compareTo 应该如何工作的方式。所需的 compareTo 行为是按字节数排序。使这种情况发生的源代码排序会降低代码的组织性。

作为枚举的客户，我不在乎作者如何组织他们的源代码。不过，我确实希望他们的比较算法有意义。Sun 不必要地束缚了源代码编写者。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-06T10:46:42.003

枚举值根据它们声明的顺序在逻辑上精确排序。这是 Java 语言规范的一部分。因此，枚举值只能在它们是同一个 Enum 的成员时进行比较。规范希望进一步保证 compareTo() 返回的可比较顺序与声明值的顺序相同。这就是枚举的定义。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-09T14:08:00.890

一种可能的解释是`compareTo`应该与`equals`.

并且`equals`对于枚举应该与身份相等（`==`）一致。

如果`compareTo`where 是非最终的，则可以用与 不一致的行为来覆盖它`equals`，这将是非常违反直觉的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-06T10:27:01.293

如果要更改枚举元素的自然顺序，请在源代码中更改它们的顺序。

# linux - Linux 上的 Oracle 命令行工具

> ID：519797
> 
> 赞同：1
> 
> 时间：2009-02-06T10:25:33.777
> 
> 标签：linux, oracle

Linux 上的*oradim*等价物是什么？Oracle 甚至为 Linux 提供了类似的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T10:28:55.767

oradim 没有替代命令。在 Linux 上，只需手动为新实例创建新环境。

在 Linux（和 Unix）上没有服务（至少不像在 Windows 上那样），只有进程，这些进程在实例启动时自动激活，并在实例关闭时删除。

要启动一个新实例，比如说`newsid`，您创建一个`initnewsid.ora`文件，然后

```
$ export ORACLE_SID=newsid
$ sqlplus / as sysdba

SQL*Plus: Release 10.2.0.1.0 - Production on Tue Sep 5 16:38:30 2006

Copyright (c) 1982, 2005, Oracle.  All rights reserved.

Connected to an idle instance.

SYS@newsid SQL> startup nomount pfile=<complete path for initnewsid.ora> 
```

如果您运行的是 Red Hat（或 CentOS），您可以复制并更改其中的一个脚本，`/etc/init.d`然后使用`chkconfig`. 这可以帮助您在重新启动机器后自动启动数据库。

不过，您似乎对 Linux 平台还很陌生，所以请让管理员帮助您处理这些脚本 (nofi)。

# process - 有人真正使用 PSP（个人软件流程）吗？

> ID：519800
> 
> 赞同：2
> 
> 时间：2009-02-06T10:28:30.073
> 
> 标签：process, personal-software-process

我最近一直在读一些关于这个的东西，但它看起来有点沉重。有人有使用它的实际经验吗？

有没有轻量级的替代品？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-02T23:00:44.147

个人软件过程是个人改进过程。成熟的 PSP 相当繁重，并且有几个与之相关的表单、模板和文档。但是，关键点是您应该根据您的特定需求定制 PSP。

通常，当您学习 PSP 时（尤其是在课程中学习时），您将使用完整的 PSP 及其所有形式。然而，正如 Watts S. Humphrey 在“PSP：软件工程师的自我改进过程”中所说，“使用一个既适合你又能产生预期结果的过程”很重要。即使对于个人而言，多个项目也可能需要对流程进行更改才能达到您想要的结果。

在我上面提到的《PSP：软件工程师的自我改进过程》一书中，定义自己的过程时应该遵循的步骤是：

*   确定需求和优先事项
*   定义目标、目的和质量标准
*   表征当前过程
*   表征目标过程
*   制定开发流程的策略
*   验证过程
*   加强流程

如果您熟悉多个流程模型，那么从所有这些模型中提取部分并创建适用于您的特定项目的流程或工作流应该是相当容易的。如果您需要更多建议，我建议您拿起这本书。有一整章专门用于扩展和修改 PSP 以及创建您自己的流程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T10:40:29.487

个人软件过程本身是能力成熟度模型 (CMM) 过程的一个子集。目前还没有轻量级的替代品。

# java - 哪种方法用于获取 JavaMail 中 CC 和 BCC 列表中给出的邮件 ID？

> ID：519807
> 
> 赞同：0
> 
> 时间：2009-02-06T10:32:15.823
> 
> 标签：java

我创建了一个 java 邮件程序来发送邮件。我怀疑使用哪种方法来获取 CC 和 BCC 列表中给出的邮件 ID？对于列表，我使用了以下代码。

代码：
MimeMessage mime = new MimeMessage(session);
mime.addFrom(bean.getFromAddress());

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T10:35:32.103

尝试这个：

```
Address[] copiedAddrs = mime.getRecipients(Message.RecipientType.CC); 
```

和这个：

```
Address[] blindCopiedAddrs = mime.getRecipients(Message.RecipientType.BCC); 
```

# c++ - 如何在已分配的内存上调用构造函数？

> ID：519808
> 
> 赞同：32
> 
> 时间：2009-02-06T10:33:02.140
> 
> 标签：c++, constructor

如何在已分配的内存区域上调用构造函数？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-02-06T10:35:01.387

您可以使用placement new 构造函数，它接受一个地址。

```
Foo* foo = new (your_memory_address_here) Foo (); 
```

[在C++ FAQ lite](https://isocpp.org/wiki/faq/dtors#placement-new)或[MSDN](http://msdn.microsoft.com/en-us/library/kewsb8ba.aspx)中查看更详细的说明。您唯一需要确保内存正确对齐（`malloc`应该返回正确对齐的内存，但要注意可能需要对齐到 16 字节边界左右的 SSE 之类的东西）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T10:45:06.687

请注意，在调用placement之前`new`，您需要在内存上调用析构函数——至少如果对象具有非平凡析构函数或包含具有的成员。

`obj`对于类的对象指针，`Foo`析构函数可以显式调用如下：

```
obj->~Foo(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-10-21T10:07:23.197

接受的答案提到的放置新构造函数是在标题中定义的分配器类之前的旧方法。现在你真的应该这样做（以 C++11 风格）：

```
allocator<Foo> alloc;
//Allocate memory for one or n objects
auto p = alloc.allocate(1); 
//Construct an object of Foo on allocated memory block p, by calling one of Foo's constructors
alloc.construct(p, args, ...); 

//OK, p now points to a Foo object ready for use...

//Call Foo's destructor but don't release memory of p
alloc.destroy(p); 
//Release memory
alloc.deallocate(p, 1); 
```

就是这样。

# asp.net - ASP.NET AJAX - 通过 JavaScript 检查异步回发

> ID：519810
> 
> 赞同：0
> 
> 时间：2009-02-06T10:34:07.253
> 
> 标签：asp.net, javascript, ajax

有谁知道检查您是否通过 JavaScript 进行 annc 回发所需的脚本？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T13:47:55.460

最后，我使用了以下内容，这给了我所需的功能：

Sys.WebForms.PageRequestManager.getInstance()._postBackSettings.async

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T10:49:37.457

大多数库（jquery 等）将 X-Requested-With 标头设置为 XMLHttpRequest，因此您可以在请求对象中对此进行测试，但是您不会说您使用 msajax、jquery 或自定义脚本来执行 xhr 调用。如果您提供更多详细信息，我可以提供更好的建议。

[此处](http://weblogs.asp.net/palermo4/archive/2007/10/04/httprequest-using-isajax-amp-isjson-extension-methods.aspx)的其他信息可能对您有所帮助

# java - 为什么 Java 类加载在 Linux 上会失败，但在 Windows 上会成功？

> ID：519816
> 
> 赞同：2
> 
> 时间：2009-02-06T10:36:24.800
> 
> 标签：java, cross-platform, classloader

我有一个使用 Jetty 部署的 Java Web 应用程序（使用 Spring）。如果我尝试在 Windows 机器上运行它，一切都按预期工作，但如果我尝试在我的 Linux 机器上运行相同的代码，它会失败，如下所示：

```
【正常启动输出】
11:16:39.657 INFO [main] org.mortbay.jetty.servlet.ServletHandler$Context.log>(ServletHandler.java:1145) >16> 设置 Web 应用根系统属性：'webapp.root' = [/path/到/工作/目录]
java.lang.reflect.InvocationTargetException
        在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        在 java.lang.reflect.Method.invoke(Method.java:597)
        在 org.mortbay.start.Main.invokeMain(Main.java:151)
        在 org.mortbay.start.Main.start(Main.java:476)
        在 org.mortbay.start.Main.main(Main.java:94)
引起：java.lang.ExceptionInInitializerError
        在 org.springframework.web.util.Log4jWebConfigurer.initLogging(Log4jWebConfigurer.java:129)
        在 org.springframework.web.util.Log4jConfigListener.contextInitialized(Log4jConfigListener.java:51)
        在 org.mortbay.jetty.servlet.WebApplicationContext.doStart(WebApplicationContext.java:495)
        在 org.mortbay.util.Container.start(Container.java:72)
        在 org.mortbay.http.HttpServer.doStart(HttpServer.java:708)
        在 org.mortbay.util.Container.start(Container.java:72)
        在 org.mortbay.jetty.Server.main(Server.java:460)
        ... 7 更多
引起：org.apache.commons.logging.LogConfigurationException：org.apache.commons.logging.LogConfigurationException：没有合适的日志构造函数[Ljava.lang.Class;@15311bd for org.apache.commons.logging.impl.Log4JLogger（引起by java.lang.NoClassDefFoundError: org/apache/log4j/Category) （由 org.apache.commons.logging.LogConfigurationException 引起：没有合适的日志构造函数 [Ljava.lang.Class;@15311bd 用于 org.apache.commons.logging。 impl.Log4JLogger（由 java.lang.NoClassDefFoundError: org/apache/log4j/Category 引起））
        在 org.apache.commons.logging.impl.LogFactoryImpl.newInstance(LogFactoryImpl.java:543)
        在 org.apache.commons.logging.impl.LogFactoryImpl.getInstance(LogFactoryImpl.java:235)
        在 org.apache.commons.logging.impl.LogFactoryImpl.getInstance(LogFactoryImpl.java:209)
        在 org.apache.commons.logging.LogFactory.getLog(LogFactory.java:351)
        在 org.springframework.util.SystemPropertyUtils.(SystemPropertyUtils.java:42)
        ... 14 更多
引起：org.apache.commons.logging.LogConfigurationException：没有合适的日志构造函数 [Ljava.lang.Class;@15311bd for org.apache.commons.logging.impl.Log4JLogger（由 java.lang.NoClassDefFoundError 引起：org/apache /log4j/类别）
        在 org.apache.commons.logging.impl.LogFactoryImpl.getLogConstructor(LogFactoryImpl.java:413)
        在 org.apache.commons.logging.impl.LogFactoryImpl.newInstance(LogFactoryImpl.java:529)
        ... 18 更多
引起：java.lang.NoClassDefFoundError: org/apache/log4j/Category
        在 java.lang.Class.getDeclaredConstructors0（本机方法）
        在 java.lang.Class.privateGetDeclaredConstructors(Class.java:2389)
        在 java.lang.Class.getConstructor0(Class.java:2699)
        在 java.lang.Class.getConstructor(Class.java:1657)
        在 org.apache.commons.logging.impl.LogFactoryImpl.getLogConstructor(LogFactoryImpl.java:410)
        ... 19 更多
引起：java.lang.ClassNotFoundException：org.apache.log4j.Category
        在 java.net.URLClassLoader$1.run(URLClassLoader.java:200)
        在 java.security.AccessController.doPrivileged（本机方法）
        在 java.net.URLClassLoader.findClass(URLClassLoader.java:188)
        在 java.lang.ClassLoader.loadClass(ClassLoader.java:307)
        在 java.lang.ClassLoader.loadClass(ClassLoader.java:252)
        在 java.lang.ClassLoader.loadClassInternal(ClassLoader.java:320)
        ... 24 更多
[关机输出]
```

我已经使用 运行了该应用程序`java -verbose:class`，根据该输出，org.apache.log4j.Category 是从我的 /WEB-INF/lib 中的 log4j JAR 加载的，就在引发第一个异常之前。

现在，两台机器上的 Java 版本略有不同。两台机器都有 Sun 的 java，Linux 机器有 1.6.0_10，而 Windows 机器有 1.6.0_08，或者可能是 07 或 06，我现在不记得确切的数字，并且手头没有机器. 但即使 Java 的次要版本略有不同，代码也不应该像这样中断。有谁明白这里有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T11:05:24.493

您必须了解类加载器无法看到所有内容；他们只能看到父类加载器已加载的内容或他们自己加载的内容。因此，如果您有两个类加载器，一个用于 Jetty，另一个用于您的 webapp，您的 webapp 可以看到 log4j（因为 JAR 是 WEB-INF/lib）但 Jetty 的类加载器不能。

如果你设法让一个使用 log4j 但最终在 Jetty 的上下文（和类加载器）中运行的 Jetty 可用的类（例如 DB 层中的某些东西），你会得到一个错误。

要对此进行调试，请在 org.springframework.web.util.Log4jWebConfigurer.initLogging() 中设置断点。如果可以，请将此类的源代码复制到您的项目中（之后不要忘记将其删除）并添加以下行：

```
ClassLoader cl = Thread.currentThread().getContextClassLoader(); 
```

查看调试器中的 cl 对象。这应该会给你一些创建它的信息。我的猜测是这是来自 Jetty 的类加载器。

[编辑] 请注意，如果您在两个类加载器中都有 log4j，您会遇到不同的混乱：在这种情况下，您将有*两个*具有*相同*名称的类创建不兼容分配的对象！所以确保只有这个 jar 的一个实例，或者 log4j 的实例永远不会在两个上下文之间传递（这通常是不可能的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T11:00:16.203

这似乎是一个经典的类加载器问题。这可能是由于首先加载了另一个 Web 应用程序，它也使用 log4j，但版本与您正在测试的应用程序使用的版本不同。类加载器使用它找到的类的第一个版本。服务器类加载策略通常可以在配置文件中更改。抱歉，我对此有点生疏，但也许它可以为您指明正确的方向。

1.  确保网络服务器上没有其他已安装的应用程序，
2.  确保正在加载的 log4j 是正确的版本，
3.  确保您没有潜伏在服务器类路径中某处的 log4j。

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T10:50:54.473

您在两台机器上使用相同的 WAR？您是否检查过 WAR 文件是否相同（未发生传输错误）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T10:57:39.733

一些随机的事情要考虑：

(1) 检查在 linux 实例上是否有任何其他版本的 log4j 在 web-app 目录之外浮动？

(2) 是否正在使用 apache commons 日志记录？您可能想考虑使用[SLF4J](http://www.slf4j.org/)？

(3) JAR/WAR 是否以某种方式损坏 - 它是以 ASCII 格式还是二进制格式进行 FTP 处理的？

(4) 打印出每种情况下的类加载器层次结构，看看有没有出入？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-24T07:06:05.357

尽管最初的问题已经为提问者解决了，但我会指出，在 Windows 与 Linux（或 Unix）上运行相同代码时，常见的问题来源是区分大小写的问题。Windows 忽略大小写，而 Linux 或 Unix 区分大小写。这不止一次地咬了我。

因此，如果您在类路径上指定了一个 jar 或目录，但它不是正确的情况，那么它将在 Linux 上失败但在 Windows 上成功。这也可能是 FileNotFoundExceptions 的来源。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-28T17:01:58.110

有同样的问题，并找到了一个简单的解决方案/解决方法：

在 Eclipse 中的 Preferences > Java > Installed JREs 中，选择 JRE > Edit and Add External JARs... 并浏览到您的 log4j.jar。

另一种解决方法是将 log4j.jar 添加到 Classpath 选项卡中的每个启动定义。

# .net - 可以集成到自定义 .NET 应用程序的现有销售/订购引擎？

> ID：519817
> 
> 赞同：0
> 
> 时间：2009-02-06T10:36:30.650
> 
> 标签：.net, catalog, integrate, product

有这种习惯希望软件从产品目录中生成报价，打印发票，这里没有什么太原始的东西。但他们也想要一堆自定义功能和自定义演示，所以购买现成的是行不通的。

您是否知道我们可以将任何好的产品集成到自定义开发中，而不是为应用程序的目录/订单/发票管理部分重新发明轮子？

这是 Microsoft 环境中的 .NET 项目。

非常欢迎任何建议/评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T10:42:24.587

Microsoft 网站上有大量 ASP.NET 入门工具[包](http://www.asp.net/community/projects/)

我不知道它是否是您需要的，但是有电子商务、商店网站等，而且您似乎可以更改代码并根据需要使用它（先阅读许可证！）

# analysis - 时事通讯：如何确定有多少人打开了电子邮件？

> ID：519820
> 
> 赞同：-1
> 
> 时间：2009-02-06T10:38:28.993
> 
> 标签：analysis, newsletter

**有没有办法[确定电子邮件是否到达目的地？](https://stackoverflow.com/questions/185204/is-there-a-way-to-determine-whether-an-e-mail-reaches-its-destination)**

大家好，

我听说可以确定有多少人打开了时事通讯并分析他们何时打开邮件。

我只是想知道这怎么可能……是否有必要生成“阅读确认”，或者在不让收件人知道的情况下进行这样的分析？

非常感谢您的输入...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T10:40:49.580

另请参阅[有没有办法确定电子邮件是否到达目的地？](https://stackoverflow.com/questions/185204/is-there-a-way-to-determine-whether-an-e-mail-reaches-its-destination)，我的回答在下面重复：

> 如果您制作基于 HTML 的电子邮件，您可以在其中包含图像，其中包含带有收件人唯一信息的 URL。您可以构建您的应用程序，以便这些 URL 在返回所需的图像数据之前触发一些代码以将该特定电子邮件标记为已读。
> 
> 为了完全有效，图像必须构成电子邮件的关键部分，因此收件人必须让他们的电子邮件客户端抓取图像。您还可以使电子邮件的纯文本部分仅包含一个 URL 以检索完整消息，从而再次允许您跟踪收据。
> 
> *你对这些想法的理解程度取决于你为什么需要知道它已被阅读，以及你想在多大程度上用他们无法剪切的电子邮件潜在地惹恼收件人，在移动设备上轻松阅读，收听屏幕阅读器等...*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T10:42:53.400

无法保证有人打开了您的时事通讯电子邮件。但是您可以通过在您的邮件中嵌入一个像素图像并使用您的网络服务器的统计数据来确定它被请​​求的频率，从而了解它被打开了多少次。

# c# - VirtualStore 无法在 Vista x64 上运行

> ID：519828
> 
> 赞同：1
> 
> 时间：2009-02-06T10:42:25.287
> 
> 标签：c#, visual-studio-2008, win64, virtualstore

我有一个小托盘应用程序，它想要写入 Program Files 目录下自己的文件夹。我知道这不是终极设计，我会修复它，但首先我想了解它是如何工作的。

在 32 位 Vista 机器上运行它会将文件写入 VirtualStore，它的工作方式与它应有的一样。

但是当在 Vista 64 位机器上安装它时，我立即遇到 UnauthorizedAccessException 尝试写入 Program Files（和 Program Files (x86)）中的目录。

VirtualStore 重定向似乎不适用于 Vista 64 位。有任何想法吗？

这是一个用 Visual Studio 2008 编写的 C# 应用程序，我使用 FileStream obj 将流保存到磁盘。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T10:56:30.890

有更多关于错误的信息？
您是否使用 sysinternals 工具来监控执行/访问错误？
看看事件查看器是否有错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T11:03:59.393

我现在就修。无论如何，您永远都不应该将您的东西写入该目录，这违反了准则。当有多个用户同时登录到服务器时，您的产品将无法工作，即使是在 VISTA 之前。

Vista 64 位将检测到您是 32 位应用程序，并会自动将您修改“Program Files”的尝试重定向到“Program Files x86”。事实上，它完全让您相信您在 32 位系统上运行（请参阅[此处](http://blogs.msdn.com/oldnewthing/archive/2008/12/22/9244582.aspx)）。

我怀疑这个仿真层有额外的保护，可以防止程序试图改变 Program Files 下的东西。或者，ACL 可能在 Vista 64 位（或者更可能的仿真层）下设置得更好。

底线：不要做你正在做的事情，微软已经告诉我们不要这样做很长时间了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T13:27:13.613

所以我实际上是通过将所有项目编译到目标平台 x86 来完成这项工作的。所以 x64 不适用于 Vista 64 上的 VirtualStore，也不能编译到“任何 CPU”。而且我必须为整个解决方案设置它（在配置管理器中），只是为每个单独的项目设置它是行不通的。

是时候使用 AppData 文件夹或 IsolatedStorage 重写它了。感谢所有的帮助！

# c++ - 什么是“元数据操作失败”VS2008 链接器错误？

> ID：519836
> 
> 赞同：0
> 
> 时间：2009-02-06T10:44:05.953
> 
> 标签：c++, visual-studio-2008, linker

我有一个大项目，最初是在 Borland C++ 6 中创建的。

我们正在逐步将程序移植到 VS2008。有很多项目，都编译为.lib，我正在尝试为一组项目构建测试项目的exe。

修复编译器错误后，我得到了这个疯狂的链接器错误：

*1>av_geos_core_domain.lib(GerTamMolde.obj)：错误 LNK2022：元数据操作失败 (8013118D)：重复类型 (PtoGrad) 中的布局信息不一致：(0x02000045)。*

它以不同的类别出现 4 次。列出的 .obj 是类（GerTamMolde 和 PtoGrad）。

我多次尝试清理和构建解决方案，但它不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T11:04:36.990

您是否尝试过搜索重复的符号？在我看来，PtoGrad 是在两个或多个地方定义的，可能在不同的 .lib 中，使得在构建 .exe 崩溃时符号解析。

# asp.net - ajaxified 自动建议

> ID：519846
> 
> 赞同：0
> 
> 时间：2009-02-06T10:46:11.537
> 
> 标签：asp.net, ajax, autosuggest

我有一个在 ASP.Net 中构建的具有自动建议功能的搜索模块。搜索条件是培训名称，并且数据库中有一个存储培训的表。表中的训练规模将高达 30,000 次，因此我在选择方法时必须非常小心，同时牢记性能。

可能有大约 3000 个用户同时登录系统。当用户开始输入培训名称时，系统应自动建议。

我想到的方法如下

1.  缓存对象 - 用户键入 3 个（例如 saf）字符后会出现数据库命中，系统将在活动表中搜索所有以 saf 开头的训练并缓存它们。其他请求将通过此缓存。但是这种方法的问题是，如果有 3000 个并发用户在使用系统，并且如果他们都搜索 3 个不同字母的不同组合，那么缓存就会被破坏。

2.  客户端缓存 - 对此没有多想。我在这里看到的唯一缺点是我们可能必须定期清除临时 Internet 文件夹。

3.  使用 Session - 我想完全排除这种情况，因为我认为它会影响性能。

您能否建议我可以在这里采取的最佳或任何其他不同的方法。我正在寻找您对此的所有信息/想法。

太感谢了

迪帕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T11:16:51.973

我最喜欢的 jQuery 插件（如果您打算使用 jQuery）是[Flexbox](http://www.codeplex.com/flexbox)。

它有一个非常令人印象深刻的功能列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T17:34:05.347

您的帖子确实包含两个问题：

1.  如何在我的网页上获得自动完成功能？
2.  由于大量查询同时访问我的数据库，我担心性能。

我的回答...

1：我们发现 ASP.NET AJAX [AutoComplete Extender](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx)在所有现代浏览器上都运行良好，提供了流畅的用户体验并且很容易实现。

在您的 Web 应用程序中，您需要创建一个具有特定签名的方法的 Web 服务（在上面链接的文档中介绍）。

2：您是否证明您在项目的这一部分确实存在性能瓶颈？我建议设置一个测试工具并使用大量自动完成查询来访问您的数据库，以查看它可以花费多少。提防[过早的优化](http://www.codinghorror.com/blog/archives/000061.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T11:01:40.880

您可以使用内置缓存功能的[jQuery Auto Complete 插件。](http://docs.jquery.com/Plugins/Autocomplete)

```
$(document).ready(function()
{
        $(".landingpage").autocomplete('/AutoSuggestHandler.ashx',
        {
            minChars: 1,
            matchSubset: 1,
            autoFill: false,
            delay: 10,
            scroll: false
        }).result(OnResultSelected);
} 
```

此外，您可以在通用处理程序上指定输出缓存，以适应跨用户缓存的需要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T11:03:58.597

我认为你的第一种方法会奏效。

确保字段上有索引 - 您可能不需要索引整个字段。这应该会给数据库一个不错的提升。您可能需要根据搜索的工作方式查看全文索引，甚至使用 lucene 之类的外部库，因为索引是性能问题。

缓存对象，甚至是查询生成的 xml/json 以提高性能。

您还应该设置 http 标头，以便浏览器也缓存 xml/json。

# visual-studio - Visual Studio 中的 psexec

> ID：519848
> 
> 赞同：4
> 
> 时间：2009-02-06T10:47:45.697
> 
> 标签：visual-studio, visual-studio-2005, stsadm, psexec

我一直在尝试让 psexec 从 Visual Studio 中的自定义构建任务在远程机器上运行可执行文件。所有这些命令都可以从命令行运行，但从应用程序运行它似乎是个问题。一些命令有效，其他 psexec 挂起，因此 msbuild 和 Visual Studio 2005 也有效。在这种情况下，我调用了 SharePoint 的 stsadm.exe，但是当从应用程序运行 psexec 时，很多程序都会出现这个问题。有很多人遇到这个问题，但似乎没有解决方案，所以我的问题是：有没有人知道 psexec 的可行替代方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T02:04:16.967

在对远程系统执行 PSEXEC 时，我经历过“挂起”，但我总是将其归因于远程进程在其中运行的安全上下文。

来自 PSEXEC 的帮助：

> 如果您省略用户名，远程进程将在您执行 PsExec 的同一帐户中运行，但由于**远程进程正在模拟，它将无法访问远程系统上的网络资源**。当您指定用户名时，远程进程在指定的帐户中执行，并且将有权访问该帐户有权访问的任何网络资源。请注意，密码以明文形式传输到远程系统。

如果您远程执行一个进程，然后需要访问数据库 (stsadm.exe)，那么尝试访问网络资源可能会失败，具体取决于 PSEXEC 的执行方式。如果是这样的话，我想它最终会超时并给出某种资源不可用的消息。

在对远程机器执行部署步骤以防止您描述的行为时，通常会做两件事：

1.  *就像提到的 rifferte 一样，在使用 PSEXEC 执行脚本（*.bat、*.vbs、*.ps 等）之前*，确保部署所需的所有资产都是远程机器本地的（复制文件 等） - 以便一切运行远程机器的“本地”。

2.  执行时使用域用户名/密码运行 PSEXEC - 请注意，此信息以明文形式传递给远程服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T20:37:22.000

总是有[RCE](http://talhatariq.wordpress.com/projects/remote-command-executor-xrce/)。

> RemCom 是一个小型（10KB upx 打包）remoteshell / telnet 替代品，可让您在远程 Windows 系统上执行进程，在远程系统上复制文件，在那里处理输出并将其流回。它允许直接使用完整的交互式控制台执行远程 shell 命令，而无需安装任何客户端软件。在本地机器上，它也可以模拟，因此可以用作 Runas 命令的静默替代品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-28T04:33:23.297

您可以尝试让 psexec 调用一个 bat 程序，该程序在远程计算机上执行您需要的操作。我在 installutil.exe 中遇到了这个问题。远程机器上的一个简单的 bat 文件解决了它。

您还应该在 sysinternals 板上分享您的经验。在未来的修订中，他们可能会做一些事情。

# apache-flex - 为页面添加书签

> ID：519849
> 
> 赞同：1
> 
> 时间：2009-02-06T10:48:07.477
> 
> 标签：apache-flex, flash, actionscript, bookmarks

我们如何使用actionscript在flex中单击按钮或链接按钮时为页面添加书签

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T20:48:16.483

基于先前答案中的信息的工作示例：

**bookmarks.js**（将其添加到您的 html-template 目录中）：

```
 function CreateBookmarkLink(title, url) 
 {
    if (window.sidebar) { // Mozilla Firefox Bookmark
        window.sidebar.addPanel(title, url,"");
    } else if( window.external ) { // IE Favorite
        window.external.AddFavorite( url, title); }
    else if(window.opera && window.print) { // Opera Hotlist
        return true; }
 } 
```

然后将此行添加到**index.template.html：**

```
<script src="bookmarks.js" language="javascript"></script> 
```

现在，您有了 JavaScript 代码“包装”了您的 Flex 应用程序，可以通过此代码 ( **bookmarks.mxml** ) 调用它：

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
    <mx:Script>
        <![CDATA[
            public function AddBookmark() : void
            {
                ExternalInterface.call("CreateBookmarkLink", 
                   "Stack Overflow", 
                   "http://www.stackoverflow.com");
            }
        ]]>
    </mx:Script>
    <mx:Button x="10" y="10" label="Bookmark!" click="AddBookmark()"/>
</mx:Application> 
```

在 IE 上测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T11:40:22.767

您必须为此使用javascript。只需创建一个 javascript 函数来为托管 swf 的 html 文件中的页面添加书签，然后使用 ExternalInterface 从 swf 内部调用该函数。

这是一个用于书签的 javascript 函数示例：http: [//labnol.blogspot.com/2006/01/add-to-favorites-ie-bookmark-firefox.html](http://labnol.blogspot.com/2006/01/add-to-favorites-ie-bookmark-firefox.html)

这是有关如何使用 ExternalInterface 的 Flex 文档： http://livedocs.adobe.com/flex/2/docs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file= [00001009.html](http://livedocs.adobe.com/flex/2/docs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001009.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T11:41:01.033

AFAIK，你不能直接从动作脚本中做到这一点。但是，您可以从动作脚本中调用 javascript 来取消`ExternalInterface`类，并且网络上充斥着用于创建书签的 javascript 函数。看看[这个](http://labnol.blogspot.com/2006/01/add-to-favorites-ie-bookmark-firefox.html)，例如（我没有测试过）。

# java - 网络编程：是否维护套接字？

> ID：519850
> 
> 赞同：7
> 
> 时间：2009-02-06T10:48:16.197
> 
> 标签：java, network-programming

我目前正在将 API 从 C# 转换为具有网络组件的 Java。

C# 版本似乎在使用其类期间保持输入和输出流以及套接字打开。

它是否正确？

考虑到应用程序正在根据用户输入发送命令和接收事件，为每个“消息”打开一个新的套接字流是否更明智？

我正在维护一个 ServerSocket 来监听服务器抛出的事件，但我不太确定为出站通信维护一个 Socket 和输出流是一个好主意。

我不太习惯 Socket 编程。与许多开发人员一样，当我需要进行网络连接时，我通常在应用程序层工作，而不是在套接字层工作，而我在大学做这些事情已经有 5 或 6 年了。

为帮助喝彩。我想这更多的是寻求建议而不是明确的答案。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-06T11:18:01.080

在保持连接打开的成本和创建这些连接的成本之间需要权衡。

**创建连接**会耗费时间和带宽。您必须进行 3 次 TCP 握手，启动一个新的服务器线程，...

**保持连接开放**主要消耗内存和连接。网络连接是受操作系统限制的资源。如果连接的客户端过多，则可能会用完可用连接。这将消耗内存，因为您将为每个连接打开一个线程及其相关状态。

根据您期望的使用情况，正确的平衡会有所不同。如果您有很多客户端在短时间内连接，那么关闭连接可能会更有效。如果您长时间连接的客户端很少，您可能应该保持连接打开...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T11:18:40.393

如果客户端和服务器上只有一个套接字，则应尽可能长时间保持打开状态。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T11:50:12.420

如果您的应用程序和它与之通信的服务器在网络方面是关闭的，那么关闭连接可能是明智的，但如果它们在网络方面距离很远，那么您最好让套接字在一段时间内存活。

Guillaume 提到了 3 次握手，这基本上意味着打开一个套接字至少需要最短数据包传输时间的 3 倍。这可以近似为“ping 往返的一半”，长距离可以轻松达到 60-100 毫秒。如果您最终为每个命令额外等待 300 毫秒，这会影响用户体验吗？

就个人而言，我会让套接字保持打开状态，这更容易并且不会为每个“需要发送东西”的实例花费时间，相对成本很小（一个文件描述符，用户空间中数据结构的一点内存以及内核中的一些额外存储空间）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-06T10:57:47.237

这取决于您希望用户输入命令的频率。如果它很少发生，您也许可以关闭套接字。如果频繁，重复创建套接字可能是一项昂贵的操作。

话虽如此，就机器资源而言，为不频繁的数据打开一个套接字连接是多么昂贵？为什么您认为“为出站通信维护 Socket 和输出流并不是一个好主意”（尽管这似乎是正确的做法）？另一方面，如果您希望其他进程可能想要使用相同的文件，则文件流的情况会有所不同。在这种情况下快速关闭文件流将是可行的方法。

您可以创建的许多 TCP 连接用完的可能性有多大，其他建立出站连接的进程可能想要使用哪些？或者您是否希望一次有大量客户端连接到您的服务器？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T15:46:21.150

您还可以查看 DatagramSocket 和 DatagramPacket。优点是开销较低，缺点是常规 Socket 提供的开销。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T21:37:20.287

我建议您考虑使用现有的消息传递解决方案，如 ActiveMQ 或 Netty。这将处理您可能会在消息传递中发现的许多问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-01-10T22:22:46.790

我来晚了，但我没有看到有人建议。

我认为考虑将您的连接池化（不管是 Socket 还是 TCP）是明智的，能够保持打开的几个连接并在您的代码库中快速重用它们在性能的情况下是最佳的。

事实上，Roslyn 编译器在很多地方都广泛使用了这种技术。 [https://github.com/dotnet/roslyn/search?l=C%23&q=pooled&type=&utf8=%E2%9C%93](https://github.com/dotnet/roslyn/search?l=C%23&q=pooled&type=&utf8=%E2%9C%93)

# python - 良好的声音处理/分析/捕获模块

> ID：519851
> 
> 赞同：0
> 
> 时间：2009-02-06T10:48:24.057
> 
> 标签：python, audio

我们正在进行声音处理和分析，我们需要提取声音的频率、音高、八度和其他参数，包括 dBPowerSpectrum 分析。

无论文件格式如何，我们也需要这样做，或者在相当一种文件格式之间进行转换（尽管如果可以在大多数文件格式上分析这些参数，则转换不是一个非常关键的要求）。
我们还需要从麦克风捕获/录制声音。我们找到了一个名为 Snack 的 Python 模块，它几乎可以满足我们的所有需求，但整个问题是它需要安装 tkinter。
由于我们计划为这个程序编写一个 Web 客户端，我觉得安装 tkinter 并初始化它的对象并将其传递给声音处理模块是一种开销。
您能否向我们推荐一些好的声音处理模块。我们不期望一个多合一的模块。即使这些功能分布在多个模块上也没关系。

请建议。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T11:09:36.683

请参阅[http://www.csounds.com/node/188](http://www.csounds.com/node/188)以获取执行大部分此操作的软件包。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-17T15:22:02.750

对于音频捕获和播放，我喜欢[PyAudio](http://people.csail.mit.edu/hubert/pyaudio/)。它是跨平台的并且非常易于使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-07T17:20:31.840

您可以使用[scikits audiolab读取](http://cournape.github.com/audiolab/)[libsndfile](http://www.mega-nerd.com/libsndfile/)支持的任何文件，然后使用[PyLab](http://www.scipy.org/PyLab)（[NumPy 和 SciPy](http://www.scipy.org/)）进行处理。

不过，我不知道如何从麦克风中读取实时音频，这就是为什么我自己只是在看 Snack。如果有一种方法可以将 Snack 声音转换为 numpy 数组，那就可以了。

如果你`padsp ipython`在 Ubuntu 中使用，你可以从 /dev/dsp 读取数据，它实际上来自 PulseAudio 的输入。你可以使用[ossaudiodev](http://docs.python.org/library/ossaudiodev.html)模块，虽然我还没有让它工作，或者你可以做一些丑陋的结构，比如：

```
audio = numpy.fromfile('/dev/dsp'... 
```

但我想你仍然需要先使用 ossaudiodev 来设置采样率、格式等。

# sql - SQL - 如何检查表中的新数据？

> ID：519854
> 
> 赞同：4
> 
> 时间：2009-02-06T10:49:47.050
> 
> 标签：sql, sql-server-2005, stored-procedures

我需要创建一个存储过程，在执行时检查过去 12 小时内是否有任何新行添加到表中。如果不是，则必须向收件人发送警告电子邮件。

我有发送电子邮件的程序，但问题是查询本身。我想我必须制作一个使用当前日期并将其与行中的日期进行比较的 sql 命令。但我是一个完整的 SQL 初学者，所以我什至不能用正确的词在谷歌上找到任何东西。

简洁版本：

使用 MS SQL Server 2005，我如何检查日期，然后根据过去 12 小时内是否创建新行返回结果，并使用该结果来决定是否发送电子邮件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T10:54:06.107

这样的事情应该做你想做的事。

```
Select ID
from TableName
where CreatedDate >= dateadd(hour,-12,getDate()) 
```

希望这很清楚，但请随时提出进一步的问题。

干杯，约翰

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T10:55:58.880

假设您在表格中的日期字段是“CreateDate”，它的类型是 DateTime。您要比较的时间是： GETDATE() （返回日期 + 时间）要获得 12 小时前的日期时间值，使用 DATEADD 完成： DATEADD(hour, -12, GETDATE())

因此，如果我们想要在过去 12 小时内添加的行数，我们将执行以下操作：

```
SELECT COUNT(*)
FROM Table
WHERE CreateDate >= DATEADD(hour, -12, GETDATE()) 
```

在您的过程中，您必须将此查询的结果存储到一个变量中并检查它是否> 0，因此：

```
DECLARE @amount int
SELECT @amount=COUNT(*)
FROM Table
WHERE CreateDate >= DATEADD(hour, -12, GETDATE()) 
```

然后您将检查@amount 变量是否> 0。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T10:56:27.210

您可以使用触发器，此链接有几个示例： http: [//msdn.microsoft.com/en-us/library/aa258254 (SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa258254(SQL.80).aspx)

```
USE pubs
IF EXISTS (SELECT name FROM sysobjects
      WHERE name = 'reminder' AND type = 'TR')
   DROP TRIGGER reminder
GO

CREATE TRIGGER reminder
ON titles
FOR INSERT, UPDATE, DELETE 
AS
   EXEC master..xp_sendmail 'MaryM', 
      'Don''t forget to print a report for the distributors.'
GO 
```

如果您不希望每次插入/更新都有某些内容，则可以将数据复制到另一个表，然后每 12 小时检查一次该表，报告其中的行，然后删除它们...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T11:00:14.080

假设您在此表上有： - 一个唯一的 id 自动递增 - 一个包含行创建时间戳的 created_timestamp 字段

-> 有一个新表

```
reported_rows
  - report_timestamp
  - last_id_seen
 (OR)
  - last_timestamp_seen 
```

每次发送电子邮件时用实际值填写报告的行，在发送电子邮件之前，检查以前的值，这样您就知道添加了哪些行

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T12:02:09.883

如果表有标识字段，您还可以保存最大值（作为书签），下次检查是否有任何行的 ID 大于您保存的书签。如果密钥是集群密钥，可能会更快。

# c# - 使用 PortalSiteMapProvider 的单元测试代码

> ID：519856
> 
> 赞同：1
> 
> 时间：2009-02-06T10:50:30.200
> 
> 标签：c#, visual-studio-2008, sharepoint, unit-testing

我有一个使用[PortalSiteMapProvider](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.publishing.navigation.portalsitemapprovider.aspx)查询 Sharepoint 导航层次结构的 Web 部件，但为该代码编写的单元测试失败，因为代码在 Sharepoint 上下文之外运行，因此没有可用的站点地图提供程序。

我已经确定了解决这个困境的两种替代方法：

*   因为 Sharepoint 基本上是一个复杂的 ASP.Net 应用程序，所以应该可以使用 HostType 和 UrlToTest 测试属性在 Sharepoint 上下文中运行测试
*   使用模拟而不是 PortalSiteMapProvider

这些都是可行的还是有更好的第三种选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T15:43:42.853

Microsoft Patterns and Practices 帅哥推荐 TypeMock 来帮助对 Sharepoint 进行单元测试

[http://msdn.microsoft.com/en-us/library/dd203468.aspx](http://msdn.microsoft.com/en-us/library/dd203468.aspx)

[http://www.typemock.com/sharepointpage.php](http://www.typemock.com/sharepointpage.php)

不幸的是，这不是免费的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T08:35:20.870

您将无法模拟 SPRequest 类，它是一个内部类。我面临同样的问题。一种方法是尝试将您的代码与 SharePoint API 隔离开来，这不是很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-15T15:54:08.877

[顺便说一句，Typemock 有专门针对SharePoint](http://www.typemock.com/sharepointpage.php)的降价产品。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-06T10:55:41.813

第二种选择更合适。抽象出 PSMP 并将其隐藏在后面`IPortalSiteMapProvider`，然后在您的单元测试中模拟它。为了桥接接口和具体实现，您可以编写一个瘦委托适配器或使用[鸭子类型](http://www.codeproject.com/KB/cs/nduck.aspx)。

# c# - 从 OnClientClick 将 eventArgs 从 ASP.NET C# 传递给 javascript

> ID：519868
> 
> 赞同：0
> 
> 时间：2009-02-06T10:55:42.437
> 
> 标签：c#, asp.net, javascript, event-handling

我的页面上有一个asp按钮，在Page_Load后面的代码中，我绑定了一些javascript调用，如下所示。

```
btnExample.OnClientClicking = "functionOne(1,2);"+"function2()"; 
```

问题是我希望能够将 EventArgs 传递给 Page_Load，就像我希望调用的 function2() 一样...

```
eventArgs.set_cancel(true). 
```

将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T11:24:13.800

据我了解你的问题，你可以写**“return false;”** 在函数 2() 中。
这也将确保不会触发 btnExample 的服务器端单击事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T15:59:33.417

如果您试图阻止回帖，Sachin 是正确的，您必须返回 false。不要忘记，除了在 JavaScript 函数中添加 return false 之外，您还必须在分配“OnClientClick”时添加 return。

代码背后：

```
btnExample.OnClientClick = "functionOne(1,2); return function2();"; 
```

JavaScript：

```
function function2()
{
    //Do something
    return false;
} 
```

# c# - 以编程方式关闭请求验证

> ID：519872
> 
> 赞同：2
> 
> 时间：2009-02-06T10:56:48.237
> 
> 标签：c#, asp.net, security

我有一个我正在编写的控件，我想在其中关闭.NET 的内置请求验证，以防止 XSS 攻击和类似的讨厌。

该控件允许网站所有者调整该页面上的内容。如果他们愿意，他们可能会输入标记。由于这是他们要编辑的网站，因此他们必须能够在上面粘贴任何他们想要的东西。

我想知道是否可以以编程方式禁用此验证？

我能找到的唯一方法是在 web.config 中完全关闭请求验证或使用页面指令。由于各种原因，我无法在另一个页面中使用此控件-因此该选项已失效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-15T14:19:10.373

这里列出的答案都远远不够。由于配置项是只读的，因此您首先需要修改它们以便可以写入它们。此外，自 .NET 4 发布以来，您还需要修改该属性才能识别`HttpRuntime.RequestValidationMode`此属性。`Pages.ValidateRequest`

```
public void ModifiyValidation(bool validate) {

    var pagesSection = System.Configuration.ConfigurationManager.GetSection("system.web/pages") as PagesSection;
    var httpRuntime = System.Configuration.ConfigurationManager.GetSection("system.web/httpRuntime") as HttpRuntimeSection;

    if (pagesSection != null && httpRuntime != null && pagesSection.ValidateRequest != validate)
    {
        var fi = typeof (ConfigurationElement).GetField("_bReadOnly", BindingFlags.Instance | BindingFlags.NonPublic);
        fi.SetValue(pagesSection, false);
        fi.SetValue(httpRuntime, false);
        pagesSection.ValidateRequest = validate;
        httpRuntime.RequestValidationMode = new Version(validate ? "4.0" : "2.0");
        fi.SetValue(pagesSection, true);
        fi.SetValue(httpRuntime, true);
    }
} 
```

**您还应该知道，只有在以下**请求时才会激活。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T11:13:59.107

在 System.Web.Configuration

```
PagesSection pageSection = new PagesSection();
pageSection.ValidateRequest = false; 
```

[参考](http://msdn.microsoft.com/en-us/library/system.web.configuration.pagessection.validaterequest.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T11:24:42.473

@Chris 带领我朝着正确的方向前进。

我所做的是关闭 web.config 中的设置，并使用 HTTP 模块对用户不在 EditMode 的所有请求进行请求验证。

在 .NET 2.0 中，Request 类上有一个名为：ValidateInput 的方法。即使在 web.config 中将其关闭，这也会进行验证。

# asp.net - 如何将 ASP.Net Webforms 网站与 ASP.Net MVC Web 应用程序集成？

> ID：519875
> 
> 赞同：6
> 
> 时间：2009-02-06T10:57:12.730
> 
> 标签：asp.net, asp.net-mvc, web-applications, web, integration

我将如何在一个主要网站下运行它们，比如 www.example.com，它是使用 Visual Studio ASP.Net MVC Web 应用程序项目编写和部署的，而 ASP.Net Web Forms 网站将从主站点的子目录，比如 www.example.com/myapp?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T11:38:49.260

请参阅 Hanselman 的[博客文章](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx)。基本思想是您将常规 WebForm 添加到您的 MVC 项目中，然后告诉路由引擎在执行 MVC 路由时忽略该路径。

# sql - SQL 格式化标准

> ID：519876
> 
> 赞同：61
> 
> 时间：2009-02-06T10:57:36.503
> 
> 标签：sql, sql-server, formatting, standards, coding-style

在我的上一份工作中，我们开发了一个非常依赖数据库的应用程序，并且我开发了一些格式标准，以便我们都可以使用通用布局编写 SQL。我们还开发了编码标准，但这些标准更特定于平台，所以我不会在这里讨论它们。

我很想知道其他人使用什么 SQL 格式化标准。与大多数其他编码环境不同，我还没有在网上为它们找到太多共识。

涵盖主要查询类型：

```
select
    ST.ColumnName1,
    JT.ColumnName2,
    SJT.ColumnName3
from 
    SourceTable ST
inner join JoinTable JT
    on JT.SourceTableID = ST.SourceTableID
inner join SecondJoinTable SJT
    on ST.SourceTableID = SJT.SourceTableID
    and JT.Column3 = SJT.Column4
where
    ST.SourceTableID = X
    and JT.ColumnName3 = Y 
```

`select`在,`from`和之后对换行存在一些分歧`where`。选择行的目的是允许其他操作符，例如“top X”而不改变布局。在此之后，在关键查询元素之后保持一致的换行似乎会产生良好的可读性。

`from`在and之后删除换行符`where`将是一个可以理解的修订。但是，在`update`下面的查询中，我们看到 之后的换行符`where`为我们提供了良好的列对齐。`group by`同样，在或之后的换行可以`order by`使我们的列布局清晰易读。

```
update
    TargetTable
set
    ColumnName1 = @value,
    ColumnName2 = @value2
where
    Condition1 = @test 
```

最后，一个`insert`：

```
insert into TargetTable (
    ColumnName1,
    ColumnName2,
    ColumnName3
) values (
    @value1,
    @value2,
    @value3
) 
```

[在大多数情况下，这些与 MS SQL Server Managements Studio](http://en.wikipedia.org/wiki/SQL_Server_Management_Studio) / 查询分析器写出 SQL的方式相差不大，但是它们*确实*有所不同。

我期待着看看 Stack Overflow 社区是否就这个话题达成了共识。我一直惊讶于有多少开发人员可以遵循其他语言的标准格式，并且在使用 SQL 时突然变得如此随意。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-05-12T05:58:46.747

*迟到的答案，但希望有用。*

作为大型开发团队的一员，我的经验是，您可以继续定义您喜欢的任何标准，但问题实际上是执行这些标准或让开发人员很容易实施这些标准。

作为开发人员，我们有时会创建一些可行的东西，然后说“我稍后会格式化它”，但后来永远不会出现。

最初，我们为此使用 SQL Prompt（它很棒），但后来切换到[ApexSQL Refactor](http://www.apexsql.com/sql_tools_refactor.aspx)，因为它是一个免费工具。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-06T11:05:33.947

我认为，只要您可以轻松阅读源代码，格式是次要的。只要达到了这个目的，就有很多不错的布局风格可以采用。

对我来说唯一重要的另一个方面是，无论您选择在您的商店中采用何种编码布局/样式，请确保所有编码人员都始终如一地使用它。

仅供参考，以下是我将如何展示您提供的示例，只是我的布局偏好。需要特别注意的是，该`ON`子句与 位于同一行`join`，仅在连接中列出了主连接条件（即键匹配），其他条件移至该`where`子句。

```
select
    ST.ColumnName1,
    JT.ColumnName2,
    SJT.ColumnName3
from 
    SourceTable ST
inner join JoinTable JT on 
    JT.SourceTableID = ST.SourceTableID
inner join SecondJoinTable SJT on 
    ST.SourceTableID = SJT.SourceTableID
where
        ST.SourceTableID = X
    and JT.ColumnName3 = Y
    and JT.Column3 = SJT.Column4 
```

一个提示，从[Red Gate获取一份](https://www.red-gate.com/?gclid=CjwKCAjwyrvaBRACEiwAcyuzRC-M2uV3xNsyFPxojXgbZDRXkWihn1iL9dC0E471Pc7IGs3asu09khoCyVsQAvD_BwE)[SQL Prompt](https://www.red-gate.com/products/sql-development/sql-prompt/index)副本。您可以自定义该工具以使用您想要的布局偏好，然后您商店中的编码员都可以使用它来确保每个人都采用相同的编码标准。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-03-21T17:34:12.010

我迟到了，但我只会添加我喜欢的格式样式，我一定是从书籍和手册中学到的：它很紧凑。这是示例`SELECT`语句：

```
SELECT  st.column_name_1, jt.column_name_2,
        sjt.column_name_3
FROM    source_table AS st
        INNER JOIN join_table AS jt USING (source_table_id)
        INNER JOIN second_join_table AS sjt ON st.source_table_id = sjt.source_table_id
                AND jt.column_3 = sjt.column_4
WHERE   st.source_table_id = X
AND     jt.column_name_3 = Y 
```

简而言之：8 空格缩进，大写关键字（尽管 SO 在小写时颜色更好），没有驼峰（在 Oracle 上毫无意义），并且在需要时换行。

`UPDATE`：_

```
UPDATE  target_table
SET     column_name_1 = @value,
        column_name_2 = @value2
WHERE   condition_1 = @test 
```

和`INSERT`：

```
INSERT  INTO target_table (column_name_1, column_name_2,
                column_name_3)
VALUES  (@value1, @value2, @value3) 
```

现在，让我第一个承认这种风格有它的问题。8 个空格的缩进意味着`ORDER BY`或者`GROUP BY`不对齐缩进，或者单独拆分单词`BY`。将子句的整个谓词缩进也会更自然`WHERE`，但我通常将跟随`AND`和`OR`运算符对齐在左边距。换行后的缩进`INNER JOIN`也有些随意。

但无论出于何种原因，我仍然发现它比其他选择更容易阅读。

我将使用这种格式样式完成我最近更复杂的创作之一。您在声明中遇到的几乎所有内容都`SELECT`显示在此声明中。（它也被改变以掩盖它的起源，我可能在这样做时引入了错误。）

```
SELECT  term, student_id,
        CASE
            WHEN ((ft_credits > 0 AND credits >= ft_credits) OR (ft_hours_per_week > 3 AND hours_per_week >= ft_hours_per_week)) THEN 'F'
            ELSE 'P'
        END AS status
FROM    (
        SELECT  term, student_id,
                pm.credits AS ft_credits, pm.hours AS ft_hours_per_week,
                SUM(credits) AS credits, SUM(hours_per_week) AS hours_per_week
        FROM    (
                SELECT  e.term, e.student_id, NVL(o.credits, 0) credits,
                        CASE
                            WHEN NVL(o.weeks, 0) > 5 THEN (NVL(o.lect_hours, 0) + NVL(o.lab_hours, 0) + NVL(o.ext_hours, 0)) / NVL(o.weeks, 0)
                            ELSE 0
                        END AS hours_per_week
                FROM    enrollment AS e
                        INNER JOIN offering AS o USING (term, offering_id)
                        INNER JOIN program_enrollment AS pe ON e.student_id = pe.student_id AND e.term = pe.term AND e.offering_id = pe.offering_id
                WHERE   e.registration_code NOT IN ('A7', 'D0', 'WL')
                )
                INNER JOIN student_history AS sh USING (student_id)
                INNER JOIN program_major AS pm ON sh.major_code_1 = pm._major_code AND sh.division_code_1 = pm.division_code
        WHERE   sh.eff_term = (
                        SELECT  MAX(eff_term)
                        FROM    student_history AS shi
                        WHERE   sh.student_id = shi.student_id
                        AND     shi.eff_term <= term)
        GROUP   BY term, student_id, pm.credits, pm.hours
        )
ORDER   BY term, student_id 
```

这种可憎的计算方法是计算学生在给定学期内是全日制还是非全日制。不管风格如何，这个很难读。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-07-26T20:01:35.197

迟到了，但我会把我的帽子扔进擂台。编写起来需要更长的时间，但我发现模式随着垂直对齐出现，一旦你习惯了它就变得非常可读。

```
SELECT ST.ColumnName1,
       JT.ColumnName2,
       SJT.ColumnName3,
       CASE WHEN condition1 = True 
             AND condition2 = True Then DoSomething
            Else DoSomethingElse
        END ColumnName4
  FROM SourceTable AS ST
 INNER
  JOIN JoinTable AS JT
    ON JT.SourceTableID = ST.SourceTableID
 INNER
  JOIN SecondJoinTable AS SJT
    ON ST.SourceTableID = SJT.SourceTableID
   AND JT.Column3 = SJT.Column4
  LEFT
  JOIN (SELECT Column5
          FROM Table4
       QUALIFY row_number() OVER
                 ( PARTITION BY pField1,
                                pField2
                       ORDER BY oField1
                 ) = 1
       ) AS subQry
    ON SJT.Column5 = subQry.Column5
 WHERE ST.SourceTableID = X
   AND JT.ColumnName3 = Y 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-06T11:16:49.057

好的。作为一名 Python 程序员，以下是我的偏好：

之后的换行符`select`，`from`并且`where`仅在需要可读性时使用。

当代码可以更紧凑且同样可读时，我通常更喜欢更紧凑的形式。能够在一屏中容纳更多代码可以提高生产力。

```
select ST.ColumnName1, JT.ColumnName2, SJT.ColumnName3
from SourceTable ST
inner join JoinTable JT
    on JT.SourceTableID = ST.SourceTableID
inner join SecondJoinTable SJT
    on ST.SourceTableID = SJT.SourceTableID
    and JT.Column3 = SJT.Column4
where ST.SourceTableID = X and JT.ColumnName3 = Y 
```

最终，这将是在代码审查期间做出的判断。

对于`insert`，我会以不同的方式放置括号：

```
insert into TargetTable (
    ColumnName1,
    ColumnName2,
    ColumnName3)
values (
    @value1,
    @value2,
    @value3) 
```

这种格式的原因是，如果 SQL 对块结构使用缩进（如 Python），则不需要括号。因此，如果无论如何都使用缩进，那么括号对布局的影响应该最小。这是通过将它们放置在行尾来实现的。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-10-28T22:16:42.023

我正在用 C# 编写一个开源 SQL 格式化程序（现阶段仅限 SQL-Server），所以我通过它进行了上述查询。

它采用与 OP 类似的策略，即每个“部分”都有缩进的子元素。如果需要，我会在部分之间添加空白以帮助清晰——当没有连接或最小 where 条件时，不会添加这些空白。

结果：

```
SELECT
    ST.ColumnName1,
    JT.ColumnName2,
    SJT.ColumnName3

FROM SourceTable ST

INNER JOIN JoinTable JT
        ON JT.SourceTableID = ST.SourceTableID

INNER JOIN SecondJoinTable SJT
        ON ST.SourceTableID = SJT.SourceTableID
       AND ST.SourceTable2ID = SJT.SourceTable2ID

WHERE ST.SourceTableID = X
  AND JT.ColumnName3 = Y
  AND JT.Column3 = SJT.Column4

ORDER BY
    ST.ColumnName1 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-02-19T05:01:55.483

```
SELECT
    a.col1                  AS [Column1]
    ,b.col2                 AS [Column2]
    ,c.col1                 AS [Column3]
FROM
    Table1 a
    INNER JOIN Table2 b     ON b.Id = a.bId
    INNER JOIN Table3 c     ON c.Id = a.cId
WHERE
    a.col     = X
    AND b.col = Y 
```

比这里的很多例子使用了更多的行，但我觉得它更容易理解，可以快速删除列/子句/表。它有助于利用垂直方向的显示器。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-01-20T13:02:31.603

根据约翰的建议，我建议采用以下风格：

```
/*
<Query title>
<Describe the overall intent of the query>
<Development notes, or things to consider when using/interpreting the query>
*/
select
    ST.ColumnName1,
    JT.ColumnName2,
    SJT.ColumnName3
from 

    -- <Comment why this table is used, and why it's first in the list of joins>
    SourceTable ST

    -- <Comment why this join is made, and why it's an inner join>
    inner join JoinTable JT
        on ST.SourceTableID = JT.SourceTableID

    -- <Comment why this join is made, and why it's an left join>
    left join SecondJoinTable SJT
        on  ST.SourceTableID = SJT.SourceTableID
        and JT.Column3 = SJT.Column4

where

    -- comment why this filter is applied
    ST.SourceTableID = X

    -- comment why this filter is applied
    and JT.ColumnName3 = (
            select 
                somecolumn
            from 
                sometable
        )
; 
```

优点：
- 注释是使代码可读和检测错误的重要部分。
- 在连接中添加 -all- "on"-filters 可以避免从内连接更改为左连接时出现错误。
- 将分号放在换行符上可以轻松添加/注释 where 子句。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-06T11:23:21.477

我倾向于使用与您类似的布局，尽管我什至更进一步，例如：

```
select
        ST.ColumnName1
    ,   JT.ColumnName2
    ,   SJT.ColumnName3
from
                SourceTable     ST

    inner join  JoinTable       JT
        on  JT.SourceTableID    =   ST.SourceTableID

    inner join  SecondJoinTable SJT
        on  ST.SourceTableID    =   SJT.SourceTableID

where
        ST.SourceTableID    =   X
    and JT.ColumnName3      =   Y
    and JT.Column3          =   SJT.Column4 
```

也许一开始它看起来有点过头了，但恕我直言，鉴于 SQL 的声明性质，以这种方式使用制表提供了最干净、最系统的布局。

你可能会在这里得到各种各样的答案。最后，这取决于个人或团队同意的偏好。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-06T12:51:10.893

我使用与您类似的格式，只是我将`ON`关键字放在与连接相同的行，并将`AND`和`OR`运算符放在行尾，以便我的所有连接/选择标准很好地排列。

虽然我的风格与 John Sansom 的风格相似，但我不同意将加入标准放在`WHERE`子句中。我认为它应该与连接表一起使用，以便它有条理且易于查找。

我也倾向于将括号放在新行上，与上面的行对齐，然后在下一行缩进，尽管对于简短的陈述，我可能只是将括号保留在原始行上。例如：

```
SELECT
     my_column
FROM
     My_Table
WHERE
     my_id IN
     (
          SELECT
               my_id
          FROM
               Some_Other_Table
          WHERE
               some_other_column IN (1, 4, 7)
     ) 
```

对于`CASE`语句，我为每个`WHEN`and提供一个新行和缩进，并将后面`ELSE`对齐到：`END``CASE`

```
CASE
     WHEN my_column = 1 THEN 'one'
     WHEN my_column = 2 THEN 'two'
     WHEN my_column = 3 THEN 'three'
     WHEN my_column = 4 THEN 'four'
     ELSE 'who knows'
END 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-11-20T19:22:00.517

不同意见的数量令人恐惧。这是我的组织使用的：

```
 SELECT ST.ColumnName1,
        JT.ColumnName2,
        SJT.ColumnName3
   FROM SourceTable ST
  INNER JOIN JoinTable JT ON JT.SourceTableID = ST.SourceTableID
  INNER JOIN SecondJoinTable SJT ON ST.SourceTableID = SJT.SourceTableID 
        AND JT.Column3 = SJT.Column4
  WHERE ST.SourceTableID = X
    AND JT.ColumnName3 = Y 
```

保持 8 个字符的缩进是可读性​​恕我直言的关键。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-10-07T23:16:46.660

还没有人完成[公用表表达式](https://stackoverflow.com/tags/common-table-expression/info)(CTE)。下面将它与我使用的其他一些样式结合在一起：

```
declare @tableVariable table (
    colA1 int,
    colA2 int,
    colB1 int,
    colB2 nvarchar(255),
    colB3 nvarchar(255),
    colB4 int,
    colB5 bit,
    computed int
);

with

    getSomeData as (

        select        st.colA1, sot.colA2
        from          someTable st
        inner join    someOtherTable sot on st.key = sot.key

    ),

    getSomeOtherData as (

        select        colB1, 
                      colB2, 
                      colB3,
                      colB4,
                      colB5,
                      computed =    case 
                                    when colB5 = 1 then 'here'
                                    when colB5 = 2 then 'there'
                                    end
        from          aThirdTable tt
        inner hash 
         join         aFourthTable ft
                      on tt.key1 = ft.key2
                      and tt.key2 = ft.key2
                      and tt.key3 = ft.key3

    )

    insert      @tableVariable (
                    colA1, colA2, colA2, 
                    colB1, colB2, colB3, colB4, colB5, 
                    computed 
                )
    select      colA1, colA2, 
                colB1, colB2, colB3, colB4, colB5, 
                computed 
    from        getSomeData data1
    join        getSomeOtherData data2 
```

关于 CTE 格式的几点：

*   在我的 CTE 中，“with”是单独的一行，cte 中的其他所有内容都是缩进的。
*   我的 CTE 名称很长且具有描述性。CTE 可以获得复杂且描述性的名称非常有帮助。
*   出于某种原因，我发现自己更喜欢 CTE 名称的动词。让它看起来更生动。
*   带括号的样式与 Javascript 带大括号的样式相似。这也是我在 C# 中做大括号的方式。

这模拟：

```
func getSomeData() {

    select        st.colA1, sot.colA2
    from          someTable st
    inner join    someOtherTable sot on st.key = sot.key

} 
```

除了 CTE 格式之外的几点：

*   “选择”和其他关键字之后的两个选项卡。这为“内部连接”、“分组依据”等留下了足够的空间。您可以在上面看到一个不正确的示例。但是“内部哈希连接”应该看起来很难看。尽管如此，在这一点上，我将来可能会尝试上述一些样式。
*   关键字是小写的。IDE 对它们的着色及其特殊的缩进状态足以突出它们。我根据本地（业务）逻辑为要强调的其他内容保留大写字母。
*   如果列数很少，我将它们放在一行（getSomeData）。如果还有更多，我将它们垂直化（getSomeOtherData）。如果一个单元中有太多垂直化，我会将一些列水平化到同一行中，并按本地定义的逻辑分组（最后的插入-选择段）。例如，我会将学校级别的信息放在一行上，将学生级别的信息放在另一行上，等等。
*   特别是在垂直化时，我更喜欢 sql server 的“varname = colname + something 语法”而不是“colname + something as varname”。
*   如果我正在处理案例陈述，请将最后一点加倍。
*   如果某种逻辑适合“矩阵”风格，我将处理打字的后果。这就是 case 语句的情况，“whens”和“then”是对齐的。

我发现我比其他领域更确定我的 CTE 风格。没有尝试过与问题中提出的更相似的样式。可能有一天会做，看看我有多喜欢它。我可能被诅咒在一个可以选择的环境中，尽管这是一个有趣的诅咒。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-06T11:10:14.530

如果我要对已经编写的 T-SQL 进行更改，那么我会遵循已经使用的约定（如果有的话）。

如果我是从头开始写作或没有约定，那么我倾向于遵循问题中给出的约定，除了我更喜欢使用大写字母作为关键字（只是个人对可读性的偏好）。

我认为 SQL 格式与其他代码格式约定一样，重要的是要有一个约定，而不是那个约定（当然在常识范围内！）

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-06T11:12:15.913

是的，我可以看到以某种严格定义的方式布置你的 sql 的价值，但命名约定和你的意图肯定要重要得多。好像重要10倍。

基于此，我最讨厌以 tbl 为前缀的表和以 sp 为前缀的存储过程——我们知道它们是表和 SP。DB对象的命名远比有多少空格重要

只是我的 0.02 美元

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-09-08T08:45:54.340

我意识到我在这场辩论中已经很晚了，但我想谈谈我的想法。我绝对赞成在行首使用逗号。就像您说的[Adam Ralph](https://stackoverflow.com/users/49241/adam-ralph)一样，注释掉一个字段更容易，而且我也发现在开头时意外遗漏逗号更困难，虽然这听起来不是一个主要问题。过去我花了几个小时试图在冗长的 T-SQL 过程中追踪意外的语法错误，我不小心漏掉了行尾的逗号（我相信你们中的一些人可能也这样做过） . 我也赞成尽可能多地使用别名。

不过，总的来说，我意识到这完全取决于个人喜好，对某些人有效的方法对其他人无效。只要您可以轻松阅读代码并且每个开发人员在整个过程中都表现出一定的风格一致性，我认为这是最重要的。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-05-17T02:28:49.193

我喜欢：

```
SELECT ST.ColumnName1, JT.ColumnName2, SJT.ColumnName3 --leave all selected columns on the same line
FROM 
    SourceTable ST
INNER JOIN JoinTable JT ON JT.SourceTableID = ST.SourceTableID
INNER JOIN SecondJoinTable SJT --only splitting lines when more than 1 condition
    ON ST.SourceTableID = SJT.SourceTableID
    AND JT.Column3 = SJT.Column4
WHERE
    ST.SourceTableID = X
    and JT.ColumnName3 = Y 
```

在更小的查看区域中获取更多代码。我也相信关键字应该大写

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-11-13T20:36:11.970

我完全同意您在项目中和一般情况下标准化 SQL 格式的努力。

我也非常同意您的格式选择。我想出了几乎相同的一个，除了我还缩进了'join'语句，并且用它们'on'语句再缩进一个。

非常喜欢您在关键字上使用小写字母的事实 - 谁想要那些对您大喊大叫的人。我也更喜欢小写表格别名 - 提高可读性

非常类似于您使用小缩进 (4) 的事实。我选择（3）。

我拒绝使用“内部”和“外部”这两个术语，因为那时是不必要的。

以下是您的 select 语句的格式：

```
select
   st.ColumnName1,
   jt.ColumnName2,
   sjt.ColumnName3
from 
   SourceTable st
   join JoinTable jt on jt.SourceTableID = st.SourceTableID
   join SecondJoinTable sjt on
      st.SourceTableID = sjt.SourceTableID and
      jt.Column3 = sjt.Column4
where
   st.SourceTableID = X
   and jt.ColumnName3 = Y
; 
```

感谢您讨论这个问题。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-04-12T15:59:41.930

这个线程有很多优点。我一直试图说服人们使用的一个标准是将逗号放在每一列之前的同一行。像这样：

```
Select column1
   ,column2
   ,column3
   ,column4
   ,Column5 ...ect 
```

反对：

```
Select column1,
   column2,
   column3, ect... 
```

我喜欢这种做法的原因是，如果有必要，您可以注释掉一行，并且当您运行它时不会出现逗号问题，因为相应的逗号也被注释掉了。我知道我在线程中看到另一个用户也这样做了，但并没有真正指出这一点。不是一个巨大的启示，而是我的两分钱。谢谢

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2018-08-08T07:51:22.070

这是我使用的格式。请评论是否可以做得更好。

```
CREATE PROCEDURE [dbo].[USP_GetAllPostBookmarksByUserId]
    @id INT,
    @startIndex INT,
    @endIndex INT
AS
BEGIN

    SET NOCOUNT ON

    SELECT      *
    FROM
            (   SELECT      ROW_NUMBER() OVER ( ORDER BY P.created_date ) AS row_num, P.post_id, P.title, P.points, p.estimated_read_time, P.view_count, COUNT(1) AS "total_attempts" -- todo
                FROM        [dbo].[BOOKMARKED] B
                INNER JOIN  [dbo].[POST] P
                ON          B.entity_id = P.post_id
                INNER JOIN  [dbo].[ATTEMPTED] A
                ON          A.entity_id = P.post_id
                WHERE       B.user_id = 1 AND P.is_active = 1
                GROUP BY    P.post_id, P.title, P.points, p.estimated_read_time, P.view_count
            )   AS PaginatedResult
    WHERE       row_num >= @startIndex
    AND         row_num < @endIndex
    ORDER BY    row_num

END 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2018-10-24T17:34:02.793

我的答案将类似于接受的答案`John Sansom answered Feb 6 '09 at 11:05`。[但是，我将在 NOTEPAD++ 中使用 SQLInForm 插件](https://www.sqlinform.com/free-notepad-plugin/)演示一些格式化选项，而不是他对 Red Gate 的 SQL Prompt 的回答。

SQLInForm 插件有 5 种不同的配置文件可供您设置。在配置文件中，免费和付费版本都有很多可用的设置。下面是一个详尽的列表，您可以在线查看他们的[插件帮助常规选项](https://www.sqlinform.com/npp-plugin-help-general-options/)页面。

我认为展示可用的 SQLInForm 选项会很有用，而不是漫无边际地谈论我的偏好。我的一些偏好也在下面注明。在我的帖子末尾是原始帖子中使用的格式化 SQL 代码（`original`VS `format1`VS `format2`）。

在这里阅读其他答案-在几件事上我似乎是少数。我喜欢`leading commas`（[这里的短视频](https://hackernoon.com/winning-arguments-with-data-leading-with-commas-in-sql-672b3b81eac9)）--IMO，选择新字段时更容易阅读。而且我喜欢我的`Column1 with linebreak`而不是旁边的 SELECT。

* * *

以下是我的一些偏好说明的概述，考虑到 SELECT 语句。我会添加所有 13 个部分的屏幕截图；但这是很多截图，我只是鼓励你使用免费版——截取一些截图，并测试格式控制。我将很快测试 Pro 版；但根据选项，它看起来真的很有帮助，而且只需 20 美元。

## **SQLInForm Notepadd++：选项和首选项**

> **1\. 一般（免费）**
> 
> > DB：任何 SQL、DB2/UDB、Oracle、MSAccess、SQL Server、Sybase、MYSQL、PostgreSQL、Informix、Teradata、Netezza SQL
> > 
> > [智能缩进]= FALSE
> 
> **2\. 颜色（免费）**
> 
> **3.关键词（专业版）**
> 
> > [大写/小写]> 关键字
> 
> **4.换行符>列表（免费）**
> 
> > [逗号前]=TRUE 5
> > 
> > [将逗号向左移动 2 列]= FALSE
> 
> **5.换行>选择（专业版）**
> 
> > [加入> 加入后]= FALSE
> > 
> > [JOIN> ON 之前]= FALSE
> > 
> > （没有变化）--> [JOIN> Indent JOIN]; [加入>开启后]
> 
> **6.换行符> Ins/Upd/Del (PRO)**
> 
> **7.换行>条件（PRO）**
> 
> > CASE Statement--> [WHEN], [THEN], [ELSE] ...当然想玩这些设置并选择一个好的
> 
> **8\. 对齐 (PRO)**
> 
> > （没有变化）--> [JOIN> Indent JOIN]; [加入>开启后]
> 
> **9.空白（专业版）**
> 
> > （更改？）空白行 [全部删除]=TRUE；[保留全部]; [保留一个]
> 
> **10\. 评论（专业版）**
> 
> > （更改？） Line & Block--> [Linebreak Before/After Block Comments]=TRUE; [将行注释更改为块]；[封锁成线]
> 
> **11\. 存储过程 (PRO)**
> 
> **12\. 高级（专业版）**
> 
> > （可能有用）从程序代码中提取 SQL-> [ExtractSQL]
> 
> **13\. 执照**

* * *

## **SQL 代码**

原始查询格式。

```
select
    ST.ColumnName1,
    JT.ColumnName2,
    SJT.ColumnName3
from 
    SourceTable ST
inner join JoinTable JT
    on JT.SourceTableID = ST.SourceTableID
inner join SecondJoinTable SJT
    on ST.SourceTableID = SJT.SourceTableID
    and JT.Column3 = SJT.Column4
where
    ST.SourceTableID = X
    and JT.ColumnName3 = Y 
```

转换首选格式（选项 #1：加入无换行符）

```
SELECT
    ST.ColumnName1
    , JT.ColumnName2
    , SJT.ColumnName3
FROM
    SourceTable ST
    inner join JoinTable JT 
        on JT.SourceTableID = ST.SourceTableID
    inner join SecondJoinTable SJT
        on ST.SourceTableID = SJT.SourceTableID
        and JT.Column3      = SJT.Column4
WHERE
    ST.SourceTableID   = X
    and JT.ColumnName3 = Y 
```

转换首选格式（选项 #2：使用换行符连接）

```
SELECT  
    ST.ColumnName1
    , JT.ColumnName2
    , SJT.ColumnName3
FROM
    SourceTable ST
    inner join
        JoinTable JT
        on JT.SourceTableID = ST.SourceTableID
    inner join
        SecondJoinTable SJT
        on ST.SourceTableID = SJT.SourceTableID
        and JT.Column3      = SJT.Column4
WHERE
    ST.SourceTableID   = X
    and JT.ColumnName3 = Y 
```

希望这可以帮助。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-08-15T14:21:53.620

迟到总比不到好。我使用了一种不同的风格，并从我曾经合作过的一位非常优秀的 SQL 开发人员那里采用了它。我右对齐关键字，我不使用大写字母以便于输入。关键字将由编辑器突出显示，除非您在不支持关键字突出显示功能的文本编辑器中进行大量编辑，否则我认为它们不需要大写。我并没有试图让它紧凑，而是尽可能地更具可读性和垂直对齐。以下是从@BenLaan 答案中选取的示例，以我的格式编写：

```
select st.ColumnName1
       , jt.ColumnName2
       , sjt.ColumnName3
  from SourceTable st
         inner join
       JoinTable jt
         on jt.SourceTableID = st.SourceTableID
         inner join
       SecondJoinTable sjt
         on st.SourceTableID = sjt.SourceTableID
         and st.SourceTable2ID = sjt.SourceTable2ID
 where st.SourceTableID = X
       and jt.ColumnName3 = Y
       and jt.Column3 = sjt.Column4
 order by st.ColumnName1 
```

试图让所有团队都遵循相同的格式模式是最困难的事情。如果其他人都遵循相同的方式，我会遵循任何格式，但它从来都不是同一个故事。

更新：重写前面文章中提到的复杂查询之一：

```
select
       term
       , student_id
       , case
           when((ft_credits > 0 and credits >= ft_credits) or (ft_hours_per_week > 3 and hours_per_week >= ft_hours_per_week))
             then 'F'
           else 'P'
         end as status
  from (select term
               , student_id
               , pm.credits AS ft_credits
               , pm.hours AS ft_hours_per_week
               , SUM(credits) AS credits
               , SUM(hours_per_week) AS hours_per_week
          from (select e.term
                       , e.student_id
                       , nvl(o.credits, 0) credits
                       , case
                           when nvl(o.weeks, 0) > 5 
                             then (nvl(o.lect_hours, 0) + nvl(o.lab_hours, 0) + nvl(o.ext_hours, 0)) / nvl(o.weeks, 0)
                           else 0
                        end as hours_per_week
                  from enrollment as e
                         inner join 
                       offering as o using (term, offering_id)
                         inner join
                       program_enrollment as pe 
                         on e.student_id = pe.student_id 
                         and e.term = pe.term 
                         and e.offering_id = pe.offering_id
                 where e.registration_code not in ('A7', 'D0', 'WL')
                )
                  inner join 
                student_history as sh using (student_id)
                  inner join 
                program_major as pm 
                  on sh.major_code_1 = pm._major_code and sh.division_code_1 = pm.division_code
         where sh.eff_term = (select max(eff_term)
                                from student_history as shi
                               where sh.student_id = shi.student_id
                                     and shi.eff_term <= term)
         group by term, student_id, pm.credits, pm.hours
        )
 order by term, student_id 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-02-27T21:17:22.247

我喜欢这样格式化我的 SQL，尽管只要意图易于阅读，大多数任何格式都可以使用。我真的很讨厌看到在查询设计器中创建的语句然后就这样离开了。如果我正在编辑其他人的程序/视图/函数/触发器等，我将尝试保持已经使用的格式（除非它真的很糟糕，那么我将重新格式化整个内容）。

选择语句

```
SELECT ST.ColumnName1, JT.ColumnName2, SJT.ColumnName3
  FROM SourceTable ST INNER JOIN
       JoinTable JT ON JT.SourceTableID = ST.SourceTableID 
       INNER JOIN
       SecondJoinTable SJT ON ST.SourceTableID = SJT.SourceTableID
                          AND JT.Column3 = SJT.Column4
WHERE (ST.SourceTableID = X)
  AND (JT.ColumnName3 = Y); 
```

更新声明

```
UPDATE TargetTable SET
       ColumnName1 = @value,
       ColumnName2 = @value2
 WHERE (Condition1 = @test); 
```

插入语句

```
INSERT INTO TargetTable 
           (
             ColumnName1,
             ColumnName2,
             ColumnName3
           ) 
           values 
           (
             @value1,
             @value2,
             @value3
           ); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-06-13T18:00:49.793

我喜欢的风格：

```
SELECT
  ST.ColumnName1,
  JT.ColumnName2,
  SJT.ColumnName3
FROM
  SourceTable ST
INNER JOIN
  JoinTable JT
ON
  JT.SourceTableID = ST.SourceTableID
INNER JOIN
  SecondJoinTable SJT
ON
  ST.SourceTableID = SJT.SourceTableID
WHERE
  ST.SourceTableID = X
AND
  JT.ColumnName3 = Y
AND
  JT.Column3 = SJT.Column4 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-06-14T20:22:42.803

```
SELECT st.ColumnName1
      ,jt.ColumnName2
      ,sjt.ColumnName3
FROM   SourceTable st
JOIN   JoinTable jt ON jt.SourceTableID = st.SourceTableID
JOIN   SecondJoinTable sjt ON SstT.SourceTableID = sjt.SourceTableID
                              AND jt.Column3 = sjt.Column4
WHERE  st.SourceTableID = X
       AND jt.ColumnName3 = Y 
```

我对动作词、连接词或从句使用全部大写，它们更突出。JOIN 和 INNER JOIN 一样，所以 INNER 不需要写出来，假设需要的时候写 OUTER JOIN 或 LEFT JOIN。我的别名也使用小写。如果您注释掉最后一列，您会遇到上面的逗号并且查询失败，这是常见的原因。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-11-16T16:39:40.887

已经有一百个答案了，但经过多年的反复推敲，这就是我所决定的：

```
SELECT      ST.ColumnName1
          , JT.ColumnName2
          , SJT.ColumnName3

FROM        SourceTable       ST
JOIN        JoinTable         JT  ON  JT.SourceTableID  =  ST.SourceTableID
JOIN        SecondJoinTable  SJT  ON  ST.SourceTableID  =  SJT.SourceTableID
                                  AND JT.Column3        =  SJT.Column4

WHERE       ST.SourceTableID  =  X
AND         JT.ColumnName3    =  Y 
```

我知道这会造成混乱的差异，因为一个额外的表可能会导致我重新缩进许多代码行，但为了便于阅读，我喜欢它。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2018-12-18T22:27:57.797

[这是我个人的 SQL 风格指南](https://gist.github.com/mattmc3/38a85e6a4ca1093816c08d4815fbebfb)。它基于其他几个，但有一些主要的风格特征 - 小写关键字，没有无关的关键字（例如`outer`, `inner`, `asc`）和“河流”。

示例 SQL 如下所示：

```
-- basic select example
select p.Name as ProductName
     , p.ProductNumber
     , pm.Name as ProductModelName
     , p.Color
     , p.ListPrice
  from Production.Product as p
  join Production.ProductModel as pm
    on p.ProductModelID = pm.ProductModelID
 where p.Color in ('Blue', 'Red')
   and p.ListPrice < 800.00
   and pm.Name like '%frame%'
 order by p.Name

-- basic insert example
insert into Sales.Currency (
    CurrencyCode
    ,Name
    ,ModifiedDate
)
values (
    'XBT'
    ,'Bitcoin'
    ,getutcdate()
)

-- basic update example
update p
   set p.ListPrice = p.ListPrice * 1.05
     , p.ModifiedDate = getutcdate()
  from Production.Product p
 where p.SellEndDate is null
   and p.SellStartDate is not null

-- basic delete example
delete cc
  from Sales.CreditCard cc
 where cc.ExpYear < '2003'
   and cc.ModifiedDate < dateadd(year, -1, getutcdate()) 
```

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2015-06-02T15:37:19.320

我认为拥有良好的格式规则非常重要，因为您可以轻松发现和修复错误。正如它所说 - “你编写代码一次，这段代码被读取了 10000000 次”，所以花一些时间在格式化上总是好的。主要目标是：

*   使您的代码更易于阅读和理解
*   最大限度地减少维护或扩展代码所需的工作量
*   减少系统用户和开发人员查阅代码注释或软件手册等辅助文档资源的需要

我经常使用的一些规则：

*   始终使用 . 符号
*   总是在列之前使用别名，所以 . 符号
*   我把`and`and`or`放到了行尾
*   不要使用不必要的括号
*   不要使用大写
*   通常更喜欢使用 CTE 而不是嵌套子查询

作为一个例子，这里我将如何格式化在这个问题中用作示例的查询：

```
select
    ST.ColumnName1,
    JT.ColumnName2,
    SJT.ColumnName3
from <schema>.SourceTable as ST
    inner join <schema>.JoinTable as JT on
        ST.SourceTableID = JT.SourceTableID
    inner join <schema>.SecondJoinTable as SJT on
        SJT.SourceTableID = ST.SourceTableID and
        SJT.Column4 = JT.Column3
where
    ST.SourceTableID = X and
    JT.ColumnName3 = Y 
```

和“学生”查询：

```
select
    term,
    student_id,
    case
        when (ft_credits > 0 and credits >= ft_credits) or (ft_hours_per_week > 3 and hours_per_week >= ft_hours_per_week) then 'F'
        else 'P'
    end as [status]
from (
    select
        a.term,
        a.student_id,
        pm.credits as ft_credits,
        pm.[hours] as ft_hours_per_week,
        sum(a.credits) as credits,
        sum(a.hours_per_week) as hours_per_week
    from (
        select
            e.term, e.student_id, NVL(o.credits, 0) credits,
            case
                when NVL(o.weeks, 0) > 5 then
                    (NVL(o.lect_hours, 0) + NVL(o.lab_hours, 0) + NVL(o.ext_hours, 0)) / NVL(o.weeks, 0)
                else
                    0
            end as hours_per_week
        from enrollment as e
            inner join offering as o using (term, offering_id)
            inner join program_enrollment as pe on pe.student_id = e.student_id and pe.term = e.term and pe.offering_id = e.offering_id
        where
            e.registration_code Not in ('A7', 'D0', 'WL')
    ) as a
        inner join student_history as sh using (student_id)
        inner join program_major as pm on pm._major_code = sh.major_code_1 and pm.division_code = sh.division_code_1
    where
        sh.eff_term = 
            (
                select max(eff_term)
                from student_history as shi
                where
                    shi.student_id = sh.student_id and
                    shi.eff_term <= term
             )
    group by
        a.term,
        a.student_id,
        pm.credits,
        pm.[hours]
) as a
order by
    term,
    student_id 
```

* * *

## 回答 #28

> 赞同：-5
> 
> 时间：2015-02-17T16:26:41.567

看来你们中的大多数人仍在使用仅支持 800x600 的显示器。我的显示器会做 1920x1080，所以我想用完右边的所有空间。

这个怎么样：

```
select col1, col2, col3
, case when x = 1 then 'answer1'
       else 'answer2'
  end
, col4, col5, col6, col7
from table1 t1
inner join table2 t2 on t1.col1 = t2.col1 and t1.col2 and t2.col2
where t1.col5 = 19 and t1.col7 = 'Bill Gates' 
```

# java - 在数组中查找最接近的数字

> ID：519881
> 
> 赞同：12
> 
> 时间：2009-02-06T10:58:19.857
> 
> 标签：java

在一个数组中，我们首先必须找出其中是否存在所需的数字？如果没有，那么我将如何在 Java 中找到与给定所需数字更接近的数字？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-06T11:07:42.693

一个主意：

```
int nearest = -1;
int bestDistanceFoundYet = Integer.MAX_INTEGER;
// We iterate on the array...
for (int i = 0; i < array.length; i++) {
  // if we found the desired number, we return it.
  if (array[i] == desiredNumber) {
    return array[i];
  } else {
    // else, we consider the difference between the desired number and the current number in the array.
    int d = Math.abs(desiredNumber - array[i]);
    if (d < bestDistanceFoundYet) {
      // For the moment, this value is the nearest to the desired number...
      bestDistanceFoundYet = d; // Assign new best distance...
      nearest = array[i];
    }
  }
}
return nearest; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T13:04:10.697

“更接近”的另一个常见定义是基于差异的平方。大纲类似于 romaintaz 提供的大纲，除了你要计算

```
long d = ((long)desiredNumber - array[i]); 
```

然后比较`(d * d)`最近的距离。

***请注意*** *，我输入`d`as`long`而不是`int`避免溢出，即使使用基于绝对值的计算也会发生这种情况。*（例如，考虑当`desiredValue`至少是最大 32 位有符号值的一半时会发生什么，并且数组包含一个具有相应幅度但为负号的值。）

最后，我会编写方法来返回所定位值的索引，而不是值本身。在这两种情况中的任何一种情况下：

*   当数组的长度为零时，并且
*   如果您添加一个“公差”参数来限制您将视为匹配的最大差异，

您可以将`-1`其用作类似于规范的带外值`indexOf`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-26T09:44:12.670

//这将起作用

```
public int nearest(int of, List<Integer> in)
{
int min = Integer.MAX_VALUE;
int closest = of;

for (int v : in) 
{
    final int diff = Math.abs(v - of);

    if (diff < min) 
    {
        min = diff;
        closest = v;
    }
}
return closest;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T12:30:20.640

伪代码返回最接近的整数列表。

```
myList = new ArrayList();          

if(array.length==0) return myList; 

myList.add(array[0]);

int closestDifference = abs(array[0]-numberToFind);

for (int i = 1; i < array.length; i++) {

 int currentDifference= abs(array[i]-numberToFind);

  if (currentDifference < closestDifference) {

    myList.clear();

    myList.add(array[i]);

         closestDifference = currentDifference;

  } else {

    if(currentDifference==closestDifference) {

        if( myList.get(0) !=array[i]) && (myList.size() < 2) {

            myList.add(array[i]);

        }
            }

       }

}

return myList; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T11:10:07.820

如果数组已排序，则执行修改后的二进制搜索。基本上如果你没有找到数字，那么在搜索结束时返回下限。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T11:55:38.790

唯一缺少的是更接近的语义。

如果您正在寻找六个并且您的阵列有四个和八个，您会怎么做？

哪个最接近？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T14:18:03.370

```
 int d = Math.abs(desiredNumber - array[i]);
    if (d < bestDistanceFoundYet) {
      // For the moment, this value is the nearest to the desired number...
      nearest = array[i];
    } 
```

通过这种方式，您可以找到更接近所需数字的最后一个数字，因为**bestDistanceFoundYet**是常数，并且**d**记住最后一个值传递 if *(d<...)*。

如果您想通过所需数字找到更接近的数字（**d**无关紧要），您可以记住最后一个可能的值。如果你可以测试

```
if(d<last_d_memorized){ //the actual distance is shorter than the previous
    // For the moment, this value is the nearest to the desired number...
          nearest = array[i];
    d_last_memorized=d;//is the actual shortest found delta 
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-06T11:03:43.793

`Array.indexOf()`找出元素是否存在。如果不是，则遍历一个数组并维护一个变量，该变量保存所需元素和`i`第 - 个元素之间差异的绝对值。返回具有最小绝对差的元素。

总体复杂度为*O(2n)*，可以进一步简化为对数组的单次迭代（即*O(n)*）。不过不会有太大区别。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-12T15:42:09.410

```
// paulmurray's answer to your question is really the best :

// The least square solution is way more elegant, 
// here is a test code where numbertoLookFor
// is zero, if you want to try ...

import java.util.* ;

public class main {
    public static void main(String[] args) 
    {
        int[] somenumbers = {-2,3,6,1,5,5,-1} ;
        ArrayList<Integer> l = new ArrayList<Integer>(10) ;
        for(int i=0 ; i<somenumbers.length ; i++)
        {
            l.add(somenumbers[i]) ;
        }
        Collections.sort(l, 
                new java.util.Comparator<Integer>()
                {
                    public int compare(Integer n1, Integer n2)
                    {
                        return n1*n1 - n2*n2 ;
                    }
                }
        ) ;
        Integer first = l.get(0) ;
        System.out.println("nearest number is " + first) ;  
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-09-18T21:46:16.653

需要指出的几点：

1 - 您可以使用将数组转换为列表

```
Arrays.asList(yourIntegerArray); 
```

2 - 使用列表，您可以只使用 indexOf()。

3 - 考虑一个场景，你有一个长度的列表，你想要最接近 3 的数字，你已经发现 2 在数组中，并且你知道 3 不是。在不检查其他数字的情况下，您可以放心地得出结论，2 是最好的，因为不可能更接近。但是，我不确定 indexOf() 是如何工作的，因此这实际上可能不会加快您的速度。

4 - 在 3 上展开，假设 indexOf() 花费的时间不超过获取索引处的值。然后，如果您想要数组中最接近 3 的数字并且您已经找到 1，并且还有更多数字要检查，那么只检查数组中是 2 还是 4 会更快。

5 - 扩展 3 和 4，我认为可以将其应用于浮点数和双精度数，尽管它需要您使用小于 1 的步长...计算多小似乎超出了问题的范围.

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-02-07T02:11:40.137

```
int[] somenumbers = getAnArrayOfSomenumbers();
int numbertoLookFor = getTheNumberToLookFor();

boolean arrayContainsNumber = 
   new HashSet(Arrays.asList(somenumbers))
      .contains(numbertoLookfor); 
```

它也很快。

哦 - 你想找到最近的号码吗？在这种情况下：

```
int[] somenumbers = getAnArrayOfSomenumbers();
int numbertoLookFor = getTheNumberToLookFor();

ArrayList<Integer> l = new ArrayList<Integer>(
  Arrays.asList(somenumbers)
);
Collections.sort(l);
while(l.size()>1) {
  if(numbertoolookfor <= l.get((l.size()/2)-1)) {
    l = l.subList(0, l.size()/2);
  }
  else {
    l = l.subList(l.size()/2, l.size); 
  }
}

System.out.println("nearest number is" + l.get(0)); 
```

哦 - 等等：你在寻求最小二乘解决方案吗？

```
Collections.sort(l,  new Comparator<Integer>(){
  public int compare(Integer o1, Integer o2) {
    return (o1-numbertoLookFor)*(o1-numbertoLookFor) - 
           (o2-numbertoLookFor)*(o2-numbertoLookFor);
  }});

System.out.println("nearest number is" + l.get(0)); 
```

# java - 解析元素中包含 XML 的 XML，可以这样做吗

> ID：519882
> 
> 赞同：3
> 
> 时间：2009-02-06T10:59:03.880
> 
> 标签：java, xml

我有一个在 XML 中的“复杂项目”，然后是一个包含许多其他信息的“工作项目”（在 xml 中），我希望它包含一个包含 xml 中复杂项目的字符串。

例如：

```
<inouts name="ClaimType" type="complex" value="<xml string here>"/> 
```

但是，尝试 SAX 和其他 java 解析器我无法让它处理这一行，它不喜欢字符串中的 < 或 "'，我尝试转义，并将 " 转换为 '。

反正有这个吗？还是我必须想出另一个解决方案？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T11:08:14.843

可能最简单的解决方案是使用[CDATA](http://www.w3schools.com/XML/xml_cdata.asp)部分。您可以将示例转换为如下所示：

```
<inouts name="ClaimType" type="complex">
  <![CDATA[
    <xml string here>
  ]]>
</inouts> 
```

如果您有多个要存储复杂字符串的属性，则可以使用多个具有不同名称的子元素：

```
<inouts name="ClaimType" type="complex">
  <value1>
    <![CDATA[
      <xml string here>
    ]]>
  </value1>
  <value2>
    <![CDATA[
      <xml string here>
    ]]>
  </value2>
</inouts> 
```

或具有标识 id 的多个值元素：

```
<inouts name="ClaimType" type="complex">
  <value id="complexString1">
    <![CDATA[
      <xml string here>
    ]]>
  </value>
  <value id="complexString2">
    <![CDATA[
      <xml string here>
    ]]>
  </value>
</inouts> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T11:35:31.997

我想你会发现你正在处理的 XML 不会被很多解析器解析，因为它是无效的。如果您可以控制 XML，那么您至少需要转义该属性，因此它类似于：

```
<inouts name="ClaimType" type="complex" value="&lt;xml string here&gt;" /> 
```

然后，一旦您提取了属性，您就可以重新解析它以将其视为 XML。

或者，您可以采用上述方法之一（使用 CDATA 部分）对 XML 进行一些重构。

如果你无法控制你的 XML，你可以尝试使用[TagSoup 库](http://www.ccil.org/~cowan/XML/tagsoup/)来解析它，看看你是怎么做的。（免责声明：我只将 TagSoup 用于 HTML，我不知道如何处理非 HTML 内容）

（标签汤站点实际上出现在 ATM 下，但您应该能够在网络上找到足够的 doco，并通过[maven 存储库](http://repo1.maven.org/maven2/org/ccil/cowan/tagsoup/tagsoup/)下载）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T12:00:35.003

[CDATA](http://www.w3.org/TR/REC-xml/#sec-cdata-sect)部分或[转义](http://www.w3.org/TR/REC-xml/#dt-escape)

注意转义和编码之间有很大的区别，其他一些海报已经提到过。小心混淆两者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T11:10:38.397

我不确定它对属性是如何工作的，如果转义（< as < 和 > as >）不起作用，那么我不知道。

如果它是一个内部标记：您可以使用 Xml Any 机制（我自己从未使用过）或在 CDATA 部分中声明它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T14:53:08.230

你是[http://www.doingitwrong.com/](http://www.doingitwrong.com/)

如果`inouts/@value`真的是树形结构（即 XML），那么它不应该是一个属性，它应该是一个子元素：

```
<inout name="ClaimType" type="complex">
    <value>
        <some-arbitrary>
            <xml-stuff/>
        </some-arbitrary>
    </value>
</inout> 
```

如果它实际上不能保证是格式良好的 XML，只是看起来有点像，因为你在其中放了一些尖括号，那么你应该问问自己是否有更好的方法来解决这个问题。失败，`<![CDATA[`就像一些人已经建议的那样使用。

# c# - 通过随机数生成确保均匀（ish）分布

> ID：519891
> 
> 赞同：1
> 
> 时间：2009-02-06T11:03:29.457
> 
> 标签：c#, .net, list, queue, random

我有一个对象列表，我想以随机顺序连续访问这些对象。

我想知道是否有办法确保随机值并不总是相似。

例子。

我的列表是一个队列列表，我试图将这些值交错以产生一个用于测试的真实场景。

我并不特别希望队列 1 和 2 中的所有项目都排在任何其他项目之前。有没有保证的方法来做到这一点？

谢谢

编辑 :: 我拥有的队列列表基本上是我正在传输到网络服务的文件列表。文件需要按特定顺序排列，因此需要队列。

所以我有 Queue1 = "set1_1.xml", set1_2.xml", ... "set1_n.xml" Queue2 ... ... QueueN

虽然每个文件都需要根据其队列中的其他文件按顺序传输，但我想模拟一个真实世界的模拟，其中文件将在不同时间从不同来源接收，因此它们交错。

目前我只是在 0 到（队列数）上使用一个简单的 rand 来确定下一个要出列的文件。这行得通，但我在问是否有可能获得更多的统一性，而不是从队列 1 和 2 中获得 50 个文件，然后从队列 3 中获得 5 个文件。

我确实意识到改变随机性不再使其随机化。

感谢您的所有回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T11:11:32.047

好吧，场景是什么并不完全清楚，但随机的事情是*你永远无法分辨;-p*。您尝试做的任何“保证”变薄都可能会减少随机性。

你怎么样？我个人会做类似的事情：

```
static IEnumerable<T> GetItems<T>(IEnumerable<Queue<T>> queues)
{
    int remaining = queues.Sum(q => q.Count);
    Random rand = new Random();
    while (remaining > 0)
    {
        int index = rand.Next(remaining);
        foreach (Queue<T> q in queues)
        {
            if (index < q.Count)
            {
                yield return q.Dequeue();
                remaining--;
                break;
            }
            else
            {
                index -= q.Count;
            }
        }
    }
} 
```

这在整个集合中应该是相当统一的。这里的技巧是，通过将队列视为单个大队列，趋势是具有大量项目的队列将更快地出队（因为在其范围内获得索引的机会更大）。这意味着它应该自动平衡队列之间的消耗，以便它们在（大致）同时耗尽。如果您没有 LINQ，只需更改第一行：

```
int remaining = 0;
foreach(Queue<T> q in queues) {remaining += q.Count;} 
```

示例用法：

```
static void Main()
{
    List<Queue<int>> queues = new List<Queue<int>> {
        Build(1,2,3,4,5), Build(6,7,8), Build(9,10,11,12,13)
    };
    foreach (int i in GetItems(queues))
    {
        Console.WriteLine(i);
    }
}
static Queue<T> Build<T>(params T[] items)
{
    Queue<T> queue = new Queue<T>();
    foreach (T item in items)
    {
        queue.Enqueue(item);
    }
    return queue;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T11:13:09.810

这取决于你真正想要什么...

如果“随机”值是真正随机的，那么您**将**获得具有足够迭代次数的均匀分布。

如果您正在谈论*控制*或*操纵*分布，那么这些值将不再是真正随机的！

因此，您可以拥有：

*   *具有*均匀分布的真正随机值，或
*   *受控*分布，但不再是真正随机的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T11:32:25.827

您是否正在尝试洗牌？

如果是这样，您可以通过按随机值对其进行排序来做到这一点。

尝试这样的事情：

```
private Random random = new Random();
public int RandomSort(Queue q1, Queue q2)
{
  if (q1 == q2) { return 0; }
  return random.Next().CompareTo(random.Next());
} 
```

然后在调用 List.Sort(); 时使用 RandomSort 作为参数；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T11:33:22.360

如果要排队的项目有一个 GetHashCode() 算法，该算法将值均匀地分布在所有整数上，您可以对哈希值使用取模运算符来指定要将项目添加到哪个队列。这与哈希表用于确保值的均匀分布的原则基本相同。

# javascript - 在Javascript中从二维数组中删除重复项

> ID：519899
> 
> 赞同：0
> 
> 时间：2009-02-06T11:04:51.247
> 
> 标签：javascript, algorithm, sorting

什么是一个很好的算法来删除数组上的欺骗，如下所示......

```
 var allwords = [

    ['3-hidroxitiramina', '3-hidroxitiramina'],

    ['3-hidroxitiramina', '3-hidroxitiramina'],

    ['3-in-1 block', 'bloqueo 3 en 1'],

    ['abacterial', 'abacteriano'],

    ['abacteriano', 'abacteriano'],

    ['abciximab', 'abciximab'],

... 
```

只是为了澄清，我想要一个

```
['3-hidroxitiramina', '3-hidroxitiramina'], 
```

被删除，所以只有一个

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T11:12:44.710

您可以将对象用作关联数组/哈希（如果您的意思是第一维中的重复）

```
var allWordsObj = {};
for( var i = 0; i < allWords.length; i++ ) {
    allWordsObj[allWords[i][0]] = allWords[i][1];
}

alert( allWordsObj['3-hidroxitiramina'] ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T11:25:30.973

试试这个：

```
var len = allwords.length, i, j, first;
for (i=0; i<len-1; i++) {
    first = allwords[i].toString();
    for (j=i+1; j<len; j++) {
        if (first === allwords[j].toString()) {
            allwords.splice(j, 1);
            len--;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T11:25:47.947

[编辑]：误读，在阅读您的说明后，我建议：

```
 var i = allwords.length-1, prev='';
 do {
     if (allwords[i].join('/') === prev) {
        allwords.splice(i,1);
     }
     prev = allwords[i].join('/');
 } while (i-- && i>-1); 
```

（反转循环是一个优化步骤）

# windows - 如何将 alt + f1 键分配给打开的 Windows 应用程序

> ID：519900
> 
> 赞同：4
> 
> 时间：2009-02-06T11:05:05.880
> 
> 标签：windows, windows-vista

我通常有超过 10 个打开的应用程序窗口。当我编写代码时，我需要在浏览器、IDE 和终端窗口之间快速切换。Alt + tab 太慢了，有太多窗口可供选择。

虚拟桌面对我来说是一种解决方法。在第一个桌面上，我保留浏览器，在第二个 IDE 等上。所以我能够在我最重要的应用程序之间快速切换。

还有问题。是否有适用于 Windows XP / Vista 的实用程序允许将 alt + f1 .. f10 之类的键盘快捷键分配给打开的应用程序窗口？

更新：我发现的所有程序都允许定义应用程序的快捷方式。例如，他们将打开新的 Firefox 实例，而不是切换到已打开的实例。最接近我需要的是[Switcher](http://insentient.net/)。它显示所有打开的窗口的大缩略图，并分配了要按下的数字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T22:25:58.450

我发现[Autohotkey非常强大。](http://www.autohotkey.com/)这是我的测试脚本的一部分。

```
SetTitleMatchMode, 2

#z::Run http://stackoverflow.com/

^!n::
IfWinExist Notepad
    WinActivate
else
    Run Notepad
return

!F1::
IfWinExist Firefox
    WinActivate
else
    Run Firefox
return

!F2::
IfWinExist Commander
    WinActivate
return

!F3::
IfWinExist Carbide
    WinActivate
return 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T13:37:37.150

只需使用 Win32 api KBS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T15:06:18.373

那里有相当数量的键盘快捷键共享软件应用程序。看看 Stardock 的[Keyboard Launchpad](http://www.stardock.com/products/klp/)，它应该能够做这样的事情。

# java - 为什么要避免使用 final 关键字？

> ID：519914
> 
> 赞同：12
> 
> 时间：2009-02-06T11:10:44.653
> 
> 标签：java, inheritance, final, extends

在 java 中，是否有允许扩展非抽象类的情况？

当有类层次结构时，它似乎总是指示错误的代码。你同意吗，为什么/为什么不同意？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-06T11:22:34.410

当然，有时有非最终的具体类是有意义的。但是，我同意 Kent 的观点——我相信默认情况下类应该是最终的（在 C# 中密封），并且 Java 方法默认情况下应该是最终的（就像在 C# 中一样）。

正如 Kent 所说，继承需要仔细的设计和文档 - 很容易认为您可以只覆盖单个方法，但不知道可以从基类调用该方法作为其余实现的一部分的情况。

有关此问题的更多讨论，请参阅[“如何设计继承类” 。](https://stackoverflow.com/questions/453879/how-do-you-design-a-class-for-inheritance)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-06T11:41:39.753

我同意 Jon 和 Kent 的观点，但就像 Scott Myers（在 Effective C++ 中）一样，我走得更远。我相信*每一堂课都应该是`abstract`，或者`final`*。也就是说，只有任何层次结构中的叶类才真正适合直接实例化。所有其他类（即继承中的内部节点）都是“未完成的”，因此应该是`abstract`.

进一步扩展通常的课程根本没有意义。如果类的某个方面值得扩展和/或修改，更简洁的方法是采用该类并将其分离为一个`abstract`基类和一个具体的可互换实现。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-06T11:17:00.037

这个问题同样适用于其他平台，例如 C# .NET。有些人（包括我自己）认为默认类型应该是最终的/密封的，并且需要明确解封以允许继承。

通过继承扩展是需要仔细设计的东西，而不是仅仅让一个类型不密封那么简单。因此，我认为允许继承应该是一个明确的决定。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-06T11:35:42.403

有充分的理由让您的代码保持非最终状态。许多框架，如 hibernate、spring、guice 有时依赖于它们在运行时动态扩展的非最终类。

例如，[hibernate](http://www.hibernate.org/hib_docs/reference/en/html/persistent-classes.html)使用代理进行延迟关联获取。特别是在涉及 AOP 时，您会希望您的类不是最终的，以便拦截器可以附加到它。另见[SO的问题](https://stackoverflow.com/questions/341624/aop-problem-running-spring-unit-tests)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-06T15:15:54.597

您最好的参考是 Joshua Bloch 的优秀著作“Effective Java”的第 15 条，名为“Design and document for inheritance or else improment it”。然而，是否允许类扩展的关键不是“它是抽象的”，而是“它是否在设计时考虑到了继承”。有时两者之间存在相关性，但重要的是第二个。举个简单的例子，大多数 AWT 类都被设计为可扩展的，即使是那些不是抽象的。

Bloch 章节的总结是，如果祖先不是被设计为从其继承的，那么继承类与其父类的交互可能会令人惊讶和不可预测。因此，类应该分为两种 a) 设计为可扩展的类，并且有足够的文档来描述它应该如何完成 b) 标记为 final 的类。(a) 中的类通常是抽象的，但并非总是如此。为了

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-06T11:21:06.113

我不同意。如果层次结构不好，就没有理由存在面向对象的语言。如果您查看 Microsoft 和 Sun 的 UI 小部件库，您肯定会发现继承。这就是定义上的所有“坏代码”吗？不，当然不。

继承可以被滥用，但任何语言特性也可以。诀窍是学习如何适当地做事。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-06T11:21:49.013

在某些情况下，您希望确保没有子类化，在其他情况下，您希望确保子类化（抽象）。但是，作为原始作者，您总是不关心也不应该关心的大部分类。这是打开/关闭的一部分。决定关闭某事*也是*有原因的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-06T16:38:51.573

我不能再不同意了。当具体类知道它们未标记为 final 的方法的可能返回类型时，类层次结构对具体类有意义。例如，一个具体的类可能有一个子类钩子：

```
protected SomeType doSomething() {
return null;
} 
```

此 doSomething 保证为 null 或 SomeType 实例。假设您有能力处理 SomeType 实例，但没有在当前类中使用 SomeType 实例的用例，但知道此功能在子类中非常有用，而且大多数内容都是具体的。如果当前类可以直接使用，默认情况下不对其 null 值执行任何操作，那么将当前类设为抽象类是没有意义的。如果您将其设为抽象类，那么您将在这种类型的层次结构中拥有其子类：

*   抽象基类
*   *   默认类（可能是非抽象的类，只实现受保护的方法，没有别的）
*   *   其他子类。

因此，您有一个不能直接使用的抽象基类，而默认类可能是最常见的情况。在另一个层次结构中，少了一个类，因此可以使用该功能而无需创建本质上无用的默认类，因为必须将抽象强加到类上。

*   默认类
*   *   其他子类。

现在，当然，可以使用和滥用层次结构，如果事情没有清楚地记录或类设计得不好，子类可能会遇到问题。但是抽象类也存在同样的问题，你不能仅仅因为你在你的类中添加了“抽象”就摆脱了这个问题。例如，如果上面的“doSomething()”方法的约定要求 SomeType 在通过 getter 和 setter 访问它们时填充 x、y 和 z 字段，那么无论您使用返回 null 的具体类，您的子类都会崩溃作为您的基类或抽象类。

设计类层次结构的一般经验法则几乎是一个简单的问卷：

1.  我的子类中是否需要我提议的超类的行为？（是/否）这是您需要问自己的第一个问题。如果您不需要该行为，则没有子类化的论据。

2.  我需要我的子类中我提议的超类的状态吗？（是/否）这是第二个问题。如果状态符合您需要的模型，这可能是子类化的候选者。

3.  如果子类是从提议的超类创建的，它真的是一个 IS-A 关系，还是只是继承行为和状态的捷径？这是最后一个问题。如果它只是一个捷径并且你不能限定你提议的子类“as-a”超类，那么应该避免继承。可以将状态和逻辑复制并粘贴到具有不同根的新类中，或者可以使用委托。

只有当一个类需要行为、状态并且可以认为是超类的子类IS-A(n)实例时，才应该认为它是从超类继承的。否则，存在其他更适合该目的的选项，尽管它可能需要更多的前期工作，但从长远来看它更清洁。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-06T11:16:23.720

在某些情况下，我们不想允许更改行为。例如，字符串类，数学。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-06T11:21:49.373

我不喜欢继承，因为总是有更好的方法来做同样的事情，但是当你在一个巨大的系统中进行维护更改时，有时以最少的更改修复代码的最佳方法是扩展一个类。是的，它通常会导致一个糟糕的代码，但会导致一个可以工作的代码，并且不需要先重写几个月。因此，为维护人员提供尽可能多的灵活性是一个不错的方法。

# delphi - delphi直接文件访问

> ID：519916
> 
> 赞同：1
> 
> 时间：2009-02-06T11:11:07.413
> 
> 标签：delphi, file-access

我的应用程序打开文件进行转换并将数据保存到另一个文件..或者可能是同一个文件..文件大小发生变化，但我不知道它有多大或多小，直到我看到第一个文件中的数据..

目前，我将文件加载到动态数组中，然后在其中完成所有我需要做的事情，然后将其保存回来......这看起来不错，直到我进入测试阶段，在那里我发现在一个 128mb 的系统上转换多 GB 文件ram 引起了一些问题...大声笑这是我的代码..

```
procedure openfile(fname:string);
var
  myfile: file;
  filesizevalue:integer;
begin
  AssignFile(myfile,fname);
  filesizevalue := GetFileSize(fname);
  Reset(myFile, 1);
  SetLength(dataarray, filesizevalue);
  BlockRead(myFile, dataarray[0], filesizevalue);
  CloseFile(myfile);
end; 
```

我需要的是直接文件访问以最大限度地减少内存使用..这就是我认为我需要的/这是我需要的可以在delphi中完成吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T12:22:01.297

我会考虑使用 TFileStream，也许是一个带有缓冲的，但你需要真正展示你对数据所做的事情，因为很难确定最佳策略。正如 gabr 所说，一种选择是内存映射文件，其代码在他的链接中，但由于这是我的代码，我也会在这里添加它！

```
procedure TMyReader.InitialiseMapping(szFilename : string);
var
//  nError : DWORD;
    bGood : boolean;
begin
    bGood := False;
    m_hFile := CreateFile(PChar(szFilename), GENERIC_READ, 0, nil, OPEN_EXISTING, 0, 0);
    if m_hFile <> INVALID_HANDLE_VALUE then
    begin
        m_hMap := CreateFileMapping(m_hFile, nil, PAGE_READONLY, 0, 0, nil);
        if m_hMap <> 0 then
        begin
            m_pMemory := MapViewOfFile(m_hMap, FILE_MAP_READ, 0, 0, 0);
            if m_pMemory <> nil then
            begin
                    htlArray := Pointer(Integer(m_pMemory) + m_dwDataPosition);
                    bGood := True;
            end
            else
            begin
 //                      nError := GetLastError;
            end;
       end;
    end;
    if not bGood then
        raise Exception.Create('Unable to map token file into memory');
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T11:32:04.720

您还可以将部分文件直接映射到内存中。这绝对是最直接的方式。有关示例，请参阅[什么是在 Delphi 中解析行的最快方法。](https://stackoverflow.com/questions/287789/what-is-the-fastest-way-to-parse-a-line-in-delphi/289774#289774)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T12:44:30.720

如果问题允许，您可以使用`BlockRead`and`BlockWrite`读取输入文件的块，对其进行处理，然后将该块写入输出文件。像这样的东西：

```
 AssignFile(inFile,inFname); 
  AssignFile(outFile,outFname); 
  repeat      
    BlockRead(inFile, buff, SizeOf(buff), bytesRead);
    ProcessBuffer(buff);
    BlockWrite(outFile, buff, bytesRead, bytesWritten);
  until (bytesRead = 0) or (bytesWritten <> bytesRead); 
```

代码假定您在处理缓冲区时不会更改缓冲区的大小。如果文件大小发生变化，那么您应该更改示例代码的最后两行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T17:12:44.110

我更喜欢使用 tFileStream 进行这种处理。在此示例中，我假设有一个常量**ArraySize**，它设置为单个数组元素的大小。例如，如果您的“数组”是一个整数数组，那么它将被设置为：

```
ArraySize := SizeOf( Integer ); 
```

这会将 ArraySize 设置为 4。

```
Function LoadPos(inFIlename:string;ArrayPos:Int64;var ArrayBuff) : boolean;
var
  fs : tFileStream;
begin
  result := false;
  fs := tFileStream.Create(inFilename,fmOpenRead);
  try
    // seek to the array position
    fs.Seek( ArrayPos * ArraySize, soFromBeginning);
    // load the element
    result := fs.Read( ArrayBuff, ArraySize ) = ArraySize;
  finally
    fs.free;
  end;
end; 
```

这种方法的唯一问题是它只适用于固定大小的结构，可变长度的字符串需要不同的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T11:14:58.980

我认为您不会获得“更直接”的文件访问权限。您是否使用文件中的所有数据？否则，您也许可以使用流并仅将所需的数据加载到内存中。但是，如果您使用所有数据，恕我直言，只有一种解决方案：分块读取文件。但这在很大程度上取决于您要应用的转换类型。如果转换不是本地的（因此组合的数据元素都在同一个块中），你就会遇到问题。

# java - XY 布局 JAVA

> ID：519918
> 
> 赞同：2
> 
> 时间：2009-02-06T11:12:04.073
> 
> 标签：java, layout

Java 是否有任何类型的 XY 布局？

所以我可以在 X 和 Y 坐标上设置一个按钮，它应该是那么大等等......因为这个边框布局和网格和面板的东西让我发疯了。:)

他们每一个都在流动，并且越来越伸展。为了使它们变小，您必须将面板放在面板中的面板中^^，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T11:38:54.207

当将容器的布局设置为 null（无 LayoutManager）时，您可以使用 component.setBounds(x,y,w,h) 单独设置组件的边界。

**在所有情况下，99% 的**固定布局都是****糟糕的 UI 设计**（例如，如果您的标签没有获得其首选尺寸，那么当您的应用程序支持多种语言时您会遇到主要问题），所以**我对您的建议是编写一个专门的布局管理器满足您的特定需求**。**

 **编写自定义布局管理器非常容易，您所要做的就是能够计算具有给定组件和布局的容器的首选大小，并通过设置（计算的）组件边界来进行布局。很久以前，我摆脱了 GridBagLayout 并开始编写自己的布局，并且布局从未如此简单。

这是一个自定义布局的示例，它布局成对的键和值组件：

```
public class KeyValueLayout implements LayoutManager {

    public static enum KeyAlignment {
        LEFT, RIGHT;
    }

    private KeyAlignment keyAlignment = KeyAlignment.LEFT;

    private int hgap;

    private int vgap;

    public KeyValueLayout () {
        this(KeyAlignment.LEFT);
    }

    public KeyValueLayout (KeyAlignment keyAlignment) {
        this(keyAlignment, 5, 5);
    }

    public KeyValueLayout (int hgap, int vgap) {
        this(KeyAlignment.LEFT, hgap, vgap);
    }

    public KeyValueLayout (KeyAlignment keyAlignment, int hgap, int vgap) {

        this.keyAlignment = keyAlignment != null ? keyAlignment : KeyAlignment.LEFT;
        this.hgap = hgap;
        this.vgap = vgap;
    }

    public void addLayoutComponent (String name, Component comp) {
    }

    public void addLayoutComponent (Component comp, Object constraints) {
    }

    public void removeLayoutComponent (Component comp) {
    }

    public void layoutContainer (Container parent) {
        Rectangle canvas = getLayoutCanvas(parent);
        int ypos = canvas.y;
        int preferredKeyWidth = getPreferredKeyWidth(parent);

        for (Iterator<Component> iter = new ComponentIterator(parent); iter.hasNext();) {
            Component key = (Component) iter.next();
            Component value = iter.hasNext() ? (Component) iter.next() : null;
            int xpos = canvas.x;
            int preferredHeight = Math.max(key.getPreferredSize().height, value != null ? value.getPreferredSize().height : 0);

            if (keyAlignment == KeyAlignment.LEFT)
                key.setBounds(xpos, ypos, key.getPreferredSize().width, key.getPreferredSize().height);
            else
                key.setBounds(xpos + preferredKeyWidth - key.getPreferredSize().width, ypos, key.getPreferredSize().width,
                    key.getPreferredSize().height);

            xpos += preferredKeyWidth + hgap;
            if (value != null)
                value.setBounds(xpos, ypos, canvas.x + canvas.width - xpos, preferredHeight);
            ypos += preferredHeight + vgap;
        }
    }

    public Dimension minimumLayoutSize (Container parent) {
        int preferredKeyWidth = getPreferredKeyWidth(parent);
        int minimumValueWidth = 0;
        int minimumHeight = 0;
        int lines = 0;
        for (Iterator<Component> iter = new ComponentIterator(parent); iter.hasNext();) {
            lines++;
            Component key = (Component) iter.next();
            Component value = iter.hasNext() ? (Component) iter.next() : null;
            minimumHeight += Math.max(key.getPreferredSize().height, value != null ? value.getMinimumSize().height : 0);
            minimumValueWidth = Math.max(minimumValueWidth, value != null ? value.getMinimumSize().width : 0);
        }

        Insets insets = parent.getInsets();
        int minimumWidth = insets.left + preferredKeyWidth + hgap + minimumValueWidth + insets.right;
        minimumHeight += insets.top + insets.bottom;
        if (lines > 0)
            minimumHeight += (lines - 1) * vgap;

        return new Dimension(minimumWidth, minimumHeight);
    }

    public Dimension preferredLayoutSize (Container parent) {
        int preferredKeyWidth = getPreferredKeyWidth(parent);
        int preferredValueWidth = 0;
        int preferredHeight = 0;
        int lines = 0;
        for (Iterator<Component> iter = new ComponentIterator(parent); iter.hasNext();) {
            lines++;
            Component key = (Component) iter.next();
            Component value = iter.hasNext() ? (Component) iter.next() : null;

            preferredHeight += Math.max(key.getPreferredSize().height, value != null ? value.getPreferredSize().height : 0);
            preferredValueWidth = Math.max(preferredValueWidth, value != null ? value.getPreferredSize().width : 0);
        }

        Insets insets = parent.getInsets();
        int preferredWidth = insets.left + preferredKeyWidth + hgap + preferredValueWidth + insets.right;
        preferredHeight += insets.top + insets.bottom;
        if (lines > 0)
            preferredHeight += (lines - 1) * vgap;

        return new Dimension(preferredWidth, preferredHeight);
    }

    public Dimension maximumLayoutSize (Container target) {
        return preferredLayoutSize(target);
    }

    private int getPreferredKeyWidth (Container parent) {
        int preferredWidth = 0;
        for (Iterator<Component> iter = new ComponentIterator(parent); iter.hasNext();) {
            Component key = (Component) iter.next();
            if (iter.hasNext())
                iter.next();

            preferredWidth = Math.max(preferredWidth, key.getPreferredSize().width);
        }

        return preferredWidth;
    }

    private Rectangle getLayoutCanvas (Container parent) {
        Insets insets = parent.getInsets();
        int x = insets.left;
        int y = insets.top;

        int width = parent.getSize().width - insets.left - insets.right;
        int height = parent.getSize().height - insets.top - insets.bottom;

        return new Rectangle(x, y, width, height);
    }

    private class ComponentIterator implements Iterator<Component> {

        private Container container;

        private int index = 0;

        public ComponentIterator (Container container) {
            this.container = container;
        }

        public boolean hasNext () {
            return index < container.getComponentCount();
        }

        public Component next () {
            return container.getComponent(index++);
        }

        public void remove () {
        }
    }
} 
```

Just set the layout and add alternatingly labels and value components. It's easy to use, especially compared to GridBagLayout or nested panels with custom layouts.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T11:26:08.367

组件调整大小的原因是无论窗口大小如何，东西看起来都很好，所以 Swing 不鼓励直接的 XY 位置。您可能想看看为 GUI 构建器设计的GroupLayout [http://java.sun.com/docs/books/tutorial/uiswing/layout/group.html](http://java.sun.com/docs/books/tutorial/uiswing/layout/group.html) ，上面提到的页面描述了使用隐形组件来吸收延伸。例如：`layout.setAutoCreateGaps(true);`

SpringLayout 也可能有用 - 请参阅[视觉指南](http://java.sun.com/docs/books/tutorial/uiswing/layout/visual.html)

如果您真的想要 X 和 Y，则将布局管理器设置为 null，并使用 setLocation() 或 setBounds()。我真的真的不推荐这个，但它确实有效。阅读[本教程](http://mindprod.com/jgloss/layout.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T11:25:43.530

如果你真的想这样做，请使用

```
setLayout(null); 
```

在您要放入的组件上，然后使用

```
setBounds(x, y, width, height); 
```

设置元素的绝对坐标。例子：

```
setLayout(null);
JButton myButton = new JButton("Do Stuff");
add(myButton);
myButton.setBounds(30, 30, 100, 30); 
```

但是，生成的 GUI 看起来不标准，无法调整大小，而且如果它有任何复杂性，维护起来会很痛苦。

我知道布局是令人沮丧的，但最终你会更好地使用 BorderLayouts 和 FlowLayouts 或 GridBagLayout 的组合 - 或像 Eclipse's 或 Netbeans' 这样的 IDE 界面构建器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T11:59:53.260

This doesn't answer your specific question, but as well as agreeing with the other comments, have a look at [MiG Layout](http://miglayout.com/). I have been equally frustrated with layouts as a Swing newbie, but this has helped a lot.

# php - 使用 php 的屏幕抓取技术

> ID：519920
> 
> 赞同：1
> 
> 时间：2009-02-06T11:12:27.847
> 
> 标签：php, screen-scraping

如何筛选特定网站。我需要登录一个网站，然后抓取内部信息。怎么可能做到这一点？

请指导我。

**重复：[如何在 PHP 中实现网络爬虫？](https://stackoverflow.com/questions/26947/how-to-implement-a-web-scraper-in-php)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T12:43:38.507

```
Zend_Http_Client and Zend_Dom_Query 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T11:17:28.213

你想看看[**curl**](http://www.php.net/curl)函数——它们会让你从另一个网站获取页面。您可以使用 cookie 或 HTTP 身份验证先登录，然后获取所需的页面，具体取决于您登录的站点。

一旦你有了这个页面，你最好使用[**正则表达式**](http://www.php.net/preg_match)来抓取你想要的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T11:17:38.773

你应该看看 curl。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T11:23:22.037

您可能还想看看[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)，它是一个 Python 库，应该非常擅长使糟糕的 HTML 可解析。它的目标是像屏幕抓取这样的事情。

我不知道从 PHP 调用会有多容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T12:50:54.780

您还可以查看[http://php.net/dom](http://php.net/dom)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-18T22:06:32.893

卷曲，一旦进入，使用 QueryPath php 库。(querypath.org) 你可以像在 JQuery 中一样访问 dom 元素，通过 CSS 选择器，还有方法链......

比只使用 php 的原生 xml 函数要好得多。

它也可以作为 drupal 扩展，但我想你可以在任何 php 项目中实现它。

# c++ - 将字节数组反序列化为结构

> ID：519925
> 
> 赞同：5
> 
> 时间：2009-02-06T11:15:03.910
> 
> 标签：c++, struct, bytearray, serialization

我通过网络获得了一个字符/字节数组的传输。它包含一个标题和一些数据。我想将标题映射到结构上。这是一个例子：

```
#pragma pack(1)

struct Header
{
    unsigned short bodyLength;
    int msgID;
    unsigned short someOtherValue;
    unsigned short protocolVersion;
};

int main()
{
    boost::array<char, 128> msgBuffer;
    Header header;

    for(int x = 0; x < sizeof(Header); x++)
        msgBuffer[x] = 0x01; // assign some values

    memcpy(&header, msgBuffer.data(), sizeof(Header));

    system("PAUSE");    

    return 0;
} 
```

假设结构从不包含任何可变长度字段，这是否总是有效？是否有独立于平台/惯用的方式来做到这一点？

**笔记：**

我在互联网上看到了很多可以让你序列化/反序列化的库，但我的印象是，它们只能反序列化之前已经用同一个库序列化的东西。好吧，我无法控制传输的格式。我肯定会得到一个字节/字符数组，其中所有值都相互跟随。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T11:30:35.020

一些处理器要求某些类型正确对齐。他们将不接受指定的打包并生成硬件陷阱。

甚至在常见的 x86 打包结构上也会导致代码运行更慢。

此外，在使用不同的字节序平台时，您必须小心。

顺便说一句，如果你想要一个简单且独立于平台的通信机制，并绑定到许多编程语言，那么看看[YAMI](http://www.msobczak.com/prog/yami/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T11:35:25.367

只是简单的复制很可能会破坏，至少如果数据可以来自与您所在的架构不同的架构（甚至只是编译器）。这是因为：

*   [字节序](http://en.wikipedia.org/wiki/Endianness)
*   [规整填料](http://gcc.gnu.org/onlinedocs/gcc/Structure_002dPacking-Pragmas.html)

第二个链接是 GCC 特定的，但这适用于所有编译器。

我建议逐字节读取字段，并从这些字节中组装更大的字段（整数等）。这使您可以控制字节顺序和填充。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T11:35:49.703

该`#pragma pack(1)`指令应该适用于大多数编译器，但您可以通过计算出您的数据结构应该有多大（如果我的数学正确，则为 10）并使用`printf("%d", sizeof(Header));`来检查打包是否完成来检查。

正如其他人所说，如果您在架构之间进行切换，您仍然需要警惕 Endianness。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T12:27:45.433

我强烈不同意逐字节阅读的想法。如果您在结构声明中处理结构包装，则可以毫无问题地复制到结构中。对于字节序问题，再次逐字节读取可以解决问题，但不会为您提供通用解决方案。这种方法很鸡肋。我以前为类似的工作做过类似的事情，它工作得很好，没有出现故障。

想想这个。我有一个结构，我也有那个结构的相应定义。您可以手动构建它，但我已经为此编写了一个解析器并将其用于其他事情。

例如，您上面给出的结构的定义是“sis s”。( s = short , i = int ) 然后我将结构地址、这个结构的这个定义和结构打包选项提供给一个处理字节序的特殊函数，瞧，它就完成了。

SwitchEndianToBig(&header, "sis s", 4); // 4 = 结构打包选项

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T18:07:32.143

如果我错了，请告诉我，但是 AFAIK，这样做可以保证您的数据是正确的 -**假设类型在您的不同平台上具有相同的大小**：

```
#include <array>
#include <algorithm>

//#pragma pack(1) // not needed

struct Header
{
    unsigned short bodyLength;
    int msgID;
    unsigned short someOtherValue;
    unsigned short protocolVersion;
    float testFloat;

    Header() : bodyLength(42), msgID(34), someOtherValue(66), protocolVersion(69), testFloat( 3.14f ) {}
};

int main()
{
    std::tr1::array<char, 128> msgBuffer;
    Header header;

    const char* rawData = reinterpret_cast< const char* >( &header );

    std::copy( rawData, rawData + sizeof(Header), msgBuffer.data()); // assuming msgBuffer is always big enough

    system("PAUSE");    

    return 0;
} 
```

如果目标平台上的类型不同，则必须为每种类型使用别名 (typedef) 以确保每种使用的类型的大小相同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T12:16:30.853

我知道我在与谁交流，所以我真的不必担心字节顺序。但无论如何，我喜欢远离编译器特定的命令。

那么这个怎么样：

```
const int kHeaderSizeInBytes = 6;

struct Header
{
    unsigned short bodyLength;
    unsigned short msgID;
    unsigned short protocolVersion; 

    unsigned short convertUnsignedShort(char inputArray[sizeof(unsigned short)])
        {return (((unsigned char) (inputArray[0])) << 8) + (unsigned char)(inputArray[1]);}

    void operator<<(char inputArray[kHeaderSizeInBytes])
    {
        bodyLength = convertUnsignedShort(inputArray);
        msgID = convertUnsignedShort(inputArray + sizeof(bodyLength));
        protocolVersion = convertUnsignedShort(inputArray + sizeof(bodyLength) + sizeof(msgID));
    }
};

int main()
{
    boost::array<char, 128> msgBuffer;
    Header header;

    for(int x = 0; x < kHeaderSizeInBytes; x++)
        msgBuffer[x] = x;

    header << msgBuffer.data();

    system("PAUSE");    

    return 0;
} 
```

摆脱了编译指示，但它不像我想要的那样通用。每次向标题添加字段时，都必须修改 << 函数。你能以某种方式迭代结构字段，获取字段的类型并调用相应的函数吗？

# regex - 了解正则表达式有多重要？

> ID：519929
> 
> 赞同：8
> 
> 时间：2009-02-06T11:16:41.927
> 
> 标签：regex

我的个人经验是，正则表达式解决了无法以任何其他方式有效解决的问题，并且在字符串与它们一样重要的世界中如此频繁地需要，以至于没有牢牢掌握该主题对我来说就足够了考虑*不*聘用你作为高级程序员（初级程序员总是有培训的余地）。

然而。

关于经常性“这是什么正则表达式？”的一些回应 类型问题表明，大量编码人员发现它们介于难以理解和不透明之间。

这与简单的 indexOf 或 substring 是否是更好的解决方案无关，这是一个技术问题，有时简单的方法是正确的，有时是正则表达式，有时两者都不是（看看你的 html 解析器问题）。

这是关于理解正则表达式的重要性以及反正则表达式的观点（陈词滥调的“......现在他们有两个问题”的事情）是否值得或 FUD。

**应该期望程序员了解正则表达式吗？这是必需的技能吗？**

* * *

*编辑：以防万一不清楚，我不是在问**我**是否需要学习它们（我是信仰的捍卫者），而是反阵营是否是进化的死胡同，或者它是否是不必要的利基InstallShield 之类的技能*。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-06T11:23:01.400

RE 让您可以解决相对复杂的问题，否则这些问题需要您编写带有回溯和所有那些杂乱无章的东西的完整解析器。我将使用 RE 比作使用链锯砍树，而不是尝试用一块芹菜来砍树。

一旦你学会了如何安全地使用电锯，你就再也回不去了。继续进行反RE宣传的人永远不会像我们这些学会爱他们的人那样富有成效。

所以是的，即使您只了解基本构造，您也应该知道如何使用 RE。它们和其他任何工具一样都是一种工具。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-06T11:35:44.510

在某些任务中，正则表达式是最好的工具。
在某些任务中，正则表达式毫无意义地晦涩难懂。
有些任务相当合适，但不同的方法*可能*更具可读性。

一般来说，当涉及到实际*模式*时，我会考虑使用正则表达式。如果您只是在寻找特定的字符串，我通常不会使用正则表达式。作为灰色区域的一个例子，有人曾在新闻组上询问检查一个字符串是否包含许多其他字符串中的任何一个的最佳方法。出现的两种方法是：

*   使用备选方案构建正则表达式并执行单个匹配。
*   用 依次测试每个字符串`string.Contains`。

就我个人而言，我认为后一种方式*要*简单得多——它不需要任何关于转义你正在寻找的字符串的想法，或者任何其他正则表达式的知识（以及它们在不同平台上的不同风格）。

作为一个例子，正则表达式显然是错误的选择，有人认真地提议使用正则表达式来测试一个字符串是否为三个字符长。他们的正则表达式甚至不起作用，尽管他们声称他们首先想到正则表达式的原因是因为他们已经使用了很长时间，而且他们自然而然地在正则表达式中“思考”了。

然而，有很多例子表明正则表达式确实让生活更轻松——正如我所说，当你实际匹配*模式*时：“我想要一个字母，然后是三个数字，然后是另一个字母”或其他什么。我发现自己不经常使用正则表达式，但是当我*使用*它们时，它们可以节省很多工作。

简而言之，我相信了解正则表达式是件好事——但同样要注意何时使用它们。很容易得到只写代码，通过简单的字符串操作重写可以更容易理解，即使结果代码稍长。

**编辑：针对问题的编辑...**

我不认为宣传它们是一个好主意——根据我的经验，这*往往*会导致在替代方案更简单的地方使用它们，这只会让你看起来很糟糕。另一方面，如果您遇到有人编写复杂的代码以*避免*使用正则表达式，那么可以指出正则表达式会使代码更简单。

就我个人而言，我喜欢以非常详细的方式注释我的正则表达式，将它们分成几行，每行之间有一个注释。这样它们更容易维护，而且看起来你并不是在试图成为“硬核”极客（这*可能*是一种印象，即使它不是实际的预期目标）。

我认为最重要的是记住简短的！= 可读的。永远不要声称使用正则表达式更好，因为它需要更少的代码 - 声称当它真正更简单和更容易理解（或者当然有显着的性能优势时）会更好。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-06T11:26:51.437

作为开发人员，您应该了解尽可能多的工具的优缺点，这些工具可以为您的问题提供预先制定的解决方案。每个开发人员都应该知道如何使用正则表达式，并且对何时应该使用它们以及何时使用简单的字符串函数来实现目标有一种感觉。

在我看来，因为它们难以阅读而直接拒绝它们是没有选择的。有这样想法的开发人员剥夺了自己用于搜索和验证复杂字符串模式的宝贵工具。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T11:23:13.847

在 Steve Yegge 的文章，[五个基本的电话屏幕问题](http://steve.yegge.googlepages.com/five-essential-phone-screen-questions)中，您应该阅读“领域三：脚本和正则表达式”部分。

Steve Yegge 有一些有趣的观点。他给出了他在客户必须为特定电话号码模式解析 50,000 个文件时遇到的实际问题。懂正则表达式的申请者几分钟就能解决问题，而不会写怪物百行程序的申请者非常笨拙。这篇文章说服我应该学习正则表达式。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-06T11:38:43.893

我的心情真的很复杂。我已经使用过它们并且知道语法的基本原理，并且我喜欢它们的简洁性。然而，它们并不被普遍理解，并且是一种高度混淆的代码形式。我也希望在纯代码中看到与类似操作的性能比较。毫无疑问，分解后的代码将更易于维护，更容易被广泛理解，这在任何商业软件项目中都是一个认真考虑的问题。

即使它们被证明具有更高的性能，对其逻辑结论的论证也会看到我们都将汇编器嵌入到我们的代码中以用于重要的循环——也许我们应该这样做。整洁简洁，速度非常快，但几乎无法维护。

总的来说，我认为在正则表达式语法成为主流之前，它们可能会造成比解决问题更多的麻烦，并且应该非常小心地使用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-06T11:25:02.020

不是一个绝妙的答案，但在我工作过的所有地方，以下都是正确的

0 < （完全）理解正则表达式的人数 < 1

如果我知道该怎么做，我会将之前的表达式写成正则表达式，但我不能。我能想到的最好的方法是 s/fully/a little/g - 这是我的极限（这可能不是正则表达式）。

一个更严肃的答案是，正确的正则表达式将通过一行（ish）代码解决各种问题。但是如果它出错了，你将在调试它时遇到真正的问题。因此恕我直言，一个复杂的正则表达式，但是“干净/聪明”是一种负担，如果需要十行代码来复制它，为什么会有问题，内存/磁盘空间是否又突然变得昂贵了？

顺便说一句，我很想知道正则表达式是否比等效代码快。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-06T11:28:49.873

目前尚不清楚您期待什么样的答案。

对于这个问题，我可以大致想象出三种答案：

1.  Regexen 对专业程序员的教育至关重要。它们支持使用强大的 unix shell 工具，并且基于正则表达式的搜索替换可以显着减少作为程序员生活一部分的文本处理手工工作。不懂正则表达式的程序员只是智力上的懒惰，这对程序员来说是一个非常糟糕的特征。

2.  取决于应用程序域，正则表达式有点有用。当然，知道如何编写正则表达式对于程序员来说是一个很有价值的工具，但大多数时候你可以在不使用它们的情况下做得很好。此外，正则表达式往往很难阅读，因此必须强烈反对滥用。

3.  有些疯子喜欢把所有东西都放在正则表达式中（我在看着你，在 perl 中实现基于正则表达式的俄罗斯方块的 perl 人）。但实际上，它们只是一些计算机科学琐事，其唯一实际用途是编写解析器。它们被广泛教授，因为它们是评估学生的一个很好的教学主题，并且像大多数这样的主题一样，它可以在你走出考场的那一刻忘记。

你会注意到复数形式“regexen”（pro）、“regexps”（小心中性）和“regexs”（con）的谨慎使用。

就我个人而言，我属于第一类。优秀的程序员喜欢学习新的语言，他们讨厌重复的手工工作。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-06T11:41:05.277

当您必须解析某些内容（从简单的日期字符串到编程语言）时，您应该知道您的工具和正则表达式就是其中之一。

但是你也应该知道你可以用正则表达式做什么，不能做什么。此时，如果您了解[乔姆斯基层次](http://en.wikipedia.org/wiki/Chomsky_hierarchy) 结构，它就会派上用场。否则，您最终会尝试使用正则表达式来解析上下文相关语言，并想知道为什么您的正则表达式不正确。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-06T11:49:53.247

所有语言都支持正则表达式这一事实应该意味着*什么*！

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-06T11:55:23.003

我认为了解正则表达式是一项非常重要的技能。虽然在编程环境/语言中使用正则表达式是可维护代码的问题，但我发现正则表达式的知识对某些命令（例如 egrep）、编辑器（vim、emacs 等）很有用。当您有一个文本文件并且想要不时进行一些格式化时，使用正则表达式在 vim 中进行查找和替换非常方便。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-06T11:56:22.657

我发现了解正则表达式非常有用。它们是一个非常强大的工具，在我看来，没有这些你根本无法解决一些问题。

但是，我不会将正则表达式作为“雇用您作为高级程序员”的杀手标准。它们就像世界上其他工具的财富。您应该在需要它们的问题域中真正了解它们，但您不能假设有人已经知道所有这些。

> “小学生总是有训练的余地”

如果没有前辈，那我不会雇用他！

对于那些争论正则表达式是多么复杂和不可读的人：如果问题的正则表达式解决方案是复杂和不可读的，那么问题本身可能就是！祝你好运以其他方式解决它......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-06T11:38:50.150

以下是做什么的？

"([A-Za-z][A-Za-z0-9+.-]{1,120}:A-Za-z0-9/{1,333}(#([a-zA-Z0-9][a -zA-Z0-9$_.+!*,;/?:@&~=%-]{0,1000}))?)"

你花了多长时间才弄清楚？调试？

正则表达式非常适合一次性使用的程序，但长毛的正则表达式并不是其他人多年来需要维护的程序的最佳选择。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-09T01:17:14.880

我发现正则表达式可能非常有用，具体取决于您执行的编程类型。但是，我可能一个月写不到一个正则表达式，并且由于需要正则表达式之间的间隔很长，我忘记了很多关于它们是如何工作的。

有一天，我可能应该掌握正则表达式或类似的东西。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-09T19:42:18.610

了解何时使用正则表达式以及它们如何工作的基础知识以及它们的局限性是很重要的。但是用很多你可能不会经常需要的语法规则来填充你的头脑只是一个毫无意义的学术练习。

一张正则表达式婴儿床单可以写在一张 A4 纸或几页教科书上 - 无需背诵这些东西，如果你每天使用它，它就会粘住。如果您不经常使用它，那么脑细胞可能会更好地用于其他用途。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-02-06T11:23:32.583

一位开发人员认为他遇到了一个问题，并尝试使用正则表达式来解决它。现在他有2个问题。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-02-09T18:00:38.057

我几乎同意这里所说的一切，只需要包括强制性的俏皮话：

> 有些人在遇到问题时会想“我知道，我会使用正则表达式”。现在他们有两个问题。

（归因于杰米·扎温斯基）

像大多数笑话一样，它包含了一个真理的核心。

# jquery - 什么是原型的 Element.extend 的 jQuery 等价物

> ID：519938
> 
> 赞同：2
> 
> 时间：2009-02-06T11:20:34.897
> 
> 标签：jquery

我知道 jQuery.extend 可用于通过自己的自定义方法添加到对象，例如 DOM 元素，但 Prototype 的 Element.extend 将所有 DOM 元素辅助方法添加到对象。这就是我所追求的功能。

例如

```
this.panel = document.createElement('div'); 
```

我希望 this.panel 成为对那个新 div 的引用，但也附有方便的元素包装方法。

我可以通过用 jQuery() 包装对 createElement 的调用来获得一些接近的东西

```
this.panel = jQuery(document.createElement('div')); 
```

但这会返回一个数组。我只想要元素。

别人做什么？

TIA

帕特龙

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T11:29:46.940

jQuery 政策是永远不要扩展原生 DOM 对象。

将元素包装在 jQuery 中是可行的方法。结果不是一个数组，它是一个 jQuery 对象（类似于数组），但具有可用的扩展 jQuery 方法。

作为提示，如果你想创建元素，你可以使用 jQuery HTML 解析功能，它允许创建复杂的 DOM 树比使用 DOM 创建方法更容易。

也许你想要这样的东西

```
// Creates a DIV node with some attributes and text inside, and append it to the body
this.panel = jQuery('<div class="myClass" id="myPanel">My panel</div>').appendTo('body'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T11:28:43.040

您可以使用以下方法在 jQuery 对象中选择一个元素：

```
$(selector).eq(0): //this will select the first element 
```

所以在你的情况下：

```
this.panel = $(document.createElement('div')).eq(0); 
```

但你也可以这样做：

```
this.panel = $('<div></div>'); 
```

那也会做同样的事情。

此外，如果您想扩展 jquery 功能：

```
jQuery.fn.myOwnFunction = function(){
 this.each( function() {
  alert($(this).attr('name'));
 }
} 
```

然后，如果您执行以下操作：

```
<input name='bla'>
<input name='foo'>

$('input').myOwnFunction(); 
```

会提醒：'bla' 然后是 'foo'

# css - 如何风格在 IE6 CSS 中？

> ID：519945
> 
> 赞同：17
> 
> 时间：2009-02-06T11:21:54.333
> 
> 标签：css, internet-explorer-6, css-selectors

是否有任何优雅的方式将某种样式应用于`<input type="text">`IE6 下的所有元素？我可以用一些 JavaScript 来做到这一点，但我想知道是否有更优雅的方式来做到这一点。

注意 - 我不能手动将某个类应用于所有文本框。而且我想[避免使用 CSS 表达式](https://stackoverflow.com/questions/516469/ie6-performance-with-css-expressions)。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-06T11:30:08.013

AFAIK，IE6 不支持[属性选择器](http://www.w3.org/TR/CSS2/selector.html#attribute-selectors)，所以我认为答案是否定的。您必须使用以下方法之一：

1.  `<input type="text"/>`为所有元素添加一个公共类属性。
2.  按照您的建议，使用 JavaScript。

你想避免这两种情况。太糟糕了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-08-07T00:36:57.990

如果您碰巧使用 jQuery，请尝试将其添加到您的 onDOMready 中：

```
$('input[type="text"]').addClass('typeText'); 
```

然后在你的CSS中你可以这样：

```
input.typeText, input[type="text"] {
     color:#efefef;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T11:26:36.540

您是否还有其他希望与“文本”元素样式不同的输入元素？如果没有，只需使用 CSS 将样式应用于所有输入元素：

```
input {
border: 1px #8194b2 solid;
font : normal 100% "Tahoma", sans-serif;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-12T23:50:44.433

在您的输入元素上放置类属性对您有用吗？

> 输入文本{
> 
> //这里有一些CSS属性和值....
> 
> }

*   可能比 JS 更优雅

# php - file_put_contents 的错误子句

> ID：519964
> 
> 赞同：10
> 
> 时间：2009-02-06T11:26:31.203
> 
> 标签：php, error-handling

我正在使用这一行从 URL 获取和保存图像。

```
file_put_contents("./images/".$pk.".jpg", file_get_contents($PIC_URL)) 
```

我不确定处理错误的最佳方法是什么。目前它失败了，因为没有许可，这将很快得到纠正，但我希望它能够处理 PIC_URL 为空或不是图像的情况。我应该死于这个级别的错误（可能与权限相关的事情更好）还是应该检查更高的 PIC_URL 是否为空，或两者兼而有之？

哪个是最好的方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-06T11:37:02.993

我没有足够的才华声称这是最好的方法，但我会一路测试：

```
$imageDir = "/path/to/images/dir/";
$imagePath = "$imageDir$pk.jpg";
if (!is_dir($imageDir) or !is_writable($imageDir)) {
    // Error if directory doesn't exist or isn't writable.
} elseif (is_file($imagePath) and !is_writable($imagePath)) {
    // Error if the file exists and isn't writable.
}

$image = file_get_contents(urlencode($PIC_URL));
if (empty($image)) {
    // Error if the image is empty/not accessible.
    exit;
}

file_put_contents($imagePath, $image); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T11:37:15.660

我会使用 is_writable()，如果图像不存在，则将文件夹名称传递给它，如果存在，则将文件名传递给它，然后再尝试写入图像。

[http://uk3.php.net/manual/en/function.is-writable.php](http://uk3.php.net/manual/en/function.is-writable.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T11:43:31.200

两者，就我而言。特别是对于那些危险的文件处理功能，双重检查并没有什么坏处。（`$pk`从哪里来？）

一般来说，为了安全起见，在执行之前检查更高级别的用户以获得更好的反馈并检查。仅在低级别检查时，很难向用户提供体面的反馈。另一方面，很难在高级和通用级别上检查所有可能的错误（如那些文件系统权限）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T11:44:34.477

尝试为此制作一个功能。

```
<?php
define('OK', 0);
deinfe('URL_EMPTY', 1);
define('WRITING_PROBLEMS',2);
define('OTHER_PROBLEM', 3);

function save_pic($pic_url) {

  $imageDir = '/path/to/images/dir/';

  if (!strlen($pic_url))
    return URL_EMPTY;

  if (!is_dir($imageDir) || !is_writable($imageDir)) {
    return WRITING_PROBLEMS; 
  }

  $image = file_get_contents(urlencode($pic_url));

  $pk = time(); // or whatever you want as key

  $r = file_put_contents($imagePath.$pk.".jpg", $pic_url);

  if ($r)
    return OK;
  else
    return OTHER_PROBLEM;

}
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-13T04:37:24.707

嗯，你不能也这样做

`file_put_contents($file, $str) or die("Unable to write file!");`

# c++ - 对带有 C++ 接口的 PDF 3D SDK 的任何建议

> ID：519976
> 
> 赞同：5
> 
> 时间：2009-02-06T11:28:52.027
> 
> 标签：c++, pdf, sdk, 3d

我正在寻找一个 Cor C++ 库/SDK，它可以让我直接编写 3d PDF，或者将 DXF 或 DWG 转换为 3D PDF。到目前为止，我已经提出了符合要求的[PDF3d 库](http://www.pdf3d.co.uk/)，但成本相当高，并且每个用户运行时许可证的成本很高。我不介意合理的 SDK 成本，但每个座位的成本对我来说是致命的。

有人知道任何替代方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T11:54:02.227

我知道 acrobat 本身提供了他们的免费 SDK 8.1，它支持[http://www.adobe.com/devnet/acrobat/pdfs/Acrobat_SDK_whats_new.pdf](http://www.adobe.com/devnet/acrobat/pdfs/Acrobat_SDK_whats_new.pdf)中给出的 3d 功能 但我不确定转换插件需要多少工作. 希望这可能对你有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-30T16:43:14.717

SimLab SDK 可以将 DWG/DXF 转换为 PDF 3D。它不是免费的，但价格合理，每座费用很小：[http ://www.simlab-soft.com/SDK.aspx](http://www.simlab-soft.com/SDK.aspx)

另一种选择是来自 TechSoft3D 的 HOOPS Publish。可能很贵：[http ://www.techsoft3d.com/our-products/hoops-publish](http://www.techsoft3d.com/our-products/hoops-publish)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T07:59:31.887

我经常使用 PDF XChange 将 2D CAD 绘图转换为 PDF，并且效果很好。我不知道（我不这么认为）它是否具有 3D 效果。乍一看，我在他们的网站上找不到任何提及。

您的另一个选择是 3D DWF。还要考虑 DWG TrueView 是一个免费的查看器和打印机，可以本地处理 3D DWG。您曾经能够通过 COM 自动化 TrueView，但我不确定是否仍然如此。这是一篇关于 Trueview 自动化的博客文章 - [http://through-the-interface.typepad.com/through_the_interface/2007/10/au-handouts-t-1.html](http://through-the-interface.typepad.com/through_the_interface/2007/10/au-handouts-t-1.html)

# ruby - 如何访问鞋子中的“浏览...”对话框？

> ID：519978
> 
> 赞同：1
> 
> 时间：2009-02-06T11:29:33.587
> 
> 标签：ruby, shoes

好的，所以我想在我的一些程序中使用 Shoes，但我绝对需要一个“浏览...”对话框，以便用户可以在本地浏览目录/文件。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T22:26:28.143

ask_open_file

ask_open_folder

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T11:41:41.923

如果你只针对 win32 平台，你可以使用 Win32API 库，我猜。*****~~~~