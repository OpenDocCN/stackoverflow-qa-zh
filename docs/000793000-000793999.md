# StackOverflow 问答 000793000-000793999

# c# - 创建列表 在编译时使用值

> ID：793000
> 
> 赞同：30
> 
> 时间：2009-04-27T10:33:05.193
> 
> 标签：c#, generics, c#-2.0

可以在编译时创建一个数组，例如；

```
int[] myValues = new int[] { 1, 2, 3 } ; 
```

但我想做这样的事情；

```
List<int> myValues = new List<int>() { 1, 2, 3 }; 
```

编译器说不。有没有办法在不使用 LINQ (C# 3.0) 的情况下做到这一点 (C# 2.0)？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-04-27T10:35:55.470

```
List<int> myValues = new List<int>(new int[] { 1, 2, 3 } ); 
```

然而，这将创建一个中间数组，因此可能有一种更有效的方式来做同样的事情。

编辑：

John Feminella 建议创建一个工厂方法来接受参数列表并返回一个 List，您可以按如下方式实现：

```
List<T> CreateList<T>(params T[] values)
{
    return new List<T>(values);
} 
```

您可以按如下方式使用：

```
List<int> myValues = CreateList(1, 2, 3); 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-04-27T12:25:58.950

帕特里克有你正在寻找的答案。但我想补充一点。如果您想做更长的数字范围并且不想手动输入它们，您应该查看 Enumerable.Range 方法。它可用于在运行时生成一系列序列号。例如，您的示例可以编写如下

```
var list = Enumerable.Range(1,3).ToList(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-27T10:38:15.213

您建议的方式最初是在 C# 3.0 中引入的（与 LINQ 无关，它是一种引入的语言特性）。

C# 2.0 中没有“快捷方式”（列表初始化）可以做到这一点，要么新建列表，然后通过 myValues.Add 手动添加数字，要么您可以执行以下操作：

```
int[] arrMyValues = new int[] {1, 2, 3};
List<int> myValues = new List<int>(arrMyValues); 
```

T 的列表可以在它的构造函数中采用 T 的 IEnumerable，其中它将包含所有 T 在创建的列表中的 IEnumerable 中，因为 int[] 实现了 T 的 IEnumerable，您可以像这样“混合和匹配”这些功能。

除此之外，C# 2.0 中没有办法做你描述的这样的事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-27T10:39:10.873

集合初始化器只是语法糖，因此如果您使用 3.0 编译器进行编译，则可以在针对 2.0 的应用程序中使用它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-18T11:59:18.987

您也可以这样做，使用 System.Linq.Enumerable：

```
int[] categories = { 221, 222, 223, 224, 225, 226, 227, 228, 235, 236, 254, 255, 256 };        
var ticketsToProcess = categories.ToList(); 
```

# xml - 在 XML 中，可以使用多级 !ENTITY 吗？

> ID：793012
> 
> 赞同：1
> 
> 时间：2009-04-27T10:37:59.473
> 
> 标签：xml, include, entity

我们使用 XML 来定义一个模式来控制可以在图表工具中显示的内容。模式文件指定可以在图表上放置哪些类型的对象，如何将它们链接在一起，以及这些对象具有哪些属性（即，在编辑器中出现哪些可设置的属性）。

当需要一种新的图表时，会编写一个新的模式，并根据 .xsd 进行验证。为了使模式文件更加模块化和更易于维护，我们使用`<!ENTITY>`声明来包含单独的文件。一起属于特定图表元素但可能出现在模式中的多个位置的属性列表等被写入单独的 XML 文件，然后包含在相关位置。说：

```
<!-- Nameing etc. just as an example -->
<!ENTITY CommonProerties1 SYSTEM "file:../CommonProperties1.xml">
<!ENTITY CommonProerties2 SYSTEM "file:../CommonProperties2.xml"> 
```

然后在架构中的某处：

```
<Node shape="Square">
    &CommonProperties1;
    <!-- Specific properties go here -->
</Node> 
```

这可以防止大量复制粘贴的东西，使维护变得困难，并让公共属性也可以与多个模式共享。

问题是现在，一些通用属性也有基本元素，例如标志和枚举组等。我想让每个文件（例如“CommonProperties1.xml”）能够包含来自另一个基本集，例如作为“CommonEnums.xml”，但我认为使用 !ENTITY 声明是不可能的。

您不能在 !DOCTYPE 标头之外声明 !ENTITY ，如果您添加标头，那么它会使顶级 XML 文件无效，因为它通过文件获得标头声明 1.2。

有没有人尝试过做类似的事情，你做了什么来解决/解决问题？我错过了更好的选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T03:59:07.180

一般系统实体被设计为用作文本包含/替换机制。我见过深度嵌套的结构，其中包含极其复杂的样板。

因此，让我们更深入地研究您的问题陈述。

在您的示例中，为什么您认为在文档类型声明中不能有 CommonEnums 的 !ENTITY 声明，以便在解析包含实体时识别实体引用 &CommonEnums？您在声明时遇到问题的这些系统实体有什么特别之处？如果您的目标是避免在文档序言的解析过程中声明它们，那么，不，您无法解决这个问题。

> 您不能在 !DOCTYPE 标头之外声明 !ENTITY

这在某种意义上是正确的，但有一个有用的漏洞。您可以在外部 DTD 中声明一般实体，在这种情况下，它们的声明在文档序言中是不可见的。我不知道这对您的情况是否有帮助，但是在 DTD 中声明您的外部通用系统实体将允许您从引用它们的文档实例和片段中“隐藏”它们。

如果我怀疑您的目标是可重用性、模块化和简洁性，那么我认为您可以通过外部 DTD 做您想做的事。但是为了利用这个特性，您可能必须或多或少地承担创建 DTD 的所有工作，以达到满足您的 XML 处理器所需的任何程度，这可能会坚持根据 DTD 验证您的文档结构。

# javascript - jQuery触发文件输入

> ID：793014
> 
> 赞同：179
> 
> 时间：2009-04-27T10:38:18.037
> 
> 标签：javascript, jquery, css

我正在尝试使用 jQuery 触发上传框（浏览按钮）。
我现在尝试的方法是：

```
$('#fileinput').trigger('click'); 
```

但这似乎不起作用。请帮忙。谢谢你。

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2011-09-04T20:59:57.630

这是由于安全限制。

我发现安全限制仅在`<input type="file"/>`设置为`display:none;`或 is时`visbilty:hidden`。

所以我尝试通过设置将其定位在视口之外`position:absolute`，`top:-100px;`并且瞧瞧它的工作原理。

见[http://jsfiddle.net/DSARd/1/](http://jsfiddle.net/DSARd/1/)

称之为黑客。

希望这对你有用。

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2011-10-24T01:08:45.313

这对我有用：

JS：

```
$('#fileinput').trigger('click'); 
```

HTML：

```
<div class="hiddenfile">
  <input name="upload" type="file" id="fileinput"/>
</div> 
```

CSS：

```
.hiddenfile {
 width: 0px;
 height: 0px;
 overflow: hidden;
} 
```

* * *

**>>>另一个可以跨浏览器工作的：<<<**

想法是您在自定义按钮上覆盖一个不可见的巨大“浏览”按钮。因此，当用户单击您的自定义按钮时，他实际上是在单击本机输入字段的“浏览”按钮。

JS 小提琴：http: [//jsfiddle.net/5Rh7b/](http://jsfiddle.net/5Rh7b/)

**HTML：**

```
<div id="mybutton">
  <input type="file" id="myfile" name="upload"/>
  Click Me!
</div> 
```

**CSS：**

```
div#mybutton {

  /* IMPORTANT STUFF */
  overflow: hidden;
  position: relative;   

  /* SOME STYLING */
  width:  50px;
  height: 28px;
  border: 1px solid green;
  font-weight: bold
  background: red;
}

div#mybutton:hover {
  background: green;
}

input#myfile {
  height: 30px;
  cursor: pointer;
  position: absolute;
  top: 0px;
  right: 0px;
  font-size: 100px;
  z-index: 2;

  opacity: 0.0; /* Standard: FF gt 1.5, Opera, Safari */
  filter: alpha(opacity=0); /* IE lt 8 */
  -ms-filter: "alpha(opacity=0)"; /* IE 8 */
  -khtml-opacity: 0.0; /* Safari 1.x */
  -moz-opacity: 0.0; /* FF lt 1.5, Netscape */
} 
```

**JavaScript：**

```
$(document).ready(function() {
    $('#myfile').change(function(evt) {
        alert($(this).val());
    });
}); 
```

* * *

## 回答 #3

> 赞同：86
> 
> 时间：2016-12-14T14:27:58.733

您可以使用 LABEL 元素 ex。

```
<div>
    <label for="browse">Click Me</label>
    <input type="file" id="browse" name="browse" style="display: none">//
</div>
```

**这将触发输入文件**

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2012-04-20T00:41:30.393

我让它在 IE8+、最近的 FF 和 chrome 中工作（=测试）：

```
$('#uploadInput').focus().trigger('click'); 
```

**关键是在点击之前**聚焦（否则 chrome 会忽略它）。

注意：您确实需要显示和显示您的输入（如 in、not`display:none`和 not `visibility:hidden`）。我建议（就像许多其他人之前所做的那样）绝对定位输入并将其从屏幕上扔掉。

```
#uploadInput {
    position: absolute;
    left: -9999px;
} 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-03-21T09:48:32.093

看看我的小提琴。

[http://jsfiddle.net/mohany2712/vaw8k/](http://jsfiddle.net/mohany2712/vaw8k/)

```
.uploadFile {
  visibility: hidden;
}

#uploadIcon {
  cursor: pointer;
}
```

```
<body>
  <div class="uploadBox">
    <label for="uploadFile" id="uploadIcon">
      <img src="http://upload.wikimedia.org/wikipedia/commons/thumb/3/34/Icon_-_upload_photo_2.svg/512px-Icon_-_upload_photo_2.svg.png"  width="20px" height="20px"/>
    </label>
    <input type="file" value="upload" id="uploadFile" class="uploadFile" />
  </div>
</body>
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2017-04-19T20:52:14.633

出于好奇，您可以通过动态创建上传表单和输入文件来做您想做的事情，而无需将其添加到 DOM 树中：

```
$('.your-button').on('click', function() {
    let uploadForm = document.createElement('form');
    let fileInput = uploadForm.appendChild(document.createElement('input'));

    fileInput.type = 'file';
    fileInput.name = 'images';
    fileInput.multiple = true;

    fileInput.click();
}); 
```

无需将uploadForm 添加到DOM。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2012-06-02T07:00:15.227

**adardesign 指出**了文件输入元素在隐藏时被忽略的问题。我还注意到许多人将元素大小更改为 0，或者通过定位和溢出调整将其推出边界。这些都是很棒的想法。
另一种似乎也很好用的替代方法是**将不透明度设置为 0**。然后，您始终可以**设置位置以防止它**像 hide 那样偏移其他元素。将一个元素向任何方向移动近 10K 像素似乎有点不必要。

对于那些想要的人来说，这里有一个小例子：

```
input[type='file']{
    position:absolute;
    opacity:0;
    /* For IE8 "Keep the IE opacity settings in this order for max compatibility" */
    -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
    /* For IE5 - 7 */
    filter: alpha(opacity=0);
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-12-19T12:23:46.413

实际上，我发现了一个非常简单的方法，即：

```
$('#fileinput').show().trigger('click').hide(); 
```

这样，您的文件输入字段可以使 css 属性*显示*为*none*并且仍然赢得交易:)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-01-19T12:52:30.493

正确代码：

```
<style>
    .upload input[type='file']{
        position: absolute;
        float: left;
        opacity: 0; /* For IE8 "Keep the IE opacity settings in this order for max compatibility" */
        -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)"; /* For IE5 - 7 */
        filter: alpha(opacity=0);
        width: 100px; height: 30px; z-index: 51
    }
    .upload input[type='button']{
        width: 100px;
        height: 30px;
        z-index: 50;
    }
    .upload input[type='submit']{
        display: none;
    }
    .upload{
        width: 100px; height: 30px
    }
</style>
<div class="upload">
    <input type='file' ID="flArquivo" onchange="upload();" />
    <input type="button" value="Selecionar" onchange="open();" />
    <input type='submit' ID="btnEnviarImagem"  />
</div>

<script type="text/javascript">
    function open() {
        $('#flArquivo').click();
    }
    function upload() {
        $('#btnEnviarImagem').click();
    }
</script> 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-04-27T10:41:00.510

这是故意和设计的。这是一个安全问题。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2014-10-05T18:09:00.723

现在回答为时已晚，但我认为这种最小设置效果最好。我也在寻找相同的。

```
 <div class="btn-file">
     <input type="file" class="hidden-input">
     Select your new picture
  </div> 
```

//css

```
.btn-file {
  display: inline-block;
  padding: 8px 12px;
  cursor: pointer;
  background: #89f;
  color: #345;
  position: relative;
  overflow: hidden;
}

.btn-file input[type=file] {
  position: absolute;
  top: 0;
  right: 0;
  min-width: 100%;
  min-height: 100%;
  filter: alpha(opacity=0);
  opacity: 0;
  cursor: inherit;
  display: block;
} 
```

[jsbin](http://jsbin.com/heraz/1/)

[引导文件输入按钮演示](http://labs.abeautifulsite.net/demos/bootstrap-file-inputs/)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2016-01-28T17:07:49.660

这是一个非常古老的问题，但不幸的是，这个问题仍然相关并且需要解决方案。

我想出的（非常简单的）解决方案是“隐藏”实际的文件输入字段并用 LABEL 标签包装它（可以基于 Bootstrap 和 HTML5，以进行增强）。

`See here:`[示例代码在这里](https://jsfiddle.net/oysbmw5u)

这样，真正的文件输入字段是不可见的，您所看到的只是自定义的“按钮”，它实际上是一个修改后的 LABEL 元素。当您单击此 LABEL 元素时，将出现选择文件的窗口，您选择的文件将进入实际文件输入字段。

最重要的是，您可以根据需要操纵外观和行为（例如：从文件输入文件中获取所选文件的名称，在选择后，并将其显示在某处。LABEL 元素不会自动执行此操作，当然。我通常只是把它放在 LABEL 里面，作为它的文本内容）。

不过要小心！对其外观和行为的操纵仅限于您可以想象和想到的任何内容。;-) ;-)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2011-06-14T17:00:05.773

我用一个简单的 $(...).click(); 使用 jQuery 1.6.1

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2013-04-12T10:58:58.063

或者干脆

```
$(':input[type="file"]').show().click().hide(); 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2020-08-06T07:05:48.557

您可以单击 JQuery 中的输入文件，同时将其完全隐藏。

我正在使用这个：

```
< input type="file" name="article_input_file" id="article_input_file" accept=".xlsx,.xls" style="display: none" >

$("#article_input_file").click(); 
```

这适用于 HTML 页面中的任何标准脚本标记。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-04-26T17:28:39.003

我在使用假按钮触发它时遇到了自定义客户端验证问题`<input type="file"/>`，@Guillaume Bodi 的解决方案对我有用（也在`opacity: 0;`chrome 上）

```
$("#MyForm").on("click", "#fake-button", function () {
        $("#uploadInput").focus().trigger("click");
    }); 
```

和用于上传输入的 css 样式

```
#uploadInput {
opacity: 0.0; 
filter: alpha(opacity=0); /* IE lt 8 */
-ms-filter: "alpha(opacity=0)"; /* IE 8 */
-khtml-opacity: 0.0; /* Safari 1.x */
-moz-opacity: 0.0;
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-01-17T11:23:52.457

我的问题在 iOS 7 上有点不同。结果是 FastClick 引起了问题。我所要做的就是添加`class="needsclick"`到我的按钮。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-01-10T01:12:18.977

试试这个，这是一个黑客。Position:absolute 适用于 Chrome，trigger('change') 适用于 IE。

```
var hiddenFile = $("<input type=\"file\" name=\"file\" id=\"file1\" style=\"position:absolute;left:-9999px\" />");
$('body').append(hiddenFile);

$('#aPhotoUpload').click(function () {
    hiddenFile.trigger('click');
    if ($.browser.msie)
        hiddenFile.trigger('change');
});

hiddenFile.change(function (e) {
    alert('TODO');
}); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-01-24T14:51:47.423

我想我理解你的问题，因为我有类似的问题。所以标签`<label>`具有属性，您可以使用此属性将您的输入与 type="file" 链接。但是如果你不想使用这个标签激活它，因为你的布局规则，你可以这样做。

```
$(document).ready(function(){
  var reference = $(document).find("#main");
  reference.find(".js-btn-upload").attr({
     formenctype: 'multipart/form-data'
  });

  reference.find(".js-btn-upload").click(function(){
    reference.find("label").trigger("click");
  });

});
```

```
.hide{
  overflow: hidden;
  visibility: hidden;
  /*Style for hide the elements, don't put the element "out" of the screen*/
}

.btn{
  /*button style*/
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
<div id="main">
<form enctype"multipart/formdata" id="form-id" class="hide" method="post" action="your-action">
  <label for="input-id" class="hide"></label>
  <input type="file" id="input-id" class="hide"/>
</form>

<button class="btn js-btn-upload">click me</button>
</div>
```

当然，您会根据自己的目的和布局对其进行调整，但这是我所知道的让它工作的更简单的方法！

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-03-25T18:43:23.310

这可能是最好的答案，请记住跨浏览器问题。

CSS：

```
#file {
  opacity: 0;
  width: 1px;
  height: 1px;
} 
```

JS：

```
$(".file-upload").on('click',function(){
   $("[name='file']").click();
}); 
```

HTML：

```
<a class="file-upload">Upload</a>
<input type="file" name="file"> 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2012-06-30T07:31:50.110

根据 Guillaume Bodi 的回答，我这样做了：

```
$('.fileinputbar-button').on('click', function() {
    $('article.project_files > header, article.upload').show();
    $('article.project_files > header, article.upload header').addClass('active');
    $('.file_content, article.upload .content').show();
    $('.fileinput-button input').focus().click();
    $('.fileinput-button').hide();
}); 
```

这意味着它一开始是隐藏的，然后为触发器显示，然后立即再次隐藏。

# iphone - 当大小不成比例时如何在 UILabel 中适合文本

> ID：793015
> 
> 赞同：3
> 
> 时间：2009-04-27T10:38:23.670
> 
> 标签：iphone, objective-c, cocoa-touch, uilabel

根据标题，当宽度和高度不成比例时，如何将文本放入 UILabel 中？

在我的应用程序中，标签的宽度为 100，高度为 500，字体大小为 400。模拟器中的结果是文本超出框架，无法完全显示在屏幕上。如果我启用`adjustsFontSizeToFitWidth`字体不再是 400，这是一个要求。

我知道如果文本没有按比例缩放，它看起来会很奇怪，但这对我来说不是问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T23:57:52.623

如果您只想让标签与包含标签所需的一样大，则可以将其设置为大于在任何情况下所需的大小并根据需要对齐。

另一种选择是：

```
label.text = newText;
CGRect bounds = label.bounds;
bounds.size = [newText sizeWithFont:label.font];
label.bounds = bounds; 
```

# displaytag - 谁能告诉我显示标签的好教程？

> ID：793018
> 
> 赞同：3
> 
> 时间：2009-04-27T10:39:19.220
> 
> 标签：displaytag

我想使用显示标签但不了解官方文档。谁能告诉我其他好的教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T10:45:51.763

假设您正在谈论**[JSP 显示标记库，他们在](http://displaytag.sourceforge.net/1.2/)**[**Sourceforge 代码站点**](http://displaytag.sourceforge.net/1.2/tut_basic.html)上有一个广泛的使用教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-31T12:40:50.037

以下链接可能对您有所帮助：

*   [http://viralpatel.net/blogs/2009/06/struts-displaytag-tutorial-sort-pagination-data-displaytag-struts.html](http://viralpatel.net/blogs/2009/06/struts-displaytag-tutorial-sort-pagination-data-displaytag-struts.html)

*   [http://www.javaworkspace.com/displayTags.do](http://www.javaworkspace.com/displayTags.do)

*   [http://www.codercorp.com/blog/spring/pagination-sorting-in-jsps-with-the-displaytag-taglib-example-tutorial.html](http://www.codercorp.com/blog/spring/pagination-sorting-in-jsps-with-the-displaytag-taglib-example-tutorial.html)

# android - 安卓服务测试

> ID：793029
> 
> 赞同：5
> 
> 时间：2009-04-27T10:47:24.520
> 
> 标签：android, unit-testing, service, automated-tests

如何测试我返回的`IBinder`对象？`Service``onBind`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-10-15T15:46:27.500

它取决于您在上下文和服务之间使用的远程接口（在远程调用场景中）。例如，您可以这样做：

```
IBinder service = this.bindService(new Intent(TestService.class.getName()));
assertNotNull(service);
assertTrue(service instanceof ITestServiceCall); //see if the service returns the correct interface
ITestServiceCall iTestServiceCall = ITestServiceCall.Stub.asInterface(service);
assertNotNull(iTestServiceCall);
iTestServiceCall.doSomething(); 
```

ITestServiceCall 是您在 AIDL 文件 ( **ITestServiceCall.aidl** ) 中定义的接口。

但在此之前，您必须确保您的服务在**onBind()**上正确返回接口的存根。

我希望这会有所帮助。

# vb.net - 表示可预订时隙的数据结构

> ID：793031
> 
> 赞同：2
> 
> 时间：2009-04-27T10:48:38.793
> 
> 标签：vb.net, data-structures, datagrid, timeslots

人们对时隙数据结构有什么建议？

我有许多活动，我打算将它们显示在数据网格中，以天为列，以时间段为行。这向我建议了一个时隙数据结构，对于我想要使用的每个值（例如时隙 ID 和剩余时隙数），在五天（列）中具有 5 个属性。

所以...

*   房产 Day1ID
*   物业 Day1Slots
*   属性 Day2ID
*   物业 Day2Slots
*   属性 Day3ID
*   物业 Day4Slots
*   ETC

然后每个 TimeSlot 结构将是一个特定的时间......比如 9:00 和之后每个小时的另一个。然后我会有一个时间段结构列表，这些结构将自动绑定到数据网格。

我在这里开拓新领域，如您所见，我不太清楚该做什么/如何做？

欢迎所有建议，

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T10:57:43.950

创建一个这样的结构：

```
struct DayInfo
{
    int ID;
    int[] Slots;
} 
```

然后有一个列表来存储您的所有数据，可以轻松绑定到 2 个嵌套中继器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T11:13:19.013

我不会硬编码时间段和日期。我会把它们放在一个矩阵中。一个矩阵，例如 5 列代表天数，例如 24 行代表时间段。

# bpel - BPEL 附加组件

> ID：793032
> 
> 赞同：1
> 
> 时间：2009-04-27T10:49:38.930
> 
> 标签：bpel

但是，我不确定这是否是正确的问题……我需要有 BPEL 图建模经验的人的帮助。我正在考虑为 BPEL 建模工具编写一个插件。我想写一些附加组件，这对业务分析师非常有用。我正在玩模拟和测试 BPEL 图的想法。有没有更有用的东西......你认为将 UML 转换为 BPEL 的想法（自下而上的方法）......请给我一些反馈

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-03-09T06:39:02.533

有一些开源图形 BPEL 编辑器，例如[Eclipse BPEL 编辑器](http://www.eclipse.org/bpel/)，如果您可以改进和贡献这些工具，而不是从头开始，那就更好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T13:07:46.307

图形建模：好。WS-BPEL 是 XML，在最好的情况下手工编写是很辛苦的。但是，没有标准的图形符号。

模拟：我都赞成模拟，但模拟*什么*？表现？功能性？

# javascript - 阅读javascript源代码

> ID：793033
> 
> 赞同：1
> 
> 时间：2009-04-27T10:50:01.923
> 
> 标签：javascript

在我的 html 文件中，我输入为

```
<script src='http://otherdomain/file.js' ></script> 
```

当我运行我的网页时，其他 javascript 使用`docuemnt.write`命令创建一些 html 内容。

如何使用我的 html 页面上的 javascript 动态读取该动态 html？

是否可以？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T11:15:29.680

您可以覆盖`document.write`以仅*存储*输入而不写入它。完成后，将其恢复为正常行为：

```
<script>
var outputBuffer = "", old = document.write;
document.write = function(buffer) {
    outputBuffer += buffer; // store the contents for later use
};
</script>
<script src="http://otherdomain.com/file.js"></script>
<script>
document.write = old; // restore document.write to normal behavior
document.write(outputBuffer); // if you want to write it out
</script> 
```

一个工作演示：http: [//jsbin.com/isuqi](http://jsbin.com/isuqi)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T10:58:14.073

如果您知道其他 JavaScript 将其内容写入何处，则很容易阅读。例如，如果所有内容都写入以下 div 容器：

```
<div id="updatable"></div> 
```

然后你可以通过调用类似`document.getElementById("updatable").childNodes`或`document.getElementById("updatable").innerHTML`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T10:56:48.133

如果您只需要使用构建页面上的实际元素，那么您可以使用 javascript 来修改 DOM。（W3Schools 有[教程](http://www.w3schools.com/HTMLDOM/default.asp)）

例如，您可以获得对带有 id 的标签的引用，`"myID"`如下所示：

```
myTag = document.getElementById("myID");

myTag.style = <new style>;
  etc. 
```

* * *

如果您想要新页面的原始 HTML 源代码，您可以调用`innerHTML`：

```
myHTML = document.documentElement.innerHTML; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T22:02:50.670

如果您不需要适用于任何浏览器但仅用于分析的解决方案，您可能会从突变事件中获得您想要的东西。

[http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-eventgroupings-mutationevents](http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-eventgroupings-mutationevents)

查看 DOMNodeInserted 事件。当您在顶部文档中注册处理程序时，当有人向您的树添加元素时，您会被调用。对于您可能想要的每个操作，都有一个合适的事件类型。我不确定它在多大程度上受到支持，但可能值得一试

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T22:19:50.380

if you just want to do it for debugging purpose, then use IE web developer tool or firebug to view the generated source code. :)

# wcf - 有没有办法减少 WCF 占用的带宽？

> ID：793037
> 
> 赞同：3
> 
> 时间：2009-04-27T10:50:41.987
> 
> 标签：wcf

我是 WCF 的新手；我正在开发一个客户端服务器应用程序，我的目标是每秒在服务器端执行一些逻辑。

我使用 NetTcpBinding 为我的 WCF 服务制作了小型客户端，因为它是 BW （我理解）方面最优化的方式，因为它使用二进制编码？

[在使用TracePlus](http://www.sstinc.com/ethernet.html)进行简短跟踪后，我发现当我调用不带任何参数并返回 int 值的单个函数时，从客户端发送到服务器的数据大小为 400 字节！

有没有办法减小这个尺寸？如果不是，这意味着我必须使用本机套接字开发我的应用程序？（在我的情况下，BW 是关键问题）

附言

不带参数的调用方法是否可以接受 400 字节的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T10:59:55.490

您始终可以编写自己的 WCF 传输/绑定。在测量 400 字节时，您是否“关闭”了 NetTcpBinding 上所有不需要的功能（例如安全性）？

# .net - .NET 中是否有“NotImplementedAttribute”？

> ID：793040
> 
> 赞同：0
> 
> 时间：2009-04-27T10:52:37.863
> 
> 标签：.net

### 复制

> [.NET 中的自定义编译器警告](https://stackoverflow.com/questions/154109/custom-compiler-warnings)

如果使用该方法，我希望能够用 a 标记我的代码，`NotImplementedAttribute`并让编译器在构建时给出警告或错误。

我知道有`ObsoleteAttribute`，但它传达了一些非常不同的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T10:58:24.400

你不可能做任何类似的事情`ObsoleteAttribute`。但是，您可以在代码中添加`#warning`指令，以便编译器发出警告。但是，它会一直存在，直到您删除该指令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T11:01:02.647

这已经在这里讨论过：

[自定义编译器警告](https://stackoverflow.com/questions/154109/custom-compiler-warnings)

# spring - Spring Framework 中的 JMS 示例

> ID：793042
> 
> 赞同：7
> 
> 时间：2009-04-27T10:53:36.143
> 
> 标签：spring, jms

JMS 在 spring 中使用，如何配置以及使用什么类型的依赖

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T00:14:28.497

Spring JMS 有一些注意事项。

1.  您绝对不能直接在 JMS 连接工厂上使用 Spring JMS。这是因为 Spring - 特别是 JmsTemplate - 打开一个连接，将它用于一条消息，然后关闭它。当连接工厂实际上是一个连接池时，这是使用的正确模式。但如果它真的只是一个连接工厂，你将在负载下屠宰服务器。这通常只在您运行独立应用程序而不是在 J2EE 容器内时才会出现问题，该容器通常具有资源适配器或其他为您进行池化的东西。Spring 确实提供了一个可以重用连接的 SingleConnectionFactory bean，但是当您使用集群服务器并希望对连接和工作进行负载平衡时，这不是最佳解决方案。
2.  Spring API 都是围绕一次处理单个消息而设计的。在某些情况下，您可能能够处理一批消息，最好使用 Spring 为您提供连接工厂等，但滚动您自己的代码来实际执行消息 I/O。这样，例如，您可以设置一个事务会话，处理 100 条消息，然后将确认作为一个批次提交。假设您可以安全地这样做，那应该会减少服务器上的工作量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-26T07:34:27.377

您可以查看[Spring in Action](http://www.amazon.co.uk/Spring-Action-Craig-Walls/dp/1933988134/ref=sr_1_1?ie=UTF8&s=books&qid=1246001575&sr=8-1)。它有一章关于使用 Spring 中的 JMS 进行消息传递，我发现这很有帮助。

# asp.net - 没有数据绑定时使 GridView 页脚可见

> ID：793045
> 
> 赞同：5
> 
> 时间：2009-04-27T10:55:25.220
> 
> 标签：asp.net, .net, gridview, visibility, footer

当gridview中没有用于从页脚插入数据的数据时如何显示页脚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T11:35:52.983

最简单的方法是绑定一个长度为 1 的数组。您可以在其中放入任何您想确定这是虚拟行的内容。在您的 GridViews RowDataBound 方法上检查数据项是否是虚拟行（在尝试检查数据之前，首先确保 RowType 是 DataRow）。如果它是虚拟行，则将行可见性设置为 false。页脚和页眉现在应该显示没有任何数据。

确保在 GridView 上将 ShowFooter 属性设置为 true。

例如。

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostback)
    {
         myGrid.DataSource = new object[] {null};
         myGrid.DataBind();
    }
}    

protected void myGrid_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        if (e.Row.DataItem == null)
        {
             e.Row.Visible = false;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-17T20:10:29.073

这是我制作的一些简单的东西：

```
 /// <summary>
    /// Ensures that the grid view will contain a footer even if no data exists.
    /// </summary>
    /// <typeparam name="T">Where t is equal to the type of data in the gridview.</typeparam>
    /// <param name="gridView">The grid view who's footer must persist.</param>
    public static void EnsureGridViewFooter<T>(GridView gridView) where T: new()
    {
        if (gridView == null)
            throw new ArgumentNullException("gridView");

        if (gridView.DataSource != null && gridView.DataSource is IEnumerable<T> && (gridView.DataSource as IEnumerable<T>).Count() > 0)
            return;

        // If nothing has been assigned to the grid or it generated no rows we are going to add an empty one.
        var emptySource = new List<T>();
        var blankItem = new T();
        emptySource.Add(blankItem);
        gridView.DataSource = emptySource;

        // On databinding make sure the empty row is set to invisible so it hides it from display.
        gridView.RowDataBound += delegate(object sender, GridViewRowEventArgs e)
        {
            if (e.Row.DataItem == (object)blankItem)
                e.Row.Visible = false;
        };
    } 
```

要调用它，您可以使用以下命令：

```
 MyGridView.DataSource = data;
        EnsureGridViewFooter<MyDataType>(MyGridView);
        MyGridView.DataBind(); 
```

希望这可以帮助。干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-12T06:32:00.077

这是在 GridView 中有空数据时显示页脚[的简单方法。](http://www.aspsnippets.com/Articles/Display-GridView-with-Empty-Message-and-Header-and-Footer-when-no-data-in-ASP.Net.aspx)

# testing - 测试整个程序。最佳实践

> ID：793046
> 
> 赞同：3
> 
> 时间：2009-04-27T10:56:02.300
> 
> 标签：testing, functional-testing

我目前正在用 python 开发一个库和一组使用这个库的程序。单元测试要求我从库中导入每个模块，并测试其中的类和例程。没问题。我有一个单独的测试目录，其中包含我的所有测试并导入库模块，我在开发时运行这些模块。

但是，在测试程序时，情况会发生变化。要进行测试，程序必须作为一个整体运行。程序假设找到已安装的库（如果我在我的机器上安装了它的早期版本，这实际上可能是这种情况，虽然是错误的，增加了更多的麻烦）。目前，我的程序由具有 PYTHONPATH 定义的测试套件运行，我在部署之前手动执行（IOW，我不执行安装），但我认为我做得不对。我觉得一般来说，一个程序应该在完全部署后进行功能测试，但这意味着我每次想要执行功能测试时都必须安装它。

您对整个程序的功能测试有何经验和建议？你是在部署之前还是之后做的，如何做？

谢谢

请注意，我没有故意包含 python 标记。虽然我的问题是特定于 python 的，并且我更喜欢与 python 相关的答案，但我认为也可以从其他语言的专家那里获得贡献。

* * *

**编辑**：正如评论中所报告的，事实是我的程序在安装时必须导入只有在部署时才能找到路径的模块（我动态下载并安装依赖项，它们没有安装在我的机器上）。我无法从测试中操作 sys.path，因为这意味着我从另一个程序（运行并产生 system() 调用的测试套件）修改程序（我的可执行文件）的 sys.path。

换句话说，我必须在不部署的情况下测试程序的唯一方法是执行程序，并将 PYTHONPATH 设置为包含 deps 和程序使用的库由 make 脚本安装的目录（正如我所说，下载、编译并将所有内容“安装”在临时目录中）。

在部署时，deps 和可执行文件被打包在一个类似“OSX 包”的结构中，该结构是完全可执行和可重定位的。

**编辑**：

添加了 150 赏金，看看我是否可以获得更多反馈。

**编辑**：

我感谢所有答案并投票赞成所有答案。这个选择对我来说是一个艰难的决定，但 LudoMC 让我想起了我很久以前研究过的 V 模型测试方法。感谢所有人提供的非常好的答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T11:10:40.487

好吧，（自动化）测试总是一个权衡，所以没有单一的正确方法来做到这一点。

但是，是的，理想情况下，您应该在运行测试之前自动完成程序的完整安装/部署。这样你也可以测试你的安装程序。

也许您可以编写一个安装程序包装器来为您自动执行此操作。如果工作量太大，您也可以在手动创建的部署中运行功能测试。

作为一种折衷方案，您可以在测试运行开始时只运行一次安装，然后在不重新安装的情况下运行所有​​功能测试，以使测试运行得更快。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T12:12:48.433

在合理范围内尽可能多地进行测试。如果某些东西测试起来很棒，但需要付出很多努力，那么不要测试它......但是。只有当你发现你在那个地方一次又一次地遇到问题时，然后再花精力。永远不要提前假设问题出在哪里（除非您提前*知道......但是，**知道*并不是*假设*！）。

因此，如果安装程序很少会导致任何问题，请不要尝试对其进行测试。如果您的部署很脆弱，也许可以编写一个测试来检查安装存档是否*完整*，而不是尝试安装：您不是在测试系统的*安装程序*，而是在测试您的*包*。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-02T16:02:40.023

在我们公司，我们使用非常常用的 V-Model 作为开发过程，其中单元测试在实现阶段完成，集成测试在架构/设计阶段完成，系统测试在需求阶段完成。

因此，在您的情况下，据我了解，您希望在功能级别上测试整个应用程序。所以必须按照要求去做。

因此，您需要一个需求文档，无论是全文场景还是（更好）覆盖（理想情况下广泛）应用程序用例（通常是要实现的第一阶段之一）的 UML 用例图。然后，您必须编写涵盖每个用例的测试用例并通过这些测试用例。它可以通过使用众所周知的（并且非常昂贵的）工具进行手动或自动测试来完成。

对于*when*，我们通常在部署之后进行这些系统测试（测试团队使用的是开发团队提供的安装程序），因为我们也会测试安装程序本身，其中集成测试根据情况在部署之前或之后进行。

在您的情况下，如果安装程序没有错误，并且您 100% 确定在部署之前使用您的 PYTHONPATH 变量进行测试不会在部署后带来错误，那么您可以选择在部署之前进行测试。这是纯粹的风险管理，是您的决定，因为您最清楚这对您的应用程序的利弊。（就个人而言，我不明白为什么那里不能存在错误，它们无处不在:-)）

希望有帮助，我不是题外话

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-03T03:38:24.627

[我们](http://csc.media.mit.edu/)在部署方面遇到过类似的问题，并且正在使用[virtualenv](http://pypi.python.org/pypi/virtualenv)来测试部署。尤其是有了这个`--no-site-packages`选项，它就像一个原始安装，并且除了经过良好测试的 3rd 方解决方案之外，没有使用 PYTHONPATH。可以肯定的是，我们在一个新的虚拟机中运行整个东西，virtualenv 等等。

顺便说一句， s 的一个有用技巧`virtualenv`是`./setup.py develop`.

（从一个熟练工到另一个...）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T23:16:26.307

当然，您应该在完全准确的部署后场景中测试您的程序。

您可能会考虑将自测功能直接集成到您的生产代码中，并提供一种按需运行它的机制。仅在您自己的系统测试期间运行自检可能是有意义的，但是您的安装程序可以将其作为最后一步运行，您的用户可以从菜单项运行它，或者您甚至可以进行“开机自检” “在启动时。

有很多技术可以做到这一点。如果您部署 Web 服务，则可以通过管理 URI 调用自检，该管理 URI 会在自身上发出 HTTP 请求以验证它们是否工作。您可能只需要静态自测，但您也可以动态加载和运行测试脚本。对于后者，您可以使用您的语言的解释工具，或者如果没有，您可以将解释器嵌入到您的软件中（例如，用于 C/C++ 的 TCL 和用于 Java 的 Rhino）或编写自己的迷你解释器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-05T23:24:24.010

进行功能测试有局限性，因为您通常无法模拟使用 GUI 的人，并且您不会测试用户可能执行的异常操作，因为他们可能只是单击或键入没有意义的内容。

最好的办法是在应用程序的视图部分中包含尽可能少的业务逻辑，然后您可以更好地测试，因为您可以测试控制器关闭，或者如果您有它，您的 Web/REST 服务关闭。

您需要尽可能完成测试，测试正面和负面案例，以确保您知道应用程序将如何工作，无论用户发送什么。

我发现 NUnit 和 junit 对以这种方式进行测试很有用，但对于功能测试，最终我最终只能手动通过测试脚本，在大多数情况下。我倾向于通过使用 ant 之类的东西来运行应用程序的所有测试，以帮助确保可以测试尽可能多的东西，然后我会回家，因为全套测试可能需要很长时间跑步。

# c# - 是否有任何现成的模块可用于 Web 应用程序的测试反馈？

> ID：793050
> 
> 赞同：6
> 
> 时间：2009-04-27T10:57:11.610
> 
> 标签：c#, asp.net, testing, web-applications

我想通过以下方式在我的 Web 应用程序中实现测试反馈 - 当具有测试权限的用户登录时，Web 应用程序中的每个页面都会打开小的反馈窗口并将其停靠在角落。测试人员可以使用此窗口来描述问题，并最终添加附件。确认后，模块将该数据保存在数据库中并记录相关数据，如浏览器版本、序列化相关对象等......

有没有类似的东西已经实现为免费使用模块？

谢谢。

**编辑**：
谈到 ASP.NET，我将其设想为一个继承 Page 的类，实现默认值。要启用测试，您可以从此类继承。测试完成后，您可以通过再次从 Page 继承来禁用整个事物......

可以使用 web.config 设置数据库配置。该类还可以提供可覆盖的方法，例如*WriteIssue(Context c, UserInput input)*，默认实现使用 web.config 和一些您需要在数据库中提供的硬编码表。然后，如果您需要其他类型的存储，例如在问题服务器上创建问题，您可以覆盖此方法以提供自定义实现。Web.config 还可以包含其他自定义项，例如停靠类型、窗口 css 和类似...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T05:08:46.353

> 谈到 ASP.NET，我将其设想为一个继承 Page 的类，实现默认值。要启用测试，您可以从此类继承。测试完成后，您可以通过再次从 Page 继承来禁用整个事物......

尽管这是一个有趣的想法，但我发现这种方法存在一些问题：

1.  这将意味着**用于测试和生产的代码库不同**。然后，您将永远无法确定生产版本的行为与测试版本完全相同。
2.  您将如何处理**单个页面范围之外的情况**？一个例子：如果测试人员遇到应用程序故障（不可用的数据库连接、配置错误等）会发生什么？

还有其他实现类似目标的方法：一种是自动记录整个测试会话（屏幕截图、用户操作）并将其存储在 HTML 报告中。一些自动Web测试工具[可以做到](http://binil.wordpress.com/2006/12/22/taking-screenshots-with-selenium/)，我不知道手动测试工具（但它可能可用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T14:49:42.547

我开发了小的反馈库来解决上述目标。文档、源代码和编译的程序集可[在此处](http://code.google.com/p/feedbackpage/)获得。

# maven-2 - Maven 类路径顺序问题

> ID：793054
> 
> 赞同：43
> 
> 时间：2009-04-27T10:58:58.363
> 
> 标签：maven-2, classpath

有谁知道在 Maven2 中设置特定类路径顺序的方法，而不是我目前似乎经历的随机顺序？

想要这样做有很多正当理由：

*   供应商提供了一个补丁 jar，其中包含先前发布的 jar 的覆盖类，因此补丁 jar 必须首先出现在类路径排序中。
*   通过遍历 pom 依赖项发现的类路径上找到的两个 jar 在同一个包中包含具有不同签名的相同类。例如：

> jboss jbossall-client 4.2.0.GA
> 
> org.hibernate 休眠 3.1

两者都包含：org.hibernate.util.ReflectHelper.class，但 jbossall-client 版本缺少 getFastClass 方法。

通过谷歌搜索，我发现这可能是 maven 爱好者和面临这个特定问题的人之间的争论点，但类路径排序肯定有正当理由。

任何解决这个特殊难题的人的任何建议都将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-27T12:00:27.497

从 2.0.9 版开始，maven 对类路径使用 pom 顺序，因此您现在可以实际操作它。我们主要抑制对我们也直接包含的外部库的传递依赖。

来自 maven 2.0.9 的发行说明：

> MNG-1412 / MNG-3111 引入了类路径上依赖项的确定性排序。过去，使用自然集排序，这会导致奇怪的结果。现在从您的 pom 中保留了顺序，最后添加了由继承添加的依赖项。在具有冲突或重复依赖项的构建中，这可能会导致输出发生更改。简而言之，如果您对 2.0.9 有奇怪的问题，请查看依赖项，看看您是否在某处有冲突。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-17T17:06:53.580

Maven 2.0.9 添加了正确的顺序，因此您绝对必须拥有该版本或更高版本才能正常工作。

其次，您需要更新的插件。Maven 家伙正在努力修复，它在他们的 jira 中修复，但这是我迫切需要的。所以与此同时，我自己修复了这个问题，你可以从 github中提取[修改后的插件源代码。](http://github.com/PaulKeeble/maven-eclipse-plugin/tree/classpath_sorting_fix)

编辑：参考[http://jira.codehaus.org/browse/MECLIPSE-388](http://jira.codehaus.org/browse/MECLIPSE-388)

有两种安装方法，要么拉我修改过的代码并安装它，要么下载预构建的 jar 并添加它。

## 构建插件

`maven install`从您签出的插件目录运行，然后在项目 pom 的插件部分中添加以下内容：

```
<build>
  </plugins>
    <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-eclipse-plugin</artifactId>
      <version>2.8-cpfix</version>
    </plugin>
  </plugins>
</build> 
```

## 下载罐子

或者，如果您不想自己下载和编译，那么您可以获取[jar 文件](http://github.com/downloads/PaulKeeble/maven-eclipse-plugin/maven-eclipse-plugin-2.8-cpfix.jar)并自己安装。

运行文件后

```
mvn install:install-file -Dfile=<path-to-file> -DgroupId=org.apache.maven.plugins \
    -DartifactId=maven-eclipse-plugin -Dversion=2.8-cpfix -Dpackaging=jar 
```

无论您现在如何安装它，当您运行`mvn eclipse:eclipse`它时，它都会根据您在 pom 文件中定义的顺序获取修改后的代码并排序依赖项，不按字母顺序排列。它还将 JRE 容器放在依赖项的顶部。

希望这段代码的真实版本很快就会出来，但与此同时，这个修复对我的项目有用，我希望它也能帮助其他一些人。

# web-applications - 如何计算“浏览量”？

> ID：793060
> 
> 赞同：1
> 
> 时间：2009-04-27T11:00:57.390
> 
> 标签：web-applications, views, count

什么是计算页面浏览量的合理、高效、公平的方法？

例如，Stack Overflow 如何计算问题视图？我认为 Stack Overflow 会计算每个注册用户的浏览量。然而，[这个问题](https://stackoverflow.com/questions/184618/what-is-the-best-comment-in-source-code-you-have-ever-encountered)有 198,000 次浏览，并且 Stack Overflow 中有 56,000 名注册用户（转到用户页面，1604 个页面，每页 35 个用户）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T11:09:19.273

使用黑盒方法，我认为它与 Flickr 之类的方法类似，它将视图计为每个会话的请求（本质上也是“每个用户”），但忽略视图内容创建者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T11:08:36.997

页面浏览量是指用户查看页面的次数。根据您的统计数据，sfo 似乎使用了这个逻辑。

唯一用户的页面浏览量将基于注册用户。如果注册用户已经看过一个页面，那么再次查看该页面将不会增加计数。

取决于你想使用什么逻辑。

# updates - 使用 oracledataadapter 更新

> ID：793067
> 
> 赞同：1
> 
> 时间：2009-04-27T11:03:32.267
> 
> 标签：updates

我正在使用以下代码行来更新基于 rowid 的记录：这里 dsmain 我正在使用的数据集....

对于 j = 2 到 AuditGrid.Rows - 1

```
 If AuditGrid.ActiveCell.Row = j And AuditGrid.ActiveCell.Col = ColMark Then
            Uvalue = Trim(AuditGrid.Cell(j, ColMark).Text)
            da.UpdateCommand = New OracleCommand("update audit01 set user" & Trim(User) & "='" & Trim(Uvalue) & "' where audit01.rowid='" & Trim(AuditGrid.Cell(j, ColWRowid).Text) & "'")
        End If
    Next

    da.Fill(DsMain, "AUDIT01")
    da.Update(DsMain, "AUDIT01")
    DsMain.AcceptChanges() 
```

问题是数据库没有被更新。该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T06:50:40.633

我已经使用了以下代码行，现在它工作得非常好......

如果 AuditGrid.ActiveCell.Row > 0 那么

```
 Uvalue = Trim(AuditGrid.Cell(AuditGrid.ActiveCell.Row, ColMark).Text)
        strQry = "update audit01 set user" & Trim(User) & "='" & Trim(Uvalue) & "' where rowidtochar( audit01.rowid)='" & AuditGrid.Cell(AuditGrid.ActiveCell.Row, ColWRowid).Text & "'"
        da = New OracleDataAdapter(strQry, con)
        da.Fill(DsMain)
        DsMain.AcceptChanges()
        MsgBox("Record Updated!!")
        AuditGrid.Range(AuditGrid.ActiveCell.Row, ColMark, AuditGrid.ActiveCell.Row, ColMark).DeleteByRow()
    End If 
```

# iis-6 - 1 个域 两个独立的应用程序

> ID：793068
> 
> 赞同：1
> 
> 时间：2009-04-27T11:03:35.497
> 
> 标签：iis-6, dns, isapi-rewrite, subdirectory

*   [http://www.one.com](http://www.one.com)

    和

    *   [http://www.one.com/uk](http://www.one.com/uk)

www.one.com 是主站点，但该站点有一个英国版本，理想情况下需要位于子目录 (/uk) 中。

如何设置 IIS 以允许我在一个域下拥有多个站点？

或者我可以有两个独立的站点并使用 ISAPI_rewrite 指向 www.one.com/uk 从另一个站点读取但保留 URL www.one.com/uk？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T11:12:10.047

你不能只设置一个指向第二个应用程序[的虚拟目录吗？](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/iis/5adfcce1-030d-45b8-997c-bdbfa08ea459.mspx)假设您使用的是 asp.net，您必须确保 web.config 文件中没有重叠（您可能必须删除/添加一些元素），但我认为虚拟目录将是一个简单的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T11:06:57.733

只需设置一个虚拟“/uk”目录。[http://support.microsoft.com/kb/172138](http://support.microsoft.com/kb/172138)

如果您需要使用多个域，您可以通过代理使用 ISAPI_Rewrite 来完成此操作，但如果您必须使用多个域，我建议您通过使用主机标头制作第二个站点：uk.one.com 来轻松地做到这一点。[http://www.visualwin.com/host-header/](http://www.visualwin.com/host-header/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T11:12:46.520

您可以在“www.one.com”的主站点内设置一个名为“uk”的虚拟目录，并将英国版本的应用程序放入其中。您需要确保其中的应用程序使用相对链接（以确保它不会偏离主应用程序），或者它的绝对链接包含 /uk/ 前缀。

或者，您是否考虑过使用两个主机名？例如，www.one.com 用于全球/美国/非英国，而 uk.one.com 用于英国站点？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T11:44:46.537

或者，您可以设置像 uk.one.com 这样的子域，如果他来自英国，则将用户重定向到那里。这更容易。

# java - 如何开始在 Ubuntu Linux 上使用和开发？

> ID：793071
> 
> 赞同：32
> 
> 时间：2009-04-27T11:05:25.680
> 
> 标签：java, php, linux, ubuntu

我是一名新手 Linux 用户，使用 Windows 操作系统已有 10 年，并使用 Microsoft 语言进行开发。
我想在 Linux 世界中拥有良好的经验并在其上进行开发。
首先，我想学习如何使用这个新的操作系统，然后如何开始开发，我对 web 应用程序很感兴趣，特别是使用 Java/PHP，因为我在这两个方面都有一些经验，这将是一个好的开始。

其次，我想学习如何开发它。
是否有任何视频教程可以让我很好地开始推动？
有什么推荐的书籍或参考资料吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-27T11:14:56.217

## 建议

### 环境设置

1.  如果您正在进行 Java 开发，我建议您安装 JDK。[在此处](http://www.cyberciti.biz/faq/howto-ubuntu-linux-install-configure-jdk-jre/)查看有关使用 apt 安装 sun JRE 的说明。

2.  然后，给自己一个像样的 IDE 设置。尝试[Netbeans](http://www.netbeans.org)或[Eclipse](http://www.eclipse.org/downloads/) - 两者都可以配置为与 php 一起使用。

3.  还要确保安装 php 和 Apache，[这里有一些说明](http://www.howtogeek.com/howto/ubuntu/installing-php5-and-apache-on-ubuntu/)。

4.  由于听起来您要使用经典的[LAMP](http://en.wikipedia.org/wiki/LAMP_(software_bundle))设置，因此您不妨安装[PostgreSQL](http://www.postgresql.org/)或[MySQL](http://www.mysql.com/)。

这应该让你跑得足够远，以制作视频等有用的东西。

## 开发资源

### IDE 资源

*   [Netbeans 6.5 视频导览](http://www.netbeans.org/kb/docs/intro-screencasts.html)
*   [Eclipse 和 Java 视频教程](http://eclipsetutorial.sourceforge.net/)

### 爪哇

*   [Java Antipatterns](http://www.odi.ch/prog/design/newbies.php) - 了解在 Java 中不能做什么。
*   [Apache Commons](http://commons.apache.org/) - 获取 Java 中常见任务的库。

### PHP

*   [PEAR](http://pear.php.net/) - 获取 PHP 中常见任务的库。
*   [ADODB](http://adodb.sourceforge.net/) - 为 PHP 获得一个不错的数据库后端，并学习如何从一开始就防止 SQL 注入攻击。
*   开始使用 Web 开发[框架](http://www.phpframeworks.com/)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-27T17:07:17.793

## Ubuntu 袖珍指南

如果您是 Linux 新手，我建议您查看[Ubuntu 袖珍指南](http://www.ubuntupocketguide.com/index_main.html)。它涵盖了任何用户都想知道的基本内容——窗口管理、系统配置等，以及 Linux 和 Ubuntu 的一些历史背景。你可以略读并学习一点。

## Bash 基础

最后，它还解释了[bash](http://en.wikipedia.org/wiki/Bash)的基础知识，它是 Linux 命令行。这部分很有趣——你可以在 bash 中做比在 Windows 命令行中做的更多的事情。例如，您可能熟悉这个 Windows 习惯用法：

```
dir > directorylist.txt 
```

...这意味着，“列出这个文件夹的内容，而不是显示输出，而是把它放在这个文件中。”

在 Linux 中，您可以这样做，也可以进行管道传输，将一个命令的输出定向到另一个命令。例如：

```
ls | grep foo 
```

表示“列出此文件夹的内容，并在输出中搜索正则表达式 foo。” 您可以根据需要添加任意数量的管道并使用各种命令。

您还可以使用大括号扩展来依次运行多个命令。例如，

```
mkdir photos_{france,spain,italy} 
```

将创建名为 photos_france、photos_spain 和 photos_italy 的目录。

如果你打算在 Linux 上进行开发，你应该花时间阅读一些关于 bash 的教程以充分利用它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-27T11:15:03.487

由于 Java 和 PHP 都是跨平台的，因此您最大的任务似乎是熟悉 GNU/Linux 和与 Web 开发相关的工具，尤其是 apache Web 服务器。以下是谷歌给我的一些东西：

> [http://www.micahcarrick.com/09-28-2007/web-development-linux.html](http://www.micahcarrick.com/09-28-2007/web-development-linux.html)
> 
> [http://httpd.apache.org/docs/2.2/](http://httpd.apache.org/docs/2.2/)

玩得开心。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-28T10:03:01.903

另一种选择是[Lazarus，](http://www.lazarus.freepascal.org/)它基于[Free Pascal](http://www.freepascal.org/)，它本身基于[Delphi。](http://www.delphibasics.co.uk/Article.asp?Name=DelphiHistory)

Lazarus 允许您使用面向对象的 Pascal 跨 Linux、Windows 和 MacOSX 进行开发，并在每个目标平台上生成本地编译的可执行文件。

本地编译的可执行文件通常比基于解释器的应用程序（即 Java、C#、PHP）快得多。

Lazarus 使用基于组件和事件的开发方法，允许您通过在表单设计器上拖放组件来设计 GUI，然后通过事件挂钩。

祝你的编程冒险好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T11:09:43.873

[Ubuntu Kung Fu](http://pragprog.com/titles/ktuk/ubuntu-kung-fu)可能是一个好的开始。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T11:11:44.477

Java 开发是您可以在 Linux 上使用 Eclipse 轻松完成的事情。PHP 开发与在 Windows 上或多或少相同。使用一个好的文本编辑器来编写 PHP 脚本。

安装所需工具可能与在 Windows 上的安装方式不同，但 PHP 和 Eclipse 在 Ubuntu 中都可以作为包使用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-27T21:22:22.950

如果我要推荐一件事，那就是你必须学会​​爱上贝壳。有宾至如归的感觉需要时间，但这是非常值得的。

在一个相关的主题上——你可能想考虑使用 emacs 或 vim 作为你的编辑器，但这更多的是个人喜好。有些人只是喜欢IDE更好。

您可能应该专注于 PHP，而不是 Java。它比 Java 更容易上手，并且更符合 Linux 传统（无论这意味着什么）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-27T11:11:47.567

Eclipse 应该在 Ubuntu 中运行良好。

尝试在其中进行一些 Java 开发以开始使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-27T11:56:48.333

如果您想轻松设置灯泡，可以查看 Zend Server Community Edition。[http://www.zend.com/products/server/downloads-all](http://www.zend.com/products/server/downloads-all)

对于带有 PDT（Php 开发工具）的开发 Eclipse（如上所述）非常好[http://www.eclipse.org/pdt/](http://www.eclipse.org/pdt/)。不过我更喜欢Netbeans。您还可以将 gedit 与一些插件一起使用，请参阅[此](http://blog.astrumfutura.com/archives/385-Gnomes-Text-Editor,-Gedit-A-TextMate-like-Editor-for-Linux.html "这")

# php - 这能成为净化用户输入的一种高效可靠的方式吗？

> ID：793074
> 
> 赞同：0
> 
> 时间：2009-04-27T11:06:12.073
> 
> 标签：php, validation

我想知道如何设置一个聪明的方法来让我的所有输入“干净”，这是一个在我的每个脚本开始时运行的程序。我想创建一个类来做到这一点，然后在每个输入的开头添加一个 2 字母前缀来标识输入的类型，例如：

```
in-mynumber
tx-name
ph-phone
em-email 
```

所以，在我的脚本顶部，我只运行一个函数（例如）：

```
function cleanInputs(){
    foreach($_GET AS $taintedKey => $taintedValue){
        $prefix = substr($taintedKey, 0, 2);
        switch($prefix){
            case 'in':
                //I assume this input is an integer
                $cGet[$taintedKey] = intval($taintedValue);
                break;
            case 'tx':
                //i assume this input is a normal text
                //can contains onely letters, numbers and few symbols
                if(preg_match($regExp, $taintedValue)){
                    $cGet[$taintedKey] = $taintedValue;
                }else{
                    $cGet[$taintedKey] = false;
                }
                break;
            case 'em':
                //i assume this input is a valid email
                if(preg_match('/^[a-zA-Z0-9-_.]+@[a-zA-Z0-9-_.]+.[a-zA-Z]{2,4}$/', $taintedValue)){
                    $cGet[$taintedKey] = $taintedValue;
                }else{
                    $cGet[$taintedKey] = false;
                }
                break;
        }
    }
} 
```

..所以我将分别使用 $_GET 和 $_POST 的干净数据创建其他 2 个数组 $cGet 和 $cPost，并在我的脚本中寻找使用这些数组，完全忘记 $_GET/$_POST I'我什至考虑添加第二个前缀来确定输入的最大长度......例如：tx-25-name ..但我不太确定......如果我采用这种方式，也许 OOP 方法会更好.

你怎么看？似乎是一个很好的使用方式？

我实际上可以看到的负面点（我还没有使用那种方式，只是今天早上的一个奇迹） 1\. 如果我希望我的应用程序没有太多限制，前缀和程序必须很多；2.我发送的变量名会变长一点（但我们说的是3-6个字符，应该不是问题）

任何建议都非常感谢！

**编辑：**

我不是想重新发明轮子，我的帖子不是关于清理输入的系统，而是关于这样做的程序。我使用 htmlpurifier 来清理 html 数据中可能的 xss 注入，当然我使用参数化查询。我只是想知道是否更好地按输入进行输入，或者在开始时将它们全部清理干净并考虑它们在脚本的其余部分中清洁。我认为的方法并不神奇，在阳光下也没有什么新鲜事，但我认为如果不是我所考虑的格式，截断输入可能是有用的......

为什么要在“名称”字段中检查 sql 注入，它必须只包含字母和撇号字符？只需删除不是字母或撇号的所有内容，为最后一个添加斜杠，然后运行参数化查询。然后，如果您查看电子邮件，只需删除所有不是电子邮件的内容..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T11:17:52.857

有许多[制作精良的 PHP 测试类](http://www.google.fr/search?q=php+sanitize&btnG=Rechercher&meta=)已经对输入进行了清理。为什么要再做一个？此外，净化输入不仅仅是验证数据类型。这意味着检查 sql 注入、xss 攻击等...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T11:14:15.750

你想做什么？如果您需要清理输入以将数据保存到数据库，没有什么比参数化查询更好的了。

请参阅[此](https://stackoverflow.com/questions/767026/how-can-i-properly-use-a-pdo-object-for-a-select-query)示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T11:35:57.977

这个想法本身很好，但我想知道它是否真的很有用。

一方面，可以（应该）以另一种方式保护 SQL 注入和 HTML 注入。参数化查询可以防止 SQL 注入（这是当今时代的必备品）；和 HTML 注入是通过`htmlspecialchars()`方法防止的，该方法应该**在将字符串输出给用户之前**立即调用。不要将编码的字符串存储在数据库中，或者（更糟糕的是） - 在收到它们后立即对其进行编码。以后和他们一起工作将是地狱。

除了这两种注入攻击，你的方法会做什么？好吧，它可以为数字、电话号码、电子邮件、姓名和日期等内容做一些正则表达式。但仅此而已。不幸的是，这只是您必须进行的所有验证的一部分。您无法验证的其他常见情况是交叉检查输入（开始日期在结束日期之前），并检查值是否在允许的预定义值列表中（例如，对于`<select>`元素）。您的应用程序中也有无数个自定义验证步骤。是否值得将所有验证拆分为“通用类型验证”和“自定义规则验证”？我不知道。也许。或者也许这只会造成更大的混乱。

# web-applications - Web 应用程序的单点登录

> ID：793078
> 
> 赞同：1
> 
> 时间：2009-04-27T11:08:11.583
> 
> 标签：web-applications, single-sign-on

我正在寻找解决方案，让我们注册网站的用户无需显式登录我们的应用程序即可访问我们的应用程序。

1.  网站所有者将向我们注册以访问我们的应用程序
2.  用户将登录他们的网站并查看我们网站的链接以访问它。
3.  一旦用户点击链接，用户将能够访问它。
4.  如果用户尝试通过浏览器访问此链接并登录到他们的网站，则会显示错误消息。

有没有办法通过cookies、webservices或HTTP post方法等来解决这个问题

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T11:14:10.057

查看 OpenID - [http://openid.net/](http://openid.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T12:21:21.800

嗯，听起来你想要像 OAuth， http: [//oauth.net](http://oauth.net)用于授权和 OpenID， http: [//openid.net/](http://openid.net/)，支持让人们轻松登录。

Google 有一个混合协议，OpenID + OAuth，它允许同时请求用户详细信息和访问令牌，[http://code.google.com/apis/accounts/docs/OpenID.html](http://code.google.com/apis/accounts/docs/OpenID.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T12:40:31.677

Microsoft Windows 2003 R2 引入了一个符合您描述的开箱即用的称为 Active Directory 联合身份验证服务 (ADFS) 的产品。ADFS 在多个网站之间提供单点登录。这包括附属于您自己但您不一定信任打开身份验证 API 的网站。ADFS 与 AzMan 集成以实现基于角色的授权，并且可以针对 Active Directory、ADLS 等进行身份验证...

如果您正在寻找的只是基本的单点登录，那么这个解决方案就太过分了。基本上，他们所做的只是检查经过身份验证的会话，如果没有找到，则执行 307 重定向到身份验证表单所在的联合服务器（身份验证网站）。一旦用户登录，就会在联合服务器上设置 cookie，并将用户重定向回原始站点，并将 sessionid 作为 URL 变量附加。由该站点保留 sessionid 的副本作为其自己域的 cookie。

我最近才开始评估一些 SSO 工具，发现如果我真正想要的只是单点登录，那么推出类似于上述解决方案的我自己的解决方案要容易得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T11:59:37.047

您可以调查的另一个选项是[Windows Live ID](http://dev.live.com/liveid/)。当然，主要缺点是它要求用户拥有 Windows Live 帐户，但这可能是也可能不是问题

# apache-flex - 动作脚本3中flex的以下方法有什么不同？

> ID：793093
> 
> 赞同：2
> 
> 时间：2009-04-27T11:14:10.370
> 
> 标签：apache-flex, actionscript-3, flash, air

NativeApplication.nativeApplication.exit(); - 此方法用于退出 flex/air 的应用。应用程序.close(); - 这个方法也用于退出 flex/air 的应用 - 那么有什么不同呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T17:58:39.077

他指的是 NativeApplication.exit() 与 WindowedApplication.close()。

> **WindowedApplication.close()**
> 关闭应用程序的 NativeWindow（应用程序打开的初始本机窗口）。这个动作是可以取消的。

在应用程序窗口上调用 close() 将有效地关闭应用程序，但在 NativeApplication 上使用 exit() 方法是终止它的正确方法。有关更多信息，请参阅以下链接：

[http://livedocs.adobe.com/flex/3/html/help.html?content=app_launch_1.html](http://livedocs.adobe.com/flex/3/html/help.html?content=app_launch_1.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T22:23:49.120

一个完全退出应用程序，另一个只关闭主窗口。了解差异很重要。例如，在 Mac 上，关闭应用程序的所有窗口通常会使该应用程序在 Dock 中运行。这在 Windows 上很少见，但我认为如果你有一个停靠图标，你应该会得到类似的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T13:08:18.980

我不确定我是否完全理解您的问题，因为我没有找到 application.close() 方法。

这是关于 NativeApplication 的文档，这是一个仅限 AIR 的类： http: [//livedocs.adobe.com/flex/3/langref/flash/desktop/NativeApplication.html#exit()](http://livedocs.adobe.com/flex/3/langref/flash/desktop/NativeApplication.html#exit())

它定义了这样的退出方法：

> 终止此应用程序。
> 
> 对 exit() 方法的调用将返回；在当前执行的代码（例如当前事件处理程序）完成之前，关闭序列不会开始。挂起的异步操作被取消，可能会也可能不会完成。
> 
> 请注意，未调度退出事件。如果应用程序逻辑需要退出事件，则调用 NativeApplication.nativeApplication.dispatchEvent()，传入一个退出类型的事件对象。同样，关闭和关闭事件不会在应用程序窗口关闭之前调度。如果应在应用程序退出之前通知窗口，则可以为每个打开的窗口调度关闭事件。如果需要窗口关闭事件，请在退出前调用窗口的 close() 方法。

这是关于应用程序的文档，一个 Flex 类：[http ://livedocs.adobe.com/flex/3/langref/mx/core/Application.html#methodSummary](http://livedocs.adobe.com/flex/3/langref/mx/core/Application.html#methodSummary)

它似乎没有与之关联的 close() 方法。您是否可能将应用程序类与调用 NativeApplication.nativeApplication.exit() 之前需要关闭的窗口类混淆？

如果您能澄清问题，我很乐意帮助您进一步研究。

# python - Django 序列化程序给出“str”对象没有属性“_meta”错误

> ID：793095
> 
> 赞同：3
> 
> 时间：2009-04-27T11:14:27.903
> 
> 标签：python, django, json

我正在尝试制作 Django 视图，该视图将为 JSON 响应最早和最新的对象。但不幸的是，它无法解决此错误。

```
'str' object has no attribute '_meta' 
```

我有其他序列化并且它有效。

这是代码。

```
def get_calendar_limits(request):
    result =  serializers.serialize("json", Session.objects.aggregate(Max('date'), Min('date')), ensure_ascii=False)
    return HttpResponse(result, mimetype="application/javascript") 
```

预先非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T06:19:37.557

尝试序列化不是从 Django 模型派生的对象时出现相同的错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-01T08:34:58.813

Python有“json”模块。它可以“转储”和“加载”功能。他们可以相应地序列化和反序列化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T12:58:34.550

看看以下内容：

```
objects= Session.objects.aggregate(Max('date'), Min('date'))
print [ type[o] for o in objects ]
result =  serializers.serialize("json", objects, ensure_ascii=False) 
```

您可能只想在交互式 Python 中运行上述内容作为实验。

你的对象是什么类型的？该类型是否可序列化？

# c# - 在 WPF 应用程序中全局捕获异常？

> ID：793100
> 
> 赞同：269
> 
> 时间：2009-04-27T11:16:34.013
> 
> 标签：c#, wpf, exception, exception-handling

我们有一个 WPF 应用程序，其中的一部分可能在运行时抛出异常。我想全局捕获任何未处理的异常并记录它们，否则继续执行程序，就好像什么都没发生（有点像 VB 的`On Error Resume Next`）。

这在 C# 中可能吗？如果是这样，我究竟需要把异常处理代码放在哪里？

目前我看不到任何可以包裹`try`/`catch`并且可以捕获所有可能发生的异常的点。即便如此，我也会留下任何因捕获而被执行的东西。还是我在这里的想法非常错误？

**ETA：**因为下面很多人指出：该应用程序不是用于控制核电站。如果它崩溃了，这没什么大不了的，但主要与 UI 相关的随机异常在使用它的上下文中是一种麻烦。有（并且可能仍然有）其中一些，因为它使用插件架构并且可以由其他人扩展（在这种情况下也是学生；所以*没有*经验丰富的开发人员能够编写完全无错误的代码）。

至于被捕获的异常：我将它们记录到一个日志文件中，包括完整的堆栈跟踪。这就是那个练习的重点。只是为了反驳那些将我比喻为 VB 的 OERN 的人。

我知道盲目地忽略某些类别的错误是危险的，并且可能会损坏我的应用程序实例。如前所述，该程序对任何人都不是关键任务。没有一个心智正常的人会把人类文明的生存押在它上面。它只是一个用于测试某些设计方法的小工具。软件工程。

对于应用程序的立即使用，异常不会发生很多事情：

*   无异常处理——错误对话框和应用程序退出。实验必须重复，虽然可能与另一个主题。没有记录错误，这是不幸的。
*   通用异常处理——良性错误被捕获，无害。这应该是我们在开发过程中看到的所有错误判断的常见情况。忽略此类错误不会立即产生后果；核心数据结构已经过足够好的测试，因此它们很容易经受住这一考验。
*   通用异常处理——严重错误被捕获，可能在以后崩溃。这可能很少发生。到目前为止，我们从未见过它。无论如何都会记录错误，并且崩溃可能是不可避免的。所以这在概念上与第一种情况相似。除了我们有一个堆栈跟踪。在大多数情况下，用户甚至不会注意到。

至于程序产生的实验数据： 一个严重的错误最多只会导致没有数据记录。微小的变化几乎不可能改变实验的结果。即使在这种情况下，如果结果看起来可疑，也会记录错误；如果它是一个完全异常值，人们仍然可以丢弃该数据点。

总结一下：是的，我认为自己至少部分理智，我不认为全局异常处理例程会使程序运行必然是完全邪恶的。如前所述，这样的决定可能是有效的，具体取决于应用程序。在这种情况下，它被认为是一个有效的决定，而不是完全的胡说八道。**对于任何其他应用程序，该决定可能看起来不同。**但是请不要仅仅因为我们忽略了错误就指责我或参与该项目的其他人可能会炸毁世界。

旁注：该应用程序只有一个用户。它不像 Windows 或 Office 那样被数以百万计的用户使用，在这些情况下，让用户产生异常的成本一开始就已经非常不同了。

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2009-04-27T11:28:33.347

使用[`Application.DispatcherUnhandledException Event`](http://msdn.microsoft.com/en-us/library/system.windows.application.dispatcherunhandledexception.aspx). 请参阅[此问题](https://stackoverflow.com/questions/1472498/wpf-global-exception-handler)以获取摘要（请参阅[Drew Noakes 的回答](https://stackoverflow.com/a/1472562/873263)）。

请注意，仍有一些例外情况会阻止您的应用程序成功恢复，例如在您尝试保存到数据库时堆栈溢出、内存耗尽或网络连接丢失。

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2017-10-18T07:19:19.537

**使用NLog**的示例代码将捕获从**AppDomain 中的所有线程、** UI**调度程序线程**和**异步函数**抛出的异常：

### 应用程序.xaml.cs：

```
public partial class App : Application
{
    private static Logger _logger = LogManager.GetCurrentClassLogger();

    protected override void OnStartup(StartupEventArgs e)
    {
        base.OnStartup(e);

        SetupExceptionHandling();
    }

    private void SetupExceptionHandling()
    {
        AppDomain.CurrentDomain.UnhandledException += (s, e) =>
            LogUnhandledException((Exception)e.ExceptionObject, "AppDomain.CurrentDomain.UnhandledException");

        DispatcherUnhandledException += (s, e) =>
        {
            LogUnhandledException(e.Exception, "Application.Current.DispatcherUnhandledException");
            e.Handled = true;
        };

        TaskScheduler.UnobservedTaskException += (s, e) =>
        {
            LogUnhandledException(e.Exception, "TaskScheduler.UnobservedTaskException");
            e.SetObserved();
        };
    }

    private void LogUnhandledException(Exception exception, string source)
    {
        string message = $"Unhandled exception ({source})";
        try
        {
            System.Reflection.AssemblyName assemblyName = System.Reflection.Assembly.GetExecutingAssembly().GetName();
            message = string.Format("Unhandled exception in {0} v{1}", assemblyName.Name, assemblyName.Version);
        }
        catch (Exception ex)
        {
            _logger.Error(ex, "Exception in LogUnhandledException");
        }
        finally
        {
            _logger.Error(exception, message);
        }
    } 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2015-07-21T22:54:38.013

[AppDomain.UnhandledException](https://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)事件

> 此事件提供未捕获异常的通知。它允许应用程序在系统默认处理程序向用户报告异常并终止应用程序之前记录有关异常的信息。

```
 public App()
   {
      AppDomain currentDomain = AppDomain.CurrentDomain;
      currentDomain.UnhandledException += new UnhandledExceptionEventHandler(MyHandler);    
   }

   static void MyHandler(object sender, UnhandledExceptionEventArgs args) 
   {
      Exception e = (Exception) args.ExceptionObject;
      Console.WriteLine("MyHandler caught : " + e.Message);
      Console.WriteLine("Runtime terminating: {0}", args.IsTerminating);
   } 
```

> 如果在默认应用程序域中处理 UnhandledException 事件，则无论线程在哪个应用程序域中启动，都会在任何线程中针对任何未处理的异常引发该事件。如果线程在具有 UnhandledException 事件处理程序的应用程序域中启动，该事件在该应用程序域中引发。如果该应用程序域不是默认应用程序域，并且默认应用程序域中还有一个事件处理程序，则在两个应用程序域中都会引发该事件。
> 
> 例如，假设一个线程在应用程序域“AD1”中启动，调用应用程序域“AD2”中的一个方法，然后从那里调用应用程序域“AD3”中的一个方法，并引发异常。可以引发 UnhandledException 事件的第一个应用程序域是“AD1”。如果该应用程序域不是默认应用程序域，则也可以在默认应用程序域中引发事件。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2011-03-14T11:24:04.733

除了其他人在这里提到的，请注意将 `Application.DispatcherUnhandledException`（及其[类似物](https://stackoverflow.com/questions/1472498/wpf-global-exception-handler)）与

```
<configuration>
  <runtime>  
    <legacyUnhandledExceptionPolicy enabled="1" />
  </runtime>
</configuration> 
```

这`app.config`将防止您的辅助线程异常关闭应用程序。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-11-03T12:09:45.300

这是使用的完整示例`NLog`

```
using NLog;
using System;
using System.Windows;

namespace MyApp
{
    /// <summary>
    /// Interaction logic for App.xaml
    /// </summary>
    public partial class App : Application
    {
        private static Logger logger = LogManager.GetCurrentClassLogger();

        public App()
        {
            var currentDomain = AppDomain.CurrentDomain;
            currentDomain.UnhandledException += CurrentDomain_UnhandledException;
        }

        private void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
        {
            var ex = (Exception)e.ExceptionObject;
            logger.Error("UnhandledException caught : " + ex.Message);
            logger.Error("UnhandledException StackTrace : " + ex.StackTrace);
            logger.Fatal("Runtime terminating: {0}", e.IsTerminating);
        }        
    }

} 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-04-27T11:25:25.100

就像“VB 的错误恢复下一步？” 这听起来有点吓人。第一个建议是不要这样做。第二个建议是不要这样做，不要考虑它。您需要更好地隔离故障。至于如何解决这个问题，这取决于您的代码结构。如果您使用的是 MVC 之类的模式，那么这应该不会太难，并且绝对不需要全局异常吞咽器。其次，寻找一个好的日志库，如 log4net 或使用跟踪。我们需要了解更多细节，例如您正在谈论的异常类型以及应用程序的哪些部分可能导致抛出异常。

# c# - 为什么我在这个数据绑定上得到“类型引用找不到公共类型”？

> ID：793102
> 
> 赞同：3
> 
> 时间：2009-04-27T11:18:53.913
> 
> 标签：c#, wpf, data-binding

为什么**ObjectDataProvider**在此示例中无法识别“local:Customer”？

当我输入

`<local:`

我得到了“客户”的智能感知，所以它应该可以工作。在这个例子中我没有代码隐藏。

**XAML：**

```
<Window x:Class="TestDataTemplate124.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:TestDataTemplate124"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <ObjectDataProvider x:Key="Customers"
                            ObjectType="x:Type local:Customer"
                            MethodName="GetAllCustomers"/>
    </Window.Resources>
    <StackPanel>
        <ListBox DataContext="{StaticResource Customers}" ItemsSource="{Binding}">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding FirstName}"/>
                        <TextBlock Text=" "/>
                        <TextBlock Text="{Binding LastName}"/>
                        <TextBlock Text=" ("/>
                        <TextBlock Text="{Binding Age}"/>
                        <TextBlock Text=")"/>
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </StackPanel>
</Window> 
```

**客户.cs：**

```
using System.Collections.ObjectModel;

namespace TestDataTemplate124
{
    public class Customer
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public int Age { get; set; }

        public static ObservableCollection<Customer> GetAllCustomers()
        {
            ObservableCollection<Customer> customers = new ObservableCollection<Customer>();
            customers.Add(new Customer() { FirstName = "Jim", LastName = "Smith", Age = 23 });
            customers.Add(new Customer() { FirstName = "John", LastName = "Jones", Age = 22 });
            customers.Add(new Customer() { FirstName = "Jay", LastName = "Anders", Age = 21 });
            return customers;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T11:20:49.433

"x:Type" 是一个标记扩展，所以用花括号括起来：

```
ObjectType="{x:Type local:Customer}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T11:22:49.007

尝试添加命名空间作为类的前缀。

# asp.net - 通过 jQuery 调用服务

> ID：793105
> 
> 赞同：0
> 
> 时间：2009-04-27T11:22:19.943
> 
> 标签：asp.net, jquery, ajax

我正在尝试使用 jquery 编写用户名验证，我正在使用 jmsajax 插件。我已经测试了 web 服务，它工作正常。我收到错误。
网络服务代码

```
[System.Web.Script.Services.ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    [WebMethod]
    public bool check_username(string uname)
    {
        DBMOdelDataContext db = new DBMOdelDataContext();
        var q = from p in db.users
                where p.username == uname
                select p;             
        if (q.Count() == 0)
            return false;
        else
            return true; 
    } 
```

jQuery 代码。

```
$(document).ready(function() {
        $(".unamebtn").blur(function() {                
            $uname = $(this).val();

            $.jmsajax({
                type: "POST",
                url: "Services/MyServices.asmx",                    
                data:"{userName='" + $uname + "'}",
                method: "check_username",
                dataType: "msjson",
                success: function(result) {
                    $("#msg").html(result);
                    alert(result);
                    $("#msg").addClass("notice");
                }
            });                
        });
    }); 
```

它抛出的异常。
{"Message":"无法将 \u0027System.String\u0027 类型的对象转换为 \u0027System.Collections .Generic.IDictionary`2[System.String,System.Object]\u0027","StackTrace":" 在 System. Web.Script.Serialization .ObjectConverter.ConvertObjectToTypeInternal(Object o, Type type, JavaScriptSerializer 序列化器, Boolean throwOnError, Object& convertObject)\r\n 在 System.Web.Script.Serialization.ObjectConverter.ConvertObjectToTypeMain (Object o, Type type, JavaScriptSerializer 序列化器, Boolean throwOnError, Object& convertObject )\r\n 在 System.Web.Script.Serialization.ObjectConverter.ConvertObjectToType(Object o, Type type, JavaScriptSerializer 序列化程序)\r\n 在 System.Web.Script.Serialization.JavaScriptSerializer.Deserialize( JavaScriptSerializer 序列化器，String 输入，Type 类型，Int32 depthLimit)\r\n 在 System.Web.Script.Serialization.JavaScriptSerializer .Deserialize[T]（字符串输入）\r\n 在 System.Web.Script.Services.RestHandler.GetRawParamsFromPostRequest（HttpContext 上下文，JavaScriptSerializer 序列化程序）\ r\n 在 System.Web.Script.Services.RestHandler .GetRawParams(WebServiceMethodData methodData, HttpContext context)\r\n 在 System.Web.Script.Services .RestHandler.ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)","ExceptionType" ：“System.InvalidOperationException”}GetRawParams(WebServiceMethodData methodData, HttpContext context)\r\n at System.Web.Script.Services .RestHandler.ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)","ExceptionType" :"System.InvalidOperationException"}GetRawParams(WebServiceMethodData methodData, HttpContext context)\r\n at System.Web.Script.Services .RestHandler.ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)","ExceptionType" :"System.InvalidOperationException"}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T11:24:34.057

```
data: {uname:$uname}, 
```

实际上必须查看文档，jMs 与普通的 jQuery 有点不同。在普通的 jQuery 中，它只是：

```
$.ajax({
    type: "POST",
    url: "Services/MyServices.asmx/check_username",
   data: "{uname:'" + $uname + "'}",
  datatype : 'json',
contentType : 'application/json',
    success: function(data) {
        $("#div").html(String(data));
    }
}); 
```

另外，请禁用 GET 请求以避免 CSRF 安全问题。

```
[ScriptMethod( UseHttpGet = false, ResponseFormat = ResponseFormat.Json )] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T03:42:45.657

你有没有尝试过？

```
$.jmsajax({
    ...
    data: { uname: $uname },
    ...
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-09T16:22:14.157

我遇到了同样的问题，发现我在 jQuery 调用中不知不觉地提交了一个字典对象。当提交的对​​象类型未映射到您的 web 方法预期的参数时，似乎会出现错误。如果您没有为 $.ajax(...) 调用中的“数据”字段提供正确的标识符，您将收到此错误。确保为数据字段提供标识符：

{参数名称：“值”}

而不是我在做什么 {{field1:"value",field2:value}}

嵌套数据将导致 .net 尝试将对象反序列化为字典。如果您的 webmethod 需要一个 Dictionary 对象，那没关系，但除此之外就没有那么多了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-20T11:59:04.497

只是一个注释，并没有深入，但是当我在方法签名上使用 ByRef 而不是 ByVal 时出现了这个错误！没有看我在做什么，并且错过了很多次查看代码 - 针和干草堆的事情。

# html - IE6和IE7之间的浏览器兼容性

> ID：793107
> 
> 赞同：0
> 
> 时间：2009-04-27T11:22:51.737
> 
> 标签：html, ajax, internet-explorer-6, internet-explorer-7, cross-browser

我正在开发一个项目，我需要根据使用 AJAX 单击的标志更改语言。它在 IE7 中运行良好，但在 IE6 中运行时显示错误。

```
<html>
  <head>
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script language="javascript">   
google.load("language", "1"); 

function fnTrans(strTransText,strTransField, strTransFLang, strTransTLang)
{
    google.language.translate(strTransText, strTransFLang, strTransTLang, function(result) {
      var strcontainer = document.getElementById(strTransField);
      strcontainer.innerHTML = result.translation ;  
      });
}

function initialize(strToTxtBox, strFromTxtBox) {
    var x = window.location.toString();
    var strLang = x.substring(x.indexOf("=")+1);
    if((x.indexOf("="))==-1) return;
    strFLang = strLang.substring(0,2)
    strTLang = strLang.substring(strLang.indexOf("-")+1);
    var strText = document.getElementById(strFromTxtBox).innerHTML;

    if(strFLang != 'en')
        fnTrans(strText,strFromTxtBox, 'en',strFLang)

    fnTrans(strText,strToTxtBox, strFLang,strTLang) 
}

function fnhi()
{
    var label=document.getElementsByTagName("label");
    var count=label.length;
    var x = window.location.toString();
    var strLang = x.substring(x.indexOf("=")+1);
    if((x.indexOf("="))==-1)
         return;
    for(var i=0;i<count;i++)
          {
        initialize(label[i].id,label[i].id);
    }
document.getElementById("curlang").value=strTLang;
}

function fnClick(lang)
{
    if(lang=="") return;
    var curlang=document.getElementById("curlang").value;
    if(lang==curlang) return;
    window.location='language.php?strLang=' + curlang+'-'+lang;
}

    </script>
    </head>
    <body onload="fnhi()">
    <input type="hidden" id="curlang" value="en" size="3">
    <img src= "langauage.gif" use ="#map">
    <map name="Map">
        <area shape="rect" alt="Arabic" value="ar" coords="36,6,62,19" href="#" onclick="fnClick(this.value);">
        <area shape="rect" alt="Chinese" value="zh" coords="66,6,90,20" href="#" onclick="fnClick(this.value);">
        <area shape="rect" alt="German" value="de" coords="95,6,121,21" href="#" onclick="fnClick(this.value);">
    </map>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T12:21:39.613

目前尚不清楚问题是什么。因此我猜。如果您想在依赖于 javascript 浏览器的情况下做某事，那么您可以询问从哪个浏览器发送了请求。

```
<html>
<body>

<script type="text/javascript">
var browser=navigator.appName;
var b_version=navigator.appVersion;
var version=parseFloat(b_version);

document.write("Browser name: "+ browser);
document.write("<br />");
document.write("Browser version: "+ version);
</script>

</body>
</html> 
```

然后添加“if”语句，您可以“自定义”依赖于浏览器的行为。无论如何*，我不建议*这样做，因为您必须为所有浏览器维护您的代码。您还必须测试不同的浏览器和浏览器版本。

一个可能的解决方案是使用一些跨浏览器的 javascript 库，例如 Google 的 GWT。

路易斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-26T21:41:25.063

您应该尝试[http://code.google.com/p/jquery-translate/](http://code.google.com/p/jquery-translate/)！

# asp.net - 如何在 asp.net checkboxlist 中设置多个选定的值

> ID：793108
> 
> 赞同：11
> 
> 时间：2009-04-27T11:24:26.163
> 
> 标签：asp.net, .net-3.5, checkboxlist

我有一个绑定到 linq to sql 数据源的 asp.net 复选框列表，当我在页面加载事件上检查 CheckBoxList 的项目计数时，它为 0。我希望能够在此处设置复选框列表中的选定项目，但不能.

数据源的 selected 事件在页面加载后触发。如果是这种情况，我该如何设置列表中的选定项目？

如果我将 SelectedValue 设置为一个值，它只会显示最后一个被选中的值，而不是所有被选中的值。如何在页面加载事件的复选框列表中选择多个值？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-03-17T14:57:12.037

我知道这是一个旧帖子，但我最近遇到了同样的问题。

要选择 DataBound CheckBoxList 的多个项目，请处理 DataBound 事件并循环遍历 Items 集合，根据需要在每个项目上单独设置 Selected 属性。

设置控件的 SelectedValue 属性只检查最后一项。

```
 foreach (ListItem item in MyCheckBoxList.Items)
 {
     item.Selected = ShouldItemBeSelectedMethod(item.Value);
 } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-12-24T10:21:52.997

我使用的好方法：

```
 private void SetCheckBoxListValues(CheckBoxList cbl, string[] values)
        {
            foreach (ListItem item in cbl.Items)
            {
                item.Selected = values.Contains(item.Value);
            }
        } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-04-12T04:32:31.730

```
public void SetValueCheckBoxList(CheckBoxList cbl, string sValues)
        {
            if (!string.IsNullOrEmpty(sValues))
            {                
                ArrayList values = StringToArrayList(sValues);             
                foreach (ListItem li in cbl.Items)
                {
                    if (values.Contains(li.Value))
                        li.Selected = true;
                    else
                        li.Selected = false;                    
                }               
            }
        }

private ArrayList StringToArrayList(string value)
        {
            ArrayList _al = new ArrayList();
            string[] _s = value.Split(new char[] { ',' });

            foreach (string item in _s)
                _al.Add(item);

            return _al;
        } 
```

谢谢，slnavn2000

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T11:39:16.487

听起来像一个页面生命周期 - 数据绑定问题。

你真的应该看看[这个问题](https://stackoverflow.com/questions/780684/how-to-update-page-data-after-event-handling/)的（答案） 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T07:38:53.287

我使用DataBound 事件来选择设置选中的项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-18T19:43:00.140

假设您的值是字符串数组。然后我会这样做

```
foreach (ListItem li in ctrl.Items)
   li.Selected = Array.Exists(values, x => x == li.Value); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-17T06:16:11.517

设置 checkboxlist 从列表中选择的项目：

```
 List<int> yourlist;
        //fill yourlist
        foreach (ListItem item in checkboxlist.Items)
        {
            if (yourlist.Contains(int.Parse(item.Value.ToString())))
                item.Selected = true;                
        } 
```

# c# - C#中的每像素碰撞问题

> ID：793109
> 
> 赞同：1
> 
> 时间：2009-04-27T11:24:29.003
> 
> 标签：c#, collision-detection, pixel

为了我自己的目的，我正在用 C# 编写一个小型 2d 游戏引擎，除了精灵碰撞检测之外它工作正常。我决定将其设为逐像素检测（对我来说最容易实现），但它并没有按照预期的方式工作。代码在碰撞发生之前很久就检测到它。我已经检查了检测的每个组成部分，但我找不到问题所在。

碰撞检测方法：

```
public static bool CheckForCollision(Sprite s1, Sprite s2, bool perpixel) {
    if(!perpixel) {
        return s1.CollisionBox.IntersectsWith(s2.CollisionBox);
    }
    else {
        Rectangle rect;
        Image img1 = GraphicsHandler.ResizeImage(GraphicsHandler.RotateImagePoint(s1.Image, s1.Position, s1.Origin, s1.Rotation, out rect), s1.Scale);
        int posx1 = rect.X;
        int posy1 = rect.Y;

        Image img2 = GraphicsHandler.ResizeImage(GraphicsHandler.RotateImagePoint(s2.Image, s2.Position, s2.Origin, s2.Rotation, out rect), s2.Scale);
        int posx2 = rect.X;
        int posy2 = rect.Y;

        Rectangle abounds = new Rectangle(posx1, posy1, (int)img1.Width, (int)img1.Height);
        Rectangle bbounds = new Rectangle(posx2, posy2, (int)img2.Width, (int)img2.Height);

        if(Utilities.RectangleIntersects(abounds, bbounds)) {

            uint[] bitsA = s1.GetPixelData(false);

            uint[] bitsB = s2.GetPixelData(false);

            int x1 = Math.Max(abounds.X, bbounds.X);
            int x2 = Math.Min(abounds.X + abounds.Width, bbounds.X + bbounds.Width);

            int y1 = Math.Max(abounds.Y, bbounds.Y);
            int y2 = Math.Min(abounds.Y + abounds.Height, bbounds.Y + bbounds.Height);

            for(int y = y1; y < y2; ++y) {
                for(int x = x1; x < x2; ++x) {
                    if(((bitsA[(x - abounds.X) + (y - abounds.Y) * abounds.Width] & 0xFF000000) >> 24) > 20 &&
                        ((bitsB[(x - bbounds.X) + (y - bbounds.Y) * bbounds.Width] & 0xFF000000) >> 24) > 20)
                        return true;
                }
            }
        }
        return false;
    }
} 
```

图像旋转方法：

```
internal static Image RotateImagePoint(Image img, Vector pos, Vector orig, double rotation, out Rectangle sz) {
    if(!(new Rectangle(new Point(0), img.Size).Contains(new Point((int)orig.X, (int)orig.Y))))
        Console.WriteLine("Origin point is not present in image bound; unwanted cropping might occur");
    rotation = (double)ra_de((double)rotation);
    sz = GetRotateDimensions((int)pos.X, (int)pos.Y, img.Width, img.Height, rotation, false);
    Bitmap bmp = new Bitmap(sz.Width, sz.Height);
    Graphics g = Graphics.FromImage(bmp);
    g.SmoothingMode = SmoothingMode.AntiAlias;
    g.InterpolationMode = InterpolationMode.HighQualityBicubic;
    g.PixelOffsetMode = PixelOffsetMode.HighQuality;
    g.RotateTransform((float)rotation);
    g.TranslateTransform(sz.Width / 2, sz.Height / 2, MatrixOrder.Append);
    g.DrawImage(img, (float)-orig.X, (float)-orig.Y);
    g.Dispose();
    return bmp;
}       
internal static Rectangle GetRotateDimensions(int imgx, int imgy, int imgwidth, int imgheight, double rotation, bool Crop) {
    Rectangle sz = new Rectangle();
    if (Crop == true) {
        // absolute trig values goes for all angles
        double dera = de_ra(rotation);
        double sin = Math.Abs(Math.Sin(dera));
        double cos = Math.Abs(Math.Cos(dera));
        // general trig rules:
        // length(adjacent) = cos(theta) * length(hypotenuse)
        // length(opposite) = sin(theta) * length(hypotenuse)
        // applied width = lo(img height) + la(img width)
        sz.Width = (int)(sin * imgheight + cos * imgwidth);
        // applied height = lo(img width) + la(img height)
        sz.Height = (int)(sin * imgwidth + cos * imgheight);
    }
    else {
        // get image diagonal to fit any rotation (w & h =diagonal)
        sz.X = imgx - (int)Math.Sqrt(Math.Pow(imgwidth, 2.0) + Math.Pow(imgheight, 2.0));
        sz.Y = imgy - (int)Math.Sqrt(Math.Pow(imgwidth, 2.0) + Math.Pow(imgheight, 2.0));
        sz.Width = (int)Math.Sqrt(Math.Pow(imgwidth, 2.0) + Math.Pow(imgheight, 2.0)) * 2;
        sz.Height = sz.Width;

    }
    return sz;
} 
```

像素获取方法：

```
public uint[] GetPixelData(bool useBaseImage) {
    Rectangle rect;
    Image image;
    if (useBaseImage)
        image = Image;
    else
        image = GraphicsHandler.ResizeImage(GraphicsHandler.RotateImagePoint(Image, Position, Origin, Rotation, out rect), Scale);

    BitmapData data;
    try {
        data = ((Bitmap)image).LockBits(new Rectangle(0, 0, image.Width, image.Height), ImageLockMode.ReadOnly, PixelFormat.Format32bppArgb);
    }
    catch (ArgumentException) {
        data = ((Bitmap)image).LockBits(new Rectangle(0, 0, image.Width, image.Height), ImageLockMode.ReadOnly, image.PixelFormat);
    }

    byte[] rawdata = new byte[data.Stride * image.Height];
    Marshal.Copy(data.Scan0, rawdata, 0, data.Stride * image.Height);
    ((Bitmap)image).UnlockBits(data);
    int pixelsize = 4;
    if (data.PixelFormat == PixelFormat.Format24bppRgb)
        pixelsize = 3;
    else if (data.PixelFormat == PixelFormat.Format32bppArgb || data.PixelFormat == PixelFormat.Format32bppRgb)
        pixelsize = 4;

    double intdatasize = Math.Ceiling((double)rawdata.Length / pixelsize);
    uint[] intdata = new uint[(int)intdatasize];

    Buffer.BlockCopy(rawdata, 0, intdata, 0, rawdata.Length);

    return intdata;
} 
```

像素检索方法有效，旋转方法也有效，因此代码可能出错的唯一地方是碰撞检测代码，但我真的不知道问题可能出在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T06:27:41.687

我想我找到了你的问题。

```
internal static Rectangle GetRotateDimensions(int imgx, int imgy, int imgwidth, int imgheight, double rotation, bool Crop) {
    Rectangle sz = new Rectangle(); // <-- Default constructed rect here.
    if (Crop == true) {
            // absolute trig values goes for all angles
            double dera = de_ra(rotation);
            double sin = Math.Abs(Math.Sin(dera));
            double cos = Math.Abs(Math.Cos(dera));
            // general trig rules:
            // length(adjacent) = cos(theta) * length(hypotenuse)
            // length(opposite) = sin(theta) * length(hypotenuse)
            // applied width = lo(img height) + la(img width)
            sz.Width = (int)(sin * imgheight + cos * imgwidth);
            // applied height = lo(img width) + la(img height)
            sz.Height = (int)(sin * imgwidth + cos * imgheight);

            // <-- Never gets the X & Y assigned !!!
    } 
```

由于您从未将 imgx 和 imgy 分配给 Rectangle 的 X 和 Y 坐标，因此每次调用 GetRotateDimensions 都会生成一个具有相同位置的 Rectangle。它们可能具有不同的大小，但它们将始终位于默认的 X、Y 位置。这将导致您看到的真正早期的碰撞，因为每当您尝试检测两个精灵上的碰撞时，GetRotateDimensions 都会将它们的边界置于相同的位置，而不管它们实际在哪里。

一旦你纠正了这个问题，你可能会遇到另一个错误：

```
Rectangle rect;
Image img1 = GraphicsHandler.ResizeImage(GraphicsHandler.RotateImagePoint(s1.Image, s1.Position, s1.Origin, s1.Rotation, out rect), s1.Scale);
// <-- Should resize rect here.
int posx1 = rect.X;
int posy1 = rect.Y; 
```

您从 RotateImagePoint 函数获得边界矩形，但随后调整图像大小。矩形中的 X 和 Y 可能与调整后图像边界的 X 和 Y 不完全相同。我猜你的意思是图像的中心保持在原位，而所有点在调整大小时都向中心收缩或扩展。如果是这种情况，那么您需要调整 rect 以及图像的大小以获得正确的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T11:50:41.390

我认为这里的许多人不会费心仔细检查您的代码以找出究竟是什么错误。但我可以提供一些提示，告诉您如何找到问题所在。

如果碰撞发生在它应该发生之前很久，我建议您的边界框检查无法正常工作。

我会更改代码以在碰撞时转储有关矩形的所有数据。因此，您可以创建一些代码来显示碰撞情况。这可能比查看数字更容易。

除此之外，我怀疑每像素碰撞检测是否更容易实现。当您允许旋转和缩放时，很快就会变得难以正确。我会改为进行基于多边形的碰撞检测。

我已经像您一样制作了自己的 2D 引擎，但我使用了基于多边形的碰撞检测，并且效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T11:54:21.130

我怀疑这是实际问题，但`LockBits`不能保证位数据与图像的宽度对齐。

即，可能有一些填充。您需要使用`data[x + y * stride]`而不是访问图像`data[x + y * width]`。Stride 也是`BitmapData`.

# javascript - 等到函数加载完毕

> ID：793114
> 
> 赞同：5
> 
> 时间：2009-04-27T11:26:12.680
> 
> 标签：javascript, jquery

javascript 函数完全加载后，如何在 jQuery 中进行测试？我想使用一个gif，它显示加载，而javascript函数加载，并在函数完全加载时隐藏它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-27T11:41:20.617

```
$(function(){
    $("#loadingGIF").show();
    WaitForFunction();
});

function WaitForFunction()
{
    if (!$.isFunction(FUNCTION_TO_WAIT_ON_HERE)) {
       setTimeout( WaitForFunction, 100);
       return;
    }
    Function_Loaded();
}

function Function_Loaded(){
      $("#loadingGIF").hide();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T11:31:50.357

定义函数后调用自己。函数定义之后的语句只会在前面的源文本被读取（并因此执行）后才会执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T12:02:32.203

我不确定加载是什么意思，但无论如何都应该适用以下内容：

1.  当您开始加载 JavaScript 代码时，显示 GIF
2.  在你加载的代码中，在最后添加一个隐藏 GIF 的语句

这应该以“简单”的方式解决您的问题，而无需使用计时器等。

# c# - NetServerEnum 从哪里得到它的机器列表？

> ID：793118
> 
> 赞同：2
> 
> 时间：2009-04-27T11:27:47.933
> 
> 标签：c#, networking, netapi32

从哪里`NetServerEnum()`得到它的机器列表？

它是否使用计算机浏览器服务，或者如果 AD 可用，它是否会使用 AD 作为首选项？

链接：

*   [MSDN 上的 NetServerEnum](http://msdn.microsoft.com/en-us/library/aa370623(VS.85).aspx)
*   [PInvoke 上的 NetServerEnum](http://www.pinvoke.net/default.aspx/netapi32/netserverenum.html)
*   [计算机浏览器服务说明](http://support.microsoft.com/kb/188001)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T13:07:31.237

从浏览器服务。NetServerEnum 早于 Active Directory，并且必须在非 AD 系统上运行。如果找不到浏览服务器，NetServerEnum 将返回 6118（无浏览器）。我认为 AD 具有用于此类任务的 ADSI 接口，但我从未针对 AD 进行编程。

请注意，NetServerEnum 在大型域上可能会非常慢：我通过尝试将 NSE 用于基本的“发现”算法而发现了这一点。很快就吸取了我的教训，并转而使用 UDP 来完成这项任务。

# c# - RIA 服务 + 实体 - 在客户端中提前 24 小时移动日期

> ID：793121
> 
> 赞同：2
> 
> 时间：2009-04-27T11:29:37.557
> 
> 标签：c#, asp.net, vb.net, silverlight

我目前正在使用 RIA Services 进行一个 Silverlight 项目，并且似乎遇到了一个错误（或编写了一个新错误）。

在一个简单的查询中，我正在从服务器检索实体模型。在服务器端服务类中，DateTime 是正确的（对于数据库中的内容），但在客户端它似乎可以追溯到 24 小时甚至 10 小时......

我不知道为什么，这很奇怪。

6/04/2009 12:00:00 AM（数据库）变为 5/04/2009 2:00:00 PM，也显示为 5/4/2009 12:00:00 AM。

见附件.....

这是一个错误还是我对日期时间的理解不足？

[替代文字 http://www.madhousedesigns.com.au/Custom/Images/CrazyDateTimes.png](http://www.madhousedesigns.com.au/Custom/Images/CrazyDateTimes.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-25T15:39:27.803

当您检索日期时，将 DateTime 类型转换为 UTC。这应该可以解决您的问题。

# wcf - 防火墙后面的 WCF WebService / IIS 托管和配置问题

> ID：793122
> 
> 赞同：28
> 
> 时间：2009-04-27T11:30:08.320
> 
> 标签：wcf, web-services, iis, .net-3.5, configuration

我有一个简单的 WCF Web 服务。它托管在我们生产域中默认网站下的 IIS 上。（本地地址：10.10.20.100）

默认情况下，此默认网站设置为端口 80 上的“所有未分配”IP：但是，我注意到这导致 WCF 服务使用服务器本地 DNS 名称生成它的 WSDL。即 wsdl 中的所有 URI 都是

```
http://myserver.subdomain.domain.com/.../... 
```

这不好，因为我需要将此服务公开给不了解生产环境内部 DNS 的站点。而且这个特定的服务器没有外部 DNS 名称。只是一个外部IP地址...

我在 IIS 中从“所有未分配”->“10.10.20.100”更改设置方面取得了一些成功

这会导致服务使用 URI 生成它的 WSDL

```
http://10.10.20.100/.../... 
```

这对于子域和其他子域中的其他机器来说很好，但是我在这里卡住了。服务器外部 IP 地址 (1.2.3.4) 通过一些 NAT/PAT 转换映射，因此它没有在服务器 IP 设置中明确设置（即它不显示在 IP 配置下）

因此，如果我像对内部地址所做的那样将 IIS 默认网站 IP 地址从“所有未分配”->“1.2.3.4”更改，那么 WCF 服务就会返回...

**错误请求（无效的主机名）**

如果我在内部 IP 地址上配置 IIS，并尝试通过我得到的外部 IP 地址访问服务

```
No protocol binding matches the given address 
'http://1.2.3.4/TestService/Service.svc'. Protocol bindings are 
configured at the Site level in IIS or WAS configuration 
```

有什么方法可以让 IIS/WCF 生成它的 WSDL URI，其外部 IP 地址未在服务器上显式配置？

*在我将 WCF 服务从窗口中删除之前，请有人帮助我。*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-30T03:27:23.290

这是因为您没有设置主机标头。这似乎是一个非常普遍的问题，我一直遇到它。它生成的 uri 没有配置，它通过检查站点的主机头来查找正确的地址。即使它在虚拟目录中，您也需要转到父目录，在您的情况下为默认目录，并添加主机头。

如果您不知道该怎么做，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T19:05:27.787

我也许可以防止忍者暴力...如果我了解您的问题...您可以手动指定服务应在 web.config 中使用的完整地址，而不是让 ServiceHost 为您解决。您必须设置服务的基地址：

```
 <service behaviorConfiguration="Behaviour1" name="Api.Poll">
    <endpoint address="soap" binding="basicHttpBinding" bindingConfiguration="soapBinding"
      contract="Api.IPoll" />
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="http://www.mydomain.com/Api" />
        <add baseAddress="http://10.10.20.30/Api" />
      </baseAddresses>
    </host>
  </service> 
```

使用这种方法，你的服务应该接受指定的基地址，加上服务名称，如果你有额外的端点地址。此外，您需要使用自定义 ServiceHostFactory 以编程方式设置基地址。见下文：

```
 public class ServiceHostFactory : System.ServiceModel.Activation.ServiceHostFactory
{
    protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
    {                        
        ServiceHost host;

        host = new ServiceHost(serviceType, baseAddresses[0]);

        return host;
    } 
```

最后，一旦您构建了 ServiceHostFactory 类，您必须通过编辑 .svc 文件中的标记将其连接到您的服务：

```
<%@ ServiceHost Language="C#" Debug="true" Service="Api.Poll" Factory="Api.ServiceHostFactory" CodeBehind="Poll.svc.cs" %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T20:04:26.473

它必须是 IP 地址而不是 FQDN 吗？通过交换到 FQDN 并将其设置在站点的主机标头中，然后通过绑定到它

```
cscript //nologo %systemdrive%\inetpub\adminscripts\adsutil.vbs set W3SVC/1/ServerBindings ":80:hostname.example.com" 
```

然后回收应用程序池将在生成的 WSDL 中生成该主机名。您可以从中受益——您可以设置一个内部 DNS 将该 FQDN 解析为内部 IP，以及一个外部 DNS 解析为您的防火墙 IP，然后相同的系统将无需任何更改即可工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-11T10:19:34.193

以下是在 IIS7 中更改标头的方法。如果有帮助，也可以把我的 web.config 放一些。

[http://www.sslshopper.com/article-ssl-host-headers-in-iis-7.html](http://www.sslshopper.com/article-ssl-host-headers-in-iis-7.html)

```
<?xml version="1.0"?>
<configuration>
  <system.web>
    <compilation debug="true" targetFramework="4.0" />      
    <customErrors mode="Off"></customErrors>
  </system.web> 
  <system.serviceModel>
    <client/>
    <services>
      <service name="WcfService1.Service1"
behaviorConfiguration="MyServiceTypeBehaviors">
        <host>
        <baseAddresses>
          <add baseAddress="https://pws.sjukra.is/"/>        
        </baseAddresses>
        </host>
        <endpoint address="https://pws.sjukra.is/Service1.svc"
                  listenUri="/" 
        binding="wsHttpBinding"
        contract="WcfService1.IService1"
        bindingConfiguration="myBasicHttpBindingConfig"/>
        <endpoint contract="IMetadataExchange"
   binding="mexHttpsBinding"                   
   address="mex"/>
      </service>
    </services>
    <bindings>
      <wsHttpBinding>
        <binding name="myBasicHttpBindingConfig">
          <security mode="TransportWithMessageCredential">
            <transport clientCredentialType="Windows" />
            <message clientCredentialType="UserName"/>
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>
    <behaviors>
      <serviceBehaviors>
        <behavior name="MyServiceTypeBehaviors">
          <serviceMetadata httpsGetEnabled="true"/>
          <serviceDebug httpsHelpPageEnabled="true" includeExceptionDetailInFaults="true"/>
          <serviceCredentials type="System.ServiceModel.Description.ServiceCredentials">
            <userNameAuthentication userNamePasswordValidationMode="Custom" customUserNamePasswordValidatorType="WcfService1.Service1,WcfService1"/>
            <serviceCertificate findValue="pws.sjukra.is" storeLocation="LocalMachine" storeName="My" x509FindType="FindBySubjectName" />
              <clientCertificate>
                  <authentication certificateValidationMode="ChainTrust" revocationMode="NoCheck"/>
              </clientCertificate>            
          </serviceCredentials>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true"></serviceHostingEnvironment>
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
</configuration> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-10-21T07:42:03.843

尽管这是一个旧线程，但它实际上帮助我将一个项目从 VS Web Developer Express 迁移到了包含 WCF 服务的 MonoDevelop。

Web 应用程序使用以下 URL 请求由 WCF 服务定义的 JavaScript 接口：[http://127.0.0.1:8080/path-to-service/service.svc/js](http://127.0.0.1:8080/path-to-service/service.svc/js)，这给了我错误：**没有协议绑定匹配给定地址**

受此线程的启发，我能够解决问题，因为使用 localhost 而不是 127.0.0.1 访问服务是可行的！通过对[http://localhost:8080/path-to-service/service.svc/js](http://localhost:8080/path-to-service/service.svc/js)的请求，我得到了 JavaScript 接口。

实际上，我的应用程序没有使用绝对 URL 来包含 JavaScript 接口，但是默认情况下，当从 MonoDevelop 启动应用程序时，它将使用 127.0.0.1 访问应用程序，因此从服务中调用包含 JavaScript 失败。

它仍然不完美，因为我无法使用 localhost 而不是 127.0.0.1 从 MonoDevelop 启动应用程序，因为 XSP 的配置只允许我指定一个 IP 地址，但至少我知道如何绕过它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-19T02:47:29.010

问题是，在更改端口或 IP 地址后，您必须重新启动您使用的应用程序池，因为它仍然具有旧信息，直到它被回收。

# python - 使用 ctypes 从 Python 调用 gdc/dmd 共享库

> ID：793125
> 
> 赞同：1
> 
> 时间：2009-04-27T11:31:53.383
> 
> 标签：python, d, ctypes

我最近一直在玩 Python 中相当优秀的 ctypes 库。我想知道的是，是否可以创建共享`D`库并以相同的方式调用它们。我假设我会使用with编译`.so`文件或使用库以相同的方式调用它们。`-fPIC``dmd``gdc``ctypes`

有没有人试过这个？看起来好像`UNIX`部分支持共享库。

非常感谢，

铝。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-02-03T09:40:28.273

在这种情况下，Windows dll 应该可以正常工作。我不确定 Linux 上的情况，共享库存在一些问题，这些问题将在 dmd 的 64 位端口完成后立即解决。

请注意，您必须将函数导出为 extern(C) 或 extern(Windows) 才能从 ctypes 访问它们。

# sockets - OpenVMS 下 SAS 中套接字的错误处理

> ID：793127
> 
> 赞同：7
> 
> 时间：2009-04-27T11:32:28.610
> 
> 标签：sockets, error-handling, sas, openvms

我在 OpenVMS 上使用 SAS 9.2 通过使用文件名语句指定的套接字连接到外部数据源：

```
filename extsrc SOCKET "extserver:port" recfm=v;

data foo;
infile extsrc;
input;
.... some statements to read stuff ...;
run; 
```

这在 99% 的时间里都有效（应该如此）。但是，有时应该在远程端口上侦听的程序却不是。目前这会导致程序退出并出现错误：

```
Error: Connection refused. 
```

之后我们再试一次，它通常可以工作。但是，这变得乏味，所以我想在程序中检测到这个错误并在那里处理它。有人知道在 SAS 中检测此类错误的方法吗？

我尝试使用 fileref() 函数检查 fileref extsrc 的有效性，但这只是返回 -20005 ，这意味着 fileref 已分配但不指向本地文件（这是真的）。只有当我在数据步骤中使用 fileref 时，错误才会变得明显，所以我想做一些类似的事情：

```
data _null_;
rc=infile extsrc;
if rc=0 then do;
  //whatever I want to do;
end;
else do;
  //throw some error and try again later;
end;
run; 
```

[update1] 我正在尝试下面的建议，但在真正的[heisenbug](http://en.wikipedia.org/wiki/Unusual_software_bug)时尚中，问题在过去几天没有出现，所以我不确定最终的解决方案是什么。[/更新1]

[update2] 错误终于又出现了。根据 cmjohns 的回答，发生此错误后 syserr 的值为 1012 。我现在将观察 syserr 的值，如果失败，则重试固定次数。[/更新2]

[update3] 我已经运行了几天的一些代码，现在可以运行了。另一个问题是（当然）如果`&syserr`获得的值高于 6，则会发生错误情况，因此根据您的`errorabend/noerrorabend`设置，这会导致程序完全结束，或者导致程序以`obs=0`syntaxchek 模式继续。两者都是不可取的。解决方案是`options noerrorabend nosyntaxcheck`在产生此错误的数据步之前设置。此外，如果发生错误，我必须清除文件名 extsrc 并重新分配它。最后，一旦这段代码完成，我就会恢复错误结束。如果我恢复 nosyntaxcheck，这会导致 SAS 检测到先前的错误情况并在该点切换到 syntaxcheck 模式，这也是不可取的。[/更新3]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T20:58:23.053

您是否尝试过测试 &syserr 的值。任何不为 0 的值通常表示存在问题。

[您可以在此处](http://support.sas.com/documentation/cdl/en/mcrolref/61885/HTML/default/a000208995.htm)查看返回值。从列表来看，我猜 1012 或 1020 是您在套接字错误期间得到的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T13:52:28.217

您可以测试数据 foo 吗？如果没有数据那么你可以设置一个重试循环，如果数据存在，继续？

就像是：

> 再来一遍：
> 
> （在此处插入您的套接字代码）
> 
> ```
> /*see if ds exists*/
> 
> %if not %sysfunc(exist(data.foo)) %then %do ;
> 
> /*if the ds does not exist then*/
> 
> %put WARNING: The file does not exist! ;
> 
> %goto doitagain;
> 
> %end; 
> ```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-07T19:10:35.253

我知道这是一个陈旧的线程，但是：

SYNTAXCHECK 很不错；而不是因为 &syserr (实际上是 &syscc) 问题而裸奔，一旦你通过了代码的敏感部分，你可以将它清除为最后已知的良好值。

以下是当我不得不优雅地处理来自 DB2 的锁定表错误时的相关代码：

```
/*** temporarily disable ERRORABEND and SYNTAXCHECK ***/
options NOERRORABEND NOSYNTAXCHECK ;

/* save &syscc for laster restoration */
%let presyscc=&syscc;

%do until (...);
  /* do a task, handle some possible errors */
%end;

/* restore &syscc */
%let syscc=&presyscc;

/*** re-enable ERRORABEND and SYNTAXCHECK ***/
options ERRORABEND SYNTAXCHECK ; 
```

# c# - 使用 SQLConnection 连接到 SQL CE 数据库

> ID：793128
> 
> 赞同：10
> 
> 时间：2009-04-27T11:32:54.333
> 
> 标签：c#, sql-server-ce, connection-string

很直接的问题。我正在构建一个从 SQL Server 2005 实例读取数据的应用程序。我想在我的笔记本电脑（没有 SQL 2005）上运行一些测试，所以我正在考虑在本地数据库中进行交换以进行测试。

我正在使用 VS2008，因此 Compact Edition DB 似乎是一个自然的选择。我曾希望只换掉我的连接字符串，但似乎它只会让我使用 SqlCeConnection 而不是 SqlConnection 连接到 CE 数据库。有什么办法可以解决这个问题，我可以在连接字符串中使用修饰符吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T11:37:39.703

实际上很可能通过仅修改配置参数来使用 SQL CE 而不是成熟的 SQL Server：更改连接字符串并`IDbXXX`尽可能使用系列接口而不是特定于平台的`SqlXXX`接口`SqlCeXXX`。请参阅[DbProviderFactories](http://msdn.microsoft.com/en-us/library/system.data.common.dbproviderfactories.aspx)。

但是，请注意这两个平台的 SQL 方言的差异。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-04T14:41:48.530

是的，您可以通过引用基类来使用 SQL Compact 和/或 SQL Server。例如：

```
IDbConnection Connection;

if (Compact)
    Connection = new SqlCeConnection();
else
    Connection = new SqlConnection(); 
```

连接字符串需要指向 SQL Compact 的数据文件，例如：`"Data Source=urData.sdf;Persist Security Info=False;"`. 更多[示例在这里](http://www.c-sharpcorner.com/uploadfile/nipuntomar/connection-strings-for-sql-server-compact-edition/)。

此链接将解释[SQL Server 和 SQL Compact 之间的差异](http://erikej.blogspot.co.uk/2011/01/comparison-of-sql-server-compact-4-and.html)，因为它并不相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T11:47:45.827

任一数据库所需的所有 SQL 相关对象都继承自基本抽象 Db...（即 DbConnection、DbDataAdapter 等...）。因此，您可以编写某种 DatabaseManager 类，在实例化时需要知道您是在处理 Sql 还是 Sql Ce。然后，从那时起，您只需处理基类对象（DbConnection 等）。这样，您每次只需要更改经理类的实例即可。

这样做的另一个好处是，如果您以后决定完全切换到另一个提供程序，则不需要更改太多代码。

# python - Django 或 Python 中的数据库报告服务

> ID：793130
> 
> 赞同：7
> 
> 时间：2009-04-27T11:35:31.037
> 
> 标签：python, django, reporting-services

我想知道是否有任何基于 django，甚至基于 Python 的报告服务 ala JasperReports 或 SQL Server 报告服务？

基本上，我希望能够创建报告，将它们作为 CSV 或 HTML 或 PDF 的电子邮件发送出去，而无需对报告进行编码。即使我必须对报告进行编码，我也不介意，但是带有时间表等的整个框架会很好！

PS。我知道我可以使用 Django Apps 来做到这一点，但我希望是否有任何集成解决方案甚至项目，例如 Pinax 或 Satchmo 将所需的应用程序组合在一起。

PPS：它必须在 Postgres 上运行

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T13:48:50.403

“我希望能够创建报告......而无需编写报告”

我也会。然而，遗憾的是，每个报告似乎都是独一无二的，并且需要自定义代码。

从 Django 模型到 CSV 很容易。从你的一些报告开始。

```
import csv
from myApp.models import This, That, TheOther
def parseCommandLine():
    # setup optparse to get report query parameters
def main():
    wtr= csv.DictWriter( sys.stdout, ["Col1", "Col2", "Col3"] )
    this, that = parseCommandLine()
    thisList= This.objects.filter( name=this, that__name=that )
    for object in thisList:
        write.writerow( object.col1, object.that.col2, object.theOther.col3 )
if __name__ == "__main__":
    main() 
```

HTML 非常简单——Django 有一个 HTML 模板语言。您只需渲染模板并将其写入标准输出，而不是 render_to_response。有趣的是，算法的核心与编写 CSV 非常相似。类似的——没有太多的聪明——你应该有一个两者兼得的设计模式。

CSV 正常工作后，使用 Django 的模板添加 HTML。

PDF 更难，因为您必须实际计算出一些详细的格式。为此有很多 Python 库。然而，有趣的是，PDF 编写的整体模式与 CSV 和 HTML 编写非常相似。

发送电子邮件意味着直接使用 Python 的[smtplib](http://docs.python.org/library/smtplib.html)或 Django 的[电子邮件](http://docs.djangoproject.com/en/dev/topics/email/)包。这不是太难。所有的部分都在那里，您只需将上面生成的输出文件通过电子邮件发送到某个分发列表。

调度需要一点思考才能充分利用`crontab`. 这——也许——是工作中最难的部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T15:42:27.463

我只是想经过一番调查后，我会报告我的发现......

[http://code.google.com/p/django-reporting/](http://code.google.com/p/django-reporting/) - 我认为这个项目看起来是我需要的很多功能的绝佳候选者。不幸的是，截至撰写本文时（2009 年 4 月 29 日）它的 Django 1.1 尚未发布。至少在没有太多代码的情况下创建报告的能力。

[http://code.google.com/p/django-cron/](http://code.google.com/p/django-cron/) - Look promising for scheduling of jobs without cron access

[http://www.xhtml2pdf.com/](http://www.xhtml2pdf.com/) - Could be used or ReportLabs PDF Libraries for conversion of HTML to PDF

All these together with Django's Email functionality could make a nice Reporting System.

# php - 显示所有当前定义的变量

> ID：793136
> 
> 赞同：0
> 
> 时间：2009-04-27T11:38:18.470
> 
> 标签：php, variables

没有调试器这可能吗？

我的意思是，我们有 $_POST、$_GET、$_SESSION 等。我正在寻找类似 $_CURRENT_VARS 的东西

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-27T11:40:39.290

[`$GLOBALS`](http://docs.php.net/manual/en/reserved.variables.globals.php)包含所有全局变量。或者你使用[`get_defined_vars()`](http://docs.php.net/manual/en/function.get-defined-vars.php).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T13:15:10.687

好吧，这是矫枉过正，但你可以打电话`phpinfo()`来显示（基本上）一切。

# c - DLL 函数未导出：找不到名为 TestFunc 的入口点

> ID：793139
> 
> 赞同：2
> 
> 时间：2009-04-27T11:39:58.747
> 
> 标签：c, windows, winapi

我正忙着了解一点 C/C++，并与 C# 互操作。我检查了几个创建简单 Win32 DLL 并从 C# 使用它的示例，但是当我尝试调用我的 DLL 时，我收到运行时错误：“无法找到名为 TestFunc 的入口点”。我的 DLL 看起来像这样，我从一个 Win32 DLL 项目创建它，并使用空项目选项：

标题：

```
__declspec(dllexport) int TestFunc(char *, char *, char *); 
```

代码文件：

```
#include "stdafx.h"
#include "TestLib.h"

__declspec(dllexport) int TestFunc(char *arg1, char *arg2, char *arg3) 
{
  char str1[] = "Brady Kelly";
  char str2[] = "Hello World";
  char str3[] = "1234567890";

  strcpy(arg1, str1);

  return 128;   
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T11:46:37.937

您的函数是使用 C 或 C++ 绑定编译的吗？您没有指定，但在我看来，您可能正在使用 C++ 编译器 - 编译器使用与 C 编译器非常不同的名称修饰，您将无法简单地找到名称“TestFunc”就像您使用 C 编译器或使用 C 名称修改规则一样。

要简单地告诉 C++ 编译器使用 C 名称修改规则，请在头文件中使用：

```
extern "C"
{
  __declspec(dllexport) int TestFunc(char *, char *, char *);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T11:49:53.013

此外，您只需要函数声明（在头文件中）前面的 declspec，而不是定义。用于检查从 DLL 导出的内容以及 DLL 所依赖的内容的有用工具是[Dependency Walker](http://www.dependencywalker.com/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T12:04:15.803

实际上，由于您已将此问题标记为 C，因此我建议对 1800 INFORMATION 的解决方案稍作改动：

```
#ifdef __cplusplus
extern "C" {
#endif

#ifdef EXPORT_MODE
#define METHODTYPE __declspec(dllexport)
#else 
#define METHODTYPE __declspec(dllimport)
#endif

#ifdef __cplusplus
}
#endif

/*! _The_ method */
METHODTYPE int TestFunc(char *, char *, char *); 
```

这将允许您在客户端代码和您的代码中使用相同的标头。

**注意：** Dependency Walker 不再与 VS2008 捆绑在一起。如果您使用的是 VS2008，则必须下载它。

# windows-mobile - 用于列出 Windows Mobile 设备上的文件的 API

> ID：793144
> 
> 赞同：0
> 
> 时间：2009-04-27T11:41:22.333
> 
> 标签：windows-mobile, file, windows-ce

我正在编写一个 Windows Mobile 应用程序，我想获取设备上某个文件夹中的文件列表。是否有 API 可用于读取有关设备文件系统中的文件夹和文件的信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T11:58:36.113

这就像桌面应用程序一样。对于 .NET，请查看[DirectoryInfo](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx)和类似的类。

对于 C++，从[FindFirstFile开始](http://msdn.microsoft.com/en-us/library/aa914391.aspx)

# c# - 将两个计数查询合并为一个布尔查询

> ID：793145
> 
> 赞同：3
> 
> 时间：2009-04-27T11:42:53.310
> 
> 标签：c#, linq, linq-to-sql

我想不出一个好方法把它写成一个查询。

```
int count1 = query1.Count();
int count2 = query2.Count();

return count1 > count2; 
```

请注意，我对编写**单个**查询的方法感兴趣，该查询返回一个布尔值并在服务器上被评估一次。

请注意，我对使用 LINQ 而不是 SQL 编写此代码的方法感兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T12:00:57.293

尝试

```
return query1.Count() > query2.Count(); 
```

尝试在同一个服务器调用中运行两个不相关的查询是不值得的，但这里是：

```
SELECT CASE WHEN (SELECT COUNT(*) FROM Products) 
        > (SELECT COUNT(*) FROM Orders) 
            THEN CAST(1 as bit) 
            ELSE CAST(0 AS BIT) 
```

但是，我严重怀疑您是否可以让 LINQ 创建这种查询。您将不得不调用存储过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T12:20:15.047

有什么问题

```
var result= query1.Count() > query2.Count();

return result; // result is of type bool 
```

编辑：

如果您真的想在服务器上将其作为一个查询执行，您可以使用 DataContext.ExecuteQuery 来执行动态查询。

# mvp - （MVP 模式）如何将错误消息从 Presenter 转发到 View？

> ID：793151
> 
> 赞同：6
> 
> 时间：2009-04-27T11:45:33.773
> 
> 标签：mvp

我有一个方法，用户可以搜索文章编号，如果它在数据库中可用，则文章编号绑定到 BindingList。现在我想让用户知道该文章是否在数据库中不可用。我该如何以正确的方式做到这一点？

只需将消息 errorMessage 传递给我的接口方法？

主持人：

```
string errorMessage;
_view.ErrorMessage(errorMessage); 
```

看法：

```
public void ErrorMessage(string errorMessage)
{
      MessageBox.Show(errorMessage);
} 
```

你会这样做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-15T17:35:37.503

我们冒泡一个事件。在演示者中，您注册该事件：

```
public event PresenterEventHandler Message; 
```

然后像这样提高它：

```
PresenterEventArgs pe = new PresenterEventArgs("Error message", Status.Error);
this.Message(this, pe); 
```

然后在视图中：

```
protected override void OnInit(EventArgs e)
{
    this.presenter = new MyPresenter(this, MyBusinessService.Instance);
    this.presenter.Message += new PresenterEventHandler(presenter_Message);
}

void presenter_Message(object sender, PresenterEventArgs pe)
{
    // display error message
} 
```

您可以通过这种方式将不同类型的状态传递回视图，而不仅仅是错误消息。我们有成功、错误、锁定、警告、帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T12:08:36.387

在出现错误消息的情况下，我会调用一些基本功能。这样，您可以选择是否更新左下角的状态窗口和/或显示模式消息框。

在演示者中：

```
_windowManager.NoItemFound(errorMessage) 
```

在窗口管理器中：

```
_statusBox.Text = errorMessage; MessageBox.Show(errorMessage); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-02T07:23:36.963

如果它的 MVP - Passive View，那么 View 接口应该有一个可以读取的属性：

```
public interface IArticleListView {
    // more stuff here...
    bool ErrorMessageVisible { set; }
    string ErrorMessage { set; }
    // more stuff here...
    int ArticleNumber { get; }
}

public interface IPresenter {
    public void Update();
}

public class ArticleListPresenter : IPresenter {
    IViewArticleList _view;

    public ArticleListPresenter(IArticleListView view) {
        this._view = view;
        // you could update the view here or with an update method,
        // completely up to you.
    }

    // Assuming you are using a fine grained presenter
    public void HandleArticleNumberSearch() {
        bool articleNotFound;
        // search for the article ...    
        if ( articleNotFound ) {
            this._view.ErrorMessageVisible = true;
            this._view.ErrorMessage = string.Format("The article #{0} was not found.", number);
        }
    }
}

public class ArticleList : Page, IArticleListView {
    ArticleListPresenter _presenter;

    public bool ErrorMessageVisible {
        set { this.lblErrorMessage.Visible = value; }
    }

    public bool ErrorMessage {
        set { this.lblErrorMessage.Text = value; }
    }

    public int ArticleNumber {
        // You have to do some sort of validation here, but I'll keep it simple
        get { return Integer.Parse(this.txtArticleNumber.Text); }
    }

    protected override void OnInit(EventArgs e) {
        this._presenter = new ArticleListPresenter(this);
    }

    protected void Page_Load(object sender, EventArgs e) {
        // this implementation keeps the state in the View, and updates it
        // in the presenter: Passive View
        if(!this.IsPostBack) {
            this._presenter.Update();
        }
    }

    protected void OnSearchArticleButtonClick(object sender, EventArgs e) {
        this._presenter.HandleArticleNumberSearch();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-17T09:02:58.297

我们不应该重新发明轮子......

你应该简单地在你的模型中抛出一个异常。

然后，视图将使用 try catch 块捕获异常。

在“catch”中，显示您的消息框。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T11:50:17.957

我就是做这个的。

我读过的另一种方法是让模型知道如何显示错误（可能通过 ErrorMessagePresenter），以便将错误与原始演示者分离。

我还没有真正找到它的用途，对我来说，它总是以演示者和实现这两个接口的视图结束。

# active-directory - 为 LDAP 中的新对象类选择 RDN？

> ID：793155
> 
> 赞同：5
> 
> 时间：2009-04-27T11:46:51.943
> 
> 标签：active-directory, ldap, jndi, openldap, adam

在 LDAP 中创建新对象类时选择 RDN 的最佳实践是什么？我知道您可以从 uid、cn、ou 等中进行选择，但是应该遵循哪些做法呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-25T15:51:10.527

RDN 本质上是您的主键（的一部分）。同样的原则适用：

*   条目的独特之处（或事物的组合）。
*   不改变（或不经常改变）的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T22:15:33.080

使用 OpenLDAP 时，您可以选择对象上允许的任何属性作为 RDN（根据其 objectClasses），但在 ActiveDirectory 上，[RDN 属性](http://msdn.microsoft.com/en-us/library/cc223167.aspx)是在适当的模式中定义的 - 因此在使用预定义类时您没有选择权。

当您有选择时（使用 OpenLDAP 或在 ActiveDirectory 上使用您自己的模式），我建议使用有效识别底层条目的 RDN（当然，您的 RDN 在给定子树的子节点中必须是唯一的）。如果您确定单个 RDN 属性不足以唯一标识给定条目，OpenLDAP 还允许使用多值 RDN：

```
cn=Robert Smith+uid=rsmith,ou=people,dc=example,dc=com 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T08:14:35.550

也许使用预定义的 objectClasses 之一而不是创建一个新的 objectClasses 可能更明智。[以下](http://www.zytrax.com/books/ldap/ape/)是常用派生类的列表。

# wpf - 有谁知道 WPF 数据绑定示例的详尽集合？

> ID：793158
> 
> 赞同：5
> 
> 时间：2009-04-27T11:48:08.103
> 
> 标签：wpf, data-binding

似乎每次我读到一篇关于“如何进行 WPF 数据绑定”的文章时，都会有一些不同的变化，有时使用 DataContext，有时没有，有时使用 Itemssource 或同时使用 Itemssource 和 DataContext，还有 ObjectDataProvider，你可以在 XAML 或代码隐藏中包含任何这些，或者没有代码隐藏并直接从 XAML 绑定到您的 ViewModel。

似乎在 XAML 本身中有许多不同的语法可供使用，例如：

```
<ListBox ItemsSource="{Binding Source={StaticResource Customers}}"> 
```

和

```
<ListBox DataContext="{StaticResource Customers}" ItemsSource="{Binding}"> 
```

例如，这两个代码示例执行相同的操作：

**1\. 使用没有代码隐藏的 ObjectDataProvider：**

```
<Window x:Class="TestDataTemplate124.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:TestDataTemplate124"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <ObjectDataProvider x:Key="Customers"
                            ObjectType="{x:Type local:Customer}"
                            MethodName="GetAllCustomers"/>
    </Window.Resources>
    <StackPanel>
        <ListBox DataContext="{StaticResource Customers}" ItemsSource="{Binding}">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding FirstName}"/>
                        <TextBlock Text=" "/>
                        <TextBlock Text="{Binding LastName}"/>
                        <TextBlock Text=" ("/>
                        <TextBlock Text="{Binding Age}"/>
                        <TextBlock Text=")"/>
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </StackPanel>
</Window> 
```

**2.没有DataContext的例子：**

```
<Window x:Class="TestDataTemplate123.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:TestDataTemplate123"
    Title="Window1" Height="300" Width="300">
    <StackPanel>
        <ListBox x:Name="ListBox1">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding FirstName}"/>
                        <TextBlock Text=" "/>
                        <TextBlock Text="{Binding LastName}"/>
                        <TextBlock Text=" ("/>
                        <TextBlock Text="{Binding Age}"/>
                        <TextBlock Text=")"/>
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </StackPanel>
</Window>

    using System.Collections.ObjectModel;
    using System.Windows;

    namespace TestDataTemplate123
    {
        public partial class Window1 : Window
        {
            public Window1()
            {
                InitializeComponent();
                ListBox1.ItemsSource = Customer.GetAllCustomers();
            }
        }
    } 
```

有谁知道解释 WPF 数据绑定的来源，而不是仅仅说“这是你如何进行数据绑定”，然后解释一种特定的方式，而是试图**解释进行数据绑定的各种方法，并展示可能的优点和**缺点例如，是否有 DataContext，在 XAML 中绑定或代码隐藏等？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T12:15:49.817

看看[这个](http://www.nbdtech.com/Free/WpfBinding.pdf)备忘单

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T11:58:09.343

我可以向您推荐[Bea Stollnitz](http://bea.stollnitz.com/blog/)的博客。如果我没记错的话，她在 Microsoft 工作并参与 WPF 的开发，尤其是数据绑定。她确实有一些很棒的 WPF 教程，其中很多是关于数据绑定的。你应该在这里找到一些非常好的信息。

# iphone - iPhone应用开发平台

> ID：793161
> 
> 赞同：0
> 
> 时间：2009-04-27T11:49:37.913
> 
> 标签：iphone, xcode

我是 iPhone 应用程序开发的新手，目前正在使用 .net (C#)。

请建议开发平台来创建 iPhone 应用程序，以便我可以很快采用。

其中最好的是：

1.  Xcode
2.  Unity使用脚本语言c#
3.  特苏斯

或不在列表中的任何其他工具。

是否可以使用 .NET 框架开发 iPhone 应用程序？我不确定; 我想不是。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T05:46:36.327

XCode 是 iPhone 的唯一开发环境，Objective C 是它为此使用的语言。您不能使用 .NET 框架来构建 iPhone 应用程序。

SDK 可免费下载，但您需要向 Apple 注册（免费）才能获得 SDK，它最初允许您在软件模拟器环境中构建和运行应用程序；要将应用程序放在实体手机上，您需要购买许可证（99 美元）并通过一个相当复杂的过程来设置签名证书。

SDK 和各种示例代码和教程都在 Apple iPhone 开发者网站[http://developer.apple.com/iphone/](http://developer.apple.com/iphone/)上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T11:43:57.393

在 Windows 平台上开发 iPhone 应用程序是不可能的。您需要官方 SDK，它仅适用于 Mac OS X。

查看[http://developer.apple.com/iphone/](http://developer.apple.com/iphone/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T16:42:22.357

官方 SDK 是免费的，但不是开源的。构建 iPhone 应用程序所需的所有工具都是免费的。但是，如果不支付 99 美元的开发者许可费，您就无法将您的应用程序放在 iPhone 或 iPod Touch 设备上。您可以在 iPhone Simulator 上运行您构建的应用程序，这是一个在您的 Mac 上运行的应用程序。它的外观和行为与真正的 iPhone 非常相似，只是少了一些明显的东西（没有 GPS，没有摄像头）。

转到[http://developer.apple.com/iphone/](http://developer.apple.com/iphone/)开始使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T14:37:09.737

Unity 看起来很有前途，但对于 indy 程序员来说，它的成本太高了。我上周看了这个，为了得到我需要的包裹，我必须降低近 3,000 美元。不过，您仍然必须使用 XCode 来编译您的应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T11:46:40.727

学习 Obj-C 。如果你没有mac，那就买一台。

# sql - MySQL中的更新问题

> ID：793162
> 
> 赞同：1
> 
> 时间：2009-04-27T11:49:41.500
> 
> 标签：sql, mysql

根据文档，与更新语句一起使用时，连接的工作方式与在选择中使用时的方式相同。

例如，如果我们有这两个表：

```
mysql> SELECT * FROM orders;
+---------+------------+
| orderid | customerid |
+---------+------------+
|       1 |          1 |
|       2 |          2 |
|       3 |          3 |
|       4 |          1 |
+---------+------------+

mysql> SELECT * FROM customers;
+------------+------------+
| customerid | ordercount |
+------------+------------+
|          1 |          9 |
|          2 |          3 |
|          3 |          8 |
|          4 |          5 |
|          5 |          7 |
+------------+------------+ 
```

使用这个选择语句：

```
SELECT orders.customerid 
FROM orders 
JOIN customers ON (customers.customerid = orders.customerid) 
```

返回：

```
+------------+
| customerid |
+------------+
|          1 |
|          1 |
|          2 |
|          3 |
+------------+ 
```

所以，我期待下面的声明：

```
UPDATE orders 
JOIN customers ON (customers.customerid = orders.customerid) 
SET ordercount = ordercount + 1 
```

将客户 #1 (customerid = 1) 的 ordercount 更新为 11，但实际上并非如此，以下是更新后的结果：

```
mysql> SELECT * FROM customers;
+------------+------------+
| customerid | ordercount |
+------------+------------+
|          1 |         10 |
|          2 |          4 |
|          3 |          9 |
|          4 |          5 |
|          5 |          7 |
+------------+------------+ 
```

正如你所看到的，它只增加了一次，尽管它在 order 表中出现了两次，并且尽管 select 语句正确地返回了它。

这是 MySQL 中的错误还是我做错了什么？出于性能原因，我试图避免使用 group by，因此我有兴趣了解正在发生的事情。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T11:51:50.543

是的，`MySQL`连接表中的每条记录最多更新一次。

我在文档中找不到它，但实践是这样说的。

我可能会将其作为错误发布，因此他们至少将其添加到文档中：

```
CREATE TABLE updater (value INT NOT NULL);

INSERT
INTO    updater
VALUES  (1);

SELECT  *
FROM    updater;

value
---
1

UPDATE  updater u
JOIN    (
        SELECT  1 AS newval
        UNION ALL
        SELECT  2
        ) q
SET     u.value = u.value + newval;

SELECT  *
FROM    updater;

value
---
2

(expected 4). 
```

`SQL Server`顺便说一句，在多表中的行为相同`UPDATE`。

您可以使用：

```
UPDATE  orders o
SET     ordercount = ordercount +
        (
        SELECT  COUNT(*)
        FROM    customers c
        WHERE   c.customerid = o.customerid
        ) 
```

只要你有一个索引，这在性能上是相同的`customers (customer_id)`

# nhibernate - 如何在 NH Criteria API 中使用 year() 和 month() 函数？

> ID：793166
> 
> 赞同：8
> 
> 时间：2009-04-27T11:51:15.943
> 
> 标签：nhibernate, criteria

我需要在 Criteria API 中使用 year() 和 month() 函数来表达业务过滤器约束。像这样的表达

```
cri.Add(Expression.Ge("year(Duration.DateFrom)", Year.Value));
cri.Add(Expression.Le("year(Duration.DateTo)", Year.Value)); 
```

显然不起作用-有什么解决方案可以实现吗？

我知道这在 HQL 中是完全可能的，但我需要使用条件 API 构建查询，因为有一些额外的进程处理查询添加排序、分页等。

* * *

我想重写为 Criteria API 的示例 HQL 解决方案：

```
var ym = year * 100 + month;
var hql = ...(:ym between 100 * year(f.Duration.DateFrom) + month(f.Duration.DateFrom) and 100 * year(f.Duration.DateTo) + month(f.Duration.DateTo)"; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-28T10:26:35.450

可以使用 Projections.SQLFunction 来实现这一点。工作解决方案：

```
ISQLFunction sqlAdd = new VarArgsSQLFunction("(", "+", ")");
ISQLFunction sqlMultiply = new VarArgsSQLFunction("(", "*", ")");

var ym = Year.Value * 100 + Month.Value;
var dateFromMonthProj = Projections.SqlFunction("month", NHibernateUtil.Int32, Projections.Property("PurchaseDuration.DateFrom"));
var dateFromYearProj = Projections.SqlFunction("year", NHibernateUtil.Int32, Projections.Property("PurchaseDuration.DateFrom"));
var dateToMonthProj = Projections.SqlFunction("month", NHibernateUtil.Int32, Projections.Property("PurchaseDuration.DateTo"));
var dateToYearProj = Projections.SqlFunction("year", NHibernateUtil.Int32, Projections.Property("PurchaseDuration.DateTo"));
var calculatedYMFrom = Projections.SqlFunction(sqlAdd, NHibernateUtil.Int32, Projections.SqlFunction(sqlMultiply, NHibernateUtil.Int32, dateFromYearProj, Projections.Constant(100)), dateFromMonthProj);
var calculatedYMTo = Projections.SqlFunction(sqlAdd, NHibernateUtil.Int32, Projections.SqlFunction(sqlMultiply, NHibernateUtil.Int32, dateToYearProj, Projections.Constant(100)), dateToMonthProj);
cri.Add(Restrictions.Le(calculatedYMFrom, ym));
cri.Add(Restrictions.Ge(calculatedYMTo, ym)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T12:22:24.480

像这样的东西对你有用吗？

```
cri.Add(Expression.Ge("Duration.DateFrom", new Date(fromYear, 1, 1));
cri.Add(Expression.Le("Duration.DateTo", new Date(toYear, 12, 31)); 
```

请注意，我更改了您的表达顺序——我假设您打错了字，并且您想查询 DateFrom 和 DateTo 之间的日期。如果日期包含时间数据，则第二个表达式将更改为：

```
cri.Add(Expression.Lt("Duration.DateTo", new Date(toYear + 1, 1, 1)); 
```

回应评论：

```
cri.Add(Expression.Ge("Duration.DateFrom", new Date(fromYear, fromMonth, 1));
// Actual code needs to get last day of to month since it will not always be 31
cri.Add(Expression.Le("Duration.DateTo", new Date(toYear, toMonth, 31)); 
```

您的用户输入格式是否为“YYMM”？如果是这种情况，那么您只需从该字符串中解析出年份和月份即可创建 fromYear、fromMonth 等。

编辑：我的第三次也是最后一次尝试：

```
// First parse the input, e.g: september 2009 into 9 (inMonth) and 2009 (inYear)
var fromDate = new DateTime(inYear, inMonth, 1);
var toDate = fromDate.AddMonths(1).AddDays(-1);

cri.Add(Expression.Ge("Duration.DateFrom", fromDate));
cri.Add(Expression.Le("Duration.DateTo", toDate)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-10T05:44:41.327

我不确定我是否理解你的问题的意思，但我有一个类似的问题，我解决了这个问题：

```
crit.Add(Expression.Sql("(YEAR({alias}.ObsDatum) = ?)", year, NHibernateUtil.String))
crit.Add(Expression.Sql("(MONTH({alias}.ObsDatum) = ?)", manad, NHibernateUtil.Int32)) 
```

# c# - 调用非托管函数 char 返回 char *

> ID：793168
> 
> 赞同：3
> 
> 时间：2009-04-27T11:51:49.903
> 
> 标签：c#, .net, c, pinvoke, unmanaged

我在非托管 C/C++ 代码 (dll) 中有一个函数，它返回一个包含 char 数组的结构。我创建了 C# 结构来在调用函数时接收这个返回值。在调用这个函数时，我得到'System.Runtime.InteropServices.MarshalDirectiveException'

这是 C 声明：

```
typedef struct T_SAMPLE_STRUCT {
int num;
char text[20];
} SAMPLE_STRUCT;

SAMPLE_STRUCT sampleFunction( SAMPLE_STRUCT ss ); 
```

这是 C# 声明：

```
struct SAMPLE_STRUCT
{
    public int num;
    public string text;
}

class Dllwrapper
{
    [DllImport("samplecdll.dll")]
    public static extern SAMPLE_STRUCT sampleFunction(SAMPLE_STRUCT ss);

} 
```

我正在使用 1 字节的 ASCII。

有没有人有关于如何做到这一点的提示或解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T12:19:04.380

转换 C 数组成员的技巧是使用 MarshalAs(UnmanagedType.ByValTStr)。这可用于告诉 CLR 将数组编组为内联成员与普通的非内联数组。试试下面的签名。

```
[System.Runtime.InteropServices.StructLayoutAttribute(System.Runtime.InteropServices.LayoutKind.Sequential, CharSet=System.Runtime.InteropServices.CharSet.Ansi)]
public struct T_SAMPLE_STRUCT {

    /// int
    public int num;

    /// char[20]
    [System.Runtime.InteropServices.MarshalAsAttribute(System.Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst=20)]
    public string text;
}

public partial class NativeMethods {

    /// Return Type: SAMPLE_STRUCT->T_SAMPLE_STRUCT
    ///ss: SAMPLE_STRUCT->T_SAMPLE_STRUCT
    [System.Runtime.InteropServices.DllImportAttribute("<Unknown>", EntryPoint="sampleFunction")]
public static extern  T_SAMPLE_STRUCT sampleFunction(T_SAMPLE_STRUCT ss) ;

} 
```

此签名由 CodePlex 上提供的 PInovke 互操作助手（[链接](http://codeplex.com/clrinterop)）提供给您。它可以自动将大多数 PInvoke 签名从本机代码转换为 C# 或 VB.Net。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T13:08:04.813

C中的结构定义：

```
#pragma pack(push, 1)
typedef struct T_SAMPLE_STRUCT {
  int num;
  char text[20];
};
#pragma pack(pop) 
```

C# 中的定义：

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi, Pack = 1)]
public struct T_SAMPLE_STRUCT
{
  [MarshalAs(UnmanagedType.I4)]
  public int num;

  [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 20)]
  public string text;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T12:00:56.373

对于 P/Invoke 来编组来说，这不是一个简单的结构：编组包含 char* 而不是 char[] 的结构更容易（尽管您会遇到从非托管代码分配 char* 并随后将其释放的问题托管代码）。

假设您坚持当前的设计，一种选择是将字符串数组声明为：

```
public fixed char text[20]; 
```

不幸的是，您必须将`unsafe`关键字添加到访问此数组的任何代码中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T14:07:54.647

我设法通过将功能分开来做到这一点：

```
void receiveStruct( SAMPLE_STRUCT ss )
void returnStruct(SAMPLE_STRUCT &ss) 
```

正如 JaredPar 告诉我的那样，我已经更改了结构定义：

```
[StructLayoutAttribute(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
public struct T_SAMPLE_STRUCT
{
    /// int
    public int num;

    /// char[20]
    [MarshalAsAttribute(UnmanagedType.ByValTStr, SizeConst = 20)]
    public string text;
} 
```

现在它可以工作了。

谢谢！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T16:13:51.257

有趣的是，既然你已经有了答案，这里的基本问题是结构只需要正确的大小。由于托管类型没有内联数组，因此您只需要弥补它原本需要的空间。当您使用 C++/CLI 编写代码时，您经常会看到带有显式 Size 参数的 StructLayoutAttribute。这使得运行时为该类型分配正确数量的内存，这使得它可以在本机端使用 blittable。因此，这些也应该起作用：

```
[StructLayout(LayoutKind.Sequential, Size=24)]
public struct T_SAMPLE_STRUCT
{    
    public int num;
    // to get the string here, you'd need to get a pointer
    public char firstChar;     
}

// or

[StructLayout(LayoutKind.Sequential)]
public struct T_SAMPLE_STRUCT
{    
    public int num;
    public byte c0;
    public byte c1;
    public byte c2;
    public byte c3;
    public byte c4;
    public byte c5;
    public byte c6;
    public byte c7;
    public byte c8;
    public byte c9;
    public byte c10;
    public byte c11;
    public byte c12;
    public byte c13;
    public byte c14;
    public byte c15;
    public byte c16;
    public byte c17;
    public byte c18;
    public byte c19;
} 
```

当然，这些在托管代码中使用起来要困难得多（您需要复制内存或使用指针），但它们说明了 blittable 类型的概念，这主要是在本机代码和托管代码之间传递类型的方式。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-27T12:17:40.047

首先你必须把 StructLayout[Sequential] 属性放在你的结构上，我认为它会起作用

```
[ StructLayout( LayoutKind.Sequential, CharSet=CharSet.Ansi )]
struct SAMPLE_STRUCT
{    
    public int num;
    [ MarshalAs( UnmanagedType.ByValArray, SizeConst=20 )] 
    public char[] text;
} 
```

# asp.net - 如何为asp.net inproc缓存配置内存大小

> ID：793173
> 
> 赞同：2
> 
> 时间：2009-04-27T11:52:31.213
> 
> 标签：asp.net, iis, caching

我不希望 asp.net 决定何时应使缓存中的项目无效，而是应由业务逻辑触发缓存清理。

当缓存使用达到特定阈值时，Asp.net 会自动使缓存中的某些项目无效（框架中的内置优化）。

到目前为止，线程池的 IIS 上的虚拟内存设置已设置为默认值。这是我应该进行更改的地方吗，以便缓存过期的阈值会自动上升到更高的级别。

我们在缓存中大约有 500 多个对象，并且不希望缓存丢失这些数据。在缓存中添加项目时，我们已经使用*了 NoAbsoluteExpiration*和*NoSlidingExpiration*。

但是，当将项目添加到超过 450 个对象的缓存时，缓存中的项目数突然下降到 300 个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T12:02:05.590

[这](http://www.johnsadventures.com/archives/2006/02/why_does_my_aspnet_cache_keep_clearing_i/)可能对你有帮助。

```
<caching>
  <cache disableMemoryCollection = "true"
    disableExpiration = "false"
    privateBytesLimit = "0"
    percentagePhysicalMemoryUsedLimit = "90"
    privateBytesPollTime = "00:02:00"/>
</caching> 
```

# sql - 如何按顺序将两个具有相同行数的表连接在一起

> ID：793174
> 
> 赞同：8
> 
> 时间：2009-04-27T11:52:53.537
> 
> 标签：sql, sql-server, tsql, join, sql-server-2000

我正在使用 SQL2000，我想根据它们的位置将两个表连接在一起

例如，考虑以下 2 个表：

```
表格1
--------
姓名
--------
'猫'
'狗'
'鼠'

表2
------
成本
------
23
13
25

```

我现在想根据它们的顺序而不是匹配列将两个表盲目地连接在一起（我也可以保证两个表具有相同的行数）：

```
--------|-----
名称 |费用
--------|------
'猫' |23
'狗' |13
'鼠标'|25

```

这可能在 T-SQL 选择中吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T12:25:34.097

这是不可能的，因为绝对不能保证选择行的顺序**。**

*只要您对排序顺序很幸运，*有多种方法可以实现您想要的（请参阅其他答案），但如果您不是，则没有一种方法可以工作，并且您不应该依赖此类查询。

被迫进行这种查询强烈地感觉到糟糕的数据库设计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T11:55:50.223

在 2000 年，您要么必须运行 2 个仅向前游标并插入临时表。或将值插入带有额外标识列的临时表中，并在标识字段上加入 2 个临时表

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T12:03:33.793

你有什么可以保证每张桌子的顺序吗？

据我所知，除非外部查询具有 order by 子句，否则 SQL 服务器不会对结果集的排序做出任何承诺。在您的情况下，您需要以确定的方式对每个表进行排序才能使其正常工作。

除此之外，在我之前回答的 SQL 2000 中，一个临时表和两个游标似乎是一个不错的答案。

更新：有人提到将两个表都插入到临时表中，这样会产生更好的性能。我不是 SQL 专家，所以我听从那些在这方面了解的人的意见，而且由于我投了赞成票，我认为你应该调查这些性能考虑因素。但无论如何，如果您的表格中没有任何其他信息，而不是您向我们展示的信息，我不确定您是否可以按顺序完成。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T12:09:31.827

如果您的表不是两个大的，您可以在内存中创建两个临时表并按特定顺序将您的内容选择到其中，然后将它们加入行号。

例如

```
CREATE TABLE #Temp_One (
    [RowNum] [int] IDENTITY (1, 1) NOT NULL ,
    [Description] [nvarchar] (50) NOT NULL
)

CREATE TABLE #Temp_Two (
    [RowNum] [int] IDENTITY (1, 1) NOT NULL ,
    [Description] [nvarchar] (50) NOT NULL
)

INSERT INTO #Temp_One
SELECT Your_Column FROM Your_Table_One ORDER BY Whatever

INSERT INTO #Temp_Two
SELECT Your_Column FROM Your_Table_Two ORDER BY Whatever

SELECT * 
FROM #Temp_One a 
    LEFT OUTER JOIN #Temp_Two b 
         On a.RowNum = b.RowNum 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T12:09:56.680

您可以将两个表都更改为具有 auto_increment 列，然后加入该列。

正如其他人告诉你的那样，SQL 没有内在的顺序。行表是一个集合。*除非*您添加`order by`子句，否则您获得的任何顺序都是任意的。

所以，是的，有一些方法可以做到这一点，但所有这些方法都取决于你希望的意外排序。所以这样做一次，除非你能想出一种方法（auto_increments、自然键等）来确保排序，否则不要再这样做了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-29T04:53:25.233

绝对地。使用以下查询，但**确保 (order by) 子句使用相同的列**，行的顺序将改变，这是您不想要的。

```
select
(
row_number() over(order by name) rno, * from Table1
) A  
(
row_number() over(order by name) rno, * from Table2
) B
JOIN A.rno=B.rno 
```

order by 子句可以根据用户链接进行修改

上面的查询为每一行生成唯一的 row_numbers，并与另一个表的 row_numbers 连接

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T12:02:39.863

考虑使用排名（Oracle 中的 rownum）将有序的唯一数字动态应用于每个表。只需加入排名列，您就应该拥有所需的东西。请参阅有关编号行的这篇[Microsoft 文章](http://support.microsoft.com/default.aspx?scid=KB;EN-US;q186133)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-27T12:08:35.310

最好使用 row_number()，但这仅适用于 2005 年和 2008 年，这应该适用于 2000 年...

尝试这个：

```
create table table1 (name varchar(30))
insert into table1 (name) values ('cat')
insert into table1 (name) values ('dog')
insert into table1 (name) values ('mouse')

create table table2 (cost int)
insert into table2 (cost) values (23)
insert into table2 (cost) values (13)
insert into table2 (cost) values (25)

Select IDENTITY(int,1,1) AS RowNumber
, Name
INTO #Temp1
from table1

Select IDENTITY(int,1,1) AS RowNumber
, Cost
INTO #Temp2
from table2

select * from #Temp1
select * from #Temp2

SELECT
    t1.Name, t2.Cost
    FROM #Temp1                 t1
        LEFT OUTER JOIN #Temp2  t2 ON t1.RowNumber=t2.RowNumber
    ORDER BY t1.RowNumber 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-27T12:09:44.340

Xynth - 不幸的是，内置行编号直到 SQL2K5 才可用，微软给出的示例实际上使用了三角连接 - 如果表变大，这会导致可怕的隐藏性能损失。我首选的方法是使用标识函数插入一对临时表，然后加入这些表，这与已经给出的答案基本相同。我认为双光标方法听起来比这项任务需要的要重得多。

# c# - 防止匿名用户在没有 SqlMembershipProvider 的情况下在 ASP.NET 中多次提交表单

> ID：793175
> 
> 赞同：0
> 
> 时间：2009-04-27T11:53:20.290
> 
> 标签：c#, .net, asp.net, webforms, anonymous-access

我有一个简单的表单，可以将选定的答案转储到 XML 文件中。如何防止匿名用户多次提交此表单？

我不是在寻找完全防弹的解决方案，我有一个限制，我不能使用数据库，因此没有 SqlMembershipProvider。

一些cookie检查会起作用吗？如何正确地做到这一点？

先感谢您。

**更新：**更准确地说，我的意思不仅是意外提交了表单，而且是为了防止一周前访问该站点的用户再次提交此表单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T12:05:29.327

简而言之，你不能完全可靠。如果您不介意防弹的东西，就像您说的那样，您也可以

a) 将 cookie 保存到客户端计算机，并在下次有人发布时检查它。显然，用户可以删除 cookie，所以并不出色。b) 您可以存储提交的 IP 地址。这样做的问题是，您将阻止同一 IP 后面的多个用户提交即代理，并且同一用户可以从不同位置发布。

两者都不是特别好，如果可能的话，我建议让他们在开始时输入一个电子邮件地址，将帖子存储为未确认，通过电子邮件发送一个确认链接，并且只有在他们点击它时才将帖子设为官方。同样，不是防弹，因为它不会阻止人们使用多个电子邮件帐户发帖，但它比上面的选项要好一点。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T11:54:27.433

使用会话变量来跟踪您的用户正在做什么。

# cocoa - 在 NSURL 对象中格式化 URL 参数

> ID：793185
> 
> 赞同：1
> 
> 时间：2009-04-27T11:58:05.083
> 
> 标签：cocoa, nsurl

我想在 NSURL 中传递参数。例如，我有

```
NSURL *url = [NSURL URLWithString:@"http://demo.digi-corp.com:82/Nilesh/betBuddy/api/getEventsXML.php?sp_ID=2"]; 
```

`sp_ID`1、2、3、4 等在哪里。我该怎么做？请帮帮我。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-27T12:03:07.537

您可以使用方法 [NSString stringWithFormat:@""] 来格式化您的 URL 字符串。例如，

```
NSURL *URL = [NSURL URLWithString:[NSString stringWithFormat:@"http://e.com/?var=%d", 2]]; 
```

如果您在文档中查找字符串格式说明符，您可以准确地找出每种替换类型（整数、双精度、对象等）要使用的字符。

# wordpress - 通过电子邮件更新 Wordpress

> ID：793189
> 
> 赞同：0
> 
> 时间：2009-04-27T11:58:42.523
> 
> 标签：wordpress, blogs

我有一个博客，经常更新。我喜欢，在旅途中能够使用我的黑莓或任何 eepc 来准备我的帖子、查看它、发送和电子邮件到能够更新我的博客的地方

我想到了三个解决方案

1.  离线博客，返回时编辑和重新同步（不是超级好）
2.  发送电子邮件，用黑莓更新博客
3.  编写文本文档，通过电子邮件发送并在返回后手动复制粘贴到新帖子中

我不喜欢列出所有可能的解决方案，而是您使用/尝试和喜欢的最佳工作解决方案......

我使用 wp 2.6

谢谢

--

**请注意**就像 boj note 一样，我发现 wordpress 中已经包含了该功能...但我希望我的帖子处于**草稿**状态，因为将完成一些照片和稍后的编辑，但大部分帖子已经存在

我找到了那个清单。正如[博客客户端](http://codex.wordpress.org/Weblog_Client)所说，有很多软件可以做到这一点，我喜欢最好的！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T12:00:35.220

[使用电子邮件发布到您的博客](http://codex.wordpress.org/Blog_by_Email)。

> WordPress 可以配置为使用电子邮件发布到博客。要启用此功能，您需要：
> 
> *   创建一个专用的电子邮件帐户，仅用于发布到您的博客，
>     
>     
> *   配置 WordPress 以访问该帐户，以及
>     
>     
> *   配置 WordPress 以从电子邮件帐户发布消息

# mysql - MySQL数据库复制

> ID：793196
> 
> 赞同：4
> 
> 时间：2009-04-27T12:00:54.157
> 
> 标签：mysql, database, copy, replication

这是场景：

1.  我有一个带有数据库的 MySQL 服务器，我们称它为**soliddb**。这个数据库是来自不同数据库的几个表的合并
2.  我有另一个 MySQL 服务器，带有原始数据库，这些数据库是生产数据库，并且每天都在更新。
3.  该公司希望将生产数据库中每个表上的每个更新/插入/删除复制到**统一**数据库中的相应表中。

复制能做到这一点吗？我知道复制是在数据库到数据库上完成的，而不是在属于不同数据库的表上复制到一个目标数据库。

我希望我的解释很清楚。谢谢。

**编辑：**将每个数据库中所有表的递归副本复制到单个从站工作吗？或者它是一个丑陋的解决方案？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-30T19:54:54.787

为了澄清一些事情，让我们根据当前的 mysql 实践来命名。数据库是数据库服务器。模式是一个数据库实例。一个数据库服务器可以有多个模式。表存在于模式中。

如果您想复制在主/生产服务器上*定义的模式或表，复制将帮助您。*复制通过将在主服务器上运行的所有 sql 语句的二进制日志传送到从服务器，从服务器忠实地运行它们，就好像它们在自身上按顺序运行一样。

您可以选择复制所有数据，或者您可以选择一些模式甚至只是一些表。

您不能从不同的模式中选择表并将它们复制到一个模式中，一张表属于特定的模式。

顺便说一句，重要通知。复制服务器*不能*成为多个主服务器的从服务器。您可以使用联合表来模拟这一点，但这永远不会将数据复制到整合服务器，只是将它们显示为好像来自不同服务器的数据在一台服务器上一样。

复制的好处是您的整合服务器将或多或少一直更新数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-06T17:07:25.233

您可以从每个主服务器获取二进制日志，对其进行解析`mysqlbinlog`，然后将其运行到整合的机器中。

非常近似的东西：

```
mysqlbinlog [binary log files] | mysql -h consolidated 
```

你需要某种简单的应用程序（我怀疑如果你需要它可以在 bash 中完成）来包装逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T12:21:23.937

查看将[不同的数据库复制到不同的从站](http://dev.mysql.com/doc/refman/5.0/en/replication-solutions-partitioning.html)，看看它是否对您有任何帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T05:23:41.343

您也许可以使用[MySQL Proxy来完成它](http://forge.mysql.com/wiki/MySQL_Proxy)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T13:23:50.500

据我所知，您可以设置复制（MySQL 4+）并在 my.cnf 文件中让从属服务器仅处理某些表或让主服务器仅记录某些表，无论哪种方式都可以解决您的问题。

以下是一些技术的指南：

[http://www.onlamp.com/pub/a/onlamp/2006/04/20/advanced-mysql-replication.html](http://www.onlamp.com/pub/a/onlamp/2006/04/20/advanced-mysql-replication.html)

我的复制设置问题很少，我所有的问题都来自尝试同步数据库，尤其是在重新启动等之后。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T14:15:48.420

您可能想查看[maatkit](http://www.maatkit.org/)工具包。它是免费下载的，并且有许多专门用于优化存档表等工具的工具。我在过去的项目中使用它来将某些数据复制到另一个数据库等。你可以根据时间或任何其他数量的因素来做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T12:44:28.890

MySQL 基于语句的复制（基本复制）通过在从属服务器上运行在主服务器上运行的完全相同的语句来工作。这包括有关该表所在的数据库的信息。

我不认为 MySQL 提供任何内置方式来在数据库之间移动复制语句（即“插入 db1.table1 ...”->“插入 db2.table1”）。您可以通过即时手动更改复制日志来欺骗它，但它不会是现成的 MySQL 复制。

# asp.net - 在 asp.net 中回发后保留锚点

> ID：793208
> 
> 赞同：1
> 
> 时间：2009-04-27T12:04:19.173
> 
> 标签：asp.net, javascript

我在我的一个页面上使用了一个像 consctuct 这样的[coda 滑块。](http://jqueryfordesigners.com/coda-slider-effect/)自然，锚点（“#currentTab”）信息在回发后会丢失。这很烦人，因为当您按下某个选项卡上的按钮时，您总是会在回发后的第一个选项卡上结束。

让这些信息在回发后存活的最佳方式是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-03-16T14:54:21.757

试试这是你的`page_load`活动

```
Me.Form.Attributes("onsubmit") = "this.action+=top.location.hash;" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T12:25:43.317

我不在 ASP 中做，但作为一般解决方案尝试，这也可能对您有用：

1.  在您发送的表单中创建一个隐藏字段
2.  在选项卡更改时，填写此选定选项卡的值（如果没有用于标识选项卡的值，请创建它们）
3.  在提交后渲染页面时，动态创建一段 javascript，用于切换 DOM:ready 上的选项卡。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-27T12:24:23.523

要么将你的回发作为 AJAX 请求执行，要么在表单中添加一些 javascript，将锚值发送到服务器

粗略的例子

```
<form onsubmit="this.anchor.value=top.location.hash">
    <input name="anchor" type="hidden" value="">
    <!-- rest of form -->
</form> 
```

然后，您需要一个约定将其返回给客户端并执行适当的操作。

# ide - 为什么 PHPEd 中的代码洞察力不能与 Zend 框架一起使用？

> ID：793209
> 
> 赞同：0
> 
> 时间：2009-04-27T12:05:18.077
> 
> 标签：ide, code-completion, phped

我目前正在使用[Zend 框架](http://en.wikipedia.org/wiki/Zend_Framework)，并且我使用[PHPEd](http://en.wikipedia.org/wiki/PHPEd)作为我最喜欢的 PHP 编辑器。我已经看到 IDE 可以跟踪我自己的函数和库，并在代码洞察力中显示它们。如何将 Zend Framework 的库添加到代码洞察中？

它们是通过 Zend 框架的内部自动加载函数加载的，因此 PHPEd 无法找到包含它们的点，并且不会在函数列表中显示它们。是否有可能告诉 PHPEd 始终在代码洞察中显示 Zend 框架函数和类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-06T13:05:10.027

好的，第三次重新安装 NuSphere 后，它终于可以工作了。我不知道为什么...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T06:43:47.153

当我从一开始就尝试 ZF 代码时，它在[PhpED中运行良好。](http://www.nusphere.com/products/phped.htm)要让任何 3rd 方代码出现在 Code Insight 中，您需要将相应的目录包含到附加目录的项目列表中，或者只需将包含代码的目录作为项目子目录放置。然后打开[代码资源管理器](http://www.nusphere.com/products/php_code_explorer_tab.htm)并检查框架类。如果它们没有出现（出于任何原因）超过 5-6 秒，只需在弹出窗口中按刷新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-24T02:42:16.843

他们（NuSphere）刚刚发布了完全支持 ZF 等的 PhpED V11.0 - [http://www.nusphere.com/products/php_frameworks.htm](http://www.nusphere.com/products/php_frameworks.htm)

# c# - 命名空间的 XML 文档

> ID：793210
> 
> 赞同：57
> 
> 时间：2009-04-27T12:05:22.837
> 
> 标签：c#, namespaces, xml-documentation

你会为命名空间编写 xml-doc 吗？如果是，如何以及在哪里？

我想，如果可能的话，可能是一个几乎是空的文件，如下所示：

```
/// <summary>
/// This namespace contains stuff
/// </summary>
namespace Some.Namespace
{

} 
```

但这会奏效吗？既然你......“声明”，或者至少在所有其他文件中使用命名空间......如果你在同一个命名空间的其他地方写了一个 xml 文档会发生什么？一个会消失吗？或者它们会以某种方式合并？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-27T12:13:58.963

NDoc 通过识别`NamespaceDoc`位于每个命名空间中的特殊类并使用其中的文档来支持这一点。我没有尝试过，但 Sandcastle 似乎支持同样的技巧。

**编辑：** 例如：

```
namespace Some.Namespace
{
    /// <summary>
    /// This namespace contains stuff
    /// </summary>
    public static class NamespaceDoc
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-27T12:27:53.280

Sandcastle 不直接支持 NamespaceDoc，但如果您使用[Sandcastle Help File Builder](http://www.codeplex.com/SHFB)，您可以使用 Tim 提到的 NamespaceDoc 类。

```
namespace Example
{
    /// <summary>
    ///   <para>
    ///     Summary
    ///   </para>
    /// </summary>
    /// <include file='_Namespace.xml' path='Documentation/*' />
    internal class NamespaceDoc
    {
    }
} 
```

SCHB 还略微扩展了语法，并允许直接从代码文件嵌入代码示例。_Namespace.xml 示例：

```
<?xml version="1.0" encoding="utf-8" ?>
<Documentation>
  <summary>
    <h1 class="heading">Example Namespace</h1>
    <para>
      This namespace is used in the following way:
    </para>

    <code source="Examples\Class.cs" lang="cs"></code>
    <code source="Examples\Class.vb" lang="vbnet"></code>

    <para>
      Hopefully this helps!
    </para>
  </summary>
</Documentation> 
```

在 XML 文件中包含文档允许您在代码中编写简短摘要，并在帮助文件的单独 XML 文件中编写更大的描述。这样，代码就不会被所有细节弄得杂乱无章，并且易于阅读。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-09-12T16:19:37.547

Sandcastle 帮助文件生成器支持命名空间的注释。打开您的 Sandcastle 项目。在`Project Properties`窗口中导航到`Summaries`并单击`Edit Namespace Summaries`按钮。

![在此处输入图像描述](https://i.stack.imgur.com/KKo0z.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-09-18T07:58:30.640

如果您使用 Sandcastle 及其“帮助文件生成器”，您可以在项目中使用以下代码记录命名空间和命名空间组：

```
namespace Company.Product.Widgets
{
    /// <summary>
    /// These are the namespace comments for <c>Company.Product.Widgets</c>.
    /// </summary>
    [System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    class NamespaceDoc
    {
    }
} 
```

如果项目启用了命名空间分组，您还可以使用 NamespaceGroupDoc 类以类似的方式维护命名空间组注释。下面是一个例子：

```
namespace Company.Product
{
    /// <summary>
    /// These are the group comments for namespaces in <c>Company.Product</c>.
    /// </summary>
    [System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    class NamespaceGroupDoc
    {
    }
} 
```

要防止 NamespaceDoc 类出现在帮助文件中，请去掉 public 关键字并用 CompilerGenerated 属性对其进行标记。

参考见这里：[https ://ewsoftware.github.io/SHFB/html/48f5a893-acde-4e50-8c17-72b83d9c3f9d.htm](https://ewsoftware.github.io/SHFB/html/48f5a893-acde-4e50-8c17-72b83d9c3f9d.htm)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-29T22:10:37.357

您可以使用以下方法在 doxygen 中执行此操作：

```
/// <summary>
/// description
/// </summary>
namespace name{}; 
```

此外，最好在 NameSpaces.cs 文件中声明命名空间，并仅在此文件中注释它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T12:10:01.640

不能在命名空间上添加注释。

[http://ndoc.sourceforge.net/content/documenters.htm 上的 UseNamespaceDocSummaries](http://ndoc.sourceforge.net/content/documenters.htm)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-22T02:32:16.420

如果使用[Mono](http://www.mono-project.com)的[mdoc](http://www.mono-project.com/Mdoc)文档系统，您可以通过编辑 ns-*.xml 文档文件来记录命名空间成员。

有关更多详细信息，请参阅[mdoc 文件格式文档](http://www.go-mono.com/docs/index.aspx?link=man:mdoc(5))。

# java - 从类路径资源（XML 文件）获取输入流

> ID：793213
> 
> 赞同：88
> 
> 时间：2009-04-27T12:06:57.467
> 
> 标签：java, file-io, inputstream

在 Java Web 应用程序中，假设我想获取一个 XML 文件的 InputStream，该文件位于 CLASSPATH 中（即在*源*文件夹中），我该怎么做？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-04-27T12:08:38.820

[`ClassLoader.getResourceAsStream()`](http://download.oracle.com/javase/6/docs/api/java/lang/ClassLoader.html#getResourceAsStream(java.lang.String)).

如下面评论中所述，如果您处于多`ClassLoader`环境（例如单元测试、webapps 等）中，您可能需要使用`Thread.currentThread().getContextClassLoader()`. 请参阅[http://stackoverflow.com/questions/2308188/getresourceasstream-vs-fileinputstream/2308388#comment21307593_2308388](http://stackoverflow.com/questions/2308188/getresourceasstream-vs-fileinputstream/2308388#comment21307593_2308388)。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2010-11-04T03:48:33.227

```
ClassLoader.class.getResourceAsStream("/path/file.ext"); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-27T12:26:29.587

这取决于 XML 文件的确切位置。它是在源文件夹中（在“默认包”或“根”中）还是在与类相同的文件夹中？

在前一种情况下，您必须使用“ `/file.xml`”（注意前导斜杠）来查找文件，并且您使用哪个类来尝试定位它并不重要。

如果 XML 文件位于某个类旁边，那么`SomeClass.class.getResourceAsStream()`只需使用文件名即可。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-27T13:43:56.827

`ClassLoader.class.getResourceAsStream("/path/to/your/xml")`并确保您的编译脚本将 xml 文件复制到 CLASSPATH 中的位置。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-27T12:09:07.633

someClassWithinYourSourceDir.getClass().getResourceAsStream();

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-08-06T15:46:57.900

此答案中的某些“getResourceAsStream()”选项对我不起作用，但这个选项可以：

SomeClassWithinYourSourceDir.class.getClassLoader().getResourceAsStream("yourResource");

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-01-29T19:18:40.537

我尝试了建议的解决方案，文件名中的正斜杠对我不起作用，例如： ...().getResourceAsStream("/my.properties"); 返回了 null

删除斜线有效： ....getResourceAsStream("my.properties");

以下是来自 doc API：在委托之前，使用此算法从给定的资源名称构造一个绝对资源名称：

```
If the name begins with a '/' ('\u002f'), then the absolute name of the resource is the portion of the name following the '/'.
Otherwise, the absolute name is of the following form:

    modified_package_name/name 

Where the modified_package_name is the package name of this object with '/' substituted for '.' ('\u002e'). 
```

# iphone - 使用属性时如何对父对象进行弱引用？

> ID：793224
> 
> 赞同：1
> 
> 时间：2009-04-27T12:12:35.127
> 
> 标签：iphone, objective-c, cocoa-touch

我不确定。我会这样做吗？

```
@property(nonatomic) MyParentObject *parentObject; 
```

请注意，我只是省略了保留关键字。还是我必须自己编写 Setter？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T12:16:04.153

代替`retain`，您可以使用该`assign`属性（这实际上是默认值）。`assign`将阻止您生成的 setter 保留或释放`parentObject`. 例如：

```
@property (assign, nonatomic) MyParentObject *parentObject; 
```

有关 Objective-C 属性可以使用的所有属性的列表，请查看[文档](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/ObjectiveC/Articles/ocProperties.html#//apple_ref/doc/uid/TP30001163-CH17-SW2)。

# elf - 修改elf文件

> ID：793227
> 
> 赞同：6
> 
> 时间：2009-04-27T12:15:21.690
> 
> 标签：elf

我想在 elf 文件中添加一个新标志。然后，该标志应该在进程描述符中可供内核使用。我的第一个想法是使用 libelf，但不幸的是，它在 Ubuntu 上似乎存在错误。Elfedit 可能是一个不错的工具，但我还没有找到适用于 Linux 的版本，尤其是 Ubuntu。

所以，我想知道是否有人可以向我建议是否有任何其他有用的工具可以将自定义标志添加到 elf 文件？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T12:24:41.590

能够修改内核以利用新标志的人可能不会询问如何将标志添加到 ELF 库中。

那么，您打算如何让内核使用这个新标志呢？国旗的目的是什么？

由于您要添加到标准 libelf，您不能修复 Ubuntu 的错误并让他们知道您已经这样做了（让他们可以使用修复 - 尽管他们可能需要将其转发到链上） .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-10T00:21:08.310

请查看[ELFIO 库](http://sourceforge.net/projects/elfio/)。它包含 WriteObj 和 Writer 示例。通过使用该库，您将能够创建和/或修改 ELF 二进制文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-27T17:01:11.390

（虽然是老问题，但作为参考，我根据自己的经验写答案）

我建议在内存结构中读取 elf 文件，更改标志并使用您的内存结构加载进程内存。与错误纠正相比，这种方法需要更少的努力。首先，检查文件 elf.c 中的 elf、程序头、节头结构。你可以在你的结构中读取文件头，它应该有三个结构成员，分别是 elf、program、section。从 elf 标头开始读取您的结构。然后在 elf 标头中给出的偏移量上读取程序标头（迭代地用于所有程序标头）。以同样的方式，您可以通过章节标题阅读所有章节。在您自己的结构中封装 3 个标头结构也使您有机会在其他结构成员中拥有额外需要的数据。

# c# - C# 代码分析不喜欢受保护的静态 s_Foo (CA1709, CA1707)

> ID：793231
> 
> 赞同：5
> 
> 时间：2009-04-27T12:16:40.577
> 
> 标签：c#, visual-studio-2008, naming-conventions, code-analysis, fxcop

我通常在字段`m_`前面添加一个，在成员之前添加一个。`private``s_``static`

使用类似的代码

```
protected static readonly Random s_Random = new Random (); 
```

我通过 VS2008 的代码分析得到以下警告：

*   `CA1709`：Microsoft.Naming：通过将成员名称“Bar.s_Random”中的“s”更改为“S”来更正其大小写。
*   `CA1707`：Microsoft.Naming：从成员名称“Bar.s_Random”中删除下划线。

如何解决这个问题？我应该简单地删除`s_`吗？或者为此警告添加全局抑制？

**编辑：**我的公司缺乏编码标准，所以由我来为我的代码定义它们。（是的，我知道了...）

如果您认为`s_`总体上应该被删除，如果您能提供官方来源，我会很高兴。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-27T12:17:59.437

您没有遵循 Microsoft 的 .NET 命名约定，该约定告诉您不要为任何内容添加前缀。如果这确实是您想要的，请添加抑制。否则，请按照指南删除`s_`和其他类似的前缀。

来自[类型成员的](http://msdn.microsoft.com/en-us/library/ms229012.aspx)名称：
“字段名称”部分：“不要为字段名称使用前缀。例如，不要使用 g_ 或 s_ 来区分静态字段和非静态字段。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-12-02T16:13:49.350

1.  卸载项目
2.  右键单击卸载的项目 => 编辑 csproj
3.  使 RunCodeAnalysis 为 false
4.  保存并重新加载项目

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T12:19:55.517

取决于你想要什么。

如果您的公司政策是在静态成员前面加上 s_，那么您应该禁止警告，甚至添加您自己的规则。

否则，将其修复为 Microsoft 的标准并致电您的会员`Random`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T12:20:39.210

m_ 是一个旧的命名标准。较新的约定不遵循这种匈牙利符号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T12:20:52.877

如何解决它取决于您。忽略它，并保持自己的命名约定，或遵循 Microsoft 标准。就我个人而言，我没有为我的变量使用任何前缀（所以在这种情况下将是“随机”而不是“s_Random”）所以我会选择后者，但如果你真的对此感到满意，那么没有人强迫你改变。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T12:27:04.657

*   CA1709 : protected 不是私有的，需要大写
*   CA1707：下划线不符合 ms 命名约定

# java - 我应该如何解决 java.lang.IllegalArgumentException: protocol = https host = null 异常？

> ID：793232
> 
> 赞同：7
> 
> 时间：2009-04-27T12:17:27.800
> 
> 标签：java, exception, ssl, stream

我正在开发一个 SSL 客户端服务器程序，我必须重用以下方法。

```
private boolean postMessage(String message){
    try{ 
         String serverURLS = getRecipientURL(message);

         serverURLS = "https:\\\\abc.my.domain.com:55555\\update";

         if (serverURLS != null){
             serverURL = new URL(serverURLS);
         }

        HttpsURLConnection conn = (HttpsURLConnection)serverURL.openConnection();

        conn.setHostnameVerifier(new HostnameVerifier() { 
        public boolean verify(String arg0, SSLSession arg1) {
            return true;
        } 
        });

        conn.setDoOutput(true);

        OutputStream os = conn.getOutputStream();

        OutputStreamWriter wr = new OutputStreamWriter(os);

        wr.write(message);

        wr.flush();

        if (conn.getResponseCode() != HttpsURLConnection.HTTP_OK)
            return false;
        else
            return true;

    } 
```

这里 ServerURL 被初始化为

```
private URL serverURL = null; 
```

当我尝试执行此方法时，我在 Line 遇到异常，

> 输出流 os = conn.getOutputStream();

例外是

```
java.lang.IllegalArgumentException: protocol = https host = null 
```

这是什么原因？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-27T12:23:03.183

URL 使用正斜杠 (/)，而不是反斜杠（如窗口）。尝试：

```
serverURLS = "https://abc.my.domain.com:55555/update"; 
```

您收到错误的原因是 URL 类无法解析字符串的主机部分，因此`host`是`null`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T12:59:51.880

这段代码似乎完全没有必要：

```
String serverURLS = getRecipientURL(message);

serverURLS = "https:\\\\abc.my.domain.com:55555\\update";

if (serverURLS != null){
    serverURL = new URL(serverURLS);
} 
```

1.  `serverURLS`被分配的结果`getRecipientURL(message)`
2.  然后立即覆盖 的值`serverURLS`，使前面的语句成为[死存储](http://en.wikipedia.org/wiki/Dead_store)
3.  然后，因为`if (serverURLS != null)`计算结果为`true`，因为您**刚刚**在前面的语句中为变量分配了一个值，所以您为 分配了一个值`serverURL`。无法`if (serverURLS != null)`评价到`false`！
4.  `serverURLS`除了上一行代码之外，您永远不会真正使用该变量。

您可以将所有这些替换为：

```
serverURL = new URL("https:\\\\abc.my.domain.com:55555\\update"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-27T08:21:42.260

可能会对其他人有所帮助 - 我来到这里是因为我错过了在 http: 之后放置两个 //。这就是我所拥有的：

> http://abc.my.domain.com:55555/update

# python - 检索 geodjango 多面体对象的边界框

> ID：793240
> 
> 赞同：7
> 
> 时间：2009-04-27T12:19:59.773
> 
> 标签：python, django, gis, geodjango

如何在 geodjango 中获取 MultiPolygon 对象的边界框？[在 API http://geodjango.org/docs/geos.html](http://geodjango.org/docs/geos.html)中找不到任何东西...

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-27T16:32:44.957

使用该[`extent`](https://docs.djangoproject.com/en/dev/ref/contrib/gis/geoquerysets/#extent)物业。

它返回一个 4 元组，分别包含左下角和右上角坐标。

[`envelope`](https://docs.djangoproject.com/en/dev/ref/contrib/gis/functions/#django.contrib.gis.db.models.functions.Envelope)如果您想要`Polygon`边界框的对象表示，也可以使用该属性。

# mysql - mysql在联合查询中解释

> ID：793251
> 
> 赞同：2
> 
> 时间：2009-04-27T12:23:11.373
> 
> 标签：mysql, union, sql-execution-plan

对查询执行 EXPLAIN 后：

```
explain 
select name from t1 where name like '%smthing%'
UNION ALL
select name from t2 where name like '%smthing%'
UNION ALL
select name from t3 where name like '%smthing%'
UNION ALL
select name from t4 where name like '%smthing%' 
```

由 4 个表的 UNION 组成，我得到这个：

```
 id  select_type   table         type    possible_keys  key     key_len  ref         rows  Extra                   
 1  PRIMARY       t1             index   (NULL)         name    152      (NULL)      337  Using where; Using index
 2  UNION         t2             index   (NULL)         name    152      (NULL)    3842  Using where; Using index
 3  UNION         t3             index   (NULL)         name    452      (NULL)     204  Using where; Using index
 4  UNION         t4             index   (NULL)         name    452      (NULL)    8269  Using where; Using index
(NULL)  UNION RESULT  <union1,2,3,4>  ALL     (NULL)         (NULL)  (NULL)   (NULL)  (NULL) 
```

当解释联合的每个组件时，类型是“INDEX”但是联合结果的类型是“ALL”。这种行为的原因是什么？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T12:49:01.577

尝试使用 UNION ALL 而不是 UNION - 否则 MySQL 将尝试删除任何重复的行（大概减去表的索引，因为它正在查看结果集）。

此外，您是否对 UNION 的结果有 ORDER BY 或 WHERE 子句？同样，这将在结果集上执行，而不是在表级别。

# firefox - FireFox中隐藏的div问题中的XBAP iFrame

> ID：793253
> 
> 赞同：1
> 
> 时间：2009-04-27T12:23:18.470
> 
> 标签：firefox, html, xbap

我有一个 IFRAME 中的 XBAP，包装在一个 DIV 中，可以根据用户的意愿隐藏和显示。但是，在 FireFox 中，隐藏 DIV 并稍后重新显示它后，XBAP 消失了。

我尝试了各种我能找到的刷新方法，但似乎没有任何效果。我不想重新加载 XBAP，因为它显示了当时特别可用的信息。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-12T14:24:30.157

onstatechange 导致了这个问题。围绕此编写一个 JavaScript 方法来检测浏览器类型解决了这个问题。

# .net - ASP.NET MVC 值得研究吗？

> ID：793256
> 
> 赞同：2
> 
> 时间：2009-04-27T12:24:24.537
> 
> 标签：.net, asp.net, asp.net-mvc

现在[ASP.NET MVC](http://asp.net/mvc/)已经正式发布，我应该为我的团队研究它吗？

我们是一个很小的团队（6 个开发人员），主要为管理团队开发内部应用程序。

任何和所有的建议都值得赞赏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T12:26:22.550

绝对值得研究，大多数事情都是。创建一些测试应用程序来感受一下，看看它是否适合您的团队和您所从事的项目类型。

请记住，没有灵丹妙药，并非所有工具都适用于所有项目。MVC（一般来说，不仅特定于 Microsoft 的 ASP.NET 实现）是开发某些类型应用程序的好方法，但在错误的情况下使用它可能会很痛苦（例如，使用表单输入具有大量字段的数据的站点） ）。就像所有事情一样，请记住 ASP.NET MVC 只是您工作室中的另一个工具。

作为最后一点，我强烈建议您让整个团队参与 ASP.NET MVC 的评估，因为您希望确保每个人都喜欢并乐于使用新平台。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T12:52:14.893

我喜欢设计模式。我喜欢在我的应用程序中使用这些模式。我喜欢自动化测试。

MVC 允许更轻松地对应用程序的逻辑层进行自动化测试。我喜欢看 Hanselman 关于在 MVC 应用程序上使用 Rhino Mocks 和 MSTest 的视频，只是为了看看它的实际效果。我的开发环境是大型公司内部的企业级应用程序。我们有一个审计能力的构建过程。为了能够开始构建，允许它运行我的单元测试，如果一个或多个测试失败则停止是非常宝贵的。这使我可以确保对应用程序的任何更改都不会在我的应用程序中引入另一个需要帮助的错误，无论是崩溃错误还是逻辑错误。

测试本身就是无价的，WebForms 必须是最难真正全面测试的。我认为 MVC 框架的真正价值在于能够分离职责并能够运行测试，而无需实例化所有需要的东西来加载网页。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T13:00:16.620

Rob Conery 有一篇关于学习 MVC 的好处的[非常好的文章。](http://blog.wekeroad.com/blog/i-spose-ill-just-say-it-you-should-learn-mvc/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T13:24:00.167

查看[ScottGu 的教程](http://weblogs.asp.net/scottgu/archive/2009/03/10/free-asp-net-mvc-ebook-tutorial.aspx)并自行决定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T12:28:41.563

我们的团队与您的团队规模大致相同，我们正在考虑使用 MVC。就我们而言，问题是在 MVC 中开发新的内部应用程序以及是否更新现有应用程序需要额外的时间。

对我们来说，问题是找到一个截止日期不太紧的申请，我认为我们已经同意试一试。

至于现有的应用程序-如果您可以说服您的付款人让您更新，那么我会说去做-我认为我们做不到，这就是为什么我们必须等待一个可以延长时间范围的项目和受益于 Web 表单所列出的优势。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T12:31:19.950

恕我直言，值得一看。

这绝对是大多数 .Net 开发人员不习惯的新方法，但有时使用我们不习惯的东西可以使我们成为更好的开发人员。

Java 社区对许多采用不同方法的 Web 框架存在问题，但我认为这对社区有所帮助。如今，Java 开发人员有许多不同的成熟的 Web 开发选项（包括通过 JRuby 的 Rails）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T13:16:30.030

是的，绝对值得一看，但前提是您想使用 ASP.NET 并且不喜欢（泄漏的）Web 表单抽象。MVC 导致更好的职责分离，如果你喜欢 TDD，它会非常出色。如果您习惯于 RAD 环境，它可能不是您想要的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-27T17:12:53.347

如果您使用 WebForms 做任何事情并认为“如果我可以轻松拥有干净的 URL，那不是很好”，那么是的，是的。

我在一家营销机构工作，使用 MVC（而不是带有 URL 重写模块的 WebForms）制作我的第一个网站已经完成了一半，它更容易、更好、更好，而且正是我想要的！

# c# - 计算上午 9:00 至下午 6:00 之间的时间

> ID：793262
> 
> 赞同：1
> 
> 时间：2009-04-27T12:25:43.583
> 
> 标签：c#

我有一个 8:00 AM 的字符串。假设我想检查上午 8:00 的时间是否早于上午 9:00 - 下午 6:00。
如何检查这一点，或者时间 11:00 AM 是否介于上午 9:00 到下午 6:00 之间？如何在c#中找到它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T12:31:05.037

您可以使用 DateTime 对象、其静态解析方法和比较运算符。类似于以下内容：

```
newTime = DateTime.Parse("8:00 AM");
fixedTime = DateTime.Parse("11:00 AM");
if (newTime < fixedTime)
{
// do something
} 
```

如果需要，您可以从另一个中减去一个 DateTime 以获得 TimeSpan - 这是一个持续时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T12:40:12.737

```
String s = "8:00 AM";
DateTime dt = DateTime.Parse(s);

if (dt < DateTime.Parse("9:00 AM"))
{
    Console.WriteLine("Before");
}
else if (dt <= DateTime.Parse("6:00 PM"))
{
    Console.WriteLine("Between");
}
else
{
    Console.WriteLine("After");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T12:28:37.633

一般的方法是将时间转换为可以用来比较的数字。

所以上午 8:00 就是 8，下午 6:00 就是 18，因此 18 > 8 等等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T12:30:25.693

函数 DateTime.Parse() 可用于将字符串转换为“DateTime”对象。

你有你的开始时间：上午 9:00。

您有结束时间：下午 6:00。

因此，您在两者之间有距离：

下午 6:00 - 上午 9:00。

这会给你一个 TimeSpan 对象。

然后你把你的“神秘时间”，做：

X:XX - 上午 9:00。

如果生成的时间跨度 > 0 并且生成的时间跨度 < 6:00PM-9:00AM tiemspan，那么你很好。

或者，你可以简单地做

如果（我的时间 > 上午 9:00 && 我的时间 < 下午 6:00）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T12:30:37.033

```
DateTime beginDate = DateTime.Today.AddHours(9);
DateTime endDate = DateTime.Today.AddHours(18);

TimeSpan diff = endDate - beginDate; 
```

现在`diff`包含开始日期和结束日期之间的差异。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T12:34:52.967

关于什么

```
int _dateTimeCompare = DateTime.Compare(DateTime1, DateTime2); 
```

然后 _dateTimeCompare < 1 = DateTime 1 小于 DateTime2，0 = 它们相同，> 0 = DateTime2 > DateTime1

因此，您可以进行比较。

_date1 和 _date2 之间的简单 is _myDate 将是：

```
if (DateTime.Compare(_myDate, _date1) >= 0 && DateTime.Compare(_myDate, _date2) <= 0)
{
    // we're between _date1 and _date2
} 
```

有点东西:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T12:34:55.073

我没有看到将字符串转换为 DateTime 变量（应该如此）然后使用该`Compare`方法执行比较的问题。

此外，DateTime 结构实现了诸如`>`, `<`,之类的运算符`>=`，`<=`它们简化了比较。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-27T12:36:36.850

您可以尝试使用 TimeSpan.Parse 或 TimeSpan.TeyParse 将字符串解析为 TimeSpan 对象。

如果解析成功，您将拥有一个 TimeSpan 对象，该对象可以使用标准比较运算符与其他时间跨度对象进行比较。您还可以执行加法和减法等操作来计算两个时间跨度之间的时间或根据时间和持续时间计算新时间。

时间跨度是一个非常好的小班，请不要重新发明轮子。

更新

正如 Cerebrus 在评论中所说，TimeSpan 有点奇怪，因为它可以代表时间点和持续时间。（DateTime.TimeOfDay 属性是一个时间跨度，即使它是一个时间点）。 **使用默认日期部分创建 DateTime 对象并将其用作计算的基础可能是一个更好的主意。代码的意图会更清楚。** 比较、加法和减法等操作也可以在 DateTimes 上使用，并在适用的情况下产生 DateTimes 或 TimeSpan。

# php - 您知道哪些特定于 PHP 的反模式？

> ID：793267
> 
> 赞同：21
> 
> 时间：2009-04-27T12:26:55.750
> 
> 标签：php, anti-patterns

### PHP 作为一种钝器

我听说 PHP 最近经常受到抨击。在相当多的项目中，我看到了疯狂的 php 代码库——太糟糕了，你真的想知道这个人在编写代码时是否服用了致幻药物。*有时，我想知道如果最初的开发人员对不做*什么有更多的指导，代码会是什么样子。

然而，我也看到了一些组织良好的 PHP 项目，这些项目是 100% OOP 完成的，维护起来很愉快，但它们不是由“php 程序员”编写的。

我给我们所有的初级开发者一个指向[Java Anti-Patterns](http://www.odi.ch/prog/design/newbies.php)的链接。该页面的优点之一是特定于 Java 的示例，因为 Java 的许多特性会导致常见错误。我希望找到一个类似的 php 列表，但谷歌搜索并没有发现任何有意义的东西。

[对于开发人员在编写 PHP 时应该知道](https://stackoverflow.com/questions/306497/what-should-every-php-programmer-know)的内容，已经存在一些问题，但我想关注负面的。

您在 PHP 中看到哪些应该避免的常见事情，以及以更好的方式做同样事情的常见解决方案是什么？

一些对我来说很明显的例子，我认为会被提及但不是特定于 PHP 的：

*   不要连接 SQL。使用准备语句或适当的转义。
*   不要盲目地将 PHP 嵌入 HTML - 使用模板/MVC。
*   不要盲目地发布未经过滤的原始用户输入 - 清除它以进行 XSS 攻击。
*   不要手动尝试解析所有 POST 和 GET - 使用 Web 框架。

以下是一些我认为 PHP 特定的示例：

*   不要有太多层文件包含/需要链接，并尽量避免条件链接。相反，要有一个合理的命名约定并与您的组织保持一致。
*   除非您能提供帮助，否则不要使用 PHP 的原始数据库 API，而是使用[ADODB](http://adodb.sourceforge.net/)之类的数据库框架。
*   不要过度使用 PHP 的动态类型，在一个地方将变量设置为字符串，在其他地方设置布尔值，然后期望布尔测试有意义。

那么，你最喜欢的 PHP*不做*的事情是什么，你是如何做到的呢？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-27T12:36:28.050

我不同意这个：

*   不要盲目地将 PHP 嵌入 HTML - 使用模板/MVC。

**PHP 是一种模板语言**。虽然我同意实现 MVC 的概念，但我不明白为什么需要实现另一个围绕生成 Web 输出的 DSL。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-15T19:58:31.330

在 php 文件的末尾添加关闭“？>”标签可能会导致意外地将空格推送到输出缓冲区。PHP 解释器会自动将结束标记添加到文件中，而手动执行此操作在某种程度上是一种反模式。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-27T20:26:22.647

1.  永远不要使用`$_GET`或`$_POST`不检查并清理它。
2.  阅读有关如何设置`php.ini`权限的信息。
3.  永远不要将变量放入原始 SQL。
4.  如果您使用框架，请使用依赖较少的框架。
5.  停止过度概括。
6.  在 php 文件上分发您的代码。在大多数情况下，没有真正需要将所有内容合二为一`index.php`。
7.  在编写代码之前降低复杂性。
8.  尊重它是一个 Web 应用程序这一事实。（尽量使用[RESTful](http://en.wikipedia.org/wiki/Representational_State_Transfer)。）它不是桌面应用程序。所以不要把所有东西都放进去`$_SESSION`。
9.  每 10 行代码至少有一个注释行。一年后你会读到的。我保证！
10.  [像女孩一样编写](http://headrush.typepad.com/creating_passionate_users/2006/03/code_like_a_gir.html)代码- 让它读起来很舒服。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-10-07T15:04:38.057

我目前的烦恼是查询功能的返回类型不一致。这是当您调用函数来执行查询时，它会返回

1.  找不到匹配项时为 NULL 或 FALSE 或类似的东西
2.  找到单个匹配项时的匹配对象/值
3.  找到多个匹配项时的匹配对象/值数组

这迫使您检查返回类型并具体处理每种情况。最好总是简单地返回一个包含 0、1 或 n 个元素的数组。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-27T12:42:19.207

我最喜欢的 DON'T 之一必须是：

```
$query = 'select * from users where username = ' . $_POST['username']; 
```

还能比这更可怕吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-14T15:22:59.167

*   使用声压级
*   使用 PDO 而不是使用 mysql_query 或 pg_query 或其他
*   始终在用户输入上使用过滤器扩展

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-14T15:12:31.967

如果我必须包括一个最喜欢的，它不是必须是 karim79 发布的：

```
$query = 'select * from users where username = ' . $_POST['username']; 
```

许多 PHP 开发人员一直停留在结构化时代。PHP 从前一段时间就支持类和对象，我只是不明白为什么人们一直将 PHP 硬编码为 html，没有模板或什么都没有。

我相信，如果有这么多开发人员继续这样编程，来自其他语言（如 .NET 或 Java）的开发人员已经赢得了批评该语言的权利。PHP 是一门非常棒的语言，非常灵活，仍然有点初级但正在成长，但许多人就是不明白，他们只想通过制作旧的经典复制粘贴来解决。

# excel - 将代码添加到在用户代码中动态添加到框架的命令按钮

> ID：793268
> 
> 赞同：0
> 
> 时间：2009-04-27T12:27:02.097
> 
> 标签：excel, vba

这是一个vba问题。我发现了这个问题：“使用 VBA 在 Excel 用户窗体中的框架中添加控件”并使用它的方法将命令按钮添加到我的用户窗体中的框架中。由于我添加了四个命令按钮，我循环运行代码，并使用

```
 With ...
      .Name = "commandbutton" & x 
```

给每个命令按钮自己的名字。我在每个命令按钮的代码宏中都包含了（因为我重命名了它们，所以我知道每个 cb 的名称是什么）但是当我单击按钮时，什么也没有发生。

或者，如果有人可以向我解释如何使用代码将表单上的控件放入框架中，我可以用不同的方式解决我的问题。

谢谢，

迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T00:54:47.773

似乎只有在编译 VBA 程序时（即在设计时）声明的对象变量才处理事件。如果您在程序中动态创建对象（即在运行时），那么您需要分配对这些对象的引用到已声明的适当对象变量。

根据您的示例，在与您相关的模块中`UserForm`，您需要：

```
Public WithEvents btn1 As MSForms.CommandButton
Public WithEvents btn2 As MSForms.CommandButton
Public WithEvents btn3 As MSForms.CommandButton
Public WithEvents btn4 As MSForms.CommandButton 
```

*（`MSForms`变量类型的前缀可能不是绝对必要的）*

然后在您`With`创建控件的语句中，您需要将每个控件分配给最终变得相当混乱的变量之一。

更好的解决方案：

*   在设计时创建尽可能多的按钮，然后切换`Visible`属性以显示正确的按钮
*   如果每个按钮的功能将在运行时确定，则使用`CommandButton`对象的某些属性来确定这一点（例如`Caption`属性、`Tag`属性），然后让该按钮的事件处理程序根据该属性调用适当的函数
*   更改 UI 并使用`ListBox`或`ComboBox`代替按钮

# c# - 程序挂起，等待我永远无法提供的输入

> ID：793271
> 
> 赞同：0
> 
> 时间：2009-04-27T12:28:08.850
> 
> 标签：c#, visual-studio, tcplistener

我正在使用 Visual Studio 对这个小型 TcpServer 进行编程。

这真的很具体。服务器侦听端口 1234，位于 IP 127.0.0.1 我们的老师给了我们一个程序，当您单击“连接”时，它会尝试连接到该 IP 上的该端口。它适用于其他所有人，所以它一定是我的编码错误。

当我点击连接时，程序通过流发送单词“GET”，我必须用一个已经连接的 IP 地址列表和一个只包含 .

当我断开连接时，程序会发送“REM”这个词，我只需从我的列表中删除 if（这是一个通用列表）

我有一个 TCPServer 类（我们必须自己制作），它的主要代码如下：

```
this.tl = new TcpListener(IPAddress.Any, PORT);
tl.Start();
while(true)
{
  TcpClient tcl = tl.AcceptTcpClient();//here the server will wait forever untill someone connects, meaning the "new Thread" statement is never reached untill someone connects.
  TcpHelper th = new TcpHelper(tcl,conf);
  new Thread(new ThreadStart(th.Start)).Start();//should be multi-threaded, not sure if it is.
  //t.Start();
} 
```

TcpHelper 看起来像这样（在 usings 中查找注释文本“here's the problem”）：

```
public class TcpHelper
{
    private TcpClient tc;
    private IPEndPoint ipe;
    private string get;
    private Configuration conf;

    public TcpHelper(TcpClient tc, Configuration conf)
    {
       this.tc = tc;
       this.conf = conf;
    }

    public void Start()
    {
       using (NetworkStream nws = this.tc.GetStream())
       {
           using (StreamReader sr = new StreamReader(nws))
           {
              using (StreamWriter sw = new StreamWriter(nws))
              {
                  this.ipe = (IPEndPoint)tc.Client.RemoteEndPoint;
                  this.conf.List.Add(this.ipe.Address);
                  bool conn = true;

                  while (conn)
                  {
                      this.get = sr.ReadLine();//here's the problem
                      switch (this.get)
                      {
                          case "GET":
                              foreach (IPAddress address in this.conf.Lijst)
                              {
                                  sw.WriteLine(address.ToString());
                              }
                              sw.WriteLine(".");
                              break;

                          case "REM":
                              this.conf.List.Remove(this.ipe.Address);
                              sw.WriteLine("OK.");
                              conn = false;
                              break;

                          default:
                              break;
                     }
                  }
              }
          }
      }
  }

  #region Properties
  public IPEndPoint Ipe
  {
      get
      {
          return this.ipe;
      }
  }
  #endregion
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T12:33:30.430

我的猜测是您的问题是您正在调用 sr.ReadLine()，但输入不包含换行符，因此它被阻塞在那里等待永远不会出现的换行符。

您可能想尝试调用[StreamReader.Read](http://msdn.microsoft.com/en-us/library/ath1fht8.aspx) 3 次来构建命令字符串 (GET/REM)，然后再对其进行操作。（注：3次是因为所有命令都是三个字符）。

Read 将返回整数，但在检查它们不是 -1（表示文件结束）之后，您可以将该整数转换为 char。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T12:46:18.057

对不起，也许我不明白这个......你写了这段代码吗？

```
this.tl = new TcpListener(IPAddress.Any, PORT);
tl.Start();
while(true)
{
  TcpClient tcl = tl.AcceptTcpClient();
  TcpHelper th = new TcpHelper(tcl,conf);
  new Thread(new ThreadStart(th.Start)).Start();
  //t.Start();
} 
```

这将炸毁任何计算机。您正在无限循环，在每个循环上创建新线程。因此，如果您在每个循环中创建一个新线程，并且每个循环需要一毫秒（可以说它非常慢！），那么在五秒钟内您将拥有 5,000 个线程。每个人都试图在同一个端口上监听。

尝试使用单线程。如果这是一个控制台应用程序，请使用 Console.ReadLine() 阻止主线程，直到有人按下回车键。

* * *

有了新信息... AcceptTcpClient 块，但不是创建一个新线程，工作应该在 ThreadPool 上排队。

# apache-flex - 在 Flex 中创建插件 - 加载嵌套的 SWF 文件

> ID：793275
> 
> 赞同：2
> 
> 时间：2009-04-27T12:30:17.487
> 
> 标签：apache-flex, actionscript-3, plugins, applicationdomain

我正在尝试为我们的应用程序实现一个插件系统，并且有一段时间获取动态加载的 SWF 文件，加载额外的 SWF 文件。

它是这样的：

1.  主要应用程序外壳加载...
2.  ---------+ 应用程序加载...
3.  -----------------+插件

我没有问题让应用程序 #1 加载应用程序 #2

但是，尽我所能，我无法让应用程序 #2 加载和实例化 #3

我使用 ModuleManager 尝试了各种排列，但这是我得到的最接近的。当调用 onLoadComplete 方法时，我可以看到 SWF 已加载，但工厂始终返回 NULL。

有趣的是，当我在它自己的应用程序中提取它时，它工作正常。这个问题是由我从本身动态加载的 SWF 加载插件这一事实触发的。

我相信这是由于`ApplicationDomain`，但我无法做出正面或反面。我尝试指定`currentDomain`，`new ApplicationDomain(Application.currentDomain)`但`new ApplicationDomain()`没有成功。

此外，重要的是要注意，我不能在任何一个应用程序中对 Foo 类进行硬引用，因为就其性质而言，我们不会提前知道它们将包含什么。

谷歌搜索，这似乎是一个众所周知的问题，但我还没有找到（明确的）解决方案。

```
.
.
.
assetModule = ModuleManager.getModule("Foo.swf");    
assetModule.addEventListener(ModuleEvent.READY, onLoadComplete );
assetModule.addEventListener(ModuleEvent.ERROR, onLoadError);
assetModule.load();
.
.
.
private var _pluginInstance:Plugin;

private function onLoadComplete( event:Event ):void
{
    trace("module loaded");

    _pluginInstance = assetModule.factory.create() as Plugin;
    if( _pluginInstance )
        _pluginInstance.startup();
    else 
        Alert.show("unable to instantiate module");
}

private function onLoadError( event:Event ):void
{
       Alert.show("error");
}

My Plugin looks like this:

package
{
    import mx.collections.ArrayCollection;
    import mx.modules.ModuleBase;

        public class Plugin extends ModuleBase

        public function startup():void
        {

        }
.
.
.
} 
```

和

```
package 
{
    import Plugin;
    import mx.modules.ModuleBase;

    public class Foo extends Plugin
    {
        public function Foo()
        {
            trace("foo constructor invoked");
        }

        override public function startup():void
        {
                    trace("foo started");
        }
.
.
.
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-04T21:42:38.370

如果你真的想在你的插件和你的应用程序之间使用一个通用的接口，你的应用程序的 Plugin 类必须和你的插件的 Plugin 类相同。为此，它们需要 b 在同一个 ApplicationDomain 中。

```
//In an external library
public interface Plugin {}

//In your application
_pluginInstance = assetModule.factory.create() as Plugin;
...

//In your plugin
public class MyPlugin implements Plugin 
```

问题是，当你编译你的插件 swf 时，你也会编译 Plugin。这不是问题，但您需要告诉您的应用程序它与他的相同：

```
var loader:Loader = new Loader();
loader.addEventListener(Event.COMPLETE, onLoadComplete);
loader.load(new URLRequest("plugin.swf"), new LoaderContext(false, ApplicationDomain.currentDomain)); 
```

ApplicationDomain.currentDomain 是这里的关键。如果您参考[文档](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/system/LoaderContext.html)：

> Loader自己的ApplicationDomain。您在使用 ApplicationDomain.currentDomain 时使用此应用程序域。加载完成后，父子可以直接使用对方的类。如果子类试图定义一个与父类已经定义的类同名的类，则使用父类并忽略子类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:42:33.677

@joshtynjala 是对的。我发现尝试只使用 Object 然后在其上调用方法（不要强制转换）。

var MyPlugin : Object = getPlugin(); MyPlugin.doPluginFunc();

一般可以在 system/flex 类之间转换没问题。不知道将插件作为运行时库是否会有所帮助？

# jakarta-ee - Struts 1.x 和 Struts 2.x 有什么区别

> ID：793291
> 
> 赞同：17
> 
> 时间：2009-04-27T12:33:40.570
> 
> 标签：jakarta-ee, struts2, struts, struts-1

我想知道 Struts 1.x 和 Struts 2.x 的区别

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-07-12T12:25:09.587

主要区别在于，在***Struts1.x***中，请求直接进入 servlet，而在***Struts2.x***中，请求和响应通过拦截器或过滤器的堆栈进行。常规逻辑可以放在过滤器类中，开发人员可以专注于业务逻辑。除此之外，目录结构也有所不同。

**最好从主题上了解Struts1.x 和 Struts2.x**之间的区别。[这是http://www.geekinterview.com/question_details/64360](http://www.geekinterview.com/question_details/64360)的引用：

* * *

### 1\. 动作类

在**Struts 1.x**中，action 类应该扩展 Action（或 DispatchAction）类，并且 execute 方法具有参数数量和 ActionForward 返回类型，但在**struts 2.x**中，action 类也可以是简单的 pojo，其 execute 方法只返回一个没有任何输入参数的字符串。

* * *

### 2\. Servlet 依赖

Container 不处理**Struts2.x**，与**Struts1.x**不同，Actions 作为请求/响应对，**struts2.x**动作仍然可以访问原始请求和响应。

* * *

### 3\. 获取输入

*   在**Struts1.x**中，表单 bean 用于定义属性、getter 和 setter，而在**struts2.x**中， getter/setter 是在动作类本身中定义的。
*   **Struts1.x**表单bean 类必须扩展ActionForm 或ValidatorForm，但**Struts2.x** bean 也可以是POJO。

* * *

### 4\. 可测试性

*   在 Struts1.x 中，execute() 方法公开了用于测试的 servlet API。
*   **Struts2.x** Dependancy Injection 被用来简化测试过程。

* * *

### 5\. 表达语言

*   **Struts1.x** JSTL作为其表达语言，而**Struts2.x**使用**OGNL**（Object Graphic Notation Language）作为其表​​达语言，比JSTL强。
*   **Struts2.x**也可以使用 JSTL。

* * *

### 6.类型转换

*   在**Struts1.x**中，属性几乎是字符串形式，转换器是每个类不可配置的。
*   **Struts 2.x**使用 OGNL 进行类型转换

* * *

### 7\. 验证

服务器端验证在 Struts2.x 中的动作类中进行，这是一种更简单的方法。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-27T12:43:25.583

这是一个完全不同的 Web 框架...... Struts2 基本上是旧的 Webwork。

一些区别：

*   Struts2 使用 POJO，不再使用 ActionForm。来自请求的所有属性都填充在“标准”Java 类中。
*   Struts2 动作不与 Servlet API 耦合，它们不接收 HttpServletRequest 和 HttpServletResponse 作为参数。此外，它们是有状态的（Struts 1 动作是无状态的）。
*   Struts2 有很多增强功能，比如 Interceptor API，还有很多集成。
*   配置完全不同。

我建议您“淘汰” Struts1，转而使用现代 Web 框架。

# c# - 如何在 ADO.NET 实体中检索一个数据库中的记录和所有子记录？

> ID：793299
> 
> 赞同：0
> 
> 时间：2009-04-27T12:35:06.180
> 
> 标签：c#, linq, entity-framework, ado.net, linq-to-entities

我想进行一次数据库调用来检索以下数据，但我很难弄清楚 LINQ 应该是什么样子。这是我当前的实现（我知道这很糟糕！！）：

```
var photos = from photo in entitiesContext.Photo
             join pg in entitiesContext.PhotoGallery on photo.PhotoGallery.PhotoGalleryID equals pg.PhotoGalleryID
             where pg.PhotoGallery == photoGalleryID
             select photo;

var photoList = photos.ToList();

foreach (var photoForLoading in photoList)
{
    photoForLoading.UserReference.Load();
    photoForLoading.PhotoComments.Load();

    foreach (var comment in photoForLoading.PhotoComment)
    {
        comment.UserReference.Load();
    }
}

return photoList; 
```

如您在上面看到的，我想检索：

*   来自特定照片库的所有照片：
    *   每张照片的用户详细信息
    *   每张照片的评论
        *   每个评论的用户详细信息

如何使用 ADO.NET 实体框架在 LINQ 中执行此操作？

干杯，阿什。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T12:38:51.477

使用 .Include 方法加载相关实体。例如：

```
from photo in entitiesContext.Photo
                          .Include("UserReference")
                          .Include("PhotoComments")
etc... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T12:40:31.863

创建 ObjectQuery 时，调用**Include**方法，传入要自动加载的子实体的名称。如果您有多个要加载的子实体，您可以将调用链接到 Include。

有关更多信息，请参阅[本文](http://msdn.microsoft.com/en-us/library/bb896272.aspx)。

# iphone - iPhone应用程序中的分段控制

> ID：793300
> 
> 赞同：0
> 
> 时间：2009-04-27T12:36:15.740
> 
> 标签：iphone

我已经将 UIsegment Control 放在我的 iPhone 应用程序中。要加载我有这个功能的页面 - (void) segmentSelected:(id)segmentedCntl{ NSLog(@"Selected Segment Index = %d", [segmentedCntl selectedSegmentIndex]);
int index = [segmentedCntl selectedSegmentIndex];

```
ViewController *viewController = (ViewController *) controller;
NSString *xPath = [NSString stringWithFormat:@"item[%d]/a", (index + 1)];
NSArray *items = [element nodesForXPath:xPath error:nil];
if([items count] > 0){
    CXMLElement *itemElement = (CXMLElement *) [items objectAtIndex:0];
    NSString *url = [[itemElement attributeForName:@"href"] stringValue];
    NSLog(@"url is &&&&&&&&&&&&&&&& %@", url);
    if([url startsWith:@"#"]){
    }else{
        NSString *fullURL = [URLLoader getURL:url];
        if(fullURL != nil){
            if([fullURL contains:@"?"]){
                fullURL = [fullURL stringByAppendingString:@"&iPhoneMode=app"];
            }else{
                fullURL = [fullURL stringByAppendingString:@"?iPhoneMode=app"];
            }
            [viewController showURL:fullURL cacheDuration:kPageCacheDuartion];               
        }
    }
} 
```

}

但是segmentControl不可点击。请帮我解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-18T11:44:25.903

Namastey saikamesh

请检查您的 UISegmentControl 属性设置是否正确。

# asp.net - C# 和 IIS - SSL 丢弃连接，通过 HTTP 很好

> ID：793305
> 
> 赞同：1
> 
> 时间：2009-04-27T12:38:00.450
> 
> 标签：asp.net, iis, ssl

在测试环境中，我自签名证书并将其安装在 IIS 6 中的网站上。这是使用 .NET 2.0。证书似乎很好（减去客户服务并不像人们期望的那样完全信任它的事实）。我可以通过 HTTPS 或 HTTP 从服务器本地访问站点来做任何我想做的事情。

远程访问此站点时出现问题。如果页面上有异常，则连接**断开**。不返回错误，而只是完全丢弃，浏览器说它找不到该站点（这是在它搅动几秒钟之后，我可以看到来自客户端 IP 的 TCP 流量进入）。

有趣的是，我可以创建一个空白的 ASPX 页面，上面什么都没有，而且通过 HTTPS 就可以了。但是我放的那一刻**throw new Exception();** 在页面上，它又回到了丢弃状态。顺便说一句，如果我使用 HTTP 访问同一页面，它似乎完全正常。

所以我有点卡住了。有人见过这样的吗？

我的第一个倾向是遵循我的远程客户端机器和服务器之间的代理/防火墙规则，但我想确保在我给其他团队带来麻烦之前我无法修复它。

**编辑**...看起来是防火墙白名单问题。我子网上的其他人也有同样的问题，但其他地方的人可以很好地解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T12:47:15.683

这不是代理或防火墙问题，因为黄屏死机只是可以通过任何防火墙传输的文本。这是我首先要尝试的几件事。

1.  通过处理 HTTPS，确保您使用 HTTPS 的事实不是问题的根本原因，例如问题不是在您的程序中引起的。比如一些Error code的特殊处理。

2.  创建一个新证书，看看是否会出现同样的问题。

3.  尝试在另一台机器上重现此问题，它可能只是配置问题。

4.  尝试从 GoDaddy 获得真正的证书，它们只有 29.99。

这就是我现在能想到的。您没有提到的一件事是您使用的是哪个版本的 IIS，这将很有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T14:02:16.237

您是否抛出了异常，然后使用常规 HTTP 测试了页面？是否发生了同样的事情，或者只有当您抛出异常并使用 HTTPS 访问它时才会发生？

# bash - 在哪里可以找到 Bash 发行说明或更改

> ID：793308
> 
> 赞同：27
> 
> 时间：2009-04-27T12:39:23.330
> 
> 标签：bash

我需要找到从 3 到 4 的 Bash 发行说明。我无法通过 google.com/linux 或默认的 google 找到它们。我在 gnu.org 上也没有成功。

**Bash 的发行说明在哪里？**

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-27T12:44:38.123

您可以从[Bash 网站](https://www.gnu.org/software/bash/)下载“Bourne again shell (BASH)”。在下载中，您可以找到发行说明。

* * *

**编辑**：或在线浏览源代码，请参阅[**新闻**](https://git.savannah.gnu.org/cgit/bash.git/tree/NEWS)以获取摘要，并查看[**更改**](https://git.savannah.gnu.org/cgit/bash.git/tree/CHANGES)以获取详细信息。

对于补丁版本，这些可能很有用：

*   [https://ftp.gnu.org/gnu/bash/bash-4.4-patches/](https://ftp.gnu.org/gnu/bash/bash-4.4-patches/)
*   [https://ftp.gnu.org/gnu/bash/bash-5.0-patches/](https://ftp.gnu.org/gnu/bash/bash-5.0-patches/)
*   [https://ftp.gnu.org/gnu/bash/bash-5.1-patches/](https://ftp.gnu.org/gnu/bash/bash-5.1-patches/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-27T12:45:40.023

有两个文件随[源](ftp://ftp.gnu.org/pub/gnu/bash/bash-4.0.tar.gz)分发：`NEWS`和`CHANGES`. `CHANGES`记录所有内容，同时`NEWS`总结新功能。

[您可以在此处](http://bash-hackers.org/wiki/doku.php/bash4)找到 BASH 4 的摘要，或查看[常见问题解答](ftp://ftp.cwru.edu/pub/bash/FAQ)的 B1 部分以获取最新信息`NEWS`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-27T12:45:30.913

干得好：

[http://tiswww.case.edu/php/chet/bash/NEWS](http://tiswww.case.edu/php/chet/bash/NEWS)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T12:44:27.080

在我的机器（Ubuntu 9.04）上，它位于`/usr/share/doc/bash/CHANGES.gz`

# c# - 寻找与 C# 一起使用的免费 SMS 网关

> ID：793323
> 
> 赞同：0
> 
> 时间：2009-04-27T12:44:37.017
> 
> 标签：c#, asp.net, sms

我在 ASP.NET 2.0 中开发了一个网站，我想向每个注册到我的网站的人发送 SMS。我想用 C# 代码来做，有没有我可以使用的服务 [webservice] 并向任何手机发送免费短信。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T13:07:37.087

尽管我不认可您的方法或这项服务，但我确实偶然发现了[ReadWriteWeb](http://www.readwriteweb.com/archives/zeep_mobile_free_sms_gateway.php)对 Zeep Mobile 的文章。如果您对他们在 SMS 中插入广告感到满意，那么这可能适合您。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T12:47:19.553

您应该只允许他们再输入一个电子邮件地址。如果人们想要短信，他们可以从他们的提供商网关输入电子邮件地址。这将允许他们在移动/PDA 风格的设备上接收消息，而无需处理 SMS。

# asp.net - 用于授权私有用户文件夹的 Web.config

> ID：793326
> 
> 赞同：0
> 
> 时间：2009-04-27T12:45:01.993
> 
> 标签：asp.net, authorization, directory, private

我有一个包含数千个用户文件夹的私人文件夹，只有正确的用户才能访问。没有用户可以访问其他用户的文件夹。我只能想到为每个用户的子文件夹创建一个 web.config 授权规则。在这种情况下，我不必在一个 web.config 文件中为每个用户添加所有规则。

我想知道是否有任何其他方法可以通过仅使用一个 web.config 而不是为每个用户创建一个唯一的 web.config 文件来解决此问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T12:50:53.147

另一种方法是您可以创建自己的授权处理程序来验证用户是否在他们自己的目录中。一个起点`Request_Authorization`是 Global.asax 中的事件处理程序。

这样做的好处是您可以从单一来源（例如数据库）管理所有权限。

# c++ - 修复 glCopyTexSubImage2D 倒置纹理

> ID：793327
> 
> 赞同：0
> 
> 时间：2009-04-27T12:45:06.047
> 
> 标签：c++, opengl, capture, render, textures

自从我开始学习渲染到纹理后，我逐渐明白这`glCopyTexSubImage2D()`会将屏幕的指定部分倒置。我尝试了一些简单的事情来防止/解决这个问题，但找不到优雅的解决方案。

*   在将纹理渲染到屏幕之前执行 ::glScalef(1.0f, -1.0f, 1.0f) 有两个问题： 1，我每次使用纹理时都必须这样做。2，我主要使用 2D 图形，并为 GL_BACKsides 关闭了背面剔除。我希望尽可能多地打开和关闭它。

*   尝试将矩阵模式切换到 GL_TEXTURE 并在捕获时进行 ::glScalef(1.0f, -1.0f, 1.0f) 转换，但结果是相同的。（我猜纹理矩阵只对 glTexCoord 调用有影响？）

那么，如何修复用 捕获的纹理的上下方向`glCopyTexSubImage2D`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T22:02:29.280

你打算用纹理图像做什么？实际上，尝试将它们颠倒过来通常比将代码移到其他地方需要更多的工作。

如果您尝试使用图像而不导出它，那么只要在使用结果的任何地方翻转纹理坐标将是最有效的方法。

如果您尝试导出它，那么您要么想在渲染后自己翻转它们。

在相关的说明中，如果您正在制作 2D 游戏，为什么要打开背面剔除？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T21:51:21.913

如果我的理解是正确的，那取决于你的出身。该函数似乎假设您的原点位于左下角，而大多数 2D 东西都假设原点位于左上角，这就是它看起来颠倒的原因。

我想您可以将原点更改为左下角，进行捕获，然后将原点更改回左上角并在进行交换之前再次渲染。但这是一个可怕的解决方案，因为您有效地渲染了两次，但如果您不打算每帧都这样做，它可能会很好。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-27T22:12:39.630

使用 glReadPixels() 复制到缓冲区，翻转图像，然后使用 glTexImage2D() 将其写回。

# iphone - 应用程序退出时会调用 -dealloc 方法吗？

> ID：793335
> 
> 赞同：3
> 
> 时间：2009-04-27T12:47:04.967
> 
> 标签：iphone, cocoa-touch, memory-management, uikit

苹果说，在 Cocoa 中，当应用程序退出时，-dealloc 不会被调用。这是否也适用于 iPhone？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T13:08:21.610

我已经使用[applicationWillTerminate](http://developer.apple.com/iPhone/library/documentation/UIKit/Reference/UIApplicationDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UIApplicationDelegate/applicationWillTerminate:)调用来执行释放（或 [self release]），然后应该允许 dealloc 尝试很好地清理

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T13:44:56.933

是的，它确实。如果应用程序正在退出，在某些情况下，不会调用 dealloc。例如，如果 applicationWillTerminate 中的任何内容花费太长时间或引发未捕获的异常，则应用程序将退出而不调用 dealloc。

可能它*永远不会*在退出时调用 dealloc，因为操作系统无论如何都会进行内存清理。找出最简单和最快的解决方案是在主视图控制器的 dealloc 上放置一个断点，看看它是否在应用程序退出时被调用。

我想我记得当我尝试过一次时它没有被调用，但我不确定，这就是为什么你应该自己尝试一下。

# wpf - 为什么 DataContext 和 ItemsSource 不是多余的？

> ID：793340
> 
> 赞同：37
> 
> 时间：2009-04-27T12:47:37.103
> 
> 标签：wpf, data-binding, datacontext, itemssource

在 WPF 数据绑定中，我知道您有**`DataContext`**哪个告诉元素它将绑定到哪些数据以及**`ItemsSource`**哪个“进行绑定”。

但是例如在这个简单的例子中，它似乎没有**`ItemsSource`**做任何有用的事情，因为**除了*****绑定*****到它之外****，您还希望元素对它做`DataContext`***什么？*

 *```
<ListBox DataContext="{StaticResource customers}" 
         ItemsSource="{Binding}"> 
```

而在更复杂的例子中**`ItemsSource`**，你的路径和源头似乎正在侵占**`DataContext`**.

```
ItemsSource="{Binding Path=TheImages, Source={StaticResource ImageFactoryDS}}" 
```

**理解这两个概念以了解何时以及如何在各种编码场景中应用它们的最佳方法是什么？**

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-27T12:50:48.560

`DataContext`对于未指定显式源的情况，这只是为绑定获取上下文的一种方便方法。它是继承的，因此可以做到这一点：

```
<StackPanel DataContext="{StaticResource Data}">
    <ListBox ItemsSource="{Binding Customers}"/>
    <ListBox ItemsSource="{Binding Orders}"/>
</StackPanel> 
```

在这里，`Customers`和`Orders`是名为“数据”的资源上的集合。在你的情况下，你可以这样做：

```
<ListBox ItemsSource="{Binding Source={StaticResource customers}}"/> 
```

因为没有其他控件需要上下文集。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-09-01T02:55:03.570

ItemsSource 属性将直接与集合对象或 DataContext 属性的绑定对象的集合属性绑定。

经验：

```
Class Root
{
   public string Name;
   public List<ChildRoot> childRoots = new List<ChildRoot>();
}

Class ChildRoot
{
   public string childName;
} 
```

将有两种方式绑定 ListBox 控件：

1）与DataContext绑定：

```
 Root r = new Root()
    r.Name = "ROOT1";

    ChildRoot c1 = new ChildRoot()
    c1.childName = "Child1";
    r.childRoots.Add(c1);

    c1 = new ChildRoot()
    c1.childName = "Child2";
    r.childRoots.Add(c1);

    c1 = new ChildRoot()
    c1.childName = "Child3";
    r.childRoots.Add(c1);

treeView.DataContext = r;

<TreeViewItem ItemsSource="{Binding Path=childRoots}" Header="{Binding Path=Name}">
<HierarchicalDataTemplate DataType="{x:Type local:Root}" ItemsSource="{Binding Path=childRoots}"> 
```

2) 与 ItemSource 绑定：

ItemsSource 属性总是需要收集。在这里我们必须绑定 Root 的集合

```
List<Root> lstRoots = new List<Root>();
lstRoots.Add(r);

<HierarchicalDataTemplate DataType="{x:Type local:Root}" ItemsSource="{Binding Path=childRoots}"> 
```

在第一个示例中，我们绑定了 DataContext，该对象内部有对象，我们有与 ItemSource 属性绑定的集合，而在第二个示例中，我们直接将 ItemSource 属性与集合对象绑定。

# python - 让 Aspen 和 Gheat 在 Windows 上工作

> ID：793341
> 
> 赞同：-1
> 
> 时间：2009-04-27T12:47:39.427
> 
> 标签：python, pygame, aspen

我不是很熟悉 Python 设置，我试图让 gheat 在 Windows 机器上运行，它告诉我它找不到 pygame。

我也尝试过 Python25,26，较旧的 pygame 版本。

我已经安装了这些以及 numpy，因为它具有依赖项。

有经验的人可以尝试帮助我启动并运行它。

我已经尝试对它运行进程监视器，它似乎找到了所有文件等，但 aspen/gheat 仍然告诉我它找不到 Pygame。

下面的链接。

1.) [http://www.python.org/](http://www.python.org/) 2.) [http://code.google.com/p/gheat/](http://code.google.com/p/gheat/) 3.) [http://www.pygame.org/](http://www.pygame.org/) 4.) [http:// numpy.scipy.org/](http://numpy.scipy.org/)

为任何帮助而欢呼。

另外，只需安装 pygame，它就可以在我的 ubuntu 机器上正常工作，并且可以正常工作！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T13:35:35.240

感谢来自 Freenode 上#csharp 频道的 Sec-，他发现这是最新的 aspen 主干的问题，（我以为我已经尝试过旧版本）

[http://www.zetadev.com/software/aspen/0.8/dist/aspen-0.8.zip](http://www.zetadev.com/software/aspen/0.8/dist/aspen-0.8.zip)

您将需要 0.8 版本才能使其正常工作！！

总之加油！

# xslt - 如何使用 XPath/Xsl 将子元素与不同父元素下的相同子元素进行比较？

> ID：793343
> 
> 赞同：1
> 
> 时间：2009-04-27T12:47:57.117
> 
> 标签：xslt, xpath

当 SupplierId 的值发生变化时，我需要使用 xsl/xpath（1.0 版）来做一些特别的事情（为了简化，比如插入一些虚拟文本）。我需要处理 3 种变化；

1.  在第一个订单上做某事（SupplierId 的第一次出现）
2.  在 OrderId O3 上做一些事情（SupplierId 从 S1 更改为 S2）
3.  在最后一个订单上做某事（SupplierId 的最后一次出现）

.

```
<?xml version="1.0" encoding="utf-8"?>
<Orders>
    <Order>
        <OrderId>O1</OrderId>
        <SupplierId>S1</SupplierId>
    </Order>
    <Order>
        <OrderId>O2</OrderId>
        <SupplierId>S1</SupplierId>
    </Order>
    <Order>
        <OrderId>O3</OrderId>
        <SupplierId>S2</SupplierId>
    </Order>
    <Order>
        <OrderId>O4</OrderId>
        <SupplierId>S2</SupplierId>
    </Order>
    <Order>
        <OrderId>O5</OrderId>
        <SupplierId>S2</SupplierId>
    </Order>
</Orders> 
```

我尝试过使用前兄弟、后兄弟等，但还没有找到。对于这个新手问题，我将不胜感激。

沃利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T13:53:17.897

**这是一种自然而简单的解决方案**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

    <xsl:template match="Order[1]">
      First OrderId = <xsl:text/>
      <xsl:value-of select="OrderId"/>
    </xsl:template>

    <xsl:template match="Order[last()]">

      Last OrderId = <xsl:text/>
      <xsl:value-of select="OrderId"/>
    </xsl:template>

    <xsl:template match=
      "Order[not(position() = 1)]
         [not(SupplierId 
             = 
             preceding-sibling::Order[1]/SupplierId
              )
        ]">

      Changes in Order OrderId = <xsl:text/>
      <xsl:value-of select="OrderId"/>
         SupplierId = <xsl:text/>
         <xsl:value-of select="SupplierId"/>
      Previous Order OrderId = <xsl:text/>
      <xsl:value-of select=
        "preceding-sibling::Order[1]/OrderId"/>
                 SupplierId = <xsl:text/>
         <xsl:value-of select=
         "preceding-sibling::Order[1]/SupplierId"/>
    </xsl:template>

    <xsl:template match="text()"/>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时**：

```
<Orders>
    <Order>
        <OrderId>O1</OrderId>
        <SupplierId>S1</SupplierId>
    </Order>
    <Order>
        <OrderId>O2</OrderId>
        <SupplierId>S1</SupplierId>
    </Order>
    <Order>
        <OrderId>O3</OrderId>
        <SupplierId>S2</SupplierId>
    </Order>
    <Order>
        <OrderId>O4</OrderId>
        <SupplierId>S2</SupplierId>
    </Order>
    <Order>
        <OrderId>O5</OrderId>
        <SupplierId>S2</SupplierId>
    </Order>
</Orders> 
```

**产生了预期的结果**：

```
 First OrderId = O1

  Changes in Order OrderId = O3
     SupplierId = S2
  Previous Order OrderId = O2
             SupplierId = S1

  Last OrderId = O5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T13:12:24.093

假设一个根元素`Orders`，匹配每个条件的 XPath 表达式变为：

一种。**第一个订单（SupplierId 的第一次出现）**

```
XPath 1.0 - /Orders/Order[SupplierId][1]
XPath 2.0 - /Orders/Order[exists(SupplierId)][1] 
```

湾。**在 OrderId O3 上（SupplierId 从 S1 更改为 S2）**

```
/Orders/Order[OrderId = 'O3' and SupplierId = 'S2'] 
```

C。**在最后一个订单上（SupplierId 最后一次出现）**

```
/Orders/Order[SupplierId][last()] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T13:24:13.363

您可以使用递归逐个递减订单列表，将先前的值与当前值进行比较（解决方案意味着文档顺序已经正确，因为它使用以下兄弟轴）：

```
<xsl:stylesheet 
  version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
>

  <xsl:template match="/Orders">
    <xsl:apply-templates select="Order[1]" mode="watch_SupplierId" />
  </xsl:template>

  <xsl:template match="Order" mode="watch_SupplierId">
    <xsl:param name="PrevValue" select="''" />

    <xsl:if test="string(SupplierId) != $PrevValue">
      <xsl:call-template name="DoSomething" />
    </xsl:if>

    <xsl:variable name="next" select="following-sibling::Order[1]" />
    <xsl:choose>
      <xsl:when test="$next">
        <xsl:apply-templates select="$next" mode="watch_SupplierId">
          <xsl:with-param name="PrevValue" select="string(SupplierId)" />
        </xsl:apply-templates>
      </xsl:when>
      <xsl:otherwise>
        <xsl:value-of select="concat('last Order found: ', OrderId, '&#10;')" />
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template>

  <xsl:template name="DoSomething">
    <xsl:value-of select="concat(
      '@SupplierId changed to &quot;' 
      , SupplierId/text() 
      , '&quot; in Order '
      , OrderId
      , '&#10;'
    )" />
  </xsl:template>

</xsl:stylesheet> 
```

输出：

```
@SupplierId 在订单 O1 中更改为“S1”
@SupplierId 在 O3 订单中更改为“S2”
找到的最后一个订单：O5

```

# c++ - 插入 C++ std::map 时出现奇怪的错误

> ID：793351
> 
> 赞同：1
> 
> 时间：2009-04-27T12:50:51.260
> 
> 标签：c++, dictionary, std, stdmap, c++-standard-library

我正在尝试将一些值对插入到 std::map 中。在第一种情况下，我收到一个指向地图的指针，取消引用它并使用下标运算符分配一个值。IE

```
(*foo)[index] = bar; 
```

后来，当我尝试遍历集合时，返回的键/值对在所有情况下都包含 null 的 value 属性，但第一个 (map.begin()) 项除外。奇怪的是，如果我通过地图的插入功能进行插入，一切都很好，即：

```
foo->insert(std::pair<KeyType,ValueType>(myKey, myValue)); 
```

为什么会这样？这两种方法在功能上不是等效的吗？我在下面粘贴了一些实际代码片段作为上下文

```
...
typedef std::map<int, SCNode*> SCNodeMap;
...

void StemAndCycle::getCycleNodes(SCNodeMap* cycleNodes)
{
    (*cycleNodes)[root->getId()] = root;

    SCNode* tmp = root->getSucc();
    while(tmp->getId() != root->getId())
    {
        // (*cycleNodes)[tmp->getId()] == tmp; // crashes (in loop below)
        cycleNodes->insert(std::pair<int, SCNode*>(tmp->getId(), tmp));//OK
        std::pair<int, SCNode*> it = *(cycleNodes->find(tmp->getId()));
        tmp = tmp->getSucc();
    }

    // debugging; print ids of all the SCNode objects in the collection
    std::map<int, SCNode*>::iterator it = cycleNodes->begin();
    while(it != cycleNodes->end())
    {
        std::pair<int, SCNode*> p = (*it);
        SCNode* tmp = (*it).second; // null except for it = cycleNodes->begin()
        std::cout << "tmp node id: "<<tmp->getId()<<std::endl; 
        it++;
    }

} 
```

我完全没主意了。请问有人有什么建议吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-27T13:21:50.763

在您的实际代码中，您有：

```
(*cycleNodes)[tmp->getId()] == tmp; 
```

这不会将 tmp 分配到地图中，而是会引用地图创建一个空值（请参阅@Neil Butterworth） - 你有 == 而不是 =。你想要的是：

```
(*cycleNodes)[tmp->getId()] = tmp; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T13:00:59.503

您应该知道 std::map 的 operator[] 将在映射中插入一个值，如果在这样的表达式中使用时不存在一个值：

```
if ( amap[x] == 42 ) {
   ...
} 
```

如果值 x 不存在，则将创建一个并分配由值类型默认构造函数创建的值，或者为内置类型分配零。这几乎不是您想要的，您通常应该避免将 operator[] 与地图一起使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T12:57:59.013

你的值类型有赋值运算符吗？

看看[这个参考](http://www.cplusplus.com/reference/stl/map/operator[]/)。[] 运算符返回对该值的非常量引用。如果您的分配错误或以某种意想不到的方式工作，这可能是原因。

另一方面，插入方法接受一个值并将其填充到地图中。[] 运算符使用默认构造函数构造一个对象，然后让我们使用它的赋值运算符为它赋值。

# sharepoint - 将字段添加到列表表单 - Sharepoint

> ID：793360
> 
> 赞同：1
> 
> 时间：2009-04-27T12:52:53.347
> 
> 标签：sharepoint, sharepoint-designer

我希望在 Sharepoint Designer 2007 中的 NewForm.aspx、EditForm.aspx 和 DispForm.aspx 页面上添加一个新字段。我设法添加了一个新的文本框 webpart 并编辑了通用文本框任务以制作数据字段我的新领域（联系人..）

但是如何编辑 Edit.aspx 和 DispForm.aspx 以显示这个新字段？

我环顾四周，已经回答了网站上的问题，但我没有遇到我真正想要的东西——如果我错过了，对不起！

谢谢！香农

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T14:37:43.767

它不算作“开发”，但不会创建一个新的列表列、站点列或内容类型将此附加字段添加到您的所有列表表单中吗？这在您的特定情况下如何不起作用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T13:05:10.617

您必须使用 SharePoint Designer 访问网站并编辑这些 aspx（在以列表命名的文件夹的“表单”子文件夹中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T21:24:04.117

您可能会以错误的方式解决此问题。您不需要仅仅因为您想要一个新字段而更改列表的编辑和新表单。您确实需要将该字段添加到基础列表中，并依靠表单中的代码来正确显示该字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-22T14:42:19.713

在 SPD 中选择最右侧的表格选项卡，然后选择一行，然后您可以在上方插入或在下方插入，然后您可以添加新字段。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-22T18:39:39.363

新项目、编辑和显示表单不像附加到内容类型那样附加到列表。如果您无法使用 InfoPath 或 Designer 进行设置，您可以执行以下操作：

1.  将相关表单创建为应用程序页面。无论出于何种原因，SharePoint 应用程序页面都不会在屏幕上呈现，因此为了了解我正在查看的内容，我通常首先将它们制作在可视 Web 部件或单独的 ASP 应用程序中，然后复制并粘贴 ASP/HTML完了，然后删掉原来的。

2.  在编辑和显示表单的情况下，SP 将向您传递一个带有 ID 的查询字符串。因此，我捕获了有问题的项目：

    ```
     NameValueCollection nvQueryString = Page.Request.QueryString;
            taskID = Convert.ToInt32(nvQueryString["ID"]);
            ViewState["TaskID"] = taskID;

            SPWeb thisWeb = SPContext.Current.Web;
            SPList taskList = thisWeb.Lists["Job Request approval tasks"];
            SPListItem taskItem = taskList.GetItemById(taskID); 
    ```

3.  在添加您需要添加的任何内容之后，您确实需要将逻辑添加到 .cs 页面或实际编辑/添加相关项目的单独类。应该很明显吧...

4.  从这里您有三个选项：创建一个事件接收器，将相关内容类型的 editformURL/displayformURL/newformURL 指向您的应用程序页面，创建一个全新的内容类型并在其 XML 定义中添加您的应用程序页面的 URL，或通过 Powershell 手动添加。

# c# - 在 C# 中创建可重用的方法超时类

> ID：793361
> 
> 赞同：1
> 
> 时间：2009-04-27T12:53:12.690
> 
> 标签：c#, delegates

我正在尝试创建一个类，让我调用具有指定超时的方法。我有实际的超时实现工作，但是无法成功地将它封装到一个类中。

我现在决定将自己限制为仅使用 5 个 Action 委托来对采用 0 - 4 个参数的方法设置超时。出于这个问题的目的，我将使用 Action 的一个参数变体。

我的理想调用语法是这样的：

```
Action<int> a = new TimeoutAction(i => i + 1)
{
    Timeout = Timespan.FromSeconds(10)
} 
```

或这个：

```
Action<int> a = (x => x + 1).Timeout(Timespan.FromSeconds(10)) 
```

我几乎可以肯定第一个版本是不可能的，因为没有办法从委托继承。第二个可以通过在`Delegate`类型上使用扩展方法来实现。

最后的后备方法是创建静态方法，这些方法采用适当的委托类型并返回具有相同签名但包含超时的委托。

有什么建议或想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T13:14:32.467

您的最后一个建议是正确的方法：

> 最后的后备方法是创建静态方法，这些方法采用适当的委托类型并返回具有相同签名但包含超时的委托。

换句话说：

```
public static Action<T> Timeout<T>(this Action<T> action, TimeSpan timeSpan);
public static Action<T1, T2> Timeout<T1, T2>(this Action<T1, T2> action, TimeSpan timeSpan);
public static Func<T, TResult> Timeout<T, TResult>(this Func<T, TResult> action, TimeSpan timeSpan);
public static Func<T1, T2, TResult> Timeout<T1, T2, TResult>(this Func<T1, T2, TResult> action, TimeSpan timeSpan);
/* snip the rest of the Action<...> and Func<...> overloads */ 
```

*“为什么我不能只声明一种方法？”*

您可以声明一个接受 a`Delegate`并返回 a 的方法`Delegate`，但是您会丢失委托类型信息（您的第二个示例无法编译）。

不幸的是，以下示例不是有效的 C# - 您不能将`Delegate`其用作类型参数约束：

```
public static TDelegate Timeout<TDelegate>(this TDelegate d, Timespan timespan) where TDelegate : Delegate; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T12:54:45.447

为此使用[AOP](http://en.wikipedia.org/wiki/Aspect-oriented_programming)。[PostSharp](http://www.postsharp.org/)或DynamicProxy [_](http://www.castleproject.org/dynamicproxy/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T13:11:43.097

像[这里](http://www.interact-sw.co.uk/iangblog/2004/03/23/locking)描述的定时锁的方法怎么样？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-27T13:00:32.843

好吧，一个 lambda 表达式不会“有一个类型”（任何你可以“点”或扩展方法的东西），直到你将它包装在例如

```
new DelType(lambda) 
```

或者

```
Stat.Method(lambda) 
```

或以其他方式提供上下文，因此我建议使用最终选项（静态方法）：

```
Timeout.Action(lambda, timeoutVal) 
```

# java - 如何实例化具有需要接口对象的构造函数的类

> ID：793368
> 
> 赞同：0
> 
> 时间：2009-04-27T12:55:18.770
> 
> 标签：java, sockets, interface, polymorphism, instantiation

我正在尝试使用 Interactive Brokers Java API 来查看是否可以进行一些算法交易（最初是在纸上）。我想调用一个名为的方法`ReqMktDepth()`，该方法位于一个名为`EClientSocket`.

`EClientSocket`构造函数需要`AnyWrapper`传递一个类型的对象，并且是`AnyWrapper`一个接口而不是一个具体的类。从理论上讲，我该如何将一个`AnyWrapper`类传递给`EClientSocket`构造函数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T12:57:01.840

您需要创建一个实现 AnyWrapper 的类（使用“implements”关键字），然后您必须为该接口定义的任何方法提供定义。

这是一个简单的教程：

[http://www.uweb.ucsb.edu/~cdecuir/Polymorphism.html](http://www.uweb.ucsb.edu/~cdecuir/Polymorphism.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T13:08:00.347

您可以按照 Bobby 的建议创建自己的实现 AnyWrapper 接口的类。或使用已经从 AnyWrapper 接口（如 EWrapper）扩展的任何其他类（存在于库/jar/命名空间中），该类已经具有 AnyWrapper 的实现。

见-> [http://www.interactivebrokers.com/php/apiUsersGuide/apiguide/java/eclientsocket.htm](http://www.interactivebrokers.com/php/apiUsersGuide/apiguide/java/eclientsocket.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T13:09:56.847

您可能应该在您使用的那个 API 中使用一些实现`AnyWrapper`接口的类。您可以查看该 API 的 JavaDoc 或使用 IDE 的功能（例如*显示类型层次结构*）来找出哪些类实现`AnyWrapper`并传递其中一个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T13:25:42.130

其他几个答案指出，您可以通过自己实现或通过查找现有类并传入该类的实例来创建 AnyWrapper 的实例。

但是，在我看来，您正在做的事情不太可能成功。您正在尝试调用一个您完全不知道其参数的方法。您需要阅读有关该方法的文档，并了解 AnyWrapper 的用途以及如何使用它。也许只是需要提供一些东西，但也许 AnyWrapper 有一些 EClientSocket 需要的责任。

这种通过反复试验进行的编程可能会导致一些严重的问题。一方面，除非采取其他保护措施，否则某些方法调用是不安全的。某些方法具有重大的性能或安全隐患。在这种情况下，我认为你真的需要在弄清楚如何做之前找出你正在尝试做的事情。

# c++ - 什么可能导致损坏：正常块错误后？

> ID：793375
> 
> 赞同：2
> 
> 时间：2009-04-27T12:57:13.227
> 
> 标签：c++, visual-c++

在我的应用程序运行 2 天后，我不断收到此错误。

我被告知这是某种缓冲区溢出，但这是唯一的选择吗？

该应用程序是使用 Visual C++ 6.0 以 C++ 编写的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T13:06:36.887

最简单的重现方法是这样的：

```
//Allocate space for holding 10 ints
int *p = new int[10];

//Overwrite the memory.. doesn't crash here
p[10] = 8;

//Try to delete..crashes..
delete[] p; 
```

检查您是否正在写入超出其分配空间的内存位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T15:12:28.300

在调试中，当您通过 获取动态缓冲区时`new`，会在缓冲区之前和之后插入一个特殊代码来保护缓冲区。

前任：

```
<Guard>=====buffer allocated on heap of required size=======<Guard> 
```

如果您溢出缓冲区，则插入的保护会损坏，并且当您尝试删除缓冲区时，调试器将在检测到缓冲区溢出后断言。

在大型代码库中找到缓冲区溢出有点困难。我会建议几种可以帮助您检测这种情况的方法：

*   使用[Rational Purify 之](http://www-01.ibm.com/software/awdtools/purify/)类的工具：
    它是检测内存损坏的好工具。
*   在启用 GFlags 的情况下由 Windbg 进行调试：请在此处参考我对类似问题的[回答](https://stackoverflow.com/questions/781821/debug-visual-c-memory-allocation-problems/782085#782085)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T13:04:43.787

使用正确的选项，Visual C++ 会在每个缓冲区的末尾抛出一个保护值。当您释放缓冲区时，它会检查这是否仍然有效。如果不是，它会引发您看到的错误。

此错误的最常见原因是缓冲区溢出。但是，它可以（理论上）由随机指针写入引起（毕竟，它*可以*写入保护值）。

不过，赔率是超支。

# c++ - 为什么在 C++ 中在公共成员之下定义私有成员？

> ID：793377
> 
> 赞同：34
> 
> 时间：2009-04-27T12:57:44.987
> 
> 标签：c++, private

在 C++ 中，有时在类定义中，首先声明公共成员，然后声明私有成员。但是变量或数据成员通常是私有的并由公共方法使用。因此，在这种情况下，使用了变量，但还没有声明。因此代码变得难以理解。但后来我找到了著名的程序员、网站或书籍来声明私有成员。有谁知道是什么原因？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-27T12:58:40.977

我这样做是因为我班级的用户不关心私有成员，他们对公共 API 感兴趣（即如何使用我的班级）。

此外，在头文件中，我通常只是声明成员函数，而不是定义它们，所以无论如何我都不会访问任何私有成员。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-04-27T13:44:23.613

我们从上到下阅读文本，因此最相关的信息应该在顶部。在类定义中，这就是公共接口。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-27T13:12:03.377

私有成员和实现应该从头文件中隐藏。将私有成员定义放在底部是一种快速的方法。也许最好使用[Pimpl 习惯用法](http://www.drdobbs.com/cpp/205918714;jsessionid=VITPS3S31ZIWDQE1GHRSKHWATMY32JVN)并将类的私有部分隐藏在内部结构中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T13:00:58.537

通常私人成员并不重要。如果我正在查看一个类以确定如何在代码中的其他地方使用它，我不关心它的内部结构，所以将私有成员放在底部，因为我不需要了解它们。如果我正在修改一个班级，那么我会花时间找到私人成员并知道他们会排在最后，而不必浏览整个班级。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-27T13:03:05.147

我们就像对立面：[我的问题](https://stackoverflow.com/questions/778281/why-put-private-fields-and-methods-at-the-top-of-class)

我的理由是，当您熟悉一个类时，首先介绍公共接口然后在需要时深入了解私有成员会更有益。如果您从查看私有成员开始，您将不知道它们是如何使用的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-16T13:05:10.860

同意。私有成员应该在底部声明。我发现首先声明私有成员的唯一充分理由是当函数需要获取或返回自定义数据类型时，例如：vector。编译器会询问你这是什么类型的数据。

但即便如此，在这种情况下，我更愿意这样做：

```
{
private: /// advicing ofc theres more private below!
   earlier declare just of the type

public:

private:

}; 
```

# python - 如何在 wx.ScrolledWindow 中获取视图的尺寸（不受滚动条的阻碍）？

> ID：793381
> 
> 赞同：2
> 
> 时间：2009-04-27T12:58:22.973
> 
> 标签：python, wxpython, wxwidgets, scrolledwindow

是否有捷径可寻？或者，如果我可以获得滚动条的宽度，我可以只使用 ScrolledWindow 的尺寸并自己减去它们......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T13:30:47.437

使用 wx.SystemSettings.GetMetric() 和 wx.SYS_HSCROLL_Y 和 wx.SYS_VSCROLL_X 来获取滚动条的大小。然后使用 window.GetClientSize() 并减去它。

[http://docs.wxwidgets.org/stable/wx_wxsystemsettings.html#wxsystemsettings](http://docs.wxwidgets.org/stable/wx_wxsystemsettings.html#wxsystemsettings)

```
>>> wx.SystemSettings.GetMetric(wx.SYS_HSCROLL_Y)
16
>>> wx.SystemSettings.GetMetric(wx.SYS_VSCROLL_X)
16 
```

# java - 带有 AXIS 服务器的 JAX-WS 客户端；响应中缺少命名空间

> ID：793397
> 
> 赞同：0
> 
> 时间：2009-04-27T13:02:24.120
> 
> 标签：java, web-services, jax-ws, axis

我遇到了与 JAX-WS 和 AXIS 相关的问题。JAX-WS (2.1.7) 作为客户端，Axis (1.4.x) 作为服务器。

一切正常，但无法将响应读取到 Java。

回复：

```
<?xml version="1.0" encoding="UTF-8"?>
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <soapenv:Body>
  <ns1:myserviceResponse soapenv:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:ns1="http://my/service">
   <ns1:myserviceReturn xsi:type="xsd:string">responsestring</ns1:myserviceReturn>
  </ns1:myserviceResponse>
 </soapenv:Body>
</soapenv:Envelope> 
```

问题在于，如果`ns1:`从 中删除 -namespace 声明`myserviceReturn`，则 JAX-WS 能够返回 null 以外的任何内容。

有没有人知道如何强制 JAX-WS 忽略名称空间，如何手动修改 SOAP 响应以排除“ns1”，或针对此类问题的其他想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-10T22:19:14.143

您需要编写一个不包含名称空间的自定义 WSDL 文件。该文件位于 META-INF 目录中。您可以从您的应用程序现在拥有的默认设置开始，然后将其保存在此处。

# unicode - Java 6 支持的 Unicode 版本

> ID：793402
> 
> 赞同：5
> 
> 时间：2009-04-27T13:04:58.903
> 
> 标签：unicode, java-6

有人知道答案吗？根据[http://java.sun.com/javase/technologies/core/basic/intl/faq.jsp](http://java.sun.com/javase/technologies/core/basic/intl/faq.jsp)，它是 5 的 4.0。它在 6 中升级了吗？参考链接也将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T13:28:13.650

根据 ICU（Unicode 的国际组件），[Java 6 是 Unicode 4](http://site.icu-project.org/home/why-use-icu4j)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-02-15T12:00:48.920

我需要多次了解特定 Java 版本支持的[Unicode 版本](https://en.wikipedia.org/wiki/Unicode#Versions)，为什么不回答其中一个问题，以便下次更容易。所以，一个`7 YEARS LATER`答案：

来自[Java-History 中支持的 Unicode 版本](http://www.herongyang.com/Unicode/Java-Unicode-Version-Supported-in-Java-History.html)，最后更新于 2012 年：

```
Java version   Release date         Unicode version

JDK 1.0        January 23, 1996     Unicode 1.1.5
JDK 1.1        February 19, 1997    Unicode 2.0
JDK 1.1.7      September 12, 1997   Unicode 2.1
J2SE 1.2       December 8, 1998     Unicode 2.1
J2SE 1.3       May 8, 2000          Unicode 2.1
J2SE 1.4       February 6, 2002     Unicode 3.0
J2SE 5.0       September 30, 2004   Unicode 4.0
Java SE 6      December 11, 2006    Unicode 4.0
Java SE 7      July 28, 2011        Unicode 6.0 
```

# JEP

[OpenJDK](https://en.wikipedia.org/wiki/OpenJDK)项目为每个递增 Unicode 的版本发布一个 JEP 文档。

*   [*JEP 128：*](http://openjdk.java.net/jeps/128) Java SE 8 中的 Unicode BCP 47 区域设置匹配。
*   [*JEP 133*](https://openjdk.java.net/jeps/133)[在Java 8](https://en.wikipedia.org/wiki/Java_version_history#Java_SE_8)中增加了对 Unicode 6.2 的支持。
    另请参阅： [JDK 8 中的国际化增强](https://docs.oracle.com/javase/8/docs/technotes/guides/intl/enhancements.8.html)。
*   [*JEP 227*](http://openjdk.java.net/jeps/227)用于在 Java SE 9 中添加[Unicode 7](http://www.unicode.org/versions/Unicode7.0.0/)支持
    [*。JEP 267*](http://openjdk.java.net/jeps/267)也在 Java SE 9 中添加了对 Unicode 8 的支持。
*   [*JEP 314：Java SE 10 中的附加 Unicode 语言标签扩展*](https://openjdk.java.net/jeps/314)。（现在将支持货币类型、一周的第一天、区域覆盖和时区的标签。）
*   [*JEP 327*](https://openjdk.java.net/jeps/327)在 Java SE 11 中添加了[Unicode 10支持。](http://www.unicode.org/versions/Unicode10.0.0/)
*   [*发行说明：对 Unicode 11*](https://bugs.openjdk.java.net/browse/JDK-8213991)的支持解释了 Java 12 中对 Unicode 11 的支持。

清单。

```
Java version   Release date         Unicode version

Java SE  8     2014-03              Unicode  6.2.0
Java SE  9     2017-09              Unicode  7.0 
                                          &  8.0
Java SE 11     2018-09              Unicode 10.0
Java SE 12     2019-03              Unicode 11.0
Java SE 13.0.2                      Unicode 12.1 
```

请参阅 Java 13.0.2[发行说明](https://www.oracle.com/java/technologies/javase/13all-relnotes.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T13:39:01.737

Unicode 5.1在 JDK 7 中的 Java[计划功能列表](http://openjdk.java.net/projects/jdk7/features/#f497)中。在 Java 6 中，它仍然是 Unicode 4.0。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-27T13:10:39.327

IDNA 标准，请参见[此处](http://java.sun.com/developer/technicalArticles/javase/i18n_enhance/)。

# email - 大多数电子邮件客户端是否支持 MHTML？

> ID：793404
> 
> 赞同：1
> 
> 时间：2009-04-27T13:05:46.077
> 
> 标签：email, email-client, mhtml

是否所有现代电子邮件客户端（在线和桌面应用程序）都支持在电子邮件中嵌入图像和其他资源的[MHTML 电子邮件内容？](http://people.dsv.su.se/~jpalme/ietf/mhtml.html)

此外，这是应该用来获得一致的 HTML 电子邮件消息的标准，还是发送带有链接资源的 HTML 电子邮件更好。

注意：我知道[HTML 电子邮件是 EVIL 的 7 个原因，](http://www.georgedillon.com/web/html_email_is_evil.shtml)但在这种情况下它是必不可少的。我还看到了[HTML 电子邮件中关于 css 支持](http://www.campaignmonitor.com/css/)的文章，并且知道这些陷阱。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T13:09:29.360

都很好。MIME 多部分在这一点上非常普遍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T14:48:34.300

是的，请记住，许多客户端默认情况下不会加载图像，以避免将“活动”帐户详细信息泄露给垃圾邮件发送者。

不要指望 JavaScript 能正常工作（有些用户有它并且能工作），但 Outlook/Outlook Express 的 JavaScript 历史很糟糕，而 IIRC 在最近的版本中默认完全阻止了它。

# winforms - 什么是最“轻量级”的winforms控件？

> ID：793411
> 
> 赞同：2
> 
> 时间：2009-04-27T13:07:58.647
> 
> 标签：winforms

（这可能是一个愚蠢的问题和一个 WTF 结合，但这里什么都没有）

我想在我的界面中“绘制”线条或区域 - 通常是 TableLayoutPanel 中的分隔符。目前我所做的只是在行中转储一个面板并将其设置为 Dock=Fill 并为其提供所需的背景颜色。

就在做同样的事情之前，我想知道另一个控件（标签？）是否可能更轻量级。或者也许我应该通过从 Control 继承来推出自己的产品？

还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T13:09:39.593

我将继承`Control`并创建您自己的所有其他控件`Label`，包括`Panel`直接或间接继承自`Control`. 这也允许您将功能与其他功能分开封装。

我还认为您也可以覆盖`Paint`您的事件`TableLayoutPanel`，或从中继承，使其成为您自己的并画线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T13:35:12.073

我会看一下[ControlPaint](http://msdn.microsoft.com/en-us/library/system.windows.forms.controlpaint.aspx)类，它有[几种方法](http://msdn.microsoft.com/en-us/library/system.windows.forms.controlpaint_members.aspx)来绘制线条等，这些方法专门用于绘制类似系统的线条。覆盖绘画事件或按照丹尼尔所说的继承它并在那里画线。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-17T19:34:12.923

这是 Microsoft 开箱即用的解决方案。

查看[Visual Basic PowerPack 3.0](http://msdn.microsoft.com/en-us/vbasic/bb735936.aspx)。不要太担心名称 - 这些是来自 Visual Basic 团队的组件，但它们也适用于 C# 开发人员。

包含的组件之一是`LineShape`，它完全符合您对名称的期望。

如果您的目标是较早版本的框架，您可以将程序集包含在您的应用程序中。但是，如果您的目标是 3.5 SP1 或更高版本，则包含电源组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T13:32:24.313

为什么要自己写？这对我来说似乎是过早的优化。此外，您还需要定义轻量级、内存使用、处理器周期等的含义。如果您真的担心我会从控制中继承的性能，但除非测试显示您当前的解决方案没有，否则我不会走这条路出于某种原因不工作。

# c# - 我可以为 C# 中的匿名类指定一个有意义的名称吗？

> ID：793415
> 
> 赞同：44
> 
> 时间：2009-04-27T13:08:48.847
> 
> 标签：c#, .net, c#-3.0, anonymous-class

我们都知道，当我们像这样创建一个匿名类时：

```
var Employee = new { ID = 5, Name= "Prashant" }; 
```

...在运行时它将是以下类型：

```
<>f__AnonymousType0<int,string> 
```

有没有办法为这些类指定一个有意义的名称？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-04-27T13:10:17.830

```
public class Employee {} 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-04-27T13:12:07.747

这是一种匿名类型，违背了目的。这些对象被设计为临时的。地狱，这些属性甚至是只读的。

对不起，我是个聪明人。答案是否定的，没有办法告诉编译器为匿名类型使用什么名称。

事实上，编译器生成的类型名称在其命名中使用了非法字符，因此您的应用程序中不会出现名称冲突。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-04-27T13:12:38.960

```
public class Employee {
    public int ID { get; set; }
    public string Name { get; set; }
} 
```

然后使用以下语法

```
var employee = new Employee { ID = 5, Name = "Prashant" }; 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-04-27T13:10:05.630

让它成为一个有名字的普通班级？

```
public class Employee
{
    public int ID;
    public string Name;
}

var Employee = new Employee { ID = 5, Name= "Prashant" }; 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2009-04-27T13:26:55.463

实际上，如果您不害怕变得非常琐碎，您可以使用 TypeBuilder 根据您的匿名类型构建您自己的运行时类型，这将允许您指定类型的名称。当然，像这个线程中几乎所有其他人所建议的那样，只声明一个类要容易得多，但是 TypeBuilder 的方式要令人兴奋得多。;)

[类型生成器](http://msdn.microsoft.com/en-us/library/system.reflection.emit.typebuilder.aspx)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-06-28T22:41:08.907

Java World 中的答案将是[本地类](http://docstore.mik.ua/orelly/java-ent/jnut/ch03_11.htm)（在方法中定义），而 C# 中没有。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-27T13:15:49.390

是的，您正在创建一个**Anonymous Class**，如果您希望您的类有一个名称，即**Not Anonymous**，那么声明一个常规类或结构。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-27T13:18:33.270

由于它是匿名的，因此您无法命名它。如果您需要知道类型的名称，那么您必须真正创建一个类。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-04-27T13:20:21.970

不，没有办法给这些类一个有意义的类型名称，因为你已经声明了它们。匿名类型就是这样，匿名的。如果不求助于非常丑陋的黑客，就没有办法在代码中明确地“命名”类型。

如果您确实需要为类型命名，则需要显式声明并使用具有所需属性的新类型。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-27T13:14:00.410

我认为，根据定义，匿名类型不能有一个名字，只有编译器给它的名字。如果您正在寻找有关匿名类型的更有意义的设计时信息，那么您对编译器的期望过高。

# java - 我可以保证在 Java 中运行静态初始化程序的顺序吗？

> ID：793422
> 
> 赞同：5
> 
> 时间：2009-04-27T13:10:11.073
> 
> 标签：java, inheritance, static, initialization, static-initializer

我有一个 Set 类（这是 J2ME，所以我对标准 API 的访问权限有限；只是为了解释我明显的轮子改造）。我正在使用我的集合类在类和子类中创建常量集合。有点像这样...

```
class ParentClass
{
    protected final static Set THE_SET = new Set() {{
        add("one");
        add("two");
        add("three");
    }};
}

class SubClass extends ParentClass
{
    protected final static Set THE_SET = new Set() {{
        add("four");
        add("five");
        add("six");
        union(ParentClass.THE_SET); /* [1] */
    }};
} 
```

一切看起来都很好，除了 [1] 处的行导致空指针异常。大概这意味着子类中的静态初始化器在父类之前运行。这让我感到惊讶，因为我认为它会先在任何新导入中运行静态块，然后再在实例化子类中运行任何块。

我的这个假设是对的吗？有没有办法控制或解决这种行为？

**更新：**

事情就更奇怪了。我尝试了这个（注意'new ParentClass（）'行）：

```
class ParentClass
{
    public ParentClass()
    {
        System.out.println(THE_SET);
    }

    protected final static Set THE_SET = new Set() {{
        add("one");
        add("two");
        add("three");
    }};
}

class SubClass extends ParentClass
{
    protected final static Set THE_SET = new Set() {{
        System.out.println("a");
        new ParentClass();
        System.out.println("b");
        add("four");
        System.out.println("c");
        add("five");
        System.out.println("d");
        add("six");
        System.out.println("e");
        union(ParentClass.THE_SET); /* [1] */
        System.out.println("f");
    }};
} 
```

输出很奇怪：

```
a
["one", "two", "three"]
b
c
d
e
Exception in thread "main" java.lang.ExceptionInInitializerError
Caused by: java.lang.NullPointerException 
```

因此 ParentClass 已初始化，但子类在其静态初始化程序中无权访问它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T13:32:31.597

这是你想要完成的吗？还是您需要 Set 接口的本地实现？

```
class ParentClass
{
    protected final static Set THE_SET;

    static {
        THE_SET = new HashSet();
        THE_SET.add("one");
        THE_SET.add("two");
        THE_SET.add("three");
    }
}

class SubClass extends ParentClass
{
    protected final static Set THE_SECOND_SET;

    static {
        THE_SECOND_SET = new HashSet();
        THE_SECOND_SET.add("four");
        THE_SECOND_SET.add("five");
        THE_SECOND_SET.add("six");
        union(ParentClass.THE_SET); /* [1] */
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T13:11:28.123

不能保证类之间的静态初始值设定项顺序。在一个类中，它们按照源代码的顺序运行。

*如果你仔细想想，类之间*真的不可能有顺序，因为你也无法控制何时加载类；您可能会动态加载一个类，或者 JVM 可能会优化加载顺序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T13:31:59.210

即使你`extends ParentClass`在那里没有，使用`ParentClass`应该会导致它被初始化。

当你有周期时，事情变得棘手。使用循环可以在完全初始化之前访问一个类。由于 Java 是一个多线程系统，因此您也可能遇到死锁和竞争问题。

可能是您的 Java ME 实现有问题（并非闻所未闻）。部分您的完整`ParentClass`参考您的`ChildClass`. 或者也许还有其他一些应用程序/库错误。

在相关说明中，如果您不这样做`-target 1.4`或稍后，内部类的外部 this 不会像您预期的那样初始化。如前所述，您的代码在静态上下文中使用（技术上）内部类，因此这应该不是问题。

另外有趣的是，静态初始化在这种情况下会有些混乱，因为您实际上有四个类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T13:57:13.083

只需停止滥用匿名类的概念来进行实例初始化（所谓的“双括号习语”）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T13:36:22.790

鉴于 ["one", "two", "three"] 的输出行，ParentClass.THE_SET 基本上不可能从未初始化过。

当然，可能不仅涉及一个类加载器，但查看空指针发生的方法和行号肯定会有所帮助。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-27T18:36:55.577

我认为类似的东西写在 Java 谜题书或谷歌关于 Java 技巧的 YouTube 视频中。

# wpf - 从代码访问 XAML 对象

> ID：793428
> 
> 赞同：1
> 
> 时间：2009-04-27T13:11:44.313
> 
> 标签：wpf, xaml

我在 WPF 中创建了一个 UserControl：

在 Xaml 中：

```
<UserControl x:Class="OutlookPanel.MailRelation"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="300" Width="300"
    xmlns:graph="clr-namespace:MyPanel"
>
 <DockPanel>
<graph:Graph Name="theGraph" NodesBindingPath="ChildNodes"
               NodeTemplateSelector="{StaticResource nodeTemplateSelector}">
..
 </DockPanel>
</UserControl> 
```

我的cs：

```
object theThing = e.Parameter;
                    ((MailRelation)sender).theGraph.CenterObject = theThing; 
```

最后一句不起作用，因为无法访问图表。知道为什么我可以访问 theGraph 吗？

谢谢

约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T13:27:43.667

名称="theGraph"

应该

x:Name="theGraph"

来自[http://msdn.microsoft.com/en-us/library/ms752059.aspx](http://msdn.microsoft.com/en-us/library/ms752059.aspx)

> x:Name：为对象元素处理后存在于运行时代码中的实例指定运行时对象名称。对于不支持等效 WPF 框架级 Name 属性的命名元素的情况，您可以使用 x:Name。这发生在某些动画场景中。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-04-27T13:17:07.203

可能是因为该财产是私有的。提供一个公共吸气剂，你应该能够得到它。在您的代码中，添加类似

```
 public Graph TheGraph  { get { return theGraph; } } 
```

# jquery - 如何用jQuery选择和替换整个页面

> ID：793436
> 
> 赞同：11
> 
> 时间：2009-04-27T13:14:07.117
> 
> 标签：jquery, jquery-selectors, css-selectors

我的页面设计迫使我使用通过 ajax 加载的 html 刷新整个页面。

`$('html').replaceWith(data);`

给我错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-10-30T18:12:01.697

我有同样的问题，但这没有帮助。如果您还需要替换`<head>`标签（所以，整个页面），您也可以这样做

```
document.write(newPage); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-27T13:15:34.383

使用身体：

```
$('body').replaceWith(data); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-10-24T10:08:51.383

我有一些问题

```
$("body").replaceWith(newPage) 
```

给了我一些奇怪的css问题，但这很好用：

```
$("body").html(newPage); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-04-28T09:49:12.657

这可能是您需要的解决方案，**它替换了整个文档，包括它的 head**。加载新的 css、js 和其他资源不会有任何问题。我假设您通过调用 REST api 收到新的 html 内容：

```
$.ajax({
  type: 'POST',
  url: form.attr('action'),
  data: form.serialize(), // serializes form elements
  success: function(response) {
    // re-writes the entire document
    var newDoc = document.open("text/html", "replace");
    newDoc.write(response);
    newDoc.close();
  }
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-07-12T20:49:12.530

使用“body”选择器执行时 jQuery.replaceWith 和 jQuery.html 的奇怪行为。您在通话后松开 body 标签：

```
$('body').replaceWith('<body>New body</body>'); 
```

任何其他选择器都不会发生这种情况：

```
$('title').replaceWith('<title>New title</title>'); 
```

jQuery.html 也不会加倍 body 标签（就像它对其他标签所做的那样），并且在像这样调用时像 replaceWith 一样操作：

```
$('body').html('<body>New body</body>'); 
```

我希望这不是 jQuery 的灰色地带。或者，如果是，他们不认为要修复它。我有应用程序，当应该使用 $('body').replaceWith 时，我使用 $('body').html。

# javascript - 从文本框中获取整数值，如何检查它是 NaN 还是 null 等？

> ID：793445
> 
> 赞同：7
> 
> 时间：2009-04-27T13:15:40.437
> 
> 标签：javascript, numbers, nan

我正在通过 JavaScript 从文本框中提取一个值。如果文本框为空，则返回`NaN`. 如果它为空、空等，我想返回一个空字符串。

我要做什么检查？`if(NAN = tb.value)`?

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-27T13:52:25.870

嗯，这里有些不对劲。

在哪个浏览器中，空文本框返回 NaN？我从未见过这种情况发生，我无法重现它。

文本框的值实际上是一个字符串。空文本框返回空字符串！

哦，要检查某些东西是否为 NaN，您应该使用：

```
if (isNaN(tb.value))
{
   ...
} 
```

注意：`isNaN()`-function 返回`true`任何不能被解析为数字的东西，除了空字符串。这意味着它可以很好地检查数字输入（比正则表达式容易得多）：

```
if (tb.value != "" && !isNaN(tb.value))
{
   // It's a number
   numValue = parseFloat(tb.value);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T14:17:42.597

你也可以这样做：

```
var number = +input.value;
if (input.value === "" || number != number)
{
    // not a number
} 
```

NaN 等于无，甚至不等于它自己。

如果您不喜欢使用 + 将 String 转换为 Number，请使用普通的 parseInt，但请记住始终给出一个基数

```
var number = parseInt(input.value, 10) 
```

否则 "08" 变为 0，因为 Javascript 认为它是八进制数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T14:39:56.240

假设您有对输入文本框的引用：

```
function getInteger(input) {
  if(!input || !input.value) return "";

  var val = parseInt(input.value, 10);

  if(isNaN(val)) return "";
  else return val;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T13:18:31.910

您可以做的一件事是对文本框的值进行正则表达式检查，并确保它符合接受数字的格式，然后如果符合格式则执行您的过程，否则返回一个空字符串。

**编辑**：这是我面前的一些代码的一个例子（可能不是最好的正则表达式）：

```
var anum=/(^\d+$)/;

if (!anum.test(document.getElementById("<%=txtConceptOrderValue.ClientID %>").value))
{
    alert("Order Value must be a valid integer");
    document.getElementById("<%=txtConceptOrderValue.ClientID %>").focus();
    return false;
} 
```

**编辑 2**：我还应该注意，我使用的是 ASP.NET，这就是为什么我有一种有点时髦的方式来访问文本框。在您的常规 JavaScript 案例中，它可能不会那么混乱。

# c - C中函数指针的递归声明

> ID：793449
> 
> 赞同：22
> 
> 时间：2009-04-27T13:17:15.550
> 
> 标签：c, c89

我想声明一个函数，该函数返回指向同一类型函数的指针。

我想用它来实现如下状态机：

```
typedef event_handler_t (*event_handler_t)(event_t*); // compilation error

event_handler_t state2(event_t* e);
event_handler_t state1(event_t* e) {
    switch(e->type) {
    //...
    case SOME_EVENT:
        return state2;
    //...
    }

}
event_handler_t state2(event_t* e) {
    switch(e->type) {
    //...
    case OTHER_EVENT:
        return state1;
    //...
    }   
}

//...
event_handler_t event_handler;
//...
event_handler(&e);
//... 
```

我设法使用如下结构解决编译错误：

```
typedef struct event_handler {
    struct event_handler (*func)(event_t *);
} event_handler_t; 
```

但这使得 return 语句更加复杂：

```
event_handler_t state2(event_t* e) {
{
    event_handler_t next_handler = {NULL};
    switch(e->type) {
    //...
    case OTHER_EVENT:
        next_handler.func = state1;
        break;
    //...
    } 
    return next_handler;
} 
```

我想知道是否有更好的方法在 c 中创建这样的函数指针。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T13:24:23.207

在 C 中不可能做到这一点：函数不能返回指向自身的指针，因为类型声明递归地扩展并且永远不会结束。有关说明，请参阅此页面：[http ://www.gotw.ca/gotw/057.htm](http://www.gotw.ca/gotw/057.htm)

上述页面上描述的解决方法意味着返回`void (*) ()`而不是正确类型的函数指针；你的解决方法可以说是有点整洁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T13:25:34.780

Herb Sutter 的《**More Exceptional C++**》第 32 条对此进行了讨论，其中的答案似乎是（对于 C）“并非不使用强制转换”。对于 C++，通常引入一个类来提供一些额外的间接性是可能的。

# mysql - mysql中的条件循环

> ID：793458
> 
> 赞同：0
> 
> 时间：2009-04-27T13:21:13.607
> 
> 标签：mysql, stored-procedures

在 MySQL 中，我编写了一个过程，我想在其中运行这样的循环：

```
While (Cond) Do
  ...(Body1)
  ...
  If (Condition2)
    continue ;

  ...(Body2)
  ...
end while ; 
```

在 while 循环下，我希望在不满足 Condition2 的情况下运行**整个主体（即 Body1 和 Body2）。**

目前，当条件2满足时，它只是执行Body1然后继续（在While中检查Cond并继续循环。）

有人可以帮助使用正确的语法来执行上述操作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T13:29:56.097

```
BEGIN
    WHILE cond1 DO
        CALL body1;
        IF (NOT cond2) THEN
            CALL body2;
        END IF;
    END WHILE;
END; 
```

# asp.net-mvc - 如何在 ASP.NET MVC 控制器中设置小数点分隔符？

> ID：793459
> 
> 赞同：23
> 
> 时间：2009-04-27T13:21:49.983
> 
> 标签：asp.net-mvc, globalization

我正在使用[NerdDinner](http://www.codeplex.com/nerddinner)应用程序，试图自学 ASP.NET MVC。但是，我偶然发现了一个全球化问题，我的服务器以逗号作为小数分隔符显示浮点数，但虚拟地球地图要求它们带有点，这会导致一些问题。

我已经[在我的视图中解决了映射 JavaScript 的问题](https://stackoverflow.com/questions/760258/how-to-globalize-asp-net-mvc-views-decimal-separators-in-particular)，但是如果我现在尝试使用点作为小数分隔符发布已编辑的晚餐条目，则控制器`InvalidOperationException`在更新模型（在方法中）时会失败（抛出`UpdateModel()`）。我觉得我也必须在控制器的某个地方设置适当的文化，我尝试过，`OnActionExecuting()`但没有帮助。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2011-02-25T12:51:14.377

我刚刚在一个真实的项目中重新审视了这个问题，终于找到了一个可行的解决方案。正确的解决方案是为该类型提供一个自定义模型绑定器`decimal`（`decimal?`如果您正在使用它们）：

```
using System.Globalization;
using System.Web.Mvc;

public class DecimalModelBinder : DefaultModelBinder
{
    public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        object result = null;

        // Don't do this here!
        // It might do bindingContext.ModelState.AddModelError
        // and there is no RemoveModelError!
        // 
        // result = base.BindModel(controllerContext, bindingContext);

        string modelName = bindingContext.ModelName;
        string attemptedValue = bindingContext.ValueProvider.GetValue(modelName)?.AttemptedValue;

        // in decimal? binding attemptedValue can be Null
        if (attemptedValue != null)
        {
            // Depending on CultureInfo, the NumberDecimalSeparator can be "," or "."
            // Both "." and "," should be accepted, but aren't.
            string wantedSeperator = NumberFormatInfo.CurrentInfo.NumberDecimalSeparator;
            string alternateSeperator = (wantedSeperator == "," ? "." : ",");

            if (attemptedValue.IndexOf(wantedSeperator, StringComparison.Ordinal) == -1
                && attemptedValue.IndexOf(alternateSeperator, StringComparison.Ordinal) != -1)
            {
                attemptedValue = attemptedValue.Replace(alternateSeperator, wantedSeperator);
            }

            try
            {
                if (bindingContext.ModelMetadata.IsNullableValueType && string.IsNullOrWhiteSpace(attemptedValue))
                {
                    return null;
                }

                result = decimal.Parse(attemptedValue, NumberStyles.Any);
            }
            catch (FormatException e)
            {
                bindingContext.ModelState.AddModelError(modelName, e);
            }
        }

        return result;
    }
} 
```

然后在 Application_Start() 中的 Global.asax.cs 中：

```
ModelBinders.Binders.Add(typeof(decimal), new DecimalModelBinder());
ModelBinders.Binders.Add(typeof(decimal?), new DecimalModelBinder()); 
```

请注意，代码不是我的，我实际上是在 Kristof Neirynck 的博客上[找到](http://www.crydust.be/blog/2009/07/30/custom-model-binder-to-avoid-decimal-separator-problems/)的。我刚刚编辑了几行并添加了特定数据类型的活页夹，而不是替换默认活页夹。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-27T13:32:23.297

在你的 web.config 中设置它

```
 <system.web>
    <globalization uiCulture="en" culture="en-US" /> 
```

您似乎正在使用使用逗号而不是小数位的语言设置的服务器。您可以将文化调整为以您的应用程序设计方式使用逗号的文化，例如 en-US。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T14:03:17.577

你能用不变的文化解析文本吗？抱歉，我的前面没有 NerdDinner 代码，但是如果你传递点分隔的小数，那么如果你告诉它使用不变的文化，解析应该没问题. 例如

```
 float i = float.Parse("0.1", CultureInfo.InvariantCulture); 
```

**编辑**. 顺便说一句，我怀疑这是 NerdDinner 代码中的一个错误，与您之前的问题相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-11T20:49:54.230

我对此有不同的看法，你可能会喜欢它。我不喜欢接受的答案是它不检查其他字符。我知道会有货币符号出现在框中的情况，因为我的用户不知道更好。所以是的，我可以签入 javascript 来删除它，但是如果由于某种原因 javascript 没有打开怎么办？然后额外的字符可能会通过。或者，如果有人试图通过未知字符向您发送垃圾邮件……谁知道呢！所以我决定使用正则表达式。它有点慢，慢了一点点 - 就我而言，正则表达式的 1,000,000 次迭代只用了不到 3 秒，而在昏迷和句点上进行字符串替换大约需要 1 秒。但鉴于我不知道可能会出现哪些角色，所以我为这最轻微的性能打击感到高兴。

```
public class DecimalModelBinder : DefaultModelBinder
{
    public override object BindModel(ControllerContext controllerContext,
                                     ModelBindingContext bindingContext)
    {
        string modelName = bindingContext.ModelName;
        string attemptedValue =
            bindingContext.ValueProvider.GetValue(modelName).AttemptedValue;

        if (bindingContext.ModelMetadata.IsNullableValueType
                && string.IsNullOrWhiteSpace(attemptedValue))
        {
            return null;
        }

        if (string.IsNullOrWhiteSpace(attemptedValue))
        {
            return decimal.Zero;
        }

        decimal value = decimal.Zero;
        Regex digitsOnly = new Regex(@"[^\d]", RegexOptions.Compiled);
        var numbersOnly = digitsOnly.Replace(attemptedValue, "");
        if (!string.IsNullOrWhiteSpace(numbersOnly))
        {
            var numbers = Convert.ToDecimal(numbersOnly);
            value = (numbers / 100m);

            return value;
        }
        else
        {
            if (bindingContext.ModelMetadata.IsNullableValueType)
            {
                return null;
            }

        }

        return value;
    }
} 
```

基本上，对于非空字符串，删除**所有**不是数字的字符。转换为十进制。除以 100。返回结果。

为我工作。

# php - php array_merge 不删除值？

> ID：793464
> 
> 赞同：14
> 
> 时间：2009-04-27T13:22:27.877
> 
> 标签：php, arrays, merge

**背景：** Trevor 正在使用标准算法的 PHP 实现：获取一组主要的默认名称-值对，并更新这些名称-值对，但仅适用于实际存在有效更新值的那些名称-值对。

**问题：**默认情况下，PHP array_merge 是这样工作的……它会用空白值覆盖非空白值。

```
$aamain   =   Array('firstname'=>'peter','age'=>'32','nation'=>'');
$update   =   Array('firstname' => '','lastname' => 'griffin', age =>'33','nation'=>'usa');

print_r(array_merge($aamain,$update));    
/*
Array
(
    [firstname] =>           // <-- update set this to blank, NOT COOL!
    [age] => 33              // <-- update set this to 33, thats cool
    [lastname] => griffin    // <-- update added this key-value pair, thats cool
    [nation] => usa          // <-- update filled in a blank, thats cool.
)
*/ 
```

**问题：**在空白值永远不会覆盖已经存在的值的情况下，执行 array_merge 的代码行最少的方法是什么？

```
print_r(array_coolmerge($aamain,$update));    
/*
Array
(
    [firstname] => peter  // <-- don't blank out a value if one already exists!
    [age] => 33
    [lastname] => griffin
    [nation] => usa

)
*/ 
```

**更新：** 2016-06-17T11:51:54 更新了问题，澄清了上下文并重命名了变量。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-27T13:55:55.677

好吧，如果你想要一种“聪明”的方式来做到这一点，就在这里，但它可能不像简单地循环那样可读。

```
$merged = array_merge(array_filter($foo, 'strval'), array_filter($bar, 'strval')); 
```

编辑：或使用 +...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T14:14:00.203

试试这个：

```
$merged = array_map(
    create_function('$foo,$bar','return ($bar?$bar:$foo);'),
    $foobar,$feebar
); 
```

不是最易读的解决方案，但它应该只替换非空值，无论数组传递的顺序如何..

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-03-14T14:20:07.673

```
array_replace_recursive($array, $array2); 
```

这就是解决方案。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-27T14:14:15.257

根据您的需要进行调整：

```
# Replace keys in $foo
foreach ($foo as $key => $value) {
    if ($value != '' || !isset($bar[$key])) continue;
    $foo[$key] = $bar[$key];
}

# Add other keys in $bar
# Will not overwrite existing keys in $foo
$foo += $bar; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T13:35:12.510

这会将重复项放入一个新数组中，但我不知道这是否是您想要的。

```
<?php
  $foobar =   Array('firstname' => 'peter','age' => '33',);
  $feebar =   Array('firstname' => '','lastname' => 'griffin',);
  $merged=$foobar;
  foreach($feebar as $k=>$v){
    if(isset($foobar[$k]))$merged[$k]=array($v,$foobar[$k]);
    else $merged[$k]=$v;
  }
  print_r($merged);
?> 
```

这将简单地确保feebar 永远不会清除foobar 中的值：

```
<?php
  $foobar =   Array('firstname' => 'peter','age' => '33',);
  $feebar =   Array('firstname' => '','lastname' => 'griffin',);
  $merged=$foobar;
  foreach($feebar as $k=>$v) if($v)$merged[$k]=$v;
  print_r($merged);
?> 
```

或者当然，

```
<?
  function cool_merge($array1,$array2){
    $result=$array1;
    foreach($array2 as $k=>$v) if($v)$result[$k]=$v;
    return $result;
  }

  $foobar =   Array('firstname' => 'peter','age' => '33',);
  $feebar =   Array('firstname' => '','lastname' => 'griffin',);
  print_r(cool_merge($foobar,$feebar));
?> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-09-29T09:12:56.043

如果您还想保留两个数组中的空白值：

```
array_filter($foo) + array_filter($bar) + $foo + $bar 
```

# jakarta-ee - struts在实时项目中属于三层架构的哪一层

> ID：793467
> 
> 赞同：1
> 
> 时间：2009-04-27T13:24:13.800
> 
> 标签：jakarta-ee, struts2

在实时项目的三层架构中，struts 属于哪里？请问我需要解释吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-29T01:45:09.320

什么是三轮胎架构？

在 3 层中，应用程序逻辑（或）进程位于中间层，它与数据和用户界面分离。三层系统更具可扩展性、健壮性和灵活性。此外，他们可以整合来自多个来源的数据。在三层架构中，在用户系统界面客户端环境和数据库管理服务器环境之间增加了一个中间层。有多种方法可以实现这个中间层，例如事务处理监视器、消息服务器或应用程序服务器。中间层可以执行排队、应用程序执行和数据库暂存。例如，如果中间层提供排队，客户端可以将其请求传递给中间层并退出，因为中间层将访问数据并将答案返回给客户端。最基本的三层架构类型具有由事务处理（TP）监控技术组成的中间层。TP 监视器技术是一种消息队列、事务调度和优先级服务，其中客户端连接到 TP 监视器（中间层）而不是数据库服务器。事务被监视器接受，它将它排队，然后负责管理它以完成，从而释放客户端。客户端连接到 TP 监视器（中间层）而不是数据库服务器的优先级服务。事务被监视器接受，它将它排队，然后负责管理它以完成，从而释放客户端。客户端连接到 TP 监视器（中间层）而不是数据库服务器的优先级服务。事务被监视器接受，它将它排队，然后负责管理它以完成，从而释放客户端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-11T19:13:50.007

Wrt应用项目的架构struts是通常用于表示层的框架，jsp和servlet是同一技术。来到服务层，EJB是技术，Spring是框架，在数据访问层，JDBC和JPA是技术，Hibernate是框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T13:33:46.633

Struts 是一个完整的框架，实际上并不仅仅是典型的“三层”架构（表示、应用程序和数据存储）中的一层。

Struts 将在 Java 领域为您提供一个 MVC 框架。您将能够更好地划分表示层、应用程序层和数据持久性，而不是将它们混合在一起。

# c++ - 如何强制编译器使用显式复制构造函数？

> ID：793469
> 
> 赞同：4
> 
> 时间：2009-04-27T13:24:22.537
> 
> 标签：c++

我用一个包含自定义构造函数、析构函数、复制构造函数和赋值运算符的示例类编写了一个小型测试程序。当我意识到根本没有调用复制构造函数时，我感到很惊讶，即使我使用类的返回值和行之类的函数实现了函数`Object o1; Object o2(o1);`

内部类.hpp：

```
#include <iostream>

class OuterClass
{
public:
OuterClass()
{
    std::cout << "OuterClass Constructor" << std::endl;
}
~OuterClass()
{
    std::cout << "OuterClass Destructor" << std::endl;
}
OuterClass(const OuterClass & rhs)
{
    std::cout << "OuterClass Copy" << std::endl;
}
OuterClass & operator=(const OuterClass & rhs)
{
    std::cout << "OuterClass Assignment" << std::endl;
}

class InnerClass
{
public:
    InnerClass() : m_int(0)
    {
        std::cout << "InnerClass Constructor" << std::endl;
    }
    InnerClass(const InnerClass & rhs) : m_int(rhs.m_int)
    {
        std::cout << "InnerClass Copy" << std::endl;
    }
    InnerClass & operator=(const InnerClass & rhs)
    {
        std::cout << "InnerClass Assignment" << std::endl;
        m_int = rhs.m_int;
        return *this;
    }
    ~InnerClass()
    {
        std::cout << "InnerClass Destructor" << std::endl;
    }
    void sayHello()
    {
        std::cout << "Hello!" << std::endl;
    }

private:
    int m_int;
};

InnerClass innerClass()
{
    InnerClass ic;
    std::cout << "innerClass() method" << std::endl;
    return ic;
}
}; 
```

内部类.cpp：

```
#include "innerclass.hpp"

int main(void)
{
std::cout << std::endl << "1st try:" << std::endl;

OuterClass oc;
OuterClass oc2(oc);
oc.innerClass().sayHello();

std::cout << std::endl << "2nd try:" << std::endl;

OuterClass::InnerClass ic(oc.innerClass());
ic = oc.innerClass();
} 
```

输出：

```
 1st try:
 OuterClass Constructor
 OuterClass Copy
 InnerClass Constructor
 innerClass() method
 Hello!
 InnerClass Destructor

 2nd try:
 InnerClass Constructor
 innerClass() method
 InnerClass Constructor
 innerClass() method
 InnerClass Assignment
 InnerClass Destructor
 InnerClass Destructor
 OuterClass Destructor
 OuterClass Destructor 
```

经过一些研究，我读到不能保证编译器会使用明确定义的复制构造函数。我不明白这种行为。如果我们不知道它被调用，为什么还要存在复制构造函数呢？编译器如何决定是否使用它？

或者，更好的是，有没有办法强制编译器使用自定义的复制构造函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T17:39:43.983

只是为了其他答案的完整性，该标准允许编译器在某些情况下省略复制构造函数（其他答案称为“返回值优化”或“命名返回值优化” - RVO/NRVO）：

> 12.8 复制类对象，第 15 段 (C++98)
> 
> 每当使用复制构造函数复制临时类对象，并且此对象和副本具有相同的 cv 非限定类型时，允许实现将原始类对象和副本视为引用同一对象的两种不同方式而不执行即使类复制构造函数或析构函数有副作用，也完全是一个副本。对于具有类返回类型的函数，如果返回语句中的表达式是本地对象的名称，并且本地对象的 cv-unqualified 类型与函数返回类型相同，则允许实现省略创建保存函数返回值的临时对象，即使类复制构造函数或析构函数有副作用。在这些情况下，

因此，在您的`innerClass()`方法中，您可能认为会在返回时调用的复制构造函数被允许优化掉：

```
InnerClass innerClass() {
    InnerClass ic;
    std::cout << "innerClass() method" << std::endl;
    return ic;    // this might not call copy ctor
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T13:31:55.733

您不应该依赖在特定情况下调用（或不调用）复制构造函数来设计您的类。允许编译器在各种地方省略或添加复制构造函数调用，您真的不想跟踪它们。

至于你为什么需要一个 - 好吧，编译器可能会决定它需要一个副本，而复制构造函数就是它用来这样做的。省略复制构造函数调用的优点是性能 - 复制通常是一项非常昂贵的操作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-27T13:33:44.713

我同意尼尔的观点，你不应该编写一个依赖于被调用的复制构造函数的类。即因为编译器可以执行诸如“命名返回值优化”（[链接](http://msdn.microsoft.com/en-us/library/ms364057(VS.80).aspx)）之类的事情，这在许多返回值场景中完全避免了复制构造函数。为了强制调用复制构造函数，您需要编写大量旨在“欺骗”C++ 编译器的代码。不是一个好主意。

但在特定情况下，如果您想强制调用复制构造函数，您可以进行显式调用。

```
Object SomeFunc() {
  Object o1 = ...
  return Object(o1);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T14:09:14.037

这是问题吗？

```
OuterClass(const OuterClass & rhs)
{        
std::cout << "OuterClass Constructor" << std::endl;  
==>
std::cout << "OuterClass Copy Constructor" << std::endl;

}

OuterClass & operator=(const OuterClass & rhs)
{       
 std::cout << "OuterClass Constructor" << std::endl;
==>
 std::cout << "OuterClass Assignment operator" << std::endl;
} 
```

复制粘贴错误！

我建议你调试一次代码，看看到底发生了什么。调试确实可以帮助您发现问题。

**编辑：**对于内部类问题：

正如其他人已经指出的那样，这是*名称返回值优化*(NRVO) 的情况。

```
InnerClass innerClass()
{    
    InnerClass ic;        
     std::cout << "innerClass() method" << std::endl;        
   return ic;
} 
```

编译器可以将函数转换为

```
void innerClass( InnerClass &namedResult)

{
std::cout << "innerClass() method" << std::endl;  

 } 
```

因此，它消除了类对象的按值返回和调用类复制构造函数的需要。

请通过以下两个链接了解更多关于 NRVO 的信息：

*   [MSDN NRVO](http://msdn.microsoft.com/en-us/library/ms364057%28VS.80%29.aspx)
*   [斯坦·李普曼的博客](http://blogs.msdn.com/slippman/archive/2004/02/03/66739.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T13:32:30.193

`Object o1();`不创建任何对象，而是定义了一个函数原型，函数名为 o1，参数为 void，返回类型为 Object。您需要发布一些代码才能找到实际问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T13:38:18.463

贴一些代码。我认为您使用了一些不正确的语法。

复制构造函数必须完全具有以下签名：

```
MyObject(const MyObject&) 
```

然后可以查看是否使用以下代码调用了复制构造函数：

```
MyObject m1;
MyObject m2(m1); 
```

你不能使用`MyObject m1();`那是一个函数声明。

# php - 使用一个具有可变数量输入变量的 bind_param()

> ID：793471
> 
> 赞同：10
> 
> 时间：2009-04-27T13:24:47.373
> 
> 标签：php, mysqli

我尝试像这样使用变量绑定：

```
$stmt = $mysqli->prepare("UPDATE mytable SET myvar1=?, myvar2=... WHERE id = ?")) {
$stmt->bind_param("ss...", $_POST['myvar1'], $_POST['myvar2']...); 
```

但有些 $_POST['...'] 可能是空的，所以我不想在数据库中更新它们。

考虑空 $_POST['...'] 的所有不同组合是不切实际的，尽管我可以根据需要构建字符串“UPDATE mytable SET...”，但 bind_param() 是另一种野兽。

我可以尝试将其调用构建为字符串并在其上使用 eval() 但感觉不对:(

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-27T13:41:14.510

您可以使用该[`call_user_func_array`](http://docs.php.net/manual/en/function.call-user-func-array.php)函数调用`bind_param`带有变量编号或参数的方法：

```
$paramNames = array('myvar1', 'myvar2', /* ... */);
$params = array();
foreach ($paramNames as $name) {
    if (isset($_POST[$name]) && $_POST[$name] != '') {
        $params[$name] = $_POST[$name];
    }
}
if (count($params)) {
    $query = 'UPDATE mytable SET ';
    foreach ($params as $name => $val) {
        $query .= $name.'=?,';
    }
    $query = substr($query, 0, -1);
    $query .= 'WHERE id = ?';
    $stmt = $mysqli->prepare($query);
    $params = array_merge(array(str_repeat('s', count($params))), array_values($params));
    call_user_func_array(array(&$stmt, 'bind_param'), $params);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T13:38:12.440

这就是我用可变数量的参数来做 mysqli 准备语句的方法。这是我写的课程的一部分。对于您需要的东西来说，它可能是矫枉过正，但它应该向您展示正确的方向。

```
public function __construct($con, $query){
    $this->con = $con;
    $this->query = $query;
    parent::__construct($con, $query);
    //We check for errors:
    if($this->con->error) throw new Exception($this->con->error);
}

protected static $allowed = array('d', 'i', 's', 'b'); //allowed types

protected static function mysqliContentType($value) {
    if(is_string($value)) $type = 's';
    elseif(is_float($value)) $type = 'd';
    elseif(is_int($value)) $type = 'i';
    else throw new Exception("type of '$value' is not string, int or float");
    return $type;
}

//This function checks if a given string is an allowed mysqli content type for prepared statement (s, d, b, or i)
protected static function mysqliAllowedContentType($s){
    return in_array($s, self::$allowed);
}

public function feed($params){
    //These should all be empty in case this gets used multiple times
    $this->paramArgs = array();
    $this->typestring = '';
    $this->params = $params;
    $this->paramArgs[0] = '';
    $i = 0;
    foreach($this->params as $value){
        //We check the type:
        if(is_array($value)){
            $temp = array_keys($value);
            $type = $temp[0];
            $this->params[$i] = $value[$type];
            if(!self::mysqliAllowedContentType($type)){
                $type = self::mysqliContentType($value[$type]);
            }
        }
        else{
            $type = self::mysqliContentType($value);
        }
        $this->typestring .= $type;
        //We build the array of values we pass to the bind_params function
        //We add a refrence to the value of the array to the array we will pass to the call_user_func_array function. Thus say we have the following
        //$this->params array:
            //$this->params[0] = 'foo';
            //$this->params[1] = 4;
        //$this->paramArgs will become: 
            //$this->paramArgs[0] = 'si'; //Typestring
            //$this->paramArgs[1] = &$this->params[0];
            //$this->paramArgs[2] = &$this->params[1].
        //Thus using call_user_func_array will call $this->bind_param() (which is inherented from the mysqli_stmt class) like this:
            //$this->bind_param( 'si', &$this->params[0], &$this->params[1] );
        $this->paramArgs[] = &$this->params[$i];
        $i++;
    }
    unset($i);
    $this->paramArgs[0] = $this->typestring;
    return call_user_func_array(array(&$this, 'bind_param'), $this->paramArgs);
} 
```

你像这样使用它：

```
 $prep = new theClassAboveHere( $mysqli, $query );
 $prep->feed( array('string', 1, array('b', 'BLOB DATA') ); 
```

该类应扩展 mysqli_stmt 类。

我希望这可以帮助您朝着正确的方向前进。
如果你不想，我也可以发布整个课程，它包括变量结果绑定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T13:37:01.307

使用数组构建语句稍微清晰一些：

```
$params = array();
$fragments = array();
foreach($_POST as $col => $val)
{
  $fragments[] = "{$col} = ?";
  $params[] = $val;
}

$sql = sprintf("UPDATE sometable SET %s", implode(", ", $fragments));
$stmt = $mysqli->prepare($sql);
$stmt->bind_param($params); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-06-19T13:02:26.587

array_insert 不存在，我猜他指的是一些自制的函数，但我不确定它到底做了什么......在开头的某个地方将参数类型插入到数组中我猜想是因为传递了值 0但嘿，它也可能最终出现；）

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-27T13:28:26.053

将其构建为字符串，但将您的值放入数组并将其传递给 bindd_param。（并用 ? 代替 SQL 字符串中的值。

$stmt = $mysqli->prepare("UPDATE mytable SET myvar1=?, myvar2=... WHERE id = ?")) { $stmt->bind_param("ss...", $_POST['myvar1'] , $_POST['myvar2']...);

例如：

```
$args = array();
$sql = "UPDATE sometable SET ";
$sep = "";
$paramtypes = "";
foreach($_POST as $key => $val) {
  $sql .= $sep.$key." = '?'";
  $paramtypes .= "s"; // you'll need to map these based on name
  array_push($args, $val);
  $sep = ",";
}
$sql .= " WHERE id = ?";
array_push($args, $id);
array_insert($args, $paramtypes, 0);

$stmt = $mysqli->prepare($sql);
call_user_func_array(array(&$stmt, 'bindparams'), $array_of_params);
$stmt->bind_param($args); 
```

# delphi - 指向泛型类型的指针

> ID：793472
> 
> 赞同：6
> 
> 时间：2009-04-27T13:24:52.053
> 
> 标签：delphi, generics, pointers, delphi-2009, hashtable

在将给定的基于指针的高效哈希映射实现转换为通用哈希映射实现的过程中，我偶然发现了以下问题：

我有一个代表哈希节点的类（哈希映射实现使用二叉树）

```
THashNode <KEY_TYPE, VALUE_TYPE> = class
public
  Key      : KEY_TYPE;
  Value    : VALUE_TYPE;
  Left     : THashNode <KEY_TYPE, VALUE_TYPE>;
  Right    : THashNode <KEY_TYPE, VALUE_TYPE>;
end; 
```

除此之外，还有一个函数应该返回一个指向哈希节点的指针。我想写

```
PHashNode = ^THashNode <KEY_TYPE, VALUE_TYPE> 
```

但这不会编译（';' 预期但 '<' 找到）。

如何获得指向泛型类型的指针？

并写给巴里凯利：如果你读到这个：是的，这是基于你的哈希映射实现。您自己没有编写过这样一个通用版本的实现，是吗？那会节省我一些时间:)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-27T14:41:20.747

对不起，粉碎者。不支持指向打开泛型类型的指针，因为不支持泛型指针类型，尽管在某些情况下（特别是指向泛型类型内的嵌套类型的指针）可以创建它们（编译器错误）；如果我们破坏了某人的代码，则无法在更新中删除此“功能”。将来应该取消对泛型指针类型的限制，但我不能承诺何时。

如果有问题的类型是`JclStrHashMap`我写的（或古老的`HashList`单元），那么最简单的重现它的方法是将节点类型更改为一个类，并通过`Pointer`适当的转换传递任何双指针。但是，如果我今天再次编写该单元，我不会将存储桶实现为二叉树。我有机会在 Generics.Collections 单元中编写字典，尽管在交付可靠的 QA 之前，所有其他 Delphi 编译器的工作时间都太紧了，而且通用特性支持本身也在不断变化，直到相当晚。

我更愿意将哈希映射存储桶实现为双散列、每个存储桶的动态数组或连续数组中的单元格链接列表之一，以使用代表性数据的测试中最好的结果为准。逻辑是树/列表中跟随链接的缓存未命中成本应该支配树和具有良好哈希函数的列表之间的桶搜索的任何差异。当前字典被实现为直线探测，主要是因为它相对容易实现并且与可用的原始通用操作集一起使用。

也就是说，二叉树存储桶应该是对不良哈希函数的有效对冲；如果它们是平衡的二叉树（`=>`甚至更多的修改成本），那么它们平均为 O(1)，最坏情况下的性能为 O(log n)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T13:59:14.170

要真正回答您的问题，您不能指向泛型类型，因为“泛型类型”不存在。您必须创建一个指向特定类型的指针，并填写类型参数。

不幸的是，编译器不喜欢在 ^ 之后找到尖括号。但它将接受以下内容：

```
 TGeneric<T> = record
      value: T;
   end;

   TSpecific = TGeneric<string>;

   PGeneric = ^TSpecific; 
```

但是“ `PGeneric = ^TGeneric<string>;`”给出了编译器错误。对我来说听起来像是一个小故障。如果我是你，我会在 QC 报告。

无论如何，您为什么要创建指向对象的指针？Delphi 对象是一种引用类型，因此它们已经是指针。你可以将你的对象引用转换为指针，你很好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-27T14:04:23.533

*如果*Delphi 完全支持泛型指针类型，它必须看起来像这样：

```
type
  PHashNode<K, V> = ^THashNode<K, V>; 
```

也就是说，在声明类型名称的左侧提及泛型参数，然后在右侧构造类型时使用这些参数。

但是，Delphi**不**支持这一点。参见[QC 66584](http://qc.embarcadero.com/wc/qcmain.aspx?d=66584)。

另一方面，我也质疑*拥有*指向类类型的指针的必要性。通用与否。*很少*需要它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T13:50:42.473

在 Generics.Collections 单元中有一个名为 TDictionary 的通用哈希映射。不幸的是，它目前已经严重损坏，但它显然会在更新 #3 中得到修复[，根据 Nick Hodges 的说法，该更新将在几天内](http://podcast.remobjects.com/27-NickHodges-RDManager.mp3)发布。

# visual-studio - msbuild -p 选项

> ID：793476
> 
> 赞同：1
> 
> 时间：2009-04-27T13:26:06.620
> 
> 标签：visual-studio, msbuild, build

我们可以使用 msbuild 从命令行构建项目。我的问题是关于 -p 选项。此选项用于指定属性键/值对。我的问题是，除了命令行中 -p 选项分配的键/值对之外，还有其他已经定义的选项吗？如果存在这样的现有定义选项，现有选项在哪里定义以及在构建过程中如何使用这些键/值对？

例如，像 msbuild foo.sln /p:Configuration=Debug 这样的命令，除了选项 Configuration（其值为 Debug）之外，是否有任何已经定义的现有选项？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T13:29:22.650

请参阅[MSBuild Reserved Properties](http://msdn.microsoft.com/en-us/library/ms164309.aspx)和[How To: Use Environment Variables in a Build](http://msdn.microsoft.com/en-us/library/ms171459(VS.80).aspx)，因为这些也是一种属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-15T20:36:32.470

属性因项目类型而异，但此处列出了 .NET 项目的典型属性，并带有示例值：

*   配置：调试、发布
*   平台：x86、x64、任何 CPU
*   优化：真假
*   输出路径：bin\Debug\、bin\Release\
*   NoWarn：1591（禁止缺少 XML 文档警告）

要查看构建期间使用的所有其他属性，您可以打开位于 Framework 目录中的常见 MSBuild 目标：C:\Windows\Microsoft.NET\Framework\v4.0.30319。查看 Microsoft.Common.targets 和 Microsoft.CSharp.targets 以获得 C# 项目构建属性。

如果您想深入了解 MSBuild，我建议您阅读[Inside the Microsoft Build Engine](https://rads.stackoverflow.com/amzn/click/com/0735645248)或[MSBuild Trickery](https://rads.stackoverflow.com/amzn/click/com/061550907X)。如果您已经了解基础知识，尽管我会跳过第一本书。[您可以在线](https://stackoverflow.com/questions/1326445/is-there-a-good-tutorial-on-msbuild-scripts)获取 MSBuild 的基本教程。

# bash - 无法通过 LS_OPTIONS 为 LS 添加颜色

> ID：793483
> 
> 赞同：1
> 
> 时间：2009-04-27T13:28:53.057
> 
> 标签：bash, ls

我发现您可以在 .bashrc 中为 Grep 提供以下内容

```
 # puts colors for all grep commands
 export GREP_OPTIONS='--color=auto' 
```

我没有设法让 LS_OPTIONS 工作的类似命令。

**除了以下方法之外，还有其他方法可以为您的 ls -命令提供颜色吗？**

```
alias ls='ls -Gh' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-12-24T20:40:49.133

要使带有颜色的 ls 起作用，您必须执行以下操作：

```
alias ls='ls -G'
export CLICOLOR=1
export LSCOLORS=ExFxCxDxBxegedabagacad
export TERM=xterm-color 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-29T23:12:35.760

这是一个完整的解决方案：

```
# BSD ls
export LSCOLOR='exfxcxdxbxegedabagacad'
# GNU ls and others (for example, tree)
export LS_COLORS='di=34;40:ln=35;40:so=32;40:pi=33;40:ex=31;40:bd=34;46:cd=34;43:su=0;41:sg=0;46:tw=0;42:ow=0;43:'

if [ "$(uname -s)" = 'Linux' ]; then
  # GNU ls
  alias ls='ls --color=auto'
else
  # Assume BSD ls
  alias ls='ls -G'
fi 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-15T00:41:14.217

正如其他人所说，`ls`使用显式选项进行别名可以实现您想要的。但是，如果您特别热衷于实际使用环境变量 LS_OPTIONS，那么您仍然需要一个别名：`alias ls='ls $LS_OPTIONS '`

您可以将 LS_OPTIONS 设置为`ls`. 运行`ls --help`或`man ls`在命令行上查看可用的选项。在我的 Linux 系统（openSuSE 42.2）上，使用 GNU `ls`v8.25，您可以通过添加选项来获得彩色输出`--color=auto`。

因此，您可以将以下内容放入您的 ~/.profile 或 ~/.bashrc 文件中：

```
export LS_OPTIONS="--color=auto"
alias ls="ls $LS_OPTIONS " 
```

要向环境变量或别名添加其他选项，只需在双引号内添加它们（用空格分隔）。

# oracle - 网络共享上的 Oracle 数据文件

> ID：793487
> 
> 赞同：0
> 
> 时间：2009-04-27T13:30:20.230
> 
> 标签：oracle, networking, virtualization, virtual-machine, share

我在虚拟机中的 Windows 2000 Advanced Server 上有一个 Oracle 8.1.7 服务器。我们目前正在使用 MS 虚拟服务器来托管它。（分配的硬件足够强大——我们分配了 3.5GB RAM，以及单个 2GHz 处理器内核，比 1999 年的大多数服务器都多）

Virtual Server 的限制之一是 Virtual Hard Disk (127GB) 的最大大小，而我尝试导入的数据库为 143GB。

为了解决这个问题，我试图在物理硬盘上创建数据库数据文件，它有足够的空间。

我的问题是我很难在网络共享上创建数据库实例。

有谁知道我怎样才能做到这一点，同时保持我年轻的容貌（和头发！）？

干杯，布赖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T13:35:20.687

您需要`Oracle`启动服务的帐户才能访问网络共享。

不能说`Oracle`在网络共享上创建数据文件是一个好主意，但如果您不搞乱数据文件和共享可访问性，这是一个可行的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T22:46:50.610

你说“进口”。如果您正在使用 exp/imp，一种选择可能是只导入单个用户或表，并单独缩小它们。

此外，IMP 文件的大小与数据库的大小无关。140GB 的 exp/imp 文件可能会导致数据库更小（或者相反，它可能会更大，因为 exp/imp 文件只有索引元数据）。如果这些数据文件包含大量未使用的空间，那么即使数据文件总计 140GB 的数据库也可能会更小。

# c# - 使用 TeamFoundationServerFactory 进行缓慢的用户身份验证

> ID：793489
> 
> 赞同：2
> 
> 时间：2009-04-27T13:30:51.350
> 
> 标签：c#, tfs

我正在编写一个时间注册 Web 项目，用户可以在其中编写与 TFS 工作项相关的时间。这包括搜索工作项 ID 并在 Web 中显示有关工作项的信息，例如描述。

该项目运行正常，但当用户第一次访问 TFS 时，我收到有关网站运行缓慢的投诉。

我正在使用 Kerberos 将用户凭据发送到 TFS 服务器以使用以下代码进行身份验证：

```
TeamFoundationServerFactory.GetServer(url);
_tfs.EnsureAuthenticated(); //Authenticates only if neccessary 
```

第一次大约需要 10 秒，但之后就可以正常工作了。我能做些什么来优化它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T13:36:15.490

并非如此，当您第一次打开 TFS 时，您将在开发机器上遇到同样的延迟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T13:36:08.390

什么都不会立刻浮现在脑海中。您正在使用适当的 API 和身份验证方法，因此您无需更改代码即可加快此过程。

您可能想对服务器进行一些调查，以了解为什么这需要这么长时间。Active Directory 身份验证不应花费 10 秒。必须有另一个占用大量时间的后续行动。

我会打破一个分析器并使用它来确定确切的时间花费在哪里。然后，您可以尝试找出一种方法来加快该区域的速度。

# subsonic - SubSonic 2.2 没有为 VB 完全更新？

> ID：793493
> 
> 赞同：1
> 
> 时间：2009-04-27T13:32:04.780
> 
> 标签：subsonic

最近关于扩展 SubSonic 的问题的答案指向列出相关 ActiveRecord 模板的 googlecode 目录。我很惊讶地看到大多数 CS_ 比 VB_ 等价物要新得多。这是否意味着 SS2.2 还没有针对 VB 进行全面更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-14T21:46:51.217

[看到这个线程](https://stackoverflow.com/questions/985834/subsonic-vb-net-problem/993832#993832)

由于 vb.net 没有为 2.2 完全“烘焙”的原因

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T16:48:26.883

我有点惊讶于大多数 CS_ 的日期戳都发生了变化，而不是 VB_ 的。

就我而言，我对 Winforms 数据绑定不太满意，尽管我不是 GoogleCode 错误列表中可能适用的最新项目。我认为那是 2.2 后的版本？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T16:26:10.573

我为模板提交了一个补丁，并确保它包含在 VB 版本中。2.2 的模板更改不多，所以应该没问题。有什么不适合你吗？

# c# - 我什么时候应该使用公共/私有/静态方法？

> ID：793494
> 
> 赞同：21
> 
> 时间：2009-04-27T13:32:06.183
> 
> 标签：c#, vb.net

我是 C# 的新手。直到这一刻，我曾经使每个全局变量 - public static。我所有的方法都是 public static，所以我可以从其他类访问它们。

我在 SO 上读到，我拥有的公共静态方法越少越好。所以我重写了我的应用程序，将所有代码放在一个类中 - 表单类。现在我所有的方法都是私有的，没有静态方法。

我的问题：我应该怎么做，在我看来，将所有内容都保留在表单类中是垃圾。

我什么时候应该使用公共，什么时候是私有的，什么时候是静态私有/公共的？

我将公共方法视为“缺点”，因为它们可以被反编译，但我对此表示怀疑。我的公共方法也可以被反编译。私有方法中的“私有”是什么？

**编辑**：我不是在问如何防止我的程序被反编译，我是在问我是否应该使用静态、私有和公共。还有：将所有代码放在表单类中是否有问题所以我没有使用公共方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-13T20:09:19.477

除非另有证明，否则一切都应该是私有的。公共和私有之间的区别在于什么应该保持兼容和什么不应该保持兼容，什么应该对世界感兴趣，什么不应该是它的业务。

当您将某些东西声明为公开时，该类（以及相应的对象）正在做出一个强有力的声明：这是我的可见界面，还有很多其他类似的，但这是我的。公共接口是您的班级正在向世界其他地方（无论这意味着什么）输出关于它可以做什么的合同协议。如果你修改公共接口，你就有可能违反世界其他地方对这个类的约定。

另一方面，私有的东西是类内部的。它支持类在携带对象状态（如果它是方法）或保持其内部状态（如果它是变量）时必须用来完成其工作的功能。您可以随意修改和修改类私有内容，而不会破坏接口契约，这意味着这为您提供了广泛的重构自由（例如，为了提高效率，重构内部数据表示）。私有的东西不是界面的一部分。

受保护的东西涉及对重新实现的开放性。如果可以的话，避免深度嵌套的继承。您冒着使事情变得非常难以处理的风险，因为您的重新实现类可能会破坏基类。

从技术上讲，一个类应该声明一个接口（公共）和一个实现（私有）。接口根本不应该有代码，只是委托给私有的“实现”逻辑。这就是为什么在 Java 和 C# 中有接口语句，它形式化了 C++ 中的纯抽象类概念。

静态是逻辑上驻留在您的类领域中的东西，但不依赖于类本身的状态。当设计模式要求时（例如，单例、工厂方法），应谨慎使用它。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-27T13:44:54.110

private 用于您只希望在主体类中访问的类成员，并且在 C# 中，成员默认设置为私有，除非指定不同

何时使用私有的示例：

```
class Account
{

  private int pin = 1090;
  public int Pin
  {
     get { return pin; }
  }
} 
```

另一方面，public 则相反，访问公共成员没有任何限制，因此当与用户访问无关的事情时应该是公开的。

另一方面 static 与两者无关，因为它不处理方法的权限，另一方面 static 是常量或类型声明。如果静态一词应用于类，则类中的每个成员都必须声明为静态的。

何时使用静态的示例：

```
 static int birth_year= 1985 
```

[C# 参考中的修饰符](http://msdn.microsoft.com/en-us/library/6tcf2h8w.aspx)将为您提供 C# 中所有修饰符的更多详细信息以及如何使用它们的示例

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-04T15:57:51.360

上面已经回答了所有问题，但我认为它可以简化一点......所以装饰一个公共方法，如果其他类将使用此方法。如果不是 - 将其标记为私有。

例如，您有**Class A**和**Class B**。假设**A 类**有 3 个方法 (x,y,z)。方法**x, y**将由**Class B**使用，因此将它们都标记为 public，但方法**z**将仅由**Class A**内部的方法**x**使用，因此将其标记为私有，因为无需将此方法暴露给外部世界。此方法中的逻辑仅供内部使用。

 **静态是不同的，这种装饰意味着您不能创建标记为静态的对象的实例。对象是 - 正如关键字所说 -**静态**（不能更改或修改）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-27T13:33:49.707

请参阅[访问修饰符（C# 编程指南）](http://msdn.microsoft.com/en-us/library/ms173121.aspx)。但是，如果您有一本像样的 C# 和 OOP/OOD 书籍，那就更好了：这些都是计算机科学的基础知识。

长话短说：访问修饰符促进封装，这基本上意味着每个类都应该将其私有信息保留给自己。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T13:37:09.357

这似乎比上面链接的问题更基本。要在 OO 语言中适当地发展壮大，您需要弄清楚如何将最终目标分解为一系列协同工作的对象（甚至相互包含和扩展）以实现一系列目标。这种抽象有许多好处，一旦您开始正确实施 OO 设计，这些好处就会变得显而易见。如前所述，如果你还没有读到解释面向对象编程基础的部分，你会想要一本新的**C** #书**。**

 *** * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-24T07:21:47.717

Java 提供了许多访问修饰符来设置类、变量、方法和构造函数的访问级别。四个访问级别是：

对包可见，默认。不需要修饰符。

仅对班级可见（私有）。

对世界（公众）可见。

对包和所有子类可见（受保护）。

这是一个例子：

公共类自行车{

```
private int cadence;
private int gear;
private int speed;
private int id;
private static int numberOfBicycles = 0;

public Bicycle(int startCadence, int startSpeed, int startGear){
    gear = startGear;
    cadence = startCadence;
    speed = startSpeed;

   id = ++numberOfBicycles;
}

// new method to return the ID instance variable
public int getID() {
    return id;
}
    ... 
```

}

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-02-03T02:54:30.460

除了上述之外，想想工作场景。你不是一个人工作。您的同行可能会调用您实际上不想公开的类中的方法，或者认为将来需要对其进行重大更改。这可能是您想要私人的情况

# python - 什么 HTTP 框架用于简单但可扩展的应用程序？

> ID：793501
> 
> 赞同：1
> 
> 时间：2009-04-27T13:33:25.620
> 
> 标签：python, http, frameworks, scalability

对于具有隐含可扩展性、首选 Pythonic 的简单应用程序，我应该使用什么 HTTP 框架？我希望能够在已经部署的应用程序中顺利添加新功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T13:53:53.653

[我是Pylons](http://pylonshq.com)的忠实粉丝。它的行为就像框架应该的那样；没有过多的魔力，并且包含许多您可以挑选的好组件，以帮助您开始跑步。它体积小且易于部署，并且需要最少的样板文件或其他语法垃圾。可扩展性似乎相当不错——我没有遇到任何问题，Reddit 的主要部分使用了 Pylons 的库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T13:38:13.970

[网页版](http://www.webpy.org.)

它可能看起来太简单了，但使用起来很有趣。

它可以部署在 google appengine 上。应该可以很好地扩展。可以与任何[WSGI](http://www.wsgi.org.)服务器一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-29T15:35:51.713

这可能是最具可扩展性的解决方案之一：G-WAN + Python：

[http://forum.gwan.com/index.php?p=/discussion/comment/4126/#Comment_4126](http://forum.gwan.com/index.php?p=/discussion/comment/4126/#Comment_4126)

他们的可扩展性测试（如结果）是无与伦比的。

# c# - 使用 C# 在 SQL 中插入数据表

> ID：793506
> 
> 赞同：2
> 
> 时间：2009-04-27T13:34:09.753
> 
> 标签：c#, sql

我们如何使用 c# 在 SQL 中插入数据表的值？第二个问题是我们如何将 SQL 表复制到数据表变量中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T13:37:44.703

**更新**：这个答案过去没有的一件事是指向 SQL 和数据库新手的信息的链接，所以我也会在此处放置一些相关链接，以便您（或其他任何人）可以了解他们的 SQL 和其他数据库设计技能。

*   [W3 Schools SQL 教程](http://www.w3schools.com/sql/default.asp)
*   [数据库设计教程](http://www.tekstenuitleg.net/en/articles/database_design_tutorial/1)

* * *

**更新 2**：这是填充数据表的示例：

```
//Namespace References
using System.Data;
using System.Data.SqlClient

/// <summary>
/// Returns a DataTable, based on the command passed
/// </summary>
/// <param name="cmd">
/// the SqlCommand object we wish to execute
/// </param>
/// <returns>
/// a DataTable populated with the data
/// specified in the SqlCommand object
/// </returns>
/// <remarks></remarks>

public static DataTable GetDataTable(SqlCommand cmd)
{
    try
    {
        // create a new data adapter based on the specified query.
        SqlDataAdapter da = new SqlDataAdapter();

        //set the SelectCommand of the adapter
        da.SelectCommand = cmd;

        // create a new DataTable
        DataTable dtGet = new DataTable();

        //fill the DataTable
        da.Fill(dtGet);

        //return the DataTable
        return dtGet;
      }
      catch (SqlException ex)
      {
          MessageBox.Show(ex.Message);
      }
      catch (Exception ex)
      {
          MessageBox.Show(ex.Message);
      }
  } 
```

* * *

其中很多内容来自我之前写的另一个答案，但它详细介绍了您的确切问题：

**原答案**：

这听起来您或多或少需要基本介绍如何从 C# 连接和操作数据库。上面的海报说要研究 LINQ to SQL，但您也可以研究更基本的 ADO.NET 底层框架，这将使您了解它的基本工作原理。

[此外，您可以在此处](http://www.codebeach.com/index.asp?tabID=2&categoryID=15&subcategoryID=3)使用此站点获取许多不同的 C# 数据库教程。

**编辑**：来自[C# Station](http://www.csharp-station.com/Tutorials/AdoDotNet/Lesson01.aspx)、[CodeProject](http://www.codeproject.com/KB/database/DatabaseAcessWithAdoNet1.aspx)和[Codersource的更多信息](http://www.codersource.net/csharp_adonet_tutorial_ed.html)

**编辑 2**：如果您对上面提到的 Linq to SQL 之类的东西感兴趣，这里有一些来自[C# Corner](http://www.c-sharpcorner.com/UploadFile/scottlysle/L2SinCS06022008035847AM/L2SinCS.aspx)和[C-Sharp Online 的教程](http://en.csharp-online.net/Introducing_LINQ%E2%80%94Using_LINQ_to_SQL)

**编辑 3**：其他人也会建议诸如 ADO.NET 实体框架之类的东西。对于仍然需要掌握使用数据库的基础知识的初学者，我不一定建议这样做。这是来自[MSDN 概述的一些信息](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)

**简单示例**（这是直接从上面给出的 C# Station 链接中提取的）

> 清单 1\. 使用 SqlConnection

```
using System;
using System.Data;
using System.Data.SqlClient;

/// <summary>
/// Demonstrates how to work with SqlConnection objects
/// </summary>
class SqlConnectionDemo
{
    static void Main()
    {
        // 1\. Instantiate the connection
        SqlConnection conn = new SqlConnection(
            "Data Source=(local);Initial Catalog=Northwind;
             Integrated Security=SSPI");

        SqlDataReader rdr = null;

        try
        {
            // 2\. Open the connection
            conn.Open();

            // 3\. Pass the connection to a command object
            SqlCommand cmd = 
                new SqlCommand("select * from Customers", conn);

            //
            // 4\. Use the connection
            //

            // get query results
            rdr = cmd.ExecuteReader();

            // print the CustomerID of each record
            while (rdr.Read())
            {
                Console.WriteLine(rdr[0]);
            }
        }
        finally
        {
            // close the reader
            if (rdr != null)
            {
                rdr.Close();
            }

            // 5\. Close the connection
            if (conn != null)
            {
                conn.Close();
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T13:37:47.357

对于这两种情况，您都需要一个相关的*数据适配器*，例如[`SqlDataAdapter`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldataadapter.aspx).

我建议您找到一本好的 ADO.NET 书籍或教程——它一定会在其中。或者，还有关于[DataAdapters/DataReaders](http://msdn.microsoft.com/en-us/library/ms254931.aspx)和[Retrieving and Modifying Data in ADO.NET](http://msdn.microsoft.com/en-us/library/ms254937.aspx)的 MSDN 文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T13:37:36.220

对于初学者，我会阅读[ADO.NET](http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx)和[LINQ to SQL 。](http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx)

# actionscript-3 - 扩展单例类？

> ID：793507
> 
> 赞同：1
> 
> 时间：2009-04-27T13:34:47.100
> 
> 标签：actionscript-3, oop, singleton

有没有办法像模板单例类一样，当你扩展它时，扩展的类也是单例类，所以我可以快速制作一个新的单例类，只是我扩展模板单例类？如果重要，我正在使用 ActionScript 3.0。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T13:42:52.057

单例模式的设计方式是不应该继承类型。我对 ActionScript 不熟悉，但是拥有一个也可以扩展的单例类型似乎是一个错误。

如果您要这样做，那么这意味着父类型和子类型都可以将它们的单个实例加载到同一个应用程序中。由于类型在多态上属于 type `Parent`，`Parent`因此在技术上将不再是单例。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T13:43:58.840

首先，我怎么强调都不过分——确保您使用的 Singleton 不是[Singleton 作为 antipattern](http://accu.org/index.php/journals/337)。

我对 ActionScript 了解得不够多，无法对其进行智能评论，但通常单例实例作为静态变量存储在类中。这意味着您的子类将从父类继承静态变量，因此也继承了实例！因此，考虑到这一点，您将无法制作 insta-singleton。

但是，您可以做的一件事是制作一个 Singleton 接口，如果您的所有单例都需要一组通用功能，例如用于干净卸载的析构函数等。任何其他 hack 来完成这项工作（我能想到一些） -我不确定告诉你是否*合乎道德*，因为单身人士最好稀疏地使用（恕我直言）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T12:31:37.197

flex 框架将这种模式用于多个管理器。

如果您查看 mx.core.Singleton 的 Flex 代码，它通过维护类名到该类实例的映射来工作。因此，在为单例创建第一个实例之前，您可以创建层次结构中任何类的实例。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-27T23:25:37.413

Singleton 就像任何其他类一样在一个类中定义，您可以根据需要扩展（从它继承）它。单例的要点是只**实例化**一次，它没有说明继承。

问题是，这样做方便吗？如果您尝试过，您会发现您需要重新实现（覆盖）基类中定义的大部分行为。你不妨从头开始一门新课。可能更好的是创建一个定义所需行为的 Singleton 接口。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-09-21T13:08:39.403

在 Java 中，在单例类中，构造函数是**私有**的！所以，如果类 X 有一个私有构造函数，如果你试图在类 Y 中继承它，编译器会说它不能调用 X 类的 super() 构造函数，因为它没有公共可见性。所以在Java中，我们不能继承一个单例，我猜：/

# ms-access - 将 Access 部署为客户端-服务器应用程序

> ID：793513
> 
> 赞同：2
> 
> 时间：2009-04-27T13:35:57.173
> 
> 标签：ms-access, deployment, activex

我使用 Access（2003 格式）作为带有 SQL Server 2008 后端的前端。每个用户都已经安装了 Access 2003 或 2007。我很好奇用于提高效率和可维护性的最佳部署配置。

我应该将 .MDB 文件放在服务器上并在每台机器上放置一个快捷方式吗？（一次只有两到三个用户。）或者在每台机器上放一份文件？如果我使用的是第 3 方 ActiveX，是否需要在每台机器上安装它，即使 .MDB 在服务器上（我假设是这样，但只是检查），还是只是在服务器上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T13:40:58.690

当多个用户同时打开访问文件时，可能会出现问题。我会在每个用户的机器上都有一份该文件的副本。

是的，每台机器都需要安装 ActiveX 控件——即使 MDB 在服务器上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T01:55:14.073

我专门创建了 Auto FE Updater 实用程序，以便我可以根据需要随时更改 FE MDE，并且非常有信心下次有人运行该应用程序时它会引入最新版本。有关错误或 Auto FE Updater 实用程序的更多信息，请参阅我网站上[http://www.granite.ab.ca/access/autofe.htm](http://www.granite.ab.ca/access/autofe.htm)上的免费 Auto FE Updater 实用程序，以使每台 PC 上的 FE 保持最新.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-29T05:48:43.180

1）制作数据库程序的acde文件 2）在客户端导入这些文件（表单，表格，查询）。3）导入表格检查链接并标记检查 4）所有用户或客户使用只读形式。他们无权查看设计情绪。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T17:10:55.643

正如 Jon B 所说，“将 mdb 放在每个用户的机器上”是一个很好的解决方案。对于它的价值，我建议每个用户运行一个批处理文件，当 master 有较晚的日期时，该文件会从服务器 xcopy 到 master mdb。然后批处理文件运行 mdb。这使得部署新版本变得容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T19:42:46.607

要扩展“需要在哪里安装 ActiveX 控件”答案：

您提出这个问题的事实表明，您对 Access 的工作方式有些模糊。仅仅因为您使用 SQL Server 作为后端（有资格作为客户端/服务器）确实神奇地使 Access 在服务器上运行。Access 始终在工作站的本地 RAM 中运行（或远程桌面会话，如果您在 Windows 终端服务器/Citrix 上运行它），这意味着必须在每个工作站上安装 ActiveX 控件，就像必须在那里安装 Access 一样（用适当的资格代替 WTS）。

Access 不是客户端/服务器应用程序，尽管它可用于创建服务器数据库的客户端前端。

而且，顺便说一句，我认识的大多数专业 Access 开发人员都避免像瘟疫一样使用 ActiveX 控件，因为它们很容易被破坏而无法恢复（因为它们不能与后期绑定一起使用）。几乎总是有一种更可靠的方法来完成任务，尽管它可能需要比插入式 ActiveX 控件更多的代码。

# .net - 您如何比较 ado .net 中的数据集结构？

> ID：793528
> 
> 赞同：0
> 
> 时间：2009-04-27T13:38:34.203
> 
> 标签：.net, ado

我需要比较两个数据集的表结构以检查是否存在任何差异，这可能吗？

我虽然转换为 XML 并进行比较，但有更好的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T13:42:01.357

您可以转换为 XML 并进行比较，但这对我来说有代码味道。您可以使用 LINQ（如果您使用的是 .NET 3.5），也可以手动循环遍历您的表、列和行，看看是否有任何差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T14:02:34.113

我认为这在很大程度上取决于你想做什么。如果您只想可视化差异，那么我会使用 XML 和差异查看器工具。

如果您想查看它们是否不同并且可能显示更改字段的简短列表（所有这些都在应用程序中），那么您也可以使用模式的 XML 表示或像 Adams Robinson 提到的那样做。基本上，不管你怎么做，你仍然需要遍历表和字段，所以你也可以直接访问它们，而不是先将它们转换为 XML

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T14:10:31.023

我会简单地`GetXmlSchema()`在每个数据集上使用该方法并将架构结构作为字符串获取。然后可以比较两个字符串。

# version-control - 您使用的版本控制系统 (SCM) 最烦人的是什么？

> ID：793530
> 
> 赞同：10
> 
> 时间：2009-04-27T13:39:35.263
> 
> 标签：version-control

这个问题*不是*问我应该使用什么版本控制软件。相反，我想听听您认为您使用的一些 SCM 的缺点。

网站和营销材料只强调优点，但我想听听实际使用它的人的意见，他们认为缺点是什么。

您能说出您正在使用或曾经使用过的 SCM 中的一些令人讨厌或适得其反的品质或行为吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-27T14:12:20.300

在我最近的两份工作中，我被要求使用[IBM 的 Rational ClearCase](http://www-01.ibm.com/software/awdtools/clearcase/)，并且计算这个有缺陷且令人沮丧的软件包如何削弱我每天生活的意愿，我至少需要一周的时间。我的主要抱怨是：

1.  没有工作单元的概念。如果我签入十个更改的文件以修复错误或添加功能，则无法再次将这些更改视为一个组。即使他们在评论中有相同的签入。
2.  动态视图偶尔会在重新启动时消失。无需详细说明，这意味着其他应用程序可能依赖的文件在您重新启动计算机时仍然存在的可能性不到 50%。
3.  如果我将代码签入我的分支，然后合并回 main，它不会自动将其签入具有相同注释的 main。这意味着如果我想在主分支上得到很好的评论，我会不断重复自己。
4.  几乎没有与 Visual Studio 集成（显然这在 7.1 中更好，但当然我们还没有升级到那个）
5.  UI 一致性的一个相当快速和松散的想法，一些对话框在右侧有按钮，一些在底部。此外，一些真正需要调整大小（包含长文件名）的窗口也不是。
6.  很少（但经常发生这种情况，我在两家公司中与我交谈过的每个人都至少发生过一次）ClearCase 将决定在 XML 文件的中间添加一个随机字符。
7.  事实上，IBM 为此更改了每个许可证 4,600 美元，并且人们为此付费。

实际上还有几十个小问题拖累了我的工作效率，因为我不得不与这个工具作斗争，而且我很有可能会回来编辑这篇文章，以此来发泄我每天对此的不满。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-27T18:22:29.810

Serena 尺寸非常崩溃。我们过去每天都会根据需要重新启动服务器。否则，它会变得非常缓慢。我不确定这是实施问题还是产品问题。您也可以参考 Eric Sink 博客了解有关版本控制的更多详细信息。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-27T13:43:44.690

[我可以确认这里提到](http://www.highprogrammer.com/alan/windev/sourcesafe.html)的关于 VSS的大部分内容。

我被迫使用它。:-(

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-27T14:10:02.897

颠覆。它的分支支持很糟糕——这就是我现在更喜欢 Mercurial 的原因；我不在飞机上开发东西，但我确实需要分支。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-27T18:05:39.820

不久前，我被 Serena 版本管理器困住了。太可怕了。我们的存储库非常复杂，我们拥有的提升组数量、拥有的分支以及拥有的标签是如此失控，除非您确切知道自己需要做什么，否则祝您好运。比以往任何时候都复杂得多。

现在我们正在使用 TFS（我在家里使用 Subversion），我是一个快乐的开发人员。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-27T13:53:37.990

**Subversion**：服务器非常强大，但没有 GUI 管理客户端（**编辑**：确实需要一个支持选项）

大约一年前，我们从 Source ~~Un safe 切换到 Seapine SurroundSCM；~~我们强烈考虑过 Subversion，但我们的存储库管理员做得很好，但他不是命令行专家，如果没有 GUI 管理客户端，我们维护公司的源代码控制存储库的方式就会出现巨大的漏洞。

FWIW，我认为**所有**的 SCM 都存在术语问题。这使得在我们公司的许多用户都不是拥有完美记忆的软件工程师的情况下切换单片机软件更加地狱。VSS 将目录称为“项目”。Seapine SurroundSCM 将目录称为“存储库”。（Subversion 也有一些烦人的名字，但我现在想不出它们是什么）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-27T17:58:15.780

Subversion 有两个主要缺点。

*   工作副本是软件实际大小的 2 倍。在处理大型媒体文件和多个分支时，这可能会变得笨拙。
*   标记和分支只是主干的副本。当将存储库目录结构映射到开发人员工作区时，这会变得非常烦人。我渴望传统的分支和标记概念。

总而言之，与许多替代品相比，它是一个非常受人尊敬的 VCS。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-27T13:52:59.410

尽管 SCM 可能是您可以在开发环境中使用的最好的东西之一，但它总是让我感到困扰（这些可能是挑剔的）：

*   当其他人更改我的文件时，在我提交或进行更新之前我不知道它。
*   合并是一件令人头疼的事情。
*   当其他人不擅长使用它时，它的阻碍多于它的帮助。
*   管理同一个应用的不同分支、标签和主干太难了。

这就是我现在能想到的。:)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-27T14:07:14.167

这是我的个人清单。我并没有声称这些观点得到了非常好的研究，但根据我的使用模式，这些是我对它们的主要抱怨。

*   单调：必须指定“。” 表示当前工作目录（否则，任何命令都适用于整个工作副本）。
*   CVS：太多了，无法列出。不惜一切代价避免。（可能是权限处理）。
*   颠覆：未分发。
    *   SVK：向颠覆中添加分发感觉很笨拙。
*   Mercurial：这是一个单调的克隆——为什么，亲爱的上帝，为什么？
*   Bazaar：真正奇怪的网络方法（尽管可能已经过时）。
*   Git：源代码质量，但这正在改变。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-27T15:37:54.417

Subversion 非常慢，缺少离线提交等功能，有时提交失败并需要更新，如果您必须使用 @ 符号来查看您的存储库，那么它很难使用。

Bazaar 还可以，但大多不受支持（至少由 sourceforge 支持）。另外，我更喜欢分支/标记的颠覆模型。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-27T18:26:41.670

Subversion（嗯，Tortoise SVN；我认为这更像是一个客户端问题）偶尔会感到困惑，我不得不花一些时间将东西复制到临时文件夹中，重新添加，清理等等，以便我可以得到它在不抱怨锁定文件的情况下进行干净的更新/提交。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-05-29T17:55:36.420

我目前是 Mercurial 用户，我非常喜欢它。但它有一个缺点：如果修订树*真的*很多，它会变慢。其中很大一部分归结为所做的一些设计选择，特别是始终根据最后一次提交的更改（而不是父更改）记录更改这一事实。但我仍然会选择它而不是其他任何东西。

现在对我来说，版本控制系统有两个必要条件：（1）变更集的概念，所以原子变更保持原子；(2) 易于分支合并而不丢失信息。基本上所有的 DVCS 都有这个；大多数其他 VCS 没有。（Perforce 很接近，但它总是让我感到困扰，分支合并不会保留分支中的变更集和注释序列。）

但如果我在面试中，潜在雇主告诉我他们使用 CVS，我会退出面试。（实际上，这是我通常在电话面试时会问的一个问题。你可以告诉很多关于一家公司他们使用哪种版本控制系统的信息。）

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-12-08T17:04:23.783

根据我对 Serena Dimensions 的经验，每个插件都会中断。即使是 Windows 资源管理器外壳集成，它也会减慢对网络共享的访问速度。无论如何，它并不会告诉您您想知道的有关更改的所有信息。更改了目录树底部的文件？更高级别的文件夹覆盖不会告诉你。与 Tortoise SVN 相比，这是一个缺乏可用性的例子。

但我真正**不**喜欢的是，当我执行 Deliver 时，它会检测到文件更改，然后当我比较查看差异时，它告诉我 Ancestor 和 Derivative 是相同的。如果我不能相信内置的差异工具，它有多少次决定祖先和衍生物实际上不同时是相同的？

当基本的版本控制基础不起作用时，任何人都可以构建变更控制工具，这超出了我的范围。哦，如果您尝试与第三方差异工具集成，则参数传递中会出现一个微妙的错误。

# perl - 当我在运行时只知道它们的名称时，如何本地化另一个包中的变量？

> ID：793532
> 
> 赞同：2
> 
> 时间：2009-04-27T13:40:54.057
> 
> 标签：perl

我需要在另一个包中本地化一些变量，但在传入它们之前我不知道它们的名称是什么。我尝试使用`local`typeglobs 没有奏效，所以我退回到保存变量的值和手动恢复它。有没有更好的办法？请注意，为了清楚起见，已省略了在处理变量之前检查变量是否存在的错误。

```
#!/usr/bin/perl

use strict;
use warnings;

my %orig;
for my $name (qw/foo bar baz/) {
    my $var = \${$meta::{$name}};
    $orig{$name} = $$var;
    $$var = $$var * 2;
}
meta::p();
for my $name (keys %orig) {
    my $var = \${$meta::{$name}};
    $$var = $orig{$name};
}
meta::p();

package meta;

BEGIN {
    our $foo = 1;
    our $bar = 2;
    our $baz = 3;
}

sub p { print join(" :: ", $meta::foo, $meta::bar, $meta::baz), "\n" } 
```

我试图避免这样的评估：

```
my $eval = '';

for my $name (qw/foo bar baz/) {
    $eval .= "local \$meta::$name = \$meta::$name * 2;\n";
}

eval "$eval meta::p()";
meta::p(); 
```

试图避免评估是在浪费时间吗？新代码比评估差吗？

注意，我也不想使用符号引用，所有代码都必须在`strict`. 当前的解决方案有效，所以我不是在寻找黑客来解决我正在做的事情，我正在寻找一个更好的解决方案（如果存在的话）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T15:02:33.520

关闭应该允许您使用[符号引用](http://perldoc.perl.org/perlref.html#Symbolic-references)`strict refs`做您想做的事情。我无法访问系统来使用 ATM 进行测试，但这样的事情应该可以工作：

```
use strict;
use warnings;

{
    no strict `refs`;
    local ${"meta::$name"} = ${"meta::$name"} * 2;

    meta::p();
}

meta::p(); 
```

**更新：**

经过一番测试，我发现了一个障碍。

虽然它很容易`local`在单个符号引用上使用。但是本地化变量名数组并不是那么简单——循环结构（map、for 等）都在它们操作的表达式周围创建了一个小的作用域，从而终止了本地化。

```
# This works but does not work on an array of names.
{   no strict 'refs';

    local ( ${'meta::foo'}, ${'meta::bar'}, ${'meta::baz'} );
    meta::p();
}
meta::p();

# THIS DOES NOT WORK AT ALL!
{   no strict 'refs';

    my @to_localize = map "meta::$_", qw/foo bar baz/;

    local ${$_} = $$_ * 2 for @to_localize;
    meta::p();

}
meta::p(); 
```

我能找到使用的唯一解决方案`goto`，我们都知道这被*认为是有害*的。

```
{   no strict 'refs';

    my @to_localize = map "meta::$_", qw/foo bar baz/;

    LOCALIZER:
        my $localize_me = shift @to_localize;
        local ${$localize_me} = $$localize_me * 2;
        goto LOCALIZER if @to_localize;

    meta::p();

}
meta::p(); 
```

我愿意接受更好的想法。

# .net - 跨多个文件拆分 F# 模块

> ID：793536
> 
> 赞同：39
> 
> 时间：2009-04-27T13:41:19.143
> 
> 标签：.net, f#, module

是否可以跨文件拆分 F# 模块？

根据我拥有的书，但这本书可能已经过时了（F#的基础）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-27T13:58:47.760

显然不是：

```
C:\temp\Tim>type 1.fs 2.fs

1.fs

#light
module Module

let sayHello1 = printfn "Hello, "

2.fs

#light
module Module

let sayHello2 = printfn "world!"

C:\temp\Tim>fsc 1.fs 2.fs
Microsoft F# Compiler, (c) Microsoft Corporation, All Rights Reserved
F# Version 1.9.6.2, compiling for .NET Framework Version v2.0.50727

2.fs(2,1): error FS0191: An implementation of the file or module Module has already been given. 
```

更新：F# 4.0 中的错误发生了变化，现在是：

> 错误 FS0248：名为“模块”的两个模块出现在此程序集的两个部分中

where`Module`是程序集的完全限定名称，包括命名空间部分。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-29T04:14:05.230

类型扩展很酷，希望它们允许跨文件，*同时仍然是固有*的。如果您在同一个文件中进行类型扩展，它会编译为一个类，并且扩展可以访问私有成员等等。如果您在另一个文件中执行此操作，它只是一个“可选”扩展，如 C# 静态扩展方法。（尽管 F# 规范有不同的说法。）

如果在某些时候没有解决这个问题，我会感到惊讶，如果只是为了设计师的支持。如果内在类型扩展可以在程序集中的任何地方，那将是非常巧妙的。

另一个可能不是您想要的选项是创建一个类型和一个模块，以相同的名称调用模块，然后将 ModuleSuffix 标志添加到它：

```
type Foo() = 
    static member Bar = 1

[<CompilationRepresentationAttribute(CompilationRepresentationFlags.ModuleSuffix)>]
module Foo =
    let Baz = 2

printfn "%d %d" Foo.Bar Foo.Baz 
```

这在 F# 库中使用，因此它们可以具有类型 List 或其他类型，以及模块中的大量帮助内容。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-27T19:21:36.780

就像 Kurt 所说，您可以向类型添加扩展方法，因此

```
// File1.fs
namespace Foo

type Mine() =
    static member f1 () = () 
```

然后

```
// File2.fs
type Foo.Mine with
    static member f2() = ()

Foo.Mine.    // both f1 and f2 here 
```

因为它是一个类而不是一个模块，所以你失去了“打开我的”的能力（但获得了超载的能力）；因此，这可能是也可能不是您可以接受的选择，具体取决于您正在做什么。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-11-07T18:44:12.123

在我的一个项目中，目标是放置文件操作`Cp`并`Rm`分离模块，但不需要用户为这两个任务打开两个命名空间。

```
open Xake.FileTasks
...
do! Cp "*/*.exe" "deploy/*.exe"
do! Rm "*/*.exe" 
```

这是我的模块：

```
namespace Xake.FileTasks

[<AutoOpen>]
module RmImpl =
    let Rm filemask target =
... 
```

另一个：

```
namespace Xake.FileTasks

[<AutoOpen>]
module CpImpl =
    let Cp filemask target =
... 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-27T16:17:24.650

我有时会在几个地方拆分一个类型，如下所示：

```
module Foo

type Partial = Bar | BarInt of int

module Bar

type Foo.Partial with
    member x.Extend = 5

let b = Foo.Bar.Extend 
```

其中模块 Foo 和 Bar 位于不同的文件中。

# model-view-controller - 如何在 Web MVC 框架中正确实现策略模式？

> ID：793548
> 
> 赞同：1
> 
> 时间：2009-04-27T13:44:18.840
> 
> 标签：model-view-controller, design-patterns, strategy-pattern

在我的 Django 应用程序中，我有一个模型（我们称之为 Foo），其中包含一个名为“type”的字段。我想使用 Foo.type 来指示 Foo 的特定实例是什么类型（可能的选择是“数字”、“日期”、“单行文本”、“多行文本”等等） .

我希望“类型”字段最终影响两件事；一个值从其普通类型转换为文本的方式（例如，在“日期”中，它可能是`str(the_date.isoformat())`），以及一个值从文本转换为指定类型的方式（在“日期”中，它可能是`datetime.date.fromtimestamp(the_text)`）。

对我来说，这似乎是策略模式（我可能完全错了，如果我错了，请随时纠正我）。我的问题是，在 Web MVC 框架中进行编码的正确方法是什么？

在客户端应用程序中，我将使用抽象方法“serialize()”和“unserialize()”创建一个 Type 类，在 Type 的子类（例如 NumberType 和 DateType）中覆盖这些方法，并动态设置“type " 在运行时将新实例化的 Foo 字段添加到适当的 Type 子类。

在 Web 框架中，这对我来说并不那么简单。现在，最有意义的方法是将 Foo.type 定义为 Small Integer 字段并定义一组有限的选择（0 =“数字”，1 =“日期”，2 =“单行文本”，等）在代码中。然后，当实例化 Foo 对象时，使用 Factory 方法查看实例的“type”字段的值并插入正确的 Type 子类（如上段所述）。Foo 也有 serialize() 和 unserialize() 方法，它们将直接委托给插入的 Type 子类。

这个设计听起来怎么样？我以前从未遇到过这个问题，所以我真的很想知道其他人是否有，以及他们是如何解决的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T16:33:47.730

您可以查看 django [ORM](http://docs.djangoproject.com/en/dev/topics/db/models/#id5)提供的继承内容。这将为您提供实际子类化模型的方法，该模型带有鉴别器、不同的表等。

```
Foo # base
DateFoo(Foo)
OtherFoo(Foo) 
```

ETC...

# vb.net - 如何在 VB.Net 3.0 中获得控件的句柄？

> ID：793549
> 
> 赞同：0
> 
> 时间：2009-04-27T13:44:18.933
> 
> 标签：vb.net

我需要将控件的句柄作为 IntPtr 传递给 vb.Net 3.0 中的屏幕捕获类。试过这个但得到一个无效的句柄异常。

```
Dim hwnd As IntPtr = Runtime.InteropServices.GCHandle.Alloc(CanvasMap) 
```

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T13:47:32.450

VB.Net 没有 3.0 版本。你指的是VS2008附带的VB.Net版本吗？如果是这样，那实际上是 VB.Net 9.0 版。从VB6切换时他们没有重置版本号，他们只是不断增加。

这是一个 WinForms 项目吗？如果是这样，您可以使用 CanvasMap.Handle 来访问控件。请注意，此属性在实际显示之前无效，但在大多数情况下都是如此。

**编辑**OP 提到这是一个 WPF 应用程序

我不确定您是否可以对 WPF 应用程序中的任何控件执行此操作。[可以使用 WPF（链接](http://msdn.microsoft.com/en-us/library/system.windows.interop.windowinterophelper.handle.aspx)）中的 WindowInteropHelper 获取 Window 实例的句柄。但这不适用于普通的 Control 实例。

为什么需要手柄？拥有包含窗口的句柄会起作用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T13:47:51.390

`ctrlSomeControl.Handle`?

# ssl - 以编程方式获得颁发给的 ssl 证书

> ID：793556
> 
> 赞同：2
> 
> 时间：2009-04-27T13:46:34.543
> 
> 标签：ssl

我正在尝试使用代码访问在 IIS（6 或 7）上运行的 URL，并在其中找出 SSL 证书是什么，特别是证书的颁发对象。如果证书有效，通常这是站点的 URL。但是，就我而言，我想从负载均衡器后面的内部 IP 获取信息，所以我不能指望这一点。有人知道如何实现吗？最好使用 C#，但我对任何其他开发语言持开放态度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T15:32:35.723

我设法找到了一种方法来做到这一点。如果您安装 OpenSSL：[http](http://www.openssl.org) ://www.openssl.org （以及此处的 Windows 版本：[http](http://www.slproweb.com/products/Win32OpenSSL.html) ://www.slproweb.com/products/Win32OpenSSL.html ），您可以使用其命令行界面来查询这样的证书: openssl s_client -connect IP:443 然后你只需要检查颁发证书的站点的响应。

# visual-studio-2008 - 转换解决方案后 Visual Studio 2008 关闭

> ID：793557
> 
> 赞同：0
> 
> 时间：2009-04-27T13:46:50.580
> 
> 标签：visual-studio-2008

转换任何 VS2005 解决方案后，VS2008 会立即关闭。

解决方案图标从 8 更改为 9，但如果我尝试打开解决方案，它会尝试再次转换它，然后它会关闭（等等）。

有人见过这个吗？重新安装是去这里的唯一方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T20:55:57.610

如果您还没有这样做，您可能需要查看升级日志和您的事件日志，看看它们是否有任何条目可以引导您朝着正确的方向前进。

抱歉，我只是将此建议添加为评论，但我没有足够高的声誉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T20:55:10.597

尝试将调试器（即 Visual Studio 的另一个实例）连接到它，（使用工具 - 附加到进程）。可以选择在开始转换之前设置“异常中断”（Ctrl-Alt-E）。

希望这会闯入调试器，为您提供崩溃的线索。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T20:57:31.403

我以前见过。我总是最终手动移动我的项目。

# jquery - 使用 jquery-ui draggable 对可拖动对象进行分组

> ID：793559
> 
> 赞同：48
> 
> 时间：2009-04-27T13:47:01.033
> 
> 标签：jquery, jquery-ui, jquery-ui-draggable, jquery-ui-droppable

我想使用 jquery draggable/droppable 让用户选择一组对象（每个对象在角落都有一个复选框），然后将所有选定的对象作为一个组拖动......

我无法弄清楚我的生活如何做到这一点哈哈。

这是我认为会导致可用解决方案的方法，在每个可拖动对象上，使用 start() 事件并以某种方式抓取所有其他选定对象并将它们添加到选择中

出于性能原因，我还在考虑让拖动的对象看起来像一组对象（它们是图像，所以可能是一堆照片）。我认为如果一次拖动几十个对象，使用可拖动功能可能会失败，这听起来是一个更好的主意吗？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-05-02T19:25:27.337

您可以使用可拖动的`helper`选项来拖动项目组。

例如，如果您的可拖动对象有复选框，您可以从辅助函数返回选定的项目，如下所示：

```
$('#dragSource li').draggable({
  helper: function(){
    var selected = $('#dragSource input:checked').parents('li');
    if (selected.length === 0) {
      selected = $(this);
    }
    var container = $('<div/>').attr('id', 'draggingContainer');
    container.append(selected.clone());
    return container; 
  }
}); 
```

## 演示

我已经设置了一个带有复选框和一些流畅布局的可拖动图像的演示。点击底部的“Run Code Snippet”查看结果：

```
$(function() {

  $('#dragSource li').draggable({
    helper: function() {
      var selected = $('#dragSource input:checked').parents('li');
      if (selected.length === 0) {
        selected = $(this);
      }
      var container = $('<div/>').attr('id', 'draggingContainer');
      container.append(selected.clone());
      return container;
    }
  });

  $('#dropTarget').droppable({
    tolerance: 'pointer',
    drop: function(event, ui) {
      $(this).append(ui.helper.children());
    }
  });

  $('#selectAll').click(function() {
    $('#dragSource input').prop('checked', true);
    return false;
  });

  $('#selectNone').click(function() {
    $('#dragSource input').prop('checked', false);
    return false;
  });

  $('#selectInvert').click(function() {
    $('#dragSource input').each(function() {
      var $this = $(this);
      if ($this.prop('checked')) {
        $this.prop('checked', false);
      } else {
        $this.prop('checked', true);
      }
    });
    return false;
  });
});
```

```
body {
  font-family: sans-serif;
  overflow-x: hidden;
}
div {
  margin: 5px;
  padding: 0;
}
ul {
  margin: 0;
  padding: 0;
}
li {
  list-style: none;
  padding: 0;
  margin: 0;
  float: left;
  white-space: nowrap;
}
#selectActions span,
#selectActions li {
  float: left;
  padding: 5px;
}
.droppableContainer {
  width: 48%;
  float: left;
  min-height: 200px
}
.droppableContainer li {
  height: 90px;
  width: 110px;
  margin: 2px;
  background-color: white;
  padding-bottom: 4px;
}
.droppableContainer img {
  width: 90px;
  max-height: 90px;
  max-width: 90px;
  width: 90px;
  vertical-align: middle;
}
.droppableContainer input {
  height: 90px;
  vertical-align: middle;
}
#draggingContainer {
  width: 48%;
}
#draggingContainer input {
  visibility: hidden;
}
#dropTarget {
  border: 3px dashed grey;
}
#dropTarget input {
  visibility: hidden;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>

<div id="selectActions">
  <span>Select:</span>
  <ul>
    <li><a id="selectAll" href="#">all</a>
    </li>
    <li><a id="selectNone" href="#">none</a>
    </li>
    <li><a id="selectInvert" href="#">invert</a>
    </li>
  </ul>
</div>
<div style="clear:left;">
  <div id="dragSource" class="droppableContainer">
    <ul>
      <li>
        <img src="http://imgs.xkcd.com/comics/drapes.png" /><input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/misusing_slang.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/donner.jpg" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/a_new_captcha_approach.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/bug.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/open_source.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/tag_combination.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/a_simple_plan.jpg" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/it_might_be_cool.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/hedgeclipper.jpg" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/pep_talk.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/regular_expressions.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/pwned.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/post_office_showdown.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/im_an_idiot.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/pointers.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/chess_photo.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/50_ways.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/e_to_the_pi_times_i.png" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/self-reference.jpg" />
        <input type="checkbox" />
      </li>
      <li>
        <img src="http://imgs.xkcd.com/comics/starwatching.png" />
        <input type="checkbox" />
      </li>
    </ul>
  </div>

  <div id="dropTarget" class="droppableContainer">
  </div>
</div>
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T16:53:52.470

表现理念：

制作一个不可见的“组对象”。当项目被选中时，使它们成为组对象的子对象，当未选中时，将它们设置回文档正文的子对象，或者静态父对象或其他任何东西。您必须转换对象的位置以确保它们不会跳来跳去，还必须在添加/删除它们时将鼠标事件处理程序附加/分离到组的子级。

当您在任何孩子上获得鼠标向下/向上事件时，您将移动的实际上是该组对象。

这应该使它整体上更简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T00:14:34.643

这正是我想要做的事情。到目前为止，我还没有成功，但我发现[这个人](http://thechriswalker.net/2009-02/multiple-drag-and-drop-between-two-lists-with-jquery.html)以非常复杂的方式完成了它。你可以检查一下，也许你可以用它做点什么。

这应该是可拖动的功能。我希望他们早日实施

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-27T18:18:08.823

我为此所做的是创建了一个函数，您将其赋予从属/主元素，该函数为主创建一个 bind() 函数（在这种情况下，我只允许从主拖动，您可以解决我敢肯定），这使得奴隶使用标准的 jQuery css 跟随它。

```
 function overlap(slave,master) {
        $('a#groupTheseBlocks').click(function(){
            master.bind('drag', groupBlocks);
            slave.draggable('disable');

            // remember where the slave is in relation to the master
            sLeftRef = (slave.offset().left - master.offset().left);
            sTopRef = (slave.offset().top - master.offset().top);
        });

        function groupBlocks() {
            var left = master.offset().left;
            var top = master.offset().top;

            slave.draggable('disable');
            slave.css('left', (left + sLeftRef) + 'px');
            slave.css('top', (top + sTopRef) + 'px');

        } 
    } 
```

我想一旦我有一个工作示例，我会发布更多内容。就目前而言，这对我有用。缺少的是一种将要组合在一起的元素调用重叠（从属，主控）的方法。我正在以一种非常具体的方式来做这件事。我敢肯定，你可以用聪明的方法来做到这一点。

# c# - 在虚函数中抛出异常是一种好习惯吗？

> ID：793561
> 
> 赞同：0
> 
> 时间：2009-04-27T13:47:48.347
> 
> 标签：c#

*即使解决方案如此明显，我也不应该发布此内容，但我将其留作提醒和对他人有用的参考点。*

我有以下基类：

```
using System;

namespace LibraryWPF
{
    public class Library
    {
        /// <summary>
        /// Event fired when content is added to the libary
        /// </summary>
        public event EventHandler<ObjectInfoEventArgs> Library_ObjectAdded;

        /// <summary>
        /// Event fired when the scan of the library is finished
        /// </summary>
        public event EventHandler Library_Finished;

        // Properties

        /// <summary>
        /// Whether to stop checking the library or not
        /// </summary>
        public bool Stop
        {
            get;
            set;
        }

        /// <summary>
        /// Where to look for content
        /// </summary>
        public string Root
        {
            get;
            set;
        }

        /// <summary>
        /// Empty instance of library's object for reflection
        /// </summary>
        public virtual object ObjectInfo
        {
            get
            {
                // Should this raise as exception to show if it's not been overridden?
                return null;
            }
        }

        /// <summary>
        /// Sub class overrides this method to call it's actual find code
        /// </summary>
        public virtual void Find()
        {
            // Should this raise as exception to show if it's not been overridden?
        }

        /// <summary>
        /// Build the library
        /// </summary>
        public void Build()
        {
            if (Root != null && Root.Length > 0)
            {
                Stop = false;
                Find();
            }

            // Final update
            if (Library_Finished != null)
            {
                Library_Finished(this, null);
            }
        }

        /// <summary>
        /// Sub class calls this method to fire the ObjectAdded event
        /// </summary>
        /// <param name="objectInfo">Object just added to library</param>
        protected void OnObjectAdded(object objectInfo)
        {
            if (Library_ObjectAdded != null)
            {
                Library_ObjectAdded(this, new ObjectInfoEventArgs(objectInfo));
            }
        }
    }
} 
```

子类覆盖`ObjectInfo`以返回它们正在寻找反射使用的对象类型的实例。它们还覆盖`Find`以进行实际搜索。

这样我的应用程序代码就可以使用基类方法，因此它在编译时不必知道任何关于子类的信息。我告诉它使用 DI 寻找什么样的内容。

所以 - 我的问题是：

我是否应该在 and 的基类版本中抛出异常，`ObjectInfo`以便`Find`如果子类没有正确实现，我会收到运行时错误？或者我应该编码`ObjectInfo`返回`null`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-27T13:50:56.280

如果你要求一个方法由派生类实现，为什么不让它抽象而不是虚拟呢？这将强制派生类实现该成员。如果他们不想或无法返回 ObjectInfo，他们可以选择自己返回 null。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T13:53:05.103

您应该将您的基类和派生类实现的方法声明为抽象。这完全避免了探测，因为编译器将检测不覆盖所有抽象方法的派生类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T14:15:45.130

我认为在某些情况下该属性是可选的，您应该有一个属性：ObjectInfo 和一个布尔值“SupportObjectInfo”。

在这种情况下，您将 ObjectInfo 属性标记为虚拟并引发 NotSupportedException。

您这样做是因为您的类的消费者可以测试它是否支持该属性，并且不必捕获错误进行测试。

如果在实现中它不是可选的，则应将其标记为抽象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T19:59:29.840

如果您想“保护”基类的调用者免受从您的基类派生的类引发的潜在意外异常，请考虑使用模板模式来捕获派生类引发的任何错误并将它们转换为您的异常在基类上定义。您还应该考虑将派生类抛出的异常作为内部异常传递。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T13:51:39.197

您当然可以这样做，但异常通常表示执行时错误，而不是实现错误。

# silverlight - 在 Silverlight 中响应媒体密钥

> ID：793564
> 
> 赞同：1
> 
> 时间：2009-04-27T13:48:03.510
> 
> 标签：silverlight

Silverlight 应用程序是否可以响应播放/暂停和音量等媒体键？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T15:06:16.990

如果这些键映射到键盘组合（如 Ctrl-Alt-P），那么是的。你可以做一个简单的测试，看看当你按下按钮时是否触发了任何 keydown/keyup 事件。迈克尔

# asp.net - 多个 Html.ValidationSummary 在单个 .Net MVC 页面中？

> ID：793566
> 
> 赞同：2
> 
> 时间：2009-04-27T13:48:47.487
> 
> 标签：asp.net, asp.net-mvc

是否可以在单个 .Net MVC 页面中有多个 Html.ValidationSummary？

我在同一页面上有一个创建用户和一个登录表单，并且想要总结

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T14:57:41.113

您可以，但它们都会显示相同的 ModelState 验证错误，这可能不是您想要的。您可能需要创建特殊的 ViewData 项来分别显示错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T22:40:58.623

您始终可以创建两个摘要并将它们填充到您的视图模型中。然后创建一个局部视图来显示摘要。

# java - 使用反射搜索和调用方法的开销

> ID：793568
> 
> 赞同：1
> 
> 时间：2009-04-27T13:49:33.490
> 
> 标签：java, reflection

我有一个类应该读取消息，从信封中提取其类型，然后调用必须处理消息的方法；每个消息类型都关联一个枚举成员。

有 30 多种消息类型。

发送消息的一种方法是只使用一个开关，但它真的很丑而且容易出错（我是否已经处理过这种情况？我是否已经处理过两次？）。

另一种方法是使用单个方法 process(data) 定义一个接口，并为实现该接口的每种消息类型创建一个类，使用映射注册这些类，并且在应该处理消息的代码中，只需调用 map.获取（消息类型）。过程（数据）；但是创建 30 多个类真的很烦人。

另一种方法是使用反射：为每个消息类型定义一个函数，具有精确的签名和模式名称，如 processMessagetype；然后创建一个从消息类型到方法的映射（在 getDekkaredMethods() 上进行简单搜索），然后执行以下操作：map.get(messageType).invoke(this,data)。

你应该使用什么方法？使用java的反射有什么开销？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T14:20:05.803

如果您正在寻找良好的性能，反射会产生很大的开销。如果您的例程（消息调度）将被一遍又一遍地使用，那么多态性替代方案会更好。此外，如果从 OO 的角度来看，IMO 会更好，因为正如[Brian](https://stackoverflow.com/questions/793568/overhead-of-searching-and-calling-a-method-with-reflection/793593#793593)在他的回答中所说的那样，维护起来更容易也更便宜。

您处理 30 多条消息的类很容易增长到 100 多条消息，然后您将拥有一个具有 100 多种方法的类，还要添加私有方法，代码重用将很困难，您的类就变得一团糟。

多态性和开关的反射开销是这样的：

```
time spent on a switch case call: 1
time spent on a polymorphism call: 1.1
time spent on a reflection call: 1.9-2.0 
```

不久前我对这些人进行了基准测试，这些是我的结果，我现在没有代码，因为这些基准测试是在我以前的公司完成的，我再也无法访问该代码了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T14:08:51.480

您可以将 process 方法添加到枚举中。

大开关到底有什么问题（每种情况都只是调用一个方法）？

反射的主要代价是它会使代码变得糟糕。;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T13:54:32.417

您没有说您的 process() 方法将要做什么，但是如果调度方法调用的任何开销非常重要，我会感到惊讶。

我会让语言和 OO 系统为您工作，并创建一个具有适当方法实现的接口/抽象基类。

请记住，过早的优化是万恶之源（[Knuth](http://en.wikiquote.org/wiki/Donald_Knuth)）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T14:27:01.980

我会猜测，因为您正在谈论“消息”和“信封”，您正在通过网络传递这些消息。这样做所花费的时间绝对会*支配*反思所花费的额外时间。我用过这样的反射，它不是一个坏模型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T13:55:14.430

我认为您描述的第一个方法/算法（消息类型到类的映射）会随着时间的推移通过更新、维护等更容易管理。

您描述的第二种模式基本上涉及一个包含大约 30 多个方法的类，对吗？随着时间的推移，这将是一个相当痛苦的管理。

每种消息类型都需要真正独特的处理逻辑吗？通过创建处理消息的接口的实现，您可能会受益于类型层次结构，即可以处理解析某个消息系列的超类，然后您只需在该系列的消息不同的区域覆盖它。 ..

# c++ - 从服务加载用户配置文件

> ID：793569
> 
> 赞同：5
> 
> 时间：2009-04-27T13:49:59.700
> 
> 标签：c++, windows, createprocessasuser

在服务中，我尝试使用以下代码启动程序：

```
HANDLE hPipe;
HANDLE hToken;
PROFILEINFO stProfileInfo;
char szUserName[64];
DWORD dwUserNameSize = 64;

// Take the identity of the client
ImpersonateNamedPipeClient(hPipe);

// Retrieve the user name (DOMAIN\USER)
GetUserNameEx(NameSamCompatible,szUserName,&dwUserNameSize);

// Get the impersonation token
OpenThreadToken(GetCurrentThread(),TOKEN_ALL_ACCESS,TRUE,&hToken);

// Load the user's profile
ZeroMemory(&stProfileInfo,sizeof(PROFILEINFO));
stProfileInfo.dwSize = sizeof(PROFILEINFO);
stProfileInfo.dwFlags = PI_NOUI;
stProfileInfo.lpUserName = szUserName;
LoadUserProfile(hToken,&stProfileInfo); 
```

不幸的是，调用`LoadUserProfile`失败的`GetLastError=5 (access denied)`. 在 userenv.log 中，我可以找到：

```
USERENV LoadUserProfile: Yes, we can impersonate the user. Running as self
USERENV LoadUserProfile: Entering, hToken = <0xc8>, lpProfileInfo = 0xb30aa4
USERENV LoadUserProfile: lpProfileInfo->dwFlags = <0x1>
USERENV LoadUserProfile: lpProfileInfo->lpUserName = <MYDOMAIN\USERNAME>
USERENV LoadUserProfile: NULL central profile path
USERENV LoadUserProfile: NULL default profile path
USERENV LoadUserProfile: NULL server name
USERENV LoadUserProfile: Failed to enable the restore privilege. error = c0000022
USERENV LoadUserProfile: Returning FALSE. Error = 5 
```

当然，我检查了我的服务（以 SYSTEM 身份运行）是否启用了`SE_RESTORE_NAME`（和`SE_BACKUP_NAME`）权限。

任何帮助将不胜感激 ！

# c# - 为什么要使用表达式 > 而不是 Func ?

> ID：793571
> 
> 赞同：1059
> 
> 时间：2009-04-27T13:50:14.503
> 
> 标签：c#, delegates, lambda, expression-trees

我了解 lambdas 和 the`Func`和`Action`代表。但是表情难住了我。

在什么情况下你会使用 an`Expression<Func<T>>`而不是普通的 old `Func<T>`？

* * *

## 回答 #1

> 赞同：1244
> 
> 时间：2009-04-27T13:52:31.423

当您想将 lambda 表达式视为表达式树并查看它们而不是执行它们时。例如，LINQ to SQL 获取表达式并将其转换为等效的 SQL 语句并将其提交给服务器（而不是执行 lambda）。

从概念上讲，`Expression<Func<T>>`与*完全*不同`Func<T>`。`Func<T>`表示 a `delegate`，它几乎是指向方法的指针，并`Expression<Func<T>>`表示 lambda 表达式的*树数据结构*。这个树形结构**描述了 lambda 表达式**所做的事情，而不是实际做的事情。它基本上保存有关表达式、变量、方法调用的组合的数据，......（例如，它保存诸如这个 lambda 是某个常量+某个参数之类的信息）。您可以使用此描述将其转换为实际方法（使用`Expression.Compile`）或使用它执行其他操作（如 LINQ to SQL 示例）。将 lambdas 视为匿名方法和表达式树的行为纯粹是编译时的事情。

```
Func<int> myFunc = () => 10; // similar to: int myAnonMethod() { return 10; } 
```

将有效地编译成一个什么都得不到并返回 10 的 IL 方法。

```
Expression<Func<int>> myExpression = () => 10; 
```

将被转换为描述一个没有参数并返回值 10 的表达式的数据结构：

[![表达式与函数](https://i.stack.imgur.com/gwU0E.jpg) *大图*](https://i.stack.imgur.com/gwU0E.jpg)

虽然它们在编译时看起来相同，但编译器生成的却**完全不同**。

* * *

## 回答 #2

> 赞同：428
> 
> 时间：2016-01-05T08:04:54.547

我正在添加一个新手答案，因为这些答案似乎在我脑海中，直到我意识到它是多么简单。有时，您期望它很复杂，这使您无法“绕开它”。

直到我遇到一个非常烦人的“错误”，试图通用地使用 LINQ-to-SQL 时，我才需要了解其中的区别：

```
public IEnumerable<T> Get(Func<T, bool> conditionLambda){
  using(var db = new DbContext()){
    return db.Set<T>.Where(conditionLambda);
  }
} 
```

在我开始在更大的数据集上遇到 OutofMemoryExceptions 之前，这一直很有效。在 lambda 中设置断点让我意识到它正在逐一遍历表中的每一行，以寻找与我的 lambda 条件匹配的内容。这让我困惑了一段时间，因为它为什么将我的数据表视为一个巨大的 IEnumerable 而不是像它应该做的那样做 LINQ-to-SQL？它也在我的 LINQ-to-MongoDb 对应物中做同样的事情。

修复只是简单地`Func<T, bool>`变成`Expression<Func<T, bool>>`，所以我用谷歌搜索了为什么它需要一个`Expression`而不是`Func`，在这里结束。

**表达式只是将委托转换为有关其自身的数据。**所以`a => a + 1`变成了“在左边有一个`int a`. 在右边你加 1 ”之类的东西。**就是这样。**你现在可以回家了。它显然比这更有条理，但这实际上就是一个表达式树的全部内容——没有什么可以让你头疼的。

理解这一点，就很清楚为什么 LINQ-to-SQL 需要 a `Expression`，而 a`Func`是不够的。`Func`它没有一种进入自身的方式，无法了解如何将其转换为 SQL/MongoDb/其他查询的本质。你看不到它是在做加法还是乘法或减法。你所能做的就是运行它。`Expression`，另一方面，允许您查看委托内部并查看它想要做的一切。这使您能够将委托转换为您想要的任何内容，例如 SQL 查询。`Func`不起作用，因为我的 DbContext 对 lambda 表达式的内容视而不见。因此，它无法将 lambda 表达式转换为 SQL；但是，它做了次好的事情，并通过我表中的每一行迭代了该条件。

编辑：应约翰彼得的要求解释我的最后一句话：

IQueryable 扩展了 IEnumerable，因此 IEnumerable 的方法如`Where()`获取接受的重载`Expression`。当你将 an 传递`Expression`给它时，你会保留一个 IQueryable 作为结果，但是当你传递 a 时`Func`，你会退回到基础 IEnumerable 并且你会得到一个 IEnumerable 作为结果。换句话说，你没有注意到你已经把你的数据集变成了一个要迭代的列表，而不是要查询的东西。除非您真正深入了解签名，否则很难注意到差异。

* * *

## 回答 #3

> 赞同：113
> 
> 时间：2012-01-11T15:57:43.827

选择 Expression 与 Func 的一个极其重要的考虑因素是，像 LINQ to Entities 这样的 IQueryable 提供程序可以“消化”您在 Expression 中传递的内容，但会忽略您在 Func 中传递的内容。我有两篇关于这个主题的博客文章：

[更多关于使用实体框架](http://fascinatedwithsoftware.com/blog/post/2012/01/10/More-on-Expression-vs-Func-with-Entity-Framework.aspx)的表达式与函数以及 [爱上 LINQ - 第 7 部分：表达式和函数](http://fascinatedwithsoftware.com/blog/post/2011/12/02/Falling-in-Love-with-LINQ-Part-7-Expressions-and-Funcs.aspx)（最后一节）

* * *

## 回答 #4

> 赞同：100
> 
> 时间：2016-03-11T13:10:05.150

*Krzysztof Cwalina 的书（ Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries* ）对此有更哲学的解释；

> [![里科·马里亚尼](https://i.stack.imgur.com/0U7TC.jpg)](https://i.stack.imgur.com/0U7TC.jpg)

**编辑非图像版本：**

> *大多数情况下，如果只需要运行一些代码，您将需要**Func**或**Action 。**当代码需要在运行之前进行分析、序列化或优化时，您需要**Expression 。****表达式**用于思考代码，**Func/Action**用于运行代码。*

* * *

## 回答 #5

> 赞同：87
> 
> 时间：2013-06-11T00:02:19.673

我想添加一些关于 和 之间差异的`Func<T>`注释`Expression<Func<T>>`：

*   `Func<T>`只是一个普通的老式 MulticastDelegate；
*   `Expression<Func<T>>`是表达式树形式的 lambda 表达式的表示；
*   表达式树可以通过 lambda 表达式语法或 API 语法构建；
*   表达式树可以编译为委托`Func<T>`；
*   反向转换在理论上是可能的，但它是一种反编译，没有内置功能，因为它不是一个简单的过程；
*   可以通过`ExpressionVisitor`;观察/翻译/修改表达式树
*   IEnumerable 的扩展方法使用`Func<T>`;
*   IQueryable 的扩展方法使用`Expression<Func<T>>`.

有一篇文章描述了代码示例的详细信息：
[LINQ: Func<T> vs. Expression<Func<T>>](http://ivanitskyi.blogspot.com/2013/06/linq-func-vs-expression.html)。

希望它会有所帮助。

* * *

## 回答 #6

> 赞同：41
> 
> 时间：2009-04-27T14:13:25.103

LINQ 是典型的例子（例如，与数据库交谈），但事实上，任何时候你更关心表达*要做*什么，而不是实际去做。例如，我在[protobuf-net](https://github.com/mgravell/protobuf-net)的 RPC 堆栈中使用这种方法（以避免代码生成等） - 所以你调用一个方法：

```
string result = client.Invoke(svc => svc.SomeMethod(arg1, arg2, ...)); 
```

这将解构要解析的表达式树`SomeMethod`（以及每个参数的值），执行 RPC 调用，更新任何`ref`/ `out`args，并返回远程调用的结果。这只能通过表达式树实现。我[在这里](http://marcgravell.blogspot.com/2009/03/explaining-expression.html)更详细地介绍了这一点。

另一个示例是当您手动构建表达式树以编译为 lambda 时，如[通用运算符](http://www.yoda.arachsys.com/csharp/miscutil/usage/genericoperators.html)代码所做的那样。

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2009-04-27T13:53:05.027

当您想将函数视为数据而不是代码时，您将使用表达式。如果您想操作代码（作为数据），您可以这样做。大多数情况下，如果您不需要表达式，那么您可能不需要使用表达式。

* * *

## 回答 #8

> 赞同：22
> 
> 时间：2014-03-26T12:54:33.083

主要原因是您不想直接运行代码，而是想检查它。这可能有多种原因：

*   将代码映射到不同的环境（即 C# 代码到实体框架中的 SQL）
*   在运行时替换部分代码（动态编程甚至是普通的 DRY 技术）
*   代码验证（在模拟脚本或进行分析时非常有用）
*   序列化 - 表达式可以相当容易和安全地序列化，委托不能
*   对本质上不是强类型的事物进行强类型安全，并利用编译​​器检查，即使您在运行时进行动态调用（带有 Razor 的 ASP.NET MVC 5 就是一个很好的例子）

* * *

## 回答 #9

> 赞同：21
> 
> 时间：2017-06-16T15:58:20.733

使用 LINQ-to-SQL 时，将`Func<>`s 传递给`Where()`or`Count()`是不好的。真糟糕。如果您使用 a `Func<>`then 它调用`IEnumerable`LINQ 的东西而不是`IQueryable`，这意味着整个表被拉入*然后*过滤。`Expression<Func<>>`速度要快得多，因为它**在 SQL 服务器上**执行过滤——尤其是当您查询存在于另一台服务器上的数据库时。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2020-08-12T08:51:04.280

这里过于简化了，但 Func 是一台机器，而 Expression 是一个蓝图。:D

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-09-26T18:10:39.793

很高兴知道您可以使用`Func<TEntity, bool>`扩展`AsQueryable()`方法，例如`Expression<Func<TEntity, bool>>`.

```
Func<App, bool> filter = x => x.Alias.Contains("gan");
var query = dbSet.Where(filter).AsQueryable(); 
```

`Count()`在您使用类似or的执行方法之前，不会执行查询`ToList()`。

# matlab - 如何在 MATLAB 中调整矩阵的大小？

> ID：793574
> 
> 赞同：8
> 
> 时间：2009-04-27T13:51:01.007
> 
> 标签：matlab, matrix, reshape

假设我有一个**1×12**矩阵，我想将其调整为**4×3**矩阵。我怎么能这样做？

我目前的解决方案有点难看：

```
for n = 1:(length(mat)/3)
    out(n,1:3) = mat( ((n-1)*3 + 1):((n-1)*3 + 3) );
end 
```

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-27T14:14:14.540

`reshape`正如[@gnovice](https://stackoverflow.com/a/793581/5211833)所述，当然是正确的解决方案。

的一个不错的功能`reshape`是它允许这样做：

```
A = 1:12;
B = reshape(A,4,[]);
B =
     1     5     9
     2     6    10
     3     7    11
     4     8    12 
```

因此，如果您不知道会有多少列，`reshape`将为您计算它。同样，`reshape`将填写行数，如果您忽略它。

```
C = reshape(A,[],4)
C =
     1     4     7    10
     2     5     8    11
     3     6     9    12 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-27T13:52:13.937

试试[RESHAPE](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/reshape.html)函数：

```
A = (1-by-12 matrix);
B = reshape(A,4,3); 
```

请注意，矩阵**B**将以列方式填充来自**A**的元素（即，列将从上到下填充，从左到右移动）。

例子：

```
>> A = 1:12;
>> B = reshape(A,4,3)

B =

     1     5     9
     2     6    10
     3     7    11
     4     8    12 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-27T14:02:00.450

扩展 gnovice 的解决方案：

如果您需要不同的矩阵构造顺序，请使用转置（' 运算符）或[`permute()`](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/permute.html)在调用`reshape()`.

# sql-server-2005 - 如何对高度规范化的数据库系统进行非规范化？

> ID：793575
> 
> 赞同：3
> 
> 时间：2009-04-27T13:51:02.397
> 
> 标签：sql-server-2005, performance, caching, denormalization

我希望将一些数据库非规范化引入高度规范化的系统。

我拥有大量数据库，这些数据库已经发展了十多年，并且负载量不断增加，因此我希望提高性能并可能降低某些查询的复杂性。

执行 10 次连接来完成存储过程中的任何给定任务的情况并不少见。有人告诉我，超过 6 种臭味。

我应该保持表结构不变并提供一些物化视图或非规范化的“缓存”表。

一些关于最佳实践的建议或推动正确方向会有所帮助。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-27T13:57:39.103

你不说是什么问题。是性能吗？如果是这样，在什么桌子上？

真的是导致问题的连接吗？还是存储过程？你不知道（或者至少，你不说）。

最佳实践：在尝试解决尚未诊断的问题之前，首先找出瓶颈所在。

* * *

编辑时：我想起了在工作中遇到性能问题的时候。非常慢的存储过程，可能需要几分钟才能完成。事实证明，这些 sps 正在执行完全正常的表更新，*但使用 cursors*。对于像`update t set c = c + 1 where id = n`.

因此，为了进行更新，我们使用昂贵的更新游标对一堆行进行游标，`declare cursor for "select c from t where id = n" for update;`然后执行一个打开的游标和一个读取和一个错误检查，以及一个带有读取和错误检查的循环，然后`select c into @c; @c = c + 1; update t set c = @c where current of cursor;`是每次更新。

原来写这篇文章的人没有意识到我们可以发布一个更新声明。所以他写了几十个这样的慢速存储过程。我们甚至不需要删除存储的过程（虽然这也会为我们带来一些速度，但它会改变我们的客户端）；我们刚刚摆脱了游标，用更新语句替换它们。性能问题消失了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T14:01:12.900

### 需要调查的一些事情

*   对所有查询运行时间进行基准测试 - 给自己一个比较的指标。
*   调查索引是否正确完成。
*   阅读[表分区](http://en.wikipedia.org/wiki/Partition_(database))。
*   探索[分片作为一种选择](http://en.wikipedia.org/wiki/Shared_nothing_architecture)。
*   仔细查看您的连接。您是否总是将同一张桌子连接在一起？如果答案不是那么明显，您仍然可以使用视图创建逻辑分区（如非规范化表）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T14:03:24.440

尝试大量和明智地索引。尝试使用索引视图。尝试预编译的存储过程。如果这失败了，请记住非规范化和缓存通常需要大量的同步工作，因此在执行之前应该仔细查看每种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T13:59:38.910

我不得不同意，10 次加入是邪恶的，会扼杀你的表现。

很大程度上取决于您的应用程序如何与数据库交互。如果您的代码严格遵守存储过程（没有直接的 SQL 调用），那么您的生活会更轻松。

如果你要去非规范化的麻烦，我不会添加新的“缓存”表。这实际上只是修补问题。我将继续制定一个完整的计划，以使用新的优化模式对数据库进行非规范化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T14:07:33.027

我同意以利亚的观点。确保你对任何你将要改变的东西进行基准测试。

此外，根据您的设置，索引视图可能是一种选择。

# c# - 如何在 C# 中使用轮盘赌（带有赌桌）进行投注？

> ID：793577
> 
> 赞同：1
> 
> 时间：2009-04-27T13:51:31.567
> 
> 标签：c#

我现在拥有的是一个“投注桌”，一个我放在表格上的图片框。我正在尝试做的是，当您单击其中一个方块时，它会在板上的相应位置打印另一个图像，即扑克筹码的图像，这部分并不困难，只是耗时. 我想知道的是如何让这个东西在放置图像的地方读取。如果可以的话，让它为投注做数学计算是一件容易的事，同样，这只是耗时。先感谢您。

〜T-狐狸

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T13:59:59.237

您可以在背景中创建一个数组来表示图像上的片段。

当用户点击图像上的一个片段时，您可以使用一个值更新相关的 array[i] 来表示分配给该片段的一个`chip`或多个。`chips`

如果您需要刷新它，您也可以使用这个数组来重绘/重绘您的图像。

**编辑**

只是为了跟进，您可能需要在图像上的定义区域和数组之间创建某种相关表。根据映射到数组索引的原点和宽度/高度创建一个矩形。

因此，如果用户单击图像中的某个片段，您可以获取光标 X、Y 值，比较以查看它在哪个矩形中，然后更新该数组值。

# c++ - GotoBookmark 太慢？

> ID：793579
> 
> 赞同：0
> 
> 时间：2009-04-27T13:52:00.380
> 
> 标签：c++, dataset, c++builder

我正在修复一个 C++ Builder 5 应用程序，并且我有以下代码：

```
void __fastcall TFPrincipal::DBGModuleStartDrag(TObject *Sender,
        TDragObject *&DragObject)
{
  m_pParentNodesDragDrop = NULL;
  DragObject = NULL;
  bool bAbort = false;
  m_ListaModulosDragDrop->Clear();
  m_ListaContenedoresDragDrop->Clear();
  CInfoNode *pInfoNode = NULL;
  CInfoModule *pInfoMod = NULL ;
  long l_IdContainerParent = 0;
  TDataSet * DataSet = NULL;

  m_pLastDragNode = NULL;
  m_bLastAccept = false;

  try
  {
        IProductsPtr ProductsPtr =
                m_pgServerConnection->Create<IProducts>( CLSID_CProducts );
        if(DBGModules)
        {
            if ( DBGModules->DataSource )
            {
              if ( DBGModules->DataSource->DataSet )
                {
                  DataSet = DBGModules->DataSource->DataSet;
                  DataSet->DisableControls();
                }
                else return;
            }
            else return;
        }
        else return;
      for (int i = 0; i < DBGModules->SelectedCount; i++)
      {
          DataSet->GotoBookmark(DBGModules->SelectedRows[i].c_str());

          pInfoMod = new CInfoModule( DataSet->FieldByName("IP")->AsString,
                  (long)DataSet->FieldByName("IdComputer")->AsInteger,
                  (Products)DataSet->FieldByName("IdProduct")->AsInteger,
                  DataSet->FieldByName("Host")->AsString,
                  DataSet->FieldByName("Instance")->AsString,
                  DataSet->FieldByName("Version")->AsString,
                  DataSet->FieldByName("AditionalInfo")->AsString,
                  (Antivirus)DataSet->FieldByName("IdAntivirus")->AsInteger,
                  DataSet->FieldByName("NumNotPadmin3AV")->AsInteger,
                  DataSet->FieldByName("NumPadmin3AV")->AsInteger,
                  false,
                  (long)DataSet->FieldByName("IdUnit")->AsInteger,
                  (long)DataSet->FieldByName("IdUnitForInstall")->AsInteger);
          DataSet->FreeBookmark(DataSet->GetBookmark());

          pInfoNode = new CInfoNode();
            pInfoNode->m_pInfoModule = pInfoMod;
      //  Platree::TPlaTreeNode *pNodoSeleccionado = pInfoNode;

      //  if (pNodoSeleccionado)
        {
        // guardamos el padre de uno de los nodos seleccionados para
        // el drag & drop para que usarlo luego para que aparezca desplegada
        // la rama de origen del nodo movido y la rama de destino tras
        // el refresco (parametro del ReloadTree)
        //  if ( ! m_pParentNodesDragDrop )
        //    m_pParentNodesDragDrop = pNodoSeleccionado->Parent;

          //CInfoNode *pInfoNodoSeleccionado;
          //pInfoNodoSeleccionado = (CInfoNode *)pNodoSeleccionado->Data;

          if (pInfoNode->IsModule())
          {
            long l_IdContainerParent = 0;
            m_ListaModulosDragDrop->AddObject(pInfoMod->m_asDisplayName,
                                              (TObject*)pInfoNode);
         /*   TESTHR(ProductsPtr->GetIDContainer(pInfoMod->m_lIdComputer,
                                        pInfoMod->m_pdIDProduct,
                                        WideString(pInfoMod->m_asInstance),
                                        &l_IdContainerParent));*/

           CInfoDragNode *pInfoDragNode = new CInfoDragNode();
           pInfoDragNode->m_asInstance = pInfoMod->m_asInstance;
           pInfoDragNode->m_lIdComputer = pInfoMod->m_lIdComputer;
           pInfoDragNode->m_lIdContainerParent = /*l_IdContainerParent*/0;
           pInfoDragNode->m_pdIDProduct = pInfoMod->m_pdIDProduct;

           m_ListaContenedoresDragDrop->Add(
                   reinterpret_cast<void*>(pInfoDragNode)
           );
          }
          else
            {
            bAbort = true;
            break;
          }
        }
    /*    delete pInfoNode;
        delete pInfoMod;*/
         DataSet->EnableControls();
      }
      if (bAbort)
      {
        // alguno de los items seleccionados no es un módulo
        m_ListaModulosDragDrop->Clear();
      }
    }
    catch (const nm_error::__com_error_ &e )
    {
       PutDebugMessage(COMError2str(e));
       m_ListaModulosDragDrop->Clear();
    }
} 
```

我注意到 DataSet->GotoBookmark(DBGModules->SelectedRows[i].c_str()); 正在执行缓慢。为什么会这样？使用的网格来自 DevExpress

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T11:34:54.377

众所周知，Delphi 和 C++ Builder 中的 GotoBookmark 功能和数据集中过滤器的使用是一个非常严重的性能瓶颈。

我的建议是使用不同的机制来跳转到所需的记录。也许只是使用查询和 ID。如果这不可能，请确保您在用作书签键的字段上有索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T22:22:33.290

很可能是您的 GotoBookmark 导致 DataSet 后面的查询一次又一次地运行。根据所选行执行更具体的查询可能会更好，而不是转到更通用查询结果中的书签。

# c# - 将 xmlns 属性添加到我的 XML 文档中的根元素时，我的 linq 查询不起作用

> ID：793580
> 
> 赞同：1
> 
> 时间：2009-04-27T13:52:07.773
> 
> 标签：c#, xml, linq, namespaces

我正在尝试更深入地了解 LINQ-to-XML，因此我为自己制作了一个简洁的 XML 文档小示例，以进行尝试。此外，我尝试（并成功地）为该文件制作了自己的 XML 模式，只是为了进行测试。XML 文档非常简单，看起来像这样：

```
<cars xmlns="/carsSchema.xsd">
  <car age="5">
    <carId>1</carId>
    <brand>BMW</brand>
    <model>320i</model>
    <color paintType="metallic">Red</color>
  </car>

  <car age="2">
    <carId>2</carId>
    <brand>VW</brand>
    <model>Golf</model>
    <color paintType="matt">White</color>
  </car>
[...]
</cars> 
```

`xmlns`现在，如果我从根元素中删除 -attribute，查询此文档就可以正常工作。当我重新添加它时，查询返回 null 并且什么也没有。我试图自己找出答案，但我还没有找到解决我问题的解决方案。

这是 C# 位：

```
 XDocument xmlDoc = XDocument.Load(currentDir + "\\Cars.xml");

// XNamespace ns = "{" + currentDir + "\\carSchema.xsd}";
// Tried to query xmlDoc.Descendants(ns+"car") after reading another post, 
// but that  made no difference

        var carInfo1 = from car in xmlDoc.Descendants("car")
                       select (string)car.Element("brand") + ": " + (string)car.Element("model"); 
```

有人看到有什么问题吗？为什么 LINQ 应该如此关心*命名*空间呢？它不能只查询我的文件而不关心它吗？

提前致谢！:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T13:56:41.163

当您按后代和元素搜索时，您需要指定命名空间。使用 LINQ to XML 很容易做到这一点。看起来你快到了，但没有为元素这样做：

```
XDocument xmlDoc = XDocument.Load(currentDir + "\\Cars.xml");
// I don't think namespace URIs are really resolved. I'm not sure though -
// for a proof of concept, I suggest you use a namespace of
// http://dummy.com/dummy.xsd
XNamespace ns = "/carSchema.xsd";

var carInfo1 = from car in xmlDoc.Descendants(ns + "car")
                   select (string)car.Element(ns + "brand") + ": " + 
                          (string)car.Element(ns + "model"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T22:04:25.073

当您使用虚构的“http://”URI 作为命名空间时，这也适用。你是对的。它没有解决。

```
 private XNamespace ns = "http://schemas.xin2009.com/DataMap/2009";

                IEnumerable<string> names = (from spnode in _map.Descendants(ns + "Entity")
                                         where spnode.Attribute("name").Value == this.Entity
                                         select spnode.Element(ns + "StoredProcedure").Attribute("name").Value); 
```

请注意，命名空间的 ns 只需添加到元素而不是属性。

# c# - 获取指定文件夹中活动目录中的所有用户

> ID：793582
> 
> 赞同：0
> 
> 时间：2009-04-27T13:52:15.060
> 
> 标签：c#, active-directory, ldap

我正在做一个需要查询活动目录的应用程序，为此我一直在使用 ldap 查询。

我的问题是我真的不能使用`ou=People,dc=pisoftware,dc=com`，因为人员节点名称一直在变化，因为我的部门名称最近更改了很多。因此，为了避免每次更改名称时都必须更改代码的问题，我想知道是否有任何方法可以通过某种文件夹 ID 进行查询？

例如，也许我可以做`ouid=123456,dc=pisoftware,dc=com`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T14:23:34.657

为什么你不能做一个 ldap 查询，它应用一个过滤器只返回 objectCategory=person。然后，您可以将该查询定位到搜索基础 DN，这样即使 ou/People 节点被重命名/更改，它仍然可以返回您想要的内容。有一个非常好的指南向您展示如何执行所有这些操作以及查询如何在这里工作：[http ://www.rlmueller.net/ADOSearchTips.htm](http://www.rlmueller.net/ADOSearchTips.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T21:11:10.267

您可以做的另一件事是将搜索向上移动到足够远的目录层次结构，以涵盖用户可能在哪里和做的任何地方：

`myDirectorySearcher.SearchScope = SearchScope.SubTree;`

然后它将在整个 AD 中进行递归子树搜索。

# c# - 覆盖 C# 中的现有文件

> ID：793589
> 
> 赞同：0
> 
> 时间：2009-04-27T13:53:35.977
> 
> 标签：c#, file

修改！

我想创建一个名为 test.txt 的文件。

如果该文件已经存在，我想创建名为 test1.txt 的文件，依此类推。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-27T13:55:47.000

打开文件时传入`FileMode.Create`to `File.Open(string, FileMode)`，每次都会创建一个新文件。

```
FileStream file = File.Open("text.txt", FileMode.Create); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T13:57:15.720

System.IO 中的类应该可以帮助您做到这一点。

```
FileStream fs = System.IO.File.Create(fileName); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-27T13:55:54.740

这是一个简短的例子：

```
using System;
using System.IO;

class Program
{
    static void Main()
    {
        String file = "text.txt"; 

        if (File.Exists(file))
            File.Delete(file);

        FileStream fs = File.Create(file);
    }
} 
```

# traceability - 维护可追溯性的最佳工具是什么

> ID：793592
> 
> 赞同：2
> 
> 时间：2009-04-27T13:54:27.253
> 
> 标签：traceability

该工具可用于跟踪需求规范、设计文档、源代码、测试计划。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T13:57:02.380

世界上最好的工具不会帮助您跟踪这样的需求，除非您有一个良好且稳定的**流程**来处理这些类型的事情。

这样的事情取决于使用该工具的人都与他们的流程在同一页面上，他们如何对需求进行编号等。

您的工具可以简单到“给每个需求一个唯一的编号，并确保在每次签入文件存储库时都引用它”。你真正需要担心的是过程，而不是工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T13:57:52.440

前段时间我用过 Rational RequisitePro 和 SoDA，还不错。

# iphone - iPhone UITextField：如何通过返回键插入新行？

> ID：793600
> 
> 赞同：6
> 
> 时间：2009-04-27T13:56:36.530
> 
> 标签：iphone, cocoa-touch, keyboard, uitextfield

我想通过点击 UITextField 键盘上的返回键来获得回车/换行。我发现， textFieldShouldReturn 被调用。

但是如何在文本字段中插入回车呢？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-27T14:48:53.177

您想改用 UITextView 。UITextFields 用于单行输入，而 UITextViews 支持多行输入。

# c# - CompilerParameters.ReferencedAssemblies -- 添加对 System.Web.UI.WebControls 的引用

> ID：793610
> 
> 赞同：9
> 
> 时间：2009-04-27T13:58:28.743
> 
> 标签：c#, compiler-construction, assemblies

我正在使用该类在运行时编译类`CodeDomProvider`。这适用于仅使用`System`命名空间的类：

```
using System;

public class Test
{
    public String HelloWorld()
    {
        return "Hello World!";
    }
} 
```

如果我尝试编译一个类`System.Web.UI.WebControls`，我得到这个错误：

> {错误 CS0006：找不到元数据文件“System.Web.UI.WebControls”} System.CodeDom.Compiler.CompilerError

这是我的代码片段：

```
var cp = new CompilerParameters();

cp.ReferencedAssemblies.Add("System.Web.UI.WebControls"); 
```

如何引用`System.Web.UI.WebControls`命名空间？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-06-20T00:03:40.503

您可以遍历所有当前加载的程序集：

```
var assemblies = AppDomain.CurrentDomain
                            .GetAssemblies()
                            .Where(a => !a.IsDynamic)
                            .Select(a => a.Location);   

cp.ReferencedAssemblies.AddRange(assemblies.ToArray()); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-27T14:03:27.140

您引用程序集，而不是命名空间。您应该使用 MSDN 来查找包含您需要使用的类的程序集的名称：在这种情况下，它将是：

```
var cp = new CompilerParameters();
cp.ReferencedAssemblies.Add("System.Web.dll"); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-08-30T18:16:30.763

在我的情况下，这被证明是不那么蛮力的。我正在构建一个插件，当前域中加载了 730 个程序集，因此存在重大滞后。

```
var assemblies = someType.Assembly.GetReferencedAssemblies().ToList();
   var assemblyLocations =  
assemblies.Select(a => 
     Assembly.ReflectionOnlyLoad(a.FullName).Location).ToList();

assemblyLocations.Add(someType.Assembly.Location);

cp.ReferencedAssemblies.AddRange(assemblyLocations.ToArray()); 
```

# sql-server - “ALFKI”到底是什么意思？

> ID：793618
> 
> 赞同：27
> 
> 时间：2009-04-27T14:00:57.300
> 
> 标签：sql-server, web-services

我在 SQL 和 Web 服务的各种示例中看到了这个缩写（或助记符）。

这是什么意思？如果你知道，它的起源是什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-27T14:05:45.650

`Customer`它是 Microsoft Northwind 演示数据库中第一个条目的主键 (CustomerID)

```
ALFKI   
Alfreds Futterkiste 
Maria Anders    
Sales Representative    
Obere Str. 57   Berlin      
12209   
Germany 
030-0074321 
030-0076545 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-27T14:03:20.400

它是“Alfreds Futterkiste”的唯一键，它是 SQL Server 附带的 Microsoft 的“Northwind”示例数据库中的第一个“Customers”表条目。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-27T14:03:48.090

“ALFKI”是 Microsoft 的 Northwind 示例数据库中已知客户记录的主要标识符。

它在这里和那里使用几乎就像“foobar”用作规范变量名一样。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-27T14:03:30.820

`Microsoft`这是提供的数据库中的示例客户`Northwind`（用于测试）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-27T14:04:57.963

来自 Microsoft 多年来使用的 Northwind 示例数据库的客户密钥。

# c# - UserControl 的事件处理程序未触发

> ID：793621
> 
> 赞同：6
> 
> 时间：2009-04-27T14:01:54.553
> 
> 标签：c#, events, user-controls, multiview

我将 UserControl 动态加载到 MultiView 控件中的 View 中。尽管 UserControl 添加了一个事件处理程序，但该事件永远不会触发。

我在这里想念什么？谢谢！

**包含 ASPX 页面：**

```
protected override void OnPreRender(EventArgs e)
{
    if (MultiView1.ActiveViewIndex == 2) //If the tab is selected, load control
    {
        Control Presenter = LoadControl("Presenter.ascx");
        (MultiView1.ActiveViewIndex.Views[2].Controls.Add(Presenter);
    }
    base.OnPreRender(e);
} 
```

**演示者.ascx.cs**

```
override protected void OnInit(EventArgs e)
{
    Retry.Click += this.Retry_Click; //This is a .Net 2.0 project
    base.OnInit(e);
}

protected void Retry_Click(object sender, EventArgs e)
{
    //This never fires
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T14:17:47.917

我认为它没有触发，因为您正在页面的预渲染事件中加载控件。回发时，控件将丢失，因为它没有视图状态。因此，无法控制触发其事件。尝试在页面的 init 事件中加载控件。让我们知道会发生什么！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-27T14:31:56.400

回发事件处理是在渲染之前完成的，因此在您的情况下，该控件不存在于页面中。

生命周期事件按此顺序触发（略过一些）：

1.  在里面
2.  加载
3.  预渲染
4.  卸下

并且事件处理在 Load 和 PreRender 之间完成（如果某些事件改变了页面的呈现方式，这是有道理的）。

因此，只需将加载 Retry 控件的代码移至 Load 或 Init。

参考：[Asp.Net 页面生命周期概述](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-11T13:49:42.227

控件最初必须可见才能进入 OnPreRender 事件。但也许你希望它不可见。一定要有**EnableViewState = false;**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T14:17:06.827

听起来每次回发后都没有添加控件，我会在包含 aspx 页面中取出 if 语句，看看是否可以解决问题...我假设 Retry 是一个按钮？

# solr - SolrJ 查询

> ID：793626
> 
> 赞同：4
> 
> 时间：2009-04-27T14:02:20.433
> 
> 标签：solr

大家好，

我必须使用 SolrJ 针对索引查询多个值（就像 IN (id1, id2, id3) sql 查询），换句话说，我想检索与一组值匹配的字段的文档。

由于 solrj api 的记录很粗糙，我希望有人可以帮助我

问候

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T15:37:02.670

您可以执行以下操作：

```
SolrQuery solrQuery = new SolrQuery().setQuery("myField:id1 OR myField:id2 OR myField:id3");
QueryResponse rsp = server.query(solrQuery); 
```

或者：

```
SolrQuery solrQuery = new SolrQuery().setQuery("myField:(id1 OR id2 OR id3)");
QueryResponse rsp = server.query(solrQuery); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-14T10:37:08.470

在模式定义文件 conf/schema.xml 中，您可以指定默认运算符，确保它是 OR：

```
<solrQueryParser defaultOperator="OR"/> 
```

然后，您可以在查询中用空格分隔单词，这将导致单词的 OR：

```
solrQuery.setQuery("myField:(id1 id2 id3)") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-09T10:11:32.597

再会 ，

你可以通过两种方式做到这一点

1- 使用**OR**作为值之间的分隔符，我们可以使用 StringUtils 使其更容易检查下面

```
Set<String> pdfFamilies = new HashSet<String>();
String familyIdsString = StringUtils.join(pdfFamilies , 'OR');
solrQuery = new SolrQuery("FAM_ID: ( " + familyIdsString + " )"); 
```

2-使用**空格**作为值之间的分隔符检查下面

```
Set<String> pdfFamilies = new HashSet<String>();
String familyIdsString = StringUtils.join(pdfFamilies , ' ');
solrQuery = new SolrQuery("FAM_ID: ( " + familyIdsString + " )"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-28T09:54:49.103

我已经尝试过了，在`Solr 5`这个似乎效果很好：

```
String mQueryString="term:business OR term:\"information security\"";
SolrQuery query = new SolrQuery();
query.setQuery(mQueryString); 
```

# c# - NHibernate 的全球化

> ID：793634
> 
> 赞同：2
> 
> 时间：2009-04-27T14:04:16.780
> 
> 标签：c#, nhibernate, model, relational

您将如何构建您的域对象并为多语言应用程序创建其各自的 NHibernate 映射文件。UI 部分存储在资源文件中，但用户数据需要进入数据库。

我想做以下事情：

```
Product p = DALProduct.getByID(2)
p.name //results in the language of the current UICulture 
```

我发现了以下非常接近的文章：http: [//ayende.com/Blog/archive/2006/12/26/LocalizingNHibernateContextualParameters.aspx](http://ayende.com/Blog/archive/2006/12/26/LocalizingNHibernateContextualParameters.aspx) 由于我是 NHibernate 的新手，我不确定这是否适用于企业解决方案.

您还有其他建议吗？你如何解决这种情况？

它应该灵活：

*   插入、更新和选择
*   收藏品

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T14:12:02.500

Ayendes 帖子是如何设计它的一个很好的开始。

它将完美地适用于企业解决方案。单独表中的名称与任何其他值列表一样。特殊的是，它在映射中被过滤。

编辑 - 选项：

**使用另一个实体编辑数据**

有一个 Product 实体，其中包含所有名称作为列表。LocalizedProduct 只有当前语言名称。

获取过滤后的实体

*   通过按照博客中的描述映射它，使用过滤器。
*   通过使用结果转换器 (Transformers.AliasToBean) 或使用“select new LocalizedProduct(id, name, Prize ...)”来选择它。在这种情况下不会映射 LocalizedProduct。应该是二级缓存友好的。

如果您对 Product 有很多引用，那么拥有两个类可能不太好，因为您不知道引用应该包含哪个类。

**使用相同的实体进行编辑和显示**

```
class Product
{
  string LocalizedName 
  { 
    get { return AllProductNames[Thread.CurrentThread.CurrentCulture.LCID]; }
  }

  IDictionary<int, string> AllProductNames { get; private set; }
} 
```

*本地化产品名称 (get)和*所有产品名称都有属性。

*   根本不过滤它们:-) 有一点网络开销。如果你只有 3 到 5 种语言，那还不错。如果您有 20 个或更多，最好过滤名称。
*   使用博客中描述的（可选）过滤器，但在产品名称上
*   使用（可选）ResultTransformer (CriteriaUtil.AliasToEntityMap) 过滤名称。

老实说，我会选择一个在映射文件中不需要过滤器的选项。过滤器属于更易于维护的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T20:50:47.597

[这](http://blog.hibernate.org/1592.lace)是 Gavin King's Post I，它似乎提供了不同的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T16:52:39.363

作为答案提到的方法已在[此处详细解释](http://www.webdevbros.net/2009/06/24/create-a-multi-languaged-domain-model-with-nhibernate-and-c/)

# feed - 通过网络提供即将发生的事件的最常见标准

> ID：793636
> 
> 赞同：6
> 
> 时间：2009-04-27T14:04:34.093
> 
> 标签：feed, icalendar, microformats

显示事件或日历数据的常用方法/官方标准是什么？

我的用例是我想将来自多个不同网站的事件信息汇总到一个日历或事件列表中（这是在 Intranet 上，我们可以控制所有网站）。我想要求网站以某种格式呈现他们的数据，以便我可以使用它。

我调查过的事情：

*   日历
*   hCalendar（微格式） - 嵌入到网页中，但是否需要网络爬虫？
*   RSS - 没有明确的嵌入时间特定数据的标准（仍处于“已提议”状态的事件提案[http://web.resource.org/rss/1.0/modules/event/](http://web.resource.org/rss/1.0/modules/event/)）

虽然 iCalendar 似乎是最常用的，但我的犹豫是内容创建者也不容易以 iCalendar 格式呈现他们的数据。我想这就是 hCalendar 变得有用的地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T06:52:59.333

将**日历数据**呈现为[RFC 2445](http://www.ietf.org/rfc/rfc2445.txt) [iCalendar](http://en.wikipedia.org/wiki/ICalendar)格式。

[以RFC 5023](http://www.ietf.org/rfc/rfc5023.txt) [AtomPub](http://atompub.org/)格式呈现更新的**联合提要。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-06T17:20:57.267

我建议使用 hCalendar 发布源信息。然后，您可以使用解析库或服务将 hCalendar 转换为 iCalendar（或其他一些有用的格式，如 XML 或 JSON）。

直接发布 iCalendar 的好处是双重的：

1.  您只需要发布您的信息的一个版本（仅 HTML，而不是 HTML 和 iCalendar）。
2.  这对您的发布者来说更容易，他们只需对用于发布活动的 HTML 进行少量修改，而不是学习一种全新的格式。

有各种微格式解析器可以作为 Web 服务运行，也可以在您自己的服务器上安装和运行。有关于微格式 wiki 的信息：http: [//microformats.org/wiki/implementations，http](http://microformats.org/wiki/implementations) : [//microformats.org/wiki/parsers](http://microformats.org/wiki/parsers)。

特别是您可能会发现 X2V 很有用：http: [//microformats.org/wiki/implementations#X2V](http://microformats.org/wiki/implementations#X2V)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T14:38:40.690

看看[杜克大学的数据源](http://www.oit.duke.edu/web-multimedia/web/calendar/)。它们以 RSS 和自定义 XML 提供日历/事件提要。他们还发布了关于如何使用他们的提要的示例 PHP/JavaScript 代码。您可能希望 Intranet 上的站点以这两种格式之一提供它们的提要，并使用类似于他们的示例 PHP 脚本的东西来聚合提要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-09T21:40:23.747

我建议使用带有包含 hCalendar 记录的 XHTML 条目的 Atom 提要。

# bash - 无法理解 .bashrc 中的一行

> ID：793640
> 
> 赞同：2
> 
> 时间：2009-04-27T14:05:34.717
> 
> 标签：bash

[我在某人的 .bashrc](http://www.pixelbeat.org/settings/.bashrc)中找到了以下代码

```
# Source global definitions 
[ -f /etc/bashrc ] && . /etc/bashrc 
```

它显然导致我的 Bash 重复了很多。

单线是什么意思？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-27T14:11:25.810

它检查文件 /etc/bashrc 是否存在，如果检查成功则执行它。点命令是“源”命令的别名。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-27T14:08:25.940

**如果 /etc/bashrc 存在（-f 运算符）执行它。**

这是因为 && （逻辑与运算符）仅在第一个参数为真时才评估第二个参数（以加快速度）。因此，如果文件存在，请运行它！

它实际上被称为“AND List Construct”。

有关一些额外信息，请参阅[此处](http://tldp.org/LDP/abs/html/list-cons.html#LISTCONSREF)。

您也可以考虑以下常用示例：

```
make && make install 
```

它仅在 make 成功完成时安装。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-27T14:45:44.603

可能让您感到困惑的是：`[`实际上是一个 Unix shell 命令。您可以在其中找到它，`/bin`当您仔细查看时，它是`test`命令的硬链接，这意味着您也可以编写：

```
test -f /etc/bashrc && source /etc/bashrc 
```

（`.`是 的快捷方式`source`）。

供您娱乐的历史记录：当 Unix 被发明时，没有屏幕，只有“电传打字机”，它是一种打字机。您向 Unix 主机发送了一个命令，电传打字机将打印结果。谣言是这样的：由于早期的 Unix 开发人员厌倦了电传打字机创造的所有喧嚣，他们试图将所有命令缩短为两个字母，并将所有选项缩短为一个字母。

如果你是绿色的，那么谣言是：为了节省纸张和色带，他们试图将所有命令缩短为两个字母，将所有选项缩短为一个字母。

如果您查看`/dev`，您会看到所有这些`tty`文件，这是原始电传打字机留下的唯一内容。

[编辑] 如何弄清楚那`[`是`test`同一件事：

这是一个两步过程。`ls -il [ test echo`给出：

```
356954 -r-xr-xr-x 2 root wheel 46K May 31 2008 [
356954 -r-xr-xr-x 2 root wheel 46K May 31 2008 test
67392  -rwxr-xr-x 1 root wheel 18K Sep 22 2007 echo 
```

首先，您注意到“root”之前的“2​​”。这意味着有两个目录条目（又名文件名）指向相同的数据（Unix 术语：inode、i-node 或“索引节点”）。磁盘上的每个 inode 都有一个唯一编号，即上例中的第一个编号 (356954)。您可以看到`[`并`test`共享相同的 inode，但`echo`没有。

请注意，没有快速的方法可以获取指向同一 inode 的所有目录条目。您必须在整个文件系统中搜索具有相同 inode 的条目（使用`find /path -inode 356954`）

[EDIT2] 至于 tty “文件”：这些实际上是设备节点。权限的第一个字母是“c”，如“字符设备”。您可以找到“-”代表文件，“d”代表目录，“b”代表块设备（如硬盘、软盘等）。这不是一个文件，而是一个真正的程序。您可以通过向它发送数据（在“文件”中“写入”某些内容）或从中读取数据来与它交谈。这个概念似乎与真实文件非常接近，以至于 Unix 发明者使用文件 API 加上称为“IO 控制”（或 ioctl）的东西来发送特殊命令（例如查询终端的大小）。

如果您切换到控制台模式（“Ctrl-Alt-F1”），您将看到如下内容：

```
Welcome to .... - Kernel .... (tty1) 
```

切换到另一个控制台（使用 Alt-F2...Alt-F6），您会看到它们已连接`tty2`到`tty6`. 登录其中一个并尝试

回声测试 > /dev/tty1

该字符串将出现在连接到的控制台上`tty1`。从 tty 读取并不那么容易，因为已经有一个程序正在读取它（`mingetty`只要您没有登录`login`或`bash`登录后）。如果您尝试`read line < /dev/tty1`，那将与已经在该控制台上运行的程序发生冲突，但原则上它会起作用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-28T14:41:20.970

我不知道你为什么不在这里问:) [http://comments.pixelbeat.org/settings/](http://comments.pixelbeat.org/settings/)

该命令的更详细等效项是：

```
if test -r /etc/bashrc; then
 source /etc/bashrc
fi 
```

# sql - 审核 SQL Server 数据更改

> ID：793643
> 
> 赞同：13
> 
> 时间：2009-04-27T14:06:29.237
> 
> 标签：sql, sql-server-2005, sql-server-2008

我正在考虑更改 SQL Server 2005 数据库的审核流程，并且在 SQL Server 2008 中遇到了更改数据捕获。

这看起来是个好主意，我很想尝试一下，但在我这样做之前，有没有人在商业环境中使用过它，你的想法是什么？

我注意到当我在 MS 帮助中阅读有关 CDC 的信息时，它说审计数据通常会保留几天。这是不可能的，我想无限期地保留数据，有人知道这种方法有问题吗？

如果由于我不知道的原因这不是一个好的解决方案，您是否有任何其他解决方案来审计数据更改。我热衷于使用可以在我想要的任何桌子上全面实施的系统。

我追求基本的：“之前，之后，谁，何时”信息以进行任何更改。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-27T16:16:14.900

在我看来，疾控中心应该只是达到目的的一种手段。我过去曾实施过审计跟踪解决方案，它们涉及到触发器的使用。对于高度事务性的数据库来说，这变得非常混乱和性能密集。

CDC 为您提供的是在不使用触发器的情况下记录审计数据的能力，但您仍然需要一种方法将这些数据放入永久表中。这可以通过为每个要审计的表创建一个镜像表或跟踪所有表的所有更改的单个表来完成（我已经完成了后者）。

**以下是有关如何使用触发器完成的附加信息的一些链接：**
[SQL 审计跟踪](http://www.simple-talk.com/sql/database-administration/pop-rivetts-sql-server-faq-no.5-pop-on-the-audit-trail/)
[sql-server-history-table-populate-through-sp-or-trigger](https://stackoverflow.com/questions/349524/sql-server-history-table-populate-through-sp-or-trigger)

这是一个使用 LINQ 的开源审计跟踪解决方案：[DoddleAudit](http://www.codeplex.com/DoddleAudit)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-04T12:17:43.620

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-03T11:53:12.333

在 SQL Server 2008 中，您可以在文件、应用程序日志或系统日志中使用“审计”功能和库存数据。在以下位置查找更多信息：http: [//msdn.microsoft.com/en-us/library/cc280386.aspx](http://msdn.microsoft.com/en-us/library/cc280386.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T10:15:41.600

您可以编辑 Sql Server 作业，该作业会在两天后删除捕获的更改。您还可以根据自己的方便延长此清理时间，或使其永久化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-02T08:53:31.393

我正在使用[此](http://autoaudit.codeplex.com/)脚本，您可以定义要审核的表或在数据库上定义的所有表。另外，tvf 用于单记录查看历史。查看链接，了解详情。

# objective-c - Cocoa/Objective-C 中有没有类似通用列表的东西？

> ID：793644
> 
> 赞同：30
> 
> 时间：2009-04-27T14:06:36.273
> 
> 标签：objective-c, cocoa, list, data-structures, strong-typing

我在 C# 中真正喜欢的是通用列表。只能包含一种类型的对象的列表。Cocoa/Objective-C 中是否有类似通用列表的东西？到目前为止，我只知道`NSArray`谁将指向任何对象。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-27T15:27:58.573

在 Cocoa 应用程序中想要这个通常是设计薄弱的标志。

`NSArray`是不可变的，因此它不会“获取指向任何对象的指针”，并且在交给您时可能已经包含正确的对象。我假设您更担心的是`NSMutableArray`您认为代码的其他部分可能会添加错误类型的对象。但是看看 Cocoa 本身；将可变数组作为类设计的一部分公开是非常罕见的。

相反，您通常会公开一个`NSArray`和几个用于修改该数组的方法。类似于以下内容：

```
@class Foo : NSObject
- (NSArray *)bars;
- (void)addBar:(Bar *)bar;
- (void)removeBar:(Bar *)bar;
@end 
```

这通常会通过发出编译器警告来阻止插入错误的对象，然后当然您可以在其中添加断言`-addBar:`，`-removeBar:`如果您愿意的话。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-27T14:09:00.450

Objective-C 不支持泛型编程。您总是可以使用 Objective-C++ 和 STL 列表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-14T18:48:33.363

通用 NSArrays 可以通过子类化来实现`NSArray`，并用更严格的方法重新定义所有提供的方法。例如，

```
- (id)objectAtIndex:(NSUInteger)index 
```

将不得不重新定义

```
@interface NSStringArray : NSArray 
```

作为

```
- (NSString *)objectAtIndex:(NSUInteger)index 
```

一个 NSArray 只包含 NSStrings。

创建的子类可以用作替代品，并带来许多有用的功能：编译器警告、属性访问、更好的代码创建和 Xcode 中的补全。所有这些都是编译时的特性，不需要重新定义实际的实现——NSArray 的方法仍然可以使用。

可以将其自动化并将其归结为仅两个语句，这使其接近支持泛型的语言。我使用[WMGenericCollection](https://github.com/w-m/WMGenericCollection)创建了一个自动化，其中模板作为 C 预处理器宏提供。

导入包含宏的头文件后，您可以创建一个带有两条语句的通用 NSArray：一条用于接口，一条用于实现。您只需提供要存储的数据类型和子类的名称。WMGenericCollection 为`NSArray`、`NSDictionary`和`NSSet`以及它们的可变对应物提供了这样的模板。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-01T17:30:18.230

不，Objective-C 目前不支持集合元素的参数类型。

但是，这个主题比问题或现有答案所承认的要复杂。

Objective-C 中集合的参数类型与 C#/Java 中的泛型不同。例如，您不太可能看到 Objective-C 添加了确保添加到集合中的每个对象都是*NSArray*类型或子类型的功能。相反，Objective-C 可以（并且 IMO 应该）有能力确保集合中的每个对象都*符合*协议/接口。（即它实现了一组必需的方法）

为什么？

Objective-C 是一种基于协议（接口）兼容性而不是子类型关系的语言。也就是说，如果对象具有所有正确的方法，它们是兼容的，我们不关注或关心它们的实际类型。事实上，在 Obj-C 中查看实际类型是一种非常非常糟糕的做法，并且非常不鼓励这样做。这个概念有时被称为“鸭子打字”，因为如果它像鸭子一样嘎嘎叫，那就是鸭子。我们不在乎它是否真的从某些特定的鸭子那里继承而来。这可以防止您被其他人的实现层次结构所困扰。-- 结果是只要从列表中出来的对象有一个 draw:: 方法就可以了，我们实际上并不关心它是否是某个特定 JimmyDrawableBase 对象的子类。

这不仅使代码更可重用，而且还鼓励稍微不同（更实用？）类型的问题分解，因为您不能依赖从给定基类派生的对象，从而拥有一堆基类强制执行。

我个人认为Obj-C 编译器对*PROTOCOL* *CONFORMANCE*进行参数检查会*很好。*也就是说，要使一个 NSMutableArray 需要放置在其中的所有对象符合给定的协议（即具有给定的一组所需的方法）。

 *有时，即使是这种更灵活的协议一致性检查也会受到动态编程人员的抵制，并且有充分的理由。程序员通常有一种过度指定一致性要求的方法。

例如，您可能需要一个包含符合 NSArray 协议/接口的对象的列表，但实际上您可能*只*调用其中两个方法。这是过度一致性。希望在您的数组中添加兼容项目的人被迫实现大量您实际上没有调用的方法——至少现在还没有（见下）。

Google Go 试图通过推断结构兼容性来解决这个问题。也就是说，如果您对来自列表的项目调用 draw()，那么编译器会确保进入列表的所有内容都包含 draw() 方法。如果它不包含 draw() 方法，则将其放入列表中是编译器错误。这可以防止代码在运行时简单地导致相同的错误发生。问题在于它仅适用于整个程序编译。如果 Google-Go 可以编译模块化 DLL（它不能），那么它会遇到一个问题，即我无法说列表中的对象需要支持三种方法的特定接口，即使我今天不给他们打电话，因为我*将来可能会打电话给他们*。

这两个解决方案之间喜欢权衡和真相。

就个人而言，我希望看到 Objective-C 添加参数协议一致性，所以我可以要求编译器确保特定集合的内容始终符合给定的协议集。

我还希望编译器帮助我避免过度一致性。如果我没有在对象上调用这些协议中的方法，它应该会生成错误/警告告诉我。如果即使我没有使用它们，我也想将它们保留在协议中，我应该为协议中的每个方法显式声明它“将来可能会使用，因此元素都需要现在提供它”。这至少使得过度一致性的过程需要更多的工作，而不是需要更少工作的 Java/C#。

# entity-framework - 实体框架 - Linq 到实体 - 多对多查询问题

> ID：793645
> 
> 赞同：6
> 
> 时间：2009-04-27T14:06:41.267
> 
> 标签：entity-framework, linq-to-entities, many-to-many, left-join

我在 Linq To Entities 中查询多对多关系时遇到问题。我基本上是在尝试使用 Linq 复制此查询：

```
Select * 
FROM Customer 
LEFT JOIN CustomerInterest ON Customer.CustomerID = CustomerInterest.CustomerID
LEFT JOIN Interest ON CustomerInterest.InterestID = Interest.InterestID
WHERE Interest.InterestName = 'Football' 
```

我环顾网络，并没有真正找到任何合适的例子来说明如何做到这一点。我得到的最接近的是：

```
List<Customer> _Customers = (from _LCustomers in _CRM.Customer.Include("CustomerInterest.Interest")
                                  where _LCustomers.CustomerInterest.Any(x => x.Interest.InterestName == "Football")
                                  select _LCustomers).ToList(); 
```

这样做的问题是，如果客户有多个兴趣并且其中一个是“足球”，那么所有这些都会被退回。我还查看了具有逆问题的 All()，即只有当他们有一个兴趣并且是足球时才会返回，如果他们有两个并且其中一个不是足球，则不会返回任何内容。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-26T03:33:15.573

尝试这个，

```
var result = from c in ctx.Customer
             from i in c.Interest
             where i.InterestName == "Football"
             select c; 
```

希望这可以帮助，

射线。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T14:23:26.890

我不确定你想得到什么。具有客户兴趣和兴趣的客户列表？只需根据客户的兴趣开始查询。

```
context.CustomerInterest.
   Where(ci => ci.Interest.InterestName == "Football").
   Select(ci => new
   {
      Customer = ci.Customer,
      CustomerInterest = ci,
      Interest = ci.Interest
   }); 
```

但这是非常多余的。为什么不只是获得匹配的客户兴趣？

```
IEnumerable<CustomerInterest> customerInterests = context.CustomerInterest.
   Where(ci => ci.Interest.InterestName == "Football"); 
```

您仍然可以访问其他信息，而无需显式存储。

```
foreach (CustomerInterest customerInterest in customerInterests)
{
   DoSomething(customerInterest);
   DoSomething(customerInterest.Customer);
   DoSomething(customerInterest.Interest);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-15T16:00:12.407

```
 var results = from c in _CRM.Customer
                      from ci in c.Interests
                      join i in _CRM.Interests
                      on ci.ID equals i.ID
                      where i.Interest = "Football"
                      select c; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T17:51:24.537

如果你试图保持它的通用性，更好的方法是使用实​​体 sql[Esql]。Coz L2E 不支持 linq 查询中的集合位置。

你不能使用

customer.Interests.Where(interest => interest.Name =='FootBall')

查询看起来像这样..

`context.CreateQuery(@"SELECT VALUE Customer FROM Customer WHERE EXISTS( SELECT VALUE FROM CustomerInterest WHERE CustomerInterest.Ineterest.Name = 'FootBall')).Include("Interest");`

希望能帮助到你！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T04:20:45.683

这对 LINQT 来说太多了。尝试在您的数据库中使用视图或按照 Deepak N 所说的那样工作。最好的

# python - epoll如何在Python中检测客户端关闭？

> ID：793646
> 
> 赞同：5
> 
> 时间：2009-04-27T14:06:45.883
> 
> 标签：python, epoll

**这是我的服务器**

```
"""Server using epoll method"""

import os
import select
import socket
import time

from oodict import OODict

addr = ('localhost', 8989)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
s.bind(addr)
s.listen(8)
s.setblocking(0) # Non blocking socket server
epoll = select.epoll()
epoll.register(s.fileno(), select.EPOLLIN) # Level triggerred

cs = {}
data = ''
while True:
    time.sleep(1)
    events = epoll.poll(1) # Timeout 1 second
    print 'Polling %d events' % len(events)
    for fileno, event in events:
        if fileno == s.fileno():
            sk, addr = s.accept()
            sk.setblocking(0)
            print addr
            cs[sk.fileno()] = sk
            epoll.register(sk.fileno(), select.EPOLLIN)

        elif event & select.EPOLLIN:
            data = cs[fileno].recv(4)
            print 'recv ', data
            epoll.modify(fileno, select.EPOLLOUT)
        elif event & select.EPOLLOUT:
            print 'send ', data
            cs[fileno].send(data)
            data = ''
            epoll.modify(fileno, select.EPOLLIN)

        elif event & select.EPOLLERR:
            print 'err'
            epoll.unregister(fileno) 
```

**客户端输入**

```
ideer@ideer:/home/chenz/source/ideerfs$ telnet localhost 8989
Trying ::1...
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
123456
123456
^]

telnet> q
Connection closed. 
```

**服务器端输出**

```
ideer@ideer:/chenz/source/ideerfs$ python epoll.py 
Polling 0 events
Polling 0 events
Polling 1 events
('127.0.0.1', 53975)
Polling 0 events
Polling 1 events
recv  1234
Polling 1 events
send  1234
Polling 1 events
recv  56

Polling 1 events
send  56

Polling 0 events
Polling 0 events
Polling 0 events
Polling 1 events
recv  
Polling 1 events
send  
Polling 1 events
recv  
Polling 1 events
send  
Polling 1 events
recv  
Polling 1 events
send  
Polling 1 events
recv  
^CTraceback (most recent call last):
  File "epoll.py", line 23, in <module>
    time.sleep(1)
KeyboardInterrupt 
```

奇怪的是，客户端关闭连接后，epoll仍然可以轮询recv并发送事件！为什么 EPOLLERR 事件永远不会发生？如果你使用 EPOLLHUP 也是一样的。

我注意到 EPOLLERR 事件仅在您尝试编写关闭的连接时发生。除此之外，还有其他方法可以判断连接是否已关闭？

如果在 EPOLLIN 事件中一无所获，将连接视为关闭是否正确？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T17:56:54.047

EPOLLERR 和 EPOLLHUP 永远不会出现在贴在帖子中的代码中，因为它们总是与 EPOLLIN 或 EPOLLOUT 一起发生（其中几个可以同时设置），所以 if/then/else 总是选择一个EPOLLIN 或 EPOLLOUT。

实验我发现 EPOLLHUP 仅与 EPOLLERR 一起发生，其原因可能是 python 与 epoll 和低级 IO 接口的方式，通常当非阻止recv，但是python使用''（没有返回）来表示EOF。

关闭您的 telnet 会话只会关闭 tcp 连接的那一端，因此在您这边调用 recv 仍然完全有效，您的应用程序尚未读取的 tcp 接收缓冲区中可能有待处理的数据，因此不会触发错误条件。

似乎 EPOLLIN 和返回空字符串的 recv 表示另一端已关闭连接，但是，使用较旧版本的 python（在引入 epoll 之前）和管道上的普通选择，我经历过读取返回的 '' 并不表示 EOF 只是缺少可用数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-17T15:49:38.810

如果套接字仍然打开但没有可用的读/写可用 epoll.poll 将超时。

如果数据可以从对等方获得，您将获得一个 EPOLLIN 并且数据将可用。

如果套接字被对等方关闭，您将得到一个 EPOLLIN，但当您读取它时，它将返回“”。

然后，您可以通过关闭套接字并拾取生成的 EPOLLHUP 事件来清理您的内部结构来关闭套接字。

或执行清理并取消注册 epoll。

```
elif event & select.EPOLLIN:
    data = cs[fileno].recv(4)

if not data:
    epoll.modify(fileno, 0)
    cs[fileno].shutdown(socket.SHUT_RDWR) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T10:17:46.050

我绕过这个问题的临时解决方案

```
--- epoll_demo.py.orig  2009-04-28 18:11:32.000000000 +0800
+++ epoll_demo.py   2009-04-28 18:12:56.000000000 +0800
@@ -18,6 +18,7 @@
 epoll.register(s.fileno(), select.EPOLLIN) # Level triggerred

 cs = {}
+en = {}
 data = ''
 while True:
     time.sleep(1)
@@ -29,10 +30,18 @@
             sk.setblocking(0)
             print addr
             cs[sk.fileno()] = sk
+            en[sk.fileno()] = 0
             epoll.register(sk.fileno(), select.EPOLLIN)

         elif event & select.EPOLLIN:
             data = cs[fileno].recv(4)
+            if not data:
+                en[fileno] += 1
+                if en[fileno] >= 3:
+                    print 'closed'
+                    epoll.unregister(fileno)
+                continue
+            en[fileno] = 0
             print 'recv ', data
             epoll.modify(fileno, select.EPOLLOUT)
         elif event & select.EPOLLOUT: 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-08T22:29:29.097

您没有在代码中检测到 EPOLLHUP/EPOLLERR 的问题是因为您正在执行按位操作。查看套接字何时准备好读取 epoll 将抛出一个位 1 的标志，该标志等于 select.EPOLLIN (select.EPOLLIN == 1)。现在假设客户端挂断（无论是否正常），服务器上的 epoll 将抛出一个第 25 位的标志，该标志等于 EPOLLIN+EPOLLERR+EPOLLHUP。因此，使用第 25 位（代码中的事件变量），您可以看到 EPOLLERR 没有被检测到，因为您的所有 elif 语句（EPOLLOUT 行除外）都不返回 0，因此执行第一个 elif 语句，例如：

```
>>> from select import EPOLLIN,EPOLLOUT,EPOLLHUP,EPOLLERR
>>> event = 25
>>> event & EPOLLIN
1
>>> event & EPOLLERR
8
>>> event & EPOLLHUP
16
>>> event & EPOLLOUT
0 
```

注意前三个如何不返回 0？这就是为什么您的代码没有正确检测 EPOLLERR/EPOLLHUP 的原因。当客户端挂起时，您仍然可以从套接字读取，因为服务器端仍然处于运行状态（当然，如果您这样做，它将返回 0 数据）因此 EPOLLIN 但由于客户端挂起它也是 EPOLLHUP 并且因为它是 EPOLLHUP 它也是 EPOLLERR 为挂断有点错误。我知道我对此发表评论很晚，但我希望我能帮助那里的人哈哈

这是我重写代码以更好地表达我所说的内容的一种方式：

```
import os
import select
import socket
import time

from oodict import OODict

addr = ('localhost', 8989)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
s.bind(addr)
s.listen(8)
s.setblocking(0) # Non blocking socket server
epoll = select.epoll()
read_only = select.EPOLLIN | select.EPOLLPRI | select.EPOLLHUP | select.EPOLLERR
read_write = read_only | select.EPOLLOUT
biterrs = [25,24,8,16,9,17,26,10,18] #Bitwise error numbers
epoll.register(s.fileno(),read_only)

cs = {}
data = ''
while True:
    time.sleep(1)
    events = epoll.poll(1) # Timeout 1 second
    print 'Polling %d events' % len(events)
    for fileno, event in events:
        if fileno == s.fileno():
            sk, addr = s.accept()
            sk.setblocking(0)
            print addr
            cs[sk.fileno()] = sk
            epoll.register(sk.fileno(),read_only)

        elif (event is select.EPOLLIN) or (event is select.EPOLLPRI):
            data = cs[fileno].recv(4)
            print 'recv ', data
            epoll.modify(fileno, read_write)
        elif event is select.EPOLLOUT:
            print 'send ', data
            cs[fileno].send(data)
            data = ''
            epoll.modify(fileno, read_only)

        elif event in biterrs:
            print 'err'
            epoll.unregister(fileno) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-17T00:47:19.380

我有另一种方法..

```
try:
    data = s.recv(4096)
except socket.error:
    if e[0] in (errno.EWOULDBLOCK, errno.EAGAIN): # since this is a non-blocking socket..
        return # no error
    else:
        # error
        socket.close()

if not data: #closed either
    socket.close() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T15:53:41.710

你不只需要将掩码组合在一起即可同时使用 EPOLLHUP 和 EPOLLIN：

```
 epoll.register(sk.fileno(), select.EPOLLIN | select.EPOLLHUP) 

```

虽然说实话我对 epoll 库并不是很熟悉，所以这只是一个建议......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T04:01:51.587

在我将 select.EPOLLHUP 处理代码移动到 select.EPOLLIN 之前的行后，仍然无法在“telnet”中获取 hup 事件。但巧合的是，我发现如果我使用自己的客户端脚本，就会出现 hup 事件！奇怪的...

根据 man epoll_ctl

```
 EPOLLRDHUP (since Linux 2.6.17)
          Stream socket peer closed connection, or shut down writing half of connection.  (This flag is especially useful for writing simple code  to
          detect peer shutdown when using Edge Triggered monitoring.)

   EPOLLERR
          Error  condition  happened on the associated file descriptor.  epoll_wait(2) will always wait for this event; it is not necessary to set it
          in events.

   EPOLLHUP
          Hang up happened on the associated file descriptor.  epoll_wait(2) will always wait for this event; it  is  not  necessary  to  set  it  in
          events. 
```

似乎远程关闭连接时应该有一个EPOLLRDHUP事件，这不是python实现的，不知道为什么

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-23T11:36:01.183

```
elif event & (select.EPOLLERR | select.EPOLLHUP):
    epoll.unregister(fileno)
    cs[fileno].close()
    del cs[fileno] 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-10-21T13:53:54.037

EPOLLRDHUP标志没有在 Python 中无缘无故地定义*。*如果您的 Linux 内核 >= 2.6.17，您可以定义它并在 epoll 中注册您的套接字，如下所示：

```
import select
if not "EPOLLRDHUP" in dir(select):
    select.EPOLLRDHUP = 0x2000
...
epoll.register(socket.fileno(), select.EPOLLIN | select.EPOLLRDHUP) 
```

然后，您可以使用相同的标志 ( *EPOLLRDHUP* ) 捕获所需的事件：

```
elif event & select.EPOLLRDHUP:
     print "Stream socket peer closed connection"
     # try shutdown on both side, then close the socket:
     socket.close()
     epoll.unregister(socket.fileno()) 
```

有关更多信息，您可以查看python 存储库中的[selectmodule.c ：](http://svn.python.org/view/python/tags/r27/Modules/selectmodule.c?view=markup)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-10-18T06:01:59.460

```
if event & select.EPOLLHUP:
    epoll.unregister(fd) 
```

# sql - 太多的左连接是代码味道吗？

> ID：793647
> 
> 赞同：38
> 
> 时间：2009-04-27T14:06:54.730
> 
> 标签：sql, sql-server-2005, left-join

例如，如果您在查询中有 > 5 个左连接，那么代码有味道......

*   你的设计有问题吗？
*   你在一个查询中做的太多了吗？
*   你的数据库太规范了？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-27T14:08:24.960

对于某些设计来说，这是一个完全合法的解决方案。

假设您有一个一对多关系的层次结构，例如`Customer`- `Order`- `Basket`- `Item`-`Price`等，它可以在任何级别上都未填充：a`Customer`可能没有`Orders`，an`Order`可以没有`Baskets`，等等。

在这种情况下，您会发出如下内容：

```
SELECT  *
FROM    Customer c
LEFT OUTER JOIN
        Order o
ON      o.CustomerID = c.ID
LEFT OUTER JOIN
        Basket b
ON      b.OrderID = c.ID
… 
```

注意，在某些情况下可能效率低下，可以用`EXISTS`or代替`NOT EXISTS`（如果你只想弄清楚对应的记录存在或不存在于其他表中）。

有关性能详细信息，请参阅我的博客中的这篇文章：

*   [**查找不完整的订单**](http://explainextended.com/2009/03/13/finding-incomplete-orders/)- 如何从替换`LEFT JOIN`'s`NOT EXISTS`

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-27T14:10:21.333

从某种意义上说，这是您可以/应该调查的事情，我会说是的。通过从中考虑一些观点，您可能可以获得更好的实用性和维护性。

从某种意义上说，它是“坏代码”，不，这很容易合理，特别是对于较大的数据库，现代数据库可能会优化任何低效率。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-27T14:10:52.847

不，这样做很好，但是如果您发现自己一遍又一遍地使用相同的连接到相同的表编写相同的查询/过程，它可能是创建视图的候选者，只是为了简化您将来的查询，并且减少架构更改时需要更改的接触点数量

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-27T14:11:13.267

很多时候你可以通过创建辅助视图来减轻视觉上的异味，我不认为有多少左连接被认为是不好的硬性规则。

与过程编码不同，将 SQL 分解成小块可能会导致查询效率低下。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-27T14:12:08.133

**你的结果我的变化**

任何不寻常的东西都可能是任何东西的代码气味。就像 Quassnoi 所说的那样，它可能是完全合法的。真正深入的报告需要大量的连接来正确拼凑信息的情况并不少见。这并不意味着开发人员应该考虑对他们的数据库进行非规范化。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-27T14:11:45.543

几乎不可能有人回答如此笼统的问题，并试图创建这样一个任意规则是没有意义的。

左连接是一种完全可以接受的连接类型，它映射到一个非常常见的需求：给我所有的 x，如果它们有关联的 y，那么也得到这些。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-27T14:15:53.117

一点都不。构建在某些查询上使用大量左连接的数据库设计是完全合法的。

话虽如此，我通常更喜欢构建数据库，以便限制需要外部连接的情况，因为经验倾向于表明使用它们的（复杂）查询更容易出错并且可能会引起维护问题。

作为一个有趣的历史，IBM DB2 的早期版本仅在大型机上运行时不支持外部连接（当时 Oracle 和 Ingress 都支持，这是一个主要卖点）。这导致了数据库设计中的一些有趣问题，因为有必要确保仅使用内部连接就可以解决数据库的所有预期数据访问要求。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-09-17T17:38:41.643

我认为必须使用许多连接（例如处理规范化数据）不是代码异味，而是表明您可能没有在正确的位置工作。根据我的经验，那些担心查询中的连接数量的人在数据库中开发得太多，而在公开数据的应用程序和报告中开发得不够多。数据结构必须足够灵活以支持无数用途，这就是为什么标准化在某种程度上很重要。

在构建当今的企业应用程序时，开发人员可以利用昨天的成就在 SQL 甚至 XML 等技术之上的抽象级别上工作，以便以更少的工作交付更多的价值。有一些工具，即报表编写器、代码生成器、ORM、实体框架等，可以抽象出手动构建 SQL 的低级工作，并为您执行连接。大多数人都知道正在使用的 SQL 方言（例如，Oracle 9 与 MySQL 3），并且可以生成对该方言最有效的 SQL 语法；这意味着他们可能比您更好地创建连接。

但是，这些工具在没有足够规范化的关系环境中工作得非常差，或者根本不能工作。对我来说，这就是“发展”气味表现出来的地方。如果一个已建立的数据访问工具无法理解我构建数据的关系，我可能需要寻找一种更规范的方式来创建这些关系，并从中获得远远超过使用该工具的好处。通常，介于第 2 和第 3[范式](http://en.wikipedia.org/wiki/Database_normalization#Normal_forms)之间的某个地方是甜蜜点。尽管总是存在一些小的关系数据区域，在这些区域中，更高程度的标准化是有意义的并增加了价值。

干杯，特拉维斯

# tfs - 对于 TFS 2008 Team Build，如何更改 $Temp 指向的位置？

> ID：793650
> 
> 赞同：2
> 
> 时间：2009-04-27T14:07:26.163
> 
> 标签：tfs, build-automation

我们最近构建了一个新的 TFS 2008 Team Build 服务器。我不希望用户将他们的构建放在构建代理的 $Temp 指向的默认临时目录中，但我也不想强迫开发人员将路径更改到其他地方 - 这会冒开发人员的风险要么（a）不打扰，要么（b）制作与其他团队不一致的路径。

所以我想保留 $Temp 那里（这是创建构建代理时的默认值），但更改它指向的位置。我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T19:06:51.420

$Temp 值是运行构建代理进程的用户的 Temp 环境变量的值。您可以更改构建用户的临时位置 - 但这可能不是您想要的，因为这是您必须对构建用户环境进行的设置，而不仅仅是本地化到构建代理进程。

就个人而言，我将构建代理工作目录设置为 d:\bw\$(BuildDefinitionId) 之类的东西，其中 d 是一个相当快的辅助驱动器 - 但是 c:\bw 也可以。这意味着构建是在一个路径较短的地方进行的，因此您不太可能遇到 .NET 的 IO 类强加的烦人的 260 个字符的路径限制。

据推测，创建构建代理不是您的开发人员正在做的事情，而是更多的管理任务 - 但是，如果您真的想确保它按照您想要的方式完成，您可以使用来自内部 ASP的[TFS Build API](http://msdn.microsoft.com/en-us/library/cc339575.aspx)配置构建代理.NET 页面或一个小应用程序。这将为您提供限制构建工作目录设置位置所需的控制。

如果您想要创建构建代理的 API 代码，请在评论中告诉我，我将编辑我的答案。

# c# - 如何找到活动 app.config 文件的路径？

> ID：793657
> 
> 赞同：181
> 
> 时间：2009-04-27T14:08:53.913
> 
> 标签：c#, .net, nunit, app-config, configurationmanager

我正在尝试完成这个异常处理程序：

```
if (ConfigurationManager.ConnectionStrings["ConnectionString"]==null)
{
    string pathOfActiveConfigFile = ...?
    throw new ConfigurationErrorsException(
       "You either forgot to set the connection string, or " +
       "you're using a unit test framework that looks for  "+
       "the config file in strange places, update this file : " 
       + pathOfActiveConfigFile);
} 
```

这个问题似乎只发生在我使用 nUnit 时。

* * *

## 回答 #1

> 赞同：375
> 
> 时间：2009-04-27T14:18:03.907

试试这个

```
AppDomain.CurrentDomain.SetupInformation.ConfigurationFile 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2009-04-27T14:36:09.587

严格来说，没有单一的配置文件。除了 ASP.NET ¹之外，可以有三个使用内置 ( `System.Configuration`) 支持的配置文件。除了机器配置：`app.exe.config`，用户漫游和本地用户。

要获取“全局”配置（*exe* .config）：

```
ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None)
                    .FilePath 
```

[`ConfigurationUserLevel`](http://msdn.microsoft.com/library/System.Configuration.ConfigurationUserLevel)为每次使用的漫游和非漫游配置文件使用不同的值。

* * *

¹它具有完全不同的模型，其中子文件夹（IIS 虚拟或文件系统）的内容`web.config`可以（取决于设置）添加到或覆盖父文件夹的`web.config`.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-27T14:13:19.690

如果您的意思是在使用 NUnit 时只得到空返回，那么您可能需要将应用程序的 app.config 中的 ConnectionString 值复制到测试库的 app.config 中。

当它由测试加载器运行时，测试程序集在运行时加载，并将查看它自己的 app.config（在编译时重命名为 testAssembly.dll.config）而不是您的应用程序配置文件。

要获取您正在运行的程序集的位置，请尝试

```
System.Reflection.Assembly.GetExecutingAssembly().Location 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-27T14:23:56.560

确保单击文件上的属性并将其设置为“始终复制”，否则它将不会与您的快乐 lil dll 一起位于 Debug\ 文件夹中以配置它需要的位置并添加更多牛铃

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-06T20:46:09.560

我第一次意识到单元测试项目引用了该项目中的 app.config，而不是与我的生产代码项目（当然，DOH）关联的 app.config，我只是在 Prod 项目的 Post Build Event 中添加了一行这会将 app.config 复制到测试项目的 bin 文件夹中。

问题解决了

到目前为止，我还没有注意到任何奇怪的副作用，但我不确定这是正确的解决方案，但至少它似乎有效。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-02-01T12:43:41.477

我看到的另一个选项在这里丢失：

```
const string APP_CONFIG_FILE = "APP_CONFIG_FILE";
string defaultSysConfigFilePath = (string)AppDomain.CurrentDomain.GetData(APP_CONFIG_FILE); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-27T14:14:04.320

根据您的配置文件的位置，`System.Reflection.Assembly.GetExecutingAssembly().Location`可能会满足您的需要。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-06-17T21:03:23.767

我在 Web 应用程序（实际上是本地运行的 Azure Web 角色）中尝试了之前的答案之一，但效果不佳。但是，这种类似的方法确实有效：

```
var map = new ExeConfigurationFileMap { ExeConfigFilename = "MyComponent.dll.config" };
var path = ConfigurationManager.OpenMappedExeConfiguration(map, ConfigurationUserLevel.None).FilePath; 
```

配置文件原来在 C:\Program Files\IIS Express\MyComponent.dll.config 中。有趣的地方。

# java - 在 Hibernate Envers 中获取以前版本的实体

> ID：793674
> 
> 赞同：11
> 
> 时间：2009-04-27T14:12:52.763
> 
> 标签：java, hibernate, jboss, hibernate-envers

我有一个由 Hibernate 加载的实体（通过`EntityManager`）：

```
User u = em.load(User.class, id) 
```

此类由 Hibernate Envers 审核。如何加载以前版本的用户实体？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2011-08-11T15:52:07.150

这是另一个版本，它查找与“当前”修订号相关的先前修订，因此即使您正在查看的实体不是最新修订，也可以使用它。它还处理*没有*事先修订的情况。（`em`假定为先前填充的 EntityManager）

```
public static User getPreviousVersion(User user, int current_rev) {
    AuditReader reader = AuditReaderFactory.get(em);

    Number prior_revision = (Number) reader.createQuery()
    .forRevisionsOfEntity(User.class, false, true)
    .addProjection(AuditEntity.revisionNumber().max())
    .add(AuditEntity.id().eq(user.getId()))
    .add(AuditEntity.revisionNumber().lt(current_rev))
    .getSingleResult();

    if (prior_revision != null)
        return (User) reader.find(User.class, user.getId(), prior_revision);
    else
        return null
} 
```

这可以概括为：

```
public static T getPreviousVersion(T entity, int current_rev) {
    AuditReader reader = AuditReaderFactory.get(JPA.em());

    Number prior_revision = (Number) reader.createQuery()
    .forRevisionsOfEntity(entity.getClass(), false, true)
    .addProjection(AuditEntity.revisionNumber().max())
    .add(AuditEntity.id().eq(((Model) entity).id))
    .add(AuditEntity.revisionNumber().lt(current_rev))
    .getSingleResult();

    if (prior_revision != null)
        return (T) reader.find(entity.getClass(), ((Model) entity).id, prior_revision);
    else
        return null
} 
```

这种概括的唯一棘手之处是获取实体的 id。因为我用的是Play！框架，我可以利用所有实体都是模型并用于获取 id 的事实`((Model) entity).id`，但您必须调整它以适应您的环境。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-18T20:27:58.177

那么也许这个（来自[AuditReader](http://www.jboss.org/files/envers/api-beta/org/hibernate/envers/AuditReader.html)文档）

```
AuditReader reader = AuditReaderFactory.get(entityManager);
User user_rev1 = reader.find(User.class, user.getId(), 1);

List<Number> revNumbers = reader.getRevisions(User.class, user_rev1);
User user_previous = reader.find(User.class, user_rev1.getId(),
  revNumbers.get(revNumbers.size()-1)); 
```

（我对此很陌生，不确定我的语法是否正确，也许 size()-1 应该是 size()-2？）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-20T19:48:18.983

我想会是这样的：

```
final AuditReader reader = AuditReaderFactory.get( entityManagerOrSession );

// This could probably be declared as Long instead of Object
final Object pk = userCurrent.getId();

final List<Number> userRevisions = reader.getRevisions( User.class, pk );

final int revisionCount = userRevision.size();

final Number previousRevision = userRevisions.get( revisionCount - 2 );

final User userPrevious = reader.find( User.class, pk, previousRevision ); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-11-01T15:31:04.797

在@brad-mace 的出色方法的基础上，我进行了以下更改：

*   您应该传入您的 EntityClass 和 Id，而不是硬编码和假设模型。
*   不要对您的 EntityManager 进行硬编码。
*   没有必要设置 selectDeleted，因为删除的记录永远不能作为以前的修订返回。
*   如果没有结果或找到超过 1 个结果，则调用 get single result with throw 和 exception，因此调用 resultlist 或捕获异常（此解决方案调用 getResultList 且 maxResults = 1）
*   在一个事务中获取修订、类型和实体（删除投影，使用 orderBy 和 maxResults，并查询 Object[3]）

所以这是另一个解决方案：

```
public static <T> T getPreviousRevision(EntityManager entityManager, Class<T> entityClass, Object entityId, int currentRev) {
    AuditReader reader = AuditReaderFactory.get(entityManager);
    List<Object[]> priorRevisions = (List<Object[]>) reader.createQuery()
            .forRevisionsOfEntity(entityClass, false, false)
            .add(AuditEntity.id().eq(entityId))
            .add(AuditEntity.revisionNumber().lt(currentRev))
            .addOrder(AuditEntity.revisionNumber().desc())
            .setMaxResults(1)
            .getResultList();

    if (priorRevisions.size() == 0) {
        return null;
    }
    // The list contains a single Object[] with entity, revinfo, and type 
    return (T) priorRevision.get(0)[0];
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T14:38:10.380

从文档：

```
AuditReader reader = AuditReaderFactory.get(entityManager);
User user_rev1 = reader.find(User.class, user.getId(), 1); 
```

# .net - 我们不应该在 WinForms 应用程序中使用 System.Web.Caching.Cache 类吗？

> ID：793675
> 
> 赞同：3
> 
> 时间：2009-04-27T14:13:09.673
> 
> 标签：.net, winforms, caching

我看过几篇文章/博客文章提倡在不用于 Web 的应用程序中使用 System.Web.Caching.Cache，但是，[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx)非常清楚地指出

> Cache 类不适合在 ASP.NET 应用程序之外使用。它是为在 ASP.NET 中使用而设计和测试的，以便为 Web 应用程序提供缓存。在其他类型的应用程序中，例如控制台应用程序或 Windows 窗体应用程序，ASP.NET 缓存可能无法正常工作。

文档是错误的，还是我们真的不应该使用这个类？如果是后者，会出现什么问题？我们的平台是 Winforms/.NET 3.5。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T14:22:10.713

如果应用程序不是 ASP.NET 应用程序，则无法自动删除过期或未使用的缓存对象。因此，如果在 ASP.NET 之外使用 Cache 对象，则为 Cache 对象保留的系统内存不会被释放。您不能手动调用内部 ASP.NET 方法来清理缓存，因为这些方法被标记为内部并供内部使用。因此，您决定在外部应用程序中使用它，风险自负。[System.Web.Caching.Cache 对象](http://support.microsoft.com/kb/917411)

Scott Hanselman 有[一篇](http://www.hanselman.com/blog/UsingTheASPNETCacheOutsideOfASPNET.aspx)关于它的文章以获取更多详细信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T14:16:46.093

你真的不应该在 ASP.NET 之外使用它。但是，这是有关其他替代方案的不错的白皮书：

[http://msdn.microsoft.com/en-us/library/ms978502.aspx](http://msdn.microsoft.com/en-us/library/ms978502.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T14:15:17.750

文档是正确的，您不能在 Windows 应用程序中使用 asp.net 缓存。

**[缓存文章](http://msdn.microsoft.com/en-us/library/ms978502.aspx)**。

# bash - 无法在 Bash 4 中使用 Checkjobs 和 Autocd

> ID：793678
> 
> 赞同：2
> 
> 时间：2009-04-27T14:13:52.730
> 
> 标签：bash, bash4

Bash 4 中有新的选项：checkjobs 和 autocd。但是，我没有找到他们的文档

```
man bash 
```

我跑不成功

```
{checkjobs,autocd} 
```

我在发行说明中发现了以下内容

```
 There is a new `checkjobs` option that causes the shell to check for and
 report any running or stopped jobs at exit 
```

和

```
There is a new `autocd` option that, when enabled, causes bash to attempt
to `cd` to a directory name that is supplied as the first word of a
simple command. 
```

**如何使用 autocd 和 checkjobs？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T14:25:22.470

`autocd`and`checkjobs`不是命令，而是选项。

它们可以使用[`shopt`内置的](http://www.gnu.org/software/bash/manual/bashref.html#The-Shopt-Builtin).

例子：

```
shopt -s autocd 
```

和

```
shopt -s checkjobs 
```

或者

```
shopt -s autocd checkjobs 
```

设置两者。

# python - psycopg2“类型错误：字符串格式化期间并非所有参数都转换”

> ID：793679
> 
> 赞同：12
> 
> 时间：2009-04-27T14:13:53.837
> 
> 标签：python, postgresql, psycopg2

我正在尝试将二进制数据（漩涡哈希）插入 PG 表中，但出现错误：

```
TypeError: not all arguments converted during string formatting 
```

代码：

```
cur.execute("""
    INSERT INTO
        sessions
        (identity_hash, posted_on)
    VALUES
        (%s, NOW())
""", identity_hash) 
```

我尝试在插入之前将 conn.Binary("identity_hash") 添加到变量中，但得到相同的错误。

identity_hash 列是一个字节。

有任何想法吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-09-29T12:14:57.493

您遇到的问题是您将对象作为第二个参数传递：第二个参数应该是元组或字典。没有 % 字符串运算符中的快捷方式。

你应该做：

```
cur.execute("""
    INSERT INTO
        sessions
        (identity_hash, posted_on)
    VALUES
        (%s, NOW())
""", (identity_hash,)) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-01-09T03:20:36.080

遇到同样的问题，发现这其实在他们的[FAQ里都有](http://initd.org/psycopg/docs/faq.html)

> 我尝试执行查询，但它失败并出现错误不是所有参数都在字符串格式化期间转换（或对象不支持索引）。为什么？Psycopg 始终要求将位置参数作为序列传递，即使查询采用单个参数也是如此。请记住，要在 Python 中创建单个项目元组，您需要一个逗号！请参阅将参数传递给 SQL 查询。

```
cur.execute("INSERT INTO foo VALUES (%s)", "bar")    # WRONG
cur.execute("INSERT INTO foo VALUES (%s)", ("bar"))  # WRONG
cur.execute("INSERT INTO foo VALUES (%s)", ("bar",)) # correct
cur.execute("INSERT INTO foo VALUES (%s)", ["bar"])  # correct 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-27T16:10:04.573

您是否看过 psycopg2 源代码分发中的“examples/binary.py”脚本？它在这里工作正常。它看起来与您的摘录有点不同：

```
data1 = {'id':1, 'name':'somehackers.jpg',
     'img':psycopg2.Binary(open('somehackers.jpg').read())}

curs.execute("""INSERT INTO test_binary
              VALUES (%(id)s, %(name)s, %(img)s)""", data1) 
```

# .net - .NET 指南：为什么两个字母的首字母缩写词例外？

> ID：793680
> 
> 赞同：7
> 
> 时间：2009-04-27T14:13:56.600
> 
> 标签：.net, naming-conventions

Microsoft 的框架设计指南定义了以下内容：

> “务必将双字符首字母缩写词的两个字符大写，但驼峰式标识符的第一个单词除外”

因此，为仅包含两个字母的首字母缩略词定义了一个例外，因为具有三个或更多字母的首字母缩略词是“正确”的骆驼大小写或帕斯卡大小写。

问题是：**为什么**会有例外，即它背后的理由是什么？我无法从 FDG 的书或 Abrams 和 Cwalina 的博客中得到解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T15:00:10.420

为什么？这个套管的东西只是一个协议（为了提高可读性），而不是科学！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T14:38:18.180

他们说如果标识符的第一部分是驼峰式大小写，你应该保持它的驼峰式大小写而不是仅仅因为它是一个首字母缩写词就大写它。那是因为对你来说更重要的是能够说出来，例如（这在有问题的书中，顺便说一句，我很喜欢），你正在处理一个参数。

至于为什么要大写两个字符的首字母缩写词而不是三个字符的首字母缩写词，我个人不需要知道边缘情况是什么，因为我喜欢它的美学。

例如，我绝对喜欢这个：

```
XmlDocument 
```

在此：

```
XMLDocument 
```

对我来说，后者隐隐有 1982 年的味道。而且有点痛。

当然，这只是我。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T14:19:02.593

因为MS看起来比MS好多了……

严肃地说，这些规则的重点是摆脱像 CALTextBox 这样的命名。其中 CAL 是公司的首字母缩写词。语言设计团队觉得“CAL”的气味太像大多数程序员似乎无法正确使用的被滥用（而且很少被理解）的匈牙利符号。

所以他们继续长篇大论来摆脱编程世界的那些垃圾。这是试图编纂它的规则之一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T14:43:21.130

对于驼峰式大小写（第一个单词全部小写），您需要一个显式的例外，而不是正常的两个字母缩写例外，以大写第一个字母）。

否则会有两个相互矛盾的规则：

*   两个字母缩写的两个字母都大写。
*   驼峰名称的第一个单词/缩写较低。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-27T14:31:20.490

Microsoft .NET 在名称方面确实不一致。坦率地说，你提到的那本书充满了这样的例外。

我猜UI看起来比UI好。但是id看起来比id好...

# c# - C# 调用图生成工具

> ID：793685
> 
> 赞同：29
> 
> 时间：2009-04-27T14:14:20.903
> 
> 标签：c#, .net, code-analysis, call-graph

我刚刚得到一堆（大部分未记录的）C# 代码，我想在深入研究并开始重构之前可视化它的结构。我过去（在其他语言中）使用生成调用图的工具来完成此操作。

你能推荐一个好工具来促进 C# 中结构的发现吗？

**更新**

除了这里提到的工具，我（通过管道）看到人们说[.NET Reflector](http://www.red-gate.com/products/reflector/)和[CLR Profiler](http://www.microsoft.com/downloads/details.aspx?FamilyId=86CE6052-D7F4-4AEB-9B7A-94635BEEBDDA)具有此功能。有这些经验吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-27T14:18:06.480

[NDepend](http://www.ndepend.com/Features.aspx)在这方面做得很好。此外，Visual Studio 2008 Team System 有许多功能可以让您跟踪圈复杂度，但它比 NDepend 更基本。（运行代码分析）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-10-19T13:11:54.193

关于 NDepend，它可以生成一些可用的调用图，例如（[此处](http://www.ndepend.com/Res/DiagramBoxAndArrowGraphBig.jpg)为图片全尺寸）

![替代文字](https://i.stack.imgur.com/uT9pX.jpg)

[在此处](http://www.ndepend.com/Doc_VS_Arch.aspx#Call)查找有关 NDepend 调用图的更多说明。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-15T22:51:05.607

有点晚了，但是[http://sequenceviz.codeplex.com/](http://sequenceviz.codeplex.com/)是一个很棒的工具，可以显示调用者图/序列图。这些图表是通过逆向工程 .NET 程序集生成的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-27T16:01:11.957

我已经使用[doxygen](http://www.doxygen.nl/)取得了一些成功。这有点令人困惑，但免费且有效。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-27T14:19:22.890

[视觉工作室 2010](http://blogs.msdn.com/camerons/archive/2008/11/10/testing-draft-to-blog.aspx)。

另外，基于方法-反射器（分析器（Ctrl + R）；“取决于”和“使用者”）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-06-01T23:07:43.977

截至今天（2017 年 6 月），同类产品中最好的工具是 Resharper 的检查功能。它允许您查找所有来电、去电、值来源/目的地等。

与上面提到的其他工具相比，ReSharper 最好的部分是：它的错误更少。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-27T15:59:30.667

反射器的 SequenceViz 和 DependencyStructureMatrix 可能会帮助您： http: [//www.codeplex.com/reflectoraddins](http://www.codeplex.com/reflectoraddins)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-27T14:17:52.270

我不确定它是否会仅对源代码执行此操作，但[ANTS Profiler](http://www.red-gate.com/Products/ants_profiler/index.htm)将为正在运行的应用程序生成调用图（无论如何可能更有用）。

# jquery - 无法选择 SPAN 同级

> ID：793687
> 
> 赞同：3
> 
> 时间：2009-04-27T14:15:06.893
> 
> 标签：jquery, css-selectors, siblings

无法理解为什么此代码将 DIV 元素的颜色更改为蓝色，但不更改 SPAN 元素的颜色。有任何想法吗？

```
<html>
<head>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
  <script>
    $(document).ready(function(){
      $("#prev ~ div").css("color", "blue");
      $("#prev ~ span").css("color", "red");
    });
  </script>
</head>
<body>
  <span id="prev">span#prev</span>
  <div>div sibling</div>
  <span>span sibling</span>
</body>
</html> 
```

注意到如果我更换

```
<span id="prev">span#prev</span> 
```

和

```
<p id="prev">span#prev</p> 
```

DIV 和 SPAN 都会更改文本颜色。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T14:26:00.347

看起来你发现了一个错误。

$("#prev ~ span:not(#prev)") 有效，$("#prev").siblings("span") 也有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T14:21:17.173

这确实似乎是一个错误。[向 jQuery 报告错误](http://dev.jquery.com/report)。

[http://dev.jquery.com/report](http://dev.jquery.com/report)

似乎有[相当数量的兄弟选择器错误](http://dev.jquery.com/search?q=~+selector&go=&wiki=on&changeset=on&ticket=on)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T14:18:15.497

似乎是 JQuery 的错误。您应该将此错误提交给团队并让他们修复它。

# sql-server - IIS 和 MS SQL 服务器的简单故障转移

> ID：793692
> 
> 赞同：0
> 
> 时间：2009-04-27T14:15:48.327
> 
> 标签：sql-server, iis, web-applications, failover, redundancy

我有一个带有 .Net 1.0 Web 应用程序的客户端，该应用程序使用 IIS 和 SQL 2000 数据库。它使用共享托管服务托管，并且流量并不多（每天最多有几个访问者）。当然，主机偶尔会有停机时间，客户问我是否可以设置一个冗余系统以将停机时间减少到可以忽略不计。

我可以对此设置进行的最简单/最便宜的改进是什么，以满足客户的要求？

我想象着用 2 个不同的服务托管 web 应用程序和数据库，并为应用程序添加一些逻辑，将请求传递给任何一个 web 服务器和数据库，但我担心保持数据库同步的复杂性。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-30T16:26:20.517

我建议将带有 mod_jk 的 apache2 服务器放在两个 IIS 端点前面。

# java - 使用 Richfaces 盲上和盲下的问题

> ID：793708
> 
> 赞同：1
> 
> 时间：2009-04-27T14:19:18.397
> 
> 标签：java, jsf, richfaces

使用 JSP 和 RichFaces。当单击“运行搜索”按钮时，搜索 div 应该被遮住，结果 div 应该被遮住。

```
 <div id="paper">

        <f:view>
            <h:form>

                <div id="criteria">
                    <rich:panel header="Search">
                        <h:inputText value="#{Bean.name}" id="name">
                            <h:outputLabel for="name" value="Enter Name: " />
                        </h:inputText>

                        <a4j:commandButton value="Run Search" action="#{Bean.runSearch}"
                                           onclick="hideCrit({duration:0.8}); showResult({delay:1.5,duration:0.5});"
                                           reRender="searchresultstable">
                        </a4j:commandButton>
                    </rich:panel>
                </div> <!-- end criteria -->

                <rich:effect name="hideCrit" for="criteria" type="BlindUp" />
                <rich:effect name="showResult" for="results" type="BlindDown" />

                <div id="results" style="display: none;">
                    <a4j:commandButton
                        id="searchbttn" value="Back To Search"
                        onclick="hideResult({duration:0.8}); showCrit({delay:0.9,duration:0.5});"
                        reRender="searchresultstable" />

                    <rich:panel header="Results">
                        <rich:dataTable id="searchresultstable" value="#{Bean.results}" var="req"
                                        styleClass="dataTable" rowClasses="oddrow, evenrow">

                            <f:facet name="header">
                                <rich:columnGroup>
                                    <h:column>
                                        <h:outputText styleClass="headerText" value="Name" />
                                    </h:column>
                                </rich:columnGroup>
                            </f:facet>

                            <rich:columnGroup>
                                <rich:column>
                                    <h:outputText value="#{req.name}" />
                                </rich:column>
                            </rich:columnGroup>
                        </rich:dataTable>
                    </rich:panel>
                </div> <!-- end results -->

                <rich:effect name="showCrit" for="criteria" type="BlindDown" />
                <rich:effect name="hideResult" for="results" type="BlindUp" />

            </h:form>
        </f:view>

    </div> <!-- end paper --> 
```

我在 tomcat 网络服务器上运行它。

包含的库有：

*   JSF 1.2
*   JSTL 1.1
*   commons-beanutils-1.7.0.jar
*   commons-collections-3.2.jar
*   commons-lang-2.2.jar
*   commons-logging-1.1.1.jar
*   mysql-connector-java-3.1.1.jar
*   richfaces-api-3.3.0.GA.jar
*   richfaces-impl-3.3.0.GA.jar
*   richfaces-ui-3.3.0.GA.jar

我收到两个错误。

这在加载：

> element.dispatchEvent 不是函数

当单击“运行搜索”按钮时。

> element.makeClipping 不是函数

**编辑** 似乎其他丰富的组件可以工作，但是，我尝试了多种，例如淡入淡出，但它们似乎不起作用。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T19:15:12.223

问题是 context.xml 文件中的一个参数。

原始文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<Context antiJARLocking="true" path="/project"/> 
```

antiJARLocking 参数不是我认识的，所以我删除了它，现在一切正常。

新文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<Context path="/project"> 
```

感谢大家的投入。

# java - 如何使用 Java prefuse 库创建条形图？

> ID：793712
> 
> 赞同：1
> 
> 时间：2009-04-27T14:20:07.677
> 
> 标签：java, prefuse

我目前已经[准备](http://prefuse.org/)好绘制一个散点图，其中 X 轴是计算机名称，Y 轴是它的温度。如何让它绘制显示值而不是离散点的条形？

我目前正在使用以下代码来渲染点：

```
ShapeAction shape = new ShapeAction(group, Constants.SHAPE_RECTANGLE);
ColorAction strokeColor = new DataColorAction(group, dataType, Constants.NUMERICAL, VisualItem.STROKECOLOR, colorPalette);

ActionList draw = new ActionList();
draw.add(shape);
draw.add(strokeColor);
draw.add(new ColorAction(group, VisualItem.FILLCOLOR, 0));
draw.add(new RepaintAction());
m_vis.putAction("draw", draw); 
```

我将如何调整此代码以获得从图表底部到该点的粗条，而不是每个点的小方块？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T09:59:35.777

我想我可能应该指出我是如何做到这一点的——毕竟 Stack Overflow 也应该是一个存储库。前面的代码如下：

```
m_vis.setRendererFactory(new RendererFactory() {
    Renderer yAxisRenderer = new AxisRenderer(Constants.LEFT, Constants.TOP);
    Renderer xAxisRenderer = new AxisRenderer(Constants.CENTER, Constants.FAR_BOTTOM);
    Renderer barRenderer = new ShapeRenderer();

    public Renderer getRenderer(VisualItem item) {
        return item.isInGroup("yAxis") ? yAxisRenderer :
               item.isInGroup("xAxis") ? xAxisRenderer :
               barRenderer;
    }
}); 
```

我扩展了形状渲染器以始终返回一个具有正确宽度和高度的矩形，并将其定位在它应该在的位置左侧半条。如果你想把你的酒吧放在中间，你需要自己做——prefuse 帮不了你。

```
m_vis.setRendererFactory(new RendererFactory() {
    Renderer yAxisRenderer = new AxisRenderer(Constants.LEFT, Constants.TOP);
    Renderer xAxisRenderer = new AxisRenderer(Constants.CENTER, Constants.FAR_BOTTOM);
    Renderer barRenderer = new ShapeRenderer() {
        protected Shape getRawShape(VisualItem item) {
            double x = item.getX();
            double y = item.getY();
            if (Double.isNaN(x) || Double.isInfinite(x))
                x = getInsets().left + axisWidth + totalBarWidth / 2;
            if (Double.isNaN(y) || Double.isInfinite(y))
                y = 0;

            double width = totalBarWidth / (barCount + 1) - barGap;
            double height = getHeight() - getInsets().bottom - axisHeight - y;
            x -= width / 2;

            return rectangle(x, y, width, height);
        }
    };

    public Renderer getRenderer(VisualItem item) {
        return item.isInGroup("yAxis") ? yAxisRenderer :
               item.isInGroup("xAxis") ? xAxisRenderer :
               barRenderer;
    }
}); 
```

# c# - 我该如何解决这个问题以将通用转换为 Nullable ?

> ID：793714
> 
> 赞同：50
> 
> 时间：2009-04-27T14:20:36.660
> 
> 标签：c#, nullable

我目前使用这种方便的转换扩展方法来进行类型之间的转换：

```
 public static T To<T>(this IConvertible obj)
    {
        return (T)Convert.ChangeType(obj, typeof(T));
    } 
```

但是，它不喜欢将有效值转换为 Nullable，例如，这会失败：

```
 "1".To<int?>(); 
```

显然，1 很容易转换为 (int?)，但它得到了错误：

```
 Invalid cast from 'System.String' to 'System.Nullable`1[[System.Int32, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]'. 
```

这是一个明显简化的示例，实际上我使用它来进行字符串类型的转换，如下所示：

```
packageDb.Quantity = package.package.ElementDeep(Namespace + "PackageQuantity", Namespace + "ActualQuantity", Namespace + "Quantity").ValueOrNull().To<int?>(); 
```

如果 Convert.ChangeType 不喜欢 Nullable，那么有人有什么好主意吗？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-04-27T14:55:52.473

```
public static T To<T>(this IConvertible obj)
{
    Type t = typeof(T);
    Type u = Nullable.GetUnderlyingType(t);

    if (u != null)
    {
        return (obj == null) ? default(T) : (T)Convert.ChangeType(obj, u);
    }
    else
    {
        return (T)Convert.ChangeType(obj, t);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T14:47:30.183

```
public static T To<T>(this IConvertible obj) 
{
    Type t = typeof(T);
    if (t.IsGenericType && t.GetGenericTypeDefinition() == typeof(Nullable<>))
        t = t.GetGenericArguments()[0];

    return (T)Convert.ChangeType(obj, t); 
} 
```

但是如果转换失败，它会抛出一个异常，而不是像预期的那样返回 null。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-13T19:11:18.253

我结束了这个

```
private static T To<T>(this Object @object, Boolean returnDefaultOnException)
{
    Type type = typeof(T);
    Type underlyingTypeOfNullable = Nullable.GetUnderlyingType(type);
    try
    {
        return (T) Convert.ChangeType(@object, underlyingTypeOfNullable ?? type);
    }
    catch (Exception exception)
    {
        if (returnDefaultOnException)
            return default(T);
        String typeName = type.Name;
        if (underlyingTypeOfNullable != null)
            typeName += " of " + underlyingTypeOfNullable.Name;
        throw new InvalidCastException("Object can't be cast to " + typeName, exception);

    }
}
public static T To<T>(this Object @object) { return @object.To<T>(returnDefaultOnException: false); }
public static T ToOrDefault<T>(this Object @object) { return @object.To<T>(returnDefaultOnException: true); } 
```

它的行为类似于 LINQ 扩展方法`Single`and `SingleOrDefault`and `First`and `FirstOrDefault`。

简而言之，`To<T>()`尝试转换并在失败时抛出，同时`ToOrDefault<T>()`尝试转换并在失败时返回`default(T)`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-01-12T17:33:29.083

卢克的解决方案对我有好处（显然得到了他的支持）但我以这种方式为我简化了它

```
 private static Type ResolveType(String typeName)
    {
        Type t = Type.GetType(typeName);
        if (t == null)
            return null;

        Type u = Nullable.GetUnderlyingType(t);

        if (u != null) {
            t = u;
        }
        return t;
    } 
```

因为我从一个字符串而不是从一个类型开始......想法？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-27T14:24:02.020

也许我错过了这一点，但在 Nullable 的实例中，您的方法如何提供比简单强制转换（如？）的可读性、性能或维护优势`(int?)1`？

除此之外，也许还有另一种扩展方法？

```
public static T? ToNullable<T>(this T obj) where T:struct
{
    return (T?)obj;
} 
```

**编辑**

在查看了您的编辑后，为什么我提供的通用函数不能替代您`To<T>`在该代码行中的函数？您不能允许任何类型转换为 Nullable （这就是为什么`ChangeType`不起作用），因为该泛型只接受值类型。您要么必须使用像我提供的那样的函数，要么将您的签名更改`To<T>`为仅接受值类型并为`Nullable<T>`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T14:36:05.343

这是我目前使用的方法（我在[SO](https://stackoverflow.com/questions/773078/c-convert-string-to-nullable-type-int-double-etc)上得到了答案），它从字符串转换为可空类型：

```
 public static Nullable<T> ConvertToNullable<T>(this string s) where T : struct
    {
        if (!string.IsNullOrEmpty(s.Trim()))
        {
            TypeConverter conv = TypeDescriptor.GetConverter(typeof(Nullable<>).MakeGenericType(typeof(T)));
            return (Nullable<T>)conv.ConvertFrom(s);
        }
        return null;
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-24T19:06:50.760

此方法可以满足您的需要，并且在执行时看起来不错。

```
 /// <summary>
    /// <para>More convenient than using T.TryParse(string, out T). 
    /// Works with primitive types, structs, and enums.
    /// Tries to parse the string to an instance of the type specified.
    /// If the input cannot be parsed, null will be returned.
    /// </para>
    /// <para>
    /// If the value of the caller is null, null will be returned.
    /// So if you have "string s = null;" and then you try "s.ToNullable...",
    /// null will be returned. No null exception will be thrown. 
    /// </para>
    /// <author>Contributed by Taylor Love (Pangamma)</author>
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="p_self"></param>
    /// <returns></returns>
    public static T? ToNullable<T>(this string p_self) where T : struct
    {
        if (!string.IsNullOrEmpty(p_self))
        {
            var converter = System.ComponentModel.TypeDescriptor.GetConverter(typeof(T));
            if (converter.IsValid(p_self)) return (T)converter.ConvertFromString(p_self);
            if (typeof(T).IsEnum) { T t; if (Enum.TryParse<T>(p_self, out t)) return t;}
        }

        return null;
    } 
```

[https://github.com/Pangamma/PangammaUtilities-CSharp/tree/master/src/StringExtensions](https://github.com/Pangamma/PangammaUtilities-CSharp/tree/master/src/StringExtensions)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-18T09:52:10.577

扩展@LukeH 代码：

```
public static T GetValue<T>(string Literal, T DefaultValue)
    {
        if (Literal == null || Literal == "" || Literal == string.Empty) return DefaultValue;
        IConvertible obj = Literal;
        Type t = typeof(T);
        Type u = Nullable.GetUnderlyingType(t);

        if (u != null)
        {
            return (obj == null) ? DefaultValue : (T)Convert.ChangeType(obj, u);
        }
        else
        {
            return (T)Convert.ChangeType(obj, t);
        }
    } 
```

# bash - 无法在 Bash 4 中启用 globstar

> ID：793715
> 
> 赞同：12
> 
> 时间：2009-04-27T14:20:57.237
> 
> 标签：bash, bash4, shopt

我将以下内容未成功放入我的 .bashrc

```
shopt -s globstar 
```

我正在尝试通过

```
ls **/*.c 
```

并将其与

```
ls */*/*.c 
```

**如何在 Bash 4 中启用 globstar？**

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-27T14:59:47.363

唔。`shopt -s globstar`应该管用。

要进行调试，请确保您正在运行 Bash 4：

```
$SHELL --version 
```

然后检查设置`globstar`：

```
shopt globstar 
```

如果未设置，请尝试手动设置：

```
shopt -s globstar 
```

现在看看这是否有效。如果是这样，你可能想看看你为什么`.bashrc`不工作。您是否记得在编辑完之后重新启动您的 shell`.bashrc`或加载它`. .bashrc`？

# c# - 使用 LINQ to SQL 分页搜索结果

> ID：793718
> 
> 赞同：22
> 
> 时间：2009-04-27T14:21:58.513
> 
> 标签：c#, linq, linq-to-sql, pagination

*使用LINQ to SQL*获得分页结果的最佳模式是什么？

我有以下情况：

假设我想按*description搜索**items*表。我可以轻松做到：

 *```
public IQueryable<Item> FindItemsByDescription(string description)
{
   return from item in _dc.Items
          where item.Description.Contains(description);
} 
```

现在，对这个结果集进行分页的最佳方法是什么？

1.  我是否应该在执行此操作之前执行*计数*查询以找出结果集大小，然后根据我想要的限制此查询？我觉得这是要走的路。
2.  我是否应该执行完整的查询，从数组大小中获取计数并只返回这个数组的分页子集？如果结果集足够大，我觉得这将浪费大量时间......或者*LINQ to SQL*在这里做了什么魔术？

是否有用于执行此操作的*LINQ to SQL*通用模式？

编辑：我*必须*澄清一件小事。我知道 Take 和 Skip 方法。但是，在使用**Take**和**Skip**之前，我应该如何获得查询将检索的结果**总数？**

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-27T14:35:22.740

分页模式非常简单。它涉及使用 Skip() 和 Take() 扩展方法，如下所示：

```
public IQueryable<Item> FindItemsByDescription(string description, int pageIndex, int pageSize)
{
   return from item in _dc.Items
          where item.Description.
          Contains(description).
          Skip((pageIndex - 1) * pageSize).
          Take(pageSize);
} 
```

**更新：**要获得总数，只需使用 Count() 方法：

```
int totalCount = from item in _dc.Items
                 where item.Description.
                 Contains(description).Count();

int numberOfPages = (int)(totalCount/pageSize); 
```

根据您要显示记录的方式，您可以使用 numberOfPages 显示带有“第 X 页，共 Y”的导航栏......第 1 页，共 10 页，等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T14:29:22.710

您可以使用 Take 扩展方法：

```
public IQueryable<Item> FindItemsByDescription(string description, int resultAmount)
{
   return from item in _dc.Items
          where item.Description.Contains(description).Take(resultAmount);
} 
```

您可以更进一步，并为后续的“页面”使用 Skip：

```
public IQueryable<Item> FindItemsByDescription(string description, int resultAmount, int page)
{
   return from item in _dc.Items
          where item.Description.Contains(description).Skip(resultAmount * page).Take(resultAmount);
} 
```

# iphone - 同时播放两个声音 iphone sdk

> ID：793719
> 
> 赞同：0
> 
> 时间：2009-04-27T14:22:09.153
> 
> 标签：iphone, audio

我正在尝试在 iphone 上制作一个小型音乐应用程序。我想要一个八度音阶的钢琴，它会响应触摸并弹奏用户触摸的一个或多个键。我怎样才能同时播放两个或多个声音，使它听起来像一个和弦？我尝试使用 AVFoundation 但这两种声音只是一个接一个地播放。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T18:05:27.073

您将不得不使用 AudioQueueServices。文档在这里：

[Apple.com - AudioQueueServices 参考](http://developer.apple.com/documentation/MusicAudio/Reference/AudioQueueReference/Reference/reference.html)

本质上，您必须编写一些代码来打开多个输出，然后启动队列并让它们在 AudioQueueStart(AudioQueueRef aq) 之前阻塞，直到一切都准备好并准备好然后放开它们。

不幸的是，AVAudioPlayer 对这种事情还不够好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-06T22:19:03.733

如果您创建多个 AVAudioPlayer，您可以同时播放它们，它们将根据文档中列出的限制进行混合（并非所有文件类型都可以同时播放）。

如果您先分配它们，然后按顺序播放它们，它们将几乎同时播放。

如果您需要绝对完美的计时，请使用上述 AudioQueue 或使用 OpenAL。

# algorithm - 查找不在列表中的最小非负整数的算法

> ID：793725
> 
> 赞同：3
> 
> 时间：2009-04-27T14:23:21.927
> 
> 标签：algorithm, sorting, integer

给定一个整数列表，我怎样才能最好地找到一个*不在*列表中的整数？

该列表可能非常大，并且整数可能很大（即 BigIntegers，而不仅仅是 32 位整数）。

如果有任何区别，列表“可能”是排序的，即 99% 的时间它会被排序，但我不能依赖总是被排序。

**编辑 -**

为了澄清，给定列表 {0, 1, 3, 4, 7}，可接受解决方案的示例是 -2、2、8 和 10012，但我更愿意找到最小的非负解决方案（即 2）如果有一种算法可以找到它而无需对整个列表进行排序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T14:27:50.327

一种简单的方法是迭代列表以获得最高值`n`，然后您就知道它`n+1`不在列表中。

编辑：

找到最小的未使用正数的方法是从零开始并扫描列表以查找该数字，如果找到该数字则重新开始并增加。为了提高效率并利用列表被排序的高概率，您可以将小于当前的数字移动到列表的未使用部分。

此方法使用列表的开头作为较低数字的存储空间，`startIndex`变量跟踪相关数字的开始位置：

```
public static int GetSmallest(int[] items) {
    int startIndex = 0;
    int result = 0;
    int i = 0;
    while (i < items.Length) {
        if (items[i] == result) {
            result++;
            i = startIndex;
        } else {
            if (items[i] < result) {
                if (i != startIndex) {
                    int temp = items[startIndex];
                    items[startIndex] = items[i];
                    items[i] = temp;
                }
                startIndex++;
            }
            i++;
        }
    }
    return result;
} 
```

我进行了性能测试，在其中创建了从 0 到 19999 的 100000 个随机数的列表，这使得平均最低数字约为 150。在测试运行中（每个测试列表有 1000 个），该方法在未排序列表中平均找到了最小的数字8.2 毫秒，在排序列表中平均为 0.32 毫秒。

（我没有检查该方法离开列表的状态是什么，因为它可能会交换其中的一些项目。它至少会留下包含相同项目的列表，并且当它在列表中向下移动较小的值时，我认为它应该实际上，每次搜索都会变得更加有序。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-27T14:28:33.367

如果数字没有任何限制，那么您可以进行线性搜索以找到列表中的最大值并返回大一的数字。

[如果数字确实有限制（例如 max+1 和 min-1 可能溢出），那么您可以使用对部分排序的数据效果很好](https://stackoverflow.com/questions/220044/which-sort-algorithm-works-best-on-mostly-sorted-data)的排序算法。然后遍历列表，找到第一对不连续的数字 v_i 和 v_{i+1}。返回 v_i + 1。

要获得最小的非负整数（基于问题中的编辑），您可以：

*   如上所述使用部分排序对列表进行排序。二进制搜索列表中的 0。从此值遍历列表，直到找到两个数字之间的“间隙”。如果到达列表末尾，则返回最后一个值 + 1。

*   将值插入哈希表。然后从 0 向上迭代，直到找到不在列表中的整数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T14:27:15.677

除非它已排序，否则您将不得不逐项进行线性搜索，直到找到匹配项或到达列表末尾。如果你能保证它是排序的，你总是可以使用 BinarySearch 的数组方法，或者只是滚动你自己的二进制搜索。

或者像 Jason 提到的那样，总是可以选择使用 Hashtable。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T14:28:08.810

“可能已排序”意味着您必须将其视为完全未排序。如果您当然可以保证它已排序，这很简单。只需查看第一个或最后一个元素并加或减 1。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-11-09T15:41:35.883

我的正确性和性能都达到了 100%，您应该使用 N log(N) 复杂度的快速排序。干得好...

```
 public int solution(int[] A) {
    if (A != null && A.length > 0) {
        quickSort(A, 0, A.length - 1);
    }

    int result = 1;
    if (A.length == 1 && A[0] < 0) {
        return result;
    }

    for (int i = 0; i < A.length; i++) {
        if (A[i] <= 0) {
            continue;
        }
        if (A[i] == result) {
            result++;
        } else if (A[i] < result) {
            continue;
        } else if (A[i] > result) {
            return result;
        }
    }

    return result;
}

private void quickSort(int[] numbers, int low, int high) {
    int i = low, j = high;
    int pivot = numbers[low + (high - low) / 2];

    while (i <= j) {
        while (numbers[i] < pivot) {
            i++;
        }
        while (numbers[j] > pivot) {
            j--;
        }

        if (i <= j) {
            exchange(numbers, i, j);
            i++;
            j--;
        }
    }
    // Recursion
    if (low < j)
        quickSort(numbers, low, j);
    if (i < high)
        quickSort(numbers, i, high);
}

private void exchange(int[] numbers, int i, int j) {
    int temp = numbers[i];
    numbers[i] = numbers[j];
    numbers[j] = temp;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T14:27:51.667

除非您 100% 确定它已排序，否则最快的算法仍然必须至少查看列表中的每个数字一次，以至少验证某个数字*不在*列表中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-27T14:28:09.030

从理论上讲，找到最大值并加 1。假设您受到 BigInteger 类型的最大值的限制，如果未排序，请对列表进行排序，并查找间隙。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-27T14:28:34.210

您是否正在寻找[在线算法](http://en.wikipedia.org/wiki/Online_algorithm)（因为您说输入任意大）？如果是这样，请查看[Odds algorithm](http://en.wikipedia.org/wiki/Odds_algorithm)。

否则，如前所述，散列输入、搜索和打开/关闭布尔集的元素（集合中的散列索引）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-27T14:32:45.493

有几种方法：

*   在列表中找到最大的 int 并将其存储在 x 中。x+1 将不在列表中。这同样适用于使用 min() 和 x-1。

*   当 N 是列表的大小时，分配一个大小为 的 int 数组`(N+31)/32`。对于列表中的每个元素，设置数组索引处整数的位`v&31`（其中`v`是元素的值）`i/32`。忽略其中的值`i/32 >= array.length`。现在搜索第一个数组项 '!= 0xFFFFFFFF'（对于 32 位整数）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-27T14:33:42.777

如果您不能保证它已排序，那么您将获得 O(N) 的最佳时间效率，因为您必须查看每个元素以确保您的最终选择不存在。那么问题来了：

1.  可以在 O(N) 中完成吗？
2.  什么是最佳空间效率？

Chris Doggett 的找到最大值并加 1 的解决方案既 O(N) 又节省空间（O(1) 内存使用）

如果您只想要最好的答案，那么这是一个不同的问题。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-27T14:43:34.033

假设这是我正在考虑的问题：

> 您有 a `set`of all`ints`在 to 的范围内`1`，`n`但其中一个`ints`丢失了。告诉我`int`缺少哪个。

这是一个很容易用一些简单的数学知识解决的问题。已知范围之和`1 .. n`等于`n(n+1) / 2`。所以，let`W = n(n+1) / 2`和 let `Y`= 集合中数字的总和。您的集合中缺少的整数`X`, 将是`X = W - Y`。

**注意：** SO需要支持MathML

如果这不是那个问题，或者如果它更普遍，那么其他解决方案之一可能是正确的。我只是无法从这个问题中真正分辨出来，因为它有点模糊。

**编辑：**好吧，自从编辑以来，我可以看到我的答案是绝对错误的。有趣的数学，不过如此。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-02-05T06:46:08.780

我已经使用 Linq 和二进制搜索解决了这个问题。我得到了全面的100％。这是我的代码：

```
using System.Collections.Generic;
using System.Linq;

class Solution {

    public int solution(int[] A) {
        if (A == null) {
            return 1;
        } else {
            if (A.Length == 0) {
                return 1;
            }
        }
        List<int> list_test = new List<int>(A);
        list_test = list_test.Distinct().ToList();
        list_test = list_test.Where(i => i > 0).ToList();
        list_test.Sort();
        if (list_test.Count == 0) {
            return 1;
        }
        int lastValue = list_test[list_test.Count - 1];
        if (lastValue <= 0) {
            return 1;
        }
        int firstValue = list_test[0];
        if (firstValue > 1) {
            return 1;
        }
        return BinarySearchList(list_test);
    }

    int BinarySearchList(List<int> list) {
        int returnable = 0;
        int tempIndex;
        int[] boundaries = new int[2] { 0, list.Count - 1 };
        int testCounter = 0;
        while (returnable == 0 && testCounter < 2000) {
            tempIndex = (boundaries[0] + boundaries[1]) / 2;
            if (tempIndex != boundaries[0]) {
                if (list[tempIndex] > tempIndex + 1) {
                    boundaries[1] = tempIndex;
                } else {
                    boundaries[0] = tempIndex;
                }
            } else {
                if (list[tempIndex] > tempIndex + 1) {
                    returnable = tempIndex + 1;
                } else {
                    returnable = tempIndex + 2;
                }
            }
            testCounter++;
        }
        if (returnable == list[list.Count - 1]) {
            returnable++;
        }
        return returnable;
    }

} 
```

Large_2 测试的最长执行时间为 0.08 秒

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-27T17:24:41.057

您需要对列表进行排序。这意味着要么知道它已排序，要么对其进行排序。

*   对列表进行排序。如果已知列表已排序，请跳过此步骤。O(n lg n)
*   删除任何重复的元素。如果元素已经保证是不同的，请跳过此步骤。在）
*   使用二分搜索令 B 为 1 在列表中的位置。O(lg n)
*   如果 1 不在列表中，则返回 1。请注意，如果从 1 到 n 的所有元素都在列表中，则 B+n 处的元素必须为 n+1。O(1)
*   现在执行从 min = B, max = 列表末尾开始的 sortof 二分搜索。调用枢轴P的位置。如果P处的元素大于（P-B+1），则在范围[min，pivot]上递归，否则在范围（pivot，max]上递归。继续直到min=pivot =最大 O(lg n)
*   你的答案是（pivot-1 处的元素）+1，除非你在列表的末尾并且 (P-B+1) = B 在这种情况下它是最后一个元素 + 1。O(1)

如果列表已经排序并且具有不同的元素，这将非常有效。当列表只有非负元素或列表不包含值 1 时，您可以进行乐观检查以使其更快。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2011-12-09T16:56:22.187

刚接受采访，他们问我这个问题。这个问题的答案可以通过最坏情况分析找到。列表中存在的最小自然数的上限是长度（列表）。这是因为，在给定列表长度的情况下，列表中出现的最小数字的最坏情况是列表 0,1,2,3,4,5....length(list)-1。

因此对于所有列表，列表中不存在的最小数字小于等于列表的长度。因此，用 n=length(list)+1 个零启动一个列表 t。对应于列表中的每个数字 i（小于等于列表的长度）标记将值 1 分配给 t[i]。列表中第一个零的索引是列表中不存在的最小数字。因为，这个列表的下界 n-1，对于至少一个索引 j

# html - Zend_Mail 阅读邮件

> ID：793730
> 
> 赞同：1
> 
> 时间：2009-04-27T14:24:29.803
> 
> 标签：html, zend-framework, zend-mail

使用 Zend_Mail 发送邮件的文档很棒，但现在接收邮件很痛苦。我目前想要获取电子邮件的纯文本部分和 html 部分。现在我写了一个很长的函数，它遍历各个部分，然后查看标题，看看它是带引号的可打印的还是 base64 的，我必须做很多事情才能获得信息。我是否可能缺少一个可以获取邮件的明文和 html 的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T07:36:39.477

AFAIK，MIME 电子邮件对不同部分（HTML、纯文本、嵌入）的顺序没有标准。因此，您必须遍历所有部分并获得所需的部分。

但是因为 Zend_Mail 的结构是递归的，所以迭代应该很容易。也许您可以与我们分享您的代码，以便我们对其发表评论（如果有任何评论）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-26T07:47:53.947

尝试实现这样的事情：

```
/**
 * Returns the parts with plain text
 *
 * @param Zend_Mail_Message $message
 * @return array of Zend_Mail_Part
 */
public function findTextParts(Zend_Mail_Message $message){

    $result = array();

    foreach (new RecursiveIteratorIterator($message) as $part) {

        $token = strtok($part->contentType, ';');

        if ( $token == 'text/plain') {
            $result[] = $part;
        }

    }

    return $result;

} 
```

# windows-services - 启动 Windows 服务失败并出现错误 1053

> ID：793731
> 
> 赞同：13
> 
> 时间：2009-04-27T14:24:31.830
> 
> 标签：windows-services, .net-2.0, windows-server-2003

我有一个无法启动的 Windows 服务，出现错误“错误 1053：服务没有及时响应启动或控制请求”。

在我的调试器中运行该服务可以正常工作，如果我双击远程计算机上的服务 .exe 会弹出一个控制台窗口并继续运行而没有问题 - 我什至可以看到日志消息显示程序正在处理所有内容它应该是这样的。

该服务之前一直运行良好，尽管这是我个人第一次尝试使用对程序所做的最新更改来部署它。我已经评估了这些更改，但无法弄清楚它们是如何导致这个问题的，特别是因为当没有作为服务启动时一切运行良好。

服务实现的 StartRoutine() 方法是空的，所以应该“及时”返回。

我检查了计算机上的事件日志，除了在 30 秒的必要时间范围内没有收到服务的回复外，它没有提供任何其他信息。

由于它可以在我的机器上运行，并且作为双击的可执行文件，我将如何找出它作为服务失败的原因？

哦，它是 .NET 2.0，所以它不应该受到表现出这种症状的 1.1 框架错误的影响 ( [http://support.microsoft.com/kb/839174](http://support.microsoft.com/kb/839174) )

盒子是一台运行 SP2 的 windows server 2003 R2 机器。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-08-05T19:27:25.760

这是一个误导性错误。这可能是一个未处理的异常。

清空您的 OnStart() 处理程序，然后在您的构造函数中尝试此操作...

```
 public MainService()
    {
        InitializeComponent();

        try
        {
            // All your initialization code goes here.

            // For instance, my exception was caused by the lack of registry permissions
            ;
        }
        catch (Exception ex)
        {
            EventLog.WriteEntry("Application", ex.ToString(), EventLogEntryType.Error);
        }
    } 
```

现在检查系统上的 EventLog 是否存在应用程序错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T14:35:17.030

可能有很多事情，它可能有助于在出现问题的机器上获取堆栈跟踪。有很多方法可以做到这一点，但关键是你必须看看代码中哪里出错了。

您可以通过[远程调试](http://msdn.microsoft.com/en-us/library/bt727f1t(VS.80).aspx)来做到这一点，但一个简单的事情可能是只记录到事件记录器，或者如果你有记录的话。从字面上看，将 "WriteLine("At class::function()") 放在代码的各个部分，看看你是否已经做到了。

这至少会让你找到正确的方向（最终是代码）。

**更新**：

有关使用 WinDbg 解决启动问题的详细信息，请参阅 Microsoft 的[如何调试 Windows 服务](http://support.microsoft.com/kb/824344)一文。

这个[相关问题](https://stackoverflow.com/questions/125964/easier-way-to-start-debugging-a-windows-service-in-c)详细介绍了调试用 .NET 编写的服务的好方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T14:41:14.460

我同意 Scott 的观点，找出正在发生的事情的最简单方法是在启动代码中添加一些痕迹（也许它甚至不会出现在您的启动代码中）。

如果这没有帮助，您可以在此处发布您的代码，以便其他人可以查看。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T14:45:53.463

也许缺乏一些依赖，试试这个：
- 取消注册您的服务
- 再次注册

如果注册失败意味着缺少模块。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T14:47:32.073

如果 StartRoutine 为空，您可能正在其他地方启动它。

IIRC 你需要触发一个工作线程，然后从 StartRoutine 返回。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-24T12:44:54.940

可能导致此错误的问题之一是，如果需要部署的 Windows 服务包含一些错误，即它可能是简单的授权错误或任何事情，在我的情况下，我引用了一些不存在的用于日志记录的文件夹和文件，但是当提供这些文件和文件夹的正确路径时，它解决了我的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-08T19:07:44.080

我浏览了关于这个特定主题的所有帖子，但没有一个回复解决了这个问题，所以我添加了这个回复，以防这对其他人有帮助。诚然，这仅适用于新服务，不适用于此特定情况。

我正在编写一个文件监听服务。作为一个控制台应用程序，它运行良好。当我将它作为服务运行时，我得到了与上面相同的错误。我不知道（许多关于服务的 MSDN 文章很方便地省略了）是您需要从 ServiceBase.Run(YourClassName()); 中执行您的类。否则，您的应用程序将执行并立即终止，并且由于它已终止，即使没有发生错误或异常，您也会收到上述错误。这是一篇关于此的文章的链接。它实际上讨论了将您的应用设置为双重用途 - 控制台应用和服务： [创建组合命令行/Windows 服务应用](https://stackoverflow.com/questions/809082/create-a-combo-command-line-windows-service-app)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-27T05:43:09.383

我有这个问题，我的问题的根源是配置文件。我在记事本中编辑了它，记事本添加了一个特殊字符，导致服务无法正常运行，因为配置文件被破坏了。我在记事本++中看到了那个特殊字符，删除它后，服务开始像以前一样成功运行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-08T13:38:12.463

就我而言，我安装 Windows 服务的服务器上没有安装正确的 .NET 框架。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2011-02-21T13:55:48.760

另一个原因是，如果您将“调试”模式下的 DLL 复制到安装文件夹，则会出现此问题。您需要做的是在“发布”模式下运行项目复制 DLL 或直接形成发布文件夹而不是调试文件夹，，并将该DLL复制到安装文件夹中，它将起作用。您可以看到DLL的大小减小，它不会包含任何调试符号，就像那样

# delphi - 从专门的泛型类型派生

> ID：793735
> 
> 赞同：3
> 
> 时间：2009-04-27T14:25:30.050
> 
> 标签：delphi, generics, inheritance, delphi-2009

是否可以从专门的泛型类型派生一个类：

```
TGenericBase <T> = class
  // ...
end;

TSpecializedDerived = class (TGenericBase <String>)
  // ...
end; 
```

只是想知道这是否可能......

**当我把它放在一个新项目中时，编辑**代码工作正常。一定是由于其他一些错误；对于那个很抱歉

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T14:47:17.237

是的。我一直都这样做。它非常有用。我最喜欢的技巧之一是这样的：

```
TSpecializedList = class(TObjectList<TMyType>)
public
 (extra methods specific to handling TMyType objects)
end; 
```

# design-patterns - 这是对 Singleton 模式的良好使用吗？

> ID：793737
> 
> 赞同：1
> 
> 时间：2009-04-27T14:25:43.077
> 
> 标签：design-patterns, oop, singleton

我做了很多“设计你自己的____”应用程序。
我所做的是创建一个单例类来保存用户选择的所有自定义项。例如：当你选择你想要绿色的东西时，它会将单例中的 getter/setter 更新为绿色。然后，当应用程序需要知道选择了什么颜色时，它会从同一个 getter/setter 中获取信息。
我以前这样做的方法是将信息存储在 UI 中（只需检查从下拉列表中选择的颜色）。
在阅读了 MVC（我仍然没有“完全”理解 MVC）之后，我现在知道这是完全错误的，这就是为什么我将它抽象为包含所有这些的单例类。

现在我想知道这是否也是一个坏主意？如果是这样，我应该怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T14:31:34.543

我想说这并不是单例模式的真正用途。这是一种非常容易被误解的模式，人们使用它的最常见原因似乎是它易于访问，因为它们通常是静态的。真正发生的是您有一个配置问题，您正试图通过一个静态单例来解决这个问题，该静态单例可以在整个应用程序中轻松访问。当尝试控制对真正有限的资源的访问时，将是“正确”的使用。

如果您认为对于应用程序只有一个通用“配置”可能真的没有意义。拥有多个但也许一次只使用一个更有意义。

-Edit- 考虑使用依赖注入或控制反转，而不是使用可以静态访问的单例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T14:34:16.207

单例通过设计将实例数限制为一个。在你的情况下，你为什么决定你必须只有一个实例？如果你想要多个配置怎么办？您的设计不可能有多个实例，每个实例代表不同的配置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T14:52:25.493

请记住，Singleton 基本上是一个全局变量，并且具有所有相同的问题。例如：

*   每个类都可能依赖于单例（以及单例本身所依赖的任何东西）。但是这种依赖并没有通过您传递的值明确表示，因此无法检测到。
*   由于您可以从程序中的任何位置对其进行写入，因此每次调用函数时都存在更改它的风险。所以你永远不能完全依赖它的价值。

我知道将对象传递给需要它的程序的每个部分是很痛苦的。但这最终会带来更好的设计。

*   它将迫使您减少依赖于您的数据对象的类的数量。
*   这将使重构更容易和更可预测，因为您将确信您的对象不会在您背后改变。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T14:34:23.743

我假设您正在谈论诸如[汽车配置](http://ak4-de.audi.de/controller?next=carline-page&mandant=accx-de)器之类的东西-选择油漆，发动机，轮辋和所有其他东西。

在这种情况下，我不会使用单例。不是因为它不起作用，而是因为它似乎在语义上是错误的。单例意味着只有一个状态。但是您的应用程序可能有两个窗口 - 类似于两个文档。使用单例，您不能独立修改两个文档，因为它们共享它们的状态。所以你看，它真的不应该是一个单例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T14:32:52.123

作为一个[服务层](http://martinfowler.com/eaaCatalog/serviceLayer.html)的人（尽管我对服务层有自己的看法），我建议做一些[IoC](http://www.martinfowler.com/articles/injection.html)并将所有自定义逻辑移动到一个单独的服务（`AmbienceService`或其他东西）。因此，在您的演示者中，您将执行以下操作（C# 样式的伪代码）：

```
viewModel.HeaderColor = ServiceLocator.Resolve<AmbienceService>().HeaderColor; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T14:34:11.683

我不完全确定你的问题是什么，但这就是我正在做的。

您的应用程序有一个 UI，允许用户选择一堆参数（例如，带有一组颜色的下拉菜单。其中一个是绿色。）

稍后（例如在关闭应用程序并重新启动它之后）需要再次加载所选值。

如果这是您的具体问题，我真的认为这与单例模式本身没有任何关系。我认为您想要的是一个配置文件（应用程序的 app.config 和 Web 应用程序的 web.config）。使用 ConfiguratoinManager 类，您可以轻松访问这些。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T14:38:02.017

您的问题的答案可能与您当前的环境有很大关系。例如，在 Java 中，运行时属性是通过 System.getProperties 等提供的。Windows 有它的注册表。

你有没有想过像使用 Contexts 来传输状态这样的解决方案？你真的需要全局属性吗？您的属性可以在运行时更改吗？您是否会有多个线程可能修改相同的属性？这些都是设计中要考虑的事情。

就我个人而言，我通常只是选择似乎是我工作环境的惯例。从您的最后一个问题来看，听起来您正在使用 ActionScript，是否已经存在针对它的约定？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-27T14:39:29.737

这不是您应该使用的模式。我认为您应该尝试使用状态模式。当您需要从许多不同的地方访问有限的资源时，单例是适用的。

就像打开和读取配置文件一样。他们不是通过不同的类来读取同一个文件，而是通过一个只这样做的类。您需要的是，当用户更改设置时，需要通知系统某些内容已更改。

但这实际上取决于您使用的语言。据我所知，只有 java 有 onNotify() 方法。但我可能是错的。

# audio - 具有动态速度调整的 MP3 播放

> ID：793743
> 
> 赞同：0
> 
> 时间：2009-04-27T14:27:19.797
> 
> 标签：audio, mp3, playback, tempo

我需要在 Windows 上开发一个快速而肮脏的应用程序，让用户可以使用滑块控制播放 mp3 文件的速度。

关于库/编程语言/控件的任何建议可以使这变得容易吗？

我无法控制媒体选择（必须是 mp3）或平台（必须是 windows）

编辑：实际上，我可以将文件转换为任何必要的格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T17:12:11.960

Windows Media Player v10+ 内置了这个。[看看这里。](http://www.microsoft.com/windows/windowsmedia/knowledgecenter/howto/PlayFaster_how_to.aspx)这不是你需要的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T15:12:22.123

你可以看看[这个。](http://www.codeproject.com/cs/media/cswavplay.asp?df=100&forumid=13779&exp=0&fr=26&select=736865)

* * *

**编辑：**[WinMM.dll](http://msdn.microsoft.com/en-us/library/ms713771(VS.85).aspx)有一个名为[waveOutSetPlaybackRate](http://msdn.microsoft.com/en-us/library/ms713761(VS.85).aspx) ( [P/Invoke](http://www.pinvoke.net/default.aspx/winmm.waveOutSetPlaybackRate) )的函数，它可能会有所帮助，因为这个 DLL（自 Win 9x 以来已包含在 Windows 中）可以播放 MP3。[以下](http://www.geekpedia.com/code111_Play-MP3-Files-Using-Csharp.html)是有关如何使用 C# 播放声音的一些基本信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T15:13:15.397

到目前为止，这是我发现的：

[适用于 Windows Media Player® 的 2xAV™ 插件](http://www.enounce.com/products/ms/wmp/2xav/usersguide.php#Plug-InUsersGuide)

理想情况下，我更喜欢开源的东西，但如果我找不到其他选择，我会试一试。

# c# - 为什么 File.Open 在覆盖现有文件方面比 File.Create 好得多？

> ID：793753
> 
> 赞同：7
> 
> 时间：2009-04-27T14:29:26.327
> 
> 标签：c#, file

这与询问如何覆盖现有文件的其他 SO[问题有关。](https://stackoverflow.com/questions/793589/overriding-an-existing-file-in-c)

最佳答案是这样的：

```
FileStream file = File.Open("text.txt", FileMode.Create); 
```

我的回答是这样的：

```
FileStream fs = System.IO.File.Create(fileName); 
```

截至我写这个问题时，赞成票是 14-0 `Open`。

如果投票表明解决方案的好坏，这让我有点疑惑：

> 这些方法中是否缺少一些我可以清楚地选择更好的 `Open`方法`Create`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T14:35:51.850

对我来说，我确切地知道做什么`File.Open("...", FileMode.Create)`，因为我可以将鼠标悬停在`FileMode.Create`上面，它告诉我每次都会创建一个新文件。`File.Create("...")`没有这样的工具提示表明它将执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T14:44:12.393

我知道只有一个地方可以找到答案：[Reflector](http://www.red-gate.com/products/reflector/)

事实证明，这两个调用都`new FileStream(...`带有全套参数！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T14:32:07.210

好吧，我也回答了`Create`但`Open`确实是更好的解决方案，因为您表示您希望打开一个文件，并且`FileMode.Create`您表示您希望创建该文件（如果该文件尚不存在）。我认为这很清楚。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T14:35:34.160

首先，我认为你可能读得太多了。例如，我倾向于对第一个正确答案投赞成票，而忽略任何进一步的答案……所以先到达那里会有所帮助。

其次，`File.Open`读起来比 好`System.IO.File.Open`，即使它们是相同的。

第三，从可读性的角度来看，Create 的语义相关性不如 Open。如果你想创建并打开一个文件，第一个更明确。

# c# - 如何在 C# 中使用 Webclient 填写表单并提交

> ID：793755
> 
> 赞同：29
> 
> 时间：2009-04-27T14:29:37.373
> 
> 标签：c#, webclient

我不熟悉在 C# 中使用库 WebClient、HttpResponse 和 HttpRequest，如果我的问题难以阅读，请耐心等待。

我需要构建一个基于 C# 的 WinForm，它可以打开一个 URL，该 URL 受到基本授权的保护。我通过将其添加到标题中来做到这一点，如下所示：

```
using (WebClient wc = new WebClient())
{
    wc.Headers.Add(HttpRequestHeader.Authorization, "Basic " +
    Convert.ToBase64String(
    Encoding.ASCII.GetBytes(username + ":" + password)));
} 
```

到目前为止，一切都很好！现在我想用一个数字填写一个表格，我从网站上找到源代码，发现名字是“数字”。所以我写这个：

```
NameValueCollection formData = new NameValueCollection();  
formData["number"] = number
byte[] responseBytes = wc.UploadValues(theurl, "POST", formData);
string response = Encoding.ASCII.GetString(responseBytes);
textBox_HTML.Text = response; 
```

但是我该如何提交呢？我想收到我的“搜索结果”...

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-04-27T14:34:33.243

您可能应该[`HttpWebRequest`](https://msdn.microsoft.com/en-us/library/system.net.httpwebrequest(v=vs.110).aspx)为此使用。这是一个简单的例子：

```
var strId = UserId_TextBox.Text;
var strName = Name_TextBox.Text;

var encoding=new ASCIIEncoding();
var postData="userid="+strId;
postData += ("&username="+strName);
byte[]  data = encoding.GetBytes(postData);

var myRequest =
  (HttpWebRequest)WebRequest.Create("http://localhost/MyIdentity/Default.aspx");
myRequest.Method = "POST";
myRequest.ContentType="application/x-www-form-urlencoded";
myRequest.ContentLength = data.Length;
var newStream=myRequest.GetRequestStream();
newStream.Write(data,0,data.Length);
newStream.Close();

var response = myRequest.GetResponse();
var responseStream = response.GetResponseStream();
var responseReader = new StreamReader(responseStream);
var result = responseReader.ReadToEnd();

responseReader.Close();
response.Close(); 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-04-27T10:44:19.843

Try this:

```
using System.Net;
using System.Collections.Specialized;  

NameValueCollection values = new NameValueCollection();
values.Add("TextBox1", "value1");
values.Add("TextBox2", "value2");
values.Add("TextBox3", "value3");
string Url = urlvalue.ToLower();

using (WebClient client = new WebClient())
{
    client.Headers.Add("Content-Type", "application/x-www-form-urlencoded");
    byte[] result = client.UploadValues(Url, "POST", values);
    string ResultAuthTicket = System.Text.Encoding.UTF8.GetString(result);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-29T06:15:08.013

我找到了解决我的问题的方法。首先，我对 http 通信中的一些基础知识感到困惑。这是由我编写的 python 脚本引起的，它有不同的通信方法。

我通过从头开始生成 POST 数据并打开包含在表单操作中的 uri 来解决它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-07T02:29:13.857

BFree 的回答效果很好。不过，我要注意的一件事是，数据连接确实应该是 url 编码的，否则你会遇到数据中的“=”和“&”符号之类的问题。

下面是 VB.NET 版本，urlencoded 并支持 UTF-8（请注意，url 编码需要引用 System.Web.dll，它仅在我从 .NET 4 Compact Framework 切换到常规 . NET 4 框架）。

```
Imports System.Web
Imports System.Net
Imports System.IO

Public Class WebFormSubmitter

    Public Shared Function submit(ByVal address As String,
                                  ByVal values As Dictionary(Of String, String)) As String
        Dim encoding As New UTF8Encoding
        Dim postData As String = getPostData(values:=values)
        Dim data() As Byte = encoding.GetBytes(postData)

        Dim request = CType(WebRequest.Create(address), HttpWebRequest)
        request.Method = "POST"
        request.ContentType = "application/x-www-form-urlencoded"
        request.ContentLength = data.Length
        Dim newStream = request.GetRequestStream()
        newStream.Write(data, 0, data.Length)
        newStream.Close()

        Dim response = request.GetResponse()
        Dim responseStream = response.GetResponseStream()
        Dim responseReader = New StreamReader(responseStream)
        Return responseReader.ReadToEnd()
    End Function

    Private Shared Function getPostData(ByVal values As Dictionary(Of String, String)) As String
        Dim postDataPairList As New List(Of String)
        For Each anEntry In values
            postDataPairList.Add(anEntry.Key & "=" & HttpUtility.UrlEncode(anEntry.Value))
        Next
        Return String.Join(separator:="&", values:=postDataPairList)
    End Function

End Class 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-18T21:06:32.410

使用 System.Net.Http.HttpClient 发布表单并将响应读取为字符串：

```
var formData = new Dictionary<string, string>();
formData.Add("number", number);

var content = new FormUrlEncodedContent(formData);

using (var httpClient = new HttpClient())
{
    var httpResponse = await httpClient.PostAsync(theurl, content);

    var responseString = await httpResponse.Content.ReadAsStringAsync();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T14:45:06.150

您已经使用 提交了它`UploadValues`。问题是：你的“结果搜索”是什么？页面返回什么？HTML？如果是这样 - [HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)是解析 html 的最简单方法。

# python - 从文件中删除行

> ID：793759
> 
> 赞同：3
> 
> 时间：2009-04-27T14:30:46.183
> 
> 标签：python, perl, text, awk, text-processing

我正在 unix 系统上进行一些文本处理。我可以访问这台机器上的命令行，它安装了 Python、Perl 和默认的文本处理程序、awk 等。

我有一个如下所示的文本文件：

```
2029754527851451717 
2029754527851451717 
2029754527851451717 
2029754527851451717 
2029754527851451717 
2029754527851451717 1232453488239 Tue Mar  3 10:47:44 2009
2029754527851451717 1232453488302 Tue Mar  3 10:47:44 2009
2029754527851451717 1232453488365 Tue Mar  3 10:47:44 2009
2895635937120524206 
2895635937120524206 
2895635937120524206 
2895635937120524206 
2895635937120524206 
2895635937120524206 
5622983575622325494 1232453323986 Thu Feb 12 15:57:49 2009 
```

它基本上是 3 行： ID ID 日期

我希望删除所有没有 2 个 ID 和日期的行。所以最终的结果会是这样的：

```
2029754527851451717 1232453488239 Tue Mar  3 10:47:44 2009
2029754527851451717 1232453488302 Tue Mar  3 10:47:44 2009
2029754527851451717 1232453488365 Tue Mar  3 10:47:44 2009
5622983575622325494 1232453323986 Thu Feb 12 15:57:49 2009 
```

你们如何建议这样做？文本文件总共长约 30,000 行。

干杯

伊夫

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-27T14:43:13.410

与`awk`：

```
awk 'NF > 2' input_file > output_file 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-27T14:49:24.987

```
grep ':' filename 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-27T14:42:29.260

```
with open(source_filename) as src:
    with open(dest_filename, 'w') as dst:
        for line in src:
            if len(line.split()) > 1:
                dst.write(line) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-27T14:43:53.517

使用 Perl：

```
perl -ne 'print if /^([0-9]+\s+){2}.+$/' $filename 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-27T15:06:35.880

只是在这里工作我的 perl，但这也可能有帮助：

```
perl -lane 'if (scalar(@F) == 3) { print @F;}' file >> file.out 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-27T14:37:36.277

使用 Python：

```
file = open(filename, 'r')
lines = file.readlines()
file.close()

p = re.compile('^\d*$')

for line in lines:
    if not p.search(line): print line, 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-27T14:47:22.307

```
awk "NF>1" < filename 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-08-08T10:36:10.873

```
perl -i -lane 'print if($F[1])' file 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-27T14:44:24.343

```
sed '/^[0-9]$/d'  filename 
```

（如果坏行有尾随空格，可能必须修改模式）。您也可以使用 grep -v，它将省略匹配的模式。

# python - 内置 Python hash() 函数

> ID：793761
> 
> 赞同：84
> 
> 时间：2009-04-27T14:31:00.507
> 
> 标签：python, google-app-engine, hash

Windows XP，Python 2.5：

```
hash('http://stackoverflow.com') Result: 1934711907 
```

谷歌应用引擎（[http://shell.appspot.com/](http://shell.appspot.com/)）：

```
hash('http://stackoverflow.com') Result: -5768830964305142685 
```

这是为什么？我怎样才能有一个哈希函数可以在不同平台（Windows、Linux、Mac）上给我相同的结果？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-04-27T14:43:44.577

如文档中所述，内置 hash() 函数*并非*旨在将生成的哈希值存储在外部某处。它用于提供对象的哈希值，将它们存储在字典中等等。它也是特定于实现的（GAE 使用 Python 的修改版本）。查看：

```
>>> class Foo:
...     pass
... 
>>> a = Foo()
>>> b = Foo()
>>> hash(a), hash(b)
(-1210747828, -1210747892) 
```

如您所见，它们是不同的，因为 hash() 使用对象的`__hash__`方法而不是“普通”散列算法，例如 SHA。

鉴于上述情况，合理的选择是使用[hashlib](http://docs.python.org/library/hashlib.html)模块。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-04-27T14:33:54.867

使用[hashlib](http://docs.python.org/library/hashlib.html?highlight=hash#module-hashlib)`hash()` [设计](https://docs.python.org/2/library/functions.html#hash)用于：

> 在字典查找期间快速比较字典键

因此不保证它在 Python 实现中是相同的。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2010-10-20T16:02:17.710

回应绝对不足为奇：事实上

```
In [1]: -5768830964305142685L & 0xffffffff
Out[1]: 1934711907L 
```

因此，如果您想**在 ASCII 字符串上**获得可靠的响应，只需将低 32 位作为`uint`. 字符串的散列函数是 32 位安全的并且*几乎*是可移植的。

另一方面，您完全不能依赖于获取`hash()`您尚未明确定义`__hash__`方法为不变的任何对象。

在 ASCII 字符串上，它之所以有效，只是因为哈希是在构成字符串的单个字符上计算的，如下所示：

```
class string:
    def __hash__(self):
        if not self:
            return 0 # empty
        value = ord(self[0]) << 7
        for char in self:
            value = c_mul(1000003, value) ^ ord(char)
        value = value ^ len(self)
        if value == -1:
            value = -2
        return value 
```

其中`c_mul`函数是 C 中的“循环”乘法（无溢出）。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2015-11-17T17:29:46.193

大多数答案表明这是因为平台不同，但还有更多。从[以下文档`object.__hash__(self)`](https://docs.python.org/3.5/reference/datamodel.html#object.__hash__)：

> 默认情况下，和 对象的`__hash__()`值是用不可预测的随机值“加盐”的。尽管它们在单个 Python 进程中保持不变，但它们在 Python 的重复调用之间是不可预测的。`str``bytes``datetime`
> 
> 这是为了防止由精心选择的输入引起的拒绝服务，这些输入利用字典插入的最坏情况性能，O(n²) 复杂度。有关详细信息，请参阅 [http://www.ocert.org/advisories/ocert-2011-003.html](http://www.ocert.org/advisories/ocert-2011-003.html)。
> 
> 更改哈希值会影响 和其他映射`dicts`的迭代顺序。`sets`Python 从未对这种顺序做出保证（它通常在 32 位和 64 位版本之间变化）。

即使在同一台机器上运行也会在调用中产生不同的结果：

```
$ python -c "print(hash('http://stackoverflow.com'))"
-3455286212422042986
$ python -c "print(hash('http://stackoverflow.com'))"
-6940441840934557333 
```

尽管：

```
$ python -c "print(hash((1,2,3)))"
2528502973977326415
$ python -c "print(hash((1,2,3)))"
2528502973977326415 
```

* * *

另请参阅环境变量[`PYTHONHASHSEED`](https://docs.python.org/3.5/using/cmdline.html#envvar-PYTHONHASHSEED)：

> 如果此变量未设置或设置为，`random`则使用随机值播种和对象的哈希值。`str``bytes``datetime`
> 
> 如果`PYTHONHASHSEED`设置为整数值，则将其用作固定种子，用于生成`hash()`散列随机化所涵盖的类型。
> 
> 它的目的是允许可重复的散列，例如解释器本身的自测，或者允许 python 进程集群共享散列值。
> 
> 整数必须是范围内的十进制数`[0, 4294967295]`。指定该值`0`将禁用散列随机化。

例如：

```
$ export PYTHONHASHSEED=0                            
$ python -c "print(hash('http://stackoverflow.com'))"
-5843046192888932305
$ python -c "print(hash('http://stackoverflow.com'))"
-5843046192888932305 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-03-29T04:36:02.383

哈希结果在 32 位和 64 位平台之间有所不同

如果两个平台上计算的哈希值相同，请考虑使用

```
def hash32(value):
    return hash(value) & 0xffffffff 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-05-26T00:58:06.807

猜测一下，AppEngine 正在使用 Python 的 64 位实现（-5768830964305142685 不适合 32 位），而您的 Python 实现是 32 位。您不能依赖对象散列在不同实现之间进行有意义的可比性。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-02-20T09:46:14.840

这是 Google 在生产中用于 python 2.5 的哈希函数：

```
def c_mul(a, b):
  return eval(hex((long(a) * b) & (2**64 - 1))[:-1])

def py25hash(self):
  if not self:
    return 0 # empty
  value = ord(self[0]) << 7
  for char in self:
    value = c_mul(1000003, value) ^ ord(char)
  value = value ^ len(self)
  if value == -1:
    value = -2
  if value >= 2**63:
    value -= 2**64
  return value 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-01-13T15:04:33.143

符号位呢？

例如：

十六进制值`0xADFE74A5`代表无符号`2919134373`和有符号`-1375832923`。当前值必须带符号（符号位 = 1），但 python 将其转换为无符号，从 64 位转换为 32 位后我们的哈希值不正确。

小心使用：

```
def hash32(value):
    return hash(value) & 0xffffffff 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-09-29T18:00:59.350

字符串的多项式哈希。`1000000009`并且`239`是任意素数。不太可能发生意外碰撞。模算术不是很快，但为了防止碰撞，这比取模的幂更可靠`2`。当然，很容易故意发现碰撞。

```
mod=1000000009
def hash(s):
    result=0
    for c in s:
        result = (result * 239 + ord(c)) % mod
    return result % mod 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-10-19T15:39:15.040

[PYTHONHASHSEED](https://docs.python.org/3/using/cmdline.html#envvar-PYTHONHASHSEED)的值可能用于初始化散列值。

尝试：

```
PYTHONHASHSEED python -c 'print(hash('http://stackoverflow.com'))' 
```

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-04-27T14:38:21.377

它可能只是询问操作系统提供的功能，而不是它自己的算法。

正如其他评论所说，使用[hashlib](http://docs.python.org/library/hashlib.html?highlight=hash#module-hashlib)或编写自己的哈希函数。

# perl - 如何开始学习perl

> ID：793765
> 
> 赞同：4
> 
> 时间：2009-04-27T14:31:58.443
> 
> 标签：perl

我是一名生物信息学学生，正在学习 perl。我没有很强的编程背景，但希望改变这种情况。

现在我正在阅读/关注这[本书并编写代码](http://www.perl.com/pub/a/2002/01/02/bioinf.html)

我想知道这是学习 perl 的最佳方式吗？我应该更多地尝试正则表达式吗？我应该继续尝试编写示例 perl 脚本吗？

**相关：** [什么是学习perl的好书](https://stackoverflow.com/questions/336715/what-are-good-books-for-learning-perl)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-27T14:37:58.150

权威的 Perl 学习书被恰当地称为“ [Learning Perl](http://oreilly.com/catalog/9780596520106/) ”。得到它。

我不推荐编写示例脚本。试着写一些你需要的东西。不一定要付出很大的努力。每个人都时不时需要一个小工具。编写示例脚本很无聊；一直是，永远都是。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T14:39:44.307

这似乎是一个潜在的重复，因为这里有一些相关的问题：

*   [开始学习 Perl 的最佳资源是什么？](https://stackoverflow.com/questions/172266/what-are-the-best-resources-to-starting-learning-perl)
*   [学习 Perl 的最佳在线资源是什么？](https://stackoverflow.com/questions/70573/whats-the-best-online-source-to-learn-perl)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T15:41:12.163

像这篇文章中的大多数其他答案一样，我不能不同意选择[“Learning Perl”](http://oreilly.com/catalog/9780596001322/)作为您的第一个 Perl 文本。保留一份[perldoc](http://perldoc.perl.org/)文档的副本以供快速参考（我更喜欢使用 html/pdf 格式，该格式可从主页下载）。

为了不让事情变得无聊，尤其是在最初阶段，我开始将我的 shell 脚本转换为 Perl，一直在修改它，直到我拥有相同程序的三个或更多不同版本，并且文件大小越来越小（虽然不利于维护） . 但是你知道他们说什么 - [TMTOWTDI](http://en.wikipedia.org/wiki/There_is_more_than_one_way_to_do_it)。现在我不再为 shell 脚本操心了，用 Perl 编写它可以缩短周转​​时间，而且代码可以很容易地重用和增强。

一旦你熟悉了更高级的概念，并且在日常工作或只是简单的单行代码中使用它已经接近了一定程度的舒适度，你可能想看看 Mark Jason Dominus 的[Higher-Order Perl](http://hop.perl.plover.com/)，它，据我说，将语言和读者对它的理解提升到了一个全新的水平。“递归和回调”一章让我大开眼界，完全改变了我从用 Perl 编写 C 程序到用 Perl 实际编写“Perl”程序的风格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T16:43:26.257

我使用在线书籍“ [Learning Perl the Hard Way](http://www.greenteapress.com/perl/ "艰难地学习 Perl") ”来教我的同事有关 Perl 的知识。

不要被标题吓倒，它只是针对已经精通另一种语言的程序员，因此它不关注*编程*部分，而是主要关注*Perl*部分，因此它可能更适用于您的情况（或不）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T15:16:44.903

您可能还想寻找[好的代码示例](https://stackoverflow.com/questions/643625/)来学习。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T14:38:17.757

喇嘛书你真的不会出错

[学习 Perl](http://oreilly.com/catalog/9780596001322/)

有很多关于 Perl 的 O'Reilly 书籍。 [编程 Perl](http://oreilly.com/catalog/9780596000271/)也非常出色，可能值得补充 Lama 的书——我的书架上都有这两本书，虽然我已经有一段时间不需要用 Perl 编码了，但我发现这些书放在一起是一个足够稳固的组合。[Perl Cookbook](http://oreilly.com/catalog/9780596003135/)也很有用（是的，这是 O'Reilly 非常擅长的领域之一 :-)。

至于实际练习，Perl 确实享有“只写”语言的美誉，因此请寻找清晰的示例，如果您对任何事情感到困惑，不一定认为问题出在您身上 - 总是有不止一种方法可以做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T15:45:46.270

我的经验是，没有什么比做更好的学习了。但是您需要有人提供反馈，尤其是当您遇到无法克服的障碍时。Stackoverflow 对此有好处，但是，IME，[Perlmonks](http://www.perlmonks.org)更好，因为它有一个即时反馈的聊天框，以及针对较长问题的问答帖子，以及更专业的环境。（据传拉里·沃尔（Larry Wall）以及上述书籍的一些作者也在那里闲逛。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-27T16:14:35.763

通过实践学习。得到别人提到的书，但真正的学习方法是开始一个简单的项目。我的是一个基于 Gtk 的 SQL 编辑器。如果您遇到问题，请在此处和[Perl Beginners](http://lists.cpan.org/showlist.cgi?name=beginners)列表中提问。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-27T16:31:31.230

书的选择因人而异。因此，作为使用 perl 的生物信息学学生，不要得到任何名为“（X 编程语言）生物信息学”的书。通常这类书都是。

*   他们只提供该编程语言的非常基本的内容。你会错过那种语言的所有力量。
*   把篇幅浪费在如何使用 API 上，你可以通过 google 轻松找到信息。

# wcf - WCF Web 服务错误

> ID：793767
> 
> 赞同：1
> 
> 时间：2009-04-27T14:32:30.690
> 
> 标签：wcf, binding

连接我的 wcf 服务时出现错误，

响应消息的内容类型 text/html 与绑定的内容类型不匹配（application/soap+xml; charset=utf-8）

我的 wcf 服务配置文件如下：

```
<?xml version="1.0"?>
<configuration>
    <customErrors mode="Off">
    </customErrors>
  <system.serviceModel>
    <services>
      <service name="WcfService1.Service1" behaviorConfiguration="WcfService1.Service1Behavior">
        <!-- Service Endpoints -->
        <endpoint address="http://127.0.0.1/ChickenService/Service1.svc" binding="basicHttpBinding" contract="WcfService1.IService1">
          <identity>
            <dns value="127.0.0.1"/>
          </identity>
        </endpoint>
          <host>
          <baseAddresses>
            <add baseAddress="http://127.0.0.1/"/>
          </baseAddresses>
        </host>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="WcfService1.Service1Behavior">
         <serviceMetadata httpGetEnabled="true"/>
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>
</configuration> 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T14:38:12.920

尝试改变这个：

```
<serviceDebug includeExceptionDetailInFaults="false"/> 
```

对此：

```
<serviceDebug includeExceptionDetailInFaults="true"/> 
```

并查看错误中的其他信息是否有帮助（还将该信息添加到帖子中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T14:51:41.937

听起来您在调用 WCF 服务时遇到了**ASP.NET 错误页面**（又名“*黄屏死机*”），这可以解释为什么响应的 MIME 类型是 text/html。
您是否在 IIS 中托管您的服务？

启用 Andrew 建议的异常详细信息后，您可以复制从服务返回的异常消息的内容，这将是一个长 HTML 字符串，将其粘贴到新的文本文件中，将其保存为 .HTML 并打开它在 Web 浏览器中查看错误详细信息。

# unix - 无法在终端中隐藏正在运行的进程

> ID：793778
> 
> 赞同：1
> 
> 时间：2009-04-27T14:34:39.000
> 
> 标签：unix, process, terminal

我昨天通过 MacPorts 的应用程序进行了升级，显然花了大约 4 个小时。在终端的一个选项卡中看到安装过程令人恼火。

**问题：**在终端中隐藏正在运行的进程，这样它就不会在我的工作区域中占用空间

我今天发现 Bash 4 中有一个新的命令 coproc：

> coprocess 在子shell 中异步执行，就好像在执行shell 和coprocess 之间建立的命令一样

我不确定您是否可以使用它来解决问题。我没有设法使用它。

**如何隐藏正在运行的进程**，使其在终端中不可见但继续运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T14:37:57.447

您是否考虑`Ctrl + Z`过暂停该过程，然后`bg`在后台运行此过程？

要将您的进程与终端分离，您可以键入`disown`. 您现在可以关闭终端，甚至您的会话。

这里的问题是输出无论如何都会出现在 bash 中。

您也可以在[screen](http://www.howtoforge.com/linux_screen)中启动您的程序。此命令提供了一种简单的方法来启动程序、关闭控制台并稍后检索它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T14:40:45.833

我怀疑你正在寻找 nohup

```
nohup LongRunningNoisyProgram & 
```

将运行程序，将输出记录到文件中，这样您就看不到它，将程序推入后台，并且如果您稍后在终端仍在运行时退出程序，则不会取消程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T07:34:52.713

其他回复者至少有一件事没有涉及：*如何管理隐藏进程*。

假设您有 100 个使用“nohup find / &”创建的后台进程。您想退出它们以真正了解后台进程是如何工作的。请使用以下命令：

```
ps -ej | awk '! /grep/ && /find/ {print $2}' | xargs kill -9 
```

然后，您可能想知道如何控制隐藏进程的键。您可以将其更改为 p，其中 susp 代表 CTRL+z (^Z)：

> stty susp

您可以在此处查看密钥：

> stty -a

请比较更改前后的标准输出。该命令特别有用，因为它有助于记住其他命令，例如 ^W（删除单词）。

杰罗姆对屏幕有一个很好的提示。我强烈建议追求方向：

> [http://www.commandlinefu.com/commands/matching/screen/c2NyZWVu/sort-by-votes](http://www.commandlinefu.com/commands/matching/screen/c2NyZWVu/sort-by-votes)

# vba - Outlook - 检查电子邮件地址类型

> ID：793779
> 
> 赞同：2
> 
> 时间：2009-04-27T14:34:40.170
> 
> 标签：vba, outlook

我正在尝试在 Outlook 中创建一个宏，该宏将扫描“收件人：”列表中的某个文本字符串，如果除一个（或两个等）地址之外的所有地址都有它，则吐出一条消息。有没有一种简单的方法可以做到这一点？

从本质上讲，我正在尝试编写一些东西，以避免向地址中带有字符串“xyz”的一群人发送受限制的消息，如果一个或多个没有它的话。自动完成使这变得困难，无需逐一检查。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T17:42:13.557

这可以使用 Outlook VBA。

当用户发送电子邮件时，您必须编写一个事件挂钩。这是使用 Application_ItemSend(ByVal Item As Object, Cancel As Boolean) 完成的，其中 Item 是正在发送的项目（电子邮件或约会），而 cancel 是一个布尔值，您可以设置以停止发送电子邮件。

在您的代码中，您可能希望查看 Item 对象上的收件人集合，以了解谁将接收电子邮件。例如：

```
Dim CurrRecip As Recipient
For Each CurrRecip in Item.Recipients
    If InStr(1, CurrRecip.Address , "your search text here" , vbCompareText ) Then
        debug.print "Message here..."
    End If
Next CurrRecip 
```

希望这会有所帮助...

# mysql - MySQL IN() 用于两个值/数组？

> ID：793784
> 
> 赞同：22
> 
> 时间：2009-04-27T14:35:29.323
> 
> 标签：mysql

我很难找到一种更好的方法来在 MySQL 中搜索表中的一对值。我有一个数组中的值对，并且想复制 IN() 函数，但是对于超过 1 个值。

例如有目的的；我有以下 3 对：

```
foo,1
boo,2
goo,3 
```

当前的解决方案使我处于：

```
SELECT * FROM [table] WHERE 
(column1 = 'foo' AND column2 = 1) OR
(column1 = 'boo' AND column2 = 2) OR
(column1 = 'goo' AND column2 = 3); 
```

我想有一个更“性感”的解决方案，因为我可以拥有多达 100 双，并且拥有可能让我感到恶心的 OR。谢谢！！！

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-04-27T14:38:46.150

```
SELECT  *
FROM    foo
WHERE   (column1, column2) IN (('foo', 1), ('bar', 2)) 
```

此语法可能会令人困惑，将其替换为以下内容可能更具可读性：

```
SELECT  *
FROM    foo
WHERE   ROW(column1, column2) IN (ROW('foo', 1), ROW('bar', 2)) 
```

不过我习惯了前者：）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T15:11:50.767

如果您可以轻松快速地将您的值放入临时表（您只需要两列），那么您可以在其中进行 INNER JOIN。如果没有，您将不得不使用@Quassnoi 版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-29T11:04:26.320

来自@Quassnoi 和@KM 的精彩回答！！！

此外，您可以获取对重复项并选择它们进行后处理：

```
SELECT *
FROM `foo`
WHERE (`id_obj` , `Foo_obj`)
IN (
  SELECT `id_obj` , `Foo_obj`
  FROM `foo`
  GROUP BY `id_obj` , `Foo_obj`
  HAVING count(*) > 1
) 
```

# xml - 简单的 XML 问题

> ID：793806
> 
> 赞同：0
> 
> 时间：2009-04-27T14:38:53.153
> 
> 标签：xml, xsd

我在运行时创建 XML，它的模式就像

```
<Item>
    <Content>Hi</Content>
</item> 
```

问题是当我试图将一些 HTML 内容保存到这个标签时

```
<Item>
    <Content><strong>Hi<strong></Content>
</item> 
```

如何解决此问题

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T17:15:45.227

我假设您有一个架构，它允许 Item 元素包含 Content 元素，并且 Content 元素只能包含文本或 CDATA 或类似内容。在这种情况下，您有两个选择。

首先，您可以以某种方式转义 html。您可以按照 Fredrik 上面的建议使用 CDATA 部分。或者，您可以如上所述逃避括号。这两种解决方案都允许您继续将 Content 的内容视为文本。这使您可以为元素创建一个简单的内容模型。

或者，您可以扩展架构以允许 xhtml 元素作为 Content 元素的一部分。[我在这里](https://stackoverflow.com/questions/733822/emded-xhtml-snippet-in-xml-document-and-validate-against-a-schema/734212#734212)提出了一种方法。当然，如果您的内容是 html 而不是 xhtml，这将不起作用。

确实，选择取决于您是否希望能够将嵌入的 html 解析为 xml 的一部分。如果您希望它是文本，请将其转义。如果您希望它可解析，请扩展您的模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T14:44:23.750

正确的答案是不要在 XML 中嵌入标签。XML 应该只定义数据，解析器应该把它放在正确的标记中，例如所有 Item->Contents in `<strong></strong>`。

另一种解决方案是使用 XML 转义符来转义标签：`&lt;`和`&gt;`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T14:42:42.193

您可以将 HTML 内容嵌入到 CDATA 部分中：

```
<Item><![CDATA[  <Content><strong>Hi</strong></Content> ]]></item> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T14:41:00.013

在将 HTML 字符串添加到 xml 之前，需要对其进行正确转义。如果您使用的是 .NET，这里有[一些方法](http://weblogs.sqlteam.com/mladenp/archive/2008/10/21/Different-ways-how-to-escape-an-XML-string-in-C.aspx)可以做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T14:41:52.350

小于标记 (<) 必须使用 < 进行转义。和 > 标签 (>) 相同

# php - CodeIgniter/PHP/MySQL：使用 JOIN 检索数据

> ID：793807
> 
> 赞同：6
> 
> 时间：2009-04-27T14:39:18.130
> 
> 标签：php, mysql, codeigniter

我是 PHP/MySQL 新手，也是 CodeIgniter 的新手。我在许多 MySQL 表中都有信息。我想用 JOIN 来检索它，其中表的主键等于 $variable... 我怎样才能做到这一点并获得所有没有主键字段的字段？？？

我现在正在做的是这个（这里只加入了两个表）：

```
function getAll($id) {

    $this->db->select('*');
    $this->db->from('movies');
    $this->db->join('posters', 'movies.id= posters.id');
    // WHERE id = $id ... goes here somehow...
    $q = $this->db->get();

    if ($q->num_rows() == 1) {
        $row = $q->row();
        $data = array(
                'id' => $row->id,
                'title' => $row->title,
                'year' => $row->year,
                'runtime' => $row->runtime,
                'plotoutline' => $row->plotoutline,
                'poster_url' => $row->poster_url
            );
    }

    $q->free_result();
    return $data; 
```

id (PK)、title、year、runtime 和 plotoutline 是第一个表中的列，poster_url 是第二个表中的字段。第二个表还包含一个我不想检索的 ID (PK) 列，因为我已经有了。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-27T21:38:26.093

乔恩是对的。这是一个例子：

```
$this->db->select('movies.id, 
                   movies.title, 
                   movies.year, 
                   movies.runtime as totaltime,  
                   posters.poster_url');
$this->db->from('movies');
$this->db->join('posters', 'movies.id= posters.id');
$this->db->where('movies.id', $id);
$q = $this->db->get(); 
```

这将返回具有 ->id、->title、->year、->totaltime 和 ->poster_url 属性的对象。您不需要额外的代码来从每一行获取数据。

不要忘记，如果 Active Record 语法有点笨拙，您可以使用完整的 SQL 查询并获得相同的结果：

```
$sql = "SELECT movies.id,
        movies.title,
        movies.year,
        movies.runtime as totaltime,
        posters.poster_url
        FROM movies
        INNER JOIN posters ON movies.id = posters.id
        WHERE movies.id = ?"

return $this->db->query($sql, array($id))->result(); 
```

这两种形式都将确保您的数据正确转义。

[CodeIgniter 活动记录](http://codeigniter.com/user_guide/database/active_record.html)

[CodeIgniter 中的查询绑定](http://codeigniter.com/user_guide/database/queries.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T15:15:06.220

星号将返回所有字段。要返回其中的一个子集，即除了重复的 id 字段之外的所有字段，只需列出您需要的列，而不是使用“*”。

无论如何不要使用星号通常是个好主意。在应用程序的未来，有人可能会在表中添加一个大字段，这将超出您的要求，并且会减慢您的查询速度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-28T16:25:32.747

简单地说就是方法链：

```
$this->db->select('*')
         ->from('movies')
         ->join('posters', 'movies.id= posters.id')
         ->where('movies.id', $id)
         ->get(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-24T12:26:06.947

```
$this->db->select('*');
$this->db->from('blogs');
$this->db->join('comments', 'comments.id = blogs.id');
$query = $this->db->get(); 
```

# javascript - Svg 图表库

> ID：793808
> 
> 赞同：45
> 
> 时间：2009-04-27T14:39:21.233
> 
> 标签：javascript, svg, charts

你知道是否有任何类似于[http://www.amcharts.com/](http://www.amcharts.com/) (Flash) 的 SVG + js 图表库。我需要在不支持 Flash 但支持 SVG 的浏览器中提供漂亮的交互式图表功能。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2011-08-04T09:56:56.447

根据许可要求和功能，您有几个选择。从 IE 6 到 IE8 不支持 SVG，因此您可能会发现一些库使用 canvas 在 IE 上运行，而另一些库使用 VML 在 IE 上运行。

*   [**Plotkit**](http://www.liquidx.net/plotkit/)是一个混合 SVG+Canvas 库，最新版本有点过时（0.9.1 于 2006 年 8 月 29 日发布）BSD 许可。

*   [**Elycharts**](http://elycharts.com)是一个 SVG+VML 库（在后台使用 RaphaelJS），具有良好的功能集、交互性和酷炫的动画。（2010 年 12 月的最新版本 2.1.3）Mit 许可。

*   [**g.raphael**](http://g.raphaeljs.com/)是一个 SVG+VML 库（使用 RaphaelJS，来自 RaphaelJS 的同一作者）。它对信息图表非常有用，对经典图表不太好。（2009 年的最新版本 0.4.1）Mit 许可。

*   [**Grafico**](http://grafico.kilianvalkhof.com/)又是一个 SVG+VML 库（同样基于 RaphaelJS）。它具有比 gRaphael 或 Elycharts 更多的图表类型，但比 Elycharts 更少的选项/可配置性。麻省理工学院许可。

*   [**Google Chart Tools**](http://code.google.com/apis/chart/)提供基于 SVG+VML 的图表。它可以免费使用，但我没有找到完整的许可条款。它还提供了一个编辑器（即使在他们的网站上不容易找到）

*   [**D3.js**](http://d3js.org/)是一个基于数据操作文档的 JavaScript 库。D3 帮助您使用 HTML、SVG 和 CSS 将数据变为现实。

您还有一些商业选择：

*   [**ZingChart**](http://www.zingchart.com/) - 这是唯一一个允许 SVG、VML、canvas 和 flash 的库，以支持所有设备。它很昂贵，但非常完整。

*   [**HighCharts**](http://www.highcharts.com/) - 一个非常完整的 SVG+VML 库，具有非常好的文档和非常完整的功能集。它有一个免费的个人使用许可证，但它显示了对个人的非常“严格”的解释，您自己的博客可能不被视为“个人”，这就是为什么我在“商业选项”下显示它的原因。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T14:46:30.937

您需要更具体地了解您需要的功能，但您可能需要查看[PlotKit](http://www.liquidx.net/plotkit/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-09T22:41:03.853

现在**amCharts**提供**SVG 图表**，并且仍然为不支持**SVG**的旧浏览器生成 flash 图表。

**amCharts**支持所有现代浏览器，包括现代版本的`Firefox`、`Chrome`、和. 它还可以在由( , , ) 和.`Safari``Opera``Internet Explorer``iOS``iPad``iPhone``iPod Touch``Android Honeycomb`

好东西，嗯？ [http://www.amcharts.com/](http://www.amcharts.com/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-21T09:55:33.407

[D3](http://d3js.org/)是一个非常好的开源图表库，它使用 SVG。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T07:10:26.753

google 可视化 API 有一些 SVG 图表，您可以使用[http://code.google.com/apis/visualization](http://code.google.com/apis/visualization) 虽然这不是一个 avg 库，但它是一个图表库。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-13T19:17:44.570

你检查[过 ZingChart](http://www.zingchart.com)吗？它以 HTML5 Canvas、SVG 和 Flash（以及用于旧 IE 后备的 VML）呈现图表。

我在团队中。如有任何问题，您可以通过 support[at]zingchart.com 联系我们的团队，或在[http://twitter.com/zingchart](http://twitter.com/zingchart)提及/关注我们。

-安德鲁

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-28T07:45:47.877

[Raphaël](http://raphaeljs.com/)也很有用——查看 gRaphaël——图表插件——它有非常令人印象深刻的例子。

# javascript - Javascript AES 加密

> ID：793812
> 
> 赞同：115
> 
> 时间：2009-04-27T14:40:00.623
> 
> 标签：javascript, encryption, aes

Javascript 中是否有可用于 AES 256 位加密的库？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-04-27T14:55:21.367

JSAES 是 JavaScript 中强大的 AES 实现。 [http://point-at-infinity.org/jsaes/](http://point-at-infinity.org/jsaes/)

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-05-13T13:20:26.207

这是一个使用 slowAES[的演示页面。](http://cheeso.members.winisp.net/AES-Encryption.htm)

[slowAES](http://code.google.com/p/slowaes)很容易使用。逻辑设计。合理的OO包装。支持 IV 和加密模式等旋钮和控制杆。与 .NET/C# 的良好兼容性。这个名字是诙谐的；它被称为“**慢速**AES”，因为它不是用 C++ 实现的。但在我的测试中，它并不是非常慢。

它缺乏欧洲央行模式。也缺少 CTR 模式，尽管我猜你可以很容易地在 ECB 模式下构建一个。

它只专注于加密。Anandam提供了一个很好的补充类，它[使用Javascript 执行](http://anandam.name/pbkdf2/)[RFC2898](http://www.ietf.org/rfc/rfc2898.txt)兼容的基于密码的密钥派生。这对库适用于类似的 .NET 类。良好的互操作性。不过，与 SlowAES 相比，Javascript PBKDF2 在生成密钥时明显慢于[Rfc2898DeriveBytes](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rfc2898derivebytes.aspx)类。

从技术上讲，互操作性很好，这并不奇怪，但对我来说，关键是 SlowAES 采用的模型熟悉且易于使用。我发现其他一些用于 AES 的 Javascript 库很难理解和使用。例如，在其中一些中，我找不到设置 IV 或模式（CBC、ECB 等）的位置。事情不是我期望的那样。SlowAES 不是这样的。这些房产正好在我预期的地方。熟悉 Java 和 .NET 加密编程模型后，我很容易上手。

Anandam 的 PBKDF2 还没有达到那个水平。它仅支持对 DeriveBytes 函数的一次调用，因此如果您需要从密码中派生密钥和 IV，则此库将无法正常工作，不变。稍作修改，它就可以正常工作。

**编辑**：我将一个将[SlowAES](http://code.google.com/p/slowaes)和 Anandam 的[PBKDF2](http://anandam.name/pbkdf2/)的修改版本打包到 Windows 脚本组件中[的示例放在一起。](http://cheeso.members.winisp.net/srcview.aspx?dir=AES-example)将此 AES 与密码派生密钥一起使用显示了与 .NET RijndaelManaged 类的良好互操作性。

**EDIT2**：[演示页面](http://cheeso.members.winisp.net/AES-Encryption.htm)显示了如何从网页使用此 AES 加密。使用 .NET 中支持的相同输入（iv、键、模式等）为您提供与 .NET Rijndael 类的良好互操作性。您可以执行“查看源代码”来获取该页面的 javascript。

**EDIT3**
后期添加：[Javascript Cryptography 被认为是有害的。](https://web.archive.org/web/20160323100711/https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2011/august/javascript-cryptography-considered-harmful/)值得一读。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-10-14T16:04:38.963

在我搜索 AES 加密时，我从一些斯坦福大学的学生那里发现了这一点。声称是最快的。支持 CCM、OCB、GCM 和块加密。 [http://crypto.stanford.edu/sjcl/](http://crypto.stanford.edu/sjcl/)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-04-27T14:43:18.230

[谷歌搜索“JavaScript AES”](http://www.google.com/search?q=JavaScript+AES)发现了几个例子。弹出的第一个旨在解释算法并提供解决方案：

[可移动类型脚本：AES](http://www.movable-type.co.uk/scripts/aes.html)

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-02-10T17:13:29.313

这篇文章现在已经过时了，但是[crypto-js](http://code.google.com/p/crypto-js/)可能是现在最完整的 javascript 加密库。

[CryptoJS](http://code.google.com/p/crypto-js/)是用 JavaScript 实现的加密算法的集合。它包括以下密码：AES-128、AES-192、AES-256、DES、Triple DES、Rabbit、RC4、RC4Drop 和散列器：MD5、RIPEMD-160、SHA-1、SHA-256、SHA-512、SHA -3 具有 224、256、384 或 512 位。

您可能想查看他们的[快速入门指南](http://code.google.com/p/crypto-js/#Quick-start_Guide)，这也是以下 node.js 端口的参考。

[node-cryptojs-aes](https://npmjs.org/package/node-cryptojs-aes)是[crypto-js的 node.js 端口](http://code.google.com/p/crypto-js/)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2010-12-16T04:33:20.720

最近我需要在 javascript 和 python 之间执行一些加密/解密互操作性。

具体来说...

1) 使用 AES 在 javascript 中加密和在 python (Google App Engine) 中解密 2) 使用 RSA 在 javascript 中加密和在 python (Google App Engine) 中解密 3) 使用 pycrypto

我发现网上有很多不同版本的 RSA 和 AES，它们的方法各不相同，但我没有找到端到端 javascript 和 python 互操作性的好例子。

经过大量的反复试验，最终我设法拼凑出适合我需要的东西。

无论如何，我敲了一个 js/webapp 与使用 AES 和公钥和私钥 RSA 东西的谷歌应用引擎托管的 python 服务器交谈的例子。

我虽然我会通过链接将它包含在此处，以防它对需要完成相同事情的其他人有所帮助。

[http://www.ipowow.com/files/aesrsademo.tar.gz](http://www.ipowow.com/files/aesrsademo.tar.gz)

并在 rsa-aes-demo DOT appspot DOT com 上查看**演示**

编辑：查看浏览器控制台输出并查看源代码以获取有关**演示中正在发生的事情的一些提示和有用消息**

编辑：更新了非常旧且失效的源链接到现在指向

[https://sestertii.com/files/aesrsademo.tar.gz](https://sestertii.com/files/aesrsademo.tar.gz)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-03-19T21:36:13.630

从我自己的经验来看，[asmcrypto.js](https://github.com/vibornoff/asmcrypto.js)在 JavaScript 中提供了最快的 AES 实现（尤其是在 Firefox 中，因为它可以在那里充分利用 asm.js）。

从自述文件：

> ```
> Chrome/31.0
> SHA256: 51 MiB/s (9 times faster than SJCL and CryptoJS)
> AES-CBC: 47 MiB/s (13 times faster than CryptoJS and 20 times faster than SJCL)
> 
> Firefox/26.0
> SHA256: 144 MiB/s (5 times faster than CryptoJS and 20 times faster than SJCL)
> AES-CBC: 81 MiB/s (3 times faster than CryptoJS and 8 times faster than SJCL) 
> ```

**编辑：** Web [Cryptography API](http://www.w3.org/TR/WebCryptoAPI)现在已[在大多数浏览器中实现，](http://caniuse.com/#search=web%20crypto)如果您关心性能，则应将其用作主要解决方案。请注意，IE11 实现了不使用承诺的标准的早期草案版本。

可以在此处找到一些示例：

*   [GitHub 上的 Web 加密 API 示例](https://github.com/diafygi/webcrypto-examples)
*   [使用 WebCrypto 从密码中获取密钥](http://blog.engelke.com/2015/02/14/deriving-keys-from-passwords-with-webcrypto/)

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2017-01-17T14:05:36.420

使用 CryptoJS

这是代码： [https ://github.com/odedhb/AES-encrypt](https://github.com/odedhb/AES-encrypt)

这是一个在线工作示例： [https ://odedhb.github.io/AES-encrypt/](https://odedhb.github.io/AES-encrypt/)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-03-23T21:07:36.260

试试[asmcrypto.js——](https://github.com/vibornoff/asmcrypto.js)它真的很快。

PS：我是作者，如果有问题我可以回答你。我也很高兴得到一些反馈:)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-04-02T03:46:54.747

如果您尝试使用 javascript 来避免使用 SSL，请三思。有许多中途措施，但**只有**SSL 提供安全通信。Javascript 加密库可以帮助抵御特定的攻击，但不是真正的中间人攻击。

以下文章解释了如何尝试使用 javascript 创建安全通信，以及如何出错： [使用 JavaScript 加密模块而不是 SSL/HTTPS](https://stackoverflow.com/questions/5145147/use-javascript-encryption-module-instead-of-ssl-https/9930665#9930665)

*注意*：如果您正在为自定义域上的谷歌应用引擎寻找 SSL，请查看[wwwizer.com](http://wwwizer.com/)。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-07-04T19:39:11.923

还有一个斯坦福免费库作为 Cryptojs 的替代品

[http://crypto.stanford.edu/sjcl/](http://crypto.stanford.edu/sjcl/)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-04-27T14:43:26.530

[http://www.movable-type.co.uk/scripts/aes.html](http://www.movable-type.co.uk/scripts/aes.html)库可能会有所帮助。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-08-21T14:42:19.897

另一个支持 AES-256 的解决方案：[https ://github.com/digitalbazaar/forge](https://github.com/digitalbazaar/forge)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-10-24T21:14:34.843

这是唯一对我有用的解决方案：

[http://www.hanewin.net/encrypt/aes/aes.htm](http://www.hanewin.net/encrypt/aes/aes.htm)

这是非常基本的，但使用简单，似乎运作良好。

# windows-installer - Javascript MSI 自动化 - 关闭数据库

> ID：793814
> 
> 赞同：1
> 
> 时间：2009-04-27T14:40:21.153
> 
> 标签：windows-installer

我正在维护一些构建脚本，这些脚本可以从 Javascript 文件 (.js) 中处理 MSI 数据库。代码基本上是：

```
{
    var oTargetDB = g_oInstaller.openDatabase("mymsi.msi", msiOpenDatabaseModeReadOnly);
    var oView = oTargetDB.openView(...);
    oView.execute();
    oView.close();
}
// Later...
{
    var oTargetDB = g_oInstaller.openDatabase("mymsi.msi", msiOpenDatabaseModeTransact);
} 
```

第二个 openDatabase 失败并显示有用的 0x80004005 (E_FAIL)，我认为这是因为第一个未关闭。但是，Database 对象没有 close 方法。我试过 oTargetDB=null - 没有改变任何东西。

我可以做些什么来关闭数据库，以便我可以再次打开它？

编辑：

*   我看到使用 sysinternals 中的 handle.exe 打开了句柄，所以这肯定是问题所在
*   延迟没有帮助（我尝试等待很长时间，但没有帮助）
*   由于现有的脚本结构，短期脚本不是一个选项
*   Uber-hacking 超出了此修复的范围
*   我将不得不丑化我的代码并使用（伪单例）解决方案。布莱尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T01:00:54.483

在这种情况下，MS 忘记实现 close 方法。真的。跛脚吧？一般情况下，设置 obj=null 不会执行关闭操作等清理操作。

当我遇到具体的这个问题时，它是从 C# 调用 MSIDatabase 对象。需要关闭数据库（请参阅[MsiOpenDatabase](http://msdn.microsoft.com/en-us/library/aa370338(VS.85).aspx)和[MsiCloseHandle](http://msdn.microsoft.com/en-us/library/aa370067(VS.85).aspx)）。不幸的是，正如您所观察到的，MS 忘记在您看到的 COM 对象中实现[Database.Close](http://msdn.microsoft.com/en-us/library/aa368254(VS.85).aspx)。在 C# 中，我可以调用[Marshal.FinalReleaseComObject](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.finalreleasecomobject.aspx)来解锁文件。

我们最终放弃了不可靠的 COM 对象并切换到 p/invoke。

如果 jscript 是你唯一的选择，你可以让脚本保持短暂的生命——当它们死去时，它们会释放它们的句柄。或者，您创建一个单例来表示该对象。一些超级黑客可能知道如何从 jScript 调用 MsiCloseHandle，并识别该 COM 对象使用的句柄。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T00:03:42.157

将句柄设置为 null 适用于 VB 脚本，所以我不确定为什么它不适用于 JS。我最好的猜测可能是您在 JS 实现中发现了一个错误 - 特别是如果您第一次以只读方式打开它，则无需调用该`Commit`方法来刷新任何更改。

该[文档](http://msdn.microsoft.com/en-us/library/aa369434(VS.85).aspx)似乎表明只需关闭句柄即可关闭数据库。所以我猜即使在设置 oTargetDB=null 之后，当你再次打开它时，Javascript 也没有释放句柄。您可以尝试在释放手柄后插入延迟，看看是否是这种情况。

# php - 在 PHP Web 应用程序中构建时区功能

> ID：793820
> 
> 赞同：3
> 
> 时间：2009-04-27T14:41:19.747
> 
> 标签：php, mysql, timezone

这与这个问题几乎相似：-

[在 PHP 中处理时区](https://stackoverflow.com/questions/346770/dealing-with-timezones-in-php)

我读了那个线程，还有一些问题，不确定如何在 PHP/MySQL 应用程序中优雅地构建时区支持。

我正在用 PHP 编写一个应用程序，用户可以在其中选择他们的时区。

在这里，所有时间戳都存储在 MySQL 中的 GMT 中。在呈现数据时，我正在将时区转换回用户时区。

现在这些是我面临的问题： -

1）我向用户展示了一个从 MySQL 的时区表中填充的时区列表，这是一个巨大的列表，很难从中选择。

所以，我想实现类似windows时区列表的东西。与地区信息的偏移量。

2) PHP 和 MySQL 可能有不同的列表集。

3) 我应该在哪里转换时区，在 PHP 中还是在 MySQL 中？我有编码的组合。有时很容易选择从 MySQL 转换的列，有时很容易在 PHP 中转换。所以，这里前一点变得非常重要。例如，在 MySQL 的 time_zone 表 Asia/Kolkata 和 Asia/Calcutta 中都存在，但在 PHP 5.2.6 的默认 timezonedb 中，只有 Asia/Calcutta 存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T00:55:23.030

当遇到这个确切的问题时，我找到[了这个参考](http://www.unicode.org/cldr/data/docs/design/formatting/zone_log.html#windows_ids)，它将简洁的 Windows 风格的时区列表映射到荒谬详尽的 Unix 风格的时区列表的一个子集。

用户会看到这些窗口样式名称的下拉列表（例如，(GMT-05:00) 东部时间（美国和加拿大）），他们的选择以 unix 样式格式存储在数据库中（例如 America/New_York )

应用用户时区首选项的工作是在 PHP 中使用[DateTime 类](http://www.php.net/manual/en/class.datetime.php)在显示时完成的。我想我会推荐这个，这样您就可以确信您在 SQL/PHP 中操作的日期始终采用 UTC，直到它们显示出来。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T15:09:07.700

1.  从一个大列表中选择一个时区并不难。按标准时间偏移对列表进行排序，以便用户可以快速滚动到正确的偏移，并从那里查找他们的确切位置。

2.  选择一个列表。我倾向于选择较短的列表。仅将这些选择呈现给用户。

3.  计算所选列表的位置。如果您要显示 MySQL 列表，请让 MySQL 进行日期数学运算，如果您使用的是 PHP 列表，请让 PHP 进行数学运算。这将使您无需在一个实现中为缺少的区域找出一些奇怪的映射。

一个奇特的解决方案可能涉及询问用户的位置并推断他们的时区。（但是，也可以选择显式设置它）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T00:01:09.403

在这种情况下，自定义类可能是最佳解决方案。然后，您可以使用其时区移动时间和日期。幸运的是，PHP v5 就内置了这样一个对象。您只需要记住编写代码，以便当您依赖隐式时区时，这是因为您知道您之前已经明确设置了它。这也意味着如果你不知道隐含的价值是什么，你去问，有效地使其明确。

看看 PHP 的时区支持和 MySQL 的时区支持，我会主要在 PHP 中做时区的事情。MySQL 的支持主要围绕它的“现在”概念。

哦，是的：**你*不想*做明确的日期算术**（例如添加 86400 秒来添加“一天”）。让 PHP 对象或库来做这件事。他们将修复您不会想到的错误。（我曾经为一种特殊类型的日期操作编写了一个对象，并花了数周时间与一个间歇性关闭一小时的错误作斗争，直到我发现一个地方添加 86400 来进行一天转换而不是使用`mktime()`. 结果夏令时规则把事情搞砸了。当然，我没有检查。）

# apache-flex - 如何将自定义变量传递给 Flex 应用程序

> ID：793822
> 
> 赞同：1
> 
> 时间：2009-04-27T14:41:23.927
> 
> 标签：apache-flex, flash, actionscript-3, flex3, flashvars

我正在尝试编写一个必须将参数传递给应用程序的应用程序。在 Flex builder 中，我修改了 index.template.html 中的 and 标记，但是在调试时我仍然看不到传递的变量（使用 as3 中的 Application.application.parameters 对象）...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T14:42:26.967

看完一篇文章后，我发现我犯了一个愚蠢的错误。**我在第一个** 安装 Flash Player 的 AC_FL_RunContent() 中添加了“flashvars”、“var1=blah&var2=blah...” 。我的错。一旦我修改了 index.template.html 以将“flashVars”添加到第二个 AC_FL_RunContent()，它就像一个魅力。

# sql-server - 如何使用查询从链接服务器获取数据

> ID：793827
> 
> 赞同：8
> 
> 时间：2009-04-27T14:42:30.027
> 
> 标签：sql-server, sql-server-2005

我创建了一个`linkedserver`as `ravikiran-vm`，它是我桌面上的虚拟机。

现在我有一个名为的数据库`kiran`，其中包含一个`employ`表。
要检索`employ`数据，我执行以下操作：

```
select * from ravikiran-vm.kiran.employ 
```

但它显示错误“'-'附近的语法不正确。”

任何人都可以帮助我吗？

提前致谢。

谢谢你们的支持，它工作正常......现在我必须把它安排为一项新工作。当我正常执行它时，它会显示 o/p。但是当我使用与 sqlserver 代理作业相同的查询时，它会给出错误并且查询不执行......请在这方面帮助我

提前致谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-27T14:43:50.100

我认为您应该更改链接服务器的名称，因为 - 字符在 SQL 中是保留的。

您可以尝试用方括号将名称括起来，但这会变得很无聊

此外，您应该在查询中包含架构名称，或者双点以使用默认名称：

所以，你可以试试：

```
select * from [ravikiran-vm].kiran.dbo.employ
select * from [ravikiran-vm].kiran..employ 
```

或者无论您的架构是什么。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T16:17:46.113

您必须使用[OPENQUERY](http://msdn.microsoft.com/en-us/library/ms188427.aspx)：

```
SELECT * FROM OPENQUERY([ravikiran-vm],'SELECT * FROM KIRAN..EMPLOY') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T14:55:19.620

要从链接服务器获取数据，您使用 4 部分表示法 Server.Database.Schema.Table

由于您的姓名中有无效字符（-），您需要在姓名周围添加括号

```
select * from [ravikiran-vm].kiran..employ 
```

您可能也不希望返回所有数据

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-02T14:54:17.330

通常在链接服务器的情况下不应该使用直接查询，因为它大量使用 SQL 服务器的临时数据库。第一步，将数据检索到临时数据库中，然后进行过滤。关于这个有很多线程。最好使用 open **OPENQUERY**，因为它将 SQL 传递给源链接服务器，然后返回过滤结果，例如

SELECT * FROM OPENQUERY(Linked_Server_Name , 'select * from TableName where ID = 500')

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-24T18:29:38.220

```
Select * from likedservername.databasename.dbo(schema).tablename 
```

例1：

```
select * from [Bse].[Bse].[dbo].Binary

Else

Select * from openquery (linkedservername, 'select * from databasename.dbo(schema).tablename'); 
```

例 2：

```
select * from openquery ([Bse], 'select * from [Bse].[dbo].Binary'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-31T12:00:49.740

```
1- Link the server

EXEC sp_addlinkedserver 'OracleSvr', 
'Oracle 7.3', 
'MSDAORA', 
'ORCLDB'

2-SELECT
SELECT *
FROM OPENQUERY(OracleSvr, 'SELECT name, id FROM albert.titles')

3-UPDATE 
UPDATE OPENQUERY (OracleSvr, 'SELECT name FROM albert.titles WHERE id = 101') 

4-INSERT
INSERT OPENQUERY (OracleSvr, 'SELECT name FROM albert.titles')
VALUES ('NewTitle');

5-DELETE
DELETE OPENQUERY (OracleSvr, 'SELECT name FROM albert.titles WHERE name = ''NewTitle''') 
```

我刚刚从这里复制（[http://www.sqlservercentral.com/Forums/Topic916320-392-1.aspx](http://www.sqlservercentral.com/Forums/Topic916320-392-1.aspx)）

# sharepoint - 如何在 sharepoint 中向 schema.xml 添加视图

> ID：793841
> 
> 赞同：5
> 
> 时间：2009-04-27T14:44:24.013
> 
> 标签：sharepoint

我正在尝试将视图添加到自定义列表。目标是 MOSS 2007，我正在使用带有 VSeWSS 1.3 的 VS2008。该功能已经有一个自定义列表定义，包括一个名为“日历”的自定义视图。开始时，我想我会创建另一个名为 NewCalendar 的视图，它只是现有自定义视图 Calendar 的副本。

因此，我将 Calendar.aspx 复制到 NewCalendar.aspx，复制当前日历的现有“视图”节点并粘贴一个新节点，然后更改新节点的以下属性：DisplayName、Url 和 DefaultView。

当我刷新 WSP 视图时，会出现 NewCalendar.aspx。当我部署并转到 NewCalendar.aspx 时，我得到一个 404。使用 SharePoint Manager 我确认该页面不存在。

如何通过功能添加自定义视图，使其显示在“视图”下拉列表中？

更新：如果我创建自定义列表的新实例，它会起作用。如何让自定义视图显示在现有列表中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T00:07:03.967

不幸的是，功能通常不具有追溯性。您不能更新功能并期望从该功能创建的所有现有项目都得到更新。我认为这是设计使然。如果这是可能的，它可能会产生深远的（意想不到的）后果。

在这些 senario 中，我在发布新功能时编写了一个改造脚本。

# python - SQLAlchemy - MappedCollection 问题

> ID：793848
> 
> 赞同：3
> 
> 时间：2009-04-27T14:46:10.407
> 
> 标签：python, sqlalchemy

我在 Python 的 SQLAlchemy 中设置字典集合时遇到了一些问题：

我正在使用表的声明性定义。我的`Item`表与表的关系为 1：N `Record`。我使用以下代码设置关系：

```
_Base = declarative_base()

class Record(_Base):
    __tablename__ = 'records'

    item_id = Column(String(M_ITEM_ID), ForeignKey('items.id'))
    id = Column(String(M_RECORD_ID), primary_key=True)
    uri = Column(String(M_RECORD_URI))
    name = Column(String(M_RECORD_NAME))

class Item(_Base):
    __tablename__ = 'items'

    id = Column(String(M_ITEM_ID), primary_key=True)

    records = relation(Record, collection_class=column_mapped_collection(Record.name), backref='item') 
```

现在我想使用`Item`s 和`Record`s。让我们创建一些对象：

```
i1 = Item(id='id1')
r = Record(id='mujrecord') 
```

现在我想使用以下代码关联这些对象：

```
i1.records['source_wav'] = r 
```

但`Record r`没有设置`name`属性（外键）。有什么解决方案如何自动确保这一点？（我知道在`Record`创建过程中设置外键是可行的，但这对我来说并不好）。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T19:58:56.657

你想要这样的东西：

```
from sqlalchemy.orm import validates

class Item(_Base):
    [...]

    @validates('records')
    def validate_record(self, key, record):
      assert record.name is not None, "Record fails validation, must have a name"
      return record 
```

这样，您将获得所需的验证：

```
>>> i1 = Item(id='id1')
>>> r = Record(id='mujrecord')
>>> i1.records['source_wav'] = r
Traceback (most recent call last):
  [...]
AssertionError: Record fails validation, must have a name
>>> r.name = 'foo'
>>> i1.records['source_wav'] = r
>>> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T20:15:07.963

我还不能发表评论，所以我只想把它写成一个单独的答案：

```
从 sqlalchemy.orm 导入验证

类项目（_Base）：
    [...]

    @validates('记录')
    def validate_record(self, key, record):
      记录名称=键
      退货记录

```

这基本上是 Gunnlaugur 答案的副本，但滥用 validates 装饰器来做一些比爆炸更有用的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T20:29:12.463

你有：

```
backref='item' 
```

这是一个错字吗

```
backref='name' 
```

?

# c# - 如何防止异常在 C# 中冒泡？

> ID：793849
> 
> 赞同：1
> 
> 时间：2009-04-27T14:46:13.590
> 
> 标签：c#, exception, visual-studio-2005, exception-handling

如果我正在编写一个类库，并且在该库中的某个时刻我有代码来捕获异常并处理它，那么我不希望任何使用我的库的人知道它甚至发生了——它应该是不可见的外面的世界。

但是，如果他们在 Visual Studio 中打开了“捕获抛出的异常”（而不是“捕获用户未处理的异常”），那么异常*将对*他们可见。

有没有办法避免这种情况？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T14:51:44.573

不，这是设计使然：作为开发人员，我在“Catch Thrown Exceptions”打开的情况下运行，这样我就可以看到库代码中抛出的异常（并希望避免它们）。您所处的情况同样适用于 .NET 框架自己的库。

最好的方法是首先避免抛出异常。作为附带的好处，您的库代码会更快，因为抛出异常会对性能产生显着影响（并且应该只在“异常”情况下使用）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T15:15:25.500

实现此目的的唯一方法是在可能引发异常的方法上放置[[DebuggerHidden]属性。](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerhiddenattribute.aspx)就像其他人指出的那样，最好完全避免异常，但是这个属性会完成你想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T14:52:18.957

你无法阻止这一点。总有人可以将调试器附加到进程并监视正在发生的事情。

您可以删除异常并自己提供错误处理，但我真的不建议这样做，因为它是某种重新发明轮子 - 重新创建异常处理系统。

当然，仅当代码抛出和捕获异常的代码相距甚远且完全不相关时，上述内容才适用。如果它们紧密耦合，您应该真正检查调用是否可以成功，并且只在这种情况下调用。永远记住，异常是针对特殊情况的——不是针对正常控制流，您可以在其中检查操作是否成功

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T15:20:57.467

正如[Tim Robinson](https://stackoverflow.com/questions/134698/catching-exceptions-as-expected-program-execution-flow-control)所说，没有办法控制查看从您的库中抛出的异常的人。他的回答很好，我就不重复了。

这里有几篇关于 SO 的帖子，在使用异常作为程序流控制来解决（听起来像什么）时，您可能会发现它们很有帮助：

[捕获异常作为预期的程序执行流控制？](https://stackoverflow.com/questions/134698/catching-exceptions-as-expected-program-execution-flow-control)
[为什么.Net 程序员如此害怕异常？](https://stackoverflow.com/questions/351400/why-are-net-programmers-so-afraid-of-exceptions)

# c# - “Hello World”——TDD 方式？

> ID：793850
> 
> 赞同：15
> 
> 时间：2009-04-27T14:46:28.440
> 
> 标签：c#, unit-testing, tdd, nunit

好吧，自从我被介绍到 TDD 以来，我一直在考虑这个问题。哪种方法是构建“Hello World”应用程序的最佳方式？这将在控制台上打印“Hello World” - 使用测试驱动开发。

我的测试会是什么样子？和周围什么班？

**要求：**没有“*类似维基百科*”的链接指向什么是 TDD，我熟悉 TDD。只是好奇如何解决这个问题。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-27T14:58:31.033

您需要将控制台隐藏在界面后面。（无论如何这可以被认为是有用的）

**编写测试**

```
[TestMethod]
public void HelloWorld_WritesHelloWorldToConsole()
{
  // Arrange
  IConsole consoleMock = MockRepository.CreateMock<IConsole>();

  // primitive injection of the console
  Program.Console = consoleMock;

  // Act
  Program.HelloWorld();

  // Assert
  consoleMock.AssertWasCalled(x => x.WriteLine("Hello World"));
} 
```

**编写程序**

```
public static class Program
{
  public static IConsole Console { get; set; }

  // method that does the "logic"
  public static void HelloWorld()
  {
    Console.WriteLine("Hello World");
  }

  // setup real environment
  public static void Main()
  {
    Console = new RealConsoleImplementation();
    HelloWorld();
  }
} 
```

**重构**为更有用的东西;-)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T14:51:39.893

嗯...我还没有看到 hello world 的 TDD 版本。但是，要查看考虑到 TDD 和可管理性的类似简单问题，您可以查看[Enterprise FizzBu​​zz](http://wolfbyte-net.blogspot.com/2007/09/if-something-is-worth-doing.html)（[代码](http://code.google.com/p/fizzbuzz/)）。至少这会让你看到你在一个 hello world 中可能达到的过度设计水平。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-27T14:51:49.597

演示者视图？（模型似乎不是绝对必要的）

View 是一个将输出传递到控制台的类（简单的单行方法）

Presenter 是调用 view.ShowText("Hello World") 的接口，你可以通过提供一个存根视图来测试它。

不过，为了提高生产力，我只会编写该死的程序 :)

一个测试就足够了（在伪代码中）：

```
IView view = Stub<IView>();
Expect( view.ShowText("Hello World") );

Presenter p = new Presenter( view );
p.Show();

Assert.IsTrue( view.MethodsCalled ); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-27T14:56:32.083

伪代码：

*   创建一个接受流的东西的模拟。
*   通过某种依赖注入（如构造函数参数）将 helloworld 调用到这个模拟上。
*   验证“Hello World”字符串是否已流式传输到您的模拟中。

在生产代码中，您使用提示而不是模拟。

经验法则：

*   定义组件如何与其他东西交互的成功标准，而不仅仅是它如何与你交互。TDD 侧重于外部行为。
*   设置环境（模拟）来处理事件链。
*   运行。
*   核实。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-27T15:01:13.053

一个非常有趣的问题。我不是一个巨大的 TDD 用户，但我会抛出一些想法。

我假设您要测试的应用程序是这样的：

```
public static void Main()
{
    Console.WriteLine("Hello World");
} 
```

现在，由于我想不出任何直接测试它的好方法，我会将编写任务分解为一个界面。

```
public interface IOutputWriter
{
    void WriteLine(string line);
}

public class ConsoleWriter : IOutputWriter
{
    public void WriteLine(string line)
    {
        Console.WriteLine(line);
    }
} 
```

并像这样分解应用程序

```
public static void Main()
{
    IOutputWriter consoleOut = new ConsoleWriter();
    WriteHelloWorldToOutput(consoleOut);
}

public static void WriteHelloWorldToOutput(IOutputWriter output)
{
    output.WriteLine("Hello World");
} 
```

现在您有一个方法的注入点，允许您使用您选择的模拟框架来断言 WriteLine 方法是使用“Hello World”参数调用的。

我没有解决的问题（我对输入感兴趣）：

1.  如何测试 ConsoleWriter 类，我想你仍然需要一些 UI 测试框架来实现这一点，如果你有这个，那么整个问题无论如何都没有实际意义......

2.  测试主要方法。

3.  为什么我觉得通过将一行未经测试的代码更改为七行代码，我已经取得了一些成就，而其中只有一行经过实际测试（尽管我猜覆盖率*已经*上升）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-03-01T17:03:38.740

假设您了解单元测试，并假设您了解 tdd“红绿重构过程”（因为您说您熟悉 TDD）我将快速解释一个典型的 tdd 思维过程。

如果您考虑一个特定的问题单元并且所有其他相关的事物都应该根据依赖关系来考虑，那么您的 TDD 生活将会变得更加轻松。这是一个样本

场景：- 我希望我的程序在控制台上显示 hello world。

tdd 思考过程：-

“我认为我的程序将开始运行，然后调用控制台程序将我的消息传递给它，然后我希望我的控制台程序将其显示在屏幕上”

“所以我需要测试当我运行我的程序时，它应该调用控制台程序”

“现在有什么依赖关系？嗯，我知道控制台程序就是其中之一。我不需要担心控制台如何将消息发送到屏幕（调用 io 设备、打印等等）我只是需要知道我的程序成功调用了控制台程序。我需要相信控制台程序可以正常工作，如果没有，那么目前我不负责测试并确保它正常工作。我要测试的责任是我的程序在启动时调用了控制台程序。”

“但我什至不确切知道要调用什么控制台程序。我知道 System.console.Writeline （具体实现），但是由于需求的变化，这可能会在未来发生变化，那我该怎么办？”

“好吧，我将依赖于接口（或抽象）而不是具体的实现，然后我可以创建一个假控制台来实现我可以测试的接口”

```
 public interface Iconsole
    {
       void WriteToConsole(string msg);
    }

 public class FakeConsole : Iconsole
    {
        public bool IsCalled = false;

        public void WriteToConsole(string msg)
        {
            IsCalled = true;
        }
    } 
```

我已经放置了 IsCalled 成员，如果调用控制台程序，其“状态”将会改变

好的，我知道这听起来像是一个漫长的思考过程，但它确实得到了回报。Tdd 迫使您在编码之前思考，这比在思考之前编码更好

在一天结束时，您可能会想出类似以下方法来调用您的程序：

```
var console = new FakeConsole();
    console.IsCalled = false;
    my_program program = new my_program(console);
    program.greet(); 
```

我将控制台传递给 my_program 以便 my_program 将使用控制台将我们的消息写入屏幕。

我的 my_program 可能如下所示：

```
public class my_program
    {

        Iconsole _consol;
        public my_program(Iconsole consol)
        {
            if (consol != null)
                _consol = consol;
        }
        public void greet()
        {
            _consol.WriteToConsole("Hello world");
        }
    } 
```

最终的单元测试将是：-

```
 [TestMethod]
        public void myProgramShouldDisplayHelloWorldToTheConsole()
        {
            //arrange

            var console = new FakeConsole();
            console.IsCalled = false;
            my_program program = new my_program(console);
           //act
            program.greet();

            //assert
            Assert.AreEqual(true, console.IsCalled, " console was not called to display the greeting");

        } 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-27T14:52:52.090

在 java 中，您可以捕获（“重定向”） System.out 流并读取其内容。我确信在 C# 中也可以做到这一点。在java中只有几行代码，所以我相信在C#中不会更多

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-27T15:19:37.470

我真的不得不反对这个问题！所有的方法都有自己的位置，TDD 在很多地方都很好。但用户界面是我真正远离 TDD 的第一个地方。在我看来，这是 MVC 设计模式的最佳理由之一：以编程方式测试您的模型和控制器；目视检查您的视图。您正在谈论的是对数据“Hello World”进行硬编码并测试它是否进入控制台。要使用相同的源语言进行此测试，您几乎必须模拟控制台对象，*它是唯一可以做任何事情的对象*。

或者，您可以在 bash 中编写测试脚本：

```
echo `java HelloWorldProgram`|grep -c "^Hello World$" 
```

添加到 JUnit 测试套件中有点困难，但有些事情告诉我这从来都不是计划......

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-07T19:49:08.710

我同意大卫·伯杰的观点；分离接口，测试模型。在这种情况下，“模型”似乎是一个返回“Hello，world！”的简单类。测试看起来像这样（在 Java 中）：

```
 Greeter greeter = new Greeter();
  assertEquals("Hello World!", greeter.greet()); 
```

我在[http://ziroby.wordpress.com/2010/04/18/tdd_hello_world/](http://ziroby.wordpress.com/2010/04/18/tdd_hello_world/)`Hello World`上写了一篇关于解决TDD 风格的文章。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-27T14:48:58.263

我猜是这样的：

```
using NUnit.Framework;
using System.Diagnostics;

[TestFixture]
public class MyTestClass {
    [Test]
    public void SayHello() {
        string greet = "Hello World!";
        Debug.WriteLine(greet);
        Assert.AreEqual("Hello World!", greet);
    }
} 
```

# asp.net - 如何将 XML 作为字符串从 XmlTextReader 输出到 Response.Write？

> ID：793852
> 
> 赞同：8
> 
> 时间：2009-04-27T14:47:00.640
> 
> 标签：asp.net, xmltextreader

我已经从 API 中检索了一些 XML（至少我认为是这样，服务器响应是“OK”）但是我将响应流放入 XmlTextReader，如何将此 XML 输出为字符串？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-27T14:50:31.923

您可以尝试[XmlTextReader.ReadOuterXml()。](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.readouterxml.aspx)

# shell - 仅当目录尚不存在时如何 mkdir？

> ID：793858
> 
> 赞同：2485
> 
> 时间：2009-04-27T14:47:44.957
> 
> 标签：shell, scripting, ksh, aix, mkdir

我正在编写一个在 AIX 上的 KornShell (ksh) 下运行的 shell 脚本。我想使用该`mkdir`命令创建一个目录。但是该目录可能已经存在，在这种情况下我不想做任何事情。因此，我想测试该目录是否不存在，或者抑制`mkdir`尝试创建现有目录时抛出的“文件存在”错误。

我怎样才能最好地做到这一点？

* * *

## 回答 #1

> 赞同：4084
> 
> 时间：2009-04-27T14:49:46.437

尝试[`mkdir -p`](http://pubs.opengroup.org/onlinepubs/009695399/utilities/mkdir.html)：

```
mkdir -p foo 
```

请注意，这也会创建任何不存在的中间目录；例如，

```
mkdir -p foo/bar/baz 
```

将创建目录`foo`, `foo/bar`,`foo/bar/baz`如果它们不存在。

像 GNU 这样的一些实现`mkdir`包括`mkdir --parents`一个更易读的别名，但这在 POSIX/Single Unix 规范中没有指定，并且在许多常见平台上不可用，如 macOS、各种 BSD 和各种商业 Unix，因此应该避免使用。

如果想在父目录不存在的时候报错，如果不存在想创建目录，那么可以[`test`](http://www.opengroup.org/onlinepubs/009695399/utilities/test.html)先判断目录是否存在：

```
[ -d foo ] || mkdir foo 
```

* * *

## 回答 #2

> 赞同：217
> 
> 时间：2009-04-27T14:50:40.770

这应该有效：

```
$ mkdir -p dir 
```

或者：

```
if [[ ! -e $dir ]]; then
    mkdir $dir
elif [[ ! -d $dir ]]; then
    echo "$dir already exists but is not a directory" 1>&2
fi 
```

如果目录不存在，它将创建该目录，但如果您尝试创建的目录的名称已被目录以外的其他对象使用，则会警告您。

* * *

## 回答 #3

> 赞同：105
> 
> 时间：2009-04-27T14:50:09.103

使用 -p 标志。

```
man mkdir
mkdir -p foo 
```

* * *

## 回答 #4

> 赞同：83
> 
> 时间：2013-08-21T20:08:57.050

使用一个命令定义复杂的目录树

```
mkdir -p project/{lib/ext,bin,src,doc/{html,info,pdf},demo/stat/a} 
```

* * *

## 回答 #5

> 赞同：49
> 
> 时间：2015-03-27T03:57:44.200

如果您不想显示任何错误消息：

```
[ -d newdir ] || mkdir newdir 
```

如果你想显示你自己的错误信息：

```
[ -d newdir ] && echo "Directory Exists" || mkdir newdir 
```

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2009-04-27T15:00:50.370

旧的尝试和真实

```
mkdir /tmp/qq >/dev/null 2>&1 
```

将在许多其他解决方案都没有的竞争条件下做你想做的事。

有时最简单（也是最丑陋）的解决方案是最好的。

* * *

## 回答 #7

> 赞同：26
> 
> 时间：2014-01-20T12:23:42.743

`mkdir foo`即使目录存在也可以工作。要使其仅在名为“foo”的目录不存在时才起作用，请尝试使用该`-p`标志。

例子：

```
mkdir -p foo 
```

只有当它不存在时，才会创建名为“foo”的目录。:)

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2018-08-21T04:56:21.290

您可以使用`if`语句来检查目录是否存在。如果它不退出，则创建目录。

1.  dir=/home/dir_name

    ```
    if [ ! -d $dir ]
    then
         mkdir $dir
    else
         echo "Directory exists"
    fi 
    ```

2.  您可以使用带有 -p 选项的 mkdir 来创建目录。它将检查目录是否不可用。

    ```
    mkdir -p $dir 
    ```

    mkdir -p 还允许创建目录的树结构。如果要使用相同的命令创建父目录和子目录，可以选择 mkdir -p

    ```
    mkdir -p /home/parent_dir /home/parent_dir/child1 /home/parent_dir/child2 
    ```

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2016-11-22T12:39:41.660

mkdir 在 Windows 8+ 系统上不再支持 -p 开关。

你可以使用这个：

```
IF NOT EXIST dir_name MKDIR dir_name 
```

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2015-12-16T11:34:59.323

```
directory_name = "foo"

if [ -d $directory_name ]
then
    echo "Directory already exists"
else
    mkdir $directory_name
fi 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2009-04-27T14:51:20.910

或者，如果您想先检查是否存在：

```
if [[ ! -e /path/to/newdir ]]; then
            mkdir /path/to/newdir
fi 
```

**-e**是[KornShell](https://en.wikipedia.org/wiki/KornShell)的存在测试。

您也可以尝试使用谷歌搜索 KornShell 手册。

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2018-02-14T18:54:02.507

这是一个简单的函数（Bash shell），如果它不存在，它可以让您创建一个目录。

```
#------------------------------------------#
# Create a directory if it does not exist. #
#------------------------------------------#
# Note the "-p" option in the mkdir        #
# command which creates directories        #
# recursively.                             #
#------------------------------------------#
createDirectory() {
   mkdir -p -- "$1"
} 
```

您可以将上述函数调用为：

> createDirectory "$(mktemp -d dir-example.XXXXX)/fooDir/BarDir"

如果 fooDir 和 BarDir 不存在，则以上创建它们。注意 mkdir 命令中的“-p”选项，它递归地创建目录。

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2019-01-21T23:46:57.730

参考手册页`man mkdir`的选项 -`p`

```
 -p, --parents
          no error if existing, make parent directories as needed 
```

它将在给定路径中创建所有目录，如果存在则不会引发错误，否则它将在给定路径中从左到右创建所有目录。试试下面的命令。目录`newdir`并且`anotherdir`在发出此命令之前不存在

**正确使用**

`mkdir -p /tmp/newdir/anotherdir`

执行命令后可以在/tmp下看到`newdir`并创建。`anotherdir`您可以根据需要多次发出此命令，该命令始终具有`exit(0)`. 由于这个原因，大多数人在使用这些实际路径之前在 shell 脚本中使用此命令。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2020-12-15T16:57:37.053

简单、沉默和致命：

```
mkdir -p /my/new/dir >/dev/null 2>&1 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2018-04-20T09:30:55.573

```
mkdir -p sam 
```

*   mkdir = 创建目录
*   -p = --父母
*   （如果存在则没有错误，根据需要创建父目录）

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2020-03-15T20:37:56.453

```
if [ !-d $dirName ];then
     if ! mkdir $dirName; then  # Shorter version. Shell will complain if you put braces here though
     echo "Can't make dir: $dirName"
     fi
fi 
```

# javascript - 自动滑块/滚动器显示动态内容

> ID：793861
> 
> 赞同：2
> 
> 时间：2009-04-27T14:48:52.927
> 
> 标签：javascript, jquery

谁能告诉我如何在我的网页中实现自动滑块/滚动条。滑块应显示来自数据库的动态数据。（例如：plipl.com 网站主页 (www.plipl.com) 中的热门工作选项卡。有没有使用 jQuery 的简单方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T15:00:39.093

是的。这很简单。从数据库中获取数据。可以说它是 HotJob 对象的列表，每个对象都包含一些字符串字段。将每个对象转换为 JSON 对象（这是一个哈希）。列出这些 JSON 对象。使用您的 Web 框架 X 打印出 JSON。

使用 jquery 的 getJSON 来获取 JSON 对象。遍历每个 HotJob 并写出信息。

谷歌搜索“jquery json scroller”并找到开箱即用的支持 JSON 的东西。这样做： [http](http://www.logicbox.net/jquery/simplyscroll/flickr.html) ://www.logicbox.net/jquery/simplyscroll/flickr.html 当然，它的图像，但您可以修改它以支持文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T15:07:40.340

[jCarousel](http://sorgalla.com/projects/jcarousel/)是一个支持动态内容的 jQuery 轮播插件。尽管他的网站上没有 JSON 驱动的示例，但使用 jQuery 的默认 AJAX 功能很容易实现。

这是迄今为止我为 jQuery 找到的最强大和可定制的轮播。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T19:20:49.420

以下没什么特别的，赶紧试了一下。有 2 个 div 可以在它之间不断切换，希望能给你一个良好的开端。您可以使用相同的想法并通过 AJAX 将内容加载到 div 中。

代码片段：

CSS：

```
div{width:100px;height:100px;}
#container{overflow:hidden;border:1px solid black;}
#left{background:red;float:left;}
#right{background:green;float:right;} 
```

脚本：

```
$(function() {
        //Call scrollContent function every 3secs
    var timerUp = setInterval(scrollContent, 3000);

    function scrollContent(){
        //Toggle top between 100 and 0
        var top = $("#container").scrollTop() == 0 ? 100 : 0;
        $("#container").scrollTop(top);
    }
}); 
```

标记：

```
<div id="container">
        <div id="left">
            <ul>
                <li>One</li>
                <li>Two</li>
                <li>Three</li>
                <li>Four</li>
            </ul>
        </div>
        <div id="right">
            <ul>
                <li>Five</li>
                <li>Six</li>
                <li>Seven</li>
                <li>Eight</li>
            </ul>
        </div>
    </div> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T15:42:59.660

或者，如果您不想使用插件，您可以使用 jQuery 的 AJAX 功能来加载数据，有一个带有 overflow:hidden 的 div 并用加载的数据填充它，一次只显示一个部分。

然后，您可以使用[setInterval()](http://www.elated.com/articles/javascript-timers-with-settimeout-and-setinterval/)函数更改 $("#container").scrollTop(xx) 以按设定的时间间隔将下一组信息移动到视图中。你可以滚动它或让它突然弹出，这取决于你，但使用 jQuery 相当容易。

# java - 更快的 javac/ant？

> ID：793882
> 
> 赞同：6
> 
> 时间：2009-04-27T14:53:07.723
> 
> 标签：java, ant, time, build, javac

我发现 java 对我来说几乎是立即启动并运行 - 但 javac 需要几秒钟，而 ant 又让它变慢了。只有几秒钟，但没有它我的编辑-编译-测试循环会更顺畅。:-)

顺便说一句：我已经在 ant 中使用过 vim 的 ":make"。

有没有办法加快 javac 和/或 ant 的速度？我正在考虑特殊的开关或技巧？或者也许是一个替代的java编译器（我在linux中使用1.6）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T15:00:17.050

[Eclipse](http://www.eclipse.org/)会为您做到这一点……但对于您的问题，它可能有点大。

除此之外，您可以推出自己的编译器插件。有两种方法：

1.  从 ant 中运行 java 编译器（而不是创建一个新进程）。不确定蚂蚁是否已经这样做了；如果没有，那将为您节省一些时间。有关详细信息，请查看[Java 6 编译器 API](http://java.sun.com/javase/6/docs/technotes/guides/javac/index.html)。

2.  在侦听套接字上的选项的服务器进程中运行 javac。在 ant 中，向进程发送命令行并等待输出返回。节省您始终启动新流程的时间。

3.  尝试使用eclipse编译器。与最初的 javac 不同，Eclipse 编译器非常擅长“忽略”错误，因此即使它们包含错误，它也可以生成类文件。这似乎意义不大，但它允许您一直在后台编译。当您进行最后一次保存（包装所有内容）时，编译器将能够编译*其他所有内容*，并且只需要查看一个文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T06:24:23.320

谷歌找到了这两个（我还没有尝试过）

1.  `javac` [`-J-client -J-Xms100m -J-Xmx100m`](http://blogs.oracle.com/ahe/entry/javac_performance_problems) `<src>`

2.  [JBrownie](http://www.onyxbits.de/jbrownie)按照 Aaron Digulla 的 (2) 的思路“监控 Java 源代码并自动重新编译任何发现更改的文件”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T15:21:59.027

我强烈建议使用适合 Java 的 IDE，因为使用了解您的程序的编辑器可以极大地提高生产力。想想“转到包含光标所在变量/类/字段定义的行”，“重命名这个类和对它的所有引用”，以及所有其他类型的好东西。如果您对调用 Java 所花费的时间感到恼火，那么您可能已经准备好了 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T15:00:32.727

你可能想看看[JavaRebel](http://www.zeroturnaround.com/javarebel/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T09:01:28.510

我将我的所有输出文件指向我使用[此实用程序](http://support.microsoft.com/kb/257405)创建的 ramdisk 。它加快了构建速度（尽管没有达到神奇的程度），因为几乎所有内容都在内存中。当进行几乎即时的“干净”构建时，这一点最为明显。

# asp.net - GridView.PageIndexChanging 触发，但没有 SelectedIndex 受到影响！

> ID：793883
> 
> 赞同：1
> 
> 时间：2009-04-27T14:53:15.880
> 
> 标签：asp.net, ajax, gridview

对于同一个问题，我有两个不同的实现。

与一些数据绑定的网格视图，它有一个带有按钮的选择列。当按钮单击被触发时，我在调试中知道 : sender.SelectedDataKey 和 sender.SelectedIndex 具有我稍后使用的值。

但现在我想使用 ajax 手风琴控件。我有一个手风琴，里面有一个窗格。在该窗格内，我有一个 CollapsiblePanel（使用 CollapsiblePanelExtender）。在那个 CollapsiblePanel 中，我有我的 Gridview。因此，只有当我单击 collapsiblePanel 时，我才想从 DB 获取数据并将其绑定到 GridView。但似乎使用这种方法，当 PageIndexChanging 触发时 sender.SelectedDataKey 和 sender.SelectedIndex 什么都没有（VB）！这没有任何意义！

GridView 是两个实现中的一些，并且 EnableViewState=true

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T21:43:36.343

由于 Accordion Panel 是一个 Ajax 控件，即使您没有在页面中添加更新面板，它也可能会在其中添加更新面板。由于 GridView 位于 Ajax 控件内部，因此由 GridView 触发的所有事件都将被 Ajax 捕获。您也可以尝试让 GridView 按钮单击 Ajax 回调。

我在 Ajax 更新面板或 Ajax 控件内部的控件之前遇到过这个问题；例如 Accordion Panel，触发服务器端事件处理程序，但由于涉及 Ajax，值被卡在客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T14:57:07.417

确保您的控件在同一个 UpdatePanel 中，或者更新各个容器的 UpdatePanel。

# objective-c - 可可，在 QTMovieView 上覆盖 NSWindow 时闪烁动画

> ID：793884
> 
> 赞同：1
> 
> 时间：2009-04-27T14:53:58.483
> 
> 标签：objective-c, cocoa, core-animation

在我目前正在处理的一个项目中，我有一个透明的 NSWindow 覆盖在 QTMovieView 上。在某些时候，我将一个自定义视图滑入这个带有动​​画的子窗口，以便它在电影上显示一小段时间。唯一奇怪的行为是动画在 Mac Book Pro 上很流畅，但在 Mac Book（相同的 OS-X 版本）上却有明显的闪烁。闪烁仅发生在窗口后面有实际 QTMovie 的部分上。

有没有人见过这种行为或找到解决它的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T15:38:55.240

较旧的 MacBook 没有真正的视频硬件并使用共享内存，因此尝试更新 @ 30fps 的速度较慢的视频卡可能是个问题。您是否尝试过较小的电影以查看问题是否消失？

使用 Apple 的 QTCoreVideo101 示例代码中的管道可能会更好。那将是更多的工作，您必须自己处理动画，但您将最终控制正在绘制的内容。

# ruby - 学什么版本的Ruby？

> ID：793885
> 
> 赞同：2
> 
> 时间：2009-04-27T14:54:16.893
> 
> 标签：ruby

我想学习 Ruby 有一段时间了，甚至开始学习一点。然后我分心了，出于某种原因，我选择了 Python。然而，我现在决定，即使我目前的项目是使用 Python，我也将学习 Ruby 和 Ruby on Rails。

如果有人问我要从哪个版本的 Python 开始，我建议使用 2.6，因为 3 破坏了与他们会搜索的所有教程的兼容性。对Ruby知之甚少，我应该在我的电脑上安装什么版本？任何两个版本等之间是否有重大区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T20:11:19.237

你学的版本不是那么重要。

虽然最终会从更稳定的 1.8.x 系列转变，但 1.9 并不会以一种让您处于不利地位的方式打破游戏规则。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T15:00:10.373

Rails 推荐 1.8.7 版本，所以如果你要学习 Rails，我会坚持下去。这[本书](http://www.pragprog.com/titles/ruby/programming-ruby)还不错。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T15:13:37.640

我不认为 Ruby 有那么多重大变化——除了 1.9 以后。所以 1.8.x 中的任何版本都应该没问题.. 选择最新的稳定版本。
另一方面，Rails 在 Rails 2 中发生了巨大变化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T20:07:24.067

如果您要在 Windows 中工作，请使用当前最稳定的一键式安装程序。在撰写本文时，这可能仍然是 1.8.6-26，尽管 1.8.6-27 迫在眉睫。1.8.7是一个小增量，我很不确定1.9.1在平台上的状态。

在 OSX 或其他 *nix 变体上，我准备更大胆一些：当前的 Rails 生产版本 (2.3.2) 应该与 1.9.1 兼容（尽管并非所有第三方都如此图书馆一段时间）和学习可能会更有趣的最新版本。它也应该运行良好但速度更快。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-27T21:52:26.403

Ruby 1.9 做了一些重大更改，但不像 Python 3。任何旧的 Ruby 教程都应该适用于 1.9。例如，没有什么比 Python 更改和`print`合并`range()`.`xrange()`

它真的没有那么大的区别。核心语言没有太大变化——1.9 只是快了很多，并且获得了一些新特性。

有一些更改破坏了一些库，但这些更改更多地与更精细的实现细节有关，而不是您在基本教程中学到的东西，所以它不应该伤害您。如果您想使用 1.8 以获得更好的库支持，那很好。如果您想使用 1.9 以获得更好的核心功能，那也很好。当你刚开始时，这并没有太大的区别。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T16:12:29.573

如果您打算构建不向公众发布的东西，那么会使用很多库，1.8.7 或 1.8.6。如果您正在编写*将向*公众发布的库，请确保它们在 Ruby 1.9 中工作。Ruby 1.9 是一个优秀的解释器，但我们坚持使用 1.8.x，因为现在有很多库与它不兼容。

[http://isitruby19.com/](http://isitruby19.com/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-22T18:19:49.377

了解最新版本。当前最新版本是 2.4。但是当更高版本出来时，请立即购买。Ruby 团队注意只发布完成的工作，你不必害怕安装最新的。

# c# - 无法使用 Assembly.LoadFrom 从 HTTPS 站点下载

> ID：793886
> 
> 赞同：0
> 
> 时间：2009-04-27T14:54:19.903
> 
> 标签：c#, assemblies

无法使用 HTTPS 路径`Assembly.LoadFrom`。

也尝试使用`TrustAllCertificatePolicy`类，但它没有用。

我已经完全信任使用客户端机器上的 caspol 的服务器。相同的 URL 可在禁用 ssl 的情况下使用。它不适用于启用 ssl。请帮忙。

例外是：

```
System.IO.FileLoadException: Security problem encountered when connecting to URL for 'https://ip/tasks/tasks.dll'. File name: 'https://ip/tasks/tasks.dll'    
at System.Reflection.Assembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity,
     Assembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection)    
at System.Reflection.Assembly.InternalLoad(AssemblyName assemblyRef, Evidence assemblySecurity, 
    StackCrawlMark& stackMark, Boolean forIntrospection)    
at System.Reflection.Assembly.InternalLoadFrom(String assemblyFile, Evidence securityEvidence, 
    Byte[] hashValue, AssemblyHashAlgorithm hashAlgorithm, Boolean forIntrospection, StackCrawlMark& stackMark)    
at System.Reflection.Assembly.LoadFrom(String assemblyFile, Evidence securityEvidence)    
    WRN: Assembly binding logging is turned OFF. To enable assembly bind failure logging, set the registry value 
    [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) to 1\. Note: There is some performance penalty associated 
    with assembly bind failure logging. To turn this feature off, remove the registry value 
    [HKLM\Software\Microsoft\Fusion!EnableLog]. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T15:07:42.897

代码访问安全将阻止来自 http 和 https 位置的代码执行正常（完全权限访问）。

您将需要创建一个新的 AppDomain（并且可能是可远程/可序列化的类型以跨越应用程序域边界），并在 AppDomain 中使用 CAS 设置以使用 Internet 权限集运行。这样可以避免下载的代码修改本地机器。

如果您真的信任远程代码（以及可以或将能够修改它的每个人），您当然可以创建一个自定义权限集以允许更多访问权限。

# winsock - closesocket 触发 WSARecvFrom 完成例程

> ID：793888
> 
> 赞同：1
> 
> 时间：2009-04-27T14:55:16.780
> 
> 标签：winsock

我注意到，当我调用 closesocket 时，WSARecvFrom 的完成例程（到那时等待传入数据）正在被 dwError=0 和 cbTransferred=garbage 触发，尽管该套接字没有待处理的传入数据。

当我关闭套接字时，有什么方法可以不调用它？我试图在closesocket之前调用shutdown，但它没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T00:01:22.197

WSARecvFrom() 本身返回什么值？我自己没有使用过 WSARecvFrom()，但 MSDN 说 dwError 是完成状态，所以我想 0 表示实际错误，或者没有数据。

另外，在调用 closesocket() 之前是否调用了 CancelIo()？

# mod-deflate - Apache 2 中的 mod_deflate 会产生什么？

> ID：793891
> 
> 赞同：2
> 
> 时间：2009-04-27T14:55:25.080
> 
> 标签：mod-deflate

Apache2中**mod_deflate**的压缩机制是什么。它是 gzip 还是 zlib 或其他什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T15:27:50.790

[mod_deflate](http://httpd.apache.org/docs/2.2/mod/mod_deflate.html)使用 zlib。

# c# - 从 bin 文件夹加载视图？

> ID：793892
> 
> 赞同：0
> 
> 时间：2009-04-27T14:55:50.337
> 
> 标签：c#, .net, asp.net-mvc

为了让多个站点拥有一组中心视图，我创建了一个包含我的视图的外部库。它们被标记为内容并始终复制。
这个视图库在我的网站中被引用，因此通过编译在他们的 bin 文件夹中得到一个“Views”文件夹。
然后我制作了一个像这样的快速自定义 ViewEngine：

```
public class CommonViewLocator: WebFormViewEngine
{
    public CommonViewLocator()
    {
        MasterLocationFormats = new[] {  
            "~/bin/Views/{1}/{0}.master",  
            "~/bin/Views/Shared/{0}.master"  
        };
        ViewLocationFormats = new[] {  
            "~/bin/Views/{1}/{0}.aspx",  
            "~/bin/Views/{1}/{0}.ascx",  
            "~/bin/Views/Shared/{0}.aspx",  
            "~/bin/Views/Shared/{0}.ascx"  
        };
        PartialViewLocationFormats = ViewLocationFormats;  
    }
} 
```

运行后我得到这个屏幕：

```
The view 'Index' or its master could not be found. The following locations were searched:
~/Views/Home/Index.aspx
~/Views/Home/Index.ascx
~/Views/Shared/Index.aspx
~/Views/Shared/Index.ascx
~/bin/Views/Home/Index.aspx
~/bin/Views/Home/Index.ascx
~/bin/Views/Shared/Index.aspx
~/bin/Views/Shared/Index.ascx 
```

怎么了？
另外，bin文件夹有视图感觉有点奇怪，欢迎任何其他建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-06T03:59:43.307

为什么不对项目使用构建后操作将 /bin/Views 中的文件移动到 /Views 中？那么你就不必在代码中做任何特别的事情了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T15:12:02.560

如果您绝对确定内容位于正确的文件夹中，那么出于明显的安全原因，可能是服务器不允许从 bin 目录提供任何内容。

如果是这种情况，我建议您将视图保留在外部项目中，然后创建呈现这些视图的 HTML 扩展方法。

# c# - 使用 LINQ 的 FirstOrDefault 检查 KeyValuePair 是否存在

> ID：793897
> 
> 赞同：76
> 
> 时间：2009-04-27T14:57:14.530
> 
> 标签：c#, linq, null

我有一本类型的字典

```
Dictionary<Guid,int> 
```

我想返回满足条件的第一个实例

```
var available = m_AvailableDict.FirstOrDefault(p => p.Value == 0) 
```

但是，如何检查我是否真的取回了 KeyValuePair？如果没有编译器错误，我似乎无法使用 != 或 == 来检查 default(KeyValuePair) 。[这里](https://stackoverflow.com/questions/648115/how-can-an-object-not-be-compared-to-null)有一个类似的线程，似乎没有解决方案。实际上，我可以通过获取密钥并检查 Guid 的默认值来解决我的特定问题，但我很好奇是否有使用 keyvaluepair 的好方法。谢谢

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-04-27T15:01:06.843

如果您只关心存在，您可以使用`ContainsValue(0)`or`Any(p => p.Value == 0)`代替？按*值*搜索对于 a 来说是不寻常的`Dictionary<,>`；如果您按关键字搜索，则可以使用`TryGetValue`.

另一种方法：

```
var record = data.Where(p => p.Value == 1)
     .Select(p => new { Key = p.Key, Value = p.Value })
     .FirstOrDefault(); 
```

这会返回一个*类*`null`-如果找不到，也会如此。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-04-27T15:01:58.357

我建议您以这种方式更改它：

```
var query = m_AvailableDict.Where(p => p.Value == 0).Take(1).ToList(); 
```

然后您可以查看列表是否为空，如果不是，则取第一个值，例如

```
if (query.Count == 0)
{
    // Take action accordingly
}
else
{
    Guid key = query[0].Key;
    // Use the key
} 
```

请注意，字典中没有“第一个”条目的真正概念——它的迭代顺序没有明确定义。如果您想获取*最初*使用该值输入的键/值对，您将需要某种顺序保留字典。

（这是假设您实际上想知道密钥 - 如果您只是在检查存在性之后，[Marc 的解决方案](https://stackoverflow.com/a/793918/3649914)是最合适的。）

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2010-08-05T11:38:40.783

使用 default() 关键字。

```
bool exists = !available.Equals(default(KeyValuePair<Guid, int>)); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-27T15:05:12.513

您想要的是一种`Any`同时为您提供匹配元素的方法。您可以自己轻松编写此方法。

```
public static class IEnumerableExtensions
{
  public static bool TryGetFirst<TSource>(this IEnumerable<TSource> source,
                                          Func<TSource, bool> predicate,
                                          out TSource first)
  {
    foreach (TSource item in source)
    {
      if (predicate(item))
      {
        first = item;
        return true;
      }
    }

    first = default(TSource);
    return false;
  }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-27T15:01:54.190

你可以检查一下

```
available.Key==Guid.Empty 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-03-21T15:02:45.023

在不指定类型的情况下检查结构（例如 KeyValuePair）的默认值的一种方法是使用 Activator 创建一个新实例：

```
if (available.Equals(Activator.CreateInstance(available.GetType())))
{
    Console.WriteLine("Not Found!");
} 
```

# c# - 可以从自定义工具属性网格向 Visual Studio 2008 自定义工具传递其他参数吗？

> ID：793899
> 
> 赞同：1
> 
> 时间：2009-04-27T14:57:42.767
> 
> 标签：c#, visual-studio-2008, vs-extensibility

Visual Studio 2008[自定义](http://msdn.microsoft.com/en-us/library/bb166817.aspx) [工具](http://www.drewnoakes.com/snippets/WritingACustomCodeGeneratorToolForVisualStudio/)能否从 VS 中的自定义工具属性网格中传递附加参数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T15:05:20.890

是和不是。您可以通过将自定义工具添加为自定义构建规则来解决此问题。C++ 文件的（内置）构建规则会导致 C++ 文件的属性表；IDL 文件的构建规则会导致这些属性表。您自己的自定义构建规则可以定义自己的属性表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-15T04:52:13.043

您可以使用 CustomToolNamespace 设置解析参数。

读出来的代码相当多。

请参阅[http://sites.google.com/site/dmytrokryvko/](http://sites.google.com/site/dmytrokryvko/)`GetResourcesNamespace()`中的 ResXFileCodeGeneratorEx 中的 ResXFileCodeGeneratorEx.cs 中的示例

# windows-7 - 关于 Direct2D 和 DirectWrite 功能

> ID：793902
> 
> 赞同：2
> 
> 时间：2009-04-27T14:58:03.047
> 
> 标签：windows-7, windows-vista, windows-xp, directx

有人知道如何在 XP 和 Vista 中启用 Direct2D 和 DirectWrite 功能吗？Direct2D 和 DirectWrite 是在 Windows 7 中引入的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T15:18:38.830

从微软目前宣布的情况来看，这些都不会在 XP 中可用，但会在它们发布时添加到 Vista 中。

有关 DirectWrite 的详细信息（特别是针对 Vista 而不是 XP 发布的），请参阅[此 MSDN 博客。](http://blogs.msdn.com/text/archive/2009/04/13/directwrite-questions-and-answers.aspx)

Direct2D 建立在 DirectX 10.1 之上，因此无法在 XP 上运行（因为 DirectX 10 仅适用于 Vista+）。

Direct2D 和 DirectWrite 技术预览目前都在[2009 年 3 月的 DirectX SDK 中可用。](http://www.microsoft.com/downloads/details.aspx?FamilyID=24a541d6-0486-4453-8641-1eee9e21b282&displaylang=en) 它们今天将在 Vista 和 Windows 7 中运行（作为技术预览）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-27T13:54:23.267

这是非官方的，可能包含恶意软件/病毒，但它存在：[DirectX 10 for Windows XP](http://www.technospot.net/blogs/download-directx-10-for-windows-xp-from-alky-project/)。我没有测试它。

# forms - 如何提供 Web 表单并通过电子邮件安全地发送响应？

> ID：793903
> 
> 赞同：0
> 
> 时间：2009-04-27T14:58:11.360
> 
> 标签：forms, security

我正在尝试学习如何保护 Web 表单。举个简单的例子，联系表格、姓名、电话、电子邮件。我找到了这个：

[安全电子邮件技术](https://www.anonymousspeech.com/how_to_secure_email_form.aspx)

但我不知道这是否是正确的方法。它不是共享主机，如果重要的话，我可以完全访问所有内容。我目前绑定到 IIS 6 和 Windows 2000，所以我可能需要使用 asp.net 2.0，但如果需要可以使用其他语言（可以在 IIS 中运行。）

我希望能够填写表格并将其通过电子邮件发送/将表格发送到适当的下一步（我不知道那是。）

另外，我是否使用端口 443 作为表单的端口？

编辑：所以我很清楚。对不起。我需要整个过程安全。这不仅仅是安全地获取初始表单。输入表格后，我需要安全地获取表格中的数据。

编辑：我还不够清楚。一旦我从用户那里获得了我将通过 443 和 SSL 获得的数据，我希望这些数据通过 Internet 通过电子邮件发送给我。有可能安全地做到这一点吗？或者，最好有我的 SSL，通过它获取数据，然后让查看该信息的用户（秘书，无论如何）使用相同的 SSL 套接字，只使用一个查看应用程序？

任何帮助表示赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T15:52:56.253

如果您已经为页面设置了 SSL，那么这就是完成工作的大部分真正的 PITA 部分。用户可以在 443 端口上连接，他们输入的所有数据都是安全的。

然而，大多数人*没有*回答的是通过电子邮件传输的数据，其中大部分传输不能保证安全 - [我不知道这个参考有多可信，但值得一读：[http ://ask-leo.com/just_how_secure_is_email_anyway.html](http://ask-leo.com/just_how_secure_is_email_anyway.html) ] 所以你必须自己使用某种形式的加密来加密数据。也许公钥/私钥加密 - 也许是 RSA 或类似的。使用公钥加密数据，将其附加到电子邮件中并邮寄出去。然后，电子邮件接收者使用私钥解密数据。

如果您正在使用表单的 mailto 功能，那么是时候动手了，因为您可能需要进行一些编码。据我所知 [如果我错了，请有人纠正我]，IIS 没有任何能力加密通过电子邮件发出的数据 - 主要是因为接收电子邮件程序可能无法解密数据，意味着您需要指定加密算法、任何密钥、附件方法等。

有*许多*库可以用来处理这个问题。你没有提到你是否自己编程，也没有暗示编程语言，但由于你似乎在使用 Microsoft 技术，我将向你指出 Microsoft 的网站作为参考：

[http://msdn.microsoft.com/en-us/library/5e9ft273.aspx](http://msdn.microsoft.com/en-us/library/5e9ft273.aspx)

希望这应该为您指明正确的方向。我的想法是您需要让网站解析输入的数据，使用公钥对其进行加密并将其附加到电子邮件中。

然后，任何正在阅读电子邮件的人都需要一个实用程序来使用私钥解密数据。我想您会希望该实用程序自动侦听带有加密附件的传入电子邮件，并自动将它们解密到磁盘以节省每次手动执行此操作的人。或者，您可以有一些拖放实用程序，您可以将附件拖动到以查看它。只是一些想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T15:01:47.187

您需要购买 SSL 证书并将 IIS 配置为使用该证书并仅通过 SSL 连接提供页面。这将意味着从用户浏览器到您的服务器的所有与该站点的连接都是安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T15:07:28.560

SSL 证书会为您工作。您不一定需要购买一个，因为它们可以“自签名”，尽管您的使用会看到其中一个窗口弹出，告诉他们证书无效。但即使证书无效，它仍将提供与签名证书相同的加密。

如果您使用 https 协议，则客户端 Web 浏览器将自动尝试连接到端口 443 的 Web 服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T15:10:20.287

您的站点需要 SSL 证书。就确保您的数据安全而言，请确保您的表单操作是 https://

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T15:12:45.023

保护表单始终是一项危险的工作，但您需要做的第一件事就是添加一个 CAPTCHA 组件，这样漏洞扫描程序或机器人就无法使用该表单来尝试在您的代码中查找任何可能的漏洞或在您的服务器中。这样一来，您的表单中的数千封电子邮件就不会出现在收件人邮件文件夹中。

在对输入数据进行任何处理之前，请尝试清理输入数据，这将防止 SQL 注入、XSS 和其他攻击。像 ASP.NET 这样的一些语言只是在默认配置下执行此任务，但是如果您必须对其进行编码，这并不是那么困难的任务。从这两个开始还有更多的技术，95% 的工作都将完成。

如果您需要任何其他建议，请告诉我。

# sql - 不区分大小写地订购选择结果？

> ID：793905
> 
> 赞同：2
> 
> 时间：2009-04-27T14:58:37.460
> 
> 标签：sql, database, select, db2

是否可以不区分大小写地对 db2 数据库上的选择查询结果进行排序？

例如：我想将所有以“a”或“A”开头的名称排序在一起。

```
Abraham
aron
andrea
Annica
brian
Benjamin 
```

现在是这样的：

```
aron
andrea
brian
Abraham
Annica
Benjamin 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-27T15:01:30.243

```
order by lower(columnname); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T18:40:57.980

假设您使用的是 DB2/400（假设来自您的另一篇文章），那么您希望将请求该查询的作业的排序顺序更改为 SRTSEQ(*LANGIDSHR)。您还可以（并且应该）使用该设置构建索引，以便使用索引。

运行 lower() 函数将强制 DB2 评估每一行的函数并构建一个巨大的临时表来处理它。它会起作用......但效果不佳。

# c# - URL 重写博客文章地址的最佳实践是什么？

> ID：793908
> 
> 赞同：2
> 
> 时间：2009-04-27T14:58:54.807
> 
> 标签：c#, asp.net, url-rewriting

我看到很多网站都有这样的地址：

```
http://www.myblog/2008/10/10/articl-title.aspx 
```

**问题 1**

如果我使用 linq2sql 来提取文章，很明显我必须使用 Startwith() 函数在 db 中搜索文章，但这真的比使用 ID 搜索更智能和精确吗？

**问题 2** 使 URL 看起来像这样整洁并添加 ID 并同时使搜索引擎友好的最佳方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T15:16:14.220

好吧，一个非常简单的替代方案是 SO 使用的技巧；包括内部标识符*和*搜索友好部分 - 即

```
http://stackoverflow.com/questions/793908/what-is-the-best-practice-for-urlrewriting-a-blog-article-adress 
```

只看标识符。对于 ASP.NET MVC 路由，这是微不足道的。

如果您走另一条路线（路线中没有数据库标识符）；只需将损坏的名称/路径存储在数据库中-然后您的查询是相等的 = 非常有效。

# java - WEB-INF 在 CLASSPATH 中吗？

> ID：793917
> 
> 赞同：57
> 
> 时间：2009-04-27T15:01:02.210
> 
> 标签：java, classpath, web-inf

`WEB-INF`文件夹是`CLASSPATH`Java Web 应用程序的吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-04-27T15:03:06.997

我假设您指的是 Web 应用程序文件夹结构根`/WEB-INF` *目录中的目录。*

不，它不在类路径中。

`/WEB-INF/classes`虽然在类路径上，但`/WEB-INF/lib`.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-27T15:13:13.273

此外，WEB-INF 中的文件受到保护，不会被 web 容器请求，即它们对外界是不可见的。

# iphone - 以编程方式激活飞行模式？

> ID：793924
> 
> 赞同：7
> 
> 时间：2009-04-27T15:02:18.357
> 
> 标签：iphone

有谁知道如何在 iPhone（OS 2.1）上以编程方式取消/激活飞行模式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T15:44:46.100

使用公共 API 无法做到这一点，这意味着 Apple 不会批准 App Store 的应用程序执行此操作。

当然，您通常不应该这样做。我很想知道你想到的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-24T22:41:07.320

Apple 已做出一项组织决定，阻止对 iOS 设备的企业管理，并限制 API 的范围和互操作性。因此，iOS 设备不具备以这种方式管理的能力或灵活性。Android 设备可以通过灵活的 API 和脚本进行管理。对于我们的组织，我们希望确保铁路工程师无法拨打或接听来自引擎的电话。最后，我们禁止 iOS 设备进入铁路站场。我知道航空公司也在做同样的事情。

# wpf - 如何让 DataTemplate.DataTrigger 检查大于或小于？

> ID：793926
> 
> 赞同：52
> 
> 时间：2009-04-27T15:02:54.610
> 
> 标签：wpf, xaml, datatemplate, datatrigger

**如果年龄等于**30 ，则以下`DataTemplate.DataTrigger`使年龄显示为红色。

 ****如果年龄大于**30 ，如何使年龄显示为红色？

```
<DataTemplate DataType="{x:Type local:Customer}">
    <Grid x:Name="MainGrid" Style="{StaticResource customerGridMainStyle}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="100"/>
            <ColumnDefinition Width="150"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <TextBlock Grid.Column="0" Grid.Row="0" Text="First Name" Margin="5"/>
        <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding FirstName}" Margin="5"/>
        <TextBlock Grid.Column="0" Grid.Row="1" Text="Last Name" Margin="5"/>
        <TextBlock Grid.Column="1" Grid.Row="1" Text="{Binding LastName}" Margin="5"/>
        <TextBlock Grid.Column="0" Grid.Row="2" Text="Age" Margin="5"/>
        <TextBlock x:Name="Age" Grid.Column="1" Grid.Row="2" Text="{Binding Age}" Margin="5"/>
    </Grid>

    <DataTemplate.Triggers>
        <DataTrigger Binding="{Binding Path=Age}">
            <DataTrigger.Value>30</DataTrigger.Value>
            <Setter TargetName="Age" Property="Foreground" Value="Red"/> 
        </DataTrigger>
    </DataTemplate.Triggers>

</DataTemplate> 
```

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-04-27T15:11:54.243

您可以创建一个`IValueConverter`，它将整数转换为基于 的布尔值`CutOff`。然后使用`DataTrigger.Value`（`True`或`False`，取决于您返回的内容）。

`DataTrigger`如果我没记错的话，WPF是严格的相等比较器。

所以类似于：

```
public class CutoffConverter : IValueConverter {
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture) {
        return ((int)value) > Cutoff;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture) {
        throw new NotImplementedException();
    }

    public int Cutoff { get; set; }
} 
```

然后使用以下 XAML。

```
<Window.Resources>
    <myNamespace:CutoffConverter x:Key="AgeConverter" Cutoff="30" />
</Window.Resources>

<DataTemplate.Triggers>
    <DataTrigger Binding="{Binding Path=Age,
                                   Converter={StaticResource AgeConverter}}">
        <DataTrigger.Value>true</DataTrigger.Value>
        <Setter TargetName="Age" Property="Foreground" Value="Red"/> 
    </DataTrigger>
</DataTemplate.Triggers> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-27T15:37:33.247

我建议使用 an`IValueConverter`绑定到`Foreground`Age 的元素`TextBlock`并在那里隔离着色逻辑。

```
<TextBlock x:Name="Age"  
           Text="{Binding Age}" 
           Foreground="{Binding Path=Age, Converter={StaticResource AgeToColorConverter}}" /> 
```

然后在代码中：

```
[ValueConversion(typeof(int), typeof(Brush))]
public class AgeToColorConverter : IValueConverter
{
   public object Convert(object value, Type target)
   {
      int age;
      Int32.TryParse(value.ToString(), age);
      return (age >= 30 ? Brushes.Red : Brushes.Black);
   }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-09-05T03:42:53.093

我相信有一种更简单的方法可以通过使用 MVVM 和`INotifyPropertyChanged`.

* * *

使用该`Age`属性创建另一个属性，该属性将是一个名为`IsAgeValid`. 这`IsAgeValid`将只是一个*按需*检查，在*技术上*不需要`OnNotify`调用。如何？

若要将更改推送到 Xaml，请将`OnNotifyPropertyChanged`要触发的事件放在`IsAgeValid` **setter**`Age`中。

任何绑定*也*`IsAgeValid`将在任何更改订阅上发送通知消息；这才是真正被关注的... *`Age`*

 ** * *

设置完成后，当然会根据`IsAgeValid`结果将样式触发器绑定为 false 和 true。

```
public bool IsAgeValid{ get { return Age > 30; } }

public int Age
{ 
  get { return _Age; }

  set
  {
   _Age=value;
   OnPropertyChanged("Age");   
   OnPropertyChanged("IsAgeValid"); // When age changes, so does the
                                    // question *is age valid* changes. So 
                                    // update the controls dependent on it.
   } 
 } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-04-05T08:52:32.920

如果可能，您可以为模型添加一个属性，这是最简单的方法。例如。

```
public int AgeBoundry
{
    get
    {
        if (Age < 30)
            return 0;
        else if (Age == 30)
            return 1;
        else
            return 2;
    }
} 
```

然后你可以检查整数的值。

```
<DataTemplate.Triggers>
    <DataTrigger Binding="{Binding Path=Age}">
        <DataTrigger.Value>0</DataTrigger.Value>
        <Setter TargetName="Age" Property="Foreground" Value="Green"/> 
    </DataTrigger>
    <DataTrigger Binding="{Binding Path=Age}">
        <DataTrigger.Value>1</DataTrigger.Value>
        <Setter TargetName="Age" Property="Foreground" Value="Orange"/> 
    </DataTrigger>
    <DataTrigger Binding="{Binding Path=Age}">
        <DataTrigger.Value>2</DataTrigger.Value>
        <Setter TargetName="Age" Property="Foreground" Value="Red"/> 
    </DataTrigger>
</DataTemplate.Triggers> 
```

# c# - 更新列表框

> ID：793927
> 
> 赞同：0
> 
> 时间：2009-04-27T15:02:57.557
> 
> 标签：c#, .net, sql, database, sql-server-ce

我已使用以下代码将 ListBox 绑定到 SQL CE 数据库：

```
ItemsSource="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:DatabaseWindow}}, Path=Database.Photos1}" 
```

此 ListBox 已正确填充。但是当我尝试在数据库中插入一行时（InsertOnSubmit + SubmitChagnes），ListBox 没有更新！

我努力了：

```
ListBox.Items.Refresh();

ListBox.GetBindingExpression(ListBox.ItemsSourceProperty).UpdateTarget();

ListBox.ItemsSource = null; 
ListBox.ItemsSource = this.Database.Table; 
```

这些都没有帮助。如何更新列表框？！

PS：重新加载数据库后，该行出现在ListBox中。PPS：如果有人知道带有 WPF 的 SQL CE 教程，其中显示了插入到 ListBox 中 - 那也很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T18:03:12.570

确保您分配给 ItemsSource 的数据实现了 INotifyCollectionChanged。（例如，您可以将您的项目放入 ObservableCollection） 此外，要反映对您的个别项目的更改，您必须实施 INotifyPropertyChanged。

# security - 在应用程序中安全地连接到数据库

> ID：793932
> 
> 赞同：0
> 
> 时间：2009-04-27T15:04:25.933
> 
> 标签：security

我从来没有在我的公司系统之外开发过一个应用程序，我们只依赖来自我们域的 Windows 身份验证，但我想学习如何开发一个可以连接到远程数据库的安全应用程序。

我知道如果我使用 ASP .Net 会更容易，因为数据连接将在服务器端，但我也希望有一个 WPF 应用程序来执行管理任务。

这是我可以想到的安全连接到数据库的方法：

首先始终与数据库建立 SSL 连接，在程序的配置文件中有一个默认的用户/密码，它是明文，它唯一的访问权限是访问数据库上的登录过程，用户在其中放入数据库凭据和默认值user/pass 将连接到数据库并传递用户提供的凭据。

然后，该过程将传回一对凭据用户/通行证，应用程序将用于登录会话的其余用户。这是解决问题的好方法吗？并且我是否应该考虑使用 WCF 的 Web 服务作为接口而不是直接连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T15:10:19.943

为什么这么复杂？只需让用户输入数据库用户名和密码，然后尝试使用 SSL 连接连接到服务器。该服务器已经有一个功能齐全的用户管理系统，所以如果您只需要少数人访问，则无需创建新系统。

# list - Haskell：用关联列表中的给定键替换元素

> ID：793935
> 
> 赞同：2
> 
> 时间：2009-04-27T15:04:58.940
> 
> 标签：list, haskell

我必须创建一个函数，它被赋予一个键（作为 a `String`）、一个值（作为 a `String`）以及一个键和值的关联列表（作为`[(String, String)]`）。该函数旨在将键/值对添加到列表的末尾，如果该键已经存在于列表中并具有关联的值，则删除旧值。

我已经尝试`lookup`在键和关联列表上使用，但我不确定如何处理输出 -`lookup`函数的输出类型是`Maybe String`，我似乎无法在其上执行列表函数（如删除元素） . 有什么方法可以查看列表并删除具有给定键的任何列表元素而不知道与之关联的值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T15:28:52.190

您可能应该编写一个递归函数，将新的键/值对和现有列表作为参数，并遍历列表以生成插入新值的新列表。对于每个列表元素，您检查键是否与您要插入的键相同。如果不同，则保留旧元素，如果相同，则添加新元素而不是旧元素。如果您在没有找到密钥的情况下到达列表的末尾，您只需在末尾插入新项目即可。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T20:32:27.313

这是一个简单的功能，可以满足您的需求。它采用新的键值对并将其放在给定关联列表的前面，并过滤掉该键。

```
addOrReplace :: Eq k => k -> v -> [(k, v)] -> [(k, v)]
addOrReplace key value assoc = (key,value):(filter ((key /=).fst) assoc) 
```

函数`fst`定义为：

```
fst (first,second) = first 
```

`filter`接受一个谓词和一个列表，并返回仅包含满足谓词的元素的列表。

编辑：按照 Tom 的建议，在 addOrReplace 的参数中拆分键值对。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-27T15:44:44.570

`Maybe`在 Haskell 中，当我们不确定是否会得到一个值或什么都没有时，我们经常使用数据类型。它等价于更传统的语言（如 Java）中的可为空类型。

`Maybe`定义如下：

```
data Maybe a = Nothing | Just a 
```

也就是说，该值可以是`Nothing`或`Just a`，`a`您要查找的对象在哪里。例如，如果您正在`"foo"`使用该`lookup`函数搜索字符串，并且您`("foo", "bar")`的列表中有一个元组，您会得到 result `Just "bar"`。但是，如果你抬头看`"xyzzy"`，你会得到`Nothing`.

我们可以`Maybe`使用该函数获取该值并将其转换为更有用的东西`maybe`（我知道名称令人困惑-该函数都是小写的）。它的定义如下：

```
maybe default f (Just a) = f a
maybe default f Nothing  = default 
```

第一个参数是默认值。如果我们有，这就是我们得到的`Nothing`。否则，我们将函数`f`应用于，我们想要的东西`a`在哪里。`a`如果您只想`a`返回，可以将`id`函数传递为`f`：

```
maybe default id (Just a) = id a 
```

有帮助，`id a = a`.

如果您想继续使用当前的`lookup`计划，这就是您从中获得有用信息的方式。不过，我个人更喜欢这种方法——在处理器上会更容易。

# .net - WPF ListView 非活动选择颜色和元素字体颜色

> ID：793937
> 
> 赞同：4
> 
> 时间：2009-04-27T15:05:19.173
> 
> 标签：.net, wpf, listbox, listboxitem

我可以设置 ListView 非活动选择颜色

我使用了以下问题中描述的解决方案

[WPF ListView 非活动选择颜色](https://stackoverflow.com/questions/382006/wpf-listview-inactive-selection-color)

我需要更改所选非活动元素的字体颜色，有没有简单的方法可以做到这一点？

谢谢你

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T15:18:49.157

不幸的是，您不能使用`SystemColors.ControlTextBrushKey`它，因为它适用于未选择该项目，或者当它被选中但不活动时（您的问题看起来好像您只对后者感兴趣）。但是，您可以这样做：

```
<ListBox ...>
    <ListBox.Resources>
        <!-- this customizes the background color when the item is selected but inactive -->
        <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}">Red</SolidColorBrush>
    </ListBox.Resources>
    <ListBox.ItemContainerStyle>
        <Style>
            <Style.Triggers>
                            <!-- this customizes the foreground color when the item is selected but inactive -->
                <Trigger Property="Selector.IsSelected" Value="True">
                    <Setter Property="TextElement.Foreground" Value="Blue"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </ListBox.ItemContainerStyle>
</ListBox> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-10-02T14:20:50.387

对我来说，这有效 - 在活动和非活动列表框中，所选项目的前景和背景颜色是相同的。

```
<ListBox.ItemContainerStyle>
  <Style TargetType="{x:Type ListBoxItem}">
    <Style.Resources>
      <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="DodgerBlue"/>
      <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="White"/>
      <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" Color="DodgerBlue"/>
      <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}" Color="White"/>
    </Style.Resources>        
  </Style>
</ListBox.ItemContainerStyle> 
```

# php - PHP：Textile 给我单引号而不是撇号

> ID：793941
> 
> 赞同：0
> 
> 时间：2009-04-27T15:05:41.607
> 
> 标签：php, textile

我正在使用 v2.0 的 ClassTextile.php，调用如下：

```
$testimonial_text = $textile->TextileRestricted($_POST['testimonial']); 
```

...并且我所有的撇号（例如，这里很热）都被翻译成 ASCII `&#8216;`（这是一个单引号，它以错误的方式倾斜）。它应该是 ASCII `&#8217;`。我也试过使用`TextileThis()`，我也有同样的问题。

如果我在 Textile 的网站 ( [http://textile.thresholdstate.com/](http://textile.thresholdstate.com/) ) 上尝试一下，它会给出正确的 ASCII 码。那么为什么它不能与可下载的库一起使用呢？还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T15:27:11.027

您是否真的将源代码中的文本复制粘贴到他们网站上的表单中？如果这仍然产生相同的结果，您可能应该升级您的版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T18:50:11.070

嗯代码看起来很干净，我建议传入 POST 和一个变量，而不是直接查看是否存在某种错误。我认为仅仅排除该选项，结果不会改变。

```
$var = $_POST['testimonial'];
$testimonial_text = $textile->TextileRestricted($var); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-22T19:46:07.573

再次尝试，它的工作原理。奇怪的。

无论如何，已经切换到 Markdown。呃，好吧。

# .net - 以编程方式删除或隐藏 Word 2007 中的注释/跟踪更改？

> ID：793949
> 
> 赞同：3
> 
> 时间：2009-04-27T15:07:49.183
> 
> 标签：.net, ms-word

我想知道这是否可能？如果是这样怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T15:22:54.873

以下情况如何：

```
ActiveWindow.View.RevisionsView = wdRevisionsViewFinal
ActiveWindow.View.ShowRevisionsAndComments = False 
```

这将显示没有标记的最终文档。

注意：ActiveWindow 是 Word.Application 类的属性

编辑：

这个答案是使用 OLE 自动化，在重读你的问题时，这可能不是你要找的，抱歉。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T15:25:37.473

这是 Eric White 的一篇文章，展示了如何删除评论：http: [//blogs.msdn.com/ericwhite/archive/2008/07/14/using-the-open-xml-sdk-and-linq-to-xml -to-remove-comments-from-an-open-xml-wordprocessing-document.aspx](http://blogs.msdn.com/ericwhite/archive/2008/07/14/using-the-open-xml-sdk-and-linq-to-xml-to-remove-comments-from-an-open-xml-wordprocessing-document.aspx)

简而言之，这是他发布的代码：

```
XName commentRangeStart = w + "commentRangeStart";

XName commentRangeEnd = w + "commentRangeEnd";

XName commentReference = w + "commentReference";

mainDocumentXDoc.Descendants()

    .Where(x =>

       x.Name == commentRangeStart ||

       x.Name == commentRangeEnd ||

       x.Name == commentReference)

    .Remove(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-13T13:02:13.127

通过将 ActiveDocument.TrackRevisions 设置为 True/False 来打开/关闭跟踪更改。

# algorithm - O(1) 复杂度删除单个链表中一个元素的算法

> ID：793950
> 
> 赞同：8
> 
> 时间：2009-04-27T15:07:59.543
> 
> 标签：algorithm, linked-list, computer-science, big-o

我是德国计算机专业的学生。我的教授给出了以下问题来思考：

'给定对单个链表中节点的引用（不是最后一个节点）。给出一个算法从列表中删除这个元素，它具有 O(1) 复杂度，同时保持完整性。

我想过这个，但我很确定，没有这样的算法。因为它是一个单链表，你必须遍历链表中的每个节点，直到你到达应该删除的节点，因为你必须在删除之前修改节点中的下一个指针。这将导致 O(n) 复杂度。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-27T15:12:21.107

这取决于节点是否可变（值）。

有*一种*方法可以做到这一点，如果你可以对节点做你喜欢的事情：

```
toDelete.value = toDelete.next.value
toDelete.next = toDelete.next.next 
```

现在所有的信息`toDelete`都被旧的信息覆盖了`toDelete.next`。（根据平台，您可能需要释放旧的`toDelete.next`- 这意味着保留对它的临时引用。当然，如果其他人仍然对它有引用，那就不好了。在 Java/C# 中，您只需忽略它。 )

我试图找出一种暗示它而不泄露它的方法，但这有点棘手......

它确实依赖于这不是列表中的最后一个节点。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-27T15:13:08.547

不完全考虑删除节点，但您可以将下一个节点的数据复制到当前并删除下一个节点：

```
// pseudocode:
this.data = next.data;
var temp = this.next;
this.next = next.next;
delete temp; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T15:13:59.310

如果节点是内存中的基本结构，则可以将“next”节点的内容复制到已删除节点的内存位置，并释放“next”节点所在的内存。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T15:13:47.330

是的。您保留一个指向前一个列表的下一个指针的指针作为迭代指针。

```
walk = &head;
while (!match(*walk)) {
    walk = &walk[0]->next;
    if (!*walk) return ;
}
*walk = walk[0]->next; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-27T15:14:08.857

假设您有指向要删除的节点的指针。将下一个值复制到当前节点。将当前指针替换为下一个指向的节点。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-27T15:21:10.430

移动数据，而不是链接。查看另一个线程： [当指向前一个节点的指针不可用时，从单个链表中删除中间节点](https://stackoverflow.com/questions/69209/deleting-a-middle-node-from-a-single-linked-list-when-pointer-to-the-previous-nod)

# c# - 如何获取 html 内容并使用 itextsharp 将其转换为 PDF？

> ID：793957
> 
> 赞同：2
> 
> 时间：2009-04-27T15:10:18.163
> 
> 标签：c#, asp.net-mvc, pdf, linq-to-sql, itextsharp

有谁知道如何获取 html 内容，将其转换为 pdf 并将其保存到数据库？

我尝试了很多方法，但似乎没有任何效果。在某些文章中，它是使用 HTMLParse 编写的，在其他文章中是 HTMLWorker... 有时会抛出错误“文档没有页面”...有时，它只是抛出异常但没有指定错误...

有谁知道这样做的好方法？

我正在使用 C# 3.0、ASP.NET MVC 和 LinQToSQL。

提前感谢，非常感谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T23:24:16.947

对于 HTML 到 PDF，我倾向于查看[HTMLDoc](https://www.msweet.org/projects.php?Z1)。它是一个 exe 而不是一个库，所以它可能不是您正在寻找的东西，但它可能会让您克服困难。

看着 iText 的书，Lowagie 说：

“iText 邮件列表中的一个常见问题是，‘iText 是否提供 HTML2PDF 功能？’ 官方回答是否定的；建议您使用 HtmlDoc 或 ICEBrowser。” 第 456 页。

然后他继续展示了一个 HTMLParser 的例子，但强调它不是解析和呈现 HTML 的巨大工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-01T13:22:45.493

```
 public class Pdf : IPdf
    {
        public FileStreamResult Make(string s)
        {
            using (var ms = new MemoryStream())
            {
                using (var document = new Document())
                {
                    PdfWriter.GetInstance(document, ms);
                    document.Open();
                    using (var str = new StringReader(s))
                    {

                        var htmlWorker = new HTMLWorker(document);

                        htmlWorker.Parse(str);
                    }
                    document.Close();
                }

                HttpContext.Current.Response.ContentType = "application/pdf";
                HttpContext.Current.Response.AddHeader("content-disposition", "attachment;filename=MyPdfName.pdf");
                HttpContext.Current.Response.Buffer = true;
                HttpContext.Current.Response.Clear();
                HttpContext.Current.Response.OutputStream.Write(ms.GetBuffer(), 0, ms.GetBuffer().Length);
                HttpContext.Current.Response.OutputStream.Flush();
                HttpContext.Current.Response.End();

                return new FileStreamResult(HttpContext.Current.Response.OutputStream, "application/pdf");
            }
        }
    } 
```

# user-interface - 关于开源中的 3D UI 引擎

> ID：793961
> 
> 赞同：0
> 
> 时间：2009-04-27T15:10:55.027
> 
> 标签：user-interface, open-source, 3d

SourceForge 和其他开源论坛上有很多 3D UI 引擎，我想知道你用的哪个最好？

1.  在 Windows 中支持 D3D
2.  提供 UI Builder 工具
3.  支持自动布局
4.  易于本地化

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T15:44:39.300

**请扩展此答案。**

## [水晶空间 3D](http://www.crystalspace3d.org/main/Main_Page)

*许可证：* LGPL 许可证
*语言：* C++

CrystalSpace 功能真的很全。带有 2d 和 3d 模块、声音模块、物理和碰撞检测。

## [食人魔](http://www.ogre3d.org/)

*许可证：* LGPL 许可证
*语言：* C++ *平台：* Windows、Linux、Mac OS X

OGRE 是一个非常活跃的框架，但它不是一个功能齐全的框架。您必须找到单独的声音物理引擎。支持许多高级功能，如着色器。还包括一个菜单模块。

## [伊尔利赫特](http://irrlicht.sourceforge.net/)

*许可证：* Irrlicht 许可证（类似于 zlib）
*语言：* C++

## [酸菜](http://sauerbraten.org/)

*许可证：* zlib（只有源代码，不是媒体）

## [Quake III 引擎](http://en.wikipedia.org/wiki/Id_Tech_3)

*许可证：* GPL（仅源代码，不是媒体）
*3D 驱动程序*：OpenGL

## 其他

更多内容可以在[wikipedia](http://en.wikipedia.org/wiki/List_of_game_engines)上找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T01:14:09.193

查看[PyQt](http://wiki.python.org/moin/PyQt) - 它在 GPL 和商业许可下可用，并具有用于 3d 表面的画布类型窗口。

您可以将其强大的 GUI 用于工具并将 3d 视图嵌入其中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T15:19:13.480

如果您正在制作游戏，这可能不合适，但您可能想查看 WPF。

最新版本支持与 D3D 进行一定程度的集成。

# ruby-on-rails - 开源 Web 框架：安全性

> ID：793964
> 
> 赞同：2
> 
> 时间：2009-04-27T15:11:39.130
> 
> 标签：ruby-on-rails, django, security, open-source, web-frameworks

流行的开源 Web 框架有多安全？

我对 Rails 和 DJango 等流行框架特别感兴趣。

如果我正在构建一个要进行大量电子商务的网站，可以使用 DJango 和[Satchmo](http://www.satchmoproject.com)之类的框架吗？

安全性是否因为它们的开放架构而受到损害？

我知道作为操作系统并不意味着对黑客开放，Linux 使用一流的身份验证机制，但网络是一个不同的游戏。

在这方面可以做些什么？

**更新：**

谢谢你们的回答。

我知道我必须为安全的电子商务应用程序找到合适的托管服务，并且需要额外的安全层。

我知道 Django 和 Rails 的设计考虑到了安全方面，最常见的形式攻击，如 XSS、注入等。（[Django book](http://www.djangobook.com/en/1.0/)有一个关于[安全](http://www.djangobook.com/en/1.0/chapter19/)的 ch ）

我期待安全专家的评论。如果您是安全专家，您会推荐一个可能会流行的重要站点，该站点构建在 DJango 或 Rails 上吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T15:25:09.110

许多人说[通过默默无闻的安全性](http://en.wikipedia.org/wiki/Security_through_obscurity)是无效的。可以引用 Microsoft 产品、Adobe Reader 等作为证据，证明封闭源代码在防止安全问题方面并不比开源更有效。

许多开源倡导者认为，*越多越好*的方法是对抗与安全相关的错误的一种方法。然而，实际上，当您处理较小的应用程序或不那么流行的商业或开源应用程序时，通常很少有人关注。因此，某些黑帽会在谷歌代码中搜索带有安全漏洞的代码片段，这是真正的危险。

尽管如此，如果您使用的是相当流行的开源框架——我怀疑它是否比竞争的商业产品更安全。至少，您***可以***从具有非常活跃社区的开源产品中更快地获得与安全相关的错误修复。

但是，如果您认真考虑构建电子商务网站 - 您需要多层保护。一定要确保适当的防火墙和入侵保护/检测系统 (IPS/IDS) 到位。您可能需要为托管服务付费，该服务将提供除托管之外的安全安慰和监控服务。请记住，您的用户就是您的客户！任何违规行为都可能对企业造成灾难性影响。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T19:28:58.743

一些答案只谈论开源与封闭和安全性，但既然你问到具体的框架，我想我会评论一下我对 Rails 的了解。

有一些特性可以间接补充安全性，也有一些特性是明确设计用于在 Rails 中实现安全性的：

1.  SQL 注入 - 通常鼓励 ActiveRecord 访问 Rails 应用程序中的数据库。如果使用得当，您可以避免可能导致通过 SQL 注入进行利用的字符串连接问题。这是对 Web 应用程序的最常见攻击方法之一。
2.  XSS - 为用户输入的 HTML 编码文本提供了易于使用的宏，并提供了用于清除用户可能已在字段中输入的 JavaScript 的代码。通过将这些结合使用，您可以帮助保护自己免受来来往往的跨站点脚本攻击。
3.  Cookie 操作 - Rails 中存储会话数据的默认机制是以 cookie 的形式将其发送给最终用户。但是，用户不能简单地更改该数据然后将其重新发送回服务器，因为它在发送之前使用冗长的私钥进行了签名。任何更改的会话数据都将立即对服务器显而易见。
4.  CSRF - 这个解释起来很复杂，但 Rails 为其表单提供了安全性，以确保传入的请求来自您实际发送给用户的表单。

还有更多的东西，但是像 Rails 这样的现代框架已经内置了支持来帮助您从一开始就获得更安全的 Web 应用程序，这很好。也许熟悉 Django 特性的人也可以参与进来。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T15:58:15.040

在我参加的测试课程中（我同意），我总是说开源软件更安全，因为它们被更多人测试并被更多人改进。

隐藏代码源并不是保护应用程序的有效方法。它可能适用于特定软件，但对于广泛传播的框架，人们最终会弄清楚事情是如何工作的（[http://en.wikipedia.org/wiki/Reverse_engineering](http://en.wikipedia.org/wiki/Reverse_engineering)）

有使用开源框架的大型电子商务 Web 应用程序。如果您熟悉电子商务工具，那么您一定知道使用 Ruby on Rails 构建的 Shopify ( [http://weblog.rubyonrails.org/2006/6/5/shopify-is-open-for-business](http://weblog.rubyonrails.org/2006/6/5/shopify-is-open-for-business) )

他们还发布了[ActiveMerchant](http://www.activemerchant.org/)：

> Active Merchant 是从电子商务系统 Shopify 中提取的。Shopify 要求一个简单而统一的 API 来访问具有非常不同的内部 API 的数十个不同的支付网关，这是设计该库的主要原则。
> 
> Active Merchant 自 2006 年 6 月以来一直在生产中使用，现在用于处理金融交易的大多数现代 Ruby 应用程序。

在我看来，使用像 Rails 这样的框架与使用专有框架相比，安全性至少会一样好，甚至更好。我不了解 django，因为我从未使用过它，但我听说它也一样好。

当然，您需要确保您的应用程序安全，不要仅仅依赖于框架！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-19T23:56:00.500

我已经使用 Django 构建了多个站点，并使用 Satchmo 构建了一个店面。封闭源代码框架和开源框架之间的安全性没有区别，因为所有与安全性相关的信息对于您的安装都是唯一的。

例如，您的 settings.py 文件中的“秘密代码”是在您启动项目时唯一生成的。由您决定对用户密码进行加盐并保护您的加密密钥，就像在*任何*平台上一样。

关于 Django 需要注意的一点是，所有表单输入都是开箱即用的，所有表单输入都通过一个清理过程进行验证并“标记为安全”。您可以通过其`cleaned_data`字典访问表单的净化数据。

此外，所有模板都是自动转义的 HTML，因此注入攻击或跨站点脚本的风险几乎为零。

最后，这些模型提供了额外的安全层和验证，以防任何流氓数据通过。

至于 Satchmo，其到 paypal、visa 等的电子商务网关被上述公司接受并使用他们的 API，因此它们与任何其他支付网关一样安全。当然，您需要运行加密的 HTTPS 连接来进行信用卡支付，但这是普遍要求的，与您使用的框架无关。

# sql - 这些方法中哪一种对大型表具有更好的性能？

> ID：793982
> 
> 赞同：1
> 
> 时间：2009-04-27T15:14:09.560
> 
> 标签：sql, performance

假设 A 和 B 是数据库模式中的两个表。A 和 B 通过多对一关系关联。每个 A 存在多个 B，B 有一个外键列 a_id。两个表都有一个主键列 id。

以下两个查询中哪一个对 A 和 B 中的大型数据集执行得更好？

```
SELECT A.* FROM A,B WHERE A.id = B.a_id 
```

或者

```
SELECT A.* FROM A INNER JOIN B ON A.id = B.a_id 
```

或者它们是等价的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T15:18:16.460

它们对于所有`4`主要数据库系统都是等效的：`Oracle`, `SQL Server`, `MySQL`, `PostgreSQL`.

使用`JOIN`语法（更准确地说，使用`STRAIGHT_JOIN`代替`JOIN`）将有助于强制执行您在`MySQL`.

有关详细信息，请参阅此答案：

*   [**表的顺序重要吗？**](https://stackoverflow.com/questions/785583/does-the-order-of-tables-referenced-in-the-on-clause-of-the-join-matter/785626#785626)

`JOIN`使用语法通常也被认为更干净和可读。

尽管我在`Oracle`通常使用`WHERE`语法的代码示例上长大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T15:20:53.880

我同意其他答案，即在性能方面这两个语句在主要系统上是等效的，但我也将在那里抛出第二个语句从代码可读性的角度来看更可取。我还要说，指定列列表而不是使用星号会提高性能和可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T15:17:25.307

据我了解，它们都是一样的。理论上，我认为引擎可以优化 INNER JOIN，因为 A，B 的默认行为将是笛卡尔连接。话虽如此，我现在正在处理一个大小合适的表，并且两者在 SQL Server 2005 中都给出了相同的查询时间，所以我的猜测是引擎足够聪明，可以处理这个问题。

干杯，
埃里克

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T15:19:26.660

它们是等价的。但第二种形式是首选语法。

# java - JSP：不评估 EL 表达式

> ID：793983
> 
> 赞同：30
> 
> 时间：2009-04-27T15:14:11.727
> 
> 标签：java, jsp, el, taglib

我有一个在 Tomcat 5.5 上运行的 JSP 页面。我有以下代码：

```
 <c:forEach var="i" begin="1" end="10" step="1">
  <c:out value="${i}" />
  <br />
</c:forEach> 
```

我得到的输出是：

```
${i} 
${i} 
${i} 
${i} 
${i} 
${i} 
${i} 
${i} 
${i} 
${i} 
```

我无法弄清楚为什么 forEach 循环工作但输出不工作。任何人可以提供的任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-04-27T15:21:05.487

我知道默认情况下它应该是打开的，但是我不时地在不发生 EL 处理的页面（甚至是改变行为的同一页面）上运行。将以下内容添加到任何此类页面的顶部应该可以解决该问题：

```
<%@ page isELIgnored="false" %> 
```

我将它添加到每个页面是因为它不会造成伤害，而且我仍然不知道偶尔会导致页面停止解释 EL 表达式的根本原因。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2011-08-12T03:13:24.133

我只是遇到了同样的问题，并且一直在试图找出问题所在。

我从头开始开发了许多网络应用程序。这个怎么突然不合作了？

不同之处在于这次我使用了 maven webapp 原型来生成项目结构。它创建了一个如下所示的 web.xml 文件：

```
<!DOCTYPE web-app PUBLIC
 "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
 "http://java.sun.com/dtd/web-app_2_3.dtd" >

<web-app>
  <display-name>Archetype Created Web Application</display-name>
</web-app> 
```

一旦我意识到这是我的问题，我确信我有答案。所以我复制了我的 2.5 web.xml 标头之一，重新构建并重新部署。没有雪茄。不敢相信这不是问题所在。清理项目，重新启动tomcat。没有。

RHSeeger 的回答让我尝试放入 <%@ 页面 isELIgnored="false" %>。这解决了问题。但我仍然想知道为什么 el 一开始就开始被忽视。

我认为 el 被忽略是因为我的 web.xml 有问题，所以我仔细检查了它，并与另一个我知道工作正常的 webapp 的 web.xml 进行了比较。没有明显的差异。

然后我从我的 JSP 中删除了 <%@ page isELIgnored="false" %> 并重新部署，假设不会再次评估 el，但令我惊讶的是，el 评估得很好！

然后，确定它一定是某种缓存问题，我撤消了对 web.xml 的更改以重新创建问题。我重新部署了，但仍然对 el 进行了正确评估，即使 web.xml 有问题。然后我清理了我的整个项目（我正在使用展开的部署），吹走展开的目录并重新创建它。然后我重新启动了tomcat。尽管如此，尽管 web.xml 不好，el 似乎得到了正确的评估。

终于让我明白了。我只是在 JSP 中的某个地方添加了一个空格，重新打包它，然后刷新了页面。答对了！现在 el 没有得到评估。

所以问题出*在*web.xml 上。除非 JSP 发生更改，否则不会重新编译，这会使情况变得更加复杂。不确定 tomcat 是否使用 MD5 和来决定是否需要重新编译 JSP 或什么。另一种可能性是我正在使用瓷砖，我知道它有一个缓存机制，但我不希望它能够在 tomcat 重新启动后继续存在。

无论如何，除非您在修复 web.xml 之后修改您的 JSP，否则关于 EL 是否会再次开始工作的所有赌注都将失败。希望这可以避免其他人头疼。如果有人能告诉我是tomcat没有重新编译JSP还是缓存JSP的输出，我也很感兴趣。我很确定这是重新编译，因为在编译时 JSP 必须弄清楚如何处理 ${} el 表达式，对吧？Tiles 不能真正缓存被替换到 el 表达式中的内容，否则会出现各种问题。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2014-08-18T22:01:14.957

这是导致问题的 web.xml 中的标头

下面的 maven 生成的标头会阻止 EL 被评估。

```
<!DOCTYPE web-app PUBLIC
"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
"http://java.sun.com/dtd/web-app_2_3.dtd" >
<web-app> 
```

使用下面的标头 eval 的 EL。

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" 
xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"> 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-01-11T10:09:35.440

确保在 web.xml 中包含相关的名称空间。只是尝试更换

```
<web-app> 
```

有类似的东西

```
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
                      http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
  version="3.0"
  metadata-complete="true"> 
```

它为我修好了。您可以在 Tomcat 安装附带的示例应用程序中为您的 Tomcat 实例找到正确的命名空间。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-11-18T15:00:18.477

对于那些感兴趣的人，JSP 2.0 的等效 XML 语法是：

```
<jsp:directive.page isELIgnored="false"/> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-03T13:04:48.910

与凯文有类似的问题，我使用 maven 开始使用 webapp，但对 jsp 中的表达式求值并不满意 - 我不得不删除 DOCTYPE 标头 - 现在一切都很好，无需使用 isELIgnored 位 - maven 生成链接到 2.3 的 web.xml正如彼得所说，默认情况下禁用了 EL

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T15:21:51.023

出于可能的原因，请参阅我在[Javascript String.replace(/\$/,str) 中的答案在 jsp 文件中奇怪地工作。](https://stackoverflow.com/questions/472500/javascript-string-replace-str-works-weirdly-in-jsp-file/472573#472573)

更长的答案： ${i} 是所谓的“表达语言”中的表达。有时，可以禁用表达式语言。有关潜在原因以及如何启用它的方法，请参见上述答案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-23T08:50:36.267

使用tomcat6。它不需要在 web.xml 中对 EL 进行任何配置。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-04-11T10:25:30.243

从控制器：

```
@RequestMapping(value = "createcustomer",method = RequestMethod.GET)
    public String customer(Model model)
    {
        Customer cus=new Customer();
        cus.setCustomerNumber("Test");
        model.addAttribute("customer",cus);
        return "createcustomer";
    } 
```

在视图中：

```
<%@taglib uri="http://www.springframework.org/tags/form" prefix="form" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jstl/core" %> 

<div class="cl">    
   <form:form commandName="customer" method="POST">

      <p>Name: <c:out value="${customer.CustomerNumber}"></c:out></p>

   </form:form>
<div> 
```

输出：

```
Name: Test 
```

# asp.net - 从 ASP.NET 应用程序使用 Oracle 6

> ID：793988
> 
> 赞同：0
> 
> 时间：2009-04-27T15:15:34.453
> 
> 标签：asp.net, oracle, oracleclient

我有一个 ASP.NET 2.0 Web 应用程序。它使用 "System.Data.OracleClient, Version=2.0.0.0" 来访问 oracle 数据库。我在连接时遇到以下异常： *System.Data.OracleClient 需要 Oracle 客户端软件版本 8.1.7 或更高版本。* 我查了一下，发现有几篇文章/帖子说该错误具有误导性，并且是由 ASP.NET 用户尝试访问 oracle HOME 文件夹的一些安全问题引起的。但是在我的情况下，我客户的 oracle 客户端确实比 8.1.7 旧。事实上它是第6版！我知道这已经很老了，但你明白这不能改变。我还有什么其他选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T22:40:12.827

您可能会将 Oracle Forms 版本编号与 Oracle 数据库服务器编号混淆。Oracle 服务器版本 6 早在 88 年发布，我怀疑它是否会在任何当前操作系统下运行。我记得 Oracle Forms 6.0 是更新的（可能是十年前的）并且在 Windows XP 上运行得非常愉快。

也就是说，Forms 6.0 会使用仍然会出现问题的 SQL*net 8.0 客户端。如果你在命令行输入 tnsping，那可能会给你一个版本号。

您可以从 oracle 网站下载（免费）InstantClient。这可以与另一个 Oracle 客户端在同一台机器上解压缩。您可能需要对路径设置进行一些操作，以确保 .Net 拾取正确的客户端

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T15:38:22.013

找另一份工作？说真的，第6版？！

我认为您最好建议转换为 MySQL（它是免费的）。这只是为什么你的软件至少应该来自当前十年的一个例子。你只是不会找到支持旧东西的软件。你的客户会发现越来越难找到对它有任何了解（或想要）的人，他们会为此付出越来越多的钱。他们要花多少钱来解决这个问题？下一个呢？我认为你应该为你的客户提出一个非常有力的理由来以某种方式升级。

祝你好运...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T16:06:07.873

您可以尝试安装 .Net 支持的更新版本的 Oracle，并为您当前的安装创建一个[数据库链接。](http://download.oracle.com/docs/cd/B28359_01/server.111/b28310/ds_concepts002.htm)

# .net - SQL/.NET TableAdapters - 如何在数据库或数据集中强类型计算列？

> ID：793993
> 
> 赞同：2
> 
> 时间：2009-04-27T15:17:20.627
> 
> 标签：.net, sql-server, dataset, strongly-typed-dataset, calculated-columns

我们在一些 SQL Server 2005 表中使用计算列，这些表总是返回特定类型的数据（位、varchar(50) 等...）。

这些表由使用强类型数据集和表适配器的 .NET 数据层使用，但是由于计算的列不受特定类型的限制（我们总是返回特定类型，但我们可以返回任何内容）.NET 不会强生成类型的列。

这里有三个问题： - 计算列通常检查相关记录是否具有特定值，或者它们使用 XPath 从相关 XML 文档返回单个值。计算列是否是适合此问题的工具，还是有更好的方法来返回这些相关数据？

*   我的搜索说不，但是否可以在数据库本身对这些列进行强类型化？

*   Visual Studio DataSet 设计器内部是否有一种解决方法，可以让我设置正确的类型**并在 DataSet/TableAdapter 更新中维护它们**（因为设计器将查询数据库以更新其架构）？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T15:20:10.370

在用于返回这些值的查询中，可以使用 SQL CAST() 函数将它们转换为所需的任何数据类型。我相信 .NET 应该识别强制转换的数据类型并将该类型放入数据集中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T15:56:40.033

首先，它们确实有一个类型。

其次，如果客户端请求它，SQL Server 将告诉客户端类型，它是 C API 客户端、C# 客户端、JDBC 客户端等。否则，客户端无法正确识别类型。

第三，您可以通过查看计算列的 information_schema.columns（或 syscolumns）行来找出它们的类型。

第四，您可以使用 CAST 运算符将这些列强制转换为与其实际类型兼容的任何类型。

# c# - 在 C# 中自定义绘制 MapPoint 地图？

> ID：793999
> 
> 赞同：6
> 
> 时间：2009-04-27T15:19:02.713
> 
> 标签：c#, wpf, mappoint

我的应用程序需要在驱动器上的地图，因为在操作期间将无法访问互联网。我已经决定使用 MapPoint 2009，但地图的“风格”确实与我的整体 UI 外观和感觉发生了冲突。

我想知道是否有某种方法可以自定义绘制地图上的所有内容（道路、标签等）？我突然想到 MapPoint 应用程序本身可能有一些主题，但我现在不方便:(

我完全更喜欢 WPF 方法，但实际上，此时任何事情都有帮助:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T15:23:22.033

不，基本上。您最多可以添加图钉、线条、形状等。有一个 usenet 论坛 (microsoft.public.mappoint) 可能有更多，但我几乎可以保证答案是“否”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T15:24:13.013

我不相信 MapPoint COM API 公开了任何覆盖默认渲染的方法。您可以在顶部添加自己的对象（通过形状等），但我不相信它会完全满足您的要求。

我所知道的唯一可以做到这一点的 C# 映射框架是[SharpMap v2](http://sharpmap.codeplex.com/Wiki/View.aspx?title=SharpMap%20v2)。除了当前的 GDI+ 之外，计划还提供 WPF 渲染堆栈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-24T15:30:23.370

唯一可用的地图样式是那些通过 GUI 可用的样式。例如。有夜景等。标签字体大小也可以改变

MapPoint 2010 在显示内容方面添加了一些额外的样式。每个要素类（河流、大城市、中型城市、州际公路等）都可以关闭/正常/全部。除了字体大小和一般主题外，这些设置还可以通过 API 进行控制。**********