# StackOverflow 问答 11346000-11346999

# .net - HostProtectionAttribute.Synchronization。抽象类

> ID：11346000
> 
> 赞同：1
> 
> 时间：2012-07-05T14:04:39.123
> 
> 标签：.net, synchronization, thread-safety

我想知道这个属性。当父抽象类用这个属性装饰时，派生类如何是线程安全的。这里使用了什么样的底层机制？这是否意味着重写抽象方法也会使该方法成为线程安全的？！

# python - 比较两个日期时间并获得日差

> ID：11346002
> 
> 赞同：0
> 
> 时间：2012-07-05T14:04:45.300
> 
> 标签：python

我有一系列日期。我将数组 (B) 的对象与控件 (A) 进行比较。与 A 相比，我如何检查 B 的年龄是否为 10 天？理想情况下，我希望能够将变量声明为天数差异。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T14:06:59.790

此 Python 代码模板将以天为单位计算差异：

```
import datetime
d1 = datetime.datetime(2012, 7, 1)
d2 = datetime.datetime(2012, 7, 5)
diff = d2 - d1
print diff.days 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T14:06:17.047

两个`datetime.datetime`对象的差异是一个`datetime.timedelta`对象。它的`.days`属性以天为单位为您提供长度。

# java - 如何将 Project Explorer 视图添加到 Eclipse RCP 应用程序

> ID：11346006
> 
> 赞同：3
> 
> 时间：2012-07-05T14:05:03.310
> 
> 标签：java, eclipse, project, rcp, explorer

有人可以详细告诉我如何在我的 RCP 中实现项目浏览器视图吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T11:45:13.823

不幸的是，我还不能评论其他人。不要搜索源文件，请在 IDE 中打开项目资源管理器视图并使用 Alt+Shift+F1（对于按钮或菜单条目，它是 Alt+Shift+F2）以节省一些精力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T18:26:35.143

使用这个很棒的[教程](http://www.vogella.com/articles/EclipseRCP/article.html#viewtutorial_perspective)以您的视角展示任何视图。剩下的就是找出 Project Explorer View 的 id。您将需要向包含 Project Explorer View 的插件添加依赖项，并且可能随后需要一些用户插件。使用插件依赖项页面检查依赖项。要找出视图的 ID，您可以在 Eclipse Distribution 的插件目录中的 jar 文件中搜索“Project Explorer View”的出现。这样您就可以找到包含您正在寻找的扩展的插件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-11T19:57:15.873

好吧，我认为本教程可以帮助您：

[http://dirksmetric.wordpress.com/2012/08/01/tutorial-eclipse-rcp-e4-with-3-x-views-like-project-explorer-properties-etc/](http://dirksmetric.wordpress.com/2012/08/01/tutorial-eclipse-rcp-e4-with-3-x-views-like-project-explorer-properties-etc/)

# asp-classic - 使用经典asp提交表单和文件上传

> ID：11346010
> 
> 赞同：0
> 
> 时间：2012-07-05T14:05:13.430
> 
> 标签：asp-classic

> **可能重复：**
> [如何使用 asp-classic 上传文件](https://stackoverflow.com/questions/12190305/how-to-upload-files-with-asp-classic)

我有经典的 asp 表单，其中包含一些输入文本框和下拉菜单。它还有一个文件上传控件。所有输入都包含在我要上传文件并将数据提交到数据库的一种形式中。我可以一键单击使用经典 asp 进行数据库插入和文件上传吗？如何使用经典 asp 上传文件。我需要向表单元素添加一些属性吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:42:10.373

是的，您可以一键完成这两项操作，将数据保存到数据库并上传文件。您需要添加`enctype="multipart/form-data"`到您的表单标签。

上传文件有点小技巧，但它是可能的，你可以在这里看到它是如何完成的示例：

[http://www.freeaspupload.net/freeaspupload/viewsource.asp](http://www.freeaspupload.net/freeaspupload/viewsource.asp)

希望这可以帮助。

# python - 海龟模块没有属性颜色？

> ID：11346013
> 
> 赞同：3
> 
> 时间：2012-07-05T14:05:25.883
> 
> 标签：python, python-3.2, turtle-graphics

[当我尝试运行Python 文档中`turtle`](http://docs.python.org/py3k/library/turtle.html#module-turtle)的第一段示例代码时：

```
from turtle import *
color('red', 'yellow')
begin_fill()
while True:
    forward(200)
    left(170)
    if abs(pos()) < 1:
        break
end_fill()
done() 
```

我得到一个`NameError`：

> NameError：名称“颜色”未定义

调整`import`和手动指定模块也不起作用：

```
import turtle
turtle.color('red', 'yellow')
turtle.begin_fill()
while True:
    turtle.forward(200)
    turtle.left(170)
    if abs(turtle.pos()) < 1:
        break
turtle.end_fill()
turtle.done() 
```

根据文档，我正在使用 Python v3.2.3，它显然包含[`turtle.color`](http://docs.python.org/py3k/library/turtle.html#turtle.color)。Python 也安装了`tkinter`支持，因为`import tkinter`它也能正常工作。

完整的跟踪是：

```
Traceback (most recent call last):
  File "<path name that contains no spaces>/turtle.py", line 1, in <module>
    from turtle import *
  File "<path name that contains no spaces>\turtle.py", line 2, in <module>
    color('red', 'yellow')
NameError: name 'color' is not defined 
```

多么奇怪。如果我进入 shell，无论是命令行还是 IDLE，然后一次输入一个命令：

```
>>> from turtle import *
>>> color('red', 'yellow') 
```

没有问题。只有当我在 IDLE 中打开一个新窗口，输入所有命令并运行脚本时。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-05T16:29:01.900

您将文件命名为“turtle.py”，因此当您`import turtle`导入自己的文件而不是 stdlib 模块时。更改程序的名称，并删除该目录中的所有 .pyc 文件。

# objective-c - 什么时候类别是坏的/危险的？

> ID：11346020
> 
> 赞同：1
> 
> 时间：2012-07-05T14:05:58.670
> 
> 标签：objective-c, objective-c-category

我在 Core Data 中使用类别。我读过的一些教程和听过的讲座说，类别通常被认为是“坏”的做法。但是因为 Objective-C 是如此动态，所以在其他地方定义方法似乎完全没问题，特别是因为只能使用类的公共属性。使用类别时我应该注意哪些陷阱？或者有什么理由认为类别实际上是不好的做法？我将它们与 Core Data 一起使用的原因是我每次重新生成子类时都不必重写我的附加方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T14:13:36.173

我能想到的唯一“危险”是当您使用它们来替换原始类中的方法而不是子类化时。

这样做时，您将失去访问原始实现的能力，因为它通常是您要覆盖的私有方法，因此可能会产生无法预料的影响。

使用类别向特定类的任何对象添加*额外的*方法是很棒的，而且正是它们的用途。正如您所做的那样，将它们用于核心数据很好，因为它确实允许您更改模型并重新生成“vanilla”对象，而不会破坏任何额外的代码。

向@CodaFi 致敬，以获取来自苹果的这一点文档：

> 尽管 Objective-C 语言目前允许您使用类别来覆盖类继承的方法，甚至是类接口中声明的方法，但强烈建议您不要这样做。类别不能替代子类。使用类别来覆盖方法有几个明显的缺点：
> 
> 当一个类别覆盖一个继承的方法时，该类别中的方法可以像往常一样通过消息调用继承的实现给super。但是，如果一个类别覆盖了该类别的类中存在的方法，则无法调用原始实现。
> 
> 一个类别不能可靠地覆盖在同一类的另一个类别中声明的方法。
> 
> 这个问题特别重要，因为许多 Cocoa 类是使用类别实现的。您尝试覆盖的框架定义的方法本身可能已经在一个类别中实现，因此没有定义哪个实现优先。
> 
> 某些类别方法的存在可能会导致所有框架的行为发生变化。例如，如果您在 NSObject 的一个类别中覆盖 windowWillClose: 委托方法，那么您程序中的所有窗口委托都会使用该类别方法进行响应；您的所有 NSWindow 实例的行为可能会改变。您在框架类上添加的类别可能会导致行为的神秘变化并导致崩溃。

# javascript - JSON 排序问题

> ID：11346024
> 
> 赞同：1
> 
> 时间：2012-07-05T14:06:02.710
> 
> 标签：javascript, json, sorting

我有一个 JSON 对象，如下所示：

```
{"Data": {
     "290": {
             ...
            }
     "300": {
             ...
            }
     "281": {
             ...
            }
         }
 } 
```

我将如何根据顶级容器键（即“290”、“300”、“281”）对这个 JSON 进行排序？

编辑：所以我用

`$.getJSON('current/csf.txt', function(data) { arr = data["Data"]; }`

它根据密钥对它们进行排序。为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T14:07:43.257

你已经标记了这个“JavaScript”，所以我假设你的意思是“从这个 JSON 生成的 JavaScript 对象”。

在这种情况下：

1.  循环遍历属性名称（使用`for in`循环）。
2.  使用它们来填充数组。
3.  对数组进行排序。
4.  将数组用作地图。

（您不能将有序数据存储在对象中）。

如果要将结果存储在 JSON 中，则需要更改数据结构（并使用（对象）数组）。对象是明确无序的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T14:10:54.740

你的结构是错误的，它应该是这样的：

```
{
  "Data": [
    {
      "id": "290"
    },
    {
      "id": "300"
    },
    {
      "id": "282"
    }
  ]
} 
```

对象用于无序数据。对有序数据使用数组。数组在这里很容易排序：

```
obj.Data.sort(function(a,b){
    return a.id - b.id;
}); 
```

您可以像这样转换为这种结构：

```
 function copyProps(dest, src) {
     for (var key in src) {
         dest[key] = src[key];
     }
     return dest;
 }

 var newData = [];

 for (var key in obj.Data) {
     newData.push(copyProps({
         id: key
     }, obj.Data[key]));
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:08:33.613

我同意 Amberlamps 的评论，你不应该尝试对对象的键进行排序，*但*如果你出于某种原因想要这样做，你可以看看[underscore.js 的 sortBy 方法](http://underscorejs.org/#sortBy)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T14:12:28.640

即使您可以对对象属性进行排序，也不能保证您可以按排序顺序读回它们。在 Javascript 中，对象属性不是按特定顺序存储的；一个对象只是具有属性。

您不能使用数组索引符号来访问对象属性，因此按键对对象属性进行排序的概念没有实际意义。

# asp.net - 关于 ASP.NET TextBox 控件的 TextChanged 属性和 AutoPostBack 属性之间的区别

> ID：11346025
> 
> 赞同：0
> 
> 时间：2012-07-05T14:06:04.253
> 
> 标签：asp.net

我正在阅读教科书“Sams ASP.NET 4 unleashed”，我对 ASP.NET TextBox 控件的 TextChanged 属性和 AutoPostBack 属性之间的区别感到困惑。

该书将这两个属性解释为：

> AutoPostBack - 使您能够在 TextBox 的内容发生更改时将包含 TextBox 的表单自动发送回服务器。

然后，

> TextChanged - 当文本框的内容发生更改时在服务器上引发。

然后继续解释：

> 当 AutoPostBack 属性的值为 True 时，包含 TextBox 的表单会在 TextBox 的内容发生更改时自动回发到服务器。如果您修改了文本框的内容并从 TextBox 控件中跳出选项卡，则表单会自动发送回服务器，并显示 TextBox 的内容。

让我感到困惑的是这一行：

> 即使不使用 AutoPostBack 属性，也可以处理 TextChanged 事件。

那么，Autopostback 属性和 textchanged 属性之间的区别是什么导致页面再次发布到服务器？还是这两种方法的工作方式彼此不同？我很困惑..请帮助我更好地理解它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T14:08:24.050

> 即使不使用 AutoPostBack 属性，也可以处理 TextChanged 事件。

是的，这是真的。`TextChanged` 即使事件没有立即回发，您也可以在下次往返服务器时处理该事件。

*   因此，当您处理事件并`AutoPostBack`设置为`true`时，回发将立即发生并引发 TextChanged 事件。
*   当`AutoPostBack`设置为 时`false`，您可以在下一次回发时处理该事件（fe a button-click）

> Autopostback 属性和 textchanged 属性之间的区别是什么**导致页面再次发布到服务器**？

所以粗体印刷是完全错误的。不同之处在于一个控制回发行为，另一个注册一个事件处理程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:34:00.543

当回发完成并定向到自身页面时，将引发 TextChanged。加载循环后引发此事件。这意味着 TextChanged 在两个回发之间上升。

AutoPostBack 属性正在激活回发，当文本框的内容发生更改并从该文本框中聚焦时。回发发生后，页面被定向到自己。然后再次引发加载循环 TextChanged 事件。

TextChanged 也是一个“事件”而不是属性。

# json - 如何在 Spring Interceptor 中处理 JSON 并修改请求？

> ID：11346029
> 
> 赞同：1
> 
> 时间：2012-07-05T14:06:16.657
> 
> 标签：json, spring, spring-mvc, interceptor

我有一个使用 Spring 的 REST API。我创建了一个拦截器：

```
@Component
public class CSRFInterceptor extends HandlerInterceptorAdapter {
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {

        // code here

        return true;
    }
} 
```

发出的每个请求都使用带有以下相应 Java 类的 JSON：

```
public class CSRFTokenContainer<T> {
    private T data;
    private String csrf;

    public T getData() {
        return data;
    }
    public void setData(T data) {
        this.data = data;
    }
    public String getCsrf() {
        return csrf;
    }
    public void setCsrf(String csrf) {
        this.csrf = csrf;
    }
} 
```

在我的控制器中，使用例如：

```
@Controller
@RequestMapping("/persons")
public class PersonController {

    @RequestMapping(method=RequestMethod.POST)
    public @ResponseBody String create(@RequestBody CSRFTokenContainer<Person> account, HttpServletResponse response) {

        // do something

        return "test";
    }
} 
```

现在我想做以下事情：控制器应该只接收没有 CSRF 令牌的 Person 对象。CSRF 令牌应该在拦截器内部进行处理。我怎样才能做到这一点？我认为主要问题是，我不知道如何在 Interceptor 中获取我的 CSRFTokenContainer 对象。之后，我想将请求修改为仅包含“数据”部分。

一些代码示例会很好。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:49:11.340

我已经通过这种方式解决了 CSRF 问题：

我在服务器端创建令牌并通过 JSP 将其放置在 GWT 主机页面中。令牌也存储在 Session 中：

我的页面.jsp：

```
<%@taglib prefix="t" uri="myTags" %>
<!doctype html>
<html>
    <head>
        ...
        <script>
            <t:csrfToken />
        </script>
        ...
    </head>
    ...
</html> 
```

myTags.tld:

```
<?xml version="1.0" encoding="UTF-8"?>
<taglib xsi:schemaLocation="
    http://java.sun.com/xml/ns/javaee 
    http://java.sun.com/xml/ns/javaee/web-jsptaglibrary_2_1.xsd"
    xmlns="http://java.sun.com/xml/ns/javaee" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    version="2.1">

    <tlib-version>1.0</tlib-version>
    <short-name>t</short-name>
    <uri>myTags</uri>

    <tag> 
        <name>csrfToken</name> 
        <tag-class>myapp.server.jsp.CSRFTokenTag</tag-class>
        <body-content>empty</body-content>
    </tag>  
</taglib> 
```

CSRFToken标签：

```
public class CSRFTokenTag extends TagSupport {
    private final SecureRandom random = new SecureRandom();

    private String generateToken() {
        final byte[] bytes = new byte[32];
        random.nextBytes(bytes);
        return Base64.encode(bytes);
    }

    @Override
    public int doStartTag() throws JspException {
        String token = generateToken();

        try {
            pageContext.getOut().write("var " + "myCSRFVarName" + " = \"" + token + "\";");
        } catch (IOException e) {}

        pageContext.getSession().setAttribute("csrfTokenSessionAttributeName", token);

        return SKIP_BODY;
    }

    @Override
    public int doEndTag() throws JspException {
        return EVAL_PAGE;
    }
} 
```

GWT 通过 JSNI 读取令牌：

```
public class CSRFToken {
    private native static String get()/*-{
        return $wnd["myCSRFVarName"];
    }-*/;
} 
```

对于每个请求，Web 应用程序都会在自定义 HTTP 标头中发送令牌，例如：

```
RequestBuilder rb = new RequestBuilder(RequestBuilder.GET, "/rest/persons");
rb.setHeader("myCSRFTokenHeader", CSRFToken.get());
rb.setRequestData("someData");
rb.setCallback(new RequestCallback() {
    @Override
    public void onResponseReceived(Request request, Response response) {
        // ...
    }
    @Override
    public void onError(Request request, Throwable exception) {
        // ...
    }
});
rb.send(); 
```

在 Spring 中，我创建了一个拦截器，它为每个请求从提交的标头中读取令牌并检查它：

```
@Component
public class CSRFInterceptor extends HandlerInterceptorAdapter {    
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
        String sessionCSRFToken = (String) request.getSession().getAttribute("csrfTokenSessionAttributeName");

        if(sessionCSRFToken != null && sessionCSRFToken.equals(request.getHeader("myCSRFTokenHeader"))) {
            return true;
        } else {
            response.sendError(HttpServletResponse.SC_UNAUTHORIZED, "Authentication required");
            return false;
        }
    }
} 
```

它可能并不完美，但它似乎工作得很好！

# objective-c - Objective-C 和 Objective-C++ 中静态成员的定义

> ID：11346035
> 
> 赞同：6
> 
> 时间：2012-07-05T14:06:40.390
> 
> 标签：objective-c, static, compilation, objective-c++, redefinition

我在编译objective-c源和objective-c++源时有区别。

这里是 test.h 中 Class1 和 Class2 的声明：

```
#import <Foundation/Foundation.h>

@interface Class1 {
}
@end

@interface Class2 {
}
@end 
```

现在，这是 test.m 中的 Objective-C 实现：

```
#import "test.h"

@implementation Class1
/* static member */
static int mystatic;
@end

@implementation Class2
/* static member */
static int mystatic;
@end 
```

我用这个命令成功编译：

```
gcc -arch armv6 -isysroot /Developer/.../iPhoneOS5.0.sdk -x objective-c -c test.m 
```

现在我完全使用了这个 Objective-C++ 实现 test.mm （完全相同的来源）：

```
#import "test.h"

@implementation Class1
/* static member */
static int mystatic;
@end

@implementation Class2
/* static member */
static int mystatic;
@end 
```

并使用此命令行编译（-x 选项不同）：

```
gcc -arch armv6 -isysroot /Developer/.../iPhoneOS5.0.sdk -x objective-c++ -c test.mm 
```

但我得到一个错误：

```
test.mm:11 error: redefinition if 'int mystatic' 
```

为什么我在 ObjC++ 而不是 ObjC 中得到这个错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T14:19:53.760

这归结为C和C++之间的区别。在 C 中，可以重新定义具有相同名称和相同类型的静态变量；在 C++ 中，这样做是错误的。

来自 C 标准：

> 具有文件范围的对象的标识符声明没有初始化程序，并且没有存储类说明符或具有存储类说明符 static，构成暂定定义。**如果翻译单元包含一个或多个标识符的暂定定义，并且翻译单元不包含该标识符的外部定义，则行为与翻译单元包含该标识符的文件范围声明完全相同，复合类型为翻译单元的末尾，初始化器等于 0。**

从 C++ 标准：

> C.1.2, 3.1 更改：**C++ 没有 C 中的“暂定定义”**。例如，在文件范围内，

```
int i ;
int i ; 
```

> 在 C 中有效，但在 C++ 中无效。

就 Objective C 而言，该语言不支持在类级别作用域的变量；`static int mystatic;`在块内声明`@implementation`与在块外声明它的效果完全相同`@implementation`。要模拟类范围的变量，请在类方法中使用函数范围的静态变量。

# javascript - 如何在javascript中重定向到同一窗口中的另一个页面

> ID：11346036
> 
> 赞同：0
> 
> 时间：2012-07-05T14:06:41.577
> 
> 标签：javascript

我正在创建一个应用程序，我在其中使用图像转换幻灯片。在图像幻灯片中，我使用超链接转到另一页。但页面在新窗口中打开。我想在同一个窗口中打开页面。

```
flashyslideshow.prototype.getSlideHTML=function (index) {
    var slideHTML= (this.imagearray[index][1])?'<a href=  "' + this.imagearray[index][1]+'" target = "'+this.imagearray[index][2]+ "_self" '">\n' : ''; //hyperlink slide?
    slideHTML+='<img src="'+this.imagearray[index][0]+'" height="550" width="100%" >';
    slideHTML+=(this.imagearray[index][1])? '</a><br />' : '<br />';
    slideHTML+=(this.imagearray[index][3])? '<font face="bookman old style" color="blue" size="3">' + this.imagearray[index][3] : ''; //text description?
    return slideHTML; //return HTML for the slide at the specified index
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:12:00.717

在您的`<a>`标签内，添加

```
target="_self" 
```

这会强制链接在同一窗口中打开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:19:47.810

```
<a href="www.google.com" target="_self">Google</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-29T07:59:50.860

您可以通过确保目标为空来实现这一点，就像这样

```
<form id="form" method="post" action="index.html"> 
```

# android - 传递到下一个活动时 Parcelable 中的 Android 问题

> ID：11346037
> 
> 赞同：3
> 
> 时间：2012-07-05T14:06:42.397
> 
> 标签：android, serialization, parcelable

我正在尝试将我自己的***消息类***从活动传递到另一个活动，因为我正在使用 parcelable。在尝试通过捆绑包时

## Activity1 - 传递捆绑包

```
Intent i = new Intent(getApplicationContext(), Activity2.class);
Bundle b=new Bundle();
b.putParcelable("FolderList", mainMP3List)); //***mainMP3List is MusicFolder object***
i.putExtras(b);
startActivityForResult(i, 100); 
```

* * *

## Activity2 - 获取捆绑包

```
if(b.containsKey("FolderList"))
mainMP3List = b.getParcelable("FolderList");//Error is the here (readBundle: bad magic number) 
```

我无法从第二个活动中访问它们我收到了这个错误

**Bundle : readBundle: 坏幻数**

```
import java.util.ArrayList;

import android.os.Bundle;
import android.os.Parcel;
import android.os.Parcelable;

public class MusicFolder implements Parcelable{

private ArrayList<SongsNameList> songsList=new ArrayList<SongsNameList>();  
private ArrayList<MusicFolder> listOfFolders=new ArrayList<MusicFolder>();

public ArrayList<SongsNameList> getSongsList() {
    return songsList;
}

public void addSongInList(SongsNameList song) {
    this.songsList.add(song);
}

public ArrayList<MusicFolder> getListOfFolders() {
    return listOfFolders;
}
public void addFolderInList(MusicFolder folder) {
    this.listOfFolders.add(folder);
}

@Override
public int describeContents() {
    return 0;
}

@Override
public void writeToParcel(Parcel dest, int flags) {
    //dest.writeString(category);
    Bundle b = new Bundle();
    b.putParcelableArrayList("songs", songsList);
    b.putParcelableArrayList("folders", listOfFolders);
    dest.writeBundle(b);

}

public static final Parcelable.Creator<MusicFolder> CREATOR = 
        new Parcelable.Creator<MusicFolder>() { 
    public MusicFolder createFromParcel(Parcel in) { 
        MusicFolder category = new MusicFolder();
        //category.listOfFolders = in.readString();
        Bundle b1 = in.readBundle(SongsNameList.class.getClassLoader());        
        category.songsList = b1.getParcelableArrayList("songs");

        Bundle b2 = in.readBundle(MusicFolder.class.getClassLoader());        
        category.listOfFolders = b2.getParcelableArrayList("folders");

        return category;
    }

    @Override
    public MusicFolder[] newArray(int size) {
        return new MusicFolder[size];
    }
};

  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:48:59.607

没有测试过，但我认为不是：

```
 Bundle b1 = in.readBundle(SongsNameList.class.getClassLoader());        
    category.songsList = b1.getParcelableArrayList("songs");

    Bundle b2 = in.readBundle(MusicFolder.class.getClassLoader());        
    category.listOfFolders = b2.getParcelableArrayList("folders"); 
```

应该是这样的：

```
 Bundle b = in.readBundle(SongsNameList.class.getClassLoader());        
    category.songsList = b.getParcelableArrayList("songs");
    category.listOfFolders = b.getParcelableArrayList("folders"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:13:19.353

这可能是由于您以特定顺序将值/类型写入 Parcelable 并以不同顺序读取它（违反了您的数据边界之一）。

检查您的保存/加载顺序，如果您没有看到问题，请发布适用于您的`Parcelable`实施的代码，供我们查看。

# hibernate - 如何将 struts2 与 Hibernate 集成

> ID：11346039
> 
> 赞同：0
> 
> 时间：2012-07-05T14:06:53.143
> 
> 标签：hibernate

我在将 struts2 与 Hibernate 集成时陷入困境。

我正在使用 netbeans 7.1.2

我有一个非常简单的 Java EE 项目，它显示 Derby (Java DB) 数据库中表“QUESTION”的所有行。我已经制作了表格并将其映射到 hibernate.cfg.xml 文件。

但是当我右键单击并转到“运行 HQL 查询”并执行查询时

“来自问题”，我收到以下错误：

```
org.hibernate.exception.SQLGrammarException: could not execute query
    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:67)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)
    at org.hibernate.loader.Loader.doList(Loader.java:2223)
    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2104)
    at org.hibernate.loader.Loader.list(Loader.java:2099)
    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:378)
    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:338)
    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:172)
    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1121)
    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:79)
Caused by: java.sql.SQLSyntaxErrorException: Table/View 'RAMBO.QUESTION' does not exist.
    at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)
    at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)
    at org.apache.derby.client.am.Connection.prepareStatement(Unknown Source)
    at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:505)
    at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:423)
    at org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:139)
    at org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1547)
    at org.hibernate.loader.Loader.doQuery(Loader.java:673)
    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236)
    at org.hibernate.loader.Loader.doList(Loader.java:2220)
    ... 9 more
Caused by: org.apache.derby.client.am.SqlException: Table/View 'RAMBO.QUESTION' does not exist.
    at org.apache.derby.client.am.Statement.completeSqlca(Unknown Source)
    at org.apache.derby.client.net.NetStatementReply.parsePrepareError(Unknown Source)
    at org.apache.derby.client.net.NetStatementReply.parsePRPSQLSTTreply(Unknown Source)
    at org.apache.derby.client.net.NetStatementReply.readPrepareDescribeOutput(Unknown Source)
    at org.apache.derby.client.net.StatementReply.readPrepareDescribeOutput(Unknown Source)
    at org.apache.derby.client.net.NetStatement.readPrepareDescribeOutput_(Unknown Source)
    at org.apache.derby.client.am.Statement.readPrepareDescribeOutput(Unknown Source)
    at org.apache.derby.client.am.PreparedStatement.readPrepareDescribeInputOutput(Unknown Source)
    at org.apache.derby.client.am.PreparedStatement.flowPrepareDescribeInputOutput(Unknown Source)
    at org.apache.derby.client.am.PreparedStatement.prepare(Unknown Source)
    at org.apache.derby.client.am.Connection.prepareStatementX(Unknown Source)
    ... 17 more 
```

我的 Hibernate.cfg.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
  <session-factory>
    <property name="hibernate.dialect">org.hibernate.dialect.DerbyDialect</property>
    <property name="hibernate.connection.driver_class">org.apache.derby.jdbc.ClientDriver</property>
    <property name="hibernate.connection.url">jdbc:derby://localhost:1527/Q4U</property>
    <property name="hibernate.connection.username">rambo</property>
    <property name="hibernate.connection.password">ho</property>
    <property name="hibernate.current_session_context_class">thread</property>
    <mapping resource="hibernate.hbm.xml"/>
    <mapping/>
  </session-factory>
</hibernate-configuration> 
```

我的 Hibernate.hbm.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <class name="beans.Question" table="RAMBO.QUESTION">
        <id name="qid" type="java.lang.Integer">
            <column name="QID" />
            <generator class="increment" />
        </id>
        <property name="opc" type="java.lang.Integer">
            <column name="OPC" not-null="true"/>
        </property>
        <property name="uid" type="java.lang.Integer">
            <column name="UID" not-null="true"/>
        </property>
        <property name="cid" type="java.lang.Integer">
            <column name="CID" not-null="true"/>
        </property>
        <property name="abuse" type="java.lang.Integer">
            <column name="ABUSE" not-null="true"/>
        </property>
        <property name="accuracy" type="java.lang.Float">
            <column name="ACCURACY" not-null="true"/>
        </property>
        <property name="poston" type="java.util.Date">
            <column name="POSTON" not-null="true"/>
        </property>
        <property name="body" type="java.lang.String">
            <column name="BODY" not-null="true"/>
        </property>
        <property name="op1" type="java.lang.String">
            <column name="OP1" not-null="true"/>
        </property>
        <property name="op2" type="java.lang.String">
            <column name="OP2" not-null="true"/>
        </property>
        <property name="op3" type="java.lang.String">
            <column name="OP3" not-null="true"/>
        </property>
        <property name="op4" type="java.lang.String">
            <column name="OP4" not-null="true"/>
        </property>
        <property name="op5" type="java.lang.String">
            <column name="OP5" not-null="true"/>
        </property>
        <property name="cname" type="java.lang.String">
            <column name="CNAME" not-null="true"/>
        </property>
    </class> 
</hibernate-mapping> 
```

Hibernate.reveng.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-reverse-engineering PUBLIC "-//Hibernate/Hibernate Reverse Engineering DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-reverse-engineering-3.0.dtd">
<hibernate-reverse-engineering>
  <schema-selection match-schema="RAMBO"/>
  <table-filter match-name="USERS"/>
  <table-filter match-name="CATEGORY"/>
  <table-filter match-name="TESTS"/>
  <table-filter match-name="INBOX"/>
  <table-filter match-name="QUESTION"/>
  <table-filter match-name="ADMIN"/>
</hibernate-reverse-engineering> 
```

问题.java

```
package beans;

import java.io.Serializable;
import java.util.Date;

public class Question implements Serializable {

    int qid, opc, uid, cid, abuse;
    float accuracy;
    Date poston;
    String body, op1, op2, op3, op4, op5, cname;

    // Also public getters and setters
} 
```

查找问题.java

```
package controller;

import beans.Question;
import com.opensymphony.xwork2.ActionSupport;
import java.util.ArrayList;
import java.util.List;
import org.hibernate.Session;

public class FindQuestion extends ActionSupport {

    private List questionList = new ArrayList();

    @Override
    public String execute() throws Exception {
        try {
            Session session = HibernateUtil.getSessionFactory().getCurrentSession();
            session.beginTransaction();
            this.questionList = (List<Question>) session.createQuery("from Question");
            session.getTransaction().commit();
        } catch (Exception e) {
        }
        return SUCCESS;
    }

} 
```

# regex - 正则表达式：在字符串“elem1/elem2@attr”中捕获 3 个组

> ID：11346040
> 
> 赞同：0
> 
> 时间：2012-07-05T14:06:53.463
> 
> 标签：regex

这是正则表达式的简单工作。我正在研究基于此模型构建的字符串：（`elem1/elem2@attr`由单词字符组成，`/`并`@`用作分隔符）。

我试图捕获 3 个部分 : `elem1/`, `elem2`, `@attr`, 知道有效的字符串可以省略 3 个部分中的任何一个（但必须遵守分隔符顺序）。

我想出了这个正则表达式：

```
^(\w+\/)?(\w+)?(@\w+?)$ 
```

但它只有在最后一部分`@attr`存在时才有效。我需要一个也匹配这些字符串的解决方案：`elem1/`,, `elem2`.`elem1/elem2`

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:12:40.070

你输了`?`=) 使用正则表达式：

```
^(\w+\/)?(\w+)?(@\w+?)?$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:15:46.857

你的正则表达式应该是`^(\w+\/)?(\w+)?(@\w+)?$`

# javascript - 管理 Backbone.js 页面转换

> ID：11346043
> 
> 赞同：1
> 
> 时间：2012-07-05T14:06:59.923
> 
> 标签：javascript, backbone.js

我知道这是一个非常普遍讨论的话题，但我找不到任何能准确回答我的问题的东西:)

我目前正在开发一个 Backbone.js 项目。路由器方面，我不会在路由器中实例化视图、模型或集合，而只是将路由器用作处理状态的一种方式——路由器调用我的自定义控制器对象上的方法。

然后我的控制器为索引、显示等实例化不同的视图、模型和集合。这一切都很好。

我只是在如何处理页面转换方面有点挣扎。我已经阅读了所有关于管理僵尸等的精彩文章，并且知道无论发生什么我都必须有一些旧视图的清理系统（我目前正在使用 Derick Bailey 博客中提到的 .close() 方法）。

如果我要从#show 到#index，或任何其他路线**更改**，我知道只实例化新的、新鲜的视图、模型等是有意义的——这几乎是我在每个教程中看到的。当然，确保清理旧的。

但是，如果我已经在#show 上说，并且我路由到另一个#show 页面，那么我想要的所有视图等都已经实例化和呈现。我只想更改模型和集合的数据。

所以我想我的问题是为什么我看不到人们重用视图的频率很高。在我的脑海中，我在想如果你已经在你想要的页面上，那么只更新该视图链接到的模型/集合的 url 或 urlRoot 并重新获取会更有意义。然后这将触发一个重置事件，并且所有需要的视图都可以订阅并重新呈现自己。

但是，正如我所说，我没有看到人们这样做。仅仅是因为这是一个非常糟糕的主意吗？如果有人在做这样的事情，你如何处理跟踪“可刷新”模型和集合？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T18:24:19.017

我认为这在很大程度上取决于您如何使用您的视图以及它们的复杂性/大小。

如果您的视图非常简单，那么重新渲染整个视图并用新标记替换现有 HTML 通常会更容易（它也可能比遍历 DOM 来更改必要部分更快。但是，如果您有更复杂的视图并且只有少量信息发生变化，最好听听适当的属性更改事件（例如[`_bind('change:name', this.nameChanged,this)`）](http://documentcloud.github.com/backbone/#Model-change)，然后只更新 DOM 的那部分。

请记住，虽然约定是使用`render`渲染元素的方法，但您可以轻松地将额外的刷新事件应用到`refresh`某些部分，然后您可以交换模型（如 @jackwanders 建议的那样）并调用该`refresh`方法。

# jquery - 基于选择选项的Jquery启用/禁用按钮

> ID：11346044
> 
> 赞同：0
> 
> 时间：2012-07-05T14:07:05.773
> 
> 标签：jquery

是否可以基于不在表单中的选择（下拉）选项启用或禁用表单中的按钮？我没有任何代码，我会根据您对我的问题的回答（或没有）：D

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T14:14:24.067

快速演示：http: [//jsfiddle.net/mblase75/vZacx/](http://jsfiddle.net/mblase75/vZacx/)

```
$('#picker').on('change', function() {
    $('#' + $(this).val()).prop('disabled', false)
        .siblings().prop('disabled', true);
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:08:33.473

只需将您的代码禁用/启用按钮放在下拉的更改事件中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T14:20:21.837

可能是这样的：

```
​$("select")​.on('change', function() {
    $('button').prop('disabled', this.value==='EnabledOptionValue'?false:true);
})​; 
```

[小提琴](http://jsfiddle.net/9xxxu/3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T14:11:32.583

```
$('#Select').change(function(){
    //Some condition
    $('#Button').attr('disabled','disabled');
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T14:12:02.833

```
$('select').change(function(){
  var theVal = $(this).val();
  switch(theVal){
    case '0':
      $('#theButton').prop('disabled', true);
      break;
    case '1':
      $('#theButton').prop('disabled', false);
      break;
  }
}); 
```

[工作的jsFiddle](http://jsfiddle.net/9XRXR/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-26T08:39:33.900

```
<script type="text/javascript">
$(document).ready(function() {
$("#demo_button").button({icons: {secondary: "ui-icon-info"}});
$("#demoSelect").addClass("ui-state-default ui-corner-all");
var demoSelectValue = $("#demoSelect").val();
if (demoSelectValue == "0") {
$("#demo_button").button("disable")
}
$("#demoSelect").change(function(){
if($(this).val() == "0"){
$("#demo_button").button("disable")
}
else {
$("#demo_button").button("enable")
}
});
});
</script> 
```

**HTML：**

```
<select name="demoSelect" id="demoSelect">
<option value="0">No</option>
<option value="1">Yes</option>
</select>
<button id="demo_button" style="float:right;">button</button> 
```

![jsFiddle 演示](../Images/731c6e1f5a3b74a6cb981c275dc0041a.png)

见[**jsFiddle**](http://jsfiddle.net/portashqipe/dkLtzaua/)

# objective-c - 当我关闭调制解调器同时保持路由器打开时如何检测互联网连接？

> ID：11346046
> 
> 赞同：2
> 
> 时间：2012-07-05T14:07:20.080
> 
> 标签：objective-c, ios, internet-connection

我使用App Developer Library 中的[Reachability](http://developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html)来检查互联网连接，代码如下：

```
+(BOOL)reachable {
Reachability *r = [Reachability reachabilityForInternetConnection];
NetworkStatus internetStatus = [r currentReachabilityStatus];

Reachability *r1 = [Reachability reachabilityForLocalWiFi];
NetworkStatus internetStatus1 = [r1 currentReachabilityStatus];

Reachability *r2 = [Reachability reachabilityWithHostName:FTPURL];
NetworkStatus internetStatus2 = [r2 currentReachabilityStatus];

DLog(@"%d,%d,%d",internetStatus,internetStatus1,internetStatus2);

if(internetStatus != NotReachable && internetStatus1 != NotReachable && internetStatus2 != NotReachable) 
{
    return YES;
}

return NO; 
```

}

如果wifi可用，这三个状态肯定是“Reachable”。如果我手动关闭 wifi（网络连接标志关闭），这三个状态都是“不可访问”。

当我关闭调制解调器时，同时保持无线路由器打开（网络连接标志打开）。虽然我无法访问互联网，但所有三个状态仍然是“可达”。我想知道为什么会发生这种情况以及如何检测这种 UnReachable 状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:57:35.387

就您的 iPhone 而言，非常小的网络（即您的无线 LAN）和 Internet 之间没有区别。它只能说它与 TCP/IP 网络有连接。它无法判断该网络有多大。

如果您想确定是否可以从任何特定 iPhone 访问您的服务器，您必须尝试连接到它。即使那样，它也可能在您测试连接和发送真实数据之间消失。因此，无论您是否在开始之前测试连接，您仍然必须在数据传输期间优雅地处理连接丢失。您最好不要事先检查，只需假设它就在那里并且有很好的代码来处理传输错误。

# iphone - 无法访问 iPod 库路径

> ID：11346051
> 
> 赞同：2
> 
> 时间：2012-07-05T14:07:40.667
> 
> 标签：iphone, audio, ipod, mpmusicplayercontroller

我正在使用 Media Player Framework 及其 MPMusicPlayer 控制器与 iPhone 的默认播放器集成。我的资产 URL 为：- **ipod-library://item/item.mp3?id=4157200259458444598** 现在我需要访问此 URL 以将这首歌复制到我的应用程序的“song.mp3”文件中。谁能帮我访问 iPod URL，以便我可以在我的 iPhone 应用程序中以我想要的方式使用它。非常感谢任何快速帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T17:35:17.273

Apple 不允许您将 iPod 库的内容复制到您的用户区。这是为了防止侵犯版权。如果您只想播放歌曲，则需要发布更详细的问题。

# android - FileObserver 服务被另一个应用程序关闭

> ID：11346053
> 
> 赞同：0
> 
> 时间：2012-07-05T14:07:45.000
> 
> 标签：android

我正在运行一个 FileObserver 服务，该服务正在监视在某个文件夹中创建的新文件，但是每当我打开一个在该文件夹中创建所述文件的单独应用程序时，它都会关闭我的 FileObserver 服务应用程序（我不再在任务管理器中看到它） . 我希望两者同时运行，以便应用程序 #2 可以在应用程序 #1 正在观看的同一文件夹中创建文件。关于如何做到这一点的任何提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:45:02.080

Android 有权随时终止任何服务以回收内存。为了降低您的服务被选择用于回收内存的可能性，[请将其设置为 foreground](http://developer.android.com/reference/android/app/Service.html#startForeground%28int,%20android.app.Notification%29)。

# java - 如何将文章 ID 传递给“查看文章”活动

> ID：11346056
> 
> 赞同：0
> 
> 时间：2012-07-05T14:08:08.013
> 
> 标签：java, android

我是一名 PHP Web 开发人员。当我创建一个查看文章页面时，我正在`id`传递`GET`类似`article.php?id=10`

但是现在在android中，如果我有一个查看文章的活动，如何将文章ID传递给它以从数据库中选择它的数据？

我最好的选择是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:15:56.183

我假设你有 2 个活动。第一个有文章列表。当您单击一篇文章时，您将开始您的第二个活动。

在您的 onClick() 方法中：

```
Intent i = new Intent(Activity1.this, Activity2.class);
i.putExtra("id", 10);
startActivity(i); 
```

在你的第二个活动中：

```
int id = getIntent().getIntExtra("id", 0); //0 is a default value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:18:59.257

调用 ArticleActivity 时，您必须在 Intent 中传递文章 ID。这是如何做到的：

```
Intent intent = new Intent(this, ArticleActivity.class);
intent.putExtra("articleId", articleId);
startActivity(intent); 
```

在这段代码中，这是您当前活动的上下文；articleId 是您要传递的articleId。然后，当您想在 ArticleActivity 中检索它时，您可以在活动的 onCreate 中执行此操作：

```
Bundle extras = getIntent().getExtras();
int articleId = extras.getInt("articleId"); 
```

就是这样！希望有帮助。

# css - 我应该在 CSS 中两次使用相同的选择器吗？

> ID：11346059
> 
> 赞同：0
> 
> 时间：2012-07-05T14:08:18.377
> 
> 标签：css, dry

以下哪一项被认为是最佳（即更好）的做法？

```
#anElement {
    font-size:1em;
    color:white;
}

/* other stuff */

#anElement {
    width:100px;
    margin-bottom:10px;
} 
```

或者

```
#anElement {
    background-color:black;
    color:white;
    font-size:1em;
    margin-bottom:10px;
} 
```

换句话说：我应该尽可能地*干燥*CSS，还是应该分别处理排版和总体布局，甚至在单独的文件中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:17:41.953

第一个选项是完全可以接受的，并且某些 CSS 缩小器无论如何都会将它们组合成一个。我肯定会考虑使用缩小器，因为第一个选项可以生成更具可读性/可维护性的代码，尤其是在分成多个文件时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:11:53.627

拥有多个样式表会损害您的页面性能。如果您想以这种方式组织您的 css，请考虑使用诸如[http://sass-lang.com/](http://sass-lang.com/)之类的预处理器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T17:16:59.810

组合它们，但给属性一个逻辑分组。有几种方法可以将它们分组；您可以按字母顺序或逻辑顺序（文本属性在一起，边距-填充在一起等）。

请参阅[CSS Property Order](http://www.markdotto.com/2011/11/29/css-property-order/)，由 Bootstrap 的创建者 Mark Otto 编写。

另外值得注意的是，在一个简单的样式示例中，例如您提供的示例，您应该问自己一个问题......是否有可能部分/所有这些代码可能会在页面上的其他位置重用？也许有几个 div 可以使用相同的样式。那么你应该使用一个类而不是一个id。

# sql - 查找日期范围内的记录

> ID：11346060
> 
> 赞同：0
> 
> 时间：2012-07-05T14:08:18.423
> 
> 标签：sql

如果我想查找日期范围内的活动记录，是否需要将表连接到自身或仅使用一个平面 where 子句就足够了？表的架构类似于：

```
active_ind  bool
beg_dt_tm   datetime
end_dt_dm   datetime 
```

并且查询正在传递一个日期时间参数以查找该范围内的记录，所以我想知道这样的 psedu-sql 就足够了，还是我需要加入表，为什么？

```
select * 
from   MyTable mt
where  mt.active_ind = true 
and    param between mt.beg_dt_tm and mt.end_dt_tm 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-24T11:49:38.173

在这种情况下，您不得使用 BETWEEN。这样做：

```
select * 
from MyTable mt
where
    mt.beg_dt_tm >= param and 
    mt.end_dt_tm <= param 
```

# python - python：使用属性作为枚举，然后将属性分配给另一个类

> ID：11346063
> 
> 赞同：0
> 
> 时间：2012-07-05T14:08:29.560
> 
> 标签：python, python-2.7

我有以下两个课程：

```
class DbQuery:
    def __init__(self,query):
        self.query = query

class DbResultSet:
    def __init__(self,query):
        self.result = [] 
```

这些类用于 SQL 查询和结果，属性用于模拟类似枚举的功能。查询如下所示：

```
q_forum_heirarchy =\
    type(   "RtDbQuery",
            DbQuery( """SELECT level, id, parent_id, name 
                        FROM forum_heirarchy_node
                        WHERE forum_id = :f_id 
                        AND level != 0
                        ORDER BY level ASC;"""), 
            LEVEL=0, ID=1, PARENT_ID=2, NAME=3 ) 
```

我有什么方法可以将属性从 DbQuery 复制到 DbResultset 中吗？我不想将查询嵌入到结果集中，因为那样我就必须编写`db_resultset.query.LEVEL`而不是 db_resultset.LEVEL 才能到达枚举序数。

我看到了一个`__get_attribute__`方法，但我想这是由 attribute_name 索引的。

**编辑**：

该代码是无效的python，它不会改变我所问的要点。我发现 psycopg2（数据库库）可以做 namedtuples()（具有枚举性能特征的 python 对象），所以我懒得更新它：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:29:29.663

我认为你应该使用`__getattr__`方法。当没有找到类属性时，查找机制使用此方法。

```
class DbQuery(object):
  def __init__(self,query):
        self.query = query

class DbResultSet(object):
  def __init__(self, dbquery):
        self.result = []
        self.dbquery = dbquery
  def __getattr__(self, name):
        return getattr(self.dbquery,name) 
```

# android - ORMlite 没有返回我刚刚保存的对象

> ID：11346065
> 
> 赞同：4
> 
> 时间：2012-07-05T14:08:30.157
> 
> 标签：android, ormlite

这是我失败的代码（它在一个活动中运行，数据库助手在数据库中创建了 WishList 对象）

```
DatabaseHelper helper = DatabaseHelper.getInstance( getActivity() );
int savedID = 0;
WishList wl = new WishList();
wl.setName("abc");
try {
    savedID = helper.getWishListDao().create(wl);
    WishList wl_saved = helper.getWishListDao().queryForId( savedID );
    wl_saved.getId();
} catch (SQLException e) {
    e.printStackTrace();
} 
```

这是我的实体。ID 字段是自动生成的。

```
@DatabaseTable
public class WishList {
    @DatabaseField(generatedId = true)
    private int id;

    @DatabaseField( canBeNull = false , unique = true )
    private String name;

    @ForeignCollectionField
    private ForeignCollection<WishItem> items;
    ... 
```

问题是在数据库中生成的 ID 与 ORMlite 在下面的调用中返回的 ID 不同。它返回 1。

```
 savedID = helper.getWishListDao().create(wl); 
```

数据库中的 ID 实际上是 37。任何想法我可能做错了什么？使用版本 4.41

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-05T14:13:42.633

[ORMLite 的](http://ormlite.com/) `Dao.create(...)`方法不*返回*新创建对象的 ID，而是返回数据库中更改的行数——通常为 1。这里是[`Dao.create(...)`](http://ormlite.com/javadoc/ormlite-core/com/j256/ormlite/dao/Dao.html#create%28T%29).

> 从一个对象在数据库中创建一个新行。如果正在创建的对象使用 DatabaseField.generatedId() 则数据参数将被修改并使用数据库中的相应 id 进行设置。... **返回：**数据库中更新的行数。这应该是 1。

当 ORMLite 创建对象时，生成的 ID 随后会设置为该`id`字段。要查找新对象的 ID，您可以从对象本身获取它：

```
// create returns 1 row changed
helper.getWishListDao().create(wl);
// the id field is set on the w1 object after it was created
savedID = w1.getId(); 
```

# javascript - 如何获得日期在 yyyy-mm-dd 中的年份的差异？

> ID：11346069
> 
> 赞同：4
> 
> 时间：2012-07-05T14:08:33.847
> 
> 标签：javascript

我想得到以 yyyy-mm-dd 格式给出的两个日期之间的差异，差异应该是年份。

```
 var ds='2002-09-23';
        var today_date = new Date();
        alert(today_date);
        Date.prototype.yyyymmdd = function() {
        var mm = (this.getMonth()+1).toString(); // getMonth() is zero-based
        var dd  = this.getDate().toString();
        var dt = yyyy +"-"+(mm[1]?mm:"0"+mm[0]) +"-"+ (dd[1]?dd:"0"+dd[0]);// padding
        var num_years = diff_date/31536000000;
        alert(num_years);
        if (num_years>18){
           alert (num_years);
        }else{
        alert ("i m not 18");
               } 
```

请帮帮我。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-04-19T14:45:31.577

这要短得多：

```
var yearsApart = new Date(new Date - new Date('2002-09-23')).getFullYear()-1970 
```

…但请注意通过提供正确的日期时间字符串来处理非 UTC 时区！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:26:22.247

你不需要这个库，只需要纯 javascript：

```
function wholeYearsBetweenTwoDates(dateOneString, dateTwoString) {
    // assuming that dateTwo is later in time than dateOne
    var dateOne = getDateFromString(dateOneString);
    var dateTwo = getDateFromString(dateTwoString);

    var result = dateTwo.getFullYear() - dateOne.getFullYear();

    dateOne.setFullYear(dateTwo.getFullYear());
    if (dateOne > dateTwo) {
        // compensate for the case when last year is not full - e.g., when
        // provided with '2009-10-10' and '2010-10-09', this will return 0
        result -= 1;
    }

    return result;
}

function getDateFromString(stringDate) {
    var dateParts = stringDate.split('-');
    var result = new Date(dateParts[0], dateParts[1], dateParts[2]);
    return result;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:22:42.623

首先，您必须选择一个 JavaScript 库来使用**格式字符串****解析**日期（这样您就可以以您喜欢的格式提供日期）。试试[这个很棒的库](http://mattkruse.com/javascript/date/date.js)（至少你不必关心实现细节。构造函数和方法必须匹配，但它们可以解析该格式的简单日期并不是强制性的）。**`Date``Date.parse`**

 **```
var date1 = getDateFromFormat("1999-10-10", "YYYY-MM-DD");
var date2 = getDateFromFormat("2012-10-10", "YYYY-MM-DD"); 
```

然后，当您必须计算差异时：

```
var millisecondsPerSecond = 1000;
var millisecondsPerMinute = millisecondsPerSecond * 60;
var millisecondsPerHour = millisecondsPerMinute * 60;
var millisecondsPerDay = millisecondsPerHour * 24;
var millisecondsPerYear = millisecondsPerDay * 365.26;

var years = Math.round((date2 - date1) / millisecondsPerYear); 
```

如果您需要原始计算，您可以`getFullYear()`直接使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T14:26:10.027

如果将日期转换为毫秒值，则可以更轻松地比较日期。

```
var birthday = new Date('2002-09-23');
var now = new Date();
var age = now.getTime() - birthday.getTime();

if (age < (1000 * 60 * 60 * 24 * 365 * 18)) { // number of milliseconds in 18 years
   document.write('not over 18');
} else {
  document.write('over 18');
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-05T14:29:40.723

尝试以下代码以获取年份差异...

```
function getDateDiffInYears(date1, date2) {
  var dateParts1 = date1.split('-')
    , dateParts2 = date2.split('-')
    , d1 = new Date(dateParts1[0], dateParts1[1]-1, dateParts1[2])
    , d2 = new Date(dateParts2[0], dateParts2[1]-1, dateParts2[2])

  return new Date(d2 - d1).getYear() - new Date(0).getYear() + 1;
}

var diff = getDateDiffInYears('2005-09-23', '2012-07-3');

console.log(diff); // => 7 years 
```

祝你好运！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-18T11:59:29.933

我一直在使用公式`var yearsApart=milli/milliPerYear`，但是当日期和月份相同时，四舍五入的值不正确。

在这里，您有我现在正在使用的脚本...

```
function yearDifferenceDates(firstDateDay, firstDateMonth, firstDateYear, secondDateDay, secondDateMonth, secondDateYear) {

    var fisrtDate   = new Date(firstDateYear, firstDateMonth - 1, firstDateDay);
    var secondDate  = new Date(secondDateYear, secondDateMonth - 1, secondDateDay);

    if(firstDateDay == secondDateDay && (firstDateMonth - 1) == (secondDateMonth - 1)) {
        return Math.round((secondDate-fisrtDate)/(1000*60*60*24*365.242199));
    }

    return Math.floor((secondDate-fisrtDate)/(1000*60*60*24*365.242199));
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-10-13T21:38:35.303

上面有一个小错误，但这项工作:)

```
NOT WORKING:   var millisecondsPerHour = millisecondsPerMinute = 60;
WORKING FINE:  var millisecondsPerHour = millisecondsPerMinute * 60; 
```

但是谢谢阿德里亚诺·雷佩蒂

这里是完整的代码（带点格式）

```
var date1 = "01.01.2014";
var date2 = "31.12.2016";

var date1 = date1.split(".");
var date2 = date2.split(".");

date1 = String(date1[2] +"-"+ date1[1] +"-"+ date1[0]);
date2 = String(date2[2] +"-"+ date2[1] +"-"+ date2[0]);

var date1 = Date.parse(date1);
var date2 = Date.parse(date2);

//(Not for Europa :) )
//var date1 = Date.parse("2014-01-01");
//var date2 = Date.parse("2016-12-31");

var millisecondsPerSecond = 1000;
var millisecondsPerMinute = millisecondsPerSecond * 60;
var millisecondsPerHour = millisecondsPerMinute * 60;
var millisecondsPerDay = millisecondsPerHour * 24;
var millisecondsPerYear = millisecondsPerDay * 365.26;

// IN YEARS
var years = (date2 - date1) / millisecondsPerYear;

// IN MONTHS
var month = years * 12 // Very tricky, I know ;) 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-07-05T14:16:32.883

```
var d1=new Date(2002, 9, 23);
var d2=new Date();

var milli=d2-d1;
var milliPerYear=1000*60*60*24*365.26;

var yearsApart=milli/milliPerYear;

console.log(yearsApart) 
```**

# php - jQuery/JavaScript ajax 调用传递 div 的 onClick 变量

> ID：11346074
> 
> 赞同：-1
> 
> 时间：2012-07-05T14:08:59.627
> 
> 标签：php, javascript, jquery, ajax, json

我正在尝试将两个变量（如下）传递给 php/MySQL “update $table SET....”而不刷新页面。

我希望`div`单击以传递以下变量

```
$read=0;
$user=$userNumber; 
```

`div`基本上显示一条消息已被阅读，因此应该改变颜色。

请问最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:14:08.320

这是一些使用 jquery 发布到页面并处理 json 响应的代码。您必须创建一个 PHP 页面，该页面将接收发布请求并返回您希望它执行的任何操作。

```
$(document).ready(function () {

    $.post("/yourpath/page.php", { read: "value1", user: $userNumber}, function (data) {
        if (data.success) {
          //do something with the returned json
        } else { 
          //do something if return is not successful
        } //if              
    }, "json"); //post
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:15:51.190

创建一个带有两个参数的 php/jsp/.net 页面

```
mywebsite.com/ajax.php?user=XXX&secondParam=ZZZZ 
```

将 onClick 事件附加到 DIV

```
$.get("ajax.php?user=XXX&secondParam=ZZZZ". function(data){
// here you can process your response and change DIV color if the request succeed
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:11:51.193

我不确定我是否理解。见[$.load()](http://api.jquery.com/load/)；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T14:12:13.003

使用更新代码创建一个新的 php 文件，然后返回一个 json 说明它是否有效。您可以使用 $.getJSON jQuery 函数来实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T14:19:18.710

要根据 jQuery 中的 ID 从 DOM 中选择一个元素，只需执行以下操作：

```
$("#TheIdOfYourElement") 
```

或者在你的情况下

```
$("#messageMenuUnread") 
```

现在，要听它何时被点击，

```
$("#messageMenuUnread").click(function(){
   //DO SOMETHING
} 
```

现在，为了 AJAX 的乐趣。您可以阅读[http://api.jquery.com/category/ajax/](http://api.jquery.com/category/ajax/)上的文档以了解更多技术细节，但这就是归结为

```
 $("#TheIdOfYourImage").click(function(){
            $.ajax({
              type: "POST",                                 // If you want to send information to the PHP file your calling, do you want it to be POST or GET. Just get rid of this if your not sending data to the file
              url: "some.php",                             // The location of the PHP file your calling
              data: "name=John&location=Boston",           // The information your passing in the variable1=value1&variable2=value2 pattern
              success: function(result){ alert(result) }   // When you get the information, what to do with it. In this case, an alert
            });
        } 
```

至于颜色的变化，你可以使用`.css()`方法改变CSS

```
$("#TheIdOfAnotherElement").css("background-color","red") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-05T14:29:37.993

使用[jQuery.ajax()](http://api.jquery.com/jQuery.ajax/)

你的代码看起来像

```
<!DOCTYPE html>
<head>

</head>
<body>
    <!-- your button -->
    <div id="messageMenuUnread"></div>
    <!-- place to display result -->
    <div id="frame1" style="display:block;"></div>

    <!-- load jquery -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script>
        $(document).ready(function(){
            //attach a function to messageMenuUnread div
            $('#messageMenuUnread').click (messageMenuUnread);
            //the messageMenuUnread function
            function messageMenuUnread() {
                $.ajax({
                    type: "POST",
                    //change the URL to what you need
                    url: "some.php",
                    data: { read: "0", user: "$userNumber" }
                }).done(function( msg ) {
                    //output the response to frame1
                    $("#frame1").html("Done!<br/>" + msg);
                });
            }
        }
    </script>
</body> 
```

# android - Phonegap 应用程序在运行 Android 4.0 时抛出错误，但在 Android 2.3 及更低版本上运行良好

> ID：11346075
> 
> 赞同：0
> 
> 时间：2012-07-05T14:09:01.413
> 
> 标签：android, jquery-mobile, cordova

我对在 Android 4.0.3 上运行的 PhoneGap 移动应用程序有疑问。我目前使用的是PhoneGap 1.5.0 版。它可以在 Android 2.3 和所有较低版本的 Android 上完美运行。但是，当我尝试在 Android 4.0 上运行它时 - 它会引发此对话框错误...

应用程序错误 - 发生网络错误。(file:///android_asset/www/messagedetails.html?Id=29)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:13:09.803

phonegap 可能在 UI 线程上执行网络操作。UI 线程上的每个网络操作都会在 Android 4.0 中导致异常，这可能是您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T08:40:12.850

您只需尝试使用 phonegap 1.9.0 版本。因为 android 2.3.3+ 版本可能不支持 phonegap 1.5.0 版本构建。

# ios - iOS上的RestKit - 嵌套对象的后续API调用？

> ID：11346076
> 
> 赞同：2
> 
> 时间：2012-07-05T14:09:02.880
> 
> 标签：ios, xcode, restkit

我正在使用 RestKit 将数据从 Foursquare API 提取到我的 iphone 应用程序中，但是在嵌套对象的后续 API 调用中遇到了问题。

具体来说：

1.  我调用场地搜索 API (https://developer.foursquare.com/docs/venues/search) 来检索场地列表。每个 Venue 都有一个唯一的 ID，该 ID 包含在响应中。我在 ViewController 中使用以下内容执行此操作：

    ```
    [objectManager loadObjectsAtResourcePath:[NSString stringWithFormat:@"%@?%@", [URL resourcePath], [URL query]] delegate:self]; 
    ```

2.  然后我进行 RestKit 映射等并将场地存储在数据数组中。到目前为止一切正常。

3.  此时，我遍历数据数组中的场地，并且必须进行后续 API 调用以检索有关每个场地的更多详细信息。对于每个 Venue，我使用唯一 ID 并调用 Venue detail API (https://developer.foursquare.com/docs/venues/venues)。这是难倒我的部分。我正在尝试获取从第二个 API 调用返回的 Photo 对象的 NSArray。到目前为止，我已经尝试过这种变化：

    ```
    for (id venue in self.data){
        Venue *myvenue = (Venue *)venue;
        RKURL *URL = [RKURL URLWithBaseURL:[objectManager baseURL] resourcePath:[NSString stringWithFormat:@"/venues/%@", myvenue.venueid]  queryParameters:queryParams];
        [objectManager loadObjectsAtResourcePath:[NSString stringWithFormat:@"%@?%@", [URL resourcePath], [URL query]] delegate:self];
    } 
    ```

    在我的映射中：

    ```
    RKObjectMapping *photosMapping = [RKObjectMapping mappingForClass:[Photo class]];
    [photosMapping mapKeyPathsToAttributes:@"url", @"imageURL", nil];  
    [venueMapping mapRelationship:@"photos" withMapping:photosMapping];
    [objectManager.mappingProvider setMapping:photosMapping forKeyPath:@"response.photos"];  // not sure if this keypath is for the second API call 
    ```

    我的场地课有这个：

    ```
    @property (strong, nonatomic) NSArray *photos; 
    ```

Venue.photos 总是返回空。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T07:15:02.013

Not sure if this is the 'best' way to do it, but I got it working in the end. Paul de Lange's comment about not mapping the venue and the photos correctly set me off on the correct path.

The foursquare response was not in the format that I required in my app, so I had to use RKObjectLoader's willMapData to modify the response slightly before the rest of the mapping operation.

Here it is in case it helps anybody in the future:

```
- (void)objectLoader:(RKObjectLoader *)loader willMapData:(inout id *)mappableData {
    NSArray* origPhotosArray = [*mappableData valueForKeyPath:@"response.venue.photos.groups"];
    NSMutableArray* newPhotosArray =  [[NSMutableArray alloc] init];  

    // <snip> Some extra code goes here where I discarded photos I did not want....  </snip>

    // Create copies of objects in the format that I want
    NSMutableDictionary *myphoto = [[NSMutableDictionary alloc] initWithDictionary:Photo];
    NSString *venueID = [*mappableData valueForKeyPath:@"response.venue.id"];
    [myphoto setObject:venueID forKey:@"assignedVenueid"];
    [newPhotosArray addObject:myphoto];

    // Replace the new objects instead of the response objects
    [*mappableData removeObjectForKey:@"response.venue.photos.groups"];      
    [*mappableData setObject:newPhotosArray forKey:@"response.venue.photos.groups"]; 

} 
```

And in my mapping:

```
RKManagedObjectMapping *photosMapping = [RKManagedObjectMapping mappingForClass:[Photo class] inManagedObjectStore:objectStore];
[photosMapping mapKeyPath:@"url" toAttribute:@"imageURL"];
[photosMapping mapKeyPath:@"assignedVenueid" toAttribute:@"assignedVenueid"];
[venueMapping mapRelationship:@"photos" withMapping:photosMapping];
[objectManager.mappingProvider setMapping:photosMapping forKeyPath:@"response.venue.photos.groups"]; 
[photosMapping hasOne:@"assignedVenue" withMapping:venueMapping];
[photosMapping connectRelationship:@"assignedVenue" withObjectForPrimaryKeyAttribute:@"assignedVenueid"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T06:36:24.773

从您发布的代码中，您无法将响应与地点联系起来。我不确定foursquare返回的确切JSON，但您需要想出一种方法来使用具有嵌套照片对象的场地映射进行映射。如果foursquare在其响应中没有返回对原始Venue对象的引用，您可以尝试将RKObjectLoader的targetObject属性设置为Venue（代码中的myVenue）

# string - 为什么 TStringStream 加载二进制非文本文件时使用 TStringStream.DataString 失败？

> ID：11346077
> 
> 赞同：4
> 
> 时间：2012-07-05T14:09:06.083
> 
> 标签：string, delphi, hex, delphi-xe, stringstream

1.  正如专家所建议的那样，`TStringStream.DataString`不能用于检索`non-text`由 加载的数据`TStringStream.LoadFromFile`，因为`TStringStream.GetDataString`will call`TEncoding`的编码方法，`TMBCSEncoding`例如，将调用`TMBCSEncoding.GetChars`which 依次调用`TMBCSEncoding.UnicodeFromLocaleChars`和 finally`Windows`的`MultiByteToWideChar`。

2.  建议将 TBytes 用作数据缓冲区/二进制存储。（为此，建议使用 TBytes 而不是 AnsiString。）

3.  `bytes`可以从`TStringStream.ReadBuffer`方法或`TStringStream.Bytes`属性中检索。无论哪种方式，`TStream.Size`都应该考虑。

==================================================== ==

我正在尝试将`TStringStream`其`DataString`用于 base64 编码/解码目的。[正如这里](http://www.delphigroups.info/2/3/321962.html)或[这里](http://borland.newsgroups.archived.at/public.delphi.graphics/200712/0712125679.html)`Nils Haeck`的回复所表明的那样，这似乎是可能的。

1.  使用`TStringStream.DataString`in `TMainForm.QuestionOfString_StringStream`(No.2 到 No.7) 失败的原因是信息已损坏（即与原始信息不同）。但是，`ss_loaded_2.SaveToFile`（No.1）保存了原始信息，表明`TStringStream`内部是否正确保存了解码的非文本数据？您能帮忙评论一下 DataString 损坏的可能原因吗？

2.  在`Rob Kennedy`的友好回答中，他提到`string`或`ansistring`应该避免存储 base64 解码的非文本数据，这很有意义。但是，如 中所示`TMainForm.QuestionOfString_NativeXML`，`DecString`of`AnsiString`类型包含正确解码的字节，因此可以将数据编码回。这是否意味着 AnsiString 可以完整地保存解码的非文本数据？

3.  `David Heffernan`并对`Rob Kennedy`字节/TBytes 发表了友好的评论。但是，`bytes`提取的 in`TMainForm.QuestionOfString_NativeXML_Bytes_1`与`TStringStream`'s `Bytes`in不同`TMainForm.QuestionOfString_NativeXML_Bytes_2`。（从 Base64 编码/解码结果来看，这`TStringStream.Bytes`是错误的。这很令人困惑，因为根据上面的段落，`TStringStream`内部应该包含完整的字节？）你能帮忙评论一下可能的原因吗？

非常感谢您的帮助！

PS：示例文件可以从 SkyDrive 下载：[REF_EncodedSample & REF_DecodedSample](http://sdrv.ms/LzLxlZ)。（Zlib 压缩的图像文件。）。

PS：Delphi XE，Windows 7。（似乎 Delphi 7 中的 TStringStream 没有 LoadFromFile 或 SaveToFile。）

### 示例代码

```
unit uMainForm;

interface

uses
  CodeSiteLogging,
  NativeXml, // v3.10
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs;

type
  TMainForm = class(TForm)
    procedure FormCreate(Sender: TObject);
  private
    { Private declarations }
    procedure QuestionOfString_StringStream;
    procedure QuestionOfString_NativeXML;
    procedure QuestionOfString_NativeXML_Bytes_1;
    procedure QuestionOfString_NativeXML_Bytes_2;
  public
    { Public declarations }
  end;

var
  MainForm: TMainForm;

implementation

{$R *.dfm}    

// http://stackoverflow.com/questions/773297/how-can-i-convert-tbytes-to-rawbytestring
function Convert(const Bytes: TBytes): RawByteString;
begin
  SetLength(Result, Length(Bytes));
  if Length(Bytes) > 0 then
  begin
    Move(Bytes[0], Result[1], Length(Bytes));
    // SetCodePage(Result, CP_ACP, False);
  end;
end;

procedure TMainForm.FormCreate(Sender: TObject);
begin
  QuestionOfString_StringStream;
  QuestionOfString_NativeXML;
  QuestionOfString_NativeXML_Bytes_1;
  QuestionOfString_NativeXML_Bytes_2;
end;

// http://www.delphigroups.info/2/3/321962.html
// http://borland.newsgroups.archived.at/public.delphi.graphics/200712/0712125679.html
procedure TMainForm.QuestionOfString_StringStream;
var
  ss_loaded_2, ss_loaded_3: TStringStream;
  dataStr: AnsiString;
  hexOfDataStr: AnsiString;
begin
  ss_loaded_2 := TStringStream.Create();
  // load the file containing Base64-decoded sample data
  ss_loaded_2.LoadFromFile('REF_DecodedSample');

  // 1  
  ss_loaded_2.SaveToFile('REF_DecodedSample_1_SavedByStringStream');

  // 2 
  ss_loaded_3 := TStringStream.Create(ss_loaded_2.DataString);
  ss_loaded_3.SaveToFile('REF_DecodedSample_2_SavedByStringStream');

  // 3     
  ss_loaded_3.Free;
  ss_loaded_3 := TStringStream.Create(ss_loaded_2.DataString, TEncoding.ASCII);
  ss_loaded_3.SaveToFile('REF_DecodedSample_3_SavedByStringStream');

  // 4     
  ss_loaded_3.Free;
  ss_loaded_3 := TStringStream.Create(ss_loaded_2.DataString, TEncoding.UTF8);
  ss_loaded_3.SaveToFile('REF_DecodedSample_4_SavedByStringStream');

  // 5     
  ss_loaded_3.Free;
  ss_loaded_3 := TStringStream.Create(AnsiString(ss_loaded_2.DataString));
  ss_loaded_3.SaveToFile('REF_DecodedSample_5_SavedByStringStream');

  // 6     
  ss_loaded_3.Free;
  ss_loaded_3 := TStringStream.Create(UTF8String(ss_loaded_2.DataString));
  ss_loaded_3.SaveToFile('REF_DecodedSample_6_SavedByStringStream');

  // 7 
  dataStr := ss_loaded_2.DataString;
  SetLength(hexOfDataStr, 2 * Length(dataStr));
  BinToHex(@dataStr[1], PAnsiChar(@hexOfDataStr[1]), Length(dataStr));
  CodeSite.Send(hexOfDataStr);

  ss_loaded_2.Free;
  ss_loaded_3.Free;
end;

// http://www.simdesign.nl/forum/viewtopic.php?f=2&t=1311
procedure TMainForm.QuestionOfString_NativeXML;
var
  LEnc, LDec: integer;
  EncStream: TMemoryStream;
  DecStream: TMemoryStream;
  EncString: AnsiString;
  DecString: AnsiString;
begin
  // encode and decode streams
  EncStream := TMemoryStream.Create;
  DecStream := TMemoryStream.Create;
  try
    // load BASE64-encoded data
    EncStream.LoadFromFile('REF_EncodedSample');
    LEnc := EncStream.Size;
    SetLength(EncString, LEnc);
    EncStream.Read(EncString[1], LEnc);

    // decode BASE64-encoded data, after removing control chars
    DecString := DecodeBase64(sdRemoveControlChars(EncString));
    LDec := length(DecString);
    DecStream.Write(DecString[1], LDec);

    // save the decoded data
    DecStream.SaveToFile('REF_DecodedSample_7_SavedByNativeXml');

    // EncString := sdAddControlChars(EncodeBase64(DecString), #$0D#$0A);
    EncString := EncodeBase64(DecString);

    // clear and resave encode stream as a copy
    EncStream.Clear;
    EncStream.Write(EncString[1], Length(EncString));
    EncStream.SaveToFile('REF_EncodedSampleCopy');

  finally
    EncStream.Free;
    DecStream.Free;
  end;
end;

procedure TMainForm.QuestionOfString_NativeXML_Bytes_1;
var
  LEnc, LDec: integer;
  EncStream: TMemoryStream;
  DecStream: TMemoryStream;
  EncString: AnsiString;
  DecString: AnsiString;
  DecBytes: TBytes;
begin
  // encode and decode streams
  EncStream := TMemoryStream.Create;
  DecStream := TMemoryStream.Create;
  try
    // load BASE64-decoded data
    DecStream.LoadFromFile('REF_DecodedSample');

    LDec := DecStream.Size;
    SetLength(DecBytes, LDec);
    DecStream.Read(DecBytes[0], LDec);

    EncString := EncodeBase64(Convert(DecBytes));

    // clear and resave encode stream as a copy
    EncStream.Write(EncString[1], Length(EncString));
    EncStream.SaveToFile('REF_EncodedSampleCopy_Bytes_1');

  finally
    EncStream.Free;
    DecStream.Free;
  end;
end;

procedure TMainForm.QuestionOfString_NativeXML_Bytes_2;
var
  LEnc, LDec: integer;
  EncStream: TMemoryStream;
  DecStream: TStringStream;
  EncString: AnsiString;
  DecString: AnsiString;
  DecBytes: TBytes;
begin
  // encode and decode streams
  EncStream := TMemoryStream.Create;
  DecStream := TStringStream.Create;
  try
    // load BASE64-decoded data
    DecStream.LoadFromFile('REF_DecodedSample');

    DecBytes := DecStream.Bytes;

    EncString := EncodeBase64(Convert(DecBytes));

    // clear and resave encode stream as a copy
    EncStream.Write(EncString[1], Length(EncString));
    EncStream.SaveToFile('REF_EncodedSampleCopy_Bytes_2');

  finally
    EncStream.Free;
    DecStream.Free;
  end;
end;

end. 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-05T14:59:27.363

示例 3 到 7 失败并不奇怪。您的文件不是文本数据，因此将其存储在文本数据结构中必然会出现问题。这些测试中的每一个都涉及将数据从一种编码转换为另一种编码。由于您的数据一开始并未编码为 UTF-16 文本，因此任何期望数据具有该编码的转换都将失败。

示例 2 可能会失败，因为您有奇数个字节，并且您将其存储在一个根据定义包含偶数个字节的字符串中。在某个地方，将引入或删除一个字节，从而导致存储不同的数据。

除非您正在处理文本，否则不要使用`TStringStream`,`string`或`AnsiString`. 尝试`TBytesStream`或`TMemoryStream`代替。

随意将 Base64 编码的数据存储在字符串中。Base64 是一种文本格式。但是一旦你解码它，它又是二进制的，并且不再需要在文本数据结构中了。

您现在看到的结果与 Nils Haeck 建议的结果不同的原因是，Haeck 是在 2007 年编写的，当时 Delphi 字符串成为 Unicode 并且 RTL 进行了任何自动代码页转换。您正在使用 Delphi `string`XE `UnicodeString`，.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T22:56:15.547

您没有考虑从 D2009+`TStringStream`派生`TMemoryStream`和`TByteStream`在 D2009+ 中派生，而是直接从`TStream`早期版本派生而来。 `TMemoryStream`分配内存的方式与您的代码预期的不同，并且该`TByteStream.Bytes`属性表示`TMemoryStream`分配的整个内存块，但这并不意味着该内存的全部内容都填充了实际数据。您的代码需要忽略一些额外的填充。

有关您的代码失败原因的更详细说明，请参阅我对[您的其他问题的回答。](https://stackoverflow.com/questions/11353069)

# ios - 由于“允许使用非 iOS 批准的付款方式”原因，iOS 应用程序上的 Facebook 登录被阻止

> ID：11346081
> 
> 赞同：0
> 
> 时间：2012-07-05T14:09:24.300
> 
> 标签：ios, facebook, login, payment, facebook-ios-sdk

Facebook 登录（或连接）已被 Facebook 在我们的应用程序（iOS 版 Ubudu，在法国应用程序商店提供）上阻止。FB支持的原因如下，但我不明白，因为该应用程序是完全免费的，并且该过程中唯一的交易是链接到销售实体产品和服务的移动网页。

任何人都有解决方案如何克服它？

来自 FB 支持的消息：“您的应用 [XXX] 允许/链接到通过“iOS 版 Facebook”应用的购买流程。这是一种未经 iOS 批准的付款方式，违反了以下政策：

在 Facebook iOS 应用程序中运行的移动 Web 应用程序只能使用 iOS 批准的付款方式。这些应用不得引用、使用或以其他方式鼓励使用 Facebook Credits 和其他非 iOS 批准的付款方式。

因此，由于违反以下政策，您的移动网络应用程序将在“iOS 版 Facebook”上的“iOS 版 Facebook”上被阻止（这意味着您不会出现在搜索、书签、请求和新闻源中）：

您可以在您的画布（桌面）应用程序和 m.facebook.com 上参考付款选项，而不是“iOS 版 Facebook”中的移动应用程序。（……）”

/托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:30:13.937

我相信这就是 Facebook 的意思。他们实际上从未说过*你*在卖任何东西，他们说你提供的方法是通过你提供的实体商品链接来规避 Apple 对应用内商品 30% 的削减。如果这些链接是针对零售商的，请在上诉中向 FB 仔细说明您的立场，但是，如果您自己销售这些东西，则严禁将 iApp 资金用于实物商品。

# c - R中的GSL库

> ID：11346083
> 
> 赞同：1
> 
> 时间：2012-07-05T14:09:28.230
> 
> 标签：c, r

我正在编写将在 R 中使用的 C 代码。为了在 C 中进行矩阵运算，我添加了“gsl_matrix”库。当我使用 R CMD SHLIB 编译时，它编译没有问题。但是，当我打开 R 并尝试编写 dyn.load("file.so") 时，我收到一条错误消息：

```
unable to load shared object file.so
undefined symbol: gsl_matrix_alloc 
```

我的错误在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T17:51:21.057

我怀疑这与未正确链接到 GSL 库的共享库有关，如[R-devel](https://stat.ethz.ch/pipermail/r-devel/2006-December/043927.html)或有关[编写 R 扩展](http://cran.r-project.org/doc/manuals/R-exts.html#Using-Makevars)的手册中所讨论的，建议使用`Makevars`文件（类似于`PKG_LIBS=-L/usr/lib -lgsl`）。否则，按照 中的示例`help(SHLIB)`，您可能需要尝试：

```
$ R CMD SHLIB file.c -lgsl -lgslcblas 
```

* * *

有一个简单的教程[R Call GSL](http://www.math.ncu.edu.tw/~chenwc/R_note/index.php?item=R_gsl)，它显示了调用 GSL 函数的基本设置。

我能够重现玩具示例，我将其重命名`nperms.{c,r}`如下（在 Mac 上，使用`-dynamiclib`switch 代替`-shared`）：

```
~/scratch $ gcc -c nperms.c 
~/scratch $ file nperms.o
nperms.o: Mach-O 64-bit object x86_64
~/scratch $ gcc -dynamiclib -lgsl -lgslcblas -o libnperms.dylib -dylib nperms.o
~/scratch $ ls *nperm*
libnperms.dylib  nperms.c  nperms.o
~/scratch $ file libnperms.dylib 
libnperms.dylib: Mach-O 64-bit dynamically linked shared library x86_64 
```

在 R 中运行时一切正常。但是，使用从没有进一步参数生成`dyn.load`的`libnperms.dylib`共享库`R CMD SHLIB`

```
~/scratch $ R CMD SHLIB nperms.c
gcc -arch x86_64 -std=gnu99 -dynamiclib -Wl,-headerpad_max_install_names -undefined dynamic_lookup -single_module -multiply_defined suppress -L/usr/local/lib -o nperms.so nperms.o -F/Library/Frameworks/R.framework/.. -framework R -Wl,-framework -Wl,CoreFoundation
~/scratch $ ls *nperm*
libnperms.dylib  nperms.c  nperms.o  nperms.r  nperms.so
~/scratch $ file nperms.so
nperms.so: Mach-O 64-bit dynamically linked shared library x86_64 
```

raises the following error (sorry for the French locale)

```
> dyn.load("nperms.so")
Erreur dans dyn.load("nperms.so") : 
  impossible de charger l'objet partag'e '/Users/chl/scratch/nperms.so':
  dlopen(/Users/chl/scratch/nperms.so, 6): Symbol not found: _gsl_permutation_alloc
  Referenced from: /Users/chl/scratch/nperms.so
  Expected in: flat namespace
 in /Users/chl/scratch/nperms.so 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:16:51.330

我没有直接回答您的问题，但您是否尝试过[http://cran.r-project.org/web/packages/RcppGSL/index.html](http://cran.r-project.org/web/packages/RcppGSL/index.html)或[http://cran.r-project.org/web/packages /RcppArmadillo/index.html](http://cran.r-project.org/web/packages/RcppArmadillo/index.html) ?

# java - Richfaces Javascript没有触发

> ID：11346086
> 
> 赞同：0
> 
> 时间：2012-07-05T14:09:39.683
> 
> 标签：java, javascript, jsf, richfaces

我正在尝试突出显示使用 Ricfaces 呈现的表格的当前选定行，但它不起作用。这是我的代码：

小面：

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
xmlns:c="http://java.sun.com/jsp/jstl/core"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:a4j="http://richfaces.org/a4j"
xmlns:rich="http://richfaces.org/rich" template="templates/main.xhtml">

<ui:define name="body">
    <h:form>
        <fieldset>
            <legend>
                <h:outputText value="#{msg['result.legend']}" />
            </legend>

            <rich:dataTable id="resultTable" onRowMouseOver="this.style.backgroundColor='#f1f1f1'" 
                onRowMouseOut="this.style.backgroundColor=''"
                value="#{searchController.result}" var="row">
                <c:forEach items="${searchController.headers}" var="headr"
                    varStatus="status">
                    <rich:column>
                        <f:facet name="header">
                            <h:outputText value="#{headr}" />
                        </f:facet>
                        <h:outputText value="#{row[status.count-1]}" />
                    </rich:column>
                </c:forEach>
            </rich:dataTable>

        </fieldset>
    </h:form>
</ui:define> 
```

我无法粘贴整个模板 (main.xhtml) 源代码。这是 h : body 标签的内容（刚刚发现原因:-)）：

```
<rich:panel styleClass="mainPanel">
    <ui:include src="../common/header.xhtml"></ui:include>
    <ui:insert name="body"></ui:insert>
</rich:panel> 
```

pom依赖：

```
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.richfaces</groupId>
            <artifactId>richfaces-bom</artifactId>
            <version>4.2.2.Final</version>
            <scope>import</scope>
            <type>pom</type>
        </dependency>
    </dependencies>
</dependencyManagement>

<dependencies>

    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.9</version>
        <scope>test</scope>
    </dependency>

    <dependency>
        <groupId>org.hamcrest</groupId>
        <artifactId>hamcrest-all</artifactId>
        <version>1.1</version>
    </dependency>

    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.17</version>
    </dependency>

    <dependency>
        <groupId>org.richfaces.ui</groupId>
        <artifactId>richfaces-components-ui</artifactId>
    </dependency>
    <dependency>
        <groupId>org.richfaces.core</groupId>
        <artifactId>richfaces-core-impl</artifactId>
    </dependency>
    <!--dependency> <groupId>javax.faces</groupId> <artifactId>javax.faces-api</artifactId> 
        </dependency -->
    <dependency>
        <groupId>com.sun.faces</groupId>
        <artifactId>jsf-api</artifactId>
    </dependency>
    <dependency>
        <groupId>com.sun.faces</groupId>
        <artifactId>jsf-impl</artifactId>
    </dependency>
    <dependency>
        <groupId>com.sun.facelets</groupId>
        <artifactId>jsf-facelets</artifactId>
        <version>1.1.14</version>
    </dependency>
    <dependency>
        <groupId>jstl</groupId>
        <artifactId>jstl</artifactId>
        <version>1.2</version>
    </dependency>
</dependencies> 
```

其中 searchController.headers 是 List< String >，而 searchController.result 是 List< List< String >>。表格本身已正确呈现。

我在这里想念什么？

我正在使用 Richfaces 4.2.2.Final，在 Eclipse Indigo 上开发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:56:48.783

事实上，这个问题不是重复的，因为richfaces 处理这个问题与普通的 jsf 有点不同。

我在我的应用程序中为该任务创建了两个 js 函数：

```
function mouseOutRichRow(row) {
    if (row.highlight != true) {
        row.style.backgroundColor=row.oldColor;
    }
}
function mouseOverRichRow(row) {
    if (row.highlight != true) {
        row.oldColor=row.style.backgroundColor;
        row.style.backgroundColor='#FFFF8A';
    }
} 
```

它们绑定到 onRowMouse 事件：

```
<rich:dataTable
    onRowMouseOver="mouseOverRichRow(this);"
    onRowMouseOut="mouseOutRichRow(this);"
    ....> 
```

事实上，Luiggi Mendoza 的评论是错误的 - Richfaces 将这些参数应用于每一行，因此`this`具有正确的范围。

**编辑：** 如果这仍然不起作用，请尽量不要使用`c:forEach`. 这是旧的 jsp 方式，不适用于 jsf 生命周期。使用`ui:repeat`或`a4j:repeat`代替。

# wix - 在wix中复制文件后如何调用自定义操作

> ID：11346087
> 
> 赞同：12
> 
> 时间：2012-07-05T14:09:41.353
> 
> 标签：wix, custom-action

我想在文件复制到目标文件夹后执行自定义操作。

在自定义操作中，我运行复制的脚本文件，所以给我找不到错误文件。

```
<CustomAction Id="RunDBScript"
              BinaryKey="CA"
              DllEntry="RunDBScript"
              Execute=" immediate"
              Return="check" />

<Custom Action="RunDBScript" After="InstallFiles">
    <![CDATA[NOT Installed]]>
  </Custom> 
```

此自定义操作给出一个错误文件/目录未找到。所以这个动作在文件复制之前调用。

那么，如何在文件复制后调用自定义操作？

我不明白为什么在 InstallFiles 之前调用此自定义操作，即使我指定为 After="InstallFiles"。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-06T06:23:18.460

[在InstallFinalize](http://msdn.microsoft.com/en-us/library/windows/desktop/aa369505%28v=vs.85%29.aspx)之后移动您的自定义操作。这是 InstallExecuteSequence 中唯一可以在安装产品文件后立即执行操作的地方。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-11-17T17:57:17.323

当您使用延迟自定义操作时，您必须通过 session.CustomActionData["propertyname"] 访问值。

会话字典值只能由正在编写执行脚本的即时自定义操作读取。

延迟的自定义操作在脚本运行时执行，因此项目属性不再可用。要使用它，您必须实现双重自定义操作，以便为真正的自定义操作提供所需的属性。

按照下面的例子：

```
<CustomAction Id="CustomActionID_Data" Property="CustomActionID" Value="INSTALLDIR=[INSTALLDIR];OTHERPROPERTY=[OTHERPRPJECTPROPERTY]"></CustomAction>
<CustomAction Id="CustomActionID" BinaryKey="FILEBINARYID" DllEntry="METHODNAMEATCUSTOMACTION" Execute="deferred"></CustomAction> 
```

在此示例中，您需要在 InstallExecutionSequence 调用自定义操作“_Data”并在调用真实操作之后，因此第一个“_Data”将设置所需的属性。然后，您可以使用 session.CustomActionData[""] 访问代码中的这些属性。

作为补充，下面是如何在 InstallExecuteSequence 调用自定义操作的示例。

```
<Custom Action="CustomActionID_Data" After="InstallFiles">NOT (REMOVE="ALL")</Custom>
<Custom Action="CustomActionID" After="CustomActionID_Data">NOT (REMOVE="ALL")</Custom> 
```

# javascript - IE 最初会破坏我的 JS 脚本，然后我按 F12 并且它运行良好

> ID：11346091
> 
> 赞同：5
> 
> 时间：2012-07-05T14:10:10.340
> 
> 标签：javascript, internet-explorer, debugging, crash

我有一个在所有浏览器中都能正常工作的 JS 脚本。但令所有人惊讶的是，在 IE 中它在第一次尝试时不起作用。

如果在加载页面后按 F12（打开 ie 调试器）并刷新页面，它可以正常工作！就像其他浏览器一样！但对于这项工作，我必须按 F12。

当我们打开ie的调试器时，它会做些什么吗？我找不到解决方案！

提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-05T14:13:58.030

当你没有打开调试器时，IE 认为没有 console.log 这样的东西，并给你调用未定义函数的错误。当您按 F12 时，您将获得控制台，因此 console.log 不再是未定义的。

您可以通过将其放在代码顶部来解决此问题：

```
if (!window.console) window.console = {};
if (!window.console.log) window.console.log = function () { }; 
```

如果控制台不存在，这只会让浏览器不做任何事情，而不是从您的代码中编辑掉 console.log，如果它们未定义，则将它们定义为“不做任何事情”功能。

如果您希望缩小 js 文件大小（对于移动使用尤其重要），您最终会希望删除发布版本上的详细日志记录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:13:25.593

`console.log()`你的脚本中有类似的东西吗？这可以解释，因为在您按 F12 之前没有控制台

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-04T04:15:16.467

上一篇文章的扩展版本

```
if (!('console' in window)) {
    var stub = function() { ; };
    window.console = {
        log : stub,
        info : stub,
        warn : stub,
        error : stub,
        assert : stub
    };
} 
```

我发布了这个仅在需要时才安装存根的新版本

```
/**
 * On IE console is not set if not opened and debug doesn't exists
 */
(function() {
    if (!('console' in window)) { window.console = {}; }
    var kind = ['log', 'info', 'warn', 'error', 'assert', 'debug'];
    var stub = function() { ; };
    for (var i = 0; i < kind.length; i++) {
        if (kind[i] in window.console) { continue; }
        window.console[kind[i]] = stub;
    }
})(); 
```

# json - 如果 JSON 代表“对象”，那么什么代表“类”？

> ID：11346098
> 
> 赞同：1
> 
> 时间：2012-07-05T14:10:29.557
> 
> 标签：json

JSON 似乎是一种用纯文本表示复杂数据结构的好方法。如果我们认为这种复杂的数据结构类似于 OOP 对象——类的实例——那么是否有一种常用的类 JSON 格式来表示类本身（只是数据部分——忘记方法）？JSON 本身可以用于此目的吗？

换句话说，如果 JSON 对名称-值对进行编码，如果我只想对名称进行编码，我应该使用什么？

我想要这个的原因是我正在设计一个与 jQuery 一起使用的协议（顺便说一下，我是一个完全的新手）。客户端将向服务器传达它想要返回的 JSON 对象的结构，服务器将返回该结构的 JSON 对象并添加了值。

关键是*客户端*完全控制服务器返回的数据字段（名称-值对）。它与我目前在 Web 上找到的所有 jQuery 示例有点不同，在这些示例中，客户端发出请求（通常包括一组非常有限的参数，如果有的话），服务器决定哪些字段在 JSON 回复中返回。

（很明显，客户端要求的内容必须与服务器的数据模型一致；如果服务器有一个小部件数组，每个小部件都有自己的价格，客户端就不能要求一个价格数组，每个小部件都有自己的小部件。）

这一定是一个普遍的问题，我不想重新发明轮子。我想采用一种已经在网络上普遍使用的解决方案。

**编辑** 我刚刚找到[JSON Schema](http://en.wikipedia.org/wiki/JSON#Schema)。这*不是*我要找的。它包含的东西比我需要的要多。

**编辑** 我更多的是寻找“这就是通常的做法”的答案，而不是“你可以尝试……”的答案。（我自己可以发明几十个可能的答案。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:35:46.653

要仅对 JSON 中的名称进行编码，您可以使用键/值对，其中键是类名或只是名为“值”的键 - 值是一个字符串数组，这些字符串是服务器返回的名称. 例如：

```
{ 'class_name' : [ "name1", "name2", "name3" ] } 
```

然后，服务器可以从使用的键中检测类名，如果类支持，则返回数组中名称的提供值，如果不支持，则忽略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T09:03:57.253

> 我正在寻找更多“这就是通常的做法”的答案

没有单一的“正确”方式来做你想做的事。很多人都有自己的实现。这取决于各种因素——你想做什么，你想在哪里做，你希望它做的效率如何？

* * *

对于简单的结构，我更喜欢并建议@dbr9979 给出的答案。

对于嵌套结构，您可以使用嵌套数组。就像是：

```
{
    "nestedfield1": {
        "nestedfield11":["nestedfield111", "nestedfield112"],
        "nestedfield12":["nestedfield121", "nestedfield122"],
        "__SIMPLE_FIELDS__": ["simplefield13", "simplefield14"]
    }
} 
```

关键是，如果键是`__SIMPLE_FIELDS__`，则值是简单字段（字符串、数字等）的数组，否则键代表对象中的键。

* * *

对于更复杂的事情，我建议您使用服务器和客户端都知道的预定义结构。当您必须发出多个相同的请求时，这特别有用。为每个人分配一个唯一的编号。就像是：

```
1 => <the structure above>
2 => ["simplefield1", "simplefield2" ..]
3 => etc .. etc 
```

服务器将上述结构和相关编号存储在数据库或其他东西中。现在，正如现在可能很明显的那样，客户端通过所需结构的 id 发送，服务器以适当的方式响应。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T10:02:31.890

我想你的意思是：

> 完全控制服务器返回的数据字段（名称-值对）的客户端。

就像SQL 中的`SELECT * FROM Bags`和之间的区别。`SELECT color, price FROM Bag`我对你的解释正确吗？

您可以查询：

```
{
    'resource': 'Bag',
    'field_names': ['color', 'price']
} 
```

这将返回响应：

```
{
    'status': 'success',
    'result': [
        {'color': 'red', 'price': 50},
        {'color': 'blue', 'price': 45},
    ]
} 
```

不过，最有可能的是，您实际上可能并不需要您的请求是 JSON 对象；我已经看到从查询字符串中获取字段名称的实现，例如[http://foo.com/bag?fields=color,price](http://foo.com/bag?fields=color,price)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T13:06:38.123

我正在寻找**部分响应**。

[RESTful API 设计：您的 API 能否为开发人员提供他们需要的信息？](http://blog.apigee.com/detail/restful_api_design_can_your_api_give_developers_just_the_information/)解释了这一切，并给出了来自 LinkedIn、Facebook 和 Google 的示例。谷歌和 Facebook 都有类似的方法。以下是 Lie Ryan 的示例使用 Google 方法的外观：

```
url?fields=status,result(color,price) 
```

由于谷歌和 Facebook 支持这一点，因此看到这成为事实上的标准，我不会感到惊讶。

在我的情况下，我可能会遇到 URL 的长度限制，因此必须改用 POST，但这对我来说是一个很好的起点。

# android - Android：FragmentActivity 的 ArrayIndexOutOfBoundsException（支持 V4 Lib）

> ID：11346102
> 
> 赞同：1
> 
> 时间：2012-07-05T14:11:03.647
> 
> 标签：android, android-fragments, indexoutofboundsexception, back-stack

这与托管在 code.google.com (http://code.google.com/p/android/issues/detail?id=22404) 上的问题 22404 相同的问题

总结一下：4个fragment在back stack，从back stack中删除dialogFragment，旋转手机。

看起来中的行是： Fragment f = fm.mActive.get(mOps[pos++]);

出于某种原因，mOps[pos++] 似乎是 -1。

我认为原因是一个 dialogFragment 被标记为删除，因此它的状态被重置。因此，在重建 backstack mOps[pos++] 时，索引返回 -1。

对此有什么想法吗？

# spring-security - 使用 Spring Security 记录登录

> ID：11346107
> 
> 赞同：7
> 
> 时间：2012-07-05T14:11:22.880
> 
> 标签：spring-security

我想在我的 Web 应用程序中记录每次登录。我能够访问发生的登录，`UsernamePasswordAuthenticationFilter`但我不知道如何记录使用记住我功能登录的用户。我尝试覆盖

```
createSuccessfulAuthentication(HttpServletRequest request, UserDetails user) 
```

的`TokenBasedRememberMeServices`，但随后也会记录注销，因为 remember-me 服务会重新验证用户身份。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T14:45:36.530

记录身份验证成功和失败的最佳方法是使用 Spring [`ApplicationListener`](http://static.springframework.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/ApplicationListener.html?is-external=true)。

Spring Security 发布了各种事件来验证身份验证成功和失败，您可以收听这些事件。当拒绝访问资源时，也会发布事件。

你可以看[`LoggerListener`](https://github.com/SpringSource/spring-security/blob/master/core/src/main/java/org/springframework/security/authentication/event/LoggerListener.java)一个例子。首先将其中之一添加到您的应用程序上下文中，它将自动在警告级别记录身份验证事件。

关于记住我的登录，如果您注销然后立即访问该站点，并使用记住我的 cookie 重新进行身份验证，那么从技术上讲，这与任何其他记住我的身份验证相同，因此您无能为力关于它。

但是，如果您的注销成功 URL 正在通过记住我过滤器，并且这就是创建新会话的方式（无需用户进行任何其他操作），那么只需从安全过滤器链中省略该页面即可。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-09T05:15:19.953

对于记录每个成功的登录，我认为最好的方法是创建 LoginSucessHandler 并为正常登录指定 authentication-success-handler 以及记住我。我用下面的代码和配置完成了这个。

```
@Service
public class LoginSucessHandler extends
        SavedRequestAwareAuthenticationSuccessHandler {

    @Override
    public void onAuthenticationSuccess(HttpServletRequest request,
            HttpServletResponse response, Authentication authentication)
            throws ServletException, IOException {
        User user = (User) authentication.getPrincipal();
            // record login success of user
        super.onAuthenticationSuccess(request, response, authentication);
    }

}

<http auto-config="true" use-expressions="true">
    <form-login login-page="/login"
        authentication-failure-url="/login.hst?error=true"
        **authentication-success-handler-ref="loginSucessHandler"** />
    <logout invalidate-session="true" logout-success-url="/home"
        logout-url="/logout" />
    <remember-me key="jbcp" **authentication-success-handler-ref="loginSucessHandler"**/>
    <session-management>
    <concurrency-control max-sessions="1" />
</session-management>
</http> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T06:32:30.930

我认为在您的情况下，当您使用自定义过滤器时将有助于解决方案，它将拦截对您的应用程序的每个请求。在此过滤器中，您可以记录每个请求的用户名。

[在这里，我描述了如何添加您的自定义过滤器](https://stackoverflow.com/questions/11337997/how-to-add-custom-filter-after-user-authorize-in-spring-application/11339145#11339145)。您只需要将功能更改为您想要的。并且不要将您的过滤器放在 web.xml 中的安全过滤器链之后。

# html - HTML 文件中的自动缩进代码（生成器/工具）

> ID：11346108
> 
> 赞同：2
> 
> 时间：2012-07-05T14:11:25.893
> 
> 标签：html

我想知道是否有一个工具或生成器可以在生产后自动缩进我的代码：

```
<div>
<div>
<p>
</p>
</div>
</div> 
```

至：

```
<div>
     <div>
          <p>
          </p>
     </div>
</div> 
```

这样的事情存在吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:18:56.750

[尝试 js-beautify](http://github.com/einars/js-beautify)。

它是一个 JavaScript 美化器，但也适用于 HTML。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T10:10:19.320

你可以试试[Pretty Diff](http://prettydiff.com/?m=beautify&l=html)，它也可以处理 JSLT 类型的标签。

# html - HTML 表格中的精美边框

> ID：11346109
> 
> 赞同：0
> 
> 时间：2012-07-05T14:11:31.663
> 
> 标签：html, css

所以我正在设计一个表格，我想为表格标题做一个漂亮的下划线。

我虽然很努力并且在互联网上看了看，但找不到任何东西。

这是表结构：

```
<table>
    <thead>
        <tr>
            <td>Number</td>
            <td>Name</td>
            <td>Address</td>
        </tr>
    </thead>

    <tbody></tbody>
</table> 
```

还有我现在的造型：

```
table {
    width: 100%;
}

    table thead {
        font-weight: bold;
    }

        table thead td {
            margin-right: 5px;
            border-collapse: separate;
            border-spacing: 10px 5px;
            border-bottom: 2px solid #427AA8;
        }

    table tbody {
        font-size: 90%;
    }

        table tbody tr {
            line-height: 2em;
            border-bottom: 1px solid #CCC;
        }

        table tbody td {
            padding: 0 5px;
        } 
```

这是代码的jsfiddle：http: [//jsfiddle.net/tYA4e/1/](http://jsfiddle.net/tYA4e/1/)

我正在寻找的是列之间边界的中断，但仅在 thead 中。

还有一个我想要实现的例子：http: [//i.imgur.com/OHrhJ.jpg](http://i.imgur.com/OHrhJ.jpg)

有没有办法通过一些简单的方法来实现这一点`CSS`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T14:17:09.540

边框必然会扩展其元素的整个宽度；因此，要仅将边框部分扩展到元素的宽度，必须将边框应用于子元素，并相应地调整大小。

也就是说，唯一可行的方法似乎是在`td`（在本例中为 a `span`）中嵌套一个元素，并使用以下 CSS：

```
table thead td span {
    display: inline-block;
    width: 80%;
    border-bottom: 2px solid #427AA8;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/tYA4e/2/)。

顺便说一句，值得注意的是，对于表格标题，`th`(table-heading) 元素可能更适合您在这种情况下使用。

进一步考虑，当然，也可以使用样式`hr`元素，它允许您对 ' 的宽度进行像素级控制，`hr`因为在本例中，它可以从 parent的`10px`右边缘延伸到`td`：

```
table thead td hr {
    width: 80%;
    margin: 0 10px 0 0;
    border-bottom: 2px solid #427AA8;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/tYA4e/3/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:22:58.660

您还可以将 th 用于标题单元格 -> 不再需要使用 thead 和 tbody 将行分成组 - 更少的标记和更少的 css。

```
<table>
    <tr>
        <th>headlinecell</th>
    </tr>
    <tr>
        <td>contentcell</td>
    </tr>
</table> 
```

现在只需设置 th 和 td 的样式。

# python - 对多个子字典值的字典字典排序

> ID：11346111
> 
> 赞同：1
> 
> 时间：2012-07-05T14:11:36.467
> 
> 标签：python, sorting, dictionary

我有一本看起来像这样的字典：

```
myDict = {
    'SER12346': {'serial_num': 'SER12346', 'site_location': 'North America'},
    'ABC12345': {'serial_num': 'ABC12345', 'site_location': 'South America'},
    'SER12345': {'serial_num': 'SER12345', 'site_location': 'North America'},
    'SER12347': {'serial_num': 'SER12347', 'site_location': 'South America'},
    'ABC12346': {'serial_num': 'ABC12346', 'site_location': 'Europe'}
} 
```

我的目标是按每个子词典的 the`site_location`和 the对这本词典进行排序。`serial_num`

使用我在这个问题中找到的代码 -[对字典字典进行排序 python](https://stackoverflow.com/questions/10592480/sort-a-dictionary-of-dictionaries-python) - 我能够对其进行排序，但这并不是我所期望的。

这是我的代码：

```
import pprint
items = ((k, k2, v) for k in myDict for k2, v in myDict[k].items())
ordered = sorted(items, key=lambda x:x[-1], reverse=False)
pprint.pprint(ordered) 
```

这是我得到的结果：

```
[('ABC12346', 'site_location', 'Europe'),
 ('SER12345', 'site_location', 'North America'),
 ('SER12346', 'site_location', 'North America'),
 ('SER12347', 'site_location', 'South America'),
 ('ABC12345', 'site_location', 'South America'),
 ('ABC12346', 'serial_num': 'ABC12346'),
 ('SER12345', 'serial_num': 'SER12345'),
 ('SER12346', 'serial_num': 'SER12346'),
 ('SER12347', 'serial_num': 'SER12347'),
 ('ABC12345', 'serial_num': 'ABC12345')] 
```

我期待着更像这样的东西：

```
{
    'ABC12346': {'serial_num': 'ABC12346', 'site_location': 'Europe'}
    'SER12345': {'serial_num': 'SER12345', 'site_location': 'North America'},
    'SER12346': {'serial_num': 'SER12346', 'site_location': 'North America'},
    'SER12347': {'serial_num': 'SER12347', 'site_location': 'South America'},
    'ABC12345': {'serial_num': 'ABC12345', 'site_location': 'South America'},
} 
```

实际结果是将序列号和站点位置分开。我想把它们放在排序的对象中。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T14:18:58.600

这是你想要的吗？

```
dicts = [{k: v} for (k,v) in myDict.items()]
dicts.sort(key=lambda d: (d.values()[0]['site_location'], d.values()[0]['serial_num'],)) 
```

输出：

```
import pprint
pprint.pprint(dicts) 
```

是：

```
[{'ABC12346': {'serial_num': 'ABC12346', 'site_location': 'Europe'}},
 {'SER12345': {'serial_num': 'SER12345', 'site_location': 'North America'}},
 {'SER12346': {'serial_num': 'SER12346', 'site_location': 'North America'}},
 {'ABC12345': {'serial_num': 'ABC12345', 'site_location': 'South America'}},
 {'SER12347': {'serial_num': 'SER12347', 'site_location': 'South America'}}] 
```

编辑：我正在回答你的输出格式，但这可能更有意义：

```
dicts = myDict.items()
dicts.sort(key=lambda (k,d): (d['site_location'], d['serial_num'],)) 
```

输出：

```
[('ABC12346', {'serial_num': 'ABC12346', 'site_location': 'Europe'}),
 ('SER12345', {'serial_num': 'SER12345', 'site_location': 'North America'}),
 ('SER12346', {'serial_num': 'SER12346', 'site_location': 'North America'}),
 ('ABC12345', {'serial_num': 'ABC12345', 'site_location': 'South America'}),
 ('SER12347', {'serial_num': 'SER12347', 'site_location': 'South America'})] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:28:14.547

字典不保留项目的顺序 - 因此无法排序。如果您想要排序字典的外观，您需要制作一个排序列表，然后将其插入 OrderedDict 类。下面的代码片段说明了这一点：

```
from collections import OrderedDict

myDict = {
    'SER12346': {'serial_num': 'SER12346', 'site_location': 'North America'},
    'ABC12345': {'serial_num': 'ABC12345', 'site_location': 'South America'},
    'SER12345': {'serial_num': 'SER12345', 'site_location': 'North America'},
    'SER12347': {'serial_num': 'SER12347', 'site_location': 'South America'},
    'ABC12346': {'serial_num': 'ABC12346', 'site_location': 'Europe'}
}

def sortfun(d):
    return (d[1]['site_location'], d[1]['serial_num'])

skv = sorted(myDict.iteritems(), key=sortfun)
sorted_dict = OrderedDict(skv)

print sorted_dict 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:23:42.250

我有一个解决方案`cmp`（我认为你必须使用它，因为我们混合使用 2 个键）但它不是很漂亮，我想它可以改进：

```
>>> pprint(sorted(myDict.items(), cmp=lambda x, y: cmp((x[1]['site_location'], x[1]['serial_num']), (y[1]['site_location'], y[1]['serial_num']))))
[('ABC12346', {'serial_num': 'ABC12346', 'site_location': 'Europe'}),
 ('SER12345', {'serial_num': 'SER12345', 'site_location': 'North America'}),
 ('SER12346', {'serial_num': 'SER12346', 'site_location': 'North America'}),
 ('ABC12345', {'serial_num': 'ABC12345', 'site_location': 'South America'}),
 ('SER12347', {'serial_num': 'SER12347', 'site_location': 'South America'})] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T14:32:35.483

```
>>> import pprint
>>> dic=myDict.items()
>>> dic.sort(key=lambda x:(x[1]['site_location'],x[1]['serial_num']))
>>> pprint.pprint([{k:v} for k,v in dic])
[{'ABC12346': {'serial_num': 'ABC12346', 'site_location': 'Europe'}},
 {'SER12345': {'serial_num': 'SER12345', 'site_location': 'North America'}},
 {'SER12346': {'serial_num': 'SER12346', 'site_location': 'North America'}},
 {'ABC12345': {'serial_num': 'ABC12345', 'site_location': 'South America'}},
 {'SER12347': {'serial_num': 'SER12347', 'site_location': 'South America'}}] 
```

# html - 我可以锁定 Twitter 引导表中的第一列吗？

> ID：11346112
> 
> 赞同：10
> 
> 时间：2012-07-05T14:11:39.293
> 
> 标签：html, twitter-bootstrap

我有一个使用 Twitter 引导程序构建的大型可滚动表，但想阻止第一列滚动。这可能吗？

```
<div class="row">
    <div class="span12" style="height: auto !important;overflow-x: scroll;">';      
        <table class="table table-striped table-bordered table-condensed">
        <thead>
            <th>Col1</th>
            <th>Col2</th>
            <th>Col3</th>
        </thead>
        <tbody>
        <tr>
            <td>data 1</td>
            <td>data 2</td>
            <td>data 3</td>
       </tr>
       </tbody>
       </table>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-05T15:12:53.180

根据我之前的评论，这是一个可能的解决方案的演示：

[**演示：引导表上的固定列**](http://jsfiddle.net/jackwanders/hYgnr/)

请注意，这并不是真正的测试，甚至不是修复列的完整解决方案，而是您可以构建的概念证明。

这是相关的标记。此示例使用条带、有边框、精简的 Bootstrap 表

```
<div id="scroller">
    <table class="table table-striped table-bordered table-condensed">
        <thead>
            ...
        </thead>
        <tbody>
            ...
        </tbody>
    </table>
</div> 
```

以及所需的 jQuery：

```
 $('#scroller table').each(function(){
    var table = $(this),
        fixedCol = table.clone(true),
        fixedWidth = table.find('th').eq(0).width(),
        tablePos = table.position();

    // Remove all but the first column from the cloned table
    fixedCol.find('th').not(':eq(0)').remove();
    fixedCol.find('tbody tr').each(function(){
        $(this).find('td').not(':eq(0)').remove();
    });

    // Set positioning so that cloned table overlays
    // first column of original table
    fixedCol.addClass('fixedCol');
    fixedCol.css({
        left: tablePos.left,
        top: tablePos.top
    });

    // Match column width with that of original table
    fixedCol.find('th,td').css('width',fixedWidth+'px');

    $('#scroller').append(fixedCol);
});​ 
```

和所需的 CSS：

```
#scroller {
    width: 300px;
    overflow-x: scroll;
}
#scroller table {
    /* just a quick hack to make the table overflow the containing div
       your method may differ */
    width: 600px;
}

#scroller .table.fixedCol {
    width: auto;
    position: absolute;
    /* below styles are specific for borderd Bootstrap tables
       to remove rounded corners on cloned table */
    -webkit-border-top-right-radius: 0px;
    -webkit-border-bottom-right-radius: 0px;
       -moz-border-radius-topright: 0px;
       -moz-border-radius-bottomright: 0px;
            border-top-right-radius: 0px;
            border-bottom-right-radius: 0px;
}
.table.fixedCol th,
.table.fixedCol td {
    /* background is set to white to hide underlaying column
       of original table */
    background: white;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-19T19:14:05.443

这是我对同一问题的解决方案的演示[。](http://jsfiddle.net/jacbmelo/b1nukan8/)您可以修复任何您想要的列。只需在表格上添加“固定列”类，在要保持固定的 th 和 td 上添加“固定列”。然后调用 responsiveTables.init() 来完成剩下的工作。我选择更改原始表上的 id 以使其与 JSF 事件兼容。

这是HTML：

```
<div class="table-responsive">
    <table class="table table-striped table-bordered table-hover fixed-columns">
        <thead>
            <tr>
                <th class="fixed-column">#</th>
                ...
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="fixed-column">1</td>
                ...
            </tr>
            ...
        </tbody>
    </table>
</div> 
```

这是Javascript：

```
 var responsiveTables = {
    init: function() {
        $(document).find('.fixed-columns').each(function (i, elem) {
            responsiveTables.fixColumns(elem);
        });     
    },

    fixColumns: function(table, columns) {
        var $table = $(table);
        $table.removeClass('fixed-columns');
        var $fixedColumns = $table.clone().attr('id', $table.attr('id') + '-fixed').insertBefore($table).addClass('fixed-columns-fixed');

    $fixedColumns.find('*').each(function (i, elem) {
        if ($(this).attr('id') !== undefined) {
                $table.find("[id='" + $(this).attr("id") + "']").attr('id', $(this).attr('id') + '-hidden');
            }
            if ($(this).attr('name') !== undefined) {
                $table.find("[name='" + $(this).attr("name") + "']").attr('name', $(this).attr('name') + '-hidden');
            }
        });

        if (columns !== undefined) {
            $fixedColumns.find('tr').each(function (x, elem) {
                $(elem).find('th,td').each(function (i, elem) {
                    if (i >= columns) {
                        $(elem).remove();    
                    }
                });
            });
        } else {
            $fixedColumns.find('tr').each(function (x, elem) {
                $(elem).find('th,td').each(function (i, elem) {
                    if (!$(elem).hasClass('fixed-column')) {
                        $(elem).remove();    
                    }
                });
            });
        }

        $fixedColumns.find('tr').each(function (i, elem) {
            $(this).height($table.find('tr:eq(' + i + ')').height());
        });        
    }
};

responsiveTables.init(); 
```

和CSS：

```
.table-responsive > .fixed-columns-fixed {
    position: absolute;
    display: inline-block;
    width: auto;
    border-right: 2px solid #ddd;
    background-color: #fff;
} 
```

# sql - 我将如何在 DQL 中编写此 SQL？

> ID：11346114
> 
> 赞同：1
> 
> 时间：2012-07-05T14:11:46.903
> 
> 标签：sql, doctrine-orm, dql

我所追求的是以下 SQL 查询

```
SELECT p.*
  FROM player p
 WHERE CONCAT(p.first_name, ' ', p.last_name) = ? 
```

在 DQL 中。到目前为止我所拥有的是

```
$qb->add('select', 'p')
   ->add('from', 'VNNCoreBundle:Player p')
   ->add('where', $qb->expr()->eq(
        $qb->expr()->concat('p.firstName', $qb->expr()->concat(' ', 'p.lastName')),
        ':name'
     ))
   ->setParameters(array('name' => $name)); 
```

但这是错误的。

我知道我总是可以使用本机 SQL 获取记录的 ID，然后`findOneById()`使用 Doctrine 获取记录。一方面，这样做感觉像是一种杂耍/黑客，另一方面，在 DQL 中执行直接 SQL 中的简单查询感觉有点愚蠢，因为 DQL 没有形成要非常优雅。无论如何，我已经投入了这么多时间，现在我很好奇在 DQL 中正确的做法是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:34:19.490

我最终选择了[原生 SQL](http://doctrine-orm.readthedocs.org/en/2.0.x/reference/native-sql.html)路线。我有点忘记了第三种选择。

```
$rsm = new ResultSetMapping;
$rsm->addEntityResult('Player', 'p');
$rsm->addFieldResult('p', 'id', 'player_id');
$rsm->addFieldResult('p', 'name', 'name');

$sql = " 
    SELECT p.*
      FROM players p
     WHERE CONCAT(p.first_name, ' ', p.last_name) = ?
";

$query = $this->getEntityManager()->createNativeQuery($sql, $rsm);
$query->setParameter(1, $name); 
```

# asp.net-mvc - ASP.NET MVC DateTime 动态格式

> ID：11346116
> 
> 赞同：-1
> 
> 时间：2012-07-05T14:11:48.633
> 
> 标签：asp.net-mvc, datetime, format

我正在寻找一种方法来动态指定视图中我的模型 DateTime 字段的格式。我需要这些是可编辑的（这意味着我希望对它们的更改正确绑定到回发模型）。我不担心验证，因为我将在结果文本框上使用 jquery datepicker 控件。

到目前为止，我所发现的只是一种在模型中设置数据注释格式的方法——这种方法过于静态和限制（除非还有一种在运行时修改数据注释的方法？）。还找到了为 DateTime 制作模板的指南，但这也是静态的。找到了一些方法来格式化视图中的字段，以满足不会回发更改的“仅显示”要求。

到目前为止，我唯一想到的是在我的所有模型中为每个 DateTime 字段设置一个单独的字符串字段，在仅显示字符串字段之前手动在控制器中进行转换，然后将它们转换回来。在我开始他的凌乱方法之前，是否有人对更简单/更清洁的方法有任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:15:59.887

您可以在技术上编写自己的注释，根据您的需要为您提供动态格式。

这些是在运行时评估的，因此根据您想要返回的内容，您可以执行此操作。

我目前正在使用属性为特定用途返回非常具体的数据。

# java - Java JPA 库

> ID：11346119
> 
> 赞同：0
> 
> 时间：2012-07-05T14:11:59.247
> 
> 标签：java, hibernate, jpa

在工作中，我们有一个有趣的库，它建立在 Hibernate 之上。它是一个通用 DAO 的实现，但完全充满了未来。例如，以下是其中之一：

我们的模型中的所有内容都是延迟加载的，但是当我们想要从数据库中检索一些关系时，我们通常会创建一个我们想要检索的类型的模板对象，然后设置我们需要获取的关系。因此，例如让我们假设以下对象。

```
 @SuppressWarnings("serial")
 @Entity
 @Table(name="MYTABLE")
 public class Type extends BaseAudit<TypeID>{

/**
 * Este campo representa el codigo de autorizacion padre
 *

 */
@Column(name="CODIGOTIPOAUTORIZACIONPADRE")
private Long codigonPadre ;

/**
 * Este campo representa el nombre del tipo de autorizacion
 *

 */
@Column(name="NOMBRETIPOAUTORIZACION")
private String nombreTipoAutorizacion ;

/**
 * 
 *
 */
@ManyToOne(fetch = FetchType.LAZY)
@JoinColumns({
    @JoinColumn(name = "CODIGOSISTEMA", referencedColumnName = "SYSID", insertable = false, updatable = false),
    @JoinColumn(name = "CODIGOCOMPANIA", referencedColumnName = "COMID", insertable = false, updatable = false)
})  
private CompanySystemDto companiaSistemaDTO;

/**
 * 
 *
 */
@ManyToOne(fetch = FetchType.LAZY)
@JoinColumns({      
    @JoinColumn(name = "CODIGOCOMPANIA", referencedColumnName = "CODIGOCOMPANIA", insertable = false, updatable = false),
    @JoinColumn(name = "CODIGOSISTEMA", referencedColumnName = "CODIGOSISTEMA", insertable = false, updatable = false),
    @JoinColumn(name = "CODIGOTIPOAUTORIZACIONPADRE", referencedColumnName = "CODIGOTIPOAUTORIZACION", insertable = false, updatable = false),      
})  
private TipoAutorizacionDTO tipoAutorizacionPadreDTO;

@OneToMany(mappedBy="tipoAutorizacionPadreDTO") 
private Collection<TipoAutorizacionDTO> listaAutorizaciones;
    //..... Getters and Setters 
```

如果我们需要获取它拥有的任何关系，我们将执行以下操作：

```
Type myType = new Type();
myType.setTipoAutorizacionPadreDTO(new TipoAutorizacionPadreDTO()). 
```

简而言之..库所做的是搜索模板中不为空的任何关系对象，并根据某些条件从数据库中检索它们。标准可以是我们想要的任何东西。因此，假设我们想要 codigonPadre 为 1 的所有 Type 对象，模板应该是：

```
Type myType = new Type();
myType.setCodigonPadre(1L);
myType.setTipoAutorizacionPadreDTO(new TipoAutorizacionPadreDTO()).
//Code for searching in the database 
```

上述模板的作用是：查找 codigonPadre 属性为 1 的所有 Type 实例，并获取该实例的 tipoAutorizacionPadreDTO 关系。

我发现这个“对象模板”系统非常有用，比 JPQL 或任何其他 JPA 机制更有用。我知道 JPA 2 规范现在有 Criteria API，我们可以在其中完成一些非常相似的东西。但问题是......**是否有任何库可以管理这种风格并准备好使用**？

显然，我正在谈论的库具有更多功能......例如，它们具有所谓的 CriteriaRestrictions，我们在其中指定模板对象中的属性名称和我们想要的限制。例子：

```
Type myType = new Type();
myType.setCodigonPadre(1L);
myType.setTipoAutorizacionPadreDTO(new TipoAutorizacionPadreDTO())
myType.setNombreTipoAutorizacion("likeValue");
  myType.addCriteriaRestriction("nombreTipoAutorizacion",RestrictionType.INSENSITIVE_LIKE); 
```

这将获取 codigonPadre 具有 1L 且 nombreTipoAutorizacion 在其值中具有 likeValue 的所有对象。

该库为我节省了数小时的编码时间，特别是在获取和搜索对象时，而无需创建服务方法来执行特定活动。这就是为什么我想在互联网上找到类似的东西，以便我可以在未来的 JEE 项目中使用它们。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:22:18.777

我知道 Seam 2 附带了类似的东西。它被称为Seam 应用程序框架。

但我不推荐使用它，因为它提供了额外的抽象，使其更难理解。

# java - JXMultiSplitPane 隐藏节点导致绘制问题

> ID：11346120
> 
> 赞同：2
> 
> 时间：2012-07-05T14:11:59.017
> 
> 标签：java, swing, layout, swingx, multisplitpane

当我隐藏 JXMultiSplitPane 的一个节点时，我遇到了绘画问题。以下 SSCCE 说明了这种行为：

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.SwingUtilities;

import org.jdesktop.swingx.JXMultiSplitPane;
import org.jdesktop.swingx.MultiSplitLayout;
import org.jdesktop.swingx.MultiSplitLayout.Divider;
import org.jdesktop.swingx.MultiSplitLayout.Leaf;
import org.jdesktop.swingx.MultiSplitLayout.Node;
import org.jdesktop.swingx.MultiSplitLayout.Split;

public class TestMultiSplitPane {

    public static final String LEFT = "left";
    public static final String CENTER = "center";
    public static final String RIGHT = "right";

    public static final String TOP = "top";
    public static final String MIDDLE = "middle";
    public static final String BOTTOM = "bottom";

    protected void initUI() {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        Split horizontal = new Split();
        Split left = getVerticalSplit(LEFT, 0.5, 0.5);
        left.setWeight(0.2);
        Split center = getVerticalSplit(CENTER, 0.8, 0.2);
        center.setWeight(0.6);
        Split right = getVerticalSplit(RIGHT, 0.5, 0.5);
        right.setWeight(0.2);
        horizontal.setChildren(left, new Divider(), center, new Divider(), right);
        MultiSplitLayout layout = new MultiSplitLayout(horizontal);
        JXMultiSplitPane splitPane = new JXMultiSplitPane(layout);
        addButton(LEFT + TOP, splitPane);
        addButton(CENTER + TOP, splitPane);
        addButton(RIGHT + TOP, splitPane);
        addButton(LEFT + BOTTOM, splitPane);
        addButton(CENTER + BOTTOM, splitPane);
        addButton(RIGHT + BOTTOM, splitPane);
        frame.add(splitPane);
        frame.setBounds(50, 50, 1024, 768);
        frame.setVisible(true);
    }

    protected void addButton(final String buttonName, final JXMultiSplitPane splitPane) {
        final JButton button = new JButton(buttonName);
        splitPane.add(buttonName, button);
        button.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                MultiSplitLayout layout = splitPane.getMultiSplitLayout();
                Node node = layout.getNodeForName(buttonName);
                Split parent = node.getParent();
                parent.hide(node);
                splitPane.invalidate();
                splitPane.revalidate();
                splitPane.repaint();
            }
        });
    }

    public Split getVerticalSplit(String name, double topWeight, double bottomWeight) {
        Split split = new Split();
        split.setRowLayout(false);
        Leaf top = new Leaf(name + TOP);
        top.setWeight(topWeight);
        Leaf bottom = new Leaf(name + BOTTOM);
        bottom.setWeight(bottomWeight);
        split.setChildren(top, new Divider(), bottom);
        return split;
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new TestMultiSplitPane().initUI();

            }
        });
    }

} 
```

您可以单击显示的任何按钮，它应该会被隐藏，但是当我将鼠标移到不同的按钮上时，拆分窗格的重新绘制是有问题的。

对于那些使用 Maven 的人，这里是必需的依赖项：

```
 <dependency>
        <groupId>org.swinglabs.swingx</groupId>
        <artifactId>swingx-core</artifactId>
        <version>1.6.3</version>
    </dependency> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:55:49.307

我最终找到了解决方案。要在布局中隐藏节点，我们可以简单地使用 方法`displayNode(String, boolean)`。

因此，在 中`actionPerformed`，我需要调用的是：

```
layout.displayNode(buttonName, false); 
```

完整的工作代码：

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.SwingUtilities;

import org.jdesktop.swingx.JXMultiSplitPane;
import org.jdesktop.swingx.MultiSplitLayout;
import org.jdesktop.swingx.MultiSplitLayout.Divider;
import org.jdesktop.swingx.MultiSplitLayout.Leaf;
import org.jdesktop.swingx.MultiSplitLayout.Split;

public class TestMultiSplitPane {

    public static final String LEFT = "left";
    public static final String CENTER = "center";
    public static final String RIGHT = "right";

    public static final String TOP = "top";
    public static final String MIDDLE = "middle";
    public static final String BOTTOM = "bottom";

    protected void initUI() {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        Split horizontal = new Split();
        Split left = getVerticalSplit(LEFT, 0.5, 0.5);
        left.setWeight(0.2);
        Split center = getVerticalSplit(CENTER, 0.8, 0.2);
        center.setWeight(0.6);
        Split right = getVerticalSplit(RIGHT, 0.5, 0.5);
        right.setWeight(0.2);
        horizontal.setChildren(left, new Divider(), center, new Divider(), right);
        MultiSplitLayout layout = new MultiSplitLayout(horizontal);
        JXMultiSplitPane splitPane = new JXMultiSplitPane(layout);
        addButton(LEFT + TOP, splitPane);
        addButton(CENTER + TOP, splitPane);
        addButton(RIGHT + TOP, splitPane);
        addButton(LEFT + BOTTOM, splitPane);
        addButton(CENTER + BOTTOM, splitPane);
        addButton(RIGHT + BOTTOM, splitPane);
        frame.add(splitPane);
        frame.setBounds(50, 50, 1024, 768);
        frame.setVisible(true);
    }

    protected void addButton(final String buttonName, final JXMultiSplitPane splitPane) {
        final JButton button = new JButton(buttonName);
        splitPane.add(buttonName, button);
        button.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                MultiSplitLayout layout = splitPane.getMultiSplitLayout();
                layout.displayNode(buttonName, false);
            }
        });
    }

    public Split getVerticalSplit(String name, double topWeight, double bottomWeight) {
        Split split = new Split();
        split.setRowLayout(false);
        Leaf top = new Leaf(name + TOP);
        top.setWeight(topWeight);
        Leaf bottom = new Leaf(name + BOTTOM);
        bottom.setWeight(bottomWeight);
        split.setChildren(top, new Divider(), bottom);
        return split;
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new TestMultiSplitPane().initUI();

            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:48:39.000

我知道你问这个问题已经有一段时间了，但我搜索了很多，直到我找到了一个解决方案（虽然不是一个很好的解决方案），也许这会对某人有所帮助。
我在添加到 splitPane 的面板中添加/删除了很多组件，如果我在添加组件之前调整了拆分器的大小，它就会卡在那里，要么剪掉我的面板的一部分，要么变大。

正如文档中所说：

> MultiSplitLayout 的“floatingDividers”属性最初为 true，一旦任何 Divider 重新定位，MultiSplitPane 就会将其设置为 false。当 floatingDividers 为 false 时，每个 Leaf（组件）的右/下边缘由其后面的 Divider 的位置定义。换句话说，一旦用户移动 Divider，布局就不再取决于任何组件的首选大小，而是由 Divider 的当前位置和权重定义。

我所做的是在每次调整大小时调用 setFloatingDividers(true) 方法（与添加/删除组件相关的调整大小）。由此产生的问题是分离器的位置丢失。

# logging - 在 vb6 记录集中记录更改

> ID：11346125
> 
> 赞同：0
> 
> 时间：2012-07-05T14:12:18.433
> 
> 标签：logging, vb6, recordset

我有一个带有数据网格的 adodc 对象，以便在 vb6 中有一个可编辑的表。我必须将用户所做的任何更改存储在数据库中。

第一个想法是用来`Sub grdDataGrid_Click()`获取正在使用的行，但为此，我需要知道该行中是否有任何单元格被修改并获取它的原始值和新值。有没有办法检查它？正如我所见，记录集有 Will 和 Complete 事件，但我以前从未使用过它们。他们是否能够获取已更改单元格的旧值和新值？我还考虑过在我正在使用的表上的 oracle 中使用触发器（因为它可以获取旧数据和新数据），但在这种情况下，我无法获取已登录并进行更改的用户。

我愿意提出任何想法。它不必仅在 vb6 中，如果仅靠一件事还不够，我可以使用存储过程、函数、触发器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T22:28:48.017

尝试查看**WillChangeRecord**事件。它将告诉您为什么记录正在/正在更改，并且它具有将更改的记录的记录集。您可以在[此处](http://msdn.microsoft.com/en-us/library/windows/desktop/ms678373%28v=vs.85%29.aspx)查看 Microsoft 的文档。

```
Adodc1_WillChangeRecord(ByVal adReason As ADODB.EventReasonEnum, ByVal cRecords As Long, adStatus As ADODB.EventStatusEnum, ByVal pRecordset As ADODB.Recordset) 
```

# sql-server-2008 - EF 4.1 POCO 映射公用表

> ID：11346127
> 
> 赞同：0
> 
> 时间：2012-07-05T14:12:23.380
> 
> 标签：sql-server-2008, entity-framework-4.1

我有两个“实体”表：提供者和用户。Provider 和 User 都可以有多个地址（运输、账单等）。

与其将地址信息放在每个实体表中，我想创建一个它们共同的表：地址表。例如，我研究了创建一个带有主键（身份列）、实体类型（提供者或用户）、实体键（父实体表的主键）和地址类型（运输等）的地址表。带有必要的地址信息。

我遇到的一个问题是外键约束。如果我有一个来自与地址行相关的父实体表的外键，我在尝试插入数据时发现我有外键违规。

我正在考虑删除表中的 FK，然后在 EF 4.1 上创建手动映射，但我不知道该怎么做：

[http://i49.tinypic.com/2dt56dv.png](http://i49.tinypic.com/2dt56dv.png)（这是表格的图像 - 地址表中的 objectid 包含 userid 或 providerid，objecttype 是一个 varchar，可以是“USER”或“PROV”）

我怎样才能解决这个问题？我想使用一个表格作为地址，但如果没有另一位父母的相关行，我不能为一位父母添加一个孩子。当然，我想继续使用外键来实现引用完整性。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:18:42.437

这是一个很常见的情况。

```
[Provider table]
ProviderID (PK)
AddressID

[User table]
UserID (PK)
AddressID

[Address table]
AddressID (PK)
Street1
Street2.... 
```

进入提供者表并从 Provider.addressID 添加一个 FK 到 Address.AddressID

进入用户表并添加一个从 User.addressID 到 Address.AddressID 的 FK

这应该有效，并且不会违反任何 FK。

# c - c中使用fork时的缓冲机制

> ID：11346131
> 
> 赞同：3
> 
> 时间：2012-07-05T14:12:30.853
> 
> 标签：c, file-io

> **可能重复：**
> [linux gcc 中 fork() 的工作](https://stackoverflow.com/questions/3513242/working-of-fork-in-linux-gcc)
> [为什么这段代码打印两次？](https://stackoverflow.com/questions/9581787/why-does-this-code-print-two-times)

我想知道以下代码输出背后的原因：

```
#include<stdio.h>
#include<stdlib.h>
#include<unistd.h>

int main()
{
   FILE *fp;
   int n;
   printf("%d",45);
   //fflush(stdout);
   if((n=fork())>0){
      printf("in parent\n");  
      exit(0);
   }
   else if(n==0)
       printf("%d",45);
} 
```

**输出**是

```
45inparent
4545 
```

如果我使用 fflush，那么**输出**是

```
45inparent
45 
```

另外，我在linux平台上运行

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T14:25:55.147

子进程继承打开的文件描述符（在这种情况下为标准输出）和与之关联的缓冲区。

*   如果在 fork 之前不刷新缓冲区，那么缓冲区的内容就会重复（包括“45”），并且会打印两次“45”。
*   如果在 fork 之前刷新，则缓冲区被清空，并且子进程获得缓冲区的空副本，因此父进程仅打印一次“45”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:17:36.027

第一个 printf() 将字符串写入`45`内存缓冲区。

在 fork() 调用期间，缓冲区实际上在子进程中复制，因此父进程和子进程都`45`在 stdout 的缓冲区中。

在两个进程中刷新该缓冲区将写入`45`两次。

# php - 带有 CodeIgniter 的 JQuery 日期选择器

> ID：11346132
> 
> 赞同：1
> 
> 时间：2012-07-05T14:12:31.620
> 
> 标签：php, jquery, jquery-ui, codeigniter, datepicker

我在我的 codeigniter 项目中使用 jQuery 日期选择器

在我看来，我像这样使用它

```
 <script>
     $(function() {
       $( "#from-datepicker" ).datepicker();
     });
  </script>

  <script>
    $(function() {
      $( "#to-datepicker" ).datepicker();
    });
  </script>

  <div style="float:left; width:330px">
     <input name="from-date" type="text" id="from-datepicker" />
  </div>

  <div style="float:left; width:330px">
     <input name="to-date" type="text" id="to-datepicker" />
  </div> 
```

在我的控制器中，我有

```
public function titlesDownloads(){
    if($_POST){
        $form = $this->input->post();
        $boxes = $form['boxes'];
        $titles = $form['titles'];
        $from_date = date('Y-m-d',strtotime($form['from-date']));
        $to_date = date('Y-m-d',strtotime($form['to-date']));
        $data['titles_downloads'] = $this->Statistic_model->getTitlesDownloads($boxes, $titles, $ipsegments, $from_date, $to_date);
        $data['from_date'] = $from_date;
        $data['to_date'] = $to_date;
        $this->load->view('statistic/titles-downloads', $data);
    }
} 
```

在我的模型中，我具有获取下载次数的功能

```
 public function getTitlesDownloads($boxes, $titles, $from_date, $to_date){
    $query = $this->db->select('mc_boxes_idmc_boxes, mc_boxes.location, idtitle_history, titles.title, COUNT(mc_boxes_has_downloads.idtitle_history) AS Titles_Downloads ')
            ->from('mc_boxes_has_downloads')
            ->join('mc_boxes', 'mc_boxes_has_downloads.mc_boxes_idmc_boxes = mc_boxes.idmc_boxes', 'left')
            ->join('titles', 'mc_boxes_has_downloads.idtitle_history = titles.idtitles', 'left')
            ->where_in('mc_boxes_idmc_boxes', $boxes)
            ->where_in('idtitle_history', $titles)
            ->where('actiontime >=', $from_date)
            ->where('actiontime <=', $to_date)
            ->group_by('mc_boxes_idmc_boxes')
            ->group_by('idtitle_history')
            ->get();
    $data = $query->result_array();
    return $data;
} 
```

现在，对于特定的标题 id=7，6 月份有 4 次下载。但是当我运行查询时，它会返回三个。跳过了 6 月 30 日的最后一次下载。

我认为日期选择器正在跳过所选日期的上限和下限。虽然在我的查询中我写了 >= startdate 和 >=enddate。

为什么它跳过 lastdate ？

任何想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:18:24.863

由于您只是传递一个日期而没有传递时间，因此可能假设时间是午夜。因此，小于 6 月 30 日的午夜会阻止显示 6 月 30 日的任何内容。

您最好的选择可能是仅添加一天并使用少于查找前一天发生的任何事情。

# c++ - C++ 使用参数的默认值

> ID：11346135
> 
> 赞同：1
> 
> 时间：2012-07-05T14:12:50.087
> 
> 标签：c++, parameters, default-value

我是 C++ 新手（来自 C# 背景），我有一个具有以下签名的函数

```
 void AddBenchNode(ref_ptr<Group> root ,ref_ptr<Node> benches, bool setAttitude = false, float scale_x =.15, float scale_y =15, float scale_z = 15, int positionx = 250, int positiony = 100, int positionz =0 )
{

} 
```

但是当我尝试如下调用代码时，我收到一个错误，指出函数不接受 4 个参数。

```
//then I try to call my function like so
AddBenchNode(root, benches, false, 250); 
```

但我反而收到以下错误消息

**错误 C2660：“AddBenchNode”：函数不采用 3 个参数**

希望能解释一下 C++ 如何做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T14:20:50.457

检查 .hpp 文件中的原型。它可能被宣布为

```
void AddBenchNode(ref_ptr<Group> root ,ref_ptr<Node> benches, bool setAttitude, 
                  float scale_x, float scale_y, float scale_z, int positionx, 
                  int positiony, int positionz); 
```

编辑：标题中的原型应该是

```
void AddBenchNode(ref_ptr<Group> root ,ref_ptr<Node> benches, bool setAttitude = false, float scale_x =.15, float scale_y =15, float scale_z = 15, int positionx = 250, int positiony = 100, int positionz =0 ); 
```

然后你的 cpp 文件应该只有

```
void AddBenchNode(ref_ptr<Group> root ,ref_ptr<Node> benches, bool setAttitude, float scale_x, float scale_y, float scale_z, int positionx, int positiony, int positionz)
{

} 
```

也就是说，默认参数在原型中，而不是在实际定义中。

# c# - 使用 DirectShow 获取 MP4 文件的持续时间

> ID：11346136
> 
> 赞同：0
> 
> 时间：2012-07-05T14:12:51.003
> 
> 标签：c#, directshow, mp4, duration, directshow.net

我需要获取 mp4 文件的持续时间，最好以秒为单位的两倍。我正在使用 DirectShow（参见下面的代码），但它一直抛出一个特别无用的错误。我想知道是否有人对此有简单的解决方案。（说真的，谁知道获取这些信息会如此困难）

```
public static void getDuration(string moviePath)
    {
        FilgraphManager m_objFilterGraph = null;
        m_objFilterGraph = new FilgraphManager();
        m_objFilterGraph.RenderFile(moviePath);

        IMediaPosition m_objMediaPosition = null;
        m_objMediaPosition = m_objFilterGraph as IMediaPosition;

        Console.WriteLine(m_objMediaPosition.Duration);
    } 
```

每当我运行此代码时，我都会收到错误消息：“HRESULT 异常：0x80040265”

我也尝试过使用这个：[Getting length of video](https://stackoverflow.com/questions/6215185/getting-length-of-video) but it doesn't work or because I don't think that it works on MP4 files.

说真的，我觉得必须有一个更简单的方法来做到这一点。

注意：我宁愿避免使用像 ffmpeg 这样的 exe，然后解析输出以获取信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:17:13.937

您正在正确地解决问题。您需要从源`.MP4`文件到视频和音频渲染器构建一个良好的管道。然后`IMediaPosition.Duration`会给你你想要的。目前您正在获得，`VFW_E_UNSUPPORTED_STREAM`因为您无法构建管道。

请注意，在干净的 Windows 中 DirectShow 中没有对 MPEG-4 的良好支持，您需要安装第三方解析器来添加丢失的块。这可能是您的问题的原因。有很好的[免费 DirectShow Mpeg-4 过滤器](http://www.gdcl.co.uk/mpeg4/)可以填补这个空白。

[链接获取视频长度](https://stackoverflow.com/questions/6215185/getting-length-of-video)下的代码示例也基本有效，但是它使用了已弃用的组件，该组件另外对相关媒体文件做出了额外的假设。前提是系统中有支持`.MP4`，`IMediaPosition.Duration`就是给你你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T12:24:57.773

您可以使用 IMediaPosition 接口中的 get_Duration() 。

这将返回一个以秒为单位的视频持续时间的双精度值。

```
 Double Lenght;

    m_FilterGraph = new FilterGraph()

//Configure the FilterGraph()

    m_mediaPosition = m_FilterGraph as IMediaPosition;
    m_mediaPosition.get_Duration(out Length); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-06T06:31:36.770

也使用 Windows Media Player 组件，我们可以获得视频的持续时间。
我希望以下代码片段可以帮助你们：

```
using WMPLib;
// ...
var player = new WindowsMediaPlayer();
var clip = player.newMedia(filePath);
Console.WriteLine(TimeSpan.FromSeconds(clip.duration)); 
```

> 并且不要忘记添加**`wmp.dll`**将出现在**`System32`**文件夹中的引用。

# java - Wro4j LessCss 支持

> ID：11346140
> 
> 赞同：2
> 
> 时间：2012-07-05T14:12:59.717
> 
> 标签：java, maven, spring-mvc, less

我正在尝试在我的工作网络应用程序中实现 LESS CSS。Wro4j 使用此处提供的默认设置：http: [//alexo.github.com/wro4j/](http://alexo.github.com/wro4j/)

但是将 init-params 添加到此处提供的过滤器中：[http](http://code.google.com/p/wro4j/wiki/LessCssSupport) ://code.google.com/p/wro4j/wiki/LessCssSupport确实 1\. 由于 url 未知而遇到异常（只有 uri，所以我改为 uri） 2.打开localhost:8080/template/res/all.css时遇到404

这是必要的代码：

```
<!-- Wro4j Filter -->
<filter>
    <filter-name>WebResourceOptimizer</filter-name>
    <filter-class>ro.isdc.wro.http.WroFilter</filter-class>
    <init-param>
        <param-name>configuration</param-name>
        <param-value>DEPLOYMENT</param-value>
    </init-param>
    <init-param>
        <param-name>managerFactoryClassName</param-name>
        <param-value>ro.isdc.wro.extensions.manager.ExtensionsConfigurableWroManagerFactory</param-value>
    </init-param>
    <init-param>
        <param-name>uriLocators</param-name>
        <param-value>servletContext,classpath,uri</param-value>
    </init-param>
    <init-param>
        <param-name>preProcessors</param-name>
        <param-value>cssUrlRewriting,cssImport,bomStripper,semicolonAppender,lessCss</param-value>
    </init-param>
    <init-param>
        <param-name>postProcessors</param-name>
        <param-value>cssVariables,cssMinJawr,jsMin</param-value>
    </init-param>
</filter>

<filter-mapping>
    <filter-name>WebResourceOptimizer</filter-name>
    <url-pattern>/res/*</url-pattern>
</filter-mapping> 
```

wro.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<groups xmlns="http://www.isdc.ro/wro">
    <group name="all">
        <css>/resources/styles/reset.css</css>
        <css>/resources/styles/*.less</css>
        <js>/resources/scripts/*.js</js>
    </group>
</groups> 
```

**更新**

调试信息： http: [//nopaste.me/raw/11966466624ff5e201716e0.txt](http://nopaste.me/raw/11966466624ff5e201716e0.txt)

刚刚删除`bomStripper`，它的工作原理！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:56:28.380

您可以对 wro4j 中的类使用 DEBUG 级别的日志记录吗？出现异常时会显示 404，我假设异常是由 LessCssProcessor 导致的，它无法处理有效的 css 代码（不少于）。

解决方法是仅将 LessCssProcessor 应用于具有“*.less”扩展名的资源。最新版本的 wro4j（最新版本是 1.4.7）可以做到这一点。只需检查文档中的示例。

# android - 调用 PowerManager.goToSleep 时，Activity 被销毁

> ID：11346142
> 
> 赞同：0
> 
> 时间：2012-07-05T14:13:06.657
> 
> 标签：android, android-activity

作为对调用 PowerManager.goToSleep(...) 的响应，我有一个活动有时会被系统破坏。行为不一致，我无法弄清楚原因。

这是我活动的 onCreate 的相关代码，这是代码中最相关的部分：

```
 protected void onCreate(Bundle bundle) {
        super.onCreate(bundle);

        requestWindowFeature(android.view.Window.FEATURE_NO_TITLE);

        IntentFilter userprsentfilter = new IntentFilter(Intent.ACTION_USER_PRESENT);
        mUserPresentReceiver = new UserPresentReceiver();
        registerReceiver(mUserPresentReceiver,userprsentfilter);

        Log.d(TAG, "created.");
    }

    protected void onDestroy() {
        Log.d(TAG, "finished.");
    } 
```

在某个地方，在某个遥远的服务上，有时是通过活动本身，

> PowerManager.goToSleep(SystemClock.uptimeMillis())

被称为导致活动被破坏。

谁能解释一下为什么系统有时会在调用 PowerManager.goToSleep 时尝试破坏活动？此外，有没有办法确定或降低活动被系统破坏的机会？我可以肯定地说，当这种情况发生时，资源并不稀缺。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:25:21.100

所有 Android 应用程序都可能随时关闭。当应用程序处于后台、消耗过多系统资源或手机休眠时，可能会发生这种情况。你不能（也不应该试图）改变这种行为：它是故意这样做的，而且有很好的理由。

如果您有一个操作需要在这些情况下继续运行，您需要将其实现为服务。这将使其即使在手机处于睡眠状态时也能运行。

# java - 从 Java 随机访问 VB6 二进制数据

> ID：11346149
> 
> 赞同：2
> 
> 时间：2012-07-05T14:13:30.557
> 
> 标签：java, vb6, vb6-migration, random-access

我正在尝试用 Java 编写分布式应用程序，但是我正在编写的程序正在替换 VB6 等效程序。使用的数据文件是包含使用 VB6 put 方法编写的二进制数据的实时文件，并且经常被多个应用程序使用。

通过将整条记录（160 字节）读入字节数组 buf，我已成功从文件中检索到文本。然后使用以下行提取文本字段

`new String(Arrays.copyOfRange(buf, 15, 40), "ISO-8859-1");`

我还需要提取 VB6 数据类型 Boolean、Double、Integer、Long 和 Single。最终我可能也需要日期时间，但第一阶段不需要。要进行双打，我知道在 VB6 中字节序是小字节序而不是大字节序，所以我有以下功能

```
public static double toDouble(byte[] bytes) {
    return ByteBuffer.wrap(bytes).order(ByteOrder.LITTLE_ENDIAN).getDouble();
} 
```

前几个数据字段是字符串，然后是 2 个双精度，此时的输出是：

```
Barcode: 1            
Dept Code: 18
Description: MISC NON VAT             
Trade Price: 0.0
Retail Price: 0.009999999776482582 
```

如您所见，前 3 个是合乎逻辑的，并且与数据文件中的内容相匹配。交易价格应该是 0.0，这样很好，但零售价应该是 0.01，如果我将它四舍五入，这将是正确的，但是，A. 我对四舍五入价格和增值税信息和 B. 我无法合理地将任何更改写回文件，就好像我正在阅读有边距或错误，那么我可能会以相同的误差边距写作。我也尝试过手动位移，但是如果我尝试位移超过 31 位，我当然需要这样做才能执行 56 位，但是对于双 Java 会抱怨。

对此的任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:42:30.117

如果我尝试这样做，我想我会编写一个 VB6StreamReader，它封装了 VB6 原语的读取，并处理数据中的怪癖，这些怪癖是通过 VB6 中的 Put 写入数据的方式产生的。

关于舍入，大多数浮点数都以您描述的方式表示。您是否担心 VB6 以非标准方式对浮点数进行编码？Visual Basic 使用 IEEE 754。

* * *

有用的 IEEE-754 计算器： [http ://babbage.cs.qc.cuny.edu/IEEE-754/](http://babbage.cs.qc.cuny.edu/IEEE-754/)

# c++ - 如何处理 RAII 的构造函数失败

> ID：11346152
> 
> 赞同：32
> 
> 时间：2012-07-05T14:13:40.363
> 
> 标签：c++, exception, raii

我熟悉 RAII 的优点，但我最近在这样的代码中遇到了一个问题：

```
class Foo
{
  public:
  Foo()
  {
    DoSomething();
    ...     
  }

  ~Foo()
  {
    UndoSomething();
  } 
} 
```

一切都很好，除了构造函数`...`部分中的代码引发了异常，结果`UndoSomething()`从未被调用。

有一些明显的方法可以解决这个特定的问题，比如包装`...`在一个 try/catch 块中，然后调用`UndoSomething()`，但是 a: 那是重复的代码，而 b: try/catch 块是一种代码味道，我通过使用 RAII 技术来尝试和避免。而且，如果涉及多个 Do/Undo 对，代码可能会变得更糟，更容易出错，我们必须在中途清理。

我想知道有更好的方法来做到这一点 - 也许一个单独的对象需要一个函数指针，并在它反过来被破坏时调用该函数？

```
class Bar 
{
  FuncPtr f;
  Bar() : f(NULL)
  {
  }

  ~Bar()
  {
    if (f != NULL)
      f();
  }
} 
```

我知道这不会编译，但它应该显示原理。Foo然后变成...

```
class Foo
{
  Bar b;

  Foo()
  {
    DoSomething();
    b.f = UndoSomething; 
    ...     
  }
} 
```

请注意， foo 现在不需要析构函数。这听起来比它的价值更麻烦，还是这已经是一种常见的模式，有一些有用的东西可以帮助我处理繁重的工作？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-05T14:20:13.537

问题是你的班级试图做太多事情。RAII的原理是获取一个资源（要么在构造函数中，要么在后面），析构函数释放；该类仅用于管理该资源。

在您的情况下，除了`DoSomething()`并且`UndoSomething()`应该是类用户的责任，而不是类本身。

正如 Steve Jessop 在评论中所说：如果您有多个资源要获取，那么每个资源都应该由其自己的 RAII 对象管理；并且将它们聚合为另一个类的数据成员，依次构造它们可能是有意义的。然后，如果任何一次获取失败，之前获取的所有资源都会被各个类成员的析构函数自动释放。

（另外，记住[三法则](https://stackoverflow.com/q/4172722/204847)；你的类需要防止复制，或者以某种合理的方式实现它，以防止多次调用`UndoSomething()`）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-07-05T14:22:37.790

只需将`DoSomething`/`UndoSomething`制成适当的 RAII 句柄：

```
struct SomethingHandle
{
  SomethingHandle()
  {
    DoSomething();
    // nothing else. Now the constructor is exception safe
  }

  SomethingHandle(SomethingHandle const&) = delete; // rule of three

  ~SomethingHandle()
  {
    UndoSomething();
  } 
} 

class Foo
{
  SomethingHandle something;
  public:
  Foo() : something() {  // all for free
      // rest of the code
  }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-05T14:22:08.980

我也会使用 RAII 来解决这个问题：

```
class Doer
{
  Doer()
  { DoSomething(); }
  ~Doer()
  { UndoSomething(); }
};
class Foo
{
  Doer doer;
public:
  Foo()
  {
    ...
  }
}; 
```

doer 在 ctor 主体开始之前创建，并在析构函数因异常失败或对象被正常销毁时被销毁。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-07-05T14:25:28.700

你的一节课太多了。将 DoSomething/UndoSomething 移动到另一个类（'Something'），并将该类的对象作为类 Foo 的一部分，因此：

```
class Foo
{
  public:
  Foo()
  {
    ...     
  }

  ~Foo()
  {
  } 

  private:
  class Something {
    Something() { DoSomething(); }
    ~Something() { UndoSomething(); }
  };
  Something s;
} 
```

现在，在调用 Foo 的构造函数时已经调用了 DoSomething，如果 Foo 的构造函数抛出异常，则 UndoSomething 会被正确调用。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-07-05T14:31:14.120

try/catch 通常*不是*代码异味，它应该用于处理错误。但是，在您的情况下，这将是代码异味，因为它不处理错误，而只是进行清理。这就是析构函数的用途。

(1) 如果在构造函数失败时应该调用析构函数中的*所有内容，只需将其移至私有清理函数，由析构函数调用，在失败的情况下由构造函数调用。*这似乎是你已经完成的。好工作。

(2) 一个更好的想法是：如果有多个可以单独破坏的 do/undo 对，它们应该被包装在自己的小 RAII 类中，它是小任务，并自行清理。我不喜欢你目前给它一个可选的清理指针函数的想法，这只是令人困惑。清理应始终与初始化配对，这是 RAII 的核心概念。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-06T11:27:12.380

经验法则：

*   如果您的班级手动管理某些内容的创建和删除，那么它做的太多了。
*   如果您的班级手动编写了复制分配/构造，则可能管理过多
*   例外情况：一个类，其唯一目的是管理一个实体

第三条规则的示例是`std::shared_ptr`, `std::unique_ptr`, [`scope_guard`](https://stackoverflow.com/questions/48647/does-scopeguard-use-really-lead-to-better-code), `std::vector<>`, `std::list<>`, `scoped_lock`，当然还有`Trasher`下面的类。

* * *

附录。

你可以走这么远，写一些东西来与 C 风格的东西交互：

```
#include <functional>
#include <iostream>
#include <stdexcept>

class Trasher {
public:
    Trasher (std::function<void()> init, std::function<void()> deleter)
    : deleter_(deleter)
    {
        init();
    }

    ~Trasher ()
    {
        deleter_();
    }

    // non-copyable
    Trasher& operator= (Trasher const&) = delete;
    Trasher (Trasher const&) = delete;

private:
    std::function<void()> deleter_;
};

class Foo {
public:
    Foo ()
    : meh_([](){std::cout << "hello!" << std::endl;},
           [](){std::cout << "bye!"   << std::endl;})
    , moo_([](){std::cout << "be or not" << std::endl;},
           [](){std::cout << "is the question"   << std::endl;})
    {
        std::cout << "Fooborn." << std::endl;
        throw std::runtime_error("oh oh");
    }

    ~Foo() {
        std::cout << "Foo in agony." << std::endl;
    }

private:
    Trasher meh_, moo_;
};

int main () {
    try {
        Foo foo;
    } catch(std::exception &e) {
        std::cerr << "error:" << e.what() << std::endl;
    }
} 
```

输出：

```
hello!
be or not
Fooborn.
is the question
bye!
error:oh oh 
```

所以，`~Foo()`永远不会运行，但你的初始化/删除对是。

一件好事是：如果您的初始化函数本身抛出，您的删除函数将不会被调用，因为初始化函数抛出的任何异常都会直接通过`Trasher()`，因此`~Trasher()`不会被执行。

注意：有一个最外层很重要`try/catch`，否则标准不需要堆栈展开。

# c - 从文件中读取字符

> ID：11346154
> 
> 赞同：0
> 
> 时间：2012-07-05T14:13:42.617
> 
> 标签：c, file, fgetc

我想知道为什么我的程序得到错误的结果。我只需要从文件中读取字符，包括空格、(.)、(,) 和其他字符，然后以特定的字符串格式输出它们。结果，我得到了更多 300 个字符读取实例及其奇怪的表示。我需要打印实际字符及其内存位置。欣赏它！

```
 34 instances of character :
 35 instances of character ¼
 36 instances of character ¼
 37 instances of character ¼

  #include <stdio.h>

  int main()
  {
   char ch;
   int characters[100];
   int i,j,k;
   int charCount = 0;

   FILE *fPtr;
   fPtr=fopen("input.txt", "r");

   while(ch = fgetc(fPtr) != EOF)
   {
     i=0;
     characters[i] = (char)ch;
     i++;
   }

   int arrayLength = sizeof(characters)/sizeof(characters[0]);

   for(j= 0; j < arrayLength; j++)
   {
     for(k=1; k < arrayLength; k++)
     {
       if(characters[j] == characters[k])
   {
      charCount++;
          printf("%d instances of character %c in location %c \n", charCount, characters[j], &characters[j]);
   }
     }
   }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:15:53.613

记住这一点： `fgetch()`返回`int`。不是`char`。请参阅[手册页](http://linux.die.net/man/3/fgetc)。

这是因为`EOF`常量比字符大，所以返回值中必须有更多位才能表示“任何字符，或`EOF`”。

换句话说，`EOF`它不是一个字符，它是一个[带外](http://en.wikipedia.org/wiki/Out-of-band)通信的例子。

此外，您的括号看起来很奇怪，您可能的意思是：

```
while((ch = fgetc(fPtr)) != EOF && ch != '\n') 
```

仅注意分配周围的内括号。

# salesforce - 我在 apex force.com 代码中的测试类有什么问题？

> ID：11346159
> 
> 赞同：-1
> 
> 时间：2012-07-05T14:13:58.417
> 
> 标签：salesforce, apex-code

我在 Apex 写了一个工人班。它是一个电子邮件服务扩展器，用于处理传入的电子邮件。它在我的沙盒环境中运行完美。

我已经创建了一个测试类，所以我也可以将它部署到我的生产环境中，但是在验证代码时，我得到的只有 72% 的代码经过测试。

这是我的主要课程

```
global class inboundEmail implements Messaging.InboundEmailHandler {

global Messaging.InboundEmailResult handleInboundEmail(Messaging.InboundEmail email, Messaging.InboundEnvelope envelope) {
    Messaging.InboundEmailResult result = new Messaging.InboundEmailresult();

Lead lead;

String [] mFromUserParams;
String [] sourceText;
String mCaseObject; 

try{
    sourceText = email.toAddresses[0].split('@');
    String [] mParams = sourceText[0].split('\\.');
**// FROM THIS LINE TO THE END - NOT COVERED**
    mFromUserParams = email.fromAddress.split('@');
    mCaseObject = mParams[0];
    if (mCaseObject == 'lead'){
        lead = new Lead();
        lead.LastName = mFromUserParams[0];
        lead.Company = email.fromAddress;
        lead.OwnerId = mParams[1];
        lead.LeadSource = mParams[2];
        lead.Email = email.fromAddress;
        lead.RequirementsDescription__c = email.subject + email.plainTextBody;

        insert lead;
        result.success = true;
    }  else if (mCaseObject == 'case'){
        result.success = true;
    }  else {
        result.success = false;
    }
}catch(Exception e){
    result.success = false;
    result.message = 'Oops, I failed.';
}
return result;
}
} 
```

这是我的测试课

```
@isTest
private class inboundEmailTest {
public static testMethod void inboundEmail(){     
    // Create a new email, envelope object and Header
    Messaging.InboundEmail email = new Messaging.InboundEmail();
    Messaging.InboundEnvelope envelope = new Messaging.InboundEnvelope();
envelope.toAddress = 'lead.owner.new@cpeneac.cl.apex.sandbox.salesforce.com';
    envelope.fromAddress = 'user@acme.com';
    email.subject = 'Please contact me';
    email.fromName = 'Test From Name';
    email.plainTextBody = 'Hello, this a test email body. for testing  Bye';
    // setup controller object
    inboundEmail catcher = new inboundEmail();
    Messaging.InboundEmailResult result = catcher.handleInboundEmail(email, envelope);
}
} 
```

根据错误消息，第 3 行的 Try/Catch 块中的所有行都没有被覆盖。（在代码中标记）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:07:10.457

在您的测试方法中，您设置了信封.toAddress，但在您的电子邮件服务中，您将实际 InboundEmail 对象的第一个元素拆分为地址。这可能会导致 ArrayIndexOutOfBoundsException 或 NPE，因为元素 0 不存在。所以代码覆盖率会很差，因为你的测试总是跳到异常处理中，而剩下的代码未被覆盖。只需将电子邮件设置为地址，您应该有更好的覆盖范围。h9nry

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:25:29.093

在您的测试代码中，您能否添加一个导致潜在客户插入失败的场景？这将导致您的 catch 块中的代码执行并为您提供所需的代码测试覆盖率。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T07:52:37.447

email.fromAddress 默认不是列表，因此只需将其设置为字符串而不是列表即可解决此问题。

# jprofiler - jprofiler 试用版不允许多个客户端连接到服务器

> ID：11346161
> 
> 赞同：0
> 
> 时间：2012-07-05T14:14:03.597
> 
> 标签：jprofiler

我正在尝试从 windows xp 连接到在 linux 64 machile 上运行的 jprofiler 服务器，它连接到第一个客户端，但是当我尝试从另一个 windows 客户端连接到该服务器时，它只是一直在尝试连接，但从未成功。请让我知道如何启用 jprofiler 服务器允许多个客户端连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T10:59:46.927

不幸的是，这是不可能的。JProfiler 中的分析代理仅在一对一连接模式下工作。

# axapta - 如何自定义 Axapta 报告“SysReportAuto”？

> ID：11346164
> 
> 赞同：2
> 
> 时间：2012-07-05T14:14:21.113
> 
> 标签：axapta, dynamics-ax-2009

我知道如何修改具有已定义名称并通过按钮调用的“物理”报告。但是，在 Axapta 中有一些从工具栏中的打印按钮调用的报告。如何修改像“sysreportauto”这样的系统报告？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T07:18:29.043

自动报告中显示的字段来自表格上的[AutoReport](http://msdn.microsoft.com/en-us/library/aa678005%28v=ax.50%29.aspx)字段组。

作为用户，您可以更改自动报告，方法是单击编辑\新建，然后选择您想查看的字段。

您还可以在 Select\Sorting 中指定组总计，在 Select\Print 选项中指定总计。

# asp.net - 如何为 safari - chrome 和 Internet Explorer 配置带有 autentification 窗口的网站？

> ID：11346166
> 
> 赞同：0
> 
> 时间：2012-07-05T14:14:25.813
> 
> 标签：asp.net, authentication, ntlm, windows-authentication

我在 asp.net 网站上的身份验证窗口有问题。

我在 web.config 文件中使用此代码：

```
<authentication mode="Windows" />
    <identity impersonate="true" /> 
```

它适用于 Internet Explorer 和 Mozilla，但不适用于 safari 和 Google chrome。

你有解决方案吗 ？非常感谢

对不起我的英语不好

# jpa - JPQL - 查询时排除属性

> ID：11346176
> 
> 赞同：0
> 
> 时间：2012-07-05T14:15:00.217
> 
> 标签：jpa, jpql

我有用户对象也有密码。如何在列出用户时避免读取密码。

# android - 如何获取操作栏视图对象？

> ID：11346177
> 
> 赞同：1
> 
> 时间：2012-07-05T14:15:04.280
> 
> 标签：android, android-actionbar, android-view

有没有一种方法可以将操作栏视图作为对象引用。例如，我想获取溢出视图以了解屏幕上的坐标。目前我已经管理了一个丑陋的解决方案。获取带有 id 的菜单项

overflowView =((ViewGroup)parent.findViewById(R.id.menu_id).getParent()).getChildAt(2);

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:48:33.907

> 有没有一种方法可以将操作栏视图作为对象引用。

只有那些你自己创造的，via`android:actionLayout`和 kin。

> 例如，我想获取溢出视图以了解屏幕上的坐标。

您的解决方案不太可能在 Android 版本中保持稳定。它可能适用于 ActionBarSherlock，也可能不适用。我建议您为任何您认为自己的问题不涉及搞乱实现内部的问题找到其他解决方案`ActionBar`。

# javascript - ColdFusion - 查询数据表和 CRUD 操作的方法

> ID：11346178
> 
> 赞同：2
> 
> 时间：2012-07-05T14:15:05.153
> 
> 标签：javascript, coldfusion, crud, cfquery, cfoutput

我的问题更倾向于方法而不是编程或错误。

我有一个运行并收集一组数据的查询。然后，我想使用该查询的返回值在列出所有值的页面上构建一个表。除此之外，我还需要对每个值进行一些操作，例如：

```
my_val (edit) (delete)
my_cal (edit) (delete) 
```

编辑和删除是按钮。所以我使用onClick javascript的编辑按钮，我被重定向到另一个页面，但删除按钮我需要它来做三件事：

1.  提示用户，可以删除吗？味精（为此使用javascript（返回确认...）。
2.  执行查询删除
3.  刷新页面（自己）

有没有最好的方法模型呢？调用两个内联 javascript 命令更容易吗？使用javascript函数？也许是 ColdFusion 功能？

任何指示都会有所帮助！谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:22:34.573

我认为你接近你正在寻找的东西。

我进行删除的方式是在 JS 中确认，然后将请求发送到执行删除过程的另一个页面，然后将您的用户发送回您的原始页面（让您刷新）。

那将是简单的路线，您也可以使用 AJAX 来调用您的流程页面并在后台进行更改。然后您要么必须进行 JS 刷新，要么手动处理页面上的更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:44:10.817

我认为删除的最简单方法是这样的。我确实假设您使用 jQuery 或其他一些库或获取 JavaScript 的东西。

```
YourPage.cfm
<cfif structKeyExists(URL, "Action") and URL.Action eq "delete">
    <cfququery>
       // delete the item using the id provided
    </cfquery>
</cfif>

<cfquery name="GetFresh">
    // get fresh info
</cfquery>

<cfloop query="GetFresh">
    Something <span class='DeleteLink' data-someid='#SomeID#'>delete</span> <br>
</cfloop>

<script type='text/javascript'>

    $DeleteLinks = $("span.DeleteLink");

    $DeleteLink.click(function() {
        var Confirm = confirm('Are you sure you want to delete?');
        if (Confirm == true) {
           var SomeID = $(this).data("someid");
           var URL = "YourPage.cfm?Action=delete&SomeID=" + SomeID;
           window.location = URL;
        }
    });
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T18:01:51.070

这就是我使用的：

```
!function($, window, undefined) {
    var document = window.document;
    $(document).delegate('input:submit[name="Delete"][value="Delete"]','click',function() {
        return window.confirm(this.title || 'Delete this record?');
    });
}(jQuery, window); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T16:15:37.617

最简单最快的方法是只使用一个 onclick 处理程序，它根据用户的选择返回 true/false

```
 <a href="delete.cfm?id=1" onclick="return confirm('Are you sure you want to delete his?')">Delete</a> 
```

当然还有更优雅的方法可以做到这一点，但以上是基本的并且有效。

# java - Servlet：java.lang.ClassNotFoundException：org.json.simple.parser.ParseException

> ID：11346180
> 
> 赞同：26
> 
> 时间：2012-07-05T14:15:10.277
> 
> 标签：java, android, push-notification

我正在为 android 实现 Google Cloud Messaging 服务。我创建了一个向应用程序用户发送推送通知的测试服务器。但是我创建的服务器正在生成以下错误。我在服务器端使用 Java Servlet，并在项目中包含了 gcm-server.jar 文件。

这是日志：

```
java.lang.ClassNotFoundException: org.json.simple.parser.ParseException
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
    at com.mgcm.SendGCMMessage.processRequest(SendGCMMessage.java:48)
    at com.mgcm.SendGCMMessage.doPost(SendGCMMessage.java:40)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Unknown Source) 
```

知道这有什么问题吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-07-05T14:39:53.740

我有同样的问题，尝试添加这个库：

[http://code.google.com/p/json-simple/downloads/detail?name=json-simple-1.1.1.jar](http://code.google.com/p/json-simple/downloads/detail?name=json-simple-1.1.1.jar)

托米

# php - 传递具有相同名称的隐藏字段。PHP 会将它们作为数组获取吗？

> ID：11346182
> 
> 赞同：-3
> 
> 时间：2012-07-05T14:15:19.787
> 
> 标签：php

如果我有一个带有这种格式的隐藏字段的表单：

```
<input type="hidden" name="mydata[]" value="one">
<input type="hidden" name="mydata[]" value="two">
<input type="hidden" name="mydata[]" value="three"> 
```

我可以使用 $_REQUEST 将这三个值作为数组访问吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:17:09.050

是的。结果应该是这样的：

```
print_r($_REQUEST['mydata']);

array
(
    0 => "one",
    1 => "two",
    2 => "three"
)

echo $_REQUEST['mydata'][1]; // echos  "two" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:16:13.703

是的（因为名称以 结尾`[]`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:19:41.533

是的。这些值将在一个数组中并从 0 到 n 编号。第一个输入将始终位于键 0 处，依此类推。

# java - 可序列化类中的不可序列化字段（瞬态关键字）

> ID：11346184
> 
> 赞同：1
> 
> 时间：2012-07-05T14:15:25.997
> 
> 标签：java, oop, serialization, transient

我有一个扩展 Servlet 的可序列化类

```
public class FileDownload extends HttpServlet{
  @SuppressWarnings("compatibility:6754389671327954013")
  private static final long serialVersionUID = 1L;
  private ResultSet rset;
  ......
} 
```

我的问题是：

对象是否在编译或运行时`rset`自动转换？`transient`还是我必须将其明确标记为`transient`？（这是我的 IDE JDeveloper 发出的警告）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:36:24.007

不，序列化不会忽略该字段 -`java.io.NotSerializableException`如果您尝试序列化`FileDownload`. 标记它`transient`。顺便说一句，`ResultSet`作为 a中的*字段*做什么`Servlet`？这不是线程安全的。`ResultSets`在任何情况下都应该是局部变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:25:21.867

你必须调用`transient`你自己的。但是你不能`serialize`一个对象，除非它实现了`Serializable`接口。ResultSet 就是这样一种对象。

# php - PHP：按需启动 mongoDB 连接

> ID：11346193
> 
> 赞同：0
> 
> 时间：2012-07-05T14:15:57.107
> 
> 标签：php, mongodb

mongoDB 的 phpdriver 是否提供了按需启动连接的功能 - 仅。

也许这可以节省一些负载，尽管持久连接已经非常快了。

但是，如果有机会优化应用程序，我也会尝试这个。

另一种方法是调用函数以仅按需连接似乎有点棘手，并且使我的源非常多余。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:25:57.413

[H Hatfield](https://stackoverflow.com/users/565548/h-hatfield)发布的链接解决了这个问题。[Mongo::__construct()](http://php.net/manual/en/mongo.construct.php)有一个`connect`默认为 true 的选项，但你可以指定 false 来延迟连接。文档不清楚这是多么懒惰，因为它只保证构造函数将返回而不等待建立连接。

也就是说，您最好依靠正在积极改进的持久连接。如果在驱动程序的未来主要版本中删除了惰性连接选项，我不会感到惊讶。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-08T14:43:28.973

在启动管理器时的文档[页面上](http://php.net/manual/en/mongodb-driver-manager.construct.php "页")，它说：

此构造函数不执行 I/O。执行第一个操作时，将按需初始化连接。所以这实际上是你已经需要的。

# hbase - 如何在单次扫描中从多个表中获取数据？

> ID：11346194
> 
> 赞同：0
> 
> 时间：2012-07-05T14:15:58.977
> 
> 标签：hbase

我正在开发一个小型社交网络应用程序并面临 N+1 选择问题。

我有两个表，Post 和 Comment，它们在应用程序中起主要作用。

我将所有帖子存储在 Post 表中，对帖子的评论存储在 Comment 表中。我正在通过以下方式使用部分键扫描功能获取数据。

```
 Post: Start row = userID  | Stop Row = userID +1

 Comment: Start row = postID | Stop Row = postID +1 
```

这是用于获取数据的代码片段

```
 HTable table = resource.getTable(getTableName());

 Scan scan = new Scan();
 scan.setStartRow(Bytes.toBytes(prefixId.toString()));
 scan.setStopRow(Bytes.toBytes(prefixId.toString() + 1));

 ResultScanner scanner = table.getScanner(scan); //TODO store the scanner in cache.
 Result[] results = scanner.next(pageSize); 
```

代码的问题是我可以在单个查询中获取用户的所有帖子。但是对于每个帖子，我必须进行单独的查询以获取所有评论。我分析了 HBase 客户端 Scan API，但无法找到解决方案以使其在单个查询或最多两个查询中成为可能；一个用于帖子，另一个用于评论。

我开始了解过滤器，但过滤器再次成为性能瓶颈。

我刚开始使用 NOSQL 技术，对 HBase 还很陌生。请在设计/框架级别帮助我解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T08:59:54.597

有两种方法可以在一次扫描中获取所需数据，
1\. 通过将所有评论保存在同一个表中（POST），每当有新评论出现时，将运行时列创建为名称评论-（时间戳）或评论-（数字）。

2.通过其他方式，您可以创建两列系列，一列是“发布”，另一列是“评论”，因为评论可以更多，因此将列系列“评论”的版本数设置为最大（最佳）值。

# python - 使用 ElementTree 创建 XML

> ID：11346196
> 
> 赞同：1
> 
> 时间：2012-07-05T14:16:13.033
> 
> 标签：python, xml

我是 python 新手。我想创建一个具有一个父级、多个子级和多个子级的 xml 树。我已将子标签存储在列表“TAG”中，子标签在列表“SUB”中我想出了以下代码，但我无法达到预期的结果！

```
def make_xml(tag,sub):
'''
Takes in two lists and Returns a XML object.
The first list has to contain all the tag objects
The Second list has to contain child data's
'''
from xml.etree.ElementTree import Element, SubElement, Comment, tostring
top = Element("Grand Parent")
comment = Comment('This is the ccode parse tree')
top.append(comment)
i=0
try:
    for ee in tag:
        child = SubElement(top, 'Tag'+str(i))
        child.text = str(tag[i]).encode('utf-8',errors = 'ignore')

        subchild = SubElement(child, 'Content'+str(i))
        subchild.text = str(sub[i]).encode('utf-8',errors = 'ignore')

        i = i+1;
except  UnicodeDecodeError:
    print 'oops'
return top 
```

编辑：我有两个这样的列表： TAG = ['HAPPY','GO','LUCKY'] SUB = ['ED','EDD​​','EDD​​Y']

我想要的是：

```
<G_parent>
    <parent1>
         HAPPY
        <child1>
              ED   
        <\child1>
     <\parent1>
     <parent2>
         GO
        <child2>
              EDD
        <\child2>
    <\parent2>
    <parent3>
         LUCKY
        <child3>
              EDDY
        <\child3
    <\parent3>
<\G_parent> 
```

实际列表的内容比这多得多。我想使用for循环左右来实现。

```
EDIT: 
```

OOP 的。我的错 ！当我通过示例列表时，代码按预期工作。但在我的实际应用程序中，列表很长。该列表包含从 pdf 文件中提取的文本片段。在该文本的某处，我得到 UnicodeDecodeError（原因：pdf 提取的文本混乱。证明：'oops' 打印一次）并且返回的 xml 对象不完整。所以我需要找出一种方法，即使在 UnicodeDecodeErrors 上，我的完整列表也会被解析。那可能吗 ！我正在使用 .decode('utf-8',errors='ignore') 即使解析没有完成！

# c# - 仅使用 Bouncy Castle 读取 PEM RSA 公钥

> ID：11346200
> 
> 赞同：17
> 
> 时间：2012-07-05T14:16:27.413
> 
> 标签：c#, bouncycastle, public-key, pem

我正在尝试使用 C# 读取`.pem`仅包含 RSA 公钥的文件。我无权访问私钥信息，我的应用程序也不需要它。文件`myprivatekey.pem`文件以

`-----BEGIN PUBLIC KEY-----` 并以 . 结尾 `-----END PUBLIC KEY-----`。

我目前的代码如下：

```
 Org.BouncyCastle.Crypto.AsymmetricCipherKeyPair keyPair;

    using (var reader = File.OpenText(@"c:\keys\myprivatekey.pem"))
        keyPair = (Org.BouncyCastle.Crypto.AsymmetricCipherKeyPair)new Org.BouncyCastle.OpenSsl.PemReader(reader).ReadObject(); 
```

但是代码会抛出一个`InvalidCastException`带有消息的

> 无法将“Org.BouncyCastle.Crypto.Parameters.DsaPublicKeyParameters”类型的对象转换为“Org.BouncyCastle.Crypto.AsymmetricCipherKeyPair”类型。

`PemReader`当没有可用的私钥信息时，如何使用 Bouncy Castle仅读取公钥？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-06T17:41:02.023

以下代码将从给定文件名中读取公钥。应该为任何生产代码更改异常处理。此方法返回一个`AsymetricKeyParameter`：

```
public Org.BouncyCastle.Crypto.AsymmetricKeyParameter ReadAsymmetricKeyParameter(string pemFilename)
{
    var fileStream = System.IO.File.OpenText(pemFilename);
    var pemReader = new Org.BouncyCastle.OpenSsl.PemReader(fileStream);
    var KeyParameter = (Org.BouncyCastle.Crypto.AsymmetricKeyParameter)pemReader.ReadObject();
    return KeyParameter;
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-10-06T03:55:55.897

这是一个将公共和私有 PEM 文件读入 RSACryptoServiceProvider 的可能解决方案：

```
public class PemReaderB
{
    public static RSACryptoServiceProvider GetRSAProviderFromPem(String pemstr)
    {
        CspParameters cspParameters = new CspParameters();
        cspParameters.KeyContainerName = "MyKeyContainer";
        RSACryptoServiceProvider rsaKey = new RSACryptoServiceProvider(cspParameters);

        Func<RSACryptoServiceProvider, RsaKeyParameters, RSACryptoServiceProvider> MakePublicRCSP = (RSACryptoServiceProvider rcsp, RsaKeyParameters rkp) =>
        {
            RSAParameters rsaParameters = DotNetUtilities.ToRSAParameters(rkp);
            rcsp.ImportParameters(rsaParameters);
            return rsaKey;
        };

        Func<RSACryptoServiceProvider, RsaPrivateCrtKeyParameters, RSACryptoServiceProvider> MakePrivateRCSP = (RSACryptoServiceProvider rcsp, RsaPrivateCrtKeyParameters rkp) =>
        {
            RSAParameters rsaParameters = DotNetUtilities.ToRSAParameters(rkp);
            rcsp.ImportParameters(rsaParameters);
            return rsaKey;
        };

        PemReader reader = new PemReader(new StringReader(pemstr));
        object kp = reader.ReadObject();

        // If object has Private/Public property, we have a Private PEM
        return (kp.GetType().GetProperty("Private") != null) ? MakePrivateRCSP(rsaKey, (RsaPrivateCrtKeyParameters)(((AsymmetricCipherKeyPair)kp).Private)) : MakePublicRCSP(rsaKey, (RsaKeyParameters)kp);
    }

    public static RSACryptoServiceProvider GetRSAProviderFromPemFile(String pemfile)
    {
        return GetRSAProviderFromPem(File.ReadAllText(pemfile).Trim());
    }
} 
```

希望这可以帮助某人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-26T20:15:14.190

在回答 c0d3Junk13 时，我在 PEM 私钥方面遇到了同样的问题，我花了整个下午才找到使用 C# BouncyCastle 版本 1.7 和 Visual Studio 2013 Desktop Express 的解决方案。不要忘记将项目引用添加到 BouncyCastle.Crypto.dll

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Collections;
using System.IO;
using Org.BouncyCastle.Asn1.X509;
using Org.BouncyCastle.Asn1.Pkcs;
using Org.BouncyCastle.Crypto.Digests;
using Org.BouncyCastle.Crypto.Parameters;
using Org.BouncyCastle.Crypto.Signers;
using Org.BouncyCastle.X509;
using Org.BouncyCastle.Math;
using Org.BouncyCastle.Math.EC;
using Org.BouncyCastle.Utilities.Collections;
using Org.BouncyCastle.Utilities.Encoders;
using Org.BouncyCastle.Crypto; 
using Org.BouncyCastle.Crypto.Engines; 
using Org.BouncyCastle.OpenSsl;

/* 
    For an Active Directory generated pem, strip out everything in pem file before line:
    "-----BEGIN PRIVATE KEY-----" and re-save.
*/
string privateKeyFileName = @"C:\CertificateTest\CS\bccrypto-net-1.7-bin\private_key3.pem";

TextReader reader = File.OpenText(privateKeyFileName);

Org.BouncyCastle.Crypto.Parameters.RsaPrivateCrtKeyParameters key;

using (reader = File.OpenText(privateKeyFileName))
{
    key = (Org.BouncyCastle.Crypto.Parameters.RsaPrivateCrtKeyParameters)new PemReader(reader).ReadObject();
}

cipher.Init(false, key);

//Decrypting the input bytes

byte[] decipheredBytes = cipher.ProcessBlock(cipheredBytes, 0, cipheredBytes.Length);

MessageBox.Show(Encoding.UTF8.GetString(decipheredBytes)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-07-26T21:01:40.317

**编辑**：看起来这取决于您使用的密钥文件类型。对于**ssh-keygen**密钥，私钥的类型似乎是`AsymmetricCipherKeyPair`，但对于**openssl**密钥，私钥的类型是`RsaPrivateCrtKeyParameters`。

* * *

Bryan Jyh Herng Chong 的回答似乎不再适合我（至少在 Bouncy Castle v1.8.5 版本中）。`kp.GetType().GetProperty("Private")`公钥和私钥 PEM 对象的设置似乎不再不同。看起来使用返回的对象`PemReader.ReadObject()`现在直接是一个`RsaPrivateCrtKeyParameters`对象，因此不再需要先通过`AsymmetricCipherKeyPair`对象进行转换。

我把那条线改成了这样，它就像一个魅力：

```
return (kp.GetType() == typeof(RsaPrivateCrtKeyParameters)) ? MakePrivateRCSP(rsaKey, (RsaPrivateCrtKeyParameters)kp)) : MakePublicRCSP(rsaKey, (RsaKeyParameters)kp); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-06-25T17:16:53.963

代替：

```
keyPair = (Org.BouncyCastle.Crypto.AsymmetricCipherKeyPair)new Org.BouncyCastle.OpenSsl.PemReader(reader).ReadObject(); 
```

利用：

```
keyPair = (Org.BouncyCastle.Crypto.AsymmetricKeyParameter)new Org.BouncyCastle.OpenSsl.PemReader(reader).ReadObject(); 
```

由于您只使用公钥并且实际上没有一对密钥（公钥和私钥），因此您不能将其转换为“AsymmetricCipherKeyPair”，您应该将其转换为“AsymmetricKeyParameter”。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-01-03T09:27:47.707

试试下面的代码：

```
Using Org.BouncyCastle.Crypto;

string path = HttpContext.Current.Server.MapPath(@"~\key\ABCD.pem");

AsymmetricCipherKeyPair Key;

TextReader tr = new StreamReader(@path);

 PemReader pr = new PemReader(tr);
        Key = (AsymmetricCipherKeyPair)pr.ReadObject();
        pr.Reader.Close();
        tr.Close();

         AsymmetricKeyParameter keaa = Key.Public; 
```

# c# - 在 webform1 中捕获 webform 2 的按钮单击事件

> ID：11346201
> 
> 赞同：1
> 
> 时间：2012-07-05T14:16:29.603
> 
> 标签：c#, asp.net, webforms

我有 2 个 webforms webform 1 中的 closeporject 按钮重定向到 Webform 2 并询问您是否真的要关闭该项目。如何在 webform 1 中捕获 webform 2 的按钮单击事件？有人告诉我它必须对地址栏中的查询字符串做一些事情。我不允许使用 javascript 来显示我的消息框。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:30:13.360

您可以将数据从一页发布到另一页。这里从 Page2.aspx 到 Page1.aspx 为

在 page2 上，您在按钮上设置 PostBackUrl 继续/选择任何内容。

```
PostBackUrl="Page1.aspx" 
```

并在 Page1.aspx 上设置可以读取发布数据的位置。

```
<%@ PreviousPageType VirtualPath="~/Page2.aspx" %> 
```

你得到的数据是

```
if (Page.PreviousPage != null)
{
    if(Page.PreviousPage.IsCrossPagePostBack == true)
    {
        // here you can get from Page2.aspx==PreviousPage
        //  a check box check, what ever you like...
        GetTheClass = PreviousPage.MyDataClass;
    }
} 
```

相对：[跨页发布。在 Asp.net 中使用 PreviousPage 是一个好习惯吗？](https://stackoverflow.com/questions/10124030/cross-page-posting-is-it-a-good-pratice-to-use-previouspage-in-asp-net/10124789)

有关跨页发布的更多信息：http: [//msdn.microsoft.com/en-us/library/ms178139.aspx](http://msdn.microsoft.com/en-us/library/ms178139.aspx)

# .htaccess - 子域重定向错误 + Htaccess，困惑？

> ID：11346203
> 
> 赞同：0
> 
> 时间：2012-07-05T14:16:36.137
> 
> 标签：.htaccess, redirect, seo, subdomain

几周前我注意到，我的整个网站都被谷歌搜索中的一个奇怪的子域镜像。

前任。www.site.com

在 Google 中被索引：

www.site.comwww.site.com/index.html == www.site.com/index.html

www.site.comwww.site.com/contact == www.site.com/contact

等等……上面的页面是相同的。

奇怪的是，您输入的任何其他子域都会被重定向到原始域。所以 www.anythinghere.site.com --redirects--> www.site.com

2个问题：

1.  htaccess 中的特定代码会将此 URL (www.site.comwww.site.com) 重定向到主站点吗？
2.  我如何才能找到这个子域最初是如何创建的？

我已经复制了我的 htaccess，所以你可以看看......我不是最技术性的人。

任何人都可以对这个问题有所了解吗？我认为它正在影响我的搜索排名。

====================

```
RewriteCond %{HTTP_HOST} !^www\.site\.com [NC]

RewriteRule (.*) http://www.site.com/$1 [R=301,L]

 #wpfx seo
  RewriteCond %{HTTP_HOST} !^www..*

  RewriteCond %{HTTP_HOST} !^$

  RewriteCond %{HTTP_HOST} ^([^.]*).(com|com/)

  RewriteRule ^.*$ http://www.%1.%2%{REQUEST_URI} [R=301,L]

  RewriteCond %{REQUEST_FILENAME} !-f

  RewriteCond %{REQUEST_FILENAME} !-d

  RewriteRule ^(.*)$ /index.php?/$1 [L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:25:27.020

登录谷歌的网站管理员工具并在那里更正网址。这应该是最快的方法。

`.htaccess`如果您在文件中启用 mod 重写，则使用 301 的重定向应该没问题。顺便说一句，如果你在正则表达式中需要它们，你必须避开点。以下是前三行的一些改进：

```
RewriteEngine on

RewriteCond %{HTTP_HOST} !^www\.site\.com$ [NC]
RewriteRule ^ http://www.site.com%{REQUEST_URI} [R=301,L]

RewriteCond %{HTTP_HOST} !^www\..* 
```

# java - 仅自动装配构造函数的某些参数

> ID：11346205
> 
> 赞同：9
> 
> 时间：2012-07-05T14:16:38.897
> 
> 标签：java, spring, inversion-of-control

在 Spring 中是否可以仅自动装配构造函数的特定参数？

我定义：

```
<bean class="MyClass">
    <constructor-arg name="name" value="object name" />
</bean> 
```

和：

```
public class MyClass{
    private String name;
    private MyDAO dao;

    @Autowired
    public MyClass(String name, MyDao dao){
        // assign...
    }

    // ...
} 
```

现在我想`MyDao`自动装配对象，同时明确定义`name`参数。可能吗？

使用 XML 定义 bean 需要手动定义所有参数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T14:24:32.723

您不能使用自动装配的构造函数来做到这一点，因为它会影响所有参数，但您可以这样做：

```
public class MyClass{
    private String name;

    @Autowired
    private MyDAO dao;

    public MyClass(String name){
        // assign only name
    }

    // ...
} 
```

它类似于为 DAO 设置一个设置器，但您不会在您的课程中公开该公共设置器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:23:08.613

如果我正确阅读了您的问题，您是在询问是否可以连接您在上下文中其他地方定义的 MyDao 实例，并为 name 参数提供硬编码的字符串值。如果这是正确的，你会像这样配置你的类

```
<bean class="MyClass">
  <constructor-arg value="Hardcoded string value for the name" />
  <constructor-arg ref="myDaoInstance" />
</bean> 
```

在您的上下文文件中的其他地方

```
<bean class="MyDao" id="myDaoInstance>
  //relevant config
</bean> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:23:21.617

似乎您应该将 @Autowired 添加到 MyDao dao；声明，然后将您的构造函数更改为仅使用名称参数。您将自动能够访问 MyDao

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T14:28:58.610

**有可能的。**

参考这个链接：

[static.springsource.org/spring/docs/3.0.x/reference/beans.html#beans-autowired-annotation-qualifiers](http://static.springsource.org/spring/docs/3.0.x/reference/beans.html#beans-autowired-annotation-qualifiers)

# sharepoint - CRM 2011 如何使用 SharePointDocumentLocation

> ID：11346206
> 
> 赞同：0
> 
> 时间：2012-07-05T14:16:46.110
> 
> 标签：sharepoint, dynamics-crm-2011, crm

我正在尝试使用以下代码来检索记录的 SharePoint URL：

```
RetrieveAbsoluteAndSiteCollectionUrlRequest retrieveRequest = new RetrieveAbsoluteAndSiteCollectionUrlRequest
        {
            Target = new EntityReference(SharePointDocumentLocation.EntityLogicalName, _spDocLocId)
        };
        RetrieveAbsoluteAndSiteCollectionUrlResponse retrieveResponse = (RetrieveAbsoluteAndSiteCollectionUrlResponse)_service.Execute(retrieveRequest);

        return retrieveResponse.AbsoluteUrl.ToString(); 
```

但它说 SharePointDocumentLocation 不存在，并要求提供参考。我找不到任何参考，也不知道如何让它工作。任何人都可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T17:10:13.117

[SharePoint 集成](http://msdn.microsoft.com/en-us/library/gg327818.aspx)有两个选项：自动和手动。手动是您未在“文档管理设置”对话框中指定 URL 时获得的结果。AbsoluteURL 属性用于手动方法。它包含特定 SP 文件夹的完整路径。

如果您配置 SP 文档位置并通过单击启用的实体上的文档（通过 Doc Mgmt 设置）并指定 URL（不必是真实的）添加一两条记录，您将能够在数据库中查看记录在 FilteredSharePointDocumentLocation 视图中：

`select * from FilteredSharePointDocumentLocation`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:03:28.293

`SharePointDocumentLocation`创建记录：

*   仅当已为该实体配置了 SharePoint 集成，**并且**
*   仅当用户在 UI 中访问了 SharePointDocumentLocation 所在的记录（此时 CRM 调用 SharePoint Web 服务并创建该位置） - 在那之前，没有位置记录或 SharePoint 文件夹将存在。

所以这就引出了一个问题：你怎么样`_spDocLocId`？

# objective-c - 使用适用于 iOS 应用的 Google Drive API

> ID：11346207
> 
> 赞同：12
> 
> 时间：2012-07-05T14:16:50.740
> 
> 标签：objective-c, ios, sdk, google-drive-api

如何通过 iPhone 应用下载 Google Drive 文档（用户不拥有）的修订历史列表？

我真正在寻找的是上次修订的日期和时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T05:54:23.463

使用[queryForChangesList](http://code.google.com/p/google-api-objectivec-client/source/browse/trunk/Source/Services/Drive/Generated/GTLQueryDrive.m#89)返回[GTLDriveChangeList](http://code.google.com/p/google-api-objectivec-client/source/browse/trunk/Source/Services/Drive/Generated/GTLDriveChangeList.m)。还有一个使用 API[的示例可能会对您有所帮助。](http://code.google.com/p/google-api-objectivec-client/source/browse/trunk/Examples/DriveSample/)

# asp.net-mvc - MVC3-使用 AJAX 将动态表单数据发布回服务器

> ID：11346209
> 
> 赞同：1
> 
> 时间：2012-07-05T14:16:54.200
> 
> 标签：asp.net-mvc, model-binding, mvc-editor-templates, dynamic-forms, asp.net-mvc-partialview

我正在为我公司的服务开发数据库输入系统。每个服务可以根据需要进行任意数量的操作。同样，每个操作可以根据需要具有任意数量的参数。我正在尝试做的是使用动态表单来更新我的服务/编辑视图中操作参数的数据。

我使用动态表单向服务添加操作，但不是从我的服务视图发布它们，而是从操作/创建发布它们。这应该不是问题，但我想我会指出这一点。

现在，我遇到的问题是将参数表单中的数据发布回服务器。ModelState.isValid 返回错误。当我查看我的模型状态时，我的所有服务数据成员和我的操作数据成员都在那里，但我所有的参数数据成员都丢失了。我使用 FormCollection 检查动态表单的名称，它们实际上遵循 MVC 的模型绑定命名约定 (Parameters[i].DataMembers)。

希望有人可以为我提供一些见解。以下是一些可能有用的代码：

在我的服务控制器中：

```
 public ActionResult Edit(int id = 0)
    {
        if (id == 0)
        {
            return HttpNotFound();
        }

        //Eager loads the operations and parameters for this service
        var service = db.Services.Include(s => s.Operations.Select(o => o.Parameters)).Where(s => s.ServiceID == id).Single();

        if (service == null)
        {
            return HttpNotFound();
        }

        return View(service);
    } 
```

在我的服务/编辑视图中，我使用编辑器模板来显示操作的表单。我还在这个表单块之后放置了一个空 div，稍后通过 AJAX.ActionLink 填充参数表单：

```
 @Html.EditorFor(m => Model.Operations)

    <div id="parameter_container">
    </div> 
```

然后在我的编辑器模板中，我设置了我的 AJAX.ActionLink：

```
 @Ajax.ActionLink("Edit Parameters", "EditParams", "Services", new { opID = Model.OperationID, ViewContext.FormContext.FormId },
            new AjaxOptions
            {
                UpdateTargetId = "parameter_container",
                InsertionMode = InsertionMode.Replace,
                HttpMethod = "Post"
            }) 
```

然后回到我的服务控制器，我有：

```
 public PartialViewResult EditParams(int opID = 0)
    {
        if (opID == 0)
        {
            return PartialView();
        }

        var operation = db.Operations.Include(o => o.Parameters).Where(o => o.OperationID == opID).Single();

        if (operation.parameters == null)
        {
            return PartialView();
        }

        return PartialView("ParameterEditorRow", operation);
    } 
```

ParameterEditorRow 是强类型化到我的操作模型的局部视图（这需要在操作之后进行建模。将 Model.Parameters 传递到编辑器模板中会生成所需的命名约定（Parameters[i].DataMembers）。这很简单：

```
 @model InformationStore.Models.Operation
    @{if (this.ViewContext.FormContext == null)
        {
            this.ViewContext.FormContext = new FormContext();
        }  
     }
    <div class="editor_row">
       @Html.EditorFor(m => Model.Parameters)
    </div> 
```

最后，我有一个用于参数的编辑器模板。我为这篇冗长的帖子道歉，但我已经坚持了几天了。我只是觉得我的方法存在根本性的问题。有什么建议么？

**编辑以回应 StriplingWarrior**

在我的编辑视图中，我所有的输入字段都在这个表单中：

```
 @using (Html.BeginForm("edit", "services", new {Model.ServiceID}, FormMethod.Post)) 
```

并发布到：

```
 [HttpPost]
    public ActionResult Edit(Service service)
    {
        if(ModelState.IsValid)
        {
           //update db
        }
        return View(service)
    } 
```

我使用 IE 网络捕获来查看发回的内容，但它只是在中断时显示待处理，然后锁定。我必须承认，我不经常使用它，所以这可能是我的问题。

模型类（省略了特定于类的成员）：

```
 public class Service
    {
       [Key]
       public int ServiceID {get; set;}

       public virtual List<Operation> Operations {get; set;}
    }

    public class Operation
    {
       [Key]
       public int OperationID { get; set; }

       [Required]
       public int ServiceID { get; set; }

       [Required]
       public virtual Service Service { get; set; }

       public virtual ICollection<Parameter> Parameters { get; set; }
    }

    public class Parameter
    {
       [Key]
       public int ParameterID { get; set; }

       [Required]
       public int OperationID { get; set; }

       [Required]
       public virtual Operation Operation { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T17:43:34.333

您正在调用：

```
 @Html.EditorFor(m => Model.Parameters) 
```

...这导致发布的参数遵循约定`Parameters[i].DataMembers`。但是从长远来看，您要绑定的模型不是个体`Operation`：它是具有属性的整体`Service`，`Operations`并且每个操作都有一个`Parameters`属性。因此，您希望发布的参数看起来更像`Operations[i].Parameters[i].DataMembers`.

为此，您需要在调用编辑器时指定 htmlFieldName：

```
 @Html.EditorFor(m => Model.Parameters, null, "Operations[0].Parameters") 
```

当然，上面的行只适用于第零个操作：您需要动态创建字符串以传递您正在为其创建编辑器的操作的索引。这可能需要额外的修改才能让原始 AJAX 链接首先将索引传递给控制器​​，但您应该能够弄清楚这一点。

# ruby - 如何将值放入散列并检索

> ID：11346212
> 
> 赞同：0
> 
> 时间：2012-07-05T14:16:57.167
> 
> 标签：ruby, hash

嗨，我想将这些值放入哈希中并检索它们。

```
 c={}

  a={"cat"=> 1,"cap"=> 2} 

  b={"rat"=> 12,"soap"=> 5} 
```

现在如何将值“a”和“b”放入值“c”？

并从值 c 中检索这些值 a 和 b？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:34:48.837

你不能推入哈希。

添加到哈希中的每个值都必须有一个键。所以在你的情况下，你可以做

```
c[key1] = a
c[key2] = b 
```

你的哈希现在变成`c = {"key1" => {"cat" => 1,"cap" => 2}, "key2" => {"rat" => 12,"soap" => 5}}`

您可以通过 检索它们`c[your_key]`。

# python - 保持数据库连接打开 - 好的做法？

> ID：11346224
> 
> 赞同：3
> 
> 时间：2012-07-05T14:17:47.750
> 
> 标签：python, oracle

我正在编写一些 Python 代码来监视某个目录中的新文件，并使用 cx_Oracle 模块将新文件插入到数据库中。该程序将作为服务运行。在给定时间，可能有许多文件同时到达，但也可能有长达一个小时的时间段没有收到文件。关于良好做法：无限期地保持数据库连接打开是不是很糟糕？一方面，有些事情告诉我这不是一个好主意，但另一方面，为每个接收到的文件创建一个新的数据库对象并在之后关闭它会产生很多开销，尤其是在一次接收到许多文件时。任何有关如何解决此问题的建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:36:55.243

如果您只需要一两个连接，我认为无限期地保持它们打开并没有什么坏处。

对于 Oracle，创建新连接是一项昂贵的操作，这与其他一些数据库不同，例如 MySQL，创建新连接的成本非常低。有时甚至可能需要几秒钟才能连接，如果某些应用程序过于频繁地关闭和打开连接，这可能会成为一些瓶颈。

Oracle 上的空闲连接使用少量内存，但除此之外，它在空闲时不会消耗任何其他资源。

为了让您的 DBA 满意，您需要确保没有大量空闲连接处于打开状态，但我会很高兴有一两个。

# javascript - JQuery 使用 $.ajax() 访问远程站点

> ID：11346232
> 
> 赞同：0
> 
> 时间：2012-07-05T14:18:13.000
> 
> 标签：javascript, jquery

我将其分解为绝对最简单的代码，但这是行不通的。我在我的 web 服务上做了一个简单的 Echo 测试，它将一个字符串作为参数并回显它。我编写了我一直在编写的 javascript 代码，以便在此处访问此方法：

[http://jsfiddle.net/stephenbayer/CaHqY/9/](http://jsfiddle.net/stephenbayer/CaHqY/9/)

我真的需要知道，为什么我会收到错误，以及为什么我收到的唯一消息是来自 javascript 的错误字符串“Error”。我该如何解决这个问题并让它工作。

这是一个通过 WCF 使用标准 SOAP 运行的 Web 服务，我们有一个客户端请求通过 javascript 进行访问。对我来说听起来很疯狂，但我不认为这会那么困难。我根本找不到任何关于让这些跨域调用正常工作的明确信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:21:57.560

由于同源策略，您无法通过普通 AJAX 进行跨域调用，您需要为此进行**[JSONP](http://en.wikipedia.org/wiki/JSONP)** -Call。

也许您可以使用[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)，但您需要小心，因为那样您可能容易受到跨站点脚本的攻击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:49:40.850

其他人是对的。您必须使用 JSONP 而不是 JSON。

但是有一个替代方案：

不要直接将 ajax 与其他域一起使用，而是将其与您自己的域一起使用，在您的服务器中创建一个新的 Web 服务，例如使用 php。

然后，在您的 php ws 中，您可以调用外部 web 服务，它会工作。使用`file_get_contents()`.

我使用它来使用公共服务器获取地址代码：

```
$remote_data = @file_get_contents('http://republicavirtual.com.br/web_cep.php?formato=json&cep='.urlencode($_REQUEST['cep']));

echo $remote_data; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:24:19.533

现代浏览器阻止跨域请求以保护用户免受 XSS 攻击。

要处理来自另一个域的数据，您需要以下 4 个解决方案之一：

*   xml 服务器端[修改的标头](https://developer.mozilla.org/en/http_access_control)
*   [jsonp](http://en.wikipedia.org/wiki/JSONP)请求和响应
*   一个代理，以便您的浏览器认为这两个域是相同的
*   浏览器中的宽松保护（并非所有浏览器都可以）

请注意，前 2 个解决方案涉及更改 XML 服务器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T14:24:20.227

[http://james.padolsey.com/javascript/cross-domain-requests-with-jquery](http://james.padolsey.com/javascript/cross-domain-requests-with-jquery)

祝你好运

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T14:21:55.697

[您的浏览器因为同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)而停止请求。您只能对加载 javascript 的域创建一个 xhr（即 ajax）。

# sql - 搜索 Oracle SQL 语法

> ID：11346235
> 
> 赞同：0
> 
> 时间：2012-07-05T14:18:36.247
> 
> 标签：sql, oracle, parsing

谁能给我一个Oracle SQL语法的链接，好吗？

通过语法，我的意思是可以帮助我的*yacc*或*antlr资源。*

谢谢大家。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T14:21:17.553

[这是 ANTLR 的一组语法](http://antlr3.org/grammar/list.html)，包括 2 个 Oracle 11g SQL 语法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T14:27:08.017

```
http://www.antlr.org/grammar/ORACLE-7-SQL
http://www.antlr.org/grammar/list
http://www.antlr.org/grammar/1209225566284/PLSQL3.g 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T14:22:09.970

[例如](http://docs.oracle.com/cd/B19306_01/server.102/b14200/statements_10002.htm#i2066611)，您可能会在 oracle 的官方文档中找到您的需求

# c - ranlib 和静态库

> ID：11346240
> 
> 赞同：5
> 
> 时间：2012-07-05T14:18:53.530
> 
> 标签：c, linux, gcc, makefile, x86-64

我正在尝试链接我创建的静态库，但出现此错误。

```
libmine.a: could not read symbols: Archive has no index; run ranlib to add one 
```

我试图做，`ranlib libmine.a`但没有任何改变，它仍然给出同样的错误。我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T14:51:04.800

要查看存档中的符号，请使用 nm。

```
nm -s libmine.a 
```

<输出>

子例程的入口点应标记为“T”，如

```
00000000 T _sub1
00000019 T_sub2

```

您在“ar”中使用了哪些开关来制作静态库？我通常使用“ar -r”，如

```
ar -r libmine.a mine.o yours.o 
```

如果仍然有问题，请添加“-s”选项

```
ar -s -r libmine.a mine.o yours.o 
```

此外，请确保路径中没有其他“libmine.a”文件，或者为您的“libmine.a”创建一个显式路径。链接器可能会选择不同的“libmine.a”。

# php - 在 PHP 中出现 T_ENCAPSED_AND_WHITESPACE 错误

> ID：11346248
> 
> 赞同：-1
> 
> 时间：2012-07-05T14:19:21.173
> 
> 标签：php, whitespace

我在 php 中创建一个应用程序，在该应用程序中我在这一行收到错误 #

```
$sql="INSERT INTO table ( `rollnum`,'sessionid', `class`, `subject`, `theory`, `practical`, `type_of`, `term`) VALUES ('$students['rollnum']', '$session','$class','$subject['id']','$_REQUEST[$subject['id'].'_'.$students['rollnum'].'_th']','$_REQUEST[$subject['id'].'_'.$students['rollnum'].'_pr']', '$examtype', '$examsubtype')"; 
```

我不知道这条线有什么问题。我什至在一个[在线平台上](http://www.meandeviation.com/tutorials/learnphp/php-syntax-check/v4/syntax-check.php)检查过。他们也说#（上）行有错误。任何可以帮助我的人谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:33:48.187

您可能需要用大括号将变量括在双引号字符串中。

```
$string = "I want to use {$variable1} and {$variable['thisKey']}"; 
```

或以下，运行起来要快一点；

```
$string = 'I want to use'.$variable1.'and '.$variable['thisKey']; 
```

所以这应该可以解决您的直接问题，但是您的查询对注入非常开放，这可能非常糟糕，特别是如果您`$_REQUEST`在查询字符串中使用正确的话。我建议在运行查询语句之前先准备好查询语句，并确保所有危险的东西都被转义。

我回答了另一个问题，其中包括[使用此答案在此处进行查询的安全方法](https://stackoverflow.com/questions/11320796/saving-json-string-to-mysql-database/11321173#11321173)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:24:48.493

您需要在字符串中用大括号将变量名括起来：

```
$sql="INSERT INTO stdexamrecord ( `rollnum`,'sessionid', `class`, `subject`, `theory`, `practical`, `type_of`, `term`) VALUES (
'${students['rollnum']}', 
'$session',
'$class',
'${subject['id']}',
' " . $_REQUEST[ $subject['id'] . '_' . $students['rollnum'] . '_th'] . "',
' " . $_REQUEST[ $subject['id'] . '_' . $students['rollnum'] . '_pr'] . "',
'$examtype', 
'$examsubtype')"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:29:28.643

如果你的 PHP 环境有这些设置：`display_errors = On; error_reporting = E_ALL`，你会看到：

`PHP Parse error: syntax error, unexpected '' (T_ENCAPSED_AND_WHITESPACE), expecting identifier (T_STRING) or variable (T_VARIABLE) or number (T_NUM_STRING)`

就像在这个例子中一样：

```
$array['value'] = 'test';
echo "$array['value']"; 
```

它应该是这样的：

```
echo "".$array['value']."";
echo "{$array['value']}"; 
```

无论如何，您可以使用数字键：

```
$array[0] = 'test';
echo "$array[0]"; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-26T20:29:39.293

尝试使用可以帮助您在正确位置找到错误的dreamweaver 或net bean

# php - 引导输入错误

> ID：11346251
> 
> 赞同：0
> 
> 时间：2012-07-05T14:19:25.137
> 
> 标签：php, mysql, twitter-bootstrap

请帮助我使用 Bootstrap typeahead 解决此错误。

这是我用来调用源代码的 php 代码。

```
 function getUser() {

    $sth = mysql_query("SELECT id,contact FROM cinfo ORDER BY id ASC");
    $rows = array();
    while ($r = mysql_fetch_assoc($sth)) {
        $rows[] = $r;
    }
    print json_encode($rows);
} 
```

这是我的 javascript 文件

更新 2 JS

```
 $('.user').typeahead({
    source : function(typeahead, query) {
        return $.post('/ticket/getUser', {
            query : query,
        }, function(data) {
            return typeahead.process(data);
        })
    },
    property : 'contact'
}); 
```

我得到以下错误现在产生[https://gist.github.com/1866577#gistcomment-263183](https://gist.github.com/1866577#gistcomment-263183)

我正在使用以下引导预输入脚本[https://gist.github.com/1866577](https://gist.github.com/1866577)

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:20:45.877

`contact`你不想显示`cinfo`，因为`cinfo`是表名

```
$('.user').typeahead({
 source: '/ticket/getUser',
display:'contact',
id: 'id'
}); 
```

更新：

看起来你想使用 'property' 选项：

```
$('.user').typeahead({
 source: '/ticket/getUser',
property:'contact'
}); 
```

更新2：

我认为您需要先处理返回数据。尝试这个：

```
$('.user').typeahead({
    source: function (typeahead, query) 
    {
        return $.post('/ticket/getUser', { query: query }, function (data) 
        {
            return typeahead.process(data);
        });
    },
    property:'contact'
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:40:19.440

冒着自吹自擂的风险，如果你在让 Gist 工作时遇到问题，你可以尝试我的完整的 typeahead 扩展，它具有你正在寻找的功能，并得到文档和演示的支持。

[https://github.com/tcrosen/twitter-bootstrap-typeahead](https://github.com/tcrosen/twitter-bootstrap-typeahead)

# mysql - MySQL 死锁与存储过程生成 UID

> ID：11346256
> 
> 赞同：6
> 
> 时间：2012-07-05T14:19:32.367
> 
> 标签：mysql, stored-procedures, innodb, deadlock

我有一个从“票证”表生成 UID 的存储过程，但是在负载下我遇到了很多死锁。每当我的任务需要新的 UID 时，我都会从多个并发连接中多次调用此过程。

```
BEGIN
    DECLARE a_uid BIGINT(20) UNSIGNED;
    START TRANSACTION;
    SELECT uid INTO a_uid FROM uid_data FOR UPDATE; # Lock
    INSERT INTO uid_data (stub) VALUES ('a') ON DUPLICATE KEY UPDATE uid=uid+1;
    SELECT a_uid+1 AS `uid`;
    COMMIT;
END 
```

我确实考虑过使用：

```
BEGIN
    REPLACE INTO uid_data (stub) VALUES ('a');
    SELECT LAST_INSERT_ID();
END 
```

但是，我不确定这对于并发连接是否安全，因为没有锁定，这与使用`SELECT FOR UPDATE`.

这是表格：

```
mysql> DESCRIBE uid_data;
+-------+---------------------+------+-----+---------+----------------+
| Field | Type                | Null | Key | Default | Extra          |
+-------+---------------------+------+-----+---------+----------------+
| uid   | bigint(20) unsigned | NO   | PRI | NULL    | auto_increment |
| stub  | char(1)             | NO   | UNI | NULL    |                |
+-------+---------------------+------+-----+---------+----------------+ 
```

我已经设置了读取提交的事务隔离：

```
mysql> SHOW VARIABLES LIKE 'tx_isolation';
+---------------+-----------------+
| Variable_name | Value           |
+---------------+-----------------+
| tx_isolation  | READ-COMMITTED  |
+---------------+-----------------+ 
```

这就是我要回来的`SHOW ENGINE INNODB STATUS;`

```
...
... dozens and dozens of the following record locks...

Record lock, heap no 1046 PHYSICAL RECORD: n_fields 2; compact format; info bits 32
 0: len 1; hex 61; asc a;;
 1: len 8; hex 00000000000335f2; asc       5 ;;

Record lock, heap no 1047 PHYSICAL RECORD: n_fields 2; compact format; info bits 32
 0: len 1; hex 61; asc a;;
 1: len 8; hex 00000000000335f1; asc       5 ;;

*** (2) WAITING FOR THIS LOCK TO BE GRANTED:
RECORD LOCKS space id 13 page no 4 n bits 1120 index `stub` of table `my_db`.`uid_data` trx id 13AA89 lock_mode X waiting
Record lock, heap no 583 PHYSICAL RECORD: n_fields 2; compact format; info bits 32
 0: len 1; hex 61; asc a;;
 1: len 8; hex 00000000000334a8; asc       4 ;;

*** WE ROLL BACK TRANSACTION (1) 
```

如果有人能解释发生了什么以及如何避免它们，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T02:16:32.723

做这个：

```
CREATE TABLE tickets
(
    uid serial
) 
```

然后获取下一个uid：

```
BEGIN
  INSERT INTO tickets VALUES (NULL);
  SELECT LAST_INSERT_ID();
END 
```

uid 序列号相当于

```
uid BIGINT(20) UNSIGNED NOT NULL PRIMARY KEY auto_increment 
```

您不应该使用这种方法遇到任何死锁，并且可以随心所欲地抛出任意数量的连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:07:00.200

A deadlock occurs in this scenario:

Transaction 1 : requests a lock (`SELECT...FOR UPDATE`) and acquires it

Transaction 2 : requests a lock (`SELECT...FOR UPDATE`) and must wait

Transaction 1 : tries to insert, hits a duplicate, therefore updates (`INSERT...ON DUPLICATE KEY UPDATE`) => deadlock

~~I am not too sure about the reason, I suspect it has something to do with the `ON DUPLICATE KEY UPDATE`. I'm still investigating and will come back if I find out.~~

[Edit] A deadlock occurs even with:

```
BEGIN
    START TRANSACTION;
    SELECT uid FROM uid_data FOR UPDATE;
    UPDATE uid_data SET uid = uid +1; -- here, a deadlock would be detected in a blocked, concurrent connection
    COMMIT;
END 
```

What about this:

```
BEGIN
    START TRANSACTION;    
    UPDATE uid_data SET uid = uid +1;
    SELECT uid FROM uid_data;
    COMMIT;
END 
```

You could drop your `stub` colum altogether. The only drawback is that you must initialise your uid_data with one row.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T21:38:57.437

您可以尝试使用

```
UPDATE uid_data SET uid = LAST_INSERT_ID(uid+1);
SELECT LAST_INSERT_ID(); 
```

在像这样的桌子上

```
CREATE TABLE `uid_data` (
    `uid` BIGINT(20) UNSIGNED NOT NULL
)
COLLATE='utf8_general_ci'
ENGINE=MyISAM; 
```

这是线程安全的，如果是 MyISAM 则不会锁定表（实际更新语句期间除外）。

# javascript - 我怎样才能只提交两个表单元素？

> ID：11346259
> 
> 赞同：2
> 
> 时间：2012-07-05T14:19:36.023
> 
> 标签：javascript, jquery, html, forms, internet-explorer-6

我似乎遇到了一个小问题，我正在尝试为 ASP 系统创建一个“快速搜索”框，但我没有代码隐藏访问权限。

如何只提交文本框值和提交按钮值而不提交页面上的 ASP 或其他表单元素？

我试过了：

```
$('#aspnetForm').submit(function() {
    var $inputs = $('#aspnetForm :input');
    $inputs.each(function() {
        if ($("this:not(#QuickSearchBox, #quicksearch-submit)"))
        $(this).remove();
    });

}); 
```

和：

```
var $inputs = $('#aspnetForm :input');
$inputs.each(function() {
    if ($(this).not($("#QuickSearchBox, #quicksearch-submit")))
    $(this).remove();
}); 
```

但它们似乎都不起作用。

我试图让所有东西都向后兼容 IE 6，所以 HTML5 表单操作不是一个选项，我不能使用嵌套表单，因为它们不验证并且确实会导致一些问题。

我有什么办法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:23:02.020

禁用所有您不想提交的元素。

```
$('#aspnetForm :input:not(#QuickSearchBox, #quicksearch-submit)')
    .prop('disabled', true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:23:21.807

您可以将要提交的两个输入包装在它们自己的表单标签中吗？

# c# - MVC + nHibernate，通过 id 传递孩子；使用 DTO？方法错误？

> ID：11346261
> 
> 赞同：0
> 
> 时间：2012-07-05T14:19:39.833
> 
> 标签：c#, asp.net-mvc, nhibernate

我正在开发一个三层应用程序（演示、业务、持久性），并且在通过 MVC 与 nHibernate 交互的最佳方法方面遇到了概念上的麻烦。具体来说，我有一个页面可让您创建用户并选择他们的角色。角色下拉列表通过从业务处理程序获得的 List 对象填充。该列表将选定的 id 保存到一个 int[] 中，例如：

```
@Html.ListBoxFor(
    x => x.SelectedRoles,
    new SelectList(Model.Roles, "Id", "Name")) 
```

使用这些基类：

```
public class Role
{
    public virtual int Id { get; set; }
    public virtual string Name { get; set; }
    public virtual IList<User> Users { get; set; }
}

public class User {
    public virtual int Id { get; set; }
    public virtual string Username { get; set; }
    public virtual IList<Role> Roles { get; set; }
}

public RoleMap()
{
    Id(x => x.Id);
    Map(x => x.Name);

    HasManyToMany(x => x.Users)
        .Table("UserRole")
        .ParentKeyColumn("RoleId")
        .ChildKeyColumn("UserId")
        .Inverse();
}

public UserMap()
{
    Id(x => x.Id);

    Map(x => x.Username);

    HasManyToMany(x => x.Roles)
        .Table("UserRole")
        .ParentKeyColumn("UserId")
        .ChildKeyColumn("RoleId")
        .Cascade.SaveUpdate();
} 
```

然后我使用 AutoMapper 将我的 ViewModel 绑定到我的实体（即 UserCreateViewModel -> User），然后通过 Create(User) 调用将 User 对象传递给其业务处理程序。对于上面的例子，这个工作流崩溃了，因为当我传递一个 User 对象时，它的 List 是空的（因为 AutoMapper 在逻辑上没有将 int[] 绑定到 List）。

这就是我的问题出现的地方：

将 int[] 传递给我的 Create 方法是否更好，即 Create(User, int[])，然后执行类似的操作`User.Roles = ids.Select(x => _roleRepository.GetById(x)).ToList();`，或者我真的应该使用其他方法...这是 DTO 发挥作用的地方吗? 我看到他们将来如何使重构更容易，因为我将拥有像 Create(UserDto) 这样的东西，它永远不需要方法重命名（因为我可以根据需要向 DTO 添加更多字段）。

来自基于存储过程的 mini-ORM，我觉得这种方法是错误的。不管使用 DTO，我不会为我通过 GetById 请求的每个角色生成一个新查询吗？或者这是 nHibernate 会自动缓存的东西？

这甚至是正确的方法吗？在过去，我只是将角色 ID 的 int[] 直接传递到 SQL 并从那里创建记录——一个数据库调用来创建用户及其所有角色。很难用一种 ORM 方式来有效地做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:37:56.867

既然您已经在使用[AutoMapper](http://automapper.org/)，为什么不为`Roles`属性创建地图？

```
.ForMember(x => x.Roles, o => o.MapFrom(
    x => x.Roles.Select(id => _roleRepository.GetById(id)).ToList()) 
```

这可以封装在使用 DI 的 AutoMapper 配置文件中：

```
public class UserProfile : Profile
{
    private readonly IRoleRepository _roleRepository;

    public UserProfile(IRoleRepository roleRepository)
    {
        _roleRepository = roleRepository;
    }

    protected override void Configure()
    {
        CreateMap<UserCreateViewModel, User>()
            .ForMember(x => x.Roles, o => o.MapFrom(
                x => x.Roles.Select(id => _roleRepository.GetById(id)).ToList());
    }
} 
```

# php - Codeigniter 活动记录从 mysql 获取记录，其中 id 等于数组中的记录

> ID：11346263
> 
> 赞同：3
> 
> 时间：2012-07-05T14:19:43.280
> 
> 标签：php, mysql, arrays, codeigniter, activerecord

我有一个包含以下数据的数组：

```
array(3) { [0]=> array(1) { ["project_id"]=> string(2) "14" } [1]=> array(1) { ["project_id"]=> string(2) "21" } [2]=> array(1) { ["project_id"]=> string(2) "13" } } 
```

我需要从我的数据库中回显所有行，其中项目 ID 等于我的数组中的行。

使用下面的代码，我怎样才能只获取 id 等于数据库中的记录？

```
 function get_projects($id){
        $data = '';

        $this->db->where('id', $id); //HOW TO GET MULTIPLE IDS
        $query = $this->db->get('projects'); 

        foreach ($query->result() as $row) {
            $data[] = array(
                'id' => $row->id,
                'user_id' => $row->user_id,
                'project_name' => $row->project_name,
            );
        }

        return $data;

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T14:21:30.217

采用`where_in();`

```
$names = array('Frank', 'Todd', 'James');
$this->db->where_in('username', $names);
// Produces: WHERE username IN ('Frank', 'Todd', 'James') 
```

有关更多信息，请参阅[用户指南](http://codeigniter.com/user_guide/database/active_record.html)。

# javascript - Require.js Shim 用于加载 JQuery UI 和其他 JQuery 包

> ID：11346270
> 
> 赞同：6
> 
> 时间：2012-07-05T14:20:22.750
> 
> 标签：javascript, jquery, requirejs

我正在尝试使用 shim 加载 JQuery-Ui，但是即使我知道路径正确，当我尝试加载它时，JQueryUi 也会一直超时。

```
require.config({
paths: {
    jQuery: 'libs/jquery-wrapper',
    jQueryUi: 'libs/jquery-ui-min',
    jQuerySelectmenu: 'libs/jquery.ui.selectmenu',
    Underscore: 'libs/underscore-wrapper',
    Backbone: 'libs/backbone-wrapper',
},
shim: {'Backbone': {
          //These script dependencies should be loaded before loading
          //backbone.js
          deps: ['Underscore', 'jQuery'],
          //Once loaded, use the global 'Backbone' as the
          //module value.
          exports: 'Backbone'
      },
      'jQueryUi': {
          deps: ['jQuery'],
      },
      'jQuerySelectmenu': {
          deps: ['jQuery', 'jQueryUi']
      }
  }  
});

require([
    'jQuery',
    'Underscore',
    'Backbone',  
    'jQueryUi',
    'jQuerySelectmenu'  
], 
    function(App) {
        require(['order!src/app']
     ,     function (App) {
    App.initialize();
}); 
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-08T21:12:39.440

我认为 damee 提供的代表旧版本的 requireJs。像我一样按照本教程进行操作：[Load jQuery UI with requireJS](http://hippieitgeek.blogspot.se/2013/07/load-jquery-ui-with-requirejs.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T11:44:36.470

尝试使用此项目[https://github.com/jrburke/jqueryui-amd](https://github.com/jrburke/jqueryui-amd)将您的 jqueryui 转换为模块化版本。然后你可以简单地使用它：

```
define(['jquery', 'jqueryui/tabs'], function($){
    $('#tabs').tabs();    
}); 
```

使用 requirejs 配置：

```
requirejs.config({
paths: {
    'jqueryui': '/javascript-cdn/jqueryui/' //output form jqueryui-amd
}, 
shim: {
    'jquery': {
        deps: [], 
        init: function(){
            return $; 
        }
    },        
    'jqueryui': {
        deps: ['jquery'] 
    }
}
}); 
```

我希望这有帮助。

# jquery - 如果所有 td 为空，则隐藏表格行

> ID：11346271
> 
> 赞同：4
> 
> 时间：2012-07-05T14:20:33.527
> 
> 标签：jquery

有没有一种简单的方法可以在没有每个循环的情况下做到这一点。

我想隐藏整个`<tr>`，但前提是它的所有`<td>`s 都是空白的。该表是动态生成的，因此空白行可以在任何位置。

```
$('#table1 tr:has(td):empty').remove(); 
```

**HTML**

```
<table id="table1">
<tr>
<td>a</td>
<td>b</td>
<td>c</td>
</tr>
<tr >
<td></td>
<td></td>
<td></td>
</tr>
...
<tr>
<td>a</td>
<td>b</td>
<td>c</td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-05T14:22:22.793

我建议，尽管这仍然隐含地检查每个`tr`元素：

```
$('tr').filter(
    function(){
        return $(this).find('td').length == $(this).find('td:empty').length;
    }).hide(); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/TjfPa/)。

在 CSS 中，使用和伪选择器，这是有*一些*跨浏览器的困难的：`:not()``:empty`

```
tr td:empty {
    visibility: hidden;
    height: 0;
}

​td:not(:empty) ~ td:empty {
    visibility: visible;
    height: 100%;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/TjfPa/1/)。

参考：

*   jQuery：
    *   [`:empty`(jQuery) 选择器](http://api.jquery.com/empty-selector/)。
    *   [`filter()`](http://api.jquery.com/filter/).
    *   [`find()`](http://api.jquery.com/find/).
*   CSS：
    *   [`:empty`](http://www.w3.org/TR/selectors/#empty-pseudo).
    *   [一般兄弟`~`组合](http://www.w3.org/TR/selectors/#general-sibling-combinators)子。
    *   [`:not()`](http://www.w3.org/TR/selectors/#negation).

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-05T14:35:56.433

如果你想使用每个，你可以这样做：

```
$('#table1 tr').each(function() {
    if ($(this).find('td:empty').length) $(this).remove();
});​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/agz7z/)**

# android - Android - 为什么使用 onSaveInsanceState() 来保存未调用的位图对象？

> ID：11346275
> 
> 赞同：6
> 
> 时间：2012-07-05T14:20:38.230
> 
> 标签：android, bitmap, savestate

我正在制作一个简单的绘图应用程序。

当设备方向改变时，我希望能够将用户的绘图保存在屏幕上。这只发生在主要活动中。

我读到如果方向发生变化，那么活动将被销毁并再次重新创建（`onCreate(Bundle created)`被调用）。我不确定这是否意味着它也应该调用`onSavedInstanceState(Bundle bundle)`，因为在我的应用程序中，只有在另一个活动将焦点放在我的主要活动之上时才会调用它，而不是在旋转到横向/纵向时才调用。

我只是在寻找一种方法来保存现有位图并在方向改变时将其传递给主要活动。`onSaveInstanceState`如果我从来没有被叫过，我该怎么办？

另外，由于 Bitmap 已经实现`parceable`了我使用它。

这是主要活动的代码：

```
 public void onCreate(Bundle savedInstanceState) {      
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
// some more activity code...

        if (savedInstanceState != null) {
        bitmap = savedInstanceState.getParcelable("bitmap");
        Log.d("STATE-RESTORE", "bitmap created");
        paintBoard.setBitmapBackground(bitmap, false);
        Log.d("RESTORING...", "onRestoreInstanceState()");
    } else {
        Log.d("SavedInstanceState", "null");
    }
}

// Never called when I change orientation on my device
@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    bitmap = Bitmap.createBitmap(paintBoard.getBitmap());
    outState.putParcelable("bitmap", bitmap);
    Log.d("STATE-SAVE", "onSaveInstanceState()");
} 
```

任何帮助将不胜感激。

**编辑 ：**

我从 AndroidManifest.xml 文件中删除了这一行：

```
android:configChanges="orientation" 
```

现在`onSaveInstanceState()`当我在设备上改变方向时会被调用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T14:36:59.013

你应该完整阅读[这篇文章](http://developer.android.com/guide/topics/resources/runtime-changes.html)。

> ...您可能无法使用系统通过 `onSaveInstanceState()`回调为您保存的 Bundle 完全恢复您的活动状态——它不是为携带大对象（例如位图）而设计的，并且其中的数据必须被序列化然后反序列化，这会消耗大量内存并使配置更改变慢。在这种情况下，您可以通过在您的活动因配置更改而重新启动时保留一个有状态的对象来减轻重新初始化活动的负担。
> 
> 在运行时配置更改期间保留对象：
> 
> 1.  覆盖该`onRetainNonConfigurationInstance()`方法以返回您想要保留的对象。
> 2.  当您的活动再次创建时，调用`getLastNonConfigurationInstance()`以恢复您的对象。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-07T12:18:15.767

我正在阅读 TheNewBoston 的 Android 教程[https://thenewboston.com/](https://thenewboston.com/)

在第 4 部分，Travis 带领我们完成了一个相机应用程序，该应用程序也可以将图片设置为壁纸。旋转时位图消失的问题并没有解决，但是他只提供了`android:configChanges="orientation"`解决方案，暂时阻止了屏幕旋转。

使用此页面中的信息，我添加了

```
if (savedInstanceState != null) {
    bmp = savedInstanceState.getParcelable("bitmap");
    iv.setImageBitmap(bmp);
} 
```

在 onCreate 结束时

并添加了这个覆盖

```
@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putParcelable("bitmap", bmp);
} 
```

在课堂里。

这解决了位图消失的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:54:36.340

onConfigurationChanged() 方法可能是解决您的问题的最简单方法。它在方向切换之间保存应用程序的当前状态

这个[链接](http://developer.android.com/guide/topics/manifest/activity-element.html)有更多关于它的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-23T11:26:09.080

现在，您可以将数据存储在视图模型中，并在配置更改时保留它们。

* * *

## 回答 #5

> 赞同：-14
> 
> 时间：2012-07-05T14:33:18.787

将您的位图保存在`onPause()`或`onDestroy()`因为我认为`onSavedInstanceState()`在切换方向时不会被android系统调用。

# wpf - WPF：布局动态内容，以便在必要时只有一个滚动条，否则内容会扩展以填充空间

> ID：11346276
> 
> 赞同：1
> 
> 时间：2012-07-05T14:20:40.550
> 
> 标签：wpf

我正在尝试垂直布局一组文本框，一个在另一个之上。如果有太多的 TextBoxes 无法容纳在 Window 高度内，那么我希望 ScrollBar 在 Window 上可用。文本框的数量`input`是可变的。总是有一个名为 的最后一个文本框`output`。

如果所有文本框都可以出现在窗口高度内，那么我希望最后一个文本框拉伸到底部并填充所有剩余空间。此外，如果`output`TextBox 有很多 Text，那么我希望这个 TextBox 可以提供 ScrollBar。

这是我所拥有的一些伪 XAML：

```
<ScrollViewer>
    <Grid>
        <TextBox Name="input1" Margin="12, 12, 12, 12" VerticalAlignment="Top" HorizontalAlignment="Left" />
        <TextBox Name="input2" Margin="12, 60, 12, 12" VerticalAlignment="Top" HorizontalAlignment="Left" />
        <TextBox Name="input3" Margin="12, 108, 12, 12" VerticalAlignment="Top" HorizontalAlignment="Left" />
        ...
        <TextBox Name="inputN" Margin="12, ((N - 1) * 48 + 12), 12, 12" VerticalAlignment="Top" HorizontalAlignment="Left" />
        <TextBox Name="ouput" Margin="12, (N * 48 + 12), 12, 12" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" />
    </Grid>
</ScrollViewer> 
```

我现在遇到的问题是，如果`output`TextBox 有很多内容，那么它的高度会增加，并且 Window 会出现一个 ScrollBar。相反，我希望`output`TextBox 获得 ScrollBar。

我可以通过删除持有 Grid 的 ScrollViewer 来解决这个问题。但是，如果我这样做，我会遇到另一个问题。因为文本框的数量`input`是可变的，所以如果有太多以至于不是所有的文本框都可以显示在窗口中，那么窗口就没有我需要的滚动条。

我曾尝试在`output`TextBox 上放置 MaxHeight，但如果 TextBox 很少`input`且窗口很高，那么我很可能无法填充所有剩余的垂直空间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:30:46.120

听起来您需要将输出文本框包装在 ScrollViewer 中，并确保它确实留在底部（在 Grid 中定义一些行或将其停靠在 DockPanel 的底部。

编辑：你需要这样的东西吗？

```
<Grid x:Name="grd01">
  <Grid.RowDefinitions>
    <RowDefinition />
    <RowDefinition Height="35" />
  </Grid.RowDefinitions>

  <ScrollViewer Grid.Row="1">
    <TextBox HorizontalAlignment="Stretch" TextWrapping="Wrap" />
  </ScrollViewer>
</Grid> 
```

第二次编辑：

```
<Grid x:Name="grd01">
  <Grid.RowDefinitions>
    <RowDefinition />
    <RowDefinition Height="35" />
  </Grid.RowDefinitions>

  <ScrollViewer Grid.Row="0">
    <StackPanel>
      <TextBox x:Name="input"
                HorizontalAlignment="Stretch"
                TextWrapping="Wrap" />
    </StackPanel>
  </ScrollViewer>

  <ScrollViewer Grid.Row="1">
    <TextBox x:Name="output"
              HorizontalAlignment="Stretch"
              TextWrapping="Wrap" />
  </ScrollViewer>
</Grid> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:52:25.293

您可以使用以下代码对窗口加载事件使用此调整： **编辑**：我修改了它，因此如果现在调整大小它甚至是正确的

```
 private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        output.MaxHeight = output.ActualHeight;
        output.VerticalAlignment = VerticalAlignment.Top;
        output.Height = output.MaxHeight;
    }

    private void Window_SizeChanged(object sender, SizeChangedEventArgs e)
    {
        output.MaxHeight = output.MinHeight = output.Height = outGrid.ActualHeight;
    } 
```

-

```
<ScrollViewer Height="Auto">
    <DockPanel>
        <StackPanel DockPanel.Dock="Top" >
            <TextBox VerticalAlignment="Top" HorizontalAlignment="Stretch" />
            <TextBox VerticalAlignment="Top" HorizontalAlignment="Stretch" />
            <TextBox VerticalAlignment="Top" HorizontalAlignment="Stretch" />
            <TextBox VerticalAlignment="Top" HorizontalAlignment="Stretch" />
            <TextBox VerticalAlignment="Top" HorizontalAlignment="Stretch" />
            <TextBox VerticalAlignment="Top" HorizontalAlignment="Stretch" />
        </StackPanel>
        <Grid DockPanel.Dock="Bottom" Name="outGrid">
            <TextBox Name="output" TextWrapping="Wrap" AcceptsReturn="True" HorizontalAlignment="Stretch" VerticalScrollBarVisibility="Auto" VerticalAlignment="Stretch" />
        </Grid>
    </DockPanel>
</ScrollViewer> 
```

# php - Google Calendar API - PHP - 设置事件的颜色

> ID：11346277
> 
> 赞同：9
> 
> 时间：2012-07-05T14:20:42.763
> 
> 标签：php, google-calendar-api

使用 Google Calendar API (PHP) 插入事件时如何设置颜色？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2018-11-01T09:52:18.150

这是我编写的一个 PHP 函数和我提取的 PHP 客户端库的一部分，以允许我在我的日历中创建事件、删除事件等，但代码只是为了向您展示 colorId 需要设置的位置和语法让它工作。

Google 将为您可以设置 colorId 的前 11 个整数中的每一个显示颜色。

1 蓝色

2 绿色

3紫

4红色

5 黄色

6橙

7 绿松石

8灰色

9 粗体蓝色

10 粗体绿色

11 粗体红色

```
function calendar_update($heading,$details,$address,$calendar_name,$start_time,$end_time,$event_id = "")
{
    $client = get_google_client($calendar_name); // ID of your Google calendar
    $capi = new GoogleCalendarApi($client);

    $event['event_time']['start_time'] = $start_time; // Start time of event
    $event['event_time']['end_time'] = $end_time;     // End time of the event
    $event['summary'] = $heading;                     // The title of the event
    $event['location'] = $address;                    // Address field of event
    $event['description'] = $details;                 // Body of the event
    $event['colorId'] = 3;                            // colorId of event (see above)
    $event['attendees'] = $calendar_name;

    try 
    {
        $event_id = $capi->CreateCalendarEvent($calendar_name, $event, 0,
             $event['event_time'], "Australia/Sydney", $_SESSION['access_token']);
    }
    catch(Exception $e) 
    {
        $result = $e->getMessage();
        return("ERROR\t$e");
    }
    return($event_id);
}

class GoogleCalendarApi
{
    public function GetAccessToken($client_id, $redirect_uri, $client_secret, $code) {    
        $url = 'https://accounts.google.com/o/oauth2/token';            

        $curlPost = 'client_id=' . $client_id . '&redirect_uri=' . $redirect_uri . '&client_secret=' . $client_secret . '&code='. $code . '&grant_type=authorization_code';
        $ch = curl_init();        
        curl_setopt($ch, CURLOPT_URL, $url);        
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);        
        curl_setopt($ch, CURLOPT_POST, 1);        
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
        curl_setopt($ch, CURLOPT_POSTFIELDS, $curlPost);    
        $data = json_decode(curl_exec($ch), true);
        $http_code = curl_getinfo($ch,CURLINFO_HTTP_CODE);        
        if($http_code != 200) 
            throw new Exception('Error : Failed to receieve access token');

        return $data;
    }

    public function GetUserCalendarTimezone($access_token) {
        $url_settings = 'https://www.googleapis.com/calendar/v3/users/me/settings/timezone';

        $ch = curl_init();        
        curl_setopt($ch, CURLOPT_URL, $url_settings);        
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);    
        curl_setopt($ch, CURLOPT_HTTPHEADER, array('Authorization: Bearer '. $access_token));    
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);    
        $data = json_decode(curl_exec($ch), true); //echo '<pre>';print_r($data);echo '</pre>';
        $http_code = curl_getinfo($ch,CURLINFO_HTTP_CODE);        
        if($http_code != 200) 
            throw new Exception('Error : Failed to get timezone');

        return $data['value'];
    }

    public function GetCalendarsList($access_token) {
        $url_parameters = array();

        $url_parameters['fields'] = 'items(id,summary,timeZone)';
        $url_parameters['minAccessRole'] = 'owner';

        $url_calendars = 'https://www.googleapis.com/calendar/v3/users/me/calendarList?'. http_build_query($url_parameters);

        $ch = curl_init();        
        curl_setopt($ch, CURLOPT_URL, $url_calendars);        
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);    
        curl_setopt($ch, CURLOPT_HTTPHEADER, array('Authorization: Bearer '. $access_token));    
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);    
        $data = json_decode(curl_exec($ch), true); //echo '<pre>';print_r($data);echo '</pre>';
        $http_code = curl_getinfo($ch,CURLINFO_HTTP_CODE);        
        if($http_code != 200) 
            throw new Exception('Error : Failed to get calendars list');

        return $data['items'];
    }

    public function CreateCalendarEvent($calendar_id, $summary, $all_day, $event_time, $event_timezone, $access_token) {
        $url_events = 'https://www.googleapis.com/calendar/v3/calendars/' . $calendar_id . '/events';

        $curlPost = $summary;
//        $curlPost = array('summary' => $summary);
        if($all_day == 1) {
            $curlPost['start'] = array('date' => $event_time['event_date']);
            $curlPost['end'] = array('date' => $event_time['event_date']);
        }
        else {
            $curlPost['start'] = array('dateTime' => $event_time['start_time'], 'timeZone' => $event_timezone);
            $curlPost['end'] = array('dateTime' => $event_time['end_time'], 'timeZone' => $event_timezone);
        }
        $ch = curl_init();        
        curl_setopt($ch, CURLOPT_URL, $url_events);        
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);        
        curl_setopt($ch, CURLOPT_POST, 1);        
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
        curl_setopt($ch, CURLOPT_HTTPHEADER, array('Authorization: Bearer '. $access_token, 'Content-Type: application/json'));    
        curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($curlPost));    
        $data = json_decode(curl_exec($ch), true);
        $http_code = curl_getinfo($ch,CURLINFO_HTTP_CODE);        
        if($http_code != 200) 
            throw new Exception('Error : Failed to create event');

        return $data['id'];
    }

    public function UpdateCalendarEvent($event_id, $calendar_id, $summary, $all_day, $event_time, $event_timezone, $access_token) {
        $url_events = 'https://www.googleapis.com/calendar/v3/calendars/' . $calendar_id . '/events/' . $event_id;

        $curlPost = $summary;
//        $curlPost = array('summary' => $summary);
        if($all_day == 1) {
            $curlPost['start'] = array('date' => $event_time['event_date']);
            $curlPost['end'] = array('date' => $event_time['event_date']);
        }
        else {
            $curlPost['start'] = array('dateTime' => $event_time['start_time'], 'timeZone' => $event_timezone);
            $curlPost['end'] = array('dateTime' => $event_time['end_time'], 'timeZone' => $event_timezone);
        }
        $ch = curl_init();        
        curl_setopt($ch, CURLOPT_URL, $url_events);        
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);        
        curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'PUT');        
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
        curl_setopt($ch, CURLOPT_HTTPHEADER, array('Authorization: Bearer '. $access_token, 'Content-Type: application/json'));    
        curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($curlPost));    
        $data = json_decode(curl_exec($ch), true);
        $http_code = curl_getinfo($ch,CURLINFO_HTTP_CODE);        
        if($http_code != 200) 
            throw new Exception('Error : Failed to update event Code: ' . $http_code);
    }

    public function DeleteCalendarEvent($event_id, $calendar_id, $access_token) {
        $url_events = 'https://www.googleapis.com/calendar/v3/calendars/' . $calendar_id . '/events/' . $event_id;

        $ch = curl_init();        
        curl_setopt($ch, CURLOPT_URL, $url_events);        
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);        
        curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'DELETE');        
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
        curl_setopt($ch, CURLOPT_HTTPHEADER, array('Authorization: Bearer '. $access_token, 'Content-Type: application/json'));        
        $data = json_decode(curl_exec($ch), true);
        $http_code = curl_getinfo($ch,CURLINFO_HTTP_CODE);
        if($http_code != 204) 
            throw new Exception('Error : Failed to delete event');
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-05T14:30:27.410

[您可以在创建事件](https://developers.google.com/google-apps/calendar/v3/reference/events/insert)时设置可选`colorId`属性。您可以从[颜色端点](https://developers.google.com/google-apps/calendar/v3/reference/colors/get)检索颜色列表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-24T10:42:52.387

在这里，您可以找到要为事件插入的颜色的每个 idColor [谷歌日历事件的 id 颜色](https://www.eduardopereira.pt/wp-content/uploads/2012/06/google_calendar_api_event_color_chart.png)

# java - Android（或 iOS） - 图片上传队列

> ID：11346279
> 
> 赞同：2
> 
> 时间：2012-07-05T14:20:49.053
> 
> 标签：java, android, ios, rest, file-upload

我们为 Android（和 iOS）编写了一个应用程序，它允许用户将照片上传到我们的 REST 服务器。我们遇到的问题是，有时用户所在的地方信号很差，没有 WIFI。所以，我想知道是否有预建的解决方案，或者推荐的路径来推迟这些上传，如果只有乏味的网络选项可用。

现在在 Android 上，我正在使用 AsyncTask 上传捕获图像的流表示。图像的最大尺寸被裁剪为 1280，另一个是纵横比缩放，因此图像不是很大。

我想用户可能长达 2 小时没有信号，所以它不需要每分钟都尝试上传。此外，我认为可能有多个上传，因此需要某种队列。

我不肯定 iOS 应用程序正在利用什么，但我可以确定它是否有帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T14:26:54.010

最好的选择是将照片保存到 SD 卡并将其路径放入数据库中。这里的数据库就像一个队列。因此，只要用户可以访问互联网，应用程序就可以检查数据库中是否有任何条目并开始上传。上传照片后，您将从数据库中删除该记录。

现在，就上传而言，我建议在服务中进行，而不是在 AsyncTask 中进行。这样，您可以使用 AlarmManager 定期调用服务并检查是否有要上传的内容。

我在我的一个应用程序中使用了这种方法，但用于文档。它就像一个魅力。希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:26:35.153

在 iOS 中，我使用[了 ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest/)，但目前您可以找到其他解决方案（[MKNetworkKit](https://github.com/MugunthKumar/MKNetworkKit)）。我做了一个与您所做的完全一样的应用程序，所以我所做的是：

1.  检查是否有网络，如果有则继续，否则停止。
2.  尝试发送一张照片，如果成功则转到下一张，否则将照片留在队列中并转到下一张。
3.  重复过程。

让我们假设用户将 20 张照片放在队列中，然后开始该过程，在一天结束时，他可以再次检查哪些成功，哪些没有。当然，他可以重新发送最初失败的内容。

# jquery - 在 ASP.NET MVC 下从 jquery 生成的弹出窗口提交表单

> ID：11346281
> 
> 赞同：0
> 
> 时间：2012-07-05T14:21:05.200
> 
> 标签：jquery, asp.net-mvc, forms

我正在尝试复制类似于 StackOverflow 上的“标志”功能的东西，用户单击“删除”链接。然后向他们显示一个弹出窗口（使用 jQuery），提示他们删除项目的原因。它们通过一系列单选按钮以及“其他”文本框提供了一些预定义选项。他们必须在提交表单之前选择其中一个选项，然后执行一些服务器端操作，然后初始弹出窗口会消失（我会在几个地方操作一些文本）。

我已经准备好弹出窗口，并在此弹出窗口中呈现了一个包含各种选项的表单，但我不确定如何处理此表单的发布。如果我将其视为普通表单，当用户单击弹出窗口中的提交按钮时，它不会执行任何 ajax 功能，而是发布到我的控制器操作方法之一，然后我需要（服务器端) 重定向回我的页面，以便查看更改。

在 AJAX 类型场景中通常如何处理从弹出窗口中收集的数据？任何人都可以提供任何例子吗？我看不到 SO 是如何使用“标志”功能做到这一点的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:49:30.070

您可以使用 MVC 的内置 AJAX 助手。大致如下...

声明一些 AJAX 选项：

```
@{
    AjaxOptions ajaxOpts = new AjaxOptions { UpdateTargetId = "target" };
} 
```

然后使用 AJAX BeginForm 方法声明您的表单：

```
@using (Ajax.BeginForm("GetData", ajaxOpts))
{
  @* Here you put your form data. I'm guessing your popup could just be a DIV that gets positioned and made visible *@

} 
```

当 AJAX 请求返回时，您要更新的目标只是一个简单的 DIV：

```
<div id="target">  
    @* The output of your GetData controller method will end up here *@
    @Html.Action("GetData", new { model = Model })
</div> 
```

然后在您的控制器中，您有一些返回包含您的数据的 PartialView 的东西：

```
 public PartialViewResult GetData(ViewModel model)
  {
     // Do some stuff here to fetch some data
     // ViewModel will be whatever your view model is called

     return this.PartialView("GetData", model);
  } 
```

这就是让 AJAX 工作的基础。如果您想获取发送回浏览器的 HTML 并更新页面的不同位，则必须添加一个 jQuery 函数，通过为 AjaxOptions 的 OnComplete 参数指定一个函数来调用 AJAX 助手。

然后，您的局部视图中的数据可能包含一些隐藏的 HTML 块，您可以将它们移动到浏览器的其他位置。

不幸的是，MVC AJAX 助手只支持一个 UpdateTargetId。

**编辑以添加**

您需要在 web 配置文件的 appSettings 中进行设置：

```
<add key="UnobtrusiveJavaScriptEnabled" value="true"/> 
```

您还需要在 html 输出中包含 jQuery 扩展（可能在 _Layout.cshtml 文件中？）：

```
<script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:26:59.647

您可以覆盖表单的提交行为，然后在 AJAX 帖子中将序列化的表单结果发送到服务器。

```
$('#myForm').submit(function() {

    $.ajax({
      url: "MyPage.aspx",
      type: "POST",
      data: $(this).serialize(),
      dataType: "text"
    });

    return false;
}); 
```

# mongodb - 分片键、chunkSize 和预拆分

> ID：11346282
> 
> 赞同：0
> 
> 时间：2012-07-05T14:21:05.790
> 
> 标签：mongodb, sharding

我已经按照这里提到的步骤在一台机器上设置了一个分片集群：

[http](http://www.mongodb.org/display/DOCS/A+Sample+Configuration+Session)

://www.mongodb.org/display/DOCS/A+Sample+Configuration+Session 但我不明白'--chunkSize ' 选项：

`$ ./mongos --configdb localhost:20000 --chunkSize 1 > /tmp/mongos.log &`

对于 N 个分片，每个分片应该有 1/N 个文档，将 shard-key 的范围分成 N 个几乎相等的部分，对吧？这会自动修复 chunkSize/shard-size。上面的命令处理的是哪个块？

此外，还可以按照特定的键值手动拆分集合，然后将一个块迁移到您想要的任何其他分片。这可以手动完成，甚至由“平衡器”自动处理。不'

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:34:41.727

你可能会混淆一些事情。--chunkSize 参数设置进行拆分的块大小。“config”数据库中的“settings”集合与_id“chunksize”查看当前值（如果已设置）。--chunkSize 选项将仅设置此值，或对系统进行更改，如果尚未设置值，否则将被忽略。

块大小是以兆字节为单位的大小，高于该大小系统将保留块。这是在两个地方完成的，1）当写入通过 mongos 实例时，2）在平衡期间将块移动到另一个分片之前。因此，它不遵循“数据大小/分片数”公式。您的每块 1Mb 的示例几乎总是一个坏主意。

您确实可以手动拆分和移动块，尽管这可能会导致块分布不太理想，但它永远不会混淆或破坏配置元数据和平衡器。原因比较简单；平衡器使用相同的命令并遵循相同的代码路径。从 MongoDB 的角度来看，平衡器进程拆分和移动块与您执行此操作之间没有显着差异。

不过，有一些有效的用例可用于手动拆分和移动块。例如，您可能希望手动执行此操作，以便从冷启动（预拆分）开始为非常高的峰值负载准备集群。通常，您将编写一个脚本来执行此操作，或者从已经运行良好的性能测试中加载拆分。此外，您可以根据应用程序监控的“负载”观察热块以拆分/移动这些块以均匀分布。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T18:02:53.183

十分感谢！我想我现在明白了..如果我错了，请纠正我：

我在想如果有 N 个服务器，那么集合的前 1/N 部分（=chunk1）将进入 shard1，第二个 1/N （ =chunk2) 会去 shard2 等等。。当你说没有这样的“公式”时，我搜索了一下，发现这些链接

[MongoDB 分片，添加新节点时如何重新平衡？](https://stackoverflow.com/questions/6575643/mongodb-sharding-how-does-it-rebalance-when-adding-new-nodes?rq=1)

[如何在 Mongo 中为每个分片定义分片范围？](https://stackoverflow.com/questions/7934092/how-to-define-sharding-range-for-each-shard-in-mongo?rq=1)

从文档中对“块”的定义来看，我认为它只是一个数据迁移的单元。当我们在 N 个服务器之间对一个集合进行分片时，总编号。块的数量不一定是 N。它们也不必大小相同。

一个块的最大大小已经在配置数据库的设置集合中设置为默认值（通常为 64MB），或者可以通过使用 --chunkSize 参数指定值来手动设置，如上面的代码所示。根据分片键的值，一个分片可能比另一个分片有更多的块。但是 MongoDB 使用了一个平衡器进程，试图将这些块均匀地分布在分片之间。通过均匀分布，我的意思是它倾向于拆分块并将它们迁移到其他分片，如果它们变得大于它们的限制或者如果一个特定的分片负载很重。这也可以手动完成，方法是遵循平衡器进程使用的同一组命令。

# python - 在 Pandas 中重命名列名

> ID：11346283
> 
> 赞同：2487
> 
> 时间：2012-07-05T14:21:15.090
> 
> 标签：python, pandas, replace, dataframe, rename

我有一个使用 Pandas 和列标签的 DataFrame，我需要对其进行编辑以替换原始列标签。

我想更改`A`原始列名所在的 DataFrame 中的列名：

```
['$a', '$b', '$c', '$d', '$e'] 
```

到

```
['a', 'b', 'c', 'd', 'e']. 
```

我将编辑后的列名存储在一个列表中，但我不知道如何替换列名。

* * *

## 回答 #1

> 赞同：3801
> 
> 时间：2012-07-06T01:48:15.147

## **重命名特定列**

使用该[`df.rename()`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.rename.html)函数并引用要重命名的列。并非所有列都必须重命名：

```
df = df.rename(columns={'oldName1': 'newName1', 'oldName2': 'newName2'})
# Or rename the existing DataFrame (rather than creating a copy) 
df.rename(columns={'oldName1': 'newName1', 'oldName2': 'newName2'}, inplace=True) 
```

**最小代码示例**

```
df = pd.DataFrame('x', index=range(3), columns=list('abcde'))
df

   a  b  c  d  e
0  x  x  x  x  x
1  x  x  x  x  x
2  x  x  x  x  x 
```

以下方法都有效并产生相同的输出：

```
df2 = df.rename({'a': 'X', 'b': 'Y'}, axis=1)  # new method
df2 = df.rename({'a': 'X', 'b': 'Y'}, axis='columns')
df2 = df.rename(columns={'a': 'X', 'b': 'Y'})  # old method  

df2

   X  Y  c  d  e
0  x  x  x  x  x
1  x  x  x  x  x
2  x  x  x  x  x 
```

请记住将结果分配回去，因为修改不是就地的。或者，指定`inplace=True`：

```
df.rename({'a': 'X', 'b': 'Y'}, axis=1, inplace=True)
df

   X  Y  c  d  e
0  x  x  x  x  x
1  x  x  x  x  x
2  x  x  x  x  x 
```

从 v0.25 开始，您还可以指定在指定`errors='raise'`要重命名的列无效时引发错误。请参阅[v0.25`rename()`文档](https://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.rename.html#pandas.DataFrame.rename)。

* * *

## 重新分配列标题

[`df.set_axis()`](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.set_axis.html)与`axis=1`and一起使用`inplace=False`（返回副本）。

```
df2 = df.set_axis(['V', 'W', 'X', 'Y', 'Z'], axis=1, inplace=False)
df2

   V  W  X  Y  Z
0  x  x  x  x  x
1  x  x  x  x  x
2  x  x  x  x  x 
```

这将返回一个副本，但您可以通过设置就地修改 DataFrame `inplace=True`（这是版本 <=0.24 的默​​认行为，但将来可能会更改）。

您也可以直接分配标题：

```
df.columns = ['V', 'W', 'X', 'Y', 'Z']
df

   V  W  X  Y  Z
0  x  x  x  x  x
1  x  x  x  x  x
2  x  x  x  x  x 
```

* * *

## 回答 #2

> 赞同：2401
> 
> 时间：2012-07-05T14:23:27.910

只需将其分配给`.columns`属性：

```
>>> df = pd.DataFrame({'$a':[1,2], '$b': [10,20]})
>>> df
   $a  $b
0   1  10
1   2  20

>>> df.columns = ['a', 'b']
>>> df
   a   b
0  1  10
1  2  20 
```

* * *

## 回答 #3

> 赞同：474
> 
> 时间：2013-05-21T09:58:59.743

该[`rename`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.rename.html)方法可以采用一个***函数***，例如：

```
In [11]: df.columns
Out[11]: Index([u'$a', u'$b', u'$c', u'$d', u'$e'], dtype=object)

In [12]: df.rename(columns=lambda x: x[1:], inplace=True)

In [13]: df.columns
Out[13]: Index([u'a', u'b', u'c', u'd', u'e'], dtype=object) 
```

* * *

## 回答 #4

> 赞同：236
> 
> 时间：2015-05-30T13:24:05.190

如*[使用文本数据](http://pandas.pydata.org/pandas-docs/stable/text.html)*中所述：

```
df.columns = df.columns.str.replace('$', '') 
```

* * *

## 回答 #5

> 赞同：187
> 
> 时间：2017-10-24T13:39:15.317

# 熊猫 0.21+ 答案

0.21 版中对列重命名进行了一些重大更新。

*   该[`rename`方法](http://pandas.pydata.org/pandas-docs/version/0.21/whatsnew.html#rename-reindex-now-also-accept-axis-keyword)添加了`axis`可以设置为`columns`或的参数`1`。此更新使此方法与 pandas API 的其余部分相匹配。它仍然具有`index`and`columns`参数，但您不再被迫使用它们。
*   设置为的[`set_axis`方法](http://pandas.pydata.org/pandas-docs/version/0.21/generated/pandas.DataFrame.set_axis.html#pandas.DataFrame.set_axis)使您能够使用列表重命名所有索引或列标签。`inplace``False`

## Pandas 0.21+ 的示例

构建示例 DataFrame：

```
df = pd.DataFrame({'$a':[1,2], '$b': [3,4], 
                   '$c':[5,6], '$d':[7,8], 
                   '$e':[9,10]})

   $a  $b  $c  $d  $e
0   1   3   5   7   9
1   2   4   6   8  10 
```

### `rename`与`axis='columns'`或一起使用`axis=1`

```
df.rename({'$a':'a', '$b':'b', '$c':'c', '$d':'d', '$e':'e'}, axis='columns') 
```

或者

```
df.rename({'$a':'a', '$b':'b', '$c':'c', '$d':'d', '$e':'e'}, axis=1) 
```

两者都导致以下结果：

```
 a  b  c  d   e
0  1  3  5  7   9
1  2  4  6  8  10 
```

仍然可以使用旧的方法签名：

```
df.rename(columns={'$a':'a', '$b':'b', '$c':'c', '$d':'d', '$e':'e'}) 
```

该`rename`函数还接受将应用于每个列名的函数。

```
df.rename(lambda x: x[1:], axis='columns') 
```

或者

```
df.rename(lambda x: x[1:], axis=1) 
```

* * *

### `set_axis`与列表一起使用`inplace=False`

您可以为该`set_axis`方法提供一个长度等于列数（或索引）的列表。目前，`inplace`默认为`True`，但在以后的版本`inplace`中将默认为。`False`

```
df.set_axis(['a', 'b', 'c', 'd', 'e'], axis='columns', inplace=False) 
```

或者

```
df.set_axis(['a', 'b', 'c', 'd', 'e'], axis=1, inplace=False) 
```

* * *

### 为什么不使用`df.columns = ['a', 'b', 'c', 'd', 'e']`？

像这样直接分配列并没有错。这是一个非常好的解决方案。

using 的优点`set_axis`是它可以用作方法链的一部分，并且它返回 DataFrame 的新副本。没有它，在重新分配列之前，您必须将链的中间步骤存储到另一个变量中。

```
# new for pandas 0.21+
df.some_method1()
  .some_method2()
  .set_axis()
  .some_method3()

# old way
df1 = df.some_method1()
        .some_method2()
df1.columns = columns
df1.some_method3() 
```

* * *

## 回答 #6

> 赞同：148
> 
> 时间：2014-03-26T10:20:45.720

由于您只想删除所有列名中的 $ 符号，您可以这样做：

```
df = df.rename(columns=lambda x: x.replace('$', '')) 
```

或者

```
df.rename(columns=lambda x: x.replace('$', ''), inplace=True) 
```

* * *

## 回答 #7

> 赞同：119
> 
> 时间：2020-05-08T12:34:49.857

在 Pandas 中重命名列是一项简单的任务。

```
df.rename(columns={'$a': 'a', '$b': 'b', '$c': 'c', '$d': 'd', '$e': 'e'}, inplace=True) 
```

* * *

## 回答 #8

> 赞同：90
> 
> 时间：2016-03-22T08:59:12.740

```
df.columns = ['a', 'b', 'c', 'd', 'e'] 
```

它将按照您提供的顺序将现有名称替换为您提供的名称。

* * *

## 回答 #9

> 赞同：75
> 
> 时间：2015-05-21T17:48:33.580

采用：

```
old_names = ['$a', '$b', '$c', '$d', '$e'] 
new_names = ['a', 'b', 'c', 'd', 'e']
df.rename(columns=dict(zip(old_names, new_names)), inplace=True) 
```

这样您就可以根据需要手动编辑`new_names`。当您只需要重命名几列以纠正拼写错误、重音符号、删除特殊字符等时，它非常有用。

* * *

## 回答 #10

> 赞同：41
> 
> 时间：2017-09-13T08:09:23.583

# 一条线或管道解决方案

我将专注于两件事：

1.  OP明确指出

    > 我将编辑后的列名存储在一个列表中，但我不知道如何替换列名。

    我不想解决如何替换`'$'`或删除每个列标题的第一个字符的问题。OP 已经完成了这一步。相反，我想专注于在`columns`给定替换列名称列表的情况下用新对象替换现有对象。

2.  `df.columns = new`新列名称列表在哪里`new`很简单。这种方法的缺点是它需要编辑现有数据框的`columns`属性，并且不是内联完成的。我将展示一些通过流水线执行此操作的方法，而无需编辑现有数据框。

* * *

**设置 1**
为了专注于用预先存在的列表重命名替换列名的需要，我将创建一个新的示例数据框`df`，其中包含初始列名和不相关的新列名。

```
df = pd.DataFrame({'Jack': [1, 2], 'Mahesh': [3, 4], 'Xin': [5, 6]})
new = ['x098', 'y765', 'z432']

df

   Jack  Mahesh  Xin
0     1       3    5
1     2       4    6 
```

* * *

**解决方案 1**
[**`pd.DataFrame.rename`**](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.rename.html)

已经说过，**如果**您有一个将旧列名映射到新列名的字典，则可以使用`pd.DataFrame.rename`.

```
d = {'Jack': 'x098', 'Mahesh': 'y765', 'Xin': 'z432'}
df.rename(columns=d)

   x098  y765  z432
0     1     3     5
1     2     4     6 
```

但是，您可以轻松地创建该字典并将其包含在对`rename`. 下面利用了这样一个事实，即在迭代时`df`，我们迭代每个列名。

```
# Given just a list of new column names
df.rename(columns=dict(zip(df, new)))

   x098  y765  z432
0     1     3     5
1     2     4     6 
```

如果您的原始列名是唯一的，这将非常有用。但如果他们不是，那么这就会崩溃。

* * *

**设置 2**
非唯一列

```
df = pd.DataFrame(
    [[1, 3, 5], [2, 4, 6]],
    columns=['Mahesh', 'Mahesh', 'Xin']
)
new = ['x098', 'y765', 'z432']

df

   Mahesh  Mahesh  Xin
0       1       3    5
1       2       4    6 
```

* * *

**解决方案 2**
[**`pd.concat`**](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.concat.html)使用`keys`参数

首先，注意当我们尝试使用解决方案 1 时会发生什么：

```
df.rename(columns=dict(zip(df, new)))

   y765  y765  z432
0     1     3     5
1     2     4     6 
```

我们没有将`new`列表映射为列名。我们最终重复了`y765`。相反，我们可以在遍历 的列时使用函数的`keys`参数。`pd.concat``df`

```
pd.concat([c for _, c in df.items()], axis=1, keys=new) 

   x098  y765  z432
0     1     3     5
1     2     4     6 
```

* * *

**解决方案 3**
重建。`dtype`仅当您对所有列都有一个时才应使用此选项。否则，您最终会`dtype` `object`得到所有列，并且将它们转换回来需要更多的字典工作。

*单身的`dtype`*

```
pd.DataFrame(df.values, df.index, new)

   x098  y765  z432
0     1     3     5
1     2     4     6 
```

*混合`dtype`*

```
pd.DataFrame(df.values, df.index, new).astype(dict(zip(new, df.dtypes)))

   x098  y765  z432
0     1     3     5
1     2     4     6 
```

* * *

**解决方案 4**这是一个带有和
的噱头。 允许我们设置一个内联索引，但是没有对应的 . 所以我们可以转置，然后，然后转回。但是，解决方案 3 中的单一警告与混合警告同样适用于此处。`transpose``set_index`[**`pd.DataFrame.set_index`**](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html)`set_columns``set_index``dtype``dtype`

*单身的`dtype`*

```
df.T.set_index(np.asarray(new)).T

   x098  y765  z432
0     1     3     5
1     2     4     6 
```

*混合`dtype`*

```
df.T.set_index(np.asarray(new)).T.astype(dict(zip(new, df.dtypes)))

   x098  y765  z432
0     1     3     5
1     2     4     6 
```

* * *

**解决方案 5**
使用 a循环遍历 的每个`lambda`元素。 在这个解决方案中，我们传递了一个接受但随后忽略它的 lambda。它也需要一个但并不期望它。取而代之的是，一个迭代器作为默认值给出，然后我可以使用它一次循环遍历一个，而不考虑值是什么。`pd.DataFrame.rename``new`
`x``y``x`

```
df.rename(columns=lambda x, y=iter(new): next(y))

   x098  y765  z432
0     1     3     5
1     2     4     6 
```

[*正如sopython* chat](https://chat.stackoverflow.com/rooms/6/python)中的人们向我指出的那样，如果我在and`*`之间添加一个，我可以保护我的变量。不过，在这种情况下，我认为它不需要保护。仍然值得一提。`x``y``y`

```
df.rename(columns=lambda x, *, y=iter(new): next(y))

   x098  y765  z432
0     1     3     5
1     2     4     6 
```

* * *

## 回答 #11

> 赞同：39
> 
> 时间：2016-09-29T12:30:40.073

# 列名与系列名称

我想解释一下幕后发生的事情。

数据框是一组系列。

Series 又是 a 的扩展`numpy.array`。

`numpy.array`s 有一个属性`.name`。

这是该系列的名称。Pandas 很少尊重此属性，但它在某些地方徘徊，可用于破解 Pandas 的某些行为。

# 命名列列表

这里的很多答案都谈到`df.columns`属性是 a`list`而实际上它是 a `Series`。这意味着它有一个`.name`属性。

如果您决定填写列的名称，就会发生这种情况`Series`：

```
df.columns = ['column_one', 'column_two']
df.columns.names = ['name of the list of columns']
df.index.names = ['name of the index']

name of the list of columns     column_one  column_two
name of the index
0                                    4           1
1                                    5           2
2                                    6           3 
```

请注意，索引的名称总是低一列。

## 挥之不去的文物

该`.name`属性有时会持续存在。如果你设置`df.columns = ['one', 'two']`，那么`df.one.name`将是`'one'`.

如果你定了`df.one.name = 'three'`那么`df.columns`还是会给你`['one', 'two']`的，`df.one.name`还会给你`'three'`的。

### 但

`pd.DataFrame(df.one)`将返回

```
 three
0       1
1       2
2       3 
```

因为 Pandas 重用`.name`了已经定义的`Series`.

# 多级列名

Pandas 可以使用多层列名。没有太多的魔法，但我也想在我的回答中涵盖这一点，因为我没有看到有人在这里接受这个。

```
 |one            |
    |one      |two  |
0   |  4      |  1  |
1   |  5      |  2  |
2   |  6      |  3  | 
```

这很容易通过将列设置为列表来实现，如下所示：

```
df.columns = [['one', 'one'], ['one', 'two']] 
```

* * *

## 回答 #12

> 赞同：33
> 
> 时间：2020-03-08T05:35:42.127

让我们通过一个小例子来*理解*重命名......

1.  使用映射重命名列：

    ```
     df = pd.DataFrame({"A": [1, 2, 3], "B": [4, 5, 6]}) # Creating a df with column name A and B
     df.rename({"A": "new_a", "B": "new_b"}, axis='columns', inplace =True) # Renaming column A with 'new_a' and B with 'new_b'

     Output:

        new_a  new_b
     0  1       4
     1  2       5
     2  3       6 
    ```

2.  使用映射重命名 index/Row_Name：

    ```
     df.rename({0: "x", 1: "y", 2: "z"}, axis='index', inplace =True) # Row name are getting replaced by 'x', 'y', and 'z'.

     Output:

            new_a  new_b
         x  1       4
         y  2       5
         z  3       6 
    ```

* * *

## 回答 #13

> 赞同：25
> 
> 时间：2019-08-27T08:30:27.657

假设这是您的数据框。

[![在此处输入图像描述](../Images/ccaa9ee272cc2309ba395e89e5fcf1f1.png)](https://i.stack.imgur.com/vazEj.png)

您可以使用两种方法重命名列。

1.  使用`dataframe.columns=[#list]`

    ```
    df.columns=['a','b','c','d','e'] 
    ```

    [![在此处输入图像描述](../Images/4ab0e26cef574fecf903642b1370798d.png)](https://i.stack.imgur.com/uFQzo.png)

    此方法的局限性在于，如果必须更改一列，则必须传递完整的列列表。此外，此方法不适用于索引标签。例如，如果你通过了这个：

    ```
    df.columns = ['a','b','c','d'] 
    ```

    这将引发错误。长度不匹配：预期轴有 5 个元素，新值有 4 个元素。

2.  另一种方法是 Pandas`rename()`方法，用于重命名任何索引、列或行

    ```
    df = df.rename(columns={'$a':'a'}) 
    ```

    [![在此处输入图像描述](../Images/4ab7fe3bc73c5f5ada519ad94af2266e.png)](https://i.stack.imgur.com/sqPu9.png)

同样，您可以更改任何行或列。

* * *

## 回答 #14

> 赞同：22
> 
> 时间：2021-05-10T08:17:06.187

假设您的数据集名称是 df，而 df 有。

```
df = ['$a', '$b', '$c', '$d', '$e']` 
```

因此，要重命名这些，我们只需这样做。

```
df.columns = ['a','b','c','d','e'] 
```

* * *

## 回答 #15

> 赞同：20
> 
> 时间：2015-09-01T02:24:17.883

如果您有数据框，则 df.columns 会将所有内容转储到您可以操作的列表中，然后将其作为列名重新分配到您的数据框中...

```
columns = df.columns
columns = [row.replace("$", "") for row in columns]
df.rename(columns=dict(zip(columns, things)), inplace=True)
df.head() # To validate the output 
```

最好的办法？我不知道。一种方式——是的。

评估问题答案中提出的所有主要技术的更好方法是使用 cProfile 来衡量内存和执行时间。@kadee、@kaitlyn 和 @eumiro 具有执行时间最快的函数 - 尽管这些函数非常快，但我们正在比较所有答案的 0.000 和 0.001 秒的舍入。道德：我上面的答案可能不是“最好”的方式。

```
import pandas as pd
import cProfile, pstats, re

old_names = ['$a', '$b', '$c', '$d', '$e']
new_names = ['a', 'b', 'c', 'd', 'e']
col_dict = {'$a': 'a', '$b': 'b', '$c': 'c', '$d': 'd', '$e': 'e'}

df = pd.DataFrame({'$a':[1, 2], '$b': [10, 20], '$c': ['bleep', 'blorp'], '$d': [1, 2], '$e': ['texa$', '']})

df.head()

def eumiro(df, nn):
    df.columns = nn
    # This direct renaming approach is duplicated in methodology in several other answers:
    return df

def lexual1(df):
    return df.rename(columns=col_dict)

def lexual2(df, col_dict):
    return df.rename(columns=col_dict, inplace=True)

def Panda_Master_Hayden(df):
    return df.rename(columns=lambda x: x[1:], inplace=True)

def paulo1(df):
    return df.rename(columns=lambda x: x.replace('$', ''))

def paulo2(df):
    return df.rename(columns=lambda x: x.replace('$', ''), inplace=True)

def migloo(df, on, nn):
    return df.rename(columns=dict(zip(on, nn)), inplace=True)

def kadee(df):
    return df.columns.str.replace('$', '')

def awo(df):
    columns = df.columns
    columns = [row.replace("$", "") for row in columns]
    return df.rename(columns=dict(zip(columns, '')), inplace=True)

def kaitlyn(df):
    df.columns = [col.strip('$') for col in df.columns]
    return df

print 'eumiro'
cProfile.run('eumiro(df, new_names)')
print 'lexual1'
cProfile.run('lexual1(df)')
print 'lexual2'
cProfile.run('lexual2(df, col_dict)')
print 'andy hayden'
cProfile.run('Panda_Master_Hayden(df)')
print 'paulo1'
cProfile.run('paulo1(df)')
print 'paulo2'
cProfile.run('paulo2(df)')
print 'migloo'
cProfile.run('migloo(df, old_names, new_names)')
print 'kadee'
cProfile.run('kadee(df)')
print 'awo'
cProfile.run('awo(df)')
print 'kaitlyn'
cProfile.run('kaitlyn(df)') 
```

* * *

## 回答 #16

> 赞同：20
> 
> 时间：2016-02-14T00:31:53.873

```
df = pd.DataFrame({'$a': [1], '$b': [1], '$c': [1], '$d': [1], '$e': [1]}) 
```

如果您的新列列表与现有列的顺序相同，则分配很简单：

```
new_cols = ['a', 'b', 'c', 'd', 'e']
df.columns = new_cols
>>> df
   a  b  c  d  e
0  1  1  1  1  1 
```

如果您有一个将旧列名键入新列名的字典，则可以执行以下操作：

```
d = {'$a': 'a', '$b': 'b', '$c': 'c', '$d': 'd', '$e': 'e'}
df.columns = df.columns.map(lambda col: d[col])  # Or `.map(d.get)` as pointed out by @PiRSquared.
>>> df
   a  b  c  d  e
0  1  1  1  1  1 
```

如果您没有列表或字典映射，则可以`$`通过列表理解去除前导符号：

```
df.columns = [col[1:] if col[0] == '$' else col for col in df] 
```

* * *

## 回答 #17

> 赞同：20
> 
> 时间：2018-07-19T04:50:15.873

```
df.rename(index=str, columns={'A':'a', 'B':'b'}) 
```

*[pandas.DataFrame.rename](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.rename.html)*

* * *

## 回答 #18

> 赞同：18
> 
> 时间：2021-06-15T00:38:13.490

许多 pandas 函数都有一个 inplace 参数。将其设置为 True 时，转换直接应用于您调用它的数据框。例如：

```
df = pd.DataFrame({'$a':[1,2], '$b': [3,4]})
df.rename(columns={'$a': 'a'}, inplace=True)
df.columns

>>> Index(['a', '$b'], dtype='object') 
```

或者，在某些情况下，您希望保留原始数据框。如果创建数据框是一项昂贵的任务，我经常看到人们陷入这种情况。例如，如果创建数据框需要查询雪花数据库。在这种情况下，只需确保将 inplace 参数设置为 False。

```
df = pd.DataFrame({'$a':[1,2], '$b': [3,4]})
df2 = df.rename(columns={'$a': 'a'}, inplace=False)
df.columns

>>> Index(['$a', '$b'], dtype='object')

df2.columns

>>> Index(['a', '$b'], dtype='object') 
```

如果这些类型的转换是您经常做的事情，您还可以查看许多不同的 pandas GUI 工具。我是一个叫做[Mito](https://trymito.io/soo)的创造者。它是一个电子表格，可自动将您的编辑转换为 python 代码。

* * *

## 回答 #19

> 赞同：17
> 
> 时间：2015-11-23T13:56:10.337

我们可以替换原始列标签的另一种方法是从原始列标签中删除不需要的字符（此处为“$”）。

这可以通过在 df.columns 上运行*for*循环并将剥离的列附加到 df.columns 来完成。

相反，我们可以使用下面的列表推导在单个语句中巧妙地做到这一点：

```
df.columns = [col.strip('$') for col in df.columns] 
```

（`strip`Python 中的方法从字符串的开头和结尾剥离给定的字符。）

* * *

## 回答 #20

> 赞同：16
> 
> 时间：2015-11-29T19:22:47.913

这真的很简单。只需使用：

```
df.columns = ['Name1', 'Name2', 'Name3'...] 
```

它将按照您输入的顺序分配列名。

* * *

## 回答 #21

> 赞同：16
> 
> 时间：2021-06-10T03:46:32.183

如果您已经有了新列名的列表，可以试试这个：

```
new_cols = ['a', 'b', 'c', 'd', 'e']
new_names_map = {df.columns[i]:new_cols[i] for i in range(len(new_cols))}

df.rename(new_names_map, axis=1, inplace=True) 
```

* * *

## 回答 #22

> 赞同：12
> 
> 时间：2016-01-28T17:31:39.437

您可以[`str.slice`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.str.slice.html)为此使用：

```
df.columns = df.columns.str.slice(1) 
```

* * *

## 回答 #23

> 赞同：12
> 
> 时间：2018-07-07T02:07:23.993

另一种选择是使用正则表达式重命名：

```
import pandas as pd
import re

df = pd.DataFrame({'$a':[1,2], '$b':[3,4], '$c':[5,6]})

df = df.rename(columns=lambda x: re.sub('\$','',x))
>>> df
   a  b  c
0  1  3  5
1  2  4  6 
```

* * *

## 回答 #24

> 赞同：11
> 
> 时间：2016-08-04T20:26:50.133

我的方法是通用的，您可以通过逗号分隔`delimiters=`变量添加额外的分隔符并使其面向未来。

**工作代码：**

```
import pandas as pd
import re

df = pd.DataFrame({'$a':[1,2], '$b': [3,4],'$c':[5,6], '$d': [7,8], '$e': [9,10]})

delimiters = '$'
matchPattern = '|'.join(map(re.escape, delimiters))
df.columns = [re.split(matchPattern, i)[1] for i in df.columns ] 
```

**输出：**

```
>>> df
   $a  $b  $c  $d  $e
0   1   3   5   7   9
1   2   4   6   8  10

>>> df
   a  b  c  d   e
0  1  3  5  7   9
1  2  4  6  8  10 
```

* * *

## 回答 #25

> 赞同：11
> 
> 时间：2021-07-14T02:09:30.870

```
# This way it will work
import pandas as pd

# Define a dictionary 
rankings = {'test': ['a'],
        'odi': ['E'],
        't20': ['P']}

# Convert the dictionary into DataFrame
rankings_pd = pd.DataFrame(rankings)

# Before renaming the columns
print(rankings_pd)

rankings_pd.rename(columns = {'test':'TEST'}, inplace = True) 
```

* * *

## 回答 #26

> 赞同：10
> 
> 时间：2016-08-29T21:27:20.727

请注意，先前答案中的方法不适用于*MultiIndex*。对于*MultiIndex*，您需要执行以下操作：

```
>>> df = pd.DataFrame({('$a','$x'):[1,2], ('$b','$y'): [3,4], ('e','f'):[5,6]})
>>> df
   $a $b  e
   $x $y  f
0  1  3  5
1  2  4  6
>>> rename = {('$a','$x'):('a','x'), ('$b','$y'):('b','y')}
>>> df.columns = pandas.MultiIndex.from_tuples([
        rename.get(item, item) for item in df.columns.tolist()])
>>> df
   a  b  e
   x  y  f
0  1  3  5
1  2  4  6 
```

* * *

## 回答 #27

> 赞同：9
> 
> 时间：2017-06-16T08:27:37.653

如果您必须处理您无法控制的由提供系统命名的大量列，我想出了以下方法，它是一种通用方法和特定替换的组合。

首先使用正则表达式从数据框列名创建一个字典，以便丢弃列名的某些附录，然后将特定替换添加到字典中，以便稍后在接收数据库中按预期命名核心列。

然后将其一次性应用于数据帧。

```
dict = dict(zip(df.columns, df.columns.str.replace('(:S$|:C1$|:L$|:D$|\.Serial:L$)', '')))
dict['brand_timeseries:C1'] = 'BTS'
dict['respid:L'] = 'RespID'
dict['country:C1'] = 'CountryID'
dict['pim1:D'] = 'pim_actual'
df.rename(columns=dict, inplace=True) 
```

* * *

## 回答 #28

> 赞同：8
> 
> 时间：2020-03-08T15:43:28.870

除了已经提供的解决方案之外，您还可以在读取文件时替换所有列。我们可以使用`names`并`header=0`做到这一点。

首先，我们创建一个我们喜欢用作列名的名称列表：

```
import pandas as pd

ufo_cols = ['city', 'color reported', 'shape reported', 'state', 'time']
ufo.columns = ufo_cols

ufo = pd.read_csv('link to the file you are using', names = ufo_cols, header = 0) 
```

在这种情况下，所有列名都将替换为您在列表中的名称。

* * *

## 回答 #29

> 赞同：6
> 
> 时间：2018-04-19T07:48:53.827

这是我喜欢用来减少打字的一个漂亮的小功能：

```
def rename(data, oldnames, newname):
    if type(oldnames) == str: # Input can be a string or list of strings
        oldnames = [oldnames] # When renaming multiple columns
        newname = [newname] # Make sure you pass the corresponding list of new names
    i = 0
    for name in oldnames:
        oldvar = [c for c in data.columns if name in c]
        if len(oldvar) == 0:
            raise ValueError("Sorry, couldn't find that column in the dataset")
        if len(oldvar) > 1: # Doesn't have to be an exact match
            print("Found multiple columns that matched " + str(name) + ": ")
            for c in oldvar:
                print(str(oldvar.index(c)) + ": " + str(c))
            ind = input('Please enter the index of the column you would like to rename: ')
            oldvar = oldvar[int(ind)]
        if len(oldvar) == 1:
            oldvar = oldvar[0]
        data = data.rename(columns = {oldvar : newname[i]})
        i += 1
    return data 
```

这是它如何工作的示例：

```
In [2]: df = pd.DataFrame(np.random.randint(0, 10, size=(10, 4)), columns = ['col1', 'col2', 'omg', 'idk'])
# First list = existing variables
# Second list = new names for those variables
In [3]: df = rename(df, ['col', 'omg'],['first', 'ohmy'])
Found multiple columns that matched col:
0: col1
1: col2

Please enter the index of the column you would like to rename: 0

In [4]: df.columns
Out[5]: Index(['first', 'col2', 'ohmy', 'idk'], dtype='object') 
```

* * *

## 回答 #30

> 赞同：6
> 
> 时间：2019-04-11T15:08:57.343

假设您可以使用正则表达式，此解决方案*无需*使用正则表达式进行手动编码：

```
import pandas as pd
import re

srch = re.compile(r"\w+")

data = pd.read_csv("CSV_FILE.csv")
cols = data.columns
new_cols = list(map(lambda v:v.group(), (list(map(srch.search, cols)))))
data.columns = new_cols 
```

* * *

## 回答 #31

> 赞同：6
> 
> 时间：2020-06-24T02:42:06.510

我需要重命名 XGBoost 的功能，但它不喜欢以下任何一个：

```
import re
regex = r"[!\"#$%&'()*+,\-.\/:;<=>?@[\\\]^_`{|}~ ]+"
X_trn.columns = X_trn.columns.str.replace(regex, '_', regex=True)
X_tst.columns = X_tst.columns.str.replace(regex, '_', regex=True) 
```

* * *

## 回答 #32

> 赞同：5
> 
> 时间：2021-03-19T10:29:52.807

如果您只想删除“$”符号，请使用以下代码

```
df.columns = pd.Series(df.columns.str.replace("$", "")) 
```

# iphone - 应用程序可以查明推送通知是启用还是禁用？

> ID：11346285
> 
> 赞同：2
> 
> 时间：2012-07-05T14:21:17.863
> 
> 标签：iphone, push-notification, apple-push-notifications

我的应用程序是否可以通过设备上的“设置”确定推送通知是否被禁用？我不是在谈论检查`feedback.push.apple.com`。我只是想知道设置中的开关是设置为开还是关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T05:02:13.687

您可以使用

```
[[UIApplication sharedApplication] enabledRemoteNotificationTypes] 
```

如果返回`UIRemoteNotificationTypeNone`的值等于 value `0`，则应用程序不接受任何通知。希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:24:10.657

您可以使用 了解为您的应用启用了哪种通知`[[UIApplication sharedApplication] enabledRemoteNotificationTypes]`。

# facebook - Facebook Connect 和 Codeigniter - HTTP/1.0 400 错误请求

> ID：11346289
> 
> 赞同：0
> 
> 时间：2012-07-05T14:21:32.573
> 
> 标签：facebook, codeigniter

我正在努力将 Facebook 连接实现到我的 codeigniter 应用程序中——我现在有一个问题。从这里下载 PHP SDK 后：[https](https://github.com/facebook/php-sdk/) ://github.com/facebook/php-sdk/我将 /src 文件复制到我的 CI 库中（每个人都这样做: )）。

现在我想使用这种方法对我的用户进行身份验证：

[https://developers.facebook.com/docs/authentication/server-side/](https://developers.facebook.com/docs/authentication/server-side/)

我的控制器在这里（我认为问题出在最后，但粘贴了完整文件，因为我不确定）：

```
<?php

class Fb25 extends CI_Controller {

function index()
{
            $app_id     = "MY APP ID";
    $app_secret = "MY SECRET KEY";
    $site_url   = "http://devlocalhost.com/";

$this->load->library('facebook',array('appId' => $app_id, 'secret' => $app_secret));

    $user = $this->facebook->getUser();
    $data['user'] = $user;

if($user){

    $data['user_profile'] = $this->facebook->api('/me');    
    $user_profile = $data['user_profile'];

} else{

    $user = NULL;

}       

if($user){
// Get logout URL
$data['logoutUrl'] = $this->facebook->getLogoutUrl(array(
    'next'  => 'http://devlocalhost.com/', // URL to which to redirect the user after logging out
    ));
}else{
// Get login URL
    $data['loginUrl'] = $this->facebook->getLoginUrl(array(
    'scope'     => 'email', // Permissions to request from the user
    'redirect_uri'  => 'http://devlocalhost.com/fb25/good', // URL to redirect the user to once the login/authorization process is complete.
    ));
}

if($user){

// Save your method calls into an array
$data['queries'] = array(
    array('method' => 'GET', 'relative_url' => '/'.$user),
    array('method' => 'GET', 'relative_url' => '/'.$user.'/home?limit=50'),
    array('method' => 'GET', 'relative_url' => '/'.$user.'/friends'),
    array('method' => 'GET', 'relative_url' => '/'.$user.'/photos?limit=6'),
    );

// POST your queries to the batch endpoint on the graph.
    $batchResponse = $facebook->api('?batch='.json_encode($queries), 'POST');

//Return values are indexed in order of the original array, content is in ['body'] as a JSON
//string. Decode for use as a PHP array.
$data['user_info']      = json_decode($batchResponse[0]['body'], TRUE);
$data['feed']           = json_decode($batchResponse[1]['body'], TRUE);
$data['friends_list']   = json_decode($batchResponse[2]['body'], TRUE);
$data['photos']         = json_decode($batchResponse[3]['body'], TRUE);

    }
    echo 'user_info: '.$data['user_info'];
    print_r($data);

    $this->load->view('fb25_view', $data);
}

public function good(){

$app_id     = "MY APP ID";
    $app_secret = "MY SECRET KEY";
    $site_url   = "http://devlocalhost.com/";

echo '<br/><br/>SESJA:<br/>';
print_r($_SESSION);
echo '<br/><br/>GET:<br/>';
print_r($_GET);
echo '<br/><br/>REQUEST:<br/>';
print_r($_REQUEST);
    echo '<br/><br/>najs<br/><br/>';

   session_start();

  $code = $_GET["code"];

  //@@@@@@IMO PROBLEM IS SOMEWHERE HERE: 

 $token_url = "https://graph.facebook.com/oauth/access_token?"
   . "client_id=" . $app_id . "&redirect_uri=" . urlencode($my_url)
   . "&client_secret=" . $app_secret . "&code=" . $code;

 $response = file_get_contents($token_url);

 $params = null;
 parse_str($response, $params);

 $graph_url = "https://graph.facebook.com/me?access_token=" 
   . $params['access_token'];

 $user = json_decode(file_get_contents($graph_url));
 echo("Hello " . $user->name);

}
}
?> 
```

我的问题是：我正在按下登录按钮并进入 facebook 以验证自己，单击“转到应用程序”并想返回我的网站 - 它说：

```
Message: file_get_contents(https://graph.facebook.com/oauth/access_token? client_id=487560264592073&redirect_uri=http%3A%2F%2Fdevlocalhost.com%2F&client_secret=mysecretcode&code=AQAgnmNWwDub9yaRB6Vf73gg8Xvwo8KhIM077lB67_bu1Z3rAvyk3Ckl54qK7hh9o3VkG0rFIBTfRXwtrSBFVWEpqYfm1o7e5CQg3jVctq-EE1ZxWrgWrfesLpQ2oF3wlmEMb5o6ORobGmibT06kqe5f2N0ch4kSYBJ4SiTcdV-612fGOJHGcipeyU_GJJ0Jvsg) 

[function.file-get-contents]: failed to open stream: HTTP request failed! HTTP/1.0 400 Bad Request 
```

**更新**

请看这里：

我在您的控制器中添加了功能：

```
public function link(){
$fb_usr = $this->fb_connect->user;
 $firstname = $fb_usr['first_name']; 

$my_url="http://devlocal.pl";
echo 'user_id';

 $token_url = "https://graph.facebook.com/oauth/access_token?"
   . "client_id=myclientid&redirect_uri=" . urlencode($my_url)
   . "&client_secret=mysecretcode&code=" . $_GET['code'];

    redirect($token_url); 
```

}

要获取我的访问令牌 - 没有访问令牌，我无法获取我的用户名。我将您的 loginbyfacebook 函数重定向到链接函数。而且它不显示 fb 用户名。

当我重定向到我的 token_url 它显示：

```
{
"error": {
  "message": "Error validating verification code.",
  "type": "OAuthException",
  "code": 100
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T03:37:35.337

按着这些次序：

```
1.Put the facebook php sdk in library folder
2.create facebook config with app detail
3.Inherit facebook class in fb_connect
4.add these function in controller then it will work like charm. 
```

fb_connect.php

```
<?php
include(APPPATH.'libraries/facebook/facebook.php');

class Fb_connect extends Facebook{

    //declare public variables
    public  $user       = NULL;
    public  $user_id    = FALSE; 
    public $fb          = FALSE;
    public $fbSession   = FALSE;
    public $appkey      = 0;

    //constructor method.
    public function __construct()
    {
               $CI = & get_instance();
                $CI->config->load("facebook",TRUE);
                $config = $CI->config->item('facebook');
                parent::__construct($config);                   
                $this->user_id = $this->getUser(); // New code

                $me = null;
                if ($this->user_id) {
                    try {
                        $me = $this->api('/me');
                        $this->user = $me;
                        } catch (FacebookApiException $e) {
                            error_log($e);
                        }
        }
    } 

} // end class 
```

控制器功能

```
function loginByFacebook(){
        $this->load->library('fb_connect');      
$param = array(
             'scope' =>'email,user_location,user_birthday,offline_access',
                'redirect_uri' => base_url()
            );
        redirect($this->fb_connect->getLoginUrl($param));

}

function facebook() {   

        if (!$this->fb_connect->user_id) {      

        } else {        
            $fb_uid = $this->fb_connect->user_id;
            $fb_usr = $this->fb_connect->user;  
            $firstname = $fb_usr['first_name'];
                    }
         } 
```

这样

```
$fb_usr = $this->fb_connect->user;
 $firstname = $fb_usr['first_name']; 
```

# android - Android - WebView 加载后隐藏 TitleBar

> ID：11346290
> 
> 赞同：0
> 
> 时间：2012-07-05T14:21:37.180
> 
> 标签：android, webview, titlebar

我目前在我正在开发的应用程序中有一个 WebView，在 WebView 中加载每个页面后，我想隐藏 TitleBar。我已经看过这个[问题](https://stackoverflow.com/questions/3092291/android-the-progress-bar-in-the-windows-title-does-not-display)，[答案](https://stackoverflow.com/q/3092291/1024787)看起来应该完全符合我的要求，但是在页面完成加载后 TitleBar 永远不会隐藏。

我使用的代码与我链接到的答案相同，但我也将其包含在下面。我可以确认 onProgressChanged 正在被调用，并且当页面完成加载时进度确实被报告为 100，但是 setProgressBarIndeterminateVisibility(false) 和 setProgressBarVisibility(false) 似乎什么都不做。在发送内容之前，我正在使用 requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS) 和 requestWindowFeature(Window.FEATURE_PROGRESS)。

我在 Android 2.3 和 4.1 上对此进行了测试，两者的结果都是一样的，TitleBar 没有隐藏。

```
mWebView.setWebChromeClient(new WebChromeClient() {
            @Override
            public void onProgressChanged(WebView view, int progress) {
                setProgress(progress * 100);
                if(progress == 100) {
                    setProgressBarIndeterminateVisibility(false);
                    setProgressBarVisibility(false);
                }
            }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:48:55.077

我创建了一个针对 android 2.3 的 android web 浏览器并遇到了同样的问题。解决方案是在您的主要活动中的某处添加这行代码。

this.requestWindowFeature(Window.FEATURE_NO_TITLE);

确保将此行放在 setContentView() 方法之前，否则您的应用程序将强制关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T16:22:59.727

旧的标题栏在功能上有所限制。您可能必须在活动布局中创建自己的标题栏，并使用`setVisibility()`.

如果您使用的是[`ActionBar`](http://developer.android.com/reference/android/app/ActionBar.html)而不是旧的标题栏（这是人们无论如何都应该做的），它具有您可以用来做您想做的事情的方法`show()`。`hide()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-24T01:43:24.870

public void onProgressChanged（WebView 视图，int 进度）{ if(progress<100 && pb.getVisibility()==pb.Invisible) { pb.setvisibility(pb.Visible) }

```
 pb.setProgress(progress);
if(progress==100)
{
      pb.setVisibility(ProgressBar.INVISIBLE);
} 
```

*其中 pb =(ProgressBar)findViewById(R.Id.progressbar); 它对我来说正常工作希望你让我的代码简单而甜蜜.....

# c# - 在条件下更改datagridview样式

> ID：11346299
> 
> 赞同：0
> 
> 时间：2012-07-05T14:22:09.830
> 
> 标签：c#, class, if-statement, datagridview, eval

这是我在一个 ASPX 页面中的代码：

```
 <asp:GridView 
            ID="GridView1" 
            runat="server"
            AutoGenerateColumns="False"
            HorizontalAlign="Center"
            ShowHeader="False"
            DataSourceID="sqlTEST1">
            <Columns>
               <asp:BoundField DataField="stale" Visible="false" />
               <asp:BoundField DataField="bad" Visible="false" />
               <asp:BoundField DataField="ping" Visible="false" />
               <asp:BoundField DataField="max_tags" Visible="false" />
               <asp:BoundField DataField="aval_chck" Visible="false" />
               <asp:TemplateField>
                    <ItemTemplate>

                        <% 
                        if (Eval("aval_chck").ToString()=="1")
                        {
                            <table border="0" cellpadding="2" cellspacing="1">
                            <tr>
                                <td class="rowsBLACKMAINOFF" colspan="3"><a href="#"><asp:Label ID="Label2" runat="server" Text='<%# Bind("instalacja") %>'></asp:Label></a></td>
                            </tr>
                            <tr>
                                <td class="rowsBLACKROWOFF"><asp:Label ID="Label2" runat="server" Text='<%# Bind("stale") %>'></asp:Label></td>
                                <td class="rowsBLACKROWOFF"><asp:Label ID="Label3" runat="server" Text='<%# Bind("bad") %>'></asp:Label></td>
                                <td class="rowsBLACKROWOFF"><asp:Label ID="Label4" runat="server" Text='<%# Bind("ping") %>'></asp:Label></td>
                            </tr>
                            </table>                            
                        }
                        else
                        {
                            <table border="0" cellpadding="2" cellspacing="1">
                            <tr>
                                <td class="rowsBLACKMAIN" colspan="3"><asp:Label ID="Label2" runat="server" Text='<%# Bind("instalacja") %>'></asp:Label></td>
                            </tr>
                            <tr>
                                <td class="rowsNORMALc">&nbsp;</td>
                                <td class="rowsNORMALc">&nbsp;</td>
                                <td class="rowsNORMALc">&nbsp;</td>
                            </tr>
                            </table>
                        }
                        %>

                    </ItemTemplate>
                </asp:TemplateField>
            </Columns>
        </asp:GridView> 
```

我知道这根本行不通。我只写了我想要达到的逻辑

我想让该声明发挥作用或做类似的事情。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:42:36.813

尝试 GridView.RowDataBound 事件

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx)

# magento - 如何为我的控制器功能提供自己的模板？

> ID：11346303
> 
> 赞同：0
> 
> 时间：2012-07-05T14:22:20.073
> 
> 标签：magento

我已经构建了一个具有这个基本控制器的小部件模块：

```
class MyModule_OrderForm_HandlersController extends Mage_Core_Controller_Front_Action{
  public function handleroneAction(){
    // do some stuff
  }
} 
```

因此，这给了我一个位于 mydomain.com/orderform/handlers/handlerone 的页面，这很棒，但是我如何为该函数提供自己的模板文件。

我已经在 Google 上搜索了几个小时，但没有找到直接的答案，我希望这里有人可以帮助我。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:26:08.310

如果您正在寻找如何创建小部件，我会查看[http://www.magentocommerce.com/knowledge-base/entry/tutorial-creating-a-magento-widget-part-1/](http://www.magentocommerce.com/knowledge-base/entry/tutorial-creating-a-magento-widget-part-1/)。

但是为了给你的控制器动作一个模板，我会从 inchoo 查看这篇文章：http: [//inchoo.net/ecommerce/magento/programatically-create-magento-blocks-and-inject-them-into-layout/](http://inchoo.net/ecommerce/magento/programatically-create-magento-blocks-and-inject-them-into-layout/)

正如文章所说，正确的“magento 方式”是在模块中创建一个扩展的块文件，`Mage_Core_Block_template`然后使用布局更新将该块及其模板文件插入到页面中。

inchoo 文章中概述的方法允许您跳过创建自定义块和布局更新，并允许您将模板直接插入该操作的内容区域。

当您打电话时，`$this->loadLayout()`您将网站的主题应用于该操作。您插入的模板将包含您想要插入该页面的主要内容区域的所有内容。

第一个参数是您要插入的块的类型。在这个例子中，我们使用`Mage_Core_Block_Template`的是分配模板的基本块。的第二个参数`createBlock() function ('my_block_name_here')`可以是任意名称。第三个参数是赋予块的属性数组。在此示例中，我们分配的唯一属性是“模板”。这就是我们告诉块使用哪个模板的方式。

# android - Android 对话框旋转

> ID：11346307
> 
> 赞同：1
> 
> 时间：2012-07-05T14:22:25.073
> 
> 标签：android, animation, dialog, pivot, rotateanimation

我为对话框创建了自定义输入动画：

```
<?xml version="1.0" encoding="utf-8"?>
<rotate xmlns:android="http://schemas.android.com/apk/res/android"
    android:fromDegrees="0"
    android:toDegrees="360"
    android:pivotX="50%"
    android:pivotY="50%"
    android:duration="5000" /> 
```

对话框应该围绕它的中心旋转......但它没有。它围绕其他点旋转。这里有什么问题？

--- 编辑：附加更多代码 ---

对话框创建：

```
Dialog dialog = new Dialog(SampleActivity.this, R.style.DialogStyle);
dialog.setContentView(R.layout.test_layout);
dialog.show(); 
```

样式.xml：

```
<style name="DialogStyle" parent="android:Theme.Dialog">
  <item name="android:windowAnimationStyle">@style/DialogAnimation</item>
</style>

<style name="DialogAnimation">
  <item name="android:windowEnterAnimation">@anim/dialog_enter</item>
</style> 
```

test_layout.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="270dip"
    android:layout_height="wrap_content">
        <TextView android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Random text\nRandom text\nRandom text" />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:32:41.210

这是在黑暗中刺伤，但我认为正在发生的是动画代码看到开始和结束位置是相同的，因此实际上并没有旋转（但从未这样做过，我不确定） .

`android:toDegrees`您可以通过更改来测试这个假设，`"180"`看看它是否有效。如果是这样，你可以做两个 180 翻转，一个接一个。

除此之外，我们可能需要查看更多代码才能理解问题。

# php - PHP中短代码的正则表达式模式

> ID：11346313
> 
> 赞同：5
> 
> 时间：2012-07-05T14:22:37.840
> 
> 标签：php, regex, shortcode

我为匹配 PHP 中的短代码而编写的正则表达式有问题。

这是模式，`$shortcode`短代码的名称在哪里：

```
\[$shortcode(.+?)?\](?:(.+?)?\[\/$shortcode\])? 
```

现在，这个正则表达式在这些格式下表现得非常好：

*   `[shortcode]`
*   `[shortcode=value]`
*   `[shortcode key=value]`
*   `[shortcode=value]Text[/shortcode]`
*   `[shortcode key1=value1 key2=value2]Text[shortcode]`

但似乎最常见的格式有问题，

*   `[shortcode]Text[/shortcode]`

它返回匹配以下内容：

```
Array
(
    [0] => [shortcode]Text[/shortcode]
    [1] => ]Text[/shortcode
) 
```

如您所见，第二个匹配项（应该是文本，因为第一个是可选的）包括开始标记的结尾和除最后一个括号之外的所有结束标记。

**编辑：**发现返回的匹配是*第一个捕获*，而不是第二个。[请参阅 Regexr 中的正则表达式。](http://regexr.com?31euk)

你能帮忙吗？我真的在这个问题上崩溃了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-05T14:32:30.730

在您的正则表达式中：

```
\[$shortcode(.+?)?\](?:(.+?)?\[\/$shortcode\])? 
```

第一个捕获组`(.+?)`至少匹配 1 个字符。

整个组是可选的，但在这种情况下，它恰好匹配到最后一个`]`。

以下正则表达式有效：

```
\[$shortcode(.*?)?\](?:(.+?)?\[\/$shortcode\])? 
```

`*`量词表示0或多个，而表示`+`一个或多个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-10-15T13:34:27.770

当然这是来自 C#，但是

```
@"\[([\w-_]+)([^\]]*)?\](?:(.+?)?\[\/\1\])?" 
```

应该匹配任何（？）可能自动关闭的短代码。

或者您可以从 wordpress 中窃取：[https ://core.trac.wordpress.org/browser/tags/4.0/src/wp-includes/shortcodes.php#L309](https://core.trac.wordpress.org/browser/tags/4.0/src/wp-includes/shortcodes.php#L309)

```
$pattern = '/(\w+)\s*=\s*"([^"]*)"(?:\s|$)|(\w+)\s*=\s*\'([^\']*)\'(?:\s|$)|(\w+)\s*=\s*([^\s\'"]+)(?:\s|$)|"([^"]*)"(?:\s|$)|(\S+)(?:\s|$)/';
$text = preg_replace("/[\x{00a0}\x{200b}]+/u", " ", $text);
if ( preg_match_all($pattern, $text, $match, PREG_SET_ORDER) )... 
```

# c# - 设置变量后如何防止变量更新？

> ID：11346315
> 
> 赞同：1
> 
> 时间：2012-07-05T14:22:40.110
> 
> 标签：c#, list

我有一种交换列表中 2 个项目的方法。问题是在我更改 itemA 的值后，“temp”变量会更新。初始化后如何防止“临时”更新？

```
void SwapItems(Item itemA, Item itemB)
{
    Item temp = itemA;

    itemA.OriginItemPosition = itemB.OriginItemPosition;
    itemA.OriginItemRectangle = itemB.OriginItemRectangle;

    itemB.OriginItemPosition = temp.OriginItemPosition;
    itemB.OriginItemRectangle = temp.OriginItemRectangle;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:25:24.867

那是因为 temp1 保存 itemA 的引用，而不是复制的值。要在您的情况下交换项目，我会这样做：

```
void SwapItems(Item itemA, Item itemB)
{
    var temp1 = itemA.OriginItemPosition;
    var temp2 = itemA.OriginItemRectangle;

    itemA.OriginItemPosition = itemB.OriginItemPosition;
    itemA.OriginItemRectangle = itemB.OriginItemRectangle;

    itemB.OriginItemPosition = temp1;
    itemB.OriginItemRectangle = temp2;
} 
```

你也可以有这样的东西，有些人可能会觉得更好：

```
// Swaps the references themselves for reference-types.
void Swap<T>(ref T a, ref T b)
{
    var tmp = a;
    a = b;
    b = tmp;
}

// Swaps the properties between two Item objects.
void SwapItems(Item a, Item b)
{
    Swap(ref a.OriginalItemPosition, ref b.OriginalItemPosition);
    Swap(ref a.OriginalItemRectangle, ref b.OriginalItemRectangle);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:29:10.457

如果您尝试交换 a 中的两个项目`List`，请不要通过交换项目上的属性值来做到这一点（除非您有充分的理由）。通过交换列表中的项目来做到这一点。这样，如果您例如向您的项目添加更多属性，则无需修改交换方法即可将它们全部复制。

```
static void Swap<T>(IList<T> list, int indexA, int indexB)
{
    int tmp = list[indexA];
    list[indexA] = list[indexB];
    list[indexB] = tmp;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:29:36.713

你也可以在 Item 上实现[ICLoneable](http://msdn.microsoft.com/en-us/library/system.icloneable.aspx)然后

```
Item temp = itemA.Clone(); 
```

# .net - 使用正则表达式从 SQL 中提取模式名称和对象名称

> ID：11346320
> 
> 赞同：1
> 
> 时间：2012-07-05T14:22:52.247
> 
> 标签：.net, sql-server, regex, vb.net, tsql

我有数千个 *.sql 文件，它们都包含不同格式的 T-SQL 文本，我想匹配这些文件中的所有模式名称和对象名称。

我已经分离了以下可能的模式名称 + 对象名称格式

*   dbo.[MainPart.SubPartA.SubPartB.SubPartC]
*   [dbo].[MainPart.SubPartA.SubPartB.SubPartC]
*   specialschema.[MainPart.SubPartA.SubPartB.SubPartC]
*   specialschema.MainPart
*   [MainPart.SubPartA.SubPartB.SubPartC]

我已经创建了一个正则表达式来匹配前四种情况

```
 (\[{0,1}(?<schema>\b\w*?\b){0,1}\]{0,1}\.){0,1}\[{0,1}(?<object>(\w|\.)+)\]{0,1} 
```

它将为每场比赛创建两组“模式”和“对象”。

问题是最后一种情况表明 schema=" **MainPart** " 和 object=" **SubPartA.SubPartB.SubPartC** "

此时我正在考虑将正则表达式分成几个部分以使其更简单（并且更具可读性），因为我已经有了匹配项，只有组不正确。

或者是否有另一种正则表达式技术可以为所有五个案例获取正确的组（并且仍然保持甚至提高可读性）？

SQL 文件的示例：

```
/******************************************************************
 Comment block
******************************************************************/ 

CREATE PROCEDURE [MainPart.SubPartA.SubPartB.SubPartC]
    @Param  INT = NULL
AS
BEGIN

    SET NOCOUNT ON

    SELECT * FROM dbo.[Table] WHERE fldParam = @Param

    SET NOCOUNT OFF

END
GO 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:25:47.020

为什么不只是：

```
SELECT [schema] = OBJECT_SCHEMA_NAME(OBJECT_ID('dbo.[whatever.bob]')),
       [object] = OBJECT_NAME(OBJECT_ID('dbo.[whatever.bob]')); 
```

或者如果对象还不存在：

```
SELECT [schema] = PARSENAME('dbo.[whatever.bob]', 2),
       [object] = PARSENAME('dbo.[whatever.bob]', 1); 
```

如果缺少架构部分，您将需要使用合并：

```
SELECT [schema] = COALESCE(PARSENAME('[whatever.bob]', 2), 'dbo'),
       [object] = PARSENAME('[whatever.bob]', 1); 
```

你有没有这种情况发生？似乎在您在问题中显示的 5 个值上工作正常。

# jquery - 脚本在 Internet Explorer 中不起作用

> ID：11346322
> 
> 赞同：-1
> 
> 时间：2012-07-05T14:22:54.183
> 
> 标签：jquery, html, css, internet-explorer-8

该脚本适用于 chrome 和 firefox，但不适用于 Internet Explorer。有人可以帮忙吗？

```
<script type="text/javascript" language="javascript">
$(document).scroll(function(e) {
    if($(this).scrollTop() > 170 && $(window).scrollTop() + $(window).height() != $(document).height()) {
        $("#testimonial_list").css({"position" : "fixed", "top" : "10px"});
    } else {
        $("#testimonial_list").css({"position" : "absolute", "top" : "210px"});
    }
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:15:20.527

小点可能会有所帮助，但不要在脚本声明中包含 language="javascript" 。

如果您使用的是 html5，则不再需要它以及 type 属性，但如果您使用的是 xhtml trans 或 strict ，请使用更基本的版本。

```
<script type="text/javascript">

</script> 
```

IE也有顶部问题，我过去在制作facebook页面时使用过这个，你需要定位顶部框架，而不仅仅是html所在的iframe。这个页面可能会帮助你。

[http://help.dottoro.com/ljnvjiow.php](http://help.dottoro.com/ljnvjiow.php)

干杯，斯特凡

# c++ - 将右值引用传递给 boost::in_place 函数

> ID：11346323
> 
> 赞同：5
> 
> 时间：2012-07-05T14:22:56.447
> 
> 标签：c++, boost, c++11, rvalue-reference

我是 C++ 中右值引用的新手，想学习如何在日常生活中使用它们。我有两个关于流行用例的相关问题：使用带有 boost::in_place 和 boost::bind 的右值引用。

1.  在 boost::in_place 中使用右值 ref

考虑一个类，构造函数将右值引用作为参数：

```
struct A
    : boost::noncopyable 
{
    A(int&&){}
}; 
```

现在让我们尝试为这个类创建 boost 可选变量：

```
void foo(int&& value)
{
    boost::optional<A> opt;
    // some code here 
    opt = boost::in_place(std::forward<int>(value)); //Error!
} 
```

在这样的示例中，传递右值 ref 的正确方法是什么。对于右值引用，有没有像 boost::reference_wrapper 这样的解决方案？

1.  将绑定函子传递给具有右值引用的函数对象

另一个常见的用例是将 boost::bind 函子对象分配给 boost::function 对象。

```
void foo(int&&)
{
}

void bar()
{
    boost::function<void(int&&)> func;

    int x = 0;
    func = boost::bind(foo, std::move(x)); // Compilation error (a)

    func = boost::bind(foo, _1); // Compilation error too (b)
} 
```

我知道指令 (a) 在第一次调用后可能会导致未定义的变量值，但指令 (b) 甚至没有这样的问题。但是如何正确编写这段代码呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T18:39:36.173

boost in_places 本身不支持移动或右值引用。但是，您可以创建一个继承自 boost::in_place_factory_base 的新类，并自己创建。或者，您可以使用支持 emplace 功能的可选项（例如 folly::Optional）。

我不确定我是否建议这样做，但是您可以在 boost 中进行通用重载来处理它，如下所示：

```
#include <boost/optional.hpp>      
#include <boost/utility/in_place_factory.hpp>
#include <folly/ApplyTuple.h>

namespace boost                                                                      
{                                                                                  
  template<class ... As> 
  struct rvalue_in_place : public in_place_factory_base 
  {
    mutable std::tuple<As...> tup_; 
    rvalue_in_place(As ... as)
      : tup_(std::forward<As>(as)...)
   {
   }                                                                                   
   template< class T >
   void apply ( void* address ) const 
   {
     auto make = [address](As ... as) { new (address) T(std::forward<As>(as)...);  }; 
     folly::applyTuple(make, tup_); 
   }
 };   
 template <class ... As> 
 rvalue_in_place<As&&...> in_place(As && ... a)
 {
   return rvalue_in_place<As&&...>(std::forward<As>(a)...);
 }
} 
```

# javascript - 强制 javascript 运行 *before* 浏览器重绘（jsFiddle 示例）

> ID：11346327
> 
> 赞同：7
> 
> 时间：2012-07-05T14:23:02.907
> 
> 标签：javascript, jquery, html, css, html-table

我正在使用 HTML 表格构建一个基于 Web 的小应用程序。该表的一个不寻常的特性是它具有固定的顶行和左列（类似于 excel）。我使用一点 jQuery 和 CSS 完成了这项工作。

问题是，触发我的代码的 jQuery 事件是 $(window).scroll 事件，显然大多数浏览器（Chrome 和 IE）在此事件调用的代码完成运行之前重绘页面。结果，左列和顶行需要一瞬间才能“赶上”表格的其余部分。

为了向您展示我的问题，我提供了一个[精简的 jsFiddle 示例。](http://jsfiddle.net/aHKU5/55/)**注意：**当表格很小并且（相对而言）没有内容时，滞后不是很明显。尽管如此，它仍然存在（假设您没有使用 Firefox）。有什么办法可以摆脱这种滞后？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-11T23:34:59.357

我没有让它与滚动事件或 requestAnimationFrame 一起工作。我最终做的是附加到鼠标滚轮事件，该事件在滚动和渲染发生之前触发。如果滚动事件向下，我可以及时应用适当的类进行渲染。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:40:22.157

只是一个想法，但也许值得考虑：您可以尝试`requestAnimationFrame`按照[本文所述](http://www.html5rocks.com/en/tutorials/speed/animations/)（或以类似方式）使用。这可能会解决更新/“滞后”问题。

# joomla - 在相关产品中显示定价和添加到购物车按钮 Virtuemart 2.0

> ID：11346328
> 
> 赞同：1
> 
> 时间：2012-07-05T14:23:03.300
> 
> 标签：joomla, virtuemart

我想显示相关产品的定价，并与每个相关产品一起添加到购物车按钮。

以下是相关产品页面的代码片段。$field 没有任何可用的定价。如何显示定价和“添加到购物车”按钮？提前致谢

```
<?php
    foreach ($this->product->customfieldsRelatedProducts as $field) {
    ?><div class="product-field product-field-type-<?php echo $field->field_type ?>">
            <span class="product-field-display"><?php echo $field->display ?></span>
            <span class="product-field-desc"><?php echo jText::_($field->custom_field_desc) ?></span>

        </div>
    <?php } ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-28T11:32:35.763

我在这里找到了解决方案，它对我有用： [无需编辑核心文件](http://forum.virtuemart.net/index.php?topic=106732.0)

它需要将“default_relatedproducts.php”、“default_showprices.php”和“default_addtocart.php”复制到“template/html/com_virtuemart/productdetails”文件夹中。然后将“default_relatedproducts.php”中的所有代码替换为以下代码：

```
<?php

// Check to ensure this file is included in Joomla!
defined ( '_JEXEC' ) or die ( 'Restricted access' );
$model = new VirtueMartModelProduct();
$calculator = calculationHelper::getInstance();
$currency = CurrencyDisplay::getInstance();
?>

 <div class="product-related-products">
<h4><?php echo JText::_('COM_VIRTUEMART_RELATED_PRODUCTS'); ?></h4>
<div>
    <?php
    foreach ($this->product->customfieldsRelatedProducts as $field) {
    ?>

<div class="product-field">

<?php
$product = $model->getProductSingle($field->custom_value,true); 
?>

<h2><?php echo JHTML::link ($product->link, $product->product_name); ?></h2>

<a title="<?php echo $product->product_name ?>" rel="vm-additional-images" href="<?php echo $product->link; ?>">
<?php
    echo $this->product->images[0]->displayMediaThumb('class="browseProductImage"', false);
?>
 </a>

<div class="short_desc"><?php echo $product->product_s_desc; ?></div>

<?php include 'default_showprices.php'; ?>

<?php include 'default_addtocart.php'; ?>
</div>

    <?php } ?>
    </div>
    </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:57:27.747

有同样的问题。但我必须只显示价格。所以最快的方法是在customfields.php中**更改sql select语句**

Joomla 2.5 中 Virtuemart 2.0 管理员/components/com_virtuemart/models/customfields.php 第 548 行的路径

```
public function getProductCustomsFieldRelatedProducts($product) 
```

只改变

```
$query= 
```

和

```
'SELECT C.`virtuemart_custom_id` , `custom_parent_id` , `admin_only` , `custom_title` , `custom_tip` , C.`custom_value` 
AS value, `custom_field_desc` , `field_type` , `is_list` , `is_hidden` , C.`published` , field.`virtuemart_customfield_id` , 
    field.`custom_value`, field.`custom_param`, price.`product_price`, field.`ordering`
        FROM `#__virtuemart_customs` AS C
        LEFT JOIN `#__virtuemart_product_customfields` AS field ON C.`virtuemart_custom_id` = field.`virtuemart_custom_id`
        LEFT JOIN `#__virtuemart_product_prices` AS price ON 
    field.`custom_value` = price.`virtuemart_product_id`
        Where field.`virtuemart_product_id` ='.(int)$product->virtuemart_product_id.' and `field_type` = "R"'; 
```

毕竟在 559 行更改

```
$field->custom_price 
```

至

```
$field->product_price 
```

最后......在产品描述的模板视图中插入下面的代码以显示相关产品的价格

```
<?php echo $field->product_price ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-29T15:47:50.207

以下解决方案的唯一问题是它没有为相关产品显示正确的图像。它使用主要产品图像并重复它。

# android - libgdx 游戏无法在安卓手机上运行

> ID：11346331
> 
> 赞同：1
> 
> 时间：2012-07-05T14:23:19.337
> 
> 标签：android, libgdx

我正在尝试从这个基于 libgdx 的游戏构建 android 游戏，但是当移植到 android 游戏时，android 应用程序崩溃了我从[http://rengelbert.com/blog/downloads/froggerLibGDXSource.zip下载的 libgdx 代码](http://rengelbert.com/blog/downloads/froggerLibGDXSource.zip)

我已经为这个游戏构建了安卓代码，你可以从这里下载它[https://rapidshare.com/files/3456268683/FroggerLibGDXAndroid.zip](https://rapidshare.com/files/3456268683/FroggerLibGDXAndroid.zip)

游戏崩溃并且无法启动请帮助我将游戏移植到android

这是我收到的错误消息

```
/AndroidRuntime( 2966): >>>>>>>>>>>>>> AndroidRuntime START <<<<<<<<<<<<<<
/AndroidRuntime( 2966): CheckJNI is ON
/AndroidRuntime( 2966): --- registering native functions ---
/ActivityManager(   65): Starting activity: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER
/AndroidRuntime( 2966): Shutting down VM
/dalvikvm( 2966): Debugger has detached; object registry had 1 entries
/AndroidRuntime( 2966): NOTE: attach of thread 'Binder Thread #3' failed
/ActivityManager(   65): Start proc com.libgdx.screen for activity com.libgdx.screen/.LibgdxScreenAndroidActivity: pid=29
/dalvikvm( 2973): Trying to load lib /data/data/com.libgdx.screen/lib/libgdx.so 0x43e37a00
/dalvikvm( 2973): Added shared lib /data/data/com.libgdx.screen/lib/libgdx.so 0x43e37a00
/dalvikvm( 2973): No JNI_OnLoad found in /data/data/com.libgdx.screen/lib/libgdx.so 0x43e37a00, skipping init
/dalvikvm(  303): GC_EXPLICIT freed 1722 objects / 57656 bytes in 13322ms
/qemud   (   38): fdhandler_accept_event: accepting on fd 10
/qemud   (   38): created client 0x1073a8 listening on fd 15
/qemud   (   38): client_fd_receive: attempting registration for service 'sensors'
/qemud   (   38): client_fd_receive:    -> received channel id 17
/qemud   (   38): client_registration: registration succeeded for client 17
/qemud   (   38): fdhandler_event: disconnect on fd 15
/AndroidInput( 2973): sensor listener setup
/libEGL  ( 2973): egl.cfg not found, using default config
/QemuSensors(   65): data__poll: len=-1, errno=9: Bad file number
/QemuSensors(   65): data__poll: len=-1, errno=9: Bad file number
/libEGL  ( 2973): loaded /system/lib/egl/libGLES_android.so
/QemuSensors(   65): data__poll: len=-1, errno=9: Bad file number
/QemuSensors(   65): data__poll: len=-1, errno=9: Bad file number
/QemuSensors( 2973): data__poll: len=-1, errno=9: Bad file number
/ActivityManager(   65): Launch timeout has expired, giving up wake lock!
/QemuSensors(   65): data__poll: len=-1, errno=9: Bad file number
/QemuSensors(   65): data__poll: len=-1, errno=9: Bad file number
/AndroidGraphics( 2973): OGL renderer: Android PixelFlinger 1.3
/ActivityManager(   65): Displayed activity com.libgdx.screen/.LibgdxScreenAndroidActivity: 10258 ms (total 10258 ms)
/AndroidGraphics( 2973): OGL vendor: Android
/AndroidGraphics( 2973): OGL version: OpenGL ES-CM 1.0
/AndroidGraphics( 2973): OGL extensions: GL_OES_byte_coordinates GL_OES_fixed_point GL_OES_single_precision GL_OES_read_f
/AndroidGraphics( 2973): framebuffer: (5, 6, 5, 0)
/AndroidGraphics( 2973): depthbuffer: (16)
/AndroidGraphics( 2973): stencilbuffer: (0)
/AndroidGraphics( 2973): samples: (0)
/AndroidGraphics( 2973): coverage sampling: (false)
/QemuSensors(   65): data__poll: len=-1, errno=9: Bad file number
/QemuSensors(   65): data__poll: len=-1, errno=9: Bad file number
/ActivityManager(   65): Activity idle timeout for HistoryRecord{43f692f8 com.libgdx.screen/.LibgdxScreenAndroidActivity}
/dalvikvm( 2973): GC_EXTERNAL_ALLOC freed 1740 objects / 111376 bytes in 1622ms
/QemuSensors( 2973): data__poll: len=-1, errno=9: Bad file number
/AndroidGraphics( 2973): Managed meshes/app: { }
/AndroidGraphics( 2973): Managed textures/app: { }
/AndroidGraphics( 2973): Managed shaders/app: { }
/AndroidGraphics( 2973): Managed buffers/app: { }
/QemuSensors(   65): data__poll: len=-1, errno=9: Bad file number
/QemuSensors(   65): data__poll: len=-1, errno=9: Bad file number 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T16:24:04.703

请试试这个，看看它是否解决了崩溃：

转到 Android 项目的属性，确保正在导出罐子和桌面项目。检查 Java Build Path -> Order and Export 是否如下所示：

![在此处输入图像描述](../Images/2130954bbb0319f61b7896df1c789a2a.png)

如果您想使用与 4.1 不同的 Android 版本，那很好（我只是没有安装其他版本，所以我将其更改为 4.1）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T20:25:44.183

我遇到了同样的问题并找到了解决方案：

1）打开项目“FroggerLibGDXDesktop”的项目设置

2) 转到“Java 构建路径”/“订购和导出”

3）检查所有的jar文件

4）打开项目“FroggerLibGDXAndroid”的项目设置

5) 转到“Java 构建路径”/“订购和导出”

6）至少检查“gdx-backend-android.jar”和项目“FroggerLibGDXDesktop”

在模拟器中运行安卓应用。为我工作。

# c# - 在 C# 上编写 Notepad++ 插件。使用 char *text 等参数调用 SCintilla

> ID：11346340
> 
> 赞同：0
> 
> 时间：2012-07-05T14:23:35.680
> 
> 标签：c#, plugins, notepad++, scintilla

我正在 c# 上为 notepad++ 编写插件。我的插件创建一棵树来表示某些特定文本文件的结构。我在调用带有（char* 文本）等参数的函数时遇到了一些问题。你能帮mw解决这个问题吗？

例如

```
SCI_GETLINE(int line, char *text)
{
    string st="";
    Win32.SendMessage(curScintilla, SciMsg.SCI_GETLINE, (int)line, st);
} 
```

这种调用 raise 的方式是无效的字符串格式异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T20:34:45.480

用: 标记论点`[MarshalAs(UnmanagedType.LPStr)]`。问题是您正在传递某种字符串类型的 unicode 字符串，该字符串类型不是字节 C 样式的空终止字符串。

# c# - 这个对象铸造是好的做法吗？另外，有没有更好的方法？

> ID：11346341
> 
> 赞同：0
> 
> 时间：2012-07-05T14:23:38.207
> 
> 标签：c#, casting

我目前正在通过套接字连接接收序列化对象，这完美无缺。我也在反序列化它。现在，我希望客户端通过网络发送多个对象类型（或类）。

这就是我将我的对象反序列化到它的类型'MyClass'的方式：

```
var m = new MemoryStream(Convert.FromBase64String(dataReceived));
var b = new BinaryFormatter();
var o = (MyClass)b.Deserialize(m); 
```

现在，如果我想接收超过 1 个对象类型，我可以创建一个可以将其转换为任何支持的类型的方法，或者发送一个标头，告诉我对象的类型然后转换它。我更喜欢第*一种*方式。

问题是，我当然不能用 GetType() 来转换它，并且使用 name 属性会导致一些我不喜欢的字符串切换。所以我决定我可以这样做：

```
object objectReceived = b.Deserialize(m);

if(o is MyClass){

    MyClass myClass = (MyClass) objectReceived;

}
else if (o is AnotherClass){

    AnotherClass myOtherClass = (AnotherClass) objectReceived;

} 
```

（我也可以用 as 运算符做一些事情，但这会让我事后检查空值。例如）

```
var MyClass = objectReceived as MyClass; 
var AnotherClass = objectReceived as AnotherClass 
```

*或者*我可以实现一个接口，通过网络发送的每个对象都将实现该接口，将对象转换为该接口，该接口将返回它的类型，然后相应地转换它！

问题是，我已经有了那个工作代码，但是我想不出一个干净的方法来编码那个接口。接口的方法应该返回什么？一种？一个字符串？我真的不知道。这就是为什么我告诉自己：好吧，因为我有工作代码，如果它是好的实践并且易于维护，我不会让自己陷入制作界面的麻烦，因为时间限制我现在不知道该怎么做.

所以这就是我的问题：我的方法是否正确/良好的做法？还是界面方法更好？

非常感谢你们的帮助！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T14:29:05.813

为什么不使用泛型？

您可以创建一个通用的反序列化方法，如下所示：

```
private T MyDeserialize<T>(String dataReceived)
{
    var m = new MemoryStream(Convert.FromBase64String(dataReceived)); 
    var b = new BinaryFormatter(); 
    return (T)b.Deserialize(m); 
} 
```

任何然后将其称为：

```
MyClass myClassInstance = MyDeserialize<MyClass>(dataReceived); 
```

* * *

**泛型**

当你调用泛型时， `MyDeserialize<MyClass>(dataReceived);`你会让方法认为`T`是`MyClass`.

想象它这样做：

```
private MyClass MyDeserialize(String dataReceived)
{
    var m = new MemoryStream(Convert.FromBase64String(dataReceived)); 
    var b = new BinaryFormatter(); 
    return (MyClass)b.Deserialize(m); 
} 
```

显然，您可以在 's 之间传递您喜欢的任何类型（如果您愿意，可以使用类）`<>`，它将使用该类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:35:54.927

我认为，您的问题的根源可能是您试图用一种方法做太多事情。要么您的方法对所有不同类型的对象执行相同的操作（在这种情况下，它们都应该共享相同的接口，并且您应该将它们全部转换为该接口），或者，正如我怀疑的那样，您对每个对象都在做不同的事情他们，在这种情况下，将所有这些逻辑组合到一个方法甚至一个类中并不是一个好习惯。

所以，如果你有这样的方法：

```
private void processObject(MyClass obj) { //... }
private void processObject(AnotherClass obj) { //... } 
```

然后，在反序列化对象的方法中，您可以简单地从消息头中检查类名，然后调用正确的方法：

```
switch(className)
{
    case ClassNameEnum.MyClass: processObject((MyClass)b.Deserialize(m)); break;
    case ClassNameEnum.AnotherClass: processObject((AnotherClass)b.Deserialize(m)); break;
} 
```

正如我在此示例中所展示的，使用枚举比使用字符串指定消息头中的类型要好。它是更小的数据，更快的比较，并且不允许拼写错误。如果您确实想使用字符串以使消息更具可读性，那很好，但您应该为字符串使用常量。

使用通用方法反序列化对象是一个很好的建议，在这种情况下，切换代码如下所示：

```
switch(className)
{
    case ClassNameEnum.MyClass: processObject(Deserialize<MyClass>(m)); break;
    case ClassNameEnum.AnotherClass: processObject(Deserialize<AnotherClass>(m)); break;
} 
```

但是，这样做并不能真正缓解任何事情。`case`您仍然需要为每种类型添加单独的语句。如果你想保持强类型，没有灵丹妙药可以摆脱这种额外的编码。*转换的全部意义在于在编译时*通知编译器您正在使用哪种类型。如果有某种方法可以将其转换为在运行时确定的类型，那将是完全没有意义的。如果您不关心强类型的优点，您可以将其设为`dynamic`变量，在这种情况下，您可以使用任何类型而根本不进行强制转换（这需要 .NET 4）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:41:00.387

您将使用哪种铸件没有太大区别。之间的唯一区别：

```
x = (Type) deserialized; 
```

和

```
x = deserialized as Type; 
```

如果反序列化不是 Type，第一个将引发 InvalidCastException，而第二个将返回 null in `x`。正如@DaveShaw 解释的那样 - 使用泛型是一种非常好的方法，但如果没有更好的方法来做你想做的事，这取决于你的架构。

# php - chrome 和 firefox 显示的页码不同

> ID：11346344
> 
> 赞同：0
> 
> 时间：2012-07-05T14:23:45.103
> 
> 标签：php, javascript

我在下面有这行代码，它向用户说明他们当前在页面总数中的哪个页面：

```
<h1><?php echo $sessionMinus ?> OF <?php echo $_SESSION['initial_count'] ?></h1> 
```

上面的代码可以这样写：`1 OF 7`, `3 OF 5`,`5 OF 6`等等。

但是有一个问题，我目前在 google chrome 和 mozilla firefox 之间存在问题。下面我有一个指向应用程序的[链接](http://helios.hud.ac.uk/u0867587/Mobile_app/Text4.php)。您能否在 Firefox 和 chrome 中打开该应用程序并按照以下步骤操作，您将能够看到问题：

1.  打开我在 chrome 和 firefox 中提供的 URL

2.  请在两个页面上输入多个会话（输入 7），然后在两个浏览器上提交页面。

3.  您将在两个浏览器的顶部看到一个标题： `"CREATING QUESTIONS AND ANSWERS: SESSION 1 OF 7"`。

4.  在两个浏览器的页面上，单击“添加问题”按钮 3 次，以添加 3 行，每行包含一个图像文件输入。

5.  现在单击两个浏览器页面底部的“提交详细信息”按钮。

我想让你做的是现在看看标题是什么`"CREATING QUESTIONS AND ANSWERS: SESSION ... OF 7"`。现在说。在 Firefox 中，它完美地工作，因为你已经完成了第一页，所以你现在在第二页，这就是它声明的原因`"CREATING QUESTIONS AND ANSWERS: SESSION 2 OF 7"`。

但是在chrome中它不能很好地工作。相反，在 chrome 中它声明`"CREATING QUESTIONS AND ANSWERS: SESSION 5 OF 7"`. 这是因为 chrome 它为已添加的每一行添加一个数字（添加一行时，表单会上传到其自身页面）。因此，在提交第一页后，新页面会添加一个数字来制作它，`2 OF 7`但随后在第一页添加了 3 行使其`5 OF 7`成为 chrome，这是完全不正确的。

所以我的问题是为什么它在 chrome 中的工作方式与在 Firefox 中不同，有没有一种方法可以让 chrome 以与 Firefox 相同的方式工作，以便每次用户进入下一页时都显示正确的页码？

以下是完整代码：

```
<?php

    session_start();

    if(isset($_POST['sessionNum'])){
                //Declare my counter for the first time

                $_SESSION['initial_count'] = $_POST['sessionNum'];
                $_SESSION['sessionNum'] = intval($_POST['sessionNum']);
                $_SESSION['sessionCount'] = 1;

        }

    else if ($_SESSION['sessionCount'] < $_SESSION['sessionNum']) {
        $_SESSION['sessionCount']++;
    }

    $sessionMinus =  $_SESSION['sessionCount'];

    if ($sessionMinus == $_SESSION['initial_count']){ 

        $action = 'create_session2.php'; 

    }else if($sessionMinus != $_SESSION['initial_count']){ 

        $action = $_SERVER['PHP_SELF']; 

    }

    ?>

    <script type="text/javascript">

    function insertQuestion(form) {   

        var $tbody = $('#qandatbl > tbody'); 
        var $tr = $("<tr class='optionAndAnswer' align='center'>");
        var $image = $("<td class='image'></td>"); 

    var $fileImage = $("<form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target' onsubmit='return imageClickHandler(this);' class='imageuploadform' >" + 
        "<p class='imagef1_upload_process' align='center'>Loading...<br/><img src='Images/loader.gif' /><br/></p><p class='imagef1_upload_form' align='center'><br/><label>" + 
        "Image File: <input name='fileImage' type='file' class='fileImage' /></label><br/><br/><label class='imagelbl'>" + 
        "<input type='submit' name='submitImageBtn' class='sbtnimage' value='Upload' /></label>" + 
        "<iframe class='upload_target' name='upload_target' src='#' style='width:0;height:0;border:0px;solid;#fff;'></iframe></form>");     

        $image.append($fileImage);

        $tr.append($image);  
        $tbody.append($tr); 

    }

                 function showConfirm(){

             var confirmMsg=confirm("Make sure that your details are correct, once you proceed after this stage you would not be able to go back and change any details towards Questions, Options and Answers for your Session." + "\n" + "\n" + "Are you sure you want to Proceed?" + "\n" );

             if (confirmMsg==true)
             {
             submitform();   
         }
    }

             function submitform()
    {
        var fieldvalue = $("#QandA").val();
        $.post("insertQuestion.php", $("#QandA").serialize() ,function(data){
            var QandAO = document.getElementById("QandA");
            QandAO.submit();
        });  
        alert("Your Details for this Session has been submitted"); 
    }

    </script>

    </head>

    <body>

    <form id="QandA" action="<?php echo htmlentities($action); ?>" method="post">

    <h1>CREATING QUESTIONS AND ANSWERS: SESSION <?php echo $sessionMinus ?> OF <?php echo $_SESSION['initial_count'] ?></h1>

    <div id="detailsBlock">

    <table id="questionBtn" align="center">
    <tr>
    <th>
    <input id="addQuestionBtn" name="addQuestion" type="button" value="Add Question" onClick="insertQuestion(this.form)" />
    </th>
    </tr>
    </table>

    </div>
    <hr/>

    <div id="details">
    <table id="qandatbl" align="center">
    <thead>
    <tr>
        <th class="image">Image</th>
    </tr>
    </thead>
    <tbody>
    </tbody>
    </table>
    </div>

    <p><input id="submitBtn" name="submitDetails" type="submit" value="Submit Details" onClick="myClickHandler(); return false;" /></p>

    </form>

             <script type="text/javascript">

    function myClickHandler(){
         if(validation()){
                    showConfirm();
         }
    }

    </script>

    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:31:48.603

没有深入你的代码（你今天已经发布了这个，对吧？），但你的错误可能来自你使用`$_SESSION`变量来存储不应该存在的数据这一事实。

例如，如果您的用户同时打开两个选项卡并浏览页面，那将是一团糟。

为每个流程创建一个唯一标识符，将数据存储在您的数据库中，并在您的页面之间使用`$_GET`和`$_POST`传输此标识符（您*也可以*将此数据存储在您的会话中，但存储在由该标识符索引的数组中）。

哦，还有 iframe？避开他们！使用 jquery 插件来处理您的上传。

# php - 如何在 codeigniter 中制作自定义 error_php.php

> ID：11346346
> 
> 赞同：1
> 
> 时间：2012-07-05T14:23:57.917
> 
> 标签：php, codeigniter

> **可能重复：**
> [如何使用 Codeigniter 在自定义 404 页面中重定向 404 错误？](https://stackoverflow.com/questions/2310061/how-can-i-redirect-a-404-error-in-a-custom-404-page-using-codeigniter)

全部...我是点火器的新手...我正在尝试做的只是如何制作自定义错误页面。error_php.php 文件会导致显示文件中出现的所有错误。

我想创建一个有点像 error_404.php 文件的页面，当遇到任何 php 错误时会显示一个白页。Exception.php 中的 show_error 文件显示每个错误的错误消息。我只想要一个显示“技术问题”的页面总白页/。谁能帮帮我..我什至不知道如何进行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:36:18.577

编辑文件`application/config/routes.php`并修改`$config['404_override']`以包含您想要用于 404 页面的控制器和控制器功能。

使用以下内容创建一个控制器。

```
function Error extends CI_Controller 
{
    function index()
    {
        $this->load->view('404_page');
    }
} 
```

创建一个名为的新视图`404_page`，该视图现在包含您想要的自定义 404 内容！

# php - PHP - 使用一组值搜索一个关联数组，然后创建一个具有匹配结果的新数组

> ID：11346349
> 
> 赞同：0
> 
> 时间：2012-07-05T14:24:16.803
> 
> 标签：php, arrays, search, associative

我有一个关联数组如下：

```
{
  "organizations":[
    {
      "name":"10sheet",
      "owner_name":"Me"
    },
    {
      "name":"12Gigs",
      "owner_name":"Me"
    },
      "name":"24\/7 Card",
      "owner_name":"Me as well"
    },
} 
```

我想使用第一个数组中的名称字段与以下关联数组中的名称字段进行搜索：

```
[{"name": "Wetpaint",
  "permalink": "wetpaint",
  "category_code": "web"},
 {"name": "AdventNet",
  "permalink": "adventnet",
  "category_code": "enterprise"},
 {"name": "Zoho",
  "permalink": "zoho",
  "category_code": "software"},
 {"name": "Digg",
  "permalink": "digg",
  "category_code": "web"},
 {"name": "24/7 Card",
  "permalink": "247-card",
  "category_code": "other"}] 
```

如果有匹配项，则将永久链接字段中的值放入一个新数组中。此外，在第一个数组中存在转义问题，例如 24/7 而不是 24/7，并且搜索不应区分大小写。我正在尝试用 PHP 编写此代码，并且使用这两个 API 让我很生气。

谢谢你的帮助！

-格雷格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:29:35.363

未经测试，但应该可以工作：

```
<?php
$result = array();
foreach($obj["organizations"] as $o) {
    foreach($obj2 as $o2) {
        if(stristr($o["name"], $o2["name"])) {
            $result[] = $o2["permalink"];
        }
    }
}
?> 
```

$obj 是您的第一个数组， $obj2 第二个 .. $result 包含匹配项。

# c++ - PC 上的 C++ 和 Arduino 之间的 Sizeof() 区别

> ID：11346350
> 
> 赞同：1
> 
> 时间：2012-07-05T14:24:18.720
> 
> 标签：c++, struct, arduino, sizeof

> **可能重复：** [为什么结构的 sizeof 不等于每个成员的 sizeof 之和？](https://stackoverflow.com/questions/119123/why-isnt-sizeof-for-a-struct-equal-to-the-sum-of-sizeof-of-each-member)

在以下代码中， 的值`structSize`会有所不同，具体取决于它是在 Arduino 还是我的 PC（Ubuntu 11.04 x64）上执行。

```
struct testStruct{
    uint8_t val1;
    uint16_t val2;
};
...
uint_8_t structSize = sizeof(testStruct); 
```

在我的 PC 上，值为`structSize`4，而在我的 Arduino 上，值为`structSize`3（如预期的那样）。

这第 4 个字节来自哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:25:05.080

实际上，我预计大小为 4，因为`uint16_t`通常与 16 位对齐。

额外的字节是在成员之间插入的填充以保持`uint16_t`.

不过，这取决于编译器。Arduino 可能对记忆更加自私，并且可能不太关心对齐。（可能的解释）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:29:11.857

这是因为您所针对的两种 CPU 类型之间的 ABI 不同。似乎在 Arduino（[ARM](http://en.wikipedia.org/wiki/ARM_architecture) v7？）上与 x86_64 不同。

至少在 x86 上，`uint16_t`（短）通常与两字节边界对齐。为了实现这一点，在 之后插入一个填充字节`val1`。我希望在 x86_64 上也是如此。

[Wikipedia article on x86 structure padding](http://en.wikipedia.org/wiki/Data_structure_alignment#Typical_alignment_of_C_structs_on_x86)中有很多关于此的信息。

您可以使用该`#pragma pack`指令实现您想要的……但是这里是龙，不要告诉任何人我建议的 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:46:36.223

如果您正在设计一个在移动处理器上运行的数据库引擎然后继续，但是对于您正在编写的大多数其他内容，您的时间将更好地用于使用易于理解且跨架构相对标准的类型系统来构建功能。

# asp.net-mvc - 为什么我没有收到来自 Google OAuth 请求的 RefreshToken？

> ID：11346355
> 
> 赞同：7
> 
> 时间：2012-07-05T14:24:30.453
> 
> 标签：asp.net-mvc, oauth, oauth-2.0, dotnetopenauth

我正在尝试将 Google 日历集成到我的应用程序中，并且在传递 RefreshToken 的 OAuth 授权方面遇到了一些问题。我收到一个没有问题的 AccessToken，但 RefreshToken 属性为空。请参阅标有“此处错误：”的行以了解我遇到问题的位置

我的 Asp.Net MVC 控制器（名为`OAuthController`）如下所示：

```
 public ActionResult Index()
    {
        var client = CreateClient();
        client.RequestUserAuthorization(new[] { "https://www.googleapis.com/auth/calendar" }, new Uri("http://localhost/FL.Evaluation.Web/OAuth/CallBack"));

        return View();
    }

    public ActionResult CallBack()
    {

        if (string.IsNullOrEmpty(Request.QueryString["code"])) return null;

        var client = CreateClient();

        // Now getting a 400 Bad Request here
        var state = client.ProcessUserAuthorization();

        // ERROR HERE:  The RefreshToken is NULL
        HttpContext.Session["REFRESH_TOKEN"] = Convert.ToBase64String(Encoding.Unicode.GetBytes(state.RefreshToken));

        return JavaScript("Completed!");
    }

    private static WebServerClient CreateClient()
    {
        return
            new WebServerClient(
                new AuthorizationServerDescription()
                    {
                        TokenEndpoint = new Uri("https://accounts.google.com/o/oauth2/token"),
                        AuthorizationEndpoint = new Uri("https://accounts.google.com/o/oauth2/auth"),
                        ProtocolVersion = ProtocolVersion.V20
                    }
                , _GoogleClientId, _GoogleSecret);
    } 
```

我在 Google 的 API 文档中看到，我需要确保将`access_type`请求设置`offline`为发送 RefreshToken。如何在 Authenticator 请求中设置此值？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-06T11:57:46.317

经过数小时摆弄[DotNetOpenAuth](http://www.dotnetopenauth.net/)和为 .Net 发布的[Google API](http://code.google.com/p/google-api-dotnet-client/)之后，我一无所获。我决定绕过这些库，直接使用原生 HttpRequest 和 HttpResponse 对象访问[Google REST API 。](https://developers.google.com/accounts/docs/OAuth2WebServer)我的 MVC 控制器的净化代码如下：

```
 private static string _GoogleClientId = "CLIENT_ID";
    private static string _GoogleSecret = "SECRET";
    private static string _ReturnUrl = "http://localhost/OAuth/CallBack";

    public ActionResult Index()
    {
        return Redirect(GenerateGoogleOAuthUrl());
    }

    private string GenerateGoogleOAuthUrl()
    {

        //NOTE: Key piece here, from Andrew's reply -> access_type=offline forces a refresh token to be issued
        string Url = "https://accounts.google.com/o/oauth2/auth?scope={0}&redirect_uri={1}&response_type={2}&client_id={3}&state={4}&access_type=offline&approval_prompt=force";
        string scope = UrlEncodeForGoogle("https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/calendar.readonly").Replace("%20", "+");
        string redirect_uri_encode = UrlEncodeForGoogle(_ReturnUrl);
        string response_type = "code";
        string state = "";

        return string.Format(Url, scope, redirect_uri_encode, response_type, _GoogleClientId, state);

    }

    private static string UrlEncodeForGoogle(string url)
    {
        string UnReservedChars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_.~";
        var result = new StringBuilder();

        foreach (char symbol in url)
        {
            if (UnReservedChars.IndexOf(symbol) != -1)
            {
                result.Append(symbol);
            }
            else
            {
                result.Append('%' + String.Format("{0:X2}", (int)symbol));
            }
        }

        return result.ToString();
    }

    class GoogleTokenData
    {
        public string Access_Token { get; set; }
        public string Refresh_Token { get; set; }
        public string Expires_In { get; set; }
        public string Token_Type { get; set; }
    }

    public ActionResult CallBack(string code, bool? remove)
    {

        if (remove.HasValue && remove.Value)
        {
            Session["GoogleAPIToken"] = null;
            return HttpNotFound();
        }

        if (string.IsNullOrEmpty(code)) return Content("Missing code");

        string Url = "https://accounts.google.com/o/oauth2/token";
        string grant_type = "authorization_code";
        string redirect_uri_encode = UrlEncodeForGoogle(_ReturnUrl);
        string data = "code={0}&client_id={1}&client_secret={2}&redirect_uri={3}&grant_type={4}";

        HttpWebRequest request = HttpWebRequest.Create(Url) as HttpWebRequest;
        string result = null;
        request.Method = "POST";
        request.KeepAlive = true;
        request.ContentType = "application/x-www-form-urlencoded";
        string param = string.Format(data, code, _GoogleClientId, _GoogleSecret, redirect_uri_encode, grant_type);
        var bs = Encoding.UTF8.GetBytes(param);
        using (Stream reqStream = request.GetRequestStream())
        {
            reqStream.Write(bs, 0, bs.Length);
        }

        using (WebResponse response = request.GetResponse())
        {
            var sr = new StreamReader(response.GetResponseStream());
            result = sr.ReadToEnd();
            sr.Close();
        }

        var jsonSerializer = new JavaScriptSerializer();
        var tokenData = jsonSerializer.Deserialize<GoogleTokenData>(result);
        Session["GoogleAPIToken"] = tokenData.Access_Token;

        return JavaScript("Refresh Token: " + tokenData.Refresh_Token);

    } 
```

非常感谢[Kelp](http://kelp.phate.org/2012/04/google-calendar-api-with-oauth-20.html)提供了这段代码中的一些代码。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-05T15:59:29.003

调整`GoogleAuthenticationServer.Description`以具有包含`?access_type=offline`在查询字符串中的授权端点 URI。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-26T05:39:25.717

只需添加

```
AccessType = "offline", 
```

反对`GoogleOAuth2AuthenticationOptions()`。

# java - 空闲时 Eclipse 中的高 CPU 使用率

> ID：11346357
> 
> 赞同：48
> 
> 时间：2012-07-05T14:24:34.423
> 
> 标签：java, eclipse

在我的多核机器上，Eclipse 使用 100% 到 250% 的 CPU 功率，即使在新的普通安装和空工作区空闲时也是如此。在实际做事时，它变得缓慢且反应迟钝。

我已经尝试按照这里的建议设置内存设置：[Eclipse using 100 % CPU random](https://stackoverflow.com/questions/2681989/eclipse-uses-100-cpu-randomly)。那没有帮助。我还尝试了不同的 Java 版本，即 OpenJDK 和 Oracle Java 7，以及 Eclipse 版本的 Juno 和 Indigo。我在 Ubuntu 12.04 LTS 上。

作为另一个可能不相关的问题，当我关闭 Eclipse 时，Java 进程仍然保持打开状态，CPU 使用率超过 200%，需要手动终止。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-08T06:05:07.140

我今天也遇到了同样的问题，原来是索引线程占用了CPU。我最近在一个项目中添加了相当多的文件并且忘记了它。我意识到其他人不太可能有这个问题，但发布我如何调查它可能会很有用。

我正在使用基于 eclipse Juno 的 STS 运行 Ubuntu 12.10。

1.  从命令行启动 eclipse 并将输出重定向到一个文件，这样我们就可以得到一个线程转储
2.  让它适应一下，然后获取每个线程的 cpu 使用列表： ps -mo 'pid lwp stime time pcpu' -C java. 这是识别我的 CPU 饥饿线程的输出示例：

    PID LWP STIME 时间 %CPU

    6974 - 07:42 00:15:51 133

    7067 07:42 00:09:49 **86.1**

3.  将线程 id（在我的情况下为 7067）转换为十六进制 0x1b9b（例如在命令行中使用：printf "0x%x\n" 7067）

4.  使用 kill -3 执行 java 进程的线程转储：kill -3 6974。输出保存在启动 eclipse 时重定向 stdout 的文件中

5.  打开文件并查找线程的十六进制 id：

    “链接索引器延迟写入 10”prio=10 tid=0x00007f66b801a800 nid= **0x1b9b**可运行 [0x00007f66a9e46000]

    java.lang.Thread.State：可运行

    在 com.ibm.etools.references.internal.bplustree.db.ExtentManager$WriteBack.r

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-05T19:38:05.953

我只在垃圾收集器发疯时才看到这种行为，因为分配的内存确实达到了 VM 配置的最大内存限制。如果您有一个大型 Eclipse 安装，您的第一步应该始终是[增加 eclipse.ini 中的内存设置](http://wiki.eclipse.org/FAQ_How_do_I_increase_the_heap_size_available_to_Eclipse?)。

请同时激活*Window -> Preferences -> General -> Show heap status*。它将显示 Eclipse 当前使用了多少内存（在状态行中）。如果达到允许的最大值并且不再下降（即垃圾收集器无法清理未使用的对象），那么这正是我上面描述的指示。

编辑：了解您使用的 Eclipse 包也很好，因为它们默认包含不同的插件。经典、建模、Java EE 开发人员，...？

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-07-05T14:29:08.970

我在插件方面遇到过这个问题，但 Eclipse 本身从来没有。

您可以尝试`Help > About Eclipse > Installation details`通过逐个禁用插件来调试它。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-02-08T10:14:51.713

卸载 mylyn 插件为我解决了这个问题，性能提升如此之大，以至于我将其发布为一个 6 年前的问题的答案。

转到`Help->About Eclipse->Installation Details->Installed Software` 并卸载您**知道**自己未使用的所有插件。我只卸载了 mylyn 插件，它为我创造了奇迹。

**编辑：**

在 Eclipse 版本：2018-09 (4.9.0) 中，可以通过**关闭包和项目资源**管理器来解决 Eclipse 冻结/无响应问题。

我知道这可能听起来像是一个愚蠢的解决方案，但我已经在大约 5 台对等机器上多次测试过，相信我说这个简单的解决方案消除了每台机器的冻结问题。只要包/项目资源管理器没有重新打开，他们都没有抱怨 Eclipse 反应迟钝。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-03T20:10:34.653

Java多线程垃圾收集器就是垃圾。在 java 命令行中添加 -XX:-UseLoopPredicate 选项。参见错误[https://bugzilla.redhat.com/show_bug.cgi?id=882968](https://bugzilla.redhat.com/show_bug.cgi?id=882968)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-08T06:27:31.237

面临同样的问题，在eclipse中通过了VM Argument，它对我来说效果很好。

-Xmx1300m -XX:PermSize=256m -XX:MaxPermSize=256m

# javascript - 如何绑定到模糊和更改，但只在 Jquery/Javascript 中触发一次函数？

> ID：11346359
> 
> 赞同：17
> 
> 时间：2012-07-05T14:24:37.810
> 
> 标签：javascript, jquery, events, jquery-mobile

我正在尝试在更改选择元素时触发函数。

由于 Ipad 在 on('change') 上遇到问题，我还想绑定到 'blur'，这在 Ipad 上运行良好。

但是我不希望这两个事件都触发该函数两次，所以我需要某种钩子来确保如果*更改*和*模糊*都触发，则底层函数只触发一次。

这就是我现在正在做的事情，但是......不是很好：

```
// make sure binding is only assigned once
var compSel = $('#my_select');
if ( compSel.jqmData('bound') != true ){
    console.log("bound");
    compSel.jqmData('bound', true)
        .on( $.support.touch ? 'blur' : 'change', function(){
            console.log("trigger");
            // run function xyz
        })
    } 
```

*如果您可以使用所有使用blur*的可触摸设备，则此方法有效。

**问题：**
有没有人有更好的主意来确保模糊和更改只触发一次功能？

感谢帮助！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-05T14:43:08.503

尝试创建一个函数，绑定到这两个事件，并添加一个超时来调用该函数。这样，如果函数被多次调用，它只会运行一次。

像这样（如果需要，您可以调整超时）：

```
function blurChange(e){
    clearTimeout(blurChange.timeout);
    blurChange.timeout = setTimeout(function(){
        // Your event code goes here.
    }, 100);
}

$('#my_select').on('blur change',blurChange); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T14:30:13.800

不知道 ipad，但在浏览器上可能是这样的

```
$("#dataTable tbody").on("click blur", "tr", function(event){
        if (event.type == "click")
        { 
        //do stuff
        }
        else
        {
        //do nothing
        }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:30:06.873

这不是很好，但您可以调用函数，并`change`在`blur`函数中执行所有操作`change`：

```
...
$(document).on("change", "#yourelement", function(){
    //do your stuff
});
....
$(document).on("blur", "#yourelement", function(){
    $("#yourelement").change();
    //alternatively, you can trigger the change event
    //$("#yourelement").trigger("change");
}); 
```

它看起来不太好，但我认为它应该可以工作。

编辑：如果浏览器启动两个事件（模糊和更改），此代码将调用两次`change`功能。我认为你可以通过某种标志来实现这种行为：

```
var executed = false;
...
$(document).on("change blur", "#yourelement", function(){
    if(!executed){
        executed = true;
        //do your stuff
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-26T11:15:57.740

附加多个事件，您也可以像这样使用它

```
<select class="form-control" id="Category" name="Category" required>
   <option value="">Choose an option</option> 
   <option value="1">Your Text</option> 
</select>
<p class=""></p>

$( "#Category" ).on( "blur change", function( event ) {
    if($(this).val()===""){
            $(this).next().text("Please choose category").css("color","#a94442");
        }
        else
        {
            $(this).next().text("");
        }

}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-13T19:23:21.230

在**两个事件总是被触发**的情况下，我们可以为第一个触发器设置一个标志并运行脚本。第二个触发器将看到标志并将其清除，然后返回，因此它只运行第一次。

在这种情况下，您可以在不进行更改的情况下多次模糊，因此它只会每隔一次运行一次。如果有变化，那么它应该肯定会运行（无论标志是打开还是关闭）。

```
$(document).on("change blur",".selector", function(){

    if($(this).data("triggered") == "1"){
        $(this).data("triggered","0");
        return;
    }
    $(this).data("triggered","1");

    // your script here

    // fix for "every other time" issue described above
    var el = $(this);
    setTimeout(function(){ el.data("triggered","0"); }, 200);
} 
```

*   如果您想在用户离开元素之前检测到更改，您可以考虑“输入”事件。
*   您还可以考虑编写脚本，以便多次运行是安全的（幂等）并且足够高效，即使运行两次也不会影响性能。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2012-07-05T14:37:17.537

您可以同时绑定到多个事件：

```
$(document).on('blur change','#mySelector',function(){
    // this is called on either
}); 
```

# windows - 如何实现原生代码沙箱？

> ID：11346360
> 
> 赞同：1
> 
> 时间：2012-07-05T14:24:40.970
> 
> 标签：windows, performance, memory, process, ipc

我正在编写一个需要调用不安全本机代码的 Windows Java 应用程序，并且我需要防止此代码访问 Java 对象和 JVM 数据结构，否则它可能会使 JVM 崩溃或侵入敏感数据。在你问之前，这个本机代码已经过验证——它只能调用几个 API，不能有某些指令，所以我们知道它不会 VirtualProtect 本身或其他内存区域来获得更多的访问权限和乱七八糟的东西。

无论如何，我的第一次尝试是将此代码包装到一个单独的进程（沙箱）中，并使用 IPC 与 Java 对话。有一个 JNI DLL 在 Java 端执行 IPC 工作。基本上，每次我们需要运行不安全的本机代码时，我们的 Java 应用程序都会调用一个 JNI 函数，该函数使用自动重置 Windows 事件唤醒沙箱，然后等待完成。沙盒运行不安全的本机代码并使用另一个自动重置 Windows 事件唤醒 JVM，然后生活继续。如果不是那么慢就完美了。

问题是不安全的本机代码可能包含一些执行非常快速的计算的函数，并且可以从 Java 调用数百万次，因此调用开销应该是最小的。但是这种开销是巨大的，因为 JVM 通过 Windows 事件唤醒沙箱，当沙箱返回时反之亦然。这个过程是进程内（非 IPC）解决方案的 8 倍，其中不安全的本机代码包装在 JNI DLL 中（因此调用发生在同一个线程中，在同一个时间片中）。

我的第一个猜测是，当 JVM 唤醒沙箱时，Windows 只将沙箱线程置于就绪集，因此它仅在几毫秒后运行。当沙盒返回时也会发生同样的情况。不算两个（可能很昂贵）上下文切换。

[此处](http://msdn.microsoft.com/en-us/library/windows/desktop/ms685100(v=vs.85).aspx)的Microsoft 文档说明如下：

> 如果较高优先级的线程可以运行，系统将停止执行较低优先级的线程（不允许其完成使用其时间片），并将完整的时间片分配给较高优先级的线程。

为了测试这个理论，我将 THREAD_PRIORITY_TIME_CRITICAL 分配给沙盒线程。有一些收获。性能从进程中（非 IPC）解决方案的 8 倍提高到 5 倍。但我需要更多，否则这个 Java 应用程序可能无法投入生产！

您可以通过两种方式帮助我：

*   告诉我是否有更快的方法来唤醒另一个进程，例如强制上下文切换或执行进程间过程调用。

*   告诉我如何在进程内运行不安全的本机代码时保护 JVM。我听说 Google Native Client 会这样做，但我只找到[了这个文档](https://sites.google.com/a/chromium.org/dev/nativeclient/reference/anatomy-of-a-sys)。如果您了解更多，请提供有关如何实施的更详细信息的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-20T21:43:07.817

[我通过在通过文件映射](http://docs.oracle.com/javase/7/docs/api/java/nio/MappedByteBuffer.html)从 JVM 访问的[共享内存变量上使用](http://en.wikipedia.org/wiki/Shared_memory)[自旋锁](http://en.wikipedia.org/wiki/Spinlock)执行 JVM 沙盒交互来解决了这个问题。[这个问题](https://stackoverflow.com/questions/11386528/how-to-make-a-fast-context-switch-from-one-process-to-another)解释了如何在 C++ 环境中实现。使用 .移植到 Java 很容易。`MappedByteBuffer`

# iphone - 通过其中的行数设置单元格的宽度

> ID：11346363
> 
> 赞同：0
> 
> 时间：2012-07-05T14:24:52.500
> 
> 标签：iphone, uitableview, nsstring

我有一个单元格和一个`NSIntger`计算字符串中的行数。例子：

```
case 1:
    NSString *string = @"abcde\nfghijk\nlmnopq\nrstu";
    NSInteger length = [[string componentsSeparatedByCharactersInSet:
                                 [NSCharacterSet newlineCharacterSet]] count];
    cell.detailTextLabel.text = [NSString stringWithFormat:string];
    cell.detailTextLabel.numberOfLines = length;
    break; 
```

这段代码在`- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath`.

如何按`NSIntger`长度设置单元格宽度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:31:32.803

如果您想出售单元格高度，那么您有一个 UITableView 委托的方法回调方法......

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
   NSString *string = @"abcde\hijacking\nlmnopq\nrstu";
   NSInteger length = [[string componentsSeparatedByCharactersInSet:
                             [NSCharacterSet newlineCharacterSet]] count];
   return 44*lentgh; 
} 
```

愿这会对你有所帮助。

# jquery - jQuery DataTables 鼠标点击搜索

> ID：11346366
> 
> 赞同：1
> 
> 时间：2012-07-05T14:25:01.773
> 
> 标签：jquery, datatables

我正在研究 jQuery 数据表。我已经为搜索文本框实现了预测搜索功能，这样当用户开始输入时，它会显示一个包含 10 个最近搜索过的项目/字符串的列表。现在这里的问题是，如果我使用键盘选择任何列表项，过滤就会立即发生，即在每次按键时，而当我用鼠标单击选择列表项时，它不会过滤表格。我必须按 Enter 才能过滤表格。我希望能够在按键和鼠标点击时过滤表格。这如何在数据表中实现？任何建议都会有很大帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T18:24:54.223

你可以做这样的事情；

首先，您需要在单击时设置一个 JQuery 事件，因此为下拉列表中的所有选项提供一个类，例如 recentItems。然后你可以写这样的东西；

```
$(document).ready(function() {

   $('.recentItems').click(function(){
           var filterString = $('.dataTables_filter :input').val();
           oTable.fnFilter(filterString);
   });

}); 
```

这假设你给你的数据表一个变量名 oTable。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-12T15:50:40.517

```
$('#filter-data-button').click(function(){
    oTable.search('your value').draw();
}); 
```

# eclipse-plugin - 在 Salesforce IDe 中更改密码后登录错误

> ID：11346368
> 
> 赞同：1
> 
> 时间：2012-07-05T14:25:06.167
> 
> 标签：eclipse-plugin, salesforce, apex-code

我使用 Salesforce IDE（独立）。

我不得不更改我的 SF 密码，从那一刻起，当我启动 IDE 时，我收到登录错误，并告诉我需要从 API 调用：重置密码。

我不明白需要做什么，因为 IDE 中没有设置密码。

我需要在我的 apexclass 中调用重置 API 吗？这似乎很奇怪。

坦斯克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:22:08.093

您的 Force.com 项目与您的过期密码相关联。您可以删除该项目并创建一个新项目（这需要您指定新密码），或者通过右键单击“包资源管理器”中的项目并转到“属性”来更改当前项目的密码。您应该会看到类似于下面的屏幕截图的内容，如有必要，您可以在其中输入新密码和安全令牌。

![Force.com 属性窗口](../Images/c74a8b29e23114274d12e1842a542f70.png)

# java - 是否有用于显示 DFX/Autocad 文件的 SWT 小部件？（或将其转换为 Draw2D 的转换器）

> ID：11346369
> 
> 赞同：2
> 
> 时间：2012-07-05T14:25:06.173
> 
> 标签：java, swt, autocad, draw2d, dxf

我有一些 DXF 或 Autocad 文件，需要在 eclipse rcp 应用程序中显示这些文件。是否有提供此类功能的小部件？或者是否有一个库可以将这些以某种方式转换为 draw2d 对象？

# android - 如何从 Android 中的 EditText 读取单个字符？

> ID：11346371
> 
> 赞同：1
> 
> 时间：2012-07-05T14:25:09.323
> 
> 标签：android, android-edittext, character

我的 Android 应用程序中有一个 EditText，您可以在其中输入一些文本。我想要做的是将每个字符更改为另一个字符（某种加密）。因此，我首先必须阅读每一个字符。

我怎样才能做到这一点？

更新：编辑文本中的文本将在单击按钮时进行编码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:29:08.957

读取整个 String，处理其中的每个字符，将结果放入 String 并将其存储到目标 editText 或 TextView 中。

如果您想实时执行此操作，请捕获任何有效键的 keyevent，从 edittext 检索整个字符串，将最后一个字符替换为您想要的任何字符，并将结果存储到目标视图中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:29:00.420

```
String str = edittext.getText().toString();

for(int i=0;i<str.length;i++)
{
    String singlechar=charAt(i);
    // here you can change char by another chare here

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:30:02.250

您可以使用输入过滤器。

**当您继续键入以下代码段时，将用 $ 替换每个字符。**

关注 Snippet 将对您有所帮助。

```
InputFilter filter = new InputFilter() {

    @Override
    public CharSequence filter(CharSequence source, int start, int end, Spanned dest, int dstart, int dend) {
        for (int i = start; i < end; i++) {
            return "$";
         }
        return null;
    }
};

EditText editText = (EditText) findViewById(R.id.rg);
editText.setFilters(new InputFilter[] {filter}); 
```

**下面是我的工作片段**

```
package org.vipul;

import android.app.Activity;
import android.os.Bundle;
import android.text.InputFilter;
import android.text.Spanned;
import android.widget.EditText;

public class AbcActivity extends Activity {
    EditText editText;

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        editText = (EditText) findViewById(R.id.rg);

        InputFilter filter = new InputFilter() {

            @Override
            public CharSequence filter(CharSequence source, int start, int end, Spanned dest, int dstart, int dend) {
                 for (int i = start; i < end; i++) {
                    return "$";
                 }

                return null;
            }
        };

        editText.setFilters(new InputFilter[] {
            filter
        });

    }
} 
```

# javascript - 如何从一个类中实现多个小滚动条？

> ID：11346373
> 
> 赞同：4
> 
> 时间：2012-07-05T14:25:11.980
> 
> 标签：javascript, variables, jquery-plugins, tinyscrollbar

我正在尝试使用插件 Tinyscrollabr.js [http://baijs.nl/tinyscrollbar/实现多个滚动条](http://baijs.nl/tinyscrollbar/)

为了实现滚动条，我使用了类似本文中的函数 scrollify：http: [//www.eccesignum.org/blog/making-tinyscrollbarjs-easier-to-implement](http://www.eccesignum.org/blog/making-tinyscrollbarjs-easier-to-implement)

HTML：

```
<ul id="myList">
<li id="scrollbar1" class="col">
  <h2>Title 01</h2>
  <div class="scrollBox"><!--Scrollable Content here--></div>
</li>

<li id="scrollbar2 class="col">
  <h2>Title 02</h2>
  <div class="scrollBox"><!--Scrollable Content here--></div>
</li>

<li id="scrollbar3 class="col">
  <h2>Title 03</h2>
  <div class="scrollBox"><!--Scrollable Content here--></div>
</li>
</ul> 
```

Javascript：

```
function scrollify(element,options) {   //  '#element', {list:of,key:values}
 var opt = options || {}
     $(element).children().wrapAll('<div class="viewport"><div class="overview"></div></div>');
     $(element).prepend('<div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div>');
     $(element).tinyscrollbar(options);}

$scrollbar1 = $('#scrollbar1 .scrollBox') ;
$scrollbar2 = $('#scrollbar2 .scrollBox');
$scrollbar3 = $('#scrollbar3 .scrollBox');
$scrollbar4 = $('#scrollbar4 .scrollBox');

$(function() {
scrollify($scrollbar1);    
scrollify($scrollbar2);   
scrollify($scrollbar3);   
scrollify($scrollbar4);

}) 
```

我想让这更简单。例如，我将能够做到这一点：

```
$(function() {
scrollify('.scrollBox');
}) 
```

但是 tinyscrollbar 需要一个 id。使用一个类，它加载第一个滚动条而不是其他滚动条。Firebug 返回此错误消息“f.obj[0] 未定义”

抱歉，如果我的问题很愚蠢，但是如何将 tinyscrollbar 应用于具有类的元素列表？

然后，在一些操作之后，如何使用函数 $allScrollbars.tinyscrollbar_update(); 更新所有这些滚动条；

感谢您的帮助，我刚开始使用 javascript，我正在努力学习。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:23:41.187

感谢 KneeSkrap3r 的回答。这是一个很好的解决方案，但我正在尝试做一些事情，以防我不知道要滚动的元素数量。我想我发现了这样的东西（它是我尝试做的第一个 jquery 插件的一部分），其中 $el 是所有带有类“滚动框”的元素。

```
$el.each(function(index)
            {
                var $scrolls = $(this);

                function scrollify(element,options)
                {   //  '#element', {list:of,key:values}
                    var opt = options || {}
                    $(element).children().wrapAll('<div class="viewport"><div class="overview"></div></div>');
                    $(element).prepend('<div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div>');
                    $(element).tinyscrollbar(options);
                }
                scrollify($scrolls);

                // Update heights
                $(window).resize(function()
                {   $scrolls.tinyscrollbar_update('relative');
                });
            }) 
```

像这样，它似乎有效，但我不知道我是否正在使用 javascript 的良好实践。对于 Html 标记，我告诉了 div 的 li 元素，这对语义更好。感谢您的提示；-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T19:44:42.143

我会计算类的元素数量：

```
var scrollCount = $(".scrollbox").size(); 
```

然后使用迭代循环调用您的每个 ID：

```
for (i=0; i<5; i++)  {
   scrollify($('#scrollbar' + i));
} 
```

此外，我建议使用 DIV 而不是您拥有的列表设置，使用您共享的链接中的示例作为起点:)

# html - 仅在 IE9 中出现动态 HTML 渲染问题

> ID：11346385
> 
> 赞同：0
> 
> 时间：2012-07-05T14:25:51.717
> 
> 标签：html, internet-explorer, internet-explorer-9

我只在 IE9 中遇到了这个令人讨厌的渲染问题，IE8 和 IE7 与其他浏览器一样工作正常。

[http://jsfiddle.net/65Zsv/](http://jsfiddle.net/65Zsv/)

在 IE9 中打开演示并将鼠标悬停在图像上。问题是在 IE9 中，位于图像下方的文本呈现出伪影。

我能够通过强制 IE9 进入 IE8 兼容模式来解决这个错误，但这仍然停留在我的脑海中，我正在寻找一个真正的解决方案。

*PS我没有安装IE10，我想知道这个错误是否也会存在......*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:37:39.043

可以通过将文本包装在块级标签中来解决此错误。像这样更新你的小提琴，错误就消失了：

```
<html>
<head></head>
<body>
<div class="itemBtn"><img src="http://a3.mzstatic.com/us/r1000/029/Video/ad/b9/e4/mzi.sporozgs.100x100-75.jpg"><br>    <p>IIII THIS IS SOME CRAZY TEXT</p></div></body>
</html> 
```

我不知道 <body> 标签中的文本规则，但我认为它必须在某个时候位于块级元素中。这可能更像是无效标记的情况，而不是 MS 错误。

# c# - 重新输入密码框时弹出用户选择框

> ID：11346391
> 
> 赞同：0
> 
> 时间：2012-07-05T14:25:59.563
> 
> 标签：c#, asp.net-mvc, validation, change-password

我有一个允许登录用户更改密码的表单。每当我在重新输入密码框中输入密码时，我都会弹出一个窗口，要求我选择要更改密码的用户！令人震惊的是，这种弹出窗口甚至会出现，因为它看起来像一个明显的安全漏洞。

![在此处输入图像描述](../Images/d86f38fec9e2327ba540b9c095d1d6f9.png)

我的视图代码的相关部分是

```
 <p>
            <label for="ViewModelChangePassword_Password">
                Password</label>
            <input type="password" value="" name="ViewModelChangePassword.Password" id="ViewModelChangePassword_Password" />
        </p>
        <p>
            <label for="ViewModelChangePassword_Password1">
                Re-enter password</label>
            <input type="password" value="" name="ViewModelChangePassword.Password1" id="ViewModelChangePassword_Password1" />
        </p> 
```

为什么会这样？作为一个单独的问题，我想要运行此验证

```
[Required]
[DataType(DataType.Password)]
[DisplayName("Password")]
public string Password { get; set; }

[Required]
[DataType(DataType.Password)]
[DisplayName("Re-enter Password")]
[Compare("Password", ErrorMessage = "Passwords must match")]
public string Password1 { get; set; } 
```

谢谢，

萨钦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:47:12.807

这与 ASP.NET、MVC 或验证无关。您可能正在使用 Firefox 测试您的页面并选择了保存密码的选项。

每当您更改该站点的密码时，**Firefox**都会要求您选择要更改密码的用户名。

# php - 上传时获取临时文件名

> ID：11346392
> 
> 赞同：0
> 
> 时间：2012-07-05T14:26:03.010
> 
> 标签：php, file-upload, temporary-files

上传过程中如何获取临时文件名？（上传后给出的 tmp_name 参数）。我尝试使用[Session Upload Progress](http://www.php.net/manual/en/session.upload-progress.php)，进度正常，但 tmp_name 的字段始终为空。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T08:54:09.720

您可以使用[APC](http://php.net/manual/en/book.apc.php)并为此启用[rfc1867 设置。*`apc.rfc1867`*](http://www.php.net/manual/en/apc.configuration.php#ini.apc.rfc1867)

该网站解释了[如何做到这一点](http://www.phpriot.com/articles/php-ajax-file-uploads/3)：

```
<form method="post" action="upload.php" enctype="multipart/form-data">
    <div>
        <input type="hidden" name="APC_UPLOAD_PROGRESS" value="1234" />
        <!--                       ###################              -->
        <input type="file" name="myFile" />
        <input type="submit" value="Upload file..." />
    </div>
</form> 
```

> 注意：`APC_UPLOAD_PROGRESS`表单元素必须在文件输入之前出现在表单中。

它将为您提供所需的信息：

```
print_r(apc_fetch("upload_$_POST[APC_UPLOAD_PROGRESS]"));
                                 ###################

Array
(
    [total] => 1142543
    [current] => 1142543
    [rate] => 1828068.8
    [filename] => test
    [name] => file
    [temp_filename] => /tmp/php8F
    [cancel_upload] => 0
    [done] => 1
) 
```

# jquery - 为什么这个 Ajax 请求在 IE 中不起作用？

> ID：11346395
> 
> 赞同：0
> 
> 时间：2012-07-05T14:26:17.807
> 
> 标签：jquery, ajax

我有以下 JQuery AJAX 请求，它在 Chrome 中运行良好，但是当我在 IE 中测试时，它返回`undefined`：

```
$.ajax({
    url : 'http://pipes.yahoo.com/pipes/pipe.run?_id=26650603c42f41d78bfb5c5c740747d3&_render=json&_callback=?',
    dataType : 'xml',
    complete : function(data) {
        console.log(data.responseText);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:08:25.067

Did you tried like this:

```
 $(document).ready(function(){
    $.ajax({
        url : 'http://pipes.yahoo.com/pipes/pipe.run?_id=26650603c42f41d78bfb5c5c740747d3&_render=json&_callback=pipeCallback', 
        dataType : 'jsonp',
        complete : function(data) {
            //alert(data.responseText);
            //console.log(data.value);
        },
         error: function (xhr, status, error) {
                alert(error);
            }
    });
});
function pipeCallback(d){
    data = d;
    //console.debug(d);
    var arts = d.value.items;
    for (var i=0; i<arts.length; i++)
    {
    var a = document.createElement("a");
    a.setAttribute("href", arts[i].link);
    a.innerHTML = "<h1>" + arts[i].title + "</h1>"
    var dv = document.createElement("div");
    dv.innerHTML = arts[i].description;
    document.body.appendChild(a);
    document.body.appendChild(dv);
    }   
} 
```

Have just tested it is working fine also get rid of **console.log** calls, if the developer tools arenot open it wont work in IE.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:52:01.733

这似乎是浏览器安全设置的问题：

*   [http://www.webdavsystem.com/ajax/programming/cross_origin_requests](http://www.webdavsystem.com/ajax/programming/cross_origin_requests)
*   [http://sunh11373.blogspot.ca/2007/04/cross-domain-ajax-in-ie.html](http://sunh11373.blogspot.ca/2007/04/cross-domain-ajax-in-ie.html)
*   [Jquery $.ajax 在跨域调用的 IE 中失败](https://stackoverflow.com/questions/3362474/jquery-ajax-fails-in-ie-on-cross-domain-calls)

出于安全考虑，Internet Explorer 只是不允许 CORS（至少在 -IE7 中）。然而，IE8+ 似乎能够进行 XDR。

# windows - Windows 命令行剪切了这种语法的扩展

> ID：11346396
> 
> 赞同：1
> 
> 时间：2012-07-05T14:26:18.397
> 
> 标签：windows, batch-file, cmd

我找到了这个脚本并修改了它以供我使用，但我在 Windows 批处理中并不擅长。

谁能帮我削减扩展名`%%x`？

```
FOR /D /r %%F in ("*") DO (
pushd %CD%
cd %%F
    FOR %%X in (*.rar *.zip) DO (
        unzip -o -d %%X
    )
popd
) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T14:37:12.700

要仅获取不带扩展名的名称，请`~n`在变量中使用 :`%~nX`在命令行或在批处理文件中转义`%%~nX`

```
FOR /D /r %%F in ("*") DO (
pushd %CD%
cd %%F
    FOR %%X in (*.rar *.zip) DO (
        unzip -o -d %%~nX
    )
popd
) 
```

[您可以在 MS Technet For 页面](http://technet.microsoft.com/en-us/library/e275726c-035f-4a74-8062-013c37f5ded1)中获取变量扩展的参考。

# python - 在 Windows 机器上部署 Python/Django 应用程序的最简单方法是什么？

> ID：11346397
> 
> 赞同：-4
> 
> 时间：2012-07-05T14:26:18.480
> 
> 标签：python, django, deployment

我需要在远程 Windows 机器上部署一个 Django 项目，但由于项目的限制，我无法访问该机器 - 我必须将它交给另一个负责部署它的人。

问题是，在该机器上部署我的应用程序的最简单方法是什么，我正在寻找安装包或脚本之类的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T16:48:23.517

在我看来，bitnami - djangostack 将解决您的问题。它是免费且易于设置的

[http://bitnami.org/stack/djangostack/](http://bitnami.org/stack/djangostack/)

# linux - 作为后台进程运行时输出在哪里？

> ID：11346399
> 
> 赞同：11
> 
> 时间：2012-07-05T14:26:27.167
> 
> 标签：linux

我的进程将一些日志信息输出到控制台窗口。当我将它作为后台进程运行时，我在哪里可以找到输出日志？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-05T14:28:44.017

取决于过程以及您如何开始。如果它写入`stdout`（这很可能，因为输出通常是到终端），您可以将输出重定向到一个文件

```
command > logfile & 
```

如果您还想从 记录错误消息`stderr`，请执行

```
command > logfile 2> errorlogfile & 
```

或者

```
command > logfile 2>&1 & 
```

将所有内容放在一个文件中。

# .net - 更改 SharePoint 列表项版本号

> ID：11346401
> 
> 赞同：2
> 
> 时间：2012-07-05T14:26:28.060
> 
> 标签：.net, sharepoint

我必须制作一个程序来更改列表项的 UI 版本号（SharePoint 的 Web 界面上显示的版本号）。

例如：一个项目有这些版本：1.0、1.1、1.2、2.0、2.2、2.3 我想将2.2版本的标签更改为2.1。

据我所知，通过对象模型是不可能的，所以我必须直接修改数据库。在数据库中有两个相关的表：

*   AllDocs - 在此表中有描述文档当前版本的行。

*   AllDocVersions - 在此表中有描述文档其他（非当前）版本的行。

如果我不必更改当前版本，这并不难，只需更改右侧表格中的 UIversion 字段。（在示例中：2.2 到 2.1）问题是版本更改是否更改了当前版本。在示例中：2.2 到 2.4。在这种情况下，我应该将 2.2 版本的记录从 AllDocVersions 表移到 AllDocs，将 2.3 版本的记录从 AllDocs 移到 AllDocVersions，但这两个表的结构并不相同。

谁能描述我如何填写这些表格中缺少的字段？任何人都可以建议任何其他方式来更改版本吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T13:50:53.227

这可能会让您朝着正确的方向开始：

```
using (SPSite siteCollection = new SPSite("http://sp2010-server"))
{
    SPWeb site = siteCollection.OpenWeb()
    {
        site.UIVersion = 3;
        site.UIVersionConfigurationEnabled = true;
        site.Update();
    }
} 
```

来源：[在 SP2010 中更改 UI 版本](http://sharingmypoint.blogspot.com/2011/01/programmatically-changing-ui-version-in.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T20:39:52.997

一，不是那么简单的解决方案可能是：

1.  让 SharePoint 做艰苦的工作，使用通用的 SharePoint API 恢复`v2.2`为`v2.4`. 它为你做了两件事：
    *   复制`v2.2`到as和`AllDocVersions`_`AllDocs``v2.4`
    *   `v2.3`从移动`AllDocs`到`AllDocVersions`。
    *   可以通过 Web 界面实现，所以我想它也可用于 .NET 应用程序。
2.  删除`v2.2`。
3.  然后，如果不是所需的版本号，您可以直接使用 SQL UPDATE 语句更新数据库中的`v2.4`to`v2.5`等的版本号。`v3.0``v2.4`

# php - 通过 Javascript 实现的动态 MySQL 命令

> ID：11346405
> 
> 赞同：0
> 
> 时间：2012-07-05T14:26:37.623
> 
> 标签：php, javascript, jquery, ajax

有谁知道 Javascript + MySQL 脚本，它允许我通过 javascript 动态请求 mysql 信息，而不必为我拥有的每个单独的 Ajax 请求制作一个单独的 php 文件？

我问，因为我制作了一个将插入 MySQL 信息的动态脚本，并且很好奇是否已经有一个可以请求它的脚本。

我听说这个想法可能会导致安全问题。任何想法如何仍然使这成为可能？我有很多 AJAX 请求，我不想为此制作数十甚至数百个小型 PHP 脚本......

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T10:35:52.587

我找到了答案！通过使用哈希。我可以简单地将 md5 添加到 ajax（md5 将包含字符串信息 + 一些随机代码，这将使用 php 脚本创建）。然后实际插入或请求数据库信息的脚本 (php) 将尝试创建相同的 md5 哈希。如果成功，则合法，如果不成功，则停止数据库请求或发布。

[http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=391](http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=391)

# c# - 文件已被访问错误

> ID：11346406
> 
> 赞同：1
> 
> 时间：2012-07-05T14:26:44.610
> 
> 标签：c#, file, appdata, roaming

我的应用程序正在写入的 \AppData\Roaming 中有一些文件。我在应用程序启动时创建文件，如下所示：

```
private void Form1_Load(object sender, EventArgs e)
{
DirectoryInfo _File = new DirectoryInfo(Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), @"MyApp\myfile.txt"));
} 
```

后来，当我通过单击按钮写入文件时，我收到一条错误消息，指出该文件已在使用中，无法访问。我将如何解决这个问题？

写入文件的代码是正确的，因为当我删除上面的代码并自己制作文件时，应用程序会毫无问题地写入它们。因此，我认为问题不在于我用来写入文件的代码。但是，这里供参考：

```
var myfile = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), @"MyApp\myfile.txt"));
StreamWriter sw = new StreamWriter(myfile);
sw.WriteLine(textBox1.text);
sw.Close(); 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:59:06.563

这里有一些概念在起作用，我不确定我们是否有足够的信息来明确解决根本问题，但我会给你一些建议。

您需要了解[FileMode](http://msdn.microsoft.com/en-us/library/system.io.filemode.aspx)、[FileAccess](http://msdn.microsoft.com/en-us/library/4z36sx0f.aspx)和[FileShare](http://msdn.microsoft.com/en-us/library/system.io.fileshare.aspx)枚举。

第一个，**FileMode**，指定您打算对文件的存在执行什么操作。上面的链接中记录了各种选项。我认为您在这里没有问题，但值得一提。

第二个，**FileAccess**，涉及您与文件的预期交互（读取、写入或两者）。如果您请求读取权限，则打开文件或已经打开文件的任何其他人（包括该 Web 浏览器控件）必须允许与其他读者共享。

最后一个**FileShare**定义了您愿意与谁共享文件访问权限。您可以指定其他人可以读取它，其他人可以写入它，两者都可以，或者都不可以。

您正在使用的代码使用最简单的默认值访问文件，这可能与 WebBrowser 的访问模式不兼容。这是我的建议：

```
var myfile = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), @"MyApp\myfile.txt"));
using (var fs = new FileStream(myfile, FileMode.OpenOrCreate, FileAccess.Write, FileShare.ReadWrite)) {
    using (var sw = new StreamWriter(fs)) {

        // You probably want to move to the end of the file before writing...
        fs.Seek(0, SeekOrigin.End);

        sw.WriteLine(textBox1.text);
        sw.Close();
    }
} 
```

这非常清楚地表达了您的意图，以及您愿意与可能读或写的其他人分享的事实（我们知道网络浏览器不会写入文件，但由于某种原因，它可能正试图用 write 打开它无论如何意图）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:35:15.720

对于文件操作（以及您访问非托管资源的任何时间），最好的办法是只抓住文件的句柄，时间长到足以执行您想要的操作，然后释放它。

在您的情况下，您正在打开资源，然后尝试稍后再次打开它。改变这个。在您真正要对它做某事之前，不要创建文件。另外，查看`USING`条款。您希望在完成读取或写入后立即释放它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:33:17.797

尝试访问 FileInfo 对象以创建/追加/写入文件，如下所示，该文件已被 FileInfo 类占用，

使用如下，

```
 FileInfo fi1 = new FileInfo(path);

        //Create a file to write to.
        using (StreamWriter sw = fi1.CreateText()) 
        {
            sw.WriteLine("Hello");
            sw.WriteLine("And");
            sw.WriteLine("Welcome");
        }   

        //Open the file to read from.
        using (StreamReader sr = fi1.OpenText()) 
        {
            string s = "";
            while ((s = sr.ReadLine()) != null) 
            {
                Console.WriteLine(s);

            }
         } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-05T14:32:46.993

尝试使用`using`.

```
using (StreamWriter sw = new StreamWriter(myfile))
{
    sw.Write(textBox1.text);
} 
```

# composer-php - 使用作曲家制作自定义创建项目

> ID：11346407
> 
> 赞同：5
> 
> 时间：2012-07-05T14:26:47.483
> 
> 标签：composer-php

我想克隆*symfony-standard-edition 创建项目*调用，但有一些自定义要求。
所以我不需要 Swiftmailer 或 Doctrine ORM，但想要 PaginatorBundle。

我尝试从标准版复制和编辑 composer.json 并做了一个：

```
composer.phar install 
```

但这只是安装了供应商目录，而不是其他的，比如 app 文件夹等。

那么我该如何运行：

```
composer.phar create-project symfony/framework-standard-edition myproject 
```

用我编辑的composer.json？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T17:12:33.253

您可以`composer.phar create-project symfony/framework-standard-edition myproject`引导整个项目，然后从 composer.json 中删除您不需要的包并运行更新以删除它们。

否则，您也可以在 github 上 git clone symfony/symfony-standard 存储库，然后从那里开始，在调整 composer.json 文件后运行 composer install。

# php - php mysql中的通知警报

> ID：11346408
> 
> 赞同：0
> 
> 时间：2012-07-05T14:26:48.227
> 
> 标签：php, html

我想在我的网站用户之间建立一个简单的消息系统。为此，我为消息构建了如下表：

```
tbl_messages
 -pk id int
 -fk sender_id int
 -fk receiver_id int
 -is_read boolean 
 -send_date datetime 
```

当用户在浏览器中打开我的网站并且其他用户向他发送消息时，我想在打开接收者页面时向接收者用户发送通知消息（类似于 1 条新消息或（3）消息）。例如：facebook 通知，stackoverflow 通知在新评论到达时出现

我通过使每 2 分钟调用一次 javascript 函数来执行此类操作。此函数发出 ajax 请求以输出通知。我想知道这是正确有效的方法吗，因为我必须每 2 分钟执行一次 sql 查询，如果我的表中有很多记录，这样的操作会在数据库上产生更多的负载。

除了这个，我还可以执行哪些其他解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:35:06.920

如果你正确地索引了你的数据库并设计了你的程序，那应该不是问题。

您将无法设计像 Facebook 和其他一样响应迅速的通知系统，因为使用 PHP 创建推送系统几乎是不可能的。

如果您有专用/虚拟化服务器（而不是共享主机），请查看诸如 NodeJS 之类的东西。

# php - 最佳登录方式？

> ID：11346409
> 
> 赞同：0
> 
> 时间：2012-07-05T14:26:52.933
> 
> 标签：php, authentication, login, admin

我是 php 新手，如果可能的话，我想了解一些信息。我目前正在尝试为我的大学中的一个练习建立一个网站。

我的主要问题是创建登录脚本的最佳或更专业的方法是哪种（**注意：**只有一个用户，管理员可以访问）？？？

*   第一，检查表单中发布的数据是否与数据库中“admin”表中的数据匹配。所以我必须在我的数据库中创建一个表并添加一个只有管理员的用户，然后使用 sql 查询检查匹配
*   或第二个通过制作这样的脚本：

    ```
    if(($_post['username'] == 'admin') && ($_post['password'] == 'password')){
        echo "Welcome admin";
    }else{
        echo "No access";
    } 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:35:43.043

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:38:21.430

为什么不做一张`users`桌子？在该表中，可以将一个字段命名为“admin”，其中“0”表示不是管理员，“1”表示管理员。

对于密码，您总是希望使用某种哈希： http: [//php.net/manual/en/function.hash.php](http://php.net/manual/en/function.hash.php)。

然后，在检查登录凭据时，您可以执行

```
if( !empty($_POST['password'] && hash('sha256', $_POST['password']) = {database password}  ){
  // password's okay
} 
```

*   永远不要在数据库中存储纯文本/未加盐的密码。

注意：您的数据库“密码”将是散列/加盐值，而不是实际密码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:31:25.343

如果您将数据保存在数据库中总是更好，在这种情况下，您应该加密您的用户数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T14:32:37.317

您当然不应该在代码中存储密码和管理员用户名。数据库是此类数据的更安全可靠的存储。

如果你有一个*用户*表，你可能有一个字段指示用户权限的级别，或者你甚至可能有一个单独的具有权限的表。在这种情况下，您可以拥有*管理员*权限并将其分配给某个用户（一个或多个，如您所愿）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T14:34:44.583

当然是第一。在任何时候，您都可以添加一些用户，而不是通过更改源代码，而是通过在数据库中添加条目。请注意，有时我们暗示只有一个用户具有访问权限，但在我们注意到另一个用户必须具有访问权限之后。最好做到可扩展。

# java - 将十六进制转换为具有 3 位数字的字符

> ID：11346412
> 
> 赞同：1
> 
> 时间：2012-07-05T14:26:54.627
> 
> 标签：java, unicode, utf-8, hex

当十六进制有 3 位数字时，我在将十六进制转换为字符时遇到问题

我有 2 种方法可以在十进制值 127 上转义和取消转义字符

`test\\b8``test¸`转义时产生

unescape 执行以下操作：

```
for (int i=0, n=node.length; i<n; i++) {
    if(c == "\\"){
          char c2 = node[i + 1];
          char c3 = node[i + 2];
          int i= Integer.parseInt(str,16);
          char c = (char)i;
          System.out.println("Char is:=" + c);
    }
} 
```

输出 -`test¸`

如您所见，我将斜杠后的前两个字符转换为字符。这一切都很好。但是，有时某些字符具有 3 个十六进制数字（例如`test\\2d8`. 这应该不转义为`test˘`）。当这进入我的 unescape 方法时，不会使用所有 3 个字符。只有前 2 个，因此会产生错误的结果。

有没有办法确定何时转换 2 或 3 个字符

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:33:58.703

这是我要做的：

```
String raw = new String(node); // might be a better way to get a string from the chars
int slashPos = raw.indexOf('\\');
if(slashPos >= 0) {
    String hex = raw.substring(slashPos + 1);
    int value = Integer.parseInt(hex,16);
} 
```

通过这种方式，我们不会对 2、3、4 或 100 位数字进行特殊封装（尽管我确信 100 位数字会引发异常 :-)）。相反，我们将协议用作字符串中的“里程碑”，然后只接受斜线后面的所有内容都是十六进制字符串。

```
class HexParse {

    private static class HexResult {
        final boolean exists;
        final int value;
        HexResult(boolean e, int v) { exists = e; value = v; }
    }

    private final String raw;
    private final HexResult result;

    public HexParse(String raw) {
        this.raw = raw;
        int slashPos = raw.indexOf('\\');
        boolean noSlash = slashPos < 0;
        boolean noTextAfterSlash = slashPos > raw.length() - 2;
        if(noSlash || noTextAfterSlash) {
            result  = new HexResult(false,0);
        } else {
            // throws exception if second part of string contains non-hex chars
            result = new HexResult(true,Integer.parseInt(raw.substring(slashPos + 1),16));
        }
    }

    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append(raw).append(" ");
        if(result.exists) {
            sb.append("has hex of decimal value ").append(result.value);
        } else {
            sb.append("has no hex");
        }
        return sb.toString();
    }

    public static void main(String...args) {
        System.out.println(new HexParse("test`hello")); // none
        System.out.println(new HexParse("haha\\abcdef")); // hex
        System.out.println(new HexParse("good\\f00d")); // hex
        System.out.println(new HexParse("\\84b")); // hex
        System.out.println(new HexParse("\\")); // none
        System.out.println(new HexParse("abcd\\efgh")); //exception
    }

}

c:\files\j>javac HexParse.java

c:\files\j>java HexParse
test`hello has no hex
haha\abcdef has hex of decimal value 11259375
good\f00d has hex of decimal value 61453
\84b has hex of decimal value 2123
\ has no hex
Exception in thread "main" java.lang.NumberFormatException: For input string: "e
fgh"
        at java.lang.NumberFormatException.forInputString(NumberFormatException.
java:48)
        at java.lang.Integer.parseInt(Integer.java:458)
        at HexParse.<init>(HexParse.java:21)
        at HexParse.main(HexParse.java: 
```

# python - Python 3，NetworkX - 图形节点键列表不显示重复边

> ID：11346415
> 
> 赞同：0
> 
> 时间：2012-07-05T14:27:06.710
> 
> 标签：python, graph, python-3.x, networkx

我在 Python 3.2.3 上使用 NetworkX 模块。在两个节点之间具有多条边的多重图 G 中 - 比如说，'a' 和 'b' 之间有三条边 - 在 IDLE 提示符中键入 G['a'].keys() 会返回一个出现 'b' 的 dict_keys 列表只有一次。有什么方法可以使“b”出现的次数与两个节点之间的边一样多？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:33:52.500

就像是

```
[(k, len(v)) for k, v in G['a'].items()] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T18:20:45.607

NetworkX API 建议您使用 G.neighbors()，但对于只会给出唯一邻居的多重图。

如果您想要所有邻居，您可以使用 [v for u,v in G.edges_iter()]，例如

```
In [1]: import networkx as nx

In [2]: G=nx.MultiGraph()

In [3]: G.add_edge('a','b')

In [4]: G.add_edge('a','b')

In [5]: G.add_edge('a','b')

In [6]: [v for u,v in G.edges_iter()]
Out[6]: ['b', 'b', 'b'] 
```

# mysql - 从文本文件中提取特定字段

> ID：11346419
> 
> 赞同：2
> 
> 时间：2012-07-05T14:27:20.270
> 
> 标签：mysql, sql, awk, file-io

我有一个 csv 文件，其中包含超过 5k 个带有标题名称的字段/列。我只想将一些特定字段导入我的数据库。

我正在将本地 infile 用于需要导入的其他较小文件

```
LOAD DATA
LOCAL INFILE 'C:/wamp/www/imports/new_export.csv'
INTO TABLE table1
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\r\n'
(colour,shape,size); 
```

为要跳过的列分配虚拟变量可能很麻烦，此外，如果文件有其他字段，我更愿意使用字段标题来参考未来的证明

我正在考虑在将文件加载到数据库之前对文件使用 awk。但是我在搜索中找到的示例似乎不起作用。

对此最佳方法的任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T17:01:30.740

这类似于 MvG 的答案，但它不需要`gawk`4，因此`-F`按照该答案中的建议使用。它还展示了一种列出所需字段并遍历列表的技术。如果列表很大，这可能会使代码更易于维护。

```
#!/usr/bin/awk -f
BEGIN {
    col_list = "colour shape size" # continuing with as many as desired for output
    num_cols = split(col_list, cols)
    FS = OFS = ","
}

NR==1 {
    for (i = 1; i <= NF; i++) {
        p[$i] = i # remember column for name
    }
    # next # enable this line to suppress headers.
}

{
    delim = ""
    for (i = 1; i <= num_cols; i++) {
        printf "%s%s", delim, $p[cols[i]]
        delim = OFS
    }
    printf "\n"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:35:09.700

你的实际数据有逗号吗？如果没有，您最好使用`cut`：

```
cut -d, -f1,2,5,8-12 
```

将选择命名字段，在`,`. 如果您的任何 -`"`封闭的文本字段确实包含 a `,`，事情就会中断，因为`cut`不知道`"`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:27:09.877

这是一个功能齐全的解决方案，可以处理csv表的值中的各种引号和逗号，并且可以按名称提取列。它需要`gawk`并基于[此答案](https://stackoverflow.com/a/7095057/1468366)`FPAT`中建议的功能。

```
BEGIN {
  # Allow simple values, quoted values and even doubled quotes
  FPAT="\"[^\"]*(\"\"[^\"]*)*\"|[^,]*"
}
NR==1 {
  for (i = 1; i <= NF; i++) {
    p[$i]=i # remember column for name
  }
  # next # enable this line to suppress headers.
}
{
  print $p["colour"] "," $p["shape"] "," $p["size"]
} 
```

将此写入文件，由`gawk -f file.awk`.

由于列拆分和按标题索引功能有点正交，您可以使用非 GNU awk 上的部分脚本按列名进行选择，而不是使用`FPAT`而是简单`-F,`。

# ios - NSDictionary 元素到 UITextfield

> ID：11346422
> 
> 赞同：0
> 
> 时间：2012-07-05T14:27:31.453
> 
> 标签：ios, xcode, cocoa-touch, uitextfield, nsdictionary

我有`NSDictionary`一些我想在 a 中显示的参数`UITextField`。但

```
firstname.text = [userdata objectForKey:@"firstname"]; 
```

抛出异常。如果我在它上面使用 NSLog`[userdata objectForKey:@"firstname"];`显示正确的值。

这是抛出的异常：

> 2012-07-05 15:55:56.533 项目 [13642:f803] -[__NSArrayM _isNaturallyRTL]：无法识别的选择器发送到实例 0x68c4e20 2012-07-05 15:55:56.534 项目 [13642:f803] *** 终止应用程序到期未捕获的异常“NSInvalidArgumentException”，原因：“-[__NSArrayM _isNaturallyRTL]：无法识别的选择器发送到实例 0x68c4e20”

如果我使用

```
firstname.text = [NSString stringWithFormat:@"%@",[userdata objectForKey:@"firstname"]]; 
```

它有效，但它将值放在括号中。这里似乎有什么问题？为什么第一次尝试不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:35:29.773

```
_isNaturallyRTL 
```

是一个未记录的 NSString 方法。看起来

```
[userdata objectForKey:@"firstname"] 
```

是一个 NSMutableArray （根据类名猜测），您尝试将其用作字符串。当您使用带有 %@ 格式说明符的格式字符串时，它会调用`-description`要格式化/打印的对象的方法（NSLog 也是如此），并且 NSArray 的描述是一个看起来像

```
[ "description of first element", "description of second element" ] 
```

等等，这就是为什么它将您的文本放在括号中但不会崩溃的原因。

总而言之，使用

```
[[userdata objectForKey:@"firstname"] objectAtIndex:0] 
```

反而。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:30:58.733

```
firstname.text = [[userdata objectForKey:@"firstname"]stringValue]; 
```

这有什么区别吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T14:33:40.800

看起来它`[userdata objectForKey:@"firstname"]`正在返回一个仅包含您所追求的字符串的数组。看看您在哪里设置“名字”的值并将其更改为您所追求的字符串。

# macos - 如何正确更新 m4、autoconf、automake 和 libtool？Mac OSX

> ID：11346424
> 
> 赞同：1
> 
> 时间：2012-07-05T14:27:46.250
> 
> 标签：macos, autoconf, automake, libtool, m4

大家好，

我正在尝试更新我的 autoconf，因为我需要 2.62 或更高版本，而 Mac OSX 10.6.8 只提供旧的 2.61。（最终，我正在尝试安装 SAGA-GIS API）。

我遵循了这些说明： http: [//www.mattvsworld.com/blog/2010/02/install-the-latest-autoconf-and-automake-on-mac-os-10-6/](http://www.mattvsworld.com/blog/2010/02/install-the-latest-autoconf-and-automake-on-mac-os-10-6/)

但是：每当我完成这些步骤时，什么都没做。

```
make  install-recursive
Making install in .
make[5]: Nothing to be done for `install-exec-am'.
make[5]: Nothing to be done for `install-data-am'. 
```

我将这些工具安装在 usr/bin 中，因为这是旧工具所在的位置。这个对吗？

感谢您的支持，我真的需要这个 SAGA-GIS，但无论如何这些工具应该是最新的，我猜！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:37:24.837

您应该使用[macports](http://www.macports.org)，因为它提供了一个易于使用的界面，可以像 FreeBSD 发行版一样使用单个命令进行更新。

你不应该安装到`/usr/bin`; 这是一个非常糟糕的主意；而是使用`/usr/local`（macports 实际上使用`/opt/local`）并确保您`$PATH`拥有`/usr/local/bin:/opt/local/bin:/usr/bin`，以便使用您的较新版本。

# ios - NSLog 在哪里定义，即。NSLog 的标题是什么？

> ID：11346428
> 
> 赞同：6
> 
> 时间：2012-07-05T14:28:13.173
> 
> 标签：ios, xcode

我是 Mac OS 编程的新手。我想知道 NSLog 在哪里定义？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T14:32:33.873

在**NSObjCRuntime.h**文件中：

```
FOUNDATION_EXPORT void NSLog(NSString *format, ...) NS_FORMAT_FUNCTION(1,2); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:31:30.883

本着“授人以渔”的精神，您可以在代码编辑器中将光标放在其中找到任何符号的定义，然后查看右侧的快速帮助，或者右键单击并选择“跳转”到定义”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T14:33:27.763

它在`Foundation`框架中，在`NSObjCRuntime.h`. 这是定义：

```
FOUNDATION_EXPORT void NSLog(NSString *format, ...) NS_FORMAT_FUNCTION(1,2); 
```

[您可以在该方法的文档](https://developer.apple.com/library/mac/#documentation/cocoa/reference/foundation/miscellaneous/foundation_functions/reference/reference.html#//apple_ref/c/func/NSLog)末尾查看方法的定义位置：

> **在**
> NSObjCRuntime.h 中声明

# flash - 导入 * - 减慢应用程序？

> ID：11346430
> 
> 赞同：1
> 
> 时间：2012-07-05T14:28:15.127
> 
> 标签：flash, actionscript

当我写：

```
import flash.display.*; // importing all the classes of display

import flash.display.MovieClip; // importing only one class 
```

和其他类一样，所以问题是：如果我从某个包中导入所有类，应用程序的工作速度会比我只导入真正需要的类慢吗？

这是真的还是假的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T14:29:59.023

那将是错误的。从命名空间导入更多类不应影响应用程序的速度，因为它不会导致运行更多代码。

# html - 为 HTML 表格设置样式，使其看起来像 Google Docs 等电子表格

> ID：11346433
> 
> 赞同：6
> 
> 时间：2012-07-05T14:28:28.707
> 
> 标签：html, css, spreadsheet, contenteditable

我正在尝试创建一个看起来像 Google Docs 电子表格（或 Excel）的简单电子表格（带有 REST/JSON 后端）。我有一个使用 HTML 输入框和选择框的工作模型。 ![简单的 HTML 电子表格](../Images/3af23b572c8338ec74569b2b609c10e6.png)

有没有办法设置它的样式，使它看起来像一个真正的电子表格并使用“ContentEditable = true”并处理 Tab 键？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-03-12T20:58:49.230

你可以试试这个：[https](https://mindmup.github.io/editable-table/) ://mindmup.github.io/editable-table/它适用于引导程序，允许编辑内容，它就像一个 Excel 电子表格，但适用于普通的 HTML 表格。

它看起来像这样 img: [Image editableTableWidget](http://i.stack.imgur.com/dakr7.png)。显然您可以在 css 中自定义样式。

# java - 更改我的 java 绘画程序中的颜色

> ID：11346435
> 
> 赞同：0
> 
> 时间：2012-07-05T14:28:46.390
> 
> 标签：java, swing

我可以让程序出现并用一种颜色进行绘制，但如果我单击其中一个按钮，它不会改变颜色。我不断收到空指针异常。我认为这可能是因为我没有初始化图形、图像或两者。如果是那个问题，我不太确定如何解决这个问题。我对编程相当陌生，任何帮助将不胜感激。

代码：

```
 import java.awt.*;
    import java.awt.event.*;
    import javax.swing.*;

    public class Paint extends JFrame{
        //Class Variables
        private JFrame frame;
        PaintPanel paint_panel;
        private JPanel btn_panel;
        private JButton red_btn, green_btn, blue_btn, clear_btn, erase_btn ;

        //class to paint the panel in the frame
        public class PaintPanel extends JComponent{     
            //Class Variables
            private Graphics2D g;
            private int x1, y1, x2, y2;
            private Cursor paint_cursor, select_cursor;
            private Image image;

            //Constructor with Mouse listeners in it  
            public PaintPanel(){

                 addMouseListener(new MouseAdapter(){
                     public void mousePressed(MouseEvent e){
                             x1 = e.getX();
                             y1 = e.getY();
                             }
                    });
                 addMouseMotionListener(new MouseMotionAdapter(){

                     public void mouseDragged(MouseEvent e){
                             x2 = e.getX();
                             y2 = e.getY();

                             if(g != null)
                                 g.drawLine(x1, y1, x2, y2);
                             repaint();
                             x1 = x2;
                             y1 = y2;
                     }
             });
             }
            //PaintPanel Method that sets the cursor and does the drawing
            public void paintComponent(Graphics gr){
                super.paintComponent(gr);
                gr.setColor(Color.black);
                gr.fillRect(0, 0, this.getWidth(), this.getHeight());
                paint_cursor=new Cursor(Cursor.CROSSHAIR_CURSOR);
                select_cursor=new Cursor(Cursor.HAND_CURSOR);
                paint_panel.setCursor(paint_cursor);
                btn_panel.setCursor(select_cursor);
                if(image == null){
                    image = createImage(this.getWidth(), this.getHeight());
                    g = (Graphics2D)image.getGraphics();
                    clear1();
                 }
                 gr.drawImage(image, 0, 0, null);
         }
             public void clear1(){
                g.setPaint(Color.black);
                g.fillRect(0, 0, this.getWidth(), this.getHeight());
                g.setPaint(Color.blue);
                repaint();  
             }
             public void red(){ 
                 g.drawLine(x1, y1, x2, y2);
                 g.setPaint(Color.red);

                 x1 = x2;
                 y1 = y2;
                 repaint();
             }
             public void blue(){    
                 g.drawLine(x1, y1, x2, y2);
                 g.setPaint(Color.blue);

                 x1 = x2;
                 y1 = y2;
                 repaint();
             }
             public void green(){   
                g.drawLine(x1, y1, x2, y2);
                g.setPaint(Color.green);

                 x1 = x2;
                 y1 = y2;
                 repaint();
             }
            }

        //Constructor
        public Paint(){

            frame = new JFrame("Paint Program");
            frame.setSize(500,500);
            frame.setLocation(500,100);
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

            red_btn = new JButton("RED");
            green_btn = new JButton("GREEN");
            blue_btn = new JButton("BLUE");
            clear_btn = new JButton("CLEAR");
            erase_btn = new JButton("ERASE");

            btn_panel = new JPanel();
            paint_panel = new PaintPanel();

            btn_panel.setLayout(new GridLayout(5,1));

            btn_panel.add(red_btn);
            btn_panel.add(green_btn);
            btn_panel.add(blue_btn);
            btn_panel.add(clear_btn);
            btn_panel.add(erase_btn);
            frame.add(BorderLayout.CENTER, paint_panel);
            frame.add(BorderLayout.EAST, btn_panel);

            final PaintPanel pp1 = new PaintPanel();

            red_btn.addActionListener(new ActionListener(){
                public void actionPerformed(ActionEvent e) {
                    pp1.red();
                }   
                });
            blue_btn.addActionListener(new ActionListener(){
                public void actionPerformed(ActionEvent e) {
                    pp1.blue();
                }   
                });
            green_btn.addActionListener(new ActionListener(){
                public void actionPerformed(ActionEvent e) {
                    pp1.green();
                }   
                });
            clear_btn.addActionListener(new ActionListener(){
                public void actionPerformed(ActionEvent e) {
                    pp1.clear1();
                }   
                });
            erase_btn.addActionListener(new ActionListener(){
                public void actionPerformed(ActionEvent e) {
                    pp1.green();
                }   
                });
        }
        //Makes the frame visible and working
        public void launch(){
            frame.setVisible(true);
        }

        //Main Method
        public static void main(String[] args){
            Paint p1 = new Paint();
            p1.launch();
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:35:35.900

存储您的图形对象是让您陷入困境的原因。简单的答案是所有绘画都需要通过 JComponent.paintComponent(...) 完成，因此您的 red() green() blue() 应该由 paintComponent 使用来自 paintComponent 的 Graphics 对象调用

从根本上说，java 绘画的工作方式是通过对paint()/paintcomponent() 的回调，在同一个周期中绘制所有内容。该机制以这种方式工作，以便组件在不同时间看起来不同，具有不同的鼠标/单击状态等

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T16:15:16.607

您正在从按钮侦听器调用 red() 方法，并且在调用 drawLine 时使用 x1、x2、y1 和 y2 值。你在哪里初始化这些变量？

你所依赖的那些变量应该是在用鼠标点击的时候写的，但那可能不会发生。尝试在构造函数中初始化它们。

# javascript - JavaScript 中的 HTML“onclick”事件（在表格中）

> ID：11346436
> 
> 赞同：2
> 
> 时间：2012-07-05T14:28:53.090
> 
> 标签：javascript, html, html-table, onclick, document.write

我正在尝试将我用 HTML 编写的表格转换为 Javascript，因为我希望动态生成表格（行数）。我遇到的主要问题是表格中的各个单元格是可点击的并打开另一个 html 页面。不幸的是，html“onclick”参数不适用于`document.write`语句以下是 HTML 中表格单元格的示例：

```
<td id="r1c1" align="center" onclick="getTicket(1,'plan',1);"><script language="JavaScript">document.write(getDate(1,"plan", "r1c1")); </script></td> 
```

这一行中的函数是预定义的并且可以工作，所以我不打算发布这些函数，但想法是函数**getTicket(..)**假设打开另一个 html 页面。

我的问题是如何让 onclick 在 JavaScript 中工作。我可以使用 document.write 命令在 Javascript 中创建单元格，但我真的不知道如何使这些单元格可点击以运行函数**getTicket(..)**。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:38:11.157

至少可以说，您的 Javascript 编程风格是*古老的。*`document.write`是主要在几乎没有生成动态内容的通用方法时开发的功能。

因此，您应该使用类似的方法动态生成元素`document.createElement`，将内容附加到那里，然后使用现代方法（例如`appendChild`.

然后，您可以使用比传统方式更现代的方式附加事件侦听器`onclick`，例如`addEventListener`. 这是一个片段：

```
var td = document.createElement("td");
td.innerHTML = getDate(1, "plan", "r1c1");
td.addEventListener("click", function() {
    getTicket(1, 'plan', 1);
});
row.appendChild(td); 
```

我想那`row`是您正在生成的表格的行。

不幸的是，IE<9 使用了一个不同的方法叫做`attachEvent`，所以它变成了：

```
td.attachEvent("onclick", function() { ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:36:37.423

您可以使用函数[setAttribute(Attribute, Value)](http://www.javascriptkit.com/dhtmltutors/domattribute.shtml)修改 HTML 中的属性。

使用此功能，您可以生成单元代码并动态定义属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:37:12.970

您不应该使用`document.write`向您的页面添加元素，有 javascript 函数可以做到这一点：

```
var myCell = document.createElement('td');
myCell.setAttribute('id', 'r1c1');
myCell.setAttribute('align', 'center');
myCell.onclick = function () {
    getTicket(1, 'plan', 1);
};

// myRow is the 'tr' you want this 'td' to be a child of.
myRow.appendChild(myCell); 
```

在行动中看到它：http: [//jsfiddle.net/teH7X/1/](http://jsfiddle.net/teH7X/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T14:38:13.473

你能试试下面的代码吗，如果它有效，那么让我知道我会给你一些更好的选择：-

```
<script>
   document.onload = function()
   {
       document.getElementById('r1c1').onclick = function()
       {
           getTicket(1,'plan',1);
       }
   }
</script> 
```

请检查并让我知道。

# php - 将 CSV 导入 postgresql (Zend/PHP)

> ID：11346444
> 
> 赞同：0
> 
> 时间：2012-07-05T14:29:06.737
> 
> 标签：php, postgresql, zend-framework, postgresql-9.1

我想将测试数据加载到我的 postgresql 数据库中的表中。

我在我的单元测试类中这样做。

```
$this->Application_Model_UserMapper->getDbTable()->getAdapter()->query("COPY users FROM '" . APPLICATION_PATH . "/../tests/dbtestdata/users.csv' CSV HEADER NULL AS E'\N'"); 
```

我收到一条错误消息，说我必须是超级用户才能复制到文件和从文件中复制。这是否意味着我需要以 postgres 用户身份登录？我已经读过这可能会导致安全问题，所以我不热衷于这样做。

其他选项似乎是 \COPY，但以下不起作用..

```
$this->Application_Model_UserMapper->getDbTable()->getAdapter()->query("

  \COPY users FROM '" . APPLICATION_PATH . "/../tests/dbtestdata/users.csv' 
  CSV HEADER NULL AS E'\N'

"); 
```

我收到语法错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:30:44.050

\copy 由 PostgreSQL 客户端 psql 使用。SQL 语句 COPY 由用户 Postgres 完成，您的代码需要该用户或其他解决方案。

我真的很喜欢[pg_put_line](http://php.net/manual/en/function.pg-put-line.php)，然后你可以用 PHP 读取文件并将其流式传输到 PostgreSQL。

# ruby-on-rails - 无法将 BSON::ObjectId 转换为字符串

> ID：11346449
> 
> 赞同：0
> 
> 时间：2012-07-05T14:29:18.003
> 
> 标签：ruby-on-rails, mongodb, mongoid

所以............我有一个rails应用程序。rails 应用程序将 Mongoid 用于 mongodb 数据。当我通过 Web 表单创建 mongo 记录时，它们的 ID 为`string`. 当我使用 mongoimport 将记录导入 mongo 时，它们的 ID 为`BSON::ObjectId`.

rails 应用程序期望 mongo 记录 ID 是字符串，因此当我导入数据时，它会导致我的应用程序失败，因为当它查找记录时它会抱怨它`can't convert type BSON::ObjectId to string`

我在这里的许多层面上感到困惑。BSON::ObjectId 是 mongo 中 ID 的默认类型，所以我不明白为什么通过 rails 和 Mongoid 创建的记录有字符串 ID。我没有看到 Mongoid 指定 _id 字段应该是字符串的任何地方。有人有任何线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T17:20:38.950

您使用的是什么版本的 Mongoid？从这篇文章来看，直到一年前，Mongoid 还在使用字符串作为 _id，但现在一直使用 BSON::ObjectId 类型。

[mongodb：将对象 ID 转换为 BSON::ObjectId](https://stackoverflow.com/questions/6596814/mongodb-converting-object-ids-to-bsonobjectid)

它引用了这个要点，用于将带有 String _id 的旧文档转换为使用 BSON::ObjectId 类型的 _id。

当 Mongoid 将文档插入到集合中时，它期望并使用 BSON::ObjectId 类型。这是使用 Rails 控制台的示例：

> post = Post.new => # post.save => true post._id => BSON::ObjectId('4ff5bcb39ef1728393000002') post._id.class => BSON::ObjectId

Mongoid 似乎知道使用 BSON::ObjectId 类型查找 _id：

> Post.where(:_id => "4ff5bcb39ef1728393000002").count => 1
> 
> Post.where(:_id => BSON::ObjectId("4ff5bcb39ef1728393000002") ).count => 1

您是否有机会手动设置_id？如果是，那么您可能没有将 _id 设置为 BSON::ObjectId 类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T13:41:08.853

所以我想通了。问题在于我的应用程序使用的 Mongoid 版本。1.9.5 版使用字符串作为 _id 字段的默认类型，这就是我正在使用的。

我考虑过更新 Mongoid，但我担心旧的字符串 ID 会以某种方式破坏应用程序。

答案是使用 rails 应用程序以某种方式导入记录，以便旧版本的 Mongoid 负责插入记录。我创建了一个 rake 任务，它将解析 CSV 文件并将该文件中的记录插入我的应用程序环境中。

```
require 'csv'
require 'iconv'
namespace :deadline do
  desc "Import data from CSV file"
  task :import => :environment do
    CSV.parse(File.open("/tmp/deadlines.csv").read).map{ |row|
      app_deadline = OrgSpecific::ApplicationDeadline.create!(
        :name => row[2] + " " + row[3],
        :start_date => Date.strptime('1/1/2012', '%m/%d/%Y'),
        :deadline_date => Date.strptime(row[11], '%m/%d/%Y'),
        :term => row[2],
        :year => row[3],
        :comment => Iconv.conv("UTF8", "LATIN1", row[5]) + " : " + Iconv.conv("UTF8", "LATIN1", row[6])
      )
    }
  end
end 
```

瞧！我的 CSV 文件中的所有数据都已通过我的 rails 环境导入，这意味着我的 mongo 记录具有字符串类型的 _id。谢谢你们的帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:42:53.820

关于您的最后一段：MongoDB 的[规范](http://www.mongodb.org/display/DOCS/Object+IDs)要求使用 12 字节字符串。

# ruby-on-rails - 如何在 Rails 3 上配置 ferret 0.11.5-mswin32 和acts_as_ferret 0.4.4

> ID：11346452
> 
> 赞同：0
> 
> 时间：2012-07-05T14:29:23.757
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, windows-7

我正在使用 Rails 3，我想`ferret`在我的应用程序中使用。我安装了`ferret 0.11.5-mswin32`（因为我在 Windows 7 上工作）和`acts_as_ferret 0.4.4`.

在我的`Gemfile`我有：

```
gem 'ferret'   
gem 'acts_as_ferret' 
```

然后，当我启动服务器时，出现此错误：

```
Could not find gem 'ferret (>= 0)' in any of the gem sources listed in your Gemfile. 
```

我试过了

```
gem 'ferret', '0.11.5'   
gem 'acts_as_ferret', '0.4.4' 
```

我仍然得到同样的错误。

我需要什么才能让我的 Gemfile 开始`ferret`工作？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:38:16.813

act_as_ferret 上的文档规定您需要 0.5 或更高版本的 rails 3 和 ferret 0.11.8（我会使用 11.8.4，因为它是 4 年来 gem 的唯一版本......这有点红色旗帜）。

没有冒犯，但你为什么要使用雪貂？

几年前，这是一个好主意，但从那时起，其他搜索引擎得到了更好的采用和支持（sphinx、弹性搜索、solr）。

# javascript - 如何编写 JavaScript 正则表达式以仅允许字母和数字？

> ID：11346461
> 
> 赞同：1
> 
> 时间：2012-07-05T14:30:00.247
> 
> 标签：javascript, regex

我希望允许大写和小写。我试过了

```
'k abBcdi #!129'.replace(/^[A-Za-z0-9]/g,'') 
```

但这并没有给我正确的答案

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T14:31:32.160

您需要`^`在括号内使用 NOT 运算符 ( )：

```
/[^A-Za-z0-9]/g 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T14:33:35.737

也使用 [^0-9A-z] 代替。它可能几乎没有性能影响，但它更短更漂亮。

编辑：根据上面的评论，您是要查找所有字母和数字并替换它们还是删除不是字母和数字的所有内容？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:36:05.433

如果您不明确需要使用 not`^`运算符，您可以简单地使用特殊字符来识别所有非字母数字字符：

```
'k abBcdi #!129'.replace(/[\W]/g,'') 
```

或者，考虑到`\W`允许使用下划线 ( `_`)，它可能更适合使用：

```
'k abBcdi #!129'.replace(/(\W+)|(_)/g,'') 
```

参考：

*   [JavaScript 正则表达式](https://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions)。

# linux - Objdump -S 不显示Linux内核模块的源代码列表

> ID：11346473
> 
> 赞同：5
> 
> 时间：2012-07-05T14:30:25.943
> 
> 标签：linux, gcc, assembly, linux-device-driver, disassembly

我正在尝试从我的一个内核模块中调试崩溃；我正在尝试获取源代码列表以及 objdump 的输出，但它没有列出。有什么我想念的吗？

```
 mips-linux-objdump -S <filename.o> > temp 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:14:55.247

很可能是 a) 在构建过程中的某个时刻从内核模块目标文件中剥离了所有调试信息，或者 b) 即使有调试信息，也无法找到源代码文件，在这种情况下，`objdump`您可能会尝试`cd`运行前源文件所在的位置`objdump`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T17:16:40.030

您需要使用调试信息编译内核模块，以便在转储输出中包含交错的源代码。`-g -ggdb`使用for重新编译内核模块`CFLAGS`。

# android-layout - Android 片段中的 Admob

> ID：11346475
> 
> 赞同：1
> 
> 时间：2012-07-05T14:30:27.540
> 
> 标签：android-layout, android-fragments, admob, android-dialogfragment

我无法将 AdMob 放置在 ActionBarSherlock 片段中。由于在 Activity 中，ActionBar 不允许显示 xml 布局，但在片段类中引用了 xml 文件。

我遇到错误？如何将 AdMob 放入片段类。

# python - lxml：将命名空间添加到输入文件

> ID：11346480
> 
> 赞同：17
> 
> 时间：2012-07-05T14:30:46.530
> 
> 标签：python, xml, namespaces, lxml, sbml

我正在解析由外部[程序](http://celldesigner.org/)生成的 xml 文件。然后我想使用我自己的命名空间向这个文件添加自定义注释。我的输入如下所示：

```
<sbml xmlns="http://www.sbml.org/sbml/level2/version4" xmlns:celldesigner="http://www.sbml.org/2001/ns/celldesigner" level="2" version="4">
  <model metaid="untitled" id="untitled">
    <annotation>...</annotation>
    <listOfUnitDefinitions>...</listOfUnitDefinitions>
    <listOfCompartments>...</listOfCompartments>
    <listOfSpecies>
      <species metaid="s1" id="s1" name="GenA" compartment="default" initialAmount="0">
        <annotation>
          <celldesigner:extension>...</celldesigner:extension>
        </annotation>
      </species>
      <species metaid="s2" id="s2" name="s2" compartment="default" initialAmount="0">
        <annotation>
           <celldesigner:extension>...</celldesigner:extension>
        </annotation>
      </species>
    </listOfSpecies>
    <listOfReactions>...</listOfReactions>
  </model>
</sbml> 
```

问题是 lxml 仅在使用命名空间时声明它们，这意味着声明重复多次，如下所示（简化）：

```
<sbml xmlns="namespace" xmlns:celldesigner="morenamespace" level="2" version="4">
  <listOfSpecies>
    <species>
      <kjw:test xmlns:kjw="http://this.is.some/custom_namespace"/>
      <celldesigner:data>Some important data which must be kept</celldesigner:data>
    </species>
    <species>
      <kjw:test xmlns:kjw="http://this.is.some/custom_namespace"/>
    </species>
    ....
  </listOfSpecies>
</sbml> 
```

是否可以强制 lxml 在父元素中仅写入一次此声明，例如`sbml`or `listOfSpecies`？还是有充分的理由不这样做？我想要的结果是：

```
<sbml xmlns="namespace" xmlns:celldesigner="morenamespace" level="2" version="4"  xmlns:kjw="http://this.is.some/custom_namespace">
  <listOfSpecies>
    <species>
      <kjw:test/>
      <celldesigner:data>Some important data which must be kept</celldesigner:data>
    </species>
    <species>
      <kjw:test/>
    </species>
    ....
  </listOfSpecies>
</sbml> 
```

重要的问题是必须保留从文件中读取的现有数据，所以我不能只创建一个新的根元素（我认为？）。

编辑：附在下面的代码。

```
def annotateSbml(sbml_input):
  from lxml import etree

  checkSbml(sbml_input) # Makes sure the input is valid sbml/xml.

  ns = "http://this.is.some/custom_namespace"
  etree.register_namespace('kjw', ns)

  sbml_doc = etree.ElementTree()
  root = sbml_doc.parse(sbml_input, etree.XMLParser(remove_blank_text=True))
  nsmap = root.nsmap
  nsmap['sbml'] = nsmap[None] # Makes code more readable, but seems ugly. Any alternatives to this?
  nsmap['kjw'] = ns
  ns = '{' + ns + '}'
  sbmlns = '{' + nsmap['sbml'] + '}'

  for species in root.findall('sbml:model/sbml:listOfSpecies/sbml:species', nsmap):
    species.append(etree.Element(ns + 'test'))

  sbml_doc.write("test.sbml.xml", pretty_print=True, xml_declaration=True)

  return 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-05T18:08:32.257

在 lxml 中无法修改节点的命名空间映射。将此具有此功能的[未结票视为愿望清单项目。](https://bugs.launchpad.net/lxml/+bug/555602)

它起源于lxml 邮件列表上的[这个线程，其中给出了替代](https://mailman-mail5.webfaction.com/pipermail/lxml/20100323/thread.html#13258)[根节点](https://mailman-mail5.webfaction.com/pipermail/lxml/20100323/013260.html)的解决方法。但是，替换根节点存在一些问题：请参阅上面的票证。

为了完整起见，我将建议的根替换解决方法代码放在这里：

```
>>> DOC = """<sbml xmlns="http://www.sbml.org/sbml/level2/version4" xmlns:celldesigner="http://www.sbml.org/2001/ns/celldesigner" level="2" version="4">
...   <model metaid="untitled" id="untitled">
...     <annotation>...</annotation>
...     <listOfUnitDefinitions>...</listOfUnitDefinitions>
...     <listOfCompartments>...</listOfCompartments>
...     <listOfSpecies>
...       <species metaid="s1" id="s1" name="GenA" compartment="default" initialAmount="0">
...         <annotation>
...           <celldesigner:extension>...</celldesigner:extension>
...         </annotation>
...       </species>
...       <species metaid="s2" id="s2" name="s2" compartment="default" initialAmount="0">
...         <annotation>
...            <celldesigner:extension>...</celldesigner:extension>
...         </annotation>
...       </species>
...     </listOfSpecies>
...     <listOfReactions>...</listOfReactions>
...   </model>
... </sbml>"""
>>> 
>>> from lxml import etree
>>> from StringIO import StringIO
>>> NS = "http://this.is.some/custom_namespace"
>>> tree = etree.ElementTree(element=None, file=StringIO(DOC))
>>> root = tree.getroot()
>>> nsmap = root.nsmap
>>> nsmap['kjw'] = NS
>>> new_root = etree.Element(root.tag, nsmap=nsmap)
>>> new_root[:] = root[:]
>>> new_root.append(etree.Element('{%s}%s' % (NS, 'test')))
>>> new_root.append(etree.Element('{%s}%s' % (NS, 'test')))

>>> print etree.tostring(new_root, pretty_print=True)
<sbml xmlns:celldesigner="http://www.sbml.org/2001/ns/celldesigner" xmlns:kjw="http://this.is.some/custom_namespace" xmlns="http://www.sbml.org/sbml/level2/version4"><model metaid="untitled" id="untitled">
    <annotation>...</annotation>
    <listOfUnitDefinitions>...</listOfUnitDefinitions>
    <listOfCompartments>...</listOfCompartments>
    <listOfSpecies>
      <species metaid="s1" id="s1" name="GenA" compartment="default" initialAmount="0">
        <annotation>
          <celldesigner:extension>...</celldesigner:extension>
        </annotation>
      </species>
      <species metaid="s2" id="s2" name="s2" compartment="default" initialAmount="0">
        <annotation>
           <celldesigner:extension>...</celldesigner:extension>
        </annotation>
      </species>
    </listOfSpecies>
    <listOfReactions>...</listOfReactions>
  </model>
<kjw:test/><kjw:test/></sbml> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-07-26T08:33:11.813

我知道这是个老问题，但它仍然有效，从 lxml 3.5.0 开始，这个问题可能有更好的解决方案：

> `cleanup_namespaces()`接受一个新参数`top_nsmap`，它将提供的前缀命名空间映射的定义移动到树的顶部。

所以现在命名空间映射可以通过简单的调用来上移：

```
nsmap = {'kjw': 'http://this.is.some/custom_namespace'}
etree.cleanup_namespaces(root, top_nsmap=nsmap) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-06T07:02:45.953

除了直接处理原始 XML，您还可以查看[LibSBML](http://sbml.org/Software/libSBML)，这是一个用于操作 SBML 文档的库，其中包含 python 的语言绑定。在那里你会像这样使用它：

```
>>> 从 libsbml 导入 *
>>> doc = readSBML('Dropbox/SBML 模型/BorisEJB.xml')
>>> 物种 = doc.getModel().getSpecies('MAPK')
>>> species.appendAnnotation('<kjw:test xmlns:kjw="http://this.is.some/custom_namespace"/>')
0
>>> 物种.toSBML()
'<物种 id="MAPK" 隔间="隔间" initialConcentration="280" boundaryCondition="false">\n <注释>\n
 <kjw:test xmlns:kjw="http://this.is.some/custom_namespace"/>\n </annotation>\n</species>'
>>>

```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-18T04:36:43.470

如果您临时将命名空间属性添加到根节点，那就可以了。

```
ns = '{http://this.is.some/custom_namespace}'

# add 'kjw:foobar' attribute to root node
root.set(ns+'foobar', 'foobar')

# add kjw namespace elements (or attributes) elsewhere
... get child element species ...
species.append(etree.Element(ns + 'test'))

# remove temporary namespaced attribute from root node
del root.attrib[ns+'foobar'] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-02-06T22:04:54.150

我编写了这个函数来为根元素添加一个命名空间：

```
def addns(tree, alias, uri):                
    root = tree.getroot()
    nsmap = root.nsmap
    nsmap[alias] = uri
    new_root = etree.Element(root.tag, attrib=root.attrib, nsmap=nsmap)
    new_root[:] = root[:]
    return new_root.getroottree() 
```

应用此功能后，您将获得一棵新树，但您可能可以从访问树的单个对象更改树实例 [*……因为您拥有强大的 OO 设计！*].

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-05T17:36:28.927

您可以替换根元素以将“kjw”添加到其 nsmap。然后 xmlns 声明将仅在根元素中。

# database - 非规范化数据库上的休眠逆向工程

> ID：11346484
> 
> 赞同：1
> 
> 时间：2012-07-05T14:31:18.663
> 
> 标签：database, spring, hibernate, jdbc, pojo

是否可以在非规范化数据库上使用逆向工程？为数据库中的所有表生成 Pojo 类的休眠逆向工程似乎不起作用，因为这些表中没有任何主键或外键。解决方案是什么？

我是使用 Netbeans 完成的，错误是无法生成 Pojo 类，因为表没有主键。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T13:43:24.530

在使用该工具之前在数据库中创建主键/外键。也许在原始数据库的克隆中。除此之外，您只能自己编写映射。

# msbuild - Jenkins 多配置作业和 MSBuild

> ID：11346485
> 
> 赞同：1
> 
> 时间：2012-07-05T14:31:22.557
> 
> 标签：msbuild, continuous-integration, hudson, jenkins

我正在寻找一种将用户定义的轴值传递给使用 MSBuild 的自由式作业的方法。让我解释。

所以我们有 JobA，它是一个多配置项目，只有一个轴（key1）和多个值（foo 和 bar）。我还有一个名为 JobB 的自由式工作，它使用 MSBuild 在解决方案中*构建*特定项目。

我想知道如何将 JobA 的轴（key1）的值（foo 和 bar）传递给 JobB，以便 JobB 可以在 MSBuild 插件的命令行参数中使用它。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:09:22.603

您最好的选择是参数化触发器插件：

[https://wiki.jenkins-ci.org/display/JENKINS/Parameterized+Trigger+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Parameterized+Trigger+Plugin)

您可以在 JobA 中使用它（我相信作为构建后操作）来设置 JobB 构建的触发器。这样，您可以将 foo 和 bar 传递给 JobB 的变量，并在命令行上使用它们。

# iphone - 检测用户是否仍然保持触摸并且没有释放

> ID：11346487
> 
> 赞同：0
> 
> 时间：2012-07-05T14:31:26.130
> 
> 标签：iphone, objective-c, cocoa

我想检测用户触摸释放，如果用户按住它，下面的代码

有效，但不要告诉我我是否正在握住（触摸并按住而不释放）触摸......

请帮我解决这个问题

```
[imageview setUserInteractionEnabled:YES];
UITapGestureRecognizer *singleTap =  [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(holdAction:)];
[singleTap setNumberOfTapsRequired:1];
[imageview addGestureRecognizer:singleTap];

- (void)holdAction:(UIGestureRecognizer *)holdRecognizer
{
    if (holdRecognizer.state == UIGestureRecognizerStateBegan) {

       NSLog(@"Holding Correctly. Release when ready.");

    } else if (holdRecognizer.state == UIGestureRecognizerStateEnded)
    {
       NSLog(@"You let go!");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:39:53.323

用`-touchesBegan:withEvent:`and`-touchesEnded:withEvent:`方法来做。

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    self.isHolding = YES;
}

-(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    self.isHolding = NO;
} 
```

self.isHolding 是一个`@property (nonatomic, assign) BOOL isHolding;`
**注意事项**：在这些方法中，您可能需要执行额外的检查，如果触摸开始于特定视图以及它们已经结束的位置。
**更新**：相应地更改您的代码：

```
[imageview setUserInteractionEnabled:YES];
UILongPressGestureRecognizer *longPress =  [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(holdAction:)];
[imageview addGestureRecognizer:longPress];

- (void)holdAction:(UILongPressGestureRecognizer *)holdRecognizer
{
    if (holdRecognizer.state == UIGestureRecognizerStateBegan) {

       NSLog(@"Holding Correctly. Release when ready.");

    } else if (holdRecognizer.state == UIGestureRecognizerStateEnded)
    {
       NSLog(@"You let go!");
    }
} 
```

# c# - 有没有办法禁止 smtp 透明转发？

> ID：11346493
> 
> 赞同：2
> 
> 时间：2012-07-05T14:31:40.050
> 
> 标签：c#, smtp

问题步骤：

*   我的公司向外部合作伙伴发送邮件（使用 .Net SmtpClient），
*   他们中的一些人在我们的邮件上设置了“透明转发”给他们的一些同事，
*   那些同事收到我们的邮件，就好像我们直接将它们发送给他们一样（没有“代表”，没有来自原始“收件人”邮箱的经典“转发”），不知道哪个邮箱透明地转发了他们邮件。
    （事实上​​，邮件属性中的 smtp 会话跟踪可以找到它，但大多数用户的技术不够精通，无法访问此类信息，我们也不知道如何向他们解释如何处理所有类型的邮件我们的合作伙伴可能使用的客户），
*   其中一些同事向我们抱怨我们正在向他们发送垃圾邮件。如果他们无法将违规邮件原封不动地发送给我们（通常作为附件，保留 smtp 对话痕迹），我们将无助于确定他们通过何种方式收到了原本不是发给他们的邮件。

有没有办法使用 SmtpClient 设置一些禁止“透明转发”的属性？

我不想禁止正常转发或复制，如[如何防止 Lotus Notes 用户转发或复制通过 System.Net.Mail 发送的消息？](https://stackoverflow.com/questions/3962663/how-do-i-prevent-lotus-notes-users-from-forwarding-or-copying-a-message-sent-via)问题。
我只是想禁止“透明转发”（恕我直言，这是 MS Exchange 等某些邮件系统的一个非常糟糕的功能，它在其规则选项中提供了两种转发方式，一种是“透明”）。

由于这个功能在我看来不符合 smtp RFC，我真的担心答案是否定的或几乎没有。
但是，如果您知道在某些确实提供透明转发功能的邮件系统上有一些自定义标头用于禁止此操作，那么如果它们可以使用 SmtpClient 进行设置，它可能对我仍然有一些帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:54:26.557

如果您正在尝试解决不知道邮件的原始收件人是谁的问题，请尝试在邮件正文中添加一行类似这样的内容...

“此邮件的目的是（在此处插入收件人）。”

您可以使其可见，以便用户可以看到原始收件人是谁，或者（如果可以）将其设置为超小字体，以便您可以将其用于故障排除/垃圾邮件声明说明目的。

# sql-server - 在 SSMS 中将 SSIS 包导入 MSDB 时出错

> ID：11346496
> 
> 赞同：1
> 
> 时间：2012-07-05T14:31:42.693
> 
> 标签：sql-server, ssis, sql-server-2008-r2, ssms

当我尝试在 SSMS 中将包导入 MSDB 时出现此错误，我猜它与角色有关？但是我在哪里改变这个？

![在此处输入图像描述](../Images/cdac939c0098b85568ee8fdf3fa7d8db.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:45:16.590

看起来您需要将自己添加到 SSIS 固定角色之一（请参阅[http://msdn.microsoft.com/en-us/library/ms141053(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms141053(v=sql.105).aspx)）

# c# - 在我的国际象棋游戏中显示移动的棋子滞后，我该怎么办？

> ID：11346502
> 
> 赞同：0
> 
> 时间：2012-07-05T14:31:56.453
> 
> 标签：c#, optimization, lag, chess

我第一次在这里问一个问题，如果我做错了，请纠正我。

我的国际象棋图片： [![](../Images/f92b9dd28dc81cf09637abf74f42c148.png)](https://i.stack.imgur.com/ACNDl.jpg)

每次我移动一块它都会滞后大约 1 秒钟。每一块和瓷砖都有一个图像，并且正好有 96 个图像。每次我移动一块时，它都会用黑色清除所有内容，然后更新图形。

在国际象棋的早期阶段，我没有任何图像，而是使用了不同的颜色，只有少数棋子没有明显的滞后，棋子瞬间移动。

```
 public void updateGraphics(PaintEventArgs e, Graphics g, Bitmap frame)
    {
        g = Graphics.FromImage(frame);
        g.Clear(Color.Black);

        colorMap(g);

        g.Dispose();
        e.Graphics.DrawImageUnscaled(frame, 0, 0);
    } 
```

函数 colorMap(g) 如下所示：

```
 private void colorMap(Graphics g)
    {
        for (int y = 0; y < SomeInts.amount; y++)
        {
            for (int x = 0; x < SomeInts.amount; x++)
            {
                //Tiles
                Bundle.tile[x, y].colorBody(g, x, y);

                //Pieces
                player1.colorAll(g);
                player2.colorAll(g);
            }
        }
    } 
```

colorAll 函数执行每件 colorBody(g) 函数，如下所示：

```
 public void colorBody(Graphics g)
    {
        //base.colorBody() does the following: body = new Rectangle(x * SomeInts.size + SomeInts.size / 4, y * SomeInts.size + SomeInts.size / 4, size, size);
        base.colorBody();

        if (team == 1)
        {
            //If its a white queen
            image = Image.FromFile("textures/piece/white/queen.png");
        }
        if (team == 2)
        {
            //If its a black queen
            image = Image.FromFile("textures/piece/black/queen.png");
        }
        g.DrawImage(image, body);
    } 
```

最后是移动作品的功能：

```
 public void movePiece(MouseEventArgs e)
    {
        for (int y = 0; y < SomeInts.amount; y++)
        {
            for (int x = 0; x < SomeInts.amount; x++)
            {
                if (Bundle.tile[x, y].body.Contains(e.Location))
                {
                    //Ignore this
                    for (int i = 0; i < queens.Count; i++)
                    {
                        Queen temp = queens.ElementAt<Queen>(i);
                        temp.move(x, y);
                    }
                    //Relevant
                    player1.move(x, y);
                    player2.move(x, y);
                }
            }
        }
    } 
```

感谢您阅读这一切！如果我的编码示例还不够，我可以链接到整个程序。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T14:36:52.357

您`Image.FromFile`在每次刷新时调用每个图像 - 每次都从磁盘有效地重新加载每个图像文件。

您是否考虑过加载图像*一次*，并将生成`Image`的 s 存储在有用的地方？（比如说，一个数组`Image[2,6]`就足够了）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T14:36:57.427

为什么每次都重绘棋盘？您不能将板留在原处并在其上显示具有透明背景的图像吗？这样你就有一个图像作为背景（棋盘），再加上 64 个较小的图像以网格的形式放置在棋盘上，并且每次移动时只需更改显示的图像。

这样，您可以让窗口处理绘图...

此外，在应用程序开始时加载碎片的图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T15:32:52.293

除了不在`Image.FromFile()`内部调用`updateGraphics()` *（这绝对是您最大的问题）*，您不应该在每次调用时都尝试重新绘制整个电路板`updateGraphics()`- 大多数情况下，只有一小部分电路板将无效。

`PaintEventArgs`包含一个参数 ，它指定板的`ClipRectangle`哪个部分需要重绘。看看您是否无法确定哪些图块与该矩形相交，并且只重绘这些图块:)

*提示：编写一个函数，该函数`Point ScreenToTileCoords(Point)`接受屏幕坐标并返回哪个棋盘图块位于该坐标处。然后，您需要重绘的唯一瓷砖是*

```
Point upperLeftTileToBeDrawn = ScreenToTileCoords(e.ClipRectangle.Left, e.ClipRectangle.Top);
Point lowerRightTileToBeDrawn = ScreenToTileCoords(e.ClipRectangle.Right - 1, e.ClipRectangle.Bottom- 1); 
```

* * *

此外，请确保您的控件是双缓冲的，以避免撕裂。这比上述评论中@Steve B 的链接简单得多；假设这是一个`UserControl`，简单地设置

```
this.DoubleBuffered = true; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T14:37:05.550

那么，这个呢：

不要清除整个电路板，而只清除需要清除的部分。

选择：

更新到 WPF - 它将绘图移动到图形卡 - 并且只是以一种智能的方式移动各个部分（即，每个部分都有一个控件/对象）。

# sql - Oracle DateTime 算术不一致

> ID：11346503
> 
> 赞同：0
> 
> 时间：2012-07-05T14:31:59.540
> 
> 标签：sql, oracle, time

我有一个查询，它创建一个包含日期后接下来 24 小时内每一分钟的列。

```
(SELECT   TO_DATE ('05/07/2012 15:00:00', 'DD/MM/YYYY HH24:MI:SS')
                 + (ROWNUM / 1440)
                    AS foo
          FROM   (    SELECT   (ROWNUM - 1)
                        FROM   DUAL
                  CONNECT BY   LEVEL <= 1336)); 
```

foo 的第一行是 15:01。这对我来说似乎是错误的。

所以我自己运行了子查询：

```
SELECT (ROWNUM - 1) FROM DUAL CONNECT BY LEVEL <= 1336; 
```

它按预期返回 0,1,2,3,4 等。于是我再次运行子查询但除以1440，第一个值还是0。

所以我认为可能在时间戳中添加 0 会导致一些奇怪，所以我跑了

```
SELECT TO_DATE ('05/07/2012 15:00:00', 'DD/MM/YYYY HH24:MI:SS') + (0/1440) FROM DUAL; 
```

仍然得到`05/06/2012 15:00:00`

那么为什么再次组合这个备份会导致第一个值是 15:01？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:42:05.690

原因外部查询中的 ROWNUM 第一次是 1，而不是零。

# android - 通过 Wi-Fi 使用 Android 控制继电器

> ID：11346504
> 
> 赞同：0
> 
> 时间：2012-07-05T14:31:59.770
> 
> 标签：android, embedded, arduino

如何使用 Android 和 Wi-Fi 连接打开或关闭开关？

我使用 SparkFuns IOIO 来控制继电器。但是我如何通过无线方式做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T17:42:14.557

您也可以使用[Rugged Circuits Yellowjacket](http://ruggedcircuits.com/html/yellowjacket.html "黄夹克")。它有一个板载 Wifi，可以提供简单的网页和控制输入/输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:40:00.543

您可以使用带有以太网屏蔽的 Arduino - 或者可能是 Netduino。基本上，任何具有无线互联网功能的设备，因为这是 Android 使用的唯一无线协议 - 除了蓝牙（或 NFC）。当用户按下按钮时，您可以打开 a`Socket`或 a`BluetoothSocket`以与第二个设备通信它需要打开开关。相当简单——如果你有一个无线家庭网络，那么你的设备可以通过物理线插入你的路由器——只要你的安卓设备和你的微处理器在同一个网络上。您可能还可以使用其他无线选项——这些只是我能想到的最简单的。希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:41:19.517

这就是为什么我用我的 iPhone 做的（在 Android 上应该是一样的）：

*   在与手机连接到同一网络并通过 USB/串行连接到 Arduino 的计算机上运行 TCP 服务器。
*   此服务器应将所有通过 Wi-Fi 从您的 Android 手机通过 USB 传入的数据转发到 Arduino。
*   手机应该运行一个 TCP 客户端，它发送一个简单的单字节（可能是零和非零）命令
*   应对 Arduino 进行编程，使其通过中断侦听传入的串行数据；如果一个字节到达，它决定是否应该打开或关闭 I/O 引脚。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T15:04:35.147

我有一个像这样的项目。我的正在发送转向系统的位置数据，但想法是一样的。我很快就会把它上传到[谷歌代码](http://en.wikipedia.org/wiki/Google_Code)。您可以在*[PowerWheelino](http://code.google.com/p/power-wheelino/source/browse/#svn/trunk/0.1a/client/android/src/com/powerwheelino)*上查看。

基本结构是这样的：

1.  Android 上的触摸事件将数据（通过[UDP](http://en.wikipedia.org/wiki/User_Datagram_Protocol)）发送到服务器。
2.  UDP 服务器（本例中为[WRT54G](http://en.wikipedia.org/wiki/Linksys_WRT54G_series)路由器）接收数据并通过串行方式将其转发到 Arduino。
3.  Arduino 决定如何处理来自串行连接的数据。

请记住，当通过串行（IDE 串行接口之外）接收数据时，Arduino 会自动重置。[请在此处](https://stackoverflow.com/a/10921900/1440715)查看我关于此主题的帖子以及解决此问题的方法。以前知道这一点可以为我节省很多故障排除。

**免责声明：**

此代码需要一些小的修改才能完成 OP 的要求。由于您已经使用 IOIO 和 Arduino 草图制作了一个有效的 Android 程序，我认为这在您的能力范围内。

**这是 Android UDP 客户端代码：**

`UdpClient::sendData()`在触摸事件或按钮按下时执行。

```
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;

import android.util.Log;

public class UdpClient {
    String messageStr;
    DatagramSocket s;;
    int server_port;
    InetAddress local;
    int msg_length;
    byte[] message;

    public UdpClient (String ipAddress, int port){
        server_port = port;
        try {
            local = InetAddress.getByName(ipAddress);
            s = new DatagramSocket();
        }
        catch (Exception e) {
            e.printStackTrace();
            Log.d("Powerwheelino",e.getStackTrace() + "error");
        }
    }

    public boolean sendData(byte drive, byte steering){
        byte drvByte = (byte) (drive & 0xFF);
        byte steerByte = (byte) (steering & 0xFF);
        message = new byte[2];
        message[0] = drvByte;
        message[1] = steerByte;
        msg_length = message.length;
        //message = messageStr.getBytes();
        try {
            DatagramPacket p = new DatagramPacket(message, msg_length,local,server_port);
            s.send(p);
        }
        catch (Exception e) {
            // TODO Auto-generated catch block
            Log.d("Powerwheelino", e.getStackTrace() +"ERROR ");
            e.printStackTrace();
            return false;
        }
        return true;
    }
} 
```

**这是侦听 UDP 服务器 (C++) 代码**

```
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <stdio.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>
#include <stdlib.h>
#include <string>
#include <SerialStream.h>

using namespace std;

class udp_server {
    int sock;
    int bytes_read;
    socklen_t addr_len;

    struct sockaddr_in server_addr , client_addr;

    public:
        udp_server(int portNum)
        {
            if ((sock = socket(AF_INET, SOCK_DGRAM, 0)) == -1) {
                perror("Socket");
                exit(1);
            }

            server_addr.sin_family = AF_INET;
            server_addr.sin_port = htons(portNum);
            server_addr.sin_addr.s_addr = INADDR_ANY;
            bzero(&(server_addr.sin_zero),8);

            if (bind(sock,(struct sockaddr *)&server_addr,
                sizeof(struct sockaddr)) == -1)
            {
                perror("Bind");
                exit(1);
            }

            addr_len = sizeof(struct sockaddr);

            printf("\nUDPServer Waiting for client on port %d", portNum);
                fflush(stdout);
        }

        int listen(char recv_data[]) {
            while (1)
            {
                bytes_read = recvfrom(
                                 sock,
                                 recv_data,
                                 1024,
                                 0,
                                 (struct sockaddr *)&client_addr,
                                 &addr_len
                             );

                recv_data[bytes_read] = '\0';
                printf("\n(%s , %d) said : ",inet_ntoa(client_addr.sin_addr),
                                             ntohs(client_addr.sin_port));
                printf("%s", recv_data);
                string drive;
                string direction;
                int speed, angle;

                if ((recv_data[0] & 128) > 0) {
                    drive = "Fwd";
                }
                else {
                    drive = "Rev";
                }
                if ((recv_data[1] & 128) > 0) {
                    direction = "Left";
                }
                else {
                    direction = "Right";
                }
                speed = recv_data[0] & 127;
                angle = recv_data[1] & 127;
                printf("\t %s @ %d and %s @ %d",
                        drive.c_str(),
                        speed,
                        direction.c_str(),
                        angle);
                fflush(stdout);
            }
            return 0;
        }
}; 
```

**这是使用 LibSerial 与 Arduino 进行串行通信的片段：**

```
LibSerial::SerialStream myss;
SerialComm(int argc, char** argv) {
    myss = new LibSerial::SerialStream("/dev/ttyS0", ios_base::out);
    myss.SetBaudRate(LibSerial::SerialStreamBuf::BAUD_57600);
    myss.SetCharSize(LibSerial::SerialStreamBuf::CHAR_SIZE_8);
    myss.SetFlowControl(LibSerial::SerialStreamBuf::FLOW_CONTROL_NONE);
    myss.SetParity(LibSerial::SerialStreamBuf::PARITY_NONE);
    myss.SetNumOfStopBits(1);

    const int Dsize = 2;
    char buffer[1];
    buffer[0] = 125; //0b00000001;
    buffer[1] = '\0';
    bitset(buffer[0]);
    //myss << buffer;
    myss.write(buffer,1);
    //myss.Close();
} 
```

# html - 如何编写一个简单的 JQuery 整数除法函数

> ID：11346506
> 
> 赞同：0
> 
> 时间：2012-07-05T14:32:23.803
> 
> 标签：html, ajax, math, jquery

我的网页显示从我们的 PI 服务器（历史服务器）每 10 秒更新一次的实时数据。我最近的任务是获取两个已经显示在我的页面上的数据，并将它们分开，在图表上显示新结果。我对 AJAX/JQuery 的经验很少，所以我想知道是否有人可以帮我一把？

澄清：

假设-

假设我的页面上显示了“成绩数”和“成绩总和”作为基本整数。它们每 10 秒从服务器更新一次。我想获取这两条实时数据，将它们分开，然后显示结果（在这种情况下，它将是总体平均成绩）。因此，我的页面将显示每 10 秒实时更新的成绩数、成绩总和和平均成绩。

我不清楚 JQuery 是否可以简单地从服务器中取出这些值并对它们执行除法并返回一个值，或者是否需要采取其他步骤来实现这一点。我在这里完全是在黑暗中拍摄，因此对于任何含糊不清或缺乏所需信息，我深表歉意。谢谢。下面给出了一些示例代码：

```
<span class = 'PIdata' data-tag = 'NumOfGrades' data-on_pi_change = 'NumOfGradeChange'></span>

<span class = 'PIdata' data-tag = 'SumOfGrades' data-on_pi_change = 'SumOfGradeChange'></span> 
```

我想显示一个将 NumOfGrades 除以 SumOfGrades 的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:47:19.837

[使用 jQuery 的简单数学 - 除法](https://stackoverflow.com/questions/7799438/simple-maths-with-jquery-division)

上面的链接似乎有你问题的答案！基本上只需通过您设置的 id 访问数字，获取值，将它们解析为整数或浮点数，执行计算，然后将值存储到您希望它出现的位置！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:56:31.917

```
var sumOfGrades = parseFloat($.('#SumOfGradesId').text());
var numberOfGrades = parseFloat($.('#NumberOfGradesId').text());

var result = fn(sumOfGrades , numberOfGrades);

$.('#AverageGradeId').text(result); 
```

这将设置所需的值。

# java - 使用 Jackson Java 解析 JSON

> ID：11346514
> 
> 赞同：0
> 
> 时间：2012-07-05T14:32:49.053
> 
> 标签：java, json, string, parsing, jackson

使用 Jackson 解析 JSON 时遇到问题。我有一个[POJO](http://en.wikipedia.org/wiki/Plain_Old_Java_Object)对象，由另一个对象包裹。

这是我的代码：

```
in main:
ObjectMapper mapper = new ObjectMapper();

List<ItemBean> mpl2 = mapper.readValue(col.toString(),new TypeReference<List<ItemBean>>() {});
my POJO class:

public class ItemBean implements Serializable {
    private List<Item> items;
    @JsonProperty("Item")
    public List<Item> getItems() {
        return items;
    }
    public void setItems(List<Item> items) {
        this.items = items;
    }
}

public class Item implements Serializable{
    public String field1;
    public Integer field2;

    public static final class Field3 extends GenericJson {
        private String subfield1;
        private String subfield2;
    }
} 
```

这是抛出的异常：

```
org.codehaus.jackson.map.exc.UnrecognizedPropertyException: Unrecognized field "item" (Class bean.item), not marked as ignorable
 at [Source: java.io.StringReader@101b6d56; line: 4, column: 16] (through reference chain: bean.ItemBean["items"]->bean.Item["item"]) 
```

JSON 看起来是这样的：

```
["{\n
            \"items\":
        [
        \n  {
        \n \"item\": {
        \n    \"field1\": \"val1\",
        \n    \"field2\": \"val2\",
        \n    \"field3\": [
                        \n     {
                        \n      \"subfield1\": subval
                         \n      \"subfield2\": subval
                        \n     }
                        \n    ]
                        \n   }
                        \n  },
        \n \"item\": {
        \n    \"field1\": \"val1\",
        \n    \"field2\": \"val2\",
        \n    \"field3\": [
                        \n     {
                        \n      \"subfield1\": subval
                         \n      \"subfield2\": subval
                        \n     }
                        \n    ]
                        \n   }
                        \n  },
        \n \"item\": {
        \n    \"field1\": \"val1\",
        \n    \"field2\": \"val2\",
        \n    \"field3\": [
                        \n     {
                        \n      \"subfield1\": subval
                         \n      \"subfield2\": subval
                        \n     }
                        \n    ]
                        \n   }
                        \n  },

etc......   may I haven't closed brackets correctly, but they are correct :)
            }
        ]
    "] 
```

POJO 完全重复 JSON 对象的字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:27:21.587

我编写了自己的方法，它解析这种结构的 JSON。

这是代码：

```
public static List parseList(String jsonInput, Class clazz) {
    List result = new LinkedList();
    JSONArray json = (JSONArray) JSONSerializer.toJSON(jsonInput);
    JSONObject items = (JSONObject)json.getJSONObject(0);
    JSONArray dataArrayJSON = (JSONArray)items.getJSONArray("items");

    for (int i = 0; i < dataArrayJSON.size(); i++) {
        result.add(JSONObject.toBean(dataArrayJSON.getJSONObject(i).getJSONObject("item"), clazz));
    }
    return result;
} 
```

问题是项目在数组中，而项目是唯一的元素。items 反过来也是一个数组，因此我使用了`dataArrayJSON.getJSONObject(i).getJSONObject("item")`构造。

# regex - 协助正则表达式

> ID：11346521
> 
> 赞同：0
> 
> 时间：2012-07-05T14:33:20.000
> 
> 标签：regex

我不擅长正则表达式，我可以在我正在处理的几个表达式上使用一些帮助。我有一行文字，例如`Text here then 999-99`，我想在最后隔离那个数字序列。它可以是`999-99`或`999-99-9`。以下似乎有效：

```
\d{3}-\d{2}(-\d{1})? 
```

但我注意到它似乎只是在文本中的任何位置进行搜索，因为我可以在数字序列之后添加文本并且它仍然匹配。这需要更严格，以便该行必须以这个确切的顺序结束，并且在它之后没有任何内容。我尝试以`$`而不是结尾`?`，但这似乎永远不会创建匹配项（*它总是返回 false*）。

我还可以在字符替换方面使用一些帮助。我正在开发一个处理 OCR 扫描的程序，有时返回的字符串值包含无法显示的字符，由`܀`符号表示。是否有正则表达式可以`܀`用空格替换字符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:39:09.300

试试这个正则表达式。

```
([\d-]+)$ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:39:25.070

这应该有效。只需用`$`. 它代表行尾

`\d{3}-\d{2}(-\d{1})?$`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:38:33.667

使用词边界元字符，`\b`：

```
\b\d{3}-\d{2}(-\d)?\b 
```

您也可以`{1}`从最后一个中删除它，`\d`因为它是多余的。

# java - Socket.IO Java 客户端到 Jar

> ID：11346527
> 
> 赞同：1
> 
> 时间：2012-07-05T14:33:39.337
> 
> 标签：java, android, jar, socket.io

我正在尝试将 Socket.IO Java 客户端编译为 JAR 文件，但没有运气。我需要它让 Android 项目与 Node.JS Socket.IO 通信。

Socket.IO Java 客户端是这个：[https ://github.com/Gottox/socket.io-java-client](https://github.com/Gottox/socket.io-java-client)

我这样做就像它在 github wiki 中所说的那样，但没有运气：

```
cd $PATH_TO_SOCKETIO_JAVA
ant jar
ls jar/socketio.jar 
```

我尝试过：Java Sun 6、Java Sun 7 和 Java Open 6（JDK、JRE）

我注意到，该`build.xml`文件不包含应有的所有路径。例如 eclipse 目录的路径。所以我该怎么做。也许我可以以其他方式构建罐子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:24:15.263

在撰写本文时，github 中的 build.xml 不再具有目标*jar*或任何构建 jar 的任务。最新版本的自动生成的 build.xml 似乎已经放弃了*jar*任务。查看 build.xml 的历史，一些较旧的文件有*jar*任务。也许您可以复制该任务并将其包含在最新版本中。

**@HeatfanJohn**：这是我添加`build.xml`到允许`ant jar`成功构建的代码`socketio.jar`

```
 <target name="jar" depends="build-project">
            <mkdir dir="jar"/>
            <jar destfile="jar/socketio.jar" basedir="bin">
                <zipgroupfileset dir="libs/" includes="*.jar"/>
                <manifest>
                </manifest>
            </jar>
    </target> 
```

# ssl - 在 WebLogic 11g 中为 Web 服务请求接受运行时指定的 SSL 证书

> ID：11346530
> 
> 赞同：1
> 
> 时间：2012-07-05T14:33:51.083
> 
> 标签：ssl, ssl-certificate, weblogic11g, jax-rpc

在我们的应用程序中，我们需要根据存储在数据库中的 URL 和受信任的 SSL 证书调用多个 Web 服务器。这些证书是自签名的，但我们无法将它们添加到 WebLogic 信任库中。这是 2-way SSL 但我们的服务器拒绝远程证书。

这样做的正确方法是什么？

（问题的其余部分描述了我们已经尝试过的内容。）

* * *

在 WebLogic 10g 中，我们曾经执行以下操作：

```
 WlsSSLAdapter adapter = new WlsSSLAdapter();
    try {
        // setup for client certificate
        adapter.setKeystore(…);
        adapter.setClientCert(…);
        // setup for accepting the remote certificate
        adapter.setTrustManager(new TrustManager() {
            @Override
            public boolean certificateCallback(X509Certificate[] paramArrayOfX509Certificate, int paramInt) {
                return paramArrayOfX509Certificate[0] == expectedCertificate;
            }
        });
    } catch (Exception e) {
        throw new RuntimeException(e);
    }
    ((weblogic.wsee.jaxrpc.StubImpl) servicePort)._setProperty(weblogic.wsee.jaxrpc.WLStub.SSL_ADAPTER, adapter); 
```

然而，在 WebLogic 11g 中，即使`TrustManager`调用了（我们使用调试器进行了检查），WebLogic 也会拒绝证书：

```
<validationCallback: validateErr = 16> 
<  cert[0] = Serial number: 9232073310112809071929676484517784211
    Issuer:C=US, ST=MyState, L=MyTown, O=MyOrganization, OU=FOR TESTING ONLY, CN=mestoudi2
    Subject:C=US, ST=MyState, L=MyTown, O=MyOrganization, OU=FOR TESTING ONLY, CN=mestoudi2
    Not Valid Before:Tue Nov 01 14:33:31 CET 2011
    Not Valid After:Sun Nov 02 14:33:31 CET 2031
    Signature Algorithm:MD5withRSA
    > 
<weblogic user specified trustmanager validation status 16> 
<Certificate chain received from mestoudi2 - 10.142.0.23 was not trusted causing SSL handshake failure.> 
<Validation error = 16> 
<Certificate chain is untrusted> 
<SSLTrustValidator returns: 16> 
<Trust status (16):  CERT_CHAIN_UNTRUSTED> 
<NEW ALERT with Severity: FATAL, Type: 42
    java.lang.Exception: New alert stack
      at com.certicom.tls.record.alert.Alert.<init>(Unknown Source)
      at com.certicom.tls.record.handshake.HandshakeHandler.fireAlert(Unknown Source)
      at com.certicom.tls.record.handshake.ClientStateReceivedServerHello.handle(Unknown Source)
… 
```

我认为第一个区别发生在*weblogic 用户指定的信任管理器验证状态 16*行上，其中在 WebLogic 10g 中该值是 0 而不是 16。

如果我们在 WebLogic 管理控制台中选中“使用 JSSE SSL”（将实现切换到`com.sun.net.ssl`而不是`com.certicom.tls`），则`TrustManager`根本不会调用 。

我们还尝试`TrustManager`通过实现`javax.net.ssl.X509TrustManager`我们在`weblogic.wsee.connection.transport.https.HttpsTransportInfo`传递给存根的 a 上设置的 a 来配置

```
((weblogic.wsee.jaxrpc.StubImpl) servicePort)._setProperty(TRANSPORT_INFO, transportInfo); 
```

但它也没有被调用——但它适用于例如设置代理。我们正在使用 clientgen Ant 任务 ( `weblogic.wsee.tools.anttasks.ClientGenTask`) 生成存根。

# c# - 使用 Process.Start 运行 Internet Explorer 时如何关闭它？

> ID：11346533
> 
> 赞同：2
> 
> 时间：2012-07-05T14:33:59.537
> 
> 标签：c#, internet-explorer, process

我有一个 WPF 应用程序正在使用`Process.Start`方法启动 Internet Explorer（版本 9，在 Win7 X64 上）。

我保存 ProcessID 以便在应用程序关闭时将其关闭。但是，当应用程序退出时，Internet Explorer 在任务管理器中仍然可见。

这是我正在使用的代码：

```
public class MyClass : IDisposable
{
    Process _process;

    public void Go()
    {

        ProcessStartInfo psi = new ProcessStartInfo { 
            FileName = "iexplore.exe", 
            Arguments = "-noframemerging -private \"http://whathaveyoutried.com\"" 
        };
        _process = Process.Start(psi);
        _process.WaitForInputIdle();
    }

    private void Close(object sender, RoutedEventArgs e)
    {
        if (_process != null)
        {
            _process.Refresh();
            _process.Close();
        }
    }

    public void Dispose()
    {
        if (_process != null)
        {
            _process.Refresh();
            _process.Close();
        }
    }
} 
```

}

我仔细检查了一下，调用`_process.Close()`实际上已经完成。

什么会导致这种行为？

PS：我怀疑这是由于 Internet Explorer 内部造成的。运行exe不需要创建新进程，但可以使用一些IPC来控制其他实例。我使用`-noframemerging`命令行参数，但它看起来并不能解决问题。

**[编辑]这是**[我几天前提出](https://stackoverflow.com/questions/11186817)的另一个问题的延续。实际上，我正在使用 SetParent 函数将生成的 IE 嵌入到我的应用程序中。我不能使用 WebBrowser 控件，因为它不支持我正在寻找的隔离。所以当我的应用关闭时关闭 IE 是可以的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:55:48.960

为了获得更好的安全性和稳定性，IE8 使用松耦合 Internet Explorer (LCIE) 架构，并在单独的进程中运行浏览器框架和选项卡。LCIE 可防止故障和挂起导致整个浏览器崩溃，并带来更高的性能和可扩展性。我在[维基百科](http://en.wikipedia.org/wiki/Internet_Explorer_8#Performance_and_stability)上读到了这个。

您可以[禁用 LCIE](http://blog.smartbear.com/software-quality/bid/169996/Web-Testing-Disabling-Multiple-Processes-of-Internet-Explorer-8)，但我不确定您为什么要这样做。我会考虑使用上面@Damien_The_Unbeliever 提到的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:49:58.163

Internet Explorer 的每个选项卡都是一个进程。如果您打开带有多个选项卡的 IE 或用户打开另一个选项卡，则杀死进程是不够的。

但

```
_process.Close(); 
```

释放所有属于 _process 的资源。您可以使用`_process.Kill()`方法代替它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-03T11:52:16.523

我的 win32 应用程序中有一个 IE 应用程序，我正在使用`Win32Api`-`SendMessage with WM_CLOSE = 0x0010`

```
SendMessage(handle,0x0010,IntPtr.Zero, IntPtr.Zero)} 
```

这将关闭 IE，但您需要拥有浏览器的特定句柄（IEFrame 类）。

有一个缺点，如果您有多个选项卡，IE 会打开确认关闭对话框，这会阻止关闭过程。

克服对话框打开的一种方法是将其复选框设置为（始终关闭），但对我来说这不是一个选项。

# php - 创建登录但重定向不起作用

> ID：11346545
> 
> 赞同：0
> 
> 时间：2012-07-05T14:34:35.423
> 
> 标签：php, mysql

我创建了一个登录页面 login.php，当用户登录时，他们被重定向到 login-home.php，然后，

```
if (isset($_SESSION['loggedin']) && $_SESSION['loggedin'] == true) {
echo "Welcome to the member's area, " . $_SESSION['username'] . "!";
} else {
echo "Please log in first to see this page.";
} 
```

我得到请先登录。

为什么这实际上不会登录？

登录.php

```
 <?PHP
 error_reporting(9);

 require_once("./include/membersite_config.php");
 if(isset($_POST['submitted']))
 {
$users['admin'] = array('password' => 'admin', 'redirect' => 'admin.php');
$users[$username] = array('password' => $password, 'redirect' => 'login-home.php');

if(array_key_exists($_POST['username'],$users)) {
if($_POST['password'] == $users[$_POST['username']]['password']) {
    $_SESSION['loggedIn'] = true;
    header('Location:'.$users[$_POST['username']]['redirect']);
    exit();
 }
}
 if($fgmembersite->Login())
 {
    $fgmembersite->RedirectToURL("login-home.php");
 }
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:36:00.143

通过登录和使用会话，请确保您在使用var`session_start()`的任何页面上使用。`$_SESSION`查看[php session 手册](http://php.net/manual/en/ref.session.php)以获取更多信息。

对于重定向，我不确定您是否对此有问题，但您需要确保在重定向之前没有任何内容写入浏览器。重定向之前的空行`<?php`甚至会导致重定向不起作用。任何类型的回声或打印也会导致这种情况。

**更新**

看到您的代码后，这表明您没有执行以下`session_start()` 查看代码：

```
 <?PHP
 session_start();
 error_reporting(9);

 require_once("./include/membersite_config.php");
 if(isset($_POST['submitted']))
 {
$users['admin'] = array('password' => 'admin', 'redirect' => 'admin.php');
$users[$username] = array('password' => $password, 'redirect' => 'login-home.php');

if(array_key_exists($_POST['username'],$users)) {
if($_POST['password'] == $users[$_POST['username']]['password']) {
    $_SESSION['loggedIn'] = true;
    header('Location:'.$users[$_POST['username']]['redirect']);
    exit();
 }
}
 if($fgmembersite->Login())
 {
    $fgmembersite->RedirectToURL("login-home.php");
 }
}
?> 
```

然后在使用会话检查任何内容之前在您的 login-home.php 页面上，将`session_start()`. 用户注销后，您将需要执行以下操作

```
session_start();
session_unset();
header('Location:url/to/redirect/to'); 
```

# ios - 带有 ALL 和 IN 的 Core Data 不支持谓词

> ID：11346546
> 
> 赞同：5
> 
> 时间：2012-07-05T14:34:38.547
> 
> 标签：ios, objective-c, core-data, nspredicate

我有这样的要求：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"ANY attributes.attribute.attributeId IN %@", attributeIds]; 
```

这将返回一个对象列表，这些对象具有我设置的一个或多个属性。我想获取具有我传递的所有属性的对象列表，所以我尝试了：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"ALL attributes.attribute.attributeId IN %@", attributeIds]; 
```

但我有一个例外：

```
'NSInvalidArgumentException', reason: 'Unsupported predicate (null)' 
```

无论如何，我什至不确定这是正确的要求。假设我有 at 属性列表：`[red, green, blue]`，~~我怎样才能获得至少具有这些属性的所有对象？~~

```
* Object_1 (red, green, blue)
* Object_2 (red, green, blue, yellow, brown)
* Object_3 (red, green blue, black, brown) 
```

但不是`Object_4 (red, green, yellow)`因为它没有`blue`属性（请注意，我的`ANY`fetch 请求得到了所有 4 个对象，正如预期的那样）

~~编辑，相关问题：如果我想要完整匹配怎么办？所以对于`[red, green, blue]`我只会得到`Object_1`？~~

* * *

编辑2：我设法回答了这两个问题，但[我有一个新问题](https://stackoverflow.com/questions/11374667/core-data-match-a-to-many-relationship-to-a-list)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T11:35:35.930

## 获取列表中至少具有所有属性的所有对象

```
NSPredicate *objectsThatContainsAtLeastAllAttributesInList =
    [NSPredicate predicateWithFormat:
        @"SUBQUERY(attributes, $s, $s.attribute.attributeId IN %@).@count == %d", attributeIds, [attributeIds count]]; 
```

## 获取仅具有列表中属性的所有对象

```
NSPredicate *objectsWhoseAttributesAreInList =
    [NSPredicate predicateWithFormat:
        @"attributes.@count == %d AND SUBQUERY(attributes, $s, $s.attributes.id IN %@).@count == %d", [attributeIds count], attributeIds, [attributeIds count]]; 
```

# sql - uniqueidentifier 列的问题

> ID：11346550
> 
> 赞同：3
> 
> 时间：2012-07-05T14:34:47.757
> 
> 标签：sql, sql-server-2008

我刚开始使用 SQL Server，在将值添加到具有 type 列的表时遇到了一些麻烦`uniqueidentifier`。

该表包括：

```
ID (uniqueidentifier), CODE (nchar(5)), COUNTRY_CODE(nchar(2)), NAME(nchar30) 
```

我尝试从 Excel 和 CSV 文件中添加值，基本上它们看起来像这样：

```
DEBE,DE,Berlin 
```

我无法加载它，这个 ID 字段总是有一些错误。

当我尝试手动添加值时，例如：

```
INSERT INTO [Portfolio].[dbo].[Regions](CODE, COUNTRY_CODE, NAME) 
VALUES ('DEBE', 'DE', 'Berlin'); 
```

它说：

> 无法将值 NULL 插入列“ID”、表“Portfolio.dbo.Regions”；列不允许空值。插入失败。

当然，当我添加一`id`列和一个数字时，我会得到 int 与不兼容的信息`uniqueidentifier`。

我什至尝试创建一个临时表（用`id`代替`INT`）`uniqueidentifier`并将值从中复制到这个（没有`ID`列，它应该自动生成）

我唯一能想到的是该`ID`列不会自动为其创建值，我不知道如何解决这个问题。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T14:42:38.013

Uniqueidentifier 是一种特殊类型，可用于生成 GUID。长度为 16 字节，并且不会像 Identity 列那样自动增加。您需要使用 Convert 或 Cast 子句从 varchar 中获取正确的唯一标识符，如果超过 16 字节，它将被截断。

使用 NewID() 生成新的唯一标识符。

[也许这个链接可以帮助你](http://msdn.microsoft.com/en-us/library/ms187942%28v=sql.105%29.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T15:11:37.357

如上所述，使用 NewID() 创建标识符。

当您处于表格的设计模式时，可以将 NewID() 放置在“默认值或绑定”插槽中。这意味着对于您插入到表中的任何新记录（例如 CODE、COUNTRY_CODE、NAME），都将创建一个唯一标识符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:39:20.327

我认为您正在寻找的是一个身份字段。UniqueIdentifier 字段用于存储 GUID。

将字段类型更改为 int，然后将其身份规范更改为“是”。

另一种解决方案是从代码中传递您自己的 GUID 的 ID 字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-12T06:36:49.373

回答太晚了，但它可能对某人有帮助，转到你的 sql 表设计模式，选择你需要的表的属性，在这里详细选项卡（下到表）你会看到一个属性 RowGuid --> 是（确保打开是的）。

干杯:)

# c# - 我可以在 .NET 2.0 或 3.0 中使用扩展方法和 LINQ 吗？

> ID：11346554
> 
> 赞同：13
> 
> 时间：2012-07-05T14:34:57.563
> 
> 标签：c#, .net, .net-2.0, extension-methods, .net-3.0

当我尝试使用 .NET 2.0 或 3.0 运行时添加扩展方法时，出现错误：

> 无法定义新的扩展方法，因为找不到编译器所需的类型“System.Runtime.CompilerServices.ExtensionAttribute”。您是否缺少对 System.Core.dll 的引用？

但是当我尝试将 System.Core 添加到项目中时，我无法在可用参考列表中找到它。我需要做什么才能在我的项目中使用扩展方法并反过来启用[LINQ ？](http://en.wikipedia.org/wiki/Language_Integrated_Query)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-05T14:34:58.330

扩展方法直到 3.5 才添加到 .NET。但是，不是对 CLR[的更改，而是对添加它们的编译器的更改](http://www.hanselman.com/blog/HowDoExtensionMethodsWorkAndWhyWasANewCLRNotRequired.aspx)，因此您仍然可以在 2.0 和 3.0 项目中使用它们！唯一的要求是您必须有一个可以创建 3.5 项目的编译器才能执行此解决方法（Visual Studio 2008 及更高版本）。

当您尝试使用扩展方法时遇到的错误具有误导性，因为您并不真正需要`System.Core.dll`使用扩展方法。当您使用扩展方法时，在幕后，编译器正在将[`[Extension]`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.extensionattribute.aspx)属性添加到函数中。如果您有一个了解如何处理该`[Extension]`属性的编译器，那么如果您自己创建该属性，则可以在您的 2.0 和 3.0 项目中使用它。

只需将以下类添加到您的项目中，然后您就可以开始使用扩展方法：

```
namespace System.Runtime.CompilerServices
{
    [AttributeUsage(AttributeTargets.Method, AllowMultiple = false, Inherited = false)]
    public class ExtensionAttribute : Attribute
    {
    }
} 
```

上面的代码块位于[System.Core.Dll](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.extensionattribute.aspx)中，这就是为什么错误提示您需要包含 DLL 文件才能使用它们的原因。

* * *

现在，如果您想要 LINQ 功能，这将需要一些额外的工作。您将需要自己重新实现扩展方法。为了模仿完整的[LINQ to SQL](http://msdn.microsoft.com/en-us/library/bb386976.aspx)功能，代码可能会变得相当复杂。但是，如果您只是使用[LINQ to Objects](http://msdn.microsoft.com/en-us/library/bb397919.aspx) ，则大多数 LINQ 方法的实现并不复杂。以下是我为帮助您入门而编写的项目中的一些 LINQ to Objects 替换函数。

```
public static class LinqReplacement
{
    public delegate TResult Func<T, TResult>(T arg);
    public delegate TResult Func<T1, T2, TResult>(T1 arg1, T2 arg2);

    public static TSource First<TSource>(this IEnumerable<TSource> source, Func<TSource, bool> predicate)
    {
        if (source == null)
            throw new ArgumentNullException("source");
        if (predicate == null)
            throw new ArgumentNullException("predicate");

        foreach (TSource item in source)
        {
            if (predicate(item) == true)
                return item;
        }

        throw new InvalidOperationException("No item satisfied the predicate or the source collection was empty.");
    }

    public static TSource FirstOrDefault<TSource>(this IEnumerable<TSource> source)
    {
        if (source == null)
            throw new ArgumentNullException("source");

        foreach (TSource item in source)
        {
            return item;
        }

        return default(TSource);
    }

    public static IEnumerable<TResult> Cast<TResult>(this IEnumerable source)
    {
        foreach (object item in source)
        {
            yield return (TResult)item;
        }
    }

    public static IEnumerable<TResult> SelectMany<TSource, TResult>(this IEnumerable<TSource> source, Func<TSource, IEnumerable<TResult>> selector)
    {
        if (source == null)
            throw new ArgumentNullException("source");
        if (selector == null)
            throw new ArgumentNullException("selector");

        foreach (TSource item in source)
        {
            foreach (TResult subItem in selector(item))
            {
                yield return subItem;
            }
        }
    }

    public static int Count<TSource>(this IEnumerable<TSource> source)
    {
        var asCollection = source as ICollection;
        if(asCollection != null)
        {
            return asCollection.Count;
        }

        int count = 0;
        foreach (TSource item in source)
        {
            checked //If we are counting a larger than int.MaxValue enumerable this will cause a OverflowException to happen when the counter wraps around.
            {
                count++;
            }
        }
        return count;
    }
} 
```

[在LinqBridge](https://code.google.com/p/linqbridge/)`ExtensionAttribute`项目中可以找到一个完全重新实现 LINQ to Objects的库（感谢[Allon Guralnek](https://stackoverflow.com/users/149265/allon-guralnek)）。

# java - 从 Jenkins 运行 Android 模拟器以使用 Robotium 运行 Junit 测试

> ID：11346556
> 
> 赞同：3
> 
> 时间：2012-07-05T14:34:58.723
> 
> 标签：java, android, testing, android-emulator, jenkins

如何从 Jenkins 运行 Android 模拟器来运行我的测试？当我在 Execiute Windows Bath 命令中编写时，运行模拟器的命令：

> 模拟器 -avd 测试器

并运行我的测试我有这个错误：

> ..>emulator -avd Tester 'emulator' 不是内部或外部命令、可运行程序或批处理文件。
> 
> ..> 退出 9009 构建步骤“执行 Windows 批处理命令”将构建标记为失败

我在 Windows 路径中为 Android_SDK、java 设置了路径，它可以从 cmd 运行。我应该怎么做才能运行模拟器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T15:21:18.267

您可以使用[Android Emulator Plugin for Jenkins](https://wiki.jenkins-ci.org/display/JENKINS/Android+Emulator+Plugin)自动执行该过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T01:11:47.403

您只需要找到文件“emulator.exe”所在的位置，然后在该位置运行命令。例如，最有可能的是它位于 C:...android-sdk\tools

因此，转到命令提示符，键入 cd C:\android-sdk\tools。然后输入命令，它就可以正常工作了。我希望这是答案，即使已经很晚了。所以，接受答案。

# android - 如何检测用户何时启动另一个应用程序？（安卓）

> ID：11346557
> 
> 赞同：9
> 
> 时间：2012-07-05T14:35:01.867
> 
> 标签：android, service

我正在尝试构建一个应用程序，我的应用程序在后台运行，并检测用户何时启动另一个应用程序，以便我可以控制其上的流程。为了说明我的查询，我想指定一个示例。我的应用程序在后台运行（例如作为服务），并且用户刚刚单击了应用程序“XYZ”。我的应用程序是否可以检测到应用程序“XYZ”已启动？不仅仅是检测 'XYZ's Activity 是否出现在前台，我想检测'XYZ' 是否已经启动。假设有人启动“Whatsapp Messenger”，我想知道我的应用程序是否可以知道“Whatsapp Messenger”已启动。

编辑：很多人认为我正在尝试构建恶意软件，但我不是。我正在尝试为高中项目构建应用程序。我想要一个统计数据，看看我在心理项目中使用相机的频率。：/

在此先感谢，苏米特。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:46:42.167

是的，您可以通过 Tracking the **Logcat**找到启动了哪个应用程序。只需使用**info -I** log跟踪**ActivityManager** 标签。

 **从 adb shell 命令是，

```
adb logcat ActivityManager:I *:S 
```

从您的应用程序代码中，

```
logcat ActivityManager:I *:S 
```

在 Logcat 中，您可以找到类似的行，

```
I/ActivityManager(  585): Starting activity: Intent { action=android.intent.action...} 
```

何时启动任何应用程序。

logcat 输出显示该消息与优先级“I”和标记“ActivityManager”有关：

**更新：**

只需在应用程序的清单文件中添加权限，

```
android.permission.READ_LOGS 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:46:28.900

我想您应该看看 Google Play 中的“应用保护程序”应用程序。他们检测到该用户启动了另一个应用程序。这是通过读取系统日志来完成的。在设备上启动任何应用程序后，尝试打开 LogCat 并阅读日志。你会感到惊讶。

你应该从那里去哪里？我想你应该试试 [LogCat](https://play.google.com/store/apps/details?id=org.jtb.alogcat&hl=ru)应用程序。它是自由和开源的。这将帮助您实际阅读日志。

不过，所有这些都被一些开发人员认为是 Android 中的安全漏洞。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-13T10:28:21.797

我做了一项服务，可以检测其他应用程序是否启动。我已经为拨号器做了它。类似地，可以用任何包名称替换。

```
@Override
public int onStartCommand(Intent intent, int flags, int startId){
    Toast.makeText(this,"Service Started", Toast.LENGTH_LONG).show();

    final String str = "";
    Timer timer  =  new Timer();
    timer.scheduleAtFixedRate(new TimerTask() {
        int phonelaunched = 0,phoneclosed =0;
        int phonelaunches = 1;
        @Override
        public void run() {
            ActivityManager am = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);
            List<ActivityManager.RunningAppProcessInfo> runningAppProcessInfo = am.getRunningAppProcesses();

            for ( ActivityManager.RunningAppProcessInfo appProcess: runningAppProcessInfo ) {
                Log.d(appProcess.processName.toString(),"is running");
                if (appProcess.processName.equals("com.android.dialer")) {
                    if ( appProcess.importance == ActivityManager.RunningAppProcessInfo.IMPORTANCE_FOREGROUND  /*isForeground(getApplicationContext(),runningAppProcessInfo.get(i).processName)*/){
                        if (phonelaunched == 0 ){
                            phonelaunched = 1;
                            Log.d(str,"dude phone has been launched");
                        }
                        else if (phoneclosed == 1){
                            phonelaunches++;
                            phoneclosed = 0;
                            Log.d(String.valueOf(phonelaunches),"dude that was counter");
                        }
                    }
                    else {
                        phoneclosed = 1;
                        Log.d(str,"dude phone has been closed");

                    }
                }
            }
        }
    },2000,3000);

    return START_STICKY;
} 
```

在这里，我浏览了所有正在运行的任务并检查它是否是我们的预期应用程序。如果是这样，我检查应用程序是否在前台，并且应用程序从未使用“phonelaunched”变量启动。当预期的应用程序在后台并相应地设置变量时，使用 phoneclosed。

所有这些都在**Service**类中实现

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-05T14:46:54.377

在我的书中，顺便说一下你提出问题的方式，这听起来像是以某种方式劫持应用程序以供你的服务控制，接近恶意软件的恶作剧。但它不适用于 Android - 由于每个应用程序的权限不同，因此简单明了。因此，每个应用程序都是相互隔离的。所以直截了当地回答你的问题，它不是。

正如另一个答案所建议的那样-您可以监视logcat但是..然后又...为什么？**

# c# - XAML 继承（非代码隐藏）

> ID：11346565
> 
> 赞同：4
> 
> 时间：2012-07-05T14:35:16.743
> 
> 标签：c#, .net, wpf, xaml, inheritance

*XAML中的***继承**是如何实现的？

 *是否只能继承代码隐藏而不是*.xaml*（[相关问题](https://stackoverflow.com/a/271407/640378)）？将父级包含在子控件的**命名空间**中是唯一的方法吗？

*XAML*本身似乎没有一般的“继承” 。有关于继承等问题，但不是[一般](https://stackoverflow.com/q/225878/640378)**继承**。`UserControl`

 ****问题：**

我有 2 个 xaml 文件`File1.xaml`和`File2.xaml`，它们非常相似。我可以创建一个`SuperFile.xaml`并将以下大部分代码放入其中吗？

```
<UserControl ... >
    <Grid>
        <Grid.RowDefinitions ... />

        <DockPanel ... >
            <ToolBar ... >
                <!-- Some Buttons here:
                     File1.xaml to contain the Buttons "View" and "Export"
                     File2.xaml to contain the Buttons "Edit" and "Delete"
                 -->
            </ToolBar>
        </DockPanel>

        <igDP:XamDataGrid MouseDoubleClick="xamDataGrid1_MouseDoubleClick" ... />
    </Grid>
</UserControl> 
```

唯一**不同**的`File1.xaml`是`File2.xaml`：

1.  `Button`s 中`ToolBar`（见代码中的注释）
2.  的*属性*，`XamDataGrid`主要是事件（它们在每种情况下的作用）。

我怎样才能做到这一点？**我是否必须分别**为两个孩子编写代码隐藏文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T18:14:16.097

您可以使用[资源字典](http://msdn.microsoft.com/en-us/library/system.windows.resourcedictionary.aspx)

将所有通用模板和样式放在 a 中`ResourceDictionary`，然后同时`UserControls`导入`ResourceDictionary`

```
<UserControl.Resources>
    <ResourceDictionary Source="BaseStylesAndTemplates.xaml" />
</UserControl.Resources> 
```***

# css - 拉伸标签以填充父级 在水平列表中

> ID：11346568
> 
> 赞同：6
> 
> 时间：2012-07-05T14:35:32.197
> 
> 标签：css, html-lists, drupal-theming

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-05T14:51:19.070

如果我做对了，那么您只需从 li 元素中删除填充并将其添加到 a. 您还必须更改显示类型：

```
#primary-menu li{
  list-style-type:none;
  display: inline-block;
  margin: 8px;
}

#primary-menu li a {
   padding: 5px 30px;
   display:block;
} 
```

见：http: [//jsfiddle.net/v6ZFx/](http://jsfiddle.net/v6ZFx/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:49:14.893

id 应该是唯一的。改用类。永远不要将块元素放在内联元素中。li { display: inline-block; 宽度：自动；填充：0}

现在您可以将 a_s 的宽度设置为完整大小。或者设置 li 元素的宽度。

# c# - 如何在使用 AutoMapper 映射后不丢失目标对象中存在但源对象中不存在的属性

> ID：11346571
> 
> 赞同：2
> 
> 时间：2012-07-05T14:35:41.107
> 
> 标签：c#, .net, automapper

我有以下类结构：

```
public class A
{
    public bool Property1 { get; set; }
    public bool Property2 { get; set; }
}

public class ContainerForA
{
    public A A { get; set; }
}

public class A1
{
    public bool Property1 { get; set; }
}

public class ContainerForA1
{
    public A1 A { get; set; }
} 
```

我为这组类创建了一个映射：

```
Mapper.CreateMap<A1, A>();
Mapper.CreateMap<ContainerForA1, ContainerForA>(); 
```

我创建了这组类的一个实例：

```
 var cnt_a = new ContainerForA()
                        {
                            A = new A()
                                    {
                                        Property1 = false,
                                        Property2 = true
                                    }
                        };

        var cnt_a1 = new ContainerForA1()
                         {
                             A = new A1()
                                     {
                                         Property1 = true
                                     }
                         }; 
```

如果我打电话`Mapper.Map(cnt_a1.A, cnt_a.A)`，我会得到我期望的结果：对象**cnt_a**`Property1`的两个属性 (和)都是**true**`Property2`

 ****但是，如果我打电话给`Mapper.Map(cnt_a1, cnt_a)`我，我会得到 true for`Property1`和 false for `Property2`。有人可以解释我为什么吗？是否有任何选择让我以这种方式声明我的映射，这样我就不会丢失目标对象中存在但不在源对象中的属性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T15:09:05.680

我猜想当你映射 from `ContainerForA1`to时，当映射属性 A 时，它会创建一个for`ContainerForA`的新实例，而不是使用现有的实例。这将使用所有属性的默认值，即.`A``ContainerForA``false``bool`

我们如何解决这个问题？

首先，我们需要告诉 AutoMapper 不要覆盖 ContainerForA 上的属性 A。为此，我们将告诉 AutoMapper 忽略该属性。

```
Mapper.CreateMap<ContainerForA1, ContainerForA>()
    .ForMember(cForA => cForA.A, option => option.Ignore()); 
```

现在我们需要手动更新 A，使用 AfterMap

```
Mapper.CreateMap<ContainerForA1, ContainerForA>()
    .ForMember(cForA => cForA.A, option => option.Ignore())
    .AfterMap((cForA1, cForA) => Mapper.Map(cForA1.A, cForA.A)); 
```

您可能希望向 AfterMap 方法添加一些检查，以确保 cForA.A 不为空。我会把它留给你。****

# html - 在 style 属性中为子节点设置 CSS 样式

> ID：11346575
> 
> 赞同：9
> 
> 时间：2012-07-05T14:35:48.817
> 
> 标签：html, css

是否可以在不使用 <head> 中的 <style> 元素的情况下从父样式中设置子节点的样式？

例如，我有一个表格，其中有一行（下面的第一行），并且我希望 TD 元素中的所有文本的字体大小为 7pt。

就像是：

```
  <表格>
    <tr style='font-size:7pt;'> <--- 我如何告诉它应用到子 TD 元素
      <td>单元格 1 应格式化为 7pt 字体</td>
      <td>单元格 2 应格式化为 7pt 字体</td>
    </tr>
    <tr>
      <td>无格式单元格</td>
      <td>另一个没有格式的单元格</td>
    </tr>
  </table>

```

谢谢，格兰特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:39:05.067

```
<table>
<tr class="format">
  <td>cell 1 should be formatted to 7pt font</td>
  <td>cell 2 should be formatted to 7pt font</td>
</tr>
<tr>
  <td>cell without format</td>
  <td>another cell without format</td>
</tr> 
```

```
<style>.format>td{font-size:7pt;}</style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:47:32.320

您可以通过声明`scoped`如下样式来做到这一点：

```
 <table>
    <tr>
    <style scoped>  <--- "scoped" tells the browser to apply the styles inside the tr
        {your-selector}{             
            {styles}
        }
    </style>
      <td>cell 1 should be formatted to 7pt font</td>
      <td>cell 2 should be formatted to 7pt font</td>
    </tr>
    ...
  </table> 
```

但是，浏览器对此的支持很糟糕。

阅读[关于 Html5Doctor 的文章](http://html5doctor.com/the-scoped-attribute/)真的很有趣，并且有一个 polyfill，你可以使用直到浏览器支持它。

编辑：

最新的 FF，Chrome 和 Opera 现在似乎支持它：[HTML5Rocks 上的文章](http://updates.html5rocks.com/2012/03/A-New-Experimental-Feature-style-scoped)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:42:10.467

它不可能直接。但是如果您仍然想使用内联样式，那么您需要使用 JavaScript 并为每个元素设置样式。这又不是一个好的解决方案

有效的方法是 --> 以下将在 IE7 和 UP 以及所有其他浏览器中工作

```
<style>
table tr:first-child > td {font-size:7pt;}
</style> 
```

您可能想为您的表提供类名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T14:43:12.650

您不能对子元素执行此操作。

style 属性指定元素的内联样式。（[来源](http://www.w3schools.com/tags/att_standard_style.asp)）

你可以使用 jQuery 做你想做的事：

```
<script>
$("tr:first-child td").attr("style", "font-size:7pt");
</script> 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-07-05T14:38:19.043

不，不是，这正是样式标签的用途:-) 顺便说一句，尽量避免使用内联样式。

# c# - 后台代理中的静态变量值不同

> ID：11346576
> 
> 赞同：3
> 
> 时间：2012-07-05T14:35:52.677
> 
> 标签：c#, windows-phone

我有一个应用程序，它显示一些数据并启动一个后台代理来动态更新动态磁贴。由于使用从主线程填充的一些 var 在后台代理中创建动态图块内容，我决定（也许这是一个错误的决定，但这是我认为唯一合理的决定）编写一个具有静态变量和属性的类以在主线程之间共享线程和后台代理。现在的问题是我在主线程中写了一个变量值，但是当后台代理执行时发现这个值是空的。为什么？
我提供了一个小例子，跳跃它足以让你理解。

**静态部分**

```
public class Vars
{
    public static IEnumerable<Contact> Contacts;
    public static void Test()
    {
        int num = Contacts == null ? -2 : Contacts.Count();
        // num is -2 here because Contacts is null !!
    }
} 
```

**背景代理**

```
public class TileAgent : ScheduledTaskAgent
{
    protected override void OnInvoke(ScheduledTask task)
    {
        // It's necessary to use BeginInvoke to avoid Cross-thread errors
        Deployment.Current.Dispatcher.BeginInvoke(() =>
        {
            Vars.Test();
        });

        NotifyComplete();
    }
} 
```

**主页**

```
public partial class MainPage : PhoneApplicationPage
{
    private void Contacts_SearchCompleted(object sender, ContactsSearchEventArgs e)
    {
        busyIndicator.IsRunning = false;
        try
        {
            Vars.Contacts = e.Results
                .Where(.........);
            ContactResultsData.DataContext = Vars.Contacts;
            // Vars.Contacts.Count() = 67 here !!!

            if (Vars.GetTile() != null)
                StartAgent();
        }
        catch (System.Exception)
        {
            // That's okay, no results
        }
    }
    private void ContactResultsData_Tap(object sender, GestureEventArgs e)
    {
        int num = Vars.Contacts == null ? -2 : Contacts.Count();
        // num = 67 here !!
   }
} 
```

我的代码有什么问题？有没有更好的方法来完成我的任务？
考虑到我从不到一个月的时间开始就在 Windows Phone 上工作，所以我确信我仍然在做非常糟糕的事情......

**更新**：
在放置正确的锁以避免来自不同线程的并发读/写之后，我决定将显式静态构造函数放入静态类

```
public class Vars
{
    static Vars()
    {
        Debug.WriteLine("init");
    }
} 
```

每次调用后台代理时都会调用它！
这解释了我看到我的变量为空的原因，但我不明白：为什么每次都重新创建一个静态类？
可能是因为后台代理位于 dll 项目中（必须运行它）？
有没有办法制作一个只在第一次创建的类，可以在不同的线程之间共享（在这种情况下它们是进程吗？）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T07:58:05.740

找了好久，终于找到一篇[文章](http://mstruys.com/2012/01/08/eventiles-from-start-to-finishpart-13/)说：

> 由于我们的 EventTiles 应用程序和它的 PeriodicTask 运行在不同的进程中，它们彼此完全分离，这意味着它们拥有自己想要访问的变量的副本，即使这些变量是在单独的项目中定义的。

因此，使用“简单”静态变量/属性在主应用程序和周期性任务之间共享数据是不可能的；我们必须读/写数据库或隔离存储或任何我们喜欢的东西。

我觉得这很疯狂，但这就是故事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:28:14.977

您需要同步对共享集合的访问。现在一个线程可以读取它（通过`Count()`在另一个写入时调用，这是非常糟糕的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:10:57.603

我认为将 volatile 修饰符添加到您的变量可以解决您的问题。

# php - PHP 奇数字符串相关的性能问题

> ID：11346584
> 
> 赞同：0
> 
> 时间：2012-07-05T14:36:13.157
> 
> 标签：php, string, performance

我有一个类正在使用存储在数组中的数据构建一些 HTML。该数组中大约有 100 个项目。每个项目都包含公司名称、描述和公司支持的不同编程语言的标志等信息。我在为每个项目构建 HTML 时进行字符串连接。

我注意到，当我附加编程语言数据时，性能突然受到了巨大的影响。我看到页面渲染计时器从 0.15 秒跳到 ~0.60 秒。这个时间包括每次从数据库中抓取相同的数据。我可以始终使性能在这 2 次之间跳跃，但注释/取消注释以下代码行：

```
$html .= '<div class="programmingLanguages"><strong>Programming Languages</strong> '.implode(', ', $progLanguagesArray).'</div>'; 
```

通过附加一个长的测试字符串，我还能够获得相同的性能下降，如下所示：

```
$html .= 'testtesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttest'; 
```

特别奇怪的是，我有另一行代码使用相同的“内爆”函数，并且在性能上没有任何显着差异：

```
$html .= '<div class="integrationMethods"><strong>Integration Methods:</strong> '.implode(', ', $intMethodsArray).'</div>'; 
```

有人对这里可能发生的事情有任何见解吗？我在我的代码的其他地方做了大量这样的连接，以前从未见过这样的东西。在这一点上，我难住了。

这是完整的课程：

```
class DeveloperView {

public static function getHtml($developers) {
    $html = '';
    $html .= '<div>';
    $html .= '<div>';

    $count = 0;
    foreach ($developers as $developer) {
        $url = $developer['attributes']['url'];
        $phone = $developer['attributes']['phone'];
        $company = $developer['attributes']['desc'];
        $active = $developer['attributes']['active'];
        $desc = $developer['object_value'];

        $intMethodsArray = array();
        if ($developer['attributes']['m1']) { $intMethodsArray[] = 'method 1'; }
        if ($developer['attributes']['m2']) { $intMethodsArray[] = 'method 2'; }
        if ($developer['attributes']['m3']) { $intMethodsArray[] = 'method 3'; }
        if ($developer['attributes']['m4']) { $intMethodsArray[] = 'method 4'; }
        if ($developer['attributes']['m5'])     { $intMethodsArray[] = 'method 5'; }

        $progLanguagesArray = array();
        if ($developer['attributes']['dotnet']) { $progLanguagesArray[] = '.Net (C# or VB.Net)'; }
        if ($developer['attributes']['asp'])    { $progLanguagesArray[] = 'Classic ASP'; }
        if ($developer['attributes']['cf'])     { $progLanguagesArray[] = 'Cold Fusion'; }
        if ($developer['attributes']['java'])   { $progLanguagesArray[] = 'Java'; }
        if ($developer['attributes']['php'])    { $progLanguagesArray[] = 'PHP'; }
        if ($developer['attributes']['perl'])   { $progLanguagesArray[] = 'Perl'; }
        if ($developer['attributes']['other'])  { $progLanguagesArray[] = 'Other'; }

        $html .= '<div class="';
        if ($count % 2 == 0) {
            $html .= 'listingalt';
        } else {
            $html .= 'listing';
        }
        $html .= '">';

        $html .= '<div class="developerPhone">'.$phone.'</div>';
        $html .= '<a class="ext_link" target="_blank" href="'.$url.'">'.$company.'</a>';

        $html .= '<div>';
        if (!empty($intMethodsArray)) {
            $html .= '<div class="integrationMethods"><strong>Integration Methods:</strong> '.implode(', ', $intMethodsArray).'</div>';
        }

        if (!empty($progLanguagesArray)) {
            $html .= '<div class="programmingLanguages"><strong>Programming Languages</strong> '.implode(', ', $progLanguagesArray).'</div>';
        }

        $html .= '</div>';

        $html .= '<p>'.$desc.'</p>';

        $html .= '</div>'."\n";

        $count++;
    }

    $html .= '</div></div>';

    return $html;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T20:08:45.383

既然我可以提供答案，我将把我的后续评论作为“答案”发布......

我的计时器中确实有一个“错误”，因为它正在计算 HTML 回显之后的结束处理时间。因此，发送到浏览器的数据量影响了处理时间，我希望在传输任何数据之前看到处理时间。

# php - 带有 Doctrine 和未定义索引警告的多对一映射

> ID：11346595
> 
> 赞同：1
> 
> 时间：2012-07-05T14:36:58.013
> 
> 标签：php, doctrine-orm

我确信有一个简单的解决方案，但我无法理解发生了什么。我有一个名为 a 的实体`Payment`和另外两个名为`User`and的实体`Household`。

A`User`有很多`Payment`s 并且 a`Household`有很多`Payment`s。这都被映射为`Payment`使用 YAML 的单向多对一关系，像这样（希望这符合[http://docs.doctrine-project.org/projects/doctrine-orm/en/2.1/reference/association上的指导-mapping.html#many-to-one-unidirectional](http://docs.doctrine-project.org/projects/doctrine-orm/en/2.1/reference/association-mapping.html#many-to-one-unidirectional) ) -

```
Payment:
  type: entity
  table: payments
  id:
    _id:
      type: integer
      column: payment_id
      generator:
        strategy: AUTO
    manyToOne:
    _user:
      targetEntity: Application_Model_User
      joinColumn:
        name: user_id
        referencedColumnName: payment_id
    _household:
      targetEntity: Application_Model_Household
      joinColumn:
        name: household_id
        referencedColumnName: payment_id 
```

数据库方面，我有三个表`users`，`payments`和`households`。该`payments`表（除了它的主键之外）有两列称为`user_id`and `household_id`，它们对应于其他两个表的主键。

问题是，当我尝试坚持一个新的时，`Payment`我从 mySql 收到一个错误，告诉我该`user_id`列`payments`不能为空。一些挖掘已经确定该学说在 INSERT 声明中和`null`两者都提供。对象图绝对正确。`user_id``household_id`

此外，我收到以下警告：

```
Notice: Undefined index: payment_id in [..]/library/Doctrine/ORM/Persisters/BasicEntityPersister.php on line 511

Notice: Undefined index: in [..]/library/Doctrine/ORM/Persisters/BasicEntityPersister.php on line 511

Notice: Undefined index: payment_id in [..]/library/Doctrine/ORM/Persisters/BasicEntityPersister.php on line 511

Notice: Undefined index: in [..]/library/Doctrine/ORM/Persisters/BasicEntityPersister.php on line 511 
```

我已经确定`payment_id`问题来自`referencedColumnName`我的映射中的 s ，并且索引未定义，因为数组原则正在搜索包含来自关系*另一*侧的字段，即 the`Household`或`User`. 但肯定不应该吗？我想我已经按照指南进行了操作，但我无法使其正常工作。

如果有帮助，我正在使用 Zend Framework，但我的代码没有什么特别之处。我很确定这是一个映射问题。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T14:57:54.057

我只使用过 Doctrine + Symfony2，但我认为您的 referencedColumnName 应该只是“id”，而不是 payment_id，因为您需要解释外键关系。

`payment.household_id`--参考--> `household.id`。

在 Symfony2 中，Doctrine 有一个“inversedBy”属性，用于映射另一个表中表示 payment_id 的列。

来自 Symfony2 映射的代码片段：

```
/**
* @ORM\ManyToOne(targetEntity="kurtfunai\WalkthroughBundle\Entity\Group", inversedBy="members")
* @ORM\JoinColumn(name="fk_group_id", referencedColumnName="id")
*/
protected $group; 
```

在您的情况下，它需要更改为以下内容：

```
_user:
  targetEntity: Application_Model_User
  joinColumn:
    name: user_id
    referencedColumnName: <USERS_TABLE_PRIMARY_KEY_COLUMN_NAME>
_household:
  targetEntity: Application_Model_Household
  joinColumn:
    name: household_id
    referencedColumnName: <HOUSEHOLDS_TABLE_PRIMARY_KEY_COLUMN_NAME> 
```

（替换为适当的列名）

# java - 停止后续 JOptionPane 的排队

> ID：11346598
> 
> 赞同：0
> 
> 时间：2012-07-05T14:37:01.103
> 
> 标签：java, swing, dialog

如果用户尚未关闭第一个，我想停止显示第二个（或第 n 个）showConfirmDialog，但我找不到这样做的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T18:28:53.800

如果我正确理解了您的问题（和评论），您肯定`Thread`会在套接字上侦听文本，并且当它接收到文本时，它会显示一个带有新文本的新对话框。

我通过显示一个包含`JTextArea`. 当我`Thread`收到新文本时，我将文本附加到`JTextArea`，并显示`JTextArea`它尚未显示的时间。

当用户关闭对话框时，我清除了`JTextArea`.

小旁注：您最好使用您在评论中添加的额外信息来更新您的问题，因为这些评论可以更清楚地说明您要解决的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:44:38.543

[`JOptionPane.showConfirmDialog`](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/JOptionPane.html#showConfirmDialog%28java.awt.Component,%20java.lang.Object%29)正在阻塞。检查调用的返回值以确定是否应该显示下一个对话框，如下所示：

```
int result = JOptionPane.showConfirmDialog(frame, "First question?");

if (result != JOptionPane.CANCEL_OPTION) {

    int nextResult = JOptionPane.showConfirmDialog(frame, "Next question?");
    ...
} 
```

* * *

如果您有一系列问题要问，您可以在用户关闭对话框时使用循环和中断：

```
for (String question : questions) {

    int result = JOptionPane.showConfirmDialog(frame, question);

    if (result == JOptionPane.CANCEL_OPTION)
        break;

    // handle (yes/no) the response
    ....
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:44:45.770

我建议使用直接的 JDialog（JOptionPane 只是创建 JDialog 的快捷方式）。您可以使用 WindowListener / windowClosing 事件来确定是否应该显示下一个 JOptionPane

# php - 在 Facebook 应用程序窗口中将转到应用程序按钮文本更改为“使用 Facebook 登录”？

> ID：11346607
> 
> 赞同：-1
> 
> 时间：2012-07-05T14:37:25.023
> 
> 标签：php, facebook

我正在尝试在我的网站中实施 Facebook Oauth。我有以下网址的按钮

```
define('FACEBOOK_APPID','xxx'); // replace 123 with your app id
    define('FACEBOOK_APPSECRET','xx'); // replace abc with your app secret
    define('REDIRECTURI','http://www.test.com/index.php?request=facebookdata_Action');  
                 $facebook_dialog_url = sprintf("https://www.facebook.com/dialog/oauth?client_id=%s&redirect_uri=%s&state=%s&scope=email",
                FACEBOOK_APPID,
                urlencode(REDIRECTURI),
                wp_create_nonce ('my-nonce')
             ); 
```

给定按钮链接为

```
<a title="Facebook" class="fb_btn " href="<?php echo $facebook_dialog_url; ?>"><span>Facebook</span></a> 
```

一切正常。当用户重定向到 Facebook 时，默认情况下我会在窗口中获得“转到应用程序”按钮。我的要求是将“ `Go to App`”按钮文本更改为“ `Log in With Facebook`”

我检查了这个[网址](https://developers.facebook.com/docs/opengraph/authentication/)

但是没有更改按钮文本的步骤。

我也发现了这个[问题](https://stackoverflow.com/questions/10560439/change-facebook-canvas-button-from-go-to-app-to-login-with-facebook)。但我无法理解答案。

有什么步骤可以更改文本吗？

好心劝告

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T09:38:19.020

最后我尝试了以下链接

[http://www.permadi.com/tutorial/facebook-js-oauth-popup-centered/index.html](http://www.permadi.com/tutorial/facebook-js-oauth-popup-centered/index.html)

我通过使用脚本得到了解决方案。

# ajax - 为什么调用其他站点时我的 Web 服务调用失败

> ID：11346609
> 
> 赞同：0
> 
> 时间：2012-07-05T14:37:33.007
> 
> 标签：ajax, web-services, web

我正在对 Web 服务进行 JQuery ajax 调用，如下所示：

```
 $.ajax({
        type: "POST",
        url: "https://WebsiteName.com/Service.asmx/LoginExternal",
        data: "{loginData: " + JSON.stringify(LoginData) + "}",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (msg) {
            ... Stuff ...
        },
        error: {
            ... Error Alert ...
        }
    }); 
```

当我在实际的网站上时，这会成功。当我在本地主机上并使用相对路径时，它会成功。但是，当我尝试从 localhost 访问网站（使用绝对路径）时，我收到调用失败的错误消息。

这似乎表明这是一个权限问题，我已确保 web.config 不需要身份验证即可访问 Web 服务，但我不确定还要检查什么。任何帮助将不胜感激！

更新：我得到的“thrownError”是“No Transport”——希望这会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:39:02.223

安全：

[http://en.wikipedia.org/wiki/Same_origin_policy](http://en.wikipedia.org/wiki/Same_origin_policy)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:51:12.867

作为一种不安全的脚本逻辑，由于未经身份验证和未加密的请求，使用 JavaScript（或 JQuery）发出的 ajax 请求被卡在同一主机、协议和端口上。

一种将请求传递到不同主机的方法，您必须实现一个用安全语言（例如 Java）编写的桥接服务，部署在同一主机上，将您的请求进一步传递给您的服务，然后将响应传递给您的 ajax 调用。

然后，您的 ajax 调用将在桥接服务上。

# sql - 如何在 SQL 中进行这种转换

> ID：11346611
> 
> 赞同：-1
> 
> 时间：2012-07-05T14:37:36.623
> 
> 标签：sql, sql-server-2005

我的 varchar 包含格式为 ddmmyyyy hh:mm:mm:ss 的日期

我想用格式 dd/mm/yyyy hh:mm:ss 将其转换为日期时间

请知道怎么做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:49:11.627

```
declare @datestr varchar(20)
set @datestr = '31122012 10:00:00'
select convert(datetime, substring(@datestr, 1, 2) + '/' + 
                         substring(@datestr, 3, 2) + '/' + 
                         substring(@datestr, 5, 10), 
               103) 
```

# asp.net-mvc - MVC 3 CheckboxList 和我...第 3 部分。尝试明确指定类型参数

> ID：11346613
> 
> 赞同：0
> 
> 时间：2012-07-05T14:37:43.263
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, checkboxlist

这很好玩。

好的，我有以下**型号**：

```
public class My : BusinessCategory
{

    [Display(Name = "What types of energy do you use?")]
    public List<MyTypes> MyTypeList { get; set; }
    public bool? FirstOption { get; set; }
    public bool? SecondOption{ get; set; }
    public bool? ThirdOption{ get; set; }
    public bool? FourthOption { get; set; } 
```

}

我的类型在哪里：

```
public class MyTypes
{
    public int MyTypeId { get; set; }
    public string MyTypeName { get; set; }
    public bool? MyTypeValue { get; set; }
} 
```

我的控制器如下：

```
public ActionResult My(Guid id)
        {
            try
            {
                var model = Model(id);
                SetMyTypeList(model.My);
                ViewBag.MyTypeMe = new MultiSelectList(model.My.MyTypeList, "MyTypeValue", "MyTypeName");
                return View(model.My);
            }
            catch (Exception ex)
            {
                ExceptionHelper.WriteLog(ex);
                return RedirectToAction("Error");
            }
        }

    private void SetMyTypeList(My model)
    {
        model.MyTypeList = new List<MyTypes>();
        model.MyTypeList.Add(new MyTypes { MyTypeId = 1, MyTypeName = GetName.GetDisplayName(model, m => m.FirstOption), MyTypeValue = model.FirstOption });
        model.MyTypeList.Add(new MyTypes { MyTypeId = 2, MyTypeName = GetName.GetDisplayName(model, m => m.SecondOption), MyTypeValue = model.SecondOption});
        model.MyTypeList.Add(new MyTypes { MyTypeId = 3, MyTypeName = GetName.GetDisplayName(model, m => m.ThirdOption), MyTypeValue = model.ThirdOption});
        model.MyTypeList.Add(new MyTypes { MyTypeId = 4, MyTypeName = GetName.GetDisplayName(model, m => m.FourthOption), MyTypeValue = model.FourthOption });
    }

  public static string GetDisplayName<TModel, TProperty>(TModel model, Expression<Func<TModel, TProperty>> expression)
        {
            return ModelMetadata.FromLambdaExpression<TModel, TProperty>(expression, new ViewDataDictionary<TModel>(model)).DisplayName;
        } 
```

最后视图如下：

```
@model Valpak.Websites.HealthChecker.Models.My
@{
    ViewBag.Title = "My";
}
<h2>
    My</h2>
@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>My Management</legend>
         <div style="text-align: left; padding-left: 47%;">    
         @Html.ListBoxFor(model => model.MyTypeList, ViewBag.MyTypeMe as MultiSelectList)

   @Html.CheckBoxListFor(model => model.MyTypeList, ViewBag.EnergyTypeMe as MultiSelectList, Model.ReviewId)

        </div>

        <p>
            <input type="submit" value="Continue" />
        </p>
    </fieldset>
}
<div>
    @Html.ActionLink("Cancel and return to categories", "BusinessSummary", new { id = Model.ReviewId })
</div> 
```

CheckboxListFor，如果它正在工作，将使用以下扩展名：

```
public static class HtmlHelper
{
    //Extension
    public static MvcHtmlString CheckBoxListFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty[]>> expression, MultiSelectList multiSelectList, object htmlAttributes = null)
    {
        //Derive property name for checkbox name
        MemberExpression body = expression.Body as MemberExpression;
        string propertyName = body.Member.Name;

        //Get currently select values from the ViewData model
        TProperty[] list = expression.Compile().Invoke(htmlHelper.ViewData.Model);

        //Convert selected value list to a List<string> for easy manipulation
        List<string> selectedValues = new List<string>();

        if (list != null)
        {
            selectedValues = new List<TProperty>(list).ConvertAll<string>(delegate(TProperty i) { return i.ToString(); });
        }

        //Create div
        TagBuilder divTag = new TagBuilder("div");
        divTag.MergeAttributes(new RouteValueDictionary(htmlAttributes), true);

        //Add checkboxes
        foreach (SelectListItem item in multiSelectList)
        {
            divTag.InnerHtml += String.Format("<div><input type=\"checkbox\" name=\"{0}\" id=\"{0}_{1}\" " +
                                                "value=\"{1}\" {2} /><label for=\"{0}_{1}\">{3}</label></div>",
                                                propertyName,
                                                item.Value,
                                                selectedValues.Contains(item.Value) ? "checked=\"checked\"" : "",
                                                item.Text);
        }

        return MvcHtmlString.Create(divTag.ToString());
    }
} 
```

有人可以用非常简单的术语解释（我有点密集）为什么我可以使用 ListBoxFor ，但是当我使用复选框时它会死掉并给我以下错误？

```
CS0411: The type arguments for method 'Extensions.HtmlHelper.CheckBoxListFor<TModel,TProperty>(System.Web.Mvc.HtmlHelper<TModel>, System.Linq.Expressions.Expression<System.Func<TModel,TProperty[]>>, System.Web.Mvc.MultiSelectList, System.Guid, object)' cannot be inferred from the usage. Try specifying the type arguments explicitly. 
```

任何人都可以提供任何形式的工作，因为我很想使用我的:'(

一如既往，为我的无知道歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:21:04.743

在扩展方法的签名中，您有以下第二个参数：

```
Expression<Func<TModel, TProperty[]>> expression, 
```

这基本上意味着表达式必须返回一个`TProperty`=>的数组`TProperty[]`

而在您的视图模型中，您有一个`List<T>`：

```
public List<MyTypes> EnergyTypeList { get; set; } 
```

在您的视图中，您正在使用：

```
model => model.EnergyTypeList 
```

您的代码不起作用，因为`List<EnergyTypeList>`与`EnergyTypeList[]`.

所以你有不同的可能性。要么更改视图模型中的类型以匹配助手中的类型，要么使用更改助手以使用 List 甚至更好的`IEnumerable<TProperty>`. 这样扩展方法甚至可以使用数组。

# wix - 启动第二个安装程序 WIX

> ID：11346614
> 
> 赞同：0
> 
> 时间：2012-07-05T14:37:50.713
> 
> 标签：wix, exe, custom-action

我最近开始在 wix 中创建安装程序，所以我很新。遇到问题，当用户单击按钮时，我希望第二个安装程序开始使用 .exe 文件。但是我无法让我的代码做到这一点，我对哪一点代码去哪里有点困惑，但我有这三个部分：

```
<Binary Id="HaspInstaller" SourceFile="visual studio 2010\Projects/ExampleInstaller/ExampleInstaller/bin/Debug/HASPUserSetup.exe" />

<CustomAction Id="HaspSetup" BinaryKey="HaspInstaller" ExeCommand="-switch" 
Execute="deferred" Return="check" HideTarget="no" Impersonate="no" />

<Control Id="Hasp" Type="PushButton" X="40" Y="60" Width="56" Height="34" Bitmap="yes"    Text="HaspImage" >
      <Publish Event="DoAction" Value="HaspSetup" /> 
    </Control> 
```

任何帮助将不胜感激..:)

ñ

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T16:28:39.620

由于 Execute 属性设置为 deferred，因此在单击按钮时不会运行。将其标记为立即，它会在您单击按钮后立即运行。

Deferred 用于需要提升并且必须安排到 InstallExecute 序列中时使用。

看看[http://wix.sourceforge.net/manual-wix3/qtexec.htm](http://wix.sourceforge.net/manual-wix3/qtexec.htm)这是安静的执行自定义操作，该页面很好地解释了如何设置延迟执行和立即执行。

此外，如果该 exe 文件是另一个 msi 的引导程序，您将根本无法运行它，因为您已经处于一个 MSI 事务中。在这种情况下，请使用 burn 将不同的安装程序捆绑到单一安装程序的用户体验中。

# sql - 使用一个或多个条件链接和计数记录

> ID：11346621
> 
> 赞同：1
> 
> 时间：2012-07-05T14:38:17.467
> 
> 标签：sql, oracle, join, count, group-by

我正在尝试将一些记录链接在一起以识别兄弟组。我们可以做到这一点的方法是识别具有相同父母的客户。

SQL 示例如下：

```
SELECT
A.ClientID,
B.ParentID

FROM A
LEFT JOIN B ON B.ClientID to A.ClientID
AND B.REL_END is NULL AND B.REL_CODE = 'PAR' 
```

它将以以下格式返回数据：

```
 Client ID     Parent ID
     1             A
     1             B
     2             C
     2             D
     3             C
     3             E
     4             C
     4             D 
```

我希望它如何显示如下：

```
 Client ID    No. of Siblings
     1            0
     2            2
     3            2
     4            2 
```

希望表格显示孩子 1 有 0 个兄弟姐妹（与 2、3、4 没有父母），孩子 2 有 2 个兄弟姐妹（3 和 4），孩子 3 有 2 个兄弟姐妹（2 和 4），孩子 4 有 2 个兄弟姐妹（ 2,3)。看起来它应该很简单来实现这一点，但我现在真的很难想怎么做！我认为这有点令人困惑，因为一个孩子可能只与另一个孩子共享一个父母，以被视为兄弟姐妹。

希望这很清楚，谢谢。

编辑：为了清楚起见，关系是由一个与另一个孩子共享父 ID 的孩子标识的（ID 是唯一的，但我为本示例提供了通用 ID）。因此，孩子 2、3 和 4 都有一个 id 为 C 的父母，他们被视为兄弟姐妹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:36:04.940

您可以尝试此查询，它会向我显示所需的输出。

```
with c_data as (
    select a.clientid, b.parentid, count(a.clientid) over (partition by parentid order by     parentid) as c_parents
    FROM A
      LEFT JOIN B ON (B.ClientID = A.ClientID)
        AND B.REL_END is NULL AND B.REL_CODE = 'PAR'
)
select clientid as "Client ID", max(c_parents) -1 as "No of Siblings"
from c_data
group by clientid; 
```

例子：

```
SQL> with c_data as (
  2  select a.clientid, b.parentid, count(a.clientid) over (partition by parentid order by parentid) as c_parents
  3  FROM A
  4  LEFT JOIN B ON (B.ClientID = A.ClientID)
  5  AND B.REL_END is NULL AND B.REL_CODE = 'PAR'
  6  )
  7  select clientid as "Client ID", max(c_parents) -1 as "No of Siblings"
  8  from c_data
  9  group by clientid;

 Client ID No of Siblings
---------- --------------
         1              0
         2              2
         4              2
         3              2

Transcurrido: 00:00:00.03
SQL> 
```

使用分析函数，我们计算由当前元组相关的 parentid 分区的所有客户端 ID，以计算具有相同父级的所有客户端。

在投影之后，我们得到每个客户端共有的最大父节点数，并减去 1，即客户端本身。

希望这可以帮助！

问候！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:27:56.633

这是相当复杂的。如果您可以假设每个孩子恰好有两个父母，那么您可以执行以下操作：

```
select c.*, count(*) over (partition by min_parent, max_parent) - 1 as NumSiblings
from (SELECT A.ClientID, min(B.ParentID) as min_parent, max(b.parentid) as max_parent
      FROM A LEFT JOIN
           B
           ON B.ClientID to A.ClientID AND B.REL_END is NULL AND B.REL_CODE = 'PAR'
      group by a.clientid
     ) c 
```

这样做是计算每个客户的两个父母。然后它使用 windows 函数来计算具有完全相同父级的客户端的数量。“-1”是因为所有的孩子都被计算在内，我们不想计算当前的孩子。

如果你可以有两个以上的父母，那么查询就更复杂了。

如果您只想共享一个父母（而不是两个），那么您可以使用自联接来处理：

```
with cp as (SELECT A.ClientID, B.ParentID
            FROM A LEFT JOIN
                 B
                 ON B.ClientID to A.ClientID AND B.REL_END is NULL AND B.REL_CODE = 'PAR'
           )
select cp.client_id, count(distinct cp1.client_id) as NumSiblings
from cp left outer join
     cp cp1
     on cp.parent_id = cp1.parent_id and cp.client_id <> cp1.client_id
group by cp.client_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:55:15.860

好吧，我不明白表格和关系是如何制作的，但你可以这样做：

```
SELECT ClientID, sum(NumberOfSibling) as NumberOfSibling
from(
    SELECT A.ClientID, (select count(ClientID) 
                        from A2
                        LEFT JOIN B2 ON B2.ClientID to A2.ClientID
                        AND B2.REL_END is NULL AND B2.REL_CODE = 'PAR'
                        where B2.ParentID = B.ParentID) as NumberOfSibling
    FROM A
    LEFT JOIN B ON B.ClientID to A.ClientID
    AND B.REL_END is NULL AND B.REL_CODE = 'PAR'
) GROUP BY ClientID 
```

说明：我接受了您的请求并修改了第二个结果以返回拥有相同父级的兄弟姐妹的总和（也就是说`the select count(*) ...`，这也是我不确定条件的部分）。并将其放在另一个中，按 ClientID 分组，以获得 2 个父母的总和。

# html - 拥有该文件是否无效/令人困惑 在文档中间

> ID：11346630
> 
> 赞同：1
> 
> 时间：2012-07-05T14:38:34.410
> 
> 标签：html, accessibility, semantic-markup

我目前有这样的设置：

```
<section id="intro"></section>
<header></header>
<section></section>
<section></section>
<footer></footer> 
```

header 元素是带有站点名称和基本信息的粘性标题。它直到用户滚动过去#intro 之后才会显示，因此它在 DOM 中的位置。我想知道，从语义和可访问性的角度来看，将其设为 div 或 section 是否更有意义。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T14:47:07.743

`<header>`标签[不需要位于文档中的特定位置](http://www.w3.org/TR/html-markup/header.html)，除非它不应该是 another `<header>`、 a`<footer>`或`<address>`标签的子级。`<div>`另一方面，强烈建议将[元素仅作为最后手段元素](http://www.w3.org/TR/html5/the-div-element.html)，当另一个元素在语义上更适合时避免使用。看起来你的用法`<header>`很适合它的推荐用法，但你应该记住 IE8 和更早的版本不支持它，并且这些浏览器实际上是不合时宜的。

# java - 更改符号模式/匹配器中的标签

> ID：11346633
> 
> 赞同：0
> 
> 时间：2012-07-05T14:38:40.993
> 
> 标签：java, regex

此代码工作正常：

```
final String result = myString.replaceAll("<tag1>", "{").replaceAll("<tag2>", "}"); 
```

但我必须解析大文件，所以我问我是否可以`Pattern.compile("REGEX");`在`while`：

```
Patter p = Pattern.compile("REGEX");
while(scan.hasNextLine()){
     final String myWorkLine = scan.readLine();
     p.matcher(s).replaceAll("$1"); // or other value
     ..;
} 
```

我期望更快的结果，因为正则表达式编译是一次且只有一次。

*编辑*

我想（如果可能的话）将`replaceAll(..).replaceAll(..)`模型放在 Pattern 中，并有`tag1`==>`{`和`tag2`==> `}`。

问题：*外循环* `Pattern`模型比*内循环* `replaceAll.replaceAll`模型快吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:59:50.653

要回答您最初的问题：是的，您可以这样做，而且如果您在循环中多次应用*相同*的正则表达式，它确实会比您的原始代码更快。你的循环应该这样重写：

```
Pattern p1 = Pattern.compile("REGEX1");
Pattern p1 = Pattern.compile("REGEX1");
while (scan.hasNextLine()) {
    String myWorkLine = scan.readLine();
    myWorkLine = p1.matcher(myWorkLine).replaceAll("replacement1");
    myWorkLine = p2.matcher(myWorkLine).replaceAll("replacement2");
    ...;
} 
```

但是，如果您没有使用正则表达式，正如您的第一个示例所建议的 ( `"<tag1>"`)，那么请不要使用`String.replaceAll(String regex, String replacement)`，因为正则表达式会更慢。而是使用`String.replace(CharSequence target, CharSequence replacement)`, 因为它不适用于正则表达式并且速度更快。

例子：

```
"ABAP is fun! ABAP ABAP ABAP".replace("ABAP", "Java"); 
```

请参阅：[String.replace 的 Java 文档](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#replace%28java.lang.CharSequence,%20java.lang.CharSequence%29)

从根本上改变您的问题并不好，但是好的，这里再次为您的正则表达式提供答案：

```
String s1
       = "You can <bold>have nice weather</bold>, but <bold>not</bold> always!";
//EDIT: the regex was 'overengineered', and .?? should have been .*?
//String s2 = s1.replaceAll("(.*?)<bold>(.*?)</bold>(.??)", "$1{$2}$3");
String s2 = s1.replaceAll("<bold>(.*?)</bold>", "{$1}");

System.out.println(s2); 
```

输出：`You can {have nice weather}, but {not} always!`

这是带有这个新正则表达式的循环，是的，这将比原始循环更快：

```
//EDIT: the regex was 'overengineered'
Pattern p = Pattern.compile("<bold>(.*?)</bold>");
while (scan.hasNextLine()) {
    String myWorkLine = scan.readLine();
    myWorkLine = p.matcher(myWorkLine).replaceAll("{$1}");
    ...;
} 
```

编辑：
这里是[Java RegEx 语法结构的描述](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#sum)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:59:38.223

`replaceAll`使用正则表达式模式。从 java.lang.String[源代码](http://www.docjar.com/html/api/java/lang/String.java.html)：

```
public String replaceAll(String regex, String replacement) {
    return Pattern.compile(regex).matcher(this).replaceAll(replacement);
} 
```

**Edit1：**请停止更改您的要求。选择一个问题并坚持下去。

**编辑2：**

如果您真的确定要这样做，在循环之外编译正则表达式，在最简单的情况下，您需要两种不同的模式：

```
Pattern tag1Pattern = Pattern.compile("<tag1>");
Pattern tag2Pattern = Pattern.compile("<tag2>");
while( scan.hasNextLine() ) {
    String line = scan.readLine();
    String modifiedLine = tag1Pattern.matcher(line).replaceAll("{");
    modifiedLine = tag2Pattern.matcher(line).replaceAll("}");
    ...
} 
```

您仍然每行应用模式匹配器两次，所以如果有任何性能问题，那就是原因。

在不知道您的数据是什么样子的情况下，很难为您提供更准确的答案或更好的正则表达式。除非您在我写这篇文章时（再次）编辑了您的问题。

# javascript - 如何重定向到给定的一组网站中的一个？

> ID：11346639
> 
> 赞同：2
> 
> 时间：2012-07-05T14:39:02.850
> 
> 标签：javascript, redirect, userscripts

我创建了一个用户脚本来重定向到指定的多个站点中的一个：

```
// ==UserScript==
// @id             fvhfy464
// @name           [udit]redirector to yahoo or google
// @version        1.0
// @namespace      
// @author         
// @description    
// @include        http://yahoo.com
// @include        http://google.com
// @include        http://bing.com
// @run-at         document-end
// ==/UserScript==

setTimeout(function() {
    window.location.href("http://yahoo.com","http://google.com","http://bing.com")
}, 4000); 
```

但它不起作用。

*（来自评论：）*
我想以随机方式在一个选项卡中打开多个站点，一个接一个，时间间隔为 4 秒。它就像网站的屏幕保护程序。

它可以永远消失。要停止，我只需要关闭选项卡。而且，我只会将那些网站设置在`@include`我希望这个脚本在其中工作的那些网站上。它就像照片等的屏幕保护程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T16:06:36.740

将要显示的站点列表放入数组中。然后您可以关闭当前页面并按顺序转到下一个页面，或者选择一个随机的下一个页面。

例如，这是一个有序的幻灯片：

```
// ==UserScript==
// @name        Multipage, MultiSite slideshow of sorts
// @match       http://*.breaktaker.com/*
// @match       http://*.imageshack.us/*
// @match       http://static.tumblr.com/*
// @match       http://withfriendship.com/images/*
// ==/UserScript==

var urlsToLoad  = [
    'http://www.breaktaker.com/albums/pictures/animals/BigCat.jpg'
    , 'http://img375.imageshack.us/img375/8105/bigcats34ye4.jpg'
    , 'http://withfriendship.com/images/g/33769/1.jpg'
    , 'http://static.tumblr.com/yd0wcto/LXQlx109d/bigcats.jpg'
];

setTimeout (GotoNextURL, 4000);

function GotoNextURL () {
    var numUrls     = urlsToLoad.length;
    var urlIdx      = urlsToLoad.indexOf (location.href);
    urlIdx++;
    if (urlIdx >= numUrls)
        urlIdx = 0;

    location.href   = urlsToLoad[urlIdx];
} 
```

* * *

* * *

以下是随机提供的相同网站：

```
// ==UserScript==
// @name        Multipage, MultiSite slideshow of sorts
// @match       http://*.breaktaker.com/*
// @match       http://*.imageshack.us/*
// @match       http://static.tumblr.com/*
// @match       http://withfriendship.com/images/*
// ==/UserScript==

var urlsToLoad  = [
    'http://www.breaktaker.com/albums/pictures/animals/BigCat.jpg'
    , 'http://img375.imageshack.us/img375/8105/bigcats34ye4.jpg'
    , 'http://withfriendship.com/images/g/33769/1.jpg'
    , 'http://static.tumblr.com/yd0wcto/LXQlx109d/bigcats.jpg'
];

setTimeout (GotoRandomURL, 4000);

function GotoRandomURL () {
    var numUrls     = urlsToLoad.length;
    var urlIdx      = urlsToLoad.indexOf (location.href);
    if (urlIdx >= 0) {
        urlsToLoad.splice (urlIdx, 1);
        numUrls--;
    }

    urlIdx          = Math.floor (Math.random () * numUrls);
    location.href   = urlsToLoad[urlIdx];
} 
```

# .net - 如何阅读 Microsoft Outlook 中集成的应用程序项

> ID：11346642
> 
> 赞同：1
> 
> 时间：2012-07-05T14:39:09.980
> 
> 标签：.net, office-interop

我有一个（文档管理系统）应用程序，它集成在 Microsoft Outlook 中，它在标题、文档版本、作者等列中提供不同邮件项目部分的结果。问题：我能够从收件箱文件夹，但不是此集成应用程序的搜索结果。

似乎我无法读取结果，因为它不是 Outlook 互操作对象的一部分。

有人可以帮我阅读结果吗？

# c# - 使用 c# LINQ 将字节数组与子数组拆分

> ID：11346643
> 
> 赞同：0
> 
> 时间：2012-07-05T14:39:10.980
> 
> 标签：c#, arrays, linq, indexing, split

我遇到了更进一步的问题：

我有一个像 {0xNN, 0xNN, 0xNN, 0xNN, 0xFF, 0xFF, 0xNN, 0xNN, 0xFF, 0xFF} 这样的数组，其中 {0xFF, 0xFF} 是一个分隔符。

是否可以使用 LINQ 获得像 {{0xNN, 0xNN, 0xNN, 0xNN} , {0xNN, 0xNN}} 这样的枚举？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:33:10.583

你可以写一个这样的扩展，用任何长度的分隔符一次性完成这项工作。

```
public static class Extensions
{
    public static IEnumerable<IEnumerable<T>> Split<T>(
        this IEnumerable<T> source,
        IEnumerable<T> delimiter)
    {
       var delimiterList = delimiter.ToList();
       var outputBuffer = new List<T>();
       var m = 0;

       foreach(var item in source)
       {
           if item.Equals(delimiterList[m])
           {
               m++;

               if(m == delimiterList.Count)
               {
                  m = 0;

                  if (outputBuffer.Count > 0)
                  {
                      yield return outputBuffer;
                      outputBuffer = new List<T>();
                  }
               }
           }
           else
           {
               outputBuffer.AddRange(delimiterList.Take(m));

               if (item.Equals(delimiterList[0]))
               {
                   m = 1;
               }
               else
               {
                   m = 0;
                   outputBuffer.Add(item);
               }
           }              
       }

       outputBuffer.AddRange(delimiterList.Take(m)); 

       if (outputBuffer.Count > 0)
       {
           yield return outputBuffer;
       }
   }
} 
```

你可以像这样使用它。

```
var joinedBytes = new byte[] { ... }
var delimiter = new byte[] { 0xFF, 0xFF }

var splitBytes = joinedBytes.Split(delimiter); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-05T15:16:24.657

我认为你不能在 LINQ 中做到这一点，因为你的分隔符是由集合的两个元素定义的。

# windows-phone-7 - 如何使用后台应用程序？

> ID：11346644
> 
> 赞同：0
> 
> 时间：2012-07-05T14:39:14.633
> 
> 标签：windows-phone-7

我创建了一个在特定时间触发视频的应用程序，类似于警报，但我面临的问题是，当我退出应用程序并设置了视频不显示的时间时（即类似于警报，我应该收到通知在我的应用程序之外）。请帮助我。非常感谢任何有用的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:44:02.803

当应用程序未运行时，您无法预测其后台进程将在什么时间执行，因此您无法设置任何小于一小时的精度的警报。使时间接近准确的唯一方法是使用来自服务器的推送通知。即使这样，您收到的通知也无法自行打开和播放视频。您可以创建一个推送/toast 通知，该通知源自服务器，向用户发送 toast，用户点击它，然后打开应用程序播放视频。如果没有用户干预，您将无法做到这一点。

请参阅此链接以获取概述，包括对后台代理的限制：http: [//msdn.microsoft.com/en-us/library/hh202942 (v=VS.92).aspx](http://msdn.microsoft.com/en-us/library/hh202942(v=VS.92).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:48:29.187

您无法打开应用程序并从后台代理播放视频。您可以显示允许用户打开应用程序的 toast 通知。您可以使用[Scheduled Agent](http://msdn.microsoft.com/en-us/library/hh202965%28v=vs.92%29.aspx)或[PeriodicTask](http://msdn.microsoft.com/en-us/library/microsoft.phone.scheduler.periodictask%28v=vs.92%29.aspx)。然后您可以使用[ShellToast](http://msdn.microsoft.com/en-us/library/microsoft.phone.shell.shelltoast%28v=VS.92%29.aspx)显示 toast 通知，以便用户可以打开应用程序。打开应用程序后，您可以开始播放视频。

# jsf - PrimeFaces 3.3.1 p:dialog 不显示。错误：widgetVar 未定义

> ID：11346645
> 
> 赞同：2
> 
> 时间：2012-07-05T14:39:15.020
> 
> 标签：jsf, jsf-2, primefaces, migration

我正在将一个初始项目从 PrimeFaces 2.2.1 迁移到 3.3.1，遵循[MigrationGuide](http://code.google.com/p/primefaces/wiki/MigrationGuide)的步骤并使用[3.3 版本的用户指南](http://primefaces.googlecode.com/files/primefaces_users_guide_3_3.pdf)。

我想要一个*p:dialog*在页面顶部，包含导航。当我单击页面顶部的*链接*时，必须显示此对话框。

**错误描述：**

1.  当我单击“我想要”链接时，页面上什么也没有发生（p:dialog 没有显示），并且我在 Firebug 的控制台上收到此错误：

    ```
    popupModalMenu is not defined
    http://localhost:8080/{appname}/view/xhtml/principal.jsf
    Line 1 
    ```

2.  *p:dialog* (id= " modalMenu") 在页面上加载。

结构如下：

**主页（/view/xhtml/principal.xhtml）：**

```
<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:h="http://java.sun.com/jsf/html" 
    xmlns:f="http://java.sun.com/jsf/core" 
    xmlns:ui="http://java.sun.com/jsf/facelets" 
    xmlns:p="http://primefaces.org/ui"> 
    <ui:composition  template="base/master.xhtml"> 
        <ui:define name="conteudo"> 
                     Title of Main Page
        </ui:define> 
    </ui:composition> 
</html> 
```

**大师（/view/xhtml/base/master.xhtml）：**

```
<html><!-- DOCTYPE GOES HERE -->
    <ui:include src="head.xhtml" /> <!-- CONTAINS CSS, JAVASCRIPT STUFF -->
    <h:body>
            <f:view contentType="text/html" >   
            <div id="wrapper">          
                <!-- TOP BEGIN -->
                <div id="header">
                    <div class="topo" id="topo">
                        <div id="menuTopo" class="menu left">
                            <a id="linkMenu" class="left" href="javascript:;" onclick="popupModalMenu.show();">
                                I want
                                <div class="iconeDoMenu"></div>
                            </a>
                        </div>
                    </div>                  
                </div>
                <!-- END TOP -->
                <!-- CONTENT BEGIN -->
                <div id="content">
                    <div id="conteudo">
                    <!-- SYSTEM MENU BEGIN -->
                        <ui:include src="../menu.xhtml" />
                    <!-- END SYSTEM MENU -->
                    </div>
                </div>
                <!-- END CONTENT -->
            </div>
            </f:view>
    </h:body>
</html> 
```

**头（/view/xhtml/base/head.xhtml）：**

```
<html><!-- DOCTYPE GOES HERE -->
    <h:head>
        <title>Title</title>
        <meta http-equiv="keywords" content=" " />
        <meta http-equiv="description" content=" " />
        <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" />

        <link rel="stylesheet" type="text/css" href="../css/base/reset.css" /> 
        <link rel="stylesheet" type="text/css" href="../css/base/general.css" />
        <link rel="stylesheet" type="text/css" href="../css/base/skin.css" />
        <link rel="stylesheet" type="text/css" href="../css/primefaces/primefaces.css"/>

        <!--[if IE 7]>
            <link rel="stylesheet" type="text/css" href="../css/base/generalIE7.css" />
        <![endif]-->

        <!--[if IE 8]>
            <link rel="stylesheet" type="text/css" href="../css/base/generalIE8.css" />
        <![endif]-->

        <script type="text/javascript">
            jQuery.noConflict();
        </script>

        <script language="javascript" type="text/javascript" src="#{facesContext.externalContext.request.contextPath}/view/js/currency_mask.js"></script>
        <script language="javascript" type="text/javascript" src="#{facesContext.externalContext.request.contextPath}/view/js/date_mask.js"></script>
        <script type="text/javascript" src="../js/ourjs.js"></script>

        <!-- Internal screen's Css -->
        <link href="../css/generalUtilScreen.css" media="all" rel="stylesheet" type="text/css"/>

        <!-- menu's scripts and css -->
        <link href="../css/base/menu.css" media="all" rel="stylesheet" type="text/css"/>
        <script type="text/javascript" src="../js/jquery.metadata.js"></script>
        <script type="text/javascript" src="../js/jquery.mb.flipText.js"></script>
        <script type="text/javascript" src="../js/mbExtruder.js"></script>
        <script type="text/javascript">
        $(function(){
            $("#extruderLeft").buildMbExtruder({
                position:"left",
                width:300,
                extruderOpacity:.8,
                hidePanelsOnClose:true,
                accordionPanels:true,
                onExtOpen:function(){},
                onExtContentLoad:function(){},
                onExtClose:function(){}
            });
        });
        </script><!-- menu's scripts and css end -->
        <!-- Scripts inside menu -->
        <h:outputStylesheet library="primefaces/jquery/ui" name="jquery-ui.css"/>
        <h:outputScript library="primefaces/jquery/ui" name="jquery-ui.js" target="head"/>

        <script type="text/javascript">
        $(function(){
            // Accordion
            $("#accordion").accordion({ header: "h3" });
        });
        </script><!-- end Scripts inside menu -->

            <script type="text/javascript" src="../js/verticaltabs.pack.js"></script> <!--http://dean.edwards.name/packer/-->
        <link rel="stylesheet" href="../css/base/verticaltabs.css" />
        <script type="text/javascript" src="../js/provider.js"></script>
        <script type="text/javascript">
        $(document).ready(function(){fornecedor.verticalTabs();});
        </script>

            <!-- Internal screen's Css -->              
            <link href="../css/provider.css" rel="stylesheet" type="text/css"></link>
         <!--  END PROVIDER -->

    </h:head>
</html> 
```

**菜单（/view/xhtml/menu.xhtml）：**

```
<html><!-- DOCTYPE GOES HERE -->
    <p:dialog   id="modalMenu" widgetVar="popupModalMenu" 
            draggable="false" resizable="false" modal="true"
            width="940" height="580"
            showEffect="fade" hideEffect ="fade"
            position="null" closable="false" dynamic="false" 
            minimizable="false" maximizable="false">
        <h:form id="formMenu">
            <div id="nav">
                <div id="menu">
                    <p:commandButton id="btnCloseModalMenu" styleClass="btcloseMenu" 
                        title="Click here to close" onclick="popupModalMenu.hide();">
                    </p:commandButton>
                    <!-- Menu's content goes this way: -->
                    <div id="divN"> 
                        <!-- Group of content -->
                                <h3><h:outputLabel>Group N</h:outputLabel></h3>
                                <div class="linkN">
                                    <!-- Links to pages -->
                            <ul>
                                <li><a id="menuN" href="urlN">Title N</a></li>
                                    </ul>
                                </div>
                            </div>  
                </div>
            </div>
        </h:form>
    </p:dialog>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-22T14:14:06.143

我刚刚从 Head 中删除了一些代码。似乎它与JQuery的版本冲突。感谢一位同事。

所以代码是这样的：

**头（/view/xhtml/base/head.xhtml）：**

```
<html><!-- DOCTYPE GOES HERE -->
    <h:head>
        <title>Title</title>
        <meta http-equiv="keywords" content=" " />
        <meta http-equiv="description" content=" " />
        <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" />

        <link rel="stylesheet" type="text/css" href="../css/base/reset.css" /> 
        <link rel="stylesheet" type="text/css" href="../css/base/general.css" />
        <link rel="stylesheet" type="text/css" href="../css/base/skin.css" />
        <link rel="stylesheet" type="text/css" href="../css/primefaces/primefaces.css"/>

        <!--[if IE 7]>
            <link rel="stylesheet" type="text/css" href="../css/base/generalIE7.css" />
        <![endif]-->

        <!--[if IE 8]>
            <link rel="stylesheet" type="text/css" href="../css/base/generalIE8.css" />
        <![endif]-->

        <!-- REMOVED
        <script type="text/javascript">
            jQuery.noConflict();
        </script>
        -->

        <script language="javascript" type="text/javascript" src="#{facesContext.externalContext.request.contextPath}/view/js/currency_mask.js"></script>
        <script language="javascript" type="text/javascript" src="#{facesContext.externalContext.request.contextPath}/view/js/date_mask.js"></script>
        <script type="text/javascript" src="../js/ourjs.js"></script>

        <!-- Internal screen's Css -->
        <link href="../css/generalUtilScreen.css" media="all" rel="stylesheet" type="text/css"/>

        <!-- menu's scripts and css -->
        <link href="../css/base/menu.css" media="all" rel="stylesheet" type="text/css"/>
        <script type="text/javascript" src="../js/jquery.metadata.js"></script>
        <script type="text/javascript" src="../js/jquery.mb.flipText.js"></script>
        <script type="text/javascript" src="../js/mbExtruder.js"></script>
        <script type="text/javascript">
        $(function(){
            $("#extruderLeft").buildMbExtruder({
                position:"left",
                width:300,
                extruderOpacity:.8,
                hidePanelsOnClose:true,
                accordionPanels:true,
                onExtOpen:function(){},
                onExtContentLoad:function(){},
                onExtClose:function(){}
            });
        });
        </script><!-- menu's scripts and css end -->
        <!-- Scripts inside menu -->
        <h:outputStylesheet library="primefaces/jquery/ui" name="jquery-ui.css"/>
        <h:outputScript library="primefaces/jquery/ui" name="jquery-ui.js" target="head"/>

        <script type="text/javascript">
        $(function(){
            // Accordion
            $("#accordion").accordion({ header: "h3" });
        });
        </script><!-- end Scripts inside menu -->

            <script type="text/javascript" src="../js/verticaltabs.pack.js"></script> <!--http://dean.edwards.name/packer/-->
        <link rel="stylesheet" href="../css/base/verticaltabs.css" />
        <script type="text/javascript" src="../js/provider.js"></script>
        <script type="text/javascript">
        $(document).ready(function(){fornecedor.verticalTabs();});
        </script>

            <!-- Internal screen's Css -->              
            <link href="../css/provider.css" rel="stylesheet" type="text/css"></link>
         <!--  END PROVIDER -->

    </h:head>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T18:20:25.613

1.  放在`<h:head/>`head.xhtml中
2.  您在 master.xhtml 文件中缺少一个`</div>`标签`<!-- END SYSTEM MENU -->`

# ms-access - 导入 MS Word 表单字段以访问 - 缺少参考？

> ID：11346649
> 
> 赞同：0
> 
> 时间：2012-07-05T14:39:28.117
> 
> 标签：ms-access, vba, ms-word

我正在尝试从 MS Word 表单字段将数据导入 access 2007。
我已经按照这里的教程：http: [//msdn.microsoft.com/en-us/library/aa155434 (v=office.10).aspx](http://msdn.microsoft.com/en-us/library/aa155434(v=office.10).aspx)

当我运行 VBA 代码时，我收到一个编译错误，上面写着“**未定义用户定义的类型**”。在做了一些研究之后，我发现这很可能是因为我缺少对对象库中对象的引用。
我引用了以下对象库：

1.  适用于应用程序的 Visual Basic
2.  Microsoft Access 12.0 对象库
3.  奥莱自动化
4.  Microsoft Office 12.0 数据库引擎 对象库
5.  Microsoft Word 12.0 对象库

在此处调用 sub 时会引发错误：

```
Sub GetWordData() 
```

我错过了参考，还是我有其他问题？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:41:30.477

确保您已设置对`Microsoft ActiveX Data Objects x.x Library`.

在代码窗口中，选择 Tools->References，滚动到库并勾选它。

请注意，使用库引用而不是后期绑定 ( `Create.Object("Word.Application")`) 可以更轻松地访问属性和方法，但可能意味着您的代码将无法在其他环境中运行。

# .net - WinForms 应用程序的常见漏洞

> ID：11346652
> 
> 赞同：12
> 
> 时间：2012-07-05T14:39:46.827
> 
> 标签：.net, winforms, security, owasp

我不确定这是否是主题，但它是如此特定于 .NET WinForms，我相信它在这里比在 Security stackexchange 站点更有意义。

***（此外，它与安全编码**严格相关，我认为它与任何关于我在整个网站上看到的常见网站漏洞的问题一样重要。）*

多年来，我们的团队一直在对网站项目进行威胁建模。我们模板的一部分包括[OWASP](https://www.owasp.org/index.php/Main_Page)前 10 名以及其他众所周知的漏洞，因此当我们进行威胁建模时，我们始终确保我们有一个记录在案的流程来解决这些常见漏洞中的每一个。

例子：

**SQL 注入 (Owasp A-1)**

*   标准实践
    *   尽可能使用存储参数化过程来访问数据
    *   如果存储过程不可行，请使用参数化查询。（使用我们无法修改的第 3 方数据库）
    *   仅当上述选项不可行时才转义单引号
    *   数据库权限必须按照最小权限原则设计
    *   默认情况下，用户/组无权访问
    *   在开发过程中，记录每个对象（表/视图/存储过程）所需的访问权限以及访问的业务需求。
    *   [剪辑]

无论如何，我们使用 OWASP Top 10 作为网站特定漏洞的起点。

（最后是问题）

在极少数情况下，当 Web 应用程序不能满足需求时，我们会开发 WinForms 或 Windows 服务应用程序。我想知道是否有 WinForms 应用程序的常见安全漏洞的等效列表。

在我的头顶上，我能想到一些......

*   SQL 注入仍然是一个问题。
*   CLR 通常可以防止缓冲区溢出，但如果将非托管代码与托管代码混合使用则更有可能
*   .NET 代码可以反编译，因此将敏感信息存储在代码中，而不是在 app.config 中加密...

是否有这样一个列表，甚至是这样一个列表的多个版本，我们可以从中借用来创建我们自己的列表？如果是这样，我在哪里可以找到它？

我一直没能找到它，但如果有的话，这对我们以及其他 WinForms 开发人员都会有很大帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-05T15:13:16.987

Web 环境和桌面环境之间存在很大差异。在开发网站和服务时，您不信任的是用户（用户输入）。在运行桌面应用程序时，不受信任的是应用程序本身，或者至少，系统管理员想知道应用程序本身是否不会造成任何伤害，因为在本地计算机上运行的代码是有风险的通过它自己。

所以从某种意义上说，对于作为桌面应用程序开发人员的您来说，安全规则并不总是适用，因为您运行的应用程序不是黑盒子，而是白盒子。对于 Web 服务/站点，您希望攻击无法更改内部状态，但对于任何桌面应用程序（Java、.NET、本机），在应用程序运行时更改应用程序状态“相当”容易运行，尤其是使用 Java 和 .NET，调试和反编译应用程序非常容易。

换句话说，您必须考虑到桌面应用程序已完全受损，如果这是一种风险，您必须将所有必须安全的内容（身份验证、授权、验证）提取到外部（Web）服务中。对于此服务，“正常”OWASP 规则适用。

您应该注意的是，当桌面应用程序直接连接到数据库时，很难完全保护您的数据层。例如，在这种情况下，SQL 注入对于您的桌面应用程序来说不是问题，因为当应用程序可以直接连接到数据库时，用户也可以。如果用户可以连接到数据库，他就可以执行任意查询。这是一种极端形式的 SQL 注入，但它完全跳过了您的应用程序。

试图保护 2 层应用程序，通常意味着使用存储过程作为中间（服务）层（并防止直接访问表）。开发和维护存储过程比开发 .NET (web) 服务的成本要高得多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-06T08:19:54.637

也许您想调查检查安全漏洞的现有工具。他们有时会列出要检查的缺陷。

托管代码中仍然存在所有可能的安全风险，因为开发人员可以打开各种漏洞。框架 (.NET) 本身没有风险，但开发人员有风险。

在这里你有一个工具列表，你可以在那里阅读他们将检查哪些安全风险：

[静态代码分析列表](http://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis)

但是，当然，存在已知的漏洞，如您在此处看到的：

[technet 远程代码执行](http://technet.microsoft.com/en-us/security/bulletin/MS07-040)

[technet 特权提升](http://technet.microsoft.com/en-au/security/bulletin/ms11-100)

还有更多已知且未解决的缺陷，可以在知名的安全站点上找到。（包括零日攻击）

**更多详细信息，这是我在评论中提到的清单**

[MS 安全清单（不知道为什么这是“退休”，因为这主要是中性信息](http://msdn.microsoft.com/en-us/library/ms998249.aspx)

[打开 Web 应用程序安全项目](https://www.owasp.org/index.php/Top_10_2007)

[MS 反跨站点脚本](http://msdn.microsoft.com/en-us/library/aa973813.aspx)

[MS ASP 安全参考实现（非常好的资料网站）](http://archive.msdn.microsoft.com/ASPNETv2RefImp)

[CAT.NET ... MS 静态安全分析工具](http://channel9.msdn.com/blogs/jossie/architecture-behind-catnet)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-15T07:01:49.763

恐怕不可能构建一个实际上安全的本地 Winform 应用程序，因为用户总是可以破解您的应用程序。

但是有一些技术可以减缓破解过程。大多数技术发生在组装层，例如垃圾代码和包装。

另一种技术是使您的可执行代码（即程序执行时进入内存的代码）随时间变化。但是，您必须首先确保所有其他代码（然后不执行）是安全的。这可以通过加密来完成。但是您还必须确保加密程序的安全性更高。加密程序始终固定在 ROM 中，并通过物理方式进行保护。

另一种方法是利用网络。经常更新本地应用程序并禁止使用旧版本。这样，您的代码可能会以足够快的速度变化以击败破解过程。

哦……我是在扔垃圾还是只是跑题了？我很抱歉。

# php - PHP For循环生成动态图像

> ID：11346653
> 
> 赞同：0
> 
> 时间：2012-07-05T14:39:48.980
> 
> 标签：php, zend-framework, mongodb

我有一个页面需要为每篇文章生成缩略图。每个缩略图的数量会有所不同，因此我想检查数据库中的文章并为所有缩略图创建一个数组，但我正在努力解决逻辑问题。

这是我到目前为止所拥有的：

```
for ($i=1; $i<20; $i++) {
  $thumbImages = array(
    'src' => $newblogDoc['tvs']['thumbnail-image-' . [$i]]
  );
} 
```

这是正确的方向吗？有没有更有效的方法将其放入数组中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:44:33.520

你的问题不是很清楚，但如果你想创建一个关联数组，那么你需要这样做：

```
for( $i=1; $i<20; $i++){
$thumbImages[] = array(
                'src' => $newblogDoc['tvs']['thumbnail-image-'.[$i]]
                );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:43:58.713

您现在拥有的代码每次都用一个新数组覆盖 $thumbImages。您要做的是在循环之前创建一个新数组，然后在循环内追加到该数组。如此：

```
$thumbImages = array();
for ($i=1; $i<20; $i++){
    $thumbImages[] = $newblogDoc['tvs']['thumbnail-image-'.[$i]];
} 
```

# c# - ASP.Net 将控件添加到占位符控件失败

> ID：11346656
> 
> 赞同：1
> 
> 时间：2012-07-05T14:39:56.767
> 
> 标签：c#, asp.net

我正在将一组控件添加到按钮单击事件的占位符中。我可以添加一次控件，但第二次收到此消息。我正在使用 Ajax Toolkit 来制作一些自定义控件。

> System.InvalidOperationException 发生 Message=Extender 控件可能未在 PreRender 之后注册。Source=System.Web.Extensions StackTrace：在 System.Web.UI.ScriptControlManager.RegisterExtenderControl[TExtenderControl](TExtenderControl extenderControl, Control targetControl)。

代码如下：

```
 /// <summary>
        /// Handles the Click event of the AddWitnessButton control.
        /// </summary>
        /// <param name="sender">The source of the event.</param>
        /// <param name="e">The <see cref="System.EventArgs"/> instance containing the event data.</param>
        /// <remarks></remarks>
        protected void AddWitnessButton_Click(object sender, EventArgs e)
        {

            int count = Convert.ToInt32(WitnessCountHiddenField.Value);
            var fullNameTextBoxId = "FullNameEnhancedTextBox" + count;
            var mobileFilteredTextBoxId = "MobileFilteredTextBox" + count;
            IList<Panel> oldPanels = (IList<Panel>)Session["WitnessPanels"] ?? new List<Panel>();

            //Container
            Panel panel = new Panel();

            //Seperator
            Literal hr = new Literal { Text = "<HR/>" };

            //Full Name
            Label fullNameLabel = new Label
            {
                ID = fullNameTextBoxId + "_Label",
                AssociatedControlID = fullNameTextBoxId,
                Text = "Full Name:"
            };
            EnhancedTextBox fullNameEnhancedTextBox = new EnhancedTextBox
            {
                ID = fullNameTextBoxId,
                Required = true,
                RequiredErrorText = "Full Name is a required field."
            };

            //Mobile
            Label mobileLabel = new Label
            {
                ID = mobileFilteredTextBoxId + "_Label",
                AssociatedControlID = mobileFilteredTextBoxId,
                Text = "Mobile:"
            };
            FilteredTextBox mobileFilteredTextBox = new FilteredTextBox
            {
                ID = mobileFilteredTextBoxId,
                FilterMode = FilterModes.ValidChars,
                ValidChars = "0123456789+()",
                Required = true,
                RequiredErrorText = "Mobile is a required field."
            };

            //Readd previously added panels
            foreach (var addedPanel in oldPanels)
            {
                AddWitnessPlaceHolder.Controls.Add(addedPanel);
            }

            //Add new controls to the form
            Panel newPanel = new Panel();

            newPanel.Controls.Add(hr);
            newPanel.Controls.Add(fullNameLabel);
            newPanel.Controls.Add(fullNameEnhancedTextBox);
            newPanel.Controls.Add(mobileLabel);
            newPanel.Controls.Add(mobileFilteredTextBox);

            AddWitnessPlaceHolder.Controls.Add(newPanel);

            //Increment the ID count
            count++;
            WitnessCountHiddenField.Value = count.ToString();

            //Save the panel to the Session.
            oldPanels.Add(newPanel);
            Session["WitnessPanels"] = oldPanels;

            //Go back to the same wizard step.
            ShowStep2HiddenField.Value = "false";
            ShowStep3HiddenField.Value = "true";
        }

 protected void Page_PreRender(object sender, EventArgs e)
        {
            if(IsPostBack)
            {
                //Readd previously added panels
                var vehicleControls = (IList<Panel>)Session["VehiclePanels"] ?? new List<Panel>();

                if (vehicleControls.Any())
                {
                    foreach (var addedPanel in vehicleControls)
                    {
                        AddVehiclePlaceholder.Controls.Add(addedPanel);
                    }

                }

                var witnessControls = (IList<Panel>)Session["WitnessPanels"] ?? new List<Panel>();

                if (witnessControls.Any())
                {
                    foreach (var addedPanel in witnessControls)
                    {
                        AddWitnessPlaceHolder.Controls.Add(addedPanel);

                    }

                }
            }
        } 
```

# jquery - 更改fancybox中的“下一个”/“上一个”链接标题

> ID：11346661
> 
> 赞同：3
> 
> 时间：2012-07-05T14:40:06.420
> 
> 标签：jquery, fancybox, fancybox-2

我正在尝试（使用 fancybox 2.0.6）将链接标题（“下一个”、“上一个”）更改为不同的内容：

```
beforeLoad: function() {
      jQuery('.fancybox-next').each(function() {
        var $this = jQuery(this);
        $this.attr('title', 'Далі');
      });
    } 
```

请问，有什么问题吗？我是否尝试使用正确的回调？还有什么？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-08T02:51:14.303

以这种方式使用选项更改和链接的`title`属性`next``prev``tpl`

```
$("a.fancybox").fancybox({
 tpl: {
  next: '<a title="Siguiente" class="fancybox-nav fancybox-next"><span></span></a>',
  prev: '<a title="Anterior" class="fancybox-nav fancybox-prev"><span></span></a>'
 }
}); // fancybox 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-08T13:14:11.260

他们现在在新网站上有更好的文档：http: [//fancyapps.com/fancybox/#docs](http://fancyapps.com/fancybox/#docs)

可能的 TPL：

```
{
    wrap     : '<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',
    image    : '<img class="fancybox-image" src="{href}" alt="" />',
    iframe   : '<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0"' + ($.browser.msie ? ' allowtransparency="true"' : '') + '></iframe>',
    error    : '<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',
    closeBtn : '<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',
    next     : '<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',
    prev     : '<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-02T04:43:48.950

这是使用 jquery 插件时的常见问题。一般的解决方案是用自定义选项替换插件的默认选项。对于fancybox，与“next”和“prev”相关的默认选项如下：

```
 tpl: {
    next     : '<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',
    prev     : '<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'
    }, 
```

使用fancybox时，只需将其替换为您的自定义即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-22T04:33:59.463

This is now done in the jquery.fancybox.js file ... just scroll down to where it says Localization and change the words next and previous to whatever you want.

# php - php上传脚本问题

> ID：11346662
> 
> 赞同：0
> 
> 时间：2012-07-05T14:40:07.233
> 
> 标签：php, html

以下表格在我的页面html页面上

```
<form action="upload_file.php" method="post"
enctype="multipart/form-data">
<label for="file">Filename:</label>
<input type="file" name="file" id="file" /> 
<br />
<input type="submit" name="submit" value="Submit" />
</form> 
```

这是php的脚本

```
<?php

    if ((($_FILES["file"]["type"] == "image/gif")
    || ($_FILES["file"]["type"] == "image/jpeg")
    || ($_FILES["file"]["type"] == "image/png")
    || ($_FILES["file"]["type"] == "image/jpg")
    || ($_FILES["file"]["type"] == "image/pjpeg"))
    && ($_FILES["file"]["size"] < 200000000000))
      {
      if ($_FILES["file"]["error"] > 0)
        {
        echo "Return Code: " . $_FILES["file"]["error"] . "<br />";
        }
      else
        {
        echo "Upload: " . $_FILES["file"]["name"] . "<br />";
        echo "Type: " . $_FILES["file"]["type"] . "<br />";
        echo "Size: " . ($_FILES["file"]["size"] / 1024) . " Kb<br />";
        echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br />";

        if (file_exists("pics/2012/Blackhall Primary/" . $_FILES["file"]["name"]))
          {
          echo $_FILES["file"]["name"] . " already exists. ";
          }
        else
          {
          move_uploaded_file($_FILES["file"]["tmp_name"],
          "pics/2012/Blackhall Primary/" . $_FILES["file"]["name"]);
          echo "Stored in: " . "pics/2012/Blackhall Primary/" . $_FILES["file"]["name"];
          }
        }
      }
    else
      {
      echo "Invalid file";
      }
    ?> 
```

当我在表单上按选择时，什么也没有。它工作正常。带有表单的页面称为upload pictuture.html，脚本称为upload_file.php，它们都位于根目录中，并且pics/2012/blackhall primary 文件夹确实存在，并且pics 目录也位于根目录中。

这是有效的，但不是，任何人都可以看到我犯的任何错误。

谢谢罗斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:53:25.123

Change your privileges and by whom script is executed (usually *www-data* or *apache2*) - this account must has write and probably read access to directory, where pictures are uploaded.

Anyway, checking file type based on `$_FILES["file"]["type"]` isn't safe. This can be easily falsified by hacker.

# silverlight - 一小时后，RIA 调用失败，原因是：远程服务器返回错误：NotFound

> ID：11346664
> 
> 赞同：0
> 
> 时间：2012-07-05T14:40:09.263
> 
> 标签：silverlight, ria

我已经完成了我的研究，我知道这个错误信息非常模糊。但是，我想知道是否有人可以给我一些见解。我们有一个长期运行的 RIA 电话，可能需要一个多小时左右。

一小时后，我们收到此错误消息。

远程服务器返回错误：NotFound。---> System.ServiceModel.CommunicationException：远程服务器返回错误：NotFound。---> System.Net.WebException：远程服务器返回错误：NotFound。---> System.Net.WebException：远程服务器返回错误：NotFound。

我们将 RIA 调用的超时时间更改为 4 小时，但一小时后我们仍然收到此错误消息。如果我们将超时更改为 10 分钟，我们会在 10 分钟后收到实际的超时错误消息，而不是 NotFound 错误消息。

因为它恰好在一小时后发生 - 即使将不同的参数传递给 RIA 调用，我相信它与某处的超时设置有关，但我无法确定什么会导致超时发生之后一小时。

我设置超时的方式是从客户端调用 ria 服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:45:18.480

我发现了这个问题。

Internet Explorer 具有 60 分钟的内置接收超时，除非它被注册表设置覆盖。我的测试已经证实这是问题所在。

[http://support.microsoft.com/kb/181050](http://support.microsoft.com/kb/181050)

# android - Spring RestTemplate 正确的多线程使用

> ID：11346665
> 
> 赞同：-1
> 
> 时间：2012-07-05T14:40:12.560
> 
> 标签：android, spring, jackson

我尝试运行几个请求来执行不同的服务器并调试程序行为。首先，我创建并运行了几个异步任务，它们发出了几个请求

```
public class MyTask extends AsyncTask<Object, Void, Void> {
    int runnnigDownloadThreadsCount = 0;

    @Override
    protected Void doInBackground(Object... params) {
        runnnigDownloadThreadsCount++;
        try {
            // TODO здесь необходимо исправить serverName на оригинальный урл с указанием параметра сервера
            List<TravelTicket> ticketsList = TravelTicket.downloadTickets((TravelTicket.RequestServerParams) params[0], (String) params[1]);
            if (ticketsList != null)
                synchronized (TravelBookingApplication.travelTicketsList) {
                    TravelBookingApplication.travelTicketsList.addAll(ticketsList);
                }
            return null;
        } catch (Exception e) {
            throw new Error(e);
        }
    }

    @Override
    protected void onPostExecute(Void result) {
        runnnigDownloadThreadsCount--;
        if (runnnigDownloadThreadsCount == 0) {
            Intent i = new Intent(getActivity().getApplicationContext(), HotelsAndTicketsResponseListActivity.class);
            i.putExtra("requestType", "tickets");
            getActivity().startActivity(i);
            if (dialog != null)
                dialog.dismiss();
        }
    }
}

    String[] urls = new String[]{
            "http://dl.dropbox.com/u/34053723/provider1.json"
            ,
            "http://dl.dropbox.com/u/34053723/provider2.json",
            "http://dl.dropbox.com/u/34053723/provider3.json",
            "http://dl.dropbox.com/u/34053723/provider4.json"
    };
    for (final String serverName : urls) {
        // TODO ЗАМЕНИТЬ!!!
        // for (final String serverName : params.serverNames) {
        new MyTask().execute(params, serverName);
    } 
```

接下来在函数 TravelTicket.downloadTickets(...) 我使用 RestTemplate 加载数据

```
public static ArrayList<TravelTicket> downloadTickets(RequestServerParams requestServerParams, String serverName) throws Exception {
    // Запрос к серверу с указанием конретного провайдера и идентификторов запроса

    // Заголовки
    HttpHeaders requestHeaders = new HttpHeaders();

    requestHeaders.setUserAgent(TravelBookingApplication.USER_AGENT);

    HttpEntity requestEntity = new HttpEntity(requestHeaders);
    RestTemplate restTemplate = new RestTemplate(); 
```

每个线程都使用最后一行接近`HttpEntity requestEntity = new HttpEntity(requestHeaders);`但在第一次运行后调试器冻结。看起来它在断点处停止，但没有断点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:49:44.800

我不确定发生了什么（没有足够的信息），但我可以肯定地告诉你这`RestTemplate`是线程安全的，并且设计为配置一次并在线程之间共享，这与所有 spring`*Template`对象一致。

spring 4.0 文档在多个地方支持此声明。

[11.6.1 节使用 TransactionTemplate](http://docs.spring.io/spring/docs/4.0.0.RELEASE/spring-framework-reference/htmlsingle/#tx-prog-template)

> TransactionTemplate 采用与其他 Spring 模板（例如 JdbcTemplate）相同的方法。...最后，TransactionTemplate 类的实例是线程安全的

[第 13.2.1 节 JdbcTemplate 最佳实践](http://docs.spring.io/spring/docs/4.0.0.RELEASE/spring-framework-reference/htmlsingle/#jdbc-JdbcTemplate-idioms)

> JdbcTemplate 类的实例在配置后是线程安全的。

通过持久性，您可以找到关于`JmsTemplate`. 关于[文档仅](http://docs.spring.io/spring/docs/4.0.0.RELEASE/spring-framework-reference/htmlsingle/#rest-client-access)`RestTemplate`说明：

> ...它在概念上类似于 Spring 中的其他模板类，例如 JdbcTemplate 和 JmsTemplate 以及其他 Spring 组合项目中的其他模板类。

从这里我推断出它的意图是线程安全的，就像其他核心模板类一样。这当然意味着它不能保证是线程安全的，如果不是，它就是一个错误。

# shell - 如何在 SFTP 连接中使用 CD 建立连接 - Shell 脚本

> ID：11346672
> 
> 赞同：4
> 
> 时间：2012-07-05T14:40:42.123
> 
> 标签：shell, unix, sftp

在我的脚本中 - 我创建了一个 sftp 连接。

我之前从用户那里读取了一些目录值，一旦建立了 sftp 连接，我尝试 cd 到我从用户那里获得的那个目录。

但它不起作用，可能是因为提示进入了建立 SFTP 连接的服务器内部。

在这种情况下如何使它工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2018-10-19T13:54:26.650

我也遇到了这个问题并且能够找到解决方案。解决方案就在 sftp 的手册页中。在手册页中，您会找到使用 sftp 的格式，如下所示：

```
sftp [options] [user@]host[:dir[/]] 
```

实际上，那里提供了两种格式，但这是我想使用的一种并且它有效。

所以你会怎么做？您只需提供`username@host`那里看到的，然后，后面没有任何空格`:`以及您要在脚本中的客户端/远程服务器中更改的路径，仅此而已。这是一个实际的例子：

```
sftp user@host:/path/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T15:56:44.607

如果您的脚本确实如此，正如您在本页某处所述，

```
sftp $user@$host cd $directory 
```

然后尝试做其他事情，例如：

```
sftp $user@$host FOO 
```

该命令`FOO`将*不会*在同一目录中执行，`$directory`因为您正在执行一个新命令，这将创建一个到 SFTP 服务器的新连接。

您可以做的是使用 sftp 的“batchfile”选项，即构建一个*文件*，其中包含您希望 sftp 通过一个连接执行的所有命令，例如：

```
$ cat commands.txt
cd foo/bar
put foo.tgz
lcd /tmp/
get foo.tgz 
```

然后，您将能够通过执行以下命令告诉 sftp 在一个连接中执行这些命令：

```
sftp -b commands.txt $user@$host 
```

所以，我建议你的解决方案是：

*   根据用户的输入，创建一个临时文本文件，其中包含要通过一个 SFTP 连接执行的所有命令，然后
*   使用该临时文本文件作为“批处理文件”执行 sftp

您的脚本会执行以下操作：

```
echo "Directory in which to go:"
read directory
temp=$( mktemp /tmp/FOOXXX )
echo "" > $temp
echo "cd $directory" >> $temp
# other commands
sftp -b $temp $user@$host
rm $temp 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:48:20.347

如果您正在尝试更改机器的目录，请尝试 lcd

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-05T14:48:18.873

它以什么方式不起作用？要更改远程服务器上的目录，请使用“cd”命令。要更改本地服务器上的目录，请使用“lcd”命令。阅读“man sftp”。

# php - 将变量插入 SELECT 语句的正确语法是什么？

> ID：11346673
> 
> 赞同：0
> 
> 时间：2012-07-05T14:40:43.603
> 
> 标签：php, mysql

我相信我的 SQL 语句中有一个简单的语法问题。如果我运行此代码，我会在数据库查询中收到错误。

```
$user = $_GET['linevar'];
echo $user;  // testing - url variable echos correctly
$sql = "SELECT * FROM `userAccounts` WHERE `name` = $user";
$result = mysql_query($sql) or die("Error in db query"); 
```

如果我用表`$user`中的或已知记录替换`$sql`字符串，则代码可以正常工作。`'actualName'`我是否`$`在 SQL 字符串中错误地使用了变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:41:20.343

您需要用引号将您从中获得的值`$user`括起来，因为它可能不是数字：

```
$sql = "SELECT * FROM `userAccounts` WHERE `name` = '$user'"; 
```

需要注意的是，您还应该阅读 SQL 注入，因为此代码很容易受到它的影响。一个解决方法是通过它[`mysql_real_escape_string()`](http://php.net/mysql_real_escape_string)：

```
$user = mysql_real_escape_string( $_GET['linevar']); 
```

您还可以用`or die();`更丰富的信息替换您的逻辑，以便在发生错误时收到错误消息，例如：

```
or die("Error in db query" . mysql_error()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:42:13.647

这应该有效：

```
$sql = "SELECT * FROM `userAccounts` WHERE `name` = '" . $user . "'"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:43:11.040

您需要转义获取输入，然后引用它。

```
// this is important to prevent sql injection.
$user = mysql_real_escape_string($_GET['linevar']);

$sql = "SELECT * FROM `userAccounts` WHERE `name` = '$user'"; 
```

# r - 具有公共 x 轴的绘图

> ID：11346685
> 
> 赞同：3
> 
> 时间：2012-07-05T14:41:29.157
> 
> 标签：r, ggplot2

我有一个 data.frame df，其中包含 , , , 列，我想`T`制作 一个包含两个图的 ggplot，其中x 轴作为公共图 第一个图包含 第二个图包含, ,`V1``V2``V3``V4``T``V1``V2``V3``V4`

我试过：

```
m1 <- melt(df, id = "T") 

chart1<-qplot(T, value, data = m1, geom = "line", group = variable) +
stat_smooth() +
facet_grid(variable ~ ., scale = "free_y") 
```

但这给了我四个常见的情节，而我只想要两个。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T20:10:13.377

```
library(ggplot2)
library("reshape")

df <- data.frame(T,V1,V2,V3,V4)
m1 <- melt(df, id = "T") 

m1$sepfac <- (m1$variable=="V1")

chart1<-qplot(T, value, data = m1, geom = "line", group = variable) +
stat_smooth() +
facet_grid(sepfac~., scale = "free_y") 
```

# c++ - 在 C++ 中，如何从其声明中获取任意函数的类型？

> ID：11346690
> 
> 赞同：1
> 
> 时间：2012-07-05T14:41:43.300
> 
> 标签：c++, templates, boost, c++11, metaprogramming

> **可能重复：**
> [提取函数的返回类型而不调用它（使用模板？）](https://stackoverflow.com/questions/2005794/extract-the-return-type-of-a-function-without-calling-it-using-templates)

从这个开始（由其他人提供）：

```
int my_function(int, int *, double); 
```

我想解决这个问题：

```
typedef boost::function_types::result_type< my_function_type >::type my_result;
typedef boost::function_types::parameter_types< my_function_type >::type my_parameters; 
```

我怎么得到`my_function_type`？

注意：我知道`BOOST_TYPEOF()`，但它似乎有点吓人，如“也许不是完全便携”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:00:44.510

`decltype`. 例子：

```
char foo(int) {}
decltype (foo(3)) const *frob = "hello foo";
typedef decltype (foo(3)) typeof_foo;
using typeof_foo = decltype(foo(3)); 
```

表达式 to`decltype`在编译时计算，因此必须是可解析的。您可以将任何`constexpr`整数传递给它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:01:29.563

这取决于你想做什么。体内的

```
template <typename T>
void foo(T )
{
  // ...
} 
```

如果您调用 T 是您的函数的类型`foo(my_function)`。您的问题无法使用 c++03-features 解决，否则`decltype`不会添加到核心语言中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T16:57:45.133

这是模板魔术（不`Boost`涉及）：

```
template <typename ReturnType> class clFunc0
{
    typedef ReturnType ( *FuncPtr )();
public:
    typedef ReturnType Type;
};

template <typename ReturnType> inline clFunc0<ReturnType> ResultType( ReturnType ( *FuncPtr )() )
{
    return clFunc0<ReturnType>();
}

#define FUNC_TYPE( func_name ) decltype( ResultType( &func_name ) )::Type

int test()
{
    return 1;
}

int main()
{
    FUNC_TYPE( test ) Value = 1;

    return Value;
} 
```

并通过编译它

```
gcc Test.cpp -std=gnu++0x 
```

# php - Ajax变量值到javascript

> ID：11346691
> 
> 赞同：2
> 
> 时间：2012-07-05T14:41:43.707
> 
> 标签：php, javascript, jquery, ajax, variables

我已经解决了几个小时的问题，但没有发现任何问题......

我有一个供用户创建帐户的注册表单。当按下提交按钮时，将调用 validateForm 函数。

在这个函数中，我做了一些有效的 javascript 测试，但是我需要验证用户名是否可用。为此，我创建了一个外部 PHP 文件并使用 $.ajax 调用它。

这是代码的一部分：

```
function validateRegistration(){
// Some tests....

// Check if username is already used
// Call external php file to get information about the username
$.ajax({
    url: 'AjaxFunctions/getUsernameAjax.php',
    data: "username=" + $("#username").val(),
    success: function(data){
        // Username already in use
        if(data == "ko"){
            // Stop validateForm()
        }
        // Username not used yet
        else{
            // Continue tests
        }
    }
});
// Other tests
} 
```

我的问题是如何让 validateForm() 从 $.ajax 内部返回 false ？例如，我可以在 Ajax 部分之前声明一个 js 变量并使用 Ajax 设置它吗？

我想答案很明显，但我对 Ajax 完全陌生，我无法理解......

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:47:19.290

要实现这一点，您可以执行[此答案](https://stackoverflow.com/questions/133310/how-can-i-get-jquery-to-perform-a-synchronous-rather-than-asynchronous-ajax-re)中描述的同步 ajax 调用，但这对您的网站性能非常危险。

或者-这是正确的方法-您应该有一个外部变量，无论用户名是否可用，只要用户输入您执行请求的内容，如果它有效，您更改变量，否则您会显示警告消息。接下来在您的 validateRegistration() 函数中，您只检查外部变量（+ 可能的某种形式的回调，取决于您从哪里调用它）。优点是用户仍然可以在请求未决时继续做事（比如填写表格的其余部分）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:47:35.593

您可以像现在所做的那样进行*同步*ajax 调用，而不是*异步*调用。这意味着 Ajax 调用将在执行下一行代码之前完成。

要在 jQuery 中这样做，只需添加`async: false`到您的请求对象：

```
var someVariable;
$.ajax({
    url: 'AjaxFunctions/getUsernameAjax.php',
    data: "username=" + $("#username").val(),
    success: function(data){
        // Username already in use
        someVariable = "something";
        if(data == "ko"){
            // Stop validateForm()
        }
        // Username not used yet
        else{
            // Continue tests
        }
    },
    async: false
});
alert(someVariable); // should alert 'something', as long as the ajax request was successful 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:53:51.933

在 php 中，如果您打印出 JSON 如下：

```
echo json_encode(array("ko"=>"good")); 
```

显示为：

```
{
 "ko":"good"
} 
```

然后在函数中

```
if(data.ko == "good"){
  //do stuff
} 
```

这就是我通常的做法。您可以使用您在 JSON 中使用的名称来获取变量，以便您可以根据需要获取其他内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T15:06:42.147

如果目标是检查用户名的可用性，那么如何在输入用户名时或在输入用户名之后检查它。例如，您可以将其绑定到[keyUp](http://api.jquery.com/keyup/)事件以进行击键，或者将其绑定到离开文本框时的[blur](http://api.jquery.com/blur/)事件。

这意味着当用户到达提交按钮时，表单的那部分已经被验证了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T15:22:26.807

这里的传统解决方案是传递一个回调函数，`validateRegistration`该函数需要一个布尔值。让 Ajax 函数在完成时调用回调函数。

处理程序需要立即返回值，因此在`onsubmit`提交事件处理程序中执行异步测试是一种相当统一的做事方式。相反，您应该尽快执行测试（例如，一旦用户输入用户名），然后将用户名验证的结果存储在全局变量中，稍后在提交时对其进行检查。

```
// global variable indicating that all is clear for submission
shouldSubmit = false;

// run this when the user enters an name, e.g. onkeyup or onchange on the username field
function validateRegistration(callback) {
    shouldSubmit = false;
    // number of ajax calls should be minimized
    // so do all other checks first
    if(username.length < 3) {
        callback(false);
    } else if(username.indexOf("spam") != -1) {
        callback(false)
    } else {
        $.ajax({
            ....
            success: function() {
                if(data == "ko") {
                    callback(false);
                } else {
                    callback(true);
                }
            }
        });
    }
} 
```

现在`validateRegistration`使用函数参数调用：

```
validateRegistration(function(result) {
    alert("username valid? " + result);
    if(result) {
        $("#username").addClass("valid-checkmark");
    } else {
        $("#username").addClass("invalid-xmark");
    }
    shouldSubmit = result;
}); 
```

`shouldSubmit`现在在表单的事件处理程序中使用全局变量`submit`来选择性地阻止表单提交。

# drupal-7 - 在 Drupal 7 中创建新的 Hooks

> ID：11346692
> 
> 赞同：1
> 
> 时间：2012-07-05T14:41:51.967
> 
> 标签：drupal-7, drupal-hooks

我不是在寻找如何**实现**现有的钩子，而是要创建一种新型*的*钩子。假设钩子`hook_node_load()`存在。我想创建类似的东西`hook_node_preload()`，在加载节点之前触发。

我已经搜索过，似乎无法找出 Drupal 代码钩子在哪里被触发。我认为它是类似的东西`module_invoke_all()`或类似的东西？但我不确定它在哪里被调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:30:58.383

在整个 Drupal 过程中，Drupal 钩子在各处被触发。没有一个地方可以调用所有的钩子。

下面是 Drupal 核心中创建钩子的一些函数的列表：

[http://api.drupal.org/api/drupal/includes%21module.inc/function/calls/module_invoke_all/7](http://api.drupal.org/api/drupal/includes%21module.inc/function/calls/module_invoke_all/7)

在 的情况下`hook_node_load()`，它是从位于**includes/entity.inc**的 entity.inc 文件中调用的，第 334 行。

```
foreach (module_implements($this->entityInfo['load hook']) as $module) {
  call_user_func_array($module . '_' . $this->entityInfo['load hook'], $args);
} 
```

# c - 如何在 C 中设置双精度数据类型变量的精度？

> ID：11346693
> 
> 赞同：0
> 
> 时间：2012-07-05T14:41:54.337
> 
> 标签：c

> **可能重复：**
> [浮动和双重比较的最有效方法](https://stackoverflow.com/questions/17333/most-effective-way-for-float-and-double-comparison)

在我的程序中，一些双变量取值形式为`1.00000001`. 这些变量的相等性检查`1`显然失败了。

我想知道如何降低 c 中双精度类型变量的精度，以便整数相等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:43:53.850

您几乎不应该检查浮点值是否完全相等，特别是当它们来自计算时。您应该检查与比较值的差值的绝对值是否小于某个 epsilon。double 的“精度”由内部数字表示形式给出，您无法更改它。如何准确地选择 epsilon 可能很困难，对该答案有一些评论讨论，阅读它，但您最终会得到基于 epsilon 的实用平等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:46:15.197

没有便携的方式，不。

使用 GNU C 库，您可以使用[此 API](http://www.gnu.org/software/libc/manual/html_node/Rounding.html)更改舍入模式。

但总的来说，最好用代码来表达，这样你的期望就会变得清晰和可移植：

```
#define EQUALITY_EPSILON 1e-3  /* Or whatever. */

if(fabs(x - y) <= EQUALITY_EPSILON)
{
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:46:01.473

您应该避免在浮点比较中检查相等性。相反，请使用`epsilon`如下精度值：

```
if (fabs(a - b) < epsilon)
{
    // treat a and b as equal
} 
```

epsilon 的选择可能很复杂，但我的知识并没有那么远。

做一个谷歌搜索“每个程序员应该知道的关于浮点运算的知识”。这是一篇涵盖所有这些内容的知名文章。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T14:48:29.193

“降低双精度型变量的精度”没有多大意义。您可能应该考虑而不是使用诸如 , 和 之类的函数`ceil`，`floor`以`round`一种您可以很好地控制的方式从您的双精度数中生成一个整数，然后在比较中使用该整数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T14:54:30.190

在 C99 中

```
#include <stdio.h>
#include <math.h>

int main(){
    double d = 1.00000001;
    int i = (int)round(d);

    printf("%d\n", i);

    return 0;
} 
```

# tsql - 从以前的记录继承值

> ID：11346696
> 
> 赞同：0
> 
> 时间：2012-07-05T14:42:00.780
> 
> 标签：tsql

我有下表，其中除 Value 之外的所有字段都作为表上唯一索引的一部分。`Value<>NULL`仅当该记录具有 NULL 值时，我才想将记录中的值继承到下一个修订记录（请参见下面的示例）：

`Var[n]Value`字段吃了 varchar，我的表中可能有 1-n 个`Var[n]value`字段。

资源：

```
Document#   Revision    Project#    config# Var1Value   Var2Value
1744    1   2   1   NULL    NULL
1744    2   2   1   NULL    NULL
1744    3   2   1   Tit1    ABC
1744    4   2   1   Tit2    ABD
1744    5   2   1   NULL    NULL
1744    6   2   1   NULL    SDC
1744    7   2   1       AS
1744    8   2   1   Tit3    NULL 
```

需要的结果（通知修订记录 5 和 6`var1value`以及 5,8 的更改`var2value`）：

```
Document#   Revision    Project#    config# Var1Value   Var2Value
1744    1   2   1   NULL    NULL
1744    2   2   1   NULL    NULL
1744    3   2   1   Tit1    ABC
1744    4   2   1   Tit2    ABD
1744    5   2   1   Tit2    ABD
1744    6   2   1   Tit2    SDC
1744    7   2   1       AS
1744    8   2   1   Tit3    AS 
```

知道如何通过 SQL 处理它吗？

请指教。

我尝试了以下方法：

```
declare @TableName as VarChar(32) = 'MYTABLE'
declare @SetClause as VarChar(1024)
declare @LWhereClause as VarChar(1024)
declare @RWhereClause as VarChar(1024)

-- Get the column names.
select Column_Name
  into #Columns
  from Information_Schema.Columns
  where Table_Name = @TableName and Column_Name like 'Var%'
--select * from #Columns

-- Assemble the clauses we'll need for the   UPDATE   statement.
declare @ColumnName as VarChar(32)
while ( @@RowCount > 0 )
  begin
  select top 1 @ColumnName = Column_Name
    from #Columns
    order by Column_Name
  set @SetClause = case when @SetClause is NULL then '' else @SetClause + ', ' end +
    @ColumnName + ' = Coalesce( L.' + @ColumnName + ', R.' + @ColumnName + ' )'
  set @LWhereClause = case when @LWhereClause is NULL then '' else @LWhereClause + ' or ' end +
    'L.' + @ColumnName + ' is NULL'
  set @RWhereClause = case when @RWhereClause is NULL then '' else @RWhereClause + ' or ' end +
    'R.' + @ColumnName + ' is not NULL'
  delete from #Columns
    where Column_Name = @ColumnName
  end

--select @SetClause, @LWhereClause, @RWhereClause

-- Put together the   UPDATE   statement.
declare @Update as nVarChar(max)
set @Update=''
set @Update=@Update +
  'update L set ' + @SetClause + ' from ' + @TableName +
  ' as L inner join ' + @TableName + ' as R on R.DocId = L.DocId and R.Rev = L.Rev - 1 and R.Proj = L.Proj and R.Conf = L.Conf' +
  ' where ( ' + @LWhereClause + ' ) and ( ' + @RWhereClause + ' )'

-- Put together the entire loop.  This needs work.
declare @Loop as nVarChar(max)
set @Loop =''
set @Loop=@Loop+
  '@declare Eleanor as Int = 42;
    while ( @Eleanor > 0 ) ' 
    + @Update + ' 
    set @Eleanor = @@RowCount
    end'

--select @Loop

-- Execute it.
exec @Loop

drop table #Columns 
```

我在 exec 循环中收到以下错误。为什么它会截断 nvarchar 字符串？

> 消息 203，级别 16，状态 2，第 53 行
> 名称 '@declare Eleanor as Int = 42;
> while (@Eleanor > 0) 更新 L set variable104 = Coalesce( L.variable104, R.variable104), variable105 = Coalesce( L.variable105, R.variable105 ), variable106 = Coalesce( L.variable106, R.variable106 ), variable107 = Coalesce（L.variable107，R.variable107），variable112 = Coalesce（L.variable112，R.variable112），variable116 = Coalesce（L.variable116，R.variable116），variable119 = Coalesce（L.variable119，R.variable119） , variable120 = Coalesce( L.variable120, R.variable120 ), variable121 = Coalesce( L.variable121, R.variable121 ), variable122 = Coalesce( L.variable122, R.variable122 ), variable124 = Co' 不是有效的标识符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T18:27:29.027

完全重复： [SQL QUERY 用前一个已知值中的值替换一行中的 NULL 值](https://stackoverflow.com/questions/1345065/sql-query-replace-null-value-in-a-row-with-a-value-from-the-previous-known-value) ps：我没有发表评论的特权。所以我写了答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T17:52:34.700

**编辑**：请原谅，但我没有考虑变量列。

此查询将检索定义在中的列`YourTable`：

```
select Column_Name from Information_Schema.Columns where Table_Name = 'YourTable' 
```

此后，您需要构建一个动态查询和`EXEC`它。您可以为每个单独的列编写如下所示的代码，或者一次性处理所有列。

* * *

动态构建查询是一个有点乏味的过程。以下内容应该能让您顺利上路。

```
declare @TableName as VarChar(32) = 'YourTable'
declare @SetClause as VarChar(1024)
declare @LWhereClause as VarChar(1024)
declare @RWhereClause as VarChar(1024)

-- Get the column names.
select Column_Name
  into #Columns
  from Information_Schema.Columns
  where Table_Name = @TableName and Column_Name like 'Var%'
select * from #Columns

-- Assemble the clauses we'll need for the   UPDATE   statement.
declare @ColumnName as VarChar(32)
while ( @@RowCount > 0 )
  begin
  select top 1 @ColumnName = Column_Name
    from #Columns
    order by Column_Name
  set @SetClause = case when @SetClause is NULL then '' else @SetClause + ', ' end +
    @ColumnName + ' = Coalesce( L.' + @ColumnName + ', R.' + @ColumnName + ' )'
  set @LWhereClause = case when @LWhereClause is NULL then '' else @LWhereClause + ' or ' end +
    'L.' + @ColumnName + ' is NULL'
  set @RWhereClause = case when @RWhereClause is NULL then '' else @RWhereClause + ' or ' end +
    'R.' + @ColumnName + ' is not NULL'
  delete from #Columns
    where Column_Name = @ColumnName
  end

select @SetClause, @LWhereClause, @RWhereClause

-- Put together the   UPDATE   statement.
declare @Update as VarChar(4096) =
  'update L set ' + @SetClause + ' from ' + @TableName +
  ' as L inner join ' + @TableName + ' as R on R.DocId = L.DocId and R.Rev = L.Rev - 1 and R.Proj = L.Proj and R.Conf = L.Conf' +
  ' where ( ' + @LWhereClause + ' ) and ( ' + @RWhereClause + ' )'

-- Put together the entire loop.  This needs work.
declare @Loop as VarChar(4096) =
  '@declare Eleanor as Int = 42; ...' + @Update + '...'

select @Loop

-- Execute it.
exec @Loop

drop table #Columns 
```

* * *

这是一种基于密集修订号的可怕方式：

```
declare @Docs as Table ( DocId Int, Rev Int, Proj Int, Conf Int, Var1 VarChar(10) Null, Var2 VarChar(10) Null )

insert into @Docs ( DocId, Rev, Proj, Conf, Var1, Var2 ) values
  ( 1744, 1, 2, 1, NULL, NULL ),
  ( 1744, 2, 2, 1, NULL, NULL ),
  ( 1744, 3, 2, 1, 'Tit1', 'ABC' ),
  ( 1744, 4, 2, 1, 'Tit2', 'ABD' ),
  ( 1744, 5, 2, 1, NULL, NULL ),
  ( 1744, 6, 2, 1, NULL, 'SDC' ),
  ( 1744, 7, 2, 1, '', 'AS' ), -- The example data for this row is unclear.
  ( 1744, 8, 2, 1, 'Tit3', NULL )

select * from @Docs

declare @Eleanor as Int = 42
while ( @Eleanor > 0 )
  begin
  update L
    set Var1 = Coalesce( L.Var1, R.Var1 ), Var2 = Coalesce( L.Var2, R.Var2 )
    from @Docs as L inner join
      @Docs as R on R.DocId = L.DocId and R.Rev = L.Rev - 1 and R.Proj = L.Proj and R.Conf = L.Conf
    where ( L.Var1 is NULL or L.Var2 is NULL ) and ( R.Var1 is not NULL or R.Var2 is not NULL )
  set @Eleanor = @@RowCount
  end

select * from @Docs 
```

# ios - 如何在 UIButton 中不拉伸图像

> ID：11346697
> 
> 赞同：66
> 
> 时间：2012-07-05T14:42:03.533
> 
> 标签：ios, cocoa, uibutton

我正在尝试以编程方式创建一个自定义 UITableViewCell ，并且该单元格的子视图之一将是一个带有图像的按钮（放大镜的简单图像）。但是，我希望按钮的图像居中并按比例缩小以适合按钮，而不是拉伸以填充整个按钮。下面是我的代码，其中 self 指的是我将按钮放入的自定义 UITableViewCell。

```
self.myButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[self.myButton setBackgroundImage:[UIImage imageNamed: @image_name_here"] forState:UIControlStateNormal];
self.myButton.frame = CGRectMake(...//something, something)
self.myButton.imageView.contentMode = UIViewContentModeCenter;
[self.contentView addSubview:self.mySearchHelpButton]; 
```

现在，图像会拉伸以填充整个按钮，而不是按比例缩放以使其适合。

我也尝试将 contentMode 设置为，`UIViewContentModeScaleAspectFill`但这似乎并没有改变任何东西。事实上，不同的 contentMode 似乎都没有改变任何东西。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-07-05T14:46:02.303

你试过`setImage`代替`setBackgroundImage`吗？

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2016-01-28T23:54:31.167

确保按钮是自定义 UIButton

仅`setImage:`在 iOS9 上使用对我不起作用。

但它与`myButton.imageView.contentMode = UIViewContentMode.ScaleAspectFit;`

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2015-12-10T13:25:19.370

在斯威夫特...

```
button.imageView?.contentMode = . scaleAspectFit 
```

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2017-10-02T20:25:25.143

# 故事板

**物业**形象。

您必须在**身份检查器的****Runtime Attributes** –中定义特定属性，您可以在其中设置相对于enum 位置的值。1 表示**scaleAspectFit**。**`imageView.contentMode``rawValue``UIViewContentMode`**

 ****[![在 Storyboard 中设置 button.imageView.contentMode](../Images/02ebad213e343060d779290f83a07719.png)](https://i.stack.imgur.com/gFhtM.png)

和按钮的对齐方式，在**属性检查**器中：

[![按钮完全对齐](../Images/9f22561d1020bcec939b740fefc15135.png)](https://i.stack.imgur.com/6Geag.png)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2017-10-09T15:18:45.213

**斯威夫特 4.2**

```
myButton.imageView!.contentMode = .scaleAspectFit 
```

**斯威夫特早期版本**

```
myButton.imageView!.contentMode = UIViewContentMode.scaleAspectFit 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2019-05-25T17:29:42.510

**斯威夫特 4.X 和 5.X**

```
button.imageView!.contentMode = .scaleAspectFit
button.contentVerticalAlignment = .fill
button.contentHorizontalAlignment = .fill 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-04-14T18:24:28.683

我认为你们错过了明显的问题。图片对于按钮来说太大了，iOS 必须猜测你想如何缩放它。确保您的图像尺寸合适，您不会遇到此问题。当然，这适用于您预先知道大小的静态图像和按钮，而不是动态内容。****

# batch-file - 使用 findstr 命令中的路径目录

> ID：11346705
> 
> 赞同：0
> 
> 时间：2012-07-05T14:42:22.727
> 
> 标签：batch-file, findstr

尝试在我的批处理代码中使用此行输出的目录。

```
findstr /M search_text "C:\Users\user\Desktop\*" 
```

这个输出是一个文件目录。

```
"C:\Users\whatever\blabla" 
```

我知道我可以添加 >> 并将其打印到文本文件中，但我宁愿不走那条路，因为我不确定如何首先将 dir 拉回命令行。是否有某种方式我可以对变量执行 Set=%k 命令以供以后使用。抱歉，我对此还是很陌生。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:06:36.760

你可以这样做

```
for /f %%i in ('findstr /m "search_text" "C:\Users\user\Desktop\*"') do set file=%%i 
```

然后你在`%file%`变量中有输出。

希望这可以帮助。

# jquery - ASP.NET MVC 中的 JQuery Datatable 插件数据绑定

> ID：11346706
> 
> 赞同：2
> 
> 时间：2012-07-05T14:42:25.343
> 
> 标签：jquery, asp.net-mvc, json, datatables

我正在尝试在 ASP.NET MVC 应用程序中使用 JQuery Datatable 插件。但是，尽管我的控制器将 JSON 数据返回给插件，但该表显示一条`Loading...`消息并卡在那里。

这是我的控制器，

```
public ActionResult GetCompanies(jQueryDataTableParamModel param)
{
   return Json(new
   {
       sEcho = param.sEcho,
       iTotalRecords = 97,
       iTotalDisplayRecords = 3,
       aaData = new List<string[]>() {
           new string[] {"1", "a1", "a2", "a3"},
           new string[] {"2", "b1", "b2", "b3"},
           new string[] {"3", "c1", "c2", "c3"}
           }
       }, JsonRequestBehavior.AllowGet);     
} 
```

这是数据表插件的初始化。

```
$('#companyDataTable').dataTable({
    bProcessing: true,
    sAjaxSource: '@Url.Action("GetCompanies", "Company")'
}); 
```

这是我的桌子的截图。

![在此处输入图像描述](../Images/c46e259907bef2d0a7d4f4ca40f8581d.png)

这是从插件返回的 JSON 数据`Company/GetCompanies`

```
{ "sEcho":null,
  "iTotalRecords":97,
  "iTotalDisplayRecords":3,
  "aaData":[ ["1","a1","a2","a3"],
             ["2","b1","b2","b3"],
             ["3","c1","c2","c3"]
           ]
} 
```

`jQuerDataTableParamModel`是一个[在这里](http://www.codeproject.com/Articles/155422/jQuery-DataTables-and-ASP-NET-MVC-Integration-Part)显示的类。我也尝试了这个[问题](https://stackoverflow.com/questions/7835960/load-asp-net-mvc-jsonresult-jquery-datatables)的答案，但没有一个对我有用。

**编辑 ：**

这就是插件请求的样子。

![在此处输入图像描述](../Images/0be1017c776de8d6f3e317d85b27e313.png)

有任何想法吗 ？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:52:55.937

您需要返回与您的请求相同的 sEcho 值。在您的响应中，“sEcho”值为空，因此 DataTables 无法将请求与响应连接起来。

从数据表[文档](http://datatables.net/usage/server-side)：

> **sEcho**从客户端发送的未更改的 sEcho 副本。这个参数会随着每次抽奖而改变（它基本上是一个抽奖次数）——所以实现这一点很重要。请注意，出于安全原因，强烈建议您将此参数“强制转换”为整数，以防止跨站点脚本 (XSS) 攻击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-25T13:01:17.327

对于 OP 来说可能为时已晚，但我猜您使用的是 1.10 版的 DataTables？

传入参数与早期版本完全不同，这就是为什么该教程中的自定义对象 (jQueryDataTableParamMode) 没有任何值绑定到它的属性。

此时，传入变量的 1.10 版的最新文档是[在此处输入链接描述](http://datatables.net/manual/server-side)

你可以看到这谈论了一个名为“draw”的变量，它取代了旧的“sEcho”

版本 1.9 或更早版本的相同文档页面在[这里](http://legacy.datatables.net/usage/server-side)

此外，这里是从 1.9 升级到 1.10[的比较列表](http://datatables.net/upgrade/1.10-convert)

# java - 诊断为什么 Centos (Tomcat) 上的 java 在空闲时使用 150% CPU - JConsole？

> ID：11346708
> 
> 赞同：0
> 
> 时间：2012-07-05T14:42:30.040
> 
> 标签：java, tomcat, centos

我的 Tomcat/Centos 服务器上的 Java 进程在空闲时占用了 150% 的 CPU（没有人登录到我们的应用程序）

```
 PID  USER      PR  NI  VIRT  RES  SHR S %CPU  %MEM    TIME+  COMMAND                                                                                                                            
16917 administ  20   0 8936m 470m  12m S 141.8  3.0  22:29.31 /usr/java/jdk1.6.0_31/bin/java 
```

我可以使用 JConsole 连接到 java 实例，我可以看到正在运行的线程列表，但是如何确定哪些线程/任务正在使用所有 CPU？
注意：CPU 问题似乎不是由 GC 引起的。

有没有我可以调用的 MBean？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:45:08.767

如果您使用 JVisualVM，您可以查看哪些线程处于活动状态并获得这些线程的堆栈跟踪。

您也可以启用 CPU 监控，但这会降低您的应用程序的速度。（如果用的不多应该没问题）

# python - 打开新的 tkinter 窗口后启动外部进程。[Python]

> ID：11346713
> 
> 赞同：0
> 
> 时间：2012-07-05T14:42:43.727
> 
> 标签：python, process, window, tkinter, external

我正在开发一个具有“执行操作时请稍候”窗口的程序。在运行批处理文件时，此窗口需要保持打开状态。批处理完成后窗口关闭。我正在使用 Python 方法 .after() 在窗口打开后调用批处理。问题发生在 .after() 中设置的时间之后，窗口关闭并重新打开，变为白色并且不显示任何文本。这是相关的代码。

```
 def backupCallBack(self, event):
      self.backupCB = Toplevel()
      self.backupCB.grab_set()
      self.backupCB.transient(self.exportGUI)

      message = "Please wait while the\ndatabase is backed up..."
      Label(self.backupCB, text=message, padx=100, pady=20).pack()

      event.after(200,self.runBackup)

   def runBackup(self):
      name = Entry.get(self.backupEntry)

      self.backupWindow.destroy()
      self.exportGUI.destroy()

      os.system('.\\src\\backup.bat %s' % name)

      self.backupCB.destroy() 
```

“请稍候”窗口需要在批处理过程的整个运行过程中打开并保持打开状态。我使用 .after() 错了吗？完成这项任务的更合适的方法是什么？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T03:31:07.137

该`after`方法`self.runBackup`在 200* *ms* * 后运行，其中包括`self.backupCB.destroy()`您的等待窗口。
如果您的意图是在窗口被销毁之前等待 x 时间，您可能会考虑`os.system('.\\src\\backup.bat %s' % name)` 进入`backupCallBack`该方法的上方`after`（并将 200 毫秒更改为更重要的时间）。否则，您将需要弄清楚如何设置相当于 `if batch == done`：

# android - SQLite中删除一行后，新条目的_ID不连续

> ID：11346714
> 
> 赞同：4
> 
> 时间：2012-07-05T14:42:50.357
> 
> 标签：android, sqlite

我使用此方法删除我的 sqlite 数据库中的一行：

```
db.execSQL("delete from "+TABLE_NUMS+" where _ID = '" + this.rowID + "'"); 
```

然后我更新其余的 ID 以使我的条目连续：

```
db.execSQL("UPDATE "+TABLE_NUMS+" set _ID = (_ID - 1) WHERE _ID > "+this.rowID); 
```

它工作正常，但是当我向我的数据库添加新条目时，新条目的 ID 仍然添加，就好像已删除的条目存在一样，假设我有 10 行 ID 从 1 到 10，然后我删除数字 5 和6，行变为 1 到 8，但新条目的 ID 将是 11。所以我的 ID 序列将是 1 到 8 和 11。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:49:20.363

> 只要您从不使用最大 ROWID 值并且从不删除表中具有最大 ROWID 的条目，上述正常的 ROWID 选择算法将生成单调递增的唯一 ROWID。如果您曾经删除行或曾经创建具有最大可能 ROWID 的行，则在创建新行时可能会重用先前删除的行中的 ROWID，并且新创建的 ROWID 可能不会严格按升序排列。 [http://www.sqlite.org/autoinc.html](http://www.sqlite.org/autoinc.html)

这就是 SQLite 的工作原理。

如果您确实需要连续使用 ID，请不要使用自动增量。自己插入ID。您可以先选择 MAX(_ID) 以获取最后一个 id（最大值）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T14:49:41.757

SQLite 使用特殊的 SQLITE_SEQUENCE 表来跟踪表曾经拥有的最大 ROWID。您可以将该序列修改为：

```
UPDATE SQLITE_SEQUENCE SET seq = this.ID -1 WHERE name = TABLE_NUMS 
```

[在这个问题](https://stackoverflow.com/questions/692856/set-start-value-for-autoincrement-in-sqlite)中提出了相同的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:47:50.507

这是因为您在创建表时在 _ID 上设置了自动增量。因此，除非您明确设置，否则您添加的每一行都会自动获得一个数字。如果您绝对需要连续顺序的 _ID，我建议您自己设置它而不是使用自动增量。

以下是如何重置它：

```
delete from your_table;    
delete from sqlite_sequence where name='your_table'; 
```

这将删除您的所有数据并重置序列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-08T06:54:52.363

SQLite 在特殊的 SQLITE_SEQUENCE 表中保留最大的 ROWID。您可以将该表更新为：

```
db.execSQL("UPDATE SQLITE_SEQUENCE SET seq = 0 WHERE NAME = '"+TABLE_NAME+"'"); 
```

或者

将该表删除为：

```
db.delete("SQLITE_SEQUENCE","NAME = ?",new String[]{TABLE_NAME}); 
```

# wpf - 设置 ListCollectionView.CustomSort 时在列表视图顶部插入新项目

> ID：11346717
> 
> 赞同：1
> 
> 时间：2012-07-05T14:42:58.063
> 
> 标签：wpf, sorting

我有一个带有自定义排序器的列表视图（由 ListCollectionView.CustomSort 属性设置），但是我想在列表视图的顶部插入新项目。如何抑制 CustomSort？

我有一个想法来调整我的排序逻辑，所以新添加的项目将是第一个，但是这个解决方案有点臭。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:17:17.370

为什么要压制`CustomSort`？根据您的需要进行调整：

*   您可以为`IComparer`对象中用于排序的属性 eG`int.MaxValue`或`string.Empty`.

*   或者创建一个附加属性 IsNew 并将其包含在比较过程中。

    ```
    class MyClass
    {
        public bool IsNew { get; set; }
        public string Name { get; set; }
    }

    class MyComparer : IComparer<MyClass>
    {
        public int Compare(MyClass x, MyClass y)
        {
            if (x.IsNew ^ y.IsNew)
            {
                return x.IsNew ? -1 : 1;
            }
            else
            {
                return StringComparer.InvariantCulture.Compare(x.Name, y.Name);
            }
        }
    } 
    ```

# qt - 通过鼠标单击选择完整的默认文本

> ID：11346718
> 
> 赞同：0
> 
> 时间：2012-07-05T14:43:01.123
> 
> 标签：qt

**我的菜单栏中**有一个**QLineEdit**小部件，默认情况下显示文本**“按 ID 搜索” 。**如何为 QLineEdit 实现 MouseClicked 事件处理程序，这样当我单击 LineEdit 小部件时，默认文本被清除并且用户可以输入他想要搜索的文本？

 ****至今

```
#ifndef SEARCH_H
#define SEARCH_H
#include<QLineEdit>

class search : public QLineEdit
{
        signals:
                void clicked();

        protected:
                void mousePressEvent(QMouseEvent *);
};
#endif 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:49:02.783

您只需要将 QLineEdit::mousePressEvent ( QMouseEvent * e ) 信号与函数连接起来。当这个信号将被发出时，在你的函数中清除 QLineEdit。很简单，不是吗？

编辑

或者如果你有

```
void mousePressEvent(QMouseEvent *); 
```

在您的小部件中，您所需要的只是为该方法编写定义。当用户在 QLineEdit 上按下鼠标时，将调用此函数。像：

```
void search::mousePressEvent(QMouseEvent *e)
{
    myQLineEdit->setText("");
} 
```

编辑 2

然后尝试这样做：

```
class YourWidget : public QLineEdit
{
    Q_OBJECT

    protected:

    void focusInEvent(QFocusEvent* e);
}; 
```

和

```
void YourWidget::focusInEvent(QFocusEvent* e)
{    
    if (e->reason() == Qt::MouseFocusReason)    
    {
      myQLineEdit->setText("");
    }

    // You might also call the parent method.
    QLineEdit::focusInEvent(e);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:50:16.587

您需要使用[QLineEdit::placeholderText](http://qt-project.org/doc/qt-4.8/qlineedit.html#placeholderText-prop)属性。它显示了一个灰色文本，当用户开始编辑它时（即当它获得焦点时）它会消失。

```
QLineEdit * edit = new QLineEdit;
edit->setPlaceholderText("Search by ID"); 
```****

# c# - C# 语言规范（硬拷贝）

> ID：11346719
> 
> 赞同：3
> 
> 时间：2012-07-05T14:43:05.080
> 
> 标签：c#

我正在尝试获取 C# 语言规范的硬拷贝，并且听说您可以与 Microsoft 联系以执行此操作。我已经通过电话联系了他们，他们几乎不知道 C# 是什么，更不用说从哪里获得规范的副本了！

任何人都可以对此有所了解吗？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-05T14:45:21.640

您可以从 ECMA（硬拷贝）免费获得一份 ECMA 规范的副本 - 或者至少您曾经能够获得。

对于 Microsoft 规范，您可以[从亚马逊购买带注释的副本](https://rads.stackoverflow.com/amzn/click/com/0321741765)，当然也可以从您喜欢的其他图书供应商处购买。我可以彻底推荐这个版本 - 注释真的很有趣。（嗯，我的不是那么热，但*其他*注释器真的很聪明：）

当然，有免费的软拷贝——我维护了一个[页面，其中包含指向各种版本的链接](http://csharpindepth.com/Articles/Chapter1/Specifications.aspx)。

# jquery-ui - jQuery buttonset：拦截点击，使按钮不改变状态

> ID：11346730
> 
> 赞同：1
> 
> 时间：2012-07-05T14:43:51.693
> 
> 标签：jquery-ui, events, button

我将 jQuery UI 按钮集用于一对开/关按钮，主要是因为您使用它可以获得漂亮的样式。我想处理点击，这样当您单击两个按钮之一时，您会看到一个对话框，您可以在其中做出更多选择，然后页面重新加载按钮处于新状态（如果状态已更改，可能不会是这样）。

问题在于，您单击的按钮在调用任何单击处理程序之前被设置为选中状态，看起来。我不想改变选择，我想手动进行。

似乎 click 事件绑定到 jQuery UI 创建的标签，我在解除绑定时有点挣扎。我想我也在问是否有其他方法可以在没有该功能的情况下获得样式......因为 buttonset 不提供任何事件处理程序，我无论如何都需要自己捕获点击事件。

我现在正在考虑的解决方案是将buttonset生成的html复制到我的代码中，保留css并删除buttonset调用。我认为在放弃之前检查 StackOverflow 可能是值得的。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:35:43.877

由于 jQuery UI 不会触发之前运行的任何事件以进行实际选择，因此完成此操作的变通方法将相对比较麻烦。我能想到的最好办法是以编程方式记住先前选择的选项，然后附加一个`click`处理程序来确定您是否应该恢复 jQuery UI 对新按钮的选择。

```
$('#parent_container').buttonset();
var selectedButton = $('#parent_container :checked');
$('.ui-button').on('click', function() {
    setTimeout(function() {
        //Insert your actual check here.
        if (true) {
            selectedButton.attr('checked', true);
            $('#radio').buttonset('refresh');
        } else {
            selectedButton = $('#parent_container :checked');
        }
    }, 1);
});​ 
```

有`setTimeout`必要确保它在 jQuery UI 的点击处理程序之后运行。由于您正在显示一个对话框，您可能需要更改它以立即恢复选择，但请记住用户尝试选择的内容以供将来使用。

我在这里有一个总是拒绝用户选择的例子 - [http://jsfiddle.net/tj_vantoll/s6XTu/14/](http://jsfiddle.net/tj_vantoll/s6XTu/14/)

显然，这不是一个理想的方法，但它确实有效。jQuery UI 应该真正添加对选择事件的支持；我会设法解决这个问题。按钮插件将在 1.11 - [http://wiki.jqueryui.com/w/page/12138038/Roadmap](http://wiki.jqueryui.com/w/page/12138038/Roadmap)中进行一些更新。

# php - 编写复杂内容过滤器的最有效方法是什么？

> ID：11346736
> 
> 赞同：21
> 
> 时间：2012-07-05T14:44:15.363
> 
> 标签：php, mysql, wordpress

不久前，我问了一个关于我的网站内容过滤器的相当长的问题。该帖子可以在[这里](https://stackoverflow.com/questions/11053409/how-do-i-go-about-creating-an-efficient-content-filter-for-certain-posts)找到，请随意阅读。

我接受了@DampeS8N 的回答，因为他回答得很好，并把我送到了正确的方向。

不幸的是，上述问题的结果是我使用的内容过滤器效率太低，无法在我的应用程序上下文中运行。

这是信息：

*   我有 ~2000+ 词汇表*和 ~1200+ 物种概况**
*   这些帖子的标题（词汇表条目）或科学名称（物种概况）构成了过滤器的搜索词
*   我想过滤我的物种概况的内容（最好在保存时，但可以通过 cron 作业完成）以搜索上述搜索词并将其替换为相关词汇表条目或物种概况的链接

`*`可以在[此处](http://www.seriouslyfish.com/glossary/p/palghat-gap/)找到词汇表条目。

> 词汇表条目的示例列表可能是`caudal fin`、、、、`dorsal`等 `filter`。

`**`可以在[此处](http://www.seriouslyfish.com/species/mastacembelus-erythrotaenia/)找到物种概况。

> 物种列表的示例可能是、、、、、`Apistogramma panduro`等。`A. panduro``Dario dario``D. dario``Betta sp. 'Maha Chai'`

这是问题所在：

*   我的 CMS 由 WordPress 驱动。除了了解我的物种概况的结构之外，这与这篇文章没有特别相关。
*   我的物种概况由存储在表中的一些基本信息和存储在`wp_posts`表中的附加信息组成`wp_postmeta`。
*   我的物种资料中的大部分信息都存储在一些 中`meta fields`，它们是表中的条目`wp_postmeta`。这可以在下面看到。

* * *

> `http://www.seriouslyfish.com/species/puntius-sahyadriensis/`

**wp_postmeta**

```
INSERT INTO `wp_postmeta` (`meta_id`, `post_id`, `meta_key`, `meta_value`) VALUES
(104395, 2288, 'genus', '<em>Puntius</em>'),
(104396, 2288, 'species', '<em>sahyadriensis</em>'),
(104397, 2288, 'family', 'Cyprinidae'),
(104398, 2288, 'common_names', ''),
(104399, 2288, 'distribution', '<a class="link_glossary" href="/glossary/e/endemic" rel="/glossary/e/endemic?hover=true">Endemic</a> to streams of the Yenna <a class="link_glossary" href="/glossary/r/river%20basin" rel="/glossary/r/river%20basin?hover=true">river basin</a> close to the city of Mahabaleshwar in the Western Ghats mountain range, Satara district, Maharashtra state, India.'),
(104400, 2288, 'habitat', 'The <a class="link_glossary" href="/glossary/r/river" rel="/glossary/r/river?hover=true">river</a> Yenna flows through lush evergreen forest meaning the hill streams in which the fish can be found are likely to be shaded by the forest canopy and dense <a class="link_glossary" href="/glossary/m/marginal" rel="/glossary/m/marginal?hover=true">marginal</a> vegetation. Substrates should be composed of boulders, smaller stones, <a class="link_glossary" href="/glossary/s/sand" rel="/glossary/s/sand?hover=true">sand</a> or <a class="link_glossary" href="/glossary/g/gravel" rel="/glossary/g/gravel?hover=true">gravel</a> with submerged tree roots around the margins and quieter areas in which fallen branches and leaf litter collect. As with similar members of the <a class="link_glossary" href="/glossary/g/genus" rel="/glossary/g/genus?hover=true">genus</a> it is likely to congregate in <a class="link_glossary" href="/glossary/b/backwater" rel="/glossary/b/backwater?hover=true">backwater</a> pools or deeper areas with lower flow.'),
(104402, 2288, 'max_size', 'Around 2.75"/7cm.'),
(104403, 2288, 'aquarium_size', 'It is an active <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> and a <a class="link_glossary" href="/glossary/t/tank" rel="/glossary/t/tank?hover=true">tank</a> measuring at least 36" x 12" x 12"/90cm x 30cm x 30cm/85 litres is needed to house a group.'),
(104404, 2288, 'maintenance', 'Choice of decor is not as critical as water quality and the amount of swimming-space provided. We suggest keeping it in a roomy, well-planted <a class="link_glossary" href="/glossary/a/aquarium" rel="/glossary/a/aquarium?hover=true">aquarium</a> or alternatively it would look superb in a set-up designed to resemble a flowing <a class="link_glossary" href="/glossary/r/river" rel="/glossary/r/river?hover=true">river</a> with a <a class="link_glossary" href="/glossary/s/substrate" rel="/glossary/s/substrate?hover=true">substrate</a> of variably-sized rocks and <a class="link_glossary" href="/glossary/g/gravel" rel="/glossary/g/gravel?hover=true">gravel</a> and some large water-worn boulders. A rivertank manifold could also be constructed to provide naturalistic unidirectional flow. The <a class="link_glossary" href="/glossary/t/tank" rel="/glossary/t/tank?hover=true">tank</a> can be further furnished with driftwood branches and <a class="link_glossary" href="/glossary/a/aquatic" rel="/glossary/a/aquatic?hover=true">aquatic</a> plants for aesthetic value. While the vast majority of plant <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> will fail to thrive in such conditions possibilities include hardy <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> such as Java fern, <em>Bolbitis</em> or <em>Anubias</em> <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> which can be grown attached to the decor. Like many other <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> that hail from pristine natural environments it is intolerant to the accumulation of <a class="link_glossary" href="/glossary/o/organic" rel="/glossary/o/organic?hover=true">organic</a> wastes and requires spotless water at all times in order to thrive.'),
(104405, 2288, 'water_chemistry', '<strong>Temperature</strong>: Prefers slightly cool conditions within the range 20 - 24°C/68 - 75°C. Higher temperatures are known to stimulate spawning with an associated increase of aggression in males.\r\n\r\n<strong>pH</strong>: 6.8 - 7.8\r\n\r\n<strong>Hardness</strong>: 5 - 15°H'),
(104406, 2288, 'diet', 'Likely to feed on small invertebrates, <a class="link_glossary" href="/glossary/a/algae" rel="/glossary/a/algae?hover=true">algae</a> and other <a class="link_glossary" href="/glossary/z/zooplankton" rel="/glossary/z/zooplankton?hover=true">zooplankton</a> in nature. In the <a class="link_glossary" href="/glossary/a/aquarium" rel="/glossary/a/aquarium?hover=true">aquarium</a> it will accept dried foods of a suitable size but should not be fed these exclusively. Daily meals of small live and frozen fare such as <em><a class="link_glossary" href="/glossary/D/Daphnia" rel="/glossary/D/Daphnia?hover=true">Daphnia</a></em>, <em><a class="link_glossary" href="/glossary/A/Artemia" rel="/glossary/A/Artemia?hover=true">Artemia</a></em> and suchlike will result in the best colouration and encourage the fish to come into breeding condition.'),
(104407, 2288, 'behaviour', 'Not an aggressive fish but best kept with other hillstream-dwelling <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> such as <em>Danio</em>, <em>Devario</em>, other small <em>Puntius</em>, <em>Garra</em> and balitorid loaches. That said provided its oxygen and temperature requirements can be met it can be mixed with most peaceful fish too large to be considered food. A <a class="link_glossary" href="/glossary/b/biotope" rel="/glossary/b/biotope?hover=true">biotope</a>-style <a class="link_glossary" href="/glossary/c/community" rel="/glossary/c/community?hover=true">community</a> based around <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> from hill streams of the Western Ghats would also make an interesting project with <em><a class="link_species" href="/species/puntius-filamentosus" rel="/species/puntius-filamentosus/?hover=true">Puntius filamentosus</a></em>, <em><a class="link_species" href="/species/puntius-fasciatus" rel="/species/puntius-fasciatus/?hover=true">P. fasciatus</a></em>, <em><a class="link_species" href="/species/puntius-narayani" rel="/species/puntius-narayani/?hover=true">P. narayani</a></em>, <em><a class="link_species" href="/species/puntius-ticto" rel="/species/puntius-ticto/?hover=true">P. ticto</a></em>, <em>Barilius bakeri</em>, <em>B. canarensis</em>, <em><a class="link_species" href="/speciesario-aequipinnatus" rel="/speciesario-aequipinnatus/?hover=true">Devario aequipinnatus</a></em>, <em><a class="link_species" href="/speciesario-malabaricus" rel="/speciesario-malabaricus/?hover=true">D. malabaricus</a></em>, <em>Rasbora daniconius</em>, <em>Laubuca laubuca</em>, <em>Nemacheilus rupelli</em>, <em>Mesonemacheilus triangularis</em> and <em><a class="link_species" href="/species/mesonoemacheilus-guentheri" rel="/species/mesonoemacheilus-guentheri/?hover=true">M. guentheri</a></em> among the numerous suitable <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> available in the trade at times.\r\n\r\nIt''s a shoaling <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> by nature and really should be kept in a group of at least 8-10 specimens. Maintaining it in decent numbers will not only make the fish less nervous but will result in a more effective, natural-looking display while allowing individuals some respite from the vigorous alpha male(s). Males will also display their best colours and some interesting behaviour as they compete with one other for female attention. In particular the dominant individual in a given group will develop some stunning colouration.'),
(104408, 2288, 'dimorphism', 'The male is noticeably slimmer and more brightly coloured than the female especially when the fish are in <a class="link_glossary" href="/glossary/s/spawning" rel="/glossary/s/spawning?hover=true">spawning</a> condition. Most notably the body colouration is more intense, <a class="link_glossary" href="/glossary/v/ventral" rel="/glossary/v/ventral?hover=true">ventral</a> fins tipped with white, other finnage redder and prominent tubercules develop around the <a class="link_glossary" href="/glossary/s/snout" rel="/glossary/s/snout?hover=true">snout</a> and head in sexually <a class="link_glossary" href="/glossary/m/mature" rel="/glossary/m/mature?hover=true">mature</a> specimens.'),
(104409, 2288, 'reproduction', 'We''re not sure if it has been bred in the hobby although it should certainly be possible. Like most cyprinids this <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> is an <a class="link_glossary" href="/glossary/e/egg" rel="/glossary/e/egg?hover=true">egg</a>-scattering, continuous spawner that exhibits no <a class="link_glossary" href="/glossary/p/parental%20care" rel="/glossary/p/parental%20care?hover=true">parental care</a>. That is to say when the fish are in good condition they will <a class="link_glossary" href="/glossary/s/spawn" rel="/glossary/s/spawn?hover=true">spawn</a> often and in a well-furnished, <a class="link_glossary" href="/glossary/m/mature" rel="/glossary/m/mature?hover=true">mature</a> <a class="link_glossary" href="/glossary/a/aquarium" rel="/glossary/a/aquarium?hover=true">aquarium</a> it is feasible that small numbers of <a class="link_glossary" href="/glossary/f/fry" rel="/glossary/f/fry?hover=true">fry</a> may start to appear without human intervention.\r\n\r\nHowever if you want to increase the yield of <a class="link_glossary" href="/glossary/f/fry" rel="/glossary/f/fry?hover=true">fry</a> a slightly more controlled approach is required and we suggest using an approach that has proven successful for similar members of the <a class="link_glossary" href="/glossary/g/genus" rel="/glossary/g/genus?hover=true">genus</a> as a starting point. The adult group can still be conditioned together but one or more small, say 18" x 10" x 10"/45cm x 25cm x 25cm/29.5 <a class="link_glossary" href="/glossary/l/litre" rel="/glossary/l/litre?hover=true">litre</a> containers should also be set up and half-filled with water. These should be very dimly lit with the <a class="link_glossary" href="/glossary/b/base" rel="/glossary/b/base?hover=true">base</a> either left bare or covered with some kind of mesh of a large enough grade so that any eggs that fail to adhere to the plant can pass through but small enough so that the adults cannot reach them. The widely available plastic ''grass''-<a class="link_glossary" href="/glossary/t/type" rel="/glossary/t/type?hover=true">type</a> matting can also be used and works very well. A decent-sized clump of Java moss or other fine-leaved plant should also be added filling perhaps half the available space. The water should be around <a class="link_glossary" href="/glossary/n/neutral" rel="/glossary/n/neutral?hover=true">neutral</a> <a class="link_glossary" href="/glossary/p/pH" rel="/glossary/p/pH?hover=true">pH</a>, <a class="link_glossary" href="/glossary/G/GH" rel="/glossary/G/GH?hover=true">gH</a> &lt;8, with a slightly raised temperature of 75 - 80°F. A small air-powered <a class="link_glossary" href="/glossary/s/sponge%20filter" rel="/glossary/s/sponge%20filter?hover=true">sponge filter</a> bubbling away very gently is all that is needed in terms of filtration.\r\n\r\nWhen the adult fish are well-conditioned and the females appear full of eggs a single <a class="link_glossary" href="/glossary/p/pair" rel="/glossary/p/pair?hover=true">pair</a> should then be introduced to each container. If conditions are to their liking they should <a class="link_glossary" href="/glossary/s/spawn" rel="/glossary/s/spawn?hover=true">spawn</a> the following morning. Be sure to provide plenty of cover for the female as the male may be quite aggressive in his pursuit of her. In some cases she might even require a period of post-<a class="link_glossary" href="/glossary/s/spawning" rel="/glossary/s/spawning?hover=true">spawning</a> rehabilitation in a <a class="link_glossary" href="/glossary/t/tank" rel="/glossary/t/tank?hover=true">tank</a> that does not contain any males.\r\n\r\nThe adults will eat the eggs given the chance and should be removed as soon as any are noticed. Incubation in <em>Puntius</em> eggs is temperature-dependant to an extent but usually takes between 20 and 48 hours with the young free-swimming 24 to 48 hours later. Initial food should be <em>Paramecium</em> or similar introducing <em><a class="link_glossary" href="/glossary/A/Artemia" rel="/glossary/A/Artemia?hover=true">Artemia</a></em> <a class="link_glossary" href="/glossary/n/nauplii" rel="/glossary/n/nauplii?hover=true">nauplii</a> and/or <a class="link_glossary" href="/glossary/m/microworm" rel="/glossary/m/microworm?hover=true">microworm</a> once the <a class="link_glossary" href="/glossary/f/fry" rel="/glossary/f/fry?hover=true">fry</a> are large enough to accept them.'),
(104410, 2288, 'misc_notes', 'This beautiful <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> is not often seen in the hobby, presumably as a result of its limited distribution, and tends to command a relatively high price when available. It may be seen on sale under the trade names ''Maharaja'' or ''Khavli'' <a class="link_glossary" href="/glossary/b/barb" rel="/glossary/b/barb?hover=true">barb</a>.\r\n\r\nThe <a class="link_glossary" href="/glossary/g/genus" rel="/glossary/g/genus?hover=true">genus</a> <em>Puntius</em> is currently viewed as something of a catch-all for well over 100 <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> of small cyprinid. Most experts agree that a full <a class="link_glossary" href="/glossary/r/revision" rel="/glossary/r/revision?hover=true">revision</a> is required, with the likely outcome that many <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> will be placed into new or different <a class="link_glossary" href="/glossary/g/genera" rel="/glossary/g/genera?hover=true">genera</a>. When describing the <a class="link_glossary" href="/glossary/g/genus" rel="/glossary/g/genus?hover=true">genus</a> in 1822, Hamilton identified the defining characteristics as: "absence or presence of <a class="link_glossary" href="/glossary/m/maxillary" rel="/glossary/m/maxillary?hover=true">maxillary</a> only or <a class="link_glossary" href="/glossary/r/rostral" rel="/glossary/r/rostral?hover=true">rostral</a> and <a class="link_glossary" href="/glossary/m/maxillary" rel="/glossary/m/maxillary?hover=true">maxillary</a> barbels; <a class="link_glossary" href="/glossary/d/dorsal" rel="/glossary/d/dorsal?hover=true">dorsal</a> <a class="link_glossary" href="/glossary/f/fin" rel="/glossary/f/fin?hover=true">fin</a> with last <a class="link_glossary" href="/glossary/s/simple%20ray" rel="/glossary/s/simple%20ray?hover=true">simple ray</a> <a class="link_glossary" href="/glossary/s/serrate" rel="/glossary/s/serrate?hover=true">serrate</a> or entire, <a class="link_glossary" href="/glossary/b/branched%20rays" rel="/glossary/b/branched%20rays?hover=true">branched rays</a> usually 8; anal <a class="link_glossary" href="/glossary/f/fin" rel="/glossary/f/fin?hover=true">fin</a> with last <a class="link_glossary" href="/glossary/s/simple%20ray" rel="/glossary/s/simple%20ray?hover=true">simple ray</a> entire, <a class="link_glossary" href="/glossary/b/branched%20rays" rel="/glossary/b/branched%20rays?hover=true">branched rays</a> usually 5; <a class="link_glossary" href="/glossary/l/lateral%20line" rel="/glossary/l/lateral%20line?hover=true">lateral line</a> complete or incomplete, <a class="link_glossary" href="/glossary/l/lateral" rel="/glossary/l/lateral?hover=true">lateral</a>-line scales 17-36 in row; <a class="link_glossary" href="/glossary/c/cephalic" rel="/glossary/c/cephalic?hover=true">cephalic</a> <a class="link_glossary" href="/glossary/c/cutaneous" rel="/glossary/c/cutaneous?hover=true">cutaneous</a> <a class="link_glossary" href="/glossary/p/papillae" rel="/glossary/p/papillae?hover=true">papillae</a> minute or absent; <a class="link_glossary" href="/glossary/p/pharyngeal%20teeth" rel="/glossary/p/pharyngeal%20teeth?hover=true">pharyngeal teeth</a> in 3 rows, usually 2,3,5/5,3,2; colour pattern extremely variable." All the <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> currently in the <a class="link_glossary" href="/glossary/g/genus" rel="/glossary/g/genus?hover=true">genus</a> are <a class="link_glossary" href="/glossary/n/native" rel="/glossary/n/native?hover=true">native</a> to Southeast Asia, India and Sri Lanka.\r\n\r\nThe other main source of confusion with <em>Puntius</em> is that some authors do not recognise all the member <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> as such, rather following Walter Rainboth (1996) and preferring to place some into the alternative <a class="link_glossary" href="/glossary/g/genus" rel="/glossary/g/genus?hover=true">genus</a> <em>Systomus</em>. Rainboth proposed that <em>Systomus</em> should be reinstated (it was first erected in the 19th century) as a valid <a class="link_glossary" href="/glossary/g/genus" rel="/glossary/g/genus?hover=true">genus</a> on account of the fact that in its current state <em>Puntius</em> would seem to constitute a <a class="link_glossary" href="/glossary/p/polyphyletic" rel="/glossary/p/polyphyletic?hover=true">polyphyletic</a> grouping i.e. not all of its members appear to have descended from the same common ancestor. The defining characteristics of a <em>Systomus</em> <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> are (according to Rainboth) a <a class="link_glossary" href="/glossary/s/serrated" rel="/glossary/s/serrated?hover=true">serrated</a> (vs. smooth in <em>Puntius</em>) <a class="link_glossary" href="/glossary/d/dorsal" rel="/glossary/d/dorsal?hover=true">dorsal</a> <a class="link_glossary" href="/glossary/s/spine" rel="/glossary/s/spine?hover=true">spine</a>, the presence of 2 or 4 barbels (vs. always 2) and less than 12 <a class="link_glossary" href="/glossary/g/gill" rel="/glossary/g/gill?hover=true">gill</a> rakers (vs. 12-20). SF tentatively lists all <a class="link_glossary" href="/glossary/s/species" rel="/glossary/s/species?hover=true">species</a> as <em>Puntius</em> at present.'),
(167927, 2288, 'etymology', ''),
(104421, 2288, 'attached_media', 'a:4:{i:0;s:5:"22881";i:1;s:5:"22882";i:2;s:5:"22883";i:3;s:5:"22884";}'),
(150578, 2288, 'references', 'a:2:{i:0;a:5:{s:13:"ref_doc_title";s:67:"Assemblage structure of stream fishes in the Western Ghats (India).";s:12:"ref_pub_year";s:0:"";s:13:"ref_page_nums";s:5:"1-31.";s:14:"ref_publishers";s:17:"Hydrobiologia 430";s:11:"ref_authors";s:19:"Arunachalam M. 2000";}i:1;a:5:{s:13:"ref_doc_title";s:0:"";s:12:"ref_pub_year";s:0:"";s:13:"ref_page_nums";s:0:"";s:14:"ref_publishers";s:16:"www.fishbase.org";s:11:"ref_authors";s:0:"";}}'),
(167925, 2288, '_edit_lock', '1341244017:4'),
(167928, 2288, 'species_author', 'Silas'),
(167929, 2288, 'year_described', '1953'),
(167930, 2288, 'beginner_suitability', '3'),
(167931, 2288, 'type_of_fish', '2') 
```

**wp_posts**

```
INSERT INTO `wp_posts` (`ID`, `post_author`, `post_date`, `post_date_gmt`, `post_content`, `post_title`, `post_excerpt`, `post_status`, `comment_status`, `ping_status`, `post_password`, `post_name`, `to_ping`, `pinged`, `post_modified`, `post_modified_gmt`, `post_content_filtered`, `post_parent`, `guid`, `menu_order`, `post_type`, `post_mime_type`, `comment_count`) VALUES
(2288, 4, '2012-03-13 13:24:32', '2012-03-13 13:24:32', '', 'Puntius sahyadriensis', 'This beautiful species is not often seen in the hobby, presumably as a result of its limited distribution, and tends to command a relatively high price when available. It may be seen on sale under the trade names &#039;Maharaja&#039; or &#039;Khavli&#039; barb.\r\n\r\nThe genus Puntius is currently viewed as something of a catch-all for well over 100 species of small cyprinid. Most experts agree that a full revision is required, with the likely outcome that many species will be placed into new or di...', 'publish', 'open', 'open', '', 'puntius-sahyadriensis', '', '', '2012-07-02 16:48:43', '2012-07-02 15:48:43', '', 0, 'http://www.seriouslyfish.com/?post_type=species&#038;p=2288', 0, 'species', '', 0); 
```

* * *

如您所见，物种概况的内容非常冗长。希望这也将向您展示我想用来获取弹出窗口的那种链接：

```
<a class="link_glossary" href="/glossary/n/native" rel="/glossary/n/native?hover=true">native</a> 
```

* * *

我的问题是：**我目前正在运行的过滤器**，其详细信息可以在第一个链接的帖子中找到，或者直接[在这里](http://pastebin.com/HC3Z38bM)找到我的`filter.php`文件，**根本不足以处理这么多数据库字段，而这个很多信息**。

当我第一次开始使用我们新的 WordPress 驱动的 CMS 时，过滤器确实有效，因为我在导入数据时在 localhost WAMP 安装上运行它。跑完所有数据花了将近 40 分钟。

* * *

我的 tl;dr 问题是：考虑到数据量和数据库字段的数量，**我该如何创建一个有效的内容过滤器？**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-07T19:03:15.993

# 数据库结构

```
wp_postmeta (meta_id, post_id, meta_key, meta_value)
wp_glossary (glossary_id, glossary_key, glossary_value)
wp_relation (meta_id, glossary_id) 
```

wp_relation 存储 wp_glossary 和 wp_postmeta 之间的关系。以下是 wp_postmeta 条目的示例：

> **维护**
> ***水箱***应种植良好的浮动植物也使用。应该提供大量的藏身之处，因为这个***物种***喜欢在白天躲起来。***博格伍德***、岩洞和 PVC 管道都适用于此目的。应该使用***沙子作为******基质***，因为刺鳗通常喜欢掩埋自己。较暗的灯光将鼓励鱼更频繁地从藏身之处冒险。鳗鱼可以通过最小的缝隙找到自己的出路，因此需要一个紧密贴合的引擎盖。水流应该相当温和，因为鱼主要栖息在野外的静止水域。

以下是 wp_glossary 的条目示例

```
glossary_id | glossary_key | glossary_value
         101   tank           ......
         102   species        ......
         103   bogwood        ......
         104   sand           ......
         105   substrate      ...... 
```

以下是 wp_relation 如何保持词汇表和 postmeta 关系的示例。假设上面 postmeta 的 id 是 405

```
glossary_id | meta_id 
         101   405       
         102   405  
         103   405    
         104   405       
         105   405 
```

* * *

# 输出配置文件

一旦您可以维护上述数据库结构，您可以通过在 wp_relation 中搜索 wp_postmeta 条目的 id 轻松地为每个 wp_postmeta 构建词汇表链接。然后，`str_replace`用于填写指向您的内容的链接。

为了提高性能，您可以将结果内容缓存在 HTML 中。将缓存过期设置为 1 或 2 天（取决于您更新词汇表的频率和网站流量）。您可以使用`memcached`,`file`或`database`来存储您的缓存。

* * *

# 维护数据库结构

最困难的任务是维护我们的数据库关系。有两个主要的操作可以改变数据库关系。

## 更改词汇表

*   **添加新词汇表：**搜索 wp_postmeta 并构建关系。
*   **删除词汇表：**删除此词汇表与其他 wp_postmeta 之间的所有关系
*   **编辑词汇表：**它是删除词汇表和添加新词汇表的组合。

## 更改 Postmeta

*   **添加/编辑 Postmeta**：重建词汇表及其内容之间的关系。以下是可用于构建关系的算法。我相信还有其他更好的方法可以做到这一点。*代码不完整（我还没有测试过），但足以让你理解算法。*

    ```
    // Initialize text to add glossary link
    $desc = "Tank should be well planted with floating plants also used. 
            An abundance of hiding places should be provided as this species 
            likes to hide away during the day. Bogwood, rock caves and PVC 
            piping are all suitable for this purpose. Sand should be used as 
            substrate as the spiny eels often like to bury themselves. 
            Dimmer lighting will encourage the fish to venture from 
            its hiding places more often. A close-fitting hood is required 
            as the eel can find its way through the smallest of gaps. Water 
            flow should be fairly gentle as the fish mainly inhabits 
            areas of still water in the wild.";

    // Split text into list of words
    $split = preg_split("/[.,\s]+/", $desc);

    // Frequency English words
    $freq['will'] = true;
    $freq['also'] = true;
    $freq['with'] = true;
    $freq['about'] = true;
    $freq['back'] = true;
    $freq['been'] = true;
    $freq['were'] = true;
    $freq['want'] = true;

    // Get list of unqiue word and elimate unnessary words
    foreach($split as $value) {
        $value = strtolower($value);

        if (strlen($value) < 4) continue;
        if (is_numeric($value)) continue;
        if (isset($freq[$value])) continue;

        if (!isset($hash[$value])) $hash[$value] = true;
    }

    // Join the list for search
    $keys = "";
    foreach ($hash as $key => $value)
        $keys .= "^{$key}|";
    $keys = rtrim($keys, '|');

    // Search for list of glossary
    $glossary;
    $result = mysql_query("SELECT glossary_id,glossary_key FROM wp_glossary  WHERE gossary_key REGEXP '{$keys}'")
    if ($result) {
        while($row = mysql_fetch_row($result)) {
            if (strpos($desc, $row[1]) !== false)
                $glossary[$row[0]] = $row[1];
        }
    }

    // You can start to construct the relation from this $glossary
    // by loop throught it one by one and insert it into wp_relation
    print_r($glossary); 
    ```

*   **删除 Postmeta ：**删除此 postmeta 和词汇表之间的关系。

* * *

# 额外福利

假设您要查找使用词汇表“bogwood”的物种概况。您可以通过 wp_relation 轻松跟踪它。

* * *

# 问题

> **1** . 首先，str_replace 将如何影响我的物种配置文件，这些配置文件中包含现有代码，即 href 或 img 代码？

如果没有`a link`词汇表和物种名称，它不会影响您的物种概况。

> **2** . 其次，您提到了词汇表条目，但没有提到稍微复杂的物种属/物种名称。我会为这些使用单独的表，还是将它们全部合并到一个表中？

您可以有单独的表来存储物种名称和 postmeta 之间的关系，或者您可以简单地将物种名称视为带有特殊标志的词汇表术语（需要更改词汇表的结构）

> **3** . 然后，我将如何指定词汇表条目和物种概况之间的区别（a 标签中的不同类）？

回答取决于您对第二个问题使用的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T15:22:00.553

您是否考虑过[三元搜索树](http://en.wikipedia.org/wiki/Ternary_search_tree)？

这是我在面对“在文本质量 y 中找到 x 个单词”的问题时比较喜欢的数据结构。

构建的示例树（鳍、过滤器、尾端、加仑、花哨）：

```
 f
       /|\
caudal* i ga
        |  | 
        n* l*
       /    \
    lter*    udy*

* = end node 
```

该算法将遵循以下原则：

*   在根节点开始匹配单词。
*   只要当前位置匹配向下移动。
*   如果当前位置 < 节点。向左移动。
*   如果当前位置 > 节点。向右移。
*   如果单词完成并且节点是结束节点。词找到了。
*   如果无法向左/向右移动或单词以非结束节点结尾。找不到词。

这是一个[很好的例子](http://igoro.com/archive/efficient-auto-complete-with-a-ternary-search-tree/)。

优点是树可以预先计算并以某种序列化的形式存储起来。通常甚至可以构建或传输预先构建的树到客户端并在浏览器中进行匹配。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-08T11:32:31.083

这是另一个想法，在客户端上做标记。

将分类法​​提取为文本文件并缓存“转换术语”。

```
guppie
salmon 
```

让 JS 在读者阅读页面并重写 url 时浏览它们；

```
<a href="/section/guppie">guppie</a> and a <a href="/section/salmon">salmon</a> 
```

自从我曾经在这里进行过一次旧讨论以来，网上肯定有更多关于这种方法的信息。

我还偶然发现了可能与您的案例相关的[WP 自定义分类法。](http://wp.smashingmagazine.com/2012/01/04/create-custom-taxonomies-wordpress/)

# php - iPhone 上的图像捕获失败，没有会话数据可显示

> ID：11346738
> 
> 赞同：0
> 
> 时间：2012-07-05T14:44:23.223
> 
> 标签：php, iphone, session, variables, mobile

我目前使用以下代码作为图像验证码。

```
<?php
session_start();    
$alphanum = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789";
// generate the verication code 
$rand = substr(str_shuffle($alphanum), 0, 5);
// choose one of four background images
$bgNum = rand(1, 4);
$image = imagecreatefromjpeg("background$bgNum.jpg");
$textColor = imagecolorallocate ($image, 0, 0, 0);
// create the hash for the random number and put it in the session
$_SESSION['image_random_value'] = md5($rand);
// write the random number
imagestring ($image, 15, 50, 10, $rand, $textColor);    
// Date in the past
header("Expires: Mon, 23 January 2009 01:00:00 GMT");
// always modified
header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");
// HTTP/1.1
header("Cache-Control: no-store, no-cache, must-revalidate");
header("Cache-Control: post-check=0, pre-check=0", false);
// HTTP/1.0
header("Pragma: no-cache");
// send the content type header so the image is displayed properly
header('Content-type: image/jpeg');
// send the image to the browser
imagejpeg($image);
// destroy the image to free up the memory
imagedestroy($image);
?> 
```

然后我使用以下内容来验证表单提交中的验证码...

```
if (md5(addslashes($_POST['antispam'])) != $_SESSION['image_random_value']) { 
```

我多年来一直在使用它，它在浏览器中运行完美，但我刚刚意识到它在 Iphone 上不起作用。

使用 echo $_SESSION['image_random_value']; 在浏览器中返回会话值，但在 iphone 上返回一个空变量？

我已经厌倦了更改过期日期，并注释掉一些参数 ref 缓存控制。但这些都不起作用。有关信息，我确实在我的 iPhone 上启用了 cookie。

关于我错过了什么的任何提示或指示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T21:20:22.370

好吧，对于那些有类似问题的人来说，事实证明我是直接从 URL 中提取脚本，这当然会导致设置会话的问题。希望对某人有所帮助。

# javascript - 解析日期的问题，如 twitter

> ID：11346741
> 
> 赞同：3
> 
> 时间：2012-07-05T14:44:32.607
> 
> 标签：javascript, parsing, date, twitter

我正在解析来自推特的推文，我想显示推特“40 分钟前发布”、“1 小时前发布”之类的日期，但我有以下问题：

当我收到用户推文时，推特给我这种格式（链接 json）：

```
http://twitter.com/status/user_timeline/BarackObama.json?count=5&callback=308
"created_at": "Tue Jul 03 01:54:48 +0000 2012", 
```

当我搜索一个主题标签时：

```
http://search.twitter.com/search.json?callback=?&rpp=5&q=%23wasabi
"created_at": "Thu, 05 Jul 2012 14:31:57 +0000", 
```

谁能帮我解析这些日期？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T14:51:49.020

这应该工作：

```
new Date(data.created_at); 
```

（你也可以使用[timeago](http://timeago.yarp.com/) - [http://jsfiddle.net/ZhF6y/](http://jsfiddle.net/ZhF6y/)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T15:05:48.970

John Resig 也有一个不错的小日期解析脚本。 [http://ejohn.org/blog/javascript-pretty-date/](http://ejohn.org/blog/javascript-pretty-date/)

这是一个包含您需要的代码的 JSFiddle。

更新了示例推文抓取 - 你知道你想要我的答案；）

[http://jsfiddle.net/ETACy/4/](http://jsfiddle.net/ETACy/4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-22T18:04:40.613

如果您可以转换为 Unix 时间戳，请尝试[Livestamp.js](http://mattbradley.github.com/livestampjs/)。它不显眼且自动更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-12T16:00:12.390

我不是专家，但您不需要外部库，只需将 UTC 放在 + 号前面。

```
var date = new Date(Date.parse(tweet.created_at.replace(/( \+)/, ' UTC$1'))); 
```

灵感来自[https://gist.github.com/ghostrocket/799429](https://gist.github.com/ghostrocket/799429)

# c# - 使用 JSON 数据作为参考生成类

> ID：11346743
> 
> 赞同：1
> 
> 时间：2012-07-05T14:44:35.460
> 
> 标签：c#, .net, json

我正在使用返回 JSON 对象的类似 REST 的 API。我可以将这些对象反序列化为 C# 对象，但我想要强类型的解决方案。

是否有任何工具可以使用 JSON 对象作为参考生成类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:52:36.277

此页面包含一些指向从 JSON 生成 C# 类的工具的链接：

[http://www.codeproject.com/Articles/233698/Consuming-a-Json-WebService-from-a-Csharp-or-VB-Ap](http://www.codeproject.com/Articles/233698/Consuming-a-Json-WebService-from-a-Csharp-or-VB-Ap)

# linux - 读取已失效进程的退出值

> ID：11346747
> 
> 赞同：0
> 
> 时间：2012-07-05T14:44:50.130
> 
> 标签：linux, zombie-process

我有一个死进程，现在处于失效状态，这意味着它的父进程还没有读取它的退出值。（它不会读它）

我知道退出值存储在内核中的某个位置供父进程读取，但是，如果我不是父进程，有没有办法读取该值？

理想情况下，我可以从 shell 或 abritrary C/python/your-favorite-language 程序执行此操作。

[编辑]：这不是关于如何收割或杀死孩子的问题。我不在乎它是否用完进程表中的一个槽。我只想知道它的退出值是多少。即，我想阅读内核中的task_struct->exit_code。

马修

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:58:47.240

您可能可以做的一件事是发送 parent `SIGCHLD`，告诉它一个孩子已经死了。如果该程序具有任何质量，它将获得该过程。

```
kill -s SIGCHLD parentpid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:56:53.073

不会。尝试调用`waitpid()`不是调用进程的子进程之一的进程将导致`ECHILD`. 您将需要杀死父进程，导致子进程重新成为`init`，随后将获得它。

# excel - 如何查找基于单个单元格的信息？在 Excel 中

> ID：11346752
> 
> 赞同：1
> 
> 时间：2012-07-05T14:45:09.730
> 
> 标签：excel

我在 VBA 上工作了很长时间，我忘记了如何做到这一点……使用公式。

我有一个包含描述符的单元格，在本例中为 K1122121。它旁边的单元格将是描述。在另一张表上，我有一个零件列表，我需要在表 2 上查找所述零件号，并将描述放在它正在查找的零件旁边。

我知道这是可能的，我只是忘记了如何。

所以回顾一下。

表一有两个单元格，第一个是零件号，第二个旁边是公式所在的位置，在此单元格中将生成对所述零件号的描述。

表二并排有部分和描述。我需要参考零件编号并找到描述。

找到描述后，将所述描述放在第一页的描述字段中。

谢谢您的帮助。

这是我正在处理的内容的链接。[https://dl.dropbox.com/u/3327208/Excel/PAERTO.xlsm](https://dl.dropbox.com/u/3327208/Excel/PAERTO.xlsm)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:49:34.230

它被称为`VLOOKUP`，你这样称呼它：

```
=VLOOKUP(A1,Sheet2!A:B,2,FALSE) 
```

在哪里：

*   `A1`是 sheet1 中零件号的单元格
*   `Sheet2`数据所在的工作表（描述符/描述）
*   `A:B`是 sheet2 中数据所在的范围
*   `2`因为您要查找的内容在第二列中
*   `FALSE`仅获取完全匹配的值 - 如果未找到完全匹配，则会显示错误

**编辑**

查看您的工作簿，我会亲自在工作列表中插入一个新列（例如在 D 和 E 之间），其中的公式仅保留第一个单词 - E3 中的公式：

```
=IF(ISERROR(FIND(" ",D3)),D3,LEFT(D3,FIND(" ",D3)-1)) 
```

然后 PAERTO 表中的公式变为 - D20 中的公式：

```
=VLOOKUP($E20,'Jobs List'!$E:$F,2,FALSE) 
```

在您提供的示例中，我得到第 20、22 和 24 行的结果，而其他行出现错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T18:01:41.563

如果我使用这个公式，我可以得到一个结果：

`=VLOOKUP(E20&" Rev"&F20,'Jobs List'!D:E,2,0)`

但是，您需要将单元格更改`F20`为`4`.

只要零件编号和“修订版”在工作表之间保持一致，这个公式就可以工作。

请注意，只有单元格`D20`和`D24`返回值。其他零件编号不存在于另一张纸上，因此无论使用什么公式，您都不会看到返回值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:49:57.307

在 A1 中使用您的零件编号，在 B1 中，公式`=VLOOKUP(A1,Sheet2!A:B,2,FALSE)`将找到描述

如果您使用的是 Excel 2003 或更早版本，则必须更改`Sheet2!A:B`为完整参考，例如`Sheet2!A2:B2000`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-06T16:38:24.367

答案比我希望的要复杂一些，但我最终使用了这个作为答案。它可能不是最简单或最优雅的，但它确实有效。

`=IF(E20=0,VLOOKUP("*"&E20&"*",'Jobs List'!D:E,2,FALSE),VLOOKUP("*"&E20&"*",'JL Archive'!D:E,2,FALSE))`

我用它`"*"`来制作它，以便它使用通配符，这是我从未想过使用的东西……但它确实有效。我将通配符的用法放在前面和后面，以防任何单元格的前面或后面可能有超出所需文本的内容。

我希望这对人们有所帮助。最初的用途是让我可以使用可以从另一个工作簿中使用的公式，但众所周知，它可以在任何地方使用。享受 ：）

# cmake - CMake：构建多个项目使用的库

> ID：11346754
> 
> 赞同：2
> 
> 时间：2012-07-05T14:45:25.873
> 
> 标签：cmake

我有一个目录，其中包含几个用于独立项目的工具，例如：

```
CommonTools
  + Tool A
  + Tool B
  + Tool C 
```

工具 B 依赖于工具 A，但工具 A 可以独立于工具 B 使用。我想我有两个选择：

1.  我可以将这些工具安装在系统目录下（例如，对于 Windows，`C:\Program Files`）。这不一定是一件好事，因为我的一些程序打算在与它们交付的目录相同的目录中使用，因为我没有足够的权限写入系统目录）。此外，我仍然需要找到头文件来编译使用这些工具的项目。

2.  我可以`find_library`用来定位它们。然后我遇到了以下问题：`find_library(A)`在我实际构建 A 之前无法工作，所以我不能`cmake CommonTools`（因为工具 B 需要工具 A）。我可以从make调用cmake，但这看起来相当复杂......

3.  我可以在工具 B 中放置工具 A 的相对路径，并且仅`find_library`用于其他项目。不幸的是，这个相对路径的变化取决于我是在构建 CommonTools 还是 Tool B。

您对此有何看法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T07:34:43.447

因为我希望能够执行一步构建，所以这就是我最终要做的。

*   我将当前正在构建的模块的子模块与外部依赖项和第三方工具区分开来。**每个（子）模块只负责构建自己**。这意味着所有外部依赖项和第三方工具*必须*已经安装或从服务器以二进制 + 标头形式提供。作为推论，这意味着缺少的依赖项是一个二进制文件，它应该从给定的服务器上可用，但不是。
*   使用 添加子模块`add_subdirectory`，这意味着如果其中任何一个不可用，配置步骤将失败并显示显式消息。
*   外部依赖项和第三方工具位于使用`find_package`. 位置是一个选项，必须由执行构建的`HINT`用户提供（这向用户指示了模块的依赖关系。如果找不到任何一个，则使用`ExternalProject_Add`.`<module>_FOUND`和`<module>_LIBRARIES`&`<module>_INCLUDE_DIRS`变量从给定位置下载二进制文件必须在 CMakeLists.txt 文件中手动设置，但在服务器端提供适当的目录布局（例如`<module>-<version>-<platform>/include`& `<module>-<version>-<platform>/binaries`），它可以以一致的方式完成（例如使用宏）。再次，如果没有找到二进制文件服务器，配置步骤将失败并显示显式消息。

所有这一切意味着持续集成服务器将在配置时而不是在构建时正确检测任何丢失的依赖项（即，应该在服务器上但不在服务器上的组件或不受版本控制的子模块），同时仍然允许一个步骤构建。

我希望这对其他人有用。

PS：作为 Google Test 用户的一个侧节点：“**必须**为每个模块重新编译 gtest，因为每个用户都需要使用用于编译已安装的 Google Test 库的相同编译器标志来编译他的测试；否则他可能会遇到未定义的行为。如果您使用不同的编译器标志编译 Google Test 和您的测试代码，他们可能会看到同一类/函数/变量的不同定义）”。这意味着您实际上需要（在我的情况下）在*每个模块*`ExternalProject_Add`中运行一个命令，因为每个模块都包含自己的测试。

# excel - Excel CSV 单元格解释

> ID：11346757
> 
> 赞同：0
> 
> 时间：2012-07-05T14:45:44.597
> 
> 标签：excel, csv

我有一个这样的 CSV 文件：

```
"Foo","Bar","16/5" 
```

用 Excel 打开它，它决定这`"16/5"`是一个日期并显示 5 月 16 日，但我只是希望它在加载 CSV 时逐字显示字符串，而无需在 Excel 中执行任何其他操作，我不知道如何实现这一点除非我在字符串的开头放了一些空格，但这很讨厌。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T18:29:00.457

使用文本导入向导 - 您可以根据需要为每一列分配特定的数据类型。

[http://office.microsoft.com/en-us/excel-help/text-import-wizard-HP010102244.aspx](http://office.microsoft.com/en-us/excel-help/text-import-wizard-HP010102244.aspx)

# makefile - 如何打印生成文件中的值

> ID：11346758
> 
> 赞同：0
> 
> 时间：2012-07-05T14:45:49.573
> 
> 标签：makefile, gnu-make

我有一个要调试的 make 文件。我有一个如下构造：

```
ifeq ($(CC_VER),4.3)
error "I am here"
AR             = ar6x qwe
CSL_LIBDIR     = $(CC_DIR)\lib
CSL_INCDIR     = $(CC_DIR)\include
else
    error "Please check that commands and include/lib path are correct for your version of CC  compiler"
endif 
```

但它不起作用。从设置 CC_Ver 的批处理文件运行此 makefile，如下所示：

```
set CC_VER= 4.3 
```

我想找到一种打印出 CC_Ver 的方法，以便找出 if 不起作用的原因。

另外我怎样才能产生错误？错误“消息”不起作用。

我正在使用 Gmake。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T20:22:20.157

您可以将`$(error text...)`构造用于错误。它会生成一个致命错误，其中消息`text`如下：

```
$(error Please check that commands and include/lib path are correct for your version of CC  compiler) 
```

同样，您可以将`$(info text...)`构造用于信息目的，如

```
$(info CC_VER has the value "$(CC_VER)") 
```

有关文档，请参阅[控制 Make 的函数。](http://www.gnu.org/software/make/manual/make.html#Make-Control-Functions)

如果您只是想快速检查变量的值，您还可以使用`-p`or`--print-data-base`选项来`make`打印*所有*规则和变量值。

该`if`语句失败，因为命令中的`=`and之间有空格。该空间保留在您的变量值中，因此不等于，而是`4.3``set CC_VER``$(CC_VER)``4.3``<space>4.3`

# java - Object 类中的 clone() 实现

> ID：11346759
> 
> 赞同：3
> 
> 时间：2012-07-05T14:45:51.427
> 
> 标签：java, clone

我正在阅读[这篇](http://www.artima.com/intv/bloch13.html)文章，它说

> `Object`的`clone`方法非常棘手。它基于现场副本，并且是“语言外的”。它创建一个对象而不调用构造函数”。

我在[grep 代码](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/Object.java#212)中看到的是以下行：

```
protected native Object clone() throws CloneNotSupportedException; 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T14:48:35.643

您缺少`native`这意味着它是在非 Java 代码中实现的（在这种情况下，它是在 JVM 本身中实现的）。

那是因为`clone` *不能*在 Java 代码中实现的确切功能（这使得它很成问题）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T14:48:12.117

`native`关键字表示实现是本机（非Java）代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-05T14:48:32.177

首先，为了更好地**理解**背后的概念，`clone`我推荐这个问题的答案：[如何正确覆盖克隆方法？](https://stackoverflow.com/questions/2326758/how-to-properly-override-clone-method)

关于您提出的问题的源代码：

`native`这里的意思是，这是一种方法，它不是用 Java 实现的，而是用另一种语言实现的，通常是 C 或 C++。它仍然是 JVM 的一部分，因此您可以在[OpenJDK™ Source Release](http://download.java.net/openjdk/jdk7/)中找到实际实现

```
"openjdk/hotspot/src/share/vm/prims/jvm.cpp":539

JVM_ENTRY(jobject, JVM_Clone(JNIEnv* env, jobject handle))
  JVMWrapper("JVM_Clone");
  Handle obj(THREAD, JNIHandles::resolve_non_null(handle));
  const KlassHandle klass (THREAD, obj->klass());
  JvmtiVMObjectAllocEventCollector oam;
  .
  .
  .
JVM_END 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-05T14:48:40.973

该方法被标记为`native`，因此您看不到它的实现，因为它不在`Java`.

# c# - 使用 xslt 更改共享点列名

> ID：11346763
> 
> 赞同：1
> 
> 时间：2012-07-05T14:46:10.930
> 
> 标签：c#, xml, sharepoint, xslt, customization

我想在我的列表中更改“Item child count”的显示名称。到目前为止，我能找到的“唯一”方法是通过 xslt（不，在文档库列中找不到该特定列供我编辑），但作为这件事的初学者，我发现它有点难以掌握/采用。

我正在尝试做的一个小例子：

```
<xsl:output method="html" indent="yes"/>

<xsl:template match="ItemChildCount" mode="body" xmlns:ddwrt2="urn:frontpage:internal">
    <xsl:param name="thisNode" select="."/>
    <xsl:choose>
        <xsl:when test="$thisNode/@*[name()=current()/@name]='ItemChildCount'">
            <xsl:attribute name="displayname">Elementi</xsl:attribute>
        </xsl:when>
    </xsl:choose> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:46:00.800

如果我正确理解您的问题和后续评论，那么您找不到 ItemChildCount 的原因是因为它不是您的数据视图 Web 部件或数据表单 Web 部件中的数据字段。

如果您编辑 DVWP/DFWP 的源，您应该会看到一个元素。如果您没有看到列出的属性，您可以通过附加来添加它`;@ItemChildCount,Item Child Count`。完成此操作后，此属性将可供您使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T14:26:46.417

了解如何更改列名。用共享点设计器打开视图完全可以更改列的名称。xsl 代码将自动添加到页面中。

# javascript - javascript nextsibling 函数

> ID：11346765
> 
> 赞同：7
> 
> 时间：2012-07-05T14:46:24.653
> 
> 标签：javascript, html, parent, nextsibling

```
<html>
<body>
<script language="JavaScript">
function function1() {
   var m = document.getElementById("myNodeOne").nextSibling;
   m.innerHTML = "asdfsdf";
}
</script>
<p>This PARAGRAPH has two nodes, 
    <b id="myNodeOne">Node One</b>, and 
    <b id="myNodeTwo">Node Two</b>.
</p>
<p></p>
<button onclick="function1();">Node One has a Next Sibling</button>
</body>
</html> 
```

这应该在第二段标签中打印“asdfsdf”。但它不起作用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-06-01T07:31:49.467

尝试使用`nextElementSibling`而不是`nextSibling`

```
function function1() {
var m = document.getElementById("myNodeOne").nextElementSibling;
m.innerHTML = "asdfsdf";
} 
```

它之所以有效，是因为它只获取 HTML 元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T14:56:38.710

几个问题：

*   如果存储在变量 ma DOM 元素中，然后设置任何 m 属性，则 DOM 根本不会受到影响。
*   document.getElementById("myNodeOne").nextSibling 不是 myNode2，而是`, and`两个节点之间的文本元素。

尝试这个：

```
function function1() {
   document.getElementById("myNodeOne").parentNode.nextSibling.nextSibling.innerHTML = "asdfsdf";
}​ 
```

[演示](http://jsfiddle.net/dCL8C/5/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T15:02:15.680

**nextSibling** 返回紧跟**该**节点的节点。如果没有这样的节点，则返回 null。

由于紧随其后的节点是 TEXT_NODE，因此它会返回该节点。以下是所有节点类型：

```
Node.ELEMENT_NODE == 1
Node.ATTRIBUTE_NODE == 2
Node.TEXT_NODE == 3
Node.CDATA_SECTION_NODE == 4
Node.ENTITY_REFERENCE_NODE == 5
Node.ENTITY_NODE == 6
Node.PROCESSING_INSTRUCTION_NODE == 7
Node.COMMENT_NODE == 8
Node.DOCUMENT_NODE == 9
Node.DOCUMENT_TYPE_NODE == 10
Node.DOCUMENT_FRAGMENT_NODE == 11
Node.NOTATION_NODE == 12 
```

以下是如何按节点类型过滤的示例：

```
function function1() {
   var m = document.getElementById("myNodeOne").nextSibling;

  if (m.nodeType != 1) {
    m = m.nextSibling;
  }
   m.innerHTML = "asdfsdf";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T14:50:49.507

这是因为你的第一个 div 的下一个兄弟是文本节点：`, and`

文本节点没有`innerHTML`属性

你需要使用：

```
document.getElementById("myNodeOne").nextSibling.nextSibling 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-05T14:50:49.727

您必须考虑`<b>...</b>`标签之间存在的文本，并正确返回为第一个标签的 nextSibling

```
function function1() {
   var m = document.getElementById("myNodeOne");
   m.nextSibling.nextSibling.innerHTML = "asdfsdf";
} 
```

​</p>

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-05T14:52:31.883

看起来你的 myNodeOne 的下一个兄弟是“，并且”如果你想进入下一个，你必须输入：

```
var m = document.getElementById("myNodeOne").nextSibling;
    m.nextSibling.innerHTML= "asdfsdf"; 
```

# git - 将带有子模块的 git 存储库转换为 Mercurial？

> ID：11346772
> 
> 赞同：1
> 
> 时间：2012-07-05T14:46:48.697
> 
> 标签：git, mercurial, mercurial-convert

看起来“hg convert”[目前不支持](http://bz.selenic.com/show_bug.cgi?id=3528)git 子模块。

我想创建一个 git 存储库的私有分支，进行大量更改，然后将它们回馈。我更喜欢每天使用 Mercurial，这就是我尝试首先转换存储库的原因。谁能想到我可以用来解决这个不受支持的功能的解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T04:18:18.067

Mercurial 支持 git 子模块，因此您可以只转换“父”存储库并将孩子/家属保留为 git。如果这不能从您的现场删除足够的 git，您可以使用 hg convert 分别转换每个子模块，然后是父模块，然后将它们链接为 Mercurial 子存​​储库。在该过程中可能会丢失对父级中跟踪的子存储库的更改，但您不会丢失任何实际的文件更改历史记录。

# java - Quartz 2.x Trigger

> ID：11346775
> 
> 赞同：0
> 
> 时间：2012-07-05T14:46:55.113
> 
> 标签：java, cron, quartz-scheduler

I need a cron trigger to fire daily starting at 22:00 every minute until 23:00\. Could someone please give me the cron expression for it.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:01:37.020

from the official doc at [http://quartz-scheduler.org/documentation/quartz-2.x/tutorials/crontrigger](http://quartz-scheduler.org/documentation/quartz-2.x/tutorials/crontrigger) :

> 0 * 14 * * ? Fire every minute starting at 2pm and ending at 2:59pm, every day

# numpy - NumPy 数组显示中的 3 个点和一个逗号

> ID：11346776
> 
> 赞同：13
> 
> 时间：2012-07-05T14:46:56.060
> 
> 标签：numpy

当我得到这个时，我正在用 Python 打印一个值列表：

```
[ 0.00020885  0.00021386  0.0002141  ...,  0.0501399   0.12051606
  0.12359095] 
```

这里有什么问题？该列表的大小至少应为 20。显示为 的元素发生了什么`...`？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-05T14:50:00.757

问题是您打印的不是 Python 列表，而是 NumPy 数组。NumPy 输出可以使用[`numpy.set_printoptions()`](http://docs.scipy.org/doc/numpy-1.6.0/reference/generated/numpy.set_printoptions.html#numpy.set_printoptions).

数据类型很重要。如果你想知道某个对象的行为，首先检查它的类型。

# javascript - 用对象填充的外键

> ID：11346777
> 
> 赞同：9
> 
> 时间：2012-07-05T14:47:03.627
> 
> 标签：javascript, backbone.js, backbone-relational

我想使用骨干关系在两个模型 User 和 Task 之间建立关系。

两种模型之间的关系如下：

```
taskModel.creator_id = userModel.id 
```

* * *

```
// TaskModel
var TaskModel = Backbone.RelationalModel.extend({

    relations: [
        {
            type: Backbone.HasOne,
            key: 'creator',
            keySource: 'creator_id',
            relatedModel: Users
        }
    ],

    // some code
}); 
```

* * *

```
// Task collection
var TaskCollection = Backbone.Collection.extend({

    model: TaskModel,

    // some code

}); 
```

* * *

```
// User Model
var User = Backbone.RelationalModel.extend({
    // some code
}); 
```

* * *

**实际上问题出在 collection.models 中，请参阅附图**：

请检查这个jsfiddle：http: [//jsfiddle.net/2bsE9/5/](http://jsfiddle.net/2bsE9/5/)

```
var user = new User(),
    task = new Task(),
    tasks = new Tasks();

task.fetch();
user.fetch();
tasks.fetch();

console.log(user.attributes, task.attributes, tasks.models); 
```

![在此处输入图像描述](../Images/01472432c8d62ef7d9b3a7aadd322043.png)

PS：

实际上我正在使用 requireJs 来获取`UserModel`，所以我不能在相关模型值中包含引号。

```
define([
    'models/user',
    'backbone',
    'relationalModel'
], function (User) {
    "use strict";

    var Task = Backbone.RelationalModel.extend({
        relations: [
            {
                type: Backbone.HasOne,
                key: 'creator',
                keySource: 'creator_id',
                relatedModel: User
            }
        ],
    });
); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T13:01:33.480

**编辑2：**

[http://jsfiddle.net/2bsE9/13/](http://jsfiddle.net/2bsE9/13/)

我更新了 jsfiddle 以反映我在下面建议的更改。只要您在任务上调用 toJSON，到达服务器的就是一个 json 对象，其`creator_id`属性设置为`id`用户的实际值。这里`keyDestination`是多余的，因为文档指出如果您使用它会自动设置`keySource`。

**编辑：**

[https://github.com/PaulUithol/Backbone-relational#keysource](https://github.com/PaulUithol/Backbone-relational#keysource)

[https://github.com/PaulUithol/Backbone-relational#keydestination](https://github.com/PaulUithol/Backbone-relational#keydestination)

[https://github.com/PaulUithol/Backbone-relational#includeinjson](https://github.com/PaulUithol/Backbone-relational#includeinjson)

以上三者的结合可能会解决您的问题。

```
var Task = Backbone.RelationalModel.extend({
    relations: [
        {
            type: Backbone.HasOne,
            // The User object can be accessed under the property 'creator'
            key: 'creator',
            // The User object will be fetched using the value supplied under the property 'creator_id'
            keySource: 'creator_id',
            // The User object will be serialized to the property 'creator_id'
            keyDestination: 'creator_id',
            // Only the '_id' property of the User object will be serialized
            includeInJSON: Backbone.Model.prototype.idAttribute,

            relatedModel: User
        }
    ],
}); 
```

该文档还指出您的代码指定`keySource`或`keyDestination`不应使用的属性。该属性不能作为属性访问。

如果可以解决您的问题，请尝试此操作并发表评论。

顺便说一句，这是一篇不错的博客文章，它使用骨干关系端到端。 [http://antoviaque.org/docs/tutorials/backbone-relational-tutorial/](http://antoviaque.org/docs/tutorials/backbone-relational-tutorial/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T05:12:40.290

**编辑**

[更新了 jsfiddle](http://jsfiddle.net/2bsE9/15/)

问题是 Backbone-Relational 显式删除了 keySource 以“防止泄漏抽象”。它`unset`在 Backbone-Relational 中对属性进行了硬编码调用：

```
// Explicitly clear 'keySource', to prevent a leaky abstraction if 'keySource' differs from 'key'.
if ( this.key !== this.keySource ) {
    this.instance.unset( this.keySource, { silent: true } );
} 
```

您将需要覆盖`Task`模型中的 unset 方法：

```
var Task = Backbone.RelationalModel.extend({
    urlRoot: ' ',

    relations: [
        {
            type: Backbone.HasOne,
            key: 'creator',
            relatedModel: User,
            keySource: 'creator_id'
        }
    ],

    unset: function(attr, options) {
        if (attr == 'creator_id') {
          return false;
        }

        // Original unset from Backbone.Model:
        (options || (options = {})).unset = true;
        return this.set(attr, null, options);
     },

    sync: function (method, model, options) {
        options.success({
            id: 1,
            name: 'barTask',
            creator_id: 1
        });
    }
}); 
```

`Backbone.Model.unset`这种方法的明显问题是，如果 Backbone 更改其方法或 Backbone-Relational 更改其`keySource`行为，您将需要修改代码。

# mongoose - Mongoose Populate - 效率

> ID：11346779
> 
> 赞同：1
> 
> 时间：2012-07-05T14:47:09.743
> 
> 标签：mongoose

我有一个 Product 模型，它引用了 Category 模型，下面的代码工作正常，但想知道这是否是最好的方法。

```
server.get "/:id/edit", (req, res) ->
    Category.find({})
    .sort("position", 1)
    .exec (err, categories) ->
      if not err
        Product.findOne({_id: req.params.id })
        .populate("categories")
        .exec (err, data) ->
          if err
            res.json err
          else
            res.render "#{view_path}/products/edit",
              title: "Edit Product"
              user: req.session.user
              product: data
              categories: categories 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T18:59:47.090

使用填充的有用程度在很大程度上取决于您的`Category`模型的复杂程度以及您在`Product`模型相关页面上使用它的目的。

一般来说，类别是嵌入产品的一个很好的例子，因为它们不会经常改变，并且会一直与产品一起被拉动。

你可能会觉得[这个问题](https://stackoverflow.com/questions/7970082/mongoose-populate-dbref-or-data-duplication)很有趣。关于引用或嵌入的用例，总是有很多持续的讨论。

# c# - 在同一个应用程序池中运行的站点是否有单独的工作进程？

> ID：11346784
> 
> 赞同：1
> 
> 时间：2012-07-05T14:47:24.163
> 
> 标签：c#, asp.net, iis-7.5

我在应用程序池下运行了四个应用程序（A、B、C 和 D）`Pool1`。该池中的所有应用程序会在单独的工作进程下运行吗？所有应用程序都会运行单独的实例`w3wp.exe`吗？他们都会有自己的独立`APPDomain`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:56:23.030

我的理解是，每个应用程序池都将运行它自己的工作进程，因此同一个应用程序池中的网站 A、B、C 和 D 将共享一个工作进程。在单个工作进程中，每个网站都将在其自己的 AppDomain 中运行。

这里有一个很好的描述：[应用程序域和应用程序池之间的区别？](https://stackoverflow.com/questions/8486335/difference-between-an-application-domain-and-an-application-pool)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T16:23:36.133

是的，每个具有多个 Web 应用程序的应用程序池仅运行一个工作进程。

进程浏览器工具将有助于检查工作进程。

在同一应用程序池中通过 IE 或任何其他浏览器托管应用程序时，会在 svchost.exe 下添加一个新的工作进程。

这是下载工具的链接

[进程浏览器](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)

# android - Android中的HTTP发布请求

> ID：11346788
> 
> 赞同：0
> 
> 时间：2012-07-05T14:47:38.307
> 
> 标签：android, cookies, service, http-post

我是安卓新手。我正在尝试 http 发布请求，但连接失败。下面是给定的代码

```
private void postRequest(String givenUsername, String givenPassword) {

        String paramUsername = givenUsername;
        String paramPassword = givenPassword;

        System.out.println("*** doInBackground ** paramUsername " + paramUsername + " paramPassword :" + paramPassword);

        HttpClient httpClient = new DefaultHttpClient();

        // In a POST request, we don't pass the values in the URL.
        // Therefore we use only the web page URL as the parameter of the HttpPost argument
        HttpPost httpPost = new HttpPost("url");
        httpPost.addHeader("Content-Length", "40");
        httpPost.addHeader("Accept", "application/json,text/javascript, */*");
        httpPost.addHeader("Content-Type", "application/x-www-form-urlencoded");
        // httpPost.s

        // Because we are not passing values over the URL, we should have a mechanism to pass the
        // values that can be
        // uniquely separate by the other end.
        // To achieve that we use BasicNameValuePair
        // Things we need to pass with the POST request
        BasicNameValuePair usernameBasicNameValuePair = new BasicNameValuePair("username", paramUsername);
        BasicNameValuePair passwordBasicNameValuePAir = new BasicNameValuePair("password", paramPassword);

        // We add the content that we want to pass with the POST request to as name-value pairs
        // Now we put those sending details to an ArrayList with type safe of NameValuePair
        List<NameValuePair> nameValuePairList = new ArrayList<NameValuePair>();
        nameValuePairList.add(usernameBasicNameValuePair);
        nameValuePairList.add(passwordBasicNameValuePAir);

        try {
            // UrlEncodedFormEntity is an entity composed of a list of url-encoded pairs.
            // This is typically useful while sending an HTTP POST request.
            UrlEncodedFormEntity urlEncodedFormEntity = new UrlEncodedFormEntity(nameValuePairList);

            // setEntity() hands the entity (here it is urlEncodedFormEntity) to the request.
            httpPost.setEntity(urlEncodedFormEntity);

            try {
                // HttpResponse is an interface just like HttpPost.
                // Therefore we can't initialize them
                HttpResponse httpResponse = httpClient.execute(httpPost);

                HttpEntity resEntity = httpResponse.getEntity();
                if (resEntity != null) {
                    Log.i("RESPONSE", EntityUtils.toString(resEntity));
                }

                // According to the JAVA API, InputStream constructor do nothing.
                // So we can't initialize InputStream although it is not an interface
                InputStream inputStream = httpResponse.getEntity().getContent();

                InputStreamReader inputStreamReader = new InputStreamReader(inputStream);

                BufferedReader bufferedReader = new BufferedReader(inputStreamReader);

                StringBuilder stringBuilder = new StringBuilder();

                String bufferedStrChunk = null;

                while ((bufferedStrChunk = bufferedReader.readLine()) != null) {
                    stringBuilder.append(bufferedStrChunk);
                }

                System.out.println("Initial set of cookies:");
                List<Cookie> cookies = ((AbstractHttpClient) httpClient).getCookieStore().getCookies();
                if (cookies.isEmpty()) {
                    System.out.println("None");
                } else {
                    for (int i = 0; i < cookies.size(); i++) {
                        System.out.println("- " + cookies.get(i).toString());
                    }
                }

                System.out.println("Post logon cookies:");
                cookies = ((AbstractHttpClient) httpClient).getCookieStore().getCookies();
                if (cookies.isEmpty()) {
                    System.out.println("None");
                } else {
                    for (int i = 0; i < cookies.size(); i++) {
                        System.out.println("- " + cookies.get(i).toString());
                    }
                }

            } catch (ClientProtocolException cpe) {
                System.out.println("First Exception caz of HttpResponese :" + cpe);
                cpe.printStackTrace();
            } catch (IOException ioe) {
                System.out.println("Second Exception caz of HttpResponse :" + ioe);
                ioe.printStackTrace();
            }

        } catch (UnsupportedEncodingException uee) {
            System.out.println("An Exception given because of UrlEncodedFormEntity argument :" + uee);
            uee.printStackTrace();
        }
    } 
```

我正在为我的登录屏幕发送用户名和密码。它会返回一个 cookie。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:53:46.353

In the following line

```
HttpPost httpPost = new HttpPost("url"); 
```

Replace the `url` with your url

Edit: Here is how I pass my url's:

```
String url_select = "http://www.yoururlgoeshere.com"
HttpPost httpPost = new HttpPost(url_select); 
```

Also, since I am on API Level 3.0+ I have to use HTTP Post using `AsyncTask`. Here is a [tutorial link](http://ugirusgiarto.wordpress.com/2011/10/27/json-php-mysql-with-asynctask-progressdialog/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:58:20.337

此方法适用于每个请求。“POST”以字符串形式给出。

```
 * Sends generic HTTP calls: GET, POST, DELETE etc provided the parameters. Also includes the
 * response body in the returned object.
 */

private WebCallResponse sendRequest(String url, WebCallHeader[] headers,
        String method, byte[] postBytes) throws WebServiceException
        {
    HttpURLConnection conn = null;
    URL serverUrl = null;
    OutputStream os = null;
    InputStream is = null;

    try
    {
        serverUrl = new URL(url);
        conn = (HttpURLConnection)serverUrl.openConnection();   
        conn.setRequestMethod(method);
        conn.setRequestProperty("Accept-Encoding", "deflated");
        conn.setRequestProperty("Accept-Ranges", "bytes");

        if(headers != null && headers.length > 0)
        {
            for(int i = 0; i < headers.length; ++i)
            {
                conn.setRequestProperty(headers[i].getHeaderName(), headers[i].getHeaderValue());
            }
        }

        //-- For POSTs and PUTs
        if(postBytes != null && postBytes.length > 0)
        {
            conn.setDoOutput(true); 
            conn.setRequestProperty("Content-Length", String.valueOf(postBytes.length));
            conn.connect();
            os = conn.getOutputStream();
            os.write(postBytes);
        }

        //-- Execute happens here.
        final int rc = conn.getResponseCode();

        //-- Build return object from the response.
        final WebCallResponse wcr = new WebCallResponse();
        wcr.setStatusCode(rc);  

        if (conn.getHeaderField("record-count") != null)
        {
            final Vector headerVector = new Vector();
            headerVector.add(conn.getHeaderField("record-count"));
            wcr.setHeaders(headerVector);
        }

        is = new BufferedInputStream(conn.getInputStream());
        wcr.setResponseString(this.getResponseBody(is));

        return wcr;
    } catch(IOException ioe)
    {
        conn.getErrorStream();
        throw new WebServiceException(ioe, "Failed to open connection to host.");
    }finally    
    {
        try{if(is != null)is.close();}catch(Exception squish){}
        try{if(os != null)os.close();}catch(Exception squish){}
        try{if(conn != null)conn.disconnect();}catch(Exception squish){}
    }
}

public class WebCallResponse {
private int statusCode;
private String responseString;
private Vector headers;

public Vector getHeaders()
{
    return headers;
}
public void setHeaders(Vector headers)
{
    this.headers = headers;
}

public void setStatusCode(int statusCode) {
    this.statusCode = statusCode;
}

public int getStatusCode() {
    return statusCode;
}

public void setResponseString(String responseString) {
    this.responseString = responseString;
}

public String getResponseString() {
    return responseString;
}

public boolean isRequestSuccessful(){
    return (statusCode >=200 && statusCode <300);
}

public String getHeaderValue(String key)
{
    WebCallHeader currentHeader;
    String result = null;

    for (int i = 0; i < this.headers.size(); i++)
    {
        currentHeader = ((WebCallHeader) this.headers.elementAt(i));
        if (currentHeader.getHeaderName().equalsIgnoreCase(key))
        {
            result = currentHeader.getHeaderValue();
        }
    }
    return result;
}

public String toString()
{
    return this.responseString;     
} 
```

}

```
public class WebCallHeader {
private String headerName;
private String headerValue;

public WebCallHeader(String name,String value)
{
    this.headerName = name;
    this.headerValue = value;
}

public void setHeaderName(String headerName) {
    this.headerName = headerName;
}

public String getHeaderName() {
    return headerName;
}

public void setHeaderValue(String headerValue) {
    this.headerValue = headerValue;
}

public String getHeaderValue() {
    return headerValue;
} 
```

}

# java - 如何从 Java Spring MVC 3.0 Webapp 流式传输文本响应

> ID：11346789
> 
> 赞同：6
> 
> 时间：2012-07-05T14:47:40.613
> 
> 标签：java, servlets, spring-mvc

如何将文本输出流式传输到浏览器上的页面以显示可能需要大约 15 - 20 秒的操作进度？我试过直接写入输出流，但整个过程完成*后*`HttpServletResponse`用户仍然看到完整的输出。

 *这是我迄今为止尝试过的

```
 @RequestMapping(value = "/test")
 public void test(HttpServletResponse response)
            throws IOException, InterruptedException {
    response.getOutputStream().println("Hello");
    response.getOutputStream().flush();
    Thread.sleep(2000);
    response.getOutputStream().println("How");
    response.getOutputStream().flush();
    Thread.sleep(2000);
    response.getOutputStream().println("are");
    response.getOutputStream().flush();
    Thread.sleep(2000);
    response.getOutputStream().println("you");
    response.getOutputStream().flush();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T17:01:12.467

我不是 Spring MVC 专家，但我认为您会执行类似发送“已接受”的 202 响应代码之类的操作，这表明服务器已收到请求并将进行一些异步处理。通常，服务器会提供一个 URL 以允许客户端发出有关操作状态的请求。您尝试做的事情违反了服务器/客户端关系的通常工作方式。客户端调用服务器，服务器响应然后关闭连接。您在什么情况下尝试这样做，出于什么原因？也许我可以提供更多见解或考虑另一种方法？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T09:12:57.860

尝试使用：

```
response.flushBuffer(); 
```

正如 JavaDoc 所说：

> 强制将缓冲区中的任何内容写入客户端。调用此方法会自动提交响应，这意味着将写入状态代码和标头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-06T13:02:16.100

在使用 Chrome 进行测试时，这对我有用

```
response.setBufferSize(0);
response.setContentType("text/event-stream");

... write content ... 
```

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2012-07-05T15:19:56.287

```
@Controller
public class MyController{

    @RequestMapping(value = "/test", method = RequestMethod.GET)
    public @ResponseBody String getTest() {
      return "hello how are you";
    }
} 
```

如果您使用的是 spring 控制器，则可以使用响应正文注释执行上述操作。*

# django - 将 django 应用程序移植到 GoogleAppEngine 以部署在 appspot.com 上

> ID：11346795
> 
> 赞同：0
> 
> 时间：2012-07-05T14:47:53.780
> 
> 标签：django, google-app-engine, google-cloud-sql

我想移植我`django app`的运行`GoogleAppEngine`并部署它`appspot.com`。在我的 django 应用程序中，我使用`postgres`数据库来存储用户信息，以便用户登录/注册是可能的。

我偶然发现[了这篇](https://developers.google.com/appengine/docs/python/cloud-sql/django#porting)关于`porting django to appengine`. 它提到您需要使用`Google Cloud SQL backend`. [这篇文章](https://developers.google.com/cloud-sql/docs/billing)说它是从价格`june12th`开始的。

那么，似乎我必须付费才能部署非商业应用程序？或者有什么方法可以在不使用云 sql 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:19:12.793

我是用 django-nonrel 做的，它需要一些修改，但它确实有效。[这是有关如何设置的指南。](http://www.allbuttonspressed.com/projects/django-nonrel)在它为我工作之后，我意识到 Heroku 更容易设置和维护，所以我的其他应用程序直接使用了 heroku。

# ios - Titanium Mobile - 向左/向右滑动 TableView 单元格以显示后面的另一行

> ID：11346797
> 
> 赞同：1
> 
> 时间：2012-07-05T14:47:54.590
> 
> 标签：ios, tableview, titanium-mobile

我一直在寻找如何做到这一点，但我没有成功。

我想要完成的是：我有一个 TableView，比如说 5 行。我希望能够向左滑动一行以显示该行“后面”的信息。不确定是否可以通过向 TableView 添加额外的行并将其放在后面来完成，还是什么？

归根结底，更酷的是能够向左或向右滑动该行，并且根据您滑动的方向，后面的行会填充不同的信息。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T10:10:17.997

根据您的描述，听起来您想要的东西类似于 Twitter 在您滑动推文时所做的事情。

首先，确保表格中的行没有垂直/水平布局。

然后为每一行创建你想要的左右滑动视图，如下所示：

```
var leftSwipeView = Ti.UI.createView({
  width: Ti.UI.FILL,
  height: Ti.UI.FILL,
  backgroundColor: '#ff0000', //just to make the effect apparent
  visible: false
}
var rightSwipeView = Ti.UI.createView({
  width: Ti.UI.FILL,
  height: Ti.UI.FILL,
  backgroundColor: '#00ff00', //just to make the effect apparent
  visible: false,
}
row.add(leftSwipeView);
row.add(rightSwipeView);

row.addEventListener('swipe', function(e) {
  if (e.direction == 'left'){
    leftSwipeView.setVisible(true);
    setTimeout(function(){leftSwipeView.setVisible(false);}, 2000);
  }
  if (e.direction == 'right'){
    rightSwipeView.setVisible(true);
    setTimeout(function(){rightSwipeView.setVisible(false);}, 2000);
  }
}); 
```

我在那里的片段将在 2 秒后再次隐藏视图。希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T07:14:17.990

在 Github 上找到了完美的解决方案。 [https://github.com/rborn/TiSwipeToReveal](https://github.com/rborn/TiSwipeToReveal)

# iphone - 在不显示实际视频源的情况下捕获视频

> ID：11346799
> 
> 赞同：4
> 
> 时间：2012-07-05T14:48:00.410
> 
> 标签：iphone, objective-c, ios, video, camera

所以我有一个应用程序，目前可以使用前置 iphone 摄像头捕获视频，然后对视频源进行实时处理。然而，我想要做的是让这个过程在后台运行，并将其他控件放在屏幕上。例如，假设我想运行相机并处理图像馈送，但我希望用户看到带有一些按钮的黑屏。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-05T16:16:04.297

就像我们正确理解术语一样，“在后台”是指在您的应用程序处于前台时运行相机捕获，但不显示实际的视频源。这是可能的，但我想明确一点，如果您将整个应用程序移到后台，您将无法访问相机。

有几种方法可以做到这一点，但我用得最多的一种方法是通过 AV Foundation 抓取视频（或照片）帧。使用 AVCaptureDevice 和 AVCaptureSession，您可以抓取视频帧并将它们路由到编码器以保存到磁盘或使用您自己的自定义代码进行处理。这些都不需要在屏幕上显示相机源，因此您可以放置​​您喜欢的任何界面，并在没有任何屏幕指示的情况下进行视频录制或照片捕捉。

我提醒您，您应该向您的用户明确说明您在做什么，这样您就不会冒着侵犯他人隐私的风险。Apple 不会对这样做的人做出友好的反应（有充分的理由）。

我在我的开源[GPUImage](https://github.com/BradLarson/GPUImage)视频和照片处理框架中封装了很多这些内容，因此您可以查看那里的 GPUImageVideoCamera 类的代码，以了解我如何配置捕获输入。我将视频帧交给 OpenGL ES 以应用过滤器和其他处理操作，但如果您只想进行自己的编码或处理，则可以忽略这部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:03:32.760

以下是 Apple 文档中的示例代码：http: [//developer.apple.com/library/ios/#samplecode/PhotoPicker/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/PhotoPicker/Introduction/Intro.html) 还有自定义相机界面的方法。

# html - 表格单元格内的相等垂直间距

> ID：11346801
> 
> 赞同：0
> 
> 时间：2012-07-05T14:48:02.930
> 
> 标签：html, css, html-email

我正在设计一个html电子邮件。我在顶部和底部有一张图片和 1 段。这 3 个在表格单元格中。我需要图像位于单元格的中心，并且 2 段应该与图像垂直等距。

```
<td height="200" style="vertical-align:middle;">
  <p style="vertical-align:middle;">Lorem Ipsum</p>
  <img src="pic.jpg" height="150" />
  <p style="vertical-align:middle;">Lorem Ipsum</p>
</td> 
```

现在 3 没有垂直对齐。如何让它们垂直对齐彼此之间的相等空间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:56:35.943

这样它工作正常：

```
<style>
    td {
        vertical-align:middle;
    }
</style> 
```

和 HTML：

```
<table>
    <tr>
        <td>
            <p>Lorem Ipsum</p>
        </td>
        <td>
            <img src="http://lorempixel.com/output/food-h-c-100-200-8.jpg" alt="">
        </td>
        <td>
            <p>Lorem Ipsum</p>
        </td>
    </tr>
</table> 
```

# c# - Lucene.Net 多字段多词搜索和通配符使用和短语搜索，模糊搜索全部

> ID：11346806
> 
> 赞同：6
> 
> 时间：2012-07-05T14:48:22.250
> 
> 标签：c#, lucene, lucene.net

我对 lucene.net 很陌生。我使用 lucene.net 索引多个字段的数据。这样我做了索引数据

```
 Document doc = new Document();
                    doc.Add(new Field("ID", oData.ID.ToString() + "_" + oData.Type, Field.Store.YES, Field.Index.UN_TOKENIZED));
                    doc.Add(new Field("Title", oData.Title, Field.Store.YES, Field.Index.TOKENIZED));
                    doc.Add(new Field("Description", oData.Description, Field.Store.YES, Field.Index.TOKENIZED));
                    doc.Add(new Field("Url", oData.Url, Field.Store.YES, Field.Index.TOKENIZED));
                    writer.AddDocument(doc); 
```

现在当用户搜索时，用户可以输入像 **奥迪宝马ECU这样的数据**

1）第一次我希望像**[Audi] [BMW] [ECU]**这样的每个单词都应该搜索我索引的字段，例如 title,description,url 。每个单词都应针对名为**title,description,url**的 3 个字段进行搜索。所以我需要做什么。我需要写什么代码。

2) 第二次“ **Audi BMW ECU** ”应该是针对**标题、描述、url**字段进行搜索。

*3) 用户在搜索Audi BMW ECU* * 或Audi BMW ECU时可以使用输入通配符**吗？** 4）我想添加模糊搜索以及多词搜索，所以如果用户拼写错误，结果也会出现。

请指导我如何在我的代码和例程中整合所有逻辑和功能，因为我得到了各种用户输入的结果。

如果可能的话，详细讨论这个问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-22T18:13:38.447

您可以使用`QueryParser`该类将用户提供的查询解析为 Lucene`Query`对象树。还有一个`MultiFieldQueryParser`将生成搜索多个字段的查询。这符合您的要求。

```
var fields = new[] { "Title", "Description", "Url" };
var analyzer = new StandardAnalyzer(Version.LUCENE_30);
var queryParser = new MultiFieldQueryParser(Version.LUCENE_30, fields, analyzer);
var query = queryParser.Parse("Audi BMW ECU"); 
```

生成的查询看起来像`(Title:audi Description:audi Url:audi) (Title:bmw Description:bmw Url:bmw) (Title:ecu Description:ecu Url:ecu)`.

您可以让用户通过用引号将短语括起来来构建短语查询。这是 Lucene 中的标准查询格式。

```
var fields = new[] { "Title", "Description", "Url" };
var analyzer = new StandardAnalyzer(Version.LUCENE_30);
var queryParser = new MultiFieldQueryParser(Version.LUCENE_30, fields, analyzer);
var query = queryParser.Parse("\"Audi BMW ECU\""); 
```

这个生成的查询看起来像`Title:"audi bmw ecu" Description:"audi bmw ecu" Url:"audi bmw ecu"`。

QueryParser 还支持根据需要使用`*`和`?`的通配符查询。还支持模糊搜索；“奥迪~0.5”。还有其他几种查询类型可用，例如邻近搜索和词条提升。[查询解析器语法](http://lucene.apache.org/core/3_6_1/queryparsersyntax.html)文档中提供了所有内容。

添加功能以帮助用户使用拼写错误的单词是一项更大的任务。您可以将查询重写为模糊搜索，但这会禁用任何启用的分析器（因此您拥有的任何词干）。您还可以通过将查询重写为具有更多匹配项的类似查询来尝试不同的“你是不是故意的”解决方案。这里有很多实验。

# java - 分析java进程的线程转储

> ID：11346807
> 
> 赞同：13
> 
> 时间：2012-07-05T14:48:25.130
> 
> 标签：java, java-ee-6, thread-dump

我在 tomcat 上运行基于 Java EE 的应用程序，我发现应用程序在运行几个小时后突然挂起。

我在应用程序挂起之前从应用程序中收集了线程转储，并将其放入 TDA 进行分析：

![在此处输入图像描述](../Images/4dff3bbfe30773d9a2f6f80ca8479465.png)

[TDA](https://java.net/projects/tda)（线程转储分析器）为上述监视器提供以下消息：

```
A lot of threads are waiting for this monitor to become available again.
This might indicate a congestion. You also should analyze other locks 
blocked by threads waiting for this monitor as there might be much more 
threads waiting for it. 
```

这是上面突出显示的线程的堆栈跟踪：

```
"MY_THREAD" prio=10 tid=0x00007f97f1918800 nid=0x776a 
             waiting for monitor entry [0x00007f9819560000]
   java.lang.Thread.State: BLOCKED (on object monitor)
    at java.util.Hashtable.get(Hashtable.java:356)
    - locked <0x0000000680038b68> (a java.util.Properties)
    at java.util.Properties.getProperty(Properties.java:951)
    at java.lang.System.getProperty(System.java:709)
    at com.MyClass.myMethod(MyClass.java:344) 
```

我想知道`"waiting for monitor entry"`状态是什么意思？并且也将不胜感激任何指针来帮助我调试这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T14:57:38.940

您的一个线程获取了一个监视器对象（对象上的独占锁）。这意味着线程正在执行同步代码，并且由于某种原因卡在那里，可能正在等待其他线程。但是其他线程无法继续执行，因为它们遇到了一个同步块并请求了一个锁（监控对象），但是直到它被其他线程释放后他们才能获得它。所以......可能是僵局。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T15:27:55.410

请从整个线程转储中查找此字符串

*- 锁定 <0x00007f9819560000>*

如果你能找到它，线程死锁与线程“tid=0x00007f97f1918800”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:55:05.290

这意味着您的线程正在尝试设置锁（在哈希表上），但其他一些线程已经在访问它并设置了锁。所以它正在等待锁释放。检查您的其他线程在做什么。特别是 tid="0x00007f9819560000" 的线程

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T14:51:00.730

监视器 = 同步。你有很多线程试图获取同一个对象的锁。

也许你应该从使用 Hashtable 切换到使用 HashMap

# mysql - 仅选择其他表中的行数大于 0 的行

> ID：11346809
> 
> 赞同：0
> 
> 时间：2012-07-05T14:48:31.303
> 
> 标签：mysql

我的数据库中有 2 个表：

```
Products:
--------------------------------------------------
|   id    |   product_name    |   manufacturer   |
--------------------------------------------------

Products_photos:
-----------------------------------------------
|   id    |   product_id    |   image_name    |
----------------------------------------------- 
```

我想选择所有产品，其中 Product_photos 计数大于 0。我该怎么做？

@Edit：我不想为我的输出添加 Products_photos 的结果。我只想显示产品中的条目，其中有任何图像。对不起我的英语不好 ：）

感谢帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:52:13.147

```
SELECT P.* FROM Products AS P INNER JOIN Products_Photos AS PP ON P.id=PP.id 
```

另一种方法，效率更低，但可能更便于您理解，将是

```
SELECT P.* FROM Products AS P
WHERE P.id IN (SELECT DISTINCT id FROM Product_photos) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:53:34.817

```
SELECT p.id, p.product_name, p.manufacturer
FROM Products p
     INNER JOIN Products_photos i on i.product_id = p.id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T17:31:29.113

你可以做

```
Select P.id, P.product_name, P.manufacturer
from Products P 
INNER JOIN Products_photos Pp on P.Id = Pp.product_id 
```

对于内连接，它只会返回可以连接的行，这意味着您在`Products_photos` 表中至少有一个值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T17:39:38.037

我认为就查询效率而言，已经提供的加入解决方案是最好的选择。但为了清楚起见——就准确表达你的要求而言——我会选择这样的方法：

```
select * from products p
where exists (select * from products_photos pp where pp.product_id = p.id) 
```

# c# - 返回会话对象的函数 - 可以吗？

> ID：11346814
> 
> 赞同：1
> 
> 时间：2012-07-05T14:48:40.197
> 
> 标签：c#, .net, session

假设我想构建一个应用程序来连接到服务器并上传、删除……文件。

起初我需要以某种方式连接，我需要一个会话。我可以构建一个返回会话的函数，然后我可以对这个会话对象做任何我想做的事情吗？就像是：

```
mySession connect(url, user, password)
{
  //connecting
  return session;
}

void uploadFile(File f) {/*...*/};

var currentSession = connect(/*...*/);

currentSession.uploadFile(...);
currentSession.deletFile(...);
currentSession.close(...); 
```

这能好吗？如果我有一个会话对象，我可以到处传递它并说`.upload`, `.delete`, `.whatever`.

你如何看待这些功能`void uploadFile()`- 也许我应该改变 void？因为上传后我怎么知道它是成功的？也许布尔值更好？（如果我是真的，我知道它是成功的，如果是假的它不是）。有任何想法吗？;） 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:55:43.067

我之前的经验是将数据库会话包装为 IDisposable，因此消费者总是会通过以下方式请求数据库会话：

```
using(var session = Database.CreateSession())
{ 
    session.uploadFile(); 
    session.deleteFile();
} 
```

然后在包装会话的`Dispose`方法中，它将刷新并关闭连接并处理任何必要的事情。通过这种方式，我（通常）确保连接已关闭并被处理；至少如果开发人员/我自己正确使用它。

至于你的第二个问题，你`uploadFile`可以在成功时返回真/假或抛出异常。如果您希望它经常因正当原因而失败，那么 true/false 可能会更好。您还可以让它返回一个`UploadResults`对象，该对象具有布尔通过/失败属性以及失败的原因/异常。

```
public class MySession
{
    public UploadResults UploadFile()
    {
        try
        {
            //try upload

            return UploadResults.Succeeded();
        }
        catch (Exception ex)
        {
            return UploadResults.Failed(ex);
        }
    }
}

public class UploadResults
{
    public bool Success { get; private set; }
    public Exception FailureReason { get; private set; }

    private UploadResults(bool success, Exception failureReason)
    {
        this.Success = success;
        this.FailureReason = failureReason;
    }

    internal static UploadResults Succeeded()
    {
        return new UploadResults(true, null);
    }

    internal static UploadResults Failed(Exception failureReason)
    {
        return new UploadResults(false, failureReason);
    }
} 
```

那么您的代码可能如下所示：

```
using(var session = Database.CreateSession())
{ 
    var results = session.uploadFile();
    if (results.Success)
        session.deleteFile();
    else
        ReportError(results.FailureReason);
} 
```

但这只是一个样本；您可以随意使用该设计，因为它适合您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:06:02.910

就传递你的会话对象而言，我看不出你为什么不能，只要它是一个引用类型（除非它有一些我不知道的问题）。但如果我是你，我会尝试让一个实例在调试器中运行，试一试，然后看看会发生什么。

至于`void uploadFile()`实施取决于你。根据我的经验，大多数`doSomething`函数在失败时都会抛出异常，所以我会这样做。此外，如果您的函数失败，则可能是因为某些内部函数引发了异常，所以我可能会让该异常冒泡。

# ember.js - 忽略 EmberJS 数据中更改的记录

> ID：11346815
> 
> 赞同：0
> 
> 时间：2012-07-05T14:48:39.883
> 
> 标签：ember.js, ember-data

您如何忽略您在 EmberJS 视图中使用 Ember Data 更改的记录？像删除这样的东西，实际上没有从持久存储中删除它。

我以为`App.store.removeFromRecordArrays(record);`会奏效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T08:05:10.657

如果此模型存在这种情况（删除客户端但不删除服务器端），您可以使用标志扩展 DS.Model。此外，还有一种方法可以方便地设置此状态（调用 model.deleteLocal()）。

```
DS.Model.reopen({
    deleteLocalFlag: false,
    deleteLocal: function () {
        this.set('deleteLocalFlag',true); 
        this.deleteRecord();
    }
}); 
```

然后你需要在你的适配器中自定义 deleteRecords 方法。

```
DS.YourAdapter.reopen({
      deleteRecord: function(store, type, model) {
          if (!model.get('deleteLocalFlag') {
              // code for deleting in persitence layer
          } 
          store.didDeleteRecord(model, model.toJSON({associations: true}));
      }
}); 
```

警告：此代码未经测试，但在我脑海中有效；）

可能是更清洁的解决方案是使用对象的 stateManager 并转换到不同的状态而不是设置标志。但我发现 stateManager 周围的代码很难理解，可能不值得麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T19:21:45.630

1）您可以使用交易并回滚交易。

2）或者您可以使用它的状态管理器回滚记录。

```
if(record.isDirty)
  record.get('transaction').rollback(); 
```

例如，您可以循环存储 recordCache 中的所有记录并回滚所有脏记录。

我个人在视图中的 willDestroyElement 事件上使用了记录回滚机制，所以如果用户离开视图，他会被要求保存脏记录。

```
PatientTransport.FirmView = Ember.View.extend({
  templateName: 'firm-view',

  willDestroyElement: function() {
    if (this.getPath('controller.content.isDirty')) {
      var self = this;
      Bootstrap.ConfirmBox.popup({
        heading: "Some data has changed.",
        message: "Do you want to save changes?",
        callback: function(options, event) {
          if (options.primary) {
            self.getPath('controller.content.transaction').commit();
          } else {
            self.getPath('controller.content.transaction').rollback();
          }             
        }
      });   
    }     
  }
}); 
```

# php - 仅当 json 对象包含图像时，我将如何回显幻灯片？

> ID：11346819
> 
> 赞同：0
> 
> 时间：2012-07-05T14:48:49.327
> 
> 标签：php, json, loops

### 我的问题：

仅当 json 对象包含图像时，我将如何回显幻灯片？

### 我的问题：

我不确定应该如何处理 json 对象的 for 循环以仅在幻灯片包含图像时才回显幻灯片。

### 客观的：

我希望仅当 json 对象中有图像时才能回显 div，然后在图像周围回显链接，以便我可以链接到故事。

### 额外的：

没有图像时，我怎么不能在“#slides”中回显幻灯片 div？

如果它包含图像而不破坏 foreach 循环，PHP 中有什么东西可以让我回显幻灯片吗？

还是我将不得不打破 foreach 循环，仅存储包含图像的幻灯片的信息并重新循环它们？如果是这样，最好的方法是什么？

我迷路了，因为如果我为 $key=="img" 做一个 if 语句，它只会回显图像部分，不知道我应该如何处理它。

## 代码：

**新闻.JSON**

```
{
    "1": {
        "id": "1",
        "img":"./images/newspost/07-05-12.jpg",
        "link":"http://www.cnn.com/2012/07/05/world/europe/france-air-crash-report/index.html",
        "title": "Example",
        "date":"02/08/12",
        "content": "Example"
    },
    "2": {
        "id": "2",
        "img":"",
        "link":"http://online.wsj.com/article/SB10001424052702304141204577508500189367804.html?mod=googlenews_wsj",
        "title": "Example",
        "date":"09/03/10",
        "content": "Example"
    }
} 
```

**主页.PHP**

```
/* Error Report on */
error_reporting(E_ALL);

/* Open Json file */
$json = file_get_contents("./content/news.json");

/* Setup iterator to go through file */
$jsonIterator = new RecursiveIteratorIterator(new RecursiveArrayIterator(json_decode($json, TRUE)),RecursiveIteratorIterator::SELF_FIRST);

/* Create SLIDES for SLIDESHOW */
echo "<div id='slides'>"; 
```

在这一点上，如果不存在图像，我不想回显任何东西。

```
foreach($jsonIterator as $key => $val)
{

if(is_array($val))
{
echo "<div>";
}

if($key=="link")
{
echo "<a href='$val'>";
}

if($key=="img"&&$val!="")
{
echo "<img alt='' src='$val'></img>";

}

if(!is_array($val)&&$key=="content")
{
echo "</a>";
echo "</div>";
}

} 
```

结束循环/仅当图像存在时才需要显示的内容。

```
echo "</div>";
/* End SLIDES creation */ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:03:55.943

我向您展示我将如何做到这一点：

```
$json = file_get_contents("./content/news.json");
$jsonArray = json_decode($json, true);

// Start slideshow...
echo "<div id='slideshow'>";

foreach ($jsonArray as $entry) {
  if ($entry['img'] == '') {
    continue; // Just don't do anything with this entry, go to next one
  }

  // News begins.
  echo "<div>";

  // For example:
  echo "<a href='" . $entry['link'] . "'>";
  // Etc.

  // News ends.
  echo "</div>";
} 
```

我认为这比你的方式简单得多。

# asp.net - ASP.net：<%、<%= 和 <%# 有什么区别？

> ID：11346821
> 
> 赞同：3
> 
> 时间：2012-07-05T14:48:50.537
> 
> 标签：asp.net, data-binding, repeater

> **可能重复：**
> [我什么时候应该在 ASP.NET 控件中使用 # 和 =？](https://stackoverflow.com/questions/115159/when-should-i-use-and-in-asp-net-controls)

在 ASP.net 中，有什么区别：

*   `<% something %>`
*   `<%= something %>`
*   `<%# something %>`

任何一个都是其他任何一个的缩写吗？任何一个都可以写成其他的吗？我什么时候想使用任何一个而不是其他任何一个？在什么情况下我应该使用任何一个，而不是任何其他？任何一种情况是为什么情况而设计的，而不是使用任何其他情况？在什么情况下我*不*应该使用任何一种？

换句话说：

> 他们之间有什么区别？

**注意**：谷歌搜索这是一个不可能的问题；鉴于第一个答案是[书呆子、极客和呆子之间有什么区别？](http://ask.yahoo.com/20060818.html)

* * *

假设语法的一些示例，可能有效也可能无效，可能会或可能不会证明在假设情况下每种语法的有效或无效使用：

```
<% currentUser.Username %>
<%= currentUser.Username %>
<%# currentUser.Username %>

<% GetDisplayName() %>
<%= GetDisplayName() %>
<%# GetDisplayName() %>

<% GetColumnDayName(Container.DataItem) %>
<%= GetColumnDayName(Container.DataItem) %>
<%# GetColumnDayName(Container.DataItem) %>

<% Eval(Container.DataItem, "PhoneNumber")%>
<%= Eval(Container.DataItem, "PhoneNumber")%>
<%# Eval(Container.DataItem, "PhoneNumber")%>

<% Container.DataItem.Eval("PhoneNumber") %>
<%= Container.DataItem.Eval("PhoneNumber") %>
<%# Container.DataItem.Eval("PhoneNumber") %>

<% DataBinder.Eval(Container.DataItem, "PhoneNumber")%>
<%= DataBinder.Eval(Container.DataItem, "PhoneNumber")%>
<%# DataBinder.Eval(Container.DataItem, "PhoneNumber")%>

<% Bind(Container.DataItem, "PhoneNumber") %>
<%= Bind(Container.DataItem, "PhoneNumber") %>
<%# Bind(Container.DataItem, "PhoneNumber") %>

<% DataBinder.Bind(Container.DataItem, "PhoneNumber") %>
<%= DataBinder.Bind(Container.DataItem, "PhoneNumber") %>
<%# DataBinder.Bind(Container.DataItem, "PhoneNumber") %>

<% Container.DataItem.Bind("PhoneNumber") %>
<%= Container.DataItem.Bind(Container.DataItem, "PhoneNumber") %>
<%# Container.DataItem.Bind(Container.DataItem, "PhoneNumber") %> 
```

* * *

**编辑：**除了和之外还有其他*“转义字符”*吗？这个叫什么; 逃跑？`<%``<%=``<%#`

# javascript - 显示错误消息时设置计数器

> ID：11346822
> 
> 赞同：0
> 
> 时间：2012-07-05T14:48:53.283
> 
> 标签：javascript, jquery

我需要能够设置一个计数器来监控提交表单时生成了多少错误。错误由 css 类 .validmissing 突出显示。

因此，如果用户在提交时出现 5 个错误 - 计数器设置为 1

如果用户重新提交表单然后出现 3 个错误，我的计数器需要在同一个会话中增加到 2。

```
<script type="text/javascript">
  var ErrorCounter = 0;
    $(document).ready(function() {
    if($('.validmissing').length > 0) {
       ErrorCounter = 1;
    else{
    ErrorCounter = 0;
          }
    });
  </script> 
```

我需要设置 cookie 或会话变量吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:55:47.783

您可以使用有效的 cookie 或会话变量，但更好的是使用您之前存储的计数器的输入隐藏字段。

HTML

```
<form method="get">
<input type="hidden" value="" name="counter" id="counter" />
..........
..........
</form> 
```

Javascript

```
 <script type="text/javascript">

//http://stackoverflow.com/questions/901115/get-query-string-values-in-javascript

 function getParameterByName(name)
    {
      name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
      var regexS = "[\\?&]" + name + "=([^&#]*)";
      var regex = new RegExp(regexS);
      var results = regex.exec(window.location.search);
      if(results == null)
        return 0;
      else
        return decodeURIComponent(results[1].replace(/\+/g, " "));
    }

      var ErrorCounter = 0;
        $(document).ready(function() {
        $("#counter").val(getParameterByName("counter"));
        if($('.validmissing').length > 0) {
           ErrorCounter = $("#counter").val();
           ErrorCounter = 1*ErrorCounter + 1;
           $("#counter").val(ErrorCounter);
        });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:01:57.553

您可以使用 jQuery.cookie 插件

它的使用非常简单。

要设置 cookie：

```
$.cookie('cookieName', val, {path: "/", expires: 1}) 
```

为了得到一个cookie，我想只是：

```
$.cookie('cookieName'); 
```

有一个选项可以让 cookie 持续一个会话，而不是上面过期的天数。

# java - 将属性注入 JBossWS CXF 模块的 WSPasswordCallback

> ID：11346832
> 
> 赞同：0
> 
> 时间：2012-07-05T14:49:35.120
> 
> 标签：java, web-services, spring, cxf, jboss7.x

在将在 JBoss 4.3 中执行的现有应用程序转换为 JBoss 7 时，我遇到了 Web 服务身份验证 (WS-Security) 的问题。

我正在关注以下信息：[https](https://docs.jboss.org/author/display/JBWS/JBoss+Web+Services+Documentation) ://docs.jboss.org/author/display/JBWS/JBoss+Web+Services+Documentation ，它似乎适用于 WS-Security 身份验证。

Web 应用程序包含一个 jbossws-cxf.xml 文件，并且 JBoss 7 正确安装了 spring 模块。端点配置有以下 XML：

```
<beans xmlns='http://www.springframework.org/schema/beans' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:beans='http://www.springframework.org/schema/beans'
xmlns:jaxws='http://cxf.apache.org/jaxws'
xsi:schemaLocation='http://cxf.apache.org/core
http://cxf.apache.org/schemas/core.xsd
http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
http://cxf.apache.org/jaxws
http://cxf.apache.org/schemas/jaxws.xsd'>

<!-- WS-Security -->
<bean id="webServicePasswordCallBack" class="ie.one23.general.security.WebServicePasswordCallback">
    <property name="WS_USERNAME" value="${properties.ws-credentials.username}" />
    <property name="WS_PASSWORD" value="${properties.ws-credentials.password}" />
</bean>

<bean id="SMSServiceLoggingCXFIncomingInterceptor" class="ie.one23.general.logging.LoggingCXFIncomingInterceptor" />

<!-- Web Service endpoint -->
<!-- See https://docs.jboss.org/author/display/JBWS/Apache+CXF+integration -->
<jaxws:endpoint id="SMSService" implementor="ie.one23.commonservices.webservice.controller.SMSWebServiceImpl" address="/SMSService/SMSService">

    <jaxws:inInterceptors>
        <!-- WS-Security -->
        <bean class="org.apache.cxf.binding.soap.saaj.SAAJInInterceptor" />
        <bean class="org.apache.cxf.ws.security.wss4j.WSS4JInInterceptor">
            <constructor-arg>
                <map>
                    <entry key="action" value="UsernameToken" />
                    <entry key="passwordType" value="PasswordText" />
                    <entry key="passwordCallbackRef">
                        <ref bean="webServicePasswordCallBack" />
                    </entry>
                </map>
            </constructor-arg>
        </bean>
    </jaxws:inInterceptors>

    <jaxws:outInterceptors>
    </jaxws:outInterceptors>

</jaxws:endpoint>

</beans> 
```

这里的问题是属性 WS_USERNAME 和 WS_PASSWORD 分别以实际文本 ${properties.ws-credentials.username} 和 ${properties.ws-credentials.password} 注入到 bean 中，而不是实际值来自属性文件并使用以下 XML 加载（在单独的 Spring 配置 XML 文件中）：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.springframework.org/schema/beans
   http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">

<!-- ================================================================== -->

<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="locations">
        <list>
            <value>file:/${jboss.server.config.dir}/props/sms-service-credentials.properties</value>
        </list>
    </property>
</bean>

<!-- ================================================================== -->

</beans> 
```

就好像只有在将属性注入 bean 之后才加载属性文件......

有没有人遇到过这个问题并知道如何解决？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T08:17:45.003

我按照这里的教程（http://codingbone.wordpress.com/2010/02/28/how-to-load-properties-files-into-spring-and-expose-to-the-java-classes/）和现在，我没有将属性注入 WSPAsswordCallback bean，而是在运行时使用 PropertiesUtil 类获取它们。

```
public class PropertiesUtil extends PropertyPlaceholderConfigurer {

private static Map<String, Object> propertiesMap;

@Override
protected void processProperties(ConfigurableListableBeanFactory beanFactory, Properties props) throws BeansException {
    super.processProperties(beanFactory, props);

    propertiesMap = new HashMap<String, Object>();
    for (Object key : props.keySet()) {
        String keyStr = key.toString();
        propertiesMap.put(keyStr, resolvePlaceholder(keyStr, props));
    }
}

public static Object getProperty(String name) {
    return propertiesMap.get(name);
}
} 
```

# javascript - 如何输出多维数组值

> ID：11346839
> 
> 赞同：0
> 
> 时间：2012-07-05T14:50:01.243
> 
> 标签：javascript

我正在尝试在 javascript 中显示多维数组。有人可以帮助我了解我的代码吗？谢谢。

```
for (var i=0;i<array.length;i++){

    for (var a=0;a<array[i].length;a++){

       //document.write(array[0][0])    //this will have output
       document.write(array[i][a])      //this won't.

    }

} 
```

更新：

我的阵列

该数组是从 php 创建的，然后使用 json_encode 解析为 JS。

```
 Array
(
    [0] => SimpleXMLElement Object
        (
            [0] => In UK, HTC Defeats Apple's "Obvious" Slide Unlock Patent
        )

    [1] => SimpleXMLElement Object
        (
            [0] => timothy
        )

    [2] => SimpleXMLElement Object
        (
        )

    [3] => SimpleXMLElement Object
        (
            [0] => 2012-07-05T14:10:00+00:00
        )

    [4] => SimpleXMLElement Object
        (
            [0] => WikiLeaks Begins Release of 2.5m Syrian Emails
        )

    [5] => SimpleXMLElement Object
        (
            [0] => timothy
        )

    [6] => SimpleXMLElement Object
        (
        )

    [7] => SimpleXMLElement Object
        (
            [0] => 2012-07-05T13:29:00+00:00
        )

    [8] => SimpleXMLElement Object
        (
            [0] => A Critical Examination of Bill Gates' Philanthropic Record
        )

    [9] => SimpleXMLElement Object
        (
            [0] => samzenpus
        )

    [10] => SimpleXMLElement Object
        (
        )

    [11] => SimpleXMLElement Object
        (
            [0] => 2012-07-05T12:07:00+00:00
        )

    [12] => SimpleXMLElement Object
        (
            [0] => Ask Slashdot: How Does Your Company Evaluate Your Performance?
        )

    [13] => SimpleXMLElement Object
        (
            [0] => samzenpus
        )

    [14] => SimpleXMLElement Object
        (
        )

    [15] => SimpleXMLElement Object
        (
            [0] => 2012-07-05T08:52:00+00:00
        )

    [16] => SimpleXMLElement Object
        (
            [0] => UAV Cameras an Eye In the Sky For Adventurous Filmmakers
        )

    [17] => SimpleXMLElement Object
        (
            [0] => samzenpus
        )

    [18] => SimpleXMLElement Object
        (
        )

    [19] => SimpleXMLElement Object
        (
            [0] => 2012-07-05T05:55:00+00:00
        )

    [20] => SimpleXMLElement Object
        (
            [0] => Copyrights To Reach Deep Space
        )

    [21] => SimpleXMLElement Object
        (
            [0] => samzenpus
        )

    [22] => SimpleXMLElement Object
        (
        )

    [23] => SimpleXMLElement Object
        (
            [0] => 2012-07-05T02:46:00+00:00
        )

    [24] => SimpleXMLElement Object
        (
            [0] => FDA Approves HIV Home-Use Test Kit
        )

    [25] => SimpleXMLElement Object
        (
            [0] => samzenpus
        )

    [26] => SimpleXMLElement Object
        (
        )

    [27] => SimpleXMLElement Object
        (
            [0] => 2012-07-05T00:13:00+00:00
        )

    [28] => SimpleXMLElement Object
        (
            [0] => Texas Scientists Regret Loss of Higgs Boson Quest
        )

    [29] => SimpleXMLElement Object
        (
            [0] => samzenpus
        )

    [30] => SimpleXMLElement Object
        (
        )

    [31] => SimpleXMLElement Object
        (
            [0] => 2012-07-04T23:25:00+00:00
        )

    [32] => SimpleXMLElement Object
        (
            [0] => Icelandic MP Claims US Vendetta Against WikiLeaks
        )

    [33] => SimpleXMLElement Object
        (
            [0] => Soulskill
        )

    [34] => SimpleXMLElement Object
        (
        )

    [35] => SimpleXMLElement Object
        (
            [0] => 2012-07-04T22:38:00+00:00
        )

    [36] => SimpleXMLElement Object
        (
            [0] => Microsoft's 'Cannibalistic Culture'
        )

    [37] => SimpleXMLElement Object
        (
            [0] => Soulskill
        )

    [38] => SimpleXMLElement Object
        (
        )

    [39] => SimpleXMLElement Object
        (
            [0] => 2012-07-04T21:50:00+00:00
        )

    [40] => SimpleXMLElement Object
        (
            [0] => Android 4.1 Jelly Bean Review
        )

    [41] => SimpleXMLElement Object
        (
            [0] => Soulskill
        )

    [42] => SimpleXMLElement Object
        (
        )

    [43] => SimpleXMLElement Object
        (
            [0] => 2012-07-04T21:04:00+00:00
        )

    [44] => SimpleXMLElement Object
        (
            [0] => John the Ripper Cracks Slow Hashes On GPU
        )

    [45] => SimpleXMLElement Object
        (
            [0] => Soulskill
        )

    [46] => SimpleXMLElement Object
        (
        )

    [47] => SimpleXMLElement Object
        (
            [0] => 2012-07-04T20:38:00+00:00
        )

) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:55:31.960

代码工作正常，您的数组必须无效。

[http://jsfiddle.net/DZwaK/](http://jsfiddle.net/DZwaK/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:54:43.323

This works fine for me, used `array = [[1,2],[3,4]];` as a test array, output: `1234`. what do you get when you do `document.write(JSON.parse(array));` or `console.log(array);`?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:59:42.217

尝试这个

```
function writeMultiArrayToConsole(arr)
{
var console = document.getElementById('mydiv');
var msg = '';
for(var i=0;i<arr.length;i++)
{
    for(var j=0;j<arr[0].length;j++)
        msg += arr[i][j];
    msg += '<br />';
}
console.innerHTML = msg;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T15:00:58.300

我通常为每个数组使用，在js中你可以这样做

```
var array = [];
array[0] = ['foo', 'bar'];
array[1] = ['baz'];
for (i in array){
    for (j in array[i]){
       document.write(array[i][j])      //this won't.
    }
} 
```

有人说这不安全，但它仍然有效：D

# jquery - 带有自定义事件的 IE8 中的 Jquery 内存泄漏

> ID：11346840
> 
> 赞同：1
> 
> 时间：2012-07-05T14:50:00.957
> 
> 标签：jquery, internet-explorer, memory-leaks, closures

将自定义事件绑定到 JS 对象中引用的 Jquery DOM 对象时，我在 IE8/7 中看到内存泄漏。IE9看起来不错。使用标准事件（“点击”）也可以正常工作。

完整代码在[http://jsfiddle.net/hah8n/1/](http://jsfiddle.net/hah8n/1/)

```
var testField = function ($in) {
  var $input = $in;
  var onCustom = function () { }

  this.Test = function () {
    $input.on('custom', onCustom);
  }
}

var $input = $("<span>" + Math.random() + "</span>").appendTo($row);
new testField($input).Test(); 
```

在 JSFiddle 中，我可能还添加了清理代码作为解决方案 - 但它没有帮助。还将“testField”的所有实例存储在某处，然后删除它们（使用“delete”命令）并没有帮助。

任何想法，也许是对 IE8 中的自定义事件和特殊处理的一些见解？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:23:04.620

Jquery 1.8b2 似乎解决了这个问题。:-)

# .net - 消息框不与表单一起显示？

> ID：11346847
> 
> 赞同：0
> 
> 时间：2012-07-05T14:50:29.583
> 
> 标签：.net, vb.net, vb.net-2010

我使用后台工作人员执行一些任务，当后台工作人员成功完成时会出现一个消息框，我遇到的问题是如果我最小化我的表单并且当我单击表单时出现消息框，消息框似乎仍然被最小化，除非我点击消息框 - 我可以在底部的任务栏中看到它，但它被最小化了？

当用户单击任务栏中的表单然后消息框与表单一起出现时，是否有可能？

目前我已经尝试在 hte 消息框之前添加以下内容，但是消息框似乎仍然被最小化。

```
me.activate 
```

**更新**

很抱歉没有添加编码，我认为因为它是基本编码，所以没关系，但在这里......

```
Private Sub BGWorker_DoWork(ByVal sender As Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles BGWorker.DoWork

            If Not worker.CancellationPending Then

‘ Do code

                If worker.CancellationPending Then
                    e.Cancel = True
‘ Do Code
                    Exit Sub
                End If

            End If

End Sub

  Private Sub BGWorker_RunWorkerCompleted(ByVal sender As Object, ByVal e As System.ComponentModel.RunWorkerCompletedEventArgs) Handles BGWorker.RunWorkerCompleted
            Me.Activate()
            If e.Cancelled Then
Messagebox.show(“Cancelled”)
            Else
Messagebox.show(“Successful”)

                End If
    End Sub 
```

问题是，如果我将屏幕留在其他屏幕的顶部，那么消息框会出现，但是如果它最小化，如果我有其他窗口覆盖表单，那么消息框将保持最小化，除非我在任务栏中单击它。

我认为 me.activate 会帮助我，因为消息框只会出现在表单中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:09:14.160

我使用您的代码制作了一个测试项目，并且能够重现并解决该问题。该`Activate`方法不会取消最小化表单。为此，您需要设置`WindowState`属性。试试这个：

```
Private Sub BGWorker_RunWorkerCompleted(ByVal sender As Object, ByVal e As System.ComponentModel.RunWorkerCompletedEventArgs) Handles BGWorker.RunWorkerCompleted
    Me.WindowState = FormWindowState.Normal  ' Add this line
    Me.Activate()
    If e.Cancelled Then
        Messagebox.show(“Cancelled”)
    Else
        Messagebox.show(“Successful”)

    End If
End Sub 
```

# php - 带有数组 next() 和 prev() 链接的图像导航

> ID：11346849
> 
> 赞同：0
> 
> 时间：2012-07-05T14:50:32.063
> 
> 标签：php, arrays, image, loops, navigation

我正在尝试将此功能用于图像导航：

```
function array_key_relative($array, $current_key, $offset = 1, $strict = true) {
  // create key map
  $keys = array_keys($array);
  // find current key
  $current_key_index = array_search($current_key, $keys, $strict);
  // return desired offset, if in array, or false if not
  if(isset($keys[$current_key_index + $offset])) {
    return $keys[$current_key_index + $offset];
  }
  return false;
} 
```

我想这样使用它：

```
<?php 
$images = array();
foreach ($images as $key => $image)
$prev_key = $this->array_key_relative($images, $key, -1);
$next_key = $this->array_key_relative($images, $key, 1);
?>

<a href="<?php echo "image?id=".$images[$prev_key]->id; ?>">Prev</a>
<a href="<?php echo "image?id=".$images[$next_key]->id; ?>">Next</a> 
```

问题是当我按 Next 或 Prev 链接它只工作一次时，例如，如果当前键为 1，如果我按 next 将转到 2，但是一旦我在 2 页上导航停止工作（不转到 3， 4、5 等）。谁能指出我正确的方向？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T09:34:14.577

您的 next_key 在第一次查看时不包含 + 符号 -

> $next_key = $this->array_key_relative($images, $key, +1);

但我会用

```
$next = $images++; 
$prev = $images--;

$next_key = $this->array_key_relative($images, $key, $next);
$prev_key = $this->array_key_relative($images, $key, $prev); 
```

# ruby - 枚举数组但将数组的子集传递给块而不是单个元素

> ID：11346850
> 
> 赞同：2
> 
> 时间：2012-07-05T14:50:33.257
> 
> 标签：ruby

我是 ruby​​ 新手，我已经阅读了很多教程。昨天我发誓我读了一个`each`枚举数组的语句（或类似的东西）的例子，然后将数组的一个子集传递给块。这是一个示例，但语法错误（或者我使用了错误的方法）因此实际上不会运行。

```
arry = ["a", "b", "c", "d", "e"]

arry.each(3) {|a, b, c| puts a+b+c} 
```

如果我使用了正确的命令，这将打印`abc bcd cde`：它从索引开始获取数组的前三个成员，当没有足够长的字符串来提供所有三个参数时，枚举结束。我不记得该怎么做，我似乎无法通过谷歌搜索正确的东西来找到它。你们有谁知道吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T14:56:03.350

`each_cons(3)`表现得像那样。它在[Enumerable](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-each_cons)中（数组包括 Enumerable），这就是你找不到它的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:54:24.417

you mean something like `combination` ?

```
arry.combination(3).each {|a, b, c| p a+b+c} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T14:55:14.403

怎么样`each_slice`？

```
arry.each_slice(3) {|a,b,c| p a+b+c} 
```

# jquery - Jquery动画问题

> ID：11346853
> 
> 赞同：1
> 
> 时间：2012-07-05T14:50:37.620
> 
> 标签：jquery

我有一个小问题，当验证发生时显示块时，我试图向上滚动到第一个跨度。

我已经尝试了以下代码，因此一旦用户尝试提交，如果跨度显示为“必需”类，则页面应该向上滚动。

HTML：

```
<span id="_userExists" runat="server" visible="false" class="invalid"> 
```

这在标记中，并且在验证发生后应用所需的类。我不确定这如何影响 jquery 动画，因为它运行服务器端并且在验证错误时可见。

查询：

```
$("input[type=submit]").live('click', function(){
 console.log('clicked');
 $('html, body').animate({
   scrollTop: $('.required').first().offset().top
 }, 600);
}); 
```

在内联显示错误消息后，我尝试了相同的脚本，但滚动根本不会发生。如果我选择另一个元素，例如 h2，则页面滚动。滚动到第一个错误需要在页面加载以及客户端验证的提交按钮时发生。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:55:16.103

如果您的所有跨度都获得了所需的课程，请使用它来达到第一个

```
$("input[type=submit]").live('click', function(){
 console.log('clicked');
 $('html, body').animate({
   scrollTop: $('.required:first').offset().top//<--here
 }, 600);
}); 
```

# sql - WCF 服务中断对数据库的调用

> ID：11346854
> 
> 赞同：3
> 
> 时间：2012-07-05T14:50:38.413
> 
> 标签：sql, wcf, wcf-data-services

我想我应该去点形式：

*   我有一项服务，用于在服务器端进行数据库调用

*   使用 IIS

*   DBMS = SQL Server 2008 R2

*   我的连接字符串没有问题，我有正确的凭据

*   我这样做是随机连接到数据库的（这很有效......类在这里连接）：

    ```
     using (Database db = base.SystemDatabase()) 
    ```

*   上面的行并不总是成功。

*   如果我最终连接，当我设置我的 SqlCommand 时它会中断。

这是我的 WCF 服务的配置：

```
<customBinding>
   <binding name="CustomBinding_ITestDataService">
      <binaryMessageEncoding maxReadPoolSize="64" maxWritePoolSize="16"
                             maxSessionSize="2048">
      <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                    maxBytesPerRead="4096" maxNameTableCharCount="16384" />
   </binaryMessageEncoding>
   <httpTransport manualAddressing="false" maxBufferPoolSize="524288"
                  maxReceivedMessageSize="65536" allowCookies="false" 
                  authenticationScheme="Negotiate" bypassProxyOnLocal="false" 
                  hostNameComparisonMode="StrongWildcard"
                  keepAliveEnabled="true" maxBufferSize="65536" 
                  proxyAuthenticationScheme="Anonymous"
                  realm="" transferMode="Buffered" 
                  unsafeConnectionNtlmAuthentication="false" useDefaultWebProxy="true" />
   </binding>
</customBinding>
<behaviors>
   <endpointBehaviors>
      <behavior name="ImpersonationBehaviour">
         <clientCredentials>
             <windows allowedImpersonationLevel="Impersonation"/>
         </clientCredentials>
      </behavior>
   </endpointBehaviors>
</behaviors>
<client>
   <endpoint name="CustomBinding_ITestDataService"
       address="http://test.net/TestApp/TestDataService.svc"
       binding="customBinding" bindingConfiguration="CustomBinding_ITestDataService"
       contract="TestDataService.ITestDataService" >
       <identity>
           <servicePrincipalName value="host/Test.net" />
       </identity>
   </endpoint>
</client> 
```

我会试着看看我是否能得到确切的错误信息......

**编辑**

感谢您的输入。我一直在解决这个问题，当我进行 wcf 调用然后进行远程调用然后给我一个

```
{"The requested name is valid, but no data of the requested type was found"}
    [System.Net.Sockets.SocketException]: {"The requested name is valid, but no data of the requested type was found"}
    Data: {System.Collections.ListDictionaryInternal}
    HelpLink: null
    InnerException: null
    Message: "The requested name is valid, but no data of the requested type was found"
    Source: "mscorlib"
    StackTrace: "\r\nServer stack trace: \r\n   at System.Net.Dns.InternalGetHostByName(String hostName, Boolean includeIPv6)\r\n   at System.Net.Dns.GetHostAddresses(String hostNameOrAddress)\r\n   at System.Runtime.Remoting.Channels.RemoteConnection.CreateNewSocket()\r\n   at System.Runtime.Remoting.Channels.SocketCache.GetSocket(String machinePortAndSid, Boolean openNew)\r\n   at System.Runtime.Remoting.Channels.Tcp.TcpClientTransportSink.SendRequestWithRetry(IMessage msg, ITransportHeaders requestHeaders, Stream requestStream)\r\n   at System.Runtime.Remoting.Channels.Tcp.TcpClientTransportSink.ProcessMessage(IMessage msg, ITransportHeaders requestHeaders, Stream requestStream, ITransportHeaders& responseHeaders, Stream& responseStream)\r\n   at System.Runtime.Remoting.Channels.BinaryClientFormatterSink.SyncProcessMessage(IMessage msg)\r\n\r\nException rethrown at [0]: \r\n   at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)\r\n   at System.Runtime.Remoting.
Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)\r\n   at 
```

**编辑 2**

在我继续调查这个问题之后，这不是 WCF 的问题。在运行时，WCF 服务按其应有的方式工作。实际问题是 WCF 服务正在尝试调用数据库，但是当我尝试连接时，我得到一个 DNS 名称是有效的，但是找不到请求类型错误。

我的应用程序 -> WCF 服务 -> 连接到数据库 -> 运行查询 -> 返回值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T19:32:46.607

在 app.config 文件中，我们必须在端点中显式设置 behaviorConfiguration。例如：

行为配置="模拟行为"

否则，这将行不通。Silverlight 应用程序或控制台应用程序不需要这

# c# - 在解密期间处理不良数据（TripleDES、.NET）

> ID：11346862
> 
> 赞同：-1
> 
> 时间：2012-07-05T14:51:14.180
> 
> 标签：c#, encryption, labview, tripledes

我为用户编辑文件的系统设置了 enc/dec 进程。如果加密文件被恶意修改，我希望能够处理它并说“哦解密失败，将从一个干净的文件开始”......类似的东西。但我不确定如何以不停止程序执行的方式处理异常。

重申一下，我在解密完全有效的数据方面没有问题。我遇到了带有实际错误数据的错误数据错误，我只是想知道如何优雅地处理它。发生错误时，CryptoStream 无法关闭文件，因此我无法用纯文本文件覆盖它或将其用于任何其他内容。

顺便说一句，这是 LabView 中使用的 .NET 代码。不能在这里粘贴代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T18:28:46.653

处理恶意修改的唯一可靠方法是使用包含身份验证的加密方案，例如 AES-GCM，它在某些协议中越来越流行。如果只是填充了加密的密文，您可以更改数据，如果运气好（大约 1/256）或尝试几次，数据看起来仍然有效。并非每个软件都可以安全地填充/取消填充。

您至少必须发布用于任何人的 API，以告诉您如何处理特定异常。

# mysql - 具体5共享认证

> ID：11346863
> 
> 赞同：2
> 
> 时间：2012-07-05T14:51:15.763
> 
> 标签：mysql, authentication, cookies, shared, concrete5

我有一个现有的应用程序（使用 MySQL 的基于 Tomcat 7 的 Java）并想使用 Concrete5 建立一个单独的 CMS 网站。在现有的 Java 应用程序中，我已经有数千个成员帐户和一个身份验证系统（基于会话 cookie）。这两个应用程序将使用子域存在于同一域中... www.domain.com 和 application.domain.com。

我正在努力寻找一种方法来实现这一要求。

有什么建议么？

谢谢，杰夫。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:39:49.160

没有什么是开箱即用的，但是在 Concrete5 的这个领域已经完成了一些工作，这应该会让你成为其中的一部分。

这是目前有人正在研究的通用“第三方身份验证”框架：http: [//www.concrete5.org/community/forums/customizing_c5/authentication-testers/](http://www.concrete5.org/community/forums/customizing_c5/authentication-testers/)

然后有一些 LDAP 解决方案（我真的不知道 LDAP 是什么或它是如何工作的——所以它可能对你的情况有用也可能没用）：

[http://www.concrete5.org/community/forums/customizing_c5/adldap-andamp-c5-integration-for-authentication/#46266](http://www.concrete5.org/community/forums/customizing_c5/adldap-andamp-c5-integration-for-authentication/#46266)

[http://www.concrete5.org/community/forums/customizing_c5/packaged-ldap-authentication-working-beta/](http://www.concrete5.org/community/forums/customizing_c5/packaged-ldap-authentication-working-beta/)

（请注意，这些 LDAP 链接分别有 1 年和 2 年的历史，因此可能需要进行更多修改才能使用最新版本的 Concrete5）。

最后，请注意 C5 已经包含 OpenID 身份验证——因此，如果有某种方法可以轻松地使您现有的系统与 OpenID 一起工作，那么这也是一种可能。

祝你好运！

# php - 将值添加到具有已设置值的数据库列

> ID：11346866
> 
> 赞同：1
> 
> 时间：2012-07-05T14:51:25.560
> 
> 标签：php, mysql, sql

所以我有三个数据库表，其中一个就像另外两个表之间的连接器，一个卡表和一个用户表。连接器表有三列：idUser、idCard 和amount。

在我的代码中，我有一个选择按钮，您可以在其中选择添加 1-4 个同一张卡，我希望能够通过立即添加 4 个或一次添加一个来做到这一点（我想要金额栏为 4)。

至于现在我的代码看起来像这样；

```
if (isset($_POST['addCard'])) {

    if (!isset($_SESSION['sess_user'])){
    print "fel!";

    }else {
        $idUser = $_SESSION['sess_id'];
        $idCard = $_POST['addCard'];
        $amount = $_POST['amount'];

    $query1 = "INSERT INTO userDeck (idUser, idCard, amount) VALUES ('$idUser',    '$idCard', '$amount')";
        $result1 = mysql_query($query1);
        }
} 
```

这将检查用户是否已登录，否则它只会打印“错误”（只是在测试），如果已登录，当我添加任意数量的卡片时，这仍然只是在表中创建一个新行。

我希望我已经添加了您可能需要的信息，真的坚持这一点，所以任何帮助都会得到帮助，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:01:18.690

切换（或添加更多逻辑）以包含`UPDATE`语句。

或将数据库模式更改为不包括计数，而只是每个用户的卡片列表 - 然后您可以在用户获得任何新卡时仅处理 INSERT，并在用户丢失卡时处理 DELETE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:09:11.823

```
INSERT INTO userDeck (idUser, idCard, amount) 
VALUES ('$idUser', '$idCard', '$amount')
ON DUPLICATE KEY UPDATE amount=amount+$amount 
```

`(idUser, idCard)`您需要在字段上具有复合唯一键或主键。

**编辑**：使用相同的查询强制执行最多 4 张卡：

```
INSERT INTO userDeck (idUser, idCard, amount) 
VALUES ('$idUser', '$idCard', MIN(4, '$amount'))
ON DUPLICATE KEY UPDATE amount=MIN(4, amount+$amount) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:02:48.470

查询可能如下所示：

```
UPDATE userDeck 
SET amount = amount + $amount 
WHERE 
    idUser = $idUser AND 
    idCard = $idCard 
```

# html - 如何在不使用固定高度的情况下使另一个 div 内的两个 div 具有相同的高度

> ID：11346868
> 
> 赞同：0
> 
> 时间：2012-07-05T14:51:28.777
> 
> 标签：html, css

您好，我想知道是否无法将右列设置为与左列相同的高度，其中包含图像。一切都没有固定的高度？

小提琴：http: [//jsfiddle.net/GWZuq/3/](http://jsfiddle.net/GWZuq/3/)

![在此处输入图像描述](../Images/38ca0711c50cf83c094802cf0e430e8c.png)

我的 HTML：

```
<div class="wrapper">
    <div class="left_col"><img src="http://www.monstersandcritics.de/image.php?file=downloads/downloads/musik/zaschamoktanstateofmind_1/images/group1/Zascha-Moktan-State-Of-Mind_201128_248803_1_024.jpg&width=600"></div>
    <div class="right_col">some text ul etc</div>

</div> 
```

我的CSS：

```
.wrapper{
    width:80%;
}
.left_col{
    position:relative;
    width:80%;
    float:left;
}
.left_col img{
    position:relative;
    width:100%;
    height:auto;
}
.right_col{
    position:relative;
    width:20%;
    float:left;
    background-color:pink;
    height:100%; /* why is this not putting right col to 100% of the parent container?
} 
```

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:59:01.720

只需将您的 CSS 替换为以下 CSS（[示例](http://jsfiddle.net/8fuZY/)）：

```
.wrapper {
    width:80%;
    overflow:hidden;
}
.left_col {
    width:80%;
    float:left;
    padding-bottom:10000px;
    margin-bottom:-10000px;
}
.left_col img {
    display:block;
    width:100%;
    height:auto;
}
.right_col {
    width:20%;
    float:left;
    background-color:pink;
    padding-bottom:10000px;
    margin-bottom:-10000px;
} 
```

## 替代解决方案

或者，您可以更改 HTML 和 CSS 以使用`<figure>`和`<figcaption>`（[示例](http://jsfiddle.net/28Kzv/)）。此解决方案还允许垂直对齐：

### HTML

```
<figure class="wrapper">
 <img src="http://www.monstersandcritics.de/image.php?file=downloads/downloads/musik/zaschamoktanstateofmind_1/images/group1/Zascha-Moktan-State-Of-Mind_201128_248803_1_024.jpg&width=600"><!-- Comment out white space
 --><figcaption>some text ul etc</figcaption>
</figure> 
```

### CSS

```
figure.wrapper {
    width:80%;
    overflow:hidden;
    background:pink;
}
figure.wrapper img {
    width:80%;
    display:inline-block;
    height:auto;
    vertical-align:middle; /* top, bottom, or middle to align image vertically */
}
figure.wrapper figcaption {
    width:20%;
    display:inline-block;
    vertical-align:middle; /* top, bottom, or middle to align caption vertically */
} 
```

***注意：**此解决方案使用的新元素在 IE8 及更低版本中不起作用，除非它们通过 JavaScript 注册。这可以通过包含 html5shiv ( [Google Code](http://code.google.com/p/html5shiv/) , [GitHub](https://github.com/aFarkas/html5shiv) ) 来克服。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:54:13.433

如果要使用高度（或上下绝对定位），则必须定义父级的高度。

您必须为父容器指定高度：

*   要么明确地给它一个高度
*   或使用绝对定位并指定顶部和底部

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:54:26.493

您必须将两个高度都设置为 50%

# python - 为 python setup.py install --prefix 导出变量

> ID：11346869
> 
> 赞同：1
> 
> 时间：2012-07-05T14:51:35.980
> 
> 标签：python, installation, prefix, setup.py

当我安装一个python包时`prefix`

```
python setup.py install --prefix=$HOME/opt 
```

在`~/.bashrc`中，我修改了`PATH`环境变量。

```
export PATH=$HOME/opt:$PATH 
```

还有其他需要修改的环境变量吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:02:56.643

为此使用 virtualenv。Virtualenv 创建了一个充当“小 unix”的目录。您可以根据需要激活和停用此环境，并为不同目的保留多个环境。激活环境将处理所有环境变量。

[http://pypi.python.org/pypi/virtualenv](http://pypi.python.org/pypi/virtualenv)

```
virtualenv mynix
source mynix/bin/activate
cd packages/foo
python setup.py install 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:55:33.727

您可能需要修改 PYTHONPATH。

# sharepoint-2010 - 如何使用客户端对象模型 sharepoint 2010 从文档库中搜索文件

> ID：11346870
> 
> 赞同：1
> 
> 时间：2012-07-05T14:51:40.943
> 
> 标签：sharepoint-2010, sharepoint-clientobject

目前，我正在努力以编程方式启用搜索功能，以使用客户端对象模型 sharepoint 2010 从文档库中搜索文件，

你能帮我写代码吗

谢谢

卡哈尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T11:06:37.267

```
List list = clientcontext.Web.Lists.GetByTitle(ListName);
clientcontext.Load(list);
clientcontext.ExecuteQuery();

FileCollection files = list.RootFolder.Files;
clientcontext.Load(files);
clientcontext.ExecuteQuery();
foreach (Microsoft.SharePoint.Client.File file in files)
{
    if(file.Name == txtSearch)
    {
        // your logic
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T09:51:53.897

```
 private string searchDoc(string name)
    {
        try
        {
            ClientContext clientContext = new ClientContext("YOUR SERVER");
            SP.List oList = clientContext.Web.Lists.GetByTitle("YOUR DOC");
            CamlQuery camlQuery = new CamlQuery();
            camlQuery.ViewXml = @"<View Scope='Recursive'/>";
            Microsoft.SharePoint.Client.ListItemCollection collListItem1 = oList.GetItems(camlQuery);
            clientContext.Load(collListItem1, items => items.Include(item => item.DisplayName, item => item["Comments"]));
            clientContext.ExecuteQuery();
            foreach (Microsoft.SharePoint.Client.ListItem oListItem1 in collListItem1)
            {
                 if (oListItem1.DisplayName == name)
                 {
                     XXXXXXXXXXXXXX
                 }
            }

        catch (Exception ex)
        {
            System.Windows.MessageBox.Show(ex.Message, "Exception");
        }
    } 
```

递归的搜索！

# sorting - Powershell Sort-Object 是否使用稳定的排序

> ID：11346871
> 
> 赞同：3
> 
> 时间：2012-07-05T14:51:43.073
> 
> 标签：sorting, powershell, stable-sort

我需要从多个来源创建一个不同的历史项目列表，其中最新的项目是保留的项目。我正在尝试这样的事情，但由于问题域，检查结果是否准确并不容易。

```
Function GetUnique {
    param( $source1, $source2, ...)

    $items = $source1 + $source2 + ...;

    $unique = $items | Sort-Object -Desc -Unique -Prop Timestamp;

    # Does this contain the most recent items?

    $unique;
} 
```

我很惊讶没有 -Stable 开关来指示偏好。

注意：我知道即使排序是稳定的，我也会对唯一性算法做出假设。如果排序是稳定的，我可以相对容易地编写我自己的稳定的 Get-Unique 命令行开关，假设稳定的排序输入。但是，我真的不想实现 MergeSort。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T17:00:01.897

所以在放弃我的场景之后，我找到了一个简单的测试来表明排序实际上并不稳定，但以某种稳定的方式颠倒了序列。请注意，我使用的测试集非常小，因此这些结果可能不确定，但可以重现。

```
function f ([String] $name, [int] $value) `
{
    return New-Object PSObject -Property @{ Name=$name; Value=$value } | 
        select Name,Value; 
};
$test = (f a 1),(f a 2),(f a 3),(f b 1),(f b 2);
"`n`$test;"
$test;
"`n`$test | sort name;"
$test | sort name;
"`n`$test | sort name -Desc;"
$test | sort name -Desc;
"`n`$test | sort name | sort name;"
$test | sort name | sort name;
"`n`$test | sort value | sort name;"
$test | sort value | sort name;
"`n`$test | sort value;"
$test | sort value; 
```

结果如下：

```
$test;
Name                                                  Value
----                                                  -----
a                                                         1
a                                                         2
a                                                         3
b                                                         1
b                                                         2

$test | sort name;
a                                                         3
a                                                         2
a                                                         1
b                                                         2
b                                                         1

$test | sort name -Desc;
b                                                         1
b                                                         2
a                                                         1
a                                                         2
a                                                         3

$test | sort name | sort name;
a                                                         1
a                                                         2
a                                                         3
b                                                         1
b                                                         2

$test | sort value | sort name;
a                                                         2
a                                                         1
a                                                         3
b                                                         1
b                                                         2

$test | sort value;
b                                                         1
a                                                         1
b                                                         2
a                                                         2
a                                                         3 
```

[我已经在https://connect.microsoft.com/PowerShell/feedback/details/752455/provide-stable-switch-for-sort-object-cmdlet](https://connect.microsoft.com/PowerShell/feedback/details/752455/provide-stable-switch-for-sort-object-cmdlet)上向 PS 团队提交了一个建议。如果您同意，请点赞。

# iphone - 属性分配两次时避免内存泄漏

> ID：11346875
> 
> 赞同：0
> 
> 时间：2012-07-05T14:52:02.267
> 
> 标签：iphone, objective-c, memory-management, properties, memory-leaks

假设我有一个名为**MyTestClass.h**的类。

类结构看起来像

```
@interface MyTestClass : NSObject {

    NSString *testString;   
}

@property (nonatomic, retain)NSString * testString;

@end 
```

**.m 文件**

```
@implementation MyTestClass

@synthesize testString;    

-(id) init{ 

    [self setTestString:@""];           
    return self;
}

-(void)dealloc{ 

    [self.testString release];      
    testString = nil;

    [super dealloc];
}

@end 
```

现在我创建了一个**MyTestClass**对象并分配了**testString**两次

```
MyTestClass * myTestClass = [[MyTestClass alloc] init];

[myTestClass setTestString:@"Hi"];
[myTestClass setTestString:@"Hello"]; 
```

现在我想，我的 testStrings 内存泄漏了两次！（一个通过**init()**另一个通过我的第一个**setTestString**方法）

我对么？还是会`@property (nonatomic, retain)`处理/释放以前分配的内存？

或者，在这种情况下，我是否需要像下面的代码一样覆盖*MyTestClass.m*中的**setTestString()**

 *```
-(void)setTestString:(NSString *)tempString{    

    [testString release];
    testString = nil;

   testString = [tempString retain];
} 
```

对此问题的任何帮助表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:21:51.353

> 对此问题的任何帮助表示赞赏。

我会以此为许可进行一些不一定与您的问题直接相关的观察。

首先，如果您声明一个保留属性（如您所做的那样）并合成它，自动生成的 getter 和 setter 会为您正确处理内存管理。

如果您手动创建 setter（即使使用`@synthesize`现有的也可以这样做），您必须自己进行内存管理。使用任何一个特洛伊木马的例子。

您问题中的设置器包含一个错误，即如果 testString == tempString 即您将属性的值分配给自身，您最终可能会为该属性分配一个悬空指针，因为您有效地释放 tempString 然后保留它。

* * *

这是一个您可以安全忽略的实现细节，但是字符串文字（例如`@"blah"`）被编译到可执行文件中，并且无论它们被释放多少次都不会被释放。因此，对于您的示例，即使设置器没有进行正确的内存管理，也不会有泄漏。

* * *

顺便说一句，init 方法的正常模式是

```
-(id) init
{
    self = [super init];
    if (self != nil)
    {
        // init stuff
    }
    return self;
} 
```

或逻辑等价物。

您应该养成使用它的习惯，因为您需要调用超类的init方法，并且允许更改self的值，甚至可以更改为nil。

此外，虽然通常在释放对象引用后将其设置为 nil 是非常好的做法，但在这两种情况下，都没有必要这样做。第一次，变量即将超出范围，第二次您立即从其他对象分配它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:57:22.227

这不是泄漏。合成变量得到正确处理。

以这种方式实现合成方法（对于保留关键字）

```
@property (nonatomic, retain) NSString *string;
//backed by variable NSString *_string;

- (void)setString:(NSString*)newString
{
    if (newString != _string) {
       [_string release];
       _string = [newString retain];
    }
} 
```

当然这是一个泄漏：

```
- (void)aMethod //of my class with string property
{
   NSString *aString = [[NSString alloc] initWithString:@"hello"];
   self.string = aString; //retain count of 2
   self.string = @"hello2"; //retain count of 1 for aString

  //now I don't release aString.... leak

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T14:57:27.320

如果您使用自动生成的设置器（在您的情况下，`setTestString:`，也由 调用），则在设置之前释放属性`self.testString = ...;`的先前值。`retain`所以不，您在上面发布的代码中没有泄漏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T14:57:35.977

`synthesize`d setter 方法应该做正确的事情。这是它的实现示例：

```
- (void)setTestString:(NSString *)tempString
{    
    [tempString retain];
    [testString release];
    testString = tempString;
} 
```

或者：

```
- (void)setTestString:(NSString *)tempString
{    
    if (tempString != testString)
    {
        [testString release];
        [tempString retain];
        testString = tempString;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T14:57:43.810

只有在实例被破坏时才会调用 dealloc。如果你这样做：

```
[myTestClass setTestString:@"Hi"];
[myTestClass setTestString:@"Hello"]; 
```

在同一块中，您只需调用两次 setter。没有内存泄漏。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-05T14:57:58.890

当您`@synthesize`在指定的属性上使用时`retain`，生成的设置器将正确处理多个分配的保留/释放。只要您使用`self.`而不是直接转到支持变量并在其中进行最终发布，`dealloc`就可以了。*

# r - R：使用数据框中的列绘制多个箱形图

> ID：11346880
> 
> 赞同：19
> 
> 时间：2012-07-05T14:52:31.487
> 
> 标签：r, boxplot

我想为数据框中的每个不相关列绘制一个单独的箱线图。我认为我`boxplot.matrix`从`sfsmsic`包中走上了正确的轨道，但它似乎与将`boxplot(as.matrix(plotdata)`所有内容绘制在共享箱线图中并在轴上共享比例尺相同。我想要（比如说）5 个单独的地块。

我可以像这样手动做到这一点：

```
par(mfrow=c(2,2))
boxplot(data$var1
boxplot(data$var2)
boxplot(data$var3)
boxplot(data$var4) 
```

但是一定有办法使用数据框列吗？

编辑：我使用了迭代，请参阅我的答案。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-05T14:58:02.107

你可以使用这个`reshape`包来简化事情

```
data <- data.frame(v1=rnorm(100),v2=rnorm(100),v3=rnorm(100), v4=rnorm(100))
library(reshape)
meltData <- melt(data)
boxplot(data=meltData, value~variable) 
```

甚至然后使用`ggplot2`包使事情变得更好

```
library(ggplot2)
p <- ggplot(meltData, aes(factor(variable), value)) 
p + geom_boxplot() + facet_wrap(~variable, scale="free") 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-05T14:56:11.727

从`?boxplot`我们看到，我们可以选择将多个数据向量作为列表的元素传递，我们将获得多个箱线图，一个对应于列表中的每个向量。

所以我们需要做的就是将矩阵的列转换为列表：

```
m <- matrix(1:25,5,5)
boxplot(x = as.list(as.data.frame(m))) 
```

如果你真的想要单独的面板，每个面板都有一个箱线图（虽然，坦率地说，我不明白你为什么要这样做），我会转而使用**ggplot**和 faceting：

```
m1 <- melt(as.data.frame(m))
library(ggplot2)
ggplot(m1,aes(x = variable,y = value)) + facet_wrap(~variable) + geom_boxplot() 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-06T08:58:04.000

我使用迭代来做到这一点。我想也许我在最初的问题中并不清楚。感谢您的回复。

```
par(mfrow=c(2,5))
for (i in 1:length(plotdata)) {
        boxplot(plotdata[,i], main=names(plotdata[i]), type="l")

} 
```

# android - Android 多点触控功能（最多 6 点触控）

> ID：11346882
> 
> 赞同：0
> 
> 时间：2012-07-05T14:52:33.577
> 
> 标签：android, touch, multi-touch

我想知道是否可以使用多点触控选项（不仅仅是两个）制作一个最多同时具有 6 个触控功能的 android 应用程序。请你能帮我找到一些相关的文献。我在stackoverflow上找到了一些答案，但恐怕这还不够。

我将不胜感激。谢谢大家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:58:04.060

支持“jazzhands”的设备将处理多达 10 个同时触摸。您的应用可能需要通过以下清单元素支持 jazzhands：

```
<uses-feature android:name="android.hardware.touchscreen.multitouch.jazzhand" /> 
```

并非所有设备都支持这一点——例如，Kindle Fire 仅支持两个同时触摸 IIRC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:01:33.590

2 次或 6 次触摸之间没有软件区别（权限除外），它与硬件相关，如果您不能使用更多的 2 根手指，那么您应该在另一台设备上尝试。

无论如何，如果你想要好的多点触控文献，请看这里：

[理解多点触控 (android-developers.blogspot.fr)](http://android-developers.blogspot.fr/2010/06/making-sense-of-multitouch.html)

# r - 在散点图中绘制两个大型栅格数据集

> ID：11346886
> 
> 赞同：0
> 
> 时间：2012-07-05T14:52:39.790
> 
> 标签：r, plot, ggplot2, raster, scatter-plot

我在 R 中绘制两个栅格数据集时遇到问题。

我使用两个不同的 IRS LISS III 场景（具有相同的范围），我想要的是在一个散点图中绘制两个场景的像素值（x= Layer1 和 y=Layer2）。我现在的问题是处理大量数据。由于重新分类和其他处理，每个场景都有大约 80.000.000 像素，我能够将每个栅格中的值缩小到 12.000.000。但是，当我尝试在 data.frame 中导入这些值或从 ascii 文件中加载它们时，我的记忆总是有问题。是否有可能两次绘制如此大量的数据，如果有人可以帮助我，那将是很棒的，我现在尝试了两天，现在我绝望了。

非常感谢，

斯特凡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T09:13:44.560

使用 raster 包，它很有可能开箱即用，因为它具有良好的“内存不足”处理能力。如果它不适用于 ASCII 网格，请使用 GDAL 将它们转换为更有效的东西（如 LZW 压缩和平铺的 GeoTIFF）。如果它们仍然太大，调整它们的大小，这就是所有图形渲染过程都会做的事情。（您没有说明您最初是如何调整大小的，也没有提供有关您如何尝试阅读它们的任何细节）。

# c# - html转义字符

> ID：11346888
> 
> 赞同：1
> 
> 时间：2012-07-05T14:52:42.157
> 
> 标签：c#, asp.net, html, query-string

我有以下内容：

```
<form name="input" method="get" action="http://site:8083/Default.aspx?DC=" target="foo" onSubmit="window.open('', 'foo', 'width=1100 height=500,status=no,resizable=yes,scrollbars=yes')">
<select name="DC">
<option value="1&Type=type1">1</option>
<option value="2&Type=type2">2</option>
<option value="3&Type=type3">3</option>
<option value="4&Type=type4">4</option>
<option value="5&Type=type5">5</option>
<option value="6&Type=type6">6</option>
<option value="7&Type=type7">7</option>
</select>
<input type="submit" value=">>"/>&nbsp;&nbsp;
</form> 
```

基本上我的查询字符串应该类似于 DC=1&Type=type1 我遇到的问题是，当我单击 html 上方的 >> 按钮时，通过将 & 更改为 %26 并将 = 更改为 %3D 搞砸了

如何使价值保持在上面的代码中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:55:40.003

表单旨在提交数据的键/值对，其中键是`name`控件的，值是`value`. 他们不会将任意字符串混合在一起。

设计您的服务器端程序以期望以表单设计使用的格式输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:29:31.063

是的，这是预期的行为，HTTP GET 以这种方式工作，值被编码为与键不同。在 GET 中，浏览器附加以“&”分隔并以“？”开头的 key=value 对；您不应该在 url 中自己指定它们。

我认为您应该以这种方式更改代码，也许这就是您想要得到的：

```
<form name="input" method="get" action="http://site:8083/Default.aspx" target="foo" onSubmit="updateType()">
<select name="DC">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <!-- etc... -->
</select>
<input type="hidden" name="Type"/>
<input type="submit" value=">>"/>
</form> 
```

在 Javascript 中...：

```
function updateType(){
    // set up 'Type'
    document.forms[0].Type.value = 'Type' + document.forms[0].DC.value;
    // open popup
    window.open('', 'foo', 'width=1100 height=500,status=no,resizable=yes,scrollbars=yes')
    return true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:14:28.687

因此，您要做的是在设置表单上的单个项目时将两个不同的查询字符串设置为两个不同的值。虽然您尝试的解决方案是一个好主意，但显然浏览器正在积极阻止您使用该方法（出于安全原因），这是正确的。我看到两种对您很有效的解决方案。

1.  使用表单只发送一个查询字符串（即 DC）并在服务器端确定“类型”的值应该是什么。如果将两个值都作为查询字符串非常非常重要（例如，您正在重新使用仅查看这些查询字符串的控件），则在服务器端使用 Server.Transfer 添加其他查询字符串.

2.  在表单上提供两种类型的输入。一个是您在那里的选择框，另一个是隐藏的选择框、隐藏的输入字段或其他适合您的东西。将 Javascript 添加到页面，以便在可见选择框上更改选择时将隐藏字段设置为正确的值，然后在提交表单时，两个输入都只提交一个查询字符串，因为浏览器旨在支持.

这是选择＃2的实现：

```
<script type="text/javascript">
var DCMapping = new Array();
DCMapping["1"] = "type1";
DCMapping["2"] = "type2";
DCMapping["3"] = "type3";
DCMapping["4"] = "type4";
DCMapping["5"] = "type5";
DCMapping["6"] = "type6";
DCMapping["7"] = "type7";
function selectionChanged(selectBox)
{
    alert(DCMapping[selectBox.value]);
    document.getElementById('hidType').value = DCMapping[selectBox.value];
}
</script>
<form name="input" method="get" action="http://site:8083/Default.aspx" target="foo" 
    onSubmit="window.open('', 'foo', 'width=1100 height=500,status=no,resizable=yes,scrollbars=yes')">
    <select name="DC" onchange="selectionChanged(this)">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
    </select>
    <input type="hidden" name="Type" id="hidType" value="1" />
    <input type="submit" value=">>"/>&nbsp;&nbsp;
</form> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T15:14:38.183

尝试使用：

`HttpUtility.UrlDecode()`

[进一步阅读](http://msdn.microsoft.com/en-us/library/system.web.httputility.urldecode.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T14:59:39.540

...这是正确的。请求参数 [get] 应该被编码。当您收到请求时，您的服务器应该解码它们 [apache/php] 或者我不知道 ASP 但在 php 中它提供了一个名为 urldecode() 的函数 ...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-31T10:54:01.027

你应该使用：

`HttpUtility.UrlDecode();`

转换 url 中的转义字符

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-07-05T15:04:24.213

您可以从`<form>`. 而是扩展 JavaScript/VBScript 以获取所选选项的值并将其与 url 根连接。

您不需要弄乱 url 解码，%.. 应该可以正常工作。

# c - how do I perform shifts in c without losing bits?

> ID：11346893
> 
> 赞同：3
> 
> 时间：2012-07-05T14:53:01.063
> 
> 标签：c, operators, shift

In C when you do something like this:

```
char var = 1;

while(1)
{
  var = var << 1;
} 
```

In the 8th iteration the "<<" operator will shift out the 1 and var will be 0\. I need to perform a shift in order to mantain the bit shifting. In other words I need this:

initial ----- 00000001

1st shift -- 00000010

2nd shift - 00000100

3rd shift - 00001000

4th shift - 00010000

5th shift -- 00100000

6th shift -- 01000000

7th shift - 10000000

8th shift - 00000001 (At the 8th shift the one automatically start again)

Is there something equivalent to "<<" but to achieve this?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T14:54:30.350

This is known as a [*circular shift*](http://en.wikipedia.org/wiki/Circular_shift), but C doesn't offer this functionality at the language level.

You will either have to implement this yourself, or resort to inline assembler routines, assuming your platform natively has such an instruction.

For example:

```
var = (var << 1) | (var >> 7); 
```

(This is not well-defined for negative `signed` types, though, so you'd have to change your example to `unsigned char`.)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:55:14.457

是的，您可以使用[循环移位](http://en.wikipedia.org/wiki/Circular_shift)。（虽然它不是内置的 C 操作，但它是x86 CPU 上的[CPU 指令）](http://en.wikibooks.org/wiki/X86_Assembly/Shift_and_Rotate#Rotate_Instructions)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T15:09:42.267

所以你想做一点旋转，也就是循环移位。

```
#include <limits.h>   // Needed for CHAR_BIT

// positive numbits -> right rotate, negative numbits -> left rotate
#define ROTATE(type, var, numbits) ((numbits) >= 0 ? \
                                    (var) >> (numbits) | (var) << (CHAR_BIT * sizeof(type) - (numbits)) : \
                                    (var) << -(numbits) | (var) >> (CHAR_BIT * sizeof(type) + (numbits))) 
```

As`sizeof()`返回大小为`char`( `sizeof(char) == 1`) 大小的倍数，并`CHAR_BIT`指示 a 中的位数`char`（虽然通常为 8，但不一定是），`CHAR_BIT * sizeof(x)`将为您提供`x`以位数为单位的大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T14:56:45.680

这称为循环移位。有英特尔 x86 汇编指令可以做到这一点，但除非性能真的是一个巨大的问题，否则你最好使用这样的东西：

```
int i = 0x42;
int by = 13;
int shifted = i << by | i >> ((sizeof(int) * 8) - by); 
```

如果您发现自己真的需要性能，您可以使用内联汇编直接使用指令（可能。我从来没有非常需要它来尝试）。

同样重要的是要注意，如果您要移动的位置超过数据类型的大小，则需要进行额外检查以确保不会过度移动。使用`by = 48`可能会导致 shift 接收值 0，尽管这种行为可能是特定于平台的（即像瘟疫一样要避免的事情），因为如果我没记错的话，一些平台会自动执行此屏蔽，而其他平台则不会。

# node.js - How to structure module to be closer/adhere to Node.js philosophy

> ID：11346895
> 
> 赞同：2
> 
> 时间：2012-07-05T14:53:03.797
> 
> 标签：node.js, node-modules

I am relatively new to Node.js and I am trying to get more familiar with it by writing a simple module. The module's purpose is take an id, scrape a website and return an array of dictionaries with the data.

The data on the website is scattered across pages whereas every page is accessed by a different index number in the URI. I've defined a function that takes the `id` and `page_number`, scrapes the website via `http.request()` for this `page_number` and on `end` event the data is passed to another function that applies some RegEx to get the data in a structured way.

In order for the module to have complete functionality, all the available `page_nums` of the website should be scraped.

Is it ok by Node.js style/philosophy to create a standard for() loop to call the scraping function for every page, aggregate the results of every return and then return them all in once from the exported function?

**EDIT**

I figured out a solution based on help from #node.js on freenode. You can find the working code at [http://github.com/attheodo/katina_node](http://github.com/attheodo/katina_node)

Thank you all for the comments.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:07:28.887

The common method, if you don't want to bother with one of the libraries mentioned by @ControlAltDel, is to to set a counter equal to the number of pages. As each page is processed (ansynchronously so you don't know in what order, nor do you care), you decrement the counter. When the counter is zero, you know you've processed all pages and can move on to the next part of the process.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:53:55.827

借助 Freenode 上#node.js 的有用评论，我设法按照 Node.js 理念的要求，通过顺序调用抓取函数并附加回调来找到解决方案。

你可以在这里找到代码：[https ://github.com/attheodo/katina_node/blob/master/lib/katina.js](https://github.com/attheodo/katina_node/blob/master/lib/katina.js)

感兴趣的代码块位于第 87 行和第 114 行之间。

谢谢你们

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:00:32.697

您可能会遇到的问题是重新组合所有聚合结果。有几个库可以提供帮助，包括 Async 和 Step。或者你可以使用像 Fibers.Promise 这样的 Promise 库。但后者并不是真正的节点哲学，需要直接更改/添加节点可执行文件。

# javascript - Using Keyup Event Globally

> ID：11346896
> 
> 赞同：5
> 
> 时间：2012-07-05T14:53:04.483
> 
> 标签：javascript, asp.net, html, javascript-events

How would I go about using JavaScript on my webpage page to call a function anytime there is a keyup event globally, so it isn't attached to textbox. I need it to work for every key on the keyboard. I am very new to JavaScript and having a lot of trouble interpreting the documentation

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T14:55:45.713

**jQuery**

```
$(document).keyup(function() {}); 
```

**Javascript**

```
document.onkeyup = function(event) {} 
```

# java - Issues with using too many Threads a benchmark program

> ID：11346899
> 
> 赞同：1
> 
> 时间：2012-07-05T14:53:22.407
> 
> 标签：java, multithreading, benchmarking, multicore

I've programmed a (very simple) benchmark in Java. It simply increments a double value up to a specified value and takes the time.

When I use this singlethreaded or with a low amount of threads (up to 100) on my 6-core desktop, the benchmark returns reasonable and repeatable results.

But when I use for example 1200 threads, the average multicore duration is significantly lower than the singlecore duration (about 10 times or more). I've made sure that the total amount of incrementations is the same, no matter how much threads I use.

Why does the performance drop so much with more threads? Is there a trick to solve this problem?

I'm posting my source, but I don't think, that there is a problem.

Benchmark.java:

```
package sibbo.benchmark;

import java.text.DecimalFormat;
import java.util.LinkedList;
import java.util.List;

public class Benchmark implements TestFinishedListener {
            private static final double TARGET = 1e10;
    private static final int THREAD_MULTIPLICATOR = 2;

    public static void main(String[] args) throws InterruptedException {
        Benchmark b = new Benchmark(TARGET);
        b.start();
    }

    private int coreCount;
    private List<Worker> workers = new LinkedList<>();
    private List<Worker> finishedWorkers = new LinkedList<>();
    private double target;

    public Benchmark(double target) {
        this.target = target;
        getSystemInfos();
        printInfos();
    }

    private void getSystemInfos() {
        coreCount = Runtime.getRuntime().availableProcessors();
    }

    private void printInfos() {
        System.out.println("Usable cores: " + coreCount);
        System.out.println("Multicore threads: " + coreCount *                 THREAD_MULTIPLICATOR);
        System.out.println("Loops per core: " + new DecimalFormat("###,###,###,###,##0").format(TARGET));

        System.out.println();
    }

    public synchronized void start() throws InterruptedException {
        Thread.currentThread().setPriority(Thread.MAX_PRIORITY);

        System.out.print("Initializing singlecore benchmark... ");
        Worker w = new Worker(this, 0);
        workers.add(w);

        Thread.sleep(1000);
        System.out.println("finished");

        System.out.print("Running singlecore benchmark... ");
        w.runBenchmark(target);
        wait();

        System.out.println("finished");
        printResult();

        System.out.println();
        // Multicore
        System.out.print("Initializing multicore benchmark...  ");
        finishedWorkers.clear();

        for (int i = 0; i < coreCount * THREAD_MULTIPLICATOR; i++) {
            workers.add(new Worker(this, i));
        }

        Thread.sleep(1000);
        System.out.println("finished");

        System.out.print("Running multicore benchmark...  ");

        for (Worker worker : workers) {
            worker.runBenchmark(target / THREAD_MULTIPLICATOR);
        }

        wait();

        System.out.println("finished");
        printResult();

        Thread.currentThread().setPriority(Thread.NORM_PRIORITY);
    }

    private void printResult() {
        DecimalFormat df = new DecimalFormat("###,###,###,##0.000");

        long min = -1, av = 0, max = -1;
        int threadCount = 0;
        boolean once = true;

        System.out.println("Result:");

        for (Worker w : finishedWorkers) {
            if (once) {
                once = false;

                min = w.getTime();
                max = w.getTime();
            }

            if (w.getTime() > max) {
                max = w.getTime();
            }

            if (w.getTime() < min) {
                min = w.getTime();
            }

            threadCount++;
            av += w.getTime();

            if (finishedWorkers.size() <= 6) {
                System.out.println("Worker " + w.getId() + ": " + df.format(w.getTime() / 1e9) + "s");
            }
        }

        System.out.println("Min: " + df.format(min / 1e9) + "s, Max: " + df.format(max / 1e9) + "s, Av per Thread: "
                + df.format((double) av / threadCount / 1e9) + "s");
    }

    @Override
    public synchronized void testFinished(Worker w) {
        workers.remove(w);
        finishedWorkers.add(w);

        if (workers.isEmpty()) {
            notify();
        }
    }
} 
```

Worker.java:

```
package sibbo.benchmark;

public class Worker implements Runnable {
    private double value = 0;
    private long time;
    private double target;
    private TestFinishedListener l;
    private final int id;

    public Worker(TestFinishedListener l, int id) {
        this.l = l;
        this.id = id;

        new Thread(this).start();
    }

    public int getId() {
        return id;
    }

    public synchronized void runBenchmark(double target) {
        this.target = target;
        notify();
    }

    public long getTime() {
        return time;
    }

    @Override
    public void run() {
        synWait();
        value = 0;
        long startTime = System.nanoTime();

        while (value < target) {
            value++;
        }

        long endTime = System.nanoTime();
        time = endTime - startTime;

        l.testFinished(this);
    }

    private synchronized void synWait() {
        try {
            wait();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T15:04:07.643

您需要了解操作系统（或 Java 线程调度程序，或两者兼有）正在尝试在应用程序中的所有线程之间进行平衡，以使它们都有机会执行某些工作，并且在两者之间切换的成本非零线程。使用 1200 个线程，您刚刚达到（并且可能远远超过）处理器在上下文切换上花费的时间比实际工作更多的临界点。

这是一个粗略的类比：

你在 A 房间有一项工作要做。你每天在 A 房间站 8 个小时，然后做你的工作。

然后你的老板过来告诉你，你也必须在 B 房间做一份工作。现在你需要定期离开房间 A，沿着大厅走到 B 房间，然后再走回去。每天步行需要1分钟。现在，您花费 3 小时 59.5 分钟完成每项工作，并在房间之间走动一分钟。

现在假设您有 1200 个房间要工作。您将花费更多时间在房间之间走动，而不是实际工作。这是您将处理器放入的情况。它花费了大量时间在上下文之间切换，以至于没有完成任何实际工作。

编辑：现在，根据下面的评论，也许您在继续之前在每个房间中花费了固定的时间 - 您的工作会有所进展，但房间之间的上下文切换次数仍然会影响单个任务的整体运行时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:26:47.880

好的，我想我已经找到了我的问题，但直到现在，还没有解决方案。

在测量每个线程运行以完成其部分工作的时间时，不同的线程总数有不同的可能最小值。最大值每次都相同。如果线程首先启动，然后经常暂停并最后完成。例如，这个最大值可以是 10 秒。假设每个线程完成的操作总量保持不变，那么无论我使用多少线程，当使用不同数量的线程时，必须更改单个线程完成的操作量。例如，使用一个线程，它必须执行 1000 次操作，但使用十个线程，每个人只需执行 100 次操作。现在，使用十个线程，一个线程可以使用的最短时间远低于使用一个线程。所以计算每个线程完成工作所需的平均时间是无稽之谈。使用十个线程的最小值为 1 秒。如果一个线程不间断地工作，就会发生这种情况。

**编辑**

解决方案是简单地测量第一个线程开始和最后一个线程完成之间的时间量。

# javascript - submit is not working after adding a code to prevent double submit JQuery

> ID：11346904
> 
> 赞同：1
> 
> 时间：2012-07-05T14:53:39.693
> 
> 标签：javascript, jquery, jquery-ui

[jsFiddle example](http://jsfiddle.net/abude/TKtKq/1/)

before i added the line:

```
$('form').submit(function(){
    $('input[type=submit]', this).attr('disabled', 'disabled');
}); 
```

was working(sending the info with the post) , after i added that disable stuff to prevent double clicking, the form won't send the info but the disable is working and FORM **not**

please tell me, did i added wrong the line 5 ? should i add the disable code in another place ?

**STILL NO SOLUTION !**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T14:56:14.317

您必须返回 true，才能执行提交：

```
$('form').submit(function(){
    $('input[type=submit]', this).attr('disabled', 'disabled');
    return true;
}); 
```

检查[jQuery submit](http://api.jquery.com/submit/)，它说：

> 这发生在实际提交之前，因此我们可以通过在事件对象上调用 .preventDefault() 或从我们的处理程序返回 false 来取消提交操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:00:32.070

你的问题是：

```
 onclick="return checkDuplicateMessage()" 
```

不要将 jQuery 和内联事件处理程序结合起来。

相反，去：

```
$('form').submit(function() {
    //cancel the submit if there's a duplicate
    if(!checkDuplicateMessage())
        return false;

    $(this).find('input[type=submit]').prop('disabled', true);
}); 
```

# algorithm - What data structure would be best to check if value is between a and b defining block boundaries

> ID：11346905
> 
> 赞同：2
> 
> 时间：2012-07-05T14:53:39.973
> 
> 标签：algorithm, data-structures

I have the following table:

block | start | end

> 1 | 1 | 4
> 
> 2 | 5 | 9
> 
> 3 | 10 | 20
> 
> 4 | 21 | 50
> 
> ..........
> 
> n | 1000 | 2000

When given a value to variable c i have to search which block contains c ( start < c < end ). For example when c = 1001, c is in block n. What data structure would be the most efficient?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:31:14.680

如果您的整数的整个范围是唯一的`1..2000`，您可以将您的数据视为如下表格：

```
n   block
1   1
2   1
3   1
4   0
5   0
6   2
.
.
. 
```

您可以将其实现为 2000 个元素的向量。简单查找`n`向量中的元素将告诉您哪个块`n`在其中（除非您选择使用基于 0 的索引的语言来实现，在这种情况下元素`n`会告诉您哪个块整数`n+1`在）。在这里，我使用 0 表示“无阻塞”。

与这里的其他一些答案相比，这以空间换时间，但这通常是可以接受的权衡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:46:59.047

[区间树](http://en.wikipedia.org/wiki/Interval_tree)或[段树](http://en.wikipedia.org/wiki/Segment_tree)会起作用。本质上，您可以通过区间进行二分搜索以找到包含问题点的区间。由于 Segment Tree 更擅长刺探查询，因此我会首先尝试。

如果您使用的是 Java，我之前已经在 java 中实现了它们。您可以在此处找到[区间树](http://code.google.com/p/java-algorithms-implementation/source/browse/src/com/jwetherell/algorithms/data_structures/IntervalTree.java)和在此处找到[段树](http://code.google.com/p/java-algorithms-implementation/source/browse/src/com/jwetherell/algorithms/data_structures/SegmentTree.java)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T15:47:59.063

我认为，[区间树](http://en.wikipedia.org/wiki/Interval_tree)非常适合这个问题。它肯定比表格更难实现，如果您不需要动态添加块，我建议只保留表格并使用简单的二进制搜索来查找块。这应该达到与间隔树相同的效率，而没有所有可怕的编码痛苦（只要您不必添加间隔）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T14:59:08.110

我不确定你在问什么

我相信有很多方法可以实现这样的块，我个人会有一个包含每个块结尾的排序列表并运行它直到结尾大于值，索引给我块的数量

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T15:00:19.623

对于这个特定的示例，您可以将 start 存储在一个数组中（按排序顺序）并进行二进制搜索以到达适当的块。

编辑解释示例：

在起始数组中，您有 1,5,10,21,1000，因此对于 c=3，您知道它在块 1 中，因为 5 是块 2 的起始索引。

出于某种原因，如果您还想查看 end 那么您可以将其存储在另一个数组中，并从您从二进制搜索中获得的索引访问 start 的结尾。

# logging - 归档的 evtx 文件存储在哪里？

> ID：11346915
> 
> 赞同：6
> 
> 时间：2012-07-05T14:54:17.587
> 
> 标签：logging, event-viewer

我知道您可以在事件查看器中查看任何 evtx 文件，但是当您使用选项将它们归档时，它们存储在哪个文件夹中？

我知道我可以在 C:\Windows\System32\winevt\Logs 中找到我所有的 evtx 文件，但是当我进入该文件夹时，我看不到任何存档文件。再说一次，我认为我的日志还没有填满，甚至无法归档任何内容。

我在我的桌面上运行 Windows 7 Home 和 Windows 7 Professional。我想知道这两者之间是否有任何区别。

另外，这些文件只是命名为 Archive-* 吗？意思是归档这个词，然后是它们来自的任何东西（安全性、应用程序等......）

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-10T11:30:06.923

你快要回答了。默认情况下，事件日志被归档到`%System32%\winevt\Logs`文件夹中。它们的名称由下一个模板组成：

```
Archive + <Event log name> + <Date> + <Time>.evtx 
```

您只能通过更改实际日志文件的路径来更改备份日志的路径。因为 atchived 日志与实际日志文件放在同一个文件夹中。

# android - ListPreference: use string-array as Entry and integer-array as Entry Values doesn't work

> ID：11346916
> 
> 赞同：78
> 
> 时间：2012-07-05T14:54:24.027
> 
> 标签：android, listpreference

I'm using in a settings.xml file a ListPreference. I want to show the user a list of 3 options to select. When the user chooses one of the options in the Settings, I get this error:

```
java.lang.NullPointerException
    at android.preference.ListPreference.onDialogClosed(ListPreference.java:264)
    at android.preference.DialogPreference.onDismiss(DialogPreference.java:381)
    at android.app.Dialog$ListenersHandler.handleMessage(Dialog.java:1228)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:4424)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    at dalvik.system.NativeStart.main(Native Method) 
```

This is the code of the ListPreference:

```
<ListPreference
    android:entries="@array/date_alignement"
    android:entryValues="@array/date_alignement_values"
    android:key="settings_date_alignement"
    android:summary="@string/settings_date_alignement_summary"
    android:title="@string/settings_date_alignement_title" /> 
```

And here are the arrays I use to populate the entries:

```
<string-array name="date_alignement">
    <item>"Top"</item>
    <item>"Center"</item>
    <item>"Bottom"</item>
</string-array>
<integer-array name="date_alignement_values">
    <item >0</item>
    <item >1</item>
    <item >2</item>
</integer-array> 
```

In my onSharedPreferenceChanged I use those values in this way:

```
@Override
public void onSharedPreferenceChanged(
            SharedPreferences sharedPreferences, String key) {          

        //Text
        mAlignment =  mPrefs.getInt(PREF_ALIGNMENT, 1);
        switch (mAlignment) {
        case 0:
            offsetY = mHeight/3.0f;
            break;

        case 2:
            offsetY = mHeight*2.0f/3.0f;
            break;

        default:
            offsetY = mHeight/2.0f;
            break;
        }
} 
```

If I use another string-array for the **entryValues** it works. For example if I use the same string array as values and entries:

```
 android:entries="@array/date_alignement"
    android:entryValues="@array/date_alignement" 
```

then I have to change my code a little but it works:

```
 if(mAlignment.equalsIgnoreCase("center")) {
            offsetY = mHeight/2.0f;
        } else if(mAlignment.equalsIgnoreCase("top")) {
            offsetY = mHeight/3.0f;
        } else if(mAlignment.equalsIgnoreCase("bottom")) {
            offsetY = mHeight*2.0f/3.0f;
        } 
```

Why I can't use a string-array and an integer-array for a ListPreference entries and values?

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-07-05T15:03:55.423

答案很简单：因为 Android 就是这样设计的。它只是`String`为条目和条目值使用数组，仅此而已。而且我看不出有任何问题，因为您可以使用该方法轻松地将 a 转换`String`为a 。希望这可以帮助。`int``Integer.parseInt()`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-04-27T00:03:50.983

您可以将您的条目值转换为字符串以保持`ListPreference`快乐，然后`int`在与持久数据存储交谈时将它们转换为 s。

1.  设置条目值时，使用字符串而不是整数：`"1", "2", "3"`等
2.  自定义`IntListPreference`将值保留为整数
3.  在您的`preferences.xml`文件中，将 更改`<ListPreference>`为`<your.app.package.IntListPreference>`

### IntListPreference.java

这是一个示例实现。在 AndroidX Preference 1.0.0 上测试并运行。

```
public class IntListPreference extends ListPreference {

    public IntListPreference(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes) {
        super(context, attrs, defStyleAttr, defStyleRes);
    }

    public IntListPreference(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    public IntListPreference(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public IntListPreference(Context context) {
        super(context);
    }

    @Override
    protected boolean persistString(String value) {
        int intValue = Integer.parseInt(value);
        return persistInt(intValue);
    }

    @Override
    protected String getPersistedString(String defaultReturnValue) {
        int intValue;

        if (defaultReturnValue != null) {
            int intDefaultReturnValue = Integer.parseInt(defaultReturnValue);
            intValue = getPersistedInt(intDefaultReturnValue);
        } else {
            // We haven't been given a default return value, but we need to specify one when retrieving the value

            if (getPersistedInt(0) == getPersistedInt(1)) {
                // The default value is being ignored, so we're good to go
                intValue = getPersistedInt(0);
            } else {
                throw new IllegalArgumentException("Cannot get an int without a default return value");
            }
        }

        return Integer.toString(intValue);
    }

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-11-22T15:39:00.473

答案列在[List Preference Documentation](https://developer.android.com/reference/android/preference/ListPreference.html#attr_android:entryValues)中。

```
int findIndexOfValue (String value) 
```

将返回给定值的索引，并且参数被视为一个字符串，因此 entryValues 数组应该是一个字符串数组来完成这项工作。

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2017-12-25T12:12:02.900

以下对我有用：

```
String objectName = prefs.getString("listPrefMelodyYd1", "");
switch (objectName.toUpperCase()) {
    case "1":
        playSound(catSound);
        break;
    case "2":
        playSound(dogSound);
        break;
    case "3":
        playSound(cowSound);
        break;
} 
```

# android - Android C2DM 已完成项目

> ID：11346924
> 
> 赞同：0
> 
> 时间：2012-07-05T14:54:37.307
> 
> 标签：android

我正在开发一个必须使用 C2DM 的 Android 项目。我需要一个 C2DM 示例项目或源代码。请任何人帮我完成项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:58:01.417

正如您在本文中看到的：

[https://developers.google.com/android/c2dm/](https://developers.google.com/android/c2dm/)

如果您还没有在项目中使用 C2DM 类，我建议您查看 Google 提供的新系统。

[http://developer.android.com/guide/google/gcm/index.html](http://developer.android.com/guide/google/gcm/index.html)

这是一个简单的示例项目：

[http://developer.android.com/guide/google/gcm/demo.html](http://developer.android.com/guide/google/gcm/demo.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T02:14:46.387

请参阅[本](http://www.vogella.com/articles/AndroidCloudToDeviceMessaging/article.html)教程 注意 C2DM 将不再受支持，因为它已被弃用。移至[GCM](http://developer.android.com/guide/google/gcm/index.html)

# java - wcf 服务在 java 项目中运行良好，但在 android 项目中失败

> ID：11346926
> 
> 赞同：1
> 
> 时间：2012-07-05T14:54:47.023
> 
> 标签：java, android, wcf

我已经建立了一个 wcf 网络服务。当我在使用 eclipse 构建的 java 项目中使用此服务时，它运行良好，但是当我尝试在 android 项目中使用它时，它会出现异常。

这是我在java项目中使用它的方式。

第一步：使用 wsimport 创建目录 org 和 com 并将其包含在 java 项目的 src 文件夹中。

第2步：添加文件夹“metro”的子文件夹“lib”中的外部jar（这个文件夹实际上是指我安装metro框架的文件夹）。对于这个 goto project->properties->Java Build Path->Libraries->Add external jars，然后浏览并选择这些 jar 文件。

第 3 步：创建一个新类以与 Web 服务进行通信。这是我正在使用的课程。

```
import java.net.URL;
import javax.xml.namespace.QName;
import javax.xml.ws.BindingProvider;
import org.tempuri.IService1;
import org.tempuri.Service1;

public class JavaClient {
    public static void main(String[] strArgs)
    {

    try
    {
        Service1 service1 = new Service1(new URL("http://192.168.1.18/WcfService/Service1.svc?wsdl"), new QName("http://tempuri.org/", "Service1"));
        IService1 port = service1.getBasicHttpBindingIService1();
        ((BindingProvider)port).getRequestContext().put(BindingProvider.ENDPOINT_ADDRESS_PROPERTY, "http://192.168.1.18/WcfService/Service1.svc");
        int input = 100;
        String strOutput = port.getData(input);
        System.out.println(strOutput);
    }
    catch(Exception e)
    {
        e.printStackTrace();
    }

    }
} 
```

现在，当我运行这个 java 项目时，它运行成功。

现在我想对一个 android 项目做同样的事情。因此，以与上述相同的方式，我创建了一个使用 android 平台 2.2 作为构建目标的 android 项目，然后按照上述步骤 1 和步骤 2 进行操作。此后，我创建了一个具有以下代码的类。

```
package android.client;

import java.net.URL;
import javax.xml.namespace.QName;
import javax.xml.ws.BindingProvider;
import org.tempuri.IService1;
import org.tempuri.Service1;
import android.app.Activity;
import android.os.Bundle;
import android.widget.Toast;

public class AndroidClientJavaServerActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        try
        {

            Service1 service1 = new Service1(new URL("http://192.168.1.18/WcfService/Service1.svc?wsdl"), new QName("http://tempuri.org/", "Service1"));
            IService1 port = service1.getBasicHttpBindingIService1();
            ((BindingProvider)port).getRequestContext().put(BindingProvider.ENDPOINT_ADDRESS_PROPERTY, "http://192.168.1.18/WcfService/Service1.svc");
            int input = 100;
            String strOutput = port.getData(input);
            Toast msg = Toast.makeText(getBaseContext(),
                    strOutput, Toast.LENGTH_LONG);
            msg.show();
       }
        catch(Exception e)
        {
            e.printStackTrace();
        }
    }
} 
```

之后，当我运行这个 android 项目时，应用程序无法成功执行。这是运行这个 android 应用程序的详细输出。

```
07-05 19:50:24.864: W/dalvikvm(279): Unable to resolve superclass of Lorg/tempuri/Service1; (68)
07-05 19:50:24.864: W/dalvikvm(279): Link of class 'Lorg/tempuri/Service1;' failed
07-05 19:50:24.864: E/dalvikvm(279): Could not find class 'org.tempuri.Service1', referenced from method android.client.AndroidClientJavaServerActivity.onCreate
07-05 19:50:24.864: W/dalvikvm(279): VFY: unable to resolve new-instance 85 (Lorg/tempuri/Service1;) in Landroid/client/AndroidClientJavaServerActivity;
07-05 19:50:24.864: D/dalvikvm(279): VFY: replacing opcode 0x22 at 0x0008
07-05 19:50:24.864: D/dalvikvm(279): VFY: dead code 0x000a-0045 in Landroid/client/AndroidClientJavaServerActivity;.onCreate (Landroid/os/Bundle;)V
07-05 19:50:25.044: D/AndroidRuntime(279): Shutting down VM
07-05 19:50:25.081: W/dalvikvm(279): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
07-05 19:50:25.124: E/AndroidRuntime(279): FATAL EXCEPTION: main
07-05 19:50:25.124: E/AndroidRuntime(279): java.lang.NoClassDefFoundError: org.tempuri.Service1
07-05 19:50:25.124: E/AndroidRuntime(279):  at android.client.AndroidClientJavaServerActivity.onCreate(AndroidClientJavaServerActivity.java:21)
07-05 19:50:25.124: E/AndroidRuntime(279):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
07-05 19:50:25.124: E/AndroidRuntime(279):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
07-05 19:50:25.124: E/AndroidRuntime(279):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
07-05 19:50:25.124: E/AndroidRuntime(279):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
07-05 19:50:25.124: E/AndroidRuntime(279):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
07-05 19:50:25.124: E/AndroidRuntime(279):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-05 19:50:25.124: E/AndroidRuntime(279):  at android.os.Looper.loop(Looper.java:123)
07-05 19:50:25.124: E/AndroidRuntime(279):  at android.app.ActivityThread.main(ActivityThread.java:4627)
07-05 19:50:25.124: E/AndroidRuntime(279):  at java.lang.reflect.Method.invokeNative(Native Method)
07-05 19:50:25.124: E/AndroidRuntime(279):  at java.lang.reflect.Method.invoke(Method.java:521)
07-05 19:50:25.124: E/AndroidRuntime(279):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-05 19:50:25.124: E/AndroidRuntime(279):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
07-05 19:50:25.124: E/AndroidRuntime(279):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T05:51:03.737

可能你需要看看这个帖子！ [http://tools.android.com/recent/dealingwithdependenciesinandroidprojects](http://tools.android.com/recent/dealingwithdependenciesinandroidprojects)

# jquery - jQuery检查文本是否到达边界

> ID：11346929
> 
> 赞同：2
> 
> 时间：2012-07-05T14:54:58.147
> 
> 标签：jquery, text, border

我有一个文本框，可以在 div 中的任何位置拖动（见下图）。

问题是我希望它在文本接近边界时提醒我。例如，用户开始输入并且文本碰到右边框，因此应该弹出警告说用户必须拖动框才能继续输入。有没有功能或方法可以做到这一点？![在此处输入图像描述](../Images/03f39fe71b1c20f67473cd49d988be4a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:08:16.223

如果文本框宽度不固定，那么您可以在 keyUp 上检查其宽度：

```
$('#textBox').keyup(function() {
  var $dragBox = $('#dragBox');
  var $textBox = $('#textBox');
  var dragBoxRightSide = $dragBox.width() + $dragBox.offset().left;
  var textBoxRightSide = $textBox.width() + $textBox.offset().left;

  if ( dragBoxRightSide < textBoxRightSide ) {
    alert('WTF?');
  }
}); 
```

# c - 如何通过makefile包含头文件

> ID：11346935
> 
> 赞同：5
> 
> 时间：2012-07-05T14:55:08.223
> 
> 标签：c, linux, gcc, makefile

我知道可以在 makefile 中使用一个标志来在所有正在编译的文件中包含一个头文件，就像有一个 -D 标志来包含一个定义一样。包含头文件的确切标志是什么。我不记得知道。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-05T15:01:25.697

在您的编译命令中，您可以使用以下`-include`选项：

```
gcc -o main -include hello.h main.cpp 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:59:51.077

像这样的东西？包含目录（${CMAKE_CURRENT_SOURCE_DIR}/include）

# permissions - 使用 WIX 安装程序安装期间无法删除已部署的文件

> ID：11346936
> 
> 赞同：0
> 
> 时间：2012-07-05T14:55:08.753
> 
> 标签：permissions, installation, wix, custom-action

在我们的 WIX 安装程序项目中，我们需要生成一个新文件，我们称之为 FileB，基于已部署的文件，在托管自定义操作函数中称为 FileA。换句话说，在组件声明中，我声明了 FileA。在自定义操作中（发生在提交阶段），我需要基于 FileA 生成 FileB。之后，由于 FileA 不再使用，我想在同一个自定义操作中将其删除。

问题来了：使用默认安装文件夹，即 Program Files，普通用户不允许在自定义操作中将文件（生成 FileB）添加到此文件夹中（我不是 100% 确定我是对的，但它在我的测试中是这样的。如果我将它安装在另一个文件夹中，则完全没有问题）。所以我认为我需要授予创建文件的权限。为此，我向包含 FileA 的组件添加了一个 CreateFolder 元素。整个组件声明是这样的：

```
<Component Id='COMPONENT_NAME' Guid='MY_GUID'>
    <!--OTHER FILES IN THE COMPONENT-->
    ...
    <CreateFolder Directory='INSTALLDIR'>
      <Permission CreateFile='yes' User='Everyone' GenericAll='yes' Delete='yes'/>
    </CreateFolder>
    <File Id='MyFileA' Name='FileA'   Source='PATH_TO_FILEA' KeyPath='no' >
      <Permission GenericAll='yes' User='Everyone' Delete='yes'/>
    </File>
  </Component> 
```

该组件实际上属于一个组件组，该组位于 INSTALLDIR 中。同一组件元素中还有其他文件的原因是因为我希望另一个 File 作为 keypath，因此删除 FileA 不会导致问题。现在 FileB 的生成工作正常。但后来在同一个自定义操作中，我在删除 FileA 时遇到了问题。它只是说“：拒绝访问路径'DEPLOYMENT_PATH_TO_FILEA'。” 我认为问题出在 FileA 声明中，这就是为什么我在 File 下的 Permission 元素中添加了 Delete='yes' ，希望可以删除它（虽然我不确定这是否意味着在安装中可以删除）。但我仍然收到此错误。谁能告诉我我做错了什么？

另一个问题是，我真的不知道那些 CreatFolder 元素的目的是什么。一方面：如果目标是创建目录结构，我认为（嵌套）目录元素已经做到了。以及为什么在大多数时候您可能希望目录结构与组件结构分开时在 Component 元素下有这样的元素（组件只是使用目录引用来引用正确的目录）。其次，CreateFolder 的默认 Directory 属性是组件所在的父目录。但是通常不止一个组件位于同一个目录中，就像我这里的一样：多个组件在同一个组件组中，其目录对 INSTALLDIR 的元素引用。所以这些组件中只有一个具有 CreateFolder 元素，在我的例子中，它的 Directory 属性是所有这些组件的父目录。这种结构真的很难理解。我想我对 CreateFolder 元素有一些误解。有人可以启发我使用 CreateFolder 吗？谢谢！

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T23:15:32.593

这里有很多问题需要解决。首先，您应该知道，如果禁用回滚，则不会执行提交阶段自定义操作。你真的应该有一个延迟和回滚的自定义操作。

其次，您不能告诉 MSI 安装文件然后删除它。这会适得其反，只会导致以后出现维修问题。更好的解决方案（我假设您使用的是 WiX DTF 托管的自定义操作）是将 FileA 作为内容项包含在自定义操作项目中。这将导致文件在执行时存在于自定义操作的当前（临时）目录中。然后，您可以生成 fileb。对于回滚，您可以删除 fileb。

您还需要创作一个 RemoveFile 元素来教 MSI 在卸载时删除文件。否则它不会，因为 MSI 不知道有关您的进程外自定义操作创建的 fileb 的任何信息。

否则，了解 fileb 的内容是很有用的。如果这是一个 xml 文件，可以作为 fileb 安装，然后使用 xml wix 扩展名进行转换，则实现起来会更容易。

# android - Android新应用（注册流程）

> ID：11346938
> 
> 赞同：0
> 
> 时间：2012-07-05T14:55:12.593
> 
> 标签：android

我构建了一个使用用户名/密码/电话号码注册用户的 android 应用程序。

如果用户在数据库中注册，他可以看到应用程序的其他菜单。

如何检查用户是否在应用程序上注册？有什么好的方法（建议注册流程或应用程序菜单）？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:49:07.297

我建议您使用 JSON 方法，您必须添加 php 文件才能将数据从 android 应用程序发送到您的数据库（您将进行插入以进行注册，或者只是为现有用户进行选择php 文件）然后 JSON 方法将数据取回到 android 并返回 TRUE 或 false 我知道这很模糊，但有很多关于这种方法的教程。希望它有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T17:23:43.750

当您刚刚说信息存储在数据库中时，我不完全确定您所说的“我如何检查用户是否已注册”是什么意思。

所以...根据您提供的信息，您可以做几件事：

1.  检查数据库以查看用户是否存在/已注册。
2.  使用 SharePreferences 存储一个变量，说明用户是否已注册，然后根据该信息进行操作：http: [//developer.android.com/reference/android/content/SharedPreferences.html](http://developer.android.com/reference/android/content/SharedPreferences.html)

# ios - 为什么我的搜索结果不会链接到我的详细视图？

> ID：11346941
> 
> 赞同：1
> 
> 时间：2012-07-05T14:55:15.510
> 
> 标签：ios, xcode, uitableview, uisearchbar, detailsview

我有一个带有搜索栏的 UITableView，搜索栏可以工作，但结果不会链接到我的详细视图。下面的代码：

```
#import "firstTableViewController.h"
#import "detailViewCell.h"
#import "DetailViewController.h"

@interface firstTableViewController ()

@end

@implementation firstTableViewController
@synthesize craftingItems1;
@synthesize bigImages;
@synthesize theText;

@synthesize searchDisplayController;
@synthesize searchResults;

- (id)initWithStyle:(UITableViewStyle)style
{
self = [super initWithStyle:style];
if (self) {
    // Custom initialization
}
return self;
}

- (void)viewDidLoad
{
[super viewDidLoad];
self.craftingItems1 = [[NSArray alloc] initWithObjects:
                       @"Item 1",
                       @"Item 2",
                       @"Item 3",
                       @"Item 4",
                       @"Item 5", nil];

self.theText = [[NSArray alloc] initWithObjects:
                @"Description 1", 
                @"Description 2", 
                @"Description 3", 
                @"Description 4", 
                @"Description 4", nil];

self.bigImages = [[NSArray alloc] initWithObjects:
                  @"Image 1.png", 
                  @"Image 2.png", 
                  @"Image 3.png", 
                  @"Image 4.png", 
                  @"Image 5.png", nil];

}

- (void)viewDidUnload
{
[super viewDidUnload];
// Release any retained subviews of the main view.
// e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation: (UIInterfaceOrientation)interfaceOrientation
{
return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
// Return the number of sections.
return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:      (NSInteger)section
{
// Return the number of rows in the section.
NSInteger rows = 0;

if ([tableView 
     isEqual:self.searchDisplayController.searchResultsTableView]){
    rows = [self.searchResults count];
}
else{
    rows = [self.craftingItems1 count];
}

return rows;
}

- (UITableViewCell *)tableView:(UITableView *)tableView                        cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

static NSString *CellIdentifier = @"tableCell";

UITableViewCell *cell = [tableView 
                                dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] 
             initWithStyle:UITableViewCellStyleDefault 
             reuseIdentifier:CellIdentifier];

    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
}

/* Configure the cell. */
if ([tableView  isEqual:self.searchDisplayController.searchResultsTableView]){
    cell.textLabel.text = 
    [self.searchResults objectAtIndex:indexPath.row];

}
else{
    cell.textLabel.text =
    [self.craftingItems1 objectAtIndex:indexPath.row];

}

return cell;

}

// Configure the cell...

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
if ([[segue identifier] isEqualToString:@"ShowCrafting"])
{
    DetailViewController *theDetailViewController = 
    [segue destinationViewController];

    NSIndexPath *myIndexPath = [self.tableView 
                                indexPathForSelectedRow];

    theDetailViewController.craftingModel = [[NSArray alloc]
                                             initWithObjects:   [self.craftingItems1
                                                                objectAtIndex:[myIndexPath row]],
                                             [self.theText objectAtIndex:   [myIndexPath row]],
                                             [self.bigImages    objectAtIndex:[myIndexPath row]],
                                             nil];

}
}

- (void)filterContentForSearchText:(NSString*)searchText 
                         scope:(NSString*)scope
{
NSPredicate *resultPredicate = [NSPredicate 
                                predicateWithFormat:@"SELF contains[cd]     %@",
                                searchText];

self.searchResults = [self.craftingItems1   filteredArrayUsingPredicate:resultPredicate];
}

#pragma mark - UISearchDisplayController delegate methods
-(BOOL)searchDisplayController:(UISearchDisplayController *)controller 
shouldReloadTableForSearchString:(NSString *)searchString
{
[self filterContentForSearchText:searchString 
                           scope:[[self.searchDisplayController.searchBar   scopeButtonTitles]
                                  objectAtIndex:    [self.searchDisplayController.searchBar
                                                 selectedScopeButtonIndex]]];

return YES;
}

- (BOOL)searchDisplayController:(UISearchDisplayController *)controller 
shouldReloadTableForSearchScope:(NSInteger)searchOption
{
[self filterContentForSearchText:[self.searchDisplayController.searchBar    text] 
                           scope:[[self.searchDisplayController.searchBar   scopeButtonTitles]
                                  objectAtIndex:searchOption]];

return YES;
}

@end 
```

详细视图通常与表格一起使用，但是当使用搜索时，项目列表不会链接到详细视图。

# html - 单张照片从画廊加载，直到我转到另一个页面 [Swipe JS]

> ID：11346944
> 
> 赞同：0
> 
> 时间：2012-07-05T14:55:29.580
> 
> 标签：html, css

我将 jQuery Mobile 用于一个简单的移动网站。使用 SwipeJS 滑动图片。在 iPhone 上，所有 3 张照片都会自动加载和滑动。在 iPad 上，只有第一张照片，因此不会滑动，因为它会读取图库中的其他照片。

所有三张照片都只加载，在我加载另一个页面然后返回页面之后。

Javascript 已打开

```
<div id = "slider">
  <ul>
    <li style = 'display:block'><a href="../customer/19"><img src="../firstPhoto.jpg", width="80%"></a></li>
    <li style = 'display:none'><a href="../customer/20"><img src="../secondPhoto.jpg", width="80%"></li></a>
    <li style = 'display:none'><a href="../customer/21"><img src="../secondPhoto.jpg", width="65%"></a></li>
  </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T17:07:04.447

原来这是 Swipe JS 1.0 的一个小故障，我升级到[Swipe 2.0](https://github.com/bradbirdsall/Swipe/tree/swipe2)并解决了这个问题。
更多信息在这里 - [https://github.com/bradbirdsall/Swipe/issues/16](https://github.com/bradbirdsall/Swipe/issues/16)

# css - SVG for background

> ID：11346955
> 
> 赞同：1
> 
> 时间：2012-07-05T14:55:54.690
> 
> 标签：css, svg

I tried to use a svg for a background and it works in local but not when I upload it to an ftp.

It has a png fallback for IE and others that not support svg. But in all cases I just see the png.

(Just for the example use a red square for the svg and a very different think a logo of skype.png for the fall back): [http://jsfiddle.net/snG8w/](http://jsfiddle.net/snG8w/) http://codepen.io/pen/9135/2

How to put a svg in in this background?

HTML:

```
<div id="quadrat"></div>​ 
```

CSS:

```
#quadrat {
  position: absolute;
  top: 20px;
  left: 20px;
  width: 400px;
  height: 400px;
  line-height:200px;
  background-image:  url('http://mig-marketing.com/proves/retina/skype.png');
  background-image:  none,url('http://mig-marketing.com/proves/retina/rectangle.svg'), url('http://mig-marketing.com/proves/retina/skype.png');
  background-size: 100% 100%;
  background-repeat:no-repeat;
}​ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T18:07:43.263

You are serving the [svg image](http://mig-marketing.com/proves/retina/rectangle.svg) with a 'text/xml' mediatype. While that's technically fine, it's quite possible that browsers disallow that in scenarios like this one, where only images are allowed. Try configuring your server to send the official svg mediatype 'image/svg+xml' instead, that should work.

Some more details for how to configure your webserver can be found e.g [here](http://planetsvg.com/tools/mime.php?url=http://mig-marketing.com/proves/retina/rectangle.svg).

**Update:** added link to the svg image that gets served with 'text/xml'.

# python - 照射在平坦表面上的聚光灯

> ID：11346956
> 
> 赞同：1
> 
> 时间：2012-07-05T14:55:55.893
> 
> 标签：python, opengl

我想在平坦的表面上照射一个漂亮的聚光灯。我知道照明是按顶点完成的，因此可以在表面上创建可能的顶点 - 请参阅此[答案](https://stackoverflow.com/a/7353194/232794)。但是，我得到这些——使用 GL_QUADS 和 GL_LINE_STRIP 只是为了检查我是否正确地做事。

![在此处输入图像描述](../Images/9baed4472551c191d6ea8432a2796a68.png) ![在此处输入图像描述](../Images/f9baed963ccef7e8315052056f011abb.png)

这些显然是相当差的。所以，

*   我需要什么机会让聚光灯在表面上看起来更像一个圆圈？
*   我怎样才能更快地绘制这个场景？

注意：我意识到在这种情况下正常计算并不是绝对必要的，但在一般情况下，它是需要的。此外，我可以为表面使用显示列表，因此它只绘制一次。

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
import sys
from OpenGL.GLUT import *
from OpenGL.GL import *
from OpenGL.GLU import *
import numpy as np
from Numeric import *

lightPosition = np.array([10, 30, 20, 1])
view_rotation = np.array([0, 0, 0])

def init():
    globAmb = [0.3, 0.3, 0.3, 1.0]
    lightAmb = [0.0, 0.0, 0.0, 1.0]
    lightDifAndSpec = [0.7, 0.7, 0.7, 1.0]

    glutInit()

    glClearColor(0.0, 0.0, 0.0, 0.0)

    glEnable(GL_DEPTH_TEST)
    glClearDepth(1.0)
    glDepthFunc(GL_LESS)

    glShadeModel(GL_SMOOTH)

    glEnable(GL_LIGHTING)
    glLightfv(GL_LIGHT0, GL_AMBIENT, lightAmb)
    glLightfv(GL_LIGHT0, GL_DIFFUSE, lightDifAndSpec)
    glLightfv(GL_LIGHT0, GL_SPECULAR, lightDifAndSpec)
    glEnable(GL_LIGHT0)
    glLightModelfv(GL_LIGHT_MODEL_AMBIENT, globAmb)
    glLightModeli(GL_LIGHT_MODEL_LOCAL_VIEWER, GL_TRUE)

    glEnable(GL_CULL_FACE)
    glCullFace(GL_BACK)

def display():
    glClearColor(0.0, 0.0, 0.0, 0.0)
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT)

    glLoadIdentity()
    gluLookAt(0.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0);

    glRotatef(view_rotation[0], 1.0, 0.0, 0.0)
    glRotatef(view_rotation[1], 0.0, 1.0, 0.0)
    glRotatef(view_rotation[2], 0.0, 0.0, 1.0)

    glPushMatrix()
    pos = [0, 20, 0, 1]
    direction = [0.0, -1.0, 0.0]
    spotAngle = 20
    glLightfv(GL_LIGHT0, GL_POSITION, pos)
    glLightf(GL_LIGHT0, GL_SPOT_CUTOFF, spotAngle)
    glLightfv(GL_LIGHT0, GL_SPOT_DIRECTION, direction)
    glLightf(GL_LIGHT0, GL_SPOT_EXPONENT, 2)

    glPushMatrix();
    glDisable(GL_LIGHTING)
    glTranslate(pos[0], 0.5* pos[1], pos[2])
    glRotatef(-90.0, 1.0, 0.0, 0.0)
    glColor3f(1.0, 1.0, 1.0)
    PI = 3.141592
    glutWireCone(3.0 * np.tan( spotAngle/180.0 * PI ), pos[1], 10, 6)
    glEnable(GL_LIGHTING)
    glPopMatrix();

    draw_cube()

    glPopMatrix()
    glFlush ()

def reshape(w, h):
    glMatrixMode(GL_PROJECTION)
    glLoadIdentity()
    gluPerspective(45.0, float(w) / float(h), 0.1, 100.0)
    glMatrixMode(GL_MODELVIEW)

def keyboard(key, x, y):
    if key == chr(27):
        sys.exit(0)
    elif key == 'w':
        view_rotation[0] += 10
        display()
    elif key == 's':
        view_rotation[0] -= 10
        display()
    elif key == 'a':
        view_rotation[1] -= 10
        display()
    elif key == 'd':
        view_rotation[1] += 10
        display()
    else:
        print "Unknown %s key" %(key)

def draw_cube ():
    glPushMatrix()
    glRotatef(45, 0, 1, 0)
    glMaterialfv(GL_FRONT, GL_AMBIENT_AND_DIFFUSE, [183/256.0, 65/256.0, 14/256.0, 1.0]);
    glMaterialfv(GL_FRONT, GL_SPECULAR, [1, 1, 1, 1]);
    glMaterialfv(GL_FRONT, GL_SHININESS, [100.0]);
    sz = 10
    step = 1
    for x in arange(-sz, sz, step):
        for z in arange(-sz, sz, step):

            v0 = np.array([x,  sz, z])
            v1 = np.array([x,  sz, z+step])
            v2 = np.array([x+step,  sz, z+step])
            v3 = np.array([x+step,  sz, z])

            #glBegin(GL_QUADS) # Uncomment to get the surface instead of lines.
            glBegin(GL_LINE_STRIP)

            n = get_normal_vector(v0, v1, v3)
            glNormal(n[0], n[1], n[2])
            glVertex3f(v0[0], v0[1], v0[2])

            n = get_normal_vector(v1, v2, v0)
            glNormal(n[0], n[1], n[2])
            glVertex3f(v1[0], v1[1], v1[2])

            n = get_normal_vector(v2, v3, v1)
            glNormal(n[0], n[1], n[2])
            glVertex3f(v2[0], v2[1], v2[2])

            n = get_normal_vector(v3, v0, v2)
            glNormal(n[0], n[1], n[2])
            glVertex3f(v3[0], v3[1], v3[2])
            glEnd()

    glPopMatrix()

def get_normal_vector (v1, v2, v3):
    v = np.cross(v2-v1, v3-v1)
    n = np.sqrt(np.dot(v, v.conj()))
    if n:
        return v/n 
    else:
        print v1
        print v2
        print v3
        print v/n
        sys.exit(-1)

glutInit(sys.argv)
glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB)
glutInitWindowSize(800, 800)
glutInitWindowPosition(300, 0)
glutCreateWindow('Lines')
init()
glutDisplayFunc(display)
glutReshapeFunc(reshape)
glutKeyboardFunc(keyboard)
glutMainLoop() 
```

**PS：**当我让它工作时，我将使用着色器更新源代码的答案......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:00:52.370

使用[片段着色器渲染聚光灯](http://www.lighthouse3d.com/tutorials/glsl-tutorial/spot-light-per-pixel/)。这也是渲染场景的最快方式，因为您不会增加曲面细分，但可以获得最高质量的照明。

希望这可以帮助！

# windows - 如何为所有州的 Metro 应用程序设置自定义按钮背景

> ID：11346957
> 
> 赞同：0
> 
> 时间：2012-07-05T14:55:57.460
> 
> 标签：windows, windows-8, windows-runtime, windows-store-apps, winrt-xaml

我想为 Metro 风格的 Windows 8 应用程序的按钮使用我自己的位图。我可以将按钮的背景画笔设置为我自己的 ImageBrush 并且效果很好，除了悬停和按下状态。我不知道如何为它们设置位图。有谁知道如何做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:11:08.420

[WinRT XAML Toolkit](http://bit.ly/WinRTXamlToolkit)有一个 ImageButton 控件，如果您需要，它允许为所有状态定义图像。您还可以在[Generic.xaml中检查其默认模板](http://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/15513#246009)查看它如何使用基于多个重叠图像控件的位图（例如检查 PART_HoverStateImage）和控制这些图像控件不透明度的视觉状态。如果您是懒惰的 - 您也可以只使用两个位图并使用使用 PressedStateImageSource 定义的半透明位图覆盖在 IdleStateImageSource 定义的位图之上以显示悬停状态。或者您可以完全懒惰并仅使用单个位图作为空闲状态，并通过将 GeneratePressedState 和 GenerateHoverState 设置为 true 让控件为其他两个状态生成位图 - 通过使用一些基本图像“点亮”空闲状态图像来生成这些位图加工。该工具包还有一个示例应用程序，该应用程序带有一个页面，该页面演示了如何以多种方式使用 ImageButton 控件。

# android - 监听 ACTION_SCREEN_OFF

> ID：11346958
> 
> 赞同：19
> 
> 时间：2012-07-05T14:55:58.177
> 
> 标签：android

我正在尝试启动一个在后台运行的服务，该服务正在侦听`ACTION_SCREEN_OFF`，当它找到时`ACTION_SCREEN_OFF`，开始我的活动。

我在某处读到您需要创建一个*BroadcastReceiver*，因为将它放在清单 XML 中是行不通的。但是，经过大量搜索，我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-07-05T18:23:55.737

您不能在*AndroidManifest.xml*`ACTION_SCREEN_ON`中声明和。您只能在活动运行时捕捉它们。`ACTION_SCREEN_OFF`

 *这是一个例子。

*广播接收*器：

```
public class ScreenReceiver extends BroadcastReceiver {

    public static boolean wasScreenOn = true;

    @Override
    public void onReceive(final Context context, final Intent intent) {
        if (intent.getAction().equals(Intent.ACTION_SCREEN_OFF)) {
            // do whatever you need to do here
            wasScreenOn = false;
        } else if (intent.getAction().equals(Intent.ACTION_SCREEN_ON)) {
            // and do whatever you need to do here
            wasScreenOn = true;
        }
    }

} 
```

*活动*：_

```
public class ExampleActivity extends Activity {

    private BroadcastReceiver mReceiver = null;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        // initialize receiver
        final IntentFilter filter = new IntentFilter(Intent.ACTION_SCREEN_ON);
        filter.addAction(Intent.ACTION_SCREEN_OFF);
        mReceiver = new ScreenReceiver();
        registerReceiver(mReceiver, filter);
        // your code
    }

    @Override
    protected void onPause() {
        // when the screen is about to turn off
        if (ScreenReceiver.wasScreenOn) {
            // this is the case when onPause() is called by the system due to a screen state change
            Log.e("MYAPP", "SCREEN TURNED OFF");
        } else {
            // this is when onPause() is called when the screen state has not changed
        }
        super.onPause();
    }

    @Override
    protected void onResume() {
        super.onResume();
        // only when screen turns on
        if (!ScreenReceiver.wasScreenOn) {
            // this is when onResume() is called due to a screen state change
            Log.e("MYAPP", "SCREEN TURNED ON");
        } else {
            // this is when onResume() is called when the screen state has not changed
        }
    }

    @Override
    protected void onDestroy() {
        if (mReceiver != null) {
            unregisterReceiver(mReceiver);
            mReceiver = null;
        }
        super.onDestroy();
    }

} 
```

您可能可以通过收听来自`Service`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-25T07:31:17.917

我正在使用回调`ScreenReceiver`来解决问题`onResume()`，并且`onPause()`. 这些在`BroadcastReceiver.onReceive()`.*

# android - 升级到 ADT 20（Helios、Mac）后按钮无法正确显示

> ID：11346962
> 
> 赞同：1
> 
> 时间：2012-07-05T14:56:05.337
> 
> 标签：android, android-layout, adt

刚刚更新到 ADT 20，我的布局中的所有按钮都没有在编辑器中正确显示。

**还有其他人有问题吗？**

基本上按钮显示没有背景（没有像过去那样的默认灰色按钮背景）。因此，如果我在布局中添加一个新按钮，它只会显示为文本（在窗口背景的顶部）。此外，我的布局中的所有现有按钮都无法正确显示。

在安装 ADT 20 期间存在以下问题（显示在对话框中）：
!MESSAGE Marker id 345609 not found。
!MESSAGE 标记 id 345610 未找到。
!MESSAGE 未找到标记 id 345611。

不确定这些是否相关。

尝试卸载/重新安装 ADT 20 无济于事，按钮也有同样的问题（但第二次安装时没有对话框错误）。

任何人都知道如何让我的按钮的背景再次出现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:12:16.043

我通过将布局使用的 API 更改为除 API 9 :Android 2.3.1 之外的任何内容来解决此问题，这是它们设置的内容。

在 ADT 20 中，图形编辑器的右上角有一个绿色的 Android 图标，可让您选择要在图形编辑器中使用的 API 级别。

更改为 API 10 或更高版本可以解决问题。所以这对我现在有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T10:57:48.667

请参阅我对[这个 SO 问题](https://stackoverflow.com/questions/11387606/adt-20-graphical-layout-editor/11667741#11667741)的回答 - 特别是 2.3.1 已过时，并且看起来不会更新以解决此问题。

# javascript - Javascript用斜杠替换双引号

> ID：11346963
> 
> 赞同：26
> 
> 时间：2012-07-05T14:56:09.240
> 
> 标签：javascript

我想`"` 用`\"`Javascript 替换。

我有：

```
text = text.toString().replace("\"", '\\"') 
```

结果：

```
\\" 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-07-05T14:57:01.670

尝试这个：

```
text = text.toString().replace(/"/g, '\\"') 
```

或这个：

```
text = text.toString().replace('"', '\\"') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-01-04T18:52:17.580

根据antyrat的回答，我有一个小建议。

```
text = text.toString().replace(/\\"/g, '"').replace(/"/g, '\\"'); 
```

这个额外的步骤将首先将所有的 \" 替换为 "，然后将所有的 " 替换回 \"。当您当前的字符串包含 \" 和 " 的组合时，它会有所帮助，尤其是当字符串是 JSON.stringify() 的结果时

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T15:00:51.047

这将做：

```
text = text.toString().replace("\"", '\\\"'); 
```

您基本上必须通过 \ 转义 '\' 和 '"'

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-05T13:36:01.787

var text = JSON.stringify(JSON.stringify(text))

# c# - 自定义属性映射 - 仅更改现有对象

> ID：11346969
> 
> 赞同：0
> 
> 时间：2012-07-05T14:56:17.833
> 
> 标签：c#, .net, asp.net-mvc, nhibernate, mapping

我需要将值从一种类型映射到另一种类型。两个对象都已经实例化并且具有值。一个是 MVC ViewModel 对象，另一个是 NHibernate 实体。我想将视图模型映射到实体，但只有当它们不同时我才必须分配值。我还想记录更改。我想被整齐地包裹到映射方法/函数中。我认为 AutoMapper 不可能做到这一点。是吗？我也想出了自定义映射功能，但有更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T21:21:32.677

I think I like it better as an extension on the destination object :)

```
/// <summary>
/// Maps a property value from one object type to another.
/// Assignment only if values are different.
/// Change is recorded to stringbuilder object with changeName name
/// </summary>
/// <typeparam name="TDestination">Type of destination object</typeparam>
/// <typeparam name="TSourceValue">Type of source object</typeparam>
/// <param name="changeName">what to call the change for logging</param>
/// <param name="dObj">the desitnation object instance on which to call the extension method</param>
/// <param name="destProp">destination (old value) property</param>
/// <param name="sVal">the source (new) value</param>
/// <param name="sbChanges">where to log the changes</param>
/// <returns>1 if values were different, 0 if values were the the same</returns>
/// <example>
///     var sbChanges = new StringBuilder();
///     var c = 0;
///     c += DestObj.MapChange("My Property", x => x.DestProp, SourceObj.SourceProp, sbChanges);
/// </example>
public static short MapChange<TDestination, TSourceValue>(this TDestination dObj, string changeName, Expression<Func<TDestination, object>> destProp,
                                                      TSourceValue sVal, StringBuilder sbChanges)
{
    var dExpr = destProp.Body as MemberExpression ?? ((UnaryExpression)destProp.Body).Operand as MemberExpression;

    if (dExpr == null)
        throw new Exception("Destination expression must be a field or property");

    var dProp = typeof(TDestination).GetProperty(dExpr.Member.Name);

    var dVal = dProp.GetValue(dObj, null);

    //Equals(null, null) is false so also compare by reference
    if (!ReferenceEquals(dVal, sVal) && !Equals(dVal, sVal))
    {
        dProp.SetValue(dObj, sVal, null);

        if (sVal == null) // http://stackoverflow.com/questions/5340817/what-should-i-do-about-possible-compare-of-value-type-with-null
            sbChanges.AppendFormat("Removed '{0}'\r", changeName);
        else if (dVal == null || sVal is bool)
            sbChanges.AppendFormat("Set '{0}' to '{1}'\r", changeName, sVal);
        else //other types
            sbChanges.AppendFormat("Set '{0}' from '{1}' to '{2}'\r", changeName, dVal, sVal);

        return 1;
    }

    return 0;
} 
```

# java - ArrayList 中的 Android 内存泄漏

> ID：11346972
> 
> 赞同：0
> 
> 时间：2012-07-05T14:56:20.390
> 
> 标签：java, android, memory-leaks

我正在开发一款安卓游戏。随着游戏的进行，它会逐渐变慢。我确信一些速度变化是由于更高的敌人数量和类似的东西，但我也担心我可能有内存泄漏。

游戏的本质是这样的：

这是一款使用列表和数组构建的塔防游戏。所有的塔数据都存储在许多 gameBoard 数组中。在整个绘图和更新代码中，每个块都被评估。大多数时候什么都不需要做。游戏是一个 30x14 的网格，因此在整个循环过程中可能会评估 420 个位置 15 次。这不是很好的编程，但我认为代码足够简单，可以正常工作。大多数时候什么都不需要做，所以我认为这无关紧要。

敌人、所有子弹和各种粒子效果都存储在列表中并更新，如下面的代码所示。几天前我给游戏做了皮肤，保持所有游戏逻辑相同，但添加了效果。添加位图和着色样式并没有改变游戏的运行方式。当我添加如下所示的粒子效果时，减速很明显。它们不会在游戏初期造成任何减速。在比赛的后期，他们会这样做。因此，我认为内存管理错误。

我有很多这样的不同课程：

```
public class FadeBlock {
    private float x;
    private float y;
    private float radius;
    private int level;
    private float startRadius;
    private float endRadius;
    private float elapsedTime;
    private float fadeTime;
    private boolean terminate;
    private float percent;

    public FadeBlock(int Level, float CenterX, float CenterY, float StartRadius, float EndRadius, float FadeTime)
    {
        x = CenterX;
        y = CenterY;
        level = Level;
        fadeTime = FadeTime;
        terminate = false;
        percent = 1;
        startRadius = StartRadius;
        endRadius = EndRadius;
        radius = startRadius;
    }

    public void Update(float ElapsedTime)
    {
        elapsedTime += ElapsedTime;
        percent = (((float) elapsedTime) / ((float)fadeTime));
        radius = (endRadius - startRadius)*percent + startRadius;

        if (percent >= 1)
        {
            terminate = true;
        }
    }

    public void Draw(Canvas canvas, Paint paint)
    {
        if (!terminate)
        {
            switch (level) {
            case 1:
                paint.setARGB(255, 61, 190, 255);
                break;
            case 2:
                paint.setARGB(255, 162, 0, 194);
                break;
            case 3:
                paint.setARGB(255, 0, 194, 162);
                break;
            case 4:
                paint.setARGB(255, 129, 194, 0);
                break;
            case 5:
                paint.setARGB(255, 255, 85, 0);
                break;
            case 6:
                paint.setARGB(255, 194, 65, 0);
                break;
            default:
                paint.setARGB(255, 61, 190, 255);
                break;
            }
            paint.setAlpha((int) (255*(1 - percent)));

            canvas.drawRect(x-radius, y - radius, x + radius, y + radius, paint);
        }
    }

    public boolean Kill()
    {
        return terminate;
    }

} 
```

我添加到这样的arrayList：

```
public List<FadeBlock> FadingBlocks = new ArrayList<FadeBlock>(); 
```

并使用以下循环进行管理：

```
for (int i = 0; i < FadingBlocks.size(); i++)
{
    FadingBlocks.get(i).Draw(canvas, paint);
}

for (int i = 0; i < FadingBlocks.size(); i++)
{
    FadingBlocks.get(i).Update(elapsedTime);
}

for (int i = (FadingBlocks.size() - 1); i > -1 ; i-- )
{   
    if (FadingBlocks.get(i).Kill())
{                       
        FadingBlocks.remove(i);
    }
} 
```

要将项目添加到列表中，我会执行以下操作：

```
FadeBlock tempBlock = new FadeBlock(Units.get(i).getLevel(), Units.get(i).getX()+16, Units.get(i).getY()+16, 16, 32, 250)                   
FadingBlocks.add(tempBlock); 
```

这是管理我的对象的坏方法吗？随着时间的推移，这会在安卓设备上导致内存问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:16:21.837

从几行代码中很难知道这个或那个是否会导致内存泄漏。这是给你的一个想法：

为您的游戏使用[ObjectPool](http://en.wikipedia.org/wiki/Object_pool_pattern)模式：您在开始游戏时创建 N 个敌人，其中一些是不活动的。然后，当您需要一个新敌人时，您无需创建一个新敌人并将其添加到您的 ArrayList 中，而是从不活动的池中取出一个并激活它。同样，您只需将其标记为在池中不活动，而不是删除敌人。

这可以防止内存过度使用，因为 ArrayList 以 x 的容量开始，并且在需要时会增加到 2x 等......但是当您删除对象时它永远不会释放内存。还将对象池存储在静态列表而不是数组列表中，因为迭代和访问对象会更快。

# visual-studio-2012 - 如何在 sqlproj (SQL Server 2012) 脚本中使用 msbuild 属性

> ID：11346977
> 
> 赞同：7
> 
> 时间：2012-07-05T14:56:34.743
> 
> 标签：visual-studio-2012, sql-server-2012, sql-server-data-tools

我刚刚将现有的 SQL Server 2008 r2 .dbproj 升级到了 SQL Server 2012 .sqlproj（使用 SQL Server Data Tools）。

以前，我能够在我的项目中定义一个 SQLCMD 变量，然后通过编辑项目文件来定义值，以通过添加以下元素来使用 msbuild 值：

```
<ItemGroup>
    <SqlCommandVariableOverride Include="ProjectDirectory=$(MSBuildProjectDirectory)" />
</ItemGroup> 
```

然后我可以在我的 PostDeployment 脚本中使用它，如下所示：

```
SELECT * INTO dbo.MyTable FROM dbo.MyTable WHERE 1=2
BULK INSERT dbo.MyTable
FROM  '$(ProjectDirectory)\data\dbo.MyTable.dat'
WITH (DATAFILETYPE = 'widenative') 
```

但是，升级后，这似乎不再起作用。

我已经尝试将相同的条目添加到新的 sqlproj，但发布功能似乎没有选择它并希望我提供一个值。如果我提供`$(MSBuildProjectDirectory)`，则按字面意思解释并失败。

在新制度下，指定本地文件路径和/或使用 msbuild 值的机制是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-16T06:42:17.233

In a sql server 2012 sqlproj (SSDT database project) you use publishing profiles. You can start off by right-clicking your database project and choosing 'Publish'.

You can then set desired options and save these in a so-called publishing profile in your project. Double-clicking this profile launches the publishing wizard with the correct options set.

In your publish profile you can include hard-coded values for sqlcmd variables:

```
<ItemGroup>
    <SqlCmdVariable Include="ProjectDirectory">
        <Value>UNKNOWN</Value>
    </SqlCmdVariable>
</ItemGroup> 
```

If desired, you can update these with dynamic values during build. In your msbuild project:

```
<Target Name="SetProjectDirectoryInPublishXml">
    <ItemGroup>
        <Namespaces Include="nsMsbuild">
            <Prefix>nsMsbuild</Prefix>
            <Uri>http://schemas.microsoft.com/developer/msbuild/2003</Uri>
        </Namespaces>
    </ItemGroup>
    <ItemGroup>
        <SSDTPublishFiles Include="$(SolutionBinFolder)\**\*.publish.xml" />
    </ItemGroup>
    <MSBuild.ExtensionPack.Xml.XmlFile Condition="%(SSDTPublishFiles.Identity) != ''"
                                   TaskAction="UpdateElement"
                                   File="%(SSDTPublishFiles.Identity)"
                                   Namespaces="@(Namespaces)" 
                                   XPath="//nsMsbuild:SqlCmdVariable[@Include='ProjectDirectory']/nsMsbuild:Value" 
                                   InnerText="$(MSBuildProjectDirectory)"/>
</Target> 
```

This requires an extension to update the XML. I use the msbuild extension pack.

Credits for this mechanism go to [Jamie Thomson](http://sqlblog.com/blogs/jamie_thomson/archive/2012/12/10/editing-sqlcmdvariable-nodes-in-ssdt-publish-profile-files-using-msbuild.aspx)

# magento - magento 将子类别设置为根类别

> ID：11346982
> 
> 赞同：2
> 
> 时间：2012-07-05T14:56:51.843
> 
> 标签：magento

我有 2 个网站的 1 个 magento 安装。我想将网站 1 的子类别设置为网站 2 的根类别。

而且我不知道该类别的 ID，因为这是本地的，并且必须与其他类别一起进行生产。所以我无法在代码中设置所需类别的 id。它必须在后端可调。

在系统-> 管理商店-> 在此处选择一个商店，您可以设置根类别，但没有可用的子类别。

是构建模块以选择类别ID的唯一解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-25T04:17:51.097

复制

app/code/core/Mage/Catalog/Model/Resource/Category/Collection.php

至

app/code/local/Mage/Catalog/Model/Resource/Category/Collection.php

在第 414 行附近更新

```
 $this->addLevelFilter(1); 
```

至

```
 $this->addLevelFilter(2); 
```

当您进入 System -> Manage Stores 并单击 Store Name 时，这将执行此操作。它允许您设置根类别。此下拉列表现在不仅会显示根类别，还会显示 2 级类别。在某个商店中使用子类别作为根类别是完全可以的。

如果您正在运行一个公司网站，然后是一堆品牌子网站，但您不想管理一百万个不同的重复类别，这将非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:49:29.787

我明白你想要做什么，但不知道为什么。您是否尝试为每个商店视图显示特定类别？您不必担心根类别来解决这个问题。

我假设您使用的是更新版本的 Magento Community Edition 1.5+。

*   将两个商店视图的类别设置为相同的根类别（默认为默认类别）

*   转到目录 > 管理类别。

*   对于每个网站，您需要启用/禁用每个子类别以从根类别构建自定义目录。

*   在类别列表上方，您可以切换需要自定义的商店视图。将此设置保留为“所有商店视图”并自定义您想要或不想要网站 1 的子类别。

*   为此，只需单击特定类别 > 常规信息选项卡，然后将 Is Active 设置为 Yes 或 No。Disabled 类别将灰显。

*   完成后切换到另一个网站“网站 2”的商店视图并选择一个不同于默认类别的类别。

*   现在，在各个字段的右侧，您将看到一个标记为使用默认值的复选框（默认选中）。

*   取消选中 Is Active 字段旁边的 Use Default Value 复选框并将其切换为 yes/no。

*   保存类别。

*   现在，当您查看每个商店时，您会发现目录不同。

这能解决您的问题吗？

# asp.net-mvc-3 - 在动作签名中选择对象绑定器

> ID：11346985
> 
> 赞同：0
> 
> 时间：2012-07-05T14:56:53.573
> 
> 标签：asp.net-mvc-3, action, method-signature, defaultmodelbinder, custom-model-binder

我有一个自定义模型绑定器来从会话中获取数据，但我也想不时使用默认绑定器。

是否可以在动作签名中选择模型绑定器而不是使用 UpdateModel？

例子

```
public ViewResult MyAction(Cart useSessionBinder, Cart useFormData)
{} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:09:58.383

您可以使用以下[`[ModelBinder]`](http://msdn.microsoft.com/en-us/library/system.web.mvc.modelbinderattribute.aspx)属性：

```
public ActionResult MyAction(
    [ModelBinder(typeof(MyCustomModelBinder))] Cart useSessionBinder, 
    Cart useFormData
)
{
    ...
} 
```

显然，您不应该将您的自定义模型绑定器全局分配给您的`Cart`类`Application_Start`，否则它将自动应用于`Cart`作为操作参数出现的所有实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T18:46:15.793

好吧，您可以将全局自定义模型绑定器保留在 Appliaction_Start 中，让它在任何地方都可以工作，并在需要时不时重置为默认绑定器

```
public ActionResult MyAction(
       [ModelBinder(typeof(DefaultModelBinder))]  Cart useFormData) 
```

# c - 打开 Windows 资源管理器外壳上下文菜单

> ID：11346987
> 
> 赞同：0
> 
> 时间：2012-07-05T14:57:03.823
> 
> 标签：c, winapi, windows-shell

如何使用 Windows API 枚举 shell 上下文菜单项？我需要用纯C来做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:15:36.340

您需要完全按照 Explorer 所做的那样：对于有问题的项目（文件、文件夹、其他 shell 命名空间位置），您需要确定 shell 扩展列表。这些是 COM 类，它们实现[`IContextMenu`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776095%28v=vs.85%29.aspx)接口。对于每个适用的 shell 扩展，您可以提供自己的菜单并请求此类扩展（处理程序）使用其附加项（）填充菜单`IContextMenu::QueryContextMenu`。

稍后您可以自由决定何时、何地以及是否要弹出此菜单。如果需要处理这些附加处理程序的命令之一，您有责任通过 将命令转发给处理程序`IContextMenu::InvokeCommand`。如果您出于某种原因更喜欢自动化某些命令并在不弹出菜单的情况下调用它，您也可以这样做。

您可能感兴趣的链接：

*   [如何访问 Windows shell 上下文菜单项？](https://stackoverflow.com/questions/3777121/how-to-access-windows-shell-context-menu-items)
*   [创建快捷菜单处理程序](http://msdn.microsoft.com/en-us/library/windows/desktop/cc144171%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T20:18:24.463

如果您想显示菜单或仅枚举项目，我有点不清楚，后者是这样做的（不包括子菜单）

```
HRESULT GetContextMenuForFSItem(PCTSTR path,IContextMenu**ppCM)
{
    PIDLIST_ABSOLUTE pidlAbs;
    HRESULT hr = SHParseDisplayName(path,0,&pidlAbs,0,0);
    if (!hr)
    {
        IShellFolder*pSF;
        PCUITEMID_CHILD pidlLast;
        hr = SHBindToParent(pidlAbs,&IID_IShellFolder,(void**)&pSF,&pidlLast);
        if (!hr)
        {
            hr = pSF->lpVtbl->GetUIObjectOf(pSF,0,1,&pidlLast,&IID_IContextMenu,0,(void**)ppCM);
            pSF->lpVtbl->Release(pSF);
        }
        ILFree(pidlAbs);
    }
    return hr;
}

int main()
{
    CoInitialize(0);
    WCHAR buf[MAX_PATH];
    GetWindowsDirectory(buf,MAX_PATH); /* Arbitrary filesystem item */
    IContextMenu*pCM;
    HRESULT hr = GetContextMenuForFSItem(buf,&pCM);
    if (!hr) 
    {
        HMENU hMenu = CreatePopupMenu();
        hr = pCM->lpVtbl->QueryContextMenu(pCM,hMenu,0,1,0x7fff,0);
        if (hr > 0)
        {
            UINT c=GetMenuItemCount(hMenu), i=0;
            for (; i<c; ++i)
            {
                GetMenuString(hMenu,i,buf,MAX_PATH,MF_BYPOSITION);
                if (GetMenuState(hMenu,i,MF_BYPOSITION)&MF_SEPARATOR) lstrcpy(buf,_T("--separator--"));
                printf("%.2u=%ws\n",i,buf);
                /*
                Call IContextMenu::GetCommandString  to get the verb 
                or IContextMenu::InvokeCommand to execute
                */
            }
        }
        pCM->lpVtbl->Release(pCM);
        DestroyMenu(hMenu);
    }
    CoUninitialize();
    return 0;
} 
```

在我的系统上打印：

```
00=&Open
01=--separator--
02=S&hare with
03=Restore previous &versions
04=&Include in library
05=--separator--
06=Se&nd to
07=--separator--
08=Cu&t
09=&Copy
10=--separator--
11=Create &shortcut
12=&Delete
13=--separator--
14=P&roperties 
```

在 C 中使用 COM 并不好玩，如果可以的话，请切换到 C++...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:08:44.960

Raymond Chen 写了一个[十一部分系列](http://blogs.msdn.com/search/searchresults.aspx?q=IContextMenu&sections=2905)来解释如何做到这一点。这真的不简单。

# c - C：用于反转 int 的递归函数

> ID：11346989
> 
> 赞同：3
> 
> 时间：2012-07-05T14:57:10.767
> 
> 标签：c, recursion, integer

我昨天考试时遇到了这个问题。我无法解决它，所以你可以想象结果......

创建一个递归函数：**int invertint( int num)**将接收一个整数并将其返回但反转，例如：**321**将返回为**123**

我写了这个：

```
int invertint( int num ) {
  int rest = num % 10;
  int div = num / 10;
  if( div == 0 ) {
     return( rest );
  }
  return( rest * 10 + invert( div ) )
} 
```

适用于 2 位数字，但不适用于 3 位或更多位。因为**321**在最后阶段会返回**1 * 10 + 23**。

非常感谢！

PS：有没有办法以更快的方式理解这些递归问题，或者这取决于自己的想象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:19:21.940

```
int invertint( int num ) {
  int i ;

  for(i=10;num/i;i*=10);
  i/=10;
  if(i == 1) return num;
  return( (num % 10) * i + invertint( num / 10 ) );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:09:38.997

您的错误是在最后一条语句中您`rest`乘以`10`. 为什么只有`10`？您需要将数字移动与`rest`数字剩余部分中剩余的数字一样多的数字。你只移动了 1。难怪它只适用于 2 位数字。

最后一部分应该按照

```
int tail = invert( div );
int deg = /* number of digits in `tail` */;
return rest * (int) pow(10, deg) + div; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:03:33.430

```
int reverse(int no,int rev)
{
if(no!=0)
return reverse(no/10,rev*10+no%10);
else
return rev;
} 
```

将此方法称为**reverse(numberToReverse,0)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T15:04:27.907

作为替代方案，这可以在没有递归的情况下完成。

```
 int invertint(int num)
    {
        int res = 0;
        while (num != 0)
        {                
            res = res * 10 + (num % 10);
            num /= 10;
        }
        return res;
    } 
```

但是由于递归是分配，给定 int(int) 签名，最简单的方法是使用 pow(log10)) 变体（前提是您被允许包含 math.h ？）

```
 int invertint(int num)
    {
        if (num == 0) return 0;
        return invertint(num / 10)  +  (int)pow(10, (int)log10(num)) * (num % 10);
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T15:04:58.297

如果你用另一种方式做，你就不需要柜台了。

```
int invertint(int num)
{
    if (0 == num || 0 == num % 10) {
        return num / 10;
    }
    int digits = floor(log10(num)) + 1;
    int modulus = pow(10, digits - 1);
    return invertint(num % modulus) * 10 + num / modulus;
} 
```

请注意，这并不像我最初想象的那么简单——我必须使用数学。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-05T15:05:09.887

问题出在`return(rest * 10 + invert(div))`. 你不能自己做乘法。该因素取决于函数递归的次数，因此您必须提供进位作为函数的第二个参数（进位初始化为 0）

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-06-09T12:50:11.733

这是最简单的方法。

```
int sum=0;
int reverse(int n)
{
    if(n>0)
    {
        sum=(sum*10)+(n%10);
        reverse(n/10);
    }
    return sum;
} 
```

# jquery - 用 jQuery 阅读 RSS 提要？

> ID：11346990
> 
> 赞同：8
> 
> 时间：2012-07-05T14:57:11.060
> 
> 标签：jquery, jquery-plugins, rss, xml-parsing, rss-reader

使用 jQuery rss 插件[jFeed](http://hovinne.com/articles/jfeed-jquery-rss-atom-feed-parser-plugin/)并在他们的网站上使用他们的示例代码，我创建了以下似乎不起作用的代码：

```
jQuery.getFeed({
    url: 'http://www.hotukdeals.com/rss/hot',
    success: function(feed) {
        alert(feed.title);
    }
}); 
```

我收到一条消息说：

```
XMLHttpRequest cannot load http://www.hotukdeals.com/rss/hot. Origin http://intranet is not allowed by Access-Control-Allow-Origin. 
```

有人知道为什么我会收到此访问控制消息吗？这个 rss 提要在我的桌面和在线 rss 阅读器中运行良好......

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-05T15:26:18.567

**警告**

> [Google Feed API](https://developers.google.com/feed/)已正式**弃用**，**不再有效**！

无需插件即可轻松完成，返回数据为 json

```
 $(function(){
        url = 'http://www.thetutlage.com/rss.xml';
        $.ajax({
        type: "GET",
        url: document.location.protocol + '//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=1000&callback=?&q=' + encodeURIComponent(url),
        dataType: 'json',
        error: function(){
            alert('Unable to load feed, Incorrect path or invalid feed');
        },
        success: function(xml){
            values = xml.responseData.feed.entries;
            console.log(values);
        }
    });
    }); 
```

只要确保它指向一个**xml**文件并将 url 更改为 url Rss feed，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:03:47.310

你的失败是因为 JavaScript 的[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，它基本上限制了你可以检索和操作文件的位置。

通常，您无法从与当前页面不同的位置检索内容（在您的情况下为 rss 提要）。例外只是图像和脚本。

因此，在您的情况下，一种解决方案可能是在您的服务器上设置一个代理脚本，它只调用 RSS 提要并将结果中继到您的页面。从浏览器的角度来看，所有内容都来自同一个来源。

# tsql - 使用选择子查询的 TSQL 批量更新

> ID：11346992
> 
> 赞同：0
> 
> 时间：2012-07-05T14:57:11.480
> 
> 标签：tsql, syntax

我更熟悉 Oracle，所以 SQL Server 2008 的语法让我很吃惊。我正在尝试使用等效于的查询来执行多行的更新

```
update Table
set type = 'typeA' 
where id in 
(select id from Table where type='typeB') 
```

我收到以下错误：

```
Msg 512, Level 16, State 1, Procedure Assigned_To_Email, Line 19
Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression. 
```

搜索特定于 TSQL 的解决方案时，我尝试了以下语法，但收到了相同的错误。

```
update a
set type = 'typeA' 
from Table a
join Table b
on a.id = b.id
where b.type='typeB' 
```

我已经读过使用子查询的更新应该可以工作，但这不是我的经验。这里有没有更基本的东西？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:00:54.373

您的更新语句不必使用子查询或联接。

```
update Table
set type = 'typeA' 
where type = 'typeB' 
```

# uitableview - 为 UITableViewCell 中 UITextField 的子类实现 textField:shouldChangeCharactersInRange:replacementString:

> ID：11346994
> 
> 赞同：2
> 
> 时间：2012-07-05T14:57:19.537
> 
> 标签：uitableview, uitextfield

`tableviewcells`放在视图控制器中。我可以设置不同的属性`UITextField`。但是，我找不到`textField:shouldChangeCharactersInRange:replacementString:`成功实施的方法。

我应该怎么做？谢谢。

1.  `myTextField`- 的子类`UITextField`，符合`<UITextFieldDelegate>`

2.  `myTableViewCell`- UITableViewCell 的子类在这个子类中，声明了一个 myTextField 属性并连接到 nib 布局。

3.  `myViewController`- 的子类`UIViewController`，符合`<UITextFieldDelegate, UITableViewDelegate, UITableViewDataSource>`。使用表格视图创建 nib 文件，表格视图连接到表格视图属性。还声明了一个 ivar `myTableViewCell`，名为 myCell。

在`viewDidLoad`of 中`myViewController`，调用以下内容： [[myCell myTextField] setDelegate:self]; [myTableView setDelegate:self]; [myTableView setDataSource:self];

`textField:shouldChangeCharactersInRange:replacementString:`也在`myViewController`. 但是通过断点，发现根本没有实现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T19:49:35.563

我希望`textField`代表指的是`viewcontroller`班级，是吗？我认为您的问题在于确定哪个 textField 正在调用该委托方法。

在这种情况下，1 解决方案将指向 ，`textField.delegate`否则`UITableViewCell` 如果您需要在控制器中处理它，请`textField`在方法 cellForRowAtIndexpath: （基于`indexPath.row`）中为每个 设置标签并`textField:shouldChangeCharactersInRange:replacementString:`与`[textField Tag]`