# StackOverflow 问答 1004000-1004999

# php - 对 MySQL 结果进行排序以创建多级下拉菜单

> ID：1004005
> 
> 赞同：0
> 
> 时间：2009-06-16T21:21:33.443
> 
> 标签：php, mysql

我只是在这里感到困惑。也许是因为这是一天的结束，我不知道。我使用 PHP 从 MySQL 数据库中获取项目。我只是在寻找一些 PHP 帮助。我已经完成了 HTML 和 CSS。这是db的基本结构。顺便说一句，它是一个嵌套集。想象一下，嵌套集的左右值已经在 MySQL 中排序，这让我有了深度。

```
----------------------------------------
| id | title | sequence_number | depth |
----------------------------------------
| 1  | A     | 1               | 1     |
| 2  | B     | 2               | 1     |
| 3  | C     | 1               | 2     |
| 4  | D     | 3               | 1     |
| 5  | E     | 4               | 1     |
| 6  | F     | 2               | 2     |
| 7  | A     | 1               | 3     |
| 8  | B     | 5               | 1     |
| 9  | C     | 3               | 2     |
| 10 | D     | 2               | 3     |
| 11 | E     | 6               | 1     |
| 12 | F     | 4               | 2     |
---------------------------------------- 
```

现在，如果这还不足以让您感到困惑，那么请继续阅读。我正在使用 foreach 循环遍历每个项目并像这样手动对其进行排序。问题是菜单最终会进入 3 个级别，这让我陷入困境，因为我的循环只有两个级别。有人可以帮我对这个数组进行排序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T21:28:47.080

你可以使用递归函数

例如，将深度设置为 1 循环然后重新调用深度设置为深度 + 1 的函数

这有帮助吗？乔什

# iphone - Xcode: The session is inactive. Please check your setup and try again. 0xE800001E

> ID：1004008
> 
> 赞同：3
> 
> 时间：2009-06-16T21:21:58.653
> 
> 标签：iphone, xcode, build, organizer

This happens after I hit **Build and Go** to run my app on my device.

**Build -> Clean** fixes it, but it's very annoying to have to clean and rebuild the entire project every time I want to run it.

*P.S. Is there any way to transfer my app to my iPhone using Xcode, but not run it?*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-07T05:38:09.113

A restart of the device and Xcode seems to have fixed it for me. At least for now...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T19:51:27.717

Have you tried to reinstall the SDK?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-29T04:45:55.657

Try to kill all your background app if youre running on iOS 4.0 or above.

# apache-flex - 有没有一种简单的方法可以在 Flex/ActionScript 项目中找到孤立类？

> ID：1004013
> 
> 赞同：1
> 
> 时间：2009-06-16T21:23:04.250
> 
> 标签：apache-flex, actionscript-3, class

我一直在创建现有 Flex 应用程序的“精简版”版本，从而将两者都使用的许多类移植到库项目中。因此，我想轻松找到原始项目中的所有“孤儿”类——那些不再被项目引用/使用的类。是否有 Eclipse 插件或其他一些简单的方法可以在 Flex Builder 3 中找到这些插件？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T05:08:20.037

MXML 编译器 (mxmlc) 编译器具有“链接报告”，它将生成您在原始应用程序中使用的所有类。从那里，通过一点 grep / awk / xsl 魔法，您应该能够区分您在库项目中拥有的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T23:20:40.380

这就是我有时会做的事情，假设我们一直在重构，并且某个类变得过时，我只需将可疑文件从 Flex Builder 移动到桌面，重新构建项目并查看编译器是否吐出任何错误。

如果它没有抱怨，我知道我可以安全地删除它。

如果您的类被依赖，编译器将在 Flex Builder 的“问题”面板中抛出一些错误，并为您提供相当清晰的提示，说明缺少什么。

但是，如果您有数千个课程，这将不会很有趣，因为您必须一一遍历它们。

我建议，始终在 Subversion 中保留旧文件的副本，以防万一你有一些可重复使用的东西，然后你想要恢复已删除的文件。

# iphone - 在哪里可以找到用于开发 P2P 应用程序的 iphone sdk 3.0 GameKit 教程？

> ID：1004017
> 
> 赞同：0
> 
> 时间：2009-06-16T21:24:30.660
> 
> 标签：iphone, iphone-sdk-3.0, bluetooth, p2p

我开始为 iphone sdk 3.0 开发 p2p 应用程序。但我发现很难为蓝牙 api 找到好的代码示例。有谁知道我在哪里可以为新手找到这些信息？

谢谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-24T23:37:17.083

只需添加现有的示例代码，您可以从苹果开发网站获取 GKTank 和 BeamIt 源代码：

[http://arctouch.com/beamit/](http://arctouch.com/beamit/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T23:13:21.007

Pragmatic Programmers 刚刚通过他们的 beta 图书计划提供了 Bill Dudney、Chris Adamson 和 Marcel Molina所著的[iPhone SDK Development一书。](http://pragprog.com/titles/amiphd/iphone-sdk-development)您现在可以购买 PDF（和 Kindle）版本，其中包含有关 Bonjour 和 GameKit 网络的详细章节，以及代码示例。除了 Apple 的文档和示例代码，它可能是您现在能找到的最好的资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-05T12:05:11.123

You can check this tutorial.This tutorial is about how to implement peer to peer bluetooth chat. [http://www.devx.com/wireless/Article/43502/1954](http://www.devx.com/wireless/Article/43502/1954)

and also check the book More iPhone 3 Development Tackling iPhone SDK 3 by Dave Mark | Jeff LaMarche

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-17T13:06:56.153

添加现有的示例代码并使用 BeamIT 获取 GTank 对我有帮助，也会对你有所帮助，你也可以在这方面找到额外的支持：

[http://www.algomatik.com/](http://www.algomatik.com/)

# asp.net - 在 asp.net MVC 中在单个视图中组合多个输出

> ID：1004020
> 
> 赞同：2
> 
> 时间：2009-06-16T21:25:34.823
> 
> 标签：asp.net, asp.net-mvc

我希望将 asp.net MVC 用于新项目。我在 asp.net 和 web 上查看了不同的示例。我仍然没有得到答案，将不同模型的输出组合到一个视图中的最佳方法是什么。例如，我的主页将包含类别、位置、最近帖子的快照。这些将来自三个不同的模型。我是否创建了包含所有内容的单个视图数据并在视图中混乱以相应地放置内容？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-16T21:30:42.783

你为你的主页创建了一个 ViewModel ......类似于......

```
public class MyHomepageViewModel
{
    public Categories MyCategories { get; set; }
    public Locations MyLocations { get; set; }
    public Snapshots MySnapshots { get; set; }

    public MyHomepageViewModel(Categories categories, Locations locations, Snapshots snapshots)
    {
        MyCategories = categories;
        MyLocations = locations;
        MySnapshots = snapshots;
    }
} 
```

然后您在此视图模型中强烈键入您的主页，您将可以访问视图中所需的所有内容 =)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T21:33:55.413

为此，您需要查看模型：

```
public class HomeViewModel {
    public IList<Category> Categories;
    public IList<Location> Locations;
    public IList<Snapshot> Snapshots;
    public IList<Post> Recent;
} 
```

您的视图必须是强类型的：

```
<%@ Page Inherits="System.Web.Mvc.ViewPage<HomeViewModel>" %>

<!-- <% var categories = Model.Categories %> --> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T21:30:21.147

在这种情况下，我通常会创建一个聚合多个数据模型类的视图模型类。

我相信视图和数据应该是两组不同的对象，因为有时您需要在控制器类中进行数据转换（例如，将数据模型类中的小数格式化为视图模型中货币格式的字符串），然后再将其发送到看法。

# java - Java 泛型类 - 确定类型

> ID：1004022
> 
> 赞同：51
> 
> 时间：2009-06-16T21:25:45.947
> 
> 标签：java, generics

如果我正在创建一个泛型的 java 类，例如：

```
public class Foo<T> 
```

一个人如何在内部确定那个类，“T”最终是什么？

```
public ???? Bar()
{
    //if its type 1
    //    do this
    //if its type 2
    //    do this
    //if its type 3
    //    do this
    //if its type 4
    //    do this
} 
```

我研究了 Java API 并使用了反射的东西、instanceof、getClass、.class 等，但我似乎无法对它们做出正面或反面。我觉得我已经很接近了，只需要结合一些电话，但总是不够用。

更具体地说，我试图确定该类是否使用 3 种可能类型之一进行实例化。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-06-17T05:39:35.203

我在几个项目中使用了与他在此处解释的类似的解决方案，并发现它非常有用。

[http://blog.xebia.com/2009/02/07/accessing-generic-types-at-runtime-in-java/](http://blog.xebia.com/2009/02/07/acessing-generic-types-at-runtime-in-java/)

它的要点是使用以下内容：

```
 public Class returnedClass() {
     ParameterizedType parameterizedType = (ParameterizedType)getClass()
                                                 .getGenericSuperclass();
     return (Class) parameterizedType.getActualTypeArguments()[0];
} 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-06-16T21:44:29.293

与 .NET 相比，Java 泛型是通过一种称为“类型擦除”的技术实现的。

这意味着编译器将在生成类文件时使用类型信息，但不会将此信息传递给字节码。如果您使用 javap 或类似工具查看已编译的类，您会发现 a在类文件中`List<String>`是一个简单`List`的 (of `Object`)，就像在 Java-5 之前的代码中一样。

访问通用 List 的代码将由编译器“重写”，以包含您在早期版本中必须自己编写的强制转换。实际上，一旦编译器完成以下两个代码片段，从字节码的角度来看它们是相同的：

爪哇 5：

```
List<String> stringList = new ArrayList<String>();
stringList.add("Hello World");
String hw = stringList.get(0); 
```

Java 1.4 及之前版本：

```
List stringList = new ArrayList();
stringList.add("Hello World");
String hw = (String)stringList.get(0); 
```

从 Java 5 中的泛型类读取值时，会自动插入对已声明类型参数的必要强制转换。插入时，编译器将检查您尝试输入的值，如果它不是字符串，则中止并报错。

整个过程是为了保持旧库和新的通用代码可互操作，而无需重新编译现有库。与泛型类和非泛型类并排存在但不能自由互换的 .NET 方式相比，这是一个主要优势。

这两种方法各有利弊，但在 Java 中就是这样。

回到你原来的问题：你将无法在运行时获得类型信息，因为一旦编译器完成它的工作，它就不再存在了。这在某些方面肯定会受到限制，并且有一些古怪的方法通常基于在某处存储类实例，但这不是标准功能。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-06-16T21:26:41.857

由于[类型擦除](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)，无法直接执行此操作。但是，您可以做的是将 a 传递给`Class<T>`构造函数并在您的类中保留它。然后，您可以对照`Class`您允许的三种可能类型对其进行检查。

但是，如果只有三种可能的类型，您可能需要考虑重构为[枚举](http://java.sun.com/docs/books/tutorial/java/javaOO/enum.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-16T21:31:05.763

问题是大多数通用的东西会在编译过程中消失。

一种常见的解决方案是在创建对象期间保存类型。

有关 java 的类型擦除行为的简短介绍，请阅读此[页面](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-07T19:03:45.763

如果您知道一些有意义的特定类型，则应该使用实现创建泛型类型的子类。

所以

```
public class Foo<T>

public ???? Bar()
{
    //else condition goes here
} 
```

进而

```
public class DateFoo extends Foo<Date>

public ???? Bar()
{
    //Whatever you would have put in if(T == Date) would go here.
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T21:27:15.647

泛型类的全部意义在于您不需要知道正在使用的类型......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T21:32:52.547

看起来您想要的实际上不是通用类，而是具有许多不同实现的接口。但如果你说出你的实际、具体的目标，也许它会变得更清楚。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T06:20:24.700

我同意维萨吉。泛型用于编译时验证，而不是运行时动态类型。听起来你需要的只是工厂模式。但是，如果您的“执行此操作”不是实例化，那么一个简单的 Enum 可能也可以正常工作。就像迈克尔所说的那样，如果你有一个更具体的例子，你会得到更好的答案。

# .net - 如何快速将大量 XML 数据放入我的数据库？

> ID：1004023
> 
> 赞同：3
> 
> 时间：2009-06-16T21:25:57.443
> 
> 标签：.net, xml

我正在使用 .NET 解析一个包含大约 2000 万行 (1.56 GB) 的 XML 文件，从数据中构建 LINQ 对象，然后将其插入 SQL 数据库。这需要很长时间。

为了提高性能，我正在考虑要求使用管道分隔的文件。我还想知道 Perl 是否会更快。有没有人有加快这个过程的建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T21:28:56.220

我认为您无法将该文件的 LINQ 性能提高到令您满意的程度。我的建议是使用[**XmlTextReader**](http://msdn.microsoft.com/en-us/library/system.xml.xmltextreader.aspx)并逐个节点读取文件并自己处理数据。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-16T21:30:32.037

如果您可以获取管道分隔格式的数据，则可以使用 SQL 工具将其直接导入 DB。我想，你可以使用 BCP 来做到这一点。

为什么要走文件-> LINQ对象-> DB的路线？
此外，尝试拆分文件而不是 1 个包含 2000 万条记录的大文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-16T22:15:53.350

在你开始修理东西之前，弄清楚哪个部分是慢的。这里主要分为三个部分：

*   解析 XML
*   制作 LINQ 对象
*   将其插入数据库

哪一个占用了所有时间？您可能怀疑它正在解析 XML，但在浪费大量时间之前验证一下。似乎每次我认为我知道答案时，我都错了:) 我不能建议使用 .NET 分析器，但 Stackoverflow 似乎对此有答案。

我不是 .NET 人，但如果 Perl 能提供的任何东西都快得多，我真的会感到惊讶。这不是语言问题，因为即使是快速的 Perl 东西也是通用库的接口。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-16T21:28:02.790

管道分隔的文件可能会帮助您提高性能。如果您的任务受 CPU 限制，您可以将文件拆分为`n`块（`n`您拥有的处理器数量在哪里），并并行运行作业。

我怀疑 Perl 会比 .NET 运行得更快，但你可能会让你的代码运行得更快。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-16T23:25:35.830

这是一个激进的想法，老实说，我不知道它是否会提高你的表现，但它很有可能这样做。我敢打赌，您将实例化一次上下文对象，然后使用它来插入所有记录，对吗？这样做意味着上下文将跟踪所有这些对象，直到它被释放，这**可能**解释了随着时间的推移性能下降的原因。

现在，您可以清除上下文缓存，但我有一个更疯狂的想法。这些上下文对象被设计为在实例化时具有最小的开销（无论如何在文档中都这么说，我还没有测试过这个断言），所以如果你在每次迭代中实例化上下文可能会有所帮助。即在创建对象的同时重新创建上下文。或者，这是一个更好的主意，维护一个数据对象的内部列表，并每隔 n 次迭代将该列表踢到一个单独的方法中以提交到数据库。该方法应该实例化和处置上下文。有道理？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-16T22:07:26.937

首先，我很担心听到您谈论处理 XML 时的行数。在大多数情况下，没有换行符的 XML 文档仍然是同一个文档。线条无所谓。

其次，您没有说您使用的是哪个 RDBMS，但我假设 SQL Server 2005 或 2008。在这种情况下，如果这是您需要经常重复的过程，那么我建议您在 SQL 中执行此操作服务器集成服务 (SSIS)。SSIS 针对这类事情进行了优化。特别是，它实际上可以同时读取 XML 文件、执行每行修改以及将准备好的行批量写入数据库。

唯一的潜在问题是文件的大小（顺便说一句，你说它是 2000 万行，但那是多少 MB？）。SSIS 尝试一次将整个文档加载到内存中。这可能是个问题。为了解决这个问题，我发现创建自己的自定义 Source 组件相对容易。这在文档的根元素下查找，并一次返回一个子元素（及其后代）。使用[XmlReader.ReadSubTree](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.readsubtree.aspx)方法很容易做到这一点，该方法返回一个只处理当前元素及其所有子元素的新 XmlReader。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-16T23:26:47.120

布赖恩的想法是正确的——在确定什么被破坏之前不需要开始破坏东西。

另一个疯狂的技巧——看看你是否可以在数据库服务器上运行它，从而消除任何网络延迟。我们有一些相当庞大的批处理流程，仅通过位置更改就可以大幅提高性能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-16T23:29:20.580

这个关于[导入 Stack Overflow 数据转储的](https://stackoverflow.com/questions/999185/is-there-a-script-or-program-that-will-efficiently-and-quickly-load-up-the-so-dum)问题可能对您有用。您可以将数据写入 CSV 文件或使用 XMLTextReader 的文件，然后使用数据库的批量重要机制非常快速地导入数据。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-17T06:30:53.360

首先，确定完成导入过程的可接受时间量。

然后，正如 Brian 和 Wyatt 建议的那样，对大部分时间花在哪里进行一些分析。我猜测 LINQ to SQL 的东西（尽管猜测性能问题出在哪里本身就是一项非常冒险的事情）。

您可以遵循两条路线，即，使用作为 MS SQL 服务器一部分的 ETL 工具进行导入，或者继续使用一些自定义 .NET 代码进行导入。

如果选择后者，我建议：

1.  仅使用 ADO.NET 并删除 LINQ to SQL 的东西；
2.  在数据库服务器上运行导入程序——消除任何网络流量问题；
3.  XML 解析器不太可能成为任何类型的瓶颈，但如果是，请考虑使用简单的模式检查直接解析 XML，而不是使用完全兼容的解析器——当然，这将要求 XML 简单格式，并以逐行方式布局。

Perl 会比 .NET 慢，因为 .NET 是编译的，而 Perl 不是。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-17T07:29:50.370

如果您发现数据访问是瓶颈，您可能想尝试使用 SqlBulkCopy 插入成批的 xml 对象。我有 xml 对象，每个对象有 18 个节点，这对我有用。

```
 // read xml file into datatable
        DataSet ds = new DataSet();
        DataTable callList = new DataTable();

        string AppDataPath = ConfigurationManager.AppSettings["AppDataPath"];
        string dbSchema = AppDataPath + "/" + "CLBulkInsertSchema.xml";

        //Create a FileStream to the XML Schema file in Read mode
        FileStream finschema = new FileStream(dbSchema, FileMode.Open,
                               FileAccess.Read, FileShare.Read);

        //Read the Schema into the DataSet
        ds.ReadXml(finschema);

        //Close the FileStream
        finschema.Close();

        //Create a FileStream to the Xml Database file in Read mode
        FileStream findata = new FileStream(tempFilePathName, FileMode.Open,
                             FileAccess.Read, FileShare.ReadWrite);

        //Read the DataBase into the DataSet
        ds.ReadXml(findata);

        //Close the FileStream
        findata.Close();

        DataTable callList = ds.Tables["PhoneBook"];

        string conn = ConfigurationManager.ConnectionStrings["dbConnectionString"].ToString();

        using (SqlConnection connection =
               new SqlConnection(conn))
        {
            connection.Open();

            using (SqlBulkCopy bulkCopy = new SqlBulkCopy(connection))
            {
                bulkCopy.DestinationTableName =
                    "dbo.CallBatchItems";

                // mappings required because we're skipping the BatchItemId column
                // and letting SQL Server handle auto incrementing of primary key.
                // mappings not required if order of columns is exactly the same
                // as destination table definition. 

                bulkCopy.ColumnMappings.Add("BatchId", "BatchId");
                bulkCopy.ColumnMappings.Add("FullName", "FullName");
                ...
                // Write from the source to the destination.
                bulkCopy.WriteToServer(callList);
            }
        } 
```

# visual-studio - 如何在 Visual Studio 2008 中创建 C++ 或 C# 项目？

> ID：1004029
> 
> 赞同：0
> 
> 时间：2009-06-16T21:26:48.067
> 
> 标签：visual-studio

如何在 Visual Studio 2008 中创建 C++ 或 C# 项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T21:29:37.483

单击`File -> New -> Project`并选择要创建的项目类型。然后，给它一个名字。然后点击`OK`！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T21:30:40.553

你有哪个版本？加载屏幕上有 C# 吗？

文件 > 新建 > 选择你的 C# 项目类型然后离开

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T21:31:50.800

创建一个 c++ 项目：

文件 > 新建 > 项目 > 其他语言 > Visual C++ 并选择您需要的类型。

C＃

文件 > 新建 > 项目 > Visual C# 并选择您需要的类型。

Express 版本硬连线用于 C# 或 C++。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T21:37:38.760

请注意，您需要在安装 Visual Studio 时选择 C# 和 C++ 组件。如果您只选择了 VB，您首先需要重新运行安装程序以添加这些功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T10:32:14.480

要找出安装的内容，请检查关于对话框，帮助 -> 关于，这告诉您要安装组件。如果您安装了 C# 或 C++，那么您可以通过 File 菜单创建一个新项目，正如其他人指出的那样。

如果您有现有的解决方案，则右键单击解决方案资源管理器中的解决方案标题并添加新项目。

# filecompare - 比较两种环境中的文件夹结构

> ID：1004030
> 
> 赞同：15
> 
> 时间：2009-06-16T21:26:55.287
> 
> 标签：filecompare

有没有什么好的工具可以比较两个环境之间的两个文件夹结构（包括文件）？

即比较开发计算机与生产

编辑：

关于一些经验教训的说明：`dir /s /o:N >> output.txt`与文本比较工具（我使用 WinMerge）结合使用效果很好，但文件系统似乎确实很重要。针对 FAT32 的 NTFS 不能很好地工作，因为一个按字母倒序扫描文件夹，而另一个则没有。为了解决这个问题，我将文件从 FAT32 复制到 NTFS 驱动器。

此外，DiffMerge 很好，但速度很慢。它实际上在服务器上运行时（我可以访问两组文件）挂起，以至于我不得不强制退出。

我相信其他人对使用 *NIX 执行此操作有想法。可能是类似的技术`ls -alR > output`

它仍然很手动，但效果很好。

请记住，文件夹上的时间很可能会有所不同，因此您可能希望使用正则表达式来替换它们并使它们更加一致，因为这是相当良性的（我使用`[\d]{2}/[\d]{2}/[\d]{4}[\s]*[\d]{2}\:[\d]{2}\sAM[\s]*\<DIR\>`and `[\d]{2}/[\d]{2}/[\d]{4}[\s]*[\d]{2}\:[\d]{2}\sPM[\s]*\<DIR\>`）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-16T21:30:07.933

我使用 Diff 合并（[http://www.sourcegear.com/diffmerge/](http://www.sourcegear.com/diffmerge/) - 它有免费版本）来比较 Windows 上的文件夹结构

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-16T21:30:44.297

对于在 Windows 上运行的工具（但可以针对 Linux samba 共享工作），请尝试[BeyondCompare](http://www.scootersoftware.com/)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T21:54:31.550

一窗。对从此 cmd 生成的文件使用您最喜欢的 diff 工具。

从您要比较的文件夹中运行它。
c:\somefolder>dir /s > searchResult.txt

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-04T20:41:31.587

[WinMerge](http://winmerge.org/downloads/)还进行文件夹和文件比较及其免费

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T21:49:05.603

选项1）

在另一台机器上安装一台机器，然后使用一些标准的目录比较实用程序。

选项 2)

以某种方式使用`rsync --dry-run`和使用输出。

选项 3)

在每一侧生成文件的哈希值（例如 sha256），然后比较列表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-22T09:07:07.870

[WinDiff](http://www.grigsoft.com/download-windiff.htm)和[KDiff](http://kdiff3.sourceforge.net/)似乎都擅长这样做，而不需要命令行目录列表。我个人的偏好是KDiff。

*   WinDiff 显示所有文件/文件夹的扩展列表。（我只对差异感兴趣，所以在选项菜单中关闭了“显示相同的文件”）。
*   KDiff 提供了一个带有漂亮颜色编码的可扩展树视图。

# maven-2 - hudson/maven 发布快照

> ID：1004046
> 
> 赞同：2
> 
> 时间：2009-06-16T21:29:57.327
> 
> 标签：maven-2, hudson, publish

我希望能够使用 maven 将快照发布到存储库（或者让 hudson 在每次构建后使用 maven 发布快照）。我一直在阅读 POM 的 SCM 部分，我有几个问题。对不起，如果我不在基地 - 这部分对我来说是新的。

1.  我不想将我的用户名和密码放在 POM 的 SCM 部分（在开发人员连接下）。hudson（或其他任何使用 maven 任务的人）是否有任何其他方法可以在不将用户名/密码放入 POM 的情况下获得使用 maven 发布的授权？

2.  对于使用 maven 从存储库中提取，SCM 连接标记是否可以指向 web svn（URL 标记现在可以）。在我们的存储库中，您需要用户名和密码才能下载代码。

谢谢，

杰夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T21:31:48.430

用于发布您的登录数据可以放在 $HOME/.m2/settings.xml

```
<settings>    
    <servers>
        <server>
            <id>internal</id>
            <username>admin</username>
            <password>admin</password>
        </server>
    </servers>
</settings> 
```

要从源代码控制中提取，您需要配置 Hudson，并且不需要从 POM 中读取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T21:35:39.060

您可以从 pom 中删除 SCM 部分，并让 hudson 将“-Dproject.scm.developerConnection=scm:type:user@pass:foobase://footron/fooproj”传递给 maven。

Hudson 不需要 SCM 部分。据我所知，您只有 scm 信息（通过标签或通过它传入）用于发布。您可以部署不带 SCM 标签的快照。

# ruby-on-rails - 关联的 ActiveRecord 条件（Rails）

> ID：1004053
> 
> 赞同：0
> 
> 时间：2009-06-16T21:30:40.647
> 
> 标签：ruby-on-rails, activerecord, named-scope

假装我有一个模型， Post 其中 has_many :comments。如何只显示有评论的帖子？

我对 named_scope 有点满意，但我不知道如何将 Post.comments（或 self.comments）放入需要符号的 :conditions 散列中。

```
class Post < ActiveRecord::Base
     has_many :comments
     named_scope :with_comments, :conditions => [#self.comments.length > 0]
end 
```

我在评论区写什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T22:27:55.913

您应该能够只加入您的评论表，确保选择不同的行

```
named_scope :with_comments, :joins => :comments, :select => 'DISTINCT posts.*' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T03:53:07.703

最好在 Post 上放置一个 counter_cache。

```
class Comment < AR:Base
  belongs_to :post, :counter_cache => true
end 
```

然后你只需要做 1 个查询而不是两个。

`Post.find(:all, :conditions => ["counter_cache > 0"])`

# windows - 在 Windows 中，是什么让 qmake 将“d”附加到调试目标？

> ID：1004060
> 
> 赞同：3
> 
> 时间：2009-06-16T21:32:48.473
> 
> 标签：windows, qt, qmake

我正在使用提供的`.pro`文件，由于某种原因，它被配置为调试库没有在其库名称后附加“d”。是什么原因造成的，我该如何恢复？

例如`QtGui4.dll`（发布）和`QtGuid4.dll`（调试）

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T05:56:49.187

将此添加到 .pro 文件中，它将附加**_debug** for mac 和一个**d** for windows debug build。

```
 CONFIG += debug_and_release

 CONFIG(debug, debug|release) {
     mac: TARGET = $$join(TARGET,,,_debug) 
     win32: TARGET = $$join(TARGET,,,d)
 } 
```

`CONFIG(xx, yy)`此函数可用于测试放置在 CONFIG 变量 `join(variablename, glue, before, after)` 中的变量在前后用胶水连接变量名的值。

[在两种模式下安装](http://doc.trolltech.com/4.5/qmake-common-projects.html#installing-in-both-modes)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T04:16:30.860

在您的 .pro 文件中，添加`debug`到`CONFIG`变量：

```
CONFIG += qt debug 
```

见：[http ://doc.qtsoftware.com/4.5/qmake-tutorial.html#making-an-application-debuggable](http://doc.qtsoftware.com/4.5/qmake-tutorial.html#making-an-application-debuggable)

# objective-c - 是否需要同时释放ivar并将合成的ivar设置为nil？

> ID：1004062
> 
> 赞同：9
> 
> 时间：2009-06-16T21:32:56.960
> 
> 标签：objective-c

我已经看到代码（可能是Apple自己的示例代码）以这样的方式编写，它在dealloc中释放ivar并在viewDidUnload中设置属性。

例如

```
- (void)viewDidUnload
{
  self.navigationController = nil;
}

- (void)dealloc
{
   [_navigationController release];
} 
```

为什么他们在两个地方？另外，为什么在一个中设置 nil 并在另一个中释放。似乎 self.property = nil 会处理所有事情，因为它会释放并将 ivar 设置为 nil。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T21:40:57.087

你是对的：你确实可以`self.property = nil`在任何地方做，包括dealloc。唯一的缺点是，如果 setter 方法做的事情比仅仅释放 ivar 更复杂，你最终可能会尝试访问已经释放的其他字段，等等。

至于为什么还要在 中放出outlet `viewDidUnload`，那是内存优化。由于您释放的`viewDidUnload`内容是在再次加载视图时将重新实例化的内容，因此在内存不足的情况下释放它们可以释放内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T02:38:00.137

Apple 建议您不要在 init 中调用 setter，尤其是在 dealloc 例程中。

这是因为此时对象只是部分设置，setter 可能会附加观察者，或者可能被子类覆盖，否则会在 dealloc 期间产生不良影响，或者可能在 init 期间与部分配置的对象。

因此，您通常使用：

```
_navigationController = [[NavController alloc] init]; 
```

初始化例程中的样式代码，

```
[_navigationController release]; 
```

您的 dealloc 中的样式代码，以及已知对象已完全完成的其他代码中的设置器。

需要考虑的一些情况：

*   子类覆盖 setNavigationController 并引用它自己的由 init 分配的 ivars。初始化时崩溃。
*   子类覆盖 setNavigationController 并引用自己在 dealloc 中发布的 ivars。释放时崩溃。
*   子类覆盖 setNavigationController 并重绘屏幕的某些部分。毫无意义地浪费周期或显示故障。
*   同时释放的其他对象观察 navigationController 并且这些观察者在 dealloc 期间触发
*   ETC

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T21:41:26.430

如果您依赖垃圾收集（在 Objective-C 2.0 中可用），那么设置`ivar`to`nil`和调用`release`将达到相同的目的。

我猜您正在查看的代码正在管理内存`release`并且仅将其设置为`nil`以便您以后不会尝试访问不再存在的对象。当`nil`您不依赖 GC 时，记账比内存管理更多。

# php - PHP类函数不起作用

> ID：1004069
> 
> 赞同：0
> 
> 时间：2009-06-16T21:35:40.513
> 
> 标签：php

我一般是 PHP 和网络脚本的新手，所以这是一个新手问题。

目前我正在为一个对象创建一个实例，但是当我调用构造函数时，脚本会关闭......它不会调用下一个函数，我不知道为什么。欢迎任何帮助。

这是代码。

```
<?php
class product {
    var $ssProductName;
    var $ssVendorName;
    var $ssDescr;
    var $ssURI;

    // Clean constructor, strings must be cleaned before use
    function __construct($ssProd, $ssVendor, $ssD, $ssU) {
        $this->$ssProductName = $ssProd;
        $this->$ssVendorName = $ssVendor;
        $this->$ssDescr = $ssD;
        $this->$ssURI = $ssU;
    }

    // print a table of the values
    function DisplayOneEntry() {

        echo '<table border="1">
                    <tr>
                    <td>'.$this->$ssProductName.'</td>
                    <td>'.$this->$ssVendorName.'</td>
                    <td>'.$this->$ssDescr.'</td>
                    <td>'.$this->$ssURI.'</td>
                    </tr>
                    </table>';
    }

}

echo "<HTML>";
echo "A";
$newP = new product("Redhat", "Redhat corp", "Leader in", "www.redhat.com");
echo "B";
$newP->DisplayOneEntry();

echo "</HTML>";
?> 
```

但输出只是：

```
<HTML>
A 
```

然后没有别的了。

这是在使用 php 5.2.9 和 Apache 2.2 的托管服务提供商上运行的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-16T21:40:31.593

您需要通过以下方式访问成员变量：

```
$this->variableName 
```

不是：

```
$this->$variableName 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T21:41:31.670

```
 $this->$ssProductName = $ssProd; 
```

应该

```
 $this->ssProductName = $ssProd; 
```

-> 后面没有 $

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T21:41:44.527

语法`$this->$foo`是一个[变量变量](http://docs.php.net/manual/en/language.variables.variable.php)，它引用类属性，名称为`$foo`。所以如果`$foo`有价值`bar`，`$this->$foo`就会参考`$foo->bar`而不是`$this->foo`。

所以只需删除`$`之后`$this->`，它应该可以工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T21:43:17.987

那是因为你的 php 脚本是错误的。要捕获此类错误，您应该在调试服务器上运行它（`display_errors`设置为`On`）或使用其他日志记录方法。

但是，主要问题是您以错误的方式访问对象成员；没有第二个美元符号。代替

```
$this->$ssProductName = $ssProd; 
```

采用

```
$this->ssProductName = $ssProd; 
```

# database-design - DB Design：什么时候应该创建一个公共属性的超类？

> ID：1004070
> 
> 赞同：2
> 
> 时间：2009-06-16T21:35:42.120
> 
> 标签：database-design, normalization

为了描述我的困境，让我首先从一个示例问题开始（从[这里](http://www.tomjewett.com/dbdesign/dbdesign.php?page=subclass.php)偷来的）。假设您的数据库中有一个 GradStudent 表，如下所示：

```
GradStudent:
firstName
lastName
birthDate
courseAssignment
researchGrant 
```

但是只有助教才有课程作业，只有研究助理才有研究资助，所以这两者中的一个永远是空的。显然这不是最优的，最好这样做：

```
GradStudent:
firstName
lastName
birthDate

TeachAsst:
courseAssignment

ResearchAsst:
researchGrant 
```

其中 TeachAsst 和 ResearchAsst 具有来自 GradStudent 表的外键（可能是“studentID”代理）。

我也理解为什么最好制作两个完全独立的表格，例如：

```
TeachAsst:
firstName
lastName
birthDate
courseAssignment

ResearchAsst:
firstName
lastName
birthDate
researchGrant 
```

因为您重复了许多具有相同含义的属性。

但是，如果两个不同的类几乎没有任何共同的领域，那么它们*将*是有意义的（我认为），例如：

```
TeachAsst:
name
courseAssignment
payRate
numStudents

ResearchAsst:
name
researchGrant
facultyAdvisor
researchTopic 
```

在这里，它们只有一个共同的“name”，所以让一个 GradStudent 超类只有一个“name”属性会很愚蠢吗？转折点在哪里？您如何决定何时拥有公共信息的超类，或何时让两个类完全分开？拥有超类会使大部分 CRUD 变得更加困难，因为要创建或更新 TeachAsst，您需要更改两个表，而不仅仅是一个。

再举一个例子，假设您正在处理的数据库涉及测量不同电子设备上的信息。虽然相机和手机具有相同的长度/宽度/高度，但大多数其他测量值不会重合（例如，相机不会有任何音频信息，手机不会有任何镜头或视口测量值）。因此，拥有一个完全独立的 cameraData 表和一个 mobileData 似乎几乎更简单，而不是将它们的少量公共信息放入一个超类表中。你怎么看？是否有一条一般规则说您应该始终将公共数据放在一个超类中，即使它只是子类描述性数据的一小部分？

**编辑：假设在研究生示例中，研究生要么是助教，要么是研究助理，永远不会转换角色，也永远不会两者兼而有之。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T15:55:57.697

我认为自己对数据库设计来说相对较新，所以把它当作它的价值。在第一个示例中，我的第一个想法是确实维护一个单独的“GradStudent”表，其中包含姓名和其他个人信息。在我看来，它可以让你灵活应对未来的潜在变化。例如，如果创建了除 TeachAsst 或 ResearchAsst 之外可由个人担任的另一个 GradStudent 角色怎么办？您可以创建一个“GradStudent_Relationship”表，以适应未来的其他角色，例如：

```
GradStudent_Relationship:
GradStudent_ID (fk)
ResearchAsst_ID (fk)
TeachAsst_ID (fk)
NewGradStudentRole_ID (fk) 
```

至于让你的 CRUD 操作更艰难，在我看来，增加的灵活性超过了这种担忧。也许您可以在数据库中设置触发器来帮助解决这个问题？

关于第二个例子，为什么相机不能有音频？某些数码相机不会录制包含音频的视频吗？另外，为什么手机不能有镜头或视口测量？现在不是很多手机都带摄像头了吗？

对于它的价值，我有时会发现尽可能地抽象“类”以保持最大的灵活性是有帮助的。正如您提到的，在 CRUD 操作方面可能存在一些折衷，但就个人而言，我喜欢知道数据库模式可以处理未来的潜在变化。

我希望这至少有点帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:04:28.653

在 GradStudent 场景中，您具有以下属性：

GradStudent 可以先成为 TeachAsst，然后再成为 ResearchAsst。或者她可以同时是两者。

在这种情况下，非规范化可能不是一个好主意。

然而，在您的情况下，您测量的是相机和手机。他们永远不会变成别的东西。我认为为了降低复杂性，您可能会冒非规范化的风险。

或者，您甚至可以考虑使用像[CouchDB](http://couchdb.apache.org/)这样的文档数据库，您不必遵循任何模式。

# java - 应用服务器日志

> ID：1004074
> 
> 赞同：0
> 
> 时间：2009-06-16T21:36:49.073
> 
> 标签：java, logging

您使用哪些技术/工具来分析应用程序服务器日志？

我的开发环境是 Windows，我的日志在 prod unix 盒子上。有时我需要查看几个月前的归档日志（至少在 4 个服务器上），以找出错误或异常的根本原因。这是一个耗时的过程，我想从社区中听到一些最佳实践。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T22:14:21.277

如果您有大量日志，您可以查看日志索引/搜索解决方案。这将使您能够实时索引日志文件，并允许您通过关键字搜索所需的数据。有一个名为 Splunk 的产品可以在这里为您提供帮助：

[http://www.splunk.com/](http://www.splunk.com/)

对于开源版本，请参阅以下以前的 stackoverflow 链接：

[Splunk 有哪些商业和开源竞争对手？](https://stackoverflow.com/questions/183977/what-commercial-and-open-source-competitors-are-there-to-splunk)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T21:55:21.440

除了自定义脚本之外，还有多种工具可以帮助您解决此问题。有很多非常好的付费解决方案可供使用。

一个不错的开源选项是链锯，它来自 log4j 开发人员并且是 apache 许可的：

[http://logging.apache.org/chainsaw/index.html](http://logging.apache.org/chainsaw/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T22:13:54.477

退后一步，看看您是否有日志搜索问题或错误报告问题。

一个错误会导致多个日志条目还是一个？对于每个错误，您是否有数千行信息和调试消息？为什么你的日志很难搜索？

没有看到你的代码；是否到处都是以下内容？

```
} catch (Exception e) {
  //error suppressed 
  log.error("error" + e.getMessage());
} 
```

...

```
} catch (Exception e) {
  //error logged and passed along
  log.error("error" + e.getMessage());
  throw e;
} 
```

...

```
} catch (Exception e) {
  //error logged and new one passed along
  log.error("error" + e.getMessage());
  throw new Exception("error" + e.getMessage());
} 
```

最终结果是，一个错误可能导致多个错误日志条目，因为问题被记录和退回而不是处理。我称之为官僚日志记录，因为所有错误都一式三份提交，传递，没有人在处理问题时承担实际责任。

我会考虑将错误与信息和调试消息分开，并努力使报告的错误更容易找到。

# sql - 选择 group by 子句中的前 n 行

> ID：1004079
> 
> 赞同：10
> 
> 时间：2009-06-16T21:37:24.563
> 
> 标签：sql, sql-server

我有类似于以下的架构：

```
create table bar
(
    instrument varchar(255) not null,
    bar_dttm datetime not null,
    bar_open int not null,
    bar_close int not null
) 
```

我想查询该表，并返回每个仪器最近的 5 行。

我可以通过仪器来做，有：

```
select top 5 instrument, bar_dttm, bar_open, bar_close
from bar
where instrument = 'XXX'
order by bar_dttm desc 
```

我想在一个查询中一次对所有仪器执行此操作。这可能吗？我正在运行 SQL Server 2008。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-16T21:39:05.653

CROSS APPLY 是您通常执行此操作的方式 - [http://msdn.microsoft.com/en-us/library/ms175156.aspx](http://msdn.microsoft.com/en-us/library/ms175156.aspx)

编辑 - 添加示例，如下所示：

```
select
    bar1.instrument
    ,bar2.*
from (
    select distinct instrument from bar) as bar1
cross apply (
    select top 5
        bar2.instrument
        ,bar2.bar_dttm
        ,bar2.bar_open
        ,bar2.bar_close 
    from bar as bar2 where bar2.instrument = bar1.instrument) as bar2 
```

通常你会想在那里添加一个订单。

编辑 - 为查询添加了不同的内容，希望能满足您的需求。编辑 - 在顶部添加了缺失的“选择”关键字。复制和粘贴错误 FTL！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-16T21:44:09.107

使用 SQL 2008，您可以使用带有 CTE 的分区行号子句...

```
with MyCte AS (SELECT      instrument, 
                           bar_dttm, 
                           bar_open, 
                           bar_close,
                           PartitionedRowNum = ROW_NUMBER() OVER (PARTITION BY instrument ORDER BY bar_dttm DESC)
               from        bar)
select  *
from    MyCte
where   PartitionedRowNum <= 5 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-16T21:45:53.567

也可以使用 Row_Number - [http://msdn.microsoft.com/en-us/library/ms186734.aspx](http://msdn.microsoft.com/en-us/library/ms186734.aspx)

```
WITH foo as (
Select
 *
 ,ROW_NUMBER() OVER(PARTITION BY instrument ORDER BY bar_dttm desc) as rank
from
 bar
)

select 
 *
from
 foo
where
 rank <= 5 
```

# latex - LaTeX 中的定理编号

> ID：1004082
> 
> 赞同：7
> 
> 时间：2009-06-16T21:38:29.697
> 
> 标签：latex

我对 LaTeX 中的定理编号有疑问。我可以按小节编号，例如

> 定理 1.2.1

对于第一部分的第二小节中的第一个定理。但我需要它只显示小节和定理的数字，而不是节号，如下所示：

> 定理 2.1

我用

```
\newtheorem{thm}{Theorem}[subsection] 
```

为编号。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-16T22:19:16.837

将以下代码放在序言中似乎具有预期的效果：

```
\usepackage{amsthm}
\newtheorem{thm}{Theorem}[subsection]
\renewcommand{\thethm}{\arabic{subsection}.\arabic{thm}} 
```

我不明白你为什么想要这个特定的定理编号系统，但代码可以满足你的需求： ![乳胶输出](../Images/7c8c262f66c86863d0509ac5ddfeebe7.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T21:44:25.113

这行得通吗？

```
\newtheorem{thm}{Theorem}[section] 
```

请参阅这些[LaTeX 技巧](https://web.archive.org/web/20090618120131/http://www.math.uiuc.edu/~hildebr/tex/theorems.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T22:06:55.253

没有*简单*的方法可以做到这一点。如果它与其他环境（推论、引理）和编号顺序（“1.1 Theorem”与“Theorem 1.1”）相关联，AMS Theorem Package 仅提供了一种控制编号重置（部分、子部分）的方法[。](ftp://ftp.ams.org/pub/tex/doc/amscls/amsthdoc.pdf)

Theorem 从`\thesection`or`\thesubsection`命令中得到它们的编号。您可以重新定义命令以获得所需的编号，*但这*`\thesubsection`也会影响使用.*`\thesubsection`*

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-15T16:55:45.910

以一种稍微不那么老套的方式，您可以创建一个用 重置的假计数器，然后根据自己的喜好`subsection`重新定义它：`\the`

```
\newcounter{fakecnt}[subsection]
\def\thefakecnt{\arabic{subsection}}
\newtheorem{thm}{Theorem}[fakecnt] 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-16T21:58:22.620

在你的序言中插入这一行（或 \newtheorem 语句之前的任何其他地方）：

```
\renewcommand{\thesubsection}{\arabic{subsection}} 
```

这将重置 thm 环境的编号命令以忽略节号（在给定理编号时）并仅显示子节号和定理号。章节编号仍将显示在章节标题的前面，而不是章节中包含的定理。因此，正如您所描述的，第一部分第二小节中的第一个定理将编号为 2.1。\arabic 的替代品包括：

*   \Roman - 产生大写罗马数字，例如 II.1
*   \roman - 生成小写罗马数字，例如 ii.1
*   \Alph - 产生大写字母，例如 B.1
*   \alph - 产生小写字母，例如 b.1

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-06-02T17:39:08.107

您可以使用此命令更新命令部分和子部分以及定理和...

```
\renewcommand{\theequation}{\thesection.\arabic{equation}}
\renewcommand{\thesection}{\arabic{section}}
\renewcommand{\thesubsection}{(\alph{subsection})}‎‎‎ 
```*

# iphone - 如何在 UIWebView 中搜索？

> ID：1004094
> 
> 赞同：3
> 
> 时间：2009-06-16T21:40:51.500
> 
> 标签：iphone, uiwebview

我需要在 UIWebView 控件中显示的 html 页面中执行搜索。我需要的功能是 Safari 具有的功能，当您点击 command/ctrl F 以在文档中搜索某个单词并且程序会为您突出显示这些点击时。这个问题有什么简单的解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-10-08T18:08:51.057

我知道你问这个问题已经很长时间了，但这仍然是人们提出的一个很常见的问题，所以我整理了一个示例项目，以防其他人问同样的问题。该项目是一个超级简单的应用程序，它加载一个 HTML 文件并可以搜索和突出显示任何关键字。您可以在此处下载示例项目：

[https://www.dropbox.com/s/jietctrvrtnec28/TheSearcher.zip?dl=0](https://www.dropbox.com/s/jietctrvrtnec28/TheSearcher.zip?dl=0)

斯科特

编辑：更改了上面的链接，因为旧链接已损坏。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T21:31:28.310

你可以用javascript做到这一点。查看“在此页面中查找”书签： [http ://www.lifeclever.com/17-powerful-bookmarklets-for-your-iphone/](http://www.lifeclever.com/17-powerful-bookmarklets-for-your-iphone/)

类似的东西，结合： http: [//developer.apple.com/iphone/library/documentation/uikit/reference/UIWebView_Class/Reference/Reference.html#//apple_ref/occ/instm/UIWebView/stringByEvaluatingJavaScriptFromString](http://developer.apple.com/iphone/library/documentation/uikit/reference/UIWebView_Class/Reference/Reference.html#//apple_ref/occ/instm/UIWebView/stringByEvaluatingJavaScriptFromString)：

可能会成功。

# html - html表格显示大量数据的设计思路

> ID：1004096
> 
> 赞同：5
> 
> 时间：2009-06-16T21:41:12.187
> 
> 标签：html, html-table

我有一个 html 表，它实际上有 30 列数据，而且我很难以一种无需大量左/右滚动就可以看到它的方式来构建它。

我想知道的一件事是，是否有人见过列标题的巧妙之处？其中一些只是不能足够缩写，但列标题类似于“采访”，值是数字（仅标题就浪费了很多空间）。当然，我可以尝试将这些列命名为 INT 之类的名称，但是有很多名称相似的列可能会让人感到困惑。

也许某种基于鼠标移动的自动折叠列？不确定..我只需要一些关于如何显示这些数据的创造性建议！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T21:47:28.350

无论滚动如何，用户很可能都会花时间理解 30 列数据。

我建议显示最基本的列（名称、描述、标识号等核心内容，希望只有 10 个或更少），然后让用户打开或关闭他们需要的任何列。有点像[谷歌平方](http://www.google.com/squared)。

使用 Jquery 和 CSS 以干净的方式完成此任务。也可能有 Javascript UI 库可以为您执行此操作（Jquery UI、YUI、其他...）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T21:42:44.867

为列名创建图像并将图像中的文本旋转 90 度。然后你可以有一个同样小的宽度的长名称。

乔什

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T22:17:18.183

我同意凶猛、切换列的答案是个好主意。此外，根据数据，我建议只显示几列，当用户单击他们感兴趣的行时，它会移动到专门用于该记录中数据的新页面。这将适用于某些类型的数据，而不适用于其他类型的数据

# django - 如何使 Django 的 DATETIME_FORMAT 处于活动状态？

> ID：1004109
> 
> 赞同：12
> 
> 时间：2009-06-16T21:43:34.850
> 
> 标签：django

DATETIME_FORMAT 应该放在哪里才能影响 Django 管理站点（Django 的自动管理界面）中日期时间的显示？

DATETIME_FORMAT 的文档，在 [http://docs.djangoproject.com/en/1.0/ref/settings/](http://docs.djangoproject.com/en/1.0/ref/settings/)页面上说：

```
"The default formatting to use for datetime fields on
Django admin change-list pages -- and, possibly, by
other parts of the system." 
```

**更新 1**：尽管有文档，但 DATETIME_FORMAT 已损坏（忽略它的值）。许多年前它就起作用了，但从那时起，Django 的实现就被打破了。此功能。似乎 Django 社区无法决定如何修复它（但与此同时，我认为他们应该从文档中删除 DATETIME_FORMAT 或添加有关此问题的注释）。

我已将这些行放入网站/项目（不是应用程序）的文件“settings.py”中，但它似乎没有任何效果（重新启动开发服务器后）：

> DATETIME_FORMAT = 'Ymd H:i:sO'
> 
> DATE_FORMAT = 'Ymd'

例如，使用 Django 管理站点时会显示“2009 年 6 月 29 日，晚上 7:30”。

Django 版本是 1.0.2 最终版本，Python 版本是 2.6.2（64 位）。平台：Windows XP 64 位。

Stack Overflow question *[European date input in Django Admin](https://stackoverflow.com/questions/907351)*似乎是关于完全相反的问题（因此是一个明显的矛盾）。

文件“settings.py”的完整路径是“D:\dproj\MSQall\website\GoogleCodeHost\settings.py”。我现在以这种方式启动开发服务器（在 Windows 命令行窗口中）：

> cd D:\dproj\MSQall\website\GoogleCodeHost
> 
> 设置 DJANGO_SETTINGS_MODULE=GoogleCodeHost.settings
> 
> python manage.py runserver 6800

没有区别。除此之外，这些都是从文件“settings.py”中积极读取的：

> 数据库名称
> 
> INSTALLED_APPS
> 
> TEMPLATE_DIRS
> 
> MIDDLEWARE_CLASSES

“django-admin.py startproject XYZ”不会创建包含 DATETIME_FORMAT 或 DATE_FORMAT 的文件“settings.py”。也许这是有原因的？

序列“d:”、“cd D:\dproj\MSQall\website\GoogleCodeHost”、“python manage.py shell”、“from django.conf import settings”、“settings.DATE_FORMAT”、“settings.DATETIME_FORMAT”输出（如预期）：

```
'Y-m-d H:i:sO'
'Y-m-d' 
```

因此正在读取文件“settings.py”的内容，但在 Django Admin 界面中没有生效。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-23T15:42:15.387

和：

```
USE_L10N = False 
```

`DATE_TIME`生效，因为 l10n 的本地化覆盖`DATETIME_FORMAT`并`DATE_FORMAT`记录在：[https ://docs.djangoproject.com/en/1.9/ref/settings/#date-format](https://docs.djangoproject.com/en/1.9/ref/settings/#date-format)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-09-13T19:25:16.540

正如 Ciro Santilli 所说，`DATETIME_FORMAT`当`USE_L10N = True`. 但是您仍然可以`DATETIME_FORMAT`通过创建自定义格式文件来覆盖和其他日期/时间格式，[如 Django 文档中所述](https://docs.djangoproject.com/en/1.10/topics/i18n/formatting/#creating-custom-format-files)。

[在此处](https://stackoverflow.com/a/39477478/258772)查看详细答案。

> 通过创建自定义格式文件时，您可以覆盖`DATE_FORMAT`、和其他日期/时间格式[，如 Django 文档中所述](https://docs.djangoproject.com/en/2.0/topics/i18n/formatting/#creating-custom-format-files)。`DATETIME_FORMAT``TIME_FORMAT``USE_L10N = True`
> 
> 总之：
> 
> 1.  设置`FORMAT_MODULE_PATH = 'yourproject.formats'`在`settings.py`
> 2.  创建目录结构`yourproject/formats/en`（`en`如果您使用英语以外的其他语言环境，则替换为相应的 ISO 639-1 语言环境代码）并将`__init__.py`文件添加到所有目录以使其成为有效的 Python 模块
> 3.  添加`formats.py`到叶目录，包含您要覆盖的格式定义，例如`DATE_FORMAT = 'j. F Y'`.
> 
> 来自实际项目的[示例](https://github.com/mrts/foodbank-campaign/blob/master/src/foodbank/formats/et/formats.py)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T00:43:43.807

这将解决 DATETIME_FORMAT 无法解决的特定问题（因为它在当前的 Django 实现中被忽略，尽管有文档），也很脏并且类似于 ayaz 的答案（不太全局 - 只会影响管理站点列表视图）：

就在这条线之后

> (date_format, datetime_format,time_format) = get_date_formats()

在文件中（Django 通常在 Python 安装中的文件夹 Lib/site-packages 中）

> django/contrib/admin/templatetags/admin_list.py

覆盖 datetime_format 的值（对于模型中的 models.DateTimeField）：

> datetime_format = 'Ymd H:i:sO'

对于仅日期字段：

> date_format = 'Ymd'

**无需**重启 Web 服务器（例如开发服务器）或退出管理界面即可使此更改生效。只需在网络浏览器中进行简单的刷新即可。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T12:38:54.553

这两个设置指令应该在`settings.py`. 您能否确保`settings.py`在启动开发服务器时正在读取您正在编辑的内容？

您总是可以通过运行进入 Python 交互式 shell `python manage.py shell`，并运行这些命令以确保日期/时间格式值是否正常：

```
from django.conf import settings
settings.DATE_FORMAT
settings.DATETIME_FORMAT 
```

好的，我忘记查了，但[票 #2203](http://code.djangoproject.com/ticket/2203)处理这个问题。不幸的是，该票仍处于待处理状态。

我记得对于一个使用 Django 0.97 分支的某个主干修订版的项目，我通过覆盖函数 inside中的`date_format`and`datetime_format`值来解决这个问题。它很脏，但我已经为那个项目使用了某种定制的 Django，所以在破解它时没有发现任何问题。`get_date_formats()``django/utils/translation/trans_real.py`

# sql-server - 使用存储过程控制所有数据流的海量表的优缺点

> ID：1004110
> 
> 赞同：0
> 
> 时间：2009-06-16T21:43:37.173
> 
> 标签：sql-server, stored-procedures, datamodel

DBA（只有 2 年的 google 培训经验）创建了一个海量数据管理表（108 列并且还在增长），其中包含系统中任何数据流的所有必要属性。好吧，将此表简称为 BFT。

在这些列中：
10 个用于元数据引用。
15 个用于数据源和时间跟踪
1 个用于文本数据的新/当前列
实例 10 个用于多值数值更新的新/当前/增量/比率/范围列实例：总计 50 列。

多值数值更新通常只需要 2-5 个更新组。

15K-1500K 记录的批次被加载到 BFT 中，并由存储的过程进行处理，并使用逻辑来验证这些记录，将它们洗牌到大约 30 个其他表中的永久存储中。

在大多数记录加载中，50-70 列在整个过程中都是空的。

我不是数据库专家，但是这个模型和过程似乎有点味道，但我不知道为什么要说原因，也不想抱怨而无法提供替代方案。

鉴于对数据处理模型的这种非常小的洞察力，是否有人有想法或建议？是否可以信任数据库（SQL Server）以有效地处理具有大部分空列的记录，或者以这种方式进行处理浪费了大量的周期/内存等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T21:51:31.417

听起来他重新发明了[BizTalk](http://www.microsoft.com/biztalk/en/us/default.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T21:49:18.300

规范化是这里的关键词。如果您有这么多 NULL 值，那么您很可能会浪费大量空间。规范化表还应该使该表中的数据完整性更易于实施。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T21:51:02.790

我通常有多个与输入负载相对应的临时表。这些可能对应于目标表，也可能不对应，但我们不做你所说的。如果他不喜欢有很多基本上是临时工作表的东西，可以将它们放入自己的模式甚至单独的数据库中。

至于为空的列，如果在处理 BFT 的特定查询中没有引用它们，那也没关系 - 但是，会发生的情况是索引变得更加重要，因为选择的索引是非聚集覆盖索引。当使用 BFT 并选择表扫描或聚集索引扫描时，必须读取并忽略或跳过未使用的列，根据我的经验，这似乎肯定会影响处理。而使用非聚集索引扫描或查找时，读取的列更少，并且希望这不包括（m）任何未使用的列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T23:51:04.793

可能使事情变得更灵活的一件事（除了规范化）可能是创建一个或多个视图或表函数来呈现数据。特别是如果桌子不在您的控制范围内，这些将使您能够过滤掉虚假的废话并仅从桌子中获取您需要的东西。

但是，如果您要成为与那张巨大的桌子一起工作的人之一（并且每次必须打开时都皱着眉头），您可能想要胜过 DBA 的“设计”并规范化该野兽，也许让 DBA 创建一些视图和/或表函数来帮助*您*。

我目前正在使用一个类似但不是那么大的表，该表已经在我们的系统中使用了多年，并且有新的字段、索引和约束，相当仓促地加入了科学怪人的风格。不幸的是，其他一些工作组将结构视为福音，因此我们创建了这样的视图和功能，使我们能够以我们需要的方式“塑造”数据。

# java - 在同一条语句中获取插入的 id

> ID：1004128
> 
> 赞同：9
> 
> 时间：2009-06-16T21:48:36.650
> 
> 标签：java, database, oracle, jdbc

有没有办法在一个表中插入一行并获取新生成的 ID，只在一个语句中？我想使用 JDBC，ID 将由一个序列生成或将是一个自增字段。

谢谢你的帮助。

约翰·波兰克

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-16T21:53:57.357

使用 getGeneratedKeys()：

```
resultSet = pstmt.getGeneratedKeys(); 

if (resultSet != null && resultSet.next()) { 
    lastId = resultSet.getInt(1); 
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-16T22:26:21.783

您可以使用该`RETURNING`子句获取已更新或插入的任何列的值。它适用于触发器（即：您在触发器执行后获得实际插入的值）。考虑：

```
SQL> CREATE TABLE a (ID NUMBER PRIMARY KEY);

Table created
SQL> CREATE SEQUENCE a_seq;

Sequence created
SQL> VARIABLE x NUMBER;
SQL> BEGIN
  2     INSERT INTO a VALUES (a_seq.nextval) RETURNING ID INTO :x;
  3  END;
  4  /

PL/SQL procedure successfully completed
x
---------
1

SQL> /

PL/SQL procedure successfully completed
x
---------
2 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-06T09:01:57.790

实际上，我认为 nextval 后跟 currval 确实有效。这里有一段代码用两个线程模拟这种行为，一个首先执行 nextval，然后是 currval，而第二个线程在两者之间执行 nextval。

```
public void checkSequencePerSession() throws Exception {
     final Object semaphore = new Object();
     Runnable thread1 = new Runnable() {
        public void run() {
           try {
              Connection con = getConnection();
              Statement s = con.createStatement();
              ResultSet r = s.executeQuery("SELECT SEQ_INV_BATCH_DWNLD.nextval AS val FROM DUAL ");
              r.next();
              System.out.println("Session1 nextval is: " + r.getLong("val"));
              synchronized(semaphore){
                 semaphore.notify();
              }
              synchronized(semaphore){
                 semaphore.wait();
              }
              r = s.executeQuery("SELECT SEQ_INV_BATCH_DWNLD.currval AS val FROM DUAL ");
              r.next();
              System.out.println("Session1 currval is: " + r.getLong("val"));
              con.commit();
           } catch (Exception e) {
              e.printStackTrace();
           }
        }
     };
     Runnable thread2 = new Runnable(){
        public void run(){
           try{
              synchronized(semaphore){
                 semaphore.wait();
              }
              Connection con = getConnection();
              Statement s = con.createStatement();
              ResultSet r = s.executeQuery("SELECT SEQ_INV_BATCH_DWNLD.nextval AS val FROM DUAL ");
              r.next();
              System.out.println("Session2 nextval is: " + r.getLong("val"));
              con.commit();
              synchronized(semaphore){
                 semaphore.notify();
              }
           }catch(Exception e){
              e.printStackTrace();
           }
        }
     };
     Thread t1 = new Thread(thread1);
     Thread t2 = new Thread(thread2);
     t1.start();
     t2.start();
     t1.join();
     t2.join();
} 
```

结果如下： Session1 nextval is: 47 Session2 nextval is: 48 Session1 currval is: 47

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T07:39:17.463

我无法发表评论，否则我会添加到 Vinko Vrsalovic 的帖子中：

```
The id generated by a sequence can be obtained via 

insert into table values (sequence.NextVal, otherval)
select sequence.CurrVal

ran in the same transaction as to get a consistent view. 
```

从序列中获取 nextval 后更新序列是一个自主事务。否则，另一个会话将从序列中获得相同的值。因此，如果另一个会话已从插入和选择之间的序列中选择，则获取 currval 将不会获得插入的 id。

问候， 罗伯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T01:05:41.790

我想你会发现这很有帮助：

> 我有一个带有自动递增 id 的表。有时我想向这个表中插入行，但希望能够知道新插入的行的 pk 是什么。

```
String query = "BEGIN INSERT INTO movement (doc_number) VALUES ('abc') RETURNING id INTO ?; END;";
OracleCallableStatement cs = (OracleCallableStatement) conn.prepareCall(query);
cs.registerOutParameter(1, OracleTypes.NUMBER );
cs.execute();
System.out.println(cs.getInt(1)); 
```

来源：[线程：从插入返回值时发生 Oracle / JDBC 错误](http://forums.oracle.com/forums/thread.jspa?messageID=1702717)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T05:49:23.333

我无法发表评论，否则我只会添加到 dfa 的帖子中，但以下是使用直接 JDBC 的此功能的示例。

[http://www.ibm.com/developerworks/java/library/j-jdbcnew/](http://www.ibm.com/developerworks/java/library/j-jdbcnew/)

但是，如果您使用的是 Spring 之类的东西，它们将为您掩盖很多血腥的细节。如果这可以提供任何帮助，那就是 Spring Chapter 11，这是 JDBC 的详细信息。使用它为我省去了很多麻烦。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T21:53:01.507

直到执行 INSERT 之后才知道自动生成的 ID 的值，因为其他语句可能同时执行并且 RDBMS 决定如何安排哪个先执行。

您在 INSERT 语句中的表达式中调用的任何函数都必须在插入新行之前进行评估，因此它无法知道生成了什么 ID 值。

我可以想到两个接近您所要求的选项：

*   编写一个在 INSERT 之后运行的触发器，以便您可以访问生成的 ID 键值。

*   编写一个过程来包装插入，这样就可以执行过程中的其他代码，查询最后生成的ID。

但是，我怀疑您真正要问的是，即使其他会话也在插入行并生成自己的 ID 值*，您是否可以查询当前会话最后生成的 ID 值。*您可以放心，**每个提供自动增量功能的 RDBMS 都提供了一种查询此值的方法**，它会告诉您在当前会话范围内生成的最后一个 ID。这不受在其他会话中完成的插入的影响。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-16T21:54:44.407

序列生成的id可以通过

```
insert into table values (sequence.NextVal, otherval)
select sequence.CurrVal 
```

在同一事务中运行以获得一致的视图。

# vb.net - 拆分字符串

> ID：1004132
> 
> 赞同：-1
> 
> 时间：2009-06-16T21:49:24.557
> 
> 标签：vb.net

> **可能重复：**
> [拆分字符串](https://stackoverflow.com/questions/996921/splitting-a-string)

我有一个看起来像这样的字符串：http: [//pastebin.com/m5508ff19](http://pastebin.com/m5508ff19)

我需要获取每个数字并按以下顺序将它们放入一个数组中：0、50、100、100、200、400、218、9.8、???、6.65、6.31 等...

我有以下代码，但由于某种原因，它只显示第一列，它只给我 0、50、100、100、200、400、218、9.8、???

```
Dim list_numbers As New List(Of String)

Dim fields() As String
fields = calculationText.Split(Environment.NewLine)

For Each CurrLine As String In fields
    list_numbers.Add(CurrLine.Split(Char.Parse("    "))(0))
Next 
```

我需要帮助才能按上述顺序获取数组中的每个数字

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T21:51:56.190

你不是已经[问过这个问题了](https://stackoverflow.com/questions/996921/splitting-a-string)吗？那里提供的答案对您没有帮助吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T21:53:14.737

您在第二个 Split() 函数的末尾添加 (0) ；这只会抓住第一个元素。

（免责声明 - 我不知道 VB.Net，但这是我基于 C# 经验的最佳猜测。）

# .net - Quartz.NET 服务器文档

> ID：1004133
> 
> 赞同：6
> 
> 时间：2009-06-16T21:49:32.670
> 
> 标签：.net, quartz-scheduler

下载 Quartz.NET 时，它包含一个带有控制台应用程序的服务器组件。

网站、常见问题解答和 API 文档没有提及任何相关内容。

有人会知道更多关于它的信息，或者知道我在哪里可以找到更多关于它的文档吗？

谢谢，帕特里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T22:00:07.093

好吧，您可以加入[Quartz.NET Google 组](http://groups.google.com/group/quartznet)并提问或阅读档案。我成功地使用了石英服务器客户端和来自客户端的远程调度，我从下载的代码示例中学到了所有我需要的东西。

# vb.net - 在选择案例中使用枚举

> ID：1004135
> 
> 赞同：1
> 
> 时间：2009-06-16T21:49:51.343
> 
> 标签：vb.net, enums, intellisense

```
Enum age

 Over18

 Under18

End enum

Select case age

End select 
```

'age' 是一种类型，不能用作表达式。

有没有办法在“选择案例”中使用枚举？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-16T21:54:08.463

那没有意义。但是您可以对以枚举*作为其类型的**变量*执行 Select Case 。

 *```
Dim customerAge As age
customerAge = age.Over18

Select Case customerAge
    Case age.Over18
        ...
    Case age.Under18
        ...
End Select 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T21:55:37.103

您必须定义一个使用枚举的变量。

```
 dim myage as age
    myage = age.Over18

    Select Case myage
    case age.Over18
    .....
    case age.Under18
    .....
    end select 

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T21:54:54.920

枚举“年龄”确实是一种类型。您需要将其分配给为保存它而构建的变量并以这种方式对其进行测试：

```
Enum age
  over18
  under18
End enum

user.age = age.over18

Select case user.age

End Select 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T21:54:37.307

我不会这么认为。Select Case 只是一个特殊的 If Then 语句，因此 select 必须有一些东西来比较答案。所以

```
Select childsAge
Case age.Over18 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T21:58:21.263

您不能在表达式上使用类型（年龄），但您可以使用该类型的任何变量

变暗我的年龄

选择案例 myAge 案例 age.Over18...*

# html - 如何编码参数以使用 Rails 中的 curl 发布？

> ID：1004138
> 
> 赞同：1
> 
> 时间：2009-06-16T21:50:11.497
> 
> 标签：html, ruby-on-rails, forms, encoding, curl

我正在使用 Pommo 作为我的邮件列表，不幸的是 Pommo 不提供 HTTP API，但提供了可嵌入的订阅表格，我可以将其放在我的网站上。但是使用该表格发帖会使我离开我的网站，这对我来说是不可接受的。

所以我想在 Rails 中进行字段验证，然后使用 curl 发布值。

Pommo 生成的字段如下所示：

```
 <input type="text" size="32" maxlength="60" name="Email" id="email" value="" />
   <input type="text" size="32" name="d[1]" id="field1" />
   <input type="text" size="32" name="d[2]" id="field2" />
   <input type="text" size="32" name="d[3]" id="field3" value="México" /> 
```

在 Rails 中产生以下参数：

```
 { "d"=>{"1"=>"Macario", "2"=>"Ortega", "3"=>"México", "5"=>""}, "Email" => mail@example.com ... } 
```

现在我可以验证电子邮件的格式以及是否存在必填字段，但我不知道如何将此哈希编码为字符串以使用 curl 发布。

这种数据结构编码是标准的还是依赖于应用程序的？它有名字吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T12:18:09.150

ActiveSupport（在 Rails 下免费提供）提供了一个方便的 to_param 方法。

```
{
  "d" => {
    "1" => "Macario",
    "2" => "Ortega",
    "3" => "Mxico",
    "5" => ""
  },
  "Email" => "mail@example.com"
}.to_param
# => "Email=mail%40example.com&d%5B1%5D=Macario&d%5B2%5D=Ortega&d%5B3%5D=Mxico&d%5B5%5D=" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T23:11:16.233

该格式是由 Rails 使用函数 normalize_params 创建的。基本上它递归地将 [] 解释为哈希。您可以在[Rails API 页面](http://api.rubyonrails.org/classes/ActionController/Routing.html#M000560)找到代码。

这是一个非常粗略的示例函数，可以根据您的情况撤消它：

```
def create_post_params(params, base = "")
  toreturn = ''
  params.each_key do |key|
    keystring = base.blank? ? key : "#{base}[#{key}]"
    toreturn << (params[key].class == Hash ? create_post_params(params[key], keystring) : "#{keystring}=#{CGI.escape(params[key])}&")
  end
  toreturn
end 
```

我还没有真正测试过它，但它可以满足您的需求。然后，您可以将它与 curl 之类的东西一起使用。但您也可以使用内置的 Ruby Net::HTTP 库。
就像是：

```
@server = URI.parse(server_url)
http = Net::HTTP.new(@server.host, @server.port)
http.use_ssl = @server.is_a?(URI::HTTPS)
result = http.post(@server.path + "PATH TO METHOD IN SERVER", create_post_params(params), SOME_HEADER_OPTIONS) 
```

我还建议您查看一个名为[HTTParty](http://github.com/jnunemaker/httparty/tree/master)的项目。它是一个为服务制作简单的 HTTP API 类的库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T22:29:40.233

您应该能够从您的 Rails 应用程序中进行 HTTP 发布

http = Net::HTTP.new('localhost', '3030') 结果 = http.post('/process_email_form', form_param_hash)。

您可以通过查看从 Pommo 表单生成的 HTTP 标头和参数信息与您内部应用程序发布的内容来验证此方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T22:31:44.517

这将被称为“序列化”[序列化](http://en.wikipedia.org/wiki/Serialization)，在这种情况下，它很可能依赖于 Rails（我来自 PHP 背景）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-22T20:55:34.373

如果您正在寻找手动完成的功能，我刚刚写了这个

```
 def encode_parameters(params, base = [])
   params.delete_if { |k,v| [ :method, :action, :controller ].include?(k.to_s.intern) }.map do |k,v|
     if v.is_a?(Hash) 
       encode_parameters(v, base.clone.push(k))
     else
       base.length == 0 ? "#{CGI::escape(k.to_s)}=#{CGI::escape(v.to_s)}" : "#{CGI::escape(base[0].to_s)}#{base.slice(1, base.length).map { |b| CGI::escape("[#{b.to_s}]")}.join("") }#{CGI::escape("[#{k.to_s}]")}=#{CGI::escape(v.to_s)}"
     end
   end.join("&")
 end 
```

享受！

# jsf - 是否可以针对不同的环境覆盖 facelets.development？

> ID：1004140
> 
> 赞同：2
> 
> 时间：2009-06-16T21:50:23.603
> 
> 标签：jsf, jakarta-ee, facelets

我们希望将 facelets.development 设置为 false 以在非开发环境中抑制堆栈跟踪，但我们希望在 dev 中将其设置为 true 以进行调试。

我们的部署过程要求一个 CI 构建通过环境迁移到生产，因此我们不能使用需要为每个环境重建应用程序/重写 web.xml 的方法。我们想根据属性文件设置更改应用程序的值。这可能吗？应用程序如何访问 facelets.development？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-11-09T16:20:47.987

我认为最简单的方法是将 Context 参数放在 web.xml 中：

```
<context-param>
  <param-name>facelets.DEVELOPMENT</param-name>
  <param-value>false</param-value>
</context-param> 
```

并在您的开发部署中覆盖它。这通常可以在不更改 WAR 的情况下实现。在 Tomcat 中，在您的 WAR 中包含 META-INF/context.xml 并使用此行（在`<Context>`...内`</Context>`）：

```
<Parameter name="facelets.DEVELOPMENT" value="true" override="false" /> 
```

Tomcat 将在启动时将此文件复制到 $CATALINA_BASE/conf/[enginename]/[hostname]/[context-path-name].xml 可用于在 WAR 之外配置 webapp。这将在您的每个环境中发生，管理员只需将其更改一次即可：

```
<Parameter name="facelets.DEVELOPMENT" value="false" override="false" /> 
```

之后，即使部署了具有较新 /META-INF/context.xml 的新 WAR，Tomcat 也不会覆盖它。上下文参数的名称必须与 WEB-INF/web.xml 中的声明相匹配。

有关详细信息，请参阅[http://tomcat.apache.org/tomcat-6.0-doc/config/context.html](http://tomcat.apache.org/tomcat-6.0-doc/config/context.html)（“简介”和“上下文参数”部分）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T09:34:11.337

我可以想到几种方法来做到这一点，但都不是很愉快。

*   装饰[FacesContext](http://java.sun.com/javaee/5/docs/api/javax/faces/context/FacesContextFactory.html)以编程方式控制[init 参数。](http://java.sun.com/javaee/5/docs/api/javax/faces/context/ExternalContext.html#getInitParameter(java.lang.String))这是为了这么少的收益而做的很多工作。
*   修补[FaceletViewHandler](https://facelets.dev.java.net/nonav/docs/dev/docbook.html#config-webapp-init)类以获得您想要的行为。如果您升级 Facelets 库，这可能会增加维护开销。可能会让在生产环境中管理应用程序的人不开心。
*   补丁方法的一种变体是在您的开发/测试机器中使用已修补的 JAR 并将它们放入服务器库中 - 然后使用 PARENT_FIRST 类加载将它们加载到应用程序中的 JAR 上（假设您的应用程序服务器支持所有这些）。这样做的缺点是它强加了类加载策略，并且您必须在所有地方管理 JAR。

我会赞成其他一些方法。如果在测试机器上需要此设置，则部署脚本可能会在安装这些服务器的过程中修改应用程序。如果您希望在源代码管理中将其设置为 true，则构建脚本可以将其作为构建过程的一部分删除。这种方法不会影响您的运行时代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-25T08:18:43.210

我已经对上面的选项 1 实施了一个变体。例如

1.  为 ServletContext 编写了一个动态代理，它拦截返回适当值的 getInitParameter 和 getInitParameterNames 方法（在这种情况下来自特定于环境的属性文件）
2.  编写了一个非常小的 FacesContextFactoryImpl 子类，它将 first/servletcontext 参数代理到 getFacesContext，然后委托给超类。
3.  将 faces-context-factory 子句添加到我的 faces-config 命名我的 FacesContextFactoryImpl 类
4.  我已经有了一种机制来加载特定于环境的属性文件并将它们作为属性对象提供给应用程序（第 2 点中的工厂将这些属性传递给第 1 点中的代理，以用作 initParameter 值的备用源）

代理看起来像：

```
package zzzzz.framework.context;

import java.lang.reflect.InvocationHandler;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;
import java.util.Enumeration;
import java.util.Hashtable;
import java.util.Map;

import javax.servlet.ServletContext;

import org.apache.commons.collections.IteratorUtils;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

/**
 * A proxy for ServletContext that intercepts accesses to the initParameters and
 * returns values from the specified params instead. Generally useful if we have
 * a set of properties (eg SystemContext.getInstance().getConfigProperties()) that
 * we want to use in preference to the webapp initProperties.
 * 
 * 
 */
public class ServletContextProxy
        implements InvocationHandler {
    @SuppressWarnings("unused")
    private static final Log log = LogFactory.getLog(ServletContextProxy.class);

    @SuppressWarnings("unchecked")
    public static ServletContext newInstance(ServletContext subject,
            Map params) {
        return newInstance(subject,
                params,
                true);
    }

    @SuppressWarnings("unchecked")
    public static ServletContext newInstance(ServletContext subject,
            Map params,
            boolean overrideInitValues) {
        return (ServletContext) Proxy.newProxyInstance(subject.getClass()
                .getClassLoader(),
                subject.getClass()
                        .getInterfaces(),
                new ServletContextProxy(subject,
                        params,
                        overrideInitValues));
    }

    /**
     * A convenience method to help extracting the initParameters from a
     * ServletContext because it doesn't expose it's underlying Map
     * 
     * @param config
     * @return
     */
    @SuppressWarnings("unchecked")
    protected static Map copyInitParameters(Map parms,
            ServletContext config) {
        Enumeration names = config.getInitParameterNames();
        // copy all the existing initParameters
        while (names.hasMoreElements()) {
            String name = (String) names.nextElement();
            parms.put(name,
                    config.getInitParameter(name));
        }
        return parms;
    }

    private boolean overrideInitValues = true;

    @SuppressWarnings("unchecked")
    private Map params;
    private ServletContext subject;

    @SuppressWarnings("unchecked")
    public ServletContextProxy(ServletContext subject,
            Map params,
            boolean overrideInitValues) {
        this.subject = subject;
        this.overrideInitValues = overrideInitValues;
        this.params = new Hashtable();
        if (this.overrideInitValues) { // default behaviour... supplied parameters win
            // start with initParameters
            copyInitParameters(this.params,
                    subject);
            // override and supplement with supplied params
            if (params != null) {
                this.params.putAll(params);
            }
        } else {
            // start with supplied params
            if (params != null) {
                this.params.putAll(params);
            }
            // override and supplement with initParameters
            copyInitParameters(this.params,
                    subject);

        }
    }

    public Object invoke(Object proxy,
            Method m,
            Object[] args) throws Throwable {
        Object result;
        try {
            if ("getInitParameter".equals(m.getName())) {
                result = this.params.get(args[0]);
            } else if ("getInitParameterNames".equals(m.getName())) {
                result = IteratorUtils.asEnumeration(this.params.keySet()
                        .iterator());
            } else {// else let it go through to the keeper
                result = m.invoke(this.subject,
                        args);
            }
        } catch (InvocationTargetException e) {
            throw e.getTargetException();
        } catch (Exception e) {
            throw new RuntimeException("unexpected invocation exception: "
                    + e.getMessage());
        }
        return result;
    }
} 
```

工厂长这样：

```
package zzz.faces.context;

import javax.faces.FacesException;
import javax.faces.context.FacesContext;
import javax.faces.lifecycle.Lifecycle;
import javax.servlet.ServletContext;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

import zzzzz.framework.context.ServletContextProxy;
import zzzzz.context.SystemContext;

/**
 * A FacesContextFactory implementation that supplements/overrided the
 * servletContext initParemeters with properties form
 * SystemContext.configProperties
 * <p>
 * The point of this is that it allows us to substitute configuration in the
 * web.xml like this (which requires rewriting web.xml to change)
 * </p>
 * 
 * <pre>
 *   &lt;!-- Enables special Facelets debug output during development --&gt;
 * &lt;context-param&gt;
 *   &lt;param-name&gt;facelets.DEVELOPMENT&lt;/param-name&gt;
 *   &lt;param-value&gt;true&lt;/param-value&gt;
 * &lt;/context-param&gt;
 * </pre>
 * 
 * <p>
 * with settings in the relevent application.properties file like this (which
 * can be changed separately to the webapp)
 * </p>
 * 
 * <pre>
 * # Enables special Facelets debug output during development
 * facelets.DEVELOPMENT=true
 * </pre>
 * 
 * <p>
 * usage: add a clause to faces-config like this:
 * 
 * <pre>
 *   <factory>
 *   <faces-context-factory>zzzzz.faces.context.FacesContextFactoryImpl</faces-context-factory>
 * </factory>
 * </pre>
 * <p>
 * 
 */
public class FacesContextFactoryImpl extends com.sun.faces.context.FacesContextFactoryImpl {
    @SuppressWarnings("unused")
    private static final Log log = LogFactory.getLog(FacesContextFactoryImpl.class);

    public FacesContextFactoryImpl() {
        super();
    }

    @Override
    public FacesContext getFacesContext(Object sc,
            Object request,
            Object response,
            Lifecycle lifecycle) throws FacesException {

        if (sc instanceof ServletContext
                && !(sc instanceof ServletContextProxy)) {
            // wrap the servlet context with a proxy to override/supplement initParameters
            sc = ServletContextProxy.newInstance((ServletContext) sc,
                    SystemContext.getInstance()
                            .getConfigProperties(),
                    true);
        }
        return super.getFacesContext(sc,
                request,
                response,
                lifecycle);
    }
} 
```

faces-config 看起来像

```
 <faces-config>
  blah waffle....
      <factory>
        <faces-context-factory>zzzz.faces.context.FacesContextFactoryImpl</faces-context-factory>
      </factory>
    </faces-config> 
```

SystemContext.getInstance().getConfigProperties() 看起来像是另一天的练习，但它只返回应用程序应该使用的属性值映射

# iphone - UIScrollView 起点

> ID：1004142
> 
> 赞同：1
> 
> 时间：2009-06-16T21:51:21.667
> 
> 标签：iphone, uiscrollview

我有一个主视图为 480 x 510 的 iPhone 应用程序。当我从纵向变为横向时，我对坐标系如何变化感到有些困惑。

最初，我有一个 480x480 的内容区域，并且想在侧面添加一个按钮来调出菜单。但是，我能找到的让文字沿着应用左侧的长度运行的唯一方法是将整个应用的方向更改为横向右侧。

现在，随着横向的方向，滚动视图从左上角开始，当我真的希望它从原始方向点开始（从它处于纵向模式时），这将是左下角。但我不知道如何改变滚动视图的原始起点。我尝试了 contentOffset，但它似乎不起作用。

另一种解决方法（我可能最终会这样做）是忘记在按钮上设置标题，而只需为按钮创建一个具有垂直方向文本的图形。

```
if (self = [super initWithCoder:coder]) {
    // Size of the scrollview
    self.contentSize = CGSizeMake(480, 510);
    [self setContentOffset:CGPointMake (0, -160)];
    self.showsHorizontalScrollIndicator = YES;
    self.showsVerticalScrollIndicator = YES;
    self.alwaysBounceVertical = NO;
    self.alwaysBounceHorizontal = NO;
    self.bounces = YES;
    self.userInteractionEnabled = YES;
    self.musicGridView = [[[MusicGridView alloc] initWithCoder:coder] autorelease];
    // Rectangle where I put the music grid (origin is left aligned, and down 160 pixels to account for landscape view)
    self.musicGridView.frame = CGRectMake(0, 160, 480, 480);
    [self addSubview: musicGridView];

    self.menuButton = [UIButton buttonWithType:UIButtonTypeCustom];
    self.menuButton.frame = CGRectMake(0, 480, 480, 32);
    [menuButton setTitle: @"Tap to get Menu" forState: UIControlStateNormal];
    [menuButton setTitleColor:[UIColor redColor] forState:UIControlStateNormal];
    [menuButton addTarget:self action:@selector(showMenu) forControlEvents:UIControlEventTouchUpInside];

    [self addSubview: menuButton]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T10:18:47.610

只需将点 x,y 设置为

```
//it goes in particular pont of view

[scrollview setContentOffset:CGPointMake(x,y) animated:YES];

//if x=0 in loop, increase y value scrollview move only vertical direction
[scrollview setContentOffset:CGPointMake(0,y) animated:YES];

//if y=0 in loop, increase x values scrollview move only horizontal direction
[scrollview setContentOffset:CGPointMake(x,0) animated:YES]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T01:20:34.943

[Andrey Tarantsov](http://www.tarantsov.com/)对课程的各种怪癖进行了[精彩](http://github.com/andreyvit/ScrollingMadness/tree/master)`UIScrollView`的总结，包括针对常见问题的各种变通方法的代码。可能值得一看。

# asp.net - 检测 ASCX/ASPX 是否在 SharePoint 中运行？

> ID：1004143
> 
> 赞同：1
> 
> 时间：2009-06-16T21:51:29.077
> 
> 标签：asp.net, sharepoint

我们有一组将在独立的 ASP.NET 和 SharePoint 中使用的代码。我想知道是否有任何合法的方法可以在 CS 文件中编写条件代码来检测 SharePoint 是否存在？

它需要能够在 OnPreInit 中或之前运行，因为基于此决定，我们将切换 MasterPageFile 属性，这需要在页面生命周期的早期完成。

我想我可以做一些事情，比如检查是否存在“~/layouts”目录等，但必须有更好的方法来做到这一点。此外，谁知道呢？出于兼容性原因（图像的位置等），我们实际上可能会在 ASP.NET 独立模式下采用 SharePoint 目录结构。

可以要求 Microsoft.SharePoint.DLL，即使它在独立运行时大部分未使用。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-16T22:44:51.043

由于您可以引用 Microsoft.SharePoint：

```
using Microsoft.SharePoint;
// ...

if (SPContext.Current == null)
    // Not running in SharePoint
else
    // Running in SharePoint 
```

**编辑**——考虑到替代方法`NullReferenceException`：

```
bool runningInSharePoint = false;
try
{
    if (SPContext.Current != null)
        runningInSharePoint = true;
}
catch (NullReferenceException e)
{
    // SharePoint is not present on the system
} 
```

上面假设你提到的异常是在访问 SPContext 时抛出的，而不是更早的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T01:39:07.260

我想知道您是否最好不要在直接的 ASP.NET 代码中包含 SharePoint dll。如果您对 SharePoint 位进行部分/子类化并包含两个构建目标，您应该能够添加 SharePoint 所需的额外代码，而不会破坏您的 ASP.NET 构建。

# sql-server - SQL 2005 找出谁创建了一个视图

> ID：1004149
> 
> 赞同：3
> 
> 时间：2009-06-16T21:52:49.073
> 
> 标签：sql-server, sql-server-2005, sql-server-2000

SQL 是否存储有关谁最初创建视图或谁最后修改视图的任何信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T22:08:06.483

现在为时已晚，但如果您使用的是 2008，您可以创建一个[审计](http://www.simple-talk.com/sql/database-administration/sql-server-audit-magic-without-a-wizard/)来跟踪未来的变化。

编辑：找到了！

```
 select p.name, v.* 
from sys.all_views v, sys.database_principals p, sys.schemas s
where p.principal_id = s.principal_id
and v.schema_id = s.schema_id
and v.name = 'your_view_name' 
```

这将生成有关数据库中视图的许多有趣的详细信息，包括 principal_id 列。在 principal_id 上加入 sys.database_principals 作为用户名！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T22:00:20.820

我不确定是否有办法查看*谁*创建了视图，但 sp_help 会为您提供有关创建时间的一些信息

```
sp_help viewMyView 
```

sp_help 适用于任何和所有数据库对象顺便说一句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T12:46:21.760

SQL Server 不存储有关谁创建或修改对象的显式信息。元数据目录中有关于谁是给定对象的所有者或对象属于哪个模式的信息：

```
select * from sys.objects where object_id = object_id('<object name>'); 
```

根据对象类型，principal_id 填充有所有者的数据库主体 ID，或者 schema_id 填充有对象所属模式的 ID。所有模式都有一个所有者，可以从元数据目录中检索：

```
select * from sys.schemas 
```

但是请注意，这些只会显示对象的*所有者*。所有者不一定是指创建或修改它的用户。可以在创建期间或创建后使用[ALTER AUTHORIZATION](http://msdn.microsoft.com/en-us/library/ms187359.aspx)语句更改对象的所有权，从而使所有权识别充其量是不可靠的。此外，sysadmin 角色的所有成员都映射到每个数据库中的相同数据库主体 dbo。

要正确识别创建对象的用户，您应该部署审计方法，但这需要事先部署审计。如果未部署审计，则可以在事后进行一些取证：

*   您可以深入研究日志文件，Paul Randal[在他最近的博客中有一个示例](http://www.sqlskills.com/BLOGS/PAUL/post/Finding-out-who-dropped-a-table-using-the-transaction-log.aspx)。
*   您可以查看[默认跟踪](http://technet.microsoft.com/en-us/library/cc293615.aspx)

# algorithm - 使用快速磁盘存储 (SSD) 进行优化的算法？

> ID：1004153
> 
> 赞同：10
> 
> 时间：2009-06-16T21:53:42.833
> 
> 标签：algorithm, optimization, hashtable, performance, solid-state-drive

鉴于固态磁盘 (SSD) 的价格正在下降，并且很快将作为系统驱动器变得更加普遍，并且考虑到它们的访问速率明显高于旋转磁介质，那么在本地使用 SSD 时，哪些标准算法将获得性能提升？贮存？例如，SSD 的高随机读取速度使得基于磁盘的哈希表之类的东西成为大型哈希表的可行性；4GB 的磁盘空间很容易获得，这使得散列到 32 位整数的整个范围是可行的（尽管查找比填充更多，但这仍然需要很长时间）；虽然由于访问速度的原因，这种大小的哈希表无法与旋转媒体一起使用，但对于 SSD 来说，这应该不是什么大问题。

是否还有其他领域即将过渡到 SSD 将提供算法性能的潜在收益？我宁愿看到关于一件事如何运作的推理，而不是意见；我不希望这引起争议。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-16T22:16:11.117

您的哈希表示例确实是受益的关键数据库结构。无需将整个 4GB 或更多文件加载到内存中来探测值，可以直接探测 SSD。SSD 仍然比 RAM 慢几个数量级，但在磁盘上有一个 50GB 的哈希表是相当合理的，但在 RAM 中则不然，除非你花大价钱买大铁。

一个例子是国际象棋位置数据库。我有超过 50GB 的散列位置。有复杂的代码来尝试在哈希中将彼此靠近的相关位置分组，因此我可以一次分页 10MB 的表，并希望将其中的一些重用于多个相似的位置查询。有大量的代码和复杂性来提高效率。

用 SSD 替换后，我能够放弃集群的所有复杂性，只使用非常愚蠢的随机散列。我的性能也得到了提升，因为我只从磁盘中获取我需要的数据，而不是 10MB 的大块。延迟确实更大，但净加速是显着的.. 超级干净的代码（20 行，而不是 800+），也许更好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T22:17:15.640

SSD 仅在随机访问时要快得多。对磁盘的顺序访问它们的性能仅是主流旋转驱动器的两倍。许多 SSD 在许多情况下性能较差，导致它们的性能更差，如此[处](http://blogs.msdn.com/e7/archive/2009/05/05/support-and-q-a-for-solid-state-drives-and.aspx)所述。

虽然 SSD 确实有很大的进步，但它们仍然比 CPU 操作和物理内存慢得多。对于您的 4GB 哈希表示例，您可能能够维持 250+ MB/s 的 SSD 访问随机哈希表存储桶。对于旋转驱动器，您很幸运能打破个位数的 MB/s。如果您可以将这个 4 GB 的哈希表保存在内存中，您可以以每秒千兆字节的速度访问它 - 甚至比非常快速的 SSD 快得多。

引用的文章列出了 MS 在 SSD 上运行时为 Windows 7 所做的几项更改，这可以让您了解可以考虑进行的更改类型。首先，用于从磁盘预取数据的 SuperFetch 被禁用 - 它旨在绕过 SSD 缓解的磁盘随机访问缓慢的时间。碎片整理被禁用，因为分散在磁盘上的文件不会影响 SSD 的性能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T22:28:21.123

事实上，任何你能想到的算法都需要大量的随机磁盘 I/O（随机是关键词，这有助于将局部性原则抛给鸟类，从而消除大量缓存的用处） .

我可以看到某些数据库系统从中受益。MySQL，例如使用 MyISAM 存储引擎（其中数据记录基本上是美化的 CSV）。然而，我认为非常大的哈希表将是你最好的例子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T09:54:57.207

SSD 对于随机读取要快得多，对于顺序读取要快一些，而对于写入（随机或非随机）则要慢一些。

因此，基于磁盘的哈希表对 SSD*没有*用处，因为现在更新它需要大量时间，但搜索磁盘变得（与普通硬盘相比）非常便宜。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T21:56:07.990

不要自欺欺人。SSD 仍然比系统内存慢很多。任何选择使用系统内存而不是硬盘的算法仍然会快得多，所有其他条件都相同。

# c#-3.0 - 将方法组转换为表达式

> ID：1004156
> 
> 赞同：11
> 
> 时间：2009-06-16T21:54:17.213
> 
> 标签：c#-3.0, lambda, expression, method-group

我试图弄清楚是否有将方法组转换为表达式的简单语法。使用 lambdas 似乎很容易，但它不能转化为方法：

给定

```
public delegate int FuncIntInt(int x); 
```

以下所有内容均有效：

```
Func<int, int> func1 = x => x;
FuncIntInt del1 = x => x;
Expression<Func<int, int>> funcExpr1 = x => x;
Expression<FuncIntInt> delExpr1 = x => x; 
```

但是如果我用实例方法尝试同样的方法，它会在表达式中崩溃：

```
Foo foo = new Foo();
Func<int, int> func2 = foo.AFuncIntInt;
FuncIntInt del2 = foo.AFuncIntInt;
Expression<Func<int, int>> funcExpr2 = foo.AFuncIntInt; // does not compile
Expression<FuncIntInt> delExpr2 = foo.AFuncIntInt;      //does not compile 
```

最后两个都无法编译“无法将方法组'AFuncIntInt'转换为非委托类型'System.Linq.Expressions.Expression<...>'。您打算调用该方法吗？”

那么有没有一种很好的语法来捕获表达式中的方法组呢？

谢谢，阿恩

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-16T22:01:49.650

这个怎么样？

```
 Expression<Func<int, int>> funcExpr2 = (pArg) => foo.AFuncIntInt(pArg);
  Expression<FuncIntInt> delExpr2 = (pArg) => foo.AFuncIntInt(pArg); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-21T19:19:17.407

也可以使用[NJection.LambdaConverter](https://github.com/sagifogel/NJection.LambdaConverter) a Delegate to LambdaExpression 转换器库来做到这一点

```
public class Program
{
    private static void Main(string[] args) {
       var lambda = Lambda.TransformMethodTo<Func<string, int>>()
                          .From(() => Parse)
                          .ToLambda();            
    }   

    public static int Parse(string value) {
       return int.Parse(value)
    } 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-17T23:15:42.440

我使用属性而不是方法。

```
public class MathLibrary
{
    public Expression<Func<int, int>> AddOne {  
        get {   return input => input + 1;} 
    }
} 
```

使用上面

[![在此处输入图像描述](../Images/17ee2e2031885ef60289690082934133.png)](https://i.stack.imgur.com/1Jotm.png)

# asp.net - 带有嵌套列表的 ASP.NET MVC DefaultModelBinder

> ID：1004160
> 
> 赞同：13
> 
> 时间：2009-06-16T21:54:37.790
> 
> 标签：asp.net, asp.net-mvc, defaultmodelbinder

我有一个带有代表员工时间表的表格的视图。上方的天数，下方的项目，每天/项目交叉点包含两个值，分别表示正常工作时间和加班时间。

页面模型的（简化的）类定义是：

```
public class TimesheetFormModel {
    public List<Project> Projects;
    // other things...
}
public class Project {
    public string Name;
    public List<WorkUnit> WorkUnits;
}
public class WorkUnit {
    public DateTime Date;
    public decimal RegularHours;
    public decimal OvertimeHours;
} 
```

页面上的表单元素命名如下，以尝试让 DefaultModelBinder 获取它们。

```
model.Projects[0].Name // "New Project"
model.Projects[0].WorkUnits[0].Date // "5/23/2009 12:00:00 AM"
model.Projects[0].WorkUnits[0].RegularHours // 0
model.Projects[0].WorkUnits[0].OvertimeHours // 0

model.Projects[0].WorkUnits[1].Date // "5/24/2009 12:00:00 AM"
model.Projects[0].WorkUnits[1].RegularHours // 0
model.Projects[0].WorkUnits[1].OvertimeHours // 0

model.Projects[0].WorkUnits[2].Date // "5/25/2009 12:00:00 AM"
model.Projects[0].WorkUnits[2].RegularHours // 0
model.Projects[0].WorkUnits[2].OvertimeHours // 0

// etc. 
```

然而，当视图被提交时，`model`参数并没有被完全填充。`model.Projects`包含项目，但`Project`'`WorkUnits`字段为空。是否`DefaultModelBinder`像我想要的那样支持嵌套集合？如果没有，我该怎么办？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-17T20:56:09.380

我最终弄清楚了为什么`DefaultModelBinder`不使用 的属性`WorkUnit`：因为它们不是*属性*，它们是*字段*。`DefaultModelBinder`仅适用于属性。更改类定义`WorkUnit`和`Project`使用字段使所有内容都单击：

```
public class Project {
    public IList<WorkUnit> WorkUnits { get; set; }
    public string Name { get; set; }
}

public class WorkUnit {
    public DateTime Date { get; set; }
    public decimal RegularHours { get; set; }
    public decimal OvertimeHours { get; set; }
} 
```

（注意：原始问题中的源代码将 Project.Name 定义为一个字段，在我的实际代码中它是一个属性。这就是为什么 Projects 列表被填充但 WorkUnits 没有填充的原因。）

# apache-flex - Flex：如何判断 TextArea 是否有闪烁的光标

> ID：1004163
> 
> 赞同：0
> 
> 时间：2009-06-16T21:54:45.310
> 
> 标签：apache-flex, flash, textarea, cursor

有没有办法判断 Flex[`TextArea`](http://livedocs.adobe.com/flex/3/langref/mx/controls/TextArea.html)是否有闪烁的光标？一种指示是组件是否获得焦点：

```
focusManager.getFocus() == textArea

```

但是在没有焦点的情况下，可能会有一个闪烁的光标。我不确定是否可以相反（焦点不闪烁光标）。

编辑：这里的问题似乎是“组件级”焦点和“玩家级”焦点之间的区别（根据[`FocusManager`](http://livedocs.adobe.com/flex/3/langref/mx/managers/FocusManager.html)文档）。我还没有找到对后者或 API 的任何很好的解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T08:23:13.867

闪烁的光标是一种视觉指示，表明您现在可以在框中键入文本，因此它必须具有焦点。可能会破解页面以使 textArea 在移除其焦点时具有闪烁的光标，但这是错误的。因此，在正常使用情况下，如果 textArea 有焦点，它将有一个闪烁的光标，如果它有一个闪烁的光标，它将有焦点。

# python - 为什么在 __init__ 函数中声明描述符类会破坏描述符功能？

> ID：1004168
> 
> 赞同：8
> 
> 时间：2009-06-16T21:55:47.897
> 
> 标签：python, descriptor

在下面的 B 类中，我希望`__set__`每当您将值分配给时调用 A 类中的函数`B().a`。相反，将值设置为用该值`B().a`覆盖`B().a`。分配给的 C 类`C().a`可以正常工作，但我想为每个用户类创建一个单独的 A 实例，即我不想在 C() 的一个实例中更改“a”来更改所有其他实例中的“a”。我写了几个测试来帮助说明这个问题。你能帮我定义一个同时通过 test1 和 test2 的类吗？

```
class A(object):
    def __set__(self, instance, value):
        print "__set__ called: ", value

class B(object):
    def __init__(self):
        self.a = A()

class C(object):
    a = A()

def test1( class_in ):
    o = class_in()
    o.a = "test"
    if isinstance(o.a, A):
        print "pass"
    else:
        print "fail"

def test2( class_in ):
    o1, o2 = class_in(), class_in()
    if o1.a is o2.a:
        print "fail"
    else:
        print "pass" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T22:29:29.983

根据[文档](http://docs.python.org/reference/datamodel.html#implementing-descriptors)：

> *以下方法**仅适用**于包含该方法的类（所谓的描述符类）的实例**出现在另一个新样式类**（称为所有者类）的类字典中时。在下面的示例中，“属性”是指名称为所有者类中属性键的属性`__dict__`。描述符本身只能实现为新型类。*

所以你不能在实例上有描述符。

但是，由于描述符获取了用于访问它的实例的引用，因此只需将其用作存储状态的键，并且您可以根据实例具有不同的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T00:12:40.103

这是一个可以通过原始测试的类，但在大多数情况下不要尝试使用它。它无法通过自身的 isinstance 测试！

```
class E(object):
    def __new__(cls, state):
        class E(object):
            a = A(state)
            def __init__(self, state):
                self.state = state
        return E(state)

#>>> isinstance(E(1), E)
#False 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-08T02:53:21.117

我被一个类似的问题所困扰，因为我想对具有由描述符控制的属性的对象进行分类。当我这样做时，我注意到所有对象中的属性都被覆盖了，因此它们不是单独的。

我提出了一个 SO 问题，得到的答案就在这里：[class attribute changed value for no reason](https://stackoverflow.com/questions/22259468/class-attribute-changing-value-for-no-reason/22262821#22262821)

一个讨论描述符的好文档链接在这里： http: [//martyalchin.com/2007/nov/24/python-descriptors-part-2-of-2/](http://martyalchin.com/2007/nov/24/python-descriptors-part-2-of-2/)

来自上述链接的示例描述符如下：

```
class Numberise(object):
    def __init__(self, name):
        self.name = name

    def __get__(self, instance, owner):
        if self.name not in instance.__dict__:
            raise (AttributeError, self.name)
        return '%o'%(instance.__dict__[self.name])

    def __set__(self, instance, value):
        print ('setting value to: %d'%value)
        instance.__dict__[self.name] = value 
```

# java - 为什么我的 Tomcat/Alfresco 站点每隔半天左右就会变得无响应？

> ID：1004169
> 
> 赞同：0
> 
> 时间：2009-06-16T21:55:54.123
> 
> 标签：java, tomcat, alfresco

我是一名开发人员，在 CentOS 5 机器上运行一个网站，其中包含 Apache Tomcat 6.x、Alfresco Labs 3（独立的 .war 文件）和几个自定义 Web 应用程序。

在过去的几个月里，服务器一直在正常运行，但就在前几天，有人通过 Alfresco 上传了一张图片，该网站停止了响应。除此之外，所有通过 Tomcat 运行的 Web 应用程序也没有响应。我尝试在本地进行远程登录（即 telnet localhost 80），但没有连接就超时了。

查看最近的日志文件（localhost...log），我看到一个以*java.lang.OutOfMemoryError: PermGen space failure*开头的堆栈跟踪，经过一番谷歌搜索后，最大 perm 大小从 128MB 增加到 384MB。我们认为这会解决问题，但今天它又回来了，tomcat 又宕机了（除了日志中没有 PermGen 堆栈跟踪）

另一个不断弹出的堆栈跟踪如下：

```
Jun 16, 2009 3:38:26 PM org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet default threw exception
java.lang.IllegalStateException
    at org.apache.catalina.connector.ResponseFacade.sendError(ResponseFacade.java:407)
    at org.apache.struts2.dispatcher.Dispatcher.sendError(Dispatcher.java:707)
    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:485)
    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:395)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
    at java.lang.Thread.run(Thread.java:619) 
```

我不知道这是否相关，因为它似乎并没有真正使 Tomcat 崩溃，但它似乎经常弹出。我认为这没什么大不了的另一个原因是在过去一个月左右的时间里，它一直出现在我们的日志中。

除此之外，我不完全确定该怎么做。我真的没有任何其他线索可以检查。我猜这是一个露天问题，但我不能肯定地说。我今天更改配置所做的唯一一件事就是将 permgen 大小增加到 512MB，但这可能无济于事，因为这次我们实际上并没有收到 PermGen 错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T22:40:39.163

最简单的解决方法可能是检查您使用的 tomcat 版本是否在任何其他版本中存在此错误，您可能只需要升级/恢复 tomcat。

找到这个，希望它有用

[http://www.nabble.com/-jira--Created:-(WW-3106)-SEVERE:-Servlet.service()-for-servlet-default-threw-exception-java.lang.IllegalStateException-(显示-a-BLANK-PAGE-to-user)-td23291783.html](http://www.nabble.com/-jira--Created:-(WW-3106)-SEVERE:-Servlet.service()-for-servlet-default-threw-exception-java.lang.IllegalStateException-(Shows-a-BLANK-PAGE-to-user)-td23291783.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T01:23:01.977

您还应该寻找内存泄漏——您是否从战争中加载了可以从共享库中加载的类？此外——某些日志记录类可能会导致 tomcat 保留加载的类（这是填充 permgen 空间的内容）而不是 GC。查看 tomcat 类加载器并确保您没有从应用程序级类加载器加载超过您需要的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T23:28:00.957

从 256 到 512 MB 稳定了再次发生的 tomcat permgen 不稳定性。将 RAM 翻倍保证了临时改进，并且很可能会从修复到开发。否则会浪费时间进行分析，了解原因，然后无论如何将 RAM 翻倍。

# c# - 循环遍历 VB.net 或 C# 中的列表框并将值设置为标签文本？

> ID：1004171
> 
> 赞同：2
> 
> 时间：2009-06-16T21:55:57.680
> 
> 标签：c#, vb.net, loops, listbox

我在列表框控件中有我想重复的项目（当它到达最后一个时，重复）循环并将文本设置为标签。

我被卡住了，请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T22:08:49.680

不确定您要实现什么，但是以下方法将不断循环遍历给定 ListBox 的项目，显示给定 Label 控件中的值，到达结束时从开始返回，每秒刷新两次（C#代码）：

```
private int _currentIndex = -1;
private void ShowNextItem(ListBox listBox, Label label)
{
    // advance the current index one step, and reset it to 0 if it
    // is beyond the number of items in the list
    _currentIndex++;
    if (_currentIndex >= listBox.Items.Count)
    {
        _currentIndex = 0;
    }

    label.Text = listBox.Items[_currentIndex].ToString();

    // get a thread from the thread pool that waits around for a given
    // time and then calls this method again
    ThreadPool.QueueUserWorkItem((state) =>
    {
        Thread.Sleep(500);
        this.Invoke(new Action<ListBox, Label>(ShowNextItem), listBox, label);
    });
} 
```

像这样称呼它：

```
ShowNextItem(myListBox, myLabel); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T22:01:40.240

听起来您需要使用事件而不是循环轮询。需要更多细节。

# asp.net - 如何通过 ASP.NET 中的 Post 将信息传递到 iframe？

> ID：1004174
> 
> 赞同：1
> 
> 时间：2009-06-16T21:57:10.720
> 
> 标签：asp.net, javascript, jquery, iframe, postback

我想通过帖子将信息传递给 iframe。（可以是执行帖子的 jquery 或 javascript，这并不重要）。

该信息无法通过查询字符串发送，因为我无权更改 iframe 引入的页面的方式。

此数据将确定 iframe 中内容的布局，那么我怎样才能使它在发送帖子后更新 iframe？（可能刷新？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T22:01:01.240

我写了[一篇](http://www.joshclarkson.net/blog/file-uploads-in-a-hidden-iframe-using-jquery/)关于使用 jQuery 执行此操作的博客文章，以使用隐藏的 iframe 上传文件。这是代码：

这是表单的 HTML：

```
<div id="uploadform">
<form id="theuploadform">
<input type="hidden" id="max" name="MAX_FILE_SIZE" value="5000000" >
<input id="userfile" name="userfile" size="50" type="file">
<input id="formsubmit" type="submit" value="Send File" >
</form> 
```

允许 jQuery 在其中创建 iframe 的 DIV，您可以使用一点 CSS 将其隐藏：

```
<div id="iframe" style="width:0px height:0px visibility:none">
</div> 
```

显示回调结果的 DIV：

```
<div id="textarea">
</div> 
```

jQuery代码：

```
<script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
<script type="text/javascript">

$(document).ready(function(){
    $("#formsubmit").click(function() {
        var userFile = $('form#userfile').val();
        var max = $('form#max').val();
        var iframe = $( '<iframe name="postframe" id="postframe" class="hidden" src="about:none" />' );
        $('div#iframe').append( iframe );

        $('#theuploadform').attr( "action", "uploader.php" )
        $('#theuploadform').attr( "method", "post" )
        $('#theuploadform').attr( "userfile", userFile )
        $('#theuploadform').attr( "MAX_FILE_SIZE", max )
        $('#theuploadform').attr( "enctype", "multipart/form-data" )
        $('#theuploadform').attr( "encoding", "multipart/form-data" )
        $('#theuploadform').attr( "target", "postframe" )
        $('#theuploadform').submit();
        //need to get contents of the iframe
        $("#postframe").load(
            function(){
                iframeContents = $("iframe")[0].contentDocument.body.innerHTML;
                $("div#textarea").html(iframeContents); 
            } 
        );
        return false;
    });
});

</script> 
```

我使用了一个像 uploader.php 这样的 php 应用程序来处理文件：

```
<?php

$uploaddir = 'uploads/';
$uploadfile = $uploaddir . basename($_FILES['userfile']['name']);
$maxfilesize = $_POST[MAX_FILE_SIZE];

if ($maxfilesize > 5000000) {
//Halt!
   echo "Upload error:  File may be to large.<br/>";
   exit();
}else{
    // Let it go
}

if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {
   print('File is valid, and was successfully uploaded. ');
} else {
   echo "Upload error:  File may be to large.<br/>";
}

chmod($uploadfile, 0744);
?> 
```

那里的内容超出了您的需要，但它说明了 jQuery 中的概念。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T22:09:48.617

我手头没有代码，但我的团队完全用 Javascript 完成了这项工作。我记得它是这样的：

```
function postToPage() {
  var iframe = document.getElementById('myIFrame');

  if (iframe) {
    var newForm = '<html><head></head><body><form...> <input type="hidden" name="..." value="..." /> </form><script type=\"text/javascript\">document.forms[0].submit();</scrip' + 't></body></html>';

    iframe.document.write(newForm);  //maybe wrong, find the iframe's document and write to it
  }
} 
```

# iphone - 如何使用 Sqlite 在 iPhone 上获取父对象的密钥

> ID：1004187
> 
> 赞同：0
> 
> 时间：2009-06-16T22:01:49.820
> 
> 标签：iphone, sqlite, uitableview

当我掌握 iPhone 应用程序编程时，我正在尝试创建一个非常简单的示例。

第一个 TableView 显示品牌，选择一个将用户带到不同的视图（我可以使用相同的视图来显示模型）来显示模型。**如果显示汽车模型的模型 TableView 允许用户添加新记录，我如何以及在哪里捕获父键（make）的主键（pk）？**

我将使用哪种方法捕获主键以及如何捕获？

Sqlite 数据库：

```
CREATE TABLE make(pk INTEGER PRIMARY KEY, parentkey INTEGER DEFAULT 0, title TEXT);

INSERT INTO make(title) VALUES('Honda');
INSERT INTO make(title) VALUES('Toyota');
INSERT INTO make(title) VALUES('Mazda');
INSERT INTO make(title) VALUES('Nissan');

INSERT INTO make(title, parentkey) VALUES('Civic', 1);
INSERT INTO make(title, parentkey) VALUES('Accord', 1);
INSERT INTO make(title, parentkey) VALUES('Corolla', 2);
INSERT INTO make(title, parentkey) VALUES('Corona', 2); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T05:10:24.947

通过 SQL，您可以在每次插入后查询 SQLITE_SEQUENCE 表：

> `SELECT seq FROM SQLITE_SEQUENCE WHERE name = 'make'`

只有当您在同一个事务中执行插入和此选择时，这才会可靠地工作，锁定表，以便在您从序列表中获取值之前没有其他人可以执行插入。

* * *

使用 API（而不是 SQL）：

> `sqlite3_int64 sqlite3_last_insert_rowid(sqlite3*);`

（来自[http://www.sqlite.org/c3ref/last_insert_rowid.html](http://www.sqlite.org/c3ref/last_insert_rowid.html)）

# php - 如何优雅地处理宕机的 API

> ID：1004191
> 
> 赞同：0
> 
> 时间：2009-06-16T22:04:13.183
> 
> 标签：php, api, curl

今天 twitter 宕机了，我一直在思考如何在 API 宕机时最好地处理它的调用。如果我使用 CURL 调用他们的 api，如何使脚本快速失败并处理错误，以免降低应用程序的速度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T22:08:20.743

使用[curl_setopt](http://us.php.net/manual/en/function.curl-setopt.php)

```
curl_setopt($yourCurlHandle, CURLOPT_CONNECTTIMEOUT, '1'); // 1 second 
```

如果您使用 curl >= 7.16.2 和 PHP >= 5.2.3，则有**CURLOPT_CONNECTTIMEOUT_MS**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T22:11:19.100

使用[curl_getinfo](http://us3.php.net/manual/en/function.curl-getinfo.php)获取 cURL 响应代码或内容长度并检查它们。

```
$HttpCode = curl_getinfo($curl, CURLINFO_HTTP_CODE); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T22:29:19.983

也许使用一种缓存来判断 twitter 是打开还是关闭。在数据库或服务器端文件中记录来自 api 的无效响应。一旦您连续收到两个/三个/一些其他数量的无效响应，请在 x 时间内禁用对 api 的所有请求。

在 x 时间后，尝试一个请求，如果它仍然关闭，再次禁用 x 分钟。

如果您的服务器可以运行 CRON 作业，请考虑制作一个脚本，每隔几分钟检查一次 API 是否有有效响应。如果它发现它已关闭，请禁用请求，直到它备份。至少在这种情况下，服务器将进行测试，用户不必成为豚鼠。

# sql-server - SQL Server LOB 数据压缩和全文搜索

> ID：1004197
> 
> 赞同：1
> 
> 时间：2009-06-16T22:07:55.393
> 
> 标签：sql-server, sql-server-2008, full-text-search

我有一个 SQL Server 2008 数据库，其中包含大量 varchar(max) 数据，这些数据当前已通过全文搜索进行索引。不幸的是，SQL Server 2008 中的行级压缩不支持 LOB 数据。

我正在玩弄使用 SQLCLR 压缩数据和自定义 iFilter 以使数据能够通过全文搜索进行索引的想法。

我有兴趣获得有关此想法的一些反馈。它可以工作吗？以前做过吗？可能的陷阱是什么？你能推荐一个更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-22T07:54:02.247

很久以前，我构建了一个 mini-SharePoint，它将使用 zip 库压缩传入的文件，并将字节存储在一个`varbinary(max)`列中。由于规范要求元数据而不是实际文件内容，我不必担心全文搜索。

您现在可以使用 CLR 实现相同的目标。缺陷是在搜索期间为索引解压缩数据期间的 CPU 负载，但现在 CPU 速度很快。

选项二？购买更多存储空间。

# python - Django：如何根据对象的 __unicode__() 值对 ModelForm 的 Many2ManyField（选择标签）进行排序？

> ID：1004202
> 
> 赞同：1
> 
> 时间：2009-06-16T22:08:49.853
> 
> 标签：python, django

如标题所述。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-02-01T14:26:56.330

排序必须在 Python 中完成，因为数据库不知道您在`__unicode__()`. 因此，您必须将所有相关的模型实例检索到一个列表中，使用`__unicode__()`实例的值对列表进行排序，然后在任何您想要的地方使用该列表。

以下文档有许多在 python 中排序的方法：[http ://wiki.python.org/moin/HowTo/Sorting/](http://wiki.python.org/moin/HowTo/Sorting/)

# .net - 如何从 blob/文件流中识别文件类型？

> ID：1004203
> 
> 赞同：8
> 
> 时间：2009-06-16T22:09:35.217
> 
> 标签：.net, sql-server, file, blob, filestream

很久以前，我们购买了一个“现成的”应用程序，它能够在 SQL Server 中将文件存储为 blob。我们注意到，由于一个部门更频繁地使用此 blob 字段，数据库在过去六个月内增加了一倍多。结果，应用程序变得非常缓慢。

我的任务是从数据库中删除 blob 字段并将文件保存到实际的文件系统中。不幸的是，应用程序没有在数据库中存储文件类型。虽然我可以读取数据库中存在的文件，但我不知道将文件保存为什么扩展名。该应用程序的支持台不再支持该版本的软件，并且不会与我们讨论提取数据的问题。不幸的是，我们无权访问他们的源代码。

任何建议将不胜感激！提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-16T22:11:50.503

您可以查看前几个字节并找出最常见的文件类型

[http://www.garykessler.net/library/file_sigs.html](http://www.garykessler.net/library/file_sigs.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T22:12:32.153

不要将其保存为任何类型。将其保存为没有扩展名的文件。如果您不知道它是什么，请不要伪造它。如果保存它的应用程序请求它，从文件系统返回它，就像从数据库返回它一样；作为二进制数据。数据库不关心二进制对象是什么类型的数据；你也不应该。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T22:13:54.867

您可以尝试使用 TriD [http://mark0.net/soft-trid-e.html](http://mark0.net/soft-trid-e.html)

它将扫描文件并尝试确定扩展名。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T22:16:20.493

您可以使用 UrlMon.dll 中的 FindMimeFromData() 函数（使用 pinvoke）。

[有关示例](http://www.pinvoke.net/default.aspx/urlmon.FindMimeFromData)，请参阅此页面，有关该函数[的文档，请参阅此 MSDN 页面。](http://msdn.microsoft.com/en-us/library/ms775107.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T06:06:46.533

用你的话来说“......我的任务是......” - 你确定这不是一个可以通过对数据库执行一些优化来解决的问题吗？尽可能避免对没有源代码且没有支持的遗留应用程序进行黑客攻击。

所以，看看这里的问题 - 应用程序的缓慢。那为什么慢呢？数据库索引无法解决的问题？

如果您必须将 BLOB 提取到文件系统，那么为什么文件的格式是相关的？当然，该应用程序旨在对数据库进行查询以获取文件——将 BLOB 提取到文件系统对您有何帮助？

顺便说一句 - 我通常使用 Unix`**file**`命令通过幻数识别文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T22:14:32.727

你怎么知道这些信息是人类可读的？

文件扩展名的目的是关联特定软件以打开文件，以便当您双击 .txt 文件时，notepad.exe 会处理它。

如果您只是为了卸载数据库而将它们写入文件系统，那么不需要任何特定的扩展。如果要将软件与之关联，请使用适当的扩展名

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T01:57:15.883

另一种选择是对数据库进行物理分区。您可以将包含 blob 字段的表存储在不同的数据库文件中，该文件可以存储在不同的硬盘/主轴上。包含 blob 表的磁盘可以通过将其设置为 RAID 0 或 RAID 10 来进一步优化。

这可以加快速度。此外，这种方法无需更改应用程序逻辑。

# vb.net - Linq 加入多个属性

> ID：1004220
> 
> 赞同：1
> 
> 时间：2009-06-16T22:15:01.213
> 
> 标签：vb.net, linq

以下两个查询在功能上是否相同？第一个不返回任何数据，但第二个在相同的精确输入下工作正常。我的第一个查询有什么问题？

```
Dim LTest2 As IEnumerable = From e1 As QNCEntity In Shape.Entities _
                        Join e2 As QNCEntity In Shape.Entities _
                        On New With { _
                                     .X = CDbl(e1.EntObj.X2), _
                                     .Y = CDbl(e1.EntObj.Y2) _
                                    } _
                        Equals New With { _
                                           .X = CDbl(e2.EntObj.X1), _
                                           .Y = CDbl(e2.EntObj.Y1) _
                                        }

Dim LTest3 As IEnumerable = From e1 As QNCEntity In Shape.Entities _
                               Join e2 As QNCEntity In Shape.Entities _
                               On CDbl(e1.EntObj.X2) Equals CDbl(e2.EntObj.X1) _
                               And CDbl(e1.EntObj.Y2) Equals CDbl(e2.EntObj.Y1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T16:10:45.417

***没有关键属性***的匿名类型的实例`Equal`只属于它自己。

请参阅：[关于匿名类型、标头 - 关键属性、平等的 MSDN 文章](http://msdn.microsoft.com/en-us/library/bb384767.aspx)

要使第一个查询与第二个查询相同，您需要更改第一个代码示例以将 X 和 Y 属性标记为关键属性：

```
Dim LTest2 As IEnumerable = From e1 As QNCEntity In Shape.Entities _
                        Join e2 As QNCEntity In Shape.Entities _
                        On New With { _
                                      Key .X = CDbl(e1.EntObj.X2), _
                                      Key .Y = CDbl(e1.EntObj.Y2) _
                                    } _
                        Equals New With { _
                                          Key .X = CDbl(e2.EntObj.X1), _
                                          Key .Y = CDbl(e2.EntObj.Y1) _
                                        } 
```

将按值比较关键字段以进行相等测试，而不是比较对两个匿名类型的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T22:29:28.453

是`Width`班级吗？是的？在这种情况下，第一个查询将通过引用比较对象，而第二个查询将比较实际值。（......并且引用将 - 当然 - 永远不会匹配，因为您总是创建一个新实例。）

# c# - 通过 2 个 DB-bound 方法使用一个 sqlconnection/sqlcommand

> ID：1004233
> 
> 赞同：0
> 
> 时间：2009-06-16T22:20:09.907
> 
> 标签：c#

我有一个类，它有一个通过 SELECT 存储过程从数据库获取数据的方法。此方法`SqlDbReader`通过返回a 来使用`ExecuteReader()`a `SqlCommand`。

连接和一切都是在这个方法中建立的，字段（例如连接字符串）设置为类级别的字段。

我现在需要根据此查询的结果填充一个数组（因此每行的列都将进入具有自己索引的数组）。

但是，此查询不会从所涉及的一个表中选择所有数据。我可以编写查询来获得我需要的东西，但是如何在全班使用一个连接？如果我实例化连接对象并`Open()`在构造函数中调用，我会在运行时遇到异常。

我希望这样的事情：

```
// At class level:
sqlconn.Open();
// sqlcommand set up

Method()
{
// Fire stored proc
// Insert results in a collection
}

Method2()
{
// Pass same collection in (use same one),
// Add new row columns into same collection
} 
```

考虑到严格的性能，我该如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T22:23:39.573

一种方法是传递您的连接对象：

```
// At class level: sqlConn.Open(); // sqlcommand set up

Method(sqlConn) { // Fire stored proc // Insert results in a collection }

Method2(sqlConn);
sqlConn.Close(); 
```

基本前提是尽可能晚开，早关。您甚至可以编写另一个方法来打开连接，调用将使用它的所有方法，然后关闭它。

# java - Java中的JTable TableModel问题

> ID：1004234
> 
> 赞同：1
> 
> 时间：2009-06-16T22:22:10.637
> 
> 标签：java, swing, jtable

我可以`JTable`毫无问题地显示我的数据，但是当我想在我的应用程序运行时进行过滤时，`JTable`并没有显示我的数据更改。我搜索它并找到了一个名为 TableModel 的类，但我无法编写我的 AbstractTableModel。谁能告诉我如何做到这一点？

个人化Java

```
package deneme.persistence;

import java.beans.PropertyChangeListener;
import java.beans.PropertyChangeSupport;
import java.io.Serializable;
import javax.persistence.Basic;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.NamedQueries;
import javax.persistence.NamedQuery;
import javax.persistence.Table;
import javax.persistence.Transient;

/**
 *
 * @author İbrahim AKGÜN
 */
@Entity
@Table(name = "PERSONELZ", catalog = "tksDB", schema = "dbo")
@NamedQueries({@NamedQuery(name = "Personelz.findAll", query = "SELECT p FROM Personelz p"), @NamedQuery(name = "Personelz.findByPersonelıd", query = "SELECT p FROM Personelz p WHERE p.personelıd = :personelıd"), @NamedQuery(name = "Personelz.findByAd", query = "SELECT p FROM Personelz p WHERE p.ad = :ad"), @NamedQuery(name = "Personelz.findBySoyad", query = "SELECT p FROM Personelz p WHERE p.soyad = :soyad")})
public class Personelz implements Serializable {
    @Transient
    private PropertyChangeSupport changeSupport = new PropertyChangeSupport(this);
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    @Basic(optional = false)
    @Column(name = "PERSONELID", nullable = false )
    private Integer personelıd;
    @Column(name = "AD", length = 50)
    private String ad;
    @Column(name = "SOYAD", length = 50)
    private String soyad;
    @Column(name = "YAS")
    private Integer yas;
    public Personelz() {
    }

    public Personelz(Integer personelıd) {
        this.personelıd = personelıd;
    }

    public Integer getPersonelıd() {
        return personelıd;
    }

    public void setPersonelıd(Integer personelıd) {
        this.personelıd = personelıd;
    }

    public String getAd() {
        return ad;
    }

    public void setAd(String ad) {
        String oldAd = this.ad;
        this.ad = ad;
        changeSupport.firePropertyChange("ad", oldAd, ad);
    }

    public String getSoyad() {
        return soyad;
    }

    public void setSoyad(String soyad) {
        String oldSoyad = this.soyad;
        this.soyad = soyad;
        changeSupport.firePropertyChange("soyad", oldSoyad, soyad);
    }
     public Integer getYas() {
        return yas;
    }
public void setYas(Integer yas){
this.yas = yas;

} 
```

表模型

```
 public class TableModel extends AbstractTableModel {

String[] headers;
List<Personelz> personel;
int row;
int column;
Object[][] per;
/** Creates a new instance of TableModel */
    @SuppressWarnings("empty-statement")
public TableModel(List<Personelz> p) {

    this.personel = p;
    column=2;
    row=this.personel.size();

    headers=new String[column];
    headers[0]="AD";
    headers[1]="SOYAD";
    per={p.toArray(),p.toArray()};

}

 public int getColumnCount()
 {
     return column;
 }
 public int getRowCount()
 {
     return row;
 }
 public Object getValueAt(int rowIndex, int kolonindex)
 {

     return per[rowIndex][kolonindex];
 }
 public String getColumnName(int i)
 {
     return headers[i];
 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T22:40:58.540

我建议阅读这篇[如何使用表格](http://java.sun.com/docs/books/tutorial/uiswing/components/table.html#fire)（来自使用 Swing 组件的 Java 教程）

基本上，TableModel 必须通过触发适当的事件来通知表更改的数据。看[这里](http://java.sun.com/docs/books/tutorial/uiswing/components/table.html#fire)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T09:36:35.637

有一个非常好的库，叫做 GlazedLists，它可以让处理列表和表格变得更加简单，包括列排序和行过滤。

它绝对值得一看。

[http://publicobject.com/glazedlists/](http://publicobject.com/glazedlists/)

高温高压

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T23:21:06.883

您应该使用您实现的`TableModelListener`接口。`JTable`将表添加到 TableModel 后，调用实现的适当的`fireTableChanged()`-type 事件`AbstractTableModel`。这应该会迫使您`JTable`进行更新。

当您的过滤操作返回时，您仍然需要实现一种方法来重置模型中的数据。您应该在此方法中调用您的`fireTableChanged()`事件。您还应该确保您在触发表更改事件时处于 AWT 线程中。

# xslt - XSLT 基于元素名称子串的节点选择

> ID：1004236
> 
> 赞同：1
> 
> 时间：2009-06-16T22:23:08.403
> 
> 标签：xslt

如何使用 XSLT 根据节点元素名称的子字符串选择节点？

例如，考虑 XML：

```
<foo_bar>Keep this.
  <foo_who>Keep this, too.
    <fu_bar>Don't want this.</fu_bar>
  </foo_who>
</foo_bar> 
```

我想从中输出：

```
<foo_bar>Keep this.
  <foo_who>Keep this, too.
  </foo_who>
</foo_bar> 
```

在这里，我想选择处理那些名称与“foo.*”之类的正则表达式匹配的节点。

我想我需要一个 XSLT 模板匹配属性表达式，或一个应用模板选择属性表达式，它将正则表达式应用于元素的名称。但是，如果没有像语句这样的结构，也许这不能完成？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T02:28:37.770

下面是一些 XSL，它可以找到以“foo”开头的元素来帮助您入门。我认为直到基于XSLT 2 中的[正则表达式匹配的](http://www.xml.com/pub/a/2003/06/04/tr.html)XSLT 2.0 才添加正则表达式功能。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="*">
        <xsl:variable name="name" select="local-name()"/>
        <xsl:if test="starts-with($name, 'foo')">
            <xsl:copy>
                <xsl:apply-templates/>
            </xsl:copy>
        </xsl:if>
    </xsl:template>
</xsl:stylesheet> 
```

它给出了这个输出，它似乎有一个额外的换行符。

```
<foo_bar>Keep this.
  <foo_who>Keep this, too.

  </foo_who>
</foo_bar> 
```

# java - Mac OS X 的 Swing 调整

> ID：1004239
> 
> 赞同：13
> 
> 时间：2009-06-16T22:25:45.903
> 
> 标签：java, user-interface, swing, macos

我记得曾经看过一个可以在 Swing 组件上设置的属性列表，以使它们在 Mac OS X 上看起来更原生。这包括在窗口关闭按钮中用“点”标记“脏”文档的方法，打开对话框为床单（不确定，但肯定会很好）等。

我知道 Apple 已经让 Java 成为一种“主要”编程语言，但由于他们最近更新了 Java，甚至提供了 Java 6，我想知道是否有一个全面且最新的列表——最好是带有示例——关于你可以做些什么来制作 Swing应用程序在 Mac 上看起来更轻松。

* * *

收到一些答案后，我将其放入社区 wiki 模式并开始以下列表以根据需要进行扩展：

* * *

*   [技术说明：Java - 用户体验](http://developer.apple.com/technicalnotes/Java/idxUserExperience-date.html)：Apple 开发人员连接参考库的概述页面（索引页面）。
*   [Mac OS X 10.5 上的 J2SE 5.0 中可用的新控件样式](http://developer.apple.com/technotes/tn2007/tn2196.html#//apple_ref/doc/uid/DTS10004439)：针对 Mac OS X 10.5 Leopard 的按钮样式等示例。

*   [Java 运行时系统属性](http://developer.apple.com/documentation/Java/Reference/Java_PropertiesRef/Articles/JavaSystemProperties.html#//apple_ref/doc/uid/TP40001975)：有关系统属性的信息，可帮助您在屏幕顶部启用 Apple 风格的菜单栏，为文本抗锯齿等提供渲染提示。

*   [Mac OS X Integration for Java](http://developer.apple.com/documentation/Java/Conceptual/Java14Development/07-NativePlatformIntegration/NativePlatformIntegration.html) : 有关菜单栏和应用程序菜单、上下文菜单、键盘快捷键和 AppleScript 的信息
*   [PDF "Java 1.3.1 Development for Mac OS X (Legacy)"](http://developer.apple.com/documentation/Java/Conceptual/Java131Development/Java131Development.pdf) : 80 页有关各种主题的信息，例如打包应用程序。这有点过时了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T17:54:32.337

Quaqua网站也可能很有趣[。](http://www.randelshofer.ch/quaqua/)从网站：

> “Quaqua Look and Feel (Quaqua) 是 Java 应用程序的用户界面库，它希望严格遵守 Apple 的 Mac OS X 人机界面指南……它运行在 Apple 的 Aqua Look and Feel 之上，并提供修复并对其进行增强。”

它也有一个相当不错的用户指南和示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T23:37:38.940

Mac OS X 的 Java 开发指南有一个[Mac OS X Integration for Java](http://developer.apple.com/documentation/Java/Conceptual/Java14Development/07-NativePlatformIntegration/NativePlatformIntegration.html)部分，这可能是您正在寻找的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T23:32:45.563

您可以在 Apple 查看[此 PDF](http://developer.apple.com/documentation/Java/Conceptual/Java131Development/Java131Development.pdf)，但它被标记为旧版。

在某些应用程序中，我仍然`com.apple.macos.useScreenMenuBar`让 Java 应用程序使用 Mac OS X 菜单栏，并且它仍然可以在 Leopard 中使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T05:34:27.273

我的个人链接收藏：

*   来自 developer.apple.com：
    *   [Mac OS X 的 Java 运行时属性](http://developer.apple.com/technotes/tn/tn2031.html)（不要被“不推荐”弹出窗口吓到，一些信息仍然有用）
    *   [苹果 Java 扩展](http://developer.apple.com/samplecode/AppleJavaExtensions/index.html)
    *   [OS X 运行时配置指南](http://developer.apple.com/documentation/MacOSX/Conceptual/BPRuntimeConfig/index.html)（与 Java 没有直接关系，但还是很有趣的读物）
*   来自太阳：
    *   [将您的 Java 应用程序带入 Mac OS X 第 3 部分](http://www.oracle.com/technetwork/articles/javase/javatomac3-137430.html)
        *   具有工作图像的另一个位置的同一页面：`http://192.9.162.55/developer/technicalArticles/JavaLP/JavaToMac/`

当点击一些旧链接时，我被重定向到[Java Design Guidelines](http://developer.apple.com/referencelibrary/Java/idxDesignGuidelines-date.html)和[Java Guides](http://developer.apple.com/documentation/Java/index.html)，似乎我必须更新我的链接......

# datetime - Umbraco 中月份的 DateDiff

> ID：1004243
> 
> 赞同：0
> 
> 时间：2009-06-16T22:27:15.370
> 
> 标签：datetime, xslt, umbraco

我试图在我的 xslt 文件中获取两个日期之间的月数，如下所示：

```
<xsl:variable name="now" select="umbraco.library:CurrentDate()"/>
<xsl:value-of select="umbraco.library:DateDiff('2010-12-01', $now, 'm')" /> 
```

不幸的是，这似乎给了我两个日期之间的分钟数，而不是月数。几个月来，我在任何地方都找不到要作为第三个参数输入的字符串。在某处有这个参考吗？或者我如何找到月数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T06:49:36.683

DateDiff 方法不支持月份。

它只支持年、分或秒。

要计算以月为单位的差异，您需要进行一些数学运算或使用内联 c# 方法或编写您自己的 XSLT 扩展方法。

[有关内联 c# 的更多信息](http://umbraco.org/4634?altTemplate=print)

有许多创建 XSLT 扩展方法的教程，包括他的主要 umbraco 站点上的几个视频教程。

[有关 XSLT 扩展的更多信息](http://en.wikibooks.org/wiki/Umbraco/Create_xslt_exstension_like_umbraco.Library_in_C)

[关于 XSLT 扩展的 Umbraco 视频](http://umbraco.org/documentation/videos/for-developers/xslt-extensions)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:44:44.393

我最终像 Tim 建议的那样编写了自己的函数：

```
public static int MonthDiff(string date1, string date2)
{
    DateTime dt1 = DateTime.Parse(date1);
    DateTime dt2 = DateTime.Parse(date2);

    return ((dt2.Year - dt1.Year) * 12) + (dt2.Month - dt1.Month);
} 
```

我敢肯定它可以更好地概括，但这对我来说已经足够了。

# php - 我可以从 PHP 中获取文件的短 DOS 名称吗？

> ID：1004259
> 
> 赞同：3
> 
> 时间：2009-06-16T22:30:05.240
> 
> 标签：php, dos

我想将文件路径作为参数传递给 PHP 的可执行文件，并且文件路径可能包含空格。可执行文件似乎不处理参数周围的引号，所以我想也许我可以传递短 DOS 名称而不是长名称。

PHP 是否了解旧式 DOS 8.3 文件名？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T22:52:10.263

php/win32 附带内置的[COM/.net 扩展](http://de.php.net/manual/en/com.installation.php)。您可以使用它来创建 WSH [FileSystemObject](http://msdn.microsoft.com/en-us/library/6kxy1a51(VS.85).aspx)，然后查询[File 对象](http://msdn.microsoft.com/en-us/library/1ft05taf(VS.85).aspx)的[ShortPath 属性](http://msdn.microsoft.com/en-us/library/htyh9b2z(VS.85).aspx)。

```
<?php
$objFSO = new COM("Scripting.FileSystemObject");
$objFile = $objFSO->GetFile(**FILE**);
echo "path: ", $objFile->Path, "\nshort path: ", $objFile->ShortPath;
```

打印例如

```
路径：C:\Dokumente und Einstellungen\Volker\Desktop\test.php
短路径：C:\DOKUME~1\Volker\Desktop\test.php
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T22:42:15.307

您可能想查看`escapeshellarg()`并将参数放在双引号之间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T22:48:55.060

您需要 Windows 上 Kernel32 中的[GetShortPathName](http://msdn.microsoft.com/en-us/library/aa364989(VS.85).aspx) API。要从 PHP 调用它，您需要使用[Win32 API 扩展](http://de.php.net/manual/en/book.w32api.php)...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T22:36:43.027

反斜杠空间怎么样？

```
Home/My Documents/  --> Home/My\ Documents/ 
```

# flex3 - Flex - 将窗口返回到其原始状态

> ID：1004261
> 
> 赞同：1
> 
> 时间：2009-06-16T22:30:32.647
> 
> 标签：flex3, states

我已经把头发扯了一个多星期了，是时候寻求帮助了...

我正在编写一个小应用程序来显示下一班离开车站的火车。通常只显示下一班列车的小时数，但如果您单击首选项按钮，应用程序窗口会放大，并显示包含列车和小时数的数据网格。在该状态下单击关闭按钮会使您返回到“开始”状态，或者应该这样做。

问题是数据网格消失了，但应用程序窗口的大小保持不变。它应该恢复到原来的大小。

我一直在尝试很多不同的方法，用 Canvas 或 Panels 替换 VBoxes，但没有一个奏效。在设计模式下，在状态之间切换时一切都按预期工作。

这是我第一次使用状态，所以我可能会遗漏一些基本的东西。

这是一个代码示例 - 我正在使用 2 个视图状态，开始和首选项。

```
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" 
creationComplete="init();" 
cornerRadius="12"
currentState='Start' width="350" height="250">
<mx:states>
    <mx:State name="Start">
        <mx:AddChild>
            <mx:VBox id="box_parent" width="100%" height="100%" verticalGap="2">
                <mx:Label text="Next Train Leaves At" textAlign="center" width="100%"/>
                <mx:Label text="--:--" width="100%" height="100" fontSize="64" id="timetext" textAlign="center" fontWeight="bold"/> 
                <mx:HBox width="100%" height="25" id="hbox1">
                    <mx:Button label="Prefs"
                        id="buttonPrefs"
                        click="currentState='Prefs'"/>
                    <mx:Spacer width="70%" id="spacer1"/>
                    <mx:Button 
                        label="Next"
                        click="findNextTrain()" id="buttonNext"/>   
                </mx:HBox>      
            </mx:VBox>      
        </mx:AddChild>
        <mx:SetProperty name="layout" value="vertical"/>
        <mx:SetProperty name="width" value="350"/>
        <mx:SetProperty name="height" value="220"/>
    </mx:State>
    <mx:State name="Prefs" basedOn="Start">
        <mx:AddChild relativeTo="{box_parent}" position="lastChild">
            <mx:DataGrid height="80%" width="100%" dataProvider="{trains}" id="traindata" editable="false">
                <mx:columns>
                    <mx:DataGridColumn headerText="Station" dataField="stationid"/>
                    <mx:DataGridColumn headerText="Leave" dataField="leave"/>
                </mx:columns>
            </mx:DataGrid>
        </mx:AddChild>
        <mx:RemoveChild target="{buttonPrefs}"/>
        <mx:SetProperty target="{box_parent}" name="height" value="500"/>
        <mx:AddChild relativeTo="{spacer1}" position="before">
            <mx:Button label="Close" click="currentState='Start'"/>
        </mx:AddChild>
        <mx:SetProperty name="height" value="570"/>
    </mx:State>
</mx:states>

<mx:transitions> 
    <mx:Transition fromState="*" toState="*"> 
        <mx:Resize target="{this}" duration="500"/> 
    </mx:Transition> 
</mx:transitions> 
</mx:WindowedApplication> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T23:08:09.890

我还没有找到将 Flex 中的状态重置为 MXML 中提供的值的方法。您必须以编程方式重置您需要的自我价值。在提供的示例代码的情况下，您可以通过将以下内容添加到 WindowedApplication 标签

```
currentStateChange="if(currentState == 'Start') this.height = 220" 
```

这告诉 WindowedApplication 标签处理更改当前状态后调度的事件以检查新的当前状态是否为 Start，如果是则设置窗口高度。

# iphone - 如何使用 Sqlite 在 iPhone 上管理对象中的数据库关系

> ID：1004262
> 
> 赞同：0
> 
> 时间：2009-06-16T22:30:59.997
> 
> 标签：iphone, sqlite, uitableview

例如，如果我能够显示包含所有电影和流派的 UITableView。单击电影上的编辑应该加载一个新视图（这是正确的方式，加载一个编辑视图吗？）带有一个文本框和某种选择器或另一个视图来选择流派。选择流派后，**如何捕获流派 ID 以保存在电影表中？**

```
CREATE TABLE movie(pk INTEGER PRIMARY KEY, title TEXT, genreId INTEGER);

INSERT INTO make(title) VALUES('GoldFinger', 1);
INSERT INTO make(title) VALUES('Octopussy', 1);
INSERT INTO make(title) VALUES('Love Story', 3);
INSERT INTO make(title) VALUES('Where Eagles Dare', 1);
INSERT INTO make(title) VALUES('Zombies', 2);

CREATE TABLE genre(pk INTEGER PRIMARY KEY, title TEXT);

INSERT INTO genre(title) VALUES('Thriller');
INSERT INTO genre(title) VALUES('Horror');
INSERT INTO genre(title) VALUES('Romance'); 
```

我使用 Sqlitebooks 示例作为指南。

```
// Movie.h
@interface Movie : NSObject {
// Opaque reference to the underlying database.
sqlite3 *database;
// Primary key in the database.
NSInteger primaryKey;
// Attributes.
NSString *title;
NSInteger *genreKey;
// Internal state variables. Hydrated tracks whether attribute data is in the object or the database.
BOOL hydrated;
// Dirty tracks whether there are in-memory changes to data which have no been written to the database.
BOOL dirty;
NSData *data;
}
// Property exposure for primary key and other attributes. The primary key is 'assign'     because it is not an object,
// nonatomic because there is no need for concurrent access, and readonly because it     cannot be changed without
// corrupting the database.
@property (assign, nonatomic, readonly) NSInteger primaryKey;
// The remaining attributes are copied rather than retained because they are value     objects.
@property (copy, nonatomic) NSString *title;
@property (copy, nonatomic) NSInteger *genreKey;
// Finalize (delete) all of the SQLite compiled queries.
+ (void)finalizeStatements;
// Creates the object with primary key and title is brought into memory.
- (id)initWithPrimaryKey:(NSInteger)pk database:(sqlite3 *)db;
// Inserts the book into the database and stores its primary key.
- (void)insertIntoDatabase:(sqlite3 *)database;
// Brings the rest of the object data into memory. If already in memory, no action is     taken (harmless no-op).
- (void)hydrate;
// Flushes all but the primary key and title out to the database.
- (void)dehydrate;
// Remove the book complete from the database. In memory deletion to follow...
- (void)deleteFromDatabase;

// Movie.m
// Flushes all but the primary key and title out to the database.
- (void)dehydrate {
    if (dirty) {
    // Write any changes to the database.
    // First, if needed, compile the dehydrate query.
    if (dehydrate_statement == nil) {
        const char *sql = "UPDATE movie SET title=?, genreid=? WHERE pk=?";
        if (sqlite3_prepare_v2(database, sql, -1, &dehydrate_statement, NULL) != SQLITE_OK) {
            NSAssert1(0, @"Error: failed to prepare statement with message '%s'.", sqlite3_errmsg(database));
        }
    }
    // Bind the query variables.
    sqlite3_bind_text(dehydrate_statement, 1, [title UTF8String], -1, SQLITE_TRANSIENT);
    sqlite3_bind_text(dehydrate_statement, 2, [genreId UTF8String], -1, SQLITE_TRANSIENT);
    sqlite3_bind_int(dehydrate_statement, 3, primaryKey);
    // Execute the query.
    int success = sqlite3_step(dehydrate_statement);
    // Reset the query for the next use.
    sqlite3_reset(dehydrate_statement);
    // Handle errors.
    if (success != SQLITE_DONE) {
        NSAssert1(0, @"Error: failed to dehydrate with message '%s'.", sqlite3_errmsg(database));
    }
    // Update the object state with respect to unwritten changes.
    dirty = NO;
}
// Release member variables to reclaim memory. Set to nil to avoid over-releasing them 
// if dehydrate is called multiple times.
[movie release];
movie = nil;
[data release];
data = nil;
// Update the object state with respect to hydration.
hydrated = NO;
}
@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T00:12:05.923

这并不能直接回答您的问题，但是，我建议您查看 3.0 SDK 中添加的新 CoreData API。它们将允许您对关系数据进行建模并抽象出任何手动 SQL 工作，从而减少代码，如果处理得当，性能会更好。

# asp.net - 编译查询是否缓存？

> ID：1004263
> 
> 赞同：3
> 
> 时间：2009-06-16T22:31:06.157
> 
> 标签：asp.net, linq, linq.compiledquery

我的大部分应用程序都使用经过编译的查询来检索数据。在这些查询中，我经常提到当前用户。我注意到如果用户 B 在另一个用户 A 之后登录，那么用户 B 将看到用户 A 的信息。

我在整个应用程序中都有类似的查询

```
public static Func<DataContext, MyRecord> CurrentUserRecords =
            CompiledQuery.Compile<DataContext, MyRecord>(
                (DataContext db) =>
                    (from r in db.MyRecords
                     where
                        r.User == User.Current 
                     select r).SingleOrDefault()); 
```

`User.Current`是一个静态属性，根据登录者的不同而变化。

```
public static User Current 
{
    get { return MyBase<User>.Get((int)(HttpContext.Current.Session["CurrentUserID"] ?? 0)); }
} 
```

当我第一次使用用户 A 登录时，上面编译的查询返回用户 A 的记录。因此，User.Current 也返回了对用户 A 的正确引用。但是，当我以用户 B 身份登录时，上面编译的查询仍然返回用户 A 的记录，尽管 User.Current 正在返回对用户 B 的引用。

我为 SQL Server 运行了 Profiler，并注意到当编译的查询被执行时，生成的 TSQL 两次都引用了用户 A 的 ID。

所以我的问题是：

编译后的查询会以某种方式缓存吗？

如果是这样，寿命是多少，我可以控制它吗？

在 ASP.net 应用程序的已编译查询设计中引用“当前用户”是否错误？

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T02:10:32.500

您需要在编译的查询中允许一个字符串参数。否则它将在 .Compile() 期间解析字符串的值。试试这个：

```
public static Func<DataContext, string, MyRecord> UserRecordByParam =
  CompiledQuery.Compile<DataContext, string, MyRecord>
(
  (DataContext db, string UserName) =>
   db.MyRecords.Where( r => r.User == UserName ).SingleOrDefault()
);

public static Func<DataContext, MyRecord> CurrentUserRecord =
  (DataContext db) => UserRecordByParam(db, User.Current); 
```

# iphone - 用于访问 Amazon S3 REST API 的 iPhone API

> ID：1004271
> 
> 赞同：0
> 
> 时间：2009-06-16T22:33:41.580
> 
> 标签：iphone, cocoa-touch, rest, amazon-s3

是否有人对通过 iPhone 使用他们的 REST API 从 Amazon S3 服务获取或发布到 Amazon S3 服务有任何建议。看起来不可能，但我可能读错了文档。

预先感谢您的帮助！

L.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T07:03:47.860

在一般情况下，我建议使用[ASIHttpRequest](http://allseeing-i.com/ASIHTTPRequest/)，它有很多内置功能（也兼容 REST）和很多东西，比使用 NSURLConnection 更轻松。

它还具有开箱即用的[S3 支持。](http://allseeing-i.com/ASIHTTPRequest/S3)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T23:22:50.313

你应该能够使用 NSURLRequest 的东西来做你想做的事。

```
NSMutableData* _data = nil;

- (IBAction) doIt:(id)sender {
    NSURL* url = [NSURL URLWithString: @"http://theurl.com/"];
    NSMutableURLRequest* req = [NSMutableURLRequest requestWithURL: url];
    NSURLConnection* con = [NSURLConnection connectionWithRequest: req delegate: self];
    NSData* body = [@"body of request" dataUsingEncoding: NSUTF8StringEncoding];

    _data = [NSMutableData new];
    [req setHTTPMethod: @"POST"];
    [req setHTTPBody: body];
    [con start];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [_data appendData: data];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    NSString* result = [[[NSString alloc] initWithData: _data encoding: NSUTF8StringEncoding] autorelease];

    // process your result here
    NSLog(@"got result: %@", result);
} 
```

这没有任何错误检查，并且 _data 变量应该存储在实例变量中，但一般的想法应该适合你。您可能还需要设置一些请求标头来告诉服务器正文数据采用什么编码等等。

# php - 我可以在不使用本地主机服务器的情况下在本地解析 PHP 吗？

> ID：1004277
> 
> 赞同：2
> 
> 时间：2009-06-16T22:37:05.693
> 
> 标签：php, ide, wysiwyg

通常，当我使用 PHP 进行开发时，我希望立即看到细微的变化。这需要我通过 FTP 连接到 Web 服务器然后刷新，或者使用 localhost 服务器，这两者（据我所知）本质上是相同的。

我想知道的是，是否有 IDE 或其他方式以动态方式解析 PHP 输出？我想我在想的是一些能够实时显示代码的编辑器中的所见即所得窗格。

我了解客户端-服务器范例，但宁愿在进行更改/错误处理/等时不必上传相同的文件 40 次。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T22:41:45.183

您始终可以将文件保存*在*localhost 文件夹中。像[xampp](http://www.apachefriends.org/en/xampp.html)这样的工具可以轻松运行 php 服务器。在浏览器中打开文件，每当您进行更改时，它们将立即可见，而无需复制文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T22:49:29.287

我听说 ActiveState 的 Komodo 是 php 的 IDE，其行为方式与您描述的方式不同（至少它具有动态语法检查，因此它必须在本地解析脚本）。试试[科莫多网站。](http://www.activestate.com/komodo/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T23:00:58.983

您应该设置您的 IDE 以在适当的位置编辑 ftp 文件。尽管我确信其他人会做同样的事情，但我使用[Edit Plus 。](http://www.editplus.com/)在这种模式下，您在 ftp 目录浏览器中打开文件（与本地相同），保存时会自动上传到服务器。您还可以将其设置为将文件本地保存在备份文件夹中，因为听起来您没有使用源代码控制。然后进行设置，以便当您 CTRL+B 时，远程文件将在编辑器中打开浏览器（在项目设置下查看根路径）。

是的，虽然 localhost 网络服务器可能类似，但您必须克服一些不兼容问题，尤其是当您运行 Windows 并且您的主机是 unix 变体时。例如：[money_format()](http://php.net/money_format) for one 在 windows 上不存在，但在 linux 下非常有用。即使操作系统相同，配置也会有所不同。

祝你好运！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T22:44:08.597

这可能不会经常出现，因为安装本地 Web 服务器非常容易。你的操作系统是什么？

此外，如果您的远程 Web 服务器可以通过[SSH](http://en.wikipedia.org/wiki/Secure_Shell)访问，您可以学习面向屏幕的文本编辑器（例如[VI 编辑器](http://en.wikipedia.org/wiki/Vi)）并编辑服务器上的源文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T22:55:08.450

我也有同样的感觉，但是通过使用支持 FTP 的编辑器/IDE 可以轻松解决它。配置您的帐户，然后在本地编辑文件，但编辑器/IDE 在您保存它们时将它们推送到服务器。Notepad++ 和 PSPad 都在 Windows 上执行此操作，我在 Fedora 上使用 Gedit（默认 Gnome 文本编辑器）。Google 搜索“FTP 文本编辑器”或“FTP IDE”可能会为您提供很好的服务。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T22:47:53.893

您可以使用 PHP 命令行，但这会以纯文本形式显示其输出。您可以获取该输出，将其保存为 HTML 文件，然后使用浏览器显示它，但我认为这比仅设置本地 Web 服务器需要更多的工作。

[Aptana](http://aptana.com/)的[PHP 插件](http://aptana.com/php)有一个内置的 PHP 服务器，所以这可能已经足够接近你想要的了，虽然我从来没有使用过它，所以我不能直接说什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T23:00:39.250

我可能弄错了，但您似乎希望无需恢复/最大化浏览器并单击“刷新”即可查看更改。因此，换句话说，您希望看到结果而不必最大化浏览器，单击刷新，最小化它以返回编辑器。

据我所知，没有 IDE 可以实时动态显示 PHP 代码。

如果可以的话，您可能想要做的是绑定它，这样当您保存文档时，它会自动加载浏览器并为您刷新页面。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T12:22:48.563

任何 IDE 都应该通知您语法错误（通常带有波浪形的红色下划线），这将减少大量的 FTP-ing，只是为了发现您错过了一个分号。

即使您说您不想使用 localhost，我还是建议您使用[WampServer](http://www.wampserver.com/en/index.php)之类的东西。最新版本的最佳之处在于您可以安装不同的 PHP、MySQL 和 Apache“模块”并在它们之间切换以模仿任何服务器配置。例如，“Apache 1.3，PHP 4.2”或“Apache 2，PHP 5.3”等。

# spring - 自动装配使用 @Component 注释的非托管 Bean

> ID：1004278
> 
> 赞同：7
> 
> 时间：2009-06-16T22:37:43.833
> 
> 标签：spring, components, autowired, spring-aop, unmanaged

我想使用@AutoWired 将配置有@Component 的非托管bean 注入托管bean。我很确定我的配置是正确的，但由于某种原因，我不断收到异常：

```
No unique bean of type [foo.Baz] is defined: Unsatisfied dependency of type [class foo.Baz]: expected at least 1 matching bean 
```

根据错误，我猜它无法找到 Baz 类，但我不知道为什么。我的理解是 XML 配置中的 context:spring-configured 元素应该允许我这样做。我还确保包含适当的 jar 文件（spring-weaving.jar 和 aspectjweaver.jar）。

这是我设置的一个简单示例。

我的 XML 配置：

```
<beans ...>
    ...

    <context:annotation-config/>
    <context:spring-configured/>
    <context:component-scan base-package="foo"/>

    <bean id="bar" class="foo.Bar"/>
    ...
</beans> 
```

我有一个托管 bean：

```
package foo;

public class Bar {

    @Autowired
    private Baz baz;

    public void setBaz(Baz baz) {
        this.baz = baz;
    }

    ...
} 
```

还有一个非托管 bean：

```
package foo;

@Component
public class Baz {
    ...
} 
```

有什么我想念的吗？

*编辑*：日志列出了它实例化的 bean，而 foo.Baz 不是其中之一。我不知道为什么它没有选择 @Component 注释类。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T16:35:06.923

因为Bar是用xml配置的，所以只能用xml配置。即你不能混合它们。因此，Baz 上的“@Autowired”注释不会被拾取（没有任何注释）。只有当您在类级别添加 spring 注释时，spring 才会侦听任何其他注释。

您需要做的是在 xml 中将 bean 配置为按类型自动装配，为该类型添加一个设置器，您将实现所需的行为。

```
<bean id="bar" class="foo.Bar" autowire="byType"/> 
```

还有一件事，当你用 @Component 注释一个 bean 时，它*是*一个 spring 管理的 bean。仅仅因为它不是用 xml 创建的，并不意味着它是不受管理的。非托管 bean 是你从春天得不到的。

Bar 和 Baz 都是春季管理的。不同的是您选择定义它们的机制。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-10-25T14:41:39.683

一方面，之前的回答是不正确的。您可以自动装配以其他方式使用 xml 配置的 bean。

从[http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html)中的第 3.4.5 节：

当使用基于 XML 的配置元数据[2] 时，您可以使用元素的 autowire 属性为 bean 定义指定 autowire 模式。自动装配功能有五种模式。您指定每个 bean 的自动装配，因此可以选择要自动装配的那些。

您可以按名称、类型和构造函数自动装配。这里有一个粗略的例子：[http ://www.java2s.com/Code/Java/Spring/Au​​toWiring.htm](http://www.java2s.com/Code/Java/Spring/AutoWiring.htm)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-21T13:53:23.357

该错误是由于 XML 配置文件中定义的 bean 序列造成的。

与您的 XML 文件一样，`bar`首先创建 bean for，然后创建它们的依赖 bean，因此`@Autowired`无法找到`baz`.

您必须先声明 bean for `baz`，然后再声明 for `bar`。

# sqlanywhere - 在 Vista 上向 Mobile Device Center 注册 Mobilink 出现错误

> ID：1004283
> 
> 赞同：1
> 
> 时间：2009-06-16T22:40:37.013
> 
> 标签：sqlanywhere, mobilink

我有一个 bat 文件，用于尝试在 Vista 上的移动设备中心注册 Mobilink。（我使用的是 Mobilink 11 版）脚本：

```
mlasinst -k ./ -v ./ 
```

我已经将 mlasinst 以及 mlasdev.dll 和 mlasdesk.dll 复制到同一个文件夹中，并且正在运行上述命令以运行同步过程。（我已经在 Windows XP 上测试了上述脚本并且它可以工作）。当我尝试将相同的文件复制到 Windows Vista 计算机时，我运行脚本并重新启动计算机。然后我按照 Sybase 网站的指示进行操作，即我

“从 Windows 移动设备中心窗口，单击移动设备设置，然后单击更改内容设置。选择 MobiLink 客户端并单击保存以激活提供程序。要查看已注册应用程序的列表，请单击更改内容设置，单击 MobiLink 客户端，然后单击同步设置。"

在 Vista 上一切正常，除了当我点击“同步设置”时，当我点击它时，我收到一条错误消息，提示没有要管理的设置。

我的问题是如何让 Mobilink 与 Vista 及其移动设备中心一起工作？我已经阅读了我能找到的所有文档，但无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T15:49:33.837

Juen 23日评论

对于那些在家关注的人，由于这篇文章，我们的 QA 部门能够在使用 Windows Mobile 6 设备时通过 Vista 上的 Windows Mobile 设备中心重现此问题，我们正在对其进行调查。一切似乎都可以在我们用于初始测试的 Windows Mobile 5 设备上正常运行。

6月19日评论

我真的很想发表评论，因为这不是一个真正的答案，但我的声誉还不够高。哦，好吧，我会发布一个糟糕的答案，然后看着我的声誉下降。这是我愿意付出的代价。:)

我们的 QA 小组使用 Windows Mobile Device Center 测试 mlasinst，但您显然在做不同的事情，或者更有可能您的机器设置略有不同。为了深入了解这一点，我们可能需要查看由于 mlasinst 运行而更改了哪些注册表设置，但在我花太多时间弄清楚这里发生了什么之前（包括弄清楚什么是正确的问题）问是），我应该指出，我建议使用 TCPIP 或 HTTP 进行同步，而不是使用 ActiveSync，如果只是为了简化安装过程并减少 ML 客户端和服务器之间的附加层或通信。我还从您在 news://forums.sybase.com/sybase.public.sqlanywhere.mobilink 发布的帖子中看到，您一直在使用 . NET 版本的 dbmlsync API 并使用 TCPIP 进行同步。我确实回复了您在新闻组上的帖子，以解释我认为您的申请中正在发生的事情。

您是否仍然对解决 ActiveSync 和 WMDC 的问题感兴趣，或者您对使用 dbmlsync API 和 TCPIP 实现的解决方案感到满意？

# c# - TransactionScope 回滚可以与 Selenium 或 Watin 一起使用吗？

> ID：1004292
> 
> 赞同：7
> 
> 时间：2009-06-16T22:42:28.083
> 
> 标签：c#, asp.net, selenium, xunit.net

我正在尝试对我的 ASP.NET 应用程序进行一些自动化 Web 测试。我希望使用 Xunit.net 扩展中的 AutoRollback 属性来撤消测试期间所做的任何数据库更改。AutoRollback 使用 TransactionScope 在测试之前启动事务并在之后回滚。

当我尝试在事务期间访问我的 Web 应用程序时，它总是超时。看起来这应该可行，有什么想法吗？这是我的测试：

```
[Fact]
[AutoRollback]
public void Entity_should_be_in_list()
{
    Entity e = new Entity
    {
        Name = "Test",
    };
    dataContext.Entities.InsertOnSubmit(e);
    dataContext.SubmitChanges();

    selenium.Open("http://localhost/MyApp");
    Assert.True(selenium.IsTextPresent("Test"));
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T23:49:08.090

Your ASP.NET application has a separate database context and it has no idea that you want it to join transaction started by Xunit.net. Apparently, the database locks some resources when transaction starts; web application waits patiently for some time and eventually gives up.

I think your best bet is to start from empty database and use SQL script to create schema and populate lookup tables (your database is [under source control](https://blog.codinghorror.com/get-your-database-under-version-control/), right?). Another approach is to backup database before running the tests and then restore it once they finish.

# sql - ORDER BY 与不同数据集的 UNION (T-SQL)

> ID：1004293
> 
> 赞同：16
> 
> 时间：2009-06-16T22:42:37.927
> 
> 标签：sql, sql-server, tsql, join, union

我有一个查询，它`UNION`是两个有点相似的数据集，但它们都有一些不存在于另一个中的列（即，这些列在结果中具有 NULL 值`UNION`。）

问题是，我需要`ORDER`使用仅存在于一组或另一组中的那些列来生成结果数据，以便以友好的格式获取软件端的数据。

例如：**Table1**有字段`ID, Cat, Price`。**表 2**有字段`ID, Name, Abbrv`。该`ID`字段在两个表之间是通用的。

* * *

我的查询看起来像这样：

```
SELECT t1.ID, t1.Cat, t1.Price, NULL as Name, NULL as Abbrv FROM t1 
UNION 
SELECT t2.ID, NULL as Cat, NULL as Price, t2.Name, t2.Abbrv FROM t2 
ORDER BY Price DESC, Abbrv ASC 
```

这`ORDER BY`就是我卡住的地方。数据如下所示：

```
100   Balls     1.53                       
200   Bubbles   1.24                       
100                     RedBall    101RB   
100                     BlueBall   102BB   
200                     RedWand    201RW   
200                     BlueWand   202BW 
```

...但我希望它看起来像这样：

```
100   Balls     1.53                       
100                     RedBall    101RB   
100                     BlueBall   102BB   
200   Bubbles   1.24                       
200                     RedWand    201RW   
200                     BlueWand   202BW 
```

我希望这可以在 T-SQL 中完成。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-06-17T01:55:05.607

```
Select ID, Cat, Price, Name, Abbrv
From
(SELECT t1.ID, t1.Cat, t1.Price, t1.Price AS SortPrice, NULL as Name, NULL as Abbrv 
FROM t1
UNION
SELECT t2.ID, NULL as Cat, NULL as Price, t1.Price as SortPrice, t2.Name, t2.Abbrv 
   FROM t2
   inner join t1 on t2.id = t1.id
) t3
ORDER BY SortPrice DESC, Abbrv ASC 
```

不知何故，您必须知道表 2 中的数据链接到表 1 并分享价格。由于 abbrv 中的 Null 将首先出现，因此无需创建 SortAbbrv 列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T03:09:25.643

您应该使用 UNION ALL 而不是 UNION 来节省重复检查的成本。

```
SELECT *
FROM
(
SELECT t1.ID, t1.Cat, t1.Price, NULL as Name, NULL as Abbrv FROM t1
UNION ALL
SELECT t2.ID, NULL as Cat, NULL as Price, t2.Name, t2.Abbrv FROM t2
) as sub
ORDER BY
  ID,
  CASE WHEN Price is not null THEN 1 ELSE 2 END,
  Price DESC,
  CASE WHEN Abbrv is not null THEN 1 ELSE 2 END,
  Abbrv ASC 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T22:55:13.627

在我的脑海中，我会说最坏的情况是您创建一个临时表，其中所有字段都从 T1 和 T2 执行 INSERT INTO 临时表，然后从临时表中按顺序选择。

IE。创建一个临时表（例如#temp），其中包含 Id、Cat、Price、Name、Abbrv 字段，然后：

```
SELECT Id, Cat, Price, null, null INTO #temp FROM T1
SELECT Id, null, null, Name, Abbrv INTO #temp FROM T2
SELECT * FROM #temp ORDER BY Id, Price DESC, Abbrv ASC 
```

注意：我不能 100% 确定插入的 null 语法，但我认为它会起作用。

编辑：在 id 之后按价格和缩写添加了排序...如果 Id 没有链接 T1 和 T2，那又是什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T22:52:33.213

一个快速的解决方案是在临时表或表变量中进行 2 次插入，作为插入临时表的一部分，您可以设置一个标志列以帮助排序，然后按该标志列排序。

# asp.net - ASP.NET MVC 和 ORM 选择

> ID：1004295
> 
> 赞同：28
> 
> 时间：2009-06-16T22:43:02.483
> 
> 标签：asp.net, asp.net-mvc, orm

我们正准备开始重新开发一个大型老化的内部企业应用程序。我们已决定使用 ASP.NET MVC，但正在考虑选择哪种对象关系映射 (ORM)。当然，有许多开源和付费的 ORM 实现可用。然而，[NHibernate](https://www.hibernate.org/343.html)似乎占据了最大的份额，而[Entity Framework](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)是微软的新热点。

当我们在做研究和玩弄两者时，我们想把它告诉社区他们更喜欢哪种 ORM（NHibernate、实体框架或其他）以及为什么。

有点相似的 Stackoverflow 问题

*   [你最喜欢的 .NET ORM 是什么？](https://stackoverflow.com/questions/3505/what-are-you-favorite-net-orms)（好清单，但没有理由）
*   [ASP.NET MVC + ORM](https://stackoverflow.com/questions/179915/asp-net-mvc-orm)（主要关注 Castle Project AR）
*   [您会为 .NET 推荐什么对象映射器解决方案？](https://stackoverflow.com/questions/380620/what-object-mapper-solution-would-you-recommend-for-net-closed)[封闭问题]

额外的 .NET ORM 阅读

*   [.NET 3.5 中的 ORM](http://dotnetslackers.com/articles/net/ORMInNET35.aspx)
*   [为什么使用实体框架？](http://blogs.msdn.com/dsimmons/archive/2008/05/17/why-use-the-entity-framework.aspx)
*   [为什么使用实体框架？是啊，为什么？](http://weblogs.asp.net/fbouma/archive/2008/05/19/why-use-the-entity-framework-yeah-why-exactly.aspx)
*   [最佳 .NET ORM 工具](http://geekswithblogs.net/diadiora/archive/2009/01/12/best-.net-orm-tool.aspx)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-16T22:53:44.503

你应该看看[Sharp Architecture](https://github.com/sharparchitecture/Sharp-Architecture)一个使用 NHibernate 的 ASP.NET MVC 应用程序框架。

在过去的几年中，我使用了一些 O/RM，除了 NHibernate 之外没有其他选择。

1.  这是最成熟的。
2.  它有很多功能。
3.  它背后有一个很好的社区。
4.  它有一些很棒的辅助项目，例如[Fluent NHibernate](http://www.fluentnhibernate.org/)。

我不知道在您链接到的问题中，人们还能为您提供更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-25T18:34:15.580

疯话回答：没有。

这并不是说如果使用得当，ORM 就不是很棒的技术。但在 2011 年，它们正迅速成为并非所有问题都是钉子的通用锤子。现代 ORM 中发生的事情太多了，尤其是对于那些不熟悉它们的人来说，它们可能会混淆事物而不是帮助事物。或者，有时事情很简单，直接 SQL 是更好的选择。无论 ORM 有多好，抽象*都会*在某个时候泄漏。

要看的另一面是整个 NoSQL 运动。该技术仍然有点新，但对于新工作来说，它是一种必须考虑的数据访问策略，因为它在构建应用程序时需要做很多事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-26T10:54:41.900

简短的回答：同时使用（我确实同时使用）......

使用 ORM 有多种可能性，一切都取决于您想要什么。

作为一个真正的 ORM 映射器，我强烈推荐**NHibernate**和**Fluent NH**映射。你需要大量的研究来构建一个漂亮的架构，但是没有什么能挡住你的路。以最小的妥协，您获得真正的灵活性。

**EF6x**（核心不是产品就绪恕我直言）被称为 ORM，但它生成的更接近于 DAL。有些事情是您无法使用 EF6 有效完成的。尽管如此，这仍然是我最喜欢的读取模型工具，而我确实将它与 NHibernate 结合在一起（我将 NH 用于 DDD/写入模型）。

现在来**表现**- 它总是有利有弊。如果您深入了解 ORM**架构**（请参阅我的文章：[避免 ORM 坏习惯](https://www.linkedin.com/pulse/get-know-your-orm-avoid-bad-habits-balazs-hideghety)），那么您会直观地找到使其更快的方法。这是我的另一篇关于如何使 EF6x**更快**5 倍的文章（至少在读取情况下）：[EF6.x 5x faster](https://www.linkedin.com/pulse/orm-read-performance-ef-vs-dapper-balazs-hideghety)

# c# - 如何从 java 中读取 .net xml 序列化的日期时间？

> ID：1004300
> 
> 赞同：0
> 
> 时间：2009-06-16T22:45:01.980
> 
> 标签：c#, java, datetime

我正在将我们的一些应用程序从 c# 移植到 java。一些数据对象被 xml 序列化并存储以供以后使用。内置的 .net xml 序列化会自动以以下格式保存 DateTime 属性：

```
2009-05-11T16:47:08.6033346-04:00 
```

如何将它放入 Java 中的 Date 对象中？我读到日期格式是 ISO 8601，在 MSDN 文档中标记为 SortableDateTime。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T22:50:18.660

[`parseDateTime`](http://java.sun.com/javase/6/docs/api/javax/xml/bind/DatatypeConverter.html#parseDateTime%28java.lang.String%29)?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T22:52:46.003

使用以下代码段：

```
import java.text.SimpleDateFormat;
import java.util.Date;

SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss");
Date d = sdf.parse("2009-05-11T16:47:08.6033346-04:00"); 
```

# java - 使用 BeanUtils.copyProperties 时如何保持数值为 null？

> ID：1004303
> 
> 赞同：2
> 
> 时间：2009-06-16T22:46:00.013
> 
> 标签：java, sql-server, hibernate, struts

我有一个允许空值的数字数据库字段（SQL Server 2000 中的numeric(3)），而空值是我首选的“无值”值。

该字段映射到 Hibernate 中的非原始 java`Long`类：

`<property column="my_column" name="my_column" type="java.lang.Long" not-null="false" />`

该字段设置为`java.lang.Long`在我的 struts 表单和 bean 中。首次创建 Struts 表单时，我已验证该属性返回 null。创建 bean 时（从数据库中提取），我已验证该属性返回 null。但是，在使用`BeanUtils.copyProperties()`bean 值预填充 Struts 表单后，该属性返回 0，如果我继续保存表单，数据库将具有 0 值。

我是否使用了错误的类型或类型组合（在数据库和/或 Hibernate/Java 中）来维护数字字段的空值？我应该将数字 sql 类型映射到不同的 Java 类`BigDecimal`吗？在研究中，我发现提到了一个`Converter`类。我是否需要创建这样一个类来帮助`BeanUtils`正确维护空值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T22:54:20.883

您需要为 BeanUtils 中的默认值注册一个带有 null 的 LongConverter。

```
ConvertUtils.register(new LongConverter(null), Long.class); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T05:24:34.413

在 web.xml 中使用下面的代码

```
<init-param>
      <param-name>convertNull</param-name>
      <param-value>true</param-value>
</init-param> 
```

所以这会将默认的 0 转换为 null。

# ruby-on-rails - 修改控制器以接受 Ruby on Rails 中的附加字段

> ID：1004310
> 
> 赞同：0
> 
> 时间：2009-06-16T22:49:33.797
> 
> 标签：ruby-on-rails

使用 Ruby on Rails，我创建了一个博客。该博客有帖子，以及与每个帖子相关的评论。

我想向评论控制器（或模型，不确定）添加一个名称字段，以便识别评论者。因为现在它只是一个正在添加的评论。名称字段应存储在数据库中。

一旦我已经设置好并且只想修改，完成此操作的最佳方法是什么？此时可以使用脚手架或生成吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T22:56:05.437

您想要创建一个数据库迁移文件，该文件将一列添加到数据库中的 Comments 表中。您需要调整视图以显示评论者姓名的表单字段，并让博客在评论旁边显示名称。这个 RoR 指南应该让你开始 [http://guides.rubyonrails.org/migrations.html](http://guides.rubyonrails.org/migrations.html)

你可以使用 Generate 来做这样的事情

```
ruby script/generate migration AddCommentNames 
```

然后编辑出现的迁移文件`db/migrations`以添加一些内容

```
add_column :comments, :name, :string 
```

# c# - 以编程方式修改文件内容

> ID：1004312
> 
> 赞同：1
> 
> 时间：2009-06-16T22:50:03.810
> 
> 标签：c#, file

我必须使用 C# 以编程方式修改文件中的文本。执行此操作并避免重写整个文件内容的最佳方法是什么。我只想编辑一些单词并保存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T22:57:39.350

您可以使用 StreamWriter 和 AppendText 轻松附加到现有文件。

如果您想做更严重的修改，那么我认为您必须使用 StreamReader 将文件的内容读入 C# 中的内存，例如，以编程方式修改该流的内容，然后用流的内容重写文件。

我认为无论如何都是这样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T23:17:42.477

正如其他人所说，您可以轻松附加到现有文件。在文件中间插入数据需要您写出文件的其余部分。没有办法只移动文件中的所有内容。如果要就地覆盖单个字节，可以打开[FileStream](http://msdn.microsoft.com/en-us/library/system.io.filestream.aspx)。然后，您使用“Seek”转到要覆盖的特定字节，并使用 Write 或 WriteByte 用新数据覆盖现有数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T08:35:17.353

如果你的目标是 windows，你可以使用 winapi [CreateFile、ReadFile、WriteFile 等](http://msdn.microsoft.com/en-us/library/aa364232(VS.85).aspx)。您可以轻松地写入文件中的任何位置，并根据需要写入尽可能多的数据。您不必重写文件。这甚至不需要不安全的代码。我限制了函数的功能（没有异步或古怪的文件映射）只是为了快速完成，但它可以读取和写入文件没有问题。为了让这个例子工作，制作一个 100 字节左右的小文本文件，并确保它位于 exe 的位置。这段代码的一小部分来自 MSDN 网站。我已经对它进行了重大修改。

```
using System;
using Microsoft.Win32.SafeHandles;
using System.Runtime.InteropServices;
using System.ComponentModel;
using System.Windows.Forms;
using Path = System.IO.Path;

class Program {

  static void Main() {

    string sTestFile = Path.Combine(Path.GetDirectoryName(
     Application.ExecutablePath), "Test.txt");

    // test reading a file
    WinApiFile File = new WinApiFile(sTestFile,
     WinApiFile.DesiredAccess.GENERIC_READ);
    byte[] aBuffer = new byte[1000];
    uint cbRead = File.Read(aBuffer, 1000);
    File.Close();

    // Test writing the file
    File.Open(WinApiFile.DesiredAccess.GENERIC_WRITE);
    // write the time to a 10 byte offset in the file
    // conver the date time to byte array
    int i = 0;
    foreach (var ch in DateTime.Now.ToString()) 
      aBuffer[i++] = (byte)ch;
    // now write it out
    File.MoveFilePointer(10);  // 10 byte offset
    File.Write(aBuffer, (uint)i);  // write the time
    File.Dispose();
  }
}

public class WinApiFile : IDisposable {

  /* ---------------------------------------------------------
   * private members
   * ------------------------------------------------------ */
  private SafeFileHandle _hFile = null;
  private string _sFileName = "";
  private bool _fDisposed;

  /* ---------------------------------------------------------
   * properties
   * ------------------------------------------------------ */
  public bool IsOpen { get { return (_hFile != null); } }
  public SafeFileHandle Handle { get { return _hFile; } }
  public string FileName {
    get { return _sFileName; }
    set {
      _sFileName = (value ?? "").Trim();
      if (_sFileName.Length == 0)
        CloseHandle(_hFile);
    }
  }
  public int FileLength {
    get {
      return (_hFile != null) ? (int)GetFileSize(_hFile,
       IntPtr.Zero) : 0;
    }
    set {
      if (_hFile == null)
        return;
      MoveFilePointer(value, MoveMethod.FILE_BEGIN);
      if (!SetEndOfFile(_hFile))
        ThrowLastWin32Err();
    }
  }

  /* ---------------------------------------------------------
   * Constructors
   * ------------------------------------------------------ */

  public WinApiFile(string sFileName,
   DesiredAccess fDesiredAccess) {
    FileName = sFileName;
    Open(fDesiredAccess);
  }
  public WinApiFile(string sFileName,
   DesiredAccess fDesiredAccess,
   CreationDisposition fCreationDisposition) {
    FileName = sFileName;
    Open(fDesiredAccess, fCreationDisposition);
  }

  /* ---------------------------------------------------------
   * Open/Close
   * ------------------------------------------------------ */

  public void Open(
   DesiredAccess fDesiredAccess) {
    Open(fDesiredAccess, CreationDisposition.OPEN_EXISTING);
  }

  public void Open(
   DesiredAccess fDesiredAccess,
   CreationDisposition fCreationDisposition) {
    ShareMode fShareMode;
    if (fDesiredAccess == DesiredAccess.GENERIC_READ) {
      fShareMode = ShareMode.FILE_SHARE_READ;
    } else {
      fShareMode = ShareMode.FILE_SHARE_NONE;
    }
    Open(fDesiredAccess, fShareMode, fCreationDisposition, 0);
  }

  public void Open(
   DesiredAccess fDesiredAccess, 
   ShareMode fShareMode, 
   CreationDisposition fCreationDisposition, 
   FlagsAndAttributes fFlagsAndAttributes) {

    if (_sFileName.Length == 0)
      throw new ArgumentNullException("FileName");
    _hFile = CreateFile(_sFileName, fDesiredAccess, fShareMode, 
     IntPtr.Zero, fCreationDisposition, fFlagsAndAttributes, 
     IntPtr.Zero);
    if (_hFile.IsInvalid) {
      _hFile = null;
      ThrowLastWin32Err();
    }
    _fDisposed = false;

  }

  public void Close() {
    if (_hFile == null)
      return;
    _hFile.Close();
    _hFile = null;
    _fDisposed = true;
  }

  /* ---------------------------------------------------------
   * Move file pointer 
   * ------------------------------------------------------ */

  public void MoveFilePointer(int cbToMove) {
    MoveFilePointer(cbToMove, MoveMethod.FILE_CURRENT);
  }

  public void MoveFilePointer(int cbToMove, 
   MoveMethod fMoveMethod) {
    if (_hFile != null)
      if (SetFilePointer(_hFile, cbToMove, IntPtr.Zero, 
       fMoveMethod) == INVALID_SET_FILE_POINTER)
        ThrowLastWin32Err();
  }

  public int FilePointer {
    get {
      return (_hFile != null) ? (int)SetFilePointer(_hFile, 0, 
       IntPtr.Zero, MoveMethod.FILE_CURRENT) : 0;
    }
    set {
      MoveFilePointer(value);
    }
  }

  /* ---------------------------------------------------------
   * Read and Write
   * ------------------------------------------------------ */

  public uint Read(byte[] buffer, uint cbToRead) {
    // returns bytes read
    uint cbThatWereRead = 0;
    if (!ReadFile(_hFile, buffer, cbToRead, 
     ref cbThatWereRead, IntPtr.Zero))
      ThrowLastWin32Err();
    return cbThatWereRead;
  }

  public uint Write(byte[] buffer, uint cbToWrite) {
    // returns bytes read
    uint cbThatWereWritten = 0;
    if (!WriteFile(_hFile, buffer, cbToWrite, 
     ref cbThatWereWritten, IntPtr.Zero))
      ThrowLastWin32Err();
    return cbThatWereWritten;
  }

  /* ---------------------------------------------------------
   * IDisposable Interface
   * ------------------------------------------------------ */
  public void Dispose() {
    Dispose(true);
    GC.SuppressFinalize(this);
  }

  protected virtual void Dispose(bool fDisposing) {
    if (!_fDisposed) {
      if (fDisposing) {
        if (_hFile != null)
          _hFile.Dispose();
        _fDisposed = true;
      }
    }
  }

  ~WinApiFile() {
    Dispose(false);
  }

  /* ---------------------------------------------------------
   * WINAPI STUFF
   * ------------------------------------------------------ */

  private void ThrowLastWin32Err() {
    Marshal.ThrowExceptionForHR(
     Marshal.GetHRForLastWin32Error());
  }

  [Flags]
  public enum DesiredAccess : uint {
    GENERIC_READ = 0x80000000,
    GENERIC_WRITE = 0x40000000
  }
  [Flags]
  public enum ShareMode : uint {
    FILE_SHARE_NONE = 0x0,
    FILE_SHARE_READ = 0x1,
    FILE_SHARE_WRITE = 0x2,
    FILE_SHARE_DELETE = 0x4,

  }
  public enum MoveMethod : uint {
    FILE_BEGIN = 0,
    FILE_CURRENT = 1,
    FILE_END = 2
  }
  public enum CreationDisposition : uint {
    CREATE_NEW = 1,
    CREATE_ALWAYS = 2,
    OPEN_EXISTING = 3,
    OPEN_ALWAYS = 4,
    TRUNCATE_EXSTING = 5
  }
  [Flags]
  public enum FlagsAndAttributes : uint {
    FILE_ATTRIBUTES_ARCHIVE = 0x20,
    FILE_ATTRIBUTE_HIDDEN = 0x2,
    FILE_ATTRIBUTE_NORMAL = 0x80,
    FILE_ATTRIBUTE_OFFLINE = 0x1000,
    FILE_ATTRIBUTE_READONLY = 0x1,
    FILE_ATTRIBUTE_SYSTEM = 0x4,
    FILE_ATTRIBUTE_TEMPORARY = 0x100,
    FILE_FLAG_WRITE_THROUGH = 0x80000000,
    FILE_FLAG_OVERLAPPED = 0x40000000,
    FILE_FLAG_NO_BUFFERING = 0x20000000,
    FILE_FLAG_RANDOM_ACCESS = 0x10000000,
    FILE_FLAG_SEQUENTIAL_SCAN = 0x8000000,
    FILE_FLAG_DELETE_ON = 0x4000000,
    FILE_FLAG_POSIX_SEMANTICS = 0x1000000,
    FILE_FLAG_OPEN_REPARSE_POINT = 0x200000,
    FILE_FLAG_OPEN_NO_CALL = 0x100000
  }

  public const uint INVALID_HANDLE_VALUE = 0xFFFFFFFF;
  public const uint INVALID_SET_FILE_POINTER = 0xFFFFFFFF;
  // Use interop to call the CreateFile function.
  // For more information about CreateFile,
  // see the unmanaged MSDN reference library.
  [DllImport("kernel32.dll", SetLastError = true)]
  internal static extern SafeFileHandle CreateFile(
   string lpFileName,
   DesiredAccess dwDesiredAccess, 
   ShareMode dwShareMode, 
   IntPtr lpSecurityAttributes,
   CreationDisposition dwCreationDisposition, 
   FlagsAndAttributes dwFlagsAndAttributes,
   IntPtr hTemplateFile);

  [DllImport("kernel32", SetLastError = true)]
  internal static extern Int32 CloseHandle(
   SafeFileHandle hObject);

  [DllImport("kernel32", SetLastError = true)]
  internal static extern bool ReadFile(
   SafeFileHandle hFile, 
   Byte[] aBuffer,
   UInt32 cbToRead,
   ref UInt32 cbThatWereRead, 
   IntPtr pOverlapped);

  [DllImport("kernel32.dll", SetLastError = true)]
  internal static extern bool WriteFile(
   SafeFileHandle hFile, 
   Byte[] aBuffer,
   UInt32 cbToWrite, 
   ref UInt32 cbThatWereWritten, 
   IntPtr pOverlapped);

  [DllImport("kernel32.dll", SetLastError = true)]
  internal static extern UInt32 SetFilePointer(
   SafeFileHandle hFile,
   Int32 cbDistanceToMove, 
   IntPtr pDistanceToMoveHigh,
   MoveMethod fMoveMethod);

  [DllImport("kernel32.dll", SetLastError = true)]
  internal static extern bool SetEndOfFile(
   SafeFileHandle hFile);

  [DllImport("kernel32.dll", SetLastError = true)]
  internal static extern UInt32 GetFileSize(
   SafeFileHandle hFile, 
   IntPtr pFileSizeHigh);

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T23:10:50.867

当您打开一个文件进行写入时，只有两种可能的结果。打开它以进行附加，这将只允许您在末尾写入，或者您打开它以进行正常写入，在这种情况下您将从文件的开头写入。没有“在中点打开，写入然后根据插入长度移动剩余内容”。

某些 API 可能会允许此类修改，但在幕后，它们只允许您进行这两个基本操作。但是，您不必担心重写整个文件，除非您的文件很大并且硬盘驱动器非常慢，否则这并不是一个糟糕的操作。你应该更多地担心你这样做的次数。

1.  打开文件
2.  将整个文件读入变量或数组
3.  插入修改
4.  写回文件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T23:00:49.280

读取文件并对其进行修改然后再次读取它可能更简单。

要真正提高效率（即不是为每个操作读取/写入整个文件），您需要做一些内务以跟踪有关文件的元数据，然后进行二进制编辑。

您仍然必须管理文件增长和需要附加的情况等。

# c - `getchar()` 在哪里存储用户输入？

> ID：1004314
> 
> 赞同：7
> 
> 时间：2009-06-16T22:51:04.057
> 
> 标签：c, loops, io, kernighan-and-ritchie

我已经开始阅读“ [The C Programming Language](https://rads.stackoverflow.com/amzn/click/com/0131103628) ”（K&R）并且我对这个函数有疑问`getchar()`。

例如这段代码：

```
#include <stdio.h>

main()
{
  int c;

  c = getchar();
  putchar(c);
  printf("\n");   
} 
```

键入`toomanychars`++ (EOF) 仅`CTRL`打印. 我认为这是意料之中的，因为它是第一个引入的角色。`D``t`

但是接下来的另一段代码：

```
#include <stdio.h>

main()
{
  int c;

  while((c = getchar()) != EOF) 
    putchar(c);
} 
```

键入`toomanychars`+ `CTRL`+ `D`(EOF) 打印`toomanychars`。

我的问题是，如果我只有一个 char 变量，为什么会发生这种情况？其余字符存储在哪里？

**编辑：**

感谢大家的回答，我现在开始明白了......只有一个问题：

第一个程序在给定`CTRL`+时退出，`D`而第二个程序打印整个字符串，然后等待更多用户输入。为什么它等待另一个字符串并且不像第一个那样退出？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-16T22:54:23.567

`getchar`从标准输入中获取单个字符，在本例中为键盘缓冲区。

在第二个示例中，`getchar`函数处于一个`while`循环中，该循环一直持续到遇到 a `EOF`，因此它将继续循环并检索一个字符（并将字符打印到屏幕上），直到输入变为空。

连续调用`getchar`将获得来自输入的连续字符。

哦，不要因为问这个问题而感到难过——当我第一次遇到这个问题时我也很困惑。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T22:53:41.993

它将输入流视为文件。就好像您打开一个包含文本“toomanychars”的文件并一次读取或输出一个字符。

在第一个示例中，在没有 while 循环的情况下，就像您打开一个文件并读取第一个字符，然后将其输出。但是，第二个示例将继续读取字符，直到它收到文件结束信号（`ctrl+D`在您的情况下），就像它从磁盘上的文件中读取一样。

* * *

在回复您更新的问题时，您使用的是什么操作系统？我在我的 Windows XP 笔记本电脑上运行它，它运行良好。如果我按 Enter 键，它会打印出我到目前为止的内容，换行，然后继续。（在`getchar()`您按下回车之前，该函数不会返回，即当它被调用时输入缓冲区中没有任何内容）。当我按下`CTRL+Z`（Windows 中的 EOF）时，程序终止。请注意，在 Windows 中，EOF 必须位于其自身的一行中，才能在命令提示符下算作 EOF。我不知道这种行为是否在 Linux 或您可能正在运行的任何系统中被模仿。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T23:03:03.380

这里的东西是缓冲的。例如 putchar 写入的 stdout FILE* 可能是 line.buffered。当程序结束（或遇到换行符）时，这样的 FILE* 将被 fflush()'ed 并且您将看到输出。

在某些情况下，您正在查看的实际终端可能会缓冲输出直到换行，或者直到终端本身被指示刷新它的缓冲区，这可能是当前前台程序退出时的情况，因为它想要呈现一个新的提示。

现在，这里的实际情况可能是，这是缓冲的输入（除了输出:-)）当您按下键时，它会出现在终端窗口上。但是，终端不会将这些字符发送到您的应用程序，它会缓冲它，直到您使用 Ctrl+D 指示它作为输入结束，也可能是换行符。这是另一个可以玩和思考的版本：

```
int main() {
  int c;
   while((c = getchar()) != EOF) {
     if(c != '\n')
        putchar(c);
   }
    return 0;
} 
```

试着给你的程序输入一个句子，然后按 Enter。如果您注释掉 if(c != '\n') 也可以这样做 也许您可以确定您的输入、输出或两者是否以某种方式被缓冲。如果你像这样运行上面的代码，这会变得更有趣： ./mytest | ./mytest

（作为旁注，请注意 CTRD+D 不是字符，也不是 EOF。但在某些系统上，它会导致关闭输入流，这将再次引发 EOF 任何试图从流中读取的人。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-16T22:55:18.667

你的第一个程序只读取一个字符，打印出来，然后退出。您的第二个程序有一个循环。它保持一次读取一个字符并将它们打印出来，直到它读取一个 EOF 字符。在任何给定时间只存储一个字符。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-16T22:57:33.077

您只使用该变量`c`一次包含每个字符。

使用显示第一个字符 ( `t`)后，通过将下一个字符 ( ) 分配给变量，替换前一个值 ( ) `putchar(c)`，您就忘记了 的值。`c``o``c``t`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-16T23:00:53.837

该代码在功能上等同于

```
main(){
  int c;
  c = getchar();
  while(c != EOF) {
    putchar(c);
    c = getchar();
  }
} 
```

你可能会发现这个版本更容易理解。将赋值放在条件中的唯一原因是避免输入 'c=getchar()' 两次。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-03T06:47:06.287

对于您更新的问题，在第一个示例中，仅读取一个字符。它永远不会到达 EOF。程序终止，因为在完成 printf 指令后它无事可做。它只读取一个字符。打印它。换行。然后终止，因为它无事可做。它不会读取多个字符。

而在第二个代码中，getchar 和 putchar 存在于 while 循环中。在这种情况下，程序继续一个一个地读取字符（因为它是由循环执行的），直到到达 EOF 字符（^D）。此时，它匹配 c!=EOF 并且由于不满足条件，它退出循环。现在没有更多的语句要执行。所以程序在此时终止。

希望这可以帮助。

# c# - range : 将格式应用于范围内的子部分

> ID：1004316
> 
> 赞同：0
> 
> 时间：2009-06-16T22:51:48.457
> 
> 标签：c#, interop, ms-office, office-automation, word-automation

我正在用 c# 编写一段代码以在 microsft word 文档中生成报告。

*   我有一个 2 列的表格。
*   我选择第二列

    oMainTable.Cell(currentRowNumber, 2).Range

*   每次我必须在该单元格中写一些东西时，我都会使用上面的代码与 Text 属性、InsertParagraph()、InsertAfter() 等的组合

现在假设我有这个内容：

> 部分示例内容 部分示例内容 部分示例内容 部分示例内容 部分示例内容 部分示例内容 部分示例内容。
> 
> ```
> New Paragraph Some sample content Some sample content Some sample 
> ```
> 
> 内容 部分示例内容 部分示例内容 部分示例内容 部分示例内容
> 
> ```
> Some Title1
> 
> New Paragraph Some sample content Some sample content Some sample 
> ```
> 
> 内容 部分示例内容 部分示例内容 部分示例内容 部分示例内容
> 
> ```
> New Paragraph Some sample content Some sample content Some sample 
> ```
> 
> 内容 部分示例内容 部分示例内容 部分示例内容 部分示例内容
> 
> ```
> Some Title1 
> ```

我想对 someTitle1 和 someTitle2 应用下划线和粗斜体，这样它们就不适用​​于整个范围；并且仅限于这两个文本行。

有什么帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T16:14:08.550

让我先做一个免责声明 ;-) “**这里提出的解决方案是我的打击和试验方法以及头部撞击的结果**”

```
 object srchText="Text to be searched and formatted differently from the rest of the range";
    oTable.Cell(countRow, 2).Range.Select();
    var selectUpdateComment=oTable.Cell(countRow, 2).Range.Application.Selection;
    selectUpdateComment.Find.Execute2007(ref srchText, ref missing, ref missing,
 ref missing, ref missing, ref missing, ref missing, ref missing,
 ref missing, ref missing, ref missing, ref missing, ref missing,
 ref missing, ref missing, ref missing, ref missing, ref missing,ref missing, ref missing);

    if(selectUpdateComment.Find.Found) {
        selectUpdateComment.Font.Bold=1;
        selectUpdateComment.Font.Underline=WdUnderline.wdUnderlineSingle;
    } 
```

我在一个循环中这样做，所以每次我必须做 Range.Select，否则我不会得到正确的选择。

请提出更好的方法..

# java - 摆脱 derby.log

> ID：1004327
> 
> 赞同：28
> 
> 时间：2009-06-16T22:54:36.470
> 
> 标签：java, maven-2, derby

我正在使用 Apache Derby 嵌入式数据库在 Maven 项目中进行单元测试。不幸的是，每当我运行测试时，我都会`derby.log`在项目的根目录中找到该文件。数据库本身是在`target`目录 ( `jdbc:derby:target/unittest-db;create=true`) 中创建的，因此这不是问题。在查阅[参考指南](http://db.apache.org/derby/docs/10.2/ref/rrefattrib24612.html#rrefattrib24612)后， 我尝试`logDevice`在 JDBC url ( `jdbc:derby:target/unittest-db;create=true;logDevice=/mylogs`) 上设置参数，但这似乎是针对不同的日志，因此`derby.log`仍然出现。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-12-19T16:16:26.970

Derby 允许您使用 Java 系统属性指定将错误日志消息写入其中的文件的名称[`derby.stream.error.file`](http://db.apache.org/derby/docs/10.8/ref/rrefproper33027.html)。默认值为“derby.log”。

为了摆脱`derby.log`Maven 万无一失的测试阶段，我只需在插件配置中添加属性定义，如下所示：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <configuration>
        <systemProperties>
            <property>
                <name>derby.stream.error.file</name>
                <value>target/derby.log</value>
            </property>
        </systemProperties>
    </configuration>
</plugin> 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-06-17T01:34:11.437

[`derby.log`](http://db.apache.org/derby/docs/dev/devguide/cdevdvlp25889.html)您可以通过创建以下类来摆脱文件

```
public class DerbyUtil {
    public static final OutputStream DEV_NULL = new OutputStream() {
        public void write(int b) {}
    };
} 
```

并设置 JVM 系统属性[`derby.stream.error.field`](http://db.apache.org/derby/docs/10.8/ref/rrefproper33027.html)，例如，使用以下 JVM 命令行参数：

```
-Dderby.stream.error.field=DerbyUtil.DEV_NULL 
```

[应归功于谁。](http://davidvancouvering.blogspot.com/2007/10/quiet-time-and-how-to-suppress-derbylog.html)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-02T14:09:48.517

在 derby.properties 文件中包含以下内容：

```
derby.stream.error.file=/dev/null 
```

（ 或者

```
derby.stream.error.file=\\Device\\Null 
```

在 Windows 上）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-05-25T17:53:01.633

对于集成测试，情况可能比简单的[肯定](https://stackoverflow.com/a/1933310/3537255)性属性更棘手。`derby.stream.error.file`在 中指定属性`maven-failsafe-plugin`将不起作用，因为服务器环境不会从该插件继承（显然使用`maven-surefire-plugin`没有区别）。

相反，您需要修改实际的服务器启动插件。以下示例适用于`maven-jetty-plugin`：

```
<plugin>
    <groupId>org.mortbay.jetty</groupId>
    <artifactId>jetty-maven-plugin</artifactId>
    <configuration>
        <systemProperties>
            <!-- Get rid of that missplaced derby.log. -->
            <systemProperty>
                <name>derby.stream.error.file</name>
                <value>${project.build.directory}/derby.log</value>
            </systemProperty>
        </systemProperties>
    </configuration>
</plugin> 
```

请注意，出于某种原因，我们使用`systemProperty`而不是`property`像在万无一失的解决方案中那样。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-07-27T12:13:20.110

您也可以将 derby home 设置为`target/derby`或`target`通过：

```
System.setProperty("derby.system.home", new File("target/derby").getAbsolutePath()); 
```

然后使用 JDBC URL `jdbc:derby:unittest-db;create=true`。然后 derby.log 出现在正确的文件夹中。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-07-06T12:58:59.900

我想出了另一个解决方案。试试这个；它对我有用。我在这里所做的是我更改了 System.stream.error.file 路径并将其设置为我的属性文件下存在的属性之一。只需将以下给定代码添加到您的 applicationContext.xml 文件中即可。

```
<bean id="setDerbyLog" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
  <property name="targetClass"><value>java.lang.System</value></property>
  <property name="targetMethod"><value>setProperty</value></property>
  <property name="arguments">
    <list>
      <value>derby.stream.error.file</value>
      <value>${derby.stream.error.file}</value>
    </list>
  </property>
</bean> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-08-31T10:35:08.613

如果您无权访问配置，则可以在建立连接之前执行此操作：

```
System.setProperty("derby.stream.error.field", "MyApp.DEV_NULL"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-12-07T17:06:17.413

这不是您的`derby.log`文件问题的解决方案（许多人已经展示了如何解决），而是一个建议。为什么不使用[derby-maven-plugin](https://github.com/carlspring/derby-maven-plugin)进行测试？它将`derby.log`文件放在 下`target/derby`，因此不会留下任何垃圾。

如[我在此处的回答](https://stackoverflow.com/questions/14731178/creating-temporary-database-that-works-across-maven-test-phases/15089028#15089028)中所述，您可以通过我编写的 derby-maven-plugin 将 Derby 用作您的数据库，该插件可在[GitHub](https://github.com/carlspring/derby-maven-plugin)和 Maven Central 上获得。

# asp.net-mvc - ASP.Net MVC：等等……默认路由参数必须命名为 id？

> ID：1004331
> 
> 赞同：0
> 
> 时间：2009-06-16T22:56:00.850
> 
> 标签：asp.net-mvc, routes

其他人遇到过这个问题吗？我一定是做错了什么。

所以我正在为这样的错误设置一条路线：

```
routes.MapRoute
(
 "SharedError",
 "Shared/Error/{error}",
 new { error = "" }
); 
```

并像这样调用：

```
return parentController.RedirectToRoute("SharedError", new RouteValueDictionary(new { error = errorMessage.ToString() })); 
```

在控制器上：

```
public ActionResult Error(String error) 
```

简单吧？好吧，当它实际运行时，尽管 url 看起来像这样，但错误为 null：

/共享/错误/ThisIsTheError

但是Error方法中的error参数为null。（是的，我试过其他词）

现在，如果我用“id”这个词替换所有这些，一切正常。

全球.asax.cs

```
routes.MapRoute
(
 "SharedError",
 "Shared/Error/{id}",
 new { id = "" }
); 
```

重定向：

```
return parentController.RedirectToRoute("SharedError", new RouteValueDictionary(new { id = errorMessage.ToString() })); 
```

共享控制器：

```
public ActionResult Error(String id) 
```

如果您有一个默认路由接受一个值，那么 id 是所有路由都必须有的单词吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T23:03:28.137

你总是需要指定控制器和动作参数：

```
routes.MapRoute
(
 "SharedError",
 "Shared/Error/{error}",
 new { controller = "Shared", action="Error", error = "" }
); 
```

我猜想使用 id 对你有用的原因是因为你仍然注册了默认路由，它有 id 作为参数和控制器和操作的默认值。

请注意，如果您仍然有默认路由，请确保在它**之前**添加您的路由，否则它将首先匹配另一个。

# xml - Linq to XML - 结果很奇怪

> ID：1004333
> 
> 赞同：0
> 
> 时间：2009-06-16T22:56:19.820
> 
> 标签：xml, vb.net, linq, linq-to-xml

我是 Linq 的新手，当我尝试使用 where 执行查询时遇到一些奇怪的结果。

xml 示例：

```
 <movies>
      <movie id="1">
        <scenes>
          <scene id="1">
            <sceneartistsnames>
              <sceneartistname>Artist A</sceneartistname>
            </sceneartistsnames>
          </scene>
          <scene id="2">
            <sceneartistsnames>
              <sceneartistname>Artist B</sceneartistname>
            </sceneartistsnames>
          </scene>
        </scenes>
      </movie>
      <movie id="10">
        <scenes>
          <scene id="1">
            <sceneartistsnames>
              <sceneartistname>Artist B</sceneartistname>
              <sceneartistname>Artist A</sceneartistname>
            </sceneartistsnames>
          </scene>
        </scenes>
      </movie>
    </movies> 
```

现在尝试选择艺术家 A 参与其中的所有场景。

```
Dim Results = From MovieWithArtist In MoviesXML...<scene> _
              Where MovieWithArtist.<sceneartistsnames>.<sceneartistname>.Value = "Artist A" _
              Select MovieWithArtist 
```

我只有一个场景返回，我期待两个。:(

现在，如果我将 XML 中的第二个场景更改为：

```
<movie id="10">
        <scenes>
          <scene id="1">
            <sceneartistsnames>
              <sceneartistname>Artist A</sceneartistname>
              <sceneartistname>Artist B</sceneartistname>
            </sceneartistsnames>
          </scene>
        </scenes>
      </movie> 
```

然后我得到两个场景返回。

我做错了什么？

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T23:21:27.180

为了格式化，我将把它作为一个单独的答案发布：

[这是 Jon 的答案，使用此站点](http://www.developerfusion.com/tools/convert/csharp-to-vb/)转换为 VB.Net 。

```
Private Shared Sub Main()
     Dim doc As XDocument = XDocument.Load("movies.xml")

  Dim query = doc.Descendants("scene").Where(Function(scene) scene.Elements("sceneartistsnames").Elements("sceneartistname").Any(Function(name) name.Value = "Artist A"))

     For Each scene In query
         Console.WriteLine(scene)
     Next
    End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T23:08:34.427

好吧，恐怕我不知道 VB.NET XML 语法，但是这个 C# 工作正常：

```
static void Main()
{
    XDocument doc = XDocument.Load("movies.xml");

    var query = doc.Descendants("scene")
                   .Where(scene => scene.Elements("sceneartistsnames")
                                        .Elements("sceneartistname")
                                        .Any(name => name.Value == "Artist A"));

    foreach (var scene in query)
    {
        Console.WriteLine(scene);
    }
} 
```

将其转换为对 LINQ 扩展方法的 VB.NET 调用应该不难，但恐怕您需要其他人（Jared？）来帮助处理特定于 XML 的语法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T23:19:09.913

Jons 答案的另一种选择是使用 select many (multiple from's)

```
 var qry = from x in xe.Descendants("scene")
            from s in x.Descendants("sceneartistname")
            where (string)s == "Artist A"
            select string.Format("Movie ID {0} Scene ID {1} : {2}", (int)x.Parent.Parent.Attribute("id"), (int)x.Attribute("id"), (string)s); 
```

# php - 使用 PHP (DOM) 遍历未知的 XML 结构

> ID：1004335
> 
> 赞同：6
> 
> 时间：2009-06-16T22:56:52.767
> 
> 标签：php, xml, arrays, parsing, loops

我想编写一个函数，将（理论上）未知的 XML 数据结构解析为等效的 PHP 数组。

这是我的示例 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<content>

<title>Sample Text</title>

<introduction>
    <paragraph>This is some rudimentary text</paragraph>
</introduction>
<description>
    <paragraph>Here is some more text</paragraph>
    <paragraph>Even MORE text</paragraph>
    <sub_section>
        <sub_para>This is a smaller, sub paragraph</sub_para>
        <sub_para>This is another smaller, sub paragraph</sub_para>
    </sub_section>
</description>
</content> 
```

我从 devarticles 修改了这个 DOM 迭代函数：

```
$data = 'path/to/xmldoc.xml';
$xmlDoc = new DOMDocument(); #create a DOM element
$xmlDoc->load( $data ); #load data into the element
$xmlRoot = $xmlDoc->firstChild; #establish root

function xml2array($node)
    {
    if ($node->hasChildNodes())
    {
$subNodes = $node->childNodes;
    foreach ($subNodes as $subNode)
        {
        #filter node types
        if (($subNode->nodeType != 3) || (($subNode->nodeType == 3)))   
            {
            $arraydata[$subNode->nodeName]=$subNode->nodeValue;
            }
         xml2array($subNode);
         }
      }
      return $arraydata;
   }
//The getNodesInfo function call

 $xmlarray = xml2array($xmlRoot);

// print the output - with a little bit of formatting for ease of use...
foreach($xmlarray as $xkey)
     {
     echo"$xkey<br/><br/>";
     } 
```

现在，由于我将元素传递给数组的方式，我将覆盖任何共享节点名称的元素（因为理想情况下，我希望为键提供与其原始节点相同的名称）。我的递归不是很好......但是，即使我清空括号 - 第二层节点仍然作为第一层的*值*出现（参见描述节点的文本）。

任何人都知道如何更好地构建这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T23:26:46.810

您最好从网上获取一些代码

[http://www.bin-co.com/php/scripts/xml2array/](http://www.bin-co.com/php/scripts/xml2array/)

```
 /**
     * xml2array() will convert the given XML text to an array in the XML structure.
     * Link: http://www.bin-co.com/php/scripts/xml2array/
     * Arguments : $contents - The XML text
     *                $get_attributes - 1 or 0\. If this is 1 the function will get the attributes as well as the tag values - this results in a different array structure in the return value.
     *                $priority - Can be 'tag' or 'attribute'. This will change the way the resulting array sturcture. For 'tag', the tags are given more importance.
     * Return: The parsed XML in an array form. Use print_r() to see the resulting array structure.
     * Examples: $array =  xml2array(file_get_contents('feed.xml'));
     *              $array =  xml2array(file_get_contents('feed.xml', 1, 'attribute'));
     */
    function xml2array($contents, $get_attributes=1, $priority = 'tag') { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T23:27:08.523

您可能对[SimpleXML](http://de.php.net/simplexml)或[xml_parse_into_struct](http://de.php.net/xml_parse_into_struct)感兴趣。

$arraydata 既不会传递给对 xml2array() 的后续调用，也不会使用返回值，所以是的“我的递归不是很好......”是真的 ;-)
要将新元素附加到现有数组，您可以使用 empty方括号，$arr[] = 123; $arr[$x][] = 123;

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T01:14:41.833

您可能还想查看 XML Unserializer

[http://pear.php.net/package/XML_Serializer/redirected](http://pear.php.net/package/XML_Serializer/redirected)

# .net - 在对多个项目使用版本控制时处理项目引用

> ID：1004336
> 
> 赞同：0
> 
> 时间：2009-06-16T22:57:25.807
> 
> 标签：.net, svn, version-control

假设我有一个如下的存储库布局：

```
 |Root
   |->CommonLib
   |->ProjectA.PartA
        |->trunk
            |->lib
            |->src
            //etc
   |->ProjectA.PartB
        |->trunk
            |->lib
            |->src
   //About four more projects. 
```

现在我像这样把它们分开，这样我就可以在每个不同的部分工作，并在需要时对它们进行分支。

ProjectA.PartA 使用 ProjectA.PartB 作为参考。

在我这样构建它之前，我将所有项目主干放在一个 src 文件夹中，然后将那个文件夹拉下来，然后将项目添加到解决方案中，并在它们之间添加项目引用。

当它们都在同一个文件夹中时，这工作得很好，但我觉得这可能不是一个好习惯，它会迫使你拥有相同的文件夹结帐结构或依赖关系中断。

我的想法是在哪里构建每个项目并将二进制文件存储在根目录下的 CommonLib 文件夹中，然后在每个项目上使用 svn:externals 将其依赖项从 CommonLib 文件夹下拉到其 lib 文件夹中，并添加一个引用而不是项目本身。

上述解决方案会比添加项目引用更好吗？

有内部项目引用时的常见做法是什么？

如果它们都是同一个“目标”的一部分，我是否应该在所有项目文件夹上设置外部以将依赖项作为源下拉？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T23:22:03.777

SVN 副本很便宜，而且 SVN 合并很容易。所以我会坚持使用一个根解决方案并让项目相互引用。如果需要，将整个事物分支，然后重新集成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T23:22:39.517

通常我会使用外部而不是库本身从每个解决方案中引用项目。在这种情况下，在每个项目中进行单元测试以进行回归测试非常重要。

存储二进制文件并引用外部文件也很好（并且可能更安全）。如果我这样做，我会标记依赖二进制文件的每个版本并引用它。如果我想升级，我会更改外部以使用新标签 - 这使您可以更安全地升级库。

编辑：我刚刚意识到你被分成同一个项目的两个部分——我上面的答案是针对多个项目的共享库。我会把它们放在怀亚特说的同一个后备箱里

# visual-studio - Visual Studio、分布式版本控制和 Sourceforge

> ID：1004340
> 
> 赞同：4
> 
> 时间：2009-06-16T22:59:41.530
> 
> 标签：visual-studio, version-control, distributed

我正在尝试使用 Visual Studio 2008 设置一台新的 Windows 计算机来处理我维护的 Sourceforge 项目。我想用一个分布式版本控制系统（试过SVN，不喜欢）。

我以前在 UNIX 上使用过 git 和 mercurial，但我没有找到一个集成在 Visual Studio 2008 中并允许我处理我的 Sourceforge 代码的优质插件。

任何人都可以就如何取得进展提供一些建议吗？

我应该改用 Eclipse 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T23:30:41.030

我在 VS 2008 中使用 Mercurial 已经有一段时间了，发现[TortoiseHg](http://bitbucket.org/tortoisehg/stable/wiki/Home)和打开的命令提示符的组合可以解决大多数问题。在 Mercurial 之前，我们使用 Microsoft Visual Source Safe (VSS) 与 Visual Studio 集成。即使使用了插件，您仍然必须进入 VSS 来创建项目并进行一些项目管理工作，因此您仍然必须知道如何在 IDE 之外使用源代码控制工具。更改后，我什至想自己为 VS 2008 编写一个 Mercurial 插件。在我能做到这一点之前，我必须让自己熟悉 Mercurial。在此过程中，我发现习惯在 IDE 之外进行源代码控制需要一些时间，但我现在更喜欢命令行和 TortoiseHg 工具而不是 VSS IDE 插件。

但是，似乎有几个适用于 Mercurial 的 Visual Studio 插件：

1.  [视觉HG](http://sharesource.org/project/visualhg/wiki/)
2.  [hgscc](http://www.newsupaplex.pp.ru/hgscc_news_eng.html)

我没有测试过它们，所以我不能就它们的用处给你意见。

从来没有看过 Mercurial 的 Eclipse 插件，我不能说它是否比我使用的命令行方法更好。

# jquery - 使用 JQuery 执行带有 POST 变量的 GET 请求

> ID：1004352
> 
> 赞同：1
> 
> 时间：2009-06-16T23:03:46.107
> 
> 标签：jquery, post

我想从 onclick 事件中调用一个 url 并将其传递给 POST 变量。我不想通过隐藏输入和表单提交来做到这一点。当然，我想使用 jquery 来做到这一点。

必须将 url 加载到弹出窗口中。

问题是，因为我是 jquery 新手，如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T23:09:49.417

看一下[`$.post`](http://docs.jquery.com/Ajax/jQuery.post)功能。这将向您选择的 URL 发送 AJAX 请求，但与常规表单提交不同，它不会重新加载或更改当前页面。

* * *

编辑回复评论：
您可以通过为每个变量动态创建一个带有隐藏输入的表单来伪造它。将表单的目标设置为“_blank”，然后提交它，这应该会在新窗口中打开您的其他页面。

```
$('#myLink').click(function() {
    var $f = $('<form></form>')
        .attr({
            method : 'post',
            target : '_blank',
            action : 'myOtherPage.php'
        })
        .appendTo(document.body)
    ;
    var myHiddenVariables = {
        id : 17,
        name : "Joe Bloggs"
    };
    for (var i in myHiddenVariables) {
        $('<input type="hidden" />')
            .attr({
                name : i,
                value : myHiddenVariables[i]
            })
            .appendTo($f)
        ;
    }
    $f[0].submit();
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T23:12:06.690

以下将使用两个参数将 AJAX 发布到服务器。在回调函数中，它打开一个弹出窗口并使用返回的 html 填充它。

```
 $("#aLink").click(function()
{
    $.post("some_url", {param1:"foo", param2:"bar"}, function(html)
    {
        newWindow= window.open ("","newwindow","menubar=1,resizable=1,width=350,height=250");
        newWindow.document.write(html);
    });

    return false;
}); 
```

# java - 是否有适用于 Google App Engine（Java 语言）的 HTML 模板引擎？

> ID：1004354
> 
> 赞同：2
> 
> 时间：2009-06-16T23:03:51.520
> 
> 标签：java, html, google-app-engine, template-engine, templating

寻找一些简单的东西（比如 PHP 的 Smarty 或 Rails 的 erb），但这将允许在彼此之间嵌套模板。App Engine 是否有任何内置功能，或者我需要研究一些单独的东西（比如 Velocity？）？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T00:24:02.077

如果您需要模板引擎来创建 HTML 页面（或您直接发送给用户的其他内容），我想您可以使用 JSP。

JSP 支持内置于 App Engine 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T23:12:37.320

如果您正在查看 Velocity，您可能还需要考虑[Freemarker](http://freemarker.org/)。它具有比 Apache Velocity 更复杂但也相应更丰富的标记语言。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T23:11:31.597

[Rythm](http://rythmengine.com)是一个快速、功能丰富且对开发人员友好的模板引擎。该站点本身在 GAE 上运行

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-30T16:59:23.393

我的轻量级模板引擎[Chunk Templates](http://www.x5software.com/chunk)将在 Google App Engine 中运行。

块功能包括分支、循环和宏，并且具有`{$tag}`比 Velocity 和 Freemarker 更简单的语法。

大量内置[标签过滤器](http://www.x5software.com/chunk/wiki/Chunk_Tag_Filters)，例如：

```
{% $value|sprintf(%.02f) %}

{% $value|onempty("N/A") %} 
```

# c# - C# 中的 XML 消息侦听器

> ID：1004357
> 
> 赞同：0
> 
> 时间：2009-06-16T23:04:37.243
> 
> 标签：c#, xml

我对 XML 消息有疑问。这是我的情况：我正在编写侦听器，它必须侦听 WebSphere 服务器并获取 XML 消息并解析/过滤并创建输出 XML 文件。

我需要一些帮助才能继续：

我的输入消息如下所示：

```
<content xsi:type=
"ns2:CreateChangeRequest" xmlns:ns2="http://nmd.org/esb/business" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> 
<request>
<enterpriseId>8e08a2d5cff64c53a562ed5898579092</enterpriseId>
<requestedForInfo>
<requestedForEnterpriseId>f8af0af25c86439ea378ed5898579092</requestedForEnterpriseId>
<requestedForClass>Recipient</requestedForClass>
<phenotypeSequenceNumber>1</phenotypeSequenceNumber>
</requestedForInfo>
</request> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T03:00:06.790

这是一个 MQ 描述符，对吧？IBM 提供了 .Net 库来连接 MQ，尽管它们有点难找。[这是下载链接](http://www-01.ibm.com/support/docview.wss?uid=swg24009961&rs=0&cs=utf-8&context=SSFKSJ&dc=D41F5&loc=en_US&lang=en&cc=US)；MQC6。

IBM 也有一些关于集成 MQ 和 .Net 的课程和红皮书 - 试试看[这里](http://www.redbooks.ibm.com/abstracts/SG247012.html?Open)的红皮书和[这里](http://www.ibm.com/developerworks/edu/dm-dw-dm-0308surange-i.html?S_TACT=104AHW11&S_CMP=LIB)的课程。（我记得上课需要注册）

我从来不必使用 C# 来与 MQ 对话。我不得不改用 Java 和 ESQL，但我前段时间研究过红皮书。包括一些示例代码，看起来很简单。查看 MQQueue 类的 Get 方法。

# asp.net - 错误处理程序页面上的递归重定向

> ID：1004358
> 
> 赞同：0
> 
> 时间：2009-06-16T23:05:01.220
> 
> 标签：asp.net

我在我的母版页上使用以下 MSDN 代码来检测浏览器是否接受 cookie：

```
protected void Page_Load(object sender, EventArgs e)
{
    if(!this.IsPostBack) {
        if(Request.QueryString["CookieTest"] == null) {
            Response.Cookies["TestCookie"].Value = "Test";
            Response.Redirect("CookieCheck.aspx.redirect=" + Server.UrlEncode(Request.Url.ToString())));
        }
        else if((string)Request.QueryString["Test"] == "passed") {
            // my stuff...
        }
    }
} 
```

CookieCheck.aspx 包含以下内容：

```
protected void Page_Load(object sender, EventArgs e)
{
    if(Request.Cookies["TestCookie"] == null)
        Response.Redirect(Request.QueryString["redirect"] + "?Test=notPassed", true);
     else
        Response.Redirect(Request.QueryString["redirect"] + "?Test=passed", true);
} 
```

在 web.config 中，我定义了以下内容：

```
<customErrors mode="On" defaultRedirect="Error.aspx" /> 
```

现在 cookie 的识别工作得很好，但我有这个问题：每当页面上发生错误并且我应该被重定向到 Error.aspx （这在整个 cookie 检测之前工作），重定向似乎陷入了无限循环并将越来越多的“?Test=passed”附加到 URL。我应该提到 Errors.aspx 也有相同的母版页，因此也执行 cookie 检查。但是我不知道为什么重定向不会停止。除了将 Errors.aspx 页面排除在母版页之外，还有其他方法可以解决此问题吗？非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T23:24:00.763

如果 CookieCheck.aspx 页面也使用相同的母版页，它将继续递归重定向，请确保 CookieCheck.aspx 未使用相同的 MasterPage。

我宁愿建议不要为此使用 MasterPages，Master Pages by design is for Visual Inheritance 而不是 code Inheritance，如果您希望制作一些特殊类型的页面来检查浏览器使用 cookie 的能力，您可以拥有一个新的基础这些页面的类

```
public abstract class CookieEnabledPage : Page
{
} 
```

并将您的逻辑添加到此类，然后每当您需要使用此行为创建新页面时，您都可以从该基类继承。我认为这是一种更清洁的方式来做你想做的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T23:27:41.333

我猜母版页（或 masterpage-error.aspx 组合）引发了一个异常，该异常触发了对 error.aspx 的重定向，这反过来又导致母版页重新启动其生命周期并引发一个新异常。"?Test=passed" 的连接几乎可以肯定是每次发生错误重定向时重新调用 cookie 测试的副作用。我建议启动调试器并在 Masterpage.aspx.cs 的 Page_Load 处设置断点并逐步执行，直到您被重定向到错误页面（执行的最后一行是引发异常的行）。

# oop - 对象内的对象

> ID：1004359
> 
> 赞同：3
> 
> 时间：2009-06-16T23:05:43.233
> 
> 标签：oop

当一个对象内部有一个相同类型的对象时，它叫什么？

例子：

```
public class Foo{

     public Foo myFoo;

} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-16T23:09:32.023

我认为没有任何具体的名称。尽管此概念用于许多不同的常见编程结构中。例如，当表示图、树或链表时，节点通常具有对它们链接/连接到的其他节点的引用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T23:23:06.693

这意味着这`Foo`是一个“递归数据结构”。这方面的例子是树、图、链表等。没有多少重要的程序不使用至少一些递归结构，例如在任何 SQL 服务器实现中，执行的查询计划将是很常见的以类似的方式定义。作为一个小例子，该`WHERE`子句可能会被转换为`FilterNode`作用于从其他一些`Node`（如表扫描）接收到的数据：

```
public interface Node { }

public class FilterNode implements Node {
    public Node underlyingNode;
    public Condition filterCondition;
} 
```

在许多情况下，整体结构形成了一个有向无环图，这意味着很容易安全地递归地遍历它。但是，如果它有循环，那么您需要小心不要陷入无限递归（这是上面另一个答案幽默地警告的内容）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T23:07:46.833

递归包含.... :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T23:24:19.310

补充一下 Kibbee 所说的，这是一种复合模式

# java - JAR 文件，它们不只是膨胀并减慢 Java 的速度吗？

> ID：1004368
> 
> 赞同：25
> 
> 时间：2009-06-16T23:08:42.510
> 
> 标签：java, spring

好吧，这个问题可能看起来很愚蠢，但我还是要问它。

经过数小时努力让 Spring + BlazeDS 项目启动并运行后，我发现我的项目遇到了问题，因为没有包含 Spring 等的正确依赖项。我的 WEB-INF/lib 中缺少 .jar文件夹，是的，傻我。

过了一会儿，我设法将所有 .jar 文件放到了它们所属的位置，当时它的大小高达 12.5MB，而且有**30**多个！这让我很担心，但它可能并且希望不应该担心。

Java如何操作这些JAR文件，考虑到它是压缩和编译的源代码，它们确实占用了相当多的硬盘空间。因此，它可以在瞬间快速填充大量 RAM。

我的问题是：

例如，当实例化 .jar 中的类时，Java 是否会将整个 .jar 文件加载到内存中？.jar 中永远不会被使用的东西呢？

.jars 是否以某种方式缓存，以优化应用程序性能？

当加载单个 .jar 时，我知道该东西位于内存中并且可用于多个 HTTP 请求（即在服务器实例运行的生命周期内），与 PHP 不同的是，PHP 对象是随每个请求动态创建的，这是假设正确吗？

在使用 Spring 时，我在想，我必须包含所有那些繁琐的 .jar，难道我只使用本机 Java 会更好吗？至少可以说像 Hibernate 这样的 ORM 解决方案？

到目前为止，Spring 只是花费了额外的时间来配置、额外的硬盘空间、额外的内存、cpu 消耗，所以我担心这个框架会花费太多的应用程序性能来获得例如用我的 BlazeDS 服务器实现的 IoC。

仍然需要 ORM，一个单元测试框架和零碎的东西。快速且不负责任地轻松地膨胀一个项目是非常容易的。

我在哪里画线？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-06-16T23:15:32.307

> “例如，当实例化 .jar 中的一个类时，Java 是否会将整个 .jar 文件加载到内存中？那么 .jar 中从未使用过的东西呢？”

不，类加载器会根据需要加载每个 .class 文件。

> “.jars 是否以某种方式缓存，以优化应用程序性能？”

JAR 就像 DLL（除了有关链接与类加载的详细信息）：它们只是 .class 文件的压缩库。它们没有被缓存：.class 文件根据需要加载到 perm 空间中。

> “当加载单个 .jar 时，我知道该东西位于内存中，并且可用于多个 HTTP 请求（即在服务器实例运行的生命周期内），与 PHP 不同的是，PHP 对象是随每个请求动态创建的，是这个假设正确吗？”

当您的应用服务器将 .class 加载到 perm 空间时，只要服务器启动并运行，它就可用。

> “当使用 Spring 时，我在想，我必须包含所有那些繁琐的 .jars，难道我只使用原生 Java 会更好吗？至少可以说像 Hibernate 这样的 ORM 解决方案？”

如果你认为使用 Spring 给你带来了一些东西，那就不是了。如果您认为成本/收益分析对您不利，请务必不要使用 Spring。但是，如果依赖项阻碍了您，这听起来不像您在进行良好的分析。

> “到目前为止，Spring 只是花费了额外的时间来配置、额外的硬盘空间、额外的内存、cpu 消耗，所以我担心这个框架会花费太多的应用程序性能，例如，用我的 BlazeDS 服务器实现 IoC 。”

您不知道使用 Spring 的性能损失是多少。如果您认为这是一个问题，请测量它。我敢打赌，您的应用程序代码或数据库架构将是最大的问题。

> “仍然需要 ORM，一个单元测试框架和零零碎碎的零零碎碎的东西。快速而不负责任地轻松地膨胀一个项目是如此容易。”

为什么不负责任？

> “我在哪里画线？”

无论如何，写你自己的。从头开始做这一切。您将更好地了解框架为您购买的内容以及完成后的实际成本。

我要补充一点：Spring 的人们编写了一些最好的代码。比你我写的任何东西都要好。您选择任何框架，因为您相信使用经过严格设计、拥有更广泛的受众、经过更彻底测试的代码会让您受益匪浅。并且几乎在所有方面都比你自己写的要好。我不会让（不可否认的）大量依赖项阻止我使用它。当我在应用服务器上部署并为该 JVM 分配 256 MB 的 RAM 时，我当然不在乎 perm 空间是否占用了总数的 10%——直到我测量到这是一个问题。

我认为真正发生的事情是您宁愿编写 PHP 而不是 Java。这是一个公平的想法，因为很多人认为使用动态语言可以提供优于 Java 的价值。大多数网站仍然是用 PHP 编写的，所以你的怀疑是有道理的。

我建议使用和不使用 Spring 并使用 PHP 对一个或两个用例进行原型设计。在那之后，您将更好地了解什么对您有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T23:11:18.993

类加载器应该只加载它需要的类并且它们保持内存驻留。不用担心 12 MB。内存很便宜。您创建的对象（在大型应用程序中）将使用比加载的类更多的内存。

所以简而言之，不要担心。:)

IBM DeveloperWorks 上有一篇不错的文章，标题为“揭秘类加载问题，第 1 部分：类加载和调试工具简介”

附加点——说到成本，Developer Time 的成本远高于硬件成本，因此，如果 Spring/Hibernate/WhateverTool 帮助开发人员更快、更轻松地构建应用程序，那么无论 RAM 是什么成本都是值得的用过的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-01T19:32:22.480

如果您在依赖管理方面遇到问题，[Maven](http://maven.apache.org/) 或[Ivy 之](http://ant.apache.org/ivy/)类的工具可能会有所帮助，尽管它们有自己的学习曲线。它们都允许您指定直接依赖关系，并让工具计算和解决传递依赖关系。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-13T04:13:41.660

尽管类加载器按需加载类，但 JAR 元数据可能会由类加载器加载，因为它应该包含有关作为 JAR 一部分的完全分类的类名称的信息（次要空间要求）。当需要类加载器时，可以从这些信息中快速加载类。

添加更多 JAR 可能会占用几 KB(<) 的额外空间（JAR 信息），但实际上不会增加​​您的 PermGenSpace，除非不需要该类（直接或间接需要）

因此，只要您不引用/加载所有不必要的类（通过使用：直接或间接包括类中的静态代码执行），您就可以安全地添加其他库。

PermGenSpace 也与堆内存隔离（就物理内存分配而言），尽管它们一起工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T23:22:57.580

对于其中一些问题，您最好查看`java.util.jar`. JAR 文件被视为一种 ZIP 文件（这很有意义，因为 JAR 文件基本上是带有清单文件的 ZIP 文件），因此不会一次加载整个文件。

# css - 将垂直可调整大小的 Div 推到包装器的底部。如何？

> ID：1004369
> 
> 赞同：1
> 
> 时间：2009-06-16T23:08:54.070
> 
> 标签：css, html

首先，大家好。这个问题让我发疯，所以我希望有一个简单的解决方案

这是[我最初想要的图像](http://img195.imageshack.us/img195/3276/divcolumns.png)。

但我不想使用 hacks 让 Box 1 和 (Box 2+Box 3) 相互扩展。所以我将只在包装上使用背景颜色，因此它们具有不同的高度并不明显。

这就是我现在所拥有的：

**CSS**

```
#wrapper {
    background:         #000;
    width:              50%; 
    float:              left;
}

#box1 {
    background:         #FF0012;
    width:              65%;
    float:              left;
}

#box2 {
    background:         #141; 
    width:              35%;
    margin-left:        65%;    
}

#box3 {
    background:#AA1232;
    width:              35%;
    margin-left:        65%;
} 
```

**HTML**

```
<body>

 <div id="wrapper">

  <div id="box1">

  </div>

  <div id="box2">

  </div>

  <div id="box3">

  </div>

 </div>

</body> 
```

如果您想知道为什么我不在`float: right;`Box 2 和 3 上使用它，因为如果 Box 1 低于 Box 2，那么 Box 3 将漂浮在 Box 1 下方而不是 Box 2 下方。

问题：1\. 将 Box 3 固定到包装器的底部 2\. 当在 Box 3 和 Box 2 中插入行时，它们不应溢出 - 而是扩展包装器高度（就像我发布的代码一样）

如果我`position: absolute; bottom: 0;`在 Box 3 上使用，那么当插入行并且 Box 3 太高时，它将溢出 Box 2。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T23:32:05.487

我知道为什么它会让你发疯——你正试图通过非桌面方式解决桌面问题。为什么？

我强迫自己认识到表格的功能：当我希望独立的内容片段共享一个共同的垂直和水平边缘时，这通常意味着我想要一个表格。

编辑：要使用表格实现这一点，您需要 1）使用 rowspan 使框 1 跨越两行和 2）垂直对齐框 3 的内容以确保它始终位于底部。

[例如，请参阅此处](http://www.yourhtmlsource.com/tables/advancedtables.html#ROWSPAN)说明行跨度的 HTML 。这几乎是您想要的，只需去掉表格边框并将 valign="bottom" 添加到第三个单元格。

# wcf - WCF 数据协定和参考实体数据？

> ID：1004378
> 
> 赞同：12
> 
> 时间：2009-06-16T23:11:22.223
> 
> 标签：wcf, design-patterns, soa, datacontract

征求有关“最佳”模式的反馈/选项/评论，以用于我的服务中的参考数据。

参考数据是什么意思？

让我们以罗斯文为例。订单与数据库中的客户相关。当我实现我的订单服务时，在某些情况下，我希望引用来自订单的“完整”客户，而在其他情况下，我只想引用客户（例如键/值对）。

例如，如果我正在执行 GetAllOrders()，我不想返回一个完全填写的订单，我想返回一个订单的轻量级版本，每个订单的客户只有参考数据。但是，如果我执行 GetOrder() 方法，我可能想要填写客户详细信息，因为此方法的使用者可能需要它。在其他情况下，我可能想要求在某些方法调用期间填写客户详细信息，但留给其他人。

这是我想出的：

```
[DataContract]
public OrderDTO
{
    [DataMember(Required)]
    public CustomerDTO;

    //etc..
}

[DataContract]
public CustomerDTO
{
    [DataMember(Required)]
    public ReferenceInfo ReferenceInfo;

    [DataMember(Optional)]
    public CustomerInfo CustomerInfo;
}

[DataContract]
public ReferenceInfo
{
    [DataMember(Required)]
    public string Key;

    [DataMember(Required)]
    public string Value;
}

[DataContract]
public CustomerInfo 
{
    [DataMember(Required)]
    public string CustomerID;

    [DataMember(Required)]
    public string Name;

    //etc....
} 
```

这里的想法是，由于在 CustomerDTO 中始终需要 ReferenceInfo（这是一个通用的键/值对），因此我将始终拥有 ReferenceInfo。它为我提供了足够的信息，以便稍后在需要时获取客户详细信息。让 CustomerDTO 需要 ReferenceInfo 的缺点是，当我获得完整的 CustomerDTO（即填写了 CustomerInfo）时，它可能有点过头了，但至少我可以保证参考信息。

是否有一些其他的模式或框架可以用来使这个场景/实现“更干净”？

我问的原因是，虽然我们可以简单地说在 Northwind 中总是返回一个完整的 CustomerDTO，但这在简单的 Northwind 情况下可能工作得很好。就我而言，我有一个具有 25-50 个字段的对象，这些字段是引用/查找类型的数据。在不同的情况下，有些比其他的加载更重要，但我希望这些引用类型的定义尽可能少（这样我就不会陷入“DTO 维护地狱”）。

意见？反馈？注释？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-18T11:37:45.350

亚马逊产品广告 API Web 服务就是您遇到的相同问题的一个很好的例子。

他们使用不同的 DTO 为调用者提供或多或少的详细信息，具体取决于他们的情况。例如有[小反应组](http://docs.amazonwebservices.com/AWSECommerceService/2009-07-01/DG/index.html?RG_Small.html)、[大反应组](http://docs.amazonwebservices.com/AWSECommerceService/2009-07-01/DG/index.html?RG_Large.html)和[中反应组](http://docs.amazonwebservices.com/AWSECommerceService/2009-07-01/DG/index.html?RG_Medium.html)。

如果您说您不想要一个健谈的界面，那么拥有不同的 DTO 是一种很好的技术。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-09T19:48:07.393

我们在项目上处于相同的决策点。截至目前，我们决定创建三个级别的 DTO 来处理事物：SimpleThing、ComplexThing 和 FullThing。不过，我们不知道它会如何为我们工作，所以这还不是一个基于现实的答案。

我想知道的一件事是，我们是否可以了解到我们的服务是在“错误”级别设计的。例如，是否存在我们应该将 FullThing 拆开而只传递 SimpleThing 的实例？如果我们这样做，这是否意味着我们不恰当地将某些业务逻辑置于过高的级别？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-09T21:07:36.577

我们在对象关系映射中也遇到过这个问题。在某些情况下，我们想要完整的对象，而在其他情况下，我们想要引用它。

困难在于，通过将序列化烘焙到类本身中，数据契约模式强化了这样一种观念，即只有*一种正确的方法*来序列化一个对象。但是在很多情况下，您可能希望部分序列化一个类和/或其子对象。

这通常意味着每个类必须有多个 DTO。例如，FullCustomerDTO 和 CustomerReferenceDTO。然后，您必须创建将不同 DTO 映射回客户域对象的方法。

可以想象，这是一项繁重的工作，其中大部分工作非常乏味。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-08T18:45:18.330

我已经决定反对我将要采取的方法。我认为我最初的许多担忧是由于缺乏需求造成的。我有点预料会是这种情况，但很想知道其他人可能如何解决这个问题，即确定何时加载某些数据以及何时不加载。

我正在展平我的数据合同以包含最常用的参考数据元素字段。这应该适用于大多数消费者。如果提供的数据对于给定的消费者来说不够用，他们可以选择查询单独的服务以提取特定参考实体（例如货币、州等）的完整详细信息。对于实际上基本上是键/值对的简单查找，我们将使用通用键/值对数据协定来处理它们。我什至可以将 KnownType 属性用于我更专业的键/值对。

```
[DataContract]
public OrderDTO
{
    [DataMember(Required)]
    public CustomerDTO Customer;

    //in this case, I think consumers will need currency data, 
    //so I pass back a full currency item
    [DataMember(Required)]
    public Currency Currency; 

    //in this case, I think consumers are not likely to need full StateRegion data, 
    //so I pass back a "reference" to it
    //User's can call a separate service method to get full details if needed, or 
    [DataMember(Required)]
    public KeyValuePair ShipToStateRegion;

    //etc..
}

[DataContract]
[KnownType(Currency)]
public KeyValuePair
{
    [DataMember(Required)]
    public string Key;

    [DataMember(Required)]
    public string Value;

    //enum consisting of all possible reference types, 
    //such as "Currency", "StateRegion", "Country", etc.
    [DataMember(Required)]
    public ReferenceType ReferenceType; 
}

[DataContract]
public Currency : KeyValuePair
{
    [DataMember(Required)]
    public decimal ExchangeRate;

    [DataMember(Required)]
    public DateTime ExchangeRateAsOfDate;
}

[DataContract]
public CustomerDTO 
{
    [DataMember(Required)]
    public string CustomerID;

    [DataMember(Required)]
    public string Name;

    //etc....
} 
```

想法？意见？注释？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T23:29:15.120

对我来说，这似乎是一个复杂的解决方案。为什么不在 OrderDTO 类中有一个客户 ID 字段，然后让应用程序在运行时决定它是否需要客户数据。由于它具有客户 ID，因此它可以在决定时将数据拉下来。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-25T04:19:04.520

另一种可能性是将对象视为财产包。在查询时指定您想要的属性，并准确返回您需要的属性。

更改属性以在“短”版本中显示然后不需要多次往返，您可以一次获取一组的所有属性（避免繁琐的界面），并且您不必修改数据或如果您决定“短”版本需要不同的属性，则操作合同。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-22T19:47:08.533

我通常在复杂的 Web 服务（即发送/接收实体的 Web 服务）中构建延迟加载。如果一个人有一个父亲属性（也是一个人），我只发送一个父亲的标识符而不是嵌套对象，然后我只确保我的网络服务有一个可以接受一个标识符并用相应的人实体响应的操作. 然后，如果客户端想要使用父亲属性，它可以回调 Web 服务。

我还对此进行了扩展，以便可以进行批处理。如果一个操作发回 5 个 Person，那么如果在这些 Person 中的任何一个上访问了 Father 属性，那么将向所有 5 个 Father 及其标识符发出请求。这有助于减少 Web 服务的繁琐。

# java - 如何在 jsf 渲染属性中指定来自 2 个不同 bean 的条件？

> ID：1004382
> 
> 赞同：9
> 
> 时间：2009-06-16T23:16:26.470
> 
> 标签：java, jsf, rendered-attribute

我想按照以下方式做一些事情，但是当我像这样使用它时，我收到一个解析错误，告诉我一个实体需要直接跟随“&”字符：

```
<ice:selectManyCheckbox
rendered="#{!bean1.condition1 && bean2.condition2}"
value="#{bean1.selected}">
<f:selectItems value="#{bean2.items}" />
</ice:selectManyCheckbox> 
```

如何渲染以检查 2 个不同 bean 的条件？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-16T23:26:20.337

改用“和”：

```
<ice:selectManyCheckbox rendered="#{!bean1.condition1 and bean2.condition2}" value="#{bean1.selected}"> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T07:00:04.667

karim79 是对的，您可以使用`and`运算符。

除此之外，您可以查看此[页面](http://java.sun.com/j2ee/1.4/docs/tutorial/doc/JSPIntro7.html)，该页面通过几个示例解释了表达式语言（EL）...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T05:00:49.037

也许您正在使用 facelets，它假定编译后的每个 jsp 页面都是一个 xml 文件。而且您知道在 xml 文件中，您必须在`&`符号之后提供一个 xml 实体名称。所以为了逃避这种情况，使用`&amp;`代替`&`.

# sql-server - 编码和部署asp.net MVC或stackoverflow.com，ASP.NET MVC VS struts，spring的成本是多少

> ID：1004409
> 
> 赞同：0
> 
> 时间：2009-06-16T23:27:30.660
> 
> 标签：sql-server, visual-studio

我想知道使用 asp.net mvc 使用和部署像 stackoverflow 这样的网站的工具的成本是多少。

我刚刚检查了一下，似乎视觉工作室专业版突然便宜了很多，事实上几乎好得令人难以置信。

但如果他们使用 SQL 企业版，企业版的成本似乎在 10,000 英镑左右？

或者 2008 年的情况发生了巨大变化，因此您实际上可以为生产环境部署类似工作组版本的东西，并利用播客中提到的 16GB 内存？

我在即将开始学习 asp.net MVC 时提出这个问题，但我可以轻松地将精力投入到使用 Java 中，并且不用担心使用不太可能找到具有前瞻性的技术Web 应用程序由于部署成本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T23:47:45.440

您可以用很少的自付费用开发一个 ASP.NET MVC 站点：

*   ASP.NET MVC 1.0（免费下载）
*   带有 Service Pack 1 的 SQL Server Express 2008（免费下载）
*   带有 SP 1 的 Visual Web Developer 2008 Express（免费下载）

我可以看到您唯一的开销是托管网站的成本。寻找具有 ASP.NET MVC 1.0 和 SQL Server 2008 的托管服务提供商。

下载[Microsoft Web 平台安装程序](http://www.microsoft.com/Web/downloads/platform.aspx) 以查看 Microsoft 提供的免费软件，以帮助开发 Web 应用程序。

此外，如果您开发用于商业销售的软件，您可以注册 Mircosoft [BizSpark](http://www.microsoft.com/BizSpark/)计划。这是一个旨在鼓励初创公司使用 Mircosoft 开发堆栈的程序。

**更新**

微软最近刚刚发布了[WebsiteSpark](http://www.microsoft.com/web/websitespark/)，它更适合于启动销售软件的公司的网络开发商店。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T23:35:16.607

在工具方面，成本计算有点棘手，它始终取决于您购买的产品以及您是否能找到优惠折扣。另一方面，如果您是业余开发者，开发成本几乎为零，Microsoft Visual Web Developer Express 版 + SQL Server Express 版都完全免费下载和开发，当涉及到商业软件时如上所述，它变得有点棘手。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T23:52:01.360

对于“业余爱好者”级别的工作，几乎所有工具链都有免费版本的工具链。

对于“专业”级的东西，显然东西开始变得更加昂贵。不过，我认为，在您自己从头开始构建系统（购买和运行自己的服务器等）的情况下，一段时间后成本或多或少会趋于平稳。

就个人而言，我认为最大的成本是在人类知识方面——即找到真正知道如何使用系统的人。

所以，我会说 ASP MVC 和 Java 同样便宜，假设您有一个知道如何使用它的编程人员。（或者，更重要的是，如果你不这样做，同样昂贵。）

如果您是从零开始，没有现有的“知识库”？我不认为这很重要。真的。当然，事后诸葛亮总是 20 到 20 年，五年后我们都会意识到我们今天应该交付什么，但目前我不确定成本是否是决策的有用指标。

换句话说，选择听起来更酷的那个。我的意思是，至少你会对这项技术感兴趣而不是怨恨。（相信我，这有*很长*的路要走。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-29T00:06:17.823

如果 SQL Server 中不需要特定功能，您同样可以使用 PostgreSql。

# ruby-on-rails - 与单表继承关联的 HABTM 关联

> ID：1004412
> 
> 赞同：9
> 
> 时间：2009-06-16T23:28:45.230
> 
> 标签：ruby-on-rails, ruby, has-and-belongs-to-many, sti

我有一个产品模型，它有很多部分，一个部分可以属于许多产品。

截面模型具有特征、标准和选项的子类。

我的模型是：

```
class Product < ActiveRecord::Base  
 has_and_belongs_to_many :categories  
 has_and_belongs_to_many :sections    
end

class Section < ActiveRecord::Base  
 has_and_belongs_to_many :products
end

class Feature < Section
end 

class Standard < Section
end 

class Option < Section
end 
```

在我的产品控制器中，我可以这样做：

```
@product.sections.build 
```

我希望能够像这样访问子类：

```
@product.features.build

@product.standards.build

@product.options.build 
```

但它只是“未定义的方法'功能'”等错误。

请问谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-18T20:49:33.577

假设您有一个名为“products_sections”的 has_and_belongs_to_many 连接表，您需要的是 Prodcut 模型中的这些附加关联：

```
class Product < ActiveRecord::Base
 has_and_belongs_to_many :sections
 has_and_belongs_to_many :features, association_foreign_key: 'section_id', join_table: 'products_sections'
 has_and_belongs_to_many :standards, association_foreign_key: 'section_id', join_table: 'products_sections'
 has_and_belongs_to_many :options, association_foreign_key: 'section_id', join_table: 'products_sections'
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T13:35:49.197

产品没有这些方法，因为它们从未被定义。您需要在产品类中定义关系以获取功能/标准/选项方法

[http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)

会让你更好地理解定义关系会给你带来什么

# sql-server - 如何确保 SQL Server 复制正在运行？

> ID：1004416
> 
> 赞同：1
> 
> 时间：2009-06-16T23:29:55.133
> 
> 标签：sql-server, configuration, replication

我有两个地理上分开的 SQL Server 2005 实例。使用事务复制将重要的数据库从主位置复制到辅助位置。

我正在寻找一种可以监视此复制并在失败时立即收到警报的方法。

过去我们曾遇到过两个实例之间的网络连接中断一段时间的情况。由于无法进行复制并且我们不知道，因此事务日志爆出并填满了磁盘，从而导致主数据库也中断。

前段时间我的谷歌搜索导致我们监控`MSrepl_errors`表格并在有任何条目时发出警报，但这根本不起作用。上次复制失败（昨晚因此问题），错误仅在重新启动时命中该表。

**还有其他人监控复制吗？你是怎么做的？**

* * *

只是一点点额外的信息：

似乎昨晚的问题是日志读取器代理死了并且没有再次启动。我相信这个代理负责读取事务日志并将记录放入分发数据库，​​以便可以在辅助站点上复制它们。

由于此代理在 SQL Server 中运行，我们不能简单地确保 a`process`在 Windows 中运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T23:55:58.030

We have emails sent to us for Merge Replication failures. I have not used Transactional Replication but I imagine you can set up similar alerts.

The easiest way is to set it up through Replication Monitor.

Go to Replication Monitor and select a particular publication. Then select the Warnings and Agents tab and then configure the particular alert you want to use. In our case it is Replication: Agent Failure.

For this alert, we have the Response set up to Execute a Job that sends an email. The job can also do some work to include details of what failed, etc.

This works well enough for alerting us to the problem so that we can fix it right away.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T00:14:42.283

您可以定期检查是否正在发生数据更改，尽管这可能很复杂，具体取决于您的应用程序。

如果您有某种形式的定期更新的审计训练表（即我们的主要产品有一个基础审计表，其中列出了导致数据被更新或删除的*所有*操作），那么您可以在两台服务器上查询该表并确保你回来的结果是一样的。就像是：

```
SELECT CHECKSUM_AGG(*) 
FROM   audit_base 
WHERE  action_timestamp BETWEEN <time1> AND BETWEEN <time2> 
```

其中 和 是舍入值，以允许在联系数据库时出现不同的延迟。例如，如果您在 10 点后检查，您可能会检查从最后一个小时开始到本小时开始的项目。您现在有两个小值，您可以将它们传输到某处并进行比较。如果它们不同，则很可能在复制过程中出现问题 - 检查/比较会向您发送邮件和 SMS 的任何过程，以便您知道检查和解决任何需要注意的问题。

通过使用 SELECT CHECKSUM_AGG(*) 每个表的数据量非常小，因此检查的带宽使用将是微不足道的。您只需要确保您的检查在适用于服务器的负载中不会太昂贵，并且您不检查可能是开放复制事务的一部分的数据，因此可能会在那时有所不同（因此检查在我的示例中，审计跟踪是几分钟前的时间而不是现在），否则你会收到太多的误报。

根据您的数据库结构，以上可能不切实际。对于在检查时间范围内不是仅插入（没有更新或删除）的表（如上面的审计跟踪），找出可以安全比较的内容同时避免误报可能既复杂又昂贵，如果实际上并非不可能可靠地做到。

如果您还没有一个滚动插入表，则可以通过定期向其中添加一行的小表（仅包含一个索引时间戳列）来制造一个滚动插入表 - 此数据除了存在之外没有其他用途，因此您可以检查表的更新正在被复制。您可以删除比您的检查窗口更早的数据，因此表格不应变大。只测试一个表并不能证明所有其他表都在复制（或*任何*其他表），但是在这个表中发现错误将是一个很好的“canery”检查（如果这个表没有在副本，那么其他的可能都不是）。

这种检查具有独立于复制过程的优点 - 您无需等待复制过程在日志中记录异常，而是主动测试一些实际数据。

# windows-services - Wix：卸载时停止 Windows 服务

> ID：1004422
> 
> 赞同：7
> 
> 时间：2009-06-16T23:33:47.577
> 
> 标签：windows-services, wix, wix3

当我卸载我的服务时，我得到一个错误，它说我必须在卸载之前停止这样的服务。这是不令人满意的 - 卸载程序应该自动停止它。

几个月前我发现了一个博客或新闻组发布并让它正常工作，但现在它已经停止为我工作了。而且我没有帖子的链接...也许其他人知道它在哪里？:) 我想我改变了一些微妙的东西，它停止了工作。我发现 Wix 非常难以排除故障。

我正在使用以下包含从注册表中获取属性 X_WIN_SERVICE_NAME（对不起，我不知道如何避免 _ 在这里转义）。安装无关紧要，因为在这种情况下，我使用输入文件明确设置它。此包含在我的 wxs 文件中的任何组件之前使用。

```
<Include xmlns="http://schemas.microsoft.com/wix/2006/wi">

<?ifndef SetupXWinServiceRegistryProperties ?>
<?define SetupXWinServiceRegistryProperties ?>

<?define XWinServiceRegistryKey='Software\X\Y'?>

<Property Id="X_WIN_SERVICE_NAME">
  <RegistrySearch Id="XWinServiceNameSearch"
                    Root="HKLM"
                    Key="$(var.XWinServiceRegistryKey)"
                    Name="ServiceName"
                    Type="raw"/>
</Property>

<?endif?>
</Include> 
```

以下包含组件用于在安装时保存注册表值：

```
<Include xmlns="http://schemas.microsoft.com/wix/2006/wi">

<?ifndef WriteXWinServiceRegistryProperties ?>
<?define WriteXWinServiceRegistryProperties ?>

<Component Id="CompWriteXWinServiceRegistryProps"
  Guid="some guid">

<!-- Write properties to the registry. Then they will be 
       accessable during uninstall. -->

<RegistryValue Root="HKLM"
   Key="$(var.XWinServiceRegistryKey)"
   Name="ServiceName"
   Type="string"
   Value="[X_WIN_SERVICE_NAME]"
   Action="write" />

</Component>

<?endif?>

</Include> 
```

安装后我检查了我的系统，并且注册表值已正确写入那里。我的组件中设置服务的部分如下所示：

```
 <ServiceInstall Id="ServiceInstallXWinService"
                          Name="[X_WIN_SERVICE_NAME]"
                          Start="auto"
                          DisplayName="xxx"
                          Description="yyy"
                          Account="[X_WIN_SERVICE_USER]"
                          Password="[X_WIN_SERVICE_PASSWORD]"
                          Type="ownProcess"
                          ErrorControl="normal"
                          Vital="yes" />

          <ServiceControl Id="ServiceInstallXWinService" 
                          Name="[X_WIN_SERVICE_NAME]"
                          Stop="both"
                          Remove="uninstall"
                          Wait="yes" /> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T16:48:55.747

您确定 X_WIN_SERVICE_NAME 属性在卸载时设置为正确的值。使用详细日志文件确保搜索正确设置了值。一切看起来都很好（虽然我不知道为什么你把所有东西都放在包含文件中而不是只使用片段）。

# database - Google 的 Fusion Tables 真的是“范式转变”吗？

> ID：1004423
> 
> 赞同：2
> 
> 时间：2009-06-16T23:34:16.187
> 
> 标签：database, google-fusion-tables

[男孩，关于Google 的 Fusion Tables](http://tables.googlelabs.com/Home)的发布有很多炒作。

协作编辑看起来很棒，并且可能与 Google Wave 很好地交互。可视化似乎主要体现在它的易用性上。聚合多个不同的数据源也是一个非常好的和及时的想法。

不过，有多少炒作是有道理的？我想知道是否有人对这个最新的 Labs 版本的影响有任何想法，具体来说，是否对其他数据库/数据聚合系统有影响（我听说甲骨文“正在颤抖”，这可能吗？）。是的，我了解数据库结构的差异和好处，但**它会从根本上改变我们目前正在做的任何事情**（尤其是在企业级别）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T23:53:12.763

为什么每个人似乎都认为新技术是老的、经过验证的技术的丧钟？

对于 RDBMS 难以完成的任务，有创新的新解决方案真是太好了。但我质疑这些新解决方案是否更适合 RDBMS 非常适合的任务。

这里的神话是[零和游戏](http://en.wikipedia.org/wiki/Zero-sum)。我们不需要仅仅因为发明了一些新东西就放弃了有效的技术。让我们为奇异的任务使用新技术，但当这是最合适的解决方案时，让我们使用 RDBMS。

请记住，电子表格也仍然存在，它们非常有用——事实上，对于某些类型的工作来说，它们是必不可少的。

PS：这是我在博客文章“ [Google Fusion Tables…Threatening Databases?](http://scaledb.com/component/option,com_wordpress/Itemid,146/cpage,1/p,82/#comment-32) ”中发表的评论。

# unit-testing - 是否有用于使用 PowerShell 脚本测试 PowerShell 的单元测试框架？

> ID：1004424
> 
> 赞同：16
> 
> 时间：2009-06-16T23:34:39.133
> 
> 标签：unit-testing, powershell

我正在寻找一个 xUnit 类型的单元测试框架，它可以让我使用 PowerShell 脚本测试 PowerShell 函数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T04:49:45.750

好吧，只是为了完整性：实际上有[PSUnit](http://code.google.com/p/psunit/)。似乎不是很成熟，尽管我看到自它开始以来只有两次活动高峰，而且没有可言的文档。

但正如我从[cuTest](http://cutest.sourceforge.net/)中了解到的，单元测试是适合一个非常小的空间的东西（至少在这种情况下对于 C 来说），所以有一些可行的东西可能不需要太多的努力。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-16T23:44:01.003

While not an actual framework a la xUnit, Lee Holmes did write [an article about how to unit test PowerShell using PowerShell scripts](http://www.leeholmes.com/blog/2005/09/05/unit-testing-in-powershell-a-link-parser/).

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-29T06:57:13.567

我还在 Codeplex 上找到了 PSUnit。[PSUnit PowerShell 单元测试框架](http://www.codeplex.com/psunit)

有一些很酷的屏幕截图，预计在今年 8 月发布。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-05T16:46:20.930

[从Pester](https://github.com/pester/Pester)的项目页面：

> Pester 提供了一个框架，用于运行单元测试以从 PowerShell 中执行和验证 PowerShell 命令。

# mysql - 在 MySQL 中使用多余的聚合列插入 SELECT

> ID：1004430
> 
> 赞同：2
> 
> 时间：2009-06-16T23:39:09.657
> 
> 标签：mysql

我想做一个插入选择，其中选择语句具有聚合列以供“HAVING”子句使用，但我实际上并不希望插入这些列。一个简单的例子：

```
INSERT INTO table1 ( a ) 
SELECT  a, MAX (b) AS maxb FROM table2
GROUP BY a
HAVING maxb = 1 
```

当然，这是行不通的，因为 INSERT 和 SELECT 中的列数不同。有没有简单的方法来完成这项工作？我希望我可以在 INSERT 字段列表中定义某种空列或其他东西。我希望避免在我的 SELECT 语句中使用子查询，尽管如果有必要我可以这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T23:42:00.180

```
INSERT INTO table1 ( a ) 
SELECT a FROM (SELECT  a, MAX (b) AS maxb FROM table2
GROUP BY a
HAVING maxb = 1) t 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T23:44:08.693

您可以像这样重写查询

```
INSERT INTO table1 ( a ) 
SELECT  a  FROM table2
GROUP BY a
HAVING  MAX (b) = 1 
```

# com - CLR \ CLI Com Object Out of process Server

> ID：1004431
> 
> 赞同：1
> 
> 时间：2009-06-16T23:39:36.470
> 
> 标签：com, clr, c++-cli

如何将用托管 C++ 编写的 COM 对象注册为 SingleUse？Regasm 似乎没有这个选项。我猜它可能就像在 AssemblyInfo.cpp 中定义一个属性一样简单，但我找不到它。

我编写了一个 VB6 ActiveX EXE，它可以按我的意愿工作——即每个对接口的请求都会创建一个新的正在运行的服务器。

我必须求助于将我的托管 C++ COM 包装在 VB6 中吗？必须有一个更简单的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-24T01:20:37.747

看起来服务组件是解决我问题的关键。

[http://oreilly.com/catalog/comdotnetsvs/chapter/ch10.html](http://oreilly.com/catalog/comdotnetsvs/chapter/ch10.html)

一旦我从 System.EnterpriseServices 命名空间中的 ServicedComponent 派生，在 dll 上执行 regsvcs，然后将 dcomcnfg 中的池更改为大于一 - 这一切都有效。另一个问题是使用 /clr:pure 编译托管 C++ 组件，而不仅仅是 /clr。我还没有完成这个项目，但是我在路上构建的示例项目表明它应该以这种方式工作。我想我会将我的托管 C++ 解决方案包装在 C# 程序集中...

现在我几乎已经完成了该项目的另一件事……您需要在服务器操作系统上才能使池工作。

感谢您的指导...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T02:09:36.747

如何使用 Visual C++ 在 MFC 中使用 OLE 对象的单个或多个实例

[http://support.microsoft.com/kb/141154](http://support.microsoft.com/kb/141154)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T14:35:33.443

这可能会给你一些线索：

将托管控件用作 ActiveX 控件
[http://blogs.msdn.com/andreww/archive/2008/11/24/using-managed-controls-as-activex-controls.aspx](http://blogs.msdn.com/andreww/archive/2008/11/24/using-managed-controls-as-activex-controls.aspx)

# python - Know any creative ways to interface Python with Tcl?

> ID：1004434
> 
> 赞同：18
> 
> 时间：2009-06-16T23:40:11.947
> 
> 标签：python, tcl

Here's the situation. The company I work for has quite a bit of existing Tcl code, but some of them want to start using python. It would nice to be able to reuse some of the existing Tcl code, because that's money already spent. Besides, some of the test equipment only has Tcl API's.

So, one of the ways I thought of was using the subprocess module to call into some Tcl scripts.

*   Is subprocess my best bet?
*   Has anyone used this fairly new piece of code: [Plumage](http://code.google.com/p/plumage/)? If so what is your experience (not just for Tk)?
*   Any other possible ways that I have not considered?

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-17T00:10:03.320

我希望你为此做好准备。标准 Python

```
import Tkinter
tclsh = Tkinter.Tcl()
tclsh.eval("""
    proc unknown args {puts "Hello World!"}
    }"!dlroW olleH" stup{ sgra nwonknu corp
""") 
```

*在 Re 中编辑评论*：Python 的 tcl 解释器不知道其他已安装的 tcl 组件。您可以通过以通常的方式向实际使用的 tcl python 添加扩展来处理这个问题。这是一个包含一些详细信息的链接

*   [Tkinter 如何利用 Tcl/Tk 扩展](http://wiki.python.org/moin/How%20Tkinter%20can%20exploit%20Tcl/Tk%20extensions)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T23:55:02.383

This can be done.

[http://wiki.tcl.tk/13312](http://wiki.tcl.tk/13312)

Specificly look at the typcl extension.

> Typcl is a bit weird... It's a an extension to use Tcl *from* Python. It doesn't really require CriTcl and could have been done in standard C.
> 
> This code demonstrates using Tcl as shared library, and hooking into it at run time (Tcl's stubs architecture makes this delightfully simple). Furthermore, Typcl avoids string conversions where possible (both ways).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T23:50:04.237

I've not used it myself, but SWIG might help you out:

[http://www.swig.org/Doc1.1/HTML/Tcl.html](http://www.swig.org/Doc1.1/HTML/Tcl.html)

# windows - Unix permissions from Windows

> ID：1004435
> 
> 赞同：2
> 
> 时间：2009-06-16T23:40:40.883
> 
> 标签：windows, linux, unix, permissions

I have a D-Link DNS-323 NAS, running some sort of Linux as its OS. I map a volume as a share in Windows Vista (Ultimate SP2). There are some directories and files on that share that I cannot change/delete - no matter what I try. Trying all of Windows security/permissions dialogs don't work, as the files owner is "Unix/root" and all other Windows users have read-only permissions.

I managed to ssh into the OS and verified that these files belong to 'root' - the user under which I log in, and all the other files (the ones I can change) belong to 'nobody'.

All fine and well, while I'm in ssh, I can always "chmod +w" the files, or "chown nobody". But my question is this: how can I make my Windows user (let's call him 'admin') impersonate 'root' on the Linux, so I can simply manipulate files from Windows, without resorting to ssh?

In other words, and to make the whole question plainer: how do you tell your OS that a certain user on Windows is a certain user on linux? (that way, I can have 'admin' be 'root').

Thanks in advance, Guy

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T23:57:06.297

[Samba](http://www.samba.org/samba/what_is_samba.html) can do something like you've said. it basically emulates windows compatible permissions on a linux box..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T00:11:00.777

假设 NAS 正在运行 samba（几乎可以肯定），那么 /etc 中的某处应该有一个 samba 配置文件。但我不知道它是否可以编辑。

windows/Linux 和权限之间的重新映射都是在服务器（samba）端完成的。
有很多关于此的 Samba 常见问题解答。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-16T23:46:53.493

[Cygwin](http://www.cygwin.com/) can do that.

EDIT:

The [cacls](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/cacls.mspx?mfr=true) command in Windows looks like it does what you want.

# c# - Merging cross referenced XML-files

> ID：1004436
> 
> 赞同：0
> 
> 时间：2009-06-16T23:40:53.363
> 
> 标签：c#, xml, vb.net, linq, merge

I'm co-developing a vehicle information system that reads and presents data from a communication bus. Signaling information on the bus is stored on some kind of database (from the dark ages i'd guess) from which it's only possible to get data out of by extracting a xml-snapshot. Since that wasn't bad enough, someone in upper management thought it was a great idea to treat different parts of the system as different projects (it looked really nice in the organizational chart) which lead to more databases...

It is now my responsibility to merge these xml-files into one and before I start banging my head against the wall i thought it would be a good idea to check with you geniuses if there's any neat solution to my problem.

The structure of the xml is somewhat like this:

```
<data>
  <frame ID="1001">
    <attributes>
      <name>Frame 1</name>
      <description>The first frame</description>
    </attributes>
    <references/>
  </frame>
  <signal ID="1002">
    <attributes>
      <signalid>1</signalid>
      <name>Signal 1</name>
    </attributes>
    <references>
      <frame ID="1001"/>
    </references>
  </signal>
</data> 
```

All entities (signals, frames etc.) lies directly under the root element and there can be several of each. The ID is generated when the file is extracted from the database and changes everytime. The only purpose of the id is to link different entities together, "Signal 1" belongs to "Frame 1" and so on...

The unique identifier of an entity differ between the entities but it's often an id, name or combination of some elements.

Since there is an overlap between the projects the second xml-file can look like this:

```
<data>
  <frame ID="2001">
    <attributes>
      <name>Frame 1</name>
      <description>The first of many frames</description>
    </attributes>
    <references/>
  </frame>
  <signal ID="2002">
    <attributes>
      <signalid>1</signalid>
      <name>Signal 1</name>
    </attributes>
    <references>
      <frame ID="2001"/>
    </references>
  </signal>
  <signal ID="2003">
    <attributes>
      <signalid>2</signalid>
      <name>Signal 2</name>
    </attributes>
    <references>
      <frame ID="2001"/>
    </references>
  </signal>
</data> 
```

As you can see there is now multiple instances of "Frame 1" and "Signal 1" but the second file adds another signal to "Frame 1".

What i'm trying to achieve is to add "Signal 2" to the first file and update the frame reference to 1001.

The best solution i've come up with so far is to do a plain merge (using linq), search the whole file for duplicates, store all related ID's and last but not least replace the deleted ID's with the correct ones.

I'm pretty sure there's no oneliner-solution to my problem (since the problem originates from the crappy database structure), but it'd be stupid not to ask.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-11T21:59:30.093

好吧，我想我的问题也没有任何花哨的解决方案。我最终使用了我在问题中描述的“解决方案”。

好吧，继续做更大的事情！

# sql-server-2005 - Unable to connect to SQL2005 using VBScript

> ID：1004437
> 
> 赞同：0
> 
> 时间：2009-06-16T23:41:13.473
> 
> 标签：sql-server-2005, vbscript

Using the connection string below I can connect to a SQL2000 DB but not a SQL2005\. I have the code in an ASP file.

```
Dim connStr, cn, rs, sql
connStr = "Provider=SQLOLEDB;Persist Security Info=True" _
           & ";Initial Catalog=mydatabase"  _
           & ";User ID=dbuser" _
           & ";Password=dbpwd" _
           & ";Data Source=servername" 
sql = "SELECT TOP 1 [Column1] FROM [dbo].[MyTable] order by NEWID()"
Set cn = Server.CreateObject("ADODB.Connection")
cn.Open cn

set rs= server.CreateObject("ADODB.Recordset")
    rs.CursorLocation=3
    rs.Open sql,cn,3,4

    if not rs.EOF then
       Response.Write("<b>Column1: " & rs("Column1") & "</b><br />")
    end if
set rs.ActiveConnection= nothing    
    rs.Close
    set rs= nothing
if ucase(TypeName(cn)) = "CONNECTION" then
    cn.Close
    Set cn = Nothing
end if 
```

I have even tired with SQLOLEDB.1 Sql login is enabled on the sql server.

Error: The connection cannot be used to perform this operation. It is either closed or invalid in this context. Happens on rs.Open sql,cn,3,4

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T00:19:00.183

有时每个人都会遇到：

```
Dim connStr, cn, rs, sql
connStr = "Provider=SQLOLEDB;Persist Security Info=True" _
           & ";Initial Catalog=mydatabase"  _
           & ";User ID=dbuser" _
           & ";Password=dbpwd" _
           & ";Data Source=servername" 
sql = "SELECT TOP 1 [Column1] FROM [dbo].[MyTable] order by NEWID()"
Set cn = Server.CreateObject("ADODB.Connection")
cn.Open connStr 
```

您正在调用一个变量**conn**作为连接字符串，但您已经声明并填充了**connStr**

将“cn.Open conn”更改为“cn.Open connStr”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T00:01:28.953

错误是什么？禁用远程连接的 SQL Server 2005/8 安装 -[请查看此支持文章](http://support.microsoft.com/kb/914277)。

我明白了，尝试在你的 Connection 对象上设置你的 connString（你使用 conn 而不是 connStr）。Uee[选项显式](http://msdn.microsoft.com/en-us/library/bw9t3484(VS.85).aspx)以避免这些错误。

# java - how to get a the value of an http post as a whole? parsing restful post

> ID：1004442
> 
> 赞同：0
> 
> 时间：2009-06-16T23:42:40.227
> 
> 标签：java, http, rest, post

Is it my ideea or in rest-web services a post comes "with no name", so say something...

I mean, is the post the whole body, minus headers???

so, how can I parse such a post message with java?

do I have to use

HttpServletRequest.getInputStream?

[http://www.softlab.ntua.gr/facilities/documentation/unix/java/servlet2.2/javax/servlet/http/HttpServletResponse.html](http://www.softlab.ntua.gr/facilities/documentation/unix/java/servlet2.2/javax/servlet/http/HttpServletResponse.html)

any useful example?

and how do I make such a call? I mean, posting value in the body and not in a specific parameter...

thanks a lot

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T23:46:44.243

[Fiddler](http://www.fiddler2.com/) is really useful for this sort of thing. It is acts as a standard http proxy on your local machine. You can view the post body and headers etc in it's interface. You just have to tell your code to use an HTTP proxy (usually just 1 or 2 lines of )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T00:12:33.830

服务器端代码如下所示：

```
StringBuilder input = new StringBuilder();
BufferedReader reader = request.getReader();
String line = reader.readLine();
while (line != null) {
    input.append(line);
    line = reader.readLine();
} 
```

其中 request 是 HttpServletRequest。要从客户端对此进行测试，您可以将[Poster](https://addons.mozilla.org/en-US/firefox/addon/2691 "海报 Firefox 附加组件")与 Firefox 一起使用。

# iphone - Can I develop an iPhone application that my company can use for internal employees only?

> ID：1004443
> 
> 赞同：13
> 
> 时间：2009-06-16T23:42:48.227
> 
> 标签：iphone

I'm interested in developing an iPhone application that would be useful to some of the employees at our company in the field. I'm wondering if that's possible to do and if I still have to through the Apple application approval process for it to work?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-16T23:48:38.310

Yes, you can develop internal apps.

To do so, you would need to sign up for the Enterprise program, or work within the limitations of Ad-hoc distribution.

As far as I know, in-house distribution for Enterprise level developers does not have an app approval process.

[http://developer.apple.com/iphone/program/apply.html](http://developer.apple.com/iphone/program/apply.html)

[Distribute Your Application](http://developer.apple.com/iphone/program/distribute.html)

> **Enterprise Distribution** (Enterprise Program, $299 / Must have D-U-N-S number)
> The iOS Developer Enterprise Program is intended for companies who create proprietary, in-house iOS apps for internal deployment within the company only. A valid Dun & Bradstreet (D-U-N-S) number is required for program enrollment.
> 
> **Ad Hoc Distribution** (Available in Standard Program, $99)
> The Standard and Enterprise Programs allow you to share your application with up to 100 other iPhone or iPod touch users with Ad Hoc distribution. Share your application through email or by posting it to a web site or server.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-16T23:45:19.940

Yes, there is a developer program for corporate licensees and you basically have to go through the same process. It is called the "Enterprise Program" which allows for inhouse distribution.

See here for details:

[http://developer.apple.com/iphone/program/apply.html](http://developer.apple.com/iphone/program/apply.html)

# jquery - JQuery cycle plugin with different effect on next and previous

> ID：1004458
> 
> 赞同：3
> 
> 时间：2009-06-16T23:47:34.193
> 
> 标签：jquery, jquery-plugins

Using JQuery cycle, is it possible to have different effects on the next and previous buttons? For example, have the next button scroll left and previous button fade?

I know about the scrollHorz effect for left and right scrolling.

Thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T11:05:01.887

在不修改插件源代码的情况下，无法为 next 和 prev 按钮指定单独的单独效果。

最接近的方法是在 fx 选项中指定多种效果。这些将按顺序使用。例子：

```
$('#slideDiv').cycle({ 
    fx:     'fade,scrollHorz', 
    prev:   '#prev1', 
    next:   '#next1', 
    timeout: 0 
}); 
```

因此，第一次单击下一个或上一个按钮时，它将使用“淡入淡出”，下次单击任一按钮时，它将使用“scrollHorz”，然后是“淡入淡出”等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-02T18:24:11.533

开箱即用，这只适用于提供“反向”动画的过渡，例如 scrollHorz、scrollVert、shuffle。

jQuery Cycle 的好处是您可以编写自己的（或修改）任何转换以包含您自己的正向和反向逻辑。查看[Cycle Source](https://raw.github.com/malsup/cycle/master/jquery.cycle.all.js)并搜索“scrollHorz”。您将看到根据转换方向提供逻辑是多么容易（注意`fwd`变量）。然后，您可以修改任何现有的过渡以满足您的需要。

注意：需要一些 javascript 和数学技能。

# entity-framework - 实体框架中的单例数据库模式

> ID：1004466
> 
> 赞同：2
> 
> 时间：2009-06-16T23:52:06.493
> 
> 标签：entity-framework

我有一个应用程序，我在数据库中实现单例模式，我遇到了很大的问题。

我有下表，SingletonTable

```
+-------------+-------+------------+
| Column Name | Type  | Allow Null |
+-------------+-------+------------+
| Id          | Int   |  No        |
| VarType     | Int   |  No        |
| TypeARef    | Int   |  Yes       |
| TypeBRef    | Int   |  Yes       | 
+-------------+-------+------------+ 
```

在 EF 中，这被分解为两种具体类型，TypeA 和 TypeB。TypeARef 在 TypeA 上，TypeBRef 在 TypeB 上，VarType 是判别器。(VariableType, TypeARef, TypeBRef) 上有一个唯一索引。单例模式的想法是，对于给定值元组，我们在数据库中只有 1 行，所以每当我们添加对 SingletonTable 的引用时，我们首先检查该行是否存在，如果存在，我们返回数据库中的行，如果没有，我们创建行并返回对新创建行的引用。我已经把它抽象成一个方法，GetSingleton。

问题是每当我使用 GetSingleton 方法时，都会出现以下异常：

**测试方法 UnitTests.CreateBasicData.CreateFTIData 引发异常：System.InvalidOperationException：无法将对象添加到 EntityCollection 或 EntityReference。无法将附加到 ObjectContext 的对象添加到不与源对象关联的 EntityCollection 或 EntityReference**

我正在使用它

```
var newRow = new SomeType
{
        singletonValue = GetSingleton(new TypeB{ TypeBRef = Foo })
} 
```

问题似乎是我无法将数据上下文中尚未包含的内容的引用添加到数据上下文中的内容中。这是正确的吗？如何解决此限制？

谢谢，罗伊

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T02:06:34.397

在实体框架的对象上下文中执行查询时，返回的对象会自动附加到对象上下文。

您还可以将对象附加到从查询以外的源获得的对象上下文。您可以附加先前已分离的对象、已由 NoTracking 查询返回的对象或已在对象上下文之外获得的对象。您还可以附加已存储在 ASP.NET 应用程序的视图状态中或已从远程方法调用或 Web 服务返回的对象。

使用以下方法之一将对象附加到对象上下文：

*   在 ObjectContext 上调用 AddObject 以将对象添加到对象上下文中。当对象是数据源中尚不存在的新对象时，请执行此操作。

*   在 ObjectContext 上调用 Attach 以将对象附加到对象上下文。当对象已存在于数据源中但当前未附加到上下文时，请执行此操作。有关更多信息，请参阅如何：附加相关对象（实体框架）。

*   在 ObjectContext 上调用 AttachTo 以将对象附加到对象上下文中的特定实体集。如果对象具有 null（Visual Basic 中为 Nothing）EntityKey 值，也执行此操作。

[http://msdn.microsoft.com/en-us/library/bb896271.aspx](http://msdn.microsoft.com/en-us/library/bb896271.aspx)

# asp.net - ReportViewer - 在服务器端 asp.net 中访问子报表/钻取

> ID：1004471
> 
> 赞同：1
> 
> 时间：2009-06-16T23:53:35.290
> 
> 标签：asp.net, reporting-services, reportviewer

在 aspx 页面中使用 ReportViewer 控件时。如果您触发一个事件（例如单击一行），然后显示一个子/钻取报告...您如何在服务器端访问该报告对象？

父报表对象有一个 DrillThough 事件被触发......但它似乎无权访问新报表或将哪些值传递给子/钻取报表。

此外，当页面重新加载（回发）并显示子报告时，我什至不确定如何在 page_load 事件期间访问子/钻取报告......因为您似乎无法通过父级访问它报告查看器...

我正在使用 2008 ReportViewer 对象

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-09-16T06:16:00.127

我能够使用`DrillThroughEventArgs`Report Controls`DrillThrough`事件中的访问报告...

# javascript - jQuery CSS插件返回元素的计算样式以伪克隆该元素？

> ID：1004475
> 
> 赞同：68
> 
> 时间：2009-06-16T23:56:35.003
> 
> 标签：javascript, jquery, css, web-applications

我正在寻找一种使用 jQuery 为第一个匹配元素返回计算样式对象的方法。然后我可以将此对象传递给另一个 jQuery 的 css 方法调用。

例如，使用[width](http://docs.jquery.com/CSS/width)，我可以执行以下操作以使 2 个 div 具有相同的宽度：

```
$('#div2').width($('#div1').width()); 
```

如果我可以**让文本输入看起来像一个现有的跨度**，那就太好了：

```
$('#input1').css($('#span1').css()); 
```

其中不带参数的 .css() 返回一个可以传递给[.css(obj)](http://docs.jquery.com/CSS/css#properties)的对象。

（我找不到为此的 jQuery 插件，但它似乎应该存在。如果它不存在，我将把我的下面变成一个插件并将它与我使用的所有属性一起发布。）

基本上，我想伪克隆某些元素**，但使用不同的 tag**。例如，我有一个要隐藏的 li 元素，并在其上放置一个看起来相同的输入元素。当用户键入时，**看起来他们正在编辑元素 inline**。

**我也对这个伪克隆问题的其他编辑方法持开放态度。**有什么建议么？

这是我目前拥有的。唯一的问题是获得所有可能的样式。这可能是一个长得可笑的清单。

* * *

```
jQuery.fn.css2 = jQuery.fn.css;
jQuery.fn.css = function() {
    if (arguments.length) return jQuery.fn.css2.apply(this, arguments);
    var attr = ['font-family','font-size','font-weight','font-style','color',
    'text-transform','text-decoration','letter-spacing','word-spacing',
    'line-height','text-align','vertical-align','direction','background-color',
    'background-image','background-repeat','background-position',
    'background-attachment','opacity','width','height','top','right','bottom',
    'left','margin-top','margin-right','margin-bottom','margin-left',
    'padding-top','padding-right','padding-bottom','padding-left',
    'border-top-width','border-right-width','border-bottom-width',
    'border-left-width','border-top-color','border-right-color',
    'border-bottom-color','border-left-color','border-top-style',
    'border-right-style','border-bottom-style','border-left-style','position',
    'display','visibility','z-index','overflow-x','overflow-y','white-space',
    'clip','float','clear','cursor','list-style-image','list-style-position',
    'list-style-type','marker-offset'];
    var len = attr.length, obj = {};
    for (var i = 0; i < len; i++) 
        obj[attr[i]] = jQuery.fn.css2.call(this, attr[i]);
    return obj;
} 
```

编辑：我现在已经使用上面的代码一段时间了。它运行良好并且行为与原始 css 方法完全相同，但有一个例外：如果传​​递了 0 个参数，它会返回计算的样式对象。

As you can see, it immediately calls the original css method if that's the case that applies. Otherwise, it gets the computed styles of all the listed properties (gathered from Firebug's computed style list). Although it's getting a long list of values, it's quite fast. Hope it's useful to others.

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2011-06-20T19:37:25.543

Two years late, but I have the solution you're looking for. Here's a plugin I wrote (by wrapping another guy's function in plugin format) which does exactly what you want, but gets **all** possible styles in all browsers, even IE.

`jquery.getStyleObject.js:`

```
/*
 * getStyleObject Plugin for jQuery JavaScript Library
 * From: http://upshots.org/?p=112
 *
 * Copyright: Unknown, see source link
 * Plugin version by Dakota Schneider (http://hackthetruth.org)
 */

(function($){
    $.fn.getStyleObject = function(){
        var dom = this.get(0);
        var style;
        var returns = {};
        if(window.getComputedStyle){
            var camelize = function(a,b){
                return b.toUpperCase();
            }
            style = window.getComputedStyle(dom, null);
            for(var i=0;i<style.length;i++){
                var prop = style[i];
                var camel = prop.replace(/\-([a-z])/g, camelize);
                var val = style.getPropertyValue(prop);
                returns[camel] = val;
            }
            return returns;
        }
        if(dom.currentStyle){
            style = dom.currentStyle;
            for(var prop in style){
                returns[prop] = style[prop];
            }
            return returns;
        }
        return this.css();
    }
})(jQuery); 
```

Basic usage is pretty simple:

```
var style = $("#original").getStyleObject(); // copy all computed CSS properties
$("#original").clone() // clone the object
    .parent() // select it's parent
    .appendTo() // append the cloned object to the parent, after the original
                // (though this could really be anywhere and ought to be somewhere
                // else to show that the styles aren't just inherited again
    .css(style); // apply cloned styles 
```

Hope that helps.

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-06-20T00:11:11.223

It's not jQuery but, in Firefox, Opera and Safari you can use `window.getComputedStyle(element)` to get the computed styles for an element and in IE<=8 you can use `element.currentStyle`. The returned objects are different in each case, and I'm not sure how well either work with elements and styles created using Javascript, but perhaps they'll be useful.

In Safari you can do the following which is kind of neat:

```
document.getElementById('b').style.cssText = window.getComputedStyle(document.getElementById('a')).cssText; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-01-28T15:45:50.517

I dont know if you're happy with the answers you got so far but I wasn't and mine may not please you either, but it may help someone else.

After pondering upon how to "clone" or "copy" elements' styles from one to another I have come to realize that it was not very optimal of an approach to loop through n and apply to n2, yet we're sorta stuck with this.

When you find yourself facing these issues, you rarely ever need to copy ALL the styles from one element to another... you usually have a specific reason to want "some" styles to apply.

Here's what I reverted to:

```
$.fn.copyCSS = function( style, toNode ){
  var self = $(this);
  if( !$.isArray( style ) ) style=style.split(' ');
  $.each( style, function( i, name ){ toNode.css( name, self.css(name) ) } );
  return self;
} 
```

You can pass it a space-separated list of css attributes as the first argument and the node you want to clone them to as the second argument, like so:

```
$('div#copyFrom').copyCSS('width height color',$('div#copyTo')); 
```

Whatever else seems to "misalign" after that, I'll try to fix with stylesheets as to not clutter my Js with too many misfired ideas.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-21T07:32:44.473

Now that I've had some time to look into the problem and understand better how jQuery's internal css method works, what I've posted seems to work well enough for the use case that I mentioned.

It's been proposed that you can solve this problem with CSS, but I think this is a more generalized solution that will work in any case without having to add an remove classes or update your css.

I hope others find it useful. If you find a bug, please let me know.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-10-07T13:21:38.890

I like your answer Quickredfox. I needed to copy some CSS but not immediately so I modified it to make the "toNode" optional.

```
$.fn.copyCSS = function( style, toNode ){
  var self = $(this),
   styleObj = {},
   has_toNode = typeof toNode != 'undefined' ? true: false;
 if( !$.isArray( style ) ) {
  style=style.split(' ');
 }
  $.each( style, function( i, name ){ 
  if(has_toNode) {
   toNode.css( name, self.css(name) );
  } else {
   styleObj[name] = self.css(name);
  }  
 });
  return ( has_toNode ? self : styleObj );
} 
```

If you call it like this:

```
$('div#copyFrom').copyCSS('width height color'); 
```

Then it will return an object with your CSS declarations for you to use later:

```
{
 'width': '140px',
 'height': '860px',
 'color': 'rgb(238, 238, 238)'
} 
```

Thanks for the starting point.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-06-20T16:20:13.387

# Multipurpose `.css()`

### Usage

```
$('body').css();        // -> { ... } - returns all styles
$('body').css('*');     // -> { ... } - the same (more verbose)
$('body').css('color width height')  // -> { color: .., width: .., height: .. } - returns requested styles
$('div').css('width height', '100%')  // set width and color to 100%, returns self
$('body').css('color')  // -> '#000' - native behaviour 
```

### Code

```
(function($) {

    // Monkey-patching original .css() method
    var nativeCss = $.fn.css;

    var camelCase = $.camelCase || function(str) {
        return str.replace(/\-([a-z])/g, function($0, $1) { return $1.toUpperCase(); });
    };

    $.fn.css = function(name, value) {
        if (name == null || name === '*') {
            var elem = this.get(0), css, returns = {};
            if (window.getComputedStyle) {
                css = window.getComputedStyle(elem, null);
                for (var i = 0, l = css.length; i < l; i++) {
                    returns[camelCase(css[i])] = css.getPropertyValue(css[i]);
                }
                return returns;
            } else if (elem.currentStyle) {
                css = elem.currentStyle;
                for (var prop in css) {
                    returns[prop] = css[prop];
                }
            }
            return returns;
        } else if (~name.indexOf(' ')) {
            var names = name.split(/ +/);
            var css = {};
            for (var i = 0, l = names.length; i < l; i++) {
                css[names[i]] = nativeCss.call(this, names[i], value);
            }
            return arguments.length > 1 ? this : css;
        } else {
            return nativeCss.apply(this, arguments);
        }
    }

})(jQuery); 
```

Main idea is taken from [Dakota's](https://stackoverflow.com/a/6416477/489553) & [HexInteractive's](https://stackoverflow.com/a/3882043/241211) answers.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-01-22T09:13:11.467

I just wanted to add an extension to the code submitted by Dakota.

If you want to clone an element with all of the styles applied to it and all the children elements then you can use the following code:

```
/*
 * getStyleObject Plugin for jQuery JavaScript Library
 * From: http://upshots.org/?p=112
 *
 * Copyright: Unknown, see source link
 * Plugin version by Dakota Schneider (http://hackthetruth.org)
 */

(function($){
    $.fn.getStyleObject = function(){
        var dom = this.get(0);
        var style;
        var returns = {};
        if(window.getComputedStyle){
            var camelize = function(a,b){
                return b.toUpperCase();
            }
            style = window.getComputedStyle(dom, null);
            for(var i=0;i<style.length;i++){
                var prop = style[i];
                var camel = prop.replace(/\-([a-z])/g, camelize);
                var val = style.getPropertyValue(prop);
                returns[camel] = val;
            }
            return returns;
        }
        if(dom.currentStyle){
            style = dom.currentStyle;
            for(var prop in style){
                returns[prop] = style[prop];
            }
            return returns;
        }
        return this.css();
    }

    $.fn.cloneWithCSS = function() {
        var styles = {};

        var $this = $(this);
        var $clone = $this.clone();

        $clone.css( $this.getStyleObject() );

        var children = $this.children().toArray();
        var i = 0;
        while( children.length ) {
            var $child = $( children.pop() );
            styles[i++] = $child.getStyleObject();
            $child.children().each(function(i, el) {
                children.push(el);
            })
        }

        var cloneChildren = $clone.children().toArray()
        var i = 0;
        while( cloneChildren.length ) {
            var $child = $( cloneChildren.pop() );
            $child.css( styles[i++] );
            $child.children().each(function(i, el) {
                cloneChildren.push(el);
            })
        }

        return $clone
    }

})(jQuery); 
```

Then you can just do: `$clone = $("#target").cloneWithCSS()`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-02-18T01:22:28.527

Great function provided by the OP. I slightly modified it so that you can choose which values you want returned.

```
(function ($) {
    var jQuery_css = $.fn.css,
        gAttr = ['font-family','font-size','font-weight','font-style','color','text-transform','text-decoration','letter-spacing','word-spacing','line-height','text-align','vertical-align','direction','background-color','background-image','background-repeat','background-position','background-attachment','opacity','width','height','top','right','bottom','left','margin-top','margin-right','margin-bottom','margin-left','padding-top','padding-right','padding-bottom','padding-left','border-top-width','border-right-width','border-bottom-width','border-left-width','border-top-color','border-right-color','border-bottom-color','border-left-color','border-top-style','border-right-style','border-bottom-style','border-left-style','position','display','visibility','z-index','overflow-x','overflow-y','white-space','clip','float','clear','cursor','list-style-image','list-style-position','list-style-type','marker-offset'];
    $.fn.css = function() {
        if (arguments.length && !$.isArray(arguments[0])) return jQuery_css.apply(this, arguments);
        var attr = arguments[0] || gAttr,
            len = attr.length,
            obj = {};
        for (var i = 0; i < len; i++) obj[attr[i]] = jQuery_css.call(this, attr[i]);
        return obj;
    }
})(jQuery); 
```

Choose which values you want by specifying your own array: `$().css(['width','height']);`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-11-02T20:12:51.540

```
$.fn.cssCopy=function(element,styles){
var self=$(this);
if(element instanceof $){
    if(styles instanceof Array){
        $.each(styles,function(val){
            self.css(val,element.css(val));
        });
    }else if(typeof styles===”string”){
        self.css(styles,element.css(styles));
    }
}
return this;
}; 
```

Use example

```
$("#element").cssCopy($("#element2"),['width','height','border']) 
```

# java - Java 的 instanceof 和 isInstance() 的 VB 等价物是什么？

> ID：1004476
> 
> 赞同：13
> 
> 时间：2009-06-16T23:56:39.213
> 
> 标签：java, vb.net, reflection, introspection, instanceof

本着[c#](https://stackoverflow.com/questions/282459/what-is-the-c-equivalent-to-javas-instanceof-and-isinstance)问题的精神..

在 VB.NET 中比较类类型的等效语句是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-17T00:01:51.607

你在寻找类似的东西`TypeOf`吗？这仅适用于引用类型，不适用于 int/etc。

```
If TypeOf "value" Is String Then
     Console.WriteLine("'tis a string, m'lord!") 
```

或者您想比较两个不同的变量实例？也适用于 ref 类型：

```
Dim one As Object = "not an object"
Dim two As Object = "also not an object, exactly"
Dim three as Object = 3D

If one.GetType.Equals( two.GetType ) Then WL("They are the same, man")
If one.GetType Is two.GetType then WL("Also the same")
If one.GetType IsNot three.GetType Then WL("but these aren't") 
```

`gettype()`如果您不使用两个对象，您也可以像这样使用：

```
If three.GetType Is gettype(integer) then WL("is int") 
```

如果您想查看某物是否是另一种类型的子类（并且在 .net 3.5 中）：

```
If three.GetType.IsSubclassOf(gettype(Object)) then WL("it is") 
```

但是如果你想在早期版本中这样做，你必须翻转它（看起来很奇怪）并使用：

```
If gettype(Object).IsAssignableFrom(three.GetType) Then WL("it is") 
```

所有这些都在[SnippetCompiler](http://www.sliver.com/dotnet/SnippetCompiler/)中编译，所以如果你没有它，那就去 DL。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-16T23:58:57.697

```
TypeOf obj Is MyClass 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T23:59:04.233

与您的链接问题等效的 VB 几乎相同：

```
Dim result As Boolean = obj.GetType().IsAssignableFrom(otherObj.GetType()) 
```

# php - 用php读取pdf文件

> ID：1004478
> 
> 赞同：60
> 
> 时间：2009-06-16T23:56:46.017
> 
> 标签：php, pdf

我有一个大的 PDF 文件，它是建筑物的平面图。它包含所有办公家具的图层，包括座位位置的文本框。

我的目标是用 PHP 读取这个文件，在文档中搜索文本层，在文件中获取它们的内容和坐标。这样我可以绘制出座位位置 -> x/y 坐标。

有没有办法通过 PHP 做到这一点？（如果有必要的话，甚至是 Ruby 或 Python）

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-10-17T17:49:46.993

查看 FPDF（使用 FPDI）：

[http://www.fpdf.org/](http://www.fpdf.org/)

[http://www.setasign.de/products/pdf-php-solutions/fpdi/](http://www.setasign.de/products/pdf-php-solutions/fpdi/)

这些将让您打开一个 pdf 并在 PHP 中添加内容。我猜您也可以使用它们的功能在现有内容中搜索您需要的值。

另一个可能的库是 TCPDF：[https ://tcpdf.org/](https://tcpdf.org/)

更新以添加更现代的库：[PDF Parser](http://www.pdfparser.org/documentation)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-01-23T10:42:15.397

有一个 php 库 (pdfparser) 可以完全满足您的需求。

**项目网站**

[http://www.pdfparser.org/](http://www.pdfparser.org/)

**github**

[https://github.com/smalot/pdfparser](https://github.com/smalot/pdfparser)

**演示页面/api**

[http://www.pdfparser.org/demo](http://www.pdfparser.org/demo)

在您的项目中包含 pdfparser 后，您可以`mypdf.pdf`像这样获取所有文本：

```
<?php
$parser = new \installpath\PdfParser\Parser();
$pdf    = $parser->parseFile('mypdf.pdf');  
$text = $pdf->getText();
echo $text;//all text from mypdf.pdf

?> 
```

类似地，您可以从 pdf 中获取元数据以及获取 pdf 对象（例如图像）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-17T00:39:46.367

不完全是 php，但您可以从 php 执行一个程序，将 pdf 转换为临时 html 文件，然后使用 php.ini 解析生成的文件。我为我的一个项目做了类似的事情，这是我使用的程序：

[PdfToHtml](http://pdftohtml.sourceforge.net/)

生成的 HTML 将文本元素包装在具有绝对位置坐标的 < div > 标记中。看起来这正是你想要做的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-04-09T15:19:58.273

您最初的要求是“我有一个大型 PDF 文件，它是建筑物的平面图。”

我害怕告诉你这可能比你想象的要难。

因为**每个人用来解析 pdf 的最后一个已知的库是 smalot，并且已知这个库会遇到有关大文件的问题。**

在这里，也寻找一个真正的 php lib 来解析 pdf，没有任何需要 php 配置来禁用内存限制的内存峰值，就像许多“开发人员”所做的那样（我想这真的是不可取的）。

有关 smalot 性能的更多详细信息，请参见这篇文章：[https ://github.com/smalot/pdfparser/issues/163](https://github.com/smalot/pdfparser/issues/163)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-11T08:58:24.653

您可能还想尝试这个应用程序[http://pdfbox.apache.org/](http://pdfbox.apache.org/)。可以在[https://www.jinises.com找到一个工作示例](https://www.jinises.com)

# oracle - System.Data.OracleClient 命名空间已停用？

> ID：1004484
> 
> 赞同：14
> 
> 时间：2009-06-17T00:00:18.363
> 
> 标签：oracle, .net-4.0, oracleclient

我今天刚刚阅读了[这篇](http://visualstudiomagazine.com/articles/2009/06/16/microsoft-kills-oracle-data-provider-for-adonet.aspx)关于 Microsoft 如何决定`System.Data.OrcaleClient`从 .NET 4.0 库中删除命名空间的文章。

我将其用作处理 Oracle 数据库的主要工具。

当我决定将我的应用程序从 .NET 2.0 升级到 .NET 4.0 时，在 .NET 4.0 框架中使用 Oracle 数据库的其他选择是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T00:03:42.273

由 Oracle 来保证他们的[ODP.NET](http://www.oracle.com/technology/tech/windows/odpnet/index.html)是最新的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-31T19:19:44.313

Oracle 为有兴趣了解如何以及为何迁移到 Oracle Data Provider for .NET (ODP.NET) 的 OracleClient 开发人员创建了一个专门的网站。请查看：

[http://www.oracle.com/technetwork/topics/dotnet/index-085703.html](http://www.oracle.com/technetwork/topics/dotnet/index-085703.html)

（编辑：修复了断开的链接）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T00:04:14.533

请注意这段摘录：

> Microsoft 仍将在 .NET Framework 4 中提供 System.Data.OracleClient，但它会被标记为“已弃用”

因此，继续使用它来更新您以前依赖它的*现有应用程序。*但是对于*新*的开发，你会想要找到一个替代方案。这应该不会太难，因为将停止使用的全部原因是大多数人已经在使用替代品。如果您进一步阅读本文，它会列出主要选项：

> 提供此类提供商的有 DataDirect Technologies 和 Devart（以前称为 Core Lab）。此外，Oracle 的提供程序，称为 Oracle Data Provider for .NET (ODP.NET)，是一种流行且可行的选择

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T07:26:10.580

正如[Joel 所指出](https://stackoverflow.com/questions/1004484/system-data-oracleclient-namespace-discontinued/1004498#1004498)的，Oracle 的 Microsoft ADO .NET 提供程序只会被弃用（这意味着它仍然可用，但不受支持）。

替代方案包括：

*   [.NET 的 Oracle 数据提供程序](http://www.oracle.com/technology/tech/windows/odpnet/index.html)。免费（如果您有时间，那就是......）
*   [适用于 Oracle 的 DataDirect ADO.NET 数据提供程序](http://www.datadirect.com/products/net/net_for_oracle/index.ssp)。商业（没有第一手经验，但我认识几个成功使用它的开发人员）

更多供应商[可以在这里找到](http://www.sqlsummit.com/DataProv.htm)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T16:18:21.433

我还没有提到的另一个是devart 的[dotConnect](http://www.devart.com/dotconnect/oracle/ "来自devart的dotConnect")。正如[Mac](https://stackoverflow.com/questions/1004484/system-data-oracleclient-namespace-discontinued/1005584#1005584 "苹果电脑")所提到的，ODP.NET 是“如果你有时间的话”是免费的，我倾向于同意这一点，所以我将评估一些商业选项，从 dotConnect 开始。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T00:44:29.887

Oracle Data Provider for .Net 是要走的路……尽管目前，使用 Oracle Instant Client .dll 文件可以使用它进行的最小 clickonce 部署约为 30 mb。它与 System.Data.OracleClient 非常相似，但有一些时髦的特性。

# asp.net - 想要使用 jquery 弹出窗口，但从服务器端获取数据

> ID：1004490
> 
> 赞同：0
> 
> 时间：2009-06-17T00:02:14.180
> 
> 标签：asp.net, javascript, jquery, html

当有人像这样点击我的 google adwords 链接时：

[http://www.myshoppingsite.com/product/rubberball.aspx?promo=promo123](http://www.myshoppingsite.com/product/rubberball.aspx?promo=promo123)

我希望我的 aspx 页面读取“促销”参数，点击数据库以拉回一些数据，然后在产品页面顶部向用户显示一个漂亮的 jquery 类型弹出窗口。用户可以阅读有关促销的所有信息，然后关闭该弹出窗口并进入他们想要访问的产品页面。

我不知道该怎么做...我是读取参数并从客户端获取数据（通过 web 服务或页面方法），还是获取数据并从服务器端调用 javascript？

我之前创建过 jquery 弹出窗口，但数据一直都在客户端。我想显示一个弹出窗口，但从数据库中获取数据。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T00:06:08.587

如果您真的考虑一下，在这种情况下没有理由返回服务器。您可以简单地检查服务器端是否`promo`传递了 GET 参数，如果是，则显示隐藏`<div>`的促销信息：

```
<div style='display: none;' id='promo'>
....
</div> 
```

一旦你这样做了，你可以简单地使用一些 jQuery 代码来检查这个隐藏是否`<div>`存在，如果存在则显示模式：

```
$(function() {
    if($('#promo').length > 0) {
        showModal($('#promo').html());
    }
}); 
```

如果你坚持通过 AJAX 查询服务器，这也是相当简单的：

```
function gup( name ) {
  name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
  var regexS = "[\\?&]"+name+"=([^&#]*)";
  var regex = new RegExp( regexS );
  var results = regex.exec( window.location.href );
  if( results == null )
    return "";
  else
    return results[1];
}

$(function() {
    var promo = $.trim(gup('promo'));
    if(promo != '') {
        $.get('my/url/whatever.php', {promo: promo}, function(data) {
            showModal(data);
        });
    }
}); 
```

既然你说你有使用 jQuery 显示模态窗口的经验，我不会详细说明`showModal`应该做什么；只要说它应该简单地激活你的 jQuery 插件用来显示模态窗口的任何东西就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T00:07:09.770

所以你想要加载时弹出窗口？使用弹出窗口呈现页面，并使用关闭弹出窗口的方法。在服务器上读取查询字符串，并在一次操作中将您想要的任何内容呈现到其中。唯一需要的 JS 是隐藏弹出窗口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T00:18:35.957

你可以使用[脸书](https://github.com/defunkt/facebox)。以编程方式调用一个漂亮的跨浏览器弹出窗口，如下所示：

```
$('#someLink').click(function(e) {
    e.preventDefault();
    $.facebox({ ajax: '/product/rubberball.aspx?promo=promo123' });
}); 
```

# c# - 将文本添加到视频中并保存输出

> ID：1004491
> 
> 赞同：4
> 
> 时间：2009-06-17T00:02:22.103
> 
> 标签：c#, vb.net, video

我要做的是获取一个“输入”视频文件（我可以将其设为最简单的任何文件类型），然后通过我的代码将文本添加到视频文件中。

因此，例如，它将采用“Sample1.mpg”并输出“Sample2.mpg”。它不会*显示*视频（我发​​现一些教程讨论了在视频播放时覆盖文本；但实际上并未修改视频文件。

基本上，我想说“从 1 秒到 200 秒，用这种字体在 0,0 位置绘制 'Hi Mom'”并将其保存在输出的视频中。每当您使用任何播放器运行输出的视频时，您最终都会看到文本；因为它会成为视频文件的一部分。

我听说过诸如“DirectShow！”之类的说法。但我真的欢迎任何更具体的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T06:54:39.000

您可以使用一种非常强大的脚本语言，称为 avisynth

链接： [http ://avisynth.org/](http://avisynth.org/)

它适用于您可以播放的***任何文件，它使用directshow。***

只需安装它，它基本上是安装一个 VFW 编解码器，但非常简单。打开记事本并输入

```
DirectShowSource("C:\dir\filename.extension")
Subtitle("Put Your text here") 
```

将其另存为“任何名称**。avs** ”

***就是***这样。现在使用任何支持 avi 的应用程序打开它（如果需要，您甚至可以将其命名为 avi！）并重新编码视频，或进行处理。非常容易和自动。它也适用于图片。

有关 Subtitle() 功能的完整参考，请访问此处： [http ://avisynth.org/mediawiki/Subtitle](http://avisynth.org/mediawiki/Subtitle)

当然，如果你掌握它，avisynth 可以创造奇迹，比如在记录的每一帧上打印系统日期（对安全摄像头很有用），甚至是复杂的处理，比如顶级降噪、锐化和许多其他任务，通过外部普金斯。

外部 Pugin 参考： [http ://avisynth.org/mediawiki/External_plugins](http://avisynth.org/mediawiki/External_plugins)

易于下载的插件： [http ://avisynth.org/warpenterprises/](http://avisynth.org/warpenterprises/)

这很简单。2 行代码，你就拥有了一个可打开、可搜索、可处理、可转换的完全兼容且小于 1 KB 的 AVI（当您在应用程序上打开 AVS 时会即时添加字幕）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T21:33:16.657

我建议阅读更多内容：

[.NET 应用程序中可预测帧捕获的选项](https://stackoverflow.com/questions/378107/options-for-predictable-frame-capture-in-net-application)

然后使用

```
Graphics g = Graphics.FromImage(bitmap); 
```

要将框架放入 .NET，然后使用以下方法查看：

```
GraphicsPath path = new GraphicsPath();
path.AddString("Yadda", font.FontFamily, (int)font.Style, font.Size, rect, format); 
```

然后使用

```
g.FillPath(..path..) 
```

将绘图添加到框架中。

如何将其粘回 MPG 中？？？我猜你会回到使用顶部链接中引用的代码/项目。

在我看来，这只是提取 BMP 帧的情况，使用 .NET 绘图向其中添加内容，然后重新插入。了解如何在 .NET 中制作 CAPTCHA 可能会有所帮助。

祝你好运！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T00:07:14.810

查看[Adob​​e Premier API](http://www.adobe.com/devnet/premiere/sdk/cs3/)。我不确定是否有 .NET 库或者您是否必须进行互操作。

# iphone - 如何使用 iPhone Safari 地址搜索栏等动画调整文本字段的大小？

> ID：1004497
> 
> 赞同：1
> 
> 时间：2009-06-17T00:04:03.817
> 
> 标签：iphone

可能与CoreAnimation有关。

有没有人有任何例子可以做这样的事情？好吧，我是 CA 的新手，所以任何接近这个的例子都会有很大帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T02:08:47.153

看看`UIView`动画。这是一个例子：

```
CGRect newBounds = myTextField.bounds;
newBounds.size.width = NEWSIZE; //whatever you want the new width to be

[UIView beginAnimations:nil context:nil];
myTextField.bounds = newBounds;
[UIView commitAnimations]; 
```

要将其放回原处，请保存原件`bounds`并将其分配回`begin/commitAnimations`块内的文本字段。

# javascript - 检测文件是否已在 javascript/hta 中打开

> ID：1004501
> 
> 赞同：0
> 
> 时间：2009-06-17T00:06:28.790
> 
> 标签：javascript, hta

我正在尝试修复我公司的某个人在 3 或 4 年前创建的 .hta。现在，如果您打开其他人已经打开的文件，您将丢失您在该文件上所做的任何工作，并且必须重新手动执行。所以我想只是检查文件是否已经打开，然后锁定编辑，或者只是弹出一个窗口说“嘿，如果你试图保存你会失望的”。有没有一种简单的方法可以检查文件是否已经在 javascript 中打开？

打开文件的代码是...

```
function FileOpen( strSetup )
{
    if( ! strSetup )
    {
        strSetup = ShowDialog( "choose-setup", {"DialogTitle" : "Load Setup"} );
    }

    if( strSetup )
    {
        if( FileSystem.FileExists( App.Paths.Configs + "/" + strSetup + ".setup" ) )
        {
            var fFile = FileSystem.GetFile( App.Paths.Configs + "/" + strSetup + ".setup" );
            App.Config = LoadXMLDocument( fFile.Path );
            // SaveCurrentConfig();
            RefreshView( "setup-summary" );
        }
        else
        {
            alert( "Could not find setup '" + strSetup + "'" );
        }

    }
} 
```

LoadXMLDocument 的代码是...

```
//-----------------------------------------------------------------------------
// FUNCTION : LoadXMLDocument - Loads an XML document
// params   : strPath - the path/file of the document to load
//          : bCritical- if set true, we die if the document doesn't load
// returns  : an XML dom object on success, false otherwise
//-----------------------------------------------------------------------------

function LoadXMLDocument( strPath, bCritical )
{
    var xmlDoc = new ActiveXObject( "Msxml2.DOMDocument.3.0" );
    xmlDoc.setProperty( "SelectionLanguage", "XPath" );
    if( ! FileSystem.FileExists( strPath ) )
    {
        Error( "'" + strPath + "' is not a valid file path" );
        if( bCritical ) Abort();
        return( false );
    }
    var fFile = FileSystem.GetFile( strPath );
    xmlDoc.load( fFile.Path );
    if( xmlDoc.documentElement == null )
    {
        Error( "Could not load XML document '" + fFile.Path + "'" );
        if( bCritical ) Abort();
        return( false );
    }
    return( xmlDoc );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T01:34:00.890

这就是[修订控制](http://en.wikipedia.org/wiki/Version_control)的全部意义所在。它与不涉及的同一问题的其他形式没有什么不同。hta 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-31T19:02:01.517

我看到这是超级旧的帖子，但为什么不使用 VBS 呢？如果是 HTA，则支持一起运行：

```
objFSO = CreateObject("Scripting.FileSystemObject")

strFilePath = "C:\test.txt"
If objFSO.FileExist(strFilePath) Then
   MsgBox "I win"
End If 
```

# ruby-on-rails - RadRails 是否有键盘触发器（代码模板）作为编写重复代码的快捷方式？

> ID：1004509
> 
> 赞同：0
> 
> 时间：2009-06-17T00:08:14.807
> 
> 标签：ruby-on-rails, ruby, netbeans, keyboard-shortcuts, radrails

我喜欢 Netbeans Ruby 开发的一件事是[键盘触发器](http://ruby.netbeans.org/codetemplates-rhtml.html)。

例如，**如果您在 erb 模板中**并**键入**：

```
licai 
```

点击**tab 键**后，此文本将**替换为**：

```
<%= link_to "${1 default="link text..."}", 
:controller => "${2 default="items"}", 
:action => "${3 default="edit"}", 
:id => ${4 default="@item"} %> 
```

然后您可以使用 tab 键来填写每个参数。

我正在评估 RadRails，我真的很怀念 Netbeans 的这个功能。

**RadRails 中有类似的东西吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T08:01:28.387

是的，在 Window | 下查看 首选项，然后 Ruby -> Editor -> Templates 以查看已定义的现有代码模板列表或添加您自己的。

然后你想要的键盘快捷键是`Control`+ `Space`，例如输入“render”并按`Control`+`Space`查看渲染模板列表。

# java - 如何使用 JSSE 以编程方式将公钥 .cer 文件导入 java 密钥库？

> ID：1004517
> 
> 赞同：6
> 
> 时间：2009-06-17T00:11:07.873
> 
> 标签：java, jsse

我想获取从 java keytool 命令生成的公钥 .cer 文件，如下所示：

“keytool -export -alias privatekey -file publickey.cer -keystore privateKeys.store”

并将其导入到一个新的空 java 密钥库中，如下所示：

“keytool -import -alias publiccert -file publickey.cer -keystore publicCerts.store”

除了我想使用 JSSE 以编程方式进行导入。

Stack Overlords，施展你的魔法！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T08:59:40.470

查看 Java 中的 KeyStore 类。[这](http://traser.svn.sourceforge.net/viewvc/traser/0.3/TraSer/src/net/sf/traser/common/KeystoreManager.java?view=markup)是一个可能会给你一些提示的课程。您可能需要免费的[BouncyCastle](http://www.bouncycastle.org/)加密提供程序来操作其所有功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T02:36:53.570

如果您使用[jad](http://www.varaneckas.com/jad)反编译 Sun JDK 附带的 tools.jar，您将确切地看到它是如何工作的。

将 tools.jar 解压缩到一个文件夹中，然后使用以下命令反编译该 jar 中的所有类。

```
for i in $(find . -name "*.class" | perl -ple 's/\.class$//g'); 做 jad -p $i.class > $i.java; 完毕

```

keytool 源可以在类 sun.security.tools.KeyTool 中看到

# php - PHP - 代码几乎是我想要的

> ID：1004519
> 
> 赞同：0
> 
> 时间：2009-06-17T00:11:48.763
> 
> 标签：php, mysql

下面的代码与以下内容相呼应：

> 表名 1
> 
> 表名 2
> 
> 表名 3
> 
> 表名 4 "$entry": "votes_up for $entry in Table Name 4"

我希望它回应这个：

> 表名 1：“表名 1 中 $entry 的投票”
> 
> 表名 2：“表名 2 中 $entry 的投票”
> 
> 表名 3：“表名 3 中 $entry 的投票”
> 
> 表名 4：“表名 4 中 $entry 的投票”

我如何更改代码以使其回显我想要的内容？

表名的数量因 $entry 而异。

谢谢，

约翰

```
$result = mysql_query("SHOW TABLES FROM feather") 
or die(mysql_error()); 

while(list($table)= mysql_fetch_row($result))
{
 $sqlA = "SELECT `site`,votes_up FROM `$table` WHERE `site` LIKE '$entry'";
 $resA = mysql_query($sqlA) or die("$sqlA:".mysql_error());
 if(mysql_num_rows($resA) > 0)
 {
$table_list[] = $table;
while($rowA = mysql_fetch_assoc($resA))
  {
  $votes_up[$rowA["site"]] = $rowA["votes_up"];
  }
 }
}

foreach( $table_list as $key => $value){
    echo "$value <br />";
}

foreach($votes_up as $site => $vote_up)
{
  echo "$site: $vote_up";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T00:45:38.460

没关系。

这给了我想要的东西：

```
$result = mysql_query("SHOW TABLES FROM feather") 
or die(mysql_error()); 

while(list($table)= mysql_fetch_row($result))
{
  $sqlA = "SELECT COUNT(*) FROM `$table` WHERE `site` LIKE '$entry'";
  $resA = mysql_query($sqlA) or die("$sqlA:".mysql_error());
  list($isThere) = mysql_fetch_row($resA);
  if ($isThere)
  {
     $table_list[] = $table;
  }
}

foreach ($table_list as $table) { 
    $sql = "SELECT votes_up FROM `$table` WHERE `site` LIKE '$entry'"; 
    $sql1 = mysql_query($sql) or die("$sql:".mysql_error());
   while ($row = mysql_fetch_assoc($sql1)) {
       echo $table . ': "' . $row['votes_up'] . " for $entry from $table\"<br />";
   } 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T00:35:14.813

看起来您正在从多个表中选择*$site* - 您确定它们具有唯一值吗？您选择的值可能在每个表中实际上是相同的（即使每个表都启用了 NO_DUPLICATES）。

# validation - 验证嵌套模型？

> ID：1004520
> 
> 赞同：2
> 
> 时间：2009-06-17T00:11:52.303
> 
> 标签：validation, model, associations, sinatra, datamapper

更具体地说，***“如何验证模型是否需要创建至少 x 个有效的关联模型？”*** . 我一直在尝试验证以与父级相同的形式创建的嵌套模型（并最终通过 jQuery 显示即时验证）。作为一个流行的例子，让我们假设以下模型和模式。

```
class Project
  include DataMapper::Resource

  property :id,     Serial
  property :title,  String, :nullable => false

  has 2..n, :tasks
end

class Task
  include DataMapper::Resource

  property :id,         Serial
  property :project_id, Integer,  :key => true
  property :title,      String,   :nullable => false

  belongs_to :project
end 
```

如您所见，所有验证都在模式定义中完成。这里重要的是“ `has 2..n, :tasks`”。鉴于 params 哈希中的嵌套任务属性将生成*有效*任务，此验证实际上正常工作。但是，如果他们产生*无效*任务，则不会创建该任务，您最终会得到一个少于 2 个任务的项目，因此是一个*无效*的项目对象。

据我了解，这是因为它无法确定任务属性是否有效，直到它尝试保存任务，并且因为 -*据我所知*- 在项目之前无法保存任务，该项目不知道任务是否有效。我的假设是否正确？

无论如何，我希望会有一个快速的答案，但它似乎没有我希望的那么微不足道。如果您有任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-01T14:53:36.850

实际上，我在这里使用 DataMapper 中的事务找到了一个不错的解决方案。基本上，此事务尝试保存父对象以及所有子对象。一旦保存失败，事务就会停止并且不会创建任何内容。如果一切顺利，那么对象将成功保存。

```
class Project
  def make
    transaction do |trans|
      trans.rollback unless save
      tasks.each do |task|
        unless task.save
          trans.rollback
          break
        end
      end
    end
  end
end 
```

这可确保在保存任何内容之前一切都是有效的。我只需要在我的控制器代码中将我的#save 和#update 方法更改为#make。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T00:38:12.733

如果您的数据库引擎支持，则 SET CONSTRAINTS DEFERRED 可能很有用。

否则，可能会编写一个存储过程来进行插入，然后说它是存储过程的责任，以确保只插入正确的、经过验证的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T16:14:31.290

有一个模型方法`valid?`可以在保存模型对象之前对其进行验证。因此，验证关联的简单方法是使用`validates_with_block' or 'validates_with_method`检查关联的验证。

它看起来像这样

```
validates_with_block do
  if @tasks.all?{|t|t.valid?}
    true
  else
    [false, "you have an invalid task"]
  end
end 
```

或者您可以查看[dm-association-validator](http://github.com/roovo/dm-association_validator/)或[dm-accepts-nested-attributes](http://github.com/snusnu/dm-accepts_nested_attributes)

**编辑：**额外疯狂。对任务运行验证，然后检查是否唯一的错误是与关联相关的错误。

```
validates_with_block do
  if @tasks.all?{|t|t.valid?;!t.errors.any?{|e|e[0]==:project}}
    true
  else
    [false, "you have an invalid task"]
  end
end 
```

# objective-c - Mac OS X Server 下的“简单”应用服务器设置？

> ID：1004524
> 
> 赞同：1
> 
> 时间：2009-06-17T00:12:44.987
> 
> 标签：objective-c, json, macos, rest

借助 Mac OS X Server 包含的（或免费提供的）工具、Objective-C 的背景以及对脚本语言的一些生疏熟悉……如何在 Mac OS X Server 下“轻松”使用**REST** ful **JSON服务？**

这主要用于原型设计，因此简单性和 GUI 工具很有吸引力，但不会以牺牲强大的基础为代价。

编辑：挠痒痒看看雪豹是否有任何变化

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T00:36:21.083

**考虑简单地使用 Apache + PHP。** 稳定，快速，大量的知识和示例。而且您可能已经在您的服务器上运行它。

PHP 有一个 c'ish 语法，很容易上手。

请参阅此以获得运行它的帮助：http: [//foundationphp.com/tutorials/php_leopard.php](http://foundationphp.com/tutorials/php_leopard.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T00:41:01.340

这实际上取决于您对“简单”的基准。使用 OS X Server，您有很多选择：

*   使用 WebObjects，如果您想利用 Objective-C（或者甚至 Java，如果您了解 Java）的技能。
*   使用 PHP... Apache 和 PHP 是内置的。
*   使用 Python 和 Django/TurboGears/Twisted/Plone/WSGI/ModPython。
*   使用 Ruby 和 Rails。
*   就此而言，使用 Perl 和 CGI​​... 或任何语言和 CGI​​。
*   使用 Java 和 Tomcat。
*   使用 Java 和 Tomcat + JBoss。

在您的情况下，OS X Server 几乎支持任何东西，这既是福也是祸。哎呀，如果您愿意，您几乎甚至可以将 CGI 修补到 AppleScript 上（此外：我相信我们都只是对此感到畏缩 :-)）。OS X（客户端）和 OS X（服务器）有很多内置的免费选项。

对于 Apache 及其配置的默认安装，PHP 似乎是您最简单的选择，但 Ruby/Rails 或 Python 几乎都是开箱即用的。

# c# - SqlBulkCopy 错误处理/错误继续

> ID：1004525
> 
> 赞同：10
> 
> 时间：2009-06-17T00:13:34.953
> 
> 标签：c#, ado.net, sqlbulkcopy

我正在尝试将大量数据插入 SQL 服务器。我的目标表有一个名为“Hash”的唯一索引。

我想用 SqlBulkCopy 替换我的 SqlDataAdapter 实现。在 SqlDataAapter 中有一个名为“ContinueUpdateOnError”的属性，当设置为 true 时，adapter.Update(table) 将插入所有可能的行并使用 RowError 属性标记错误行。

问题是如何使用 SqlBulkCopy 尽快插入数据，同时跟踪哪些行被插入，哪些行没有被插入（由于唯一索引）？

以下是附加信息：

1.  该过程是迭代的，通常按计划重复。

2.  源表和目标表可能很大，有时有数百万行。

3.  尽管可以先检查散列值，但每行需要两个事务（首先从目标表中选择散列，然后执行插入）。我认为在 adapter.update(table) 的情况下，检查 RowError 比检查每行的哈希命中要快。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T01:05:04.163

SqlBulkCopy 的错误处理功能非常有限，默认情况下它甚至不检查约束。

但是，它很快，真的很快。

如果您想解决重复键问题，并确定批次中哪些行是重复的。一种选择是：

*   开始翻译
*   抓住桌子上的一个 tabblockx 选择所有当前的“哈希”值并将它们夹在一个 HashSet 中。
*   过滤掉重复项并报告。
*   插入数据
*   提交翻译

如果您要插入巨大的集合并且表中初始数据的大小不是太大，则此过程将有效地工作。

您能否扩展您的问题以包括问题的其余部分。

**编辑**

现在我有了更多的上下文，这是您可以解决的另一种方法：

*   将批量插入临时表。
*   启动可序列化的 tran
*   选择目标表中已经存在的所有临时行...报告它们
*   将临时表中的数据插入到真实表中，对散列执行左连接并包括所有新行。
*   提交 tran

这个过程在往返过程中非常轻松，并且考虑到您的规格最终应该非常快；

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-10T16:08:56.197

与已经建议的方法略有不同；执行`SqlBulkCopy`并捕获抛出的**SqlException**：

```
 Violation of PRIMARY KEY constraint 'PK_MyPK'. Cannot insert duplicate 
key in object 'dbo.MyTable'. **The duplicate key value is (17)**. 
```

然后，您可以从 ID 17（重复的第一条记录）中删除源中的所有项目。我在这里做出的假设适用于我的情况，可能不适用于你的情况；即重复是由上载期间由于 SQL/网络错误导致的先前失败的*完全相同的数据引起的。*`SqlBulkCopy`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T01:08:11.743

**注意：这是对 Sam 的回答的回顾，其中包含更多细节**

感谢山姆的回答。由于评论的空间限制，我已将其放入答案中。

根据您的回答，我看到了两种可能的方法：

解决方案1：

*   开始翻译
*   通过执行“在目标表中选择哈希，其中哈希在（val1，val2，...）
*   过滤掉重复并报告
*   插入数据
*   提交翻译

解决方案2：

*   创建临时表以镜像目标表的架构
*   批量插入临时表
*   启动可序列化事务
*   获取重复行：“从 tempTable 中选择哈希，其中 tempTable.hash=destinationTable.hash”
*   报告重复行
*   将临时表中的数据插入到目标表中：“select * into destinationTable from temptable left join temptable.hash=destinationTable.hash where destinationTable.hash is null”
*   提交 tran

既然我们有两种方法，那么归结为哪种方法最优化？两种方法都必须检索重复的行并报告，而第二种方法需要额外的：

*   临时表的创建和删除
*   另一个将数据从临时表移动到目标表的 sql 命令
*   取决于哈希冲突的百分比，它还会通过网络传输大量不必要的数据

如果这些是唯一的解决方案，那么在我看来，第一种方法会获胜。你们有什么感想？谢谢！

# javascript - 使用 Jquery 用图像替换值？

> ID：1004534
> 
> 赞同：1
> 
> 时间：2009-06-17T00:21:47.823
> 
> 标签：javascript, jquery, html

我有一个有很多评论的页面。

代码结构如下：

```
+ <li id="li-comment-65" class="comment even thread-odd thread-alt depth-1">
     <div class="comment-body">
        <div id="comment-65">
           <div class="comment-author vcard">
              <img height="30" width="30" href="" alt="" />                        
              <cite class="fn">keith</cite>                  
           </div>
           <div class="comment-meta commentmetadata">
              <a href="#">June 16, 2009 at 10:21 pm</a>
           </div>
           <div id="rating-65" class="rating-class">Excellent</div>
           <p>Hiya</p>
        </div>
     </div>
  </li> 
```

我想要做的是以下内容：

1.  从每个 'rating-class' 类中获取值。（最多有 5 个值：a. 优秀 b. 非常好 c. 好 d. 差 e. 非常差
2.  如果评级 == '优秀' - 显示 5 星图像并删除“优秀”文本
3.  如果评级 == '非常好' - 显示 4 星图像并删除“非常好”文字
4.  ...
5.  ...
6.  ETC

这很难做到吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T00:24:35.693

这应该这样做：

```
$('div.rating-class').each(function() {
    var value = $.trim($(this).text());
    var src;
    switch(value) {
        case 'Excellent':
            src = 'fivestars.png';
            break;
        case 'Very Good':
            src = 'fourstars.png';
            break;
        ...                     
    }
    $img = $('<img/>').attr('src', src);
    $(this).html($img);
}); 
```

更好的是做这样的事情：

```
$('div.rating-class').each(function() {
    var value = $.trim($(this).text()).replace(' ', '_').toLowerCase();
    $(this).addClass(value);
}); 
```

然后有这样的 CSS 类：

```
div.rating-class.excellent {
    background-image: url(fivestars.png);
    text-indent: -1000px;
}
div.rating-class.very_good {
    background-image: url(fourstars.png);
    text-indent: -1000px;
}
... 
```

文本缩进将隐藏您最初在那里的常规文本。

# java - 是否可以在 Java 中扩展没有构造函数的类？

> ID：1004539
> 
> 赞同：8
> 
> 时间：2009-06-17T00:25:01.357
> 
> 标签：java, inheritance, constructor, mocking

出于单元测试的目的，我正在尝试编写一个没有构造函数的类的[模拟对象](http://en.wikipedia.org/wiki/Mock_object)。

这在 Java 中是否可能，该类根本不可扩展吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-17T00:26:33.723

没有构造函数的类有一个隐式的公共无参数构造函数，是的，只要它不是最终的，它就可以被子类化。

如果该类只有私有构造函数，那么没有，它不能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T01:25:21.313

问题已回答，但要添加评论。这通常是建议将代码编写为可测试的好时机。

不要为此感到痛苦，研究它需要什么（至少可能是依赖注入），学习编写模拟并提出一套合理的指导方针，让类更有用。

我们只需要重写一堆单例来使用 DI，因为单例是出了名的难以模拟。

这可能不会很好，但在大多数专业商店中，一定程度的可测试性编码是标准的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T02:21:01.933

是的，您可以模拟该对象，尽管可能无法对其进行子类化（无论如何，如果不与类加载器非常亲密，当然不会）。[这](http://www.jmock.org/mocking-classes.html)是使用 JMock 的方法。

以这种方式模拟允许您保留类型，而无需子类化，尽管可能很难甚至不可能仅梳理出某些行为。所以这个方法适用于测试使用这个类的类，而不是测试类本身。

如果您实际上可以访问该类的源代码，则可以实现一个允许您扩展它的内部类，尽管如果可以这样做，您也可以将其中一个构造函数包设为私有。

还有一些动态语言允许您进行子类化，并实现 Java 代码可以与之交互的 Java 接口，但我对细节不太熟悉。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T00:28:10.803

如果 java 类没有任何定义的构造函数，那么对你来说没有问题。问题将是类是否定义了任何构造函数，并且所有构造函数对您都是不可见的（私有的）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T01:18:28.083

您可以通过反射更改可见性修改器。[这是一篇列出如何的文章](http://tutorials.jenkov.com/java-reflection/private-fields-and-methods.html)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-24T17:55:59.297

[您可以使用JMockit](http://code.google.com/p/jmockit)模拟该类及其任何或所有构造函数。

它是一个用于 Java 的模拟工具包，可让您模拟任何东西。即使该类是非公共的和/或嵌套的，它仍然可以被模拟。JMockit 中有几种机制可用于此目的。工具包发行版还包含许多示例 JUnit 测试。

如果该类实现了某个接口或扩展了一个抽象类，您可以告诉 JMockit 按需“捕获”和模拟基本类型的实现，因为它们是由 JVM 加载的，甚至可以将创建的实例分配给测试中的字段班级。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T01:15:48.400

如果只有私有构造函数，您仍然可以使用反射以便能够从该类外部访问它们。

# junit - 失败的哈德森建立在单一的单元测试失败

> ID：1004540
> 
> 赞同：5
> 
> 时间：2009-06-17T00:25:53.383
> 
> 标签：junit, hudson

如果只有一个单元测试失败，有没有办法让 hudson 将构建报告为失败，而不是不稳定？谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-20T23:27:00.043

Hudson 实际上可以忽略测试失败。它只需要作为财产放在哈德逊。-Dmaven.test.failure.ignore=false

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-23T16:25:10.777

如果在使用 hudson 时测试失败，那么构建失败实际上并不是一个好主意。问题是如果构建失败，hudson 不会报告测试通过/失败的状态。如果构建失败，hudson 认为它没有正确完成，因此不会对结果采取行动。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T01:30:48.773

junit 任务有两个属性

```
errorProperty="maven.test.error"
failureProperty="maven.test.failure" 
```

在 junit 标签之后，您应该可以执行以下操作

```
<fail message="Test failed!!!" if="maven.test.error" />
<fail message="Test failed!!!" if="maven.test.failure" /> 
```

但是不要把我钉在这上面

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T00:29:55.200

如果您使用 Ant 来驱动构建，您可以将 JUnit 任务配置为在失败时停止。你是这个意思吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T00:47:57.753

查看您的工作配置，我相信有一个属性（复选框）表示测试失败时失败，或者类似的东西。我们在我工作的一些项目中使用它。

否则，如果您想按照建议使用 Ant 方法，maven 可以运行 ant 任务...

# json - html中的json

> ID：1004545
> 
> 赞同：0
> 
> 时间：2009-06-17T00:27:28.403
> 
> 标签：json

（这可能是一个愚蠢的问题）

我正在使用 RESTful API 从数据库中获取数据，例如名字、姓氏等。API 为我提供 JSON 格式的数据，我想在网页中使用其中的一些数据。

例如，我想打印

欢迎名字姓氏。

使用来自 JSON 字符串的数据。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T00:30:33.170

JSON 是对象表示法。无论您使用哪种语言，您都应该能够找到一个可以在字符串和对象之间来回转换的 JSON 库。

如果您使用的是 JavaScript，[则此代码](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)应该可以工作。使用说明在[这里](http://www.json.org/js.html)。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-06-17T00:31:01.610

假设“myJSONtext”是格式良好的 JSON，您可以使用 eval 获取表示数据的对象：

var myObject = eval('(' + myJSONtext + ')')

# model-view-controller - 从模型层获取用户输入

> ID：1004548
> 
> 赞同：0
> 
> 时间：2009-06-17T00:28:19.633
> 
> 标签：model-view-controller, mvp

在遵循 MVP 或 MVC 设计模式（适用于任何一种）时遇到问题。我不知道如何从模型层清晰地提示用户输入？根据模型中的某些值，我可能需要在过程中间提示用户输入。

例如，我们将假设一个 PO 输入流程。假设用户点击视图中的按钮后，它会调用演示者从视图中传递 PO 详细信息。演示者然后调用模型来验证新 PO 并将其插入到 PO 集合中。模型中的一项验证检查是确保尚未输入具有相同项目的另一个采购订单。如果有，应用程序需要提示用户确认 PO 不是重复的。该应用程序目前已深入模型。如何一直返回视图以检索操作员输入，然后返回到模型代码停止的位置以完成 PO 输入过程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T04:59:47.833

您可能希望查看模型与 UI 模式的其他组件之间的某种形式的通知交互。

[Martin Fowler在这里](http://www.martinfowler.com/eaaDev/Notification.html)写过它。

至于深入模型，获取用户输入，然后返回模型：不要。您的控制器负责修改您的模型，并应在尝试更改模型之前进行验证。这可能需要将您的验证与更新代码分开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T00:43:41.133

在[我首先阅读的一篇关于 Presenter](http://www.atomicobject.com/pages/Presenter+First)的论文中，有人建议 Presenter 依赖于模型和视图，并订阅了来自模型和视图的事件。
这意味着您可以在处理无法继续时从模型中引发事件。演示者将通过调用视图上的某些方法（这将提示用户）来处理来自模型的事件。然后模型上方法的返回值将返回给模型（事件的输入/输出参数，如 .NET 使用的 EventArguments 子类）。

# iphone - iPhone消费restful WCF服务

> ID：1004553
> 
> 赞同：0
> 
> 时间：2009-06-17T00:31:51.453
> 
> 标签：iphone, wcf, rest

我目前有一个简单的 WCF 服务运行一个 get 请求，它返回 XML，[http](http://a446062738bb4f0aa2d8fd975aac602f.cloudapp.net/Service1.svc/GetALLPictures/10) ://a446062738bb4f0aa2d8fd975aac602f.cloudapp.net/Service1.svc/GetALLPictures/10 ...我试图使用 [NSString stringWithURL:] 来填充字符串XML 内容，但是这不起作用，我尝试使用 Unicode 和 UTF8 编码来获取字符串，但什么也没有，我已经在服务器上设置了 crossclient.xml，并且我在 silverlight 应用程序中以类似的方式使用了该服务。（我也使用 NSURLCONnection 和 NSURLRequest 尝试了以上所有方法）
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T02:06:38.860

你的意思是`+stringWithContentsOfURL:`？我没有看到任何问题：

```
NSString *xml = [NSString stringWithContentsOfURL:
   [NSURL URLWithString:
@"http://a446062738bb4f0aa2d8fd975aac602f.cloudapp.net/Service1.svc/GetALLPictures/10"]]; 
```

它返回这个：

```
<GetAllPicturesResponse xmlns="http://tempuri.org/">
<GetAllPicturesResult 
xmlns:a="http://schemas.datacontract.org/2004/07/TestCloudService_WebRole"
xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
<a:Coordinate><a:latitude>0</a:latitude><a:longitude>0</a:longitude>
</a:Coordinate><a:Coordinate><a:latitude>-50</a:latitude>
<a:longitude>-80</a:longitude></a:Coordinate></GetAllPicturesResult>
</GetAllPicturesResponse> 
```

除非您在后台线程上执行此操作，否则您会想要使用`NSURLConnection`它，但这似乎很好。

# asp.net - 为什么 WebControl 事件的前缀是“On”？

> ID：1004556
> 
> 赞同：6
> 
> 时间：2009-06-17T00:32:23.650
> 
> 标签：asp.net, events, webforms

我试图完全理解 WebForm 事件模型（不是页面生命周期，而是在 .aspx 或 .ascx 文件中以声明方式指定事件时如何连接事件。

以 Button 控件为例。它有一个 Click 事件，您可以在代码隐藏中连接到该事件，但它在 .aspx/.ascx 文件中有一个“OnClick”事件。

我使用了 .NET Reflector 并且 Button 控件有一个 PROTECTED OnClick 方法，但这不应该由 .aspx/.ascx 分配。除非我错过了什么。

有谁知道为什么要添加“开”前缀？

澄清一下：我理解命名约定是有效的。我想知道 .aspx/.ascx 中的“OnClick”如何翻译成 .Click += new EventHandler(blahName); 即，如果我创建一个 ControlChanged EventHandler，我是否需要做任何特别的事情才能让 OnControlChanged 有效地显示在 .aspx/.ascx 文件中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T00:36:19.570

这些存储对调用代码将使用事件连接的委托的引用；为了区分事件本身和委托。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T13:20:00.833

这不仅仅是一个命名约定，因为用户控件中的事件会自动获得声明性语法中的“On”前缀。

例如，我有一个声明 ProjectSelected 事件的 UserControl。为了以声明方式添加处理程序，我设置了 OnProjectSelected 属性。

用户控制：

```
 public event EventHandler<ProjectSelectedEventArgs> ProjectSelected; 
```

以声明方式添加处理程序：

```
 <user:ProjectList id="uxProjectList" runat="server"
            OnProjectSelected="uxProjectList_ProjectSelected" /> 
```

在后面的代码中添加处理程序：

```
 uxProjectList.ProjectSelected += uxProjectList_ProjectSelected; 
```

这让我很困惑两次，一次是我无法弄清楚为什么事件不能以声明方式使用，另一次是我将事件命名为“OnProjectSelected”并且属性变为“OnOnProjectSelected”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T00:37:33.813

这只是引发事件时使用的命名约定。OnSomethingHappened ... OnClick、OnChange、OnClose。我不认为有什么神奇或险恶的，这只是一种约定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T00:37:47.807

从语义上讲，它基本上是对 VB 传统的一种旧回归，其中事件侦听器通常被称为 OnWhatever。旧习难改。

# c# - 有没有办法指定与 SQLServer 管理对象脚本一起使用的日期格式

> ID：1004557
> 
> 赞同：0
> 
> 时间：2009-06-17T00:32:37.503
> 
> 标签：c#, .net, sql-server, vb.net

当我为我的项目生成数据库脚本时，我想管理 SQLScript 注释中使用的日期格式。

我将区域设置设置为澳大利亚格式，但它们似乎被忽略了。

```
Imports Microsoft.SqlServer.Management
...
        Dim scr As Smo.Scripter
        Dim opt As Smo.ScriptingOptions

...
        opt = New Smo.ScriptingOptions
        opt.???? =  //Is there something that I can set to control the date?
        opt.Encoding = Encoding.ASCII
        opt.DriAll = True
        opt.ClusteredIndexes = True
        opt.Default = True
        opt.Indexes = True
        opt.IncludeHeaders = True
        opt.AppendToFile = True 
```

结果脚本中的注释看起来像这样......请注意，日期采用美国格式。

```
 /****** Object:  Table [dbo].[AAAExampleData]    Script Date: 06/17/2009 10:08:38 ******/
    SET ANSI_NULLS ON 
```

我知道评论只是为了便于阅读，但我想完全控制我的输出。

如果不可能，请直说。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T02:04:03.887

我建议您将此作为错误报告给 Microsoft：[http](http://connect.microsoft.com/sqlserver/) ://connect.microsoft.com/sqlserver/ 。先搜索看看有没有其他人举报过。非英语人士可能会报告此情况；你只是想改变字段的顺序，其他人需要改变语言和字符集！

输入错误报告后，请编辑您的问题以包含指向它的链接。我们感兴趣的各方可以对您的错误报告进行投票。

# compact-framework - Rhino 模拟和紧凑框架

> ID：1004560
> 
> 赞同：5
> 
> 时间：2009-06-17T00:33:44.880
> 
> 标签：compact-framework, mocking, rhino-mocks

我一直在尝试使用 Rhino Mocks 对我的 .Net Compact Framework 应用程序进行单元测试，但遇到了问题。我可以使用构建的 Rhino Mocks 进行基本单元测试，但是每次我运行包含 Rhino Mocks 代码的测试时，测试都会失败，因为它找不到 Rhino Mocks 程序集。

System.TypeLoadException：无法从程序集 'Rhino.Mocks... 加载类型 'Rhino.Mocks.MockRepository'

我已将 rhino mocks dll 复制到设备上的各个位置（我的 app 文件夹和创建的 SmartDeviceTest 文件夹），但似乎仍然找不到它。

有没有人在紧凑的框架中使用 rhino mocks 并且可以指出我正确的方向？或者如果做不到这一点，任何人都可以建议一个可以集成并与紧凑框架一起使用的模拟框架吗？

谢谢

马特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T02:01:52.767

我敢打赌，它找不到依赖项。IIRC，Rhino 使用了很多在 CF 中根本不存在的 CompilerServices 和 Reflection.Emit 片段，因此在尝试生成模拟时可能会呕吐。我还没有看到任何适用于 CF 的模拟框架，并且我已经做了很多查找（并尝试移植）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-01T19:30:45.040

几个月前我写了一篇博客文章：http: [//elegantcode.com/2009/04/29/unit-testingmocking-on-net-cf/](http://elegantcode.com/2009/04/29/unit-testingmocking-on-net-cf/)

无论如何，RhinoMocks、Moq 和 TypeMock 不能在 .netcf 上运行。PEX（微软研究项目）的存根在理论上可以工作，但还没有。

关键是制作存根类而不是模拟类（谷歌搜索“模拟不是存根”）

# iphone - 设置 View Controller ivar 的最佳位置是什么？

> ID：1004562
> 
> 赞同：2
> 
> 时间：2009-06-17T00:34:06.363
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, variables

我有一个使用 URL 初始化的 XML 阅读器类

```
- (id)initWithURL:(NSURL *)url 
```

此类使用实例变量将对象添加到调用类中的数组

```
// in the interface
ViewController *viewController;
// in the implementation
[viewController addObject:theObject]; 
```

现在，我初始化我的 XML 阅读器类，然后分别设置视图控制器：

```
XMLController *xmlController = [[XMLController alloc]
                    initWithURL:url];
xmlController.viewController = self; 
```

我的问题是我是否应该创建一个新的 init 函数来同时设置 viewController。谢谢。

**编辑：**我忘了添加我的 XML 阅读器开始下载和解析 init 函数中的类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T00:42:36.330

这完全取决于你。您可以在 Apple 的代码中看到这两种样式的示例。

只要您不对 viewController 属性的值随着时间的推移保持不变做出任何假设，保持原样应该没问题。

顺便说一句，您可能会考虑将 addObject: 逻辑重构为协议，而不是需要特定的子类。就像是：

```
-xmlController:didDecodeObject: 
```

或者任何对您的 XMLController 对象的逻辑有意义的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T02:28:28.767

如果您的 init 例程将导致委托/控制器调用，或引发可能向委托发送消息的异步活动（可能包括您的下载），那么您应该将其包含在 init 函数中。

否则，您的控制器可能会错过可能在您的 initWithURL 例程返回之前调用的潜在委托消息，例如 xmlController:didStartConnection。

此外，如果控制器/委托是 XMLController 活动的必需部分，那么您应该将它包含在您的 init 例程中。

所以是的，在这种情况下，我建议：

```
XMLController *xmlController = [[XMLController alloc] initWithURL:url andController:self]; 
```

# xml - AS2：禁用隐藏的动态文本字段和 MovieClip 子项中的链接

> ID：1004577
> 
> 赞同：0
> 
> 时间：2009-06-17T00:40:01.793
> 
> 标签：xml, text, actionscript-2, movieclip

问候！

我正在一个带有 MovieClips 的 AS2 网站上工作，用于在单击导航时交换深度的页面。文本内容从外部 XML 文件中动态提取并通过 CSS 设置样式，包括链接 (HTML/CDATA)。我的问题是这样的：

当一个页面通过 隐藏在另一个页面之后时`swapDepths()`，隐藏页面中的 HTML 链接仍然可以用手形光标单击。我在内容的父剪辑上尝试了 mc.enabled=false，但它对动态文本字符串没有影响。有谁知道如何使用 Actionscript 2 禁用 CDATA 链接？

一般来说，MovieClip 子级也有同样的问题：如何在 AS2 的父剪辑中禁用movieClips 而无需硬编码实例名称？

在此先感谢您的任何建议！

这是我控制页面交换的代码：

```
// class code.Startup() :

      page_arr = new Array(); // references clips laid out in the IDE
      page_arr = [
            ['home', pages.homePage_mc],
            ['apartments', pages.apartmentsPage_mc],
            ['building', pages.buildingPage_mc],
            ['neighborhood', pages.neighborhoodPage_mc],
            ['press', pages.pressPage_mc],
            ['team', pages.teamPage_mc],
            ['retail', pages.retailPage_mc],
            ['office', pages.officePage_mc],
            ['contact', pages.contactPage_mc]
      ]

// class code.Navigation() :

private function showPage(num):Void {
        turnOffAllPages();

        if(siteFirstRun == true){ 
          prevPageObj = code.Startup.getInstance().page_arr[0][1]; 
                //defaults to homepage, already showing
          currPageObj = code.Startup.getInstance().page_arr[num][1]; 
                //sets currPageObj to whatever page was chosen with nav 
          siteFirstRun = false;
        }
        else {      
          if(currPageObj !== prevPageObj){
              prevPageObj = currPageObj;
          }
          currPageObj = code.Startup.getInstance().page_arr[num][1];
        }

      TweenLite.to(code.Startup.getInstance().page_arr[num][1], .25, {_alpha:100, ease:'easeOutQuad', delay:.25});

      if(prevPageObj !== undefined){
             currPageObj.swapDepths(code.Startup.getInstance().pages.getNextHighestDepth());
      }
      currPageObj.copy_mc.enabled = true;

      }

// Each page_arr clip contains a 'copy_mc' instance into which XML content is fed. These are what I need to target!

private function turnOffAllPages():Void{
      for(i=0; i<code.Startup.getInstance().numPages; i++){
        code.Startup.getInstance().page_arr[i][1].copy_mc.enabled = false; 
         // disable pages to avoid rolling over hidden links

         TweenLite.to(code.Startup.getInstance().page_arr[i][1], .2, {_alpha:0, ease:'easeOutQuad'});
      }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T00:55:08.440

我会建议两种方法来解决您的问题：

1) 将隐藏的影片剪辑移动到屏幕外的位置（即将 _x 和 _y 设置为舞台之外的某个位置）

2) 在隐藏的 mc 顶部附加一个拦截器动画剪辑或按钮，这样它就不会接收任何鼠标事件。当它再次变为未隐藏时，请移除阻止程序影片剪辑或按钮。

# java - Java 客户端使用 DIME 附件调用 WSE 2.0

> ID：1004586
> 
> 赞同：1
> 
> 时间：2009-06-17T00:45:34.310
> 
> 标签：java, .net, web-services, axis, ws-security

我需要与将 WSE 2.0 用于 WS-Security 和 DIME 的旧版 .NET Web 服务集成。问题是我需要从 Java 应用程序中执行此操作。

我期待 Axis2 与 WS-Security 一起工作得很好，因为这里的人以前也做过。我担心的是 DIME。[我在http://ws.apache.org/axis/java/client-side-axis.html](http://ws.apache.org/axis/java/client-side-axis.html)看到了对 DIME 的引用，但我想知道是否有人实际上使用 Axis 和 WSE 2.0 Web 服务完成了这项工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-01-19T10:32:12.843

一年前我对该主题的调查和实验表明，Axis 2 不支持 DIME 附件，尽管文档中有一些不清楚的注释和代码中的定义。现在文档已清理完毕，并且没有任何关于 DIME 支持的说明。但是 Axis 1.4 可以使用 DIME 附件。如果您不能强制您的合作伙伴升级他们的服务以支持 MTOM/XOP，请将您的 Axis 库降级到 1.4。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T02:15:15.190

根据自己的经验，我不能肯定地告诉你任何事情。并且“网络”上的每一页似乎都说明了与这个问题不同的东西。

因此，将所有这些放在一起是可能的

1.  一角支持从 1.x 下降到 2.x
2.  2.x 中有某种支持，可能是不稳定的
3.  支持就在那里
4.  根本没有支持
5.  提供的链接之一提供了足够的洞察力/代码示例，以获得有用的东西

指向“Axis 2.0 是否支持 Dime”的链接？

[不，你必须切换回 1.4](http://www.mail-archive.com/axis-user@ws.apache.org/msg33083.html)

[没有什么人](http://osdir.com/ml/axis-user-ws.apache.org/2009-05/msg00259.html)

[一角钱格式的大附件](http://mail-archives.apache.org/mod_mbox/ws-axis-user/200701.mbox/%3cBAY133-DAV468A5BA91D05A54768084AEB90@phx.gbl%3e)->顺便说一句，2009 年说他自 2002 年以来从未听说过一角钱的同一个人

[Axis 1.x 到 Axis 2.1 端口 Dime](http://www.mail-archive.com/axis-user@ws.apache.org/msg21674.html) -> 又是同一个人 2006 年发布了一些看起来像端口的东西

从一些 Adob​​e Docu 站点[创建使用 DIME 的 Apache Axis Java 代理类](http://livedocs.adobe.com/livecycle/8.2/programLC/programmer/help/wwhelp/wwhimpl/common/html/wwhelp.htm?context=sdkHelp&file=001510.html)

[J2EE Web Service Development with Attachments Using Axis](http://roseindia.net/webservices/web-services-development.shtml) -> 迄今为止我发现的唯一真正的教程。但使用 Axis 1.2.1

[AttachmentProblems](http://wiki.apache.org/ws/FrontPage/Axis/AttachmentProblems) -> An Axis Wiki page 说明 Dime 附件文件的问题 > 1 MB

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-09T18:27:32.487

WSE 2.0 已经过时了。如果您必须继续使用过时的软件，那么您至少应该升级到 WSE 3.0，它已经过时了一些。

# iphone - NSNotificationCenter：对象是否在它们发布的同一线程上接收通知？

> ID：1004589
> 
> 赞同：18
> 
> 时间：2009-06-17T00:47:43.933
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, nsnotifications

我很想知道在发布对象的方法完成和删除之前，我是否可以期望观察对象的方法被推入堆栈。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-06-17T00:54:33.637

简短的回答是肯定的......“常规通知中心在发布通知的线程上传递通知。分布式通知中心在主线程上传递通知”。

但是，Apple 有关于这个主题的文档，您可能会觉得很有帮助，并且从中提取了上述引用：

[通知编程主题：向特定线程传递通知](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Notifications/Articles/Threading.html#//apple_ref/doc/uid/20001289-CEGJFDFG)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-17T00:53:13.750

自己也懒得查了，惭愧：

来自类参考： NSNotificationCenter 同步发布所有通知

此外，如果您愿意，可以使用 NSNotificationQueue 异步发布通知

# c# - 添加依赖于sql表的控件？

> ID：1004595
> 
> 赞同：0
> 
> 时间：2009-06-17T00:50:05.550
> 
> 标签：c#, .net, asp.net, dynamic

大家好，我正在做一个小项目，我正在根据 SQL 问题表向页面添加控件，这个表会随着时间的推移而增长。我只是想分享代码，看看是否有更好的方法，或者是否有任何专家可以插话并给我对未来问题的任何见解。这是代码：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        try
        {

            SqlParameter[] paramz = new SqlParameter[1];
            paramz[0] = new SqlParameter("@c_id", 1);

            dt = SqlHelper.ExecuteDataTable(ConfigurationManager.ConnectionStrings["sql"].ToString(), CommandType.StoredProcedure, "get_Questions", paramz);
            clinicName.Text = "<b>" + dt.Rows[0]["Clinic Name"].ToString();

            for(int row = 0; row <= dt.Rows.Count; row++)
            {
                if (row == dt.Rows.Count) //if we're on the last question put a break for spacing(this could be fixed with styling)
                {
                    Literal alit = new Literal();
                    alit.Text = "<br/>";
                    questionsPanel.Controls.Add(alit);
                }
                else
                {
                    addQuestion(dt.Rows[row], row);
                }
            }

        }
        catch (Exception err)
        {
            Response.Write(err.Message);
        }

    }

    private void addQuestion(DataRow row, int i)
    {
        Label lbl = new Label();
        lbl.Text = row["question"].ToString();
        questionsPanel.Controls.Add(lbl);

        Literal lit = new Literal();
        lit.Text = "<br/>";
        questionsPanel.Controls.Add(lit);

        TextBox txt = new TextBox();
        txt.ID = "txt" + i.ToString();
        questionsPanel.Controls.Add(txt);

        Literal lit2 = new Literal();
        lit2.Text = "<br/>";
        questionsPanel.Controls.Add(lit2);

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T01:03:18.643

使用中继器控件：

ASPX 代码：

```
<asp:Repeater id="repData" runat="server">
    <ItemTemplate>
        <asp:Label id="lblQuestion" runat="server" Text='<%# DataBinder.Eval(Container.DataItem, "question") %>' />
        <br />
        <asp:TextBox id="lblAnswer" runat="server" />
    </ItemTemplate>
    <FooterTemplate>
        <br />
    </FooterTemplate>
</asp:Repeater> 
```

后面的代码：

```
// Populate repeater
SqlParameter[] paramz = new SqlParameter[1];
paramz[0] = new SqlParameter("@c_id", 1);
dt = SqlHelper.ExecuteDataTable(ConfigurationManager.ConnectionStrings["sql"].ToString(), CommandType.StoredProcedure, "get_Questions", paramz);

repData.DataSource = dt;
repData.DataBind(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T01:04:21.573

如果控件使用 ViewState 或对 ViewState 有贡献，那么您必须确保在每次回发时以相同的顺序将相同的控件添加到 ViewState。对象添加到 ViewState 的顺序取决于控件树中控件的顺序。

# vb.net - 更新驻留在 SharePoint 文件夹中的 Word 文档的服务器属性时出现问题

> ID：1004598
> 
> 赞同：0
> 
> 时间：2009-06-17T00:52:07.357
> 
> 标签：vb.net, sharepoint, ms-word

使用 Word 2007 中的 Office 自动化，我查看了*文档信息面板*，向我显示了位于 SharePoint 位置的文档的属性。

使用 VS 2008，我在即时窗口中询问以下内容：

```
? WordDocument.CustomDocumentProperties(23).Value
"My App Name Here" {String}
    String: "My App Name Here" 
```

然后我询问属性的名称：

```
? wordDocument.CustomDocumentProperties(23).Name
"Process Name" {String} 
```

当我输入组合框并将值更改为“YYY”并查询 tghe 属性的值时：

```
? WordDocument.CustomDocumentProperties(23).Value
"YYY" {String}
    String: "YYY" 
```

但是，当我执行以下操作时：

`WordDocument.CustomDocumentProperties(23).Value = "New Value"`并重新查询我看到该值已存储的属性的值：

```
? WordDocument.CustomDocumentProperties(23).value
"New Value" {String}
    String: "New Value" 
```

..但我没有看到屏幕有相应的变化。

但是，我确实看到，在高级属性/自定义选项卡上，名为“进程名称”的自定义属性已记录为值“新值”

“服务器”和“自定义”属性之间似乎存在某种单向映射，但真正奇怪的部分是：

我可以更新一些服务器属性，其他我不能。

除了作为一个愚蠢的用户之外，我对 SharePoint 一无所知。从我公司的 SharePoint 管理员那里获得*任何*帮助可能是一个很长的机会......

我检查了 Word 的所有内置属性和自定义属性，我认为它们都不能用于更新“进程名称”“服务器”属性。

我该如何更新这个顽固的属性？大多数服务器属性我可以更新，一些我不能。

我看到一些文章提到使用看起来像“SharePoint 对象”的东西。我是否需要下载 SDK 来填充这些属性？到目前为止，我使用的是 Office 自动化，因为我在用户的 PC 上本地运行并使用 Word 对象模型预填充文档。

在我将文档复制到 Sharepoint 文件夹后，剩下的就是完成最后几个服务器属性的填充。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T01:32:51.173

您的问题来自 SharePoint 如何将其属性映射到 Office 2007 文档，反之亦然。

理想情况下，您将导航到网站和文档存储位置列表。（例如，将[http://intranet/[somesharepointstuff]/mydocument.docx 缩短](http://intranet/[somesharepointstuff]/mydocument.docx)为[http://intranet/[somesharepointstuff]](http://intranet/[somesharepointstuff])）。

如果显示页面，您将能够找到您的文档并希望在那里编辑一些属性。

这种编辑文档的能力可能取决于您的安全访问权限。

这样做将允许您“查看”文档的哪些属性设置为可以通过使用进行编辑，哪些不是。

# image - 如何在 Expression Blend 中裁剪图像？

> ID：1004599
> 
> 赞同：4
> 
> 时间：2009-06-17T00:53:02.017
> 
> 标签：image, expression-blend

我知道这更倾向于设计师问题，但是当我面临开发需要裁剪图像的东西时，我想我会试一试这个问题。

这似乎是一个荒谬的问题，但我已经查看了整个 IDE（Expression Blend 2），试图找到一种方法来裁剪我的图像，但我无法弄清楚。

这似乎与[Joel 的问题](https://stackoverflow.com/questions/1003841/how-do-i-move-the-turtle-in-logo)非常一致，并且在[Podcast 58](http://itc.conversationsnetwork.org/shows/detail4148.html)中进行了讨论，因为在 Expression Blend 中进行设计时我**完全是个菜鸟。**我非常有兴趣找出最有效的方法来做到这一点。我发现一篇文章描述了一个你可以经历的工作流程，它会产生一个作物，我在下面添加了一个答案，但我**真的**希望其他人会知道一种更快（更少点击）的方式来做一些微不足道的事情像这样。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-22T07:38:20.297

据我所知，没有办法直接在表情混合中裁剪图像。Blend 不是图像编辑应用程序。为此，您需要另一个工具。

但是，如果您只想显示图像的一部分，您可以做的是剪裁图像。只需在其顶部添加一个矩形，右键单击它，转到*path* -> *make clipping path*。 [替代文字 http://img200.imageshack.us/img200/7370/example1.jpg](http://img200.imageshack.us/img200/7370/example1.jpg)

现在从要应用剪辑的列表中选择 System.Windows.Controls.Image 条目，然后点击*确定*

您甚至可以使用圆角矩形、圆形和自定义路径进行剪辑，但在大多数情况下，矩形就可以解决问题。

**只是碰到了另一种方式**。看看这个[问题](https://stackoverflow.com/questions/1028519/trying-to-change-a-croppedbitmaps-sourcerect-at-runtime)。它使用 CroppedBitmapClass 作为图像的来源。它不是 Blend 中的实际绘图，但您可以通过手动编辑 Xaml 添加它。根据您的问题，不清楚您是在 Expression Blend 中创建 Silverlight 还是 WPF 应用程序。CroppedBitmapClass 仅在 WPF 中可用。

**使用新的 Silverlight 3**，您可以使用[WritableBitmap](http://programmerpayback.com/2009/07/12/cropping-an-image-in-silverlight-3/)进行图像裁剪：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T00:58:02.960

我找到了一篇文章，里面有图片裁剪的步骤，但是做这么简单的操作就很费劲了。您会认为 MS Paint 只需单击几下按钮即可完成的操作在 Blend 中同样简单。

这是[链接](http://www.developingfor.net/expression/design/simple-image-cropping-in-expression-design.html)。

但是，我仍然想知道是否有更简单的方法可以做到这一点。

这种方法的另一个问题是，之后，我无法更改用于裁剪图像的矩形的大小，这是我需要能够做到的，因为我必须让图像的确切数量像素的宽度和高度。

# java - 执行动态创建的文件

> ID：1004601
> 
> 赞同：1
> 
> 时间：2009-06-17T00:53:14.700
> 
> 标签：java, file-io

```
import java.io.*;

public class Demo{

    public static void main(String[] args){
        File f = new File("abc.txt") ;

        try{
            System.setOut(new PrintStream( new FileOutputStream(f) ) ) ;
        }
        catch(FileNotFoundException fnfe){
            System.out.println(fnfe.getMessage()) ;
        }

        System.out.println("Hello\n") ;

        try{
            //throwing exception,
            //is there any method to close the f File,
            //before we try to open the file referred by f.
            Process p = Runtime.getRuntime().exec(f.getPath()) ;
        }
        catch(IOException io){
            System.out.println(io.getMessage()) ;
        }
    }

} 
```

**而执行Demo后abc.txt的内容为：-**

你好

无法运行程序“abc.txt”：CreateProcess 错误=32，该进程无法访问该文件，因为它正被另一个进程使用

**如何避免异常......**

正如这里的许多人所建议的那样，我尝试了以下代码，但遗憾的是，即使这样也会抛出异常...... :-(

```
import java.io.*;

class Demo{

    public static void main(String[] args){
        File f = new File("abc.txt") ;

        FileOutputStream fos = null ;
        try{
            fos = new FileOutputStream(f) ; 
        }
        catch(FileNotFoundException fnfe){
            System.out.println(fnfe.getMessage()) ;
        }

        PrintStream ps = new PrintStream(fos) ;
        ps.println("Hello") ;

        try{
            fos.close() ;

            //throwing exception again
            Process p = Runtime.getRuntime().exec(f.getAbsolutePath()) ;
        }
        catch(IOException io){
            System.out.println(io.getMessage()) ;
        } 
    }
} 
```

？？？？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T02:17:39.303

我假设调用 Runtime.getRuntime().exec(f.getPath()); 的原因 是在文本编辑器中打开 abc.txt 文件。最好提供用于打开文本编辑器的完整命令以及文件路径。我用notepad.exe（windows）试过这个，它奏效了。

```
import java.io.*;

public class Demo{

    public static void main(String[] args){
        File f = new File("abc.txt") ;

        try{
                System.setOut(new PrintStream( new FileOutputStream(f) ) ) ;
        }
        catch(FileNotFoundException fnfe){
                System.out.println(fnfe.getMessage()) ;
        }

        System.out.println("Hello\n") ;

        try{
                Process p = Runtime.getRuntime().exec("notepad.exe " + f.getPath()) ;
        }
        catch(IOException io){
                System.out.println(io.getMessage()) ;
        }
    }

} 
```

以下代码动态生成java代码并使用javac编译

```
import java.io.*;

public class Demo{

    public static void main(String[] args){

        File f = new File("Abc.java") ;
        PrintWriter writer = null;
        BufferedReader reader = null;
        InputStream pStream = null;

        try{
                // Open File Stream and write code
                writer = new PrintWriter( new FileOutputStream(f) );
                String javaCode = "public class Abc { \r\n" +
                                  "public static void main(String[] args) {\r\n" +
                                  "System.out.println(\"Hello World!\");\r\n" +
                                  "}\r\n" +
                                  "}\r\n";

                writer.println(javaCode) ;
                writer.close();

                // Run Javac to compile the code
                Process p = Runtime.getRuntime().exec("javac " + f.getPath()) ;
                p.waitFor();

                // status = 0 => Process executed without errors
                //        = 1 => Process executed with errors
                int status = p.exitValue();
                if( status ==  0 )
                {
                    pStream = p.getInputStream();
                }
                else
                {
                    pStream = p.getErrorStream();
                }

                // Display the output from the process
                reader = new BufferedReader(new InputStreamReader(pStream));
                String ln = null;
                while( (ln = reader.readLine()) != null )
                {
                    System.out.println(ln);
                }
        }
        catch(Exception ex){
                System.out.println(ex.getMessage()) ;
        }
        finally{
            try{
               if( writer != null ){writer.close();}
                if( pStream != null ){pStream.close();}
                if( reader != null ){reader.close();}
            }
            catch(Exception ex){
                System.out.println(ex.getMessage()) ;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T00:58:47.280

在执行之前关闭文件（并且不要重定向 System.out）：

```
f = new File("abc.txt");
FileOutputStream fos = new FileOutputStream(f);

// You would likely use fos.write instead, but here we go
PrintStream ps = new PrintStream(fos);
ps.println("Hello\n");

fos.close();

Process p = Runtime.getRuntime().exec(f.getPath()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T01:37:04.627

1.  您的程序创建的是文本文件，而不是可执行文件。可执行文件是操作系统知道如何执行的二进制文件（或在某些情况下是带有特殊头的脚本）。我不确定当您执行内容为“Hello\n”的文本文件时会发生什么。

2.  您正在将标准输出（标准输出）重定向到您的文件。稍后，您将异常堆栈跟踪打印到标准输出，这就是跟踪出现在您的文件中的原因。直接写入文件可能更有意义，而不是重定向标准输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T02:21:08.860

假设您在 Windows 上运行，而不是

`Process p = Runtime.getRuntime().exec(f.getPath());`

你可以使用

`Process p = Runtime.getRuntime().exec("start " + f.getPath());`

它应该选择与 .txt 文件关联的任何应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T00:55:43.370

在您尝试执行它之前关闭`FileOutputStream`（或）。`PrintStream`

# wpf - 苹果酒设计器中的 Viewbox 隐藏“框”中的所有控件

> ID：1004605
> 
> 赞同：0
> 
> 时间：2009-06-17T00:56:08.737
> 
> 标签：wpf, viewbox

当我将 Viewbox 作为 WPF 窗口的子元素放置时，Cider Designer “隐藏”所有内部控件，文本“Viewbox”仅出现在显示屏上。

为什么？这个布局有问题吗？是否有更好的布局可以在画布上实现可缩放图像？

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Background="Green" Width="900" Height="700">
    <Viewbox Stretch="Uniform">
        <Canvas Height="600" Width="800">
            <Image Canvas.Left="74" Canvas.Top="83" Name="image1" Source="/WpfApplication1;component/bitmap20.bmp" />
            <Image Canvas.Left="84" Canvas.Top="103" Name="image2" Source="/WpfApplication1;component/bitmap21.bmp" />
            <Image Canvas.Left="94" Canvas.Top="123" Name="image3" Source="/WpfApplication1;component/bitmap22.bmp" />
            <Image Canvas.Left="104" Canvas.Top="143" Name="image4" Source="/WpfApplication1;component/bitmap23.bmp" />
            <Image Canvas.Left="114" Canvas.Top="163" Name="image5" Source="/WpfApplication1;component/bitmap24.bmp" />
            <Image Canvas.Left="124" Canvas.Top="183" Name="image6" Source="/WpfApplication1;component/bitmap25.bmp" />
            <Image Canvas.Left="134" Canvas.Top="203" Name="image7" Source="/WpfApplication1;component/bitmap26.bmp" />
            <Image Canvas.Left="144" Canvas.Top="223" Name="image8" Source="/WpfApplication1;component/bitmap27.bmp" />
        </Canvas>
    </Viewbox>
</Window> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T04:48:19.540

你偏爱 Canvas 有什么特别的原因吗？

您可以将图像直接放在 Grid 中，使用 Stretch="Uniform" 如下所示：

```
 <Grid>  
    <Grid.ColumnDefinitions>
      <ColumnDefinition></ColumnDefinition>
...
      <ColumnDefinition></ColumnDefinition>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition></RowDefinition>
...
      <RowDefinition></RowDefinition>
    </Grid.RowDefinitions>
    <Image Grid.Column="0" Grid.Row="0" Source="/WpfApplication1;component/bitmap20.bmp" Stretch="Uniform"></Image>
    <Image Grid.Column="0" Grid.Row="1" Source="/WpfApplication1;component/bitmap21.bmp" Stretch="Uniform"></Image>
    <Image Grid.Column="1" Grid.Row="0" Source="/WpfApplication1;component/bitmap22.bmp" Stretch="Uniform"></Image>
...
...
  </Grid> 
```

并且由于 Grid 会自动拉伸到其容器的大小，因此您的图像将在布局中自动增长/缩小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:14:34.157

你是对的，这只是VS2008的一个限制。VS2010 解决了这个问题。

同时，我使用了[Expression Blend 3 Preview](http://www.microsoft.com/downloads/details.aspx?FamilyID=A04AA0AE-87BE-4201-A65E-E792859122FC&displaylang=en)，它支持视图框，而且似乎比 Visual 的 Cider 运行得更快。我认为 Blend 3 预览版将持续到 9 月 9 日。

# java - 安全登录背后的android网络抓取

> ID：1004611
> 
> 赞同：0
> 
> 时间：2009-06-17T00:59:32.440
> 
> 标签：java, android

我一直在为此绞尽脑汁，我已经设法`https`使用 android sdk，特别是`org.apache.http library`.

一切似乎都很好，因为我从服务器返回的响应是 200 OK。

但是，我不知道如何抓取登录后面的页面。apache 库似乎面向服务器`requests/repsonses`，所以问题是我怎样才能`html`使用`android sdk`?

示例代码将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T14:31:58.210

使用 HttpClient 的示例，包括使用 ResponseHandler，可以在以下位置找到：

[http://hc.apache.org/httpcomponents-client/examples.html](http://hc.apache.org/httpcomponents-client/examples.html)

# c# - phxsoftware System.Data.SQLite DbDataReader 行为不端

> ID：1004620
> 
> 赞同：1
> 
> 时间：2009-06-17T01:02:44.853
> 
> 标签：c#, .net, sqlite, idatareader

以下帖子与 phxsoftware ( [http://sqlite.phxsoftware.com](http://sqlite.phxsoftware.com) )的 System.Data.SQLite 数据提供程序有关

我对 DbDataReader 的 Read 方法和/或 Visual Studio 2008 有疑问（也可能是问题）。在许多示例中，我看到如下内容（我知道这段代码没有多大意义……但它提供了一个目的）：

```
DbDataReader reader = null;
Long ltemp = 0;
lock (m_ClassLock)
{
   DbCommand cmd = dbCnn.CreateCommand();
   cmd.CommandText = “SELECT col1 FROM table1”;
   reader = cmd.ExecuteReader();

   if (null != reader)
   {
      while (reader.Read())
      {
         ltemp += (long)reader[0];
      }
   }
reader.Close(); 
```

第一个问题 - 我从这个例子中不明白的是我第一次通过调用 reader.Read() 在 while 循环中丢失数据吗？例如，如果读取器具有值 (3,5,7,9)，则从 cmd.ExecuteReader() 返回的读取器最初应该指向 3，对吗？reader.Read() 然后在 while 循环内的后续调用中移动到 5、7 和 9。但是，因为 reader.Read() 在第一个“ltemp += ...”行之前被调用，我是否跳过了第一个结果 (3)？

第二个问题-（我开始认为这可能是VS中的一个错误）如果我在“if（null！= ...”行的断点处停止时在调试器中单步执行这组代码，我可以清楚地看到 mu 将鼠标悬停在弹出窗口中并向下钻取，即阅读器分配了多个行数据值。但是，如果我关闭该弹出信息，然后尝试将其恢复，当我向下钻取时，我现在看到了该行“枚举没有结果”之前有明确的数据。

谁能解释这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T01:15:09.757

1.  运行 ExecuteReader 后，请像这样考虑它，该集合位于第 -1 行。您需要执行 Read 才能到达第 0 行。

2.  IDataReader 是一个仅向前的结构，您只能迭代一次，调试器正在迭代它。

一般的问题：

*   为什么要锁？
*   为什么对阅读器进行 null 检查 - 我不知道 ExecuteReader 在选择后返回 null 的任何问题。
*   为什么不“从 table1 中选择 SUM(col1)
*   你为什么不遵循处置模式？

# asp.net - ASP.NET LoginStatus 控件 - 覆盖生成的 QueryString 中的 ReturnURL

> ID：1004630
> 
> 赞同：0
> 
> 时间：2009-06-17T01:05:36.017
> 
> 标签：asp.net, forms-authentication

我有一个使用[ASP.NET 登录控件](http://msdn.microsoft.com/en-us/library/ms178329.aspx)和表单身份验证的网站。我已将 asp:LoginStatus 控件放置在另一个 Web 用户控件中，该控件管理我的站点标题部分的显示。

我遇到的问题是 LoginStatus 控件提供的 ReturnURL 引用了 Header 控件的路径，而不是用户当前所在的页面。这可能是由于类层次结构和标题控件 (ascx) 实际上在 .aspx 文件上使用 Server.Execute 来生成 HTML。这是一种解决方法，以避免不允许在页面上拥有多个服务器端表单的问题。

所以Page的实际类Hierarchy如下：

```
Default.aspx - Uses Page.Master
Page.Master includes <foo:Header> 
    (with a reference to "~/Controls/Components/Header.ascx")
Header.ascx simply includes an <asp:Literal> 
    on Page_Load performs a Server.Execute ("~/Controls/Pages/Header.aspx") 
    and writes the content out to the Literal
Header.aspx includes <asp:LoginStatus> 
```

当用户单击登录链接时，他们被正确重定向到 Login.aspx，但是显示的 ReturnURL 是（错误的 - 尽管我能理解为什么）`"ReturnUrl=%2fControls%2fPages%2fHeader.aspx"`。

一旦进入登录页面，我就可以很高兴地处理 LoggedIn 事件，以正确地将用户重定向到正确的位置。我想做的是：1）从查询字符串中完全删除 ReturnURL 2）能够在呈现 LoginStatus 控件时控制 ReturnURL。

我已经对 System.Web.UI.WebControls.LoginStatus 进行了一些 Reflector-ing，它似乎是硬编码的，始终使用 ReturnURL，基于以下代码：

```
private string NavigateUrl
{
    get
    {
        if (!base.DesignMode)
        {
            return FormsAuthentication.GetLoginPage(null, true);
        }
        return "url";
    }
} 
```

它总是将reuseReturnURL 设置为true。

可能，我唯一的选择是滚动我自己的 LoginStatus 控件？

[编辑：最初为了简洁，我省略了以下细节]

这是我想要实现的一个非常简单的示例：

Web 应用程序项目具有以下结构：WebSite - 控件 - 组件 - Footer.ascx - Header.ascx - MasterPages - Site.Master - Default.aspx - Login.aspx

如果您有兴趣，页面标记如下。

我已经为关注点分离创建了 Web 用户控件，但是在登录页面上使用 asp:Login 控件需要将它们嵌套在（服务器端）表单中。asp:LoginStatus 控件也需要嵌套在（服务器端）表单中。由于您在一个页面上不能有多个服务器端表单，因此这会中断。

此外，答案不仅仅是禁止登录页面上的 LoginStatus 控件。想象一下，如果我只想在主页上添加一个小搜索控件，这也将依赖于（服务器端）表单。因此使用 Server.Execute 并从 ASPX 生成页面的原因。这“欺骗”了 .NET 以允许一个页面上有多个服务器端表单。（别问我怎么……我不知道！）

也许我的整个架构设计是错误的，但是其他人如何在需要服务器端表单的页面上拥有多个 Web 用户控件？或者不是吗？

Site.Master 标记：

```
<%@ Master Language="C#" AutoEventWireup="true" CodeBehind="Site.master.cs" Inherits="WebSite.MasterPages.Site" %>

<%@ Register TagPrefix="bs" TagName="Footer" Src="~/Controls/Components/Footer.ascx" %>
<%@ Register TagPrefix="bs" TagName="Header" Src="~/Controls/Components/Header.ascx" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
    <asp:ContentPlaceHolder ID="head" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body id="Body" runat="server">
    <div id="container">
        <!-- start header -->
        <bs:Header ID="Header" runat="server" />
        <!-- end header -->
        <div id="central">
            <div id="main">
                <asp:PlaceHolder ID="MainContentPlaceHolder" runat="server">
                    <!-- start main content -->
                    <div>
                        <asp:ContentPlaceHolder ID="MainContent" runat="server" />
                    </div>
                    <!-- end main content -->
                </asp:PlaceHolder>
            </div>
        </div>
        <!-- start footer -->
        <bs:Footer ID="Footer" runat="server" />
        <!-- end footer -->
    </div>

</body>
</html> 
```

Default.aspx 标记：

```
<%@ Page MasterPageFile="~/MasterPages/Site.Master" Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="WebSite._Default" %>

<asp:Content ID="Content1" runat="server" ContentPlaceHolderID="MainContent">
    Main Body Content <br />
    <br />

</asp:Content> 
```

Header.ascx 标记：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="Header.ascx.cs" Inherits="WebSite.Controls.Components.Header" %>
<div id="header">
    Header Content <br />
    <div id="loginstatus">
        <form id="Form1" runat="server">
        <asp:LoginView ID="displayloginname" runat="server">
            <AnonymousTemplate>
                <a href="../../Registration.aspx">Register</a>
            </AnonymousTemplate>
            <LoggedInTemplate>
                Welcome
                <asp:LoginName runat="server" ID="ctlLoginName" />
            </LoggedInTemplate>
        </asp:LoginView>
        <asp:LoginStatus ID="displayloginstatus" runat="server" LoginText="Login" LogoutPageUrl="~/Default.aspx"
            LogoutAction="Redirect" />
        </form>

        <br />
    </div>
</div> 
```

Footer.ascx 标记：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="Footer.ascx.cs" Inherits="Website.Controls.Components.Footer" %>

        <div id="footer">
            Footer Content
            <ul class="links">
            <asp:PlaceHolder ID="ListItems" Runat="server">
                <li><a runat="server" id="HomeLink" href="~/">Home</a></li>
                <li><a runat="server" href="~/" ID="A1">About Us</a></li>
                <li><a id="A2" runat="server" href="~/">Contact Us</a></li>
                <li><a id="A3" runat="server" href="~/">Privacy Policy</a></li>
                <li><a id="A4" runat="server" href="~/">Accessibility Policy</a></li>
                <li><a id="A5" runat="server" href="~/">Legal Notices</a></li>
                <li><a id="A6" runat="server" href="~/">Sitemap</a></li>
                <li><a id="A7" runat="server" href="~/">RSS Feeds</a></li>
            </asp:PlaceHolder>
            </ul>

        </div> 
```

Login.aspx 标记：

```
<%@ Page MasterPageFile="~/MasterPages/Site.Master" Language="C#" AutoEventWireup="true" CodeBehind="Login.aspx.cs" Inherits="Website.Login" %>

<asp:Content ID="Content1" runat="server" ContentPlaceHolderID="MainContent">
    Main Body Content <br />
    <br />
    <form id="form1" runat="server">
    <div>

        <asp:Login ID="Login1" runat="server">
        </asp:Login>

    </div>
    </form>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T01:25:20.597

为什么要从 Header.ascx 执行 Header.aspx 的 Server.Execute？为什么不把 Header.aspx 代码放在 Header.ascx 中。这样，ReturnUrl 将是您期望的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T01:25:54.650

这里听起来不太对劲：

> 在 Page_Load 上执行 Server.Execute("~/Controls/Pages/Header.aspx")
> 并将内容写入 Literal

我不明白你为什么要这样做？您提到这是因为您正试图解决 ASP.NET 不允许在页面上使用多个 HtmlForm 的问题。但是，如果您只是将 header.aspx 中的 html 内容放入文字中，那么您没有使用 HtmlForm？那么你能把 Header.aspx 的内容放在一个普通格式的标签中（没有 runat=server）吗？还是可以将登录状态控件完全放在表单之外？Header.aspx 的内容首先真的需要一个表单吗？

我会好好看看你为什么将 header.aspx 页面的内容写成文字并尝试在那里解决问题，而不是深入到 LoginStatus 控件并将其更改为做一些它不打算做的事情。

另一种可能的建议：如果您确实需要将 Header 加载到文字中，您可以改用 Page.LoadUserControl 吗？这可能会自动为您解析网址？虽然不是 100% 肯定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T09:41:10.933

我看到两个选项：

1.  将您的表单标签放在您的母版页中。就在`<div id="container"`> 下方并将所有内容包装在该 div 中。
2.  将您的标题更改为不需要 ASP.NET 表单。不确定 LoginView 或 LoginStatus 是否都需要 ASP.NET 表单。然后您可以为使用母版页的 aspx 文件保留表单标记（就像在 Login.aspx 中一样）。这就是我更喜欢只将表单标签放在 aspx 页面中（而不是在主文件中），并确保页眉和页脚不需要 ASP.NET 表单（他们可以使用常规的表单标签，而不是 runat=server）。

# winapi - windows上的“锁定内核对象”会让整个系统无响应？

> ID：1004637
> 
> 赞同：0
> 
> 时间：2009-06-17T01:11:22.823
> 
> 标签：winapi, synchronization, kernel

有这个WIN32进程，有人说：

> 服务端锁定内核对象并且不释放。一段时间后，机器变得无响应，必须重新启动。仅重新启动服务不会解决问题。

据我所知，应用程序不应该能够在 Windows 中使整个系统崩溃。有谁知道这种不雅行为（锁定内核对象而不释放它）是否确实会使操作系统崩溃？如果是这样，为什么我们不在恶意软件中看到更多呢？

一些说明：这不是设备驱动程序。回复中留下的任何歧义对我来说也是模棱两可的。请详细说明您能想到的情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T16:48:39.583

这并不意味着什么。NT 中没有“内核对象”，如果重新启动服务，您可能获得的任何锁定都将被释放。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T02:40:48.587

这取决于它是什么类型的应用程序。一些应用程序安装和使用内核驱动程序作为其使用的一部分。内核驱动程序在系统中具有最低级别的访问权限，并且能够使系统崩溃或挂起。如果该进程使用内核驱动程序，并且描述暗示了这一点，那么是的，它可能会使系统崩溃/挂起。

我相信 Windows Vista 开始限制内核驱动程序可能意外造成的损害（尤其是图形驱动程序）。但是故意的，你仍然会导致很多问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T14:37:39.547

根据它们所指的精确内核对象和服务，这很可能是正确的。例如，请参阅 Raymond Chen 的[Loader Lock](http://blogs.msdn.com/oldnewthing/archive/2004/01/28/63880.aspx)，这是一种应用程序可以独占的内核锁。重新启动服务将成为一个问题，因为该服务的卸载也将需要加载器锁。

# database-design - 数据模型设计和领域模型设计

> ID：1004640
> 
> 赞同：1
> 
> 时间：2009-06-17T01:13:22.383
> 
> 标签：database-design, oop, model, domain-driven-design

我正在尝试为杂货店建模。在店内，有好几条“过道”。每个“通道”都有一组它存储的“项目”“类别”。每个“类别”只能属于一个“通道”。每个“项目”只能有一个“类别”。

数据模型对我来说似乎很简单：

*   带有 ID 和说明的“过道”表
*   具有 ID、NAME 和引用“过道”表的 AISLE_ID 的“类别”表
*   具有 ID、NAME、DESCRIPTION 和引用“类别”的 CATEGORY_ID 的“项目”表

对象模型是我需要帮助的地方：

1.  Aisle 对象中可以包含 Category 和 Item 对象的列表。
2.  Aisle 对象可以有一个 Category 对象列表。Category 对象可以在其中包含 Item 对象的列表。
3.  Aisle 可以有一个 Item 对象的列表。一个 Category 对象可以有一个 Item 对象的列表。

在每种情况下，一个 Item 逻辑上都会在其中包含一个 Category 对象。我为每个域对象都有一个 DAO，所以根据它的完成方式，sql 会发生一些变化。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T01:28:57.017

我投票给选项#2。比#1 或#3 更有意义。

你认为这种关系需要是双向的吗？项目是否需要能够确定其父类别和祖父 Aisle 是谁？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T01:34:50.747

我会选择＃2。

过道的主要关注点是其中包含哪些类别。应该由 Category 类来确定哪些 Items 是成员。这使每个对象的抽象级别保持一致 - 其中 Aisle 是更高级别的对象，Category 是一个稍微更详细的级别，而 item 是最细粒度的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T01:37:53.050

如果这些是您仅有的 3 个选项，那么第 2 项最有意义。

我想，如果我要创建这个模型，我会使用以下模型（小的修改，只是尽量保持尽可能接近你的想法）：

过道对象可以有一个类别对象列表，一个类别对象可以有一个项目对象列表，**并且一个项目与一个类别和一个过道相关联。**

我的修改似乎更多是在数据方面。

我会这样做的原因是，有人说“嘿，我正在寻找这个特定的项目，它在哪个过道？” -- 1 次查找会给你答案。而使用您的数据模型，您将需要 2 次查找。

至少我是这么认为的。

# .net - Hudson + CVS 头痛

> ID：1004641
> 
> 赞同：2
> 
> 时间：2009-06-17T01:13:36.237
> 
> 标签：.net, cvs, hudson, tortoisecvs

我正在尝试配置我的 Hudson 服务器以从 CVS 存储库中检索代码，但到目前为止，这是一次非常令人沮丧的经历。

我的设置是作为系统服务运行的 Hudson 1.310，服务器上的 CVSNT 最新版本，TortoiseCVS 1.10.10。

即使我使用本文[http://blogs.msdn.com/adioltean/articles中建议的技巧将密码代理作为系统进程打开，我也一直收到“无法识别提供给包的凭据” /271063.aspx](http://blogs.msdn.com/adioltean/articles/271063.aspx)。

我真的不知道在哪里可以找到有关此问题的更多信息，这让我发疯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T15:36:16.910

我通过在命令行上作为系统帐户进行​​手动 cvs 登录来解决类似的问题。您可能想尝试一下。

# iphone - UITableViewCell 的选择颜色

> ID：1004642
> 
> 赞同：3
> 
> 时间：2009-06-17T01:14:30.930
> 
> 标签：iphone, cocoa-touch, iphone-sdk-3.0, uitableview

如果我有一个`UITableViewCell`不使用`textLabel`单元格内置的自定义，而是使用它自己的绘图，我该如何更改`contentView`on 选择的外观，就像它自动为默认文本所做的那样（可通过设置自定义`selectedTextColor:`）？

如果我更改`tableView:willSelectRowAtIndexPath:`，那么它只会在蓝色选择背景启动后更新，而不是在它动画时更新，就像我想要的那样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T04:19:48.990

只是不要继承 UITableViewCell 并使用默认行为。您可以完全自定义单元格而无需任何子类化。

阅读[这篇文章](http://cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html)了解更多详情。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-16T11:22:09.123

在您的 tableview cellForRowAtIndexPath 方法中添加此代码，只需更改 UITableViewCell 选择样式的预期颜色。

```
 //-------------------------------------------------------------------------
   //background selected view 
   UIView *viwSelectedBackgroundView=[[UIView alloc]init];
   viwSelectedBackgroundView.backgroundColor=[UIColor colorWithRed:124.0/255.0 green:202.0/255.0 blue:227.0/255.0 alpha:1.0];
   cell.selectedBackgroundView=viwSelectedBackgroundView;
   //------------------------------------------------------------------------- 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-24T14:29:16.060

如果您已将 UITableViewCell 子类化，则可以通过覆盖以下内容来自定义单元格的元素：

```
- (void)setHighlighted:(BOOL)highlighted animated:(BOOL)animated {
    if(highlighted) {
        self.backgroundColor = [UIColor redColor];
    } else {
        self.backgroundColor = [UIColor clearColor];
    }

    [super setHighlighted:highlighted animated:animated];
} 
```

# javascript - 脚本需要等待元素加载

> ID：1004648
> 
> 赞同：0
> 
> 时间：2009-06-17T01:17:17.367
> 
> 标签：javascript, select, dom-events, delay

**背景信息：**
我有一个函数，在调用时会在表单内创建选择列表并填充它。之后，脚本将遍历列表中的选项并查找某个值。如果该值存在，则脚本“选择”该选项。

**问题：**
因为列表是动态创建的并且有时非常大，所以加载需要一段时间。发生这种情况时，脚本的第二部分（选择选项的部分）不会做任何事情，因为选择列表没有时间加载。

**解决方案的想法：**最好在选择列表
的事件中调用函数的第二部分（作为单独的函数） 。`onload`但是选择列表不应该具有`onload`属性。另一种想法是简单地添加延迟，但有一天延迟可能不够长。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T02:20:11.983

你的 AJAX 调用怎么样？大多数 AJAX 库将提供在成功完成时执行回调的机制。例如在 jQuery 中：

```
$("#myList").load("ajax.url", function(){
   //your content has been loaded, so you can do your selection logic here
}); 
```

如果您正在手动处理 ajax 响应并在 javascript 中构建列表，那么您已经拥有知道列表何时完成的代码，因此您可以在完成后执行选择部分，而不是作为单独的函数（就像zyeming建议的那样）。

如果这对您没有帮助，则可能值得发布一些代码，以便人们可以为您提供更具体的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T01:23:55.730

使用延迟是不可靠的。无论您使用什么来填充选择列表，都应该在完成后直接调用该函数。

交替：

由于 select all 没有“onload”事件，因此您可以真正做到它有一个在超时后调用自身的函数。如果选择列表中项目的长度已从零更改，则您知道当前正在添加项目（起点）。如果已经到达起点并且在下一次超时后没有任何变化，您可以假设项目已停止添加到列表中，因此您可以运行第二个函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T01:53:48.103

为什么不将选择选项的函数设为回调函数。它将在创建列表的函数末尾调用。例如

```
function createList(onComplete) {
// Create the list and maybe other tasks
onComplete();
} 
```

注意：可能不是这样，但我想你已经明白了......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T02:11:48.820

好的，我终于解决了这个问题。该解决方案与这里讨论的完全不同。基本上，我使用“新选项（值，文本）”将选项添加到我的列表中。我最终抛出了一个 if 语句，当一个值等于我需要的值时，我使用了 new Option(value, text, true)。这解决了问题。一天的工作。

# sql-server-2008 - sql server 2008 中数据同步和转换的可行选项有哪些？

> ID：1004655
> 
> 赞同：2
> 
> 时间：2009-06-17T01:20:05.380
> 
> 标签：sql-server-2008, data-synchronization

**我们公司需要在两台不同的服务器上同步两个sql server 2008数据库。**

1.  数据库模式大约有 50% 不同，因此需要进行转换。
2.  同步需要实时进行。
3.  同步需要是双向的。

**为此目的使用了哪些良好做法？**

**我们分析了以下解决方案，但它们对我们不起作用**

**微软同步框架**。由于设置框架（特别是框架使用的元数据表/触发器/存储过程）所需的时间量，此选项不起作用。它也是一个较新的框架，因此文档/示例很少，并且该产品可能不像其他一些解决方案那样稳定。

**SQL Server 集成服务**。该解决方案具有学习曲线和可能的障碍。仅仅为了这个目的，它似乎也太多了。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T01:41:07.583

SQL Server 复制。

在两个数据库中创建视图以模拟不同的另一侧的 50%。这些以及仍然匹配的表将作为您的发布源。对于匹配的表，只需设置双向复制。

对于不匹配的表，使用仿真视图作为发布源。将“SourceID”添加到它们的基表中以识别它们最初是在哪个服务器上创建的，然后设置复制过滤器以确保没有服务器接收到它最初创建的行。仅单向将这些视图发布到其他服务器。您可能需要将这些设置为索引视图才能使其正常工作（对不起，我不记得了）。

# vb.net - 语法：VB.NET 子程序中的“Exit Sub”或“Return”

> ID：1004657
> 
> 赞同：63
> 
> 时间：2009-06-17T01:20:52.353
> 
> 标签：vb.net, syntax, return, subroutine

“退出子程序”或“返回”似乎都完成了同样的事情——退出子程序。它们在幕后工作的方式有什么不同吗？

那是，

```
Private Sub exitNow()
    Exit Sub
End Sub 
```

或者

```
Private Sub exitNow()
    Return
End Sub 
```

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-06-17T01:23:59.303

从文档：

> 在 Sub 或 Set 过程中，Return 语句等效于 Exit Sub 或 Exit Property 语句，并且不得提供表达式。

因此，在这种情况下，它们是相同的。

（`Return (<value>)`用于函数和property.get。显然在这种情况下略有不同）。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2017-04-19T16:27:22.000

我倾向于更`Return`喜欢`Exit Sub`. 因为偶尔你会从`Sub`变为`Function`。在这种情况下`Exit Sub`可以转换为`Exit Function`，但这假设函数名之前有一个分配（类似于 VB 6），这很可能没有发生。`Return`会捕捉到这种情况 - 如果方法应该返回一个值，`Return`没有参数将在编译时失败。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-25T05:44:43.987

如果您检查 2 条语句的 IL 输出，它们是相同的。但是，由于 'return' 意味着将某些东西推回给调用者，所以严格来说，'Exit Sub' 更适合在 Sub 中使用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-04T14:27:12.950

在这种情况下，它们是相同的。

但是，从代码可读性的角度来看，“Exit Sub”会更清晰，因为“Return”表示某些值正在用作输出（子例程不是这种情况）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-12T21:28:00.110

*   首先，Procedures 带有 sub，我们应该知道我们正在处理不返回特定值的特定程序，具有传递某些特定参数甚至不传递任何参数的能力。如：
*   打印一些东西（）。
*   计算整数的阶乘`CalcFact(X)`。
*   为特定任务执行一些流程。

*   函数是一个特定的过程，通过传递一些特定的参数来实现特定的任务，它必须返回一些可以用来完成整个任务的值，例如验证用户名和用户密码。

简而言之 Sub 不返回值，我们直接调用它`"Print HelloWorld()"`，而函数则如下：

*   `ValidUsersNameAndPass("Johne","jOhNe13042019")` ' 这可以返回一个布尔值。
*   `ValidUsersNameAndPass("Johne","jOhNe13042019");` // 这可以返回一个布尔值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-18T18:52:30.767

我想确认它们在 lambda 表达式中的行为也相同，它们确实：

```
Sub test()

    Dim a As Action = Sub() Exit Sub
    Dim b As Action = Sub() Return

    a()
    b()

    MsgBox("Yes they do!") 
 End Sub 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-06-17T01:24:24.450

虽然有像保护子句这样的例外，但在大多数情况下，我会认为要么是方法太长的迹象。

# protocols - 填充或不填充 - 创建通信协议

> ID：1004660
> 
> 赞同：2
> 
> 时间：2009-06-17T01:23:49.133
> 
> 标签：protocols, communication, padding

我正在创建一个协议，让两个应用程序通过 TCP/IP 流进行通信，并且正在研究如何为我的消息设计标头。使用 TCP 标头作为初始指南，我想知道是否需要填充。我知道，当我们处理缓存时，我们希望确保存储的数据适合一行缓存，以便在检索数据时能够高效地完成。但是，考虑到应用程序将解析字节流并将其存储为它认为合适的方式，我不明白填充标头有何意义。

例如：我想通过一个包含 3 字节字段后跟 1 字节填充字段的消息头发送 32 位对齐。然后我将发送消息数据。

在这种情况下，接收者只会从流中取出 3 个字节并丢弃填充字节。然后开始读取消息数据。正如我所看到的，他不会以他想要的方式存储 3 个字节和消息数据。字节对齐的全部意义在于以一种有效的方式对其进行检索。但是，如果检索器不关心填充，如何有效地检索它？

如果没有填充，检索器只需从流中获取 3 个标头字节，然后获取数据字节。由于检索器以他想要的方式存储这些字节，因此填充是否完成有什么关系？

也许我错过了填充点。

从这篇文章中提取一个问题有点困难，但是根据我所说的，你们可能会指出我的误解。

请让我知道你们的想法。

谢谢，jbu

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T01:31:01.037

如果消息正文的字对齐有一些用处，那么一定要填充消息以避免其他扭曲。如果大部分消息被处理为具有适当强度的机器字，则填充将是有益的。

如果消息是字节流，例如 xml，那么填充不会给你带来很多好处。

就实际设计有线协议而言，您可能应该考虑使用带有压缩的纯文本协议（包括标头），这可能会比您可能发明的任何手工设计的二进制协议使用更少的带宽。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T01:50:47.253

> 考虑到应用程序将解析字节流并将其存储为它认为合适的方式，我不明白填充标头有何意义。

如果我是接收者，我可能会将一个缓冲区（即一个字节数组）传递给协议驱动程序（即 TCP 堆栈）并说，“当其中有数据时把它还给我”。

那么，我（应用程序）返回的是一个包含数据的字节数组。使用 C 风格的技巧，如“强制转换”等，我可以将此数组的某些部分视为单词和双字（不仅仅是字节）......只要它们适当对齐（这是填充可能的位置必需的）。

这是从字节缓冲区中的偏移量读取 DWORD 的语句示例：

```
DWORD getDword(const byte* buffer)
{
  //we want the DWORD which starts at byte-offset 8
  buffer += 8;
  //dereference as if it were pointing to a DWORD
  //(this would fail on some machines if the pointer
  //weren't pointing to a DWORD-aligned boundary)
  return *((DWORD*)buffer);
} 
```

这是英特尔汇编中的相应函数；请注意，它是单个操作码，即访问数据的一种非常有效的方式，比读取和累积单独的字节更有效：

```
mov eax,DWORD PTR [esi+8] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T02:57:57.460

如果您有一个 3 字节的标头并将其对齐为 4 个字节，则将未使用的字节指定为“保留以供将来使用”并要求这些位为零（拒绝格式不正确的消息）。这给你留下了一些可扩展性。或者您可能决定将字节用作版本号 - 最初为零，然后如果（何时）您对协议进行不兼容的更改，则将其递增。不要让值是“未定义”和“不在乎”；如果您以这种方式开始，您将永远无法使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T02:25:14.547

考虑填充的一个原因是您是否计划随着时间的推移扩展您的协议。可以有意留出一些填充以供将来分配。

考虑填充的另一个原因是在长度字段上保存几个位。即总是 4 或 8 的倍数可以节省长度字段的 2 或 3 位。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T02:27:05.680

TCP 具有填充（可能不适用于您）的另一个很好的理由是它允许专用网络处理硬件轻松地将数据与标头分开。由于数据始终以 32 位边界开始，因此在路由数据包时更容易将标头与数据分开。

# sybase - 为什么 IF EXISTS 不起作用？

> ID：1004671
> 
> 赞同：2
> 
> 时间：2009-06-17T01:26:57.207
> 
> 标签：sybase

我有很多代码正在尝试运行，我正在查询 sysobjects 表以检查对象是否存在，然后再删除并再次创建它。

问题是，有时如果我去：

```
if not exists (select name from sysobjects o where o.name = 'my_table' and o.type =  'U') 
CREATE TABLE my_table (..)
go 
```

它有效，不用担心。然而，当我再次运行它时，我得到了这个可爱的错误：

```
SQL Server Error on (myserver) Error:2714 at Line:10 Message:There is already an object named 'my_table' in the database. 
```

谢谢你，SQL 程序员。如果它已经存在，我实际上要求你不要创建这个表。-_-

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T01:58:37.160

你正在做的事情的逻辑似乎不太正确。根据您的陈述：

“我正在尝试在查询 sysobjects 表的位置运行以检查对象是否存在，然后再删除并再次创建它”

您应该简单地进行删除，然后进行创建。这种方式通常更好，因为它可以确保表会被更新。如果表存在并且您进行了更改，那么您可能没有得到您想要的。

您遇到的直接问题是假定的数据库所有权在运行之间不一致。

根据您在下面的说明-您可以执行以下操作：

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[XXXX]') AND type in (N'U')) DROP TABLE [dbo].[XXXX] GO

创建表 [dbo].[XXXX(... GO

你可以一遍又一遍地运行它......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T01:52:34.160

sybase 解析器对象验证传递是全局的，不基于条件评估。即使您的代码无法执行 CREATE TABLE，仍会检查该语句的语法和适用性，当系统发现该表已存在时，该语句将失败。

我所知道的解决此问题的唯一方法是将您的 create 语句放在 EXEC() 中，只有在执行该部分时才会对其进行评估。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T15:19:43.873

是的，整批SQL都进行了规范化和编译，从而为整批创建了一个“执行计划”。在规范化期间，如果“可能的”“create table”语句在编译时已经存在，那么它就是一个问题。

我的解决方案：重命名 -

如果存在 (select 1 from ....) begin drop table xyz create table xyz_zzzz ( ... ) exec sp_rename 'xyz_zzzz','xyz' end

# mysql - 优化两个大表上的简单查询

> ID：1004672
> 
> 赞同：4
> 
> 时间：2009-06-17T01:27:18.237
> 
> 标签：mysql, performance, optimization, query-optimization

我正在尝试提供一项功能，我可以在其中显示朋友查看次数最多的页面。我的朋友表有 570 万行，视图表有 530 万行。目前我只想在这两个表上运行一个查询，并找到一个人的朋友查看次数最多的 20 个页面 id。

这是我现在的查询：

```
SELECT page_id 
FROM `views` INNER JOIN `friendships` ON friendships.receiver_id = views.user_id 
WHERE (`friendships`.`creator_id` = 143416) 
GROUP BY page_id 
ORDER BY count(views.user_id) desc 
LIMIT 20 
```

这是一个解释的样子：

```
+----+-------------+-------------+------+-----------------------------------------+---------------------------------+---------+-----------------------------------------+------+----------------------------------------------+
| id | select_type | table       | type | possible_keys                           | key                             | key_len | ref                                     | rows | Extra                                        |
+----+-------------+-------------+------+-----------------------------------------+---------------------------------+---------+-----------------------------------------+------+----------------------------------------------+
|  1 | SIMPLE      | friendships | ref  | PRIMARY,index_friendships_on_creator_id | index_friendships_on_creator_id | 4       | const                                   |  271 | Using index; Using temporary; Using filesort | 
|  1 | SIMPLE      | views       | ref  | PRIMARY                                 | PRIMARY                         | 4       | friendships.receiver_id                 |   11 | Using index                                  | 
+----+-------------+-------------+------+-----------------------------------------+---------------------------------+---------+-----------------------------------------+------+----------------------------------------------+ 
```

views 表有一个主键 (user_id, page_id)，你可以看到它正在被使用。友谊表的主键为 (receiver_id, creator_id)，二级索引为 (creator_id)。

如果我在没有 group by 和限制的情况下运行此查询，则此特定用户大约有 25,000 行 - 这是典型的。

在最近的实际运行中，这个查询也执行了 7 秒，这对于 Web 应用程序中的体面响应来说太长了。

我想知道的一件事是我是否应该将二级索引调整为（creator_id，receiver_id）。不过，我不确定这会带来多大的性能提升。根据这个问题的答案，我今天可能会尝试一下。

您能看到可以重写查询以使其快速变亮的任何方式吗？

更新：我需要对其进行更多测试，但如果我不在数据库中进行分组和排序，但之后在 ruby​​ 中进行，我的讨厌的查询似乎效果更好。总时间要短得多——似乎缩短了大约 80%。也许我的早期测试存在缺陷——但这绝对值得更多调查。如果是真的 - 那么 wtf 是 Mysql 在做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T01:46:53.377

据我所知，进行“闪电般快速”的查询的最佳方法是创建一个汇总表，以跟踪每个创建者每页的朋友页面浏览量。

您可能希望通过触发器使其保持最新。那么你的聚合已经为你完成了，它是一个简单的查询来获得浏览次数最多的页面。您可以确保汇总表上有适当的索引，这样数据库甚至不必进行排序即可获得最多的浏览量。

摘要表是在以读取为主的环境中保持聚合类型查询的良好性能的关键。当更新发生（不频繁）然后查询（频繁）不必做任何工作时，您可以预先完成工作。

如果您的统计数据不必完美，并且您的写入实际上相当频繁（可能是页面浏览量之类的情况），您可以在内存中批量处理视图并在后台处理它们，以便朋友们不要当他们查看页面时，不必费心使汇总表保持最新。该解决方案还减少了数据库争用（更新汇总表的进程更少）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T00:46:18.823

您的索引看起来是正确的，尽管如果`friendship`有非常大的行，您可能希望索引打开`(creator_id, receiver_id)`以避免读取所有内容。

但是这里有些不对劲，为什么要对 271 行进行文件排序？确保您的 MySQL 至少有几兆字节用于`tmp_table_size`和`max_heap_table_size`. 这应该使 GROUP BY 更快。

`sort_buffer`也应该有一个理智的价值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T01:49:00.003

您绝对应该考虑非规范化此表。如果您创建一个单独的表来维护用户 ID 和他们查看的每个页面的确切计数，您的查询应该会变得更简单。

您可以通过在视图表上使用触发器轻松维护此表，只要在“视图”表上发生插入，该触发器就会更新“视图摘要”表。

您甚至可以通过查看实际关系来进一步非规范化，或者只保留每个人的前 x 页

希望这可以帮助，

翻转

# c++ - 如何正确终止 dll 中的挂起线程？

> ID：1004676
> 
> 赞同：3
> 
> 时间：2009-06-17T01:30:08.697
> 
> 标签：c++, windows, multithreading, dll

**大家好你们好，**

我有一个包含错误的第三方库。当我调用一个函数时，它可能会挂起。库函数在 dll 中调用。我决定将调用移到线程中并等待一段时间。如果线程完成，则确定。如果不是——我应该强制终止它。

这里的简化示例：

```
unsigned Counter = 0;
void f()
{
    HANDLE hThread;
    unsigned threadID;

    // Create the second thread.
    hThread = (HANDLE)_beginthreadex( NULL, 0, DoSomething, NULL, 0, &threadID );

    if (WAIT_TIMEOUT == WaitForSingleObject( hThread, 5000 ))
    {
        TerminateThread(hThread, 1);    
        wcout << L"Process is Timed Out";
    }
    else
    {
        wcout << L"Process is Ended OK";
    }

    CloseHandle(hThread);   

    wcout << Counter;
}

unsigned int _stdcall DoSomething( void * /*dummy*/ )
{
    while (1)
    {

        ++Counter;

    }
    _endthreadex( 0 );
    return 0;
} 
```

**问题**

1.  不建议调用*TerminateThread()*函数。
2.  正如我之前提到的，线程**在 dll**中运行。*如果我使用TerminateThread()*终止线程，我的 dll 将不会使用*FreeLibrary()*甚至 *FreeLibraryAndExitThread()*卸载。两个函数都挂起。

如何终止线程并保持*FreeLibrary()*工作？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-17T01:33:51.110

不幸的是，您不能随意安全地终止线程。

TerminateThread 导致线程立即终止，即使线程正在持有锁或修改某些内部状态。TerminateThread 可能会导致应用程序中的随机挂起（如果线程持有锁）或崩溃（如果线程正在修改某些状态并且它保持不一致）

如果您不能相信 DLL 的行为正确并且这会给您带来严重的可靠性问题，您应该将调用 DLL 的代码移动到一个单独的进程中——终止一个进程会更安全。

# visual-studio-2005 - SSIS 2005 更改“执行 SQL 任务”的连接服务器没有效果——

> ID：1004677
> 
> 赞同：4
> 
> 时间：2009-06-17T01:30:36.200
> 
> 标签：visual-studio-2005, ssis

我前段时间创建了 SSIS 包，今天我需要将它们重新指向不同的 SQL 服务器。我有一堆“执行 SQL 任务”任务，需要将它们的 Connection 属性更改为不同的服务器。

我创建了一个新的连接管理器，双击每个 sql 任务，将它们的 Connection 属性更改为新的，运行。它失败了，错误是它找不到旧的连接。我重新启动了项目，SQL Server 任务似乎都没有启动新的连接管理器。我打开了 .dtsx 文件，试图在某处找到旧服务器名称并手动更改它，但我找不到旧服务器。

为了摆脱旧的 SQL Server 并使其连接到新的、正确的数据源，我需要进行哪些更改。

我在 VS2005 中工作，在 Windows 2008 x64 机器上（我不知道这是否重要）。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T02:44:23.290

我之前在启用包配置时看到过这种情况。确保不是这种情况，重新编译，然后重试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T01:41:28.143

您所要做的就是更改旧连接管理器中的连接字符串

如果您删除了旧任务并在所有任务中选择新任务，则创建一个新任务，即使您创建一个与旧任务同名的新任务，它也不会起作用，因为在内部某个地方使用了 guid

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T01:56:49.080

检查是否启用了包配置。包可能仍然从包配置中获取旧服务器的配置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T01:51:48.687

进行更改后尝试重新编译。

# perl - 用于类似 Makefile 的续行的最干净的 Perl 解析器

> ID：1004696
> 
> 赞同：3
> 
> 时间：2009-06-17T01:42:44.493
> 
> 标签：perl, fileparsing, redo

我正在编写的 perl 脚本需要解析具有像 Makefile 这样的连续行的文件。即以空格开头的行是前一行的一部分。

我写了下面的代码，但不觉得它很干净或 perl-ish（见鬼，它甚至不使用“重做”！）

有许多边缘情况：奇数位置的 EOF、单行文件、以空行（或非空行或续行）开头或结尾的文件、空文件。我所有的测试用例（和代码）都在这里：[http ://whatexit.org/tal/flatten.tar](http://whatexit.org/tal/flatten.tar)

你能写出通过我所有测试的更干净，perl-ish 的代码吗？

```
#!/usr/bin/perl -w

use strict;

sub process_file_with_continuations {
    my $processref = shift @_;
    my $nextline;
    my $line = <ARGV>;

    $line = '' unless defined $line;
    chomp $line;

    while (defined($nextline = <ARGV>)) {
        chomp $nextline;
        next if $nextline =~ /^\s*#/;  # skip comments
        $nextline =~ s/\s+$//g;  # remove trailing whitespace
        if (eof()) {  # Handle EOF
            $nextline =~ s/^\s+/ /;
            if ($nextline =~ /^\s+/) {  # indented line
                &$processref($line . $nextline);
            }
            else {
                &$processref($line);
                &$processref($nextline) if $nextline ne '';
            }
            $line = '';
        }
        elsif ($nextline eq '') {  # blank line
            &$processref($line);
            $line = '';
        }
        elsif ($nextline =~ /^\s+/) {  # indented line
            $nextline =~ s/^\s+/ /;
            $line .= $nextline;
        }
        else {  # non-indented line
            &$processref($line) unless $line eq '';
            $line = $nextline;
        }
    }
    &$processref($line) unless $line eq '';
}

sub process_one_line {
    my $line = shift @_;
    print "$line\n";
}

process_file_with_continuations \&process_one_line; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T08:07:33.587

如何将整个文件放入内存并使用正则表达式处理它。更多的'perlish'。这通过了您的测试，并且*更*小更整洁：

```
#!/usr/bin/perl

use strict;
use warnings;

$/ = undef;             # we want no input record separator.
my $file = <>;          # slurp whole file

$file =~ s/^\n//;       # Remove newline at start of file
$file =~ s/\s+\n/\n/g;  # Remove trailing whitespace.
$file =~ s/\n\s*#[^\n]+//g;     # Remove comments.
$file =~ s/\n\s+/ /g;   # Merge continuations

# Done
print $file; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T08:56:39.913

如果您不介意将整个文件加载到内存中，那么下面的代码将通过测试。它将行存储在一个数组中，将每一行添加到前一行（继续）或数组的末尾（其他）。

```
#!/usr/bin/perl

use strict;
use warnings;

my @out;

while( <>)
  { chomp;
    s{#.*}{};             # suppress comments
    next unless( m{\S});  # skip blank lines
    if( s{^\s+}{ })       # does the line start with spaces?
      { $out[-1] .= $_; } # yes, continuation, add to last line
    else 
      { push @out, $_;  } # no, add as new line
  }

$, = "\n";                # set output field separator
$\ = "\n";                # set output record separator
print @out; 
```

# c# - 如何从 .NET DateTime 中截断毫秒

> ID：1004698
> 
> 赞同：385
> 
> 时间：2009-06-17T01:43:19.217
> 
> 标签：c#, .net, datetime

我正在尝试将传入请求的时间戳与数据库存储值进行比较。SQL Server 当然在时间上保持一些毫秒的精度，当读入 .NET DateTime 时，它​​包括那些毫秒。然而，对系统的传入请求并没有提供那种精度，所以我需要简单地减少毫秒。

我觉得我遗漏了一些明显的东西，但我还没有找到一种优雅的方式来做到这一点（C#）。

* * *

## 回答 #1

> 赞同：632
> 
> 时间：2009-06-17T05:13:33.213

以下将适用于具有小数毫秒的 DateTime，并且还保留 Kind 属性（Local、Utc 或 Undefined）。

```
DateTime dateTime = ... anything ...
dateTime = new DateTime(
    dateTime.Ticks - (dateTime.Ticks % TimeSpan.TicksPerSecond), 
    dateTime.Kind
    ); 
```

或等效且更短的：

```
dateTime = dateTime.AddTicks( - (dateTime.Ticks % TimeSpan.TicksPerSecond)); 
```

这可以概括为扩展方法：

```
public static DateTime Truncate(this DateTime dateTime, TimeSpan timeSpan)
{
    if (timeSpan == TimeSpan.Zero) return dateTime; // Or could throw an ArgumentException
    if (dateTime == DateTime.MinValue || dateTime == DateTime.MaxValue) return dateTime; // do not modify "guard" values
    return dateTime.AddTicks(-(dateTime.Ticks % timeSpan.Ticks));
} 
```

使用如下：

```
dateTime = dateTime.Truncate(TimeSpan.FromMilliseconds(1)); // Truncate to whole ms
dateTime = dateTime.Truncate(TimeSpan.FromSeconds(1)); // Truncate to whole second
dateTime = dateTime.Truncate(TimeSpan.FromMinutes(1)); // Truncate to whole minute
... 
```

* * *

## 回答 #2

> 赞同：169
> 
> 时间：2009-06-17T01:47:24.980

```
var date = DateTime.Now;

date = new DateTime(date.Year, date.Month, date.Day, date.Hour, date.Minute, date.Second, date.Kind); 
```

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2010-04-21T09:40:29.120

这是基于先前答案的扩展方法，可让您截断为任何分辨率...

**用法：**

```
DateTime myDateSansMilliseconds = myDate.Truncate(TimeSpan.TicksPerSecond);
DateTime myDateSansSeconds = myDate.Truncate(TimeSpan.TicksPerMinute) 
```

**班级：**

```
public static class DateTimeUtils
{
    /// <summary>
    /// <para>Truncates a DateTime to a specified resolution.</para>
    /// <para>A convenient source for resolution is TimeSpan.TicksPerXXXX constants.</para>
    /// </summary>
    /// <param name="date">The DateTime object to truncate</param>
    /// <param name="resolution">e.g. to round to nearest second, TimeSpan.TicksPerSecond</param>
    /// <returns>Truncated DateTime</returns>
    public static DateTime Truncate(this DateTime date, long resolution)
    {
        return new DateTime(date.Ticks - (date.Ticks % resolution), date.Kind);
    }
} 
```

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2009-06-17T01:45:57.357

```
DateTime d = DateTime.Now;
d = d.AddMilliseconds(-d.Millisecond); 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-03-02T03:07:28.120

有时您想截断为基于日历的内容，例如年或月。这是一种扩展方法，可让您选择任何分辨率。

```
public enum DateTimeResolution
{
    Year, Month, Day, Hour, Minute, Second, Millisecond, Tick
}

public static DateTime Truncate(this DateTime self, DateTimeResolution resolution = DateTimeResolution.Second)
{
    switch (resolution)
    {
        case DateTimeResolution.Year:
            return new DateTime(self.Year, 1, 1, 0, 0, 0, 0, self.Kind);
        case DateTimeResolution.Month:
            return new DateTime(self.Year, self.Month, 1, 0, 0, 0, self.Kind);
        case DateTimeResolution.Day:
            return new DateTime(self.Year, self.Month, self.Day, 0, 0, 0, self.Kind);
        case DateTimeResolution.Hour:
            return self.AddTicks(-(self.Ticks % TimeSpan.TicksPerHour));
        case DateTimeResolution.Minute:
            return self.AddTicks(-(self.Ticks % TimeSpan.TicksPerMinute));
        case DateTimeResolution.Second:
            return self.AddTicks(-(self.Ticks % TimeSpan.TicksPerSecond));
        case DateTimeResolution.Millisecond:
            return self.AddTicks(-(self.Ticks % TimeSpan.TicksPerMillisecond));
        case DateTimeResolution.Tick:
            return self.AddTicks(0);
        default:
            throw new ArgumentException("unrecognized resolution", "resolution");
    }
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-06-17T01:49:26.287

与其放弃毫秒然后进行比较，为什么不比较差异呢？

```
DateTime x; DateTime y;
bool areEqual = (x-y).TotalSeconds == 0; 
```

或者

```
TimeSpan precision = TimeSpan.FromSeconds(1);
bool areEqual = (x-y).Duration() < precision; 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-06-17T02:58:45.463

不太明显，但速度快 2 倍以上：

```
// 10000000 runs

DateTime d = DateTime.Now;

// 484,375ms
d = new DateTime((d.Ticks / TimeSpan.TicksPerSecond) * TimeSpan.TicksPerSecond);

// 1296,875ms
d = d.AddMilliseconds(-d.Millisecond); 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-10-25T08:42:53.327

向下舍入到第二个：

```
dateTime.AddTicks(-dateTime.Ticks % TimeSpan.TicksPerSecond) 
```

替换`TicksPerMinute`为向下舍入到分钟。

* * *

如果您的代码对性能敏感，请注意

```
new DateTime(date.Year, date.Month, date.Day, date.Hour, date.Minute, date.Second) 
```

我的应用在[System.DateTime.GetDatePart](https://referencesource.microsoft.com/#mscorlib/system/datetime.cs,ff06f271f088f1a8)中花费了 12% 的 CPU 时间。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2020-02-12T23:30:42.500

不是最快的解决方案，但简单易懂：

```
DateTime d = DateTime.Now;
d = d.Date.AddHours(d.Hour).AddMinutes(d.Minute).AddSeconds(d.Second) 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2015-09-10T01:04:06.693

一种便于阅读的方法是...

```
//Remove milliseconds
DateTime date = DateTime.Now;
date = DateTime.ParseExact(date.ToString("yyyy-MM-dd HH:mm:ss"), "yyyy-MM-dd HH:mm:ss", null); 
```

和更多...

```
//Remove seconds
DateTime date = DateTime.Now;
date = DateTime.ParseExact(date.ToString("yyyy-MM-dd HH:mm"), "yyyy-MM-dd HH:mm", null);

//Remove minutes
DateTime date = DateTime.Now;
date = DateTime.ParseExact(date.ToString("yyyy-MM-dd HH"), "yyyy-MM-dd HH", null);

//and go on... 
```

我知道这很容易理解，但它缺乏性能。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-07-22T07:15:49.677

关于 Diadistis 的反应。这对我有用，除了我必须在乘法之前使用 Floor 来删除除法的小数部分。所以，

```
d = new DateTime((d.Ticks / TimeSpan.TicksPerSecond) * TimeSpan.TicksPerSecond); 
```

变成

```
d = new DateTime(Math.Floor(d.Ticks / TimeSpan.TicksPerSecond) * TimeSpan.TicksPerSecond); 
```

我本来期望两个 Long 值的除法会产生一个 Long，从而删除小数部分，但它将它解析为 Double，在乘法后留下完全相同的值。

埃普西

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-07-13T11:00:56.060

2 上述解决方案的扩展方法

```
 public static bool LiesAfterIgnoringMilliseconds(this DateTime theDate, DateTime compareDate, DateTimeKind kind)
    {
        DateTime thisDate = new DateTime(theDate.Year, theDate.Month, theDate.Day, theDate.Hour, theDate.Minute, theDate.Second, kind);
        compareDate = new DateTime(compareDate.Year, compareDate.Month, compareDate.Day, compareDate.Hour, compareDate.Minute, compareDate.Second, kind);

        return thisDate > compareDate;
    }

    public static bool LiesAfterOrEqualsIgnoringMilliseconds(this DateTime theDate, DateTime compareDate, DateTimeKind kind)
    {
        DateTime thisDate = new DateTime(theDate.Year, theDate.Month, theDate.Day, theDate.Hour, theDate.Minute, theDate.Second, kind);
        compareDate = new DateTime(compareDate.Year, compareDate.Month, compareDate.Day, compareDate.Hour, compareDate.Minute, compareDate.Second, kind);

        return thisDate >= compareDate;
    } 
```

用法：

```
bool liesAfter = myObject.DateProperty.LiesAfterOrEqualsIgnoringMilliseconds(startDateTime, DateTimeKind.Utc); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2020-02-07T18:14:20.783

这是我在此处和类似问题中发布的扩展方法的版本。这以易于阅读的方式验证刻度值并保留原始 DateTime 实例的 DateTimeKind。（当存储到像 MongoDB 这样的数据库时，这会产生微妙但相关的副作用。）

如果真正的目标是将日期时间截断为指定值（即小时/分钟/秒/毫秒），我建议在您的代码中实现此扩展方法。它确保您只能截断到有效精度，并保留原始实例的重要 DateTimeKind 元数据：

```
public static DateTime Truncate(this DateTime dateTime, long ticks)
{
    bool isValid = ticks == TimeSpan.TicksPerDay 
        || ticks == TimeSpan.TicksPerHour 
        || ticks == TimeSpan.TicksPerMinute 
        || ticks == TimeSpan.TicksPerSecond 
        || ticks == TimeSpan.TicksPerMillisecond;

    // https://stackoverflow.com/questions/21704604/have-datetime-now-return-to-the-nearest-second
    return isValid 
        ? DateTime.SpecifyKind(
            new DateTime(
                dateTime.Ticks - (dateTime.Ticks % ticks)
            ),
            dateTime.Kind
        )
        : throw new ArgumentException("Invalid ticks value given. Only TimeSpan tick values are allowed.");
} 
```

然后你可以使用这样的方法：

```
DateTime dateTime = DateTime.UtcNow.Truncate(TimeSpan.TicksPerMillisecond);

dateTime.Kind => DateTimeKind.Utc 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-02-19T16:05:08.797

```
DateID.Text = DateTime.Today.ToShortDateString();

Use ToShortDateString() //Date 2-02-2016
Use ToShortDateString() // Time 
```

并通过使用

```
ToLongDateString() // its show 19 February 2016. 
```

:P

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-02-24T19:11:07.823

新方法

```
String Date = DateTime.Today.ToString("dd-MMM-yyyy"); 
```

// 定义字符串传递参数 dd-mmm-yyyy return 24-feb-2016

或显示在文本框中

```
txtDate.Text = DateTime.Today.ToString("dd-MMM-yyyy"); 
```

// 放入 PageonLoad

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-08-12T08:46:58.363

就我而言，我的目标是从 datetimePicker 工具中保存 TimeSpan 而不保存秒和毫秒，这就是解决方案。

首先将 datetimePicker.value 转换为您想要的格式，我的格式是“HH:mm”，然后将其转换回 TimeSpan。

```
var datetime = datetimepicker1.Value.ToString("HH:mm");
TimeSpan timeSpan = Convert.ToDateTime(datetime).TimeOfDay; 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2019-10-10T05:42:41.553

我知道答案很晚，但摆脱毫秒的最佳方法是

```
var currentDateTime = DateTime.Now.ToString("s"); 
```

尝试打印变量的值，它将显示日期时间，没有毫秒。

# .net - 记录依赖树

> ID：1004699
> 
> 赞同：3
> 
> 时间：2009-06-17T01:43:28.047
> 
> 标签：.net, vb6, documentation, visio

我需要在 vb6/dotnet 应用程序中记录程序集依赖项。

哪些技术/工具适合执行此类文档。

我打算使用 Visio 进行绘图。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T01:50:24.787

作为开始，请尝试[Dependency Visualizer](http://www.codeplex.com/dependencyvisualizer)。我还使用了[GraphViz 的 Dot](http://www.graphviz.org)和一些自定义代码来生成简单的依赖项。自定义代码递归调用 SysInternal 的depends.exe 并解析输出。 带有[Graph插件的](http://reflectoraddins.codeplex.com/Wiki/View.aspx?title=Graph)[.NET Reflector](http://www.red-gate.com/products/reflector/index.htm)看起来也很有前途，尽管我还没有尝试过。

我一直遇到的事实是，我的图表，除非是自动生成的，否则每次我添加到项目中时，有时当我只是改变一些东西时，都必须重新创建。所以，对我来说，我为更新而结婚的手动解决方案根本不是解决方案。

我刚刚找到了.NET Reflector 的[依赖结构矩阵插件](http://tcdev.free.fr/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T05:57:37.907

你看过[NDepend](http://www.ndepend.com/)吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T16:10:00.127

对于 .NET，您还可以尝试 VS2010 Beta 1 和 Architecture Explorer [（Arch Explorer 屏幕截图）](http://ajdotnet.wordpress.com/2009/03/29/visual-studio-2010-architecture-edition/)。

至于VB6，我也想有一个工具。这个从 Microsoft [Visual Basic 6.0 到 Visual Basic .NET 升级评估工具](http://www.microsoft.com/downloads/details.aspx?FamilyId=10C491A2-FC67-4509-BC10-60C5C039A272&displaylang=en) 的工具在 HTML 中为单个 VBP 创建调用图，不确定它对您有多大用处。除此之外，我还没有找到适用于 VB6 的工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-19T00:45:59.627

您可以在 VS 2010 Ultimate 中创建 .NET 程序集和应用程序项目的依赖关系图。您可以将程序集依赖关系图生成为标准图之一，也可以使用架构资源管理器浏览您的解决方案，选择您想要可视化的项目和关系，然后根据您的选择创建依赖关系图。

有关详细信息，请参阅以下主题：

**如何：从代码生成图形文档**：http : [//msdn.microsoft.com/en-us/library/dd409453%28VS.100%29.aspx#SeeSpecificSource](http://msdn.microsoft.com/en-us/library/dd409453%28VS.100%29.aspx#SeeSpecificSource)

**如何：使用架构资源管理器查找代码**：http : [//msdn.microsoft.com/en-us/library/dd409431%28VS.100%29.aspx](http://msdn.microsoft.com/en-us/library/dd409431%28VS.100%29.aspx)

**RC 下载**：[http](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=457bab91-5eb2-4b36-b0f4-d6f34683c62a) ://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=457bab91-5eb2-4b36-b0f4-d6f34683c62a 。

**Visual Studio 2010 架构发现和建模工具**论坛：[http ://social.msdn.microsoft.com/Forums/en-US/vsarch/threads](http://social.msdn.microsoft.com/Forums/en-US/vsarch/threads)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-06T13:37:59.083

为了完成 Eric 的答案，NDepend 确实带有一个[依赖图](http://www.ndepend.com/Doc_VS_Arch.aspx)和一个[依赖矩阵](http://www.ndepend.com/Doc_Matrix.aspx)。

![NDepend 依赖图](../Images/0a07f36e6c1a335faf745ea6b0ee0965.png)

![NDepend 依赖矩阵](../Images/4374cb48388c18a2599f3bf21739985c.png)

依赖关系图更容易理解，但是当节点数量增长（> 40）时，依赖关系矩阵通常会提供更清晰的情况视图。比如下面的 Matrix 代表了和 Graph 一样的依赖数据，但是明显更清晰。

![依赖矩阵与依赖图](../Images/c1b884a9b9a0efe640260d90e00e47e9.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T12:18:28.463

依赖可视化器适用于小型项目。对于具有许多相互依赖关系的项目或解决方案，它变得过于笨拙，甚至无法跟踪依赖关系图。

# c++ - Qt 中的模型 - 视图 - 控制器

> ID：1004701
> 
> 赞同：12
> 
> 时间：2009-06-17T01:44:23.850
> 
> 标签：c++, qt, model-view-controller, qitemdelegate

我或多或少地了解 MPV 的工作原理。但我不知道什么课程：

*   `QAbstractItemModel`
*   `QAbstractItemView`
*   `QAbstractItemDelegate`/`QItemDelegate`

可以为我做吗？

如果这是相关的，我正在使用 `QGraphicsScene`/`QGraphicsView`与用户可以交互的一些元素（游戏板的视觉表示），而交互逻辑（游戏规则）被封装在其他类中。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-17T07:29:21.900

## **AbstractItemModel QAbstractItemView QAbstractItemDelegate**

来自[“模式/视图框架”](https://doc.qt.io/qt-5/model-view-programming.html)
这是一个非常强大的框架，用于您的应用程序的数据部分，[这里](http://www.ics.com/learning/icsnetwork/)是该框架的介绍。

**QAbstractItemModel**

**是MVC 模型**的基类。具有用于访问和更改数据的全局接口，并负责 Observable 部分。

**QAbstractItemView**

**是MVC 视图**的基类。具有视图/选择部分的全局接口，它负责观察者部分。您不必担心观察者模式，框架会为您完成。

**QAbstractItemDelegate**

**是MVC 控制器**的基类。
是绘画，编辑元素的策略模式，......

* * *

## **QGraphicsScene / QGraphicsView**

来自[“图形视图框架”](https://doc.qt.io/qt-5/graphicsview.html)并且**独立于模型/视图框架。**
这也是一个非常强大的图形部分框架。

> **现场**
> 
> QGraphicsScene 提供了 Graphics View 场景。场景有以下职责：
> 
> 为管理大量项目提供快速接口向每个项目传播事件管理项目状态，例如选择和焦点处理提供未转换的渲染功能；主要用于印刷
> 
> **风景**
> 
> QGraphicsView 提供视图小部件，它可视化场景的内容。您可以将多个视图附加到同一个场景，以便为同一数据集提供多个视口

* * *

如果您希望模型在 QGraphicsView 中可见，则必须基于 QAbstractItemView 编写自己的视图。
将 QGraphicsView 作为视口小部件`QAbstractScrollArea::setViewport(QWidget * widget))` ，然后您可以

*   **添加** `QAbstractItemView::rowsInserted`,
*   **消除** `QAbstractItemView::rowsAboutToBeRemoved`
*   和**改变** `QAbstractItemView::dataChanged`

场景中的物品。不要忘记处理重置布局更改事件。

# asp.net - 如何使用 .pem 文件对 WCF 请求进行身份验证？

> ID：1004707
> 
> 赞同：0
> 
> 时间：2009-06-17T01:47:16.870
> 
> 标签：asp.net, wcf, security

我正在尝试使用亚马逊产品广告 API。他们为我提供了一个 .wsdl 文件，我通过 Visual Studio 2008 的“添加服务引用”选项使用并生成了包装类。这个包装类工作得很好，我已经成功地发送请求并接收来自亚马逊的响应。

但是，他们现在要求所有合作伙伴开始验证他们的请求。他们为我提供了两个 .pem 文件（一个称为我的 X.509 证书文件，另一个称为我的私钥文件）。我不完全确定如何处理这些文件。亚马逊声明如下：

**每个 SOAP 请求都必须使用与 X.509 证书关联的私钥进行签名。要创建签名，请对 Timestamp 元素进行签名，如果您使用的是 WS-Addressing，我们建议您还对 Action 标头元素进行签名。此外，您可以选择对 Body 和 To 标头元素进行签名**

我意识到这里可能需要提供更多信息，所以如果我需要提供更多详细信息以便得到这个问题的答案，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T13:36:26.770

Checkout this article --> [http://www.byteblocks.com/post/2009/06/15/Secure-Amazon-Web-Service-Request.aspx](http://www.byteblocks.com/post/2009/06/15/Secure-Amazon-Web-Service-Request.aspx)

Looks like it should help you out.

Other links that might help:

1) [http://developer.amazonwebservices.com/connect/thread.jspa?messageID=132705](http://developer.amazonwebservices.com/connect/thread.jspa?messageID=132705)

# php - 当其中有连字符时，是否有一种通用的方法可以在 Kohana 中路由 URL？

> ID：1004716
> 
> 赞同：0
> 
> 时间：2009-06-17T01:49:39.907
> 
> 标签：php, kohana

Kohana 会像这样自动设置 URL

[http://www.example.com/controller/method/argument1/argument2/etc](http://www.example.com/controller/method/argument1/argument2/etc)

现在我喜欢用破折号来分隔 URL 中的单词，我有一个这样的地址

[http://www.example.com/business-hub](http://www.example.com/business-hub)

我的控制器名为 BusinessHub_Controller。让我恼火的是 /business-hub/ 为了匹配 BusinesHub 控制器，我需要在 application/config 文件夹下的 routes.php 中添加一个自定义条目。似乎我必须为*每种*方法添加一个，这真的很烦人。例如，这里有一段摘录，

```
$config['business-hub'] = 'businesshub/index/';

$config['business-hub/logout'] = 'businesshub/logout';

$config['business-hub/media-releases'] = 'businesshub/mediareleases'; 
```

显然，这真的很烦人。无论如何我可以告诉 Kohana 将 URL 转换为 camelCase 名称，例如

```
$urlController = 'business-hub';

$correctController = str_replace('-', ' ', $urlController);

$correctController = ucwords($correctController);

$correctController = str_replace(' ', null, $correctController);

$correctController = $correctController . '_Controller'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T07:38:19.387

我不只是去掉破折号，而是将它们转换为下划线；我会用钩子来做。确保在 config/config.php 中启用了钩子，然后在名为 dashes_to_underscores.php 的钩子中创建一个文件：

```
function convert_dashes_to_underscores_in_url()
{
    Router::$current_uri = str_replace('-', '_', Router::$current_uri);
}

Event::add_before(
    'system.routing',
    array('Router', 'setup'),
    'convert_dashes_to_underscores_in_url'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T02:40:44.093

对于我不知道的 camelCase 变体，但这样的东西应该可以工作

```
$config['(a-z)+-?(a-z)*/(a-z)+-?(a-z)*'] = '$1$2/$3$4'; 
```

由于 kohana 中的路线部分是正则表达式。

当然，这严重限于您提供的案例。

# wcf - 可以为 NetNamedPipeBinding 设置 maxReceivedMessageSize 的最大大小是多少？

> ID：1004717
> 
> 赞同：40
> 
> 时间：2009-06-17T01:49:46.053
> 
> 标签：wcf, wcf-binding, netnamedpipebinding

我注意到 2147483647 似乎是 maxReceivedMessageSize 的流行选择，但这是限制吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-06-17T01:59:42.337

不，限制是[Int64.MaxValue](http://msdn.microsoft.com/en-us/library/system.int64.maxvalue.aspx) ^([1](http://blogs.msdn.com/yassers/archive/2006/01/21/515887.aspx))，即：9223372036854775807

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-01-28T07:27:57.007

basicHttpBinding 中的 MaxMessageReceivedSize 似乎是 int32 - 将其设置为 int32 的最大值会导致：

该工厂缓冲消息，因此消息大小必须在整数值范围内。参数名称：bindingElement.MaxReceivedMessageSize

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-24T12:19:46.887

`MaxReceivedMessageSize`和`MaxBufferSize`必须相同的值和`MaxBufferSize`是`Int32`。

# sharepoint - Sharepoint：使用自定义布局，webpart 的拖放不起作用

> ID：1004743
> 
> 赞同：0
> 
> 时间：2009-06-17T02:04:35.447
> 
> 标签：sharepoint, web-parts

我在 sharepoint 中拖放 webpart 时遇到问题。以下描述了我所做的事情：

1.  我正在使用 MOSS 2007。
2.  创建了一些基于原始 BlankWebPartPage.aspx 的自定义页面布局，并进行了调整以匹配我们的 HTML 雕刻。
3.  创建自定义 Web 部件。
4.  将这些 Web 部件附加到基于自定义布局的页面上。

现在 Web 部件工作正常，除了不能拖放到同一页面上的其他 Web 部件容器的部分。

如果有人可以告诉我：1.如何诊断问题的原因？2\. 拖放是否应该在自定义布局上工作？3\. 什么错误导致它不能工作？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T16:04:09.520

这是您遇到的问题：http: [//blog.mastykarz.nl/css-causes-javascript-error-while-moving-web-parts-in-edit-mode](http://blog.mastykarz.nl/css-causes-javascript-error-while-moving-web-parts-in-edit-mode/) /？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T02:41:26.440

没错，就是这个！里面还有一个链接：

[http://neilmosafi.blogspot.com/2007/11/sharepoint-dragging-webparts-causes.html](http://neilmosafi.blogspot.com/2007/11/sharepoint-dragging-webparts-causes.html)

该链接显示了一个 javascript 来解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T02:29:21.013

您可以尝试拖入区域容器的“添加 Web 部件”部分。我在将 Web 部件拖动到位时遇到问题，尤其是自定义 Web 部件。

另外，你能发布一些代码吗？特别是页面布局。随意剪掉最不重要的部分，但这应该有助于诊断您的问题。

# iphone - 在滚动视图崩溃方面需要帮助

> ID：1004748
> 
> 赞同：0
> 
> 时间：2009-06-17T02:07:43.270
> 
> 标签：iphone, xcode, crash

我正在尝试在 iPhone 的 Xcode 中显示大约 53 张图像，但大约第 37 张图像会使我的整个应用程序崩溃！如果有人在我的代码中发现任何错误，我将非常感谢您的帮助。谢谢！！

我想我不会在某个地方发布我的图像......只是不知道该怎么做！

```
#import "MyProjectViewController.h"

@implementation MyProjectViewController

@synthesize scrollView1;

- (BOOL)shouldAutorotateToInterfaceOrientation: (UIInterfaceOrientation)interfaceOrientation {
return (interfaceOrientation == UIInterfaceOrientationLandscapeRight);
}

const CGFloat kScrollObjHeight = 320.0;
const CGFloat kScrollObjWidth = 480.0;
const NSUInteger kNumImages = 53;

- (void)layoutScrollImages
{
UIImageView *view = nil;
NSArray *subviews = [scrollView1 subviews];
CGFloat curXLoc = 0;
for (view in subviews)
{
if ([view isKindOfClass:[UIImageView class]] && view.tag > 0)
{
CGRect frame = view.frame;
frame.origin = CGPointMake(curXLoc, 0);
view.frame = frame;

curXLoc += (kScrollObjWidth);
}
}

[scrollView1 setContentSize:CGSizeMake((kNumImages * kScrollObjWidth), [scrollView1 bounds].size.height)];
}

- (void)viewDidLoad
{
self.view.backgroundColor = [UIColor viewFlipsideBackgroundColor];

[scrollView1 setBackgroundColor:[UIColor blackColor]];
[scrollView1 setCanCancelContentTouches:NO];
scrollView1.indicatorStyle = UIScrollViewIndicatorStyleWhite;
scrollView1.clipsToBounds = YES;
scrollView1.scrollEnabled = YES;
scrollView1.pagingEnabled = YES;

NSUInteger i;

for (i = 1; i <= kNumImages; i++)
{
NSString *imageName = [NSString stringWithFormat:@"c1_%d.jpg", i];
UIImage *image = [UIImage imageNamed:imageName];
UIImageView *imageView = [[UIImageView alloc] initWithImage:image];

CGRect rect = imageView.frame;
rect.size.height = kScrollObjHeight;
rect.size.width = kScrollObjWidth;
imageView.frame = rect;
imageView.tag = i;
[scrollView1 addSubview:imageView];
[imageView release];

}

[self layoutScrollImages];

}

- (void)dealloc
{
[scrollView1 release];

[super dealloc];
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
}

@end 
```

谢谢！！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T07:10:54.243

图片有多大？我怀疑问题不在于代码本身，而在于 iPhone/iPod 的内存限制 - 如果您正在加载大图像，它们只会吃掉所有内存并且程序已关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T00:33:58.927

那么最可能的原因是你的内存不足。将 NSLog 消息放入 didReceiveMemoryWarning 以检查您是否收到内存不足的警告。

无论如何，我建议您延迟加载图像，而不是一次加载所有图像。它将大大减少您的应用程序的加载时间，也可能会解决您的内存问题。使用 UIScrollViewDelegate 根据 UIScrollView 偏移值的位置知道何时加载尚未加载的图像。

# png - 在某些应用程序中识别 PNG 的透明度，但在其他应用程序中不识别

> ID：1004758
> 
> 赞同：1
> 
> 时间：2009-06-17T02:12:37.630
> 
> 标签：png, transparency

我有一个 png 图像，你可以在这里看到：

[http://img10.imageshack.us/img10/9145/archer5.png](http://img10.imageshack.us/img10/9145/archer5.png)

精灵的背景是透明的，我在所有浏览器和 infranview（我曾经创建它）、gimp 和 windows 资源管理器中都看到了这一点。

然而，在 Photoshop、Paint 和最重要的 PHP GD 中，有一个坚实的背景。使用其中一个应用程序查看图像，看看我在说什么。

我的服务器上生成的缩略图都是纯背景，不好。

我该怎么做才能让所有应用程序都识别透明度？

谢谢。

注意：我还有 2000 张这样的图像需要进行相同的操作。任何批次的建议也会很棒。

编辑：对不起，我为我的无能道歉！错误的文件！我用正确的文件更新了链接，对不起！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T02:17:49.867

对我来说，它在 Photoshop 中有一个透明的背景。我猜如果它在某些应用程序中不透明，则应用程序（不支持透明度）的问题比文件的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T02:24:59.507

对我来说也是透明的。

MS Paint 不支持透明度

正如您提到的 PHP GD 检查此链接

[保留 PNG 图像的透明度](https://stackoverflow.com/questions/32243/can-png-image-transparency-be-preserved-when-using-phps-gdlib-imagecopyresampled)

[使用 PHP 调整和组合透明 PNG](http://alexle.net/archives/131)

[imagecolortransparent PHP 手册](http://www.php.net/manual/de/function.imagecolortransparent.php)

[imagealphablending PHP 手册](http://www.php.net/manual/de/function.imagealphablending.php)

[imagesavealpha PHP 手册](http://www.php.net/manual/de/function.imagesavealpha.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T02:22:42.040

GD 需要各种选项之一（直接或在创建新图像时在图像类型中）以输出透明像素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T02:38:00.090

我认为您的问题是应用程序本身。当您说 PHP GD 时，我认为您真正的意思是“Internet Explorer”（因为 PHP 不是查看器）。Internet Explorer（至少到 IE7）不做透明 PNG（它在后面放置一个灰色图像），除非你用 Alpha 过滤器做一些古怪的废话。

这是您在 safari 中的（更新的）图像（正确支持 PNG）：（ [来源：][[arc.net.au](http://www.test.dev.arc.net.au/images/alpha_png.png)][）][![替代文字](../Images/ba8b3bcfae0cbada69e9f9e765bf5f51.png)](https://i.stack.imgur.com/B0WCd.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T02:26:40.300

也许您可以尝试将它们保存为 24 位 PNG，而不是 32 位。也许 PHP GD 会对此有更好的支持。

# javascript - jquery 中的 val() 是什么？

> ID：1004763
> 
> 赞同：0
> 
> 时间：2009-06-17T02:15:27.373
> 
> 标签：javascript, jquery, ajax

我正在尝试学习 codeigniter 和 jquery。总是有一个没人解释的 val()。它是干什么用的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T02:17:22.690

说到 jQuery，一切都[在文档中](http://docs.jquery.com/Attributes/val)。

本质上，`val`功能是设置或获取元素的值。

如果您有一个输入字段，如下所示：

```
<input name='my_field' id='my_field' value='Hello World'> 
```

然后你可以这样做来获取字段的值：

```
var value = $('#my_field').val(); 
```

或者这样做来*设置*字段的值：

```
$('#my_field').val('My new value'); 
```

# cron - 为什么这个 cron 条目会执行两次？

> ID：1004764
> 
> 赞同：25
> 
> 时间：2009-06-17T02:15:35.563
> 
> 标签：cron

```
*/5 * * * * my command 
```

此条目有效，但每 5 分钟执行两次，为什么？

其中`/var/log/cron`显示：

```
Jun 16 22:20:01 Test CROND[12512]: (root) CMD (my command)
Jun 16 22:20:01 Test CROND[12516]: (root) CMD (my command) 
```

所以它不是来自两个用户。

它只用 输入一次`crontab -e -u root`。该命令是一个php命令。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-06-17T02:20:07.943

描述中没有给出执行两次的理由。看看别处。

*   有两个用户调用它吗？
*   是否输入两次？
*   它会调用自己吗？
*   它是否设置了重复的运动条件？

如果它是您正在执行的 shell 脚本，请将其附加`whoami`到`date`日志文件中。你应该能够找出原因。

# 更新

键入`ps -A | grep crond`，确保 crond 没有运行两次。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-11-12T12:03:14.103

crontab 中的 wget 通常有 15 分钟的限制。在我们的例子中，情况就是这样，在这 15 分钟之后，作业以超时结束，然后立即重新运行。因此，解决方案是在 crontab 中设置 cronjob，如下所示：

```
1 2 * * * root wget --read-timeout=3600 -O - 'http://cron-job-url' >/dev/null 2>&1 
```

...代替

```
 1 2 * * * root wget -O - 'http://cron-job-url' >/dev/null 2>&1 
```

所以，wget 就是这样。意思是 3600 = 1 小时。或者更多，如果你需要！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T02:28:57.363

如果它是您安装的应用程序的命令，则可能它已经在`/etc/crontab`or中添加了相同的条目`/etc/cron.d/<something>`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-24T12:50:25.283

我确实确认 - 我的 cron 也运行了两次......

```
Jul 24 14:40:01 localhost cron[2713]: (root) CMD (/etc/apache2/generator/reloader.do)
Jul 24 14:41:01 localhost cron[9481]: (root) CMD (/etc/apache2/generator/reloader.do)
Jul 24 14:41:01 localhost cron[10724]: (root) CMD (/etc/apache2/generator/reloader.do)
Jul 24 14:42:01 localhost cron[20380]: (root) CMD (/etc/apache2/generator/reloader.do)
Jul 24 14:42:01 localhost cron[20832]: (root) CMD (/etc/apache2/generator/reloader.do) 
```

我的 crontab

grep -R /var/spool/ -e 重载

```
/var/spool/cron/crontabs/root:* * * * * /etc/apache2/generator/reloader.do 
```

输出：

```
whoami
date
------ 
```

输出：

```
root
root
Tue Jul 24 14:46:02 CEST 2012
---------
Tue Jul 24 14:46:03 CEST 2012
--------- 
```

我目前的解决方法是：

```
if [ -f /etc/apache2/generator/reloader.lock ]
then
exit
fi
touch /etc/apache2/generator/reloader.lock
/etc/apache2/generator/reloader
rm /etc/apache2/generator/reloader.lock 
```

但这不是为什么会发生这种情况的答案......

系统 - gentoo Cron - vixie-cron

部分`ps aux wwf`输出（在 cron 任务中午餐）

```
root     10843  0.0  0.0  16480   560 ?        Ss   Jun06   0:01 /usr/sbin/cron
root     29797  0.0  0.0  25020   964 ?        S    15:08   0:00  \_ /usr/sbin/cron
root     29799  0.0  0.0   9188  1228 ?        Ss   15:08   0:00      \_ /bin/bash /etc/apache2/generator/reloader
root     29822  0.0  0.0  14800   988 ?        R    15:08   0:00          \_ ps aux wwf
------
root      8215  0.0  0.0  16480   836 ?        Ss   14:23   0:00 /usr/sbin/cron
root     31419  0.0  0.0  25020   968 ?        S    15:08   0:00  \_ /usr/sbin/cron
root     31423  0.0  0.0   9188  1228 ?        Ss   15:08   0:00      \_ /bin/bash /etc/apache2/generator/reloader
root     31431  0.0  0.0  14804  1004 ?        R    15:08   0:00          \_ ps aux wwf 
```

编辑：

我确实注意到，其中一个 cron 进程报告 Jun06 作为开始日期（今天是 Jun24）

```
root     10843  0.0  0.0  16480   560 ?        Ss   Jun06   0:01 /usr/sbin/cron
root      8215  0.0  0.0  16480   836 ?        Ss   14:23   0:00 /usr/sbin/cron 
```

第二个进程报告正确（服务器正常运行时间约为 40 分钟 - 我最近确实重新启动了它）一个重要信息 - 它是在主机上运行的 V-server。

无论我做什么（/etc/init.d/vixie-cron restart）它都以相同的 PID 开始

解决了：

我找到了原因。一个 V-server 运行了两次，使用不同的上下文。可能的解释 - 有人在机器运行时更​​改了上下文，因此，并非所有进程都被杀死，还有更多 - 它们确实影响了 vserver 的新实例（上下文 303 和 3031）：

```
root     10843  3031 developer      0.0  0.0  16480   560 ?        Ss   Jun06   0:01 /usr/sbin/cron
root     16509   303 developer      0.0  0.0  16480   836 ?        Ss   15:18   0:00 /usr/sbin/cron 
```

我已经 TERM 旧流程，问题已解决。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T02:28:38.067

可以肯定的是，导致它运行两次的不是 crontab 条目。找出发生了什么的最快方法是在 cron 作业脚本中添加一些调试。如果您什么都不做，那么默认情况下 cron 输出将被邮寄到`root@localhost`（除非您已将其配置为不同），因此假设您具有 root 访问权限，请在脚本中添加一些调试信息，例如：

```
echo "Script starting"
date
whoami 
```

并查看输出。这将使您开始弄清楚它是如何被调用两次的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-12-11T19:51:09.250

我曾经遇到过同样的问题，在我的情况下，我错误地初始化了 cron 服务两次。在我停止 cron`# /etc/init.d/crond stop`并再次启动它之后`# /etc/init.d/crond start`，它运行良好。

我希望这可以帮助任何人。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-09-17T14:13:46.127

我*以为*cron 两次启动了我的 bash 脚本，但我错了。我想我会为了（希望）他人的利益而分享我的经验。这让我有点摸不着头脑...

在 cron 启动的那一刻，“ps aux”输出从显示我的脚本运行的 0 个实例变为两个实例，或者乍一看似乎是这样：

```
kdeen    1797750  0.0  0.0   2608   600 ?        Ss   15:52   0:00 /bin/sh -c /home/kdeen/bin/once-a-day-local.sh
kdeen    1797751  0.0  0.0  19520  3488 ?        S    15:52   0:00 /bin/bash /home/kdeen/bin/once-a-day-local.sh 
```

但仔细看，我看到一个实例是 /bin/sh -c，另一个是 /bin/bash。这是正确的行为。我的脚本以“#!/bin/bash”开头，但 cron 总是使用 /bin/sh 运行东西。所以有一个“sh”启动器进程，然后是我的 bash 脚本。都好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-09-30T11:36:41.160

看起来你有两个 crond 正在运行，一个是 PID 12512，一个是 PID 12516。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-05-27T13:57:40.723

我使用 OpenWrt。

我有同样的问题，但我只有一个 cron ：ps | grep crond ：

```
31447 root      1508 S    /usr/sbin/crond -c /etc/crontabs -l 8 
31454 root      1500 S    sh -c ps | grep crond 
31456 root      1496 S    grep crond 
```

日志读取 | grep cron

```
May 27 13:15:01 decibox cron.info crond[31447]: crond: USER root pid 1594 cmd /root/check_connect.php.sh 
May 27 13:20:01 decibox cron.info crond[31447]: crond: USER root pid 2103 cmd /root/check_connect.php.sh 
May 27 13:20:01 decibox cron.info crond[31447]: crond: USER root pid 2325 cmd /root/check_connect.php.sh 
May 27 13:25:01 decibox cron.info crond[31447]: crond: USER root pid 2880 cmd /root/check_connect.php.sh 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-12-20T11:56:43.233

由于 conf 文件中的双重输入，我遇到了同样的问题：

```
# grep /syslog /etc/rsyslog.conf /etc/rsyslog.d/50-default.conf 
/etc/rsyslog.conf:*.*;auth,authpriv,kern,mail.none      -/var/log/syslog
/etc/rsyslog.d/50-default.conf:*.*;auth,authpriv,kern,mail.none -/var/log/syslog 
```

明确评论 2 之一解决了问题

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-08-15T22:32:38.553

运行 ps -A | grep cron，杀死所有工作对我来说没有帮助。问题是在杀死所有 cron 作业并仅使用一个 cron 守护程序重新开始之后，我会从同一个父 cron PPID 开始两个 cron 作业 - 一个使用 /bin/bash - 另一个使用 /bin/sh

解决方案是重新启动服务器。

这发生在好几次，不同的操作系统 - centos 6 和 redhat 7。通常在在线操作系统升级后无需重启。

正如有人所说 - 可能是一些不同的背景。

我在网上看到一篇文章，其中一篇与 /bin/bash 完全相同，另一篇与 /bin/sh 完全相同 - 我想是的 - 这是我的情况 - 但不，这家伙甚至没有想过什么是这种奇怪行为的根本原因是，刚刚开始编写一些脚本逻辑以使第二个进程退出，这并不是真正的解决方案。

顺便说一句 ps -A | grep cron 还将列出所有 cron 子进程 - 正常的 cron 作业，更多的 cron 进程并不意味着它有更多的 cron 守护进程，可能只有一个守护进程，而其他守护进程是子进程。

ps -ef | 另一方面，grep cron 只列出一个 - 为什么？因为 ps -ef 将孩子列为 CROND - 让他们都做 ps -ef | grep -i cron

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-09-22T14:49:31.890

我最近从 vixie-cron 迁移到 cronie 并注意到我的根 crontab 是我的用户 crontab 文件的副本。

以用户和 root 身份执行/运行“crontab -e”，并检查文件以确保没有发出重复的命令。

作为根：

# crontab -e

作为用户：$ crontab -e

如果文件非常相似，最好在不需要的 crontab 内容中插入“# TEST”注释，以确保在删除 crontab 文件的内容之前不存在符号链接或其他异常。

# iphone - NSMutableArray 不响应 objectAtIndex 选择器

> ID：1004766
> 
> 赞同：1
> 
> 时间：2009-06-17T02:15:59.620
> 
> 标签：iphone, objective-c, nsmutablearray

好的，我知道我是 obj-c 的新手，但出于所有意图和目的，以下似乎应该可以工作：

```
songCollection = [[NSMutableArray alloc] init];
    [songCollection addObject:@"test"];
    //Array is init, and I can see it in the debugger.
    songCollection = [GeneralFunctions getJSONAsArray:@"library"];
    // I can see the expected data in the debugger after this.
    [songCollection retain];
    NSLog(@"%@", [songCollection objectAtIndex:0]);
        // Crashes here due to the array not responding to the selector. Also, the array is now empty.
    //NSLog(@"%@", songCollection);
    NSArray * songList = [songCollection objectAtIndex:1];
    NSLog(@"%@", songList); 
```

我希望有人可以在这里帮助我，我正在用头撞墙！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T02:28:34.803

`songCollection`最初是一个 NSMutableArray，但后来你用从`[GeneralFunctions getJSONAsArray:@"library"]`. 不管那是什么，它可能不是一个数组。

顺便说一句，您在这里泄漏了一个数组。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-17T05:20:42.673

让我们一步一步地拆开你的代码。

```
songCollection = [[NSMutableArray alloc] init]; 
```

分配一个新的空 NSMutableArray。

```
[songCollection addObject:@"test"]; 
```

将 NSString @"test" 添加到 NSMutableArray songCollection

```
songCollection = [GeneralFunctions getJSONAsArray:@"library"]; 
```

丢弃对您创建的可变数组的引用（从而泄漏内存），并为您提供一个指向您尚未拥有的东西的新指针。

```
[songCollection retain]; 
```

很好，您拥有 songCollection 的所有权。并且由于这有效，您知道 getJSONAsArray 返回 nil 或 NSObject。

```
NSLog(@"%@", [songCollection objectAtIndex:0]);
// Crashes here due to the array not responding to the selector. Also, the array is now empty. 
```

很明显，songCollection 既不是零，也不是 NSArray（可变或其他）。检查 GeneralFunctions getJSONAsArray 的文档或签名并查看它实际返回的内容。

```
//NSLog(@"%@", songCollection); 
```

这个输出是什么 - 这应该告诉你 songCollection 实际上是什么。

假设您弄清楚为什么 getJSONAsArray 没有返回 NSArray，您可以将 NSArray 转换为 NSMutableArray

```
songCollection = [[GeneralFunctions getJSONAsArray:@"library"] mutableCopy];
// You now own songCollection 
```

或者

```
songCollection = [[NSMutableArray alloc] init];
// You now own songCollection
[songCollection addObjectsFromArray:[GeneralFunctions getJSONAsArray:@"library"]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T02:27:37.710

[GeneralFunctions getJSONAsArray:@"library"] 实际上返回一个 NSArray 吗？

您还忘记在重新分配该行之前释放 songCollection。

# c# - 将 HTML 写入字符串

> ID：1004776
> 
> 赞同：50
> 
> 时间：2009-06-17T02:19:34.807
> 
> 标签：c#, html

我有这样的代码。有没有办法让它更容易编写和维护？使用 C# .NET 3.5。

```
string header(string title)
{
    StringWriter s = new StringWriter();
    s.WriteLine("{0}","<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\">");
    s.WriteLine("{0}", "<html>");
    s.WriteLine("<title>{0}</title>", title);
    s.WriteLine("{0}","<link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\">");
    s.WriteLine("{0}", "</head>");
    s.WriteLine("{0}", "<body>");
    s.WriteLine("{0}", "");
} 
```

我也可以写：

```
s.WriteLine("{0}", @"blah blah

many
new
lines
blah UHY#$&_#$_*@Y KSDSD<>\t\t\t\t\t\tt\t\t\\\t\t\t\t\\\h\th'\h't\th
hi
done"); 
```

它会起作用，但我需要`"`用`""`.

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-06-17T02:23:59.650

使用 an[`HtmlTextWriter`](http://msdn.microsoft.com/en-us/library/system.web.ui.htmltextwriter.aspx)或 an可能[`XMLWriter`](https://msdn.microsoft.com/en-us/library/System.Xml.XmlWriter%28v=vs.110%29.aspx)比使用 plain更好`StringWriter`。他们会为您转义，并确保文档格式正确。

[此页面](http://dotnetperls.com/htmltextwriter)显示了使用`HtmlTextWriter`该类的基础知识，其要点是：

```
StringWriter stringWriter = new StringWriter();

using (HtmlTextWriter writer = new HtmlTextWriter(stringWriter))
{
    writer.AddAttribute(HtmlTextWriterAttribute.Class, classValue);
    writer.RenderBeginTag(HtmlTextWriterTag.Div); // Begin #1

    writer.AddAttribute(HtmlTextWriterAttribute.Href, urlValue);
    writer.RenderBeginTag(HtmlTextWriterTag.A); // Begin #2

    writer.AddAttribute(HtmlTextWriterAttribute.Src, imageValue);
    writer.AddAttribute(HtmlTextWriterAttribute.Width, "60");
    writer.AddAttribute(HtmlTextWriterAttribute.Height, "60");
    writer.AddAttribute(HtmlTextWriterAttribute.Alt, "");

    writer.RenderBeginTag(HtmlTextWriterTag.Img); // Begin #3
    writer.RenderEndTag(); // End #3

    writer.Write(word);

    writer.RenderEndTag(); // End #2
    writer.RenderEndTag(); // End #1
}
// Return the result.
return stringWriter.ToString(); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-06-17T02:25:19.960

当我用其他语言处理这个问题时，我会分离代码和 HTML。就像是：

1.) 创建一个 HTML 模板。使用`[varname]`占位符来标记替换/插入的内容。
2.) 从数组或结构/映射/字典中填充模板变量

```
Write( FillTemplate(myHTMLTemplate, myVariables) ) # pseudo-code 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-01-09T20:48:13.820

使用 an`XDocument`创建 DOM，然后使用`XmlWriter`. 这将为您提供非常简洁易读的符号以及格式良好的输出。

拿这个示例程序：

```
using System.Xml;
using System.Xml.Linq;

class Program {
    static void Main() {
        var xDocument = new XDocument(
            new XDocumentType("html", null, null, null),
            new XElement("html",
                new XElement("head"),
                new XElement("body",
                    new XElement("p",
                        "This paragraph contains ", new XElement("b", "bold"), " text."
                    ),
                    new XElement("p",
                        "This paragraph has just plain text."
                    )
                )
            )
        );

        var settings = new XmlWriterSettings {
            OmitXmlDeclaration = true, Indent = true, IndentChars = "\t"
        };
        using (var writer = XmlWriter.Create(@"C:\Users\wolf\Desktop\test.html", settings)) {
            xDocument.WriteTo(writer);
        }
    }
} 
```

这会生成以下输出：

```
<!DOCTYPE html >
<html>
    <head />
    <body>
        <p>This paragraph contains <b>bold</b> text.</p>
        <p>This paragraph has just plain text.</p>
    </body>
</html> 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-06-17T03:09:48.513

我知道你问过 C#，但如果你愿意使用任何 .Net 语言，那么我强烈推荐 Visual Basic 来解决这个确切的问题。Visual Basic 有一个称为 XML Literals 的功能，它允许您编写这样的代码。

```
Module Module1

    Sub Main()

        Dim myTitle = "Hello HTML"
        Dim myHTML = <html>
                         <head>
                             <title><%= myTitle %></title>
                         </head>
                         <body>
                             <h1>Welcome</h1>
                             <table>
                                 <tr><th>ID</th><th>Name</th></tr>
                                 <tr><td>1</td><td>CouldBeAVariable</td></tr>
                             </table>
                         </body>
                     </html>

        Console.WriteLine(myHTML)
    End Sub

End Module 
```

这允许您以旧的 ASP 样式编写带有表达式漏洞的直接 HTML，并使您的代码具有超级可读性。不幸的是，此功能不在 C# 中，但您可以在 VB 中编写单个模块并将其添加为对 C# 项目的引用。

在 Visual Studio 中编写还允许对大多数 XML 文字和表达式整体进行适当的缩进。在 VS2010 中，表达式孔的缩进效果更好。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-17T03:00:31.480

你可以使用`System.Xml.Linq`对象。它们从过去完全重新设计，`System.Xml`这使得从头开始构建 XML 真的很烦人。

除了我猜的 doctype 之外，您还可以轻松地执行以下操作：

```
var html = new XElement("html",
    new XElement("head",
        new XElement("title", "My Page")
    ),
    new XElement("body",
        "this is some text"
    )
); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-06-17T02:26:10.690

```
return string.Format(@"<!DOCTYPE HTML PUBLIC ""-//W3C//DTD HTML 4.01//EN""      ""http://www.w3.org/TR/html4/strict.dtd"">
<html>
<title>{0}</title>
<link rel=""stylesheet"" type=""text/css"" href=""style.css"">
</head>
<body>
", title); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-06-17T02:37:33.087

最直接的方法是使用 XmlWriter 对象。这可用于生成有效的 HTML，并为您处理所有讨厌的转义序列。

*   [http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.aspx](http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.aspx)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-02-17T09:07:25.513

您可以使用**T4 模板**从您的代码生成 Html（或任何）。看到这个：http: [//msdn.microsoft.com/en-us/library/ee844259.aspx](http://msdn.microsoft.com/en-us/library/ee844259.aspx)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-17T02:30:51.807

您可以使用 ASP.NET 在网页上下文之外生成 HTML。 [这是一篇文章](http://aspnet.4guysfromrolla.com/articles/122006-1.aspx)，展示了如何做到这一点。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-06-17T03:17:48.247

如果您希望创建类似于在 C# 中创建 XML 文档的 HTML 文档，您可以尝试使用 Microsoft 的开源库[Html Agility Pack](http://www.codeplex.com/htmlagilitypack)。

它提供了一个 HtmlDocument 对象，该对象具有与[`System.Xml.XmlDocument`](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)该类非常相似的 API。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-12-12T19:23:51.533

随着在 ASP.net MVC 中引入 Razor，在 C# 中编写 HTML 的最佳方式是使用 Razor 引擎。

```
string templatePath = $@"{Directory.GetCurrentDirectory()}\EmailTemplates"; 

IRazorLightEngine engine = EngineFactory.CreatePhysical(templatePath); 

var model = new Notification 
{ 
       Name = "Jone", 
       Title = "Test Email", 
       Content = "This is a test" 
}; 

string result = engine.Parse("template.cshtml", model); 
```

模板：

```
<h2>Dear @Model.Name, you have a notification.</h2> 

<h1>@Model.Title</h1> 
<p>@Model.Content</p> 

<p>Date:@DateTime.Now</p> 
```

有关完整示例，请参见[此处](https://code.msdn.microsoft.com/How-to-use-razor-engine-089934a6)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-10-18T11:14:26.820

您可以使用一些第三方开源库来生成强类型验证 (X)HTML，例如[CityLizard Framework](http://citylizard.codeplex.com/ "CityLizard 框架")或 Sharp DOM。

**更新**例如

```
html
    [head
        [title["Title of the page"]]
        [meta_(
            content: "text/html;charset=UTF-8",
            http_equiv: "Content-Type")
        ]
        [link_(href: "css/style.css", rel: "stylesheet", type: "text/css")]
        [script_(type: "text/javascript", src: "/JavaScript/jquery-1.4.2.min.js")]
    ]
    [body
        [div
            [h1["Test Form to Test"]]
            [form_(action: "post", id: "Form1")
                [div
                    [label["Parameter"]]
                    [input_(type: "text", value: "Enter value")]
                    [input_(type: "submit", value: "Submit!")]
                ]
            ]
            [div
                [p["Textual description of the footer"]]
                [a_(href: "http://google.com/")
                    [span["You can find us here"]]
                ]
                [div["Another nested container"]]
            ]
        ]
    ]; 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-17T03:37:16.273

[这不是一个通用的解决方案，但是，如果您的目的是拥有或维护电子邮件模板，那么 System.Web 有一个名为MailDefinition](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.maildefinition.aspx)的内置类。ASP.NET 成员控件使用此类来创建 HTML 电子邮件。

执行与上面提到的相同类型的“字符串替换”操作，但将其全部打包到 MailMessage 中。

这是来自 MSDN 的示例：

```
ListDictionary replacements = new ListDictionary();
replacements.Add("<%To%>",sourceTo.Text);
replacements.Add("<%From%>", md.From);
System.Net.Mail.MailMessage fileMsg;
fileMsg = md.CreateMailMessage(toAddresses, replacements, emailTemplate, this); 
return fileMsg; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-17T02:46:37.810

您可以使用其 Render 方法和其他属性编写自己的类，以避免大量使用它时造成很大的混乱，然后也使用 HTMLWriter 或 xmlwriter。此逻辑用于 asp.net 页面，您可以从 webControl 继承并覆盖[render 方法](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webcontrol.render.aspx)，如果您正在开发服务器端控件，那就太好了。
[这](http://www.codeproject.com/KB/webforms/customhtmlattributes.aspx)可能是一个很好的例子。

问候

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-17T02:52:08.783

这真的取决于你的目标，特别是你真正需要提供什么样的性能。

我已经看到了令人赞叹的强类型 HTML 开发解决方案（完整的控件模型，无论是 ASP.NET Web 控件，还是类似的），它们只会给项目增加惊人的复杂性。在其他情况下，它是完美的。

按照 C# 世界中的优先顺序，

*   ASP.NET Web 控件
*   ASP.NET 基元和 HTML 控件
*   XmlWriter 和/或 HtmlWriter
*   如果使用 HTML 互操作性进行 Silverlight 开发，请考虑强类型的内容，如[链接文本](http://www.jeff.wilcox.name/2008/11/managed-html-controls-source/)
*   StringBuilder 和其他超级原语

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-11-26T08:16:48.687

我写了这些对我很有帮助的课程。它简单而实用。

```
public class HtmlAttribute
{
    public string Name { get; set; }
    public string Value { get; set; }

    public HtmlAttribute(string name) : this(name, null) { }

    public HtmlAttribute(
        string name,
        string @value)
    {
        this.Name = name;
        this.Value = @value;
    }

    public override string ToString()
    {
        if (string.IsNullOrEmpty(this.Value))
            return this.Name;

        if (this.Value.Contains('"'))
            return string.Format("{0}='{1}'", this.Name, this.Value);

        return string.Format("{0}=\"{1}\"", this.Name, this.Value);
    }
}

public class HtmlElement
{
    protected List<HtmlAttribute> Attributes { get; set; }
    protected List<object> Childs { get; set; }
    public string Name { get; set; }
    protected HtmlElement Parent { get; set; }

    public HtmlElement() : this(null) { }

    public HtmlElement(string name, params object[] childs)
    {
        this.Name = name;
        this.Attributes = new List<HtmlAttribute>();
        this.Childs = new List<object>();

        if (childs != null && childs.Length > 0)
        {
            foreach (var c in childs)
            {
                Add(c);
            }
        }
    }

    public void Add(object o)
    {
        var a = o as HtmlAttribute;
        if (a != null)
            this.Attributes.Add(a);
        else
        {
            var h = o as HtmlElement;
            if (h != null && !string.IsNullOrEmpty(this.Name))
            {
                h.Parent = this;
                this.Childs.Add(h);
            }
            else
                this.Childs.Add(o);
        }
    }

    public override string ToString()
    {
        var result = new StringBuilder();

        if (!string.IsNullOrEmpty(this.Name))
        {
            result.Append(string.Format("<{0}", this.Name));
            if (this.Attributes.Count > 0)
            {
                result.Append(" ");
                foreach (var attr in this.Attributes)
                {
                    result.Append(attr.ToString());
                    result.Append(" ");
                }

                result = new StringBuilder(result.ToString().TrimEnd(' '));
            }

            if (this.Childs.Count == 0)
            {
                result.Append(" />");
            }
            else
            {
                result.AppendLine(">");

                foreach (var c in this.Childs)
                {
                    var cParts = c.ToString().Split('\n');

                    foreach (var p in cParts)
                    {
                        result.AppendLine(string.Format("{0}", p));
                    }
                }

                result.Append(string.Format("</{0}>", this.Name));
            }
        }
        else
        {
            foreach (var c in this.Childs)
            {
                var cParts = c.ToString().Split('\n');

                foreach (var p in cParts)
                {
                    result.AppendLine(string.Format("{0}", p));
                }
            }
        }

        var head = GetHeading(this);

        var ps = result.ToString().Split('\n');
        return string.Join("\r\n", (from p in ps select head + p.TrimEnd('\r')).ToArray());
    }

    string GetHeading(HtmlElement h)
    {
        if (h.Parent != null)
            return "    ";
        else
            return string.Empty;
    }
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-12-02T15:14:11.740

我正在寻找看起来像 jquery 的东西来在 C# 中生成 dom（我不需要解析）。不幸的是，没有找到一个轻量级的解决方案，所以我创建了这个继承自 System.Xml.Linq.XElement 的简单类。关键特性是您可以像在 javascript 中使用 jquery 一样链接运算符，因此它更加流畅。它功能不全，但可以满足我的需要，如果有兴趣，我可以启动一个 git。

```
public class DomElement : XElement
{
    public DomElement(string name) : base(name)
    {
    }

    public DomElement(string name, string value) : base(name, value)
    {
    }

    public DomElement Css(string style, string value)
    {
        style = style.Trim();
        value = value.Trim();
        var existingStyles = new Dictionary<string, string>();
        var xstyle = this.Attribute("style");
        if (xstyle != null)
        {
            foreach (var s in xstyle.Value.Split(';'))
            {
                var keyValue = s.Split(':');
                existingStyles.Add(keyValue[0], keyValue.Length < 2 ? null : keyValue[1]);
            }
        }

        if (existingStyles.ContainsKey(style))
        {
            existingStyles[style] = value;
        }
        else
        {
            existingStyles.Add(style, value);
        }

        var styleString = string.Join(";", existingStyles.Select(s => $"{s.Key}:{s.Value}"));
        this.SetAttributeValue("style", styleString);

        return this;
    }

    public DomElement AddClass(string cssClass)
    {
        var existingClasses = new List<string>();
        var xclass = this.Attribute("class");
        if (xclass != null)
        {
            existingClasses.AddRange(xclass.Value.Split());
        }

        var addNewClasses = cssClass.Split().Where(e => !existingClasses.Contains(e));
        existingClasses.AddRange(addNewClasses);

        this.SetAttributeValue("class", string.Join(" ", existingClasses));
        return this;
    }

    public DomElement Text(string text)
    {
        this.Value = text;
        return this;
    }

    public DomElement Append(string text)
    {
        this.Add(text);
        return this;
    }

    public DomElement Append(DomElement child)
    {
        this.Add(child);
        return this;
    }
} 
```

样本：

```
void Main()
{
    var html = new DomElement("html")
        .Append(new DomElement("head"))
        .Append(new DomElement("body")
            .Append(new DomElement("p")
                .Append("This paragraph contains")
                .Append(new DomElement("b", "bold"))
                .Append(" text.")
                )
            .Append(new DomElement("p").Text("This paragraph has just plain text"))
            )
        ;

    html.ToString().Dump();

    var table = new DomElement("table").AddClass("table table-sm").AddClass("table-striped")
            .Append(new DomElement("thead")
                .Append(new DomElement("tr")
                    .Append(new DomElement("td").Css("padding-left", "15px").Css("color", "red").Css("color", "blue")
                        .AddClass("from-now")
                        .Append(new DomElement("div").Text("Hi there"))
                        .Append(new DomElement("div").Text("Hey there"))
                        .Append(new DomElement("div", "Yo there"))
                        )
                )
            )
        ;
    table.ToString().Dump();
} 
```

上述代码的输出：

```
<html>
  <head />
  <body>
    <p>This paragraph contains<b>bold</b> text.</p>
    <p>This paragraph has just plain text</p>
  </body>
</html>
<table class="table table-sm table-striped">
  <thead>
    <tr>
      <td style="padding-left:15px;color:blue" class="from-now">
        <div>Hi there</div>
        <div>Hey there</div>
        <div>Yo there</div>
      </td>
    </tr>
  </thead>
</table> 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-06-20T04:54:18.543

HSharp 是一个用于轻松快速地分析 HTML 等标记语言的库。安装：`PM> Install-Package Obisoft.HSharp`

```
 var Document = new HDoc(DocumentOptions.BasicHTML);
        Document["html"]["body"].AddChild("div");
        Document["html"]["body"]["div"].AddChild("a", new HProp("href", "/#"));
        Document["html"]["body"]["div"].AddChild("table");
        Document["html"]["body"]["div"]["table"].AddChildren(
         new HTag("tr"),
         new HTag("tr", "SomeText"),
         new HTag("tr", new HTag("td")));
        var Result = Document.GenerateHTML();
        Console.WriteLine(Result); 
```

和输出：

```
<html>
<head>
<meta charset="utf-8"></meta><title>
Example </title>
</head>
<body>
<div>
<a href="/#"></a><table>
<tr></tr><tr>
SomeText </tr>
<tr>
<td></td></tr>
</table>
</div>
</body>
</html> 
```

# c# - MSVC++ rand() 和 C# System.Random 之间的关系

> ID：1004807
> 
> 赞同：0
> 
> 时间：2009-06-17T02:29:38.640
> 
> 标签：c#, c++, random

我怎样才能让它从 MSVC++ 程序和 C# .NET 程序中产生相同的随机数序列？

是否可以？`rand()`MSVC++和之间有什么关系`System.Random`吗？

鉴于下面的示例，它们似乎完全不同。

```
#include <iostream>
using namespace std;

int main()
{
  srand( 1 ) ;

  cout << rand() << endl <<
    rand() << endl <<
    rand() << endl ;
} 
```

```
using System;

class Program
{
  static void Main( string[] args )
  {
    Random random = new Random( 1 );

    Console.WriteLine( random.Next() );
    Console.WriteLine( random.Next() );
    Console.WriteLine( random.Next() );
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T02:33:30.943

最简单的方法是对包含随机数生成器的 C++ DLL 进行非托管引用，并将参数作为种子。然后你可以确定它们是一样的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T02:46:11.120

是的，它们是非常不同的功能。有时您会发现 BCL 类只是使用 PInvoke 执行它们的原生对应物的非常薄的包装器。System.Random 并非如此。它是一个 100% 托管的实现，完全独立于 srand 版本。

你能帮我们解释一下为什么你想要相同的一组数字吗？例如是为了测试吗？

如果您确实想要拥有相同的随机数集，一个选择是创建一个简单的 COM 对象来包装 srand。COM 对象将可用于您的托管代码和本机代码，因此将能够在两个地方提供相同的算法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T02:35:27.070

在非托管 C++ 中使用 .NET 托管库是可能的（不是很容易）。您可能想查看[MSDN](http://msdn.microsoft.com/en-us/library/zsfww439(vs.71).aspx)文档。

# ruby-on-rails - 当您不想使用图像标签时如何获取rails图像路径

> ID：1004809
> 
> 赞同：2
> 
> 时间：2009-06-17T02:30:16.487
> 
> 标签：ruby-on-rails, image

我正在使用带有导轨的 slimbox2。为了使它工作，您包括一些标记，如下所示：

```
<a href="resources/images/weight1.jpg" rel="lightbox-a" title="Beautiful, isn't it?">a</a> 

<a href="resources/images/example.jpg" rel="lightbox-a" title="Beautiful, isn't it?">a</a> 
```

所以我想知道，您如何获取图像的位置以放置在 href 中？相对寻址？他们是在这种情况下有用的帮手吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-17T03:48:54.287

你想要图像的路径吗？您可以尝试恰当命名的[#image_path](http://apidock.com/rails/ActionView/Helpers/AssetTagHelper/image_path)辅助方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T02:37:03.073

你可以使用这样的东西。助手有点用处。老实说，除非有一些动态组件，否则只使用 HTML 并没有错

```
link_to("a","/resources/images/weight1.jpg", :rel=>"lightbox-a", :title=>"Beautiful, isn't it?") 
```

如果图像是动态的，您始终可以为图像的路径分配一个变量（确定您喜欢的方式）

```
<a href="<%= @image_path %>" rel="lightbox-a" title="Foo" />a</a> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T06:54:06.037

好吧，假设图像在您的 public/images 文件夹中，您可以通过类似

```
<%= link_to 'a', image_path('weight1.jpg'), :rel => 'lightbox-a', :title => 'some title' %> 
```

# ms-access - MS Access 值得学习吗？

> ID：1004813
> 
> 赞同：2
> 
> 时间：2009-06-17T02:31:38.667
> 
> 标签：ms-access

自带Office，是一个“中好”的数据库，到今天为止这里有800多个问题，但我从来没有关注过。

我失去了一些有趣的东西？

我说的是 MS-Access 作为快速原型设计（或类似的东西）的 IDE，而不是仅将 MS-Access 作为数据库。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-01-04T23:52:30.833

MS Access 非常适合：

*   原型数据库和数据库前端
*   在没有任何正式设计、书面规范等的情况下创建基于数据库的内部部门解决方案。在所有快速需要和有很多想法的环境中，应该如何做某事，但只有你能做到；-) 它真的非常快速有效，但如果您想避免任何问题，最好花一些时间试验 MS Access 以了解它的优缺点。像所有其他技术一样 - 它有自己的逻辑并且必须正确理解
*   分析数据和一般数据处理任务
*   从/向 MS Access 和其他可能的数据库引擎导出/导入数据，这些引擎可以通过 ODBC 链接到 MS Access 表

它也很容易学习，您可以很快获得新知识。我相信它对你的日常工作很有帮助。如果您正在从事数据库设计和开发或处理/分析任何数据（如财务数据等），那么绝对值得学习。老实说，MS Access 是最容易被误解和最强大（同时）的工具之一，它对许多开发人员或分析师有很大帮助，但前提是他们花一些时间研究 MS Access 背后的逻辑。

我可以建议您与 MS Access 进行短暂的恋情，然后看看……如果您可以在某处使用它。你很可能会感到惊讶。您还可以通过使用 MS Access 来提高您在高效数据库设计方面的整体技能。许多相当复杂和先进的基于数据库的系统都是作为自制原型或部门级支持工具开始的。如果您不想失望，则不需要 MS Access 变得“更简单”的 Visual C# 或其他东西 - MS Access 是数据库开发工具，而不是典型程序员的 IDE。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T02:35:16.680

我真的不知道你想问什么，但我每天都使用 Access，它非常适合快速加载和使用数据。将其用于长期解决方案可能不是一个好主意。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-17T03:39:22.040

对于前端，它是一个很棒的 RAD 工具。对于后端，它是您在无法获得数据库服务时使用的工具：) 但是 SQL Express 和 SQL lite 可以免费使用它们作为您的后端。如果 MS 希望它保持相关性，尽管他们需要将其移动到 .net 而不是基于 VB6/COM。MS 在杀死 VB 方面做得非常出色，我认为说服人们投资学习一种死的（垂死的？）语言会变得越来越难。

对于只需要对数据进行切片和切块的报告分析师来说，它也非常有用:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T02:36:17.630

对于快速原型设计，Access 很难被击败。但...

作为顾问，我遇到的许多开发工作都围绕着淘汰和替换 Access 数据库：

*   不一致
*   不可靠
*   非托管

如果您是开发人员，您可能会将 Access 翻译成更易于管理的东西，这可能是一个加分项。但在大多数情况下，Access 被用作公司更多精通计算机的元素的解决方案，用于在没有 IT 干预或昂贵项目的情况下整合临时数据解决方案以获取很少的业务收益。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T02:36:41.480

MS Access 中的表单编辑器做得很好。它们对呈现报告有很好的支持，并且作为报告生成的一个很好的介绍。它不如 Crystal Reports 或 Jasper，但它与 VBA 很好地集成在一起，允许您操作表单、数据库甚至编程变量。你可以把它带到你喜欢的地方。

总的来说，如果您不熟悉 UI 表单编程或定义报告，我会说它非常值得一看。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-17T02:41:28.680

最重要的是，Access 非常适合学习，原因如下：

它非常易于理解和使用，以至于您组织中的非 IT 人员将决定围绕它构建关键业务应用程序并期望您维护它，因为没有预算来升级到更适合企业的数据库。

作为开发人员，您可能永远不会将它用于快速原型制作或其他简单任务之外的任何事情，但为了支持业务，您花费时间是值得的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-17T14:50:32.883

这是另一种我喜欢访问的场景——它是一个很棒的 ginsu 风格的工具，可以将不同的数据组合成单一格式，因为它可以与几乎所有东西通信，非常易于使用并且能够做一些内部操作如果您需要任何花哨的东西，请编写脚本和逻辑。另一方面，它可以像真正的数据库一样运行，您不介意针对它编写批量导入代码。如果事情变得足够复杂，我们的大多数数据导入内容最终都会通过访问进行修补。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-17T02:37:06.987

Access 的优势之一是它易于学习和学习，并且您可以轻松地在小型数据库中导航数据。但是，SQL Server Express 和 VB.net 同样易于学习，并且可以提供更好的长期工作技能。如果有选择，我推荐后者。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-17T02:43:35.990

Access 是一个糟糕的数据库，但它是一个很好的数据操纵器。Ms-Access 可以读取和写入各种数据源。因此，虽然我更喜欢 Postgres、SQL Server、DB2 等，但当我需要将数据从一个源移动到另一个源时，我发现 Access 有时会派上用场。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-17T02:54:19.323

Access 非常适合大量项目，除了 VBA 对知识工作者来说太复杂，对业余爱好者及以上人员来说太麻木了，Access 填补了很少有其他“开箱即用”应用程序能做到的空白。

另外，如果需要，还有一个非常好的 SQL Express 升级路径。正如 Alan 所提到的，Access 是一个非常有用的工具，可以连接到任何类型的 OLEDB/ODBC 数据源，以便以熟悉的方式使用它。如果您需要进行任何类型的批量维护，请尝试将 Access 连接到 SharePoint，您会很高兴您这样做了。

哦，我还应该提到，除了最后一点，我永远不会亲自接触 Access。:)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-17T08:26:10.163

如果您不熟悉数据库和 SQL，则查询构建器是学习 SQL 的有用工具。它允许您“绘制”您的查询，然后查看生成的 SQL 以了解它在做什么。除此之外，它对于企业使用有点限制！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-19T09:16:41.147

我每天都使用访问权限，但它是有限的。除非你能保证你的 RAD 风格原型就是那样——原型。保持清晰并使用带有 SQLServerExpress 的 .NET。

我经常在组织工作，其中服务器 5 个成员的访问应用程序现在在 100 多个用户群的规模下吱吱作响。事情最好做得好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-19T09:02:18.460

是的，每个人一开始都会对 Access 说些好话，但是当您阅读他们的帖子时，您会发现没有人真正想要使用它。如果您必须使用 Access 学习并且无法绕过它，请学习它。如果您有选择，我建议您选择这些天使用频率更高的东西。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-06-17T02:38:09.590

我会避免它，除非我不得不这样做。它提供的功能少于[SQL Server Express](http://www.microsoft.com/express/sql/default.aspx)，并且您可以将完整的报告服务与 SQL Server 的开发人员版本（原型）一起使用。我认为[Expression Blend](http://www.microsoft.com/Expression/products/Overview.aspx?key=blend)和 WPF 是一个更好的 UI 原型设计环境。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-06-17T08:19:38.367

子表单。

下载 Visual Studio 和 SQL Server 的最新可用免费版本（当前均为 2008）。打开 C#（或 VB.NET）Windows 窗体项目。使用 GUI 设计器在 SQL Server 中创建数据库、连接和一些表。使用另一个 GUI 设计器创建一个对话框，其中控件绑定到您刚刚创建的表中的列。输入数据并浏览记录。所有这一切都无需编写任何代码。如果这听起来很复杂，请阅读《[Head First C#](http://oreilly.com/catalog/9780596514822/) 》一书：第一章告诉您如何完成上述所有操作。到目前为止的体验将很像在 IMO Access 中的体验。

那么 Access 提供了哪些 Visual Studio 不提供的功能呢？我认为答案是子表单。

在 Access 中，您可以在两个表之间创建所谓的“关系”（或“关系”），使用查询构建器工具创建连接这两个表的查询，并使用表单设计器创建子表单。毫无疑问，您可以在 Visual Studio 中执行此操作，但我怀疑在 Access 中更容易，因为它的表单更像报表而不是任何其他基于表单的开发产品中的对话框。非常聪明。

Microsoft 生态圈中的专业软件工程师更喜欢 Visual Studio 而不是 Access 表单，更喜欢 SQL Server 而不是 Access 数据库引擎（以前称为 Jet）。Visual Studio 和 SQL Server 的免费版本比 Access 等效工具更强大。与学习 ACE/Jet SQL、VBA、基于 COM 的数据访问技术相比，您将在 TSQL 和 CLR 选择语言（C# 最流行）、ADO.NET、LINQ 等方面获得的技能在 IMO 方面更具可转移性和更少的利基。选择（DAO 是最流行的）、Access 对象模型等。作为开发人员，您必须付费才能获得 Access 许可 :(

如果您渴望成为 Microsoft 生态圈中的软件工程师，那么请避免使用 Access，而转而使用 Visual Studio 和 SQL Server。

编辑：我收到了两次反对票（净），并且来自我认为是 Access 专家的人，所以现在是撤回的时候了：我对子表单的说法显然是错误的。用 Spinal Tap 来解释，子表单功能在聪明和愚蠢之间徘徊。我似乎对子表单很聪明是错误的。它们不能提供任何物质优势。

# c# - 强类型视图中的动态控件 (ASP.NET MVC)

> ID：1004814
> 
> 赞同：1
> 
> 时间：2009-06-17T02:32:26.950
> 
> 标签：c#, asp.net-mvc, model-view-controller

说我有以下内容：

```
公共类人{
    公共 int ID {get; 放;}
    公共字符串名称 {get; 放;}
}

公开课电话{
    公共 int ID {get; 放;}
    公共字符串电话号码 {get; 放;}
}

公共类 AddEditViewModel{
    公众人物 MyPerson{get; 放;}
    公开列表 MyPhones{get; 放;}
}

```

我想在我的 MVC 应用程序中创建一个创建/编辑操作 - 页面继承自

```
ViewPage<AddEditViewModel>
```

我希望能够为最终用户动态添加字段以添加“电话”（0-5 个电话之间的任何位置）。我如何将该数据传递给我的控制器中的 Create/Edit 方法。我尝试了以下方法，但似乎没有得到电话号码。

```
[AcceptVerbs(HttpVerbs.Post)]
公共 ActionResult 创建（AddEditViewModel 数据）{}

```

有了这个我可以调用 data.MyPerson.Name 并获取值但是 data.MyPhones == null

我的问题是：如何将视图和控制器设置为能够提交一个添加/编辑页面，该页面创建一个带有多个电话对象的单个人员对象，给定上面的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T02:44:16.117

如果我正确理解您的问题，您是在询问绑定到电话号码列表的问题。Phil Haack 有一篇关于如何将[模型绑定到列表的帖子](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-06T18:13:53.570

您可以在 MVC 视图中创建动态控件并与您的模型绑定。例如，您可以在视图模型类或模型类中使用列表集合，并可以在视图中创建动态控件，它将自动与您的模型属性绑定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-10T04:39:58.853

如果您知道将有 5 个电话号码，那么您可以尝试这个示例，这将添加 5 个文本框，并且在提交时您将获得视图模型中的值

```
public class Book
{
    public string Title { get; set; }
    public string Author { get; set; }
    public DateTime DatePublished { get; set; }

}

public class BookViewModel
{
    public List<Book> Books { get; set; }

} 
```

看法

```
 @model MVCLearning.Models.BookViewModel

@{
  using (Html.BeginForm("Submit", "Dynamic"))
   {

    if (Model.Count > 0 && Model != null)
    {
        for (int i = 0; i < 5; i++)
        {
            <div id="div_@i">
                @Html.TextBoxFor(m => Model.Books[i].Title)
            </div>
        }
        <input type="submit" value="Submit" />

    }

}
} 
```

# iphone - 如何创建 iPhone 框架并在其他 iPhone 应用程序中使用它

> ID：1004817
> 
> 赞同：12
> 
> 时间：2009-06-17T02:33:59.770
> 
> 标签：iphone, static, frameworks

我想为一些我想包含在其他 iPhone 应用程序中的可重用代码创建一个框架。最好的方法是什么？理想情况下，我希望它像内置框架一样工作，并且让应用程序使用它而无需处理构建文件。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T08:31:03.053

Apple 禁止在 iPhone 上使用自定义框架。但是你可以使用好的旧静态库。在 3.0 GM SDK 中甚至有一个项目模板，但您也可以简单地自己设置一个静态库目标。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-04-05T18:19:30.447

我为 Xcode 4 创建了模板，允许您构建通用 iOS 框架（可在设备和模拟器中使用）。

安装模板后，您只需在创建新项目时选择“静态 iOS 框架”，剩下的就交给它了。它也适用于单元测试。

[https://github.com/kstenerud/iOS-Universal-Framework](https://github.com/kstenerud/iOS-Universal-Framework)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T02:39:35.157

我一直在考虑同样的事情。到目前为止，我所能做的就是按照我想要的方式制作一个项目并将其复制到另一个文件夹以开始一个新项目。然后我重命名 .xcodeproj 文件并打开它。然后我在构建新应用程序之前自定义基础知识（图标、default.png、目标、可执行文件）。

它很笨重，而不是代码重用的工作方式。我确信有更好的解决方案。也许巧妙地使用源代码管理/版本控制？也许 XCode 内置了一些东西？其他想法？我期待在这里看到更多的帖子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-05T08:47:22.067

@Nikolai Ruhe - Apple 究竟在哪里禁止在 iPhone 上使用自定义框架？我已通读[iOS 开发者计划许可协议](http://developer.apple.com/programs/terms/ios/standard/ios_standard_agreement_20100909.pdf)和 App Store 审查指南，但似乎找不到任何关于此类禁令的提及。

我不明白为什么 Apple 会允许使用自定义静态库，并禁止使用自定义框架。也许我错过了其他一些法律文件？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T06:20:51.123

看到这个链接，你绝对可以创建一个框架并使用它。如果您构建程序，为什么苹果会拒绝您的应用程序。 [看到这个链接](http://db-in.com/blog/2011/07/universal-framework-iphone-ios-2-0/)

框架只不过是代码的结构组织。没有直接的方法可以做到这一点。但是您可以通过使用捆绑和聚合目标来实现它。将一个新的 Bundle 添加到您的项目并执行以下 Base SDK：Latest iOS (iOS XX)（在 XX 中将显示您机器上安装的最新 iOS SDK 的编号）。架构：$(ARCHS_STANDARD_32_BIT) armv6（这个值非常重要，包括“armv6”之前的空格）这个设置对Xcode 4.2有效，如果你使用的是旧版本，请使用“Standard (armv6 armv7)”选项. （此属性的值取决于下面项目的值，因此请先设置）。仅构建活动架构：否（否则我们无法同时编译为 armv6 和 armv7）。有效架构：$(ARCHS_STANDARD_32_BIT) （正是这个值非常重要）。如果您的 Xcode 显示带有 armv6 和 armv7 的两行，则删除然后将该值插入一行。死代码剥离：否。与标准库的链接：否。Mach-O 类型：可重定位目标文件。这是最重要的变化。在这里，我们指示编译器将 Bundle 视为可重定位文件，通过这样做，我们可以将其变成具有包装器设置的框架。其他链接器标志：此设置不是强制性的，但如果您计划在此框架上使用任何类型的 C++ 代码（.cpp 或 .mm），Chris Moore（在评论中）建议使用“-lstdc++”选项。在这种情况下，使用“-ObjC”也是一个好主意，以避免旧编译器中的冲突。包装器扩展：框架。这里我们将Bundle改为Framework。对于 Xcode，frameworks 只是一个扩展名为 .framework 的文件夹，其中包含一个或多个已编译的二进制源、资源和一些文件夹，一个通常称为 Headers 的文件夹包含所有公共头文件。生成调试符号：否（这是一个非常重要的设置，否则框架将无法在其他计算机/配置文件上运行）。预编译前缀标头：否。

创建一个聚合目标并复制

```
# Sets the target folders and the final framework product.
FMK_NAME=FI
FMK_VERSION=A

# Install dir will be the final output to the framework.
# The following line create it in the root folder of the current project.
INSTALL_DIR=${SRCROOT}/Products/${FMK_NAME}.framework

# Working dir will be deleted after the framework creation.
WRK_DIR=build
DEVICE_DIR=${WRK_DIR}/Release-iphoneos/${FMK_NAME}.framework
SIMULATOR_DIR=${WRK_DIR}/Release-iphonesimulator/${FMK_NAME}.framework

# Building both architectures.
xcodebuild -configuration "Release" -target "${FMK_NAME}" -sdk iphoneos
xcodebuild -configuration "Release" -target "${FMK_NAME}" -sdk iphonesimulator

# Cleaning the oldest.
if [ -d "${INSTALL_DIR}" ]
then
rm -rf "${INSTALL_DIR}"
fi

# Creates and renews the final product folder.
mkdir -p "${INSTALL_DIR}"
mkdir -p "${INSTALL_DIR}/Versions"
mkdir -p "${INSTALL_DIR}/Versions/${FMK_VERSION}"
mkdir -p "${INSTALL_DIR}/Versions/${FMK_VERSION}/Resources"
mkdir -p "${INSTALL_DIR}/Versions/${FMK_VERSION}/Headers"

# Creates the internal links.
# It MUST uses relative path, otherwise will not work when the folder is copied/moved.
ln -s "${FMK_VERSION}" "${INSTALL_DIR}/Versions/Current"
ln -s "Versions/Current/Headers" "${INSTALL_DIR}/Headers"
ln -s "Versions/Current/Resources" "${INSTALL_DIR}/Resources"
ln -s "Versions/Current/${FMK_NAME}" "${INSTALL_DIR}/${FMK_NAME}"

# Copies the headers and resources files to the final product folder.
cp -R "${DEVICE_DIR}/Headers/" "${INSTALL_DIR}/Versions/${FMK_VERSION}/Headers/"
cp -R "${DEVICE_DIR}/" "${INSTALL_DIR}/Versions/${FMK_VERSION}/Resources/"

# Removes the binary and header from the resources folder.
rm -r "${INSTALL_DIR}/Versions/${FMK_VERSION}/Resources/Headers" "${INSTALL_DIR}/Versions/${FMK_VERSION}/Resources/${FMK_NAME}"

# Uses the Lipo Tool to merge both binary files (i386 + armv6/armv7) into one Universal final product.
lipo -create "${DEVICE_DIR}/${FMK_NAME}" "${SIMULATOR_DIR}/${FMK_NAME}" -output "${INSTALL_DIR}/Versions/${FMK_VERSION}/${FMK_NAME}"

rm -r "${WRK_DIR}" 
```

这进入运行脚本并运行聚合目标以获取框架

# objective-c - Objective C 匿名对象的内存管理

> ID：1004818
> 
> 赞同：2
> 
> 时间：2009-06-17T02:34:29.083
> 
> 标签：objective-c, memory-management, memory-leaks

我正在学习Objective-C，并且正在尝试了解内存管理。我对 C 内存管理相当熟悉，但我试图弄清楚 ObjC 的不同之处。

假设我有一个`Complex`用于保存复数的类，它有一个`-(Complex*)add:(Complex*)c;`将传入的复数添加到`self`（`Complex`假设是一个可变对象）的方法。

所以我可以这样称呼它：

```
Complex *c = [[Complex alloc] withReal: -3.0 andImag: -2.4]; // c = -3.0-2.4i
[c add : [[Complex alloc] withReal: 1.0 andImag: 2.0]]; // now c = -2.0-0.4i 
```

用于调用中创建的临时对象的内存会`add`怎样？我认为这是内存泄漏；这是正确的代码吗？

```
Complex *c = [[Complex alloc] withReal: -3.0 andImag: -2.4]; // c = -3.0-2.4i
Complex *b = [[Complex alloc] withReal: 1.0 andImag: 2.0]; // b = 1+2i
[c add : b]; // now c = -2.0-0.4i
[b release]; 
```

额外的菜鸟问题：Objective-C 2.0 GC 会处理这种情况吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T03:05:08.320

在第一个示例中：

```
[c add : [[Complex alloc] withReal: 1.0 andImag: 2.0]]; 
```

您已经分配了引用计数为 1 的对象并且它没有被释放，所以它是内存泄漏，因为您没有存储指向该对象的指针，所以您不能向它发送释放。

您可以修改它以自动释放“临时”对象：

```
[c add : [[[Complex alloc] withReal: 1.0 andImag: 2.0] autorelease]]; 
```

您可能会在名称中使用 init 来指出对象没有自动释放并且用户必须处理内存管理的事实：

```
initWithReal:(double)r andImag:(double)i 
```

第二个例子是正确的。

例如，Cocoa 提供了许多返回自动释放对象的方法（静态和成员），`[NSString stringWithString:@"example"]`因此您可以创建返回自动释放对象的方法，这样您就不必处理释放：

```
Complex * c = [Complex complexWithReal:1.0 andImag:2.0] 
```

您还可以创建获取原始数据的方法，例如`addReal:(double)r andImag:(double)i`，您可以跳过 alloc/init 步骤。

另一种选择是使用结构，如 Cocoa（`CGRect`等等）中使用的那样。它们与 C 中的相同，意味着它们在堆栈上分配，一旦超出范围就会消失，而不是在堆上使用 alloc/init 分配的对象。适用于经常使用但您通常不想保留它们的“小”对象。

至于 GC，我看不出 GC 无法处理释放对象的任何原因 - 虽然我没有使用太多（只看了几个例子 - 我更喜欢自己管理内存 - 除非使用`python`... )

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T15:13:52.227

首先，戴上我的“最佳实践”帽子，当您创建自定义类时，Objective-C 习惯用法是用前导“init”命名初始化程序（相当于其他语言中的“构造函数”）。另外，尽量不要缩写方法选择器或命名参数的部分。

例如，而不是这个：

```
- (id) withReal:(double)r andImag:(double)i { ... } 
```

你应该考虑这样做：

```
- (id) initWithReal:(double)real imaginary:(double)imaginary { ... } 
```

第二部分之前的“和”是一个口味问题——使用它是完全可以接受的，但我更喜欢不使用它，因为你可能不会将它用于具有 3 个以上参数的方法。例如，如果您要创建要使用的 RGB 颜色，它会比必要的更冗长——通常最好是`-initWithRed:andGreen:andBlue:`写/使用。`-initWithRed:green:blue:`

* * *

对于您的实际问题，我完全同意创建便利类构造函数是解决此类情况的明智方法。每次需要一次性实例时，它在视觉上都比 alloc-init-autorelease 干净得多。匹配上面的变化，我会调整@kent的答案看起来像这样：

```
+ (Complex*) complexWithReal:(double)real imaginary:(double)imaginary {
    return [[Complex alloc] initWithReal:real imaginary: imaginary] autorelease];
} 
```

* * *

对于额外的问题，是的，Objective-C 2.0 的 GC 可以很好地处理这个问题；大多数编写良好的保留释放代码在 GC 下按原样工作，尤其是当您不再需要指针时小心地将指针设置为 nil 时。启用 GC 后，对保留/释放/自动释放的调用本质上是无操作的，一旦没有对它们的引用，就会收集对象。一旦指向对象的最后一个指针丢失或超出本地范围，该对象就有资格被收集。（从技术上讲，GC 只计算**强**引用，但除非您有意使用弱引用，否则这种区别现在可能无关紧要。）请记住，iPhone 目前不支持垃圾收集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T14:19:30.167

stefanB 是正确的。因为你会做很多这种“即时”的实例化（我会假设......）构建一个静态的“方便”构造函数是有意义的（在 appKit & co中有很多这样的例子。）

```
+(Complex*) complexWithReal:(double)r andImag:(double)i
{
  return [[Complex alloc] initWithReal:r andImag:i] autorelease];
} 
```

这将使您调用添加消息，然后看起来像这样：

```
[c add : [Complex complexWithReal:2.0 andImage:1.0]] 
```

玩得开心！

# internet-explorer - 是否可以在 vbscript 消息框中嵌入 http 链接？

> ID：1004822
> 
> 赞同：0
> 
> 时间：2009-06-17T02:36:02.590
> 
> 标签：internet-explorer, browser, vbscript

我想将用户引导到每个案例的适当下载链接。我可以在 vbs 消息框中嵌入可点击的链接吗？或者，有没有更清洁的方法来解决这个问题？

```
 select case FSO.GetFileVersion(strCorLib)
            Case "2.0.50727.42"
                strNETVersion = strNETVersion & " SP0 (not so good!)"
            Case "2.0.50727.1433"
                strNETVersion = strNETVersion & " SP1 (this will work)" 
            Case "2.0.50727.3053"
                strNETVersion = strNETVersion & " SP2 (this is good)"
            end select

            strNetVersion = strNETVersion & ", " & FSO.GetFile(strCorLib).DateLastModified
        else
            strNETVersion = ".NET 2.0 not installed"
        end if
        sayit strNetVersion 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T02:42:50.550

使用标准的 msgbox 是不可能的……你必须自己动手……

查看[此链接](http://www.microsoft.com/technet/scriptcenter/resources/qanda/oct04/hey1022.mspx)以获取更多信息...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-28T12:14:35.910

当我编写 VBScript 代码时，我会使用类似的东西。IMO 这是一种更清洁的方式。

```
iRes = objShell.Popup("Something not found." & vbNewLIne & _
    "Without that the world wont be saved." & vbNewLIne & _
    "Download it now?",, "Required software is missing", 4+48)    ' 4=MB_YESNO, 48=MB_ICONEXCLAMATION
if iRes = 6 then     ' 6=IDYES
    objShell.Run("http://www.microsoft/com/...")
end if 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T02:49:55.043

还要检查[ShowModalDialog](http://blog.davidkaspar.com/archives/2005/10/showmodaldialog-in-firefox-and-frames.php)。它完全允许你想要什么，但就像 John 的链接一样，它是一个仅限 IE 的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T02:51:12.920

使用 jQuery 和一些标记来解决这个问题。jQuery 甚至不是必需的，但可以节省编码。

# javascript - 工具提示（title="..."）不会在 Firefox 中显示

> ID：1004826
> 
> 赞同：7
> 
> 时间：2009-06-17T02:36:45.507
> 
> 标签：javascript, firefox, cross-browser, dom-events

我有一个带有`title`属性的元素（即工具提示），包装在某个容器中：

```
<div id="foo">
    <input type="text" title="A tooltip" />
</div> 
```

我在容器上附加了一个`"mousemove"`事件侦听器并停止事件传播：

```
document.getElementById('foo').addEventListener(
    'mousemove',
    function(e) { e.stopPropagation() },
    false
) 
```

这种停止在容器上传播“mousemoves”的组合现在可以防止工具提示出现*在 Firefox* 2 及更高版本中的内部文本框。我尝试过 FF 2[.0.0.20]、3[.0.11] 和最新的 3.5（Windows Server 2003、XP）。

作为一个快速练习，**Firefox**用户可以通过在地址栏中运行以下等效逻辑来查看此错误：

```
javascript:void($('div.vote').mousemove(function(e){ e.stopPropagation() })) 
```

现在将鼠标悬停在该问题的任何赞成、反对或星号（收藏夹）图标上。工具提示不再出现。***同样，仅在 Firefox 中***。

有没有人对 Firefox 中的这种行为/错误有解决方法？有其他人见证过吗？

**更新**：似乎 Firefox 使用“鼠标停止移动”来触发浏览器 chrome 中的工具提示（例如后退/前进按钮）。请参阅[https://bugzilla.mozilla.org/show_bug.cgi?id=82953](https://bugzilla.mozilla.org/show_bug.cgi?id=82953)。但是我不知道这是否会影响 DOM。

**更新**： Firefox 10 似乎是最后一个表现出这种行为的版本。无论事件传播如何，Firefox 11.0 及更高版本都会显示工具提示。

**更新**：Firefox 33(.1) 不再表现出这种行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-09T03:09:49.313

我已经确认了这个问题。*我什至尝试使用*以下代码手动将事件传播到输入框：

```
<div id="foo" title="A tooltip 2"> <input title="A tooltip" type="text" id="bar"/>
</div>
<script type="text/javascript">
document.getElementById('foo').addEventListener(
    'mouseover',
    function(e) {
        e.stopPropagation();
        if (document.createEvent) {
            var inputBox = document.getElementById('bar');
            var evt = document.createEvent("MouseEvents");
            evt.initMouseEvent("mousemove", true, true, window, e.detail, e.screenX, e.screenY, e.clientX, e.clientY, false, false, false, false, null, null);
            inputBox.dispatchEvent(evt);
        }
    },
    false
)
</script> 
```

没有骰子。但是，其他鼠标事件，包括鼠标悬停，似乎工作正常。

我相信这是一个错误。虽然它没有在 bugzilla 中列出，但搜索似乎表明事件“鼠标悬停”和工具提示之间[存在相关性。](https://bugzilla.mozilla.org/buglist.cgi?quicksearch=tooltip+event)

您可以在此处下载最新的[夜间版本](http://www.mozilla.org/developer/#builds)的 Firefox，看看它是否仍然存在。如果是，[请提交错误](https://bugzilla.mozilla.org/enter_bug.cgi)。

作为替代方案，我会看看鼠标悬停是否会给你想要的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T15:22:45.997

我最近读到一些 firefox 插件（即 google 工具栏）会导致标题工具提示出现问题。停用它们并检查这是否可以解决您的问题。

# ruby-on-rails - 如何在 Rails 中存根或模拟 request.subdomains 方法？

> ID：1004832
> 
> 赞同：3
> 
> 时间：2009-06-17T02:37:51.243
> 
> 标签：ruby-on-rails, mocking, integration-testing, stubbing

我正在尝试在我的 rails 应用程序中编写一些功能测试，在 application_controller.rb 我有这个：

```
before_filter :current_account
def current_account
  @current_account ||= Account.find_by_subdomain!(request.subdomians.first)
end 
```

运行测试时，`request.subdomains`不包含我正在寻找的有效子域，并且无法运行任何功能测试。

是否可以存根`current_account`方法或模拟`request.subdomains`对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T08:25:33.207

在您的功能测试中，您应该能够做到（使用 mocha）：

```
@request.expects(:subdomains).returns(['www']) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-25T16:57:55.307

对我（以及 Rails 2.3.4）来说，正确的说法是

```
@controller.request.expects(:subdomains).returns(['www']) 
```

因为我无法直接访问@request。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-19T18:00:57.843

```
@controller.instance_variable_set(:@request, OpenStruct.new({:subdomains => 'www'})) 
```

您可以在 ruby​​ 中访问任何内容:)

# delphi - 处理文本文件的应用程序转换为 Unicode

> ID：1004838
> 
> 赞同：9
> 
> 时间：2009-06-17T02:40:24.580
> 
> 标签：delphi, unicode, delphi-2009, ansistring

我的 Win32 Delphi 应用程序分析由不支持 Unicode 的其他应用程序生成的文本文件。因此，我的应用程序需要读取和写入 ansi 字符串，但我想通过在 GUI 中使用 Unicode 来提供更好的本地化用户体验。该应用程序对源自 TList 的对象中的字符串进行了一些非常繁重的逐字符分析。

在从 Delphi 2006 到 Delphi 2009 过渡到 Unicode GUI 时，我应该计划：

1.  在我的应用程序中完全使用 Unicode，除了 ansistring 文件 I/O？
2.  封装处理来自其他 Unicode 应用程序的 ansistrings 的代码（即继续在内部将它们作为 ansistrings 处理）。

我意识到真正详细的响应需要我的大量代码 - 我只是询问那些已经完成此转换并且仍然必须使用纯文本文件的人的印象。ansistrings 和 Unicode 之间的障碍在哪里？

编辑：如果#1，有什么建议可以为 ansistring 输出映射 Unicode 字符串？我猜想输入字符串的转换将使用 tstringlist.loadfromfile 自动进行（例如）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T02:45:48.280

如果值得付出努力和要求，我建议使用完整的 unicode。并将 ANSI 文件 I/O 与其他文件分开。但这在很大程度上取决于您的应用程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T04:13:55.883

没有 AnsiString 输出之类的东西 - 每个文本文件都有一个[字符编码](http://en.wikipedia.org/wiki/Character_encoding)。当您的文件包含 ASCII 范围之外的字符时，您必须考虑编码，因为即使在不同国家/地区加载这些文件也会产生不同的结果 - 除非您碰巧使用 Unicode 编码。

如果您加载一个文本文件，您需要知道它具有哪种编码。对于像 xml 或 html 这样的格式，该信息是文本的一部分，对于 Unicode，有[BOM](http://en.wikipedia.org/wiki/Byte-order_mark)，尽管对于 UTF-8 编码的文件并不是绝对必要的。

将应用程序转换为 Delphi 2009 是一个思考文本文件编码和纠正过去错误的机会。应用程序的数据文件通常比应用程序本身具有更长的生命周期，因此考虑如何使它们具有前瞻性和通用性是值得的。我建议将 UTF-8 作为所有新应用程序的文本文件编码，这样将应用程序移植到不同的平台很容易。UTF-8 是用于数据交换的最佳编码，对于 ASCII 或 ISO8859-1 范围内的字符，它创建的文件甚至比 UTF-16 或 UTF-32 小得多。

如果您的数据文件仅包含 ASCII 字符，那么您就全部设置好了，因为它们也是有效的 UTF-8 编码文件。如果您的数据文件采用 ISO8859-1 编码（或任何其他固定编码），则在将它们加载到字符串列表并保存回来时使用匹配转换。如果您事先不知道他们将使用什么编码，请在加载时询问用户，或为默认编码提供应用程序设置。

在内部使用 Unicode 字符串。根据您需要处理的数据量，您可能会使用 UTF-8 编码的字符串。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T04:26:51.190

你说：

> “该应用程序对源自 TList 的对象中的字符串进行了一些非常繁重的逐字符分析。”

由于 Windows 本机运行 Unicode，如果您在内部将文本文件加载为 Unicode，您可能会发现字符分析运行得更快。

另一方面，如果它是一个大文件，你也会发现它需要两倍的内存。

有关这方面的更多信息，请参阅 Jan Goyvaert 的文章：[“使用本机 Win32 字符串类型的速度优势”](http://www.micro-isv.asia/2008/09/speed-benefits-of-using-the-native-win32-string-type/)

所以这是一个你必须决定的权衡。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T05:02:11.713

如果您要从 GUI 获取 Unicode 输入，将其转换为 ASCII 输出的策略是什么？（这是一个假设，因为您提到写回 Ansi 文本，假设您不会重写这些基于非 Unicode 的应用程序，并且假设没有源代码。）我建议在整个应用程序中使用 AnsiString直到这些其他应用程序启用 Unicode。如果您的应用程序的主要工作是分析非 Unicode ASCII 类型文件，那么为什么要在内部切换到 Unicode？如果您的应用程序的主要工作涉及拥有更好的支持 Unicode 的 GUI，那么请使用 Unicode。我不相信有足够的信息来决定一个正确的选择。

如果没有机会为这些非 Unicode 应用程序写回不易翻译的字符，那么建议使用 UTF-8 可能是可行的方法。但是，如果有机会，那么非 Unicode 应用程序将如何处理多字节字符？你将如何转换为（假设）基本的 ASCII 字符集？

# asp.net-mvc - Spark 中此 MVC 视图代码的等效语法是什么？

> ID：1004842
> 
> 赞同：3
> 
> 时间：2009-06-17T02:41:26.637
> 
> 标签：asp.net-mvc, spark-view-engine

我在使用 WebForms 视图引擎的 MVC 项目中得到了这段代码，我正在尝试将其转换为 Spark。我怎样才能有条件地调用一个部分并将其传递给视图数据？

```
<% if (UserService.IsAuthenticated && !Model.Post.IsDeleted) { %>
    <% Html.RenderPartial("Reply", new ReplyViewModel { Id=Model.Post.PostId, CssClass="respond" }); %>
<% } %> 
```

试过这个（无济于事，它在所有其他内容之前呈现部分内容）：

```
<if condition="UserService.IsAuthenticated && !Model.Post.IsDeleted">
    #Html.RenderPartial("Reply", new ReplyViewModel { Id=Model.Post.PostId, CssClass="respond" });
</if> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T04:53:47.667

这

```
<% if (UserService.IsAuthenticated && !Model.Post.IsDeleted) { %>
    <% Html.RenderPartial("Reply", new ReplyViewModel { Id=Model.Post.PostId, CssClass="respond" }); %>
<% } %> 
```

和

```
<if condition="UserService.IsAuthenticated && !Model.Post.IsDeleted">
    #Html.RenderPartial("Reply", new ReplyViewModel { Id=Model.Post.PostId, CssClass="respond" });
</if> 
```

并且 <test if=""> 变体应该都可以工作并产生几乎相同的代码：

```
if (UserService.IsAuthenticated && !Model.Post.IsDeleted) 
{ 
    Html.RenderPartial("Reply", new ReplyViewModel { Id=Model.Post.PostId, CssClass="respond" });
} 
```

也许尝试输出 ${UserService.IsAuthenticated} 和 ${Model.Post.IsDeleted} 以绝对确定条件并不总是正确的？

* * *

好的 - 在另一种不正确的媒体中确认......“回复”部分是否可能是 WebForms 视图，如回复.ascx 或回复.aspx？WebForms 有一个问题，默认情况下它的输出将直接转到当前的 HttpContext 响应输出，这使得很难将这些部分与假脱机或分层输出的视图引擎交错。

在 Spark 示例中，有一种方法可以解决这个问题，但这有点棘手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T03:09:20.400

尝试使用 test if="" 语法

```
<test if="UserService.IsAuthenticated && !Model.Post.IsDeleted">
    ${Html.RenderPartial("Reply", new ReplyViewModel { Id=Model.Post.PostId, CssClass="respond" });}
</test> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T05:06:11.537

感谢 Louis 在 Twitter 上的帮助，问题在于被调用的部分是 .ascx 文件而不是 .spark 文件。我还没有删除旧的、未转换的 .ascx 文件。删除 Reply.ascx 后，一切都按预期进行。

# iphone - 我在哪里可以找到关于 iPhone/Objective-C 多线程的好教程？

> ID：1004845
> 
> 赞同：37
> 
> 时间：2009-06-17T02:42:07.057
> 
> 标签：iphone, objective-c, multithreading, cocoa

我刚刚开始使用多线程并正在寻找一个好的解释。我不确定多线程在 Mac 和 iPhone 上的工作方式是否存在差异。带有示例代码的教程的好链接是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-17T02:45:21.417

一个简单但完整的示例是*[Cocoa 中的多线程](http://softpixel.com/~cwright/programming/threads/threads.cocoa.php)*。

一个相关的 Stack Overflow 问题是*[iPhone 上的 NSOperation](https://stackoverflow.com/questions/830218)*。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-09-15T13:42:54.833

再说一次，如果我可以推广我的 iPhone 开发课程，上学期我有一个专门讨论多线程的课程，包括基本线程、锁定、处理主线程上的 UI 和 NSOperationQueues，可以在[这里](http://www.sunsetlakesoftware.com/sites/default/files/Spring2010CourseNotes/multithreading.html)找到课程笔记。今年秋季学期，同一班级将由 Grand Central Dispatch 主导。

课程视频[可以从 iTunes U 免费下载](https://podcasts.apple.com/us/podcast/advanced-iphone-development-spring-2010/id407243032)。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-17T04:14:22.733

不要忘记 Apple 的官方文档：[Threading Programming Guide](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Multithreading/)

您将找到完整的解释和示例代码。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-17T19:10:22.417

*   *[Cocoa 教程：NSOperation 和 NSOperationQueue](http://www.cimgf.com/2008/02/16/cocoa-tutorial-nsoperation-and-nsoperationqueue/)*

*   *[Cocoa for Scientists（第 XXI 部分）：使用 NSOperation 和 NSOperationQueue 对您的应用程序进行多线程处理](http://www.macresearch.org/node/4567)*

*   *[并发操作揭秘](http://www.dribin.org/dave/blog/archives/2009/05/05/concurrent_operations/)*

*   *[Leopard 穿线指南](http://cocoasamurai.blogspot.com/2008/04/guide-to-threading-on-leopard.html)*

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-10-01T16:13:18.610

一个关于 NSInvocationOperation 的简短教程是*[使用 NSInvocationOperation 在 iPhone 上异步加载图像](http://tech.pro/tutorial/1011/loading-images-asynchronously-on-iphone-using-nsinvocationoperation)*。

# list - 在 SharePoint Web 部件中，如何在运行时设置 Web 部件的列表？

> ID：1004848
> 
> 赞同：0
> 
> 时间：2009-06-17T02:43:21.110
> 
> 标签：list, web-parts

我开发了一个联系人列表 Web 部件，它依赖于我创建的自定义列表，也称为联系人列表。但是，每当将 Web 部件添加到页面时，Web 部件总是需要一个名为“联系人列表”的列表，而是我想要它，以便我可以将 Web 部件添加到页面然后设置我希望它使用哪个列表。我想我问的是如何为 Web 部件创建自定义属性，就像单击 Web 部件然后单击修改共享 Web 部件时获得的 Web 部件的内置属性一样。

我想这样做的原因是因为我打算添加一个名为联系人列表模板的列表模板。他们，每当我想显示联系人列表时，我只需从列表模板创建一个特定列表，然后将该新列表绑定到显示该列表的 Web 部件。

我设想它会像这样工作： 1\. 我从联系人列表模板创建一个联系人列表，例如“销售联系人列表” 2\. 然后我将联系人列表 web 部件添加到页面 3\. 最后，我设置 web 部件的自定义属性（我们称它为 ContactListSourceList）到“销售联系人列表” 4\. 然后 Web 部件像当前一样工作，从列表中检索数据并显示它。

顺便说一句，我说 VB 比 C# 好，尽管如果必须的话，我可以弄清楚 C#。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T03:34:41.600

听起来您想创建一个具有自定义属性的 WebPart。以下文章应该会有所帮助：

*   [创建具有自定义属性的 Web 部件 (MSDN)](http://msdn.microsoft.com/en-us/library/dd584174.aspx)
*   [Office SharePoint Server 中的 Web 部件](http://blogs.msdn.com/brianwilson/archive/2008/07/13/web-parts-in-office-sharepoint-server-2007.aspx)（常规 Web 部件指南）
*   [具有自定义属性的自定义字段](http://www.sharepoint-tips.com/2008/11/custom-fields-with-custom-properties.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-24T04:19:15.507

对于可能需要执行此操作的其他任何人，我在我的解决方案上编写了一个 How-to，其中介绍了如何创建自定义属性，但还介绍了当属性未设置或未正确设置时向用户显示的内容。[如何在运行时设置 SharePoint Web 部件的列表](http://simplesharepointsolutions.blogspot.com/2009/06/how-to-set-sharepoint-web-parts-list-at.html)

# google-app-engine - Google App Engine：查找合适的处理程序时忽略 URL 大小写

> ID：1004855
> 
> 赞同：2
> 
> 时间：2009-06-17T02:45:19.203
> 
> 标签：google-app-engine

```
application = webapp.WSGIApplication(
                                 [('/', DefaultPage),
                                  ('/ClearDataPage', ClearDataPage),
                                  ('/DeleteTweets', DeleteTweets),
                                  ('/DeleteLinks', DeleteLinks),
                                  ('/awesome', Awesome),
                                  ('/RunScriptPage', RunScriptPage)],
                                 debug=True) 
```

在这种情况下，我如何使“真棒”的任何变体或任何 url 不区分大小写？

这样 Awesome 将始终被定向到 localhost:8080/awesome ...？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T03:13:54.137

对于这种有点高级的调度需求，不要使用*极其*轻量级的`webapp`框架——使用任何更丰富的框架，例如App Engine 也支持的[web.py](http://webpy.org/)；在那里，您可以基于正则表达式进行调度，而不仅仅是字符串，因此您可以特别使用不区分大小写的正则表达式模式。

例如，`'(?i)awesome'`是正则表达式的模式，它`'awesome'`以不区分大小写的方式匹配，如您所愿。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T03:15:44.537

在这种情况下，您可以使用正则表达式。[维基百科：正则表达式](http://en.wikipedia.org/wiki/Regular_expression)

一些应用引擎特定的示例可以在[应用引擎文档](http://code.google.com/appengine/docs/python/config/appconfig.html)中找到。

# iphone - 在导航栏下添加搜索栏？

> ID：1004858
> 
> 赞同：3
> 
> 时间：2009-06-17T02:46:00.557
> 
> 标签：iphone, objective-c, cocoa-touch

我想用uitableview在导航栏下添加一个搜索栏。我想从数据库中搜索？任何想法如何做到这一点

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T02:47:29.727

将搜索栏添加为表格的 headerView。

```
UISearchBar *temp = [[UISearchBar alloc]initWithFrame:CGRectMake(0, 0, 320, 45)];
temp.barStyle=UIBarStyleBlackTranslucent;
temp.showsCancelButton=YES;
temp.autocorrectionType=UITextAutocorrectionTypeNo;
temp.autocapitalizationType=UITextAutocapitalizationTypeNone;
temp.delegate=self;
self.tableView.tableHeaderView=temp;
[temp release]; 
```

# c# - 我可以在自定义 MembershipProvider 中向用户会话添加一些内容吗？

> ID：1004862
> 
> 赞同：3
> 
> 时间：2009-06-17T02:47:01.990
> 
> 标签：c#, asp.net, asp.net-membership

我正在实现一个自定义 MembershipProvider，以便将登录详细信息传递给我们在公司其他几个地方使用的自定义业务对象。但是一旦我们通过了身份验证，我想将这个初始化的业务对象保存在会话中，以便稍后在其他页面中使用。让我举个例子吧。

```
public override bool ValidateUser(string username,string password)
{
    try
    {
        // I want to keep this "object" in the Session to be used later on
        CustomBusinessObject object = new CustomBusinessObject(username, password);

        return true;
    }
    catch (CustomBusinessAuthenticationException)
    {
        return false;
    }
} 
```

我有办法做到这一点吗？我没有立即看到通过实现这个自定义 MembershipProvider 来访问 Session 对象的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T03:05:25.637

您可以通过调用 System.Web.HttpContext.Current 来访问会话。只需在您的自定义成员资格提供程序上创建一个自定义属性，检查 HttpContext.Current 是否为 null，如果是，则返回 null，否则相应地访问会话值。

```
public object CustomObject
{
    get
    {
        if(System.Web.HttpContext.Current == null)
        {
            return null;
        }
        return System.Web.HttpContext.Current.Session["CustomObject"];
    }
    set
    {
        if(System.Web.HttpContext.Current != null)
        {
            System.Web.HttpContext.Current.Session["CustomObject"] = value;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T03:04:42.877

您应该可以访问`System.Web.HttpContext.Current.Session`.

请记住，`System.Web.HttpContext`如果`null`您的提供程序曾经在 ASP.Net 管道之外使用，并且通过在您的提供程序内部使用它，您将把您的提供程序紧密耦合到 ASP.Net。

# asp.net - ASP.NET MVC Helper Extension Method 不将文本呈现为控件

> ID：1004864
> 
> 赞同：1
> 
> 时间：2009-06-17T02:47:15.423
> 
> 标签：asp.net, asp.net-mvc

试图创建这个扩展方法。工作，除了帮助程序呈现文本，而不是页面呈现时视图的控件：

我包括使用 System.Web.Mvc.Html；在包含此扩展方法的帮助器类的顶部，以便它可以理解 helper.RadioButton。

```
public static string WriteTestControlToScreen(this HtmlHelper helper)
{
    StringBuilder fields = new StringBuilder();
    fields.Append("<fieldset>");
    fields.Append("     <div class='formLabel'><span class='requiredText'>*</span><label>Background Color</label></div>");
    fields.Append("     <div class='formField'>" + helper.RadioButton("rbBackgroundColorWhite", 0, false) + "<label class='fieldInlineLabel' for=''>White</label></div>");
    fields.Append("     <div class='formField'>" + helper.RadioButton("rbBackgroundColorWhite", 0) + "<label class='fieldInlineLabel' for=''>Black</label></div>");
    fields.Append("</fieldset>");

    return fields.ToString();
} 
```

视图中的输出看起来像这样（注意它不是渲染单选按钮，而是将其视为文本）：

*背景颜色 <%=Html.RadioButton('rbBackgroundColorWhite', 0, false)%>白色 <%=Html.RadioButton('rbBackgroundColorWhite', 0)%>黑色

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T03:05:51.517

我对 Reflector 做了一些探索，我注意到 Input 字段的 MVC 扩展方法都使用 InputHelper 类，而后者又使用 TagBuilder 类：

```
private static string InputHelper(this HtmlHelper htmlHelper, InputType inputType, string name, object value, bool useViewData, bool isChecked, bool setId, bool isExplicitValue, IDictionary<string, object> htmlAttributes)
{
    ModelState state;
    if (string.IsNullOrEmpty(name))
    {
        throw new ArgumentException(MvcResources.Common_NullOrEmpty, "name");
    }
    TagBuilder builder = new TagBuilder("input");
    builder.MergeAttributes<string, object>(htmlAttributes);
    builder.MergeAttribute("type", HtmlHelper.GetInputTypeString(inputType));
    builder.MergeAttribute("name", name, true);
    string str = Convert.ToString(value, CultureInfo.CurrentCulture);
    bool flag = false;
    switch (inputType)
    {
        case InputType.CheckBox:

              //...etc. 
```

以下是几个案例陈述，涵盖了各种输入类型所需的额外渲染。但你明白了。MVC 的人并没有连接字符串。他们正在使用 MergeAttribute（和其他）方法为他们做脏活。我的猜测是那里也有一些浏览器兼容性。

我的建议是您可以使用 TagBuilder 类来构建您的 HTML，就像 MVC 人员所做的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T03:10:54.737

原始代码的问题在于，当 MVC 期望文字 html 输出时，您正在输出 <%= %> 标记。换句话说，它不处理这些标签。

考虑将您的 HTML 放入 .ASCX 文件并执行[RenderPartial](http://blogs.intesoft.net/post/2009/02/renderaction-versus-renderpartial-aspnet-mvc.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T01:17:55.313

我知道这是一篇较旧的帖子，但是当我想在彼此之间渲染 Telerik MVC 控件时，我使用了一个优雅的解决方案。但是，它可以与任何 HTML 助手一起使用。它涉及在 cshtml（用于 razor）文件中创建一个内联帮助程序，如下所示：

```
<!-- This helper avoids nested literals with the sub-panel item -->
@helper RenderPositionalResponsibilities()
{
    Html.Telerik().PanelBar()
        .Name("ContactSubItem")
        .Items(subitem =>
        {
            subitem.Add()
                .Text("Positional Responsibilities")
                .Content(
                    @<text>
                        <div class="container scrollable" style="height: 150px;">
                            @Html.CheckboxFor(model => model.IsTrue)
                        </div>
                     </text>
                )
                .Expanded(true);
        })
        .Render();
} 
```

然后可以调用它，如下面的 Content 方法所示：

```
@{Html.Telerik().PanelBar()
.Name("pnlUserForm")
.ClientEvents(e => e.OnExpand("pnlUserForm_OnExpand").OnCollapse("pnlUserForm_OnCollapse"))
.Items(i =>
{
    i.Add()
        .Text("User Information")
        .Expanded(true)
        .Content(
            @<text>
                <div>
                    @RenderPositionalResponsibilities()
                </div>
            </text>
         )
}
.Render();
} 
```

对于希望为特定目的创建帮助程序的用户来说，这可能更适合。此外，由于您在 cshtml 文件（用于剃刀）中创建了帮助程序，因此您可以获得控件的所有智能感知。

# unit-testing - 我需要测试帮助程序/设置方法吗？

> ID：1004866
> 
> 赞同：3
> 
> 时间：2009-06-17T02:48:55.543
> 
> 标签：unit-testing, refactoring

所以我有一个看起来像下面这样的辅助方法：

```
private D GetInstanceOfD(string param1, int param2)
{
    A a = new A();
    B a = new B();
    C c = new C(a,b, param1);

    return new D(c, param2);
} 
```

它只是一个方便的辅助方法，我可以调用它来获取我需要的特定对象，而不是记住我需要连接哪些依赖项来获取我需要的对象。

我的第一个问题是：应该测试这样的方法吗？我能想到要测试这些类型的方法的唯一原因是确保使用正确的依赖项并正确设置。

如果第一个问题的答案是肯定的，我的第二个问题是：如何？我目前正在使用 NUnit 和 RhinoMocks 并试图弄清楚如何将这种方法重构为可测试的（嗯，是否应该测试这样的东西！）；依赖注入显然在这里不起作用，因为这种方法实际上会创建依赖关系！

或者使用这种方法是不好的做法，我应该做如下的事情：

```
D d = new (new C(new A(), new B(), "string"), 1024); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T02:54:12.647

要回答您的第一个问题，是的，您应该测试此方法。测试此方法将比编写整篇文章花费更少的精力，并且将为您提供运输代码的验证。

至于如何这取决于您打算使用该方法做什么。假设功能的合理行为，您可以测试以下内容

*   如果我为第一个参数传递 null 会发生什么？
*   如果我为第二个参数传递一个负数会发生什么？
*   在您期望的情况下，GetInstanceOfD 是否实际上返回 D ？
*   D 是否具有给定输入的正确值。
*   假设 C、A 和 B 实例是可访问的，它们会怎样呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T02:54:19.603

当你遇到这样的问题时，要记住的一件好事是*让事情变得微不足道*。

设置方法需要简单。拆卸方法必须是微不足道的。辅助方法可以很重要——如果它们有自己的测试集的话。

如果您的单元测试本身变得如此复杂以至于*需要*对其进行测试，那么您做错了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T03:05:27.867

首先，该方法是私有的，因此，通常我会说该方法可能不需要直接进行测试。即使它是真实代码的辅助方法，而不是测试的辅助方法，您也可能只想通过公共接口间接测试它。

其次，如果你确实想测试它——也许无论如何——你应该考虑使用工厂来创建对象，而不是直接实例化对象。将工厂与接口结合使用，将允许您将依赖关系抽象出来。只需将工厂注入到包含此方法的类的构造函数中，并将其用作此方法中的属性来创建适当的对象。如果你走这条路，你可能还会发现工厂也是逻辑创建 D 的地方。

如果代码是生产代码，这肯定是我会采取的方向。下面的例子：

```
public class ObjectFactory 
{
     public virtual A CreateA() { return new A(); }
     public virtual B CreateB() { return new B(); }
     public virtual C CreateC( string str ) { return new C( CreateA(), CreateB(), str );
     public virtual D CreateD( string str, int num )
     {
         return new D( CreateC( str ), num );
     }
}

public class Foo
{
    private ObjectFactory ObjectFactory { get; set; }

    public Foo() : this(null) { }
    public Foo( ObjectFactory factory )
    {
         this.ObjectFactory = factory ?? new ObjectFactory();
    }

    public void Bar()
    {
        D objD = this.ObjectFactory.CreateD( param1, param2 );
    }
}

[TestMethod]
public void TestBar()
{
     var factory = MockRepository.GenerateMock<ObjectFactory>();
     var d = MockRepository.GenerateMock<D>();
     factory.Expect( f => f.CreateD( "abc", 10 ) ).Return( d );

     var foo = new Foo( factory );

     foo.Bar();

     factory.VerifyAllExpectations();
     d.VerifyAllExpectations();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T11:42:38.113

你应该测试这个方法。您应该对其进行测试，因为它可能会失败；一个 XP 格言是*测试所有可能破坏*的东西。

现在，这并不意味着您必须为它创建新的测试；可以通过其他方法间接测试。如果它是在重构期间提取的，那么它可能已经过测试。

如果需要，测试它的一种方法是将它提取到一个辅助类中，它不会是私有的，并将它分成几个函数以便能够注入依赖项。

```
//--- don't write this, you'll probably regret it ;o)
D d = new (new C(new A(), new B(), "string"), 1024); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T08:40:57.857

`private`方法通常表明它们不需要直接测试，因为您将测试使用这些方法的`private`方法。

该方法感觉像是属于工厂或构建器类，而不是私有方法。如果您将实例化代码隐藏为私有方法，它将无法优雅地测试。

# apache-flex - 在 flash 中编译一个 swc 以用于 flex，并带有一个用 flex 编写的类

> ID：1004867
> 
> 赞同：2
> 
> 时间：2009-06-17T02:49:15.200
> 
> 标签：apache-flex, flash, actionscript-3, swc

好的，

这听起来很复杂，但事实并非如此。这里是：我想使用我在 flex actionscript 项目中在 flash 中创建的一些资产（按钮等）。由于我所有的资产都低于 10K，我不打算加载 swf，等到它加载并创建界面。我想使用一个 swc 并且只是实例化我需要的剪辑。另外，我希望我的 Button 类有一些额外的属性，这就是问题发生的地方。

如果在 Flash IDE 的链接属性中添加对自定义按钮类的引用并跟踪 Button MovieClip 的子项，我会得到正确的跟踪。如果然后我在 Flex 的 Main 类中创建一个 Button，使用生成的 swc 文件并跟踪 Button MovieClip 的同一个子项，我得到 null。

这是为什么 ？有没有办法解决这个问题？我考虑过使用 Flex Component Kit，但由于我正在处理一个简单的 actionscript 项目并且我没有使用 Flex 框架，所以我认为此时使用 Component Kit 没有任何意义。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T09:17:33.913

我想我明白了。

我的 Button MovieClip 链接到与 Flex actionscript 项目中的其余 actionscript 代码相同的 src 文件夹中的类。（as3 类路径设置为“../”，从 .fla 文件所在的 assets 文件夹，到 src 一级）

当 Flash 编译时，找到了类，我进入了 .swc 文件。这就是为什么我从 flash 中找到符号的原因。Flex 编译时，在 src 目录中找到了该类，因此编译了同一类的新版本，尽管它已经存在于 swc 文件中。由于 flex 找到了 .as 文件，但不知道我将它链接到 Flash IDE 中的符号（我认为它不能这样做），Flex 创建了它的类版本，但由于没有链接符号到那个班级，我正在追踪的 Button 的孩子为空。

我猜想使用包并将 fla 链接的类分开，这样 Flex 就不会编译同一个类两次。

奇怪的是我没有收到任何警告或错误，所以我认为一切都很好。

一个快速且不太脏的解决方法是从文件系统中删除物理 Button 类，以便 Flash 可以在编译时生成它的版本并引用 Button 符号的子代。然后在 Flex 中，我创建了一个扩展 Button 的类并添加了我需要的代码。由于生成的类是在 .swc 文件中编译的，因此 Flex 可以看到这一点，并且我在扩展时也没有问题。

就是这样！鲍勃你是叔叔！

我假设会发生什么，我不能 100% 确定。这是我的直觉通过观察认为理所当然的事情，所以我可能在技术上是错误的。如果有人有任何更正，他们是受欢迎的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T08:17:28.260

我不确定我是否正确阅读了您的问题，但您是否真的想要嵌入从一开始就可用的图像/资产，一旦应用程序启动就加载图像/资产？

如果是这种情况，请查看此链接。它解释了如何将任何资产嵌入到 actionscript 项目中。[http://kennethsutherland.com/2009/04/21/why-flex-why-actionscript-why-flash/](http://kennethsutherland.com/2009/04/21/why-flex-why-actionscript-why-flash/)

希望这是你的追求。

# c# - 你有这些方法的工厂吗？类型或工厂中的静态方法？

> ID：1004872
> 
> 赞同：0
> 
> 时间：2009-06-17T02:52:31.060
> 
> 标签：c#, refactoring

抱歉标题不好，我只是不知道如何正确表达。

假设我有一个名为 Table 的类和这三种方法：

```
//Creates a new table in underlying provider and returns new Table object.
CreateNew(string Name); 
//Opens the table in provider and returns new Table object.
OpenTable(string Path);
//Same action as above just on a collection, and returns a IList<Table>
OpenTables(IList<string> path); 
```

目前我正在使用这样的东西，其中所有方法在类型上都是静态的：

```
Table tab = Table.OpenTable("SomePath");
Table tab = Table.CreateNew("DummyTableName"); 
```

你明白了。

但是我想知道这些是否真的应该在工厂里。像这样的东西：

```
 TableFactory factory = new TableFactory();
 Table tab = factory.CreateNew("DummyTableName");
 Table tab = factory.OpenTable("SomePath"); 
```

工厂不会是静态的，因为这会使使用工厂的其他代码难以测试

你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T03:01:29.030

这取决于您要达到的目标。如果您使用工厂，您可以获得更好的控制反转，例如，您可以为在测试期间使用的 Table 创建一个测试实现，这允许对您的单元测试进行更细粒度的控制。

如果您的工厂使用无处不在，您可以在测试模式下将其替换为 TestTable 工厂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T03:01:34.800

使用工厂的主要原因是将对象的创建与其使用分离。由于您只是在创建`Table`具有不同参数的对象，因此我认为将静态创建方法从`Table`类本身中分离出来更有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T03:18:44.063

你有没有考虑过：

```
var tab = new Table("tableName"); 
```

和

```
var tablePath = new TablePath("SomeTablePath");
var tab = new Table(tablePath); 
```

OTOH，如果你想要一个工厂和所有可以给你的解耦，我会提取一个表接口，并让工厂返回接口。

# javascript - 压缩 javascript 的 Makefile

> ID：1004873
> 
> 赞同：5
> 
> 时间：2009-06-17T02:53:48.687
> 
> 标签：javascript, makefile, jscompress

我想在 yui 压缩器中压缩 javascript，如何编写压缩 javascript 的 Make 文件。

因为语法难，看不懂，能给我一个Makefile的样例吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T03:25:31.477

你的makefile看起来像

```
code.compressed.js: code.js
    compressor -o $@ $< 
```

请注意，第二行使用*制表符*缩进，而不仅仅是空格。make 实用程序关心这一点。

`code.compressed.js`是应该写入文件的名称，`code.js`是要压缩的文件，`compressor`是执行压缩的程序。

该`-o`标志指示输出文件，遵循编译器和类似工具的约定。您的可能会有所不同；检查其文档。

在这种情况下，该变量`$@`是“此规则的目标”的 Makefile 简写。`code.compressed.js`同样，`$<`是“此规则的第一个依赖项”的缩写。这些变量很有用，因此您无需重复自己，也无需在文件重命名时进行重复更改。

如果您有多个文件都将被压缩到一个输出文件中，您可以将它们全部放在依赖行中，然后使用*构建规则*`$^`中的特殊变量来指定所有这些文件：

 *```
code.compressed.js: code1.js code2.js
    compressor -o $@ $^ 
```

或者，如果您希望它们分别压缩，您可以编写一个模式规则并将其用于所有它们：

```
TARGETS = code1.cjs code2.cjs code3.cjs

all: $(TARGETS)

%.cjs: %.js
    compressor -o $@ $< 
```

默认构建它看到的第一个目标，`all`在这种情况下。`TARGET`要压缩到的文件列表由变量的内容给出。The`%`是一个通配符，make 将代替它生成匹配源文件名和目标文件名的规则。*

# javascript - 这个 Javascript 片段有什么作用？

> ID：1004879
> 
> 赞同：0
> 
> 时间：2009-06-17T02:56:38.117
> 
> 标签：javascript, jquery, ajax

```
$.post("", {message: msg}, function() { 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T02:58:38.147

那是[jQuery post 方法](http://docs.jquery.com/Ajax/jQuery.post#urldatacallbacktype)向当前页面发出 POST 请求（我在这里猜测，如果该参数是空字符串，我假设它只是发布到当前页面），变量的内容`msg`作为名为的参数传递`message`

# php - 关于PHP中strpos的问题

> ID：1004897
> 
> 赞同：2
> 
> 时间：2009-06-17T03:02:41.600
> 
> 标签：php

我只是想弄清楚...

```
$mystring = "/abc/def/hij";
$find = "/abc";

echo(strpos($mystring, $find) . "<br>");
if (strpos($mystring, $find) >= 0) {
    echo("found");
} else {
    echo("not found");
} 
```

这将给出： 0 找到

```
$mystring = "/abc/def/hij";
$find = "/fffff";

echo(strpos($mystring, $find) . "<br>");
if (strpos($mystring, $find) >= 0) {
    echo("found");
} else {
    echo("not found");
} 
```

输出：找到[空白]

现在，如果我更改比较器并使用“！= False”而不是“> = 0”

```
$mystring = "/abc/def/hij";
$find = "/fffff";

echo(strpos($mystring, $find) . "<br>");
if (strpos($mystring, $find) **!= false**) {
    echo("found");
} else {
    echo("not found");
} 
```

这几乎适用于所有情况，除非我在字符串的开头查找子字符串。例如，这将输出“未找到”：

```
$mystring = "/abc/def/hij";
$find = "/abc";

echo(strpos($mystring, $find) . "<br>");
if (strpos($mystring, $find) != false) {
    echo("found");
} else {
    echo("not found");
} 
```

那么我怎样才能使它工作呢？我只想知道字符串中是否存在子字符串，如果子字符串是开头还是整个字符串，它应该给我“真”...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T03:08:37.517

使用`!==`运算符进行测试。这将比较类型和值，而不仅仅是值：

```
$mystring = "/abc/def/hij";
$find = "/abc";

echo(strpos($mystring, $find) . "<br>");
if (strpos($mystring, $find) !== false) {
    echo("found");
} else {
    echo("not found");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T03:07:51.653

我发现问题出在哪里...我需要使用 !== false 而不是 != ... Aaaah，php。

# jquery - JQuery Ajax 调用给出 404 'Resource Not Found' 错误，但正常的 URL 调用很好

> ID：1004899
> 
> 赞同：8
> 
> 时间：2009-06-17T03:03:33.657
> 
> 标签：jquery, asp.net-mvc

在我的 ASP.NET MVC 项目中使用 JQuery 调用时，我遇到了一个奇怪的问题。我发现 Ajax 调用给出了 404（资源未找到错误）。但是当我使用通常的 URL GET 调用时，我可以成功调用服务器而没有任何问题。知道为什么会这样吗？

这是我的 ASP.NET MVC 代码

```
public class ViewRecordController: Controller
{
  public JSONResult GetSoftwareChoice(string username)
  {
     return Json(username);
  }
} 
```

这是我的 JQuery 代码：

```
$(function() {
$("#username").click(function() {
        $.getJSON("ViewRecord/GetSoftwareChoice", {username:'123'},
    function(data) {
        alert(data);
    });
    });
}); 
```

上面的 JQuery 给了我一个 404 错误。就 AJAX 调用而言，显然`ViewRecord/GetSoftwareChoice`在服务器上找不到。

但是如果我在我的网络浏览器中输入这个：

```
http://myapp/ViewRecord/GetSoftwareChoice?username=123 
```

那么就没有问题了。

这确实很奇怪。

以防万一您有兴趣，这是我的路线：

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    routes.MapRoute(
        "Default",                                              // Route name
        "{controller}/{action}/{id}",                           // URL with parameters
        new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
    );

} 
```

编辑：我进入我的代码，发现 URL 调用是`ViewRecord/GetSoftwareChoice?username=123`.

相关问题：[Select Element inside Form not working in JQuery](https://stackoverflow.com/questions/1000246/select-element-inside-form-not-working-in-jquery)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T03:14:17.240

您可能想尝试使用 UrlHelper，而不是对 URL 进行硬编码：

```
$(function() {
    $("#username").click(function() {
        var url = '<%= UrlHelper.Action("GetSoftwareChoice", "ViewRecord") %>';
        $.getJSON(url, {username: '123'}, function(data) {
            alert(data);
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-17T04:19:15.450

我通过使用 FireBug 向我显示由 JQuery 生成的请求来解决此问题。令我惊讶的是，生成的网址是

```
http://localhost/ViewRecord/ViewRecord/GetSoftwareChoice?username=123 
```

对于 JSON 调用：

```
$(function() {
$("#username").click(function() {
        $.getJSON("ViewRecord/GetSoftwareChoice", {username:'123'},
    function(data) {
        alert(data);
    });
    });
}); 
```

所以我只需要将`$.getJSON`线路更改为

```
$.getJSON("GetSoftwareChoice", {username:'123'}, 
```

或者，使用正斜杠：

```
 $.getJSON("/ViewRecord/GetSoftwareChoice", {username:'123'}, 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-12T09:52:19.737

```
$(function() {
    $("#username").click(function() {
        $.getJSON('<%= Url.Action("GetSoftwareChoice", "ViewRecord")%>',{username: '123'}, function(data) {
            alert(data);
        });
    });
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T03:15:25.553

使用 Firefox Firebug 插件，并观察 Jquery 发出的请求......

运行此 Jquery 的页面是否可能位于子目录中，在这种情况下，请求不会像[http://myapp/](http://myapp/) “输入”网址那样是相对根目录？

另外，我猜您上面指定的代码实际上并不是您正在使用的代码（这是完全合理的，我很少按原样发布代码）。因为

```
$.getJSON("ViewRecord/GetSoftwareChoice", {username='123'}, 
```

据我所知，用户名和“123”之间的 = 符号是无效的 JS。所以我敢打赌，导致问题的真实代码中有一些愚蠢的细节。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T03:17:51.790

用冒号替换等号：

```
$(function() {
$("#username").click(function() {
        $.getJSON("ViewRecord/GetSoftwareChoice", {username:'123'},
    function(data) {
        alert(data);
    });
    });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-05T18:15:53.437

我也有同样的问题。在像 Graviton 一样使用 Firebug 之后，我发现我的路径很不稳定，所以我将其更改为我的操作名称。 `Get_OrderLine`是我在控制器中的操作名称。 `inv_item_id`是传递给控制器​​动作的参数。

```
// Update OrderLine data by returning a JSON result
$('#itemsddl').click(function (e) {
    var selectedItem = $(this).val();
    var actionURL = "Get_OrderLine";
    var d = "inv_item_id=" + selectedItem;
    var uom = $('#uom');
    var size = $('#size');
    var unitLbs = $('#unitLbs');
    var totalLbs = $('#totalLbs');
    var shipName = $('#shipName');
    var hazardClass = $('#hazardClass');
    var unnaNo = $('#unnaNo');
    var packingGroup = $('#packingGroup');
    var placard = $('#placard');
    var ergNo = $('#ergNo');
    $.ajax({
        cache: false,
        type: 'GET',
        url: actionURL, 
        data: d,
        datatype: JSON,
        success: function (data) {
            uom.val(data.uom);
            size.val(data.size);
            unitLbs.val(data.unitLbs);
            totalLbs.val(data.totalLbs);
            shipName.val(data.shipName);
            hazardClass.val(data.hazardClass);
            unnaNo.val(data.unnaNo);
            packingGroup.val(data.packingGroup);
            placard.val(data.placard);
            ergNo.val(data.ergNo);
        },
        error: function (xhr, ajaxOptions, thrownError) {
            alert('Failed to query item - ' + thrownError + "\n" + "Full details: " + xhr.responseText);
        }
    });
    e.preventDefault();
}); 
```

这是我的操作，它将 JSON 结果返回到我的 jQuery。jQuery 函数然后处理从 JSON 到 HTML 的映射。不是很漂亮，但它有效。

```
public ActionResult Get_OrderLine(int? inv_item_id)
{
    HazmatInfoItem item = new HazmatInfoItem();
    item.itemId = "0";
    item.size = "0";
    item.unitLbs = 0;
    item.qty = 0;
    item.totalLbs = item.qty * item.unitLbs;
    item.shipName = "";
    item.hazardClass = "";
    item.unnaNo = "";
    item.packingGroup = "";
    item.placard = "";
    item.ergNo = "";

    var items = from i in hazmatRepository.GetAllItems()
                select i;

    // Get item details
    items = items.Where(i => i.INV_ITEM_ID.Contains(inv_item_id.ToString()));

    foreach (var i in items)
    {
        item.uom = i.UNIT_MEASURE_STD;
        item.size = i.INV_ITEM_SIZE;
        item.unitLbs = 1;
        item.totalLbs = item.unitLbs * item.qty;
        item.shipName = i.PAG_SHIPPING_NAME;
        item.hazardClass = i.HAZ_CLASS_CD;
        item.unnaNo = i.MSDS_ID;
        item.packingGroup = i.PACKING_CD;
        item.placard = i.PAG_PLACARD_TYPE;
    }

    return Json(item, JsonRequestBehavior.AllowGet);
} 
```

我最初添加了一条新路由来尝试处理此问题，但将其注释掉以允许默认路由。

希望这些解决方案可以帮助其他在尝试将 .ajax 与 jQuery 和 MVC 一起使用时遇到类似问题的人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-12T11:12:24.737

旧功能：

```
function Chart() {

    var url = "../Home/Pie/";
    $.ajax({
        url: url,
        data: {},
        cache: false,
        type: "POST",
        success: function (data) {
            var chartData = data;
            createChart(chartData);
            $(document).bind("kendo:skinChange", createChart);
        },
        error: function (xhr, status, error) {
            $('#alertdialog').html(status);
            $('#alertdialog').dialog('open');
            return false;
        }
    });
} 
```

**答案：** **var url = "Home/Pie/** "; 从网址中删除 ../

# maven-2 - Hudson 构建成功但单元测试失败

> ID：1004912
> 
> 赞同：20
> 
> 时间：2009-06-17T03:08:11.870
> 
> 标签：maven-2, hudson, testing

这与我询问的另一个问题有关，试图在单个单元测试失败时使 Hudson 失败。

当我在我的独立构建上运行 Maven 时，由于单元测试错误（正在运行`mvn clean install`）而失败，但是当我在 Hudson 中运行它时，它说由于测试失败而出现错误，但构建仍然成功（并标记为不稳定） . 有什么想法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-17T06:32:35.133

你创造了什么样的哈德逊工作？我怀疑这是 m2 项目而不是自由式项目。在 m2 项目中，Hudson 实际上会调整您的 pom 配置方式，以防止失败并将其标记为不稳定。这是故意的。

尝试`maven.test.failure.ignore=false`在 Advanced 设置下进行设置，因为我相信 Hudson 会自动将其设置为`true`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T17:56:01.510

Hudson 的约定是，如果构建返回成功，它只会寻找测试。如果构建失败，hudson 将其解释为存在一些导致构建无法工作的不可恢复错误，而不是某些测试失败。

这是非常有用的差异，因此*不稳定*（黄色）意味着构建完成并且测试都能够运行，但有些失败。

*错误*意味着构建失败，因为它无法编译，或者有一些其他不可恢复的错误导致测试无法*运行*，在这种情况下，hudson 不会报告单元测试状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T19:28:50.557

每个作业的配置中还有 hudson 选项，用于确定在构建变得不稳定时如何操作，例如是否发送电子邮件等。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-10-27T15:40:51.310

[刚刚看到Hudson Bugtracker](https://hudson.dev.java.net/issues/show_bug.cgi?id=4378)上报告了这个缺陷

# silverlight - 以声明方式重复模式的最佳方法

> ID：1004918
> 
> 赞同：0
> 
> 时间：2009-06-17T03:10:46.217
> 
> 标签：silverlight, silverlight-2.0

我正在做一个小模拟时钟项目来学习 Silverlight，显然在绘制钟面时有一个重复的图案，我看到的所有例子实际上都重复了 xaml，只是改变了角度来获得整个面，但我我想知道是否有更好/更容易/更短的方法来以**声明**方式完成相同的结果（我知道如何以编程方式完成）

这就是我所拥有的，它在第二个画布之后重复，是唯一的不同角度

```
 <Canvas Width="100" Height="100" RenderTransformOrigin="0.5,0.5">
        <Rectangle Fill="Black" Width="6" Height="8" Canvas.Top="1" Canvas.Left="47" RenderTransformOrigin="0.5,0.5" />
    </Canvas>
    <Canvas Width="100" Height="100" RenderTransformOrigin="0.5,0.5">
        <Rectangle Fill="Black" Width="6" Height="8" Canvas.Top="1" Canvas.Left="47" RenderTransformOrigin="0.5,0.5" />
        <Canvas.RenderTransform>
            <RotateTransform Angle="30"/>
        </Canvas.RenderTransform>
    </Canvas> 
```

更新：虽然提供的答案在正确的方向上，但它们并不具体，而且它们仅针对模拟时钟的特定场景，与围绕圆圈重复图案的整个范围相反，我尝试了第二个中的代码回答，它几乎得到了我想要的东西，但我仍然需要弄清楚如何获得小时/分钟指标，我一直在尝试，我得到了圆圈周围的线条，但不是我需要的模式中的线条；所以如果有人过来给我具体的答案，我会接受，否则，我会继续尝试，并会在这里发布答案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T04:10:23.793

使用带有粗椭圆的破折号图案。在此处查看 XAML：http: [//code.msdn.microsoft.com/trainmaster](http://code.msdn.microsoft.com/trainmaster)和[此处](http://xmldocs.net/ball2)的应用程序。

[Silverlight 中的 Ball Trainmaster Cannonball 手表 http://xmldocs.net/ball2/background.png](http://xmldocs.net/ball2/background.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T12:13:41.233

您也可以使用 Path 来完成相同的操作。查看 Charles Petzold 的“所有 Xaml 时钟”。

```
<!-- Tick marks (small and large). -->

<Path Data="M 0 -90 A 90 90 0 1 1 -0.01 -90"
      StrokeDashArray="0 3.14157" />

<Path Data="M 0 -90 A 90 90 0 1 1 -0.01 -90"
      StrokeDashArray="0 7.854"
      StrokeThickness="6" /> 
```

来自[http://www.charlespetzold.com/blog/2006/04/070132.html](http://www.charlespetzold.com/blog/2006/04/070132.html)

请注意，这是一个 WPF 示例。

# ruby-on-rails - jruby on tomcat - RackInitializationException

> ID：1004920
> 
> 赞同：1
> 
> 时间：2009-06-17T03:10:56.357
> 
> 标签：ruby-on-rails, tomcat, jruby

在关注[http://kenai.com/projects/jruby/pages/JrubyOnRailsOnTomcat#Rails_2.0](http://kenai.com/projects/jruby/pages/JrubyOnRailsOnTomcat#Rails_2.0) 尽管使用 tomcat 5.5、jruby 1.3.0、rails 2.3.2

Tomcat 给出：

严重：无法创建共享应用程序实例 org.jruby.rack.RackInitializationException：请安装 jdbc 适配器：（`gem install activerecord-jdbc-adapter`没有要加载的文件--active_record/connection_adapters/jdbc_adapter）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T04:16:40.783

需要做以下...

gem 安装 activerecord-jdbcmysql-adapter gem 安装 jruby-openssl

从 warble.rb 中取消注释以下行

```
config.gems += ["activerecord-jdbcmysql-adapter", "jruby-openssl"] 
```

# vb.net - 获取 Microsoft Visual Studio 6.0 的调试日志

> ID：1004928
> 
> 赞同：0
> 
> 时间：2009-06-17T03:14:41.937
> 
> 标签：vb.net, visual-studio

如何获取Microsoft Visual Studio 6.0 中调试VB 代码的日志？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T03:28:17.120

如果我理解您要问什么，在构建的应用程序上截取 debug.print 语句试试这个：（我使用过这个工具，但不记得是否需要调试编译或者它是否适用于发布版本）

[http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)

DebugView 是一个应用程序，可让您监视本地系统上的调试输出，或者可以通过 TCP/IP 访问的网络上的任何计算机。它能够显示内核模式和 Win32 调试输出，因此您不需要调试器来捕获应用程序或设备驱动程序生成的调试输出，也不需要修改应用程序或驱动程序以使用非标准调试输出 API。

DebugView 捕获 在 Windows 2000、XP、Server 2003 和 Vista 下 DebugView 将捕获：

Win32 OutputDebugString Kernel-mode DbgPrint 在 Windows XP 和 Server 2003 中实现的 DbgPrint 的所有内核模式变体 DebugView 还会从 Window 的 2000/XP 崩溃转储文件中提取崩溃前生成的内核模式调试输出，如果 DebugView 在崩溃时正在捕获.

# c# - RandomNumber 方法每次调用都返回相同的数字

> ID：1004929
> 
> 赞同：6
> 
> 时间：2009-06-17T03:14:52.683
> 
> 标签：c#, random

每次从我的 for 循环中调用我的 RandomNumber 方法时，我都试图生成一个不同的随机数。现在，它每次都返回相同的数字。

这是我的 RandomNumber 方法：

```
 private int RandomNumber(int min, int max)
    {
        Random random = new Random();
        return random.Next(min, max);
    } 
```

这是我在其中使用它的上下文：（这有点混乱，只是因为我一直在试图让它工作......）

```
 for (int i = 0; i < charsRaw.Length; i++)
        {
            int max = charsRaw.Length - 1;
            int rand = 0;
            rand = RandomNumber(0, max);

            charsNew[i] = charsRaw[rand];
            text2 += charsNew[i];

         } 
```

每次使用 for 循环调用它时，我似乎都无法让它返回不同的值。

虽然，当我在 text2 += charsNew[i] 之后粘贴 MessageBox.Show(rand.ToString()) 时，它每次都会给我一个不同的值，并按照我的预期工作。奇怪的。

谢谢！埃里克

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-17T03:16:06.770

实例化 Random 一次。在同一个实例上多次调用 .Next() 。

[MSDN](http://msdn.microsoft.com/en-us/library/system.random.aspx)：

> 随机数生成从种子值开始。如果重复使用同一个种子，就会产生同一系列的数字

如果您确实希望重复实例化 Random，请每次使用不同的种子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T03:38:59.547

没有什么说一个真正的随机序列每次都不能是相同的数字！:-) 它是合法的可能性很小，所以你永远无法真正确定。*鸭子作掩护*

# mingw - 如何在 openSUSE、Linux 风格中安装 MinGW？

> ID：1004933
> 
> 赞同：3
> 
> 时间：2009-06-17T03:16:17.237
> 
> 标签：mingw, opensuse

为[openSUSE](http://en.wikipedia.org/wiki/OpenSUSE)安装 MinGW 的过程是什么，并发送链接给我，在那里我可以获得正确的 MinGW 安装包。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-13T05:21:44.203

您可以在此处获取用于 MinGW 的 openSUSE RPM：[SUSE 交叉工具链](http://download.opensuse.org/repositories/CrossToolchain:/mingw/)。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-06-17T04:35:05.350

如果您想交叉编译 Qt 应用程序，您可以简单地安装[Qt Creator](http://www.qtsoftware.com/downloads) for linux。

MinGW 是适用于 Windows 的简约 GNU，尝试在 linux 下运行 Windows 交叉编译器会有点多余，不是吗？只需安装 linux 变体并交叉编译。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-06-17T04:27:43.403

MinGW 是 GCC 的最小包。Linux 使用完整的 GCC。

# java - 键盘事件处理

> ID：1004935
> 
> 赞同：0
> 
> 时间：2009-06-17T03:16:51.697
> 
> 标签：java

我正在做远程屏幕捕获和控制的项目....我已经完成了屏幕捕获....现在我要进行控制....我想要....我已经通过鼠标事件完成了控制像mouseMove & mousePressed,mouseReleased...但是 ***键盘控制***没有完成...所以告诉我如何在机器人类上做KeyBoard事件并使用它如何进行控制...？

所以建议我如何通过键盘事件进行控制的解决方案......谢谢......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T03:36:17.273

该类[`Robot`](http://java.sun.com/javase/6/docs/api/java/awt/Robot.html)同时具有[`keyPress`](http://java.sun.com/javase/6/docs/api/java/awt/Robot.html#keyPress(int))和[`keyRelease`](http://java.sun.com/javase/6/docs/api/java/awt/Robot.html#keyRelease(int))方法，可用于在机器上引发关键事件。

以下是我尝试在 Windows 中启动记事本的一个小演示代码，等待半秒并`hello`输入：

```
Runtime.getRuntime().exec("notepad");

Robot r = new Robot();
r.setAutoDelay(100);
r.delay(500);
r.keyPress(KeyEvent.VK_H);
r.keyPress(KeyEvent.VK_E);
r.keyPress(KeyEvent.VK_L);
r.keyPress(KeyEvent.VK_L);
r.keyPress(KeyEvent.VK_O); 
```

# git - 如何使用 Git？

> ID：1004936
> 
> 赞同：119
> 
> 时间：2009-06-17T03:17:20.323
> 
> 标签：git

我是一名工科学生，大部分业余时间都在看电视而不是编码。所以基本上我对任何类型的版本控制系统都没有经验。我的理解是，它们以某种方式使项目的分发变得更容易。

我正在研究[Blueprint CSS Framework](http://github.com/joshuaclayton/blueprint-css/tree/master)，喜欢它并从他们的 Git 项目页面下载。现在，我知道 Git 不仅仅是在他们的网站上提供链接。所以我的问题如下：

*   如何正确使用 Git 来更新我的蓝图下载？说有新版本，我该怎么办？
*   我可以同时更新所有 Git 下载吗？假设我在我的 Mac 上下载了蓝图和其他项目，如何有效地更新它们？

我查看了 Git 指南，但它主要是为那些比我有更多经验的人准备的。

感谢帮助 ：）

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-06-17T03:24:05.800

看看[git for Designers](http://hoth.entp.com/output/git_for_designers.html)以获得很棒的一页文章/对该主题的高级介绍。（该链接已损坏：这是[另一个 Git for Designers](http://blog.teamtreehouse.com/git-for-designers-part-1)的链接）

我将从[http://git-scm.com/documentation](http://git-scm.com/documentation)开始，这里有面向非软件开发者/cs 用户的文档和精彩的视频演示。[初学者的 Git](http://www.spheredev.org/wiki/Git_for_the_lazy)有一些基本的东西。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-06-17T04:05:50.547

我真的很喜欢 O'Reilly 的书“使用 Git 进行版本控制”。我从头到尾阅读了它，现在我对高级 git 主题非常熟悉。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-06-17T04:32:48.957

**git clone your-url local-dir**

签出源代码；

**git 拉**

更新本地目录中的源代码；

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-17T03:20:45.683

您可能想先[介绍版本控制](http://betterexplained.com/articles/a-visual-guide-to-version-control/)。本指南专门针对 subversion，但核心概念可以应用于大多数版本控制系统。掌握基础知识后，您可以深入研究 git 指南。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-17T03:27:33.407

我认为[gitready](http://www.gitready.com/)是一个很好的起点。我现在正在将 git 用于一个项目，并且该站点几乎让我受益匪浅。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-17T03:30:03.183

要直接回答您的问题，而不是指向您的文档：

1）为了使其保持最新，请执行 git pull ，这将在您当前使用的分支（通常是主分支）上拉下存储库中的最新更改

2）我不认为有什么东西（广泛可用）可以为你做到这一点。要更新它们，请遵循 1) 所有项目。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-06-23T11:55:07.823

使用 Git 进行版本控制

Visual Studio 代码具有集成的 Git 支持。

*   使用 git 的步骤。

安装 Git：[https ://git-scm.com/downloads](https://git-scm.com/downloads)

***1）初始化您的存储库***

导航到要初始化 Git 的目录

使用**git init**命令这将创建一个空的 .git 存储库

***2）分阶段进行更改***

暂存是让 Git 跟踪我们新添加的文件的过程。例如添加一个文件并输入 git status。您将找到未跟踪文件的状态。因此，要进行更改，请使用**git add filename**。如果现在键入 git status，您会发现添加了新文件以进行跟踪。

您还可以取消暂存文件。使用 git 重置

***3) 提交更改***

提交是将您的更改记录到存储库的过程。要提交状态更改，您需要添加注释来解释自上次提交以来所做的更改。

使用**git commit -m 消息字符串**

我们还可以使用命令**git add '*.txt'**提交多个相同类型的文件。此命令将提交所有带有 txt 扩展名的文件。

***4）跟随变化***

使用版本控制的目的是保留项目中每个文件的所有版本，将当前版本与上次提交进行比较，并保留所有更改的日志。

使用**git log**查看所有更改的日志。

Visual Studio 代码集成的 git 支持帮助我们通过双击文件或**使用 git diff HEAD来比较代码**

您还可以在最后一次提交时撤消文件更改。使用**git checkout -- file_name**

***5）创建远程存储库***

到目前为止，我们已经创建了一个本地存储库。但是为了将其推送到远程服务器。我们需要在服务器中添加一个远程存储库。

使用**git remote add origin server_git_url**

然后将其推送到服务器存储库

使用**git push -u origin master**

假设已经过去了一段时间。我们邀请了其他人加入我们的项目，他们拉动了我们的更改，做出了自己的承诺，并推动了他们。

因此，为了从我们的团队成员那里获取更改，我们需要拉取存储库。

使用**git pull origin master**

***6) 创建分支***

让我们认为您正在研究一个功能或一个错误。更好的是，您可以创建代码（分支）的副本并单独提交。完成后，将此分支合并回其主分支。

使用**git branch 分支名称**

现在您有两个本地分支，即 master 和 XXX（新分支）。您可以使用**git checkout master**或 git **checkout new_branch_name切换分支**

**使用git commit -m message 提交**分支更改

 ****使用git checkout master**切换回master

 **现在我们需要将新分支的更改合并到我们的 master 使用**git merge branch_name**

好的！您刚刚完成了错误修复或功能开发和合并。现在你不再需要新的分支了。所以使用**git branch -d branch_name删除它**

**现在我们在使用git push**将所有内容推送到远程存储库的最后一步

 **希望对你有帮助

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-26T14:23:58.010

我会为初学者推荐这三个

[http://git-scm.com/docs/gittutorial](http://git-scm.com/docs/gittutorial)

[https://tutsplus.com/course/git-essentials/](https://tutsplus.com/course/git-essentials/) **（视频教程）**

[http://lifehacker.com/5983680/how-the-heck-do-i-use-github](http://lifehacker.com/5983680/how-the-heck-do-i-use-github) **(gihub)**

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-12-03T09:30:16.587

如果您希望在一个命令中更新多个 git 存储库 - 我建议您阅读一些关于[repo](http://code.google.com/p/git-repo/)的内容。

关于更新存储库，您可以通过以下方式完成：

```
git fetch
git rebase origin/master 
```

或者

```
git pull --rebase 
```

有关使用 GIT 的更多信息，您可以查看我的[GIT 初学者指南](http://www.linux-programmer-guide.com/guides/git.php)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-02-01T15:11:16.427

这是我关于 git 的博客，它是为想要开始使用 git 的初学者准备的。 [https://techxposers.com/git-for-beginners/](https://techxposers.com/git-for-beginners/)******

# c# - 如何改进子串检测作为后缀

> ID：1004937
> 
> 赞同：0
> 
> 时间：2009-06-17T03:17:32.337
> 
> 标签：c#, .net, visual-studio-2008, string, substring

我对 C# 很陌生，我很确定这个功能可以从根本上改进：

```
public static Boolean SuffixExists(String strWhole, String sufx)
    {
        int iLen = sufx.Length;
        if (iLen > 0)
        {
            String s;
            s = strWhole.Substring(strWhole.Length - iLen, iLen);
            if (sufx != s) return false;
            else
                s = null;
            return true;
        }
        return false;
    } 
```

我将从 foreach 循环中调用此函数。如果传递的子字符串作为传递的整个字符串的后缀存在，那么我将希望通过添加前缀来更改此处传递的整个字符串。我对这段代码做了一些测试，但我知道它非常难看。我正在使用 .Net 3.5 和 Visual Studio 2008。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T03:19:39.320

返回 strWhole.EndsWith(sufx);

# sql - 我怎样才能加快这个索引视图？

> ID：1004944
> 
> 赞同：13
> 
> 时间：2009-06-17T03:19:27.947
> 
> 标签：sql, sql-server, tsql, sql-server-2008, indexed-view

我有一个简单的索引视图。当我查询它时，它很慢。首先，我向您展示模式和索引。然后是简单的查询。最后是查询计划屏幕。

### 更新：本文底部的解决方案证明。

### 架构

这就是它的样子：-

```
CREATE view [dbo].[PostsCleanSubjectView] with SCHEMABINDING AS
    SELECT PostId, PostTypeId, 
        [dbo].[ToUriCleanText]([Subject]) AS CleanedSubject
    FROM [dbo].[Posts] 
```

我的 udf`ToUriCleanText`只是用空字符替换各种字符。例如。用 '' 替换所有 '#' 字符。

然后我为此添加了两个索引：-

### 索引

主键索引（即聚集索引）

```
CREATE UNIQUE CLUSTERED INDEX [PK_PostCleanSubjectView] ON 
    [dbo].[PostsCleanSubjectView] 
(
    [PostId] ASC
)
WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, 
      SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF,
      ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO 
```

和非聚集索引

```
CREATE NONCLUSTERED INDEX [IX_PostCleanSubjectView_PostTypeId_Subject] ON 
    [dbo].[PostsCleanSubjectView] 
(
    [CleanedSubject] ASC,
    [PostTypeId] ASC
)
WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, 
      SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF,
      ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO 
```

现在，它有大约 25K 行。没什么大不了的。

当我进行以下查询时，它们都需要大约 4 秒。怎么回事？这应该是..基本上是即时的！

### 查询 1

```
SELECT a.PostId
FROM PostsCleanSubjectView a 
WHERE a.CleanedSubject = 'Just-out-of-town' 
```

### 查询 2（添加了另一个 where 子句项）

```
SELECT a.PostId
FROM PostsCleanSubjectView a 
WHERE a.CleanedSubject = 'Just-out-of-town' AND a.PostTypeId = 1 
```

我做错了什么？UDF 搞砸了？我认为，因为我已经索引了这个观点，所以它会成为现实。因此，它不必计算该字符串列。

这是查询计划的屏幕截图，如果有帮助的话：- ![替代文字](../Images/a9b25d0ffd744d46f76d9e8734b42a18.png)

另外，请注意它使用的索引？为什么要使用该索引？

那个指数是...

```
CREATE NONCLUSTERED INDEX [IX_Posts_PostTypeId_Subject] ON [dbo].[Posts] 
(
    [PostTypeId] ASC,
    [Subject] ASC
)
WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, 
      SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, 
      ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO 
```

所以，是的，有什么想法吗？

### 更新 1：为 udf 添加了架构。

```
CREATE FUNCTION [dbo].[ToUriCleanText]
(
    @Subject NVARCHAR(300)
)
RETURNS NVARCHAR(350) WITH SCHEMABINDING
AS 
BEGIN
   <snip>
   // Nothing insteresting in here. 
   //Just lots of SET @foo = REPLACE(@foo, '$', ''), etc.
END 
```

### 更新 2：解决方案

是的，这是因为我没有在视图上使用索引，并且必须手动确保我没有展开视图。服务器为Sql Server 2008 标准版。完整答案如下。这是证据，`WITH (NOEXPAND)` ![替代文字](../Images/57f228e63e88f98b0e99de8b203d2e6f.png)

谢谢大家帮我解决这个问题:)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-17T04:14:10.160

什么版本的 SQL Server？我相信只有 Enterprise 和 Developer Edition 会自动使用索引视图，而其他版本则使用查询提示来支持它。

```
SELECT a.PostId
FROM PostsCleanSubjectView a WITH (NOEXPAND)
WHERE a.CleanedSubject = 'Just-out-of-town' AND a.PostTypeId = 1 
```

从[MSDN 上的查询提示（Transact SQL）](http://msdn.microsoft.com/en-us/library/ms181714.aspx)：

> 仅当在查询的 SELECT 部分中直接引用视图并且指定了 WITH (NOEXPAND) 或 WITH (NOEXPAND, INDEX( index_value [ ,...n ] ) ) 时，索引视图才不会展开。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T03:30:32.450

我在您的执行计划中的查询代码中看到了一个 @ 符号。涉及到一个字符串变量。

如果字符串变量的类型与索引中字符串列的类型不匹配，则 Sql Server 具有 NASTY 行为。Sql Server 将...**将整个列转换**为该类型，执行快速查找，然后丢弃转换后的索引，以便它可以在下一次查询中再次执行整个操作。

* * *

西蒙想通了 - 但这里有更多有用的细节：http: [//msdn.microsoft.com/en-us/library/ms187373.aspx](http://msdn.microsoft.com/en-us/library/ms187373.aspx)

> 如果查询包含对索引视图和基表中都存在的列的引用，并且查询优化器确定使用索引视图提供了执行查询的最佳方法，则查询优化器将使用视图上的索引。此功能称为**索引视图匹配**，仅在 SQL Server Enterprise 和 Developer 版本中支持。
> 
> 但是，为了让优化器考虑匹配索引视图或使用通过 NOEXPAND 提示引用的索引视图，必须将以下 SET 选项设置为 ON：

所以，这里发生的是**索引视图匹配**不起作用。确保您使用的是 Sql Server 的 Enterprise 或 Developer 版本（很可能）。然后根据文章检查您的 SET 选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T03:40:43.317

我最近构建了一个包含数亿条呼叫详细记录的大型数据库，并且我在查询和视图中使用了一些函数，这些函数我变成了持久计算列。这效果要好得多，因为我可以在计算列上建立索引。

虽然我没有使用 SQL Enterprise，所以我没有机会使用索引视图。索引视图是否应该能够索引 UDF 的确定性结果？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T03:48:33.350

我怀疑它必须为每一行调用该函数，然后才能在 where 子句中进行比较。我会公开主题，直接运行查询检查并查看时间如何计算。每当我使用函数修改值然后在 where 子句中使用它时，我通常会看到很多缓慢...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T03:50:04.020

您希望通过使用索引视图获得什么好处？是否无法正确索引表本身？如果没有充分的理由，您会增加复杂性并要求优化器以较低的灵活性处理更多的数据库对象。

您是否使用标准索引评估了相同的查询逻辑？

混入 UDF 逻辑会使事情更加混乱。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T04:24:12.360

如果您只想持久化 UDF 的返回值，请考虑持久化计算列而不是索引视图。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-17T00:54:34.217

对于某些数据访问层，例如 EF Core，很难添加 NOEXPAND - 因此您可以创建一个额外的视图（不是架构绑定）并将其添加到那里。你可以随心所欲地称呼它，但我喜欢明确地将 NOEXPAND 放在名称中作为提醒。

```
CREATE VIEW [dbo].[DailySummary_NOEXPAND]
AS
SELECT Col1, Col2, Col3 FROM [dbo].[DailySummary] WITH (NOEXPAND)
END 
```

还在 Azure SQL（标准层）上进行了测试

重要提示：您可以使用`SELECT *`，但如果底层视图发生更改，则列索引可能会不同步，您实际上可能会得到错误的数据。[按名称指定列](https://stackoverflow.com/questions/22716598/create-view-with-select)要安全得多。

# c# - 如何将参数从 C# 传递到 MATLAB？

> ID：1004945
> 
> 赞同：3
> 
> 时间：2009-06-17T03:19:37.043
> 
> 标签：c#, image, matlab

我想将图像文件名作为参数从 C# 传递给 MATLAB。这是我到目前为止所拥有的：

*MATLAB代码*

```
function out = trial(im)
  O = imread(im);
  G = rgb2gray(O);
  imwrite(G,'output','jpeg');
  out = G; 
```

*C# 代码*

```
private void btn_Browse_Click(object sender, EventArgs e)
{
    openFileDialog1.ShowDialog();
    if (openFileDialog1.ShowDialog() == DialogResult.OK)
    {
        pictureBox1.Image = new Bitmap(openFileDialog1.FileName);
    }
} 
```

当我浏览并选择一个图像文件 ( *openFileDialog1.FileName* ) 时，我想将它作为输入参数发送到 MATLAB 函数。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T21:23:45.070

对于调用 Matlab 的外部程序，您必须使用 Matlab 引擎，它是 Matlab 套件的独立部分。不可能创建一个 C# 应用程序并让它在 Matlab 的命令窗口中运行代码。

有关如何使用[Matlab 引擎的说明，请参见此处](http://tinyurl.com/n3m7cn)（C 和 Fortran 中给出的示例）。

然后，为了让您的应用程序运行您希望的代码，您可以选择将其直接实现到您的点击事件中，或者创建一个方法并从点击事件中调用此方法。

# asp.net-mvc - 使用 ViewData 或不使用 ViewData

> ID：1004948
> 
> 赞同：8
> 
> 时间：2009-06-17T03:20:25.807
> 
> 标签：asp.net-mvc

我一直在阅读 Professional ASP.NET MVC 1.0 book 以及其他有关使用 ViewModel 而不是 ViewData 从控制器到视图的资源。但是后来我看到有很多 ViewData 的例子被用在那些除了从 ViewData 中获取东西之外别无他法的艰难场景中。但后来我读了一本像 Pro ASP.NET MVC Framework 这样的书，他只谈论 ViewData，没有关于 ViewModel。那么 ViewModel 是一个非常新的概念还是什么？

我看到 ViewModel 是一种更好的方法，但它是一个可靠的选择吗？**我的意思是 ViewData 在其他**方面很容易为您提供，例如在 ViewModel 没有的 HtmlHelper 对象中。或者例如在自定义控件中使用它（[http://www.codeproject.com/KB/custom-controls/MVCCustomControls.aspx](http://www.codeproject.com/KB/custom-controls/MVCCustomControls.aspx)）。那么我是根据不同的目标使用两者的组合还是什么？如果我出于某种原因想在我的 Extension 方法中访问 ViewModel 怎么办？我在这里迷失了要走的路。我知道 ViewData 不是强类型的，但您可以设置视图以指定类型，从而使您的 ViewData 类型化，但我只是想知道。有很多对 ViewData 的支持，但我知道 ViewModel 是一种更加抽象和分离的方式，就像它被键入一样。我只是不想在需要获取某些数据（例如 ViewData）的情况下缩短自己的时间，这些数据可以从其他对象（例如 HtmlHelper 类）轻松访问。

想法？标准？经验？我是不是有点跑题了，还是你只是使用一个组合并且在其他情况下仍然使用 ViewData，而不仅仅是从你的控制器发送数据到你的视图或什么？

如果您根本不使用 ViewData 而是将 ViewModel 与您的控制器一起使用，那么您使用 ViewModel 似乎是全有或全无，因此 ViewData 没有任何用途，因为您没有使用控制器中的任何内容进行设置所以那个时候没用？？我在这里混淆了任何人或方式吗？这是肯定的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T04:36:17.533

好吧，ViewData 是一个非常快速实现的方法。但是，您正在做很多字符串文字传递，这通常不是一件好事。你可以通过使用一些字符串常量来解决这个问题，这就是我对 Session 变量所做的，但我认为这里的 ViewModel 是一种更好的方法。任何时候你可以使用 ViewData，你也可以使用 ViewModel。ViewModel 不必只是您的域对象；它可能是一个辅助类，它不仅有一个域对象，还有一些特定于您的视图的额外属性；这就是它存在的原因。因此，使用 ViewModel，您可以让编译器为您提供帮助，而且从 OO 的角度来看，它比仅将键传递给字典要干净得多。

我认为这里的 MVC 提供了一个很好的方法。它为那些需要“完成它”和更清洁的方法的人提供了快速和肮脏（不一定是坏事），这两者都非常容易使用。

如果您还没有阅读 Scott Gurthie 的 ASP.NET MVC 教程；我强烈推荐它：

[http://weblogs.asp.net/scottgu/archive/2009/04/28/free-asp-net-mvc-nerddinner-tutorial-now-in-html.aspx](http://weblogs.asp.net/scottgu/archive/2009/04/28/free-asp-net-mvc-nerddinner-tutorial-now-in-html.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T05:33:56.913

现在视图模型被认为是有用的编程模式。阅读 Stephen Walther 的这篇文章，例如：[ASP.NET MVC Tip #50 – Create View Models](http://stephenwalther.com/blog/archive/2009/04/13/asp.net-mvc-tip-50-ndash-create-view-models.aspx)

# c# - MSN Messenger like notification - 你知道 .NET VB .NET 或 C# 中的任何示例吗？

> ID：1004953
> 
> 赞同：3
> 
> 时间：2009-06-17T03:21:20.253
> 
> 标签：c#, vb.net, notifications, taskbar

我正在寻找一个通知应用程序，我想从任务栏提供弹出通知，类似于 MSN Messenger 或大多数其他聊天程序中的通知。有没有使用 VB .NET 或 C# 的好例子，最好不使用 Win32 调用？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T05:10:46.837

也许试试这个，模仿 Outlook 而不是 MSN Messenger，但当然你仍然可以调整它：

[http://www.codeguru.com/csharp/csharp/cs_misc/userinterface/article.php/c10139](http://www.codeguru.com/csharp/csharp/cs_misc/userinterface/article.php/c10139)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T03:28:07.523

[http://www.codeproject.com/KB/miscctrl/RobMisNotifyWindow.aspx](http://www.codeproject.com/KB/miscctrl/RobMisNotifyWindow.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T03:37:43.120

也称为 toast 通知。[这是 codeproject 上的另一个示例](http://www.codeproject.com/KB/scripting/myalerts.aspx)。

有点跑题了。我认为这些东西是邪恶的。我希望它们永远不会被发明，因为它们总是在最令人分心的时候弹出。看到[人工任务切换被认为是有害](http://www.joelonsoftware.com/articles/fog0000000022.html)的。

为了麦克的爱，请检测[演示模式](http://blogs.technet.com/james/archive/2006/09/11/455407.aspx)并停止敬酒。（你听到我的Skype吗？！）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-30T21:28:33.960

我为我想要做的事情找到了一个更好的解决方案：http: [//msdn.microsoft.com/en-us/magazine/cc163732.aspx](http://msdn.microsoft.com/en-us/magazine/cc163732.aspx)

# c++ - 自定义 C++ 类上的错误

> ID：1004961
> 
> 赞同：4
> 
> 时间：2009-06-17T03:27:10.333
> 
> 标签：c++, compiler-construction, operator-overloading, overloading

我需要帮助来使用自定义 c++ 类来管理 3D 位置来查找问题。这是该课程的相关代码

```
 Punto operator+(Punto p){
    return Punto(this->x + p.x, this->y + p.y, this->z + p.z);
  }

  Punto operator+(Punto *p){
    return Punto(this->x + p->x, this->y + p->y, this->z + p->z);
  }

  Punto operator-(Punto p){
    return Punto(this->x - p.x, this->y - p.y, this->z - p.z);
  }

  Punto operator-(Punto *p){
    return Punto(this->x - p->x, this->y - p->y, this->z - p->z);
  }

  Punto *operator=(Punto p){
    this->x = p.x;
    this->y = p.y;
    this->z = p.z;
    return this;
  }

  Punto *operator=(Punto *p){
    this->x = p->x;
    this->y = p->y;
    this->z = p->z;
    return this;
  } 
```

我在这里使用它是这样的：

```
p = fem->elementoFrontera[i]->nodo[0] - fem->elementoFrontera[i]->nodo[1]; 
```

nodo[i] 是一个 Punto*，它编译得很好，但是当我尝试这样做时：

```
p = fem->elementoFrontera[i]->nodo[0] + fem->elementoFrontera[i]->nodo[1]; 
```

编译器说：

> 在成员函数`void mdTOT::pintarElementosFrontera()': error: invalid operands of types` Punto*' 和`Punto*' to binary` operator+'

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T03:32:37.327

第一个编译得很好，因为您可以在 C/C++ 中减去指针，但不能添加指针。但在任何情况下，它都不能满足您的需求——它不使用您的重载运算符。由于您的运算符是在一个类中定义的，因此您需要对类实例进行操作，而不是对指针进行操作。所以，换成类似的东西

```
Punto p = *(fem->elementoFrontera[i]->nodo[0]) + *(fem->elementoFrontera[i]->nodo[1]); 
```

另一件事 - 您应该在运算符定义中使用类引用，而不是值。例如

```
 Punto& operator+(const Punto& p) { 
```

编辑。为了简化代码，您可以创建一个访问器函数，如下所示：

```
const Punto& NodoRef(int i, int j) {
  return *(fem->elementoFronteria[i]->Nodo[j]);
} 
```

然后你的代码变得像

```
p = NodoRef(i,0) + NodoRef(i,1); 
```

NodoRef 可以在您的 fem 类中或外部定义。只需确保对象 fem 在您使用 NodoRef 的范围内是活动的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T03:38:23.837

第一个版本之所以有效，是因为 " `-`" 在这种情况下执行正常的指针运算，它不使用任何重载运算符。" `+`" 没有在普通指针上定义，所以你会得到一个错误。要使其使用重载版本，请取消引用第一个指针：

```
p = *fem->elementoFrontera[i]->nodo[0] - fem->elementoFrontera[i]->nodo[1]; 
```

取消引用两个指针也应该起作用，因为您有两种类型的重载，但是在这种情况下，您应该更改运算符定义以使用 const 引用：

```
Punto operator+(const Punto &p){
   ...
} 
```

这样，每次使用“ `+`”时都不会复制对象。

基本上你想做这样的事情：

```
const Punto operator+(Punto *left, Punto *right); // not allowed 
```

但是重载一个`operator+`接受两个指针并以适当方式添加它们的自由函数是行不通的，因为至少有一个参数需要是[enum 或 class 类型](http://www.parashift.com/c++-faq-lite/intrinsic-types.html#faq-26.10)。基本类型没有运算符重载，指针也一样。

# java - 为什么在托管模式下运行 GWT App Engine 应用程序时会出现 ClassNotPersistableException？

> ID：1004968
> 
> 赞同：13
> 
> 时间：2009-06-17T03:28:58.910
> 
> 标签：java, google-app-engine, gwt

当我尝试对我的 GWT/App Engine 应用程序的本地 JDO 数据存储执行查询时，我随机得到一个 org.datanucleus.exceptions.ClassNotPersistableException。这只发生在我在托管模式下运行应用程序时。当我将它部署到 Google App Engine 时，一切正常。

堆栈跟踪：

```
org.datanucleus.exceptions.ClassNotPersistableException: The class "com.wayd.server.beans.WinePost" is not persistable. This means that it either hasnt been enhanced, or that the enhanced version of the file is not in the CLASSPATH (or is hidden by an unenhanced version), or the Meta-Data/annotations for the class are not found.
    at org.datanucleus.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:305)
    at org.datanucleus.ObjectManagerImpl.getExtent(ObjectManagerImpl.java:3700)
    at org.datanucleus.jdo.JDOPersistenceManager.getExtent(JDOPersistenceManager.java:1515)
    at com.wayd.server.WinePostServiceImpl.getPosts(WinePostServiceImpl.java:212)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:585)
    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:527)
    ... 25 more
Caused by: org.datanucleus.exceptions.ClassNotPersistableException: The class "com.wayd.server.beans.WinePost" is not persistable. This means that it either hasnt been enhanced, or that the enhanced version of the file is not in the CLASSPATH (or is hidden by an unenhanced version), or the Meta-Data/annotations for the class are not found.
    at org.datanucleus.ObjectManagerImpl.assertClassPersistable(ObjectManagerImpl.java:3830)
    at org.datanucleus.ObjectManagerImpl.getExtent(ObjectManagerImpl.java:3693)
    ... 32 more) 
```

WinePost 类是一个非常简单的 JDO 持久化类：

@PersistenceCapable(identityType = IdentityType.APPLICATION) 公共类 WinePost {

```
@PrimaryKey
@Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
private Long id;

@Persistent
private User author;

@Persistent
private String grape;

@Persistent
private String comment;

public WinePost(final User author, final String grape,
        final String comment) {
    super();
    this.grape = grape;
    this.comment = comment;
}

public User getAuthor() {
    return author;
}

public void setAuthor(final User author) {
    this.author = author;
}

public Long getId() {
    return id;
}

public void setId(final Long id) {
    this.id = id;
}

public String getGrape() {
    return grape;
}

public void setGrape(final String grape) {
    this.grape = grape;
}

public String getComment() {
    return comment;
}

public void setComment(final String comment) {
    this.comment = comment;
}

public String getUserNickname() {
    String retVal = null;
    if (author != null) {
        retVal = author.getNickname();
    }
    return retVal;
}

public WinePostModel getWinePostModel() {
    final WinePostModel winePostModel = new WinePostModel(grape, vintage, getUserNickName());
    return winePostModel;
} 
```

}

数据存储查询通过以下方法执行：

```
public ArrayList<WinePostModel> getPosts() {
        final ArrayList<WinePostModel> posts = new ArrayList<WinePostModel>();
        final PersistenceManager persistenceManager = PMF.get()
        .getPersistenceManager();

        final Extent<WinePost> winePostExtent = persistenceManager.getExtent(
                WinePost.class, false);
        for (final WinePost winePost : winePostExtent) {
            posts.add(winePost.getWinePostModel());
        }
        winePostExtent.closeAll();

        return posts;
    } 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-09-17T14:11:08.223

我很确定您的代码没有任何问题。您收到此错误的原因是 Datanucleus 增强器存在问题。

如果您看到此错误，请退出 Jetty 并检查 Eclipse 中的控制台（您需要在控制台窗口上方的小工具栏中选择正确的控制台）。它应该这样说：

DataNucleus Enhancer（1.1.4 版）：类的增强 DataNucleus Enhancer 已成功完成**X**类。计时：输入=547 毫秒，增强=76 毫秒，总计=623 毫秒。查阅日志以获取完整的详细信息

...其中**X**是它已处理的类数。该数字应等于您定义的“实体”分类的数量。

但有时，由于某种原因，它会显示 0，这就是您收到 ClassNotPersistableException 错误的原因。

要修复，请打开一个实体类并更改某些内容（添加空格或其他内容）并保存。检查控制台，直到它说它已经增强了您的所有实体类。然后重新启动调试器并重试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-03-28T04:15:01.273

尽管这是一个旧线程，但发布以供遇到相同问题的任何人将来参考。

我遇到了“相同”的问题，发现我的类路径有多个 datanucleus-appengine-1.0.7.final.jar 实例。我从尝试构建工作区时提示的日志中了解到这一点。这是日志内容。

确保类路径中没有同一个插件的多个 JAR 版本。网址“file:/G:/eclipse/plugins/com.google.appengine.eclipse.sdkbundle.1.3.4_1.3.4.v201005212032/appengine-java-sdk-1.3.4/lib/user/orm/datanucleus-appengine -1.0.7.final.jar" 已经注册，并且您正在尝试注册位于 URL "file:/G:/WS_Quotemandu/quotemandu/war/WEB-INF/lib/datanucleus-appengine-1.0\. 7.final.jar。” 在 org.datanucleus.plugin.NonManagedPluginRegistry.registerBundle(NonManagedPluginRegistry.java:434) 在 org.datanucleus.plugin.NonManagedPluginRegistry.registerBundle(NonManagedPluginRegistry.java:340) 在 org.datanucleus.plugin.NonManagedPluginRegistry.registerExtensions(NonManagedPluginRegistry.java:222) ) 在 org.datanucleus.plugin.NonManagedPluginRegistry。

G:/eclipse/plugins/com.google.appengine.eclipse.sdkbundle.1.3.4_1.3.4.v201005212032/appengine-java-sdk-1.3.4/lib/user/orm/datanucleus-appengine-1.0.7.final 。罐

文件：/G:/WS_Quotemandu/quotemandu/war/WEB-INF/lib/datanucleus-appengine-1.0.7.final.jar

希望这可以帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T19:42:41.260

我以前见过非常相似的东西，它与同时被不同方法调用的persistantManager 有关。发生这种情况是因为 pm 应该是**单个实例**（它不是**单例**，因此您必须自己管理它）。

一旦部署，条件可能会在开发环境和生产环境之间发生变化，因此这也可以解释您所看到的情况。

`synchronized`通过在使用 pm 的方法声明中使用解决了该问题。

也许这不是你的情况，但你可能想试一试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-08T19:35:09.370

我有同样的问题，由于安装了 2 个版本。

首先我安装了**Google App Engine Sdk 1.8.8**，然后更新进来，eclipse 下载了**Google App Engine Sdk 1.8.9**。

拥有 2 个版本会导致引发此错误。尽管一切都编译得很好，但我没有意识到 datanucleus 增强器控制台日志在编译时警告我这个错误，只是发现控制台存在 ;-)

就我而言，解决方案是只保留较新的版本删除旧版本：

*   右键单击项目-> 属性
*   深入了解 Google/App Engine
*   在右侧，您将看到一个名为**Configure SDKs的按钮链接**
*   将打开一个新窗口，显示已安装的所有 SDK 版本
*   选择不需要的版本并单击**删除**按钮

![在此处输入图像描述](../Images/b169530158aded3c414005a3eb4bc2af.png)

为确保旧版本 (1.8.8) 已完全删除：

*   打开文件资源管理`C:\Users\XXX\.eclipse\org.eclipse.platform_4.3.0_1709980481_win32_win32_x86_64\plugins`器，其中 XXX 是您的 Windows 用户。
*   如果文件夹`com.google.appengine.eclipse.sdkbundle_1.8.8`存在，请删除它！

现在，如果您打开 datanucleus 增强器控制台，该类将显示成功增强。

![datanucleus 增强器控制台日志](../Images/9249fc2b937c65ac0d1895b17c0cff50.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-06T11:14:15.647

检查您的编译器版本。它应该是 1.7 或更低。它不应该是 1.8。我也得到了同样的东西，我改变了编译器，然后它对我有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-10T09:53:32.143

我遇到过同样的问题。在我的情况下，代码在构建过程中通过 maven clean + install 正确处理，请参见下面的日志摘录：

增强（持久）：nl.jdoexample.model.Product 增强（持久）：nl.jdoexample.model.Book

出了问题的是，在执行之前（在 Intellij 中）执行时（请参阅此运行/调试配置）命令“make”被执行，从而删除了增强的 java 文件。这导致错误弹出。

在 Intellij 中修复问题（但也可以在 Eclipse 或 Netbeans 中完成）： - jdo-example - 生命周期： - 编辑配置（运行/调试配置）： - jdo-example [install] 命令行：全新安装

*   运行/调试配置：-应用程序：-删除'make'-新的执行定义：-名称：执行 main jdoExample-配置：-主类：nl.jdoexample.main

这样应用程序将不会在执行前再次编译，从而删除增强的 java 文件。这在我的情况下是成功的。希望这可以帮助。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-06-17T04:04:55.727

“类“com.wayd.server.beans.WinePost”是不可持久的。这意味着它要么没有被增强，要么文件的增强版本不在 CLASSPATH 中（或者被未增强的版本隐藏），或找不到该类的元数据/注释。”

那么为什么不检查这三个条件中的每一个呢？其中之一是真实的。

# css - 使用“-ms-filter”属性时如何保持 PNG alpha 透明度

> ID：1004973
> 
> 赞同：5
> 
> 时间：2009-06-17T03:32:05.083
> 
> 标签：css, internet-explorer-8, internet-explorer-7, png, opacity

我有以下 HTML：

```
<a><img src="myfile.png" /> Some text</a> 
```

这个CSS：

```
a:hover
{
    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=75)";
    filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=75);
    opacity: .75;
} 
```

这个问题在 IE 8 和 IE 7 中都会出现。

当 PNG 图像受到*-ms-filter*或*filter*的影响时，它的 alpha 透明度就被破坏了。试试看，你会看到。这是 IE 8 和 IE 7 中的一个错误。

我可以删除 CSS 中应用的“-ms-opacity”和“filter”属性吗？这个的语法是什么？（例如*-ms-filter: ""; 之*类的东西）

有谁知道解决这个问题的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T04:10:04.807

只是修饰 SpliFF 的答案，我可以通过将以下 jQuery 添加到我的页面来解决这个问题：

```
$(function() {
    if (jQuery.browser.msie)
        $('img[src$=".png"]').each(function() { // must have quotes around .png
            this.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+this.src+",sizingMethod='scale')";
        });
}); 
```

这将应用 AlphaImageLoader 页面中的所有 PNG。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T03:43:23.173

更新：直接应用于 img 的[AlphaImageLoader过滤器可能会覆盖 Alpha 过滤器。](http://msdn.microsoft.com/en-us/library/ms532969.aspx)至于删除过滤器你试过`filter:none;`吗？

是的，使用条件注释以编程方式定位 IE6 及以下版本。

```
<!--[if lt IE 7]>
<style>a:hover{filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=75);}</style>
<![endif]--> 
```

[像IE7-js](http://code.google.com/p/ie7-js/)这样的脚本也会为你处理 PNG 的透明度，而不会用非标准代码弄乱你的 CSS。

```
<!--[if lt IE 7]>
<script src="http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js" type="text/javascript"></script>
<![endif]--> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-08T18:08:07.177

对于寻找另一个答案的人，我使用以下代码解决了这个问题，我自己用纯 JavaScript 编写，所以它是独立于框架的。您仍然必须将它放在框架的 DOM 就绪事件中（或者您可以像我一样使用 domready.js）。它使用 AlphaImageLoader 加载所有带有 .PNG 扩展名的图像。它必须在您应用 Alpha 过滤器之前完成（您也可以在此代码之后使用 JS 应用过滤器）。

下面的代码：

```
var i;
for (i in document.images) {
    if (document.images[i].src) {
        var imgSrc = document.images[i].src;
        if (imgSrc.toLowerCase().substr(imgSrc.length-4) === '.png') {
            document.images[i].style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true',sizingMethod='crop',src='" + imgSrc + "')";
        }
    }
} 
```

记得把它放在 IE 的条件注释中：

```
<!--[if IE]><![endif]--> 
```

请让我知道它是否工作正常。亲切的问候！

# c# - 使用 SQL 视图还是 SQL 查询？

> ID：1004974
> 
> 赞同：9
> 
> 时间：2009-06-17T03:32:18.373
> 
> 标签：c#, sql-server

我正在开发一个从 MS-SQL 服务器 (2005) 获取数据的应用程序。在命令文本中，我可以像这样传递一个 sql 查询：

```
string query = "SELECT T1.f1, T1.f2, T2.f3 FROM table1 T1 join table2 T2" +
   "on T1.id = T2.id AND T1.dt = T2.dt ..."
....
cmd.CommandText = query; 
```

我还可以将查询作为视图放在我的 SQL 服务器上，如下所示：

```
 CREATE VIEW V1 AS
   "SELECT T1.f1, ..." 
```

然后我可以在这样的简化查询中使用视图：

```
 string query = "SELECT f1, f2, f3 FROM V1";
 ....
 cmd.CommandText = query; 
```

我不确定哪种方式更好。视图会比 SQL 查询更快吗？顺便说一句，我在这里展示的查询是一个简化的查询。实际的查询 SELECT 更为复杂。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-17T03:38:53.633

我会创建一个 VIEW 有几个原因

A) 结构良好的视图确实比查询执行得更快，尽管通过查询优化您可能不会注意到太大的差异。

B）它在数据库本身中保留数据库结构的知识 - 添加一个很好的抽象层（作为旁注，考虑使用存储过程而不是内联查询 - 这也将数据库知识保留在数据库本身中）

C) 如果您确实需要对数据库进行结构更改，您可以保持视图一致，而无需重新构建代码。

**修正**我将根据一些评论修改这个答案，以澄清一些观点......

绝对正确的是，标准视图不会为查询提供任何真正的性能提升。标准视图在运行时被具体化，这本质上使其与执行相同结构的查询的便捷方式没有什么不同。但是，索引视图会立即具体化，并且结果会保存在物理存储中。与任何设计决策一样，应仔细考虑索引视图的使用。天下没有免费的午餐; 当底层数据库发生任何变化时，您为使用索引视图付出的代价是额外的存储需求和与维护视图相关的开销。这些最适合用于来自多个表的数据的常用复杂连接和聚合实例，以及数据访问频率远高于更改频率的情况。

我也同意关于结构变化的评论——添加新列不会影响视图。然而，如果数据被移动、规范化、归档等，它可能是一个很好的方法来隔离这些更改与应用程序。这些情况很少见，并且可以通过使用存储过程而不是视图来获得相同的结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T03:40:48.200

一般来说，我发现最好使用视图有几个原因：

*   复杂的查询在代码中可能难以阅读
*   您可以更改视图而无需重新编译
*   与此相关的是，只要返回相同的字段，您就可以在视图中处理底层数据库结构的更改而无需触及代码

可能还有更多原因，但在这一点上，我永远不会直接在代码中编写查询。

您还应该研究某种 ORM（对象关系映射器）技术，例如 LINQ to SQL (L2S)。它允许您在代码中使用类似 SQL 的查询，但所有内容都通过 L2S 设计器中创建的对象进行抽象。

（实际上，我实际上是在移动我们当前的 L2S 对象以脱离视图。它有点复杂，因为关系也没有通过......但它允许我创建一组跨越 2数据库，并保持一切都很好地抽象，以便我可以更改基础表名以修复命名约定。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T03:36:17.540

或者您可以使用存储过程。使用存储过程将允许 SQL 缓存执行计划。我认为观点也是如此。您的第一种方法（即席查询）可能效率最低。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T03:37:36.663

没有性能差异（除非 sql 查询的文本真的很大并且在网络上产生成本）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T03:36:37.197

视图*可能*更快，因为您请求的命令字符串更短，但差异将是无关紧要的。

视图的真正区别和价值在于，就像函数和子程序一样，它们是*可重用*的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T03:36:20.877

景色可能会更好。

这样，您可以在以后修改查询（用于优化），而无需更改代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T03:55:53.897

对我而言，视图的优势在于您可以对它们应用安全上下文。或者在极端情况下，出于性能原因，您可以使用分布式分区视图。否则，它们会使版本控制复杂化。您现在必须确保部署了正确版本的视图以及数据访问 dll 的新版本。

我曾经争辩说存储过程是要走的路，因为它们是 a）编译（更快）和 b）安全边界。在现实世界中，这通常是过早的优化。从客户端发送的 SQL 命令文本通常足够高效（并且更易于版本和部署），并且在许多情况下，表级别甚至整个数据库的访问控制就足够了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-17T04:22:59.803

视图不是性能特征。它们的存在是为了减少连接的数量，并允许您在不实际进行非规范化的情况下进行非规范化。

换句话说，请使用使您的代码最简单的方法，并且不要出于性能原因进行更改，除非您有*充分的*理由这样做。这些类型的优化通常是不值得的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-09T21:20:07.360

除非您符合第二段中的个人资料，否则我建议您远离视图。作为抽象出底层功能的好方法，它们具有欺骗性的吸引力。但问题是，一旦开发人员开始创建视图，他们往往会开始为表和字段的每种可能组合创建不同的视图，最终导致不协调的爆炸性混乱。然后 DBA 必须维护所有这些，因为没有办法知道哪些是实际使用的，哪些不是，并且开发人员最终只是编写自己的连接，因为这比涉水并找出哪个现有视图更容易采用。

IMO，使用视图的唯一充分理由（也是相当常见的一个）是如果 DBA 需要在不破坏现有客户端代码的情况下自由修改基础表。这显然只有在该逻辑位于视图或过程中的数据库端时才有可能。如果这适用于您，请继续使用视图。否则，我会推荐一种不同的看待事物的方式。

视图的力量在于它创建的抽象。但事实是，抽象仅由客户端使用，而不是由数据库本身使用。因此，我发现最好将该抽象放在客户端。因此，只需在客户端代码中的某处定义一个宏或字符串生成器，而不是视图，它们将为您创建您的 select 语句。您可以一开始让这些变得简单，随着您的应用程序的进展逐渐变得更加复杂。这样您就可以保持视图提供的抽象性和可重用性，但避免视图爆炸和开发人员-DBA 通信瓶颈。

# java - 接口应该放在单独的包中吗？

> ID：1004980
> 
> 赞同：87
> 
> 时间：2009-06-17T03:35:59.163
> 
> 标签：java, interface, packages

我是一个从事相当大项目的团队的新手，有很多组件和依赖项。对于每个组件，都有一个`interfaces`用于放置该组件的公开接口的包。这是一个好习惯吗？

我通常的做法是接口和实现放在同一个包中。

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-06-17T03:44:37.100

放置接口和实现是常见的地方，似乎不是问题。

以 Java API 为例——大多数类的接口和它们的实现都包含在同一个包中。

以[`java.util`](http://java.sun.com/javase/6/docs/api/java/util/package-summary.html)包装为例：

它包含诸如`Set`, `Map`,之类的接口`List`，同时也具有诸如`HashSet`,`HashMap`和之类的实现`ArrayList`。

此外，Javadocs 被设计为在这些条件下运行良好，因为它在显示包的内容时将文档分为*接口*和*类*视图。

只为接口提供包实际上可能有点过分，除非有大量的接口。但是仅仅为了这样做而将接口分离到它们自己的包中听起来是不好的做法。

如果需要将接口的名称与实现区分开来，可以使用命名约定来使接口更易于识别：

*   *在接口名称前加上`I`.* 这种方法适用于 .NET 框架中的接口。很容易看出这`IList`是一个列表的接口。

*   *使用 -`able`后缀。*这种方法经常出现在 Java API 中，例如`Comparable`, `Iterable`,`Serializable`等等。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-17T03:39:37.080

对于任何语言，将它们放在同一个包中都可以。重要的是暴露给外界的东西，以及它从外面看的样子。没有人会知道或关心实现是否在同一个包中。

让我们看看这个特殊的例子。

如果您将所有公共内容放在一个包中，而将私有内容放在另一个未公开的包中，则库的客户端会看到一个包。如果您将私有事物与公开暴露的事物一起移动到包中，但不从包中公开它们，客户端会看到完全相同的事物。

因此，这有一种没有充分理由的规则的味道：它是根据公开可见的事物做出决定，而该决定对公开可见的事物没有任何影响。

也就是说，如果在任何特定情况下，将接口和实现拆分到单独的包中似乎是个好主意，那就继续做吧。我想到的这样做的原因是软件包很大，或者您可能想要链接的替代实现而不是标准实现。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-17T05:15:04.460

在许多框架中，例如 OSGi，您几乎必须这样做。我认为这促进了更松散的耦合，在包而不是 jar 级别。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-12-19T19:29:10.650

《**[实用软件工程：案例研究方法](https://rads.stackoverflow.com/amzn/click/com/0321204654)**》一书提倡将接口放在单独的项目/包中。

书中谈到的PCMEF+架构有以下几个原则：

1.  向下依赖原则 (DDP)
2.  向上通知原则 (UNP)
3.  邻居通信原则 (NCP)
4.  显式关联原则 (EAP)
5.  循环消除原则（CEP）
6.  类命名原则 (CNP)
7.  熟人包原则（APP）

原则 #3 和 #7 的描述解释了为什么这是一个好主意：

> 邻居通信原则要求一个包只能与它的邻居包直接通信。该原则确保系统不会分解为不可压缩的相互通信对象网络。为了强制执行这一原则，非相邻对象之间的消息传递使用委托（第 9.1.5.1 节）。在更复杂的场景中，熟人包（第 9.1.8.2 节）可用于对接口进行分组，以协助参与远程包的协作。
> 
> 熟人包原则是邻居通信原则的结果。熟人包由对象在方法调用的参数中传递的接口组成，而不是具体对象。这些接口可以在任何 PCMEF 包中实现。这有效地允许非相邻包之间的通信，同时将依赖管理集中到单个熟人包。第 9.1.8.2 节解释了熟人包的必要性，接下来在 PCMEF 上下文中再次讨论。

请参阅此链接：[http ://comp.mq.edu.au/books/pse/about_book/Ch9.pdf](http://comp.mq.edu.au/books/pse/about_book/Ch9.pdf)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-17T03:44:27.600

将接口放在不同包中的一个论点是，创建可以分发给您的产品或服务的消费者的“api”jar 更容易。完全可以将接口和实现一起使用，但如果它们位于不同的包中，则编写脚本会更简单。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-17T03:38:20.297

是的，这是一个非常好的做法，因为它允许您在不发布特定实现的情况下发布接口。也就是说，如果您不需要发布外部接口，那么将接口定义与实现放在同一个包中是没有问题的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-17T03:41:30.117

我们在我工作的地方这样做（即：将接口放在一个包中，将实现放在另一个包中），我们从中获得的主要优势是我们可以轻松地在实现之间进行交换。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-17T03:43:14.093

我没有太多 Java 经验，但我喜欢在 C#/.NET 中将其作为一种良好实践，因为它允许将来扩展，其中具有实现接口的具体类的程序集可能不会一直分布到客户端，因为它们由中间人工厂代理或在 Web 服务场景中通过网络进行代理。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-05-22T08:26:25.307

我通常将接口与实现放在一起，但是我可以理解为什么您可能希望将它们分开。比如说，有人想根据你的接口重新实现类，他们需要一个 jar/lib/etc 来实现你的实现，而不仅仅是接口。将它们分开时，您只需说“这是我对该接口的实现”并完成它。就像我说的，不是我做什么，但我可以理解为什么有些人可能想要。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-10-09T14:15:50.600

我正在一个项目上这样做，由于以下原因，它对我来说效果很好：

*   单独打包的接口和实现用于与各种类型的 Map 或 Set 不同的用例。没有理由只为树创建一个包（java.util.tree.Map、java.util.tree.Set）。它只是一个标准的数据结构，所以将它与其他数据结构放在一起。但是，如果您正在处理一个具有非常简单的调试界面和漂亮的生产界面的益智游戏，作为其前端的一部分，您可能有一个 com.your.app.skin.debug 和一个 com.your.app .皮肤.漂亮。我不会将它们放在同一个包中，因为它们会做不同的事情，而且我知道如果它们在同一个包中，我会使用一些 SmurfNamingConvention（DebugAttackSurface、DebugDefenceSurface、PrettyAttackSurface 等）为两者创建一些非正式的命名空间。

*   对于查找位于单独包中的相关接口和实现的问题，我的解决方法是为我的包采用命名配置。例如，我可以在 com.your.app.skin.framework 中拥有我的所有接口，并且知道包树同一级别上的其他包是实现。缺点是这是一个非常规的约定。老实说，我会在 6 个月内看到这个大会有多好 :)

*   我不虔诚地使用这种技术。有些接口仅在特定实现中才有意义。我不会将它们粘贴在框架包中。有些包看起来不像我要创建 40 个不同的实现类，所以我不打扰。

*   我的应用程序使用 guice 并且有很多接口。

程序设计的问题通常涉及利弊，没有一刀切的答案。比如为什么你会在一个只有 200 行的小程序中使用这种技术？考虑到我的其他架构选择，对于我的具体问题，这对我来说很有意义。:)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-17T06:08:25.110

我更喜欢它们在同一个包中。专门为接口创建一个包感觉毫无意义。这对于只喜欢他们的接口前缀和后缀（例如 Java 的“I”和“Impl”）的团队来说尤其多余。

如果需要将一组接口作为公共 API 发布，将它们保存在一个完全独立的项目中并创建项目依赖项会更有意义。但这一切都归结为我认为情况的偏好和便利。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-17T04:55:17.790

将它们放在反映您的项目的包中。如果接口和实现是同一个项目的一部分，将它们放在一起很好也很常见，但是如果您正在编写 API，那么其他人可能会选择与他们的项目相关的包名称。

一般来说，如果它是针对同一个项目的，我认为将接口与它们的实现放在一个单独的包中没有任何好处。如果它变得杂乱无章，则可能存在其他包命名问题，而与接口排列无关。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-07-24T18:40:56.240

我认为重要的是要注意，对于 OSGi 框架，最好将它们放在不同的包中，这样您就可以轻松地导出整个包，同时隐藏实现包。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2013-03-20T23:03:50.400

将接口放在与实现分开的包中有很多很好的理由。例如，您可能希望使用支持[依赖注入](http://martinfowler.com/articles/injection.html)的容器在运行时连接必要的实现，在这种情况下，只需要在构建时提供接口，并且可以在运行时提供实现。或者，您可能希望在运行时提供多个实现（例如使用[模拟](http://www.vogella.com/articles/EasyMock/article.html)实现进行测试）或特定实现的多个版本（例如用于 A/B 测试等）。对于这些类型的用例，将接口和实现分开打包会更方便。

# precision - 具有无限精度的数学库是如何实现的？

> ID：1004997
> 
> 赞同：3
> 
> 时间：2009-06-17T03:38:54.397
> 
> 标签：precision, floating-accuracy

所以我知道浮点精度（以及 1.1 之类的东西如何不能用二进制精确表示）等等，但我想知道：那么，与数学相关的库如何实现无限精度？换句话说，例如，您将如何以二进制形式准确地表示 1.1？只是一个简短的描述会很棒，我可以自己弄清楚确切的细节。谢谢。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T03:47:25.707

没有无限精度库，但有任意精度库。有关如何实现这些的详细信息，请阅读一些[文档](http://gmplib.org/manual/Floating_002dpoint-Functions.html):-)

要以二进制精确表示 1.1，不能像您正确指出的那样使用浮点数。如果将整数部分 (1) 存储为整数，将小数部分 (.1) 存储为另一个整数，则可以表示它，然后您需要创建处理这些结构的逻辑。或者，它可以存储为分数 (11/10)，分母和分子都存储为整数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T07:02:58.377

如果您真的是指无限精度，则有两种选择：

*   使用某种形式的惰性计算。然后，您可以在“执行”计算之后询问一个数字，以获得尽可能多的精度（因为它是懒惰的，它实际上只是在那时才完成）。缺点是这是非常低效的。您可以在 Haskell 之类的语言中使用表示重叠的特殊数字系统来执行此操作，例如带有数字 -1、0、1 的基数 2。通常的表示是不合适的，因为在说 1 时，您需要无限精度来决定输出 0 0.999... 1 代表 1.000...

*   象征性地进行计算。准确地表示整数、有理数、根等。如果您想确定是否相等，则需要这样做，但效率也很低，并且仅限于特殊情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T03:41:54.237

没有实现具有*无限*精度的数学库。这是不可能的。除了分数之外，数字 1/3 不能用有限位数表示。像 pi 和 e 这样的超越数不能以任何方式完全表示。

另一方面，可以创建高精度的数学*库*。只需为浮点值的尾数分配足够的位即可。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T04:44:36.687

某些几何算法依赖于精确算术，因此如果您查看 CGAL 库，您会发现在各种操作下“封闭”的各种精确数字类型。也就是说，无法使用支持的操作来产生无法准确表示的结果。

一些例子：

*   整数在加法和乘法下是封闭的。

*   有理数在除法下也是封闭的，除了零的特殊情况。可以表示为一对整数。另请参见[GMP 中的有理数函数](http://gmplib.org/manual/Rational-Number-Functions.html#Rational-Number-Functions)。例如 1.1 = 11/10，可以表示为 (11, 10)。

*   一种在平方根下也是封闭的数字类型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T13:50:07.840

您还可以用十进制表示数字并进行十进制算术。底层表示是二进制的，因为每个数字都用二进制代码表示。每个数字——无论是在小数点的左边还是右边——都被视为一个整数。然后“手动”逐位进行算术运算。

基于十进制的库的一个示例是 PHP 中的 BCMath。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-17T03:48:59.607

虽然当我们谈论浮点数和数字时，Pax 完全正确，但我相信有一个解决方案，但它的效率非常低。
您可以使用字符串来表示您的号码，字符串不会丢失精度。
每当您有一个像“0.0001”+“0.1”这样的数字时，您都会迭代两个字符串并将当前位置仅转换为int。
第 1 步：
0 + 0 = 0 -> 转换为字符串并分配给 data[0]。
第 2 步：
0 + 1 = 1 -> 转换为字符串并分配给 data[1]。
第 3 步：
iter > "0.1".lenght() -> 停止。