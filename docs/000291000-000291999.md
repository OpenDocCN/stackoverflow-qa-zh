# StackOverflow 问答 000291000-000291999

# php - 使用左右 id 的 PHP 树库

> ID：291000
> 
> 赞同：0
> 
> 时间：2008-11-14T18:48:25.850
> 
> 标签：php, mysql, tree, tree-left-right

我正在寻找一个 PHP 库，它可以从具有左右 id 的数据库（或值数组）创建树结构。对于获取值时的结果，我只是在寻找一个数组，这样我就可以创建任何类型的视图。对于添加和删除，如果库能做到这一切就好了。即使该库位于另一个库中，我也不介意，因为我可能会将其拉出并与我自己的库集成。

有人知道吗？

我正在使用 PHP 和 MySQL，所以如果它至少使用 PHP 会很有帮助。如果它是一个不同的数据库，我可能可以转换它，尽管如果它不使用太多特定于语言的功能，它可能与 PHP 相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T22:02:43.943

我正在进行一个项目，该项目使用树结构进行导航以及选择（更新内容）。我必须承认（自学成才）我对左右价值观方法并不熟悉，因此选择了我刚刚通过一篇[非常有用的文章发现的内容，该文章](http://www.sitepoint.com/print/hierarchical-data-database/)名为*The Adjacency List Model*。

考虑过，现在有点熟悉了，我仍然认为我会这样做。使用*TALM*，编码 PHP 视图和更新很容易，因为您主要关心节点的父关系。

然后为了显示你有[jQuery Treeview](http://plugins.jquery.com/project/treeview)，我不能高度推荐它，对于选择有[jquery-checktree](http://code.google.com/p/jquery-checktree/)我仍在合并过程中，所以不能保证，但看起来不错。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T20:01:32.317

[ezComponents Tree](http://ezcomponents.org/docs/tutorials/Tree#database-based-back-ends)库有不同的后端（插件），您可以在它们之间进行选择。文档也很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T18:57:15.783

这种方法称为“嵌套集”

[寻找最好的 PHP 嵌套集类（PEAR 类除外）](https://stackoverflow.com/questions/272010/searching-for-the-best-php-nested-sets-class-pear-class-excluded#272248)

基本上有一个似乎没有维护的 NSTree 库，还有一个 PEAR 库。可能还有其他人，但这只是其他帖子的摘要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-05T10:16:25.860

这是我用来在 php 中构建二叉树及其操作的代码：

```
 <?php
class Node
{
 public $data;
 public $leftChild;
 public $rightChild;

 public function __construct($data)
  {
   $this->data=$data;
   $this->leftChild=null;
   $this->rightChild=null;
  }
 public function disp_data()
  {
   echo $this->data;
  }

}//end class Node
class BinaryTree
{
 public $root;
 //public $s;
 public function __construct()
  {
   $this->root=null;
   //$this->s=file_get_contents('store');

  }
//function to display the tree
  public function display()
  {
   $this->display_tree($this->root);

  }
  public function display_tree($local_root)
  {

   if($local_root==null) 
     return;
    $this->display_tree($local_root->leftChild);
    echo $local_root->data."<br/>";
    $this->display_tree($local_root->rightChild);

  } 
// function to insert a new node
  public function insert($key)
   {
    $newnode=new Node($key);
      if($this->root==null)
        {
         $this->root=$newnode;
         return;
        }
      else
        {
         $parent=$this->root;
         $current=$this->root;
           while(true)
             {
               $parent=$current;
                 //$this->find_order($key,$current->data);
                if($key==($this->find_order($key,$current->data)))
                  {
                      $current=$current->leftChild;
                       if($current==null)
                         {
                          $parent->leftChild=$newnode;
                          return;
                         }//end if2
                  }//end if1 
                else
                  {
                      $current=$current->rightChild;
                       if($current==null)
                         {
                          $parent->rightChild=$newnode;
                          return;  
                         } //end if1                       
                  } //end else
             }//end while loop 
        }//end else

   } //end insert function

//function to search a particular Node
 public function find($key)
  {
    $current=$this->root;
     while($current->data!=$key)
          {
            if($key==$this->find_order($key,$current->data))
              {
                $current=$current->leftChild;
              }
            else
              {
                $current=$current->rightChild;
              }
            if($current==null)
              return(null);

          }
         return($current->data); 
  }// end the function to search
 public function delete1($key)
  {
    $current=$this->root;
    $parent=$this->root;

    $isLeftChild=true;
     while($current->data!=$key)
          {
           $parent=$current;
           if($key==($this->find_order($key,$current->data)))
             {
              $current=$current->leftChild;
              $isLeftChild=true;
             }   
           else
             {
              $current=$current->rightChild;
              $isLeftChild=false;   
             } 
            if($current==null)
              return(null);
          }//end while loop 

      echo "<br/><br/>Node to delete:".$current->data;
     //to delete a leaf node 
     if($current->leftChild==null&&$current->rightChild==null)
       {
           if($current==$this->root)
              $this->root=null;  
          else if($isLeftChild==true)
           {
            $parent->leftChild=null;
           }  
         else
           {
            $parent->rightChild=null;
           }
         return($current);       
       }//end if1
     //to delete a node having a leftChild 
   else if($current->rightChild==null)
       {
          if($current==$this->root)
           $this->root=$current->leftChild;
          else if($isLeftChild==true)
           {
            $parent->leftChild=$current->leftChild;
           }
          else
           {
            $parent->rightChild=$current->leftChild;
           }   
          return($current);
       }//end else if1
    //to delete a node having a rightChild
   else if($current->leftChild==null)
       {
         if($current==$this->root)
           $this->root=$current->rightChild;
         else if($isLeftChild==true)
           {
            $parent->leftChild=$current->rightChild;
           }  
         else
           {
            $parent->rightChild=$current->rightChild; 
           }  
           return($current);
       }  
   //to delete a node having both childs
    else
       {
        $successor=$this->get_successor($current);
        if($current==$this->root)
          {
            $this->root=$successor; 

          }
        else if($isLeftChild==true)
          {
           $parent->leftChild=$successor;
          }
        else
          {
           $parent->rightChild=$successor;
          }     
         $successor->leftChild=$current->leftChild;
        return($current);
       }   

  }//end the function to delete a node
//Function to find the successor node
 public function get_successor($delNode)
  {
   $succParent=$delNode;
   $successor=$delNode;
   $temp=$delNode->rightChild;
    while($temp!=null)
         {
          $succParent=$successor;
          $successor=$temp;
          $temp=$temp->leftChild;
         }
   if($successor!=$delNode->rightChild)
     {
      $succParent->leftChild=$successor->rightChild;
      $successor->rightChild=$delNode->rightChild;
     }
  return($successor);
  }
//function to find the order of two strings
 public function find_order($str1,$str2)
  {
     $str1=strtolower($str1);
     $str2=strtolower($str2);
     $i=0;
     $j=0;

     $p1=$str1[i];
     $p2=$str2[j]; 
  while(true)
   {  
       if(ord($p1)<ord($p2)||($p1==''&&$p2==''))
         {

           return($str1);
         }
      else
         {
           if(ord($p1)==ord($p2))
             {
              $p1=$str1[++$i];
              $p2=$str2[++$j];
              continue;
             }
          return($str2); 
         }
   }//end while

  } //end function find string order

 public function is_empty()
  {
    if($this->root==null)
      return(true);
    else
      return(false);
  }
}//end class BinaryTree
?> 
```

# java - 2 个 JUnit 断言类之间的差异

> ID：291003
> 
> 赞同：262
> 
> 时间：2008-11-14T18:49:28.453
> 
> 标签：java, unit-testing, junit, junit4, assert

JUnit 框架包含 2 个`Assert`类（显然在不同的包中），每个类的方法看起来都非常相似。谁能解释这是为什么？

我指的类是：[`junit.framework.Assert`](http://junit.org/junit/javadoc/4.5/junit/framework/Assert.html)和[`org.junit.Assert`](http://junit.org/junit/javadoc/4.5/org/junit/Assert.html)。

* * *

## 回答 #1

> 赞同：244
> 
> 时间：2008-11-14T19:04:31.107

（JUnit 3 的）旧方法是通过扩展来标记测试类`junit.framework.TestCase`。它继承了`junit.framework.Assert`自己，并且您的测试类获得了以这种方式调用断言方法的能力。

从 JUnit 版本 4 开始，该框架`Annotations`用于标记测试。所以你不再需要扩展`TestCase`. 但这意味着，断言方法不可用。但是您可以对新`Assert`类进行静态导入。这就是为什么新类中的所有断言方法都是静态方法的原因。所以你可以这样导入它：

```
import static org.junit.Assert.*; 
```

在此静态导入之后，您可以使用此方法而无需前缀。

在重新设计时，他们还迁移到了新的包`org.junit`，该包更好地遵循了包命名的正常约定。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2008-11-14T19:19:07.800

JUnit 3.X：`junit.framework.Assert`

JUnit 4.X：`org.junit.Assert`

首选最新版本，尤其是在运行带有注释支持的 JDK5 及更高版本时。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-07-31T08:56:47.997

实际上有一个功能上的改变：`org.junit.Assert`如果你使用`assertEquals()`带有`float`or的两个参数会抱怨`double`，而`junit.framework.Assert`会默默地自动装箱。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-14T19:00:35.857

我相信他们正在从`junit.framework`to重构`org.junit`并`junit.framework.Assert`保持向后兼容性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T08:56:44.260

我做了一个粗略的源代码比较，没有严重的变化。添加了很多评论，`org.junit.Assert`并进行了一些重构。唯一的变化是与 的比较`Arrays`。有一些代码清理，但（恕我直言）**没有功能变化**。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-02-21T13:44:57.583

在 Android Studio 中（在 IntelliJ 中也是如此），您可以`junit.framework`从自动导入提案中全局排除。

`IDE`您可以在或之间设置范围`Project`。如果您没有使用 JUnit 3 的项目，您可以安全地使用 IDE 范围。

设置位置：

> 首选项 -> 编辑器 -> 常规 -> 自动导入

[![在此处输入图像描述](https://i.stack.imgur.com/MYacE.png)](https://i.stack.imgur.com/MYacE.png)

# asp.net - 通过 asp.net 应用程序连接到 Outlook？

> ID：291012
> 
> 赞同：1
> 
> 时间：2008-11-14T18:52:57.930
> 
> 标签：asp.net, outlook

我需要使用用户凭据通过 ASP.NET Web 应用程序连接到 Outlook。我有哪些选择？

仅供参考：用户使用 Windows 身份验证登录网站。我正在使用 Outlook 2003。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T14:49:35.970

是的。我想我需要连接到交换而不是使用 Outlook COM API。Robert 指出，WebDav 可能是早于 2007 年的交换服务器的方式。还有其他方法可以连接到交换服务器吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-09T07:11:19.203

这是使用 asp.net 使用新电子邮件打开 Outlook 的链接 [http://topictolearn.blogspot.com/2011/12/opening-outlook-with-new-e-mail-from.html](http://topictolearn.blogspot.com/2011/12/opening-outlook-with-new-e-mail-from.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T07:24:26.773

听起来您实际上想要连接到 Exchange。对于早于 2007 年的交换，WebDAV 是要走的路。对于 Exchange 2007，它们具有可用的 Web 服务。

[Independentsoft](http://www.independentsoft.de/webdavex/index.html)为您交换邮箱（和日历）的所有需求提供了一个好的（且便宜的）.NET 库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T19:09:32.827

我将做类似的事情，但我看不出它不起作用的原因：编写一个[Outlook 插件](http://www.outlookcode.com/)，它使用[对象远程处理](http://www.google.com/search?q=.net+object+remoting)与您正在处理的任何其他服务或工具进行通信。由于它是一个 ASP.NET 应用程序，也许您想使用 Web 服务而不是对象远程处理。

如果 ASP.NET 应用程序尚未运行，是否希望它启动 Outlook？一个 Outlook 进程将由多个用户共享，还是要连接到特定于用户的 Outlook 进程？您希望 ASP.NET 应用程序充当 Outlook 尝试连接的服务器，还是相反？

如果边缘情况很复杂，您可以尝试编写一个 Windows 服务作为两者之间的中介或网关，例如在每台 Outlook 机器上运行并按需启动 Outlook 的服务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T19:23:35.420

jtacoma：如果 ASP.NET 应用程序尚未运行，您是否希望它启动 Outlook？

> 不管怎样会更容易。如果 Outlook 没有运行并不重要，那么我们不需要启动它。

一个 Outlook 进程将由多个用户共享，还是要连接到特定于用户的 Outlook 进程？

> 需要连接到用户特定的 Outlook 进程。

您希望 ASP.NET 应用程序充当 Outlook 尝试连接的服务器，还是相反？

> 另一种方式。我希望 ASP.NET 连接到 Outlook。

另外：我目前正在查看另一个 asp.net 应用程序，他们正在使用**WebDAV request**连接到 Outlook 。我不确定这是否是一个好方法。对我来说看起来很乱。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T22:09:42.900

对我来说，这个问题没有意义。Outlook 不是服务器应用程序，它具有用户上下文。如果您要使用 WebDAV、MAPI 或 IMAP 连接到 Exchange Server，会更有意义。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-14T20:12:29.127

您的解决方案是否要求 Outlook 在 ASP.NET 服务器上运行？如果是这样，您可能需要研究许可影响。我不认为 MS 打算以这种方式自动化 Outlook。我也不认为可以运行多个 Outlook 实例，这可能会带来严重的性能瓶颈问题。如果您可以分享更多详细信息会有所帮助 - 您尝试通过 Outlook 自动执行哪些操作？是否涉及 Exchange 服务器？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-14T20:23:38.793

Outlook 实际上是通过一组 COM API 很好地公开的……但是，我很好奇您是否需要连接到 Outlook 客户端，或者直接连接到 Exchange 服务器。

您要执行的实际任务是什么？

例如，一旦你导入了 Outlook com DLL，并创建了一个互操作库，做大多数事情就相当简单了：

```
outlook.Application outlookApp = new outlook.ApplicationClass();
outlook.NameSpace olNameSpace = outlookApp.GetNamespace("MAPI");
olNameSpace.Logon (Credentials); 

outlook.ContactItem contact = (outlook.ContactItem)
     outlookApp.CreateItem(OlItemType.olContactItem);

contact.FirstName = "Joe";
contact.LastName = "Smith";

contact.Save(); 
```

该片段在 Outlook 中创建了一个新联系人。

# asp.net - 在 ASP.NET 中呈现 < 而不是 <

> ID：291015
> 
> 赞同：0
> 
> 时间：2008-11-14T18:54:56.740
> 
> 标签：asp.net, escaping

我正在写一个小页面来展示我们公司的员工。我写了一个查询来从我们的数据库中提取信息。然后我将它绑定到 GridView 以完成脏活。这是查询。

```
"SELECT tblEmpID.empid AS [Empl ID], tblEmpID.posno AS [Pos #], [name] & ""<br />""  &   [jcn] & ""("" & [jcc] & "")"" AS [Name/Job], [orgno] & "" - "" & [depname] AS Department, tblEmpID.[status] AS Status " & _
        "FROM tblEmpID " & _
        "ORDER BY [orgno] & "" - "" & [depname], tblEmpID.name " 
```

正如你所看到的，我试图
在 SQL 中包含一个，所以当它呈现时它看起来像：

```
Name
Job Description 
```

但是当它渲染它呈现为

```
&lt; and &gt; 
```

有效地在记录中显示 <br /> 而不是像我想要的那样格式化它。

那么如何让它像我想要的那样渲染呢？我已经尝试用 \ 转义 < 但这没有用。

* * *

**编辑：**谢谢 gfrizzle。你的回答让我走上了正确的道路。另外，感谢 NYSystemsAnalyst。您的回答帮助我想到了将来做事的不同方式。最终，我找到了不同的解决方案。我将此代码放在 GridView1_RowDataBound 事件中，它可以满足我的需要。

```
If e.Row.RowType = DataControlRowType.DataRow Then
        Dim cells As TableCellCollection = e.Row.Cells

        For Each cell As TableCell In cells
            cell.Text = Server.HtmlDecode(cell.Text)
        Next
    End If 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T19:26:18.690

尝试在 GridView 的列上设置 HtmlEncode="False"。这应该会阻止它对您的标记进行编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T19:25:29.130

如果您这样做是为了只读目的，您可能需要考虑使用中继器控件。然后，您可以将它们作为单独的字段返回，从而从 SQL 结果集中消除 HTML。然后，您可以使用控件中的 ItemTemplate 来指定 HTML 以及您希望结果的确切显示方式。您可以将它们放在一个表格中，并使用 BR 标签。这看起来类似于网格，但让您可以更好地控制 HTML / .aspx 端的布局。

# web-applications - 为什么 Web 应用程序比本地应用程序更受欢迎？

> ID：291019
> 
> 赞同：7
> 
> 时间：2008-11-14T18:57:04.023
> 
> 标签：web-applications, desktop-application

我问这个是因为在工作中我应该开发一个由两个人在 Intranet 中使用的 Web 应用程序。这是一个应该在工作流中保留一些状态的应用程序。所以我必须将数据保存在会话中并且必须关心并发性。开发一个普通的桌面应用程序会容易得多。但是客户对此很清楚（我希望规范中的所有内容都如此清楚）：他想要一个 Web 应用程序。

我知道很多人不想安装应用程序，但是这里有两个用户，我可以在他们的计算机上安装它。

所以我想知道：是什么原因，为什么现在 webapps 如此流行？这是一种炒作吗？两年后客户会需要更多的桌面应用程序吗？或者 webapps 有什么东西让它们特别性感/吸引人？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-14T19:01:48.693

一般来说，您的观点是错误的：Web 应用程序并不比本地应用程序更受欢迎。

在**您的特定情况下**，客户可能想要利用这些东西：

*   无缝升级
*   无需安装客户端软件即可从任何机器获得可用性
*   “没有崩溃”
*   在完成软件之前尝试的能力
*   感知成本降低。

如果您碰巧不同意他们的评估，您可以尝试说服他们您的经验表明网络应用程序不是最适合此的。

或者，也许您应该考虑探索基于延续的 Web 框架，例如[Seaside](http://www.seaside.st/)。它们通过无状态交互使状态持久化更加直接。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-14T19:01:07.307

IMO 的主要原因是

1.  它们可以在任何连接互联网的计算机上工作，而不仅仅是安装了软件的计算机。
2.  当有更新时，您只需将其推送到服务器，每个人下次登录时都会获得新版本。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-14T19:51:18.407

到目前为止，我看到的大多数帖子都试图通过说 Web 应用程序使部署变得容易、消除“操作系统战争”、升级很容易等来证明 Web 应用程序的合理性。

然而，软件的全部意义在于使最终用户能够高效工作。Web 应用程序的最大卖点是让软件专业人员的工作更轻松一些。制作一个与桌面应用程序相媲美的富 Web 应用程序是非常非常困难的。通常必须做出许多可用性妥协。

有时这些妥协是值得的，但主要目标应该始终是为最终用户提供尽可能好的体验。我见过很少有像桌面应用程序一样能做到这一点的网络应用程序。

当然，您可以说“但从任何浏览器运行的功能*正在*为用户服务”。也许吧，但我会在一周中的任何一天使用一个难以部署但易于使用的应用程序，而不是易于部署但不易于使用的应用程序，如果是的话我必须定期与之互动的东西。

我使用 turbotax 在线，因为它是一年一次的事情，而且即时更新功能很重要，但我绝对不想从基于 Web 的应用程序运行 Quicken。没办法，没办法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T19:02:00.877

那么，Web 应用程序可以更容易维护。如果您更新传统桌面客户端的数据结构，您需要确保客户端软件的版本正确。在 Web 应用程序中，这没什么大不了的。

此外，拼写错误/错误更容易修复——您只需更新一次并重新部署。传统的桌面应用程序必须自动更新，或者（如果你真的是一个施虐受虐者）手动更新。

在完成了传统的桌面客户端和 Web 应用程序之后，我会选择 Web 应用程序。

**但是**，我很惊讶这么小的应用程序需要成为一个 webapp。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-14T19:02:47.583

对我来说，比起桌面应用程序更喜欢 Web 应用程序的第一个原因是它们很容易分发。我不必安装该应用程序，担心它是否由于某些基于客户端的问题（例如个人防火墙）或与其他应用程序冲突等而无法工作。

另一个原因是我可以轻松地向应用程序推送更新。

也许你的答案很简单，任何一个都可以。如果没有更多信息，我看不出你的应用程序作为 Web 应用程序更好的一个压倒性原因。但是由于上述原因，网络应用程序非常吸引人。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-14T19:09:01.643

老实说，因为在.Net 之前的时代，Web 应用程序比基于 COM 的 winforms 应用程序具有三个主要优势，这使得它们在几乎所有情况下都更受欢迎。

```
 1\.  They required no installation or deployment on client machines
 2\.  They could not break other apps on the client machine. 
 3\.  They could be made to function on just about any computer in the world that had a browser and could connect to the application's web server. 
```

这些问题很重要，因为对于当时的 winforms 应用程序来说，它们简直就是噩梦，尤其是第 1 点和第 2 点。（“dll 地狱”）当 .Net 发布时，前两点变得毫无意义...... .Net 应用程序，只需单击一次部署，并且二进制结果和组件互操作性不依赖注册表键/GUIDS（实现二进制冲突的元数据存储在组件本身，而不是机器注册表中），这些问题变得没有实际意义。
一般来说，如今偏爱 Web 应用程序的唯一原因是 #3，您的客户群包括非 Wintel 平台。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-14T19:19:39.250

无法回答 Web 应用程序是否比本地应用程序更受欢迎。当然，某些类型的应用程序更适合 Internet。

已经提到过，Web 应用程序具有这些感知优势：

*   无需安装或实际设置
*   可以更轻松地记录数据。如果使用 Office 应用程序，它会自动将我的工作保持在线以供在任何地方使用，理论上，如果您管理这样的程序，那么您就可以访问其他人的文档。这可能对一般业务有用
*   只要用户有一个工作的浏览器，它就可以工作。不再有疯狂的错误或数据丢失，因为它们都在 Internet 上！

如果这些优势适用于您选择的应用程序，那就太好了！为网络世界发展并获得优势。当您的应用程序不适合在线世界时，问题就来了。尝试实现 Spore 的在线版本，看看你能走多远。

为简化起见，Web 应用程序优于桌面应用程序的唯一情况是所需的功能和业务需求表明在线使用优于本地使用。我的朋友在 O2 电话店工作，他们的新用户注册应用程序是一个在线应用程序。这样，所有数据都可以本地存储在商店中，并同时传输到主要办公室，以确保电话被激活。这种应用程序适用于 Web，因为它需要**安装在数百个地方**，并且**需要在本地和总部记录数据**。

根据我自己的个人经验，现在几乎没有理由使用在线应用程序。他们中很少有人比桌面同行有很大的优势，而且在*杀手级应用*出现之前，没有充分的理由改变。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-14T19:45:00.040

我不同意 Rich 的观点，根据我的经验，Web 应用程序**更**受欢迎，但这取决于您所说的受欢迎程度。

在这种情况下，我所说的受欢迎程度是指，如果我在一家随机的中小型软件公司接受一份随机的编程工作，我希望他们正在开发网络软件。当然，这条规则有很多例外，但现在十年的大部分时间里，总体趋势是向 Web 开发方向发展。

许多其他回应给出了支持 Web 开发的充分理由：

*   没有大惊小怪的安装/分发过程
*   跨平台支持相对容易

正如里奇所说，在我看来，最重要**的是“感觉成本降低了”。**与其他编程方法相比，Web 开发的进入门槛非常低。您可以从 HTML 和 CSS 开始，然后转到 JavaScript，然后再学习 PHP 和 Flash，然后称自己为 Web 开发人员。相比之下，像 C++ 和 Java 这样的环境有一个残酷的学习曲线。

以我的经验，有商业头脑的人如此着迷于 Web 开发是多么“简单”，以至于他们经常忘记还有其他选择。我曾经在一个项目中，最初要求一个 Web 项目，当开发团队说根据要求开发桌面应用程序会更便宜时，项目经理感到很惊讶。非技术人员可能会简单地认为 Web 应用程序的成本较低，因为他们不了解其中的区别。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-14T19:06:59.493

“我可以将它安装在他们的电脑上。” 当你中了彩票，然后呢？现在谁来照顾那些精心制作的桌面，拥有独特软件的桌面？

Web 应用程序的中央管理——即使是两个人——对组织来说也具有巨大的价值。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-14T19:21:03.490

一些额外的原因：

1.  因为精心设计的网络应用程序几乎可以在任何可以运行浏览器的计算机上运行。如果您运行 Web 应用程序，它有效地结束了操作系统之战——Apple 粉丝可以继续使用苹果，Msoft 粉丝和 Unix/Linux 粉丝同样如此。

使用桌面应用程序，您必须选择平台/操作系统，或者使用一些承诺（哈！）多操作系统功能的工具（然后当桌面应用程序看起来不像他们中的任何一个时处理来自各方的仇恨邮件是“习惯使用”。

2.  如前所述，升级就像将代码重新发布到服务器一样简单。没有混乱，没有大惊小怪。升级桌面应用程序可能是一场噩梦，特别是如果您使用新工具开发新版本，并且突然不得不升级所有桌面上的所有“其他东西”（dll、二进制文件等）。在最坏的情况下，您喜欢的新版本甚至可能无法在旧操作系统上运行，因为二进制库随操作系统一起提供。所以现在你也在升级操作系统（和硬件 - 哎呀！）。

3.  对于大多数应用程序，Web 界面非常完美，特别是如果您正在创建标准的“从数据库读取、写入、报告”应用程序，Web 界面就相当不错了。而且它在大多数浏览器上都相当不错（参见#1）。桌面应用程序很容易迷失在当前的“花哨的 UI 趋势”中（记住每个 Windows 应用程序都必须有多个窗口）。您不必编写的代码量可能很多。

4.  顾客永远是对的。现在需要注意的是，作为设计师/开发人员，您需要尽可能深入客户的头脑，并确定他们为什么要求某些要求。确保实际问题首先得到解决，但如果是这种情况，请遵从客户的意愿。

干杯，

-R

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-14T19:43:44.630

基于 Web 的应用程序在应用程序用户中并不受欢迎。

但应用程序用户通常不会为自己的软件付费。

软件购买者不会根据技术优势做出决定。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-14T20:09:08.340

*   自动备份数据/文件...希望如此。
*   自动升级和安装

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-14T21:02:31.180

首先，我认为网络/应用程序和客户端/服务器应用程序之间存在（小）区别。webapp是一种客户端/服务器应用程序，服务器完全不受客户控制，客户端是浏览器。客户端/服务器应用程序是客户拥有并控制服务器和客户端的应用程序。您的案例听起来更像是客户端/服务器应用程序，而不是 Web 应用程序本身。

除了每个人提到的关于为什么 webapps 更有吸引力的所有原因之外，不要忘记包括它们中的大多数都提供免费版本。不仅仅是限时或残废的版本，而是一个免费版本，您可以永远使用或直到他们停止使用（当然，以换取您的个人数据，对广告收入的关注等）。除了没有安装和升级的优势之外，这是一个巨大的激励（因为大多数免费加载者无论如何都不愿意为应用程序付费）。

但是，如果您需要保留数据的副本，并且您是铁杆“创造者”而不仅仅是消费者，那么在我看来，与服务器同步的混合桌面应用程序是一个更好的解决方案。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-14T21:11:45.560

我认为部分原因与大多数网络应用程序提供的有限的人机交互选项有关（除非你喜欢）。

例如，我曾经在一家生产医疗保健软件的公司工作，我们花了很长时间让用户理解右键单击和拖放。因此，对于程序中的每个操作，我们必须有一个右键单击菜单选项、工具栏中的图标和菜单选项，例如文件->选项->导出。

在网络应用程序中，似乎大多数时候，你有两个选择——链接或按钮（当然，我知道你*可以*做任何厚应用程序所做的一切，但我只是说大部分时间，您只会遇到按钮和链接）。

正因为如此，似乎很多用户在识别 Web 应用程序时遇到的麻烦更少。他们只是寻找标有“保存”的按钮并单击它。因此，这些用户更喜欢网络应用程序，因为他们认为它们更易于使用。

而且，由于网络应用程序的性质也意味着很多时候您会离开一个有任何类型菜单的页面（每个页面顶部通常没有“文件、编辑、帮助”菜单） ，让他们感到困惑的噪音更少。他们只是查看一个页面，该页面充满了字段和下拉菜单，并在底部看到两个小按钮，标有“保存”或“取消”。我很少看到一个被限制在那个级别的厚应用程序。

# macos - 使用 AppleScript 或其他 Mac OS 方法获取打开文件的文件名和路径

> ID：291028
> 
> 赞同：2
> 
> 时间：2008-11-14T18:59:57.993
> 
> 标签：macos, applescript

有没有办法使用 AppleScript（或其他东西）来查询当前正在运行的应用程序以获取它们打开的当前文件的文件名和路径？我知道一些应用程序会在窗口标题中显示文件名，这是可以通过脚本访问的，但这并不是一个解决方案，因为并非所有应用程序都这样做，而且几乎没有显示路径。我也知道这很复杂，因为并非每个应用程序都是基于文档的。

任何有关如何在运行的 Mac 应用程序中查找当前打开的文件/路径的建议将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T19:11:54.490

[http://developer.apple.com/documentation/Darwin/Reference/ManPages/man8/lsof.8.html](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man8/lsof.8.html)

# java - JSP : JSTL 的 标签

> ID：291031
> 
> 赞同：117
> 
> 时间：2008-11-14T19:00:29.333
> 
> 标签：java, jsp, jstl, tags

写一个JSP页面，具体是`<c:out>`做什么的？我注意到以下两者具有相同的结果：

```
<p>The person's name is <c:out value="${person.name}" /></p>
<p>The person's name is ${person.name}</p> 
```

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2008-11-14T19:05:04.957

`c:out`转义 HTML 字符，以便您可以避免跨站点脚本。

如果`person.name = <script>alert("Yo")</script>`

该脚本将在第二种情况下执行，但在使用时不会执行`c:out`

* * *

## 回答 #2

> 赞同：128
> 
> 时间：2008-11-14T19:34:25.617

正如 Will Wagner 所说，在旧版本的 jsp 中，您应该始终使用它`c:out`来输出动态文本。

此外，使用这种语法：

```
<c:out value="${person.name}">No name</c:out> 
```

当名称为空时，您可以显示文本“无名称”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-14T19:21:02.443

`c:out``person.name`如果 的值恰好为空，还具有用于分配默认值的属性。

来源：[out（TLDDoc 生成的文档）](http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/c/out.html)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-07-02T16:57:15.763

您可以通过使用属性 escapeXml 值等于 true 来显式启用 Xml 实体的转义。仅供参考，默认情况下为“true”。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-14T19:03:42.730

旧版本的 JSP 不支持第二种语法。

# scheme - 那里有人使用 Scheme 编程语言吗？

> ID：291033
> 
> 赞同：52
> 
> 时间：2008-11-14T19:01:00.440
> 
> 标签：scheme

我刚开始在我的大学学习计算机科学，他们教我们用 Scheme 编程。

自从我在过去 6 年中学习 C++ 以来，Scheme 对我来说似乎有点奇怪。我的导师告诉我，你可以用它编写任何可以用 C 或 Java 编写的程序。

真的有人在使用这种语言吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-11-14T19:15:40.630

据我所知，使用它的人并不多，但绝对值得一看（即使只是尝试用另一种范式编程，这样你就可以学会以不同的方式思考）。您很幸运能够参加使用 Scheme 的课程，因为现在大多数大学都教授 Java。如果您想观看麻省理工学院的一些讲座或研究示例问题等，这里是一个很好的链接。

[麻省理工学院开放课件 - 计算机程序的结构和解释](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-001Spring-2005/CourseHome/index.htm)

[还有一本免费的在线](http://mitpress.mit.edu/sicp/)随附书籍（计算机程序的结构和解释）。

**更新：**

对于那些对*类似于*使用 JVM 并且可以访问 Java 库（因为许多大学使用 Java）的方案的语言感兴趣的人，请查看[Clojure](http://clojure.org/)。也许这将成为计算机科学介绍的新语言选择（我们都希望！）。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-11-15T02:14:49.833

Square USA 用它制作了电影《*最终幻想》*。

这是他们在上面发表的一篇论文：[Gluing Things Together - Scheme in the Real-time CG Content Production](http://practical-scheme.net/docs/ILC2002.html)。

从那篇论文：

> 在 SIGGRAPH 2000 和 2001 上，我们 Square USA 研发团队展示了计算机生成的完整电影“最终幻想：灵魂深处”中场景的实时渲染。
> 
> [...]
> 
> 我们发现在实时渲染引擎中嵌入一个 Scheme 解释器有很大的帮助。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-11-14T19:03:30.453

Scheme 会让你对编程有不同的看法。试着心胸开阔！

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-11-14T19:08:00.130

> “真的有人在使用这种语言吗？”

[保罗格雷厄姆](http://www.paulgraham.com/avg.html)，著名。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-10-05T19:36:35.593

JavaScript 在很多方面都与 Scheme 非常相似（尽管它缺少延续和 Scheme 的高级数值系统）。

来自“ [ECMAScript 语言概述](http://www.ecmascript.org/es4/spec/overview.pdf)”（PDF）。2007 年 10 月 23 日。第 4 页。检索于 2009-05-03。

> ES3 是一种简单的、高度动态的、基于对象的语言，它的主要思想来自于语言 Self 和 Scheme。编程风格是基于对象和函数式编程的混合体：ES3 中的主要抽象机制是词法范围的高阶函数和可变对象......

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-05-14T15:51:58.190

我目前正在[学习 Abelson 和 Sussman 于 1986 年在 Hewlett-Packard 进行的 SICP 讲座，以及](http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures)Brian Harvey 提供的[Cal-Berkeley CS61A 播客](http://webcast.berkeley.edu/course_details.php?seriesid=1906978270)（从同一[本书](http://mitpress.mit.edu/sicp/)中讲授）并在 Scheme 中学习，并且经验正在开放对我来说全新的思维方式。对于像我这样没有任何正规 CS 高等教育的人，我强烈推荐它...

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-11-14T19:35:27.063

我曾在一个项目中使用方案代码在生产中工作，它可能是非常酷的东西。Scheme 有一个很酷的特性，即[动态重新编译以自我优化执行](http://www.cs.indiana.edu/~dyb/pubs/pdrtc.pdf)。我认为这就像离天网只有一步之遥。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-11-14T20:19:24.917

我在大学里用过，但从那以后我就很少用了。

如果你对递归完全不满意，我强烈推荐学习 Scheme 或 Lisp。你将学会递归地思考各种各样的事情。递归总是正确的方法吗？当然不是。但它是工具箱中的一个有用工具。

我总是鼓励开发人员学习新语言。你学习和熟练掌握的语言越多，你对问题的思考就越抽象。您与特定语言的联系越少，您就越有可能选择最适合您的问题的语言。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-11-15T06:50:42.553

除了个人经验，最接近客观猜测的是[TIOBE 指数](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)，目前 LISP/Scheme 以 0.470% 的市场份额排名第 21 位。TIOBE 使用[搜索引擎结果](http://www.tiobe.com/index.php/content/paperinfo/tpci/tpci_definition.htm)来创建列表。显然，您会希望对列表（以及对 Scheme 使用的任何其他猜测）持保留态度。

无耻推广：查看[PLT Scheme](http://plt-scheme.org/)。他们创建了一个不错的社区，为许多平台提供他们的 IDE，并为您提供开箱即用的[不错的库选择。](http://docs.plt-scheme.org/)

这是一篇在商业应用程序中描述 PLT 方案的文章：[http](http://www.untyped.com/downloads/icfp068-welsh.pdf) ://www.untyped.com/downloads/icfp068-welsh.pdf 。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2011-10-01T07:58:16.017

在俄罗斯，我们使用 PLT Scheme 开发软件。而且它卖得很好；）

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-08-04T08:54:50.007

[Clojure](http://clojure.org/)是一种类似于 Scheme/Lisp 的语言，可以在 JVM 中运行，并且非常适合并行处理（据说）。使用 Clojure 的好处是您可以访问整个 Java API 和任何其他 Java 库。

Clojure 和 Scala 一样受到语言爱好者的欢迎。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-11-14T19:06:25.220

只要付出足够的努力，所有语言都可以用来写任何东西:)

然而，Scheme 很酷——根据我的经验，了解 Scheme 往往会影响你用其他语言进行编程。

Scheme 宏非常强大，并且 call-with-current-continuation 是一种思维扭曲功能。

经典测试是计算机程序的结构和解释（“SICP”）。值得一读。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-11-26T12:36:55.390

Java平台有很多方案实现，它们用于Java应用程序的脚本和原型设计。方案中存在用于 J2EE 的基于延续的 Web 框架，称为[SISCWeb](http://siscweb.sourceforge.net/)。

Guile 方案在一些 GNU 应用程序中用作脚本语言 - 例如 GnuCash 主要是用方案编写的。

[TinyScheme](http://tinyscheme.sourceforge.net)也用作 GIMP 的脚本语言，它的一些变体用于嵌入式系统。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-08-04T08:43:32.777

是的！方案很有趣。我在滑铁卢大学的第一年就学会了它。一开始有点不同，特别是如果您来自 OOP/命令式背景。

它为你做了很多好事，而函数式范式绝对是你应该探索的，如果只是为了获得不同的视角。

它也很有用，例如，我刚刚为 C 的超简化版本做了一个编译器，我无法想象没有函数式语言（：

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2010-03-29T11:12:16.747

Jazz Scheme 是一个基于 Gambit Scheme 的开源方案环境，它似乎在积极推广工业用途，请查看：

[爵士乐计划](http://www.jazzscheme.org/)

他们在新闻中报道了新用途：

[爵士乐计划新闻](http://www.jazzscheme.org/news.htm)

根据[此](http://groups.engin.umd.umich.edu/CIS/course.des/cis400/scheme/scheme.html)页面，Scheme 正在（或曾经）在以下公司使用：DEC、TI、Tektronix、HP 和 Sun。

[这个人](http://www.linkedin.com/in/thanttessman)的 LinkedIn 简历报告使用了迪士尼的 Chez Scheme。

只需用谷歌搜索一下就可以发现很多。在这种情况下，它证实了我曾经听说过 Scheme 的使用非常普遍，只是不是很公开的观察。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-11-14T19:41:37.893

绝对地。Scheme 适用于许多不同类别的问题。Jim Blandy 正在开发一个[名为 Minor](http://www.red-bean.com/trac/minor/)的 Scheme 版本，它与本地系统更紧密地集成在一起，并且旨在提高性能。

我知道 LilyPond 使用 Guile 来实现可扩展性，但我不知道我是否会将 LilyPond 视为软件的理想光辉示例，因为它严重损害了我的 OS X 安装......

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-11-14T20:03:23.497

我最近在 stackoverflow 播客上听说[Reddit](http://reddit.com/)最初是用 LISP 编写的！

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-11-14T20:09:55.873

这些天我在玩 IronScheme，但不知道有人在实际工作中使用 Scheme。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-11-14T20:13:36.317

方案主要用于教学目的。这就是在（有争议的）RSR6 之前没有*标准*模块系统的原因之一：在为家庭作业编写小程序时，需要大量大型库是不寻常的。

Scheme 最初是作为向 Lisp 添加类似 Smalltalk 的 OOP 的实验。它最终改变了宏系统，添加了`call/cc`（和`dynamic-wind`，`dynamic-unwind`），并且增长了很多。

除了使用 Guile 作为脚本语言的 GNU 项目之外，我不知道任何使用 Scheme 的生产系统。不过，我确实知道一些使用 Lisp 的生产系统（[Orbitz 在其预订系统中有 Lisp 代码](http://danweinreb.org/blog/the-failure-of-lisp-a-reply-to-brandon-werner)）。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-04-01T03:57:03.030

我已经学习了 2 年多的 Scheme，它对我作为一名程序员有很大的帮助。它教会了我如何以不同的方式思考并理解编程语言之间更深层次的概念和联系。事实上，您可以像在 Java 和 C 中一样在 Scheme 中编写任何程序，但这是相当困难的。在将其解释为 Java 或 C 代码之前，必须进行一系列程序转换。至少学习基础知识是值得的。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-11-14T20:19:24.650

我在我的程序语言设计课上学习它，它有一些巧妙的用途。我只会将它用于容易导致尾递归的问题。

# c# - 以编程方式设置 ASP:ContentPlaceHolder 内容

> ID：291037
> 
> 赞同：1
> 
> 时间：2008-11-14T19:02:02.797
> 
> 标签：c#, asp.net, contentplaceholder

`<asp:ContentPlaceHolder>`以编程方式设置内容的最简单方法是什么？我想生病必须`Master.FindControl`打电话？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-15T04:08:48.323

如果您的页面继承自 MasterPage，那么您的页面上应该有一个带有一些 id 的 asp:Content 控件，如下所示：

```
<asp:Content runat="server" ID="myContent" ContentPlaceHolderID="masterContent">
</asp:Content> 
```

您应该能够在您的代码隐藏中引用它并添加您想要的任何内容。

```
public void Page_Load( object sender, EventArgs e )
{
    HtmlContainerControl div = new HtmlGenericControl( "DIV" );
    div.innerHTML = "....whatever...";
    myContent.Controls.Clear();
    myContent.Controls.Add(div);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-15T09:07:02.293

我使用自定义扩展方法递归搜索控件（例如占位符）以通过 Id 查找您要查找的控件并返回它。然后，您可以根据需要填充返回的控件。在遍历要填充的控件列表的 foreach 循环中调用它。

```
public static class ControlExtensions
{
    /// <summary>
    /// recursive control search (extension method)
    /// </summary>
    public static Control FindControl(this Control control, string Id, ref Control found)
    {
        if (control.ID == Id)
        {
            found = control;
        }
        else
        {
            if (control.FindControl(Id) != null)
            {
                found = control.FindControl(Id);
                return found;
            }
            else
            {
                foreach (Control c in control.Controls)
                {
                    if (found == null)
                        c.FindControl(Id, ref found);
                    else
                        break;
                }

            }
        }
        return found;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T19:06:41.257

如果要向空白页添加控件，则执行 Page.Controls.Add()....不是吗？

# c# - C#：尝试一个简单的项目

> ID：291057
> 
> 赞同：3
> 
> 时间：2008-11-14T19:09:19.880
> 
> 标签：c#, while-loop

我是 C# 新手。我想做一个带有某种循环的简单程序。我希望我的程序循环遍历用户输入的数字，如果它小于一个数字，然后继续猜测，但是一旦他们输入数字 25，我希望它说圣诞快乐.. 请帮助

```
int number;

do
{
    Console.WriteLine("Guess a number between 20 through 25");
    number = int.Parse(Console.ReadLine());
}  while (number < 25); 
```

C# 初学者

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-14T19:20:04.740

尝试以下操作：

```
int number = 0;
while (number != 25)
{
    Console.WriteLine("Guess a number between 20 through 25");
    number = int.Parse(Console.ReadLine());
    if (number != 25)
        Console.WriteLine("Keep guessing");
    else
        Console.WriteLine("Merry Christmas");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T19:22:03.580

我不确定你的问题是什么，但我有几点意见：

1.  如果用户输入了无法解析为 int 的内容，则会引发异常。使用 TryParse 解决此问题。

2.  如前所述，如果用户输入大于 25 的数字，例如 26，则循环将退出。

修改后的代码：

```
int number;
do
{
    Console.WriteLine("Guess a number between 20 through 25");
    int.TryParse(Console.ReadLine(), out number);
} while (number != 25); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T19:53:44.673

如果您永远不会将输入用作数字，则将其保留为字符串会更安全，特别是因为您只检查“25”。此外，添加一种无需输入 25 即可退出的方式对用户来说会很好，例如输入一个空行。

这是我的写法：

> ```
>  static void x()
>     {
>         Console.WriteLine("Guess a number between 20 through 25");
>         string input = null;
>         while(true)
>         {
>             input = Console.ReadLine();
>             if (input == null || input.Length == 0)
>                 break; // will exit the loop
>             if (input != "25")
>                 Console.WriteLine("Keep guessing");
>             else
>             {
>                 Console.WriteLine("Merry Christmas");
>                 break;
>             }
>         }
>     } 
> ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T19:17:59.893

```
int number;

do
{
    Console.WriteLine("Guess a number between 20 through 25");
    number = int.Parse(Console.ReadLine());
} while (number < 25);

if (number == 25)
    Console.WriteLine("Merry Christmas"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T19:21:53.520

```
int number;

do
{
    Console.WriteLine("Guess a number between 20 through 25");
    number = int.Parse(Console.ReadLine());
} while (number != 25);

Console.WriteLine("Merry Christmas"); 
```

如果您希望他们能够输入高于 25 的数字，那将是正确的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-14T03:55:42.907

```
 int myNumber;

        Guess: Console.Write("Guess a number between 20 through 25: ");
        myNumber = int.Parse(Console.ReadLine());

            while(myNumber != 25)
            {
                Console.WriteLine("Keep Guessing");
                goto Guess;
            }
            Console.Write("Merry Christmas");

        Console.ReadKey(); 
```

# asp.net - ASP.NET 身份验证选项

> ID：291059
> 
> 赞同：0
> 
> 时间：2008-11-14T19:09:36.727
> 
> 标签：asp.net, authentication

我正在创建一个 asp.net 应用程序，只有一些来自 xml 文件的精简数据访问。但是，我需要能够验证管理用户（通过表单）来管理该数据。我不想仅仅为了身份验证而建立一个 sql db。我想使用 xml，但不确定它的安全性。有什么建议么？自定义角色提供者？我的OpenID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T19:12:51.120

表单身份验证并将成员身份存储在 web.config 中。

理想情况下，这些信息应该以某种方式加密或散列。使用 db 的用户管理更容易且更具可扩展性，但 MS 允许您存储在 web.config 和可能的其他提供程序中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T19:23:26.433

我同意 StingyJack 的观点，但是当您设置表单身份验证时，请确保您使用了一些加密。即使您拥有服务器，您也会想要这个……如果有人知道如何下载您的 XML 文件怎么办？

以下是一些加密选项：

*   [http://www.codeproject.com/KB/security/SimpleEncryption.aspx](http://www.codeproject.com/KB/security/SimpleEncryption.aspx)
*   [http://www.codeproject.com/KB/security/encryption_decryption.aspx](http://www.codeproject.com/KB/security/encryption_decryption.aspx)

现在，如果您不想使用 XML 文件来存储您的用户身份验证信息，您可以查看[SQLite](http://www.sqlite.org/)。它是一个非常轻量级的数据库——比 SQL Server（express 或其他）轻得多，而且很容易实现。下面是 .NET 库的链接。

[http://sqlite.phxsoftware.com/](http://sqlite.phxsoftware.com/)

# .net - 转换 .net XSLTransform 时 QName 无效

> ID：291060
> 
> 赞同：2
> 
> 时间：2008-11-14T19:10:07.240
> 
> 标签：.net, xml, xslt

我有一段结构类似于此的 XML：

```
 <root>
      <score name="Exam 1"><value>76</value></score>
      <score name="Exam 2"><value>87</value</score>
 </root> 
```

我想把它改成这样：

```
<root>
     <Exam 1>76</Exam 1>
     <Exam 2>87</Exam 2>
</root> 
```

在[这篇文章](http://www.peachpit.com/articles/article.aspx?p=21846)之后，我正在使用这个样式表：

```
 <stylesheet>
        <xsl:stylesheet version='1.0' xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>
            <xsl:template match='@*|node()'>
                <xsl:copy>
                    <xsl:apply-templates select='@*|node()'/>
                </xsl:copy>
            </xsl:template>
            <xsl:template match='score'>
                <xsl:element name='{@name}'>
                    <xsl:apply-templates/>
                </xsl:element>
            </xsl:template>
        </xsl:stylesheet>
    </stylesheet> 
```

但是，当我对其进行转换并将其加载到文档中时，我收到此错误：

> System.Xml.Xslt.XsltException：“考试 1”是无效的 QName

似乎许多谷歌结果显示有这个错误的人以某种方式传递了一个空字符串，错误是“”是一个无效的 QName，但这里不是这种情况。

问题是什么？有没有更好的替代解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T19:26:52.603

元素名称中不能有空格。

# video - Google 地球弹出视频 (ActiveX)

> ID：291061
> 
> 赞同：0
> 
> 时间：2008-11-14T19:11:19.843
> 
> 标签：video, activex, google-earth

是否可以在弹出的 Google 地球地标中放置 ActiveX 控件？

我有一个专有的第三方 activex 控件，可以嵌入 HTML。这适用于 Google 地球吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T13:28:00.287

您应该尝试将您的 activex 控件的 html 标记放入一个简单的 Kml 文件中以对其进行测试。

将代码示例另存为“test.kml”，并在指示的位置插入嵌入代码。然后只需在 Google 地球中打开“test.kml”文件。控件应位于“simple activex test”地标气球内。

我知道以这种方式嵌入 Flash 是有效的——但在不知道您使用的是什么控件的情况下，很难说在这种情况下它是否适合您。

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <Placemark>
      <name>simple activex test</name>
      <description>
        <![CDATA[
          <!-- code to embed activex control code here -->
        ]]>
      </description>
      <Point>
        <coordinates>52,-1</coordinates>
      </Point>
    </Placemark>
  </Document>
</kml> 
```

# c++ - 在 dll 中保存额外的数据，他们是如何做到的？

> ID：291065
> 
> 赞同：0
> 
> 时间：2008-11-14T19:13:43.707
> 
> 标签：c++, serialization

让我告诉你这个问题是从哪里来的。我一直在玩Serious Sam 2 的SDK，这是一个在Serious Engine 2 上运行的第一人称射击游戏。这个引擎引入了一种叫做MetaData 的东西。MetaData 在引擎中用于序列化类并能够在编辑器环境（Serious Editor 2）中编辑它们。因此，例如，而不是：

```
class CSomeGameItem : CEntity
{
    public:
    int iHealthToGive;
} 
```

哪个不会出现在编辑器中，你会这样做：

```
meta ver(1) class CSomeGameItem : CEntity _("Some game item")
{
public:
    meta int iHealthToGive; _("Amount of health to give")
} 
```

现在在制作关卡时，您可以在关卡中插入一个“一些游戏项目”实体，并编辑它的一个属性。现在，我知道 Croteam（上述游戏和引擎的开发人员）正在使用额外的编译器（Mdc，元数据编译器）将有关类及其变量的额外信息注入 dll 文件，以使这个元数据系统成为可能。有没有人知道他们是如何做到这一点的？

哦，顺便说一句，meta、ver() 和 _() 关键字在它们的代码中是#define'd ，所以“普通”编译器会忽略它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T20:09:15.297

要获得明确的答案，请研究[PE 文件格式](http://en.wikipedia.org/wiki/Portable_Executable)。这是 Win32 上二进制文件的低级文件格式。IE。DLL、EXE、COM 等

有许多描述 PE 文件布局和功能的书籍。以及许多可让您探索它的工具。

简短的回答是，在最低级别，PE 文件格式允许您将数据嵌入到可以在运行时提取的二进制文件中。DLL 和 Exe 通常会嵌入它们的图标和本地化文本。这些通常称为资源。

一个很好的起点是 MSDN 上的[资源文件](http://msdn.microsoft.com/en-us/library/7zxb70x7.aspx)部分。还要研究“资源脚本（*.rc 文件）”和“资源编译器（rc.exe）”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T19:43:10.747

如果这个引擎在 Windows 上运行，那么想到的一个想法就是资源。有 Windows API 可以修改 exe 或 dll 的资源内容。此外，该 API 允许从“外部”exe/dll 读取资源。这样，额外的编译器会将元数据作为资源存储在已编译的 exe 中。开发工具包将从“基础”exe/dll 中读取元数据。

现在，我以前对这些东西很紧张，所以我可能离它的实际工作方式还有光年。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T20:17:38.430

这看起来有点类似于 Qt 的 moc（元对象编译器）。在 Qt 的情况下，它会生成额外的 C++ 源文件，然后将这些文件编译并与原始源文件链接在一起。

您的示例中的一个可能实现是生成的文件实现一组函数，可以调用这些函数来获取额外信息、设置属性等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T20:18:43.700

在这里只是在黑暗中刺了一下，因为我从未看过 sdk，但我猜有两个传递系统正在发生 - 一次使用 C++ 编译器，一次使用可以查找的自定义元数据处理器元标记并处理相关的类名、实例成员名和 _() 标记。可能会创建某种配置文件，或者放在一边，或者作为资源文件嵌入。自定义元数据传递也可以只是一个 C++ 代码生成器，它创建代码以启用每个类的伪反射。

# .net - .NET 3.5 安装程序是否包含 3.0 SP2？

> ID：291080
> 
> 赞同：5
> 
> 时间：2008-11-14T19:20:57.000
> 
> 标签：.net, installation

我们正在尝试追踪一些 .Net 程序集依赖问题。

在 Windows XP 上，.Net 3.5 安装程序是否自动包含 3.0 SP2？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-14T19:33:08.847

.NET 3.5 包含 .NET 3.0 SP1

.NET 3.5 SP1 包含 .NET 3.0 SP2

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T19:25:41.047

我不确定，但我相信 Microsoft 是在每个版本的 .NET 之上构建的。这使我*相信*您的问题的答案是“**是**”。希望有人可以证实这一点。

# asp.net-mvc - 在 ASP.NET MVC 中使用双重提交的 Cookie 实现 XSRF 安全性的想法

> ID：291102
> 
> 赞同：1
> 
> 时间：2008-11-14T19:27:19.967
> 
> 标签：asp.net-mvc, security, csrf

我决定尝试使用[双重提交 cookie](https://blog.codinghorror.com/preventing-csrf-and-xsrf-attacks/)技术来尝试防止对我正在处理的站点的 XSRF 攻击。所以我在这里写下来的方式是，除了获取信息之外，所有实际执行的操作都将是帖子。获取将是……呃……获取。其次，发布的每个表单都将具有键/cookie 组合。

我的问题是，在 ASP.NET MVC Web 应用程序中实现此功能的最简单方法是什么？

不回答我自己的问题，但这是我最初的想法：

现在我的控制器都继承自一个基本控制器，所以我的第一个想法是重写 OnActionExecuted 方法来检查所需的表单字段是否存在，如果找到它，从那里根据 cookie 验证它并允许发布继续或将其踢到某个错误页面。

对于表单部分，我正在考虑生成我自己的 html 扩展方法，例如... Html.BeginSecureForm() 重载所有与 BeginForm 相同的方法（以防我需要它们）但自动生成伪随机密钥和 cookie 并放置cookie 和表单内的表单字段（如果它是 POST！）自动。

抱歉，如果这有点混乱，我在这些页面中散布着笔记，我正在尝试组织它们。其中一部分是为了弄清楚我对这个 XSRF 安全性的设计。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T20:16:25.720

在 ASP.NET MVC 中使用对此的[内置支持](http://blog.codeville.net/2008/09/01/prevent-cross-site-request-forgery-csrf-using-aspnet-mvcs-antiforgerytoken-helper/ "使用 ASP.NET MVC 的 AntiForgeryToken() 帮助程序防止跨站点请求伪造 (CSRF)")。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T09:08:24.840

内置的 ASP.NET MVC XSRF 保护有一个缺点：它向客户端发送另一个 cookie。

> 同时，`Html.AntiForgeryToken()`会给**访问者一个名为 __RequestVerificationToken 的 cookie**，其值与上面显示的随机隐藏值相同。

我不希望向客户端发送大量 cookie，因此当您为每个用户拥有一个唯一的服务器端跟踪器时（例如，说数据库中的会话表..），您可以使用它。少一个 cookie —— 只需在用户表中发送一个唯一的哈希值。

但是还有一些匿名用户没有用户帐户，因此没有服务器端跟踪。在这种情况下，我想知道您是否可以以某种方式获取*已经发送给每个用户***的现有 ASP.NET_SessionId cookie**（启用会话时）......而不是创建另一个 Cookie。

 *可能的？还是我没有考虑清楚..？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-18T14:07:56.317

一种获得关注的方法是加密令牌模式，它由一个名为 ARMOR 的框架实现。这里的前提是您既不需要 Session 也不需要 cookie 来维护 CSRF 保护。[加密令牌模式](http://insidethecpu.wordpress.com/2013/09/23/encrypted-token-pattern/)利用 Rijndael 加密令牌，其完整性由 SHA256 散列算法维护。

ARMOR 框架很容易在 MVC 和 Web API 应用程序中实现。完整的演练[在这里](http://insidethecpu.wordpress.com/2013/12/16/implementing-the-encrypted-token-pattern-by-leveraging-armor/)。

# debugging - 是否有任何系统可以记录或跟踪您在开发过程中遇到的错误类型？

> ID：291111
> 
> 赞同：1
> 
> 时间：2008-11-14T19:31:53.420
> 
> 标签：debugging, build, bug-tracking

我本身并不是在寻找错误跟踪。但更像是一个构建工具：作为一名开发人员，如果每次编译或尝试运行代码时，我都可以重定向调试输出并记录我最常引入的错误、解决它们需要多长时间等，那就太棒了。

外面有这样的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T19:38:14.937

我知道[FogBugz](http://www.fogcreek.com/FogBugz/)有一些东西，您可以使用特定信息访问他们的 Web 服务来记录错误。您也许可以添加一些代码以仅使用此服务进行调试。

我们将它们用于我们的错误跟踪，它是一个很棒的网站

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T04:14:18.297

我认为这里的部分问题是认为您在开发过程中犯的“错误”或“错误”在某种程度上是“异常的”。他们不是。它们是“调查解决问题的方法”的一部分。:-)

编码中的错误在检查到主源之前不是“错误”。如果您在“调查”如何解决分配给您的特定问题的过程中找到并修复它们，那么这就是所谓的......“成为一名程序员”。

在签入之前构建和测试代码的“个人”副本是避免将“错误”引入项目的方法。:-)

# java - Java Swing - 使用 JScrollPane 并让它滚动回顶部

> ID：291115
> 
> 赞同：82
> 
> 时间：2008-11-14T19:33:36.320
> 
> 标签：java, swing

我正在使用 JScrollPane 来允许在具有用作文本编辑器的文本组件的 JFrame 中滚动。在此编辑器中设置文本后，我想做的是让它向上滚动到顶部，这样您就可以看到文件开头的内容。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2008-11-14T23:17:04.950

在你的文本组件上调用[setCaretPosition(0)](http://java.sun.com/javase/6/docs/api/javax/swing/text/JTextComponent.html#setCaretPosition(int))会导致它滚动到顶部。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2010-08-23T14:44:56.393

以防万一您不使用文本组件，请查看此处发布的线程....[在 JScrollPane 上设置滚动条](https://stackoverflow.com/questions/1166072/setting-scroll-bar-on-a-jscrollpane)

他们的解决方案是通过 invokeLater 剥离一个线程

```
final JScrollPane scroll = new JScrollPane(text);
javax.swing.SwingUtilities.invokeLater(new Runnable() {
   public void run() { 
       scroll.getVerticalScrollBar().setValue(0);
   }
}); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-01-22T23:31:42.747

这将使工作：

```
DefaultCaret caret = (DefaultCaret) textArea.getCaret();
caret.setUpdatePolicy(DefaultCaret.NEVER_UPDATE); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-08-29T07:44:14.757

您可以在文本组件`setCaretPosition(0)`之后使用该方法。`setText(String t)`

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-14T19:42:55.163

使用[JComponent.scrollRectToVisible()](http://java.sun.com/javase/6/docs/api/javax/swing/JComponent.html#scrollRectToVisible(java.awt.Rectangle))

如果您需要更多信息，[这里有一篇文章](http://www.chka.de/swing/components/scrolling.html)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-14T23:14:52.723

你可以试试这个：

```
 scrollPane.getViewport().setViewPosition(new Point(0,0)); 
```

根据 JavaDocs setViewPosition() 的行为如下：

> 设置显示在视口左上角的视图坐标，如果没有视图，则不执行任何操作。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-04-13T14:13:07.657

就是这样：

```
textArea.setSelectionStart(0);
textArea.setSelectionEnd(0); 
```

# c# - .Net 中的多语言 Winforms - 意见和建议

> ID：291117
> 
> 赞同：2
> 
> 时间：2008-11-14T19:34:21.170
> 
> 标签：c#, winforms, multilingual

所以我有一个需要多语言的程序。我需要的和我在网上找到的唯一区别是，我的程序将在其上运行的所有计算机都设置为 EN 的本地化。

我们有讲西班牙语的员工，他们会像讲英语的员工一样使用该程序。所以我将无法根据计算机的本地化进行设置，这一切都必须在代码中完成。

我正在考虑尝试为我拥有的每个表单创建一个 XML 文件（实际上只是一个数据集），并让每个数据表都是一种可选择的语言。在每个表中，它都有信息（控件名称、属性和文本）来设置它需要的标签/复选框/等。我将不得不创建一个新的表单控件，以便我可以拥有一个通用函数来遍历并在可能的情况下重命名所有这些控件。

```
<DataSet>
   <English>
     <ControlName>labelHello</ControlName>
     <ControlProperty>Text</ControlProperty>
     <Text>Hello</Text>
   </English>
   <English>
     <ControlName>labelBye</ControlName>
     <ControlProperty>Text</ControlProperty>
     <Text>Bye</Text>
   </English>
   <Spanish>
     <ControlName>labelHello</ControlName>
     <ControlProperty>Text</ControlProperty>
     <Text>Hola</Text>
   </Spanish>
</DataSet> 
```

此外，我对每种表单的资源文件中的字符串也不太了解。我可以从那里做它并使用.Net函数来实现这一点吗？

所以我接受了很多建议，因为我真的不想回到我刚刚编写的程序并把它放进去，一旦我已经花了这么多时间在这个傻瓜上，我讨厌回去添加更多功能...

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T19:39:34.793

您可以在代码中设置所需的文化，例如：

```
Thread.CurrentThread.CurrentUICulture = new CultureInfo("es-ES"); 
```

有关详细信息，请参阅[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/b28bx3bh(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T03:11:40.543

这是一种痛苦，但并不难。在 VS2008 的 WinForm 设计器中，选择表单，查看其属性并设置 Localizable=True （如果您查看部分类/代码隐藏文件，您将看到一个新行，看起来像

```
 resources.ApplyResources(this, "$this") 
```

然后，对于您想要支持的每个语言环境，选择语言，并本地化默认本地所需的任何更改。

我相信 Windows 允许用户为指定的应用程序指定不同的语言环境。我上次在 Windows 2000 上尝试过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T15:15:17.400

对于 Windows，您可以拥有一种机器文化 EN，但对于浏览器，PC 的个人用户可以选择喜欢的文化（IE 和 Firefox 无论如何）。PC 上的其他所有内容都是英语在 IE 中，转到工具、选项，单击常规选项卡上的语言按钮。您可以指定首选的语言层次结构。

否则随乔斯回答。

# ruby - Ruby 中的 method_missing 陷阱

> ID：291132
> 
> 赞同：49
> 
> 时间：2008-11-14T19:39:17.430
> 
> 标签：ruby, metaprogramming

`method_missing`在 Ruby 中定义方法时有什么需要注意的地方吗？我想知道继承、异常抛出、性能或其他方面是否存在一些不那么明显的交互。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-11-14T22:57:31.353

一个有点明显的：`respond_to?`如果你重新定义，总是重新定义`method_missing`。如果`method_missing(:sym)`有效，`respond_to?(:sym)`则应始终返回 true。有许多依赖于此的库。

*之后：*

一个例子：

```
# Wrap a Foo; don't expose the internal guts.
# Pass any method that starts with 'a' on to the
# Foo.
class FooWrapper
  def initialize(foo)
    @foo = foo
  end
  def some_method_that_doesnt_start_with_a
    'bar'
  end
  def a_method_that_does_start_with_a
    'baz'
  end
  def respond_to?(sym, include_private = false)
    pass_sym_to_foo?(sym) || super(sym, include_private)
  end
  def method_missing(sym, *args, &block)
    return foo.call(sym, *args, &block) if pass_sym_to_foo?(sym)
    super(sym, *args, &block)
  end
  private
  def pass_sym_to_foo?(sym)
    sym.to_s =~ /^a/ && @foo.respond_to?(sym)
  end
end

class Foo
  def argh
    'argh'
  end
  def blech
    'blech'
  end
end

w = FooWrapper.new(Foo.new)

w.respond_to?(:some_method_that_doesnt_start_with_a)
# => true
w.some_method_that_doesnt_start_with_a
# => 'bar'

w.respond_to?(:a_method_that_does_start_with_a)
# => true
w.a_method_that_does_start_with_a
# => 'baz'

w.respond_to?(:argh)
# => true
w.argh
# => 'argh'

w.respond_to?(:blech)
# => false
w.blech
# NoMethodError

w.respond_to?(:glem!)
# => false
w.glem!
# NoMethodError

w.respond_to?(:apples?)
w.apples?
# NoMethodError 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-04-23T00:30:51.787

如果您的方法缺失方法只是查找某些方法名称，如果您还没有找到您要查找的内容，请不要忘记调用 super，以便其他方法缺失可以做他们的事情。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-15T18:00:38.830

如果您可以预期方法名称，最好动态声明它们而不是依赖 method_missing，因为 method_missing 会导致性能损失。例如，假设您想扩展数据库句柄以便能够使用以下语法访问数据库视图：

```
selected_view_rows = @dbh.viewname( :column => value, ... ) 
```

您可以提前确定数据库中的所有视图，然后遍历它们以在 @dbh 上创建“viewname”方法，而不是依赖于数据库句柄上的 method_missing 并将方法名称作为视图的名称发送到数据库.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-17T23:49:26.007

基于[Pistos 的观点](https://stackoverflow.com/questions/291132/methodmissing-gotchas-in-ruby#292838)：`method_missing`至少比调用我尝试过的所有 Ruby 实现的常规方法慢一个数量级。他正确地预见到何时可能避免调用`method_missing`.

如果您喜欢冒险，请查看 Ruby 鲜为人知的[Delegator](http://ruby-doc.org/stdlib/libdoc/delegate/rdoc/index.html)类。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-02-27T20:15:50.273

James 的回答很棒，但是在现代 ruby​​（1.9+）中，就像 Marc-André 所说的那样，您想要重新定义`respond_to_missing?`，因为它使您可以访问 . 之上的其他方法`respond_to?`，例如`method(:method_name)`返回方法本身。

例如，定义的以下类：

```
class UserWrapper
  def initialize
    @json_user = { first_name: 'Jean', last_name: 'Dupont' }
  end

  def method_missing(sym, *args, &block)
    return @json_user[sym] if @json_user.keys.include?(sym)
    super
  end

  def respond_to_missing?(sym, include_private = false)
    @json_user.keys.include?(sym) || super
  end
end 
```

结果是：

```
irb(main):015:0> u = UserWrapper.new
=> #<UserWrapper:0x00007fac7b0d3c28 @json_user={:first_name=>"Jean", :last_name=>"Dupont"}>
irb(main):016:0> u.first_name
=> "Jean"
irb(main):017:0> u.respond_to?(:first_name)
=> true
irb(main):018:0> u.method(:first_name)
=> #<Method: UserWrapper#first_name>
irb(main):019:0> u.foo
NoMethodError (undefined method `foo' for #<UserWrapper:0x00007fac7b0d3c28>) 
```

所以，总是`respond_to_missing?`在覆盖时定义`method_missing`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-03-13T06:22:13.920

另一个问题：

`method_missing``obj.call_method`和之间的行为不同`obj.send(:call_method)`。本质上，前者错过了所有私有和未定义的方法，而后者则不会错过私有方法。

因此，`method_missing`当有人通过`send`.

# c# - ArrayList 到字符串 - VS2008 - C#

> ID：291135
> 
> 赞同：-1
> 
> 时间：2008-11-14T19:40:00.347
> 
> 标签：c#, asp.net

```
 ArrayList filters = new ArrayList();
  filters.Add(new string[] { "Name", "Equals", "John" });

  ObjectDataSource1.SelectParameters.Add("AppliedFilters", 
           string.Join(",",(string[])filters.ToArray(typeof(string)))); 
```

我正在尝试向我的对象数据源添加一个参数，该参数绑定到我的选择方法，该方法应该接受一个字符串 []。但是由于 SelectParameters.Add 接受 (string,string) 或其他 3 个似乎对我不起作用的重载。

select 方法接受一个字符串参数，虽然我更喜欢它接受一个字符串 [] 或数组列表，但现在我可以接受一个我应该转换回字符串 [] 的字符串

解决方法：按照本文[链接文字](https://stackoverflow.com/questions/235166/how-do-i-set-up-objectdatasource-select-parameters-at-runtime)

**作为上述问题的副本**关闭。****

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-14T20:06:34.303

我认为你错了。

我想，这应该是代码 `ObjectDataSource1.SelectParameters.Add(filters[0], filters[2));`

如果您查看 MSDN Doc，它说第一个 arg 应该是参数名称，第二个 arg 应该是参数值。

请仔细阅读文档。
[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.parametercollection.add.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.parametercollection.add.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T20:08:20.010

这是你的意思吗？

```
arrList.ToArray(typeof(string)) as string[]; 
```

还是您想将字符串连接在一起？

我认为你在这里犯的错误是我会将它们分成三个不同的变量，而不是把它们都放在一个数组列表中。在您的示例中：

```
var filterField = "Name";
var filterComparison = "Equals";
var filterValue = "John"; 
```

# wpf - 如何在 WPF 中的 WrapPanel 内对齐可变大小控件

> ID：291139
> 
> 赞同：0
> 
> 时间：2008-11-14T19:41:43.260
> 
> 标签：wpf

我有一个用 Label 和 TextBox 控件动态填充的换行面板。显示将是这样的：

标签 1 [文本框] 标签 4 [文本框] 标签 2 [文本框] 标签 5 [文本框] 标签 3 [文本框]

等等...

如何设置换行面板以显示上面的控件？

窗口长度也是固定的，有时标签很多，它们从右侧被切断。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T19:51:06.300

看来我必须使用 Wrap Panel 控件的 ItemWidth 属性。

```
<WrapPanel Width="Auto" ItemWidth="60" Height="Auto" HorizontalAlignment="Left" Orientation="Horizontal" x:Name="textBoxPanel" /> 
```

# svn - Subversion“堆栈”是 Team Foundation Server 的现实替代品吗？

> ID：291145
> 
> 赞同：21
> 
> 时间：2008-11-14T19:44:20.620
> 
> 标签：svn, tfs

我正在为我的客户评估 Microsoft Team Foundation Server，该客户目前使用 Visual SourceSafe，没有别的。他们明确表示希望在他们的应用程序处于生产状态时实现更严格和流程驱动的环境，并且他们有未来的版本需要考虑。

我试图涵盖的特定领域是：

*   配置管理（例如，源代码控制）
*   变更管理（变更请求、任务的工作流程和文档）
*   发布管理（构建和部署）
*   事件和问题管理（问题和错误）
*   文档管理（类似于源代码控制，但可通过 Web 获得）
*   签入的代码分析约束
*   一个测试框架
*   报告
*   Visual Studio 2008 集成

TFS 可以很好地完成所有这些事情，但维护起来既昂贵又复杂，而且廉价的 Workgroup 版本无法扩展。我们没有将 TFS 作为 MSDN 订阅的一部分。

这些问题是可以克服的，但在我告诉我的客户走 TFS 路线（这本身并不是一件可怕的事情）之前，我想评估替代方案。我知道 Subversion 经常被推荐用于它的配置管理/源代码控制，但是其他领域呢？Subversion/NUnit/Wiki/CruiseControl/NAnt/其他东西的组合会满足所有这些要求吗？我需要在评估中包含哪些工具？

还是我应该硬着头皮继续使用 TFS，因为我们已经投资了 Microsoft 堆栈？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-14T19:48:00.067

一些非常大的项目在 SVN 或 GIT 上成功运行。

我倾向于使用不同的同类最佳应用程序，这些应用程序可以相互通信，而不是像 TFS 这样的单一单体创建。许多免费和商业错误跟踪器与测试运行程序一样与 SVN 集成。与让 MS 服务器应用程序做一些新的事情相比，创建自己的 SVN 等接口通常也更容易。
最后，从像 SVN 这样的东西迁移到下一个伟大的新东西比从像 TFS 这样的专有包中获取数据更容易。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-14T19:48:14.777

好问题。我从未使用过 TFS，但所有这些都可以通过多种工具实现。最大的障碍是公司和开发人员的文化和心态。

我是专业SVN。（但我确信 TFS 会起作用）

我建议对日常任务进行非常轻微的干扰。

在 SVN 中拥有从一个分支到另一个分支的沙箱或升级规则是一种无需阻止提交过程即可进行代码分析的方法。

因此，为了解决您的每一个问题：SVN 处理源代码控制，并且辅助/包含在变更管理和发布管理中

变更管理/工作流程基本上是由项目团队定义的，可以通过简单的工具来帮助或仅通过策略强制执行。

发布管理也是基于策略的，并使用现有的框架/工具 (SVN)

大多数流行的缺陷/问题跟踪系统都将处理事件和文档管理——想想 wiki 与 trac 或fogbugz（以及用于 doc mgmt 的 SVN）

FXCop 和所有其他工具可以作为代码分析构建的一部分

测试框架更多地基于策略而不是工具驱动——如果这是你想要的，你必须把它作为优先事项。

您的报告概念含糊不清，但我认为您在任何情况下都有足够的工具来满足这一点

我不确定与 2008 集成时您真正需要什么。无论如何，这不会像 TFS 那样紧密耦合，但我不认为这是一个问题。

（我想你回答了你自己的问题。）这可能最终成为 MS 和反 MS 双方之间的宗教战争。

在我负责推荐和实施解决方案的三个地方，我们用我们的钱包投票 - 反对 MS。我确信 TFS 是有能力的，但竞争完全取决于任务，我认为这些工具可以很好地用于其他工作。

至于要考虑的工具——我认为在堆栈溢出中搜索 nant、msbuild、cruisecontrol 等会给你带来比你能动摇的更多的内容......

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-05-22T15:23:42.190

我认为以下堆栈优于 TFS：

*   [VisualSVN 服务器](http://www.visualsvn.com/server/)- 源代码控制
*   [Jenkins](http://jenkins-ci.org/) - 自动构建
*   [Redmine](http://www.redmine.org/) - 问题跟踪

这些工具中的每一个都服务于特定的目的，并有自己的优点。它们可以很好地协同工作，但可以在出现更好的情况时单独更换。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-14T20:08:15.143

如果目标开发人员以 Microsoft 为中心并且客户想要可执行的流程，那么使用 TFS 是一个不错的选择。实施成本必须考虑学习曲线、生产力损失和现有基础设施。如果这是一家大商店，而且听起来确实如此，那么您还需要一个“IT”团队的支持，而这对于一个全新的技术堆栈来说可能很难获得。

话虽如此，这里有一些其他选择：

您可能想看看 Subversion + [Atlassian](http://www.atlassian.com/)的 Jira（问题跟踪）、Confluence（维基）、Bamboo（CI）、Clover（代码覆盖率）、Fisheye（存储库“洞察力”）

这些是商业工具，但也已经与 Subversion 集成并很好地集成。

IBM 现在销售和开发的 Rational 工具集健壮、可靠并且非常面向过程。不过，可能比 TFS 贵。我最近没有使用过这个，但在过去的活动中，它在那些商店中表现良好。

最后，还有 Computer Associate 的[软件变更管理器](http://www.ca.com/us/products/product.aspx?ID=255)，它拥有我曾经不幸被迫使用的所有工具**中最令人讨厌的流程执行。**但是，如果您想要保持肛门、强迫性/强迫性的强制过程，那么这就是您的工具。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-14T19:49:11.733

我会研究 SVN、Trac、CruiseControl 和 Nant……所有这些都是免费的、开源的，而且非常成熟。

我已经说服了我的工作场所在这个堆栈上，而且我没有回头……

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-07-13T22:31:13.100

我很惊讶没有人提到 Collabnet 的[TeamForge](http://www.open.collab.net/products/ctf/)。它是 SVN 的“堆栈”部分，用于 SVN 之上的所有错误跟踪和其他管理控制。

它不像其他应用程序（例如 Polarion's [Requirements](http://www.polarion.com/products/requirements/index.php)）那样进行需求管理，但是如果您可以将需求跟踪为“错误”，那么它会很好。

顺便说一句，Polarion 的[ALM](http://www.polarion.com/products/alm/index.php)是 TFS 的竞争对手——他们在网站上有一个比较图表。虽然贵:(

最好的免费替代品可能是[Redmine](http://www.redmine.org/)恕我直言。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-20T17:51:37.007

Team Foundation Server 还包括构建管理，TFS 构建管理可用于[持续集成](http://martinfowler.com/articles/continuousIntegration.html)以及发布构建等。

我已经将[CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)与 Subversion 一起用于构建管理，并且效果很好。然而，TFS 会给你更多的控制和审计等。考虑一下你是否希望对你的程序员有这种程度的控制，或者你是否应该更加信任他们。

[还可以考虑SourceGear](http://www.sourcegear.com/)的Vault 或 Fortress ，因为它们旨在为习惯于 Visual SourceSafe 的人提供方便，例如他们有固定功能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-14T19:48:45.430

尽管人们讨厌顾问，但您可能会考虑与提供商业 svn 支持的公司交谈。如果 TFS 像您所说的那样昂贵，那么这可能会为您节省一些钱，因为您可以从良好的设置开始。这当然是有风险的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-17T23:59:36.733

出于某种原因，我将“Subversion 堆栈”与 FOSS 相关联。并不是说它不能用于企业工作，而是根据我的经验，企业客户更喜欢一体化解决方案。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-07-02T21:16:38.597

虽然有疑问，但我认为这两条路线都有其优点。我真的很喜欢 TFS 通过其 Visual Studio 集成提供的基本和日常操作的可用性。GUI'wise 如果你将它与 TortoiseSVN 进行比较，它真的会失去功能。TFS 确实有一个命令行实用程序，它涵盖了 GUI 中缺少的大多数功能。除了源代码控制之外，我认为 TFS 在设置签入/提交策略、将其与工作项等相关联时提供了更强的凝聚力。我特别喜欢 TFS 提供的 Web 界面（尽管在变得过于热情之前先研究一下它的许可模型）合并冲突处理在 VS2008 中相当糟糕，他们将在 VS2010 中改进。TFS 在某种程度上是一个万事通，也许掌握非。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-02-08T08:20:56.890

VisualSVN 在 SVN 和 VS 之间提供了非常好的集成。我们从 TFS 迁移到 SVN。那时（大约 2 年前，我认为......）我们觉得 TFS 臃肿且速度较慢（与 svn 相比要慢得多）。但我敢肯定，现在它一定有所改善。

两条路线之间的一个主要区别是，与“svn 堆栈”相比，TFS 可以轻松设置。您必须安装不同的工具和应用程序并让它们一起工作。这需要一些时间。但在病房之后，它会在没有抱怨的情况下工作。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-05-23T02:50:39.173

我们的堆栈看起来像：

配置管理（例如，源代码控制）
[SVN](http://subversion.tigris.org/)

变更管理（变更请求、任务的工作流程和文档）
[Trac](http://trac.edgewall.org/)

发布管理（构建和部署）
[Hudson](http://hudson-ci.org/)

事件和问题管理（问题和错误）
[Trac](http://trac.edgewall.org/)

文档管理（类似于源代码控制，但可通过 Web 获得）
[SVN](http://subversion.tigris.org/)（使用 Apache 作为 Web 界面）

签到的代码分析约束
[Coverity](http://www.coverity.com/)

一个测试框架
[Hudson](http://hudson-ci.org/)（支持许多不同的单元测试框架）

报告
[StatSVN](http://www.statsvn.org/)

Visual Studio 2008 集成
[VisualSVN](http://www.visualsvn.com/)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-10-18T02:17:33.980

我已经在栅栏的两侧工作过。我最初被迫使用 SourceSafe。我满怀热情地讨厌它。当我能够掌控 IT 政策时，我尝试了几种不同的选择，然后选择了 SVN 和 Trac 路线。它也不是没有学习曲线，但结果很好。

然后我开始在一个使用 SourceSafe 和 RedMine 的大地方工作。我非常想念 SVN，但我喜欢 Redmine。

我们最近将所有内容都转移到了 TFS 和 Jira。有时我认为大公司做事只是因为他们喜欢花钱。尽管许多数据完整性问题可能在后端进行排序，但 TFS 几乎与 SourceSafe 实际使用时一样痛苦。

在这些选项中，SVN 和 Jira 将是首选组合。SourceSafe 将位于列表的底部，紧随其后的是 TFS。

# .net - UpdatePanel 中的 CompareValidator - VS2008

> ID：291152
> 
> 赞同：0
> 
> 时间：2008-11-14T19:47:42.780
> 
> 标签：.net, ajax, validation, updatepanel

我正在使用 UpdatePanel 并希望将 CompareValidator 放在两个文本框上，以验证用户输入的密码和确认是否相同。

这是开箱即用的（我有 VS2008 并且正在使用 .NET 3.5），但有一个小问题：

一旦用户点击第一个文本框，验证就会触发，然后他们才有机会输入第二个文本框。这不会导致任何真正的问题，以编程方式（所有发生的只是错误消息显示，当他们输入确认时它消失了）但我们的测试人员说这是一个问题。在他们点击“保存”之前验证不会触发，它才会通过 UA 测试。

如何让 CompareValidator 在他们在两个框中都输入文本之前不触发？

编辑：

这是标记的示例。

```
 <div>
        <div><asp:Label runat="server" ID="lblPassword" Text="Password"/></div>
        <div><asp:TextBox runat="server" TextMode="password" ID="txtPassword" size="25" /></div>    
    </div>
    <div>
        <div><asp:Label runat="server" ID="lblConfirmPassword" Text="Confirm Password"/></div>
        <div><asp:TextBox runat="server" TextMode="password" ID="txtConfirmPassword" size="25" /></div>
    </div>
    <asp:CompareValidator ID="CompareValidator1" ValidationGroup="PublishPassValidation" ControlToValidate="txtPassword" ControlToCompare="txtConfirmPassword" runat="server" ErrorMessage="Passwords do not match"></asp:CompareValidator> 
```

以上内容位于页面上 UpdatePanel 的 ContentTemplate 中包含的控件中。

（为简洁起见，删除了 CSS 类和样式）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T23:17:36.867

您可以关闭该验证器的客户端验证。

```
EnableClientScript="false" 
```

但是，这意味着要往返于服务器以报告无效状态，并且您必须确保在继续之前检查页面确实有效。

```
Page.Validate("PublishPassValidation");

if (Page.IsValid)
{
    // Do Stuff
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T23:24:20.050

我有一种感觉，您在更新面板上启用了孩子作为触发器？

用户是否在密码框中按“ENTER”？您能否确认由于某种原因更新面板在移动焦点后是否正在执行部分刷新？

如果是这样，它将触发验证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-15T12:50:37.303

尝试切换它，以便在确认文本框而不是密码文本框上完成验证。这样，在您修改确认文本框或提交表单之前，它不会触发。您可能希望在密码文本框上有一个必填字段验证器。

```
<div>
    <div><asp:Label runat="server" ID="lblPassword" Text="Password"/></div>
    <div><asp:TextBox runat="server" TextMode="password" ID="txtPassword" size="25" />
         <asp:RequiredFieldValidator runat="server" ID="passwordRequiredValidator"
                                     ControlToValidate="txtPassword"
                                     ValidationGroup="PublishPassValidation"
                                     ErrorMessage="Password is required."  />    
    </div>    
</div>
<div>
    <div><asp:Label runat="server" ID="lblConfirmPassword" Text="Confirm Password"/></div>
    <div><asp:TextBox runat="server" TextMode="password" ID="txtConfirmPassword" size="25" /></div>
</div>
<asp:CompareValidator ID="CompareValidator1" ValidationGroup="PublishPassValidation"
                      ControlToValidate="txtConfirmPassword"
                      ControlToCompare="txPassword" runat="server"
                      ErrorMessage="Passwords do not match">
</asp:CompareValidator> 
```

# structure - 更多文件的数据结构

> ID：291155
> 
> 赞同：-1
> 
> 时间：2008-11-14T19:47:55.683
> 
> 标签：structure, directory

我正在寻找用歌曲对专辑进行排序的有效方法。我有大约 10000 张和不断增长的专辑，每张专辑中约有 10 首歌曲。所以这意味着 100000 个文件。

现在我不想将所有文件夹（专辑）存储在一个主文件夹中，但我正在寻找一种更好的存储方式。所有文件夹的层次结构都是平等的，所以我想按首字母对文件夹进行分组，或者只是将 1000 个文件夹打包到另一个文件夹中。但是很多人说这可能很混乱。

你有什么建议？

（我知道它与编程没有直接关系，但我认为数据存储也应该很重要）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T19:54:16.620

编写一个内容管理程序，您可以在其中加载您的 mp3，让它将文件移动到其结构中的文件夹中，并将条目写入数据库。

让数据库存储信息，包括物理路径。

在搜索时查询数据库，并让您的管理程序提供在 Windows 资源管理器中打开路径的选项（或将其链接到您的音乐播放器）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T20:26:46.807

假设您尝试从文件系统而不是通过其他一些软件来访问这些，那么您最好创建一个可以轻松导航的层次结构。我会按照你的建议使用缩写。

按第一个字母，然后是第二个字母对它们进行分组，尽可能深入地获得小型组。您也不必为每个组去相同数量的级别。“T”可能会进入 5 级，但“Q”只有 1 级。

# javascript - 如何使用 jQuery 抓取复选框的值并将它们吐到不同的表单字段中

> ID：291162
> 
> 赞同：1
> 
> 时间：2008-11-14T19:49:48.143
> 
> 标签：javascript, jquery, forms

我有一个包含一堆复选框的表单。在提交表单之前，我想获取复选框的值并将它们粘贴到文本字段中，然后提交。

所以我可能有：红橙X黄蓝X绿

我希望我的文本字段以内容 "Yellow, Green" 结尾。

这似乎并不太复杂，但我完全不在我的范围内。我已经将 jQuery 用于其他一些事情，所以我已经准备好框架，如果这样可以更轻松的话。

感谢您的任何建议-

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T20:15:14.927

只需使用以下代码：

```
$(function(){
    $('#YourFormID').bind('submit',function(){
        var serializedCheckboxes = '';
        $("input[type=checkbox]").each(function() {
         if($(this).attr("checked")) {
            serializedCheckboxes += (serializedCheckboxes != '' ? ', ' : '') + $(this).attr("value");
         }
        });
        $("input[name=allchecks]").attr("value", serializedCheckboxes);
    });
}); 
```

它在页面加载时启动并绑定到表单正确功能的“提交”事件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T19:52:51.397

首先破解它（未经测试）：

```
var serializedCheckboxes = '';
$("input type='checkbox'").each(function() {
 if($(this).attr("checked")) {
  serializedCheckboxes += $(this).attr("value") + ',';
 }
});

$("input name='allchecks').attr("value", serializedCheckboxes); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T19:59:20.963

修复 Josh 代码：

```
var serializedCheckboxes = '';
$("input[type=checkbox]").each(function() {
 if($(this).attr("checked")) {
  serializedCheckboxes += (serializedCheckboxes != '' ? ', ' : '') + $(this).attr("value");
 }
});

$("input[name=allchecks]").attr("value", serializedCheckboxes); 
```

经过我的修复后，您不应该在最后一个选项之后获得额外的“，”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T20:57:28.303

所以，更多的改进。将类名（在我的示例中为“colorCheckBoxes”）添加到表单中带有颜色的所有复选框（如果存在复选框） - 这有助于避免当您想在表单中使用不同的附加复选框以用于选择颜色之外的其他目的时出现问题。然后使用此代码：

```
$(function(){
    $('#YourFormID').bind('submit',function(){
        var serializedCheckboxes = '';
        $(this).find("input[type=checkbox]").filter('.colorCheckBoxes').each(function() {
         if($(this).attr("checked")) {
            serializedCheckboxes += (serializedCheckboxes != '' ? ', ' : '') + $(this).attr("value");
         }
        });
        if (serializedCheckboxes != '')
            $(this).find("input[name=allchecks]").attr("value", serializedCheckboxes);
    });
}); 
```

# regex - 我必须在 Perl 预编译的正则表达式中转义哪些字符？

> ID：291163
> 
> 赞同：5
> 
> 时间：2008-11-14T19:50:03.977
> 
> 标签：regex, perl, multiline, qr-operator

我很难确定在使用 Perl 的 qr{} 构造时**必须转义哪些字符**

我正在尝试为包含无数通常转义字符（#*.>:[]）并且还包含另一个预编译正则表达式的文本创建多行预编译正则表达式。此外，出于测试目的，我需要尽可能严格地匹配。

```
my $output = q{# using defaults found in .config
*
*
Options:
  1\. opt1
> 2\. opt2
choice[1-2?]: };

my $sc = qr{(>|\s)}smx;
my $re = qr{# using defaults found in .config
*
*
Options:
$sc 1\. opt1
$sc 2\. opt2
choice[1-2?]: }mx;

if ( $output =~ $re ) {
  print "OK!\n";
}
else {
  print "D'oh!\n";
} 
```

错误：

```
Quantifier follows nothing in regex; marked by <-- HERE in m/# using defaults found in .config
* <-- HERE 
*
Options:
(?msx-i:(>|\s)) 1\. opt1
(?msx-i:(>|\s)) 2\. opt2
choice[1-2?]: / at ./so.pl line 14. 
```

尝试转义星号会导致匹配失败（D'oh 输出）。试图逃避其他讨厌的字符也会导致匹配失败。我可以继续尝试不同的组合来逃避什么，但这里有很多变化，希望有人能提供一些见解。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-14T19:56:51.280

您必须转义 qr// 的分隔符，并且您必须转义任何要用作文字的正则表达式元字符。如果您希望它们是文字 *，则需要将它们转义，因为 * 是正则表达式量词。

您的问题是您添加的各种正则表达式标志。/m 没有做任何事情，因为您不使用字符串开头或结尾的锚点 (^, $)。/s 没有做任何事情，因为您不使用通配符。元字符。/x 使您的正则表达式中的所有空白都变得毫无意义，并且它将带有 # 的那一行变成了正则表达式注释。

这就是您想要的，删除了正则表达式标志并转义了正确的内容：

```
my $sc = qr{(>|\s)};

my $re = qr{# using defaults found in \.config
\*
\*
Options:
$sc 1\. opt1
$sc 2\. opt2
choice\[1-2\?]: }; 
```

尽管 Damian Conway 在*Perl Best Practices*中告诉人们始终将这些选项放在他们的正则表达式中，但您现在明白他为什么错了。你应该只在你想要它们做什么时添加它们，并且你应该只在你知道它们做什么时才添加它们。:) 如果您想使用 /x，可以执行以下操作。您必须转义任何文字空格，您需要以某种方式表示行尾，并且您必须转义文字 # 字符。以前可读的现在是一团糟：

```
我的 $sc = qr{(>|\s)};
我的 $eol = qr{[\r\n]+};

我的 $re = qr{\# \s+ 使用 \s+ 默认值 \s+ 在 \s+ \.config $eol 中找到 \s+
\* $eol
\* $eol
选项：$eol
$sc \s+ 1\。\s+ opt1 $eol
$sc \s+ 2\。\s+ opt2 $eol
选择\[1-2\?]：\s+
}X;

if ( $output =~ $re ) {
  打印“好的！\n”；
}
别的 {
  打印“哦！\n”；
}

```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-14T20:05:23.573

听起来您真正想要的是[Expect](http://search.cpan.org/~rgiersig/Expect/Expect.pod)，但您最急需寻找的是[quotemeta](http://perldoc.perl.org/functions/quotemeta.html)运算符，它将所有对正则表达式具有特殊含义的字符转义。

要直接回答您的问题（但是），除了不带引号的字符（在这种情况下`}`）之外，您至少需要转义，`.[$()|*+?{\`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T20:08:55.220

就像布赖恩说的那样，您必须转义分隔符和正则表达式元字符。请注意，在使用`qr//x`（您是）时，您还必须转义空格字符和#（这是一个注释标记）。您可能实际上并不想在`/x`这里使用。如果您想安全，您**可以**转义任何非字母数字字符。

# database - 我应该将数据库中的所有文本以大写还是小写形式存储？

> ID：291166
> 
> 赞同：7
> 
> 时间：2008-11-14T19:50:49.640
> 
> 标签：database

您更喜欢哪一个在数据库中存储文本？数据的原始大小写，或某种规范化。另外，我应该用触发器强制执行吗？还是应该使用客户端代码预处理输入数据？

我问你，因为我不确定是否有任何区别，除了显示数据的额外处理时间（例如名称的大写）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-14T19:52:37.107

存放在原盒中，除非有其他理由。大写或小写数据所花费的时间可能非常少，而且您永远不知道将来何时需要真正的原始数据。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-14T20:06:05.130

这显然取决于您以后需要对数据做什么。

但是，如果您询问是因为您有兴趣在以后加快查找速度（例如按名称、城市等搜索），您可能希望创建不同的索引，以便将这些索引用于查找：

```
create table case_test (
  id integer,
  name varchar2(30));

create index ucasename on case_test(upper(name)); 
```

像此示例这样的查询将使用不区分大小写的索引作为选择条件，但最初返回带有大小写的名称作为输入：

```
select * from case_test where upper(name) like 'TUCK%'; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-14T23:27:26.427

存储在用户输入的实际案例中。

作为用户，如果我喜欢我的名字为 cHriS，我会以这种方式输入，并且我喜欢这种方式。我不喜欢应用程序仅仅因为一些*技术原因而改变它*

如果要优化搜索，请使用单独的索引，不要更改数据。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-14T20:01:05.140

1.  在没有迫切需要更改数据的情况下，请勿更改数据。
2.  在没有令人信服的理由让您的数据库索引区分大小写的情况下，在您的数据库中使用不区分大小写。
3.  花时间担心用户看到和想要什么。这将引导您找到答案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-14T19:52:14.737

我不会担心它，只需将其格式化为您需要在输出中使用的方式。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-14T19:56:37.553

如果您需要进行大量文本字段搜索（strcol = "aBc"），您可以考虑规范化。在一些数据库系统（如 postgres）中，索引不与 ILIKE 运算符一起使用，尽管文本搜索特定索引可能会更好地处理这个问题。

# c# - 事件日志代码错误无法找到事件源？

> ID：291169
> 
> 赞同：2
> 
> 时间：2008-11-14T19:51:05.007
> 
> 标签：c#, events, c#-2.0

我正在尝试使用事件日志来编写一些调试信息，但无法使其正常工作。它抱怨无法找到事件源。我必须在操作系统上安装一些东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T19:51:45.597

这是我从我们的一个应用程序中修改的代码。这可能会帮助您开始创作。

```
System.Diagnostics.EventLog eventLog1 = new System.Diagnostics.EventLog();
string eventLogName = "StackOverFlowEventName";
string eventLogSource = "StackOverFlowWebsite";

//This code HERE will create the Event for you
if (!System.Diagnostics.EventLog.SourceExists(eventLogSource))
{
    System.Diagnostics.EventLog.CreateEventSource(eventLogSource, eventLogName);
}

eventLog1.Source = eventLogSource;
eventLog1.Log = eventLogName;
eventLog1.WriteEntry("This is a test"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T19:54:43.437

您目前在项目中使用什么代码？我目前正在使用这一行来写入事件日志。

```
System.Diagnostics.EventLog.WriteEntry(assemblyName, "Error stuff", System.Diagnostics.EventLogEntryType.Error); 
```

但请注意，如果日志文件已满，这将引发异常

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T20:02:07.213

您也可以直接进入注册表并添加使其工作所需的值，或者您可以在解决方案中添加一个项目，该项目将仅包含一个 InstallerClass，当您运行它创建的 exe 时，它​​将为您创建 EventLog 条目。

[MSDN 链接](http://msdn.microsoft.com/en-us/library/aa363648(VS.85).aspx)
[安装程序类链接](http://www.justskins.com/forums/custom-event-log-write-error-37477.html)

# sql - 在 SQL 中，我可以在嵌套选择本身内使用嵌套选择之外的变量吗？

> ID：291172
> 
> 赞同：1
> 
> 时间：2008-11-14T19:51:20.543
> 
> 标签：sql, oracle, ora-00904

我正在尝试使以下 SQL 语句起作用：

```
UPDATE myschema.tableA update_tableA
   SET field_id = 
   ( SELECT src.field_id 
         FROM myschema.srcTable src
         INNER JOIN myschema.tableB tableB ON 
            update_tableA.id = tableB.id 
            AND SDO_ANYINTERACT( tableB.shape, src.shape ) = 'TRUE' ); 
```

当我运行此语句时，我收到以下错误：

```
ORA-00904: "UPDATE_TABLEA"."ID": invalid identifier 
```

我不能在嵌套选择中使用嵌套选择之外的变量吗？有什么想法吗？

PS 标识符在数据库表中确实有效。问题似乎是范围，但我想确保这确实是一个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T21:03:54.187

我不相信您可以在不在要连接的表之一中的列上加入（即在 ON 子句中使用它）。额外的谓词需要在 WHERE 子句中。

试试这个：

```
UPDATE myschema.tableA update_tableA
   SET field_id = 
   ( SELECT src.field_id 
         FROM myschema.srcTable src
         INNER JOIN myschema.tableB tableB ON 
           SDO_ANYINTERACT( tableB.shape, src.shape ) = 'TRUE'
        WHERE update_tableA.id = tableB.id 
   ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T20:16:52.643

查看上面的SQL，这是我的想法

1）myschema.tableA 没有 ID 列（可能是 field_id）
2）SELECT 似乎没有提供连接条件

`SELECT src.field_id FROM myschema.srcTable src INNER JOIN myschema.tableB tableB ON`

用 tableB 加入 src 的条件在哪里？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T21:00:47.110

可以在嵌套选择中使用更新中的字段，如以下测试所示：

```
drop table test;
create table test as (select 1 key, 'a' value from dual);
insert into test values (2,'b');
select * from test;
update test t1 
   set value = (select 'c' from dual where t1.key=2);
select * from test; 
```

我不确定为什么它在这种情况下不起作用。似乎有必要与 TableA 进行显式连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-15T09:26:44.173

我必须承认我对Oracle并不熟悉，但我或多或少被SQL Server的SQL方言打败了。我上次查看时，这种 SQL 方言不允许在 UPDATE 语句中为要更新的表指定别名。即在 SQL Server 中，标识符**update_tableA.id**将是非法的。甲骨文有可能有同样的限制吗？

# licensing - 每年支付的软件维护费，是否应该保证新的主要版本？

> ID：291177
> 
> 赞同：-1
> 
> 时间：2008-11-14T19:52:27.500
> 
> 标签：licensing

如果您支付大约 25% 的许可费用作为软件的年度维护费，那通常会为您提供免费升级（甚至是主要版本）。

这应该意味着软件公司必须发布一个主要版本吧？否则你为什么要支付年度维护费？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T19:55:26.557

不，这并不意味着他们应该或将发布新的主要版本，除非您的合同中有此规定。他们可能只发布次要版本或补丁。

我确实认为从道德上讲，他们应该定期发布新的主要版本，但我会查看他们过去的发布历史。

软件维护费通常还可以让您获得优先支持，这是公司支付的主要部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T20:03:12.203

每年的维护费保证了合同中的内容，不多也不少。如果你的合同没有说它保证每年的重大更新，那么你就没有法律权利，也没有多少道德权利来抱怨。

如果您不喜欢它，请购买其他人的产品或编写自己的产品。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T20:42:26.010

我发现，至少在“企业”世界中，软件维护不会*让*您进行重大升级。它通常会为您提供小问题、安全补丁和支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T20:04:38.597

通常情况下，我希望得到任何重大版本，但我认为你不能期待任何事情。

首先什么是主要版本？如果您要*强迫*某人发布主要版本，那么他们可能只是更改 about 框中的数字并点击编译他们拥有的内容。这对任何人都没有帮助。

无论如何，我们越来越多地看到“订阅”许可的趋势，在这种情况下，一次性许可和维护费之间的界限被消除了。我认为总的来说，对于软件供应商和客户来说，这是一个更好的模型。

# javascript - Opera中POST上的jQuery语法错误

> ID：291183
> 
> 赞同：4
> 
> 时间：2008-11-14T19:53:08.697
> 
> 标签：javascript, jquery, ajax, post

我有一个附加到按钮的 onClick 事件的小 javascript 函数。它似乎在 Firefox(3.0.4) 中完美运行，但 Opera(9.62) 和 IE 都无法从同一个 .js 文件执行任何其他 JS，包括正常运行的。以下函数是罪魁祸首：

```
function deleteComment(id){
   $.post("ajax/comments.php", {delete: id},
      function (reply) {
         if (reply == "true") {
            alert("Comment deleted!");
         }
      }
   );   
} 
```

Opera 开发控制台说第二行有语法错误，它需要一个 '}' 代替第一个 '{'。我认为这对 IE 来说是同样的问题。这个 jQuery 是无法正确处理 IE 和 Opera JS 实现，还是我的代码在某种意义上有问题？我在文件中有一个类似的 POST jQuery 函数，它工作正常（当上面的代码不存在时）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T19:57:37.287

尝试将单词 delete 放在双引号中。我曾经遇到过密钥需要是字符串的问题，因为某些浏览器没有选择它们。

# css - Safari 中的相对定位

> ID：291189
> 
> 赞同：2
> 
> 时间：2008-11-14T19:55:03.623
> 
> 标签：css, safari, cross-browser, positioning

它必须很简单，这是我的 CSS：

```
.progressImage 
{
  position:relative;
  top:50%;
}

.progressPanel
{
height:100%;
width:100%;
text-align:center;
display:none;
}

<asp:Panel ID="pnlProgress" runat="server" CssClass="progressPanel">
<asp:Image ID="Image1" runat="server" CssClass="progressImage" ImageUrl="~/Images/Icons/loading.gif" />
</asp:Panel> 
```

我根据用户操作切换面板显示。

在 FireFox 中运行良好，但在 Safari 中显示在页面顶部。

ps“垂直对齐：中间；” 也不行。

pps设置“位置：相对；” 面板上不起作用，设置“位置：相对；” 在面板上和“位置：绝对；” 在图像上打破它在 FF 并且在 Safari 中什么也不做

这有效：

```
.progressPanel
{
  height:100%;
  width:100%;
  position:relative;
}

.progressImage
{
  position:absolute;
  top:50%;
  left:50%;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T20:26:00.177

将位置设置`.progressPanel`为相对，将位置设置`.progressImage`为绝对。以下适用于我在 FF、IE、Safari 中。将负边距设置为图像宽度/高度的一半，以实现完美居中。请注意，progressPanel 的某些父级（在本例中为主体）需要一个高度，以便 progressPanel 可以填充它。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>Test</title>
        <style type="text/css">
        body {
          height:700px;
        }
        .progressImage {
          position:absolute;
          top:50%;
          left:50%;
          margin-left:-16px;
          margin-top:-16px;
        }

        .progressPanel {
          position:relative;
          height:100%;
          width:100%;
          text-align:center;
          background:red;
        }
        </style>
    </head>
    <body>
    <div class="progressPanel"><img class="progressImage" src="pic.jpg"/></div>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T20:13:18.940

确保父容器也设置为 position: relative 并指定了高度，没有它，位置将无法正常工作。

```
.progressPanel
{
    height:100%;
    width:100%;
    text-align:center;
    display:none;
    position: relative;
} 
```

或者，为什么不将面板的背景属性设置为您的 gif？

```
background: url('path/to/image.gif') no-repeat center middle; 
```

这将始终居中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-18T04:35:30.517

位置规范（相对或绝对）应该在两个元素（父元素和子元素）中，否则子元素的定位不一定有效。您应该始终对元素使用相对定位，除非您指定确切的位置，例如 left: 100px; 顶部：100 像素。Vertical-align 是指元素本身，仅涉及文本行中的位置。除非你改变它，否则 line-height 与 div height 不同。line-height 必须指定大于内部元素才能使垂直对齐生效。

# asp.net - 为了测试目的，我需要在我的个人计算机上运行 ASP.NET Web 应用程序吗？

> ID：291191
> 
> 赞同：0
> 
> 时间：2008-11-14T19:56:07.600
> 
> 标签：asp.net, sql-server, windows, windows-xp

我正在运行 Windows XP SP3，并且确实安装了最新的 .NET 库以及 Visual Studio 2008。如果这很重要，我也在运行（并希望继续运行）Apache HTTP Server。

也许有人可以提供我需要的软件列表，然后我可以查找配置或在此处询问是否找不到我需要的软件。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T20:02:47.150

如果您有 Visual Studio 2008，只需创建新的网站项目。VS 有一个用于调试目的的内置 Web 服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T20:10:19.553

您已经拥有运行 ASP.NET 应用程序所需的一切；Visual Studio 2008 有一个内置的 Web 服务器“ [Casinni](http://www.asp.net/Downloads/archived/cassini/) ”，当您从开发环境编译和运行时，它会启动并托管您的 asp.net 站点（按 F5）

如果您拥有 XP 的专业版，您可以通过控制面板 -> 添加/删除 Windows 组件安装 IIS 5，然后使用它来托管您的网站。

要将 vs.net 配置为使用 IIS，请在解决方案资源管理器中，右键单击要为其指定 Web 服务器的网站的名称，然后单击“属性页”。

在“属性页”对话框中，单击“启动选项”选项卡。在服务器下，单击使用自定义服务器。在基本 URL 框中，键入运行当前网站时 VS.NET 应该启动的 URL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T20:02:41.237

你不需要其他任何东西。Visual Studio 将托管您的应用程序并让您逐步完成它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T20:03:50.050

既然你有 Visual Studio 2008，为什么不直接使用内置的 Casini 浏览器呢？我几乎在所有的开发和测试中都使用它——并且没有遇到任何重大问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-14T20:04:00.377

如果要在 Visual Studio 环境之外运行项目，还需要 IIS。您可以从添加/删除程序的 Windows 组件部分安装它。除此之外，你应该被设置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T20:05:33.867

在 Visual Studio 中按 F5。

# visual-studio-2008 - 为什么 VS 2008 会为某些 RELEASE 项目创建 PDB，而不会为其他项目创建 PDB？

> ID：291214
> 
> 赞同：4
> 
> 时间：2008-11-14T20:05:20.967
> 
> 标签：visual-studio-2008, pdb-files, csproj

我有一个解决方案，其中包含几个从 VS 2003、2005、2008 迁移的项目。在为 RELEASE 配置编译所有项目时，VS 2008 会为某些项目创建 PDB 文件，但不会为其他项目创建 PDB 文件。为什么？

在每个项目的“属性”页面的“构建”选项卡中，我可以看到它们都未选中“定义调试常量”并选中了“优化代码”。当我检查每个项目的 CSPROJ 时，我没有注意到任何看起来会改变这种行为的差异。我应该在 CSPROJ 文件中寻找什么？

此解决方案中的所有项目都生成类库，但一个创建 Windows 可执行文件的项目除外。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-14T21:00:46.470

该设置在 VS 2008 中的“构建/高级构建设置/调试信息”设置中控制 C# 项目。它有点隐藏 - 您必须按“高级...”按钮才能显示设置。

它对应于命令行编译器的`/debug:pdbonly`选项。`csc.exe`

# eclipse - 从源代码构建 Eclipse

> ID：291238
> 
> 赞同：14
> 
> 时间：2008-11-14T20:12:12.717
> 
> 标签：eclipse, build-automation, cvs

我一直在尝试构建从 CVS 获取的 eclipse，但找不到从哪里开始？

通常它很简单，制作 X，构建 X，但我发现这样做并不容易。有数百个插件，我似乎找不到在哪里构建它们并拥有 eclipse IDE。

是否有任何教程可以引导我完成整个过程？我似乎找不到一个。

此外，任何自动化并使其程序化的方法也将是巨大的，但我现在会满足于任何事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-14T22:16:20.780

我相信主要文档将是**[Building](http://wiki.eclipse.org/Building)**（来自 wiki eclipse 网站），并辅以一些[PDE 构建](http://wiki.eclipse.org/index.php/PDEBuild)指令。

> Eclipse 本身是使用插件开发环境附带的 PDE 构建基础结构构建的。Ant 用于运行构建，具有足够的插件点，您可以在其中执行自定义任务，例如代码检测。

现在，关于 eclipse 本身，**[releng 项目](http://wiki.eclipse.org/index.php/Platform-releng-faq#Is_the_Eclipse_platform_build_process_completely_automated.3F)**是负责实际构建的项目：该链接为您提供了有关如何进行的进一步指示，从安装 releng 插件开始。

这不是一个实际的*精确*配方，而是一个很好的起点。

[您在该博客](http://intellectualcramps.blogspot.com/2008/03/eclipse-build-process.html)上有进一步的讨论，包括[ant4eclipse](http://ant4eclipse.sourceforge.net/)的使用。
[Pluginbuilder](http://www.pluginbuilder.org/)也可以作为一个工具被提及，它可以用来促进一些 Eclipse 插件的构建。

* * *

12 年后的 2020 年 8 月，[özkan pakdil](https://stackoverflow.com/users/175554/%C3%B6zkan-pakdil)提议：

> ## “[如何在 Windows 10 中本地构建 Eclipse](https://ozkanpakdil.github.io/java,eclipse/2020/08/15/build-eclipseon-windows.html) ”

基于：

```
git clone -b master --recursive git://git.eclipse.org/gitroot/platform/eclipse.platform.releng.aggregator.git e
export MAVEN_OPTS="-Xmx2048m -Declipse.p2.mirrors=false"
cd e
mvn verify -DskipTests 
```

# database - Django：如何为异构数据类型树建模？

> ID：291249
> 
> 赞同：5
> 
> 时间：2008-11-14T20:14:56.500
> 
> 标签：database, django, database-design, django-models, django-treebeard

我需要在我的数据库中存储一个树数据结构，我计划为此使用[django-treebeard](http://code.google.com/p/django-treebeard/)或可能[的 django-mptt](http://code.google.com/p/django-mptt/)。我的困惑是每个节点都可能是三种不同类型中的一种：根节点始终是 A 类实体，叶节点始终是 C 类实体，介于两者之间的任何东西都将是 B 类实体。我想知道模拟这种情况的最佳方法。

**更新：** 我首先尝试了模型继承，我认为这可能是最好的方法。不幸的是，django-treebeard 的公共 API 并没有真正设计来处理这个问题。我最终让它与 GenericForeignKey 一起工作。非常感谢您的回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-15T01:51:41.033

您的三种类型可能最容易处理为与基本树的 FK 关联。

树可以是同质的——类`MyNode`是`treebeard.Node`. 您的节点可以有一个标志（根、中间、叶）和用于 A 或 B 或 C 的 FK。这允许您在查询 MyNode 实例时具有一些类似 SQL 的灵活性。

这可以让你的树生长。一个节点可以从 C 型（叶）开始，然后变形为 B 型（中间）。您更改状态，并更改 FK。

替代方案稍微复杂一些。

```
class MyA( treebeard.Node ):
    pass

class MyB( treebeard.Node ):
    pass

class MyC( treebeard.Node ):
    pass 
```

在这种情况下，您不能“变形”一个节点。当一个节点以 a 开始`MyC`并获得子节点时，您必须删除原始`MyC`实例，并将其替换为`MyB`具有新节点作为子节点的版本。这并非不可能，但可能会很痛苦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-15T12:30:54.817

如何使用模型中的[通用关系](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#id1)将树结构保存到它所代表的节点的内容对象？

```
from django.db import models
from django.contrib.contenttypes.models import ContentType
from django.contrib.contenttypes import generic

class Node(models.Model):
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    object = generic.GenericForeignKey('content_type', 'object_id') 
```

在检索完整树的内容对象时，这可能会导致大量查询，但有一些[方法和方法](http://code.google.com/p/soclone/source/browse/trunk/soclone/utils/models.py#56)可以减少所需查询的数量。

```
# Assuming mptt, as I'm not familiar with treebeard's API

# 1 query to retrieve the tree
tree = list(Node.tree.all())

# 4 queries to retrieve and cache all ContentType, A, B and C instances, respectively
populate_content_object_caches(tree) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-03T01:13:52.783

好吧，在某种程度上，已经为您做了很多事情，因为树 API 已经固有地识别了根、叶和其他内容。您可以在各个节点上调用 is_root() 和 is_leaf() 来区分它们。

叶子和中间可以是相同类型的实体并保存相同类型的数据，应用程序解释和使用数据的方式取决于测试 is_leaf()。

根有些特殊……它们可能想要保存与整棵树相关的信息，您可能想要一种简单的方法来查找特定的根并保存额外的数据。您可以使用与根节点具有一对一关系的模型来执行此操作（可能使用 save 方法重载并在允许保存之前检查以确认它指向 is_root() 的节点）。

总的来说，我的观点是，你可能不需要非常花哨地做你想做的事。您所做的区别已经封装在树及其 API 的概念中，您可以通过检查节点的上下文来使用相同的基本数据实现不同的行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-18T18:53:46.490

如果树结构是您的应用程序的一个组成部分，请考虑使用关系数据库以外的其他东西。也许neo4j？

# language-agnostic - 语言无关的构建管理系统

> ID：291252
> 
> 赞同：6
> 
> 时间：2008-11-14T20:15:20.493
> 
> 标签：language-agnostic, build

在我的职业生涯中，我曾在一个软件团队工作过几次，该团队确定

a）我们需要一个构建/测试系统
b）我们应该编写自己的
c）我们可以让开发人员花一周时间完成它，他们应该不必再碰它

每次，这都会导致一个系统似乎只对编写它的人有效，并且需要他们不断关注。我曾多次花时间寻找可以满足我们需求的工具，但空手而归。一般来说，像这种服务器这样的工具市场非常狭窄。我又需要这样的东西了。那里有什么东西，还是我们再写一次？

以下是我的优先级要求（最后几个很好）：

1.  能够处理多项目构建。我们有几个组件，它们既提供其他组件使用的东西，也使用其他组件的东西。开发人员应该能够签出 1 个组件并进行更改，而无需构建世界。项目外部的依赖项应该自动引入。因此，某种能够将构建的对象推送和拉取到服务器的方法对此至关重要。另一个方面是能够将所有依赖项下拉到本地目录以便在路上进行开发。

2.  不要担心事情是如何构建的。这可能听起来很奇怪，但我不希望构建系统担心编译我的代码。已经有很好的工具可以为每种语言执行此操作——Ant、CMake 等。我只想告诉它调用什么来构建东西，以及它应该关心什么输出。这样，项目 A 可以是 Java，项目 B 可以是 C++，你明白了。

3.  有一些方法可以在输出上运行测试

4.  在网页上显示当前的构建/测试结果

5.  通过电子邮件发送结果

6.  与 RCS 集成（我们使用 svn）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T20:39:06.047

Apache 的[Continuum](http://continuum.apache.org/)和 Atlassian 的[Bamboo](http://www.atlassian.com/software/bamboo/)将遇到 #2-6。

以与语言无关的方式执行 #1 有点困难。

[Maven](http://maven.apache.org/)和[Ivy](http://ant.apache.org/ivy/)都适用于 Java 依赖项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T20:39:47.137

我使用了[Visual Build](http://www.kinook.com/VisBuildPro/)，我发现它是一种非常有用的方法，可以将所有这些不同的编译器、测试运行器和其他东西结合到一个灵活的系统中。想想主要类固醇上的 Windows 调度程序。它基本上是一个大型任务执行引擎，包含所有主要商业源代码控制系统、编译器等的现成任务。它可以通过一个相当简单的用户界面创建文件夹、发送电子邮件和许多其他事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T20:53:22.243

我研究过但从未使用过 AntHill。有[开源](http://freshmeat.net/projects/ant8/)版和[商业版](http://www.anthillpro.com/html/default.html)。我认为它会做你想做的事，但如果你给出更多的要求会很有帮助，比如它是否需要做自动化的隔夜构建，你用于源代码控制的东西等等。

在我现在的公司，我自己写。我的工作方式正是你所说的；它不知道如何构建软件。你给它一堆命令行来运行（存储在数据库中），它捕获退出值以及标准输出和标准错误，如果退出值非零，它会将构建标记为损坏。我们有大约 8 个项目可以构建和运行单元测试。所有这些都是从擦除目录并从颠覆中获取源代码开始的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T15:29:59.710

亚当，

我注意到蚁丘的反应，作为蚁丘，我不得不说他是对的。Anthill 做得很好的一件事是让您定义项目之间的依赖关系。开源版本专注于 Java，而商业工具与语言无关，尽管名称如此。

它将允许您根据状态（最新成功构建，或 QA 批准的最新构建或......）和/或内部版本号或分支等标准定义项目（或项目的一部分）之间的依赖关系。这是我们非常自豪的事情。在构建时，构建工件在服务器之间穿梭，缓存被保留以提高性能，以及所有这些好东西。

至于其他标准：
2) Anthill（像大多数构建自动化工具一样）将运行您现有的构建脚本，通常无需修改。
3) 测试（同样是您现有的技术）可以在构建时运行，或者针对现有构建运行。
4) 结果显示在网络上（同样是构建自动化工具的典型特征）
5) 电子邮件很容易
6) 我们有几十个 SCM 集成，并且在内部使用 SVN，因此集成自然是我们最好的之一。

干杯，

埃里克

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T21:11:53.033

以下是适用于 .NET 和其他语言的工具的简短列表： [自动构建工具](http://wewillrulethegalaxytogether.blogspot.com/2008/07/automated-build-tools.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-15T18:27:56.327

如果您要编写一个测试系统，我建议您考虑使用[Test Anything Protocol](http://en.wikipedia.org/wiki/Test_Anything_Protocol)。TAP 已经使用了 20 多年，并且被广泛使用，尤其是对于 CPAN 模块。

TAP 的一般格式是：

```
1..N
ok 1 Description # Directive
# Diagnostic
....
ok 47 Description
ok 48 Description
more tests.... 
```

例如，测试文件的输出可能如下所示：

```
1..4
ok 1 - Input file opened
not ok 2 - First line of the input valid
ok 3 - Read the rest of the file
not ok 4 - Summarized correctly # TODO Not written yet 
```

获取更多信息，请访问[testanything.org](http://testanything.org/)。

*示例从[http://en.wikipedia.org/wiki/Test_Anything_Protocol复制](http://en.wikipedia.org/wiki/Test_Anything_Protocol)*

# .net - silverlight 支持远程处理吗？

> ID：291253
> 
> 赞同：5
> 
> 时间：2008-11-14T20:15:33.770
> 
> 标签：.net, silverlight, remoting

silverlight 是否支持 .net 框架的远程处理功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-14T23:04:25.567

由于在主机 Web 浏览器中被沙盒化的安全要求，不支持二进制序列化。所以不，不支持.NET Remoting。谢天谢地，我们有一个相当充足的 WCF 实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T20:25:05.310

没有完全像完整的 .NET 框架那样实现，不。但如果您需要这种级别的通信，Silverlight 支持 Sockets。

# html - 无法在 Internet Explorer 中加载对象元素

> ID：291259
> 
> 赞同：2
> 
> 时间：2008-11-14T20:17:00.990
> 
> 标签：html, internet-explorer

我有一个用于嵌入控件的 HTML 文档。在某些情况下，IE 无法加载标签中的控件并加载我的替代文本。

唯一的问题......我不知道它为什么会失败。它不会在左下角的感叹号中显示为错误。我覆盖了该`window.onerror`方法，但没有被解雇。我在事件日志中看不到任何内容。

我如何获得任何类型的反馈来找出我的问题是什么？IE 可以进入“详细模式”吗？某处是否有一些神奇的错误日志告诉我为什么我的对象没有加载到 IE 中？

谢谢，布赖恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-15T18:27:11.070

听起来您正在寻找的是 IEHost 日志记录。从下面的链接中逐字记录，如何激活它的简短形式是：

1.  单击开始，单击运行，键入 regedit，然后单击确定。
2.  找到并单击以下注册表项：*HKEY_LOCAL_MACHINE\Software\Microsoft.NETFramework*
3.  *向该键添加一个名为DebugIEHost*的 DWORD 值；为其分配任何非零值。
4.  添加一个名为*IEHostLogFile*的字符串值。为其指定要在其中记录调试跟踪的文件的完整路径（包括文件名）（例如，C:\Temp\IEDebug.log）。

完整的详细信息可以在Microsoft 的[KB313892](http://support.microsoft.com/kb/313892)中找到。

**添加：**作为一般规则检查的另一件事是是否在区域的浏览器安全设置中启用了“运行组件（未使用 Authenticode 签名）”。如果禁用此选项，则 IE 主机 DLL 不会被加载，并且上述步骤不会为其创建日志。鉴于您最初的问题提到没有迹象表明应该发生其他事情，我想知道是否是这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T21:45:27.503

开始查看您的 IE 区域安全设置。

将本地 Intranet 与 Internet 进行比较。您的安全设置很可能会阻止对象运行。

您也可以关闭正在运行的任何类型的 AV 程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T21:09:07.140

对象标签中的错误通常不会显示为 IE 错误，因为对象是从其自己的插件代码库运行的，而不是浏览器的解释器。

你是在本地加载这个文件吗？或者它是一个托管页面？IE 对对象的执行具有不同的权限。对象的类型是什么？代码片段也会有所帮助。

您还可以使用诸如 Charles Web Debugging 代理之类的东西来查看浏览器是否正在尝试连接到文件名。如果不是，您知道这是代码问题，但如果它正在调用，您可能会看到 HTTP 标头中返回的内容 - 服务器错误（404、500？）、空白等。

# ruby-on-rails - 导轨和窗户

> ID：291270
> 
> 赞同：2
> 
> 时间：2008-11-14T20:19:42.047
> 
> 标签：ruby-on-rails, ruby, netbeans, radrails

Rails 开发在 Windows 上真的这么难吗？我是一名期待使用 Rails 的 PHP 开发人员（主要是因为我尝试过的每个 PHP 框架都有一些我讨厌的怪癖）。

我下载了 Aptana Studio（带 RadRails），因为它似乎是一个很好的解决方案（而且因为我喜欢任何基于 Eclipse 的东西）。但这就是问题的开始——在创建一个项目（称为“test”，使用 sqlite3）时，我遇到的第一个问题是一些“sqlite3 is missing”错误。所以我谷歌了一下，用 gem 安装了 sqlite3-ruby。我仍然有一些错误 - 但不知何故设法修复它。所以它似乎有效，但真的是这样吗？一些似乎几乎无法工作并且存在很多问题的环境（[请参阅此](https://stackoverflow.com/questions/164896/limitations-in-running-rubyrails-on-windows)）？

在其他一些问题中，我看到了在 VM 中运行项目并从 Windows 编辑它的建议。听起来是个好主意——但两个主要的 Rails IDE（RadRails、NetBeans，除非还有更多）似乎想在 Windows 中运行自己的服务器。对他们来说最好的设置是什么/如果我在 VM 中运行 Linux Rails 堆栈，我将如何在其中设置项目？

请注意，我宁愿在没有 IDE 的情况下工作——在尝试使用 PHP 时，我立即完全依赖（叹息）它们——而且由于我以前从未真正使用过 Ruby（或 Rails），因此代码完成将是一个主要帮助。

那么你有什么建议呢？在 VM 中的 Windows 或 Windows 和 Linux 堆栈中运行？还有其他提示吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T20:31:03.520

我的建议是购买[Agile Web Development with Rails](https://rads.stackoverflow.com/amzn/click/com/0977616630)并像教程一样使用它，跟着本书一起学习。如果您有一台 Windows 机器，请使用它。确保你有一个你喜欢的文本编辑器。这应该会让您继续前进，并从那里您可以对 IDE 等做出更明智的决定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T20:59:50.123

如果你想在 Windows 上测试 Rails，一个简单的开始方法是安装 [InstantRails](http://instantrails.rubyforge.org/wiki/wiki.pl)，它有你开始需要的一切

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-15T04:41:32.827

你的问题不在于 Windows。我已经在 Windows 上做 Rails 2.5 年了，没有任何重大问题。我发现它比 Solaris 上的 Rails 更容易。

我认为 Aptana RadRails 的边缘仍然有些混乱。您没有提及是否遵循了他们的[安装说明](http://aptana.com/docs/index.php/Installing_RadRails_on_Windows_Vista)。第一步是安装一个 ruby​​ 堆栈，例如 RubyStack 或[XAMPP](http://www.apachefriends.org/en/xampp.html)。如果你这样做了，你可以运行 MySQL DB 而不是 sqlite3。

我强烈不同意您对它不起作用的评估，因为它没有在您的下载中包含 sqlite3。宝石是您向环境中添加内容的基本方式。一旦你掌握了安装你需要的东西（gem install xxx）的窍门，这没什么大不了的。从命令行很容易，IDE实际上更复杂。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-15T11:39:20.520

老实说，如果您必须跳过的唯一障碍是安装 gem（无论是否使用 Rails，Ruby 的基本知识）和下载 SQLite，那么我建议您已经获得了非常轻松的体验！如果您想要一些乐趣，请尝试让 Oracle 工作！

FWIW，我大部分工作日都幸运地使用了 Ruby 和/on Rails。我在 Windows 桌面环境中工作（但部署到严格控制的 Linux 环境，这很有趣），老实说，我对一键式 Windows 安装程序中提供的 Scite 编辑器非常满意。我花了一些时间来配置诸如字体、颜色和缩写之类的东西来提高工作效率，而且大部分时间都不会影响我的工作，这很好。

如果您花时间学习如何以 Ruby“风格”工作，那么智能文本编辑器就足够了。我只在需要调试器时才使用其中一个 IDE，如果您编写测试驱动的代码，那么调试器非常罕见。（我不是反 IDE，顺便说一句，我不会考虑在没有 Visual Studio 的情况下接触 C# 程序）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-15T19:41:51.513

我真的推荐从[InstantRails](http://rubyforge.org/frs/?group_id=904)开始。它很快，让您在 2 分钟内开始编码，这是提取档案的时间。

我们公司有 3 名开发人员在 Windows 上使用 RoR。我们开始使用[InstantRails](http://rubyforge.org/frs/?group_id=904)。最终我们都用[Ruby One Click Installer](http://rubyforge.org/frs/?group_id=167)和[MySQL](http://dev.mysql.com/downloads/mysql/5.0.html#downloads)替换了它，所以我们可以使用相同的数据库而不是在本地托管。设置完这些之后，您需要安装 Rails，这可以从命令提示符处完成：

```
gem install rails 
```

我们刚刚更改了 database.yml 文件，所有现有代码的运行都与以前完全相同。

我们使用两个编辑器[e](http://www.e-texteditor.com/)进行常规工作，使用[NetBeans](http://www.netbeans.org/downloads/index.html)进行调试。我发现 NetBeans 的自动完成功能非常缓慢，而且用处不大。

开发进展顺利，windows没有问题。我列出的唯一要花钱的是[e](http://www.e-texteditor.com/)，但是 Ruby 附带的免费 Scite 编辑器也可以很好地工作。

编辑：另外，[Agile Web Development](http://pragprog.com/titles/rails2/agile-web-development-with-rails) PDF 是一个重要的工具。我喜欢 Visual Studio 中的自动完成功能，但拥有这本书是 Rails 的下一个最佳选择。尤其是 PDF，因为该索引具有可点击的链接，可将您直接导航到您要查找的内容。它也需要花钱，但完全值得。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-15T02:40:07.770

我使用 RadRails 作为我的 IDE，并使用运行服务器堆栈的[WAMP 。](http://www.wampserver.com/en/)我喜欢它。InstantRails 也可以解决问题。

还有其他一些事情：[David Heinemeier Hansson](http://loudthinking.com/posts/30-myth-1-rails-is-hard-to-deploy)实际上建议使用[Phusion Passenger](http://www.modrails.com/)，这使得 Rails 部署非常简单。值得一试。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-20T14:38:40.063

正如另一个答案中的人所说，您实际上有过非常轻松的经历。

我从事基于 Windows 的 RoR 开发已经有好几年了，并且已经学会了适应这些特性。我使用带有 Aptana 的 Eclipse 作为插件，而不是独立的 Aptana，因为独立的 Aptana 对 git 的支持为零，并且插件有一点（见下文）。如果您从未使用过 Unix 或 Linux，那么我会说学习在 Windows 上处理 Rails 比从头开始学习 Unix/Linux 更容易。

话虽如此，我可以想到两个方面，在 Windows 上停留变得越来越难。

1.  没有可用的本机二进制文件的 Gems 升级到您使用的没有人为其构建本机 Windows 二进制文件的 gem 将不可用。我最近处理过的一个是 hpricot。发布“宝石升级”会破坏这些宝石，因为它会拉下源并尝试构建它。您将需要安装 Visual C++ 版本 6 或 MinGW（连同 MinGW 套件构建的 Ruby）来解决此问题。没什么大不了的——我找到了一个 VC6 种子，安装、配置、调整，现在没有问题了。但这是一个麻烦，占用了我一两天的时间。

2.  Git 支持 Windows 上的 Git 是不完善的，没有办法绕过它。Rails/Ruby 世界中的所有内容都将使用 Git，这是有充分理由的，所以这很重要。

2 是什么促使我切换到 Linux 作为我的开发平台，在我的桌面上的 VirtualBox 和我的笔记本电脑上的本地。但是，我对 Unix/Linux 非常熟悉，所以这对我来说并不是一个大的改变。如果您对 Linux 感到满意，那么是的，您可能需要考虑切换。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-11-19T04:44:33.197

据我所知，[InstantRails](http://rubyforge.org/projects/instantrails/)不再受支持，[BitNami RubyStack](http://bitnami.org/stack/rubystack)是当前与 InstantRails 最相似的项目。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-03T08:15:56.343

我知道这听起来可能很激进，而且它可能不是你的选择。但它并没有你想象的那么激进：我所做的是买了一台 Mac！这是惊人的，因为使用 VMWare Fusion 或 Parallels（我认为 Parallels 在最新版本中更好），Mac 是在其上进行 Windows 开发的*出色机器。*

我每天都在我的 Mac 上的虚拟机上进行 Visual Studio 开发（和许多其他人一样），没有任何问题。如果您不知道，Mac 现在运行在 Intel 上，所以在硬件层面上，Mac 与 Dell 没有太大区别（除了硬件质量要高得多......但我不想开始说教）。

Mac 的 OS X 是基于 Unix 构建的。我一直在做 Ruby 开发（TextMate 是我选择的编辑器）。

真的，我认为 Mac 是运行*一切*的最佳机器：Windows、Mac OS X 和 Unix。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-14T20:54:53.300

我已经将 Aptana Studio 与 RadRails 一起使用了一段时间，并且已经非常习惯了。我记得它需要一些努力才能顺利运行，但我仍然使用 IDE 和随附的 WebRick 服务器开发了几个应用程序（大小）。它不是最稳定的平台，但正在努力工作，并且随着每个版本的发布而改进。在需要时进行真正的调试非常好。我发现它是一个非常有用的工具，并建议坚持使用它。

对于开发，我在 Windows XP 上使用 MySQL 和 PostgreSQL。我最近尝试将 SQLLite 用于一个新项目……但在遇到一些令人沮丧的问题后，我才回到 MySQL。

我还没有尝试过 Netbeans。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-15T01:41:54.143

就这么难，真的不值得尝试为 ruby​​ 走纯 windows 路线。ruby 性能差，有时原生 gem 兼容性不好等等。

一定要试试 VMWare + Linux 的路线，你的大部分头痛都会消失。我有成功运行此设置的同事，使用 netbeans 作为 IDE 在 windows 和 linux 之间共享源代码。这一切似乎都很成功。

我一开始只使用带有 InstantRails 和 e 文本编辑器的窗口。没关系，有些沮丧，但是在迁移到虚拟化 linux 之后生活变得轻松了很多。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-03T10:12:24.660

我认为 Aptana Studio 是一个很好的 RoR IDE。在启动时，它提供了下载和安装所需 gem（如 sqlite 等）的选项。您可以在控制台窗口中运行 ruby​​ 命令或运行 mongrel 服务器、调试、查看浏览器输出并做任何您想做的事情。我一直在 Windows 中使用带有 mysql gem 和它自己的杂种服务器的 Aptana Studio。工作正常。

# asp.net-mvc - 如何在维护从 ViewData 检索值的同时为 Html.TextBox 助手指定属性？

> ID：291274
> 
> 赞同：36
> 
> 时间：2008-11-14T20:21:10.873
> 
> 标签：asp.net-mvc

我正在使用 Html.TextBox 助手来创建文本框。我想在文本框上设置属性，我理解这是使用以下重载完成的：

`Html.TextBox (string name, object value, object htmlAttributes)`

但是，我想保持 HTML 帮助程序自动使用 ViewData 或 ViewData.Model 中的值的功能，并且我看不到仅指定名称和 htmlAttributes 的方法。这可能吗？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-11-14T20:27:41.420

[编辑] 查看[源代码](http://www.codeplex.com/aspnet/)后，您似乎需要做的就是在带有名称、值和 htmlAttributes 的签名中将值指定为 null。如果值为 null，它将尝试使用 ViewData 中的值。

```
Html.TextBox( "name", null, new { @class = "css-class" } ); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-02-24T07:25:30.593

试试这个剃须刀

```
@Html.TextBox("name", "", new {@class = "css-class", @onclick = "alert('demo');"}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-14T20:32:25.810

如果您不需要提供模型中的值，则始终可以使用标准 HTML：

```
<input type="text" name="fieldName" id="fieldName"/> 
```

然后你可以在标签中提供你需要的任何属性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-12-23T22:59:11.737

@Tvanfosson，感谢您的回答。今天帮了我很多忙。我试图为列表中的每个部分创建一个包含一行的表。我想根据每个部分设置几个属性，你指出了我正确的方向。如果有人想查看循环以及如何设置多个属性，请执行以下操作：

```
 <% foreach (var poPart in Model.myPartsList)
       { %>
         <tr>
             <td>
                <% var part = Model.PartID; %>
                <%: Html.TextBox(part.ToString(), null, new { @class = "narrowText", @id = part.ToString() })%>
             </td>
         </tr>
   <% } %> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-17T18:35:03.173

```
 @Html.TextBox("Name", "Value", new {@class = "class1 class2", @customAttributeName = "attributeValue"}) 
```

# c# - TAPI 版本控制

> ID：291278
> 
> 赞同：4
> 
> 时间：2008-11-14T20:21:59.887
> 
> 标签：c#, .net, tapi

使用 C# 获取 TAPI 版本和其他 TAPI 信息的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T10:29:59.550

互操作。

使用 lineInitializeEx 函数的*lpdwAPIVersion*参数。 [http://msdn.microsoft.com/en-us/library/ms735983(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms735983(VS.85).aspx)

“成功完成此请求后，此位置将填充 TAPI 支持的最高 API 版本，从而允许应用程序检测并适应已安装在具有不同 TAPI 版本的系统上。”

当您编写 TAPI 时，迟早您将不得不开始使用互操作调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-30T12:30:50.970

还有一些很棒的库和控件（例如一组 ActiveX 控件）可以使 TAPI 编程变得非常容易。处理 API 级代码、PInvoke、回调等可能非常乏味。您可以进行快速在线搜索，看看其中一个选项是否适合您。

# jakarta-ee - Java EE 入门

> ID：291279
> 
> 赞同：23
> 
> 时间：2008-11-14T20:22:07.923
> 
> 标签：jakarta-ee

我即将开始一个 Web 项目，并且在过去的 5 年中几乎只使用 LAMP 堆栈。我想构建更大、更具可扩展性的东西，因此一直在研究 Java EE。JSP 和 EJB 之间的逻辑划分似乎非常适合我想做的事情。

任何人都可以推荐熟悉 Java EE 的资源吗？也许如果有人知道我也应该考虑比 PHP 更具可扩展性的技术，我会全神贯注。

非常感谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-01T20:24:26.523

我强烈建议从一本好书开始。这是一个复杂的话题，即使是经验丰富的开发人员也需要一些帮助才能开始。

我还建议一开始就熟悉非 Sun 技术。使用 Hibernate 和 iBatis 等框架比使用实体 Bean（即使在新的 Java EE 标准中）更容易实现数据库持久性。看看像 Spring 和 Guice 这样的依赖注入框架。事实上，Spring 提供的不仅仅是依赖注入（面向方面​​的开发、Web 服务框架、MVC、JDBC 和 JMS 的包装器）。

另一个重要的事情是IDE的选择。在自由世界中，您可以使用 Eclipse（Java EE 版）或 NetBeans。两者都很好，我发现 NetBeans 有点慢，但越来越好。我还推荐 Tomcat 作为应用服务器。尽管它没有完全实现 Java EE 标准（没有 EJB），但有些事情是您不能做的。完整的应用服务器是 RedHat 的 JBoss 和 Oracle 的 GlassFish。GlassFish 很好地集成在 NetBeans 中（与 Sun 以前的应用程序服务器无关 - 它快速且可靠）。

**编辑**

The question about JEE books is now closed. Answers suggested [http://www.theserverside.com/](http://www.theserverside.com/), [J2EE: The Big Picture](http://www.amazon.com/J2EE-1-4-Picture-Solveig-Haugland/dp/product-description/0131480103) and [Manning publications](http://www.manning.com/), for books like "Spring in Action" and "Java Persistence with Hibernate". I am sure there are now more good books available.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-16T19:11:07.707

我个人是 Sun 官方教程的忠实粉丝，即使我熟悉基本主题。我发现它们非常适合浏览和查看相关内容和不相关内容，并且它们可以在线免费获得。

它们的唯一问题是它们不涵盖常见的工具和库，因此一旦您了解了基础知识，请寻找 Java EE 最佳实践和工具。

此外，跳过 Sun 应用程序服务器，直接使用 Tomcat 和 JBoss。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T18:53:20.237

我认为鉴于您在 Linux 和 MySQL 方面的背景，最好的起点是 Java 的[Servlet API](http://java.sun.com/products/servlet/)。Java Servlet 是 Java EE 中用于在服务器端处理 HTTP 请求和响应的基本单元。在我完成的大部分 Java EE 工作中，servlet 覆盖了大约 50% 的开发。另外 50% 是数据库开发，您过去似乎做过。

对于您的 servlet 容器，我会推荐[Apache Tomcat](http://tomcat.apache.org/)。Tomcat 有一个强大的开发社区定期做出贡献，并被用作多个企业应用程序服务器解决方案的核心，例如 JBoss。

祝你的项目好运！

# java - Java 未正确将字符串转换为长对象

> ID：291286
> 
> 赞同：2
> 
> 时间：2008-11-14T20:24:52.487
> 
> 标签：java, hibernate, spring, websphere, aix

我们在 AIX 的 Websphere Application Server 上使用 Spring/Hibernate。在我的 Windows 机器上，该问题不会发生——仅在运行 AIX 时才会发生。当用户使用帐号登录时，如果他们在登录 ID 前加上“0”前缀，则应用程序会拒绝登录。在 DB2 表中，该列是数字类型，将 '090....' 转换为 '90...' 应该没有问题

还有其他人遇到过这样的问题吗？两台机器都有 Java v1.5。

更具体地说，流程是 FormView -> LoginValidator -> LoginController

在 LoginValidator 中，login 的值为 null 并带有前缀 0。没有 0，该值就是它应该是的值（但同样，这仅在 AIX 环境中——在 2 个 Windows 环境中它很好）。这是对象等于 null 的代码片段。

```
public class LoginValidator implements Validator  {

    public boolean supports(Class clazz) {
    return Login.class.equals(clazz);
    }

    @SuppressWarnings("all")
    public void validate(Object obj, Errors errors) {
        System.out.println("Inside LoginValidator");
        Login login = (Login) obj;
        //null value
        System.out.println("Before conversion in Validator, store id = " 
              + login.getStoreId()); 
    }
} 
```

我还编写了这个简短的 Java 程序，用于从字符串构造一个 Long，并使用与 WebSphere 一起打包的 java 二进制文件

```
public class String2Long {
    public static void main(String[] args){
        String a = "09012179";
        String b = "9012179";

        Long _a = new Long(a);
        Long _b = new Long(b);

        System.out.println(a + " => " + _a); //09012179 => 9012179
        System.out.println(b + " => " + _b); //9012179 => 9012179
        System.out.println("_a.equals(_b) " + _a.equals(_b)); //_a.equals(_b) true
    }
} 
```

# [解决方案](https://stackoverflow.com/questions/291286/java-not-converting-string-to-long-object-properly#292709)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T20:26:49.300

好吧，那里发生了很多事情。您确实需要尝试隔离问题 - 找出发送到数据库的内容，Java 看到的内容等。

尝试将其固定在一个简短但完整的程序中，该程序*仅*显示问题 - 然后您将处于一个更强大的位置来提交错误或修复您的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-15T16:09:47.790

# 解决方案

一位同事对 Spring 更新做了一些研究，显然这个错误在 v. 2.5.3 中是正确的：

> CustomNumberEditor 将带有前导零的数字视为十进制（删除了不需要的八进制支持，同时保留了十六进制）

我们使用的是 Spring 2.0.5。我们只是用 Spring 2.5.4 替换了 jars，它就可以正常工作了！

感谢大家的帮助/帮助。我们将来会使用单元测试，但这只是一个 Spring 错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T20:33:52.377

沿着字符串的路径跟踪程序一直到数据库，并对该路径上的每个方法进行单元测试。并且不要只在这里采取最短的路线，使用不同的输入和预期输出进行多个单元测试，以真正了解可能出了什么问题。假设您没有发现任何错误，请在另一台计算机上运行相同的单元测试，您应该能够查明错误。从我的脑海中，我认为这可能与区分大小写有关，但实际上无法确定。

下一次，使用 TDD。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T22:03:57.890

我对 Java 不太了解，但由于前导“0”，字符串可能会被解释为八进制字符串。

您可以使用 Long.parseLong(a, 10) 来解决这个问题。

# security - MVC 应用程序中的安全和访问控制

> ID：291294
> 
> 赞同：5
> 
> 时间：2008-11-14T20:27:22.937
> 
> 标签：security, model-view-controller, access-control

我最近才开始使用 MVC 方法，所以我想这对你们大师来说是一个简单的方法：

**我在哪里设置访问控制？**

1.  在视图中？除了模板中的开关和标志之外，我不想有任何逻辑，所以这听起来像是最不可行的选择
2.  在模型中？每个业务对象是否应该根据谁的要求来决定它将显示哪些关于自身的数据？
3.  在控制器中？这就是我现在拥有的地方，但它很难保持业务规则的一致性

或者还有其他选择吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-15T21:23:30.543

这将取决于您使用的框架，并且语言将决定您可以使用的许多工具。

从高层次上讲，您应该在入口点配置访问安全性。并且您应该仔细检查每个级别的访问安全性，这些级别可能被认为是自主的或从应用程序的多个部分重用（谁知道是否由使用您的逻辑层的同事的门户检查了安全性？等等）。要担心的另一件事是数据安全性，它属于尽可能接近您的数据（所以，对上面的#2 是的，但要理解它是分开的）。

这类似于我喜欢谈论的应用程序逻辑和域逻辑之间的区别。如果有任何特定于特定应用程序的逻辑（Web 应用程序与 Windows 服务相比，或其他），则该逻辑应仅在该应用程序中定义。如果某些逻辑跨越了应用程序之间的边界（在应用程序之间可重用），那么它就有资格作为域逻辑并且应该在您的模型中定义。您的应用程序可以使用域逻辑，但它们不应该拥有它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-16T16:45:57.173

对于模型（又名数据）安全性，模型将“控制”访问，而控制器将“促进”访问。这提供了独立于控制器的模型的重用，并最小化（如果不是否定）跨使用模型的不同控制器所需的通用代码复制。

例如汽车、司机和钥匙。（分别为模型、控制器、API）。凭借非常小的接口（密钥 == API），模型允许或拒绝每个 API 的控制器访问（密钥卡）。允许不同类型的访问（代客钥匙、所有者钥匙、所有者 FOB）。使用代客钥匙界面，控制器将无法访问模型的某些数据/功能，例如手套箱、行李箱和油箱。这本质上是模型通过识别和分类具有非常小的 API/命令表面积的控制器来实现的基于角色的访问。

这意味着模型可以被其他控制器（具有不同驱动程序的汽车）使用，这些控制器只需要基本的身份验证就可以访问模型的数据（汽车的功能和车厢）。

# jquery - jQuery 和 Safari

> ID：291304
> 
> 赞同：1
> 
> 时间：2008-11-14T20:29:56.033
> 
> 标签：jquery, safari, siblings

我在使用 JQuery 和 Safari（Windows 版本）时遇到问题。该代码适用于 FF/IE7/Chrome，但不适用于 Safari。

我有一个简单`<li>`的`<div>`嵌入到 - 单击`<li>`应该暴露隐藏的`div`，但不是在 Safari 中。

的HTML：

```
<ul>
<li>something</li>
<li>something2</li>
<li class="more">
        <a href="" class="moreFacetsLink">Click to see more options</a>
        <div class="moreFacets">bunch of text</div>
</li>
</ul> 
```

这是JQuery代码：

```
 $('.moreFacetsLink').click(function () {

        $(this).siblings('div').toggle();
     }); 
```

关于这里可能发生的事情有什么想法吗？再次 - 这似乎适用于所有其他浏览器！

我是 JQuery 的新手。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T21:04:43.763

How accurate is your HTML pasting?

You never closed your "moreFacetsLink" anchor tag, which probably makes Safari think that it was implicitly closed, and the "bunch of text" is surrounded by an additional, HREF-less Class-less Unclosed anchor tag... evidenced by the fact that this:

```
$(".moreFacetsLink").click(function () {
    $(this).siblings("a").children("div").toggle();
}); 
```

... does what you want with your submitted markup.

Close off your anchor tag properly (bonus points for including the href attribute) and you should be good to go.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T10:56:21.173

href="" 在 safari 中重新加载您的页面
我会尝试使用 css 为其添加下划线和样式，然后删除空的 href。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-08T20:40:47.050

我很确定您需要`return false;`从点击功能中取消链接点击。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-04T17:25:33.743

首先，您需要检查浏览器是否正在回发，如果是这样，您可以像这样避免它

```
$('.moreFacetsLink').click(function (e) {
    e.preventDefault(); // this prevent postback

    $(e.target).siblings('div').toggle();
}); 
```

试试这个：`$(e.target)`而不是这个，`$(this)`
这可能是一种不同的方式

希望这可以帮助

# mysql - 将十六进制值插入mysql

> ID：291305
> 
> 赞同：2
> 
> 时间：2008-11-14T20:29:58.810
> 
> 标签：mysql, hex

有什么方法可以将十六进制值插入 MYSQL 吗？我还希望能够以十六进制形式检索它。

例如，类似： INSERT INTO table ( hexTag ) VALUES ( HEX(0x41) );

如果我这样做，我希望它在表格中添加一个“A”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T20:42:20.673

对于该特定用例，您可以直接插入十六进制值并将其解释为字符串，或者使用 HEX() 输入和 UNHEX() 输出

```
mysql> 创建表 hexTable(pseudoHex varchar(50));
查询正常，0 行受影响（0.01 秒）

mysql> 插入 hexTable 值（0x41）；
查询正常，1 行受影响（0.00 秒）

mysql> 从 hexTable 中选择 *；
+-----------+
| 伪十六进制 |
+-----------+
| 一个 |
+-----------+
一组中的 1 行（0.00 秒）

mysql> 从 hexTable 中选择 HEX(pseudoHex)；
+----------------+
| 十六进制（伪十六进制） |
+----------------+
| 41 |
+----------------+
一组中的 1 行（0.00 秒）

mysql> 从 hexTable 中删除；
查询正常，1 行受影响（0.00 秒）

mysql> 插入 hexTable 值 (HEX('A'));
查询正常，1 行受影响（0.00 秒）

mysql> 从 hexTable 中选择 UNHEX(pseudoHex)；
+------------------+
| UNHEX(伪十六进制) |
+------------------+
| 一个 |
+------------------+
一组中的 1 行（0.00 秒）

mysql> 从 hexTable 中选择 *；
+-----------+
| 伪十六进制 |
+-----------+
| 41 |
+-----------+
一组中的 1 行（0.00 秒）

```

请参阅[这些](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_hex) [链接](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_unhex)。

# php - 为自定义博客条目修改 WordPress 的“post-new.php”文件

> ID：291310
> 
> 赞同：1
> 
> 时间：2008-11-14T20:30:38.560
> 
> 标签：php, wordpress, drupal, content-management-system

有没有人在他们的 WordPress 安装中修改过“post-new.php”文件？

我想修改此页面的外观以包含我通常包含在我的博客文章中的部分，我只是不知道它是否可行/容易/值得我花时间。

我应该只找到另一个像 Drupal 这样允许更多修改的 CMS 吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-14T20:39:34.080

没有理由修改核心文件 - 您可以通过插件添加内容。例如，查看[更多字段插件](http://wordpress.org/extend/plugins/more-fields/)- 它添加到新/编辑帖子表单中，而不会破坏您升级核心安装的能力。

Drupal 很棒，但是如果您专注于写博客，通过插件调整 WP 可能会获得更好的结果。我将 WordPress 用于博客网站，而将 Drupal 用于大多数其他网站。

# visual-studio - 如何在 Visual Studio 中导出/导入工具栏

> ID：291311
> 
> 赞同：21
> 
> 时间：2008-11-14T20:30:47.937
> 
> 标签：visual-studio, visual-studio-2008, settings

我在 Visual Studio 中导出我的设置，如果我移动到新机器或遇到问题，我会使用这些备份的设置将 Visual Studio 恢复到我喜欢的方式。它还允许我在我使用的各种机器之间保持一致的开发环境。

**这对于键绑定、语法高亮、用户工具以及除了工具栏位置**和**自定义**之外的几乎所有内容都非常有用。每当我移动到新机器并恢复设置时，工具栏都不会受到影响。我花了相当多的时间使用我的宏、外部工具等设置工具栏，并为它们剪切'n'粘贴的图标。我讨厌失去所有的工作。

有谁知道如何备份和恢复工具栏的位置和自定义？如果它不是 Visual Studio 的功能，是否有一个插件可以完成这项工作？

**编辑**

如下所述，*导入和导出设置*中的*菜单和命令栏自定义*应该这样做，但是当我重新导入以前的设置时，我得到

 *> 错误 1：菜单和命令栏自定义：不支持正在导入的命令栏设置版本。所有命令栏设置都已被忽略。

我尝试重新导入的设置在本月早些时候使用相同版本的 Visual Studio 导出。唯一的区别是我现在运行的是 64 位而不是 x86。我不认为这会有所作为，因为设置文件是 XML。

有任何想法吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-19T16:53:18.747

我终于找到了解决方案。[Visual Studio 中](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=105493)有一个已知的错误，并且[给出了两种解决方法](http://connect.microsoft.com/VisualStudio/feedback/Workaround.aspx?FeedbackID=105493)。第一个解决方法不适用，但第二个有效。

要备份您的工具栏：

> 将文件**CmdUI.PRF**从路径**%AppData%\Microsoft\VisualStudio\XY\1033**复制到与导出的 .settings 文件相同的目录。其中**XY 是 8.0、9.0、10.0 或 11.0，**具体取决于您的 Visual Studio 版本（分别为 2005、2008、2010 和 2012）。

要恢复您的工具栏：

> 确保 Visual Studio 已关闭并将备份的文件复制回原始位置。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-20T21:11:43.270

为了其他人的利益，正如您提到的，此功能似乎不受 Visual Studio 版本的支持，大概是因为设置文件的 DTD/XSD 发生了变化？无论如何，自定义工具栏的设置位于“导入和导出设置...”对话框中：

![在此处输入图像描述](https://i.stack.imgur.com/iYOTQ.png)

*注意：您的选项可能看起来不同，具体取决于您导出的设置。*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-15T01:15:04.867

我还没有尝试过，但是“工具\导入和导出设置...”可能会让您导出一个 .vssettings 文件，然后您可以将其带到另一个盒子。

也可以看看

[http://blogs.msdn.com/saraford/archive/2005/04/19/409887.aspx](http://blogs.msdn.com/saraford/archive/2005/04/19/409887.aspx)

和其他 Sara 的“出口”技巧。

# delphi - delphi 2007命令行编译器dcc32.cfg问题

> ID：291326
> 
> 赞同：4
> 
> 时间：2008-11-14T20:35:55.210
> 
> 标签：delphi

我正在使用命令行编译器进行构建。我看到的一个问题是，那里提到的路径似乎需要是文件名的简短版本，以便它们不包含任何空格。尽管我已经使用了一段时间，但我对此了解不多。

我最近升级到 d2009，然后问题就开始了。

有没有办法缩短路径？

我应该说我现在并不急于改变使用 MS Build 工具。我只想构建我的应用程序的旧副本并重新开始其他工作。

这是`dcc32.cfg`文件中用于`-I`、`-U`、`-O`和`-R`参数的路径：

```
$(BDS)\LIB;$(BDS)\Imports;$(BDS)\Lib\Indy10;C:\PROGRA~1\Borland\BDS\4.0\RAVERE~1\Lib;c:\prj\lib\lib2002;C:\DOCUME~1\ALLUSE~1\DOCUME~1\RADSTU~1\5.0\Bpl;c:\DOCUME~1\mike\MYDOCU~1\BORLAN~1\bpl;C:\Prj\Lib\LOCKBO~1\source;C:\Prj\Lib\MyComp;C:\Prj\Lib\ABBREV~1\source;C:\Prj\Lib\ZLib;C:\Prj\Lib\MinMod;C:\Prj\Lib\HELPMA~1;C:\Prj\Lib\DXGETT~1;c:\windows\system32;c:\prj\lib\xpburn;C:\Prj\Lib\WININE~1;C:\Prj\Lib\regexpr\Source;C:\Prj\Lib\VCARDR~1;C:\PROGRA~1\Raize\RC4\Lib\BDS2006;C:\Prj\Lib\jcl\lib\d10;C:\Prj\Lib\jcl\source;C:\Prj\Lib\jvcl\lib\D10;C:\Prj\Lib\jvcl\common;C:\Prj\Lib\jvcl\RESOUR~1;C:\Prj\Lib\ProE6\Delphi;C:\Prj\Lib\FastMM4;C:\Prj\Lib\OPENOF~1;C:\Prj\Lib\DEVELO~1\Library\Delphi11;C:\Prj\Lib\DEVELO~1\EX38D9~1\Sources;C:\Prj\Lib\DEVELO~1\EXBD88~1\Sources;C:\Prj\Lib\DEVELO~1\XPTHEM~1\Sources;C:\Prj\Lib\DEVELO~1\EX2EBC~1\Sources;C:\Prj\Lib\DEVELO~1\EXC5FB~1\Sources;C:\Prj\Lib\DEVELO~1\EX7C7C~1\Sources;C:\Prj\Lib\DEVELO~1\EXPRES~3\Sources;C:\Prj\Lib\DEVELO~1\EXPRES~4\Sources;C:\Prj\Lib\DEVELO~1\EXC73B~1\Sources;C:\Prj\Lib\DEVELO~1\EX7165~1\Sources;C:\Prj\Lib\DEVELO~1\EXPRES~2\Sources;C:\Prj\Lib\DEVELO~1\EXPRES~1\Sources;C:\Prj\Lib\DEVELO~1\EX749C~1\Sources;C:\Prj\Lib\DEVELO~1\EX0A1A~1\Sources;C:\Prj\Lib\Mad\madBasic\BDS4;C:\Prj\Lib\Mad\MADDIS~1\BDS4;C:\Prj\Lib\Mad\MADEXC~1\BDS4;C:\Prj\Lib\Mad\MADKER~1\BDS4;C:\Prj\Lib\Mad\MADSEC~1\BDS4;C:\Prj\Lib\Mad\madShell\BDS4;C:\Prj\Lib\Mad\madShell\DeXter;C:\Prj\Lib\Mad\madExcept\..\Plugins; 
```

我已经从 IDE 的路径中复制了它，就像我在路径中所做的一样，并使用了一个程序来缩短路径名。

尽管该路径中没有空格，但它仍然无法找到 indy's `IdCoder.dcu`at`C:\Program Files\CodeGear\RAD Studio\5.0\lib\Indy10`

根据 d2007 环境变量，`$(BDS)`显然会扩展为`c:\program files\codegear\rad studio\5.0`

IDE 认为此库路径有效。

为什么会这样？我敢打赌这是一个我没有想到的简单错误！

感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T21:10:10.930

您可以尝试将路径放在引号中，这是在 Windows 中处理带空格的路径/文件名的标准方法，尽管我从未在 Delphi DCU 中尝试过。

所以，而不是

```
$(BDS)\Lib\Indy10 
```

尝试

```
"$(BDS)\Lib\Indy10" 
```

你也可以试试

```
"C:\Program Files\CodeGear\RAD Studio\5.0\lib\Indy10" 
```

检查环境变量是否正确。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-15T09:26:21.270

尽管 .cfg 文件在 Delphi 2007 命令行编译器中仍然可以工作，但您确实应该使用 MSBuild 来编译您的项目。IDE 不再使用 CFG 文件。您设置设计时的任何编译器选项都不会写入 .cfg 文件。使用 MSBuild 并不比使用 .cfg 更难。如果您愿意，它会更加灵活，因为您可以更改实际的构建过程。

msbuild YourProject.dproj

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-03-11T20:12:17.330

当您进行编译或构建时，Delphi 实际上会在输出选项卡中为您提供所需的命令行。

1.  在 Delphi 中正常构建您的项目。
2.  在底部会有一个名为“Output”的选项卡，查找显示“Target CoreCompile”的行（在 D2007 中 - 在其他版本中可能不同）。下面的行将是用于构建您的项目的命令行（这就是您想要的）。顺便说一句 - 您不必等待项目完成构建，您可以在完成之前点击取消，因为您需要的只是 DCC32 命令行调用。此外，如果您已经完成了以前的编译，您可能希望在构建之前右键单击并清除输出，这样您就不会有很多“噪音”。
3.  单击该行以突出显示它，然后右键单击该行并选择复制。
4.  打开一个空的批处理文件并粘贴。（警告，线路可能很长）
5.  现在，转到该行的开头，如果您的 DCC32 编译器路径包含空格，那么您需要在 DCC32 调用周围加上引号，不要在参数周围加上引号。
6.  在 DCC32 调用上方插入一行并输入 dos 命令将目录设置为您的 dpr 文件所在的目录，否则 DCC32 会说找不到您的项目。例如。
    `G:` 然后 `cd \Apps\MyProject`
7.  保存批处理文件，您就可以开始了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-15T03:23:07.010

从命令行编译程序时是否设置了 $(BDS) 环境变量？如果不是，那可能就是问题所在。

在包含空格的路径周围加上引号可能会解决空格问题。这对我有用：

-U"C:\库路径\第一个库；C:\库路径\第二个库；C:\库路径\第三个库"

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-15T09:01:42.117

检查当前文件夹中是否有*applicationname* .cfg 文件。Dcc32 将首先尝试从该文件中读取配置。只有当文件不存在时，它才会从 dcc32.cfg 中读取。

# flowchart - 流程图：工具/最佳实践

> ID：291327
> 
> 赞同：6
> 
> 时间：2008-11-14T20:36:49.733
> 
> 标签：flowchart

是否有任何免费的在线工具可以制作 visio 类型的图表。我想练习我的流程图技巧。是否有任何好的网站或书籍或文章讨论流程图的最佳实践。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-14T20:39:34.440

Dia 是一个开源选项： [http ://projects.gnome.org/dia/](http://projects.gnome.org/dia/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T21:44:21.813

Open Office 包含一个名为 Draw 的程序，它非常棒。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-14T22:02:47.190

[已经在这里](https://stackoverflow.com/questions/168512/best-free-professional-looking-uml-tool#168548)回答了；

这里有一些：

*   StarUML - [http://staruml.sourceforge.net/en/](http://staruml.sourceforge.net/en/)（免费）

*   Sparx Systems 的 Enterprise Architect（非免费）

*   [紫色](http://alexdp.free.fr/violetumleditor/page.php)

*   [伞形UML](http://en.wikipedia.org/wiki/Umbrello_UML_Modeller)

*   [ArgoUML](http://en.wikipedia.org/wiki/ArgoUML)

*   [直径](http://projects.gnome.org/dia/)

以下是 50 多个 UML 设计器（免费和非免费）维基百科列表的完整列表：

[http://en.wikipedia.org/wiki/List_of_UML_tools](http://en.wikipedia.org/wiki/List_of_UML_tools)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-16T16:46:38.427

有一个很棒的多平台软件，由于某种原因没有人提到，但它真的值得一试：

yEd：[http ://www.yworks.com/en/products_yed_about.html](http://www.yworks.com/en/products_yed_about.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-14T20:57:32.267

+1 直径。它也是跨平台的，这赢得了我的青睐。Dia 的另一个优点是图表存储在压缩的 XML 中。

我有一个项目，我需要在数据库中绘制一些图表，并且我能够编写一个程序来从数据库创建与 Dia 兼容的 XML，这为我节省了大量的打字和绘图。我只需要重新定位和调整对象的大小。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-14T21:05:38.100

[http://www.umlgraph.org/](http://www.umlgraph.org/)

Found no other better solution. Program your charts. Makes beautiful sequence diagrams.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-03-20T01:46:11.100

[lucidchart](http://www.lucidchart.com)是具有流程图功能的在线协作工具。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-14T21:16:21.090

[Gliffy](http://www.gliffy.com/) is an online flowcharthing program.

Personally I use [Dia](http://projects.gnome.org//dia/), an open source Visio kind of clone (it works under Windows, Linux and MacOSX).

# iphone - 在 Objective-C 中创建视图委托的语法

> ID：291328
> 
> 赞同：3
> 
> 时间：2008-11-14T20:37:46.533
> 
> 标签：iphone, objective-c, cocoa, macos, syntax

我正在尝试为自定义 UIView 创建委托协议。这是我的第一次尝试：

```
@protocol FunViewDelegate
@optional
- (void) funViewDidInitialize:(FunView *)funView;
@end

@interface FunView : UIView {    
@private
}

@property(nonatomic, assign) id<FunViewDelegate> delegate;

@end 
```

这不起作用，因为在 FunViewDelegate 声明时还没有声明 FunView 接口。我曾尝试在@protocol 之前添加原型 ala C++：

```
@interface FunView; 
```

但这只会让编译器发疯。我该怎么做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-14T21:04:28.553

前向类语法是`@class Foo;`，不是`@interface Foo;`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-14T21:03:28.260

您似乎可以转发声明协议：

```
@protocol FunViewDelegate;

@interface FunView : UIView {    
@private
    id<FunViewDelegate> delegate;
}
@property(nonatomic, assign) id<FunViewDelegate> delegate;
@end

@protocol FunViewDelegate
@optional
- (void) funViewDidInitialize:(FunView *)funView;
@end 
```

# ntfs - 如何减小 NTFS 中文件夹索引文件的大 小？

> ID：291336
> 
> 赞同：4
> 
> 时间：2008-11-14T20:41:49.677
> 
> 标签：ntfs

我在 NTFS 中有一个包含数万个文件的文件夹。我已经删除了该文件夹中的所有文件，保存 1。我运行 contig.exe 对该文件夹进行碎片整理，所以现在它仅在 1 个片段中。但是，该文件夹的大小仍然是 8MB。这意味着该指数存在很大差距。这是为什么？如果我删除那个文件，索引的大小会自动变为零。我的猜测是因为它被折叠到 MFT 中。有没有办法让 NTFS 通过根据文件的内容对索引文件进行碎片整理来真正对索引文件进行碎片整理？您知道任何 API 吗？Contig.exe 仅对物理文件进行碎片整理。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-15T10:43:23.580

我想这是 NTFS 就像几乎所有其他 FS 一样的一种方式——它们似乎都不喜欢缩小目录。

所以你应该应用一种涉及使用高级语言“BAT”的高科技方法:)

崩溃.bat

```
REM Invoke as "collapse dirname"
ren dirname dirname.old
mkdir dirname
cd dirname.old
move * ../dirname/
cd ..
rmdir dirname.old 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-27T20:56:50.367

指数有所*松动*，但没有*缺口*。我做出区分是为了暗示技术上浪费了空间，但这并不像 NTFS 必须解析 8MB 才能枚举/查询/无论索引。它知道它的树的根在哪里，而且它恰好有很多额外的分配剩余。考虑到它是多么无用，可能太详细了。

碎片化可能完全是一个单独的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-02T16:02:11.527

看看这个问题的公认答案：[NTFS 性能和大量文件和目录](https://stackoverflow.com/questions/197162/ntfs-performance-and-large-volumes-of-files-and-directories)

作者提供了一些关于文件索引碎片的未记录信息，这些信息是他在事件期间从 Microsoft 技术支持收到的。简短的版本是，DEFRAG 不会对文件夹索引进行碎片整理，只会对该文件夹中的文件进行碎片整理。如果要对文件索引进行碎片整理，则必须使用 SysInternals 的 CONTIG 工具，该工具现在由 Microsoft 拥有和分发（免费）。答案提供了一个指向[CONTIG](http://technet.microsoft.com/en-us/sysinternals/bb897428)的链接。

# c# - 在 C#/.NET 中将参数标记为不可为空？

> ID：291340
> 
> 赞同：109
> 
> 时间：2008-11-14T20:42:28.520
> 
> 标签：c#, .net, parameters, null

是否有一个简单的属性或数据协定可以分配给阻止`null`在 C#/.NET 中传递的函数参数？理想情况下，这还将在编译时检查以确保文字`null`没有在任何地方用于它和在运行时 throw `ArgumentNullException`。

目前我写的东西像......

```
if (null == arg)
  throw new ArgumentNullException("arg"); 
```

...对于我期望不会出现的每一个论点`null`。

同样，是否存在与`Nullable<>`以下情况相反的情况：

```
NonNullable<string> s = null; // throw some kind of exception 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-11-14T20:49:25.480

不幸的是，在编译时没有任何可用的东西。

我最近在我的博客上发布了一个[hacky 解决方案，它使用了新的结构和转换。](https://web.archive.org/web/20081231232311/http://msmvps.com/blogs/jon_skeet/archive/2008/10/06/non-nullable-reference-types.aspx)

[在带有代码合同](http://research.microsoft.com/contracts/)的 .NET 4.0 中，生活会好很多。拥有实际的语言语法和对不可为空性的支持仍然非常好，但代码合同将有很大帮助。

[我在MiscUtil](http://pobox.com/~skeet/csharp/miscutil)中还有一个名为 ThrowIfNull 的扩展方法，它使它更简单一些。

`if (null == arg)`最后一点 - 使用“ ”而不是“ ”的任何理由`if (arg == null)`？我发现后者更容易阅读，而前者在 C 中解决的问题不适用于 C#。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2018-02-08T16:50:00.707

我知道我在这个问题上来得太晚了，但我觉得随着 C# 的最新主要迭代接近发布，然后发布，答案将变得相关。在 C# 8.0 中将发生重大变化，C# 将假定*所有*类型均不为空。

根据 Mads Torgersen 的说法：

> 问题是空引用非常有用。在 C# 中，它们是每个引用类型的默认值。默认值是什么？在您决定分配给它的其他值之前，变量还有什么其他值？在您开始填充之前，我们还可以用什么其他值来铺平一个新分配的引用数组？
> 
> 此外，有时 null 本身就是一个合理的值。有时您想表示一个事实，例如，一个字段没有值。可以为参数传递“nothing”。不过，有时重点是。这就是问题的另一部分：像 C# 这样的语言不允许您在此处表达 null 是否是一个好主意。

因此，Mads 概述的解决方案是：

> 1.  我们认为，希望引用不为空更为常见。可以为空的引用类型会比较少见（尽管我们没有好的数据可以告诉我们多少），所以它们应该需要一个新的注释。
>     
>     
> 2.  该语言已经有了可空值类型的概念和语法。两者之间的类比将使语言添加在概念上更容易，并且在语言上更简单。
>     
>     
> 3.  除非您已经主动决定想要它们，否则您不应该用繁琐的 null 值给自己或您的消费者带来负担，这似乎是正确的。Nulls，而不是没有它们，应该是您明确必须选择加入的东西。

所需功能的示例：

```
public class Person
{
     public string Name { get; set; } // Not Null
     public string? Address { get; set; } // May be Null
} 
```

该预览版适用于 Visual Studio 2017、15.5.4+ 预览版。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-03-07T21:48:38.383

我知道这是一个非常古老的问题，但这里缺少这个问题：

如果您使用 ReSharper/Rider，您可以使用[Annotated Framework](http://www.jetbrains.com/resharper/features/code_analysis.html#Annotated_Framework)。

**编辑**：我刚刚得到一个随机的-1这个答案。没关系。请注意它*仍然*有效，即使它不再是 C#8.0+ 项目的推荐方法（要了解原因，请参阅[Greg 的回答](https://stackoverflow.com/a/48690719/158074)）。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-14T21:23:47.003

查看企业库中的验证器。您可以执行以下操作：

```
private MyType _someVariable = TenantType.None;
[NotNullValidator(MessageTemplate = "Some Variable can not be empty")]
public MyType SomeVariable {
    get {
        return _someVariable;
    }
    set {
        _someVariable = value;
    }
} 
```

然后在您想要验证它的代码中：

```
Microsoft.Practices.EnterpriseLibrary.Validation.Validator myValidator = ValidationFactory.CreateValidator<MyClass>();

ValidationResults vrInfo = InternalValidator.Validate(myObject); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-05T12:50:58.440

不是最漂亮的，但是：

```
public static bool ContainsNullParameters(object[] methodParams)
{
     return (from o in methodParams where o == null).Count() > 0;
} 
```

您也可以在 ContainsNullParameters 方法中获得更多创意：

```
public static bool ContainsNullParameters(Dictionary<string, object> methodParams, out ArgumentNullException containsNullParameters)
       {
            var nullParams = from o in methodParams
                             where o.Value == null
                             select o;

            bool paramsNull = nullParams.Count() > 0;

            if (paramsNull)
            {
                StringBuilder sb = new StringBuilder();
                foreach (var param in nullParams)
                    sb.Append(param.Key + " is null. ");

                containsNullParameters = new ArgumentNullException(sb.ToString());
            }
            else
                containsNullParameters = null;

            return paramsNull;
        } 
```

当然你可以使用拦截器或反射，但这些很容易遵循/使用，开销很小

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2011-10-04T22:09:28.760

好的，这个回复有点晚了，但这是我解决它的方法：

```
public static string Default(this string x)
{
    return x ?? "";
} 
```

使用此扩展方法，您可以将 null 和空字符串视为同一事物。

例如

```
if (model.Day.Default() == "")
{
    //.. Do something to handle no Day ..
} 
```

我知道不理想，因为您必须记住在任何地方都调用默认值，但这是一种解决方案。

# sql - Sql Server查询选择顶部和分组依据

> ID：291343
> 
> 赞同：1
> 
> 时间：2008-11-14T20:43:09.097
> 
> 标签：sql, sql-server, database-partitioning

**配偶表配偶** *ID*

**SpousePreviousAddressesTable** *PreviousAddressID* , *SpouseID* , FromDate, AddressTypeID

我现在所拥有的是更新整个表的最新数据并分配最新数据，而不管 SpouseID 的 AddressTypeID = 1

我想为 SpousePreviousAddresses 表中的每个唯一 SpouseID 分配最新的 SpousePreviousAddress.AddressTypeID = 1。

```
UPDATE spa 
SET spa.AddressTypeID = 1
FROM SpousePreviousAddresses AS spa INNER JOIN Spouses ON spa.SpouseID = Spouses.SpouseID,
(SELECT TOP 1 SpousePreviousAddresses.* FROM SpousePreviousAddresses 
    INNER JOIN Spouses AS s ON SpousePreviousAddresses.SpouseID = s.SpouseID 
    WHERE SpousePreviousAddresses.CountryID = 181 ORDER BY SpousePreviousAddresses.FromDate DESC) as us
WHERE spa.PreviousAddressID = us.PreviousAddressID 
```

我想我需要一个 group by，但我的 sql 并不是那么热。谢谢。

**正在运行的更新**

我之前找到了解决方案是错误的。以下是我要使用的解决方案

```
WITH result AS
(
    SELECT ROW_NUMBER() OVER (PARTITION BY SpouseID ORDER BY FromDate DESC) AS rowNumber, *
    FROM SpousePreviousAddresses
    WHERE CountryID = 181
)
UPDATE result
SET AddressTypeID = 1
FROM result WHERE rowNumber = 1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-14T22:10:42.850

假设您使用的是 SQLServer 2005（基于您从上一次尝试中得到的错误消息），最直接的方法可能是使用 ROW_NUMBER() 函数和公用表表达式，我认为这可能会做你正在找：

```
WITH result AS
(
SELECT 
    ROW_NUMBER() OVER (PARTITION BY SpouseID ORDER BY FromDate DESC) as rowNumber,
    * 
FROM 
    SpousePreviousAddresses
)
    UPDATE SpousePreviousAddresses
    SET
        AddressTypeID = 2
    FROM 
        SpousePreviousAddresses spa
            INNER JOIN result r ON spa.SpouseId = r.SpouseId
    WHERE r.rowNumber = 1
            AND spa.PreviousAddressID = r.PreviousAddressID
            AND spa.CountryID = 181 
```

在 SQLServer2005 中，ROW_NUMBER() 函数是最强大的函数之一。它在很多情况下都非常有用。花在学习上的时间会得到很多倍的回报。

CTE 用于简化代码，因为它不需要某种临时表来存储中间结果。

生成的查询应该快速有效。我知道 CTE 中的选择使用 *，这有点矫枉过正，因为我们不需要所有列，但如果有人想查看查询中发生的情况，它可能有助于显示正在发生的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T21:52:51.157

这是一种方法：

```
UPDATE spa1
SET spa1.AddressTypeID = 1
FROM SpousePreviousAddresses AS spa1 
  LEFT OUTER JOIN SpousePreviousAddresses AS spa2
    ON (spa1.SpouseID = spa2.SpouseID AND spa1.FromDate < spa2.FromDate)
WHERE spa1.CountryID = 181 AND spa2.SpouseID IS NULL; 
```

换句话说，更新`spa1`没有其他行`spa2`存在的具有相同配偶和更大（更近）日期的行。

`SpouseID`与具有相同`SpouseID`.

没有必要使用 a `GROUP BY`，因为连接完成了一种隐式分组。

**更新：** 我认为你误解了`OUTER JOIN`. 如果没有与*所有*`spa2`连接条件匹配的行，则 的所有列都返回为 NULL。这就是外部连接的工作方式。因此，您可以通过测试来搜索没有匹配行的情况。*`spa2.*``spa1``spa2``spa2.SpouseID IS NULL`*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T20:49:27.227

```
UPDATE spa SET spa.AddressTypeID = 1 
     WHERE spa.SpouseID IN (
         SELECT DISTINCT s1.SpouseID FROM Spa S1, SpousePreviousAddresses S2
              WHERE s1.SpouseID = s2.SpouseID 
                  AND s2.CountryID = 181 
                  AND s1.PreviousAddressId = s2.PreviousAddressId
              ORDER BY S2.FromDate DESC) 
```

只是一个猜测。

# asp.net-mvc - 存储库模式与 DAL

> ID：291344
> 
> 赞同：93
> 
> 时间：2008-11-14T20:44:03.103
> 
> 标签：asp.net-mvc, data-access-layer

它们是一样的吗？刚看完[Rob Connery 的店面教程](https://www.asp.net/mvc/videos/mvc-1/aspnet-mvc-storefront/aspnet-mvc-storefront-part-1-architectural-discussion-and-overview)，它们似乎是相似的技术。我的意思是，当我实现一个 DAL 对象时，我有 GetStuff、Add/Delete 等方法，并且我总是先编写接口，以便以后可以切换数据库。

我在混淆事情吗？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2008-11-15T20:26:11.860

你绝对不是那个混淆事物的人。:-)

我认为这个问题的答案取决于你想成为多少纯粹主义者。

如果您想要一个严格的 DDD 观点，那将带您走上一条路。如果您将存储库视为一种模式，它帮助我们标准化了分离服务和数据库的层的接口，它会让您失望。

从我的角度来看，存储库只是一个明确指定的数据访问层。或者换句话说，一种实现数据访问层的标准化方式。不同的存储库实现之间存在一些差异，但概念是相同的。

有些人会对存储库施加更多的 DDD 约束，而另一些人会将存储库用作数据库和服务层之间的便捷中介。像 DAL 这样的存储库将服务层与数据访问细节隔离开来。

似乎使它们不同的一个实现问题是，通常使用采用规范的方法创建存储库。存储库将返回满足该规范的数据。我见过的大多数传统 DAL 将具有一组更大的方法，其中该方法将采用任意数量的参数。虽然这听起来可能是一个很小的差异，但当您进入 Linq 和 Expressions 领域时，这是一个大问题。我们的默认存储库界面如下所示：

```
public interface IRepository : IDisposable
{
    T[] GetAll<T>();
    T[] GetAll<T>(Expression<Func<T, bool>> filter);
    T GetSingle<T>(Expression<Func<T, bool>> filter);
    T GetSingle<T>(Expression<Func<T, bool>> filter, List<Expression<Func<T, object>>> subSelectors);
    void Delete<T>(T entity);
    void Add<T>(T entity);
    int SaveChanges();
    DbTransaction BeginTransaction();
} 
```

这是 DAL 还是存储库？在这种情况下，我猜两者兼而有之。

金

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2008-11-15T19:03:15.570

存储库是一种可以以多种不同方式应用的模式，而数据访问层有一个非常明确的职责：DAL 必须知道如何连接到您的数据存储以执行 CRUD 操作。

存储库*可以*是 DAL，但它也可以位于 DAL 前面并充当业务对象层和数据层之间的桥梁。使用哪种实现将因项目而异。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-03-05T00:01:25.857

一个很大的区别是，DAO 是一种处理域中任何实体的持久性的通用方法。另一方面，存储库仅处理聚合根。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-06-22T21:41:56.470

我正在寻找类似问题的答案，并同意排名最高的两个答案。试图为自己澄清这一点，我发现**如果**与存储库模式齐头并进的规范被实现为域模型的一等成员，那么我可以

*   **重用**具有不同参数的规范定义，
*   **操纵**现有规范实例的参数（例如，专门化），
*   **将它们结合**起来，
*   **对它们执行业务逻辑**，而无需进行任何数据库访问，
*   并且，当然，对它们进行独立于实际存储库实现的**单元测试。**

我什至可以说，*除非*存储库模式与规范模式一起使用，否则它不是真正的“存储库”，而是一个 DAL。伪代码中的一个人为示例：

```
specification100 = new AccountHasMoreOrdersThan(100)
specification200 = new AccountHasMoreOrdersThan(200)

assert that specification200.isSpecialCaseOf(specification100)

specificationAge = new AccountIsOlderThan('2000-01-01')

combinedSpec = new CompositeSpecification(
    SpecificationOperator.And, specification200, specificationAge)

for each account in Repository<Account>.GetAllSatisfying(combinedSpec)
    assert that account.Created < '2000-01-01'
    assert that account.Orders.Count > 200 
```

有关详细信息，请参阅[Fowler 的规范论文](http://martinfowler.com/apsupp/spec.pdf)（这就是我上面的内容）。

DAL 将具有专门的方法，例如

```
IoCManager.InstanceFor<IAccountDAO>()
    .GetAccountsWithAtLeastOrdersAndCreatedBefore(200, '2000-01-01') 
```

您可以看到这很快就会变得很麻烦，尤其是因为您必须使用这种方法定义每个 DAL/DAO 接口*并*实现 DAL 查询方法。

在 .NET 中，LINQ 查询*可以*是实现规范的一种方式，但组合规范（表达式）可能不像使用本土解决方案那样顺畅。[这个 SO Question](https://stackoverflow.com/questions/457316)中描述了一些想法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-05T00:17:03.730

我个人的看法是，这都是关于映射的，请参阅： http: [//www.martinfowler.com/eaaCatalog/repository.html](http://www.martinfowler.com/eaaCatalog/repository.html)。所以存储库的输出/输入是域对象，在 DAL 上可以是任何东西。对我来说，这是一个重要的添加/限制，因为您可以为数据库/服务/任何具有不同布局的内容添加存储库实现，并且您有一个明确的位置可以专注于进行映射。如果您不使用该限制并在其他地方进行映射，那么使用不同的方式来表示数据可能会影响不应更改的地方的代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-15T18:53:26.447

这都是关于解释和上下文的。它们可能非常相似，也可能确实非常不同，但只要解决方案能胜任，名字里有什么！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-05-06T13:27:09.960

存储库是一种模式，这是一种以标准化方式实现事物以尽可能重用代码的方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-09-26T05:00:25.563

使用存储库模式的优点是模拟您的数据访问层，这样您就可以在不调用 DAL 代码的情况下测试您的业务层代码。还有其他很大的优势，但这对我来说似乎非常重要。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-12-29T15:25:50.007

在外部世界（即客户端代码）存储库与 DAL 相同，除了：

(1) 它的插入/更新/删除方法被限制为以数据容器对象作为参数。

(2) 对于读取操作，可能需要简单的规范，如 DAL（例如 GetByPK）或高级规范。

在内部，它与数据映射层（例如实体框架上下文等）一起工作以执行实际的 CRUD 操作。

什么存储库模式并不意味着：-

此外，我看到人们经常感到困惑，除了将插入/更新/删除方法执行的所有内存更改提交到数据库的插入/更新/删除方法之外，还有一个单独的保存方法作为存储库模式示例实现。我们可以在存储库中肯定有一个 Save 方法，但这不是存储库的责任来隔离内存中 CUD（创建、更新、删除）和持久性方法（在数据库中执行实际的写入/更改操作），但是工作单元模式的责任。

希望这可以帮助！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-14T21:43:37.197

据我了解，它们的含义基本相同——但命名因上下文而异。

例如，您可能有一个实现 IRepository 接口的 Dal/Dao 类。

Dal/Dao 是数据层术语；应用程序的更高层考虑存储库。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-15T20:48:44.170

那么在大多数（简单）情况下，DAO 是存储库的实现吗？

据我了解，DAO 似乎精确地处理数据库访问（CRUD - 虽然没有选择？！），而 Repository 允许您抽象整个数据访问，也许是多个 DAO（可能是不同的数据源）的外观。

我在正确的道路上吗？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-01-06T21:16:22.743

有人可能会争辩说，“存储库”是一个特定的类，而“DAL”是由存储库、DTO、实用程序类和其他任何所需的东西组成的整个层。

# mstest - 执行 Visual Studio 2005 Web 测试需要什么？

> ID：291350
> 
> 赞同：2
> 
> 时间：2008-11-14T20:47:18.387
> 
> 标签：mstest, web-testing

我们的测试部门有一系列使用 Visual Studio 2005 Team Tester Edition 创建的 Web 测试。

我希望能够对我的本地机器执行这些测试。我尝试使用 mstest 命令行工具来完成[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms182487(VS.80).aspx)中描述的操作。但我收到以下错误：

> C:\WebTests\Participant>mstest /testcontainer:AE_ActivityDue_Touch.webtest Microsoft (R) 测试执行命令行工具版本 9.0.30729.1 版权所有 (c) Microsoft Corporation。版权所有。
> 
> 正在加载 AE_ActivityDue_Touch.webtest... AE_ActivityDue_Touch.webtest 指定的文件扩展名“.webtest”不是有效的测试扩展名。

关于如何让它工作的任何提示？最终，我们希望将它们纳入我们的 CI 流程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T20:55:19.307

您需要 VSTS 测试版。没有布埃诺。

[http://msdn.microsoft.com/en-us/vsts2008/test/default.aspx](http://msdn.microsoft.com/en-us/vsts2008/test/default.aspx)

# c# - C# 反射索引属性

> ID：291359
> 
> 赞同：23
> 
> 时间：2008-11-14T20:49:29.100
> 
> 标签：c#, reflection, clone

我正在使用反射编写克隆方法。如何使用反射检测属性是索引属性？例如：

```
public string[] Items
{
   get;
   set;
} 
```

到目前为止我的方法：

```
public static T Clone<T>(T from, List<string> propertiesToIgnore) where T : new()
{
    T to = new T();

    Type myType = from.GetType();

    PropertyInfo[] myProperties = myType.GetProperties();

    for (int i = 0; i < myProperties.Length; i++)
    {
        if (myProperties[i].CanWrite && !propertiesToIgnore.Contains(myProperties[i].Name))
        {
            myProperties[i].SetValue(to,myProperties[i].GetValue(from,null),null);
        }
    }

    return to;
} 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-11-14T20:57:27.243

```
if (propertyInfo.GetIndexParameters().Length > 0)
{
    // Property is an indexer
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-13T19:49:54.957

对不起，可是

```
public string[] Items { get; set; } 
```

不是索引属性，它*只是*数组类型！然而以下是：

```
public string this[int index]
{
    get { ... }
    set { ... }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-14T20:58:04.120

你要的是`GetIndexParameters()`方法。如果它返回的数组有超过 0 个项目，这意味着它是一个索引属性。

有关详细信息，请参阅[MSDN 文档。](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.getindexparameters.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-17T11:13:18.480

如果你调用`property.GetValue(obj,null)`，并且属性被索引，那么你会得到一个参数计数不匹配异常。最好检查属性是否被索引`GetIndexParameters()`，然后决定做什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-07T21:53:11.667

这是一些对我有用的代码：

```
foreach（obj.GetType().GetProperties() 中的 PropertyInfo 属性）
{
  对象值 = property.GetValue(obj, null);
  如果（值是对象[]）
  {
    ……
  }
}

```

PS `.GetIndexParameters().Length > 0)`适用于本文中描述的情况：http: [//msdn.microsoft.com/en-us/library/b05d59ty.aspx](http://msdn.microsoft.com/en-us/library/b05d59ty.aspx) 因此，如果您关心名为 Chars 的字符串类型值的属性，请使用它，但它不适用于我感兴趣的大多数数组，包括我很确定原始问题中的字符串数组。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-02T09:10:33.127

您可以将索引器转换为 IEnumerable

```
 public static IEnumerable<T> AsEnumerable<T>(this object o) where T : class {
        var list = new List<T>();
        System.Reflection.PropertyInfo indexerProperty = null;
        foreach (System.Reflection.PropertyInfo pi in o.GetType().GetProperties()) {
            if (pi.GetIndexParameters().Length > 0) {
                indexerProperty = pi;
                break;
            }
        }

        if (indexerProperty.IsNotNull()) {
            var len = o.GetPropertyValue<int>("Length");
            for (int i = 0; i < len; i++) {
                var item = indexerProperty.GetValue(o, new object[]{i});
                if (item.IsNotNull()) {
                    var itemObject = item as T;
                    if (itemObject.IsNotNull()) {
                        list.Add(itemObject);
                    }
                }
            }
        }

        return list;
    }

    public static bool IsNotNull(this object o) {
        return o != null;
    }

    public static T GetPropertyValue<T>(this object source, string property) {
        if (source == null)
            throw new ArgumentNullException("source");

        var sourceType = source.GetType();
        var sourceProperties = sourceType.GetProperties();
        var properties = sourceProperties
            .Where(s => s.Name.Equals(property));
        if (properties.Count() == 0) {
            sourceProperties = sourceType.GetProperties(BindingFlags.Instance | BindingFlags.NonPublic);
            properties = sourceProperties.Where(s => s.Name.Equals(property));
        }

        if (properties.Count() > 0) {
            var propertyValue = properties
                .Select(s => s.GetValue(source, null))
                .FirstOrDefault();

            return propertyValue != null ? (T)propertyValue : default(T);
        }

        return default(T);
    } 
```

# divx - 另一种声音，如字幕

> ID：291360
> 
> 赞同：0
> 
> 时间：2008-11-14T20:50:15.823
> 
> 标签：divx, movies

是否可以像获取字幕一样将其他声音传递给 divx？那是什么格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-14T20:57:33.203

是的，您的视频文件中可以有多个音频流。[这里](http://www.doom9.org/index.html?/dual-audio.htm)有更多信息（我猜你使用 AVI 作为你的容器格式）。

# mysql - 恢复 MySQL 数据库的备份时，什么会导致“备份文件中的未知对象”问题？

> ID：291369
> 
> 赞同：2
> 
> 时间：2008-11-14T20:53:30.887
> 
> 标签：mysql

不幸的是，问题并不比这更具体。我通过[谷歌搜索](http://www.google.com/search?source=ig&hl=en&rlz=&=&q=%22Unknown+object+in+backup+file%22&btnG=Google+Search&aq=f)找到了一些报告类似问题的人的例子，但我找不到实际导致问题的恢复部分，这可能有助于我自己追踪它。

解决此问题或能够追查根本原因的建议将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T01:04:16.493

在 bugs.mysql.com 上记录了一个错误，它引用了您描述的错误：

“ [Bug #37253 无法恢复包含 BLOB 的备份文件](http://bugs.mysql.com/bug.php?id=37253)”

该错误中描述的解决方案是`max_allowed_packet`在 MySQL 服务器配置中增加。用户确认将值提高到 100M 允许他恢复他的数据库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-10T21:52:44.343

*另一个修复*

我也有这个问题！网上的答案似乎没有帮助（max_allowed_pa​​cket 等）

这是固定我的：

我没有运行恢复功能，而是通过 MySQL Migration Toolkit（在 Windows 上随 GUI 工具安装）导入。

迁移工具包也失败了，但在最后一页的日志中有描述性错误。就我而言，我的数据中有一些不正确的日期字段（通常是“0000-00-00”）无法正确迁移。

在我的表格中修复这些日期解决了还原问题。

希望这对其他人有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-15T07:27:09.560

我过去也遇到过类似的事情——它与备份方式有关。我认为某些应用程序在备份文件中放置了无效的注释，这会导致错误。

我的建议——如果你在尝试恢复这些文件时遇到困难——是从备份文件的各个部分逐步开始备份，并找出导致问题的原因——据我回忆的情况是，它们是文件中的一些文本删除无关紧要的文件。

# c# - 在 C# 中遍历 XML 树

> ID：291387
> 
> 赞同：12
> 
> 时间：2008-11-14T20:58:05.823
> 
> 标签：c#, .net, xml

我是 .net 和 c# 的新手，所以我想确保我使用正确的工具来完成这项工作。

我收到的 XML 是对另一台机器上的目录树的描述，所以它有很多层次。我现在需要做的是获取 XML 并创建对象结构（自定义类）并使用来自 XML 输入的信息填充它们，例如文件、文件夹、标签、属性...

在我看来，此 XML 输入的 Tree 结构使其成为使用递归遍历树的主要候选者。

在 .net 3.5 中有不同的方法吗？

我看过 XmlReaders，但他们似乎以线性方式在树上行走，而不是我真正想要的......

我收到的 XML 是第 3 方 api 的一部分，因此不在我的控制范围内，并且可能会在未来发生变化。

我研究了反序列化，但它的缺点（黑盒实现，需要将成员声明为公共，速度慢，仅适用于简单对象......）也将其排除在列表之外。

感谢您对此的意见。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-14T21:14:35.647

I would use the XLINQ classes in System.Xml.Linq (this is the namespace and the assembly you will need to reference). Load the XML into and XDocument:

```
XDocument doc = XDocument.Parse(someString); 
```

Next you can either use recursion or a pseudo-recursion loop to iterate over the child nodes. You can choose you child nodes like:

```
//if Directory is tag name of Directory XML
//Note: Root is just the root XElement of the document
var directoryElements = doc.Root.Elements("Directory"); 

//you get the idea
var fileElements = doc.Root.Elements("File"); 
```

The variables *directoryElements* and *fileElements* will be IEnumerable types, which means you can use something like a foreach to loop through all of the elements. One way to build up you elements would be something like this:

```
List<MyFileType> files = new List<MyFileType>();

foreach(XElelement fileElement in fileElements)
{
  files.Add(new MyFileType()
    {     
      Prop1 = fileElement.Element("Prop1"), //assumes properties are elements
      Prop2 = fileElement.Element("Prop2"),
    });
} 
```

In the example, *MyFileType* is a type you created to represent files. This is a bit of a brute-force attack, but it will get the job done.

If you want to use XPath you will need to *using* System.Xml.XPath.

* * *

***A Note on System.Xml vs System.Xml.Linq***

There are a number of XML classes that have been in .Net since the 1.0 days. These live (mostly) in System.Xml. In .Net 3.5, a wonderful, new set of XML classes were released under System.Xml.Linq. I cannot over-emphasize how much nicer they are to work with than the old classes in System.Xml. I would highly recommend them to any .Net programmer and especially someone just getting into .Net/C#.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T20:59:51.090

XmlReader 不是一个特别友好的 API。如果您可以使用 .NET 3.5，那么加载到 LINQ to XML 可能是您最好的选择。您可以轻松地使用递归。

否则，XmlDocument 仍然可以解决问题……只是不那么令人愉快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T21:15:47.127

This is a problem which is very suitable for recursion.

To elaborate a bit more on what another poster said, you'll want to start by loading the XML into a *System.Xml.XmlDocument*, (using *LoadXml* or *Load*).

You can access the root of the tree using the *XmlDocument.DocumentElement* property, and access the children of each node by using the *ChildNodes property*. Child nodes returns a collection, and when the Collection is of size 0, you know you'll have reached your base case.

Using LINQ is also a good option, but I'm unable to elaborate on this solution, cause I'm not really a LINQ expert.

As Jon mentioned, XmlReader isn't very friendly. If you end up having perf issues, you might want to look into it, but if you just want to get the job done, go with XmlDocument/ChildNodes using recursion.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T20:59:25.210

将您的 XML 加载到 XMLDocument 中。然后，您可以使用递归遍历 XMLDocuments DOM。

您可能还想查看工厂方法模式来创建您的类，这在这里会非常有用。

# javascript - jQuery：当绑定/单击事件用于类时引用调用对象（this）

> ID：291391
> 
> 赞同：4
> 
> 时间：2008-11-14T20:59:44.867
> 
> 标签：javascript, jquery

感谢您阅读本文。

我正在动态生成一些数据，其中包括一个选择下拉菜单，旁边有一个文本框。如果用户单击选择，我将动态填充它（下面的代码）。我有一个关于选择的课程，我希望下面的代码可以工作。我用选择上的 ID 对其进行了测试，并将 ONE 放在我让它工作的 ID 上。但是，在更改代码以引用一个类时（因为将有多个数据组，其中包括一个带有旁边一个文本框的选择）并且`$(this)`，我无法让它工作。任何想法都会有所帮助。谢谢

选择旁边的文本框的相关性是代码的第二部分...在选择中选择选项时更新文本框

`.one`因此选择只更新一次，然后`.bind`允许将任何选择的选项放置在相邻的文本框中。

```
$('.classSelect').one("click",
 function() {
  $.ajax({
   type: "post",
   url: myURL ,
   dataType: "text",
   data: {
    '_service' : myService,
    '_program' : myProgram ,
    'param' : myParams
   },
   success:
    function(request) {
     $(this).html(request);   // populate select box
   }    // End success
  }); // End ajax method

  $(this).bind("click",
   function() {
    $(this).next().val($(this).val());
  }); // End BIND
 }); // End One

 <select id="mySelect" class="classSelect"></select>
 <input type="text"> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-14T21:08:29.920

`$(this)`仅在功能范围内相关。但是，在函数之外，它会丢失该引用：

```
$('.classSelect').one("click", function() {
   $(this); // refers to $('.classSelect')

   $.ajax({
   // content
      $(this); // does not refer to $('.classSelect')
   });
}); 
```

处理此问题的更好方法可能是：

```
$('.classSelect').one("click", function() {
    var e = $(this);

    $.ajax({
    ...
        success : function(request) {
          e.html(request);
        }
    }); // end ajax

    $(this).bind('click', function() {
    // bind stuff

    }); // end bind

}); // end one 
```

顺便问一下，你熟悉这个[`load()`](http://docs.jquery.com/Ajax/load)方法吗？我发现基本 ajax 更容易（因为它作用于包装集，而不是像`$.ajax()`.`load()`

```
$('.classSelect').one('click', function() {
    var options = {
       type : 'post',
       dataType : 'text',
       data : {
         '_service' : myService,
         '_program' : myProgram ,
         'param' : myParams
       }           
    } // end options

    // load() will automatically load your .classSelect with the results
    $(this).load(myUrl, options);

    $(this).click(function() {
    // etc...

    }); // end click

}); // end one 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T21:08:34.677

我相信这是因为附加到成功事件的函数不知道“this”是什么，因为它独立于您在其中调用它的对象运行。（我没有很好地解释它，但我认为这与闭包有关。）

我想如果您在 $.ajax 调用之前添加了以下行：

```
var _this = this; 
```

然后在成功函数中使用该变量：

```
 success:
    function(request) {
     _this.html(request);   // populate select box
   } 
```

它可能会奏效

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T21:04:15.823

那是匹配一个选择。你需要匹配多个元素，所以你想要

```
$("select[class='classSelect']") ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T21:22:25.633

success() 函数不知道这一点，因为任何其他事件回调（它们在对象范围之外运行）。

你需要关闭success函数作用域内的变量，但你真正需要的不是“this”，而是$(this)

所以：

```
var that = $(this);
... some code ...
success: function(request) {
  that.html(request)
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T21:25:59.290

谢谢欧文。虽然编写代码可能更好（使用链接）....我对这段代码的问题是 $(this) 在 .ajax 和 .bind 调用中不可用..所以将它存储在一个 var 中并使用它var 是解决方案。

再次感谢。

```
$('.classSelect').one("click",
 function() {
  var e = $(this) ;

  $.ajax({
   type: "post",
   url: myURL ,
   dataType: "text",
   data: {
    '_service' : myService,
    '_program' : myProgram ,
    'param' : myParams
   },
   success:
    function(request) {
     $(e).html(request);   // populate select box
   }    // End success
  }); // End ajax method

  $(e).one("click",
   function() {
    $(e).next().val($(e).val());
  }); // End BIND
 }); // End One 
```

# c# - Rational numbers in C# and XML

> ID：291395
> 
> 赞同：2
> 
> 时间：2008-11-14T21:00:08.860
> 
> 标签：c#, xml, rational-numbers

I'm working with an XML file that subscribes to an industry standard. The standards document for the schema defines one of the fields as a rational number and its data is represented as two integers, typically with the second value being a 1 (e.g. `<foo>20 1</foo>`). I've been hunting around without a great deal of success to see if there's an XML-defined standard for rational numbers. I did find this (8 year old) exchange on the mailing list for XML-SCHEMA:

[http://markmail.org/message/znvfw2r3a2pfeykl](http://markmail.org/message/znvfw2r3a2pfeykl)

I'm not clear that there is a standard "XML way" for representing rational numbers and whether the standard applying to this document is subscribing to it, or whether they've cooked up their own way of doing it for their documents and are relying on people to read the standard. The document is not specific beyond saying the field is a rational number.

Assuming there is a standard way of representing rational numbers and this document is correctly implementing it, does the functionality in System.Xml recognize it? Again, my searches have not been particularly fruitful.

Thanks for any feedback anyone has.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-19T18:01:32.503

这并不完全是对 XML 方面的回答，但是如果您想要一个 C# 类来表示有理数，我不久前写了一个非常灵活的类作为我的[ExifUtils 库](https://github.com/mckamey/exif-utils.net)的一部分（因为大多数 EXIF 值都表示作为有理数）。

*   `Rational<T>` [https://github.com/mckamey/exif-utils.net/blob/master/ExifUtils/ExifUtils/Rational.cs](https://github.com/mckamey/exif-utils.net/blob/master/ExifUtils/ExifUtils/Rational.cs)

该类本身是通用的，接受任何实现类型的分子/分母`IConvertable`（包括所有 BCL 数字类型），并将序列化（ToString）和反序列化（Parse/TryParse），这可能会为您提供 XML 表示所需的确切内容。

如果您绝对必须用空格表示一个有理数，您可以将其调整为使用空格`' '`作为分隔符，并在源中更改单个字符。

* * *

作为对 Steven Lowe 评论的回应，除了稍微偏离主题之外，使用有理数虽然看似不直观，但有一些优势。诸如 PI 之类的数字也不能表示为十进制/浮点数。PI的*近似值*（例如 Math.PI 中的值）可以精确地表示为有理数：

```
314159265358979323846 / 100000000000000000000 
```

而非常简单的有理数`2/3`不可能以与任何类型的浮点/固定精度十进制数相同的精度表示：

```
0.66666666666666666667 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T21:08:37.640

i'm glad they didn't accept this proposal as a standard! the guy proposing to base all other numbers on a 'rational number' primitive has never heard of transcendental numbers (like Pi, for example) which cannot be represented in this manner

but back to your question - i've only run across rational numbers in xml as part of an RDF specification for certain engineering values related to the power industry. I think it was just a pair of numbers separated by a comma

[this document](http://www.w3.org/TR/2000/WD-CCPP-vocab-20000721/#2.2.4) defines the format as N/M, while another reference has it as N,M

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T21:35:07.777

[您可以在MathML](http://www.w3.org/TR/MathML2/chapter3.html#presm.mfrac)中表达分数。那是行业标准AFAIK。

# asp.net-mvc - 使用 ASP.NET MVC 的多语言网站

> ID：291405
> 
> 赞同：10
> 
> 时间：2008-11-14T21:03:19.557
> 
> 标签：asp.net-mvc, url-rewriting, multilingual

在构建多语言网站（使用 ASP.NET 网络表单）时，我将使用 HTTP 模块来重写 URL，最终得到一些友好的内容（对于人类和搜索引擎），例如：

```
uk/products/product_category_one/sub_category_one/index.aspx
uk/products/product_category_one/sub_category_one/widget_mk5.aspx
es/productos/categoría_de_producto_una/widget_mk5.aspx 
```

我（新手）对 MVC 的理解是 URL 应该采用以下格式

> 控制器/动作/标识符

因此使用 MVC 复制上述功能最终会得到类似于以下内容的 URL：

```
products/category/123/product_category_one/sub_category_one
products/items/456/widget_mk5 
```

问题..

*   我可以在“控制器”部分之前的 URL 中插入国家代码吗？
*   是否可以将“产品”和“产品”映射到同一个控制器？

谢谢你的帮助

**编辑：** 除了下面 Panos 的回答之外，我还在[ASP.NET 网站](http://www.asp.net/learn/mvc/tutorial-05-vb.aspx)上找到了更多信息。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-14T22:46:37.147

URL 几乎可以采用您喜欢的任何其他形式。有关详细信息，请查看[ASP.NET MVC 框架（第 2 部分）：URL 路由](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx)。只是为了开始（因为我不确定它是否是最佳解决方案），您可以在 global.asax 中添加两条新路线：

```
 routes.MapRoute(
            "ukRoute",
            "{lang}/Products/{action}/{id}/{subcategory}",
            new { lang = "uk", controller = "Products", action = "Index", id = "", subcategory = "" }
        );
        routes.MapRoute(
            "esRoute",
            "{lang}/Productos/{action}/{id}/{subcategory}",
            new { lang = "es", controller = "Products", action = "Index", id = "", subcategory = "" }
        ); 
```

这些路由理解以下 URL（并将它们都映射到 的`ActionResult Category(string id, string subcategory)`方法`ProductsController`）：

```
uk/Products/Category/1/A
es/Productos/Category/1/A 
```

如果你想在你的视图中创建这样的 URL，你可以使用类似的东西：

```
<%= Html.RouteLink("English 1.A", "ukRoute", new { lang = "uk", action = "Category", id = "1", subcategory = "A" })%>
<%= Html.RouteLink("Spanish 1.A", "esRoute", new { lang = "es", action = "Category", id = "1", subcategory = "A" })%> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-15T06:38:50.627

您可以这样做，但请记住，并非所有国家/地区都是语言。例如，en-gb 是英国英语的常用表示，或者更具体地说，是英国内容的英国语言环境。如果可以的话，值得遵循 RFC1766 派生的语言-LOCALE 约定。

Search engines actually tend to do a fairly good job dealing with content-negotiation, by the way, so you need not necessarily have separate URIs for the same content in different languages. Google Japan will crawl with ja-JP as the accept language header, for example.

# vbscript - Extract files from ZIP file with VBScript

> ID：291406
> 
> 赞同：11
> 
> 时间：2008-11-14T21:03:22.003
> 
> 标签：vbscript, zip

When extracting files from a ZIP file I was using the following.

```
Sub Unzip(strFile)
' This routine unzips a file. NOTE: The files are extracted to a folder '
' in the same location using the name of the file minus the extension.  '
' EX. C:\Test.zip will be extracted to C:\Test '
'strFile (String) = Full path and filename of the file to be unzipped. '
Dim arrFile
    arrFile = Split(strFile, ".")
    Set fso = CreateObject("Scripting.FileSystemObject")
    fso.CreateFolder(arrFile(0) & "\ ")
    pathToZipFile= arrFile(0) & ".zip"
    extractTo= arrFile(0) & "\ "
    set objShell = CreateObject("Shell.Application")
    set filesInzip=objShell.NameSpace(pathToZipFile).items
    objShell.NameSpace(extractTo).CopyHere(filesInzip)
    fso.DeleteFile pathToZipFile, True
    Set fso = Nothing
    Set objShell = Nothing
End Sub 'Unzip 
```

This was working, but now I get a "The File Exists" Error.

What is the reason for this? Are there any alternatives?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-03-29T23:08:30.393

上述所有解决方案都是准确的，但它们不是确定的。

如果您尝试将*压缩文件*提取到临时文件夹中，则会立即为您尝试提取的 ZIP 文件中包含的**每个文件**`C:\Documents`（在和中`Settings\USERNAME\Local Settings\Temp`）创建一个显示“YOURFILE.zip 的临时文件夹”的文件夹。

 **没错，如果您有 50 个文件，它将在您的临时目录中创建 50 个文件夹。

**但是**，如果您有 200 个文件，它将在 99 处停止并崩溃说明 - **The File Exists**。

..

显然，这不会发生在 Windows 7 上，我在上面看到了这些贡献。但无论如何，我们仍然可以进行检查。好吧，这就是你修复它的方法：

```
 '========================
    'Sub: UnzipFiles
    'Language: vbscript
    'Usage: UnzipFiles("C:\dir", "extract.zip")
    'Definition: UnzipFiles([Directory where zip is located & where files will be extracted], [zip file name])
    '========================
    Sub UnzipFiles(folder, file)
        Dim sa, filesInzip, zfile, fso, i : i = 1
        Set sa = CreateObject("Shell.Application")
            Set filesInzip=sa.NameSpace(folder&file).items
        For Each zfile In filesInzip
            If Not fso.FileExists(folder & zfile) Then
                sa.NameSpace(folder).CopyHere(zfile), &H100 
                i = i + 1
            End If
            If i = 99 Then
            zCleanup(file, i)
            i = 1
            End If
        Next
        If i > 1 Then 
            zCleanup(file, i)
        End If
        fso.DeleteFile(folder&file)
    End Sub

    '========================
    'Sub: zCleanup
    'Language: vbscript
    'Usage: zCleanup("filename.zip", 4)
    'Definition: zCleanup([Filename of Zip previously extracted], [Number of files within zip container])
    '========================
    Sub zCleanUp(file, count)   
        'Clean up
        Dim i, fso
        Set fso = CreateObject("Scripting.FileSystemObject")
        For i = 1 To count
           If fso.FolderExists(fso.GetSpecialFolder(2) & "\Temporary Directory " & i & " for " & file) = True Then
           text = fso.DeleteFolder(fso.GetSpecialFolder(2) & "\Temporary Directory " & i & " for " & file, True)
           Else
              Exit For
           End If
        Next
    End Sub 
```

就是这样，将这两个函数复制并粘贴到您的 VBScript 托管程序中，您应该可以在 Windows XP 和 Windows 7 上运行。

谢谢！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-28T09:27:55.803

您可以使用VBScript 中的[DotNetZip](http://dotnetzip.codeplex.com)。

要解压现有的 zipfile，覆盖任何可能存在的文件：

```
WScript.echo("Instantiating a ZipFile object...")
Dim zip 
Set zip = CreateObject("Ionic.Zip.ZipFile")

WScript.echo("Initialize (Read)...")
zip.Initialize("C:\Temp\ZipFile-created-from-VBScript.zip")

WScript.echo("setting the password for extraction...")
zip.Password = "This is the Password."

' set the default action for extracting an existing file
' 0 = throw exception
' 1 = overwrite silently
' 2 = don't overwrite (silently)
' 3 = invoke the ExtractProgress event
zip.ExtractExistingFile = 1

WScript.echo("extracting all files...")
Call zip.ExtractAll("extract")

WScript.echo("Disposing...")
zip.Dispose()

WScript.echo("Done.") 
```

要创建一个新的 zip 文件：

```
dim filename 
filename = "C:\temp\ZipFile-created-from-VBScript.zip"

WScript.echo("Instantiating a ZipFile object...")
dim zip2 
set zip2 = CreateObject("Ionic.Zip.ZipFile")

WScript.echo("using AES256 encryption...")
zip2.Encryption = 3

WScript.echo("setting the password...")
zip2.Password = "This is the Password."

WScript.echo("adding a selection of files...")
zip2.AddSelectedFiles("*.js")
zip2.AddSelectedFiles("*.vbs")

WScript.echo("setting the save name...")
zip2.Name = filename

WScript.echo("Saving...")
zip2.Save()

WScript.echo("Disposing...")
zip2.Dispose()

WScript.echo("Done.") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-07-15T16:42:53.270

上面的答案是完全正确的，但我想我会将所有内容打包成我正在使用的完整解决方案：

```
strZipFile = "test.zip"     'name of zip file
outFolder = "."             'destination folder of unzipped files (must exist)
'If using full paths rather than relative to the script, comment the next line
pwd = Replace(WScript.ScriptFullName, WScript.ScriptName, "")

Set objShell = CreateObject( "Shell.Application" )
Set objSource = objShell.NameSpace(pwd+strZipFile).Items()
Set objTarget = objShell.NameSpace(pwd+outFolder)
intOptions = 256
objTarget.CopyHere objSource, intOptions

'Clean up
Set WshShell = CreateObject("Wscript.Shell")
tempfolder = WshShell.ExpandEnvironmentStrings("%temp%")
Set fso = CreateObject("Scripting.FileSystemObject")
Call fso.DeleteFolder(tempfolder + "\Temporary Directory 1 for " + strZipFile, True ) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-14T21:33:01.680

[http://www.experts-exchange.com/Programming/Languages/Visual_Basic/VB_Script/Q_23022290.html](http://www.experts-exchange.com/Programming/Languages/Visual_Basic/VB_Script/Q_23022290.html)

检查您的临时目录。如果您有 99 个与此解压缩过程相关的文件夹，请尝试删除它们。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-03T18:53:28.953

我在解压缩过程的开头添加了以下代码，以便在解压缩之前删除这些目录：

```
For i = 1 To 99
  If aqFileSystem.Exists(GetAppPath("Local Settings", "") & "\Temp\Temporary Directory " & i & " for DialogState.zip") = True Then
      result = aqFileSystem.ChangeAttributes(GetAppPath("Local Settings", "") & "\Temp\Temporary Directory " & i & " for DialogState.zip", 1 OR 2, aqFileSystem.fattrFree) 
      Call DelFolder(GetAppPath("Local Settings", "") & "\Temp\Temporary Directory " & i & " for DialogState.zip")  
   Else
      Exit For
   End If
Next 
```

# arrays - 如何在 VB.NET 中声明一个内联数组

> ID：291413
> 
> 赞同：60
> 
> 时间：2008-11-14T21:04:16.853
> 
> 标签：arrays, vb.net, literals

我正在寻找 VB.NET 等价物

```
var strings = new string[] {"abc", "def", "ghi"}; 
```

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2008-11-14T21:06:52.467

```
Dim strings() As String = {"abc", "def", "ghi"} 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-11-14T21:16:37.593

现在已经有很多正确答案了，但这里有一个“教人钓鱼”的版本。

首先在 C# 中创建一个小型控制台应用程序：

```
class Test
{
    static void Main()
    {
        var strings = new string[] {"abc", "def", "ghi"};
    }
} 
```

编译它，保留调试信息：

```
csc /debug+ Test.cs 
```

在其上运行[Reflector](http://www.red-gate.com/products/reflector/)，并打开 Main 方法 - 然后反编译为 VB。你最终得到：

```
Private Shared Sub Main()
    Dim strings As String() = New String() { "abc", "def", "ghi" }
End Sub 
```

所以我们得到了相同的答案，但实际上并不了解 VB。这并不总是有效，还有很多其他的转换工具，但这是一个好的开始。绝对值得尝试作为第一个停靠港。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-04-19T17:21:56.247

在支持类型推断的较新版本的 VB.NET 中，这个较短的版本也可以工作：

```
Dim strings = {"abc", "def", "ghi"} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-14T21:05:55.307

```
Dim strings As String() = New String() {"abc", "def", "ghi"} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-14T21:06:20.407

不是VB的人。但也许是这样的？

```
Dim strings = New String() {"abc", "def", "ghi"} 
```

（大约晚了 25 秒……）

提示： http: [//www.developerfusion.com/tools/convert/csharp-to-vb/](http://www.developerfusion.com/tools/convert/csharp-to-vb/)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-14T21:06:48.800

`Dim strings As String() = {"abc", "def", "ghi"}`

# .net - .NET performance tips for enterprise web applications

> ID：291415
> 
> 赞同：8
> 
> 时间：2008-11-14T21:04:22.050
> 
> 标签：.net, asp.net, performance

For enterprise web apps, every little bit counts.

What performance tips can you share to help programmers program more efficiently?

To start it off:

1.  Use StringBuilders over strings since strings are Mutable (they get re-created every time you modify them).

2.  Avoid using Datasets as they are very bloated, use SqlReader instead.

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-11-14T21:25:36.267

问题中的要点是微观优化。我不同意“每一点都有帮助”的前提 - 特别是如果它以牺牲可读性为代价。

你看，如果你能很容易地阅读和理解你的代码，那意味着你可以很容易地进行架构更改。这些才是真正的大胜利所在，而不是微优化。你越是尝试调整每一行代码，就越难重构整个设计。

所以我的建议是：

*   写出你能写出的最易读的代码
*   不要过早地优化实现——但要尽早考虑*架构*性能问题
*   在你有硬性数字让你判断你是否在改进之前，不要以性能的名义进行更改
*   使用分析器帮助发现瓶颈

到目前为止，这些都不是特定于网络应用程序的。对于 Web 应用程序（以及一般的服务器端）：

*   除非您真的知道您永远不需要超过一台服务器，否则请确保您的代码可以水平扩展。如果您负担得起，请*从*两台（或更多）服务器开始，以便尽早解决任何问题（会话等）。这也有助于滚动升级等。

编辑：我根本没有处理数据库。[凯尔在这方面的回答](https://stackoverflow.com/questions/291415/net-performance-tips-for-enterprise-web-appilcations#291525)很好。如果可能的话，确保您的数据库也可以扩展:)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-14T21:37:35.727

您将在（几乎）任何应用程序中看到的最大收益是调整您的数据库。

编码...

*   当您只需要 2 列时，您是否选择了 12 列？
*   您是否正在获取所有结果以执行 SUM？
*   您是否要抓取 1,000 条记录以显示 10 条？
*   您是否每页都触发了一百个查询？

数据库...

*   你的表上有索引吗？
*   它们是正确的索引吗？
*   您是否使用 SQL Profiler 抓取了一些示例查询并在 Query Analyser 中检查了它们的执行计划？
*   您是否看到 TABLE SCAN - 糟糕！
*   您是否看到 INDEX SEEK - 好！

如果所有其他方法都失败了，那就把它缓存起来，然后用更多的硬件来解决问题！:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-14T21:13:51.687

We deal with this every day.

We DO cache some datasets that are used A LOT. We have a fairly complex data-layer caching mechanism that works well for us.

Lazy evaluation for just about everything.

Page- and partial-caching for user controls

We do not use session state at all so we've disabled it altogether.

Configure websites to run as a known- low-prived user.

Connect to SQL Server as the same low-prived user. This helps with connection pooling - all connections are essentially the same.

NO ad-hoc SQL. Stored procs ONLY. Helps with performand AND SQL injection.

string.Concat() instead of string + string + ... or StringBuilder

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-14T22:43:34.097

除了 manwood 没有人提到 ViewState，这非常令人惊讶。我将 ViewState Management 选为性能改进的最重要考虑因素。

我的列表：

1.  积极管理视图状态
2.  UpdatePanel 是邪恶的 ;) 明智地使用
3.  利用 jQuery 等 JavaScript 框架
4.  观看您的服务器往返
5.  使用异步页面进行 IO 绑定操作
6.  不同级别的缓存同样重要（页面级别、数据等）
7.  使用 Ajax “按需”获取数据并在本地缓存为 XML（XML 数据岛等）
8.  考虑对长时间运行的操作进行异步处理（您可以使用基于数据库的作业队列并通过 Windows 服务处理它们。ajax 请求可以监视行以完成并使用气球更新 UI）

编辑：[添加 6-8]

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-14T23:26:30.313

Microsoft 出版了一本名为《[**提高 .NET 应用程序性能和可扩展性**](http://www.microsoft.com/downloads/details.aspx?FamilyId=8A2E454D-F30E-4E72-B531-75384A0F1C47&displaylang=en)》的书。这是一本必读的书。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-14T21:17:08.997

*   access database as little as possible
*   access web.config as little as possible
*   as manwood says make good use of cache. I could also suggest to read [this](http://learn.iis.net/page.aspx/154/iis-7-output-caching/rev/2) very good article about kernel mode caching
*   avoid locking if you can
*   some things (like sorting of data) can be done client side nowdays(see Jquery)
*   [here](http://msdn.microsoft.com/sv-se/magazine/cc163854(en-us).aspx#fig1) is good article to read

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-14T22:15:45.150

除了数据库之外，还有一个非常重要的事情要注意......

页面大小和请求数。这不言而喻，但众所周知，ASP.NET 在用一堆废话输出（增加大小）和创建一百万个外部脚本文件（请求数）来填充页面方面很糟糕。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-17T22:11:48.683

*   尽可能少地回帖。当用户做出一组复杂的标准选择时，使用 DHTML 和 JavaScript 来操作页面。不要发回以响应每个小的用户设置来更改页面。
*   尽可能少用 ASP.NET 控件。尽可能使用纯 html。由于视图状态和控件状态，所有 ASP.NET 控件都是有代价的。纯 HTML 没有这种开销。我曾经为花旗银行做过一个网络应用程序，它由一个主查询页面组成。这个页面比较复杂。它只有一个 ASP.NET 控件。这是一个回发按钮，用于制造自定义 Excel 表，加载用户选择的数据。
*   使用 MVC 框架而不是 ASP.NET。如果您使用 Brail 或 NVelocity，则视图状态和控件状态不在此处。
*   在后端代码上运行 Redgate 软件的 Ants profiler。确保您的回发事件尽可能简短和甜蜜。
*   如果页面从每 24 小时或每周刷新一次的表中派生数据，则不要编写一个常见的 ASP.NET 页面来在每次用户发出请求时查询数据。如果数据是静态的，则也将页面设为静态。您可以使用 XML 文字和 Linq to XML 类在 NT 调度程序的基础上生成静态页面。这是我能给你的最大加速。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-08T16:34:07.000

如果您的 Web 服务器受到大量同时请求的冲击，并且每个页面请求的服务时间似乎越来越长，您可能需要考虑转换为*异步页面处理模型*。

[**在 ASP.NET 中使用异步编程的可扩展应用程序**](http://msdn.microsoft.com/en-us/magazine/cc163463.aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-14T21:08:10.810

*   Make good use of the Cache object for any data that doesn't change very often but gets used alot. If you need to keep your cache objects in line with your database, have a look at SqlCacheDependency.
*   Disable ViewState wherever it isn't required

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-16T22:19:02.833

根据我的经验，以下几点有很大的不同：

*   使用 SQL Server Profiler 识别运行缓慢的查询。特别是使用调整模板来查看您是否错过了任何索引。
*   合理缓存（缓存应用程序块）
*   密切关注 ViewState
*   使用 Fiddler 检查页面大小等。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-14T23:17:51.127

检查日志并最小化每个请求提供的 HTML 数量。viewstate 和臃肿的第三方控件可能会破坏您的应用程序。例如，我们长期使用来自基础设施的网格。非常非常有能力，但即使是剥离形式，它也制作了大约 60-90k 的页面 + 大量的 java 脚本。这严重限制了我们可以处理的请求数量，即使在内部千兆连接上也是如此。

# winapi - Canonical way to parse the command line into arguments in plain C Windows API

> ID：291424
> 
> 赞同：19
> 
> 时间：2008-11-14T21:06:02.733
> 
> 标签：winapi, parsing

In a Windows program, what is the canonical way to parse the command line obtained from GetCommandLine into multiple arguments, similar to the argv array in Unix? It seems that CommandLineToArgvW does this for a Unicode command line, but I can't find a non-Unicode equivalent. Should I be using Unicode or not? If not, how do I parse the command line?

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-10-26T12:35:37.027

这是 CommandLineToArgvA 的一个实现，它将工作委托给 CommandLineToArgvW、MultiByteToWideChar 和 WideCharToMultiByte。

```
LPSTR* CommandLineToArgvA(LPSTR lpCmdLine, INT *pNumArgs)
{
    int retval;
    retval = MultiByteToWideChar(CP_ACP, MB_ERR_INVALID_CHARS, lpCmdLine, -1, NULL, 0);
    if (!SUCCEEDED(retval))
        return NULL;

    LPWSTR lpWideCharStr = (LPWSTR)malloc(retval * sizeof(WCHAR));
    if (lpWideCharStr == NULL)
        return NULL;

    retval = MultiByteToWideChar(CP_ACP, MB_ERR_INVALID_CHARS, lpCmdLine, -1, lpWideCharStr, retval);
    if (!SUCCEEDED(retval))
    {
        free(lpWideCharStr);
        return NULL;
    }

    int numArgs;
    LPWSTR* args;
    args = CommandLineToArgvW(lpWideCharStr, &numArgs);
    free(lpWideCharStr);
    if (args == NULL)
        return NULL;

    int storage = numArgs * sizeof(LPSTR);
    for (int i = 0; i < numArgs; ++ i)
    {
        BOOL lpUsedDefaultChar = FALSE;
        retval = WideCharToMultiByte(CP_ACP, 0, args[i], -1, NULL, 0, NULL, &lpUsedDefaultChar);
        if (!SUCCEEDED(retval))
        {
            LocalFree(args);
            return NULL;
        }

        storage += retval;
    }

    LPSTR* result = (LPSTR*)LocalAlloc(LMEM_FIXED, storage);
    if (result == NULL)
    {
        LocalFree(args);
        return NULL;
    }

    int bufLen = storage - numArgs * sizeof(LPSTR);
    LPSTR buffer = ((LPSTR)result) + numArgs * sizeof(LPSTR);
    for (int i = 0; i < numArgs; ++ i)
    {
        assert(bufLen > 0);
        BOOL lpUsedDefaultChar = FALSE;
        retval = WideCharToMultiByte(CP_ACP, 0, args[i], -1, buffer, bufLen, NULL, &lpUsedDefaultChar);
        if (!SUCCEEDED(retval))
        {
            LocalFree(result);
            LocalFree(args);
            return NULL;
        }

        result[i] = buffer;
        buffer += retval;
        bufLen -= retval;
    }

    LocalFree(args);

    *pNumArgs = numArgs;
    return result;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-09-09T11:51:49.517

显然你可以在 main() 之外使用 __argv 来访问预解析的参数向量......

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-12-07T19:07:31.353

我遵循了 parse_cmd 的源代码（参见最新 SDK 中的“argv_parsing.cpp”）并对其进行了修改以匹配 CommandLineToArgW 的范例和操作，并开发了以下内容。[注意：根据 Microsoft 的建议（请参阅https://msdn.microsoft.com/en-us/library/windows/desktop/aa366723(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366723(v=vs.85).aspx)），我没有使用 LocalAlloc，而是使用了HeapAlloc。此外，SAL 表示法的一项更改。我稍微偏离`_In_opt_`了 lpCmdLine 的说明——因为 CommandLineToArgvW 确实允许这样做`NULL`，在这种情况下，它返回一个仅包含程序名称的参数列表。

最后一个警告，parse_cmd 将解析的命令行仅在一个方面与 CommandLineToArgvW 略有不同：当状态为“引用”模式时，连续两个双引号字符被解释为转义的双引号字符。这两个函数都消耗第一个函数并输出第二个函数。不同之处在于，对于 CommandLineToArgvW，有一个从 'in quote' 模式的转换，而 parse_cmdline 保持在 'in quote' 模式。这正确地反映在下面的函数中。

您将使用以下函数，如下所示：

`int argc = 0; LPSTR *argv = CommandLineToArgvA(GetCommandLineA(), &argc); HeapFree(GetProcessHeap(), NULL, argv);`

```
LPSTR* CommandLineToArgvA(_In_opt_ LPCSTR lpCmdLine, _Out_ int *pNumArgs)
{
    if (!pNumArgs)
    {
        SetLastError(ERROR_INVALID_PARAMETER);
        return NULL;
    }
    *pNumArgs = 0;
    /*follow CommandLinetoArgvW and if lpCmdLine is NULL return the path to the executable.
    Use 'programname' so that we don't have to allocate MAX_PATH * sizeof(CHAR) for argv
    every time. Since this is ANSI the return can't be greater than MAX_PATH (260
    characters)*/
    CHAR programname[MAX_PATH] = {};
    /*pnlength = the length of the string that is copied to the buffer, in characters, not
    including the terminating null character*/
    DWORD pnlength = GetModuleFileNameA(NULL, programname, MAX_PATH);
    if (pnlength == 0) //error getting program name
    {
        //GetModuleFileNameA will SetLastError
        return NULL;
    }
    if (*lpCmdLine == NULL)
    {

        /*In keeping with CommandLineToArgvW the caller should make a single call to HeapFree
        to release the memory of argv. Allocate a single block of memory with space for two
        pointers (representing argv[0] and argv[1]). argv[0] will contain a pointer to argv+2
        where the actual program name will be stored. argv[1] will be nullptr per the C++
        specifications for argv. Hence space required is the size of a LPSTR (char*) multiplied
        by 2 [pointers] + the length of the program name (+1 for null terminating character)
        multiplied by the sizeof CHAR. HeapAlloc is called with HEAP_GENERATE_EXCEPTIONS flag,
        so if there is a failure on allocating memory an exception will be generated.*/
        LPSTR *argv = static_cast<LPSTR*>(HeapAlloc(GetProcessHeap(),
            HEAP_ZERO_MEMORY | HEAP_GENERATE_EXCEPTIONS,
            (sizeof(LPSTR) * 2) + ((pnlength + 1) * sizeof(CHAR))));
        memcpy(argv + 2, programname, pnlength+1); //add 1 for the terminating null character
        argv[0] = reinterpret_cast<LPSTR>(argv + 2);
        argv[1] = nullptr;
        *pNumArgs = 1;
        return argv;
    }
    /*We need to determine the number of arguments and the number of characters so that the
    proper amount of memory can be allocated for argv. Our argument count starts at 1 as the
    first "argument" is the program name even if there are no other arguments per specs.*/
    int argc        = 1;
    int numchars    = 0;
    LPCSTR templpcl = lpCmdLine;
    bool in_quotes  = false;  //'in quotes' mode is off (false) or on (true)
    /*first scan the program name and copy it. The handling is much simpler than for other
    arguments. Basically, whatever lies between the leading double-quote and next one, or a
    terminal null character is simply accepted. Fancier handling is not required because the
    program name must be a legal NTFS/HPFS file name. Note that the double-quote characters are
    not copied.*/
    do {
        if (*templpcl == '"')
        {
            //don't add " to character count
            in_quotes = !in_quotes;
            templpcl++; //move to next character
            continue;
        }
        ++numchars; //count character
        templpcl++; //move to next character
        if (_ismbblead(*templpcl) != 0) //handle MBCS
        {
            ++numchars;
            templpcl++; //skip over trail byte
        }
    } while (*templpcl != '\0' && (in_quotes || (*templpcl != ' ' && *templpcl != '\t')));
    //parsed first argument
    if (*templpcl == '\0')
    {
        /*no more arguments, rewind and the next for statement will handle*/
        templpcl--;
    }
    //loop through the remaining arguments
    int slashcount       = 0; //count of backslashes
    bool countorcopychar = true; //count the character or not
    for (;;)
    {
        if (*templpcl)
        {
            //next argument begins with next non-whitespace character
            while (*templpcl == ' ' || *templpcl == '\t')
                ++templpcl;
        }
        if (*templpcl == '\0')
            break; //end of arguments

        ++argc; //next argument - increment argument count
        //loop through this argument
        for (;;)
        {
            /*Rules:
              2N     backslashes   + " ==> N backslashes and begin/end quote
              2N + 1 backslashes   + " ==> N backslashes + literal "
              N      backslashes       ==> N backslashes*/
            slashcount     = 0;
            countorcopychar = true;
            while (*templpcl == '\\')
            {
                //count the number of backslashes for use below
                ++templpcl;
                ++slashcount;
            }
            if (*templpcl == '"')
            {
                //if 2N backslashes before, start/end quote, otherwise count.
                if (slashcount % 2 == 0) //even number of backslashes
                {
                    if (in_quotes && *(templpcl +1) == '"')
                    {
                        in_quotes = !in_quotes; //NB: parse_cmdline omits this line
                        templpcl++; //double quote inside quoted string
                    }
                    else
                    {
                        //skip first quote character and count second
                        countorcopychar = false;
                        in_quotes = !in_quotes;
                    }
                }
                slashcount /= 2;
            }
            //count slashes
            while (slashcount--)
            {
                ++numchars;
            }
            if (*templpcl == '\0' || (!in_quotes && (*templpcl == ' ' || *templpcl == '\t')))
            {
                //at the end of the argument - break
                break;
            }
            if (countorcopychar)
            {
                if (_ismbblead(*templpcl) != 0) //should copy another character for MBCS
                {
                    ++templpcl; //skip over trail byte
                    ++numchars;
                }
                ++numchars;
            }
            ++templpcl;
        }
        //add a count for the null-terminating character
        ++numchars;
    }
    /*allocate memory for argv. Allocate a single block of memory with space for argc number of
    pointers. argv[0] will contain a pointer to argv+argc where the actual program name will be
    stored. argv[argc] will be nullptr per the C++ specifications. Hence space required is the
    size of a LPSTR (char*) multiplied by argc + 1 pointers + the number of characters counted
    above multiplied by the sizeof CHAR. HeapAlloc is called with HEAP_GENERATE_EXCEPTIONS
    flag, so if there is a failure on allocating memory an exception will be generated.*/
    LPSTR *argv = static_cast<LPSTR*>(HeapAlloc(GetProcessHeap(),
        HEAP_ZERO_MEMORY | HEAP_GENERATE_EXCEPTIONS,
        (sizeof(LPSTR) * (argc+1)) + (numchars * sizeof(CHAR))));
    //now loop through the commandline again and split out arguments
    in_quotes      = false;
    templpcl       = lpCmdLine;
    argv[0]        = reinterpret_cast<LPSTR>(argv + argc+1);
    LPSTR tempargv = reinterpret_cast<LPSTR>(argv + argc+1);
    do {
        if (*templpcl == '"')
        {
            in_quotes = !in_quotes;
            templpcl++; //move to next character
            continue;
        }
        *tempargv++ = *templpcl;
        templpcl++; //move to next character
        if (_ismbblead(*templpcl) != 0) //should copy another character for MBCS
        {
            *tempargv++ = *templpcl; //copy second byte
            templpcl++; //skip over trail byte
        }
    } while (*templpcl != '\0' && (in_quotes || (*templpcl != ' ' && *templpcl != '\t')));
    //parsed first argument
    if (*templpcl == '\0')
    {
        //no more arguments, rewind and the next for statement will handle
        templpcl--;
    }
    else
    {
        //end of program name - add null terminator
        *tempargv = '\0';
    }
    int currentarg   = 1;
    argv[currentarg] = ++tempargv;
    //loop through the remaining arguments
    slashcount      = 0; //count of backslashes
    countorcopychar = true; //count the character or not
    for (;;)
    {
        if (*templpcl)
        {
            //next argument begins with next non-whitespace character
            while (*templpcl == ' ' || *templpcl == '\t')
                ++templpcl;
        }
        if (*templpcl == '\0')
            break; //end of arguments
        argv[currentarg] = ++tempargv; //copy address of this argument string
        //next argument - loop through it's characters
        for (;;)
        {
            /*Rules:
              2N     backslashes   + " ==> N backslashes and begin/end quote
              2N + 1 backslashes   + " ==> N backslashes + literal "
              N      backslashes       ==> N backslashes*/
            slashcount      = 0;
            countorcopychar = true;
            while (*templpcl == '\\')
            {
                //count the number of backslashes for use below
                ++templpcl;
                ++slashcount;
            }
            if (*templpcl == '"')
            {
                //if 2N backslashes before, start/end quote, otherwise copy literally.
                if (slashcount % 2 == 0) //even number of backslashes
                {
                    if (in_quotes && *(templpcl+1) == '"')
                    {
                        in_quotes = !in_quotes; //NB: parse_cmdline omits this line
                        templpcl++; //double quote inside quoted string
                    }
                    else
                    {
                        //skip first quote character and count second
                        countorcopychar = false;
                        in_quotes       = !in_quotes;
                    }
                }
                slashcount /= 2;
            }
            //copy slashes
            while (slashcount--)
            {
                *tempargv++ = '\\';
            }
            if (*templpcl == '\0' || (!in_quotes && (*templpcl == ' ' || *templpcl == '\t')))
            {
                //at the end of the argument - break
                break;
            }
            if (countorcopychar)
            {
                *tempargv++ = *templpcl;
                if (_ismbblead(*templpcl) != 0) //should copy another character for MBCS
                {
                    ++templpcl; //skip over trail byte
                    *tempargv++ = *templpcl;
                }
            }
            ++templpcl;
        }
        //null-terminate the argument
        *tempargv = '\0';
        ++currentarg;
    }
    argv[argc] = nullptr;
    *pNumArgs = argc;
    return argv;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-14T21:29:03.997

`CommandLineToArgvW()`在 shell32.dll 中。我猜壳牌开发人员创建了该功能供他们自己使用，并且将其公开是因为有人认为第 3 方开发人员会发现它有用，或者是因为某些法庭诉讼使他们这样做。

由于 Shell 开发人员只需要一个 Unicode 版本，这就是他们所编写的全部内容。为将 ANSI 转换为 Unicode、调用该函数并将 Unicode 结果转换为 ANSI 的函数编写一个 ANSI 包装器将相当简单（如果 Shell32.dll 曾经提供此 API 的 ANSI 变体，那可能正是做）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-02-05T03:24:06.167

当不想解析 UNICODE 时，这些都没有完美地解决问题，所以我的解决方案是从[WINE](https://www.winehq.org/)项目修改的，它们包含的源代码`CommandLineToArgvW`，`shell32.dll`修改到下面，它对我来说非常适合：

```
/*************************************************************************
 * CommandLineToArgvA            [SHELL32.@]
 * 
 * MODIFIED FROM https://www.winehq.org/ project
 * We must interpret the quotes in the command line to rebuild the argv
 * array correctly:
 * - arguments are separated by spaces or tabs
 * - quotes serve as optional argument delimiters
 *   '"a b"'   -> 'a b'
 * - escaped quotes must be converted back to '"'
 *   '\"'      -> '"'
 * - consecutive backslashes preceding a quote see their number halved with
 *   the remainder escaping the quote:
 *   2n   backslashes + quote -> n backslashes + quote as an argument delimiter
 *   2n+1 backslashes + quote -> n backslashes + literal quote
 * - backslashes that are not followed by a quote are copied literally:
 *   'a\b'     -> 'a\b'
 *   'a\\b'    -> 'a\\b'
 * - in quoted strings, consecutive quotes see their number divided by three
 *   with the remainder modulo 3 deciding whether to close the string or not.
 *   Note that the opening quote must be counted in the consecutive quotes,
 *   that's the (1+) below:
 *   (1+) 3n   quotes -> n quotes
 *   (1+) 3n+1 quotes -> n quotes plus closes the quoted string
 *   (1+) 3n+2 quotes -> n+1 quotes plus closes the quoted string
 * - in unquoted strings, the first quote opens the quoted string and the
 *   remaining consecutive quotes follow the above rule.
 */

LPSTR* WINAPI CommandLineToArgvA(LPSTR lpCmdline, int* numargs)
{
    DWORD argc;
    LPSTR  *argv;
    LPSTR s;
    LPSTR d;
    LPSTR cmdline;
    int qcount,bcount;

    if(!numargs || *lpCmdline==0)
    {
        SetLastError(ERROR_INVALID_PARAMETER);
        return NULL;
    }

    /* --- First count the arguments */
    argc=1;
    s=lpCmdline;
    /* The first argument, the executable path, follows special rules */
    if (*s=='"')
    {
        /* The executable path ends at the next quote, no matter what */
        s++;
        while (*s)
            if (*s++=='"')
                break;
    }
    else
    {
        /* The executable path ends at the next space, no matter what */
        while (*s && *s!=' ' && *s!='\t')
            s++;
    }
    /* skip to the first argument, if any */
    while (*s==' ' || *s=='\t')
        s++;
    if (*s)
        argc++;

    /* Analyze the remaining arguments */
    qcount=bcount=0;
    while (*s)
    {
        if ((*s==' ' || *s=='\t') && qcount==0)
        {
            /* skip to the next argument and count it if any */
            while (*s==' ' || *s=='\t')
                s++;
            if (*s)
                argc++;
            bcount=0;
        }
        else if (*s=='\\')
        {
            /* '\', count them */
            bcount++;
            s++;
        }
        else if (*s=='"')
        {
            /* '"' */
            if ((bcount & 1)==0)
                qcount++; /* unescaped '"' */
            s++;
            bcount=0;
            /* consecutive quotes, see comment in copying code below */
            while (*s=='"')
            {
                qcount++;
                s++;
            }
            qcount=qcount % 3;
            if (qcount==2)
                qcount=0;
        }
        else
        {
            /* a regular character */
            bcount=0;
            s++;
        }
    }

    /* Allocate in a single lump, the string array, and the strings that go
     * with it. This way the caller can make a single LocalFree() call to free
     * both, as per MSDN.
     */
    argv=LocalAlloc(LMEM_FIXED, (argc+1)*sizeof(LPSTR)+(strlen(lpCmdline)+1)*sizeof(char));
    if (!argv)
        return NULL;
    cmdline=(LPSTR)(argv+argc+1);
    strcpy(cmdline, lpCmdline);

    /* --- Then split and copy the arguments */
    argv[0]=d=cmdline;
    argc=1;
    /* The first argument, the executable path, follows special rules */
    if (*d=='"')
    {
        /* The executable path ends at the next quote, no matter what */
        s=d+1;
        while (*s)
        {
            if (*s=='"')
            {
                s++;
                break;
            }
            *d++=*s++;
        }
    }
    else
    {
        /* The executable path ends at the next space, no matter what */
        while (*d && *d!=' ' && *d!='\t')
            d++;
        s=d;
        if (*s)
            s++;
    }
    /* close the executable path */
    *d++=0;
    /* skip to the first argument and initialize it if any */
    while (*s==' ' || *s=='\t')
        s++;
    if (!*s)
    {
        /* There are no parameters so we are all done */
        argv[argc]=NULL;
        *numargs=argc;
        return argv;
    }

    /* Split and copy the remaining arguments */
    argv[argc++]=d;
    qcount=bcount=0;
    while (*s)
    {
        if ((*s==' ' || *s=='\t') && qcount==0)
        {
            /* close the argument */
            *d++=0;
            bcount=0;

            /* skip to the next one and initialize it if any */
            do {
                s++;
            } while (*s==' ' || *s=='\t');
            if (*s)
                argv[argc++]=d;
        }
        else if (*s=='\\')
        {
            *d++=*s++;
            bcount++;
        }
        else if (*s=='"')
        {
            if ((bcount & 1)==0)
            {
                /* Preceded by an even number of '\', this is half that
                 * number of '\', plus a quote which we erase.
                 */
                d-=bcount/2;
                qcount++;
            }
            else
            {
                /* Preceded by an odd number of '\', this is half that
                 * number of '\' followed by a '"'
                 */
                d=d-bcount/2-1;
                *d++='"';
            }
            s++;
            bcount=0;
            /* Now count the number of consecutive quotes. Note that qcount
             * already takes into account the opening quote if any, as well as
             * the quote that lead us here.
             */
            while (*s=='"')
            {
                if (++qcount==3)
                {
                    *d++='"';
                    qcount=0;
                }
                s++;
            }
            if (qcount==2)
                qcount=0;
        }
        else
        {
            /* a regular character */
            *d++=*s++;
            bcount=0;
        }
    }
    *d='\0';
    argv[argc]=NULL;
    *numargs=argc;

    return argv;
} 
```

解析空字符串时要小心`""`，它是返回`NULL`而不是可执行路径，这是与标准不同的行为`CommandLineToArgvW`，推荐用法如下：

```
int argc;
LPSTR * argv = CommandLineToArgvA(GetCommandLineA(), &argc);

// AFTER consumed argv
LocalFree(argv); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-09-15T04:00:06.617

以下是我能想到的在 WinMain 顶部获取老式 argc/argv 对的最简单方法。假设命令行确实是 ANSI 文本，您实际上不需要任何比这更高级的转换。

```
int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd) {
    int argc;
    LPWSTR *szArglist = CommandLineToArgvW(GetCommandLineW(), &argc);
    char **argv = new char*[argc];
    for (int i=0; i<argc; i++) {
        int lgth = wcslen(szArglist[i]);
        argv[i] = new char[lgth+1];
        for (int j=0; j<=lgth; j++)
            argv[i][j] = char(szArglist[i][j]);
    }
    LocalFree(szArglist); 
```

# vb.net - Linq 中动态 Where 子句中的日期比较导致重载异常

> ID：291444
> 
> 赞同：4
> 
> 时间：2008-11-14T21:11:44.623
> 
> 标签：vb.net, linq-to-sql

我试图在我的 Linq to SQL 查询中注入一个动态 where 子句，我得到一个重载异常。正确添加到查询中时，相同的表达式有效吗？

```
 qry.Where(Function(c) c.CallDate < Date.Now.AddDays(-1)) 
```

关于如何工作的任何想法？

异常内容如下：

```
Overload resolution failed because no accessible 'Where' can be called with these arguments:
Extension method 'Public Function Where(predicate As System.Func(Of Calls, Integer, Boolean)) As System.Collections.Generic.IEnumerable(Of Calls)' defined in 'System.Linq.Enumerable': Nested function does not have the same signature as delegate 'System.Func(Of Calls, Integer, Boolean)'.
Extension method 'Public Function Where(predicate As System.Func(Of Calls, Boolean)) As System.Collections.Generic.IEnumerable(Of Calls)' defined in 'System.Linq.Enumerable': Option Strict On disallows implicit conversions from 'Boolean?' to 'Boolean'.
Extension method 'Public Function Where(predicate As System.Linq.Expressions.Expression(Of System.Func(Of Calls, Integer, Boolean))) As System.Linq.IQueryable(Of Calls)' defined in 'System.Linq.Queryable': Nested function does not have the same signature as delegate 'System.Func(Of Calls, Integer, Boolean)'.
Extension method 'Public Function Where(predicate As System.Linq.Expressions.Expression(Of System.Func(Of Calls, Boolean))) As System.Linq.IQueryable(Of Calls)' defined in 'System.Linq.Queryable': Option Strict On disallows implicit conversions from 'Boolean?' to 'Boolean'.  C:\Projects\Test Projects\Encore\EncoreData.vb  59  9   Encore 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T21:40:00.370

只是在这里刺一下，以前没见过，但是给你。

看起来关键部分是您的以下两行例外：

> 嵌套函数与委托“System.Func(Of Calls, Integer, Boolean)”的签名不同。
> 
> 不允许从“布尔？”进行隐式转换 为“布尔”。

所以你正在创建的函数似乎有一个布尔类型的输出？，而 where 子句需要一个布尔值。并且系统不能从布尔值进行隐式转换？为布尔值，因为可能存在空值。

因此，您可以尝试使用显式转换来编写函数。（布尔值）或 Convert.ToBool。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T21:48:35.017

我找到了答案...

c.Calldate 是可以为空的类型，Date.Now 是不可为空的。正确的表达应该是：

```
qry.Where(Function(c) c.CallDate.Value > Date.Now.AddDays(-1)) 
```

异常中的提示是：

```
disallows implicit conversions from 'Boolean?' to 'Boolean' 
```

注意“？” 在第一个布尔值之后。

感谢您让我仔细查看错误消息！

# mysql - F# 初学者：从服务器检索数据数组

> ID：291445
> 
> 赞同：6
> 
> 时间：2008-11-14T21:11:45.530
> 
> 标签：mysql, database, f#

我正在尝试从 MySQL 数据库中获取数据。

方法 2 - 应用/映射样式

我正在使用[MySQL ADO Reference](http://dev.mysql.com/doc/refman/5.1/en/connector-net-examples-mysqlcommand.html "MySQL 参考站点")来尝试构建这个系统。特别是在 21.2.3.1.7 找到的示例。

（使用伪代码）

```
let table = build_sequence(query.read) 
```

其中 query.read 返回表中的一行（或者更确切地说，恰好是表中的一行的元素列表）。table 变量是一个列表列表，表示从查询返回的表。

我盯着下面给出的代码，恐怕它的语法超出了我的想象。

方法1 - 循环。

问题 1：它不优雅，需要一个可变的。

问题 2：根据我之前使用 Prolog 和 Lisp 的经验，这*感觉不对。*必须有一种更...更*实用*的方法来做到这一点。

我不知道从哪里开始。评论和想法？

```
let reader : MySql.Data.MySqlClient.MySqlDataReader = command.ExecuteReader()

let arr = []

let mutable rowIter = 0
let readingLoop() =
    while(reader.Read()) do
        rowIter = rowIter + 1
        for i = 0 to reader.FieldCount do

            //set arr[someiterator, i] = reader.GetValue[i].ToString()) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-17T15:06:44.033

Seq 类型有一个用于处理数据库游标的简洁函数，称为 generate_using（请参阅[F# 手册和](http://research.microsoft.com/fsharp/manual/FSharp.PowerPack/Microsoft.FSharp.Compatibility.Seq.html)[F# 基础中](http://apress.com/book/view/9781590597576)的数据访问章节）。这是一个高阶函数，它使用一个函数打开游标，另一个（重复调用）处理来自游标的记录。下面是一些使用 generate_using 执行 sql 查询的代码：

```
let openConnection (connectionName : string) =
    let connectionSetting = ConfigurationManager.ConnectionStrings.Item(connectionName)
    let connectionString = connectionSetting.ConnectionString
    let connection = new OracleConnection(connectionString)
    connection.Open()
    connection

let generator<'a> (reader : IDataReader) =
    if reader.Read() then
        let t = typeof<'a>
        let props = t.GetProperties()
        let types = props
                    |> Seq.map (fun x -> x.PropertyType)
                    |> Seq.to_array
        let cstr = t.GetConstructor(types)
        let values = Array.create reader.FieldCount (new obj())
        reader.GetValues(values) |> ignore
        let values = values
                     |> Array.map (fun x -> match x with | :? DBNull -> null | _ -> x)
        Some (cstr.Invoke(values) :?> 'a)
    else
        None

let executeSqlReader<'a> (connectionName : string) (sql : string) : 'a list =        
    let connection = openConnection connectionName

    let opener() = 
        let command = connection.CreateCommand(CommandText = sql, CommandType = CommandType.Text)
        command.ExecuteReader()

    let result = Seq.to_list(Seq.generate_using opener generator)        

    connection.Close()
    connection.Dispose()
    result 
```

例如，要列出 Oracle 数据库中的所有表，我们需要定义列定义类型并调用 executeSqlReader，如下所示：

```
type ColumnDefinition = {
    TableName : string;
    ColumnName : string;
    DataType : string;
    DataLength : decimal;                
}

let tableList = executeSqlReader<ColumnDefinition>
    "MyDatabase"
    "SELECT t.table_name, column_name, data_type, data_length FROM USER_TABLES t, USER_TAB_COLUMNS c where t.TABLE_NAME = c.table_name order by t.table_name, c.COLUMN_NAME" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T22:03:42.787

以非命令式的方式使用命令式 API 可能很困难。我没有方便的 MySql，但我做了一个近似，希望这会提供灵感。Seq.unfold 是一个人们在摸索后发现非常棒的功能。List.init（或 Array.init）也可以方便地初始化已知大小的数据结构，而无需使用可变对象。

```
#light

type ThingLikeSqlReader() =
    let mutable rowNum = 0
    member this.Read() =
        if rowNum > 3 then
            false
        else
            rowNum <- rowNum + 1
            true
    member this.FieldCount = 5
    member this.GetValue(i) = i + 1

let reader = new ThingLikeSqlReader()    
let data = reader |> Seq.unfold (fun (reader : ThingLikeSqlReader) ->
    if reader.Read() then
        Some (List.init reader.FieldCount (fun i -> reader.GetValue(i)), reader)
    else
        None) |> Seq.to_list 
printfn "%A" data 
```

# python - 正在运行的 python 程序是否有可能覆盖自己？

> ID：291448
> 
> 赞同：17
> 
> 时间：2008-11-14T21:11:57.433
> 
> 标签：python

python脚本是否可以打开自己的源文件并覆盖它？

这个想法是为 python 脚本提供一种非常简单且非常肮脏的方式来下载自身的更新，以便下次运行时它会是一个更新版本。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-14T21:16:35.597

这当然是可能的。加载/导入脚本后，Python 解释器将不再访问它，除非在异常堆栈跟踪中打印源代码行。任何 pyc 文件都将在下次重新生成，因为源文件比 pyc 更新。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-14T23:06:10.477

如果您将大部分代码放入模块中，您可以让主文件（即运行的那个）检查更新位置，并在导入模块之前自动下载最新版本并安装它。

这样您就不必重新启动应用程序来运行最新版本，只需重新导入模块即可。

```
# Check version of module
import module

# Check update address
if update_version > module.version:
    download(update_module)
    import module
    reload(module)

module.main() 
```

您可以使用 reload() 函数强制模块重新加载其数据。请注意，对此有一些警告：使用此模块中的类创建的对象不会神奇地更新到新版本，并且重新导入之前的“从模块导入东西”可能会导致“东西”引用旧对象“module.stuff” ”。

[显然，我没有足够清楚地阅读上一篇文章 - 它完全符合我的建议！]

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-14T22:28:50.630

实际上，您的应用程序最好从一个很少更改（如果有的话）的虚拟检查器下载器开始；在运行之前，它应该检查是否有可用的更新；如果是，那么它将下载它们（通常应用程序的其余部分是模块），然后导入它们并启动应用程序。

这样，一旦有可用更新，您就可以启动应用程序并运行最新版本；否则，需要重新启动应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T04:01:03.743

您可能还想查看此模块（也包含在 2.5 和 3 中）

[http://www.python.org/doc/2.1.3/lib/os-process.html](http://www.python.org/doc/2.1.3/lib/os-process.html)

具体来说， execv 方法将使用您从此方法调用的任何内容覆盖当前进程。我做了一些人员测试，它工作得非常可靠。

# .net - XML - 根级别的数据无效

> ID：291455
> 
> 赞同：40
> 
> 时间：2008-11-14T21:14:15.850
> 
> 标签：.net, xml, visual-studio, xsd, byte-order-mark

我有一个以 UTF-8 编码的 XSD 文件，我运行它的任何文本编辑器都不会在文件开头显示任何字符，但是当我在 Visual Studio 的调试器中将其拉起时，我清楚地看到一个空的文件前面的框。

![档案盒](https://i294.photobucket.com/albums/mm93/geostock/bom3.jpg)

我也得到错误：

**根级别的数据无效。第 1 行，位置 1。**

![替代文字](https://i294.photobucket.com/albums/mm93/geostock/bom4.jpg)

有谁知道这是什么吗？

更新：编辑帖子以限定文件类型。它是由 Microsoft 的 XSD 创建者创建的 XSD 文件。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-11-14T21:15:28.627

事实证明，答案是我看到的是一个[字节顺序标记](http://en.wikipedia.org/wiki/Byte_Order_Mark)，它是一个字符，它告诉加载文档的任何内容它的编码内容。在我的例子中，它是用 utf-8 编码的，所以对应的BOM 为`EF BB BF`，如下图所示。[要删除它，我在Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)中打开它并点击“Encode in UTF-8 without BOM”，如下图所示：

![在记事本++中保存](https://i294.photobucket.com/albums/mm93/geostock/bom2.jpg).

[要实际查看 BOM，我必须在TextPad](http://www.textpad.com/)中以二进制模式打开它：并在[Google 上搜索“ `EF BB BF`”](http://www.google.com/search?hl=en&q=EF+BB+BF&btnG=Google+Search&aq=f&oq=)。

![二进制模式](https://i294.photobucket.com/albums/mm93/geostock/bom1.jpg)

我花了大约 8 个小时才发现这是导致它的原因，所以我想我会与大家分享这个。

**更新**：如果我阅读了 Joel Spolsky 的博客文章：[*每个软件开发人员绝对、肯定必须了解 Unicode 和字符集（没有借口！）的绝对最低要求*](http://www.joelonsoftware.com/articles/Unicode.html)，那么我可能不会遇到这个问题。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-11-18T22:58:51.817

这是使用 vim 的方法：

```
# vim file.xml
:set nobomb
:wq 
```

# ruby-on-rails - ActionController::MethodNotAllowed 重新加载路由后？

> ID：291459
> 
> 赞同：0
> 
> 时间：2008-11-14T21:14:46.037
> 
> 标签：ruby-on-rails, ruby, rails-routing

我有一个应用程序，我通过模型动态加载路由，并`ActionController::Routing::Routes.reload!`在创建/更新该模型后调用。问题是，在这样做之后，当我尝试访问该新路线时收到以下错误：

```
ActionController::MethodNotAllowed
Only get, head, post, put, and delete requests are allowed.
/usr/lib/ruby/gems/1.8/gems/actionpack-2.1.0/lib/action_controller/routing/recognition_optimisation.rb:65:in `recognize_path'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.1.0/lib/action_controller/routing/route_set.rb:384:in `recognize'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.1.0/lib/action_controller/dispatcher.rb:148:in `handle_request'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.1.0/lib/action_controller/dispatcher.rb:107:in `dispatch'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.1.0/lib/action_controller/dispatcher.rb:104:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.1.0/lib/action_controller/dispatcher.rb:104:in `dispatch'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.1.0/lib/action_controller/dispatcher.rb:120:in `dispatch_cgi'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.1.0/lib/action_controller/dispatcher.rb:35:in `dispatch'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/rails.rb:76:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/rails.rb:74:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/rails.rb:74:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:159:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/configurator.rb:282:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/configurator.rb:281:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/configurator.rb:281:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/command.rb:212:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
/usr/lib/ruby/gems/1.8/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:502:in `load'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:502:in `load'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:354:in `new_constants_in'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:502:in `load'
/usr/lib/ruby/gems/1.8/gems/rails-2.1.0/lib/commands/servers/mongrel.rb:64
/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:27:in `gem_original_require'
/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:27:in `require'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:509:in `require'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:354:in `new_constants_in'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:509:in `require'
/usr/lib/ruby/gems/1.8/gems/rails-2.1.0/lib/commands/server.rb:39
/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:27:in `gem_original_require'
/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:27:in `require'
script/server:3 
```

真正奇怪的是请求没有参数，响应头是`{"cookie"=>[], "Allow"=>"GET, HEAD, POST, PUT, DELETE", "Cache-Control"=>"no-cache"}`

所有这一切即使请求肯定是 GET（根据 Firebug）并且根据响应 GET 肯定是允许的。

我正在使用 Rails 2.1.0 和 Mongrel 1.1.5（谷歌搜索后，我注意到旧版本有一些问题）。

有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T22:04:46.843

显然这是 Rails 2.1.0 中的一个错误。升级到 Rails 2.2.1 解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T10:54:28.823

如果您不想用 2.2 破坏您的网站，升级到 2.1.2 也可以解决此问题。

# javascript - 我可以在成功回调中评估 $.ajax() 调用的响应类型吗？

> ID：291466
> 
> 赞同：0
> 
> 时间：2008-11-14T21:16:00.950
> 
> 标签：javascript, jquery, ajax

我正在使用 jQuery 向远程端点发出 AJAX 请求。如果发生故障，该端点将返回一个 JSON 对象，并且该对象将描述故障。如果请求成功，它将返回 HTML 或 XML。

我看到了如何在 jQuery 中定义预期的请求类型作为`$.ajax()`调用的一部分。有没有办法在`success`处理程序中检测请求类型？

```
$.ajax(
    {
        type: "DELETE",
        url: "/SomeEndpoint",
        //dataType: "html",
        data:
            {
                "Param2": param0val,
                "Param1": param1val
            },
        success: function(data) {
                //data could be JSON or XML/HTML
            },
        error: function(res, textStatus, errorThrown) {
                alert('failed... :(');
            }
    }
); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T21:53:08.473

您是否让应用程序生成正确的 Content-Type 标头（application/json、text/xml 等）并在您的成功回调中处理这些标头。也许这样的事情会奏效？

```
xhr = $.ajax(
    {
        //SNIP
        success: function(data) {
                var ct = xhr.getResponseHeader('Content-Type');
                if (ct == 'application/json') {
                    //deserialize as JSON and continue
                } else if (ct == 'text/xml') {
                    //deserialize as XML and continue
                }
            },
         //SNIP
); 
```

未经测试，但值得一试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T21:54:33.697

如何使用该`complete`选项？

```
$.ajax({
   ...

   complete : function(xhr, status) {
   // status is either "success" or "error"
   // complete is fired after success or error functions
   // xhr is the xhr object itself

       var header = xhr.getResponseHeader('Content-Type');
   },

   ...
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T21:46:24.117

当它调用你的成功处理程序时，数据已经为你反序列化了。对于任何成功的结果，您需要始终返回相同的数据类型。如果确实有错误，您可能应该抛出一个异常并让它由错误回调处理。这样应该可以解析出产生的错误并打包给你的回调，也就是会检测响应没有200 OK状态，解析结果得到错误信息。

# python - 在 SVN 中的目录中搜索具有特定文件扩展名的文件并复制到另一个文件夹？

> ID：291467
> 
> 赞同：2
> 
> 时间：2008-11-14T21:16:14.617
> 
> 标签：python, svn, file

我希望我的 python 脚本在 SVN 中搜索目录，找到以特定扩展名结尾的文件（例如 *.exe），然后将这些文件复制到在我的 C 驱动器中创建的目录中。我怎样才能做到这一点？我是 Python 新手，因此非常感谢您提供详细的回复和/或指出正确的方向。

*追问：* 当使用 os.walk 时，我会传入什么参数来确保我正在复制具有特定扩展名的文件（例如 *.exe）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T21:19:22.330

我认为使用 svn 命令行实用程序检查（或者更好地导出）源代码树是最容易的：您可以使用 os.system 来调用它。还有直接的 Python 到 svn API 绑定，但如果你是 Python 新手，我建议不要使用它们。

然后您可以遍历结帐文件夹，例如使用 os.walk；复制本身可以使用 shutil.copy 完成。

# c# - DatagridView Not Displaying the error icon or error text?

> ID：291475
> 
> 赞同：14
> 
> 时间：2008-11-14T21:18:06.313
> 
> 标签：c#, winforms, datagridview

I have a win form (c#) with a datagridview. I set the grid's datasource to a datatable.

The user wants to check if some data in the datatable exists in another source, so we loop through the table comparing rows to the other source and set the rowerror on the datatable to a short message. The datagridview is not showing these errors. The errortext on the datagridviewrows are set, but no error displayed.

Am I just expecting too much for the errors to show and they only show in the context of editing the data in the grid?

I have been tinkering with this for a day and searched for someone that has posted a simalar issue to no avail - help!

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-06T10:13:09.613

检查`AutoSizeRowsMode`设置为`DataGridViewAutoSizeRowsMode.None`。我发现未设置为默认值无`Errortext`时，不显示行预览图标。`AutoSizeRowsMode`

```
DataGridView1.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.None 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-10-29T15:27:05.523

这对于原始海报来说有点晚了，但这里为我解决了它......

**检查行高**。如果小于**19**则不会绘制图标。尝试将其设置得更高一点，看看是否是问题所在。

```
grid.RowTemplate.Height = 22 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-06-14T21:08:31.230

如果将 e.Cancel 设置为 True，则不会显示该图标。这不会让用户知道该行存在问题。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-20T21:04:12.937

`DataGridView`必须在设置属性时可见`ErrorText`。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-04-21T09:35:45.213

如果您使用的是*Visual Studio 2017*并且您的数据未绑定到数据源，则必须在**单元格**而不是行上设置**ErrorText ，如下所示：**

 **```
gvwWebsites.Rows[e.RowIndex].Cells[e.ColumnIndex].ErrorText = "You have already used that address."; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-08-07T12:08:54.247

检查`dgv.ShowRowErrors`财产。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-11-14T21:37:36.303

未显示错误图标的另一个原因是，如果行标题太小。默认情况下，它是 46。如果由于某种原因将行标题设置为较小的大小，例如 30，则不会显示错误图标。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-11-28T10:20:05.403

我在验证用户输入时遇到了类似的问题

```
private void gridGrid_CellValidating(object sender, DataGridViewCellValidatingEventArgs e) 
```

处理程序。问题是我`e.Cancel=true`在输入无效的情况下设置。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-10-18T10:45:13.180

如果其他人现在仍在搜索：对我有用的解决方案是将（相同的）DataSource 重新分配给 DataGridView，并在设置 RowError 属性后调用网格上的 Refresh 方法。

（VB.Net代码：）

```
myDataGridView.DataSource = myDataSet.Tables(0) 
myDataGridView.Refresh() 
```

之后，新分配的 RowError 终于显示出来了。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-11-16T07:14:41.753

我相信错误只会在编辑时显示。您可以做的是向您的 DataTable 添加一个 bool 列，它驱动 DataGridView 中图像/自定义列的显示，反映是否存在错误。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2013-05-12T05:03:41.973

发送 ESC 击键将强制它显示（至​​少对我有用）

```
SendKeys.Send("{ESC}"); 
```

# vmware - VMWare Fusion 2 是否具有类似于 VMWare Workstation 的“链接克隆”功能？

> ID：291482
> 
> 赞同：0
> 
> 时间：2008-11-14T21:21:15.823
> 
> 标签：vmware, virtualization

标题几乎说明了一切，但对于那些熟悉最新的 VMWare Fusion 和 VMWare 工作站中的“链接克隆”功能的人来说，您能否确认此功能目前在 Fusion 中是否存在或不存在？

这可以被认为是对上一个问题的更新： [Replaceing Virtual PC/Server with VMWare Fusion/Server for Development Environments](https://stackoverflow.com/questions/61775/replacing-virtual-pcserver-with-vmware-fusionserver-for-development-environments)

这表明 Fusion 不支持链接克隆，但看起来它可能是在 Fusion 2.0 发布之前编写的。

我倾向于怀疑它没有，因为相应产品页面上的信息突出了 Workstation 的功能，但根本没有提到 Fusion。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T08:13:20.690

VMWare Fusion 确实*支持*链接克隆，但没有为您提供创建它们的 GUI。

快速查看[http://communities.vmware.com/docs/DOC-5611](http://communities.vmware.com/docs/DOC-5611)了解详细信息。简而言之，您将创建基础 VM，将其虚拟硬盘复制到安全的地方，然后使用初始硬盘作为基础手动生成新的 VM。这是一个非常简单的过程，您最终会得到您想要的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T23:35:08.127

VMWare fusion 2 没有 VMWorkstation 之类的克隆功能。您必须将 vm 文件夹物理复制到新位置才能“克隆”vm。痛苦是的，但这是我们多年来对 VMServer 所做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T15:49:32.173

fusion 2 完全支持链接克隆，除了实际创建它们。如果您使用工作站创建克隆，则可以在 fusion 2 中运行它们，而不会出现任何问题或功能缺失。

# java - 哪个库/程序可用于生成 Java 字节码？

> ID：291492
> 
> 赞同：15
> 
> 时间：2008-11-14T21:24:38.000
> 
> 标签：java, jvm, bytecode

我知道[BCEL](http://jakarta.apache.org/bcel/)，但是这个项目似乎已经死了，因为它已经两年没有发布了。Java 世界继续前进。例如 JDK 1.6 有一个新的类文件格式。

那么什么库可以用来为JVM创建字节码。如果没有库，程序也可以，如果我可以详细操作生成的代码，例如字节码汇编器。

有什么软件可以推荐？是不是也很容易使用？有很好的例子/教程吗？

编辑：对于所有的问题：是的，javac 很好。但是为了在运行时生成一些类，直接指向字节码的路径会更干净。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-14T21:28:20.003

ASM

[http://asm.objectweb.org/](http://asm.objectweb.org/)

它比 BCEL 快得多，并且支持泛型和注释。关于其架构的一点：为了确保高性能 ASM 是围绕抛出事件的解析器构建的（与解析器构建数据结构的 BCEL 形成对比）。这有点类似于 SAX 和 DOM 解析器之间的区别。需要一些练习才能习惯这种思维方式。

编辑（根据 McDowell 的评论）：确实访问者在 ASM 中被大量使用，但它不仅仅是普通的访问者：访问的数据结构是由解析器懒惰地构建的，所以如果你对类文件的某些部分不感兴趣（例如，您想知道方法的名称但不关心它们的主体），您可以从 visitMethod() 方法返回 null。这将使解析器跳过方法主体部分，从而防止（昂贵的）构建完全描述该方法的对象网络。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-06T06:08:41.320

在 CAL（JVM 的类似 Haskell 的语言）的实现中，有一个使用 ASM 从类似 Java 的中间语言生成字节码的相当完整的示例。如果您在[http://openquark.org/Open_Quark/Download.html](http://openquark.org/Open_Quark/Download.html)下载源 代码，那么您可以在 AsmJavaByteCodeGenerator.java 中找到代码，并在同一文件夹中找到 java 模型类。生成的代码基本上就是 javac 会做的，减去调试注释。

CAL 实现最初使用 BCEL，但切换到 ASM，因为 ASM 明显更快（可能是一个数量级），同样重要的是，ASM 是线程安全的，因此可以进行并发编译，这是 CAL 所需要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T22:45:54.450

[Javassist](http://www.csg.is.titech.ac.jp/~chiba/javassist/)和[cglib](http://cglib.sourceforge.net/)是两个很好的字节码工程库。它们在 Java EE 世界中被广泛用于在运行时生成对象代理。Hibernate 和 Spring 是使用这些库的两个主要框架。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T21:00:42.083

[http://serp.sourceforge.net/](http://serp.sourceforge.net/)是一个很棒的库，可以在编辑字节码时进行更多抽象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-15T00:23:59.430

有 asm 和 cglib 之类的技术，但我推荐[Javaassist](http://www.csg.is.titech.ac.jp/~chiba/javassist/)，因为它是一个非常好的库，您可以在 Tapestry5 框架中找到[示例](http://tapestry.apache.org/tapestry5/)。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-11-14T21:25:56.843

我认为我最喜欢的 java 字节码创建器叫做 javac，你可以在 www.sun.com 找到它

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2008-11-14T21:26:24.563

为什么不使用 Java 编译器 javac？用它来生成 JVM 字节码有什么问题？

[严重地。是什么阻止您获取源代码、制作 Java 并编译它？]

# oracle - Oracle 检查约束

> ID：291493
> 
> 赞同：3
> 
> 时间：2008-11-14T21:25:07.310
> 
> 标签：oracle, constraints

我已经为这个检查约束苦苦挣扎了几个小时，并希望有人能善意地解释为什么这个检查约束没有做我认为应该做的事情。

```
ALTER TABLE CLIENTS
add CONSTRAINT CHK_DISABILITY_INCOME_TYPE_ID CHECK ((IS_DISABLED IS NULL AND DISABILITY_INCOME_TYPE_ID IS NULL) OR (IS_DISABLED = 0 AND DISABILITY_INCOME_TYPE_ID IS NULL) OR (IS_DISABLED = 1)); 
```

从本质上讲，您必须是残疾才能收取残疾收入。似乎此检查约束的第一部分`(IS_DISABLED IS NULL AND DISABILITY_INCOME_TYPE_ID IS NULL)`未强制执行（见下文）。

可用值为`DISABILITY_INCOME_TYPE_ID`1 和 2，通过外键强制执行。两者都可以为空`IS_DISABLED`。`DISABILITY_INCOME_TYPE_ID`

```
-- incorrectly succeeds (Why?)
INSERT INTO CLIENTS (IS_DISABLED, DISABILITY_INCOME_TYPE_ID) VALUES (null, 1);
INSERT INTO CLIENTS (IS_DISABLED, DISABILITY_INCOME_TYPE_ID) VALUES (null, 2);

-- correctly fails
INSERT INTO CLIENTS (IS_DISABLED, DISABILITY_INCOME_TYPE_ID) VALUES (0, 1);
INSERT INTO CLIENTS (IS_DISABLED, DISABILITY_INCOME_TYPE_ID) VALUES (0, 2);

-- correctly succeeds
INSERT INTO CLIENTS (IS_DISABLED, DISABILITY_INCOME_TYPE_ID) VALUES (0, null);
INSERT INTO CLIENTS (IS_DISABLED, DISABILITY_INCOME_TYPE_ID) VALUES (1, 1);
INSERT INTO CLIENTS (IS_DISABLED, DISABILITY_INCOME_TYPE_ID) VALUES (1, 2);
INSERT INTO CLIENTS (IS_DISABLED, DISABILITY_INCOME_TYPE_ID) VALUES (1, null);
INSERT INTO CLIENTS (IS_DISABLED, DISABILITY_INCOME_TYPE_ID) VALUES (null, null); 
```

谢谢你的帮助，迈克尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-15T00:47:06.217

虽然我没有 Oracle，但我使用 PostgreSQL 和您的第一个示例（`IS_DISABLED`being`NULL`和`DISABILITY_INCOME_TYPE_ID`being 1）进行了快速测试：

```
postgres=> select (null is null and 1 is null);
 ?column?
----------
 f
(1 registro)

postgres=> select (null is null and 1 is null) or (null = 0 and 1 is null);
 ?column?
----------
 f
(1 registro)

postgres=> select (null is null and 1 is null) or (null = 0 and 1 is null) or (null = 1);
 ?column?
----------

(1 registro) 
```

在这里我们清楚地看到，在这种情况下，您的表达式（至少在 PostgreSQL 上）返回 NULL。从[手册](http://www.postgresql.org/docs/8.3/interactive/sql-createtable.html)中，

> [...] 评估为 TRUE 或 UNKNOWN 的表达式成功。如果插入或更新操作的任何行产生 FALSE 结果，则会引发错误异常，并且插入或更新不会改变数据库。[...]

因此，如果 Oracle 的行为与 PostgreSQL 相同，则检查约束将*通过*.

要查看是否是这种情况，请通过明确检查它并查看它是否有效来避免 NULL 恶作剧：

```
CHECK ((IS_DISABLED IS NULL AND DISABILITY_INCOME_TYPE_ID IS NULL)
    OR (IS_DISABLED IS NOT NULL AND IS_DISABLED = 0 AND DISABILITY_INCOME_TYPE_ID IS NULL)
    OR (IS_DISABLED IS NOT NULL AND IS_DISABLED = 1)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T21:28:57.630

尝试在检查条件中使用[NVL 。](http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/functions110.htm#SQLRF00684)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T22:00:33.823

我不确定为什么复合检查不起作用，但这有效：

```
ALTER TABLE CLIENTS ADD CONSTRAINT CHK_1 CHECK (IS_DISABLED = 0 AND DISABILITY_INCOME_TYPE_ID IS NULL)

ALTER TABLE CLIENTS ADD CONSTRAINT CHK_2 CHECK (IS_DISABLED IS NULL AND DISABILITY_INCOME_TYPE_ID IS NULL)

ALTER TABLE CLIENTS ADD CONSTRAINT CHK_3 CHECK (IS_DISABLED = 1) 
```

问候 K

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-15T07:57:52.107

此解决方案有效。

```
CHECK
((IS_DISABLED IS NULL AND NVL(DISABILITY_INCOME_TYPE_ID, 0) = 0)
OR (IS_DISABLED = 0 AND NVL(DISABILITY_INCOME_TYPE_ID, 0) = 0) 
OR (IS_DISABLED IS NOT NULL AND IS_DISABLED = 1)); 
```

# python - Python 异常回溯告诉我行在哪里结束，从哪里开始？

> ID：291508
> 
> 赞同：2
> 
> 时间：2008-11-14T21:31:10.683
> 
> 标签：python, exception

当跨越多行的代码引发 Python 异常时，例如：

```
 myfoos = [foo("bar",
                "baz",
                "quux",
                 i) for i in range(10)] 
```

Python 将报告最后一行的行号，并显示该行的代码片段：

```
Traceback (most recent call last):
  File "test.py", line 4, in <module>
    i) for i in range(10)]
NameError: name 'foo' is not defined 
```

有没有办法确定第一行是什么？有什么方法可以捕获异常并操作[回溯](http://docs.python.org/library/traceback.html)对象以便能够报告类似这样的内容：

```
Traceback (most recent call last):
 File "test.py", lines 1-4 in <module>
   myfoos = [foo("bar",
                "baz",
                "quux",
                 i) for i in range(10)]
 NameError: name 'foo' is not defined 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-15T12:50:51.157

找到行首将非常困难。您必须解析 Python 或者深入研究编译后的字节码。标准库中有用于解析 Python 的模块，但我可以根据经验告诉你，解释它们的输出是一种魔法。而且我不确定编译后的字节码是否有答案......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T21:59:29.410

在 try/except 块中，您可以排除 NameError 并尝试设置 NameError.lineno，尽管我不确定这是否或如何工作，但这是迄今为止我发现的最好的。

```
try:
    somecode
except NameError
    NameError.lineno = [1,4] 
```

您必须以某种方式弄清楚语句在哪里开始和结束，以及哪个语句引发了错误。

希望这可以帮助

# wpf - ViewModel 中的 INotifyPropertyChanged 与 DependencyProperty

> ID：291518
> 
> 赞同：368
> 
> 时间：2008-11-14T21:33:17.513
> 
> 标签：wpf, data-binding, architecture, mvvm, dependency-properties

在 Model-View-ViewModel 架构 WPF 应用程序中实现 ViewModel 时，似乎有两个主要选择如何使其可数据绑定。我已经看到了使用`DependencyProperty`View 将要绑定的属性的实现，并且我看到了 ViewModel 的实现`INotifyPropertyChanged`。

我的问题是我什么时候应该更喜欢其中一个？有性能差异吗？将 ViewModel 依赖项提供给 WPF 真的是一个好主意吗？在做出设计决定时我还需要考虑什么？

* * *

## 回答 #1

> 赞同：221
> 
> 时间：2009-04-23T19:15:39.263

Kent 写了一篇关于这个主题的有趣博客：[View Models: POCOs vs DependencyObjects](http://kent-boogaart.com/blog/view-models-pocos-versus-dependencyobjects)。

**简短的摘要：**

1.  DependencyObjects 未标记为可序列化
2.  DependencyObject 类覆盖并封装了 Equals() 和 GetHashCode() 方法
3.  DependencyObject 具有线程亲和性——它只能在创建它的线程上访问

我更喜欢 POCO 方法。可以在此处找到实现 INotifyPropertyChanged 接口的 PresentationModel（又名 ViewModel）的基类：http: [//compositeextensions.codeplex.com](http://compositeextensions.codeplex.com)

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2010-11-03T16:45:21.567

根据 WPF 性能指南，DependencyObjects 的性能肯定优于实现 INotifyPropertyChanged 的​​ POCO：

[http://msdn.microsoft.com/en-us/library/bb613546.aspx](http://msdn.microsoft.com/en-us/library/bb613546.aspx)

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-11-14T22:22:24.997

选择完全基于您的业务逻辑和 UI 抽象级别。如果您不想要良好的分离，那么 DP 将为您工作。

DependencyProperties 将主要适用于 VisualElements 级别，因此如果我们为每个业务需求创建大量 DP，这不是一个好主意。DP 的成本也比 INotifyPropertyChanged 高。当您设计 WPF/Silverlight 时，请尝试将 UI 和 ViewModel 完全分开，以便我们可以随时更改布局和 UI 控件（基于主题和样式）

另请参阅这篇文章 - [https://stackoverflow.com/questions/275098/what-applications-could-i-study-to-understand-datamodel-view-viewmodel](https://stackoverflow.com/questions/275098/what-applications-could-i-study-to-understand-datamodel-view-viewmodel)。该链接有很多对 Model-View-ViewModel 模式的参考，这与本次讨论非常相关。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-11-15T23:35:40.463

从表现力的角度来看，我非常喜欢使用依赖属性并且一想到`INotifyPropertyChanged`. 除了`string`属性名称和由于事件订阅可能导致的内存泄漏之外，`INotifyPropertyChanged`还有一种更明确的机制。

依赖属性意味着使用易于理解的静态元数据“当这个做那个”。这是一种声明式的方法，让我对优雅投了赞成票。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2011-11-09T10:07:49.730

依赖属性旨在支持 UI 元素上的绑定（作为目标），而不是作为数据绑定的源，这就是 INotifyProperty 的用武之地。从纯粹的角度来看，您不应该在 ViewModels 上使用 DP。

“要成为绑定的源，属性不必是依赖属性；您可以使用任何 CLR 属性作为绑定源。但是，要成为绑定的目标，该属性必须是依赖属性。要使单向或双向绑定有效，源属性必须支持传播到绑定系统和目标的更改通知。对于自定义 CLR 绑定源，这意味着该属性必须支持 INotifyPropertyChanged。集合应支持 INotifyCollectionChanged。”

所有依赖对象都无法序列化（这可能会妨碍 ViewModel 和 DTO (POCO) 的使用。

Silverlight 中的 DP 与 WPF 之间存在差异。

[http://msdn.microsoft.com/en-us/library/cc221408(v=VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc221408(v=VS.95).aspx)

[http://msdn.microsoft.com/en-us/library/cc903933(VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc903933(VS.95).aspx)

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-02-13T19:18:19.077

`INotifyPropertyChanged`使用时，您还可以在属性的 getter 和 setter 代码中添加更多逻辑。

`DependencyProperty`例子：

```
public static DependencyProperty NameProperty = DependencyProperty.Register( "Name", typeof( String), typeof( Customer ) );

public String Name
{
    set { SetValue( NameProperty, value ); }
    get { return ( String ) GetValue( NameProperty ); }
} 
```

在你的getter和setter中——你所能做的就是分别调用SetValue和GetValue，b/c在框架的其他部分不调用getter/setter，而是直接调用SetValue、GetValue，所以你的属性逻辑不会可靠地执行。

用`INotifyPropertyChanged`，定义一个事件：

```
public event PropertyChangedEventHandler PropertyChanged; 
```

然后只需在代码中的任何位置添加任何逻辑，然后调用：

```
// ...
// Something cool...
// ...

if( this.PropertyChanged != null )
{
    PropertyChanged( this, new PropertyChangedEventArgs( "Name" ) );
}

// More cool stuff that will reliably happen... 
```

这可以在 getter/setter 或其他任何地方。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-14T23:17:19.287

> 将 ViewModel 依赖项提供给 WPF 真的是一个好主意吗？

.NET 4.0 将具有 System.Xaml.dll，因此您不必依赖于任意框架即可使用它。请参阅[Rob Relyea](http://blogs.windowsclient.net/rob_relyea/archive/2008/10/31/pdc08-news-xaml-in-net-4-xaml2009-amp-system-xaml-dll.aspx)关于他的 PDC 会议的帖子。

**我的看法**

XAML 是一种描述对象的语言，而 WPF 是一个框架，其描述的对象是 UI 元素。

它们的关系类似于 C#（一种用于描述逻辑的语言）和 .NET（一种实现特定类型逻辑的框架）。

XAML 的目的是声明性对象图。W*F 技术非常适合这种范式，但 XAML 独立于它们而存在。

XAML 和整个依赖系统被实现为 WF 和 WPF 的单独堆栈，可能是为了利用不同团队的经验，而不在它们之间创建依赖关系（没有双关语）。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-11-24T17:16:32.707

我最近也不得不考虑这个决定。

我发现 INotifyPropertyChanged 机制更适合我的需求，因为它允许我将我的 GUI 粘合到现有的业务逻辑框架而不复制状态。我使用的框架有自己的观察者模式，很容易将一个级别的通知转发到下一个级别。我只是有一个类，它从我的业务逻辑框架和 INotifyPropertyChanged 接口实现了观察者接口。

使用 DP，您无法自己定义存储状态的后端。我将不得不让.net 缓存我绑定到的每个状态项的副本。这似乎是不必要的开销——我的状态很大而且很复杂。

所以在这里我发现 INotifyPropertyChanged 更适合将属性从业务逻辑公开到 GUI。

话虽这么说，我需要一个自定义 GUI 小部件来公开一个属性，并更改该属性以影响其他 GUI 小部件 DP 证明了简单的解决方案。

所以我发现 DP 对于 GUI 到 GUI 的通知很有用。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2014-10-28T21:04:28.717

依赖属性是自定义控件创建的粘合剂。如果您有兴趣在 XAML 设计时使用 Intelli-sense 在属性窗口中显示您的属性，则必须使用 Dependency 属性。INPC 永远不会在设计时在属性窗口中显示属性。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-03-25T01:59:11.477

似乎应该在您创建的控件（例如按钮）中使用依赖属性。若要在 XAML 中使用属性并使用所有 WPF 功能，这些属性必须是依赖属性。

但是，您的 ViewModel 最好使用 INotifyPropertyChanged。如果需要，使用 INotifyPropertyChanged 将使您能够拥有 getter/setter 逻辑。

我建议查看 Josh Smith 的已经实现 INotifyPropertyChanged 的​​ ViewModel 的基类版本：

[http://joshsmithonwpf.wordpress.com/2007/08/29/a-base-class-which-implements-inotifypropertychanged/](http://joshsmithonwpf.wordpress.com/2007/08/29/a-base-class-which-implements-inotifypropertychanged/)

我认为这是一个很好的例子来说明如何做一个 ViewModel。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2010-09-02T18:37:07.253

我认为 DependencyProperty 和 INotifyPropertyChanged 用于 Binding 中的两个不同的事情：第一个用于使属性成为绑定的目标并接收来自另一个属性的输入（使用 {Binding ...} 设置属性），最后一个当您希望将属性的值用作绑定的源（绑定路径表达式中的名称）时。所以选择仅仅是技术性的。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-12-30T13:15:14.593

我更喜欢更直接的方法，我在[没有 INotifyPropertyChanged 的​​ Presentation Model](http://www.adventuresinsoftware.com/blog/?p=284)中写过博客。使用数据绑定的替代方法，您可以直接绑定到 CLR 属性，而无需任何簿记代码。您只需在视图模型中编写普通的 .NET 代码，它会在您的数据模型更改时更新。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2011-03-27T20:18:30.787

只有一件事为什么更喜欢 a `DependencyObject`- Binding 会更好。只需尝试一个带有`ListBox`and的示例，`TextBox`使用来自属性的数据填充列表`INotifyPropertyChanged`vs.`DependencyProperty`并编辑来自`TextBox`...的当前项目

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-02-03T21:05:21.793

如果你想向其他控件公开属性，你必须使用依赖属性......但是祝你好运，因为它们需要一段时间才能弄清楚......

# windows - CurrentControlSet 与 ControlSet001 和 ControlSet002 有何不同？

> ID：291519
> 
> 赞同：58
> 
> 时间：2008-11-14T21:34:11.380
> 
> 标签：windows, registry

在 Windows 注册表中，与和有何`CurrentControlSet`不同 ？为所有用户安装时应该设置哪个？`ControlSet001``ControlSet002`

我们正在尝试为所有用户添加一个环境变量。它是否正确？

```
HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Envinronment 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-11-14T21:38:45.863

是的，您只需要更新`CurrentControlSet`密钥...

`ControlSet001`并且`ControlSet002`是 的交替备份 `CurrentControlSet`，您不需要更新它们。

编辑：正如 K 所指出的，`CurrentControlSet`是一个交替的符号链接 `ControlSet001`或`ControlSet002`. 另一个密钥作为 Load Last Known Good Configuration 引导选项的备份保留。

编辑 2：请参阅 Microsoft 知识库文章 100010：什么是控制集？什么是 CurrentControlSet？
[原始页面链接已损坏](http://support.microsoft.com/kb/100010)，请参阅[archive.org 备份页面](https://web.archive.org/web/20150217152952/http://support.microsoft.com/kb/100010)。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-14T23:30:49.990

`CurrentControlSet`正如戈登所说，从技术上讲，它不是“备份”。
它是指向计算机上其中一个`ControlSet`s 的符号链接。它总是指向`ControlSet`当前加载的那个。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-02-16T14:53:37.913

实际的符号链接匹配在：`HKEY_LOCAL_MACHINE\SYSTEM\Select\`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-28T02:43:46.387

ControlSet001 可能是您启动时使用的最后一个控件集，而 ControlSet002 可能是所谓的最后一个已知良好的控件集，或者是上次成功启动 Windows 的控件集

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-15T06:44:25.293

`CurrentControlSet`子键实际上是指向其中一个键的指针`ControlSetXXX` 。

最有价值和最可靠的控制集是`CurrentControlSet`. 如果您需要修改注册表中的系统设置，`CurrentControlSet`最好选择子项，因为您知道它是正确的控件集。

# mysql - MySQL 安装和配置向导的静默/无用户交互模式？

> ID：291521
> 
> 赞同：2
> 
> 时间：2008-11-14T21:35:22.580
> 
> 标签：mysql, installation, silent

我正在为我们的一种产品实施安装程序，该产品需要 MySQL 作为先决条件。我想要一个引导程序，向用户查询任何必备产品和我们的产品所需的任何信息。一旦用户输入了所有必要的信息，他们可以按下下一步并在安装过程中走开。

我知道 MySQl 安装能够执行静默安装，因为它是一个 Windows 安装程序包。有人可以提供我可以在调用 msiexec 时在命令行上设置的属性列表吗？

安装过程的另一部分是运行配置向导，只有在提供用户交互的情况下，它才会在 MySQL 安装结束时自动启动。我想知道是否有任何参数可以传递给 MySQLInstanceConfig.exe 以便在不需要用户交互的情况下配置我的 MySQl 实例？

我期待您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-12T14:58:08.557

试试这个： [http ://hamidseta.blogspot.com/2008/05/install-mysql-server-50-silently.html](http://hamidseta.blogspot.com/2008/05/install-mysql-server-50-silently.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T22:00:24.043

在 musql foruns 上查看，我[在这个主题上找到了这篇文章](http://forums.mysql.com/read.php?11,26486,26486)。

希望能帮助到你。

# c# - WPF：如何在运行时将新菜单项添加到菜单中？

> ID：291522
> 
> 赞同：21
> 
> 时间：2008-11-14T21:35:52.000
> 
> 标签：c#, wpf

我有一个带有菜单的简单 WPF 应用程序。我需要在运行时动态添加菜单项。当我简单地创建一个新菜单项并将其添加到其父 MenuItem 时，无论是否调用 UpdateLayout，它都不会显示在菜单中。

允许菜单在运行时动态添加附加项必须发生什么？

注意：以下代码不起作用。

```
 MenuItem mi = new MenuItem();
            mi.Header = "Item to add";
            mi.Visibility = Visibility.Visible;
            //addTest is a menuitem that exists in the forms defined menu
            addTest.Items.Add(mi);
            addTest.UpdateLayout(); 
```

目前，默认菜单项在 xaml 文件中定义。我想在此菜单及其现有菜单项上添加其他菜单项。但是，如上所述，上面的代码什么也没做。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-14T21:47:33.430

```
//Add to main menu
MenuItem newMenuItem1 = new MenuItem();
newMenuItem1.Header = "Test 123";
this.MainMenu.Items.Add(newMenuItem1);

//Add to a sub item
MenuItem newMenuItem2 = new MenuItem();
MenuItem newExistMenuItem = (MenuItem)this.MainMenu.Items[0];
newMenuItem2.Header = "Test 456";
newExistMenuItem.Items.Add(newMenuItem2); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-07-10T09:02:04.200

我已成功将菜单项添加到预定义的菜单项。在以下代码中，LanguageMenu 在 xaml 中的设计视图中定义，然后在 C# 中添加子项。

XAML：

```
<MenuItem Name="LanguageMenu" Header="_Language">
  <MenuItem Header="English" IsCheckable="True" Click="File_Language_Click"/>
</MenuItem> 
```

C＃：

```
// Clear the existing item(s) (this will actually remove the "English" element defined in XAML)
LanguageMenu.Items.Clear(); 

// Dynamically get flag images from a specified folder to use for definingthe menu items 
string[] files = Directory.GetFiles(Settings.LanguagePath, "*.png");
foreach (string imagePath in files)
{
  // Create the new menu item
  MenuItem item = new MenuItem();

  // Set the text of the menu item to the name of the file (removing the path and extention)
  item.Header = imagePath.Replace(Settings.LanguagePath, "").Replace(".png", "").Trim("\\".ToCharArray());
  if (File.Exists(imagePath))
  {
    // Create image element to set as icon on the menu element
    Image icon = new Image();
    BitmapImage bmImage = new BitmapImage();
    bmImage.BeginInit();
    bmImage.UriSource = new Uri(imagePath, UriKind.Absolute);
    bmImage.EndInit();
    icon.Source = bmImage;
    icon.MaxWidth = 25;
    item.Icon = icon;
  }

  // Hook up the event handler (in this case the method File_Language_Click handles all these menu items)
  item.Click += new RoutedEventHandler(File_Language_Click); 

  // Add menu item as child to pre-defined menu item
  LanguageMenu.Items.Add(item); // Add menu item as child to pre-defined menu item
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-12-04T16:03:32.790

我遇到了同样的问题。在我的情况下，问题是在 XAML`<menuitem>`中直接包含在`<toolbar>`. 一旦我把它放在`<menuitem>`里面，`<menu>`它就开始工作了。所以：

```
<toolbar>
   <menuitem>
   </menuitem>
</toolbar> 
```

不好

```
<toolbar>
    <menu>
        <menuitem>
        </menuitem>
    </menu>
</toolbar> 
```

很好

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-15T19:14:34.557

我确实必须为我打算为其动态创建子项目的现有项目提供名称。此外，我遇到了一个问题，我正在利用 Window_Loaded 事件，并且在运行此事件后它跳出事件：

```
row.MoveFocus(new TraversalRequest(FocusNavigationDirection.First)); 
```

在运行上面的行之前，我必须确保我加载了菜单项。

这个问题可能很常见的原因是智能感知推断 Items 集合是“只读的”。这个答案是部分补充，因为上面的答案似乎表明，如果你有预先存在的项目，你要么必须在代码中删除它们，要么根本没有它们。这不是真的。我已经能够使用预先存在的项目并在代码中添加其他动态菜单项：

```
 <DataGrid AutoGenerateColumns="False" HorizontalAlignment="Stretch" Margin="12,29,12,12" Name="grid" VerticalAlignment="Stretch" Background="#FF3A81A0" AlternatingRowBackground="#FFD9EEF2" FontSize="15" RowHeaderWidth="0" KeyDown="grid_KeyDown">
        <DataGrid.ContextMenu>
            <ContextMenu>
                <MenuItem Header="_Encrypt Row Values" Click="MenuItem_ContextMenu_Click_EncryptRowValues" Name="MenuItem_EncryptRowValues" />
                <MenuItem Header="De_crypt Row Values" Click="MenuItem_ContextMenu_Click_DecryptRowValues" Name="MenuItem_DecryptRowValues" />
                <MenuItem Header="Copy Row_s" Click="MenuItem_ContextMenu_Click_CopyRows" />
            </ContextMenu>
        </DataGrid.ContextMenu>
        <DataGrid.Resources>

            //Add Encryption Menu Items
            for (int i=0; i< encryptionKeys.Count; i++)
            {
                MenuItem keyOption = new MenuItem();
                keyOption.Header = "_" + i.ToString() + " " + encryptionKeys[i];
                MenuItem_EncryptRowValues.Items.Add(keyOption);
            }

            //Add Decryption Menu Items
            for (int i = 0; i < encryptionKeys.Count; i++)
            {
                MenuItem keyOption = new MenuItem();
                keyOption.Header = "_" + i.ToString() + " " + encryptionKeys[i];
                MenuItem_DecryptRowValues.Items.Add(keyOption);
            } 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-12-18T12:14:21.653

ASP.NET -> WEB 表单 -> 创建菜单

```
CREATE TABLE `webmenu` (
  `idmenu` smallint(5) NOT NULL,
  `submenu` smallint(5) DEFAULT NULL,
  `menu_title` varchar(45) DEFAULT NULL,
  `menu_url` varchar(45) DEFAULT NULL,
  `status` enum('1','0') DEFAULT '1',
  PRIMARY KEY (`idmenu`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

SELECT 
idmenu,
(select menu_title from webmenu where idmenu=wm.submenu and status='1') as childmenu,
menu_title,
menu_url 
FROM tartyp.webmenu as wm
where
status='1'
order by idmenu, submenu; 
```

* * *

```
 cmd = new MySql.Data.MySqlClient.MySqlCommand(queryStr, conn);

        reader = cmd.ExecuteReader();
        MainMenu.Items.Clear();
        while (reader.Read())
        {

            if (reader["childmenu"] == DBNull.Value)
            {
                MenuItem homeMenuItem = new MenuItem(reader["menu_title"].ToString(), reader["menu_url"].ToString());
                MainMenu.Items.Add(homeMenuItem);
            }
            else
            {
                String childmenu = reader["childmenu"].ToString();                    

                for (int i = 0; i < MainMenu.Items.Count; i++)
                {
                    if (MainMenu.Items[i].Text == childmenu)
                    {                                                       
                        MenuItem childMenuItem = new MenuItem(reader["menu_title"].ToString(), reader["menu_url"].ToString());
                        MenuItem findMenuItem = MainMenu.Items[i];
                        findMenuItem.ChildItems.Add(childMenuItem);
                        break;    
                    }
                }
            }

        }
        reader.Close();
        conn.Close(); 
```

# html - Safari Frames 不可见的滚动条

> ID：291527
> 
> 赞同：3
> 
> 时间：2008-11-14T21:38:34.680
> 
> 标签：html, safari, scroll, frames, frameset

我正在开发的网站不仅使用框架，还使用框架内的框架（嗯，我知道，但我无法选择）。它实际上在大多数情况下都可以正常工作，但我遇到了 Safari 中框架内的某些框架的问题（仅限）。

一些两深的框架在 Safari 中呈现，在框架的右侧有一个小空间 - 我认为它只是滚动设置为“no”的那些，但摆弄滚动设置还没有修复它. 它基本上看起来应该有一个滚动条，但没有。

我一直在研究这个并尝试了很多东西：更改行的高度，更改滚动设置，添加`colls='100%'`标签，更改框架内容的高度，以及检查以确保宽度是始终设置为 100%。到目前为止还没有解决任何问题。

有谁知道这里发生了什么？

这是代码的基本要点和一些屏幕截图 - 请原谅缺少正确的引号；它仍然在这个代码库中渲染和修复它们将是一场失败的战斗：

```
<html>
    <frameset id=fset frameborder=0 border=0 framespacing=0 onbeforeunload="onAppClosing()"  onload="onAppInit()" rows="125px,*,0">
        <frame src="navFrame.html" name=ControlPanel marginwidth=0 marginheight=0 frameborder=0 scrolling=no noresize>
        <frame src="contentFrame.html" name=C marginwidth=0 marginheight=0 frameborder=0 scrolling=no>
        <frame src="invisiFrame.html" name=PING marginwidth=0 marginheight=0 frameborder=0 noresize>
        <noframes><body>Tough luck.</center></body></noframes>
    </frameset></html> 
```

在第二个框架（名为“C”，src 为“contentFrame”）内部是这样的：

```
 <HTML>
    <HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"></head>
    <frameset rows="48px,*,28px" border=0 frameborder=0 framespacing=0>
       <frame src="pageTitle.html" name=Title marginwidth=0 marginheight=0 noresize scrolling=no frameborder=0>
       <frame src="content.html" name=ScreenBody marginwidth=0 marginheight=0 frameborder=0>
       <frame src="submitBar.html" name=ContextPanel marginwidth=0 marginheight=0 frameborder=0 scrolling=no noresize>
    </FRAMESET>
 </HTML> 
```

麻烦的帧是第一帧（名为“Title”，src 为“pageTitle.html”）和最后一帧（名为“ContextPanel”，src 为“submitBar.html”）都将它们的宽度设置为 100% 并且高度为 100%、未设置或小于或等于其行高的值。

这是问题的图像：

![显示 Firefox 和 Safari 中的站点的图像，带有标记的部分](https://farm4.static.flickr.com/3290/3029873741_f42727c4e5_o.gif)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T22:09:48.330

显示滚动条的标题和提交框架可以有 html 正文标签 scroll="no"

```
<body scroll="no"> 
```

因此，无论帧或正常渲染如何，都不会出现滚动条。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T22:33:58.187

您所看到的是当没有足够的空间来绘制整个滚动条小部件集时，Safari 是如何绘制滚动条的。您应该`overflow: hidden`在 CSS 中为`body`您不想滚动的任何框架/页面设置。请注意，Safari 并不完全遵守这些规则（或`scroll="no"`在元素上），因为如果实际上存在超出可见区域的内容，您可以通过拖动选择其内容来实际滚动元素。

# javascript - 到 YUI 还是不到 YUI？

> ID：291534
> 
> 赞同：20
> 
> 时间：2008-11-14T21:41:33.690
> 
> 标签：javascript, yui, yahoo

我目前在我的几个项目中使用 Yahoo YUI javascript 库。

但是，我有点担心三件事。首先，他们解雇了 10% 的员工。其次，他们的股价不断下跌：尤其是在今年早些时候忽略了微软的收购之后。第三，如果有人买了怎么办？

我提出这个问题的唯一原因是我倾向于构建将存在 8 到 10 年的应用程序。

你会怎么办？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-11-15T00:35:51.920

作为 YUI 团队的一员，我想在这次谈话中补充以下内容：几乎所有曾在该团队工作过的人都还在雅虎工作，并且仍在为 YUI 工作——对于一个已经有将近四年历史的项目来说，这是一种非凡的一致性. 目前没有人可以预测雅虎（或任何其他公司）的未来，但您可以依靠您今天使用的代码。它是免费的，在 BSD 下开放，无论将来发生什么，没有人可以阻止您使用它。

我们继续对 YUI 感到兴奋，我们认为它的未来四年将比过去四年更好。

问候， 埃里克

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-11-14T21:51:53.640

雅虎是一家不会在未来几年内结束的大公司。

雅虎！图书馆是开源的，所以如果雅虎破产，你将有其他人继续改进它。

从 10 年的角度来看，没有任何技术是 100% 安全的，我认为您不会因此而处于危险之中。

在 10 年内，Javascript 将完全不同，大多数框架将不一样，所以我认为无论你选择什么，你都需要在 10 年内改变很多东西；）只要确保在你的存储库中保留一个版本的代码始终拥有适用于您系统的最新版本，您会没事的。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-08T01:42:14.820

这里的其他人都已经提到 YUI 是**开源**的（因此可以扩展、分叉等）

但需要注意的重要一点是，雅虎在他们自己的网络资产上**使用 YUI 。**这对他们来说是一个有价值的项目，不仅仅是作为一个内部组件库，而是作为一种编写 JavaScript 代码的标准化方式。一旦你明白了这一点，你就会意识到，如果 Yahoo 还在互联网上，它可能**仍然会将资源投入到 YUI**中。

此外，尽管是 jQuery 的忠实拥护者，但如果没有项目上下文和设计考虑，头脑冷静的开发人员**不能认真地推荐一个特定的框架而不是另一个框架。**

你不能只是假设你的方钉会适合每个人的圆孔，无论你多么努力地把它塞进去。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-14T21:49:02.647

不久前我切换到了 jQuery，并且自从这样做以来一直很开心。您应该考虑 YUI 是开源的这一事实，因此您可以随时进行将来需要的任何更新。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-14T21:43:31.580

切换到 jQuery？

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-02-23T17:51:06.217

我在 JQuery 之前学习了 YUI，而 YUI 的问题是（在我看来）是过度设计的，这意味着它更复杂。JQUery 编码很有趣，同时你可以用它做任何事情。

我的建议是使用 JQuery，如果您需要一些 YUI 组件，请同时使用两者。但是我没有看到 YUI 比 JQuery 有任何特别的优势。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-14T21:46:22.247

即使雅虎！下，他们的图书馆是开源的。社区很可能会接受它并继续其发展。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-11-14T21:59:23.280

我最近切换了 Jquery，生产力的提高是显而易见的。

YUI 确实有更好的文档，但它会破坏 3.0 的兼容性。

将旧代码留在 yui 上，并为新开发者切换到 jquery。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-14T22:28:47.840

我认为说“一个库适用于所有解决方案”并不安全。

分析您所做的每个项目然后决定使用哪个库始终是最佳实践。无论是 jQuery、YUI、mootools 等。

更直言不讳地回答你的问题——别担心。网络是目前发展最快和发展最快的行业之一。如果您的项目在未来 3 到 4 年内没有（由您或其他人）重新开发，我会感到惊讶。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-14T21:53:55.647

如果您的 Web 应用程序以当前形式存在超过 4 年，那就太棒了。这意味着它会处理新的浏览器技术，并且可能会丢失现有的技术。这也意味着该网站在那个时候不需要进行重大修改。

3 年后，我开发的大多数 Web 应用程序几乎都被完全重写了。通常这是因为需求发生了变化；通常在那段时间有太多的添加，以至于它是一个完全不同的软件。

此外，在 8 年内，我确信 YUI 会发生如此大的变化，甚至不会是原来的样子。8 年前它还不存在；8年后可能会完全不同。这并不意味着您不能继续原样使用现有的库。

您可能会想到做的唯一一件事就是自己保留版本。我不是说从您自己的服务器加载它们，而只是将它们保存在某个地方。即使只是以防 YUI 改变了一些东西并最终破坏了你正在使用的东西——不太可能。

我认为任何库都存在同样的问题：YUI 或 jQuery 等。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-16T02:36:24.530

好吧，雅虎仍然是一家盈利的公司，银行存款超过 30 亿美元。我不认为它会很快破产，除非他们做了一些非常糟糕的事情。

然而，雅虎仍然需要削减成本，他们可能会停止开发 YUI，将开发人员转移到其他地方。只是要记住你是否选择继续使用 YUI。在目前的状态下，我不认为 YUI 是雅虎现在需要的收入来源。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-02-23T17:43:58.577

一年前，我在一个项目中使用过 YUI。
即使我发现很难掌握它的工作方式，我也对图书馆非常满意。在我发现 jQuery 并在另一个项目中尝试之后。人，那是另一个世界。
这些天我正在对旧的 YUI 项目进行一些更改。我想把所有东西都移植到 2.8（从 2.4.2 开始）。
我希望它会更容易，但事实并非如此。在 jQuery 上花了几个月后，我必须承认 YUI 过于复杂。
您几乎可以做所有事情并配置应用程序的各个方面，但是，理解事物需要很长时间，或者至少对我来说。
jQuery 更好更快。插件系统很棒。我没有尝试 YUI 3，因为我认为 jQuery 对我来说已经足够好了。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-14T21:44:26.087

如果图书馆做了你今天需要它做的事情，我认为没有理由不使用它。8 到 10 年对于网络应用程序来说是一段很长的时间，但我想 Javascript 仍然会存在。

如果您在使用它时期望它在未来会有很大的进步，那么您的担忧是有道理的，但我认为几乎任何技术/语言/库都可以这样说。而且由于它是开源的，您或其他人可以继续开发。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-14T21:54:52.103

以下是您的选择：
1\. 构建您自己的 Javascript 库
2\. 使用现有的 YUI 库
3\. 使用其他一些 3rd 方 Javascript 库

您可以下载整个 YUI 库并从您自己的 Web 服务器上运行它，因此您不需要依赖 Yahoo 服务器。该代码是开源的，因此如果 Yahoo 停止构建它，您可以自由地自己进行改进。鉴于此，我个人认为使用 YUI 比尝试使用自己的 Javascript 库要好得多。我看到了很多几乎没有风险的好处。

剩下的问题是您是否应该使用 YUI 或其他一些 3rd 方库。几乎所有其他开源库都与 YUI 共享相同的未来风险。我会亲自查看每个库支持的功能，然后选择当前支持您想要的所有功能（或您想要的大部分功能）的功能。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-16T02:26:35.610

首先，它是开源的，因此无论 Yahoo 发生什么情况，您都可以继续使用它。此外，没有人认为他们很快就会去任何地方。

其次，无论你使用什么第三方库或工具，你总是面临着他们在某个时候放弃产品的风险，或者更糟糕的是，公司倒闭。

无论如何，您仍然可以在其中任何一种发生后使用它。直到那时你才真的需要转换吗？此外，Web 的方式一直在变化，无论哪种方式，您可能都不想在几个月内使用 YUI，谁知道呢？

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-04-08T03:32:18.047

jQuery 用于编码，YUI 用于学习。jQuery 比 YUI 更广泛，因为它很容易将它洒在需要简单 DOM 操作和基本 AJAX 或动画的网页上。YUI 是一个非常流行的库，在历史上一直是更高级的开发人员和应用程序构建者的最爱。jQuery 太小太小，所以你必须找到其他框架/库来一起工作。你必须花很多时间研究测试框架、ui 框架。MVC 框架...不过如果你选择 YUI 就够了！！！测试框架（浏览器和无头）、ci 工具、小部件、css 网格/架构、AOP、MVC ......您在一个框架中想要的所有花哨功能！这真的很酷。所以如果你开始一个企业项目，我建议使用 YUI，虽然它的学习曲线有点陡峭。

# html - 如何让 div 垂直填充表格单元格？

> ID：291537
> 
> 赞同：13
> 
> 时间：2008-11-14T21:43:26.917
> 
> 标签：html, css

作为[这个](https://stackoverflow.com/questions/290335/how-can-i-position-an-element-at-the-bottom-of-its-container-in-firefox)关于表格单元格中绝对定位的问题的后续行动，我试图让一些东西在 Firefox 中工作。再一次，我大约 95% 在那里，只有一件小事让我无法宣布胜利。使用以下示例标记：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>Test</title>
        <style type="text/css">
        table { width:500px; border-collapse:collapse}
        th, td { border:1px solid black; vertical-align: top; }
        th { width:100px; }
        td { background:#ccc; }
        .wrap { position:relative; height:100%; padding-bottom:1em; background:#aaa; }
        .manage { text-align:right; position:absolute; bottom:0; right:0; }
        p{ margin: 0 0 5px 0; }
        </style>
    </head>
    <body >
    <table>
        <tr>
                <th>Mauris tortor nulla, sagittis ut, faucibus eu, imperdiet ut, libero.</th>
                <td><div class="wrap"><p>Cras diam.</p><div class="manage">Edit | Delete</div></div></td>
        </tr>
        <tr>
                <th>Cras diam.</th>
                <td><div class="wrap"><p>Cras diam.</p><div class="manage">Edit | Delete</div></div></td>
        </tr>
        <tr>
                <th>Cras diam.</th>
                <td><div class="wrap"><p>Mauris tortor nulla, sagittis ut, faucibus eu, imperdiet ut, libero. Sed elementum. Praesent porta, tellus ut dictum ullamcorper, est ante condimentum metus, non molestie lorem turpis in sapien. Aenean id enim. Nullam placerat blandit ante. Aenean ac ligula.</p><div class="manage">Edit | Delete</div></div></td>
        </tr>
    </table>
    </body>
</html> 
```

如何让 wrap div 始终填充单元格，以便管理区域位于单元格的底部？是的，我放入表格的数据（在我看来）是表格的，所以我想在这里使用一个表格。作为最后的手段，我可​​能会求助于一个丑陋的嵌套 div 解决方案，但由于这里的表在语义上是正确的，所以我想尽可能使用一个。请注意，背景颜色只是为了显示元素的相对大小——我不关心我的布局的背景。另请注意，我希望单元格具有灵活的高度，以便它们仅扩展至足以容纳其内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T22:28:59.337

您可以在表格单元格上放置（相同的）固定高度并因此包装 div：

```
<style type="text/css">
table { width:500px; border-collapse:collapse}
th, td { height:200px; border:1px solid black; vertical-align: top; }
th { width:100px; }
td { background:#ccc; }
.wrap { position:relative; height:200px; padding-bottom:1em; background:#aaa; }
.manage { text-align:right; position:absolute; bottom:0; right:0; }
p{ margin: 0 0 5px 0; }
</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T22:06:08.273

你只是想让背景匹配相同的颜色吗？而不是对齐，那么您可以在 css 中使用背景图像来提供相同的效果，因为 FF 不会将元素渲染到容器内的 100%。如果容器设置为自动高度，则子项也将设置为自动。使渲染更快。

所以最好的选择是 CSS 背景图像。

# visual-studio-2008 - VS2008中的解决方案文件夹不按字母顺序排列

> ID：291545
> 
> 赞同：4
> 
> 时间：2008-11-14T21:45:52.807
> 
> 标签：visual-studio-2008, solution, alphabetized

我将一堆项目移至解决方案文件夹，以将我们的项目列表拆分为可管理的文件夹，现在每个文件夹项目都不是按字母顺序排列的。这只发生在我自己以外的机器上。任何想法如何缓解这种情况？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-21T19:30:58.507

实际上，我确实手动编辑了解决方案文件，但它不起作用（是的，它就像 175 个项目！）哈哈。但是，如果您加载解决方案，然后右键单击并重命名任何文件，当然没有实际重命名，然后单击关闭解决方案将神奇地按字母顺序排列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-14T21:50:16.217

请参阅 MS Connect 上的以下错误信息： [https ://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=312252&wa=wsignin1.0](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=312252&wa=wsignin1.0)

总结一下：“它们在解决方案资源管理器中显示的顺序是它们写入解决方案文件的顺序。但是，如果文件夹在启动时折叠，则在展开时会对其进行排序。”

因此，快速的解决方案是手动编辑解决方案文件并将项目按您希望的顺序放置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-28T10:56:29.220

我找到了一个似乎可以解决问题的工具：http: [//solutionsorter.codeplex.com/](http://solutionsorter.codeplex.com/)

# javascript - javascript 中有没有办法检测卸载事件是通过刷新、后退按钮还是关闭浏览器引起的？

> ID：291553
> 
> 赞同：31
> 
> 时间：2008-11-14T21:48:29.697
> 
> 标签：javascript, events

我目前正在查看窗口的“卸载”事件，试图确定“卸载”事件是如何触发的，但收效甚微。有没有办法确定javascript事件是如何触发的？

*   页面刷新
*   后退按钮（或离开页面）
*   关闭浏览器

本质上，我只需要在关闭浏览器窗口时执行一些代码，而不是刷新或导航离开。

**目的：**当客户更新我们的软件时，更新会将他们的第一个 Internet 请求重定向到报价页面。有一个“请勿打扰”选项的按钮，但有些用户会简单地关闭他们的浏览器。关闭浏览器后，我需要复制“请勿打扰”功能，这样用户就不会再被重定向到优惠页面。由于离开页面的方式不同，简单地附加到“卸载”事件将不起作用。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-14T22:42:07.407

不，如果有，它将取决于浏览器。当用户关闭页面时，你试图运行什么样的代码？是注销用户吗？然后，如果浏览器崩溃或网络连接中断（如果计算机进入睡眠/休眠模式，则可能不会），用户将不会被注销。

如果是出于注销目的，您可能应该在服务器上使用一个时间戳变量，该变量会随每个请求而更新（或使用 ajax-ping），如果在指定时间内未看到该用户，则注销该用户。

更新：在 stackoverflow 上找到[了这个答案。](https://stackoverflow.com/questions/181189/to-detect-if-the-user-is-closing-the-ie-browser-apart-from-onunload-event-as-it)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-17T15:26:50.243

是的，有一个解决方案！

我设计了一个基于 onBeforeUnload+onLoad 事件、HTML5 本地存储和客户端/服务器通信的解决方案。请参阅[https://stackoverflow.com/a/13916847/698168](https://stackoverflow.com/a/13916847/698168)上的详细信息。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2008-11-27T16:26:18.673

我使用一种进行键盘“嗅探”的方法，因为它会查找“F5”、“ctrl+r”、“alt-f4”、“退格”等的 keydown，如果它发现它们在键盘事件中流动队列，它适当地设置布尔变量以捕获该状态......然后我使用“onbeforeunload”函数处理程序，它针对这些布尔状态变量进行测试以决定做什么。

您甚至可以通过在键盘处理中使用 preventDefault()、bubbles=false 和 returnValue=false 来关闭各种键盘敲击（例如“ctrl+n”或“F1”）。

这些东西不适合胆小的人，但通过一些持久性和大量跨浏览器测试肯定是可行的！

# .net - 为什么 VS2005 会寻找它应该生成的文件？

> ID：291558
> 
> 赞同：2
> 
> 时间：2008-11-14T21:49:33.660
> 
> 标签：.net, visual-studio-2005, pocketpc

我正在开发 Visual Studio 2005 中的 PocketPC 应用程序。该解决方案构建良好，然后突然中断。第一个错误是这样的（假设项目是 FooPDA）：

“找不到位于 '%InstallDir%' 中的文件 'FooPDA.exe' 的源文件 'C:\FooPDA\obj\Release\FooPDA.exe'，该文件可能不存在或被锁定。”

这个错误让我很困惑。它正在寻找它应该生成的文件。有人知道这里可能出了什么问题吗？

* * *

**编辑**：项目在版本控制之外构建得很好，*我只需更改项目上的图标*，它就开始抛出这个神秘的错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-15T17:36:51.327

在错误消息中看到 %InstallDir% 可能是一个线索。您的解决方案中有安装和部署项目吗？它是否在您的 FooPDA 项目之前构建？*在obj*中看到它也很可疑。

* * *

**OP 编辑**​​：你在正确的轨道上，所以我会相信你的答案。事实证明，当您进行重建时，Visual Studio 2005 编译器非常愚蠢，因为它在遇到无法编译的项目时不会停止。它只是继续编译和抛出错误。

这个特定的解决方案包含三个项目。我们称它们为FooPDA、PDAComponents 和Setup。我更改了项目 FooPDA 上的图标，解决方案将不再编译。我所关注的错误与实际问题无关。我应该专注于我在进行初始构建时看到的错误，即：

**CVTRES：致命错误 CVT1103：无法读取文件**

我基本上把它搞砸了，并立即进行了重建。就在那时，我发布的错误出现在错误列表的顶部，我被它吸引住了。我不应该的。我最初发布的错误是由于 FooPDA 没有编译，所以 FooPDA.exe 在编译安装项目时不可用。更改图标时 FooPDA 无法编译的原因是**我尝试添加的 .ico 文件包含不兼容的图标大小和/或颜色深度**. 显然紧凑框架（或目标平台，PocketPC 2003？）只了解其中的某些内容。我试图添加的 .ico 文件中嵌入了各种尺寸和颜色深度（一直到 256x256 @32 位）。我查看了最初存在的 .ico 文件，它只有两个 48x48 图标。一个 24 位颜色和一个 8 位。我在图标编辑器中打开了我的新 .ico 文件，并对其进行了修改，使其包含与原始文件相同的大小和颜色深度，并且一切都再次与世界保持一致。解决方案现在使用新图标编译，没问题。

On the one hand, I feel kind of foolish for not figuring this out (I finally asked a coworker who had encountered this before). On the other hand, what the f**k does "CVTRES: fatal error CVT1103: cannot read file" tell me? Nothing! What's wrong with "Error: incompatible icon"?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T21:54:48.173

有时这发生在我的类库等中。如果解决方案没有正确构建，它永远不会到达生成 .exe 文件的地步。

您可以在不运行项目的情况下进行编译，还是在尝试编译时也会遇到相同的错误？

如果可以的话，我会尝试修复任何编译错误并重建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T21:58:43.203

关闭 Visual Studio。清洁您的解决方案。再次构建您的解决方案。

消息是否再次出现？

有时 VS 在编译时会锁定某些文件，它可能会从以前的构建中被锁定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T22:06:30.630

> > “找不到源文件 'C:\FooPDA\obj\Release\FooPDA.exe'

它正在尝试创建文件 C:\FooPDA\ **bin** \Release\FooPDA.exe。

C:\FooPDA\ **obj** \Release\FooPDA.exe 是一个文件（好吧，几乎是唯一一个），它用于创建它（主要是通过复制它）。

听起来好像由于其他原因，构建失败（语法错误等），但构建过程的其余部分没有得到消息，并继续进行。

# c++ - 使用 /clr:pure 项目中的混合 DLL

> ID：291559
> 
> 赞同：1
> 
> 时间：2008-11-14T21:49:59.820
> 
> 标签：c++, dll, visual-studio-2005, clr, mixed-mode

我正在与 Dll 一起构建一个项目。

Dll 必须支持本机代码，因此我将其声明为 /clr。我的项目最初也是一个 /clr 项目，一切都很好。但是我想包含一些 NUnit 测试，所以我不得不将我的主项目从 /clr 切换到 /clr:pure。

一切仍然可以编译，但任何 Dll 调用都会产生运行时错误。当我恢复到 /clr 时一切正常

在我的 Dll 中，导出的函数声明如下：

```
#define DllExport   __declspec( dllexport )
DllExport bool DisplayScan(bool bShow, bool bAllPasses) { } 
```

我还制作了一个 .def 文件，其中包含所有导出函数的真实名称

```
LIBRARY "Controller"
EXPORTS
DisplayScan 
```

在我的主要项目中，我的进口声明如下：

```
#define _DllImport [DllImport("Controller.dll", CallingConvention = CallingConvention::Cdecl)] static
_DllImport bool DisplayScan(bool bShow, bool bAllPasses) 
```

有人遇到过这样的问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T22:31:57.520

好的，现在一切正常

事实上，它从一开始就一直在工作。

道德：不要尝试将 char* 转换为 std::string

奇怪的事情：它在 /clr 中没问题，直到你从函数返回。它立即在 /clr:pure 中崩溃

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T22:36:50.070

基本上你正在做一些不受支持的事情；/clr:pure 和本机 DLL 导出。[正如这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/85344whh.aspx)引用的那样，“纯程序集无法导出可从本机函数调用的函数，因为纯程序集中的入口点使用 __clrcall 调用约定。”

我不确定最好的解决方法。但是，通过一些试验，您可能可以利用带有 /clr 选项的 __clrcall 调用约定。 [这是一个](http://social.msdn.microsoft.com/Forums/en-US/vclanguage/thread/e15d6303-876f-4a40-b9c5-f6945517cd23/)可能有用的链接。据我所知，您应该能够导出这些托管类并从托管程序集（例如托管 NUnit 测试项目）中使用它们，但使用不同的方法签名将非托管导出保留在那里。请记住，一旦您通过导出公开任何 .net 类，就需要使用 __clrcall 调用约定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T06:05:26.907

**/clr:pure 的优点**

更好的性能：因为纯程序集只包含 MSIL，所以没有本机函数，因此不需要托管/非托管转换。（通过 P/Invoke 进行的函数调用是此规则的一个例外。）

AppDomain Awareness：托管函数和 CLR 数据类型存在于应用程序域中，这会影响它们的可见性和可访问性。纯程序集是域感知的（每种类型都隐含 __declspec(appdomain)），因此从其他 .NET 组件访问它们的类型和功能更容易、更安全。因此，纯程序集与其他 .NET 组件的互操作比混合程序集更容易。

非磁盘加载：纯程序集可以在内存中加载，甚至可以流式加载。这对于将 .NET 程序集用作存储过程至关重要。这与混合程序集不同，混合程序集由于依赖于 Windows 加载机制，必须存在于磁盘上才能执行。

反射：不可能对混合的可执行文件进行反射，而纯程序集提供完整的反射支持。有关详细信息，请参阅反射 (C++/CLI)。

主机可控性：由于纯程序集仅包含 MSIL，因此在托管 CLR 并修改其默认行为的应用程序中使用时，它们的行为比混合程序集更具可预测性和灵活性。

**/clr:pure 的限制**

本节介绍 /clr:pure 当前不支持的功能。

非托管函数不能调用纯程序集。因此纯程序集不能实现 COM 接口或公开本机回调。纯程序集无法通过 __declspec(dllexport) 或 .DEF 文件导出函数。此外，使用 __clrcall 约定声明的函数不能通过 __declspec(dllimport) 导入。可以从纯程序集中调用本机模块中的函数，但纯程序集不能公开本机可调用函数，因此必须通过混合程序集中的托管函数来公开纯程序集中的功能。有关详细信息，请参阅如何：迁移到 /clr:pure (C++/CLI)。

Visual C++ 中的纯模式编译不支持 ATL 和 MFC 库。

纯 .net 模块不被接受为 Visual C++ 链接器的输入。但是，链接器接受纯 .obj 文件，并且 .obj 文件包含网络模块中包含的信息的超集。有关详细信息，请参阅 .netmodule 文件作为链接器输入。

不支持编译器 COM 支持 (#import)，因为这会将非托管指令引入纯程序集。

用于对齐和异常处理的浮点选项对于纯程序集是不可调整的。因此，无法使用 __declspec(align)。这会导致某些头文件（例如 fpieee.h）与 /clr:pure 不兼容。

当使用 /clr:pure 编译时，PSDK 中的 GetLastError 函数会给出未定义的行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-09T15:34:03.980

你的问题是调用conventionCallingConvention = CallingConvention::Cdecl ...这样定义你的函数或使用stdcall或clrcall，clecl是纯C

或问题在这里：定义函数外部不是静态的

# windows-vista - 如何在 Vista 中以编程方式选择主题

> ID：291562
> 
> 赞同：1
> 
> 时间：2008-11-14T21:51:35.403
> 
> 标签：windows-vista, themes

我正在开发的一个软件包会安装它自己的 Windows 主题，并在安装过程中尝试使其成为当前主题。我们设法在安装过程中通过大量注册表编辑（重新启动应用更改）在 Windows XP 上实现了此功能，但 Vista 似乎需要更多的 reqistry 更改。

我们还发现“运行”主题文件将打开主题对话框并选择主题，但用户需要单击确定。一个脚本可以做到这一点，没错，但是在非英语 Windows 上找到 OK 按钮是一个我不想解决的挑战。

那么，有没有办法以编程方式更改 Windows Vista 中的当前主题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-03-12T16:58:26.137

很抱歉破坏了一个旧线程，但我仍然在互联网上看到这个问题。

Windows 离它的 DOS 根源还不是很远。您可以使用此命令打开控制面板并加载您的主题。

这适用于 Windows 7，但可以针对 Vista 进行修改。只需外壳，或将其键入命令窗口：

C:\Windows\system32\rundll32.exe C:\Windows\system32\shell32.dll,Control_RunDLL C:\Windows\system32\desk.cpl 桌面,@Themes /Action:OpenTheme /file: SomeDir\themename.themepack

基本上，只需使用 rundll32 运行控制面板，然后将其提供给您的主题。您将弹出一个控制面板对话框，但主题将自动安装。

如果您希望它安装一个没有对话框弹出的主题，您将需要进行大规模的注册表破解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T22:29:46.650

这是一个肮脏的技巧：如果所有其他方法都失败了，您可以尝试 UI Automation Toolkit 自动“单击”确定按钮。:)

# php - Drupal - 自动提交内容表单

> ID：291572
> 
> 赞同：1
> 
> 时间：2008-11-14T21:55:01.823
> 
> 标签：php, drupal

我想以编程方式（使用 php）填写现有的 drupal 表单以创建包含在贡献模块中的内容类型。

详细信息：模块为 SimpleFeed，内容类型为 Feed。我想调用模块的函数来完成这个。我感兴趣的方法是 hook_insert 似乎需要 vid 和 nid ，我不确定它们是什么。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T22:06:36.247

您能否提供更多信息（哪些模块？）。一般来说，我可能会建议调用模块函数来创建内容类型，而不是尝试以编程方式通过表单传递它。这样您就不必担心实现，并且可以相信如果模块有效，它也适用于您的脚本:)

当然，这确实将您的模块与他们的模块联系在一起，因此其功能的任何更改都可能影响您的模块。（但话又说回来，如果他们也更新他们的数据库结构，你就会冒这个风险）

前任。

```
// your file.php

function mymodule_do_stuff() {
    cck_create_field('something'); // as an example, i doubt this
                                   // is a real CCK function :)
} 
```

**编辑**：`vid`和`nid`是节点ID，`vid`是修订ID，`nid`是特定节点的主键。因为这是一个实际的节点，您可能需要执行两个操作。

1.  **以编程方式创建节点**

    您必须为所有确切字段（表`node`和`node_revisions`）引用数据库，但这应该为您提供一个基本的工作节点：

    ```
    $node = (object) array(
        'nid' => '',            // empty nid will force a new node to be created
        'vid' => '',
        'type' => 'simplefeed'. // or whatever this node is actually called
        'title' => 'title of node',
        'uid' => 1,             // your user id
        'status' => 1,          // make it active
        'body' => 'actual content',
        'format' => 1,
                                // these next 3 fields are the simplefeed ones
        'url' => 'simplefeed url',
        'expires' => 'whatever value',
        'refresh' => 'ditto',
    );

    node_save($node); 
    ```

    现在我*认为*`hook_insert()`它应该在这一点上自动调用 simplefeed 。如果没有，那么继续 2。但我会检查它是否已经解决了。

2.  **自己打电话！**

    ```
    simplefeed_insert($node); 
    ```

**edit2**：`drupal_execute()`这也不是一个坏主意，因为您可以取回一些验证，但是如果您不满意，这样您就不必处理表单 API。我很确定`node_save()`无论如何都会调用所有钩子，所以你应该只需要在这个方法下执行第 1 步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T22:55:37.130

drupal api 提供了[drupal_execute()](http://api.drupal.org/api/function/drupal_execute/6)来做到这一点。我建议您避免直接调用函数来创建节点（除非有性能原因）。通过使用 drupal_execute() 将调用其他模块中的所有正确钩子，并且您的代码更有可能继续在未来版本的 drupal 中工作。

请注意，使用此方法的一个经典错误不是首先调用类似

`module_load_include('inc', 'node', 'node.pages')`

这将为您的节点创建表单加载代码。

直接调用 node_save 通常被认为不推荐使用，并且可能会在未来版本的 drupal 中留下损坏的代码。

[这个摇篮曲帖子](http://www.lullabot.com/articles/quick_and_dirty_cck_imports)有一个很好的例子

# sql - 查询以列出 SQL Server 存储过程以及每个过程的代码行

> ID：291574
> 
> 赞同：21
> 
> 时间：2008-11-14T21:57:51.817
> 
> 标签：sql, sql-server, tsql, stored-procedures, lines-of-code

我想要一个查询，它按名称返回数据库中所有（用户）存储过程的列表，以及每个存储过程的代码行数。

IE

```
sp_name     lines_of_code
--------    -------------
DoStuff1    120
DoStuff2    50
DoStuff3    30 
```

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-11-14T22:21:44.123

```
select t.sp_name, sum(t.lines_of_code) - 1 as lines_ofcode, t.type_desc
from
(
    select o.name as sp_name, 
    (len(c.text) - len(replace(c.text, char(10), ''))) as lines_of_code,
    case when o.xtype = 'P' then 'Stored Procedure'
    when o.xtype in ('FN', 'IF', 'TF') then 'Function'
    end as type_desc
    from sysobjects o
    inner join syscomments c
    on c.id = o.id
    where o.xtype in ('P', 'FN', 'IF', 'TF')
    and o.category = 0
    and o.name not in ('fn_diagramobjects', 'sp_alterdiagram', 'sp_creatediagram', 'sp_dropdiagram', 'sp_helpdiagramdefinition', 'sp_helpdiagrams', 'sp_renamediagram', 'sp_upgraddiagrams', 'sysdiagrams')
) t
group by t.sp_name, t.type_desc
order by 1 
```

已编辑，因此它现在也应该在 SQL Server 2000-2008 中工作，并排除与数据库图相关的 sproc 和 func（看起来像用户创建的对象）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-01-15T17:40:41.527

FWIW，这是另一个：

```
SELECT  o.type_desc AS ROUTINE_TYPE
       ,QUOTENAME(s.[name]) + '.' + QUOTENAME(o.[name]) AS [OBJECT_NAME]
       ,(LEN(m.definition) - LEN(REPLACE(m.definition, CHAR(10), ''))) AS LINES_OF_CODE
FROM    sys.sql_modules AS m
INNER JOIN sys.objects AS o
        ON m.[object_id] = o.[OBJECT_ID]
INNER JOIN sys.schemas AS s
        ON s.[schema_id] = o.[schema_id] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T22:58:16.313

这适用于 MS-SQL 2000

```
SET NOCOUNT ON

DECLARE @ProcName varchar(100)
DECLARE @LineCount int

DECLARE C CURSOR LOCAL FOR
    SELECT o.name as ProcName FROM sysobjects o WHERE (o.xtype = 'P') ORDER BY o.name

OPEN C

CREATE TABLE #ProcLines ([Text] varchar(1000))

FETCH NEXT FROM C INTO @ProcName

WHILE @@FETCH_STATUS = 0 
BEGIN

    DELETE FROM #ProcLines
    INSERT INTO #ProcLines EXEC('sp_helptext ' + @ProcName + '')

    SELECT @LineCount = COUNT(*) FROM #ProcLines

    PRINT @ProcName + '   Lines: ' + LTRIM(STR(@LineCount))

    FETCH NEXT FROM C INTO @ProcName

END

CLOSE C

DEALLOCATE C

DROP TABLE #ProcLines 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2010-04-12T09:14:02.167

```
select * from sysobjects where type = 'p' 
```

# database - 有没有在数据库中存储矢量信息的标准方法？

> ID：291575
> 
> 赞同：3
> 
> 时间：2008-11-14T21:58:18.993
> 
> 标签：database, database-design, data-structures, svg

我想在服务器上存储大量矢量数据，并且只在给定点轮询我需要的部分......

这应该不是问题。

有什么方法可以获取像 svg 文件这样的矢量文件并将其导入数据库？我总是可以编写一个 svg 解析器将其导入到我的数据库中，但是是否有任何标准方法可以执行此操作或将矢量数据存储在数据库中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-15T20:16:10.290

我认为您不能将其称为标准，但这里有一个指向学术论文的有趣链接：

**[基于XML-SVG的空间数据库设计与实现](http://www.svgopen.org/2004/papers/ADesignandImplementationofSpatialDatabasebasedonxmlsvg/)**

抽象的：

*SVG，全称Scalable Vector Graphics，是一种文本中的开放标准，它使得以紧凑、便携的形式表示图形信息成为可能，并且主要面向在网络环境中发布空间矢量图形。在实践中，空间数据处理能力的巨大是不可避免的，这使得SVG文件在互联网上发布时太大而无法实现。

它在客户端减慢了系统的执行速度，削弱了它的优势和优势。这种 SVG 数据库已被提出作为管理 Web 服务器中所有图形及其属性的解决方案。SVG 文档被映射到 SVG 数据库中，作为服务器中的缓冲区。发行效率大幅提升。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T13:49:15.467

我总是可以将一个巨大的 svg 文档放入数据库，但我需要能够以闪电般的速度查找顶点，并且我已经拥有 svg 文档中的所有信息。我只需要一种在数据库中实现信息的合理方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T07:18:16.953

在 MSSQL 中，您有一个 XML 列类型，它允许您执行 XPATH 类型的查询。

[选择具有 SQL Server XML 列类型的特定行](https://stackoverflow.com/questions/197099/select-specific-rows-with-mssql-xml-column-type)

# mysql - MySQL 仅在表不存在时插入数据

> ID：291582
> 
> 赞同：1
> 
> 时间：2008-11-14T22:01:06.007
> 
> 标签：mysql, sql, database

使用严格的 SQL（没有 PHP 或其他任何东西），是否可以创建一个表**并将默认数据插入到该表中，**仅当该表不存在时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T22:18:16.160

使用 CREATE TABLE ... SELECT 格式：

```
如果不存在表名，则创建表为
从默认数据中选择 *；
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T22:21:58.350

这是一种方法：

```
CREATE TABLE IF NOT EXISTS T (
  ID int(10) unsigned NOT NULL primary key,
  NAME varchar(255) NOT NULL
);

REPLACE INTO T SELECT 1, 'John Doe';
REPLACE INTO T SELECT 2, 'Jane Doe'; 
```

REPLACE 是对 SQL 标准的 MySQL 扩展，可以插入、删除和插入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T22:25:32.043

您可以在其中一个元数据表上进行选择

```
if(not exists select * from whatever_meta where table_name = "whatever)
begin
   ...
end 
```

你必须做一些研究才能弄清楚到底是怎么...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T22:33:44.863

是否可以将表状态存储为变量，然后使用该变量来确定是否插入数据？前任：

```
@status = SHOW TABLES LIKE 'my_table';
INSERT INTO my_table VALUES (1,'hello'),(2,'world') WHERE @status <> false; 
```

Paul Morgan 的答案的问题在于它希望数据已经存在于另一个表中。Jonas 的回答将是极其详尽的资源，特别是如果有很多 REPLACES （如果表存在则这是不必要的）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T23:23:05.170

可能是我错过了重点，但为什么默认数据不能是一组插入语句......而一个人只需要做的就是创建表，如果它不存在，然后是插入语句......这样默认数据不必存在于不同的表中。

# c++ - 防止 C 预处理器执行特定的宏替换

> ID：291603
> 
> 赞同：6
> 
> 时间：2008-11-14T22:08:09.753
> 
> 标签：c++, c-preprocessor, getmessage

如何告诉预处理器不要替换特定的宏？

具体问题如下： Windows 头文件定义 GetMessage 宏。

我的 API 的 C++ 头文件有一个 GetMessage 方法。我不想重命名我的方法。但是在 Windows 上使用 API 时，包括 windows.h 将我的 GetMessage 方法调用替换为 GetMessageA。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-14T22:12:11.710

你试过做一个

```
#undef 获取消息
```

甚至

```
#ifdef 获取消息
#undef 获取消息
＃万一
```

然后直接调用 windows GetMessageA 或 GetMessageW，以适当者为准。

您应该知道您是否将 char* 用于 wchar_t8..

（感谢 don.neufeld）

Brian 还说只是一些有用的信息，您还可以使用#pragma push_macro/pop_macro 来推送和弹出宏定义。如果您想覆盖代码块中的宏定义，这非常有用：

```
#pragma push_macro("GetMessage")
#undef GetMessage

// Your GetMessage usage/definition here

#pragma pop_macro("GetMessage") 
```

我怀疑这是 MS 特有的功能，所以请记住这一点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-14T22:54:46.820

`(GetMessage)(...)`

[`GetMessage`在 MSDN 上](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644936%28v=vs.85%29.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-14T23:10:28.723

只是一些有用的信息，您还可以使用#pragma push_macro/pop_macro 来推送和弹出宏定义。如果您想覆盖代码块中的宏定义，这非常有用：

```
#pragma push_macro("GetMessage")
#undef GetMessage

// Your GetMessage usage/definition here

#pragma pop_macro("GetMessage") 
```

我怀疑这是 MS 特有的功能，所以请记住这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T22:27:23.833

是否有代码同时调用您的 GetMessage 和 Window 的 GetMessage？

这样的代码将无法区分它们两者。您将无法在同一个文件中调用两者。

如果您在一个文件中使用一个函数而在另一个文件中使用另一个函数，只需在一个文件中执行建议的#undef。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T22:36:17.230

鉴于您在评论中概述的限制，您可以这样做的唯一方法是执行以下操作：

```
#undef GetMessage 
```

在调用 API 的 GetMessage 之前。（这假设在源文件中的这一点之后没有人调用 Win32 GetMessage。）

# c# - 多播馈送

> ID：291605
> 
> 赞同：2
> 
> 时间：2008-11-14T22:08:25.803
> 
> 标签：c#

我正在通过多播发送 xml 提要，但不知道多播组地址。我可以只使用 localhost 吗？那是，

```
Socket socket = 
     new Socket(AddressFamily.InterNetwork,SocketType.Dgram,ProtocolType.Udp);
IPEndPoint ip = new IPEndPoint(IPAddress.Any,8888);
socket.Bind(ip);
socket.SetSocketOption
   (SocketOptionLevel.IP, 
    SocketOptionName.AddMembership, 
    new MulticastOption(IPAddress.Parse("127.0.0.1"),IPAddress.Any));

byte[] data = new byte[1024];
int length = socket.Receive(data); 
```

...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T22:19:56.220

不。

您（您的客户端）需要加入多播组，您将 AddMembership 到多播组 IP，然后连接。

否则您将无法接收多播提要。不过，您的代码可以与 UDP 广播一起使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T00:32:24.750

严格来说，如果您在非多播地址上为多播数据打开侦听端口，那么您实际上是在侦听标准 UDP。多播和UDP之间的区别在于IP地址。它是一个特殊的 IPV4 地址范围，不绑定到固定主机。相反，它以伪发布-订阅方式被网络边缘的路由器识别。在您的子网中，多播的所有意图和目的都与广播相同。

如果您写入多播地址，则该地址可供您子网上的所有主机使用。如果您的路由器支持多播，那么它将向任何宣布对它感兴趣的客户端提供上游。将其视为子网的发布/订阅。

综上所述，如果您正在寻找与多播等效的本地主机，那么您可能需要查看广播。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T22:21:03.207

与单播不同，您确实需要知道多播的组地址。

# c# - 读取 com 端口

> ID：291607
> 
> 赞同：3
> 
> 时间：2008-11-14T22:09:34.773
> 
> 标签：c#, .net

我正在尝试与输出到虚拟 com 端口的 cdc 读卡器连接。如何打开流以从 com 端口读取？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T22:16:43.293

您可以使用 System.IO.Ports.SerialPort 中的 SerialPort

它在 Toolbox->Components->SerialPort 下的 Toolbox 中作为 Form 组件提供

在属性中，您可以选择要连接的 COM 端口

由于您的问题与流对象有关，我认为您可以使用 SerialPort.BaseStream 并将其转换为 StreamWriter/StreamReader

# java - 识别不同的手机并重定向到不同的网站

> ID：291609
> 
> 赞同：1
> 
> 时间：2008-11-14T22:09:45.210
> 
> 标签：java, mobile, wap

> **可能重复：**
> [基于 http 请求在 Web 应用程序中检测移动浏览器的标准方法](https://stackoverflow.com/questions/142273/standard-way-to-detect-mobile-browsers-in-a-web-application-based-on-the-http-req)

我有一个网站的 3 个移动版本，并希望根据它们支持的不同将每个版本展示给不同的手机型号。一个版本是单色 WML，另一个是彩色 WML，另一个是用于移动设备的 XHTML。

在请求中识别设备并知道它是否支持某个版本或其他版本的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-15T06:22:05.560

检查入站请求上的 User-Agent HTTP 标头并使用它来触发 HTTP 重定向，或者如果您使用 Apache，请使用 mod_rewrite 和 RewriteCond 根据 User-Agent 改变结果，而无需额外的 HTTP 往返重定向使用。

# c++ - Project Explorer ,Mini buf expl 在 VIM 中的使用

> ID：291611
> 
> 赞同：2
> 
> 时间：2008-11-14T22:10:35.770
> 
> 标签：c++, vim

在 VIM 中使用项目浏览器有什么技巧吗？如何从项目中的所有文件中搜索？我试过 \g \G 但他们不工作。

如何关闭项目资源管理器窗口？

我正在使用项目资源管理器和标签列表，当我打开两者时，左侧有两个窗口，这使得非常混乱。是否可以像在 Visual Studio 中那样在右侧打开标签列表。

我也在使用 mini buf explorer 吗？我知道缓冲区可以用 :bd 关闭，但如何关闭迷你缓冲区？

如果你们从事 C++ 工作，请发布您的 vimrc ..

我是 VIM 新手，正处于学习阶段。你的技巧可能会有所帮助...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-15T11:26:26.070

**我经常用vim**和**ctags**编写 C++ 代码。这是我的 dot.vimrc：

```
set backspace=indent,eol,start 
set completeopt=preview,menu
set nocompatible            
set nofoldenable
set novisualbell                
set expandtab
set foldlevel=0
set autowrite
set hlsearch
set showcmd
set showmode
set wildmenu
set pastetoggle=<F12>
set history=500
set mouse=a
set ruler
set cino=l1g0t0p0i0+0:0(0{0
"set ignorecase
set incsearch
set magic
set t_Co=256

" omnicppcomplete  
"
let OmniCpp_GlobalScopeSearch   = 1
let OmniCpp_NamespaceSearch     = 2 
let OmniCpp_DisplayMode         = 1 
let OmniCpp_ShowScopeInAbbr     = 0
let OmniCpp_ShowPrototypeInAbbr = 1
let OmniCpp_ShowAccess          = 1
let OmniCpp_MayCompleteDot      = 1
let OmniCpp_MayCompleteArrow    = 1
let OmniCpp_MayCompleteScope    = 0 
let OmniCpp_SelectFirstItem     = 0
let OmniCpp_LocalSearchDecl     = 0
let OmniCpp_DefaultNamespaces   = ['std', '_GLIBCXX_STD', 'tr1', '__gnu_cxx', 'generic', 'more']

" other features
"
if v:version >= 600
        filetype plugin on
        filetype indent on
else
        filetype on
endif

if has("syntax")
        syntax on
endif

" automatic commands 
"
if has("autocmd")
        autocmd BufEnter *    set cindent comments=""
        autocmd FileType make set noexpandtab shiftwidth=8
        autocmd FileType c    map <buffer> <leader><space> :w<cr>:!gcc %<cr> -I . -Wall
        autocmd FileType c    call UserSpaceMode() | set shiftwidth=4 ts=4 iskeyword=a-z,A-Z,48-57,_
        autocmd FileType cpp  call UserSpaceMode() | set shiftwidth=4 ts=4 iskeyword=a-z,A-Z,48-57,_,:
        autocmd FileType cpp  map <buffer> <leader><space> :w<cr>:!g++ %<cr> -I . -Wall  
        autocmd FileType cpp  map <C-]> :exe "tj /.*" . expand("<cword>") . "$" <cr>
endif

" tab code completition with SuperTab
"
if version >= 700
        let g:SuperTabDefaultCompletionType = "<C-X><C-P>"
        highlight   clear
        highlight   Pmenu         ctermfg=0 ctermbg=2 gui=NONE
        highlight   PmenuSel      ctermfg=0 ctermbg=7 gui=NONE
        highlight   PmenuSbar     ctermfg=7 ctermbg=0 gui=NONE
        highlight   PmenuThumb    ctermfg=0 ctermbg=7 gui=NONE

        if has("gui_running")
                colorscheme inkpot
        else
                colorscheme default
        endif

endif

" ctags options
"
let my_err_counter = 0
let my_space_counter  = 1 
let my_extra_path     = [ '/usr/include/c++/4.3/' ]
let my_ctags_options  = [ '--languages=C,C++', '--c++-kinds=+p',   
                        \'--fields=+iaS', '--extra=+q', '-I __THROW,__NTH,__wur,__warnattr,
                        \__nonnull,__attribute_malloc__,__attribute_pure__,__attribute_used__,
                        \__attribute_noinline__,__attribute_deprecated__,__attribute_format_arg__,
                        \__attribute_format_strfmon__,__attribute_warn_unused_result__,__always_inline,
                        \__extern_inline,__extension__,__restrict' ]

" ctags functions
"
function! UpdateExtraTags()
        execute ":!ctags " . join(g:my_ctags_options,' ') . " -V -R -f ~/.vim/extratags " . join(g:my_extra_path, ' ')    
        echohl StatusLine | echo "Extra tags updated" | echohl None
endfunction

function! UpdateTags()
        execute ":!ctags -V -R " . join(g:my_ctags_options, ' ')   
        echohl StatusLine | echo "C/C++ tag updated" | echohl None
endfunction

" user/kernel-space tags switcher
"
function! UserSpaceMode()
        set tags=tags,~/.vim/extratags
endfunction
function! KernelSpaceMode()
        set tags=tags,/usr/src/linux/tags
endfunction

function! SwitchSpaceMode() 
    let g:my_space_counter+=1
    if (g:my_space_counter%2)
            call UserSpaceMode()
            echohl StatusLine | echo "userspace-tags mode" | echohl None
    else
            call KernelSpaceMode()
            echohl StatusLine | echo "kernelspace-tags mode" | echohl None
    endif
endfunction

function! SwitchErrMode()
    let g:my_err_counter+=1
    if (g:my_err_counter%2)
            copen 
    else
            cclose
    endif
endfunction

" diff the current buffer with its unmodified version in the filesystem 
"
function! s:DiffWithSaved()
  let filetype=&ft
  diffthis
  vnew | r # | normal! 1Gdd
  diffthis
  exe "setlocal bt=nofile bh=wipe nobl noswf ro ft=" . filetype
endfunction
com! DiffSaved call s:DiffWithSaved()

" insert c/c++ gates
"
function! s:insert_gates()
  let gatename = "_" . substitute(toupper(expand("%:t")), "[\\.-]", "_", "g") . "_"
  execute "normal! ggI#ifndef " . gatename
  execute "normal! o#define " . gatename . " "
  execute "normal! Go#endif /* " . gatename . " */"
  normal! kk
endfunction

" insert namepsace c++ 
"
function! s:insert_namespace()
  call inputsave()
  let ns =  inputdialog("namespace? ")
  call inputrestore()
  execute "normal! Anamespace " . ns . " { "
  execute "normal! o} // namespace " . ns 
  normal! kk
endfunction

" insert c++ class 
"
function! s:insert_class()
  call inputsave()
  let classname =  inputdialog("ClassName? ")
  call inputrestore()
  execute "normal! iclass " . classname 
  execute "normal! o{ "  
  execute "normal! opublic:"
  execute "normal! o" . classname . "()"
  execute "normal! o{}"
  execute "normal! o"
  execute "normal! o~" . classname . "()"
  execute "normal! o{}"
  execute "normal! o"
  execute "normal! oprivate:"
  execute "normal! o"
  execute "normal! o// non-copyable idiom"
  execute "normal! o" . classname . "(const " . classname "&);"
  execute "normal! o" . classname . " & operator=(const " . classname "&);"
  execute "normal! o"
  execute "normal! o};"
endfunction

" insert c++ value class 
"
function! s:insert_value_class()
  call inputsave()
  let classname =  inputdialog("ValueClassName? ")
  call inputrestore()
  execute "normal! iclass " . classname 
  execute "normal! o{ "  
  execute "normal! opublic:"
  execute "normal! o" . classname . "()"
  execute "normal! o{ /* implementation */ }"
  execute "normal! o"
  execute "normal! o~" . classname . "()"
  execute "normal! o{ /* implementation */ }"
  execute "normal! o"  
  execute "normal! o" . classname . "(const " . classname "&)"
  execute "normal! o{ /* implementation */ }"
  execute "normal! o"  
  execute "normal! o" . classname . " & operator=(const " . classname "& value)"
  execute "normal! o{ /* implementation: " . classname . " tmp(value); swap(value); */"
  execute "normal! oreturn *this;" 
  execute "normal! o}"
  execute "normal! o"  
  execute "normal! o" . classname . " & operator@=(const " . classname . " &)"
  execute "normal! o{ /* implementation */" 
  execute "normal! oreturn *this;" 
  execute "normal! o}" 
  execute "normal! o"
  execute "normal! ofriend const " . classname . " operator@(" . classname . " lhs, const " . classname . " &rhs)"
  execute "normal! o{ return lhs@=rhs; }" 
  execute "normal! o"
  execute "normal! o" . classname . " & operator++()"
  execute "normal! o{ /* implementation*/" 
  execute "normal! oreturn *this;" 
  execute "normal! o}"
  execute "normal! o"  
  execute "normal! o" . classname . " & operator++(int)"
  execute "normal! o{"
  execute "normal! o" . classname . " tmp(*this);"
  execute "normal! o++(*this);" 
  execute "normal! oreturn tmp;" 
  execute "normal! o}"
  execute "normal! o"
  execute "normal! oprivate:"
  execute "normal! o"
  execute "normal! o};"
endfunction

"autocmd BufNewFile *.{h,hpp} call <SID>insert_gates()

" abbreviate...
"
iab intmain int<cr>main(int argc, char *argv[])<cr>{<cr>return 0;<cr>}<cr>
iab #i #include <><Left>
iab #d #define
iab __P __PRETTY_FUNCTION__
iab __F __FUNCTION__

" set mapleader
"
let mapleader = ","

" keyboard mappig
"
map <F1>  :call <SID>insert_gates() <cr> 
map <F2>  :call <SID>insert_namespace() <cr> 
map <F3>  :call <SID>insert_class() <cr> 
map <F4>  :call <SID>insert_value_class() <cr> 

map <F5>  :call SwitchSpaceMode() <cr>
map <F7>  :make<cr>
map <F8>  :call SwitchErrMode() <cr>

map <F9>  :call UpdateTags() <cr> 
map <F10> :call UpdateExtraTags() <cr> 
map <F11> :call <SID>DiffWithSaved() <cr>

map <leader>e :e ~/.vimrc<cr>       " edit vimrc 
map <leader>u :source ~/.vimrc<cr>  " update vimrc

map <tab> :tabnext<cr>
map <S-tab> :tabprevious<cr>

" plugins
"
runtime! ftplugin/man.vim
runtime! ftplugin/gzip.vim
runtime! ftplugin/taglist.vim 
```

快乐编码！:-)

# java - 如何将日期参数分配给当前时区的休眠查询？

> ID：291620
> 
> 赞同：38
> 
> 时间：2008-11-14T22:16:02.780
> 
> 标签：java, hibernate, timezone

当您将日期分配给命名 SQL 参数时，Hibernate 会自动将其转换为 GMT 时间。你如何让它在所有日期都使用当前服务器时区？

假设您有一个查询：

```
Query q = session.createQuery("from Table where date_field < :now");
q.setDate("now", new java.util.Date()); 
```

“now” 将设置为 GMT 时间，而“new Date()” 获取您当前的服务器时间。

谢谢。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-01-16T21:45:10.867

事实证明，Hibernate 不会自动将日期转换为 GMT，如果你使用它只会切断时间`query.setDate()`，所以如果你通过 "2009-01-16 12:13:14" 它变成 "2009-01-16 00:00 :00”。

要考虑时间，您需要`query.setTimestamp("date", dateObj)`改用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T22:27:18.497

Hibernate 不知道时区。任何时区转换都应在执行查询之前完成。

例如，如果您的数据库服务器设置为 CST，但用户使用的是 EST，则您需要将 1 小时添加到作为查询输入的任何时间戳。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-15T01:42:04.533

我们使用自定义的 Hibernate 日期类型。每当我们在查询上设置参数时，我们都会使用基类或实用程序方法，这样我们就可以将用户的时区传递给自定义类型参数。

您可以通过手动调整实用程序方法中的时间来进行查询，但是这样读取或写入数据库的日期也可以正确转换。此方法还处理数据库将日期存储在其本地时区的情况。因此，即使您在一个时区有一个用户，在另一个时区有一个数据库服务器，并且 Java 使用 GMT，它也可以让一切变得简单。它最终看起来像：

```
Properties properties = new Properties();
properties.setProperty("timeZone", databaseTimeZone);
query.setParameter("from", dateEnteredByUser, Hibernate.custom(LocalizedDateType.class, properties)); 
```

作为额外的奖励，我们使用它来处理 SQL Server 将 23:59:59.999 转换为第二天的事实。在自定义类型中，我们检查并取消它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-17T10:11:25.057

如果您需要**时区**同步值，您可以在 HQL 中使用*now()*。另外我建议您使用 Joda 库。它有一个休眠插件模块。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-17T06:36:32.583

***自5.2***版以来， Hibernate 团队已弃用***setTimestamp(String name, Date val)***方法以及**org.hibernate.Query**接口：

 *```
 /* @deprecated (since 5.2) use {@link #setParameter(int, Object)} or
    {@link #setParameter(int, Object, Type)}  instead
 */ 
```

所以你可以使用下面的代码：

```
import org.hibernate.query.Query;
...
Query query = session.createQuery("from Table where date_field < :now");
query.setParameter("now", new Date(), TimestampType.INSTANCE ); 
```

值得注意的是，减少时间部分的***setDate方法也被弃用，可以用这个选项替换（来自相同的接口 org.hibernate.query.Query）：***

```
query.setParameter("firstMomentOfToday", new Date(), DateType.INSTANCE); 
```

If you are going to use it with java 8 and the relevent jdbc drivers like Oracle '**ojdbc8.jar**' and supported hibernate versions this might not work as expected, so it's wise to use new java.time.LocalDate and LocalDateTime instead.

# database-design - 数据库架构设计

> ID：291623
> 
> 赞同：3
> 
> 时间：2008-11-14T22:16:45.727
> 
> 标签：database-design

我正在尝试设计一个位置查找，用户可以在其中将位置指定为任何所需的准确度。例如。国家，州，城市，自治市镇等之一，

我使用了一个公共位置表，然后将在查找中使用动态选择的表名，但想知道是否有可行的替代方法来执行此操作。

[替代文字 http://img386.imageshack.us/img386/3842/locationschmadh6.png](http://img386.imageshack.us/img386/3842/locationschemadh6.png)

**编辑**分层表看起来像要走的路。谢谢你的提示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T22:21:54.000

你可能会考虑这样的事情：

```
locations
  id int
  parentId int
  name varchar(45) 
```

从这个角度来看，您可以加载具有任何级别深度的任何类型的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T22:46:33.950

您的设计优于多态关联，这是许多人实施的替代方案。这与您的设计相反：

```
CREATE TABLE location (
  id         INT PRIMARY KEY,
  table_name VARCHAR(45) NOT NULL CHECK (table_name in ('city', 'state')),
  table_id   INT NOT NULL -- matches an id in either city or state
); 
```

关于您的设计，一个潜在的弱点是您无法强制执行`location.table` 准确指示包含对`location`. 因此，您不妨删除该列，转而依赖加入两个表。

例如，要为选择列表生成标签：

```
SELECT l.id, COALESCE(s.name, c.name, 'Unknown Location') AS name
FROM location AS l
  LEFT OUTER JOIN state AS s ON (l.id = s.location_id)
  LEFT OUTER JOIN city AS c ON (l.id = c.location_id); 
```

Chris Lively 开始建议使用分层表。我认为他的意思是您将州和城市都存储在`location`表中，然后您根本不需要`city`and`state`表。

```
CREATE TABLE location (
  id         INT PRIMARY KEY,
  loc_type   VARCHAR(45) NOT NULL CHECK (table_name in ('city', 'state')),
  loc_name   VARCHAR(45) NOT NULL,
  parent_id  INT, -- NULL if root of tree
  FOREIGN KEY (parent_id) REFERENCES location(id)
); 
```

还有其他在 SQL 中存储层次结构的方法，但是如果您只有一个深度级别，那么这种设计就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T22:25:53.773

我认为这种设计存在一些问题（因为我不完全了解您的要求）： 1\. 您将无法使用简单的连接。2\. 不能有索引，不能优化查询

Alternate#您是否考虑过在位置表中有一个 locationid 并有一个指向州和城市表的链接（一对多）？

# c# - 如何解析 .msstyles 文件？

> ID：291624
> 
> 赞同：4
> 
> 时间：2008-11-14T22:17:58.093
> 
> 标签：c#, uxtheme, msstyles

我需要从 .msstyles 文件（Windows XP 视觉样式文件）中提取一些位图，但我不知道从哪里开始。我似乎找不到任何关于如何做到这一点的文档，而且文件格式似乎是二进制的，不容易解析。我已经能够使用以下方法自行提取位图：

```
IntPtr p = LoadLibrary(UxTheme.ThemeName);
Bitmap bmp = Bitmap.FromResource(p, "BITMAP_NAME");
FreeLibrary(p); 
```

但是，我还需要与位图相关的信息，例如边距大小、间距和每个位图的“图像”数量。有没有人对此有任何经验或我可以使用的任何文档链接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-15T00:20:03.840

[该](http://filext.com/file-extension/MSSTYLES "文件扩展名")站点声称该文件格式已记录在文档中，但 Microsoft 并未记录。[在Wine Crossreference](http://source.winehq.org/source/dlls/uxtheme/msstyles.c "msstyles.c")
中也发现了这一点。 希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T11:29:04.440

如果您想直接从 dll 中获取文件（请记住，msstyles 是具有另一个扩展名的 dll），您可以查看[Anolis Project](http://www.codeplex.com/anolis "阿诺利斯项目")。

至于实际解析这些内容，您应该查看有关创建 msstyles 的各种教程，以获取有关该文件中各种文本资源如何工作的信息。

[这篇](http://www.codeproject.com/KB/miscctrl/XPTaskBar.aspx "代码项目文章")codeproject 文章似乎正是您想要的，其中涉及到一点互操作。存在[托管包装器](http://www.codeproject.com/KB/mcpp/ManagedUxTheme.aspx "托管用户体验主题")，它看起来相当不错。.Net WindowsForms 还具有内置功能，如果您想要简化只读访问，您可能需要查看 System.Windows.Forms.VisualStyles 命名空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-29T18:31:36.377

您可以使用7-zip打开msstyles，安装它，然后右键单击msstyles > 7-zip，里面有2个打开，一个作为普通按钮，另一个带有箭头，选择第二个，然后选择“#”

您现在在 msstyles 中，现在右键单击 1..mst > Open inside 您现在在实际主题中，现在只需提取它的资源 [msstyles 打开的图像（是西班牙语）](https://i.stack.imgur.com/KRjL5.png)

# delphi - Delphi 的 Profiler 和内存分析工具

> ID：291631
> 
> 赞同：54
> 
> 时间：2008-11-14T22:20:32.113
> 
> 标签：delphi, memory-leaks, profiling

我最近从 Delphi 4 升级到 Delphi 2009。在 Delphi 4 中，我一直使用[Primoz Gabrijelcic 的 GpProfile](http://web.archive.org/web/20001205122400/http://www.eccentrica.org/gabr/gpprofile/gpprofile.htm)作为分析器，[使用 Turbo Power 的 Memory Sleuth](http://web.archive.org/web/20031204135824/http://www.turbopower.com/products/sleuth/)进行内存分析和泄漏调试。两者都对我很有效。但我现在需要可以与 Delphi 2009 配合使用的新工具。

Delphi 的分析/分析工具的领先者显然[是 AutomatedQA 的 AQTime](http://www.automatedqa.com/products/aqtime/index.asp)。他们最近甚至收购了[Atanas Soyanov 的 Memproof](http://www.scip.be/index.php?Page=ArticlesDelphi07&Lang=EN)，我认为这是一款出色的免费内存分析工具，并将其功能整合到 AQTime 中。但是 AQTime 对于单个程序员来说是非常昂贵的。它的成本实际上超过了升级到 Delphi 2009 的成本！

所以我的问题是：在您满意并推荐的当前版本的 Delphi 中，是否还有其他更便宜的选项来进行分析和内存分析，或者我应该硬着头皮为 AQTime 支付大笔费用？

* * *

附录：似乎早期的回答者表明 Delphi 中已经包含的 FastMM 管理器非常适合查找内存泄漏。

那么，源代码分析有什么好的替代方案吗？

我很好奇的是[Michael Adolph 的 ProDelphi，](http://www.prodelphi.de/indexpd.htm)它的成本不到 AQTime 的六分之一。你用它吗？AQTime值得付出六倍的代价吗？

* * *

附录 2：我下载了 AQTime 和 ProDelphi 的试用版。

AQTime 一开始有点不知所措，有点混乱。花了几个小时才找到连接它所需的一些技巧。

ProDelphi 非常像我习惯的 GpProfile。但它的窗口杂乱无章，不如 GpProfile 好。

对我来说，最大的区别似乎是：

1.  ProDelphi 更改您的代码。AQTime 没有。如果出现问题，更改代码可能会损坏您的数据，但我对 GpProfile 的经验是它从未发生在我身上。AQTime 加一。

2.  ProDelphi 要求您关闭优化。但是你想要分析的是你的程序优化，它将运行的方式。AQTime 加一。

3.  ProDelphi 只能剖析到函数或过程。AQTime 可以细分到单独的行。AQTime 加 2。

4.  ProDelphi 有一个免费版本，可以分析 20 个例程，其专业版的价格不到 100 美元。AQTime 是 600 美元。加 4 ProDelphi。

现在比分是4-4。你怎么看？

* * *

附录 3：Primoz Gabrijelcic 计划让 GpProfile 再次工作。请参阅他对以下一些回复的评论。他在 StackOverflow 上担任[Gabr](https://stackoverflow.com/users/4997/gabr)。

* * *

附录 4：似乎毕竟可能有探查器解决方案。请参阅[Andre 的开源 asmprofiler，如下所述](https://stackoverflow.com/questions/291631/profiler-and-memory-analysis-tools-for-delphi/672554#672554)。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-11-15T02:46:59.237

就价格而言，您无法击败 FastMM4 作为内存跟踪器。它使用简单但功能强大且与 Delphi 完美集成。
我想您知道，无需下载、安装或更改任何其他内容，只需输入此行

```
ReportMemoryLeaksOnShutDown := True; 
```

在代码中的任何位置，都将启用内存泄漏的基本报告。
如果您需要更多类似崩溃信息，EurekaLog 是我们使用的一个非常好的产品。MadExcept 也有很好的声誉......

具体来说，我们有 AQTime。

至于 gpProfile，您可以尝试在 SO 上对[gabr](https://stackoverflow.com/users/4997/gabr)进行错误更新......或者自己去[更新 gpProfile，因为它是开源](http://gp.17slon.com/gpprofile/index.htm)的。;-)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-03-23T08:32:32.840

我为 Delphi 制作了一个开源分析器： [http ://code.google.com/p/asmprofiler/](http://code.google.com/p/asmprofiler/)

它并不完美，但它是免费和开源的:-)。

我这样做的主要原因是因为我错过了一个确切的调用树。例如，ProDelphi 仅存储所有调用的摘要和总计数，您无法查看在特定时间（或持续时间）执行特定过程的调用。它有一个时间表，因此您可以看到通话时长如何随时间变化。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-11-16T07:06:30.850

还可以看看[Eric Grange 的 Sampling Profiler](http://delphitools.info/samplingprofiler/)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-15T02:04:12.473

我对 AQtime 的分析非常满意。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-17T02:43:14.797

在使用了 GpProfile 和 AQTime 之后，我发现两者都可以有效地找出导致瓶颈的方法调用。

然而，AQTime 也可以告诉我是哪一行代码导致了这种情况，而无需对我的源代码进行任何更改（尽管它最适合 TD32 调试和调试 dcus）。

我最近用它来加速一个例程大约 30 倍（由于内部库函数使用不当）

但是我不必自己付钱！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-07-08T06:53:11.690

我们使用 AQTime Pro 并对此感到满意。Smartbear 最近发布了完全免费的[AQTime 标准版](http://smartbear.com/products/free-tools/aqtime-standard/)。大多数功能仍然存在，但它们当然已经[删除了一些](http://smartbear.com/products/development-tools/performance-profiling/standard-vs-pro/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-16T10:42:11.320

我同意你对 ProDelphi 界面的看法，但它做得足够好，我们很乐意继续使用它。当我们遇到严重的性能问题时，我们只需要偶尔进行分析，它总是可以帮助我们很快找到问题。物超所值，迈克尔似乎很乐意为新版本保持更新。

我建议的一件事是，因为它确实需要插入代码，所以在某种 VCS 中拥有所有相关代码是非常宝贵的。当我们需要分析时，我们：

*   检查所有相关文件
*   全部检查
*   做我们需要的分析，然后
*   取消所有结帐，有效地回滚到我们原来的位置。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-20T01:27:11.157

有人[在 Delphi Area 尝试过 Profiler 组件吗？](http://www.delphiarea.com/products/delphi-components/profiler/)它是带有源代码的免费软件，它的文章说：

> 如果您正在寻找一种简单而准确的免费测量代码执行时间的方法，那么 TProfiler 就是您所需要的。TProfiler 是一个非可视化的调试组件，可让您在代码中创建命名计时器。
> 
> TProfiler 的每个定时器都提供以下信息：
> 
> 定时器被激活的次数（Hit Count） 总执行时间 每次命中的平均执行时间 第一次命中的执行时间 最后一次命中的执行时间 执行时间最短的命中 执行时间最长的命中

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-14T22:34:44.160

这是真的，对于分析我想念 Primoz 的 GpProfile，并且没有找到一个好的替代品。我曾经尝试过 AQTime，但对它的价格不太满意。

为了跟踪内存泄漏和不可靠的内存访问，我不能比使用 FastMM4 更开心。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-15T00:58:38.130

对于分析器，您可以尝试[Gurock](http://www.gurock.com/products/smartinspect/) Software 的 SmartInspect。我从未使用过 GpProfile，但快速浏览它的功能集让我想起了 SmartInspect。有趣的是，它并没有声称自己是一个分析器，但它似乎和 GpProfile 一样多（除非我遗漏了一些东西）。它支持Delphi 2009，有免费试用版，比AQTime便宜一点。

**注意**：SmartInspect 是记录器而不是分析器。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-06-13T00:23:19.710

我已经使用 ProDelphi 很长时间了，发现它满足了我的需求。

通过使用它提供的数据，我已经能够在系统性能改进方面取得惊人的成果。

对于小型项目，免费版本很好。

对于较大的项目，您需要（付费）专业版。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-03-16T06:22:24.023

[这个较早的答案](https://stackoverflow.com/questions/1701671/how-to-monitor-or-visualize-memory-fragmentation-of-a-delphi-application/1701917#1701917)（“**如何监视或可视化 delphi 应用程序的内存碎片**”）中提到的 FastMM4 内存管理器保留了一个可以在运行时查询的所有分配的列表（并使用包含的演示应用程序显示在网格中）。它不能准确显示哪些对象泄漏，因为统计信息是按块大小计算的。但它对于长期监控生产中的应用程序（例如服务器或服务）很有用。我目前正在将它作为“VisualMM”附加组件集成到（商业）Web 应用程序服务器框架中。

# javascript - 如何使用javascript在html中交换swf？

> ID：291647
> 
> 赞同：3
> 
> 时间：2008-11-14T22:27:37.467
> 
> 标签：javascript, html, flash, embed

我在我的 html 页面中嵌入了一个 swf，但是当我单击 html 中的一个按钮时，我希望它交换到另一个 swf。我使用 swfobject.js 嵌入 swf，并使用原型编写 javascript。我以为我可以做到这一点

```
$('movie').value = 'swf/bhts.swf';
alert($('movie').value); 
```

值确实更改为 swf/bhts.swf，但它仍在播放原始 swf 文件...这是我用来嵌入 swf 的代码

```
<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="530" height="298" id="flashcontent">
<param id="movie" name="movie" value="swf/trailer.swf" />
</object> 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T22:30:28.117

使用 swfObject：

```
<div id='flashContent'>
</div>

<script type='text/javascript'>    
    // Setup your initial flash 
    var so = new SwfObject(.....);
    so.write ('flashContent');

    // Some event handler
    someElement.onclick = function ()
    {
         // Load up the new SWF
         so = new swfObject(....);
         so.write('flashContent');
    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T23:58:19.500

你是如何使用 SWFObject 的？如果您使用 swfobject.embedSWF 方法将 SWF 添加到您的 HTML 文件中，那么您可以使用相同的 ID 再次调用它，它应该删除旧的 Flash 播放器对象并使用您的新 URL 添加一个新对象。

您还可以使用 SWF 自己的方法来替换它正在使用的 URL。如果您有 Flash 对象的 ID，请使用类似

```
var swf = getElementById("flash_id");
swf.LoadMovie(0, "http://example.com/newSwfUrl.swf"); 
```

这应该指示 Flash 播放器从不同的位置重新加载，替换第 0 层（默认层）。这可能不适用于真正旧的 Flash 播放器，但在 Flash 8 及更高版本中应该没问题。

# gcc - 如何在 x64 计算机上使用 gcc 编译 x86 汇编代码

> ID：291655
> 
> 赞同：5
> 
> 时间：2008-11-14T22:30:25.010
> 
> 标签：gcc, assembly, x86, compiler-construction, x86-64

对于学校作业，我必须编写 x86 汇编代码，但我不能使用 gcc 编译它，因为我的计算机是 x64 机器，而 gcc 只需要 x86 代码。是否有一个命令可以让 gcc 接受它的 x86 汇编代码？谢谢

PS 我知道我的代码是有效的，因为它在 x86 机器上编译得很好。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-14T22:32:24.883

只需将`-m32`选项传递给 gcc。

# c# - 检索 AlternateView 的电子邮件

> ID：291661
> 
> 赞同：7
> 
> 时间：2008-11-14T22:31:58.813
> 
> 标签：c#, html, email, pop3, plaintext

我似乎无法从 System.Net.Mail.AlternateView 检索 AlternateView。

我有一个通过 POP3 提取电子邮件的应用程序。我了解如何创建用于发送的备用视图，但是在查看电子邮件时如何选择备用视图。我已将收到的电子邮件作为 System.Net.MailMessage 对象，因此我可以轻松提取正文、编码、主题行等。我可以看到 AlternateViews，也就是说，我可以看到计数为 2 但想要提取除我请求正文时当前返回的 HTML 以外的其他内容。

希望这有一定的意义，并且有人可以对此有所了解。最后，我希望提取纯文本，而不是 HTML，并且不想自己解析它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-07-18T17:41:22.967

Mightytighty 引导你走上正确的道路，但你不应该假设编码的类型。这应该可以解决问题：

```
var dataStream = view.ContentStream;
dataStream.Position = 0;
byte[] byteBuffer = new byte[dataStream.Length];
var encoding = Encoding.GetEncoding(view.ContentType.CharSet);
string body = encoding.GetString(byteBuffer, 0, 
    dataStream.Read(byteBuffer, 0, byteBuffer.Length)); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-09-25T17:13:56.113

我遇到了同样的问题，但你只需要从流中读取它。这是一个例子：

```
 public string ExtractAlternateView()
    {
        var message = new System.Net.Mail.MailMessage();
        message.Body = "This is the TEXT version";

        //Add textBody as an AlternateView
        message.AlternateViews.Add(
            System.Net.Mail.AlternateView.CreateAlternateViewFromString(
                "This is the HTML version",
                new System.Net.Mime.ContentType("text/html")
            )
        );

        var dataStream = message.AlternateViews[0].ContentStream;
        byte[] byteBuffer = new byte[dataStream.Length];
        return System.Text.Encoding.ASCII.GetString(byteBuffer, 0, dataStream.Read(byteBuffer, 0, byteBuffer.Length));
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-16T21:57:07.083

有一个更简单的方法：

```
public string GetPlainTextBodyFromMsg(MailMessage msg)
{
    StreamReader plain_text_body_reader = new StreamReader(msg.AlternateViews[0].ContentStream);
    return(plain_text_body_reader.ReadToEnd());
} 
```

如果第一个替代视图是纯文本版本，这很有效，因为它通常发生。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T19:09:42.840

使用 System.Net.Mail 命名空间中可用的类无法立即解析电子邮件；您要么需要创建自己的 MIME 解析器，要么改用第三方库。

Peter Huber SG 撰写的这篇很棒的 Codeproject 文章，题为[“具有完整 MIME 支持 (.NET 2.0) 的 POP3 电子邮件客户端”，](http://www.codeproject.com/KB/IP/Pop3MimeClient.aspx)将让您了解如何实现 MIME 处理以及相关的 RFC 规范文章。

您可以使用 Codeproject 文章作为开始编写自己的解析器，或者评估像[SharpMimeTools](http://anmar.eu.org/projects/sharpmimetools/)这样的库，这是一个用于解析和解码 MIME 电子邮件的开源库。

[http://anmar.eu.org/projects/sharpmimetools/](http://anmar.eu.org/projects/sharpmimetools/)

希望这可以帮助！

# javascript - 是否可以从内部或服务器端隐藏/关闭 iframe？

> ID：291665
> 
> 赞同：4
> 
> 时间：2008-11-14T22:32:57.363
> 
> 标签：javascript, iframe, cross-domain

假设我有一个页面，我正在为 domain 编写一个 javascript 插件`first.com`。javascript插件将指向登录页面（域`second.com`）的iframe注入`first.com`页面并将其显示为弹出窗口，以便用户可以登录。

用户登录后，我是否可以隐藏/关闭 iframe？我可以将任何必要的 javascript 注入`first.com`页面，并控制 iframe 内登录页面上的客户端和服务器端代码。

主要问题是 iframe 无法访问其父窗口以隐藏自身，并且父窗口由于相同的源策略而无法看到 iframe 内容中所做的任何更改。无论如何，还是我应该失去 iframe 的想法，而是打开一个新窗口？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T17:11:12.270

如果可以说服 second.com 的开发人员在他们的登录页面中加载 iframe，该页面在 first.com 加载页面，则内部 iframe 可以在外部调用 javascript，因为它们都来自 first.com。您也可以通过内部 iframe 的 url 以这种方式传递参数。这里有一个[例子](http://mcknut.googlepages.com/iframetest.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T22:48:43.837

我认为您遇到的问题是浏览器阻止了跨域通信的发生。有一种方法可以为[您的 javascript 签名](http://www.mozilla.org/projects/security/components/signed-scripts.html)，但它几乎破坏了浏览器安全模型，除非绝对必要，否则不建议这样做。

登录表单是否基于 URL 提交？您可以创建一个简单的登录表单并使用 AJAX 来获取您的响应以确保成功登录。此解决方案取决于拥有 RESTful 登录，我不确定您的 second.com 的实施情况。

如果您想知道如何使用 ajax 提交表单，我会检查[一下](http://be.twixt.us/jquery/formSubmission.php)（它在 jQuery 中，但它几乎适用于任何框架。）查看源代码，看看它是否适用于您的情况。

# mysql - 我可以在 MySQL 下的 SQL 中直接运行 HTTP GET 吗？

> ID：291673
> 
> 赞同：2
> 
> 时间：2008-11-14T22:35:06.953
> 
> 标签：mysql, http-get, sql-function

我很想这样做：

```
UPDATE table SET blobCol = HTTPGET(urlCol) WHERE whatever LIMIT n; 
```

是否有可用的代码来执行此操作？我知道这应该是可能的，因为[MySQL Docs](http://dev.mysql.com/doc/refman/5.0/en/udf-compiling.html)包含一个添加执行 DNS 查找的函数的示例。

MySQL/windows/最好不用编译东西，不过我可以。

（如果你没有听说过这样的事情，但你会期望如果它确实存在的话，那么“proly not”会很好。）

编辑：我知道这会打开一个完整的 can-o-worms re 安全性，但是在我的情况下，对数据库的唯一访问是通过 mysql 控制台应用程序。*它不是一个世界可访问的系统。它不是 Web 后端。它**只是**一个本地数据记录系统*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-15T13:14:01.157

不，谢天谢地——这将是一个安全隐患。应用程序中的每个 SQL 注入漏洞都可能被用来开始发送垃圾邮件连接以攻击其他站点。

我想，您可以用 C 语言编写它并将其编译为 UDF。但我认为与仅在应用程序层中选择并循环执行 HTTP GET 和更新结果相比，它并不能真正为您带来任何好处。如果我们谈论的是建立 HTTP 连接，那么在数据库层执行此操作的额外效率将完全被网络延迟所抵消。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T23:50:42.633

作为 MySQL 的一部分，我不知道有任何类似的功能。您只是想从许多 URL 中检索 HTML 数据吗？

另一种解决方案可能是使用 Google 电子表格的 importHtml 函数。

[Google 电子表格可让您导入在线数据](http://googlesystem.blogspot.com/2007/09/google-spreadsheets-lets-you-import.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-15T13:17:36.470

不能。Web 环境中的最佳实践是使数据库服务器与外部隔离，双向，这意味着不允许数据库服务器从 Internet 获取内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-15T22:51:37.107

不能。

如果您绝对决心从 SQL 环境中获取 Web 内容，据我所知有两种可能性：

1.  用 C 编写自定义 MySQL UDF（如 bobince 所述）。这可能是一项艰巨的工作，具体取决于您对 C 的经验、您想要多少安全性、您希望 UDF 有多完整：例如。只是 GET 请求？邮政呢？头？等等

2.  使用*可以*执行此操作的其他数据库。如果您对 SQL 感到满意，您可能可以使用 PostgreSQL 和其中一种管理单元语言（如 Python 或 PHP）来做到这一点。

如果您对坚持使用 SQL 不太在意，则可以使用[eXist 之](http://exist-db.org/)类的东西。您可以使用 XQuery 相对轻松地执行此类操作，并且能够轻松修改结果以适合您的模式（而不是将其集中到 blob 字段中）或将页面“按原样”存储为 xhtml doc在数据库中。

然后，您可以在所有文档中非常快速地运行查询，例如，获取所有链接或引号等。您甚至可以用很少的额外工作将 XSL 应用于这样的结果。如果您要存储页面以供参考，并希望将结果调整为个人“内部网”风格的应用程序，那就太好了。

此外，由于 eXist 是以文档为中心的，它有很多很好的模糊文本搜索、近词搜索的方法，并且有很好的全文索引（比 MySQL 的要好得多）。如果您在对内容进行一些数据挖掘之后是完美的，例如：找到所有文档，其中包含“热狗”的 50 个单词中的“*汉堡*”之类的单词不在 UL 列表中。尝试在 MySQL 中进行本机操作*！*

顺便说一句，并没有恶意；我经常想知道为什么人们在构建 CMS 时忽略了 eXist。它是一个数据库，可以*以其原生格式*（XML 或其子集 (x)HTML）存储内容，以其原生格式轻松查询它*，*并可以使用强大的模板语言将其从其原生格式翻译，其*外观和行为类似于它的原生格式*。**有时 SQL 完全不适合这项工作！**

对不起。不是故意胡说八道的！:-$

# asp.net - 我可以做些什么来优化我的 .NET 网站和 64 位应用程序？

> ID：291675
> 
> 赞同：1
> 
> 时间：2008-11-14T22:35:19.917
> 
> 标签：asp.net, performance, optimization, 64-bit

如何在 .NET 2.0 Web 应用程序和控制台/表单应用程序中充分利用 64 位架构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T22:58:09.807

我认为关于 32 位与 64 位架构的托管 .NET 代码没有太多可以优化的地方。这是因为大多数差异和优化很可能已经由底层 VM 实现。[正如在64 位平台编程中](https://stackoverflow.com/questions/280327/programming-for-the-64-bit-platform)提到的，64 位VM 可能在更大的数据类型（`long`存储在一个寄存器中）上表现更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T14:48:01.153

64 位平台的最大优势是您的应用程序可以处理的内存量。这意味着您的 Web 应用程序可以支持更大量的活动会话或/和更长的会话。您还可以在应用程序缓存中存储更多数据。因此，请记住这一点，您可以重新构建您的应用程序。

# java - JasperReports 导出到 Excel 忽略背景颜色？

> ID：291696
> 
> 赞同：5
> 
> 时间：2008-11-14T22:48:02.247
> 
> 标签：java, jasper-reports, export-to-excel

您是否曾经在 Jasper 报告中交替使用背景颜色，然后将其导出到 Excel？Excel 导出似乎忽略了交替颜色。

我有一个 Jasper 报告，其中使用[HERE](http://www.brianburridge.com/2006/06/19/highlighting-odd-even-rows-jasperreports)引用的过程交替背景颜色的行。当我使用查看器预览它或导出到 PDF 时，它可以工作——但当我导出到 Excel 时却不行。我试过使用`JRXlsExporter`，`JExcelApiExporter`但都无济于事。

我认为这可能是您必须在 Jasper 中制作交替行颜色的副作用，我一开始就鄙视，但没有找到其他方法。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-05-21T18:57:38.150

另外，请确保您制作的条件样式已选中“不透明”选项...如果没有，背景颜色将永远不会出现在 excel 报告中（永远！！！）...。

此外，必须在文本字段中选中“不透明”选项....

如果您注意到文本字段从未采用您给它们的样式，请尝试在每个文本字段的属性面板中将前景色和背景设置为空（这对我有用）...

希望这有帮助...再见。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-15T00:48:17.353

您是否尝试过您所指的程序的[评论中建议的想法？](http://www.brianburridge.com/2006/06/19/highlighting-odd-even-rows-jasperreports/comment-page-2/#comment-8837)

首先如何使用条件创建新的报告样式：

> JasperReports 的最新版本包括报告样式，这使得这更容易一些 - 您不再需要创建矩形。
> 
> 我使用 iReport 创建我的样式 - 有一个“样式”窗格，默认情况下与“库”窗格对接。如果你让它可见，你可以在样式库中创建一个新样式。在弹出的屏幕中为样式命名（例如“EvenOddRowStyle”并在“样式条件”下按“添加”。使用 Brian 给出的表达式之一并按应用。然后在“通用”部分按“... ”按钮，然后选择所需的背景颜色。最后，完成报表后，将该样式应用于要突出显示的行中的所有字段。只需将样式从样式窗格拖到字段上即可。

然后如何定义导出到 Excel 时应用的样式：

> 使用条件表达式定义新样式：

```
Boolean.valueOf( $V{PAGE_COUNT}.intValue() % 2 == 0 ) 
```

> 不**使用矩形和 print when 表达式就可以了**！

# asp.net - 从浏览器检测是否安装了特定应用程序

> ID：291704
> 
> 赞同：9
> 
> 时间：2008-11-14T22:51:31.863
> 
> 标签：asp.net, javascript, ajax, web-applications

我们有一个高级网页（ASP.NET、C#）和一个需要安装在客户端计算机上才能充分利用网页的应用程序。该应用程序是一个托盘应用程序，主要有两个任务。检测网络服务器上何时发生某些事件（例如，受邀参加会议，或通知即将举行的会议）。Trayapp 的另一项任务是使用自定义协议 (trayapp://) 执行一些 ajax 调用回服务器。

我们遇到的一个问题是如何确定应用程序是否安装在本地机器上。现在用户必须勾选一个复选框来通知网站应用程序已安装，并且可以安全地调用trayapp:// url 调用。

有什么方法，例如通过 JavaScript 或类似的方法来检测我们的应用程序是否安装在本地机器上？

该检查需要适用于 IE、FF 和 Opera 浏览器。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-14T23:14:48.260

安装客户端应用程序时，您可以修改浏览器配置以在 HTTP 请求中包含另一个请求标头，然后让服务器代码查找该标头，例如使用以下注册表项作为受支持的 mime 类型（对于 Internet Explorer）

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\
                                                      Internet Settings\Accepted Documents 
```

我不确定 Opera 和 FF 是否使用相同的密钥，但它们可能具有相似的配置选项，但这至少应该让您走上正轨。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-14T23:18:42.450

如果您想在浏览器中使用 javascript 进行检测，您可能可以使用集合“navigator.plugins”。它适用于 Firefox、Opera 和 Chrome，但不幸的是不适用于 IE。

更新：在 FF、Opera 和 Chrome 中，您可以像这样轻松测试它：

```
if (navigator.plugins["Adobe Acrobat"]) {
// do some stuff if it is installed
} else {
// do some other stuff if its not installed
} 
```

更新 #2：如果它是 IE 中的 ActiveX 对象，您可以使用以下方法测试它是否存在：

```
function getActiveXObject(name){
        try{
            return new ActiveXObject(name);
        }
        catch(err){
            return undefined;
        }
}; 
```

IE 的另一种方法类似于 JohnFx 建议的方法（我在[这里](http://bytes.com/forum/thread145239.html)找到了它，但没有测试过）：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Curr entVersion\Internet
Settings\User Agent\Post Platform 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-06T13:07:30.573

好吧，“some”提到的方法非常常见，但还有其他方法，例如，如果应用程序正在本地侦听端口，则可以从浏览器检测到，这对于安全解决方案来说非常常见，因为有某种本地代理过滤流量。实际上，我不久前制作了一个关于使用这种技术检测 avast 杀毒软件的视频，您可以在这里观看：

[https://www.youtube.com/watch?v=39_Nd8oiEAk](https://www.youtube.com/watch?v=39_Nd8oiEAk)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T23:16:34.810

@JohnFx 的好主意。

解决这个问题的另一种方法是安装一个 ActiveX 控件或浏览器插件以及托盘应用程序安装。然后，您可以通过与检查可用 Flash 版本时类似的方式访问它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T23:43:34.583

将托盘应用程序（假设这是托管应用程序）公开为 COM 对象。然后，您可以使用带有 GUID 的标签并在未找到时捕获错误，或者使用带有 progid 的 ActiveXobject 来检测它是否已安装。

# vb6 - vb6 我将如何编辑它以使扩展名仅计为 3 个字符（字符串解析）

> ID：291705
> 
> 赞同：1
> 
> 时间：2008-11-14T22:52:43.453
> 
> 标签：vb6, string

前几天有人在这里发布了一个很棒的小功能，它将文件的完整路径分成几个部分，如下所示：

```
Function BreakDown(Full As String, FName As String, PName As String, Ext As String) As Integer
 If Full = "" Then
 BreakDown = False
 Exit Function
 End If
 If InStr(Full, "\") Then
 FName = Full
 PName = ""
 Sloc% = InStr(FName, "\")
 Do While Sloc% <> 0
   PName = PName + Left$(FName, Sloc%)
   FName = Mid$(FName, Sloc% + 1)
   Sloc% = InStr(FName, "\")
 Loop
 Else
 PName = ""
 FName = Full
 End If
Dot% = InStr(Full, ".")
If Dot% <> 0 Then
 Ext = Mid$(Full, Dot%)
Else
 Ext = ""
End If
BreakDown = True

End Function 
```

但是，如果该行继续超过该点，它会将其视为扩展的一部分，是否无论如何都要在字符串中的最后一个句点之后仅计为 3 个字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T23:12:44.350

```
Dot% = InStrRev(Full, ".")  ' First . from end of string
If Dot% <> 0 Then
 Ext = Mid$(Full, Dot%, 3)
Else
 Ext = ""
End If 
```

Mid$ 语法：Mid(string, start[, length])

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T23:06:02.617

如果您只有空白字符，则只需将其添加为第一行

```
Full = Trim(Full) 
```

如果你有其他角色，那么

改变：

```
Ext = Mid$(Full, Dot%) 
```

到：

```
Ext = Mid$(Full, Dot%, 3) 
```

# database - 开源地址洗涤器？

> ID：291728
> 
> 赞同：11
> 
> 时间：2008-11-14T23:03:26.973
> 
> 标签：database, street-address

我已经输入了一组姓名和地址，并输入了 Excel 电子表格，但问题是输入地址的许多人以许多不同的非标准格式输入了它们。我想在将所有地址转移到我的数据库之前清理这些地址。环顾四周，我在地址清理器（解析器或格式化程序）的方式中真正发现的是由[Semaphore](http://www.semaphorecorp.com/)推出的那个。就我的目的而言，我真的不需要所有这些，也不想支付软件的许可费。有什么免费和/或开源的东西可以帮我清理吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-18T13:23:07.580

由于我从事邮寄业务...

可邮寄地址不是地理编码。一个允许 USPS 将邮件投递到，另一个告诉您该点在哪里。USPS 不会对其可邮寄地址进行地理编码。它对于标记要定位的人的区域/区域很有用。

您购买的不是软件许可证，而是数据。邮局有很多规则，特别是如果您在商业上这样做并试图获得比头等舱更好的价格。有关完整的规则列表，请参阅[USPS 国内邮件手册](http://pe.usps.com/text/dmm300/dmm300_landing.htm)。USPS 一直在拉链之间移动拉链和家庭。该公司（我为之工作）向 USPS 支付其更新的邮件列表的费用，以便我们可以更新我们的数据库。每周。

回到你的问题。您想将数据更改为通用格式（street -> st）还是在寻找重复数据并只想存储真实的可邮寄地址？

对于通用格式；您可以将地址分成几部分，清理空白并应用术语/翻译字典。然后应用一些 sql 来查找重复项。请记住，家庭（1 个主要街道）与人（john doe，1 个主要街道）不同。

对于可邮寄的地址，你们中的一些人（读者）不会喜欢这个答案，但你想要信息而且这不是免费的。有人花费时间或金钱来获取和维护这些列表。所以，找一个商业模式来为这份名单筹集资金，或者找一个会为你做这件事的人。[数据和邮件管理](http://valassis.com/1024/Services/datamail.aspx)

实际上，[Semaphore](http://www.semaphorecorp.com/)非常便宜，请记住，地址数据库必须每季度更新一次，每季度 19 美元非常便宜。

另一个地址清理产品。[SAP 邮政软件](http://www.businessobjects.com/product/catalog/postalsoft_solutions/)。我不知道数据会花费多少。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-01-04T23:39:00.137

我实际上在地址验证行业工作...... Jim 的回答是明智的接受。不幸的是，对于我们这些预算较低的人来说，USPS 的官方数据价格昂贵，而且系统也很复杂。（我根据经验知道，因为我工作的公司[SmartyStreets](http://www.smartystreets.com)提供的地址验证比大多数公司都低。）

我在这里能做的最好的帮助是推荐一个低成本/免费的替代方案（取决于你的数量），比如 LiveAddress，对于地址列表，没有最低购买量，而且 API 超级便宜且超级简单，比较。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-10T14:41:43.530

USPS API 的 .NET 包装器

[http://www.codeproject.com/KB/cs/USPS_Web_Tools_Wrapper.aspx](http://www.codeproject.com/KB/cs/USPS_Web_Tools_Wrapper.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T19:21:44.157

我使用过的大多数软件都非常昂贵（或者换句话说，营销部门很天真并且预算巨大）。

这种工作是地理编码的先驱。这篇[链接的 Wiki 文章](http://en.wikipedia.org/wiki/Geocoding)包括地理编码软件列表，其中一些是免费的。如果幸运的话，一些免费的可能包括地址标准化例程。

如果你找到一个好的，请告诉我。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T14:01:07.860

我们使用Accuzip。它比大多数解决方案（约 700 美元/年）便宜得多，并且每两个月更新一次。它使用 USPS 地址标准化 API，为此我编写了一个 .NET 包装器。这允许我实时运行它（Accuzip，默认情况下，仅带有批处理模式）。

# python - 如何在python中拆分一个巨大的文本文件

> ID：291740
> 
> 赞同：31
> 
> 时间：2008-11-14T23:12:14.023
> 
> 标签：python, text-files

我有一个巨大的文本文件（~1GB），遗憾的是我使用的文本编辑器不会读取这么大的文件。但是，如果我可以将它分成两三个部分，我会很好，所以，作为一个练习，我想用 python 编写一个程序来完成它。

我想我想让程序做的是找到一个文件的大小，把这个数字分成几部分，然后对于每个部分，以块的形式读取到那个点，写入*文件名*.nnn 输出文件，然后向上读取-到下一个换行符并写入，然后关闭输出文件等。显然最后一个输出文件只是复制到输入文件的末尾。

您能帮我解决与文件系统相关的关键部分：文件大小、分块读取和写入以及读取换行符吗？

我将首先编写此代码测试，因此无需给我一个完整的答案，除非它是单行的；-)

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2010-02-04T22:42:29.323

linux有一个split命令

拆分 -l 100000 文件.txt

将拆分为相等的 100,000 行大小的文件

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-14T23:18:32.777

检查`os.stat()`文件大小和`file.readlines([sizehint])`. 这两个功能应该是您阅读部分所需的全部，希望您知道如何进行写作:)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-15T11:04:13.907

作为替代方法，使用日志库：

```
>>> import logging.handlers
>>> log = logging.getLogger()
>>> fh = logging.handlers.RotatingFileHandler("D://filename.txt", 
     maxBytes=2**20*100, backupCount=100) 
# 100 MB each, up to a maximum of 100 files
>>> log.addHandler(fh)
>>> log.setLevel(logging.INFO)
>>> f = open("D://biglog.txt")
>>> while True:
...     log.info(f.readline().strip()) 
```

您的文件将如下所示：

> filename.txt（文件结尾）
> filename.txt.1
> filename.txt.2
> ...
> filename.txt.10（文件开头）

这是使大型日志文件与您的`RotatingFileHandler`实现相匹配的一种快速简便的方法。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-06-07T18:38:57.410

现在，有一个可用的 pypi 模块，您可以使用它来将任何大小的文件拆分成块。看一下这个

[https://pypi.org/project/filesplit/](https://pypi.org/project/filesplit/)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-02-04T22:53:33.493

不要忘记用于随机访问文件的[seek()](http://docs.python.org/library/stdtypes.html#file.seek)和[mmap() 。](http://docs.python.org/library/mmap.html)

```
def getSomeChunk(filename, start, len):
    fobj = open(filename, 'r+b')
    m = mmap.mmap(fobj.fileno(), 0)
    return m[start:start+len] 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-02-04T23:42:15.427

这种生成器方法是一种（慢速）方法，可以在不占用内存的情况下获得一段线。

```
import itertools

def slicefile(filename, start, end):
    lines = open(filename)
    return itertools.islice(lines, start, end)

out = open("/blah.txt", "w")
for line in slicefile("/python27/readme.txt", 10, 15):
    out.write(line) 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-12-24T19:53:47.910

虽然[Ryan Ginstrom 的回答](https://stackoverflow.com/a/2204075/198633)是正确的，但它确实需要更长的时间（正如他已经指出的那样）。`itertools.islice`这是一种通过连续迭代打开的文件描述符来规避多次调用的方法：

```
def splitfile(infilepath, chunksize):
    fname, ext = infilepath.rsplit('.',1)
    i = 0
    written = False
    with open(infilepath) as infile:
        while True:
            outfilepath = "{}{}.{}".format(fname, i, ext)
            with open(outfilepath, 'w') as outfile:
                for line in (infile.readline() for _ in range(chunksize)):
                    outfile.write(line)
                written = bool(line)
            if not written:
                break
            i += 1 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-15T00:11:38.537

您可以使用`wc`and `split`（请参阅相应的联机帮助页）来获得所需的效果。在`bash`：

```
split -dl$((`wc -l 'filename'|sed 's/ .*$//'` / 3 + 1)) filename filename-chunk. 
```

产生相同行数的 3 个部分（当然最后一个有舍入误差），命名`filename-chunk.00`为`filename-chunk.02`.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-16T20:54:21.537

我已经编写了程序，它似乎工作正常。感谢 Kamil Kisiel 让我开始。
（请注意，FileSizeParts() 是此处未显示的函数）
稍后我可能会做一个执行二进制读取的版本，以查看它是否更快。

```
def Split(inputFile,numParts,outputName):
    fileSize=os.stat(inputFile).st_size
    parts=FileSizeParts(fileSize,numParts)
    openInputFile = open(inputFile, 'r')
    outPart=1
    for part in parts:
        if openInputFile.tell()<fileSize:
            fullOutputName=outputName+os.extsep+str(outPart)
            outPart+=1
            openOutputFile=open(fullOutputName,'w')
            openOutputFile.writelines(openInputFile.readlines(part))
            openOutputFile.close()
    openInputFile.close()
    return outPart-1 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-10-15T14:39:47.367

用法 - split.py 文件名 splitsizeinkb

```
import os
import sys

def getfilesize(filename):
   with open(filename,"rb") as fr:
       fr.seek(0,2) # move to end of the file
       size=fr.tell()
       print("getfilesize: size: %s" % size)
       return fr.tell()

def splitfile(filename, splitsize):
   # Open original file in read only mode
   if not os.path.isfile(filename):
       print("No such file as: \"%s\"" % filename)
       return

   filesize=getfilesize(filename)
   with open(filename,"rb") as fr:
    counter=1
    orginalfilename = filename.split(".")
    readlimit = 5000 #read 5kb at a time
    n_splits = filesize//splitsize
    print("splitfile: No of splits required: %s" % str(n_splits))
    for i in range(n_splits+1):
        chunks_count = int(splitsize)//int(readlimit)
        data_5kb = fr.read(readlimit) # read
        # Create split files
        print("chunks_count: %d" % chunks_count)
        with open(orginalfilename[0]+"_{id}.".format(id=str(counter))+orginalfilename[1],"ab") as fw:
            fw.seek(0) 
            fw.truncate()# truncate original if present
            while data_5kb:                
                fw.write(data_5kb)
                if chunks_count:
                    chunks_count-=1
                    data_5kb = fr.read(readlimit)
                else: break            
        counter+=1 

if __name__ == "__main__":
   if len(sys.argv) < 3: print("Filename or splitsize not provided: Usage:     filesplit.py filename splitsizeinkb ")
   else:
       filesize = int(sys.argv[2]) * 1000 #make into kb
       filename = sys.argv[1]
       splitfile(filename, filesize) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-09-26T17:30:31.647

这是一个可用于拆分大文件的 python 脚本`subprocess`：

```
"""
Splits the file into the same directory and
deletes the original file
"""

import subprocess
import sys
import os

SPLIT_FILE_CHUNK_SIZE = '5000'
SPLIT_PREFIX_LENGTH = '2'  # subprocess expects a string, i.e. 2 = aa, ab, ac etc..

if __name__ == "__main__":

    file_path = sys.argv[1]
    # i.e. split -a 2 -l 5000 t/some_file.txt ~/tmp/t/
    subprocess.call(["split", "-a", SPLIT_PREFIX_LENGTH, "-l", SPLIT_FILE_CHUNK_SIZE, file_path,
                     os.path.dirname(file_path) + '/'])

    # Remove the original file once done splitting
    try:
        os.remove(file_path)
    except OSError:
        pass 
```

您可以在外部调用它：

```
import os
fs_result = os.system("python file_splitter.py {}".format(local_file_path)) 
```

您也可以`subprocess`直接在程序中导入并运行它。

这种方法的问题是高内存使用：`subprocess`创建一个内存占用与您的进程相同大小的分叉，如果您的进程内存已经很重，它会在运行时加倍。与`os.system`.

这是另一种纯 python 方法，虽然我没有在大文件上测试过，但它会更慢但更节省内存：

```
CHUNK_SIZE = 5000

def yield_csv_rows(reader, chunk_size):
    """
    Opens file to ingest, reads each line to return list of rows
    Expects the header is already removed
    Replacement for ingest_csv
    :param reader: dictReader
    :param chunk_size: int, chunk size
    """
    chunk = []
    for i, row in enumerate(reader):
        if i % chunk_size == 0 and i > 0:
            yield chunk
            del chunk[:]
        chunk.append(row)
    yield chunk

with open(local_file_path, 'rb') as f:
    f.readline().strip().replace('"', '')
    reader = unicodecsv.DictReader(f, fieldnames=header.split(','), delimiter=',', quotechar='"')
    chunks = yield_csv_rows(reader, CHUNK_SIZE)
    for chunk in chunks:
        if not chunk:
            break
        # Do something with your chunk here 
```

这是另一个使用的示例`readlines()`：

```
"""
Simple example using readlines()
where the 'file' is generated via:
seq 10000 > file
"""
CHUNK_SIZE = 5

def yield_rows(reader, chunk_size):
    """
    Yield row chunks
    """
    chunk = []
    for i, row in enumerate(reader):
        if i % chunk_size == 0 and i > 0:
            yield chunk
            del chunk[:]
        chunk.append(row)
    yield chunk

def batch_operation(data):
    for item in data:
        print(item)

with open('file', 'r') as f:
    chunks = yield_rows(f.readlines(), CHUNK_SIZE)
    for _chunk in chunks:
        batch_operation(_chunk) 
```

readlines 示例演示了如何对数据进行分块以将块传递给需要块的函数。不幸的是 readlines 在内存中打开整个文件，最好使用阅读器示例来提高性能。尽管如果您可以轻松地将所需的内容放入内存并需要分块处理它就足够了。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-12-02T19:05:08.807

这对我有用

```
import os

fil = "inputfile"
outfil = "outputfile"

f = open(fil,'r')

numbits = 1000000000

for i in range(0,os.stat(fil).st_size/numbits+1):
    o = open(outfil+str(i),'w')
    segment = f.readlines(numbits)
    for c in range(0,len(segment)):
        o.write(segment[c]+"\n")
    o.close() 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-10-02T09:38:24.947

您可以实现将任何文件拆分为如下所示的块，这里 CHUNK_SIZE 为 500000 字节（500kb），内容可以是任何文件：

```
for idx,val in enumerate(get_chunk(content, CHUNK_SIZE)):
    data=val
    index=idx

def get_chunk(content,size):
        for i in range(0,len(content),size):
            yield content[i:i+size] 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-05-24T17:16:39.660

我需要拆分 csv 文件以导入 Dynamics CRM，因为导入的文件大小限制为 8MB，而我们收到的文件要大得多。该程序允许用户输入 FileNames 和 LinesPerFile，然后将指定的文件拆分为请求的行数。我不敢相信它的工作速度有多快！

```
# user input FileNames and LinesPerFile
FileCount = 1
FileNames = []
while True:
    FileName = raw_input('File Name ' + str(FileCount) + ' (enter "Done" after last File):')
    FileCount = FileCount + 1
    if FileName == 'Done':
        break
    else:
        FileNames.append(FileName)
LinesPerFile = raw_input('Lines Per File:')
LinesPerFile = int(LinesPerFile)

for FileName in FileNames:
    File = open(FileName)

    # get Header row
    for Line in File:
        Header = Line
        break

    FileCount = 0
    Linecount = 1
    for Line in File:

        #skip Header in File
        if Line == Header:
            continue

        #create NewFile with Header every [LinesPerFile] Lines
        if Linecount % LinesPerFile == 1:
            FileCount = FileCount + 1
            NewFileName = FileName[:FileName.find('.')] + '-Part' + str(FileCount) + FileName[FileName.find('.'):]
            NewFile = open(NewFileName,'w')
            NewFile.write(Header)

        NewFile.write(Line)
        Linecount = Linecount + 1

    NewFile.close() 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2008-11-15T18:05:32.627

或者，python 版本的 wc 和 split：

```
lines = 0
for l in open(filename): lines += 1 
```

然后一些代码将第一行 / 3 读入一个文件，将下一行 / 3 读入另一个文件，等等。

# c# - 为 Internet Explorer 中托管的 Windows 窗体控件配置安全性

> ID：291744
> 
> 赞同：0
> 
> 时间：2008-11-14T23:13:55.407
> 
> 标签：c#, .net, security

我创建了一个 Windows 窗体控件，它托管在 Internet Explorer 可查看的网页中。

我的控件从 com 端口读取数据并将其写入事件日志。默认情况下，当框架请求适当的权限时，这两个操作都会失败。此 Web 应用程序将始终在 Intranet 区域中运行，如何启用这些操作？

串口代码位和错误：

```
private System.IO.Ports.SerialPort portCardReader_m = new System.IO.Ports.SerialPort();
portCardReader_m.PortName = value;
portCardReader_m.Open();  //Exception here 
```

> 请求“System.Security.Permissions.SecurityPermission,mscorlib, Version=2.0.0.0, Culture=neutral,PublicKeyToken=b77a5c561934e089 类型的权限失败。

事件日志代码位和错误：

```
System.Diagnostics.EventLog pEventLog = new System.Diagnostics.EventLog("Application", ".", this.GetType().FullName);
pEventLog.WriteEntry(this.Text, System.Diagnostics.EventLogEntryType.Error); //Exception Here 
```

> 'System.Diagnostics.EventLogPermission,System, Version=2.0.0.0, Culture=neutral,PublicKeyToken=b77a5c561934e089 类型的权限请求失败。

将我的控件嵌入浏览器的代码：

```
<object width="600px" height="300px" id="objCardReader" classid="cardreader.dll#CardReader">
    <param name="Text" value="Testing" />
    <param name="PortName" value="COM5" />
</object> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T23:32:32.390

您需要创建一个安装程序或让您的用户为您的网站授予更高的信任级别。这些设置可在 Microsoft .NET Framework 配置下进行编辑。在管理工具下。您还可以查看使用安装程序授予这些权限的[Chris Sells Wahoo](http://www.sellsbrothers.com/wahoo/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-15T02:05:11.287

我过去一直在努力解决这个问题，并尝试使用 caspol 来提升权限，这真的很痛苦。我最终在 30 分钟内将其转换为一次点击应用程序，此后再也没有遇到过问题。

# c++ - 关于调试、多线程的面试题

> ID：291745
> 
> 赞同：4
> 
> 时间：2008-11-14T23:14:10.460
> 
> 标签：c++, debugging

我昨天有电话面试问题。面试官问我是否遇到过任何具有挑战性的调试问题？我告诉他我曾经在调试别人的代码时遇到过问题，我花了 3-4 天才解决这个问题。我使用 Windbg、符号和故障转储来解决问题。

现在这足以说明吗？面试官期待什么？

我不知道还能说什么，我很久以前就遇到过这个问题，无法解释所有细节......

这个问题很常见，我不确定它的正确答案是什么？

还有一个很常见的问题：

您是否从事过多线程应用程序？你怎么能发现死锁？回答：要找到死锁，我们可以查看内存中进程的快照并查看正在等待的线程。

然后下一个问题：你能做些什么来避免死锁？

1.  使用 waitformultipleobjects
2.  保持关键部分的顺序

你们说什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-14T23:27:44.570

面试的一般规则是使用 STAR 模型（我的合作协调员会在这里感到自豪......）：

**S** - 描述你所处的情况
**T** - 解释任务，提供足够的信息以便面试官理解问题。
**A** - 描述你为解决问题所采取的行动。
**R** - 你的行动的结果是什么

如果你提供一个简洁的答案，不要太短或太长，99.9% 的面试官都会满意。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T16:26:32.717

多线程应用程序中可能发生死锁的主要原因之一是循环等待，其中两个不同的线程持有两个资源，每个线程都在等待另一个资源。发生死锁的其他条件是无抢占、等待和互斥。

避免死锁的最好方法是保持锁定顺序。换句话说，让线程能够以特定的顺序获得锁。这将限制线程进入死锁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-15T01:33:20.463

面试问题（好吧，至少是好的）并不关心你告诉你所拥有的知识，它向面试官解释你确实知道它。

因此，尽管您可以解释 windbg 的全部复杂性，但他不会在意。他会关心你知道该做什么并相信你。你只需要提供足够的信息来满足这一点。另一种方法是在他面前实际调试一些东西来证明这一点，面试永远不会持续那么久:)

所以我认为（根据你所说的）你知道你在说什么，你确实有这种经验，你可以再做一次。因此，让我们继续下一个问题，以进一步了解您还知道什么。

有时你们很多人的回答有点模棱两可，没问题——我们只会问一个又一个，直到我们发现我们是否认为你足够胜任这个角色。

面试就像考试一样，因为面试官感兴趣的是你的工作，而不是结果。

# jquery - MVC 和 jQuery 验证，在哪里“编织”javascript 以及如何嵌入母版页？

> ID：291750
> 
> 赞同：2
> 
> 时间：2008-11-14T23:15:24.750
> 
> 标签：jquery, asp.net-mvc, validation

如果我的页眉/页脚在母版页中，并且我的 .js 文件在母版页中被引用，我如何在我的登录页面上添加 jQuery 验证？

如果检测到错误，我将如何修改 .js 文件以显示相应的错误消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T23:33:45.430

你看过 jquery[验证插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)吗？该插件会自动处理许多不同的验证任务——即，您可能能够侥幸逃脱：

```
$(document).ready( function { $(form).validate(); } ); 
```

使用适当的类属性注释您的文本字段。您应该能够只在您的视图页面上引用验证库，并在那里添加文档就绪功能以及脚本标记内。

```
<asp:Content runat="server" ID="viewcContent" ContentID="masterContent">
   <script type="text/javascript" src="..path_to/jquery.validate.js">
   </script>
   <script type="text/javascript">
       $(document).ready( function { $(form).validate(); } );
   </script>
   <% using (Html.BeginForm()) { %>

     ... form implementation...

      <input type="text" id="username" name="username" class="required" />

   <% } %>
</asp:Content> 
```

# macos - 我想为 Mac 找到类似 gkrellm 的东西

> ID：291757
> 
> 赞同：1
> 
> 时间：2008-11-14T23:18:11.077
> 
> 标签：macos, sysadmin, remote-administration

我有一个我正在观看的 linux 开发服务器，最近它在某些时候出现了问题，所以我想更好地关注它。我曾经使用 Gkrellm，但尝试让 Gkrellm 在我的 Mac 上构建是一件很痛苦的事情。

除了远程服务器 X （这不是最佳的），我想我正在寻找 Gkrellm 的替代品。

我想要一个可以让我观察运行 Linux 的远程服务器的 I/O CPU、内存、进程等的程序。我在 Mac 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T23:41:39.783

如果您正在寻找一些简单的东西，并且几乎可以肯定已经安装在 Linux 机器上，您可以通过 SSH 连接到 Linux 机器并使用[top](http://unixhelp.ed.ac.uk/CGI/man-cgi?top)、[vmstat](http://unixhelp.ed.ac.uk/CGI/man-cgi?vmstat)和[lsof](http://unixhelp.ed.ac.uk/CGI/man-cgi?lsof)等工具来查看它在做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-06T00:00:34.573

如果您仍想在 Mac 上测试 Gkrellm，您可以按照以下步骤操作

```
# sudo port install gkrellm 
```

如果您有此错误：

*错误：目标 org.macports.activate 返回：注册表错误：xorg-xproto 7.0.16_0 未注册为已安装。[...] 错误：处理过程中遇到状态 1。*

做这个

```
# sudo port clean xorg-xproto
# sudo port install xorg-xproto 
```

并继续安装

```
# sudo port install gkrellm 
```

现在如果你有这个错误：

*错误：目标 org.macports.configure 返回：配置失败：shell 命令“cd”/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_ports_gnome_gtk-doc/work/gtk-doc-1.11" && ./configure - -prefix=/opt/local --with-xml-catalog=/opt/local/etc/xml/catalog "返回错误 1 ​​[...] 错误：处理过程中遇到状态 1。*

做这个

```
# sudo port clean gtk-doc
# sudo port install gtk-doc 
```

最后

```
# sudo port install gkrellm 
```

启动 gkrellm

```
# gkrellm 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T11:51:46.890

为此，您可以使用[Growl 。](http://growl.info/)[可以使用netgrowl.py](http://the.taoofmac.com/space/Projects/netgrowl)从 unix 机器发送 Growl 消息，它伪装成 growlnotify 程序，但都是用 python 编写的。

然后，您可以在服务器上运行一个进程来监视其他位，并在超出限制时发布通知，或者其他什么。

这将是一个手动编码的解决方案，但我们在 Stack Overflow，所以与编程相关的东西是可行的 :)

（哦，netgrowl.py 页面有一些其他语言的类似项目的链接，如果这也是你的事的话）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-09T16:56:56.580

您可能正在寻找更严格的监控工具，例如 zabbix。[https://zabbix.org](https://zabbix.org)

# c# - 将一个相当简单的 C# 类库转换为 COM 对象？

> ID：291761
> 
> 赞同：2
> 
> 时间：2008-11-14T23:20:15.723
> 
> 标签：c#, web-services, com, asp-classic

这是我的问题：我必须从返回复杂数据类型的经典 ASP 页面调用具有安全标头的 Web 服务。由于有关第 3 方工具的各种原因，它必须是经典的 ASP。我们决定我应该创建一个外部 dll 来执行此操作 - 我做了（在 c# 中）所以它返回一个数据集（ASP 可以理解的东西）。但是现在我需要将该函数公开给 ASP 页。因为这是经典的 ASP，所以我认为唯一直接的方法是将这个类库公开为 COM 对象。我需要知道完成这项任务的最简单的方法。我必须对我的 dll 做什么？

我从未使用过之前创建过 COM 对象。有人说我的类必须是静态的，我不能有构造函数。这是真的？有人可以为我安排步骤吗？

帮助！(o:

编辑：这个特定的问题现在已经解决了，但是正如 Robert Rossney 指出的那样，我不能对经典 ASP 中的 DataSet 做任何事情。这导致我在[这里](https://stackoverflow.com/questions/301045/problem-implementing-xmltextwriter-in-new-xmlrecordsetwriter-for-streams)发布第二个关于实现 XmlTextWriter 的问题 - 如果你看到这个罗伯特，我认为你真的可以提供帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T23:34:41.123

不，那（静态/无 ctor）不是真的。事实上，恰恰相反，因为 COM 需要创建一个实例！您只需要使 COM 类可见。主要是，这只是添加一些属性，并将其注册为 COM dll (regasm)。

[http://msdn.microsoft.com/en-us/library/zsfww439.aspx](http://msdn.microsoft.com/en-us/library/zsfww439.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-15T03:05:54.363

创建一个返回 DataSet 的类并不难：

```
using System;
using System.Data;
using System.Runtime.InteropServices;

namespace COMTest
{
   [Guid("AC4C4347-27EA-4735-B9F2-CF672B4CBB4A")]
   [ComVisible(true)]
   public interface ICOMTest
   {
       [ComVisible(true)]
       DataSet GetDataSet();
   }

   [Guid("CB733AB1-9DFC-437d-A769-203DD7282A8C")]
   [ProgId("COMTest.COMTest")]
   [ComVisible(true)]
   public class COMTest : ICOMTest
   {
       public DataSet GetDataSet()
       {
           DataSet ds = new DataSet("COMTest");
           return ds;
       }
   } 
```

}

您需要检查项目属性中的“注册 COM 互操作”框，您还需要对程序集进行签名，并且您需要确保 IIS 用户可以访问您的`bin\Debug`目录。

完成此操作后，您就可以从 ASP 创建一个实例了：

```
<%
Dim o
Set o = Server.CreateObject("COMTest.COMTest")
Response.Write("Server.CreateObject worked.")
Response.Write("<br/>")
Dim ds
Set ds = o.GetDataSet()
If Not ds is Nothing Then
  Response.Write("o.GetDataSet returned an object.  Can we use it?")
  Response.Write("<br/>")
  Response.Write("We have a DataSet, and its DataSetName is: ")
  Response.Write(ds.DataSetName)
End If
%> 
```

在这里你会很伤心。因为虽然返回 DataSet 的方法对 COM 是可见的，但 DataSet 的任何属性或方法都不可见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-15T03:34:05.133

> 有人说我的类必须是静态的，我不能有构造函数。这是真的？

COM 类需要有一个默认构造函数，客户端在调用 CoCreateInstance 时将使用该构造函数。创建对象后，您可以在其上设置属性，或调用其他方法。

这类似于 .Net 处理可序列化对象的方式……您使用默认构造函数构造它，然后设置其所有属性。（如果你喜欢 RAII，那么你对 COM 和 .Net 都不走运。克服它；）

至于静态评论，不，这不是真的，正如 Marc 指出的那样。

# delphi - 您是否在高分辨率屏幕和非标准/高对比度配色方案上进行测试？

> ID：291764
> 
> 赞同：2
> 
> 时间：2008-11-14T23:21:08.683
> 
> 标签：delphi, user-interface, dpi

我在我的大多数机器上使用非默认的 Windows 配色方案，并且有一台笔记本电脑，其屏幕设置为 124 DPI，Windows 设置为。

我测试甚至每天使用的许多程序似乎都存在问题，例如显示非标准尺寸的控件、截断的 UI 元素、不可读的文本等。从有点烦人到（几乎）不可用的整个范围。

现在我觉得很多这些问题都是不必要的。在高分辨率屏幕上以几种配色方案运行的简单测试将显示它们，其中一些甚至非常容易纠正（例如总是使用 clWindow、clWindowText 和 clBtnFace 而不是 clWhite、clBlack 和 clSilver）。其中一些更难，比如适当的控制大小。

所以我的问题是：您是否尝试遵循 UI 指南中关于系统颜色、UI 元素的大小和间距以及字体大小和面孔的建议？对它们的合规性测试是否是您的 QA 流程的一部分？即使大多数IDE（在我的例子中是Delphi）都有面向像素的设计器，您是否甚至尝试以对话框单元而不是像素来布置表单？

[编辑]：在睡觉后重新阅读这篇文章时，我注意到这个问题可能看起来像是一个毫无结果的讨论邀请。这不是那个意思，我肯定会对帮助我创建符合 UI 界面指南的应用程序的工具感兴趣，我觉得 Delphi 让我有点失望的领域。另请参阅我自己的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-15T09:32:58.200

我绝对不会。我更愿意花时间改善许多人的体验，而不是少数使用非标准 Windows 设置的人。我通常会做的一些事情，仍然可以解决其中一些问题：

*   使用 clWindows 等，因为无论如何这都是 Delphi 控件的标准，那么为什么要更改它呢？
*   将标签放在输入字段上方而不是左侧，这应该可以解决许多大小问题
*   通过设置锚点，确保表单正确调整大小
*   确保标签顺序是正确的（如果不这样做可能会成为一个主要的烦恼）

但是我当然不会花时间设置具有奇怪分辨率和颜色的测试计算机，或者更糟糕的是，更改我的开发盒以使用它们（这会搞砸很多事情，而这些事情又需要时间才能正确重置）。

如果付费客户报告非标准设置的问题，则取决于客户是否会得到解决。如果他订购 100 个许可证，他的机会很大。如果他因为视力受损而使用这些设置，那么他的机会很大。如果他把它作为要求的一部分，我会做，但要为额外的工作收费。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-15T03:15:37.417

今天，很多软件在非标准 DPI 下无法正常工作，我认为不值得尝试修复它。许多应用程序的故障排除常见问题解答只是指示用户针对相关问题切换到正常字体大小。Microsoft 承认在第 3 方软件中缺乏适当的 DPI 支持，并在 Windows Vista 中重新设计了显示缩放方法，其中所有 GDI 操作都在较低级别上缩放，而不是依赖于知道 DPI 设置的应用程序。

最终答案：这取决于您的软件的受众。如果您的软件可能会被残疾用户使用，那么这可能是值得的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-15T10:04:52.397

除了为标准颜色使用适当的颜色常量外，我还为需要在高 DPI 屏幕上内部使用的应用程序或客户可能需要的应用程序投入了一些额外的精力。

我有一个带有帮助函数的单元，用于确定适当的大小和放置边距，它根据 UI 指南中给出的默认 GUI 字体和对话框单元中的标准值计算这些，并带有帮助函数来计算最大宽度/高度控件数组，位置控件，诸如此类。对于固定大小的表单和对话框，我在使用 GNU gettext 翻译它们的文本后计算控件的位置一次，对于可调整大小的表单，我在 OnResize 处理程序中执行此操作。

这给出了很好的结果，但是很耗时。我希望有类似[wxWidgets sizer 功能](http://docs.wxwidgets.org/stable/wx_sizeroverview.html#sizeroverview)的东西，一旦设置了控件的最小大小，它就会自动调整大小。不过，我从未见过 Delphi 类似的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T12:33:58.117

我偶尔会自己测试大字体，因为我的 Vista 笔记本电脑设置为大字体。颜色，不多，但我很少在控件上指定颜色。

但是，正确调整大小非常困难。我通常将 Forms scale 设置为 false，以免它们调整大小错误。

有一些用于自动调整表单大小的工具。我确实调查过它们，但从未有时间正确测试它们：

*   [TFormResizer](http://www.delphi32.com/vcl/1289/download,xid,1289.asp)

*   [ElasticForm](http://www.elasticform.com/) - 具有讽刺意味的是（考虑到组件的区域）此页面中的大部分文本不会显示在 Chrome 中...

*   JVAutoFormSize （在 JVCL 中 - 从我读到的内容似乎不是很有用）

# c# - 字母数字单词的正则表达式，长度必须为 6 个字符

> ID：291774
> 
> 赞同：3
> 
> 时间：2008-11-14T23:27:04.943
> 
> 标签：c#, regex, alphanumeric

字母数字单词的正则表达式是什么，至少 6 个字符长（但最多 50 个）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-14T23:33:11.157

```
/[a-zA-Z0-9]{6,50}/ 
```

如果要实际匹配文本中的单词，可以在开头/结尾 (\b) 处使用单词边界。

```
/\b[a-zA-Z0-9]{6,50}\b/ 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-15T00:16:21.117

```
\b\w{6,50}\b 
```

`\w`是任何“单词”字符 - 根据正则表达式的风格，它可能只是 [a-z0-9_] 或者它可能包括其他字符（例如重音字符/等）。

`{6,50}`表示 6 到 50（含）之间

`\b`表示单词边界（确保单词两端不超过 50）。

重新阅读后，您似乎想要确保整个文本匹配？如果是这样...

```
^\w{6,50}$ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T23:32:40.690

使用 PCRE 正则表达式，您可以这样做：

```
/[a-zA-Z0-9]{6,50}/ 
```

如果没有最小/最大量词，在正则表达式中将很难做到，所以希望你的语言支持它们。

# haskell - 函数式编程新手

> ID：291780
> 
> 赞同：3
> 
> 时间：2008-11-14T23:31:57.650
> 
> 标签：haskell, functional-programming, viterbi

嘿，我真的是 Haskell 的新手，我一生都在使用更经典的编程语言。我不知道这里发生了什么。我正在尝试制作一个非常简单的维特比算法实现，但仅适用于两种状态（诚实和不诚实的赌场）

我有一个问题，我想解决我的数组，但我不认为我得到了正确的类型。或者我每次尝试解决它时都会创建一个新数组 - 同样愚蠢。请特别查看 myArray、te 中缀和 dynamicProgram。请漂亮漂亮

```
代码
 import Array
import Char

trans :: Int -> Int -> Double -> Double -> Double
trans from x trans11 trans21 =
    if (from == 1) && (x == 1)
        then trans11
    else if (from == 1) && (x == 2) 
        then (1-trans11)
    else if (from == 2) && (x == 1) 
        then trans21
    else (1-trans21)

em :: Char -> [Double] -> Double
em c list = list!! a
    where a = digitToInt c

intToChar :: Int -> Char
intToChar n | n == 1 = '1'
            | n == 2 = '2'

casino :: Char -> Int -> Int -> [Double] -> [Double] -> Double -> Double -> Double
casino seqchar 1 y em1 em2 t1 t2= 0.5 * (em seqchar em1)
casino seqchar 2 y em1 em2 t1 t2= 0.5 * (em seqchar em2)
casino seqchar x y em1 em2 t1 t2= maximum[ (1 @@ y-1)*(em seqchar em1)*(trans 1 x t1 t2),(2 @@ y-1)*(em seqchar em2)*(trans 2 x t1 t2) ]

dynamicProgram :: [Char] -> (Char -> Int -> Int -> [Double] -> [Double] -> Double -> Double -> Double) -> [Double] -> [Double] -> Double -> Double -> (Array a b)
dynamicProgram string score list1 list2 trans11 trans21 = myArray 1 len
                                [score (string!!y) x y list1 list2 trans11 trans21 | x  Int -> [Double] -> Array a b
myArray startIndex endIndex values = listArray (startIndex,startIndex) (endIndex,endIndex) values

traceback :: [Char] -> Int -> Int -> [Double] -> [Double] -> Double -> Double -> [Char]
traceback s 1 0 em1 em2 t1 t2 = []
traceback s 2 0 em1 em2 t1 t2 = []
traceback s x y em1 em2 t1 t2 | x@@y == (1 @@ y-1)*(em (s!!y) em1)*(trans 1 x t1 t2) = '1' : traceback s 1 (y-1) em1 em2 t1 t2
                            | x@@y == (2 @@ y-1)*(em (s!!y) em1)*(trans 2 x t1 t2) = '2' : traceback s 2 (y-1) em1 em2 t1 t2 

answer :: [Char] -> [Double] -> [Double] -> Double -> Double -> [Char]
answer string list1 list2 t1 t2 = reverse $ maxC : traceback string max end list1 list2 t1 t2 $ dynamicProgram casino string list1 list2 t1 t2
   where
      end = (length string) + 1
      max | maximum (1@@end) (2@@end) == 1@@end = 1
      | maximum (1@@end) (2@@end) == 2@@end = 2
      maxC = intToChar max

infix 5 @@
(@@) i j = myArray ! (i, j)

main = do
    putStrLn "What is the sequence to test?"
    seq  state 1 transmission probability?"
    trp1  state 2 transmission probability is " ++ (1-trp1)
    putStrLn "What is the state 2 -> state 1 transmission probability?"
    trp2  state 2 transmission probability is " ++ (1-trp2)
    putStrLn "I assume that the prob of starting in either state is 1/2\.  Go!"
    answer seq st1 st2 trp1 trp2 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-15T00:11:13.153

我从编辑窗口复制了代码（stackoverflow 的解析器中的某些东西正在吃掉部分代码）并在 ghci 上尝试了它，发现了几个错误。第一个错误是：

```
foo.hs:34:71:
    Couldn't match expected type `[e]' against inferred type `(a, b)'
    In the second argument of `listArray', namely
        `(endIndex, endIndex)'
    In the expression:
        listArray (startIndex, startIndex) (endIndex, endIndex) values
    In the definition of `myArray':
        myArray startIndex endIndex values
                  = listArray (startIndex, startIndex) (endIndex, endIndex) values 
```

listArray 的类型是：

```
listArray :: (Ix i) => (i, i) -> [e] -> Array i e
        -- Defined in GHC.Arr 
```

它需要一个具有上下限和列表的元组。所以，正确的表达方式可能是：

```
listArray (startIndex, endIndex) values 
```

而且 myArray 的类型不是`Array a b`，它是`Array Int Double`。

第二个错误是：

```
foo.hs:43:44:
    Couldn't match expected type `a -> b'
           against inferred type `[Char]'
    In the first argument of `($)', namely
        `maxC : (traceback string max end list1 list2 t1 t2)'
    In the second argument of `($)', namely
        `(maxC : (traceback string max end list1 list2 t1 t2))
       $ (dynamicProgram casino string list1 list2 t1 t2)'
    In the expression:
          reverse
        $ ((maxC : (traceback string max end list1 list2 t1 t2))
         $ (dynamicProgram casino string list1 list2 t1 t2)) 
```

`$`是右结合的，所以`$`首先看最右边的。它的第一个参数必须是一个函数，它将以其最右边的参数作为参数调用该函数。然而，这里是一个列表。

第三个错误是：

```
foo.hs:51:11:
    Couldn't match expected type `Array i e'
           against inferred type `Int -> Int -> [Double] -> Array a b'
    In the first argument of `(!)', namely `myArray'
    In the expression: myArray ! (i, j)
    In the definition of `@@': @@ i j = myArray ! (i, j) 
```

`myArray`不是数组；它是一个函数，它接受三个参数并基于它们构造一个数组。

在这里，您习惯于更传统的命令式语言可能会绊倒您。在传统的命令式语言中，拥有一个全局`myArray`变量是很自然的，然后您可以从程序中间访问该变量。然而，在 Haskell 中，没有初学者不应该尝试的更高级的技巧，“全局”变量更像是一个常量值（在第一次使用时延迟计算，但据您所知可以计算在生成可执行文件时由编译器执行）。您不能从作为输入读取的值初始化它。

解决这个问题的最好方法是通过程序传递数组，不幸的是这需要进行一些更改并否定`@@`操作符的有用性。您可以通过几种更高级的方式隐藏数组的传递，但在学习时最好更加明确。

最后一个错误是：

```
foo.hs:63:4:
    Couldn't match expected type `[a]' against inferred type `IO ()'
    In the first argument of `(++)', namely
        `putStrLn
           "I assume that the state 1 -> state 2 transmission probability is "'
    In the expression:
          (putStrLn
             "I assume that the state 1 -> state 2 transmission probability is ")
        ++
          (1 - trp1)
    In a 'do' expression:
          (putStrLn
             "I assume that the state 1 -> state 2 transmission probability is ")
        ++
          (1 - trp1) 
```

这有两个错误：编译器抱怨的一个是优先级问题，正如编译器添加的括号很容易显示的那样，并且可以通过正确应用括号或`$`运算符来轻松修复。修复此错误后您会发现另一个错误是您无法连接字符串和数字；您必须将数字转换为字符串。

这一切都没有查看算法甚至大部分代码，只查看编译器错误。例如，如果你想要一个二维数组，第一个错误的正确表达式是：

```
listArray ((startIndex, startIndex), (endIndex, endIndex)) values 
```

现在两个边界都是元组，它的类型是`Array (Int, Int) Double`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-26T16:03:05.227

您可以像这样重写 trans 函数：

```
trans :: Int -> Int -> Double -> Double -> Double
trans 1 1 trans11 trans21 =   trans11
trans 1 2 trans11 trans21 = 1-trans11
trans 2 1 trans11 trans21 =   trans21
trans _ _ trans11 trans21 = 1-trans21 
```

# database - 如何从数据库发布向导导出设置？

> ID：291789
> 
> 赞同：1
> 
> 时间：2008-11-14T23:34:42.260
> 
> 标签：database, visual-studio-2008, settings, databasepublishingwizard

我正在使用 VS2008 中的[数据库发布向导](http://www.codeplex.com/sqlhost/Wiki/View.aspx?title=Database%20Publishing%20Wizard)将更改推送到我的托管服务提供商。看起来这些设置与项目无关（这对我来说似乎有点傻），而是与机器一起使用。

在我想从中发布的每台新机器上，我都需要完成挖掘数据库设置的过程。

**有没有办法将这些设置备份/导出/保存到文件中？**

如果是这样，它是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-18T21:20:43.823

嗯......似乎发布向导[使用 2 个配置文件来进行应用程序配置](http://technet.microsoft.com/en-us/library/bb895179.aspx)：

> 发布数据库向导使用文件*user.config*和*hoster.config*来存储配置信息。存储这些文件的目录必须设置适当的 NTFS 文件系统权限。这些文件包含用户名和加密密码。密码使用 DPAPI 加密。
> 
> **用户配置文件**
> 
> 此文件存储发布数据库向导的持久主机和配置设置。user.config 文件位于 %SystemDrive%\Documents and Settings\%Username%\Application Data\Microsoft\Microsoft SQL Server\90\Tools\Publishing Wizard\user.config。
> 
> **hoster.config 文件**
> 
> 此文件存储有关共享主机提供商的 Web 服务地址、用户名和数据库的选项。hoster.config 文件位于 %SystemDrive%\Documents and Settings\%Username%\Application Data\Microsoft\Microsoft SQL Server\90\Tools\Publishing Wizard\hoster.config。

我试图在 Vista 中访问这些文件（安装了 VS2008 和 SQL Express）并删除。我会及时向大家发布。

***更新：*** *看起来我毕竟没有安装发布向导。在[此处获取 VS2008 的版本](http://go.microsoft.com/fwlink/?LinkId=119368)，然后安装（别担心——您不会看到任何迹象表明它正在安装，但确实如此）......然后使用向导设置我的第一个数据库，它看起来确实有一些设置存储在上面列出的“应用程序数据”目录下。但是，它看起来只是一个 user.config，然后是每个配置的数据库的 XML 文件。我相信您可以备份这些文件中的每一个以供以后使用。*

# c++ - win32全选编辑ctrl（文本框）

> ID：291792
> 
> 赞同：7
> 
> 时间：2008-11-14T23:37:50.710
> 
> 标签：c++, user-interface, winapi, textbox

我正在使用这些选项创建我的文本框。我可以复制/剪切/粘贴/撤消，但是当我点击**全选**时，它并没有全选。我可以右键单击并单击**全选**，但`CTRL`+`A`不执行任何操作。为什么？

```
wnd = CreateWindow("EDIT", 0,
    WS_CHILD | WS_VISIBLE | ES_MULTILINE | WS_HSCROLL | WS_VSCROLL | ES_AUTOHSCROLL | ES_AUTOVSCROLL,
    x, y, w, h,
    parentWnd,
    NULL, NULL, NULL); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T22:23:28.360

`Ctrl`+不是像+和+`A`这样的内置加速器。这就是您看到定义了 WM_CUT、WM_PASTE 和 WM_COPY 消息但没有 WM_SELECTALL 的原因。`Ctrl``C``Ctrl``V`

您必须自己实现此功能。我在我的 MFC 应用程序中是这样的：

```
static BOOL IsEdit( CWnd *pWnd ) 
{
    if ( ! pWnd ) return FALSE ;
    HWND hWnd = pWnd->GetSafeHwnd();
    if (hWnd == NULL)
     return FALSE;

    TCHAR szClassName[6];
    return ::GetClassName(hWnd, szClassName, 6) &&
         _tcsicmp(szClassName, _T("Edit")) == 0;
}

BOOL LogWindowDlg::PreTranslateMessage(MSG* pMsg) 
{
    if(pMsg->message==WM_KEYDOWN)
    {
        if ( pMsg->wParam=='A' && GetKeyState(VK_CONTROL)<0 )
        {
            // User pressed Ctrl-A.  Let's select-all
            CWnd * wnd = GetFocus() ;
            if ( wnd && IsEdit(wnd) )
                ((CEdit *)wnd)->SetSel(0,-1) ;
        }
    }   
    return CDialog::PreTranslateMessage(pMsg);
} 
```

注意，我从这个页面偷了 IsEdit：http: [//support.microsoft.com/kb/145616](http://support.microsoft.com/kb/145616)

我指出这一点，部分原因是我想表扬，部分原因是我认为 IsEdit 函数（比较类名字符串）很笨拙，我想指责。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T23:21:42.737

您可以简单地使用 EM_SETSEL 消息到文本框，

根据 MSDN ，

> 如果开始为 0，结束为 –1，则选择编辑控件中的所有文本。如果开始为 –1，则取消选择任何当前选择。

所以，

```
SendMessage(hwndEdit,EM_SETSEL,0,-1); 
```

会正常工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-14T23:46:06.433

您需要捕获该击键并自己进行选择。

下面是一些用于 RichTextBox 的 C# 代码：

```
 protected override void OnKeyDown(KeyEventArgs e)
    {
        // Ctrl-A does a Select All in the editor window
        if (e.Control && (e.KeyCode == Keys.A))
        {
            this.SelectAll();
            e.Handled = true;
        }
    } 
```

抱歉，我没有你的 Win32 代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-15T01:25:30.477

我倾向于使用 MFC（请原谅我）而不是 Win32，所以我无法明确回答这个问题，但我注意到此评论添加到 MS 网站上有关与 Edit 控件（Edit 控件中的一个简单编辑器）交谈的页面中：

> 编辑控件`WM_CHAR`用于接受字符，而不是`WM_KEYDOWN` 等。您必须`Translate()`发送消息，否则讽刺的是您将无法在编辑控件中编辑文本。

我不知道这是否适用于 BoltBait 的回应，但我怀疑确实如此。

（我在[http://msdn.microsoft.com/en-us/library/bb775462(VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb775462(VS.85).aspx)找到了这个）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-12-30T22:42:31.780

奇怪的是`Ctrl`+ `A`DOES 工作（全选），如果你不指定 ES_MULTILINE

但是，如果您需要多行，那将无济于事

[ES_MULTILINE](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775464%28v=vs.85%29.aspx)的MSDN 文档似乎对此没有任何说明。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T23:56:11.173

会不会是别的东西在偷`Ctrl`+ `A`？使用 Spy++ 验证它是否到达您的编辑控件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T02:52:17.697

为什么不为`Ctrl`+ `a`to添加加速器`SelectAll`？

# svn - 递归地将文件添加到 Subversion 存储库

> ID：291793
> 
> 赞同：7
> 
> 时间：2008-11-14T23:38:04.580
> 
> 标签：svn

有没有办法将所有“未添加”文件递归添加到 SVN？

我想做类似的事情

```
svn add trunk/ 
```

添加所有新文件，而不获取：

```
svn: warning: 'trunk' is already under version control 
```

如果这是不可能的，有没有办法获取目录中不受版本控制的所有文件的列表？

请注意，我只对使用命令行感兴趣。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-14T23:47:08.413

使用 --force 选项。

例子：

```
svn add * --force 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-15T00:21:04.290

您可以生成文件列表并使用 xargs 添加它们

`svn status | awk '/\?/ {print $2}' | xargs svn add`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T23:50:02.480

如果 svn status 命令输出的第一列是问号，则该文件不受版本控制。有关更多信息，请参阅[svn status 命令的此页面。](http://svnbook.red-bean.com/en/1.0/re26.html)

# c# - 将 Pascal-case 字符串拆分为逻辑单词集

> ID：291804
> 
> 赞同：6
> 
> 时间：2008-11-14T23:48:26.650
> 
> 标签：c#, regex, string

我想采用像“CountOfWidgets”这样的帕斯卡大小写字符串，并将其转换为更用户友好的东西，例如 C# 中的“Count of Widgets”。多个相邻的大写字符应保持不变。最有效的方法是什么？

**注意**：.NET 的副本[- 如何将“大写”分隔的字符串拆分为数组？](https://stackoverflow.com/questions/155303/net-how-can-you-split-a-caps-delimited-string-into-an-array)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-15T00:00:24.597

不知道效率，但至少它很简洁：

```
Regex r = new Regex("([A-Z]+[a-z]+)");
string result = r.Replace("CountOfWidgets", m => (m.Value.Length > 3 ? m.Value : m.Value.ToLower()) + " "); 
```

# html - 将 PDF 嵌入 HTML 的推荐方法？

> ID：291813
> 
> 赞同：1311
> 
> 时间：2008-11-14T23:55:13.000
> 
> 标签：html, pdf

在 HTML 中嵌入 PDF 的推荐方法是什么？

*   框架？
*   目的？
*   嵌入？

Adobe 是怎么说的？

就我而言，PDF 是动态生成的，因此在刷新之前无法将其上传到第三方解决方案。

* * *

## 回答 #1

> 赞同：617
> 
> 时间：2011-08-12T17:29:23.340

这快速、简单、切中要害，并且不需要任何第三方脚本：

```
<embed src="http://example.com/the.pdf" width="500" height="375" 
 type="application/pdf"> 
```

**更新（2021 年 2 月 3 日）**

Adobe 现在提供它自己的 PDF 嵌入 API。

[https://www.adobe.io/apis/documentcloud/dcsdk/pdf-embed.html](https://www.adobe.io/apis/documentcloud/dcsdk/pdf-embed.html)

**更新（1/2018）：**

Android 上的 Chrome 浏览器不再支持 PDF 嵌入。您可以使用 Google Drive PDF 查看器解决此问题

```
<embed src="https://drive.google.com/viewerng/
viewer?embedded=true&url=http://example.com/the.pdf" width="500" height="375"> 
```

* * *

## 回答 #2

> 赞同：594
> 
> 时间：2008-11-15T00:01:51.410

可能最好的方法是使用[PDF.JS](https://mozilla.github.io/pdf.js/)库。它是一个纯[HTML5](https://en.wikipedia.org/wiki/HTML5) / [JavaScript](https://en.wikipedia.org/wiki/JavaScript)的 PDF 文档渲染器，没有任何第三方插件。

在线演示： [https ://mozilla.github.io/pdf.js/web/viewer.html](https://mozilla.github.io/pdf.js/web/viewer.html)

GitHub： [https ://github.com/mozilla/pdf.js](https://github.com/mozilla/pdf.js)

* * *

## 回答 #3

> 赞同：372
> 
> 时间：2010-03-10T13:38:11.510

为此，您还可以使用 Google PDF 查看器。据我所知，这不是谷歌的官方功能（我错了吗？），但它对我来说非常顺利和顺利。您需要先在某处上传您的 PDF，然后使用它的 URL：

```
<iframe src="http://docs.google.com/gview?url=http://example.com/mypdf.pdf&embedded=true" style="width:718px; height:700px;" frameborder="0"></iframe> 
```

重要的是它不需要 Flash 播放器，它使用 JavaScript。

* * *

## 回答 #4

> 赞同：133
> 
> 时间：2011-03-02T18:36:27.163

您可以通过在查询字符串中传递一些选项来控制 PDF 在浏览器中的显示方式。我很高兴这项工作，直到我意识到它在 IE8 中不起作用。:(

它适用于 Chrome 9 和 Firefox 3.6，但在 IE8 中会显示消息“如果无法显示 PDF，请在此处插入错误消息”。

不过，我还没有测试过上述任何浏览器的旧版本。但无论如何，这是我拥有的代码，以防它帮助任何人。这会将缩放设置为 85%，删除滚动条、工具栏和导航窗格。如果我确实遇到在 IE 中也有效的东西，我会更新我的帖子。

```
<object width="400" height="500" type="application/pdf" data="/my_pdf.pdf?#zoom=85&scrollbar=0&toolbar=0&navpanes=0">
    <p>Insert your error message here, if the PDF cannot be displayed.</p>
</object> 
```

* * *

## 回答 #5

> 赞同：71
> 
> 时间：2014-05-15T14:36:26.283

两者都使用`<object>`，`<embed>`将为您提供更广泛的浏览器兼容性。

```
<object data="http://yoursite.com/the.pdf" type="application/pdf" width="750px" height="750px">
    <embed src="http://yoursite.com/the.pdf" type="application/pdf">
        <p>This browser does not support PDFs. Please download the PDF to view it: <a href="http://yoursite.com/the.pdf">Download PDF</a>.</p>
    </embed>
</object> 
```

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2010-02-04T12:05:07.883

查看此代码 - 将 PDF 嵌入 HTML

```
<!-- Embed PDF File -->
<object src="YourFile.pdf" type="application/pdf" title="SamplePdf" width="500" height="720">
    <a href="YourFile.pdf">shree</a> 
</object> 
```

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2011-12-06T18:17:19.800

通过 ImageMagick 将其转换为 PNG，并显示 PNG（又快又脏）。

```
<?php
  $dir = '/absolute/path/to/my/directory/';
  $name = 'myPDF.pdf';
  exec("/bin/convert $dir$name $dir$name.png");
  print '<img src="$dir$name.png" />';
?> 
```

如果您需要快速解决方案，想要避免跨浏览器 PDF 查看问题，并且 PDF 只有一两页，这是一个不错的选择。当然，您需要在您的网络服务器上安装 ImageMagick（这反过来又需要 Ghostscript），该选项在共享托管环境中可能不可用。还有一个 PHP 插件（称为 imagick）可以[像这样](http://www.php.net/manual/en/imagick.examples-1.php)工作，但它有自己的特殊要求。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2019-06-16T21:56:37.840

您可以像这样使用保存的 pdf 的相对位置：

示例 1

```
<embed src="example.pdf" width="1000" height="800" frameborder="0" allowfullscreen> 
```

示例 2

```
<iframe src="example.pdf" style="width:1000px; height:800px;" frameborder="0" allowfullscreen></iframe> 
```

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2008-11-15T23:11:07.190

[FDView](http://www.code4net.com/archives/000114.html#114)将[PDF2SWF](http://www.swftools.org/pdf2swf.html)（它本身基于[xpdf](http://www.foolabs.com/xpdf/)）与[SWF](http://en.wikipedia.org/wiki/SWF)查看器相结合，因此您可以在服务器上动态转换和嵌入 PDF 文档。

xpdf 不是一个完美的 PDF 转换器。如果您需要更好的结果，那么[Ghostview](http://en.wikipedia.org/wiki/Ghostscript#Front_ends)可以将 PDF 文档转换为其他格式，您可以更轻松地为其构建 Flash 查看器。

但是对于简单的 PDF 文档，FDView 应该可以很好地工作。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2016-08-19T00:30:56.500

1.  创建一个容器来保存您的 PDF

    ```
    <div id="example1"></div> 
    ```

2.  告诉[PDFObject](https://pdfobject.com/)要嵌入哪个 PDF，以及在哪里嵌入

    ```
    <script src="/js/pdfobject.js"></script>
    <script>PDFObject.embed("/pdf/sample-3pp.pdf", "#example1");</script> 
    ```

3.  您可以选择使用 CSS 来指定视觉样式，包括尺寸、边框、边距等。

    ```
    <style>
    .pdfobject-container { height: 500px;}
    .pdfobject { border: 1px solid #666; }
    </style> 
    ```

来源：[https ://pdfobject.com/](https://pdfobject.com/)

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2017-10-20T05:51:14.930

我们的问题是，出于法律原因**，我们不允许将 PDF 临时存储在硬盘上**。此外，在浏览器中将 PDF 显示为预览时，不应重新加载整个页面。

首先我们尝试了 PDF.jS。它在 Firefox 和 Chrome 的查看器中与 Base64 配合使用。但是，对于我们的 PDF，它的速度慢得令人无法接受。IE/Edge 根本不起作用。

因此，我们尝试在 HTML 对象标签中使用 Base64 字符串。这同样不适用于 IE/Edge（可能与 PDF.js 的问题相同）。在 Chrome/Firefox/Safari 中再次没有问题。这就是我们选择混合解决方案的原因。**IE/Edge 我们使用 IFrame，而对于所有其他浏览器，我们使用 object-tag。**

IFrame 解决方案当然也适用于 Chrome 和 co。我们没有为 Chrome 使用这个解决方案的原因是，虽然 PDF 显示正确，但*Chrome 会在预览中单击“下载”时立即向服务器发出新请求*。不再设置所需的隐藏字段*pdfHelperTransferData （用于发送生成 PDF 所需的表单数据），因为 PDF 显示在 IFrame 中。*有关此功能/错误，请参见[Chrome 在下载 PDF 时会发送两个请求（并取消其中一个）](https://stackoverflow.com/questions/32725608/chrome-sends-two-requests-when-downloading-a-pdf-and-cancels-one-of-them)。

现在问题子IE9和IE10仍然存在。对于这些，我们放弃了预览解决方案，只是通过单击预览按钮将文档作为下载发送给用户（而不是预览）。我们已经尝试了很多，但即使我们找到了解决方案，为这小部分用户付出的额外努力也不值得。您可以在此处找到我们的下载解决方案：[使用 IFrame 下载 PDF 而不刷新](https://stackoverflow.com/a/46843185/7302498)。

我们的 Javascript：

```
var transferData = getFormAsJson()
if (isMicrosoftBrowser()) {
        // Case IE / Edge (because doesn't recoginzie Pdf-Base64 use Iframe)
        var form = document.getElementById('pdf-helper-form');
        $("#pdfHelperTransferData").val(transferData);
        form.target = "iframe-pdf-shower";
        form.action = "serverSideFunctonWhichWritesPdfinResponse";
        form.submit();
 } else {
        // Case non IE use Object tag instead of iframe
        $.ajax({
            url: "serverSideFunctonWhichRetrivesPdfAsBase64",
            type: "post",
            data: { downloadHelperTransferData: transferData },
            success: function (result) {
                $("#object-pdf-shower").attr("data", result);
            }
        })
 } 
```

我们的 HTML：

```
<div id="pdf-helper-hidden-container" style="display:none">
   <form id="pdf-helper-form" method="post">
        <input type="hidden" name="pdfHelperTransferData" id="pdfHelperTransferData" />
   </form>
</div>

<div id="pdf-wrapper" class="modal-content">
    <iframe id="iframe-pdf-shower" name="iframe-pdf-shower"></iframe>
    <object id="object-pdf-shower" type="application/pdf"></object>
</div> 
```

要检查 IE/Edge 的浏览器类型，请参见此处：[如何使用 JavaScript 检测 Internet Explorer (IE) 和 Microsoft Edge？](https://stackoverflow.com/a/31757969/7302498)我希望这些发现可以节省其他人的时间。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2010-11-15T23:50:28.953

Scribd 不再要求您将文档托管在他们的服务器上。如果您与他们创建一个帐户，那么您将获得一个发布者 ID。只需几行 JavaScript 代码即可加载存储在您自己的服务器上的 PDF 文件。

有关更多详细信息，请参阅*[开发人员工具](http://www.scribd.com/developers)*。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2018-05-17T09:26:27.893

这就是我对**AXIOS**和 Vue.js 所做的方式：

```
 axios({
            url: `urltoPDFfile.pdf`,
            method: 'GET',
            headers: headers,
            responseType: 'blob'
        })
        .then((response) => {
            this.urlPdf = URL.createObjectURL(response.data)
        })
        .catch((error) => {
            console.log('ERROR   ', error)
        }) 
```

将 urlPDF 动态添加到 HTML：

```
<object width='100%' height='600px' :data='urlPdf' type='application/pdf'></object> 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2017-02-23T20:09:02.067

[PdfToImageServlet](https://github.com/pla1/Misc/blob/master/src/com/pla/misc/PdfToImageServlet.java)使用 ImageMagick 的`convert`命令。

使用示例： `<img src='/webAppDirectory/PdfToImageServlet?pdfFile=/usr/share/cups/data/default-testpage.pdf'>`

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2016-02-03T14:36:59.160

```
<object width="400" height="400" data="helloworld.pdf"></object> 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2022-01-17T11:30:59.657

# 更新 - Adob​​e PDF 嵌入 API

Adobe 发布了完全免费的[Adob​​e PDF Embed API 。](https://www.adobe.io/apis/documentcloud/dcsdk/pdf-embed.html)因为他们自己创建了 PDF 格式，所以他们的 API 可能是最适合的。

*   它提供了可用的最高质量的 PDF 渲染。
*   您可以完全自定义用户体验并选择如何显示 PDF。
*   您还将对 PDF 的使用进行分析，以便了解用户如何与 PDF 交互，包括在页面上花费的时间和搜索。

您所要做的就是创建一个`api_key`并在代码片段中使用它。

#### 显示 PDF`file_url`

这是代码片段的示例，您可以将其添加到 HTML 中，并利用它们的 API 来显示 PDF `file_url`。您必须添加`{ location: { url: "url_of_the_pdf" } }`配置。

```
<div id="adobe-dc-view"></div>

<script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>

<script type="text/javascript">
  document.addEventListener("adobe_dc_view_sdk.ready", function(){
    var adobeDCView = new AdobeDC.View({clientId: "api_key", divId: "adobe-dc-view"});
    adobeDCView.previewFile({
      content: { location: { url: "url_of_the_pdf" } },
      metaData: { fileName: "file_name_to_display" }
    }, {});
  });
</script> 
```

#### 将 PDF 显示为缓冲区

这是代码片段的示例，您可以将其添加到 HTML 中，如果您有缓冲区（例如本地文件），则可以利用它们的 API 来显示 PDF。您必须添加`{ promise: <FILE_PROMISE> }`配置。

```
<div id="adobe-dc-view"></div>

<script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>

<script type="text/javascript">
  document.addEventListener("adobe_dc_view_sdk.ready", function(){
    var adobeDCView = new AdobeDC.View({clientId: "api_key", divId: "adobe-dc-view"});
    adobeDCView.previewFile({
      content: { promise: <FILE_PROMISE> }
      metaData: { fileName: "file_name_to_display" }
    }, {});
  });
</script> 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-11-15T23:53:57.697

要将文件流式传输到浏览器，请参阅 Stack Overflow 问题*[How to stream a PDF file as binary to the browser using .NET 2.0](https://stackoverflow.com/questions/84995/how-to-stream-a-pdf-as-binary-to-the-browser-using-net-20)* - 请注意，有细微的变化，无论您是从文件系统提供文件，这都应该有效或动态生成。

话虽如此，参考的 MSDN 文章对世界的看法相当简单，因此您可能还想阅读*[通过 HTTPS 成功地将 PDF 流式传输到浏览器](http://nilangshah.wordpress.com/2007/05/28/successfully-stream-a-pdf-to-browser-through-https/)*以及您可能需要提供的一些标头。

使用这种方法，iframe 可能是最好的方法。有一个流式传输文件的网络表单，然后将 iframe 放在另一个页面上，并将其`src`属性设置为第一个表单。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2015-05-19T23:32:26.197

您应该考虑的选项之一是**Notable PDF**
它有一个免费计划，除非您计划在 pdf 上进行实时在线协作

将以下内容嵌入`iframe`任何 html 并享受结果：

```
<iframe width='1000' height='800' src='http://bit.ly/1JxrtjR' frameborder='0' allowfullscreen></iframe> 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2019-12-18T21:37:19.777

我不得不使用 React 预览 PDF，所以在尝试了几个库之后，我的最佳解决方案是获取数据并使用它。

```
const pdfBase64 = //fetched from url or generated with jspdf or other library

  <embed
    src={pdfBase64}
    width="500"
    height="375"
    type="application/pdf"
  ></embed> 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2018-07-18T13:10:29.267

1.  构造一个输入 PDF 字节的 blob
2.  使用使用[此跨浏览器解决方法](https://stackoverflow.com/a/47395608/6620171)修补的**iframe**和**PDF.js**

iframe 的 URI 应如下所示：

```
/viewer.html?file=blob:19B579EA-5217-41C6-96E4-5D8DF5A5C70B 
```

现在 FF、Chrome、IE 11 和 Edge 都在通过 URL 中的标准 blob URI 传递的 iframe 中的查看器中显示 PDF。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-09-18T16:03:34.487

如果您不想自己托管 PDF.JS，可以尝试[DocDroid](https://www.docdroid.net)。它类似于 Google Drive PDF 查看器，但允许自定义品牌。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-08-15T18:31:25.447

我发现为我的案例嵌入 pdf 的最佳方法是使用[bootstrap](https://getbootstrap.com/docs/4.0/utilities/embed/)，因为它不仅显示 pdf，而且还填充可用空间，您可以根据需要指定比率。这是我用它制作的一个例子：

```
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">

<div class="embed-responsive embed-responsive-1by1">
  <iframe class="embed-responsive-item" src="http://example.com/the.pdf" type="application/pdf" allowfullscreen></iframe>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2020-08-18T03:35:56.753

由于 URI 限制，在嵌入使用 PDF 编码的 base64 时遇到问题之前，任何超过 2MB 的文件都无法在 Chrome 上正确呈现。

我的解决方案是：

1.  [将 uri 编码转换为 Blob](https://stackoverflow.com/questions/12168909/blob-from-dataurl)：

2.  基于 Blob 生成临时 DOM 字符串。

    `const blob = dataURItoBlob(this.dataUrl);`

    `var temp_url = window.URL.createObjectURL(blob);`

3.  确定要将 iframe 附加到 DOM 的位置：

    `const target = document.querySelector(targetID);`

    `target.innerHTML = `<iframe src='${temp_url}' type="application/pdf"></iframe>`

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-01-02T23:36:59.747

如果您不想自己托管 PDF，或者想使用其他安全功能（例如阻止用户下载 PDF 文件）自定义 PDF 查看器。我推荐使用 CloudPDF。[https://cloudpdf.io](https://cloudpdf.io)

```
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CloudPDF Viewer</title>
  <style>
    body, html {
      height: 100%;
      margin: 0px;
    }
  </style>
</head>
<body style="height: 100%">
  <div id="viewer" style="width: 800px; height: 500px; margin: 80px auto;"></div>
  <script type="text/javascript" src="https://cloudpdf.io/viewer.min.js?version=0.1.0-beta.11"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function(){
      const config = { 
        documentId: 'eee2079d-b0b6-4267-9812-b6b9eadb9c60',
        darkMode: true,
      };
      CloudPDF(config, document.getElementById('viewer')).then((instance) => {

      });
    });
  </script>
 </body>
</html> 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-02-06T05:54:56.590

```
<embed src="data:application/pdf;base64,..."/> 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2020-06-06T21:00:13.320

只需将 iFrame 用于 PDF。

我的 React.js 应用程序有特定需求，尝试了数百万种解决方案，但最终得到了 iFrame :) 祝你好运！

* * *

## 回答 #27

> 赞同：-10
> 
> 时间：2017-10-13T13:44:56.260

我发现这工作得很好，浏览器在 Firefox 中处理它。我没有检查IE...

```
<script>window.location='url'</script> 
```

# java - Java 警报框架

> ID：291817
> 
> 赞同：3
> 
> 时间：2008-11-14T23:57:17.940
> 
> 标签：java, frameworks, alerts

Java中是否有任何“警报”（或通知）框架。

在我的网络应用程序中，我希望我们的用户能够配置他们希望接收哪些（可用警报）以及以哪种（例如通过电子邮件）形式接收。

举个简单的例子，用户选择在他/她的订单已发货时仅通过电子邮件收到提醒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-15T03:02:50.703

Java/J2EE 中默认没有任何内容。但是，实施起来并不需要太多。您的订单处理器和其他处理器可以在 processORder 方法上有侦听器/观察者。这些可以处理电子邮件/其他通知。

您甚至可以从 OrderProcessor 发出一条 jms 消息，其中包含有关特定通知的一些信息，并在使用 JMS 消息后向用户发送电子邮件/其他警报。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-09T05:59:48.873

我们可以使用 JMS 向用户发送通知。JMS 生产者将警报放入队列中，生产者将处理消息并将通知发送给用户。电子邮件/短信和/或存储在数据库中以在用户仪表板中显示消息。

# c - 当我已经返回一个值时，从函数返回错误的最佳方法是什么？

> ID：291828
> 
> 赞同：34
> 
> 时间：2008-11-15T00:04:12.200
> 
> 标签：c, return

我用 C 语言编写了一个函数，将字符串转换为整数并返回整数。当我调用该函数时，我还希望它让我知道字符串是否不是有效数字。过去我在发生此错误时返回 -1，因为我不需要将字符串转换为负数。但是现在我想让它把字符串转换为负数，那么报错的最好方法是什么呢？

如果我不清楚这一点：我不希望这个函数向用户报告错误，我希望它向调用该函数的代码报告错误。（“报告”可能是错误的词……）

这是代码：

```
s32 intval(const char *string) {
    bool negative = false;
    u32 current_char = 0;

    if (string[0] == '-') {
        negative = true;
        current_char = 1;
    }

    s32 num = 0;
    while (string[current_char]) {
        if (string[current_char] < '0' || string[current_char] > '9') {
            // Return an error here.. but how?
        }

        num *= 10;
        num += string[current_char] - '0';
        current_char++;
    }

    if (negative) {
        num = -num;
    }

    return num;
} 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-11-15T00:24:35.047

有几种方法。都有自己的优点和缺点。

*   让函数返回错误代码并传入指向位置的指针以返回结果。这样做的好处是没有结果过载。不好的是你不能直接在表达式中使用函数的真实结果。

    [Evan Teran 提出](https://stackoverflow.com/questions/291828/what-is-the-best-way-to-return-an-error-from-a-function-when-im-already-returni#291830)了一个变体，让调用者传递一个指向成功变量的指针（如果调用者不关心，可以选择为 NULL）并从函数返回实际值。这样做的好处是，当调用者在错误结果中使用默认值时可以直接在表达式中使用该函数，或者知道该函数不会失败。

*   使用特殊的“哨兵”返回值来指示错误，例如负数（如果正常返回值不能为负），`INT_MAX`或者`INT_MIN`如果好的值不能那么极端。有时为了获得更详细的错误信息，需要参考对另一个函数（例如`GetLastError()`）或全局变量的调用（例如`errno`）。当您的返回值没有无效值时，这不起作用，并且通常被许多人认为是错误的形式。

    使用此技术的示例函数是 getc()，如果到达文件末尾或遇到错误，它将返回 EOF。

*   让函数永远不会直接返回错误指示，而是要求调用者查询另一个函数或全局。这类似于 VB 的 " `On Error Goto Next`" 模式的工作原理——而且它几乎被普遍认为是一种糟糕的方式。

*   另一种方法是使用“默认”值。例如，该`atoi()`函数与您的函数具有几乎相同的功能`intval()`，当它无法转换任何字符时将返回 0（它与您的函数不同，它消耗字符进行转换，直到它到达字符串的末尾或不是数字的字符）。

    这里明显的缺点是，判断实际值是否已转换或垃圾是否已传递给`atoi()`.

    我不是这种处理错误的方式的超级粉丝。

当我想到其他选项时，我会更新...

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-15T00:08:54.500

好吧，.NET 在[Int32.TryParse](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)中处理此问题的方式是返回成功/失败，并使用传递引用参数将解析值传回。在 C 中也可以应用同样的方法：

```
int intval(const char *string, s32 *parsed)
{
    *parsed = 0; // So that if we return an error, the value is well-defined

    // Normal code, returning error codes if necessary
    // ...

    *parsed = num;
    return SUCCESS; // Or whatever
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-15T00:06:26.737

一种常见的方法是传递一个指向成功标志的指针，如下所示：

```
int my_function(int *ok) {
    /* whatever */
    if(ok) {
        *ok = success;
    }
    return ret_val;
} 
```

像这样称呼它：

```
int ok;
int ret = my_function(&ok);
if(ok) {
    /* use ret safely here */
} 
```

编辑：这里的示例实现：

```
s32 intval(const char *string, int *ok) {
    bool negative = false;
    u32 current_char = 0;

    if (string[0] == '-') {
        negative = true;
        current_char = 1;
    }

    s32 num = 0;
    while (string[current_char]) {
        if (string[current_char] < '0' || string[current_char] > '9') {
                // Return an error here.. but how?
                if(ok) { *ok = 0; }
        }

        num *= 10;
        num += string[current_char] - '0';
        current_char++;
    }

    if (negative) {
        num = -num;
    }
    if(ok) { *ok = 1; }
    return num;
}

int ok;
s32 val = intval("123a", &ok);
if(ok) {
    printf("conversion successful\n");
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-15T00:08:59.337

os 风格的全局 errno 变量也很流行。使用`errno.h`.

如果 errno 不为零，则说明出现问题。

[这是errno](http://linux.die.net/man/3/errno)的手册页参考。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-17T17:38:51.323

看看标准库是如何处理这个问题的：

```
long  strtol(const  char  * restrict str,  char **restrict endptr, int base); 
```

在这里，调用后 endptr 指向第一个无法解析的字符。如果 endptr == str，则没有字符被转换，这是一个问题。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-15T11:44:57.357

总的来说，我更喜欢 Jon Skeet 提出的方式，即。返回一个关于成功的 bool（int 或 uint）并将结果存储在传递的地址中。但是您的函数与 strtol 非常相似，因此我认为为您的函数使用相同（或相似）的 API 是个好主意。如果您给它起一个类似的名称，例如 my_strtos32，则无需阅读任何文档即可轻松理解该函数的作用。

编辑：由于您的函数明确基于 10，因此 my_strtos32_base10 是一个更好的名称。只要您的功能不是瓶颈，您就可以跳过您的实现。并简单地环绕 strtol：

```
 s32
my_strtos32_base10(const char *nptr, char **endptr)
{
    long ret;
    ret = strtol(nptr, endptr, 10);
    return ret;
} 
```

如果您后来意识到它是一个瓶颈，您仍然可以根据您的需要对其进行优化。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-15T03:43:04.803

您可以返回一个类的实例，其中一个属性是感兴趣的值，另一个属性是某种状态标志。或者，传入结果类的一个实例..

```
Pseudo code
  MyErrStatEnum = (myUndefined, myOK, myNegativeVal, myWhatever)

ResultClass
  Value:Integer;
  ErrorStatus:MyErrStatEnum 
```

示例 1：

```
result := yourMethod(inputString)

if Result.ErrorStatus = myOK then 
   use Result.Value
else
  do something with Result.ErrorStatus

free result 
```

示例 2

```
create result
yourMethod(inputString, result)

if Result.ErrorStatus = myOK then 
   use Result.Value
else
  do something with Result.ErrorStatus

free result 
```

这种方法的好处是您可以随时通过向 Result 类添加其他属性来扩展返回的信息。

为了进一步扩展这个概念，它也适用于具有多个输入参数的方法调用。例如，不是 CallYourMethod(val1, val2, val3, bool1, bool2, string1) 而是有一个属性匹配 val1,val2,val3,bool1,bool2,string1 的类，并将其用作单个输入参数。它清理了方法调用并使代码在将来更容易修改。我相信您已经看到带有多个参数的方法调用更难使用/调试。（7 绝对是我想说的最多。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-07-13T21:51:47.187

> 当我已经返回一个值时，从函数返回错误的最佳方法是什么？

对各种答案的一些额外想法。

* * *

**返回一个结构**

代码可以返回一个值和一个错误代码。一个问题是类型的扩散。

```
typedef struct {
  int value;
  int error;
} int_error;

int_error intval(const char *string);

...

int_error = intval(some_string);
if (int_error.error) {
  Process_Error();
}

int only_care_about_value = intval(some_string).value;
int only_care_about_error = intval(some_string).error; 
```

**非数字和`NULL`**

当函数返回类型提供时使用特殊值。
C 不需要非数字，但它无处不在。

```
#include <math.h>
#include <stddef.h>

double y = foo(x);
if (isnan(y)) {
  Process_Error();
}

void *ptr = bar(x);
if (ptr == NULL) {
  Process_Error();
} 
```

**`_Generic`/函数重载**

`error_t foo(&dest, x)`考虑到vs.的优缺点`dest_t foo(x, &error)`，

通过级联使用`_Generic`或函数重载作为编译器扩展，选择 2 种或更多类型，根据调用的参数而不是返回值来区分调用的底层函数是有意义的。返回普通类型，错误状态。

示例：将`error_t narrow(destination_t *, source_t)`一种类型的值转换为更窄类型的函数，例如`long long`并`short`测试源*值*是否在目标*类型*的范围内。

```
long long ll = ...; 
int i;
char ch; 
error = narrow(&i, ll);
...
error = narrow(&ch, i); 
```

# parsing - Vb6：分隔制表符分隔的文本

> ID：291829
> 
> 赞同：4
> 
> 时间：2008-11-15T00:05:29.907
> 
> 标签：parsing, vb6, csv

我有一个文件，有几千行和几列，用制表符分隔我想做的是逐个循环，将列放入数组中，以便我可以将它们单独放在另一个应用程序中，然后移至下一行. 不幸的是，我做到了这一点：

```
Open mytextfile.txt For Input As #FileHandle
 Do While Not EOF(FileHandle)
 Line Input #FileHandle, IndividualLine
 StringToBreakup = IndividualLine
Loop 
```

那么我将如何将单个行分解为一个数组

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-15T00:23:16.907

```
Dim str() as String

Open mytextfile.txt For Input As #FileHandle
    Do While Not EOF(FileHandle)
    Line Input #FileHandle, IndividualLine
    str = Split(IndividualLine, vbTab)
    Debug.Print str(0)  'First array element
Loop 
```

澄清一下：我会避免使用变体并使用 vbTab。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-15T00:11:36.103

使用拆分命令

```
Dim StringArray as Variant

Open mytextfile.txt For Input As #FileHandle
 Do While Not EOF(FileHandle)
 Line Input #FileHandle, IndividualLine
 StringToBreakup = IndividualLine

 StringArray = Split(StringToBreakup, CHR(9)) 

 Process array here...

Loop 
```

# google-analytics - 哪些数据会发送到 Google Analytics？

> ID：291833
> 
> 赞同：11
> 
> 时间：2008-11-15T00:08:56.653
> 
> 标签：google-analytics

有没有人找到有关将哪些数据添加到网站时传输到 Google Analytics 的任何文档或研究。我想知道的主要事情是发布数据，但是发送的确切内容的详细信息会很有用。

我正在考虑在拥有大量私人数据的网站上实施它。我想知道谷歌将捕获哪些数据（如果有的话）。（这些网站只能登录。）我需要证明，以便我可以提供给用户。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-15T00:13:44.023

官方信息可以在[这里找到](https://developers.google.com/analytics/devguides/collection/gajs/)

> 您可以在 Google Analytics 报告中获得的访问者跟踪信息取决于您在网站页面中包含的 Javascript 代码，称为 Google Analytics 跟踪代码 (GATC)。GATC 的初始版本使用了一个名为 urchin.js 的 Javascript 文件。

该脚本随后会在[该博客](http://www.johnycow.com/what-is-urchin/)中详细讨论，Google Analytics 帮助组也可以提供[一些详细信息](http://groups.google.com/group/analytics-help-troubleshoot/browse_thread/thread/b625eb39759bee6c)。

[此处列出了](http://blog.ndrix.com/2007/07/how-google-analytics-works.html)javascript 收集的更详细的列表。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-06-17T00:57:02.620

我在这里找到了官方的谷歌文档：

[http://code.google.com/apis/analytics/docs/tracking/gaTrackingTroubleshooting.html](http://code.google.com/apis/analytics/docs/tracking/gaTrackingTroubleshooting.html)

我还发现这个讨论非常有用：

[http://www.google.com/support/forum/p/Google%20Analytics/thread?tid=5f11a529100f1d47&hl=en](http://www.google.com/support/forum/p/Google%20Analytics/thread?tid=5f11a529100f1d47&hl=en)

帮我找出 WTF **utmcc**实际上 DID

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-22T21:43:01.593

所有信息都通过 URL 和 post 参数传递：

缓存页面

1

utmac

UA-745459-1

utmcc

__utma=52631473.656111131.1231670535.1235325662.1235336522.264;+__utmz=52631473.1235287959.257.8.utmccn =(有机)|utmcsr=google|utmctr=site:domain.com|utmcmd=organic;

utmcs

windows-1255

utmdt
页面标题

utmfl

10.0 r12

隐藏

1524858795

乌特姆

www.domain.com

乌特梅

1

utmn

1273285258

utmp

/摇晃/？

utmr

0

utmsc

32 位

utmsr

1280x800

utmul

恩-我们

utmwv

1.3

主持人

www.google-analytics.com

用户代理

Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.0.6) Gecko/2009011913 Firefox/3.0.6 (.NET CLR 3.5.30729)

接受

图片/png,图片/ *;q=0.8,* /*;q=0.5

接受语言

en-us,en;q=0.5

接受编码

gzip，放气

接受字符集

ISO-8859-1,utf-8;q=0.7,*;q=0.7

活着

300

联系

活着

推荐人

[http://www.hadash-hot.co.il/shakeit/?&page=1](http://www.hadash-hot.co.il/shakeit/?&page=1)

编译指示

无缓存

缓存控制

无缓存

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-15T00:15:05.223

查看功能 urchinTracker 下的[http://www.google-analytics.com/urchin.js](http://www.google-analytics.com/urchin.js)，您会看到发生了什么:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-12T18:08:33.917

我建议尝试 Google Chrome 扩展：[https ://chrome.google.com/extensions/detail/jnkmfdileelhofjcijamephohjechhna](https://chrome.google.com/extensions/detail/jnkmfdileelhofjcijamephohjechhna)

此扩展将为发送到谷歌分析的所有数据提供调试信息。当您添加新的分析功能并希望验证它们是否按照您期望的方式工作时，它特别有用。

# jquery - jQuery 是否对“选择器”进行任何类型的缓存？

> ID：291841
> 
> 赞同：61
> 
> 时间：2008-11-15T00:13:53.523
> 
> 标签：jquery, jquery-selectors

例如，第一段代码是否会执行两次完整搜索，或者如果没有发生 DOM 更改，它是否足够聪明地缓存结果？

```
if ($("#navbar .heading").text() > "") {
  $("#navbar .heading").hide();
} 
```

和

```
var $heading = $("#navbar .heading");

if ($heading.text() > "") {
  $heading.hide();
} 
```

如果选择器更复杂，我可以想象这是一个不平凡的打击。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-15T04:15:19.677

# 始终缓存您的选择！

用同一个选择器不断地`$( selector )`一遍又一遍地调用是很浪费的。

或者几乎总是......您通常应该将 jQuery 对象的缓存副本保存在局部变量中，除非您希望它已经更改或者您只需要它一次。

```
var element = $("#someid");

element.click( function() {

  // no need to re-select #someid since we cached it
  element.hide(); 
}); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-15T00:57:52.267

jQuery 没有，但有可能在表达式中分配给变量，然后在后续表达式中重新使用这些变量。所以，缓存你的例子......

```
if ((cached = $("#navbar .heading")).text() > "") {
  cached.hide();
} 
```

缺点是它使代码有点笨拙且难以理解。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-16T11:26:17.427

这与其说是“可以吗？”，而在于“可以吗？”，不，它不能 - 自上次运行查询以来，您可能已经向 DOM 添加了额外的匹配元素。这会使缓存的结果过时，并且 jQuery 除了再次运行查询之外没有（明智的）方法可以告诉。

例如：

```
$('#someid .someclass').show();
$('#someid').append('<div class="someclass">New!</div>');
$('#someid .someclass').hide(); 
```

在这个例子中，如果有任何查询缓存，新添加的元素不会被隐藏——它只会隐藏之前显示的元素。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2011-10-14T13:24:21.547

我刚刚做了一个解决这个问题的方法：

```
var cache = {};

function $$(s)
{
    if (cache.hasOwnProperty(s))
    {
        return $(cache[s]);
    }

    var e = $(s);

    if(e.length > 0)
    {
        return $(cache[s] = e);
    }

} 
```

它的工作原理是这样的：

```
$$('div').each(function(){ ... }); 
```

据我所知，结果是准确的，基于这个简单的检查：

```
console.log($$('#forms .col.r')[0] === $('#forms .col.r')[0]); 
```

注意，它会破坏您的 MooTools 实现或任何其他使用`$$`符号的库。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-11-15T00:25:20.333

我不认为它确实如此（尽管我现在不想通过阅读三千五行 JavaScript 来确定答案）。

但是，您所做的不需要多个选择器 - 这应该有效：

```
$("#navbar .heading:not(:empty)").hide(); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-07-20T17:10:49.530

与您的 $$ 方法类似，我创建了一个函数（同名），它使用记忆模式来保持全局清洁，并且还考虑了第二个上下文参数......比如 $$(".class", "#context" ）。如果您使用返回 $$ 后发生的链式函数 find()，则需要这样做；因此它不会被单独缓存，除非您先缓存上下文对象。我还在末尾添加了布尔参数（第二个或第三个参数取决于您是否使用上下文）以强制它返回到 DOM。

代码：

```
function $$(a, b, c){
    var key;
    if(c){
        key = a + "," + b;
        if(!this.hasOwnProperty(key) || c){
            this[key] = $(a, b);
        }        
    }
    else if(b){
        if(typeof b == "boolean"){  
            key = a;  
            if(!this.hasOwnProperty(key) || b){
                this[key] = $(a);
            }
        }
        else{
            key = a + "," + b;
            this[key] = $(a, b);   
        }            
    }
    else{
        key = a;
        if(!this.hasOwnProperty(key)){
            this[key] = $(a);
        } 
    }
    return this[key]; 
} 
```

用法：

```
<div class="test">a</div>
<div id="container">
    <div class="test">b</div>
</div>​

<script>
  $$(".test").append("1"); //default behavior
  $$(".test", "#container").append("2"); //contextual 
  $$(".test", "#container").append("3"); //uses cache
  $$(".test", "#container", true).append("4"); //forces back to the dome
​
</script> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-15T00:23:29.887

我不相信 jquery 对选择器进行任何缓存，而是依靠下面的 xpath/javascript 来处理它。话虽如此，您可以在选择器中使用许多优化。以下是一些涵盖一些基础知识的文章：

*   [优化 jQuery 选择器性能](http://web.archive.org/web/20090127012524/http://www.thegrubbsian.com/2008/10/optimize-jquery-selector-performance.html)
*   [选择器的性能分析](http://www.componenthouse.com/article-19)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-08-23T14:00:56.357

这 $$() 工作正常 - 在任何情况下都应该返回一个有效的 jQuery 对象，并且永远不会未定义。

小心它！它应该/不能与动态变化的选择器一起使用，例如。通过附加与选择器匹配的节点或使用伪类。

```
function $$(selector) {
  return cache.hasOwnProperty(selector) 
    ? cache[selector] 
    : cache[selector] = $(selector); 
}; 
```

当然，$$ 可以是任何函数名称。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-03-20T10:12:54.343

John Resig 在 2008 年 jQuery Camp 的 Jquery Internals 演讲中确实提到了一些浏览器支持在 DOM 被修改时触发的事件。对于这种情况，可以缓存 Selctor 结果。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-10-30T10:57:22.323

有一个很好的插件叫做[jQache](http://jqache.com/)可以做到这一点。安装插件后，我通常会这样做：

> 变量 $$ = $.q;

然后就

> $$("#navbar .heading").hide();

所有这一切中最好的部分是，如果您正在做动态的事情，您还可以在需要时刷新缓存，例如：

> $$("#navbar .heading", true).hide(); // 刷新缓存并隐藏新的（新发现的）#navbar .heading

和

> $$.clear(); // 完全清除缓存

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-07-02T09:16:22.920

jsPerf 今天停产了，但是[这篇文章](http://www.stoimen.com/blog/2010/06/19/speed-up-the-jquery-code-selectors-cache/)表明缓存 jQuery 选择器带来的性能提升是微乎其微的。

![在此处输入图像描述](https://i.stack.imgur.com/oVkXl.png)

这可能只是浏览器缓存。测试的选择器只有一个 id。应该对更复杂的选择器和不同的页面结构进行更多的测试......

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-12-03T23:14:52.780

[jQuery Sizzle](http://blog.jquery.com/2012/07/04/the-new-sizzle/)会自动缓存最近从选择器创建的函数，以便查找 DOM 元素。但是，元素本身不会被缓存。

> 此外，Sizzle 维护最近编译的函数的缓存。缓存有一个最大大小（可以调整但有一个默认值），因此在使用许多不同的选择器时不会出现内存不足的错误。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-05-24T17:25:06.730

$.selectorCache() 很有用：

[https://gist.github.com/jduhls/ceb7c5fdf2ae1fd2d613e1bab160e296](https://gist.github.com/jduhls/ceb7c5fdf2ae1fd2d613e1bab160e296)

要点嵌入：

```
<script src="https://gist.github.com/jduhls/ceb7c5fdf2ae1fd2d613e1bab160e296.js"></script>
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-05-25T05:47:47.733

检查这是否有帮助[https://plugins.jquery.com/cache/](https://plugins.jquery.com/cache/)

作为我们常规项目的一部分遇到这个

# c# - c# 性能：类型比较与字符串比较

> ID：291844
> 
> 赞同：5
> 
> 时间：2008-11-15T00:15:53.660
> 
> 标签：c#, .net, performance, string-comparison

哪个更快？这个：

```
bool isEqual = (MyObject1 is MyObject2) 
```

或这个：

```
bool isEqual = ("blah" == "blah1") 
```

找出哪个更快会很有帮助。显然，如果您像程序员经常做的那样将 .ToUpper() 应用于字符串比较的每一侧，则需要重新分配内存，这会影响性能。但是，如果 .ToUpper() 不符合上述示例中的等式呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-15T00:50:40.250

我在这里有点困惑。

正如其他答案所指出的，您正在比较苹果和橙子。`::rimshot::`

如果要确定对象是否属于某种类型，请使用`is`运算符。

如果您想比较字符串，请使用`==`运算符（或其他适当的比较方法，如果您需要一些花哨的东西，例如不区分大小写的比较）。

一项操作与另一项操作相比有多快（没有双关语）似乎并不重要。

* * *

仔细阅读后，我认为您想将字符串比较的速度与引用比较的速度（System.Object 基类型中使用的比较类型）进行比较。

如果是这样，那么答案是引用比较永远不会比任何其他字符串比较慢。.NET 中的引用比较与比较 C 中的指针非常相似 - 尽可能快。

但是，如果字符串变量`s`具有 value `"I'm a string"`，但以下比较失败，您会有什么感觉：

```
if (((object) s) == ((object) "I'm a string")) { ... } 
```

如果您只是比较引用，则可能会发生这种情况，具体取决于`s`创建值的方式。如果它最终没有被实习，它不会有与文字字符串相同的引用，所以比较会失败。因此，您可能会有更快的比较，但并不总是有效。这似乎是一个糟糕的优化。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-15T00:38:45.253

根据Maximizing .NET Performance一书，调用

```
bool isEqual = String.Equals("test", "test"); 
```

在性能上与

```
bool isEqual = ("test" == "test"); 
```

通话

```
bool isEqual = "test".Equals("test"); 
```

理论上比调用静态 String.Equals 方法慢，但我认为您需要比较几百万个字符串才能实际检测到速度差异。

我给你的建议是这样的；不要担心哪种字符串比较方法更慢或更快。在正常的应用程序中，您永远不会注意到差异。你应该使用你认为最易读的方式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-15T00:22:54.490

第一个用于比较类型而不是值。如果要将字符串与不敏感的大小写进行比较，可以使用：

```
string toto = "toto";
string tata = "tata";

bool isEqual = string.Compare(toto, tata, StringComparison.InvariantCultureIgnoreCase) == 0;    

Console.WriteLine(isEqual); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T01:19:38.503

我假设比较第一个示例中的对象将尽可能快，因为它只是检查两个对象是否指向内存中的相同地址。

正如已经多次提到的，也可以比较字符串上的地址，但是如果两个字符串是从不同的来源分配的，这不一定有效。

最后，尽可能尝试根据类型比较对象通常是一种很好的形式。它通常是最具体的识别方法。如果您的对象需要用它们在内存中的地址以外的东西来表示，则可以使用其他属性作为标识符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-15T00:20:38.800

你告诉我怎么样？:)

从[这个 Coding Horror post](http://www.codinghorror.com/blog/archives/001178.html)获取代码，并插入您的代码以代替他的算法进行测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-15T00:43:11.950

用“==”操作符比较字符串是比较字符串的*内容*和字符串对象的*引用*。比较对象会调用对象的“Equals”方法来判断它们是否相等。Equals 的默认实现是进行引用比较，如果两个对象引用是*同一个*物理对象，则返回 True。这可能比字符串比较快，但取决于被比较对象的类型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-28T10:45:11.247

如果我理解这个问题并且您*真的*想将引用相等性与普通的“比较内容”进行比较：构建一个测试用例并调用[object.ReferenceEquals](http://msdn.microsoft.com/en-us/library/system.object.referenceequals.aspx)与 a == b 进行比较。

注意：您*必须*了解差异是什么，并且在大多数情况下您可能无法使用参考比较。如果你确定这是你想要的，它*可能*会快一点。您必须自己尝试并评估这是否值得麻烦。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-12-31T19:10:57.970

我觉得这些答案中的任何一个都不能解决实际问题。假设此示例中的字符串是类型的名称，我们试图查看比较类型名称或类型以确定它是什么是否更快。

我把它放在一起，令我惊讶的是，检查类型名称字符串比我运行的每个测试中的类型快 10%。我故意使用最简单的字符串和类来看看是否有可能更快，结果证明这是可能的。不确定来自重度继承类的更复杂的字符串和类型比较。这当然是一个微操作，可能会在我想的语言演变的某个时刻发生变化。

就我而言，我正在考虑一个基于此名称切换的值转换器，但它也可以切换类型，因为每种类型都指定一个唯一的类型名称。值转换器会根据呈现的项目类型计算出要显示的字体真棒图标。

```
using System;
using System.Diagnostics;
using System.Linq;

namespace ConsoleApp1
{
    public sealed class A
    {
        public const string TypeName = "A";
    }

    public sealed class B
    {
        public const string TypeName = "B";
    }

    public sealed class C
    {
        public const string TypeName = "C";
    }

    class Program
    {
        static void Main(string[] args)
        {
            var testlist = Enumerable.Repeat(0, 100).SelectMany(x => new object[] { new A(), new B(), new C() }).ToList();

            int count = 0;

            void checkTypeName()
            {
                foreach (var item in testlist)
                {
                    switch (item)
                    {
                        case A.TypeName:
                            count++;
                            break;
                        case B.TypeName:
                            count++;
                            break;
                        case C.TypeName:
                            count++;
                            break;
                        default:
                            break;
                    }
                }
            }

            void checkType()
            {
                foreach (var item in testlist)
                {
                    switch (item)
                    {
                        case A _:
                            count++;
                            break;
                        case B _:
                            count++;
                            break;
                        case C _:
                            count++;
                            break;
                        default:
                            break;
                    }
                }
            }

            Stopwatch sw = Stopwatch.StartNew();
            for (int i = 0; i < 100000; i++)
            {
                checkTypeName();
            }
            sw.Stop();
            Console.WriteLine(sw.Elapsed);
            sw.Restart();
            for (int i = 0; i < 100000; i++)
            {
                checkType();
            }
            sw.Stop();
            Console.WriteLine(sw.Elapsed);
        }
    }
} 
```

# java - 简单地使用 Java 中的 Web 服务

> ID：291847
> 
> 赞同：36
> 
> 时间：2008-11-15T00:18:00.473
> 
> 标签：java, web-services, soap

我有一个非常简单的 SOAP Web 服务，我需要从 Java 客户端使用它。在不使用任何第三方库的情况下完成此任务的最简单方法是什么？要求是在每次调用 ws 之前从 web.xml 读取主机和端口。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-15T07:24:20.737

我可以向您推荐 CXF 库。使用它，您将有几个调用 Web 服务的选项：

1.  使用[动态代理](http://cxf.apache.org/docs/dynamic-clients.html)进行调用（不需要使用 wsdl2java 制作 Java 存根）。

    ```
    DynamicClientFactory dcf = DynamicClientFactory.newInstance();
    Client client = dcf.createClient("http://admin:password@localhost:8080"+
                                     "/services/MyService?wsdl");
    Object[] a = client.invoke("test", "");
    System.out.println(a); 
    ```

2.  使用从 WSDL 生成的 Java 存根，使用 wsdl2java。

3.  如果您的服务器是使用 CXF 创建的，您可以直接重用您的界面代码（而不是在从您的界面创建的 WSDL 上使用 wsdl2java！）

对于 #2 和 #3，以下代码举例说明了 CXF 的用法：

```
JaxWsProxyFactoryBean factory = new JaxWsProxyFactoryBean();
factory.setAddress("http://admin:password@localhost:8080/services/MyService");
factory.setServiceClass(ITest.class);
ITest client = (ITest) factory.create();
client.test(); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-11-15T02:58:44.237

根据您使用的 JAVA 版本，其中内置了一些 JAX-WS。JDK 6 具有 Java 的 JAX-WS 标准实现，您可以直接使用它。

请参阅以下内容：

*   [JAX-WS 2.1 和 JAXB 2.1 在 JDK 6 Update 4 版本中可用](http://weblogs.java.net/blog/ramapulavarthi/archive/2008/01/jaxws_21_and_ja.html)

*   [JAX-WS Web 服务入门](http://www.netbeans.org/kb/60/websvc/jax-ws.html)（使用 JDK 内置 JAX-WS 部署和使用 Web 服务的教程）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-15T01:20:26.743

如果您可以放宽您的“无 3rd 方库”要求，并且您有一个用于 Web 服务的 WSDL，那么 Axis 会非常容易。只需使用 wsdl2java 编译 WSDL，您就可以使用生成的 Java 类来使用 Web 服务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-15T00:48:35.200

不使用任何第三方库？真正了解 SOAP 标准并学会爱上 SAX。

如果您不喜欢 SAX，那么请放宽您对无第三方库的要求并改用 StAX（与 woodstox）。

这种方法可能是“最简单的”（考虑到无第三方库的要求），但我认为这并不*容易*。

# winapi - 进程亲和性

> ID：291848
> 
> 赞同：1
> 
> 时间：2008-11-15T00:18:14.483
> 
> 标签：winapi

是否可以通过 win32API (python) 或通过命令行选项以编程方式设置进程的处理器亲和性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-15T00:23:26.937

给定一个进程句柄，您可以调用[SetProcessAffinityMask](http://msdn.microsoft.com/en-us/library/ms686223(VS.85).aspx) Win32 API 函数来设置另一个进程的处理器关联。请注意，所有常见的安全限制都有效，也就是说，您可能只能更改您拥有的进程的进程亲缘关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-15T00:20:10.517

在 C/C++ 中，您可以使用[SetThreadIdealProcessor()](http://msdn.microsoft.com/en-us/library/ms686253(VS.85).aspx)。我不知道这是否可以在 python 中访问。

```
DWORD processorId = 0;
SetThreadIdealProcessor(GetCurrentThread(),processorId); 
```

# vb6 - 如何使用 VB6 获取目录中所有文件名的列表？

> ID：291849
> 
> 赞同：8
> 
> 时间：2008-11-15T00:19:48.973
> 
> 标签：vb6, file, directory

VB6中循环遍历指定文件夹目录中的所有文件并获取它们的名称的最简单方法是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-15T00:38:43.007

```
sFilename = Dir(sFoldername)

Do While sFilename > ""

  debug.print sFilename 
  sFilename = Dir()

Loop 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-20T23:51:40.110

```
Dim fso As New FileSystemObject
Dim fld As Folder
Dim fil As File
Set fld = fso.GetFolder("C:\My Folder")
For Each fil In fld.Files
  Debug.Print fil.Name
Next
Set fil = Nothing
Set fld = Nothing
Set fso = Nothing 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-17T03:23:13.250

DJ 的[解决方案](https://stackoverflow.com/questions/291849/how-do-i-get-list-of-all-filenames-in-a-directory-using-vb6#291882)简单而有效，如果您需要 FileSystemObject 可以提供的更多功能（需要参考 Microsoft Scripting Runtime），只需放弃另一个解决方案。

```
Dim fso As New FileSystemObject
Dim fil As File

For Each fil In fso.GetFolder("C:\").Files
  Debug.Print fil.Name
Next 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-06-22T03:53:51.187

'对于 VB6 非常棘手：'只需获取保存在磁盘/项目目录中的所有项目 .frm 文件的位置

Dim CountVal As Integer CountVal = 0 cbo.Clear

```
sFilename = Dir(App.Path & "\Forms\")
Do While sFilename > ""
  If (Right(sFilename, 4) = ".frm") Then
  cbo.List(CountVal) = Left(sFilename, (Len(sFilename) - 4))
  CountVal = CountVal + 1
  End If

   sFilename = Dir()
Loop 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-05T11:47:02.763

创建名称 = browseButton 的按钮 创建名称 = List1 的文件列表框

双击设计中的按钮

和代码应该是这样的

```
Private Sub browseButton_Click()

Dim path  As String
path = "C:\My Folder"

List1.path() = path
List1.Pattern = "*.txt"
End Sub 
```

完成现在运行它

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-09T02:37:21.830

您可以使用以下演示代码，

```
Dim fso As New FileSystemObject
Dim fld As Folder
Dim file As File
Set fld = fso.GetFolder("C:\vishnu")
For Each file In fld.Files
  msgbox file.Name
Next 
```

# orm - 为什么 ORM 被认为是好的但“select *”被认为是坏的？

> ID：291853
> 
> 赞同：36
> 
> 时间：2008-11-15T00:21:03.557
> 
> 标签：orm

ORM 通常不涉及执行 select * 之类的操作吗？

如果我有一个表 MyThing，其中包含 A、B、C、D 等列，那么通常会有一个对象 MyThing，其属性为 A、B、C、D。

如果该对象没有被如下所示的 select 语句完全实例化，只获取 A、B 而不是 C、D，那将是邪恶的：

select A, B from MyThing /* 不要得到 C 和 D，因为我们不需要它们 */

但总是这样做也是邪恶的：

select A, B, C, D /* 获取所有列，这样我们就可以完全实例化 MyThing 对象 */

ORM 是否假设数据库访问如此之快，现在您不必担心它，因此您总是可以获取所有列？

或者，您是否有不同的 MyThing 对象，一个对应于可能碰巧出现在 select 语句中的每个列组合？

**编辑：在您回答问题之前，请阅读 Nicholas Piasecki 和 Bill Karwin 的回答。我想我问的问题很糟糕，因为很多人误解了它，但尼古拉斯 100% 理解它。和他一样，我对其他答案很感兴趣。**

* * *

编辑#2：与此问题相关的链接：

[为什么我们需要实体对象？](https://stackoverflow.com/questions/18655/why-do-we-need-entity-objects)

[http://blogs.tedneward.com/2006/06/26/The+Vietnam+Of+Computer+Science.aspx](http://blogs.tedneward.com/2006/06/26/The+Vietnam+Of+Computer+Science.aspx)，尤其是“部分对象问题和加载时间悖论”部分

[http://groups.google.com/group/comp.object/browse_thread/thread/853fca22ded31c00/99f41d57f195f48b](http://groups.google.com/group/comp.object/browse_thread/thread/853fca22ded31c00/99f41d57f195f48b)？

[http://www.martinfowler.com/bliki/AnemicDomainModel.html](http://www.martinfowler.com/bliki/AnemicDomainModel.html)

[http://database-programmer.blogspot.com/2008/06/why-i-do-not-use-orm.html](http://database-programmer.blogspot.com/2008/06/why-i-do-not-use-orm.html)

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-11-15T00:39:51.677

以我有限的经验，事情正如你所描述的那样——这是一个混乱的情况，通常的逃避“这取决于”的答案适用。

我工作的在线商店就是一个很好的例子。它有一个`Brand`对象，在网站的主页上，商店销售的所有品牌都列在左侧。要显示这个品牌菜单，网站需要的只是整数`BrandId`和字符串`BrandName`。但是该`Brand`对象包含一大堆其他属性，最值得注意的`Description`是可以包含大量关于`Brand`. 没有两种方法，加载所有关于品牌的额外信息只是为了在无序列表中吐出它的名字是（1）可测量且显着缓慢，通常是因为大文本字段和（2）当它出现时非常低效内存使用，建立大字符串，甚至在扔掉它们之前都没有看它们。

许多 ORM 提供的一个选项是延迟加载属性。所以我们可以有一个`Brand`对象返回给我们，但是这个耗时且浪费内存的`Description`字段直到我们尝试调用它的`get`访问器。此时，代理对象将拦截我们的调用并及时从数据库中提取描述。这有时足够好，但已经烧伤了我足够多的时间，我个人不推荐它：

*   很容易忘记该属性是延迟加载的，只需编写一个 foreach 循环就会引入 SELECT N+1 问题。谁知道当 LINQ 参与其中时会发生什么。
*   如果由于传输混乱或网络中断而导致即时数据库调用失败怎么办？我几乎可以保证，任何代码所做的事情都是无害的，因为`string desc = brand.Description`没想到​​会简单地调用 toss a `DataAccessException`. 现在你刚刚以一种令人讨厌和意想不到的方式坠毁。（是的，我已经看到我的应用程序因此而严重失败。学习了艰难的方式！）

所以我最终所做的是，在需要性能或容易出现数据库死锁的场景中，我创建了一个单独的接口，网站或任何其他程序都可以调用该接口来访问已经查询过的特定数据块计划仔细审查。架构最终看起来像这样（原谅 ASCII 艺术）：

```
网站：控制器类
                     |
                     |----------------------------------+
                     | |
应用服务器：IDocumentService IOrderService、IInventoryService 等
                  （数组、数据集）（常规 OO 对象，如 Brand）
                     | |
                     | |
                     | |
数据层：（原始 ADO.NET 返回数组，（像 NHibernate 一样的“全奶油” ORM）
                   数据集，简单的类）

```

我曾经认为这是作弊，颠覆了OO对象模型。但在实际意义上，只要你做这个显示数据的快捷方式，我认为就可以了。更新/插入以及您仍然通过完全水合、ORM 填充的域模型进行的操作，与显示特定数据子集相比，这种情况发生的频率要低得多（在我的大多数情况下）。像 NHibernate 这样的 ORM 可以让你进行预测，但到那时我还没有看到 ORM 的意义。无论如何，这可能是一个存储过程，编写 ADO.NET 需要两秒钟。

这只是我的两分钱。我期待着阅读其他一些回复。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-11-15T00:46:38.620

人们使用 ORM 是为了提高开发效率，而不是为了优化运行时性能。这取决于项目是最大化开发效率还是运行时效率更重要。

在实践中，可以使用 ORM 来获得最大的生产力，然后在完成后对应用程序进行分析以识别瓶颈。仅在您获得最大收益的情况下，才用自定义 SQL 查询替换 ORM 代码。

`SELECT *`如果您通常需要表中的所有列，这还不错。我们不能概括通配符总是好的或总是坏的。

**编辑：**回复：doofledorfer 的评论...就个人而言，我总是明确地命名查询中的列；我从不在生产代码中使用通配符（尽管我在进行临时查询时使用它）。最初的问题是关于 ORM 的——事实上，ORM 框架`SELECT *`统一发布一个并填充相应对象模型中的所有字段的情况并不少见。

执行`SELECT *`查询不一定表明您需要所有这些列，也不一定意味着您忽略了代码。可能是 ORM 框架正在生成 SQL 查询以确保所有字段都可用*，以备*您需要时使用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-15T00:54:53.597

[Linq to Sql或](http://msdn.microsoft.com/en-us/library/bb425822.aspx)[IQueryable](http://msdn.microsoft.com/en-us/library/system.linq.iqueryable.aspx)的任何实现都使用最终使您能够控制所选数据的语法。查询的定义也是其结果集的定义。

这通过从 ORM 中删除数据形状职责巧妙地避免了该`select *`问题。

例如，要选择所有列：

```
from c in data.Customers
select c 
```

要选择子集：

```
from c in data.Customers
select new
{
  c.FirstName,
  c.LastName,
  c.Email
} 
```

要选择组合：

```
from c in data.Customers
join o in data.Orders on c.CustomerId equals o.CustomerId
select new
{
  Name = c.FirstName + " " + c.LastName,
  Email = c.Email,
  Date = o.DateSubmitted
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-15T00:29:27.207

我不知道你为什么想要一个部分水合的物体。给定具有名称、地址、ID 属性的客户类。我希望他们都创建一个完全填充的 Customer 对象。

通过大多数 ORM 访问时，可以延迟加载名为 Orders 的客户列表。无论如何，NHibernate 都允许您对其他对象进行投影。因此，如果您说的是一个简单的客户列表，其中显示了 ID 和名称，您可以创建一个 CustomerListDisplay 类型的对象并将您的 HQL 查询投影到该对象集中，并且只从数据库中获取您需要的列。

朋友不要让朋友过早优化。充分水合您的对象，延迟加载它的关联。然后分析您的应用程序以查找问题并优化问题区域。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-15T00:38:10.073

有两个不同的问题需要考虑。

首先，使用 ORM 表和对象具有完全不同的“形状”是很常见的，这就是为什么许多 ORM 工具支持非常复杂的映射的原因之一。

一个很好的例子是当一个表被部分非规范化时，列包含冗余信息（通常，这样做是为了提高查询或报告性能）。发生这种情况时，ORM 只请求它需要的列比将所有额外的列带回并忽略更有效。

为什么“Select *”是邪恶的问题是分开的，答案分为两半。

当执行“select *”时，数据库服务器没有义务以任何特定的顺序返回列，实际上每次都可以合理地以不同的顺序返回列，尽管几乎没有数据库这样做。

问题是，当典型的开发人员观察到返回的列似乎是一致的顺序时，假设列将**始终**按照该顺序，然后您的代码做出了无根据的假设，只是等待失败。更糟糕的是，这种失败可能不是致命的，但可能只涉及使用*Year of Birth*代替*Account Balance*。

“Select *”的另一个问题与表所有权有关——在许多大公司中，DBA 控制模式，并根据主要系统的要求进行更改。如果您的工具正在执行“select *”，那么您只会获得当前列 - 如果 DBA 删除了您需要的冗余列，您不会收到任何错误，并且您的代码可能会出现错误，从而导致各种损坏。通过明确请求您需要的字段，您可以确保您的系统会中断而不是处理错误的信息。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-15T00:28:39.343

甚至 ORM 也需要通过使用延迟加载等来避免 SELECT * 有效。

是的，如果您不使用所有数据，则 SELECT * 通常是一个坏主意。

那么，您是否有不同类型的 MyThing 对象，每列组合一个？– Corey Trager（11 月 15 日 0:37）

不，我有用于查找和大量集合之类的只读摘要对象（仅包含重要信息），并根据需要将它们转换为完全水合的对象。– Cade Roux（11 月 15 日 1:22）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-15T01:36:02.967

您描述的案例是 ORM 不是灵丹妙药的一个很好的例子。数据库主要通过 SQL 提供对其数据的灵活、基于需求的访问。作为开发人员，我可以根据需要轻松简单地获取所有数据（SELECT *）或部分数据（SELECT COL1、COL2）。接管该项目的任何其他开发人员都将很容易理解我执行此操作的机制。

为了从 ORM 中获得同样的灵活性，需要做更多的工作（无论是您还是 ORM 开发人员），才能让您回到获取全部或部分列的底层根据需要从数据库中获取（请参阅上面的优秀答案以了解一些问题）。所有这些额外的东西只是更多可能失败的东西，使得 ORM 系统*本质上*不如直接的 SQL 调用可靠。

这并不是说您不应该使用 ORM（我的标准免责声明是所有设计选择都有成本和收益，而选择其中一个或另一个取决于）- 如果它适合您，请自行淘汰。我会说我真的不理解 ORM 的流行，因为它似乎为它的用户创造了很多额外的不有趣的工作。当（等待它）我需要从表中获取每一列时，我会坚持使用 SELECT *。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-15T00:37:56.190

ORM 通常不依赖 SELECT *，而是依赖更好的方法来查找列，如定义的数据映射文件（Hibernate、Hibernate 的变体和 Apache iBATIS 执行此操作）。通过查询数据库模式以获取表的列及其数据类型的列表，可以设置一些更自动化的东西。数据的填充方式取决于您正在使用的特定 ORM，并且应该在那里进行详细记录。

选择根本不使用的数据绝不是一个好主意，因为它会创建不必要的代码依赖，以后维护起来会很麻烦。对于处理类内部的数据，事情有点复杂。

一个简短的规则是始终获取该类默认存储的所有数据。在大多数情况下，少量的开销不会产生太大的影响，因此您的主要目标是减少维护开销。稍后，当您对代码进行性能分析时，并且有理由相信它可能会从调整行为中受益，那就是时候去做了。

如果我看到一个 ORM 做出 SELECT * 语句，无论是明显的还是隐藏的，那么我会寻找其他地方来满足我的数据库集成需求。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-15T00:25:42.703

SELECT * 还不错。你有没有问过谁认为它不好“为什么？”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-15T01:15:56.987

SELECT * 强烈表明您对应用程序及其模块的范围没有设计控制权。清理别人的工作的主要困难之一是当里面有一些没有目的的东西，但没有说明需要和使用什么，什么不是。

应用程序中的每条数据和代码都应该有一个目的，并且应该指定目的或易于检测到。

我们都知道并且鄙视那些不太担心事情为什么会工作的程序员，他们只是喜欢尝试一些东西，直到预期的事情发生并为下一个人关闭它。SELECT * 是一个非常好的方法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-15T15:14:53.003

如果您觉得需要将所有内容封装在一个对象中，但需要包含表中包含的一小部分内容 - 定义您自己的类。编写直接 sql（在 ORM 之内或之外 - 大多数允许直接 sql 规避限制）并用结果填充您的对象。

但是，在大多数情况下，我只会使用表的 ORM 表示，除非分析告诉我不要这样做。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-10-21T20:11:57.427

如果您使用查询缓存选择 * 可能会很好。如果您每次点击表时都选择不同的列分类，则可能只是为所有这些查询获取缓存的 select *。

我认为您混淆了 ORM 的目的。ORM 旨在将域模型或类似的映射到数据库中的表或某些数据存储约定。这并不是为了让您的应用程序在计算上更高效，甚至不是预期的。

# javascript - 页面未在 javascript 中加载

> ID：291855
> 
> 赞同：2
> 
> 时间：2008-11-15T00:22:04.367
> 
> 标签：javascript, onclick

我有一个带有 onclick javascript 事件的按钮，可以进行一些表单验证。如果验证失败，则返回 false。否则什么都不会返回，并且应该提交表单。

但是发生的事情是地址栏中的网址加载但页面从未加载。不发送标头，不显示错误消息。只是一个空白页。

这似乎只发生在 IE 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-15T00:28:48.643

检查您是否关闭了页面顶部的所有标签。特别是头部标签。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-15T01:23:37.003

听起来你有一个自动关闭的脚本标签。

在 IE 中，这会导致一个问题，这可能会导致一个完全空白的页面。

[http://webbugtrack.blogspot.com/2007/08/bug-153-self-closing-script-tag-issues.html](http://webbugtrack.blogspot.com/2007/08/bug-153-self-closing-script-tag-issues.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-15T00:59:47.613

如果验证通过，你会调用 submit() 吗？

# c# - ASP.NET 自动执行页面

> ID：291866
> 
> 赞同：3
> 
> 时间：2008-11-15T00:29:26.863
> 
> 标签：c#, asp.net

我一直在玩弄某种自动清理页面的想法，该页面执行例行维护任务，并通过调用 1x1 像素 gif 以 asp.net 页面作为 src 参数来调用当前页面执行的范围之外. 然而，我从来没有真正决定过的一件事是如何处理这样一个页面的执行时间，以便它不会在每个请求中执行，也许就像……每 5 个请求。或每 30 分钟或其他间隔。

你会如何考虑建立这样的机制？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-15T02:00:08.007

我已经多次遇到这种情况，我通常最终只是使用任务调度程序来调用页面，这样它是一致且可靠的。依赖页面被调用的问题是你必须确保你的页面总是会有请求。如果可以保证，那么只需在应用程序级别存储一个变量，其中包含上次运行任务的时间戳，并让每个页面检查该时间戳，并在请求进入且超过某个阈值时更新它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-15T02:12:31.443

听起来您可能想改用 global.asax 文件 - 假设您希望每 N 次发生一些事情。例如，如果您想为网站的每 5 个访问者做一些事情，您可以按照以下方式做一些事情，

```
void Application_Start(object sender, EventArgs e) 
{
    // Code that runs on application startup
    Application["Sessions"] = 0;
}

void Session_Start(object sender, EventArgs e) 
{
   // Code that runs when a new session is started
   Application.Lock();
   Application["Sessions"] = (int)Application["Sessions"] + 1;

   if ((int)Application["Sessions"] % 5 == 0)
   {
     DoSomething();
     Application["Sessions"] = 0;
    }
    Application.UnLock();
} 
```

我强烈推荐这些方面的东西，而不是将脚本附加到 GIF 文件的源代码中。您拥有更多的控制权和安全性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-15T02:17:29.187

您是否考虑过使用 Windows 服务？运行清理任务会占用 ASP.NET 线程池中的一个线程。或者，如果您正在清理 SQL Server 数据库，那么 SQL Server 代理作业可能会更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-15T06:10:10.887

来自 stackoverflow 博客的相关条目：[https](https://blog.stackoverflow.com/2008/07/easy-background-tasks-in-aspnet/) ://blog.stackoverflow.com/2008/07/easy-background-tasks-in-aspnet/ 。

其他：

*   [在 ASP.NET 上启动维护过程的最佳实践是什么](https://stackoverflow.com/questions/45841/what-is-the-best-practice-to-kick-off-maintenance-process-on-aspnet)。
*   [asp.net 应用程序的“带外”处理技术](https://stackoverflow.com/questions/42822/out-of-band-processing-techiniques-for-aspnet-applications)

请注意，如果您缺乏稳定、一致的流量，一些解决方案将不起作用。如果 IIS 卸载您的应用程序，缓存、会话和请求方法不起作用。

如果可能，请为每个服务安装一个 Windows 任务服务。制定一个动态添加/删除任务的方案。

如果您的应用程序是托管的并且您无法安装服务，请考虑使用站点监视器来访问它 - 例如[siteuptime](http://www.siteuptime.com/)。这将您的应用程序保留在内存中，允许您点击处理程序或操作页面而不是虚拟图像，并让您准确决定它何时运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-15T00:55:46.967

我会设置一个计时器并在计时器触发时运行清理任务。如果您想根据请求数量进行清理，您可以缩短计时器间隔，然后在计时器触发时检查请求计数；如果请求计数太低，则跳过清理。

# cocoa - 有没有在 Mac 上生成标准 128 位 GUID (UUID) 的方法？

> ID：291868
> 
> 赞同：27
> 
> 时间：2008-11-15T00:30:00.417
> 
> 标签：cocoa, macos, guid, uuid, core-foundation

是否有与 .NET 等效的内置函数

```
Guid.NewGuid(); 
```

在可可？

我的愿望是产生一个字符串，`550e8400-e29b-41d4-a716-446655440000`它代表一个唯一标识符。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-11-15T01:13:04.747

UUID 在 Core Foundation 中由 CFUUID 库处理。您正在寻找的功能是[CFUUIDCreate](http://Developer.Apple.Com/documentation/CoreFoundation/Reference/CFUUIDRef/Reference/reference.html#//apple_ref/c/func/CFUUIDCreate)。

仅供进一步搜索：这些通常称为 UUID，术语 GUID 在 Microsoft 世界之外并不经常使用。您可能会更幸运地使用该搜索词。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-04-14T13:59:55.803

至少在 MacOSX 10.5.x 上，您可以使用命令行工具“uuidgen”来获取您的字符串，例如

$ uuidgen

054209C4-3873-4679-8104-3C18AE780512

还有一个带有此命令的选项 -hdr 可以方便地以标题样式生成它

有关更多信息，请参见手册页。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-11-15T23:16:29.380

一些代码：

对于字符串 UUID，以下类方法应该可以解决问题：

```
+(NSString*)UUIDString {
    CFUUIDRef theUUID = CFUUIDCreate(NULL);
    CFStringRef string = CFUUIDCreateString(NULL, theUUID);
    CFRelease(theUUID);
    return [(NSString *)string autorelease];
} 
```

如果你真的想要字节（不是字符串）：

```
+(CFUUIDBytes)UUIDBytes {
    CFUUIDRef theUUID = CFUUIDCreate(NULL);
    CFUUIDBytes bytes = CFUUIDGetUUIDBytes(theUUID);
    CFRelease(theUUID);
    return bytes;
} 
```

其中 CFUUIDBytes 是 UUID 字节的[结构](http://developer.apple.com/documentation/CoreFoundation/Reference/CFUUIDRef/Reference/reference.html#//apple_ref/doc/c_ref/CFUUIDBytes)。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2008-11-15T02:04:51.943

或者有`uuidgen`命令行工具。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-02-28T10:53:30.340

从 10.8 开始，您还可以使用：

```
NSString *uuidString = [[NSUUID UUID] UUIDString]; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-15T00:41:41.097

查看[Wikipedia](http://en.wikipedia.org/wiki/UUID "图形用户界面")文章和[Core Foundation](http://en.wikipedia.org/wiki/Core_Foundation "维基百科：核心基金会")页面。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2021-01-11T16:14:47.727

您可以在终端中创建别名`~/.bash_profile`并调用`uuid`：

```
alias uuid="uuidgen | tr '[:upper:]' '[:lower:]'" 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-15T03:34:06.613

从 10.3 左右开始，您可以使用[`[[NSProcessInfo processInfo] globallyUniqueString]`](https://developer.apple.com/library/mac/documentation/cocoa/reference/Foundation/Classes/NSProcessInfo_Class/Reference/Reference.html#//apple_ref/occ/instm/NSProcessInfo/globallyUniqueString). 然而，虽然这*目前*会生成一个 UUID，但它从来没有并且仍然不能保证这样做，所以如果你真的需要一个*UUID*而不仅仅是任何唯一的字符串，你应该使用 CFUUID。

# c++ - 如何在 boost asio 中设置阻塞套接字的超时时间？

> ID：291871
> 
> 赞同：41
> 
> 时间：2008-11-15T00:31:22.443
> 
> 标签：c++, sockets, boost, boost-asio

有没有办法取消挂起的操作（不断开连接）或为 boost 库函数设置超时？

即我想在 boost asio 中设置阻塞套接字的超时时间？

socket.read_some(boost::asio::buffer(pData, maxSize), error_);

示例：我想从套接字读取一些内容，但是如果 10 秒过去了，我想抛出一个错误。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2018-08-14T21:29:01.423

TL;博士

```
socket.set_option(boost::asio::detail::socket_option::integer<SOL_SOCKET, SO_RCVTIMEO>{ 200 }); 
```

完整答案多年来，这个问题一直被反复问到。到目前为止我看到的答案很差。我将在此问题的第一次出现中添加此信息。

如果作者只是为所有同步和异步 io 函数添加一个可选参数超时，每个尝试使用 ASIO 来简化他们的网络代码的人都会非常高兴。不幸的是，这不太可能发生（在我看来，只是出于意识形态的原因，毕竟 ASIO 中的 AS 是有原因的）。

所以这些是迄今为止可用的给这只可怜的猫剥皮的方法，它们都不是特别开胃的。假设我们需要 200 毫秒的超时时间。

1）好的（坏的）旧套接字API：

```
const int timeout = 200;
::setsockopt(socket.native_handle(), SOL_SOCKET, SO_RCVTIMEO, (const char *)&timeout, sizeof timeout);//SO_SNDTIMEO for send ops 
```

请注意这些特性： - 用于超时的 const int - 在 Windows 上，所需的类型实际上是 DWORD，但幸运的是当前的编译器集具有相同的类型，因此 const int 在 Win 和 Posix 世界中都可以使用。- (const char*) 表示值。在 Windows 上需要 const char*，Posix 需要 const void*，在 C++ 中 const char* 将默默地转换为 const void*，而反之则不然。

优点：工作并且可能永远工作，因为套接字 API 是旧的和稳定的。很简单。快速地。缺点：从技术上讲，setsockopt 和宏可能需要适当的头文件（在 Win 上不同，甚至在不同的 UNIX 风格上），但 ASIO 的当前实现无论如何都会污染全局命名空间。需要一个用于超时的变量。不是类型安全的。在 Windows 上，要求套接字处于重叠模式才能工作（当前的 ASIO 实现幸运地使用了这种模式，但它仍然是一个实现细节）。丑陋！

2) 自定义 ASIO 套接字选项：

```
typedef boost::asio::detail::socket_option::integer<SOL_SOCKET, SO_RCVTIMEO> rcv_timeout_option; //somewhere in your headers to be used everywhere you need it
//...
socket.set_option(rcv_timeout_option{ 200 }); 
```

优点：够简单。快速地。漂亮（使用 typedef）。缺点：取决于 ASIO 实现细节，这可能会改变（但 OTOH 最终一切都会改变，而且这样的细节不太可能改变，然后是受标准化的公共 API）。但如果发生这种情况，您必须根据[https://www.boost.org/doc/libs/1_68_0/doc/html/boost_asio/reference/SettableSocketOption.html](https://www.boost.org/doc/libs/1_68_0/doc/html/boost_asio/reference/SettableSocketOption.html)编写一个类（当然是主要的 PITA，这要归功于 ASIO 的这一部分的明显过度设计）或者更好的是恢复到 1。

3) 使用 C++ 异步/未来设施。

```
#include <future>
#include <chrono>
//...
auto status = std::async(std::launch::async, [&] (){ /*your stream ops*/ })
    .wait_for(std::chrono::milliseconds{ 200 });
switch (status)
    {
    case std::future_status::deferred:
    //... should never happen with std::launch::async
        break;
    case std::future_status::ready:
    //...
        break;
    case std::future_status::timeout:
    //...
        break;
    } 
```

优点：标准。缺点：总是启动一个新线程（在实践中），相对较慢（可能对客户端来说已经足够了，但会导致服务器的 DoS 漏洞，因为线程和套接字是“昂贵的”资源）。不要尝试使用 std::launch::deferred 而不是 std::launch::async 来避免新线程启动，因为 wait_for 将始终返回 future_status::deferred 而不会尝试运行代码。

4) ASIO 规定的方法 - 仅使用异步操作（这并不是问题的真正答案）。

优点：如果不需要短事务的巨大可扩展性，对服务器也足够好。缺点：相当罗嗦（所以我什至不会包含示例 - 请参阅 ASIO 示例）。需要对异步操作及其完成处理程序使用的所有对象进行非常仔细的生命周期管理，这实际上要求在异步操作中包含和使用此类数据的所有类都派生自 enable_shared_from_this，这需要在堆上分配所有此类类，这意味着（至少对于短期操作），可伸缩性将在大约 16 个线程后开始逐渐减少，因为每个堆分配/释放都将使用内存屏障。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-12-28T02:57:56.210

当被问到这个问题时，我猜 ASIO 没有任何关于如何完成 OP 所需的示例，即超时阻塞操作，例如阻塞套接字操作。现在有一些例子可以准确地向您展示如何做到这一点。这个例子看起来很长，但那是因为它的评论很好。它展示了如何在“一次性”模式下使用 ioservice。

我认为这个例子是一个很好的解决方案。这里的其他解决方案破坏了可移植性，并且没有利用 ioservice。如果可移植性不重要并且 ioservice 似乎开销很大——那么——你不应该使用 ASIO。无论如何，您都将创建一个 ioservice（几乎所有 ASIO 功能都依赖于它，甚至是同步套接字），因此请利用它。

[使阻塞的 asio tcp 操作超时](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/example/timeouts/blocking_tcp_client.cpp)

[使阻塞的 asio udp 操作超时](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/example/timeouts/blocking_udp_client.cpp)

ASIO 文档已更新，因此请查看有关如何克服 ASIO 使用的一些“陷阱”的新示例。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-26T02:41:24.533

您可以执行 async_read 并为您想要的超时设置一个计时器。然后，如果计时器触发，请在您的套接字对象上调用取消。否则，如果发生读取，您可以取消计时器。这当然需要您使用 io_service 对象。

编辑：为您找到了执行此操作的代码片段

[http://lists.boost.org/Archives/boost/2007/04/120339.php](http://lists.boost.org/Archives/boost/2007/04/120339.php)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-15T11:34:43.353

在 Linux/BSD 下，操作系统直接支持套接字上的 I/O 操作超时。该选项可以通过启用`setsocktopt()`。我不知道是否`boost::asio`提供了设置它的方法或公开套接字脚本以允许您直接设置它——后一种情况并不是真正可移植的。

为了完整起见，这是手册页中的描述：

> **SO_RCVTIMEO**和**SO_SNDTIMEO**
> 
> ```
>  Specify the receiving or sending  timeouts  until  reporting  an
>           error.  The argument is a struct timeval.  If an input or output
>           function blocks for this period of time, and data has been  sent
>           or  received,  the  return  value  of  that function will be the
>           amount of data transferred; if no data has been transferred  and
>           the  timeout has been reached then -1 is returned with errno set
>           to EAGAIN or EWOULDBLOCK just as if the socket was specified  to
>           be  non-blocking.   If  the timeout is set to zero (the default)
>           then the operation  will  never  timeout.   Timeouts  only  have
>           effect  for system calls that perform socket I/O (e.g., read(2),
>           recvmsg(2), send(2), sendmsg(2)); timeouts have  no  effect  for
>           select(2), poll(2), epoll_wait(2), etc. 
> ```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-04-20T18:43:43.547

我有同样的问题，经过一番研究，我能想出的最简单、最干净的解决方案是获取底层的本机套接字，然后进行选择，直到有数据要读取。Select 将采用超时参数。当然，使用本机套接字开始违背使用 asio 的观点，但同样，这似乎是最干净的方式。据我所知，asio 没有提供一种轻松实现同步使用的方法。代码：

```
 // socket here is:  boost::shared_ptr<boost::asio::ip::tcp::socket> a_socket_ptr

        // Set up a timed select call, so we can handle timeout cases.

        fd_set fileDescriptorSet;
        struct timeval timeStruct;

        // set the timeout to 30 seconds
        timeStruct.tv_sec = 30;
        timeStruct.tv_usec = 0;
        FD_ZERO(&fileDescriptorSet);

        // We'll need to get the underlying native socket for this select call, in order
        // to add a simple timeout on the read:

        int nativeSocket = a_socket_ptr->native();

        FD_SET(nativeSocket,&fileDescriptorSet);

        select(nativeSocket+1,&fileDescriptorSet,NULL,NULL,&timeStruct);

        if(!FD_ISSET(nativeSocket,&fileDescriptorSet)){ // timeout

                std::string sMsg("TIMEOUT on read client data. Client IP: ");

                sMsg.append(a_socket_ptr->remote_endpoint().address().to_string());

                throw MyException(sMsg);
        }

        // now we know there's something to read, so read
        boost::system::error_code error;
        size_t iBytesRead = a_socket_ptr->read_some(boost::asio::buffer(myVector), error);

        ... 
```

也许这对您的情况有用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-01-08T23:56:40.333

继续 grepsedawk 提到的内容。在 asio doco的**Timeouts**部分下，有几个示例显示了如何在一段时间后取消长时间运行的异步操作。[提升 Asio 示例](http://think-async.com/Asio/boost_asio_1_5_3/doc/html/boost_asio/examples.html) 。[异步 TCP 客户端对我帮助最大。](http://think-async.com/Asio/boost_asio_1_5_3/doc/html/boost_asio/example/timeouts/async_tcp_client.cpp)

快乐的异步:)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-09-11T08:47:17.303

即使在最初的问题之后多年，仍然没有令人满意的答案。

手动使用 select 不是一个好的选择

1.  文件描述符编号必须小于 1024
2.  由于错误的校验和，FD 可能被错误地报告为准备就绪。

调用`io_service.run_one()`也是一个坏主意，因为可能还有其他异步选项需要 io_service 到 always `run()`。而且boost关于阻塞tcp客户端的文档很难理解。

所以这是我的解决方案。关键思想如下：

```
{
    Semaphore r_sem;
    boost::system::error_code r_ec;
    boost::asio::async_read(s,buffer,
                            [this, &r_ec, &r_sem](const boost::system::error_code& ec_, size_t) {
                                r_ec=ec_;
                                r_sem.notify();
                            });
    if(!r_sem.wait_for(std::chrono::seconds(3))) // wait for 3 seconds
    {
        s.cancel();
        r_sem.wait();
        throw boost::system::system_error(boost::asio::error::try_again);
    }
    else if(r_ec)
        throw boost::system::system_error(r_ec);
} 
```

这里`Semaphore`只是一个互斥锁和一个condition_variable。
`wait_for`由[http://en.cppreference.com/w/cpp/thread/condition_variable/wait_for实现](http://en.cppreference.com/w/cpp/thread/condition_variable/wait_for)

完整代码位于[https://github.com/scinart/cpplib/blob/master/include/asio.hpp](https://github.com/scinart/cpplib/blob/master/include/asio.hpp)
示例：[https ://github.com/scinart/cpplib/blob/6e9a1690bf68971b809be34dfe432949d9a9f727/standalone_example/boost_block_tcp_client_server.cpp](https://github.com/scinart/cpplib/blob/6e9a1690bf68971b809be34dfe432949d9a9f727/standalone_example/boost_block_tcp_client_server.cpp)

-- 更新 -- 示例链接已更新。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-02-22T22:10:06.103

`SO_RCVTIMEO`并`SO_SNDTIMEO`从`timeval`struct`"sys/time.h"`而不是`int`. 所以@Pavel Verevkin 的选项 1\. 需要采用 a`timeval`而不是 an`int`和选项 2\. 需要实现一个类，因为[`boost::asio::detail::socket_option::integer`](https://www.boost.org/doc/libs/1_68_0/doc/html/boost_asio/reference/SettableSocketOption.html)只存储一个整数值。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-11-15T05:11:08.930

在 *nix 上，您将使用 alarm()，因此您的套接字调用将因 EINTR 而失败

# python - 构建 SSO 系统的最佳实践

> ID：291874
> 
> 赞同：0
> 
> 时间：2008-11-15T00:34:15.090
> 
> 标签：python, web-services, web-applications, active-directory

我正在为几个使用基于表单的身份验证的 Web 应用程序构建一个单点登录系统。

我设想的方式是，当用户通过我的 sso 门户单击链接时，我的 sso 系统将处理针对活动目录的身份验证将验证传递到所需的 Web 应用程序。

构建这样的东西的最佳方法可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-15T00:42:24.480

当用户在没有会话 cookie 的情况下访问应用程序 URL 时，他会被重定向到 SSO 系统。然后，他登录到 SSO 表单，然后使用票证 ID 将他重定向回您的应用程序，您可以在 SSO 系统中查找该票证 ID 以获取凭证。

另外，看看[Crowd](http://www.atlassian.com/software/crowd/)和[CAS](http://www.ja-sig.org/products/cas/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-15T00:40:50.897

查看[JA-SIG CAS](http://www.ja-sig.org/products/cas/index.html)。即使您自己构建，您也应该查看他们的架构以了解如何实现的想法。

# php - 如何在服务器端取消 ajax 查询（来自 jquery）？

> ID：291885
> 
> 赞同：0
> 
> 时间：2008-11-15T00:39:33.253
> 
> 标签：php, jquery, ajax

听起来像一个奇怪的问题，但说我有这样的事情：

```
$.post( "/myajax.php",
        { "param1": value1, "param2": value2 },
        function( data, status ) {
            if( status == "success" ) {
               $("#someid").html( data );
            }
        }, "html" ); 
```

虽然 myajax.php 正在做它需要做的任何事情，但它决定不需要对`#someid`. 如果它只是返回，则`someid`元素为空白，但我想不理会它。php 查询如何以这样的方式返回`status != "success"`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-15T00:45:24.130

检查返回的数据不是更简单吗？

```
$.post( "/myajax.php", { 
        "param1": value1, 
        "param2": value2 
   }, function( data, status ) {
       if( data != "" ) {
           $("#someid").html( data );
       }
   }, 
   "html" 
); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-15T00:47:55.217

ajax 调用将任何`200 OK`视为成功。因此，您可以从 PHP 脚本中返回其他内容来触发 ajax 错误。

如果您想选择更合适的东西，[这里还有一些其他状态代码。](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

**编辑**：我不一定不同意这种方法，但我仍然更倾向于对状态消息（http 状态）而不是响应正文进行操作。

我的想法是，在提到的交易后，您正在更新资源。可以合理地假设您期望发生两件事中的一件（在“成功”条件下）：

1.  200 OK 表示内容发布没有问题，结果响应通常是显示新内容。ajax 方法通过允许您获取响应主体来更新您的 UI 来“强制执行”此行为。

2.  在不需要进行更新的情况下，200 OK 也可以（因为请求已按预期处理），但也许[204 No Content](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.5)更好，因为它表明请求已完成，但没有更改的观点是必要的。我倾向于相信这也更符合 ajax 调用，因为您可以忽略响应主体（因为没有响应主体）并操作状态（204？更新 UI 以说“不需要更改”或类似的)

# asp.net - ASP.NET 使用表单身份验证登录网站与无

> ID：291888
> 
> 赞同：3
> 
> 时间：2008-11-15T00:40:02.927
> 
> 标签：asp.net, forms-authentication

我有一个标准的 ASP.NET 网站。任何人都可以阅读/查看任何页面（管理部分除外），但是当有人想要贡献时，他们需要登录。就像那里的大多数贡献站点一样。

所以，如果我有我的 OWN 登录控件或用户名/密码/提交输入字段，我为什么要打开表单身份验证而不是不打开？表单身份验证给了我什么，它有我自己的代码来检查我的数据库中的用户/通行证和我自己的两个输入字段+一个提交按钮，这项工作是否完美？

（注意：我真的不喜欢在数据库中创建所有这些表和 usp 的 asp.net 成员资格的东西，所以请不要建议我使用它）。

就像，使用我的代码，当我验证用户（使用我自己的数据库代码）时，我手动创建自己的身份等。

这一切都是必需的吗？这样做的主要目的是什么？

干杯！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-15T00:52:52.197

您可以随心所欲地授权您的用户。FormAuthentication 用于设置会话身份和身份验证 cookie，允许用户在注销或会话过期之前保持登录状态。您无需使用成员资格提供程序即可使用 FormsAuthentication。听起来您只是在复制此功能。

```
...do your authentication against your DB or Active Directory

if (Request.QueryString["ReturnUrl"] != null)
{
    FormsAuthentication.RedirectFromLoginPage(userName.Text, false);
}
else
{
    FormsAuthentication.SetAuthCookie(userName.Text, false);
} 
```

然后你需要在web.config中设置使用它

```
<system.web>
  <authentication mode="Forms">
    <forms loginUrl="Login.aspx"
           protection="All"
           timeout="30"
           name="my-auth-cookie" 
           path="/"
           requireSSL="false"
           slidingExpiration="true"
           defaultUrl="default.aspx" />
  </authentication>
</system.web> 
```

您可以获得自己授权的所有好处，而不必实施 cookie 基础架构。请注意，由于您的网站只需要在编辑时授权，因此您需要设置允许每个人阅读所有页面的权限，并实现您自己的逻辑，以便在他们想要编辑时将他们重定向到登录页面。

更多信息[在这里](http://msdn.microsoft.com/en-us/library/aa480476.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-15T01:46:04.850

请注意，您可以利用 ASP.Net 表单身份验证并**[实现您自己的成员资格提供程序](http://msdn.microsoft.com/en-us/library/f1kyba5e.aspx)**，该提供程序将读取/写入您现有的表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-15T01:52:38.193

我还从 ASP.NET Web 项目开箱即用的默认表单身份验证开始。但是，我也对该股票数据库中表的过度构建功能感到非常沮丧。

在我的工作经验中，我使用了自定义构建的身份验证，并且只是在会话变量中携带了登录的用户配置文件（自行创建）。

asp.net 成员资格也很难移植到某些共享托管服务提供商。

# ajax - 如何使用 dojo.io.iframe.send 取消文件上传？

> ID：291891
> 
> 赞同：4
> 
> 时间：2008-11-15T00:41:01.690
> 
> 标签：ajax, iframe, post, upload, dojo

我正在使用 dojo.io.iframe.send 方法将文件发送到我的服务器。我想提供一种方法，用户可以在发送过程中取消发送，以防发送时间过长或用户意识到她发送了错误的文件。

我想不出办法做到这一点。如果发送需要很长时间（即服务器没有快速响应），我可以使用超时来终止发送，但这不是我想要的。我想在用户做出手势时终止（例如单击“取消”按钮。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-03T11:42:15.793

嗨，我意识到这是一个相当晚的回复，所以我希望您或通过谷歌偶然发现这里的人对此有所帮助。

在iFrame 中**可以**取消文件上传，在 Firefox 中可以调用`window.stop()`iFrame 上的方法。然而，IE 没有这种方法，但自带了`execCommand("Stop")`然而，因为手动按下停止甚至不起作用，脚本停止也不会。

我的第一次尝试涉及将 iFrame 的位置设置为`about:blank`无济于事。但是浏览到具有正文的源**将取消**iFrame POST！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T05:03:15.073

出于安全原因，JavaScript 甚至无法访问您发送的文件。所有文件上传都是使用表单完成的，并由浏览器直接处理。据我所知，没有直接的界面来监控上传进度，也没有影响它的方式（例如，取消它）。

导航可能会有所帮助，但是否中断传输仍取决于浏览器——没有关于此的规范。

总结一下：在 JavaScript 中以可移植的方式做到可靠是不可能的。这意味着 Dojo 不提供此功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-23T15:55:21.377

所以我意识到这是一个非常古老的帖子（4 年！），我正在回答。但是，当我在谷歌上搜索一个回想起来应该很明显的答案时，我发现了它，但在这里没有得到答案（也没有在我看过的其他任何地方）。所以，为了下一个可怜的 schlub：

如果（像我一样），您不关心实际停止文件传输，而只是想允许`dojo.io.iframe`继续移动（从用户的角度有效地取消），您可以简单地忽略延迟回调的结果。但是，如果您还想通过 上传其他内容`dojo.io.iframe`，则还必须使其`dojo.io.iframe`也忽略结果。要做到这一点，这很烦人……`dojo.io.iframe.send()`调用返回延迟。如果您想取消上传以便`dojo.io.iframe`执行后续排队的发送调用（因为它一次只能执行一个），您只需调用`.cancel()`从当前正在进行的发送返回的延迟。

如：

```
 var dfd = dojo.io.iframe.send({...});
    var dfd2 = dojo.io.iframe.send({...}); // this send will not start until the first one completes. it is blocked internally by dojo.io.iframe.

... 
```

现在，用户在某处单击取消按钮，因为上传时间太长，或者他们意识到他们并不是要上传所选文件。我们不想等到第一个文件传输完成，因为我们不再关心传输结果。

```
onclick: function() {
    dfd.cancel();
} 
```

在 dfd 上调用 cancel 将允许第二个`send()`调用立即执行。如果您在 fiddler 中观看，您会看到第二次上传现在立即开始，而不是等待第一个（已取消）上传完成，因为它会在不调用`.cancel()`deferred 的情况下完成。

在不取消第一次延迟的情况下，`dojo.io.iframe`将继续尽职尽责地等待第一次上传的结果，从而阻止任何后续排队`send()`等待通过`dojo.io.iframe`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-17T05:26:45.280

朋友所做的只是在取消按钮被预置时重新加载网页（我认为是通过调用 document.location.refresh 函数）。还有一种监视上传进度的方法（有一个进度条），但它依赖于服务器（在我看到的情况下，它是一个 apache 模块，然后您将轮询指定链接和服务器上的进度将返回进度）。

# asp.net-mvc - 如何在 ASP.NET MVC 中实现分页？

> ID：291893
> 
> 赞同：13
> 
> 时间：2008-11-15T00:41:54.280
> 
> 标签：asp.net-mvc, paging

目前，我正在使用在许多博客文章中找到的策略。基本上，URL 包含页码（例如 /Users/List/5 将为您提供分页用户列表第 5 页上的用户）。但是，我没有遇到一个页面必须列出两个单独的分页列表的情况。如何使用 ASP.NET MVC 进行此操作？我是否只需提供两个 url 参数（例如 /Users/List?page1=1&page2=2）？使用局部视图有更好的方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-15T06:57:32.990

忽略路由一分钟，您只需将 URL 中 2 个不同页面的状态保留为查询字符串参数。

mysite.com/foo?list1page=2&list2page=8

然后你相​​应地构建数据/寻呼机。寻呼机链接只会更新 url。

您可以通过路由获得创意以创建更友好的 URL，但我认为查询字符串参数在这里是完全可以接受的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-04-06T16:52:51.900

我在 asp.net 官方网站上找到了[ASP.NET MvcPager](http://www.asp.net/community/control-gallery/Item.aspx?i=4224)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-15T08:08:59.697

如果您使用查询参数，则每个列表中的页面链接必须相互了解才能传递两个参数。

如果这两个列表彼此独立，那么您可以使用 jquery 和 ajax 单独更新它们。只需将每个列表作为局部视图放在它们自己的 div 中。

```
<div id="list1"><%= Html.RenderPartial ("ListA") %></div>
<div id="list2"><%= Html.RenderPartial ("ListB") %></div> 
```

从 jQuery Form 插件中查找**ajaxSubmit**以获得更新列表的简单方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-26T17:21:24.870

[PagedList.Mvc](https://www.nuget.org/packages/PagedList.Mvc)是一个非常易于使用的插件，也可以通过以下方式获得`Nuget`。

# sqlite - SQLite 非独占保留锁？

> ID：291897
> 
> 赞同：4
> 
> 时间：2008-11-15T00:43:31.983
> 
> 标签：sqlite, concurrency, locking, reserved

我一直在研究提高我网站的 SQLite 性能，尤其是在事务方面。本质上，我正在寻找一种在进程中延迟数据库写入的方法，以便它们可以一次完成。但是，当我累积更新查询时，我希望其他进程能够读取和写入数据库，并且只有在进程中发出提交时才锁定文件以进行写入。

在查看文档时，似乎一旦在事务中发出更新命令，进程就会获得一个保留锁，这（如果我没记错的话）意味着任何其他尝试将更新查询添加到自己的事务的进程或者提交事务是无法这样做的，因此会阻塞，直到事务提交到带有锁的进程上。

我确信针对此特定功能有很好的数据完整性原因。我只能说，在我的情况下，同时执行这些更新没有危险。

一种解决方案是，在每个过程中，我可以在数组中累积我希望调用的查询文本，然后在我准备好编写时循环它，但我想知道是否有可能进行 SQLite 事务自动为我执行此操作。

**更新：**当我说“一次完成所有更新”时，我的意思是在 SQLite 中使用事务来仅获得一个独占锁并在每个进程中写入一次磁盘，而不是每个查询一次。这导致使用 SQLite 的速度提高 100 倍。

我已经进行了一些基本测试，似乎一旦您有多个进程向其事务添加查询，一旦您点击更新查询，该进程就会尝试获取 RESERVED 锁。由于只有一个进程可以拥有保留锁，这意味着任何其他尝试获取锁的进程都将阻塞，直到拥有锁的进程完成事务。

我承认这个问题可能是一个过早的优化，因为我还没有遇到任何性能损失，但是我已经运行了一些简单的测试，并且 100 个用户在我的机器上创建和运行一个包含 100 个查询的事务大约需要 4 秒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-15T01:43:20.253

SQLite 支持[ATTACH](http://www.sqlite.org/lang_attach.html) 将一个数据库附加到另一个数据库。也许您可以将数据累积在一个单独的数据库中，当您准备好合并累积的行时，附加单独的数据库，在单个语句中复制行，然后分离。

[编辑：在 sqlite-users 的邮件列表线程](http://www.mail-archive.com/sqlite-users@sqlite.org/msg38420.html)中提出了与 OP 类似的建议，并进行了一些后续讨论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-21T10:16:55.110

比附加数据库更好的是只创建一个临时表。（创建临时...）

并看看新的 WAL 日志模式，它完全可以手动执行您尝试执行的操作，并且它允许同时写入和读取（虽然不是同时写入）。

#pragma journal_mode=WAL

# mapping - 将 Web.SiteMap 与动态 URL（URL 路由）一起使用

> ID：291908
> 
> 赞同：10
> 
> 时间：2008-11-15T00:48:18.617
> 
> 标签：mapping, url-routing, sitemap, wildcard, sitemapnode

我想匹配 Web.SiteMap 中的“近似”匹配项

Web.Sitemap 静态站点地图提供程序运行良好，除了一件事。它是静态的！

因此，如果我必须为页面上的 10,000 篇文章中的每一篇都拥有一个站点地图节点，如下所示：

*   site.com/articles/1/article-title
*   site.com/articles/2/another-article-title
*   site.com/articles/3/another-article-again
*   ...
*   site.com/articles/9999/the-last-article

我可以使用 SiteMap 进行某种通配符映射以匹配文章下的任何内容吗？

或者也许在我的 Webforms 页面中，有没有办法手动设置当前节点？

[使用 ASP.Net MVC 框架执行此操作时，我在此页面](http://geekswithblogs.net/Patware/archive/2008/11/12/126987.aspx)上找到了“一点”帮助，但仍在为 Webforms 寻找一个好的解决方案。

我想我要做的是创建一个自定义 SiteMap Provider

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-20T09:09:44.610

这是对上述评论的回应。我无法发布完整的代码，但这基本上是我的提供商的工作方式。

假设您有一个页面 article.aspx，它使用查询字符串参数“id”来检索和显示文章标题和正文。然后这是在 Web.sitemap 中：

```
<siteMapNode url="/article.aspx" title="(this will be replaced)" param="id" /> 
```

然后，您创建这个类：

```
public class DynamicSiteMapPath : SiteMapPath
{
  protected override void InitializeItem(SiteMapNodeItem item)
  {
    if (item.ItemType != SiteMapNodeItemType.PathSeparator)
    {
      string url = item.SiteMapNode.Url;
      string param = item.SiteMapNode["param"];

      // get parameter value
      int id = System.Web.HttpContext.Current.Request.QueryString[param];

      // retrieve article from database using id
      <write your own code>

      // override node link
      HyperLink link = new HyperLink();
      link.NavigateUrl = url + "?" + param + "=" + id.ToString();
      link.Text = <the article title from the database>;
      link.ToolTip = <the article title from the database>;
      item.Controls.Add(link);
    }
    else
    {
      // if current node is a separator, initialize as usual
      base.InitializeItem(item);
    }
  }
} 
```

最后，您可以在代码中使用此提供程序，就像使用静态提供程序一样。

```
<mycontrols:DynamicSiteMapPath ID="dsmpMain" runat="server" /> 
```

我的课比这更复杂，但这些是基础。您可以不使用查询字符串参数，而是分析您正在使用的友好 url，然后使用它来检索正确的内容。为了最大限度地减少每个请求的额外数据库查找，您可以向提供者添加缓存机制（文章标题通常不会经常更改）。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T12:26:33.497

我认为这并不完全是您问题的答案，但也许它给了您一个想法。我曾经写过一个继承 SiteMapPath 的 DynamicSiteMapPath 类。`<siteMapNode>`我在 Web.sitemap 的每个标签中使用自定义属性，如下所示：

```
<siteMapNode url="dynamicpage.aspx" title="blah" params="id" /> 
```

然后 DynamicSiteMapPath 类获取“id”参数值，从数据库中检索内容，并使用正确的标题和链接覆盖当前呈现的站点地图项节点。这需要一些工作，但如果做得正确，这是提供动态页面支持的一种非常简洁的方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-17T23:10:53.170

我一直遇到这个问题，坦率地说，没有找到任何让我开心的解决方案......所以我从这里和那里借鉴了一些想法。我的解决方案是多部分的：a）让 SiteMapProvider 找到处理请求的实际页面并使用它的节点，b）使用标准技术从那里更新 sitemapnode。

A) 我一直遇到的问题是，如果我没有正确的虚拟路径，SiteMap.CurrentNode 将为空，并且会触发 SiteMapResolve 函数。为了解决这个问题，我继承了 XmlSiteMapProvider 并覆盖了 CurrentNode：

```
 namespace WebFormTools
{
    class RouteBaseSitemapProvider : XmlSiteMapProvider
    {
        public override SiteMapNode CurrentNode
        {
            get
            {
                var node = base.CurrentNode;

                if (node == null) 
                {
                    // we don't have a node, see if this is from a route
                    var page = HttpContext.Current.CurrentHandler as System.Web.UI.Page;

                    if (page != null && page.RouteData != null)
                    {
                        // try and get the Virtual path associated with this route
                        var handler = page.RouteData.RouteHandler as PageRouteHandler;

                        if (handler != null) {
                            // try and find that path instead.
                            node = FindSiteMapNode(handler.VirtualPath);
                        }
                    }

                }

                return node;
            }
        }
    }
} 
```

基本上，如果默认实现没有找到任何东西，请查找路由（如果有）并尝试使用处理程序的虚拟路径查找节点。

这里是我的 Web.Config、Global.asax 和 SiteMap 文件的一部分供参考：

添加提供者

```
 <siteMap defaultProvider="RouteBaseSitemapProvider">
  <providers>
    <add name="RouteBaseSitemapProvider" type="WebFormTools.RouteBaseSitemapProvider" siteMapFile="Web.sitemap" />
  </providers>
</siteMap> 
```

路线：

```
 routes.MapPageRoute("EvalRoutes",
            "Evals/{type}/New.aspx",
            "~/Evals/New.aspx"); 
```

和站点地图：

```
 <siteMapNode url="~/Evals/New.aspx" title="New Eval - {type}"  description="" /> 
```

B) 我继承了 System.Web.UI.Page，恰当地命名为 BaseClass，它添加​​了一个方法来为 SiteMapResolve 事件注册处理程序：

```
public System.Web.SiteMapNode Process(System.Web.SiteMapNode currentNode)
    {
        if (currentNode == null) return currentNode;

        var page = HttpContext.Current.CurrentHandler as System.Web.UI.Page;

        if (page != null && page.RouteData != null)
        {

            Dictionary<Regex, string> replacements = new Dictionary<Regex, string>();

            // build a list of RegEx to aid in converstion, using RegEx so I can ignore class.  Technically I could also
            foreach (var key in page.RouteData.Values.Keys)
            {
                replacements.Add(new Regex(string.Format("\\{{{0}\\}}", key), RegexOptions.IgnoreCase), page.RouteData.Values[key].ToString());              
            }

            // navigate up the nodes
            var activeNode = currentNode;
            while (activeNode != null)
            {
                // to the replacements
                foreach(var replacement in replacements)
                {
                    activeNode.Title =  replacement.Key.Replace(activeNode.Title, replacement.Value);
                }

                activeNode = activeNode.ParentNode;
            }

        }

        return currentNode;
    } 
```

我仍然需要适当地映射 URL（将使用接收路由的页面的 URL），这是没有路由信息的。我可能会在站点地图中使用自定义属性来告诉节点如何呈现 URL。

# java - Ant build.xml 中的 Groovy（带有 Java 类）

> ID：291920
> 
> 赞同：5
> 
> 时间：2008-11-15T00:56:27.307
> 
> 标签：java, ant, groovy

我必须将 Groovy 类包含到现有的 Java 应用程序中，并将 Groovy 包含到 Ant 的`build.xml`文件中。

为它配置 Ant 的最佳方法是`build.xml`什么？

更新：结合 Java 和 Groovy 编译是否有更多细节？任务顺序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-15T01:18:09.197

@VonC 关于在 Ant 构建中包含 Groovy 脚本是正确的。

稍微扩展一下：

*要在同一应用程序中一起*编译`.groovy`和`.java`源代码，请使用Ant 任务。*[`<groovyc>`](http://groovy.codehaus.org/The+groovyc+Ant+Task)*

 *请参阅[Ant 与 Groovy 的集成以](http://groovy.codehaus.org/Ant+Integration+with+Groovy)获取参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-15T01:09:10.947

要在您的 ant 脚本中使用 Groovy，您基本上必须[声明 Groovy ant 任务](http://groovy.codehaus.org/The+groovy+Ant+Task)：

```
<project name="groovy-build" default="listSourceFiles">

<taskdef name="groovy"
     classname="org.codehaus.groovy.ant.Groovy"/>
<groovy>
    ant.... // some ant groovy directives
</groovy>
</target>
</project> 
```

但是，您必须小心，在 ant.xml 中引用[当前目标](https://stackoverflow.com/questions/225063)中的文件集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-28T09:23:30.523

您应该像这样在 groovyc 中定义 javac。

```
<groovyc srcdir="${testSourceDirectory}" destdir="${testClassesDirectory}">
  <classpath>
    <pathelement path="${mainClassesDirectory}"/>
    <pathelement path="${testClassesDirectory}"/>
    <path refid="testPath"/>
  </classpath>
  <javac source="1.4" target="1.4" debug="on" />
</groovyc> 
```

有关更多信息，请查看此处： http: [//groovy.codehaus.org/The+groovyc+Ant+Task](http://groovy.codehaus.org/The+groovyc+Ant+Task)在联合编译部分。

# jquery - 带有嵌套效果循环的jQuery动画

> ID：291922
> 
> 赞同：4
> 
> 时间：2008-11-15T00:56:32.377
> 
> 标签：jquery, animation

我有一个嵌套函数来显示/隐藏段落新闻提示样式。

问题是当循环重新开始时（第 4 行），不透明效果停止正常工作，因此段落突然出现。

有 jquery 高手知道吗？我做这太难了吗？

```
$('#special-ticker p').hide();
var a=0;
function outer() {
    function inner() {
        if(a===$('#special-ticker p').length) { a = 0; }
        $('#special-ticker p').
        eq(a).
        fadeIn(800, function(){
            $(this).animate({opacity:100},10000,null,function(){
                $(this).hide(800,function(){
                    a++;
                    outer();
                });
            });
        });
    }
    return inner();
}
$(function(){ 
    outer(); 
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-15T02:18:05.427

问题是第 9 行：

```
$(this).animate({opacity:100},10000,null,function(){
//... 
```

不透明度应为“1”（不透明度是介于 0 和 1 之间的值）

```
$(this).animate({ opacity : 1 }, 10000, null, function() { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-15T02:23:26.930

试试这个：

```
 newsticker = function (selector) {
                $(selector).hide();
                var i = $(selector).length - 1;
                var toggle = function() {
                    $(selector).eq(i).fadeOut("slow", function() {
                        i = ++i % $(selector).length;
                        $(selector).eq(i).fadeIn("slow", function() {
                            setTimeout(toggle, 1000)
                        });

                    });
                };          
                toggle();
            }; 
```

并用这个初始化它：

```
 new newsticker("#special-ticker p"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T00:34:56.693

解决方案已发布，但有一条评论：

如果要立即隐藏一组元素，则创建一个“隐藏的”CSS 类然后将其分配给这些元素会更快。节省了一些 javascript 代码，但也确保隐藏的元素不会在屏幕上短暂闪烁。

```
<style type="text/css" media="screen">
.hidden { display: none; }
</style>

<p>Show me</p>
<p class="big hidden">Use javascript to show me later.</p> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T17:18:32.333

对代码进行了轻微的修改，以保存使用相同选择器重复创建 jQuery 实例。我认为它也更容易阅读。

```
var jS = $('#special-ticker p');
// jS.hide(); // not needed if css hides elements initially
var i = 0;

function do_ticker() {
  jS.eq(i).fadeIn(800, function() {
    var me = $(this);     
    setTimeout(function() { me.hide(800, 
      function() { 
        i = ++i % jS.length;
        do_ticker();
      });
    },1000); // setTimeout
  });
};
do_ticker(); 
```

# apache-flex - Flex 中使透明面板响应 rollOver() 事件的正确方法

> ID：291927
> 
> 赞同：2
> 
> 时间：2008-11-15T01:00:38.623
> 
> 标签：apache-flex, rollover

我在 Flex 应用程序中有一个 Canvas，其中包含仅覆盖主画布约 50% 区域的项目。

我希望画布响应`rollOver`整个区域的事件，而不仅仅是内部项目所覆盖的区域。

我一直在设置以下属性来实现这一点：

```
<mx:Canvas backgroundColor="white"
backgroundAlpha=".01"
rollOver="rollOver(event)">... 
```

这会导致整个画布响应翻转事件。效果很好——我只是对它不满意，并且认为必须有更好的方法来实现它。

有没有办法强制鼠标事件作用于 UIComponent 的整个区域？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-16T00:09:36.120

你正在做的事情是完全可以接受的，尽管使用 0.01 的任意 alpha 值是不必要的，你可以将它的 backgroundAlpha 设置为一个简单的 0。

我经常将 Canvases 用于复杂的多层 UI，并通过 css 将我的默认 Canvas 样式设置为 backgroundAlpha 为 0 和 backgroundColor 为#ffffff，然后，如果我需要画布实际可见，我会调整它的单个 backgroundAlpha 和 backgroundColor 属性.

将图形对象的 alpha 设置为 0 并没有错，这样它仍然可以响应事件，但没有完全“关闭”，我们 AS 编码人员一直都在这样做！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T16:12:38.903

忽略图像的透明部分怎么样？在我的情况下，我希望只有在图像的可见部分被翻转时才会出现翻转效果，而不是透明部分。这可能吗？

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-11-15T01:32:45.830

你可以这样做：

```
 import flash.event.MouseEvent;
...
canvas.addEventListener(MouseEvent.ROLL_OVER,function(event:MouseEvent):void {
    ...
}); 

```

其中“canvas”是 mxml 中画布的 ID。

# iphone - 如何在导航栏和表头之间创建一个栏？

> ID：291934
> 
> 赞同：0
> 
> 时间：2008-11-15T01:13:38.537
> 
> 标签：iphone, cocoa-touch

在 NYTimes iPhone 应用程序中，顶部新闻屏幕上的表格标题和导航栏之间存在一个栏。

那是什么酒吧？或者它只是导航栏和表格标题之间的标签？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-15T03:00:22.563

是的，这可能只是一对背景颜色设置为灰色且文本颜色设置为白色的标签。他们实际上可能正在以其他方式实现它（我还没有看到他们的代码），但当然这是最简单的方法。

# c++ - 为什么这是合法的，c ++ typedef func

> ID：291938
> 
> 赞同：3
> 
> 时间：2008-11-15T01:17:39.790
> 
> 标签：c++

我在 msvc 2005 中做到了这一点。

```
typedef void (*cleanup_t)();

void func(cleanup_t clean)
{
    cleanup_t();
} 
```

为什么会这样编译？不给我警告？好的，它给了我一个未引用的形式参数警告，但最初我在 clean 在一个类中时这样做了，当这段代码给我带来问题时，没有未引用的形式参数。

什么是 cleanup_t(); 真的在做什么又有什么意义呢？现在为了笑，我尝试了 int() 并且也有效。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-15T01:26:11.897

我认为这是一个计算结果为 cleanup_t 类型的默认值的表达式。换句话说，一个表达式返回一个指向返回 void 的函数的 NULL 指针。

在 C/C++ 中，没有副作用的表达式（这是 - 我认为）是有效的语句，就像你可以有这样的语句：

```
1 + 2; 
```

这不是语法错误，但某些编译器可能会发出警告。它们通常不会对返回 NULL 值或只是变量名的无副作用表达式发出警告，因为这种类型的表达式通常在宏中用于调试目的（如 assert() 宏）。

您可以将其视为调用该`cleanup_t`类型的默认构造函数。为内置类型（或它们的 typedef）添加了这种默认的类似构造函数的语法，以便模板可以将作为模板参数传入的类型的项目设置为默认值，同时仍然允许模板类型参数是非用户定义类型。可能还有其他原因，但我相信这是其中之一。

就像是：

```
template <class T>
class foo
{
    T myT;

    public:

    foo() {
        myT = T();
    };
};

typedef void (*cleanup_t)();

class bar
{
};

int not_quite_a_cleanup_t_func()
{
    return 1;
}

int main()
{
    foo<int> intFoo;
    foo<cleanup_t> cleanup_t_foo;
    foo<bar> barFoo;

    // here I'm going to harp on one of the things I don't like about C++:
    //
    //  That so many things that look like function calls are not or that
    //  the parens cause subtle behavior changes.
    //
    //  I believe this is the reason this question was posted to 
    //  stackoverflow, so it's not too far off topic.
    //  
    //  Many of these things exist because of backwards compatibility with C or
    //  because they wanted to fit in new features without adding keywords or
    //  new reserved tokens or making the parser even more complex than it already
    //  is.  So there are probably good rationales for them.
    //
    //  But I find it confusing more often than not, and the fact that there
    //  might be a rationale for it doesn't mean I have to like it...

    cleanup_t cleanup1();    // declares a function named cleanup1 that returns a cleanup_t

    cleanup_t cleanup2 = cleanup_t();   // cleanup2 is a variable of type cleanup_t that 
                                        //  is default initialized

    cleanup_t* cleanup3 = new cleanup_t;    // cleanup3 is a pointer to type cleanup_t that 
                                            //  is initialized to point to memory that is 
                                            //  *not* initialized

    cleanup_t* cleanup4 = new cleanup_t();  // cleanup4 is a pointer to type cleanup_t that
                                            //  is initialized to point to memory that *is*
                                            //  initialized (using default intialization)

    cleanup2 = cleanup_t( not_quite_a_cleanup_t_func);  // explicit type conversion using functional notation

    cleanup_t();    // the OP's problem
    cleanup2();     // call the function pointed to by cleanup2
    (*cleanup2)();  // same thing

    class cleanup_class
    {
        cleanup_t cleanup5;

    public:
        cleanup_class() : 
            cleanup5() // class member default initialization
        { };
    };
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-15T01:36:00.893

它正在执行 cleanup_t 类型的默认初始化程序以创建该类型的临时对象，然后从不实际使用该临时对象。

它很像构造函数调用，即“MyClass c = MyClass();”的“MyClass()”部分，只是指向函数的类型实际上没有构造函数。当然，在我的代码片段中，“MyClass()”不一定会创建一个临时的，因为它是一个初始化表达式。“MyClass().some_method();”中的“MyClass()” 也许是一个更接近的类比。

“int()”是“int(0)”的另一种说法，这是“(int)0”的另一种说法，也是“0”的另一种说法。同样，它分配给一个临时的，如果这是整个语句，那么临时是未使用的。

如果在 GCC 上使用 -Wall 编译问题中的代码，则会收到警告“语句无效”。执行此操作的人可能打算键入“clean();”的代码不会产生该警告，因为它当然会产生调用函数的效果。打开警告并正确修复它们的另一个原因;-)

# jquery - 在 jquery 选择器中使用字符串连接或 jQuery 有副作用吗？

> ID：291939
> 
> 赞同：1
> 
> 时间：2008-11-15T01:18:06.843
> 
> 标签：jquery

在探索 jQuery 时，我想出了以下奇怪的脚本。我不认为自己真的这样做了，但是连接字符串以实现变量名在 JavaScript 中并不少见。

欢迎任何反馈。

```
...
    <script type="text/javascript">
        var a = 'y';
        $(document).ready(function() {
            $('p[id^=' + $('p[id=x]').html() + a + "]").css('color','blue');
        });
    </script>
...

<p id="x">2a</p>
<p id="2ay_">mytext</p> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-15T01:25:22.927

简短的回答是否定的，没有副作用。你的例子很古怪，但正如你所说，你只是在探索，看看你能做什么。我之前在 jQuery 选择器中使用过字符串连接和函数值返回，它可以成为管理位于 DOM 不同部分的相关元素集的有用技术。

我承认我没有`jQuery.html()`在选择器中使用过，但没有任何内在的原因可以说明这是“坏的”。我只是想不出这种情况是绝对必要的。它确实使代码相当...不寻常，因此更难以理解和维护。

如果您确实在生产代码中找到了它的用途，请告诉我们。我很想看看它是什么。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-15T01:26:30.397

在我看来，它不可读，不可维护......应该避免任何类似的事情。想象一下，你加入了一家新公司，他们把你放在一大堆看起来像这样的 js/jquery 代码面前！！

PS你应该使用 addClass 来改变颜色。我宁愿更改一个 CSS 类，毕竟它是一个样式设置，并且更具可扩展性，因为您可以添加其他样式而无需任何更多的 js 代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-15T01:27:14.123

不，没什么奇怪的。如果有人/您去修改 p 元素中的 HTML，可能会出现一些不需要的结果。它的编码方式绝对很奇怪，但它并没有什么问题（除了不可读/不可维护）。

因为 jQuery 没有什么特别之处——它只是一个 Javascript 库。您没有使用一些特殊的 JS 语法或任何东西，jQuery 只是将一个字符串用作选择器。因此，可以以您认为合适的任何方式构造该字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-15T03:43:58.047

只是想知道 jQuery 中的一些黑魔法会在选择器中产生不需要的副作用。我发现自己需要的是在运行时将“搜索”字符串传递给选择器。

顺便说一句，jQuery 可以使用这种模式：

$('p[id=?]').click(paramValue, function() {}); paramValue 替换占位符 '?' ?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T18:07:38.250

Yep no reason you can't do this. Since `$` is actually a function call itself anything that needs to be evaluated in order to pass a parameter to it is evaluated first.

# security - 如何为本地开发和测试配置 IIS？

> ID：291941
> 
> 赞同：2
> 
> 时间：2008-11-15T01:18:52.847
> 
> 标签：security, iis

关于为本地开发配置 Apache 有几个问题，比如[这个](https://stackoverflow.com/questions/118423/set-up-apache-for-local-developmenttesting)，但是我没有看到任何关于 IIS 的内容。在不削弱其功能的情况下锁定 IIS 的建议？

作为对评论的回应，我希望使用 Windows XP Pro SP3（我相信是 IIS 5 或 6）附带的 IIS 服务器进行 ASP.NET 开发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-15T01:53:03.120

如果您使用 Visual Studio 进行 ASP.NET 开发，则不需要使用 IIS。Web 项目的默认配置是使用内置的 Web 服务器 webDev.WebServer.EXE

XP 中的 IIS 版本不太适合开发，因为它受到连接限制并且只允许一个站点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-15T01:51:24.637

如果您使用的是 Visual Studio .NET 2008（或 2005），他们有一个内置的 Web 服务器，它只会响应 localhost 请求......无需安装 IIS。那个封城怎么办？;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-15T12:12:13.573

XP 附带的 IIS 是 5.0，并将并发连接数限制为 10（我认为 - 有点低）。

封锁：

对于 IIS 开发，我认为只要您信任网络上的人并且您不接触互联网，您就不必担心本地开发的安全性。

但如果你真的很偏执，最好的方法是将它锁定在除了那台机器上的 peron 之外的所有人。正如 Odividiu 所说（第一个答案），您可以将 IIS 设置为仅侦听来自本地计算机（127.0.0.1）的请求。你可以这样做：

1) 开始->运行->%SystemRoot%\system32\inetsrv\iis.msc 2) 单击“默认网站” 3) 操作->属性 4) 将“IP 地址”更改为“127.0.0.1”并单击“应用” '。

# windows - 远程访问 SQL 2k8 实例有哪些不常见的问题？

> ID：291943
> 
> 赞同：1
> 
> 时间：2008-11-15T01:20:48.210
> 
> 标签：windows, sql-server-2008

你好……在我的本地局域网上，我有一个安装了 SQL Server 2k8 的 Windows Server 2k8 机器。我可以使用服务器上的 SSMS 工具连接到数据库引擎，但尝试从远程计算机（也在同一个 LAN 上）连接到数据库引擎，连接失败，并出现关于无法联系的常见通用消息服务器。

在您提供“常规”解决方案之前，请让我说我已经验证了实例名称，验证了实例配置为允许远程连接，验证了 SQL 浏览器服务正在运行，并且验证了 Windows 防火墙都没有打开服务器和客户端都妨碍了（测试完全禁用）。我什至尝试通过 LAN 上的服务器 IP 地址而不是 Windows 主机名进行连接。:)

有谁知道为什么我无法从远程机器连接到数据库引擎的任何“不常见”原因（甚至是我在这里没有提到的常见原因）？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-15T01:29:58.003

在网络配置-> 协议中的 SQL Server 配置管理器中，启用 TCP/IP 或您需要的其他协议。默认值为：仅共享内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-15T01:30:02.560

您提到您尝试在客户端和目标上都禁用 Windows 防火墙，但是在任一/两台机器上是否还运行病毒扫描程序？过去我曾发现病毒检查器也有一个完整的防火墙。

未能证明此[MS 论坛文章](http://forums.microsoft.com/TechNet/ShowPost.aspx?PostID=2669287&SiteID=17)包含要检查的事项列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-15T01:31:42.557

我会检查您是否在特定的 IPv6 地址上启用了远程连接，就好像您在本地网络上并从 Vista 进行连接一样，您可能正在通过 IPv6 进行连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-15T12:29:46.707

[http://blogs.msdn.com/sql_protocols/archive/2006/09/30/SQL-Server-2005-Remote-Connectivity-Issue-TroubleShooting.aspx](http://blogs.msdn.com/sql_protocols/archive/2006/09/30/SQL-Server-2005-Remote-Connectivity-Issue-TroubleShooting.aspx)

# python - 如何过滤 Django ModelForm 中的 ForeignKey 选择？

> ID：291945
> 
> 赞同：250
> 
> 时间：2008-11-15T01:21:33.277
> 
> 标签：python, django, django-forms

假设我的 中有以下内容`models.py`：

```
class Company(models.Model):
   name = ...

class Rate(models.Model):
   company = models.ForeignKey(Company)
   name = ...

class Client(models.Model):
   name = ...
   company = models.ForeignKey(Company)
   base_rate = models.ForeignKey(Rate) 
```

即有多个`Companies`，每个都有一个`Rates`和的范围`Clients`。每个都`Client`应该有一个`Rate`从它的 parent 中选择的 base ，而`Company's Rates`不是另一个base `Company's Rates`。

在创建用于添加的表单时`Client`，我想删除`Company`选项（因为已经通过`Company`页面上的“添加客户端”按钮选择了该选项）并将选项也限制为该`Rate`选项`Company`。

我如何在 Django 1.0 中解决这个问题？

我当前的`forms.py`文件目前只是样板文件：

```
from models import *
from django.forms import ModelForm

class ClientForm(ModelForm):
    class Meta:
        model = Client 
```

这`views.py`也是基本的：

```
from django.shortcuts import render_to_response, get_object_or_404
from models import *
from forms import *

def addclient(request, company_id):
    the_company = get_object_or_404(Company, id=company_id)

    if request.POST:
        form = ClientForm(request.POST)
        if form.is_valid():
            form.save()
            return HttpResponseRedirect(the_company.get_clients_url())
    else:
        form = ClientForm()

    return render_to_response('addclient.html', {'form': form, 'the_company':the_company}) 
```

在 Django 0.96 中，我可以通过在渲染模板之前执行以下操作来破解它：

```
manipulator.fields[0].choices = [(r.id,r.name) for r in Rate.objects.filter(company_id=the_company.id)] 
```

[`ForeignKey.limit_choices_to`](http://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ForeignKey.limit_choices_to)看起来很有希望，但我不知道如何通过，`the_company.id`而且我不清楚这是否会在管理界面之外工作。

谢谢。（这似乎是一个非常基本的要求，但如果我应该重新设计一些东西，我愿意接受建议。）

* * *

## 回答 #1

> 赞同：256
> 
> 时间：2008-11-15T01:39:26.003

ForeignKey 由 django.forms.ModelChoiceField 表示，它是一个 ChoiceField，其选择是一个模型 QuerySet。请参阅[ModelChoiceField](http://docs.djangoproject.com/en/dev/ref/forms/fields/#modelchoicefield)的参考。

`queryset`因此，为字段的属性提供一个 QuerySet 。取决于您的表单是如何构建的。如果您构建一个显式表单，您将拥有直接命名的字段。

```
form.rate.queryset = Rate.objects.filter(company_id=the_company.id) 
```

如果您采用默认的 ModelForm 对象，`form.fields["rate"].queryset = ...`

这是在视图中明确完成的。没有黑客攻击。

* * *

## 回答 #2

> 赞同：145
> 
> 时间：2009-08-07T13:01:38.733

除了 S.Lott 的回答和评论中提到的 becomeGuru 之外，还可以通过覆盖该`ModelForm.__init__`函数来添加查询集过滤器。（这可以很容易地应用于常规表单）它可以帮助重用并保持视图功能整洁。

```
class ClientForm(forms.ModelForm):
    def __init__(self,company,*args,**kwargs):
        super (ClientForm,self ).__init__(*args,**kwargs) # populates the post
        self.fields['rate'].queryset = Rate.objects.filter(company=company)
        self.fields['client'].queryset = Client.objects.filter(company=company)

    class Meta:
        model = Client

def addclient(request, company_id):
        the_company = get_object_or_404(Company, id=company_id)

        if request.POST:
            form = ClientForm(the_company,request.POST)  #<-- Note the extra arg
            if form.is_valid():
                form.save()
                return HttpResponseRedirect(the_company.get_clients_url())
        else:
            form = ClientForm(the_company)

        return render_to_response('addclient.html', 
                                  {'form': form, 'the_company':the_company}) 
```

如果您在许多模型上都需要通用过滤器（通常我声明一个抽象 Form 类），这对于重用很有用。例如

```
class UberClientForm(ClientForm):
    class Meta:
        model = UberClient

def view(request):
    ...
    form = UberClientForm(company)
    ...

#or even extend the existing custom init
class PITAClient(ClientForm):
    def __init__(company, *args, **args):
        super (PITAClient,self ).__init__(company,*args,**kwargs)
        self.fields['support_staff'].queryset = User.objects.exclude(user='michael') 
```

除此之外，我只是重述 Django 博客材料，其中有很多不错的。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2013-03-27T19:18:52.140

这很简单，适用于 Django 1.4：

```
class ClientAdminForm(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        super(ClientAdminForm, self).__init__(*args, **kwargs)
        # access object through self.instance...
        self.fields['base_rate'].queryset = Rate.objects.filter(company=self.instance.company)

class ClientAdmin(admin.ModelAdmin):
    form = ClientAdminForm
    .... 
```

您不需要在表单类中指定它，但可以直接在 ModelAdmin 中进行，因为 Django 已经在 ModelAdmin 中包含了这个内置方法（来自文档）：

```
ModelAdmin.formfield_for_foreignkey(self, db_field, request, **kwargs)¶
'''The formfield_for_foreignkey method on a ModelAdmin allows you to 
   override the default formfield for a foreign keys field. For example, 
   to return a subset of objects for this foreign key field based on the
   user:'''

class MyModelAdmin(admin.ModelAdmin):
    def formfield_for_foreignkey(self, db_field, request, **kwargs):
        if db_field.name == "car":
            kwargs["queryset"] = Car.objects.filter(owner=request.user)
        return super(MyModelAdmin, self).formfield_for_foreignkey(db_field, request, **kwargs) 
```

一种更好的方法（例如创建用户可以访问的前端管理界面）是继承 ModelAdmin，然后更改下面的方法。最终结果是一个用户界面，它只向他们显示与他们相关的内容，同时允许您（超级用户）查看所有内容。

我已经覆盖了四种方法，前两种使用户无法删除任何内容，并且它还从管理站点中删除了删除按钮。

第三个覆盖过滤任何包含引用的查询（在示例中为“用户”或“豪猪”（仅作为说明）。

最后一个覆盖过滤模型中的任何外键字段，以过滤与基本查询集相同的可用选项。

通过这种方式，您可以呈现一个易于管理的前端管理站点，允许用户处理他们自己的对象，并且您不必记住输入我们上面讨论的特定 ModelAdmin 过滤器。

```
class FrontEndAdmin(models.ModelAdmin):
    def __init__(self, model, admin_site):
        self.model = model
        self.opts = model._meta
        self.admin_site = admin_site
        super(FrontEndAdmin, self).__init__(model, admin_site) 
```

删除“删除”按钮：

```
 def get_actions(self, request):
        actions = super(FrontEndAdmin, self).get_actions(request)
        if 'delete_selected' in actions:
            del actions['delete_selected']
        return actions 
```

阻止删除权限

```
 def has_delete_permission(self, request, obj=None):
        return False 
```

过滤可以在管理站点上查看的对象：

```
 def get_queryset(self, request):
        if request.user.is_superuser:
            try:
                qs = self.model.objects.all()
            except AttributeError:
                qs = self.model._default_manager.get_queryset()
            return qs

        else:
            try:
                qs = self.model.objects.all()
            except AttributeError:
                qs = self.model._default_manager.get_queryset()

            if hasattr(self.model, ‘user’):
                return qs.filter(user=request.user)
            if hasattr(self.model, ‘porcupine’):
                return qs.filter(porcupine=request.user.porcupine)
            else:
                return qs 
```

过滤管理站点上所有外键字段的选择：

```
 def formfield_for_foreignkey(self, db_field, request, **kwargs):
        if request.employee.is_superuser:
            return super(FrontEndAdmin, self).formfield_for_foreignkey(db_field, request, **kwargs)

        else:
            if hasattr(db_field.rel.to, 'user'):
                kwargs["queryset"] = db_field.rel.to.objects.filter(user=request.user)
            if hasattr(db_field.rel.to, 'porcupine'):
                kwargs["queryset"] = db_field.rel.to.objects.filter(porcupine=request.user.porcupine)
            return super(ModelAdminFront, self).formfield_for_foreignkey(db_field, request, **kwargs) 
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2012-04-15T03:53:42.927

要使用通用视图执行此操作，例如 CreateView...

```
class AddPhotoToProject(CreateView):
    """
    a view where a user can associate a photo with a project
    """
    model = Connection
    form_class = CreateConnectionForm

    def get_context_data(self, **kwargs):
        context = super(AddPhotoToProject, self).get_context_data(**kwargs)
        context['photo'] = self.kwargs['pk']
        context['form'].fields['project'].queryset = Project.objects.for_user(self.request.user)
        return context
    def form_valid(self, form):
        pobj = Photo.objects.get(pk=self.kwargs['pk'])
        obj = form.save(commit=False)
        obj.photo = pobj
        obj.save()

        return_json = {'success': True}

        if self.request.is_ajax():

            final_response = json.dumps(return_json)
            return HttpResponse(final_response)

        else:

            messages.success(self.request, 'photo was added to project!')
            return HttpResponseRedirect(reverse('MyPhotos')) 
```

其中最重要的部分...

```
 context['form'].fields['project'].queryset = Project.objects.for_user(self.request.user) 
```

，[在这里阅读我的帖子](http://gravitymad.com/blog/2012/4/14/how-filter-django-forms-multiple-choice-or-foreign/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-08-08T22:11:15.180

如果您尚未创建表单并想要更改查询集，您可以执行以下操作：

```
formmodel.base_fields['myfield'].queryset = MyModel.objects.filter(...) 
```

当您使用通用视图时，这非常有用！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-10-23T00:45:59.070

所以，我真的试图理解这一点，但似乎 Django 仍然没有让这变得非常简单。我并不是那么愚蠢，但我只是看不到任何（有点）简单的解决方案。

我发现必须为这类事情覆盖管理视图通常非常难看，而且我发现的每个示例都从未完全适用于管理视图。

这是我制作的模型的常见情况，我发现没有明显的解决方案令人震惊......

我有这些课程：

```
# models.py
class Company(models.Model):
    # ...
class Contract(models.Model):
    company = models.ForeignKey(Company)
    locations = models.ManyToManyField('Location')
class Location(models.Model):
    company = models.ForeignKey(Company) 
```

这在为公司设置管理员时会产生问题，因为它具有合同和位置的内联，并且合同的位置 m2m 选项没有根据您当前正在编辑的公司正确过滤。

简而言之，我需要一些管理员选项来执行以下操作：

```
# admin.py
class LocationInline(admin.TabularInline):
    model = Location
class ContractInline(admin.TabularInline):
    model = Contract
class CompanyAdmin(admin.ModelAdmin):
    inlines = (ContractInline, LocationInline)
    inline_filter = dict(Location__company='self') 
```

最终，我不会关心过滤过程是放在基础 CompanyAdmin 上，还是放在 ContractInline 上。（将它放在内联更有意义，但很难将基本 Contract 引用为“self”。）

有没有人知道像这条急需的捷径一样简单的事情？当我为这类事情做 PHP 管理员时，这被认为是基本功能！事实上，它总是自动的，如果你真的不想要它就必须禁用它！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-17T05:42:37.837

更公开的方式是在 Admin 类中调用 get_form 。它也适用于非数据库字段。例如，我在表单上有一个名为“_terminal_list”的字段，可在特殊情况下用于从 get_list(request) 中选择多个终端项目，然后根据 request.user 进行过滤：

```
class ChangeKeyValueForm(forms.ModelForm):  
    _terminal_list = forms.ModelMultipleChoiceField( 
queryset=Terminal.objects.all() )

    class Meta:
        model = ChangeKeyValue
        fields = ['_terminal_list', 'param_path', 'param_value', 'scheduled_time',  ] 

class ChangeKeyValueAdmin(admin.ModelAdmin):
    form = ChangeKeyValueForm
    list_display = ('terminal','task_list', 'plugin','last_update_time')
    list_per_page =16

    def get_form(self, request, obj = None, **kwargs):
        form = super(ChangeKeyValueAdmin, self).get_form(request, **kwargs)
        qs, filterargs = Terminal.get_list(request)
        form.base_fields['_terminal_list'].queryset = qs
        return form 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-18T13:09:43.953

在运行时（例如在 CreateView 中）限制 ModelForm 的 ForeignKey 字段的选择的一个好方法是通过在视图中`limit_choices_to`覆盖`base_fields['field_name']`来设置。`get_form_class()`

例如，在创建客户端时，将 Rate 选项限制为 URL 中标识的 Company 选项：

```
class ClientCreateView(LoginRequired, CreateView):
    model = Client
    fields = '__all__'

    def get_form_class(self):
        modelform = super().get_form_class()
        modelform.base_fields['rate'].limit_choices_to = {'company': self.kwargs['company']}
        return modelform 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2021-04-04T20:56:03.127

根据 Django 文档，您可以使用`__init__`模型表单的方法将过滤器应用于默认查询集。

[https://docs.djangoproject.com/en/3.1/ref/contrib/admin/#django.contrib.admin.ModelAdmin.formfield_for_foreignkey](https://docs.djangoproject.com/en/3.1/ref/contrib/admin/#django.contrib.admin.ModelAdmin.formfield_for_foreignkey)

```
class CountryAdminForm(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.fields['capital'].queryset = self.instance.cities.all()

class CountryAdmin(admin.ModelAdmin):
    form = CountryAdminForm 
```

# asp.net - 如何在模板化的 FormView 中使用 TabContainer 控件？

> ID：291946
> 
> 赞同：0
> 
> 时间：2008-11-15T01:22:52.323
> 
> 标签：asp.net, formview

是否可以在模板化的 FormView 中使用 TabContainer，如下所示：

```
 <ItemTemplate>
            <cc1:TabContainer ID="TabContainer1" runat="server">
                <cc1:TabPanel ID="Tab1" runat="server">
                    <HeaderTemplate>Tab One</HeaderTemplate>
                    <ContentTemplate>
                    ... bound fields  
                    </ContentTemplate>
                </cc1:TabPanel>
                <cc1:TabPanel ID="Tab2" runat="server">
                    <HeaderTemplate>Tab 2</HeaderTemplate>
                    <ContentTemplate>
                    ... bound fields    
                    </ContentTemplate>
                </cc1:TabPanel>
            </cc1:TabContainer>
        </ItemTemplate>

        <EditTemplate>
            <cc1:TabContainer ID="TabContainer1" runat="server">
                <cc1:TabPanel ID="Tab1" runat="server">
                    <HeaderTemplate>Tab One</HeaderTemplate>
                    <ContentTemplate>
                    ... bound fields  
                    </ContentTemplate>
                </cc1:TabPanel>
                <cc1:TabPanel ID="Tab2" runat="server">
                    <HeaderTemplate>Tab 2</HeaderTemplate>
                    <ContentTemplate>
                    ... bound fields    
                    </ContentTemplate>
                </cc1:TabPanel>
            </cc1:TabContainer>
        </EditTemplate> 
```

一次只有一个模板视图一切正常；例如，如果 ItemTemplate 工作，那么 EditTemplate 不会。ASP.NET 将抱怨重复的绑定字段 ID。

有没有人试过做我想做的事？

谢谢。-基因

编辑 ：

*我不认为具有相同 ID 的选项卡容器是这里的问题，因为它们都位于单独的模板元素中，并且一次只呈现一个模板。*

更新：

*我没有设法找到解决方案，我认为这是不可能的。所以，继续前进并使用唯一 ID。懒惰，我写了一些代码来自动化可怕的命名过程。我希望那里有人有更好的答案来分享。无论如何，我太穷了，买不起赏金。*;-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-15T01:55:21.853

没有太多使用 Tab 容器，但您需要为页面上的每个元素定义唯一 ID。

```
<cc1:TabContainer ID="TabContainer1" runat="server">
<cc1:TabContainer ID="TabContainer2" runat="server"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T17:19:21.437

我通过更改每个选项卡中的重复字段名称来解决这个问题。

# emacs - Elisp中绝对路径的相对路径

> ID：291976
> 
> 赞同：20
> 
> 时间：2008-11-15T01:46:49.250
> 
> 标签：emacs, elisp

有一个相对路径，我如何将它从我正在加载的 elisp 文件所在的位置变成一个绝对路径。也就是说，我有一个正在加载的 elisp 文件，它有一个相对路径，我需要一个绝对路径。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-15T05:06:50.860

```
'file-truename 
```

从文档中：

> 返回 FILENAME 的真实名称，它应该是绝对的。文件名的真名是通过在文件级别和包含它的目录级别上跟踪符号链接来找到的，直到在任何级别都没有链接。

提供的另一个解决方案 ('expand-file-name) 保留符号链接，这可能是也可能不是您想要的。'file-truename 使用 'expand-file-name，因此它们都将确定缓冲区的路径相对默认目录（这是您所要求的）。

在看到不同答案的评论/问题后，问题是默认目录是调用'load.txt'的缓冲区的目录。

幸运的是，有一个“加载集”变量存储了正在加载的文件的路径。试试这段代码：

```
;; this is in the file being loaded
(let ((default-directory (file-name-directory load-file-name)))
   (file-truename "blih")) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-15T02:41:56.127

我最终使用：

```
(expand-file-name "relative/path" (file-name-directory load-file-name)) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-15T02:03:32.570

您可以使用该`expand-file-name`函数将相对文件名或路径转换为绝对文件名/路径。[在这里](https://www.gnu.org/software/emacs/manual/html_node/elisp/File-Name-Expansion.html#File-Name-Expansion)查看更多信息。

# python - 范围规则的简短描述？

> ID：291978
> 
> 赞同：503
> 
> 时间：2008-11-15T01:48:37.623
> 
> 标签：python, scope, dynamic-languages

Python 作用域规则**到底**是什么？

如果我有一些代码：

```
code1
class Foo:
   code2
   def spam.....
      code3
      for code4..:
       code5
       x() 
```

在哪里`x`找到？一些可能的选择包括以下列表：

1.  在封闭的源文件中
2.  在类命名空间中
3.  在函数定义中
4.  在 for 循环索引变量中
5.  在 for 循环内部

`spam`当函数被传递到其他地方时，执行期间也有上下文。也许[lambda 函数](https://docs.python.org/3/tutorial/controlflow.html#lambda-expressions)的传递有点不同？

某处必须有一个简单的参考或算法。对于中级 Python 程序员来说，这是一个令人困惑的世界。

* * *

## 回答 #1

> 赞同：438
> 
> 时间：2008-11-15T12:47:22.537

实际上，Python Scope 解析的简明规则，来自[Learning Python，3rd。埃德。](https://rads.stackoverflow.com/amzn/click/com/0596513984). （这些规则特定于变量名称，而不是属性。如果您引用它时没有句点，则这些规则适用。）

**LEGB 规则**

*   **本地**`def`- 在函数（或）内以任何方式分配的名称`lambda`，并且未在该函数中声明为全局的

*   **封闭**函数 - 在任何和所有静态封闭函数（`def`或`lambda`）的局部范围内分配的名称，从内部到外部

*   **全局**（模块）- 在模块文件的顶层分配的名称，或通过在文件中执行`global`语句`def`

*   **内置**(Python) — 在内置名称模块中预先分配的名称：`open`、`range`、`SyntaxError`等

所以，在

```
code1
class Foo:
    code2
    def spam():
        code3
        for code4:
            code5
            x() 
```

`for`循环没有自己的命名空间。按照 LEGB 顺序，范围将是

*   L: 局部于`def spam`(in `code3`, `code4`, and `code5`)
*   E：任何封闭函数（如果整个例子在另一个`def`）
*   G：`x`模块（in `code1`）中是否有任何全局声明？
*   `x`B: Python 中的任何内置函数。

`x`永远不会被发现`code2`（即使在您可能期望的情况下，请参阅[Antti 的答案](https://stackoverflow.com/a/23471004/2810305)或[此处](https://stackoverflow.com/q/13905741/2810305)）。

* * *

## 回答 #2

> 赞同：158
> 
> 时间：2008-11-15T21:51:09.800

本质上，Python 中唯一引入新作用域的是函数定义。类有点特殊，因为直接在主体中定义的任何内容都放置在类的命名空间中，但不能从它们包含的方法（或嵌套类）中直接访问它们。

在您的示例中，只有 3 个范围将在其中搜索 x：

*   垃圾邮件的范围 - 包含在 code3 和 code5 中定义的所有内容（以及 code4，您的循环变量）

*   全局范围 - 包含 code1 中定义的所有内容，以及 Foo（以及之后的任何更改）

*   内置命名空间。有点特例——它包含各种 Python 内置函数和类型，例如 len() 和 str()。通常这不应该被任何用户代码修改，所以期望它包含标准函数而不是其他任何东西。

仅当您将嵌套函数（或 lambda）引入图片时，才会出现更多范围。但是，它们的行为与您预期的差不多。嵌套函数可以访问本地范围内的所有内容，以及封闭函数范围内的任何内容。例如。

```
def foo():
    x=4
    def bar():
        print x  # Accesses x from foo's scope
    bar()  # Prints 4
    x=5
    bar()  # Prints 5 
```

**限制：**

可以访问除局部函数变量之外的范围内的变量，但如果没有进一步的语法，则不能将其重新绑定到新参数。相反，赋值将创建一个新的**局部**变量，而不是影响父作用域中的变量。例如：

```
global_var1 = []
global_var2 = 1

def func():
    # This is OK: It's just accessing, not rebinding
    global_var1.append(4) 

    # This won't affect global_var2\. Instead it creates a new variable
    global_var2 = 2 

    local1 = 4
    def embedded_func():
        # Again, this doen't affect func's local1 variable.  It creates a 
        # new local variable also called local1 instead.
        local1 = 5
        print local1

    embedded_func() # Prints 5
    print local1    # Prints 4 
```

为了从函数范围内实际修改全局变量的绑定，您需要使用 global 关键字指定变量是全局的。例如：

```
global_var = 4
def change_global():
    global global_var
    global_var = global_var + 1 
```

目前还没有办法对封闭*函数*作用域中的变量做同样的事情，但是 Python 3 引入了一个新关键字“ `nonlocal`”，它的作用类似于全局，但用于嵌套函数作用域。

* * *

## 回答 #3

> 赞同：114
> 
> 时间：2014-05-05T11:08:54.970

关于Python3时间没有彻底的答案，所以我在这里做了一个回答。此处描述的大部分内容在 Python 3 文档的[4.2.2 名称解析中有详细说明。](https://docs.python.org/3/reference/executionmodel.html#resolution-of-names)

正如其他答案中所提供的，有 4 个基本范围，即 LEGB，用于本地、封闭、全局和内置。除此之外，还有一个特殊的范围，即**类主体**，它不包含在类中定义的方法的封闭范围；类体内的任何赋值都会使变量从那里绑定到类体内。

特别是，除了and之外，**没有**块语句创建变量范围。在 Python 2 中，列表推导式不会创建变量作用域，但在 Python 3 中，列表推导式中的循环变量是在新作用域中创建的。`def``class`

展示班体的特殊性

```
x = 0
class X(object):
    y = x
    x = x + 1 # x is now a variable
    z = x

    def method(self):
        print(self.x) # -> 1
        print(x)      # -> 0, the global x
        print(y)      # -> NameError: global name 'y' is not defined

inst = X()
print(inst.x, inst.y, inst.z, x) # -> (1, 0, 1, 0) 
```

因此与函数体不同，你可以在类体中将变量重新分配给同名的变量，以获得同名的类变量；对此名称的进一步查找将解析为类变量。

* * *

对于 Python 的许多新手来说，最大的惊喜之一是`for`循环不会创建变量范围。在 Python 2 中，列表推导式也不会创建范围（而生成器和字典推导式可以！）相反，它们会泄漏函数或全局范围内的值：

```
>>> [ i for i in range(5) ]
>>> i
4 
```

在 Python 2 的 lambda 表达式中，推导式可以用作一种狡猾的（或者如果你愿意的话，也可以是糟糕的）方法来创建可修改的变量——一个 lambda 表达式确实创建了一个变量范围，就像`def`语句一样，但在 lambda 中不允许使用任何语句。赋值是 Python 中的语句意味着不允许在 lambda 中进行变量赋值，但列表推导是一个表达式......

此行为已在 Python 3 中修复 - 没有理解表达式或生成器泄漏变量。

* * *

全局真正意味着模块范围；主要的python模块是`__main__`；所有导入的模块都可以通过`sys.modules`变量访问；访问`__main__`一个可以使用`sys.modules['__main__']`的，或`import __main__`；在那里访问和分配属性是完全可以接受的；它们将在主模块的全局范围内显示为变量。

* * *

如果在当前范围内（类范围除外）分配了名称，则将其视为属于该范围，否则将视为属于分配给变量的任何封闭范围（可能未分配）然而，或者根本没有），或者最后是全局范围。如果变量被认为是本地的，但尚未设置，或者已被删除，则读取变量值将导致`UnboundLocalError`，它是 的子类`NameError`。

```
x = 5
def foobar():
    print(x)  # causes UnboundLocalError!
    x += 1    # because assignment here makes x a local variable within the function

# call the function
foobar() 
```

作用域可以使用 global 关键字声明它显式地想要修改全局（模块作用域）变量：

```
x = 5
def foobar():
    global x
    print(x)
    x += 1

foobar() # -> 5
print(x) # -> 6 
```

即使它在封闭范围内被遮蔽，这也是可能的：

```
x = 5
y = 13
def make_closure():
    x = 42
    y = 911
    def func():
        global x # sees the global value
        print(x, y)
        x += 1

    return func

func = make_closure()
func()      # -> 5 911
print(x, y) # -> 6 13 
```

在 python 2 中，没有简单的方法可以修改封闭范围内的值；通常这是通过具有可变值来模拟的，例如长度为 1 的列表：

```
def make_closure():
    value = [0]
    def get_next_value():
        value[0] += 1
        return value[0]

    return get_next_value

get_next = make_closure()
print(get_next()) # -> 1
print(get_next()) # -> 2 
```

然而在 python 3 中，`nonlocal`来救援：

```
def make_closure():
    value = 0
    def get_next_value():
        nonlocal value
        value += 1
        return value
    return get_next_value

get_next = make_closure() # identical behavior to the previous example. 
```

[`nonlocal`文件](https://docs.python.org/3/reference/simple_stmts.html#the-nonlocal-statement)说_

> 与 global 语句中列出的名称不同，在 nonlocal 语句中列出的名称必须引用封闭范围中的预先存在的绑定（无法明确确定应创建新绑定的范围）。

ie`nonlocal`总是指名称已绑定的最内层外部非全局范围（即分配给，包括用作`for`目标变量、在`with`子句中或作为函数参数）。

* * *

任何不被视为当前作用域或任何封闭作用域的局部变量都是全局变量。在模块全局字典中查找全局名称；如果未找到，则从内置模块中查找全局；模块名称从 python 2 更改为 python 3；在 python 2 中它是`__builtin__`，在 python 3 中它现在被称为`builtins`. 如果您分配给内置模块的属性，则此后任何模块都可以将其作为可读的全局变量可见，除非该模块使用其自己的同名全局变量来隐藏它们。

* * *

阅读内置模块也很有用；假设您希望文件的某些部分使用 python 3 样式的打印功能，但文件的其他部分仍然使用该`print`语句。在 Python 2.6-2.7 中，您可以通过以下方式获取 Python 3`print`函数：

```
import __builtin__

print3 = __builtin__.__dict__['print'] 
```

`from __future__ import print_function`实际上并没有在 Python 2 中的任何地方导入该函数- 相反，它只是禁用当前模块`print`中语句的解析规则，像任何其他变量标识符一样处理，从而允许在内置函数中查找该函数。`print``print``print`

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2015-12-04T17:38:37.673

一个稍微完整的范围示例：

```
from __future__ import print_function  # for python 2 support

x = 100
print("1\. Global x:", x)
class Test(object):
    y = x
    print("2\. Enclosed y:", y)
    x = x + 1
    print("3\. Enclosed x:", x)

    def method(self):
        print("4\. Enclosed self.x", self.x)
        print("5\. Global x", x)
        try:
            print(y)
        except NameError as e:
            print("6.", e)

    def method_local_ref(self):
        try:
            print(x)
        except UnboundLocalError as e:
            print("7.", e)
        x = 200 # causing 7 because has same name
        print("8\. Local x", x)

inst = Test()
inst.method()
inst.method_local_ref() 
```

输出：

```
1\. Global x: 100
2\. Enclosed y: 100
3\. Enclosed x: 101
4\. Enclosed self.x 101
5\. Global x 100
6\. global name 'y' is not defined
7\. local variable 'x' referenced before assignment
8\. Local x 200 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2008-11-15T18:52:49.257

Python 2.x 的范围规则已经在其他答案中进行了概述。我唯一要补充的是，在 Python 3.0 中，还有一个非本地范围的概念（由“非本地”关键字表示）。这允许您直接访问外部范围，并打开了执行一些巧妙技巧的能力，包括词法闭包（没有涉及可变对象的丑陋黑客）。

编辑：这是[PEP](http://www.python.org/dev/peps/pep-3104/)，其中包含更多信息。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2008-11-15T02:03:38.967

Python 通常使用三个可用的命名空间来解析您的变量。

> 在执行过程中的任何时候，至少有三个嵌套作用域的命名空间是可以直接访问的：最内层的作用域，首先被搜索，包含本地名称；任何封闭函数的命名空间，从最近的封闭范围开始搜索；接下来搜索的中间范围包含当前模块的全局名称；最外层范围（最后搜索）是包含内置名称的命名空间。

有两个函数：它们向您显示`globals`其中`locals`两个命名空间的内容。

命名空间由包、模块、类、对象构造和函数创建。没有任何其他风格的命名空间。

`x`在这种情况下，必须在本地名称空间或全局名称空间中解析对命名函数的调用。

在这种情况下，本地是方法函数的主体`Foo.spam`。

全球是——嗯——是全球性的。

规则是搜索方法函数（和嵌套函数定义）创建的嵌套局部空间，然后搜索全局。就是这样。

没有其他范围。该`for`语句（和其他复合语句，如`if`and `try`）不会创建新的嵌套范围。只有定义（包、模块、函数、类和对象实例。）

在类定义中，名称是类命名空间的一部分。 `code2`例如，必须由类名限定。一般`Foo.code2`。但是，`self.code2`也可以使用，因为 Python 对象将包含类视为后备。

对象（类的实例）具有实例变量。这些名称位于对象的命名空间中。它们必须由对象限定。( `variable.instance`.)

在类方法中，您有局部变量和全局变量。你说`self.variable`选择实例作为命名空间。您会注意到这`self`是每个类成员函数的参数，使其成为本地命名空间的一部分。

请参阅[Python 范围规则](http://www.network-theory.co.uk/docs/pytut/PythonScopesandNameSpaces.html)、[Python 范围](https://stackoverflow.com/questions/146359/python-scope)、[变量范围](http://showmedo.com/videos/video?name=2800020&fromSeriesID=280)。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-11-15T12:44:59.920

> x 在哪里找到？

x 未找到，因为您尚未定义它。:-) 如果你把它放在那里，它可以在 code1 （全局）或 code3 （本地）中找到。

code2（类成员）对同一类的方法内部的代码不可见——您通常会使用 self. code4/code5（循环）与code3在同一个范围内，所以如果你在那里写x，你将改变code3中定义的x实例，而不是创建一个新的x。

Python 是静态作用域的，所以如果你将“spam”传递给另一个函数，spam 仍然可以访问它来自的模块中的全局变量（在 code1 中定义），以及任何其他包含作用域（见下文）。code2 成员将再次通过 self 访问。

lambda 与 def 没有什么不同。如果您在函数内部使用了 lambda，则与定义嵌套函数相同。从 Python 2.2 开始，可以使用嵌套范围。在这种情况下，您可以在任何级别的函数嵌套上绑定 x，Python 将选择最里面的实例：

```
x= 0
def fun1():
    x= 1
    def fun2():
        x= 2
        def fun3():
            return x
        return fun3()
    return fun2()
print fun1(), x

2 0 
```

fun3 从最近的包含范围（即与 fun2 关联的函数范围）中看到实例 x。但是在 fun1 和 global 中定义的其他 x 实例不受影响。

在 nested_scopes 之前——在 Python pre-2.1 和 2.1 中，除非你特别要求使用 from-future-import 的功能——fun1 和 fun2 的范围对 fun3 不可见，所以 S.Lott 的答案成立，你会得到全局 x ：

```
0 0 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-06-14T22:49:32.620

[Python 名称解析](https://docs.python.org/3/reference/executionmodel.html#resolution-of-names)只知道以下几种范围：

1.  [提供内置函数](https://docs.python.org/3/library/functions.html#built-in-funcs)的内置范围，例如`print`, `int`, 或`zip`,
2.  *模块*全局范围，始终是当前模块的顶层，
3.  三个可以相互嵌套的用户定义范围，即
    1.  *函数*闭包范围，来自任何封闭`def`块、`lambda`表达式或理解。
    2.  *函数*局部作用域，在`def`块、`lambda`表达式或理解内，
    3.  *类*范围，在一个`class`块内。

值得注意的是，诸如 、 或 语句之类的其他结构`if`没有`for`自己`with`的范围。

**作用域 TLDR**：名称的*查找*从使用名称的作用域开始，然后是任何封闭作用域（不包括类作用域），到模块全局变量，最后是内置函数——使用此搜索顺序中的第一个匹配项。默认情况下，对范围的*分配*是对当前范围的特殊形式`nonlocal`，并且`global`必须用于从外部范围*分配给名称。*

最后，推导式和生成器表达式以及`:=`赋值表达式在组合时有一个特殊的规则。

* * *

### 嵌套范围和名称解析

这些不同的作用域构建了一个层次结构，内置函数和全局函数始终构成基础，闭包、局部变量和类作用域按照*词法*定义嵌套。也就是说，只有源代码中的嵌套很重要，例如调用堆栈。

```
print("builtins are available without definition")

some_global = "1"  # global variables are at module scope

def outer_function():
    some_closure = "3.1"  # locals and closure are defined the same, at function scope
    some_local = "3.2"    # a variable becomes a closure if a nested scope uses it

    class InnerClass:
         some_classvar = "3.3"   # class variables exist *only* at class scope

         def nested_function(self):
             some_local = "3.2"   # locals can replace outer names
             print(some_closure)  # closures are always readable
    return InnerClass 
```

即使`class`创建了一个作用域并且可能有嵌套的类、函数和理解，作用域的名称`class`对封闭的作用域也是不可见的。这将创建以下层次结构：

```
┎ builtins           [print, ...]
┗━┱ globals            [some_global]
  ┗━┱ outer_function     [some_local, some_closure]
    ┣━╾ InnerClass         [some_classvar]
    ┗━╾ inner_function     [some_local] 
```

名称解析总是从访问名称的*当前作用域*开始，然后沿着层次结构向上直到找到匹配项。例如，查找`some_local`内部`outer_function`并`inner_function`从相应的函数开始 - 并立即分别找到`some_local`定义在`outer_function`和`inner_function`中。当名称不是本地名称时，它会从定义它的最近的封闭范围中获取 - 分别查找`some_closure`和`print`内部`inner_function`搜索直到`outer_function`和内置。

* * *

### 范围声明和名称绑定

默认情况下，名称属于它绑定到值的任何范围。在内部范围内再次绑定相同的名称会创建一个具有相同名称的新变量 - 例如，`some_local`分别存在于`outer_function`和`inner_function`中。就作用域而言，绑定包括任何设置名称值的语句——赋值语句，还包括循环的迭代变量`for`或`with`上下文管理器的名称。值得注意的是，`del`也算作名称绑定。

当名称必须引用外部变量*并*绑定在内部范围内时，必须将名称声明为非本地的。不同类型的封闭作用域存在单独的声明：`nonlocal`总是指最近的闭包，`global`总是指全局名称。值得注意的是，`nonlocal`从不引用全局名称并`global`忽略所有同名的闭包。没有声明引用内置范围。

```
 some_global = "1"

def outer_function():
    some_closure = "3.2"
    some_global = "this is ignored by a nested global declaration"

    def inner_function():
        global some_global     # declare variable from global scope
        nonlocal some_closure  # declare variable from enclosing scope
        message = " bound by an inner scope"
        some_global = some_global + message
        some_closure = some_closure + message
    return inner_function 
```

值得注意的是该函数是本地的并且`nonlocal`在编译时被解析。`nonlocal`名称*必须*存在于某个外部范围内。相反，`global`名称可以动态定义，并且可以随时从全局范围添加或删除。

* * *

### 理解和赋值表达式

list、set 和 dict 推导以及生成器表达式的作用域规则*几乎*与函数相同。同样，赋值表达式的作用域规则与常规名称绑定*几乎*相同。

推导式和生成器表达式的范围与函数范围相同。范围内绑定的所有名称，即迭代变量，都是理解/生成器和嵌套范围的局部变量或闭包。所有名称，包括可迭代对象，都使用函数内部适用的名称解析来解析。

```
some_global = "global"

def outer_function():
    some_closure = "closure"
    return [            # new function-like scope started by comprehension
        comp_local      # names resolved using regular name resolution
        for comp_local  # iteration targets are local
        in "iterable"
        if comp_local in some_global and comp_local in some_global
    ] 
```

`:=`赋值表达式适用于最近的函数、类或全局范围。值得注意的是，如果赋值表达式的目标已被声明`nonlocal`或`global`在最近的范围内，则赋值表达式会像常规赋值一样尊重它。

```
print(some_global := "global")

def outer_function():
    print(some_closure := "closure") 
```

但是，理解/生成器中的赋值表达式在理解/生成器最近的*封闭范围内*起作用，而不是在理解/生成器本身的范围内。当嵌套了多个推导/生成器时，使用最近的函数或全局范围。由于理解/生成器范围可以读取闭包和全局变量，因此赋值变量在理解中也是可读的。从理解分配到类范围是无效的。

```
print(some_global := "global")

def outer_function():
    print(some_closure := "closure")
    steps = [
        # v write to variable in containing scope
        (some_closure := some_closure + comp_local)
        #                 ^ read from variable in containing scope
        for comp_local in some_global
    ]
    return some_closure, steps 
```

虽然迭代变量对于它所绑定的推导来说是局部的，但赋值表达式的目标不会创建局部变量，而是从外部范围读取：

```
┎ builtins           [print, ...]
┗━┱ globals            [some_global]
  ┗━┱ outer_function     [some_closure]
    ┗━╾ <listcomp>         [comp_local] 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-05-12T22:27:43.957

在 Python 中，

> 任何被赋值的变量对于出现赋值的块都是局部的。

如果在当前范围内找不到变量，请参考 LEGB 命令。

# .net - 如何从托管 IronPython 访问内部对象？

> ID：291996
> 
> 赞同：2
> 
> 时间：2008-11-15T01:58:43.390
> 
> 标签：.net, ironpython

我在 C#/Winforms 应用程序中托管 IronPython 2.0。我希望 Python 能够访问主机应用程序中的各种全局静态对象。

例如，宿主应用程序有一个内部静态类“全局”，其中包含许多静态公共成员，它们是我想要访问的各种全局对象：

```
static class Global
{
  public static FeederSystem Feed ...
  public static LightingSystem Lighting ...
  public static IOSystem Io ...
  ... etc
} 
```

我希望能够在 Python 代码中引用 Global.Lighting.xxx，就像在 C# 应用程序中一样。

是否有一个 IronPythonic 等效于“InternalsVisibleTo”，我可以使用它来允许 Python 代码查看主机应用程序的内部类型？还是我需要将它们全部公开？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-15T02:53:19.927

好的，所以我在 DLR 规范的帮助下自己解决了这个问题，从这里[https://github.com/IronLanguages/dlr/blob/master/Docs/dlr-spec-hosting.pdf](https://github.com/IronLanguages/dlr/blob/master/Docs/dlr-spec-hosting.pdf)并通过查看 IP /DLR 源。

这不是很优雅，并且使用具有 PrivateBinding 属性集 True 的 ScriptRuntimeSetup 对象可能比使用 CreateEngine 更简洁。

但这一个有效：

```
Dictionary<string, object> options = new Dictionary<string, object>();
options.Add("PrivateBinding", true);

_engine = Python.CreateEngine(options); 
```***********