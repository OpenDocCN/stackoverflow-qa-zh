# StackOverflow 问答 10210000-10210999

# remote-debugging - 如何让 `callFrameID` 传递给 `Debugger.evaluateOnCallFrame`？

> ID：10210003
> 
> 赞同：3
> 
> 时间：2012-04-18T13:06:19.773
> 
> 标签：remote-debugging, google-chrome-devtools

WebKit 的远程调试协议最近发布了 1.0，我一直在玩弄它，主要是出于好奇和兴趣。我已经将 Chrome 的开发者工具控制台的一个非常基本的重新创建组合在一起作为替代前端，但是对于如何在特定的框架/窗口中执行代码（如 Chrome 的开发工具允许你）我有点困惑。

目前，我正在使用该`Runtime.evaluate`方法来执行我的控制台输入。由于上述问题，这似乎不足，并且它不提供命令行 API。我发现了[*Debugger.evaluateOnCallFrame*方法](https://developers.google.com/chrome-developer-tools/docs/protocol/tot/debugger#command-evaluateOnCallFrame)，它需要一个`callFrameID`参数。唯一的问题是，似乎不可能远程获取`callFrame`要传递给此方法的对象列表。

我有一种感觉，我在这里完全错过了一些东西。有谁知道解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T13:14:48.770

查看[Debugger.paused](https://developers.google.com/chrome-developer-tools/docs/protocol/tot/debugger#event-paused)事件，它将为您提供当前调用帧的数组。

# c# - 就性能而言，在 C# 中解析 XML 的最佳方法

> ID：10210004
> 
> 赞同：3
> 
> 时间：2012-04-18T13:06:21.503
> 
> 标签：c#, .net, windows-phone-7, linq-to-xml

我想知道解析 XML 的最佳方式，即在性能（空间和时间）方面。

我通过以下方法完成了解析

*   使用常规的“for each”循环
*   使用 Linq
*   点表示法或 lambda 表示法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:10:57.353

没有看到你的代码，想要优化它并不容易。但是，您应该考虑一个普遍的观点：

Linq-to-XML 是一个基于 DOM 的解析器，因为它将整个 XML 文档读入一个驻留在内存中的模型中。所有查询都针对 DOM 执行。对于大型文档，构建 DOM 可能会占用大量内存和 CPU。此外，如果编写效率低下，您的 Linq-to-XML 查询可以多次导航相同的树节点。

作为替代方案，请考虑使用像[XmlReader](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader%28v=vs.95%29.aspx)这样的串行 (SAX) 解析器。这种类型的解析器不会为您的文档创建基于内存的模型，并且以只进的方式运行，迫使您只读取每个元素一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:10:18.197

我这是一个大而复杂的 XML 文件，您可以尝试使用 SAX 类型的 XML 解析器来解析它。SAX 解析器将为 XML 文件中的每个节点生成一个事件，因此您无需将整个文件加载到内存中。如果一个小文件应该在你的应用程序中作为 Web 响应进行分析并且必须进行验证，我建议你使用 DOM 类型的 XML 解析器。

# ios - iPhone：如何在 iphone 中打开两个带有两个链接的 Safari 浏览器选项卡？

> ID：10210008
> 
> 赞同：0
> 
> 时间：2012-04-18T13:06:31.443
> 
> 标签：ios, ios4

如果我有两个 url，我想在按钮单击的两个不同的 safari 选项卡上同时打开，我该如何调用打开的 url？或者有没有其他方法可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:37:26.563

无法从您的应用程序中打开多个选项卡。我想这有多种原因，包括可用性和垃圾邮件的可能性。

如果你想打开一个标签，这里是代码：

```
NSURL *url = [NSURL URLWithString:@"http://www.example.com"];

if (![[UIApplication sharedApplication] openURL:url])

NSLog(@"%@%@",@"Failed to open url:",[url description]); 
```

如果您想打开多个网页，我建议您将用户引导到一个网页，他们可以在其中找到指向这两个页面的链接。

# xml - Roku - 不解析格式错误的 xml

> ID：10210009
> 
> 赞同：1
> 
> 时间：2012-04-18T13:06:32.507
> 
> 标签：xml, xml-parsing, roku, brightscript

解析大型 xml 时我有一个奇怪的行为（但我不确定是否是大的事实导致了问题）。这是xml格式：

```
<?xml version="1.0" encoding="UTF-8"?>
  <webservice>
    <control>
   <operation>get_clips</operation>
   <status>0</status>
    </control>
    <data>
       <cat size="4" lang="EN"/>
       <cat size="3" lang="EN"/>
       ' and 19 more other similar 'cat' elements
     </data>
  </webservice> 
```

这是代码，`m.rawResponse`上面的xml字符串在哪里。

```
if m.rawResponse <> "" then
  xml = CreateObject("roXMLElement")
  print "################ "; m.rawResponse ' contains the entire xml
  xml.Parse( m.rawResponse )
  print "################ "; m.rawResponse ' contains the entire xml

  ' I've tried like this
  categories = xml.data.GetChildElements()
  print "number of categories: " ; categories.Count() ' prints 14

  ' and also like this
  i = 0
  for each categ in xml.data.cat
     i = i +1    
  end for
  print i ' prints 14
end if 
```

问题是只处理 14 个 cat 元素，而不是 21 个，我真的不知道为什么。请帮助我任何想法。非常感谢！

**稍后编辑** 我添加了一个检查以查看解析是否成功并且那里出了问题。问题与符号有关`&`- 我在 xml 中有以下行：

```
<director>Donald Nij & Rick Senjin</director> 
```

我该如何解决这个问题，但不是在服务器端，而是在 Roku 代码上？我在互联网上找不到任何解决方案。谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T16:46:20.850

在 Roku SDK 中，从 generalUtils.brs 中提取 ReplaceSubstring 函数并将其插入到您的项目中。用它来用“&”替换代码中的“&”。您还可以使用可能更快的 roRegex 组件。理想情况下，您应该在服务器上解决此问题，因为问题是您将错误的 xml 提供给您的设备，其他任何东西都是杂乱无章的。

# drupal-7 - 无法在 drupal 站点中启用时间线模块

> ID：10210015
> 
> 赞同：0
> 
> 时间：2012-04-18T13:06:46.157
> 
> 标签：drupal-7, drupal-modules

如何在 drupal 中启用类比时间线小部件。我从显示以下问题的drupal站点下载了它。

任何人都可以提供一些建议或提供解决此问题的途径

问题：

提供可拖动和可滚动的时间线视图。需要 views 模块和 libraries 模块，并使用 cck 和 date 模块（如果可用）。需要：Views（缺失）、Ctools（缺失）、Date_api（缺失）、Libraries（缺失）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:19:20.450

您还必须下载所有列出的缺失模块：1) 视图、2) Ctools、3) Date_api 和 4) 库。

您尝试下载的模块具有这些先决条件，您必须确保它们位于 modules/ 目录中，然后才能启用时间线模块。

# asp.net - 使用 CustomValidator 控件

> ID：10210022
> 
> 赞同：0
> 
> 时间：2012-04-18T13:07:01.537
> 
> 标签：asp.net, validation

我们通常知道 CustomValidator 控件会根据一些算术验证检查用户的输入。

我的网络表单中有一个文本框。它的文本不是来自用户的输入，而是来自数据库。

```
MembershipUser user = Membership.Providers["SqlMembershipProvider"].GetUser(userName);
TextUserName.Text = AntiXss.HtmlEncode(user.UserName); 
```

我的目标是使用某种验证器来检查它是否合适。如果不是，则在文本框中更改它并再次验证。怎么做？

谢谢。

**更新代码：**

```
 protected void ValidateUser()
    {
        string UserNameCreated = TextUserName.Text;
        Match match = Regex.Match(UserNameCreated, @"^[a-zA-Z0-9]{6,}$",
    RegexOptions.IgnoreCase);
    }

     <td class="style4">
            <asp:TextBox ID="TextUserName" runat="server"></asp:TextBox>
        </td><td><asp:CustomValidator ID="CustomValidatorUser" runat="server" ControlToValidate="TextUserName"
                                ErrorMessage="Minimum of 6 (six) alphanumeric characters." 
                OnServerValidate="ValidateUser" Display="Dynamic"
                                ValidateEmptyText="True" ></asp:CustomValidator></td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:11:04.037

您[`ServerValidate`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.onservervalidate.aspx)的签名错误。

```
void ServerValidation(object source, ServerValidateEventArgs args)
{
    args.IsValid = Regex.Match(TextUserName.Text, @"^[a-zA-Z0-9]{6,}$", RegexOptions.IgnoreCase);
} 
```

# c# - 如何创建 100 个新对象的数组？

> ID：10210024
> 
> 赞同：4
> 
> 时间：2012-04-18T13:07:04.363
> 
> 标签：c#, arrays

我正在尝试这样的事情：

```
class point
{
public int x;
public int y;
}

point[] array = new point[100];
array[0].x = 5; 
```

这是错误： **对象引用未设置为对象的实例。（@最后一行）**

怎么了？:P

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-18T13:08:12.130

它只创建数组，但所有元素都用 null 初始化。
您需要一个循环或类似的东西来创建您的类的实例。（在这种情况下，foreach 循环不起作用）示例：

```
point[] array = new point[100];
for(int i = 0; i < 100; ++i)
{
    array[i] = new point();
}

array[0].x = 5; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-18T13:09:03.770

当你这样做

```
point[] array = new point[100]; 
```

您创建一个数组，而不是 100 个对象。数组元素为空。此时您必须创建每个元素：

```
array[0] = new point();
array[0].x = 5; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-18T13:09:45.230

您可以更改`class point`为`struct point`在这种情况下`new point[500]`将创建一个初始化为的点数组`0,0`（而不是空数组）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T13:17:29.203

正如其他答案所解释的，您需要在每个数组位置初始化对象。您可以使用如下方法创建预初始化数组

```
T[] CreateInitializedArray<T>(int size) where T : new()
{
    var arr = new T[size];
    for (int i = 0; i < size; i++)
        arr[i] = new T();
    return arr;
} 
```

如果你的类没有无参数构造函数，你可以使用类似的东西：

```
T[] CreateInitializedArray<T>(int size, Func<T> factory)
{
    var arr = new T[size];
    for (int i = 0; i < size; i++)
        arr[i] = factory();
    return arr;
} 
```

两种方法的 LINQ 版本都很简单，但我相信效率略低

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T13:19:43.950

```
int[] asd = new int[99];
for (int i = 0; i < 100; i++)
    asd[i] = i; 
```

类似的东西？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-13T16:14:46.560

有时 LINQ 会派上用场。它可能会提供一些额外的可读性并减少样板和重复。缺点是需要额外的分配：创建枚举器并且 ToArray 事先不知道数组大小，因此可能需要多次重新分配内部缓冲区。**仅在可维护性比其性能更重要的代码中使用。**

```
using System.Linq;

const int pointsCount = 100;
point[] array = Enumerable.Range(0, pointsCount)
    .Select(_ => new point())
    .ToArray() 
```

# c# - 接口与没有抽象类的实现？

> ID：10210027
> 
> 赞同：4
> 
> 时间：2012-04-18T13:07:34.797
> 
> 标签：c#, .net, abstract-class, interface-implementation

我正在写一个库，我想要一个界面

```
public interface ISkeleton
{
    IEnumerable<IBone> Bones { get; }
    void Attach(IBone bone);
    void Detach(IBone bone);
} 
```

对于每个 ISkeleton，Attach() 和 Detach() 实现实际上应该是相同的。因此，它基本上可以是：

```
public abstract class Skeleton
{
    public IEnumerable<IBone> Bones { get { return _mBones; } }

    public List<IBone> _mBones = new List<IBone>();

    public void Attach(IBone bone)
    {
         bone.Transformation.ToLocal(this);
         _mBones.add();
    }

    public void Detach(IBone bone)
    {
        bone.Transformation.ToWorld(this);
         _mBones.Remove(bone);
    }
} 
```

但是 C# 不允许多重继承。因此，在各种问题中，用户每次想要实现 Skeleton 时都必须记住从 Skeleton 继承。

我可以使用扩展方法

```
public static class Skeleton
{   
    public static void Attach(this ISkeleton skeleton, IBone bone)
    {
         bone.Transformation.ToLocal(skeleton);
         skeleton.Bones.add(bone);
    }

    public static void Detach(this ISkeleton skeleton, IBone bone)
    {
        bone.Transformation.ToWorld(this);
         skeleton.Bones.Remove(bone);
    }
} 
```

但我需要有

```
public interface ISkeleton
{   
    ICollection<IBone> Bones { get; }
} 
```

我不想要，因为它不是协变的，用户可以绕过 Attach() 和 Detach() 方法。

问题：我必须真的使用抽象 Skeleton 类还是有任何技巧和方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T13:11:55.013

如果您需要在接口中公开`Attach`和`Detach`方法，总有一种方法可以绕过您的预期实现，因为实现该接口的所有对象都可以按照自己的风格实现它们。

您可以让抽象类`Skeleton`实现`ISkeleton`，并且所有作为骨架的类都继承自`Skeleton`，因此它们也实现`ISkeleton`了。

```
public interface ISkeleton { ... }

public abstract class Skeleton : ISkeleton { ... } // implement attach and detach

public class SampleSkeleton : Skeleton { ... } 
```

这样您就可以使用`SampleSkeleton`as `ISkeleton`，只要您从方法继承`Skeleton`并将方法标记为`sealed`不允许覆盖它们（只要它们是实例方法），就不必实现这些功能。

在一个侧面节点上：请务必`Base`在末尾命名您的抽象类或以其他方式标记基类（但这肯定取决于您）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T13:13:28.507

我会让骨骼成为实现`IEnumerable<T>`. 这样就不会违反单一责任原则。

```
public interface ISkeleton
{
    AttachableEnumerable<IBone> Bones { get; }
}

public class AttachableEnumerable<T> : IEnumerable<T>
{
    // implementation needed.
    void Attach(T item);
    void Detach(T item);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:18:55.143

如果你想包装`ISkeleton`行为，你总是可以让它成为一个复合对象而不是继承行为：

```
public class Body : ISkeleton
{
    private SkeletonImpl _skeleton = new SkeletonImpl;

    public IEnumerable<IBone> Bones { get { return _skeleton.Bones; } }

    public void Attach(IBone bone)
    {
        _skeleton.Attach(bone);
    }

    public void Detach(IBone bone)
    {
       _skeleton.Detach(bone);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T13:16:10.133

可能您只需要在抽象 Skeleton 类上使用密封方法吗？这样他们就不能被覆盖。

[http://msdn.microsoft.com/en-us/library/aa645769(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa645769(v=vs.71).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T13:22:59.997

您可以创建一个实现“附加”和“分离”方法的包装类，并将此功能注入您的接口。

# javascript - change() 仅在失去焦点时触发

> ID：10210031
> 
> 赞同：1
> 
> 时间：2012-04-18T13:07:42.067
> 
> 标签：javascript, jquery, ajax, jquery-ui

我目前使用 jQuery 的更改功能。仅当我在文本字段外单击时才会触发更改事件。因此，当我在我的文本框中插入文本时，什么都没有发生，但是当我失去对文本字段的关注时，事件就会触发。不，我想触发事件而不必在文本字段之外单击。

这是我的代码：

```
 jQuery("#customfield_10000").change(function(){
            crmAccount = jQuery(this).val();
            alert(crmAccount);
            lijstAccounts = [];

                    jQuery.ajax({
                        url: "http://localhost/papa/jQuery/development-bundle/demos/autocomplete/searchAccounts.php?jsonp_callback=?",
                        dataType: 'jsonp',
                        jsonp: "jsonp_callback",
                        data: {
                            featureClass: "P",
                            style: "full",
                            maxRows: 12,
                            name_startsWith: jQuery(this).val()
                            },
                            success: function( data ) {
                                 jQuery.map( data, function( item ) {
                                                            lijstAccounts.push(item.label);
                                                            jQuery('#customfield_10000').trigger(
                                                                'setSuggestions',
                                                            { result : textext.itemManager().filter(lijstAccounts, query) }
                                                            );              
                                    return {
                                        label: item.label,
                                        value: item.value    
                                    }
                                });
                            }
                        });

             }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T13:08:46.700

您应该处理`input`（非 IE）或`propertchange`（仅 IE）或`keyup`（不会捕获粘贴或拖放）事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:10:15.467

您可以使用[KeyUp 事件](http://api.jquery.com/keyup/)：

```
$("#abcd").keyup(function(event) {
     //code
}); 
```

# objective-c - iOS - 故事板 - 将相同的 UITableViewController 链接到 2 个不同的 UITabBarControllers

> ID：10210033
> 
> 赞同：1
> 
> 时间：2012-04-18T13:07:46.130
> 
> 标签：objective-c, ios, xcode, uitabbarcontroller, storyboard

我正在使用 Xcode 4.3.2、SDK v5.1 和故事板开发导航风格的 iOS 应用程序。用户可以通过应用程序采取多条路线，但无论采取哪条路线，都会使用一个特定的表格视图场景。因此，我只想让这个场景定义一次，但在超过 1 个不同的标签栏控制器中作为标签页可见。故事板设计器允许定义这些关系，但是当应用程序运行时，表格视图场景仅在最近连接到的选项卡栏控制器中显示为选项卡按钮。

我在努力实现不可能吗？我会想如果故事板让我把所有东西都连接起来，那么它应该是可以实现的。

非常感谢，乔纳森

# iphone - UIPickerView NSUnknownKeyException

> ID：10210036
> 
> 赞同：0
> 
> 时间：2012-04-18T13:07:53.000
> 
> 标签：iphone, objective-c, exception, uipickerview

我见过很多类似的问题，但没有一个能解决我的问题，也没有让我明白解决方案。我用`UIPickerView`. 当我运行应用程序时，我收到此错误。

```
Terminating app due to uncaught exception 'NSUnknownKeyException',
reason: '[<UIApplication 0x68633e0> setValue:forUndefinedKey:]:
this class is not key value coding-compliant for the key pickerview.' 
```

我的`ViewController.h`

```
#import <UIKit/UIKit.h>
#define CATEGORY 0
#define VALUES 1

@interface ViewController : UIViewController <UIPickerViewDelegate , UIPickerViewDataSource> {
    NSDictionary* dictionary;
    NSArray *keys,*values;
    IBOutlet UIPickerView *pickerview;
}
@property (retain,nonatomic) NSArray *keys, *values;
@property (retain,nonatomic) NSDictionary *dictionary;
@property (retain,nonatomic) UIPickerView *pickerview;
@end 
```

我的`ViewController.m`

```
#import "ViewController.h"

@implementation ViewController
@synthesize keys,values,dictionary;
@synthesize pickerview;

-(void)dealloc {
    [keys release];
    [values release];
    [dictionary release];
    [pickerview release];
    [super dealloc];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
}

#pragma mark - View lifecycle
- (void)viewDidLoad
{
    NSBundle* bundle = [NSBundle mainBundle];
    NSString* str = [bundle pathForResource:@"testlist" ofType:@"plist"];
    NSDictionary* tempd = [[NSDictionary alloc] initWithContentsOfFile:str];
    self.dictionary = tempd;
    [tempd release];
    self.keys = [dictionary allKeys];
    self.values = [dictionary objectForKey: [keys objectAtIndex:0]];
   [super viewDidLoad];
}

- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView {
    return 2;
}

- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component {
    if (component == CATEGORY) {
        return keys.count;
    }
    return values.count;
}

- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component {
    if (component == CATEGORY) {
        NSArray* tvalues = [dictionary objectForKey:[keys objectAtIndex:row]];
        self.values = tvalues;
        [pickerview selectRow:0 inComponent:VALUES animated:YES];//Xreiazetai?
        [pickerview reloadComponent:VALUES];
    }
}

- (NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component {
    if (component == CATEGORY) {
        return [keys objectAtIndex:row];
    }
    return [values objectAtIndex:row];
}

- (void)viewDidUnload
{
    [super viewDidUnload];
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

@end 
```

我确保Picker`dataSource`的outlet`delegate`指向 File's Owner 作为`pickerview`引用的 outlet。

**更新**

整个堆栈跟踪

```
GNU gdb 6.3.50-20050815 (Apple version gdb-1708) (Mon Aug  8 20:32:45 UTC 2011)
Copyright 2004 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "x86_64-apple-darwin".Attaching to process 1236.
2012-04-18 17:07:33.444 TestPlist[1236:f803] *** Terminating app due 
to uncaught exception 'NSUnknownKeyException', reason: '[<UIApplication 0x6a68e90> setValue:forUndefinedKey:]: 
this class is not key value coding-compliant for the key pickerview.'
    *** First throw call stack:
    (0x13bb052 0x154cd0a 0x13baf11 0x9b2032 0x923f7b 0x923eeb 0x93ed60 0x23191a 0x13bce1a     
0x1326821 0x23046e 0x232010 0x1214a 0x12461 0x117c0 0x20743 0x211f8 0x14aa9 0x12a5fa9 0x138f1c5 
0x12f4022 0x12f290a 0x12f1db4 0x12f1ccb 0x112a7 0x12a9b 0x20a2 0x2015)
            terminate called throwing an exceptionsharedlibrary apply-load-rules all

(gdb) 
```

[这](http://www.2shared.com/file/OTmmtWNe/TestPlist.html)是任何想知道问题所在的人的文件。我会很感激的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T18:50:49.470

进入项目中的 TestPlist-Info.plist 文件并删除此行：

```
Main nib file base name     ViewController 
```

这是不正确的，您不需要此参考，因为它全部在您的 application:didFinishLaunchingWithOptions: 方法中处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:30:45.977

我不是一个 IB 用户，但您不应该将**属性定义为 IBOutlet**，而不是属性本身吗？

```
@property (retain,nonatomic) IBOutlet UIPickerView *pickerview; 
```

为什么不使用 ARC 进行内存管理——这大大简化了事情（不再保留和释放），所以如果你没有不使用它的特殊原因，你应该切换到 ARC。

# python - 使用列表推导的列表操作

> ID：10210039
> 
> 赞同：0
> 
> 时间：2012-04-18T13:08:02.190
> 
> 标签：python, list, loops

我有一个清单。

```
a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20] 
```

我想使用列表理解并希望将输出创建为：

```
output1 = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15, 16], [17, 18, 19, 20]]

output2:
('value', 1)
('value', 2)
'
'
('value', 20) 
```

我可以使用 for 循环创建 output1 和 output2，但我不知道如何使用列表理解。

如果有人知道这一点，请告诉我。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T13:11:12.897

For the First you can do something like

```
>>> [a[i:i+4] for i in range(0,len(a),4)]
[[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15, 16], [17, 18, 19, 20]] 
```

For the Second you can simply read and generate the tuples with `value` as the first item

```
>>> [('value',i) for i in a]
[('value', 1), ('value', 2), ('value', 3), ('value', 4), ('value', 5), ('value', 6), ('value', 7), ('value', 8), ('value', 9), ('value', 10), ('value', 11), ('value', 12), ('value', 13), ('value', 14), ('value', 15), ('value', 16), ('value', 17), ('value', 18), ('value', 19), ('value', 20)] 
```

another version using itertools.izip_longest though the above is more redable

```
list(itertools.izip_longest([],a,fillvalue='value')) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T13:11:11.133

```
output1 = [a[i:i+4] for i in xrange(0,len(a),4)]
output2 = [('value',i) for i in a] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T13:14:48.570

这是[JF Sebastians 的 grouper](https://stackoverflow.com/a/312644/21640)，它解决了您的第一个问题：

```
 from itertools import izip_longest, repeat
 izip_longest(*[iter(a)]*4, fillvalue=None) 
```

对于你的第二个：`zip(repeat('value'), a)`

# linux - 如何让webkit知道libflashplayer.so的路径然后使用呢？

> ID：10210043
> 
> 赞同：0
> 
> 时间：2012-04-18T13:08:11.177
> 
> 标签：linux, flash, ubuntu, webkit, gtk

我想打开一个HTML文件来播放flash文件，但是Webkit没有libflashplayer.so，我想知道如何让Webkit知道libflashplayer.so的路径，然后用它来播放flash文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:05:37.533

以下目录是 WebKit for QT 搜索浏览器插件的地方。你试过这些地方吗？

> ```
> .mozilla/plugins in the user's home directory
> .netscape/plugins in the user's home directory
> System locations, such as
>     /usr/lib/browser/plugins
>     /usr/local/lib/mozilla/plugins
>     /usr/lib/firefox/plugins
>     /usr/lib64/browser-plugins
>     /usr/lib/browser-plugins
>     /usr/lib/mozilla/plugins
>     /usr/local/netscape/plugins
>     /opt/mozilla/plugins
>     /opt/mozilla/lib/plugins
>     /opt/netscape/plugins
>     /opt/netscape/communicator/plugins
>     /usr/lib/netscape/plugins
>     /usr/lib/netscape/plugins-libc5
>     /usr/lib/netscape/plugins-libc6
>     /usr/lib64/netscape/plugins
>     /usr/lib64/mozilla/plugins 
> ```

[http://doc.qt.digia.com/qt/qtwebkit.html#netscape-plugin-support](http://doc.qt.digia.com/qt/qtwebkit.html#netscape-plugin-support)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T17:32:30.303

对于 firefox，“ **libflashplayer.so** ”被放置在“ **/usr/lib/firefox-*/plugins** ”目录中，类似地，“ **/usr/lib** ”中也可以有一个**webkit目录**

 **（我不确定，这只是一个建议）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-27T08:16:52.263

嗯，你的问题很难回答。因为我不认为知道插件路径的路径会解决这个问题。

无论如何，我相信你可以使用这个功能来知道 webket 插件的路径。

qgetenv("QTWEBKIT_PLUGIN_PATH");**

# java - 方法内部类加载器的上下文

> ID：10210047
> 
> 赞同：1
> 
> 时间：2012-04-18T13:08:24.393
> 
> 标签：java, classloader

我编写了自定义类加载器，它从文件系统加载 jar 文件。覆盖`customClassLoader`加载和查找方法及其工作方式 如何使定义类加载器之后的所有代码在方法执行的上下文中与 customClassLoader 一起工作。一旦我在方法中运行此代码，`f1()`我就会收到此错误`java.lang.NoClassDefFoundError org.xml.dd.myclass`

我如何在方法的上下文中定义它，我将一直使用 customClassLoader

```
Public void execute()
{

ClassLoader customClassLoader= new customClassLoader();
        try
        {
            Class.forName("org.xml.dd.myclass", true, xdmCustomClassLoader);
        }
        catch (ClassNotFoundException e2)
        {
            // TODO Auto-generated catch block
            e2.printStackTrace();
        } 
        Thread.currentThread().setContextClassLoader(customClassLoader);
        ………………….
        F1();
        F2();       
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:34:08.003

上下文类加载器必须显式使用。正常`new`操作等将使用拥有相关代码的类的类加载器。在下面的示例中，`Executor`该类将成为您希望使用您的自定义类加载器执行的所有代码的入口点。使用您的类加载器加载该类并调用它的方法`run`。您应该实现`run`，以便它执行需要由您的类加载器负责运行的所有代码。

```
public class Executor {
  public void run() {
     final MyInterface x = new MyClass();
     x.f1(); x.f2();
  }
}

public class Test {
  public static void main(char[] args) throws Exception {
    final ClassLoader customCl = new customClassLoader();
    final Executor e = 
      (Executor) Class.forName("Executor", true, customCl).newInstance();
    e.run();
  }
} 
```

# ios - 显示拍摄照片的预览但不编辑 UIImagePickerController UIImagePickerControllerSourceTypeSavedPhotosAlbum

> ID：10210051
> 
> 赞同：4
> 
> 时间：2012-04-18T13:08:41.240
> 
> 标签：ios, xcode

如果有人从他的库中选择照片，我想显示预览。

我的代码：

```
UIImagePickerController *imagePickerController = [[UIImagePickerController alloc] init];
        imagePickerController.delegate = self; 
        imagePickerController.sourceType = UIImagePickerControllerSourceTypeSavedPhotosAlbum;
        imagePickerController.allowsImageEditing = NO;

        [[self parentViewController] presentModalViewController:imagePickerController animated:YES];
        [imagePickerController release]; 
```

如果我设置allowImageEditing = YES，它会显示预览（就像我想要的那样），但我可以编辑照片（缩小/剪切）。我只是希望用户可以选择取消或确认选择照片，例如拍摄新照片时的预览（UIImagePickerControllerSourceTypeCamera）。

我想要右侧的预览： ![在此处输入图像描述](../Images/2037f49eb35a8f765ed2baae0c643778.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T05:13:34.193

您可以在 UIImagePickerController 的委托类的 didFinishPickingMediaWithInfo 方法中创建并显示自定义预览。从中获取图像

```
originalImage = (UIImage *) [info objectForKey: UIImagePickerControllerOriginalImage]; 
```

在 ImageView 中显示它。

还需要设置 UIImagePickerController.showsCameraControls=NO。

# node.js - 嵌入式文档的猫鼬更新

> ID：10210052
> 
> 赞同：2
> 
> 时间：2012-04-18T13:08:45.547
> 
> 标签：node.js, mongodb, mongoose

我正在慢慢发疯，试图了解如何在 mongoose 中更新嵌入式文档的值，并编写了一些演示该问题的 node.js 代码。

```
 var mongoose = require('mongoose');
var Schema = mongoose.Schema;

mongoose.connect('mongodb://localhost/mongoose_broken');

var ASchema = new Schema({
   value : { type: String, index: { unique: true } },
   bs    : [BSchema],
});
var BSchema = new Schema({
   value : { type: String },
});
var A = mongoose.model('A', ASchema);
var B = mongoose.model('B', BSchema);

// Add an entry of A, with 1 embedded B
//
var a = new A();
a.value = "hello";
var b = new B();
b.value = "world";
a.bs.push(b);

a.save(function(err) {
   if (err) {
      console.log("Error occured during first save() " + err);
      return;
   }

   // Now update a by changing a value inside the embedded b
   //
   A.findOne({ value: 'hello' }, function(err, doc) {
      if (err) { console.log("Error occured during find() " + err); return; }

      doc.bs[0].value = "moon";

      doc.save(function(err) {
         if (err) console.log("Error occuring during second save()");

         // Check b was updated?
         //
         if (doc.bs[0].value != "moon") {
            console.log ("b was not updated! (first check)");   
         } else {
            console.log ("b looks like it was updated (first check)");

            // Do a fresh find
            //
            A.findOne({value: "hello"}, function(err, doc_2) {
               if (err) { console.log("Error occured during second find() " + err); return; }

               if (doc_2.bs[0].value != "moon") {
                  console.log ("b was not updated! (second check)");   
               } else {
                  console.log ("b looks like it was updated (second check)");
               }
            });
         }
      });
   });
}); 
```

运行它的输出是：

```
 b looks like it was updated (first check)
b was not updated! (second check) 
```

知道为什么不保存嵌入式文档的更新吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T17:31:52.237

在父模式中使用子模式之前，您必须声明它们。

```
var BSchema = new Schema({
  value : { type: String },
});    
var ASchema = new Schema({
  value : { type: String, index: { unique: true } },
  bs    : [BSchema],
}); 
```

# android - 我可以在关闭电源的情况下将我的服务保留在设备上吗？

> ID：10210057
> 
> 赞同：0
> 
> 时间：2012-04-18T13:09:08.137
> 
> 标签：android, device, power-off

我已经将我的设备连接到 PC 并通过设备上的 Eclipse 运行我的服务。现在我想看看我的服务在关机和开机时的行为是什么。问题是一旦关闭设备电源，我的服务就会丢失。是否可以在断电时保持应用程序在设备上持久存在？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:29:49.840

当设备关闭时，您的服务将不会运行 - 因为没有电源。但您可以在设备通电后立即提供服务。确保您的服务是高效的，这样当内存变得紧张时它不会被杀死。然后只需使用广播接收器即可捕获

```
<action android:name="android.intent.action.BOOT_COMPLETED"/> 
```

意图。您可以从接收方发送并打算启动您的服务。您还可以在服务的 Intent Filter 中使用此 Intent 来启动服务。使用带有部分唤醒锁定的 PowerManager 来帮助您的服务在屏幕关闭时运行 - 但请注意：此功能不适用于所有设备 - 在我使用过的所有设备中，此功能仅适用于一半，但并不完美。

如果您想帮助您的服务不再被操作系统杀死 - 使用服务对象中的 startForeground() API 调用将其作为前台服务运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:11:55.293

而是使用设备启动时发送的广播再次启动它。有关更多信息，请参见[此处](http://www.androidcompetencycenter.com/2009/06/start-service-at-boot/)和[此处](https://stackoverflow.com/questions/5290141/android-broadcastreceiver-on-startup)。

# javascript - 获取没有子域的父 document.domain

> ID：10210058
> 
> 赞同：0
> 
> 时间：2012-04-18T13:09:08.133
> 
> 标签：javascript

假设我有一个域`subdomain.domain.com`，当我检查`document.domain`我得到结果时`subdomain.domain.com`，我该怎么做才能只获取原始域而没有子域，例如：`domain.com`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:13:23.343

这将适用于`.com`您指定的示例中的域，您必须调整 切片`.co.uk`和`.com.au`其他一些 TLD：

```
document.domain.split(".").slice(-2).join("."); 
```

# mongodb - MongoDB：存储的对象如何受到模型更改的影响？

> ID：10210061
> 
> 赞同：4
> 
> 时间：2012-04-18T13:09:13.300
> 
> 标签：mongodb

我正在考虑迁移到 mongoDB，但我对这件事缺乏一些基本的了解。我的主要问题是“存储的对象如何受到模型更改的影响？”。这是一个更好地理解我想知道的场景：

1.  我创建了一个具有名字、姓氏、电子邮件属性的“用户”模型。
2.  我在我的应用程序中创建了 25 个存储在 mongo 中的用户（因此它们存储为 {first_name: "xxx", last_name: "yyy", email: "zzz"}）
3.  我向我的“用户”模型添加了一个属性：用户名
4.  我在我的应用程序中创建了 25 个新用户（因此他们被存储为 {first_name: "xxx", last_name: "yyy", email: "zzz", username: "xyz"}）
5.  我从“用户”模型中删除了“名字”和“姓氏”属性。
6.  我更新了前 25 个用户中的 5 个的电子邮件地址。

所以这是我的问题：

1.  将“用户名”属性添加到“用户”模型后，前 25 个对象会发生什么情况？他们是否在 BSON 定义中收到“用户名”属性且值为空？我的理解是，他们只是没有受到影响。
2.  当我从“用户”模型中删除“名字”和“姓氏”属性时，现有的 50 个用户会发生什么情况？我想与＃1相同的答案适用。
3.  在我更新了 10 条记录的电子邮件地址后，这 5 个第一会发生什么？他们是否添加了“用户名”、删除了“名字”和“姓氏”并更新了他们的电子邮件地址？或者只是更新了他们的电子邮件地址？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T14:11:17.323

你的直觉是正确的。MongoDB 要求您在应用程序中（即在数据库之外）创建和实施数据模型。我认为这是从 SQL 数据库转换时要克服的最大心理障碍之一。

所以回答你的问题

1.  原来的 25 个用户对象不会自动接收“用户名”属性。您将需要手动更新现有用户以添加用户名或更新模型以处理不存在用户名的情况。

2.  和上面一样。您将需要手动更新现有记录以删除 first_name 和 last_name 属性，或者等到对象更新到不包含它们的未来版本。

3.  这取决于您如何进行更新。您可以通过替换整个记录或使用修饰符来更改单个字段来更新。如果您替换整条记录，则将保存模型的当前版本。如果直接修改“email”属性，则其他字段不会改变。

# python - Compare 2 files and remove any lines in file2 when they match values found in file1

> ID：10210062
> 
> 赞同：2
> 
> 时间：2012-04-18T13:09:23.050
> 
> 标签：python, bash, sed, awk, grep

I have two files. i am trying to remove any lines in file2 when they match values found in file1\. One file has a listing like so:

File1

```
ZNI008
ZNI009
ZNI010
ZNI011
ZNI012 
```

... over 19463 lines

The second file includes lines that match the items listed in first: File2

```
copy /Y \\server\foldername\version\20050001_ZNI008_162635.xml \\server\foldername\version\folder\
copy /Y \\server\foldername\version\20050001_ZNI010_162635.xml \\server\foldername\version\folder\
copy /Y \\server\foldername\version\20050001_ZNI012_162635.xml \\server\foldername\version\folder\
copy /Y \\server\foldername\version\20050001_ZNI009_162635.xml \\server\foldername\version\folder\ 
```

... continues listing until line 51360

What I've tried so far:

```
grep -v -i -f file1.txt file2.txt > f3.txt 
```

does not produce any output to `f3.txt` or remove any lines. I verified by running

```
wc -l file2.txt 
```

and the result is

```
51360 file2.txt 
```

I believe the reason is that there are no exact matches. When I run the following it shows nothing

```
comm -1 -2 file1.txt file2.txt 
```

Running

```
( tr '\0' '\n' < file1.txt; tr '\0' '\n' < file2.txt ) | sort | uniq -c | egrep -v '^ +1' 
```

shows only one match, even though I can clearly see there is more than one match.

Alternatively putting all the data into one file and running the following:

```
grep -Ev "$(cat file1.txt)" 1>LinesRemoved.log 
```

says argument has too many lines to process.

I need to remove lines matching the items in file1 from file2.

i am also trying this in python: `

```
 #!/usr/bin/python
s = set()

# load each line of file1 into memory as elements of a set, 's'
f1 = open("file1.txt", "r")
for line in f1:
    s.add(line.strip())
f1.close()

# open file2 and split each line on "_" separator,
# second field contains the value ZNIxxx
f2 = open("file2.txt", "r")
for line in f2:
    if line[0:4] == "copy":
        fields = line.split("_")
        # check if the field exists in the set 's'
        if fields[1] not in s:
            match = line
        else:
            match = 0
    else:
        if match:
            print match, line, 
```

`

it is not working well.. as im getting 'Traceback (most recent call last): File "./test.py", line 14, in ? if fields[1] not in s: IndexError: list index out of range'

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T13:22:47.613

关于什么：

```
grep -F -v -f file1 file2 > file3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:16:04.050

我更喜欢 byrondrossos 的 grep 解决方案，但这里有另一种选择：

```
sed $(awk '{printf("-e /%s/d ", $1)}' file1) file2 > file3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:20:47.533

由于开关，这是使用**Bash**和**GNU sed**`-i`

```
cp file2 file3
while read -r; do
    sed -i "/$REPLY/d" file3
done < file1 
```

* * *

肯定有更好的方法，但这里有一个技巧`-i` ：D

```
cp file2 file3
while read -r; do
    (rm file3; sed "/$REPLY/d" > file3) < file3
done < file1 
```

这利用了外壳评估顺序

* * *

好吧，我想这个想法的正确方法是使用`ed`. 这也应该是 POSIX。

```
cp file2 file3
while read -r line; do
    ed file3 <<EOF
/$line/d
wq
EOF
done < file1 
```

* * *

无论如何，`grep`似乎确实是适合这项工作的工具。
@byrondrossos 答案应该对你有用；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T16:12:54.217

诚然，这很丑陋，但确实有效。但是，所有的路径必须相同（当然除了 ZNI### 部分）。除了 ZNI### 之外的所有路径都被删除，因此命令 grep -vf 可以在排序的文件上正确运行。

首先将“testfile2”转换为“testfileconverted”以仅显示 ZNI###

```
cat /testfile2 | sed 's:^.*_ZNI:ZNI:g' | sed 's:_.*::g' > /testfileconverted 
```

第二次使用转换文件的反向 grep 与“testfile1”相比，并将重新格式化的输出添加到“testfile3”

```
bash -c 'grep -vf <(sort /testfileconverted) <(sort /testfile1)' | sed "s:^:\copy /Y \\\|server\\\foldername\\\version\\\20050001_:g" | sed "s:$:_162635\.xml \\\|server\\\foldername\\\version\\\folder\\\:g" | sed "s:|:\\\:g" > /testfile3 
```

# jquery - jCrop API is null or not an object in IE, but works in FF, Chrome, etc

> ID：10210063
> 
> 赞同：3
> 
> 时间：2012-04-18T13:09:27.877
> 
> 标签：jquery, internet-explorer, jcrop

I wrote an extedned plugin based on jCrop to crop mulitple images one after another.

I developed and debugged using Chrome and everything worked fine without any JavaScript issues. When i came to test in Explorer it fell over and threw a script error that wrote out

`jcrop api is null or not an object`

So my javascript is simply...

```
var jcrop_api; //Global var to be used thorugh out the client

//some code here

//jCrop documention tells us to use this to assign itself to an object.
//I look for both because i use .net masterpages and sometimes not.

$('#SourceImage, #body_SourceImage').Jcrop({},function () { jcrop_api = this; });

//some more code but not far down the line i need to set jCrop options using API

jcrop_api.setOptions({
           boxWidth: bw,
           onSelect: updateCoords,
           minSize: [thisImage.Min.Width, thisImage.Min.Height],
           aspectRatio: thisImage.AspectRatio
       });
 jcrop_api.setImage('../cache/uploads/' + fileName); 
```

That all work in Chrome and i can change images using a global trigger. I have no idea why it does not work in IE?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T13:14:16.390

事实上，jCrop 确实在文档中显示了您使用的确切行。但是 IE JavaScript 引擎是无情的。

您需要做的是使用此行将 api 分配给 var

```
var jcrop_api;

$(document).ready(function () {

jcrop_api = $.Jcrop($('#SourceImage, #body_SourceImage'), {}); 
```

然后做剩下的。出于某种原因`this`，在 IE 中引用回整个 DOM 而不是 jCrop 的回调函数并且无法分配，从而使您的 API 变量一无所有。

此更改不会影响 Chrome、FF 或其他任何东西.. 并且更清晰一点。

# javascript - Does javascript/jquery "hate" negative number as part of id name?

> ID：10210067
> 
> 赞同：2
> 
> 时间：2012-04-18T13:09:35.997
> 
> 标签：javascript, jquery, string-concatenation

I have a snippet of JQuery code that do some bar scrolling.

Since I have three, four, ... *n* bar to slide into my PHP page, I assign them dinamically an *id* and pass it to JQuery for be sure that my snippet slide the correct bar on a mouseOver event.

That's the snippet of code that do the "inizialization" of my scrolls

```
(function($){
 $.fn.horizontalScroll = function(options) {

 var rid = arguments[0];
 var oid = arguments[1];

 var defaults = { };

 var options = $.extend(defaults, options);

 return this.each(function() {

            var horiz_scroll = new dw_scrollObj($(this).attr('id'), $(this).children().attr('id'), $(this).children().children().attr('id'));
            horiz_scroll.setUpScrollbar("dragBar_"+rid+"_offer_"+oid, "track_"+rid+"_offer_"+oid, "h", 1, 1);
            horiz_scroll.setUpScrollControls('scrollbar_'+rid+'_offer_'+oid); 
```

As you can see, `"dragBar_"+rid+"_offer_"+oid` dinamically concatenates my id(s) to other string part.

That's fine and all goin' well, except when my `oid` became something like `-1`

In that case I have an error that says

> identifier starts immediately after numeric literal

That's confuse me, because i've read on StackOverflow some questions like [this](https://stackoverflow.com/questions/5883397/javascript-firebug-error-identifier-starts-immediately-after-numeric-literal) (just a random one) and I expect that behaviour for **all** concatenation that involves number.

That the snippet of code where all "breaks"

```
this.timerId = setInterval(this.animString + ".scroll()", 10); 
```

Where `this.animString` is `"dw_scrollObj.col.horiz_container_outer_55_offer_-1"` while in other case (where it works) is `"dw_scrollObj.col.horiz_container_outer_62_offer_234"`

Anyone can explain me why this happen?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T13:13:59.557

您正在尝试访问名为`dw_scrollObj.col.horiz_container_outer_55_offer_-1`. 一些浏览器会让所有元素都可以`ID`这样访问，但不建议这样做。

它在您的特定情况下不起作用的原因是您编写的不是有效的 javascript 变量名。您访问变量的尝试将被解释为

```
dw_scrollObj.col.horiz_container_outer_55_offer_ - 1 
```

如果您改为通过以下方式访问您的对象

```
document.getElementById('dw_scrollObj.col.horiz_container_outer_55_offer_-1') 
```

或者

```
$('#dw_scrollObj.col.horiz_container_outer_55_offer_-1') 
```

你不会有同样的问题。

对于您的`setInterval`代码，这意味着

```
this.timerId = setInterval("$('#" + this.animString + "').scroll()", 10); 
```

或者最好

```
this.timerId = setInterval(function() {
   $('#' + this.animString).scroll();
}, 10); 
```

如果您的代码处于循环中，并且`animString`在上下文中会随着时间而改变，您将需要创建一个新的闭包：

```
this.timerId = setInterval((function(x) {
    return function() {
       $('#'+x).scroll();
    };
})(this.animString), 10); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T13:13:43.670

您的`setInterval`代码段中断，因为您传递给的字符串`setInterval`被评估为 JavaScript。它成为了

```
dw_scrollObj.col.horiz_container_outer_55_offer_-1.scroll() 
```

但连字符 ( `-`) 在标识符中无效。

例如，这会引发错误

```
var some-name = 'foo'; 
```

# eclipse - Mylyn doesn't filter the resources in the Navigator- or Package Explorer views

> ID：10210074
> 
> 赞同：0
> 
> 时间：2012-04-18T13:10:07.013
> 
> 标签：eclipse, mylyn

I am using Eclipse 3.7 with Mylyn and would like to use it to focus only on the files that are in the current context.

When I activate a task with no context, the Navigator and Package Explorer views should both be empty, allowing me to add files to the context. If I add some files to a bugs context, save the context, restart eclipse and activate the same bug, what I expect is that only the resources in the context will be visible, but what happens is that both views just shows all resources as they would without any active tasks.

Another thing is that normally there is a small Mylyn pane with options to toggle focus on the current context inside each of the two views, but in my installation, they are both missing. Could this be a consequence of running Unity on Ubuntu? (It is known to do odd things with scroll bars.)

It looks like a bug - any suggestions?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T19:21:57.793

永远不要从 Linux 包存储库安装 Eclipse；始终从[http://www.eclipse.org/downloads](http://www.eclipse.org/downloads)下载它，并确保您已安装 Oracle JDK 并配置 Eclipse 以按照[此处](http://wiki.eclipse.org/Eclipse.ini)所述使用它。

我怀疑 Eclipse 的 Ubuntu 包要么是混蛋，要么就是完全损坏，所以从正确的来源获取它应该会让你继续前进。

# python - 如何禁用 SQLAlchemy 缓存？

> ID：10210080
> 
> 赞同：23
> 
> 时间：2012-04-18T13:10:20.863
> 
> 标签：python, mysql, sqlalchemy, innodb

我在使用`sqlalchemy`.

我`sqlalchemy`用来将数据插入 MySQL 数据库。然后，我让另一个应用程序处理这些数据，并直接更新它。

但`sqlalchemy`总是返回旧数据而不是更新数据。我认为`sqlalchemy`缓存了我的请求......所以......我应该如何禁用它？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-04-18T14:51:50.660

人们认为有一个“缓存”在起作用，除了通常的事务本地的 SQLAlchemy 身份映射之外，通常的原因是他们正在观察事务隔离的影响。SQLAlchemy 的会话默认在事务模式下工作，这意味着它会等待直到`session.commit()`被调用，以便将数据持久化到数据库中。在此期间，其他地方正在进行的其他事务将看不到此数据。

然而，由于交易的孤立性，还有一个额外的转折。*那些正在进行的其他事务不仅在提交之前不会看到您的事务的数据，在某些情况下，在提交或回滚*之前它们也看不到它（这与您的 close() 在这里产生的效果相同） . 具有平均**隔离**度的事务将保持它迄今为止加载的状态，并继续为您提供与事务本地相同的状态，即使实际数据已更改 - 这在事务隔离用语中称为**可重复读取。**

[http://en.wikipedia.org/wiki/Isolation_%28database_systems%29](http://en.wikipedia.org/wiki/Isolation_%28database_systems%29)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-08-14T07:11:55.633

这个问题对我来说真的很沮丧，但我终于想通了。

我有一个与旧 PHP 站点一起运行的 Flask/SQLAlchemy 应用程序。PHP 站点将写入数据库，而 SQLAlchemy 不会意识到任何更改。

我尝试了 sessionmaker 设置 autoflush=True 未成功我在查询之前尝试了 db_session.flush()、db_session.expire_all() 和 db_session.commit() 并且没有工作。仍然显示陈旧的数据。

最后我遇到了 SQLAlchemy 文档的这一部分：http: [//docs.sqlalchemy.org/en/latest/dialects/postgresql.html#transaction-isolation-level](http://docs.sqlalchemy.org/en/latest/dialects/postgresql.html#transaction-isolation-level)

设置isolation_level 效果很好。现在我的 Flask 应用程序正在与 PHP 应用程序“对话”。这是代码：

```
engine = create_engine(
    "postgresql+pg8000://scott:tiger@localhost/test",
    isolation_level="READ UNCOMMITTED"
) 
```

当 SQLAlchemy 引擎以“READ UNCOMMITED”隔离级别启动时，它将执行“脏读”，这意味着它将直接从数据库中读取未提交的更改。

希望这可以帮助

* * *

这是 AaronD 在评论中提供的一个可能的解决方案

```
from flask.ext.sqlalchemy import SQLAlchemy

class UnlockedAlchemy(SQLAlchemy):
    def apply_driver_hacks(self, app, info, options):
        if "isolation_level" not in options:
            options["isolation_level"] = "READ COMMITTED"
    return super(UnlockedAlchemy, self).apply_driver_hacks(app, info, options) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-03T12:59:56.407

除了*zzzeek*出色的答案，

我有一个类似的问题。我通过使用短暂的生命周期解决了这个问题。

```
with closing(new_session()) as sess:
    # do your stuff 
```

我为每个任务、任务组或请求使用了一个新会话（如果是 Web 应用程序）。这为我解决了“缓存”问题。

这个材料对我*非常*有用：

[什么时候构建一个 Session，什么时候提交，什么时候关闭它](http://docs.sqlalchemy.org/en/latest/orm/session.html#session-frequently-asked-questions)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-02-20T19:32:44.260

这发生在我的 Flask 应用程序中，我的解决方案是在每次请求后使会话中的所有对象过期。

```
from flask.signals import request_finished
def expire_session(sender, response, **extra):
    app.db.session.expire_all()
request_finished.connect(expire_session, flask_app) 
```

像魅力一样工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T14:03:20.523

首先，SQLAlchemy 没有缓存。根据您从数据库中获取数据的方法，您应该在数据库被其他人更新后进行一些测试，看看您是否可以获得新数据。

```
(1) use connection:
connection = engine.connect()
result = connection.execute("select username from users")
for row in result:
    print "username:", row['username']
connection.close()
(2) use Engine ...
(3) use MegaData... 
```

请按照以下步骤操作： http: [//docs.sqlalchemy.org/en/latest/core/connections.html](http://docs.sqlalchemy.org/en/latest/core/connections.html)

另一个可能的原因是您的 MySQL 数据库没有永久更新。重新启动 MySQL 服务并进行检查。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2012-04-18T13:21:13.370

据我所知，SQLAlchemy[不存储缓存](http://docs.sqlalchemy.org/en/latest/orm/session.html#frequently-asked-questions)，因此您需要查看[日志](http://docs.python.org/library/logging.html#module-logging)输出。

# python - 使用带有命名 url 的 Django 的 RedirectView

> ID：10210084
> 
> 赞同：4
> 
> 时间：2012-04-18T13:10:52.780
> 
> 标签：python, django, django-urls, django-class-based-views

我正在尝试将我的`a_detail`重定向到我的`a_detail_slug`网址。我想为此使用命名的 url，但我还没有成功，这是我尝试过的：

```
url(r'^a/(?P<pk>\d+)/(?P<filler>[\w-]+)/$', AList.as_view(template_name="a.html"), name="a_detail_slug"),

url(r'^a/(?P<pk>\d+)/$', RedirectView.as_view(url=reverse_lazy("a_detail_slug"),), name="a_detail"), 
```

这意味着捕获任何具有有效 pk 的链接，并使用附加的填充符重定向到该页面。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T13:42:40.690

`a_detail_slug`需要 2 个参数 (`pk`和`filler`)，但您没有传递任何参数。最简单的方法是扩展 RedirectView：

```
class ARedirect(RedirectView):
    def get_redirect_url(self, pk):
        filler = get_filler_somehow()
        return reverse('a_detail_slug', args=(pk, filler)) 
```

# java - 如何在Java中获得不同的组合

> ID：10210085
> 
> 赞同：1
> 
> 时间：2012-04-18T13:10:56.123
> 
> 标签：java, string, api, combinations

如果我有一个字符串，说“ABCDE”，那么获得两者组合的最佳方法是什么？是否有用于此类任务的 API？

IE

1.  “AB”
2.  “交流”
3.  “广告”
4.  “AE”
5.  “公元前”
6.  “BD”
7.  “是”
8.  “光盘”
9.  “行政长官”
10.  “德”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:13:39.567

没有 API。最好的阅读来源是 Knuth “The Art of Computer Programming Vol 1”或类似的内容：

[http://webhome.csc.uvic.ca/~haron/CoolCocoon.pdf](http://webhome.csc.uvic.ca/~haron/CoolCocoon.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:27:48.237

```
private static List<String> getCombinations(String input) {
    ArrayList<String> result = new ArrayList<String>();
    int len = input == null ? 0 : input.length();
    for (int i = 0; i < len - 1; i++) {
        for (int j = i + 1; j < len; j++) {
            String combination = String.valueOf(input.charAt(i))
                    + input.charAt(j);
            System.out.println("adding: " + combination);
            result.add(combination);
        }
    }
    return result;
} 
```

为`getCombinations("ABCDE");`

```
adding: AB
adding: AC
adding: AD
adding: AE
adding: BC
adding: BD
adding: BE
adding: CD
adding: CE
adding: DE 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:25:23.073

i+1伪代码：

```
 String alphabet = "ABCDE";
    for( int i = 0; i < alphabet.getLength(); i++){
     for( int j = alphabet.getLength(); j > i; j--){
       System.out.println( alphabet.substring(i, i+1) + alphabet.substring(j, j+1) );
     }
    } 
```

如果您需要更多组合，例如：BA CA 等等，因为只有 2 个字母，您可以切换它们的位置并将此过程的结果附加到生成的对中。如果您需要三个等的组合，请查看置换算法。

# c# - 如何使用日期和时间变量进行数据库咨询？

> ID：10210088
> 
> 赞同：0
> 
> 时间：2012-04-18T13:11:02.673
> 
> 标签：c#, sql, datetime

我有以下行代码用于从数据库中检索数据：

```
DataTable newEquipmentTable = database.Connection.RetrieveData(database.AdapterType, string.Format("SELECT ID FROM Equipment WHERE Name = '{0}' AND CreatedOn = '{1}'", equipment.Name, equipment.CreatedOn.ToString("yyyy-MM-dd HH:mm:ss.fff"))); 
```

它返回一条错误消息“将 varchar 数据类型转换为 datetime 数据类型导致值超出范围”

当我进行直接咨询时，使用以下查询会返回预期结果。

```
SELECT ID FROM Equipment WHERE Name = 'aa' AND CreatedOn = '2012-04-17 19:42:49.650' 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:18:07.920

您正在传递一个`String`值来选择一个`datetime`字段。因此，您需要先将其转换为日期时间：

```
Convert(datetime,'2012-04-17 19:42:49.650', 102) 
```

除此之外，您可能会像@Mr47 提到[的那样对 SQL 注入](http://msdn.microsoft.com/en-us/library/ms161953.aspx)[`SqlParameters`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.aspx)开放，使用.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:16:04.770

请注意，SQL 的`datetime`类型不能保存`1753-01-01`.

只需在用于查询数据库之前使用调试器检查 SQL 字符串以查找问题。

但是，最好的办法是使用参数化查询（如[本例所示](http://www.codinghorror.com/blog/2005/04/give-me-parameterized-sql-or-give-me-death.html)）；否则你很容易受到[SQL Injection](http://en.wikipedia.org/wiki/SQL_injection)的攻击。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:21:49.890

Equipment.CreatedOn 的价值是什么？

我认为 sql-server 或您的应用程序中的文化设置存在问题。它不能直接掩盖您的日期。用户文化设置将解决问题。

# java - java virtual machine: type information

> ID：10210089
> 
> 赞同：0
> 
> 时间：2012-04-18T13:11:04.113
> 
> 标签：java, jvm, virtual-machine

I recently read about JVM specification according to Artima Inside the JVM 2-nd Ed. One of the chapters mentioned type storing in the Java runtime and it said that:

> An instance of class `java.lang.Class` is created by the Java virtual machine for every type it loads. The virtual machine must in some way associate a reference to the Class instance for a type with the type's data in the method area.

I am a little bit confused, as I always thought that `Class` files where places on the method area that contained type information. Is there some other place that Java stores type info?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:16:26.837

是的，正如它所说的那样`an instance of java.lang.Class`是创建的。这意味着代表类文件的**对象**被放置在堆上，以及`Class`方法区域中的文件。

这是`Class`调用 Object 时返回`getClass()`的对象。

# java - Is this garbage-collected or not?

> ID：10210092
> 
> 赞同：2
> 
> 时间：2012-04-18T13:11:10.213
> 
> 标签：java, multithreading, garbage-collection

Here is some code:

```
public class A {
  private volatile B b;

  public void methodC() {
    b.doSomething();
  }

  public void setB(B newB) {
    this.b = newB;
  }
} 
```

'Thread 1' is executing b.doSomething() by executing methodC().

At the same time 'thread 2' set a new B object into 'b'.

My question is:

Could the object previously refereced by 'b' be garbage-collected although doSomething() method on it is still executing?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T13:13:02.907

不，因为为了调用成员函数，您需要引用该对象。因此，正在调用的线程`b.doSomething()`将持有一个引用，从而防止垃圾收集。

*尽管在下面查看 Jon Harrop 的答案以了解何时`b`可能会出现这种情况`GC`。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-11T22:19:43.320

> 之前由“b”引用的对象是否可以被垃圾回收，尽管它的 doSomething() 方法仍在执行？

是的，先前由 'b' 引用的对象可能会被垃圾回收，即使其`doSomething()`上的方法仍在执行。

您可能希望`this`在执行其中一个方法时可以访问，因为方法隐式传递了`this`指针，并且您可能会假设它总是溢出到堆栈中。但是，许多优化可以改变这一点并`this`从 GC 看到的全局根集中删除。

例如，如果方法的主体以`doSomething`不需要`this`的代码结束并且方法是内联的，则`this`可能不会从寄存器溢出到堆栈，或者可能会覆盖其堆栈槽。`this`在任何一种情况下，即使执行仍在内部，GC 也将不再看到`doSomething`，因此`this`可能会被垃圾收集。

# c# - 图形设备管理器

> ID：10210096
> 
> 赞同：1
> 
> 时间：2012-04-18T13:11:13.907
> 
> 标签：c#, graphics, xna, refactoring

任何人都可以请帮忙。[我正在关注从此处](http://msdn.microsoft.com/en-us/library/bb203926%28v=xnagamestudio.10%29.aspx)找到的 MSDN 绘制原语的教程。

我正在尝试对代码进行一点重构，为此我创建了一个名为 MyPrimitives 的类，其中放置了教程中的所有代码。然后从例如 Game11 Initialize() 我可以调用 myPrimitive.Initialize() 等。

但是我在 MyPrimitives CreateVertexBuffer() 方法的这行代码中得到了 NullReferenceException：

```
vertexBuffer = new VertexBuffer(
            graphics.GraphicsDevice,
            vertexDeclaration,
            number_of_vertices,
            BufferUsage.None
            ); 
```

并且从 MyPrimitives Initialize() 方法调用 CreateVertexBuffer()，如下所示：

```
public void Initialize()
    {
        CreateVertexBuffer();
    } 
```

并且 THIS Initialize() 是从 Game1 Initialize() 调用的，如下所示：

```
protected override void Initialize()
    {
        myPrimitiveDrawer = new MyPrimitiveDrawer();

        myPrimitiveDrawer.Initialize();

        base.Initialize();
    } 
```

我知道问题是因为我没有将我的 graphis [GraphicsDeviceManager graphics] 设置为一个对象的实例，但我实际上该怎么做呢？我试过了：

```
public void Initialize()
    {
        graphics = new GraphicsDeviceManager(this);  // Tried this
        CreateVertexBuffer();
    } 
```

但这只会给出无效参数的错误。

请问有人有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T14:03:40.307

从您的主游戏类开始，并使其扩展 Microsoft.Xna.Framework.Game

```
public class Game : Microsoft.Xna.Framework.Game
{
    GraphicsDeviceManager graphics;

    protected override void Initialize()
    {
            graphics = new GraphicsDeviceManager(this);  
            base.Initialize();
    }
} 
```

然后，您只需要确保在项目展开时您的所有类都使用相同的 GraphicsDeviceManager。

# google-maps - How to create a custom Google Maps on a site?

> ID：10210097
> 
> 赞同：0
> 
> 时间：2012-04-18T13:11:17.153
> 
> 标签：google-maps

for the new company site, they want a textbox that has an address, once the person clicks search a google map should appear with lots of points on that area. These points are places pre-defined in a database. Is there any way I can implement this? A great example of this is on laterooms.com:

[http://www.laterooms.com/en/k16296355_manchester-hotels.aspx](http://www.laterooms.com/en/k16296355_manchester-hotels.aspx)

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:52:51.390

我相信您想要的是简单地理编码之间的混搭（此处提供示例）：

[https://google-developers.appspot.com/maps/documentation/javascript/examples/geocoding-simple](https://google-developers.appspot.com/maps/documentation/javascript/examples/geocoding-simple)

和地点（此处提供示例）

[https://google-developers.appspot.com/maps/documentation/javascript/examples/place-search](https://google-developers.appspot.com/maps/documentation/javascript/examples/place-search)

你应该很高兴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:32:00.010

您将在此页面上找到一些很好的信息：查看示例并查看您可以使用代码做什么

[https://developers.google.com/maps/](https://developers.google.com/maps/)

# objective-c - 为什么我们将 NSNumber 和 NSTemporaryNumber 作为两个不同的类？

> ID：10210100
> 
> 赞同：1
> 
> 时间：2012-04-18T13:11:24.780
> 
> 标签：objective-c, gnustep

我浏览了 GNUStep 的 NSNumber 实现的源代码，以了解工厂方法实现是如何在那里工作的。

从那里我可以理解的是，对于所有 initWithXYZ 类型的方法，我们都有 NSNumber 和空白实现。NSTemporaryNumber 就像层次结构中的一个中间类，它实现了所有 initWithXYZ 方法，其中它实际上创建了特定类型的对象，自动释放自身并返回创建的对象。

此外，allocWithZone 被覆盖以避免创建 NSNumber 对象并创建 NSTemporaryNumber 的对象，否则创建特定类型的对象。

我不明白的是，NSNumber 本身不能做同样的事情吗？为什么要给出空白实现，创建特定类型的对象，然后自动释放自我。

此外，如果我们在 NSNumber 本身中实现了 createXYZ 方法，为什么还要使用 initWithXYZ 方法？

如果我必须为我的项目实现一个工厂实现，比如说我有两个 mediaItems、video、audio 和 photo 等，我有单独的类和相应的枚举，我将它们传递给 initWithMediaType，它们将创建一个正确子类的对象，返回它并摧毁自己。

有两个类，如 NSNumber 和 NSTemporaryNumber：比如 Media 和 TemporaryMedia，一个具有空白实现，另一个具有上述实现？

我应该做这样的事情吗？这是我们必须在 Objective C 中实现工厂模式的方式吗？

我的问题可能看起来很愚蠢，但我来自 Java、C++ 背景，情况看起来不同。目的可能是相同的，但我发现很难理解 Objective C 的方式，因为它没有抽象类。

链接到源： [http ://www.koders.com/objectivec/fid46956186C20201706AFE1744AA7AFEEE09D1FE5A.aspx](http://www.koders.com/objectivec/fid46956186C20201706AFE1744AA7AFEEE09D1FE5A.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:50:22.103

关键是这`NSNumber`是一个类集群。你最终得到的类可能是一个`NSIntNumber`，一个`NSFloatNumber`或几个其他的一个。它们都响应相同的消息`NSNumber`（并且，通常在此模式中将是它的子类，但这不是必需的），因此它对调用者没有真正的影响。

当您调用时`alloc`，无法知道要创建哪种对象，因此会创建并返回中性类型。它在收到适当的`init`.

所以这个模式是用于类集群的实现。如果编写一个只提供自身实例的类，您可以忽略它。

# html - 折叠到其子项高度的 CSS 水平条（获取不需要的垂直空间）

> ID：10210102
> 
> 赞同：0
> 
> 时间：2012-04-18T13:11:33.053
> 
> 标签：html, layout, css

我想要一个水平条布局，它将折叠到其子项的高度。

下面的例子几乎让我到了那里，除了我在顶部得到一个不需要的垂直空间，除非我专门将孩子的 line-heights 设置为 >= 1.4em。

为什么包含栏没有完全折叠？

![在此处输入图像描述](../Images/6c80aa02f2e3a67029493a2dd383142d.png)

见[http://jsfiddle.net/ymnmT/](http://jsfiddle.net/ymnmT/)

**HTML：**

```
<div class="hbar hbar1">
    <a>Some button</a><span>Some text</span>
</div>

<div class="hbar hbar2">
    <a>Some button</a><span>Some text</span>
</div> 
```

**CSS：**

```
/*== layout ==*/

.hbar > * {
    display:inline-block;
    vertical-align: middle;
}

.hbar1 > * {
    line-height:1em;
}
.hbar2 > * {
    line-height:2em;
}

/*== styles ==*/

.hbar {background:#DDD;margin:10px;}
a {background-color:#FFF;}
span {background:red;} 
```

* * *

（请注意-寻找使用内联块的解决方案）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:17:48.887

如果您将`line-height`of设置`.hbar`为小于`line-height`子元素的 the ，则应该可以解决问题。问题是 div 的默认行高大于子元素的行高。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:14:31.627

这是因为您将显示设置为 div 的子级的 inline-block 并为它们设置行高。它正在做你告诉它做的事情。你想达到什么目的？

# mysql - I have set index then, when i take back up does not display index details

> ID：10210109
> 
> 赞同：0
> 
> 时间：2012-04-18T13:12:09.523
> 
> 标签：mysql, indexing, innodb, myisam, database-backups

I set index for mysql table, when i take backup using query browser , mysqlworkbench dose not display index details. What is the problem or else any mine mistake.

See mine table. I have set index for "id" column but not display that details.

```
CREATE TABLE IF NOT EXISTS `testsakthi` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` int(11) NOT NULL,
  `status` int(11) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `id` (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1; 
```

My Question is where is index details? EX:

```
CREATE TABLE child (
    id INT, parent_id INT,
    INDEX par_ind (parent_id),
    FOREIGN KEY (parent_id) REFERENCES parent(id) ON DELETE CASCADE
) ENGINE=INNODB; 
```

I have found some url they told some idea. see title " NO_KEY_OPTIONS "

[http://dev.mysql.com/doc/refman/5.1/en/server-sql-mode.html](http://dev.mysql.com/doc/refman/5.1/en/server-sql-mode.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:02:19.263

`mysqldump`如果可能，从命令行使用，索引也将被转储：

```
mysqldump -R --user=username --password=password dnname > outputfile.sql 
```

# security - What value for length field for Freescale PowerPC Security Engine 2.0, when using Link Tables?

> ID：10210113
> 
> 赞同：0
> 
> 时间：2012-04-18T13:12:14.863
> 
> 标签：security, aes, powerpc

I am working on the code to use the security engine of my MPC83XX with Openssl. I can already encrypt/decrypt AES up to 64KByte of data. The problem comes with data greater than 64KByte since the maximum value of the length-bits is 65535.

I can assume the data is always in one piece on the Ram. So now I am collecting all the data in a Link Table and use the pointer to the table instead of the pointer to the data and set the J bit to 1. Now I am not sure what a value I should use for the length-bits since 0 would mean the Dword will be ignored. The real length of the data is too also big for 16 bit.

[http://cache.freescale.com/files/32bit/doc/app_note/AN2755.pdf?fpsp=1](http://cache.freescale.com/files/32bit/doc/app_note/AN2755.pdf?fpsp=1) Possible Informations can be found in Chapter 8.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T18:53:21.240

您将 LENGTH 设置为数据的长度。见第 19 页：

> 对于链接表或链接表链访问的任何数据宗地序列，宗地的组合长度（它们的 LENGTH 和/或 EXTENT 字段的总和）必须等于链接表内存段的组合长度（SEGLEN 字段） . 否则，通道会在通道指针状态寄存器中设置相应的错误位...

我不确定您使用的是什么模式（并且文档似乎不必要地令人困惑！）但是对于通常的密码模式（CBC/CTR/CFB/OFB），通常的方法是简单地链接 AES 调用，重用相同的上下文. 您可以通过简单地将“Pointer Dword1”和“Pointer Dword5”设置为相同的东西来做到这一点。但是，文档很少；我不知道它从哪里得到静脉注射。

# css - 煎茶标签的大小

> ID：10210114
> 
> 赞同：1
> 
> 时间：2012-04-18T13:12:26.930
> 
> 标签：css, tabs, extjs, sencha-touch-2

我想在 css 中修改选项卡的大小。我发现变量 $tabs-bottom-icon-size 仅修改选项卡中图标的大小。
是否有任何变量可以让我修改整个选项卡的大小？
如果没有，我该怎么做？
谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:56:28.990

不幸的是没有。您将不得不覆盖`.x-tabbar`和`.x-tab`类的高度。

```
.x-tabbar {
    height: 5em;
}
.x-tab {
    height: 4.5em;
} 
```

# javascript - Trying to create/bind onClick event to generated through a dojo.xhrGet request

> ID：10210115
> 
> 赞同：0
> 
> 时间：2012-04-18T13:12:30.553
> 
> 标签：javascript, events, dojo

I'm trying to make a piece of dojo Code work and having a bit of a hard time. The intention behind it goes like this:

1- Have a select fire an onChange event that retrieves a list of options through dojo.xhrGet. 2- Have each one of the options retrieved get its own onclick event associated/binded to it and the function that it fires takes 2 arguments

Problem: At this point the onClick event on the options fires as soon as it is retrieved through Ajax and doesn't pass the firt argument. The events stop firing after that (a click produces nothing).

Thank you for your feedback in advance. The Code follows

JS

```
function checkAvailable(i){
    var id_prog = 'programa_'+i;
    var id_coreo = 'coreografia_'+i;

    var prog = dojo.byId(id_prog).value;

    dojo.xhrGet({
        url:"ajaxCoreo.php",
        handleAs:"text",
        content: {
            programa: prog,
            item: i
        }, 
        load: function(data){
            var targetNode = dojo.byId(id_coreo);
            dojo.place(data,targetNode,"only");
            dojo.byId(id_coreo).disabled = false;
            var callback = function(evt){
                var j = evt.target.innerHTML;

                checkPack(j,i);
                console.log('write me if you fire inside first function');
            };
            dojo.query("#coreografia_1>option").connect('click', callback);
            setValor(i);
        }

    });

}

    function checkPack(j,i){
    console.log('write me if you fire inside second function');
    console.log(j);
    console.log(i);

    var num = j;
    var id_prog = 'programa_'+i;
    var id_coreo = 'coreografia_'+j;

    var prog = dojo.byId(id_prog).value;

    dojo.xhrGet({
        url:"ajaxPack.php",
        handleAs:"text",
        content: {
            programa: prog,
            coreo: j
        },
        load: function(data){

            if(data=="true"){
                dojo.query("option[value="+num+"]").forEach(dojo.destroy);
                alert('O Pack escolhido já foi encomendado previamente.');
                setValor(i);
            }

        }

    });

} 
```

HTML

```
<select name="programa[]" id="programa_1" onChange="checkAvailable(1)" title="obrigatorio">
                <option value="0">Choose your program</option> 

</select>
 <select name="coreografia_1" id="coreografia_1" disabled="disabled" title="obrigatorio">
                <option value="0" selected="selected">Escolha Um Programa</option> //this is the node that is populated by the first xhrGet call
            </select> 
```

EDIT: I've edited the code to reflect the changes to it and added the html

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T14:41:57.900

根据我的经验，如果您花费超过 1 天的时间尝试跟踪跨浏览器问题，那么它可能与您的基本 html 知识或基本 Js 概念有关。

这与只有 FF 管理直接附加到选项标签的 onclick 事件这一事实有关。对于其他人，您需要将 onchange 附加到父级。

所以这是工作代码的最终版本，以防有人遇到类似问题

```
function checkAvailable(i){
    var id_prog = 'programa_'+i;
    var id_coreo = 'coreografia_'+i;

    var prog = dojo.byId(id_prog).value;

    dojo.xhrGet({
        url:"ajaxCoreo.php",
        handleAs:"text",
        content: {
            programa: prog,
            item: i
        }, 
        load: function(data){
            var targetNode = dojo.byId(id_coreo);
            dojo.place(data,targetNode,"only");
            dojo.byId(id_coreo).disabled = false;
            var callback = function(evt){
                var j = evt.target.value;
                checkPack(j,i);
            };
            dojo.query("#coreografia_"+i).connect('onchange', callback);
            setValor(i);
        }

    });

}

    function checkPack(j,i){
    console.log('write me if you fire inside second function');
    console.log(j);
    console.log(i);

    var num = j;
    var id_prog = 'programa_'+i;
    var id_coreo = 'coreografia_'+j;

    var prog = dojo.byId(id_prog).value;

    //Confirma Se não há encomendas previas deste pack (um máximo de 2 anteriores)

    dojo.xhrGet({
        url:"ajaxPack.php",
        handleAs:"text",
        content: {
            programa: prog,
            coreo: j
        },
        load: function(data){

            if(data=="true"){
                dojo.query("#coreografia_"+i+" option[value="+num+"]").forEach(dojo.destroy);
                alert('O Pack escolhido já foi encomendado previamente.');

            }

        }

    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:09:43.230

通过检查您的代码，我可以看到在函数**checkAvailable**中，在您连接到*onclick*事件的行中，而不是将函数作为*回调*传递，您正在*调用*它。

```
dojo.connect(opt,'onclick', checkPack(opt.target.innerHTML,i)); 
```

你应该这样做：

```
var callback = function(){
    checkPack(opt.target.innerHTML,i);
};
dojo.connect(opt,'onclick', callback); 
```

# google-tv - 我可以通过命令在 Google TV 中触发 PiP（画中画）吗？

> ID：10210118
> 
> 赞同：3
> 
> 时间：2012-04-18T13:12:43.640
> 
> 标签：google-tv

我试图弄清楚如何通过软件命令而不是遥控器上的按钮来触发 Google TV 中的画中画功能。据我所知，API 中目前没有任何内容可以让我这样做。所以，2个问题：

1.  有没有人尝试过黑客来实现这一点？如果是这样，你能分享一下吗？
2.  有谁知道 Google 是否计划将其添加到 API 中？

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T17:57:14.897

不，你不能。无计划。对不起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T15:22:31.170

您可以从移动设备使用 Anymote 触发 PIP。

# c++ - C++ - 高级多态：这个函数从列表中删除指针是否合法？

> ID：10210122
> 
> 赞同：2
> 
> 时间：2012-04-18T13:12:52.913
> 
> 标签：c++, class, inheritance, pointers, polymorphism

我有许多从抽象基 SysLaserBase 继承的类。正如您在函数 addLaser() 中看到的那样，我将每个激光添加到程序中的列表（指向对象的指针向量）。这工作得很好，而且完全可以工作，我可以循环使用我创建的所有激光器并毫无问题地使用他们的方法。

当我想从系统中“移除”激光时，就会出现问题。我通过将对象的地址与基类指针向量中的所有地址进行比较来做到这一点。这合法吗？它导致程序有时崩溃。有什么选择？

请在此处找到方法的代码，然后是导致崩溃的调用示例。你发现 removeLaser() 的代码有什么问题吗？为什么在移除单个激光后整个系统会变得疯狂？

涉及的向量在基类的主体中：

```
std::vector<SysLaserBase<T>*> lasers; 
```

以及添加和删除方法：

```
template <typename T>
void SysSystemBase<T>::addLaser(const SysLaserBase<T> &src)
{
    bool alreadyThere = 0;
    for(unsigned long i = 0; i < lasers.size(); i++)
    {
        if(&src == lasers[i])
        {
            alreadyThere = 1;
            break;
        }
    }
    if(!alreadyThere)
    {
        lasers.push_back(const_cast<SysLaserBase<T>*>(&src));
    }
    signalsOut.resize(lasers.size());
}

template <typename T>
void SysSystemBase<T>::removeLaser(const SysLaserBase<T> &src)
{
    for(typename std::vector<SysLaserBase<T>*>::iterator it = lasers.begin(); it != lasers.end(); ++it)
    {
        if((*it) == &src)
        {
            lasers.erase(it);
        }
    }
    signalsOut.resize(lasers.size());
} 
```

调用此代码：

```
sys.addLaser(las0);
sys.addLaser(las1);
sys.addLaser(las2);
sys.removeLaser(las0); //removes the laser, but cycling through the lasers through the vector of base class causes a crash
sys.removeLaser(las1);
sys.removeLaser(las2); //crashes the program immediately after this call 
```

感谢您的任何努力:-)

* * *

感谢您的答复。根据您的回复，我已将 removeLaser() 更改为：

```
template <typename T>
void SysSystemBase<T>::removeLaser(const SysLaserBase<T> &src)
{
    for(typename std::vector<SysLaserBase<T>*>::iterator it = lasers.begin(); it != lasers.end(); ++it)
    {
        if((*it) == &src)
        {
            lasers.erase(it);
            break;
        }
    }
    signalsOut.resize(lasers.size());
} 
```

现在好了。谢谢 ：-）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T13:15:06.220

`it`后失效`lasers.erase()`。来自[`std::vector::erase()`](http://en.cppreference.com/w/cpp/container/vector/erase)：

> 迭代器和对已擦除元素以及它们与容器末端之间的元素的引用无效。

从或`break`从`for`保存返回值`erase()`。

# sql - SSIS 版本签出

> ID：10210130
> 
> 赞同：2
> 
> 时间：2012-04-18T13:13:08.803
> 
> 标签：sql, sql-server-2008, ssis, business-intelligence

这是我在这个论坛上的第一篇文章。

我一直坚持使用 Microsoft SSIS 包，我真的不知道如何打败它。我提到了 SSIS 包文件，我尝试在 SQL Server 2005 上使用 Business Intelligence Development Studio 打开它 - 结果出现错误，提示我需要另一个版本 - 我认为它使用 SQL Server 2008 进行了 BIDS。

正如我进一步阅读的那样，SQL Server 2008 似乎没有免费版本的 BIDS。

如果您知道如何处理它，请告诉我。感谢您的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:37:16.503

下载带有高级服务版本的 SQL Server Express 2008，它应该为您提供 BIDS 环境的免费版本。链接是[http://www.microsoft.com/download/en/details.aspx?id=1842](http://www.microsoft.com/download/en/details.aspx?id=1842)

# android - 将 flickr 中的私人图片加载到 imageView 中

> ID：10210132
> 
> 赞同：3
> 
> 时间：2012-04-18T13:13:14.437
> 
> 标签：android, flickr

我需要将一些私人图片从 flickr 加载到 imageViews 中。我尝试使用 flickrj-android，但我真的不明白它是如何工作的。我的猜测是我需要先获得 oauth-token。我能做到的。但是我该如何从那里着手呢？我已经用谷歌搜索了，但没有发现任何有用的东西。我想要的只是一种构造我的 URL 的方法，这样我就可以将图片加载到 ImageViews 中。有没有人以前使用过 flickr 并且知道一个很好的分步教程？不可能那么难。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:20:53.773

由于您对从授权到 Flickr url 构建的整个流程有疑问，我建议您查看开源示例应用程序[Android Photostream](http://android-developers.blogspot.com/2008/09/android-photostream.html)，其中包含创建自己的基本 Flickr 应用程序所需的一切。它是[apps-for-android](http://code.google.com/p/apps-for-android/)项目的一部分。

# jquery - jquery中的箭头点击

> ID：10210133
> 
> 赞同：1
> 
> 时间：2012-04-18T13:13:16.387
> 
> 标签：jquery, reset, increment

我有 2 个箭头，一个将计数器增加 1，左边一个减少它我要解决的问题是处理负数的良好逻辑（它应该转到列表中的最后一项），而在另一端，当计数器超过了它应该返回到 0 的最大项目数。

我正在寻找一些很好的逻辑来实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:16:56.180

每当您增加时，请检查新值。如果它大于选项总数，请将其重置为零。如果它小于选项总数，请将其设置为最大值。否则，简单地`+=1`或`-=1`。

例如：

```
var total = 5,
    currentNumber = 0,
    numContainer = $("#number");

$(".up, .down").on("click", function(){
  currentNumber = parseInt( numContainer.text(), 10 );
  if ( $(this).hasClass("up") ) {
   if ( ++currentNumber > total ) currentNumber = 1; 
  }
  if ( $(this).hasClass("down") ) {
   if ( --currentNumber < 1 ) currentNumber = total; 
  }
  numContainer.text( currentNumber );
}); 
```

这可以进一步简化为使用三元运算符以及破解短路合取运算符的功能：

```
var t = 5, c = 0, n = $("#number");

$(".up, .down").on("click", function(){
  c = parseInt( n.text(), 10 );
  $(this).hasClass("up") ? (++c > t) && (c = 1) : (--c < 1) && (c = t); 
  n.text( c );
}); 
```

演示：http: [//jsbin.com/egifas/edit#javascript,live](http://jsbin.com/egifas/edit#javascript,live)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:16:59.207

您可以为此使用模运算符：

```
(num + total) % total 
```

如果你想要 1..total 而不是 0..total-1，请使用`((num + total) % total) + 1`

所以（伪）代码可能如下所示：

```
function inc() {
    num = (num + 1 + total) % total;
}

function dec() {
    num = (num - 1 + total) % total;
} 
```

这`+total`是必要的，因为负值的模运算符的行为在不同语言之间并不一致，并且它始终有效，因为您永远不会得到负值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:42:22.797

我发现使用 % 运算符不是最简单的方法。它只会在你根本不需要它的地方增加复杂性，imo。但是，我并不是说这是错误的。

所以，简单的方法。实际上，您需要的只是幻灯片的总数（或您在那里拥有的任何元素/对象）。您的两种方法可能如下所示：

```
var counter = 0;
var total = 7; // u will need to set this to your own totalCount value.

function incrementCounter() 
{
  counter = (counter < total - 1) ? counter + 1 : 0;
}

function decrementCounter() 
{
  counter = (counter > 1) ? counter - 1 : total;
} 
```

请不要，那段代码实际上什么也没做。它甚至不检查数据的有效性（即，如果设置了全局变量，如果总计实际上大于零等）。无论如何，基于这个你可以使用这个**计数器**变量来显示一些内容，或者移动图像或者你在那里做的任何事情。此外，您可能希望将其更改为基于零索引。如果您在那里使用 JS 数组，这将很有用，因此您不需要 +/- 1 的索引来获取元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T13:37:02.210

Theifmaster 是对的，我自己几乎就在那里

```
var num = 0;
var total = 5;
if (direction == 'left') {
num = (num - 1 + total) % total;
}

if (direction == 'right') {
num = (num +  1 + total) % total;
alert(num);

} 
```

因此，如果您在我的示例中单击左箭头，它应该是-1，但这使它成为 4 mod 5 = 4。我的逻辑太长了，这是一种更简洁的方法。

# c# - 使用矩阵单独旋转矩形

> ID：10210134
> 
> 赞同：7
> 
> 时间：2012-04-18T13:13:19.787
> 
> 标签：c#, winforms, math, gdi+, graphics2d

有一点绘图的复杂性，你会称之为。当涉及到矩阵和在形状上绘制旋转时，我的数学有点生疏。这是一段代码：

```
private void Form1_Paint(object sender, PaintEventArgs e)
    {
        g = e.Graphics;
        g.SmoothingMode = SmoothingMode.HighQuality;
        DoRotation(e);
        g.DrawRectangle(new Pen(Color.Black), r1);
        g.DrawRectangle(new Pen(Color.Black), r2);

        // draw a line (PEN, CenterOfObject(X, Y), endpoint(X,Y) )
        g.DrawLine(new Pen(Color.Black), new Point((r1.X + 50), (r1.Y + 75)), new Point((/*r1.X + */50), (/*r1.Y - */25)));

        this.lblPoint.Text = "X-pos: " + r1.X + " Y-pos: " + r1.Y;

        //this.Invalidate();
    }
    public void DoRotation(PaintEventArgs e)
    {
        // move the rotation point to the center of object
        e.Graphics.TranslateTransform((r1.X + 50), (r1.Y + 75));
        //rotate
        e.Graphics.RotateTransform((float)rotAngle);
        //move back to the top left corner of the object
        e.Graphics.TranslateTransform(-(r1.X + 50), -(r1.Y + 75));
    }
    public void Form1_KeyDown(object sender, KeyEventArgs e)
    {
        case Keys.T:
                rotAngle += 1.0f;
    } 
```

当我旋转（我认为应该是 r1）时，r1 和 r2 都会旋转。当我添加更多形状时，我需要能够单独旋转每个形状。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-18T13:40:36.810

我会使用与此类似的功能：

```
public void RotateRectangle(Graphics g, Rectangle r, float angle) {
  using (Matrix m = new Matrix()) {
    m.RotateAt(angle, new PointF(r.Left + (r.Width / 2),
                              r.Top + (r.Height / 2)));
    g.Transform = m;
    g.DrawRectangle(Pens.Black, r);
    g.ResetTransform();
  }
} 
```

它使用矩阵在某个点执行旋转，该点应该是每个矩形的中间。

然后在您的绘画方法中，使用它来绘制您的矩形：

```
g.SmoothingMode = SmoothingMode.HighQuality;
//g.DrawRectangle(new Pen(Color.Black), r1);
//DoRotation(e);
//g.DrawRectangle(new Pen(Color.Black), r2);

RotateRectangle(g, r1, 45);
RotateRectangle(g, r2, 65); 
```

此外，这是连接两个矩形的线：

```
g.DrawLine(Pens.Black, new Point(r1.Left + r1.Width / 2, r1.Top + r1.Height / 2),
                       new Point(r2.Left + r2.Width / 2, r2.Top + r2.Height / 2)); 
```

使用这些设置：

```
private Rectangle r1 = new Rectangle(100, 60, 32, 32);
private Rectangle r2 = new Rectangle(160, 100, 32, 32); 
```

导致：

![在此处输入图像描述](../Images/5b27646c09919bb1ceb331f7da628ec3.png)

# c++ - 使用 CMAKE 如何使用 CHECK_LIBRARY_EXISTS 检查 C++ 库？

> ID：10210138
> 
> 赞同：2
> 
> 时间：2012-04-18T13:13:28.507
> 
> 标签：c++, cmake

我正在尝试使用cmake的功能：

```
CHECK_LIBRARY_EXISTS(library function location variable) 
```

如何检查 C++ 库是否可用？

```
CHECK_LIBRARY_EXISTS(yaml-cpp "YAML::Token" ${YAML-CPP_PATHS} HAVE_YAML-CPP)
IF(HAVE_YAML-CPP)
    MESSAGE(STATUS "YAML-CPP libraries founded: OK")
ENDIF(HAVE_YAML-CPP)

IF(NOT HAVE_YAML-CPP)
    MESSAGE(FATAL_ERROR "ERROR: unable to link YAML::Token")
ENDIF(NOT HAVE_YAML-CPP) 
```

该代码片段不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T13:28:40.933

该`CheckLibraryExists`模块仅适用于 C 符号，不适用于 C++。就我个人而言，我只会使用`find_library`并`find_path`查找库和包含路径。如果库不包含正确的符号，用户将在链接过程中很快注意到......

由于 yaml-cpp 安装了一个 pkg-config 文件，因此您也可以使用该`FindPkgConfig`模块。但是，由于 yaml-cpp 本身是使用 CMake 构建的，因此您应该鼓励他们实际安装`yaml-cpp-config.cmake`文件。有关更多信息，请参见本[教程](http://www.cmake.org/Wiki/CMake/Tutorials/How_to_create_a_ProjectConfig.cmake_file)。

# android - 将 AJAX 函数的 URL/IP 地址更改为静态

> ID：10210142
> 
> 赞同：0
> 
> 时间：2012-04-18T13:13:47.307
> 
> 标签：android, asp.net, html, ajax, url

现在，我有一个使用 [html、asp.net、sql server、javascript 和 ajax] 制作的 Web 应用程序。像往常一样，我使用 ajax 使用 aspx 页面向服务器发送数据。我的应用程序运行良好，但我想在 Android 上部署它。

我在 ajax 函数中使用的 asp url 是：

```
 url:'http://localhost:49169/xxxxx.aspx' 
```

如您所见，这在移动设备上不起作用，因为网址每次都会更改。那么我应该怎么做才能更改 url 和 IP 地址以使其成为静态并在不重新编译项目的情况下采用 IP 的新配置？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:38:20.687

这取决于您使用的 Visual Studio 版本。但一般要点是，您可以将端口从它为您选择的“使用动态端口”（例如 49169）设置为您可以指定的固定端口。

以下是 2008 年视觉工作室的说明，我相信其他版本的视觉工作室的说明相同（或非常相似）：http: [//msdn.microsoft.com/en-us/library/ms178109%28v=vs.90 %29.aspx](http://msdn.microsoft.com/en-us/library/ms178109%28v=vs.90%29.aspx)

# c# - RxExp 匹配第一个标签

> ID：10210144
> 
> 赞同：3
> 
> 时间：2012-04-18T13:13:57.117
> 
> 标签：c#, .net, regex

我正在尝试匹配第一个标签中的文本内容`<test>`。

例如：

```
<test>SAMPLE TEXT</test><test>SAMPLE TEXT2</test><test>SAMPLE TEXT3</test> 
```

如果我使用

```
("<test>(.*)</test>")` 
```

我懂了：

```
SAMPLE TEXT</test><test>SAMPLE TEXT2</test><test>SAMPLE TEXT3 
```

如何从第一个`<test>`标签中获取内容：`SAMPLE TEXT`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T13:14:50.813

`(.*)`是贪婪的（意思是“你可以匹配的所有东西，直到你找到*最后一个* `</test>`”），你正在寻找非贪婪的版本`(.*?)`（意思是“尽可能少地匹配，直到你找到第*一个* `</test>`”）。

但是，在考虑使用正则表达式解析 HTML 时，请记住[Cthulu 的调用，](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)并查看[此问题](https://stackoverflow.com/questions/56107/what-is-the-best-way-to-parse-html-in-c)以讨论使用 .NET 解析 HTML 的最佳实践。或者，如果这是 XML（不是 HTML），那么一定要以正确（且简单）的方式使用[`XmlReader`](http://msdn.microsoft.com/en-us/library/cc189056(v=vs.95).aspx).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:16:52.220

@Radu 的回答非常好，但也可以尝试以下评论：

```
"<test>([^<]*)</test>" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:15:35.653

而不是`.*`使用`.*?`

问号使星号变得懒惰，使其尽可能少地匹配。没有它，星号是贪婪的，并且尽可能匹配。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T13:18:41.713

我同意您可以使用 XML 解析库，但无论如何我都会回复：

```
("<test>([^<]*)</test>") 
```

将解析与“<”不同的所有字符，这是您要忽略的第一个字符。

HTH。

# php - Symfony 1.4：如何操作attributeHolder？

> ID：10210147
> 
> 赞同：1
> 
> 时间：2012-04-18T13:14:08.583
> 
> 标签：php, session, symfony1, symfony-1.4

我在 myUser attributeHoler 中有一个名为“admin_module”的属性，我想对其进行操作……但我什至不知道如何访问存储在那里的值。我知道如何在操作中获取 AttributeHolder，但我不知道如何访问其中的值。任何帮助表示赞赏...在此先感谢。;)

回答后编辑：

得到：

```
$this->getUser()->getAttributeHolder()->set('beilagenbuchung.page', 1, 'admin_module'); 
```

放：

```
$this->getUser()->getAttributeHolder()->get('beilagenbuchung.page', null, 'admin_module'); 
```

问候

尼尔斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:24:16.177

检查[文档](http://www.symfony-project.org/gentle-introduction/1_4/en/06-Inside-the-Controller-Layer#chapter_06_user_session)？

顺便说一句，您可以使用 Web 调试工具栏查看所有属性：config > User > attributeHolder。Key 是使用的命名空间（如果您定义一个）。

另请参阅[sfUser.class.php](http://trac.symfony-project.org/browser/branches/1.4/lib/user/sfUser.class.php#L267)，getter 将在其中检索属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:27:24.633

在任何上下文（*含义`sfAction`，`sfComponent`...*）之外，您始终可以设置如下属性：

```
sfContext::getInstance()->getUser()->setAttribute('key', 'value'); 
```

# asp.net - ASP.NET Intranet 和 Internet 网站

> ID：10210150
> 
> 赞同：2
> 
> 时间：2012-04-18T13:14:25.253
> 
> 标签：asp.net

我正在为 Intranet 用户设计 ASP.NET 网站。在第一阶段结束时，这将提供给 Intranet 用户。

但是在第二阶段之后，需要向该办公室以外的某些用户开放相同的站点。

我可以使用 ASP.NET Membership 提供程序吗？

还有其他设计建议吗？

感谢您的意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:21:48.753

是的，您可以使用 ASP.Net 成员资格提供程序来允许外部用户注册和登录该站点。使用它可以确保密码使用盐进行散列并加密，从而使用户数据更加安全。ASP.Net 成员提供程序有一个庞大的 API 集，这可能会让开发人员感到困惑，等等。WebMatrix 套件中有一个简化的成员资格提供程序，称为 SimpleMembershipProvider，它位于 WebMatrix.WebData 命名空间中。这提供了足够的 API 来创建、管理、验证和授权外部用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:29:21.227

这取决于您所说的“在这个办公室之外”是什么意思。您可以将 ASP.NET 成员资格类与可能满足您需要的任何类型的提供程序一起使用。您是指 Intranet 用户，您希望用户能够使用他们的 Windows 域帐户登录到您的网站吗？

通常，您可以使用`SqlMembershipProvider`ASP.NET 登录控件对具有一组给定表的 SQL Server 数据库对用户进行身份验证。如果您想使用登录控件并且希望用户能够使用他们的 Windows 帐户登录，您可以使用`ActiveDirectoryMembershipProvider`. 如果以上都不适合您，则始终可以选择实现自定义提供程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T14:04:08.297

这就是我会做的。

*   我会使用 ASP.net MembershipProvider 并使用 SQL 服务器来存储它。
*   创建角色（内部用户和外部用户）
*   我会为所有用户的密码使用高度加密
*   用户角色以限制外部用户可以看到的信息

# c - 如何优化运行重循环的两个线程

> ID：10210162
> 
> 赞同：2
> 
> 时间：2012-04-18T13:15:17.790
> 
> 标签：c, linux, multitasking

我有更多的概念问题。假设一个程序运行两个线程。两个线程一直在运行循环。一个线程负责流式传输数据，另一个线程负责接收第一个线程必须流式传输的文件。因此，文件传输线程循环接收它写入文件的数据，流线程在需要时从该文件中读取该数据并将其流式传输。

我在这里看到的问题是，当文件传输占用过多的 CPU 周期并因此导致流线程滞后时，如何避免饥饿？

我如何能够在这两个线程之间有效地共享 CPU 知道流传输数据远慢于文件传输接收它。

我感谢你的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T14:15:48.173

很多时候这类问题是通过使用某种流控制来解决的：

*当接收者忙时阻止发送者。*

这也会导致问题：如果你的程序必须能够快进（seek forward），那么这不是一个好主意。

在您的情况下，当文件中有超过 2MB 的非流式数据时，您可以阻止文件传输线程。并在未流式传输数据少于 1MB 时恢复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:35:05.907

看看是否`pthread_setschedparam()`有助于平衡线程对 CPU 的使用

从[手册页](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_setschedparam.3.html)中`pthread_setschedparam`，您可以更改线程优先级。

```
 pthread_setschedparam(pthread_t thread, int policy,
                         const struct sched_param *param);

       struct sched_param {
           int sched_priority;     /* Scheduling priority */
       };

   As can be seen, only one scheduling parameter is supported.  For details of
   the permitted ranges for scheduling priorities in each scheduling policy, see
   sched_setscheduler(2). 
```

还，

> 文件传输占用了太多的 CPU 周期

如果您阅读此[SO 帖子](https://stackoverflow.com/questions/5374902/c-linux-pthread-thread-priority)，似乎表明更改线程优先级可能无济于事。因为文件传输线程消耗更多 CPU 周期的原因是*它需要它*。但是在您的情况下，如果文件传输速度变慢，因为流媒体线程无论如何都无法竞争，您就可以了！因此，我建议您更改优先级并剥夺文件传输线程的一些周期*，即使需要它*

# .htaccess - .htaccess 规则，用于在扩展匹配时设置目录重写

> ID：10210165
> 
> 赞同：1
> 
> 时间：2012-04-18T13:15:28.443
> 
> 标签：.htaccess, mod-rewrite, rewrite

目前我有

```
RewriteRule ^olddir/(.*).xls newdir/one/$1.xls
RewriteRule ^olddir/(.*).jpg newdir/one/$1.jpg 
```

目前，我想重写的所有文件扩展名都放在单独的行上。

我确定有更短的方法`(.xls|.jpg)`吗？这但我缺乏 htaccess 技能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:19:31.963

也许

```
RewriteRule ^olddir/(.+)\.(jpg|xls)$ newdir/one/$1.$2 
```

或者

```
RewriteRule ^olddir/(.+\.(jpg|xls))$ newdir/one/$1 
```

不确定第二个，因为我没有尝试过，但应该可以工作......并将 * 更改为 + 因为可能应该至少有一个字符，并在 . 否则它将匹配任何字符

此外，如果您在 mod_rewrite 使用的正则表达式方面需要帮助，请查看[http://httpd.apache.org/docs/current/rewrite/intro.html](http://httpd.apache.org/docs/current/rewrite/intro.html)

# java - java.io.File length() 可以锁定文件并阻止 File.delete() 工作吗？

> ID：10210168
> 
> 赞同：1
> 
> 时间：2012-04-18T13:15:41.313
> 
> 标签：java, filesystems, file-locking

我有一个多线程 java 应用程序，日志代码在 1 个线程中使用 File.length，但仅用于日志记录。

无论此日志记录如何，我都希望能够从其他线程中删除。

java.io.File.length() 调用可以锁定文件并阻止 java.io.File.delete() 调用工作吗？

我正在使用 Windows Sun/Oracle JRE（目前为 1.6.0_30）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:18:06.753

这将是文件系统的属性，而不是 JVM，因此不可能用简单的“是”或“否”来回答这个问题。在打开文件进行读取或写入时无法工作的已知问题`delete()`是 Windows 特有的问题，在类 UNIX 系统上不会发生。

但在您的具体情况下，这在 Windows、Linux 或 Mac OS X 上都不是问题，也许这个答案已经足够好了！

# php - 安装开放式邀请器

> ID：10210169
> 
> 赞同：0
> 
> 时间：2012-04-18T13:15:43.810
> 
> 标签：php

我正在为我的公司进入 PHP 世界，但遇到了一些问题。现在我的经验很少，我希望能得到一些帮助，让我了解它是如何工作的。

我的第一个问题是我正在尝试为我的产品设置销售页面，并且我希望弹出一个打开的邀请脚本以“邀请您的朋友查看此页面以获得额外的免费奖励”（仅当客户想要时购买我的产品，所以这里没有垃圾邮件）

但是在过去的 5 天里，我一直在尝试和尝试，但我根本无法让它工作，无论我做什么，邀请者都显得空白。

现在我可能知道问题出在哪里，因为我今天找到了它，我的公开邀请人已被修改，但我找到了原始邀请人并且它有要求：

“您的服务器需要安装 PHP5 并支持 DOMDocument 以及 cURL 或 WGET。”

如果我通过 .htpaccess 文件放置一行，我发现我的托管公司支持 php5。但其余的像 domdocuments 或 cURL 是我似乎只是理解它是如何工作的，我已经浏览了数百个网站试图弄清楚这一点，但我无法得到一个足够简单的解释，说明它到底是什么以及我如何让它工作与我的托管。

有人知道如何在我的网站上安装我的公开邀请者吗？

下面是安装细节：

“感谢您下载 OpenInviter 通用软件包。本文档将指导您完成安装过程。

答：要求：您的服务器需要安装 PHP5 并支持 DOMDocument 以及 cURL 或 WGET。B：安装： 1、解压刚才下载的openinviter.tar.gz文件内容。注意：tar -xzvf openinviter.tar.gz 2\. 将提取的文件上传到您的网络服务器（强烈建议使用子文件夹）。3\. 运行 postinstall.php (http://yourdomain/openinviter_dir/postinstall.php)

您可能会遇到以下错误： i) cookie 存储文件夹如果不可写。（更改 cookie 文件夹或修改它的权限。） ii) 未安装 Php DOM 扩展。（为php安装dom扩展）

iii) 您没有安装 curl 或 wget。（安装 curl 或 wget）

您可能会遇到以下警告：

i) 插件无法正常工作。（您的服务器有防火墙或存在连接错误）

注意：您必须修复所有错误，否则 openinviter 可能无法正常工作。

注意*：您不能在 2 分钟内再次运行 postinstall.php。

1.  编辑 config.php 以满足您的需要。
2.  删除 postinstall.php
3.  运行 example.php (http://yourdomain/openinviter_dir/example.php) 并尝试获取您的联系人。

    注意：example.php 是可修改的，但请记住文件的结构。”

# php - Mysql 连接到 VLAN 外的外部/远程服务器

> ID：10210173
> 
> 赞同：2
> 
> 时间：2012-04-18T13:15:52.560
> 
> 标签：php, mysql, linux, vpn

我正在尝试从我的应用程序将运行的 vlan 内的计算机连接到外部 mysql 服务器。远程服务器不是 vlan 的成员。以下是我到目前为止所尝试的。

**来自我的 vlan 服务器的 Mysql 端口转发**

```
ssh -L 3306:my-vlan-server-ip:3306 user-at-external-server@external-server-ip 
```

在这种情况下，我会收到一条 ssh 超时消息。尝试直接从我的 php mysql_connect 执行此操作我得到 mysql 错误 #111 但我已经将**my.cnf**编辑为：

```
#skip-networking
bind-address  =my-vlan-server-ip 
```

**我的 php db 连接脚本**

```
<?php
$conn=mysql_connect("external-server-ip","user","pass");
if($conn)
{
echo "success";
}
else
{
echo "fail";
}
?> 
```

请有人帮忙。让我知道我哪里出错了。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T15:14:38.173

如果我理解正确，您是在 vlan 服务器 (=my-vlan-server-ip) 上运行 ssh 客户端吗？

本地隧道（-L）基本上将第一个端口转发到给定地址上的给定端口，即 -L 80:someserver:8080 将本地机器上的端口 80 转发到 someserver 上的端口 8080... 所以如果你想连接通过 ssh 到远程服务器上的 3306 你这样做：

ssh -L 3306:external-server-ip:3306 user-at-external-server@external-server-ip （或者只是 -L 3306:localhost:3306，localhost 将指代您正在连接的服务器，即外部服务器 IP）

localhost:3306 然后转发到 external-server-ip:3306

然后在 my-vlan-server-ip 上运行的 php 脚本中连接到 localhost:3306，然后通过 ssh 将其转发到 external-server-ip ...

# regex - And 使用 grep/正则表达式的语句

> ID：10210177
> 
> 赞同：2
> 
> 时间：2012-04-18T13:16:03.077
> 
> 标签：regex, unix, grep

我正在使用 grep 在特定目录中搜​​索文本。我想返回包含 stringA 和 stringB 的文本行。

我知道做**grep "stringA|stringB"**实际上是一个 OR 语句，有什么我可以做的，也许使用正则表达式，可以让我运行一个 AND 语句？

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T13:23:05.013

如果您不知道项目的顺序，您总是可以使用 | 反转模式

```
grep '1st pattern.*2nd pattern|2nd pattern.*1st pattern' foofile 
```

这适用于两个项目，三个或更多肯定会开始减慢速度......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:18:09.717

您可以通过两个 grep 进行管道传输：

```
 ... | grep "stringA" | grep "stringB" 
```

请注意，如果您的模式实际上是固定字符串而不是正则表达式，那么您可以使用[`fgrep`](http://ss64.com/bash/fgrep.html)而不是`grep`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:19:00.440

```
"stringA.*stringB" 
```

这将在 stringB 之间找到任意数量的任意字符的 stringA

# forms - 从将数据发布到谷歌电子表格的表单中获取成功消息

> ID：10210179
> 
> 赞同：0
> 
> 时间：2012-04-18T13:16:07.133
> 
> 标签：forms, html

我一直在开发一个表单并将其链接到 Google Docs 电子表格。因此，当用户输入详细信息时，它会直接进入电子表格并进行填充。我从这里的这段代码中得到了建议；

[http://mashe.hawksey.info/2011/10/google-spreadsheets-as-a-database-insert-with-apps-script-form-postget-submit-method](http://mashe.hawksey.info/2011/10/google-spreadsheets-as-a-database-insert-with-apps-script-form-postget-submit-method)

它在这里完美运行：http: [//betaburo.markdunbavan.co.uk](http://betaburo.markdunbavan.co.uk)

我唯一的问题是我想创建成功消息和错误消息。

main.js 文件中有一些代码基本上可以验证它，但它无法正常工作或识别错误或成功。

任何帮助将非常感激。

谢谢，马克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:43:47.577

如果您使用 jQuery，您可以检查是否已输入某些内容。有几种方法可以做到这一点。

例如，如果您想验证您的名字字段，您可以这样做：

```
if ($('input#field1').val() == ''){
       $('span.successMessage').hide();
       $('span.errorMessage').show();
       }
else {
       $('span.successMessage').show();
       $('span.errorMessage').hide();
     } 
```

您还可以在输入上使用 .serialize，然后根据序列化条目的长度显示成功/错误消息（id 在序列化条目上使用 .length）。

# workflow - 在 AppFabric 中配置应用程序端点

> ID：10210182
> 
> 赞同：2
> 
> 时间：2012-04-18T13:16:17.123
> 
> 标签：workflow, workflow-foundation-4, appfabric

我在 Windows 7 机器上的 IIS 7.5 中使用 AppFabric 1.1 将我的工作流作为服务托管。虽然我能够在 IIS 的 AppFabric 仪表板中看到系统端点和应用程序默认端点，但我无法看到我在应用程序的 Web.config 文件中定义的端点。此外，当我在客户端项目中添加服务参考时，我只能查看 AppFabric 提供的默认终结点配置值。AppFabric 似乎忽略了应用程序的 web.config 文件中的 <'Service'> 标记值。可能是什么原因？有什么我可能错过的吗？任何建议都将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T10:23:06.863

我找到了答案。当我完全按照服务的 appfabric 仪表板中的方式更改服务名称（在服务标签元素中）时，应用程序端点就会显示出来。

# objective-c - 为什么 CCLabelAtlas[1] 拒绝更新？

> ID：10210183
> 
> 赞同：0
> 
> 时间：2012-04-18T13:16:22.233
> 
> 标签：objective-c, cocos2d-iphone

我在 .h 文件中声明了 7 个 CCLabelAtlas 标签，如下所示`CCLabelAtlas *numberStat[7]`。然后我在 .m 文件的 for 循环中初始化它们：

```
for (int i = 1; i <=7; i++) {
    NSString* statName = [NSString stringWithFormat @"Number %d", i];
    numberStat[i] = [[CCLabelAtlas labelWithString: [self loadThisValue:statName] charMapFile:@"digitalNumbers.png" itemWidth:26 itemHeight:37 startCharMap:'0'] retain];
    [self addChild: numberStat[i]];
} 
```

当我尝试更新标签时，问题就来了。我可以从 2 更新到 7 就好了，但是当我尝试更新 numberStat[1] 的字符串 ( `numberStat[1].string = @"111";`) 时，它会崩溃。完全相同的代码适用于 2-7。

这是崩溃日志：

```
 -[CCSprite setString:]: unrecognized selector sent to instance 0x897cbd0
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[CCSprite setString:]: unrecognized selector sent to instance 0x897cbd0' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:32:33.757

一种可能性是，在您的代码中某处，numberStat[1] 被过度释放，当您为它分配一个字符串时，CCSprite 已移动到它占用的内存中。

# php - symfony2 字段中的值不相等

> ID：10210184
> 
> 赞同：0
> 
> 时间：2012-04-18T13:16:22.827
> 
> 标签：php, validation, symfony

我有很多变量的类。其中很少是文件类型

```
 class Proposal {
/**
 *  @ORM\ManyToOne(targetEntity="File")
 *  @ORM\JoinColumn(name="clientCommFile_id", referencedColumnName="id")  */
private $clientCommFile;

/**
 *  @ORM\ManyToOne(targetEntity="File")
 *  @ORM\JoinColumn(name="contractFile_id", referencedColumnName="id")
 */
private $contractFile;

/**
 *  @ORM\ManyToOne(targetEntity="File")
 *  @ORM\JoinColumn(name="proposalFile_id", referencedColumnName="id")
 */
private $proposalFile; 
```

我需要创建一些验证规则来验证哪些将检查文件的 ID。id 必须不同，因为它引用数据库中的文件。是某种方式，如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:04:55.260

所以你想让clientCommFile、contractFile和proposalFile不同？假设一个人可以只比较对象，它是这样的：

```
use Symfony\Component\Validator\Constraints as Assert;
use Symfony\Component\Validator\ExecutionContext;

/**
 * @Assert\Callback(methods={"areFilesValid"})
 */
class Proposal {

    // ..

    public function areFilesValid(ExecutionContext $context) {
        if($this->clientCommFile != null && $this->clientCommFile->equals($this->contractFile)){
            $propertyPath = $context->getPropertyPath() . '.options';
            $context->setPropertyPath($propertyPath);
            $context->addViolation('ClientCommFile and ContractFile are equal', array(), null);
        }
    }
} 
```

当然，您必须在对象上实现 equals 方法。

如果它变得更复杂或者您需要访问数据库，请查看[自定义验证器](http://symfony.com/doc/current/cookbook/validation/custom_constraint.html)

# go - 实例新类型（Golang）

> ID：10210188
> 
> 赞同：19
> 
> 时间：2012-04-18T13:16:46.477
> 
> 标签：go, types, instance, go-reflect

谁能告诉我如何从字符串创建一个新的 Type 实例？反映？

有一些示例，但它们适用于语言的较旧（Go 1 之前的版本）[:(]

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-18T14:47:33.207

因此，如果我正确理解了您的问题，那么您是在询问当您将类型名称作为字符串时如何创建对象。因此，例如，您可能有一个字符串“MyStruct”，并且您想创建一个这种类型的对象。

不幸的是，这并不容易，因为 Go 是一种静态类型语言，并且链接器将消除死代码（或它的内联部分）。因此，不能保证您的最终可执行文件甚至会包含“MyStruct”的代码。

`map[string]reflect.Type`但是，您可以手动维护全局。例如，通过在`init()`定义此类可发现类型的包的函数中初始化此映射。这也将告诉编译器您正在使用这些类型。之后，您可以使用此映射查找要创建的类型的[reflect.Type ，并使用](http://golang.org/pkg/reflect/#Type)[reflect.New](http://golang.org/pkg/reflect/#New)获取指向该类型的新对象的指针（存储为 reflect.Value）。您可以使用以下方式将对象提取到接口中：

```
reflect.New(yourtype).Elem().Interface() 
```

[Elem()](http://golang.org/pkg/reflect/#Value.Elem)将取消引用指针，并且[Interface()](http://golang.org/pkg/reflect/#Value.Interface)将反射值作为`interface{}`. 有关详细信息，请参阅[反射定律](http://blog.golang.org/2011/09/laws-of-reflection.html)。

PS：可能有更好的方法来构建您的程序，它甚至不需要反射，并且可以让编译器捕获更多错误。例如，您是否考虑过使用[工厂方法](http://en.wikipedia.org/wiki/Factory_method_pattern)？另一个简单的解决方案可能是维护一个`map[string]func() interface{}`函数，可以调用这些函数来创建一个具有该名称的新对象。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-12-10T01:17:20.793

具有预定义构造函数的工厂可以基于以下内容：

```
package main

import (
    "fmt"
)

type Creator func() interface{}

type A struct {
    a int
}

type B struct {
    a bool
}

func NewA() interface{} {
    return new(A)
}

func NewB() interface{} {
    return new(B)
}

func main() {
    m := map[string]Creator{}
    m["A"] = NewA
    m["B"] = NewB
    for k, v := range m {
        fmt.Printf("%v -> %v\n", k, v())
    }
} 
```

# vb.net - 如何在 Vb.Net 中使用 Oledb 驱动程序从 Oracle 客户端检索 BLOB 数据？

> ID：10210202
> 
> 赞同：1
> 
> 时间：2012-04-18T13:17:45.130
> 
> 标签：vb.net, oracle

我正在使用 oleDbConnection 从 Oracle 列中选择一个 BLOB 数据，我必须坚持使用这种类型的连接，因为我的所有应用程序都在使用它。

使用以下代码后，出现错误：未指定的错误。

```
Dim pSelectCommand As OleDbCommand = New OleDbCommand() 
Dim commandTextTemplate As String = "SELECT PICTURE FROM ALBUMS WHERE CODE= 4"
pSelectCommand.CommandText = commandTextTemplate
pSelectCommand.Connection = g_pOleDbConnection 

Dim fs As FileStream 

' Open the connection and read data into the DataReader.
If g_pOleDbConnection.State = ConnectionState.Closed Then g_pOleDbConnection.Open()

Dim myReader As OleDbDataReader = pSelectCommand.ExecuteReader() 'Error is on this line

Do While (myReader.Read())
Dim byteArray As Byte() = (myReader(g_pfldAPicture))
fs = New FileStream("Album.bmp", FileMode.CreateNew, FileAccess.Write)
fs.Write(byteArray, 0, byteArray.Length)
Loop 
```

我可以尝试什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T06:00:40.820

这是您在 eggheadcafe 和 CodeProject 上的问题的相同答案，参考：

[http://www.eggheadcafe.com/community/vb/14/10442149/how-to-retrieve-blob-data-from-oracle-client-using-oledb-driver-in-vb.aspx](http://www.eggheadcafe.com/community/vb/14/10442149/how-to-retrieve-blob-data-from-oracle-client-using-oledb-driver-in-vb.aspx)
[http://www .codeproject.com/Questions/368813/How-to-retrieve-BLOB-data-from-Oracle-Client-using](http://www.codeproject.com/Questions/368813/How-to-retrieve-BLOB-data-from-Oracle-Client-using)

**OleDb 不支持 Oracle Blob。[http://support.microsoft.com/kb/244661](http://support.microsoft.com/kb/244661) 您必须改用 ADO.net。**

编辑：你好

我理解你，我试图说得很好：

> 不支持 Oracle 8.x 特定的数据类型，例如 CLOB、BLOB、BFILE、NCHAR、NCLOB 和 NVARCHAR2。

参考： http: [//support.microsoft.com/kb/244661](http://support.microsoft.com/kb/244661)

您需要使用[Oracle Provider for OLE DB](http://www.oracle.com/technology/software/tech/windows/ole_db/index.html)或更好，但只需使用[Oracle Data Provider for .NET](http://www.oracle.com/technology/tech/windows/odpnet/index.html) (ODP.NET) 进行此 BLOB 读取操作。

# javascript - 具有相同类名的按钮列表的单击事件

> ID：10210203
> 
> 赞同：1
> 
> 时间：2012-04-18T13:17:45.757
> 
> 标签：javascript, jquery

我们可以在 jquery 中为具有相同类名的按钮列表编写一个单击事件吗？html部分是这样的

```
<a id="c1768" class="MyButton button " href="#" style="" name="c1768">Add to cart</a>
<a id="c1769" class="MyButton button " href="#" style="" name="c1769">Add to cart</a>
<a id="c1770" class="MyButton button " href="#" style="" name="c1770">Add to cart</a>
<a id="c1771" class="MyButton button " href="#" style="" name="c1771">Add to cart</a> 
```

脚本部分是

```
$("MyButton button").click(function(){ //some event }); 
```

如果单击任何按钮，我想执行该事件，但代码不起作用。任何人都请帮忙....谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:19:40.137

```
$(".MyButton.button").click(function(){ //some event }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:19:41.217

你错过了一个点不应该是这样的：

```
$(".MyButton").click(function(){ //some event }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:22:49.873

```
$(".MyButton.button").click(function(){ alert("Done!");}); 
```

[http://jsfiddle.net/BYbBr/](http://jsfiddle.net/BYbBr/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T13:19:19.340

应该：

```
$(".MyButton").click(function(){ //some event }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T13:19:48.827

您必须在类名中添加一个点（请记住，jQuery 选择器实际上是 css 选择器！）。

尝试这个：

```
$(".MyButton .button").click(function(){ //some event }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-18T13:23:56.580

您的选择器错误，使用 dot(.) 定义一个类，MyButton 和 button 也在同一级别：

```
$(".MyButton.button").click(function(){ //some event }); 
```

如果你有多个元素的事件，你应该考虑使用 $.on(); 见：[http ://api.jquery.com/on/](http://api.jquery.com/on/)

# rest - 关于测验系统的 wcf 休息设计

> ID：10210206
> 
> 赞同：0
> 
> 时间：2012-04-18T13:17:48.990
> 
> 标签：rest

我正在设计一个关于测验系统的rest api，用户需要登录才能进行测验，有GetQuiz，GetQuestion等功能。以及用于管理这些用户和测验的其他 API 集，有 AddQuestionToQuiz、DeleteQuiz、CreateUser 等功能现在我对如何设计它感到困惑。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T18:11:20.503

您需要考虑资源而不是方法调用。测验可能是资源，用户可能是资源，问题可能是资源。所有资源都支持 GET、POST、PUT、DELETE。

有时为了帮助我想清楚，我认为一个网站会是什么样子，其中资源是 HTML 并且它有链接（超媒体）

高温高压

# javascript - 使用 dojox.mobile 创建水平 ScrollableView

> ID：10210210
> 
> 赞同：1
> 
> 时间：2012-04-18T13:17:54.003
> 
> 标签：javascript, css, dojo

我正在努力使用`dojox.mobile.ScrollableView`水平滚动：我有一个

```
<div data-dojo-type="dojox.mobile.ScrollableView" scrollDir="h"> 
```

其中包含几个`div`向左浮动的元素。但是，在这种情况下，元素不会显示在一行中：

[http://jsfiddle.net/wf6NZ/](http://jsfiddle.net/wf6NZ/)

我可以`div`在 ScrollableView 中放置另一个宽度设置为所有宽度加边距的总和：

[http://jsfiddle.net/N7MrD/](http://jsfiddle.net/N7MrD/)

但是，这需要计算我想要避免的所有元素的结果宽度。

那么问题来了：没有helper div是否可以实现第二个链接的结果呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T02:34:34.963

尝试在任何容器 div 中定义样式“white-space: nowrap”。

例如，

```
<div id="view" style="white-space:nowrap" data-dojo-type="dojox.mobile.ScrollableView" scrollDir="h"> 
```

# java - 我们不能将spring用于分布式Java应用程序吗？

> ID：10210221
> 
> 赞同：7
> 
> 时间：2012-04-18T13:18:21.827
> 
> 标签：java, spring, jakarta-ee

这是一个面试问题。

面试官问我是否可以将 spring 用于所有目的，并且不使用任何 Java EE 框架就可以逃脱。

我说是的，但他问我应用程序是否分布式以及应用程序服务器的意义何在。

我不确定答案。

Spring 是否完成了 Java EE 框架所做的所有事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:33:06.743

嗯，春天很宽。所以你可以逐点复习。我不是 Java EE 方面的专家，但我确信 Spring 可以涵盖很多（如果不是全部）Java EE 问题。而且我很确定 Spring 可以处理应用程序中的大多数层/问题。

首先是春季国际奥委会。您可以使用 Spring IOC 配置对象图。它有助于在任何层配置实现层所需的所有组件。

Spring-MVC-Web：您可以配置 MVC Web 组件以处理和服务所有 Web 应用程序请求。我认为你可以用它做一些很酷的事情。使用其他业务元素（包括 IPC - 进程间通信）配置 Web 响应及其必要的配置。

Spring Security 是 Acegi 的遗产。它是一个 Web 框架，用于定义对 Web 资源的角色定义访问。

我不确定Hessian是否也是Spring的。无论如何，它是轻量级的，它有助于与其他进程中的组件进行通信*à la RMI*。

嗯......我不确定持久性，但我认为 Spring 有用于 JDBC、Hibernate 等的模板，所以无论如何它都可以提供帮助（正如建议所示：JmsTemplate 和 RestTemplate 可用于与其他业务组件通信！）。

这里的核心思想是：*您可以从头开始制作应用程序，因此在所有情况下，Spring 都可以提供一个框架来缓解每一层上的困难/重复任务*。春天会吗？是的。

*请检查其他功能*，看看 Spring 是否有它的功能。我敢打赌。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T09:06:52.417

在本质上，Java EE 是一组规范（其中一些是由 Spring 团队贡献的！）

Spring 的使命宣言是“简化 Java 开发”

它使用以下技术做到这一点：

1.  POJO -> 便于测试
2.  DI -> 促进松散耦合
3.  AOP -> 促进关注点分离、可维护性等
4.  模板 -> 提供标准编程模型，为您完成繁重的工作

Spring 和 Java EE 没有“Vs”关系。

使用上述技术，Spring Framework 可以让您更高效地构建（Java EE）基于标准的应用程序。

```
>Does spring do everything that the Java EE framework does ? 
```

根据我上面所说的，这个问题可以改写为*“Spring 是否支持/实现了构成 Java EE 规范的所有技术？”* - 不，但它确实做到了它的目标，那就是简化大多数 Java EE 技术的开发。

也就是说，这种简化 Java 开发的权衡是，您现在需要掌握大量知识（Spring 框架）触手可及......（伴随着实践和谷歌 :)）

```
>Can't we use Spring for distributed java applications? 
```

你当然可以。对于大多数可以想象的用例，Spring 有大量的 Exporters/FactoryBeans 和 Clients(Templates)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T14:35:01.447

是的，Spring 可以在没有 Java EE 的分布式应用程序中使用。我们已经使用它在一个 XA 事务中向 MQ 发送消息和更新数据库。

根据这篇文章，Spring 绝对可以在分布式应用程序中单独使用。

[http://www.wrox.com/WileyCDA/Section/Why-Use-the-Spring-Framework-.id-130098.html](http://www.wrox.com/WileyCDA/Section/Why-Use-the-Spring-Framework-.id-130098.html)

[http://www.artima.com/forums/flat.jsp?forum=276&thread=204508](http://www.artima.com/forums/flat.jsp?forum=276&thread=204508)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T14:42:33.673

从历史上看，（5 年前？）Spring 在分布式应用程序领域很薄弱，特别是数据库集群。这不再是一个问题。我会说 Spring 在分布式计算方面走得更远，因为他们正在大力追求 Java EE 尚未接近的云技术。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T13:32:03.897

我不这么认为。基本上 Spring 是关于 Java EE 框架之间的集成。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-18T14:33:52.370

在我看来，Spring 的主要好处是它摒弃了 Java EE 框架的一些更重量级的组件（实体 Bean、会话 bean），并用轻量级替代方案取而代之。

在我看来，Spring 的主要优点之一是它解耦了许多组件，然后使用 XML 或注释将它们连接在一起。这使得编写单元测试变得容易（通过注入模拟组件而不是真实的组件），这在使用重量级 Java EE 组件时并不容易完成（无法轻松地对 EJB 2.1 实体 Bean 进行单元测试）。

许多 Spring 概念已进入 Java EE 标准，因此我认为 Java EE 不再是重量级选项，Spring 将与 Java EE 组件一起使用，例如应用程序服务器管理的连接池（通过 JNDI）、事务管理器, 队列管理器可以很容易地使用应用程序服务器进行管理，该应用程序服务器可以提供额外的功能，例如集群、故障转移、负载平衡、服务 Web 资源......

话虽如此，Spring（VMWare）背后的人有自己的应用服务器（[tcServer](http://www.vmware.com/products/application-platform/vfabric-tcserver/overview.html)），它基于Apache Tomcat，提供了很多spring使用的粘合剂，但并不像一些传统的应用程序那样“重”服务器（Websphere、Weblogic）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-28T15:53:53.003

为此使用弹簧集成框架。

使用可以使用 Akka 框架来管理具有 spring 集成的分布式应用程序。

Akka 使用 Actor 模型和软件事务内存来提高抽象级别并提供更好的平台来构建正确的并发和可扩展的应用程序。

查看分步教程，该教程提供了有关如何使用 Akka 框架构建分布式应用程序的更多信息。

通常，分布式应用程序是使用 Java-RMI 在 Java 中构建的，Java-RMI 在内部使用 Java 的内置序列化在节点之间传递对象。

# java - 我可以在 JPanel 中使用 FlowLayout 获得多行吗

> ID：10210222
> 
> 赞同：1
> 
> 时间：2012-04-18T13:18:32.933
> 
> 标签：java, swing, jpanel, layout-manager, flowlayout

我需要类似于`GridLayout`但不调整组件大小的解决方案`JPanel`。

一切都很好用，但`JFrame`我需要把那些组件放进去。`JPanel``JFrame`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T19:18:31.423

我已经看到了两种可能适合您要求的方法：

*   将每个组件嵌套在 have`JPanel`中，这尊重组件的首选大小，如此[处](https://stackoverflow.com/a/3420431/230513)`FlowLayout`所示。

*   使用 的`HORIZONTAL_WRAP`或`VERTICAL_WRAP`方向，如此[处](https://stackoverflow.com/a/7620726/230513)`JList`所示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T13:49:37.803

以下链接可能会帮助您选择最适合您需要的布局。它的 Java 教程称为“布局管理器的可视化指南”，它显示了每个布局的漂亮图片以及它们的外观......

[http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)

否则，如果您说`GridLayout`与您需要的相似，您总是可以编写自己的`MyGridLayout`类（扩展`GridLayout`）并覆盖执行自动调整大小的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-03T18:06:05.080

我自己偶然发现了这个问题，尽管我认为使用 z JList 可能是一个很好的解决方案，但还有一种更简单的方法可以使用自定义的 FLowLayout，称为 WrapLayout，可在此处获得：[https ://tips4java.wordpress.com/2008 /11/06/包装布局/](https://tips4java.wordpress.com/2008/11/06/wrap-layout/)

我最终在我的项目中使用了它，并且效果很好。我遇到的唯一问题是当我将窗口设置为全屏模式时，布局没有正确更新。我使用了一个简单的解决方法，就是这样：

```
 //int targetWidth = target.getSize().width;
        int targetWidth = target.getParent().getSize().width; // FIXME: this is a hack for getting the correct size when switching between full screen modes on Mac 
```

有了这个小技巧，它就可以完美运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-28T11:14:10.873

只需在 flowlayout 中覆盖 preferredLayoutSize() 并将其设置为最大大小。将对齐设置为 LEADING 并将其设置为您的 JPanel。你会得到你想要的

```
private FlowLayout getFlowLayout(int maximumSize)
      {
        if (flowLayout == null)
        {
          flowLayout = new FlowLayout()
          {
            @Override 
            public Dimension preferredLayoutSize(Container target)
            {
              Dimension dimension = super.preferredLayoutSize(target);
              dimension.width = Math.min(maximumSize, dimension.width);
              return dimension;
            }
          };
          flowLayout.setAlignment(FlowLayout.LEADING);
        }
        return flowLayout;
      } 
```

# xml - XML，XSL，如何从 xml 文件中获取子节点到 xsl 文件

> ID：10210223
> 
> 赞同：0
> 
> 时间：2012-04-18T13:18:37.067
> 
> 标签：xml, xslt

我有一个看起来像这样的 xml 文件：

```
<TestRun>
 <FailedTests>
  <FailedTest id="19">
   <Name>Test</Name>
   <FailureType>Assertion</FailureType>
   <Location>
     <File>Sets.cpp</File>
   </Location>
   <Details>
     <Detail id="1">Exception caught returning cmd response </Detail>
     <Detail id="2">unresolvable error code</Detail>
   </Details>
  </FailedTest>
 </FailedTests>
</TestRun> 
```

我想获取 TestRun/FailedTests/FailedTest/Details 的子节点的值，我该怎么做？我试过了，但它不起作用：

```
 <TD>
            <xsl:for-each select="Details/Detail">
               <br></br><br></br>
            <xsl:value-of select="(Detail)"/>
            </xsl:for-each>
        </TD>
    </TR> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:24:05.350

当您在 Details/Detail for-each 中时，您可以通过执行以下操作打印当前元素的内容：

```
<xsl:value-of select="."/> 
```

# list - Haskell - 有选择地添加列表

> ID：10210225
> 
> 赞同：1
> 
> 时间：2012-04-18T13:18:40.393
> 
> 标签：list, haskell, tuples

我有以下类型：

```
type Rating = (String, Int)
type Film = (String, String, Int, [Rating])

testDatabase :: [Film]
testDatabase = [("Director 1","Film 1",2012,[("TestRat",8)]),("Director 2","Film 2",2,[])] 
```

我需要找出导演的平均评分是基于他们所有电影的总和，然后是他们所有评分的总和。我真的不知道如何处理这个问题，我发现仅仅获得电影中元组的平均值就已经够难了，更不用说通过所有这些元组来做到这一点了。

我计算平均值的代码：

```
filmRating :: [(String,Int)] -> Float
filmRating ratings = average (map snd ratings)

average ratings = realToFrac (sum ratings) / genericLength ratings 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:37:33.840

[Data.List](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Data-List.html#g:11)中有许多有用的函数用于数据分析。

特别`groupBy`是超级有用：

```
> :t groupBy
groupBy :: (a -> a -> Bool) -> [a] -> [[a]] 
```

给定一个相等函数，将列表分组到桶中。

访问目录的函数：

```
 > let fst4 (x,_,_,_) = x 
```

然后，对主管名称和按该主管的存储桶（组）进行排序。

```
 > let db0 = sortBy (comparing fst4) testDatabase
 > let db1 = groupBy ((==) `on` fst4) db0
 [ [("Director 1","Film 1",2012, [("TestRat",8)])]
 , [("Director 2","Film 2",2    ,[])]
 ] 
```

`groupBy`非常有用……

# python - Python 列表类 __contains__ 方法功能

> ID：10210233
> 
> 赞同：12
> 
> 时间：2012-04-18T13:19:02.017
> 
> 标签：python, list, class, function, contains

列表类的`__contains__`方法是检查对象本身是否是列表的元素，还是检查列表是否包含与给定参数等效的元素？

你能给我举个例子来证明吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-18T13:24:35.990

```
>>> a = [[]]
>>> b = []
>>> b in a
True
>>> b is a[0]
False 
```

这证明它是一个值检查（至少默认情况下），而不是身份检查。请记住，如果需要，可以覆盖一个类`__contains__()`以使其成为身份检查。但同样，默认情况下，没有。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-05-05T23:25:45.460

Python 列表（和元组）首先检查对象本身是否是列表的元素（使用`is`运算符），只有当它是 False 时，它​​才会检查对象是否等于列表中的项目（使用`==`运算符）。您可以通过创建一个不等于自身的对象来看到这一点：

```
>>> class X:
...     def __eq__(self, other):
...             return False
... 
>>> x = X()
>>> x == x
False 
```

然而，由于`x is x`，`__contains__`仍然识别出这个对象在一个列表中

```
>>> x in [1, 'a', x, 7]
True 
```

也就是说，一个列表`__contains__`方法大致相当于：

```
def __contains__(self, other):
    return any(other is item or other == item for item in self) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-04-24T15:07:24.030

它检查值

```
>>> x = 8888
>>> y = 8888
>>> list1 = [x]
>>> print(id(x))
140452322647920
>>> print(id(y))
140452322648016
>>> y in list1
True 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T13:21:13.590

这取决于班级如何进行检查。对于内置`list`它使用`==`运算符；否则您将无法`'something' in somelist`安全使用。

更具体地说，它检查项目是否等于列表中的项目 - 所以在内部它很可能是一个`hash(a) == hash(b)`比较；如果哈希值相等，则对象本身也可能会被比较。

# php - php & wordpress - 显示完整图像而不是缩略图？

> ID：10210234
> 
> 赞同：1
> 
> 时间：2012-04-18T13:19:02.327
> 
> 标签：php, image, wordpress, thumbnails

我正在使用它在我的 wordpress 博客上显示图像-

职能：

```
add_theme_support( 'post-thumbnails' );  
set_post_thumbnail_size( 590, 275, true ); // 590 pixels wide by 275 pixels tall, hard crop mode 
```

指数：

```
<div class="post-wrap">
      <?php the_post_thumbnail(); ?>
      <?php the_excerpt(__('keep reading', 'grisaille')); ?></div>
      <?php wp_link_pages(
                array(  'before'           => '<p class="pages-links">' . __('Pages:', 'grisaille'),
                        'after'            => '</p>',
                        'next_or_number'   => 'number',
                        'nextpagelink'     => __('Next page', 'grisaille'),
                        'previouspagelink' => __('Previous page', 'grisaille'),
                        'pagelink'         => '%')); ?>
      <p class="postMeta"><small><?php _e('Category', 'grisaille'); ?> <?php the_category(', ') ?> | <?php _e('Tags', 'grisaille'); ?>: <?php the_tags(' '); ?></small></p>

      <hr class="noCss" />
    </li>

    <?php comments_template(); // Get wp-comments.php template ?>

    <?php endwhile; ?> 
```

而不是显示缩略图，我想显示完整的图像。我该如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T14:44:47.773

替换这个：

```
 <?php the_post_thumbnail(); ?> 
```

...有了这个：

```
 <?php the_post_thumbnail( 'full' ); ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:31:04.213

使用这个功能：

```
wp_get_attachment_image(get_post_thumbnail_id(get_post(get_the_ID()),'full',0,array('title' => '' )); 
```

[检查此链接](http://codex.wordpress.org/Function_Reference/wp_get_attachment_image)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-08T09:46:19.073

WordPress 核心内置了四种有效尺寸。

```
the_post_thumbnail('thumbnail');       // Thumbnail (default 150px x 150px max)
the_post_thumbnail('medium');          // Medium resolution (default 300px x 300px max)
the_post_thumbnail('large');           // Large resolution (default 640px x 640px max)
the_post_thumbnail('full');            // Original image resolution (unmodified) 
```

最后一个是你要找的。

# objective-c - 使用 ASIHTTPRequest

> ID：10210235
> 
> 赞同：0
> 
> 时间：2012-04-18T13:19:04.647
> 
> 标签：objective-c, ios, xcode, ios4, asihttprequest

我想知道是否有人可以帮助我解决当设备使用 ASIHTTPREQUEST 进入睡眠模式时如何保持 INAPP 购买的问题，我做了一个应用程序，其中包含一些要在应用程序中购买和下载的音乐文件，但是如果用户购买并开始下载专辑，例如，如果他的手机休眠，它会停止下载！！！感谢任何关于问候的评论，

```
-(void) downloadAlbum:(NSNumber *)Albumid {
//NSLog(@"%@",Albumid);
//myTable.scrollEnabled = NO;
[[UIApplication sharedApplication] setIdleTimerDisabled:YES];

if (CurrentSongID<=CurrentAlbumCount) {
    if (isDownload==FALSE) {    

        Reachability* internetReach = [[Reachability reachabilityForInternetConnection] retain];
        [internetReach startNotifier];
        NetworkStatus netStatus = [internetReach currentReachabilityStatus];

        switch (netStatus)
        {
            case NotReachable:
            {   UIAlertView *someError = [[UIAlertView alloc] initWithTitle: @"Top 10" message: @"Check Internet Connectivity" delegate: self cancelButtonTitle: @"Ok" otherButtonTitles: nil];
                [someError show];
                [someError release];
                break;
            }

            case ReachableViaWWAN:
            {   
            }
            case ReachableViaWiFi:

            {   NSString *DestinationFileName= [self FileNameGetter:Albumid FileID:CurrentSongID ];
                NSString * URL=[NSString stringWithFormat: @"http://core-4.doubleu.mobi/cdownload/%@/%d.mp3",[self AlbumNameGetter:Albumid],CurrentSongID];

                isDownload=TRUE;
                progressIndicator.hidden=FALSE;
                DownloadedFileName.hidden=FALSE;
                NSString* plistPath = [[NSBundle mainBundle] pathForResource:@"Albums" ofType:@"plist"];
                contentArray=[NSMutableArray arrayWithContentsOfFile:plistPath];
                //NSLog(@"%@",contentArray);
                DownloadedFileName.text=[NSString stringWithFormat:@"%d/%d",CurrentSongID ,CurrentAlbumCount];//[CurrentAlbum count]];
                if (!networkQueue) {
                    networkQueue = [[ASINetworkQueue alloc] init];  
                }
                failed = NO;
                [networkQueue setDownloadProgressDelegate:progressIndicator];
                [networkQueue setRequestDidFinishSelector:@selector(nextDownload)];
                [networkQueue setShowAccurateProgress:YES];
                [networkQueue setDelegate:self];
                request = [ASIHTTPRequest requestWithURL:[NSURL URLWithString:URL]];
                [request setDownloadDestinationPath:[[NSHomeDirectory() stringByAppendingPathComponent:@"Library/Caches"] 
                                                     stringByAppendingPathComponent:[NSString stringWithFormat:@"%@.mp3",[self FileNameGetter:Albumid FileID:CurrentSongID ]]]];

                [networkQueue addOperation:request];
                [networkQueue go];
                break;
            }
        }
    }
    else {
        UIAlertView *someError = [[UIAlertView alloc] initWithTitle: @"Top 10" message: @"Please wait Until download Completed" delegate: self cancelButtonTitle: @"Ok" otherButtonTitles: nil];
        [someError show];
        [someError release];
    }

}
else {
    //NSString *DestinationFileName= [self FileNameGetter:NSCurrentAlbumID FileID:CurrentSongID ];
    //myTable.scrollEnabled = YES;

    switch (CurrentAlbumIDd) {
            //to be modified
        case 1:
        {
            //NSString *DestinationFileName= [self FileNameGetter:NSCurrentAlbumID FileID:CurrentSongID ];
            UIAlertView *someError = [[UIAlertView alloc] initWithTitle: @"فضل شاكر" message:[NSString stringWithFormat:@"Download بياع القلوب Completed"] delegate: self cancelButtonTitle: @"Ok" otherButtonTitles: nil];
            [someError show];
            [someError release];
            //[Album1 setTag:Album1.tag*100];
            downloaded1 = TRUE;
            available1=1;

            break;}
        case 2:
        {
            UIAlertView *someError = [[UIAlertView alloc] initWithTitle: @"فضل شاكر" message:[NSString stringWithFormat:@"Download الحب القديم Completed"] delegate: self cancelButtonTitle: @"Ok" otherButtonTitles: nil];
            [someError show];
            [someError release];
        //  [Album2 setTag:Album2.tag*100];
            downloaded2 = TRUE;
            available2=1;
            break;
        }
        case 3:
        {
            UIAlertView *someError = [[UIAlertView alloc] initWithTitle: @"فضل شاكر" message:[NSString stringWithFormat:@"Download حبك خيال Completed"] delegate: self cancelButtonTitle: @"Ok" otherButtonTitles: nil];
            [someError show];
            [someError release];
        //  [Album3 setTag:Album3.tag*100];
            downloaded3 = TRUE;
            available3=1;
            break;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:26:26.893

您可以在[ASIHTTPRequest Doku的](http://allseeing-i.com/ASIHTTPRequest/)[如何使用页面](http://allseeing-i.com/ASIHTTPRequest/How-to-use)上找到所有需要的信息

1.  [恢复下载](http://allseeing-i.com/ASIHTTPRequest/How-to-use#resuming_interrupted_downloads)

2.  [在背景下载](http://allseeing-i.com/ASIHTTPRequest/How-to-use#background_downloads_ios)

`setShouldContinueWhenAppEntersBackground:YES`根据您的要求设置

```
 request = [ASIHTTPRequest requestWithURL:[NSURL URLWithString:URL]];
 [request setDownloadDestinationPath:[[NSHomeDirectory() stringByAppendingPathComponent:@"Library/Caches"] 
                                                 stringByAppendingPathComponent:[NSString stringWithFormat:@"%@.mp3",[self FileNameGetter:Albumid FileID:CurrentSongID ]]]];
[request setShouldContinueWhenAppEntersBackground:YES]; 
```

# c# - 一个类从另一个类继承的内存是否比不使用继承的类大？

> ID：10210236
> 
> 赞同：3
> 
> 时间：2012-04-18T13:19:07.107
> 
> 标签：c#, memory, inheritance, object, clr

想象一下，我有两个班级，class1 和 class2。

Class1 继承自 baseClass，如下所示：

```
baseClass
{
private Int64 one;
protected Int64 two;
public Int64 three;
} 
```

class1 看起来像这样

```
Class1 : baseClass
{
private Int64 four;
protected Int64 five;
public Int64 six;
} 
```

和 class2 看起来像这样：

```
Class2
{
private Int64 one;
protected Int64 two;
public Int64 three;
private Int64 four;
protected Int64 five;
public Int64 six;
} 
```

如果我要为每个类创建 10k 的数组，哪个会更大？class1 数组是否会更大，因为 class1 还会包含某种与 baseClass 相关的元数据？否则它们的属性是相同的，所以从技术上讲它们应该是相同的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T13:46:30.863

给定两个引用类型数组，即：

```
Class1[] a1 = new Class1[10000];
Class2[] a2 = new Class2[10000]; 
```

数组的大小*完全相同*。数组的元素只是引用，并且无论引用的对象是什么，引用总是相同的大小。引用在 32 位运行时为 4 个字节，在 64 位运行时为 8 个字节。

至于类实例，我希望它们的大小也相同。类实例本身只保存该类的数据，以及包含对该类类型的引用的少量其他数据。类实例本身并不“知道”它是派生类。该信息由类型保存。

因此， 的*类型*信息`Class1`可能略大于 的类型信息`Class2`，但是这两个类的*实例*将占用相同的内存量。

总而言之`Class1`，继承自`baseClass`的 using 将比 using 多花费几个字节`Class2`，因为您有两个类的类型信息。但它实际上只是多了几个字节——无论类元数据的开销是多少。每个类实例都不会花费您任何额外费用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:32:42.277

请注意，这仅提供了相对于彼此的大小的概述。据我所知，没有直接的方法可以知道运行时大小。

```
baseClass bc = new baseClass();

Class1 class1 = new Class1();
Class2 class2 = new Class2();

long bcSize = 0;
long class1Size = 0;
long class2Size = 0;

using (Stream s = new MemoryStream())
{
    BinaryFormatter formatter = new BinaryFormatter();
    formatter.Serialize(s, bc);
    bcSize = s.Length; //223
}

using (Stream s = new MemoryStream())
{
    BinaryFormatter formatter = new BinaryFormatter();
    formatter.Serialize(s, class1);
    class1Size = s.Length; //298
}

using (Stream s = new MemoryStream())
{
    BinaryFormatter formatter = new BinaryFormatter();
    formatter.Serialize(s, class2);
    class2Size = s.Length; //264
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:58:16.590

除非您使用虚拟方法，否则大小将是相同的。

使用虚拟方法时，该类中的虚拟表指针将产生字节开销。

# c# - 检查现有文件

> ID：10210238
> 
> 赞同：1
> 
> 时间：2012-04-18T13:19:10.143
> 
> 标签：c#, arrays, file, for-loop, io

我需要一种方法来检查图片是否已经在 lbl_Dias 中。如果不添加图片，如果是，则移至下一张图片。

这是为了制作一个随机顺序但没有重复的图像列表。

到目前为止我得到的是这个

```
protected void DiasShow()
    {
        string[] getFiles = Directory.GetFiles(HttpContext.Current.Server.MapPath("/CSS/Design/Page_Design/Dias/1920x1080/"));

        for (int i = 0; i <= GetFiles.Length; i++)
        {
            Random FindRandom = new Random();
            string RandomFileName = getFiles[FindRandom.Next(getFiles.Length)];

            FileInfo ImageName = new FileInfo(RandomFileName);
            string FileType = ImageName.Name.Substring(ImageName.Name.Length - 4);

            if ((FileType.ToUpper() == ".JPG") || (FileType.ToUpper() == "JPEG"))
            {
                lbl_Dias.Text += "<img src=\"CSS/Design/Page_Design/Dias/1920x1080/" + ImageName.Name + "\" />";
            }
        }
    } 
```

希望大家帮帮忙，我有点存了^^

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:42:05.357

首先，摆脱 NumberOfImages，因为它毫无意义。整个 foreach 循环很糟糕，因为您正在遍历不需要它的集合。

其次，您可以使用 FileInfo 的 Extension 属性来检查文件的扩展名字符串 - 无需子字符串等。

第三，你到底想在这里做什么？

您确实意识到您可能会在循环结束时获得随机重复，因为您没有从集合中删除使用过的图像。

最后，您根本不需要检查文件是否存在，因为您是从返回存在文件的函数中获取的。

```
protected void DiasShow()
{
    var mapPath = HttpContext.Current.Server.MapPath("/CSS/Design/Page_Design/Dias/1920x1080/");

    var images =
        Directory.GetFiles(mapPath).Select(
            file => new FileInfo(file)).Where(fi =>
                fi.Extension.EndsWith("jpg", StringComparison.OrdinalIgnoreCase) ||
                fi.Extension.EndsWith("jpeg", StringComparison.OrdinalIgnoreCase)).ToList();

    var rand = new Random();

    while (images.Count > 0)
    {
        var i = rand.Next(images.Count);
        lbl_Dias.Text += "<img src=\"CSS/Design/Page_Design/Dias/1920x1080/" + images[i].Name + "\"/>";
        images.RemoveAt(i);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:40:58.350

我想您只想按随机顺序列出文件：

```
protected void DiasShow()     
{
    var getFiles = Directory.GetFiles(HttpContext.Current.Server.MapPath("/CSS/Design/Page_Design/Dias/1920x1080/")); //Find alle filer I en mappe     

    var random = RandomiseList(getFiles);

    var txt = new StringBuilder();
    foreach (var randomFileName in random)
    {
        var fileType = System.IO.Path.GetExtension(randomFileName).ToUpper(); 

        if ((fileType == ".JPG") || (fileType == ".JPEG")) 
        {
           var imageName = System.IO.Path.GetFileName(randomFileName); 
           txt.Append("<img src=\"CSS/Design/Page_Design/Dias/1920x1080/" + imageName+ "\" />");
        }
    }
    lbl_Dias.Text += txt.ToString();
 }

 public static T[] RandomiseList<T>(T[] source)
 {
     var rand = new Random(); //no need for own seed
     var list = new List<T>(source); //copy to a new list which we can remove from
     var result = new T[source.Length];
     for (int i = 0; i < source.Length; i++)
     {
         var listIndex = rand.Next(list.Count());
         result[i]= list[listIndex];
         list.RemoveAt(listIndex);
     }
     return result;
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:29:24.837

您可以制作文件名列表。

每次分配文件名时，检查它是否在列表中，如果没有将其添加到列表中，如果存在则查找不同的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T13:25:30.940

由于您正在检查文件的位置没有代码，因此我假设您正在检查文件名。

从 lbl_Dias 中提取文本后使用[Contains()](http://msdn.microsoft.com/en-us/library/dy85x1sa.aspx)或[Regex匹配。](http://www.dotnetperls.com/regex-match)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T13:33:01.920

要验证某些内容不在标签的文本中，请使用相应的字典并在将其添加到标签之前对其进行检查，例如

```
Dictionary<string, int> _filenames = new Dictionary<string,int>();

....

if (_filenames.ContainsKey( ImageName.Name ) == false)
{
    _filenames.Add(ImageName.Name, 0);

    lbl_Dias.Text += "<img src=\"CSS/Design/Page_Design/Dias/1920x1080/" + ImageName.Name + "\" />"; 

} 
```

# javascript - 使 cookie 过期

> ID：10210239
> 
> 赞同：2
> 
> 时间：2012-04-18T13:19:12.107
> 
> 标签：javascript, asp.net, http, cookies, web

我正在努力遵守新的欧盟关于 cookie 立法的法律，并且需要在用户同意之前删除我网站上的所有 cookie。目前我已经成功使用了以下内容：

```
function deleteAllCookies() {
    var cookies = document.cookie.split(";");

    for (var i = 0; i < cookies.length; i++) {
        var cookie = cookies[i];
        var eqPos = cookie.indexOf("=");
        var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
        document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
    }
} 
```

然而，一旦这个进程运行，仍然有一个名为 ASP.NET_SessionID 的 cookie，它是由 ASP.NET 创建的。为了克服这个问题，我在 web.config 文件中设置了以下内容，该文件基本上将 sessionID 存储在 URL 中：

```
 <sessionState regenerateExpiredSessionId="true" cookieless="true" /> 
```

我遇到的问题是，当我设置 cookieless="true" 时，上面的 JavaScript 代码不再删除我的任何 cookie，就像它变得多余一样。当我设置 cookieless="false" 时，javascript 工作得很好。我是否需要更改任何其他设置才能使两者协同工作？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:55:12.590

如果不需要会话，可以禁用会话状态（mode="Off"）

此外，我通常会清理服务器端的 cookie，如下所示（尽管它删除了 asp.net sessionid，但从未查看过）：

```
protected void Page_Load(object sender, EventArgs e)
{
    Response.BufferOutput = true;
    Session.Abandon();
    HttpCookieCollection cookies = Request.Cookies;
    var cookiesList = new List<String>();
    foreach (String cookieKey in cookies)
        cookiesList.Add(cookieKey);

    foreach (var cookieKey in cookiesList)
    {
    var cookie = new HttpCookie(cookieKey);
    cookie.Expires = DateTime.Now.AddDays(-1d);
    Response.Cookies.Add(cookie);
    }
} 
```

希望这能有所帮助。

# c - 从 C 返回的 ByteArray 格式无效

> ID：10210240
> 
> 赞同：0
> 
> 时间：2012-04-18T13:19:13.877
> 
> 标签：c, actionscript-3, apache-flex, alchemy

以下是代码片段：

AS 方面：（img 是对`<Image>`实例的引用）

```
 bitmapData = Bitmap(img.content).bitmapData;
        var pixels:ByteArray = bitmapData.getPixels(bitmapData.rect);
        pixels.position = 0;
        var output:ByteArray = new ByteArray();
        img_width = bitmapData.width;
        img_height = bitmapData.height;
        ////invoke C code by alchemy
        lomoEncoder.encode(pixels, output, img_width, img_height);
        var newImage:Image = new Image();
        //can't show the image
        newImage.source = output; 
```

C代码：

```
AS3_Val dest;
AS3_Val source;
unsigned char* pixels = (unsigned char *)malloc(Size);
AS3_ByteArray_readBytes(pixels, source, Size);
pixels = darkCornerLomoEffect((unsigned char*)pixels, image_width, image_height);
AS3_ByteArray_writeBytes(dest, (char*) pixels, length); 
```

在 AS 端，当`dest`从 C 中获取时，loader.load(dest) 抛出一个错误：Unhandled IOErrorEvent:。文本=错误 #2124。那么如何处理 byteArray 格式，以便 AS 端可以重组并用作`Image`源属性呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T15:06:24.410

我怀疑你的问题是[byte-ordering](https://stackoverflow.com/questions/6315417/convert-little-endian-bytearray-to-big-endian-in-as3)。从输入 ByteArray 读取后，您需要翻转字节。对于输出 ByteArray，您要么需要再次翻转它们，要么将其`endian`属性设置为`Endian.LITTLE_ENDIAN`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T14:06:05.190

如果您有一个 bytearray 并且想要加载图像源，您可以执行以下操作：

```
var b:ByteArray = new ByteArray();
var f:BitmapData = new BitmapData(100, 100);
f.setPixels(new Rectangle(0, 0, 100, 100), b); 
```

请问你能提供一段你的AS3代码吗？

# java - 创建移动银行程序

> ID：10210242
> 
> 赞同：0
> 
> 时间：2012-04-18T13:19:15.847
> 
> 标签：java, asp.net-mvc

我正在尝试用 Java 编写程序。当你想在网上买东西时，我希望它是这样的，无论是软件还是你使用移动银行的任何产品（如肯尼亚使用的 M-pesa）。

当一个人尝试购物并到达您要支付的点时，您需要在手机上输入您要支付的金额，然后另一端的程序应该检查输入的钱是否足够，并将产品清除为已付款。购买产品的人在输入产品提供的唯一ID后，将被授予下载产品的权利。

是否可以使用 Java 并与可能用另一种语言编写的程序进行交互，然后这两个程序将与 Web 一起通信？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:24:32.740

是的你可以！如果您使用不同的语言或技术，则没有问题。事实上，有几种技术解决方案。例如，您可以在 Web 服务器上使用共享数据库，PHP 网站或 Java 应用程序可以通过套接字访问该数据库...

# iphone - 我想阻止表格视图控制器的其他单元格中的触摸输入

> ID：10210243
> 
> 赞同：0
> 
> 时间：2012-04-18T13:19:17.730
> 
> 标签：iphone, ios

我有表视图控制器。我想要的是在单击一个单元格后，我想阻止其他单元格（行）中的输入输出。例如，如果我有 4 个单元格，那么如果用户单击第一个单元格，则用户输入应在 2、3、4 中被阻止。同样，如果我选择 2，则应在 1、3、4 中阻止输入。怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:33:31.490

只是在 UITableView 的 Did select row Delegate Method 中禁用用户交互

# clojure - 寻找使用 write-csv 的 clojure-csv 库示例

> ID：10210248
> 
> 赞同：0
> 
> 时间：2012-04-18T13:19:28.460
> 
> 标签：clojure

我正在寻找一个使用 write-csv 的 clojure-csv 库示例。具体来说，论点是如何形成的？我无法弄清楚为什么会出现以下错误。

这是我的错误代码示例：

```
(def x [1 2 3 4]) 

(write-csv (spit "test.tmp" x) :end-of-line "\n")    

ArityException Wrong number of args (3) passed to:
      core$write-csv  clojure.lang.AFn.throwArity (AFn.java:437) 
```

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:48:03.483

**编辑**误读了您的问题，并没有意识到您是在询问有关使用库 clojure-csv 的问题。如果它可以帮助其他使用 clojure.data.csv 的人，将保留它。

如果您使用 leiningen，请将以下内容放入您的 project.clj 文件中。

```
(defproject so "example"
  :dependencies [[org.clojure/clojure "1.3.0"]
                 [org.clojure/data.csv "0.1.2"]]) 
```

创建函数的示例代码，该函数采用文件名和数据写入 csv。

```
(ns so.core
  (:require [clojure.data.csv :as csv]
            [clojure.java.io :as io]))

(defn csv [filename data]
  (with-open [f (io/writer filename)]
    (csv/write-csv f data))) 
```

`csv`从 repl 中使用。

```
so.core> (csv "example.csv" [["stack" 1]
                         ["example" 40]]) 
```

这就是 example.csv 的样子。

```
$ cat example.csv 
stack,1
example,40 
```

希望这会有所帮助。

# c++ - 为什么这不匹配？

> ID：10210250
> 
> 赞同：-1
> 
> 时间：2012-04-18T13:19:33.807
> 
> 标签：c++

为什么这不匹配？

```
...
puts (ep->d_name);
if(ep->d_name=="testme"){ printf("ok"); } else { printf("no"); }
... 
```

输出：

```
testme
no 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T13:22:47.097

尝试：

```
if(!strcmp(ep->d_name, "testme")) 
```

或`d_name`改为`string`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-18T13:23:18.657

发生这种情况是因为您正在比较两个指针，它们指向具有相同值的 char*

你真的应该做

```
puts (ep->d_name);
if(strcmp(ep->d_name, "testme")==0){ 
    printf("ok"); 
}
else { 
    printf("no"); 
} 
```

尽管请考虑使用字符串，因为这将为您提供所需的语义

[http://en.cppreference.com/w/cpp/string/basic_string](http://en.cppreference.com/w/cpp/string/basic_string)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:26:26.287

我们需要知道 d_name 传递了什么值。

对于打印“ok”的程序，该值也需要是“testme”。

另外，查看这个函数：strcmp。它比较两个字符串，这基本上就是您在这里所做的。

例子：

```
 /* strcmp example */
#include <stdio.h>
#include <string.h>

int main ()
{
  char szKey[] = "apple";
  char szInput[80];
  do {
     printf ("Guess my favourite fruit? ");
     gets (szInput);
  } while (strcmp (szKey,szInput) != 0);
  puts ("Correct answer!");
  return 0;
} 
```

# c# - VS 2010（全新安装（两次）SP1Rel）开始调试给出 0x800703e9 与开始正常运行

> ID：10210256
> 
> 赞同：1
> 
> 时间：2012-04-18T13:19:47.240
> 
> 标签：c#, visual-studio-2010, debugging

我说的是最简单的例子——见下文——显然有些东西已经损坏了。这是完整的错误文本：

新发现！！！启动 Visual Studio 2008——多年来一直使用 C++，从这个 test5.cs 构建了一个新的解决方案，你猜怎么着？. . . 当开始调试时——完全相同的错误！！！此外，我用 C++ 构建了几种类型的微型测试程序，包括 CLR 控制台应用程序......这些都通过“开始调试”正常工作......

帮助！

* * *

```
 <small><small>'test5.vshost.exe' (Managed (v2.0.50727)): Loaded
'C:\Windows\assembly\GAC_32\mscorlib\2.0.0.0__b77a5c561934e089\mscorlib.dll'<br>
          'test5.vshost.exe' (Managed (v2.0.50727)): Loaded
'C:\Windows\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities\10.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.dll'<br>
          'test5.vshost.exe' (Managed (v2.0.50727)): Loaded
'C:\Windows\assembly\GAC_MSIL\System.Windows.Forms\2.0.0.0__b77a5c561934e089\System.Windows.Forms.dll'<br>
          'test5.vshost.exe' (Managed (v2.0.50727)): Loaded
'C:\Windows\assembly\GAC_MSIL\System\2.0.0.0__b77a5c561934e089\System.dll'<br>
          'test5.vshost.exe' (Managed (v2.0.50727)): Loaded
'C:\Windows\assembly\GAC_MSIL\System.Drawing\2.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll'<br>
          'test5.vshost.exe' (Managed (v2.0.50727)): Loaded
'C:\Windows\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities.Sync\10.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.Sync.dll'<br>
          'test5.vshost.exe' (Managed (v2.0.50727)): Loaded
'C:\Windows\assembly\GAC_MSIL\Microsoft.VisualStudio.Debugger.Runtime\10.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.Debugger.Runtime.dll'<br>
          'test5.vshost.exe' (Managed (v2.0.50727)): Loaded
          'C:\projects\test5\test5\test5\bin\Debug\test5.vshost.exe'<br>
          The thread 'vshost.NotifyLoad' (0x3518) has exited with code 0
          (0x0).<br>
          The thread 'vshost.LoadReference' (0x36a8) has exited with
          code 0 (0x0).<br>
          'test5.vshost.exe' (Managed (v2.0.50727)): Loaded
          'C:\projects\test5\test5\test5\bin\Debug\test5.exe', Symbols
          loaded.<br>
          Ignoring managed exception from unknown thread.The program
          '[6748] test5.vshost.exe: Managed (v2.0.50727)' has exited
          with code -2147023895 (0x800703e9).</small></small> 
```

* * *

如果我只是运行测试程序 - 没有错误并且它运行正确......

同样重要的是——如果我进入程序文件并在“调试”下选中“启用非托管代码调试”——调试的开始也可以正常工作......没有错误......这种情况下的输出跟踪有在下面的代码示例之后添加...

我相信这个问题也是我将要发布的下一个问题的原因，即在远程调试会话期间，匹配的 .PDB 文件被报告为不匹配.....

这是示例程序——但这并不重要——我尝试过的所有 C# 示例都是这样的.....

在此先感谢，凯文·韦特

* * *

```
using System;

namespace test5
{
    class Program
    {
        static void Main(string[] args)
        {
            int x = 0;

            while (true)
            {

                System.Console.WriteLine("Hello, World! {0} ", x );

                ++x;
            }
        }
    }
} 
```

* * *

```
'test5.exe': Loaded 'C:\projects\test5\test5\test5\bin\Debug\test5.exe', No native symbols in symbol file.
'test5.exe': Loaded 'C:\Windows\System32\ntdll.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\mscoree.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\kernel32.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\advapi32.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\rpcrt4.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscoreei.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\shlwapi.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\gdi32.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\user32.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\msvcrt.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\imm32.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\msctf.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\lpk.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\usp10.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Program Files\Google\Google Desktop Search\GoogleDesktopNetwork3.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\ws2_32.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\nsi.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\winsxs\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.6001.18000_none_5cdbaa5a083979cc\comctl32.dll', Cannot find or open the PDB file
'test5.exe': Unloaded 'C:\Program Files\Google\Google Desktop Search\GoogleDesktopNetwork3.dll'
'test5.exe': Unloaded 'C:\Windows\System32\ws2_32.dll'
'test5.exe': Unloaded 'C:\Windows\System32\nsi.dll'
The thread 'Win32 Thread' (0x1998) has exited with code 0 (0x0).
'test5.exe': Loaded 'C:\Windows\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\winsxs\x86_microsoft.vc80.crt_1fc8b3b9a1e18e3b_8.0.50727.6195_none_d09154e044272b9a\msvcr80.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\shell32.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\System32\ole32.dll', Cannot find or open the PDB file
'test5.exe': Loaded 'C:\Windows\Microsoft.NET\Framework\v2.0.50727\Culture.dll', Cannot find or open the PDB file
'test5.exe': Unloaded 'C:\Windows\Microsoft.NET\Framework\v2.0.50727\Culture.dll'
'test5.exe': Loaded 'C:\Windows\assembly\NativeImages_v2.0.50727_32\mscorlib\c068708e16abf0be77a21b9f29817d83\mscorlib.ni.dll', Cannot find or open the PDB file
'test5.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_32\mscorlib\2.0.0.0__b77a5c561934e089\mscorlib.dll'
'test5.exe' (Managed (v2.0.50727)): Loaded 'C:\projects\test5\test5\test5\bin\Debug\test5.exe', Symbols loaded.
'test5.exe': Loaded 'C:\Windows\Microsoft.NET\Framework\v2.0.50727\mscorjit.dll', Cannot find or open the PDB file 
```

# python - 提取 CSV 文件每一行的最后一个数字

> ID：10210258
> 
> 赞同：0
> 
> 时间：2012-04-18T13:19:52.327
> 
> 标签：python

这是我处理 csv 文件的第二天，我的 CSV 文件：

-RÎ¹alisÎ¹ par James Wan--- Vos 时刻 prÎ¹fÎ¹rÎ¹s ！（内有剧透） 1
-Source Code- News et Critique ！2
ALED - 点菜 2
ALED - 小酒馆 6

我想在最后提取数字并将其存储在另一个文件中，如下所示：

```
hindex
1
2
2
6 
```

这个数字甚至可以是两位数..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:24:47.130

如果您的内容在文件中，请说`tst.csv`您可以执行类似的操作

```
>>> with open("tst.csv") as fin, open("tst.out","w" )as fout:
    for line in fin:
        fout.write(line.rpartition(" ")[-1]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:26:47.347

根据定义，csv 格式是逗号分隔的，因此我们使用`split(',')`. `infp`是您的输入文件句柄（假设您的数据文件的名称是“data.csv”），`outfp`用于输出：

```
with open('data.csv') as infp, open('data.out', 'w') as outfp:
   for line in infp:
      outfp.write(line.split(',')[-1]) 
```

编辑：尽管问题的标题，显然文件本身**不是**CSV 格式。因此，此解决方案必须使用`split(' ')`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:24:58.830

这是伪代码：

```
 foreach line
     split the line words by space and get the last index. 
```

# python - Sqlite3数据实时转换为python

> ID：10210259
> 
> 赞同：1
> 
> 时间：2012-04-18T13:19:57.553
> 
> 标签：python, sqlite, datetime, time

我从sqlite3读取数据，我需要使用'last_visit_time'，但数据是'12979085322912388L'，我只使用python

```
import datetime,time
Traceback (most recent call last):
  File "t1.py", line 21, in <module>
    print time.gmtime(long(12979085330693664L))
ValueError: timestamp out of range for platform time_t 
```

....我不能使用ctime，gmtime....范围限制，所以我怎样才能将它翻译成实时，非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:24:43.977

```
>>> from datetime import datetime
>>> datetime.utcfromtimestamp(1297908532.2912388)
datetime.datetime(2011, 2, 17, 2, 8, 52, 291239) 
```

如果`last_visit_time`对应于 2011-02-17，那么你可以使用

```
>>> from datetime import datetime
>>> datetime.utcfromtimestamp(last_visit_time / 1e7)
datetime.datetime(2011, 2, 17, 2, 8, 52, 291239) 
```

# css - 过滤器的替代品是什么：progid:DXImageTransform.Microsoft.gradient

> ID：10210263
> 
> 赞同：1
> 
> 时间：2012-04-18T13:20:26.067
> 
> 标签：css, web

为了在 Internet Explorer 中创建渐变，我在我的 CSS (CSS3) 文件中使用了以下内容：

```
filter: progid:DXImageTransform.Microsoft.gradient 
```

例如

```
filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#C4D5FB', endColorstr='#DAE6FB'); /* for IE */
background: -webkit-gradient(linear, left top, left bottom, from(#C4D5FB), to(#DAE6FB)); /* for webkit browsers */
background: -moz-linear-gradient(top,  #C4D5FB,  #DAE6FB); /* for firefox 3.6+ */ 
```

我刚刚读到它自 Internet Explorer 9 以来已被弃用，但仍然有效。使用它安全吗？有替代品吗？

根据： [internet-explorer-9-gradients-with-rounded-corners](http://abouthalf.com/2010/10/25/internet-explorer-9-gradients-with-rounded-corners/)

使用它是安全的：

> Ultimate CSS Gradient Generator 之类的工具可以生成可爱的 CSS3 渐变所需的代码，并为旧版 Internet Explorer 提供备用选项（使用上面提到的渐变过滤器）。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T21:13:19.153

您可以使用 box-shadow 的插图来绕过渐变。我遇到了这个问题，只是无法让它工作。所以我看到了这篇文章[http://www.sitepoint.com/shadow-boxing-image-free-css3-glossy-buttons/](http://www.sitepoint.com/shadow-boxing-image-free-css3-glossy-buttons/)。对我来说效果很好。

这是我在项目中使用的代码。

```
border-radius:5px;-webkit-border-radius:5px;-moz-border-radius:5px;
box-shadow: 3px 3px 6px rgba(0, 0, 0, .2), 0px 0px 3px rgba(0, 0, 0, .1), inset 0px 5px 12px #930, inset 0px 15px 2px rgba(240, 150, 69, .5),inset 0px 25px 25px #930; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T14:45:40.600

试试这个网站

[http://www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

选中 IE9 支持框。它将为您提供 SVG 解决方案。

# c# - 从多个程序实例将文本写入文件

> ID：10210264
> 
> 赞同：3
> 
> 时间：2012-04-18T13:20:35.457
> 
> 标签：c#, file-io, io

当我将信息写入文件并运行多个程序副本时，我收到此错误：

> 该进程无法访问文件“C:\logs\log.txt”，因为它正被另一个进程使用。

代码是：

```
// create a writer and open the file
TextWriter tw2 = File.AppendText(@"C:\logs\log.txt");

// write a line of text to the file
tw2.WriteLine(Environment.NewLine);
tw2.WriteLine(DateTime.Now + " " + "IN INFOSERVCALLER");
tw2.Flush(); 
```

如何以正确的方式做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:30:59.483

总是将这种代码封装在一个`using`语句中

```
using(TextWriter tw2 = File.AppendText(@"C:\logs\log.txt"))
{
    tw2.WriteLine(Environment.NewLine); 
    tw2.WriteLine(DateTime.Now + " " + "IN INFOSERVCALLER"); 
    //tw2.Flush();  // No need to flush because close alway flush.
} 
```

该`using`语句在块的末尾调用 tw2.Close()。
**此外，如果您在块内遇到异常。**

现在，如果您的应用程序的其他实例由于某种原因失败，则该文件不再被锁定

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T14:10:59.253

使用[Mutex](http://msdn.microsoft.com/en-us/library/system.threading.mutex.aspx)类同步多个进程对日志文件的访问。在打开文件之前调用[WaitOne并在关闭文件后调用](http://msdn.microsoft.com/en-us/library/58195swd.aspx)[ReleaseMutex](http://msdn.microsoft.com/en-us/library/system.threading.mutex.releasemutex.aspx)（刷新是不够的，您必须关闭文件或使用关键字将其包装，如其他答案所述）写入完成后。互斥体名称应以前缀“Global\”开头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:23:39.897

除了法拉盛，你必须要`Close()`文件。

此外，如果另一个实例同时正在写入该文件，则您无法访问它（直到其他程序调用`Close()`.

[TextWriter.Close 方法](http://msdn.microsoft.com/en-us/library/system.io.textwriter.close.aspx)

> 关闭 writer 的当前实例并释放与 writer 关联的所有系统资源

在这种情况下，“系统资源”是指在您关闭之前一直锁定的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T13:25:14.117

每次使用文本编写器打开文件时都需要关闭。

所以每次手术后使用

```
// create a writer and open the file
TextWriter tw2 = File.AppendText(@"C:\logs\log.txt");

// write a line of text to the file
tw2.WriteLine(Environment.NewLine);
tw2.WriteLine(DateTime.Now + " " + "IN INFOSERVCALLER");
tw2.Flush();
tw2.Close(); 
```

之后再次尝试写，不会进一步产生任何问题。

# c# - C# 从另一个类更新文本框

> ID：10210265
> 
> 赞同：0
> 
> 时间：2012-04-18T13:20:42.697
> 
> 标签：c#, multithreading, desktop-application, dispatcher

我要做的就是从另一个类更新一个文本框（在本例中为 txtInit）。我已经阅读了很多关于 UI 线程必须如何改变自身以及使用调度程序的内容。我在这里找到了一个似乎很接近的答案，但我无法让它为我工作......它说尝试使用这条线：

```
MainForm.Dispatcher.Invoke(new Action(delegate() {MainForm.myInstance.txtInit.Text = "Text"};); 
```

在我的 ServerSide 类中，我需要向 MainForm 上的 txtInit 文本框发送一个字符串。这就是我需要做的一切。感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:31:12.010

类与线程无关（这是您现在的问题）。每个控件都有一个[Invoke](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invoke%28v=vs.80%29.aspx)方法，它将为您执行正确的线程同步。所以你可以做

```
MainForm.myInstance.txtInit.Invoke((sender, args) => (sender as TextBox).Text = "text"); 
```

为了提高性能，您可以测试（基本上告诉您是否在同一个线程中） Control.IsInvokeRequired 属性。

另一种方法是使用 UI 线程的[SynchronizationContext](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx)，您需要在表单的构造函数中从 SynchronizationContext.Current 捕获，然后执行

```
syncContext.Send((obj) =>  MainForm.myInstance.txtInit.Text = "Text", null); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:41:08.363

我可能只是在 MainForm 上创建一个公共方法，您可以将字符串传递给该方法并让该方法设置文本框的文本。您还可以控制是否需要我们调用 Invoke（不同的线程），这样您就不必担心在其他区域对此进行编码 - 只需调用方法并传递字符串。

这是一个例子：

```
 public partial class Form1 : Form
    {
        public delegate void UpdateText(string text);
        public Form1()
        {
            InitializeComponent();
        }
        public void SetTextBoxText(string text)
        {
            // Check to see if invoke required - (from another thread)
            if(textBox1.InvokeRequired)
            {
                textBox1.Invoke(new UpdateText(this.SetTextBoxText),

                    new object[]{text});
            }
            else
            {
                textBox1.Text = text;
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:27:00.000

如果我理解正确，您似乎想从另一个线程或一些异步事件访问 Windows 表单元素。在这种情况下，以下链接可能会对您有所帮助。

1.  [http://msdn.microsoft.com/en-us/library/ms171728.aspx](http://msdn.microsoft.com/en-us/library/ms171728.aspx)

2.  [从多个工作线程 (.NET) 更新 UI](https://stackoverflow.com/questions/2097284/update-ui-from-multiple-worker-threads-net)

3.  [在 Windows Mobile 中控制来自不同线程的表单元素](https://stackoverflow.com/questions/3037272/controlling-form-elements-from-a-different-thread-in-windows-mobile)

# javascript - 保存后的jqGrid事件不会触发

> ID：10210267
> 
> 赞同：3
> 
> 时间：2012-04-18T13:20:48.143
> 
> 标签：javascript, jqgrid, error-handling

我有一些这样的活动：

```
$('#grid').jqGrid('saveRow', lastsel, 
    { aftersavefunc: function (rowid, response) { alert('after save'); },
    errorfunc: function (rowid, response) { alert('error occured'); } 
}); 
```

问题是，他们从不开火！

**编辑 2**

将答案移至实际答案，而不是将其包含在问题中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T05:35:19.877

好了，问题解决了。您还必须将事件参数添加到“editRow”调用中。它们在保存时使用......真是令人困惑！

```
$('#grid').jqGrid('editRow', id, { keys: true,  
    aftersavefunc: function (rowid, response) { alert('after save'); }, 
    errorfunc: function (rowid, response) { alert('...we have a problem'); }  
}); 
```

# javascript - Jasmine 测试 Backbone，范围界定问题

> ID：10210268
> 
> 赞同：0
> 
> 时间：2012-04-18T13:20:51.810
> 
> 标签：javascript, testing, backbone.js, jasmine

在为我当前的一个主干集合编写 jasmine 测试时，我确实遇到了一个恼人的错误，我认为这不是我编写测试的方式，而不是在我的 javascript 中做错了什么，而 jasmine 想告诉我这一点。但我找不到解决方案。

我得到了以下简化的代码，这将导致我们遇到问题

```
class Stuff extends Backbone.Collection
    search: (str) ->
        @trigger('search', @_filter(@_convertStrToArray(str)))

    _convertStrToArray: (str) ->
        str.toLowerCase().split()

    _filter: (str_array) ->
        @filter (stuff) ->
            for _sub in str_array
                ... do something here 
```

如果在执行@search 时调用了@_convertStrToArray 方法，我想用茉莉花进行测试。我得到了以下测试（@stuff 已在 beforeEach 语句中成功创建！）

```
...
it "should call _convertStrToArray", ->
    spyOn(@stuff, '_convertStrToArray')
    @stuff.search('cool stuff')
    expect(@stuff._convertStrToArray).toHaveBeenCalled()
... 
```

我现在在我的茉莉花测试中收到以下错误..

```
TypeError: Cannot read property 'length' of undefined 
```

通过跟踪堆栈跟踪，我发现错误来自以下行：

```
for _sub in str_array 
```

显然这里有一个范围问题我无法解决。_filter方法中的**@filter****方法**来自Backbone。该脚本工作得很好，我只是在测试时遇到了麻烦。

 ****我的问题：如何在@filter 调用中正确获得对 str_array 变量的访问权限？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:54:00.690

问题是你的间谍。正在使用`for _sub in str_array`索引/长度检查进行迭代，但被监视的对象`_convertStrToArray`不返回任何值。

您需要在`.andCallThrough()`间谍定义的末尾添加：

`spyOn(@stuff, '_convertStrToArray').andCallThrough()`

这将监视该方法，但仍会调用实际方法及其返回值，以便您的代码在尝试使用结果时不会失败。**

# functional-programming - 模式匹配和构造函数

> ID：10210269
> 
> 赞同：1
> 
> 时间：2012-04-18T13:20:51.963
> 
> 标签：functional-programming, pattern-matching, ocaml

为什么我在编写这种模式匹配时会出错：

```
type t = A of int | B of float

let f = function
        | (A i | B f) -> true
        | _ -> false 
```

或者

```
let f = function
        | A i | B f -> true
        | _ -> false 
```

> **错误：变量 f 必须出现在 this 的两边 | 图案**

```
let f = function
        | (A i | B i) -> true
        | _ -> false 
```

或者

```
let f = function
        | A i | B i -> true
        | _ -> false 
```

> **错误：此模式匹配浮点类型的整数类型的值，** **但预期的模式与值匹配**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T13:41:59.837

如果您为多个模式提供单个右侧（如您所做的那样），OCaml 要求模式始终绑定到模式变量。

在第一种情况下，

```
match ... with
  | A i | B f -> ...
  ... 
```

模式在它们绑定到的变量上不一致：第一个模式绑定到`i`，而第二个绑定到`f`.

在第二种情况下，

```
match ... with
  | A i | B i -> ...
  ... 
```

模式不同意绑定到其变量的值的类型：第一个模式将类型的值绑定`int`到`i`，而第二个模式将类型的值绑定`float`到`i`。

这两种模式可以始终绑定到变量的唯一方法是根本不绑定到任何变量：

```
match ... with
  | A _ | B _ -> ...
  ... 
```

完整的例子就变成了

```
type t = A of int | B of float

let f = function
  | A _ | B _ -> true
  | _ -> false 
```

（但请注意，模式匹配的最后一个分支是多余的，因为前两个模式已经完全匹配您的 type 的所有值`t`。因此，我们得到：

```
let f = function
  | A _ | B _ -> true 
```

这当然等同于写作`let f _ = true`。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T13:40:06.223

在`Or`模式（`|`pattern）中，你会忘记你所在的构造函数。因此，你需要绑定同一组变量才能工作，而不需要引用构造函数。

OCaml 是强类型的；一个值`i`不能同时具有 type`int`和 type `float`。

如果 type`t`有两种以上的情况，你应该写：

```
let f = function
        | A _ | B _ -> true
        | _ -> false 
```

否则：

```
let f = function
        | A _ | B _ -> true 
```

就足够了，因为模式匹配已经很详尽了。

我同意这种`Or`模式非常严格，但有时当你的函数中有对称情况时它会很有帮助：

```
type num = 
    | Int of int
    | Float of float

let add s1 s2 = 
    match s1, s2 with
    | Int i1, Int i2 -> Int (i1 + i2)
    | Int i, Float f | Float f, Int i -> Float (float i +. f)
    | Float f1, Float f2 -> Float (f1 +. f2) 
```

# sql - 如何在不递增的情况下检索 oracle 序列的当前值？

> ID：10210273
> 
> 赞同：182
> 
> 时间：2012-04-18T13:20:58.080
> 
> 标签：sql, oracle, sequence

是否有一条 SQL 指令来检索不增加它的序列的值。

谢谢。

**编辑和结论**

正如贾斯汀洞穴所说，尝试“保存”序列号没有用，所以

```
select a_seq.nextval from dual; 
```

足以检查序列值。

我仍然保持 Ollie 的回答是好的，因为它回答了最初的问题。但是如果你想这样做，问问自己不修改序列的必要性。

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2012-04-18T13:22:39.687

```
SELECT last_number
  FROM all_sequences
 WHERE sequence_owner = '<sequence owner>'
   AND sequence_name = '<sequence_name>'; 
```

`user_sequences`您可以从和获取各种序列元`all_sequences`数据`dba_sequences`。

这些视图跨会话工作。

**编辑：**

如果序列在您的默认架构中，则：

```
SELECT last_number
  FROM user_sequences
 WHERE sequence_name = '<sequence_name>'; 
```

如果您想要所有元数据，那么：

```
SELECT *
  FROM user_sequences
 WHERE sequence_name = '<sequence_name>'; 
```

希望能帮助到你...

**编辑2：**

如果您的缓存大小不是 1，那么一种更可靠的方法是：

```
SELECT increment_by I
  FROM user_sequences
 WHERE sequence_name = 'SEQ';

      I
-------
      1

SELECT seq.nextval S
  FROM dual;

      S
-------
   1234

-- Set the sequence to decrement by 
-- the same as its original increment
ALTER SEQUENCE seq 
INCREMENT BY -1;

Sequence altered.

SELECT seq.nextval S
  FROM dual;

      S
-------
   1233

-- Reset the sequence to its original increment
ALTER SEQUENCE seq 
INCREMENT BY 1;

Sequence altered. 
```

请注意，如果其他人在此期间使用该序列 - 他们（或您）可能会得到

```
ORA-08004: sequence SEQ.NEXTVAL goes below the sequences MINVALUE and cannot be instantiated 
```

此外，您可能希望`NOCACHE`在重置之前将缓存设置为，然后再将其恢复为原始值，以确保您没有缓存很多值。

* * *

## 回答 #2

> 赞同：138
> 
> 时间：2012-04-18T13:23:12.057

`select MY_SEQ_NAME.currval from DUAL;`

请记住，它仅在您`select MY_SEQ_NAME.nextval from DUAL;`在当前会话中运行时才有效。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2020-09-17T13:15:20.780

The follows is often used:

```
select field_SQ.nextval from dual;  -- it will increase the value by 1 for each run
select field_SQ.currval from DUAL; 
```

However the following is able to change the sequence to what you expected. The `1` can be an integer (negative or positive)

```
alter sequence field_SQ increment by 1 minvalue 0 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-03-28T18:39:38.523

这不是一个答案，真的，如果问题没有被锁定，我会输入它作为评论。这回答了这个问题：

你为什么要它？

假设您有一个以序列作为主键的表，并且序列是由插入触发器生成的。如果您希望序列可用于记录的后续更新，您需要有一种方法来提取该值。

为了确保获得正确的查询，您可能希望将 INSERT 和 RonK 的查询包装在事务中。

RonK 的查询：

```
select MY_SEQ_NAME.currval from DUAL; 
```

在上述场景中，RonK 的警告不适用，因为插入和更新将发生在同一个会话中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-08-14T17:44:01.107

我还尝试使用 CURRVAL，在我的情况下，以查明是否某个进程将该序列作为主键插入到某个表中的新行。我的假设是 CURRVAL 将是最快的方法。但是 a) CurrVal 不起作用，它只会获得旧值，因为您在另一个 Oracle 会话中，直到您在自己的会话中执行 NEXTVAL。b) a`select max(PK) from TheTable`也非常快，可能是因为 PK 总是被索引。或`select count(*) from TheTable`。我仍在尝试，但两个 SELECT 似乎都很快。

我不介意序列中的间隙，但就我而言，我正在考虑进行很多轮询，并且我讨厌非常大的间隙的想法。特别是如果一个简单的 SELECT 也一样快。

结论：

*   CURRVAL 非常没用，因为它不会从另一个会话中检测到 NEXTVAL，它只会返回您从之前的 NEXTVAL 中已经知道的内容
*   SELECT MAX(...) FROM ... is a good solution, simple and fast, assuming your sequence is linked to that table

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-10-21T21:19:09.257

If your use case is that some backend code inserts a record, then the same code wants to retrieve the last insert id, without counting on any underlying data access library preset function to do this, then, as mentioned by others, you should just craft your SQL query using `SEQ_MY_NAME.NEXTVAL` for the column you want (usually the primary key), then just run statement `SELECT SEQ_MY_NAME.CURRVAL FROM dual` from the backend.

Remember, CURRVAL is only callable if NEXTVAL has been priorly invoked, which is all naturally done in the strategy above...

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2017-09-12T20:00:40.297

我原来的回复实际上是不正确的，我很高兴它被删除了。下面的代码将在以下条件下工作 a) 您知道没有其他人修改序列 b) 序列已被您的会话修改。就我而言，我遇到了一个类似的问题，我正在调用一个修改值的过程，我相信这个假设是正确的。

```
SELECT mysequence.CURRVAL INTO v_myvariable FROM DUAL; 
```

可悲的是，如果您没有在会话中修改序列，我相信其他人说 NEXTVAL 是唯一的方法是正确的。

# java - 如何在 SWT 中禁用子、孙……控制？

> ID：10210275
> 
> 赞同：3
> 
> 时间：2012-04-18T13:21:04.350
> 
> 标签：java, swt

[禁用Control](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/widgets/Control.html)的所有子、孙、曾孙等的简单方法是什么？使用下面的代码，我可以禁用复合上的所有孩子。需要循环孙子，曾孙等？

```
for(Control c: composite.getChildren()) {
    c.setEnabled(false);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T13:30:21.683

您必须将它们中的每一个设置为启用/禁用。你可以有一个简单的静态辅助方法：

```
public static void setEnabledRecursive(Composite composite, boolean enabled) {
    Check.notNull(composite, "composite"); //$NON-NLS-1$

    for (Control control : composite.getChildren()) {
        if (control instanceof Composite) {
            setEnabledRecursive((Composite) control, enabled);
        } else {
            control.setEnabled(enabled);
        }
    }
    composite.setEnabled(enabled);
} 
```

# android - 从日历获取事件的问题

> ID：10210276
> 
> 赞同：1
> 
> 时间：2012-04-18T13:21:08.393
> 
> 标签：android, calendar

我正在使用[此](https://stackoverflow.com/questions/5883938/getting-events-from-calendar)代码从日历中获取事件。

但我得到了这样的**错误**：

```
request time failed: java.net.SocketException: Address family not supported by protocol 
```

调试时，我注意到这一行的代码崩溃：

```
Cursor eventCursor = contentResolver
                    .query(builder.build(), new String[]
                    { "title", "begin", "end", "allDay" },
                            "Calendars._id=" + 1, null,
                            "startDay ASC, startMinute ASC");

 System.out.println("eventCursor count=" + eventCursor.getCount()); 
```

任何想法都会有所帮助。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T14:05:15.450

操作系统版本发生错误。可能您正在使用 SDK-7。试试这个代码，

```
Uri.Builder builder;
      if (android.os.Build.VERSION.SDK_INT <= 7)
      {
       // the old way
       builder = Uri.parse("content://calendar/instances/when").buildUpon();
      } else
      {
       // the new way
       builder = Uri
         .parse("content://com.android.calendar/instances/when").buildUpon();
      } 
```

这应该可以正常工作。

# google-maps - 调整标记图像谷歌地图 API v3

> ID：10210282
> 
> 赞同：1
> 
> 时间：2012-04-18T13:21:22.803
> 
> 标签：google-maps, google-maps-markers

我在网站的各个地方使用标记图像。用户可以选择上传图片。该大小可能适合该站点，但对于标记而言，在许多情况下它有点大，所以我想使用 API 函数来检测大图像，然后调整它们的大小。

我无法让 API 返回当前图像大小。代码现在看起来像这样：

```
var iconImg = new google.maps.MarkerImage('/'+myTrailers.getIcon(dataitem));
// TODO:  place resize function here **
var marker = new google.maps.Marker({position: pos, map: myMap.map, content: html, icon: iconImg, id: dataitem.unit_id}); 
```

我尝试使用这些函数 [googleMapsAPI-MarkerImage](https://developers.google.com/maps/documentation/javascript/reference#MarkerImage) 但不知何故该函数不起作用

```
OrgSize = iconImg.size(); 
```

如果我可以检测到图像的原始大小，我可以用它来计算新的大小，就像这样。

```
if(OrgSize[x] > 20){
    NewSize[x] = 20;
    NewSize[y] = OrgSize[y] * (NewSize[x] / OrgSize[x]); 
```

有人知道如何使用谷歌地图 API 获取图像大小吗？或者一些时髦的选择？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T00:47:39.700

没有实用的方法可以通过 JavaScript 做到这一点。您引用的`size`属性用于指定图标大小，而不是获取图标大小）。

如果用户正在上传图像，您可以使用服务器端代码根据需要调整图像大小，也可以使用服务器端代码访问图像尺寸并将这些尺寸作为属性包含在作为`dataItem`. 如果一切都是*您*服务器上的标准尺寸（即，图像都是相同的尺寸），那么您不需要调整每个图标图像的图标大小。如果您有可变大小的图像，那么您需要使用`size`每个图像的属性来声明大小是什么，然后使用该`scaledSize`属性相应地缩放每个图像。

# spotify - Spotify Apps Api - 创建播放列表的“分享”按钮

> ID：10210297
> 
> 赞同：0
> 
> 时间：2012-04-18T13:22:15.207
> 
> 标签：spotify

有没有办法让你有一个“分享这个”按钮来激活用户添加的动态创建的播放列表的Spotify分享选项？

您可以通过右键单击 spotify 左栏中的播放列表来完成此操作，但最好能够在应用程序中重复此功能

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T17:55:03.023

我只是测试我的评论并且它有效，然后我建议作为答案：

当您将播放列表添加到用户存储新的 uri 时：

```
stor = sp.require("sp://import/scripts/storage"); 
```

如果将播放列表添加到用户侧边栏：

```
pl = new model.playlist("playlist to share");
stor.set("playlisturitoshare", pl.uri); 
```

分享然后使用 iKendac 解决方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T14:29:05.887

Apps API 提供的`showSharePopup()`API 会弹出一个对话框来共享给定的 URI，如下所示：

```
var sp = getSpotifyApi(1);
var models = sp.require('sp://import/scripts/api/models');

models.application.showSharePopup(document.getElementById("header"), "spotify:track:6JEK0CvvjDjjMUBFoXShNZ"); 
```

文档可以在[这里](https://developer.spotify.com/technologies/apps/docs/beta/2edfee4d46.html)找到。

# php - 如何使用php编写对文件的响应

> ID：10210300
> 
> 赞同：0
> 
> 时间：2012-04-18T13:22:17.143
> 
> 标签：php

我希望使用 PHP 将点击给定 url 的响应写入锚标记的 href 属性。我怎样才能做到这一点？

这是我期望发生的一个例子

```
mylink.com/getdoc?name=documentA 
```

返回一个字符串作为响应：

```
mylink.com/document2012-03-15.pdf 
```

我需要写这个响应（使用 PHP 到 href 属性中，如下所示：

```
<a href="mylink.com/document2012-03-15.pdf"> Open Document A </a> 
```

（所以上面将是我页面的最终来源。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T14:26:02.823

我认为有几种方法可以做你想做的事。并非所有这些都能完全按照您的要求工作，但最终结果应该是相同的。

### 解决方案一

@shanethehat 已经发布了我的第一个可能的解决方案。您可以使用`file_get_contents`通过 HTTP 调用您的 PHP 脚本并获取响应。

### 解决方案二

@YourCommonSense 在帖子的评论中提出了另一种可能的解决方案。您可以简单地`include`使用`getdoc`生成 HTML 文件的 PHP 脚本中的脚本，如下所示：

```
$_GET["name"] = "documentA";
echo "<a href=\"". include("getdoc.php") ."\"> Open Document A </a>"; 
```

### 解决方案三

或者您可以更改`getdoc`脚本的工作方式。您可以使用更像这样的脚本：

```
header("Content-type:application/pdf");
header("Content-Disposition:attachment; filename=\"{$_GET["name"]}\"");
readfile($_GET["name"]); 
```

你保持你的链接是这样的：`<a href="mylink.com/getdoc.php?name=documentA"> Open Document A </a>`。当`getdoc.php`被调用时，它将获取指定的文件并开始文件下载。

**注意：**您可能应该使用此方法对输入进行一些清理（删除斜线，确保文件以 .pdf 结尾等），以确保有人不会尝试获取他们不允许获取的文件。

这就是我现在想出的全部。可能有一种更聪明的方法可以做到这一点，但希望这些解决方案中的一个可以为您做到这一点。我会先尝试解决方案 2 或 3，如果它们不适合您，请使用解决方案 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:26:09.080

```
<?php
    //get output from URL
    $myfile = file_get_contents('http://mylink.com/getdoc?name=documentA');
?>
<a href="<?php echo $myfile; ?>">Open Document A</a> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:26:25.240

> 如何使用php编写对文件的响应

没门。
PHP 不处理 HTTP 请求。
你必须设置你的网络服务器来进行重写。
mod_rewrite标签下有100500个问题，你会很容易找到答案的。

请注意，您可能希望将您的 url 重写为`/getdoc.php?name=document2012-03-15.pdf`，而不是您在问题中提到的

# android - 使用 Cocos2d lib 开发 Android 游戏

> ID：10210302
> 
> 赞同：2
> 
> 时间：2012-04-18T13:22:26.300
> 
> 标签：android, cocos2d-android

我想用 Cocos2d 开发游戏。我正在关注教程[http://dan.clarke.name/2011/04/how-to-make-a-simple-android-game-with-cocos2d/](http://dan.clarke.name/2011/04/how-to-make-a-simple-android-game-with-cocos2d/)。我添加了外部 cocos2d-android.jar 文件但是当我运行示例应用程序时导致以下错误。请任何人帮助我。

```
04-18 13:09:50.783: E/AndroidRuntime(497): FATAL EXCEPTION: main
04-18 13:09:50.783: E/AndroidRuntime(497): java.lang.NoClassDefFoundError: org.cocos2d.opengl.CCGLSurfaceView
04-18 13:09:50.783: E/AndroidRuntime(497):  at com.agv.Cocos2d.CoCos2dActivity.onCreate(CoCos2dActivity.java:24)
04-18 13:09:50.783: E/AndroidRuntime(497):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-18 13:09:50.783: E/AndroidRuntime(497):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
04-18 13:09:50.783: E/AndroidRuntime(497):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-18 13:09:50.783: E/AndroidRuntime(497):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-18 13:09:50.783: E/AndroidRuntime(497):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-18 13:09:50.783: E/AndroidRuntime(497):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-18 13:09:50.783: E/AndroidRuntime(497):  at android.os.Looper.loop(Looper.java:123)
04-18 13:09:50.783: E/AndroidRuntime(497):  at android.app.ActivityThread.main(ActivityThread.java:4627)
04-18 13:09:50.783: E/AndroidRuntime(497):  at java.lang.reflect.Method.invokeNative(Native Method)
04-18 13:09:50.783: E/AndroidRuntime(497):  at java.lang.reflect.Method.invoke(Method.java:521)
04-18 13:09:50.783: E/AndroidRuntime(497):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-18 13:09:50.783: E/AndroidRuntime(497):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-18 13:09:50.783: E/AndroidRuntime(497):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:40:54.260

NoClassDefFoundError 通常表示该库尚未包含在编译过程中。检查您是否已添加所有相关的 jar 文件，并且它是否位于 eclipse 的 Build 路径中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T14:41:21.793

检查您的清单文件。你必须申报活动。我有类似的问题，我以这种方式解决了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-08T15:20:47.810

将 jar 文件放入您的项目 lib 目录，然后将构建路径更改为该路径。它解决了我的问题。如果您不将 jar 文件放入您的项目中，那么在构建 apk 时，它不会采用您计算机上的目录路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-21T19:00:19.807

在您验证所有文件都在它们应该在的位置之后。检查您的点击代码是否需要您可能缺少的权限。

[我的代码在 Eclipse 中编译，但我在运行时得到一个 ClassNotFound 我该如何修复它？](https://stackoverflow.com/questions/764614/my-code-compiles-in-eclipse-but-i-get-a-classnotfound-at-runtime-how-can-i-fix-i/)

# asp.net-mvc-3 - 从 HTML.DropDownList 中获取选定的值返回到控制器（.Net MVC）

> ID：10210305
> 
> 赞同：3
> 
> 时间：2012-04-18T13:22:32.853
> 
> 标签：asp.net-mvc-3

在 MVC 应用程序中，我有一个显示任务的视图。任务应按分配到的员工进行过滤。员工显示在下拉列表中。

```
@using (Html.BeginForm("EmployeeDropUsed", "Task", new { id = ?? }))
{
    @Html.DropDownList(
        "EmployeeDrop", new SelectList(Model.Employees, "Id", "EmployeeName"), "Select employee",
        new
        {
            onchange = @"
            var form = document.forms[0]; 
            form.submit();"
        })
} 
```

我有一个带有 ActionResult 的 TaskController，从表单中获取数据：

```
[HttpPost]
public ActionResult EmployeeDropUsed(int id)
{
    Employee e = er.GetById(id);
    return LoadControls(er.GetAll(), e.Tasks.ToList());
} 
```

ViewModel 看起来像这样

```
public class TaskModel
{
    public TaskModel(List<Employee> employees, List<Task> tasks)
    {
        Employees = employees;
        Tasks = tasks;
    }

    public List<Task> Tasks { get; set; }
    public List<Employee> Employees { get; set; }
} 
```

问题是我不知道如何从下拉列表中获取选定的值到控制器。我尝试在模型中使用 DropDownListFor 和 EmployeeId 属性：

```
@Html.DropDownListFor(m => Model.EmployeeId, Model.Employees, "Select Employee")

public int EmployeeId { get; set; } 
```

结果是 id 始终为 0。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T14:18:08.153

那个 lambda 表达式不是不正确吗？难道不应该

```
@Html.DropDownListFor(m => m.EmployeeId .... 
```

代替

```
@Html.DropDownListFor(m => Model.EmployeeId 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T13:50:17.803

问题是您的`EmployeeDropUsed`操作正在寻找一个名为`id`的参数，而您发送它的参数是`EmployeeId`. `EmployeeDropUsed`将操作上的参数名称更改为`employeeId`或将`EmployeeId`属性更改`TaskModel`为`id`。

如果您更改`TaskModel`属性，这应该有效：

```
@Html.DropDownListFor(m => m.id, Model.Employees, "Select Employee") 
```

如果您更改`EmployeeDropUsed`参数，这应该可以工作：

```
@Html.DropDownListFor(m => m.EmployeeId, Model.Employees, "Select Employee") 
```

# windows - 如何在 Windows 中实现类似搜索的聚光灯？

> ID：10210306
> 
> 赞同：0
> 
> 时间：2012-04-18T13:22:34.370
> 
> 标签：windows, macos, algorithm, search, full-text-search

我需要使用户能够从我的应用程序中实时搜索文件夹的内容。在 OS X 上，我可以使用已公开的 Spotlight API 来完成。有没有办法在 Windows 上做到这一点？Windows Search SDK 是否可以帮助我完成此任务？据我所知，在用户明确授予权限之前，Windows 不会索引文件。那么这是否意味着我必须自己索引文件？是否有任何开源库可以做到这一点？我该如何实现自己的库？太多的问题，我知道。我很感激他们中的任何一个的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:26:40.110

搜索 SDK 很好，但可以由用户关闭。也可以试试 Googel Desktop - 做同样的事情，但也希望用户在安装它时采取行动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T08:22:47.780

行。我决定使用 CLucene，因为我发现它比 Windows Search 更可靠、更易于使用并且拥有更活跃的社区。当然，我可以在 Windows 和 Mac 上使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-12T11:55:04.727

看看[Xapain](http://xapian.org/)。CLucene 的发展似乎停滞不前。

# java - 如何从我的 Servlet 将换行符传递给 JavaScript？

> ID：10210312
> 
> 赞同：1
> 
> 时间：2012-04-18T13:22:49.533
> 
> 标签：java, javascript, jsp, servlets, newline

我在请求属性中设置以下内容：

```
confirmMsg = "REf No: \n 112"; 
req.setAttribute("confirmMsg", confirmMsg); 
```

我需要将上述内容显示为（在警报框中）：

参考编号：

112

我在我的 JavaScript 中使用以下 onload 函数来显示加载页面时的消息。

```
function onLoad() {
 var msg = "${confirmMsg}";
  if(msg != null && msg != "") {
    alert(msg);
   }

} 
```

以上抛出脚本错误？如何传递换行符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T13:31:10.250

`\n`需要进行 JavaScript 转义才能放入 JavaScript 字符串文字中。

使用 commons-lang`StringEscapeUtils.escapeECMAScript()`转义消息，并将转义的消息传递给您的 JSP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:36:15.460

正如我所提到的，不要将 JSP 与 JavaScript 混淆。

您要做的是从您的 JSP/Servlet（JSP 是一个 Servlet）中输出一个字符串消息，以在 JavaScript 代码块中使用。

为此，您的消息需要针对 JavaScript 进行编码，例如使用 JB Nizet 描述的 StringEscapeUtils.escapeECMAScript 方法。

然后，您需要在创建响应的 jsp 或 servlet 中将变量输出到您希望它作用于 javascript 的位置，为此您可以这样做

```
<%= confirmMsg %> 
```

而不是 ${} 因为它是一种表达式语言，并非总是在每个 jsp 中都可用。

简而言之，从 "${confirmMsg}" 改为 <%= confirmMsg %> 或 <%= (String)request.getParameter("confirmMsg") %> // 或 request.getAttribute 等等

# ajax - Ajax jsp响应文本

> ID：10210314
> 
> 赞同：2
> 
> 时间：2012-04-18T13:22:57.537
> 
> 标签：ajax, jsp, response

我正在尝试一些 AJAX 代码，其中 HTML 页面对 JSP 页面进行 ajax 调用，并从 JSP 获取日期以显示在 HTML 页面上。下面的代码只是在警报框中显示了整个响应，而我得到的只是一个随机数，如下所示：1334754128581。responsetext 不返回 HTML。该代码确实返回 4 和状态 == 200 的就绪状态。这是 HTML 中的代码：

```
<!DOCTYPE html>
<html>
<head>
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>

<script type="text/javascript">
function createXMLHttpRequest(){
  if( typeof XMLHttpRequest == "undefined" ) XMLHttpRequest = function() {
try { return new ActiveXObject("Msxml2.XMLHTTP.6.0") } catch(e) {}
try { return new ActiveXObject("Msxml2.XMLHTTP.3.0") } catch(e) {}
try { return new ActiveXObject("Msxml2.XMLHTTP") } catch(e) {}
try { return new ActiveXObject("Microsoft.XMLHTTP") } catch(e) {}
throw new Error( "This browser does not support XMLHttpRequest." )
 };
return new XMLHttpRequest();
}

var AJAX = createXMLHttpRequest();

function handler() {
 if(AJAX.readyState == 4 && AJAX.status == 200) {
  var txt =  AJAX.responseText ;
  alert('Ajax success. Result: ' + txt);
 }else if (AJAX.readyState == 4 && AJAX.status != 200) {
   alert('Ajax failed');
 }
}

function show(){
  AJAX.open("GET", "service.jsp");
  AJAX.onreadystatechange = handler;  
  AJAX.send("");
};
</script>

<body>
  <a href="#" onclick="javascript:show();"> Click to get data from server</a>
</body>
</html> 
```

JSP 页面：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
pageEncoding="ISO-8859-1"%>

 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4 /loose.dtd"> 
<html>
<head>
<title> JSP </title>
</head>
<body>
<%=new java.util.Date()%>
</body>
</html> 
```

此代码正在 Tomcat v7 上运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T14:55:22.680

抱歉，是我的错。我在处理所有 jsps 的 web.xml 中有一个自定义 servlet。servlet 将当前时间写入我从中获取随机数的作者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T03:55:07.867

我已经在 Tomcat 6 上进行了测试，它运行良好。

您正在通过 Ajax 调用请求一个完整的网页，而您得到了一个回复。正如他们所说，它按设计工作。问题不在于您的 Ajax，而在于您从服务器返回的内容。您应该只返回输出而不是碰巧有输出的网页。

`<%=new java.util.Date()%>`就您而言，只有当您想返回当前日期时才应该这样做。

# java - 在 MyBatis 中使用嵌套接口和映射器

> ID：10210315
> 
> 赞同：0
> 
> 时间：2012-04-18T13:22:59.020
> 
> 标签：java, mybatis

是否可以使用嵌套映射器接口？：

```
package com.sample.package;

public class SampleService{

  public interface SampleMapper{
    public List<MyEntity> selectAllEntities();
  }
} 
```

如果是的话：

*   映射器 xml 文件放在哪里？
*   xml文件的名称应该是什么？
*   我应该在接口的映射器 xml 文件中放入什么命名空间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T07:03:44.477

有用。

*   映射器的名称必须是 SampleService$SampleMapper.xml。
*   它必须放在 SampleService 目录中。
*   命名空间是 com.sample.package.SampleService$SampleMapper。

# sql - 不是单组群功能

> ID：10210320
> 
> 赞同：9
> 
> 时间：2012-04-18T13:23:15.583
> 
> 标签：sql, oracle

我有一些表格，基本上如下所示：

```
TBL_USER
user_id - number
user_name - varchar

TBL_STUFF
stuff_id - number
stuff_user_id - number 
```

我想查询所有用户信息，包括他们拥有的“东西”数量。我正在尝试这样的事情：

```
select user_id, user_name, count(stuff_id) 
  from tbl_user
  left outer join tbl_stuff on stuff_user_id = user_id
 where user_id = 5; 
```

但我收到一条错误消息，上面写着“不是单组功能”

还有其他方法我应该这样做吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T13:25:00.047

好吧，您缺少 group 功能；-)

尝试这个：

```
select user_id, user_name, count(stuff_id) 
from tbl_user left outer join tbl_stuff on stuff_user_id = user_id
where user_id = 5
group by user_id, user_name; 
```

最后一行是`group by`告诉 Oracle 计算具有相同 user_id 和 user_name 组合的所有行的子句。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-18T13:32:05.977

你也可以这样做：

```
select 
  user_id, 
  user_name, 
  (
    SELECT
        COUNT(*)
    FROM
        tbl_stuff
    WHERE 
        stuff_user_id = tbl_user.user_id

  ) AS StuffCount, 
from 
   tbl_user
where 
   user_id = 5; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:38:21.793

您的一条评论指出您不想包含`GROUP BY`子句中存在的所有字段。

@Arion 发布了一个相关子查询重构，它给出了相同的值。

以下查询使用标准（不相关）子查询*（内联视图）*。这是因为使用这种*内联视图*结构通常*可以*执行相关子查询等价物。但是，也是因为我发现它们更容易维护。

```
WITH
  stuff_count
AS
(
  SELECT
    stuff_user_id  AS user_id,
    COUNT(*)       AS val
  FROM
    tbl_stuff
  GROUP BY
    stuff_user_id
)
SELECT
  tbl_user.user_id,
  tbl_user.user_name,
  stuff_count.val
FROM
  tbl_user
LEFT JOIN
  stuff_count
    ON stuff_count.user_id = tbl_user.user_id
WHERE
  tbl_user.user_id = 5; 
```

***注意：***生成计划时，它只运行 user_id 必要的子查询，*而不是*整个表；）

# django - 如何让 Django 为可能的 slashdotting 做好准备？

> ID：10210325
> 
> 赞同：5
> 
> 时间：2012-04-18T13:23:32.917
> 
> 标签：django, performance, optimization, traffic, webfaction

我想为我的网站做好准备，以应对可能涌入的流量。这是我第一次使用 Django 作为框架，所以我不确定应该进行哪些修改以确保我已经准备好并且不会失败。为生产级流量准备 Django 网站可以做哪些常见的事情？

我也想知道在流量数字方面会发生什么。我目前在 Webfaction 托管，流量为 600GB/月。这会很快用完吗？是否有关于“slashdotted”事件有多大的统计数据？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T13:42:11.237

1.  使用[memcache](https://docs.djangoproject.com/en/dev/topics/cache/?#memcached)和[缓存中间件](https://docs.djangoproject.com/en/dev/topics/cache/?#the-per-site-cache)。
2.  一定要[卸载服务静态](https://docs.djangoproject.com/en/dev/howto/static-files/#serving-static-files-in-production)。
3.  使用[CDN 进行静态分析](https://docs.djangoproject.com/en/dev/howto/static-files/#serving-static-files-from-a-cloud-service-or-cdn)。这不会直接影响 Django，但会减少您的网络流量。

除此之外的任何东西 - 阅读其他人正在使用的内容：

*   [缩放 Django Web 应用程序 Mike Malone](http://highscalability.com/blog/2009/5/17/scaling-django-web-apps-by-mike-malone.html)
*   [Instagram架构](http://highscalability.com/blog/2012/4/16/instagram-architecture-update-whats-new-with-instagram.html)
*   [DISQUS架构](http://highscalability.com/blog/2010/10/26/scaling-disqus-to-75-million-comments-and-17000-rps.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T14:23:09.720

由于您在 Webfaction，因此您可以轻松地处理静态数据：

1.  创建仅静态应用程序。（不是静态 CGI/PHP 应用程序）
2.  将其添加到您当前的网站下。
3.  把你所有的静态数据放在它下面（或者符号链接到它们，这就是我所做的）。

这将通过他们的 nginx 前端提供所有静态数据——速度非常快。

关于您的带宽分配：

你没有说你提供什么类型的内容。如果它是任何甚至有点香草味的东西，你不太可能接近 600GB/月。我有一位客户提供面向成人的视频，教授密宗性爱技巧，他们的视频带宽（免费和仅限会员的视频）约为 400-450GB/月。该网站的 HTML 部分（包含大量图像）运行大约 50-60GB/月。

# c# - 组合框下拉列表位于窗口屏幕下方。

> ID：10210326
> 
> 赞同：2
> 
> 时间：2012-04-18T13:23:33.507
> 
> 标签：c#, .net, winforms

我正在使用一个 DatagridView，其中我有大约 16 行，每行都有一个组合框。当我尝试在其中包含大约 20-30 个项目的最底部行中下拉组合框时，就会出现问题。下拉列表中的滚动条消失，下拉列表位于窗口屏幕区域下方。任何可能的解决方案，以便下拉菜单打开到顶部。框架 2.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T15:38:54.403

我无法复制问题。我尝试移动这个窗口并打开各种组合框。如果它不适合下拉，它会掉下来，因此完全在屏幕上。

```
using System;
using System.Linq;
using System.Windows.Forms;

class MainForm : Form
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new MainForm());
    }

    public MainForm()
    {
        string[] comboSource = Enumerable.Range(1, 30).Select(i => String.Format("Item #{0}", i)).ToArray();

        Controls.Add(new DataGridView
        {
            AutoGenerateColumns = false,
            Columns = { new DataGridViewComboBoxColumn { HeaderText = "Item", DataSource = comboSource }, },
            DataSource = comboSource, // just adding dummy items for effect
            Dock = DockStyle.Fill,
        });
    }
} 
```

你能举出一个同样简单的例子来重复这个问题吗？

# opencv - Haarclassifier 不同的级联和阶段意味着什么？

> ID：10210327
> 
> 赞同：1
> 
> 时间：2012-04-18T13:23:34.113
> 
> 标签：opencv

不同的级联是否意味着不同的功能？有哪些不同的阶段.. 例如，在正面人脸检测 haar 数据中有 22 个级联，这是否意味着使用了 22 个不同的 haar 特征。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T15:38:55.380

不，“级联数”是指整个级联中的“级数”。在级联的任何阶段，分类器都会拒绝正在检查的子窗口。您应该阅读[这篇](http://en.wikipedia.org/wiki/Viola%E2%80%93Jones_object_detection_framework)文章以快速了解 Viola & Jones 算法，然后再进入[这篇](http://research.microsoft.com/~viola/Pubs/Detect/violaJones_IJCV.pdf)文章（作者的原始文章）。

# android - 安卓：阵列适配器；复制数据；对其进行排序；写回 ArrayAdapter；查看未正确更新

> ID：10210328
> 
> 赞同：0
> 
> 时间：2012-04-18T13:23:38.767
> 
> 标签：android, android-layout, android-emulator, android-widget

```
String[] temp = new String[adapter.getCount()];

        for(int i = 0; i < adapter.getCount(); i++)
            temp[i] = adapter.getItem(i).toString();

        List<String> list = Arrays.asList(temp);

        Collections.sort(list);

        adapter.clear();

        comment = new Comment();

        for(int i = 0; i < temp.length; i++)
        {
            comment.setComment(temp[i]);
            System.out.println("comment is: " + comment.getComment());
            adapter.insert(comment, i);
            System.out.println("adapter is: " + adapter.getItem(i));

        }

        for(int i = 0; i < adapter.getCount(); i++)
            System.out.println(adapter.getItem(i)); 
```

上面的代码对输入的 ArrayAdapter 进行排序；一个助手类，因为我正在使用 SQLiteHelper 和 SQL 数据库。

好的，所以我在清除 ArrayAdapter 中的所有数据后验证数据是否按字典排序顺序添加。

但是，当我到达最后一个 for 循环来验证这一点时，ArrayAdapter 已经在每个索引处复制了列表中的最后一项。这很奇怪，对我来说毫无意义。当然这也反映在屏幕上。

你能提供帮助以了解发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:27:42.167

`adapter.notifyDataSetChanged()`完成所有修改后调用..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T00:05:13.983

您在整个 ArrayAdapter 中使用相同的“评论”实例。因此，ArrayAdapter 的所有位置都具有完全相同的“注释”对象引用。此单个实例已设置为原始列表中的最终字符串，因此所有 ListView 项目看起来都相同。解决方案是将“注释”的实例化移动到 for 循环中，以便为每个适配器位置创建一个唯一的“注释”实例。我还稍微优化了您的代码。

```
// -- Count used repeatedly, particularly in for loop - execute once here.
int orgCount = adapter.getCount();

String[] temp = new String[orgCount];

for(int i = 0; i < orgCount; i++)
    temp[i] = adapter.getItem(i).toString();

List<String> list = Arrays.asList(temp);

Collections.sort(list);

// -- Prevent ListView refresh until all modifications are completed.
adapter.setNotifyOnChange(false);
adapter.clear();

for(int i = 0; i < temp.length; i++)
{
    // -- Instantiation moved here - every adapter position needs a unique instance.
    comment = new Comment();
    comment.setComment(temp[i]);
    System.out.println("comment is: " + comment.getComment());
    // -- Changed from insert to add.
    adapter.add(comment);
    System.out.println("adapter is: " + adapter.getItem(i));
}

for(int i = 0; i < adapter.getCount(); i++)
    System.out.println(adapter.getItem(i));

// -- Auto notification is disabled - must be done manually.
adapter.notifyDataSetChanged(true);
// -- All modifications completed - change notfication setting if desired.
adapter.setNotifyOnChange(true); 
```

**编辑** 另外，由于您一次插入/添加一个，您可能希望将 notifyDataSetChanged 延迟执行，直到所有修改完成后。这将阻止 ListView 在每次修改时刷新。我已将其包含在上面的代码中。

# php - 如何从我使用 php 从网站获得的数据创建超链接

> ID：10210330
> 
> 赞同：0
> 
> 时间：2012-04-18T13:23:47.073
> 
> 标签：php

我在这里陷入困境，我成功地从网站返回数据，但随后来自网站的超链接以文本而不是链接的形式返回。我想知道是否有任何方法可以将其作为链接返回。也可以在超链接内显示信息吗？

```
<div data-role="content">
    <div class="content-primary">
    <?php
    $query = 'http://query.yahooapis.com/v1/public/yql?q=Select%20*%20From%20rss%20where%20url%3D%22http%3A%2F%2Fworldoftanks.com%2Fnews%2Frss%2F%22&diagnostics=true';
    $xml = simplexml_load_file($query);
    //var_dump($xml);
    echo '<h2>World of Tank News</h2>';
    //iterate over query result set
    $results = $xml->results;
    foreach ($results->item as $r){
        echo $r->title . "<br />";
        echo $r->link . "<br /><br />";
    }

    ?>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:27:18.790

而不是这样做：

```
echo $r->link . "<br /><br />"; 
```

做这个：

```
echo "<a href=\"" . $r->link . "\">" . $r->link . "</a>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:33:00.730

可能是你应该使用

```
foreach ($results->item as $r){
    echo "<a href=\"" . $r->link . "\">" . $r->title . "</a><br /><br />";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T04:04:32.203

为了以这种方式回显 HTML 标签，我更喜欢使用[`printf()`](http://php.net/printf)：

```
printf(
  '<a href="%s">%s</a>'
    , htmlentities($r->link)
    , htmlentities($r->title)
); 
```

`printf()``echo`在替换特殊格式的标记后获取一个字符串并s 。在上面的示例中，字符串中有两个标记，它们都表示为`%s`。

运行时`printf()`，它将每个标记替换为相应的参数。在上面的例子中，第一个`%s`被替换为 的结果`htmlentities($r->link)`，第二个`%s`被替换为 的结果`htmlentities($r->title)`。

[手册页`sprintf()`](http://php.net/sprintf)更详细地介绍了令牌的工作原理，并提供了更多示例（除了返回格式化的字符串，而`sprintf()`直接输出它`printf()`之外，其余都是相同的）。`sprintf()``printf()`

# java - Netbeans 中具有多个可执行文件管理的软件

> ID：10210332
> 
> 赞同：0
> 
> 时间：2012-04-18T13:23:57.983
> 
> 标签：java, netbeans, client-server

我正在尝试使用 netbeans 管理一个非常简单的客户端-服务器代码。

管理这样的项目的最佳方法是什么？

*   创建 3 个项目：1 个用于客户端，1 个用于服务器，1 个用于公共？
*   通过编辑 build.xml 为每个部分创建多个 jar 文件？
*   创建一个 jar 文件并运行 2 次？
*   还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T11:28:38.077

我会去 3 项目设置。

根据您的描述，这将是最灵活的设置。

您可以分别为每个应用程序自定义构建过程，您无需考虑“刚刚构建”的是哪个应用程序，因为它很清楚。

而“commons”项目将允许您非常轻松地重用公共代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T10:39:52.493

在这种情况下，我认为最好的处理方法是创建 2 个不同的项目，1 个用于客户端，1 个用于服务器。你确定你需要一个来存储公地吗？通常他们不会共享这么多共同的方法。

如果您想让用户选择充当服务器或客户端，您也可以只创建一个项目，具体取决于您的应用程序。

# java - 创建 2 个数组 - 第一个具有随机整数，第二个具有唯一的随机整数

> ID：10210335
> 
> 赞同：1
> 
> 时间：2012-04-18T13:24:11.700
> 
> 标签：java, arrays, random, duplication

我正在处理学校的家庭作业问题。我需要创建 2 个`int[]`数组。第一个数组`int[10]`用 random 填充`integers`。第二个数组与第一个数组中的数字相同，但没有任何重复。

例如，假设我的第一个数组是`1,2,2,3,1,5,5,7,9,9`. 我的第二个数组将是`1,2,3,5,7,9`.

有人可以指出我解决这个问题的正确方向。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T13:31:02.713

将数字放入[Set](http://docs.oracle.com/javase/6/docs/api/java/util/Set.html)。然后从集合中检索数字。简单的！重复的将被自动删除！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T13:29:19.257

我会做以下事情（假设这是家庭作业，你不应该做任何太复杂的事情）......

1.  使用排序数组`java.util.Arrays.sort(myArray);`- 这将对数字进行排序，并确保所有重复的数字彼此相邻。
2.  循环遍历数组并记录唯一数字的数量（即将当前数字与下一个数字进行比较——如果它们不同，则将计数器加 1）
3.  将第二个`int[]`数组创建为正确的大小（从第 2 点开始）
4.  重复与第 2 点相同的过程，但用唯一数字填充新数组，而不是增加计数器。

这应该足以让您朝着正确的方向前进。当您有一些代码时，如果您仍有疑问，请回到我们这里询问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:43:53.700

我建议使用[Set](http://docs.oracle.com/javase/6/docs/api/java/util/Set.html)，但这里有一种不使用 Set 的方法。（注意：这会起作用，但不要问我这个效率！）

有这样的功能 -

```
 public static boolean isNumberInArray(int[] array, int number) 
      {
          for(int i=0; i<array.length; i++)
           {
                if(number == array[i])
                   return true;
           }
          return false;
      } 
```

现在在插入新数组之前使用此函数。我让你弄清楚那部分。毕竟是功课！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T13:34:52.090

提示（WATTO 解释得更好）：

```
a = sorted first array
lastItem = a[0]
append lastItem into new array
for i in 1 to length(a):
   if a[i] != lastItem:
      append a[i] into new array
      lastItem = a[i] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T13:34:54.993

@WATTO Studios 有一个很好的方法。当涉及重复时，排序总是有用的。

我将建议使用哈希表的替代方法：

1.  创建一个以整数作为键（原始数组中的数字）和计数器作为值的散列结构。
2.  遍历原始数组，对于遇到的每个数字增量，它都是哈希表中对应的计数器值。
3.  再次遍历原始数组。对于每个数字，请检查哈希表。如果关联的计数器大于 1，则删除该值并减少计数器。

我们来看一个实际案例：

```
4 5 6 4 1 1 3 
```

第一遍将创建下表：

```
1 -> 2
3 -> 1
4 -> 2
5 -> 1
6 -> 1 
```

第二步一步一步：

```
4 5 6 4 1 1 3
^

4 has a counter of 2 -> remove and decrement:

1 -> 2
3 -> 1
4 -> 1
5 -> 1
6 -> 1

5 6 4 1 1 3
^

5 has a counter of 1 -> ignore 
6 has a counter of 1 -> ignore 
4 has a counter of 1 -> ignore 
1 has a counter of 2 -> remove and decrement

1 -> 1
3 -> 1
4 -> 1
5 -> 1
6 -> 1

5 6 4 1 3
      ^    
1 has a counter of 1 -> ignore
3 has a counter of 1 -> ignore 
```

最终数组：

```
5 6 4 1 3 
```

当然，有更有效的方法来处理删除（因为使用数组意味着移位），例如将项目插入到链表中。我会让你决定的。:)

**编辑**：一种更快的方法，需要一次通过：

1.  使用与上述相同的哈希结构。
2.  遍历原始数组。对于每个项目检查表。如果关联的计数器为 0，则将其增加到 1。如果它已经为 1，则删除该项目。

# c# - 如何在 Windows Phone 的 App Tiles 中伪造我自己的

> ID：10210337
> 
> 赞同：2
> 
> 时间：2012-04-18T13:24:18.447
> 
> 标签：c#, windows-phone-7, xaml

我正在考虑我的启动屏幕/仪表板屏幕有图块（带有几行信息的正方形）。我知道磁贴不是在 Windows Phone 应用程序中使用的 UI 对象，但我看到有些人以某种方式伪造它们。

谁能给我一些关于如何实现的提示和指导？我在使用 Win-Mobile 的前 2 天看到的印象是，您无法将视图对象堆叠在一起。例如，绘制一个正方形对象，然后在其上绘制 3 行文本以制作瓷砖。

非常感谢，-代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:26:12.983

是你看到的[HubTile 控件吗？](http://www.windowsphonegeek.com/articles/Windows-Phone-HubTile-in-depth-Part1-key-concepts-and-API)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:29:20.490

Telerik RADHubTile 控件可以为您做到这一点。请看这篇文章：

[适用于 Windows Phone 应用程序的新集线器平铺控件](http://blogs.telerik.com/blogs/posts/12-03-22/new-hub-tile-control-for-your-windows-phone-apps.aspx)

注意：我认为图书馆的成本约为 99 美元。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T19:54:54.977

这是我在我的应用程序中为我的仪表板页面所做的。它只是一个内部有两个 TextBlock 的 StackPanel。然后，这些 StackPanel 位于 ListBox 内 Silverlight Toolkit for Windows Phone 的 WrapPanel 内，您不必使用它。

```
<ListBox Name="lstTiles" Margin="0,0,-12,0">
    <ListBoxItem>
        <StackPanel Background="{StaticResource PhoneAccentBrush}" Width="173" Height="173" Margin="12,12,0,0" Tap="stkSignIn_Tap">
            <TextBlock Text="Tile Title" Style="{StaticResource PhoneTextTitle2Style}" Foreground="White" TextWrapping="Wrap" Margin="12,6,12,12" Height="106" />
            <TextBlock Text="Your subtitle here" Style="{StaticResource PhoneTextNormalStyle}" Foreground="White" Margin="12,12,12,12" VerticalAlignment="Bottom" />
        </StackPanel>
    </ListBoxItem>
    <ListBoxItem>
        <StackPanel Background="{StaticResource PhoneAccentBrush}" Width="173" Height="173" Margin="12,12,0,0" Tap="stkSignIn_Tap">
            <TextBlock Text="Tile Title" Style="{StaticResource PhoneTextTitle2Style}" Foreground="White" TextWrapping="Wrap" Margin="12,6,12,12" Height="106" />
            <TextBlock Text="Your subtitle here" Style="{StaticResource PhoneTextNormalStyle}" Foreground="White" Margin="12,12,12,12" VerticalAlignment="Bottom" />
        </StackPanel>
    </ListBoxItem>
    <ListBoxItem>
        <StackPanel Background="{StaticResource PhoneAccentBrush}" Width="173" Height="173" Margin="12,12,0,0" Tap="stkSignIn_Tap">
            <TextBlock Text="Tile Title" Style="{StaticResource PhoneTextTitle2Style}" Foreground="White" TextWrapping="Wrap" Margin="12,6,12,12" Height="106" />
            <TextBlock Text="Your subtitle here" Style="{StaticResource PhoneTextNormalStyle}" Foreground="White" Margin="12,12,12,12" VerticalAlignment="Bottom" />
        </StackPanel>
    </ListBoxItem>
</ListBox> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-22T03:02:07.950

现在有许多可用的磁贴控件，但为了其他人去寻找一个，你可以在这里找到我非常简单的“本土”磁贴控件：[http ://www.crisrowlands.com/wpdev-tips-4 /](http://www.crisrowlands.com/wpdev-tips-4/)

# php - json_encode() 转义正斜杠

> ID：10210338
> 
> 赞同：195
> 
> 时间：2012-04-18T13:24:23.507
> 
> 标签：php, json

我正在从 Instagram 中提取 JSON：

`$instagrams = json_decode($response)->data;`

然后将变量解析成 PHP 数组来重构数据，然后重新编码和缓存文件：

`file_put_contents($cache,json_encode($results));`

当我打开缓存文件时，所有正斜杠“/”都被转义：

`http:\/\/distilleryimage4.instagram.com\/410e7...`

我从`json_encode()`自动执行此操作的搜索中收集...有没有办法禁用它？

* * *

## 回答 #1

> 赞同：343
> 
> 时间：2012-04-18T13:29:37.377

> 有没有办法禁用它？

是的，您只需要使用`JSON_UNESCAPED_SLASHES`标志。

> **!important**之前阅读：[https](https://stackoverflow.com/a/10210367/367456) ://stackoverflow.com/a/10210367/367456 （知道你在处理什么 - 了解你的敌人）

```
json_encode($str, JSON_UNESCAPED_SLASHES); 
```

如果您手头没有 PHP 5.4，请选择众多现有函数之一并根据您的需要对其进行修改，例如[http://snippets.dzone.com/posts/show/7487（存档副本）](http://web.archive.org/web/20140528055451/http://dzone.com/snippets/jsonencode-alternative-php-4)。

[示例演示](https://eval.in/300422)

```
<?php
/*
 * Escaping the reverse-solidus character ("/", slash) is optional in JSON.
 *
 * This can be controlled with the JSON_UNESCAPED_SLASHES flag constant in PHP.
 *
 * @link http://stackoverflow.com/a/10210433/367456
 */    

$url = 'http://www.example.com/';

echo json_encode($url), "\n";

echo json_encode($url, JSON_UNESCAPED_SLASHES), "\n"; 
```

示例输出：

```
"http:\/\/www.example.com\/"
"http://www.example.com/" 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2012-04-18T13:25:44.303

[是](https://stackoverflow.com/a/10210433/1709587)的，但不要[转义正斜杠是一件好事](https://stackoverflow.com/questions/1580647/json-why-are-forward-slashes-escaped)。在`<script>`标签内使用 JSON 时，`</script>`任何地方（即使在字符串内）都必须结束脚本标签。

根据使用 JSON 的位置，它不是必需的，但可以安全地忽略它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-03-13T19:30:19.143

另一方面，我遇到了 PHPUNIT 断言 url 包含在或等于 json_encoded 的 url 中的问题-

我的预期：

`http://localhost/api/v1/admin/logs/testLog.log`

将被编码为：

`http:\/\/localhost\/api\/v1\/admin\/logs\/testLog.log`

如果您需要进行比较，请使用以下方法转换 url：

`addcslashes($url, '/')`

在我的比较过程中允许正确的输出。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-10-15T03:25:34.287

我不得不遇到这样的情况，简单地说，

```
str_replace("\/","/",$variable) 
```

确实为我工作。

# javascript - 在 Google 地图中结合使用 Direction 服务和 Autocomplete 服务

> ID：10210343
> 
> 赞同：1
> 
> 时间：2012-04-18T13:24:37.087
> 
> 标签：javascript, autocomplete, maps

我无法设置使用 Google 地图 API 3 的小应用程序。

详细说明：我想使用两个功能：

1.  方向服务：为了计算两点之间的路线和
2.  包含源点和目标点的文本框中的自动完成功能。

我发现这两个需要来自谷歌的不同脚本：

*   [自动完成](https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places)
*   [方向服务](https://maps.googleapis.com/maps/api/js?sensor=false)

如果我在我的`<head>`部分中同时添加两者，我会收到以下警告：

> 警告：您已在此页面上多次包含 Google Maps API。这可能会导致意外错误。

如何结合这两个 javascript 功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T07:37:09.523

当您查看加载 Google Maps API 的两个链接时，您会发现它们非常相似。“libraries”参数会发生什么，它会与默认脚本一起加载其他脚本。所以基本上当你加载两个链接时会发生什么，默认脚本被加载两次并产生这个错误。

要将两者结合起来，您只需加载[https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places](https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places)。

# symfony - Symfony2 形式的 prependClientTransformer 和 appendClientTransformer 有什么区别？

> ID：10210347
> 
> 赞同：2
> 
> 时间：2012-04-18T13:24:52.257
> 
> 标签：symfony

Symfony2 形式的 prependClientTransformer 和 appendClientTransformer 有什么区别？什么时候应该使用 prependClientTransformer、appendClientTransformer。有什么例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:56:37.480

我对此的理解：

您应用 DataTransformer 的 FormType 具有在 getParent() 方法中定义的父类型。

**prependClientTransformer**将在从父类型应用的那些**之前**应用传递的 DataTransformer 。

**appendClientTransformer**将在从父类型应用的那些**之后**应用传递的 DataTransformer 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:36:23.083

正如您在[源代码](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Form/FormBuilder.php#L374)中看到的，这些方法用于控制`clientTransformers`用于转换字段数据的调用顺序。它在您创建自定义字段类型时很有用。

例如，您想创建一个`tag`字段类型，该类型将采用逗号分隔的值，这些值将在内部转换为标签数组。您将其父级设置为`text`字段类型。您还为标签类型创建了一个转换器，它将数组转换为字符串，反之亦然。现在您的标签类型将有两个`clientTranformer`，[ValueToStringTransFormer](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Form/Extension/Core/DataTransformer/ValueToStringTransformer.php)和最后一个位置的转换器。因此，当您将数据绑定到表单或提交表单时，symfony 会将客户端数据转换为字符串，然后将转换后的字符串转换为数组（如此[处](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Form/Form.php#L1056)所述）。对于相反的情况，它将数组转换为字符串，然后将字符串转换为客户端值（如此[处](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Form/Form.php#L1076)定义）。虽然还没有找到用例`prependClientTransformer`:)。

# android - Listview onItemClick() 可勾选

> ID：10210356
> 
> 赞同：0
> 
> 时间：2012-04-18T13:25:15.330
> 
> 标签：android, listview, checkbox

我有一个列表视图，其中包含实现 Checkable 的自定义相对布局中的项目。它包含一个复选框，该复选框通过可检查界面被选中/取消选中。

复选框的 setFocusable 设置为 false，以便我可以将 onItemClicked 用于列表视图。

现在，当单击一个项目时，复选框也会被选中。我对此越来越疯狂。

在我的适配器的 getView 方法中，我为复选框分配了一个 onCheckChangeListener。

每次单击列表项并检查复选框时都会调用此侦听器。

我看到了如何选择可检查的列表项 onitemclick 的问题，并且默认情况下我得到了这种行为....

这种行为的问题是：

该复选框应通过单击复选框而不是单击列表项来选中。单击复选框时，我为当前可见片段启动一个动作模式，并在单击列表项时替换当前片段。两者现在都在发生，这意味着错误片段的错误动作模式和强制关闭后压......

最好的问候维诺

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T06:27:18.927

**我认为您必须将自定义列表视图中的所有其他项目设置为**setFocusable="false"

# javascript - 如何在通过javascript完成时检测表单提交

> ID：10210357
> 
> 赞同：0
> 
> 时间：2012-04-18T13:25:17.040
> 
> 标签：javascript, html, forms, dom, document

```
<html>
<head>
<title>Untitled</title>
</head>
<script>
    document.onsubmit = formSubmitted;

    function formSubmitted() {
        alert("formSubmitted");
    }

    function clickAction() {
        alert("clickAction");
        var aForm = document.forms['form2'];
        aForm.action = "#";
        aForm.submit();
    }
</script>
<body>
    <form name="form1">
        <input type="submit" value="Direct Submit">
    </form>
    <br>
    <form name="form2" action="#$">
        <input type="button" value="Onclick Submit" Onclick="clickAction();">
    </form>
</body>
</html> 
```

这是我的代码，我正在使用 document.onsubmit = formSubmitted; 检测表单提交 警报正在工作。

但是当我尝试通过javascript提交表单时它不起作用（单击“Onclick Submit”按钮）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:41:05.170

那是不可能的。您需要扩展您的功能`clickAction`以在提交表单时通知您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:27:05.017

您需要将其附加到特定表单。

```
document.form1.onsubmit = formSubmitted;
document.form2.onsubmit = formSubmitted; 
```

# asp.net - IIS7 重写规则将 http://example.com 重定向到 https://www.example.com

> ID：10210361
> 
> 赞同：1
> 
> 时间：2012-04-18T13:25:25.373
> 
> 标签：asp.net, iis, url-rewriting

我希望以下重定向到`https://www.domain.com`

*   [http://example.com](http://example.com)
*   [http://www.example.com](http://www.example.com)

我使用 IIS 中的默认规则进行规范域重定向，它使用这种模式：

`^www\.domain\.com$`

这适用于第一个。`www`域不重定向。我尝试删除`^`但不起作用。我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:30:31.860

假设您在 IIS7 上有 URL-Rewrite 模块？

HTTP 到 HTTPS 重定向的典型示例：

```
<rule name="Redirect to HTTPS" stopProcessing="true">
  <match url="(.*)" />
  <conditions>
    <add input="{HTTPS}" pattern="^OFF$" />
  </conditions>
  <action type="Redirect" url="https://{HTTP_HOST}/{R:1}" redirectType="Permanent" />
</rule> 
```

你能试一下吗？

# java - Netty 4 有多稳定？

> ID：10210368
> 
> 赞同：4
> 
> 时间：2012-04-18T13:25:55.660
> 
> 标签：java, netty

Netty 4 有多稳定，至少是实现 HTTP 编解码器的部分，包括 Web 套接字？那部分只是对包的重命名，还是存在一些使代码不稳定的基本架构更改？

我需要能够使用 4 中的 HttpPost 功能。我曾想过尝试让它在 3.4.0 中运行，但我正在使用 OpenJDK 并尝试删除 3.4.0 给了我一个堆栈跟踪，因为它无法加载sun.misc.Unsafe 类。也许这与尝试在 OSGi 容器中运行它有关，但我还查看了我的 OpenJDK 安装中的 rt.jar 文件，并且 sun.misc.Unsafe 不存在。也许只是构建它并在 OSGi 标头中使 sun.misc 类可选会有所帮助。

这里不能使用 Sun VM，我需要使用 OpenJDK。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T18:41:58.497

Netty 4.x 还不是很稳定。我们将在接下来的几周内大量破坏 API。因此，除非您知道自己在做什么，否则我不会使用它；）

Unsafe 类的问题应该在 3.4.1.Final 中修复，如果一切顺利的话，这周应该会发布。修复与[此](https://github.com/netty/netty/issues/268)有关。

我们计划发布 3.5.0.Final 版本，其中包含 HttpPost 内容。我们只想先拥有 3.4.1.Final。所以请继续关注..

# gcc - GCC 忽略了 buildscript 中的第二个 Wno-error 选项，这是怎么回事？

> ID：10210370
> 
> 赞同：1
> 
> 时间：2012-04-18T13:25:58.650
> 
> 标签：gcc, build, gcc-warning, build-script

编辑：使用的 gcc 版本是 4.6。

我正在尝试构建一个工具链，我有一个构建脚本来构建所需的库。

我正在尝试构建 binutils，并且由于警告被视为错误并停止构建过程，因此我在构建脚本中有以下部分：

```
build_binutils() {
echo "Building binutils..."
if [ ! -e .binutils_extracted ] ; then
    tar -xjf ${FILES}/binutils-${BINUTILS_VER}.tar.bz2
    touch .binutils_extracted
fi
    CFLAGS="-Wno-error=unused-but-set-variable -Wno-error=unused-but-set-parameter"
    echo "echoing cflags..."
    echo $CFLAGS
    rm -rf binutils-build && mkdir -p binutils-build && cd binutils-build &&
    ../binutils-${BINUTILS_VER}/configure --target=arm-elf --prefix=${PREFIX} --enable-interwork --enable-multilib &&
make ${MAKE_THREADS} all CFLAGS=${CFLAGS} &&
    make install &&
    cd ${GNUARM_BUILDDIR}
} 
```

当我运行 buildscript 时，它会在出现未使用但设置参数警告的错误时停止，因为 gcc 仅使用第一个提供的 -Wno-error 开关运行，这可以在日志中看到，即

```
gcc -c -DHAVE_CONFIG_H -Wno-error=unused-but-set-variable  -I. -I../../binutils-2.20.1/libiberty/../include  -W -Wall -Wwrite-strings -Wc++-compat -Wstrict-prototypes -pedantic  ../../binutils-2.20.1/libiberty/safe-ctype.c -o safe-ctype.o 
```

我的问题是如何让 gcc 实现两个开关？

编辑：我知道 CFLAGS 确实包含两个开关，因为回声带出两个开关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:50:03.620

对我来说，这似乎是一个引用问题。

尝试使用`CFLAGS="${CFLAGS}"`

# c++ - 带 GL 的多个光源

> ID：10210371
> 
> 赞同：0
> 
> 时间：2012-04-18T13:26:00.660
> 
> 标签：c++, opengl

我正在尝试用 GL 做一些基本的事情。但是我遇到了灯的问题。我在视口中有一个立方体，当我将 GL_LIGHT0 放在某个点时，它会毫无问题地为立方体着色。但是 GL_LIGHT1 不正常动作。当我禁用 light0 并将 GL_LIGHT1 放在 light0 的同一位置时，它只是为形状提供了不同的颜色。没有阴影，没有照明。

这里有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:36:00.337

`GL_AMBIENT`, `GL_DIFFUSE`, `GL_SPECULAR`with的默认值为`GL_LIGHT0`(1,1,1)，而`GL_LIGHT1`to的默认值为 (0,0,0) `GL_LIGHT6`。

如果您使用 设置这些值`glLight*`，您应该会看到一致的行为。

# apache - 带有虚拟主机的 404 和带有 Apache (httpd) 的子目录

> ID：10210374
> 
> 赞同：0
> 
> 时间：2012-04-18T13:26:06.070
> 
> 标签：apache, httpd.conf

注意：显然我的虚拟主机条目中的 ServerName 存在冲突，我需要对我的 /etc/hosts 文件进行一些更改。对此进行调查，但任何见解都值得赞赏。谢谢

========================================

（请注意，我将 http:// 替换为 hxxp:// 以允许 stackoverflow 让我发布此内容）

我有一个服务器，10.1.1.1，我将在子目录中托管多个 WordPress 安装。服务器规格：

操作系统：RHEL 6.2 Santiago Apache 版本：Apache/2.2.15 (Unix) PHP 版本：5.3.9 MySQL 版本 5.5.20

我想从虚拟目录 site_one（即 hxxp://10.1.1.1/site_one）运行第一个 WordPress 安装——该站点的代码位于 /var/www/sites/site_one

我想从虚拟目录site_two（即hxxp://10.1.1.1/site_two）运行第二个WordPress安装——这个站点的代码是驻留在/var/www/sites/site_two

我还在 /var/www/sites 中删除了一个虚拟的 hello world index.html 文件

--

我对我的 httpd.conf 进行了以下更改：

1.  整个站点的 DocumentRoot 设置为 /var/www/sites 即：

    DocumentRoot "/var/www/sites"

2.  在 httpd.conf 的最底部，我有以下 VirtualHost 指令（我将 < 和 > 替换为 [ ] 因为我无法让堆栈溢出以输出 < blocks >：

    NameVirtualHost *:80
    [VirtualHost *:80]
    ServerName 10.1.1.1
    DocumentRoot /var/www/sites/site_one
    Alias /site_one /var/www/sites/site_one/
    [/VirtualHost]

    [VirtualHost *:80]
    ServerName 10.1.1.1
    DocumentRoot /var/www/sites/site_two
    别名 /site_two /var/www/sites/site_two/
    [/VirtualHost]

    *   我检查了 httpd (httpd -t) 的语法，并且语法没问题
    *   我重新启动httpd

--

如果我尝试访问 hxxp://10.1.1.1/site_two 它会给我一个 404 并且 error_log 报告它正在 /var/www/sites/sites_one/site_two/ 中查找文件......显然我希望它不看那里，而是在 /var/www/sites/site_two/ ...我做错了什么？感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T13:50:42.173

请参阅 Apache 文档。[http://httpd.apache.org/docs/2.2/vhosts/name-based.html](http://httpd.apache.org/docs/2.2/vhosts/name-based.html)

您正在尝试使用基于名称的虚拟主机，因为您只有一个 IP 地址。这很好，但你错过了它如何工作的 DNS 部分。从文档中：“您只需配置 DNS 服务器以将每个主机名映射到正确的 IP 地址，然后配置 Apache HTTP 服务器以识别不同的主机名。”

第一个列出的虚拟主机始终是默认主机。这就是为什么您的 site_one 将按照您“认为”的方式行事，但是当您尝试访问 site_two 时，它属于默认虚拟主机。您对虚拟主机的工作方式有错误的想法。您尝试做的事情可以使用别名来完成，但是如果您在代码中的任何地方引用文档根目录，则必须跟进您所指的站点。

例如在 PHP 代码中是这样的：

```
require($_SERVER['DOCUMENT_ROOT']."/site_one/directory/to/wherever 
```

# iphone - NSDocumentsDirectory 有最大大小吗？内容可以在应用程序外访问吗？

> ID：10210380
> 
> 赞同：2
> 
> 时间：2012-04-18T13:26:11.967
> 
> 标签：iphone, ios, itunes, nsdocumentdirectory

我们可以放入 NSDocumentsDirectory 的数据量是否有限制？我的应用程序允许拍摄照片和视频，我将这些数据保存到 NSDocumentsDirectory。我可以继续在应用程序中添加图像和视频吗？此外，这些图像和视频是否可以在应用程序之外访问？我们可以使用 iTunes 删除它们吗？请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:39:34.880

您应该从阅读文件系统访问的苹果[编程指南开始。](https://developer.apple.com/library/ios/#documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40010672)

请记住：每当苹果文档中的某些内容读起来像提示或推荐时，它实际上是在说“那样做，否则我们不会让您的应用进入我们的商店”。

# python - Python BCD分割半字节和连接2个整数

> ID：10210388
> 
> 赞同：0
> 
> 时间：2012-04-18T13:26:41.637
> 
> 标签：python, string, hex, bcd

我觉得这是一个完整的发布工具，它是如此基础，我不敢相信我在这个问题上浪费了过去两天。我已经尝试了所有我能找到的解决方案（说真的，我会告诉你我的互联网历史）但无济于事。这是问题所在：

我正在从 uC 中解析一个串行字符串。它长 52 个字节，包含许多不同的数据变量。以打包二进制编码的十进制编码的数据。

前任：`.....blah.....0x01 0x5E .....blah`

015E hex 给出 350 十进制。这就是我想要的价值。我正在读取串行字符串就好了，我使用 binascii.hexifiy 打印字节以确保它是正确的。我用

`data = ser.read()`

如果没有收到换行符，则将数据放入数组中。我尝试将数组设置为字节数组、列表，以及我能找到的任何东西，但没有任何效果。

我想将所需的两个字节部分发送到定义的方法。

`def makeValue(highbyte, lowbyte)`

当我尝试使用解包、连接、打包、位操作、字符串集中时，我一直遇到同样的问题。

因为 0x01 和 0x5E 不是有效的 int 数字（ASCII 中的标题和 ^ 的开头），所以它不起作用。它甚至不会让我先加入数字，因为它不是有效的 int。

`using hex(): hex argument can't be converted to hex. Joining the strings: invalid literal for int() with base 16: '\x01^' using int: invalid literal for int() with base 10: '\x01^' Packing a struct: struct.error: cannot convert argument to integer`

说真的，我在这里错过了一些非常基本的东西吗？我能找到的所有示例都完美地利用了上述所有功能，但它们指定了十六进制数字“0x1234”，或者它们正在转换的数字是实际的 ASCII 数字。请帮忙。

**编辑** 我明白了，ch3ka 让我走上了正轨，谢谢一百万！

我不知道为什么它以前不起作用，但我对这两个值都进行了十六进制处理

```
one = binascii.hexlify(line[7])
two = binascii.hexlify(line[8])
makeValue(one, two)` 
```

然后使用 char makeValues ch3ka 定义：

```
def makeValue(highbyte, lowbyte)
    print int(highbyte, 16)*256 + int(lowbyte, 16) 
```

再次感谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:47:13.843

您将这些值解释为字符。输入字符`int()`将不起作用，您必须将值作为字符串输入，如下所示`int("0x5E", 16)`：`int(chr(int("0x5E", 16)),16)`事实上，您正在尝试的是，这`int("^",16)`当然是行不通的。

你期待这些结果吗？

```
makevalue('0x01', '0x5E') ->  350 0x15e 0b101011110
makevalue('0xFF', '0x00') ->  65280 0xff00 0b1111111100000000
makevalue('0x01', '0xFF') ->  511 0x1ff 0b111111111
makevalue('0xFF', '0xFF') ->  65535 0xffff 0b1111111111111111 
```

如果是这样，你可以使用这个：

```
def makeValue(highbyte, lowbyte):
    return int(highbyte, 16)*256 + int(lowbyte, 16) 
```

或者 IMO 更丑陋和容易出错：

```
def makeValue(highbyte, lowbyte):
    return int(highbyte+lowbyte[2:], 16) # strips leading "0x" from lowbyte be4 concat 
```

# performance - 如何在 sencha touch 2 中动态创建/销毁选项卡

> ID：10210398
> 
> 赞同：3
> 
> 时间：2012-04-18T13:27:32.430
> 
> 标签：performance, sencha-touch-2, tabpanel

我有一个选项卡列表，我想要的是每当我切换选项卡时，项目被添加到选项卡并重新绘制，旧选项卡被销毁。我这样做是出于性能原因。

这就是我尝试这样做的方式，但它不起作用

```
view=    Ext.Viewport.add({                
                xtype : 'tabpanel',  
                deferredRender:false,
                tabBarPosition : 'bottom',
                items : tabs,
                listeners : 
                {
                    activeitemchange : function(container, newValue, oldValue,opts)
                    {
                        // --> destroy old tab
                        oldValue.setItems([]);
                        index = container.items.findIndex('id',newValue.id);
                        // --> redraw new tab                            
                        newValue.add(tabItems[index-1]);
                    }
                }
}); 
```

选项卡仅在第一次加载。我第二次进入选项卡时出现
未捕获错误：NOT_FOUND_ERR: DOM Exception 8

这样做的正确方法是什么？
这真的比创建带有项目的选项卡更高效吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:53:10.287

我不确定你为什么要这样做。这意味着实际的标签*也*将从您的标签面板中删除。那是你要的吗？

当然你只是想删除标签面板*项目*- 对吧？如果是这样，我建议你不要使用`tabpanel`，而是应该使用带有卡片布局的普通容器，然后是`tabbar`组件。这样tabbar可以有多个tab，容器（fake tabpanel）可以*假装*有几个item，但只有1/2。

# android - MySpace 集成，API 密钥生成

> ID：10210399
> 
> 赞同：13
> 
> 时间：2012-04-18T13:27:33.103
> 
> 标签：android, myspace, api-key

我正在尝试使用以下链接生成 MySpace APi 密钥，

[http://developer.myspace.com/](http://developer.myspace.com/)

但是每当我转到开发人员帐户并单击“开发人员注册”或“开始构建！” 我收到一条错误消息，上面写着：

> 很抱歉，您必须先验证您的电子邮件地址！在完成此步骤之前，您无法访问许多 MySpace 功能。请返回您的 MySpace 个人资料并单击“验证您的电子邮件地址”链接。此步骤完成后，您可以重新向开发者平台申请。

[这里](https://stackoverflow.com/questions/10103205/create-a-myspace-api-verify-your-email-error)问了同样的问题，但没有人能给出答案。

我正在使用以下 myspace sdk，

[http://myspace-android-sdk.googlecode.com/svn/trunk/](http://myspace-android-sdk.googlecode.com/svn/trunk/)

期待中，先谢谢了。。。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T14:51:31.600

你解决了吗？同样的事情发生在我身上，但我所要做的就是检索我的电子邮件档案并搜索“myspace API”，然后单击他们在您注册时发送给您的验证 URL。根据您的隐私设置，它也可能已被垃圾邮件过滤。如果是这种情况，请尝试使用相同的地址再次注册，或登录并查找显示“忘记密码”的链接，它可能会提示他们重新发送激活链接。

如果没有这些，您唯一的另外两个选择是使用全新的电子邮件地址和帐户再次注册（但请记住直接转到您这次注册的电子邮件帐户；也可能暂时降低垃圾邮件过滤器的严格性，直到您获得电子邮件），或发送电子邮件至 MySpace 技术支持：DeveloperRelations@myspace-inc.com

# git - 找出哪些本地分支与远程不同步

> ID：10210402
> 
> 赞同：9
> 
> 时间：2012-04-18T13:27:39.563
> 
> 标签：git

假设我有一个带有多个分支的 git 存储库。我怀疑一些分支没有被推到上游，或者已经过时，或者两者兼而有之（即分歧）。

有没有办法通过一个命令找出哪些分支与远程不同步？（写一个脚本是可以的，但我想知道是否已经有这样的脚本）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T08:55:15.867

我已经做了一个脚本。结果`git branch -v`提供了必要的信息。

~/bin/git-total.sh：

```
#!/bin/sh

for DIR in "$@"; do
    # Only git dirs interesting
    [ -d "$DIR/.git" ] && cd "$DIR" || continue

    # git branch -v gives ahead/behind info
    # using perl - sorry for this
    MOD=`git branch -v | perl -wlne '/^..(\S+)\s+([a-f0-9]+)\s+(\[ahead\s+(\d+)\])/ or next; print "# Branch ahead: $1"; '`;

    # a series of UGLY HACKs to get pretty-printing
    [ ! -z "$MOD" ] && MOD="
$MOD"
    git status | grep -q '^# Changes' && MOD="$MOD
# Uncommitted changes present"

    # print summary
    [ ! -z "$MOD" ] && echo -e "$DIR:$MOD"
    cd -
done 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-18T14:27:01.780

这可能会对您有所帮助：`git remote show origin`我不确定，但它对我有用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-20T10:57:54.283

[该项目`uncommitted`](https://github.com/brandon-rhodes/uncommitted)做你想做的事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T13:30:19.620

好吧，为了知道远程是否已更改，您至少需要一个 git fetch 来更新您的远程引用。之后 git status 会告诉你是落后还是领先于遥控器以及提交了多少次。

# iphone - 如何从值加载数组？

> ID：10210418
> 
> 赞同：1
> 
> 时间：2012-04-18T13:28:50.280
> 
> 标签：iphone, objective-c, ios5, sudzc

对于新手问题，我很抱歉。我已经为此工作了几天，但我遇到了理解问题。我使用 sudzc 帮助连接到我的 Web 服务。示例函数仅返回 1 个结果（最后一个）。如何将所有结果加载到数组中，以便找到 CSHR_NUM = 8？我不确定是否有问题： - (void) GetCashiersHandler: (id) value

任何帮助将不胜感激！

sudzc 日志记录返回（有数百个条目，我将其删除）：

```
<TC diffgr:id="TC1" msdata:rowOrder="0">
 <CSHR_POS_NAME>JACKSON<CSHR_POS_NAME />
  <CSHR_NUM>8</CSHR_NUM>
</TC>
<TC diffgr:id="TC2" msdata:rowOrder="1"> 
 <CSHR_POS_NAME>ALISON</CSHR_POS_NAME> 
  <CSHR_NUM>464</CSHR_NUM>
</TC> 
```

我使用调用的示例方法：

[服务 GetCashiers:self action:@selector(GetCashiersHandler];

```
// Handle the response from GetCashiers to get login in name.
- (void) GetCashiersHandler: (id) value
  {
// Do something with the CXMLNode* result
 CXMLNode *result = (CXMLNode*)value;

 NSLog(@"I returned the value: %@", result);

  } 
```

NSLog 结果：

```
I returned the value: {
 GetCashiersResult = {
diffgram = {
NewDataSet = {
TC = {
  "CSHR_NUM" = 464;
    "CSHR_POS_NAME" = ALLISON;
      };
   };
};
schema = {
  element = {
    complexType = {
   choice = {
  element = {
    complexType = {
  sequence = {
  element = 0;
        };
      };
    };
   };
   };
  };
 };
 };
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T15:44:39.733

```
NSMutableArray * myData = [[NSMutableArray alloc] initWithCapacity:5];

// loop over items to add and add them with

[myData addObject:myItem]; 
```

# vba - VBA Excel - 通过 VBA 代码修改单元格上的数据

> ID：10210419
> 
> 赞同：1
> 
> 时间：2012-04-18T13:28:52.557
> 
> 标签：vba, excel

我已经为以下内容编写了一些 VBA 代码：

1.  假设我有一个包含这些列的电子表格

[Cost1] [Cost2] [Cost3] [TotalCost] [Margin%] [Margin$] [Price]

1.  如果用户修改成本，总成本和 Margin$ 和 Price 因为它们取决于成本和 Margin%
2.  如果用户修改价格，成本不会改变，但 Margin% 和 Margin$ 会改变，因为它们取决于新价格。

我无法将受保护的公式添加到价格列，因为用户可能想要更改该值，因此公式将被删除。所以我决定编写 VBA 代码，它可以完美地计算。然而，我失去了一些excel最有价值的功能：例如，如果想将一个价格的值复制到其他几行，它只会触发复制它的第一行的重新计算，而不是其他行。退出牢房后我也失去了UNDO的能力。

为了检测单元格被修改，我使用以下内容：

```
Private Sub Worksheet_Change(ByVal Target As Range)
  If (Target.Column = Range("Price").Column)                 
    Call calcMargins(Target.Row)
  End If

  If (Target.Column = Range("Cost1").Column) or _
  If (Target.Column = Range("Cost2").Column) or _
  If (Target.Column = Range("Cost3").Column) or
    Call calcMargins(Target.Row)
    Call calcPrice(Target.Row)
  End If 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:05:12.287

尝试这个

我特意将代码分解为几个 If 语句和重复代码，以便理解透视。例如

```
 Cells(Target.Row, 4) = "Some Calculation"               '<~~ TotalCost Changes
        Cells(Target.Row, 6) = "Some Calculation"               '<~~ Margin$ Changes
        Cells(Target.Row, 7) = "Some Calculation"               '<~~ Price Changes 
```

请把它们放在一个共同的过程中。

还要注意 和 的`Error Handling`使用`Application.EnableEvents`。这两个在使用时是**必须**`Worksheet_Change`的。确保在存在递归操作的情况下`Application.EnableEvents = False`代码不会进入*可能的无限循环。*`Error Handling`不仅可以处理错误，还可以通过向您显示错误消息然后将其重置`Application.EnableEvents`为`True`并最终优雅地退出代码来阻止代码分解。

**代码**

```
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    On Error GoTo Whoa

    Application.EnableEvents = False

    If Not Intersect(Target, Columns(1)) Is Nothing Then        '<~~ When Cost 1 Changes
        Cells(Target.Row, 4) = "Some Calculation"               '<~~ TotalCost Changes
        Cells(Target.Row, 6) = "Some Calculation"               '<~~ Margin$ Changes
        Cells(Target.Row, 7) = "Some Calculation"               '<~~ Price Changes

    ElseIf Not Intersect(Target, Columns(2)) Is Nothing Then    '<~~ When Cost 2 Changes
        Cells(Target.Row, 4) = "Some Calculation"               '<~~ TotalCost Changes
        Cells(Target.Row, 6) = "Some Calculation"               '<~~ Margin$ Changes
        Cells(Target.Row, 7) = "Some Calculation"               '<~~ Price Changes

    ElseIf Not Intersect(Target, Columns(3)) Is Nothing Then    '<~~ When Cost 3 Changes
        Cells(Target.Row, 4) = "Some Calculation"               '<~~ TotalCost Changes
        Cells(Target.Row, 6) = "Some Calculation"               '<~~ Margin$ Changes
        Cells(Target.Row, 7) = "Some Calculation"               '<~~ Price Changes

    ElseIf Not Intersect(Target, Columns(7)) Is Nothing Then    '<~~ When Cost Price Changes
        Cells(Target.Row, 5) = "Some Calculation"               '<~~ Margin% Changes
        Cells(Target.Row, 6) = "Some Calculation"               '<~~ Margin$ Changes
    End If

LetsContinue:
    Application.EnableEvents = True
    Exit Sub
Whoa:
    MsgBox Err.Description
    Resume LetsContinue
End Sub 
```

我假设第 1 行受到保护，用户不会改变它。如果标题行不受保护，那么您将检查行号与`If`语句以排除第 1 行

**跟进**

> > > 我选择其中一个成本（Cost1 的第一个），执行 Ctrl+C，选择 Cost 3 下的所有单元格并执行 Crl+V，它会复制值，但它只会重新计算第一个单元格的 TotalCost 选择。谢谢你的帮助！！！– 罗纳德·瓦尔迪维亚 24 分钟前

啊，我明白你在尝试什么:)

使用此代码

```
Private Sub Worksheet_Change(ByVal Target As Range)
    Dim cl As Range

    On Error GoTo Whoa

    Application.EnableEvents = False

    If Not Intersect(Target, Columns(1)) Is Nothing Then
        For Each cl In Target
            Cells(cl.Row, 4) = Cells(cl.Row, 1) + Cells(cl.Row, 2) + Cells(cl.Row, 3)
        Next
    ElseIf Not Intersect(Target, Columns(2)) Is Nothing Then
        For Each cl In Target
            Cells(cl.Row, 4) = Cells(cl.Row, 1) + Cells(cl.Row, 2) + Cells(cl.Row, 3)
        Next
    ElseIf Not Intersect(Target, Columns(3)) Is Nothing Then
        For Each cl In Target
            Cells(cl.Row, 4) = Cells(cl.Row, 1) + Cells(cl.Row, 2) + Cells(cl.Row, 3)
        Next
    End If

LetsContinue:
    Application.EnableEvents = True
    Exit Sub
Whoa:
    MsgBox Err.Description
    Resume LetsContinue
End Sub 
```

# ruby-on-rails - 用于返回 Rails Web 服务控制器序列中的下一个数字的单例

> ID：10210420
> 
> 赞同：0
> 
> 时间：2012-04-18T13:28:54.100
> 
> 标签：ruby-on-rails, ruby, web-services, singleton

我已经实现了一个基于数据噪声的 Rails 2.3.5 SOAP 网络服务。单个 webservice api 控制器将服务于多个请求 - 需要存储在 mysql db 中的数据。对于事务参考，我需要使用 5 位十六进制数字序列中的下一个，该数字在启动 rails 应用程序时使用数据库中的最大数字进行初始化，以便我始终从十六进制序列中的最后一个数字开始。实现这一点的最简单实用的方法是什么？单例类（模型？）或缓存/会话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T15:49:13.300

您可能只需要一个辅助方法。如果您已经在上课，也许是受保护的方法？但是代码非常简单，所以根据你在做什么，你可以直接使用它：

```
(hex_string.to_i(16) + 1).to_s(16) 
```

这样就清楚发生了什么

# javascript - 为什么 Closure Compiler 坚持要添加更多字节？

> ID：10210421
> 
> 赞同：20
> 
> 时间：2012-04-18T13:28:55.880
> 
> 标签：javascript, google-closure-compiler, minify

如果我给[**Closure Compiler**](http://closure-compiler.appspot.com/home)这样的东西：

```
window.array = '0123456789'.split(''); 
```

它将它“编译”成这样：

```
window.array="0,1,2,3,4,5,6,7,8,9".split(","); 
```

现在你可以说，那更大了。Closure Compiler 这样做有什么原因吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-18T14:37:33.840

我*认为*这是正在发生的事情，但我绝不肯定......

导致插入逗号的代码`tryMinimizeStringArrayLiteral`位于[PeepholeSubstituteAlternateSyntax.java](http://code.google.com/searchframe#l5BkQmivP-Y/trunk/src/com/google/javascript/jscomp/PeepholeSubstituteAlternateSyntax.java)中。

该方法包含一个可能具有低[霍夫曼编码](http://en.wikipedia.org/wiki/Huffman_coding)的字符列表，因此比其他字符更适合拆分。如果你尝试这样的事情，你可以看到这个结果：

```
"a b c d e f g".split(" "); //Uncompiled, split on spaces
"a,b,c,d,e,f,g".split(","); //Compiled, split on commas (same size) 
```

编译器会将您尝试拆分的字符替换为它认为有利的字符。它通过迭代字符串的字符并找到字符串中没有出现的最有利的拆分字符来实现：

```
// These delimiters are chars that appears a lot in the program therefore
// probably have a small Huffman encoding.
NEXT_DELIMITER: for (char delimiter : new char[]{',', ' ', ';', '{', '}'}) {
  for (String cur : strings) {
    if (cur.indexOf(delimiter) != -1) {
      continue NEXT_DELIMITER;
    }
  }
  String template = Joiner.on(delimiter).join(strings);
  //...
} 
```

在上面的代码片段中，您可以看到编译器声称最适合拆分的字符数组。逗号是第一位的（这就是为什么在我上面的空格示例中，空格已被逗号替换）。

我相信在要拆分的字符串是空字符串的情况下插入逗号可能只是一个疏忽。这种情况似乎没有任何特殊处理，因此它与任何其他`split`调用一样被处理，并且每个字符都与上面代码片段中显示的数组中的第一个适当字符连接。

* * *

编译器如何处理该`split`方法的另一个示例：

```
"a,;b;c;d;e;f;g".split(";"); //Uncompiled, split on semi-colons
"a, b c d e f g".split(" "); //Compiled, split on spaces 
```

这一次，由于原始字符串已经包含逗号（并且我们不想在逗号字符上拆分），因此无法从低霍夫曼编码字符数组中选择逗号，因此下一个最佳选择是选择（空间）。

* * *

**更新**

经过对此的进一步研究，这绝对不是错误。这种行为实际上是设计使然，在我看来，这是一个非常聪明的小优化，当您记住 Closure 编译器倾向于支持编译代码的*速度*而不是大小时。

上面我提到过几次霍夫曼编码。哈夫曼编码算法，解释得很简单，为要编码的文本中出现的每个字符分配一个权重。权重基于每个字符出现的频率。这些频率用于构建二叉树，最常见的字符位于根部。这意味着最常见的字符可以更快地解码，因为它们更接近树的根。

并且由于 Huffman 算法是 gzip 使用的 DEFLATE 算法的很大一部分。因此，如果您的 Web 服务器配置为使用 gzip，您的用户将受益于这种巧妙的优化。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-24T15:49:45.227

此问题已于 2012 年 4 月 20 日修复，请参阅修订版： [https ://code.google.com/p/closure-compiler/source/detail?r=1267364f742588a835d78808d0eef8c9f8ba8161](https://code.google.com/p/closure-compiler/source/detail?r=1267364f742588a835d78808d0eef8c9f8ba8161)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T14:59:48.847

具有讽刺意味的是，`split`在编译代码中与源代码无关`split`。考虑：

```
Source  : a = ["0","1","2","3","4","5"]
Compiled: a="0,1,2,3,4,5".split(",") 
```

这里，`split`只是表示长数组的一种方法（足够长，所有引号 + 逗号的总和比 长`split(","")`）。那么，您的示例中发生了什么？首先，编译器看到一个应用于常量的字符串函数并立即对其求值：

```
'0123456789'.split('') => ["0","1","2","3","4","5","6","7","8","9"] 
```

稍后，当生成输出时，编译器认为这个数组是“长的”，并以上面的“拆分”形式写入：

```
["0","1","2","3","4","5","6","7","8","9"] => "0,1,2,3,4,5,6,7,8,9".split(",") 
```

请注意，此时有关`split('')`源中的所有信息都已丢失。

如果源字符串较短，它将以数组数组形式生成，无需额外拆分：

```
Source  : a = '0123'.split('')
Compiled: a=["0","1","2","3"] 
```

# mysql - Mysql：为什么要在定义表时使用适当的数据大小并选择最佳数据长度

> ID：10210430
> 
> 赞同：0
> 
> 时间：2012-04-18T13:29:22.650
> 
> 标签：mysql

我有一个存储用户详细信息的表。我几乎不能有 10K 的值。它的 ID 字段定义为 bigint(20)，甚至可以保存大数据范围。

现在，将其更改为 SMALLINT 会在性能或存储方面带来任何好处......？有人请解释一下如何。

我创建了两个小表
，一个 ID 为 INT(10)
，另一个 ID 为 INT(100)

我在每个中插入了 513 行。当我看到他们每个人的 show create table 时，我没有看到数据大小或索引大小有任何变化。它们是 MISAM 表。那么选择 SMALLINT 比 int(100) 或 INT(10) 更好的是什么？

这是那个信息

```
| id    | int(10) | NO   | PRI | NULL    | auto_increment |
| size  | int(10) | YES  |     | NULL    |                |
Data_length: 4617
Index_length: 8192

| id    | int(100) | NO   | PRI | NULL    | auto_increment |
| size  | int(10)  | YES  |     | NULL    |                |
Data_length: 4617
Index_length: 8192 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:40:01.590

数据类型和“长度”之间有一个重要的区别。

int(10) 和 int(100) 实际上是相同的数据类型，所以它们都会占用 4 个字节。“10”和“100”只影响数据的显示方式，而不是存储方式。

选择数据类型是存储效率和存储更大范围值的灵活性之间的权衡。

[这是手册](http://dev.mysql.com/doc/refman/5.5/en/integer-types.html)中的有用图表：

```
Type    Storage     Minimum Value       Maximum Value
        (Bytes)     (Signed/Unsigned)   Signed/Unsigned)
TINYINT     1   -128    127
                0   255
SMALLINT    2   -32768  32767
                0   65535
MEDIUMINT   3   -8388608    8388607
                0   16777215
INT     4   -2147483648     2147483647
                0   4294967295
BIGINT  8   -9223372036854775808    9223372036854775807
                0   18446744073709551615 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:34:17.957

更具体的字段大小的一个原因仅仅是因为它减少了错误的数量。你越是限制某人的特定自由，信息就越准确。这就是为什么在许多网站上，当您注册时，它会显示您居住的国家或州的下拉列表。这减少了用户拥有的选项数量，从而保持了安全的做法。如果一个网站允许你输入你的状态，想想你从不同用户那里得到的每一个例子。例如，佛罗里达州将是：

*   佛罗里达
*   佛罗里达州
*   佛罗里达州
*   福里达

如果你注意到了，我在最后一个例子中拼错了 Florida。现在想象一下尝试对佛罗里达州的用户进行查询，您会选择哪一个？您必须考虑用户可以输入的每个选项。限制他们的自由，让您知道该领域内的情况是最好的方法。

# axapta - 通过 X++ 发布采购装箱单时出错

> ID：10210436
> 
> 赞同：0
> 
> 时间：2012-04-18T13:29:54.910
> 
> 标签：axapta, purchase-order

我一直在尝试从代码中发布装箱单。我尝试了几种方法，但不幸的是没有成功。

我的代码如下：

```
purchTable = PurchTable::find('PO0012555');
purchFormLetter = PurchFormLetter::construct(DocumentStatus::PackingSlip);
purchformLetter.getLast();
purchFormLetter.transDate(transDate);
numberSeq  = NumberSeq::newGetNum(PurchParameters::numRefPurchPackingSlipId()).num();
purchFormLetter.update(purchTable,
"14",// numberSeq, //this is coming out blank
transDate,
PurchUpDate::All,
AccountOrder::None,
       false,
       false); 
```

当我尝试执行时，我收到了这个错误：

库存为实物和金融交易关闭，直到

你有什么主意吗？任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:06:52.593

我的猜测：您的`transDate`变量没有有效日期。

使用交叉引用，您会看到错误仅发生在`checkOpen`table 的方法中`InventClosing`。随意在这里添加断点！

如果使用空白交易日期调用该方法将失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T17:03:33.040

您要发布到封闭期吗？什么是转达？检查（总帐>设置>期间>期间）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T10:54:25.930

感谢那些试图帮助我的大师，但我发现了我的问题。我的代码或任何地方都没有问题。

我们正在与另一家咨询公司合作开展这个项目。不知何故，一位在其他公司工作的开发人员在没有任何信息的情况下在 PurchFormLetter 类上评论（评论）了 transdate 行。

因此，当我尝试在“purchFormLetter.transDate(transDate)”行设置 transdate 值时，PurchFormLetter 无法设置 remarked 行的值原因。

我取消了该行的注释，代码就像一个魅力。

# java - 拖动鼠标时在 JPanel 上画线

> ID：10210437
> 
> 赞同：3
> 
> 时间：2012-04-18T13:30:01.937
> 
> 标签：java, swing, jpanel

我想`JPanel`在鼠标拖动时绘制 2 条（或更多条）线。当我`super.paintComponent(g)` 在我的代码中使用时，我无法在面板上绘制 2 行，但是当我不使用`super.paintComponent(g);`时，结果很丑陋，如下图所示：

![在此处输入图像描述](../Images/18599bfd53c73fab25ba943ba591c85a.png)

我理解为什么这些线条会这样。

拖动鼠标时如何在面板上绘制线条？

顺便说一句，有时绘制的线`g2d.draw(line2d)`不是平滑线（下图）

![在此处输入图像描述](../Images/cc2149e0ae3283420b1cd762c99b2eaa.png)

到目前为止我的代码：

```
import java.awt.*;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.event.MouseMotionListener;
import java.awt.geom.Line2D;
import java.util.ArrayList;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.WindowConstants;

public class LineDrawing extends JPanel implements MouseMotionListener, MouseListener{
    Point point1;
    Point point2;
    Line2D line2d;

  public LineDrawing(){
       super();
       addMouseListener(this);
       addMouseMotionListener(this);
    }

 @Override
  public void paintComponent(Graphics g){

    //super.paintComponent(g);

       Graphics2D g2d = (Graphics2D) g;
       if(point1!=null && point2!=null){

          g2d.setPaint(Color.RED);
          g2d.setStroke(new BasicStroke(1.5f));
          g2d.draw(line2d);

         }
      }   

  @Override
  public void mouseDragged(MouseEvent e) {

    point2 = e.getPoint();
    line2d = new Line2D.Double(point1, point2); 
    repaint();

  }

   @Override
   public void mouseMoved(MouseEvent e) {

   }

   @Override
   public void mouseClicked(MouseEvent e) {

  }

   @Override
   public void mousePressed(MouseEvent e) {
     point1 = e.getPoint();

   }

  @Override
  public void mouseReleased(MouseEvent e) {

  }

 @Override
 public void mouseEntered(MouseEvent e) {

 }

 @Override
 public void mouseExited(MouseEvent e) {

}

public static void main(String a[]){
   EventQueue.invokeLater(new Runnable(){
        @Override
        public void run() {

         JFrame frame = new JFrame();
         LineDrawing linedraw= new LineDrawing();
         frame.add(linedraw);
         frame.setSize(500,500);
         frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
         frame.setVisible(true);   

                         }
                });
   }   
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T13:37:50.807

> ..画两条线

这似乎是这个问题的症结所在。

单击/拖动时，将一组行保留在可扩展列表中（例如`ArrayList`），向列表中添加新行并调用`repaint()`. 在`paintComponent(Graphics)`中，迭代集合并绘制每一行。

顺便说一句 - 我猜你在测试这个时没有最小化和恢复你的窗口。你的台词（漂亮的或丑陋的）会消失！

* * *

> ..他们消失了。什么原因？

每当 GUI 需要重绘时，都会调用方法`paint()`和。`paintComponent()`它们可能会在另一个窗口出现在应用程序前面后被调用，然后将它带回到前面。还有一次是从最小化恢复后。

保留这些行的选项包括：

*   存储线的位置并在被要求时重新绘制所有线（如上所述）。这可以用于大多数目的。即使有数百行，GUI 也会在“眨眼之间”重新绘制它们。
*   将每条线绘制到 a`BufferedImage`并将图像放入 (an `ImageIcon`in) a`JLabel`中。如果绘图区域的大小是固定的，并且没有任何内容被删除，那么这种方法效果很好，并且可以容纳..数百万条线、弧、半透明区域、较小的图像、文本.. 使用图像作为渲染表面，您将不再需要`ArrayList`，因为您所做的只是向图像添加新行，然后重新绘制标签以查看新行和所有先前的行。

* * *

> ..这条线不是直线。

这是因为绘制线条时使用了“渲染提示”。由对齐的像素行组成的屏幕只能完美地制作垂直或水平线。要在任何其他角度给出直线和连续线的“幻觉”，需要一种称为[抖动](http://en.wikipedia.org/wiki/Dither)的技术。阅读 的开头部分以[`Graphics2D`](http://docs.oracle.com/javase/7/docs/api/java/awt/Graphics2D.html)获得更多的解释和描述`RenderingHints`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:38:38.713

我不知道我得到你的问题，但如果你想画一条连续的线。拖动时，您必须更新最后一个点的位置。

```
@Override
  public void mouseDragged(MouseEvent e) {
    point2 = e.getPoint();
    line2d = new Line2D.Double(point1, point2); 
    point1 = point2;  // add this line
    repaint();
  } 
```

# dojo - dijit.form.FilteringSelect 强制方向向下

> ID：10210438
> 
> 赞同：0
> 
> 时间：2012-04-18T13:30:08.327
> 
> 标签：dojo

我正在使用 dijit.form.FilteringSelect

在某些浏览器中，列表会向上扩展。

如何强制下拉列表向下扩展？

# android - 如何计算 SurfaceView 刷新的帧率？

> ID：10210439
> 
> 赞同：2
> 
> 时间：2012-04-18T13:30:12.733
> 
> 标签：android, surfaceview

[我有一个在SurfaceView](http://developer.android.com/reference/android/view/SurfaceView.html)上显示视频的第三方框架。我想测量视频的帧速率，以检查手机是否能够足够快地显示视频，或者我是否需要使用其他解决方案向用户显示信息。

如何测量 SurfaceView 更新的速度？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-05T17:44:08.683

如果代码不清楚，请询问。

```
LinkedList<Long> times = new LinkedList<Long>(){{
    add(System.nanoTime());
}};

@Override
protected void onDraw(Canvas canvas) {
    double fps = fps();
    // ...
    super.onDraw(canvas);
}

private final int MAX_SIZE = 100;
private final double NANOS = 1000000000.0;

/** Calculates and returns frames per second */
private double fps() {
    long lastTime = System.nanoTime();
    double difference = (lastTime - times.getFirst()) / NANOS;
    times.addLast(lastTime);
    int size = times.size();
    if (size > MAX_SIZE) {
        times.removeFirst();
    }
    return difference > 0 ? times.size() / difference : 0.0;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-10T04:49:07.430

试试这个！

```
private long mLastTime = 0;
private int fps = 0, ifps = 0;
@Override
protected void onDraw(Canvas canvas) {
    long now = System.currentTimeMillis();

    // perform other operations

    System.out.println("FPS:" + fps);

    ifps++;
    if(now > (mLastTime + 1000)) {
        mLastTime = now;
        fps = ifps;
    ifps = 0;
    }
} 
```

# ruby-on-rails-3 - 如何手动构建表单数据？

> ID：10210444
> 
> 赞同：1
> 
> 时间：2012-04-18T13:30:23.777
> 
> 标签：ruby-on-rails-3

我有以下型号：

```
Subject has_many Points
Point belongs_to Subject 
```

使用表单创建点，控制器如下

```
 def create
    @subject = Subject.find(params[:subject_id])    
    @point = @subject.points.build(params[:point])
    if @point.save
      flash[:success] = "You have created new data"
      redirect_to subject_path(@point.subject_id)
    else
      render 'new'
    end
  end 
```

目前，用户可以使用表格为每个主题创建积分。但是，我还想允许用户从 csv 文件上传质量点。为此，我正在使用 csv 库（ruby 1.9.3）

上传csv文件后，我把csv文件放到一个表中如下

```
thegrid = CSV.table(path, :headers => true, :header_converters => :symbol) 
```

其中 path 是 csv 的路径。csv 文件的标题与数据库中的列名匹配（包括 subject_id 列号）

我想遍历表中的行并将每一行添加到数据库中，如下所示

```
 <% point = Hash.new %>
  <% thegrid.each do |row| %>
    <% 
     point = {     
              "name" => row[0],
              "total_points" => row[1], 
              "subject_id" => row[2]
             }
    %>
    <% @point = @subject.points.build(params[point]) %>
  <% end %> 
```

但上面似乎没有将行添加到数据库中。执行此循环的正确方法是什么，我认为可能是导致问题的参数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:53:38.633

我通过更新代码对这个问题进行了排序，如下所示：

```
<% 
 params[:point] = {     
           name: row[0],
           total_points: row[1], 
           subject_id: row[2]
         }
%>
<% @point = @subject.points.build(params[:point]) %> 
```

# css - Wordpress，特色图片上的交替浮动

> ID：10210445
> 
> 赞同：1
> 
> 时间：2012-04-18T13:30:29.017
> 
> 标签：css

我希望特定类别的每个循环在“特色图像”上交替浮动。这样每个新帖子的“特色图片”都会改变浮动（右侧，左侧）。

我使用以下代码在每个帖子上提取奇数或偶数类，

```
<?php query_posts('showposts=5&cat=5,'); if (have_posts()) : ?>
<?php $c = 0; ?>
<?php if (have_posts()) : ?>
<?php while (have_posts()) : the_post(); ?>
       <div <?php post_class((++$c % 2 === 0) ? 'odd' : 'even'); ?>>
       <h2 class="entry-title"><a>" title="<?php printf( esc_attr__( 'Permalink to %s', 'twentyten' ), the_title_attribute( 'echo=0' ) ); ?>" rel="bookmark"><?php the_title(); ?></a></h2>
<div class="featuredImage">
                <?php the_post_thumbnail('medium'); ?>
        </div>
    </div>
<?php endwhile; ?>
<?php endif; ?>
<?php endif; wp_reset_query();?> 
```

然后我试图在不同的帖子类（奇数或偶数）上用css更改“特色图片”上的浮动。例如，

```
.even { width:650px; height:250px; background-color: #000;}

.odd{ width:650px; height:250px; background-color: #616161;}
.odd, .featuredImage{ float:left;}
.even, .featuredImage{ float:right;} 
```

我的例子，[http ://fskador.se/myPerformanceLast/?page_id=49](http://fskador.se/myPerformanceLast/?page_id=49)

但不能让它工作！请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:47:28.990

不正确

```
<h2 class="entry-title"><a>" title="<?php printf( esc_attr__( 'Permalink to %s', 'twentyten' ), the_title_attribute( 'echo=0' ) ); ?>" rel="bookmark"><?php the_title(); ?></a></h2> 
```

已更正

```
<h2 class="entry-title"><a title="<?php printf( esc_attr__( 'Permalink to %s', 'twentyten' ), the_title_attribute( 'echo=0' ) ); ?>" rel="bookmark"><?php the_title(); ?></a></h2> 
```

**CSS**

不正确

```
.odd, .featuredImage{ float:left;}
.even, .featuredImage{ float:right;} 
```

已更正

```
div.odd .featuredImage{ float:left;} 
div.even .featuredImage{ float:right;} 
```

或者

```
.odd .featuredImage{ float:left;}
.even .featuredImage{ float:right;} 
```

# sbt - 如何在自定义 sbt 命令中暂时跳过运行编译任务？

> ID：10210448
> 
> 赞同：6
> 
> 时间：2012-04-18T13:30:32.833
> 
> 标签：sbt

`package`从命令中运行任务时，我试图暂时跳过编译任务`quick-install`（在我正在编写的 sbt 插件中定义）。我可以通过将`skip`设置放在`compile`任务上来跳过所有编译，但这会导致所有`compile`任务被跳过：

```
 object MyPlugin extends Plugin {
    override lazy val settings = Seq(
      (skip in compile) := true
    )
    ...
  } 
```

我需要的是只`compile`在运行我的`quick-install`命令时跳过。有没有办法临时修改设置，或者将其范围仅限于我的快速安装命令？

我已经尝试过设置转换（基于[https://github.com/harrah/xsbt/wiki/Advanced-Command-Example](https://github.com/harrah/xsbt/wiki/Advanced-Command-Example)），它应该替换所有实例`skip := false`with `skip := true`，但它没有任何效果（即编译转换后仍然发生）：

```
object SbtQuickInstallPlugin extends Plugin {
  private lazy val installCommand =  Command.args("quick-install", "quick install that skips compile step")(doCommand(Configurations.Compile))

  override lazy val settings = Seq(
    commands ++= Seq(installCommand),
    (Keys.skip in compile) := false    // by default, don't skip compiles
  )

  def doCommand(configs: Configuration*)(state: State, args: Seq[String]): State = {
    val extracted = Project.extract(state)
    import extracted._
    val oldStructure = structure

    val transformedSettings = session.mergeSettings.map(
      s => s.key.key match {
        case skip.key => { skip in s.key.scope := true } // skip compiles
        case _ => s
      }
    )

    // apply transformed settings (in theory)
    val newStructure = Load.reapply(transformedSettings, oldStructure)
    Project.setProject(session, newStructure, state)

    ...
} 
```

知道我缺少什么和/或更好的方法吗？

编辑：

跳过设置是一个任务，因此一个简单的解决方法是：

```
object SbtQuickInstallPlugin extends Plugin {
  private lazy val installCommand =  Command.args("quick-install", "quick install that skips compile step")(doCommand(Configurations.Compile))

  private var shouldSkipCompile = false  // by default, don't skip compiles

  override lazy val settings = Seq(
    commands ++= Seq(installCommand),
    (Keys.skip in compile) := shouldSkipCompile
  )

  def doCommand(configs: Configuration*)(state: State, args: Seq[String]): State = {
    shouldSkipCompile = true // start skipping compiles

    ... // do stuff that would normally trigger a compile such as running the packageBin task

    shouldSkipCompile = false // stop skipping compiles
  }
} 
```

我不相信这是最强大的解决方案，但它似乎可以满足我的需要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T11:42:35.507

```
object SbtQuickInstallPlugin extends Plugin {
  private lazy val installCommand =  Command.args("quick-install", "quick install that skips compile step")(doCommand(Configurations.Compile))

  private var shouldSkipCompile = false  // by default, don't skip compiles

  override lazy val settings = Seq(
    commands ++= Seq(installCommand),
    (Keys.skip in compile) := shouldSkipCompile
  )

  def doCommand(configs: Configuration*)(state: State, args: Seq[String]): State = {
    shouldSkipCompile = true // start skipping compiles

    ... // do stuff that would normally trigger a compile such as running the packageBin task

    shouldSkipCompile = false // stop skipping compiles
  }
} 
```

没关系，当然你可以去！

# c++ - 包含宏的 C++ 方法声明

> ID：10210449
> 
> 赞同：1
> 
> 时间：2012-04-18T13:30:35.430
> 
> 标签：c++, class, macros, c-preprocessor, boost-preprocessor

我正在使用 QuickFAST 库，在检查它时我发现了这个我似乎并没有真正得到的类声明！我的意思是类名之前的宏名是什么！

```
class QuickFAST_Export Message : public FieldSet 
```

我也发现了这个声明

```
friend void QuickFAST_Export intrusive_ptr_add_ref(const Field * ptr); 
```

再一次我没有得到这个声明的使用！

欲了解更多信息，这里是 QuickFAST_Export.hpp

```
#ifdef _MSC_VER
# pragma once
#endif
#ifndef QUICKFAST_EXPORT_H
#define QUICKFAST_EXPORT_H

// Compile time controls for library generation.  Define with /D or #define
// To produce or use a static library: #define QUICKFAST_HAS_DLL=0
//   Default is to produce/use a DLL
// While building the QUICKFAST_ library: #define QUICKFAST_BUILD_DLL
//   Default is to export symbols from a pre-built QUICKFAST DLL
//
// Within QUICKFAST use the QuickFAST_Export macro where a __declspec is needed.

#if defined (_WIN32)

#  if !defined (QUICKFAST_HAS_DLL)
#    define QUICKFAST_HAS_DLL 1
#  endif /* ! QUICKFAST_HAS_DLL */

#  if defined (QUICKFAST_HAS_DLL) && (QUICKFAST_HAS_DLL == 1)
#    if defined (QUICKFAST_BUILD_DLL)
#      define QuickFAST_Export __declspec(dllexport)
#    else /* QUICKFAST_BUILD_DLL */
#      define QuickFAST_Export __declspec(dllimport)
#    endif /* QUICKFAST_BUILD_DLL */
#  else /* QUICKFAST_HAS_DLL == 1 */
#    define QuickFAST_Export
#  endif /* QUICKFAST_HAS_DLL == 1 */

#  else /* !_WIN32 */ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:31:36.580

这意味着该类是导出还是导入，具体取决于构建的模块。

如果`QUICKFAST_HAS_DLL`定义为 1，则表示模块构建为 DLL。要从外部使用功能，必须导出类和方法。

在模块内部，`QUICKFAST_BUILD_DLL`被定义。因此，当您构建模块时，`QuickFAST_Export`扩展为`__declspec(dllexport)`. 您的类定义变为：

```
class __declspec(dllexport) Message : public FieldSet 
```

当您包含来自不同模块的标头时，`QUICKFAST_BUILD_DLL`未定义，因此宏扩展为`__declspec(dllimport)`，您的类定义为：

```
class __declspec(dllimport) Message : public FieldSet 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T13:34:11.327

宏扩展为`__declspec(dllimport)`或 `__declspec(dllexport)`，具体取决于类是从 DLL 导出还是从另一侧导入。

# r - ggplot2：根据填充值为某些点设置 alpha=0

> ID：10210450
> 
> 赞同：10
> 
> 时间：2012-04-18T13:30:41.197
> 
> 标签：r, plot, ggplot2, alpha, fill

我目前正在开展一个项目，该项目涉及创建与 Hadley 的 ggplot2 0.9.0 页面中关于 stat_density2d() 的示例非常相似的图。

```
library(ggplot2)
dsmall <- diamonds[sample(nrow(diamonds), 1000), ]
d <- ggplot(dsmall, aes(carat, price)) + xlim(1,3)
d + stat_density2d(geom="tile", aes(fill = ..density..), contour = FALSE)
last_plot() + scale_fill_gradient(limits=c(1e-5,8e-4)) 
```

![在此处输入图像描述](../Images/32c1e3be1eddae06b76ce13e82eff389.png)

现在，我正在努力解决的问题是一种基本上关闭所有不在填充范围内的图块的 alpha（alpha=0）的方法。所以在图像中看到的每个灰色图块，alpha 值都应该设置为 0。这会使图像更好看，尤其是当覆盖在地图上时。

如果有人有任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-18T22:38:50.080

另一种可能性，只是使用`ifelse`而不是`cut`.

```
d + stat_density2d(geom="tile", 
    aes(fill = ..density.., alpha = ifelse(..density.. < 1e-5, 0, 1)), 
    contour = FALSE) + 
scale_alpha_continuous(range = c(0, 1), guide = "none") 
```

![在此处输入图像描述](../Images/5f2ed7613fa350338cd851369b61a2c4.png)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-18T22:09:43.067

这似乎有效：

```
d + stat_density2d(geom="tile", 
     aes(fill = ..density.., 
     alpha=cut(..density..,breaks=c(0,1e-5,Inf))), 
     contour = FALSE)+
 scale_alpha_manual(values=c(0,1),guide="none") 
```

![在此处输入图像描述](../Images/decc86b4cba618f80b11e1d8f32ba320.png)

# http - 内容将在 post 请求中从哪里开始？

> ID：10210455
> 
> 赞同：0
> 
> 时间：2012-04-18T13:30:54.113
> 
> 标签：http, post, network-programming, http-proxy

我正在为类创建代理服务器，目前正在解析客户端请求。当我收到一个 POST 请求时，我如何知道标头的结束位置和内容的开始位置？是否有一个总是最后出现的标题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:50:14.987

它应该在空行之后（CRLF = 回车，换行，即空行）。在最后一个标题之后应该有两个，一个转到下一行，另一个创建一个空白行。然后内容将开始。

```
POST /enlighten/rest HTTP/1.1
Host: api.opencalais.com
Content-Type: application/x-www-form-urlencoded
Content-Length: length

licenseID=string&content=string&/paramsXML=string 
```

来自：[http ://www.opencalais.com/HTTPexamples](http://www.opencalais.com/HTTPexamples)

# javascript - 将图像库插件与图像放大功能插件集成

> ID：10210469
> 
> 赞同：0
> 
> 时间：2012-04-18T13:31:41.590
> 
> 标签：javascript, jquery, html, css

我知道这个网站是在积分系统上工作的，所以我想强调一下，我是一名刚起步的开发人员，而且我是这个网站的新手。请友好一点！！！

我在开发我想要实现的目标时遇到了一个小问题，我相信这可能主要是 HTML 问题。我已经下载了两个插件，一个是图像缩放功能，另一个是带有缩略图的图片库。

我面临的挑战是将这两个函数集成在一起，因为这两个函数都需要我找不到将这两个脚本合并在一起的“干净”方法。有没有人知道我如何将这两个脚本合并在一起？

图像缩放 HTML

```
 <a class="zoom" href="css/product-gallery/item1.jpg"><img class="product-gallery" src="css/product-gallery/item1.jpg" alt="img1"></a> 
```

带有缩略图 HTML 的图片库

```
<a class="thumb" href="css/product-gallery/item1.jpg" title="Title #0"><img src="css/thumbnails/thumb2.jpg"/></a> 
```

[单击此处获取图像缩放代码](http://iamnatesmithen.com/fluotics/productsFinal.html)

PS“这不是我追求的灯箱效果，它更像是我追求的eCom图像缩放功能”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:42:37.320

同时拥有它们（灯箱缩放+悬停缩放）并没有多大意义，您应该选择一个并继续使用。Lightbox 非常易于使用，并且会完全按照您的意愿进行操作，所以我会使用它。快速的小例子： -

```
<script type="text/javascript">
$(function() {
    $('#imageGallery a').lightBox();
});
</script>

<div id="imageGallery">
   <a href="image-you-want-to-zoom"><img src="thumbnail-image" /></a>
</div> 
```

如果“灯箱式”功能不是您所追求的，请尝试以下操作：

[http://www.jacklmoore.com/zoom](http://www.jacklmoore.com/zoom)

对于它的一些快速模型代码：

[http://jsfiddle.net/jquerybyexample/cvjsN/](http://jsfiddle.net/jquerybyexample/cvjsN/)

# asp.net-mvc-3 - 在 ASP MVC 3 中跨视图使用相同的模型视图实例

> ID：10210472
> 
> 赞同：0
> 
> 时间：2012-04-18T13:31:53.037
> 
> 标签：asp.net-mvc-3, model-view

我有两个视图：第一个有一个表单，当它提交时，它会填写一个模型视图（QuizzModelView）。

现在提交后，我被重定向到另一个视图，该视图也有一个我要提交的表单。问题是我想对两个视图使用相同的 QuizzModelView。这意味着，在提交第二个表单时，我还想提交前一个表单的值。我可以通过创建隐藏输入来做到这一点，这些输入采用来自第一个视图的值。

有没有办法在没有隐藏输入的情况下做到这一点。

谢谢

编辑：解释更多：

我的模型视图包含：QuizzModelView.field1、QuizzModelView、.field2

*   第一步：View1 将填写 QuizzModelView.field1

*   第二步：我被重定向到 view2

*   第三步：View2 将填写 QuizzModelView.field2

现在我希望能够得到 QuizzModelView.field1 和 QuizzModelView.field2。但我只得到 QuizzModelView.field2 因为提交 View2 时 QuizzModelView.field1 丢失

这是我的行动：

```
[HttpPost]
public ActionResult TAFPart2PopupEvents(QuizzModelView model)
{
    return PartialView("PartialViews/_TAFPart2PopupEvents", model);
}

[HttpPost]
public ActionResult TAFPart3PopupEvents(QuizzModelView model)         
{
    // here I want to use 
    // model.field1 and model.field2
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:37:28.090

如果您希望您的`TAFPart3PopupEvents`操作可以访问数据，则需要将其存储在某个地方。有许多不同的选项（会话、查询字符串、数据库），但我认为隐藏输入（通常）是最简单的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T14:40:06.490

从技术上讲（迂腐），您将无法使用模型的相同实例。但是，您可以将其放入会话中并通过重定向传递。Session 的优点是不像隐藏字段那样容易被篡改。另外，您不必为每个步骤实际绑定整个模型 - 只需每个步骤中的单个字段：

```
[HttpPost]
public ActionResult TAFPart2PopupEvents(string field1)
{
    QuizzModelView model = new QuizzModelView();
    model.Field1 = field1
    Session["Quiz"] = model;

    return PartialView("PartialViews/_TAFPart2PopupEvents", model);
}

[HttpPost]
public ActionResult TAFPart3PopupEvents(string field2)         
{
    var model= (QuizzModelView )Session["Quiz"];

    // Fill in field2 here
    model.Field2 = field2;

} 
```

编辑：用一些实际细节来解决布赖恩的评论 -

这种带有会话的方法比隐藏字段更不容易受到数据篡改的影响，如果这是一个问题的话。通过视图中的隐藏字段，恶意用户可以轻松覆盖以前的数据。根据模型的大小，隐藏字段也可能会使视图膨胀一点。

会话也有过期的缺点。这是处理过期的简单方法。如果这是通过 Ajax 调用的，那么您必须将错误消息传递回客户端而不是在那里进行处理。

```
[HttpPost]
public ActionResult TAFPart3PopupEvents(string field2)         
{
    var model= Session["Quiz"] as QuizzModelView;

    if (model == null)
    {
        // Add some kind of message here.
        // TempData is like Session, but only persists across one request.
        TempData["message"] = "Session Expired!";

        return RedirectToAction("Index");
    }

    // Fill in field2 here
    model.Field2 = field2;

    ....
} 
```

# java - 将图像视图添加到特定坐标上的布局

> ID：10210473
> 
> 赞同：0
> 
> 时间：2012-04-18T13:31:55.073
> 
> 标签：java, android, layout

我正在动态地将 ImageViews 添加到布局中。这是代码，它正在做我想要的：

```
 setContentView(R.layout.main);
    RelativeLayout main = (RelativeLayout) findViewById(R.id.main_view);
    ImageView smokeImage = new ImageView(this);
    Drawable smoke = getResources().getDrawable(R.drawable.smoke);
    smokeImage.setBackgroundDrawable(smoke);
    main.addView(smokeImage, 800, 800); 
```

如何将 ImageView 添加到特定坐标？例如。我希望它出现在 x=25px 和 y=43px 上。有什么特殊功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T23:16:45.217

最简单的方法是为图像视图设置边距。您可以使用 create `RelativeLayout.LayoutParams`，将边距设置为 params

```
params.setMargins(left, top, right, bottom); 
```

并将参数设置为您的图像视图

```
smokeImage.setLayoutParams(params); 
```

# android-intent - Appcelerator 中的 Android 意图

> ID：10210479
> 
> 赞同：0
> 
> 时间：2012-04-18T13:32:12.140
> 
> 标签：android-intent, appcelerator

我使用 Appcelerator 的 Titanium 开发了一个应用程序。在应用程序中，用户可以向指定的个人发送电子邮件。我希望自动填充收件人地址以保存用户。我使用的是 Android Intent，除了收件人地址外，一切正常。主题和正文很好。关于如何自动填充收件人和抄送地址的任何提示？我已经包含了下面的代码。

```
email.addEventListener('click', function(e) {

 var intent = Ti.Android.createIntent({
      action: Ti.Android.ACTION_SEND,
      type: 'plain/text',

 });

 intent.putExtra(Ti.Android.EXTRA_SUBJECT,'The Subject');
 intent.putExtra(Ti.Android.EXTRA_EMAIL,'username@comcast.net');
 intent.putExtra(Ti.Android.EXTRA_TEXT,'Hello');
 intent.putExtra(Ti.Android.EXTRA_CC,'username@comcast.net');
 intent.addCategory(Ti.Android.CATEGORY_DEFAULT);
 try {
      Ti.Android.currentActivity.startActivity(intent);
 } catch (ex) {
      Ti.UI.createNotification({message: 'No sharing apps installed!'}).show();
 } 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T21:41:00.993

您没有在 Titanium API 中使用[emailDialog有什么原因吗？](http://docs.appcelerator.com/titanium/2.0/index.html#!/api/Titanium.UI.EmailDialog)

页面示例：

```
var emailDialog = Ti.UI.createEmailDialog();
emailDialog.subject = "The Subject";
emailDialog.toRecipients = ['username@comcast.net'];
emailDialog.ccRecipients = ['username@comcast.net'];
emailDialog.messageBody = 'Hello';
emailDialog.open(); 
```

我似乎也无法让 android 意图方法工作。

希望能帮助到你。

# javascript - 带有 URL 片段问题的 IE 中的奇怪 document.location.href 问题

> ID：10210480
> 
> 赞同：2
> 
> 时间：2012-04-18T13:32:14.880
> 
> 标签：javascript, internet-explorer, url

我们正在使用 jQuery Address 插件对页面 url 中的过滤器进行排序。例如：

```
/Page.aspx#/?PageIndex=0&SortFieldName=Name&SortDirection=ASC 
```

现在，当您在页面上并更改过滤器时，它会使用 jQuery 地址函数更新 URL 片段（# 之后的部分）。但是在其他页面上，我们有时希望直接链接到上面的 URL，而不仅仅是

```
/Page.aspx 
```

它所有的浏览器，但 IE 这很好。我们有一个小函数可以简单地做到这一点。

```
document.location.href = url; 
```

它通过 URL 片段传递了完整的 URL。奇怪的是，虽然 IE9 似乎忽略了 Fragment 并最终只是。

```
/Page.aspx 
```

但它并不总是这样做。例如，我有另一个页面，如果我在转到带有 URL 片段的页面之前单击它例如，我先转到 Company.aspx，然后再转到 Page.aspx#/?PageIndex=0&SortFieldName=Name&SortDirection=ASC 它工作正常。

确实非常奇怪的行为

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:38:07.557

`document.location`应该是[只读的](https://developer.mozilla.org/en/DOM/document.location)。

如果要更改 URL，则应使用`window.location`：

`window.location.href = url;`

# c - 字符串安全函数与安全增强型 CRT

> ID：10210485
> 
> 赞同：1
> 
> 时间：2012-04-18T13:32:33.177
> 
> 标签：c, windows, string, winapi, strsafe

StringCch* 函数是否被认为比 CRT 字符串函数的安全版本更安全。

StringCchCatW 比 wcscat_s 更安全吗？还是 StringCchCopyW 与 wcscpy_s？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:33:50.433

这被标记为 C++，所以你不应该使用它们中的任何一个，`std::wstring`而应该使用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:15:59.643

这实际上取决于您如何处理应用程序中的字符串。

使用 Windows SDK，许多人最终混合了大量的 c-runtime 和 windows api 调用 - 因为 windows api 是一个 C API 分层在 c-runtime 之上，所以 windows 程序员很难知道他们正在这样做，以及为什么它（可能）是错误的。

但是，基本上，在应用程序开发的某个阶段，您确实应该选择从哪里获取基本数据类型。尤其是字符串数据作为本地化api的情况下，排序、排序等效果就大不一样了。

您可以选择使用 c-runtimes 字符串支持。这涉及使用类型为“const char*”或 wchar_t 的字符串。Microsoft 的 c-runtime（可以使用 GCC 开发 windows 应用程序，因此如果您想编写在多个编译器上编译的代码，这种区别可能很重要）提供了一组函数 in ，基于将文本数据存储在 _TCHAR 中，并且使用 _MBCS 和 _UNICODE 宏将功能从单字符切换到多字节字符再到支持宽字符的版本。

如果您选择使用 c-runtimes 字符串抽象，那么使用 c-runtimes “安全”字符串 routnes 将是最有意义的。

或者，Windows GUI 应用程序经常选择使用 Windows SDK 数据类型：CHAR、INT、WCHAR、TCHAR、DWORD 等。字符串，通常由 LPCTSTR 变量表示，在这种情况下，继续使用 Windows 抽象、SafeStringCch 等. 最有意义。

确实，您在程序中可以做的最糟糕的事情是不断在使用 Windows API 调用和 c-runtime 调用之间来回切换，因为它们有时对于如何处理边缘情况有不同的规则......这可能会导致一些非常很难发现错误。

# windows-error-reporting - 为 Windows 错误报告映射产品数据

> ID：10210490
> 
> 赞同：2
> 
> 时间：2012-04-18T13:32:46.243
> 
> 标签：windows-error-reporting

[如此处](https://stackoverflow.com/questions/9336824/winqual-has-moved-to-sysdev-microsoft-com)所述，WinQual 已为 Windows 错误报告移动和映射产品数据，必须使用 Microsoft 生态系统元数据交换 (MEME) 完成。

在我们的自动构建过程中，一个脚本为 Winqual 创建了 XML 文件并自动进行了上传。现在 MEME 提供了一组 powershell cmdlet 来从产品二进制文件创建映射文件。

[到目前为止，除了这篇文章](http://www.gazoakley.com/content/getting-started-microsoft-ecosystem-metadata-exchange)，我找不到任何有关此 cmdlet 的文档。不幸的是，那里描述的 powershell 脚本似乎没有正确设置公司名称。

谁能提供更好的文档？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T10:42:48.617

微软表示，EMX GUI 中存在一个已知错误，在文件列表中显示产品名称而不是公司名称。错误将通过 EMX 升级修复。

Microsoft 现在还提供了有关[如何使用 EMX 的 PowerShell Cmdlet](http://blogs.msdn.com/b/wer/archive/2012/03/28/windows-hardware-dashboard-reports-faq.aspx)的常见问题解答更新。

# android - 在 Android 中切换相机

> ID：10210492
> 
> 赞同：2
> 
> 时间：2012-04-18T13:32:49.470
> 
> 标签：android

我正在关注以下示例：http: [//developer.android.com/guide/topics/media/camera.html](http://developer.android.com/guide/topics/media/camera.html)

用于开发相机应用程序。

这个应用程序显示一个相机预览和一个按钮，当用户点击按钮时，照片被拍摄并保存，相机预览再次显示。

但我现在想切换到前置摄像头。关于如何做到这一点的任何想法？可以从前置或后置摄像头开始，但我无法在运行时更改它，就好像我调用了一个新的摄像头实例，应用程序崩溃了。

知道如何做到这一点吗？

提前致谢，佩马尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T22:00:29.067

您一次只能打开一台相机。也就是说，您必须在前置摄像`release()`头之前使用后置摄像头。`open(1)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:42:14.173

您可以打开任何您想要的相机，请参见下面的链接

[http://developer.android.com/reference/android/hardware/Camera.html#open(int)](http://developer.android.com/reference/android/hardware/Camera.html#open%28int%29)

如上面的链接所示，您应该使用

**c = Camera.open(int)** *而不是* c = Camera.open()

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-08T12:22:55.590

Here is how I've done:

```
private Camera mCamera=null;
private CameraPreview mPreview;
public FrameLayout preview;

        @Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.camera_preview);
    View myView= (View) findViewById(R.id.camera_previeww);
    myView.setSystemUiVisibility(View.SYSTEM_UI_FLAG_HIDE_NAVIGATION);

    cameraID= Camera.CameraInfo.CAMERA_FACING_FRONT;
    mCamera=openCamera(cameraID);
    mCamera.startPreview();

    // Create our Preview view and set it as the content of our activity.
    mPreview = new CameraPreview(this, mCamera);
    FrameLayout preview = (FrameLayout) this.findViewById(R.id.camera_previeww);
    preview.addView(mPreview);
}

public void switchCamera(){

    mCamera.stopPreview();
    releaseCamera();
    if (cameraID==Camera.CameraInfo.CAMERA_FACING_BACK){
        cameraID=Camera.CameraInfo.CAMERA_FACING_FRONT;
    }else{
        cameraID=Camera.CameraInfo.CAMERA_FACING_BACK;
    }

    mCamera=openCamera(cameraID);
    mCamera.startPreview();

    CameraPreview mPreview = new CameraPreview(this, mCamera);
    preview = (FrameLayout) this.findViewById(R.id.camera_previeww);
    preview.removeAllViews();
    preview.addView(mPreview);

}
public  Camera openCamera(int cameraIDD){
    Camera c=null;
    try{
        c=Camera.open(cameraIDD);
    }catch (Exception e){
        Log.d("Camera Activity", e.getMessage());
    }
    return c;

} 
```

You have only to call **switch()** method to change from back to front or front to back. The activity was starting by calling **startActivity(this, Class)** from another activity.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-22T17:07:59.757

一个可能的解决方案是获取 SurfaceView 的持有者（在我试图修复的场景是从前置摄像头切换到后置摄像头，反之亦然）。

```
 public void switchCamera(){
    Log.i(TAG, "Switching Camera");
    if (mCamera != null) {
        mCamera.stopPreview();
        mCamera.release();
        //mCamera = null;
    }

    //swap the id of the camera to be used
    if (camId == Camera.CameraInfo.CAMERA_FACING_BACK) {
        camId = Camera.CameraInfo.CAMERA_FACING_FRONT;
    }else {
        camId = Camera.CameraInfo.CAMERA_FACING_BACK;
    }
    try {
        mCamera = Camera.open(camId);
        //mCamera.setDisplayOrientation(90);
        //You must get the holder of SurfaceView!!!
        mCamera.setPreviewDisplay(mView.getHolder());
        //Then resume preview...
        mCamera.startPreview();
    }
    catch (Exception e) { e.printStackTrace(); }
} 
```

希望它对遇到类似问题的人有所帮助。

# ruby-on-rails - Rails：确保模型中的大写？

> ID：10210493
> 
> 赞同：9
> 
> 时间：2012-04-18T13:32:52.570
> 
> 标签：ruby-on-rails, activerecord, input, capitalization

在 Rails 模型中，如果我有一个用于专有名称的字段，那么确保它们统一大写的最佳实践方法是什么，尽管用户可能会懒惰输入？

IE 假设模型是`Contact`，字段是`Name`. 无论用户输入什么，我都希望将单词大写，即模型会将以下输入转换为以下输出：

```
john doe -> John Doe
j doe -> J Doe
John doe -> John Doe
john doe jr -> John Doe Jr 
```

那么，您是创建一个`before_save`回调并使用正则表达式转换该字段，还是创建某种验证或其他不同的东西？我非常感谢强调基本原理的答案，*为什么*你会以这种或另一种方式做，因为这是我最坚持的。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-18T13:49:37.617

你想要的方法是`titleize`。该`capitalize`方法只处理整个字符串中的第一个字符，所以`"john doe".capitalize #=> "John doe"`, `"john doe".titleize #=> "John Doe"`.

至于如何实现它，你可以使用`before_save`，但我喜欢用伪属性做这些简单的单个属性准备。基本上，您`writer`为属性定义了一个方法，该方法将隐藏由`ActiveRecord`. 您仍然可以使用`write_attribute`方法 ( [docs](http://api.rubyonrails.org/classes/ActiveRecord/AttributeMethods/Write.html#method-i-write_attribute) ) 访问该属性。这样做可以确保在**分配属性后立即**正确设置该属性，这意味着即使在您保存它之前，您也可以确保您的对象处于有效状态：

```
class Contact < ActiveRecord::Base

  def name=(s)
    write_attribute(:name, s.to_s.titleize) # The to_s is in case you get nil/non-string
  end

end 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-01T22:13:23.930

@tserif 的更简洁的演绎如下：

```
def name=(s)
    super s.titleize
end 
```

这消除了对指定属性名称的依赖`write_attribute`和需要，`name`以支持更原始的方法。`to_s`除非您想要分配符号的能力，否则我认为不需要。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T13:40:37.823

我建议使用 before_save 。

就像你的模型一样：

```
before_save :capitalize_name

def capitalize_name
  self.name = self.name.split.collect(&:capitalize).join(' ') if self.name && !self.name.blank?
end 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-18T13:41:14.840

最重要的问题是您将如何显示名称？如果它像我猜的那样在网络上，我根本不会在模型中处理这个问题。最简单的解决方案是只使用 css`text-tansform: capitalize;`来处理大写，但如果您经常显示它，您可能需要定义一个装饰器或辅助方法来为您规范化它。

```
def full_name
  [first_name, last_name].map { |name| name[0].upcase + name[1..-1] }.join(' ')
end 
```

请注意，`capitalize`您只想将第一个字母大写，而不是映射。名为 RJ 或 CJ 的人可能希望 J 保持大写。

无论如何，数据都是规范的，看到大写的部分纯粹是显示。

# windows - 如何使用命令行 (CLI) 在 Windows 7 上更改文件和文件夹权限？

> ID：10210499
> 
> 赞同：5
> 
> 时间：2012-04-18T13:33:07.237
> 
> 标签：windows, file, command-line-interface, file-permissions, utility

我正在尝试在 Windows 命令行上使用 chmod 实用程序，但它不起作用。我正在寻找更改 Windows 上的文件和文件夹权限的命令。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-08T06:02:00.947

以下命令将有助于获取目录和文件的所有权：
D:\>takeown /f D:\path\to\directory /r /dy
D:\>icacls D:\path\to\directory /grant administrators :F /吨

# android - 数据库磁盘映像格式错误或文件已加密或不是数据库

> ID：10210503
> 
> 赞同：2
> 
> 时间：2012-04-18T13:33:19.453
> 
> 标签：android, sqlite

我需要将没有“Root”的手机中的数据库复制到pad。所以我也采用了和其他人一样的方法：首先将/data/data/../databases/test.db复制到/sdcard。然后我使用adb shell sqlite3 命令在我的电脑或朋友的电脑上，有一些问题：1）有时，它可以成功打开 2）有时，它显示“文件已加密或不是数据库” 3）有时，它显示“数据库磁盘映像格式错误”

注意：sqlite3 版本不同。

“文件被加密或不是数据库”的根本原因是版本问题，对吗？

“数据库磁盘映像格式错误”的根本原因是什么？我在互联网上搜索了一些关于它的信息，但我仍然无法修复它。

谢谢！

编辑1：测试手机是HTC HD 编辑2：我这个帖子：[http](http://groups.google.com/group/android-developers/browse_thread/thread/2b8a8fa9b955eecd/0615c6111d93ea02?lnk=raot) ://groups.google.com/group/android-developers/browse_thread/thread/2b8a8fa9b955eecd/0615c6111d93ea02?lnk=raot还有留言：我会很强烈建议您不要这样做。无法保证二进制数据库文件将在 Android 版本之间兼容，更不用说在所有自定义 ROM 之间兼容。

看来“数据库磁盘映像格式错误”的根本原因是Sqlite3版本。但是如何将数据库备份到 sdcard 是最好的方法呢？还有其他方法吗？

编辑 3：[链接 1](https://stackoverflow.com/questions/10342535/issue-file-is-encrypted-or-is-not-a-database-opening-a-sqlite-file-in-some-and) [链接 2](https://stackoverflow.com/questions/6444170/sqlite3-wal-databaseerror-file-is-encrypted-or-is-not-a-database) [链接 3](https://stackoverflow.com/questions/4718934/sqlite-issues-with-htc-desire-hd)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:05:08.707

我的直觉是认为数据库文件在传输过程中以某种方式损坏。根据我的经验，如果数据库文件损坏，它就完成了。

[您应该使用以下 pragma](http://www.sqlite.org/pragma.html#pragma_integrity_check)验证源和目标上的数据库文件都没有损坏：

```
PRAGMA integrity_check; 
```

如果一切正常，结果集是一个值为 的单列记录`ok`。

需要明确的是，对于以下三种情况中的任何一种，您的数据库都已损坏且无法使用：

*   sqlite3 甚至不会打开数据库文件并返回一些错误
*   sqlite3 会打开数据库文件，但是当你运行一些语句时会返回一些错误
*   sqlite3 将打开数据库文件，但`pragma integrity_check`不返回`ok`

由于您的源和目标似乎都在使用 sqlite 3.xyz，因此文件格式*应该不是*问题（有一些例外，但我怀疑它们中的任何一个都是您痛苦的根源）。

您可能想要做的另一件事是验证源文件和目标文件是否相同。您可以比较它们的哈希值（md5、sha1 或其他）。

# ruby-on-rails - Rails：在嵌套资源的第 3 级求和

> ID：10210504
> 
> 赞同：2
> 
> 时间：2012-04-18T13:33:21.617
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, nested, sum

在我的 rails 3.1 应用程序中，我有这些模型：

```
class Project < ActiveRecord::Base  
  has_many :tasks
  has_many :hours, :through => :tasks  

  def sum_hours
    self.hours.sum(:hours)
  end
end  

class Task < ActiveRecord::Base  
  belongs_to :project  
  has_many :hours 

  def sum_hours
    self.hours.sum(:hours)
  end 
end 

class Hour < ActiveRecord::Base  
  attr_accessible :hours     # column in table

  belongs_to :task  
end 
```

在 projects_controller.rb 中：

```
def show
  @project = Project.find(params[:id])
  @tasks = @project.tasks.includes(:hours)
end 
```

在 projects/show.html.erb 我使用这个：

```
...
<td>Sum hours: <%= @project.sum_hours %></td>
...
<% for task in @tasks do %>
<tr>
  <td><%= task.sum_hours %></td>
</tr>
... 
```

但即使使用*.includes(:hours)*它仍然对项目和每个任务单独使用查询。我错过了什么吗？我在哪里做错了？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T02:05:52.613

你可以试试这样的

```
@tasks = @project.tasks.joins(:hours).select("tasks.*, sum(hours) as total") 
```

然后您可以通过以下方式访问总和，

```
task["total"].to_i 
```

我无法确保这些代码适合您。但基本思想是加入表格并选择总和作为额外字段。

# php - 渠道方面的 Google Adsense 信息

> ID：10210505
> 
> 赞同：2
> 
> 时间：2012-04-18T13:33:24.363
> 
> 标签：php, adsense, adsense-api

我正在使用 adsense 管理 API 并按照那里的所有内容生成演示报告，如他们网站上的示例中所述。我目前正在获取的信息使用此信息：

```
 $startDate = '2012-03-01';
    $endDate = '2012-04-18';
    $optParams = array(
      'filter' => array(
        'AD_CLIENT_ID==' . $adClientId
      ),
      'metric' => array(                    
        'CLICKS', 'PAGE_VIEWS','COST_PER_CLICK','EARNINGS'                  
      ),
      'dimension' => array('DATE'),
      'sort' => 'DATE'
    ); 
```

我要问的是是否可以根据频道安排这些数据，以便我获得有关 EARNING、COST_PER_CLICK 和 PAGE_VIEWS 的频道信息。如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T14:36:31.473

假设您正在谈论自定义渠道，您所要做的就是将以下其中一项添加到您的维度列表中，具体取决于您喜欢的内容：

*   CUSTOM_CHANNEL_NAME
*   CUSTOM_CHANNEL_ID
*   CUSTOM_CHANNEL_CODE

您可以将维度视为组，即您组织数据的依据。

您可以查看[此博客文章](http://adsenseapi.blogspot.com/2011/11/adsense-management-api-diving-into.html)以获取更多信息。

# iphone - 在没有 iphone 的情况下创建 Iphone 应用程序？（使用 iphone 模拟器？）

> ID：10210506
> 
> 赞同：1
> 
> 时间：2012-04-18T13:33:27.503
> 
> 标签：iphone, c

我想知道在没有真正拥有 iphone 的情况下开始创建 iphone 应用程序是一个多么好的想法？

我发现有iphone的模拟器...

它们是否足够好，或者我在创建应用程序时可能会遇到一些问题？

-我还没有一个应用程序的想法。

-我没有真正的 iPhone。不过，我工作的办公室里有一些手机，但我不想过多地使用它们。

谢谢！如果您认为创建应用程序并在模拟器上测试它们是一个不错的主意，您会推荐哪些？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:41:44.607

馊主意。

你可以完成很多工作，但你真的，真的需要一个实际的设备来做你的最终测试。

请记住，它是一个*模拟器*，而不是一个*模拟器*。性能存在显着差异。很多东西在你的 Mac 上运行良好，但在真实设备上却很糟糕。可能令人惊讶的是，在许多情况下情况正好相反（即，在 iPhone 上更快）。一段时间后，您会更好地找出这些差异，但如果不使用真实设备，您将永远不会知道。

如果成本是主要因素，那么您实际上并不需要 iPhone；您可以改用 iPod touch。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:45:04.170

xCode 附带的 iPhone 模拟器适用于大多数应用程序的开发。根据我的经验，当您处理实时运行的内容（例如音频和图形）时，它会崩溃。计算机上的处理器显然更快，如果您只是在模拟器上进行测试，您可能不会意识到您试图实现的目标超出了设备的能力范围。

这可能会影响您的帧速率（因为您将在计算机上获得更高的帧速率）并且具有大量 DSP 的深度音频面临同样的问题。

如果您正在开发业务线应用程序，那么模拟器可能就是您所需要的。当然你需要在发布之前在设备上进行测试，但是大部分的 bug 测试和调试都可以在模拟环境中进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:36:55.070

xCode 本身有一个模拟器，为什么不呢？您只需要一台 Mac-PC

检查[http://developer.apple.com/library/ios/#documentation/Xcode/Conceptual/ios_development_workflow/25-Using_iOS_Simulator/ios_simulator_application.html#//apple_ref/doc/uid/TP40007959-CH9-SW1](http://developer.apple.com/library/ios/#documentation/Xcode/Conceptual/ios_development_workflow/25-Using_iOS_Simulator/ios_simulator_application.html#//apple_ref/doc/uid/TP40007959-CH9-SW1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T13:36:57.690

你有一台苹果电脑吗？

iOS SDK 有一个非常好的模拟器，您可以在其中试用您的应用程序，我认为如果可以在上面运行，它应该可以在真正的 iPhone 上运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T13:38:06.500

考虑到模拟器足够好，可以创建您的应用程序，但这完全取决于您使用什么。例如，如果您使用加速度计或蓝牙模拟器不适合您的情况。总的来说，在很多方面是非常有限的，但刚开始可以走得很好。要使用您所说的设备，您必须拥有开发人员提供的有效许可证并将设备与您的许可证相关联，否则您将无法使用它们（尽管不是越狱）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-18T13:40:46.370

iPhone模拟器不支持一切，这是由真实设备支持的。有些东西是不可能在模拟器上测试的，包括但不限于与以下相关的功能/API：日历、相机、陀螺仪、加速度计、音乐……

# android - Robotium 中的 WheelView

> ID：10210507
> 
> 赞同：0
> 
> 时间：2012-04-18T13:33:28.810
> 
> 标签：android, robotium

我下载了wheel view android项目。我想使用机器人测试那个轮子视图。它可以使用机器人进行测试。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T13:14:53.350

没有关于如何使用带轮视图的独奏的官方文档。您可以在测试期间使用机器人和程序化处理车轮视图来测试您的应用程序。

我还建议您在机器人[问题](http://code.google.com/p/robotium/issues/list)页面中提出这个问题

# c++ - Qt，从另一个子小部件获取子小部件内的数据

> ID：10210509
> 
> 赞同：0
> 
> 时间：2012-04-18T13:33:40.953
> 
> 标签：c++, qt, widget, parent

我在主窗口中创建了新的 cad 小部件：

```
glWidget = new MeshViewerWidget(this); 
```

然后是我的文本视图小部件：

```
tbl = new tableView( this ); 
```

在我的主窗口中，我可以得到我的网格：

```
glWidget->mesh(); 
```

我如何在我的 tableview.cc 中获得它？泰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:18:57.527

您可以使用 的[`findChildren`](http://doc.qt.nokia.com/4.7-snapshot/qobject.html#findChildren)功能`QObject`并获取可以转换为给定类型的小部件的所有子级的列表。例如

```
QList<QTableView*> allTableViews = glWidget->findChildren<QTableView *>();
// Iterate in order to find the table view either by checking the name, the parent etc.... 
```

另一种方法是 Simon 建议的方法，将公共访问功能子类化并添加到您希望从顶级小部件访问的成员。

# c - 从 char 数组中转换为short

> ID：10210510
> 
> 赞同：2
> 
> 时间：2012-04-18T13:33:42.327
> 
> 标签：c, casting

我在这里遇到了一个小问题。我有一个 unsigned char 数组，我正在尝试访问字节 2-3 (`0xFF`和`0xFF`) 并将它们的值作为一个短值。

代码：

```
 unsigned char Temp[512] = {0x00,0xFF,0xFF,0x00};
 short val = (short)*((unsigned char*)Temp+1) 
```

虽然我希望 val 包含`0xFFFF`它实际上包含`0x00FF`. 我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T13:40:33.003

`short`当数据未正确对齐时，无法保证您可以访问 a 。

在某些机器上，尤其是 RISC 机器上，您会因访问未对齐而出现总线错误和核心转储。在其他机器上，未对齐的访问将涉及到内核的陷阱以修复错误——这仅比核心转储快一点。

为了可靠地获得结果，您最好进行换档和或：

```
val = *(Temp+1) << 8 | *(Temp+2); 
```

或者：

```
val = *(Temp+2) << 8 | *(Temp+1); 
```

请注意，这明确提供了数据的大端（第一个选项）或小端（第二个）解释。

还要注意谨慎使用`<<`and `|`; 如果使用`+`代替`|`，则必须将移位表达式括起来或使用乘法代替移位：

```
val = (*(Temp+1) << 8) + *(Temp+2);
val = *(Temp+1) * 256 + *(Temp+2); 
```

合乎逻辑，使用逻辑或算术，而不是混合使用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-18T13:37:06.217

好吧，`unsigned char*`当您应该取消引用 a 时，您正在取消引用`short*`

我认为这应该有效：

```
 short val = *((short*)(Temp+1)) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T13:37:26.407

您的问题是您只访问数组的一个字节：

*   `*((unsigned char*)Temp+1)``Temp+1`将取消引用给你的指针`0xFF`
*   `(short)*((unsigned char*)Temp+1)`将取消引用的结果转换为`short`. 转换`unsigned char` `0xFF`为空显然会给你`0x00FF`

所以你想做的是`*((short*)(Temp+1))`

然而，应该注意的是，你正在做的是一个可怕的黑客攻击。首先，当您有不同`chars`的结果时，结果显然取决于机器的字节序。

其次，不能保证访问的数据正确对齐以作为短路访问。

因此，根据架构的字节序做类似`short val= *(Temp+1)<<8 | *(Temp+2)`或`short val= *(Temp+2)<<8 | *(Temp+1)`依赖于字节序的事情可能是一个更好的主意

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T13:43:00.050

我不推荐这种方法，因为它是特定于架构的。

考虑以下定义`Temp`：

```
unsigned char Temp[512] = {0x00,0xFF,0x88,0x00}; 
```

根据系统的字节顺序，您将得到不同的结果转换`Temp + 1`为 a `short *`; 在小端系统上，结果将是值`0x88FF`，但在大端系统上，结果将是`0xFF88`。

另外，我认为这是一个未定义的演员阵容，因为对齐问题。

你可以使用的是：

```
short val = (((short)Temp[1]) << 8) | Temp[2]; 
```

# ms-access - 在 Access 中使用查询转置表

> ID：10210512
> 
> 赞同：0
> 
> 时间：2012-04-18T13:33:50.277
> 
> 标签：ms-access, ms-access-2007

我有 table1，我想将它转置为 table1_1 所示，谁能告诉我可以用来执行此操作的查询/函数

表格1

```
FileName    ObjectName  Column1 Column2 Column3 Column4 Column5

F1           Line1         A       B       C      D       E
F1           Line2         F       G       H      I       J
F1           Line3         K       L       M      N       O

table1_1

FileName    ObjectName       Column    Data
F1            Line1          Column1    A
F1            Line1          Column2    B
F1            Line1          Column3    C
F1            Line1          Column4    D
F1            Line1          Column5    E
F1            Line2          Column1    F
F1            Line2          Column2    G
F1            Line2          Column3    H
F1            Line2          Column4    I
F1            Line2          Column5    J
F1            Line3          Column1    K
F1            Line3          Column2    L
F1            Line3          Column3    M
F1            Line3          Column4    N
F1            Line3          Column5    O 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:35:32.070

查看与 Min、Max 和 Last 一起使用的[交叉表查询。](http://support.microsoft.com/kb/304348)

转置：

```
TRANSFORM First(Table1_1.Data) AS FirstOfData
SELECT Table1_1.FileName, Table1_1.ObjectName
FROM Table1_1
GROUP BY Table1_1.FileName, Table1_1.ObjectName
PIVOT Table1_1.Column; 
```

标准化：

```
SELECT FileName, ObjectName, "Column1" As ColName, Column1 As ColData  
FROM Table1 
UNION ALL
SELECT FileName, ObjectName, "Column2" As ColName, Column2 As ColData  
FROM Table1 
UNION ALL
SELECT FileName, ObjectName, "Column3" As ColName, Column3 As ColData  
FROM Table1 
UNION ALL
SELECT FileName, ObjectName, "Column4" As ColName, Column4 As ColData  
FROM Table1 
UNION ALL
SELECT FileName, ObjectName, "Column5" As ColName, Column5 As ColData  
FROM Table1 
```

# objective-c - 在同一应用中同时使用 Facebook API 和 Google Places API 的 JSON 库问题

> ID：10210514
> 
> 赞同：1
> 
> 时间：2012-04-18T13:33:52.163
> 
> 标签：objective-c, ios, json, facebook-graph-api, google-places-api

我在同一个应用程序中同时使用 Facebook API 和 Google Places API 时遇到 JSON 库问题。我已经独立尝试过它们并且它们工作正常。问题是我现在有 2 组一些 JSON 文件（同时使用 Google 和 FB API 时）。

我试过删除一组，但这只会带来更多错误。

Facebook API 中的 SBJSON.h 与 Google Places API 中的 SBJson.h 不同。我不确定如何解决这个问题。任何帮助都会很棒。

![在此处输入图像描述](../Images/a0bde0f7bdb7c1b2f6976b2f5d0fc06a.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:42:21.050

两种解决方案：

*   A. 2 个 sbJson 库之一的自定义前缀并相应地调整 SDK（我不推荐这样做，因为它需要大量工作）
*   B. 使用 2 个库之一并修复 FB 或 Google SDK 中的错误

差异通常很小，一些改变就可以解决问题......

# c - 将虚拟地址映射回物理地址

> ID：10210515
> 
> 赞同：2
> 
> 时间：2012-04-18T13:33:55.057
> 
> 标签：c, linux, virtual-memory, beagleboard, texas-instruments

*免责声明：*我有点在[德州仪器论坛](http://e2e.ti.com/support/dsp/davinci_digital_media_processors/f/537/t/182419.aspx#657760)上交叉发布这个问题，但我已经五天没有得到任何回复。我对嵌入式编程很陌生，所以请指出您是否需要更多信息或者我的方法是否荒谬。

**动机**

[我有一个带有德州仪器 ( Texas Instruments) 的 DM3730 处理器](http://www.ti.com/product/dm3730)的嵌入式设备（与 Beagleboard -xm 上的处理器相同）该处理器通过其显示子系统 (DSS) 连接到 LCD 显示器。显示屏看起来很暗，必须进行伽马校正。幸运的是，DSS 有一个 Palette/gamma 查找表。不幸的是，我无法让它工作。

**我发现了什么**

我在德州仪器论坛上发现了类似处理器的[类似问题，TI 员工给出了以下解释（强调我的）：](http://e2e.ti.com/support/dsp/omap_applications_processors/f/447/t/59105.aspx)

> 我认为当前的 Linux 内核不支持彩色索引图形，但是通过直接寄存器配置从应用程序级别启用它相当容易。
> 
> [...]
> 
> 接下来，声明一个由 256 个无符号整数组成的数组，并为每个颜色索引条目填充所需的 RGB 值。
> 
> 将 DISPC_GFX_TABLE_BA 设置为先前配置的数组的物理地址（注意 1，**这需要物理地址而不是虚拟地址，因此您可能需要将其映射回来**。注意 2，这需要是 32 位对齐的地址，因此取决于数组是如何创建的，可能需要创建一个稍大的 char 数组并填充数组，以使起点位于 32 位边界上）
> 
> [...]

他后来提到[mem_util](https://gstreamer.ti.com/gf/project/am_sysinfo/scmsvn/?action=browse&path=%2Ftrunk%2Fmem_util%2Fmem_util.c&revision=2&sortby=log&view=markup)来转换地址，我能够使用它直接从应用程序级别（用户空间）写入寄存器，但我无法弄清楚如何将虚拟地址“映射回”物理地址。

**系统信息**

```
~# uname -a
Linux dm37x-evm 2.6.32.1 #1 Fri Dec 2 11:19:53 EST 2011 armv7l unknown 
```

**我的问题**

*   如何将虚拟地址映射回物理地址？
*   这可以在用户空间中完成吗？（我设想我提供一个用户可以调整伽玛曲线的界面）
*   一般来说，这是正确的方法吗？我应该把它移到内核空间吗（我不愿意这样做，因为我对 Linux 内核没有很多经验）
*   任何好的资源或例子！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:43:47.557

有一个[CMEM](http://processors.wiki.ti.com/index.php/CMEM_Overview)驱动程序，用于将物理内存映射到用户空间内存。它也可以进行虚拟到物理的转换。

因此，使用此驱动程序，您可以：

1.  分配对齐的缓冲区
2.  获取用户空间地址
3.  从您的程序中填充缓冲区
4.  获取缓冲区的物理地址

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:54:00.303

您的问题的一个非常具体的答案是使用 CMEM，其目的是从启动时保留内存中分配连续的内存块。

在下面的示例代码中，我通过编解码器引擎使用 cmem。ptr 是您在应用程序中用来访问缓冲区的内容，而 physptr 是您在寄存器中写入的内容。

```
 ptr = Memory_contigAlloc(len, Memory_DEFAULTALIGNMENT);
    if(ptr == NULL) {
        debug_printf("Buffer allocation failed : buf size = %d\n", len);
        return -1;
    }
    physptr = (void *)Memory_getBufferPhysicalAddress(ptr, len, 0); 
```

“正确”的方法实际上是不使用 memutil 并在内核中完成整个事情。

# java - Bully 算法的可疑代码输出

> ID：10210516
> 
> 赞同：2
> 
> 时间：2012-04-18T13:33:56.477
> 
> 标签：java

我正在为 Java 中的 Bully 算法编写程序
代码如下：

```
package newbully;

public class NewBully {

    public static void main(String[] args) {
        int total_processes = 6;
        RunningThread[] t = new RunningThread[total_processes];
        for (int i = 0; i < total_processes; i++) {
            t[i] = new RunningThread(new Process(i+1, i+1), total_processes);//passing process id, priority, total no. of processes to running thread
        }
        try {
            Election.initialElection(t);
        } catch (Exception e) {
            System.out.println("Possibly you are using null references in array");
        }
        for (int i = 0; i < total_processes; i++) {
            new Thread(t[i]).start();//start every thread
        }
    }
}

package newbully;

import java.util.*;
import java.io.*;
import java.net.*;

public class RunningThread implements Runnable {

    private Process process;
    private int total_processes;
    ServerSocket[] sock;
    Random r;

    public Process getProcess() {
        return process;
    }

    public void setProcess(Process process) {
        this.process = process;
    }

    public RunningThread(Process process, int total_processes) {
        this.process = process;
        this.total_processes = total_processes;
        this.r = new Random();
        this.sock = new ServerSocket[total_processes];
    }

    synchronized private void recovery() {
        System.out.println("Process[" + this.process.getPid() + "]: -> Recovered from Crash");
        //Find current co-ordinator.
    }

    synchronized private void pingCoOrdinator() {
        try {
            if (Election.isPingFlag()) {
                synchronized (Election.lock) {
                    Election.lock.wait();
                }
            }
            if (!Election.isElectionFlag()) {
                Election.setPingFlag(true);
                System.out.println("Process[" + this.process.getPid() + "]: Are you alive?");
                Socket outgoing = new Socket(InetAddress.getLocalHost(), 12345);
                outgoing.close();
                Election.setPingFlag(false);
                synchronized (Election.lock) {
                    Election.lock.notifyAll();
                }
            }
        } catch (Exception ex) {
            //Initiate Election
            System.out.println("process[" + this.process.getPid() + "]: -> Co-Ordinator is down\nInitiating Election");
            Election.setElectionFlag(true);
            Election.setPingFlag(false);
            synchronized (Election.lock) {
                Election.lock.notifyAll();
            }
        }
    }

    synchronized private void executeJob() {
        int temp = r.nextInt(20);
        for (int i = 0; i <= temp; i++) {
            try {
                Thread.sleep(700);
            } catch (InterruptedException e) {
                System.out.println("Error Executing Thread:" + process.getPid());
                System.out.println(e.getMessage());
            }
        }
    }

    synchronized private boolean sendMessage() {
        boolean response = false;
        int i = 0;
        try {
            if (Election.isMessageFlag()) {
                synchronized (Election.lock) {
                    Election.lock.wait();
                }
            }
            Election.setMessageFlag(true);
            if (Election.isElectionFlag()) {
                for (i = this.process.getPid() + 1; i <= this.total_processes; i++) {
                    try {
                        Socket electionMessage = new Socket(InetAddress.getLocalHost(), 10000 + i);
                        System.out.println("Process[" + this.process.getPid() + "] -> Process[" + i + "]  responded to election message successfully");
                        electionMessage.close();
                        response = true;
                    } catch (Exception ex) {
                        System.out.println("Process[" + this.process.getPid() + "] -> Process[" + i + "] did not respond to election message");
                    }
                }
            }
            Election.setMessageFlag(false);
            synchronized (Election.lock) {
                Election.lock.notifyAll();
            }
        } catch (Exception ex1) {
            System.out.println(ex1.getMessage());
        }

        return response;
    }

    synchronized private void serve() {
        try {
            //service counter
            Socket incoming = null;
            ServerSocket s = new ServerSocket(12345);
            for (int counter = 0; counter < 10; counter++) {
                incoming = s.accept();
                System.out.println("Process[" + this.process.getPid() + "]:Yes");
                Scanner scan = new Scanner(incoming.getInputStream());
                PrintWriter out = new PrintWriter(incoming.getOutputStream(), true);
                if (scan.hasNextLine()) {
                    if (scan.nextLine().equals("Who is the co-ordinator?")) {
                        System.out.print("Process[" + this.process.getPid() + "]:");
                        out.println(this.process);
                    }
                }
            }
            //after serving 10 requests go down for random time
            this.process.setCoOrdinatorFlag(false);
            this.process.setDownflag(true);
            try {
                incoming.close();
                s.close();
                sock[this.process.getPid() - 1].close();
                Thread.sleep((this.r.nextInt(10) + 1) * 1000000);//going down
                recovery();
            } catch (InterruptedException e) {
                System.out.println(e.getMessage());
            }

        } catch (IOException ex) {
            System.out.println(ex.getMessage());
        }
    }

    @Override
    public void run() {
        try {
            sock[this.process.getPid() - 1] = new ServerSocket(10000 + this.process.getPid());
        } catch (IOException ex) {
            System.out.println(ex.getMessage());
        }
        while (true) {
            if (process.isCoOrdinatorFlag()) {
                //serve other processes
                serve();
            } else {
                while (true) {
                    //Execute some task
                    executeJob();

                    //Ping the co-ordinator
                    pingCoOrdinator();

                    if (Election.isElectionFlag()) {
                        if (!sendMessage()) {//elect self as co-ordinator
                            System.out.println("New Co-Ordinator: Process[" + this.process.getPid() + "]");
                            this.process.setCoOrdinatorFlag(true);
                            Election.setElectionFlag(false);
                            break;
                        }
                    }
                }
            }
        }
    }
}

package newbully;

public class Election {

    private static boolean pingFlag = false;
    private static boolean electionFlag = false;
    private static boolean messageFlag = false;
    public static final Object lock = new Object(); 

    public static boolean isMessageFlag() {
        return messageFlag;
    }

    public static void setMessageFlag(boolean messageFlag) {
        Election.messageFlag = messageFlag;
    }

    public static boolean isPingFlag() {
        return pingFlag;
    }

    public static void setPingFlag(boolean pingFlag) {
        Election.pingFlag = pingFlag;
    }

    public static boolean isElectionFlag() {
        return electionFlag;
    }

    public static void setElectionFlag(boolean electionFlag) {
        Election.electionFlag = electionFlag;
    }

    public static void initialElection(RunningThread[] t) {
        Process temp = new Process(-1, -1);
        for (int i = 0; i < t.length; i++) {
            if (temp.getPriority() < t[i].getProcess().getPriority()) {
                temp = t[i].getProcess();
            }
        }
        t[temp.pid - 1].getProcess().CoOrdinatorFlag = true;
    }
}

package newbully;

public class Process {

    int pid;
    boolean downflag,CoOrdinatorFlag;

    public boolean isCoOrdinatorFlag() {
        return CoOrdinatorFlag;
    }

    public void setCoOrdinatorFlag(boolean isCoOrdinator) {
        this.CoOrdinatorFlag = isCoOrdinator;
    }
    int priority;

    public boolean isDownflag() {
        return downflag;
    }

    public void setDownflag(boolean downflag) {
        this.downflag = downflag;
    }

    public int getPid() {
        return pid;
    }

    public void setPid(int pid) {
        this.pid = pid;
    }

    public int getPriority() {
        return priority;
    }

    public void setPriority(int priority) {
        this.priority = priority;
    }

    public Process() {
    }

    public Process(int pid, int priority) {
        this.pid = pid;
        this.downflag = false;
        this.priority = priority;
        this.CoOrdinatorFlag = false;
    }
} 
```

这是输出：

```
//--When delay in executeJob() method is 100

Process[4]: Are you alive?
Process[6]:Yes
Process[4]: Are you alive?
Process[6]:Yes
Process[3]: Are you alive?
Process[6]:Yes
Process[5]: Are you alive?
Process[6]:Yes
Process[1]: Are you alive?
Process[6]:Yes
Process[4]: Are you alive?
Process[6]:Yes
Process[3]: Are you alive?
Process[6]:Yes
Process[3]: Are you alive?
Process[6]:Yes
Process[2]: Are you alive?
Process[6]:Yes
Process[5]: Are you alive?
Process[6]:Yes
Process[1]: Are you alive?
process[1]: -> Co-Ordinator is down
Initiating Election
Process[1] -> Process[2]  responded to election message successfully
Process[1] -> Process[3]  responded to election message successfully
Process[1] -> Process[4]  responded to election message successfully
Process[1] -> Process[5]  responded to election message successfully
Process[1] -> Process[6] did not respond to election message
Process[2] -> Process[3]  responded to election message successfully
Process[3] -> Process[4]  responded to election message successfully
Process[4] -> Process[5]  responded to election message successfully
Process[2] -> Process[4]  responded to election message successfully
Process[2] -> Process[5]  responded to election message successfully
Process[3] -> Process[5]  responded to election message successfully
Process[5] -> Process[6] did not respond to election message
New Co-Ordinator: Process[5]
New Co-Ordinator: Process[1]
Address already in use: JVM_Bind
Address already in use: JVM_Bind
Address already in use: JVM_Bind

 //--When delay in executeJob() method is 700
Process[3]: Are you alive?
Process[6]:Yes
Process[5]: Are you alive?
Process[6]:Yes
Process[2]: Are you alive?
Process[1]: Are you alive?
Process[6]:Yes
Process[6]:Yes
Process[5]: Are you alive?
Process[1]: Are you alive?
Process[6]:Yes
Process[6]:Yes
Process[4]: Are you alive?
Process[6]:Yes
Process[3]: Are you alive?
Process[6]:Yes
Process[2]: Are you alive?
Process[6]:Yes
Process[1]: Are you alive?
Process[6]:Yes
Process[4]: Are you alive?
process[4]: -> Co-Ordinator is down
Initiating Election
Process[4] -> Process[5]  responded to election message successfully
Process[4] -> Process[6] did not respond to election message
Process[5] -> Process[6] did not respond to election message
New Co-Ordinator: Process[5]
Process[1]: Are you alive?
Process[5]:Yes
Process[1]: Are you alive?
Process[5]:Yes
Process[3]: Are you alive?
Process[5]:Yes
Process[2]: Are you alive?
Process[5]:Yes
Process[1]: Are you alive?
Process[5]:Yes
Process[4]: Are you alive?
Process[5]:Yes
Process[2]: Are you alive?
Process[5]:Yes
Process[4]: Are you alive?
Process[5]:Yes
Process[3]: Are you alive?
Process[5]:Yes
Process[3]: Are you alive?
Process[5]:Yes
Process[2]: Are you alive?
process[2]: -> Co-Ordinator is down
Initiating Election
Process[2] -> Process[3]  responded to election message successfully
Process[2] -> Process[4]  responded to election message successfully
Process[2] -> Process[5] did not respond to election message
Process[2] -> Process[6] did not respond to election message
Process[3] -> Process[4]  responded to election message successfully
Process[3] -> Process[5] did not respond to election message
Process[3] -> Process[6] did not respond to election message
Process[1] -> Process[2]  responded to election message successfully
Process[1] -> Process[3]  responded to election message successfully
Process[1] -> Process[4]  responded to election message successfully
Process[1] -> Process[5] did not respond to election message
Process[1] -> Process[6] did not respond to election message
Process[2] -> Process[3]  responded to election message successfully
Process[2] -> Process[4]  responded to election message successfully
Process[2] -> Process[5] did not respond to election message
Process[2] -> Process[6] did not respond to election message
Process[4] -> Process[5] did not respond to election message
Process[4] -> Process[6] did not respond to election message
New Co-Ordinator: Process[4]
Process[3]: Are you alive?
Process[4]:Yes
Process[3]: Are you alive?
Process[4]:Yes
Process[1]: Are you alive?
Process[4]:Yes
Process[2]: Are you alive?
Process[4]:Yes
Process[1]: Are you alive?
Process[4]:Yes
Process[2]: Are you alive?
Process[4]:Yes
Process[2]: Are you alive?
Process[4]:Yes
Process[2]: Are you alive?
Process[4]:Yes
Process[3]: Are you alive?
Process[4]:Yes
Process[1]: Are you alive?
Process[4]:Yes
Process[3]: Are you alive?
process[3]: -> Co-Ordinator is down
Initiating Election
Process[3] -> Process[4] did not respond to election message
Process[3] -> Process[5] did not respond to election message
Process[3] -> Process[6] did not respond to election message
New Co-Ordinator: Process[3]
New Co-Ordinator: Process[2]
Address already in use: JVM_Bind
Address already in use: JVM_Bind
Address already in use: JVM_Bind
Address already in use: JVM_Bind
Address already in use: JVM_Bind 
```

最后我开始得到例外`Address already in use: JVM_Bin`。
另外，如果我们在thow例外前与OUPUT的最新选举协调员联系，它选择了两次，然后问`is co-ordinator alive?`
我确定协调员死亡时，我已经提供了足够的延迟，以免它介于两者之间。
当我给予额外的交易时，程序会继续进行，否则它会在中间停止。
那么为什么一定会出现这个问题呢？

我找到了异常的原因
它正在发生，因为如果你在异常消息之前仔细查看输出，它已经选择了协调器 2ce。
每当一个线程被选为协调者时，它都会在端口 12345 上打开一个 ServerSocket。
由于它发生在 2ce，它可能会引发异常。
但我不明白......为什么它选择了2ce？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T14:35:56.427

您在这两种情况下的错误消息都是“地址已在使用中：JVM_Bind”。

此消息通常是 java.net.BindException 的一部分，当您尝试创建/打开 Socket 并且端口已在使用中时会抛出该异常。在这种情况下，您可能会尝试两次打开或创建相同的套接字。

这可能会发生，因为在打开和关闭套接字之间，异常会停止调用 socket.close()。在这种情况下，当您创建一个到选举领导者的套接字时，但是由于主机“崩溃”了一个异常被抛出，因此 close() 永远不会被调用。

我认为您需要添加该行

选举消息.close(); 到这部分发送消息的 catch 子句。

```
try {
    Socket electionMessage = new Socket(InetAddress.getLocalHost(), 10000 + i);
    System.out.println("Process[" + this.process.getPid() + "] -> Process[" + i + "]  responded to election message successfully");
    electionMessage.close();
    response = true;
} catch (Exception ex) {
//Add close here
    System.out.println("Process[" + this.process.getPid() + "] -> Process[" + i + "] did not respond to election message");
} 
```

另外，我建议将 close 添加到所有其他相关的 catch 子句中，以防在其他地方发生这种情况，并且始终是避免相关问题的好习惯。我还建议在每个地方明确指定要捕获的异常，以免被其他陷阱抓住。

我希望这是一个好的起点。

* * *

## 编辑以回应第一条评论

我认为您“锁定”线程的方式存在问题。您依靠布尔标志来告诉您已到达代码中的特定点。但是布尔标志本身不受同步块的控制，也不受代码上的任何其他锁的控制。因此，多个线程可以传递锁并导致意外事件，例如多次尝试打开同一个套接字。

您正在使用带有对象的代码来锁定

```
if (Election.isMessageFlag()) {
    synchronized (Election.lock) {
        Election.lock.wait();
    }
}
Election.setMessageFlag(true);
if (Election.isElectionFlag()) {
   // Do Stuff
   // Open/close Sockets etc
}
Election.setMessageFlag(false);
synchronized (Election.lock) {
    Election.lock.notifyAll();
} 
```

也就是说，在设置标志之前（在下一行！），多个线程可能会通过第一个 if 语句以使后续线程等待。

但是，如果您改用 ReentrantLock，则应使用如下代码：

```
lock.lock();  // block until condition holds
try {
  // Do Stuff
  // OPen CLose Sockets etc
} finally {
  lock.unlock()
} 
```

显然，您可能仍需要设置一些标志来说明选举是否正在进行，但请确保使用真正的锁（例如 ReentrantLock）或在适当的同步块中保护正在运行的代码。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T09:26:21.550

在参考了上述所有评论后，我发布了正确的代码，以便其他人可以参考。
欢迎对代码提出任何改进建议...

```
package newbully;

public class NewBully {

    public static void main(String[] args) {
        int total_processes = 6;
        RunningThread[] t = new RunningThread[total_processes];
        for (int i = 0; i < total_processes; i++) {
            t[i] = new RunningThread(new Process(i+1, i+1), total_processes);//passing process id, priority, total no. of processes to running thread
        }
        try {
            Election.initialElection(t);
        } catch (NullPointerException e) {
            System.out.println(e.getMessage());
        }
        for (int i = 0; i < total_processes; i++) {
            new Thread(t[i]).start();//start every thread
        }
    }
}

package newbully;

import java.util.concurrent.locks.ReentrantLock;

public class Election {

    public static ReentrantLock pingLock = new ReentrantLock();
    public static ReentrantLock electionLock = new ReentrantLock();
    private static boolean electionFlag = false; //By default no election is going on
    private static boolean pingFlag = true; //By default I am allowed to ping 
    public static Process electionDetector;

    public static Process getElectionDetector() {
        return electionDetector;
    }

    public static void setElectionDetector(Process electionDetector) {
        Election.electionDetector = electionDetector;
    }

    public static boolean isPingFlag() {
        return pingFlag;
    }

    public static void setPingFlag(boolean pingFlag) {
        Election.pingFlag = pingFlag;
    }

    public static boolean isElectionFlag() {
        return electionFlag;
    }

    public static void setElectionFlag(boolean electionFlag) {
        Election.electionFlag = electionFlag;
    }

    public static void initialElection(RunningThread[] t) {
        Process temp = new Process(-1, -1);
        for (int i = 0; i < t.length; i++) {
            if (temp.getPriority() < t[i].getProcess().getPriority()) {
                temp = t[i].getProcess();
            }
        }
        t[temp.pid - 1].getProcess().CoOrdinatorFlag = true;
    }
}

package newbully;

import java.util.*;
import java.io.*;
import java.net.*;

public class RunningThread implements Runnable {

    private Process process;
    private int total_processes;
    private static boolean messageFlag[];
    ServerSocket[] sock;
    Random r;

    public Process getProcess() {
        return process;
    }

    public void setProcess(Process process) {
        this.process = process;
    }

    public RunningThread(Process process, int total_processes) {
        this.process = process;
        this.total_processes = total_processes;
        this.r = new Random();
        this.sock = new ServerSocket[total_processes];
        RunningThread.messageFlag = new boolean[total_processes];
        for (int i = 0; i < total_processes; i++) {
            RunningThread.messageFlag[i] = false;
        }
    }

    synchronized private void recovery() {
        while (Election.isElectionFlag());//if election is going on then wait
        System.out.println("Process[" + this.process.getPid() + "]: -> Recovered from Crash");
        //Find current co-ordinator.         
        try {
            Election.pingLock.lock();
            Election.setPingFlag(false);
            Socket outgoing = new Socket(InetAddress.getLocalHost(), 12345);
            Scanner scan = new Scanner(outgoing.getInputStream());
            PrintWriter out = new PrintWriter(outgoing.getOutputStream(), true);
            System.out.println("Process[" + this.process.getPid() + "]:-> Who is the co-ordinator?");
            out.println("Who is the co-ordinator?");
            out.flush();
            String pid = scan.nextLine();
            String priority = scan.nextLine();
            if (this.process.getPriority() > Integer.parseInt(priority)) { //Bully Condition
                out.println("Resign");
                out.flush();
                System.out.println("Process[" + this.process.getPid() + "]: Resign -> Process[" + pid + "]");
                String resignStatus = scan.nextLine();
                if (resignStatus.equals("Successfully Resigned")) {
                    this.process.setCoOrdinatorFlag(true);
                    sock[this.process.getPid() - 1] = new ServerSocket(10000 + this.process.getPid());
                    System.out.println("Process[" + this.process.getPid() + "]: -> Bullyed current co-ordinator Process[" + pid + "]");
                }
            } else {
                out.println("Don't Resign");
                out.flush();
            }
            Election.pingLock.unlock();
            return;

        } catch (IOException ex) {
            System.out.println(ex.getMessage());
        }

    }

    synchronized private void pingCoOrdinator() {
        try {
            Election.pingLock.lock();
            if (Election.isPingFlag()) {
                System.out.println("Process[" + this.process.getPid() + "]: Are you alive?");
                Socket outgoing = new Socket(InetAddress.getLocalHost(), 12345);
                outgoing.close();
            }
        } catch (Exception ex) {
            Election.setPingFlag(false);
            Election.setElectionFlag(true);
            Election.setElectionDetector(this.process);
            //Initiate Election
            System.out.println("process[" + this.process.getPid() + "]: -> Co-Ordinator is down\n" + "process[" + this.process.getPid() + "]: ->Initiating Election");
        } finally {
            Election.pingLock.unlock();
        }
    }

    private void executeJob() {
        int temp = r.nextInt(20);
        for (int i = 0; i <= temp; i++) {
            try {
                Thread.sleep((temp + 1) * 100);
            } catch (InterruptedException e) {
                System.out.println("Error Executing Thread:" + process.getPid());
                System.out.println(e.getMessage());
            }
        }
    }

    synchronized private boolean sendMessage() {
        boolean response = false;
        try {
            Election.electionLock.lock();
            if (Election.isElectionFlag() && !RunningThread.isMessageFlag(this.process.getPid() - 1) && this.process.priority >= Election.getElectionDetector().getPriority()) {

                for (int i = this.process.getPid() + 1; i <= this.total_processes; i++) {
                    try {
                        Socket electionMessage = new Socket(InetAddress.getLocalHost(), 10000 + i);
                        System.out.println("Process[" + this.process.getPid() + "] -> Process[" + i + "]  responded to election message successfully");
                        electionMessage.close();
                        response = true;
                    } catch (IOException ex) {
                        System.out.println("Process[" + this.process.getPid() + "] -> Process[" + i + "] did not respond to election message");
                    } catch (Exception ex) {
                        System.out.println(ex.getMessage());
                    }
                }
                this.setMessageFlag(true, this.process.getPid() - 1);//My message sending is done
                Election.electionLock.unlock();
                return response;
            } else {
                throw new Exception();
            }
        } catch (Exception ex1) {
            Election.electionLock.unlock();
            return true;
        }
    }

    public static boolean isMessageFlag(int index) {
        return RunningThread.messageFlag[index];
    }

    public static void setMessageFlag(boolean messageFlag, int index) {
        RunningThread.messageFlag[index] = messageFlag;
    }

    synchronized private void serve() {
        try {
            boolean done = false;
            Socket incoming = null;
            ServerSocket s = new ServerSocket(12345);
            Election.setPingFlag(true);
            int temp = this.r.nextInt(5) + 5;// min 5 requests and max 10 requests
            for (int counter = 0; counter < temp; counter++) {
                incoming = s.accept();
                if (Election.isPingFlag()) {
                    System.out.println("Process[" + this.process.getPid() + "]:Yes");
                }
                Scanner scan = new Scanner(incoming.getInputStream());
                PrintWriter out = new PrintWriter(incoming.getOutputStream(), true);
                while (scan.hasNextLine() && !done) {
                    String line = scan.nextLine();
                    if (line.equals("Who is the co-ordinator?")) {
                        System.out.println("Process[" + this.process.getPid() + "]:-> " + this.process.getPid());
                        out.println(this.process.getPid());
                        out.flush();
                        out.println(this.process.getPriority());
                        out.flush();
                    } else if (line.equals("Resign")) {
                        this.process.setCoOrdinatorFlag(false);
                        out.println("Successfully Resigned");
                        out.flush();
                        incoming.close();
                        s.close();
                        System.out.println("Process[" + this.process.getPid() + "]:-> Successfully Resigned");
                        return;
                    } else if (line.equals("Don't Resign")) {
                        done = true;
                    }
                }
            }
            //after serving 5-10 requests go down for random time
            this.process.setCoOrdinatorFlag(false);
            this.process.setDownflag(true);
            try {
                incoming.close();
                s.close();
                sock[this.process.getPid() - 1].close();
                Thread.sleep(15000);//(this.r.nextInt(10) + 1) * 10000);//going down
                recovery();
            } catch (Exception e) {
                System.out.println(e.getMessage());
            }

        } catch (IOException ex) {
            System.out.println(ex.getMessage());
        }
    }

    @Override
    public void run() {
        try {
            sock[this.process.getPid() - 1] = new ServerSocket(10000 + this.process.getPid());
        } catch (IOException ex) {
            System.out.println(ex.getMessage());
        }
        while (true) {
            if (process.isCoOrdinatorFlag()) {
                //serve other processes
                serve();
            } else {
                while (true) {
                    //Execute some task
                    executeJob();
                    //Ping the co-ordinator
                    pingCoOrdinator();
                    //Do Election
                    if (Election.isElectionFlag()) {
                        if (!sendMessage()) {//elect self as co-ordinator
                            Election.setElectionFlag(false);//Election is Done
                            System.out.println("New Co-Ordinator: Process[" + this.process.getPid() + "]");
                            this.process.setCoOrdinatorFlag(true);
                            for (int i = 0; i < total_processes; i++) {
                                RunningThread.setMessageFlag(false, i);
                            }
                            break;
                        }
                    }
                }
            }
        }
    }
}

package newbully;

public class Process {

    int pid;
    boolean downflag,CoOrdinatorFlag;

    public boolean isCoOrdinatorFlag() {
        return CoOrdinatorFlag;
    }

    public void setCoOrdinatorFlag(boolean isCoOrdinator) {
        this.CoOrdinatorFlag = isCoOrdinator;
    }
    int priority;

    public boolean isDownflag() {
        return downflag;
    }

    public void setDownflag(boolean downflag) {
        this.downflag = downflag;
    }

    public int getPid() {
        return pid;
    }

    public void setPid(int pid) {
        this.pid = pid;
    }

    public int getPriority() {
        return priority;
    }

    public void setPriority(int priority) {
        this.priority = priority;
    }

    public Process() {
    }

    public Process(int pid, int priority) {
        this.pid = pid;
        this.downflag = false;
        this.priority = priority;
        this.CoOrdinatorFlag = false;
    }
} 
```

# postgresql - Postgresql：按真 OR 子句的数量计算排名

> ID：10210517
> 
> 赞同：4
> 
> 时间：2012-04-18T13:34:02.827
> 
> 标签：postgresql, stored-procedures, plpgsql, ranking, postgresql-9.1

我需要按正确的 OR 子句的数量对 PostgreSQL 查询的结果进行排序/排名。例如，给定一个查询，如

```
SELECT * FROM mytable WHERE cond1 OR cond2 OR cond3 ORDER BY rank DESC 
```

应根据满足条件的数量对结果进行排名。也非常欢迎使用视图/存储过程解决此问题的方法！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T14:01:59.810

重复条件并添加它们：

```
SELECT * FROM mytable 
WHERE fld = 'A' OR fldB = CURRENT_DATE OR fldC = 7
ORDER BY
   (fld = 'A')::int + (fldB = CURRENT_DATE)::int + (fldC = 7)::int  
DESC 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T14:27:59.983

可能是这样的：

```
select *
from (
    SELECT * , case when cond1 then 1 else 0 end
             + case when cond2 then 1 else 0 end
             + case when cond3 then 1 else 0 end as cond_count
    FROM mytable 
    WHERE cond1 
       OR cond2 
       OR cond3 
) t
order by cond_count desc 
```

这个解决方案的丑陋之处在于你在语句中每个条件都有两次，但我现在想不出另一种解决方案。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-18T14:00:46.083

```
The above query will check those conditions from the left side one by one i.e 

if the cond1 is true then 
      return the results order by rank.
if cond1 is false and cond2 is true then
      return the results order by rank.
if cond1 and cond2 both are false but cond3 is true
      returns the results order by rank.
if all conditions are false then no result is returned.     

So in brief it doesn't check all the conditions simultaneously for OR conditions.

Thanks. 
```

# wpf - 是否可以将多个资源传递到 DataTemplate 中？

> ID：10210519
> 
> 赞同：0
> 
> 时间：2012-04-18T13:34:09.267
> 
> 标签：wpf, datatemplate, multibinding

我想为 ListView 中的多个列重用 DataTemplate。鉴于这两个`XmlDataProvider`，我通过使用第一个中的选定项目从第二个中选择值。如果我在`DataTemplate`. 但这迫使我复制 DataTemplate 的代码并只交换附加资源。我想做的是：

```
<Window x:Class="LayoutTests.Window2"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:LayoutTests"
        Title="Window2" Height="300" Width="300">
  <Window.Resources>
    <XmlDataProvider x:Key="XmlDataA" IsInitialLoadEnabled="True">
      <x:XData>
        <Items xmlns="">
          <Item id="1" text="A:1"/>
          <Item id="2" text="A:2"/>
          <Item id="3" text="A:3"/>
        </Items>
      </x:XData>
    </XmlDataProvider>
    <XmlDataProvider x:Key="XmlDataB" IsInitialLoadEnabled="True">
      <x:XData>
        <Items xmlns="">
          <Item id="1" text="B:1"/>
          <Item id="2" text="B:2"/>
          <Item id="3" text="B:3"/>
        </Items>
      </x:XData>
    </XmlDataProvider>
    <local:MultiXmlConverter x:Key="MultiXmlConverter"/>
    <local:DatabindingDebugConverter x:Key="DatabindingDebugConverter"/>
    <DataTemplate x:Key="Template" >
      <TextBlock Text="{Binding Converter={StaticResource MultiXmlConverter}}"/>
    </DataTemplate>
  </Window.Resources>
  <Grid>
    <ListView ItemsSource="{Binding Source={StaticResource XmlDataA}, XPath='/Items/Item'}" Background="Transparent">
      <ListView.View>
        <GridView>
          <GridViewColumn CellTemplate="{StaticResource Template}">
            <GridViewColumn.DisplayMemberBinding>
              <MultiBinding>
                <Binding Path="/"/>
                <Binding Source="{StaticResource XmlDataB}"/>
              </MultiBinding>
            </GridViewColumn.DisplayMemberBinding>
          </GridViewColumn>
        </GridView>
      </ListView.View>
    </ListView>
  </Grid>
</Window> 
```

为了完整性（和参考），这里是一个可能的转换器：

```
 public class MultiXmlConverter : IMultiValueConverter
  {
    public object Convert(object[] value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
      var element = value[0] as XmlElement;
      var dataProvider = value[1] as XmlDataProvider;
      XmlNodeList nodes = dataProvider.Document.SelectNodes("/Items/Item/[@id='" + element.Attributes["id"].Value.ToString() + "']");
      return nodes[0].Attributes["Text"].Value.ToString();
    }
    public object[] ConvertBack(object value, Type[] targetType, object parameter, System.Globalization.CultureInfo culture)
    {
      throw new Exception("The method or operation is not implemented.");
    }
  } 
```

请注意，上面的 XAML 代码将不起作用并产生以下错误：“无法设置 MultiBinding，因为必须指定 MultiValueConverter。”。这`MultiBinding`只是我想做的事情的占位符。研究没有发现任何将额外参数传递给 a 的可能性`DataTemplate`——但我无法相信如此有用的东西没有隐藏在某个地方。

**那么如何将附加资源传递到`DataTemplate`旁边的`DataContext`**?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T15:25:07.013

经过大量调试和讨论，我找到了解决上述问题的方法。要将附加数据传递给模板，可以将属性附加到层次结构中的父元素。不幸的是，我们可以访问的东西 -`GridViewColumn`没有出现在可视树中。为了能够指定正确的资源，我们必须稍微总结一下。我修改了上面的示例以使其完整，所以这有点长：

```
<Window x:Class="LayoutTests.Window2"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:LayoutTests"
        Title="Window2" Height="300" Width="300">
  <Window.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary>
          <XmlDataProvider x:Key="XmlDataA" IsInitialLoadEnabled="True">
            <x:XData>
              <Items xmlns="">
                <Item id="1" text="A:1"/>
                <Item id="2" text="A:2"/>
                <Item id="3" text="A:3"/>
              </Items>
            </x:XData>
          </XmlDataProvider>
        </ResourceDictionary>
        <ResourceDictionary>
          <XmlDataProvider x:Key="XmlDataB" IsInitialLoadEnabled="True">
            <x:XData>
              <Items xmlns="">
                <Item id="1" text="B:1"/>
                <Item id="2" text="B:2"/>
                <Item id="3" text="B:3"/>
              </Items>
            </x:XData>
          </XmlDataProvider>
        </ResourceDictionary>
        <ResourceDictionary>
          <local:MultiXmlConverter x:Key="MultiXmlConverter"/>
          <local:DatabindingDebugConverter x:Key="DatabindingDebugConverter"/>
          <DataTemplate x:Key="Template" >
            <TextBlock>
              <TextBlock.Text>
                <MultiBinding Converter="{StaticResource MultiXmlConverter}">
                  <Binding/>
                  <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:Window2.AttachedXmlDataProvider)"/>
                </MultiBinding>
              </TextBlock.Text>
            </TextBlock>
          </DataTemplate>
          <DataTemplate x:Key="TemplateA">
            <ContentPresenter ContentTemplate="{StaticResource Template}" local:Window2.AttachedXmlDataProvider="{StaticResource XmlDataA}"/>
          </DataTemplate>
          <DataTemplate x:Key="TemplateB">
            <ContentPresenter ContentTemplate="{StaticResource Template}" local:Window2.AttachedXmlDataProvider="{StaticResource XmlDataB}"/>
          </DataTemplate>
        </ResourceDictionary>
      </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
  </Window.Resources>
  <Grid>
    <ListView ItemsSource="{Binding Source={StaticResource XmlDataA}, XPath='/Items/Item'}" Background="Transparent">
      <ListView.View>
        <GridView>
          <GridViewColumn CellTemplate="{StaticResource TemplateA}"/>
          <GridViewColumn CellTemplate="{StaticResource TemplateB}"/>
        </GridView>
      </ListView.View>
    </ListView>
  </Grid>
</Window> 
```

以及 .cs 文件中的内容：

```
 public partial class Window2 : Window
  {
    public Window2()
    {
      InitializeComponent();
    }

    public static readonly DependencyProperty AttachedXmlDataProviderProperty =
    DependencyProperty.RegisterAttached("AttachedXmlDataProvider",
                                         typeof(XmlDataProvider),
                                         typeof(Window2),
                                         new FrameworkPropertyMetadata((XmlDataProvider)null, FrameworkPropertyMetadataOptions.AffectsRender));
    public static void SetAttachedXmlDataProvider(DependencyObject depObj, XmlDataProvider value)
    {
      depObj.SetValue(AttachedXmlDataProviderProperty, value);
    }
    public static XmlDataProvider GetAttachedXmlDataProvider(DependencyObject depObj)
    {
      return (XmlDataProvider)depObj.GetValue(AttachedXmlDataProviderProperty);
    }
  }

  public class MultiXmlConverter : IMultiValueConverter
  {
    public object Convert(object[] value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
      var element = value[0] as XmlElement;
      var dataProvider = value[1] as XmlDataProvider;
      string id = element.Attributes["id"].Value.ToString();
      if( dataProvider.Document == null )
        return null;
      XmlNodeList nodes = dataProvider.Document.SelectNodes("/Items/Item[@id='" + id + "']");
      string result = nodes[0].Attributes["text"].Value;
      return result;
    }
    public object[] ConvertBack(object value, Type[] targetType, object parameter, System.Globalization.CultureInfo culture)
    {
      throw new Exception("The method or operation is not implemented.");
    }
  } 
```

上面代码的美妙之处在于我们将不同的资源集成在一个中`DataTemplate`，并且只需少量的代码就可以交换资源。即写一个`DataTemplate`简单地包装真实模板的东西。从上面的示例中可能并不明显，但如果您有一个真正的复杂问题`DataTemplate`并且需要更改它正在处理的资源，这是一个非常好的解决方案。

# asp.net - 发布网站在 Visual Studio 2010 项目中不可用

> ID：10210526
> 
> 赞同：1
> 
> 时间：2012-04-18T13:34:51.483
> 
> 标签：asp.net, visual-studio-2010, c#-4.0

我正在尝试发布名为 的项目`memberlogin`，其中包含许多网页。但是，我没有在“构建”下拉菜单中获得“发布网站”选项。

似乎出了什么问题？

我正在分享我所看到的屏幕截图： ![在此处输入图像描述](../Images/e1013fe1621496efb751029b34977a15.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:43:47.590

它在那里显示 Publish "YourProjectName" 并没有错。“memberlogin”是您将要发布的项目名称。单击它将显示另一个对话框，您可以在其中选择发布方法（Web 部署/文件系统/FTP）

![在此处输入图像描述](../Images/88957076dd9867348a636ff1cc470c64.png)

![在此处输入图像描述](../Images/a1a0b01d1c0d95afc8e36581ebcbbeda.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:37:10.337

您在解决方案中发布每个项目。在解决方案资源管理器中选择要发布的网站。

您看到的构建选项正在引用解决方案资源管理器中处于活动状态（粗体）的“当前项目”

# html - 2012年布局首选宽度

> ID：10210529
> 
> 赞同：4
> 
> 时间：2012-04-18T13:34:59.387
> 
> 标签：html, css, layout, width, screen-resolution

我正在开发新的网络应用程序，但仍然无法决定，我应该选择什么宽度的布局。该应用程序基于 Twitter Bootstrap 的库，目前我使用**默认网格系统**（有 12 列），宽度为**1170px**。

在显示器上（我假设大多数人的分辨率高于 1280px 宽度）看起来该应用程序不错，在我的 MacBook PRO 上也是如此，但我担心使用稍旧笔记本电脑的用户，其中宽度-分辨率大多为**1024**像素，看不到整个布局（并且会看到水平滚动条）。

所以，我想问问你的意见。您是否已经针对 > **1280px**的分辨率优化了布局，或者您仍然使用 res 来反映用户。**1024px**并在这种情况下为您的布局使用宽度**960px ？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T13:38:36.810

您应该使用**媒体查询**来更改较小分辨率的布局。在我的工作场所，有几台 1024 像素宽的显示器。此外，人们经常在纵向模式下使用平板电脑（IIRC，只有 1024 像素）。当然，人们*可以*将他们的平板电脑侧向查看整个事情，但许多人不会出于纯粹的懒惰或没有意识到它会解决问题。

如果您只想设计**一种**分辨率（阅读：您不应该这样做），那么我不会建议任何大于 1024 像素宽的东西。对于某些统计数据，我们网站大约 15-20% 的流量使用 1024 像素或更小的显示器。

还应该注意的是，即使对于显示器宽度为 1280 像素或更宽的用户，许多用户**也不会最大化他们的浏览器窗口**。这在 Mac 用户中尤其常见，但也可以在 Windows/Linux 用户中找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:39:10.867

根据[W3Counter 的 Global Stats](http://www.w3counter.com/globalstats.php)，15% 的显示器尺寸为 1024x768，56% 的显示器宽度至少为 1280 像素。我认为 15% 仍然太高，无法使用 1170px 作为布局。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:45:41.820

就个人而言，我为 1024px 及更高的桌面开发。我使用[媒体查询](https://developer.mozilla.org/en/CSS/Media_queries)来检测移动设备并提供替代布局。

正如 SupremeDud 在[他的回答](https://stackoverflow.com/a/10210617/383609)中所说，15% 的显示器仍然是 1024x768，这是相当大的市场份额。

就像素宽度而言，我的基本设计约为 960 像素。您可能想查看[960.gs](http://960.gs/)，尽管我不确定它如何与 Bootstrap 一起使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T18:38:14.707

液体或响应式布局怎么样？这样您就可以覆盖所有分辨率和窗口大小。

# asp.net - 如何在.net中读写system32目录下的文件

> ID：10210532
> 
> 赞同：1
> 
> 时间：2012-04-18T13:35:20.337
> 
> 标签：asp.net, system32

我的 asp.net 应用程序，我必须读取 system32 目录中的一些文件。

喜欢

c:/windows/system32/xx.config。

但我总是得到“FileNotFound”异常。

似乎这与权限问题有关

如何解决？

* * *

> **更新**

```
XmlDocument doc=new XmlDocument();
string file = Environment.GetFolderPath(Environment.SpecialFolder.System) +"\\inetsrv\\config\\applicationHost.config";
string dir = Environment.GetFolderPath(Environment.SpecialFolder.System) +"\\inetsrv\\config";
log.Info(Directory.Exists(dir)); // ==> true
log.Info(File.Exists(dir+"\\applicationHost.config")); // ==> false
if(File.Exist(file))
    doc.load(file); 
```

即使我更改`System`为`SystemX86`，结果也不会改变。

然后我直接加载文件而不检查它的存在：

```
XmlDocument doc=new XmlDocument();
string file = Environment.GetFolderPath(Environment.SpecialFolder.System) +"\\inetsrv\\config\\applicationHost.config";
doc.load(file); 
```

然后我得到了这个：

> 拒绝访问路径“C:\Windows\System32\inetsrv\config\applicationHost.config”。

该文件似乎受到保护，因此我尝试为文件及其父文件夹添加用户“NetWorkService”的所有权限（读/执行/写）。

但是仍然抛出异常。

# c# - Linq-to-SQL - 多个表

> ID：10210535
> 
> 赞同：1
> 
> 时间：2012-04-18T13:35:28.667
> 
> 标签：c#, sql, linq, linq-to-sql, multiple-tables

真正基本的 LINQ 问题，但是有人可以告诉我当它从多个数据库表中获取数据时它是如何处理数据的。

例如，如果你有一个`Products`表，那么使用 DBML 你会得到一个很好的`Product`对象，你可以查询、更新、创建等。（`Product.Name`等等`Product.Price`）一切都很好。

但是，如果我有一个 LINQ 查询，它连接`Product`了一堆其他表并将这些表中的列带回。数据库表到对象的 1:1 映射是不可能的，那么它返回的是什么？

例如。如果它是一个组合，`Product`我`Customer`将如何查询，例如，客户名称：

```
object.customerName ? 
```

它是否默认作为数据集返回？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:54:40.937

您通常会（即：经常，但并非总是如此。）编写您的查询将返回其集合的匿名类型。例如，您命名属性，然后可以像使用任何其他类型一样访问它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T14:01:25.330

它创建了所谓的“匿名类型”。你可以像这样使用它：

```
var x = from p in context.Products
        join o in OrderLines in p.Id = o.ItemId
        select new    // you are creating your anonymous type here
        {
            OrderId = o.Id,
            ProductName = p.Name,
            OrderDate = o.Date
        }

foreach (var y in x)
{
    Console.WriteLine("Product name: " + y.ProductName);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:50:01.567

如果您的密钥设置正确，您应该能够进行像 Product.Customers 或其他方式的查询。或者你可以连接两个表，语法类似这样：

```
from p in context.Products
join c in context.Customers on p.CId equals c.Id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T14:00:54.770

根据查询的 select 子句，您通常会有匿名类型或自定义对象

```
from p in context.Products
join //with other tables with appropriate join conditions
select new
{
   prop1 = p.ProductName,
   prop2 = p.ProductId
} 
```

这将返回具有 2 个属性 prop1 和 prop2 的匿名类型

```
from p in context.Products
join //with other tables with appropriate join conditions
select new MyProduct()
{
   prop1 = p.ProductName,
   prop2 = p.ProductId
} 
```

这将返回名为 MyProduct 的自定义对象，您可以在对象初始化程序的块中设置其属性

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T14:05:28.200

您可以在数据库中创建视图，并通过 Linq-to-SQL 映射到对象。

# javascript - Javascript 函数构建 url

> ID：10210536
> 
> 赞同：1
> 
> 时间：2012-04-18T13:35:29.017
> 
> 标签：javascript

我正在做一个项目，如果我能做到这一点，它将为我节省很多时间。我想在我的 javascript 函数中构建一个 url，并将变量作为 url 的一部分。（我不擅长 javascript，所以我无法正确解释它......但我可以展示我到目前为止所拥有的东西）。它更复杂，但看起来像这样：

我有这个功能（我知道它不起作用:-)）：

```
function art1(range) {
top.frames['infoframe'].location.href = 'http://url_part_1' + range + 'url_part_2.html';
} 
```

这在我的页面正文中：

```
<a href='some_other_url' onclick='some_other_functions();art1(C15)'   > 
```

所以结果应该是这个网址：

```
http://url_part_1_C15_url_part_2 
```

编辑：好的，附加问题：C15 在另一个函数中，即这里：

```
function changeText(){
var newHTML = "<td class='tas'><a href='_some_link_' target='changer' 
onclick='setVisibility2();art1(C15)'   (...) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:38:52.957

`C15`是一个变量（大概是`undefined`）。您需要一个字符串文字：`"C15"`.

# wpf - DataGridTextColumn 绑定到 IDictionary

> ID：10210538
> 
> 赞同：2
> 
> 时间：2012-04-18T13:35:36.960
> 
> 标签：wpf, silverlight, xaml, data-binding, datagrid

我有一个包含用户集合的 ObservableCollection

```
class User
{
  public int Id{ get; set; }
  public UserType UserType{ get; set; }
} 
```

和一个枚举

```
enum UserType
{
  Admin,
  Moderator,
  User,
  Guest
} 
```

然后我有一个名为 UserTypeMap 的枚举映射器，可以从 ViewModel 访问

```
public class UserListViewModel : INotifyPropertyChanged
{
  ......
  public ObservableCollection<User> Users
  {
    get{ return this.users; }
    set{ this.users = value; this.InvokePropertyChanged( "Users" );
  }
  public IDictionary<UserType, string> UserTypeMap{ get; set; }
  {
    get{ return this.userTypeMap; }
    set{ this.userTypeMap= value; this.InvokePropertyChanged( "UserTypeMap" ); 
  }
  ....
} 
```

在客户端，我制作了一个包含用户列表的 DataGrid

```
<sdk:DataGrid ItemsSource="{Binding Users}">
  <sdk:DataGridTextColumn Binding="{Binding Id}" Header="ID"/>
  <sdk:DataGridTextColumn Binding="{**??????????**}" Header="Type"/>
</sdk> 
```

我不知道如何将**字典值**绑定到**DataGridTextColumn**，我之前尝试使用组合框，使用 SelectedValue 和 ItemsSource 并且它有效，但我想将它显示在文本框/标签上，而不是组合框上......

有没有一种纯粹的 xaml 方式（不是页面后面的代码）来做到这一点？

谢谢，威尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:49:34.097

不是您的问题的答案，但我认为只显示您不需要 UserTypeMap 字典的枚举。

```
<sdk:DataGridTextColumn Binding="{Binding UserType, Mode=OneWay, StringFormat={}{0}}" Header="Type"/> 
```

# c# - 用 Javascript 打开邮件客户端服务器端？

> ID：10210543
> 
> 赞同：0
> 
> 时间：2012-04-18T13:35:47.630
> 
> 标签：c#, javascript, asp.net, server-side

有没有办法用 javascript 打开邮件客户端服务器端？我使用 C# 和 ASP.Net。Web应用程序。像 mailto：类型功能。就像我点击按钮一样，它会在我的电脑上打开 Outlook，并且已经输入了想要的电子邮件地址。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:42:27.150

这种东西：

```
<asp:Button runat="server" id="btn_email" Text="Send me an email"   OnClientClick="EmailClick" /> 
```

和脚本：

```
function EmailClick() {  
window.open("mailto:.......");  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:38:03.113

您可以发送`Location: mailto:some@address`标题。用户不会因为你这样做而喜欢你；如果他们的邮件客户端意外打开，他们会感到困惑/害怕/烦恼。

# database - 有没有办法在 Prolog 中创建索引数据集合？

> ID：10210544
> 
> 赞同：1
> 
> 时间：2012-04-18T13:35:50.313
> 
> 标签：database, arrays, indexing, prolog

想到在Prolog中创建数据库，使用列表显然是无效的。所以我想知道的是，是否有可能以某种方式通过索引访问元素，以及如何在理论上建立一个大型数据库。

我很好奇的另一个主题是如何实现这样一个简单的任务：
假设我们有 2 个数组
A [1,3,5,2,6,4] 和 B ["a","b","d" ,"e","c","f"]
目标是将字母绑定到数字，然后对两个数组进行排序得到
A [1,2,3,4,5,6] 和 B ["a"," e","b","f","d","c"]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:43:36.777

关于数据库问题：使用 Prolog 事实来存储数据是很常见的。SWI-Prolog 和其他系统自动构建动态索引以支持对此类集合的快速访问。关于第二个问题，例如使用`keysort/2`术语 [1-"a",3-"b",...,4-"f"]。请参阅 pairs_keys_values/3 和 library(pairs) 中的相关谓词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:42:40.200

对于索引，您可能最好将列表表示为事实的集合，就像`isAtIndex( index, valueAtIndex )`每个元素一样。那么，Prolog 可能会使用它所拥有的任何索引机制来匹配您想要的适当事实（即，要求它证明`isAtIndex(3,Value)`并且它将 Value 绑定到匹配的值）。

同样对于您的第二个问题：您将同时走 2 个数组，`pair(valueFromA, valueFromB)`为每个数组声明类似的东西。然后，您可以创建 A 的排序版本，一切就绪。

# windows - cmd 以某种方式将中文文本作为输出

> ID：10210553
> 
> 赞同：5
> 
> 时间：2012-04-18T13:36:22.900
> 
> 标签：windows, batch-file, cmd

我有一些麻烦`cmd.exe`。我有时用它来创建文件并在那里写输出。但如果我试试这个：

```
wmic logicaldisk get name, freespace >> output.txt
echo %date% >> output.txt 
```

我开始了两到三遍，我得到了一个`output.txt`赞：

```
FreeSpace    Name  
17990881280  C:    
             D:    
㠱〮⸴〲㈱ഠ䘊爀攀攀匀瀀愀挀攀    一愀洀攀  ഀ਀㄀㜀㤀㤀　㠀㠀㄀㈀㠀　  䌀㨀    ഀ਀             䐀㨀    ഀ਀㄀⸸㐰㈮㄰′਍ 
```

嗯，那里的中文文本看起来很有趣，但我想看看日期。我认为不知何故编码会随着日期而改变。一切都很好，如果我`echo %date% >> output.txt`一个人做，我会得到约会。

我想得到`wmic`输出和日期。

我该怎么办？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T12:53:24.553

原因是 WMIC 输出到 UNICODE。而批处理命令默认输出为 ANSI。由于 ANSI 代码页小于 UNICODE 并且映射方式不同，因此它们之间的转换成为一个问题。有几种方法可以解决这个问题。

A. 使用 /U 开关启动命令外壳，或者如果已经在命令提示符中，只需键入 cmd /U。

> 来自“Help cmd”命令的帮助：/U 使内部命令输出到管道或文件为 Unicode

因此，您最终将得到一个 UNICODE 文本文件，并且您的原始代码无需修改。但是，您需要记住始终使用 /U 开关。正确的方法是：

```
 wmic /OUTPUT:output.txt logicaldisk get name, freespace
    echo %date% >> output.txt 
```

B. 将 WMIC 输出转换为 ANSI（推荐。但取决于您的需要。当您决定添加到文本文件时，这会让生活更轻松。但是，您将不得不使用 2 个输出文件。）。

> ```
>  wmic /OUTPUT:output.tmp logicaldisk get name, freespace
>    TYPE output.tmp > output.txt
>    echo %date% >> output.txt 
> ```

希望这会对某人有所帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-18T14:30:48.567

WMIC 有一些奇怪的输出。我看过一个讨论，说 WMIC 使用 unicode，但我认为情况比这更复杂。如果我将 WMIC 输出捕获到文件并使用十六进制编辑器，我会在每行的末尾看到一个额外的回车符。我完全不知道在输入 output.txt 时如何将日期内容转换为乱码。（代码页问题？但如何？）在我的机器上，日期应该在哪里出现问号。

我能够通过使用解决问题

```
wmic logicaldisk get name, freespace | more >>output.txt
echo %date%>>output.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-12T07:11:06.623

我发现用于创建 txt 输出文件的批处理脚本使用 stdout ">>" 创建 txt 文件与 powershell 的输出格式 ascii、utf8 和 utf7 兼容，所有其他输出格式导致在文件中看到额外的空格。

如果输出文件是使用 powershells stdout ">>" 创建的，那么从批处理脚本添加到文件的任何 stdout 都将显示为中文字符。

在我的情况下，解决方法是使用批处理脚本重新创建输出文件，它将采用正确的格式，并且后续的 powershell 添加必须使用“| out-file -encoding ascii/utf8/utf7”

# mysql - 获取与表 b 匹配的表 a 的所有行

> ID：10210556
> 
> 赞同：0
> 
> 时间：2012-04-18T13:36:40.343
> 
> 标签：mysql

我有两个包含人员数据的表，名字，姓氏等。

第一个表包含我想要选择的数据，如果它与第二个表中的内容匹配。问题是第一个表可能只有名字的首字母。

我已经尝试过以下查询的变体，但我显然遗漏了一些东西。我不介意表 1 中的“J Bloggs”和“Joe Bloggs”是否都匹配表 2 中的“Joe Bloggs”，这很好。

```
SELECT t1.* ,  LEFT(t2.FIRST_NAME, 1) AS firstChar 
FROM t1, t2
WHERE t1.surname = t2.LAST_NAME
AND t1.firstname  = t2.FIRST_NAME
OR t1.firstname  = t2.firstChar
GROUP BY t1.surname 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:41:04.920

你需要把`()`你的第二个`WHERE`条件放在：

```
SELECT t1.* ,  LEFT(t2.FIRST_NAME, 1) AS firstChar 
FROM t1, t2
WHERE 
  t1.surname = t2.LAST_NAME
  AND (t1.firstname  = t2.FIRST_NAME OR t1.firstname  = LEFT(t2.FIRST_NAME, 1)
ORDER BY t1.surname 
```

但是，不鼓励和不推荐使用隐式连接语法。相反，使用

```
SELECT t1.* ,  LEFT(t2.FIRST_NAME, 1) AS firstChar 
FROM 
  t1 JOIN t2 
    ON t1.surname = t2.LAST_NAME
      AND (t1.firstname  = t2.FIRST_NAME OR t1.firstname  = LEFT(t2.FIRST_NAME, 1)
ORDER BY t1.surname 
```

由于您的条件是姓氏*必须*匹配，并且名字必须完全匹配或匹配第一个字符，因此必须将名字条件分组在`()`.

我还用 替换了您`GROUP BY`的`ORDER BY`，因为您没有执行任何组聚合函数 ( `SUM(), COUNT(), AVG()`)。MySQL 不允许在`WHERE`子句中使用别名，所以我也替换`t2.firstChar`为`LEFT(t2.firstChar, 1)`。

最后，您可能会发现需要转换连接两侧`UPPER()`或`LOWER()`两侧的所有名称的大小写，以确保它匹配可能不一致的大小写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:46:43.933

首先，您的`WHERE`子句中需要括号。其次，我认为`t2.firstChar`除非您实际上在表 t2 中有一个名为“firstChar”的列，否则您不会得到任何东西。在 your 中指定它`SELECT`不会使其成为表中的实际行。相反，我认为您正在寻找更像这样的东西：

```
SELECT DISTINCT t1.*
FROM
    t1
    INNER JOIN t2 ON
        t1.surname = t2.LAST_NAME
        AND (
            t1.firstname = t2.FIRST_NAME
            OR t1.firstname = LEFT(t2.FIRST_NAME, 1)
        ) 
```

# sql - 如何拦截和替换 jdbc 驱动程序中的 SQL？

> ID：10210560
> 
> 赞同：1
> 
> 时间：2012-04-18T13:36:49.153
> 
> 标签：sql, jdbc, intercept

我有一个无法更改的 Java 应用程序，它发送到 Oracle 数据库的 SQL 查询在性能方面还有很多不足之处（至少可以说）。

有没有办法在将 SQL 发送到数据库之前对其进行修改？

例如，一些允许拦截和修改 SQL 的 jdbc-proxy？网上类似的问题是[http://www.dbforums.com/microsoft-sql-server/1644179-source-code-jdbc.html](http://www.dbforums.com/microsoft-sql-server/1644179-source-code-jdbc.html)我在这里找到了这种代理的例子[http://code.google.com /p/log4jdbc/](http://code.google.com/p/log4jdbc/)

如果我不能更改应用程序本身，有没有更好的方法来拦截和重写 SQL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:50:10.190

我个人没有尝试过，但 P6spy (http://sourceforge.net/projects/p6spy/) 似乎可以满足您的需求。

# flash - 如何让 flv 播放器与 iphone/ipad 一起工作？

> ID：10210570
> 
> 赞同：0
> 
> 时间：2012-04-18T13:37:13.303
> 
> 标签：flash, ipad, flv, jwplayer

我正在使用 jw 播放器在网络上播放 flv 视频。但是我的一些客户说不能在他们的 ipad 上播放视频，

我查了一下，发现 ipad 没有 Flash 支持。那么我怎样才能使视频工作。

感谢所有感兴趣的人

此致 Suleyman Demirkeser

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:42:59.300

HTML5

或者

[http://www.adobe.com/products/flash-media-streaming.html](http://www.adobe.com/products/flash-media-streaming.html)

我认为它可以与 html5 一起使用以使其与 iOS 兼容

# javascript - Javascript：尝试将函数设置为数组中对象的成员

> ID：10210574
> 
> 赞同：0
> 
> 时间：2012-04-18T13:37:25.100
> 
> 标签：javascript, arrays, function-pointers

我通过将 C# 代数表达式编译器移植到 Javascript 来自学 Javascript。我有一个 OpBank 对象，它存储每个运算符的属性，例如，它是符号和指向实现该运算符的函数的指针。我知道 JS 没有函数指针，但我不知道还能叫什么。

当我尝试加载页面时，出现以下错误：

“Microsoft JScript 运行时错误：无法获取属性 'Plus' 的值：对象为空或未定义”

当浏览器尝试解析底部的 Operators 数组时会发生错误，它抱怨 OpBank.Plus。我尝试了 OpBank.Plus、OpBank.Plus()、只是普通的旧 Plus 和 this.Plus。无论如何，当 Operators 数组被加载时，我无法让它识别 Plus 函数。

```
var OpBank = {
    Plus: function (left, right) {
        return (left + right);
    },

    Minus: function (left, right) {
        return (left - right);
    },

    Operators: [
      (new KeyValuePair("+", new ABinaryOperator("+", 1, OpType.Binary, "+", OpBank.Plus))),
      (new KeyValuePair("-", new ABinaryOperator("-", 1, OpType.Binary, "-", OpBank.Minus)))
      ]
} 
```

我正在尝试的事情是不可能的吗？我应该改用 OpBank 的构造函数语法，即 var ObBank = function(){} 然后使用原型添加函数和数组吗？我不想这样做，因为我在应用程序的整个生命周期中只需要一个 OpBank，而且我不希望每个方法都必须实例化一个新的 OpBank，因为它是一个非常大的对象（上面只显示了其中的一部分） .

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:39:59.757

`OpBank`在评估对象文字时还不存在。

您可以简单地将其分为两个步骤：

```
var OpBank = {
    Plus: function (left, right) {
        return (left + right);
    },

    Minus: function (left, right) {
        return (left - right);
    }
}

OpBank.Operators = [
    (new KeyValuePair("+", new ABinaryOperator("+", 1, OpType.Binary, "+", OpBank.Plus))),
    (new KeyValuePair("-", new ABinaryOperator("-", 1, OpType.Binary, "-", OpBank.Minus)))
]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T14:07:58.997

这应该可以工作，至少在萤火虫控制台上。

```
var testObj = {
    first: function(){
        console.log("first");
    },
    second: function(){
        console.log("second");
    },
    third: function(){
        return typeof this.first;
    }
};
testObj.third(); 
```

# javascript - 有隐藏行时jqGrid冻结列

> ID：10210585
> 
> 赞同：1
> 
> 时间：2012-04-18T13:38:01.977
> 
> 标签：javascript, jquery, jqgrid

我有一个带有一些隐藏行的网格。我需要冻结前两列，但我发现如果有一些隐藏的行，'setFrozenColumns' 不起作用。有同样问题的人吗？你能帮助我吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:12:07.737

你的意思是隐藏行还是隐藏列？目前 - 从 4.3.2 开始 - 冻结列具有[以下限制](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3afrozencolumns)：

> 以下限制告诉您何时无法设置冻结列
> 
> *   启用 TreeGrid 时
> *   启用子网格时
> *   启用 cellEdit 时
> *   使用内联编辑时 - 无法编辑冻结的列。
> *   启用可排序列时 - 网格参数 sortable 设置为 true 或者是函数
> *   当滚动设置为 true 或 1
> *   启用数据分组时

因此，如果您使用的是 TreeGrid 或 SubGrid，冻结列将根本不起作用。

如果您的意思是您有隐藏的*列*，那么冻结的列应该可以工作 - 您可能需要发布代码或演示问题的小示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T14:59:54.343

这是一个完整的例子：

```
var mydata = [
{
id: "1",
invdate: "2010-05-24",
name: "test",
note: "note",
tax: "10.00",
total: "2111.00"},
{
id: "2",
invdate: "2010-05-25",
name: "test2",
note: "note2",
tax: "20.00",
total: "320.00"},
{
id: "3",
invdate: "2007-09-01",
name: "test3",
note: "note3",
tax: "30.00",
total: "430.00"},
{
id: "4",
invdate: "2007-10-04",
name: "test",
note: "note",
tax: "10.00",
total: "210.00"},
{
id: "5",
invdate: "2007-10-05",
name: "test2",
note: "note2",
tax: "20.00",
total: "320.00"},
{
id: "6",
invdate: "2007-09-06",
name: "test3",
note: "note3",
tax: "30.00",
total: "430.00"},
{
id: "7",
invdate: "2007-10-04",
name: "test",
note: "note",
tax: "10.00",
total: "210.00"},
{
id: "8",
invdate: "2007-10-03",
name: "test2",
note: "note2",
amount: "300.00",
tax: "21.00",
total: "320.00"},
{
id: "9",
invdate: "2007-09-01",
name: "test3",
note: "note3",
amount: "400.00",
tax: "30.00",
total: "430.00"},
{
id: "11",
invdate: "2007-10-01",
name: "test",
note: "note",
amount: "200.00",
tax: "10.00",
total: "210.00"},
{
id: "12",
invdate: "2007-10-02",
name: "test2",
note: "note2",
amount: "300.00",
tax: "20.00",
total: "320.00"},
{
id: "13",
invdate: "2007-09-01",
name: "test3",
note: "note3",
amount: "400.00",
tax: "30.00",
total: "430.00"},
{
id: "14",
invdate: "2007-10-04",
name: "test",
note: "note",
amount: "200.00",
tax: "10.00",
total: "210.00"},
{
id: "15",
invdate: "2007-10-05",
name: "test2",
note: "note2",
amount: "300.00",
tax: "20.00",
total: "320.00"},
{
id: "16",
invdate: "2007-09-06",
name: "test3",
note: "note3",
amount: "400.00",
tax: "30.00",
total: "430.00"},
{
id: "17",
invdate: "2007-10-04",
name: "test",
note: "note",
amount: "200.00",
tax: "10.00",
total: "210.00"},
{
id: "18",
invdate: "2007-10-03",
name: "test2",
note: "note2",
amount: "300.00",
tax: "20.00",
total: "320.00"},
{
id: "19",
invdate: "2007-09-01",
name: "test3",
note: "note3",
amount: "400.00",
tax: "30.00",
total: "430.00"},
{
id: "21",
invdate: "2007-10-01",
name: "test",
note: "note",
amount: "200.00",
tax: "10.00",
total: "210.00"},
{
id: "22",
invdate: "2007-10-02",
name: "test2",
note: "note2",
amount: "300.00",
tax: "20.00",
total: "320.00"},
{
id: "23",
invdate: "2007-09-01",
name: "test3",
note: "note3",
amount: "400.00",
tax: "30.00",
total: "430.00"},
{
id: "24",
invdate: "2007-10-04",
name: "test",
note: "note",
amount: "200.00",
tax: "10.00",
total: "210.00"},
{
id: "25",
invdate: "2007-10-05",
name: "test2",
note: "note2",
amount: "300.00",
tax: "20.00",
total: "320.00"},
{
id: "26",
invdate: "2007-09-06",
name: "test3",
note: "note3",
amount: "400.00",
tax: "30.00",
total: "430.00"},
{
id: "27",
invdate: "2007-10-04",
name: "test",
note: "note",
amount: "200.00",
tax: "10.00",
total: "210.00"},
{
id: "28",
invdate: "2007-10-03",
name: "test2",
note: "note2",
amount: "300.00",
tax: "20.00",
total: "320.00"},
{
id: "29",
invdate: "2007-09-01",
name: "test3",
note: "note3",
amount: "400.00",
tax: "30.00",
total: "430.00"}
];
jQuery("#list47").jqGrid({
data: mydata,
datatype: "local",
height: 150,
rowNum: 999999,
scroll: false,
shrinkToFit: false,
width: 350,
colNames: ['Inv No', 'Date', 'Client', 'Amount', 'Tax', 'Total', 'Notes'],
colModel: [
    {
    name: 'id',
    index: 'id',
    width: 60,
    sortable: false, frozen: true},
{
    name: 'invdate',
    index: 'invdate',
    width: 90,
    sorttype: "date",
    formatter: "date"},
{
    name: 'name',
    index: 'name',
    width: 100},
{
    name: 'amount',
    index: 'amount',
    width: 80,
    align: "right",
    sorttype: "float",
    formatter: "number"},
{
    name: 'tax',
    index: 'tax',
    width: 80,
    align: "right",
    sorttype: "float"},
{
    name: 'total',
    index: 'total',
    width: 80,
    align: "right",
    sorttype: "float"},
{
    name: 'note',
    index: 'note',
    width: 150,
    sortable: false}
],

pager: "#plist47",
viewrecords: true,
multiselect: true,
caption: "single selection",
beforeSelectRow: function(rowid, e)
{
    //jQuery("#list47").jqGrid('resetSelection');
    //return(true);
}

});

document.getElementById("1").style.display = 'none';
$("#list47").jqGrid("destroyFrozenColumns") 
                .jqGrid("setColProp","id",{frozen:true})
                .jqGrid("setColProp","invdate",{frozen:true})                 
                .jqGrid("setFrozenColumns") 
```

在这种情况下，只是标题被冻结，而不是整个列。

# c - malloc 内存指向指针

> ID：10210587
> 
> 赞同：1
> 
> 时间：2012-04-18T13:38:04.050
> 
> 标签：c, string, pointers

我在使用指向 char 的指针时遇到了这个问题：

```
void setmemory(char** p, int num)
{
    *p=(char*)malloc(num);
}

    void test(void)
    {
        char* str=NULL;
        setmemory(&str,100);
        strcpy(str,"hello");
        printf(str);
    }

int main()
{
    test();
    return 0;
} 
```

上面的代码是正确的，但我不明白为什么在这里使用指向指针 char** p 的指针？为什么只使用指向 char 的指针呢？所以我把这个片段改成下面，发现它不起作用，谁能告诉我为什么？谢谢！

```
void setmemory(char* p, int num)
{
    p=(char*)malloc(num);
}

void test(void)
{
    char* str=NULL;
    setmemory(str,100);
    strcpy(str,"hello");
    printf(str);
}

int main()
{
    test();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:43:40.830

**这里要注意的一件事是 - 当我们说指针时，我们通常倾向于考虑`pass by reference`但不一定。甚至指针也可以`passed by value`**

`char* str`是本地的`test`并且`char* p`是本地的`setmemory`。因此，如果您不发送指向指针的指针，您所做的更改`setmemory`将不可见。`test`

您可以使用这样的单个指针使其工作

```
 char * setmemory(char* p, int num) // p is a new pointer but points at the same
                                    // location as str
{
    p=(char*)malloc(num); // Now, 'p' starts pointing at a different location than 'str'
    strcpy(p ,"hello");  // Copy some data to the locn 'p' is pointing to
    return p; // Oops. The poor `str` is still pointing at NULL :( 
              // Send him the address of the newly allocated area
}

void test(void)
{
    char* str=NULL;
    str=setmemory(str,100); // We are passing a pointer which is pointing to NULL

    printf(str); //Now str points to the alloced memory and is happy :)
}

int main()
{
    test();
    return 0;
} 
```

请注意，`setmemory`我们正在返回一个本地指针，但这不是问题（没有悬空指针问题），因为该指针指向堆上而不是堆栈上的位置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:43:32.750

您想更改指针，即函数需要引用，而不是值。在 C 中，这是通过将地址（指针）提供给通过更改指针本身的变量来完成的。因此，一个指针用于引用，另一个用于您的 porgram 逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:48:52.583

您只在此处设置局部变量 *p。请记住，您获得的是指向数据的指针，而不是指向数据的指针。

可以这样想：

第一种情况：

```
int a;

foo(a); // Passes a
void foo(int b)
{
  b = 4;    // This only changes local variable, has no effect really
} 
```

第二种情况：

```
int a;
foo(&a); // Passes *a

void foo(int *b)
{
  *b = 4; // This changes the contents of a. As you can see we have not changed the original pointer!
  b = 4; // This changes our local copy of the pointer, not the pointer itself, like in the first case!
} 
```

第三种情况

```
int *ptr;
foo(&ptr); // Passes **ptr

void foo(int **b)
{
  **b = 4; // This changes the data of the passed pointer
  *b = 4; // This changes the passed pointer itself, i.e. it changes ptr. This is what test() is doing, the behavior you are looking for!
  b = 4; // This changes our local copy of a variable, just like the first case!
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T13:48:54.077

原始代码正在传递调用者希望放置字符串指针的位置。如果你只传入一个'char*'，调用者将通过值传递调用者位置的内容——可能是一些未初始化的值。

如果被调用者必须返回一个字符串或其他间接结构，则需要两个星号，以便被调用者可以返回指向调用者指针变量的指针。

那有意义吗？它对我有用，但话又说回来，我写了它。

# python - 格式化python字符串中的换行符

> ID：10210590
> 
> 赞同：1
> 
> 时间：2012-04-18T13:38:14.127
> 
> 标签：python, string, split

我有一个字符串：

```
f = open("file.txt", r)
message = f.read()

print message
>>> "To: email\ntitle: add title here\nDescription: whatever here\n" 
```

我可以通过以下方式拆分字符串：

```
f_email, f_title, f_description, blank = message.split('\n') 
```

但是当我收到这样的消息时，问题就出现了：

```
"To: email\ntitle: add title here\nDescription: first line\nSecond line\nthirdline\n" 
```

当我拆分字符串时，它也会拆分描述。我试过了：

```
f_email, f_title, f_description, blank = message.split('\n',4) 
```

但这显然会返回 ValueError ，因为它正在拆分更多的 4 \n。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T13:41:23.033

当你运行时，`.split('\n')`你会返回一个列表。您可以将它们从列表中拉出，而不是在拆分时分配变量：

```
tokens = message.split('\n')
f_email = tokens[0]
f_title = tokens[1]
f_description = tokens[2] 
```

这可以通过检查列表的大小来减少脆弱性。如果您知道它至少需要三个元素，您可以：

```
assert(len(tokens)>=3) 
```

解决此问题的另一种方法是将事物包装在一个`try/except`块中：

```
tokens = message.split('\n')
try:  
    f_description = tokens[2]
except:
    f_description = None 
```

这样，您就可以按照自己喜欢的方式处理较短的列表！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T13:45:17.573

@Hooked 为 Python2 提供了一个很好的答案。由于在 Python3 中`*`也适用于元组解包，您可以执行以下操作：

```
f_email, f_title, *f_description = tokens 
```

详细信息在[PEP 3132中](http://www.python.org/dev/peps/pep-3132/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:48:54.277

如果您不想将文本作为一个整体使用，并且不低于 3.x 以使用漂亮的 splat 解包，您可以简单地这样做：

```
email = None
title = None
description = ""
with open("test.txt", "r") as f:
    for number, line in enumerate(f):
       if number == 0:
           email = line.strip()
       elif number == 1:
           title = line.strip()
       else:
           description += line 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T14:27:37.817

当您使用 message.split('\n', 2) 时，您会得到三个部分：第一行、第二行和其余行合二为一。

使用此表格：

```
f = open("file.txt")  
f_email, f_title, f_description = f.read.split('\n', 2)  
f.close() 
```

或这个：

```
f = open("file.txt")  
f_email = f.readline()  
f_title = f.readline()  
f_description = f.read()  
f.close() 
```

# ruby-on-rails - Rails 3.2 舰队

> ID：10210591
> 
> 赞同：1
> 
> 时间：2012-04-18T13:38:16.467
> 
> 标签：ruby-on-rails, ruby, charts

我们在将应用程序升级到 3.2 时遇到了一些问题。

因为 rails 3.2**舰队**不再工作了。

```
undefined method 'chart' for #<#<Class:0x00000006f08fb0>:0x000000078b7c00> 
```

[https://github.com/joshuamiller/flotilla/blob/master/lib/flotilla.rb](https://github.com/joshuamiller/flotilla/blob/master/lib/flotilla.rb)

我无法访问没有自我的方法。在模块中！？它在 Rails 3.2 中的新功能？

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T20:39:31.813

[随着 3.1 中资产管道的引入，初始化](http://guides.rubyonrails.org/initialization.html)有一些变化。因此，帮助程序永远不会包含正确的模块，因此该方法对您的视图不可用。

为了解决这个问题，我创建了一个合适的 gem 来包装 Flotilla 并与资产管道兼容。你可以在[https://github.com/hnnsgstfssn/flotilla-rails](https://github.com/hnnsgstfssn/flotilla-rails)找到它。

# ios - ios检测到无线变化

> ID：10210592
> 
> 赞同：1
> 
> 时间：2012-04-18T13:38:17.003
> 
> 标签：ios, wireless, nsnotifications

当用户的设备突然连接到 wifi 时，是否会发送通知？还是这种性质的东西？

我希望我的应用程序委托中的某个选择器/方法在用户连接到无线时运行。我怎么知道什么时候执行我的选择器？

** 编辑 **

如果有人需要，我最终找到了一个[IOS 5 ARC 友好版本的可达性。](https://github.com/tonymillion/Reachability)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:52:24.713

[您应该从此处](http://developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html)包含 Reachability 标头和实现。

前段时间我做了一个项目，我需要检查我是否在某些时候连接到 WiFi。以下是一些可能对您有用的代码：

```
- (BOOL) connectedToNetwork
{
    // Create zero addy
    struct sockaddr_in zeroAddress;
    bzero(&zeroAddress, sizeof(zeroAddress));
    zeroAddress.sin_len = sizeof(zeroAddress);
    zeroAddress.sin_family = AF_INET;

    // Recover reachability flags
    SCNetworkReachabilityRef defaultRouteReachability = SCNetworkReachabilityCreateWithAddress(NULL, (struct sockaddr *)&zeroAddress);
    SCNetworkReachabilityFlags flags;

    BOOL didRetrieveFlags = SCNetworkReachabilityGetFlags(defaultRouteReachability, &flags);
    CFRelease(defaultRouteReachability);

    if (!didRetrieveFlags)
    {
        printf("Error. Could not recover network reachability flags\n");
        return 0;
    }

    BOOL isReachable = flags & kSCNetworkFlagsReachable;
    BOOL needsConnection = flags & kSCNetworkFlagsConnectionRequired;
    BOOL nonWiFi = flags & kSCNetworkReachabilityFlagsTransientConnection;
    return ((isReachable && !needsConnection) && !(nonWiFi)) ? YES : NO;
} 
```

如果连接到 WiFi，则返回 true。

检测何时发生更改的一种方法是运行[NSTimer](https://stackoverflow.com/questions/1449035/how-do-i-use-nstimer)并检查结果是否随时间变化。不过，您不希望过于频繁地运行它。

# android - 有没有办法在 XML 资源中定义自定义标签

> ID：10210593
> 
> 赞同：1
> 
> 时间：2012-04-18T13:38:20.163
> 
> 标签：android, xml

我想在项目 res 文件夹中定义这样的东西：

```
<custommap name="MyMap">
    <entry key="@string/key1" value="1">K1</entry >
    <entry key="@string/key2" value="2">K2</entry >
    <entry key="@string/key3" value="3">K3</entry >
    <entry key="@string/key4" value="4">K4</entry >
</custommap> 
```

有可能吗？上面的例子没有通过编译（我试图将它插入arrays.xml）。如果可能，如何从 java 代码中访问它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T14:47:57.833

1.  通过右键单击 res 文件夹并在 /xml 文件夹下创建一个新文件来创建您自己的 xml 文件。

2.  通过查找 XML 标记，使用 XMLParser 将您的 xml 读入 ArrayList，如下所示：

    ```
    public ArrayList<textElement> PrepareListFromXml(String cat)
    {
        textElement te;

        ArrayList<textElement> listItems = new ArrayList<textElement>();
        XmlResourceParser listXml = getResources().getXml(R.xml.<your resource name>);

        int eventType = -1;
        while (eventType != XmlResourceParser.END_DOCUMENT)
        {
            if (eventType == XmlResourceParser.START_TAG)
            {                
                String strNode = listXml.getName();
                if (strNode.equals("entry"))
                {
                    te.setText(listXml.getAttributeValue(null, "key"));
                    listItems.add(te);
                }
            }

            try
            {
                 eventType = listXml.next();
            }
            catch (XmlPullParserException e)
            {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
            }
            catch (IOException e)
            {
                   // TODO Auto-generated catch block
                    e.printStackTrace();
            }
        }

        return listItems;
    } 
    ```

# spring - 在 Hibernate + Spring 上更新实体的正确方法

> ID：10210597
> 
> 赞同：2
> 
> 时间：2012-04-18T13:38:23.307
> 
> 标签：spring, hibernate, caching, merge

我有这个问题：

我准备与实体的视图

```
@RequestMapping("/admin/modifyImplant/{id}")
 public ModelAndView modifyImplant(@PathVariable Integer id) {
  ModelAndView mav = new ModelAndView();

  Implant currentImplant =impDAO.findById(id); //this is the dao
  Implanttype it= currentImplant.getImplanttype();
  Implantinverter ii=new Implantinverter();
  ArrayList<Implantpanel> implantpanels = new ArrayList<Implantpanel>();
  try{
      ii= (Implantinverter)currentImplant.getImplantinverters().toArray()[0];
      implantpanels=(ArrayList<Implantpanel>) imppanelDAO.findByProperty("implant",currentImplant );
  }
  catch (Exception ex){
      //TODO
  }
  mav.addObject("implantpanels", implantpanels);
  mav.addObject("implantinverter",ii);
  mav.addObject("implant", currentImplant); //THIS IS THE ENTITY I MEAN
  mav.addObject("implanttype",it);
  mav.setViewName("/implant/modifyImplant.jsp");

  return mav;

} 
```

这个jsp的代码方法（一小部分代码）

```
<form:form action="${pageContext.request.contextPath}/admin/finalizeModifyImplant/${implant.id}" method="POST" modelAttribute="implant">
        <table cellpadding="0" cellspacing="0" id="viewTable" >
            <tbody>
                <tr>
                <td class="label">
                    Name:
                </td>   
                <td>    
                    <form:input  id="User_namesurname" path="businessname" cssStyle="width:300px;"/>
                </td>
                </tr> 
```

实体字段以此类推。实体有一些实体相关，通过外键连接（如implanttype、implantinverter、implantpanels）。

提交到这个控制器：

```
 @RequestMapping(value = "/admin/finalizeModifyImplant/{id}",
method = { RequestMethod.GET,RequestMethod.POST })
public ModelAndView finalizeModifyImplant(@PathVariable int id, @Valid @ModelAttribute Implant implant, BindingResult result){
    ModelAndView mav=new ModelAndView();
    mav.setViewName("../../admin/modifyImplant/"+id);
    if (result.hasErrors()){
        return mav;
    }

    implant.setId(id); //NOTICE WHAT I NEED TO DO HERE!
    Implant oldImplant= impDAO.findById(id);
    implant.setImplantinverters(oldImplant.getImplantinverters());
    implant.setImplantpanels(oldImplant.getImplantpanels());
    implant.setImplanttype(oldImplant.getImplanttype());
    implant.setInverters(oldImplant.getInverters());
    implant.setPvgis(oldImplant.getPvgis());
    try{
        impDAO.merge(implant); //here i call getSession().merge()
    }catch(RuntimeException re){
        return mav;
        //TODO: errors
    } 
```

当我收到表单提交（这是一个更新）时，我有以下问题： 1\. 返回的植入程序没有 id（字段 id=null） 2\. 相关实体也为空。

以下是植入实体

```
public class Implant implements java.io.Serializable {
// Fields
private Integer id;
private Pvgis pvgis;
private Gateway gateway;
private Implanttype implanttype;
@JsonIgnore //I NEED TO JSONIGNORE IT BECAUSE IT HAS A RECURSIVE CALL ON IMPLANT
private Users users;
@NotEmpty
private String nameimplant;
private String place;
private double latitude;
private double longitude;
private double expectedpower;
private double tolerance;
[...] and many other fields 
```

以及相关的implant.hbm.xml

```
<hibernate-mapping>
<class name="it.pstmarche.model.Implant" table="implant" schema="public">
    <id name="id" type="integer">
        <column name="id" />
        <generator class="identity" />
    </id>
    <many-to-one name="pvgis" class="it.pstmarche.model.Pvgis" fetch="select">
        <column name="idpvgis" />
    </many-to-one>
    <many-to-one name="gateway" class="it.pstmarche.model.Gateway" fetch="select">
        <column name="idgateway" />
    </many-to-one>
    <many-to-one name="implanttype" class="it.pstmarche.model.Implanttype" fetch="select">
        <column name="implanttype" />
    </many-to-one>
    <many-to-one name="users" class="it.pstmarche.model.Users" fetch="select" >
        <column name="iduser" />
    </many-to-one>
    <property name="nameimplant" type="string">
        <column name="nameimplant" not-null="true">
            <comment>Name</comment>
        </column> 
```

我真的不知道如何正确进行更新，因为当我尝试从数据库（通过 findById 或直接查询）获取更新的实体时，我得到随机结果，有时我得到正确和更新的实体，有时我得到旧的实体！！真的很随意。

我试过：1.删除缓存（ session.setCacheMode(CacheMode.IGNORE); ）没有结果 2.添加 getSession().flush(); getSession().close(); 在合并方法的最后，即：

```
public void merge(Implant currentImp){
    //Session session = HibernateSessionFactory.getSessionFactory().openSession();
    Transaction tx= getSession().beginTransaction();
    if (currentImp.getId() != null) { // it is an update
        getSession().merge(currentImp);
        tx.commit();
        //getSession().update(currentImp);
        log.debug("MERGE");
        getSession().flush();// THAT'S THE ADD
        session.close(); //THIS IS ALSO
    } else { // you are saving a new one
        getSession().saveOrUpdate(currentImp);
        tx.commit();
        getSession().flush();
        getSession().close();
        log.debug("Save sou");
    } 
```

我真的不知道用 Hibernate + Spring 实现更新的正确方法是什么！任何帮助表示赞赏。谢谢

**编辑**：也许我的问题不清楚。当前的问题是，**在我随机保存或合并**实体后，当我搜索实体（例如通过查询 findById(int id)）时，我随机得到旧实体（我认为它仍在休眠会话中）。**解决此问题的唯一方法是清除会话**（getSession（）.clear（）），但在此之后**我显然得到了延迟异常 -**当我尝试获取我需要的实体的相关实体时，没有代理在清除中会议！真可惜

**2EDIT**：感谢 Tim H。但是，我仍然面临与处理休眠会话相关的问题。前言：我使用每个线程的休眠会话，比如

```
private static final ThreadLocal<Session> threadLocal = new ThreadLocal<Session>();
private  static Configuration configuration = new Configuration();    
private static org.hibernate.SessionFactory sessionFactory;
private static String configFile = CONFIG_FILE_LOCATION;
static {
    try {
        configuration.configure(configFile);
        sessionFactory = configuration.buildSessionFactory();
    } catch (Exception e) {
        System.err
                .println("%%%% Error Creating SessionFactory %%%%");
        e.printStackTrace();
    }
}
private HibernateSessionFactory() {
}
public static Session getSession() throws HibernateException {
    Session session = (Session) threadLocal.get();
    if (session == null || !session.isOpen()) {
        if (sessionFactory == null) {
            rebuildSessionFactory();    
        }
        session = (sessionFactory != null) ? sessionFactory.openSession()
                : null;
        threadLocal.set(session);
    }
    return session;
} 
```

现在，**假设我在 Tomcat 线程 1 上从数据库加载实体 x**。实体值为**100**。加载后我无法关闭会话，*因为它是延迟初始化的*（如果我关闭会话，我**可能**会遇到延迟初始化异常 - 无代理/会话）。

之后，**我更新线程 2 上实体 x 的值**。现在的值为**50**。

最后，我加载了值，但是 tomcat 让我进入线程 1，实体仍在线程的会话中，值仍然是 100。我得到的是旧值而不是新值！！

所以，在我的 jsp 完成之前我无法关闭会话（我使用惰性字段），我必须通过以下方式在 jsp 结束时关闭会话：<% HibernateSessionFactory.getSession().close (); %> 这太可怕了！我将视图与模型结合起来！有一种模式可以安全地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:53:28.220

我也许可以阐明您的一些问题。

1.  如果请求参数与您的实体上的 id 属性匹配（即隐藏的表单字段），您的 id 只会绑定到您的实体。

2.  对于绑定的其余部分，您可能想要使用所谓的“@ModelAttribute”技巧。基本上，任何使用 @ModelAttribute 注释的方法都将在所有请求之前被调用，因此此方法将返回 Spring 将形成的实体，然后从您的表单中绑定您的支持对象，就像这样。

    @ModelAttribute Implant 植入 public Implant getBackingImplant(HttpServletRequest request) { if(request.getParameter("id") != null return dao.getImplantByIdWithAllMyRelationshipsFilledIn(request.getParameter("id");

    返回新的植入物（）；}

因此，现在 spring 会将您的表单与 getBackingImplant 返回的实体绑定。

至于你的保存不起作用，我真的不确定我不是一个冬眠的人，但上面应该解决你的表单绑定问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T11:45:31.277

添加一个新答案，因为现在问题更清楚了。请记住，合并返回它合并的实体，您正在丢弃合并命令的结果，而是应该将其返回给您的控制器。

# ruby-on-rails-3 - 解决 Rails 3.2 中控制器的视图路径

> ID：10210598
> 
> 赞同：3
> 
> 时间：2012-04-18T13:38:26.727
> 
> 标签：ruby-on-rails-3, view, rendering

我想要一个从一堆控制器呈现的共享 js 响应（视图）。它住在`app/views/shared/success.js.erb`.

*这是我的大多数*控制器的标准响应，它使用一些内容修改 DOM。但是，此内容特定于呈现它的控制器。

问题是，我不知道如何从这个共享的 js 视图中解析特定控制器的视图路径。他是一个例子（包括一些命名空间控制器）

```
# app/controllers/users_controller.rb
class UsersController < ActionController::Base
  def create
    # do some stuff
    render 'shared/success' # .js.erb
  end
end

# app/controllers/settings/permissions_controller
class Settings::PermissionsController < ActionController::Base
  def create
    # do some stuff
    render 'shared/success' # .js.erb
  end
end

# app/views/users/success.html.erb
<p>Some View code that only relates to <strong>users</strong></p>

# app/views/settings/permissions/success.html.erb
<p>Some View code that only relates to <strong>permission settings</strong></p>

# app/views/shared/success.js.erb
var listItem = '<%= j render "#{insert resolved path to this particular controller instance}/success.html.erb" %>'
$(".list").append(listItem); 
```

我之所以要这样做是因为js响应总是一样的，只是内容发生了变化。关于如何获得当前控制器的默认视图渲染路径的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T10:21:23.990

您可以使用以下命令访问当前操作名称：

```
params[:action] 
```

然后，您可以相应地自定义视图。

或者，您可以在这些控制器中使用您期望在 .js 视图中的值设置一个实例变量，然后在视图中使用它。

# php - 显示为链接的数据库搜索查询

> ID：10210601
> 
> 赞同：2
> 
> 时间：2012-04-18T13:38:36.163
> 
> 标签：php, sql, search, search-engine

我对 php 很陌生，我正在开发一个带有搜索栏的网站。

我使用了一些代码来实现搜索查询以从我的数据库中搜索产品。搜索查询工作正常并显示所有需要显示的必需产品。

但是，我希望这些项目具有指向产品详细信息页面的链接，该页面显示有关该特定产品的更多信息。但是，我不知道您如何将其表示为使用 html 的链接。

我的搜索代码如下：

```
<?php

error_reporting(E_ALL);
ini_set('display_errors', '1');
$search_output = "";
if(isset($_POST['searchquery']) && $_POST['searchquery'] != ""){
    $searchquery = preg_replace('#[^a-z 0-9?]#i', '', $_POST['searchquery']);
    if($_POST['filter1'] == "Food"){
        $sqlCommand = "SELECT * FROM tbl_product WHERE pd_name LIKE '%$searchquery%'";
    }
    include_once("config.php");

    //Database connections below

     mysql_connect($dbHost, $dbUser, $dbPass) or die(mysql_error()); 
 mysql_select_db($dbName) or die(mysql_error());

    $query = mysql_query($sqlCommand) or die(mysql_error());
    $count = mysql_num_rows($query);
    if($count >= 1){
        $search_output .= "<hr />$count results for <strong>$searchquery</strong><hr />";
        while($row = mysql_fetch_array($query))
        {
            $pd_name = $row["pd_name"];
        $search_output .= "$pd_name<br />";
        } // close while
    } else {
        $search_output = "<hr />0 results for <strong>$searchquery</strong><hr />";
    }
}
?>
<html>
<head>
</head>
<body>
<form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
Search for dishes : 
  <input name="searchquery" type="text" size="30" maxlength="100"> 
In: 
<select name="filter1">
<option value="Food">Food</option>

</select>
<input name="myBtn" type="submit" value="Search">

<br />
</form>
<div>
<?php echo $search_output; ?>
</div>
</body>
</html> 
```

我希望它参考的链接是：

```
<a href="" . $_SERVER['PHP_SELF'] . "?c=$catId&p=$pd_id" . "">$pd_name</a> 
```

但是，添加此引用时，它似乎不起作用。任何帮助，将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:43:16.347

尝试切换这个：

```
$pd_name = $row["pd_name"];
$search_output .= "$pd_name<br />"; 
```

有了这个：

```
$pd_name = $row["pd_name"];
$pd_id   = $row["pd_id"];
$search_output .= '<a href="' . $_SERVER['PHP_SELF'] . '"?c=$catId&p=' . $pd_id . '">' . $pd_name . '</a><br>'; 
```

顺便说一句，您需要阅读 SQL 注入，因为您应该在将用户输入数据传递到数据库之前对其进行转义。至少改变这个：

```
$sqlCommand = "SELECT * FROM tbl_product WHERE pd_name LIKE '%$searchquery%'"; 
```

对此：

```
$sqlCommand = "SELECT * FROM tbl_product WHERE pd_name LIKE '%".mysql_real_escape_string($searchquery)."%'"; 
```

# wpf - 一个窗口中是否可以有多个不透明度？

> ID：10210604
> 
> 赞同：0
> 
> 时间：2012-04-18T13:38:38.890
> 
> 标签：wpf, xaml

我正在考虑有这样的事情：

```
<Grid> <-- opacity is .5
    <Grid></Grid> <-- opacity is .9 (of total opacity, not relative to parent)
    <Grid></Grid> <-- opacity is .9
    <Grid></Grid> <-- opacity is .9
</Grid> 
```

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:16:59.363

在另一个网格中管理网格？

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition/>
        <ColumnDefinition/>
        <ColumnDefinition/>
    </Grid.ColumnDefinitions>
    <Grid Grid.ColumnSpan="3"><Grid> <-- opacity is .5 
    <Grid Grid.Column="0"></Grid>    <-- opacity is .9
    <Grid Grid.Column="1"></Grid>    <-- opacity is .9 
    <Grid Grid.Column="2"></Grid>    <-- opacity is .9 
</Grid> 
```

# javascript - 将鼠标指针移到按钮上时如何显示更多信息？

> ID：10210611
> 
> 赞同：1
> 
> 时间：2012-04-18T13:38:53.410
> 
> 标签：javascript, jquery, ruby-on-rails, ruby, jquery-ui

我正在使用 rails v3.2.2 和 jquery-rails v2.0.2 ruby​​-gems。当我将鼠标指针移到按钮上时，我想显示更多信息，例如 Facebook、Google 和其他公司在其应用程序中制造的。

以下是来自 Google Gmail 的屏幕截图，显示了我想在我的应用程序中实现的内容：

![在此处输入图像描述](../Images/2c5daed2fbb06da048447d18a9bc75e1.png)

**我该怎么做？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:43:34.000

有几种方法可以做到这一点，使用 CSS 和/或 JavaScript。这是一个基本的 CSS 解决方案：

**HTML**

```
<button>Button text</button>
<div class="tooltip">Tooltip Content</div>​ 
```

**CSS**

```
.tooltip { display: none; }
button:hover+.tooltip { display: block; }​ 
```

[http://jsfiddle.net/b7AF7/](http://jsfiddle.net/b7AF7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:41:46.200

考虑一个工具提示库，其中有很多，包括：

*   [时髦： http](http://vadikom.com/demos/poshytip/) ://vadikom.com/demos/poshytip/
*   [颜色提示： http](http://demo.tutorialzine.com/2010/07/colortips-jquery-tooltip-plugin/colortips.html) ://demo.tutorialzine.com/2010/07/colortips-jquery-tooltip-plugin/colortips.html
*   抱怨：http : [//jamescryer.github.com/grumble.js/](http://jamescryer.github.com/grumble.js/)

网络搜索会出现更多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:41:56.683

查看[Qtip](http://craigsworks.com/projects/qtip2/) jQuery 工具提示插件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T13:40:59.040

`title`在你的按钮标签上使用属性怎么样？

就像是：

```
<input type="button" title="your message" value="Button" /> 
```

# javascript - 图像导航叠加箭头（下一个和上一个）

> ID：10210615
> 
> 赞同：1
> 
> 时间：2012-04-18T13:39:00.040
> 
> 标签：javascript, jquery, image, html, css

我正在尝试为我的画廊中的图像创建一个覆盖图像导航箭头，我找到了一些脚本并且它工作正常，除了它需要我提供图像尺寸才能正常工作，HTML 代码

```
<div id="article_image">

    <img alt="" src="image.jpg" />

    <div id="article_image_overlay" style="height: 361px; width: 620px">

        <a href="prev" class="prev" title="Previous image"><span style="height: 361px; display: inline"/></a>
        <a href="next" class="next" title="Next image"><span style="height: 361px; display: inline"/></a>
    </div>

</div> 
```

和 CSS 样式

```
#article_image {clear:both;margin:7px 0 10px;position:relative;overflow:hidden;overflow:hidden;}
#article_image img {display:block;}

#article_image_overlay {position:absolute;z-index:2;top:0;left:0;}
#article_image_overlay a {position:absolute;left:0;top:0;width:50%;height:100%;background:url('blank.gif') repeat 0 0;}

#article_image_overlay .next {left:auto;right:0;}

#article_image_overlay span {float:left;width:75px;height:100%;display:none;zoom:1;background:url('blank.gif') repeat 0 0;margin:0 0 0 12px;cursor:pointer;}
#article_image_overlay .next span {margin:0 12px 0 0;float:right;}

#article_image_overlay .prev:hover span,#article_image_overlay .prev.hover span {background:url('arrow_left.png') no-repeat 0 50%;}
#article_image_overlay .next:hover span,#article_image_overlay .next.hover span {background:url('arrow_right.png') no-repeat 100% 50%;} 
```

一切正常，但我无法（直接）访问图像尺寸，我想将其从 HTML 代码中删除，以便它适用于纯 CSS/JS 解决方案，我需要一些帮助，谢谢 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:56:57.393

我之前遇到过这个问题，您需要在运行代码之前“加载”图像，如下所示：

```
$('.myDiv img').load(function() {
   // run slider here...
}); 
```

您会注意到图像需要完全加载才能运行滑块，这可能看起来不太好，因此，您可能希望在加载时隐藏“.myDiv”，并​​在图像到位后显示它（请参阅[jquery](http://api.jquery.com/toggle/)工具用于此）。

我希望它有帮助！

mb

# asp.net-mvc - 如何将 JSON 或 JavaScript 对象文字呈现为我的视图的一部分？

> ID：10210618
> 
> 赞同：1
> 
> 时间：2012-04-18T13:39:11.860
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

我有许多可以使用 JSON 或 JavaScript 对象字面量作为数据源的小部件，并且这些数据很少更改，例如下面的剑道菜单。这个菜单是硬编码的，我希望它保持这种状态——我不希望我的应用程序在填充菜单等时变得太健谈——但我想从我的 Razor 视图中发出那个硬代码。

```
$("#view-menu").kendoMenu({
    dataSource: [
            {
                text: 'Save',
                url: '#',
                imageUrl: '@Url.Content("~/Content/Images/Save.png")'
            },
            {
                text: 'Cancel',
                url: '@Url.Action("Edit", "Employee", new {id = Model.EmployeeId})',
                imageUrl: '@Url.Content("~/Content/Images/Cancel.png")'
            }
    ]
});

$(".k-menu a.k-link[href=#]").click(function (e) {
    e.preventDefault();
    $(this).parents('form').first().submit();
}); 
```

是否有一个现有的助手可以用来渲染一个`KendoMenuConfig`配置这个菜单的对象？我想要这样的东西来代替上面的：

```
$("#view-menu").kendoMenu({
    @Html.KendoMenuConfig(blah blah))
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T07:06:18.740

无需编写自己的 html 助手

```
@Html.KendoMenuConfig(blah blah)) 
```

返回与您的配置相对应的字符串，它将起作用，您实际上是在正确的方式上。

```
public static String KendoMenuConfig(this HtmlHelper html,.....) 
```

在命名空间部分的 /View/Web.config 中包含包含此扩展的类。

# c# - Silverlight xml序列化

> ID：10210619
> 
> 赞同：0
> 
> 时间：2012-04-18T13:39:22.047
> 
> 标签：c#, .net, silverlight, visual-studio-2010, msbuild

在进行 xml 序列化时，有没有办法解决以下构建错误？System.Xml.XmlSerialization 程序集出现同样的错误。

> 无法解决“System.Runtime.Serialization, Version=5.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e”和“System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089”之间的冲突。任意选择“System.Runtime.Serialization, Version=5.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:43:01.133

您可能在同一个应用程序中使用两个或多个版本的程序集。要解决此问题，您需要使用“别名”。

[查看此链接](http://msdn.microsoft.com/en-us/library/ms173212.aspx) 以了解 abt 别名。

或者，您可以使用应用程序或机器配置文件中的条目将程序集绑定引用重定向到程序集的另一个版本，使用`<bindingRedirect>`

[http://msdn.microsoft.com/en-us/library/2fc472t2.aspx](http://msdn.microsoft.com/en-us/library/2fc472t2.aspx)

# android - Eclipse 更新的备用位置

> ID：10210620
> 
> 赞同：0
> 
> 时间：2012-04-18T13:39:24.267
> 
> 标签：android, installation

我在 Eclipse 上安装了 Android-4.0.3。我想创建一个针对 2.1 的应用程序。为此，我需要更新适用于 Android-2.1 的 SDK。

问题是我的 C:\Program Files(x86)\Android 不能被网络管理员写入。是否可以在任何其他路径中安装更新的 Android SDK？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:53:11.107

对的，这是可能的。将所需的 Android SDK 安装到任何合适的位置并在 Eclipse 中修改 Android 首选项。

在 Eclipse 中，转到*Window* -> *Preferences* -> *Android*并更改*SDK Location*

# c++ - 如何将从 Ruby 数组中取出的字符串转换为 C/C++ 字符串

> ID：10210624
> 
> 赞同：1
> 
> 时间：2012-04-18T13:39:37.247
> 
> 标签：c++, ruby, ruby-c-extension

我正在为 Ruby 编写 C++ 扩展，并尝试从 Ruby 数组对象中提取 Ruby 字符串对象，并将其转换为 C/C++ 字符串对象。

我有**foo.cpp**：

```
#include <iostream>
#include <ruby.h>

VALUE bar_func(VALUE self, VALUE ary){
    std::string s = StringValuePtr(rb_ary_entry(ary, 0));
    ...
    return 0;
}

extern "C" VALUE rb_cFoo;
VALUE rb_cFoo;
extern "C" void Init_foo(){
    rb_cFoo = rb_define_class("Foo", rb_cObject);
    rb_define_singleton_method(rb_cFoo, "bar", RUBY_METHOD_FUNC(bar_func), 1);
} 
```

和**test.rb**：

```
require "foo"
Foo.bar(["Hello World!"]) 
```

当我尝试编译`foo.cpp`时，编译器返回一个错误，说*“一个术语和操作数需要左侧值”*（不是确切的消息。翻译自另一种自然语言中给出的错误消息）。这是关于我对`StringValuePtr`. 我做错了什么，如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:00:59.980

首先，[`StringValuePtr`不返回](https://github.com/ruby/ruby/blob/trunk/README.EXT#L122)适合[赋值运算符](http://www.cplusplus.com/reference/string/string/operator=/)的以空字符结尾的 C 字符串。您应该使用`StringValueCStr`宏，它也需要一个`VALUE`as 参数。

[`StringValueCStr`](https://github.com/ruby/ruby/blob/trunk/include/ruby/ruby.h#L472)定义如下：

```
#define StringValueCStr(v) rb_string_value_cstr(&(v)) 
```

[`rb_string_value_cstr`](https://github.com/ruby/ruby/blob/trunk/string.c#L1440)函数签名是：

```
char * rb_string_value_cstr(volatile VALUE *ptr) 
```

宏展开后，您的代码应如下所示：

```
std::string s = rb_string_value_cstr(&rb_ary_entry(ary, 0)); 
```

你的代码在我看来没有错。尝试将每个部分放在单独的行中，看看是否可以缩小错误的根源：

```
VALUE entry = rb_ary_entry(ary, 0);
char * c_str = StringValueCStr(entry);
std::string str = c_str; 
```

# java - 如何为项目重建和重启 gae 服务器？

> ID：10210625
> 
> 赞同：1
> 
> 时间：2012-04-18T13:39:41.693
> 
> 标签：java, eclipse, google-app-engine

我正在寻找一种方法来重建和重新启动项目的 gae 服务器以`localhost`在浏览器中查看它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:18:15.003

听起来您正在寻找开发服务器（python 中的 dev_appserver.py，有一个 Java 等价物，但我没有命令行）。它与 SDK 一起提供。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T18:28:18.670

要清理 localhost 数据存储，请删除`appengine-generated`war 目录下

# php - html中的子字符串

> ID：10210630
> 
> 赞同：2
> 
> 时间：2012-04-18T13:40:03.053
> 
> 标签：php, substring

```
<p style="color:red;font-size:12px;">This economy car is great value for money and with the added benefit of air conditioning is ideal for couples and small families. A ?500 excess applies which can be waived to NIL for only <b>5.00</b> per day</p> 
```

使用以下 2 种方法

```
substr($mytext,0,25); 
```

和

```
 $s = html_entity_decode($mytext);
 $sub = substr($s, 0, 50);� 
```

需要获得前 50 个字符...任何人请帮忙

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:55:10.547

您需要一个 HTML Paser，找到并读出纯文本并选择子字符串，这里有一个示例`DOMXpath`：

```
$doc = DOMDocument::loadHTML($html);
$xp = new DOMXPath($doc);
$chars50 = $xp->evaluate('substring(normalize-space(//body),1,50)'); 
```

[演示](http://codepad.viper-7.com/nYwemX)：

> 字符串(50)`"This economy car is great value for money and with"`

请注意，您将在此处获得一个 UTF-8 编码的字符串。您也可以使用正则表达式（这可能会[帮助您减少 words](https://stackoverflow.com/a/8494901/367456)）自己执行此操作，例如：

```
# load text from HTML
$text = DOMDocument::loadHTML($html)->getElementsByTagName('body')->item(0)->nodeValue;

# normalize HTML whitspace
$text = trim(preg_replace('/\s{1,}/u', ' ', $text));

# obtain the substring (here: UTF-8 safe operation, see as well mb_substr)
$chars50 = preg_replace('/^(.{0,50}).*$/u', '$1', $text); 
```

[演示](http://codepad.viper-7.com/FDyNBa)

如果您使用`strip_tags`而不是 HTML 解析器，则需要自己处理不同的编码。由于原始字符串已经具有表示 unicode 替换字符的问号，我会说您已经处理了 borked 数据，因此最好使用重新呈现的库[`DOMDocument`](http://php.net/DOMDocument)而`strip_tags`不是不安全的库（请参阅 PHP 上的警告手册页）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:43:07.747

希望这行得通...试试吧

```
echo (substr(strip_tags($mytext), 0, 25)); 
```

[http://www.ideone.com/6TgJX](http://www.ideone.com/6TgJX)

# perl - nsql 查询后 Sybase::CTLib (Perl) 中的列（字段）名称

> ID：10210633
> 
> 赞同：1
> 
> 时间：2012-04-18T13:40:15.067
> 
> 标签：perl, sybase

我正在将与 Sybase 交互的 Perl 脚本从 DBLIB 数据库接口迁移到 CTLIB。DBLIB 和 CTLIB 都支持 nsql 方法。

在 DBLib 中，我可以使用 nsql 获取这样的列名 -

```
$qry = 'Select * from A';
@data = $dbh->nsql($qry,{});
$string = $dbh->dbcolname($colid) 
```

如何使用 nsql 获取 CTLib 中的列名？

```
$qry = 'Select * from A';
@data = $dbh->nsql($qry,"ARRAY");
#Replacement of dbcolname? 
```

如果我从 nsql 请求哈希而不是 ARRAY，则有一种方法可以获取列名。它们的哈希键是列名。但我只想通过 ARRAY 调用来获取字段名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:49:17.557

对于**DBI**，它是：

```
$sth = $dbh->prepare($query) or die "Prepare exception: $DBI::errstr";
$rv  = $sth->execute() or die "Execute exception: $DBI::errstr";
$res = $sth->fetchall_arrayref();                    

# Array reference with cols captions, which were retrived
$names = $sth->{NAME};          

# Array reference with types of cols, which were retrived         
$types = $sth->{TYPE};                               
$sth->finish(); 
```

* * *

对于**Sybase::CTlib**尝试 >>

`@names = $dbh->ct_col_names`

检索当前查询的列名。如果当前查询不是 select 语句，则返回一个空数组。

`@types = $dbh->ct_col_types([$doAssoc])`

检索当前正在执行的查询的列类型。如果 $doAssoc 不为 0，则返回带有列名/列类型对的哈希（也称为关联数组）。

* * *

`@dat = $dbh->dbnextrow([$doAssoc [, $wantRef]])`

检索一行。dbnextrow() 返回一个标量数组，每个列值一个。如果 $doAssoc 不为 0，则 dbnextrow() 返回一个带有**列名**/值对的哈希（也称为关联数组）。这使程序员不必调用 dbbind() 或 dbdata()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-12T14:37:33.120

在 CTlib 中没有本地方法可以做到这一点。唯一的解决方案是重写您自己的 NSQL 版本。可以从 CTLib 的源中分叉。

# razor - 使用 Tridion Razor 模板时发布 PDF

> ID：10210636
> 
> 赞同：6
> 
> 时间：2012-04-18T13:40:32.363
> 
> 标签：razor, tridion, razor-mediator

我在使用 Razor 模板从 Tridion 发布二进制文件（PDF 文件）时遇到问题。

我有一个组件模板，它设置为“发布为动态组件”，带有一个链接的多媒体模式。

我正在使用[Razor Mediator eXtension](https://www.sdltridionworld.com/community/2011_extensions/razormediator.aspx)，组件模板包含两个模板构建块：

1.  一个 Razor 模板，输出一些 HTML 和多媒体组件中二进制文件的链接。
2.  默认完成操作 TBB 包含以下内容：
    *   在包中发布二进制文件
    *   链接解析器
    *   目标群体个性化
    *   清理模板
    *   将 Xml 转换为 Html

Razor 模板包含以下代码（我已经稍微简化了）： ![在此处输入图像描述](../Images/1f6f8fdb6d2a7690690d096f81b2589e.png)

这似乎可以正确解析二进制链接并生成以下动态组件表示： ![在此处输入图像描述](../Images/037e9cfb99501599383a8a5b355afebc.png)

我遇到的问题是二进制文件本身从未添加到包中，因此不会被发布。

由于 Razor 调解器在 Tridion.ContentManager.config 文件中有一个“extractBinaries”设置，因此我怀疑二进制文件应该由调解器添加到包中。我已确保将 extractBinaries 设置设置为“true”，但是二进制文件并未添加到包中（尽管正在处理的多媒体组件作为 tridion/组件项在包上）。

有谁知道此功能是否可用并在 Razor Mediator 中工作？[我怀疑 Razor Mediator 期望链接代码采用特定格式，但我在文档](http://code.google.com/p/razor-mediator-4-tridion/downloads/detail?name=RazorMediatorDocumentation_v1.2.docx&can=2&q=)中找不到任何内容。

我还尝试将“从 Html 中提取二进制文件”TBB 添加到组件模板（遵循 Razor 模板），但出现以下错误： *“项目输出必须具有指定的属性 TCMURI”*。我怀疑这是由于 Razor Mediator 将“输出”项目添加到包中的方式。

我可以编写一个新的 TBB 以确保将二进制文件添加到包中，但如果 R​​azor Mediator 已经提供了该功能，我宁愿避免这样做。

提前致谢。

PS 为图片道歉。Stackoverflow 不想正确格式化代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T13:06:37.090

不幸的是，Razor Mediator 目前没有在标签中将 PDF 二进制文件添加到包中（因此不会被 Publish Binaries TBB 拾取），尽管我有一种很好的感觉，1.3 版会处理这个问题；） .

同时，您可以使用“添加未解决的二进制依赖项”类型的 TBB。我目前手头没有它，但如果你需要它，请告诉我，我会在今晚晚些时候为你发布代码。

**编辑** 取消我关于它没有被添加到包中的声明，我在想一个不同的场景。

请尝试以下操作：

```
<a href="@Component.ID">@Component.Metadata.title</a> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T15:35:09.260

这对我有用：

```
@{ 
  var item = TridionHelper.Package.CreateMultimediaItem(Component.ID);
  TridionHelper.Package.PushItem("CurrentMultimedia", item);
} 
```

紧随其后的当然是 PublishBinariesInPackage，尽管您也可以以类似的方式访问引擎，也许直接的 AddBinary 也可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:55:50.330

我没有使用过 Razor Mediator，但您是否尝试将TBB`Default Finish Actions`或`Publish Binaries in Package`TBB 添加到您的模板中？

# ruby-on-rails - 为什么我们需要在 Rails 中选择命名范围或范围？

> ID：10210638
> 
> 赞同：2
> 
> 时间：2012-04-18T13:40:33.013
> 
> 标签：ruby-on-rails, ruby

我们可以编写一个类方法，而不是命名范围或范围。

前任：

```
def self.desc
  <code>
end 
```

为什么我们要使用范围？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:48:40.270

您可以使用这两种方法。但是通过方法，当您的范围代码增长时，它会更具可读性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T14:00:13.957

我们当然可以编写像作用域一样工作的类方法。当我们没有 arel 可玩时，它们也有点像 Rails 2.x 的遗留物。

对我来说，范围是一种像关联一样“定义”模型的方式。作用域使定义这些东西变得更好、更清晰，它们通常位于顶部，因此您可以一目了然地看到模型。

我发现当我需要开始传递参数时，我倾向于使用类方法。是的，有一种方法可以做到这一点，但实际上你开始需要一个类方法（特别是如果有可选参数，尽管我相信 Ruby 1.9 在某种程度上解决了这个问题）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T12:32:34.137

[named_scope 很棒，它使您的代码更具可读性，您还可以结合 named_scope 查找器来做复杂的查找器](http://rails-bestpractices.com/posts/14-love-named_scope)

[Rails 中命名作用域的意义是什么？](https://stackoverflow.com/questions/2919730/whats-the-significance-of-named-scope-in-rails)

# model-view-controller - 我应该测试我的控制器（MVC）吗？

> ID：10210640
> 
> 赞同：20
> 
> 时间：2012-04-18T13:40:37.417
> 
> 标签：model-view-controller, controller, mocking, tdd, integration-testing

我已经使用 TDD 几个月了，现在我想学习如何测试我的控制器 (MVC)。

单元测试是通过测试每个功能的最小单元来进行的。有时，控制器并不小。他们从模型中获取数据，然后传递给视图。

我应该如何对控制器进行单元测试？我应该模拟控制器的依赖项吗？

控制器测试是否被视为集成测试？

谢谢你。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-18T13:55:55.460

我做 TDD 很长时间了。我用 ASP.NET MVC 做 TDD 已经一年多了。

我从规范规则开始：“没有单元测试就没有代码行”，所以我测试了所有东西——包括控制器。控制器必须经过测试，这是 MVC 框架的目标之一 - 使这些东西可测试。

对于小型应用程序，这种方法非常有效。几乎所有的逻辑都放在控制器中，一切都经过了很好的测试。

但只要我继续使用 MVC，我就开始改变主意。我尽量让控制器保持纤薄。理想情况下，仅将调用委托给某个业务对象并包装结果。剩下的就是过滤器了。

这对我也很有效！我现在拥有单独实现/测试的业务对象，因此控制器只是集成点。没有理由测试集成点，因为它很小。

关于集成测试：我还没有遇到我真正需要的情况。不要忘记，控制器总是依赖于构造函数注入的抽象。只要您对这些抽象如何工作有“好的”假设，您就可以创建适当的单元测试。当您失败时，您只需更正单元测试。

集成测试很重要也很有用，但我尝试尽可能少地创建这些测试。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-18T14:07:02.473

我对控制器采用与 Alexander B 相同的方法。我的控制器又薄又笨。但是，我仍然为它们编写测试，以确保它们正确调用业务或服务对象并传递正确的参数。

我上周终于发现的一个实际错误可能最好地说明了这一点。我有一个控制器，允许经理批准或拒绝来自用户的请求，它有两个视图，一个未完成请求的列表视图和一个每个请求的详细信息视图。两种视图都可以批准或拒绝。控制器调用的服务有许多其他公开的方法，包括一个用于更改请求状态的方法……您可以看到它的去向。列表视图调用正确的方法来批准或拒绝并触发工作流，详细视图只调用更改状态方法，并没有启动任何进一步的工作流。这是我的编码错误，但在我的一生中，我很久都看不到它了——工作流在后台线程中运行，我花了一周的时间在这些线程中运行，假设这是该部分中的错误。

所以对我来说

*   一旦您的控制器将数据传递到其他地方，它就需要测试。
*   如果您的控制器检查模型有效性，则需要进行测试（如果有人删除了检查怎么办？）

等等

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T13:44:07.200

昨天问了同样的问题：

[测试控制器有意义吗](https://stackoverflow.com/questions/10196935/does-it-make-sense-to-test-controllers/)

在我看来 - 是的，测试控制器确实有意义。你可以：

*   在它们后面模拟服务，因此只测试控制器本身更容易
*   不模拟服务并进行集成测试

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-22T11:27:17.200

要为您的控制器开发*单元测试*，自然的方法是模拟控制器所依赖的接口（它控制的“事物”，我们称它们为`IControllable`s）。然后您可以验证控制器是否以预期的方式操作受控对象。

如果控制器和受控对象之间的交互很复杂，那么专门的*集成测试*可能是有意义的。例如，可能有一系列类实现`IControllable`——这些实现中的每一个都能与控制器很好地协同工作吗？也许多个不同`IControllables`的会交互（使用相同的资源）？或者`IControllables`可能有一些棘手的方法来配置它们影响他们的行为？测试这一点的一种方法是编写一个可重用的测试套件，您可以在其中注入一系列可疑的`IControllable`实现或它们的组合。

最后但同样重要的是，TDD 也是关于*验收测试*的。因此，在进行 TDD 时，您还将进行高级端到端测试来执行最终用户会识别的场景。最有可能的是，这些也将锻炼控制器——以这种方式也测试你的控制器和（某些）类之间的正确集成。

# java - Http Servlet 请求在读取一次后从 POST 正文中丢失参数

> ID：10210645
> 
> 赞同：98
> 
> 时间：2012-04-18T13:40:50.460
> 
> 标签：java, servlets, parameters, httprequest, servlet-filters

我正在尝试访问 Java Servlet 过滤器中的两个 http 请求参数，这里没有什么新东西，但惊讶地发现这些参数已经被使用了！因此，它在过滤器链中不再可用。

似乎这只发生在参数进入 POST 请求正文（例如表单提交）时。

有没有办法读取参数而不消耗它们？

到目前为止，我只找到了这个参考：[Servlet Filter using request.getParameter lost Form data](http://restlet-discuss.1400322.n2.nabble.com/Servlet-Filter-using-request-getParameter-loses-Form-data-td2141035.html)。

谢谢！

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2013-06-16T00:50:27.520

顺便说一句，解决这个问题的另一种方法是不使用过滤器链，而是构建自己的拦截器组件，也许使用方面，它可以对解析的请求体进行操作。它也可能更有效，因为您只需将请求`InputStream`转换为您自己的模型对象一次。

但是，我仍然认为希望多次读取请求正文是合理的，特别是当请求通过过滤器链时。我通常会将过滤器链用于我想保留在 HTTP 层的某些操作，与服务组件分离。

正如[Will Hartung](https://stackoverflow.com/a/10211289/551467)所建议的那样，我通过扩展`HttpServletRequestWrapper`、使用请求`InputStream`并基本上缓存字节来实现这一点。

```
public class MultiReadHttpServletRequest extends HttpServletRequestWrapper {
  private ByteArrayOutputStream cachedBytes;

  public MultiReadHttpServletRequest(HttpServletRequest request) {
    super(request);
  }

  @Override
  public ServletInputStream getInputStream() throws IOException {
    if (cachedBytes == null)
      cacheInputStream();

      return new CachedServletInputStream();
  }

  @Override
  public BufferedReader getReader() throws IOException{
    return new BufferedReader(new InputStreamReader(getInputStream()));
  }

  private void cacheInputStream() throws IOException {
    /* Cache the inputstream in order to read it multiple times. For
     * convenience, I use apache.commons IOUtils
     */
    cachedBytes = new ByteArrayOutputStream();
    IOUtils.copy(super.getInputStream(), cachedBytes);
  }

  /* An inputstream which reads the cached request body */
  public class CachedServletInputStream extends ServletInputStream {
    private ByteArrayInputStream input;

    public CachedServletInputStream() {
      /* create a new input stream from the cached request body */
      input = new ByteArrayInputStream(cachedBytes.toByteArray());
    }

    @Override
    public int read() throws IOException {
      return input.read();
    }
  }
} 
```

现在可以通过在将原始请求传递给过滤器链之前包装原始请求来多次读取请求正文：

```
public class MyFilter implements Filter {
  @Override
  public void doFilter(ServletRequest request, ServletResponse response,
        FilterChain chain) throws IOException, ServletException {

    /* wrap the request in order to read the inputstream multiple times */
    MultiReadHttpServletRequest multiReadRequest = new MultiReadHttpServletRequest((HttpServletRequest) request);

    /* here I read the inputstream and do my thing with it; when I pass the
     * wrapped request through the filter chain, the rest of the filters, and
     * request handlers may read the cached inputstream
     */
    doMyThing(multiReadRequest.getInputStream());
    //OR
    anotherUsage(multiReadRequest.getReader());
    chain.doFilter(multiReadRequest, response);
  }
} 
```

此解决方案还允许您通过方法多次读取请求正文，`getParameterXXX`因为底层调用`getInputStream()`当然会读取缓存的请求`InputStream`。

**编辑**

对于较新版本的`ServletInputStream`界面。您需要提供更多方法的实现，例如`isReady`等。请参阅下面评论中提供的`setReadListener`这个[问题。](https://stackoverflow.com/a/30748533/3503187)

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2016-08-25T20:33:47.513

我知道我迟到了，但这个问题对我来说仍然很重要，而且这篇 SO 帖子是谷歌的热门文章之一。我将继续发布我的解决方案，希望其他人可以节省几个小时。

就我而言，我需要用他们的身体记录所有请求和响应。使用 Spring Framework 答案其实很简单，只需使用[ContentCachingRequestWrapper](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/util/ContentCachingRequestWrapper.html "内容缓存请求包装器")和[ContentCachingResponseWrapper](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/util/ContentCachingResponseWrapper.html "内容缓存响应包装器")。

```
import org.springframework.web.util.ContentCachingRequestWrapper;
import org.springframework.web.util.ContentCachingResponseWrapper;

import javax.servlet.*;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

public class LoggingFilter implements Filter {

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {

    }

    @Override
    public void destroy() {

    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
            throws IOException, ServletException {

        ContentCachingRequestWrapper requestWrapper = new ContentCachingRequestWrapper((HttpServletRequest) request);
        ContentCachingResponseWrapper responseWrapper = new ContentCachingResponseWrapper((HttpServletResponse) response);

        try {
            chain.doFilter(requestWrapper, responseWrapper);
        } finally {

            String requestBody = new String(requestWrapper.getContentAsByteArray());
            String responseBody = new String(responseWrapper.getContentAsByteArray());
            // Do not forget this line after reading response content or actual response will be empty!
            responseWrapper.copyBodyToResponse();

            // Write request and response body, headers, timestamps etc. to log files

        }

    }

} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-01-18T17:04:20.483

因此，这基本上是 Lathy 的答案，但已针对 ServletInputStream 的新要求进行了更新。

即（对于 ServletInputStream），必须实现：

```
public abstract boolean isFinished();

public abstract boolean isReady();

public abstract void setReadListener(ReadListener var1); 
```

这是编辑后的 ​​Lathy 的对象

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import javax.servlet.ServletInputStream;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletRequestWrapper;

public class RequestWrapper extends HttpServletRequestWrapper {

    private String _body;

    public RequestWrapper(HttpServletRequest request) throws IOException {
        super(request);
        _body = "";
        BufferedReader bufferedReader = request.getReader();
        String line;
        while ((line = bufferedReader.readLine()) != null){
            _body += line;
        }
    }

    @Override
    public ServletInputStream getInputStream() throws IOException {

        CustomServletInputStream kid = new CustomServletInputStream(_body.getBytes());
        return kid;
    }

    @Override
    public BufferedReader getReader() throws IOException {
        return new BufferedReader(new InputStreamReader(this.getInputStream()));
    }
} 
```

在某个地方（？？）我发现了这个（这是处理“额外”方法的一流课程。

```
import javax.servlet.ReadListener;
import javax.servlet.ServletInputStream;
import java.io.IOException;
import java.io.UnsupportedEncodingException;

public class CustomServletInputStream extends ServletInputStream {

    private byte[] myBytes;

    private int lastIndexRetrieved = -1;
    private ReadListener readListener = null;

    public CustomServletInputStream(String s) {
        try {
            this.myBytes = s.getBytes("UTF-8");
        } catch (UnsupportedEncodingException ex) {
            throw new IllegalStateException("JVM did not support UTF-8", ex);
        }
    }

    public CustomServletInputStream(byte[] inputBytes) {
        this.myBytes = inputBytes;
    }

    @Override
    public boolean isFinished() {
        return (lastIndexRetrieved == myBytes.length - 1);
    }

    @Override
    public boolean isReady() {
        // This implementation will never block
        // We also never need to call the readListener from this method, as this method will never return false
        return isFinished();
    }

    @Override
    public void setReadListener(ReadListener readListener) {
        this.readListener = readListener;
        if (!isFinished()) {
            try {
                readListener.onDataAvailable();
            } catch (IOException e) {
                readListener.onError(e);
            }
        } else {
            try {
                readListener.onAllDataRead();
            } catch (IOException e) {
                readListener.onError(e);
            }
        }
    }

    @Override
    public int read() throws IOException {
        int i;
        if (!isFinished()) {
            i = myBytes[lastIndexRetrieved + 1];
            lastIndexRetrieved++;
            if (isFinished() && (readListener != null)) {
                try {
                    readListener.onAllDataRead();
                } catch (IOException ex) {
                    readListener.onError(ex);
                    throw ex;
                }
            }
            return i;
        } else {
            return -1;
        }
    }
}; 
```

最终，我只是想记录请求。上面的 frankensteined 碎片帮助我创建了下面的。

```
import java.io.IOException;
import java.io.UnsupportedEncodingException;
import java.security.Principal;
import java.util.Enumeration;
import java.util.LinkedHashMap;
import java.util.Map;

import javax.servlet.FilterChain;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.commons.io.IOUtils;

//one or the other based on spring version
//import org.springframework.boot.autoconfigure.web.ErrorAttributes;
import org.springframework.boot.web.servlet.error.ErrorAttributes;

import org.springframework.core.Ordered;
import org.springframework.http.HttpStatus;
import org.springframework.stereotype.Component;
import org.springframework.web.context.request.ServletRequestAttributes;
import org.springframework.web.context.request.WebRequest;
import org.springframework.web.filter.OncePerRequestFilter;

/**
 * A filter which logs web requests that lead to an error in the system.
 */
@Component
public class LogRequestFilter extends OncePerRequestFilter implements Ordered {

    // I tried apache.commons and slf4g loggers.  (one or the other in these next 2 lines of declaration */
    //private final static org.apache.commons.logging.Log logger = org.apache.commons.logging.LogFactory.getLog(LogRequestFilter.class);
    private static final org.slf4j.Logger logger = org.slf4j.LoggerFactory.getLogger(LogRequestFilter.class);

    // put filter at the end of all other filters to make sure we are processing after all others
    private int order = Ordered.LOWEST_PRECEDENCE - 8;
    private ErrorAttributes errorAttributes;

    @Override
    public int getOrder() {
        return order;
    }

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)
            throws ServletException, IOException {

        String temp = ""; /* for a breakpoint, remove for production/real code */

        /* change to true for easy way to comment out this code, remove this if-check for production/real code */
        if (false) {
            filterChain.doFilter(request, response);
            return;
        }

        /* make a "copy" to avoid issues with body-can-only-read-once issues */
        RequestWrapper reqWrapper = new RequestWrapper(request);

        int status = HttpStatus.INTERNAL_SERVER_ERROR.value();
        // pass through filter chain to do the actual request handling
        filterChain.doFilter(reqWrapper, response);
        status = response.getStatus();

        try {
            Map<String, Object> traceMap = getTrace(reqWrapper, status);
            // body can only be read after the actual request handling was done!
            this.getBodyFromTheRequestCopy(reqWrapper, traceMap);

            /* now do something with all the pieces of information gatherered */
            this.logTrace(reqWrapper, traceMap);
        } catch (Exception ex) {
            logger.error("LogRequestFilter FAILED: " + ex.getMessage(), ex);
        }
    }

    private void getBodyFromTheRequestCopy(RequestWrapper rw, Map<String, Object> trace) {
        try {
            if (rw != null) {
                byte[] buf = IOUtils.toByteArray(rw.getInputStream());
                //byte[] buf = rw.getInputStream();
                if (buf.length > 0) {
                    String payloadSlimmed;
                    try {
                        String payload = new String(buf, 0, buf.length, rw.getCharacterEncoding());
                        payloadSlimmed = payload.trim().replaceAll(" +", " ");
                    } catch (UnsupportedEncodingException ex) {
                        payloadSlimmed = "[unknown]";
                    }

                    trace.put("body", payloadSlimmed);
                }
            }
        } catch (IOException ioex) {
            trace.put("body", "EXCEPTION: " + ioex.getMessage());
        }
    }

    private void logTrace(HttpServletRequest request, Map<String, Object> trace) {
        Object method = trace.get("method");
        Object path = trace.get("path");
        Object statusCode = trace.get("statusCode");

        logger.info(String.format("%s %s produced an status code '%s'. Trace: '%s'", method, path, statusCode,
                trace));
    }

    protected Map<String, Object> getTrace(HttpServletRequest request, int status) {
        Throwable exception = (Throwable) request.getAttribute("javax.servlet.error.exception");

        Principal principal = request.getUserPrincipal();

        Map<String, Object> trace = new LinkedHashMap<String, Object>();
        trace.put("method", request.getMethod());
        trace.put("path", request.getRequestURI());
        if (null != principal) {
            trace.put("principal", principal.getName());
        }
        trace.put("query", request.getQueryString());
        trace.put("statusCode", status);

        Enumeration headerNames = request.getHeaderNames();
        while (headerNames.hasMoreElements()) {
            String key = (String) headerNames.nextElement();
            String value = request.getHeader(key);
            trace.put("header:" + key, value);
        }

        if (exception != null && this.errorAttributes != null) {
            trace.put("error", this.errorAttributes
                    .getErrorAttributes((WebRequest) new ServletRequestAttributes(request), true));
        }

        return trace;
    }
} 
```

请对此代码持保留态度。

最重要的“测试”是 POST 是否与有效负载一起使用。这将暴露“双重阅读”问题。

伪示例代码

```
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("myroute")
public class MyController {
    @RequestMapping(method = RequestMethod.POST, produces = "application/json")
    @ResponseBody
    public String getSomethingExample(@RequestBody MyCustomObject input) {

        String returnValue = "";

        return returnValue;
    }
} 
```

如果您只想测试，可以将“MyCustomObject”替换为普通的 ole“Object”。

这个答案是从几个不同的 SOF 帖子和示例中得出的 frankensteined。但是花了一段时间才将它们整合在一起，所以我希望它对未来的读者有所帮助。

请在我之前支持 Lathy 的回答。没有它，我不可能走到这一步。

以下是我在解决这个问题时遇到的一个/一些例外情况。

> 已经为此请求调用了 getReader()

看起来我“借来”的一些地方在这里：

[http://slackspace.de/articles/log-request-body-with-spring-boot/](http://slackspace.de/articles/log-request-body-with-spring-boot/)

[https://github.com/c0nscience/spring-web-logging/blob/master/src/main/java/org/zalando/springframework/web/logging/LoggingFilter.java](https://github.com/c0nscience/spring-web-logging/blob/master/src/main/java/org/zalando/springframework/web/logging/LoggingFilter.java)

[https://howtodoinjava.com/servlets/httpservletrequestwrapper-example-read-request-body/](https://howtodoinjava.com/servlets/httpservletrequestwrapper-example-read-request-body/)

[https://www.oodlestechnologies.com/blogs/How-to-create-duplicate-object-of-httpServletRequest-object](https://www.oodlestechnologies.com/blogs/How-to-create-duplicate-object-of-httpServletRequest-object)

[https://github.com/c0nscience/spring-web-logging/blob/master/src/main/java/org/zalando/springframework/web/logging/LoggingFilter.java](https://github.com/c0nscience/spring-web-logging/blob/master/src/main/java/org/zalando/springframework/web/logging/LoggingFilter.java)

2021 年 1 月附录。

我已经学会了上述代码不起作用的艰难方式

> x-www-form-urlencoded

考虑下面的例子：

```
 @CrossOrigin
    @ResponseBody
    @PostMapping(path = "/mypath", consumes = {MediaType.APPLICATION_FORM_URLENCODED_VALUE})
    public ResponseEntity myMethodName(@RequestParam Map<String, String> parameters
    ) {
        /* DO YOU GET ANY PARAMETERS HERE?  Or are they empty because of logging/auditing filter ?*/
        return new ResponseEntity(HttpStatus.OK);

    } 
```

我必须在这里查看其他几个示例。

我想出了一个明确适用于 APPLICATION_FORM_URLENCODED_VALUE 的“包装器”

```
import org.apache.commons.io.IOUtils;
import org.springframework.http.MediaType;
import org.springframework.web.util.ContentCachingRequestWrapper;

import javax.servlet.ServletInputStream;
import javax.servlet.http.HttpServletRequest;
import java.io.IOException;

/**
 * Makes a "copy" of the HttpRequest so the body can be accessed more than 1 time.
 * WORKS WITH APPLICATION_FORM_URLENCODED_VALUE
 * See : https://stackoverflow.com/questions/44182370/why-do-we-wrap-httpservletrequest-the-api-provides-an-httpservletrequestwrappe/44187955#44187955
 */
public final class AppFormUrlEncodedSpecificContentCachingRequestWrapper extends ContentCachingRequestWrapper {

    public static final String ERROR_MSG_CONTENT_TYPE_NOT_SUPPORTED = "ContentType not supported. (Input ContentType(s)=\"%1$s\", Supported ContentType(s)=\"%2$s\")";

    public static final String ERROR_MSG_PERSISTED_CONTENT_CACHING_REQUEST_WRAPPER_CONSTRUCTOR_FAILED = "AppFormUrlEncodedSpecificContentCachingRequestWrapper constructor failed";

    private static final org.slf4j.Logger LOGGER = org.slf4j.LoggerFactory.getLogger(AppFormUrlEncodedSpecificContentCachingRequestWrapper.class);

    private byte[] body;

    private ServletInputStream inputStream;

    public AppFormUrlEncodedSpecificContentCachingRequestWrapper(HttpServletRequest request) {
        super(request);
        super.getParameterMap(); // init cache in ContentCachingRequestWrapper.  THIS IS THE VITAL CALL so that "@RequestParam Map<String, String> parameters" are populated on the REST Controller.  See https://stackoverflow.com/questions/10210645/http-servlet-request-lose-params-from-post-body-after-read-it-once/64924380#64924380

        String contentType = request.getContentType();
        /* EXPLICTLY check for APPLICATION_FORM_URLENCODED_VALUE and allow nothing else */
        if (null == contentType || !contentType.equalsIgnoreCase(MediaType.APPLICATION_FORM_URLENCODED_VALUE)) {
            IllegalArgumentException ioex = new IllegalArgumentException(String.format(ERROR_MSG_CONTENT_TYPE_NOT_SUPPORTED, contentType, MediaType.APPLICATION_FORM_URLENCODED_VALUE));
            LOGGER.error(ERROR_MSG_PERSISTED_CONTENT_CACHING_REQUEST_WRAPPER_CONSTRUCTOR_FAILED, ioex);
            throw ioex;
        }

        try {
            loadBody(request);
        } catch (IOException ioex) {
            throw new RuntimeException(ioex);
        }
    }

    private void loadBody(HttpServletRequest request) throws IOException {
        body = IOUtils.toByteArray(request.getInputStream());
        inputStream = new CustomServletInputStream(this.getBody());
    }

    private byte[] getBody() {
        return body;
    }

    @Override
    public ServletInputStream getInputStream() throws IOException {
        if (inputStream != null) {
            return inputStream;
        }
        return super.getInputStream();
    }
} 
```

请注意 Andrew Sneck 在同一页面上的回答。差不多就是这样：[https ://programmersought.com/article/23981013626/](https://programmersought.com/article/23981013626/)

我没有时间协调上述两个实现（我的两个）。

所以我创建了一个工厂来从两者中“选择”：

```
import org.springframework.http.MediaType;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletRequestWrapper;
import java.io.IOException;

/**
 * Factory to return different concretes of HttpServletRequestWrapper. APPLICATION_FORM_URLENCODED_VALUE needs a different concrete.
 */
public class HttpServletRequestWrapperFactory {

    public static final String ERROR_MSG_HTTP_SERVLET_REQUEST_WRAPPER_FACTORY_CREATE_HTTP_SERVLET_REQUEST_WRAPPER_FAILED = "HttpServletRequestWrapperFactory createHttpServletRequestWrapper FAILED";

    public static HttpServletRequestWrapper createHttpServletRequestWrapper(final HttpServletRequest request) {
        HttpServletRequestWrapper returnItem = null;

        if (null != request) {
            String contentType = request.getContentType();
            if (null != contentType && contentType.equalsIgnoreCase(MediaType.APPLICATION_FORM_URLENCODED_VALUE)) {
                returnItem = new AppFormUrlEncodedSpecificContentCachingRequestWrapper(request);
            } else {
                try {
                    returnItem = new PersistedBodyRequestWrapper(request);
                } catch (IOException ioex) {
                    throw new RuntimeException(ERROR_MSG_HTTP_SERVLET_REQUEST_WRAPPER_FACTORY_CREATE_HTTP_SERVLET_REQUEST_WRAPPER_FAILED, ioex);
                }
            }
        }

        return returnItem;
    }

} 
```

下面是与 JSON 等一起使用的“其他”。它是工厂可以输出的另一种具体。我把它放在这里是为了让我的 Jan 2021 APPEND 保持一致。我不知道下面的代码是否与我的原始答案完全一致：

```
import org.springframework.http.MediaType;

import javax.servlet.ServletInputStream;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletRequestWrapper;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.nio.charset.StandardCharsets;
import java.util.Map;

/**
 * Makes a "copy" of the HttpRequest so the body can be accessed more than 1 time.
 * See : https://stackoverflow.com/questions/44182370/why-do-we-wrap-httpservletrequest-the-api-provides-an-httpservletrequestwrappe/44187955#44187955
 * DOES NOT WORK WITH APPLICATION_FORM_URLENCODED_VALUE
 */
public final class PersistedBodyRequestWrapper extends HttpServletRequestWrapper {

    public static final String ERROR_MSG_CONTENT_TYPE_NOT_SUPPORTED = "ContentType not supported. (ContentType=\"%1$s\")";

    public static final String ERROR_MSG_PERSISTED_BODY_REQUEST_WRAPPER_CONSTRUCTOR_FAILED = "PersistedBodyRequestWrapper constructor FAILED";

    private static final org.slf4j.Logger LOGGER = org.slf4j.LoggerFactory.getLogger(PersistedBodyRequestWrapper.class);

    private String persistedBody;

    private final Map<String, String[]> parameterMap;

    public PersistedBodyRequestWrapper(final HttpServletRequest request) throws IOException {
        super(request);

        String contentType = request.getContentType();
        /* Allow everything EXCEPT APPLICATION_FORM_URLENCODED_VALUE */
        if (null != contentType && contentType.equalsIgnoreCase(MediaType.APPLICATION_FORM_URLENCODED_VALUE)) {
            IllegalArgumentException ioex = new IllegalArgumentException(String.format(ERROR_MSG_CONTENT_TYPE_NOT_SUPPORTED, MediaType.APPLICATION_FORM_URLENCODED_VALUE));
            LOGGER.error(ERROR_MSG_PERSISTED_BODY_REQUEST_WRAPPER_CONSTRUCTOR_FAILED, ioex);
            throw ioex;
        }

        parameterMap = request.getParameterMap();
        this.persistedBody = "";
        BufferedReader bufferedReader = request.getReader();
        String line;
        while ((line = bufferedReader.readLine()) != null) {
            this.persistedBody += line;
        }
    }

    @Override
    public ServletInputStream getInputStream() throws IOException {
        CustomServletInputStream csis = new CustomServletInputStream(this.persistedBody.getBytes(StandardCharsets.UTF_8));
        return csis;
    }

    @Override
    public BufferedReader getReader() throws IOException {
        return new BufferedReader(new InputStreamReader(this.getInputStream()));
    }

    @Override
    public Map<String, String[]> getParameterMap() {
        return this.parameterMap;
    }
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-04-14T10:09:38.343

以上答案非常有帮助，但在我的经验中仍然存在一些问题。在 tomcat 7 servlet 3.0 上，getParamter 和 getParamterValues 也必须被覆盖。这里的解决方案包括get-query参数和post-body。它允许轻松获取原始字符串。

与其他解决方案一样，它使用 Apache commons-io 和 Googles Guava。

在此解决方案中，getParameter* 方法不会抛出 IOException，但它们使用可能抛出 IOException 的 super.getInputStream()（获取主体）。我抓住它并抛出 runtimeException。这不是很好。

```
import com.google.common.collect.Iterables;
import com.google.common.collect.ObjectArrays;

import org.apache.commons.io.IOUtils;
import org.apache.http.NameValuePair;
import org.apache.http.client.utils.URLEncodedUtils;
import org.apache.http.entity.ContentType;

import java.io.BufferedReader;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.nio.charset.Charset;
import java.util.Collections;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.ServletInputStream;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletRequestWrapper;

/**
 * Purpose of this class is to make getParameter() return post data AND also be able to get entire
 * body-string. In native implementation any of those two works, but not both together.
 */
public class MultiReadHttpServletRequest extends HttpServletRequestWrapper {
    public static final String UTF8 = "UTF-8";
    public static final Charset UTF8_CHARSET = Charset.forName(UTF8);
    private ByteArrayOutputStream cachedBytes;
    private Map<String, String[]> parameterMap;

    public MultiReadHttpServletRequest(HttpServletRequest request) {
        super(request);
    }

    public static void toMap(Iterable<NameValuePair> inputParams, Map<String, String[]> toMap) {
        for (NameValuePair e : inputParams) {
            String key = e.getName();
            String value = e.getValue();
            if (toMap.containsKey(key)) {
                String[] newValue = ObjectArrays.concat(toMap.get(key), value);
                toMap.remove(key);
                toMap.put(key, newValue);
            } else {
                toMap.put(key, new String[]{value});
            }
        }
    }

    @Override
    public ServletInputStream getInputStream() throws IOException {
        if (cachedBytes == null) cacheInputStream();
        return new CachedServletInputStream();
    }

    @Override
    public BufferedReader getReader() throws IOException {
        return new BufferedReader(new InputStreamReader(getInputStream()));
    }

    private void cacheInputStream() throws IOException {
    /* Cache the inputStream in order to read it multiple times. For
     * convenience, I use apache.commons IOUtils
     */
        cachedBytes = new ByteArrayOutputStream();
        IOUtils.copy(super.getInputStream(), cachedBytes);
    }

    @Override
    public String getParameter(String key) {
        Map<String, String[]> parameterMap = getParameterMap();
        String[] values = parameterMap.get(key);
        return values != null && values.length > 0 ? values[0] : null;
    }

    @Override
    public String[] getParameterValues(String key) {
        Map<String, String[]> parameterMap = getParameterMap();
        return parameterMap.get(key);
    }

    @Override
    public Map<String, String[]> getParameterMap() {
        if (parameterMap == null) {
            Map<String, String[]> result = new LinkedHashMap<String, String[]>();
            decode(getQueryString(), result);
            decode(getPostBodyAsString(), result);
            parameterMap = Collections.unmodifiableMap(result);
        }
        return parameterMap;
    }

    private void decode(String queryString, Map<String, String[]> result) {
        if (queryString != null) toMap(decodeParams(queryString), result);
    }

    private Iterable<NameValuePair> decodeParams(String body) {
        Iterable<NameValuePair> params = URLEncodedUtils.parse(body, UTF8_CHARSET);
        try {
            String cts = getContentType();
            if (cts != null) {
                ContentType ct = ContentType.parse(cts);
                if (ct.getMimeType().equals(ContentType.APPLICATION_FORM_URLENCODED.getMimeType())) {
                    List<NameValuePair> postParams = URLEncodedUtils.parse(IOUtils.toString(getReader()), UTF8_CHARSET);
                    params = Iterables.concat(params, postParams);
                }
            }
        } catch (IOException e) {
            throw new IllegalStateException(e);
        }
        return params;
    }

    public String getPostBodyAsString() {
        try {
            if (cachedBytes == null) cacheInputStream();
            return cachedBytes.toString(UTF8);
        } catch (UnsupportedEncodingException e) {
            throw new RuntimeException(e);
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }

    /* An inputStream which reads the cached request body */
    public class CachedServletInputStream extends ServletInputStream {
        private ByteArrayInputStream input;

        public CachedServletInputStream() {
            /* create a new input stream from the cached request body */
            input = new ByteArrayInputStream(cachedBytes.toByteArray());
        }

        @Override
        public int read() throws IOException {
            return input.read();
        }
    }

    @Override
    public String toString() {
        String query = dk.bnr.util.StringUtil.nullToEmpty(getQueryString());
        StringBuilder sb = new StringBuilder();
        sb.append("URL='").append(getRequestURI()).append(query.isEmpty() ? "" : "?" + query).append("', body='");
        sb.append(getPostBodyAsString());
        sb.append("'");
        return sb.toString();
    }
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-04-18T14:16:07.947

唯一的方法是您自己在过滤器中使用整个输入流，从中获取您想要的内容，然后为您读取的内容创建一个新的 InputStream，并将该 InputStream 放入 ServletRequestWrapper（或 HttpServletRequestWrapper）。

缺点是您必须自己解析有效负载，该标准并未使您可以使用该功能。

附录——

正如我所说，您需要查看 HttpServletRequestWrapper。

在过滤器中，您继续调用 FilterChain.doFilter(request, response)。

对于普通过滤器，请求和响应与传入过滤器的请求和响应相同。不一定是这样。您可以用您自己的请求和/或响应替换它们。

HttpServletRequestWrapper 是专门为实现这一点而设计的。您将原始请求传递给它，然后您可以拦截所有调用。您创建自己的子类，并用您自己的方法替换 getInputStream 方法。您无法更改原始请求的输入流，因此您拥有此包装器并返回您自己的输入流。

最简单的情况是将原始请求输入流消耗到字节缓冲区中，对它做任何你想做的事情，然后从该缓冲区创建一个新的 ByteArrayInputStream。这是您的包装器中返回的内容，它被传递给 FilterChain.doFilter 方法。

您需要继承 ServletInputStream 并为您的 ByteArrayInputStream 创建另一个包装器，但这也不是什么大问题。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-08-05T11:36:37.743

我也有同样的问题，我相信下面的代码更简单，它对我有用，

```
public class MultiReadHttpServletRequest extends  HttpServletRequestWrapper {

 private String _body;

public MultiReadHttpServletRequest(HttpServletRequest request) throws IOException {
   super(request);
   _body = "";
   BufferedReader bufferedReader = request.getReader();           
   String line;
   while ((line = bufferedReader.readLine()) != null){
       _body += line;
   }
}

@Override
public ServletInputStream getInputStream() throws IOException {
   final ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(_body.getBytes());
   return new ServletInputStream() {
       public int read() throws IOException {
           return byteArrayInputStream.read();
       }
   };
}

@Override
public BufferedReader getReader() throws IOException {
   return new BufferedReader(new InputStreamReader(this.getInputStream()));
}
} 
```

在过滤器java类中，

```
HttpServletRequest properRequest = ((HttpServletRequest) req);
MultiReadHttpServletRequest wrappedRequest = new MultiReadHttpServletRequest(properRequest);
req = wrappedRequest;
inputJson = IOUtils.toString(req.getReader());
System.out.println("body"+inputJson); 
```

如果您有任何疑问，请告诉我

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-11-20T05:39:21.287

我为任何格式的请求正文找到了很好的解决方案。我进行了测试`application/x-www-form-urlencoded`，`application/json`两者都工作得很好。该问题`ContentCachingRequestWrapper`仅适用于`x-www-form-urlencoded`请求正文，但不适用于例如 json。我找到了 json [link](https://programmersought.com/article/23981013626/)的解决方案。它有麻烦，它不支持`x-www-form-urlencoded`。我在我的代码中加入了两者：

```
import org.apache.commons.io.IOUtils;
import org.springframework.web.util.ContentCachingRequestWrapper;

import javax.servlet.ReadListener;
import javax.servlet.ServletInputStream;
import javax.servlet.http.HttpServletRequest;
import java.io.BufferedReader;
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStreamReader;

public class MyContentCachingRequestWrapper extends ContentCachingRequestWrapper {

    private byte[] body;

    public MyContentCachingRequestWrapper(HttpServletRequest request) throws IOException {
        super(request);
        super.getParameterMap(); // init cache in ContentCachingRequestWrapper
        body = super.getContentAsByteArray(); // first option for application/x-www-form-urlencoded
        if (body.length == 0) {
          try {
            body = IOUtils.toByteArray(super.getInputStream()); // second option for other body formats
          } catch (IOException ex) {
            body = new byte[0];
          }
        }
    }

    public byte[] getBody() {
        return body;
    }

    @Override
    public ServletInputStream getInputStream() {
        return new RequestCachingInputStream(body);
    }

    @Override
    public BufferedReader getReader() throws IOException {
        return new BufferedReader(new InputStreamReader(getInputStream(), getCharacterEncoding()));
    }

    private static class RequestCachingInputStream extends ServletInputStream {

        private final ByteArrayInputStream inputStream;

        public RequestCachingInputStream(byte[] bytes) {
            inputStream = new ByteArrayInputStream(bytes);
        }

        @Override
        public int read() throws IOException {
            return inputStream.read();
        }

        @Override
        public boolean isFinished() {
            return inputStream.available() == 0;
        }

        @Override
        public boolean isReady() {
            return true;
        }

        @Override
        public void setReadListener(ReadListener readlistener) {
        }

    }

} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-02-26T12:33:46.233

Spring 对此具有内置支持`AbstractRequestLoggingFilter`：

```
@Bean
public Filter loggingFilter(){
    final AbstractRequestLoggingFilter filter = new AbstractRequestLoggingFilter() {
        @Override
        protected void beforeRequest(final HttpServletRequest request, final String message) {

        }

        @Override
        protected void afterRequest(final HttpServletRequest request, final String message) {

        }
    };

    filter.setIncludePayload(true);
    filter.setIncludeQueryString(false);
    filter.setMaxPayloadLength(1000000);

    return filter;
} 
```

不幸的是，您仍然无法直接从请求中读取有效负载，但字符串消息参数将包含有效负载，因此您可以从那里获取它，如下所示：

`String body = message.substring(message.indexOf("{"), message.lastIndexOf("]"));`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-09-25T08:54:50.783

只是覆盖`getInputStream()`在我的情况下不起作用。我的服务器实现似乎在不调用此方法的情况下解析参数。我没有找到任何其他方法，但也重新实现了所有四个 getParameter* 方法。以下是`getParameterMap`（使用 Apache Http Client 和 Google Guava 库）的代码：

```
@Override
public Map<String, String[]> getParameterMap() {
    Iterable<NameValuePair> params = URLEncodedUtils.parse(getQueryString(), NullUtils.UTF8);

    try {
        String cts = getContentType();
        if (cts != null) {
            ContentType ct = ContentType.parse(cts);
            if (ct.getMimeType().equals(ContentType.APPLICATION_FORM_URLENCODED.getMimeType())) {
                List<NameValuePair> postParams = URLEncodedUtils.parse(IOUtils.toString(getReader()), NullUtils.UTF8);
                params = Iterables.concat(params, postParams);
            }
        }
    } catch (IOException e) {
        throw new IllegalStateException(e);
    }
    Map<String, String[]> result = toMap(params);
    return result;
}

public static Map<String, String[]> toMap(Iterable<NameValuePair> body) {
    Map<String, String[]> result = new LinkedHashMap<>();
    for (NameValuePair e : body) {
        String key = e.getName();
        String value = e.getValue();
        if (result.containsKey(key)) {
            String[] newValue = ObjectArrays.concat(result.get(key), value);
            result.remove(key);
            result.put(key, newValue);
        } else {
            result.put(key, new String[] {value});
        }
    }
    return result;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-08-27T14:03:46.603

如果您可以控制请求，则可以将内容类型设置为**binary/octet-stream**。这允许在不消耗输入流的情况下查询参数。

但是，这可能特定于某些应用程序服务器。我只测试了tomcat，根据[https://stackoverflow.com/a/11434646/957103](https://stackoverflow.com/a/11434646/957103) ，码头的行为似乎相同。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-12-20T22:33:17.557

Spring类ContentCachingRequestWrapper的getContentAsByteArray()方法会多次读取body，但是同一个类的getInputStream()和getReader()方法不会多次读取body：

“这个类通过消费InputStream来缓存请求体。如果我们在其中一个过滤器中读取了InputStream，那么过滤器链中的其他后续过滤器就不能再读取它了。由于这个限制，这个类并不适合所有情况。”

在我的情况下，解决此问题的更通用解决方案是将以下三个类添加到我的 Spring boot 项目（以及 pom 文件所需的依赖项）：

CachedBodyHttpServletRequest.java：

```
public class CachedBodyHttpServletRequest extends HttpServletRequestWrapper {

    private byte[] cachedBody;

    public CachedBodyHttpServletRequest(HttpServletRequest request) throws IOException {
        super(request);
        InputStream requestInputStream = request.getInputStream();
        this.cachedBody = StreamUtils.copyToByteArray(requestInputStream);
    }

    @Override
    public ServletInputStream getInputStream() throws IOException {
        return new CachedBodyServletInputStream(this.cachedBody);
    }

    @Override
    public BufferedReader getReader() throws IOException {
        // Create a reader from cachedContent
        // and return it
        ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(this.cachedBody);
        return new BufferedReader(new InputStreamReader(byteArrayInputStream));
    }
} 
```

CachedBodyServletInputStream.java：

```
public class CachedBodyServletInputStream extends ServletInputStream {

    private InputStream cachedBodyInputStream;

    public CachedBodyServletInputStream(byte[] cachedBody) {
        this.cachedBodyInputStream = new ByteArrayInputStream(cachedBody);
    }

    @Override
    public boolean isFinished() {
        try {
            return cachedBodyInputStream.available() == 0;
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        return false;
    }

    @Override
    public boolean isReady() {
        return true;
    }

    @Override
    public void setReadListener(ReadListener readListener) {
        throw new UnsupportedOperationException();
    }

    @Override
    public int read() throws IOException {
        return cachedBodyInputStream.read();
    }
} 
```

内容缓存过滤器.java：

```
@Order(value = Ordered.HIGHEST_PRECEDENCE)
@Component
@WebFilter(filterName = "ContentCachingFilter", urlPatterns = "/*")
public class ContentCachingFilter extends OncePerRequestFilter {

    @Override
    protected void doFilterInternal(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, FilterChain filterChain) throws ServletException, IOException {
        System.out.println("IN  ContentCachingFilter ");
        CachedBodyHttpServletRequest cachedBodyHttpServletRequest = new CachedBodyHttpServletRequest(httpServletRequest);
        filterChain.doFilter(cachedBodyHttpServletRequest, httpServletResponse);
    }
} 
```

我还在 pom 中添加了以下依赖项：

```
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-webmvc</artifactId>
    <version>5.2.0.RELEASE</version>
</dependency>
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>javax.servlet-api</artifactId>
    <version>4.0.1</version>
</dependency>
<dependency>
    <groupId>com.fasterxml.jackson.core</groupId>
    <artifactId>jackson-databind</artifactId>
    <version>2.10.0</version>
</dependency> 
```

教程和完整的源代码位于此处： [https ://www.baeldung.com/spring-reading-httpservletrequest-multiple-times](https://www.baeldung.com/spring-reading-httpservletrequest-multiple-times)

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2013-06-30T01:48:14.223

您可以使用 servlet 过滤器链，但使用原始过滤器链，您可以创建自己的请求 yourownrequests extends HttpServletRequestWrapper。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2016-12-23T16:46:41.647

首先，我们不应该读取过滤器中的参数。通常在过滤器中读取标头以执行少量身份验证任务。话虽如此，使用 CharStreams 可以在 Filter 或 Interceptor 中完全读取 HttpRequest 正文：

```
String body = com.google.common.io.CharStreams.toString(request.getReader()); 
```

这根本不影响后续的读取。

# mysql - MySQL大表与ORM后面的文本列

> ID：10210649
> 
> 赞同：0
> 
> 时间：2012-04-18T13:41:01.557
> 
> 标签：mysql, text, orm, normalize

对于是否将包含文本列的大型（数百 K 条记录）表分成 2 个表，有点进退两难。

有问题的表存储新闻文章：

```
CREATE TABLE `article` (
  `id` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,
  `articleType` varchar(7) DEFAULT NULL,
  `dateCreated` datetime NOT NULL,
  `label` varchar(75) NOT NULL,
  `lastUpdated` datetime NOT NULL,
  `reporter` mediumint(8) unsigned NOT NULL,
  `text` text NOT NULL
  PRIMARY KEY (`id`),
  KEY `reporter-fk` (`reporter`),
  CONSTRAINT `reporter-fk` FOREIGN KEY (`reporter`) REFERENCES `reporter` (`id`)
) 
```

因此，重要的是，在直接 SQL 中，当您想要获取头条新闻（最新消息）时，您将获取您想要的列（id、label、dateCreated）并排除您不想要的列（尤其是臃肿的文本列）

然而，在使用 ORM 时，会获取一个包含*所有列*的对象，因此抓取 50 篇最新文章会产生一些开销，也许不是很大，但足以让我有点畏缩。在编写直接 SQL 时，永远不要在这种情况下获取所有字段。

鉴于 ORM 的现实，我应该将文本列分成一个单独的相关表，还是不打扰，只需使用 ORM 抓取整个 enchilada 约定并在站点流量需要更高效的 2 表解决方案时担心它?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:56:13.450

通常，我说不要过早优化。

但是，在这种情况下，我现在将其打破，因为已经有这样做的论据。您可能正在显示文章标题列表而不显示正文。为什么不将正文放在与文章关联的自己的表/类中？

似乎文章标题和文章正文已经是两个独立的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T14:08:48.470

您使用的是特定的 ORM，还是自己开发的？如果您使用 Propel，请将列设置为*延迟加载*- 然后它将在显式请求时加载，而不是与对象的其余部分一起加载。如果没有，那么看看你的 ORM 是否支持这个，或者内置它。

# javascript - 为什么表格中的 valign 与 TEXTAREA 一起使用不好？

> ID：10210650
> 
> 赞同：1
> 
> 时间：2012-04-18T13:41:04.097
> 
> 标签：javascript, jquery, css, html-table

```
<table border="1" style="height:200px">
  <tr>
    <th>Month</th>
    <th>Savings</th>
  </tr>
  <tr>
    <td valign="top">January<textarea></textarea></td>
    <td valign="bottom">$100</td>
  </tr>

</table> 
```

[http://jsfiddle.net/BCsN2/](http://jsfiddle.net/BCsN2/)

一月应该与顶部文本区域相同。我怎样才能做到？也许用 jQuery？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:43:08.400

只需添加

```
textarea { vertical-align: top } 
```

见小提琴： http: [//jsfiddle.net/BCsN2/5/](http://jsfiddle.net/BCsN2/5/)
而不是`valign`用作`<td>`属性，而是`vertical-align`用作样式属性

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:58:18.703

您可以再使用一个嵌套表。这可能是最简单的方法（不需要 JS）。唯一的问题是，您很可能需要为这个嵌套表指定一些额外的 CSS 规则（样式）。所以它不会从父级继承任何东西。

```
<table border="1" style="height:200px">
  <tr>
    <th>Month</th>
    <th>Savings</th>
  </tr>
  <tr>
    <td valign="top">
      <table>
        <tr>
          <td valign="middle">January</td>
          <td valign="middle"><textarea></textarea></td>
        </tr>
      </table>
    </td>
    <td valign="bottom">$100</td>
  </tr>    
</table> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T14:00:23.740

这是第一个解决方案，将其拆分为 2 个单元格。不要忘记将 colspan 添加到上述单元格中。

```
<table border="1" style="height:200px">
  <tr>
    <th colspan="2">Month</th> <!-- add colspan="2" -->
    <th>Savings</th>
  </tr>
  <tr>
    <td valign="top">January</td> <!-- split it to 2 cells (#1) -->
    <td valign="top"><textarea></textarea></td> <!-- split it to 2 cells (#2) -->
    <td valign="bottom">$100</td>
  </tr>
</table> 
```

这是第二个解决方案，使用 CSS：

```
<table border="1" style="height:200px">
  <tr>
    <th>Month</th>
    <th>Savings</th>
  </tr>
  <tr>
    <td valign="top">
        <span style="float: left">January</span> <!-- wrap it in span and add CSS float -->
        <textarea style="float: left"></textarea> <!-- add CSS float -->
    </td>
    <td valign="bottom">$100</td>
  </tr>
</table> 
```

# jquery - 为什么 Internet Explorer 不使用 multipart/form 和 AJAX 帖子返回 HTTP 200？

> ID：10210652
> 
> 赞同：0
> 
> 时间：2012-04-18T13:41:07.763
> 
> 标签：jquery, forms, file-upload, ajaxform

我正在尝试使用 multipart/form-data HTML 表单将文件上传到 servlet。我正在使用 jQuery 和 ajaxForm 插件。在响应返回时，会检查 HTTP 状态代码是什么。在 servlet 成功的 Chrome 和 Firefox 中，HTTP 代码是正确的 200。

在 Internet Explorer 中，每当我将 enctype 设置为 multipart/form-data 时，就会出现 HTTP 响应代码为 0 且 readystate 未定义。

请参见以下示例：

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.js"></script>
<script src="http://malsup.github.com/jquery.form.js"></script>
<script>
(function() {
// prepare the form when the DOM is ready 
$(document).ready(function() { 

    var options = { 
        target:        '#status',   
        success:       onSuccess  
    }; 

    // bind form using 'ajaxForm' 
    $('#myForm').ajaxForm(options); 
}); 
function onSuccess(responseText, statusText, xhr, $form)  { 
    alert('HTTP Status: ' + xhr.status + '\r\nReadyState: ' + xhr.readyState); 
} 

})();       
</script>
</head>
<body >
    <div>
        <form id="myForm" action="htmlFormTest.jsp" method="post" enctype="multipart/form-data">
           Sample Text: <input type="text" name ="sample" id="sample" value="sample" />
            <input type="submit" value="Go!">
        </form>
    </div>

     <div id="status"></div>
</body>
</html> 
```

如果我有一个“正常”的形式，它工作正常......似乎只是多部分。此外，使用 Wireshark 和 HTTPWatch，我可以看到实际的 HTTP 响应是 200 并且工作正常。当我在 Wireshark 中比较 IE 和 Firefox 时，实际的 HTTP 数据包是相同的。

被难住了……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T15:16:58.080

我之前也遇到过同样的问题，结果发现文件在磁盘上，如果您遇到同样的情况，那么通过将其放在 Web 服务器上来测试页面。

参考： [http ://www.pearweb.com/javascript/XMLHttpRequest.html](http://www.pearweb.com/javascript/XMLHttpRequest.html)

# java - 使用 Java 客户端和 JBoss Webervices 实现推送类型的技术

> ID：10210663
> 
> 赞同：3
> 
> 时间：2012-04-18T13:41:54.673
> 
> 标签：java, jboss5.x, jbossws

这个问题更多地基于设计细节而不是特定的编程问题。我希望SO上的人不要介意这样的问题。

我正在设计一个具有两个广泛组件的应用程序。

组件 1 -> 托管在云中的中央服务器，使用 JBoss 5.1.0 服务器。我们希望在我们在这里寻求的解决方案中使用该基础设施。我们将此解决方案基于 JBossW 并使用基于 POJO 的 Web 服务。

组件 2 -> 是一个远程部署的 Java Client，负责收集数据。

我们目前有一个架构，客户端轮询服务器以获取配置详细信息，然后指示客户端何时开始收集数据（以及其他内务处理任务）。一旦客户端收到响应，它就会相应地配置自己。

这支持预定的数据采集，当数据采集时间到来时，如接收到的配置中指定的，客户端启动数据采集过程，然后将结果上传到服务器。

这里可能成为问题的一种情况是，当配置更改时，此更改到达客户端时不可避免地会延迟，直到客户端在下一次轮询之后收到新配置为止。为了避免这种情况，我们希望在这里实现某种“推送”技术，类似于“<a href="http://en.wikipedia.org/wiki/Comet_%28programming%29" rel="nofollow" >Comet”在基于 Web 的应用程序中。

有没有人实现过类似的东西，或者他们有任何可以分享的设计见解？我们注意到，我们有一个更重量级的解决方案，涉及从云到客户端的入站请求，但这更适合具有 DMZ 设施和其他适当安全措施的大型企业部署。

问题：

1.  JBossWS 是合适的 WebService 引擎吗？从我们所读到的内容来看，它似乎很受重视，并且仍然是事实上的标准。
2.  有什么框架可以帮助实现基于“客户端推送”的解决方案，用于与 JBossWS 和基于 Java 的客户端进行通信？
3.  在设计/实现此类应用程序时，我们应该考虑哪些具体案例或场景？
4.  任何此类应用程序可以基于的开源框架？如果我们可以选择，我们使用并为开源计划做出贡献？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:49:13.763

我将看看 Servlet 3 规范中的[异步处理](http://www.javaworld.com/javaworld/jw-02-2009/jw-02-servlet3.html)能力。对于 JBoss，我会特别关注[事件驱动的 servlet](http://docs.jboss.org/jbossweb/latest/aio.html)技术。

# c# - 带有 RestSharp 文件上传的 OutOfMemoryException

> ID：10210671
> 
> 赞同：0
> 
> 时间：2012-04-18T13:42:16.107
> 
> 标签：c#, restsharp

我正在使用 RestSharp 实现一个简单的文件上传桌面工具。当我使用自定义流编写器将大文件添加到请求中（以将上传进度更新到 gui）时，`stream.Write`会引发 OutOfMemoryException。简化代码示例：

```
...
var request = new RestRequest { Resource = "/test" };
request.Method = Method.POST;
request.AddFile("file", writer, "largefile.iso");

var response = client.Execute(request);
...

private void writer(Stream stream)
{
    using (FileStream reader = File.OpenRead("d:\\download\\largefile.iso"))
    {
      byte[] buffer = new byte[16384]; //16k buffer
      int bytesRead = 0;
      int read = 0;

      while ((read = reader.Read(buffer, 0, buffer.Length)) > 0)
      {
        stream.Write(buffer, 0, read);
        bytesRead += read;
        System.Diagnostics.Debug.WriteLine("uploading: " + (int) ((double)bytesRead / reader.Length * 100) + "%");
      }
      reader.Close();
    }

} 
```

这适用于小文件，但流写入会泄漏内存，最终崩溃。有什么我在这里想念的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:50:12.920

也许您应该在每次写入后尝试刷新流缓冲区：

```
private void writer(Stream stream)
    {
        using (FileStream reader = File.OpenRead("d:\\download\\largefile.iso"))
        {
            byte[] buffer = new byte[16384]; //16k buffer
            int bytesRead = 0;
            int read = 0;

            while ((read = reader.Read(buffer, 0, buffer.Length)) > 0)
            {
                stream.Write(buffer, 0, read);
                stream.Flush();
                bytesRead += read;
                System.Diagnostics.Debug.WriteLine("uploading: " + (int)((double)bytesRead / reader.Length * 100) + "%");
            }
            reader.Close();
        }

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:03:05.440

在挖掘 RestSharp 资源后自己解决了这个问题。 [http://support.microsoft.com/kb/908573](http://support.microsoft.com/kb/908573)

# .net - 无法加载文件或程序集或其依赖项之一。访问被拒绝

> ID：10210672
> 
> 赞同：1
> 
> 时间：2012-04-18T13:42:18.787
> 
> 标签：.net, windows-services, windows-server-2008

现在我决定寻求一些帮助。在对我的问题进行了 2 天的调查后，我无法找到任何解决方案。也许我在这里会更幸运！

所以这是我的问题：

在我们的生产服务器（Windows Server 2008）上，我们有一个 Windows 服务正在运行，它负责自动运行一些作业。这些作业可通过 Web 应用程序进行配置，并允许用户执行以下操作： - 创建具有一个或多个任务（顺序任务）的作业 - 定义作业计划（每天、每月……） - 手动运行任务

当服务找到要运行的作业时，它会从数据库中检索信息并按顺序执行每个任务。为了执行任务，服务实例化一个对象对应的任务并执行它（不同类型的任务可用并位于不同的程序集中）

在我失败的情况下：

*   执行位于 ComponentsA.Tasks.dll 中的 Task1。=> 成功
*   在Task1中，位于ModuleA.Logic.dll中的MethodA()被调用=>success
*   在 MethodA() 中，位于 ModuleA.Data.dll 中的 GetData() 被调用 => FAILED

此时我检索到以下错误消息：

```
Could not load file or assembly ‘ModuleA.Data.dll’ or one of its dependencies. Access is denied. 
```

融合日志结束显示：

```
*ERR: Setup failed with hr = 0x80070005.
 ERR: Failed to complete setup of assembly (hr = 0x80070005). Probing terminated.* 
```

所有 DLL 都位于服务安装文件夹的根目录中。权限似乎没问题（即使我使用管理员帐户运行该服务并将完全控制访问权限设置为我遇到问题的每个人）注意：我们仅从周五开始面临这个**关键问题。**之前一切正常。根据基础架构团队的说法，他们在服务器上没有任何改变……</p>

如果你们中的任何人有一个想法，这将节省我的一周。谢谢

干杯贝努瓦

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-11T02:59:39.870

想要发布其他人可能遇到的另一个案例：

我通过在 OSX 上压缩生产箱并在生产箱上解压缩来更新生产服务器。

解压缩文件后，文件在资源管理器窗口中被绘制为绿色，我最初忽略了它，但表示文件已加密。

将这些文件复制到生产网站会导致 E_ACCESSDENIED。解决方案是在移动之前取消加密 - 请参阅[https://superuser.com/questions/29424/what-do-green-folders-mean-in-windows-7-explorer](https://superuser.com/questions/29424/what-do-green-folders-mean-in-windows-7-explorer)。

一些背景：http: [//blogs.msdn.com/b/asklar/archive/2012/05/03/why-do-zip-files-from-mac-os-show-up-as-green-encrypted.aspx](http://blogs.msdn.com/b/asklar/archive/2012/05/03/why-do-zip-files-from-mac-os-show-up-as-green-encrypted.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T12:30:32.297

我成功删除了有问题的 DLL (ModuleA.Data.dll) 所在的文件夹并重新添加它，并使文件从其父级继承权限。不知道问题是什么，但这有效。

# c# - 从客户端错误消息中检测到潜在危险的 Request.Form 值是什么意思

> ID：10210673
> 
> 赞同：1
> 
> 时间：2012-04-18T13:42:20.910
> 
> 标签：c#, asp.net

我试图通过我的网络项目使用[自由文本框](http://freetextbox.com/)控件发送电子邮件。它是一个文本编辑器。但我有这个错误。

**从客户端检测到一个潜在危险的 Request.Form 值（FreeTextBox1="**你好，亲爱的**"）。** 我设置了 ValidateRequest=false 并设置了 isbodyHtml=true。但它不起作用。

我应该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:49:09.253

请看这个问题的答案：

[ValidateRequest="false" 在 Asp.Net 4 中不起作用](https://stackoverflow.com/questions/2673850/validaterequest-false-doesnt-work-in-asp-net-4)

这是 .net 4.0 中的一个变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:49:02.903

我以前有过这个。

您还需要添加到您的 web.config 文件中。

如果您将页面置于调试模式并阅读带有错误消息的文本，它会告诉您要添加什么以及在哪里添加它。我不记得 100% 为什么会发生错误，我认为这与回发页面内容有关，并且浏览器认为其中存在有害代码。

另请参阅： [从客户端检测到具有潜在危险的 Request.Form 值](https://stackoverflow.com/questions/81991/a-potentially-dangerous-request-form-value-was-detected-from-the-client)

和

[http://www.codeproject.com/Tips/297679/A-potentially-dangerous-Request-Form-value-was-det](http://www.codeproject.com/Tips/297679/A-potentially-dangerous-Request-Form-value-was-det)

以获得更完整的解释和解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T14:31:23.357

如果您正在运行 .NET 4.0，请将其添加到您的 web.config（在 system.web 下）

```
<httpRuntime requestValidationMode="2.0" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T13:42:26.383

FreeTexBox 控件和“从客户端检测到潜在危险的 Request.Form 值”

你可以尝试另一个决定

```
 if(!this.Page.ClientScript.IsOnSubmitStatementRegistered("Replace"))
{
 string script = @"if (Page_IsValid){FTB_API['" + txtBox.ClientID + @"'].initialized=false;   FTB_API['"  + txtBox.ClientID + @"'].htmlEditor.value=FTB_FreeTextBox.prototype.HtmlEncode( FTB_API['" + txtBox.ClientID + @"'].htmlEditor.value);}";
 this.Page.ClientScript.RegisterOnSubmitStatement(this.Page.GetType(), "Replace", script);
} 
```

当您将字符串从服务器发送到客户端应用程序时，不要忘记替换符号

```
if(!String.IsNullOrEmpty(yourstring)) txtBox.Text= yourstring.Replace("&gt;", ">").Replace("&lt;", "<").Replace("&amp;", "&").Replace("&quot;", ('"').ToString()).Replace("&#146;", "'"); 
```

# php - 如何避免 Codeigniter 在页面刷新时执行自动保存？

> ID：10210677
> 
> 赞同：1
> 
> 时间：2012-04-18T13:42:26.447
> 
> 标签：php, codeigniter, session, cookies

我正在为学校构建类似博客的小型系统。我需要在 cookie 中存储一些数据以及在 db 和 cookie 中保存会话。如果您在 config/config.php 上设置它以及在 config/autoload.php 中加载会话库，Codeigniter (CI) 会自行将会话保存在数据库和 cookie 中

目标：我需要在登录后在 cookie 中设置会话、电子邮件和用户名，然后再将其取回。杀死 cookie 和 cookie 上的所有 db 数据过期或注销。

问题：每次重新加载页面时，CI 都会在数据库中创建新的会话记录。哪个页面真的很重要，即使在刷新时它也会将新的插入到数据库中。

问题：我应该如何停止 CI 进行 autsave 并使其仅在登录后保存会话并在注销后终止会话？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T14:03:58.910

您是否使用这种确切的语法创建了会话 CI 表？我注意到它带来了许多问题。

```
--
-- Table structure for CodeIgniter ci_sessions.
--
DROP TABLE IF EXISTS `ci_sessions`;

CREATE TABLE IF NOT EXISTS  `ci_sessions` (
  `session_id`    varchar(40)           DEFAULT '0' NOT NULL,
  `ip_address`    varchar(16)           DEFAULT '0' NOT NULL,
  `user_agent`    varchar(120)                      NOT NULL,
  `last_activity` int(10)      unsigned DEFAULT 0   NOT NULL,
  `user_data`     text,
  PRIMARY KEY (`session_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci ;

-- -------------------------------------------------------------
--  `user_data` text,       COMMENT - maximum length of 65535 characters.
--  `user_data` mediumtext, COMMENT - maximum length of 16777215 characters.
--  `user_data` longtext,   COMMENT - maximum length of 4294967295 characters. 
```

# c# - 如果未在窗口中设置 RenderTargetBitmap 将呈现空控件（Visiblox 图表）

> ID：10210686
> 
> 赞同：0
> 
> 时间：2012-04-18T13:42:56.290
> 
> 标签：c#, wpf, binding, rendertargetbitmap, visiblox

我正在尝试将 Visiblox 图表呈现为图像，以便能够同时显示数百个。图表是在代码中生成并在不显示的情况下呈现的。

我面临的问题是图表在渲染后看起来是空的。上层控件是图表，下层是添加到控件之前渲染的图表。由于水印在那里，因此正在进行一些渲染。

使用绑定和数据上下文填充图表（以防万一）。在渲染之前查看图表看起来它实际上是空的，谢谢让我问“***用户控件何时检索绑定？*** ”。

这是我用来渲染图像的代码：

```
 public BitmapSource Render(FrameworkElement control)
    {
        if (control == null)
        {
            throw new ArgumentNullException("control");
        }

        control.UpdateLayout();

        Viewbox viewBox = new Viewbox();
        viewBox.Child = control; // Control to render
        viewBox.Measure(new System.Windows.Size(control.Width, control.Height));
        viewBox.Arrange(new Rect(0, 0, control.Width, control.Height));
        viewBox.ApplyTemplate();
        viewBox.UpdateLayout();

        RenderTargetBitmap renderer = new RenderTargetBitmap((int)(control.Width * _dpiX / 96.0), (int)(control.Height * _dpiY / 96.0), _dpiX, _dpiY, PixelFormats.Pbgra32);

        DrawingVisual drawingVisual = new DrawingVisual();
        using (DrawingContext drawingContext = drawingVisual.RenderOpen())
        {
            VisualBrush visualBrush = new VisualBrush(viewBox);
            drawingContext.DrawRectangle(visualBrush, null, new Rect(new Point(), new System.Windows.Size(control.Width, control.Height)));
        }

        renderer.Render(drawingVisual);

        // Remove the container to be able to reuse the control again if we appended it to a viewbox
        viewBox.Child = null;

        return renderer;
    } 
```

![在此处输入图像描述](../Images/f12518900b78b921ff1221d9b663eaf8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:46:11.597

如果您有兴趣将 Visiblox 图表保存到图像中，Visiblox 博客上有一些示例代码。你可以在这里找到这篇文章 - [http://www.visiblox.com/blog/2011/09/saving-a-chart-as-an-image](http://www.visiblox.com/blog/2011/09/saving-a-chart-as-an-image)

本文指导您如何在 Silverlight 中导出到图像，但下载包含一些示例代码，向您展示如何在 WPF 中执行此操作。

我以前在我的应用程序中使用过这种技术，我总是发现使用该示例代码是最好的起点！

如果它不适合你，请告诉我 - 我在这方面有很多经验！我的建议是确保您在正确的时间在图表上调用了 Invalidate()，并确保在尝试导出之前它的布局已经更新。

# c++ - 有没有办法删除 C 宏中的引号？

> ID：10210690
> 
> 赞同：17
> 
> 时间：2012-04-18T13:43:02.453
> 
> 标签：c++, c, macros, stringify

假设我想*取消字符串化*`"text"`应该转换为的宏参数`text`。

```
#define UN_STRINGIFY(x) /* some macro magic here */ 
```

现在调用这个宏`""`将从它的参数中删除

```
UN_STRINGIFY("text") // results in ----> text 
```

这将与宏字符串化相反：

```
#define STRINGIFY(x) #x 
```

这是可能的，还是我在玩宏观邪恶？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-18T13:44:11.643

这是不可能的。这可能是件好事：如果你传递一个字符串，你假设你可以把几乎所有东西都放进去。取消字符串化会突然导致编译器真正关心该字符串的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-06-02T12:18:06.570

我已经多次提出这个问题，但我仍然无法进入我的脑海。考虑这个例子：

```
#define FOO(x) x

// FOO( destringify("string x;"))   // no way

auto f = "string x;";
FOO(string x;)                      // hm whats the problem? 
```

对我来说，很明显应该可以删除引号。我的意思`string x;`是没有`"string x;"`引号。问题是：这是不可能的。我认为这没有技术原因，只能推测为什么没有方法可以做到这一点。

但是，我通过记住基本上所有预处理器所做的都是文本替换来说服自己，因此为什么在预处理器级别上要“去文本化”某些东西无论如何一切都只是文本。只是反过来做。当我将上面的示例更改为：

```
#define FOO(x) x
#define STR(x) STRSTR(x)
#define STRSTR(x) #x

#define STR_X string x;

auto f = STR(STR_X)
FOO(STR_X) 
```

那么就不需要去字符串化了。而且，如果您发现自己处于想要通过在编译时**之前未知的宏来对字符串进行反字符串化的情况，那么无论如何您都走错了路;)。**

# javascript - 如何在 Oracle ADF 中禁用浏览器后退按钮

> ID：10210693
> 
> 赞同：0
> 
> 时间：2012-04-18T13:43:16.123
> 
> 标签：javascript, oracle-adf

我知道。我不应该这样做。但...

我需要在 ADF Web 应用程序中禁用浏览器后退按钮。我已经尝试在 jspx 上的初始化 javascript 函数中使用此代码（我们可以调用 main.jspx）：

```
window.history.forward(1); 
```

后退按钮未被禁用，但如果我在访问主页后单击它（例如，从主页后的页面到主页），它会返回到第二页。我会完全禁用后退按钮。可能吗？如果您知道专门针对 ADF 应用程序的内容（也无需使用 javascript），欢迎您回答。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:41:58.310

这是解决方案：

我有两个页面：page1.jspx 和 page2.jspx。我在 adfc-config.xml 中定义了一个控制流案例：

```
<?xml version="1.0" encoding="windows-1252" ?>
<adfc-config xmlns="http://xmlns.oracle.com/adf/controller" version="1.2">
  <view id="page1">
    <page>/page1.jspx</page>
  </view>
  <view id="page2">
    <page>/page2.jspx</page>
  </view>
  <control-flow-rule id="__1">
    <from-activity-id>page1</from-activity-id>
    <control-flow-case id="__2">
      <from-outcome>navigate</from-outcome>
      <to-activity-id>page2</to-activity-id>
    </control-flow-case>
  </control-flow-rule>
</adfc-config> 
```

因此，`action="navigate"`我将从第 1 页导航到第 2 页。

现在 page1.jspx 是：

```
<?xml version='1.0' encoding='UTF-8'?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="2.1" xmlns:f="http://java.sun.com/jsf/core"
          xmlns:af="http://xmlns.oracle.com/adf/faces/rich">
    <jsp:directive.page contentType="text/html;charset=UTF-8"/>
    <f:view>
        <af:document title="Page 1" id="d1">
            <af:form id="f1">
                <af:panelStretchLayout id="psl1">
                    <f:facet name="center">
                        <af:commandLink action="navigate" id="cl1">
                            Navigate
                        </af:commandLink>
                    </f:facet>
                </af:panelStretchLayout>
                <af:resource type="javascript">
                    var registerDisableBackButton = function () {
                        disableBackButton();
                        window.onload = disableBackButton();
                        window.onpageshow = function (event) {
                            if (event.persisted) {
                                disableBackButton()
                            }
                        }
                        window.onunload = function () {
                            void (0);
                        }
                    }

                    var disableBackButton = function () {
                        window.history.forward();
                    }

                    var onLoadEvent = function(event) {
                        registerDisableBackButton();
                    }
                </af:resource>                
            </af:form>
            <af:clientListener method="onLoadEvent" type="load"/>
        </af:document>
    </f:view>
</jsp:root> 
```

导航到 page2.jspx 后，如果单击后退按钮，您将再次被重定向到页面 2。

希望这会有所帮助。

# jquery - 如何在声明中编写函数

> ID：10210695
> 
> 赞同：4
> 
> 时间：2012-04-18T13:43:17.057
> 
> 标签：jquery, fancybox

我试图让图像上的“alt”属性文本在使用fancybox时显示为标题

HTML

```
<a href='inlinePicture'........
   <img alt='Awesome text'......
</a 
```

查询

```
$('.inlinePicture').facybox({
  title: $(this).find('img').attr('alt')
}); 
```

问题是标题显示的是“$(this).find('img').attr('alt')”而不是“Awesome text”，我做错了什么？

我也试过：

```
$('.inlinePicture').facybox({
   titleFormat: function (title) {
        return $(this.orig).siblings('p').text() || title;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T13:45:18.163

尝试：

```
$('.inlinePicture').facybox({
  title: function() {
      return $(this).find('img').attr('alt');
  }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T14:09:17.607

对于fancyBox v2 -

```
$(".fancybox").fancybox({
    beforeLoad : function() {
        this.title = $(this.element).find('img').attr('alt');
    }
}); 
```

# facebook - Facebook API 和 cron

> ID：10210704
> 
> 赞同：0
> 
> 时间：2012-04-18T13:43:44.123
> 
> 标签：facebook, cron

我正在开发一个 Facebook 应用程序，其中有多个（约 200 个）页面，用户可以“喜欢”它们。基于喜欢，我创建了一个最佳页面表。

我正在使用 REST API 来获得这样的赞：

```
http://api.ak.facebook.com/restserver.php?v=1.0&method=links.getStats&format=json&urls=%%URL%% 
```

在一次调用中最多有 75 个 URL，如果总数超过 75，我会休眠（5）并进行下一次调用，直到所有 URL 都通过并收到响应。在我同步“喜欢”之后，就等于 db。理想情况下，此功能将每隔 5 分钟左右使用 cron 运行一次。

我的问题是，打这些电话的频率是合适的，如果我超过某种限制（如果有的话），Facebook 可以以任何方式限制这些电话吗？

欢迎任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:50:56.140

在[Facebook 平台政策](http://developers.facebook.com/policy/)中，它指出：

> 1.  如果您超过或计划超过以下任何阈值，请通过创建带有“阈值策略”标签的机密错误报告与我们联系，因为您可能需要遵守附加条款：(>5M MAU) 或 (>100M API 调用每天）或（每天 > 5000 万次展示）。

因此，如果您打算超出此范围，请与他们联系。

你为什么使用其余的api？它已被弃用，您应该切换到图形 api。此外，graph api 具有[批处理请求](http://developers.facebook.com/docs/reference/api/batch/)功能，可让您将 api 调用聚合到一个请求中。

* * *

# 编辑

您正在尝试做的事情（我认为）的等价物是使用[FQL](http://developers.facebook.com/docs/reference/fql/)表 [link_stat](http://developers.facebook.com/docs/reference/fql/link_stat/)。

就像是：

```
SELECT 
    share_count, 
    like_count, 
    comment_count, 
    total_count, 
    click_count 
FROM 
    link_stat 
WHERE 
    url="URL" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:48:41.347

老实说，我不确定 facebook 对使用他们的 REST api 有什么样的限制。我所知道的是 Facebook 正在弃用他们的 REST api。

来源：

“我们正在弃用 REST API。如果您正在构建新的 Facebook 应用程序，请使用 Graph API。虽然我们还没有移植一些功能，但 Graph API 是 Facebook 平台移动的中心向前，并在那里找到所有新功能。”

[https://developers.facebook.com/docs/reference/rest/](https://developers.facebook.com/docs/reference/rest/)

祝你的应用好运！

# hadoop - Hadoop MapReduce 提供嵌套目录作为作业输入

> ID：10210713
> 
> 赞同：22
> 
> 时间：2012-04-18T13:44:23.813
> 
> 标签：hadoop, nested, mapreduce, directory-walk

我正在从事一项处理嵌套目录结构的工作，其中包含多个级别的文件：

```
one/
├── three/
│   └── four/
│       ├── baz.txt
│       ├── bleh.txt
│       └── foo.txt
└── two/
    ├── bar.txt
    └── gaa.txt 
```

当我添加`one/`为输入路径时，不会处理任何文件，因为在根级别没有立即可用的文件。

我读到了`job.addInputPathRecursively(..)`，但这似乎在最近的版本中已被弃用（我使用的是 hadoop 1.0.2）。我编写了一些代码来遍历文件夹并添加每个目录`job.addInputPath(dir)`，这一直有效，直到由于某种原因尝试将目录作为输入文件处理时作业崩溃，例如 - 尝试`fs.open(split.getPath())`，何时`split.getPath()`是目录（这发生在里面`LineRecordReader.java`） .

我试图说服自己必须有一种更简单的方法来提供具有嵌套目录结构的作业。有任何想法吗？

**编辑**- 显然有一个[开放的错误](https://issues.apache.org/jira/browse/MAPREDUCE-3193)。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-13T06:57:02.163

我没有找到任何关于此的文件，但`*/*`有效。所以它是`-input 'path/*/*'`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-12-31T03:43:02.820

导入 org.apache.hadoop.mapreduce.lib.input.FileInputFormat；

FileInputFormat.setInputDirRecursive(job, true);

不用了，就叫我雷锋吧！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T17:31:57.543

我发现递归浏览数据可能很危险，因为可能存在来自 a`distcp`或类似文件的挥之不去的日志文件。让我提出一个替代方案：

在命令行上执行递归遍历，然后将路径以空格分隔的参数传递到 MapReduce 程序中。从以下位置获取列表`argv`：

```
$ hadoop jar blah.jar "`hadoop fs -lsr recursivepath | awk '{print $8}' | grep '/data.*\.txt' | tr '\n' ' '`" 
```

对不起，很长一段时间，但它完成了工作。您可以将事物包装在 bash 脚本中，以将事物分解为变量。

我个人喜欢使用传入文件路径的方法来编写我的 mapreduce 作业，因此代码本身没有硬编码的路径，而且我可以相对容易地将其设置为针对更复杂的文件列表运行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-12-04T12:46:40.073

不知道是否仍然相关，但至少在 hadoop 2.4.0 中，您可以将属性**mapreduce.input.fileinputformat.input.dir.recursive**设置为**true**，它将解决您的问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-27T21:49:48.237

只需使用 FileInputFormat.addInputPath("with file pattern"); 我正在编写我的第一个用于图形分析的 hadoop prog，其中输入来自 .gz 格式的 diff dir ...它对我有用！！！

# objective-c - 初始化时的内存泄漏消息

> ID：10210716
> 
> 赞同：1
> 
> 时间：2012-04-18T13:44:42.330
> 
> 标签：objective-c, memory-leaks

我收到一条罕见的消息，发生了什么事？

定义：

```
@property(nonatomic, retain) SoundPlayer* soundPlayer; 
```

代码：

```
SoundPlayer *soundPlayerTemp = [[SoundPlayer alloc] init];
self.soundPlayer = soundPlayerTemp;
[soundPlayerTemp release]; 
```

信息：

```
Potential leak of an object allocated on line 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:39:41.280

问题的最可能原因是您没有在 dealloc 方法中释放该属性。你应该有类似的东西：

```
-(void) dealloc
{
    self.soundPlayer = nil;
    [super dealloc];
} 
```

或者，如果您已经显式声明了一个实例变量来支持该属性，那么推荐的代码是

```
-(void) dealloc
{
    [soundPlayer release];
    [super dealloc];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:47:02.297

静态分析器充满误报；您的代码没有任何问题。您可以更简洁并使用以下内容摆脱消息：

```
self.soundPlayer = [[[SoundPlayer alloc] init] autorelease]; 
```

或者通过切换到 ARC，这也是一个很好的选择。

# php - 通知 Google 视频站点地图更新

> ID：10210717
> 
> 赞同：0
> 
> 时间：2012-04-18T13:44:47.023
> 
> 标签：php, unix, sitemap, ping

我在某处读到，您只需打开以下网址即可让 Google 了解您的站点地图的新增内容

```
http://www.google.com/webmasters/tools/ping?sitemap=http://www.mysite.com/sitemap.xml 
```

在 nix 服务器上的 php 脚本中执行此操作的最佳方法是什么？我也不需要 ping 的任何回复，我很确定 Google 不会被阻止并且它会可用。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:46:45.857

您可以编写一个简单的单行脚本`wget`来访问 URL ( `wget -qO- "http://..." >/dev/null`)，并将其放在 crontab 中，让它每 N 小时或几天运行一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-16T10:16:30.013

向以下 URL 发出请求：www.google.com/webmasters/tools/ping?sitemap=sitemap_url

使用 wget、curl 或您选择的其他机制发出 HTTP 请求。成功的请求将返回 HTTP 200 响应代码，如果您收到不同的响应，则应重新提交请求。

# ios - 错误“找不到此可执行文件的有效配置文件”

> ID：10210719
> 
> 赞同：4
> 
> 时间：2012-04-18T13:45:00.987
> 
> 标签：ios, iphone, xcode, ipad

我已经完成了 iPhone/iPad 游戏。我正在使用开发人员配置证书在 Xcode 中对其进行测试，一切正常，但现在我制作了分发证书。当我尝试使用分发证书测试我的游戏时，我收到一个错误“找不到此可执行文件的有效配置文件”，我可以将我的 iPad 添加到 prov。仅具有开发人员证书的配置文件。将来会不会是 Apple Reviewers 的问题？或者我不需要用于调试和测试的分发配置文件？如果你认为我是菜鸟，我很抱歉。我其实是。请帮我。

谢谢大家。我的问题得到了答案！

# sharepoint - 工作项计时器作业未触发

> ID：10210722
> 
> 赞同：1
> 
> 时间：2012-04-18T13:45:09.117
> 
> 标签：sharepoint, sharepoint-2010, timer-jobs

在我的站点 (SP2010) 中，我创建了一个触发器，通过 SPSite.AddWorkItem 方法将工作项添加到队列中。这似乎做得很好，因为 ScheduledWorkItems 表正在填充正确的数据。时间以 UTC 设置，是当前时间或过去时间。ID也都设置好了。所以该表具有所有正确的数据。

但是，从 SPWorkItemJobDefinition 派生的具有正确 ID 的自定义创建的工作项处理器永远不会被触发。添加工作项的 AppPool 用户也是场管理员。事件日志或共享点日志文件中没有与此进程相关的条目，因此它甚至没有被触发。

成功部署和触发工作项作业还有更多先决条件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:44:10.243

您需要为您的工作项作业定义创建一个正在运行的作业实例。工作项作业被安排为任何其他作业。请参阅[SPWorkItemJobDefinition 类](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.administration.spworkitemjobdefinition.aspx)：

> 作为派生工作项计时器作业定义的基类。此类与计时器作业 (SPTimerService) 一起处理工作项（SPWorkItem 实例）。[...] 这个类与 SPWorkItem 和 SPWorkItemCollection 类密切合作。您应该使用 SPSite 对象有权访问的集合类将工作项添加到处理队列。**当您的工作项计时器作业执行**时，[...]

我建议创建一个功能事件接收器并在功能激活的“事件”中创建作业实例：

```
SPWebApplication webApp = // ..;
SomeWorkItemJob = new SomeWorkItemJob("TheName", webApp);
job.Schedule = new SPMinuteSchedule { Interval = 2}; // every two minutes
job.Update(false); 
```

# c# - 为什么我（有时）必须引用我引用的程序集所引用的程序集？

> ID：10210729
> 
> 赞同：12
> 
> 时间：2012-04-18T13:45:28.460
> 
> 标签：c#, visual-studio-2010, c#-4.0, dependencies, .net-assembly

我有一个程序集 A 定义了一个带有一些重载的接口：

```
public interface ITransform
{
    Point InverseTransform(Point point);
    Rect InverseTransform(Rect value);
    System.Drawing.Point InverseTransform(System.Drawing.Point point);
} 
```

...以及引用 A（二进制文件，而不是项目）并调用其中一个重载的程序集 B：

```
var transform =
    (other.Source.TransformToDisplay != null &&
    other.Source.TransformToDisplay.Valid) ?
    other.Source.TransformToDisplay : null;
if (transform != null)
{
    e.Location = transform.InverseTransform(e.Location);
} 
```

准确地说，它调用了方法的`System.Windows.Point`重载`InverseTransform`，因为那是 中属性的`Location`类型`e`。

但是当我在 IDE 中构建 B 时，我得到：

> 错误 CS0012：“System.Drawing.Point”类型在未引用的程序集中定义。您必须添加对程序集“System.Drawing，Version=4.0.0.0，Culture=neutral，PublicKeyToken=b03f5f7f11d50a3a”的引用。

即使这甚至不是我打电话的超载。当我注释掉`InverseTransform`调用重载方法的行时，即使我仍在实例化类型的对象，它也可以正常构建`ITransform`。

为什么？有没有办法解决这个问题而不必在`System.Drawing`任何地方添加引用？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-18T13:47:46.463

编译器需要知道 a`System.Drawing.Point`是什么，以证明它不是正确的重载（例如，如果它有隐式转换）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T13:47:21.190

该方法利用`System.Drawing`. 如果您取消注释，则该程序集将不再尝试使用`System.Drawing`; 因此，没有要求。

这样想，当你去执行你的动作时，.NET 说好的，我正在调用这个程序集中定义的这个人，并寻找合适的代码来执行。它找不到它，所以它举起双手说我放弃了，你告诉我它在哪里。

只需养成引用您可能使用的每个 DLL 的习惯即可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T14:01:04.813

```
namespace ClassLibrary1
{
   public interface ITransform
   {
      dynamic InverseTransform(dynamic point);
   }
}

using ClassLibrary1;
using Moq;
namespace ConsoleApplication9
{
   interface IPoint { }
   class Point : IPoint { }

   class Program
   {
      static void Main(string[] args)
      {
         var transform = new Mock<ITransform>();
         IPoint x = transform.Object.InverseTransform(new Point());
      }
   }
} 
```

而不是告诉你你不能做什么......

解决此问题的方法需要引入 IPoint Transform(IPoint x) 作为接口中的唯一方法，以及 IPoint 接口。这意味着 System.Drawing 也必须遵守您的 IPoint。

如果您想要那种级别的解耦，那么您会想到动态关键字，因为您无法让 Drawing.Point 事后实现接口。只要确保对这部分代码有非常好的单元测试覆盖率，并期望它的执行速度会慢一些。

这样，您只需在实际使用它的程序集中引用 System.Drawing。

**EDIT** Reflector 说 System.Drawing.Point 的签名是

```
[Serializable, StructLayout(LayoutKind.Sequential), TypeConverter(typeof(PointConverter)), ComVisible(true)]
public struct Point { } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-08-20T17:36:10.950

重载之间的唯一区别是类型。这就是为什么编译器无法在不查看类型的情况下区分您正在使用的重载。

由于执行程序集不引用类型，编译器不知道类型，需要直接引用包含类型定义的程序集。

我自己遇到了这个问题，不想添加对包含该类型的程序集的直接引用。我只是向其中一个方法添加了一个参数（布尔值），因此它们不再是彼此的重载。然后编译器理解了这些方法之间的区别，即使它们具有相同的名称，因为它们具有不同数量的参数。**它不再需要对包含该类型的程序集的引用。**我知道这不是一个理想的解决方案，但我找不到另一个解决方案，因为我的方法是一个构造函数，所以我无法以任何其他方式更改它的签名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T17:41:05.307

要解决这个问题（并且假设您没有太多的调用来包装等）
，您可以简单地为您仅使用的“点”调用定义一个扩展包装器，例如

```
public static Point MyInverseTransform(this ITransform mytransform, Point point)
{
    return mytransform.InverseTransform(point);
} 
```

...为该库（扩展名所在的位置）提供 System.Drawing 引用
（并避免必须在任何地方添加“包装库”，因为这会破坏目的，只需将其放入您已经引用过的一些通用库中，与问题有关。最好是“源”库的一部分，但如果你不能改变它）......

然后通过调用它`MyInverseTransform`。

# sql - 连接时的 SQL 查询

> ID：10210733
> 
> 赞同：0
> 
> 时间：2012-04-18T13:45:51.147
> 
> 标签：sql, sql-server

我有两张表 mem_loan 和 share。在 mem_loan 表中，我有一个名为 DATE 的列，在份额中，我有一个名为 noofshares 的列。没有 mem_loan 的主键是 share 表中的外键。我想使用以下查询，但出现错误。

```
SELECT SUM(noofshares),year(convert(datetime,mem_loan.dos,105)) 
FROM shares s,mem_loan ml 
JOIN mem_loan ON mem_loan.loan_acno = shares.loan_acno 
WHERE year(convert(datetime,dos,105))=year(getdate()) 
```

错误如下：

> 列 'mem_loan.DOS' 在选择列表中无效，因为它既不包含在聚合函数中，也不包含在 GROUP BY 子句中。

请帮帮我

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T13:47:32.780

正如错误消息所说，您需要 GROUP BY 未包含在聚合函数中的列。

但是，您的示例 SQL 似乎也有其他错误。特别是，您已包含该`mem_loan`表两次，但只有一个连接条件，因此将执行交叉连接。这不太可能是你的意思。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:48:06.760

尝试这个

```
SELECT SUM(noofshares),year(convert(datetime,mem_loan.dos,105)) 
FROM shares s,mem_loan ml JOIN mem_loan ON mem_loan.loan_acno=shares.loan_acno 
where year(convert(datetime,dos,105))=year(getdate()) 
group by year(convert(datetime,mem_loan.dos,105)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:48:51.940

你必须：

```
GROUP BY year(convert(datetime,dos,105)) 
```

让您的汇总 SUM() 工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T14:18:23.810

您可以使用`OVER`来避免必须将列`dos`作为聚合的一部分。免责声明：我没有与我一起测试的管理工作室：

```
 SELECT SUM(noofshares) OVER (PARTITION BY year(convert(datetime,mem_loan.dos,105)) ),year(convert(datetime,mem_loan.dos,105)) 
FROM shares s,mem_loan ml 
JOIN mem_loan ON mem_loan.loan_acno = shares.loan_acno 
WHERE year(convert(datetime,dos,105))=year(getdate()) 
```

更多信息`OVER`：http: [//msdn.microsoft.com/en-us/library/ms189461.aspx](http://msdn.microsoft.com/en-us/library/ms189461.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T13:48:27.477

像这样的东西：

```
SELECT 
  SUM(noofshares),
  year(convert(datetime,mem_loan.dos,105)) 
FROM 
  shares s,mem_loan ml 
  JOIN mem_loan ON mem_loan.loan_acno=shares.loan_acno 
where year(convert(datetime,dos,105))=year(getdate())
GROUP BY year(convert(datetime,mem_loan.dos,105)) 
```

或者你可以这样做：

```
SELECT
    t.noofshares,
    SUM(t.LoanYear)
FROM
    (
        SELECT 
          noofshares,
          year(convert(datetime,mem_loan.dos,105)) as LoanYear
        FROM 
          shares s,mem_loan ml 
          JOIN mem_loan ON mem_loan.loan_acno=shares.loan_acno 

    ) AS t
where 
    t.LoanYear=year(getdate())
GROUP BY
    t.LoanYear 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-18T13:52:39.477

问题是您正在尝试使用 Sum 函数进行聚合，而 sql server 不知道要使用 mem_loan 表中的哪一年记录。

对于初学者，请选择您的年度聚合函数（即 MIN）：

```
SELECT 
    SUM(noofshares),
    MIN(year(convert(datetime,mem_loan.dos,105))) 
FROM
    shares s,
    mem_loan ml 
JOIN mem_loan ON mem_loan.loan_acno=shares.loan_acno 
WHERE 
    year(convert(datetime,dos,105))=year(getdate()) 
```

# google-app-engine - Google App Engine 全局变量（ServletContext）

> ID：10210734
> 
> 赞同：3
> 
> 时间：2012-04-18T13:45:51.190
> 
> 标签：google-app-engine, jakarta-ee, servlets

我正在尝试在 JAVA 中在 GAE 上构建一个聊天应用程序。我需要统计所有在线用户及其网络（某种聊天室），并且这些信息需要不断更新。我（错误地？）假设我可以只使用 Java 的 SerlvetContext 和 Set/Get Attribute 方法来更新在线\离线用户并与所有 servlet 共享该信息。据我所知（有可爱的错误），由于 GAE 是分布式\云服务，它不能有效地实现 ServletContext.setAttribute - 这意味着我的应用程序可能运行在多个 JVM 上，并且 ServletContext 上的信息仅共享在属于同一个 JVM 的 servlet 之间。

当然，这对我来说是个大问题。几个问题 - 1) ServletContext 确实不能在 GAE 上正常工作吗？2）对于像我这样的初学者网络开发者来说，GAE 是一个糟糕的选择吗？在我看来，我总是发现新的问题和不符合 Servlet\JSP 规则的东西。既然初学者学习 Servlets 已经够难了，也许 GAE 不是正确的选择？3）那么我怎样才能在 Servlet 之间共享信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T15:18:34.267

如果您真的只是出于自己的目的而尝试学习 Java EE，那么出于您提到的原因，我可能会避免使用 GAE。这是一项非常好的服务，但是是的，它有自己的一套警告，可能会妨碍您的学习。您最好只为您的目的启动一个 EC2 实例。

也就是说 - 你是对的，AppEngine 将启动和关闭实例来服务请求。如果您想要共享状态，您应该使用跨实例共享的 memcache，但您必须管理对 memcache 对象的访问，以防止多个用户同时写入它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-27T06:45:16.063

在谷歌应用引擎中，应用程序状态通常在使用数据存储的实例之间共享。由于您的要求更实时，并且使用轮询可能表现不佳，您应该使用 Channel API（可能除了数据存储之外）：

[https://developers.google.com/appengine/docs/java/channel/](https://developers.google.com/appengine/docs/java/channel/)

从该页面引用：

> Channel API 在您的应用程序和 Google 服务器之间创建持久连接，允许您的应用程序在不使用轮询的情况下实时向 JavaScript 客户端发送消息。这对于旨在立即向用户更新新信息的应用程序很有用。

# android - Android：如何从资源文件夹运行视频

> ID：10210735
> 
> 赞同：2
> 
> 时间：2012-04-18T13:45:51.627
> 
> 标签：android

我已经看到了与我类似的其他问题，但问题仍然存在。提前致谢。

这是代码

```
package com.akk.mysecondvideo;

import android.app.Activity;
import android.content.Context;
import android.media.MediaPlayer;
import android.net.Uri;
import android.os.Bundle;
import android.widget.VideoView;

public class MySecondVideo extends Activity {

Context context;
MediaPlayer mp;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    VideoView videoView = (VideoView)findViewById(R.id.VideoView);
    //MediaController mediaController = new MediaController(this);
    // mediaController.setAnchorView(videoView);
    //videoView.setMediaController(mediaController);

    Uri uri = Uri.parse("android.resource://com.akk.mysecondvideo/"
            + R.raw.bommarillu);

    videoView.setVideoURI(uri);

    //mp = new MediaPlayer();
    //mp = MediaPlayer.create(context, R.raw.bommarillu);

    videoView.start(); 
}
} 
```

当我尝试运行它时，它显示强制关闭，并且 logcat`NULLPOINTEREXCEPTION`在第 28 行显示错误，即`videoView.setVideoURI(uri);`

VideoView 是 main.xml 的一部分。main.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
>
<VideoView 
     android:layout_height="fill_parent"
     android:layout_width="fill_parent" 
     android:id="@+id/VideoView" />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:52:10.017

你检查看看`uri`是不是`null`？

尝试在之前添加此行`videoView.setVidoeURI(uri)`：

```
if (null == uri)
   Toast.makeText(this, "URI IS NULL", Toast.LENGTH_LONG).show(); 
```

如果显示 toast 通知，则 URI 未正确解析

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T19:36:33.800

试试这个示例代码：

```
Uri uri = Uri.parse("android.resource://com.akk.mysecondvideo/raw/bommarillu"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T14:12:00.210

我不认为有任何问题。但是我想告诉你一些建议

*   在 XML 中为小部件命名与小部件名称不同，例如 myVideoView 而不是 VideoView
*   videoView.setMediaController(new MediaController(this));
*   videoView.requestFocus();

检查这是否有效。我的代码与您相同，我将创建一个项目并为您提供输入。

到时候试试这个

# asp.net - ckeditor上的最大单词数插件问题

> ID：10210738
> 
> 赞同：0
> 
> 时间：2012-04-18T13:46:14.293
> 
> 标签：asp.net, asp.net-mvc-2, ckeditor

我正在尝试使用此处找到的 ckeditor 教程在我的一些已转换为 wswgs 的文本区域上实现字数统计功能：[http ://www.n7studios.co.uk/2010/03/01/ckeditor-word-计数插件/](http://www.n7studios.co.uk/2010/03/01/ckeditor-word-count-plugin/)。本教程使用自定义插件来计算 ckeditor 的单词。我得到了正确的字数，但是当我超过允许的最大字数时，我看不到颜色变为红色。我已经使用 firebug 来查看我的文本区域在使用 ckeditor 转换为 wswg 后的样子，但我没有看到任何奇怪的东西。这是我的代码：

```
<asp:Content ID="Content3" ContentPlaceHolderID="JSContent" runat="server">
<script src="<%: Url.Content("~/Scripts/jquery-1.7.min.js") %>" type="text/javascript"></script>
<script type="text/javascript" src="<%: Url.Content("~/Scripts/jquery.combobox.js") %>"></script>
<script type="text/javascript" src="<%: Url.Content("~/Scripts/ckeditor/ckeditor.js") %>"></script>
<script type="text/javascript" src="<%: Url.Content("~/Scripts/ckeditor/adapters/jquery.js") %>"></script> <%-- Must be linked last --%>
<script type="text/javascript">
    $(document).ready(function () {

        $(".cke_editor").ckeditor({
            toolbar: 'custom'
        });

    });

<div class="form-row form-row-inline">
    <%: Html.TextAreaFor(model => model.AssignmentText, new { @name = "table", @class = "cke_editor", @style = "display:none", @onchange = "setDirty(true)" })%>
    <input name="tableWordCount" type="hidden" value="10" />
</div> 
```

这是屏幕：

![ckeditor 和 wordcount 插件](../Images/b5014738e78768aed4147dbe205a29b9.png)

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T18:10:52.057

我终于弄明白了。`Html.TextAreaFor()`asp.net mvc helper 方法将 html 属性对象作为参数，如上面的问题代码所示。我最初使用 textarea 的“名称”属性，以便它与 ckeditor 字数统计插件上的“名称属性”相匹配。我不得不改用“id”属性。

ckeditor 示例：

```
<html>
<head>
    <title>CKEditor Word Count Demonstration</title>
    <script type="text/javascript" src="jquery/jquery.1.4.min.js"></script>
    <script type="text/javascript" src="ckeditor/ckeditor.js"></script>
</head>

<body>
    <form action="#" method="POST">
        <p>
            <label for="content">Content with 250 word limit</label>
            <textarea name="content" class="ckeditor">Lorem Ipsum.</textarea>
            <input type="hidden" name="contentWordCount" value="250" />
        </p>
    </form>
</body>
</html> 
```

我的新固定代码：

```
<asp:Content ID="Content3" ContentPlaceHolderID="JSContent" runat="server">
<script src="<%: Url.Content("~/Scripts/jquery-1.7.min.js") %>" type="text/javascript"></script>
<script type="text/javascript" src="<%: Url.Content("~/Scripts/jquery.combobox.js") %>"></script>
<script type="text/javascript" src="<%: Url.Content("~/Scripts/ckeditor/ckeditor.js") %>"></script>
<script type="text/javascript" src="<%: Url.Content("~/Scripts/ckeditor/adapters/jquery.js") %>"></script> <%-- Must be linked last --%>
<script type="text/javascript">
    $(document).ready(function () {

        $(".cke_editor").ckeditor({
            toolbar: 'custom'
        });

    });

<div class="form-row form-row-inline">
    <%: Html.TextAreaFor(model => model.AssignmentText, new { @id = "taxta", @class = "cke_editor", @style = "display:none", @onchange = "setDirty(true)" })%>
    <input name="taxtaWordCount" type="hidden" value="10" />
</div> 
```

所以，我唯一需要改变的是“id”属性。我希望这对其他人有帮助。同样，[Firebug](http://getfirebug.com/)在深入研究 html DOM 并查看浏览器上的所有内容如何呈现方面非常有帮助。

# c# - 将 Run Text 属性移动到元素的内容

> ID：10210740
> 
> 赞同：2
> 
> 时间：2012-04-18T13:46:20.583
> 
> 标签：c#, xml, silverlight, richtextbox, linq-to-xml

您如何将 Run 的 Text 属性移动到 Run 标记的内容中。例如

```
string str = "<Run Text='hello world' />";

//into

string str2 = "<Run>hello world</Run>"; 
```

请记住，字符串可能包含多个段落和多个运行（我希望所有运行都被更改）。理想情况下，我想将其保留为字符串，而不是转换为 XML 或 XAML，所以也许是 Regex 语句？如果没有，那么我将接受转换它。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:59:14.883

借用@ionden：

```
string str = "<Para> <Run Text='hello world' /> <Run Text='goodbye world' /></Para>";
XElement elem = XElement.Parse(str);

var runs = elem.DescendantsAndSelf("Run");

foreach (var run in runs)
{
    // modify in-place to preserve the (unknown) structure. 
    run.Value = run.Attribute("Text").Value;
    run.Attribute("Text").Remove();
}

str = elem.ToString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:50:36.073

```
 XElement elem = XElement.Parse(str);
 string str2 = new XElement(elem.Name, elem.Attribute("Text").Value).ToString(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:56:40.490

```
string str = "<Root><Run Text='hello world' /><Run Text='hello world2' /></Root>";
XmlDocument doc = new XmlDocument();
doc.LoadXml(str);
XmlNodeList nodes = doc.SelectNodes("Root/Run");
foreach (XmlNode node in nodes)
{
    XmlAttribute attr = node.Attributes["Text"];
    node.InnerText = attr.Value.ToString();
    node.Attributes.Remove(attr);                
}
str = doc.InnerXml; 
```

# c - 使用 libcurl 制作 https

> ID：10210741
> 
> 赞同：7
> 
> 时间：2012-04-18T13:46:24.297
> 
> 标签：c, curl, libcurl

我正在尝试连接到谷歌 api。
这在我的终端上运行良好，我正在做：
`curl https://www.googleapis.com/tasks/v1/users/@me/lists --header "Authorization: Bearer myAccessCode"`.
这工作正常，但现在我想在 ac 程序中进行此操作。
为此，我有：

```
 CURL *curl;
    char *header = "Authorization:  Bearer myAccessCode";
    struct curl_slist *headers = NULL;
    headers = curl_slist_append(headers, header);

    curl = curl_easy_init();

    char *response = NULL;

    curl_easy_setopt(curl, CURLOPT_URL, "https://www.googleapis.com/tasks/v1/users/@me/lists");
    curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers);
    curl_easy_setopt(curl, CURLOPT_HTTPGET, 1);

    curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 0L);
    curl_easy_setopt(curl, CURLOPT_SSL_VERIFYHOST, 0L);

    curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers);
    curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, httpsCallback);
    curl_easy_setopt(curl, CURLOPT_WRITEDATA, &response);

    curl_easy_perform(curl);
    curl_easy_cleanup(curl); 
```

但在这里我只是收到一条需要登录的消息。我不知道我做错了什么，有人看到我的失败吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T10:22:58.703

就像我在上面的评论中所写的那样：
我刚刚意识到我做了：`curl_slist_append(headers, header);`
而不是：`headers = curl_slist_append(headers, header);`
所以标头始终为 NULL，并且我在没有标头的情况下发出了 get 请求。
（我在上面的问题中对其进行了编辑，因此代码有效，如果有的话）

# emacs - 在没有 Emacs 的情况下运行 elisp 程序？

> ID：10210742
> 
> 赞同：25
> 
> 时间：2012-04-18T13:46:24.923
> 
> 标签：emacs, elisp

elisp 是一门很好的语言，我发现它可以处理所有类型的工作，但我可以像使用 shell 脚本一样使用它吗？

即从控制台执行一些 *.el 文件，而不启动 Emacs。或者启动 Emacs，但不要进入交互模式。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-18T14:05:18.260

您绝对可以在 Emacs 中运行 elisp 脚本，而无需启动编辑器界面。

以下是我在 SO（尤其是以下两个）关于该主题的一些非常有用的问答中制作/复制的笔记。

*   [Emacs shell 脚本 - 如何将初始选项放入脚本中？](https://stackoverflow.com/questions/6238331/#6259330)
*   [Emacs中文本的惯用批处理？](https://stackoverflow.com/questions/2879746/#2906967)

以下出色的概述也涵盖了许多此类信息以及更多信息，建议阅读：

*   [https://swsnr.de/blog/2014/08/12/emacs-script-pitfalls/](https://swsnr.de/blog/2014/08/12/emacs-script-pitfalls/)

```
;;;; Elisp executable scripts

;; --batch vs --script
;; M-: (info "(emacs) Initial Options") RET
;; M-: (info "(elisp) Batch Mode") RET

;; Processing command-line arguments (boiler-plate)
;; http://stackoverflow.com/questions/6238331/#6259330 (and others)
;;
;; For robustness, it's important to both pass '--' as an argument
;; (to prevent Emacs from trying to process option arguments intended
;; for the script), and also to exit explicitly with `kill-emacs' at
;; the end of the script (to prevent Emacs from carrying on with other
;; processing, and/or visiting non-option arguments as files).
;;
;; #!/bin/sh
;; ":"; exec emacs -Q --script "$0" -- "$@" # -*-emacs-lisp-*-
;; (pop argv) ; Remove the "--" argument
;; ;; (setq debug-on-error t) ; if a backtrace is wanted
;; (defun stdout (msg &optional args) (princ (format msg args)))
;; (defun stderr (msg &optional args) (princ (format msg args)
;;                                           #'external-debugging-output))
;; ;; [script body here]
;; Always exit explicitly. This returns the desired exit
;; status, and also avoids the need to (setq argv nil).
;; (kill-emacs 0)

;; Processing with STDIN and STDOUT via --script:
;; https://stackoverflow.com/questions/2879746/#2906967
;;
;; #!/bin/sh
;; ":"; exec emacs -Q --script "$0" -- "$@" # -*-emacs-lisp-*-
;; (pop argv) ; Remove the "--" argument
;; (setq debug-on-error t) ; if a backtrace is wanted
;; (defun stdout (msg &optional args) (princ (format msg args)))
;; (defun stderr (msg &optional args) (princ (format msg args)
;;                                           #'external-debugging-output))
;; (defun process (string)
;;   "Reverse STRING."
;;   (concat (nreverse (string-to-list string))))
;;
;; (condition-case nil
;;     (let (line)
;;       (while (setq line (read-from-minibuffer ""))
;;         (stdout "%s\n" (process line))))
;;   (error nil))
;;
;; ;; Always exit explicitly. This returns the desired exit
;; ;; status, and also avoids the need to (setq argv nil).
;; (kill-emacs 0) 
```

除了 Emacs，我知道的唯一其他 elisp 解释器/编译器是 Guile。如果您热衷于 elisp 中的一般编码，那应该值得一看（尤其是在考虑性能的情况下）。

# sql - SQL 跟踪不适用于 JPA persistence.xml

> ID：10210744
> 
> 赞同：0
> 
> 时间：2012-04-18T13:46:28.617
> 
> 标签：sql, logging, jpa-2.0

这是我在 persistence.xml 文件的属性节点下包含的一行

```
<property name="openjpa.Log" value="File=C:\Users/PS7/IBM/wid7/workspace/Logs/openjpa.SQL.log DefaultLevel=WARN, Runtime=INFO, Tool=INFO, SQL=TRACE"/> 
```

我希望所有 SQL 查询都转到该日志文件。但是那里没有文件，因此没有 SQL 查询。

我可能做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:18:33.053

我不确定如何在这里表示 Windows 路径，但我认为你写的是一个错字。我最好的猜测是：

```
<property name="openjpa.Log" value="File=C:/Users/PS7/IBM/wid7/workspace/Logs/openjpa.SQL.log DefaultLevel=WARN, Runtime=INFO, Tool=INFO, SQL=TRACE"/> 
```

（在 C 处将 \ 切换为 / :)

如果路径没有问题，则 jvm 可能没有对该文件/目录的写入权限 - 或者安全管理器不允许将日志记录代码写入那里 - 这应该在 stderr 上看到，只需命名一个没有路径的简单文件，然后搜索它。

# git - 如何恢复“git filter-branch -f --env-filter”

> ID：10210746
> 
> 赞同：4
> 
> 时间：2012-04-18T13:46:41.423
> 
> 标签：git, commit, revert, git-filter-branch

我是一个关于 git 的新手，通常 git commit、pull 和 push 是我唯一做的命令。最近注意到我的提交被设置为默认名称和电子邮件，并想更改它。我愚蠢地运行了这个，我在某处的帖子中找到了这个：

```
git filter-branch -f --env-filter "GIT_AUTHOR_NAME='Newname'; GIT_AUTHOR_EMAIL='newemail'; 
GIT_COMMITER_NAME='Newname'; GIT_COMMITTER_EMAIL='newemail';" HEAD 
```

我认为这只会改变我的提交，但它改变了 repo 中的所有提交以包含我的姓名和电子邮件。当然，为了继续我的“愚蠢”，我推动了这些变化。

此外，我似乎已经丢失了历史记录，并且 github 上的所有提交似乎也有重复的条目。一个有我的名字和电子邮件，一个是原始的。

有没有办法恢复这个？也许使用以前拉的副本来推送原始信息？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T14:06:28.950

如果您在执行 filter-branch 命令后没有做任何清理松散对象的操作，您可以重置您的 master 分支（假设在您发出命令时 HEAD 是 master）：

```
git reset --hard refs/original/master 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T14:12:27.420

如果您还没有清理，您可以使用重置您的分支：`git reset --hard refs/original/master`这将在您尝试之前重新加载所有原始文件，然后执行：

`git filter-branch -f --env-filter "GIT_AUTHOR_NAME='Newname'; GIT_AUTHOR_EMAIL='newemail'; GIT_COMMITER_NAME='Newname'; GIT_COMMITTER_EMAIL='newemail';" "--tag-name-filter cat -- --all"`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T11:46:34.400

一位同事能够与一些 git 专业人士交谈，似乎以前副本中的“git push -f”解决了这个问题。另外，我需要在我的副本上执行 git pull --rebase 。

谢谢你们的帮助。

# c++ - 如何使窗口出现在所有内容之上（甚至是全屏游戏！）c++/Qt

> ID：10210754
> 
> 赞同：9
> 
> 时间：2012-04-18T13:47:10.223
> 
> 标签：c++, qt, topmost

我正在尝试制作一个应用程序，在屏幕中心显示十字准线并保持在其他所有内容之上。目的是在一些没有提供十字准线的 FPS 游戏中设置准星。除了游戏之外，我已经成功地将我的窗口放在了最上面：/

这是我的代码：（一切都很重要，因为我只测试我的应用程序的核心功能，我已经对其进行了广泛的评论，以尝试让我的问题更容易理解）

```
QApplication app(argc, argv);

DWORD error;
QWidget window;
QLabel *label = new QLabel(&window);
label->setText("<strong>O<strong>");//I'm using an "O" as a crosshair until I can figure out how to display image transparency.
window.setGeometry(960-label->width()/2,540-label->height()/2,label->width(),label->height());//here I'm making my window appear in the center of my screen
window.setWindowFlags(Qt::FramelessWindowHint | Qt::WindowStaysOnTopHint);// here making the window frameless and topMost via qt
window.setAttribute(Qt::WA_TranslucentBackground);//making the window see through
window.setWindowTitle("Crosshair");
window.show();

//in this next part I tried using windows api to make my window appear on top of the game.
HWND handle, myHandle;
myHandle = FindWindow(NULL,TEXT("Crosshair"));//retieving my own application window handle
if(myHandle == 0){cout << "no own handle" << endl;}//it successfully retrieves it

handle = FindWindow(NULL,TEXT("Killing Floor"));//retrieving a game window handle
if(handle == 0){cout << "no KF handle" << endl;}//it successfully retrieves it

if(handle != 0 && myHandle != 0)
{
    if(SetWindowPos(handle,myHandle,0,0,0,0,SWP_NOSIZE | SWP_NOMOVE) == 0){cout << "couldnt set notopmost" << endl;}//here SetWindowPos returns 0 (function failed)
}
          // I've also tried using SetWindowPos to set the game to Not TOPMOST, it didnt work either.
          // here was my code : SetWindowPos(handle, HWND_NOTOPMOST, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOMOVE);

error = GetLastError();// i tried using GetLastError to understand what was happening
cout << error << endl;// but it only returns "5", I've read that you can look in WINNT.H for information about the meanings of error codes
                      // however its a pretty big file and I wasn't able to understand where the relevant part was.

return app.exec(); 
```

我的猜测是游戏等应用程序对显示设备有更直接的控制。我正在寻找这个问题的任何解决方案（不一定是涉及透明最顶层窗口的解决方案）。另外，如果有人可以向我解释如何有效地使用 GetLastError()，以及为什么游戏的行为与普通窗口不同。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T14:13:11.457

我知道这对您没有帮助，但请看一下Raymond Chen 的[这篇文章](http://blogs.msdn.com/b/oldnewthing/archive/2011/03/10/10138969.aspx)：[如何创建一个永远不会被其他最顶层窗口覆盖的最顶层窗口？](http://blogs.msdn.com/b/oldnewthing/archive/2011/03/10/10138969.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T09:21:02.843

我发现 c++ 库[DirectDrawOverlayLib](http://www.codeplex.com/DirectDrawOverlayLib)应该可以做到这一点。引用网站：

> 用于创建、管理和绘制 DirectDraw 覆盖的非托管 C++ 库。包含用于 .NET 客户端的 C++/CLI 包装器。
> 
> DirectDraw 覆盖是特殊的 DirectDraw 表面，显示在其他所有内容上，包括全屏游戏和应用程序。它们可用于实现像 XFire 这样在全屏游戏操作期间显示信息的程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:56:26.210

从[SetWindowPos()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633545%28v=vs.85%29.aspx)文档：

> 可以通过将 hWndInsertAfter 参数设置为 HWND_TOPMOST 并确保未设置 SWP_NOZORDER 标志，或者通过设置窗口在 Z 顺序中的位置，使其位于任何现有的最顶层窗口之上，可以使窗口成为最顶层窗口。当非最顶层窗口成为最顶层时，其拥有的窗口也被置为最顶层。然而，它的所有者并没有改变。

同样来自同一页面：

> 要使用 SetWindowPos 将窗口置于顶部，拥有该窗口的进程必须具有 SetForegroundWindow 权限。

但是，我猜该链接适用于 Windows Vista 及更高版本。

# c - gfortran警告浮点异常

> ID：10210759
> 
> 赞同：2
> 
> 时间：2012-04-18T13:47:22.843
> 
> 标签：c, exception-handling, floating-point, fortran, gfortran

我正在为一些代码使用 gfortran。一段时间以来，我一直在编译

```
-ffpe-trap=zero,overflow,invalid 
```

试图追捕一些错误。这会导致我的程序立即停止执行。在某些情况下，FPE 可能没问题，因此会出现如下标志：

```
-ffpe-warn=zero,overflow,invalid 
```

会非常有用。gfortran（或任何其他编译器）是否提供类似的东西？如果没有，是否有任何解决方法？我目前的想法是创建一个 C 函数来注册一个信号处理程序来写出警告，尽管我不知道如何去做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T14:08:13.457

我不知道遇到浮点异常时的警告方式。但是 gfortran 和 ifort 都有信号处理例程。例如，参见[信号](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gfortran/SIGNAL.html)的 gfortran 文档和英特尔 Fortran 编译器[用户和参考指南（警告：大 PDF）](http://gcc.gnu.org/onlinedocs/gchttp://software.intel.com/sites/products/documentation/hpc/compilerpro/en-us/fortran/lin/main_for_lin.pdf)（参见 wards 上的第 410 页）。

> 您可以通过调用来为信号建立以下操作之一`signal`：
> 
> *   忽略指定的信号（由数字标识）。
> *   对指定信号使用默认动作，可以重置之前建立的动作。
> *   将控制从指定的信号转移到接收信号的过程，由名称指定。

在您的情况下，您可能希望编写一个函数来在发生浮点异常时执行某些操作（例如打印文件名/行号），并使用上面列表中的第三个选项。

不幸的是，这不是很便携：查看[此页面](https://support.scinet.utoronto.ca/wiki/index.php/Using_Signals#Trapping_signals_in_Fortran)以获取各种编译器的信号处理示例。如果您愿意，可以在预处理器宏中包装一些代码

*   用多个编译器编译
*   仅在设置了某些预处理器标志时才使用信号处理例程（参见[`-NDEBUG`](https://stackoverflow.com/questions/5473556/what-is-the-ndebug-preprocessor-macro-used-for-on-different-platforms)）

**更新：**最终，内在模块的异常处理设施`ieee_exceptions`将是执行此操作的可移植方式，正如高性能标记所建议的那样。

# facebook-page - 如何在我的页面上获得不是通过游戏创建的“玩游戏”按钮？

> ID：10210761
> 
> 赞同：1
> 
> 时间：2012-04-18T13:47:32.673
> 
> 标签：facebook-page

通过开发者帐户中的设置为游戏创建社区/粉丝页面时，您可以选择在页面标题图像下方添加一个“玩游戏”按钮。

以任何其他方式创建页面，您似乎没有该选项。因此我的问题：

在开发者工具中创建游戏应用程序之前，我们创建了社区页面并开始为其生成喜欢和流量。我们现在已经启动了我们的游戏，并希望在社区页面上拥有“玩游戏”按钮。

除了创建一个全新的页面并要求人们将他们的喜欢移到那里之外，还有什么方法可以实现这一点？

我已经研究了迁移页面，但该选项似乎不再可用，并且尚不清楚它是否会起作用。另一种选择是只创建新页面并要求人们喜欢新页面。这会让我们失去我们不希望失去的虚荣 URL……

谢谢你，约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T11:21:43.457

我遇到了同样的问题，终于找到了解决方案：

1.  进入您的页面设置（编辑页面 -> 更新信息）。
2.  在类别下，选择“应用程序页面”。
3.  保存更改。
4.  现在转到您的应用程序设置。
5.  选择应用程序详细信息。
6.  （如果您已经提交到应用中心，请取消提交）。
7.  在“应用程序页面”下选择您的页面。
8.  保存更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T20:18:44.103

In FB developer settings, go to your app>advanced settings at the bottom there is a spot to create a community page. That page that you create will have the Play Button you are looking for.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-01T13:33:06.760

这是一个老问题，但现在有效的解决方案是：

1.  去你的脸书页面，
2.  设置 > 页面信息
3.  在那里你需要更新你的类别并且只选择了“应用页面”

然后转到您的 Facebook 开发者帐户，选择您的应用并

4.  转到设置 > 高级
5.  在应用页面部分，您应该看到“从现有选择”按钮，您可以在其中选择和链接您现有的 Facebook 页面

完毕 ：）

# node.js - 如何从 node.js 以编程方式执行 mongodump 命令？

> ID：10210767
> 
> 赞同：19
> 
> 时间：2012-04-18T13:48:01.943
> 
> 标签：node.js, mongodb

从 node.js 以编程方式执行 mongodb admin/console 命令的最佳方法是什么？具体来说，我想在执行一系列插入后使用 mongodump 导出一个 mongodb 集合。像这样的东西：

```
// requires and initializing stuff left out for brevity
db.open(function(err, db) {
    if(!err) {
        db.collection('test', function(err, collection) {
            var docs = [{'hello':'doc1'}, {'hello':'doc2'}, {'hello':'doc3'}];

            collection.insert(docs, {safe:true}, function(err, result) {

                // Execute mongodump in this callback???

            });
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-18T13:56:42.730

尝试使用[`child_process.spawn(command, args)`](http://nodejs.org/docs/latest/api/child_process.html#child_process_child_process_spawn_command_args_options)：

```
var spawn = require('child_process').spawn;

// ...
  collection.insert(docs, {safe:true}, function(err, result) {
    var args = ['--db', 'mydb', '--collection', 'test']
      , mongodump = spawn('/usr/local/bin/mongodump', args);
    mongodump.stdout.on('data', function (data) {
      console.log('stdout: ' + data);
    });
    mongodump.stderr.on('data', function (data) {
      console.log('stderr: ' + data);
    });
    mongodump.on('exit', function (code) {
      console.log('mongodump exited with code ' + code);
    });
  });
// ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-11T11:06:44.617

不同的年份，不同的答案。

您可以使用[Shelljs](https://github.com/arturadib/shelljs) 之类的东西`exec` `mongodump`或 UNIX shell 提供的任何其他命令。

# hadoop - LZMA 中是否支持压缩或解压缩 .xz 文件？

> ID：10210770
> 
> 赞同：3
> 
> 时间：2012-04-18T13:48:09.443
> 
> 标签：hadoop, compression, native, native-code, lzma

1）我想为hadoop编写一个解压编解码器，它可以用lzma2解压.xz文件。

2）我知道LZMA2压缩库支持.xz格式。

3) 但最近我遇到了一个用于 hadoop 的 lzma 编解码器（在 facebook/hadoop 代码库中），它可以解压缩 .xz 文件，所以我想知道这个编解码器是基于 lzma 还是 lzma2 的本机实现？

所以基本上我想知道lzma是否支持.xz格式的压缩和解压？

# css - 在包含的 div 中定位 iframe 的内容

> ID：10210774
> 
> 赞同：4
> 
> 时间：2012-04-18T13:48:19.100
> 
> 标签：css, iframe, positioning

我有一个页面需要通过 iframe 提供服务，但我只需要显示页面的一部分，而不是整个页面。

我目前的代码是：

```
<div style="display:block;overflow:hidden;width:500px;height:350px;">
<iframe height="350px" scrolling="no"
src="http://my/page/i/want/to/show/part/of/here/" width="500px"></iframe></div> 
```

我认为最好的选择是在包含“溢出：隐藏”的包含 div 中提供 iframe，以便它像相框一样工作。这行得通，但问题是我要显示的内容位于 iframe 页面的中间，而 div 总是假设 0,0 是框架的开始。我需要定位 iframe，以便 div 正好位于我希望可见的页面部分上方。

我可以这样做吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-23T19:57:58.843

对 margin-top 和 margin-left 使用负值来定位 iframe。看下面的代码：

```
<div style="display:block;overflow:hidden;width:500px;height:350px;">
<iframe style="margin-top:-100px;margin-left:-100px" height="350px" scrolling="no"
src="http://my/page/i/want/to/show/part/of/here/" width="500px"></iframe></div> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T14:06:42.320

在 iframe 中显示的内容中，如果您可以设置一个带有 id 的元素，该 id 标记您想要通过的内容部分的最顶部，那么您可以使用 url 上的锚点设置 iframe 的 src 属性

iframe 内容的 HTML：

```
[a bunch of markup/stuff that you don't want to show]
....
<div id="topOfVisibleArea"></div>

[more markup] 
```

iframe 标签：

```
<iframe height="350px" scrolling="no" 
src="http://my/page/i/want/to/show/part/of/here/#topOfVisibleArea" 
width="500px"></iframe> 
```

**更新——更好的方法：**

或者您可以在 div 内的 iframe 上使用绝对定位。您需要 iframe 的高度和宽度比您安装它的窗口更宽更高，以适应偏移量。

见这个例子：http: [//jsfiddle.net/sNSMw/](http://jsfiddle.net/sNSMw/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-19T06:40:37.380

```
<iframe name="itunes" src="http://itunes.apple.com/us/album/threads/id509846713&quot; frameborder="0" width="500" height="600" onload="window.frames['itunes'].scrollTo(250,250)"></iframe> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-03-24T20:18:46.350

窍门全在*iframe 样式参数*中。放置在额外的容器中将有助于满足对齐要求。

```
<div style="border: 1px solid red; width: 70px; height: 20px; overflow:  
hidden;"><iframe style="width: 400px; height: 800px; margin-top: -200px; 
margin-left: -200px;" src="http://www.amazon.co.uk/product-reviews
/B0051QVF7A/ref=cm_cr_dp_see_all_top?ie=UTF8&showViewpoints=1&
sortBy=bySubmissionDateDescending" width="320" height="240"></iframe>
</div> 
```

感谢 spamtech.co.uk 的帮助和示例：[http ://spamtech.co.uk/tips/position-content-inside-an-iframe/](http://spamtech.co.uk/tips/position-content-inside-an-iframe/)

# matrix - Fortran 中的矩阵幂函数

> ID：10210776
> 
> 赞同：0
> 
> 时间：2012-04-18T13:48:27.083
> 
> 标签：matrix, fortran

一个快速的问题。

已经做了一些谷歌搜索，但仍然找不到答案：fortran 中的矩阵幂函数是什么（或者有没有）？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:58:11.740

Fortran 中没有固有的矩阵幂函数。矩阵相乘的内在`matmul`函数可能会有所帮助。

# php - 动作并将变量传递给 symfony 1.4 中的所有动作

> ID：10210784
> 
> 赞同：0
> 
> 时间：2012-04-18T13:48:44.933
> 
> 标签：php, symfony1

我想在我的前端应用程序中的所有操作之前执行一些操作（php 脚本），然后将该脚本的结果传递给变量中的操作 - 这样我就可以从所有操作中获取变量值。我应该在哪里声明这样的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T10:14:07.420

如果过滤器解决方案不能满足您的需求，您还可以使用 preExecute 函数创建一个基本操作类：

```
// app/frontend/lib/baseActions.class.php

class baseActions extends sfActions
{
   public function preExecute()
   {
      $this->myVar = .... // define your vars...
   }
} 
```

然后您的模块操作类扩展您的 baseActions 类：

```
// app/frontend/modules/myModule/actions/actions.class.php

class myModuleActions extends baseActions
{
   public function executeIndex(sfWebRequest $request)
   {
      // var $this->myVar is available in any action and in your template
      ... 
   }
} 
```

如果您必须在模块类操作中使用 preExecute 函数，请记住调用`parent::preExecute()`它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T14:12:07.200

什么样的信息？

我建议您使用[过滤器](http://www.symfony-project.org/gentle-introduction/1_4/en/06-Inside-the-Controller-Layer#chapter_06_filters)。

在你的`apps/frontend/config/filters.yml`：

```
rendering: ~
myfilter:
  class: myCustomFilter 
```

创建文件`lib/filter/myCustomFilter.php`：

```
<?php
class myCustomFilter extends sfFilter
{
  public function execute ($filterChain)
  {
    if ($this->isFirstCall())
    {
      // do what ever you want here.
      $config = Doctrine_Core::getTable('Config')->findAll();
      sfConfig::set('my_config', $config);
    }

    $filterChain->execute();
  }
} 
```

然后，您可以在任何地方检索数据：

```
sfConfig::get('my_config'); 
```

# visual-studio-2010 - 需要登录的 Web 性能测试：如何使其在隔离和负载测试中工作？

> ID：10210785
> 
> 赞同：3
> 
> 时间：2012-04-18T13:48:46.837
> 
> 标签：visual-studio-2010, load-testing, webtest

我有一个 Visual Studio 2010 负载测试，其中包含许多 Web 性能测试。运行 Web 性能测试需要您登录到被测网站。因此，负载测试包含一个初始化步骤 - 一个小型 Web 性能测试，它进行登录，并使用插件缓存如此获得的 cookie。'真正的' web 性能测试 - 真正完成工作的测试也都有一个插件，可以读取缓存的 cookie 并将其添加到测试中，以便每个测试都能正常运行：

```
public override void PreWebTest(object sender, PreWebTestEventArgs e)
{
    if (CookieCache.Cookies != null) // CookieCache is a static class of mine
        e.WebTest.Context.CookieContainer.Add(CookieCache.Cookies); 
```

问题是，虽然这一切在我运行负载测试时工作得很好，但这意味着我不能单独运行任何 Web 性能测试，因为如果负载测试初始化​​程序没有运行，那么就没有 cookie，所以 Web性能测试将不会登录并且会失败。

这种情况有什么推荐的解决方案吗？换句话说，如果 Web 性能测试需要登录，有没有办法让它在单独运行时以及作为负载测试的一部分时运行？

单独运行每个 Web 性能测试的明显方法是让它首先调用登录测试，但我不能这样做，因为这对于负载测试来说是不正确的行为（每个用户只应该登录一次） ，就在负载测试开始时）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T07:05:03.207

解决方案是将登录测试添加到您的个人 Web 性能测试中（通过“插入对 Web 测试的调用”），但通过“上下文参数存在”条件规则来寻找上下文参数**$LoadTestUserContext的***缺失*。仅当 Web 测试在负载测试中运行时，该参数才存在。

 **这样，无论是在负载测试中还是负载测试之外，您都只会获得一次登录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-20T05:21:15.270

为什么不尝试使用 PreRequest 函数而不是 PreWebTestFunction

```
Public Overrides Sub PreRequest(sender As Object, e As PreRequestEventArgs)
  MyBase.PreRequest(sender, e)
  Dim cookie As System.Net.Cookie = New System.Net.Cookie(...)
  e.Request.Cookies.Add(cookie) 
```

这样负载测试和 Web 测试都可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T08:25:04.710

我不熟悉 Visual Studio 2010 负载测试，但听起来您需要与 NUnit 等效的方法`SetUp`和`TearDown`对所有测试运行一次的方法，无论您选择了单个测试还是程序集中的所有测试。

稍作[搜索](http://social.msdn.microsoft.com/Forums/is/vstswebtest/thread/ea7f340d-bf3d-4adc-a857-b056d7764019)就意味着等价的是`Init`and`Term`测试。

> 1）右键单击负载测试中的场景节点并选择编辑测试组合...
> 
> 2) 在编辑测试组合对话框中，查看表格底部。您将看到 2 个复选框。一个用于初始化测试，一个用于学期测试。
> 
> init 测试将在每个用户之前运行，而 term 测试将在用户完成时运行。为了确保术语测试运行，您还需要设置负载测试的冷却时间。冷却时间是运行设置节点上的一个属性。此设置使测试有机会在持续时间完成时流出。您可以将其设置为 5 分钟。冷却时间不一定要持续 5 分钟。当所有学期测试完成时，它将结束。如果这需要 20 秒，那么这就是负载测试完成的时间。**

# firefox - 我可以从 Firefox 缓存中删除特定文件吗？

> ID：10210786
> 
> 赞同：8
> 
> 时间：2012-04-18T13:48:48.833
> 
> 标签：firefox, caching, browser-cache, cache-control

我正在开发一个 ASP.net 应用程序。

我必须经常更新我的 CSS 文件。我不想`about:config`在 Firefox 中更新文档频率设置。我想让它默认。

我使用 Firefox 作为理想的浏览器。如果我只是更新我的 CSS 文件，我必须清除 Firefox 的整个缓存。

我想从 Firefox 缓存中删除特定文件。这在 Firefox 中是否可行。我可以在 Firefox 中删除特定的 cookie。我不能从 Firefox 缓存中删除特定文件吗？

如果不可能，那么请告诉我如何制作我的 CSS 文件，以便始终检查（并且仅在修改后才加载）更新版本。在任何情况下，我都不想更改 Firefox 设置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T14:10:11.507

如果我没记错的话，组合键 CTRL + F5 可以清除缓存，并且必须重新加载 css 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T14:06:23.147

使用[ETag](http://technet.microsoft.com/en-us/library/ee619764%28WS.10%29.aspx)将是一个不错的选择。通过在 HTTP 响应中设置 Max-Age Header，您可以允许客户端在有限的时间内缓存资源。在那之后，客户端将向服务器发出有条件的 GET 请求。如果请求中的 ETag（存储在 If-None-Match 标头中）与服务器上的 ETag 不匹配，则将修改后的资源向下发送到客户端。否则，服务器会以 HTTP 304 Not Modified 响应，客户端可以再次缓存内容一段有限的时间。此方法可用于特定文件或目录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-05T21:01:05.543

将上次更新时间戳添加到链接文件。这就是它在 php 中的样子

```
<link type="text/css" rel="stylesheet" href="css/style.css?lu=<?php echo filectime('css/style.css') ?>" /> 
```

这将导致浏览器仅在文件更新时重新加载文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-20T07:08:24.460

这可以通过几行脚本（在浏览器控制台上运行`Ctrl+Shift+J`）来实现：

```
// load the disk cache
var cacheservice = Components.classes["@mozilla.org/netwerk/cache-storage-service;1"]
    .getService(Components.interfaces.nsICacheStorageService);
var {LoadContextInfo} = Components.utils.import("resource://gre/modules/LoadContextInfo.jsm",{})
var hdcache = cacheservice.diskCacheStorage(LoadContextInfo.default, true);

// compose the URL and submit it for dooming
var uri = Components.classes["@mozilla.org/network/io-service;1"]
    .getService(Components.interfaces.nsIIOService).newURI(prompt("Enter the URL to kick out:"), null, null);
hdcache.asyncDoomURI(uri, null, null); 
```

只要知道 CSS 文件的绝对 URL，就可以`prompt("Enter the URL to kick out:")`用 URL 替换。

改编自[DoomEntry.js](https://github.com/janakaud/js-on-firefox/blob/master/console/DoomEntry.js)，确认也适用于最新的 Firefox (Quantum)。

# coldfusion - 在 REQUEST 范围内存储 Coldfusion CFC 实例是否安全？

> ID：10210793
> 
> 赞同：3
> 
> 时间：2012-04-18T13:49:00.910
> 
> 标签：coldfusion, coldfusion-8, cfc

将 CFC 对象存储在 REQUEST 范围内以供以后访问是否安全？目前，我们的网站至少会加载两次导航数据，如果他们使用我们的面包屑功能，可能会加载三次。有时，这些数据可能会有所不同，但是，大多数情况下，最终会进行三个单独的调用以获取相同的确切导航数据......

所以，我想在第一次加载之后，将导航数据保存在请求范围内的某种结构中，然后在随后的调用中，检查该数据是否已经存在，如果是，则使用存储的内容而不是而不是重新创建它。我知道这将访问包含对象之外的共享范围，这可能不是一个好习惯，但最终可以减少我们一半的页面加载时间......

我知道这是可以做到的，但是，我们最近遇到了服务器问题，其中一些可能是我们如何使用/存储某些东西的内存泄漏，所以想知道这样做是否安全......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T15:20:13.643

or范围`variables`都`request`适合您的目的，但更可取的是修改需要访问此变量的函数以接受您的缓存变量作为参数。对于 CFC，它可以在`init()`方法中传递并存储以供该 CFC 中的方法使用（假设您对其进行了初始化）

通过依赖一个全局变量（即使是一个仅限于当前请求的变量），您可能只会给自己带来麻烦，这可以通过确保方法更加封装来解决。

正如我之前的评论中提到的，[ColdFusion - 何时使用“请求”范围？](https://stackoverflow.com/questions/25672/coldfusion-when-to-use-the-request-scope)值得快速阅读，因为它在答案中有相关信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T15:05:19.257

是的。唯一可以访问 REQUEST 范围的请求是当前请求。

# sql - 使用参数和选择语句创建 SQL 插入语句

> ID：10210796
> 
> 赞同：3
> 
> 时间：2012-04-18T13:49:03.410
> 
> 标签：sql, db2

我正在尝试提出一个执行以下操作的 DB2 SQL 语句，但我不确定这是否允许。

我知道可以`insert into tableA ( ... ) Values (?,?,?,...)`
给这些参数赋值`?`。

是否可以预定义参数之一的值？

例如，我要插入的列之一是 ，`ID column`我想将其设为`select max(id) + 1 from tableA`.

这就是我想要达到的 - 这种语法可能`db2`吗？

```
insert into tableA (ID, Text1, Text2) VALUES (select max(id)+1 from tableA, ?, ?) 
```

无论如何 - 任何帮助将不胜感激！

谢谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T14:06:57.110

这应该有效：

```
 insert into tableA values((select max(id)+1 from tableA),'text1','text') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T14:01:14.703

听起来您想要一个主键作为表上的索引。

```
db2 alter table tableA add primary key (id) 
```

这将在您的表中创建一个列，当您添加新记录时该列将自动增加。来源（[http://www.ibm.com/developerworks/data/library/techarticle/dm-0401melnyk/](http://www.ibm.com/developerworks/data/library/techarticle/dm-0401melnyk/)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-03T18:01:49.250

您也可以尝试使用`OVERRIDING USER VALUE`参数：

```
INSERT INTO TableA
OVERRIDING USER VALUE 
SELECT 0,Text1, Text2
From TableB 
```

# wpf - 用于选定值和搜索功能的 wpf 组合框项目模板

> ID：10210797
> 
> 赞同：0
> 
> 时间：2012-04-18T13:49:04.620
> 
> 标签：wpf, combobox

我在我的应用程序中使用了一个组合框，并用类似这样的类填充它：

```
namespace Foo.Bar{
     public class Item
     {
          public string lastName;
          public string firstName;
          public Foo theMeatyPart;
     }
} 
```

我可以使用 itemTamplate 使用“lastName，firstName”填充下拉列表，但随后所选值显示为“Foo.Bar.Item”。如何将相同的模板应用于 selectedItem 并且在不覆盖 Item 的 ToString 方法的情况下使搜索功能正常工作？

这是xaml：

```
<Style x:Key="SearchComboStyle" TargetType="ComboBox">
                <Style.Setters>
                    <Setter Property="Width" Value="150"></Setter>
                </Style.Setters>
            </Style>
            <DataTemplate x:Key="SearchComboItemTemplate" >
                    <TextBlock DataContext="{Binding}">
                            <TextBlock.Text>
                              <MultiBinding StringFormat="{}{0}, {1}">
                                <Binding Path="lastName"/>
                                <Binding Path="firstName"/>
                              </MultiBinding>
                            </TextBlock.Text>
                    </TextBlock>
            </DataTemplate>

<ComboBox  ItemTemplate="{StaticResource SearchComboItemTemplate}" Style="{StaticResource SearchComboStyle}" 
                    ItemsSource="{Binding Path=PhysiciansList, RelativeSource={RelativeSource AncestorType=local:ExamViewerControl, AncestorLevel=1}}"      IsTextSearchEnabled="True" IsTextSearchCaseSensitive="False" IsEditable="True" TextSearch.TextPath="Person.LastName" /> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T14:00:09.450

升级版：~~看起来你需要设置[SelectionBoxItemTemplate](http://msdn.microsoft.com/en-us/library/system.windows.controls.combobox.selectionboxitemtemplate.aspx)~~.

您可以使用[DisplayMemberPath](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.displaymemberpath.aspx)或[TextSearch.TextPath](http://msdn.microsoft.com/en-us/library/system.windows.controls.textsearch.textpath.aspx)来启用搜索，而无需修改 ToString()。

# jquery - 使页面在重定向之前等待提交完成

> ID：10210800
> 
> 赞同：1
> 
> 时间：2012-04-18T13:49:09.380
> 
> 标签：jquery, asp.net-mvc-3, asynchronous, form-submit

我正在开发一个 ASP.NET MVC3 Web 应用程序

我正在使用 Jquery 提交多个表单

```
for (var i = 0; i < AllForms.length; i++) {
            $(AllForms[i]).trigger('submit');
        } 
```

然后我重定向到主页

```
window.location.href = '@Url.Action("Index", "Home")'; 
```

我的问题是，表单提交是异步完成的，有时页面会在所有提交结束之前重定向。

如何让页面等待提交完成然后重定向？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:57:30.020

```
var formCount = $('form').length;
$('form').each(function() {
    jQuery.post(url, $(this).serialize(), function() {
        formCount--;
        if(formCount === 0) {
            window.location.href = '@Url.Action("Index", "Home")';
        }
    });
}); 
```

试试这个。这是一个简化版本，但也许您需要额外检查 ajax 请求是否已成功发送。

# node.js - 如何在猫鼬中设置 objectId 属性？

> ID：10210802
> 
> 赞同：2
> 
> 时间：2012-04-18T13:49:19.163
> 
> 标签：node.js, mongodb, mongoose

我有一个名为 Message 的模式，如下所示；

```
Message = new Schema({
    id: Number,
    sender: ObjectId,
    receiver: ObjectId,
    date: Date,
    content: String,
    type: Number
}); 
```

以及如下所示的用户模式；

```
User = new Schema({
 id: Number,
 username: String,
 isOnline: Boolean
}); 
```

我想在收到新消息时设置消息项的发送者和接收者属性。收到消息后，我正在创建一个新的消息文档并设置其属性。但我不知道如何设置发送者和接收者属性（这应该是对用户文档中实体的引用）。我正在使用的代码如下所示。你可以随意判断代码，这就是我想要的。我不知道摆脱它的正确方法。但似乎不是这个。当我使用下面的代码时，我看不到发送者和接收者属性已设置。我认为这可能是因为 findOne 是异步的（我不知道是不是）。

```
var m = new Message();
m.content = messageData.text;
m.id = messageId;
User.findOne({id: socket.userId}, function (e, o) {
  m.sender = o;
});

User.findOne({id: messageData.userId}, function (e, o) {
  m.receiver = o;
});

m.save(function (e) {
  if (!e) {
    console.log("message is saved to the mongodb...");
  }
}); 
```

如果您能说出正确的方法，那就太好了。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T17:39:13.713

您快到了。你是对的，这`findOne`是异步的。您只需要处理他们的回调并在他们都响应后保存消息。这是您可以使用的典型模式：

```
var m = new Message();
m.content = messageData.text;
m.id = messageId;
User.findOne({id: socket.userId}, function (e, o) {
  if (e) return handleError(e); // assuming you want to handle errors somehow
  m.sender = o;
  m.sender && m.receiver && save();
});

User.findOne({id: messageData.userId}, function (e, o) {
  if (e) return handleError(e); // assuming you want to handle errors somehow
  m.receiver = o;
  m.sender && m.receiver && save();
});

function save () {
  m.save(function (e) {
    if (e) return handleError(e);
    console.log("message is saved to the mongodb...");
  });
} 
```

# java - HTTP 状态 404 描述 请求的资源 () 不可用

> ID：10210804
> 
> 赞同：0
> 
> 时间：2012-04-18T13:49:29.427
> 
> 标签：java, eclipse, jakarta-ee, tomcat7

我是 Java EE 的初学者。我正在使用 Eclipse Helios 3.6.2 和 Tomcat 7。我使用 JSF 2.0 创建了一个动态 Web 项目。当我运行一个简单的页面时，出现错误：

```
HTTP Status 404 - /first/
type Status report
message /first/
description The requested resource (/first/) is not available.
Apache Tomcat/7.0.27 
```

代码：

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html">
    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
        <title>first page</title>
    </h:head>
    <h:body>

    </h:body>
</html> 
```

我的项目有什么问题？如何部署项目？我应该改变`<Host appBase="webapps" autoDeploy="true" name="localhost" unpackWARs="true">`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:52:50.630

需要在eclipse中添加tomcat服务器，然后部署项目

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T15:21:58.753

我下载了 eclipse 和 tomcat 并使用以下步骤测试了一个新的动态 Web 项目：

1）在服务器中添加了tomcat

2）创建动态Web项目，目标运行时为Apache tomcat。

3）创建了一个新的虚拟jsp

4）右键单击项目并选择 Run on Server 。

我可以看到虚拟页面。

# c - 如何使用代码块和目标定义测试静态库项目

> ID：10210823
> 
> 赞同：3
> 
> 时间：2012-04-18T13:50:46.163
> 
> 标签：c, project-management, codeblocks

我有一个静态库项目，现在我想测试一些功能。为了实现我的目标，我添加了一个控制台类型的新目标，因为当我尝试“运行”我的库时，我得到了正确的消息“......选择要运行的主机应用程序......”，然后我在这个目标中添加了一个使用某些功能的测试文件 test.c。

据我所知，目标是处理源文件的不同方式，因此发布目标生成 *.a 文件，而调试目标生成其他文件。

```
// test.c
#include <stdio.h>

struct object_geometry *load_ObjModel(char *fileName);

int main()
{
    printf("Buongiorno!");
    load_ObjModel("../dado.obj");
    return 0;
} 
```

编写 test.c 后，我选择了最后创建的目标，在调试过程中有些东西不起作用，因为我不能使用“逐行执行”的模式，或者在上面的代码中放置断点，所以：

*   如何在不创建新项目的情况下调试我的库？
*   代码块中的目标是什么？
*   （其他有用的相关信息表示赞赏）

# postgresql - Postgresql同时查询COUNT和MAX？

> ID：10210824
> 
> 赞同：1
> 
> 时间：2012-04-18T13:50:49.317
> 
> 标签：postgresql

```
SELECT id,icon,type,cnt 
FROM  capability 
JOIN (
    SELECT s0_.capability_id AS capability_id0 ,
           count(capability_id) as cnt  
    FROM service_offer_capability s0_ 
    INNER JOIN service_offer s1_ ON s0_.service_offer_id = s1_.id 
    WHERE s0_.value <> 'i:0;' AND s1_.service_id = 2 
    GROUP BY s0_.capability_id
) af
ON af.capability_id0=id; 
```

我想要做的就是将 max(cnt) 作为额外的列。我知道您可以通过 cnt 订购并获得第一个，但我正在寻找替代方案。是否有可能或者我必须运行多个查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T14:15:27.353

这应该这样做：

```
SELECT id,
       icon,
       type,
       cnt,
       max(cnt) over () as max_cnt
FROM  capability 
JOIN (
    SELECT s0_.capability_id AS capability_id0 ,
           count(capability_id) as cnt  
    FROM service_offer_capability s0_ 
    INNER JOIN service_offer s1_ ON s0_.service_offer_id = s1_.id 
    WHERE s0_.value <> 'i:0;' AND s1_.service_id = 2 
    GROUP BY s0_.capability_id
) af
ON af.capability_id0=id; 
```

# c# - 由于空字段，用户控件无法启动

> ID：10210828
> 
> 赞同：0
> 
> 时间：2012-04-18T13:51:06.777
> 
> 标签：c#, wpf, xaml, user-controls

由于空字段，我的用户控件无法启动，我真的很生气，我的代码如下：

```
 public MyControl()
       {
        protected override void OnInitialized(EventArgs e)
        {
         base.OnInitialized(e);
         string userinputMainWindow = (string)App.Current.Properties["TextBoxString"];
         Foreach
         {
            TextBlock textBlock2 = new TextBlock();
            textBlock2.Text = String.Format(userinputMainWindow); // null
            textBlock2.TextAlignment = TextAlignment.Left; 
```

但我不认为这是我需要的，我怎样才能阻止代码在启动时初始化并且只在我调用代码时进行初始化？

例如，在我的主窗口上，我这样调用用户控件：

```
 private Dictionary<string, UserControl> _userControls = new Dictionary<string, UserControl>();
    public Dictionary<string, UserControl> GetUserControls()
    {
        return _userControls;
    }
    public MainWindow()
    {
        InitializeComponent();

        List<string> userControlKeys = new List<string>();
        userControlKeys.Add("MyControl");
        Type type = this.GetType();
        Assembly assembly = type.Assembly;
        foreach (string userControlKey in userControlKeys)
        {
            string userControlFullName = String.Format("{0}.UserControls.{1}", type.Namespace, userControlKey);
            UserControl userControl = (UserControl)assembly.CreateInstance(userControlFullName);
            _userControls.Add(userControlKey, userControl);
        }

    }
    private void btnGeneral_Click(object sender, RoutedEventArgs e)
    {

        App.Current.Properties["TextBoxString"] = textBox1.Text;

        PanelMainContent.Children.Clear();
        Button button = (Button)e.OriginalSource;
        Type type = this.GetType();
        Assembly assembly = type.Assembly;

        PanelMainContent.Children.Add(_userControls[button.Tag.ToString()]);
    } 
```

有没有办法停止用户控件初始化，只有当我点击`btnGeneral_Click`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:56:15.283

在 WPF 中，这种事情通常会通过数据绑定来完成，但是您可以通过在将用户控件添加到面板之前在用户控件上设置一个属性来快速完成此操作。

向您的用户控件添加一个属性：

```
public string TextBlockString
{
    get
    {
        return this.textBlock2.Text;
    }

    set
    {
        this.textBlock2.Text = value;
    }
} 
```

然后在`btnGeneral_Click`：

```
private void btnGeneral_Click(object sender, RoutedEventArgs e)
{

    App.Current.Properties["TextBoxString"] = textBox1.Text;

    PanelMainContent.Children.Clear();
    Button button = (Button)e.OriginalSource;
    Type type = this.GetType();
    Assembly assembly = type.Assembly;

    MyControl myControl = _userControls[button.Tag.ToString()];
    myControl.TextBlockString = textBox1.Text;

    PanelMainContent.Children.Add(myControl);
} 
```

# ruby-on-rails - 在 Rails 索引中对对象进行排序

> ID：10210830
> 
> 赞同：1
> 
> 时间：2012-04-18T13:51:12.547
> 
> 标签：ruby-on-rails, sorting, controller, indexing

有没有办法通过**index**中的 rails 中的控制器订购项目列表？

就像是

```
def index
  @items = Item.all(order_by :date)
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T13:56:50.420

当然有，事实上，这正是你所说的，除了你的方法调用是关闭的。

```
def index
    @items = Item.order(:date)
end 
```

您的索引视图（可能是 index.html.erb）正在寻找一个`@items`数组，对吗？好吧，您可以按照您认为合适的方式格式化/订购/等数据，没问题！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T13:55:55.413

试试这个：

```
@items = Item.all
@items.sort! { |a,b| a.date <=> b.date } 
```

Ruby 支持另一种方法：

```
@items = Item.all.sort_by &:date 
```

# informix - Informix 4GL termcap 的功能代码列表

> ID：10210831
> 
> 赞同：3
> 
> 时间：2012-04-18T13:51:18.583
> 
> 标签：informix, 4gl, termcap

是否有一个参考文档列出了 4GL 实际使用的所有功能代码（理想情况下，所有出现在 4GL RDS 提供的 termcap 中的代码）？

* * *

例如：

> gs - 启动图形模式（画框字符）
> GS - 启动图形模式？
> 
> ho - 光标到起始位置
> HM - 光标到起始位置？（来自usenet I4GL termcap）

我还想知道为什么会有重复，以及大写字母是否用于某些过时的产品并且可以从 termcap 条目中丢弃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T14:17:23.860

它位于 I4GL 参考手册 7.32 版的附录 F 中（实际上是当前版本，因为所有 I4GL 当前都处于 7.50 版）。

[我从IBM](http://publib.boulder.ibm.com/infocenter/ifxhelp/v0/index.jsp)下载了 (7.32) 参考手册（实际上是从[http://www.informix.com/](http://www.informix.com/)开始——“www”至关重要！——然后从左侧菜单中选择“Library”，然后转到下一个屏幕右侧框中的“其他 Informix 产品的文档”）。然后展开“工具”部分，并选择 I4GL。您可以找到 I4GL 的古老版本以及当前版本的手册。

根据您的`termcap`来源，您可能有一堆未使用的描述代码。简而言之，大约在 1992 年，仅针对一个版本，有一些额外的 I4GL 产品：I4GL Forms 和 I4GL Menus 和 I4GL QuickReports 或类似的东西。这些具有大量扩展的非标准光标描述。I4GL 本身从未使用它们，因为`termcap`文件包含（并且可能仍然包含）那些额外但不相关的条目。`GS`和代码可能属于该`HM`类别。这`ho`是一个完全标准的条目；`gs`可能是 Informix 扩展。

您可以在线找到 X/Open terminfo 规范。他们曾经也有一个包含 termcap 的版本，但不久前（现在可能是 5 年前）正式取代了一个新版本。这是关于什么应该可用的很好的文档。请注意，I4GL 并未使用所有可能的标准属性（可能没有程序使用）。

另请注意，I4GL 'curses' 库是古代 curses 库的子集，扩展（在过去也很长一段时间）具有一些额外的容量。

# winforms - Form1.Designer.cs 难以保持在版本控制之下

> ID：10210832
> 
> 赞同：4
> 
> 时间：2012-04-18T13:51:19.927
> 
> 标签：winforms, version-control, windows-forms-designer

我正在使用 Visual Studio 2008 开发一个 winform 应用程序，每次我使用集成设计器更改表单中的某些内容时，文件 Form1.Designer.cs 和 Form1.resx 都会更改内容顺序。

结果，它使这些文件的版本控制变得复杂，因为差异工具在提交过程中看到了很多差异，尽管有时只是轻微的编辑......

有人解决过这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T13:55:50.810

很不幸的是，不行。Winforms 设计师因引入大量文本更改而臭名昭著，而这些更改几乎没有（甚至没有）语义更改。换句话说，它经常会在设计器中重新排列或重新生成代码，以使文本与原始文本完全不同，即使它在很大程度上做了相同的事情。这种行为有时会被第三方工具放大（我注意到 Infragistics 的 WinForms 工具以这种方式完全是疯狂的）。

恐怕除了确保经常检查之外，在源代码管理中确实没有很好的方法来处理它。这是 WPF 的优点之一，因为它都是 XAML，并且更容易跟踪更改的内容。

# python - python：实例属性错误

> ID：10210833
> 
> 赞同：5
> 
> 时间：2012-04-18T13:51:20.360
> 
> 标签：python

我得到一个命令来启动一个班级的人。个人有一个字段：“姓名”。'name' 字段是可选的，这意味着如果 dict 没有 'name' 项，那么就没有 person 的 'name' 值。我使用 getter 方法来获取实例属性，但如果没有“名称”值，它会抛出错误。不知道有没有什么好的编程风格来改进我的代码？因为python在运行时创建实例字段，所以我不知道如何像java一样使用getter。

```
class Person:
    def __init__(self,person_dict):
        try:
            self.name = person_dict['name']
        except Exception:
            pass

    def getName(self):
        return self.name

pdict = {}
p = Person(pdict)
print p.getName() 
```

AttributeError：Person 实例没有属性“名称”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T13:54:47.380

```
class Person:

    def __init__(self,person_dict):
        self.name = person_dict.get('name') 
```

在这种情况下`self.name = person_dict.get('name')`不会引发 Exception 并且 Person 对象将具有`name`属性（`None`默认情况下）

UPD。由于`getName`方法没用，我从示例中删除了它。直接访问`name`attr。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T13:56:20.163

```
class Person:
    def __init__(self,person_dict):
        self.name = person_dict.get('name', 'default_name')

pdict = {}
p = Person(pdict)
print p.name  # there is no need for getter 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:58:28.413

如果您不希望出现异常，则应确保实例具有`name`. 由于如果在实例上找不到属性，则查找会退回到类，因此一种简单的方法是简单地将`name = None`（或您希望实例使用的任何默认值）添加到类定义中。分配给实例上的属性将“隐藏”默认值。

```
class Person:
    name = None
    def __init__(self,person_dict):
        try:
            self.name = person_dict['name']
        except Exception:
            pass 
```

你可以改为`__init__`这样写：

```
def __init__(self,person_dict):
    self.name = person_dict.get('name') 
```

如果找不到键，则`get()`字典方法返回，或者您可以提供具有不同默认值的第二个参数。`None`

# objective-c - UILabel 移入视图

> ID：10210834
> 
> 赞同：0
> 
> 时间：2012-04-18T13:51:22.530
> 
> 标签：objective-c, cocoa-touch, uilabel

有谁知道我如何在以编程方式创建的标签视图内移动（即移动到点（200,200）。这是创建它的代码。

```
UILabel *myLabel = [[UILabel alloc]initWithFrame:CGRectMake(10, 10, 50, 50)];
[self.view addSubview:myLabel];
myLabel.text=@"Beppe";
myLabel.shadowColor=[UIColor grayColor];
myLabel.textColor=[UIColor blueColor]; 
```

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T14:10:22.537

```
UILabel *myLabel = [[UILabel alloc]initWithFrame:CGRectMake(0, 0, 50, 50)];
myLabel.text=@"Beppe";
myLabel.center=CGPointMake(200, 200);
myLabel.shadowColor=[UIColor grayColor];
myLabel.textColor=[UIColor blueColor];
[self.view addSubview:myLabel]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T13:57:45.257

这会将标签中心移动到（200,200），非常标准的东西

```
myLabel.center=CGPointMake(200, 200) 
```

# iphone - 是否可以通过获取它们的 IP 地址来使用套接字连接两个 ios 设备？

> ID：10210835
> 
> 赞同：16
> 
> 时间：2012-04-18T13:51:27.583
> 
> 标签：iphone, objective-c, ios, xcode, network-programming

我想在没有任何服务器实现的情况下通过套接字连接多个设备。我将只使用它来获取将注册的设备的 IP 地址。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-27T19:23:25.150

对等通信有两个主要问题：发现和可达性。

首先，您需要知道其他对等方的 IP 地址才能连接到它们。一旦你连接到对等点的网格，它们都可以互相更新网络状态，相互推荐更好的对等点，传递新加入和离开的对等点的通知等。但是你有设计和实施交易该信息的机制。更重要的是，您需要以某种方式快速启动事物，因为当一个新的对等点启动时，它只是在自己的网格中，并且没有信息可以提供给自己。

一种可能性是让少数著名的“超级同行”（您运行的）始终保持连接，并将他们的地址烘焙到应用程序中。或者您可以使用“介绍服务器”而不是对等服务器，提供大致相同的功能。或者您可以有一些外部交易地址的方式（最简单的是用户在网络论坛或 IRC 频道或亲自交易它们并手动输入它们），这可以在不同程度上实现自动化。还有一些捷径可以提供帮助——只要 LAN 上的一个对等点已经存在，Bonjour 就可以让其他对等点加入网格；GameCenter/GameKit 可用作自动化的外部交易网络；等等

一旦你解决了发现问题，你仍然有可达性问题。大多数 iOS 设备通常没有可公开访问的 IP 地址；相反，它们位于进行网络地址转换的路由器之后，无论它们是家庭 WiFi 路由器还是蜂窝运营商的 3G 网络。这意味着您需要某种方式来进行 NAT 打孔，以使两部 iPhone 相互通话。知道每个设备的公共地址和内部地址的人可以安排他们建立彼此的连接。您可以让普通同行执行此操作（尽管这会使启动问题变得更大）或让您的超级同行/介绍服务器/等。做。

如果您想自己构建所有这些，您可能想查看其他实现。BitTorrent（包括跟踪器和 DHT）在从好奇的最终用户的“对孩子撒谎”到详细的协议规范和开源实现的各个级别都得到了很好的理解和记录。然后看看其他一些 P2P 网络，因为 BitTorrent 并不完美，并且不会尝试做每个人都想出的所有事情。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-27T16:58:18.160

您可以使用[GameKit](http://developer.apple.com/library/ios/#DOCUMENTATION/NetworkingInternet/Conceptual/GameKit_Guide/MatchesandVoice/MatchesandVoice.html#//apple_ref/doc/uid/TP40008304-CH10-SW9)。它有可以帮助你的[配对api。](http://developer.apple.com/library/ios/#DOCUMENTATION/NetworkingInternet/Conceptual/GameKit_Guide/Matchmaking/Matchmaking.html#//apple_ref/doc/uid/TP40008304-CH9-SW1)

它可以用于非游戏应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-03T18:06:17.987

我一直在做类似的事情，这是一个巨大的痛苦。有 3 个考虑因素：1）可达性 2）发现 3）连接本身。

1) 甚至不要考虑使用 3g/4g，它只是不能很好地保持打开的套接字连接。

2）我会在互联网上的两者之间使用某种代理服务来连接两者。对于发现，您可以只列出服务上可用的设备。

3) 对于连接，我发现 IOS 套接字库使用起来相当痛苦，但如果你深入到 BSD 套接字级别，它并没有那么糟糕。我认为使用 zmq 套接字会很有趣；这可能会简化代理服务的编写。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T08:15:18.587

你不能。如果设备全部通过 wifi 在线，则可能并依赖路由器设置，就像 pc 连接一样。如果某些设备通过 3g 或 gprs 协议连接，它们可能根本没有 IP 地址。

# javascript - 谷歌地图 Ya、Za 和 $a

> ID：10210836
> 
> 赞同：4
> 
> 时间：2012-04-18T13:51:41.577
> 
> 标签：javascript, google-maps

我正在使用谷歌地图来查找点击位置的纬度和经度。在将javascript事件对象字符串化后，我发现

```
{"latLng":{"Za":25.800813110356653,"$a":78.7055234375},"pixel":{"x":689,"y":336},"va":{"x":183.96837222222223,"y":108.99927181860028}} 
```

所以 Za 是 lat 而 $a 现在是 lng。

虽然两天前，我使用完全相同的代码并获得相同的对象：

```
{"latLng":{"Ya":25.800813110356653,"Za":78.7055234375},"pixel":{"x":689,"y":336},"va":{"x":183.96837222222223,"y":108.99927181860028}} 
```

困扰我的是他们一夜之间更改了对象名称。他们为什么要这样做，是否有任何可靠的方法来查找纬度和经度？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-18T15:16:41.170

内部名称将随着代码更改而更改：如果引入另一个令牌，那么一个被缩小的变量最终`Ya`可能是`Za`.

您**永远不**应该访问内部引用。**始终**使用记录在案的方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-18T14:32:06.613

好的。我已经部分找到了答案。

我们不需要打扰名称。我们可以使用函数来代替。

```
lat = e.latLng.lat();
lon = e.latLng.lng(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T20:46:50.533

Google 不会更改已发布方法的名称。但是，每当部署更新时，地图脚本文件都会通过一个混淆过程运行，该过程将代码中熟悉的名称减少为您尝试引用的短名称。每次对代码进行混淆时，结果都可能不同。正如 Andrew 在上面指出的，如果引入了新方法或变量，则可以摆脱之前的混淆顺序。（他们甚至可能会定期运行此过程，以防止人们像您在上面所做的那样访问内部成员）。

[http://en.wikipedia.org/wiki/Obfuscation_%28software%29](http://en.wikipedia.org/wiki/Obfuscation_%28software%29)

# javascript - 无法添加 Youtube iframe 标签

> ID：10210840
> 
> 赞同：1
> 
> 时间：2012-04-18T13:51:57.183
> 
> 标签：javascript, tinymce

我正在使用 TinyMce，我想添加另一个具有“Youtube 添加”功能的按钮。问题在于使用“mceInsertContent”添加 iframe：

```
h = '<iframe class="video" src="' + f.width.value + '" frameborder="0"></iframe>';
tinyMCEPopup.execCommand("mceInsertContent", false, h); 
```

你知道如何解决它吗？它不想在编辑器或最终页面上呈现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:59:09.017

出于安全原因，`iframe`不是可以通过 TinyMCE 提交的有效标签。但是，如果您确定它不会被滥用，您可以扩展您当前的有效元素列表以包含此标记。

[`extended_valid_elements`](http://www.tinymce.com/wiki.php/Configuration%3aextended_valid_elements)在您致电 时查看该物业`init()`。

# c# - 绑定到 Datagrid 的 ItemsSource 集合属性而不是单个项目

> ID：10210842
> 
> 赞同：1
> 
> 时间：2012-04-18T13:52:03.840
> 
> 标签：c#, binding, silverlight-4.0, collections, datagrid

我在尝试绑定集合中的一些属性而不是元素的属性时感到困惑。我什至不确定如何正确表达它...代码可能会更好地解释：这里是类型（不是实际代码，我已将其缩短为基础）：

```
public class myType
{
    public int P {get;set;}
}
public class myTypeCollection : ObservableCollection<myType>
{
    public int Ptotal {get { return this.Items.Select(i=>i.P).Aggregate((c,t)=>t = t + c); }}
    public int Pmin { get { this.Items.Min(i => i.P); } } //concept
    public int Pmax { get { this.Items.Max(i => i.P); } } //concept
} 
```

它们正在模板化控件中使用，其 XAML 如下所示：（添加注释以使其尽可能清晰）

```
<!-- myGridObject = new myTemplatedControl(); -->
<!-- myGridObject.DataContext = new myTypeCollection(); -->
<!-- NOTE: collection obviously is NOT empty in the real code -->
<sdk:DataGrid ItemsSource={Binding DataContext}> 
    <sdk:DataGridTemplateColumn Width="Auto">
        <sdk:DataGridTemplateColumn.HeaderStyle>
            <Style TargetType="sdk:DataGridColumnHeader">
                <Setter Property="ContentTemplate">
                    <Setter.Value>
                        <DataTemplate>

                            <!-- ?????? write out Ptotal in the header of the column ??????? -->
                            <!-- This throws a binding-related ArgumentException -->
                            <TextBlock Text="{Binding ???? Ptotal ?????}" />

    <!-- closing tags cut off -->
    <sdk:DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding P}" />
    <!-- closing tags cut off once more--> 
```

`{Binding P}`可以按预期工作，因为`P`它是项目的属性，但是如何访问集合的属性，例如`Ptotal`,`Pmin`等？

感谢您抽时间阅读。如果缺少任何信息，请指出，我会发布它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T08:53:21.023

结果客户改变了对网格标题的想法，他不想再在标题中显示总计。

顺便说一句，我一定尝试了 20 种不同的方法，包括修补各种类型的转换器，但我无法完成这个看起来不像看起来那么简单的任务。

再次感谢您提出的有趣建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T14:12:23.380

我认为问题在于 DataGrid 绑定到集合，并且每一行都绑定到单个项目，而不是集合。您需要访问链上的一个级别（回到集合本身）。

如果您正在运行 Silverlight 4+，则可以使用 relativesource。例如：

```
<TextBlock Text="{Binding Mode=OneWay, RelativeSource={RelativeSource FindAncestor, AncestorType=sdk:DataGrid, AncestorLevel=1}, Path=DataContext.Count}" 
```

否则，可能会创建对上下文的静态访问以通过绑定访问它`Source`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T14:10:59.033

所以你需要集合对象作为你的绑定源。

你需要这些：

[相对源标记扩展](http://msdn.microsoft.com/en-us/library/ms743599.aspx)

[Binding.RelativeSource 属性](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.relativesource.aspx)

像这样的东西（未经测试）：

```
 <TextBlock Text="{Binding RelativeSource={RelativeSource FindAncestor, 
AncestorType={x:Type myTemplatedControl}}, Path=DataContext.Ptotal}" /> 
```

如果 DataGrid 在您的自定义`myTemplatedControl`. 我并不完全清楚 myGridObject 到底是什么。主要思想是：

正如 MSDN 文档所说：Binding.RelativeSource`Gets or sets the binding source by specifying its location relative to the position of the binding target.`

如果您坚持使用 x:Type 扩展，这里有一个关于它的链接，因此您可以将它与您的自定义控件一起使用：

[X：类型](http://msdn.microsoft.com/en-us/library/ms753322%28v=vs.85%29.aspx)

另一种方法是，如果您命名您的容器元素（您的集合是数据上下文），那么您可以将该元素设置为绑定源：

```
<TextBlock Text="{Binding ElementName=yourElementName, Path=DataContext.Ptotal}" /> 
```

# css - 需要建议从两个简单的 CSS 中哪个更好

> ID：10210845
> 
> 赞同：1
> 
> 时间：2012-04-18T13:52:07.277
> 
> 标签：css

伙计们，我确实有两个非常简单的 CSS 做同样的事情（创建一个三角形），我需要你的建议，哪个更好。

**示例 1**

```
.leftArrow { 
    border-right: 5px solid #000;
    border-bottom: 5px solid transparent;
    border-top: 5px solid transparent;
    height:0px;
    width: 0px;
} 
```

在上面的示例中，我试图分别为右、下和上定义边框。现在的问题是如果我确实需要将边框从 5px 更改为 10px。我需要在 3 声明中进行更改。

因此，每次在 3 声明中进行一次更改都是不好的。假设我确实有所有（四个）方向的箭头。在那种情况下，我确实需要更改 4 X 3 = 12 声明。

这非常耗时:(

**示例 2**

```
.leftArrow { 
    border: 5px solid transparent;
    border-left-width: 0px;
    border-right-color: #000;
    height:0px;
    width: 0px;
} 
```

在第二个示例中，我在第一个声明“border: 5px solid transparent;”中定义了边框或所有边。在第二个声明中，我将左边框宽度从 5px 替换为 0px。并在第三个声明中将右边框颜色从透明更改为黑色。

现在在我的开场白中，在第一个声明中定义边框宽度然后在第二个声明中更改它也不是一个好主意。

第三次声明的情况相同。我正在将边框颜色从透明更改为黑色。

请给我你对这种情况的意见，或者如果你有更好的主意:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:54:50.907

使用带有变量的[http://sass-lang.com/ 。](http://sass-lang.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:58:01.340

如果我理解你的话，你的问题是，你不想一遍又一遍地改变同样的事情？那么[Less CSS](http://lesscss.org/ "更少的 CSS")可能适合你，它还允许你嵌套你的 CSS，最好的事情是，你可以将 Less CSS 编译为“真正的”CSS 或者包含`less.js`并且你不必编译它（但是我推荐第一个，所以它也适用于禁用 JS 的浏览器）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:59:38.100

我会这样做：

```
border: 5px solid #000;           /* Set base style */
border-width: 5px 5px 5px 0px;    /* All 5px except left */
border-color: #000 transparent    /* Top/bottom #000, left/right transparent */
height: 0px;
width: 0px; 
```

第一行设置了一个“基本”样式，它被接下来的两个`border-`属性覆盖。您可以使用`border-width`和`border-color`为元素的四个边设置不同的颜色和宽度。

上面的`border-color`属性将左边的颜色设置为透明，但是因为左边`border-width`是0，所以没有任何效果。

* * *

为了使事情更容易改变，这样做：

```
border: 5px solid #000;           /* Set base style */
border-left: none;                /* Get rid of left border */
border-color: #000 transparent    /* Top/bottom #000, left/right transparent */
height: 0px;
width: 0px; 
```

现在您只需要更改第一个`border`属性。`border-left: none`负责确保左边框*永远不会*显示。你不必改变

* * *

这几乎和 LESS 或替代品一样简单，并且坚持纯 CSS。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T14:07:24.847

我无法想象你正在尝试做什么，但如果我理解正确，你可以做这样的事情来减少代码重写：

定义常用箭头属性

```
.arrow {
    border: 5px solid;
    color: #000;
    height: 0px;
    width: 0px;
} 
```

然后在需要的地方关闭边框

仅在左箭头上显示左边框和下边框

```
.arrow.left {
    border-right-color: transparent; 
    border-top-color: transparent;
} 
```

这样您就可以在 .arrow 块中保留基本样式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T14:11:24.453

我会这样做：

```
<div class="arrow arrow-left"></div>

.arrow {
    border:5px solid #000;
    width:0;
    height:0;
}
.arrow-left {
    border-left:0;
    border-bottom-color:transparent;
    border-top-color:transparent;
} 
```

[http://jsfiddle.net/pdRYE/15/](http://jsfiddle.net/pdRYE/15/)

在这种情况下，您只有一个边框宽度声明，并且您使用第二个类只是为了隐藏您不需要的边框。

# android - 文件下载挂起

> ID：10210851
> 
> 赞同：0
> 
> 时间：2012-04-18T13:52:26.647
> 
> 标签：android, android-asynctask, download, httpurlconnection, connection-reset

经过大量搜索后，我无法找到解决文件下载问题的解决方案。

以下脚本旨在通过 **WebViewClient**从远程（Hotmail）服务器下载 csv 文件。

登录过程是通过他们的标准网站完成的，但我想使用以下下载类捕获下载的 csv 文件并存储在自定义位置。

它适用于直接链接到例如**site.com/file.pdf**的文件的 URL，但不适用于处理过的 URL，例如**site.com/downloadFile.php?n=xxxx**，它只是挂起，直到**连接重置由远程服务器**

```
 private class DownloadFile extends AsyncTask<String, Integer, String> {

    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        mProgressDialog.show();
    }

    @Override
    protected void onProgressUpdate(Integer... progress) {
        super.onProgressUpdate(progress);
        mProgressDialog.setProgress(progress[0]);
    }

     @Override
     protected void onPostExecute (String result){

     super.onPostExecute(result);

     mProgressDialog.dismiss();
     mProgressDialog = null;
     }

    @Override
    protected String doInBackground(String... sUrl) {

        try {

            Log.i("File download", "Started from :"+sUrl[0]);

            URL url = new URL(sUrl[0]);
            //URLConnection connection = url.openConnection();
            File myDir = new File(Environment.getExternalStorageDirectory() + "/myDir");

            // create the directory if it doesnt exist
            if (!myDir.exists()) myDir.mkdirs();            

            HttpURLConnection connection = (HttpURLConnection) url.openConnection();

            //Follow redirects so as some sites redirect to the file location
            connection.setInstanceFollowRedirects(true);        
            connection.setDoOutput(true);           

            connection.connect();

            File outputFile     =   new File(myDir, "hotmail_contacts.csv");

            // this will be useful so that you can show a typical 0-100%
            // progress bar
            int fileLength      = connection.getContentLength();

            // download the file
            InputStream input   = new BufferedInputStream(url.openStream());                
            OutputStream output = new FileOutputStream(outputFile);

            byte data[] = new byte[1024];
            long total = 0;
            int count;

            while ((count = input.read(data)) != -1) {

                total += count;
                // publishing the progress....
                publishProgress((int) (total * 100 / fileLength));
                output.write(data, 0, count);
            }

            connection.disconnect();
            output.flush();
            output.close();
            input.close();

            Log.i("File download", "complete");

        } catch (Exception e) {

            Log.e("File download", "error: " + e.getMessage());

        }
        return null;
    }
} 
```

上面的 AsyncTask 在**onDownloadStart(....)**方法中调用如下：

```
public void onDownloadStart(String url, String userAgent, String contentDisposition, String mimeType, long length) {

        Log.i("File download", "URL:" + url 
                + " UserAgent:" + userAgent
                + "ContentDisposition:" + contentDisposition 
                + "Mime:"+ mimeType + "Length:" + Long.toString(length));

        // instantiate it within the onCreate method
        mProgressDialog = new ProgressDialog(Email_import.this);
        mProgressDialog.setMessage("File download");
        mProgressDialog.setIndeterminate(false);
        mProgressDialog.setMax(100);
        mProgressDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);

        // start a new download
        DownloadFile downloadFile = new DownloadFile();
        downloadFile.execute(url);

    }// end onCreate 
```

所有相关权限都在清单中，例如写入外部存储、互联网和读取网络状态。

我在这里错过了什么吗？任何帮助将非常感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:56:26.967

在查看了 [此处][1] 列出的另一篇文章后

[1]：[将文件从 webview 下载到自定义文件夹](https://stackoverflow.com/questions/4860484/download-a-file-from-webview-to-a-custom-folder)我已经对我的代码进行了一些调整，以使用**HttpClient**对象将 URL 作为**HttpPost**请求调用，如下所示，它似乎运行良好：

 **```
 // Create client and set our specific user-agent string
            HttpClient client = new DefaultHttpClient();
            HttpPost request = new HttpPost(sUrl[0]);               
            request.setHeader("User-Agent", sUrl[1]);               

            HttpResponse response = client.execute(request);

            Log.i("File download", "Started from :" + sUrl[0]);

            File myDir = new File(Environment.getExternalStorageDirectory() + "/myDir");

            // create the directory if it doesnt exist
            if (!myDir.exists())    myDir.mkdirs();

            File outputFile = new File(myDir, "hotmail_contacts.csv");

            InputStream input   = response.getEntity().getContent(); 
```**

# java - java - tf*idf 实现？

> ID：10210856
> 
> 赞同：3
> 
> 时间：2012-04-18T13:52:51.177
> 
> 标签：java, relevance, tf-idf

我基本上是在创建一个搜索引擎，我想实现 tf*idf 来根据搜索查询对我的 xml 文档进行排名。我该如何实施？我该如何启动它？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-18T11:02:31.983

令人惊讶的是，这里没有提到 Weka 库。Weka 的[StringToWordVector 类](http://weka.sourceforge.net/doc.dev/weka/filters/unsupervised/attribute/StringToWordVector.html)实现了 TF-IDF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-30T16:51:04.513

[tfidf](https://github.com/wpm/tfidf)是一个独立的 Java 包，用于计算 Tf-Idf。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:56:09.727

我过去是这样做的，我使用[Lucene](http://lucene.apache.org/core/)来获取 TD*IDF 数据。

不过，这需要相当多的摆弄，所以如果有其他人们知道更容易的解决方案，那就使用它们。

首先查看[org.apache.lucene.index中的](http://lucene.apache.org/core/3_6_0/api/all/org/apache/lucene/index/package-frame.html)[TermFreqVector](http://lucene.apache.org/core/3_6_0/api/all/org/apache/lucene/index/TermFreqVector.html)和其他类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-29T02:47:49.203

Apache Mahout：

[https://github.com/apache/mahout/blob/master/mr/src/main/java/org/apache/mahout/vectorizer/TFIDF.java](https://github.com/apache/mahout/blob/master/mr/src/main/java/org/apache/mahout/vectorizer/TFIDF.java)

我相信它需要一个 Hadoop 文件系统，这是一项额外的工作。但效果很好。

# android - 检测 uiMode 或键盘更改 android

> ID：10210868
> 
> 赞同：0
> 
> 时间：2012-04-18T13:53:42.467
> 
> 标签：android, android-ui, android-configchanges

我试图构建一个测试应用程序，它仅在发生配置更改时中继一条 toast 消息。（这就是它应该做的，它不起作用）最终的目的是检测用户是否将平板电脑放入键盘支架或将其从键盘支架中取出。我的清单和主要活动如下..我认为当平板电脑对 uiMode 或外部键盘进行配置更改时，此代码会触发敬酒..但是当我停靠/取消停靠时没有任何反应..请帮忙

我的清单：

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<uses-sdk android:minSdkVersion="12" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name=".UiModeTestActivity"
        android:configChanges="keyboard|uiMode"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

我的爪哇：

```
 package com.eliddell;

import android.app.Activity;
import android.content.res.Configuration;
import android.os.Bundle;
import android.widget.Toast;

public class UiModeTestActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
    @Override
    public void onConfigurationChanged(Configuration newConfig) {
      super.onConfigurationChanged(newConfig);
      Toast.makeText(getApplicationContext(), "new config:"+newConfig, Toast.LENGTH_LONG).show();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T17:24:12.053

您的代码看起来不错，但是...

正如消息来源所说：

```
/**
 * The kind of keyboard attached to the device.
 * One of: {@link #KEYBOARD_NOKEYS}, {@link #KEYBOARD_QWERTY},
 * {@link #KEYBOARD_12KEY}.
 */
public int keyboard; 
```

所以，我认为如果 KEYBOARD_QWERTY 更改为 KEYBOARD_12KEY 键盘会改变

消息来源的另一部分说：

```
 /**
     * A flag indicating whether any keyboard is available.  Unlike
     * {@link #hardKeyboardHidden}, this also takes into account a soft
     * keyboard, so if the hard keyboard is hidden but there is soft
     * keyboard available, it will be set to NO.  Value is one of:
     * {@link #KEYBOARDHIDDEN_NO}, {@link #KEYBOARDHIDDEN_YES}.
     */
    public int keyboardHidden; 
```

所以，也许`android:configChanges="keyboard|uiMode"`你会尝试`android:configChanges="keyboardHidden|uiMode"`

不幸的是，我没有适配器将键盘插入我的设备并检查我的理论。所以试试吧！

# ios - 使用 RestKit 回滚同步

> ID：10210869
> 
> 赞同：2
> 
> 时间：2012-04-18T13:53:43.213
> 
> 标签：ios, core-data, restkit

我正在构建一个支持同步的应用程序。由于同步需要多个请求，因此在同步期间存在持续错误的风险（例如，如果部分但不是所有请求失败）。

**如果同步期间出现任何问题，我想回滚所有更改，以便完全执行同步或根本不执行同步。**

似乎 RestKit 在获取数据时保存了 managedObjectContext 。这意味着我无法使用 NSUndoManager 来处理撤消/回滚。这样做的首选方法是什么？备份对象存储文件（sqlite）并在同步失败时替换它是一种方法，但它看起来不是很“纯粹”。

# bison - 给定上下文无关语法，查找模棱两可的陈述

> ID：10210872
> 
> 赞同：2
> 
> 时间：2012-04-18T13:53:52.187
> 
> 标签：bison, lex, context-free-grammar, ambiguous

我有一个家庭作业，在给定语句定义的语法的情况下，我应该在其中检测语句中的歧义。

例子：

```
Grammar: S -> S + S | S * S | id
Statement: id * id + id 
```

上面的陈述是模棱两可的，因为两个解析树是可能的。

到目前为止，我有以下歧义：

```
1) 运算符优先级（上例）
2) if-else 悬空案例
3）无限循环（上面的例子是左递归的）
4) 关联性
```

你能告诉我更多可行的方法吗？

我必须使用 lex 和 bison (yacc) 设计这个解析器，并在 2 天内提交它，所以任何指针都会对语法和语句中的歧义有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:01:30.140

好吧，如果你有 lex 和 bison 在你的命令中，你可以简单地将语法输入 bison，它会告诉你它是否模棱两可。

否则，您必须构建整个 LALR1 解析器生成器算法，以确定是否存在使语法模棱两可的冲突。这些冲突在解析器构建阶段很晚才被检测到（我的解析器生成器在表生成步骤中找到它们）。也许您可以从我的代码中获取一些指示，它位于[https://github.com/Dervall/Piglet](https://github.com/Dervall/Piglet)

当您尝试填充操作表的一部分时，会发生自底向上解析器中移位/归约和归约/归约的经典案例，该部分已经填充了与您尝试放置的令牌具有相同优先级的条目在里面。

如果您在谈论 LL 解析器，那么无限循环并不是真正的模棱两可的语法 - 语法可以重构为非模棱两可的。

并且语句本身不会以任何方式影响语法是否模棱两可。无论给出什么输入，它都是模棱两可的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T17:48:01.753

一般来说，你不能——语法歧义是[不可判定](http://en.wikipedia.org/wiki/Ambiguous_grammar)的。

也就是说，您可以识别出许多明显模棱两可的语法模式。

*   左递归和右递归的任何（非无用）非终结符都是模棱两可的（涵盖您上面提到的所有情况，除了悬空其他情况）。
*   任何具有两个右递归规则的（非无用的）非终结符，其中一个是另一个的前缀是模棱两可的（包括 dangling-else）。

# xamarin.ios - UITableView 的 Elements 比 DataSource 多

> ID：10210873
> 
> 赞同：1
> 
> 时间：2012-04-18T13:53:55.903
> 
> 标签：xamarin.ios

我制作了一个 TableDataSource，它使用了我的自定义 TableCell，里面有两个按钮。

```
 List<ConductedActivitiesItem> _items = new List<ConductedActivitiesItem>();
        foreach(var item in this._logicActivities.Steps)
        {
            _items.Add(new ConductedActivitiesItem(){ Date = "12-13", Text = item.Lines[0], Checked = null });
        }

        var ds = new ConductedActivitiesDataSource(_items);
        var dg = new CSTableViewDelegate(null);

        dg.SelectionChanged += this.Steps_SelectionChanged;

        this.Pad_tbvMeasures.DataSource = null;

        this.Pad_tbvMeasures.DataSource = ds;
        this.Pad_tbvMeasures.Delegate = dg;
        this.Pad_tbvMeasures.ReloadData(); 
```

该列表有 4 项：a b c d

表格视图显示： a b c d a b c d a b c d

你们中有人知道为什么 List 显示的 Items 比 DataSource 的多吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T14:20:48.107

检查您的 NumberOfSections() 和 RowsInSetion() 方法以验证它们返回的值是否正确。

# c#-4.0 - 在 Windows Azure 中一段时间 后重复运行任务

> ID：10210878
> 
> 赞同：0
> 
> 时间：2012-04-18T13:54:09.507
> 
> 标签：c#-4.0, azure, azure-sql-database

我有一个任务（几个 C# 函数）在每个间隔后更新数据库。我如何在 Windows Azure 上实现这一点（假设部署后数据库也会迁移到 SQL Azure）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T14:15:34.663

有几种选择： - 使用第 3 方作业调度程序远程启动流程 - 部署一个使用 Server 2008 中内置的任务计划来调度流程的“工作实例”（这将需要启动任务） - 将计时器流程部署为作为另一个角色的一部分，只需确保您使用交通警察或单例样式模式，以防止多个实例同时尝试执行相同的进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T14:01:50.960

您可以开发和部署[Windows Azure Compute Worker Role](http://msdn.microsoft.com/en-us/library/windowsazure/gg432976.aspx)。这将是 Azure 中托管的长时间运行和后台操作的正确工具。根据您的任务正在做什么（CPU 密集程度如何），您可以选择一个非常小的角色大小以最小化成本。

您可能还可以将此类任务置于预先存在的网络或工作人员角色中（但这可能不是一个干净的解决方案，具体取决于您的任务正在做什么以及它应该运行的可靠性）。

# java - 在 Java 中模拟“属性”：如何使用公共字段作为属性？

> ID：10210881
> 
> 赞同：0
> 
> 时间：2012-04-18T13:54:18.987
> 
> 标签：java, properties

在[playframework](http://playframework.org)中，它使用 javassist 库来让一个类的公共字段可以用作`property`.

请参阅示例：

```
public class User {
    public String name;
}

User user = new User();
user.name = "Freewind"
System.out.println(user.name); 
```

在编译的时候，play用javassist增强字节码，最终代码类似：

```
public class User {
    private String name;
    public String getName() { return this.name; };
    public void setName() { this.name = name; };
}

User user = new User();
user.setName("Freewind");
System.out.println(user.getName()); 
```

您可以看到不仅该字段`name`具有 getter 和 setter，而且它的调用也更改为 getter 和 setter。

我想知道是否还有其他方法可以做到这一点（使用 javassist 以外的其他东西）？

我找到了[Annotation Processing Tool](http://docs.oracle.com/javase/1.5.0/docs/guide/apt/GettingStarted.html)，但我不确定它是否可以做到。

还是方面？或者是其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:58:16.253

You can look at [Project Lombok](http://projectlombok.org/), which does something similar, but with annotations. With project lombok you do need to use the getters and setters in your own code.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T13:55:12.887

不是没有其他工具。

与 C# 不同，Java 不支持属性。

# python - 生成列表的所有子集给出特定产品而不迭代整个powerset？（Python）

> ID：10210887
> 
> 赞同：-2
> 
> 时间：2012-04-18T13:54:44.960
> 
> 标签：python, list, itertools

> **可能重复：**
> [找到所有可能的数字组合以达到给定的总和](https://stackoverflow.com/questions/4632322/finding-all-possible-combinations-of-numbers-to-reach-a-given-sum)

我不想使用 Itertools，因为它以我不想要且无法使用的顺序输出东西（我需要能够评估组合生成器试图输出的内容，以决定我是否要继续下降那个分支）。

例如，假设我有一个列表 [1,2,3,4,5] 并且我想输出具有完整产品 <=12 的组合，而不会浪费迭代。如果我生成，比如说，[1,2,3]，这很好，因为 1*2*3=6。但是如果我尝试 [1,2,3,4] 那么 1*2*3*4=24，这大于 12，因此我什至不应该费心研究 [1,2,3,5]或 [1,2,4,5] 等等。

当前尝试：

```
from operator import mul

mylist=[1,2,3,4,5]
limit=12

def productOK(mylist): #but this can be any conditional, theoretically
    if reduce(mul, mylist) > limit:
        return False
    return True

def generateValidSubsets(mylist):
    for r in range(1,len(mylist)+1):
        start=mylist[:r]
        if productOK(start)==False: break
        #not sure how to recombine in the right order otherwise
        yield start

for combo in generateValidSubsets(mylist):
    print combo 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:27:19.300

我强烈建议您切换到递归实现。这将允许您更轻松地实施削减：

```
def subs(target, universe, currentsubs, currentproduct, goodsubs):
    first_from_universe_not_in_currentsubs = # an exercise for the reader
    newsubs = [first_from_universe_not_in_currentsubs] + currentsubs
    newproduct = currentproduct * first_from_universe_not_in_currentsubs
    if newproduct == target:
       return goodsubs + [newsubs]
    elif newproduct > target:
       return goodsubs
    else:
       return subs(target, universe, newsubs, newproduct, goodsubs)

subs(12, [1,2,3,4,5], [], 0, []) 
```

即使您填写了上面的空白，它也可能不太正确，但它确实向您展示了如何实现切割。

# android - android 二维码阅读器应用中添加 ZXing 库时出错

> ID：10210888
> 
> 赞同：1
> 
> 时间：2012-04-18T13:54:45.763
> 
> 标签：android, qr-code, zxing

嗨，我正在开发读取 QR 码的 android 应用程序。现在，我使用了 ZXing 库。现在，当我在我的应用程序中添加这个库时，它显示错误（见下图）。我不知道你会发生这种情况，请给我适当的指导。提前谢谢。我已经参考了这个链接[这个](http://damianflannery.wordpress.com/2011/06/13/integrate-zxing-barcode-scanner-into-your-android-app-natively-using-eclipse/)。![问题图片在这里](../Images/290d2ebcd3e3f8134643f72c1bb78c23.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T14:23:25.973

我发现了问题。问题是我添加的库位于不同的工作空间中。该库应位于同一工作区中。

# google-app-engine - Windows 上的 Google 安全数据连接器？

> ID：10210895
> 
> 赞同：0
> 
> 时间：2012-04-18T13:54:50.960
> 
> 标签：google-app-engine, integration

我想将 Google 安全数据连接器与应用引擎应用程序一起使用。我看到 SDC 代理的官方发行版仅包含 Linux 的说明。这可以在 Windows 机器上编译和运行吗？有没有人有这方面的经验或知道二进制发行版？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T17:07:20.857

SDC 在 Windows 上不受支持，但如果针对 Windows 调整安装脚本，它应该能够运行。我在 SDC google group 中发布了一个问题，并得到了 googler 的回复，指出没有 Windows 发行版，但他确实提到它在 Windows 内部运行。因此，也许它将来会可用。小组帖子在这里[https://groups.google.com/forum/?fromgroups#!topic/google-sdc/ZsrZi3pAJNg](https://groups.google.com/forum/?fromgroups#!topic/google-sdc/ZsrZi3pAJNg)

# sql - 在 Postgres 中手动对列进行排序的正确方法是什么？

> ID：10210898
> 
> 赞同：5
> 
> 时间：2012-04-18T13:55:07.627
> 
> 标签：sql, django, postgresql, sequence, autofield

我有一个用于开发票的 SaaS 宠物项目。在其中，我希望我的客户每个都从票号 1001 开始。显然，我不能在 Postgres 中使用简单的自动字段，只需将值添加 1000，因为我所有的客户都将共享同一个数据库和同一个`tickets`表。 . 我尝试使用整数列类型和查询（伪 SQL）`SELECT LATEST number FROM tickets WHERE client_id = [current client ID]`来获取最新的数字，然后使用该数字`+ 1`来获取下一个`number`. 问题在于，在并发的情况下，两张票很容易以这种方式以相同的数字结尾。我需要能够在 Django 中或使用原始 SQL 中执行此操作的数字（与使用 Bash 或其他任何类型的相比）。

我不是在寻找一种方法来强迫我的例子起作用。我只是在寻找一个解决方案来解决我需要为每个客户独立增加票号的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T15:19:30.177

我认为这个问题没有“便宜”的解决方案。在多用户环境中唯一安全（但不一定快速）的解决方案是为每个客户提供一个“计数器”表，其中一行。

在插入新票之前，每笔交易都必须先锁定客户的条目，如下所示：

```
UPDATE cust_numbers
  SET current_number = current_number + 1
WHERE cust_id = 42
RETURNING current_number; 
```

这将一步完成三件事

1.  增加该客户的当前“顺序”编号
2.  锁定该行，以便其他执行相同操作的事务必须等待锁定
3.  返回该列的新值。

有了这个新号码，您现在可以插入一张新票。如果事务被提交，它也会释放`cust_numbers`表上的锁，这样其他“等待数字”的事务就可以继续进行。

您可以将这两个步骤（更新..返回和插入）包装到一个存储函数中，以便集中处理其背后的逻辑。您的应用程序只会`select insert_ticket(...)`在不知道票号是如何生成的情况下调用。

您可能还想在客户表上创建一个触发器，以便在`cust_numbers`创建新客户时自动向表中插入一行。

这样做的缺点是您有效地序列化为同一客户插入新票的事务。根据系统中插入的数量，这可能会成为性能问题。

**编辑**
这样做的另一个缺点是，如果新开发人员忘记了这一点，您不会*被迫*以可能导致问题的方式插入票证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T14:02:59.310

您可以为每个客户创建序列，然后将列的值设置为`nextval('name_of_the_sequence')`。这实际上是如何`serial`工作的；在您的情况下，唯一的区别是您不使用列的默认值并且有多个序列。

在插入新行时创建那些选择正确的序列可以通过 PL/Pgsql 过程很好地完成。

# c++ - 无锁原子状态类 - 正确吗？

> ID：10210905
> 
> 赞同：3
> 
> 时间：2012-04-18T13:55:20.537
> 
> 标签：c++, qt, locking, atomic, test-and-set

我只是在尝试在结构上实现原子读/写时寻找反馈（明显的缺陷/改进方法）。

将有一个写入线程和多个读取线程。目的是防止读者对结构有不一致的看法，同时又不会过多地妨碍作者。

我正在使用 fetch-and-add atomic 原语，在这种情况下由 Qt 框架提供。

例如：

```
/* global */
OneWriterAtomicState<Point> atomicState;

/* Writer */
while(true) {  
  MyStruct s = atomicState.getState()
  s.x += 2; s.y += 2;
  atomicState.setState(s);
}

/* Reader */
while(true) {  
  MyStruct s = atomicState.getState()
  drawBox(s.x,s.y);
} 
```

OneWriterAtomicState 实现：

```
template <class T>
class OneWriterAtomicState
{
public:
    OneWriterAtomicState()
        : seqNumber(0)
    {
    }

    void setState(T& state) {
        this->seqNumber.fetchAndAddOrdered(1);
        this->state = state;
        this->seqNumber.fetchAndAddOrdered(1);
    }

    T getState(){
        T result;
        int seq;
        bool seq_changed = true;

        /* repeat while seq is ODD or if seq changes during read operation */
        while( (seq=this->seqNumber.fetchAndAddOrdered(0)) & 0x01 || seq_changed ) {
            result = this->state;
            seq_changed = (this->seqNumber.fetchAndAddOrdered(0)!=seq);
        }
        return result;
    }

private:
    QAtomicInt seqNumber;
    T state;
} 
```

这是第二版（memcpy，读者屈服，希望修复 getState() ）：

```
template <class T>
class OneWriterAtomicState
{

public:
    OneWriterAtomicState()
        : seqNumber(0)
    {
        /* Force a compile-time error if T is NOT a type we can copy with memcpy */
        Q_STATIC_ASSERT(!QTypeInfo<T>::isStatic);
    }

    void setState(T* state) {
        this->seqNumber.fetchAndAddOrdered(1);
        memcpy(&this->state,state,sizeof(T));
        this->seqNumber.fetchAndAddOrdered(1);
    }

    void getState(T* result){
        int seq_before;
        int seq_after  = this->seqNumber.fetchAndAddOrdered(0);
        bool seq_changed = true;
        bool firstIteration = true;

        /* repeat while seq_before is ODD or if seq changes during read operation */
        while( ((seq_before=seq_after) & 0x01) || seq_changed ) {

            /* Dont want to yield on first attempt */
            if(!firstIteration) {
                /* Give the writer a chance to finish */
                QThread::yieldCurrentThread();
            } else firstIteration = false;

            memcpy(result,&this->state,sizeof(T));
            seq_after = this->seqNumber.fetchAndAddOrdered(0);
            seq_changed = (seq_before!=seq_after);
        }
    }

    bool isInitialized() {  return (seqNumber>0); }

private:
    QAtomicInt seqNumber;
    T state;
} ;

#endif // ONEWRITERATOMICSTATE_H 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T18:56:52.577

The algorithm is not quite correct. Here's one possible interleaving of threads where the reader gets inconsistent data:

```
state initialized to {0,0} and seqNumber to 0

Writer:
seqNumber = 1;
state.x = 1;

Reader:
seq = seqNumber; //1
result = state; //{1,0}
seq_changed = (seqNumber != seq); //false

Writer:
state.y = 1;
seqNumber = 2;

Reader:
jumps back to the start of the loop
seq = seqNumber; //2
steps out of the loop because seq == 2 and seq_changed == false 
```

So the problem is that `seqNumber` is read in two places and it's possible for the writer to update the value between the reads.

```
while( (seq=this->seqNumber.fetchAndAddOrdered(0)) & 0x01 || seq_changed ) {
    result = this->state;
    seq_changed = (this->seqNumber.fetchAndAddOrdered(0)!=seq);
    //If writer updates seqNumber here to even number bad things may happen
} 
```

It should only be read once per iteration:

```
T getState(){
    T result;
    int seq;
    int newseq = seqNumber.fetchAndAddOrdered(0);
    bool seq_changed = true;

    while( (seq = newseq) & 0x01 || seq_changed ) {
        result = state;
        newseq = seqNumber.fetchAndAddOrdered(0);
        seq_changed = (newseq != seq);
    }
    return result;
} 
```

I believe this should work correctly, but I won't guarantee anything. :) At the very least you should write a test program, like the one in your example but adding a check for inconsistent values in the reader.

One thing worth considering is that using atomic increment (fetchAndAdd) is kind of an overkill. There's only one thread writing `seqNumber`, so you could do with simple atomic store-release and load-acquire operations, and they can be implemented much faster on many processors. However I don't know if those operations are possible with `QAtomicInt`; the documentation is very unclear about it.

edit: and wilx is right, T needs to be a trivially copyable type

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T14:27:35.523

I think that this will only work if `T`'s copy assignment operator is primitive and does basically only a bitwise copy. For any more complicated `T` you could end up getting inconsistent state during the execution of the `result = this->state;`.

So, I would suggest using some kind of rwlocks with writer preference.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T19:32:24.660

If you have a priority based thread scheduling and the reader has a higher priority than the writer you might run into a livelock. Imagine the writer starts to write the value and then the reader comes in doing its active waiting. Due to the higher priority of the reader the writer will never get a chance finish the writing.

A solution would be to add a tiny delay to the waiting loop.

# android - 如何在 OsmDroid 中为 OverlayItem 创建自己的标记

> ID：10210906
> 
> 赞同：0
> 
> 时间：2012-04-18T13:55:24.787
> 
> 标签：android, osmdroid, overlayitem

我有以下代码：

```
ArrayList<OverlayItem> items = new ArrayList<OverlayItem>();
GeoPoint geoPoint = new GeoPoint(data.getPosition().longitude, data.getPosition().latitude, data.getPosition().altitude);
OverlayItem overlayItem = new OverlayItem(placeName, description, geoPoint);
overlayItem.setMarker(this.getResources().getDrawable(R.drawable.ic_launcher));
items.add(overlayItem);

overlay = new ItemizedOverlayWithFocus<OverlayItem>(this.getApplicationContext(), items,
        new ItemizedIconOverlay.OnItemGestureListener<OverlayItem>() {

            @Override
            public boolean onItemSingleTapUp(final int index, final OverlayItem item) {
                return true; // We 'handled' this event.
            }

            @Override
            public boolean onItemLongPress(final int index, final OverlayItem item) {
                return false;
            }
        });

mapView.getOverlays().set(0,overlay);
mapView.invalidate(); 
```

我想用画布创建自己的标记，现在，我使用的是静态图像，但我想用圆圈、线条等创建自己的表单……我认为这是可能的，但我找不到如何使它工作。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T14:58:18.603

我找到了解决部分问题的解决方案。我创建了一个从 SimpleLocationOverlay 扩展的类，然后我重写 draw() 方法并执行我的 canvas.drawLine,drawCircle ...但是现在我使用 SimpleLocationOverlay 类型，我不能再使用 ItemizedOverlayWithFocus，所以我的问题是，如何用我现在使用的替换它？

对于那些对我的解决方案感兴趣的人以及想要帮助我的人，代码如下所示：

```
public class MyOverlay extends SimpleLocationOverlay{
private MyCar myCar = new MyCar();
private GeoPoint geoPosition = new GeoPoint(0, 0);
private Paint paint = new Paint(Paint.ANTI_ALIAS_FLAG);

public myOverlay(Context ctx) {
    super(ctx);
    // TODO Auto-generated constructor stub
}

public myOverlay(Context ctx, MyCar _myCar) {
    super(ctx);
    this.myCar= _myCar;
    this.paint.setAntiAlias(true);
    ...
}

@Override
public void draw(Canvas c, MapView osmv, boolean shadow) {
    Point mapCenterPoint = new Point();
    osmv.getProjection().toPixels(this.geoPosition, mapCenterPoint);
    c.drawCircle(mapCenterPoint.x, mapCenterPoint.y, 10, this.paint);
}
} 
```

以及我如何在我的活动中使用它：

```
 ArrayList<MyOverlay> items = new ArrayList<MyOverlay>();
    int i;

    GeoPoint geoPoint = null;
    MyOverlay myOverlay;

    mapView.getOverlays().clear();

    for (i = 0; i < listeCar.size(); i++) {
        geoPoint = new GeoPoint(listeCar.get(i).getPosition().longitude, listeCar.get(i).getPosition().latitude, listeCar.get(i).getPosition().altitude);
        myOverlay= new myOverlay(getApplicationContext(),listeCar.get(i), mapView);
        myOverlay.setLocation(geoPoint);
        myOverlay.draw(new Canvas(), mapView, false);
        items.add(myOverlay);
    }
    mapView.getOverlays().addAll(0, items );
    items.clear(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T01:07:56.807

我的回答有点晚了，但我一直在努力解决使用 osmdroid 的一系列其他问题。如果要使用自己的标记，请先在位图中执行此操作，然后在 OverlayItem.setMarker() 方法中将其设置为可绘制标记。

如果您覆盖 ItemizedIconOverlay.draw() 方法来绘制您自己的标记，则您必须更新 ItemizedIconOverlay 的热点逻辑以及任何使用 OnItemGestureListener 的触摸屏手势。

要使用 Canvas 创建位图，请尝试

```
Bitmap bitmap = Bitmap.createBitmap(width, height, Config.RGB_565);
Canvas canvas = new Canvas(bitmap);
// Draw on your canvas... 
```

然后尝试分配位图：

```
overlayItem.setMarker(new BitmapDrawable(bitmap)); 
```

# android - 在 notifyDataSetChanged 后自定义 ListView 不会取消选中所有复选框

> ID：10210907
> 
> 赞同：0
> 
> 时间：2012-04-18T13:55:25.560
> 
> 标签：android, listview, checkbox

我正在开发一个 Android 3.1 应用程序。我对 Android 开发非常陌生。

我有一个`ListActivity`哪些项目定义如下：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >
    <CheckBox
        android:id="@+id/itemCheckBox"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>
</LinearLayout> 
```

这`ListActivity`显示了一个表单的列表。用户可以选择（检查`checkbox`）一个或多个表格并下载它们。

下载表格后，我想将它们从列表中删除。为此，我使用`updateFormsNotDownloaded`at `FormAdapter`：

```
 public class FormAdapter extends ArrayAdapter<Form>
    {
        private Context context;
        private int layoutResourceId;
        private ArrayList<Form> forms;
        private ArrayList<Integer> checkedItemsPosition;
        private Button downloadButton;

        public ArrayList<Integer> getCheckedItemsPosition()
        {
            return checkedItemsPosition;
        }

        public String[] getSelectedFormsId()
        {
            String[] ids = new String[checkedItemsPosition.size()];
            int i = 0;
            for(Integer pos : checkedItemsPosition)
            {
                Form f = forms.get(pos.intValue());
                ids[i] = f.FormId;
                i++;
            }
            return ids;
        }

        /**
         * Called when selected forms has been downloaded and save it locally correctly.
         */
        public void updateFormsNotDownloaded()
        {
            for(Integer pos: checkedItemsPosition)
                remove(forms.get(pos.intValue()));
            checkedItemsPosition.clear();
            notifyDataSetChanged();
        }

        public FormAdapter(Context context, int textViewResourceId,
                ArrayList<Form> objects, Button downloadButton)
        {
            super(context, textViewResourceId, objects);

            this.context = context;
            this.layoutResourceId = textViewResourceId;
            this.forms = objects;
            this.checkedItemsPosition = new ArrayList<Integer>();
            this.downloadButton = downloadButton;
        }

        @Override
        public int getCount()
        {
            return forms.size();
        }
        @Override
        public View getView(final int position, View convertView, ViewGroup parent)
        {
            Log.v("FormAdapter", "getView.postion: " + position);
            View row = convertView;
            if (row == null)
            {
                LayoutInflater inflater = ((Activity)context).getLayoutInflater();
                row = inflater.inflate(layoutResourceId, parent, false);
            }

            Form f = forms.get(position);
            if (f != null)
            {
                CheckBox checkBox = (CheckBox)row.findViewById(R.id.itemCheckBox);
                if (checkBox != null)
                {
                    checkBox.setText(f.Name);
                    checkBox.setOnCheckedChangeListener(new OnCheckedChangeListener()
                    {
                        public void onCheckedChanged(CompoundButton buttonView,
                                boolean isChecked)
                        {
                            //Form f = forms.get(position);
                            if (isChecked)
                            {
                                //checkedItems.add(f.FormId);
                                checkedItemsPosition.add(new Integer(position));
                            }
                            else
                            {
                                //checkedItems.remove(checkedItems.indexOf(f.FormId));
                                int index = checkedItemsPosition.indexOf(new Integer(position));
                                if (index > -1)
                                    checkedItemsPosition.remove(index);
                            }
                            downloadButton.setEnabled(checkedItemsPosition.size() > 0);
                        }
                    });
                }
            }

            return row;
        }
    }
} 
```

想象一下，我有以下列表：

1.  表格 1\. (勾选)
2.  表格 2。
3.  表格 3。

用户选择表单 1，当表单在本地保存`updateFormsNotDownloaded`并被调用时，我看到了这个：

1.  表格 2\. (勾选)
2.  表格 3。

为什么要检查表格 2？如何取消选中所有？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:04:42.380

您应该检查是否应该检查该位置并为每个位置手动设置检查值。我在任何地方都没有看到你在这样做..

前任。

```
//we set the OnCheckedChangeListener to null so that setting the checkbox value doesn't trigger the checkedChangelistener
//this may or may not be relevant for your project
checkBox.setOnCheckedChangeListener(null); 
checkbox.setChecked(checkedItemsPosition.contains(position));
checkBox.setText(f.Name);
checkBox.setOnCheckedChangeListener(new OnCheckedChangeListener()
{
      public void onCheckedChanged(CompoundButton buttonView, boolean isChecked)
      {
        //the rest of your code here
      }
} 
```

# java - 如何在 Wicket 中返回指向外部 URL 的链接？

> ID：10210908
> 
> 赞同：4
> 
> 时间：2012-04-18T13:55:26.193
> 
> 标签：java, wicket

我有一个带有表单的 Web 应用程序。当我单击保存时，应用程序会创建一些文件并返回一些 url。如何将此网址显示到网页？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T15:31:50.733

使用`ExternalLink`.

一个普通的静态链接：

```
new ExternalLink("link", "http://some.url", "This is a some.url link"); 
```

根据上下文可能会更好地使用这个承认`IModel`你的`href`和`label`参数的其他构造函数：

```
ExternalLink(final String id, final IModel<String> href, final IModel<?> label) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T14:28:37.910

一种方法是简单地创建一个 Link 并覆盖 onComponentTag 方法：

html部分：

```
...
<a wicket:id="link">[link]</a>
... 
```

java部分：

```
...
Link link = new Link("link") {
    @Override
    protected void onComponentTag(ComponentTag tag) {
        tag.put("href", "http://www.example.com/");
    }
};
add(link);
... 
```

# java - 如何将 google maps android 应用程序导入另一个 android 项目？

> ID：10210910
> 
> 赞同：1
> 
> 时间：2012-04-18T13:55:30.537
> 
> 标签：java, android, eclipse, google-maps

我目前有一个应用程序，它只是一个标准的 android 应用程序，但我想向它添加一些谷歌地图功能。

因此，我创建了另一个项目来掌握谷歌地图 API，并尝试将其开发到它正在做我需要它做的事情的地步。

我的问题是我需要我的第一个应用程序能够调用或运行地图应用程序来检索数据。

是否可以从地图应用程序创建一个库，然后将其导入我的第一个项目？如果是这样，我将如何处理调用它？

如果没有，我如何将它实现到应用程序中？

对于它的价值，我会从菜单中的一个按钮调用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:30:37.703

如果你想把它做成一个应用程序，你可以将地图应用程序中的源和布局复制到主应用程序中，将其变成一个单独的**Activity**。然后使用**Intent**启动地图活动，可能会传递一些参数并将结果返回给主活动。

如果您使用的是 eclipse [，这里是添加活动的方法](https://stackoverflow.com/questions/2337874/best-way-to-add-activity-to-an-android-project-in-eclipse)

还有[一个使用 Intent 的小教程](http://www.vogella.com/articles/AndroidIntent/article.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T14:13:59.873

如果您使用的是 eclipse，您可以右键单击您的地图项目，转到 properties->android 并选中屏幕底部的“Is Library”框。然后在您的其他项目中，您需要在属性的同一位置导入此库项目。您可以单击“添加”并将库项目添加到您的主目录，而不是选中此处的框。

在您的库项目清单中，您可能需要调整您的意图过滤器以摆脱其启动器功能。

# ios - 使用 GL_Trianglestrip OpenGL ES 2.0 绘制四边形元素

> ID：10210911
> 
> 赞同：0
> 
> 时间：2012-04-18T13:55:32.437
> 
> 标签：ios, opengl-es, gl-triangle-strip

我想在 OpenGL ES 2.0 中解析模型并渲染 4 顶点多边形（矩形），而不是使用两个三角形，我想为每个四边形/矩形使用一个三角形条。

问题是我的矩形没有在整个模型中连接。如果我有三个四边形（12 个顶点），我想像这样绘制它们（numOfQuadFaces = 3）：

```
glDrawArrays(GL_TRIANGLE_STRIP, 0, numOfQuadFaces*4); 
```

对顶点数组进行排序，以便每四个顶点开始一个新的四边形。但是当然 OpenGL 将其解释为对于数组中第三个顶点之外的每个新顶点都开始一个新三角形。我可以在某个地方指定我想要长度为 4 的单个三角形条/四边形吗？- 这样我就可以画出类似的东西（如果当然只在 glDrawArrays- 调用）：

```
glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);
glDrawArrays(GL_TRIANGLE_STRIP, 4, 4);
glDrawArrays(GL_TRIANGLE_STRIP, 8, 4); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T14:02:00.827

您最好的选择是将四边形转换为三角形。在普通 OpenGL 中，如果您使用索引三角形条带，`glPrimitiveRestartIndex`它基本上指定了一个索引，在发送时重新启动条带，但这在 OpenGL ES 2.0 中不可用，所以我想这没有帮助。

另一种选择是将“条带”与退化三角形连接，但这将占用与将四边形转换为三角形（两个额外顶点）一样多的内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T12:49:45.417

您可以通过插入额外的点来渲染退化的三角形，从而产生线形三角形，图形驱动程序将优化这些并渲染断开的三角形带，可以是四边形（两个三角形）

# php - 在 PHP 中使用 Telnet 发送退格或删除

> ID：10210912
> 
> 赞同：1
> 
> 时间：2012-04-18T13:55:36.727
> 
> 标签：php, telnet, fputs

我正在使用这段漂亮的代码连接到 Telnet 会话并向其发送一些命令并获取输出。

[http://www.geckotribe.com/php-telnet/](http://www.geckotribe.com/php-telnet/)

我现在遇到了一个问题，我想删除 Telnet 会话中的一些数据并用其他一些数据替换它。（不确定这是否可能？？）

例如：它提示 continue N - 我需要删除那个 N 并在那里放置一个 Y。

此函数发送命令...注意 \r，是否有模拟退格或删除的东西？

```
 function DoCommand($c,&$r) {
    if ($this->fp) {
        fputs($this->fp,"$c\r");
        $this->Sleep();
        $this->GetResponse($r);
        $r=preg_replace("/^.*?\n(.*)\n[^\n]*$/","$1",$r);
    }
    return $this->fp?1:0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T13:57:30.903

退格的控制字符是`0x08`（您可以将其添加到 PHP 中的字符串中`"\x08"`）。

# .net - URL 重写 - 删除 .html 扩展名

> ID：10210936
> 
> 赞同：6
> 
> 时间：2012-04-18T13:56:56.577
> 
> 标签：.net, html, iis, url-rewriting, web-config

所以想法是像这样从每个页面中删除 .html 扩展名......

```
www.website.com/File.html > www.website.com/File
www.website.com/Folder/File.html > www.website.com/Folder/File 
```

现在我已经设法使用 URL 重写来做到这一点，但这意味着必须为每个页面编写一个重写，如果网站超过 20 页，这很耗时，效率不高且不切实际。

有没有办法通过在 web.config 中只写一两个重写来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T14:35:47.133

这个解决方案最终对我有用：

```
<rule name="RedirectUserFriendlyURL1" stopProcessing="true">
    <match url="^(.*)\.(.*)$" />
    <conditions>
        <add input="{REQUEST_METHOD}" pattern="^POST$" negate="true" />
    </conditions>
    <action type="Redirect" url="{R:1}" appendQueryString="false" />
</rule>
<rule name="RewriteUserFriendlyURL1" stopProcessing="true">
    <match url="^(.*)$" />
    <conditions>
        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
    </conditions>
    <action type="Rewrite" url="{R:1}.(.*)" />
</rule> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T14:11:29.840

使用 IIS 7.x 的重写模块：
[http ://www.techrepublic.com/blog/webmaster/url-rewriting-with-iiss-url-rewrite-module/710](http://www.techrepublic.com/blog/webmaster/url-rewriting-with-iiss-url-rewrite-module/710)

虽然我已经尝试过了，但我从来没有得到真正的规则集来自动执行它，**而没有****每个**页面名称的规则。

对任何可以阐明这一点的人+1！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-15T18:44:57.290

在此处[永久添加使用 Web 配置删除 HTML 扩展](https://stackoverflow.com/questions/19631493/remove-html-extension-with-web-config-permanently/35523747)的答案。这对我来说非常有效，使用 URL Rewrite 2.1 模块。您将其编辑到 applicationHost.config 文件中。感谢[https://stackoverflow.com/users/1821692/feeeper](https://stackoverflow.com/users/1821692/feeeper)

```
<rewrite>
    <rules>
        <rule name="Hide .html ext">
            <match ignoreCase="true" url="^(.*)"/>
            <conditions>
                <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true"/>
                <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true"/>
                <add input="{REQUEST_FILENAME}.html" matchType="IsFile"/>
            </conditions>
            <action type="Rewrite" url="{R:0}.html"/>
        </rule>
        <rule name="Redirecting .html ext" stopProcessing="true">
            <match url="^(.*).html"/>
            <conditions logicalGrouping="MatchAny">
                <add input="{URL}" pattern="(.*).html"/>
            </conditions>
            <action type="Redirect" url="{R:1}"/>
        </rule>
    </rules>
</rewrite> 
```

# c# - RESTful Web 服务在 20 分钟后自动刷新静态 Hashtable var 和 Httpruntime.cache 对象

> ID：10210939
> 
> 赞同：0
> 
> 时间：2012-04-18T13:57:09.453
> 
> 标签：c#, wcf, caching, rest

我有一个**WCF RESTful Web 服务**，我已经使用 HashTable 实现了缓存机制。但问题是如果它保持空闲状态或没有连接到它，它会**在 20 分钟后自动刷新/计数 = 0 。**你能建议什么可能的解决方案吗

我什至尝试使用**httpruntime.cache**来实现相同并删除哈希表，但结果相同

通过一些研发，我发现这个东西可以解决这个问题，但它没有

```
[ServiceBehavior(InstanceContextMode = InstanceContextMode.Single, ConcurrencyMode = ConcurrencyMode.Multiple)] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T14:00:38.263

听起来很像您在 IIS 中托管并且没有配置[Idle Timeout 设置](http://technet.microsoft.com/en-us/library/cc771956(v=ws.10).aspx)，这意味着您的应用程序池将在（默认）20 分钟空闲时间后自动关闭。

# css - 边界半径 + 渐变 + 框阴影导致参差不齐的边缘

> ID：10210945
> 
> 赞同：7
> 
> 时间：2012-04-18T13:57:19.757
> 
> 标签：css

当我将边框半径和背景渐变应用于`<li>`圆角时，看起来参差不齐且粗糙。[在这个 jsfiddle 上检查一下](http://jsfiddle.net/wCtgh/)

我在 Chrome 和 FF 中看到了这一点。如果我删除渐变或边界半径，问题就会消失。

任何想法为什么会发生这种情况以及我如何解决它？

**更新：** 我正在开发一个基于 Josh F 想法的 jQuery 解决方案（请参阅下面的完整答案）。这是一个简单的 jQuery 函数，它在其后面附加元素的副本。目前，脚本将目标元素的定位设置为`relative`. （在某些情况下，我可以看到这是有问题的。）我的代码在 jsfiddle 上[。](http://jsfiddle.net/ZkSeH/4/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T14:07:41.570

当前规范定义`box-shadow`为*在*. `border-box`但是，背景/边框将元素绘制到背景，而不考虑其他元素（它不*使用*对象绘制，仅在顶部绘制）。由于带有 的元素`border-radius`是在 之前绘制的`box-shadow`，因此它使用半透明边缘绘制角以使角看起来平滑（应该如此）。遗憾的是，由于规范的措辞`box-shadow`，它在元素*之后*绘制，因此在页面顶部（在元素之后）以半透明边缘绘制。通常，这会很好，但由于元素和元素`box-shadow`在相同的像素上都有透明边缘，它会导致小的、半透明的间隙。

这是一个已知的错误，或者至少被网页设计社区认为是一个错误。有关我的信息来源，请参阅[Bugzilla Bug #474386（特别是评论 #6）](https://bugzilla.mozilla.org/show_bug.cgi?id=474386#c6)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:14:53.840

绕过该错误的一种可能方法是在盒子后面放置一个比盒子高 1px 且颜色与盒子阴影相同的伪元素。这将通过使先前的白色边缘与盒子阴影的颜色相同或接近来隐藏错误。

有关示例，请参[见此 jsFiddle](http://jsfiddle.net/farneman/e7TeV/)。

# jquery - 在 iframe [fancybox] 中使用 next

> ID：10210946
> 
> 赞同：0
> 
> 时间：2012-04-18T13:57:20.717
> 
> 标签：jquery, fancybox

我正在尝试通过调用fancybox 上的下一个方法将新URL 加载到Iframe，但我无法让它工作。

我知道我可以使用 iframe 关闭一个fancybox

> 父.$.fancybox.close();

使用 parent.$.fancybox.next() 但是不起作用

是否对此没有规定或者我做错了什么

```
<a href="javascript:void(0)" onclick="goToNext()">next</a>

function goToNext()
{
parent.$.fancybox.next()

} 
```

我之所以这样做，是因为即使将 cyclic 和 showNavArrows 选项设置为 true，我也无法显示下一个和上一个按钮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T18:34:02.567

在父页面上，只需将相同的`data-fancybox-group`属性（也使用 HTML5 DOCTYPE）设置为触发 fancybox iframe 的锚点，例如：

```
<a href="page01.html" class="fancybox fancybox.iframe" data-fancybox-group="mygroup">open iframe 01</a>
<a href="page02.html" class="fancybox fancybox.iframe" data-fancybox-group="mygroup">open iframe 02</a>
<a href="page03.html" class="fancybox fancybox.iframe" data-fancybox-group="mygroup">open iframe 03</a> 
```

等等

然后 fancybox 将自动显示导航箭头在下一个/上一个 iframe 之间移动。

另一方面，您仍然可以使用手动方法在画廊的元素之间移动，但是`parent.$.fancybox.next();`只有设置了相同的`data-fancybox-group`属性才有效，否则fancybox 无法知道哪个是该组的下一个元素。

注意：这是为 fancybox v2.x

# iphone - 什么是 GPX 文件，它的用途是什么？

> ID：10210954
> 
> 赞同：4
> 
> 时间：2012-04-18T13:57:46.753
> 
> 标签：iphone, ipad, ios-simulator

**已经有一段时间了，我对将GPX**文件添加到 Iphone/iPad 项目有疑问。**GPX**文件究竟包含什么以及它如何帮助我们在*模拟器*上运行应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T14:00:01.823

首先看看[这个 wiki 站点](http://en.wikipedia.org/wiki/GPS_eXchange_Format)。

> GPX 或 GPS 交换格式是一种 XML 模式，被设计为软件应用程序的通用 GPS 数据格式。它可用于描述航路点、航迹和路线。该格式是开放的，无需支付许可费即可使用。它的标签存储位置、海拔和时间，并且可以通过这种方式在 GPS 设备和软件包之间交换数据。例如，此类计算机程序允许用户查看他们的轨迹、将他们的轨迹投影到卫星图像或其他地图上、注释地图以及在 Exif 元数据中使用地理位置标记照片。

这是适用于 iOS 的 GPX 框架：http: [//gpxframework.com/](http://gpxframework.com/)

# ruby-on-rails - Ruby on Rails - 当我很确定我有模板时缺少模板错误

> ID：10210956
> 
> 赞同：1
> 
> 时间：2012-04-18T13:57:54.027
> 
> 标签：ruby-on-rails, ruby, devise

我有这条路线：

```
scope :module => :mobile, :as => :mobile do
    constraints(:subdomain => /m/) do
      devise_for :users, :path => "", :path_names =>
               { :sign_in => "login", :sign_out => "logout",
                 :sign_up => "signup" },
                 :controllers => {:sessions => "mobile/sessions"}

      resources :home

      resources :disclosures # Will have new, get, look up a disclosure
    end
  end 
```

这个控制器：

```
class Mobile::SessionsController < ApplicationController
  def create
  end
end 
```

在这个目录下：`/app/views/mobile/sessions/new.html.haml`

这是 new.html.haml 文件中的代码：

```
= content_for :page_title do
  = t :page_title_login
= content_for :primary_content do
  #login_box
    .span6
      #traditional-login
    .span4
= content_for :before_closing_body_tag do
  configure_login_form(#{request.xhr?.to_s.downcase}); 
```

但是登录后，我在浏览器中收到此错误：

```
Missing template mobile/sessions/create, application/create with {:locale=>[:en, :en], :formats=>[:html], :handlers=>[:haml, :erb, :builder]}. Searched in: * "/Users/alexgenadinik/projects/cmply/cmply-app/app/views" * "/Library/Ruby/Gems/1.8/gems/ckeditor-3.6.3/app/views" * "/Library/Ruby/Gems/1.8/gems/kaminari-0.13.0/app/views" * "/Library/Ruby/Gems/1.8/gems/devise-2.0.4/app/views" 
```

这向我表明系统认为我没有 new.html.haml 文件。但我显然有那个文件。所以我不确定是什么问题。并知道我做错了什么？

提前致谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T14:02:06.660

这里的错误不是您缺少 new.html.haml 文件；您缺少 create.html.haml 或远离创建操作的重定向。通常您在登录后重定向，因此请尝试将您的控制器操作更改为以下内容：

```
class Mobile::SessionsController < ApplicationController
  def create
    redirect_to root_url
  end
end 
```

或者您希望访客结束的任何地方。

# iis - IIS 7.5 - 更改管理配置文件的路径

> ID：10210960
> 
> 赞同：5
> 
> 时间：2012-04-18T13:58:12.417
> 
> 标签：iis, config, filepath

我正在为刚离开的人接管 IIS 维护，出于某种原因，他们将配置文件复制到不同的驱动器，并指示 IIS 查看它们而不是默认的 C:\WINDOWS\System32\inetsrv\config。

问题：如何将其更改回默认路径？我假设我必须首先将当前配置文件复制到默认目录以维护配置...

谢谢！

斯科特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-02-03T09:22:03.487

对于由于定位共享配置文件错误而访问此页面的任何人，该文件完全阻止访问 IIS 设置，您可以在 PowerShell 中运行以下命令：

```
Import-Module WebAdministration
[System.Reflection.Assembly]::LoadFrom("C:\windows\system32\inetsrv\Microsoft.Web.Administration.dll") | Out-Null

$serverManager = New-Object Microsoft.Web.Administration.ServerManager
$config = $serverManager.GetRedirectionConfiguration()
$redirectionSection = $config.GetSection(“configurationRedirection”)
$redirectionSection.Attributes["enabled"].Value = “false”
$serverManager.CommitChanges() 
```

这基本上只是关闭了共享配置，因此您可以访问 IIS 服务器管理器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T14:06:42.630

1.  在 IIS 管理器中单击服务器。
2.  向下滚动到“管理”部分。
3.  双击“共享配置”
4.  将其关闭以诉诸本地配置设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T14:16:40.153

你需要在“IIS”中做的是：

1.  转到管理。
2.  共享配置。
3.  右键点击
4.  打开功能
5.  将物理路径更改为您想要的任何文件夹。
6.  将文件移动到特定文件夹。

# c++ - 彩色窗口上的文字

> ID：10210964
> 
> 赞同：0
> 
> 时间：2012-04-18T13:58:24.170
> 
> 标签：c++, winapi

我通过下面的代码创建了一个子窗口“hwndTab”并在其上设置了一个文本。在某些情况下，我需要给子窗口“hwndTab”一种颜色。如果我将 FillRect 与solidbrush 颜色一起使用，则文本会被覆盖并且看不到。我也不想使用 system.dll 和 system.drawing.dll 来制作透明的背景颜色。在这种情况下，有没有办法为这个子窗口“hwndTab”着色，但仍然可以看到文本？

```
win->hwndTab = CreateWindow(WC_STATIC, _T(""), WS_VISIBLE | WS_CHILD,
 0, 5, 62, 16, win->hwndReBarForTab, (HMENU)IDC_TOC_TITLE, ghinst, NULL);

SetWindowFont(win->hwndTab, gDefaultGuiFont, FALSE);

win::SetText(win->hwndTab, _T("Book")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:12:15.380

在使用solidbrush 颜色的FillRect 之后，执行::DrawText(...) 或::ExtTextOut(...)。不要使用 SetText(...)。

# vb.net - 查询是否存在行

> ID：10210966
> 
> 赞同：1
> 
> 时间：2012-04-18T13:58:31.213
> 
> 标签：vb.net, sql-server-2008

我需要知道何时以及是否存在一行并且我想使用 ExecuteReader 对吗？

我的代码只是为了让我知道我要去哪里。

```
Const c_str_SELECT_SQL As String = "SELECT Fails FROM LoginAttacks WHERE IP = ?"

If Not String.IsNullOrEmpty(strPointsDBConnectionString) Then
    objOLEConnection = New OleDbConnection(strPointsDBConnectionString)
    objOLEConnection.Open()
    objOLECommand = New OleDbCommand(c_str_SELECT_SQL, objOLEConnection)
    objIP = objOLECommand.Parameters.Add("@IP", OleDbType.Char)
    objIP.Value = Me.IPAddress

    ' Connect execute update query
    FailedCounts = CInt(objOLECommand.ExecuteScalar())

    If FailedCounts > 0 Then 'need to find way to tell if query worked/found row with ip
        FailedCounts = FailedCounts + 1
        'Did not fail assume worked so go use update function
        IPExist = True 'if not go use insert function
    End If
Else
    Throw New Exception(const_CONNECTION_STRING_ERROR)
End If 
```

更新：

我补充说：

```
objOLEDataReader = objOLECommand.ExecuteReader()

If objOLEDataReader.HasRows Then
    'Do While objOLEDataReader.Read()
    FailedCounts = CInt(objOLECommand.ExecuteScalar())
    FailedCounts = FailedCounts + 1
    'Did not fail assume worked so go use update function
    IPExist = True 'if not go use insert function
    'Loop
Else
    'none found
End If

objOLEDataReader.Close() 
```

但是，即使有行，我似乎也不会进入 IF 语句。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:36:23.957

从[文档](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbcommand.executescalar.aspx)中，如果没有数据，`ExecuteScalar`将返回。`Nothing`所以你应该能够首先检查`Nothing`是否有行：

```
Dim FailedCountsObject As Object = objOLECommand.ExecuteScalar()

'need to find way to tell if query worked/found row with ip
If FailedCountsObject IsNot Nothing Then
    FailedCounts = CInt(FailedCountsObject)
    FailedCounts = FailedCounts + 1
    'Did not fail assume worked so go use update function
    IPExist = True 'if not go use insert function
End If 
```

# android - 设置另一个应用的主题？

> ID：10210967
> 
> 赞同：0
> 
> 时间：2012-04-18T13:58:42.777
> 
> 标签：android

是否可以告诉系统加载强制不同主题的任意应用程序？根没问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:11:57.987

不，这根本不可能。您无法控制其他应用程序的行为。

# javascript - 如何在jQuery中停止动画，但是当动画首先完成时

> ID：10210968
> 
> 赞同：2
> 
> 时间：2012-04-18T13:58:52.790
> 
> 标签：javascript, jquery, slider, jquery-animate

我需要有关自动滑块动画的帮助。所以，我的问题是 - 如何在悬停事件上停止动画，但不是立即停止，而是在单独元素上的动画完全完成时停止。

我有这段代码：

```
$(function(){

   var current_slide=1;
   var set_time=2500;

   $('span').css({top:'300px'});

   $.timer(6000,function(timer){
      switch(current_slide){
         case 1:
            $('span').css({top:'350px'});
            $('#slideshow').stop().animate({left:'-960px',top:'0px'},{easing:'easeOutBack',duration:set_time});
            current_slide=2;
            $('span').delay(2500).animate({top:'300px'});
            break;
         case 2:
            $('span').css({top:'350px'});
            $('#slideshow').stop().animate({left:'-1920px',top:'0px'},{easing:'easeOutBack',duration:set_time});
            current_slide=3;
            $('span').delay(2500).animate({top:'300px'});
            break;
         case 3:
            $('span').css({top:'350px'});
            $('#slideshow').stop().animate({left:'-2880px',top:'0px'},{easing:'easeOutBack',duration:set_time});
            current_slide=4;
             $('span').delay(2500).animate({top:'300px'});
            break;

         case 4:
            $('span').css({top:'350px'});
            $('#slideshow').stop().animate({left:'0px',top:'0px'},{easing:'easeOutExpo',duration:set_time});
            current_slide=1;
            $('span').delay(2500).animate({top:'300px'});
            break;
      }

      timer.reset(12000);
   });

   $("#slideshow").hover(function(){
      $(this).stop(true,true);
   });
}); 
```

问题是当我将鼠标悬停在滑块上时，动画几乎停止（跳到最后），突然而难看。可能我应该在.stop（）之前使用队列，或者类似的东西。这是一个很好的例子：[http](http://www.sevtopolishotel.com/) ://www.sevtopolishotel.com/ Tnx 提前！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:18:34.193

您可以像这样跟踪悬停状态：

```
var isHovered = false;
$("#slideshow").hover(function(e){
    isHovered = e.type == 'mouseenter';
}); 
```

从那里，可以将整个开关包装在 中`if(!isHovered) { ... }`，这意味着只要幻灯片悬停，计时器就会立即跳到设置下一个超时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T14:03:50.900

这是 .stop() 文档：[http ://api.jquery.com/stop/](http://api.jquery.com/stop/)

那里写着你可以为“jumpToEnd”传递一个参数。如果该参数为假，则动画将持续到结束。我认为您的代码应如下所示：

```
$("#slideshow").hover(function(){
          $(this).stop(true,false);
    });  }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T14:07:26.147

您可以持有对计时器的引用。然后，您只需清除正在安排动画的计时器，而不是停止动画。因此当前动画将继续播放，但不会安排再次运行。如果你使用 javascript setTimeout 你可以这样做

```
vat timer=setTimeout(animation_function, delay);
 //to stop later
clearTimeOut(timer); 
```

但我认为您正在使用 jquery 计时器插件 您的 $.timer 插件仍然应该有一个明确的方法来停止运行再次检查文档。

看这个[帖子](https://stackoverflow.com/questions/9955311/my-javascript-function-runs-in-duplicate-when-i-add-click-event/9956228#9956228)几乎是同样的问题。

# css - @font-face 字体权重随着页面加载而变化（权重设置为正常）

> ID：10210973
> 
> 赞同：1
> 
> 时间：2012-04-18T13:59:36.317
> 
> 标签：css, fonts, font-face

我们正在使用带有@font-face 的Interval Sans。每个字体元素都应用了 font-weight:normal 。没有与元素关联的强字段。

[http://www.fontspring.com/fonts/mostardesign/interval](http://www.fontspring.com/fonts/mostardesign/interval)

在几个文本元素上，当页面首次加载时，我们会看到正确且细长的字体渲染。片刻之后，字体人为地“增重”，从而消除了自定义字体的良好效果。

这是一段 30 秒的视频，展示了它的发生： [http ://www.screencast.com/t/vGN6zLbKh](http://www.screencast.com/t/vGN6zLbKh)

我进行了广泛的搜索，几乎所有结果都与向没有全套字体权重的自定义字体添加人工字体权重有关。我们对我们的问题不知所措。

在 Mac Chrome 中可以看到字体粗细问题，但在 Mac Firefox 和 Safari 中它们立即变得粗体。我们的开发团队表示他们无法重现 Windows 浏览器中的闪烁/变化。

我很感激任何见解！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T11:49:23.790

您是否碰巧在网站上使用[FlexSlider](https://github.com/woothemes/FlexSlider)？

我遇到了完全相同的问题，字体粗细似乎闪烁/闪烁并且没有使用`@font-face`.

在花了一些时间调试之后，我发现`slideshowSpeed`Flexslider 脚本中的变量导致了这个问题。我删除了该变量的自定义设置，闪烁的文本消失了。

即使您没有使用 FlexSlider，我也建议您检查一下是否有一些 javascript 导致了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T01:08:21.833

听起来像字距调整。没有看到代码，很难准确地确定它。你在你的CSS中使用optimizeLegibility吗？您是否生成了跨浏览器兼容性的工具包？

# node.js - createReadStream 错误：“好的，打开”

> ID：10210978
> 
> 赞同：4
> 
> 时间：2012-04-18T13:59:49.530
> 
> 标签：node.js

我有以下代码片段，该代码片段位于为不同文件多次调用的函数中。

```
var readStream = fs.createReadStream(file);
readStream.on('error', function(err) {
    console.log(err);
}); 
```

通常，某些文件（但不是全部）会出错并显示以下消息：

```
OK, open '{filename}' 
```

错误的确切数量并不总是相同，但大致相同。而且它并不总是相同的文件。我正在处理 ~6500 个文件并得到 ~1150 个错误。

这个错误是什么意思？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-28T18:16:44.450

看看[优美的 fs](https://npmjs.org/package/graceful-fs)。这是一个节点模块，它抽象了您希望使用一些附加功能进行的所有 fs 调用。在 Windows 系统中特别有用。

用法很简单：

```
# Install
$ npm install graceful-fs

# Usage (in foo.js)
var fs = require('graceful-fs'); 
```

# java - 渲染/更新线程同步

> ID：10210979
> 
> 赞同：0
> 
> 时间：2012-04-18T13:59:52.413
> 
> 标签：java, android, libgdx

我正在用 Libgdx 写一个小游戏。

我有一个不断调用所有对象的 Render[OpenGL] 线程和一个不断调用`render()`所有对象的更新线程`update(double delta)`。

更新线程的循环速度更快。我应该尝试使用某种同步，以便更新线程可以休息一下吗？会有什么好处吗？

**更新**

```
public void run() {
    while(true){
        nano = System.nanoTime();
        long delta = nano - timestamp;
        timestamp = nano;
        accumulator+=(double)delta/BILION;
        while(accumulator >= step){
            update(step);
            accumulator-=step;
        }
        long loc = (long) ((step -accumulator)*1000)+1;
        try {
            Thread.sleep(loc);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }
} 
```

我不知道它是否有问题，但我当前的更新是 2500-20000 fps。所以更新速度绰绰有余。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T16:16:17.600

不要为更新逻辑使用单独的线程，没有理由这样做。

为什么你的更新方法每秒执行 5000 次，但渲染上限为 60？这是对资源的巨大浪费。

你的渲染方法的第一行应该调用你的更新方法。

用于`Gdx.graphics.getDeltaTime()`获取时差。您可以通过`Math.max(1 / 30f, Gdx.graphics.getDeltaTime()`. 这将强制最小更新时间为 30fps。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T14:10:56.797

您的数据更新和您的渲染应该是独立的而不是`synchronized`.

您的更新功能应该以您认为对用户最友好的速度运行。

它应该独立于渲染，因为渲染速率可能会因最终用户使用的硬件而改变。例如，您不希望您的“怪物”在上一代平板电脑上走得快十倍，这样它就会变得无法播放。

您应该将更新速率设置为您选择的常数。如果帧速率真的很慢，那么也许您会希望您的更新速率放慢一点。

这是我的看法，希望对您有所帮助。

# multidimensional-array - 在 Salesforce 中优化 Levenshtein 距离算法

> ID：10210980
> 
> 赞同：3
> 
> 时间：2012-04-18T13:59:58.110
> 
> 标签：multidimensional-array, salesforce, apex-code, levenshtein-distance

我有一个名为 customer 的自定义对象，其中包含 Customer_Name、Address_Line_1、Post_Code 等字段。

我想浏览所有记录并比较 Customer_Name 的相似性（基于模糊搜索或 levenshtein 距离）。如果相似度高于或低于某个阈值，则会更新自定义字段 (Possible_Duplicate_Customer_ID__c) 以识别可能的重复项。

我已经设法实现了这一点，但我遇到了两个问题：

1）。超出 Salesforce 控制器限制（脚本语句过多：200001）可能是由 Levenshtein 距离算法所需的大量循环引起的。2）。我提交的列表（newList）也包含重复的 ID。

```
 private static List<Customer__c> newList = new List<Customer__c>();

webService static Integer findDupes() {

    Integer returnCount = 0;
    Double cost = 0;
    Integer COST_THRESHOLD = 5;

    Map<id,Customer__c> cMap = new Map<id,Customer__c>([
        select ID, Name, Customer_Name__c, Possible_Duplicate_Customer_ID__c 
        from Customer__c 
    ]);

    List<Customer__c> custList1 = cMap.values();        
    List<Customer__c> custList2 = custList1.clone();

    for (Customer__c cust1 :custList1) {
        for (Customer__c cust2 :custList2) {
            cost = LevenshteinDistance.computeLevenshteinDistance(
                    cust1.Customer_Name__c, cust2.Customer_Name__c);
                if(cost<COST_THRESHOLD && cost != 0) {
                    Customer__c c = new Customer__c(
                        id = cust2.Id, 
                        Possible_Duplicate_Customer_ID__c = cust1.Name
                    );
                    newList.add(c);
                }
                System.debug(cost+' edits to transform '
                        +cust1.Customer_Name__c+' to '+cust2.Customer_Name__c);
        }
    }

    returnCount = newList.size();

    update newList;        
    return returnCount;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T07:37:54.983

你试过新的方法`getLevenshteinDistance` [吗](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_methods_system_string.htm)`String`？

另请参阅我的问题/方法[here](https://salesforce.stackexchange.com/questions/9619/fuzzy-matching-for-duplicate-address-checks/9620)。我坚持认为只有在同一国家/地区的匹配会返回相同的邮政编码或城市，从而减少初始匹配的数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:23:45.123

我建议在使用可批处理接口的类中运行代码，这更适合处理大量数据。由于您的 Web 服务不使用输入，您可以按计划每小时运行一次批处理，通过标记记录来标记重复项，然后在 Web 服务中提取这些记录。当然，如果你需要它是实时的，你需要优化这个循环。

至于更新列表中的重复 ID，您对`cust2.Id`更新的使用应该考虑到这一点，但您似乎并没有防止将客户记录与其自身进行比较的情况！这应该解决它：

```
for (Customer__c cust1 :custList1) {
    for (Customer__c cust2 :custList2) {
        if (cust1.Id == cust2.Id) {
            continue;
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T07:25:23.940

Lev distance is a great tool for fuzzy matching, but basically unusable in Apex due to the script statement limits. Using a version I've got laying around (adapted from an old version of Apex Lang), comparing "0123456789" to "0246803579" takes 700+ script statements. Comparing "actual resource usage has basically no correlation with number of lines of code executed" to "yeah but annoying a 'few' advanced developers will allow us to cut corners during governor limit implementation" takes **60,000 script statements**. Unless you're doing small numbers of small comparisons, or have somehow rewritten Lev to be more script statement friendly, it's going to be difficult to justify on the platform.

I've taken to using cheaper proxies for Lev in Apex, like Soundex for name or short word comparison, or fancy dynamic SOQL "LIKE" statements. If what you're trying to do can somehow be distilled into set operations, those give you a good bang for the buck in Apex since .contains only costs you one script execution.

If you really need to do lots of Lev, you may have to resort to using the API or rewriting the code to be a lot more line-compact. Pushing computation into the browser may also be an option depending on your use case.

# c - 使用 sscanf 读取十六进制值失败

> ID：10210981
> 
> 赞同：4
> 
> 时间：2012-04-18T13:59:58.697
> 
> 标签：c, hex, scanf

这是我的代码的更简短的版本：

```
char token[256];
unsigned int maskval = 0;

//Token gets read in here.

printf("token: %s\n", token);

if (sscanf(token + 2, "%x", &maskval) == 1) {
     //do stuff
} else {
     printf("error: %d, %x\n", maskval, maskval);
} 
```

如您所见，我将十六进制字符串传递给函数，将它们读入令牌并使用 sscanf() 将十六进制值的字符串版本转换为无符号整数。字符串标记始终以“0x”、“0X”、“Ox”或“OX”开头。这样做的原因是因为用户在输入值时将无法区分 0 或 O（vi 将它们显示为相同的图形）。如果我通过它“0x00EE”得到的结果是：

```
token: 0x00EE
error: 0 
```

我相信的问题是我是否将它传递给“0x00EE”或“OxOOEE”（零与大写o）。两者在 vi 中看起来相同，我不确定在这种情况下它们的处理方式是否不同。希望我只是在做一些我忽略的非常简单和愚蠢的事情（通常是这种情况）。另外，我尝试过使用

```
maskval = strtol(token, NULL, 16); 
```

而不是 sscanf() 但我得到了完全相同的结果。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T14:01:46.173

这是一个错误：

```
char *token[256]; 
```

这是一个由 256 个指向字符 ( `char *`) 的指针组成的数组，而不是字符数组。

你的意思是：

```
char token[256]; 
```

应该有很多编译器警告。

尝试从一个不是有效十六进制数字开头的字符串解析十六进制值当然会失败，对于`sscanf()`和`strtoul()`。您几乎听起来好像您认为标准函数应该考虑`'O'`为十六进制只是因为它看起来像您的数字 0。那是......不是他们的设计方式，我认为这是幸运的。:) 你可能想考虑改变你的字体。

您可以手动去除不合格的前缀。假设你*总是*有 2 个字符的前缀，然后*可能*有一个，你可以这样做：

```
const char *number = token + 2;

while(!isxdigit(*number))
  number++;
/* Now number will point at the first hexadecimal
   digit in token, or '\0' if none were found.
*/
if(sscanf(number, "%x", &maskval) == 1)
  printf("success, got %x\n", maskval);
else
  printf("failed to parse '%s' as hexadecimal number\n", number); 
```

# c# - 从我的 WebService 序列化对象时，对象在客户端没有引用

> ID：10210988
> 
> 赞同：1
> 
> 时间：2012-04-18T14:00:31.023
> 
> 标签：c#, linq, web-services

我已经创建了一个 web 服务，并且正在使用 C# 和 LINQ 从我的数据库中创建我的对象。数据库中的表和对应的对象一样，相互之间有关系。

但是，在我正在访问 Web 服务的客户端中，关系消失了。这让我相信序列化有问题。为了使序列化工作，我编辑了 LINQ 对象，以便将序列化模式设置为“单向”并将关联设置为 Access => internal 在子属性而不是 public 下（否则我得到一个循环引用错误）。

所以，现在我无法访问客户端中的对象引用。有谁知道如何解决它？可以解决吗？

例如，在我的网络服务中，我不能这样写：

```
Recipe r = new Recipe();
r.RecipeHasCategories(); 
```

给我食谱和类别之间的关系。这在客户端不起作用！我只能访问该配方特定的属性（例如名称和描述）

帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T14:08:45.517

Entity Framework 默认不加载相关对象；如果您执行需要关系的操作并且实体仍附加到 EF 上下文，则它将按需执行加载。

当您序列化对象时，它们会从它们的上下文中分离出来，并且这种按需加载会停止工作。您只序列化已经加载到内存中的内容。

请参阅[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/bb896272.aspx)，了解如何通过该`.Include()`方法获取原始查询中的所有相关对象。

更新：

由于您使用的是较旧的 Linq 2 SQL 提供程序，因此没有`Include`方法；您只需要在执行任何查询之前通过将`DeferredLoadingEnabled`上下文对象设置为来禁用延迟对象加载即可。`false`

# scala - 如何使用 sbtosgi 生成 osgi 包作为 sbt 发布任务的一部分

> ID：10210992
> 
> 赞同：6
> 
> 时间：2012-04-18T14:00:39.303
> 
> 标签：scala, osgi, sbt

我正在使用[sbtosgi 插件](https://github.com/typesafehub/sbtosgi)从使用 bnd 的 sbt 构建生成 OSGi 包。sbtosgi 包提供了用于生成包的*osgi-bundle*任务。使用 sbtosgi 的默认配置，从 sbt 提示符运行*osgi-bundle*会更新 JAR 以包含正确的标头，但运行*clean package*会导致 JAR 没有 OSGi 标头。在 Maven 中，我正在尝试使用 maven-bundle-plugin 和 packaging = bundle 来做等价的工作——也就是说，项目的主要工件应该是一个 OSGi 包。

根据阅读 sbtosgi 插件的源代码，在我看来，osgi-bundle 任务覆盖了 packageBin 创建的 JAR。我尝试覆盖 packageBin 的定义，以便它使用 osgi-bundle 任务而不是默认任务：

```
 packageBin in Compile <<= OsgiKeys.bundle 
```

这导致了一个循环引用：

```
[error] Cyclic reference involving 
[error]    {file:project/*:osgi-bundle
[error]    {file:project/compile:full-classpath
[error]    {file:project/compile:exported-products
[error]    {file:project/compile:package-bin 
```

我对 SBT 很陌生，我不知道从这里去哪里。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T15:56:45.720

看起来我最初通过 Twitter 提出的建议不起作用。对此感到抱歉。但幸运的是，我让 Mark Harrah 坐在我旁边，这是一个可行的解决方案：

```
packagedArtifact in (Compile, packageBin) <<= (artifact in (Compile, packageBin), OsgiKeys.bundle).identityMap

artifact in (Compile, packageBin) ~= (_.copy(`type` = "bundle")) 
```

# facebook - 在这里/签到号码之间的区别

> ID：10210996
> 
> 赞同：7
> 
> 时间：2012-04-18T14:00:49.570
> 
> 标签：facebook, facebook-graph-api

如果我访问：

[https://www.facebook.com/clubambassadeur](https://www.facebook.com/clubambassadeur)

我得到了一个具体的数字“在这里”

但如果我访问：

[http://graph.facebook.com/clubambassadeur](http://graph.facebook.com/clubambassadeur)

我在签到下列出了一个不同的号码。

为什么这两个数字不同？我假设它们代表相同的东西。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T14:16:51.107

您的第一个链接的“曾经在这里”等于签到 + 在某个地方已签到的签到中标记的朋友。

您的第二个链接仅显示签到，这是“在这里”的子集，不包括被标记的人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T05:05:36.150

虽然网上很多人都同意Gunnar，但我认为他的答案不是正确的。

请比较这两个：

*   [http://graph.facebook.com/amshopping（342](http://graph.facebook.com/amshopping)签到）
*   [https://www.facebook.com/amshopping（14,125](https://www.facebook.com/amshopping)人在这里）

平均签到 41 个人似乎不太可能。

这是我的想法：

*   “签到” == 实际签到的总数（不是人），可能是用手机
*   “在这里” == 我不知道。我认为这是在 Facebook 帖子中提到 @page 的总人数，但我在测试时无法证明这一点。
*   “签到的人”* == 在任何时候签到的唯一身份的总人数

. * 仅对场所页面的管理员可用。查看洞察力 -> 签到。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-27T08:01:30.953

我知道这个问题已经有好几年了，但我偶然发现了它并没有找到合适的解释。所以现在有一个文档： [https](https://developers.facebook.com/docs/graph-api/reference/v2.0/page) ://developers.facebook.com/docs/graph-api/reference/v2.0/page告诉：

**签到：**

> Page 所代表的地点的签到次数。

**were_here_count**

> 访问此主页位置的次数。[...]

所以我所理解的：一个页面可以有一个位置。该位置可以有多个页面（这是有道理的，想象一个购物中心：相同的地址，多个商店=>页面）。签到代表该页面（= 商店）的所有访问者的价值，而 were_here_count 代表来自具有确切坐标的所有位置的所有访问。可悲的是，我找不到证明这一点的例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-03T15:45:14.340

我想“在这里”也总结了标记的图片。例如，某人前往法国并上传了一张包含 200 张照片的相册，并将该相册标记为在法国。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T10:05:09.310

通过实验，我可以确认每当有人在帖子中提到某个地方时*，这里的数量就会增加。*帖子 get 的后缀为“- at X”。但显然，如果您连续两次发布相同的位置，则不会计算在内。

# c# - 集合元素的绑定属性

> ID：10210998
> 
> 赞同：0
> 
> 时间：2012-04-18T14:00:54.647
> 
> 标签：c#, .net, wpf, user-interface, data-binding

我有一个 GUI 和 DataGrid 元素（C#、WPF）。我有 4 列 - 名称、值、时间戳和评论。作为数据源，我使用 Parameter 类型的元素集合，其中包含属性名称、值、时间戳和注释。如何为 DataGrid 中的列创建数据绑定以显示集合中所有 Parameter 元素的相应属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:10:11.750

嗯，您需要定义一个[DataTemplate](http://msdn.microsoft.com/en-us/library/ms742521.aspx)，并且有一次在 XAML 中定义它，然后将 您拥有的元素集合分配给您的`DataGrid`控件。`DataContext``List<Parameter>`

这不是一个可以描述的东西，所以值得一读

[WPF DataGrid：将 DataTemplates 用于自动生成的列](http://www.codeproject.com/Articles/43525/WPF-DataGrid-Using-DataTemplates-for-auto-generate)

在您做简单的事情之前，这并不困难且非常直观。