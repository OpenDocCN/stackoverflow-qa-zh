# StackOverflow 问答 000275000-000275999

# c++ - 使用 C++ 以纳秒为单位提供时间的计时器功能

> ID：275004
> 
> 赞同：105
> 
> 时间：2008-11-08T18:09:05.157
> 
> 标签：c++, c, timer

我希望计算 API 返回值所需的时间。这种动作所花费的时间是纳秒级的。由于 API 是 C++ 类/函数，我使用 timer.h 来计算相同的值：

```
 #include <ctime>
  #include <iostream>

  using namespace std;

  int main(int argc, char** argv) {

      clock_t start;
      double diff;
      start = clock();
      diff = ( std::clock() - start ) / (double)CLOCKS_PER_SEC;
      cout<<"printf: "<< diff <<'\n';

      return 0;
  } 
```

上面的代码以秒为单位给出了时间。如何在纳秒内更精确地获得相同的结果？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2008-11-08T21:29:18.107

其他人发布的关于在循环中重复运行该函数的内容是正确的。

对于 Linux（和 BSD），您想使用[clock_gettime()](http://opengroup.org/onlinepubs/007908799/xsh/clock_gettime.html)。

```
#include <sys/time.h>

int main()
{
   timespec ts;
   // clock_gettime(CLOCK_MONOTONIC, &ts); // Works on FreeBSD
   clock_gettime(CLOCK_REALTIME, &ts); // Works on Linux
} 
```

对于要使用[QueryPerformanceCounter](http://support.microsoft.com/kb/172338)的窗口。这里有更多关于[QPC](http://msdn.microsoft.com/en-us/library/ms979201.aspx)

显然，某些芯片组上的 QPC 存在已知[问题](http://support.microsoft.com/kb/274323)，因此您可能需要确保您没有这些芯片组。此外，一些双核 AMD 也可能导致[问题](http://forum.beyond3d.com/showthread.php?t=47951)。请参阅 sebbbi 的第二篇文章，他在其中指出：

> QueryPerformanceCounter() 和 QueryPerformanceFrequency() 提供了更好的分辨率，但有不同的问题。例如，在 Windows XP 中，所有 AMD Athlon X2 双核 CPU “随机”返回任一内核的 PC（PC 有时会向后跳一点），除非您专门安装 AMD 双核驱动程序包来解决问题。我们没有注意到任何其他双核 CPU 有类似问题（p4 dual、p4 ht、core2 dual、core2 quad、phenom quad）。

**编辑 2013/07/16：**

[如http://msdn.microsoft.com/en-us/library/windows/desktop/ee417693(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ee417693(v=vs.85).aspx)所述，在某些情况下，QPC 的功效似乎存在一些争议

> ...虽然 QueryPerformanceCounter 和 QueryPerformanceFrequency 通常针对多个处理器进行调整，但 BIOS 或驱动程序中的错误可能会导致这些例程在线程从一个处理器移动到另一个处理器时返回不同的值...

然而，这个 StackOverflow 答案[https://stackoverflow.com/a/4588605/34329](https://stackoverflow.com/a/4588605/34329)指出 QPC 应该在 Win XP Service Pack 2 之后的任何 MS 操作系统上正常工作。

本文显示 Windows 7 可以确定处理器是否具有不变的 TSC，如果没有，则回退到外部计时器。[http://performancebydesign.blogspot.com/2012/03/high-resolution-clocks-and-timers-for.html](http://performancebydesign.blogspot.com/2012/03/high-resolution-clocks-and-timers-for.html)跨处理器同步仍然是一个问题。

其他与计时器相关的精读：

*   [https://blogs.oracle.com/dholmes/entry/inside_the_hotspot_vm_clocks](https://blogs.oracle.com/dholmes/entry/inside_the_hotspot_vm_clocks)
*   [http://lwn.net/Articles/209101/](http://lwn.net/Articles/209101/)
*   [http://performancebydesign.blogspot.com/2012/03/high-resolution-clocks-and-timers-for.html](http://performancebydesign.blogspot.com/2012/03/high-resolution-clocks-and-timers-for.html)
*   [QueryPerformanceCounter 状态？](https://stackoverflow.com/questions/7287663/queryperformancecounter-status)

有关更多详细信息，请参阅评论。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2012-07-14T16:21:15.117

这个新答案使用了 C++11 的`<chrono>`功能。虽然还有其他答案显示了如何使用`<chrono>`，但没有一个显示如何使用此处其他几个答案中提到`<chrono>`的设施。`RDTSC`所以我想我会展示如何使用`RDTSC`with `<chrono>`。此外，我将演示如何模板化时钟上的测试代码，以便您可以在`RDTSC`系统的内置时钟设施（可能基于`clock()`,`clock_gettime()`和/或`QueryPerformanceCounter`.

请注意，该`RDTSC`指令是特定于 x86 的。 `QueryPerformanceCounter`仅适用于 Windows。并且`clock_gettime()`仅是 POSIX。下面我介绍两个新时钟：`std::chrono::high_resolution_clock`和`std::chrono::system_clock`，如果你可以假设 C++11，它们现在是跨平台的。

`rdtsc`首先，这是从 Intel汇编指令中创建与 C++11 兼容的时钟的方法。我会这样称呼它`x::clock`：

```
#include <chrono>

namespace x
{

struct clock
{
    typedef unsigned long long                 rep;
    typedef std::ratio<1, 2'800'000'000>       period; // My machine is 2.8 GHz
    typedef std::chrono::duration<rep, period> duration;
    typedef std::chrono::time_point<clock>     time_point;
    static const bool is_steady =              true;

    static time_point now() noexcept
    {
        unsigned lo, hi;
        asm volatile("rdtsc" : "=a" (lo), "=d" (hi));
        return time_point(duration(static_cast<rep>(hi) << 32 | lo));
    }
};

}  // x 
```

这个时钟所做的只是计算 CPU 周期并将其存储在一个无符号的 64 位整数中。您可能需要调整编译器的汇编语言语法。或者你的编译器可能会提供一个你可以使用的内在函数（例如`now() {return __rdtsc();}`）。

要构建时钟，您必须为其提供表示（存储类型）。您还必须提供时钟周期，它必须是编译时间常数，即使您的机器可能会在不同的功耗模式下改变时钟速度。从这些基础上，您可以轻松地定义时钟的“本机”持续时间和时间点。

如果您只想输出时钟滴答的数量，那么您为时钟周期提供的数字并不重要。仅当您要将时钟滴答数转换为某些实时单位（例如纳秒）时，此常数才会起作用。在这种情况下，您能够提供的时钟速度越准确，转换为纳秒（毫秒，无论如何）的精度就越高。

下面是显示如何使用的示例代码`x::clock`。实际上，我已经对时钟上的代码进行了模板化，因为我想展示如何以完全相同的语法使用许多不同的时钟。这个特定的测试显示了在循环下运行您想要计时的循环开销是多少：

```
#include <iostream>

template <class clock>
void
test_empty_loop()
{
    // Define real time units
    typedef std::chrono::duration<unsigned long long, std::pico> picoseconds;
    // or:
    // typedef std::chrono::nanoseconds nanoseconds;
    // Define double-based unit of clock tick
    typedef std::chrono::duration<double, typename clock::period> Cycle;
    using std::chrono::duration_cast;
    const int N = 100000000;
    // Do it
    auto t0 = clock::now();
    for (int j = 0; j < N; ++j)
        asm volatile("");
    auto t1 = clock::now();
    // Get the clock ticks per iteration
    auto ticks_per_iter = Cycle(t1-t0)/N;
    std::cout << ticks_per_iter.count() << " clock ticks per iteration\n";
    // Convert to real time units
    std::cout << duration_cast<picoseconds>(ticks_per_iter).count()
              << "ps per iteration\n";
} 
```

这段代码所做的第一件事是创建一个“实时”单位来显示结果。我选择了皮秒，但您可以选择任何您喜欢的单位，无论是基于整数还是基于浮点。`std::chrono::nanoseconds`例如，有一个我可以使用的预制单元。

作为另一个示例，我想将每次迭代的平均时钟周期数打印为浮点数，因此我创建了另一个基于 double 的持续时间，其单位与时钟的刻度相同（`Cycle`在代码中调用）。

`clock::now()`循环与任一侧的调用一起计时。如果要命名从此函数返回的类型，它是：

```
typename clock::time_point t0 = clock::now(); 
```

（如示例中清楚显示的那样`x::clock`，系统提供的时钟也是如此）。

要根据浮点时钟滴答获得持续时间，只需减去两个时间点，并获得每次迭代值，将该持续时间除以迭代次数。

您可以使用`count()`成员函数获取任何持续时间的计数。这将返回内部表示。最后，我使用`std::chrono::duration_cast`将持续时间转换为持续`Cycle`时间`picoseconds`并将其打印出来。

使用此代码很简单：

```
int main()
{
    std::cout << "\nUsing rdtsc:\n";
    test_empty_loop<x::clock>();

    std::cout << "\nUsing std::chrono::high_resolution_clock:\n";
    test_empty_loop<std::chrono::high_resolution_clock>();

    std::cout << "\nUsing std::chrono::system_clock:\n";
    test_empty_loop<std::chrono::system_clock>();
} 
```

上面我使用我们自制的 进行测试`x::clock`，并将这些结果与使用系统提供的两个时钟进行比较： `std::chrono::high_resolution_clock`和`std::chrono::system_clock`。对我来说，这打印出来：

```
Using rdtsc:
1.72632 clock ticks per iteration
616ps per iteration

Using std::chrono::high_resolution_clock:
0.620105 clock ticks per iteration
620ps per iteration

Using std::chrono::system_clock:
0.00062457 clock ticks per iteration
624ps per iteration 
```

这表明这些时钟中的每一个都有不同的滴答周期，因为每个时钟每次迭代的滴答声都大不相同。但是，当转换为已知的时间单位（例如皮秒）时，每个时钟我得到的结果大致相同（您的里程可能会有所不同）。

请注意我的代码是如何完全没有“魔法转换常数”的。事实上，整个例子中只有两个幻数：

1.  我的机器的时钟速度以定义`x::clock`.
2.  要测试的迭代次数。如果更改此数字会使您的结果变化很大，那么您可能应该增加迭代次数，或者在测试时清空计算机中的竞争进程。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-11-08T18:37:55.817

有了这种准确度，最好在 CPU 滴答声中进行推理，而不是在[诸如 clock()](http://mail.python.org/pipermail/python-list/2001-April/079815.html)之类的系统调用中进行推理。并且不要忘记，如果执行一条指令需要超过一纳秒的时间……拥有纳秒的精度几乎是不可能的。

不过，[这样的事情](http://coding.derkeiler.com/Archive/C_CPP/comp.lang.cpp/2004-03/1376.html)是一个开始：

这是检索自上次启动 CPU 以来经过的 80x86 CPU 时钟滴答数的实际代码。它适用于 Pentium 及更高版本（不支持 386/486）。这段代码实际上是 MS Visual C++ 特定的，但只要它支持内联汇编，就可以很容易地移植到其他任何地方。

```
inline __int64 GetCpuClocks()
{

    // Counter
    struct { int32 low, high; } counter;

    // Use RDTSC instruction to get clocks count
    __asm push EAX
    __asm push EDX
    __asm __emit 0fh __asm __emit 031h // RDTSC
    __asm mov counter.low, EAX
    __asm mov counter.high, EDX
    __asm pop EDX
    __asm pop EAX

    // Return result
    return *(__int64 *)(&counter);

} 
```

这个函数还有一个非常快的优点——它通常需要不超过 50 个 cpu 周期来执行。

[使用时序图](http://www.devx.com/MicrosoftISV/Article/16293)：
如果您需要将时钟计数转换为真实的经过时间，请将结果除以芯片的时钟速度。请记住，“额定”GHz 可能与芯片的实际速度略有不同。要检查您的芯片的真实速度，您可以使用几个非常好的实用程序或 Win32 调用，QueryPerformanceFrequency()。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2010-07-08T16:16:07.527

要正确执行此操作，您可以使用两种方法之一，使用`RDTSC`或使用`clock_gettime()`。第二个大约快 2 倍，并且具有提供正确绝对时间的优势。请注意，为了`RDTSC`正常工作，您需要按照指示使用它（此页面上的其他注释有错误，并且可能在某些处理器上产生不正确的时序值）

```
inline uint64_t rdtsc()
{
    uint32_t lo, hi;
    __asm__ __volatile__ (
      "xorl %%eax, %%eax\n"
      "cpuid\n"
      "rdtsc\n"
      : "=a" (lo), "=d" (hi)
      :
      : "%ebx", "%ecx" );
    return (uint64_t)hi << 32 | lo;
} 
```

而对于clock_gettime：（我随意选择了微秒分辨率）

```
#include <time.h>
#include <sys/timeb.h>
// needs -lrt (real-time lib)
// 1970-01-01 epoch UTC time, 1 mcs resolution (divide by 1M to get time_t)
uint64_t ClockGetTime()
{
    timespec ts;
    clock_gettime(CLOCK_REALTIME, &ts);
    return (uint64_t)ts.tv_sec * 1000000LL + (uint64_t)ts.tv_nsec / 1000LL;
} 
```

产生的时间和价值：

```
Absolute values:
rdtsc           = 4571567254267600
clock_gettime   = 1278605535506855

Processing time: (10000000 runs)
rdtsc           = 2292547353
clock_gettime   = 1031119636 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2008-11-12T10:50:10.877

我正在使用以下内容来获得所需的结果：

```
#include <time.h>
#include <iostream>
using namespace std;

int main (int argc, char** argv)
{
    // reset the clock
    timespec tS;
    tS.tv_sec = 0;
    tS.tv_nsec = 0;
    clock_settime(CLOCK_PROCESS_CPUTIME_ID, &tS);
    ...
    ... <code to check for the time to be put here>
    ...
    clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &tS);
    cout << "Time taken is: " << tS.tv_sec << " " << tS.tv_nsec << endl;

    return 0;
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-10-19T22:04:23.473

对于[C++11](https://en.wikipedia.org/wiki/C%2B%2B11)，这是一个简单的包装器：

```
#include <iostream>
#include <chrono>

class Timer
{
public:
    Timer() : beg_(clock_::now()) {}
    void reset() { beg_ = clock_::now(); }
    double elapsed() const {
        return std::chrono::duration_cast<second_>
            (clock_::now() - beg_).count(); }

private:
    typedef std::chrono::high_resolution_clock clock_;
    typedef std::chrono::duration<double, std::ratio<1> > second_;
    std::chrono::time_point<clock_> beg_;
}; 
```

或者对于 *nix 上的 C++03，

```
class Timer
{
public:
    Timer() { clock_gettime(CLOCK_REALTIME, &beg_); }

    double elapsed() {
        clock_gettime(CLOCK_REALTIME, &end_);
        return end_.tv_sec - beg_.tv_sec +
            (end_.tv_nsec - beg_.tv_nsec) / 1000000000.;
    }

    void reset() { clock_gettime(CLOCK_REALTIME, &beg_); }

private:
    timespec beg_, end_;
}; 
```

使用示例：

```
int main()
{
    Timer tmr;
    double t = tmr.elapsed();
    std::cout << t << std::endl;

    tmr.reset();
    t = tmr.elapsed();
    std::cout << t << std::endl;
    return 0;
} 
```

来自[https://gist.github.com/gongzhitaao/7062087](https://gist.github.com/gongzhitaao/7062087)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-11-08T18:21:09.487

一般来说，为了计时调用一个函数需要多长时间，您希望执行多次而不是一次。如果你只调用你的函数一次并且它需要很短的时间来运行，你仍然有实际调用计时器函数的开销，你不知道需要多长时间。

例如，如果您估计您的函数可能需要 800 ns 才能运行，请在循环中调用它一千万次（然后大约需要 8 秒）。将总时间除以一千万得到每次调用的时间。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-11-09T03:06:45.167

在 x86 处理器下运行的 gcc 可以使用以下函数：

```
unsigned long long rdtsc()
{
  #define rdtsc(low, high) \
         __asm__ __volatile__("rdtsc" : "=a" (low), "=d" (high))

  unsigned int low, high;
  rdtsc(low, high);
  return ((ulonglong)high << 32) | low;
} 
```

使用数字火星 C++：

```
unsigned long long rdtsc()
{
   _asm
   {
        rdtsc
   }
} 
```

它读取芯片上的高性能定时器。我在进行分析时使用它。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-08T18:56:53.687

如果您需要亚秒级精度，则需要使用系统特定的扩展，并且必须查看操作系统的文档。[POSIX 使用gettimeofday](http://dell5.ma.utexas.edu/cgi-bin/man-cgi?gettimeofday+2)最多支持微秒，但由于计算机的频率不高于 1GHz，因此没有更精确的了。

如果您使用的是 Boost，则可以检查[boost::posix_time](http://www.boost.org/doc/libs/1_37_0/doc/html/date_time/posix_time.html)。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-01-18T04:19:09.367

我在这里使用的是 Borland 代码，代码 ti_hund 有时会给我一个负数，但时机相当好。

```
#include <dos.h>

void main() 
{
struct  time t;
int Hour,Min,Sec,Hun;
gettime(&t);
Hour=t.ti_hour;
Min=t.ti_min;
Sec=t.ti_sec;
Hun=t.ti_hund;
printf("Start time is: %2d:%02d:%02d.%02d\n",
   t.ti_hour, t.ti_min, t.ti_sec, t.ti_hund);
....
your code to time
...

// read the time here remove Hours and min if the time is in sec

gettime(&t);
printf("\nTid Hour:%d Min:%d Sec:%d  Hundreds:%d\n",t.ti_hour-Hour,
                             t.ti_min-Min,t.ti_sec-Sec,t.ti_hund-Hun);
printf("\n\nAlt Ferdig Press a Key\n\n");
getch();
} // end main 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-06-28T10:10:25.043

使用 Brock Adams 的方法，带有一个简单的类：

```
int get_cpu_ticks()
{
    LARGE_INTEGER ticks;
    QueryPerformanceFrequency(&ticks);
    return ticks.LowPart;
}

__int64 get_cpu_clocks()
{
    struct { int32 low, high; } counter;

    __asm cpuid
    __asm push EDX
    __asm rdtsc
    __asm mov counter.low, EAX
    __asm mov counter.high, EDX
    __asm pop EDX
    __asm pop EAX

    return *(__int64 *)(&counter);
}

class cbench
{
public:
    cbench(const char *desc_in) 
         : desc(strdup(desc_in)), start(get_cpu_clocks()) { }
    ~cbench()
    {
        printf("%s took: %.4f ms\n", desc, (float)(get_cpu_clocks()-start)/get_cpu_ticks());
        if(desc) free(desc);
    }
private:
    char *desc;
    __int64 start;
}; 
```

使用示例：

```
int main()
{
    {
        cbench c("test");
        ... code ...
    }
    return 0;
} 
```

结果：

测试时间：0.0002 毫秒

有一些函数调用开销，但应该仍然足够快:)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2012-11-09T09:35:15.557

您可以使用*Embedded Profiler*（对 Windows 和 Linux 免费），它具有与多平台计时器的接口（以处理器周期计数），并且可以为您提供每秒的周期数：

```
EProfilerTimer timer;
timer.Start();

... // Your code here

const uint64_t number_of_elapsed_cycles = timer.Stop();
const uint64_t nano_seconds_elapsed =
    mumber_of_elapsed_cycles / (double) timer.GetCyclesPerSecond() * 1000000000; 
```

对于 CPU 频率可以动态更改的现代处理器，将周期计数重新计算为时间可能是一项危险的操作。因此，为了确保转换的时间是正确的，有必要在分析之前修复处理器频率。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-11-08T19:00:41.560

如果这是针对 Linux 的，我一直在使用函数“gettimeofday”，它返回一个结构，该结构给出自 Epoch 以来的秒数和微秒数。然后，您可以使用 timersub 将两者相减以获得时间差，并将其转换为您想要的任何时间精度。但是，您指定纳秒，并且看起来函数[clock_gettime()](http://opengroup.org/onlinepubs/007908799/xsh/clock_gettime.html)是您正在寻找的。它将以秒和纳秒为单位的时间放入您传递给它的结构中。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2012-08-29T11:25:47.727

你怎么看：

```
 int iceu_system_GetTimeNow(long long int *res)
    {
      static struct timespec buffer;
      // 
    #ifdef __CYGWIN__
      if (clock_gettime(CLOCK_REALTIME, &buffer))
        return 1;
    #else
      if (clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &buffer))
        return 1;
    #endif
      *res=(long long int)buffer.tv_sec * 1000000000LL + (long long int)buffer.tv_nsec;
      return 0;
    } 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-04-24T04:49:07.247

这是一个很好的[Boost](http://en.wikipedia.org/wiki/Boost_%28C%2B%2B_libraries%29)计时器，效果很好：

```
//Stopwatch.hpp

#ifndef STOPWATCH_HPP
#define STOPWATCH_HPP

//Boost
#include <boost/chrono.hpp>
//Std
#include <cstdint>

class Stopwatch
{
public:
    Stopwatch();
    virtual         ~Stopwatch();
    void            Restart();
    std::uint64_t   Get_elapsed_ns();
    std::uint64_t   Get_elapsed_us();
    std::uint64_t   Get_elapsed_ms();
    std::uint64_t   Get_elapsed_s();
private:
    boost::chrono::high_resolution_clock::time_point _start_time;
};

#endif // STOPWATCH_HPP

//Stopwatch.cpp

#include "Stopwatch.hpp"

Stopwatch::Stopwatch():
    _start_time(boost::chrono::high_resolution_clock::now()) {}

Stopwatch::~Stopwatch() {}

void Stopwatch::Restart()
{
    _start_time = boost::chrono::high_resolution_clock::now();
}

std::uint64_t Stopwatch::Get_elapsed_ns()
{
    boost::chrono::nanoseconds nano_s = boost::chrono::duration_cast<boost::chrono::nanoseconds>(boost::chrono::high_resolution_clock::now() - _start_time);
    return static_cast<std::uint64_t>(nano_s.count());
}

std::uint64_t Stopwatch::Get_elapsed_us()
{
    boost::chrono::microseconds micro_s = boost::chrono::duration_cast<boost::chrono::microseconds>(boost::chrono::high_resolution_clock::now() - _start_time);
    return static_cast<std::uint64_t>(micro_s.count());
}

std::uint64_t Stopwatch::Get_elapsed_ms()
{
    boost::chrono::milliseconds milli_s = boost::chrono::duration_cast<boost::chrono::milliseconds>(boost::chrono::high_resolution_clock::now() - _start_time);
    return static_cast<std::uint64_t>(milli_s.count());
}

std::uint64_t Stopwatch::Get_elapsed_s()
{
    boost::chrono::seconds sec = boost::chrono::duration_cast<boost::chrono::seconds>(boost::chrono::high_resolution_clock::now() - _start_time);
    return static_cast<std::uint64_t>(sec.count());
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-02-10T10:42:50.570

# 简约的复制粘贴结构 + 懒惰的使用

如果想法是拥有一个可用于快速测试的简约结构，那么我建议您只需**复制并粘贴**到 C++ 文件中`#include`'s. 这是我牺牲 Allman 样式格式的唯一实例。

您可以轻松调整结构第一行的精度。可能的值为：`nanoseconds`、`microseconds`、`milliseconds`、`seconds`、`minutes`或`hours`。

```
#include <chrono>
struct MeasureTime
{
    using precision = std::chrono::microseconds;
    std::vector<std::chrono::steady_clock::time_point> times;
    std::chrono::steady_clock::time_point oneLast;
    void p() {
        std::cout << "Mark " 
                << times.size()/2
                << ": " 
                << std::chrono::duration_cast<precision>(times.back() - oneLast).count() 
                << std::endl;
    }
    void m() {
        oneLast = times.back();
        times.push_back(std::chrono::steady_clock::now());
    }
    void t() {
        m();
        p();
        m();
    }
    MeasureTime() {
        times.push_back(std::chrono::steady_clock::now());
    }
}; 
```

## 用法

```
MeasureTime m; // first time is already in memory
doFnc1();
m.t(); // Mark 1: next time, and print difference with previous mark
doFnc2();
m.t(); // Mark 2: next time, and print difference with previous mark
doStuff = doMoreStuff();
andDoItAgain = doStuff.aoeuaoeu();
m.t(); // prints 'Mark 3: 123123' etc... 
```

## 标准输出结果

```
Mark 1: 123
Mark 2: 32
Mark 3: 433234 
```

# 如果您想要执行后的摘要

如果您之后想要报告，因为例如您之间的代码也会写入标准输出。然后将以下函数添加到结构中（就在 MeasureTime() 之前）：

```
void s() { // summary
    int i = 0;
    std::chrono::steady_clock::time_point tprev;
    for(auto tcur : times)
    {
        if(i > 0)
        {
            std::cout << "Mark " << i << ": "
                    << std::chrono::duration_cast<precision>(tprev - tcur).count()
                    << std::endl;
        }
        tprev = tcur;
        ++i;
    }
} 
```

那么你可以使用：

```
MeasureTime m;
doFnc1();
m.m();
doFnc2();
m.m();
doStuff = doMoreStuff();
andDoItAgain = doStuff.aoeuaoeu();
m.m();
m.s(); 
```

它将像以前一样列出所有标记，但是在执行其他代码之后。请注意，您不应同时使用`m.s()`和`m.t()`。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-12-03T00:58:36.047

[plf::nanotimer](https://plflib.org/nanotimer.htm)是一个轻量级选项，适用于 Windows、Linux、Mac 和 BSD 等。根据操作系统，精度约为微秒：

```
 #include "plf_nanotimer.h"
  #include <iostream>

  int main(int argc, char** argv)
  {
      plf::nanotimer timer;

      timer.start()

      // Do something here

      double results = timer.get_elapsed_ns();
      std::cout << "Timing: " << results << " nanoseconds." << std::endl;    
      return 0;
  } 
```

# opengl - 查找 3d 点之间的旋转角度

> ID：275005
> 
> 赞同：4
> 
> 时间：2008-11-08T18:12:04.887
> 
> 标签：opengl, 3d, rotation

我正在编写一个程序，它将沿着样条曲线绘制一个实体。我正在使用 Visual Studio 2005，并用 C++ 编写 OpenGL。我正在使用 FLTK 打开我的窗口（快速轻便的工具包）。

我目前有一个算法，将绘制一个基本三次样条，给定一组控制点，通过将点之间的间隔分解为子间隔并在这些子点之间绘制线段。子区间的数量是可变的。

画线代码效果很好，基本上工作如下：我使用样条方程沿样条曲线生成一组点并将它们存储在一个数组中（作为一个称为 Pnt3f 的特殊数据结构，其中坐标是 3 个浮点数，并且有一些方便的函数，如距离、长度、点和叉积）。然后我有一个循环遍历点数组并绘制它们：

```
glBegin(GL_LINE_STRIP);
for(pt = 0; pt<=numsubsegements ; ++pt) {
    glVertex3fv(pt.v());
}
glEnd(); 
```

如前所述，此代码效果很好。现在我想做的是，我想挤出一个实体，而不是画一条线。我目前的探索是使用“圆柱”二次曲线沿线创建管。这有点棘手，因为我必须将 openGL 定向到我想要绘制圆柱体的方向。我的想法是这样做：

伪代码：

```
Push the current matrix,
translate to the first control point
rotate to face the next point
draw a cylinder (length = distance between the points)
Pop the matrix
repeat 
```

我的问题是获得点之间的角度。我只需要偏航和俯仰，滚动并不重要。我知道将两个点的点积除以两个点的大小的反余弦值，将返回它们之间的角度，但这不是我可以提供给 OpenGL 旋转的东西。我已经尝试在 2d 中执行此操作，使用 XZ 平面进行 x 旋转，并从原点制作点向量，但它没有返回正确的角度。

我目前的方法要简单得多。对于每个旋转平面（X 和 Y），通过以下方式找到角度：

反余弦（（“x”值的差异）/点之间的距离）

“x”值取决于您如何设置飞机，尽管对于我的计算，我总是使用世界 x。

除非有一些问题使它在我还没有解决的正确象限中绘制出来，否则我想得到建议，看看这是否是一个好的实现，或者看看是否有人知道更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T20:29:42.130

一些注意事项：
首先，这是：

```
for(pt = 0; pt<=numsubsegements ; ++pt) {
  glBegin(GL_LINE_STRIP);
    glVertex3fv(pt.v());
}
glEnd(); 
```

不是画任何东西的好方法。每个 glBegin() 都必须有一个 glEnd()。您可能希望将 glBegin() 退出循环。这个工作的事实是纯粹的运气。

第二件事

> 我目前的探索是使用“圆柱体”二次曲线沿线创建管

**这不会像您期望的那样工作。**“圆柱体”二次曲面有一个平顶底座和一个平底底座。即使您成功地根据样条曲线进行了正确的旋转，平顶的边缘也会从您预期的管子的体积中弹出，并且不会光滑。您可以只用一支笔和一张纸在 2D 中进行尝试。尝试仅使用带有扁平底座的较短管子绘制光滑的管子。这是不可能的。

第三，对于您的实际问题，这种旋转的权威工具是[quaternions](http://en.wikipedia.org/wiki/Quaternions)。在这个范围内解释起来有点复杂，但你可以在任何地方找到大量信息。
如果您使用 QT 而不是 FLTK，您也可以使用[libQGLViewer](http://www.libqglviewer.com/)。它有一个集成的 Quaternion 类，可以为您节省实现。如果您仍然有选择，我强烈建议您迁移到 QT。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T18:48:59.413

您正确地从两个相邻线段中的三个点形成两个向量，然后使用点积的反余弦来获得它们之间的角度。要利用这个角度，您需要确定旋转应该围绕的轴。取相同的两个向量的叉积来得到这个轴。然后，您可以使用此轴角[构建变换矩阵，或将其作为参数传递给](http://web.archive.org/web/20041029003853/http:/www.j3d.org/matrix_faq/matrfaq_latest.html#Q38)[glRotate](http://www.opengl.org/sdk/docs/man/xhtml/glRotate.xml)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T18:54:44.660

你考虑过[`gluLookAt`](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/glu/lookat.html)吗？把你的控制点作为眼点，下一个点作为参考点，并使上向量垂直于两者之间的差异。

# javascript - 双转义 Unicode Javascript 问题

> ID：275011
> 
> 赞同：9
> 
> 时间：2008-11-08T18:17:45.997
> 
> 标签：javascript, unicode, escaping

我在显示带有嵌入式 Unicode 字符转义序列 (\uXXXX) 的 Javascript 字符串时遇到问题，其中初始“\”字符本身转义为“\” 我需要做什么来转换字符串，以便它正确评估转义序列并使用正确的 Unicode 字符生成输出？

例如，我正在处理以下输入：

```
"this is a &#92;u201ctest&#92;u201d";
```

试图解码“\” 使用正则表达式，例如：

```
var out  = text.replace('/&#92;/g','\');
```

结果输出文本：

```
"this is a \u201ctest\u201d";
```

也就是说，Unicode 转义序列显示为实际的转义序列，而不是我想要的双引号字符。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-08T19:03:50.820

事实证明，我们想要的是 unescape()，但使用 '%uXXXX' 而不是 '\uXXXX'：

unescape(yourteststringhere.replace(/\/g,'%'))

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T19:05:12.720

这是一个糟糕的解决方案，但您可以这样做：

```
var x = "this is a &#92;u201ctest&#92;u201d".replace(/&#92;/g,'\\')
// x is now "this is a \u201ctest\u201d"
eval('x = "' + x + '"')
// x is now "this is a “test”" 
```

这很可怕，因为：

*   eval 可能很危险，如果您不知道字符串中的内容

*   如果字符串中有实际引号，则 eval 语句中的字符串引用将中断

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T02:19:41.003

您确定 '\' 是唯一可能被 HTML 转义的字符吗？您确定 '\uXXXX' 是唯一一种正在使用的字符串转义吗？

如果没有，您将需要一个通用的 HTML-character/entity-reference-decoder 和 JS-string-literal-decoder。不幸的是，JavaScript 没有内置的方法，并且手动处理大量的正则表达式非常乏味。

可以通过将字符串分配给元素的 innerHTML 属性来利用浏览器的 HTML 解码器，然后要求 JavaScript 对字符串进行解码，如下所示：

```
var el= document.createElement('div');
el.innerHTML= s;
return eval('"'+el.firstChild.data+'"'); 
```

但是，如果字符串来自不是 100% 受信任的来源，那么这是一个非常丑陋的黑客攻击和安全漏洞。

字符串从哪里来？如果可能在服务器端处理问题会更好，您可能会拥有更强大的文本处理功能。而且，如果您可以修复任何不必要的 HTML 转义反斜杠的问题，您会发现问题自行解决。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T18:40:32.100

我的想法是一样的，但是在我能想象的所有方式中使用 eval() 都会导致相同的转义输出；例如，

```
eval(new String("this is a &#92;u201ctest&#amp;92;u201d"));
```

甚至

```
eval(new String("this is a &#92;u201ctest&#amp;92;u201d".replace('/&#92;/g','\')));
```

所有结果都是一样的：

```
"this is a \u201ctest\u201d";
```

就好像我需要让 Javascript 引擎以某种方式重新评估或重新解析字符串，但我不知道该怎么做。我想也许 eval() 或者只是使用正确转义的输入创建一个新字符串就可以了，但现在运气了。

基本问题是 - 我必须做什么来转动给定的字符串：

```
"this is a &#92;u201ctest&#amp;92;u201d"
```

成一个使用正确 Unicode 字符的字符串？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T18:28:22.793

我不确定是否是这样，但如果您可以信任您的输入，答案可能与 eval() 有关。

# asp.net - 可编辑的数据网格？中继器？

> ID：275017
> 
> 赞同：0
> 
> 时间：2008-11-08T18:24:45.547
> 
> 标签：asp.net, gridview, repeater

我有一个项目列表，以便在 asp.net 中显示——每个项目（行）将有 3 个文本框，因此用户可以查看和更改该数据（运输成本、处理成本、价格）。

实现此目的的一种“推荐”方式是什么？使用转发器，我假设我必须在回发时遍历表单值，并且使用 gridview 控件我必须覆盖 onrowdatabound 和回发一些其他方法。

我相信两者都可以，但是作为开发人员，您在这种情况下会选择什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T20:39:29.253

我过去所做的是使用数据绑定的 GridView TemplateColumns：

```
<asp:GridView runat="server" ID="grdRoster" AutoGenerateColumns="false">
    <Columns>
        <asp:TemplateField HeaderText="First Name">
            <ItemTemplate>
                <asp:TextBox runat="server" ID="txtFirstName" Columns="10" Text='<%# Eval("RosterFirstName") %>' />
            </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Middle Name">
            <ItemTemplate>
                <asp:TextBox runat="server" ID="txtMiddleName" Columns="10" Text='<%# Eval("RosterMiddleName") %>' />
            </ItemTemplate>
        </asp:TemplateField>                       
        <asp:TemplateField HeaderText="Last Name">
            <ItemTemplate>
                <asp:TextBox runat="server" ID="txtLastName" Columns="10" Text='<%# Eval("RosterLastName") %>' />
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

然后，在回发时（例如，单击“保存”按钮），您可以遍历 GridView 中的行并从文本框中提取值：

```
foreach ( GridViewRow row in grdRoster.Rows )
{
    if ( row.RowType == DataControlRowType.DataRow )
    {
        string firstName = ( ( TextBox ) row.FindControl( "txtRosterFirstName" ) ).Text;
        string middleName = ( ( TextBox ) row.FindControl( "txtRosterMiddleName" ) ).Text;
        string lastName = ( ( TextBox ) row.FindControl( "txtRosterLastName" ) ).Text;
    }
} 
```

# python - 如何删除尾随换行符？

> ID：275018
> 
> 赞同：1909
> 
> 时间：2008-11-08T18:25:24.080
> 
> 标签：python, newline, trailing

Perl`chomp`函数的 Python 等价物是什么，如果它是换行符，它会删除字符串的最后一个字符？

* * *

## 回答 #1

> 赞同：2146
> 
> 时间：2008-11-08T18:31:53.113

尝试该方法`rstrip()`（请参阅文档[Python 2](http://docs.python.org/2/library/stdtypes.html#str.rstrip)和[Python 3](https://docs.python.org/3/library/stdtypes.html#str.rstrip)）

```
>>> 'test string\n'.rstrip()
'test string' 
```

默认情况下， Python 的`rstrip()`方法会去除*各种*尾随空格，而不是像 Perl 那样只删除一个换行符[`chomp`](http://perldoc.perl.org/functions/chomp.html)。

```
>>> 'test string \n \r\n\n\r \n\n'.rstrip()
'test string' 
```

仅去除换行符：

```
>>> 'test string \n \r\n\n\r \n\n'.rstrip('\n')
'test string \n \r\n\n\r ' 
```

除此之外`rstrip()`，还有方法`strip()`和`lstrip()`。以下是他们三个的例子：

```
>>> s = "   \n\r\n  \n  abc   def \n\r\n  \n  "
>>> s.strip()
'abc   def'
>>> s.lstrip()
'abc   def \n\r\n  \n  '
>>> s.rstrip()
'   \n\r\n  \n  abc   def' 
```

* * *

## 回答 #2

> 赞同：180
> 
> 时间：2008-11-09T05:52:43.990

我会说在没有尾随换行符的情况下获取行的“pythonic”方法是 splitlines()。

```
>>> text = "line 1\nline 2\r\nline 3\nline 4"
>>> text.splitlines()
['line 1', 'line 2', 'line 3', 'line 4'] 
```

* * *

## 回答 #3

> 赞同：163
> 
> 时间：2008-11-09T00:11:21.447

去除行尾 (EOL) 字符的规范方法是使用字符串 rstrip() 方法删除任何尾随 \r 或 \n。以下是 Mac、Windows 和 Unix EOL 字符的示例。

```
>>> 'Mac EOL\r'.rstrip('\r\n')
'Mac EOL'
>>> 'Windows EOL\r\n'.rstrip('\r\n')
'Windows EOL'
>>> 'Unix EOL\n'.rstrip('\r\n')
'Unix EOL' 
```

使用 '\r\n' 作为 rstrip 的参数意味着它会去掉 '\r' 或 '\n' 的任何尾随组合。这就是为什么它在上述所有三种情况下都有效。

这种细微差别在极少数情况下很重要。例如，我曾经必须处理一个包含 HL7 消息的文本文件。HL7 标准要求尾随 '\r' 作为其 EOL 字符。我使用此消息的 Windows 机器附加了它自己的 '\r\n' EOL 字符。因此，每一行的结尾看起来像 '\r\r\n'。使用 rstrip('\r\n') 会删除整个 '\r\r\n' 这不是我想要的。在这种情况下，我只是简单地切掉了最后两个字符。

请注意，与 Perl 的`chomp`函数不同，这将删除字符串末尾的所有指定字符，而不仅仅是一个：

```
>>> "Hello\n\n\n".rstrip("\n")
"Hello" 
```

* * *

## 回答 #4

> 赞同：102
> 
> 时间：2008-11-28T17:31:34.567

请注意， rstrip 的行为与 Perl 的 chomp() 不完全相同，因为它不修改字符串。也就是说，在 Perl 中：

```
$x="a\n";

chomp $x 
```

结果`$x`是`"a"`。

但在 Python 中：

```
x="a\n"

x.rstrip() 
```

将意味着 的值**仍然**`x`是。Even并不总是给出相同的结果，因为它会删除字符串末尾的所有空格，而最多不只是一个换行符。 **`"a\n"``x=x.rstrip()`**

 *** * *

## 回答 #5

> 赞同：51
> 
> 时间：2010-03-07T16:07:27.817

我可能会使用这样的东西：

```
import os
s = s.rstrip(os.linesep) 
```

我认为问题`rstrip("\n")`在于您可能希望确保行分隔符是可移植的。（有传言说使用一些过时的系统`"\r\n"`）。另一个问题是`rstrip`会去除重复的空格。希望`os.linesep`将包含正确的字符。以上对我有用。

* * *

## 回答 #6

> 赞同：41
> 
> 时间：2013-05-13T16:41:22.337

您可以使用`line = line.rstrip('\n')`. 这将从字符串末尾删除所有换行符，而不仅仅是一个。

* * *

## 回答 #7

> 赞同：37
> 
> 时间：2015-03-09T08:02:55.947

```
s = s.rstrip() 
```

将删除字符串末尾的所有换行符`s`。需要赋值，因为`rstrip`返回一个新字符串而不是修改原始字符串。

* * *

## 回答 #8

> 赞同：34
> 
> 时间：2012-02-29T22:40:11.213

```
"line 1\nline 2\r\n...".replace('\n', '').replace('\r', '')
>>> 'line 1line 2...' 
```

或者你总是可以用正则表达式变得更怪异

* * *

## 回答 #9

> 赞同：34
> 
> 时间：2015-10-01T08:33:32.383

这将完全复制 perl 的 chomp （减去数组上的行为）用于 "\n" 行终止符：

```
def chomp(x):
    if x.endswith("\r\n"): return x[:-2]
    if x.endswith("\n") or x.endswith("\r"): return x[:-1]
    return x 
```

（注意：它不会修改字符串 'in place'；它不会去除多余的尾随空格；考虑到 \r\n）

* * *

## 回答 #10

> 赞同：28
> 
> 时间：2014-11-21T04:29:07.607

你可以使用条带：

```
line = line.strip() 
```

演示：

```
>>> "\n\n hello world \n\n".strip()
'hello world' 
```

* * *

## 回答 #11

> 赞同：20
> 
> 时间：2011-04-23T12:42:25.337

在很多层面上，rstrip 与 chomp 不同。阅读[http://perldoc.perl.org/functions/chomp.html](http://perldoc.perl.org/functions/chomp.html)并看到 chomp 确实非常复杂。

但是，我的主要观点是 chomp 最多删除 1 行结尾，而 rstrip 将尽可能多地删除。

在这里，您可以看到 rstrip 删除了所有换行符：

```
>>> 'foo\n\n'.rstrip(os.linesep)
'foo' 
```

使用 re.sub 可以更接近典型的 Perl chomp 用法，如下所示：

```
>>> re.sub(os.linesep + r'\Z','','foo\n\n')
'foo\n' 
```

* * *

## 回答 #12

> 赞同：19
> 
> 时间：2013-10-23T01:32:11.793

[Python 文档中的](http://docs.python.org/2/library/stdtypes.html#file.next)一个示例仅使用`line.strip()`.

Perl 的`chomp`函数仅在字符串确实存在时才从字符串末尾删除一个换行序列。

这是我计划在 Python 中执行此操作的方法，如果`process`从概念上讲，我需要这个函数来对此文件中的每一行执行一些有用的操作：

```
import os
sep_pos = -len(os.linesep)
with open("file.txt") as f:
    for line in f:
        if line[sep_pos:] == os.linesep:
            line = line[:sep_pos]
        process(line) 
```

* * *

## 回答 #13

> 赞同：19
> 
> 时间：2011-04-27T11:43:20.157

小心`"foo".rstrip(os.linesep)`：这只会为执行 Python 的平台选择换行符。想象一下，你正在 Linux 下修改 Windows 文件的行，例如：

```
$ python
Python 2.7.1 (r271:86832, Mar 18 2011, 09:09:48) 
[GCC 4.5.0 20100604 [gcc-4_5-branch revision 160292]] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import os, sys
>>> sys.platform
'linux2'
>>> "foo\r\n".rstrip(os.linesep)
'foo\r'
>>> 
```

`"foo".rstrip("\r\n")`如迈克上面所说，请改用。

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2009-07-03T01:49:19.590

我没有使用 Python 编程，但我在 python.org 上遇到了一个[常见问题解答](http://www.python.org/doc/faq/programming/#is-there-an-equivalent-to-perl-s-chomp-for-removing-trailing-newlines-from-strings)，提倡 S.rstrip("\r\n") 用于 python 2.2 或更高版本。

* * *

## 回答 #15

> 赞同：12
> 
> 时间：2014-01-20T19:07:03.187

```
import re

r_unwanted = re.compile("[\n\t\r]")
r_unwanted.sub("", your_text) 
```

* * *

## 回答 #16

> 赞同：9
> 
> 时间：2013-10-11T11:56:21.093

如果您的问题是清理多行str对象（oldstr）中的所有换行符，您可以根据分隔符'\n'将其拆分为一个列表，然后将此列表加入一个新的str（newstr）中。

`newstr = "".join(oldstr.split('\n'))`

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2015-01-11T18:47:33.673

我发现能够通过 in 迭代器获取 chomped 行很方便，这与从文件对象获取 unchomped 行的方式平行。您可以使用以下代码执行此操作：

```
def chomped_lines(it):
    return map(operator.methodcaller('rstrip', '\r\n'), it) 
```

示例用法：

```
with open("file.txt") as infile:
    for line in chomped_lines(infile):
        process(line) 
```

* * *

## 回答 #18

> 赞同：9
> 
> 时间：2017-07-27T05:24:28.030

我正在从我之前在另一个答案的评论中发布的一个基于正则表达式的答案中冒泡。我认为 using`re`是比`str.rstrip`.

```
>>> import re 
```

如果要删除一个或多个*尾随*换行符：

```
>>> re.sub(r'[\n\r]+$', '', '\nx\r\n')
'\nx' 
```

如果您想在任何地方删除换行符（不仅仅是尾随）：

```
>>> re.sub(r'[\n\r]+', '', '\nx\r\n')
'x' 
```

如果您只想删除 1-2 个尾随换行符（即, `\r`, `\n`, `\r\n`, `\n\r`, `\r\r`）`\n\n`

```
>>> re.sub(r'[\n\r]{1,2}$', '', '\nx\r\n\r\n')
'\nx\r'
>>> re.sub(r'[\n\r]{1,2}$', '', '\nx\r\n\r')
'\nx\r'
>>> re.sub(r'[\n\r]{1,2}$', '', '\nx\r\n')
'\nx' 
```

我有一种感觉，大多数人在这里真正想要的是，只删除*一次*出现的尾随换行符，或者`\r\n`仅此`\n`而已。

```
>>> re.sub(r'(?:\r\n|\n)$', '', '\nx\n\n', count=1)
'\nx\n'
>>> re.sub(r'(?:\r\n|\n)$', '', '\nx\r\n\r\n', count=1)
'\nx\r\n'
>>> re.sub(r'(?:\r\n|\n)$', '', '\nx\r\n', count=1)
'\nx'
>>> re.sub(r'(?:\r\n|\n)$', '', '\nx\n', count=1)
'\nx' 
```

（这`?:`是创建一个非捕获组。）

（顺便说一句，这*不是*什么`'...'.rstrip('\n', '').rstrip('\r', '')`，其他偶然发现此线程的人可能不清楚。 `str.rstrip`尽可能多地去除尾随字符，因此像这样的字符串`foo\n\n\n`会导致误报，`foo`而您可能希望保留剥离单个尾随换行符后的其他换行符。）

* * *

## 回答 #19

> 赞同：8
> 
> 时间：2011-11-30T14:04:19.880

特殊情况的解决方案：

如果换行符是最后一个字符（就像大多数文件输入的情况一样），那么对于集合中的任何元素，您可以按如下方式进行索引：

```
foobar= foobar[:-1] 
```

切出你的换行符。

* * *

## 回答 #20

> 赞同：7
> 
> 时间：2019-10-22T07:43:27.193

```
s = '''Hello  World \t\n\r\tHi There'''
# import the module string   
import string
# use the method translate to convert 
s.translate({ord(c): None for c in string.whitespace}
>>'HelloWorldHiThere' 
```

使用正则表达式

```
s = '''  Hello  World 
\t\n\r\tHi '''
print(re.sub(r"\s+", "", s), sep='')  # \s matches all white spaces
>HelloWorldHi 
```

替换\n,\t,\r

```
s.replace('\n', '').replace('\t','').replace('\r','')
>'  Hello  World Hi ' 
```

使用正则表达式

```
s = '''Hello  World \t\n\r\tHi There'''
regex = re.compile(r'[\n\r\t]')
regex.sub("", s)
>'Hello  World Hi There' 
```

加入

```
s = '''Hello  World \t\n\r\tHi There'''
' '.join(s.split())
>'Hello  World Hi There' 
```

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2017-04-26T17:58:16.047

看起来 perl 的[chomp](http://perldoc.perl.org/functions/chomp.html)没有完美的模拟。特别是，[rstrip](https://docs.python.org/3/library/stdtypes.html#str.rstrip)无法处理多字符换行符，如`\r\n`. 但是，[splitlines](https://docs.python.org/3/library/stdtypes.html#str.splitlines)确实[如此处指出的那样](https://stackoverflow.com/a/275659/3780389)。按照[我](https://stackoverflow.com/a/43641128/3780389)对另一个问题的回答，您可以结合[join](https://docs.python.org/3/library/stdtypes.html#str.join)和[splitlines](https://docs.python.org/3/library/stdtypes.html#str.splitlines)来删除/替换字符串中的所有换行符`s`：

```
''.join(s.splitlines()) 
```

以下内容*恰好删除了一个**尾随***换行符（我相信 chomp 会这样）。`True`作为参数传递`keepends`给分割线保留分隔符。然后，再次调用 splitlines 以删除最后“行”上的分隔符：

```
def chomp(s):
    if len(s):
        lines = s.splitlines(True)
        last = lines.pop()
        return ''.join(lines + last.splitlines())
    else:
        return '' 
```

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2016-11-22T18:30:37.740

```
>>> '   spacious   '.rstrip()
'   spacious'
>>> "AABAA".rstrip("A")
  'AAB'
>>> "ABBA".rstrip("AB") # both AB and BA are stripped
   ''
>>> "ABCABBA".rstrip("AB")
   'ABC' 
```

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2016-05-20T12:29:21.160

只需使用：

```
line = line.rstrip("\n") 
```

或者

```
line = line.strip("\n") 
```

你不需要任何这些复杂的东西

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2016-11-22T20:17:58.357

我们通常会遇到三种类型的行尾`\n`：`\r`和`\r\n`。中的一个相当简单的正则表达式[`re.sub`](https://docs.python.org/2/library/re.html#re.sub)，即`r"\r?\n?$"`，能够捕获它们。

（我们*必须抓住他们*，对吗？）

```
import re

re.sub(r"\r?\n?$", "", the_text, 1) 
```

对于最后一个参数，我们将替换的出现次数限制为一个，在某种程度上模仿 chomp。例子：

```
import re

text_1 = "hellothere\n\n\n"
text_2 = "hellothere\n\n\r"
text_3 = "hellothere\n\n\r\n"

a = re.sub(r"\r?\n?$", "", text_1, 1)
b = re.sub(r"\r?\n?$", "", text_2, 1)
c = re.sub(r"\r?\n?$", "", text_3, 1) 
```

...在`a == b == c`哪里`True`。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-10-28T13:56:42.960

如果您关心速度（假设您有一个冗长的字符串列表）并且您知道换行符的性质，那么字符串切片实际上比 rstrip 更快。一个小测试来说明这一点：

```
import time

loops = 50000000

def method1(loops=loops):
    test_string = 'num\n'
    t0 = time.time()
    for num in xrange(loops):
        out_sting = test_string[:-1]
    t1 = time.time()
    print('Method 1: ' + str(t1 - t0))

def method2(loops=loops):
    test_string = 'num\n'
    t0 = time.time()
    for num in xrange(loops):
        out_sting = test_string.rstrip()
    t1 = time.time()
    print('Method 2: ' + str(t1 - t0))

method1()
method2() 
```

输出：

```
Method 1: 3.92700004578
Method 2: 6.73000001907 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2018-06-15T07:24:21.817

* * *

这适用于 Windows 和 linux（如果您只寻找 re 解决方案，re sub 有点贵）

```
import re 
if re.search("(\\r|)\\n$", line):
    line = re.sub("(\\r|)\\n$", "", line) 
```

* * *

* * *

## 回答 #27

> 赞同：-3
> 
> 时间：2014-10-24T18:34:12.660

包罗万象：

```
line = line.rstrip('\r|\n') 
```

# caching - 使用 Memcached 和 Squid，是否需要 ASP.NET 缓存？

> ID：275022
> 
> 赞同：0
> 
> 时间：2008-11-08T18:28:52.043
> 
> 标签：caching

使用 squid，我们可以缓存网页。我不确定它是否提供与 ASP.NET 缓存相同数量的缓存方法（我主要使用 ASP.NET），但它是一种缓存网页的工具。

然后我们有了memcached，它可以缓存数据库表。我相信这是正确的，它就像 SqlCacheDependency （如果我错了，请纠正我）。

但是，在大型 Web 应用程序中是否存在使用 memcached、squid 和 ASP.NET（或 PHP、JSP - 应用程序框架级别）缓存的空间。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T15:44:14.383

> *然后我们有了memcached，它可以缓存数据库表。我相信这是正确的，它就像 SqlCacheDependency （如果我错了，请纠正我）。*

Memcached 是一个分布式哈希表。内置 .NET 缓存的主要优点是您的缓存是可扩展的（您可以根据需要添加任意数量的 memcached boxen）和同步（您的所有 Web 服务器都可以访问相同的内容，并从一个 Web 使数据无效或更新服务器立即传播到所有这些）

性能方面，它比 .NET 缓存更差（您正在跨服务器查找对象，而不是在一台机器上进行内存查找）

> *但是，在大型 Web 应用程序中是否存在使用 memcached、squid 和 ASP.NET（或 PHP、JSP - 应用程序框架级别）缓存的空间。*

由于上述原因，我可以想象一个 2 级缓存，首先使用 .NET 缓存，然后是 memcached。（例如，Get() 查看 memcached，将结果存储在 .NET 缓存中设置为在 10 秒后过期，然后在接下来的 10 秒内使用 .NET 缓存进行所有具有相同缓存键的 get 调用，冲洗，重复)

这样，您可以获得内存缓存查找的性能，而无需纯 memcached 解决方案的网络 IO 成本，同时具有 memcached 的同步和可扩展性优势。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T18:32:30.337

您可能会发现缓存整个页面的粒度太粗，缓存数据库表并不能为您带来足够的提升，因此非常需要缓存大块的东西。

例如，假设您有一个应用程序，该应用程序在每个页面上都显示了登录用户的名称。缓存整个页面不会真正起作用，因此您需要下拉一个级别并缓存在应用程序框架内的某个位置。

# objective-c - 现代 Objective C 运行时中 ivar 合成的底层机制是什么

> ID：275034
> 
> 赞同：21
> 
> 时间：2008-11-08T18:45:42.963
> 
> 标签：objective-c, objective-c-runtime

现代（64 位 OS X 和 iPhone OS）Objective C 运行时的特性之一是属性能够动态合成 ivars 而无需在类中显式声明它们：

```
@interface MyClass : NSObject {
//  NSString *name; unnecessary on modern runtimes
}

@property (retain) NSStrng *name;

@end

@implementation MyClass

@synthesize name;

@end 
```

在相当多的代码中，我使用自定义 getter 实现来初始化属性：

```
- (NSString *) name {
  if (!name) {
    name = @"Louis";
  }

  return name;
} 
```

上面的内容与合成的 ivar 不兼容，因为它需要访问一个未在标头中声明的 ivar。由于各种原因，我想更新我的一些个人框架以在现代运行时使用合成 ivars，需要修改上述代码以使用合成 ivars 以实现该目标。

虽然 Objective C 2.0 文档声明现代运行时上的合成访问器将在首次使用时合成 ivar。它没有指定使用什么低级机制来执行此操作。是否由 class_getInstanceVariable() 完成，对 class_addIvar() 的限制是否松动，是否是目标 C 2.0 运行时中的未记录函数？虽然我可以为支持我的属性的数据实现自己的侧存储，但我更愿意使用合成访问器正在使用的机制。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-08T20:17:31.217

刚才我又去看了文档，我觉得你看错了。合成的 ivars 是在编译时创建的，而不是在运行时创建的。

根据[Objective-C 2.0 文档](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/chapter_5_section_3.html)：

> 取决于运行时的行为存在差异（另请参见“运行时差异”）：
> 
> 对于旧版运行时，实例变量必须已经在 @interface 块中声明。如果存在与属性具有相同名称和兼容类型的实例变量，则使用它，否则会出现编译器错误。
> 
> 对于现代运行时，实例变量是根据需要合成的。如果同名的实例变量已经存在，则使用它。

所以你需要做的就是声明你需要的实例变量，相同的代码将在两个运行时工作......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-28T13:51:50.457

您正在寻找的是@synthesized 名称，例如：

```
@synthesize name = _name;

...

- (NSString *) name {
    if (!name) {
        _name = @"Louis";
    }

    return _name;
} 
```

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2011-04-04T18:49:44.243

您可以在运行时使用[NSKeyValueCoding 协议](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Protocols/NSKeyValueCoding_Protocol/Reference/Reference.html)添加属性。

```
[myObject setValue:@"whatever" forKey:@"foo"]; 
```

# .net - 在生产服务器上安装 VS.NET 是否安全且可接受？

> ID：275037
> 
> 赞同：9
> 
> 时间：2008-11-08T18:50:35.340
> 
> 标签：.net, visual-studio-2008, visual-studio-2005, webserver

通常，我们会在生产服务器上安装 VS.NET，以便在必要时轻松解决产品问题。

这是个好主意还是坏主意？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-08T18:56:02.443

调试和开发应该在“安全”的环境中进行——这不是关键任务。例如，您应该有一个用于开发和调试的开发和/或 QA 服务器。

**编辑：** 您的 QA 服务器应该镜像您的生产服务器，以便您能够在与您的生产环境类似（如果不相同）的环境中进行调试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-08T19:32:18.173

这实际上取决于您是否接受安装带来的风险：

*   当有人将调试器附加到错误的应用程序时，生产应用程序挂起。
*   它打破了被认为是*最佳实践的做法*，那么你接下来要打破什么做法呢？在最坏的情况下，人们将开始在生产环境中执行开发任务
*   获得支持的潜在问题，如果在安装了 VS 的生产环境中支持 IIS 和 SQL Server 等，我会与 Microsoft 核实。

您还应该问自己，在没有 VS 的情况下在服务器上调试问题最困难的是什么：

*   您是否熟悉[堆栈跟踪以及如何阅读它们](http://www.0xcafefeed.com/2004/06/of-thread-dumps-and-stack-traces/)？
*   您知道如何运行应用程序的调试模式版本与发布/免费版本吗？
*   您是否知道可以通过[Windows 调试工具将](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)[SOS 调试器扩展](http://msdn.microsoft.com/en-us/library/bb190764.aspx)用于 .NET 应用程序？
*   您是否考虑过使用工具自动收集和报告服务器崩溃？
*   您正在采取什么措施来防止生产中出现问题。你能做一些静态分析，根据问题重新设计模块，或者使用像测试驱动开发这样的技术吗？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-08T19:36:20.363

这绝对不能接受。首先，对于调试，您始终可以使用 windows/windbg 的调试工具。也支持 .NET 调试（SOS / 罢工之子），并且使用备忘单并不难。Windbg 无需安装即可从 U 盘运行。

其次，也是最主要原因：每当您安装任何较新版本的 VS 时，它都会将其调试器注册为交互模式** - 当发生异常时，您会收到一个消息框。您需要手动编辑注册表以在安装后恢复为默认行为 - 没有人记得这一点。

不要这样做。有更好的方法来诊断问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-08T19:05:43.797

推荐的方法是有一个生产服务器的镜像用于测试/调试目的。要使镜像保持最新，您需要同时在两台服务器上安装所有应用程序更新，并在每晚或按需在镜像上备份/恢复生产数据库。

仍然存在一些缺点，例如仅在重负载下才会发生的错误。在这种情况下，您需要某种日志记录来跟踪错误。此外，您可能需要购买额外的第三方组件许可证才能安装在生产镜像上。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-08T19:22:13.543

我不认为这是一个好主意。您的代码应该有足够的日志记录，以便如果生产中出现问题，您可以查看日志并确定发生了什么并在开发环境中修复它，然后在推送到生产之前在暂存/uat 环境中对其进行测试。

在我工作的地方，不允许开发人员访问任何由服务器/网络团队处理的生产环境，但那是因为它是一项大型业务。对于较小的公司，开发人员可以访问，但这并不意味着您应该将其用于调试。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-08T18:55:10.587

两个都。好处之一是它有时可以使诊断问题更容易。缺点之一是有时安装可能会破坏正在运行的 Web 应用程序。如果我不得不这样做，我只会这样做。

编辑：当同事决定在生产服务器上调试实时进程，在断点处停止应用程序，然后在没有意识到他已使应用程序不可用的情况下上床睡觉时，会发生另一个潜在的缺点。是的，这发生在我身上。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-08T19:07:17.053

我永远不会直接在需要 Visual Studio 的生产服务器上做任何事情。对生产进行更改而不使其回到代码库并因此进入版本控制的风险太大。最终，您最终会重新引入一个您认为已经解决的错误，因为您只在生产服务器上更改了它。偶尔我会更新生产服务器上的标记或 XML 文件，但只有在开发中进行了更改并在 QA 机器上进行了测试之后，并且只有在不涉及实际代码的情况下。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-08T19:15:34.820

当然，这取决于产品和您正在调试的内容。一般来说，您应该尽量避免它，但在某些情况下，您无法在测试服务器上完全复制场景，将调试器附加到正在运行的进程以快速缩小问题范围可能很有用。即，如果您正在运行 MMORPG 服务器，并且在某些负载条件下会出现间歇性错误，您可以花费数周或数月时间尝试从测试服务器上的日志文件和/或模拟连接中找出它，或者您可以附加在生产服务器上实时发生问题时使用调试器，并在一小时内解决。

不过，我倾向于将此视为一个例外情况，并尽可能合理地从生产服务器上进行调试。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-08T19:31:44.727

[在他的博客](http://blogs.microsoft.co.il/blogs/sasha/)上查看 Sasha Goldshtein 的[生产调试](http://blogs.microsoft.co.il/blogs/sasha/archive/2008/04/07/next-generation-production-debugging-slides-code-and-demo-transcripts-demo-1.aspx)系列。他有一些很棒的演练和截屏视频，介绍了在没有 Visual Studio 的情况下可以进行哪些调试。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-08T19:02:39.543

取决于你如何使用它。它设计的大部分繁重的工作在生产服务器上都是不必要的。我通常在生产服务器上安装 Notepad++ 来编辑 xml、配置文件等。我会说如果你想安装 VS，那就去吧。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-12T23:23:39.793

通常认为在生产服务器上安装 Visual Studio 不是“最佳实践”。这可能会带来安全风险——但我会担心的一个大问题是性能。Visual Studio 使用大量资源，在那里运行调试会显着影响生产应用程序的性能。

# perl - 如何在 Perl 中将这些字符串转换为哈希？

> ID：275038
> 
> 赞同：3
> 
> 时间：2008-11-08T18:52:18.707
> 
> 标签：perl, string, parsing, hash

我希望将具有多个分隔符的单个字符串转换为 key=>value 哈希结构。有没有一种简单的方法可以做到这一点？我目前的实现是：

```
sub readConfigFile() {
    my %CONFIG;
    my $index = 0;
    open(CON_FILE, "config");
    my @lines = <CON_FILE>;
    close(CON_FILE);

    my @array = split(/>/, $lines[0]);
    my $total = @array;

    while($index < $total) {
        my @arr = split(/=/, $array[$index]); 
        chomp($arr[1]);
        $CONFIG{$arr[0]} = $arr[1];       
        $index = $index + 1; 
    }

    while ( ($k,$v) = each %CONFIG ) {
        print "$k => $v\n";
    }

    return;
} 
```

其中“配置”包含：

```
pub=3>rec=0>size=3>adv=1234 123 4.5 6.00
pub=1>rec=1>size=2>adv=111 22 3456 .76 
```

最后的数字也需要删除，并保存在一个单独的 key=>value 对中，其名称可以是 'ip'。（如果不使代码过于冗长和复杂，我无法做到这一点）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-08T20:14:22.283

您的配置数据结构应该是什么样的？到目前为止，解决方案只记录最后一行，因为它们每次添加记录时都会踩到相同的哈希键。

这可能会让你更接近，但你仍然需要弄清楚数据结构应该是什么。

*   我将文件句柄作为参数传入，因此我的子例程与获取数据的特定方式无关。在这种情况下，它可以来自文件、字符串、套接字，甚至是**DATA**下方的内容。

*   我没有在解析字符串后进行修复，而是在解析字符串之前修复了字符串以具有“ip”元素。一旦我这样做了，“ip”元素就不是特例了，它只是一个双重分割的问题。这是一项非常重要的技术，可以节省大量工作和代码。

*   我在子例程中创建了一个哈希引用，并在完成后返回该哈希引用。我不需要全局变量。:)

```
使用警告；
使用严格；

使用 Data::Dumper；

读取配置文件（\*DATA）；

子读取配置文件
    {
    我的（$fh）= 班次；

    我的 $hash = {};

    而( <$fh> )
        {
        咀嚼；

        s/\s+(\d*\.\d+)$/>ip=$1/;

        $哈希->{ $. } = { 地图 { 拆分 /=/ } 拆分 />/ };
        }

    返回$哈希；
    }

我的 $hash = readConfigFile(\*DATA);

打印自卸车（$hash）；

__数据__
pub=3>rec=0>size=3>adv=1234 123 4.5 6.00
pub=1>rec=1>size=2>adv=111 22 3456 .76

```

这为您提供了一个数据结构，其中每一行都是单独的记录。我选择记录的行号 ( `$.`) 作为顶级键，但你可以使用任何你喜欢的东西。

```
$VAR1 = {
          '1' => {
                   'ip' => '6.00',
                   'rec' => '0',
                   'adv' => '1234 123 4.5',
                   '酒吧' => '3',
                   '大小' => '3'
                 },
          '2' => {
                   'ip' => '.76',
                   'rec' => '1',
                   'adv' => '111 22 3456',
                   '酒吧' => '1',
                   '大小' => '2'
                 }
        };

```

如果这不是您想要的结构，请向我们展示您最终想要的结构，我们可以调整我们的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T20:21:28.340

我假设您要阅读和解析超过 1 行。因此，我选择将值存储在 AoH 中。

```
#!/usr/bin/perl
使用严格；
使用警告；

我的@config；

而（<数据>）{
    咀嚼；
    推@config，{拆分/[=>]/}；
}

对于我的 $href (@config) {
    而（我的（$k，$v）=每个%$href）{
        打印 "$k => $v\n";
    }
}

__数据__
pub=3>rec=0>size=3>adv=1234 123 4.5 6.00
pub=1>rec=1>size=2>adv=111 22 3456 .76

```

这导致下面的打印输出。（上面的 while 循环从 DATA 中读取。）

```
记录 => 0
进阶 => 1234 123 4.5 6.00
酒吧 => 3
大小 => 3
记录 => 1
进阶 => 111 22 3456 .76
酒吧 => 1
大小 => 2
```

克里斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T20:36:21.070

配置文件格式是次优的，容我们说。也就是说，有更容易解析和理解的格式。[*补充*：但格式已经由另一个程序定义。Perl 足够灵活来处理这个问题。]

当没有真正需要时，您的代码会删除文件。

您的代码只关注文件中的最后一行数据（正如 Chris Charley 在我输入时所指出的那样）。

您也不允许使用注释行或空白行 - 在任何配置文件中都是一个好主意，并且它们很容易支持。[*补充*：再次，使用预定义的格式，这几乎没有关系，但是当您设计自己的文件时，请记住它。]

这是将您的函数改编为更惯用的 Perl 的方法。

```
#!/bin/perl -w
use strict;
use constant debug => 0;

sub readConfigFile()
{
    my %CONFIG;
    open(CON_FILE, "config") or die "failed to open file ($!)\n";

    while (my $line = <CON_FILE>)
    {
        chomp $line;
        $line =~ s/#.*//;           # Remove comments
        next if $line =~ /^\s*$/;   # Ignore blank lines

        foreach my $field (split(/>/, $line))
        {
            my @arr = split(/=/, $field);
            $CONFIG{$arr[0]} = $arr[1];
            print ":: $arr[0] => $arr[1]\n" if debug;
        }
    }
    close(CON_FILE);

    while (my($k,$v) = each %CONFIG)
    {
        print "$k => $v\n";
    }
    return %CONFIG;
}

readConfigFile;    # Ignores returned hash 
```

现在，您需要更清楚地解释最后一个字段的结构是什么，以及为什么您有一个没有 key=value 表示法的“ip”字段。一致性使每个人的生活更轻松。您还需要考虑应该如何处理多行。我会探索使用更正统的符号，例如：

```
pub=3;rec=0;size=3;adv=(1234,123,4.5);ip=6.00 
```

冒号或分号作为分隔符是相当传统的；列表中以逗号分隔的项目周围的括号并不是一个离谱的约定。一致性是最重要的。爱默生说：“愚蠢的一致性是小头脑的妖精，受到小政治家、哲学家和神学家的崇拜”，但计算机科学中的一致性对每个人都有很大的好处。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-10T12:03:34.037

下面假设分隔符保证为 >，并且不可能出现在数据中。

我只是根据'>'分割每一行。最后一个值将包含一个 key=value 对，然后是一个空格，然后是 IP，因此将其拆分为 // 仅一次（限制 2），您将获得 k=v 和 IP。将 IP 保存到散列中并将 k=v 对保留在数组中，然后遍历数组并在 '=' 上拆分 k=v。

填写 hashref 并将其推送到更高范围的数组。完成后，这将包含您的 hashrefs。

（已将配置加载到数组中）

```
my @hashes;

for my $line (@config) {
    my $hash; # config line will end up here

    my @pairs = split />/, $line;

    # Do the ip first. Split the last element of @pairs and put the second half into the
    # hash, overwriting the element with the first half at the same time.
    # This means we don't have to do anything special with the for loop below.
    ($pairs[-1], $hash->{ip}) = (split / /, $pairs[-1], 2);

    for (@pairs) {
        my ($k, $v) = split /=/;
        $hash->{$k} = $v;
    }

    push @hashes, $hash;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T19:23:11.840

这是一种方法。

```
foreach (@lines) {
  咀嚼；
  我的%配置；
  # 先提取最后一个数字，并用结尾替换
  # 对分隔符。
  s/\s*([\d\.]+)\s*$/>/;
  $CONFIG{ip} = $1;
  而 ( /([^=]*)=([^>]*)>/g ) {
    $CONFIG{$1} = $2;
  }
  打印自卸车（\%CONFIG）；
}

```

# javascript - 如何从...链接提交？

> ID：275039
> 
> 赞同：59
> 
> 时间：2008-11-08T18:54:03.273
> 
> 标签：javascript, html, form-submit, url-link

我得到了一张图片，其中使用`<a href="..."> <img ...> </a>`.

我怎样才能让它像一个按钮一样发布`<input type="submit"...>`？

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2011-11-03T15:26:11.460

**[使用JQuery](http://jquery.com/)**库[最接近](http://api.jquery.com/closest/)（）和[提交](http://api.jquery.com/submit/)（）按钮的更通用的方法。在这里，您不必指定要提交的表单，提交它所在的表单。

```
<a href="#" onclick="$(this).closest('form').submit()">Submit Link</a> 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-11-08T19:01:29.030

```
<input type="image" name="your_image_name" src="your_image_url.png" /> 
```

这将在提交表单时发送`your_image_name.x`和`your_image_name.y`值，它们是用户单击图像位置的 x 和 y 坐标。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-11-08T18:59:52.013

看起来您正在尝试使用图像来提交表单......在这种情况下使用 `<input type="image" src="...">`

如果您真的想使用锚点，那么您必须使用 javascript：

`<a href="#" onclick="document.forms['myFormName'].submit(); return false;">...</a>`

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-08T18:59:29.033

[input type=image](http://webdesign.about.com/od/htmltags/p/bltags_inputimg.htm)将为您完成。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-08T18:59:47.363

未经测试/可能会更好：

```
<form action="page-you're-submitting-to.html" method="POST">
    <a href="#" onclick="document.forms[0].submit();return false;"><img src="whatever.jpg" /></a>
</form> 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2010-04-07T14:38:36.900

```
 <html>

 <?php

 echo $_POST['c']." | ".$_POST['d']." | ".$_POST['e'];

 ?>

 <form action="test.php" method="POST">
      <input type="hidden" name="c" value="toto98">
      <input type="hidden" name="d" value="toto97">
      <input type="hidden" name="e" value="toto aaaaaaaaaaaaaaaaaaaa">

      <a href="" onclick="document.forms[0].submit();return false;">Click</a> 
 </form>

</html>

So easy.

So easy. 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-02-26T12:02:31.353

一个方便的补充是可以从额外的按钮更改发布网址，以便您可以使用不同的按钮发布到不同的网址。这可以通过设置表单的“动作”属性来实现。这是使用 jQuery 时的代码：

```
$('#[href button name]').click(function(e) {
    e.preventDefault();
    $('#[form name]').attr('action', 'alternateurl.php');
    $('#[form name]').submit();
}); 
```

action-attribute 与旧 jQuery 版本存在一些问题，但在最新版本中你会很高兴。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-08T19:02:06.033

[像这个页面](http://www.bsohq.fr/static/development/css_submit.html?value=)的东西？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>BSO Communication</title>

<style type="text/css">
.submit {
    border : 0;
    background : url(ok.gif) left top no-repeat;
    height : 24px;
    width : 24px;
    cursor : pointer;
    text-indent : -9999px;
}
html:first-child .submit {
    padding-left : 1000px;
}
</style>
<!--[if IE]>
<style type="text/css">
.submit {
    text-indent : 0;
    color : expression(this.value = '');
}
</style>
<![endif]-->
</head>

<body>
    <h1>Display input submit as image with CSS</h1>

    <p>Take a look at <a href="/2007/07/26/afficher-un-input-submit-comme-une-image/">the related article</a> (in french).</p>
    <form action="" method="get">
        <fieldset>
            <legend>Some form</legend>
            <p class="field">
                <label for="input">Some value</label>

                <input type="text" id="input" name="value" />
                <input type="submit" class="submit" />
            </p>
        </fieldset>
    </form>

    <hr />
    <p>This page is part of the <a href="http://www.bsohq.fr">BSO Communication blog</a>.</p>

</body>
</html> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-10T12:49:00.200

不要忘记“按钮”元素，它可以在里面处理更多的 HTML ......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-18T22:15:46.020

我们一直在表单上用这个替换提交按钮：

```
<form method="post" action="whatever.asp">
<input type=...n

<input type="image" name="Submit" src="/graphics/continue.gif" align="middle" border="0" alt="Continue">
</form> 
```

单击图像提交表单。希望有帮助！

# vim - 几个vim问题

> ID：275062
> 
> 赞同：4
> 
> 时间：2008-11-08T19:09:05.847
> 
> 标签：vim, ctags

所以我希望一些老派的 Vim'ers 可以帮助我。这些都是单独的问题，通常我会单独提出它们，但我不确定这是否有资格作为问题嫖娼。

另外，我认为，如果您足够了解这些问题，那么它们都会在不久的将来出现：

1.  我有一个正在编写的库和一系列使用该库的应用程序。似乎没有一种简单的方法（据我所知）为库构建一个**ctags 文件**并为我的每个应用程序构建一个并确保当我在 vim 中时一个引用另一个。
2.  使用 gf 从命令模式打开文件很棒，但是我的很多包含文件不包含完整路径。它们指的是我在 IDE 中设置的包含目录。如何将此目录设置为 Vim 开始查找文件的另一个点？
3.  有没有办法在 Vim 中编译文件并将输出发送到缓冲区？我目前正在使用 MSVS 2k3，但我将在几周后移植到 Linux，所以如果这在任一系统上都是可能的，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T19:44:24.840

重新 3)

如果您将 makefile 放在根目录中，您可以简单地编写 :make

这将运行 make 并 (iirc) 将任何错误放入单独的缓冲区，并使 vim 转到第一个编译错误。从那里您可以使用 :next-error 导航所有错误行

另外，请参阅此页面 [http://wiki.beyondunreal.com/Legacy:Vim](http://wiki.beyondunreal.com/Legacy:Vim)

和 [http://linux.byexamples.com/archives/287/perform-grep-and-make-in-vim/](http://linux.byexamples.com/archives/287/perform-grep-and-make-in-vim/)

有关如何在单独的控制台中显示结果的详细信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-08T20:40:37.863

1-标签文件是独立的，可以一起使用。看`:h 'tags'`

我不知道构建标签文件的简单方法是什么。我有一个包括使用我的两个插件：

*   一个知道如何更新 C++ 标签文件的[（草稿）插件](http://code.google.com/p/lh-vim/source/browse#svn/tags/trunk)（它应该很容易适应其他文件类型），
*   还有另一个 ( [local_vimrc](http://code.google.com/p/lh-vim/source/browse/misc/trunk/plugin/local_vimrc.vim) ) 可以帮助我定义目录本地 .vimrc。因此，对于给定目录层次结构中的任何文件，我可以调整 &tags 选项以使用相关的标记文件，以及将自动重建的当前标记文件（或在触发键绑定时）。（像项目这样的插件也可以解决问题）

2- `:h 'path`'

3-`:h :make`

HTH。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T19:59:48.757

2)

```
:cd {path} 
```

求助：

```
:he cd 
```

其他一些`:lcd`可能更适合。只需向下滚动该帮助页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T22:26:06.713

这是相当离题的，但可能仍然有用：如果你经常使用 Visual Studio 并且喜欢 Vim，你可能想看看[ViEmu](http://viemu.com/)。这是我见过的任何 IDE 中最好的 Vim 仿真，而且成本非常低。:) 不，我没有得到佣金。:P

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T22:57:04.203

这并不明显，但是如果您打开目录而不是文件，则可以很好地浏览它。

例如

:e。（冒号-e-dot）：e ..（冒号-e-dot-dot）

将让您从当前目录或其父目录浏览。

（了解您可能希望有能力让 vim 接受，例如

:e abc.txt

并让它在几个目录中查找，我不知道该怎么做。）

# windows - 以编程方式“将我的 Windows 桌面扩展到此显示器上”

> ID：275063
> 
> 赞同：25
> 
> 时间：2008-11-08T19:11:11.663
> 
> 标签：windows, powershell, wmi, multiple-monitors

我希望能够通过代码设置“将我的 Windows 桌面扩展到此显示器上”。PowerShell 脚本将是理想的。WMI 似乎是前进的方向，但我对 WMI 的了解为零。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2014-08-02T12:10:00.337

Windows 7、8 和 10 应该附带一个执行此操作的小程序：displayswitch.exe。 [此页面](http://jeffwouters.nl/index.php/2012/06/switch-your-display-through-the-command-line/)列出了以下参数：

```
displayswitch.exe /internal Disconnect projector (same as "Show only on 1" from the Display Properties dialog)
displayswitch.exe /clone        Duplicate screen
displayswitch.exe /extend    Extend screen
displayswitch.exe /external Projector only (disconnect local) (same as "Show only on 2" from the Display Properties dialog) 
```

要一键解决所提出的问题，只需创建一个包含单行的 *.bat 文件

```
call displayswitch.exe /extend 
```

并将其保存到您的桌面。

[我在 Windows 8.1 上对此进行了测试，并已确认可以在 Windows 10 上运行。]

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-03-17T13:57:17.853

我制作了一个不使用 sendkeys 的更简洁的版本。

```
public class DisplayHelper
{
    [DllImport("user32.dll")]
    static extern DISP_CHANGE ChangeDisplaySettings(uint lpDevMode, uint dwflags);
    [DllImport("user32.dll")]
    static extern bool EnumDisplayDevices(string lpDevice, uint iDevNum, ref DISPLAY_DEVICE lpDisplayDevice, uint dwFlags);

    enum DISP_CHANGE : int
    {
        Successful = 0,
        Restart = 1,
        Failed = -1,
        BadMode = -2,
        NotUpdated = -3,
        BadFlags = -4,
        BadParam = -5,
        BadDualView = -1
    }

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
    struct DISPLAY_DEVICE
    {
        [MarshalAs(UnmanagedType.U4)]
        public int cb;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)]
        public string DeviceName;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 128)]
        public string DeviceString;
        [MarshalAs(UnmanagedType.U4)]
        public DisplayDeviceStateFlags StateFlags;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 128)]
        public string DeviceID;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 128)]
        public string DeviceKey;
    }

    [Flags()]
    enum DisplayDeviceStateFlags : int
    {
        /// <summary>The device is part of the desktop.</summary>
        AttachedToDesktop = 0x1,
        MultiDriver = 0x2,
        /// <summary>The device is part of the desktop.</summary>
        PrimaryDevice = 0x4,
        /// <summary>Represents a pseudo device used to mirror application drawing for remoting or other purposes.</summary>
        MirroringDriver = 0x8,
        /// <summary>The device is VGA compatible.</summary>
        VGACompatible = 0x16,
        /// <summary>The device is removable; it cannot be the primary display.</summary>
        Removable = 0x20,
        /// <summary>The device has more display modes than its output devices support.</summary>
        ModesPruned = 0x8000000,
        Remote = 0x4000000,
        Disconnect = 0x2000000
    }

    public static void EnableSecondaryDisplay()
    {
        var secondaryIndex = 1;
        var secondary = GetDisplayDevice(secondaryIndex);
        var id = secondary.DeviceKey.Split('\\')[7];

        using (var key = Registry.CurrentConfig.OpenSubKey(string.Format(@"System\CurrentControlSet\Control\VIDEO\{0}", id), true))
        {
            using (var subkey = key.CreateSubKey("000" + secondaryIndex))
            {
                subkey.SetValue("Attach.ToDesktop", 1, RegistryValueKind.DWord);
                subkey.SetValue("Attach.RelativeX", 1024, RegistryValueKind.DWord);
                subkey.SetValue("DefaultSettings.XResolution", 1024, RegistryValueKind.DWord);
                subkey.SetValue("DefaultSettings.YResolution", 768, RegistryValueKind.DWord);
                subkey.SetValue("DefaultSettings.BitsPerPel", 32, RegistryValueKind.DWord);
            }
        }

        ChangeDisplaySettings(0, 0);
    }

    private static DISPLAY_DEVICE GetDisplayDevice(int id)
    {
        var d = new DISPLAY_DEVICE();
        d.cb = Marshal.SizeOf(d);
        if (!EnumDisplayDevices(null, (uint)id, ref d, 0))
            throw new NotSupportedException("Could not find a monitor with id " + id);
        return d;
    }
} 
```

我只在新安装的计算机上对此进行了测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-09T04:22:53.140

此类操作无法从 PowerShell 直接访问，因为这些设置没有 .NET 接口。很多核心操作系统的东西都是非托管代码，只能通过 win32 API 调用来操作。虽然您可能对 WMI 有所了解，但我搜索了一段时间并没有找到一个令人满意的 WMI 类，它能够操纵此设置。

下一步是直接修改注册表。看起来该设置位于 HKLM:\system\CurrentControlSet\control\video--某处。我相信它是一个名为“Attach.ToDesktop”的。

这是部分解决方案，因此我将其标记为社区 wiki 答案。

我不确定这是正确的注册表项，而且我目前没有可以测试多显示器的系统。这样做的目的是确定哪个是主控制器，然后输出 Attach.ToDesktop 键的值。

```
param ( 
    $ControllerName = "$( throw 'ControllerName is a mandatory parameter' )"
)
$regPath = "HKLM:\system\CurrentControlSet\control\video"
$devDescStr = "Device Description"

Set-Location -path $regPath
$regSubKey = Get-ChildItem -recurse -include 0000
$devDescProperty = $regSubKey | Get-ItemProperty -name $devDescStr -erroraction SilentlyContinue 
$priDescProperty = $devDescProperty | Where-Object { $_.$devDescStr -match $ControllerName }
Set-Location -path $priDescProperty.PSPath
Get-ItemProperty -path . -name "Attach.ToDesktop" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-08T20:11:15.270

第一个可能的解决方案是……通过 GUI（但没有用户交互）

[VB 脚本](https://web.archive.org/web/1/http://techrepublic%2ecom%2ecom/5208-6230-0.html?forumID=101&threadID=220003&messageID=2219887)（[此处也有描述，](http://robbieallen.com/2006/08/extending-desktop-via-script/)但使用[Autoit](http://www.autoitscript.com/autoit3/)语言）：

```
Option Explicit
Dim WshShell, Dummy, Splash

On Error Resume Next

Set WshShell = WScript.CreateObject("WScript.Shell")

'Main
Call DoIt
WScript.Quit

Sub DoIt
wshshell.Run("%systemroot%\system32\control.exe desk.cpl,@0,3")

' Give Display Properties time to load
WScript.Sleep 1000
WshShell.SendKeys "2"
WScript.Sleep 10
WshShell.SendKeys "%E"
WScript.Sleep 500
WshShell.SendKeys "%A"
WshShell.SendKeys "{TAB}"
WshShell.SendKeys "{TAB}"
WshShell.SendKeys "{TAB}"
WshShell.SendKeys "{TAB}"
WshShell.SendKeys "{TAB}"
WshShell.SendKeys "{TAB}"
WshShell.SendKeys "{TAB}"
WshShell.SendKeys "{TAB}"
WshShell.SendKeys "{TAB}"
WshShell.SendKeys "{TAB}"
WshShell.SendKeys "{ENTER}"
End Sub 'DoIt 
```

在 Autoit 中，这将是：

```
;
; — toggle-screen.au3
;

; exec cpanel app `display settings`
Run(”C:\WINDOWS\system32\control.exe desk.cpl,@0,3?”)

; wait for window to be active
WinWaitActive(”Display Settings”)

; select 2nd display
Send(”{TAB}”)
Send(”{DOWN}”)

; work back to the ‘extend desktop’ control
Send(”+{TAB}”)
Send(”+{TAB}”)
Send(”+{TAB}”)
Send(”+{TAB}”)
Send(”+{TAB}”)
Send(”+{TAB}”)
Send(”+{TAB}”)
Send(”+{TAB}”)
Send(”+{TAB}”)

; toggle ‘extend desktop’ control and apply
Send(”{SPACE}”)
Send(”{ENTER}”)

; wait for window to be active
WinWaitActive(”Display Settings”)

; accept
Send(”{TAB}”)
Send(”{ENTER}”)

;
; — E.O.F.
; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-04-18T18:33:55.067

自动热键中的 2 行

第二次显示：

```
RunWait C:\Windows\System32\DisplaySwitch.exe /extend 
```

第二次显示关闭：

```
RunWait C:\Windows\System32\DisplaySwitch.exe /internal 
```

-

```
#NoEnv  ; Recommended for performance and compatibility with future AutoHotkey releases.
; #Warn  ; Enable warnings to assist with detecting common errors.
SendMode Input  ; Recommended for new scripts due to its superior speed and reliability.
#Persistent 

Any1stKeyUWantToTurnOn::RunWait C:\Windows\System32\DisplaySwitch.exe /extend
Any2stKeyUWantToTurnOff::RunWait C:\Windows\System32\DisplaySwitch.exe /internal 
```

或者

[您可以在github / BNK3R-Boy / DisplaySwitch](https://github.com/BNK3R-Boy/DisplaySwitch)上查看并试用我的工具。我马上发表了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-14T00:01:30.563

这是我用于切换显示器的 AutoIt-Script，因为我的 ATI 显卡不允许我同时激活 3 个显示器。我有 2 台显示器和一台电视机。这个脚本正在做 VonC 的脚本所做的事情，但是以一种更有效和更快的方式。

```
Run("C:\WINDOWS\system32\control.exe desk.cpl", "C:\Windows\system32\")
WinWait("Screen Resolution")
ControlCommand("Screen Resolution", "", "ComboBox1", "SetCurrentSelection", "SAMSUNG")

if (ControlCommand("Screen Resolution", "", "ComboBox3", "GetCurrentSelection", "") = "Disconnect this display") Then
    ControlCommand("Screen Resolution", "", "ComboBox1", "SetCurrentSelection", "2")
    ControlCommand("Screen Resolution", "", "ComboBox3", "SetCurrentSelection", "3")
    ControlCommand("Screen Resolution", "", "ComboBox1", "SetCurrentSelection", "0")
    ControlCommand("Screen Resolution", "", "ComboBox3", "SetCurrentSelection", "1")
    ControlClick("Screen Resolution", "", "Button4")
    WinWait("Display Settings")
    ControlClick("Display Settings", "", "Button1")
Else
    ControlCommand("Screen Resolution", "", "ComboBox3", "SetCurrentSelection", "3")
    ControlCommand("Screen Resolution", "", "ComboBox1", "SetCurrentSelection", "2")
    ControlCommand("Screen Resolution", "", "ComboBox3", "SetCurrentSelection", "1")
    ControlClick("Screen Resolution", "", "Button4")
    WinWait("Display Settings")
    ControlClick("Display Settings", "", "Button1")
EndIf 
```

只需将“SAMSUNG”替换为您的第三台显示器/电视名称即可！您肯定知道，即使没有安装 AutoIt，您也可以将其转换为可在任何机器上运行的可执行文件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-09-08T02:34:56.403

这是 C# 中的另一个解决方案（通过[如何在 C# 中为 Windows-7 设置主监视器](https://stackoverflow.com/questions/16326932/how-to-set-primary-monitor-for-windows-7-in-c-sharp)）：

```
[Flags]
public enum SetDisplayConfigFlags : uint
{
    SDC_TOPOLOGY_INTERNAL = 0x00000001,
    SDC_TOPOLOGY_CLONE = 0x00000002,
    SDC_TOPOLOGY_EXTEND = 0x00000004,
    SDC_TOPOLOGY_EXTERNAL = 0x00000008,
    SDC_APPLY = 0x00000080
}

[DllImport("user32.dll", CharSet = CharSet.Unicode)]
private static extern long SetDisplayConfig(uint numPathArrayElements,
    IntPtr pathArray, uint numModeArrayElements, IntPtr modeArray, SetDisplayConfigFlags flags);

static void CloneDisplays() {
    SetDisplayConfig(0, IntPtr.Zero, 0, IntPtr.Zero, SetDisplayConfigFlags.SDC_TOPOLOGY_CLONE | SetDisplayConfigFlags.SDC_APPLY);
}

static void ExtendDisplays() {
    SetDisplayConfig(0, IntPtr.Zero, 0, IntPtr.Zero, SetDisplayConfigFlags.SDC_TOPOLOGY_EXTEND | SetDisplayConfigFlags.SDC_APPLY);
}

static void ExternalDisplay() {
    SetDisplayConfig(0, IntPtr.Zero, 0, IntPtr.Zero, SetDisplayConfigFlags.SDC_TOPOLOGY_EXTERNAL | SetDisplayConfigFlags.SDC_APPLY);
}

static void InternalDisplay() {
    SetDisplayConfig(0, IntPtr.Zero, 0, IntPtr.Zero, SetDisplayConfigFlags.SDC_TOPOLOGY_INTERNAL | SetDisplayConfigFlags.SDC_APPLY);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T07:04:39.487

我必须做一些小的修改才能让 VonC 的脚本在我的机器上运行。现在它更通用了。

```
;
; — toggle-screen2.au3
;

#include <WinAPI.au3>
; exec cpanel app `display settings`
Run(_WinAPI_ExpandEnvironmentStrings("%windir%") & "\system32\control.exe desk.cpl,@0,3?")

; wait for window to be active
WinWaitActive("Display Properties")

; select 2nd display
Send("!d")
Send("{DOWN}")

; toggle the ‘extend desktop’ checkbox
Send("!e")

; close the dialog
Send("{ENTER}") 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-25T15:37:10.610

windows键+P键会做同样的事情

# java - Java - 设置上下文属性 (ServletContextListener)

> ID：275064
> 
> 赞同：0
> 
> 时间：2008-11-08T19:11:18.153
> 
> 标签：java

我在 web 应用程序启动阶段 (contextInitialized()) 阅读了一个属性文件，并开始考虑如何使这些设置对 servlet “可见”。我是否需要遍历键并将每个键添加到上下文中，就像这样

```
Iterator i = settings.keySet().iterator();
while (i.hasNext()) {
    key = (String) i.next();
    value = (String) settings.get(key);
    context.setAttribute(key, value);
} 
```

还是有更好的方法？

谢谢！

/亚当

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-09T21:27:44.897

为什么不将全部内容存储在您的 servlet 上下文中？

```
context.setAttribute("mySettings", settings); 
```

setAttribute 的签名是：

```
public void setAttribute(String name, Object object) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T18:12:09.970

我一直在玩弄一个想法：

在上下文初始化方法中，我计划只为设置创建一个全局对象。很像提出的工具包。但是，不是为每个键/属性/设置设置上下文属性，而是添加设置容器/包装器对象是一个糟糕的主意吗？我认为这个类将负责保存（静态？）模块设置类。这样我就可以得到这样的类型引用

```
//ExampleServlet.java
Settings settings = (Settings)context.getAttribute("application.settings");

String color = settings.getModule1().getColor();
String font = settings.getModule1().getFont();

int blogs = settings.getModule2().getActiveBlogCount(); 
```

在整个代码中，我只需要记住**一个**属性键，即整个设置容器的键。减少可能导致 rumtime 异常的拼写错误的风险！它还将使重命名属性变得容易。

你怎么看？

/亚当

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T19:12:09.430

您是否考虑过在 web.xml 中定义设置的可能性？

此外，如果这不可能，请尽可能使用泛型：

```
String key = null;
Iterator<String> i = settings.keySet().iterator();
while (i.hasNext())
 context.setAttribute(key = i.next(), settings.get(key)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T22:29:32.447

这是我已经考虑过的，将整个属性对象设置为上下文属性。

如果我不走这条路，是否有任何关于如何命名这些属性的指南，或者你觉得“application.settings”还是“myBlog.settings”？**你**如何对键进行分组？这样可以吗：

```
application.module1.color=black
application.module1.font=arial 
```

在某种程度上，我觉得维护这样一个属性键分布在整个代码中的应用程序可能会成为一种负担？如果另一个开发人员重命名属性文件中的属性，我们只会在*运行*应用程序时知道（如果/何时/什么引用了旧键）。正确的？

我将不得不查找JNDI。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T21:51:50.933

使用 JNDI 上下文怎么样。JNDI 是一种更常见的将属性传递给 webapp 的方法。

可以在 META-INF/context.xml 中为 tomcat 或任何应用程序特定设置指定任何属性。

# javascript - Web 评级功能的轮子改造避免

> ID：275070
> 
> 赞同：1
> 
> 时间：2008-11-08T19:17:17.250
> 
> 标签：javascript, html

我需要实现评级功能，并希望以类似于 netflix 的鼠标悬停星星方式进行。

我最好的方法是什么？这里有一些我想到的。

*   用 HTML 和 javascript 手动编写代码
*   使用 flash 或 java 小程序
*   使用[Starbox](http://www.nickstakenburg.com/projects/starbox/)（如果您使用过 Starbox，请随时发表评论）
*   使用另一个 java 脚本库（请指定）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T20:09:49.097

我真的很喜欢[jQuery Star Rating Plugin](http://www.fyneworks.com/jquery/star-rating/)，不突兀，即使禁用 JavaScript 也能工作，它基于一组单选输入框，并且非常易于使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T20:08:43.620

Starbox 是一种易于使用的方法，无需重新发明轮子。

我在使用 HTML/js 之前已经完成了它，但它不是很容易并且变得混乱。

Flash 和 Java 小程序太过分了，不值得付出努力（我已经很多年没有使用过任何“真正的”Java 小程序了）。

# c# - 在多台 PC 上并行化我的 C# 程序的最简单方法是什么

> ID：275072
> 
> 赞同：6
> 
> 时间：2008-11-08T19:18:51.070
> 
> 标签：c#, .net, concurrency, parallel-processing, cloud

我家里有很多不用的电脑。什么是我利用它们来并行化我的 C# 程序而几乎没有代码更改的最简单方法？

我正在尝试做的任务涉及遍历大量英语句子，数据集可以很容易地分成更小的块，在不同的机器上同时处理。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-08T19:23:05.600

> ... 很少或没有代码更改？

难的。基本上，将 WCF 视为通过网络在程序的各种实例之间进行通信的一种方式。根据算法，结构可能必须彻底改变，或者根本不改变。在任何情况下，您都必须找到一种方法将问题分成彼此独立的部分。然后，您必须设计一种在不同实例之间分配这些部分并收集结果数据的方法。

[PLinq](http://msdn.microsoft.com/en-us/magazine/cc163329.aspx)提供了一种无需大更改即可并行化程序的好方法，但这仅适用于跨不同线程的一个进程，并且仅适用于算法适合并行化的情况。一般来说，一些手动重构*是*必要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T19:21:15.183

那可能是不可能的。

如何并行化一个程序完全取决于你的程序做什么以及它是如何编写的，并且通常需要大量的代码更改并增加你的程序的许多倍的复杂性。

在程序中轻松提高并发性的常用方法是执行一个重复多次的任务，然后编写一个函数，将该任务分成块并将它们发送到不同的核心进行处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T19:28:47.803

答案取决于您的应用程序将要执行的工作的性质。不同类型的工作有不同的可能并行化解决方案。对于某些类型，没有可能/可行的并行化方式。

我能想到的最简单的场景是一个应用程序，它的工作很容易被分解成离散的工作块。如果是这种情况，那么您只需将应用程序设计为在单个作业块上工作。使您的应用程序能够接受新工作并交付已完成的工作。然后，在其之上构建一个作业调度程序。此调度程序可以是同一应用程序的一部分（将一台机器配置为调度程序，其余机器作为客户端），也可以是一个单独的应用程序。

还有其他需要考虑的事情：机器之间的通信（文件？网络连接？）将如何发生；应用程序需要能够报告/被查询完成的工作百分比？是否需要能够强制应用程序停止处理当前作业？ETC。）。

如果您需要更详细的答案，请编辑您的问题并包括有关应用程序的详细信息、应用程序解决的问题、预期的工作数量等。然后，社区将提供更具体的答案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T14:17:08.103

[Dryad](http://research.microsoft.com/research/sv/dryad/)（Microsoft 的 MapReduce 变体）正好解决了这个问题（在多台 PC 上并行化 .net 程序）。目前处于研究阶段。太糟糕了，还没有 CTP :-(

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-08T19:28:11.130

您需要在分布式系统上运行您的应用程序，google 用于分布式计算窗口或网格计算 c#。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-08T19:48:37.890

每个句子是独立处理的，还是以某种方式组合在一起？如果您的处理一次只处理一个句子，则根本不需要更改代码。只需在您的每台机器上执行相同的代码，然后在它们之间划分数据（您的句子列表）。您可以通过在每台机器上安装一部分数据，或者通过共享数据库并为每台机器分配不同的块来实现这一点。

如果您*想*稍微更改代码以促进并行性，请共享整个数据库并在处理每个句子时让代码“标记”，然后寻找下一个未标记的句子进行处理。这将为您简要介绍[线程安全](http://en.wikipedia.org/wiki/Thread_safety)的概念——确保一个处理器不会对另一个处理器产生不利影响的技术。

与往常一样，您可以提供的有关特定应用程序的详细信息越多，SO 社区就越能根据您的目的定制我们的答案。

祝你好运——这听起来像是一个有趣的项目！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-10T21:06:16.200

有几种软件解决方案允许您使用基于商品的硬件。一是[Appistry](http://www.appistry.com)。我在 Appistry 工作，我们已经完成了许多解决方案来在数百台机器上运行 C# 应用程序。

一些有用的链接： http: [//www.appistry.com/resource-library/index.html](http://www.appistry.com/resource-library/index.html)

您可以在这里免费下载该产品：http: [//www.appistry.com/developers/](http://www.appistry.com/developers/)

希望这会有所帮助-布雷特

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-22T13:29:36.927

您可能想查看[基于流的编程](http://www.jpaulmorrison.com/fbp/)- 它具有 Java 和 C# 实现。解决这个问题的大多数方法都涉及尝试采用传统的单线程程序并找出哪些部分可以并行运行。FBP 采用了不同的方法：应用程序从一开始就设计为多个异步运行的“黑盒”组件（想想制造装配线）。由于传统的单线程程序就像 FBP 环境中的单个组件一样，因此很容易扩展现有的应用程序。事实上，现有应用程序的各个部分通常可以拆分并变成单独的组件，只要它们可以与应用程序的其余部分异步运行（即不是子例程）。有人称之为“把冰山变成冰块”）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-08T20:51:21.210

在我投资并行化您的程序之前，为什么不尝试将数据集分解为多个部分并在每台计算机上手动运行您的程序并手动整理输出。如果可行，请尝试使用脚本将其自动化并编写程序来整理输出。

# c# - 为什么C#多维数组不实现IEnumerable ?

> ID：275073
> 
> 赞同：75
> 
> 时间：2008-11-08T19:20:44.123
> 
> 标签：c#, .net, arrays, multidimensional-array

我刚刚注意到 C# 中的多维数组没有实现`IEnumerable<T>`，但它确实实现了`IEnumerable`。对于一维数组，两者`IEnumerable<T>`都`IEnumerable`实现了。

为什么会有这种差异？如果多维数组是`IEnumerable`，那么它肯定也应该实现泛型版本吗？我注意到这一点是因为我尝试在多维数组上使用扩展方法，除非您使用`Cast<T>`或类似方法，否则该方法会失败；所以我绝对可以看到实现多维数组的论据`IEnumerable<T>`。

为了在代码中澄清我的问题，我希望以下代码打印`true`四次，而它实际上打印`true`, `false`, `true`, `true`：

```
int[] singleDimensionArray = new int[10];
int[,] multiDimensional = new int[10, 10];

Debug.WriteLine(singleDimensionArray is IEnumerable<int>);
Debug.WriteLine(multiDimensional is IEnumerable<int>);
Debug.WriteLine(singleDimensionArray is IEnumerable);
Debug.WriteLine(multiDimensional is IEnumerable); 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-11-08T20:14:33.437

CLR 有两种不同类型的数组：保证为一维且下限为 0 的*向量*，以及更一般的数组，其可以具有非零边界和非 0 的秩。

从 CLI 规范的第 8.9.1 节：

> 此外，创建的元素类型为 T 的向量实现了接口 `System.Collections.Generic.IList<U>` （第 8.7 节），其中 U := T。

我不得不说这对我来说似乎很奇怪。鉴于它已经实现了，`IEnumerable`我不明白为什么它不应该实现`IEnumerable<T>`. 实现它没有多大意义`IList<T>`，但简单的通用接口就可以了。

如果需要，您可以调用`Cast<T>`（如果您使用的是 .NET 3.5）或编写自己的方法来遍历数组。为了避免强制转换，您必须编写自己的方法来找到每个维度的下限/上限，并以这种方式获取内容。不是很愉快。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-07-25T21:45:42.277

有一个解决方法：您可以将任何多维数组转换为 IEnumerable

```
public static class ArrayExtensions
{
    public static IEnumerable<T> ToEnumerable<T>(this Array target)
    {
        foreach (var item in target)
            yield return (T)item;
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-10-29T06:02:58.260

零界一维数组同时实现`IEnumerable`和`IEnumerable<T>`，但不幸的是，多维数组只实现`IEnumerable`。@Jader Dias 的“解决方法”确实将多维数组转换为`IEnumerable<T>`但代价高昂：数组的每个元素都将被装箱。

这是一个不会导致每个元素装箱的版本：

```
public static class ArrayExtensions
{
    public static IEnumerable<T> ToEnumerable<T>(this T[,] target)
    {
        foreach (var item in target)
            yield return item;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T19:58:45.450

锯齿数组也不支持`IEnumerable<int>`，因为多维结构并不是真正的类型数组，它们是类型数组的数组：

```
int[] singleDimensionArray = new int[10];
int[][] multiJagged = new int[10][];

Debug.WriteLine(singleDimensionArray is IEnumerable<int>);
Debug.WriteLine(multiJagged is IEnumerable<int[]>);
Debug.WriteLine(singleDimensionArray is IEnumerable);
Debug.WriteLine(multiJagged is IEnumerable); 
```

打印真实，真实，真实，真实。

**注意**：`int[,]`不是`IEnumerable<int[]>`，这是由于另一个答案中指定的原因，即没有通用的方法可以知道要迭代哪个维度。对于交错数组，没有太多解释空间，因为语法很清楚它是一个数组数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-05T18:41:47.777

反过来想。二维数组已经存在。列举一下就行了。创建一个二维数组，其中包含初始数组或标记的分数和位置，包括重复值。

```
int[] secondmarks = {20, 15, 31, 34, 35, 50, 40, 90, 99, 100, 20};

IEnumerable<int> finallist = secondmarks.OrderByDescending(c => c);

int[,] orderedMarks = new int[2, finallist.Count()];

Enumerable.Range(0, finallist.Count()).ToList().ForEach(k => {orderedMarks[0, k] = (int) finallist.Skip(k).Take(1).Average();
orderedMarks[1, k] = k + 1;}); 

Enumerable.Range(0, finallist.Count()).Select(m => new {Score = orderedMarks[0, m], Place = orderedMarks[1, m]}).Dump(); 
```

结果：

```
Score Place

100     1
99      2 
90      3 
50      4 
40      5 
35      6    
34      7    
31      8    
20      9     
20     10 
15     11 
```

# objective-c - 如何在视频游戏风格的 Cocoa 应用程序中收集按键输入？

> ID：275088
> 
> 赞同：11
> 
> 时间：2008-11-08T19:34:11.537
> 
> 标签：objective-c, cocoa, macos

我正在开发一个简单的 Cocoa 应用程序，让块像视频游戏一样在屏幕上移动。我需要检测按键，但我不会像对话框那样有文本输入字段。

如何在没有文本控件的情况下获得按键？特别是，我需要箭头键。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-08T20:04:03.723

在您的游戏视图中，定义 keyUp 和 keyDown 方法：

```
@interface MyView : NSView
-(void)keyUp:(NSEvent*)event;
-(void)keyDown:(NSEvent*)event;
@end

@implementation MyView

-(void)keyUp:(NSEvent*)event
{
    NSLog(@"Key released: %@", event);
}

-(void)keyDown:(NSEvent*)event
{   
    // I added these based on the addition to your question :)
    switch( [event keyCode] ) {
        case 126:   // up arrow
        case 125:   // down arrow
        case 124:   // right arrow
        case 123:   // left arrow
            NSLog(@"Arrow key pressed!");
            break;
        default:
            NSLog(@"Key pressed: %@", event);
            break;
    }
}
@end 
```

有关更多信息，请参阅[NSView](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSView_Class/Reference/NSView.html)和[NSEvent](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSEvent_Class/Reference/Reference.html)的文档。请注意，keyDown 和 keyUp 事件实际上是在NSView 的超类[NSResponder上定义的。](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSResponder_Class/Reference/Reference.html)

# session - 访问特定会话的会话变量的值

> ID：275090
> 
> 赞同：0
> 
> 时间：2008-11-08T19:37:07.273
> 
> 标签：session, asp-classic

我正在尝试将公共留言板服务集成到现有网站中。

应用程序之间的握手是这样的：

1) 我网站上的文件加载了一个 flash 文件。Flash 读取一个局部变量，即会话 ID 或用户会话唯一的一些其他 GUID。

2) Flash 应用程序连接远程服务，将 SessionID 传递给服务。

3) 服务向原始网站发出 GET 请求，要求提供有关用户的其他信息。

4) 发起网站（我的网站）验证会话 ID 是否用于有效会话，如果是，则传回其他请求的信息。

我希望能够使用内在的 ASP SessionID，但我不确定如何在经典 ASP 中检索**特定**ASP 会话的会话变量，即我想要 Session("FirstName") 的值，其中 SessionID=1234而不是 Session("FirstName") 用于任何其他会话 ID。我找不到任何可以让我这样做的语法。

另一种方法是为每个会话创建一个新的 GUID，但这会增加很多开销。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T10:29:07.033

我不知道有任何方法可以检索特定实例或 ID 的会话详细信息。但是，您可以利用 Application 对象使用 Session.SessionID 值来存储您需要的信息：

Application(Session.SessionID & tag) = myTagValue

这样您就不会创建新的 GUID，而是利用已经存在的 GUID 进行会话，客户端和服务器都在您的示例中使用。

# javascript - windows.location.href 在 Firefox3 上不起作用

> ID：275092
> 
> 赞同：20
> 
> 时间：2008-11-08T19:39:21.323
> 
> 标签：javascript, firefox

我们有一个名为“move”的 JavaScript 函数，它只执行“windows.location.href = *any given anchor* ”。
此功能适用于 IE、Opera 和 Safari，但不知何故在 Firefox 中被忽略。在 Google 上进行研究并没有给出令人满意的答案**，为什么**它不起作用。
是否有任何 JavaScript 大师知道这种行为，通过 JavaScript 跳转到锚点的最佳实践是什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-11-08T19:54:37.550

您是否尝试过仅使用

```
window.location = 'url'; 
```

在某些浏览器中，`window.location.href`它是一个只读属性，并不是设置位置的最佳方式（尽管从技术上讲，它应该允许您这样做）。如果您单独使用该`location`属性，则应在所有浏览器中为您重定向。

Mozilla 的文档对如何使用该`window.location`对象进行了非常详细的解释。

[https://developer.mozilla.org/en/DOM/window.location](https://developer.mozilla.org/en/DOM/window.location)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-08-26T13:50:52.430

如果您尝试在事件之后调用此 javascript 代码，然后是回调，那么您必须在函数中添加另一行：

```
function JSNavSomewhere()
{
    window.location.href = myUrl;
    return false;
} 
```

在您的页面标记中，单击时调用此函数的控件必须返回此函数的值

```
<asp:button ........ onclick="return JSNavSomewhere();" /> 
```

false 返回值将取消回调，重定向现在将起作用。为什么这在 IE 中有效？好吧，我猜当他们将重定向优先于回调时，他们在这个问题上的想法不同。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-20T12:26:47.240

在这种情况下要确保的一项观察

以下将适用于`IE`，但既不适用`Chrome`也不`Firefox`适用（我测试的版本）

```
 window.location.href("http://stackoverflow.com"); 
```

以下将适用于所有三个

```
window.location.href = "http://stackoverflow.com"; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-08T23:17:31.883

也许这只是您帖子中的错字而不是您的代码，但它是**window**而不是**window *s***

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-08T19:57:42.020

我不确定是否会跟随你。
我刚刚尝试过：使用 FF3 到[Lua 5.1 参考手册](http://www.lua.org/manual/5.1/manual.html "Lua 5.1 参考手册")（很长并且有很多锚点）。
粘贴`javascript:window.location.href="#2.5"; alert(window.location.href);`在地址栏中，我转到了正确的锚点，它显示了正确的 URL。当然，也适用于完整的 URL。
替代代码：`javascript:(function () { window.location.href="#2.5"; })();`

也许你忘记了#。常见问题，也与图像映射有关。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-28T11:09:08.873

我有同样的问题，我想这与**点击事件**有关。

我有一个将浏览器移动到特定页面的功能。我将该功能附加到一些点击事件中：在按钮和图像中。此外，我在用户按下转义键时执行该功能（文档 onkeypress 事件）。

结果是，在所有情况下，该函数都被调用并执行，但只有在单击时浏览器才会转到我想要的地址。

**更新** 我让它工作了！与

```
setTimeout( "location.replace('whatever.html');", 0 ); 
```

我不知道为什么当事件是按键时 location.replace 不起作用，但是使用 settimeout 它可以工作:)

**更新** 在按下转义后返回 false 会使重定向起作用。如果您返回 true 或什么都不返回，浏览器将不会跟随

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-03-23T03:41:52.897

你必须添加**return false;** 在上面提到的 window.location.href 之后。

```
function thisWorks()
{
    window.location.href = "http://www.google.com";
    return false;
}

function thisDoesNotWork()
{
    window.location.href = "http://www.google.com";
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-08T20:56:53.197

window.location.href 在所有版本的 Firefox 中都可以正常工作，document.location.href 也是如此，我认为您的代码中还有其他东西在破坏。

将其放在空白页面中，如果有效，则表明您的页面上还有其他问题。

```
<script>
  window.location.href = 'http://www.google.com/';
</script> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-08-16T04:15:24.653

有时，如果您使用***表单***发布数据，则可能会发生这种情况。如果您使用的是 ajax，请尝试将 'form' 更改为 'div'。这将阻止表单的默认行为并执行您的 ajax 代码。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-08T20:02:40.343

您还可以使用`window.location.replace`跳转到锚点而不在浏览器历史记录中注册它：

本文[说明](http://bytes.com/forum/thread587235.html)了如何跳转到锚点并使用 href 作为只读属性。

```
function navigateNext() 
{
    if (!window.location.hash) 
    {
        window.location.replace(window.location.href + unescape("#2"))
    } 
    else 
    {
        newItem = nextItem(window.location.hash)
        if (document.getElementById(newItem)) 
        {
            window.location.replace(stripHash(window.location) + "#" + newItem)
        } 
        else 
        {
            window.location.replace(stripHash(window.location) + "#1")
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-08T22:39:39.870

你试过这个吗？

```
Response.Write("<script type='text/javaScript'> window.location = '#myAnchor'; </script>";); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-23T21:47:45.373

```
window.location.hash = "#gallery"; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-02-10T12:34:18.493

请添加完整的 javascript 脚本标签

```
<script type="text/javascript" language="javascript"></script>
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-07-29T20:51:25.640

作为参考，我遇到了同样的问题。

onclick = "javascript: window.location('example.html');" 在FF下不起作用（最新）

我只需要重写为 onclick = "javascript: window.location = 'example.html';" 让它工作

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-10-09T06:30:18.677

我刚刚克服了同样的问题。问题不在于javascript，而在于`<a>`元素的 href 属性。

我的js代码

```
function sebelum_hapus()
{
var setuju = confirm ("Anda akan menghapus data...")
if (setuju)
window.location = "index.php";
} 
```

我以前的 html 是

```
<a href="" onClick="sebelum_hapus();">Klik here</a> 
```

我将其更新为

```
<a href="#" onClick="sebelum_hapus();">Klik here</a> 
```

或删除 href 属性

希望这可以帮助。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-11-30T06:59:02.370

window.location.assign("link to next page") 应该适用于（chrome 和 firefox）浏览器。

```
window.location.assign("link to next page")
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2008-11-28T15:57:30.713

另外一个选项：

```
document.location.href ="..." 
```

# graphics - 为 Mono 销售商业软件

> ID：275094
> 
> 赞同：3
> 
> 时间：2008-11-08T19:42:49.460
> 
> 标签：graphics, mono

如果 Mono 项目成功，它将为非 Windows 平台上的商业软件铺平道路。

我对按照我们现有的 Smoke Vector Graphics (OCaml) 和 F# for Visualization (.NET) 产品为 Mono 平台编写和销售商业软件的前景感兴趣。是否有任何商业库开发人员已经在 Mono 上构建，如果是，他们是否从中获利？

此外，用微软的 F# 语言编写软件是否可行，或者 Mono 在 ILX 上会遇到问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T21:51:01.687

正如许多公司已经证明的那样，Mono 是运行商业软件的完美平台。其中一些你可以[在这里](http://www.mono-project.com/Companies_Using_Mono)看到，但有很多你永远不会听说过，因为它们在嵌入式环境中运行 Mono（Sandisk Salsa mp3 播放器）。根据最新消息，Electronic Arts 将在 Sims3 中使用 Mono。辩论如何？

Mono 的要点之一是最大程度地减少从 Windows 转向 Linux 的开发人员的工作量。在大多数情况下，无需额外的努力就可以使您在 Windows 上拥有的相同软件在 Mono 中运行在 Linux、MacOS 和其他平台上。

只是为了澄清一些其他人方便地回答您的问题而忘记的事情。大多数 Mono（最近甚至是编译器）都在 MIT/X11 许可下获得许可，这使您几乎可以在您认为合适的条件下部署它。没有一些人似乎如此害怕的 GPL“癌症”。

就个人而言，我一直在 Mono 中使用 F# 和 Gtk#，我喜欢这种体验。更多关于它[的信息](http://www.piotrzurek.net/category/f/)。这是可能的，因为 F# 团队已确保 F# 可以在 Mono 上运行，并且他们在其发行版中提供了一个简单的 Linux 安装程序。这也应该是一个信号，表明 Mono 被视为 .Net 的重要替代品，即使是微软。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-13T07:28:49.377

Mono 项目[在这里](http://www.mono-project.com/Companies_Using_Mono)列出了许多成功的商业项目，我要特别指出[Unity](http://unity3d.com/)是其中最著名的项目之一。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T15:41:13.540

我的数据与之相反，我们在 10 年前开发了启德并获得了 4 次左右的购买。我们在 Windows 上至少多了几百次。Linux 上的工具状态只能称为糟糕。同意你在那里有很棒的东西，但如果你使用 GPLd 软件，你会淹没在他们的许可证中。确实存在一个调试器和一个 C 编译器，它是 gdb 和 gcc，尽管英特尔做出了努力，并且如果您使用一些不太知名的语言，您将一无所获。曾经尝试过 ProjectCenter（Objective C 开发环境）吗？，调试器主要是 clis，您必须键入 info reg 才能获取有关寄存器的信息。DDD 的工作非常有趣，它是一种工具，当滚动没有正确时，你向上滚动你必须向下滚动鼠标滚轮。滚动它也慢得令人难以置信'

好吧，我可以争论 IBM AIX 上更悲惨的状态。您必须向 IBM 支付的费用超出了任何理由......

所以也许你比我们幸运。但我大多厌倦了在 Linux 上通过“应用程序”开发来赚钱。我能说的最好的一点是，Linux 可以很好地建立网络基础设施，在那里你可以获得不错的付款，但是使用编程工具，算了。

问候

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T20:56:47.957

Linux 人是出了名的节俭，所以我会考虑投资回报率。

你真的想把你的资源花在一个市场采用率低于 10% 的群体上，而在这 10% 中，只有 1% 的人会对你的产品感兴趣，而且只有 %0.01% 的人会为它买单吗？

# python - /urlchecker/http://www.google.com 的正则表达式是什么

> ID：275109
> 
> 赞同：1
> 
> 时间：2008-11-08T20:01:02.793
> 
> 标签：python, regex, django

我正在 django 中编写一个 url 重写，当一个人访问[http://mysite.com/urlchecker/http://www.google.com](http://mysite.com/urlchecker/http://www.google.com) 时，它会将 url: [http://ww.google.com](http://ww.google.com)发送到视为字符串变量。

我试着做：

```
(r'^urlchecker/(?P<url>\w+)/$', 'mysite.main.views.urlchecker'), 
```

但这没有用。有人知道我在做什么错吗？

另外，通常是否有专门为 python/django 学习正则表达式的好资源？

多谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T20:06:29.787

试试这个：

`(r'^urlchecker/(?P<url>.+)$', 'mysite.main.views.urlchecker'),`

这与您的不同之处在于：

*   它会在 'urlcheck/' 之后使用任何内容，而不仅仅是“单词”字符。
*   它不会强制 url 以斜杠结尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T22:07:07.767

我刚刚在研究 Python 线程的隐藏特性时学到了一些东西。 [Python 的重新编译器有调试模式](https://stackoverflow.com/questions/101268/hidden-features-of-python#143636)！（谁知道？好吧，显然有人这样做了:-) 无论如何，值得一读。

# java - Java：给定类名，我如何知道使用哪个 jar 文件？

> ID：275120
> 
> 赞同：23
> 
> 时间：2008-11-08T20:09:40.313
> 
> 标签：java, eclipse, jar

给定一个类，例如[org.eclipse.ui.views.navigator.ResourceNavigator](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/views/navigator/ResourceNavigator.html)，我如何找出要使用的 jar 文件？我知道它在 org.eclipse.ui.ide 中，但我怎么才能找到它呢？

**编辑**：感谢所有回答的人。像许多事情一样，似乎有几种方法可以给这只猫剥皮。我希望 javadoc 包含此信息。到目前为止，这里有不同的方法：

1.  没有 Internet、Eclipse 或 NetBeans：

    ```
    for f in `find . -name '*.jar'`;  do echo $f && jar tvf $f | grep -i $1; done 
    ```

2.  如果您想使用 Eclipse 在本地查找：

    *   [JAR 类查找器插件](http://www.alphaworks.ibm.com/tech/jarclassfinder)
    *   [类定位器插件](http://classlocator.sourceforge.net/)
3.  如果您想从网上查找或者您还没有jar：

    *   [罐子查找器](http://www.jarfinder.com/)
    *   [findjar.com](http://findjar.com/)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-08T20:19:30.260

如果您的类路径/项目路径中有 jar，请按 CTRL-SHIFT-T 并输入名称... jar 将显示在底部。

如果您的构建路径中没有该类 a) 将一个包含所有 jar 的虚拟项目放在一起 b) 我认为有一个插件可以从 IBM Alphaworks 中找到 jar（但这可能有点过时了）

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-08T20:22:19.523

你也有这个 Eclipse 插件：[jarclassfinder](http://www.alphaworks.ibm.com/tech/jarclassfinder)

用户输入未找到的类的名称（或 Java 项目需要访问的类的名称）。该插件将在选定目录（和子目录）中搜索包含该类的 JAR 文件。

所有结果都显示在自定义视图的表格中。然后，用户可以浏览此表并选择 JAR 文件以添加到他的 Java 项目的构建路径中。然后，用户右键单击表中的条目，并从上下文菜单中选择要将其添加到的构建路径。

* * *

[2013 年更新，正如我在“搜索 .jar 文件 eclipse](https://stackoverflow.com/a/1086435/6309) ”中提到的，它不再维护，替代品也很少。

正如[下面](https://stackoverflow.com/questions/275120/java-how-do-i-know-which-jar-file-to-use-given-a-class-name/275141#comment36479092_275141)[的 sunleo](https://stackoverflow.com/users/1755242/sunleo)评论：

**对于 Eclipse，`Ctfl`++`Shift``T`**仍然是查找类型**的最简单替代方法**
（在状态栏中显示 jar 名称）**。**

* * *

[user862268](https://stackoverflow.com/users/862268/user862268)评论[如下](https://stackoverflow.com/questions/275120/java-how-do-i-know-which-jar-file-to-use-given-a-class-name/275141#comment60625860_275141)：

> 对于mac，在Eclipse中查找类和关联jar就是`cmd`++ 。`shift``T`

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-12-20T07:51:24.120

在 Eclipse IDE 中使用 Ctrl+Shift+T

打开类型对话框出现在您输入类名的地方。在显示包标识符和 jar 目标之后。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-08T20:24:08.770

要回答这个问题，没有真正的方法可以知道使用哪个 jar。不同的版本可能会有不同的行为。

在查找包含给定类的 jar 时，我使用：

```
for f in `find . -name '*.jar'`;  do echo $f && jar tvf $f | grep -i $1; done 
```

这将突出显示包含作为参数传入任何子文件夹中的类名的任何 jar。

查找课程的另一个好方法是使用[maven repos search](http://www.mvnrepository.com/)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-02-04T11:03:51.970

对我来说，这很好用：

```
find * -type f -name '*.jar' -exec grep -l 'TestClass.class' '{}' \; 
```

问候

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-08T20:19:40.557

使用这个：[netbeans插件](http://plugins.netbeans.org/PluginPortal/faces/PluginListPage.jsp?search=jarfinder)

或者[jarFinder](http://www.jarfinder.com/)服务

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-11-10T08:34:05.647

```
**shell> find . -name "*.jar" | xargs -i -t \jar tvf {} | grep [TheClassNameYouAreLookingFor]** 
```

例如，如果您正在 apache commons jar 列表中查找类 LogFactory.class，则以下命令将起作用

```
shell> find apache-commons/ -name "*.jar" | xargs -i -t \jar tvf {} | grep LogFactory.class

jar tvf apache-commons/commons-beanutils-1.7.0.jar

jar tvf apache-commons/commons-fileupload-1.2.1.jar

jar tvf apache-commons/commons-lang-2.3.jar

**jar tvf apache-commons/commons-logging-1.1.jar**

**21140 Tue May 09 23:08:12 EDT 2006 org/apache/commons/logging/LogFactory.class**

jar tvf apache-commons/commons-net-1.3.0.jar 
```

上面的结果表明匹配的是commons-logging-1.1.jar

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-08T20:14:05.013

使用类/JAR 定位器：

[http://classlocator.sourceforge.net/](http://classlocator.sourceforge.net/)

[编辑] 即使从 ClassLocator 的文档（！）中也不是很明显，但它似乎是一个 Eclipse 插件。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-08T21:40:38.273

我使用[FindJar.com](http://findjar.com/)。它列出了包含任何给定类的所有已知包！这非常有帮助。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-08T20:13:23.020

通常，我会`jar -vtf foo.jar`获取所有类文件的列表。
不是最实用的方法，但很方便。当然，您可以将结果与 grep 结合起来。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-09T13:02:23.327

在 Intellij IDEA 中，您只需 ctrl-单击类名，您将被移动到该类的伪源代码，窗口标题将类似于 c:\path\to\lib.jar!\com\something\ClassName。班级

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-10-24T20:43:00.203

如果您告诉 eclipse 打开声明 (F3) 或实现 (Navigate->Open Implementation)，然后您会弹出一个不可编辑的编辑窗口，您可以通过右键单击编辑器窗口并选择来查看 jar 文件的路径'在面包屑中显示'

我发现基于unix：

```
find . -name "*.jar" -print -exec jar -tf {} \; >outputfile 
```

编辑输出文件以找到您想要的（而不是 grep）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-08T21:29:25.423

我不确定我是否真的理解这个问题，但是如果你想验证你的类是否真的在 jar 中，你可以随时查看 jar 本身，为此你不需要任何 Eclipse 插件或专门的外用。

JAR (Java ARchive) 文件只不过是**ZIP**文件。您所要做的就是解压缩 jar，甚至使用 zip-reading 应用程序查看它。例如，在 Windows XP 下，它内置于操作系统中。多么方便。

希望这有帮助...

尤瓦尔=8-)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-10T04:22:12.547

还要检查[http://javacio.us/](http://javacio.us/)。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-05T10:05:36.553

[IntelliJ IDEA 插件（类猎人）](http://plugins.intellij.net/plugin/?id=1162)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-09-07T09:50:01.167

您还可以尝试[使用 Jarvana](http://www.jarvana.com)来查找特定类的 jar 文件。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-09-23T02:03:47.240

我投票支持 CTRL-SHIFT-T，因为它已经包含在 Eclipse 中。我实际上在 Eclipse 安装中的插件目录中删除了 jarclassfinder.jar 但仍然无法在 Eclipse GUI 中找到该插件

# c++ - C++ 中的并行赋值

> ID：275128
> 
> 赞同：6
> 
> 时间：2008-11-08T20:14:27.323
> 
> 标签：c++

有没有办法在 C++ 中进行并行赋值？目前，以下编译（带有警告）

```
#include <iostream> 

int main() { 
  int a = 4;
  int b = 5;
  a, b = b, a;
  std::cout << "a: " << a << endl
            << "b: " << b << endl;

  return 0;
} 
```

并打印：

```
a: 4
b: 5 
```

我希望它打印......如果它不明显，是：

```
a: 5
b: 4 
```

例如，ruby 或 python。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-08T20:27:43.397

那是不可能的。您的代码示例

```
a, b = b, a; 
```

解释如下：

```
a, (b = b), a 
```

它什么也不做。逗号运算符使其返回 a （最右边的操作数）的值。因为赋值绑定更紧密，所以 b = b 在括号中。

这样做的正确方法就是

```
std::swap(a, b); 
```

Boost 包括一个元组类，你可以用它来做

```
tie(a, b) = make_tuple(b, a); 
```

它在内部创建一个对 a 和 b 的引用的元组，然后为它们分配一个 b 和 a 的元组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-08T20:31:22.500

C++ 不支持并行赋值。支持这一点的语言通常将`a,b,c`其视为赋值运算符两侧的列表，这不是逗号运算符在 C++ 中的工作方式。在 C++ 中，`a, b`先计算 a，然后计算 b，因此`a, b = b, a`与`a; b = b; a;`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T20:25:14.773

或 Perl。但是不，这是不可能的（据我所知），你需要使用一个临时变量，如：

```
int a = 4;
int b = 5;

{
    int tmp = a;
    a = b;
    b = tmp;
} 
```

仅供参考，这些语言（或至少 Perl）在内部创建一个临时列表`{ a, b }`，然后将列表分配给两个变量。换句话说，这至少是高性能的，如果只是有点混乱的话。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-21T17:42:30.587

这个问题很老了——我今天才偶然发现它
……想知道为什么以前没有人给出这个答案……

我认为，可以像 Python 一样在 C++11 中做到这一点（在幕后）：

```
#include <iostream>
using namespace std;

int main()
{
  int a = 4, b = 5;
  cout << "Before assignment: a: " << a << ", b: " << b << endl;
  pair<int&, int&> ba(b, a);
  ba = make_pair(a, b); // <===: (b, a) = (a, b)
  cout << "After assignment : a: " << a << ", b: " << b << endl;
  return 0;
} 
```

我在[**ideone.com**](https://ideone.com/RXXG09)上试过了。输出是：

```
Before assignment: a: 4, b: 5
After assignment : a: 5, b: 4 
```

如果我没记错的话（我不是 Python 专家），在 Python 中，`a, b`表示一对。（[Python 文档：5.3\. 元组和序列](https://docs.python.org/2/tutorial/datastructures.html#tuples-and-sequences)）

这样的配对可以在 C++ 11 中轻松完成，例如使用[`std::pair`](http://en.cppreference.com/w/cpp/utility/pair/pair). 在这种情况下，我做了一对引用并分配了这对值。它`make_pair()`在将右对（值）分配给左对引用之前加载两个变量。

再次滚动，我意识到这个答案接近于[Johannes answer](https://stackoverflow.com/a/275149/7478597)的基于 boost 的解决方案。

可能是，原因是它在 C++03 中不起作用。我在 coliru.stacked-crooked.com 中尝试过：`-std=c++03`它会产生可怕的编译器错误——更改为`-std=c++11`它可以编译和执行，如上所述。

**免责声明**

我只是无法想象这个解决方案有什么好处，也无法想象它可能有什么实际价值。这不是我试图做的。正如许多其他答案所说“它不起作用”。恕我直言（根据 C++ 语言拼写正确）...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T20:59:40.133

或者 Lua...
C/C++ 有一些技巧，比如使用 xor 或操作，但存在溢出等风险。只需以痛苦的方式完成三个任务即可。没有大碍。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-10T14:16:12.163

标准库中没有这样的功能。您可以编写一组模板函数：

```
template <typename T1> void ParAssign(T1& Lhs_1, T1 const& Rhs1);
template <typename T1, typename T2> void ParAssign(T1& Lhs1, T2& Lhs2, T1 const& Rhs1, T2 const& Rhs2);
// etc.
ParAssign(a,b,
          b,a); 
```

如果存在混叠，就像在您的交换示例中那样，这并非易事。

# asp.net - 快门订单 API 。

> ID：275130
> 
> 赞同：4
> 
> 时间：2008-11-08T20:14:49.193
> 
> 标签：asp.net, api

我找到了这个网站

[http://www.shutterfly.com/documentation/api_OrderImage.sfly](http://www.shutterfly.com/documentation/api_OrderImage.sfly)

但是没有真正走过整个过程的例子。有没有人有任何关于使用此 API 拍摄本地照片并允许某人通过 shutterfly 订购打印的好的文档？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-09-16T13:13:00.317

我经历了这些步骤：

*   [注册新账号](https://www.shutterfly.com/signup/viewSignup.sfly)
*   [注册成为开发者](https://www.shutterfly.com/developer/apps.sfly)

创建一个应用程序（我称为我的测试）。记下生成的**Application Id**和**Shared Secret**

[Shutterfly API 页面](http://www.shutterfly.com/documentation/start.sfly)包含各种特定领域 API的参考列表：

*   [地址簿](http://www.shutterfly.com/documentation/api_AddressBook.sfly)
*   [专辑数据](http://www.shutterfly.com/documentation/api_Album.sfly)
*   [文件夹数据](http://www.shutterfly.com/documentation/api_Folder.sfly)
*   [转到Shutterfly UE](http://www.shutterfly.com/documentation/api_ImageUpload.sfly)
*   [图片上传](http://www.shutterfly.com/documentation/IsiSetup.sfly)
*   [交互式登录](http://www.shutterfly.com/documentation/api_Proctaserv.sfly)
*   [图片请求](http://www.shutterfly.com/documentation/api_Order.sfly)
*   [命令](http://www.shutterfly.com/documentation/api_Order.sfly)
*   [价钱](http://www.shutterfly.com/documentation/api_Pricing.sfly)
*   [无缝登录](http://www.shutterfly.com/documentation/SsiSetup.sfly)
*   [用户数据](http://www.shutterfly.com/documentation/api_User.sfly)
*   [用户认证](http://www.shutterfly.com/documentation/api_UserAuth.sfly)

每个都使用 RESTful 原则。该文档对我来说看起来很全面，如果您需要一些背景知识，这里是[RESTful](http://www.xfront.com/REST-Web-Services.html) API 和[ROME](http://www.xml.com/pub/a/2006/02/22/rome-parse-publish-rss-atom-feeds-java.html)的链接，您可能会觉得有用

同一页面上还有一个**API Explorer部分，允许您通过他们网站上的表单来测试这些方法。**例如这个表格用于[对专辑数据进行 CRUD 操作](https://www.shutterfly.com/documentation/api_ExplorerAlbum.sfly)。

根据您的评论，根据您的要求，您将：

*   使用[专辑 GET](http://www.shutterfly.com/documentation/api_Album.sfly#GET)列出专辑，然后获取特定专辑的数据。
*   使用[Image Get](http://www.shutterfly.com/documentation/api_Proctaserv.sfly#GET)请求检索图像数据，以便您的朋友可以验证他们想要购买的图像。
*   [验证用户](http://www.shutterfly.com/documentation/AuthAuth.sfly)
*   使用[定价 POST](http://www.shutterfly.com/documentation/api_Pricing.sfly#POST)请求获取图像的估计定价。
*   使用[Order POST](http://www.shutterfly.com/documentation/api_Order.sfly#POST)通过 https 提交订单

* * *

更新：找到一个[描述](http://quasistoic.org/ts/archives/2005/06/22/flickr-shutterfly/)使用 Greasemonkey 脚本的页面，该脚本将 Shutterfly 打印订购功能添加到 Flickr。这可能为解决方案提供基础。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-07T01:10:56.357

以供参考：

上面的原始链接是 Shutterfly Open API 订购过程的中间步骤。

整个过程经过一系列步骤，让您可以控制的不仅仅是将照片推送到 Shutterfly 中某人的相册。

通过此过程，您的应用程序实际上可以执行以下整个过程：

*   指定图像和尺寸和数量，或其他产品
*   计算运费、税金和总计
*   支付，和
*   启动处理

它还包括查看包裹何时交付和到达的能力。

因此，如果您有一个可靠的应用程序将您的图像映射到纸张和产品上，您几乎可以控制整个过程。

提交订单后，它将显示在与订单相关联的 Shutterfly 的用户帐户中。

*感谢 Shutterfly 制作了如此强大的工具！如果其他印刷设施也有类似的工具，那就太好了。*

# svn - 大文件的版本控制

> ID：275138
> 
> 赞同：13
> 
> 时间：2008-11-08T20:20:14.673
> 
> 标签：svn, version-control, asset-management

我们很乐意在工作中将 SVN 用于 SCM。目前，我将二进制资产与我们的代码放在同一个 SVN 存储库中。SVN 支持非常大的文件（它“流式地”传输它们以保持内存使用正常），但它是 SLOOWWWWW。

对于价值约 1 GB（并且还在增长）的资产，您推荐什么资产管理软件？我们更喜欢分支和合并（不同的资产和配置文件去不同的客户）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-11T21:51:27.593

请注意，合并二进制文件几乎是不可能的！至少是自动的。至少我从未听说过支持二进制格式的三路合并的程序。更别说解决冲突了。

这就是为什么大多数资产管理工具没有分支的原因，因为它没有意义，因为你不能再次合并。锁定和线性历史更好。如果您想“分支”，则制作带有历史记录的文件的副本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-03-30T13:12:34.140

在我的公司，我们使用 Documentum 作为 ECMS，管理大量（我的意思是真的很多）二进制文件。Documentum（或其他 ECMS，如 Alfresco）应该是管理文档的“正确”解决方案。Documentum 支持标记和分支，并且可以将文件公开为 WebDAV（因此与您的工作流程的集成或多或少是透明的）。

这就是理论。在实践中，我们发现 Documentum 速度慢，难以配置和管理。老实说，即使我们有很多文件，它们中的大多数也不超过几百个莫。

这个答案更多的是你不应该做的事情而不是你应该做的事情......对不起......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-19T20:27:42.470

Perforce 是我听说的唯一用于大型文件和整个项目的版本控制系统。两个座位是免费的，但对于更多用户来说相当昂贵（每个座位大约 900 美元）。我听说它可以处理高达 TB 的存储库。

git 可能是另一种选择。它的行为与 SVN 略有不同，但适用于更大的项目（例如 Linux 内核）。我不确定它是否适用于大型二进制文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-05T22:14:22.127

[Mercurial 大文件扩展名](http://mercurial.selenic.com/wiki/LargefilesExtension)可能会有所帮助。它增加了将文件标记为“大”的能力。将这些文件存储在与存储库的其余部分分开的中央存储中。使用哈希来确定您需要哪些版本的大文件，并且只下载您现在需要的版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-30T12:37:12.343

如果您需要管理 HUGE 文件，请尝试使用 Plastic SCM (www.plasticscm.com)。AFAIK Perforce 也是一种选择，但分支和合并不是那么强大。

# c# - IStorage 的复合文件实现是线程安全的吗？

> ID：275143
> 
> 赞同：4
> 
> 时间：2008-11-08T20:22:55.870
> 
> 标签：c#, com, thread-safety, istorage, compound-file

我正在使用来自 C# (StgCreateDocfile) 的 IStorage 的复合文件实现。

如果我自己同步读取和写入，从多个线程访问一个 IStorage / IStream 实例是否安全？或者这里是否有任何可能有问题的 COM 问题？

例如，我可以安全地调用 EnumElements 来获取存储中的所有流，同时（并且来自不同的线程）创建和写入一个新流吗？

我已经为我的实现编写了一个压力测试，它没有显示任何问题，但我需要 100% 确定。我在 MSDN 文档中没有找到此信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T21:08:19.367

凝灰一。ILockBytes 接口的文档中有一段关于它的片段。它说 IStorage 和 IStream 的默认实现实现了 IMarshal。如果您遵循 COM 线程规则，这将使它们成为线程安全的。当接口指针在进程内时，很容易忘记这一点。您必须使用 CoMarshalInterThreadInterfaceInStream() 或 IGlobalInterfaceTable 之类的东西。通过锁定自己，您将侥幸逃脱编组。

# svn - SVN 优化以保持大型存储库响应

> ID：275147
> 
> 赞同：3
> 
> 时间：2008-11-08T20:25:34.883
> 
> 标签：svn, version-control, asset-management

我们很乐意在工作中将 SVN 用于 SCM。目前，我将二进制资产与我们的代码放在同一个 SVN 存储库中。SVN 支持非常大的文件（它“流式地”传输它们以保持内存使用正常），但它使一切变得缓慢。我可以接受缓慢的资产版本控制，但缓慢的文本操作并不是真正可以接受的。

现在资产在 /trunk/release 下（与十几个 /trunk/projects 并排）。我们应该将它们保存在单独的存储库中吗？我们还能做哪些其他优化？我们拥有大约 1 GB 的资产并且还在不断增长。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T20:40:58.160

你没有说你已经使用了哪些优化。如果您使用的是 bsdfs，请查看切换到 fsfs 是否会提高性能。如果您有大量修订，请在服务器上切换到更新的版本，并将存储库转换为 1.5 格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T18:06:51.200

IMNSHO 最好将每个项目保留在自己的存储库中，如果只是为了保持修订号在它们之间分开。如果项目 foo 在六个月内没有更改，但项目 bar 正在积极开发中，为什么 foo 的当前修订号要不断更改。如果两者紧密耦合（就像他们共享一个公共库），则可能是一个例外，但即便如此，该库也应该是它自己的项目。

二元资产是一直在变化还是静态的？如果它们是静态的，也许您根本不希望它们在存储库中（只需在其中留下一个小占位符）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-23T16:38:48.890

您可能会得到的最佳答案是将二进制文件放入单独的目录并使用备用目录功能来管理它们——即在您需要文件之前不要签出文件。然后所有操作都将发生在源文件而不是二进制文件上。

或者，您可以使用相同的机制来提交或更新 - 而不是更新您的工作副本，您可以使用“更新到修订版”，并指定 HEAD 和减少的深度，因此二进制目录不会被更新（直到您需要到）。

您还可以“svnadmin pack”您的存储库，这将提高服务器端的性能。

# .net - 向项目添加程序集引用时遇到问题

> ID：275148
> 
> 赞同：0
> 
> 时间：2008-11-08T20:26:30.560
> 
> 标签：.net, assemblies, reference

我在添加对我构建的 .NET 程序集的引用时遇到问题。这就是我所做的。

1.  我创建了一个 .NET 程序集（testlib.dll）。
2.  我确保它有一个强名称（添加了一个密钥文件）。
3.  我为该程序集创建了一个 WiX 安装项目。
4.  我将 Assembly='.net' 和 KeyPath='yes' 添加到程序集的 File 属性中。

安装工作正常。我可以在 GAC (C:\Windows\assembly) 中看到 testlib。

我创建了一个新的 .NET 项目并尝试添加对 testlib 的引用，但在“添加引用”对话框的 .NET 选项卡中没有看到它。我怎样才能让它出现在那里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T22:11:30.723

.NET 选项卡中的程序集与 GAC 无关。为了在 .NET 选项卡中查看程序集，您的安装程序必须写入以下注册表路径：HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft.NETFramework\AssemblyFolders 该条目应创建一个新键，通常是应用程序名称，然后将默认值设置为安装程序集的路径。

例如，假设应用程序名称为 MyApp，它安装到：C:\Program Files\MyApp 注册表完整路径为 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft.NETFramework\AssemblyFolders\MyApp 默认值为：C:\Program Files \我的应用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-30T16:39:28.803

我们创建了一个工具，可以帮助您实现目标。[Muse VSReferences](http://www.youtube.com/watch?v=OonYjLWcbGY)将允许您从“添加 GAC 引用”菜单项添加对项目的全局程序集缓存引用。

问候...

s

# url - XHTML 和 & (&) 的编码

> ID：275150
> 
> 赞同：36
> 
> 时间：2008-11-08T20:27:53.490
> 
> 标签：url, urlencode, xhtml

我的网站是 XHTML Transitional 兼容**的，除了一件事**：URL 中的 &（和号）按原样编写，而不是`&amp;`

也就是说，我页面中的所有网址通常都是这样的：

```
<a href="http://www.example.org/page.aspx?x=1&y=2">Foo</a> 
```

但是[XHTML 验证器会](http://validator.w3.org/)产生这个错误：

> 无法为一般实体“y”生成系统标识符

...它希望 URL 写成这样：

```
<a href="http://www.example.org/page.aspx?x=1&amp;y=2">Foo</a> 
```

问题是 Internet Explorer 和 Firefox 不能正确处理 URL 并忽略 y 参数。**如何使此链接正常工作并正确验证？**

在我看来，如果浏览器不能使用严格编码的 XHTML URL，就不可能编写 XHTML 页面。

你想看到实际行动吗？查看这两个链接之间的区别（按原样复制并粘贴它们）：

```
http://stackoverflow.com/search?q=ff&sort=newest 
```

和

```
http://stackoverflow.com/search?q=ff&amp;sort=newest 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-11-08T21:48:49.660

我刚刚试过这个。你试图做的是正确的。在 HTML 中，如果您正在编写链接，`&`则应将字符编码为`&amp;` 您只会对 进行编码，`&`就`%26`好像您希望参数值包含与号一样。我刚刚编写了一个包含链接的简单 HTML 页面：`<a href="Default2.aspx?param1=63&amp;param2=hel">Click me</a>` 它运行良好：`default2.aspx`接收到预期的参数并且源通过了验证。

`&`as的编码`&amp;`在 HTML 中是必需的，而不是在链接中。当浏览器`&amp;`在 HTML 源代码中看到链接时，它会将其解释为 & 符号，并且链接目标将符合预期。如果您将 URL 粘贴到浏览器地址栏中，它不会期望它是 HTML，并且不会尝试解释它可能包含的任何 HTML 编码。这就是为什么您建议我们应该复制/粘贴到浏览器中的示例链接不起作用以及我们不希望它们起作用的原因。

如果您发布更多实际代码，我们可能会看到您做错了什么，但您似乎通过`&amp;`在锚标签中使用正朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-08T23:28:31.627

这是我的错：超链接控件已经编码`&`，所以我的 URL`http://foo?x=1&amp;y=2`被编码为`http://foo?x=1&amp;amp;y=2`

正如您所说，通常`&amp`浏览器会正确处理 URL 内部。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-08T20:30:19.663

您可以在页面内的 URL 中使用`&amp;`而不是。`&`

这应该允许它被验证为严格的 XHTML ......

```
<a href="http://www.example.org/page.aspx?x=1&amp;y=2">Foo</a> 
```

请注意，如果由 ASP.NET *Request.QueryString*函数使用，则查询字符串不使用 XML 编码；它使用[URL 编码](http://www.w3schools.com/TAGS/ref_urlencode.asp)：

```
/mypath/mypage?b=%26stuff 
```

因此，您需要提供一个将“&”转换为 %26 的函数。

注意：在这种情况下，会产生 neetu+%26+geetu 的*Server.URLEncode("neetu & geetu")*不是您想要的，因为您需要将 & 转换为 %26，而不仅仅是 '&'。您必须添加一个应用于 URLEncode 结果的 replace() 调用，才能替换 '%26amp;' 通过'%26'。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-25T19:00:30.373

更彻底：使用`&#38;`,*数字字符引用*。

因为`&amp;`是*字符实体引用*：

> 字符实体引用在标记语言定义中定义。这意味着，例如，对于 HTML，只有特定范围的字符（由 HTML 规范定义）可以表示为字符实体引用（并且仅包括 Unicode 范围的一小部分）。

这来自 W3C 的智者（阅读[本文](http://www.w3.org/International/questions/qa-escapes)了解更多信息）。

当然，这不是什么大问题，但 W3C 的建议是，数字的数字将在任何地方且始终有效和可用，而命名的数字对于 HTML 来说是“好的”，仅此而已。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2008-11-11T09:20:13.897

问题比您想象的要严重 - 在[Safari](https://en.wikipedia.org/wiki/Safari_%28web_browser%29)中尝试一下。 `&amp;amp;`被转换为`&amp;#38;`并且哈希结束 URL。

正确的答案是不输出 XHTML - 没有理由证明花更多时间在开发上和疏远 Mac 用户是合理的。

# search - 如何将集成的 Google 搜索添加到我的网站？

> ID：275153
> 
> 赞同：13
> 
> 时间：2008-11-08T20:29:52.753
> 
> 标签：search, google-custom-search

基本上我有一个网站。我有一个正确设置的站点地图，所以我假设谷歌知道我的所有页面。我在一些网站上看到，搜索表单会指向一个带有原始网站外壳的页面，但结果显然是由 Google 提供的。与codinghorror.com 的搜索类似，但他的结果并未显示在他的网站布局中。

知道我在说什么或如何实现这一目标吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-08T20:33:06.257

2008 年 11 月：像[这样](https://web.archive.org/web/20081231030633/http://www.askdavetaylor.com/how_can_i_add_a_google_search_box_to_my_web_site.html)（但您会[在此处找到 2012 年更新的示例](https://stackoverflow.com/q/13822927/6309)）

```
<form method="get" action="http://www.google.com/search">

<div style="border:1px solid black;padding:4px;width:20em;">
<table border="0" cellpadding="0">
<tr><td>
<input type="text"   name="q" size="25"
 maxlength="255" value="" />
<input type="submit" value="Google Search" /></td></tr>
<tr><td align="center" style="font-size:75%">
<input type="checkbox"  name="sitesearch"
 value="askdavetaylor.com" checked /> only search Ask Dave Taylor<br />
</td></tr></table>
</div>

</form> 
```

为了在单独的框架中显示结果，您可以使用[此站点](http://www.cfhunt.com/)作为示例。

那将是这样的：

```
<html>
<head>
    <meta http-equiv="Content-Language" content="en-gb">
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">

    <script language="javascript" type="text/javascript">
    function showFrame () {
        var e = document.getElementById("if1");
        e.style.visibility = "visible" ;
    }
    </script>
</head>

<body>
    <p> </p>
    <p>
    <span id="spSearch" onclick="showFrame()">Search</span>
    </p>
    <p> </p>
    <p><iframe name="I1" id="if1" width="100%" height="254" style="visibility:hidden" src="http://www.google.co.uk">
        Your browser does not support inline frames or is currently configured not to display inline frames.
    </iframe></p>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-08T21:01:41.050

[https://cse.google.com/cse/](https://cse.google.com/cse/)

^ 也许您正在寻找 Google 自定义搜索引擎

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-14T09:34:08.497

对于基于主要 Google 索引的免费解决方案，使用`site:`查询并且只对外观进行少量控制，请尝试使用[Google 自定义搜索引擎](http://www.google.com/coop/cse/)。

花几百美元，拥有更全面和最新的网站索引，并完全控制外观，试试[Google Site Search](http://www.google.com/sitesearch/)。

对于需要完全控制索引和搜索体验的各个方面，并且需要索引中包含数千到数百万项的任何内容的企业，请尝试使用[Google Search Appliance](http://www.google.com/enterprise/gsa/)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-08T23:24:52.383

作为列出的另一个回答者，我相信自定义搜索是您正在寻找的。

只是想提供更多信息。谷歌也有网站搜索，但你需要付费。

看看谷歌网站管理员工具： [http ://www.google.com/webmasters/](http://www.google.com/webmasters/)

特别是： [http ://www.google.com/sitesearch/](http://www.google.com/sitesearch/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-08T20:48:40.560

进行自定义 google 搜索的一种简单方法是使用 adsense 进行搜索，它允许您：

*   在一个或多个站点或整个 Internet 中搜索。
*   在新窗口、当前窗口或 iframe 中打开。
*   自定义搜索结果的颜色。
*   它还可以为您对广告的任何点击支付几分钱。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-11-17T05:00:46.970

我之前对另一个问题提出了同样的答案，所以这就是答案

Go to this link [https://www.google.com/cse/](https://www.google.com/cse/) and create account Create your custom search box Customize looks as your wish Copy the code after customizing Paste in your blog or website where you want the search box to appear..

And if you want search box like my site [http://www.latestgames2.com/](http://www.latestgames2.com/) just customized all the colors and shapes

# php - 名称的正则表达式

> ID：275160
> 
> 赞同：27
> 
> 时间：2008-11-08T20:35:31.133
> 
> 标签：php, regex

刚刚开始探索正则表达式的“奇迹”。作为一个从反复试验中学习的人，我真的很挣扎，因为我的试验抛出了不成比例的错误......我的实验是在 PHP 中使用 ereg()。

反正。我分别使用名字和姓氏，但现在使用相同的正则表达式。到目前为止，我有：

```
^[A-Z][a-zA-Z]+$ 
```

任何以大写字母开头并且其余部分只有字母（大写或不大写）的长度字符串。但是我崩溃的地方是处理几乎可以在任何地方发生的特殊情况。

*   连字符名称（Worthington-Smythe）
*   带使徒的名字（D'Angelo）
*   带空格的名称 (Van der Humpton) - 中间的大写字母可能需要也可能不需要，这超出了我现阶段的兴趣。
*   联名 (Ben & Jerry)

也许还有其他一些我没有想到的名字，但我怀疑如果我能理解这个，我可以添加它。我很确定会有不止一种情况出现在一个名称中的情况。

所以，我认为底线是让我的正则表达式也接受空格、连字符、& 和撇号 - 但不是在名称的开头或结尾，在技术上是正确的。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2010-01-11T21:01:59.537

这个正则表达式对我来说是完美的。

```
^([ \u00c0-\u01ffa-zA-Z'\-])+$ 
```

它在使用 preg_match() 的 php 环境中运行良好，但并非在任何地方都适用。

它匹配`Jérémie O'Co-nor`，所以我认为它匹配所有 UTF-8 名称。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-11-08T20:46:36.557

*   连字符名称（Worthington-Smythe）

将 - 添加到第二个字符类中。最简单的方法是在开头添加它，这样它就不可能被解释为范围修饰符（如 中`a-z`）。

```
^[AZ][-a-zA-Z]+$
```

*   带使徒的名字（D'Angelo）

这样做的一个天真的方法是如上所述，给出：

```
^[AZ][-'a-zA-Z]+$
```

不要忘记您可能需要在字符串中转义它！鉴于您的示例，“更好”的方法可能是：

```
^[AZ]'?[-a-zA-Z]+$
```

这将允许在第二个位置出现一个可能的单撇号。

*   带空格的名称 (Van der Humpton) - 中间的大写字母可能需要也可能不需要，这超出了我现阶段的兴趣。

在这里，我很想再次做我们天真的方式：

```
^[AZ]'?[- a-zA-Z]+$
```

一个可能更好的方法可能是：

```
^[AZ]'?[- a-zA-Z]( [a-zA-Z])*$
```

最后寻找额外的单词。如果您尝试匹配额外文本正文中的名称，这可能不是一个好主意，但话又说回来，原来的也不会做得那么好。

*   联名 (Ben & Jerry)

在这一点上，你不再看单一的名字了吗？

无论如何，正如你所看到的，正则表达式有一个快速增长的习惯......

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-07-22T13:37:31.750

**名称的最佳正则表达式：**

*   我将使用术语**特殊字符**来指代以下三个字符：
    1.  破折号**-**
    2.  连字符**'**
    3.  点**。**
*   空格和特殊字符不能连续出现两次（例如：**--**或**'.**或**..**）
*   修剪（前后没有空格）
*   别客气 ;）

* * *

强制性的单一名称，没有空格，没有特殊字符：

```
^([A-Za-z])+$ 
```

*   **Sierra**有效，**Jack Alexander**无效（有空格），**O'Neil**无效（有特殊字符）

* * *

必填单名，不带空格，**带**特殊字符：

```
^[A-Za-z]+(((\'|\-|\.)?([A-Za-z])+))?$ 
```

*   **Sierra**有效，**O'Neil**有效，**Jack Alexander**无效（有空格）

* * *

强制单一名称，**可选附加名称**，**带**空格，带特殊字符：

```
^[A-Za-z]+((\s)?((\'|\-|\.)?([A-Za-z])+))*$ 
```

*   **杰克亚历山大**有效，**塞拉奥尼尔**有效

* * *

强制性的单一名称，**可选的附加名称**，**带**空格，**不带**特殊字符：

```
^[A-Za-z]+((\s)?([A-Za-z])+)*$ 
```

*   **Jack Alexander**有效，**Sierra O'Neil**无效（有特殊字符）

* * *

### 特例

许多现代智能设备在每个单词的末尾添加空格，因此在我的应用程序中，我允许字符串前后的空格数量不受限制，然后我在后面的代码中对其进行修剪。所以我使用以下内容：

**强制单名 + 可选附加名 + 空格 + 特殊字符：**

```
^(\s)*[A-Za-z]+((\s)?((\'|\-|\.)?([A-Za-z])+))*(\s)*$ 
```

* * *

### 添加自己的特殊字符

如果您想添加自己的特殊字符，假设下划线**_** 这是您需要更新的组：

```
(\'|\-|\.) 
```

到

```
(\'|\-|\.|\_) 
```

PS：如果您有问题在这里评论，我会收到一封电子邮件并回复；）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-09T06:47:34.003

虽然我同意你基本上不能用正则表达式做到这一点的答案，但我会指出，一些反对意见（国际化字符）可以通过使用 UTF 字符串和`\p{L}`字符类（匹配 unicode“字母”）来解决。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-09-19T05:12:00.070

安全提示：确保在此步骤之前验证字符串的大小，以避免 DoS 攻击会通过发送非常长的字符集来破坏您的系统。

看一下这个：

```
^(([A-Za-z]+[,.]?[ ]?|[a-z]+['-]?)+)$ 
```

[![正则表达式](https://i.stack.imgur.com/wVkOz.png)](https://i.stack.imgur.com/wVkOz.png)

你可以[在这里](https://regex101.com/r/mS9gD7/46)测试它：[https ://regex101.com/r/mS9gD7/46](https://regex101.com/r/mS9gD7/46)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-08T21:22:29.870

我真的没有太多要添加到处理名称的正则表达式中，因为这里已经有一些很好的建议，但是如果您想要一些资源来了解更多关于正则表达式的信息，您应该查看：

*   [正则表达式库的](http://regexlib.com/) [备忘单](http://regexlib.com/CheatSheet.aspx)
*   [另一个备忘单](http://www.addedbytes.com/cheat-sheets/regular-expressions-cheat-sheet/)
*   DevNetwork 论坛上的正则表达式教程：[第 1](http://forums.devnetwork.net/viewtopic.php?f=38&t=33147)部分和[第 2 部分](http://forums.devnetwork.net/viewtopic.php?f=38&t=40169)
*   PHP 构建器的[教程](http://www.phpbuilder.com/columns/dario19990616.php3)
*   如果你需要为 JavaScript 做正则表达式（有点不同），试试[JavaScript Kit](http://www.javascriptkit.com/jsref/regexp.shtml)，或者[这个资源](http://www.regular-expressions.info/javascript.html)，或者[Mozilla 的参考](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Regular_Expressions)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-08T20:54:19.147

基本上，我同意 Paul 的观点……你总能找到例外，比如*di Caprio*、*DeVil*等。

对您的消息的评论：在 PHP 中，ereg 通常被视为过时（缓慢、不完整），有利于 preg（PCRE 正则表达式）。
你应该尝试一些正则表达式测试器，比如强大的正则[表达式教练](http://www.weitz.de/regex-coach/)：它们非常适合快速测试任意字符串的正则表达式。

如果您真的需要解决您的问题并且对以上答案不满意，请问，我会试一试。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-08T21:52:01.697

我赞同“放弃”的建议。即使你考虑数字、连字符、撇号等，像 [a-zA-Z] 这样的东西仍然无法捕捉到国际名称（例如，那些有 šđčćž、西里尔字母或汉字的名字......）

但是……你为什么还要验证名字？你想捕捉什么错误？你不认为人们比你更懂得写自己的名字吗？;) 说真的，通过尝试验证姓名，您唯一能做的就是用不寻常的姓名激怒人们。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-05-13T16:17:40.460

这对我有用：

> ```
>  +[a-z]{2,3} +[a-z]*|[\w'-]* 
> ```

此正则表达式将正确匹配以下名称：

让-克劳德·范达姆

纳丁·阿罗约-罗德里克斯

韦恩·拉皮埃尔

贝弗利丹杰洛

比利鲍勃桑顿

铁托蓬特

苏珊德尔里奥

它将组合“van damme”、“arroyo-rodriquez”、“d'angelo”、“billy-bob”等以及“wayne”等单数名称。

请注意，它不会测试分组的东西实际上是一个有效的名称。就像其他人说的那样，你需要一本字典。此外，它还会对数字进行分组，因此如果这是一个问题，您可能需要修改正则表达式。

我写这个是为了解析 MapReduce 应用程序的名称。我想要的只是从 name 字段中提取单词，将 del foo 和 la bar 和 billy-bobs 组合成一个单词，以使键值对生成更加准确。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-08T20:48:02.387

```
^[A-Z][a-zA-Z '&-]*[A-Za-z]$ 
```

将接受以大写字母开头的任何内容，后跟零个或多个任何字母、空格、连字符、与号或撇号，并以字母结尾。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-08T21:19:09.033

有关更多相关的“名称检测”相关内容，请参阅此问题。

[正则表达式最多匹配 4 个空格](https://stackoverflow.com/questions/256729/regex-to-match-a-maximum-of-4-spaces)

基本上，您有一个问题，实际上不存在不能形成合法名称字符串的字符。

如果您仍然限制自己使用没有 ä ü æ ß 和其他类似的非严格 ascii 字符的单词。

*获取一份UTF32*字符表的副本，并了解您的简单正则表达式会遗漏多少个有效字符。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-12-28T21:41:35.667

要在用户名中添加多个点，请使用此正则表达式：

```
^[a-zA-Z][a-zA-Z0-9_]*\.?[a-zA-Z0-9_\.]*$ 
```

字符串长度可以单独设置。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-03-22T06:18:37.810

***通过使用strtoupper()***将字符串全部转换为大写，然后对照正则表达式进行检查，您可以轻松中和字母是大写还是小写的整个问题——即使是在意外或不常见的位置。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-01-16T13:32:15.150

`/([\u00c0-\u01ffa-zA-Z'\-]+[ ]?[*]?[\u00c0-\u01ffa-zA-Z'\-]*)+/;`

试试这个 。您也可以使用 ^ 强制以 char 开头，使用 $ 以 char 结尾

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-07-24T15:51:22.990

我遇到了同样的问题，并且像许多其他已发布的人一样，这不是 100% 万无一失的表达，但它对我们有用。

```
/([\-'a-z]+\s?){2,4}/ 
```

这将检查名字和/或姓氏中的任何连字符和/或撇号，并检查名字和姓氏之间的空格。最后一部分是一个小魔术，它将检查 2 到 4 个名称。如果您往往有很多可能有 5 个甚至 6 个名字的国际用户，您可以将其更改为 5 或 6 个，它应该适合您。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-09-13T19:12:46.287

为了改进daan的回答：

```
^([\u00c0-\u01ffa-zA-Z]+\b['\-]{0,1})+\b$ 
```

仅允许在 az 和有效的 unicode 字符中出现一次连字符或撇号。

还进行回溯以确保字符串末尾没有连字符或撇号。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-09-01T12:23:02.637

`^[A-Z][a-z]*(([,.] |[ '-])[A-Za-z][a-z]*)*(\.?)( [IVXLCDM]+)?$`

有关完整的详细信息，请访问[**此**](https://stackoverflow.com/a/68896296/12581494)帖子。此正则表达式不允许 & 符号。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-11-08T20:43:00.683

如果您添加空格，则“他星期天去市场”将是一个有效的名称。

我认为您不能使用正则表达式来做到这一点，您无法使用正则表达式轻松地从一大块文本中检测到名称，您需要一个已批准名称的字典并基于此进行搜索。不会检测到任何不在列表中的名称。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2012-07-05T10:23:23.897

我使用了这个，因为名称可以是文件补丁的一部分。

```
//http://support.microsoft.com/kb/177506
foreach(array('/','\\',':','*','?','<','>','|') as $char)
  if(strpos($name,$char)!==false)
      die("Not allowed char: '$char'"); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-09-11T19:40:41.727

我认为 "/^[a-zA-Z']+$/" 是不够的，它允许传递单个字母我们可以通过添加 {4,20} 来调整范围，这意味着字母的范围是 4 到 20。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-01-03T15:16:11.060

我想出了这个 RegEx 名称模式：

```
/^([a-zA-Z]+[\s'.]?)+\S$/ 
```

有用。我认为你也应该使用它。

它仅匹配名称或字符串，例如：

> 沙奎尔·奥尼尔·阿姆斯特朗·巴兹-奥尔德林博士

它不会匹配带有 2 个或更多空格的字符串，例如：

> 约翰·保罗

它不会匹配带有结尾空格的字符串，例如：

> 约翰·保罗

*上面的文字有一个结尾空格。尝试突出显示或选择文本以查看空间*

以下是我用来学习和创建自己的正则表达式模式的内容：

[RegExr：学习、构建和测试 RegEx](http://www.regexr.com)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-07-01T21:07:56.963

*   试试这个：

    ```
    /^([AZ][az] *([ ][az]+)* ([ '-]([&][ ])?[AZ][az]+)*)$/
    ```

*   演示：[http ://regexr.com/3bai1](http://regexr.com/3bai1)

祝你今天过得愉快 ！

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-09-17T08:42:42.923

您可以在下面使用此名称

```
^[a-zA-Z'-]{3,}\s[a-zA-Z'-]{3,}$ 
```

`^`字符串的开头

`$`字符串的结尾

`\s`空间

`[a-zA-Z'-\s]{3,}`将接受长度为 3 个或更多字符的任何名称，并且它包括带有`'`或`-`类似的名称`jean-luc`

所以在我们的例子中，它只接受由空格分隔的两部分的名称

* * *

如果有多个名字，您可以添加一个`\s`

```
^[a-zA-Z'-\s]{3,}\s[a-zA-Z'-]{3,}$ 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-02-08T13:33:46.560

遵循正则表达式对于专有名称（城镇、城市、名字、姓氏）简单而有用，允许所有国际字母省略基于 unicode 的正则表达式引擎。

它很灵活——你可以在表达式中添加/删除你想要的字符（专注于你想要拒绝而不是包含的字符）。

```
^(?:(?!^\s|[ \-']{2}|[\d\r\n\t\f\v!"#$%&()*+,\.\/:;<=>?@[\\\]^_`{|}~€‚ƒ„…†‡ˆ‰‹‘’“”•–—˜™›¡¢£¤¥¦§¨©ª«¬®¯°±²³´¶·¸¹º»¼½¾¿×÷№′″ⁿ⁺⁰‱₁₂₃₄]|\s$).){1,50}$ 
```

正则表达式匹配：由单个分隔符分隔的 1 到 50 个国际字母（空格 -'）

正则表达式拒绝：空前缀/后缀、连续分隔符（空格 - '）、数字、换行符、制表符、扩展 ASCII 字符的有限列表

[演示](https://regex101.com/r/FXCgJo/1)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2022-02-06T19:05:16.613

这是我使用的全名：

```
$pattern = "/^((\p{Lu}{1})\S(\p{Ll}{1,20})[^0-9])+[-'\s]((\p{Lu}{1})\S(\p{Ll}{1,20}))*[^0-9]$/u"; 
```

*   支持所有语言
*   常用名称( `"Jane Doe"`, `"John Doe"`)
*   对组合名称有用（`"Marie-Josée Côté-Rochon"`, `"Bill O'reilly"`）
*   不包括数字（`0-9`）
*   只有名称开头的大写字母除外
*   2-21 个字符的名字和姓氏
*   添加`trim()`以删除空格
*   不包括 ( `"John J. William"`, `"Francis O'reilly Jr. III"`)
*   必须使用全名，而不是：( `"John"`, `"Jane"`, `"O'reilly"`, `"Smith"`)

**编辑：** 似乎`[^0-9]`上述模式中的两个名字和/或姓氏都至少匹配第四个数字/字母。

因此，无法匹配三个字母/数字的名称。

这是编辑后的正则表达式：

```
$pattern = "/^(\p{Lu}{1}\S\p{Ll}{1,20}[-'\s]\p{Lu}{1}\S\p{Ll}{1,20})+([^\d]+)$/u"; 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2008-11-08T20:45:07.510

放弃。您能想到的每条规则在某些文化或其他文化中都有例外。即使这种“文化”是那些喜欢合法地将自己的名字改为“37eet”的极客。

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2021-01-02T22:02:15.873

试试这个正则表达式：

```
^[a-zA-Z'-\s\.]{3,20}\s[a-zA-Z'-\.]{3,20}$ 
```

青峰的回答很有帮助，我对其进行了一些调整以包括：

1.  带点的名字（中间）：`Jane J. Samuels`

2.  结尾带点的名字：`John Simms Snr.`

此外，该名称将接受至少 2 个字母和 1 分钟。姓氏2个字母，但每个不超过20个（总共40个字符）

成功的测试用例：

```
D'amalia Jones    
David Silva Jnr.    
Jay-Silva Thompson
Shay .J. Muhanned
Bob J. Iverson 
```

# c++ - 什么是“运算符 T*(void)”以及何时调用它？

> ID：275169
> 
> 赞同：3
> 
> 时间：2008-11-08T20:41:24.663
> 
> 标签：c++

我有 2 个文件：

```
/****demo.cpp****/
#include <iostream.h>
#include "gc.h"

class foo{};

int main(){
    gc<foo> x1;
    cout<<x1;
}

/*****gc.h*****/
template <class T> class gc 
{
    T* ptr;
public:
    operator T*(){}
}; 
```

如果我不写`operator T*(){}`，那么我会得到很多编译器错误。

所以请告诉我什么`operator T*(void)`是调用它以及何时调用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T20:49:10.047

### 关于你的问题

`operator type ()` 是所谓的强制转换运算符。如果需要转换为`type`，则使用该运算符函数进行转换。

在您的示例中， cout 使用您`operator T* ()`将您的 x1 对象使用用户定义的隐式转换转换为指针，然后由 ostream 的 (cout 属于 std::ostream 类) 输出，该指针`operator<<`采用 void* 。

### 其他问题

为了帮助您找出其他问题，请将头文件名从 更改`iostream.h`为`iostream`. 标准 C++ 不知道`iostream.h`. 在 C++ 成为标准之前，这些文件是这样调用的。此外，您使用的所有 C 头文件`math.h, stdio.h`在 C++ 中仍然有效，但它们是所谓的向后兼容头文件。你应该包括例如`cmath`，`cstdio`而不是。这会将所有不是 C 中宏的名称放入`namespace std`. 而不是使用`cout`，你使用`std::cout`。其他标识符也是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T20:46:14.827

运算符`T*(){}` 是一个[强制转换运算符](http://msdn.microsoft.com/en-us/library/ts48df3y.aspx)。您正在提供一个可用于从 a 转换`gc<T>`为 a `T*`... 的函数，尽管它应该要求您实际返回一些东西，大概`ptr`在这种情况下。

问题是编译器不知道如何将 gc 对象格式化为输出流。

通过提供从 gc 到 foo* 的转换，它能够将对象作为指针值输出......可能不是你想要的。

您可能希望为 << 运算符定义自定义重载以转储您的类：

```
template <class T>
std::ostream& operator<<( std::ostream& os, const gc<T>& x)
{
    // os << .. something useful here ..
    return os;
} 
```

# python - 如何使用 Python/Django 执行 HTML 解码/编码？

> ID：275174
> 
> 赞同：146
> 
> 时间：2008-11-08T20:44:30.507
> 
> 标签：python, django, html-encode

我有一个 HTML 编码的字符串：

```
'''&lt;img class=&quot;size-medium wp-image-113&quot;\
 style=&quot;margin-left: 15px;&quot; title=&quot;su1&quot;\
 src=&quot;http://blah.org/wp-content/uploads/2008/10/su1-300x194.jpg&quot;\
 alt=&quot;&quot; width=&quot;300&quot; height=&quot;194&quot; /&gt;''' 
```

我想将其更改为：

```
<img class="size-medium wp-image-113" style="margin-left: 15px;" 
  title="su1" src="http://blah.org/wp-content/uploads/2008/10/su1-300x194.jpg" 
  alt="" width="300" height="194" /> 
```

我希望将其注册为 HTML，以便浏览器将其呈现为图像，而不是显示为文本。

字符串是这样存储的，因为我正在使用一个名为 的网络抓取工具[`BeautifulSoup`](https://www.crummy.com/software/BeautifulSoup/bs4/doc/)，它“扫描”网页并从中获取某些内容，然后以该格式返回字符串。

我发现如何在**C#**中做到这一点，但在**Python**中没有。有人可以帮我吗？

### 有关的

*   [在 Python 中将 XML/HTML 实体转换为 Unicode 字符串](https://stackoverflow.com/questions/57708/convert-xml-html-entities-into-unicode-string-in-python)

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2008-11-08T21:40:37.943

鉴于 Django 用例，对此有两个答案。下面是它的`django.utils.html.escape`功能，供参考：

```
def escape(html):
    """Returns the given HTML with ampersands, quotes and carets encoded."""
    return mark_safe(force_unicode(html).replace('&', '&amp;').replace('<', '&l
t;').replace('>', '&gt;').replace('"', '&quot;').replace("'", '&#39;')) 
```

为了扭转这种情况，杰克的回答中描述的猎豹功能应该可以工作，但缺少单引号。此版本包括一个更新的元组，替换顺序颠倒以避免对称问题：

```
def html_decode(s):
    """
    Returns the ASCII decoded version of the given HTML string. This does
    NOT remove normal HTML tags like <p>.
    """
    htmlCodes = (
            ("'", '&#39;'),
            ('"', '&quot;'),
            ('>', '&gt;'),
            ('<', '&lt;'),
            ('&', '&amp;')
        )
    for code in htmlCodes:
        s = s.replace(code[1], code[0])
    return s

unescaped = html_decode(my_string) 
```

然而，这不是一个通用的解决方案。它仅适用于用 . 编码的字符串`django.utils.html.escape`。更一般地说，坚持使用标准库是个好主意：

```
# Python 2.x:
import HTMLParser
html_parser = HTMLParser.HTMLParser()
unescaped = html_parser.unescape(my_string)

# Python 3.x:
import html.parser
html_parser = html.parser.HTMLParser()
unescaped = html_parser.unescape(my_string)

# >= Python 3.5:
from html import unescape
unescaped = unescape(my_string) 
```

作为建议：将未转义的 HTML 存储在数据库中可能更有意义。如果可能的话，值得考虑从 BeautifulSoup 返回未转义的结果，并完全避免这个过程。

使用 Django，转义只发生在模板渲染期间；因此，为了防止转义，您只需告诉模板引擎不要转义您的字符串。为此，请在模板中使用以下选项之一：

```
{{ context_var|safe }}
{% autoescape off %}
    {{ context_var }}
{% endautoescape %} 
```

* * *

## 回答 #2

> 赞同：134
> 
> 时间：2011-08-17T05:51:23.393

使用标准库：

*   HTML转义

    ```
    try:
        from html import escape  # python 3.x
    except ImportError:
        from cgi import escape  # python 2.x

    print(escape("<")) 
    ```

*   HTML 转义

    ```
    try:
        from html import unescape  # python 3.4+
    except ImportError:
        try:
            from html.parser import HTMLParser  # python 3.x (<3.4)
        except ImportError:
            from HTMLParser import HTMLParser  # python 2.x
        unescape = HTMLParser().unescape

    print(unescape("&gt;")) 
    ```

* * *

## 回答 #3

> 赞同：80
> 
> 时间：2009-01-16T01:12:53.993

对于 html 编码，标准库中有**cgi.escape**：

```
>> help(cgi.escape)
cgi.escape = escape(s, quote=None)
    Replace special characters "&", "<" and ">" to HTML-safe sequences.
    If the optional flag quote is true, the quotation mark character (")
    is also translated. 
```

对于 html 解码，我使用以下内容：

```
import re
from htmlentitydefs import name2codepoint
# for some reason, python 2.5.2 doesn't have this one (apostrophe)
name2codepoint['#39'] = 39

def unescape(s):
    "unescape HTML code refs; c.f. http://wiki.python.org/moin/EscapingHtml"
    return re.sub('&(%s);' % '|'.join(name2codepoint),
              lambda m: unichr(name2codepoint[m.group(1)]), s) 
```

对于更复杂的事情，我使用 BeautifulSoup。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-11-09T01:15:21.333

如果编码字符集相对受限，请使用丹尼尔的解决方案。否则，请使用众多 HTML 解析库之一。

我喜欢 BeautifulSoup，因为它可以处理格式错误的 XML/HTML：

[http://www.crummy.com/software/BeautifulSoup/](http://www.crummy.com/software/BeautifulSoup/)

[对于您的问题，他们的文档](http://www.crummy.com/software/BeautifulSoup/documentation.html)中有一个示例

```
from BeautifulSoup import BeautifulStoneSoup
BeautifulStoneSoup("Sacr&eacute; bl&#101;u!", 
                   convertEntities=BeautifulStoneSoup.HTML_ENTITIES).contents[0]
# u'Sacr\xe9 bleu!' 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2015-07-08T01:54:02.450

在 Python 3.4+ 中：

```
import html

html.unescape(your_string) 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-11-23T13:50:40.003

请参阅此页面底部的[Python wiki](http://wiki.python.org/moin/EscapingHtml)，“unes​​cape” html 至少有 2 个选项。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-10-24T22:04:16.410

丹尼尔的评论作为答案：

“转义只发生在 Django 中的模板渲染期间。因此，不需要转义 - 你只需告诉模板引擎不要转义。{{ context_var|safe }} 或 {% autoescape off %}{{ context_var }}{ % endautoescape %}"

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2010-07-17T13:27:49.123

我在以下位置找到了一个很好的功能：[http ://snippets.dzone.com/posts/show/4569](http://snippets.dzone.com/posts/show/4569)

```
def decodeHtmlentities(string):
    import re
    entity_re = re.compile("&(#?)(\d{1,5}|\w{1,8});")

    def substitute_entity(match):
        from htmlentitydefs import name2codepoint as n2cp
        ent = match.group(2)
        if match.group(1) == "#":
            return unichr(int(ent))
        else:
            cp = n2cp.get(ent)

            if cp:
                return unichr(cp)
            else:
                return match.group()

    return entity_re.subn(substitute_entity, string)[0] 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-12-21T17:08:31.887

如果有人正在寻找一种通过 django 模板执行此操作的简单方法，您可以随时使用如下过滤器：

```
<html>
{{ node.description|safe }}
</html> 
```

我有一些来自供应商的数据，我发布的所有内容都在呈现的页面上实际写入了 html 标签，就好像您正在查看源代码一样。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-02-01T21:31:08.733

尽管这是一个非常古老的问题，但这可能会奏效。

Django 1.5.5

```
In [1]: from django.utils.text import unescape_entities
In [2]: unescape_entities('&lt;img class=&quot;size-medium wp-image-113&quot; style=&quot;margin-left: 15px;&quot; title=&quot;su1&quot; src=&quot;http://blah.org/wp-content/uploads/2008/10/su1-300x194.jpg&quot; alt=&quot;&quot; width=&quot;300&quot; height=&quot;194&quot; /&gt;')
Out[2]: u'<img class="size-medium wp-image-113" style="margin-left: 15px;" title="su1" src="http://blah.org/wp-content/uploads/2008/10/su1-300x194.jpg" alt="" width="300" height="194" />' 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-08T20:58:52.227

我在 Cheetah 源代码中找到了这个（[这里](http://www.koders.com/python/fid549827F97513858275EEA43DC0135AC97AEAEF57.aspx)）

```
htmlCodes = [
    ['&', '&amp;'],
    ['<', '&lt;'],
    ['>', '&gt;'],
    ['"', '&quot;'],
]
htmlCodesReversed = htmlCodes[:]
htmlCodesReversed.reverse()
def htmlDecode(s, codes=htmlCodesReversed):
    """ Returns the ASCII decoded version of the given HTML string. This does
        NOT remove normal HTML tags like <p>. It is the inverse of htmlEncode()."""
    for code in codes:
        s = s.replace(code[1], code[0])
    return s 
```

不知道他们为什么要颠倒列表，我认为这与他们的编码方式有关，所以对你来说可能不需要颠倒。另外，如果我是您，我会将 htmlCodes 更改为元组列表而不是列表列表……尽管这将在我的库中进行:)

我注意到你的标题也要求编码，所以这里是 Cheetah 的编码功能。

```
def htmlEncode(s, codes=htmlCodes):
    """ Returns the HTML encoded version of the given string. This is useful to
        display a plain ASCII text string on a web page."""
    for code in codes:
        s = s.replace(code[0], code[1])
    return s 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-02-27T16:01:44.960

你也可以使用 django.utils.html.escape

```
from django.utils.html import escape

something_nice = escape(request.POST['something_naughty']) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-12-15T18:01:24.410

下面是一个使用 module 的 python 函数`htmlentitydefs`。它并不完美。我拥有的版本`htmlentitydefs`不完整，它假设所有实体都解码为一个代码点，这对于以下实体是错误的`&NotEqualTilde;`：

[http://www.w3.org/TR/html5/named-character-references.html](http://www.w3.org/TR/html5/named-character-references.html)

> ```
> NotEqualTilde;     U+02242 U+00338    ≂̸ 
> ```

有了这些警告，这里是代码。

```
def decodeHtmlText(html):
    """
    Given a string of HTML that would parse to a single text node,
    return the text value of that node.
    """
    # Fast path for common case.
    if html.find("&") < 0: return html
    return re.sub(
        '&(?:#(?:x([0-9A-Fa-f]+)|([0-9]+))|([a-zA-Z0-9]+));',
        _decode_html_entity,
        html)

def _decode_html_entity(match):
    """
    Regex replacer that expects hex digits in group 1, or
    decimal digits in group 2, or a named entity in group 3.
    """
    hex_digits = match.group(1)  # '&#10;' -> unichr(10)
    if hex_digits: return unichr(int(hex_digits, 16))
    decimal_digits = match.group(2)  # '&#x10;' -> unichr(0x10)
    if decimal_digits: return unichr(int(decimal_digits, 10))
    name = match.group(3)  # name is 'lt' when '&lt;' was matched.
    if name:
        decoding = (htmlentitydefs.name2codepoint.get(name)
            # Treat &GT; like &gt;.
            # This is wrong for &Gt; and &Lt; which HTML5 adopted from MathML.
            # If htmlentitydefs included mappings for those entities,
            # then this code will magically work.
            or htmlentitydefs.name2codepoint.get(name.lower()))
        if decoding is not None: return unichr(decoding)
    return match.group(0)  # Treat "&noSuchEntity;" as "&noSuchEntity;" 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-06-30T09:56:10.010

这是解决此问题的最简单方法 -

```
{% autoescape on %}
   {{ body }}
{% endautoescape %} 
```

从[这个页面](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs)。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-07-18T14:13:33.250

在 Django 和 Python 中搜索此问题的最简单解决方案，我发现您可以使用内置函数来转义/取消转义 html 代码。

# 例子

我将您的 html 代码保存在`scraped_html`和`clean_html`：

```
scraped_html = (
    '&lt;img class=&quot;size-medium wp-image-113&quot; '
    'style=&quot;margin-left: 15px;&quot; title=&quot;su1&quot; '
    'src=&quot;http://blah.org/wp-content/uploads/2008/10/su1-300x194.jpg&quot; '
    'alt=&quot;&quot; width=&quot;300&quot; height=&quot;194&quot; /&gt;'
)
clean_html = (
    '<img class="size-medium wp-image-113" style="margin-left: 15px;" '
    'title="su1" src="http://blah.org/wp-content/uploads/2008/10/su1-300x194.jpg" '
    'alt="" width="300" height="194" />'
) 
```

# 姜戈

*你需要 Django >= 1.0*

## 逃逸

要取消您抓取的 html 代码，您可以使用[django.utils.text.unescape_entities](https://github.com/django/django/blob/stable/2.0.x/django/utils/text.py#L377)：

> 将所有命名和数字字符引用转换为相应的 unicode 字符。

```
>>> from django.utils.text import unescape_entities
>>> clean_html == unescape_entities(scraped_html)
True 
```

## 逃脱

要转义干净的 html 代码，您可以使用[django.utils.html.escape](https://docs.djangoproject.com/en/2.0/ref/utils/#django.utils.html.escape)：

> 返回带有 & 符号、引号和尖括号的给定文本，这些文本经过编码以便在 HTML 中使用。

```
>>> from django.utils.html import escape
>>> scraped_html == escape(clean_html)
True 
```

# Python

*你需要 Python >= 3.4*

## 逃逸

要对抓取的 html 代码进行转义，您可以使用[html.unescape](https://docs.python.org/3/library/html.html#html.unescape)：

> 将字符串 s 中的所有命名和数字字符引用（例如，、、`&gt;`）`&#62;`转换`&x3e;`为相应的 unicode 字符。

```
>>> from html import unescape
>>> clean_html == unescape(scraped_html)
True 
```

## 逃脱

要转义干净的 html 代码，您可以使用[html.escape](https://docs.python.org/3/library/html.html#html.escape)：

> 将字符`&`,`<`和`>`in 字符串 s 转换为 HTML 安全序列。

```
>>> from html import escape
>>> scraped_html == escape(clean_html)
True 
```

# asp.net - 捕获 SSL 证书请求错误以重定向到正确的站点

> ID：275178
> 
> 赞同：5
> 
> 时间：2008-11-08T20:46:57.617
> 
> 标签：asp.net, ssl, https

我们使用 IIS 6 和 ASP.Net，当用户使用

> **[https://somesite.com/securePage.aspx](https://somesite.com/securePage.aspx)**

用户收到错误：

* * *

> **错误代码：ssl error bad cert domain**

* * *

证书颁发给**www.somesite.com**，表明**somesite.com**使用了无效的安全证书。

我希望能够在 Application BeginRequest 事件中捕获请求，但在此之前发生 SSL 错误。为了调用 Application BeginRequest 事件，用户需要单击证书错误消息。是否可以在代码中重定向或者是否需要在 IIS 中进行此修复？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-09T01:17:51.843

唯一的解决方案是在证书中包含带有 SubjectAlternativeName 的第二个域。一些证书颁发机构将允许您这样做而无需额外费用。

其他一切只会在建立 ssl 连接*后发生，因此**在*用户遇到错误后才会发生。

使用 HTTPS，在将任何 HTTP 标头发送到服务器之前协商 ssl 连接，包括告诉服务器请求实际针对哪个虚拟主机的 Host:-header。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-15T18:41:59.867

我能够使用 IIS 的重写功能解决这个问题。事实证明它真的很容易修复，我们不必购买新证书。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-11T01:19:19.610

HOP 的回答是正确的。如果我们有幸使用 IIS 7 作为类似于 Apache 的 mod_rewrite 规则的重写规则，Owen 也可以在 IIS 中使用。

今天与我们的网络管理员和我们的 SSL 证书提供商一起进一步调查后，将 SAN 应用到我们的证书是完全可能的，而且是免费的。

然而，由于 ORG 内部的政治问题，决定 DEV（我的小组）在 Application BeginRequest 事件中重定向到注册域。对于每个请求，我们将检查 URL 是否指向我们的 FQDN。**如果请求是针对“短名称”的，那么我们将始终通过将www**附加到将由 context.Host 方法返回的短名称来将其指向 FQDN 。

毫无疑问，这会增加健谈等等！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-18T23:42:29.870

我在我的一台服务器上对此进行了一些测试，这就是我发现的。

我们有一个适用于 5 个域的 UCC 证书。我的 5 个域是

掌握 mydomain.com

子替代名称：mysite.com myweb.com thissite.com www.thissite.com

之所以这样设置是因为我不太明白它想要www。当我成功的时候。

所以，

```
https://mydomain.com - works
https://www.mydomain.com - works
https://www.mysite.com - ERROR
https://mysite.com - works
https://thissite.com - works
https://www.thissite.com - works. 
```

如果您有 UCC 证书（似乎有），请在相关域上添加带有 www 的主题备用名称。然后它将适用于两者。

我经历了尝试使用 .htaccess 和服务器端脚本重定向的所有步骤。但是，hop 是对的，如果您不修复证书，它不会做任何事情。

重新加密证书时，您可能必须删除域。只需记住您放弃了哪个并为该证书获取新证书。从现在开始，我将永远永远拒绝购买 UCC 证书。问题多于它们的价值。1 个域 = 1 个证书。

如果您的域名正在赚钱，那么它物有所值，如果您不赚钱 - 您真的需要证书吗？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-08T21:14:04.583

在 Apache 中，这通常使用 mod_rewrite 完成：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^example\.com$ [NC]
RewriteRule ^(.*)$ http://www.example.com/$1 [R=301,L] 
```

谷歌“重写 URL IIS”，你会发现一些 IIS 的等价物。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-08T21:21:19.607

有趣。在我看到这个问题之前，我从未在任何网站上观察到这种行为。甚至谷歌也有这个问题。下面的 url 给出了错误的证书错误

> [https://google.com/accounts/](https://google.com/accounts/)

顺便说一句，大多数网站都有一个子域，他们用证书保护它。一票赞成这个问题。

# c# - 使用 C# 解析 *.c/*.h 文件以进行声明和数据类型定义的最佳方法

> ID：275187
> 
> 赞同：1
> 
> 时间：2008-11-08T20:52:16.780
> 
> 标签：c#, parsing

我需要为数据声明解析*.c/* .h 文件并提取类型声明。例如，我可能需要提取变量声明及其对应的数据类型，如下所示：

```
typedef union 
{
  struct
  {
    unsigned char   OG15 : 1,
                    ...
                    OG0  : 1;
  } Bits;
  unsigned short Packed;

} OUTPUT_DESCRIPTOR;

OUTPUT_DESCRIPTOR DiscreteWord1; 
```

所以我的问题是（使用 C#）：

1.  存储数据类型信息的最佳方式是什么？
2.  解析源文件以提取声明和数据类型的最佳方法是什么？

谢谢

标记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T00:38:42.767

不确定这是否是最好的方法，但我可以提出两种工作方法：

1.  使用 Phoenix SDK 编写记录此信息的编译器传递。
2.  使用常规 C 编译器编译代码，请求 PDB 文件，然后使用 DIA API 从 PDB 文件中读取数据结构定义。

# iis-5 - 如何从 IIS5 http 标头中删除 eTag

> ID：275189
> 
> 赞同：0
> 
> 时间：2008-11-08T20:56:05.803
> 
> 标签：iis-5, etag

运行 IIS5（是的，真的）。我想删除 IIS 为我生成的 eTag http 标头。MS 有一篇关于如何在网络场中同步 eTag 的文章，但没有关于如何删除它们的文章 ( [http://support.microsoft.com/?id=922733](http://support.microsoft.com/?id=922733) )。

有没有办法删除电子标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T03:37:09.587

AFAIK，没有简单的方法可以从 IIS 5 中删除 Web 资源（例如图像、css 或 js 文件）的 etag。因为每个 etag 值都会在每次后续 Web 浏览器刷新时重新生成，这是不必要的，因为这些 Web 上可能没有任何更改资源。

您可能想尝试 EtagFix，虽然它不会删除 etag，但它会稳定 etag 值，因此在修改 Web 资源之前它们不会改变。

> EtagFix 稳定 Internet 信息服务 (IIS) 生成的 etag，使其不会在每次重新启动 Web 服务器时更改。

[http://www.isapilabs.com/Products/ETagFix/index.htm](http://www.isapilabs.com/Products/ETagFix/index.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T21:12:05.180

进入 Inetmgr 并在网站属性中，切换到 HTTP 标头选项卡并添加一个没有值的“ETag”自定义 HTTP 标头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-22T01:45:49.120

这篇博文介绍了如何在 IIS（iis 6、iis 7 和 iis 7.5）中完全删除 Etag http 标头

[http://lightspeednow.com/blog/2010/05/21/iis-tutorial-how-to-completely-remove-etags-entity-tags-from-iis6-iis7-and-iis7-5/](http://lightspeednow.com/blog/2010/05/21/iis-tutorial-how-to-completely-remove-etags-entity-tags-from-iis6-iis7-and-iis7-5/)

# asp.net - 格式化 DataBinder.Eval 数据

> ID：275194
> 
> 赞同：30
> 
> 时间：2008-11-08T20:58:00.137
> 
> 标签：asp.net, formatting, repeater, databinder

如何格式化来自 ASPX 页面中的 DataBinder.Eval 语句的数据？

例如，我想在主页中以特定格式显示新闻的发布日期。我正在使用 ASP.NET 2.0 Repeater 控件来显示新闻项目列表。

代码如下：

```
<asp:Repeater ID="Repeater1" runat="server" DataSourceID="ObjectDataSource1">
<HeaderTemplate><table cellpadding="0" cellspacing="0" width="255"></HeaderTemplate>
<ItemTemplate>
    <tr><td >
            <a href='/content/latestNews.aspx?id=<%#DataBinder.Eval(Container.DataItem, "id") %>'>
                <asp:Label ID="lblNewsTitle" runat="server" Text='<%# DataBinder.Eval(Container.DataItem, "title") %>'></asp:Label>
            </a>
    </td></tr>
    <tr><td>
           <asp:Label ID="lblNewsDate" runat="server" Text='<%# DataBinder.Eval(Container.DataItem, "publishedDate"))%>'></asp:Label>
    </td></tr>
</ItemTemplate>
<FooterTemplate></table></FooterTemplate></asp:Repeater> 
```

有没有一种方法可以调用以 DataBinder.Eval 值为参数的自定义方法（如下所示）？

```
<asp:Label ID="lblNewsDate" runat="server" Text='<%# GetDateInHomepageFormat(DataBinder.Eval(Container.DataItem, "publishedDate")) )%>'></asp:Label> 
```

如果是，那么我在哪里编写 GetDateInHomepageFormat 方法？我在页面后面的代码中进行了尝试，但出现了运行时错误？如果这是不可能的，有没有办法进行内联格式化？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-11-08T21:17:52.827

DataBinder.Eval 有一个可选的重载来提供格式：

```
<%# DataBinder.Eval(Container.DataItem, "expression"[, "format"]) %> 
```

格式参数是一个字符串值，使用值占位符替换语法（称为复合格式），如下所示：

```
<asp:Label id="lblNewsDate" runat="server" Text='<%# DataBinder.Eval(Container.DataItem, "publishedDate", "{0:dddd d MMMM}") %>'</label> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-09T11:05:27.663

在网上搜索了一番后，我发现调用自定义方法传递 DataBinder.Eval 值**实际上是非常有可能的。**

自定义方法可以写在代码隐藏文件中，但必须声明为**public**或**protected**。在我上面的问题中，我曾提到我试图在后面的代码中编写自定义方法，但遇到了运行时错误。这样做的原因是我已将方法声明为**private**。

因此，总而言之，以下是使用 DataBinder.Eval 值来获得所需输出的好方法：

默认.aspx

```
<asp:Label ID="lblNewsDate" runat="server" Text='<%# GetDateInHomepageFormat(DataBinder.Eval(Container.DataItem, "publishedDate")) )%>'></asp:Label> 
```

default.aspx.cs 代码：

```
public partial class _Default : System.Web.UI.Page
{

    protected string GetDateInHomepageFormat(DateTime d)
    {

        string retValue = "";

        // Do all processing required and return value

        return retValue;
    }
} 
```

希望这对其他人也有帮助。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-05-17T05:57:35.100

为什么不使用更简单的语法？

```
<asp:Label id="lblNewsDate" runat="server" Text='<%# Eval("publishedDate", "{0:dddd d MMMM}") %>'</label> 
```

这是接受表达式和字符串格式的模板控件“Eval”：

```
protected internal string Eval(
string expression,
string format 
```

)

[http://msdn.microsoft.com/en-us/library/3d2sz789.aspx](http://msdn.microsoft.com/en-us/library/3d2sz789.aspx)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-08T22:38:56.830

您可以像您说的那样在转发器中使用函数，但请注意 DataBinder.Eval 返回一个对象，您必须将其转换为 DateTime。

您还可以格式化您的字段内联：

```
<%# ((DateTime)DataBinder.Eval(Container.DataItem,"publishedDate")).ToString("yyyy-MMM-dd") %> 
```

如果您使用 ASP.NET 2.0 或更高版本，您可以编写如下：

```
<%# ((DateTime)Eval("publishedDate")).ToString("yyyy-MMM-dd") %> 
```

另一种选择是在 OnItemDataBound 事件中将值绑定到标签。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-07-31T09:15:10.223

这一行解决了我的问题：

```
<%#DateTime.Parse(Eval("DDDate").ToString()).ToString("dd-MM-yyyy")%> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-10-04T16:56:20.550

要使用本地日期格式格式化日期，请使用：

```
<%#((DateTime)Eval("ExpDate")).ToString("d")%> 
```

[如何使用日期区域设置格式化 Eval 语句以显示日期](http://willmtz.blogspot.com/2011/09/how-to-format-eval-statement-to-display_24.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-10-14T01:08:15.390

谢谢大家。一段时间以来，我一直停留在标准格式字符串上。我还在 VB 中使用了自定义函数。

标记：-

```
<asp:Label ID="Label3" runat="server" text='<%# Formatlabel(DataBinder.Eval(Container.DataItem, "psWages1D")) %>'/> 
```

背后的代码： -

```
Public Function fLabel(ByVal tval) As String
   fLabel = tval.ToString("#,##0.00%;(#,##0.00%);Zero")
End Function 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-10-27T05:31:33.983

文本='<%# DateTime.Parse(Eval("LastLoginDate").ToString()).ToString("MM/dd/yyyy hh:mm tt") %>'

这适用于您想要的格式

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-17T14:07:19.450

```
<asp:Label ID="ServiceBeginDate" runat="server" Text='<%# (DataBinder.Eval(Container.DataItem, "ServiceBeginDate", "{0:yyyy}") == "0001") ? "" : DataBinder.Eval(Container.DataItem, "ServiceBeginDate", "{0:MM/dd/yyyy}") %>'>
</asp:Label> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-22T05:48:12.723

你可以在aspx页面中这样使用

```
<%# DataBinder.Eval(Container.DataItem, "DateColoumnName", "{0:dd-MMM-yyyy}") %> 
```

# c++ - 您是否在 C++ 中执行以下与文件相关的操作？

> ID：275199
> 
> 赞同：2
> 
> 时间：2008-11-08T21:01:29.567
> 
> 标签：c++, file-io

你如何在 C++ 中进行以下操作？

1.  打开文件
2.  关闭文件
3.  读取文件
4.  写入文件

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-08T21:23:12.690

## 阅读

```
#include <fstream>
int main()
{
    std::ifstream    inputFile("MyFileName")  // Opens a File.

    int  x;
    inputFile >> x; // Reads an integer from a file.

    std::string word;
    inputFile >> word; // Reads a space separated word from a file.

    double y;
    inputFile >> y; // Reads a floating point number from the file.

    // etc..
 } // File AutoMagically closed by going out of scope. 
```

## 写作

```
#include <fstream>
int main()
{
    std::ofstream    inputFile("MyFileName")  // Opens a File.

    int  x = 5;
    inputFile << x << " "; // Writes an integer to a file then a space.
    inputFile << 5 << " "; // Same Again.

    std::string word("This is a line");
    inputFile << word << "\n"; // Writes a string to a file followed by a newline
                               // Notice the difference between reading and
                               // writing a string.
    inputFile << "Write a string constant to a file\n";

    double y = 15.4;
    inputFile << y << ":"; // Writes a floating point number 
                           // to the file followed by ":".

    // etc..
 } // File AutoMagically closed by going out of scope. 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-08T21:29:59.417

## 一次全部

```
{ 
    std::ifstream in("foo.txt"); /* opens for reading */
    std::ofstream out("bar.txt"); /* opens for writing */
    out << in.rdbuf(); /* streams in into out. writing and reading */
} /* closes automatically */ 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-08T21:04:42.213

[http://www.cplusplus.com/doc/tutorial/files.html](http://www.cplusplus.com/doc/tutorial/files.html)

我个人仍然使用 C 风格的 fopen、fread、fwrite 等，但这比实际“正确”更受欢迎。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T22:10:57.883

使用 C++，您在如何与文件交互方面有很多选择，尤其是当您使用周围的众多框架之一时，例如 Qt、wxWidgets 或 GLib。总而言之，标准 C++ 库使用基于流的文件访问模型，通过 std::ifstream 和 std::ofstream。这类似于您在使用 std::cout 时看到的内容，也是@Martin 的帖子所举例说明的内容。您还可以使用标准 C 库函数来读取和写入文件，即 open()、close()、read() 和 write()。f*() 变体采用 FILE 指针而不是文件描述符。当您想将文件视为原始字节流时，C 变体更有用，不幸的是，这种情况比它应该发生的频率更高。虽然这两者都是“可移植的”，但构建路径和处理目录/特殊文件通常不是，

# python - Python ctypes 和函数调用

> ID：275207
> 
> 赞同：7
> 
> 时间：2008-11-08T21:11:25.413
> 
> 标签：python, c, assembly, ctypes, x86-64

我的朋友制作了一个适用于 x86 的小型概念验证汇编器。我决定也将它移植到 x86_64，但我立即遇到了问题。

我用 C 写了一小段程序，然后编译和 objdump 代码。之后我将它插入到我的 python 脚本中，因此 x86_64 代码是正确的：

```
from ctypes import cast, CFUNCTYPE, c_char_p, c_long

buffer = ''.join(map(chr, [ #0000000000000000 <add>:
  0x55,                     # push   %rbp
  0x48, 0x89, 0xe5,         # mov    %rsp,%rbp
  0x48, 0x89, 0x7d, 0xf8,   # mov    %rdi,-0x8(%rbp)
  0x48, 0x8b, 0x45, 0xf8,   # mov    -0x8(%rbp),%rax
  0x48, 0x83, 0xc0, 0x0a,   # add    $0xa,%rax
  0xc9,                     # leaveq 
  0xc3,                     # retq
]))

fptr = cast(c_char_p(buffer), CFUNCTYPE(c_long, c_long))
print fptr(1234) 
```

现在，为什么这个脚本在我运行它时总是出现分段错误？

我还有一个关于 mprotect 和没有执行标志的问题。据说它可以防止大多数基本的安全漏洞，如缓冲区溢出。但它被使用的真正原因是什么？你可以继续写，直到你点击 .text，然后将你的指令注入一个不错的 PROT_EXEC 区域。当然，除非您在 .text 中使用写保护

但是，为什么到处都有那个 PROT_EXEC 呢？.text 部分被写保护不是很有帮助吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-09T01:06:14.363

正如文[森特](https://stackoverflow.com/questions/275207/python-ctypes-and-function-calls#275333)所说，这是由于分配的页面被标记为不可执行。较新的处理器支持此[功能](http://en.wikipedia.org/wiki/NX_bit)，并且它被支持它的操作系统用作附加的安全层。这个想法是为了防止某些缓冲区溢出攻击。例如。一种常见的攻击是溢出堆栈变量，重写返回地址以指向您插入的代码。对于不可执行的堆栈，这现在只会产生段错误，而不是控制进程。堆内存也存在类似的攻击。

要绕过它，您需要更改保护。这只能在页面对齐的内存上执行，因此您可能需要将代码更改为如下所示：

```
libc = CDLL('libc.so')

# Some constants
PROT_READ = 1
PROT_WRITE = 2
PROT_EXEC = 4

def executable_code(buffer):
    """Return a pointer to a page-aligned executable buffer filled in with the data of the string provided.
    The pointer should be freed with libc.free() when finished"""

    buf = c_char_p(buffer)
    size = len(buffer)
    # Need to align to a page boundary, so use valloc
    addr = libc.valloc(size)
    addr = c_void_p(addr)

    if 0 == addr:  
        raise Exception("Failed to allocate memory")

    memmove(addr, buf, size)
    if 0 != libc.mprotect(addr, len(buffer), PROT_READ | PROT_WRITE | PROT_EXEC):
        raise Exception("Failed to set protection on buffer")
    return addr

code_ptr = executable_code(buffer)
fptr = cast(code_ptr, CFUNCTYPE(c_long, c_long))
print fptr(1234)
libc.free(code_ptr) 
```

注意：在释放页面之前取消设置可执行标志可能是个好主意。大多数 C 库在完成后实际上并没有将内存返回给操作系统，而是将其保存在自己的池中。这可能意味着他们将在不清除 EXEC 位的情况下在其他地方重用该页面，从而绕过安全优势。

另请注意，这是相当不可移植的。我已经在 linux 上测试过它，但没有在任何其他操作系统上测试过。它不适用于 Windows，购买可能适用于其他 unix（BSD，OsX？）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-09T00:29:39.740

和我的朋友做了一些研究，发现这是一个特定于平台的问题。我们怀疑在某些平台上 malloc mmaps 内存没有 PROT_EXEC 而在其他平台上它确实如此。

因此有必要在之后使用 mprotect 更改保护级别。

蹩脚的东西，花了一段时间才知道该怎么做。

```
from ctypes import (
    cast, CFUNCTYPE, c_long, sizeof, addressof, create_string_buffer, pythonapi
)

PROT_NONE, PROT_READ, PROT_WRITE, PROT_EXEC = 0, 1, 2, 4
mprotect = pythonapi.mprotect

buffer = ''.join(map(chr, [ #0000000000000000 <add>:
    0x55,                     # push   %rbp
    0x48, 0x89, 0xe5,         # mov    %rsp,%rbp
    0x48, 0x89, 0x7d, 0xf8,   # mov    %rdi,-0x8(%rbp)
    0x48, 0x8b, 0x45, 0xf8,   # mov    -0x8(%rbp),%rax
    0x48, 0x83, 0xc0, 0x0a,   # add    $0xa,%rax
    0xc9,                     # leaveq 
    0xc3,                     # retq
]))

pagesize = pythonapi.getpagesize()
cbuffer = create_string_buffer(buffer)#c_char_p(buffer)
addr = addressof(cbuffer)
size = sizeof(cbuffer)
mask = pagesize - 1
if mprotect(~mask&addr, mask&addr + size, PROT_READ|PROT_WRITE|PROT_EXEC) < 0:
    print "mprotect failed?"
else:
    fptr = cast(cbuffer, CFUNCTYPE(c_long, c_long))
    print repr(fptr(1234)) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-08T22:51:24.777

我认为如果不先将其设置为可执行文件，您将无法自由执行任何分配的内存。我从未尝试过自己，但您可能想检查 unix 函数`mprotect`：

[http://linux.about.com/library/cmd/blcmdl2_mprotect.htm](http://linux.about.com/library/cmd/blcmdl2_mprotect.htm)

`VirtualProtect`似乎在 windows 上做同样的事情：

[http://msdn.microsoft.com/en-us/library/aa366898(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa366898(VS.85).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T22:21:43.417

python甚至允许这样的用法吗？那我应该学...

我认为解释器不希望更改任何寄存器。如果您打算像这样使用汇编器输出，请尝试保存您在函数中使用的寄存器。

顺便说一句，x86_64 的调用约定与常规的 x86 不同。如果您丢失堆栈指针对齐并混合使用其他工具生成的外部对象，您可能会遇到麻烦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-28T13:22:43.813

我只想到了一种更简单的方法，但最近不涉及 mprotect。直接为程序直接映射可执行空间。这些天 python 有一个模块可以做到这一点，尽管我没有找到获取代码地址的方法。简而言之，您将分配内存调用 mmap 而不是使用字符串缓冲区并间接设置执行标志。这更容易和更安全，您可以确定现在只有您的代码可以执行。

# c# - 如何将数据绑定到与派生列表的类中的列表项无关的属性

> ID：275213
> 
> 赞同：4
> 
> 时间：2008-11-08T21:16:35.560
> 
> 标签：c#, generics, data-binding

以前，我有一个包含内部的类`System.Collections.Generic.List<Item>`（其中 Item 是我创建的类）。包装类提供了几个集合级别的属性，这些属性提供了列表中项目的总计、平均值和其他计算。`BindingSource`我正在围绕这个包装创建一个`List<>`，另一个`BindingSource`围绕我的类创建，并且能够通过第一个`BindingSource`和使用第二个的包装类的集合级属性获取包装列表中的项目。

一个简化的示例如下所示：

```
public class OldClass()
{
  private List<Item> _Items;

  public OldClass()
  {
    _Items = new List<Item>();
  }

  public List<Item> Items { get { return _Items; } }

  // collection-level properties
  public float AverageValue { get { return Average() } }
  public float TotalValue { get { return Total() } }
  // ... other properties like this

} 
```

使用以这种方式创建的绑定源：

```
_itemsBindingSource = new BindingSource(oldClass.Items);
_summaryBindingSource = new BindingSource(oldClass); 
```

最近，我尝试将此类更改为派生自该类，`System.Collections.Generic.List<Item>`而不是保留一个包装的`List<>`成员。我希望摆脱额外的包装层，只使用一个`BindingSource`而不是两个。`AverageValue`但是，现在我发现当我进行数据绑定时，我无法获得适用于列表中所有项目（例如 ）的属性。只有列表项的属性可用。

我是否被迫回到使用包裹`List<>`的`Item`s？或者有没有一种方法可以同时获取`Item`s 存储我的新类的属性以及适用于集合本身的属性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-09T00:03:44.537

系统将任何实现`IList`（或`IListSource`）的东西视为容器，而不是项目。因此，您不能绑定到任何实现`IList`. 因此，如果您希望能够绑定到容器的属性，那么*封装（即您已经拥有的）是最好的方法。*

但是，您应该注意，许多绑定在源代码中支持点符号 - 即绑定到“Items.SomeProperty”，或设置辅助属性（通常`DataMember`）以指定子列表。

这允许您拥有一个单一的`BindingSource`，并且将不同的控件绑定到层次结构中的不同级别 - 即您可能有一个`TextBox`绑定到`AverageValue`，并且一个`DataGridView`（具有相同的`DataSource`）具有`DataMember="Items"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T22:38:18.203

这里的问题是您想将一个类用于两个完全不同的目的（就绑定而言）。

示例：“AverageValue”属性在每个项目上没有意义，因为它是一个跨越所有项目的全局属性。

无论哪种方式，我都猜测您的 _itemsBindingSource 用于 ComboBox 或其他东西，而您的 _summaryBindingSource 用于 PropertyGrid（或类似的东西）。

你*可以*做什么，这*可能*适用于你的情况（我不能确定，因为我不知道你实际上在做什么）是这样的：

1) 让您的“OldClass”实现 IEnumerable... 并在其中简单地从列表中返回枚举。这将使您能够绑定到“oldClass”而不是“oldClass.Items”。

2）使“公共列表项”成为一个字段，而不是一个属性......或添加“Browsable（false）”属性，这样它就不会绑定到PropertyGrid（这是一个猜测，因为不清楚你是什么'重新使用这些绑定）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T15:47:38.517

您是否考虑过创建扩展类，而不是围绕您的列表创建包装类（假设您使用的是 C# 3）

```
public static class MyExtensions
{
    public static float GetAverage(this List<Item>)
    {
        // implementation
    }

    public static float GetTotal(this List<Item>)
    {
        // implementation
    }
} 
```

当然，你的属性变成了方法调用（[也许 C# 4 会解决这个问题](https://stackoverflow.com/questions/137775/should-extension-properties-be-added-to-c-40)），但你会完全消除包装器。

# c++ - C++ 中的作用域和返回值

> ID：275214
> 
> 赞同：28
> 
> 时间：2008-11-08T21:16:45.857
> 
> 标签：c++, return-value, scope

我重新开始使用 c++ 并正在考虑变量的范围。如果我在函数中有一个变量，然后我返回该变量，该变量在返回时是否不会“死”，因为它所在的范围已经结束？

我已经用一个返回字符串的函数尝试了这个，它确实有效。谁能解释一下？或者至少请给我指出一个可以向我解释的地方。

谢谢

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-11-08T21:26:28.817

> 当函数终止时，会发生以下步骤：
> 
> *   函数的返回值被复制到为此目的而放入堆栈的占位符中。
>     
>     
> *   弹出堆栈帧指针之后的所有内容。这会破坏所有局部变量和参数。
>     
>     
> *   返回值从堆栈中弹出并分配为函数的值。如果函数的值没有分配给任何东西，则不会发生分配，并且值会丢失。
>     
>     
> *   下一条要执行的指令的地址从堆栈中弹出，CPU 从该指令处恢复执行。

[栈和堆](http://www.learncpp.com/cpp-tutorial/79-the-stack-and-the-heap/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-08T21:23:50.570

当您返回一个值时，会生成一个副本。局部变量的作用域结束，但会创建一个副本，并返回给调用函数。例子：

```
int funcB() {
  int j = 12;
  return j;
}

void A() {
  int i;
  i = funcB();
} 
```

j (12) 的值被复制并返回给 i，这样 i 将收到 12 的值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-08T21:25:29.597

这实际上取决于您要返回的变量类型。如果您返回一个原语，那么它是通过复制而不是通过引用返回的，因此该值被复制到调用函数可以获得它的堆栈顶部（或者，更常见的是放置到寄存器中）。如果您在堆上分配一个对象或内存并返回一个指针，那么它不会死，因为它在堆上，而不是堆栈上。但是，如果您在堆栈上分配一些东西并返回它，那将是一件坏事。例如，其中任何一个都非常糟糕：

```
int *myBadAddingFunction(int a, int b)
{
    int result;

    result = a + b;
    return &result; // this is very bad and the result is undefined
}

char *myOtherBadFunction()
{
    char myString[256];

    strcpy(myString, "This is my string!");
    return myString; // also allocated on the stack, also bad
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-08T21:37:29.760

只是为了多一点面向内存模型的解释：当调用函数时，会为函数创建一个临时空间来放置其局部变量，称为*frame*。当函数（被调用者）返回它的值时，它将返回值放入调用它的函数（调用者）的框架中，然后被调用者框架被销毁。

“框架被破坏”部分是为什么你不能从函数返回指针或对局部变量的引用。指针实际上是一个内存位置，因此一旦帧被销毁，返回局部变量（根据定义：帧内的变量）的内存位置就变得不正确。由于被调用者框架在返回其值后立即被销毁，因此对局部变量的任何指针或引用都会立即不正确。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-08T21:21:15.660

局部变量被复制到返回值。复制构造函数被调用用于非平凡的类。

如果您返回一个指向局部变量的指针或引用，您将遇到麻烦——正如您的直觉所建议的那样。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-09T00:32:39.890

这取决于退货商品的类型。如果您按值返回，则会创建一个新的变量副本以返回给调用者。我认为您不需要担心对象的生命周期，但您可能需要担心复制对象的成本（但请不要过早优化 - 正确性更为重要）：

```
std::string someFunc( std::string& const s)
{
    return s + "copy";
} 
```

如果函数返回一个引用，那么你需要小心你返回的内容，因为它的生命周期需要超出函数的生命周期，`delete`如果你`new`用来创建对象，调用者不一定能够做到：

```
std::string& someFunc2( std::string const& s)
{
    return s + "reference to a copy";   // this is bad - the temp object created will 
                                        //  be destroyed after the expression the 
                                        //  function call is in finishes.
                                        //  Some, but not all, compilers will warn 
                                        //  about this.
} 
```

当然，返回指针也会有类似的生命周期考虑。

# c# - GDI+和WPF的相对优点

> ID：275222
> 
> 赞同：2
> 
> 时间：2008-11-08T21:22:00.930
> 
> 标签：c#, wpf, gdi+

GDI+ 和 WPF 的优缺点是什么？

还有人知道开发/运行 WPF 应用程序所需的最低系统要求吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-08T22:13:49.563

**GDI+ vs. WPF**
WPF 图形子系统有什么好处？让我们来看看：

1.  保留模式绘图/组合
2.  矢量图形
3.  真正的透明度
4.  和更多 ...

GDI+ 有什么好处？唔。这更难，因为我非常喜欢 WPF。但是，如果您必须不断地重新创建您尝试渲染的对象的几何图形，那么您可能需要 GDI+ 提供的即时模式 API。

这里有两篇（[一篇](http://blogs.msdn.com/timothyc/archive/2006/06/16/634638.aspx)，[两篇](http://www.fernicola.org/loquitor/index.php?/archives/19-When-to-use-WPF-and-when-to-use-other-technologies.html#extended)）关于这个问题的非常棒的博文。

（*请注意，上述博客文章相当陈旧。它们仍然包含大量信息，但也请注意，自 WPF 的原始版本 (.NET 3.0) 以来，WPF 团队在性能和图形功能方面取得了重大进展）。*

**系统要求**
**除了操作系统必须是 Windows XP SP 2 或更高版本并且必须安装 .NET 3.0（至少）之外，它们实际上并没有 WPF 应用程序的最低系统要求**。然而，话虽如此，运行 WPF 应用程序的机器中质量越好的显卡就越好。

我们自己注意到的是 WPF 即使在较旧的硬件上也表现得相当好，特别是如果您没有做任何太棘手或花哨的事情。

这意味着什么？好吧，根据我自己的经验，如果您开始使用**WPF 3D 和/或位图效果**做任何事情，请更仔细地观察您的表现。事实上，我鼓励您在整个应用程序开发过程中监控您的性能。

我要补充的最后一件事是……我们已经看到某些视频解决方案（尤其是英特尔集成视频）出现了一些非常奇怪的图形问题（ [this](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/f88e6a8a-0b83-4c27-bdc5-229a16a62059)和[this ）。](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/7382637b-b4bc-4a46-8bed-f36250a65385)

请查看其他 StackOverflow[帖子](https://stackoverflow.com/questions/239697/hardware-recommendationslimits-when-using-wpf)以获取有关硬件限制的更多信息，尤其是查看有关[Rendering Tiers](http://msdn.microsoft.com/en-gb/library/ms742196.aspx)的信息。

# version-control - 源代码控制有什么用？

> ID：275229
> 
> 赞同：3
> 
> 时间：2008-11-08T21:28:00.153
> 
> 标签：version-control, survey

最近有一个问题是，用“保留所有版本”的文件系统或工具来有效地替换本地源代码控制系统。

许多答案本质上说源代码控制系统不仅仅是保留过去的版本，甚至对于个人开发人员也是如此 - 我认为这是正确的。

所以，问题是：有什么原因需要源代码控制？其中哪些是最重要的？

我对源代码控制功能不是很感兴趣，而是对这些功能存在的原因感兴趣。

这是十人的首发，但我想知道我是否错过了一些：

1.  保留所有版本，尤其是那些形成已发货产品的版本
2.  当两次尝试发生冲突更改时，使团队能够编辑和防止（或至少发出警报）
3.  轻松查看文件版本之间的差异（涵盖前两个开发人员借口：“我没有更改任何内容”和“我的更改不应该这样做”）
4.  防止开发人员事故（无意中删除/更改代码）
5.  防止硬件问题（故障磁盘等）
6.  允许开发几个不同的代码库，同时最大限度地减少未更改文件的重复。
7.  记录谁改变了某些东西，以及为什么
8.  在不破坏主要代码库的情况下启用实验性更改

为什么要使用源代码控制？

# c# - Excel / Quickbooks 数据到 c#

> ID：275230
> 
> 赞同：2
> 
> 时间：2008-11-08T21:28:49.483
> 
> 标签：c#, excel, import, quickbooks

我知道如何使用 OleDbConnection 类打开一个 excel 文件并从中进行选择，但是有没有一种简单的方法可以从已读入 Stream 的 excel 文件中读取数据？QuickBooks 也有类似的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T22:42:23.623

溪流？不，Excel 文件很复杂。速写本，是的。我找到了这个[ODBC 驱动程序](http://www.synergration.com/accessbooksrt/)，它应该支持 OdbcDataAdapter。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T13:35:37.337

您还可以查看各种 QuickBooks 集成选项，这些选项允许您通过 XML 请求和响应与 QuickBooks 进行通信。有关 QuickBooks SDK 的更多详细信息：http: [//developer.intuit.com/](http://developer.intuit.com/)

此处的开发者论坛：http: [//idnforums.intuit.com/categories.aspx ?catid=56&entercat=y](http://idnforums.intuit.com/categories.aspx?catid=56&entercat=y)

VB .NET 框架在这里： http: [//idnforums.intuit.com/messageview.aspx ?catid=56&threadid=11040&enterthread=y](http://idnforums.intuit.com/messageview.aspx?catid=56&threadid=11040&enterthread=y)

# linq-to-sql - 在 LINQ to SQL DataContext“插入”部分方法中自动增加主键

> ID：275233
> 
> 赞同：3
> 
> 时间：2008-11-08T21:29:48.357
> 
> 标签：linq-to-sql

我想做的是以下。我有一个表 Products，其中包含一个私钥 ProductID。我不想在插入时让 SQL Server 自动增加 P​​roductID，而是想在 DataContext 部分方法“InsertProduct”中增加它：

```
Partial Public Class MyDataContext

    Private Sub InsertProduct(ByVal instance As Product)

        Dim id As Integer = Me.Products.Max(Function(p As Product) p.ProductID) + 1
        instance.ProductID = id

        Me.ExecuteDynamicInsert(instance)

    End Sub

End Class 
```

但是，这仅在插入第一个 Product 实例时才有效。尝试插入第二个实例时，检索到的 id 与第一个实例相同，

```
Using context As New MyDataContext

    Dim product1 As New Product
    context.Products.InsertOnSubmit(product1)
    context.SubmitChanges() 'This works

    Dim product2 As New Product
    context.Products.InsertOnSubmit(product2)
    context.SubmitChanges() 'DuplicateKeyException

End Using 
```

我在这里遗漏了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T18:48:22.160

我真的建议让 SQL Server 进行增量编号。上述方法即使您确实可以正常工作，也会在多用户场景中的负载下失败，在多用户场景中，他们都获得相同的 ID 并尝试插入相同的 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T22:29:04.743

InsertProduct 在上面的代码中没有声明为分部方法。这是您帖子中的拼写错误，还是您声明它的签名与要求的签名不同，因此它没有被执行？

[编辑] 我不是 VB 程序员（我使用 C#），但我认为您的代码需要将代码声明为部分代码以及在设计器中。无论如何，这在 C# 中是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T23:04:16.903

InsertProduct 在设计器生成的文件 (MyDataClasses.designer.vb) 中声明为部分方法。

它被执行了，实际上我可以在 InsertProduct 中插入一个断点，并观察 product1 的一切正常运行。对于 product2 会引发异常，`context.SubmitChanges()`但未命中断点。

# firefox - 在 Firefox 中，我可以禁用“由未知机构认证的网站”SSL 证书警告对话框吗？

> ID：275237
> 
> 赞同：15
> 
> 时间：2008-11-08T21:35:13.633
> 
> 标签：firefox, ssl

即我只是希望他们一直被永久接受。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-06T23:12:49.957

你不能。其他人回答这个问题，请仔细阅读。他不是在问如何添加例外或修复损坏的证书。他想完全关闭检查。

Mozilla 的人错误地采取了谨慎的态度，使这成为不可能。一方面它很烦人，但另一方面，他们的安全意识是 Firefox 比 IE 更安全的原因之一。

如果你想让异常更容易一点，在地址栏中输入“about:config”（不带引号），然后在过滤器中输入 browser.ssl_override_behavior，双击“Value”，将其更改为“2 ”。现在例外需要少点击一次。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T23:20:52.733

查看透视火狐插件。它使 Firefox 3 自动接受自签名证书。

[http://www.cs.cmu.edu/~perspectives/](http://www.cs.cmu.edu/~perspectives/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-08-17T21:06:28.810

这就是答案！

```
* Tools -> Options -> Advanced -> Encryption -> View Certificates
* Under Authorities tab, enter "RSA Security 1024" in the Search textbox.
* Select RSA Security 1024 V3 and press the Edit button.
* Uncheck all three options
* Press OK and close out the rest of the dialogs. 
```

证书颁发机构不会受到任何信任，因此已被有效禁用。

证书颁发机构不是未知的，也不是在恶意手中或任何东西，它只是没有被使用并且没有经过审计。请参阅[http://blog.mozilla.com/security/2010/04/06/removing-the-rsa-security-1024-v3-root/](http://blog.mozilla.com/security/2010/04/06/removing-the-rsa-security-1024-v3-root/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-12-29T09:00:56.647

对于我们这些要么...

*   不要相信成百上千的内置“权威”之一（偶尔会“偶然”发现它，或者可以用于完全恶意的目的——想想政府）和/或其中任何一个的安全策略（毕竟，任何一个被泄露的密钥都可以为任何站点伪造“全部清除”，而且——令人惊讶的是——它们确实如此）。
*   不喜欢很酷的权衡，比如五次点击以获得任何加密保护，以防止网站上的随便听者不知何故没有支付它的 ssl 税（不，你不能提前知道所有者是否真的这样做了，你是MitM 攻击的受害者）...嗯，您实际上可以购买一件物品并以低于合理用户界面的价格支付。
*   不想（出于某种神秘的原因）完全参与所有这些商业“付费，否则我们将向您发送垃圾邮件”马戏团（这显然可能被误认为是安全）。
*   需要连接到许多生成证书的各种路由器/服务器 https 接口。
*   ...

...部分解决方案可以是[“MitM me”扩展](https://addons.mozilla.org/en-US/firefox/addon/79787/ "见鬼")，这至少会降低点击次数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-08T21:56:33.670

您需要导入证书颁发者证书，以便任何其他证书。该发行人的问题不会发出此警告。

在 Firefox 中转到：首选项高级加密查看证书颁发机构，然后单击导入

如果您有颁发者的根证书，您可以在此处导入它，并且再也不会看到该错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-11-08T17:13:38.947

我知道这是一个旧线程，但为了将来参考，这个 FF 扩展是诀窍：

[https://addons.mozilla.org/en-US/firefox/addon/skip-cert-error/](https://addons.mozilla.org/en-US/firefox/addon/skip-cert-error/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-08T21:38:23.720

我认为您需要获得由浏览器提前知道的“根证书颁发机构”颁发的证书，例如 Verisign。

[http://www.verisign.co.uk/ssl/ssl-information-center/](http://www.verisign.co.uk/ssl/ssl-information-center/)

还有其他供应商。可以在这里找到小径......

[http://www.geotrust.com/](http://www.geotrust.com/)

对问题的良好描述以及根据您的要求在这里最适合您的方法...

[http://www.botell.com/newfaq/creating/whichcert.html](http://www.boutell.com/newfaq/creating/whichcert.html)

# c# - 将多个 Excel 文件同步到 MS Access 表的最佳方法

> ID：275242
> 
> 赞同：2
> 
> 时间：2008-11-08T21:37:42.757
> 
> 标签：c#, excel, ms-access

我们有许多非营利组织的基于 Excel 的成员名册，我们需要将它们合并到一个主 MS Access 表中。有时，我们会收到基于 Excel 的成员名册的更新副本，我需要将这些副本与主 MS Access 表同步。

我正在寻找实现这一目标的最佳方法。由于我不是 Access VBA 的忠实粉丝，我正在考虑编写一个 C# 控制台应用程序，利用 Marcos Meli 的[FileHelpers](http://www.filehelpers.com/)库在 Excel 和 Access 之间进行通信。您对构建自己的好方法或可用于实现此目标的现成方法有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T22:23:04.927

你还没有说会员名单有多大。

如果它们不是太大，并且如果您没有做任何太复杂的事情，那么只需将 Excel 文件链接到 Access 数据库将允许您将 Excel 文件替换为新文件（具有相同名称），然后是数据库将自动使用新数据，您根本不需要任何更新软件。

我还认为非营利组织不会有太多的 IT 预算，所以越简单越好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T17:54:12.083

通常，我过去所做的是将 excel 文件导入到临时表中，然后将重复删除，然后将结果列表复制到主表中。

您可能必须从主表中剔除前成员，在这种情况下，删除来自成员组织的所有成员并重新加载整个列表可能更容易。但是你必须记录他们来自哪个组织。

# c++ - 我什么时候使用 uncaught_exception？

> ID：275249
> 
> 赞同：7
> 
> 时间：2008-11-08T21:43:10.450
> 
> 标签：c++, exception-handling, error-handling

什么是 uncaught_exception 的好用例？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-08T22:30:52.993

Herb Sutter 似乎在[这里](http://www.gotw.ca/gotw/047.htm)给出了很好的建议。他不知道它有什么用处，并说在某些看起来有用的情况下并没有真正起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T22:17:46.810

[可能没有](http://www.gotw.ca/gotw/047.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T02:55:22.630

`uncaught_exception`可以在析构函数中使用，以确定它们是否在异常上下文中执行（抛出将终止程序）。我不同意这种哲学有一点缺陷，但这取决于您对异常的使用 - 如果您的异常是可恢复的错误，那么尝试修复它而不是让代码的另一部分尝试修复它可能更方便像往常一样处理它。

如果您的代码需要活动异常，它也很有用（这种情况很少见，但有时您有一个异常控制库将用于`throw;`获取当前异常，但如果没有异常则会导致终止，因此`uncaught_exception`可用于确定是否会中止（如果是，可能会抛出异常！）。一个例子是新的异常设施，它也是 boost 的一部分。

# haskell - 如何使用 runhaskell 增加堆栈大小？

> ID：275250
> 
> 赞同：10
> 
> 时间：2008-11-08T21:48:42.517
> 
> 标签：haskell, haskell-stack

我正在编写一些一次性的 Haskell 脚本来解决一些[Project Euler](http://projecteuler.net)问题。我真的不想编译它们，因为我必须不断地进行大量更改，但在某些情况下，我发现堆栈空间已用完。

的文档`runhaskell`说以下语法应该增加堆栈空间：

```
runhaskell +RTS -K5M -RTS Script.hs 
```

这永远不会起作用（在我尝试过的任何排列中）。堆栈大小始终保持为 8,388,608。这很令人抓狂，我在谷歌上没有找到太多帮助。

有什么建议么？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-09T04:53:43.407

我猜你正在使用GHC。新发布的 6.10.1 的用户指南第 4 章说：

> 当前唯一的 runghc 标志是 -f /path/to/ghc，它告诉 runghc 使用哪个 GHC 来运行程序。

我没有看到在[http://hackage.haskell.org/trac/ghc](http://hackage.haskell.org/trac/ghc)记录的错误。对我来说似乎很蹩脚。我建议在 irc #ghc 或 cvs-ghc 邮件列表上询问。

在其他 Haskell 编译器/解释器中，似乎只有 nhc98 允许您设置最大堆栈大小。根据您的操作系统，nhc98 可能是一个选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-10T23:46:56.930

我正在做同样的事情（Project Euler）并且一直在使用 ghc。诀窍（感谢#haskell！）是告诉*可执行文件*有更多的堆栈大小而不是*编译器*。

```
$ ghc -O2 -o 23 23.hs
$ ./23 +RTS -K128M 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T04:59:33.910

只需编译它。

问题123.hs：

```
module Main where
main = do
    print solution
solution = ... 
```

简短而优美的命令行：

```
ghc --make -O3 Problem123.hs
./Problem123 
```

最后一点：我不确定我会称它们为“脚本”。

# mobile - 我可以编程的最小设备是什么？

> ID：275255
> 
> 赞同：6
> 
> 时间：2008-11-08T21:51:06.957
> 
> 标签：mobile, device

我正在考虑比笔记本电脑更小的东西，我可以在上班途中花费数小时来解决项目欧拉问题等。

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-08T21:56:39.783

如果您指的是编程平台，您可以购买像华硕 EEE 这样的上网本。

或者，如果您指的是最小的可编程设备，请查看 PIC 微控制器：

[http://en.wikipedia.org/wiki/PIC_microcontroller](http://en.wikipedia.org/wiki/PIC_microcontroller)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-08T22:51:41.607

这听起来可能很疯狂，但试试钢笔/铅笔和纸。不，你不能运行代码，但它会帮助你不要过多地使用在线参考（是的，它们很好，但记忆技巧对我们所有人都有帮助），它也可能会帮助你更好地规划你的代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-08T23:20:18.697

我已经直接在我的[HP 48G 系列](http://en.wikipedia.org/wiki/HP-48)计算器上进行了编程。

![替代文字](https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/HP48G.jpg/200px-HP48G.jpg)

[这里](http://www.educalc.net/146663.page)有一个很好的编程教程。我得把它掸掉，看看它是否能通过[Project Euler](http://projecteuler.net/)的一分钟规则。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-09T00:18:01.747

如果您正在寻找微控制器或类似产品，我的建议是查看 AVR、PIC、[Arduino](http://arduino.cc/)或[BeagleBoard](http://beagleboard.org/)。

所有都相对便宜且易于编程（前三个更是如此）。AVR 和 PIC 是可以使用 C 或 ASM 编程的微控制器类型，但是您需要某种类型的原型板或类似的东西来实现任何目标。Arduino 是位于板上的 AVR 芯片，因此在很短的时间内完成某些事情要容易得多。除此之外，它们非常受欢迎，您可以在 Hackaday 找到许多已完成的项目。最后，BeagleBoard 是一个运行嵌入式 linux 的更强大的开发板。

我的推荐是 Arduino。

[这里](https://stackoverflow.com/questions/88626/best-platform-for-learning-embedded-programming)还有很多建议。

但是，如果您正在寻找用于编程的小型笔记本电脑设备，您有很多选择。华硕 EEE 电脑、HP 2133（我相信那是正确的型号）、MSI Wind、MacBook Air 等。正如其他人建议的那样，请查看一些上网本。您还可以对各种 PDA 或移动电话进行编程，例如 Android 电话或 OpenMoko 电话。有很多选择，我建议您找出您正在寻找的具体尺寸，这将缩小您的选择范围。

祝你好运。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-09T06:38:03.540

我会带着名声这样说：为什么不读书或看风景呢？试图在你的一天中塞进更多的编程实际上对你没有好处，甚至可能会让你的工作效率降低。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-12T19:53:09.110

我在我的 Palm OS 5 设备上使用[SmallBASIC](http://smallbasic.sourceforge.net/ "SmallBASIC")已经有一段时间了，它似乎可以很好地解决我遇到的大多数问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-08T21:56:38.333

使用带有[OnboardC](http://onboardc.sourceforge.net/)编译器的 Palm 怎么样？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-08T21:57:34.493

[上网本](http://en.wikipedia.org/wiki/Netbook)将是理想的。

图形计算器可能对编程来说太有限了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-08T21:59:30.933

如果您正在谈论制作微控制器，那么有几种[arduino 板](http://arduino.cc/)模型对于不熟悉嵌入式编程的人来说非常容易。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-08T22:05:19.813

我有一个带有 python 解释器的诺基亚 E51。用数字键盘打字一点也不愉快。我认为它尽可能小。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-08T22:48:47.713

我有一台运行 Windows Mobile 6 的三星 i760。滑出式键盘非常棒（任何设备上最好的迷你键盘）——我可以在上面打字几乎和普通键盘一样快。我主要用它在 mSQL 中编写 Oracle Lite 查询，这在任何其他 PDA 键盘上都无法使用。

![替代文字](https://www.samsung.com/us/system/consumer/product/2007/08/29/sch_i760zkavzw/mobile-phone_SCH-i760_features_kv.jpg)

这个问题让我想知道这个设备的真实编程环境，所以我[问了另一个问题](https://stackoverflow.com/questions/275436/are-there-any-good-programming-environmentsides-for-windows-mobile-devices)，其中一个答案是指向[这个](http://www.freewarepocketpc.net/ppc-download-c-ide-mobile-v9-0.html)的链接，这是一个用于创建 .NET Windows Mobile 应用程序的 Windows Mobile IDE。你甚至可以用 C# 编写它们。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-08T21:58:59.453

[上网本](http://en.wikipedia.org/wiki/Netbook)比您的典型笔记本电脑小，并且功能强大。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-08T22:24:13.643

这是相当主观的。我在通勤途中使用 15.4 英寸笔记本电脑进行编码，我发现它非常有限。

我仍然可以在 13 英寸时工作，但限制会变得如此之大，我已经在质疑它是否值得。任何更小的都可以。

但后来我倾向于在打开很多窗户的情况下工作。多个编辑器、文档、浏览器等。减少这会影响我的工作效率。在家里我有一个 30" 显示器。在工作中我有 2x 24" 显示器。

如果您倾向于主要在一个窗口中工作，很少查阅文档和其他应用程序等，那么您可能会变得更小。

这在很大程度上取决于您的人的类型，您喜欢什么，您的工作方式，您的工作对象和合作对象......列表还在继续。

我的猜测是，对于大多数开发人员来说，13" 将是最小的，然后它变得如此令人沮丧以至于你最好只听播客或其他东西 - 但 YMMV - 并且会！

# .net - 是否可以更改 RESX 生成器以在生成的类上使用公共访问器？

> ID：275257
> 
> 赞同：4
> 
> 时间：2008-11-08T21:52:01.587
> 
> 标签：.net

我正在编写一个 ASP.NET MVC 应用程序并尝试使用一个 RESX 文件来存储错误消息和其他常见字符串。问题是 RESX 生成器构建内部类，并且无法在 ASP.NET HTML 代码中使用如下语法使用它们：

```
<%= Resources.SomeString %> 
```

是否可以调整设置以使 RESX 生成器构建可公开访问的类和属性？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-08T21:59:19.000

可以`Public`从资源编辑器顶部菜单的组合框设置访问修饰符。

[http://docs.google.com/File?id=dcfqfqs2_2gfcb5ndc_b](http://docs.google.com/File?id=dcfqfqs2_2gfcb5ndc_b)

# c# - DataTable 是否比 List 消耗更多内存 ?

> ID：275269
> 
> 赞同：10
> 
> 时间：2008-11-08T21:58:36.207
> 
> 标签：c#, performance, data-structures

是否在性能方面进行权衡，在内存消耗方面进行权衡？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-08T22:00:50.400

是的，DataTable 绝对比 List 消耗更多的内存。

DataTable 类有很多用于列定义的对象、表信息（名称等）、行对象的集合、每行的“项目数组”（基本上是 List 的所有内容）等。

编辑：此外，List 在添加项目、迭代等方面性能更高（反映通用列表的“添加”代码，以及数据表以查看更多详细信息）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-08T22:30:24.897

哦对了，胖了 不过，它可能比 List<> 更有效。它创建一个索引，因此查找可以是 O(1)。行存储在红黑树中，因此插入和删除可以是 O(log n)。对于 List<>，所有这些操作都是 O(n)。要获得这种性能，您必须明智地选择列和查询。与常规数据库表相同的注意事项。

# lisp - 如何选择在 DrScheme 中使用的语言？

> ID：275273
> 
> 赞同：10
> 
> 时间：2008-11-08T21:59:43.553
> 
> 标签：lisp, scheme, racket

我最近下载了 PLT Scheme 和 DrScheme。当我打开 DrScheme 时，我被告知选择一种语言。但是，我对我的任何选项都不熟悉，并且帮助指南并没有真正将其分解以帮助我轻松选择哪个选项。

那么，首先 - DrScheme 和 PLT Scheme 真的是我学习 Lisp 和/或 Scheme 所需的工具吗？如果是这样，有哪些不同的语言以及我应该使用哪些语言？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-08T22:33:42.800

只是去“相当大”。这将是您所需要的一切，直到您知道其余部分的用途。我发现 R5RS 很好，但它确实缺少 PLT 添加到 DrScheme 的扩展。

*编辑：*我刚刚检查过，我猜“Pretty Big”和“R5RS”在 DrScheme 4 中都被认为是“遗留”，而“模块”语言更受青睐。只需确保您使用模块语言的所有文件都以

```
#lang scheme 
```

Module 是一种指定源文件中使用的语言的方法，而不是 DrScheme 解释器全局使用的语言。这意味着您可以将程序的不同部分使用不同的语言，方法是将其分解为文件并在每个文件中指明您正在使用的语言。如果您刚刚开始，您需要担心的只是将#lang 方案保留在您使用的所有文件的顶部。

一个小提示——这个声明不是官方的 Scheme，如果你试图在另一个 Scheme 解释器中使用这些文件，则需要删除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T22:17:44.983

标准（R5RS）是实际的东西，所以这将是你最好的选择
，我从[http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/](http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/)
学习它时 使用了 MIT 方案，
但是否则我发现 plt 更好用

# visual-studio - Vsssc 和 Vssscc 文件 - 对 SVN 有用吗？

> ID：275287
> 
> 赞同：16
> 
> 时间：2008-11-08T22:15:43.770
> 
> 标签：visual-studio, svn

将存储库从 VSS 导入 SVN 后，我猜有些文件可能是 VSS 特定的 - 用于解决方案的 .vsssc 和 .vssscc 文件以及用于项目的 .vspscc 文件。它们似乎与 VSS 项目绑定有关。SVN 也需要（或有用）它们吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-17T21:26:08.010

.vsssc 和 .vspscc 文件包含对保存解决方案/项目的visal sourcesafe 服务器的引用。Subversion 不需要此信息，因为此信息（以及更多信息）存储在工作副本的 .svn 区域中。

对于 .sln 和项目文件中的数据，这取决于您是否使用 AnkhSVN、VisualSVN 或两者都不使用。

AnkhSVN (2.0+) 是一个真正的 SCC 提供商，允许（可选）将项目标记为由 Subversion (/AnkhSVN) 管理。这将像 VSS 一样将类似的 SccXXX 行添加到项目文件中，但会使所有项目都向 AnkhSVN 发送信息。

VisualSVN 不标记项目并尝试自行处理来自颠覆管理区域的所有内容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-08T22:17:38.837

不，不，他们不是

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-08T23:22:03.107

解决方案和项目文件中也有一些杂乱无章的东西。[有关说明，请参阅Alin Constantin](http://alinconstantin.members.winisp.net/webdocs/scc/SccFiles.htm)的这个精彩页面。

# mysql - MYSQL_ROW 和 row[0] 到字符串类型？

> ID：275314
> 
> 赞同：2
> 
> 时间：2008-11-08T22:34:03.983
> 
> 标签：mysql, c, api, c-strings

使用 MYSQL C API 查询结果时。结果作为`MYSQL_ROW`类型返回，根据 MYSQL C API 文档，我可以轻松地`printf("%s", row[0])`. 但是，如果我想将 的内容传输`row[0]`到字符串或 char* 中怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T22:43:51.267

%s 格式应该只接受 char* 所以从你的描述看起来 MYSQL_ROW 真的是一个 char** 并且采用 row[0] 无论如何都会产生一个 char* 。

我看不出使用 sprintf()（或更安全但非标准的 asprintf()）会有什么好处，但如果它能让你感觉更好，你可以考虑一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T22:43:40.157

您可以使用[sprintf()](http://linux.die.net/man/3/sprintf)，但您仍然需要知道 row[0] 中包含的字符串的长度，以便分配足够的内存。

警告：BCS 正确指出，如果 row[0] 包含额外的 nul 字节，您的数据将被截断。如果您知道 row[0] 中存储了多少数据，则使用[memcpy()](http://www.manpagez.com/man/3/memcpy/)可能是更好的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-02T20:35:04.970

> 但是，如果我想将 row[0] 的内容转换成字符串或 char* 怎么办？

用于`mysql_fetch_lengths`确定`MYSQL_ROW`. 因为行中有 1 个或多个列，所以可以有 1 个或多个长度。

根据[27.8.5 C API 数据结构](https://dev.mysql.com/doc/refman/5.7/en/c-api-data-structures.html)文档：

> `MYSQL_ROW`
> 
> 这是一行数据的类型安全表示。它目前被实现为一个计数字节字符串的数组。（如果字段值可能包含二进制数据，则不能将它们视为以空字符结尾的字符串，因为此类值可能在内部包含空字节。）通过调用`mysql_fetch_row()`.

然后，[`mysql_fetch_row`](https://dev.mysql.com/doc/refman/5.7/en/mysql-fetch-row.html)文档给出了这个例子：

```
MYSQL_ROW row;
unsigned int num_fields;
unsigned int i;

num_fields = mysql_num_fields(result);
while ((row = mysql_fetch_row(result)))
{
   unsigned long *lengths;
   lengths = mysql_fetch_lengths(result);
   for(i = 0; i < num_fields; i++)
   {
       printf("[%.*s] ", (int) lengths[i],
              row[i] ? row[i] : "NULL");
   }
   printf("\n");
} 
```

* * *

这是一个使用它来计算表中行数的示例。[该表是根据 FTC 的“禁止致电违规”](https://www.ftc.gov/site-information/open-government/data-sets/do-not-call-data)填充的。

```
MYSQL_RES* res = NULL;
MYSQL row;

const char SELECT_STMT[] = "SELECT COUNT(*) FROM blacklist_ftc";
if (mysql_query(mysql, SELECT_STMT) != 0)
{
    /* handle error */
    goto finish;
}

if ((res = mysql_store_result(s_mysql)) == NULL)
{
    /* handle error */
    goto finish;
}

if (mysql_num_fields(res) != 1 || mysql_num_rows(res) != 1)
{
    /* handle error */
    goto finish;
}

char buf[32];
unsigned long* length;

row = mysql_fetch_row(res);
length = mysql_fetch_lengths(res);

if (row == NULL || length == NULL)
{
    /* handle error */
    goto finish;
}

size_t size = length[0] < sizeof(buf)-1 ? length[0] : sizeof(buf)-1;
memcpy(buf, row[0], size);
buf[size] = '\0';

unsigned long count = (unsigned long)atoi(buf);

finish:

if (res)
{
    mysql_free_result(res);
    res = NULL;
} 
```

# java - Java：将二维字符串数组打印为右对齐表

> ID：275338
> 
> 赞同：3
> 
> 时间：2008-11-08T22:53:56.643
> 
> 标签：java, formatting, printf

将数组的单元格打印为右对齐表格的*最佳方法是什么？*`String[][]`例如，输入

```
{ { "x", "xxx" }, { "yyy", "y" }, { "zz", "zz" } } 
```

应该产生输出

```
 x xxx
yyy   y
 zz  zz 
```

这似乎是使用*应该*能够完成的事情`java.util.Formatter`，但它似乎不允许非常量的字段宽度。最好的答案将使用一些标准方法来填充表格单元格，而不是手动插入空格字符。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-09T00:44:18.183

这是一个答案，对每一列使用动态生成的格式字符串：

```
public static void printTable(String[][] table) {
  // Find out what the maximum number of columns is in any row
  int maxColumns = 0;
  for (int i = 0; i < table.length; i++) {
    maxColumns = Math.max(table[i].length, maxColumns);
  }

  // Find the maximum length of a string in each column
  int[] lengths = new int[maxColumns];
  for (int i = 0; i < table.length; i++) {
    for (int j = 0; j < table[i].length; j++) {
      lengths[j] = Math.max(table[i][j].length(), lengths[j]);
    }
  }

  // Generate a format string for each column
  String[] formats = new String[lengths.length];
  for (int i = 0; i < lengths.length; i++) {
   formats[i] = "%1$" + lengths[i] + "s" 
       + (i + 1 == lengths.length ? "\n" : " ");
 }

  // Print 'em out
  for (int i = 0; i < table.length; i++) {
    for (int j = 0; j < table[i].length; j++) {
      System.out.printf(formats[j], table[i][j]);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-09T00:01:29.940

实际上，如果您为字段指定宽度，它应该是右对齐的。
如果您需要动态填充，最长字符串的最小填充，您必须遍历数组，获取最大宽度，生成具有从该最大值计算的宽度的格式字符串，并将其用于格式化输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T22:56:31.723

找到最长字符串的长度..
用空格填充所有字符串，直到它们达到该长度 + 1
System.out.print 它们使用 2 个嵌套的 for 循环

# javascript - Javascript 反射

> ID：275351
> 
> 赞同：29
> 
> 时间：2008-11-08T23:05:17.213
> 
> 标签：javascript, reflection, closures

有没有办法从内部获取 javascript 对象的所有方法（私有、特权或公共）？这是示例对象：

```
var Test = function() {
// private methods
    function testOne() {}
    function testTwo() {}
    function testThree() {}
// public methods
    function getMethods() {
      for (i in this) {
        alert(i); // shows getMethods, but not private methods
      }
    }
    return { getMethods : getMethods }
}();

// should return ['testOne', 'testTwo', 'testThree', 'getMethods']
Test.getMethods(); 
```

当前的问题是 中的代码`getMethods()`，简化的示例将仅返回公共方法，而不返回私有方法。

**编辑**：我的测试代码可能（或可能不会）使我希望得到的东西过于复杂。给出以下内容：

```
function myFunction() {
  var test1 = 1;
  var test2 = 2;
  var test3 = 3;
} 
```

`myFunction()`有没有办法从内部找出存在哪些变量`myFunction()`。伪代码如下所示：

```
function myFunction() {
  var test1 = 1;
  var test2 = 2;
  var test3 = 3;

  alert(current.properties); // would be nice to get ['test1', 'test2', 'test3']
} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-09T00:59:51.320

隐藏这些方法的技术原因是双重的。

[首先，当您在 Test 对象上执行方法时，“this”将是在包含模块模式](http://yuiblog.com/blog/2007/06/12/module-pattern/)的公共方法的匿名函数末尾返回的无类型对象。

其次，testOne、testTwo 和 testThree 方法不附加到特定对象，并且仅存在于匿名函数的上下文中。您可以将方法附加到内部对象，然后通过公共方法公开它们，但它不会像原始模式那样干净，而且如果您从第三方获取此代码也无济于事。

结果看起来像这样：

```
var Test = function() {
    var private = {
        testOne : function () {},
        testTwo : function () {},
        testThree : function () {}
    };

    function getMethods() {
        for (i in this) {
            alert(i); // shows getMethods, but not private methods
        }
        for (i in private) {
            alert(i); // private methods
        }
    }
    return { getMethods : getMethods }
}();

// will return ['getMethods', 'testOne', 'testTwo', 'testThree']
Test.getMethods(); 
```

**编辑：**

很不幸的是，不行。无法通过单个自动关键字访问局部变量集。

如果您删除“var”关键字，它们将附加到全局上下文（通常是窗口对象），但这是我所知道的唯一与您所描述的行为相似的行为。但是，如果您这样做，该对象上会有很多其他属性和方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-10T16:07:05.993

来自[http://netjs.codeplex.com/SourceControl/changeset/view/91169#1773642](http://netjs.codeplex.com/SourceControl/changeset/view/91169#1773642)

```
//Reflection

~function (extern) {

var Reflection = this.Reflection = (function () { return Reflection; });

Reflection.prototype = Reflection;

Reflection.constructor = Reflection;

Reflection.getArguments = function (func) {
    var symbols = func.toString(),
        start, end, register;
    start = symbols.indexOf('function');
    if (start !== 0 && start !== 1) return undefined;
    start = symbols.indexOf('(', start);
    end = symbols.indexOf(')', start);
    var args = [];
    symbols.substr(start + 1, end - start - 1).split(',').forEach(function (argument) {
        args.push(argument);
    });
    return args;
};

extern.Reflection = extern.reflection = Reflection;

Function.prototype.getArguments = function () { return Reflection.getArguments(this); }

Function.prototype.getExpectedReturnType = function () { /*ToDo*/ }

} (this); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T23:35:54.123

Javascript 并没有真正的私有概念。因此，javascript 本身没有反射 API。您使用的技术并没有使它们变得私有，而是使它们无法访问；它们是隐藏的，不是私人的。我认为您可以通过手动将这些方法放在某处来管理某些事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T23:58:06.123

您的测试代码的部分问题在于 Test 是您的 return 语句创建的对象：“ `{ getMethods : getMethods }`”它没有 testOne、testTwo 或 testThree 方法；相反，它们仅在与原始 getMethods 函数相同的命名空间中可用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T21:54:06.733

你可以使用`var that = this;`技巧：

```
var Test = function() {
    var that = this;
    function testOne() {}
    function testTwo() {}
    function testThree() {}
    function getMethods() {
      for (i in that) {
        alert(i);
      }
    }
    return { getMethods : getMethods }
}(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-16T12:56:59.337

对函数的定义方式稍作改变，您就可以实现您想要的。将函数的实际实现包装在一个对象字面量中，它看起来像这样：

```
(function() {
    var obj = {
    // private methods
    testOne: function () {},
    testTwo : function () {},
    testThree: function () {},
    // public methods
    getMethods : function () {
      for (i in this) {
        alert(i); // shows getMethods, but not private methods
      }
    }
    };
    return { getMethods : function(){return obj.getMethods();} }
})(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-08T23:21:57.303

如果你这样调用 getMethods() ，它不是静态的吗？当然，您需要正确初始化课程`this`才能按预期工作？

```
var t = new Test();
t.getMethods(); 
```

如果这不起作用，请查看[JS Serializer](http://www.iconico.com/workshop/jsSerializer/)。我前一段时间用它进行了一些调试，我认为它适用于私有变量。

# c++ - C++ 读取文件标记

> ID：275355
> 
> 赞同：5
> 
> 时间：2008-11-08T23:13:25.167
> 
> 标签：c++, file, token

另一个请求对不起..现在我正在一个一个地阅读令牌并且它有效，但我想知道什么时候有新行..

如果我的文件包含

```
Hey Bob
Now 
```

应该给我

```
Hey
Bob
[NEW LINE]
NOW 
```

有没有办法在不使用 getline 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-09T00:16:54.883

是的，运算符>> 与字符串一起使用时读取“空格”分隔的单词。“空白”包括空格制表符和换行符。

如果您想一次读取一行，请使用 std::getline()
然后可以使用字符串流单独标记该行。

```
std::string   line;
while(std::getline(std::cin,line))
{

    // If you then want to tokenize the line use a string stream:

    std::stringstream lineStream(line);
    std::string token;
    while(lineStream >> token)
    {
        std::cout << "Token(" << token << ")\n";
    }

    std::cout << "New Line Detected\n";
} 
```

小补充：

## 不使用 getline()

所以你真的希望能够检测到换行符。这意味着换行符成为另一种类型的令牌。所以让我们假设你有用“空格”分隔的单词作为标记，换行符作为它自己的标记。

然后你可以创建一个 Token 类型。
然后你所要做的就是为一个令牌编写流操作符：

```
#include <iostream>
#include <fstream>

class Token
{
    private:
        friend std::ostream& operator<<(std::ostream&,Token const&);
        friend std::istream& operator>>(std::istream&,Token&);
        std::string     value;
};
std::istream& operator>>(std::istream& str,Token& data)
{
    // Check to make sure the stream is OK.
    if (!str)
    {   return str;
    }

    char    x;
    // Drop leading space
    do
    {
        x = str.get();
    }
    while(str && isspace(x) && (x != '\n'));

    // If the stream is done. exit now.
    if (!str)
    {
        return str;
    }

    // We have skipped all white space up to the
    // start of the first token. We can now modify data.
    data.value  ="";

    // If the token is a '\n' We are finished.
    if (x == '\n')
    {   data.value  = "\n";
        return str;
    }

    // Otherwise read the next token in.
    str.unget();
    str >> data.value;

    return str;
}
std::ostream& operator<<(std::ostream& str,Token const& data)
{
    return str << data.value;
}

int main()
{
    std::ifstream   f("PLOP");
    Token   x;

    while(f >> x)
    {
        std::cout << "Token(" << x << ")\n";
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-10T04:26:28.920

不知道你为什么觉得`std::getline`不好。您仍然可以识别换行符。

```
std::string token;
std::ifstream file("file.txt");
while(std::getline(file, token)) {
    std::istringstream line(token);
    while(line >> token) {
        std::cout << "Token :" << token << std::endl;
    }
    if(file.unget().get() == '\n') {
        std::cout << "newline found" << std::endl;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T11:56:53.503

这是我在标记字符串时遇到的另一种很酷且不那么冗长的方法。

```
vector<string> vec; //we'll put all of the tokens in here 
string token;
istringstream iss("put text here"); 

while ( getline(iss, token, '\n') ) {
       vec.push_back(token);
} 
```

# php - 只允许某些网站访问 PHP 页面

> ID：275374
> 
> 赞同：2
> 
> 时间：2008-11-08T23:30:01.483
> 
> 标签：php

我正在尝试为我的网站制作一个基本的 API，以便我批准的某些其他网站可以显示我网站中的内容。我的服务器上有一个 PHP 脚本，其他网站可以访问它以提取 XML 格式的内容。如何确保只有某些网站可以访问我服务器上的这个 php 页面？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-08T23:32:46.160

大多数需要类似“身份验证”的 API 都选择 API 密钥。只是一个在请求中传递的大长字符串。

您可以通过解析域的 IP 并检查传入请求来加强这一点。这是缓慢且昂贵的，因此缓存 IP 查找（但请确保在域 IP 合法更改时清除它们！）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-08T23:35:25.640

使用 .htaccess 仅允许通过 IP 地址的特定用户非常简单。

通常你用它来阻止像这样的特定IP地址

```
Order allow, deny
Deny from 192.168.0.10
Deny from 212.155.
Deny from 1.2.3.4  5.6.7.8 127.0.0.1
Allow from all 
```

但是您也可以使用它来只允许特定用户的访问，就像这样

```
Deny from all
Allow from 1.2.3.4 
```

**编辑：** 如果您绝对需要从脚本中执行此操作（在仔细阅读您的问题后，我认为您会这样做），那么您可以这样做。

```
<?
    $allowed[0]="xxx.xxx.xxx.xxx";
    $allowed[1]="yyy.yyy.yyy.yyy";

    // add as many as you need

    if (!in_array($_SERVER['REMOTE_ADDR'],$allowed)) header("HTTP/1.1 403 Forbidden");
?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T23:39:00.030

一个简单的选择是将页面放入一个目录，然后打开基本的 HTTP 身份验证。您将向您希望能够访问内容的人颁发用户名和密码。

一个 url 可以将用户名和密码编码为： [http://username:password@hostname/](http://username:password@hostname/) ...

这样，除了修改 .htaccess 文件或远程端之外，您不需要进行任何更改，除了指定稍微不同的 url。

用户名和密码通过互联网以明文形式传递，因此您需要确定这是否是可接受的风险。

# c++ - 在 Xcode 中检查 STL 容器

> ID：275375
> 
> 赞同：7
> 
> 时间：2008-11-08T23:30:13.870
> 
> 标签：c++, xcode, debugging, macos, stl

从谷歌搜索来看，Xcode（在我的例子中是 3.1）至少应该试图给我一个 STL 容器的合理调试视图——或者至少是向量。

然而，每当我在调试器中查看向量时，我只会看到 M_impl，以及 M_start 和 M_finish 成员（以及其他几个成员）——但中间没有任何内容！（顺便说一句，这是一个调试版本）。

我是否缺少设置或某处的东西？

我还读到有可用的宏可以进一步增强调试查看器以检查更复杂的容器-但找不到任何宏。

我还希望能够查看 std::wstrings，而不必进入内存查看器。它显示 std::string 很好。我能做些什么来显示 std::wstring 吗？

我意识到这是一个复杂的问题——但实际上都是同一个主题的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T23:37:08.287

您可以为不同的变量类型创建[数据格式化程序](https://web.archive.org/web/20090812202145/http://developer.apple.com/documentation/DeveloperTools/Conceptual/XcodeDebugging/600-Viewing_Variables_and_Memory/variables_and_memory.html)，以便它们显示得更好:-)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T00:08:39.813

查看容器项目的能力可能取决于模板类型的复杂性。对于 int、bool 等琐碎的对象，甚至是简单的类模板，如

```
template <class T> struct S { T m_t; } 
```

在调试器变量视图中查看矢量项*通常*没有问题。我之所以这么说，是因为似乎偶尔会出现导致某些问题的错误——尤其是在调试时——不符合我的预期。其中之一是变量视图中的垃圾或完全无用的信息。通常对目标进行干净的重建（或者有时甚至更剧烈地重新启动 XCode，然后进行干净的重建）可以解决问题。

至于其他容器类型，很可能很难有效地查看这些信息。例如，地图通常被实现为红黑树。调试器必须提前知道这一点，以便正确地遍历树并向您显示所有键和值。这可能对 Xcode 或 GDB 提出了很多要求——尤其是因为前者更关注 Objective-C 和纯 C 而不是 C++（因此，尽管名称空间无处不在且很重要，但它们往往会扼杀代码完成）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T09:53:32.477

尝试在 Project->Edit Scheme... 中使用 GDB 调试器，并考虑在 Project Build Settings 中将编译器切换到 LLVM GCC 4.2（在 Build Options -> Compiler for C/C++/Objective-C 下）。

在 XCode 4 中，我发现我需要这些设置来查看 V3f 的 std::vector 之类的东西，其中 V3f 是模板化的浮点向量类型。

请注意，我认为您不能将 ARC（自动引用计数）与 LLVM GCC 4.2 一起使用。

# iis - IIS 多域重定向

> ID：275382
> 
> 赞同：3
> 
> 时间：2008-11-08T23:37:31.623
> 
> 标签：iis

我目前有 2 个域名，我想为其设置不同的网站。我目前正在考虑使用一些可以很好地满足我当前需求的免费托管，但没有给我任何将“mydomain.com”指向实际站点的方法。相反，我必须给用户一个更长、更难记住的 url。

我提出的解决方案是将我的域指向我的家庭 ip，并通过 IIS 托管一个小型 ASP.NET 应用程序，该应用程序由一个重定向页面组成，该页面简单地重定向到适当的站点。ASP.NET 中有没有一种方法可以识别请求的域 url 以便知道将页面重定向到哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T22:13:17.100

这是一种方法（如果您托管多个域，则由 1and1.com 推荐）。把它放在你的网络空间的根目录下。您的所有网站都将指向此根。下面的脚本会将请求转发到正确的子文件夹。这是一种 hack，但如果您无法完全控制 IIS 设置，这将起作用。

将此文件命名为 default.asp：

```
<%EnableSessionState=False

host = Request.ServerVariables("HTTP_HOST")

if host = "website1.com" or host = "www.website1.com" then
response.redirect("http://website1.com/website1/default.aspx")

elseif host = "website2.com" or host = "www.website2.com" then
response.redirect("http://website2.com/website2/default.aspx")

else
response.redirect("http://website1.com/")

end if
%> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T23:50:54.110

从 asp.net 代码中，您可以从请求对象访问主机：

```
if(Request.Url.Authority == "www.site1.com")
    Response.Redirect(...); 
```

如果您可以访问 IIS 服务器，您还可以设置两个具有不同绑定主机名的站点，并根据需要进行每个重定向。

# file-io - Linux 内核模块中的文件 I/O

> ID：275386
> 
> 赞同：21
> 
> 时间：2008-11-08T23:47:05.257
> 
> 标签：file-io, linux-kernel, kernel-module

我正在编写一个需要打开和读取文件的 Linux 内核模块。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-11-09T00:33:24.850

请问您为什么要打开文件？

我喜欢关注 Linux 开发（出于好奇，我不是内核开发人员，我做的是 Java），而且我之前也看到过关于这个问题的讨论。我能够找到关于此的[LKML 消息](http://lkml.indiana.edu/hypermail/linux/kernel/0005.3/0061.html)，基本上提到这通常是一个坏主意。我几乎肯定 LWN 在去年报道过它，但我很难找到这篇文章。

如果这是一个私有模块（例如某些自定义硬件并且该模块不会分发），那么您可以这样做，但我的印象是，如果您要将代码提交到主线，那么它可能不会被接受。

Evan Teran 提到了 sysfs，这对我来说似乎是个好主意。如果你真的需要做更难的自定义东西，你总是可以制作新的 ioctrls。

编辑：

好的，我找到了我要找的文章，它来自[Linux Journal](http://www.linuxjournal.com/article/8110)。它解释了为什么做这种事情通常是一个坏主意，然后继续告诉你到底该怎么做。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-09T00:07:50.830

假设您可以获得指向系统调用的相关函数指针的指针`open`，您可以执行以下操作`read`：`close`

```
mm_segment_t fs = get_fs();
set_fs(KERNEL_DS);

fd = (*syscall_open)(file, flags, mode);
if(fd != -1) {
    (*syscall_read)(fd, buf, size);
    (*syscall_close)(fd);
}
set_fs(fs); 
```

您将需要创建`syscall_*`我已经显示的“”函数指针。我相信有更好的方法，但我相信这会奏效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-09T11:44:44.963

一般来说，如果您需要从内核模块读取/写入文件，那么您在架构上做错了事。

存在允许内核模块与用户空间助手进程对话的机制（例如 netlink - 或只是注册字符设备）。该用户空间助手进程可以为所欲为。

您还可以实现系统调用（或类似的调用）来获取在用户空间中打开的文件描述符并从内核读取/写入它。

这可能比尝试在内核空间中打开文件更简洁。

还有一些其他的东西已经从内核空间打开了文件，你可以看看它们（循环驱动程序浮现在脑海中？）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-13T13:55:58.437

/proc 文件系统也适合私人使用，而且很容易。
[http://www.linuxtopia.org/online_books/Linux_Kernel_Module_Programming_Guide/x773.html](http://www.linuxtopia.org/online_books/Linux_Kernel_Module_Programming_Guide/x773.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-12-04T23:25:56.273

所有内核开发人员都说来自内核空间的文件 I/O 很糟糕（特别是如果您通过它们的路径引用这些文件），但主流内核在您加载固件时会这样做。如果您只需要从文件中读取，请使用

```
kernel_read_file_from_path(const char *path, void **buf, loff_t *size, loff_t max_size, enum kernel_read_file_id id) 
```

函数，这是固件加载程序代码使用的，在`include/linux/fs.h`. 此函数在出错时返回负值。

我不太确定最后`id`变量的意义，如果你看一下它并没有真正使用的代码，所以只要放一些类似的东西`READING_FIRMWARE`（没有引号）。

`buf`不是以 null 结尾的，而是在`size`. 如果您需要它以空值终止，请创建一个`size + 1`字节长的字符串并将其复制或重写该`kernel_read_file()`函数（由 使用`kernel_read_file_from_path()`，在 中定义）并在分配内存的位置`fs/exec.c`添加一个。`i_size`（如果你想这样做，你可以`kernel_read_file()`在你的模块中用不同的函数名重新定义函数，以避免修改整个内核。）

如果您需要写入文件，则有一个`kernel_write()`函数（类似于`kernel_read()`，由 使用`kernel_read_file()`，因此也由使用`kernel_read_file_from_path()`），但没有`kernel_write_file()`or`kernel_write_file_from_path()`函数。您可以查看`fs/exec.c`Linux 内核源代码树中文件中的代码`kernel_read_file()`，其中`kernel_read_file_from_path()`定义了您自己的代码`kernel_write_file()`和`kernel_write_file_from_path()`可以包含在模块中的函数。

和往常一样，您可以使用此函数通过强制转换将文件的内容存储在 char 指针而不是 void 指针中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-09T00:11:05.363

您还可以在此[Linux 内核模块编程指南](http://tldp.org/LDP/lkmpg/2.6/html/lkmpg.html#AEN976)中找到有关 sys_call_open 的一些信息。

# php - 如何在 Windows 环境中测试 Linux 服务器？

> ID：275399
> 
> 赞同：2
> 
> 时间：2008-11-09T00:11:02.790
> 
> 标签：php, eclipse, virtualization

我有一个 Ubuntu 服务器（安装了所有 LAMP 和 Subversion）。我将 Eclipse 与 Subclipse、PDT 和其他一些出色的插件一起使用，并专门使用它们来开发应用程序。我遇到的问题是我正在 Windows Vista 机器上开发并将所有内容传输到远程 Linux 服务器。

但是，为 windows 开发和为 Linux 机器开发是完全不同的。一个示例是 Windows 服务器上 settings.ini 文件或 httpd.conf 文件中所需的撇号/引号。我尝试安装 XAMPP 并让 Eclipse 调试器以这种方式工作，但工作量太大，当我将代码移到服务器上时，我需要不断地更改代码。我也尝试过使用 Wubi，但不喜欢每次我想回到 Vista 时都必须重新启动。

这种情况有解决办法吗？有没有办法在 Windows Vista 上运行 Linux 的虚拟副本，允许我安装 LAMP 并通过 Eclipse 进行调试？是否有更好的 Eclipse 程序允许我使用内部服务器调试我的代码？

我正在寻找一些非常便宜的东西，因为我在上大学，因此资金不足，但我绝对愿意接受任何和所有的解决方案来帮助我。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-09T00:12:44.517

您可以使用 VMWare 或 Virtual PC 来虚拟化 linux 构建，或在[Cygwin](http://www.cygwin.com/)中运行 AMP 堆栈。在架构上，Cygwin 是 glibc 的一个端口，适用于位于 Windows 系统调用层之上——它在 Windows 之上提供了一个类 unix 系统。您可以在其上安装大量的移植软件，包括 AMP 堆栈。

**编辑：**只是为了添加另一个好的软件；[VirtualBox](http://virtualbox.org/wiki/Editions)可免费供个人或评估使用，部分开源，稳定，由 Sun 发布。我发现它是 VMWare 或 Virtual PC 的可靠替代品。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T00:22:20.600

我同意 NXC 的回答 (+1 ;) )，这是[使用 VMware Server 在 Windows XP 上安装 Linux](http://cmsproducer.com/Ubuntu-Linux-Windows-VMware-Server)的实用程序。

这样，您将能够直接在目标平台上部署服务器文件，但仍然可以从 Widows eclipse 会话中进行调试。

[![替代文字](https://i.stack.imgur.com/enunp.gif)](https://i.stack.imgur.com/enunp.gif)
[（来源：[cmsproducer.com](http://cmsproducer.com/files/ubuntu-linux-vmware-windows.gif)）]

# c++ - 在 C++ 中拆分字符串

> ID：275404
> 
> 赞同：8
> 
> 时间：2008-11-09T00:16:27.630
> 
> 标签：c++, string, token

如何在 C++ 中将字符串拆分为标记？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-09T00:26:22.307

这对我来说很好用:)，它把结果放在`elems`. `delim`可以是任何`char`.

```
std::vector<std::string> &split(const std::string &s, char delim, std::vector<std::string> &elems) {
    std::stringstream ss(s);
    std::string item;
    while(std::getline(ss, item, delim)) {
        elems.push_back(item);
    }
    return elems;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-09T07:13:08.850

有了这个包含 Boost 的[Mingw 发行版：](http://nuwen.net/mingw.html#download)

```
#include <iostream>
#include <string>
#include <vector>
#include <iterator>
#include <ostream>
#include <algorithm>
#include <boost/algorithm/string.hpp>
using namespace std;
using namespace boost;

int main() {
    vector<string> v;
    split(v, "1=2&3=4&5=6", is_any_of("=&"));
    copy(v.begin(), v.end(), ostream_iterator<string>(cout, "\n"));
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-09T06:20:33.357

您可以使用 C 函数[strtok](http://www.cplusplus.com/reference/clibrary/cstring/strtok.html)：

```
/* strtok example */
#include <stdio.h>
#include <string.h>

int main ()
{
  char str[] ="- This, a sample string.";
  char * pch;
  printf ("Splitting string \"%s\" into tokens:\n",str);
  pch = strtok (str," ,.-");
  while (pch != NULL)
  {
    printf ("%s\n",pch);
    pch = strtok (NULL, " ,.-");
  }
  return 0;
} 
```

[Boost Tokenizer](http://www.boost.org/doc/libs/1_37_0/libs/tokenizer/index.html)也可以完成这项工作：

```
#include<iostream>
#include<boost/tokenizer.hpp>
#include<string>

int main(){
   using namespace std;
   using namespace boost;
   string s = "This is,  a test";
   tokenizer<> tok(s);
   for(tokenizer<>::iterator beg=tok.begin(); beg!=tok.end();++beg){
       cout << *beg << "\n";
   }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-09T00:22:23.110

尝试使用字符串流：

```
std::string   line("A line of tokens");
std::stringstream lineStream(line);

std::string token;
while(lineStream >> token)
{
} 
```

看看我对你最后一个问题的回答：
[C++ Reading file Tokens](https://stackoverflow.com/questions/275355/c-reading-file-tokens#275405)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-09T10:37:52.620

另请参阅[字符串算法库中的 boost::split](http://www.boost.org/doc/libs/1_37_0/doc/html/string_algo/reference.html#header.boost.algorithm.string.split_hpp)

```
string str1("你好 abc-*-ABC-*-aBc 再见");
矢量<字符串> 标记；
boost::split(tokens, str1, boost::is_any_of("-*"));
// 标记 == { "hello abc","ABC","aBc goodbye" }

```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-09T00:21:50.663

这取决于令牌分隔符的复杂程度以及是否有多个。对于简单的问题，只需使用 std::istringstream 和 std::getline。对于更复杂的任务，或者如果您想以符合 STL 的方式迭代令牌，请使用 Boost 的 Tokenizer。另一种可能性（尽管比这两个更混乱）是设置一个 while 循环，该循环调用 std::string::find 并将最后找到的标记的位置更新为搜索下一个标记的起点。但这可能是 3 个选项中最容易出错的一个。

# php - PHP 输出显示带有问号的黑色小菱形

> ID：275411
> 
> 赞同：86
> 
> 时间：2008-11-09T00:21:55.590
> 
> 标签：php, encoding, character-encoding

我正在编写一个从数据库源中提取的 php 程序。一些 varchars 的引号显示为带有问号的黑色菱形（�，[REPLACEMENT CHARACTER](http://www.fileformat.info/info/unicode/char/fffd/index.htm)，我假设来自 Microsoft Word 文本）。

如何使用 php 去除这些字符？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-11-09T00:51:36.187

如果您看到该字符（� U+FFFD "REPLACEMENT CHARACTER"），通常意味着文本本身以某种形式的单字节编码进行编码，但以其中一种 unicode 编码（UTF8 或 UTF16）进行解释。

如果它是相反的方式，它（通常）看起来像这样：Ã¤。

可能原始编码是 ISO-8859-1，也称为 Latin-1。您可以在不更改脚本的情况下检查这一点：浏览器为您提供了以不同编码重新解释页面的选项——在 Firefox 中使用“视图”->“字符编码”。

要使浏览器使用正确的编码，请添加如下 HTTP 标头：

```
header("Content-Type: text/html; charset=ISO-8859-1"); 
```

或将编码放在元标记中：

```
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
```

或者，您可以尝试以另一种编码（最好是 UTF-8）从数据库中读取或使用[`iconv()`](http://php.net/manual/function.iconv.php).

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2013-02-28T14:35:00.553

我也遇到过这个问题。与此同时，我遇到了三种情况：

1.  **substr()**

    我正在使用`substr()`一个 UTF8 字符串来剪切 UTF8 字符，因此剪切的字符无法正确显示。改为使用`mb_substr($utfstring, 0, 10, 'utf-8');`。[学分](https://stackoverflow.com/questions/9087502/php-substr-function-with-utf-8-leaves-marks-at-the-end)

2.  **htmlspecialchars()**

    另一个问题是`htmlspecialchars()`在 UTF8 字符串上使用。解决方法是使用：`htmlspecialchars($utfstring, ENT_QUOTES, 'UTF-8');`

3.  **preg_replace()**

    最后我发现这`preg_replace()`可能会导致 UTF 出现问题。例如，代码`$string = preg_replace('/[^A-Za-z0-9ÄäÜüÖöß]/', ' ', $string);`将 UTF 字符串“F(×)=2×-3”转换为“F � 2�”。解决方法是[`mb_ereg_replace()`](http://php.net/manual/en/function.mb-ereg-replace.php)改用。

我希望这些额外的信息将有助于摆脱这些问题。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2008-11-09T00:52:00.913

这是一个字符集问题。因此，它可能在许多不同的级别上出错，但最有可能的是，数据库中的字符串是 utf-8 编码的，并且您将它们呈现为 iso-8859-1。或者反过来。

解决此问题的正确方法是正确设置字符集。由于您使用的是 PHP，因此最简单的策略是在整个应用程序中使用 iso-8859-1。为此，您必须确保：

*   所有 PHP 源文件都保存为 iso-8859-1（不要与 cp-1252 混淆）。
*   您的网络服务器配置为提供文件`charset=iso-8859-1`
*   或者，您可以覆盖 PHP 文档中的网络服务器设置，使用[`header`](http://docs.php.net/manual/en/function.header.php).
*   此外，您*可以*在 HTML 中插入一个元标记，指定相同的内容，但这不是严格需要的。
*   您*还可以*在元素上指定`accept-charset`属性。`<form>`
*   数据库表定义为 latin1 编码
*   PHP to和数据库之间的数据库连接设置为latin1

如果您的数据库中已经有数据，您应该知道它们可能已经搞砸了。如果您尚未处于生产阶段，只需将其全部擦除并重新开始。否则你将不得不做一些数据清理。

### 关于元标签的注释，因为每个人都误解了它们是什么：

当网络服务器提供文件（HTML 文档）时，它会发送一些信息，这些信息不会直接显示在浏览器中。这称为 HTTP 标头。一个这样的标头是`Content-Type`标头，它指定文件的 mimetype（例如`text/html`）以及编码（又名字符集）。虽然大多数网络服务器会发送`Content-Type`带有`charset`信息的标头，但它是可选的。如果它不存在，浏览器将改为解释任何带有`http-equiv="Content-Type"`. 重要的是要意识到元标记**仅**在网络服务器不发送标头时才被解释。实际上，这意味着它仅在页面保存到磁盘然后从那里打开时才使用。

[这个页面](http://www.phpwact.org/php/i18n/charsets)对这些事情有很好的解释。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-08-16T16:28:16.107

正如前面的答案中提到的，这是因为您的文本已以`iso-8859-1`编码或任何其他格式写入数据库。

所以你只需要`utf8`在输出之前将数据转换为。

```
$text = “string from database”;
$text = utf8_encode($text);
echo $text; 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-04-05T06:28:58.547

为确保您的 MYSQL 连接设置为 UTF-8（或 latin1，具体取决于您使用的内容），您可以执行以下操作：

```
$con = mysql_connect("localhost","username","password");    
mysql_set_charset('utf8',$con); 
```

或使用它来检查您使用的字符集：

```
$con = mysql_connect("localhost","username","password");   
$charset = mysql_client_encoding($con);
echo "The current character set is: $charset\n"; 
```

更多信息在这里： http: [//php.net/manual/en/function.mysql-set-charset.php](http://php.net/manual/en/function.mysql-set-charset.php)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-05-06T16:47:59.743

只需将此代码粘贴到页面顶部即可。

```
<?php
header("Content-Type: text/html; charset=ISO-8859-1");
?> 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-11-09T01:19:08.033

根据您对问题的描述，您的数据库中的数据几乎肯定被编码为[Windows-1252](http://en.wikipedia.org/wiki/Windows-1252)，并且您的页面几乎肯定被提供为[ISO-8859-1](http://en.wikipedia.org/wiki/ISO/IEC_8859-1)。这两个字符集是等效的，只是 Windows-1252 有 16 个额外的字符，这些字符在 ISO-8859-1 中不存在，包括左弯引号和右弯引号。

假设我的分析是正确的，最简单的解决方案是将您的页面作为 Windows-1252 提供。这将起作用，因为 ISO-8859-1 中的所有字符也在 Windows-1252 中。在 PHP 中，您可以按如下方式更改编码：

```
header('Content-Type: text/html; charset=Windows-1252'); 
```

但是，您确实应该检查您在 HTML 文件中使用的字符编码和数据库的内容，并注意保持一致，或者在不可能的情况下正确转换。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-07-29T02:41:24.290

我选择通过这样做从字符串中删除这些字符 -

```
ini_set('mbstring.substitute_character', "none"); 
$text= mb_convert_encoding($text, 'UTF-8', 'UTF-8'); 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-01-17T11:16:58.327

将此函数添加到您的变量 utf8_encode($your variable);

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-10-08T17:21:19.010

这将对您有所帮助。把这个放在`<head>`标签里面

```
<meta charset="iso-8859-1"> 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-10-06T07:58:36.787

请试试这个

mb_substr($description, 0, 490, "UTF-8");

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-09T00:26:31.010

这可能是由 unicode 或其他字符集不匹配引起的。尝试在浏览器中更改字符集，在设置中文本看起来不错。然后是如何将数据库内容转换为用于显示的字符集的问题。（实际上可以只是将 utf-8 字符集语句添加到您的输出中。）

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-01-03T20:03:09.437

这恰好在我的情况下起作用：

```
$text = utf8_decode($text) 
```

我将黑色菱形字符变成问号，以便您可以：

```
$text = str_replace('?', '', utf8_decode($text)); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-09-07T15:30:39.787

在我修复我的表之后我最终做的是备份它并将设置更改回 utf-8 然后我更改了我的转储文件，以便默认字符集 utf8 排序 utf8_general_ci 是我的字符集条目

现在我没有字符集问题了，因为数据库和浏览器是 utf8。

我弄清楚是什么原因造成的。这是对数据库的网页+浏览器效果。在 linux (ubuntu+firefox) 的终端上，它在 latin1 中对数据库进行编码，这就是 tabes 的设置。但在 windows 10+edge 终端上，条目被强制编码为 utf8。此外，我注意到 Windows 10 存在与 latin1 保持一致的问题，因此我决定随风而行，将所有内容都转换为 utf8。

我认为这是 Windows 10 的问题，因为我们开始使用 win 10 终端。所以微软的错误再次导致问题。我仍然不知道为什么表单上的编码会发生变化，因为 Windows 10 中的浏览器显示 latin1 字符集，但是当它进入 utf8 编码时，我得到数据异常。但在 linux+firefox 中它不会那样做。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-03-15T05:13:03.417

只需在标题之前添加这些行。

`.doc/docx`将检索文件的准确格式：

```
 if(ini_get('zlib.output_compression'))

   ini_set('zlib.output_compression', 'Off');
 ob_clean(); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-06-07T10:25:02.080

当您从任何地方提取数据时，您应该使用带有前缀的函数`md_FUNC_NAME`。

有同样的问题，它帮助了我。

或者您可以找到该符号的代码并使用正则表达式删除这些符号。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-09T11:05:13.547

您还可以更改浏览器中的字符集。只是出于调试原因。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-06-22T15:12:11.977

在数据库和 HTML 中使用相同的字符集（如这里所建议的）对我来说不起作用......所以记住代码是作为 HTML 生成的，我选择使用`&quot;`(HTML code) 或`&#34;`(ISO Latin-1代码）在我的数据库文本中使用引号。这解决了问题，同时为我提供了一个引号。奇怪的是，在此解决方案之前，只有一些引号和撇号没有正确显示，而另一些则显示正确，但是，特殊代码在所有情况下都有效。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-09-05T22:26:50.043

我在 phpmyadmin 中的排序规则更改后运行了“检测编码”代码，现在它显示为 Latin_1。

但这是我在我的应用程序中发现不同的数据异常以及我如何修复它时遇到的问题：

我刚刚导入了一个混合编码的表（在某些行中带有菱形问号，并且都在同一列中。）所以这是我的修复代码。我使用了 utf8_decode 过程，它采用未定义的占位符并在“菱形问号”的位置分配一个普通的问号，然后我使用 str_replace 用引号之间的空格替换问号。这是[代码]

```
 include 'dbconnectfile.php';

  //// the variable $db comes from my db connect file
   /// inx is my auto increment column
   /// broke_column is the column I need to fix

      $qwy = "select inx,broke_column from Table ";
      $res = $db->query($qwy); 

      while ($data = $res->fetch_row()) {
      for ($m=0; $m<$res->field_count; $m++) {
           if ($m==0){ 
           $id=0;
           $id=$data[$m];
       echo $id;
           }else if ($m==1){ 
             $fix=0;
             $fix=$data[$m];

             $fix = utf8_decode($fix);
             $fixx =str_replace("?"," ",$fix);

        echo $fixx;

        ////I echoed the data to the screen because I like to see something as I execute it :)
            }
            }
         $insert= "UPDATE Table SET broke_column='".$fixx."'  where inx='".$id."'";
          $insresult= $db->query($insert);
      echo"<br>";
        }

        ?> 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-03-24T13:42:07.183

出于全球目的。

而不是转换、编码、解码每个文本，我更喜欢让它们保持原样，而是更改服务器 php 设置。所以，

1.  让钻石

2.  在浏览器中，在视图菜单上选择“文本编码”并找到可以让您正确查看文本的那个。

3.  编辑您的 php.ini 并添加：

    `default_charset = "ISO-8859-1"`

或者代替 ISO-8859 适合您的文本编码的一种。

* * *

## 回答 #21

> 赞同：-3
> 
> 时间：2017-08-26T16:31:29.383

转到您的 phpmyadmin 并选择您的数据库，只需将该表字段的长度/值增加到 500 或 1000 即可解决您的问题。

# asp.net-mvc - 在 ASP.NET MVC 中实现模态对话框

> ID：275415
> 
> 赞同：2
> 
> 时间：2008-11-09T00:24:23.123
> 
> 标签：asp.net-mvc, ajax

任何人都有使用 AJAX 和 ASP.NET MVC 创建模式对话框的经验吗？我希望在用户删除项目时创建一个是/取消确认对话框。在标准 ASP.NET 中，我可以只使用 ModalPopup 扩展器，但我不确定如何在 MVC 中执行此操作。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-09T01:49:45.977

jQuery的[SimpleModal](http://www.ericmmartin.com/projects/simplemodal/)怎么样？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-18T14:40:46.863

我发现[jqModal](http://dev.iceburg.net/jquery/jqModal/) [for jQuery] 非常容易使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-13T23:22:22.343

我喜欢[jQueryUI中的对话框](http://jqueryui.com/demos/dialog/)

使用方便，干净。

# asp.net - 在 ASP.NET 应用程序中实现语言菜单的最佳方式

> ID：275421
> 
> 赞同：1
> 
> 时间：2008-11-09T00:26:35.147
> 
> 标签：asp.net, localization, master-pages, globalization

我试图实现一个典型的语言菜单，用户可以通过出现在网站所有页面中的菜单来选择他们想要查看网站的语言。

该菜单将出现在多个母版页上（当前一个用于用户登录的页面，一个用于用户未登录的页面）。

我当前的实现是有一个单一的母版页基类（我们称之为 MasterBase）。MasterBase 有活动

```
public event LanguageChangedEventHandler LanguageChanged; 
```

其中 LanguagedChangedEventHandler 被简单地定义为

```
public delegate void LanguageChangedEventHandler(string NewCulture); 
```

MasterBase 也有一个可覆盖的方法

```
protected virtual void OnLanguageChanged(string NewCulture) 
```

这基本上会触发事件。

继承 MasterBase 的每个母版页都会覆盖 OnLanguageChanged 并执行通常的操作，例如设置线程的 CurrentUICulture 和语言 cookie 然后执行

```
Server.Transfer(this.Page.AppRelativeVirtualPath, true); 
```

让页面重新加载新文化的本地化值。在登录用户的母版页上，它还会更新数据库中用户的语言首选项。

每个语言选项当前都是从 MasterBase 继承的母版页上的 LinkBut​​ton。单击链接时，它会调用基本 OnLanguagedChanged 方法，传入正确的文化信息。例如

```
protected void btnEnglish_Click(object sender, EventArgs e) {
    this.OnLanguageChanged("en-US");
    } 
```

每个需要处理语言更改的页面在页面加载中都有一些代码，看起来像......

```
((MasterBase)this.Master).LanguageChanged += this.Page_OnLanguageChanged;
// Where Page_OnLanguageChanged has the signature of LanguageChangedEventHandler
// and has stuff like reloading options in a drop down using the new language. 
```

相当复杂的“框架”=）

1.  首先，新开发人员很难知道他们必须将方法连接到 MasterBase 的 LanguageChanged 事件以处理语言更改。是的，我们确实记录了它。但这仍然不是简单明了的事情。
2.  其次，所有语言更改都是回发。这是有问题的，尤其是当您想使用浏览器的“后退”按钮导航时。

我正在寻找更优雅的解决方案。一个既没有上述问题又能满足我当前要求的产品。

非常感谢任何建议。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T01:59:02.010

在我看来，最好在一个控件中实现这一点，该控件设置一个所有页面都可以使用的应用程序变量。这样你就可以在一个地方实现代码，并让它在显示控件的每个页面上始终可用（可能在你的主页面中，因此所有继承的页面都会自动获取它）。我认为在控件中你会有一个设置全局语言设置然后重新加载页面的处理程序。每个页面都会在 page_load 或 prerender 期间检查语言设置，并相应地加载正确的本地化字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T02:00:12.243

我只会使用`PreInit`基本页面上的事件来设置当前的 ui 文化。我不清楚为什么您需要每个页面都知道何时更改语言。

# usenet - 如何在 usenet 中搜索编程问题？

> ID：275422
> 
> 赞同：4
> 
> 时间：2008-11-09T00:26:56.720
> 
> 标签：usenet

自 1995 年以来，我一直在使用 usenet 搜索来获取编程信息，主要用于 microsoft API。首先通过 dejanews 搜索，现在搜索买断 dejanews 的谷歌“群组”。在过去的几年里，我注意到来自 google 的 usenet 搜索结果数量稳步下降，而今天我发现我完全无法在他们的高级组搜索页面上获得有效的 usenet 搜索。我习惯于搜索“microsoft.*”，有时会加上“ *microsoft* ”或“microsoft*”。只需尝试在 comp.* 或 microsoft.* 层次结构中的“数据库”上查找 1996-1998 时间段的帖子，如果可以，请显示您的搜索表达式。应该有成千上万的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T00:52:07.277

[http://groups.google.com/groups/search?safe=off&q=database+group%3Amicrosoft](http://groups.google.com/groups/search?safe=off&q=database+group%3Amicrosoft) *&btnG=Rechercher&as_mind=1&as_minm=1&as_miny=1996&as_maxd=1&as_maxm=1&as_maxy=1999&as_drrb=b&sitesearch=

似乎工作得很好...... 994 个结果（没有*数千个*但仍然......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T01:27:30.843

高级搜索表单似乎有问题。我也无法在 [http://groups.google.fr/advanced_search?hl=fr&q=&hl=fr&](http://groups.google.fr/advanced_search?hl=fr&q=&hl=fr&) 上找到它。但是我可以将基本形式与“数据库组：microsoft *”一起使用，并且我得到了很多预期的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T01:27:59.547

[http://www.google.ca/groups/search?safe=off&q=database+group%3Acomp](http://www.google.ca/groups/search?safe=off&q=database+group%3Acomp) .*&btnG=Search&sitesearch=

返回 3,000 个结果

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T01:28:00.107

高级搜索也不适合我：

*   [高级搜索结果 URL 损坏](http://groups.google.com/groups/search?as_q=database&as_epq=&as_oq=&as_eq=&num=10&scoring=selected&lr=selected&as_sitesearch=&as_qdr=selected&as_drrb=b&as_mind=1&as_minm=1&as_miny=1996&as_maxd=1&as_maxm=1&as_maxy=1999&as_ugroup=microsoft.%2A%2Ccomp.%2A&as_usubject=&as_uauthors=&safe=off)

但是，出于某种原因，从该 URL 中的查询字符串中删除*lr=selected*使其工作：

*   [工作高级搜索结果 URL](http://groups.google.com/groups/search?as_q=database&as_epq=&as_oq=&as_eq=&num=10&scoring=selected&as_sitesearch=&as_qdr=selected&as_drrb=b&as_mind=1&as_minm=1&as_miny=1996&as_maxd=1&as_maxm=1&as_maxy=1999&as_ugroup=microsoft.%2A%2Ccomp.%2A&as_usubject=&as_uauthors=&safe=off)

事实上，在损坏的高级搜索结果页面上再次点击搜索按钮也会为我返回这些结果。

或者实际上，它只是部分起作用，因为在高级搜索表单中输入多个以逗号分隔的组（或使用*group:*搜索运算符）并没有像预期的那样工作，并最终将附加组名称中的所有单词添加为搜索关键词也是。

您可以尝试学习[Julian 日期](http://en.wikipedia.org/wiki/Julian_day)并使用[daterange 搜索运算符](http://reviews.cnet.com/4520-10165_7-6206764-2.html)：

*   [使用日期范围搜索结果*：*](http://groups.google.com/groups/search?safe=off&q=database+group%3Amicrosoft.%2A+group%3Acomp.%2A+daterange%3A2450083.5-2451179.5)

# windows-mobile - 是否有适用于 Windows Mobile 设备的良好编程环境/IDE？

> ID：275436
> 
> 赞同：4
> 
> 时间：2008-11-09T00:42:04.957
> 
> 标签：windows-mobile, development-environment

这里，我并不是指用于开发和部署 Windows Mobile 应用程序的基于 PC 的开发环境（如 Visual Studio）。相反，我指的是在 Windows Mobile 设备上运行并允许您在那里编写和测试代码的 IDE。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-13T22:36:40.310

在过去一年左右的时间里，我一直在定期寻找可在基于 Windows Mobile 的设备上使用的新开发工具，并且遇到了很多。我目前已经在我的设备上安装了[PythonCE](http://pythonce.sourceforge.net/)、[eTcl](http://www.evolane.com/software/etcl/index.html)、[dsForth](http://www.delosoft.com/)、[PocketLogo](http://sourceforge.net/projects/pocketlogo/)（虽然它附带的文档是德文的）、[Rebol](http://www.rebol.com/platforms-core.html)和[Pocket Scheme](http://www.mazama.net/scheme/pscheme.htm)。

我听说过但没有尝试过的开发工具有[Pocket GCC](http://pocketgcc.sourceforge.net/index.html)、[PocketC](http://www.orbworks.com/)、[Lua](http://lua-users.org/wiki/LuaDistributions)、[J](http://www.jsoftware.com/)、[Pocket Programming Language](http://www.arianesoft.ca/page.php?1)和[Pocket C#](http://pocketgcc.sourceforge.net/pcsharp/)

寻找其他口译员的好网站是[www.rainer-keuchel.de](http://www.rainer-keuchel.de/)，但不幸的是，尽管作者似乎已经有一段时间不活跃了。

[以下是mobilitysite.com 上某个主题的链接，其中包含一些有用的发现。](http://www.mobilitysite.com/boards/business-development/92214-programming-pocket-pc-entirely-ppc-not-desktop-based-solutions.html#post772986)

如果我发现任何新内容，我会回来更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T00:54:52.890

我不知道这样的事情，我怀疑这不是个好主意。因此，我认为不存在任何这样的事情。

不过，这对你来说是一个很酷的项目，我无法想象它会那么难。您只需要一个在 WM 平台上运行的编译器。

等待; 我找到了这个：

[http://www.freewarepocketpc.net/ppc-download-c-ide-mobile-v9-0.html](http://www.freewarepocketpc.net/ppc-download-c-ide-mobile-v9-0.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T22:13:00.403

你可以试试 Basic4PPC (www.basic4ppc.com)。

这是一个很棒的编程环境（基于 NET 框架），拥有非常活跃和众多的用户社区。还有一个可以在设备上使用的 IDE 版本。

Rgds，莫斯特67

# iphone - Unicode 字符不显示

> ID：275437
> 
> 赞同：7
> 
> 时间：2008-11-09T00:43:54.657
> 
> 标签：iphone, cocoa-touch, encoding

我想使用显示“无穷大”符号

```
CGContextSelectFont(context, "HelveticaNeue", textSize, kCGEncodingMacRoman);    
CGContextShowTextAtPoint(context, myCenter.x, myCenter.y + textHeight, [sName     cStringUsingEncoding:NSMacOSRomanStringEncoding], [sName length]); 
```

它显示为方形框或圆形。我发现这个符号是十六进制格式的十进制 176 和 221E。我正在使用 Helvetica 作为我的字体，并且尝试过其他没有运气的字体。这是我使用的编码有问题吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-09T00:51:22.723

原来CGContextSelectFont只支持MacRoman编码，基本上只有一小部分字符。为了在字符串中显示 Unicode 字符，您必须使用 CGSetFont 或 Cocoa 绘图系统。CGSetFont 要求您无论如何都使用 Cocoa 将字符映射到字形，然后使用 CGContextShowGlyphsAtPoint 绘制字形。如果您确实需要显示 Unicode 字符，我建议您研究绘制这些字符串的其他方法。

这段代码基本上会显示无穷大符号：

```
- (void)drawRect:(CGRect)rect {
    unichar inf = 0x221E; // infinity symbol
    NSString* sName = [[NSString alloc] initWithCharacters:&inf length:1];
    UIFont* font = [UIFont fontWithName:@"Helvetica" size:32.0];
    [sName drawInRect:CGRectMake(20, 20, 40, 40)
             withFont:font];
    [sName release];
} 
```

另请注意，在 iPhone（和 Mac）上，Helvetica Neue 实际上并不存在……它的名称只是映射回标准的 Helvetica。有关iPhone 上可用字体的更多信息，请参阅[http://daringfireball.net/misc/2007/07/iphone-osx-fonts](http://daringfireball.net/misc/2007/07/iphone-osx-fonts)上的表格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-25T08:01:11.860

值得注意的是，您仍然可以将 CGContext 函数与 -[NSString drawWithRect:] 及其表兄弟一起使用。例如，下面的代码用 50% 不透明的黑色绘制一个字符串（可以包括任何字符，包括启动此线程的无穷大符号）：

```
CGContextSaveGState(context);
CGContextSetRGBFillColor(context, 0, 0, 0, 0.5);
[self.text drawInRect:targetRect withFont:self.font];
CGContextRestoreGState(context); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-26T22:49:50.797

这是 MonoTouch 的答案：

```
UIGraphics.PushContext (mBmpContext);
mBmpContext.SetRGBFillColor(1f,1f,1f,1f);
var font = UIFont.FromName ("Arial", 30);
using (var nsstr = new NSString ("äöü ÜÖÄ")){
   nsstr.DrawString (new PointF (10, 400), font);
}
UIGraphics.PopContext () 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-22T04:26:21.930

你想避免 drawInRect:withFont: (in MonoTouch: DrawString (string, RectangelF, UIFont font) 因为这个 API 在 iPhoneOS 4.0 之前不会渲染可能包含某些 unicode 字符（如 dingbats）的字符串，并且会在那个时候默默地削减渲染.

相反，您必须使用 drawInRect:withFont:lineBreakMode:alignment: （在 MonoTouch 中，这是 DrawString (string msg, RectangleF rect, UIFont font, UILineBreakMode breakMode, UITextAlignment align) 方法），因为它可以正确呈现。

另外，并非iPhone上的所有字体都是一套完整的字体，可以参考以下：

[http://daringfireball.net/misc/2007/07/iphone-osx-fonts](http://daringfireball.net/misc/2007/07/iphone-osx-fonts)

对于具有完整字符集的字体列表。

# windows - VMware 和 iptables

> ID：275439
> 
> 赞同：-1
> 
> 时间：2008-11-09T00:44:31.223
> 
> 标签：windows, linux, vmware, iptables, nat

在 Windows 上使用 VMware 来托管运行 iptables 的虚拟 linux 机器是否有问题？我有一个似乎可以在物理硬件上运行但在 VMware 下不稳定的配置。

我正在使用 VMware 在 Windows 2003 Server 主机上运行虚拟 linux 2.6.24 机器。linux 应用程序本质上是一个运行`iptables`. 表中的规则`nat`包括：

```
Chain foo_pre
 target     prot opt in  out  source      destination
 LOG        all  --  *   *    0.0.0.0/0   0.0.0.0/0     [options here]
 LOG        all  --  *   *    0.0.0.0/0   10.10.1.33    [options here]
 DNAT       all  --  *   *    0.0.0.0/0   10.10.1.33    tcp dpt:80 to:192.168.0.33:8080

Chain PREROUTING
 target     prot opt in  out  source      destination
 foo_pre    all  --  *   *    0.0.0.0/0   0.0.0.0/0 
```

我看到使用 10.10.1.33:80 的传入数据包`tcpdump`，第一个`LOG`生成消息，但是`DNAT`第二个或第二个都没有`LOG`显示在其数据包计数器上注册的数据包，第二个`LOG`不生成任何消息，并且`tcpdump`不显示数据包192.168.0.33。

适配器位于`eth0`10.10.0.0/16 网络上，默认网关为 10.10.1.1；它的辅助地址为 10.10.1.33/32。 `/proc/sys/net/ipv4/config/eth0/forwarding`设置为 1。

VMware 是罪魁祸首，还是我遗漏了什么？谢谢！

* * *

更新：我们简化了测试环境。根本没有 NAT 规则，只是在 Win2k3 服务器主机下运行的 linux VM。测试步骤：

1.  VM 桥接到主机 NIC。虚拟机和主机在同一个子网中，具有与上述相同的默认网关。

2.  VM 与其子网内外的设备进行通信：ICMP、TCP、UDP。通信是双向的：由哪个设备发起并不重要。

3.  工程师在检查系统时重启了默认网关。

4.  VM 现在*仅*与其子网上的设备通信。从第 2 步开始通过网关与*同一设备*进行通信的任何尝试都*无法将数据包放在网络上。* VM 上 eth0 上的 tcpdump 显示没有响应的传出数据包；主机上的 WireShark 在物理网卡上没有显示*任何内容。*

5.  停止和重新启动 VM 不会改变其行为。停止 VM 并将其替换为具有适当 IP 地址等的*不同VM**不会改变行为。*

6.  Win2k3 主机在其子网内外继续正常通信。

我只能由此得出结论，虚拟机和主机之间“发生了一些事情”：在 VMware 驱动程序中，或者在主机的网络堆栈中。我又要去上网了……很难想象我们是第一个观察到这一点的人。

他们来时更新。感谢您的想法和讨论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T21:33:42.607

您的第二条日志行正在尝试匹配发送到 10.10.1.33 的数据包，但您在其上方的行中将目标地址更改为 192.168.0.33。

我不确定为什么您还没有在 tcpdump 中看到传出的数据包。我假设您在 linux VM 本身上运行 tcpdump。虚拟机是在它接收的同一个接口上发送数据包，还是有第二个虚拟以太网适配器？分配给哪些机器的各种 IP 地址（10.10.1.33 除外）。

关于更新：我猜你没有使用 DHCP（人们在使用静态 IP 地址时通常不会打扰）。此外，听起来网关看到一个 NIC 使用两个 IP 地址。通常这应该没问题，但它总是让你得到细节。

网关是否有可能只为 NIC 分配一个 IP 地址而忽略来自 VM 的流量？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-11T04:45:02.907

编辑后，我建议做一个实验：在您的物理机上，配置您的 NIC 以禁用所有硬件加速。

# vmware - 如何使本地驱动器对 Windows XP VMWare 映像可见？

> ID：275442
> 
> 赞同：4
> 
> 时间：2008-11-09T00:45:59.100
> 
> 标签：vmware

如何使本地驱动器对 Windows XP VMWare 映像可见？

最好是让本地驱动器作为 VM Ware 映像中的驱动器号可用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-09T00:52:20.443

如果两个操作系统都是 Windows：

```
vm > settings > options > shared folders 
```

这样，您可以将虚拟机中的驱动器映射为主机上的文件夹。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T00:47:34.417

使用 samba（linux 主机）或共享（windows 主机），然后将它们映射为虚拟机上的网络驱动器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T08:10:24.697

如果您想真正使驱动器可见（例如使用 gparted 等），而不仅仅是复制一些文件：

您可以创建一个伪 vmdk，它实际上是指向现有物理驱动器（或其一个/多个分区）的链接 该命令例如

```
VBoxManage internalcommands createrawvmdk -filename mydrive.vmdk -rawdisk \\.\PhysicalDrive0 
```

这会将第一个物理驱动器作为一个整体进行映射。您必须以 root/admin 身份运行它（对于 win7，以管理员身份启动 cmd.exe，然后 cd 到您拥有 vmware 的目录）

（仅映射分区 3,4：-partitions 3,4）

然后将 vmdk 映射到 vm 中的驱动器，然后就可以了！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-05T02:20:23.247

vm > 设置 > 选项 > 共享文件夹 > 在此选项卡中，您可以选择它的工作方式。甚至做映射！

# asp.net - 避免在我的 ASP.NET 应用程序中进行编码以使其在共享主机上的中等信任下运行的最常见、最典型的事情是什么？

> ID：275444
> 
> 赞同：8
> 
> 时间：2008-11-09T00:49:27.847
> 
> 标签：asp.net, security, shared-hosting, medium-trust, trust

Medium Trust 阻止您做哪些事情？例如，我已经了解到中等信任会阻止您使用 System.IO.Path.GetTempPath()。还有什么类似的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-09T02:46:21.480

以下是了解和解决信任问题的方法。

1) 在您的 Windows\Microsoft.NET\Framework[YOUR VERSION]\CONFIG 文件夹中搜索文件：

*   web.config（这是根配置文件）
*   web_mediumtrust.config
*   web_hightrust.config

2）改变web.config说

```
<trust level="Medium" originUrl="" /> 
```

3) 试试你的 ASP.NET 应用程序。我的因权限错误而失败。

4) 在 diff 工具（如 WinMerge）中区分 web_mediumtrust.config 和 web_hightrust.config。

5) 一次将设置从高复制到中，看看它们如何影响您的应用程序。在我的例子中，错误消息提到了 ConfigurationPermission，所以很容易诊断。

如果您可以确定 web_mediumtrust.config 文件中阻止您的确切行，那么也许您可以与您的托管公司分享，并有更好的机会解决问题。

更多文档在这里：http:
[//msdn.microsoft.com/en-us/library/aa302425.aspx](http://msdn.microsoft.com/en-us/library/aa302425.aspx)

@Oli，我的应用托管在*GoDaddy*上，当我开始使用 Lucene.NET 时，我不得不在代码中做一些变通方法。我不得不修改 Lucene.NET 源代码以不使用 GetTempPath 和 System.IO.FileInfo。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T00:50:36.923

谁能确定？这就是为什么您应该在 web.config 中设置信任级别的介质进行开发。

```
 <trust level="Full|High|Medium|Low|Minimal" /> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-09T00:54:41.797

大多数共享主机不使用真正的中等信任环境，因为它限制了一些非常重要的事情。其他人出于自己的肛门原因限制了一些额外的设置。

您可以做的最好的事情是询问您的主机他们为 ASPNET 使用了哪些设置。询问他们使用的信任级别的规格。找出内存限制。获得这些详细信息后，您应该能够在本地级别复制该场景。

如果他们不告诉您，只需将您的应用程序设置为以中等信任度运行，但如果他们使用修改后的信任级别，它（显然）不一定工作。

以下是[有关在 IIS 中设置信任级别的一些信息](http://learn.iis.net/page.aspx/50/aspnet/)。

一般来说，我遇到的唯一问题是：如果您正在推送程序集，请确保您允许部分受信任的请求（它是一个程序集元标记），否则您将无法使用它们。

[以下是GoDaddy 的 Medium Trust 信息页面](http://help.godaddy.com/article/1039)的摘录：

> 在中等信任级别下运行的应用程序无法访问注册表，无法访问 Windows 事件日志，并且无法使用 ReflectionPermission（但可以使用 Reflection）。此类应用程序只能与定义的网络地址范围进行通信，并且文件系统访问仅限于应用程序的虚拟目录层次结构。
> 
> 使用中信任级别可防止应用程序访问共享系统资源并消除应用程序干扰的可能性。添加 OleDbPermission 和 OdbcPermission 允许应用程序使用这些数据提供者来访问数据库。WebPermission 被修改为允许出站 http 和 https 流量。

这可能与您必须与主机一起解决的问题完全对应（除非您使用 GoDaddy），但这是一个典型示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T02:14:16.987

确保任何第三方库/框架（想到城堡）都是以中等信任度构建（或可以构建）的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T04:37:05.150

system.runtime.serialization 库在中等信任度下完全不可用。

我围绕这个进行了 json 序列化/反序列化的编码，并找到了困难的方法。花了一周的时间才让一位同事确认应该归咎于中等信任限制。结果，我最终更换了托管公司。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T14:23:41.900

在中等信任度下，至少在我的主机上，P/INVOKE 调用不可用，即`[DLLImport]`用于调用 COM 组件是行不通的。

-Edoode

# ruby - Ruby Shoes - 子窗格窗口中的滚动条

> ID：275453
> 
> 赞同：5
> 
> 时间：2008-11-09T00:53:45.760
> 
> 标签：ruby, shoes

我似乎无法让滚动条在内部堆栈/流中工作。有谁知道怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T12:06:37.167

只需固定高度并添加 ":scroll => true" 参数：

```
Shoes.app(:title => "Scrolll!" ) do
  flow :margin => 10 do
    stack :width => "150px", :height => "200px", :scroll => true do
      para  "all you need is love",  "all you need is love", "all you need is love", "all you need is love", "all you need is love", "all you need is love", "all you need is love", "all you need is love", "all you need is love", "all you need is love",
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T01:22:37.743

You can use a `<div>` tag, and then have CSS as such:

```
#my_div {
 width: [some_width]px;
 height: [some_height]px;
 overflow: auto;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-11T17:10:34.680

我不确定您所说的“内部堆栈/流”到底是什么意思，但我们将 iframe 用于我们的子窗格窗口，它具有您可以设置的滚动属性。否则，您可以使用 YUI 之类的 javascript 框架来获取允许滚动功能的子窗格窗口。

# java - 需要访问共享状态数据的多个侦听器的适当耦合

> ID：275456
> 
> 赞同：0
> 
> 时间：2008-11-09T00:56:42.057
> 
> 标签：java, design-patterns, listener

使用传统的侦听器回调模型。我有几个收集各种东西的听众。每个听众收集的东西都在内部结构中的听众内部。

问题是我希望一些听众知道其他听众的一些“东西”。

我强制执行侦听器注册顺序，因此如果我故意以某种顺序注册事件，稍后的侦听器可以确保先前的侦听器更新了它的内容并以某种方式访问​​它以执行更多操作。

我对此的第一次尝试是让每个侦听器存储对它所依赖的侦听器的引用。所以我按照没有依赖的顺序注册监听到有之前注册依赖的监听，然后在各种方法中设置监听之间的引用。

我开始意识到这种感觉有多糟糕，我想知道以前是否曾以某种方式走过这条路。当一个听众需要访问另一个听众的东西时，什么是更合适的模式？

这里有一些伪代码来说明：

```
interface Listener { onEvent(char e); }

class A implements Listener {
  private int count;
  public void onEvent(char  e) { if(e == 'a') count++; }
  public int getCount() { return count; }
}

class B implements Listener {
 private int count;
 // private A a;
 // private void setA(A a) { this.a = a; }

 public void onEvent(char  e) { if(e == 'b') count++; }
 public int getCount() { return count; }
 public int getAPlusBCount() {
   // We know B count, but we don't know A so how would we change this 
   // so B is A aware? Or not even aware, just somehow coupled? This
   // is the question
   // return a.getCount() + count;
 }

 public void doConditionalHere() {
  // Do some condition in B that relies on the state of data in A
  int acount = 0; // a.getCount(); ???
  if(acount % 2 == 0) {
   this.count--;
  }
 }
}

class Run {
 A a = new A();
 B b = new B();
 List listeners = new List();
 listeners.add(a);
 listeners.add(b);

 // The ugly way I add coupling right now is to keep a reference to A
 // inside B. It's commented out because I am hoping there is a more intelligent approach
 // b.setA(a);

 for(char c : "ababbabab") {
   for(listener : listeners) {
     listener.onEvent(c);
   }
 }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T01:21:18.170

您在这里描述了很多耦合。最好的办法是消除所有这些反向通道依赖，但如果做不到这一点，也许你可以让那些有依赖的人不在初始侦听器列表上侦听，而是在它们所依赖的任何东西上侦听。或者你可以让他们等到他们收到所有信号。

您可以通过让侦听器识别他们所依赖的对象来自动化依赖管理。侦听器列表将不按插入顺序排序，而是确保依赖对象遵循它们的依赖关系。您的侦听器界面如下所示：

```
interface Listener {
  String getId();
  Collection<String> getDependencies();
  onEvent(char e);
} 
```

或者只是有参考，像这样：

```
interface Listener {
  Collection<Listener> getDependencies();
  onEvent(char e);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T02:53:23.117

“我们如何改变这一点，让听众 B 知道听众 A？或者甚至不知道，只是以某种方式耦合？”

您通常不希望像这样耦合两个“对等”对象。您希望两个对等方依赖于共同点。

更深层次的问题是听众 A 或听众 B 如何处理他们收集的所有信息？

Listener 经常做两件事：收集数据并采取行动。通常这两件事需要分开。听众应该倾听和收集并做更多的事情。侦听器可以激活其他一些对象。

您可能拥有的只是一个具有多个操作（A 和 B）的侦听器。然后，侦听器可以向 A 和 B 提供适当的计数。它向 A 提供“a”计数。它向 B 提供“a”或“b”计数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T21:26:17.550

为什么没有一个中心对象来跟踪所有侦听器类的 onEvent 方法被触发了多少次

```
 public interface CountObserver {

 public void updateCount(String className);
 public int getCount(String className);
}

public class CentralObserver implements CountObserver {

 private int aCount;
 private int bCount;

 public void updateCount(String className) {

 //There's probably a better way to do this than using
 //all these if-elses, but you'll get the idea.

  if (className.equals("AclassName")) {
   aCount++;
  }
  else if (className.equals("BclassName")) {
   bCount++;
  }
 }

 public int getCount(String className) {

  if (className.equals("AclassName")) {
   return aCount;
  }
  else if (className.equals("BclassName")) {
   return bCount;
  }
}

class A implements Listener {

 CountObserver countObserver;

 public void registerObserver (CountObserver countObserver) {

  this.countObserver = countObserver;
 }

 public void onEvent(char e) {

  if(e == 'a') {

   countObserver.updateCount (this.getClass.getName);
  }
 }

}

//Same thing for B or any other class implementing Listener. Your Listener interface should, of 

//course, have a method signature for the registerObserver method which all the listener classes 

//will implement.

class Run {

 private A a;
 private B b; 
 private CountObserver centralObserver;

 public runProgram () {

  centralObserver = new CentralObserver();
  a.registerObserver(centralObserver);
  b.registerObserver(centralObserver);

 //run OnEvent method for A a couple of times, then for B

 }

 public int getAcount () {

 return centralObserver.getCount(a.getClass.getName());
 }

 public int getBcount () {

 return centralObserver.getCount(b.getClass.getName());
 }
} 
 //To get the sum of all the counts just call getAcount + getBcount. Of course, you can always  add more listeners and more getXCount methods 
```

# c++ - Fortran 77 代码到 C++ 的转换

> ID：275458
> 
> 赞同：15
> 
> 时间：2008-11-09T01:04:40.263
> 
> 标签：c++, translation, fortran

有没有人将 Fortran 77 代码的大型（我们的是 550,000 行）程序转换为 C++？你遇到了什么陷阱？转换成功了吗？您是否使用过`for_c`（[http://www.cobalt-blue.com/fc/fcmain.htm](http://www.cobalt-blue.com/fc/fcmain.htm)）之类的工具？生成的 C++ 代码是明显更快还是更慢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-09T02:05:25.180

这增加了 EvilTeach 的建议。请记住，*链接*Fortran 77 和 C/C++ 代码相当容易，因此您可以逐步转换应用程序的某些部分并将它们与旧部分链接在一起。如果这样做，您将不得不考虑所有常见的 fortran/c 差异（行/列主要数组、数组索引等），但它会为您省去一次调试整个自动翻译代码库的痛苦.

国家 (DOE) 实验室有许多类似的大型混合代码，它们对旧的 Fortran 代码进行了大量投资。如果你走这条路，你可能会考虑使用[Babel](http://computation.llnl.gov/casc/components/components.html)，它的开发目的是允许在同一个应用程序中的 C、C++、Fortran、Fortran90、Python 和 Java 之间共享组件。实验室这样做的动机是将不同团队为非常大的模拟构建的物理模型捆绑在一起，但您可能会发现它对于转换代码也很有用。它在许多项目中得到积极维护和使用，尽管它对于您想要做的事情可能有点过于复杂。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-09T01:48:21.487

有很多事情需要考虑。

真的有两条路可以走。一种是直接逐行转换为c。我的意思是每个 fortran 语句都对应一个等值的 c 语句。

另一条路径是重写，使用 500k loc+ 会做更多的工作。有了这种大小，我当然会寻找一个工具来进行翻译，比如 f2c。

直接端口的问题...

goto 直接翻译，您需要为 goto 目标创建标签。

```
label10:;

    goto label10; 
```

数组下标是一个潜在的问题。c 是从零开始的，fortran 是从 1 开始的，因此在 fortran 代码中数组的维度需要大一。

**real*4 a(10,20)**变为

```
#define XMAX 10 + 1
#define YMAX 20 + 1 
float a[XMAX][YMAX]; 
```

允许这样编写循环。

```
for (x = 1; x <= XMAX; x++)
    for (y = 1; y <= YMAX; y++)
        a[x][y] = 0.0f; 
```

c 数组访问以行为主，而 fortran 以列为主。这可能是一个性能问题。如果它确实成为一个问题，您可以通过某种反转顺序或数组下标的宏定义来解决它。实际上，您还可以让宏从每个下标中减去一个，以使其看起来像一个基于 1 的数组，实际上映射到一个基于 0 的数组。

**实数*8 a(XMAX,YMAX) a(4,2) = 3.14**

```
#define A(X,Y)  a[Y][X]
double a[XMAX][YMAX];
A(4,2) = 3.14; 
```

可以使用 stdio 类型文件模拟 fortran 单元 io。如果您使用的是第 19 单元，那么

```
FILE *fp19 = fopen("file","mode"); 
```

如果您在文件中使用 fortran 回车控制，则回车控制可能会出现问题。单元 5 和 6 可以简单地用 stdin 引用，而没有 fopen 的 stdout。

printf 系列函数可以处理许多格式。您可能需要添加额外的循环来处理一些 fortran 数组 io。

**写(6, 200) (项目(z,4),z = 1, 20)**

```
int z;
for (z = 1, z <= 20; z++)
    printf("%lf ", proj[z][4]); 
```

o 使用 f2c 可能是最快的方法。然后你被它的rtl卡住了。
o 做一个直接端口是可行的。耗时，但
如果你想长期维护它是可行的，我建议重写。非常耗时，可能更快，但从长远来看更易于维护

幸运的是，在任何情况下，您都可以将原始程序用作基线来进行一组单元测试，以帮助开发工作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-10T19:25:58.783

我的反应是你为什么要转换它。

在 1990 年代，许多公司都在研究如何开发具有大型 Fortran 代码库的产品的问题。即是转换、继续使用 Fortran 还是生产混合版本。我认为大多数人选择了混合方法，通常是 C++ 作为用户界面，而原始的 Fortran 代码库在后台。

我的建议是查看 Carsten Arnholm 的“使用 C++ 和 FORTRAN 77 的混合语言编程”，网址为[http://arnholm.org/software/cppf77/cppf77.htm](http://arnholm.org/software/cppf77/cppf77.htm)。

本文档描述了如何拥有一个包含 C++ 和 Fortran 的应用程序。我不能说某些技术细节是否已经过时，但本文档来自一个希望使用 C++ 进行开发但拥有庞大 Fortran 代码库的项目。

您还可以查看 Barton 和 Nackman 的“科学与工程 C++：高级技术和示例的介绍”，可从好书店获得。本书为 Fortran 程序员教授 C++。它有一些从 C++ 为 Fortran 代码编写包装器的示例。这是一本很好的 C++ 书，忽略了 Fortran 方面。它是在标准制定之前编写的，但差异不是很大。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-09T01:18:00.657

我曾经使用这个： http: [//manpages.ubuntu.com/manpages/hardy/man1/f2c.html](http://manpages.ubuntu.com/manpages/hardy/man1/f2c.html)将一个小的fortran程序转换为C。转换成功。检测任何速度变化的代码并不复杂。

由于您的程序分配得更大，我真的不知道一切是否会像我一样运行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-09T02:28:05.400

您可能想查看[Promula](http://www.greatmigrations.com/)。与许多其他自动翻译器相比，它生成的 C 代码更具可读性。我没有直接使用 Promula，但我已经将相当多的 Promula 输出从 C 转换为 C++。将 C 代码清理为合法的 C++ 很容易，但当然要使其成为真正好的 C++ 需要更多的努力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T20:30:25.347

我研究过一个应用程序，它的核心是使用**for_c**从 FORTRAN 转换代码。它创建的代码太糟糕了。由于大部分内容难以辨认，因此很难维护。幸运的是，该代码非常稳定，很少需要对其进行任何处理。

然而，这是在多年前完成的——大约是 Windows 的 16 位早期。也许 for_c 现在更好了？

# asp.net - ASP.NET 的垃圾邮件过滤

> ID：275459
> 
> 赞同：3
> 
> 时间：2008-11-09T01:04:58.250
> 
> 标签：asp.net, spam-prevention

有没有人遇到过可以在 ASP.NET 应用程序中使用的优雅高效的 .NET 垃圾邮件过滤组件？我想要一些我可以传递一个字符串并返回给我它可能是垃圾邮件的百分比的东西，这样的事情是否存在？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-09T01:14:30.010

Akismet 很棒。

这为 Akismet 服务提供了一个 .NET API：http: [//www.codeplex.com/AkismetApi](http://www.codeplex.com/AkismetApi)

# asp.net - 设计器文件生成失败：HRESULT 异常：0x80042929

> ID：275464
> 
> 赞同：1
> 
> 时间：2008-11-09T01:17:00.490
> 
> 标签：asp.net

以下错误是什么意思？

设计器文件的生成失败：HRESULT 异常：0x80042929

它在构建时开始出现在我的应用程序中，我不确定是什么原因造成的。我正在使用 VS.Net 2008 和 .Net 3.5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-09T14:37:24.787

您是否遇到[此论坛帖子](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=2514240&SiteID=1)中的任何一个问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-13T09:48:11.067

如果在您将文件/文件夹或其他内容添加到表单时发生此错误，请重新检查文件/文件夹的名称，它必须是预先存在的。

# c - gdb 无法运行“无法识别文件格式”的 ELF 64 位程序

> ID：275471
> 
> 赞同：14
> 
> 时间：2008-11-09T01:24:18.757
> 
> 标签：c, gcc, debugging, gdb

我正在尝试使用 GDB 进行调试（以查找烦人的段错误）。当我运行时：

```
gdb ./filename 
```

从命令行，我收到以下错误：

```
This GDB was configured as "i686-pc-linux-
gnu"..."/path/exec": not in executable 
format: File format not recognized 
```

当我执行时：

```
file /path/executable/ 
```

我得到以下信息：

```
 ELF 64-bit LSB executable, AMD x86-64,
 version 1 (SYSV), for GNU/Linux 2.4.0, 
 dynamically linked (uses shared libs), not stripped 
```

我使用的是 GDB 6.1，可执行文件是用 gcc 版本 3.4.6 编译的。

在使用 gdb 方面，我有点不知所措，但据我所知，它应该在这种情况下工作。任何想法出了什么问题？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-09T01:26:59.267

可执行文件是 64 位 (x86-64)，调试器是 32 位 (i686-pc-linux) 版本。您可能需要安装 64 位 (x86-64) 版本的调试器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-09T11:35:10.537

我不确定这是否是您的问题，但我经常遇到这种情况。构建树中的可执行文件，通过 make/automake 构建的不是二进制文件，而是脚本，因此您不能将 gdb 与它一起使用。尝试安装应用程序并更改目录，因为否则 gdb 会尝试调试脚本。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-09T09:18:44.290

该问题涉及“./filename”和“/path/executable”。这些是同一个文件吗？

如果您正在进行事后分析，您将运行：

```
gdb executable-file core-file 
```

如果您要忽略核心文件，您将运行：

```
gdb executable-file 
```

在这两种情况下，“ `executable-file`”都表示要调试的二进制文件的路径名。大多数情况下，这实际上是当前目录中的一个简单文件名，因为那里有来自调试版本的源代码。

在 Solaris 上，GDB 的 64 位构建应该能够调试 32 位和 64 位可执行文件（尽管我在 GDB 的最新版本中遇到了一些问题）。我不确定是否相反 - 32 位 GDB 必须调试 64 位可执行文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-14T03:28:34.320

您需要检查的是真正的 bfd 库。[二进制文件描述符](http://www.linuxselfhelp.com/gnu/bfd/html_chapter/bfd_toc.html)库是 binutils / gdb 用于实际解析和处理二进制文件（ELF/a.out 等）的库。

可以通过objdump查看当前支持的平台；

```
# objdump -H

objdump: supported targets: elf32-powerpc aixcoff-rs6000 elf32-powerpcle ppcboot elf64-powerpc elf64-powerpcle elf64-little elf64-big elf32-little elf32-big srec symbolsrec tekhex binary ihex
objdump: supported architectures: rs6000:6000 rs6000:rs1 rs6000:rsc rs6000:rs2 powerpc:common powerpc:common64 powerpc:603 powerpc:EC603e powerpc:604 powerpc:403 powerpc:601 powerpc:620 powerpc:630 powerpc:a35 powerpc:rs64ii powerpc:rs64iii powerpc:7400 powerpc:e500 powerpc:MPC8XX powerpc:750

The following PPC specific disassembler options are supported for use with
the -M switch:
  booke|booke32|booke64    Disassemble the BookE instructions
  e300                     Disassemble the e300 instructions
  e500|e500x2              Disassemble the e500 instructions
  efs                      Disassemble the EFS instructions
  power4                   Disassemble the Power4 instructions
  power5                   Disassemble the Power5 instructions
  power6                   Disassemble the Power6 instructions
  32                       Do not disassemble 64-bit instructions
  64                       Allow disassembly of 64-bit instructions 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-04T21:03:15.803

看来您的 GNU 调试器 ( `gdb`) 不支持 x86_64 架构。

因此，请尝试旨在替换它的[LLDB Debugger](https://en.wikipedia.org/wiki/LLDB_(debugger)) ( )。`lldb`它支持 i386、x86-64 和 ARM 指令集。

它在 BSD/OS X 上默认可用，在 Linux 上通过：（`sudo apt-get install lldb`或使用`yum`）安装。

有关更多信息，请参见：[gdb 到 lldb 命令映射](http://lldb.llvm.org/lldb-gdb.html)页面。

# paypal - 有没有人发现支付处理器文档很差

> ID：275477
> 
> 赞同：1
> 
> 时间：2008-11-09T01:28:08.017
> 
> 标签：paypal, payment-gateway, shopping-cart, beanstream

有没有其他人发现许多支付处理器的文档关于如何使用他们的 API 的文档很差或不完整？或者它只是简单的混乱？

最近我设置了[PayPal](http://www.paypal.com)和[Beanstream](http://www.beanstream.com)，发现两者要么令人困惑，要么不包含完整的文档。

例如，在 BeanStream 文档中，他们说他们将返回一个“message_id”，这很好，但他们没有告诉你不同 id 的含义。它还附带一些文本，因此您可以开始创建列表，但无法检查以确保您获得的是有效的或表示成功的。

有没有人有过这样的经历？

**编辑：**我同意当你给他们发电子邮件时，他们很有帮助，但不幸的是，他们中的大多数人只在正常工作时间开放一般技术支持（紧急情况除外），这并不总是有用的，因为那似乎不是我做我的整合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T01:51:50.450

好吧，这并不是真正特定于支付处理器文档，因为在所有条件相同的情况下，有据可查的 API 将有助于鼓励开发。就其价值而言，我曾使用过 paypal、authorize.net、ups 和 usps API，并没有发现它们明显令人困惑（并不意味着通过它们是一种特别的乐趣）。

话虽如此，我希望更多的文档就像 PHP 的那样。尽管它是一种如此分散的语言，但文档确实非常好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T02:00:24.363

使用过很多 API，不仅适用于支付处理器，还适用于许多其他与电子商务相关的 Web 服务，我不得不说，虽然文档可能不那么出色，但它们通常还不错，如果你发送他们发电子邮件或给他们打电话，他们通常会很有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T02:10:58.540

我发现来自 Authorize.net 和 Nova 的 ViaKlix 的文档和代码示例非常有用。我远离贝宝。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T02:22:52.993

这可能对您没有太大帮助，但是随着您在特定领域获得更多经验，界面会变得更容易。通过奇怪的世界转折，我编写了一大堆信用卡接口，一旦你掌握了术语，它们的工作原理都是一样的。

*除了*提供的文档之外，我要提供的唯一其他建议是利用支持资源。我们最近与一个相对知名的支付网关合作，虽然他们的文档完全烂透了（他们自己也承认），但支持人员知识渊博，非常愿意提供帮助/解释。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-12T16:59:44.320

我用过 Realex 和 PayPal。Realex 文档很好。清晰明了。贝宝的绝对是令人眼花缭乱的可怕。而且我是那种非常喜欢阅读文档的怪人，众所周知，我阅读它是为了好玩（我已经阅读了整个 OpenID 规范，尽管我没有立即使用它的计划）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T01:15:35.947

我不得不在几个站点上使用 Authorize.net，并且提供的文档“还可以”，假设您正在使用他们提供示例代码的有限技术集。使用 PHP 启动并运行它是一件轻而易举的事，但在尝试在 ColdFusion 中完成相同的事情时却相当缺乏。

其他几个通过 PayPal 完成的网站，IMO 的体验要好得多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-09T01:53:22.850

我只使用过 PayPal，但简单版本（您只需在网页上设置 HTML 表单并使用 PayPal 按钮提交）非常易于使用。如果您正在寻找近乎实时的付款反馈，我总是发现编写一个程序来定期检查我的 PayPal 电子邮件帐户并从电子邮件正文中解析付款详细信息会更容易。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T21:36:35.577

在设置和测试测试帐户（沙盒）方面，PayPal 是一场噩梦。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-15T19:05:51.273

Re: Beanstream 你必须登录然后你会在左侧看到文档链接。设计是如此的 90 年代，他们建议使用 IE。

[回复：Paypal 我从http://www.php-suit.com/paypal](http://www.php-suit.com/paypal)为我的 Zend Framework 项目改编了这段代码。注意：您必须注册 ssl:// 套接字传输包装器，否则（在 phpinfo() 中可见）您必须调整代码以使用 curl。

下面是如何使用 SVN 获取代码

svn 结帐[http://paypalphp.googlecode.com/svn/trunk/](http://paypalphp.googlecode.com/svn/trunk/) paypalphp-read-only

# c++ - 将 cout 格式对齐为表格的列

> ID：275484
> 
> 赞同：32
> 
> 时间：2008-11-09T01:40:20.927
> 
> 标签：c++, string, format

我很确定这是一个关于格式化的简单问题，但这是我想要完成的：

我想使用 . 将数据输出到屏幕上`cout`。我想以表格格式输出它。我的意思是列和行应该正确对齐。例子：

```
Test                 1
Test2                2
Iamlongverylongblah  2
Etc                  1 
```

我只关心单独的线路，所以我现在要输出的线路（不工作）是

`cout << var1 << "\t\t" << var2 << endl;`

这给了我类似的东西：

```
Test                 1
Test2                  2
Iamlongverylongblah         2
Etc                  1 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-11-09T01:51:13.790

[设置](http://www.cplusplus.com/reference/iomanip/setw/)_

```
#include <iostream>
#include <iomanip>
using namespace std;

int main () {
  cout << setw(21) << left << "Test"    << 1 << endl;
  cout << setw(21) << left << "Test2"   << 2 << endl;
  cout << setw(21) << left << "Iamlongverylongblah"     << 2 << endl;
  cout << setw(21) << left << "Etc"     << 1 << endl;
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-09T01:49:19.377

我建议使用[Boost Format](http://www.boost.org/doc/libs/1_37_0/libs/format/index.html)。使用这样的东西：

```
cout << format("%|1$30| %2%") % var1 % var2; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T01:51:32.587

您必须找到第一列中最长字符串的长度。然后，您需要在字段的第一列中输出每个字符串，长度为该最长字符串的长度。这必然意味着在你读完每一个字符串之前你不能写任何东西。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-12-15T16:46:13.660

你可以用

```
string str = "somthing";
printf ("%10s",str);
printf ("%10s\n",str);
printf ("%10s",str);
printf ("%10s\n",str); 
```

# asp.net-mvc - 使用 ASP.NET MVC 组织项目的最佳实践

> ID：275490
> 
> 赞同：5
> 
> 时间：2008-11-09T01:49:32.560
> 
> 标签：asp.net-mvc

我最近下载了 Rob Conery 出色的[ASP.NET Storefront 参考应用程序](http://blog.wekeroad.com/mvc-storefront/)，发现它非常有启发性。想到的一个问题是应该将模型类（以及它们所依赖的数据类）放在哪里。MVC 项目模板创建一个模型文件夹。但在我看来，最好将模型分解成一个单独的项目程序集，以便其他潜在应用程序（例如与网站应用程序域相关的管理工具）重新使用它？

我很想听听人们的意见。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-09T01:51:28.483

这实际上取决于项目的大小。拥有单独的“模型”程序集没有内在价值，因为您可以对 Web 应用程序项目（包括 MVC 项目）进行单元测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T02:05:19.563

我会同意的。除非该应用程序永远只是单个 Web 应用程序，否则我会将其分解为一个单独的项目。通常，我将有一个 Web 应用程序前端，它使用一个或多个 Windows 服务来执行重复的、自动化的任务（提交费用、发送通知等）和一个或多个控制台应用程序工具来从我们的企业目录中配置应用程序用户群——我的应用程序通常是仅适用于我们整个用户群的子集的 Intranet 应用程序。将模型（数据层）放在一个单独的项目中可以让我轻松地与所有其他应用程序共享它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T06:16:42.397

我喜欢为我的模型、数据访问和业务逻辑设置单独的项目。我在每一层也有接口。这使得使用 mock 的测试易于实现，使我的代码井井有条，并使我的控​​制器保持轻便。如果我将所有图层都放在模型文件夹中，我会觉得它不够有条理（只是个性问题）。我还希望可以选择为我的应用程序公开 Web 服务，这样就可以为这些服务提供所有相同的逻辑、模型和数据访问权限。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T02:11:03.717

如果您的模型是域传输对象，那么将它们放在单独的程序集中将允许您重用它们。如果您的应用程序是一个简单的 MVC 应用程序，并且仅此而已，或者您只是为了进行单元测试，则不需要它。否则你可以：

*   您是否让 Web 服务层使用模型程序集将模型对象传递给 mvc 应用程序以在您的应用程序中使用。如果您练习不允许 Web 应用程序直接访问数据库，则需要这样做。在这种情况下，您可能有一个调用 Web 服务来验证和提取数据的 mvc。

*   您打算使用相同的模型构建其他应用程序，例如您提到的管理工具。

我希望这会有所帮助。附带说明一下，您可能希望将“通用”部分放入您自己的框架中，其中包括“模型”（实体、域对象、您喜欢的任何名称）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-30T18:44:51.197

有时，在您的 MVC 网站项目中拥有一个 Models 文件夹并拥有一个单独的项目来存储数据模型可能是有意义的。（尽管这可能只有在您拥有一个相当大的平台并且您正在使用其他项目重用公共库时才有意义）。

一个示例如下所示：

项目：

*   CrossCutting：包含用于在其他服务之间传输数据对象的所有通用接口，以及与安全相关的操作和类

*   业务：包含业务层对象和操作，通过安全需求控制对操作的访问（输入和输出仅使用横切接口）。

*   数据：包含用于从其他服务/数据库访问数据的数据模型（由业务项目使用）

*   WebAPI：（MVC 项目）包含一个 Models 文件夹。一些模型对象可能是 CrossCutting 接口的组合，以支持最高效率的 RESTful Web 操作（因此，对 Web API 的单个 HTTP 调用，但可能导致多个 BLL 调用）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-09T03:00:02.433

单独的组件！= 松散耦合。

# c# - .NET RichTextBox 撤消

> ID：275493
> 
> 赞同：6
> 
> 时间：2008-11-09T01:50:44.087
> 
> 标签：c#, winforms, undo

我在 WinForms 3.5 中使用 RichTextBox，我发现当我以编程方式编辑包含的文本时，这些更改不再可用于内置的撤消功能。

有没有办法使这些更改可用于撤消/重做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T04:57:31.120

这只是我决定搞乱的一些代码：

```
 string buffer = String.Empty;
        string buffer2 = String.Empty;
        public Form3()
        {
            InitializeComponent();
            this.richTextBox1.KeyDown += new KeyEventHandler(richTextBox1_KeyDown);
            this.richTextBox1.TextChanged += new EventHandler(richTextBox1_TextChanged);
        }

        void richTextBox1_TextChanged(object sender, EventArgs e)
        {
            buffer2 = buffer;
            buffer = richTextBox1.Text;
        }

        void richTextBox1_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.Control && e.KeyCode == Keys.Z)
            {
                this.richTextBox1.Text = buffer2;
            }
        }

        private void button1_Click(object sender, EventArgs e)
        {
            richTextBox1.Text = "Changed";
        } 
```

这基本上是我编写自己的撤消功能。我所做的只是将旧值存储在一个缓冲区变量中，并将新值存储在第二个缓冲区变量中。每次文本更改时，这些值都会更新。然后，如果用户点击“CTRL-Z”，它将用旧值替换文本。黑客？一点。但是，它在大多数情况下都有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-07T12:07:04.583

您需要替换选定的文本，而不是替换文本：

```
richTextBox.SelectAll();
richTextBox.SelectedText = NewText; 
```

然而，这是用当前版本的 winforms 测试的，它有同样的问题。

# visual-studio - Visual Studio 的顶级 .mak 文件？

> ID：275510
> 
> 赞同：0
> 
> 时间：2008-11-09T02:11:30.207
> 
> 标签：visual-studio, visual-c++, build-process, build-automation, makefile

我继承了包含大约十几个子项目的 Visual C++ 源代码。其中之一是一个空的“MakeAll”项目，它依赖于所有其他项目，因此我可以通过将 MakeAll 项目设置为活动并选择“Build All”来构建整个项目。

我想自动化这个过程，并且来自 linux 环境，我的直觉是生成一个 Makefile 并从命令行构建。IDE 将为`.mak`每个子项目生成文件，但不会为顶级 MakeAll 生成文件。（我假设这是因为它只包含依赖项。）

linux 的答案将是一个 Makefile，它只是下降到每个子项目并`make`在每个子项目中执行。但是快速浏览这些`.mak`文件表明，每个人都希望被告知要使用几种配置中的哪一种——显然有些使用 Debug，有些使用 Release，有些使用由以前的开发人员炮制的配置。

从命令行构建一组这样的项目的公认方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T04:47:10.830

您不必使用 make - 如果您将所有内容都作为解决方案文件 (.sln)，那么您可以使用[msbuild 工具](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)自动构建：

```
msbuild solution.sln 
```

另外，为什么你有一个“MakeAll”项目？Visual Studio 不需要这种hackery，只需执行“全部构建”，它就会像典型的“全部构建”规则一样构建满足依赖关系的所有内容。

# javascript - 通过 javascript 添加 HTML 控件

> ID：275514
> 
> 赞同：2
> 
> 时间：2008-11-09T02:17:32.347
> 
> 标签：javascript, html, controls

有些东西在躲避我……这似乎很明显，但我无法弄清楚。

当用户更改下拉列表的值时，我想向页面（普通的旧 html）添加/删除几个 HTML 控件。一个例子是为每个（数量的）请求的房间添加或删除“这个房间的客人数量”文本框......

因此，如果用户选择：

1个房间，有一个文本框

2个房间，有两个文本框

3 个房间，三个文本框

返回 2 个房间，两个文本框

等等 ...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-09T02:31:56.437

使用直接的 DOM 和 Javascript，您可能想要修改 DOM 对象的 IninterHtml 属性，该对象将包含文本框……很可能是一个 div。所以它看起来像：

```
var container = document.getElementById("myContainerDiv");
var html;
for(var i = 0; i < selectedRooms; i++)
{
    html = html + "<input type=text ... /><br />";
}
container.innerHtml = html; 
```

使用像 jQuery 这样的 Javascript 库可以让事情变得稍微容易一些：

```
var html;
for(var i = 0; i < selectedRooms; i++)
{
    html = html + "<input type=text ... /><br />";
}

$("#myContainerDiv").append(html); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T02:25:00.413

对于您选择的房间列表，添加将显示/隐藏文本框的 onchange 事件处理程序。

```
<script>
  //swap $ with applicable lib call (if avail)
  function $(id){
    return document.getElementById(id);
  }
  function adjustTexts(obj){
    var roomTotal = 4;
    var count = obj.selectedIndex;
    //show/hide unrequired text boxes...
    for(var i=0;i<roomTotal;i++){
      if(i < count){
        $('room'+ (i+1)).style.display = 'block';
      } else {
        $('room'+ (i+1)).style.display = 'none';
      }
    }
  }
</script>

<select name="rooms" onchange="adjustTexts(this);">
  <option>1</option>
  <option>2</option>
  <option>3</option>
  <option>4</option>
</select>

<div id="room1">
  <label>Room 1</label>:<input type="text" name="room1text"/>
</div>

<div id="room2" style="display:none;">
  <label>Room 2</label>:<input type="text" name="room2text"/>
</div>

<div id="room3" style="display:none;">
  <label>Room 3</label>:<input type="text" name="room3text"/>
</div>

<div id="room4" style="display:none;">
  <label>Room 4</label>:<input type="text" name="room4text"/>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T02:33:42.737

给定 HTML：

```
<select name="rooms" id="rooms">
  <option value="1">1 room</option>
  <option value="2">2 rooms</option>
  <option value="3">3 rooms</option>
</select>
<div id="boxes"></div> 
```

javascript:

```
document.getElementById('rooms').onchange = function() {
  var e = document.getElementById('boxes');
  var count = parseInt(document.getElementById('rooms').value);
  e.innerHTML = '';

  for(i = 1; i <= count; i++) {
    e.innerHTML += 'Room '+i+' <input type="text" name="room'+i+'" /><br />';
  } 
} 
```

# asp.net - ASP.NET 验证

> ID：275526
> 
> 赞同：0
> 
> 时间：2008-11-09T02:31:05.410
> 
> 标签：asp.net, ajax, validation

我正在处理一个表单，我想验证诸如[This](http://ui-patterns.com/pattern/InputFeedback)之类的功能。这一切都应该在客户端完成吗？还是服务器端？我知道使用一些 MS ajax 控制，但是，我什么时候在顶部显示消息？

我希望我自己解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T02:35:18.413

**您*应该*在两端进行验证。**

*   客户端确保反馈是即时的，以便用户可以快速完成它（对他们来说是一个奖励）并且您可以节省服务器资源（对您来说是一个奖励）。

*   服务器端确保任何不使用 JS 的用户代理可以检查传入的数据。这对于阻止恶意/损坏数据进入您的系统至关重要。

如果你只打算做一个，那就让它成为服务器端，但是通过实现双系统对用户有很大的好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T08:53:28.403

一般而言（取决于您的 Ajax 框架的质量）客户端验证已*过时*。这是过去（前阿贾克斯时代）的遗物，不再需要了......

在服务器上运行所有验证。毕竟使用 Ajax 一切都快了 100 倍，对吧……？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T02:35:39.800

在客户端进行验证并在他们单击提交按钮时提供反馈

但是由于您不能信任客户端验证，因此还要在服务器端进行验证，如果一切都不正确，则在回发时显示反馈

但是由于您不能信任调用代码，因此还要在数据库服务器中进行验证（最好是存储过程）并在出现问题时将错误返回给调用代码

这样你就覆盖了所有的基础

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T02:35:50.470

通常认为在客户端和服务器端都进行验证是一种很好的做法……以防万一有人尝试直接提交表单 POST 而不实际加载页面。

至于何时显示验证消息，这是个人喜好。我倾向于尽快提供反馈，所以当该领域失去焦点时，我会做正则表达式验证之类的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-09T02:36:45.757

它真的很简单，您可以使用 ASP.NET 验证控件，您可以在客户端和服务器端使用它们。

检查此资源：

*   [如何：在 ASP.NET 中使用验证控件？](http://www.asp.net/learn/videos/video-193.aspx)（视频）
*   [使用 ASP.NET 进行表单验证 - 再简单不过了！](http://www.4guysfromrolla.com/webtech/090200-1.shtml)

# .net - .NET“隔离存储”存储在哪里？

> ID：275536
> 
> 赞同：35
> 
> 时间：2008-11-09T02:54:34.707
> 
> 标签：.net, isolatedstorage

物理文件在哪里？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-09T02:56:21.223

这取决于操作系统以及是否启用了漫游用户配置文件。

例如，在 XP 上，使用非漫游配置文件，位置是

```
<SYSTEMDRIVE>\Documents and Settings\<user>\Local Settings\Application Data\Microsoft\IsolatedStorage 
```

在具有漫游配置文件存储的 Vista 上，

```
<SYSTEMDRIVE>\Users\<user>\AppData\Roaming\Microsoft\IsolatedStorage 
```

有关详细信息，请参阅[隔离存储简介](http://msdn.microsoft.com/en-us/library/3ak841sy.aspx)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-03-05T02:23:04.440

`%LocalAppData%\IsolatedStorage`/`%AppData%\IsolatedStorage.`

我没有在“微软”下找到它们

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-03-29T10:36:09.097

```
System.Diagnostics.Process.Start(
    Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) + 
    "\\IsolatedStorage"
    ); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-02-15T19:25:25.977

在我的 XP 工作站上，我在 c:\Documents and Settings\\Local Settings\Application Data\Microsoft\Silverlight\is\XXXXXXXXXXXXX 下找到了它，其中 xxxxxxxx 似乎是一个随机目录名称。（在此之下，如果您四处闲逛，您应该找到适合您特定应用的商店......）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-10-24T16:38:36.237

我也在`%ProgramData%\IsolatedStorage`（经常是 C:\ProgramData\IsolatedStorage）下看到它。

这个特殊案例是带有 IIS 站点相关数据的 Windows Server 2008。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-04-01T18:22:22.777

我正在使用 Windows 8.1。在我的电脑上`C:\Users\mangesh\AppData\LocalLow\Microsoft\Silverlight\<followed by some random folder names>`

在“Silverlight”文件夹中有许多随机文件夹。您应该在这些文件夹之一中找到您的文件。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-06-08T15:16:11.830

位置因`IsolationStorage`范围而异

```
Local user     [LocalApplicationData]\IsolatedStorage
Roaming user   [ApplicationData]\IsolatedStorage
Machine        [CommonApplicationData]\IsolatedStorage 
```

可以通过`Environment.GetFolderPath`方法检索文件夹。

Windows 2016 有这样的

```
Local user     C:\Users\<user>\AppData\Local\IsolatedStorage
Roaming user   C:\Users\<user>\AppData\Roaming\IsolatedStorage
Machine        C:\ProgramData\IsolatedStorage 
```

更多细节可以在[这里](http://www.albahari.com/nutshell/IsolatedStorage.pdf)找到。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-09-30T19:21:56.347

当由系统帐户访问/创建时，我在这里找到了该文件夹：

```
C:\Windows\SysWOW64\config\systemprofile\AppData\Local\IsolatedStorage 
```

# java - java ee | ejb3 | 运行时调度

> ID：275540
> 
> 赞同：1
> 
> 时间：2008-11-09T03:00:21.857
> 
> 标签：java, jakarta-ee, ejb, javabeans

我想在运行时调用 ejb3。ejb 的名称和方法名称仅在运行时可用，因此我不能在编译时包含任何远程接口。

```
String bean = 'some/Bean';
String meth = 'doStuff';

//lookup the bean
Object remoteInterface = (Object) new InitialContext().lookup(bean);

//search the method ..
// foreach (methods)
// if method == meth, method.invoke(bean); 
```

bean 应该分布在多个应用程序服务器上，并且所有 bean 都将被远程调用。

有什么提示吗？具体来说，我**不**想要：

1.  依赖注入
2.  在调度程序中包含特定于应用程序的 ejb 接口（上图）
3.  webservices，这就像白白丢掉处理能力，所有的xml废话

是否可以通过网络加载 ejb3 远程接口（如果是，如何？），所以我可以将接口缓存在一些哈希映射或其他东西中。

我有一个带有远程调度程序 bean 的解决方案，我可以将它包含在上面的主调度程序中，它的作用基本相同，但只是将调用中继到本地 ejb（我可以如何查找？命名查找失败）。给定远程调度程序 bean，我可以使用依赖注入。

谢谢你的帮助

（网豆和玻璃鱼顺便说一句）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T05:58:25.710

ejb3 调用使用 RMI。RMI 支持远程类加载，所以我建议研究一下。

此外，JMX mbeans 支持完全无类型的远程调用。因此，如果您可以使用 mbeans 而不是会话 bean，那可以工作。（例如，JBoss 支持带有一些自定义注释的类似 ejb3 的 mbean）。

最后，许多应用服务器支持 CORBA 调用，而 CORBA 支持无类型方法调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-11T16:11:20.977

您也许可以使用 java.rmi.server.RMIClassLoader 进行远程类加载。您还需要加载远程服务返回或抛出的任何类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T14:55:07.767

为此，您需要使用反射，这很简单。假设您正在寻找一个名为*meth*的 void 方法：

```
Object ejb = ctx.lookup(bean);
for (Method m : ejb.getClass().getMethods()) {
    if (m.getName().equals(meth) && m.getParameterTypes().length == 0) {
        m.invoke(service);
    }
} 
```

如果您正在寻找特定的方法签名，只需相应地修改 m.getParameterTypes() 测试，例如对于具有单个 String 参数的方法，您可以尝试：

```
Arrays.equals(m.getParameterTypes(), new Class[]{String.class}) 
```

然后将带有实际参数的 Object[] 数组传递给 m.invoke() 调用：

```
m.invoke(service, new Object[]{"arg0"}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T12:04:12.737

这是不可能的。您将始终收到“找不到类”异常。在我看来，这是 EJB/Java 的最大缺点。你失去了一些动态，因为元语言功能是有限的。

EJB3 支持 RMI/IIOP，但不支持 RMI/JRMP（标准 RMI），因此不支持动态类加载。您失去了一些 Java 通用性，但获得了其他特性，例如能够就事务和安全性进行通信。

# python - 信息似乎错误地从mysqldb出来，python django

> ID：275541
> 
> 赞同：0
> 
> 时间：2008-11-09T03:06:06.773
> 
> 标签：python, mysql, django, character-encoding

在一个 latin-1 数据库中，我有“ `\222\222\223\225`”，当我尝试从 django 模型中提取这个字段时，我回来了`u'\u2019\u2019\u201c\u2022'`。

```
from django.db import connection                                                                                                                                                                                                                                                    
(Pdb)                                                                                                                                                                                                                                                                                  
cursor = connection.cursor()                                                                                                                                                                                                                                                        
(Pdb)                                                                                                                                                                                                                                                                                  
cursor.execute("SELECT Password from campaignusers WHERE UserID=26")                                                                                                                                                                                                             
(Pdb)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
row = cursor.fetchone() 
```

所以我踏入其中并进入

> /usr/local/python2.5/lib/python2.5/site-packages/MySQL_python-1.2.2-py2.5-linux-i686.egg/MySQLdb/cursors.py(327)fetchone()->(u '\u2019...1c\u2022',)

我不能更进一步，因为它是一个鸡蛋，但似乎 MySQL python 驱动程序将数据解释为 latin-1。

有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T16:54:16.633

稍微浏览一下已经提出的问题，您就会看到[UTF-8 latin-1 转换问题](https://stackoverflow.com/questions/274361/utf-8-latin-1-conversion-issues-python-django)，昨天有人提出并回答了这个问题。

顺便说一句，我不记得确切的标题，所以我只是在 django+'\222\222\223\225' 上搜索并找到了它。记住，孩子们，谷歌是你的朋友 (tm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T21:34:21.470

Django 使用 UTF-8，除非您将 DEFAULT_CHARSET 定义为其他内容。请注意，定义其他字符集将要求您在此字符集中对所有模板进行编码，并且此字符集将从这里弹出到那里，例如电子邮件编码、站点地图和提要等。所以，IMO，你能做的最好的就是使用 UTF-8，这会让你在使用 Django 时省去很多麻烦（内部都是 unicode，问题出在你的应用程序的边界上，比如模板和输入）。

# windows-services - 关于使用命令提示符安装 Windows 服务的困惑

> ID：275542
> 
> 赞同：1
> 
> 时间：2008-11-09T03:06:26.180
> 
> 标签：windows-services

我在 .NET 2.0 中设计了一个简单的 Windows 服务。

我正在尝试将它部署在我的本地机器上。我已切换到设计视图，并设置了 ServiceInstaller 和 ServiceProcessInstaller 对象。有一个项目安装程序。我还将 Windows 服务包装到一个 .NET 安装项目中并安装它，在指定目录中留下一个 .exe。

我已经启动了 cmd 并输入了 installutil 的路径。这工作正常，但随后我在 Visual Studio 命令提示符中键入了installutil 和服务的完整路径，这不起作用（我也试过 installutil /i 和各种绝望的事情）。权限是本地系统（广泛）。

任何想法我做错了什么？对于这里安装了 Windows 服务的人，您安装该服务的方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T03:13:48.863

我们实际上在我们的应用程序中创建了一个安装程序。它是一个控制台应用程序，具有用于安装/卸载服务器以及作为服务或控制台模式运行的命令行。

[有关详细信息，请参阅有关自助安装服务](http://alt.pluralsight.com/wiki/default.aspx/Craig/SelfInstallingService.html)的这篇文章。我喜欢这种方法，因为它提供了灵活性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T03:15:19.050

```
描述：
        SC 是一个命令行程序，用于与
        NT 服务控制器和服务。
用法：
        sc [命令] [服务名称] ...

        该选项的格式为“\\ServerName”
        可以通过键入以下命令获得有关命令的更多帮助：“sc [command]”
        命令：
          query-----------查询服务的状态，或者
                          枚举服务类型的状态。
          queryex---------查询服务的扩展状态，或
                          枚举服务类型的状态。
          start-----------启动服务。
          pause-----------向服务发送暂停控制请求。
          interrogate-----向服务发送一个 INTERROGATE 控制请求。
          continue--------向服务发送CONTINUE控制请求。
          stop------------向服务发送 STOP 请求。
          config----------更改服务的配置（持久）。
          description-----更改服务的描述。
          failure---------更改服务在失败时采取的操作。
          qc-------------查询服务的配置信息。
          qdescription----查询服务的描述。
          qfailure--------查询服务失败时的动作。
          delete----------删除服务（从注册表中）。
          create----------创建服务。（将其添加到注册表中）。
          control---------向服务发送控制。
          sdshow----------显示服务的安全描述符。
          sdset-----------设置服务的安全描述符。
          GetDisplayName--获取服务的 DisplayName。
          GetKeyName------获取服务的 ServiceKeyName。
          EnumDepend------枚举服务依赖。

        以下命令不需要服务名称：
        sc   
          boot------------(ok | bad) 表示最后一次启动是否应该
                          保存为最后一次正确的引导配置
          Lock------------锁定服务数据库
          QueryLock-------查询SCManager数据库的LockStatus
例子：
        sc 启动我的服务

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T04:36:36.747

我在我的安装包中调用 installutil ，它对我来说很好。

如果您在运行 installutil 时发布了一条错误消息，那就太好了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T03:20:54.933

这是另一个特定于 .NET 服务的参考。

[http://bytes.com/forum/thread739857.html](http://bytes.com/forum/thread739857.html)

# asynchronous - 起始位与起始字节

> ID：275544
> 
> 赞同：8
> 
> 时间：2008-11-09T03:10:46.640
> 
> 标签：asynchronous, communication, bit

我知道在很多异步通信中，数据包从一个起始位开始。

但是起始位只是 1 或 0。如何区分起始位与结束位与最后一个数据包？

前任。如果我选择我的起始位为 0，我的结束位为 1。并且我收到 0（数据流 A）1 0（数据流 B）1，有什么可以阻止我假设有一个数据流 C 包含“（数据流A）1 0（数据流B）”的内容相同？

有一个起始字节然后检查数据流中的比特组合不是更方便吗？这将减少开始/结束位之间混淆的可能性。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-09T03:16:11.357

好问题！大多数异步通信还指定一个*停止*位，它是起始位的补码，确保每个新符号都以停止到开始的转换开始。

示例：让我们传输字符`ABC`，它们是 ASCII 65、66 和 67：

```
A = 65 = 0x41 = 0100 0001
B = 66 = 0x42 = 0100 0010
C = 67 = 0x43 = 0100 0011 
```

我们还假设（任意）起始位是`0`，停止位是`1`，并且数据从 MSB 传输到 LSB。`1`当没有数据传输时，发送器将处于停止 ( ) 状态。所以接收者可能会看到：

```
Data:   ....1111 0010000011 111 0010000101 0010000111 11111....
         (quiet) ^   A    $     ^    B   $ ^    C   $ (quiet) 
```

`1`对 ASCII 图形表示歉意，当通道空闲时，数据由一系列停止 ( ) 位组成。当发送器准备好发送一个字符时，它会发送一个开始 ( `0`) 位（用 标记`^`），然后是字符代码，并以一个停止 ( `1`) 位（用 标记`$`）结束。它继续发送停止位，直到发送下一个字符，从另一个起始位开始。

我们使用起始*位*而不是*字节*的原因是效率。上述方案需要 10 位（1[开始]+ 8[数据]+ 1[停止]）来传输 8 位数据，导致 (10 - 8) / 8 = 1/4 = 25% 的*开销*。如果我们使用 start 和 stop *bytes*，我们需要为每个数据字节传输 3 个字节，这将是 (3 - 1)/1 = 2 = 200% 的开销。如果起始字节、数据字节和停止字节各为 8 位，则我们必须为每个字符传输 24 位而不是 10 位，因此发送数据所需的时间几乎是 2 1/2 倍！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T23:15:49.297

人们总是可以将起始字节定义为消息开始的指示（ASCII SOH、STX 和 ETX 代码就是为此目的而设计的）。但是，用于连接数据传输设备（RS232C 及更高版本）的标准硬件和协议在较低级别上运行，通常既不可能也不希望改变这种安排（尤其是通过软件）。

高性能同步数据传输方案，例如在局域网和广域传输系统上使用的那些，确实使用了复杂的帧标记。帧标记是一种独特的位模式，永远不会出现在消息数据流中。通常有一个特殊的重写规则，它基本上“转义”任何类似位模式的数据内出现，以便传输设备不会将其视为帧标记。这些转义模式由接收者重构，因此发送者和接收者永远不必注意这一点。这些安排使专用硬件变得更加重要，例如在个人计算机上的典型网络接口卡（如今，主板芯片）中。

异步串行通信的背景

将异步串行传输视为字符/数据帧之间的异步和字符帧范围内的同步（包括起始位和初始停止/填充）是有用的。

使用这种方案，帧之间有一个恒定的填充信号，它通常至少有一个数据位宽，尽管有些安排需要 1.5 位或 2 位停止/填充。停止“位”使用相同的信号电平，可以认为是另一个起始位到达之前的最小填充周期。

当一个帧到达时，有必要与它预期携带的预定位数同步。从填充到相反电平信号的转换由始终与停止/填充电平相反的起始位完成。位的采样可以定时发生在随后的位到达周期的中间。

从技术上讲，如果帧以最大速率发送，则无需发送任何停止/填充，立即进入下一帧的起始位。然而，在开始位转换之前至少需要一个位的填充有助于保持发送者和接收者的同步。

如果您将异步流视为使用键盘从按键按下进行编码，您会看到允许在字符帧之间任意填充的重要性。一旦知道接下来要发送什么帧，就可以在之前的停止/填充至少有一个比特位之后，立即以约定的比特率插入它的起始比特。

还需要注意的是，在典型的低速异步传输中，只有两种位/级别，因此唯一可以区分数据存在而不是填充的方法是通过像这样的标记方案，其中帧的开始是唯一可检测的，帧的结束是预先确定的（除非有更复杂的可变长度帧结构，通常不用于异步串行通信）。实际上，如果没有一些额外的协议，接收器很难发现发送器的比特率，例如寻找一个可识别的数据序列，从中可以估计当它以不正确的形式到达时正确到达的比特率。

尽管高速调制解调器现在传输复杂的模拟信号，这些信号没有用两个简单的信号电平来描述，但计算机 UART 和调制解调器上的数据耦合之间的 RS232C（和更高模式）数字通信与描述的差不多.

高速调制解调器还具有与远程端点同步的附加功能，您可以通过在连接启动时收听信号音频来判断。此外，在连接到计算机的串行电缆中有单独的信号线，用于在计算机和调制解调器之间起搏，以便发送方传输新数据帧的速度不会超过接收方（计算机或调制解调器）可以接受的速度他们。但是一帧一旦开始，总是以约定的同步速度开始。

[维基百科对异步串行通信](http://en.wikipedia.org/wiki/Asynchronous_serial_communication)有很好的描述，计算机串行端口使用什么。

有一个常见的过度简化表明停止位决定了数据的长度。事实并非如此。停止位看起来就像另一个数据位的电平。识别停止位和直到下一个起始位的周期的方式是通过知道帧内数据和开始/停止位正在传输的比特率以及知道一个帧包含多少位。否则，作为数据帧的一部分，没有办法将停止位与该极性的另一位区分开来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T03:19:27.527

以下是开始位和停止位通常的工作方式：

1.  发送一个起始位，例如 1。这向接收器表明将传输指定数量的数据位，例如 8。
2.  发送 8 位数据。
3.  发送一个停止位，比如 0。这表示 8 位数据已发送。

如果要发送更多数据，则每个字节必须以起始位开始并以停止位终止。发送器和接收器必须就每个起始位发送多少位数据达成一致，以便接收器能够区分停止位和数据。有时起始位实际上是多个位甚至一个字节，但思路是一样的。接收器在接收到预定数量的数据位后看到停止位时识别出数据帧的结束。有时在停止位之前发送奇偶校验位以提供简单的错误检测机制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T03:21:37.773

这完全取决于协议。你可以说在开始符号之后你会期待 N 个符号，或者你会一直阅读直到遇到停止符号。

其中符号 colud 是任何 n 位序列（包括位和字节。）

实际上，您的位示例完全适用于使用字节而不是位的协议。

假设您发送 00000000 流 A 11111111 00000000 流 B 11111111。在这种情况下，您可能仍会将其与流 C = 流 A 11111111 00000000 流 B 混淆。

通常使用起始位，因为电压电平变化可以触发事件（请参阅触发器中的边沿触发[。](http://en.wikipedia.org/wiki/Flip-flop_(electronics))）另一方面，除了触发事件之外，还将使用具有多个位的起始符号来同步两个系统的时钟。PAL 信号就是一个例子。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-11-09T03:21:46.510

开始和停止位来自[电传打字机](http://en.wikipedia.org/wiki/ASR33)时代。它们本质上是需要时间来让机械硬件设置的脉冲。Dos 文本文件的行以 CR LF 结尾，这实际上导致回车返回到第 1 列，而压板前进一行。我认为这是有序的，因为 CR 需要更长的时间才能发生，而 LF 可以有效地并行发生。

检测它有点困难。你不得不看着比特流过去。随着时间的推移，您应该能够检测到它，因为数据通常是 ASCII 并带有开始/停止位。通常这不是问题，因为它由运行[COM](https://www.rfc-editor.org/rfc/rfc2217)端口的[UART处理。](http://en.wikipedia.org/wiki/UART)

# asp.net-mvc - ASP.NET MVC 框架是否支持异步页面执行？

> ID：275545
> 
> 赞同：8
> 
> 时间：2008-11-09T03:11:32.893
> 
> 标签：asp.net-mvc, asynchronous

我正在学习 ASP.NET MVC 框架，从这样的一些文章[中](http://weblogs.asp.net/stephenwalther/archive/2008/03/17/asp-net-mvc-in-depth-the-life-of-an-asp-net-mvc-request.aspx)，似乎 MvcHandler 只实现了 Execute()，没有实现异步 API。实际上，我认为 Controller 也没有异步 API。

那么，ASP.NET MVC 不支持异步编程吗？如果网页需要 I/O 操作，这可能是可扩展性的一大障碍。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-09T03:59:38.973

经过一番谷歌搜索，我发现了这个关于如何 DIY 异步 ASP.NET MVC 的很棒的博客。实现看起来简单明了。我想知道为什么 ASP.NET MVC 团队第一次没有这个功能。

[http://blog.codeville.net/2008/04/05/improve-scalability-in-aspnet-mvc-using-asynchronous-requests/](http://blog.codeville.net/2008/04/05/improve-scalability-in-aspnet-mvc-using-asynchronous-requests/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-09T03:57:48.307

目前，MVC 中没有内置异步支持。它在功能列表中，但不能保证它何时发布（以及以何种形式发布）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-10-16T17:43:55.193

MVC 2 通过 AsyncController 支持异步页面执行。

[http://msdn.microsoft.com/en-us/library/ee728598.aspx](http://msdn.microsoft.com/en-us/library/ee728598.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T07:07:07.963

正如 Brad 提到的，Microsoft 正在开发一种解决方案，作为 MVC 期货的一部分。还有一个实现：[http ://code.msdn.microsoft.com/AsyncMvc/Wiki/View.aspx?id=11350](http://code.msdn.microsoft.com/AsyncMvc/Wiki/View.aspx?id=11350)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-22T02:00:58.960

ASP.NET MVC 2 现在已经合并了 beat 版本中的 asnyc 控制器。看看这个。

# shell - 如何将 ^K 发送到 shell

> ID：275546
> 
> 赞同：1
> 
> 时间：2008-11-09T03:11:38.977
> 
> 标签：shell, applescript, control-characters

我想在终端中运行一个 shell 命令，然后从 Applescript 清除控制台。

如果我手动执行此操作，我会使用 ^K - 如何将字符串中的 ^K 字符发送到终端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T03:13:56.837

我认为您正在寻找“清除”命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T18:23:55.693

我认为建议“清除”的绅士可能已经解决了问题，但如果你真的想做你所说的，你可以简单地使用：

回声“^L”

（您将其键入为'echo“”'）

# php - 是否有 PHP 中路径引用的指南？

> ID：275550
> 
> 赞同：0
> 
> 时间：2008-11-09T03:14:21.860
> 
> 标签：php, directory-structure

我知道如何将文件夹中的文件包含在内，但我很难找到备份的方式。我决定将 set_include_path 设置为默认值，所有进一步包括相对于路径 2 级以上的路径，但丝毫不知道如何将其写出来。

是否有详细说明 PHP 路径引用的指南？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T05:26:45.693

我倾向于使用**[dirname](http://uk3.php.net/dirname)**来获取当前路径，然后以此为基础来计算所有未来的路径名。

例如，

```
$base = dirname( __FILE__ ); # Path to directory containing this file
include( "{$base}/includes/Common.php" ); # Kick off some magic 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T03:19:13.003

使用绝对路径来引用可能更容易：

```
set_include_path('/path/to/files'); 
```

这样，您就有了所有未来的参考点。包含相对于它们被调用的点进行处理，这在某些情况下可能会引起一些混乱。

例如，给定一个示例文件夹结构 ( `/home/files`)：

```
index.php
test/
  test.php
test2/
  test2.php

// /home/files/index.php
include('test/test.php');

// /home/files/test/test.php
include('../test2/test2.php'); 
```

如果您调用 index.php，它将尝试包含以下文件：

```
/home/files/test/test.php // expected
/home/test2/test2.php // maybe not expected 
```

这可能不是您所期望的。调用 test.php 将按`/home/files/test2/test.php`预期调用。

结论是，包含将相对于原始调用点。澄清一下，这也会影响`set_include_path()`它是否是相对的。考虑以下（使用相同的目录结构）：

```
<?php
// location: /home/files/index.php
   set_include_path('../'); // our include path is now /home/

   include('files/test/test.php'); // try to include /home/files/test/test.php
   include('test2/test2.php'); // try to include /home/test2/test2.php
   include('../test3.php'); // try to include /test3.php
?> 
```

# maven - Maven 快照存储库与发布存储库

> ID：275555
> 
> 赞同：118
> 
> 时间：2008-11-09T03:17:29.200
> 
> 标签：maven, repository, release, nexus, snapshot

**快照**存储库和**发布**存储库有什么区别？

这是关于设置存储库（如 Artifactory、Nexus 等）的参考

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2008-12-25T18:35:44.543

发布存储库保存发布，快照存储库保存快照。在 Maven 中，快照被定义为版本以 -SNAPSHOT 结尾的工件。部署时，快照会变成时间戳。根据定义，快照是可变的，发布是不可变的。这就是为什么 Nexus 让您将它们分开存储的原因，因为通常您不在乎是否丢失快照，但您会关心是否丢失版本。它使快照清理更容易以这种方式处理。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2014-04-18T09:38:15.733

**发布工件**

这些是特定的时间点发布。发布的工件被认为是可靠的、稳定的和永久的，以保证依赖于它们的构建随着时间的推移是可重复的。已发布的 JAR 工件与 PGP 签名相关联，校验和验证二进制软件工件的真实性和完整性。中央 Maven 存储库存储发布工件。

**快照工件**

快照捕获正在进行的工作并在开发过程中使用。快照工件具有版本号（例如“1.3.0”或“1.3”）和时间戳。例如，commons-lang 1.3.0 的快照工件可能具有名称 commons-lang-1.3.0-20090314.182342-1.jar。

取自[refcard](http://refcardz.dzone.com/refcardz/getting-started-repository#refcard-download-social-buttons-display)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-09-16T09:02:46.533

通常在 Maven 中，我们有两种类型的构建：

1)**快照构建**：SNAPSHOT 是指示当前部署副本的特殊版本，而不是常规的特定版本。Maven 检查远程存储库中每个构建的版本。快照构建只不过是开发构建。

2)**发布版本**：发布意味着删除版本 ID 处的 SNAPSHOT 版本。这些是常规的构建版本。

快照工件和发布工件分别推送到快照、发布存储库。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-01-19T06:59:10.663

快照是将版本号作为 -SNAPSHOTS 的 maven 想法，它正在开发中，它可以随时更改。

内部存储库是具有固定版本号的发布存储库。您可以修改 SNAPSHOTS，但该工件在发布后永远不会更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-08-08T07:47:47.387

这里的 SNAPSHOT 并不是真正的 ONE 快照被冻结并且不会改变，SNAPSHOT 涵盖了几个快照，它们的修改量不足以用新的版本号表示

# tsql - 如何从签入和签出列表中计算时间跨度？

> ID：275562
> 
> 赞同：0
> 
> 时间：2008-11-09T03:21:53.060
> 
> 标签：tsql, stored-procedures, group-by, schema-design

我正在编写一个简单的时间跟踪程序来管理我自己的项目。我非常喜欢在数据库中保存报告代码，所以我一直在尝试创建一些 sprocs 来生成发票和时间表等。

我有一个表，其中包含时钟操作、IE“Punch In”和“Punch Out”。它还包含执行此操作的用户、与该操作关联的项目以及当前日期/时间。

我可以从此表中选择以获取特定时间/项目/和用户的打卡信息，但我想将其汇总，以便每个打卡和打卡都从 2 行转换为包含总时间的单行。

例如，这是一个示例输出：

```
ClockActionID        ActionType DateTime
-------------------- ---------- -----------------------
17                   1          2008-11-08 18:33:56.000
18                   2          2008-11-08 18:33:59.587
19                   1          2008-11-08 18:34:01.023
20                   2          2008-11-08 18:34:02.037
21                   1          2008-11-08 18:45:06.317
22                   2          2008-11-08 18:46:14.597
23                   1          2008-11-08 18:46:16.283
24                   2          2008-11-08 18:46:17.173
25                   1          2008-11-08 18:50:37.830
26                   2          2008-11-08 18:50:39.737
27                   1          2008-11-08 18:50:40.547

(11 row(s) affected) 
```

其中 ActionType 1 是“ClockIn”，ActionType 2 是“ClockOut”。为简洁起见，我还删除了 User、Project 和 Description 列。

我需要在纯 SQL 中生成一个结果集，例如：

```
Description   |    Total Time 
```

对于每个 ClockIn / ClockOut 对。

我认为这实际上会相当简单，我只是不太确定采用哪种方法。

编辑：用户将能够同时进入多个项目，尽管首先将结果集缩小到单个项目，这对这里的逻辑没有任何影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T03:41:52.363

我认为您的原始存储架构存在缺陷。你从时钟的角度来看它，因此是 ClockAction。为什么不从项目的角度来看？

表 ProjectAction（Projectid、用户 ID、类型、开始、结束）

然后一个简单的 GROUP BY 应该可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T04:47:18.240

我同意这个设计不是最好的——一个基于事件的结构，单行开始-结束可能会为你节省很多时间。在这种情况下，您可以在有人打卡时创建一条结束日期为空的记录。然后，填写他们打卡时的结束日期。

但是，这不是你问的。这是您的问题的解决方案：

```
DECLARE @clock TABLE (ClockActionID INT PRIMARY KEY IDENTITY, ActionType INT, ActionDateTime DATETIME)

INSERT INTO @clock (ActionType, ActionDateTime) VALUES (1,'20080101 00:00:00')
INSERT INTO @clock (ActionType, ActionDateTime) VALUES (2,'20080101 00:01:00')
INSERT INTO @clock (ActionType, ActionDateTime) VALUES (1,'20080101 00:02:00')
INSERT INTO @clock (ActionType, ActionDateTime) VALUES (2,'20080101 00:03:00')
INSERT INTO @clock (ActionType, ActionDateTime) VALUES (1,'20080101 00:04:00')
INSERT INTO @clock (ActionType, ActionDateTime) VALUES (2,'20080101 00:05:00')
INSERT INTO @clock (ActionType, ActionDateTime) VALUES (1,'20080101 00:06:00')
INSERT INTO @clock (ActionType, ActionDateTime) VALUES (2,'20080101 00:07:00')
INSERT INTO @clock (ActionType, ActionDateTime) VALUES (1,'20080101 00:08:12')
INSERT INTO @clock (ActionType, ActionDateTime) VALUES (2,'20080101 00:09:00')

-- Get the range
SELECT ActionDateTime CheckIn, 
  (SELECT TOP 1 ActionDateTime 
   FROM @clock C2 
   WHERE C2.ActionDateTime > C.ActionDateTime) CheckOut   
FROM @clock C
WHERE ActionType = 1

-- Get the duration
SELECT DATEDIFF(second, ActionDateTime, 
  (SELECT TOP 1 ActionDateTime 
   FROM @clock C2 
   WHERE C2.ActionDateTime > C.ActionDateTime)
  ) / 60.0 Duration_Minutes
FROM @clock C
WHERE ActionType = 1 
```

请注意，我正在使用与 MS SQL Server 一起工作的表变量，仅用于测试。根据需要进行更改。另请注意，SQL Server 2000**不能很好地**处理此类查询。以下是测试结果：

```
CheckIn                 CheckOut
2008-01-01 00:00:00.000 2008-01-01 00:01:00.000
2008-01-01 00:02:00.000 2008-01-01 00:03:00.000
2008-01-01 00:04:00.000 2008-01-01 00:05:00.000
2008-01-01 00:06:00.000 2008-01-01 00:07:00.000
2008-01-01 00:08:12.000 2008-01-01 00:09:00.000

Duration_Minutes
1.000000
1.000000
1.000000
1.000000
0.800000 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T11:06:39.457

你有没有想过这样的事情：

*   有人忘记打卡，因此看起来他们打卡了两次？
*   有人忘记打卡，因此看起来他们打卡了两次？

在第一种情况下，简单地忽略第二次打卡是否正确？接受的答案会将两个时钟输入绑定到相同的时钟输出。那是对的吗？

在第二种情况下，第二个时钟输出将被忽略。那是对的吗？

# c# - WCF 是否在后台优化了客户端的连接？

> ID：275566
> 
> 赞同：4
> 
> 时间：2008-11-09T03:31:36.457
> 
> 标签：c#, .net, wcf, design-patterns, performance

我们目前正在开发一个将使用 WCF 服务的应用程序。主机（客户端）使用[来自 Erwyn van der Meer 的优秀 WCF 服务代理助手](http://bloggingabout.net/blogs/erwyn/archive/2006/12/09/WCF-Service-Proxy-Helper.aspx)。

我想知道......如果我多次打开这个对象......它会导致多个（昂贵的）连接还是WCF会管理它并汇集连接。

我想知道这一点的原因是因为我们将在同一个 Web 请求中的不同时间点调用服务的方法，并且我们目前已经在调用中包装了 Service 代理类的实例化。

例如。：

```
MyService.MyMethod1() // wraps the connection usage as well as the call to the service 
```

关于如何在保持代码符合[SRP](http://en.wikipedia.org/wiki/Single_responsibility_principle)的同时尽量减少连接量的任何建议都非常好。

所以？任何的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-09T04:59:57.293

您应该尽量减少您创建的代理对象的数量。WCF 中的代理设置起来非常昂贵，因此创建一个并在其上多次调用函数肯定比为每个方法调用创建一个新的更有效。

代理对象和连接之间的关系取决于所使用的传输方式。对于 http 传输，每个函数调用都会启动一个 HTTP 连接。对于 net.tcp 传输，连接在 Open() 时间建立并保持到 Close()。某些绑定设置（例如支持 WS-SecureConversation 的那些）将导致额外的“内务处理”连接和消息交换。

AKAIK，没有一个开箱即用的绑定执行连接池。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T09:13:15.830

如果这就是您的意思，它不会像 SqlConnection 那样进行池化。

[警告：我在这里松散地使用“连接”来表示逻辑连接，不一定是物理连接]

在按需使用连接和保留一个连接之间，这两种方法各有利弊。初始化连接有一些开销，所以如果你正在做 5 件事，你应该尝试在同一个代理上做它们 - 但我不会仅仅为了它而保留一个长期代理。

特别是在生命周期管理方面，一旦代理出现故障，它就会一直处于故障状态——因此您需要能够从偶尔出现的故障中恢复（这应该是意料之中的）。同样，在某些配置（会话/实例的某些组合）中，连接在服务器上具有明确的占用空间 - 因此，为了提高可伸缩性，您应该保持连接的短暂性。当然，为了*真正*的可扩展性，您通常还是希望禁用这些选项！

创建连接的成本还取决于安全模式等因素。IIRC，使用消息安全性打开双向验证连接将比设置 TransportWithMessageCredential 连接更昂贵 - 所以“YMMV”在这里非常常见。

就个人而言，我发现代理性能最大的常见问题与设置连接的时间无关 - 它是 API 的闲聊。IE

情景一：

*   打开连接
*   使用大负载执行 1 次操作（即表示“做这 19 件事”的消息）
*   关闭代理

场景 B：

*   打开一个连接
*   使用小负载执行 19 次操作
*   关闭连接

然后，由于延迟等原因，场景 A 通常会*明显*更快。而且 IMO 甚至不会考虑通过 WCF 进行分布式事务；-p

# javascript - Javascript回调函数和递归

> ID：275569
> 
> 赞同：16
> 
> 时间：2008-11-09T03:40:24.973
> 
> 标签：javascript, recursion, callback

这是一个脑筋急转弯的问题，因为代码按原样工作得非常好，它只是稍微刺激了我的审美意识。我转向 Stack Overflow 是因为我自己的大脑现在让我失望了。

这是一段使用 Google Maps JS API 查找地址并在地图上放置标记的代码片段。但是，有时初始查找会失败，所以我想用不同的地址重复这个过程。

```
geocoder.getLatLng(item.mapstring, function(point) {
    if (!point) {
        geocoder.getLatLng(item.backup_mapstring, function(point) {
            if (!point) return;
            map.setCenter(point, 13);
            map.setZoom(7);
            map.addOverlay(new GMarker(point));
        })
        return;
    }
    map.setCenter(point, 13);
    map.setZoom(7);
    map.addOverlay(new GMarker(point));
}) 
```

（第二个参数`getLatLng`是回调函数。）

当然，您可以看到使地图居中和缩放地图以及添加标记的三行是重复的，一次在主回调中，一次在“后备回调”中（哈哈）。你能找到一种方法来表达整个事情而没有任何冗余吗？如果您的解决方案适用于任意数量的备份地图字符串，您将获得奖励积分和我的赞美。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-09T06:25:25.327

其他答案很好，但这里还有一个选择。这使您可以保持与开始时相同的形式，但使用命名 lambda 函数的技巧，以便您可以递归地引用它：

```
mapstrings = ['mapstring1', 'mapstring2', 'mapstring3'];

geocoder.getLatLng(mapstrings.shift(), function lambda(point) {
   if(point) {
        // success
        map.setCenter(point, 13);
        map.setZoom(7);
        map.addOverlay(new GMarker(point));
    }
    else if(mapstrings.length > 0) {
        // Previous mapstring failed... try next mapstring
        geocoder.getLatLng(mapstrings.shift(), lambda);
    }
    else {
        // Take special action if no mapstring succeeds?
    }
}) 
```

第一次使用符号“lambda”，是为了引入它作为一个新的函数字面量名称。第二次使用时，是递归引用。

函数字面量命名适用于 Chrome，我认为它适用于大多数现代浏览器，但我没有测试过它，我不知道旧浏览器。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-09T04:27:03.523

有一种非常好的方法可以在不明确支持递归的语言结构中执行递归，称为*定点组合*器。最著名的是[Y-Combinator](http://en.wikipedia.org/wiki/Fixed_point_combinator)。

[这是 Javascript 中一个参数的函数的 Y 组合器](http://www.cs.cityu.edu.hk/~hwchun/31337/blog/2005/09/y-combinator-in-javascript.php)：

```
function Y(le, a) {
    return function (f) {
        return f(f);
    }(function (f) {
        return le(function (x) {
            return f(f)(x);
        }, a);
    });
} 
```

这看起来有点吓人，但你只需要写一次。使用它实际上非常简单。基本上，您使用一个参数的原始 lambda，并将其转换为两个参数的新函数 - 第一个参数现在是您可以进行递归调用的实际 lambda 表达式，第二个参数是原始的第一个参数 ( `point`) 你想使用的。

这就是您在示例中使用它的方式。请注意，我将`mapstrings`其用作要查找的字符串列表，并且 pop 函数会破坏性地从头部删除一个元素。

```
geocoder.getLatLng(pop(mapstrings), Y(
  function(getLatLongCallback, point)
  {
    if (!point)
    {
      if (length(mapstrings) > 0)
        geocoder.getLatLng(pop(mapstrings), getLatLongCallback);
      return;
    }

    map.setCenter(point, 13);
    map.setZoom(7);
    map.addOverlay(new GMarker(point));
  }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T04:13:36.093

是的，把它分解成一个函数:)

```
geocoder.getLatLng(item.mapstring, function(point) {
    if (!point) {
        geocoder.getLatLng(item.backup_mapstring, function(point) {
                if (point) {
                    setPoint(point);
                }
        })
        return;
    }

    function setPoint(point) {
        map.setCenter(point, 13);
        map.setZoom(7);
        map.addOverlay(new GMarker(point));
    }

    setPoint(point);
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T04:00:24.667

这个怎么样？

```
function place_point(mapstrings,idx)
{
    if(idx>=mapstrings.length) return;
    geocoder.getLatLng(mapstrings[idx],
                       function(point)
                       {
                           if(!point)
                           {
                               place_point(mapstrings,idx+1);
                               return;
                           }
                           map.setCenter(point, 13);
                           map.setZoom(7);
                           map.addOverlay(new GMarker(point));
                       });
} 
```

尽可能多的备份字符串。只需第一次使用 0 作为第二个参数调用它。

# c# - 如何在没有浏览器的情况下以编程方式将图像上传/发布到图像托管网站？

> ID：275571
> 
> 赞同：0
> 
> 时间：2008-11-09T03:45:20.347
> 
> 标签：c#, .net, upload

我想编写一个简单的实用程序，通过文件的右键单击上下文菜单将图像上传到各种免费图像托管网站，如 TinyPic 或 Imageshack。

如何使用 .NET 做到这一点？我见过一些使用 cURL 将图像发布到这些网站的 linux 脚本，但我不确定如何创建发布请求，并在 C# 中完成图像？

有人可以指出我正确的方向吗？

* * *

编辑：

我找到了一个很好的资源。Cropper 是一个用 .net 编写的免费截图工具，有很多开源插件。其中之一是 SendToTinyPic.. 完整的源代码。链接在这里： http:
[//www.codeplex.com/cropperplugins](http://www.codeplex.com/cropperplugins)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-09T04:05:09.480

FlickrNet [API](http://www.codeplex.com/Wiki/View.aspx?ProjectName=FlickrNet)使得从 .NET 使用 Flickr 变得非常容易。您必须拥有 Flickr 帐户以及[API 密钥和共享密钥](http://www.flickr.com/services/api/misc.api_keys.htm)。一旦你有了你需要的东西，使用 API 就非常简单了：

```
// http://www.flickr.com/services/api/misc.api_keys.html
string flickrApiKey = "<api key>";
string flickrApiSharedSecret = "<shared secret>";
string flickrAuthenticationToken = "<authentication token>";

Flickr flickr = new Flickr( flickrApiKey, flickrApiSharedSecret );

flickr.AuthToken = flickrAuthenticationToken;    

foreach ( FileInfo image in new FileInfo[] { 
    new FileInfo( @"C:\image1.jpg" ), 
    new FileInfo( @"C:\image2.jpg" ) } )
{
    string photoId = flickr.UploadPicture(
        image.FullName, image.Name, image.Name, "tag1, tag2" );
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T03:48:20.793

使用 HttpWebRequest。

使用此类，您可以将数据发布到远程 HTTP 地址，只需将 mime/type 设置为 multi-part/form 编码，然后将图像中的二进制数据与请求一起发布。

[http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest(VS.71).aspx](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest(VS.71).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T04:17:09.593

对于 ImageShack，请查看[此 Application](http://www.anappaday.com/downloads/2006/10/day-19-jedi-image-shacker.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-02T18:50:28.470

[据我所知， TinyPic.com](http://tinypic.com)没有 API，但 Cropper SendToTinyPic 插件尝试使用“屏幕抓取”上传。官方版本的插件现在还不行，但是我用同样的方法做了一个补丁，提交到[cropperplugins项目](http://cropperplugins.codeplex.com)。它只是一个改变的源模块。任何人都可以下载插件项目，然后放入我的补丁，它应该可以工作。

使用补丁，它的 PritScrn 或 Alt-PrntScrn 将保存图像并上传到 tinypic，并将原始图像的 URL 填充到剪贴板上。全部在 2 秒内完成。简单的。

如果您不想要实际的工具，您仍然可以查看我的补丁的源代码，以了解如何发布带有表单数据和文件上传的页面。没有直接链接。请参阅[http://cropperplugins.codeplex.com/SourceControl/PatchList.aspx](http://cropperplugins.codeplex.com/SourceControl/PatchList.aspx)并查找 #3239。

* * *

此示例图像已生成，然后使用 Alt-PrtScrn 组合键自动上传到 tinypic.com。 [![示例图片](https://i.stack.imgur.com/WfEhw.png)](https://i.stack.imgur.com/WfEhw.png)

要将其嵌入此处，我只需按 ctrl-V，因为 URL 存储在剪贴板上。

# python - SQLObject 下的数据库更改

> ID：275572
> 
> 赞同：1
> 
> 时间：2008-11-09T03:46:40.000
> 
> 标签：python, mysql, database, sqlite, sqlobject

我正在启动一个使用 SQLite 可能应该没问题的 Web 项目。我在它上面有 SQLObject，但是从长远来看——如果这个项目需要更健壮的（例如能够处理高流量），我需要准备一个过渡计划。我的问题：

1.  在 SQLObject 下从一个数据库 (SQLite) 转换到另一个数据库 (MySQL 或 Firebird 或 PostGre) 有多容易？
2.  SQLObject 是否提供任何工具来简化这种转换？它只是简单地获取我定义的对象并调用 createTable 吗？
3.  如果有多个 SQLite 数据库呢？例如，每个访客组一个？SQLObject 是否提供了处理这种情况的机制，如果提供，使用的机制是什么？

谢谢，肖恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T11:53:37.943

3) 是一个非常有趣的问题。一般来说，SQLite 对于基于 Web 的东西来说是毫无用处的。它的大小可以很好地扩展，但并发性的扩展性很差，所以如果你打算同时处理几个请求，你就会遇到麻烦。

现在您在问题的第 3 部分中的想法是使用多个 SQLite 数据库（例如，每个用户组一个，甚至每个用户一个）。不幸的是，SQLite 在这个部门不会给你任何帮助。但这是可能的。我知道以前做过的一个项目是[**Divmod 的 Axiom**](http://www.divmod.org/trac/wiki/DivmodAxiom)。所以我肯定会检查一下。

当然，使用像您提到的那些（Firebird、PG 等）这样的良好并发数据库可能会容易得多。

为了完整性：

1 和 2）它应该很简单，无需您实际编写**太多**代码。我发现这个部门的 SQLObject 有点限制，并且强烈推荐使用[**SQLAlchemy**](http://www.sqlalchemy.org/)。这要灵活得多，如果我今天开始一个新项目，我肯定会在 SQLObject 上使用它。它不会在任何地方移动“对象”。这里没有魔法，它将在数据库中的表中传输行。如前所述，您可以手动完成，但这可能会为您节省一些时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T06:20:43.107

您使用 createTable() 的成功将取决于您现有的基础表架构/数据类型。换句话说，SQLite 映射到您选择的数据库的程度以及 SQLObject 如何决定使用您的数据类型。

最安全的选择可能是手动创建新数据库。然后您将不得不处理数据迁移，这可能就像在相同的表定义上实例化两个 SQLObject 数据库连接一样简单。

为什么不从功能更全面的数据库开始呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T04:06:02.223

我不确定我是否理解这个问题。

[SQLObject 文档](http://www.sqlobject.org/SQLObject.html#dbconnection-database-connections)列出了六种可用的连接。此外，数据库连接（或方案）在连接字符串中指定。将数据库连接从 SQLite 更改为 MySQL 是微不足道的。只需更改连接字符串。

该[文档](http://www.sqlobject.org/SQLObject.html#declaring-a-connection)列出了支持的不同类型的方案。

# c++ - 输出 ASCII 值 C++

> ID：275577
> 
> 赞同：-2
> 
> 时间：2008-11-09T03:53:29.953
> 
> 标签：c++, hex, ascii

如果我有一个 char 包含一个十六进制值，例如 0x53，（S），我如何将其显示为“S”？

代码：

```
char test = 0x53;
cout << test << endl; 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-09T05:24:02.097

没有存储十六进制值、十进制或八进制值的变量之类的东西。十六进制、八进制和十进制只是向编译器表示数字的不同方式。编译后的代码将以二进制表示所有内容。

这些语句都具有**完全相同的**效果（假设字符集是 ASCII）：

```
test = 0x53; // hex
test = 'S';  // literal constant
test = 83;   // decimal
test = 0123; // octal 
```

因此，无论您如何为其分配值，都以与任何字符相同的方式打印字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T06:13:31.153

只需使用以下内容，您已经回答了您的问题：

```
using namespace std;

int main() {
    char test = 0x53;
    std::cout << test << std::endl;
    return 0;
} 
```

# cocoa - 可可绑定问题；绑定表列不显示任何数据，控制台中没有错误

> ID：275593
> 
> 赞同：2
> 
> 时间：2008-11-09T04:16:49.330
> 
> 标签：cocoa, cocoa-bindings, nsarraycontroller, key-value-coding

我在将 Cocoa 项目从手动同步的接口模型转换为绑定模型时遇到了麻烦，因此我不必担心接口胶水代码。

我遵循了 CocoaDevCentral [Cocoa Bindings 教程](http://cocoadevcentral.com/articles/000080.php)，以确保我已经涵盖了所有基础，但事情并没有正常工作。我有一个主从界面，但我什至无法让界面的主部分正常工作。主列中没有显示任何数据，即使我已经设置了类似于教程中显示的绑定模型。我已经确保我所有的控制器和对象都有`-(id)key`并且`-(void)setKey:(id)key`方法，以便它们与绑定兼容，我在我的 nib 中创建了一个 ControllerAlias 对象，将其连接到我的控制器，创建了一个 NSArrayController 绑定到 ControllerAlias 连接到的类中的 NSMutableArrays 之一，确保设置数组中包含的对象类型，然后我将表列绑定到 NSArrayController。

我在控制台中没有收到任何错误，设置`NSBindingDebugLogLevel`为 1 也不会产生任何错误，这将帮助我找出问题所在。

为了确保一切正常，我唯一能想到的另一件事是检查连接到 NSArrayController 的 NSMutableArray 中是否确实包含某些内容，并且确实存在。

有什么建议么？我应该检查 Cocoa 绑定还有哪些其他典型的陷阱？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T04:33:29.343

您是否在 key: 方法中设置了断点来确定它是否被调用？如果不是，则表明没有为表列中的绑定正确设置某些内容（因为您已验证您的数组中确实包含项目）。

我认为您不再需要创建对象控制器（该教程有点过时了）。只需在您的 NIB 中创建一个对象，并将其类设置为您的控制器类。您可以直接通过它而不是 ObjectController 来设置绑定。

要设置绑定，我执行以下操作：

1.  在 NIB 中创建我的控制器的实例。
2.  创建一个 NSArrayController，将它绑定到我的控制器中的一个数组。
3.  对于表中的每一列，将值绑定到数组控制器中对象的成员。

这应该是您需要做的所有事情 - 我认为自从绑定在几个版本之前首次引入以来，他们已经清理了很多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T04:48:18.207

> 我在我的笔尖中创建了一个 ControllerAlias 对象，

什么是“控制器别名”？这是模型、控制器还是视图？

> 将它连接到我的控制器，

你是什​​么意思？

> 创建了一个 NSArrayController 绑定到 ControllerAlias 连接到的类中的 NSMutableArrays 之一，

类没有`NSMutableArray`s。

你绑定了数组控制器的什么属性？

你把它绑定到什么对象上？

您将它绑定到该对象的哪个关键路径？

> …然后我将一个表列绑定到 NSArrayController。

你绑定了表格列的什么属性？

您将它绑定到数组控制器的哪个属性（键路径）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T06:04:34.870

所以在我的原始代码中，我在 awakeFromNib 中而不是在 init 中修改了数组（NSArrayController 所代表的），所以这些更改没有反映在界面中，因为我没有通过键值观察来修改数组方法。

我将代码从

```
theArray = [[NSMutableArray alloc] init];
[theArray addObject:newThing]; 
```

至：

```
theArray = [[NSMutableArray alloc] init];
NSMutableArray *bindingsCompliantArray = [self mutableArrayValueForKey:@"things"];
[bindingsCompliantArray addObject:newThing]; 
```

我认为另一种解决方案是在 -(id)init 方法而不是 -(void)awakeFromNib 方法中进行加载，但这需要更大的重构，所以我没有这样做。

我通过添加一个按钮来通过 NSArrayController 在数组列表中创建一个新事物来解决这个问题，当我单击该按钮时，一个新事物被添加到数组中，并且我现有的数组也神奇地出现了。

# mfc - MFC开发最活跃的社区资源有哪些？

> ID：275595
> 
> 赞同：1
> 
> 时间：2008-11-09T04:18:39.483
> 
> 标签：mfc

我想知道 MFC 开发的最佳社区资源是什么——例如论坛、IRC 频道等。目前，我在 MFC 上找到已回答问题的唯一资源是使用 google 提供 Codeproject 结果或 MSDN 上的偶尔结果或其他一些网页。既然有了stackoverflow，我相信我会在这里问更多问题，但我还想念吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T04:41:12.277

[MVP Tips](http://www.flounder.com/mvp_tips.htm)是与 Visual c++ 和 MFC 相关的文章和信息的宝库。除了 codeplex 和 Microsoft 新闻组/论坛之外，没有太多内容

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T08:13:03.597

[codeproject](http://www.codeproject.com/KB/MFC/)是我最喜欢的网站
还有一本很棒的书

[![MFC 答案](https://i.stack.imgur.com/QbXhf.jpg)](https://i.stack.imgur.com/QbXhf.jpg)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T12:34:31.870

您还应该查看[microsoft.public.vc.mfc](http://www.microsoft.com/communities/newsgroups/list/en-us/default.aspx?dg=microsoft.public.vc.mfc)和[microsoft.public.vc.language](http://www.microsoft.com/communities/newsgroups/list/en-us/default.aspx?dg=microsoft.public.vc.language)新闻组，以及 MSDN 上的[Visual C++ General](http://social.msdn.microsoft.com/forums/en-US/vcgeneral/threads/)和[Visual C++ Language](http://social.msdn.microsoft.com/forums/en-US/vclanguage/threads/)论坛，那里有一些知识渊博且乐于助人的人。（遗憾的是 MSDN 论坛的设计没有更好 - 他们应该仔细看看 StackOverflow。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T08:15:20.877

efnet 上的 irc #winprog

# standards - 自定义工具指南

> ID：275603
> 
> 赞同：1
> 
> 时间：2008-11-09T04:28:44.830
> 
> 标签：standards

在开发产品时，我们经常需要创建专有工具来测试它们的一些独特功能或诊断问题。事实上，这些工具至少与产品本身一样有趣，我们的一些内部小组已经要求提供它们的副本。

因此，除了明显的业务驱动规则（*例如*，不要检索敏感数据）之外，**在构建个人或内部工具时，与销售产品相比，您有什么不同，为什么？**

在内部工具中，什么对您来说更重要（或不那么重要），您在构建它们时是否考虑对公司的整体价值？

谢谢你的想法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T04:50:23.973

1.  首先，内部工具总是开发得又快又脏。几乎没有测试——它只需要完成工作。
2.  UI 不如面向客户的应用程序重要。
3.  内部工具可以使用他们测试的产品和框架的内部/私有/专有知识。例如，我们的上一个产品绕过了我们已发布的 API 的一部分，并使用了未记录的 Web 服务调用来获得更好的结果。
4.  这一点很重要，但却是一场失败的战斗：**永远不要**将内部工具留给客户。作为一名顾问，我有时不得不在现场使用甚至开发这些工具。我试图对我的客户隐藏它，但他们不时要求我把工具留在他们身边（或者更糟糕的是，打电话给销售代表并要求那个“神奇工具”）。您不希望客户根据第 1-3 点构建的工具来判断您整个公司的生产水平。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T04:44:29.493

从工程的角度来看，我不会做任何不同的事情：

*   内部和销售工具都需要编写良好并有据可查
*   两者都需要根据一组要求、截止日期、预算限制等来创建。
*   两者都需要测试或验证

我看到的一大区别适用于待售产品，而不是内部工具：**待售产品需要营销、支持等**，而内部工具则不需要。

此外，由于内部工具将在更受控制的环境中使用，因此无需针对不同的计算机系统、Internet 浏览器等进行测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T05:04:23.370

最大的不同：

借助个人和内部工具，您可以更自由地尝试新技术、最新时尚。您可以承担实际交付给客户的应用程序不会承担的风险。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T04:51:46.780

由于我构建的诊断程序通常具有非常特殊的用途，因此我倾向于提供比面向客户的产品更多的选项和内置示例。换句话说，我假设用户比客户通常更熟悉该技术，并且我提供了更多调整工具操作方式的能力，而不必担心它可能会让用户不知所措。但我也尝试让它满足 80% 的用例，而无需用户提供太多“帮助”。

# hibernate - 使用 wicket hibernate.cfg.xml 文件去哪里？

> ID：275610
> 
> 赞同：0
> 
> 时间：2008-11-09T04:41:26.863
> 
> 标签：hibernate, wicket

我是 Wicket 和 Hibernate 的新手，无法通过“org.hibernate.HibernateException: /hibernate.cfg.xml not found”错误。我已经将该文件放在每个可以想象的位置，但我仍然卡住了。该文件到底在哪里和/或我在某处缺少检票口文件配置设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-10T04:10:52.290

确保将 hibernate.cfg.xml 文件放在类路径中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T20:30:12.300

如果您刚开始使用 Wicket 和 Hibernate，您可能会对[Databinder 工具包](http://databinder.net)感兴趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T14:12:38.837

我会将 hibernate,cfg.xml 放在应用程序的 /WEB-INF 文件夹中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-30T00:54:22.560

连接该技术的常用形式是使用 springframework，看看[http://wicketinaction.com/2009/06/wicketspringhibernate-configuration/](http://wicketinaction.com/2009/06/wicketspringhibernate-configuration/)

还有 springframework 帮助你处理延迟加载异常和事务管理

# javascript - 你如何阅读这个 JavaScript 正则表达式？

> ID：275625
> 
> 赞同：5
> 
> 时间：2008-11-09T05:04:16.257
> 
> 标签：javascript, regex

```
var pattern = /^0+$/; 
```

我的猜测是这样的：

“查看字符串的开头和结尾，如果开头和结尾有一个或多个零的模式，则返回该模式。”

不过，我确定这是错误的，因为当我使用此字符串运行表达式时：

```
var string = "0000009000000"; 
```

它出现了`null`。

那么它到底在说什么？当我问的时候，JavaScript 是如何考虑字符串的开头、中间和结尾的？

**更新＃1：**感谢您的回复！我想我现在明白了。我的困惑源于我将字符串可视化为具有开头、中间和结尾的事实。像这样：

[开始][中间][结束]

换句话说，对于上面给定的字符串，以下表达式按我的预期工作：

`/^0+/;`返回“000000”（字符串开头有一个或多个零的模式）

和

`/0+$/`; 返回“000000”（字符串末尾有一个或多个零的模式）

**更新#2：**我对这一点的所有回复都投了赞成票，因为它们都很有帮助，我将答案汇编成一个伟大的答案：

给定以下 JavaScript 代码：

```
var string = "0000009000000";
var regExp = /^0+$/; 
alert(regExp.exec(string)); 
```

它的部分内容如下：

“如果正则表达式中 ^ 修饰符和 $ 修饰符之前的确切字符不是同时位于字符串的第一个位置和字符串的最后一个位置（即，它们不是字符串中唯一的字符），然后返回`null`。否则，返回字符。”

换句话说，假设给定的字符串是六个零“000000”。这会导致匹配，因为完全相同的“0”字符组位于字符串的第一个位置（**1st 2nd 3rd** 4th 5th 6th）和最后一个位置（1st 2nd 3rd **4th 5th 6th**）。

但是，在原始给定字符串中，有六个零，然后是一个九，然后是六个零（“0000009000000”）。现在，字符串第一个位置的六个零 (1st, 2nd, 3rd, 4th, 5th, 6th) 与字符串最后位置的六个零 (8th, 9th, 10th, 11th, 12th) 不完全相同，第 13 次）。因此，`null`返回 a。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-09T05:05:24.070

意思是你的字符串只包含 0...它必须开始，然后有 1 个或多个 0，然后结束。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-09T05:09:32.673

^0+$

*   在字符串«^»的开头断言位置
*   匹配字符“0”字面意思«0+»
    *   在一次和无限次之间，尽可能多次，根据需要回馈（贪婪）«+»
*   断言字符串末尾的位置（或字符串末尾的换行符之前，如果有的话）«$»

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T05:11:25.150

如果您希望它与您的字符串匹配，您希望您的正则表达式类似于：

```
var pattern = /^0+.*0+$/ 
```

这将在开头匹配 1 个或多个“0”，在末尾匹配 1 个或多个“0”，以及在中间匹配 0 个或多个任何内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-09T05:14:31.663

至少有一个**0**的模式，锚定在一行的开头（**^**）和结尾（**$**）；换句话说，字符串由一个或多个零组成。

要匹配由数字 0 到 9 组成且以至少一个零开头和结尾的字符串，模式

```
/^0+[0-9]+0$/ 
```

会起作用，即匹配一个或多个零，然后匹配一个或多个数字 0-9，以零结尾。

除非另有说明，JavaScript 会将整个字符串视为一行，忽略换行符；要强制它考虑多个单独的行，请使用**m**修饰符，例如

```
/regex/m 
```

**另请参阅：** [Mozilla 开发人员中心上的 JavaScript 正则表达式概述](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/RegExp)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-09T12:10:31.213

回应你的更新——你是对的。正则表达式将尝试匹配的字符串确实有开头、中间和结尾。

但你知道吗？所有的字符串都有开始和结束。

您的正则表达式说，字符串必须有一个开头，一个结尾，并且*在两者之间*，**只有**一个零字符串。

不要认为你`000000`在开始，或者你`900000`在结束。事实上，暂时忽略开始和结束的想法。

*   这个正则表达式匹配“必须在某处有一些零”：`/0+/`
*   这个正则表达式匹配“必须有一些零，*没有别的*：`/^0+$/`

为什么我们要添加 ^ 和 $？

因为“and nothing else”没有正则表达式符号，所以我们必须指定“字符串开头，一些零，字符串结尾”，这也是同样的事情。

顺便说一句，你也弄错了：

> 如果在开头和结尾有一个或多个零的模式，则返回该模式

你的正则表达式不会返回“那个模式”，它只会返回`true`. 您需要括号来掌握模式：`/^(0+)$/`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-10T22:26:42.860

@CodeCurious，你仍然让它比它需要的更复杂。正则表达式`/^0+$/`仅表示整个字符串由一个或多个零组成。正则表达式提供了很多混淆的机会，所以只要你能找到它，就接受简单。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-09T06:24:07.687

```
/(^0+|0+$)/ 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-09T12:19:10.650

我总是把我的正则表达式变成人类语言，以确保它是我的意思。

这个：^0+$

内容如下：“如果从我的字符串的开头 (^) 开始，您至少找到一个 (+) 零 (0)，直到字符串的结尾 ($) 才找到其他内容。”

请记住，正则表达式基本上是一堆“如果”语句。所以首先，它必须是“真实的”，然后它会返回最好的结果。正则表达式永远不会返回“有点真实”或“大部分真实”的结果。

# excel - Excel：“无法设置应用程序类的计算属性”

> ID：275630
> 
> 赞同：8
> 
> 时间：2008-11-09T05:06:05.953
> 
> 标签：excel

我正在尝试自动化 MS Excel 中的一些内容。当我尝试设置计算属性时，我收到以下错误消息：“无法设置应用程序类的计算属性”

我相信这个属性应该是可设置的。

任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-09T08:19:23.117

您需要有一个打开的工作簿，即

```
import win32com

# Create new Excel instance
xl = win32com.client.DispatchEx("Excel.Application")  

# Open blank workbook
xl.Workbooks.Add()

# Set property
xl.Calculation = win32com.client.constants.xlCalculationManual 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T05:11:24.213

确保将其设置为正确的值。

```
 Application.Calculation = xlCalculationManual 
```

或以下值之一：

xlCalculationAutomatic：Excel 控制重新计算。
xlCalculationManual：计算在用户请求时完成。
xlCalculationSemiautomatic：Excel 控制重新计算，但忽略表中的更改。

# html - HTML 最佳实践

> ID：275631
> 
> 赞同：25
> 
> 时间：2008-11-09T05:07:31.397
> 
> 标签：html, meta-tags

您可以在HTML 文档中`<meta>`放置标签和其他内容。`<head>`您在 HTML 文档中使用了哪些`<meta>`标签等和最佳实践，以使其更易于访问、可搜索、优化等。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-09T06:02:52.813

就我而言：

*   标题（应该做 [Section Name - Site Name] 以获得更好的 SEO）
*   `Content-type`、`description`和的元标记`keywords`
*   链接到样式表（不要忘记指定`media=""`）。
*   `<script>`链接到外部 javascript 文件的标记。

所有标签都应遵循 W3C 的标准。W3C 站点有一个关于 HTML部分的技术和详细的[部分](http://www.w3.org/TR/REC-html40/struct/global.html#h-7.4)`<head>`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-09-26T20:41:06.770

帮您的用户一个忙，并在安装[Chrome Frame](http://blog.chromium.org/2009/09/introducing-google-chrome-frame.html)时让他们的 IE 引擎切换到 Chrome 引擎:)

```
<meta http-equiv="X-UA-Compatible" content="chrome=1"> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-09T06:41:58.930

您需要将 SCRIPT 元素放在页面末尾，然后再关闭 BODY 元素。有关详细信息，请参阅[http://developer.yahoo.com/performance/rules.html#js_bottom](http://developer.yahoo.com/performance/rules.html#js_bottom)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-09T13:10:42.077

除了通常的文档类型、标题等，我将尝试为您提供一些我学到和实施的可能对您有所帮助的东西。

首先，请记住，为了获得最佳用户体验，标题应该首先包含最相关的子部分。这是因为它通常显示在标题栏/选项卡列表/书签名称中。考虑这个页面标题......

```
Stack Overflow - HTML head best practices 
```

变成 Stack Overflow...（咀嚼以节省标签栏/书签列表中的空间）

现在，如果您打开了 5 个 Stackoverflow 选项卡（就像我经常做的那样：P），那么用户如何知道哪个是哪个？

还要注意 CSS 的级联性质......所以这些的顺序很重要。与 Javascript 相同，必须允许对其他外部站点的任何依赖。我把我的放在头上，并没有注意到性能下降。我把它们放在那里是因为它对我来说看起来更整洁和合乎逻辑。尽管其他一些人会建议将`<script src="">`链接放在之前，`</body>`这样浏览器就不会暂时停止……只要使用最适合您网站的东西。

还有一个带有“一般”的“评级”元标记，让网络过滤软件知道您的网站对所有年龄段的观众都是安全的（当然，只要它是安全的！）

我也用..

```
<link rel="start" href="/" title="Home" /> 
```

让浏览器知道我网站的主页在哪里。对于任何浏览器预取系统，尽管我相信在没有插件帮助的情况下这些还没有被浏览器实现。

`<link rel="">`如果您的页面处于排序序列中，还要考虑“下一个”和“上一个”。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-01-06T18:32:20.093

首先，确保 < !DOCTYPE 是文档的第一个元素，即没有空格、制表符或损坏的 BOM 标记。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- declare all page rendering and programmatic related tags -->
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <!-- Care about IE ? -->
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <!-- globalise scripting and styling content language  -->
    <meta name="Content-Type-Script" content="text/javascript" />
    <meta name="Content-Type-Style" content="text/css" />
    <!-- title tag is MANDATORY -->
    <title>Short and relevant, about 64 characters/spaces</title>
    <!-- declare all CACHE controll -->
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW" />
    <meta name="revisit-after" content="7 days" />

    <!-- declare all content description tags -->
    <meta http-equiv="PICS-Label" content='(PICS-1.1 "http://www.gcf.org/v2.5" labels on "1994.11.05T08:15-0500" until "1995.12.31T23:59-0000" for "http://w3.org/PICS/Overview.html" ratings (suds 0.5 density 0 color/hue 1))'>
    <!-- language specific keywords -->
    <meta name="keywords" lang="en-us" content="vacation, Greece, sunshine" />
    <!-- For french example -->
    <meta name="keywords" lang="fr" content="vacances, Grèce, soleil" />
    <meta name="description" content="about 255 characters/spaces WORDS relevant to the content of the actual page" />
    <meta name="Abstract" content="about 96 characters/spaces PARAGRAPH describing the actual page content within your site" />

    <!-- declare all situationnal and external relativity related tags -->
    <link rel="DC.identifier" type="text/plain" href="http://www.ietf.org/rfc/rfc1866.txt" />
    <link rel="start" href="/" title="Home" />
    <link rel="prev" href="../" title="Parent section" />

    <!-- declare all page rendering cascading style sheets in order of incidence -->
    <link rel="stylesheet" type="text/css" href="globaly-used.css" />
    <link rel="stylesheet" type="text/css" href="specificly-used.css" />
    <!-- declare all page rendering specific cascading style i.e. IE only, hacks etc -->
    <link rel="stylesheet" type="text/css" href="more-specificly-used.css" />
    <link rel="stylesheet" type="text/css" href="i-love-ie.css" />

    <!-- not relevent to subject, declare all javascripts AFTER css linking -->

</head>
<body>
</body>
</html> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-09T06:18:15.920

我没有看到提到这一点：`<base>`标签（如果指定）应该是`<head>`. （假定文档的基本 URI 在`.`之前/如果未指定。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-09T10:26:34.170

恕我直言，两个最重要的子标签`<head>`are`<title>`和 Content Type 元标签。搜索引擎积极关注`<title>`。而其他元标记通常被忽略。作为一个多语言的网络用户——我不能再强调添加内容类型标签的重要性了，因为没有它，浏览器需要自动检测网页的字符集，而且这个操作通常是不稳定的。结果最终导致各种字符无法正确呈现给用户，或者在日语或中文的情况下有时根本没有。

以下是我当前项目中的一些标头代码片段：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Reports Blah Blah</title>
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW" />
<meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
...
</head> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-09T08:37:38.477

[这里](https://stackoverflow.com/questions/190890/order-of-tags-in-headhead#190923)有一个相关的问题，可能有助于增加关于标签顺序的一些信息。

通常我的页面包括以下内容：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <title>...</title>
    <meta name="Description" ...>
    <meta name="Keywords" ...>
    <meta name="Copyright" ...>
    <meta name="Author" ...>
    <meta name="Language" ...>
    <style type="text/css" ...> 
```

DocType 对于浏览器强制执行严格呈现（无怪癖模式）很重要。您可能想改用 XHTML - 只要那里有一个。我添加版权和作者纯粹是因为我为其他公司设计和创建页面。描述用于 SEO，语言用于浏览器（如果支持）。

我不相信哪个元标记首先出现，或者标题是否应该在上面有很大的不同。在大多数情况下，重要的是它存在于页面上，并且具有正确的内容。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-09T11:27:40.413

据我所知，大多数搜索引擎会忽略任何“关键字”或“描述”元标记，而是更喜欢阅读文档的内容。

然而，获得正确的页面标题是极其重要的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-09T05:18:16.803

标题、关键字的元标记、内容类型（如果 Web 服务器未明确设置）以及要应用于页面的任何 CSS。

预先声明 CSS 可以让浏览器更有效地布局页面（参见[http://developer.yahoo.com/performance/rules.html#css_top](http://developer.yahoo.com/performance/rules.html#css_top)）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-09T10:36:31.140

我要添加一个重要说明：如果您使用[IE 的`meta X-UA-Compatible`标签来切换](http://blogs.msdn.com/ie/archive/2008/06/10/introducing-ie-emulateie7.aspx)Internet Explorer 的呈现模式，则必须将其作为 HEAD 中的第一项插入：

```
<头部>
  <meta http-equiv="X-UA-Compatible" content="IE=7" />
  <title>页面标题</title>
  ...ETC
</head>

```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-09T11:33:15.033

除了上面的答案，我还使用[Dublin Core 倡议 meta-tags](http://dublincore.org/)。

它们对于实际内容/论文等非常有用。

```
<meta name="DC.abstract" content="Document abstract" />
<meta name="DC.audience" content="Target audience" /> 
```

等等

# prolog - 在不创建列表的情况下，如何查询 Prolog 中两个值之间的整数？

> ID：275660
> 
> 赞同：4
> 
> 时间：2008-11-09T05:52:44.457
> 
> 标签：prolog

例如，如果我像`between(1,4,X)?`我期望的那样进行查询`X=2`，`X=3`. 这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T07:00:02.887

```
 between(A,B,X):-X is A+1,X<B.
 between(A,B,X):-A2 is A+1,A2<B-1,between(A2,B,X). 
```

# asp.net - ASP.NET v1.1 无法加载类型 TBRWEB.frmLogin

> ID：275680
> 
> 赞同：1
> 
> 时间：2008-11-09T06:29:37.767
> 
> 标签：asp.net

我有一个想要复制到新项目的网络应用程序。

我使用 VS2003 创建了新应用程序，并在 Web 表单、配置、全局 asa 等中进行了复制，并确保 IIS 说它是一个 Web 应用程序。

但是，当我从 VS IDE 使用 IE 运行应用程序时，我仍然会收到此错误：

```
ASP.NET v1.1 Could not load type TBRWEB.frmLogin 
```

我还确保程序集名称和根名称空间与原始名称相同。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-09T10:51:23.277

如果 .aspx 页面或 Global.asax 页面包含对代码隐藏模块的引用并且尚未构建应用程序，则通常会发生这些错误。

查看您的项目设置并检查**默认命名空间**的值（在应用程序部分中）。

然后检查ascx 控件（以及其他 aspx/ascx 文件）**的控件标头中的“继承”属性。**我怀疑这两个名字不一样。创建一个新项目，您可能会选择一个不同的名称，它成为默认命名空间。

如果可以的话，最简单的解决方案是将项目的名称空间更改为 TBRWEB。

如果这不是那么容易，那么我的后续问题是：

*   您是否成功构建（编译）应用程序？
*   如果是 ASP.NET 网站（不是 Web 项目），您是否忘记复制 App_Code 文件夹中的 .cs/.vb 文件？

# python - 如何使用 IMDbPy 获得电影的缩略图？

> ID：275683
> 
> 赞同：7
> 
> 时间：2008-11-09T06:39:52.583
> 
> 标签：python, imdb, imdbpy

使用[IMDbPy](http://imdbpy.sourceforge.net)从 IMDB 站点访问电影非常容易：

```
import imdb

access = imdb.IMDb()
movie = access.get_movie(3242) # random ID

print "title: %s year: %s" % (movie['title'], movie['year']) 
```

但是，我看不出有办法获得电影封面的图片或缩略图。建议？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-09T09:34:46.613

**笔记：**

*   并非每部电影都有封面网址。（您示例中的随机 ID 没有。）
*   确保您使用的是最新版本的 IMDbPy。（IMDb 发生变化，IMDbPy 也随之变化。）

...

```
import imdb

access = imdb.IMDb()
movie = access.get_movie(1132626)

print "title: %s year: %s" % (movie['title'], movie['year'])
print "Cover url: %s" % movie['cover url'] 
```

如果由于某种原因您不能使用上述内容，您可以随时使用 BeautifulSoup 之类的东西来获取封面 url。

```
from BeautifulSoup import BeautifulSoup
import imdb

access = imdb.IMDb()
movie = access.get_movie(1132626)

page = urllib2.urlopen(access.get_imdbURL(movie))
soup = BeautifulSoup(page)
cover_div = soup.find(attrs={"class" : "photo"})
cover_url = (photo_div.find('img'))['src']
print "Cover url: %s" % cover_url 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T11:01:02.867

IMDbPy 邮件列表的回复：

> 如果存在，则可以通过电影 ['cover url'] 访问该 url。请注意它可能会丢失，因此您必须首先使用以下内容对其进行测试：
> if 'cover url' in movie: ...
> 
> 之后，您可以使用 urllib 模块来获取图像本身。
> 
> 为了提供一个完整的例子，这样的事情应该可以解决问题：
> 
> ```
> import urllib
> from imdb import IMDb
> 
> ia = IMDb(#yourParameters)
> movie = ia.get_movie(#theMovieID)
> 
> if 'cover url' in movie:
>     urlObj = urllib.urlopen(movie['cover url'])
>     imageData = urlObj.read()
>     urlObj.close()
>     # now you can save imageData in a file (open it in binary mode). 
> ```
> 
> 同样，一个人的头像存储在 person['headshot'] 中。
> 
> 需要注意的事项：
> 
> *   封面和头像只能从网络服务器获取数据（通过“http”或“移动”数据访问系统），而不是纯文本数据文件（“sql”或“本地”）。
> *   使用图像时，您必须遵守 IMDb 政策的条款；见[http://imdbpy.sourceforge.net/docs/DISCLAIMER.txt](http://imdbpy.sourceforge.net/docs/DISCLAIMER.txt)
> *   您将获得的图像大小会有所不同；如果需要，您可以使用 python-imaging 模块重新缩放它们。

# .net - 如何从绝对路径获取相对路径

> ID：275689
> 
> 赞同：188
> 
> 时间：2008-11-09T06:51:44.103
> 
> 标签：.net

我的应用程序中有一部分显示用户通过 OpenFileDialog 加载的文件路径。显示整个路径占用了太多空间，但我不想只显示文件名，因为它可能不明确。所以我更愿意显示相对于程序集/exe 目录的文件路径。

例如，程序集位于，`C:\Program Files\Dummy Folder\MyProgram`文件位于，`C:\Program Files\Dummy Folder\MyProgram\Data\datafile1.dat`然后我希望它显示`.\Data\datafile1.dat`. 如果文件在`C:\Program Files\Dummy Folder\datafile1.dat`，那么我会想要`..\datafile1.dat`. 但如果文件位于根目录或根目录下的 1 个目录，则显示完整路径。

你会推荐什么解决方案？正则表达式？

基本上我想在不占用太多屏幕空间的情况下显示有用的文件路径信息。

编辑：只是为了澄清一点。该解决方案的目的是帮助用户或我自己知道我最后加载了哪个文件以及它来自哪个目录。我正在使用只读文本框来显示路径。大多数时候，文件路径比文本框的显示空间长得多。该路径应该提供信息，但不够重要，不会占用更多屏幕空间。

亚历克斯布劳特的评论很好，乔纳森莱弗勒也是。DavidK 提供的 Win32 功能只能帮助解决部分问题，而不是全部，但无论如何感谢。至于 James Newton-King 的解决方案，我等有空再试试。

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2008-12-04T12:36:47.137

.NET Core 2.0 有`Path.GetRelativePath`，否则，使用它。

```
/// <summary>
/// Creates a relative path from one file or folder to another.
/// </summary>
/// <param name="fromPath">Contains the directory that defines the start of the relative path.</param>
/// <param name="toPath">Contains the path that defines the endpoint of the relative path.</param>
/// <returns>The relative path from the start directory to the end path or <c>toPath</c> if the paths are not related.</returns>
/// <exception cref="ArgumentNullException"></exception>
/// <exception cref="UriFormatException"></exception>
/// <exception cref="InvalidOperationException"></exception>
public static String MakeRelativePath(String fromPath, String toPath)
{
    if (String.IsNullOrEmpty(fromPath)) throw new ArgumentNullException("fromPath");
    if (String.IsNullOrEmpty(toPath))   throw new ArgumentNullException("toPath");

    Uri fromUri = new Uri(fromPath);
    Uri toUri = new Uri(toPath);

    if (fromUri.Scheme != toUri.Scheme) { return toPath; } // path can't be made relative.

    Uri relativeUri = fromUri.MakeRelativeUri(toUri);
    String relativePath = Uri.UnescapeDataString(relativeUri.ToString());

    if (toUri.Scheme.Equals("file", StringComparison.InvariantCultureIgnoreCase))
    {
        relativePath = relativePath.Replace(Path.AltDirectorySeparatorChar, Path.DirectorySeparatorChar);
    }

    return relativePath;
} 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-01-27T22:04:20.993

这个问题有点晚了，但我也需要这个功能。我同意 DavidK 的观点，因为有一个提供此功能的[内置 API 函数](http://msdn.microsoft.com/en-us/library/bb773740(VS.85).aspx)，您应该使用它。这是它的托管包装器：

```
public static string GetRelativePath(string fromPath, string toPath)
{
    int fromAttr = GetPathAttribute(fromPath);
    int toAttr = GetPathAttribute(toPath);

    StringBuilder path = new StringBuilder(260); // MAX_PATH
    if(PathRelativePathTo(
        path,
        fromPath,
        fromAttr,
        toPath,
        toAttr) == 0)
    {
        throw new ArgumentException("Paths must have a common prefix");
    }
    return path.ToString();
}

private static int GetPathAttribute(string path)
{
    DirectoryInfo di = new DirectoryInfo(path);
    if (di.Exists)
    {
        return FILE_ATTRIBUTE_DIRECTORY;
    }

    FileInfo fi = new FileInfo(path);
    if(fi.Exists)
    {
        return FILE_ATTRIBUTE_NORMAL;
    }

    throw new FileNotFoundException();
}

private const int FILE_ATTRIBUTE_DIRECTORY = 0x10;
private const int FILE_ATTRIBUTE_NORMAL = 0x80;

[DllImport("shlwapi.dll", SetLastError = true)]
private static extern int PathRelativePathTo(StringBuilder pszPath, 
    string pszFrom, int dwAttrFrom, string pszTo, int dwAttrTo); 
```

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2015-08-20T08:40:17.960

# .NET Core 2.0 答案

.NET Core 2.0 有[Path.GetRelativePath](https://docs.microsoft.com/en-us/dotnet/api/system.io.path.getrelativepath?view=netcore-3.1)可以像这样使用：

```
var relativePath = Path.GetRelativePath(
    @"C:\Program Files\Dummy Folder\MyProgram",
    @"C:\Program Files\Dummy Folder\MyProgram\Data\datafile1.dat"); 
```

在上面的例子中，`relativePath`变量等于`Data\datafile1.dat`。

# 替代 .NET 答案

当文件路径不以正斜杠字符 ( ) 结尾时，@Dave 的解决方案不起作用，`/`如果路径是目录路径，则可能发生这种情况。我的解决方案解决了这个问题，并且还使用了`Uri.UriSchemeFile`常量而不是硬编码`"FILE"`。

```
/// <summary>
/// Creates a relative path from one file or folder to another.
/// </summary>
/// <param name="fromPath">Contains the directory that defines the start of the relative path.</param>
/// <param name="toPath">Contains the path that defines the endpoint of the relative path.</param>
/// <returns>The relative path from the start directory to the end path.</returns>
/// <exception cref="ArgumentNullException"><paramref name="fromPath"/> or <paramref name="toPath"/> is <c>null</c>.</exception>
/// <exception cref="UriFormatException"></exception>
/// <exception cref="InvalidOperationException"></exception>
public static string GetRelativePath(string fromPath, string toPath)
{
    if (string.IsNullOrEmpty(fromPath))
    {
        throw new ArgumentNullException("fromPath");
    }

    if (string.IsNullOrEmpty(toPath))
    {
        throw new ArgumentNullException("toPath");
    }

    Uri fromUri = new Uri(AppendDirectorySeparatorChar(fromPath));
    Uri toUri = new Uri(AppendDirectorySeparatorChar(toPath));

    if (fromUri.Scheme != toUri.Scheme)
    {
        return toPath;
    }

    Uri relativeUri = fromUri.MakeRelativeUri(toUri);
    string relativePath = Uri.UnescapeDataString(relativeUri.ToString());

    if (string.Equals(toUri.Scheme, Uri.UriSchemeFile, StringComparison.OrdinalIgnoreCase))
    {
        relativePath = relativePath.Replace(Path.AltDirectorySeparatorChar, Path.DirectorySeparatorChar);
    }

    return relativePath;
}

private static string AppendDirectorySeparatorChar(string path)
{
    // Append a slash only if the path is a directory and does not have a slash.
    if (!Path.HasExtension(path) &&
        !path.EndsWith(Path.DirectorySeparatorChar.ToString()))
    {
        return path + Path.DirectorySeparatorChar;
    }

    return path;
} 
```

# Windows 互操作答案

有一个称为[PathRelativePathToA](https://docs.microsoft.com/en-gb/windows/win32/api/shlwapi/nf-shlwapi-pathrelativepathtoa?redirectedfrom=MSDN)的 Windows API ，可用于查找相对路径。请注意，您传递给函数的文件或目录路径必须存在才能正常工作。

```
var relativePath = PathExtended.GetRelativePath(
    @"C:\Program Files\Dummy Folder\MyProgram",
    @"C:\Program Files\Dummy Folder\MyProgram\Data\datafile1.dat");

public static class PathExtended
{
    private const int FILE_ATTRIBUTE_DIRECTORY = 0x10;
    private const int FILE_ATTRIBUTE_NORMAL = 0x80;
    private const int MaximumPath = 260;

    public static string GetRelativePath(string fromPath, string toPath)
    {
        var fromAttribute = GetPathAttribute(fromPath);
        var toAttribute = GetPathAttribute(toPath);

        var stringBuilder = new StringBuilder(MaximumPath);
        if (PathRelativePathTo(
            stringBuilder,
            fromPath,
            fromAttribute,
            toPath,
            toAttribute) == 0)
        {
            throw new ArgumentException("Paths must have a common prefix.");
        }

        return stringBuilder.ToString();
    }

    private static int GetPathAttribute(string path)
    {
        var directory = new DirectoryInfo(path);
        if (directory.Exists)
        {
            return FILE_ATTRIBUTE_DIRECTORY;
        }

        var file = new FileInfo(path);
        if (file.Exists)
        {
            return FILE_ATTRIBUTE_NORMAL;
        }

        throw new FileNotFoundException(
            "A file or directory with the specified path was not found.",
            path);
    }

    [DllImport("shlwapi.dll", SetLastError = true)]
    private static extern int PathRelativePathTo(
        StringBuilder pszPath,
        string pszFrom,
        int dwAttrFrom,
        string pszTo,
        int dwAttrTo);
} 
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2008-11-09T08:13:17.170

shlwapi.dll 中有一个 Win32 (C++) 函数，它完全符合您的要求：[`PathRelativePathTo()`](http://msdn.microsoft.com/en-us/library/bb773740(VS.85).aspx)

不过，除了 P/Invoke 之外，我不知道有任何方法可以从 .NET 访问它。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2018-02-12T22:24:06.237

如果您使用的是[.NET Core 2.0，`Path.GetRelativePath()`](https://docs.microsoft.com/en-us/dotnet/api/system.io.path.getrelativepath)则可以提供以下特定功能：

```
 var relativeTo = @"C:\Program Files\Dummy Folder\MyProgram";
        var path = @"C:\Program Files\Dummy Folder\MyProgram\Data\datafile1.dat";

        string relativePath = System.IO.Path.GetRelativePath(relativeTo, path);

        System.Console.WriteLine(relativePath);
        // output --> Data\datafile1.dat 
```

否则，对于 .NET 完整框架（从 v4.7 开始），建议使用其他建议的答案之一。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-11-09T08:30:35.357

我过去用过这个。

```
/// <summary>
/// Creates a relative path from one file
/// or folder to another.
/// </summary>
/// <param name="fromDirectory">
/// Contains the directory that defines the
/// start of the relative path.
/// </param>
/// <param name="toPath">
/// Contains the path that defines the
/// endpoint of the relative path.
/// </param>
/// <returns>
/// The relative path from the start
/// directory to the end path.
/// </returns>
/// <exception cref="ArgumentNullException"></exception>
public static string MakeRelative(string fromDirectory, string toPath)
{
  if (fromDirectory == null)
    throw new ArgumentNullException("fromDirectory");

  if (toPath == null)
    throw new ArgumentNullException("toPath");

  bool isRooted = (Path.IsPathRooted(fromDirectory) && Path.IsPathRooted(toPath));

  if (isRooted)
  {
    bool isDifferentRoot = (string.Compare(Path.GetPathRoot(fromDirectory), Path.GetPathRoot(toPath), true) != 0);

    if (isDifferentRoot)
      return toPath;
  }

  List<string> relativePath = new List<string>();
  string[] fromDirectories = fromDirectory.Split(Path.DirectorySeparatorChar);

  string[] toDirectories = toPath.Split(Path.DirectorySeparatorChar);

  int length = Math.Min(fromDirectories.Length, toDirectories.Length);

  int lastCommonRoot = -1;

  // find common root
  for (int x = 0; x < length; x++)
  {
    if (string.Compare(fromDirectories[x], toDirectories[x], true) != 0)
      break;

    lastCommonRoot = x;
  }

  if (lastCommonRoot == -1)
    return toPath;

  // add relative folders in from path
  for (int x = lastCommonRoot + 1; x < fromDirectories.Length; x++)
  {
    if (fromDirectories[x].Length > 0)
      relativePath.Add("..");
  }

  // add to folders to path
  for (int x = lastCommonRoot + 1; x < toDirectories.Length; x++)
  {
    relativePath.Add(toDirectories[x]);
  }

  // create relative path
  string[] relativeParts = new string[relativePath.Count];
  relativePath.CopyTo(relativeParts, 0);

  string newPath = string.Join(Path.DirectorySeparatorChar.ToString(), relativeParts);

  return newPath;
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2018-07-04T23:36:34.357

如上所述[，](https://stackoverflow.com/a/48756531/2746150) .NET Core 2.x 实现了`Path.GetRelativePath`.

下面的代码改编自源代码，适用于 .NET 4.7.1 Framework。

```
// Licensed to the .NET Foundation under one or more agreements.
// The .NET Foundation licenses this file to you under the MIT license.
// See the LICENSE file in the project root for more information.

//Adapted from https://github.com/dotnet/corefx/blob/master/src/Common/src/CoreLib/System/IO/Path.cs#L697
// by Anton Krouglov

using System.Runtime.CompilerServices;
using System.Diagnostics;
using System.Text;
using Xunit;

namespace System.IO {
    // Provides methods for processing file system strings in a cross-platform manner.
    // Most of the methods don't do a complete parsing (such as examining a UNC hostname), 
    // but they will handle most string operations.
    public static class PathNetCore {

        /// <summary>
        /// Create a relative path from one path to another. Paths will be resolved before calculating the difference.
        /// Default path comparison for the active platform will be used (OrdinalIgnoreCase for Windows or Mac, Ordinal for Unix).
        /// </summary>
        /// <param name="relativeTo">The source path the output should be relative to. This path is always considered to be a directory.</param>
        /// <param name="path">The destination path.</param>
        /// <returns>The relative path or <paramref name="path"/> if the paths don't share the same root.</returns>
        /// <exception cref="ArgumentNullException">Thrown if <paramref name="relativeTo"/> or <paramref name="path"/> is <c>null</c> or an empty string.</exception>
        public static string GetRelativePath(string relativeTo, string path) {
            return GetRelativePath(relativeTo, path, StringComparison);
        }

        private static string GetRelativePath(string relativeTo, string path, StringComparison comparisonType) {
            if (string.IsNullOrEmpty(relativeTo)) throw new ArgumentNullException(nameof(relativeTo));
            if (string.IsNullOrEmpty(path)) throw new ArgumentNullException(nameof(path));
            Debug.Assert(comparisonType == StringComparison.Ordinal ||
                         comparisonType == StringComparison.OrdinalIgnoreCase);

            relativeTo = Path.GetFullPath(relativeTo);
            path = Path.GetFullPath(path);

            // Need to check if the roots are different- if they are we need to return the "to" path.
            if (!PathInternalNetCore.AreRootsEqual(relativeTo, path, comparisonType))
                return path;

            int commonLength = PathInternalNetCore.GetCommonPathLength(relativeTo, path,
                ignoreCase: comparisonType == StringComparison.OrdinalIgnoreCase);

            // If there is nothing in common they can't share the same root, return the "to" path as is.
            if (commonLength == 0)
                return path;

            // Trailing separators aren't significant for comparison
            int relativeToLength = relativeTo.Length;
            if (PathInternalNetCore.EndsInDirectorySeparator(relativeTo))
                relativeToLength--;

            bool pathEndsInSeparator = PathInternalNetCore.EndsInDirectorySeparator(path);
            int pathLength = path.Length;
            if (pathEndsInSeparator)
                pathLength--;

            // If we have effectively the same path, return "."
            if (relativeToLength == pathLength && commonLength >= relativeToLength) return ".";

            // We have the same root, we need to calculate the difference now using the
            // common Length and Segment count past the length.
            //
            // Some examples:
            //
            //  C:\Foo C:\Bar L3, S1 -> ..\Bar
            //  C:\Foo C:\Foo\Bar L6, S0 -> Bar
            //  C:\Foo\Bar C:\Bar\Bar L3, S2 -> ..\..\Bar\Bar
            //  C:\Foo\Foo C:\Foo\Bar L7, S1 -> ..\Bar

            StringBuilder
                sb = new StringBuilder(); //StringBuilderCache.Acquire(Math.Max(relativeTo.Length, path.Length));

            // Add parent segments for segments past the common on the "from" path
            if (commonLength < relativeToLength) {
                sb.Append("..");

                for (int i = commonLength + 1; i < relativeToLength; i++) {
                    if (PathInternalNetCore.IsDirectorySeparator(relativeTo[i])) {
                        sb.Append(DirectorySeparatorChar);
                        sb.Append("..");
                    }
                }
            }
            else if (PathInternalNetCore.IsDirectorySeparator(path[commonLength])) {
                // No parent segments and we need to eat the initial separator
                //  (C:\Foo C:\Foo\Bar case)
                commonLength++;
            }

            // Now add the rest of the "to" path, adding back the trailing separator
            int differenceLength = pathLength - commonLength;
            if (pathEndsInSeparator)
                differenceLength++;

            if (differenceLength > 0) {
                if (sb.Length > 0) {
                    sb.Append(DirectorySeparatorChar);
                }

                sb.Append(path, commonLength, differenceLength);
            }

            return sb.ToString(); //StringBuilderCache.GetStringAndRelease(sb);
        }

        // Public static readonly variant of the separators. The Path implementation itself is using
        // internal const variant of the separators for better performance.
        public static readonly char DirectorySeparatorChar = PathInternalNetCore.DirectorySeparatorChar;
        public static readonly char AltDirectorySeparatorChar = PathInternalNetCore.AltDirectorySeparatorChar;
        public static readonly char VolumeSeparatorChar = PathInternalNetCore.VolumeSeparatorChar;
        public static readonly char PathSeparator = PathInternalNetCore.PathSeparator;

        /// <summary>Returns a comparison that can be used to compare file and directory names for equality.</summary>
        internal static StringComparison StringComparison => StringComparison.OrdinalIgnoreCase;
    }

    /// <summary>Contains internal path helpers that are shared between many projects.</summary>
    internal static class PathInternalNetCore {
        internal const char DirectorySeparatorChar = '\\';
        internal const char AltDirectorySeparatorChar = '/';
        internal const char VolumeSeparatorChar = ':';
        internal const char PathSeparator = ';';

        internal const string ExtendedDevicePathPrefix = @"\\?\";
        internal const string UncPathPrefix = @"\\";
        internal const string UncDevicePrefixToInsert = @"?\UNC\";
        internal const string UncExtendedPathPrefix = @"\\?\UNC\";
        internal const string DevicePathPrefix = @"\\.\";

        //internal const int MaxShortPath = 260;

        // \\?\, \\.\, \??\
        internal const int DevicePrefixLength = 4;

        /// <summary>
        /// Returns true if the two paths have the same root
        /// </summary>
        internal static bool AreRootsEqual(string first, string second, StringComparison comparisonType) {
            int firstRootLength = GetRootLength(first);
            int secondRootLength = GetRootLength(second);

            return firstRootLength == secondRootLength
                   && string.Compare(
                       strA: first,
                       indexA: 0,
                       strB: second,
                       indexB: 0,
                       length: firstRootLength,
                       comparisonType: comparisonType) == 0;
        }

        /// <summary>
        /// Gets the length of the root of the path (drive, share, etc.).
        /// </summary>
        internal static int GetRootLength(string path) {
            int i = 0;
            int volumeSeparatorLength = 2; // Length to the colon "C:"
            int uncRootLength = 2; // Length to the start of the server name "\\"

            bool extendedSyntax = path.StartsWith(ExtendedDevicePathPrefix);
            bool extendedUncSyntax = path.StartsWith(UncExtendedPathPrefix);
            if (extendedSyntax) {
                // Shift the position we look for the root from to account for the extended prefix
                if (extendedUncSyntax) {
                    // "\\" -> "\\?\UNC\"
                    uncRootLength = UncExtendedPathPrefix.Length;
                }
                else {
                    // "C:" -> "\\?\C:"
                    volumeSeparatorLength += ExtendedDevicePathPrefix.Length;
                }
            }

            if ((!extendedSyntax || extendedUncSyntax) && path.Length > 0 && IsDirectorySeparator(path[0])) {
                // UNC or simple rooted path (e.g. "\foo", NOT "\\?\C:\foo")

                i = 1; //  Drive rooted (\foo) is one character
                if (extendedUncSyntax || (path.Length > 1 && IsDirectorySeparator(path[1]))) {
                    // UNC (\\?\UNC\ or \\), scan past the next two directory separators at most
                    // (e.g. to \\?\UNC\Server\Share or \\Server\Share\)
                    i = uncRootLength;
                    int n = 2; // Maximum separators to skip
                    while (i < path.Length && (!IsDirectorySeparator(path[i]) || --n > 0)) i++;
                }
            }
            else if (path.Length >= volumeSeparatorLength &&
                     path[volumeSeparatorLength - 1] == PathNetCore.VolumeSeparatorChar) {
                // Path is at least longer than where we expect a colon, and has a colon (\\?\A:, A:)
                // If the colon is followed by a directory separator, move past it
                i = volumeSeparatorLength;
                if (path.Length >= volumeSeparatorLength + 1 && IsDirectorySeparator(path[volumeSeparatorLength])) i++;
            }

            return i;
        }

        /// <summary>
        /// True if the given character is a directory separator.
        /// </summary>
        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        internal static bool IsDirectorySeparator(char c) {
            return c == PathNetCore.DirectorySeparatorChar || c == PathNetCore.AltDirectorySeparatorChar;
        }

        /// <summary>
        /// Get the common path length from the start of the string.
        /// </summary>
        internal static int GetCommonPathLength(string first, string second, bool ignoreCase) {
            int commonChars = EqualStartingCharacterCount(first, second, ignoreCase: ignoreCase);

            // If nothing matches
            if (commonChars == 0)
                return commonChars;

            // Or we're a full string and equal length or match to a separator
            if (commonChars == first.Length
                && (commonChars == second.Length || IsDirectorySeparator(second[commonChars])))
                return commonChars;

            if (commonChars == second.Length && IsDirectorySeparator(first[commonChars]))
                return commonChars;

            // It's possible we matched somewhere in the middle of a segment e.g. C:\Foodie and C:\Foobar.
            while (commonChars > 0 && !IsDirectorySeparator(first[commonChars - 1]))
                commonChars--;

            return commonChars;
        }

        /// <summary>
        /// Gets the count of common characters from the left optionally ignoring case
        /// </summary>
        internal static unsafe int EqualStartingCharacterCount(string first, string second, bool ignoreCase) {
            if (string.IsNullOrEmpty(first) || string.IsNullOrEmpty(second)) return 0;

            int commonChars = 0;

            fixed (char* f = first)
            fixed (char* s = second) {
                char* l = f;
                char* r = s;
                char* leftEnd = l + first.Length;
                char* rightEnd = r + second.Length;

                while (l != leftEnd && r != rightEnd
                                    && (*l == *r || (ignoreCase &&
                                                     char.ToUpperInvariant((*l)) == char.ToUpperInvariant((*r))))) {
                    commonChars++;
                    l++;
                    r++;
                }
            }

            return commonChars;
        }

        /// <summary>
        /// Returns true if the path ends in a directory separator.
        /// </summary>
        internal static bool EndsInDirectorySeparator(string path)
            => path.Length > 0 && IsDirectorySeparator(path[path.Length - 1]);
    }

    /// <summary> Tests for PathNetCore.GetRelativePath </summary>
    public static class GetRelativePathTests {
        [Theory]
        [InlineData(@"C:\", @"C:\", @".")]
        [InlineData(@"C:\a", @"C:\a\", @".")]
        [InlineData(@"C:\A", @"C:\a\", @".")]
        [InlineData(@"C:\a\", @"C:\a", @".")]
        [InlineData(@"C:\", @"C:\b", @"b")]
        [InlineData(@"C:\a", @"C:\b", @"..\b")]
        [InlineData(@"C:\a", @"C:\b\", @"..\b\")]
        [InlineData(@"C:\a\b", @"C:\a", @"..")]
        [InlineData(@"C:\a\b", @"C:\a\", @"..")]
        [InlineData(@"C:\a\b\", @"C:\a", @"..")]
        [InlineData(@"C:\a\b\", @"C:\a\", @"..")]
        [InlineData(@"C:\a\b\c", @"C:\a\b", @"..")]
        [InlineData(@"C:\a\b\c", @"C:\a\b\", @"..")]
        [InlineData(@"C:\a\b\c", @"C:\a", @"..\..")]
        [InlineData(@"C:\a\b\c", @"C:\a\", @"..\..")]
        [InlineData(@"C:\a\b\c\", @"C:\a\b", @"..")]
        [InlineData(@"C:\a\b\c\", @"C:\a\b\", @"..")]
        [InlineData(@"C:\a\b\c\", @"C:\a", @"..\..")]
        [InlineData(@"C:\a\b\c\", @"C:\a\", @"..\..")]
        [InlineData(@"C:\a\", @"C:\b", @"..\b")]
        [InlineData(@"C:\a", @"C:\a\b", @"b")]
        [InlineData(@"C:\a", @"C:\A\b", @"b")]
        [InlineData(@"C:\a", @"C:\b\c", @"..\b\c")]
        [InlineData(@"C:\a\", @"C:\a\b", @"b")]
        [InlineData(@"C:\", @"D:\", @"D:\")]
        [InlineData(@"C:\", @"D:\b", @"D:\b")]
        [InlineData(@"C:\", @"D:\b\", @"D:\b\")]
        [InlineData(@"C:\a", @"D:\b", @"D:\b")]
        [InlineData(@"C:\a\", @"D:\b", @"D:\b")]
        [InlineData(@"C:\ab", @"C:\a", @"..\a")]
        [InlineData(@"C:\a", @"C:\ab", @"..\ab")]
        [InlineData(@"C:\", @"\\LOCALHOST\Share\b", @"\\LOCALHOST\Share\b")]
        [InlineData(@"\\LOCALHOST\Share\a", @"\\LOCALHOST\Share\b", @"..\b")]
        //[PlatformSpecific(TestPlatforms.Windows)]  // Tests Windows-specific paths
        public static void GetRelativePath_Windows(string relativeTo, string path, string expected) {
            string result = PathNetCore.GetRelativePath(relativeTo, path);
            Assert.Equal(expected, result);

            // Check that we get the equivalent path when the result is combined with the sources
            Assert.Equal(
                Path.GetFullPath(path).TrimEnd(Path.DirectorySeparatorChar),
                Path.GetFullPath(Path.Combine(Path.GetFullPath(relativeTo), result))
                    .TrimEnd(Path.DirectorySeparatorChar),
                ignoreCase: true,
                ignoreLineEndingDifferences: false,
                ignoreWhiteSpaceDifferences: false);
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-11-09T08:21:54.953

正如 Alex Brault 指出的那样，尤其是在 Windows 上，绝对路径（包括驱动器号和所有）是明确的，而且通常更好。

您的 OpenFileDialog 不应该使用常规的树浏览器结构吗？

为了获得一些命名，**RefDir**是您要指定路径的相对目录；**AbsName**是您要映射的绝对路径名；RelPath是生成的相对路径**。**

选择第一个匹配的选项：

*   如果您有不同的驱动器号，则没有从 RefDir 到 AbsName 的相对路径；您必须使用 AbsName。
*   如果 AbsName 在 RefDir 的子目录中或者是 RefDir 中的文件，则只需从 AbsName 的开头删除 RefDir 即可创建 RelPath；可选地添加“./”（或“.\”，因为您在 Windows 上）。
*   找到 RefDir 和 AbsName 的最长公共前缀（其中 D:\Abc\Def 和 D:\Abc\Default 共享 D:\Abc 作为最长公共前缀；它必须是名称组件的映射，而不是简单的最长公共前缀子串）；称之为 LCP。从 AbsName 和 RefDir 中删除 LCP。对于 (RefDir - LCP) 中留下的每个路径组件，将“..\”添加到 (AbsName - LCP) 以产生 RelPath。

为了说明最后一条规则（当然，这是迄今为止最复杂的），请从以下内容开始：

```
RefDir = D:\Abc\Def\Ghi
AbsName = D:\Abc\Default\Karma\Crucible 
```

然后

```
LCP = D:\Abc
(RefDir - LCP) = Def\Ghi
(Absname - LCP) = Default\Karma\Crucible
RelPath = ..\..\Default\Karma\Crucible 
```

在我打字时，DavidK 给出了一个答案，表明您不是第一个需要此功能的人，并且有一个标准功能可以完成这项工作。 **用它。** 但是，能够从第一原则思考自己的方式也没有什么坏处。

除了 Unix 系统不支持驱动器号（所以所有东西总是位于同一个根目录下，因此第一个项目符号无关紧要），同样的技术可以在 Unix 上使用。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-03T14:00:02.493

这是一个很长的路要走，但 System.Uri 类有一个名为 MakeRelativeUri 的方法。也许你可以使用它。System.IO.Path 没有这个真的很遗憾。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-09T06:56:58.710

利用：

```
RelPath = AbsPath.Replace(ApplicationPath, ".") 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-03-18T10:08:54.570

我正在使用这个：

```
public static class StringExtensions
{
  /// <summary>
  /// Creates a relative path from one file or folder to another.
  /// </summary>
  /// <param name="absPath">Absolute path.</param>
  /// <param name="relTo">Directory that defines the start of the relative path.</param> 
  /// <returns>The relative path from the start directory to the end path.</returns>
  public static string MakeRelativePath(this string absPath, string relTo)
  {
      string[] absParts = absPath.Split(Path.DirectorySeparatorChar);
      string[] relParts = relTo.Split(Path.DirectorySeparatorChar);

      // Get the shortest of the two paths
      int len = absParts.Length < relParts.Length
          ? absParts.Length : relParts.Length;

      // Use to determine where in the loop we exited
      int lastCommonRoot = -1;
      int index;

      // Find common root
      for (index = 0; index < len; index++)
      {
          if (absParts[index].Equals(relParts[index], StringComparison.OrdinalIgnoreCase))
              lastCommonRoot = index;
          else 
            break;
      }

      // If we didn't find a common prefix then throw
      if (lastCommonRoot == -1)
          throw new ArgumentException("The path of the two files doesn't have any common base.");

      // Build up the relative path
      var relativePath = new StringBuilder();

      // Add on the ..
      for (index = lastCommonRoot + 1; index < relParts.Length; index++)
      {
        relativePath.Append("..");
        relativePath.Append(Path.DirectorySeparatorChar);
      }

      // Add on the folders
      for (index = lastCommonRoot + 1; index < absParts.Length - 1; index++)
      {
        relativePath.Append(absParts[index]);
        relativePath.Append(Path.DirectorySeparatorChar);
      }
      relativePath.Append(absParts[absParts.Length - 1]);

      return relativePath.ToString();
  }
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-27T22:14:45.557

如果您确定绝对路径 2 始终相对于绝对路径，只需从 path2 中删除前 N 个字符，其中 N 是 path1 的长度。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-10-21T07:27:28.067

你想使用`CommonPath`这个`RelativePath`类的方法。有了公共路径后，只需将其从要显示的路径中删除即可。

```
Namespace IO.Path

    Public NotInheritable Class RelativePath

        Private Declare Function PathRelativePathTo Lib "shlwapi" Alias "PathRelativePathToA" ( _
            ByVal pszPath As String, _
            ByVal pszFrom As String, _
            ByVal dwAttrFrom As Integer, _
            ByVal pszTo As String, _
            ByVal dwAttrTo As Integer) As Integer

        Private Declare Function PathCanonicalize Lib "shlwapi" Alias "PathCanonicalizeA" ( _
            ByVal pszBuf As String, _
            ByVal pszPath As String) As Integer

        Private Const FILE_ATTRIBUTE_DIRECTORY As Short = &H10S

        Private Const MAX_PATH As Short = 260

        Private _path As String
        Private _isDirectory As Boolean

#Region " Constructors "

        Public Sub New()

        End Sub

        Public Sub New(ByVal path As String)
            _path = path
        End Sub

        Public Sub New(ByVal path As String, ByVal isDirectory As Boolean)
            _path = path
            _isDirectory = isDirectory
        End Sub

#End Region

        Private Shared Function StripNulls(ByVal value As String) As String
            StripNulls = value
            If (InStr(value, vbNullChar) > 0) Then
                StripNulls = Left(value, InStr(value, vbNullChar) - 1)
            End If
        End Function

        Private Shared Function TrimCurrentDirectory(ByVal path As String) As String
            TrimCurrentDirectory = path
            If Len(path) >= 2 And Left(path, 2) = ".\" Then
                TrimCurrentDirectory = Mid(path, 3)
            End If
        End Function

        ''' <summary>
        ''' 3\. conforming to general principles: conforming to accepted principles or standard practice
        ''' </summary>
        Public Shared Function Canonicalize(ByVal path As String) As String
            Dim sPath As String

            sPath = New String(Chr(0), MAX_PATH)

            If PathCanonicalize(sPath, path) = 0 Then
                Canonicalize = vbNullString
            Else
                Canonicalize = StripNulls(sPath)
            End If

        End Function

        ''' <summary>
        ''' Returns the most common path between two paths.
        ''' </summary>
        ''' <remarks>
        ''' <para>returns the path that is common between two paths</para>
        ''' <para>c:\FolderA\FolderB\FolderC</para>
        '''   c:\FolderA\FolderD\FolderE\File.Ext
        ''' 
        '''   results in:
        '''       c:\FolderA\
        ''' </remarks>
        Public Shared Function CommonPath(ByVal path1 As String, ByVal path2 As String) As String
            'returns the path that is common between two paths
            '
            '   c:\FolderA\FolderB\FolderC
            '   c:\FolderA\FolderD\FolderE\File.Ext
            '
            '   results in:
            '       c:\FolderA\

            Dim sResult As String = String.Empty
            Dim iPos1, iPos2 As Integer
            path1 = Canonicalize(path1)
            path2 = Canonicalize(path2)
            Do
                If Left(path1, iPos1) = Left(path2, iPos2) Then
                    sResult = Left(path1, iPos1)
                End If
                iPos1 = InStr(iPos1 + 1, path1, "\")
                iPos2 = InStr(iPos2 + 1, path1, "\")
            Loop While Left(path1, iPos1) = Left(path2, iPos2)

            Return sResult

        End Function

        Public Function CommonPath(ByVal path As String) As String
            Return CommonPath(_path, path)
        End Function

        Public Shared Function RelativePathTo(ByVal source As String, ByVal isSourceDirectory As Boolean, ByVal target As String, ByVal isTargetDirectory As Boolean) As String
            'DEVLIB
            '   05/23/05  1:47PM - Fixed call to PathRelativePathTo, iTargetAttribute is now passed to dwAttrTo instead of IsTargetDirectory.
            '       For Visual Basic 6.0, the fix does not change testing results,
            '           because when the Boolean IsTargetDirectory is converted to the Long dwAttrTo it happens to contain FILE_ATTRIBUTE_DIRECTORY,
            '
            Dim sRelativePath As String
            Dim iSourceAttribute, iTargetAttribute As Integer

            sRelativePath = New String(Chr(0), MAX_PATH)
            source = Canonicalize(source)
            target = Canonicalize(target)

            If isSourceDirectory Then
                iSourceAttribute = FILE_ATTRIBUTE_DIRECTORY
            End If

            If isTargetDirectory Then
                iTargetAttribute = FILE_ATTRIBUTE_DIRECTORY
            End If

            If PathRelativePathTo(sRelativePath, source, iSourceAttribute, target, iTargetAttribute) = 0 Then
                RelativePathTo = vbNullString
            Else
                RelativePathTo = TrimCurrentDirectory(StripNulls(sRelativePath))
            End If

        End Function

        Public Function RelativePath(ByVal target As String) As String
            Return RelativePathTo(_path, _isDirectory, target, False)
        End Function

    End Class

End Namespace 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-11-06T16:23:31.110

使用 URI 的函数返回“几乎”相对路径。它包含的目录直接包含我想要获取的相对路径的文件。

前段时间我写了一个简单的函数，它返回文件夹或文件的相对路径，即使它在另一个驱动器上，它也包括驱动器号。

请看一下：

```
 public static string GetRelativePath(string BasePath, string AbsolutePath)
    {
        char Separator = Path.DirectorySeparatorChar;
        if (string.IsNullOrWhiteSpace(BasePath)) BasePath = Directory.GetCurrentDirectory();
        var ReturnPath = "";
        var CommonPart = "";
        var BasePathFolders = BasePath.Split(Separator);
        var AbsolutePathFolders = AbsolutePath.Split(Separator);
        var i = 0;
        while (i < BasePathFolders.Length & i < AbsolutePathFolders.Length)
        {
            if (BasePathFolders[i].ToLower() == AbsolutePathFolders[i].ToLower())
            {
                CommonPart += BasePathFolders[i] + Separator;
            }
            else
            {
                break;
            }
            i += 1;
        }
        if (CommonPart.Length > 0)
        {
            var parents = BasePath.Substring(CommonPart.Length - 1).Split(Separator);
            foreach (var ParentDir in parents)
            {
                if (!string.IsNullOrEmpty(ParentDir))
                    ReturnPath += ".." + Separator;
            }
        }
        ReturnPath += AbsolutePath.Substring(CommonPart.Length);
        return ReturnPath;
    } 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-12-03T13:53:43.677

如果你有一个只读文本框，你能不把它做成一个标签并设置 AutoEllipsis=true 吗？

或者，有一些帖子包含用于自己生成自动省略号的代码：（这适用于网格，您需要将文本框的宽度传递给 i。这不太正确，因为它比必要的要多一点，而且我还没有找到计算不正确的地方。如果您愿意，可以很容易地修改以删除目录的第一部分而不是最后一部分。

```
Private Function AddEllipsisPath(ByVal text As String, ByVal colIndex As Integer, ByVal grid As DataGridView) As String
    'Get the size with the column's width 
    Dim colWidth As Integer = grid.Columns(colIndex).Width

    'Calculate the dimensions of the text with the current font
    Dim textSize As SizeF = MeasureString(text, grid.Font)

    Dim rawText As String = text
    Dim FileNameLen As Integer = text.Length - text.LastIndexOf("\")
    Dim ReplaceWith As String = "\..."

    Do While textSize.Width > colWidth
        ' Trim to make room for the ellipsis
        Dim LastFolder As Integer = rawText.LastIndexOf("\", rawText.Length - FileNameLen - 1)

        If LastFolder < 0 Then
            Exit Do
        End If

        rawText = rawText.Substring(0, LastFolder) + ReplaceWith + rawText.Substring(rawText.Length - FileNameLen)

        If ReplaceWith.Length > 0 Then
            FileNameLen += 4
            ReplaceWith = ""
        End If
        textSize = MeasureString(rawText, grid.Font)
    Loop

    Return rawText
End Function

Private Function MeasureString(ByVal text As String, ByVal fontInfo As Font) As SizeF
    Dim size As SizeF
    Dim emSize As Single = fontInfo.Size
    If emSize = 0 Then emSize = 12

    Dim stringFont As New Font(fontInfo.Name, emSize)

    Dim bmp As New Bitmap(1000, 100)
    Dim g As Graphics = Graphics.FromImage(bmp)

    size = g.MeasureString(text, stringFont)
    g.Dispose()
    Return size
End Function 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-11-09T07:15:27.830

我会在目录级别拆分您的两条路径。从那里，找到分歧点，然后回到程序集文件夹，每次传递目录时都在前面加上“../”。

但是请记住，绝对路径适用于任何地方，并且通常比相对路径更容易阅读。除非绝对必要，否则我个人不会向用户显示相对路径。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-05-05T01:47:51.973

如果您知道 toPath 包含在 fromPath 中，那么您可以保持简单。为简洁起见，我将省略断言。

```
public static string MakeRelativePath(string fromPath, string toPath)
{
    // use Path.GetFullPath to canonicalise the paths (deal with multiple directory seperators, etc)
    return Path.GetFullPath(toPath).Substring(Path.GetFullPath(fromPath).Length + 1);
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-11-16T22:43:20.063

玩类似的东西：

```
private String GetRelativePath(Int32 level, String directory, out String errorMessage) {
        if (level < 0 || level > 5) {
            errorMessage = "Find some more smart input data";
            return String.Empty;
        }
        // ==========================
        while (level != 0) {
            directory = Path.GetDirectoryName(directory);
            level -= 1;
        }
        // ==========================
        errorMessage = String.Empty;
        return directory;
    } 
```

并测试它

```
[Test]
    public void RelativeDirectoryPathTest() {
        var relativePath =
            GetRelativePath(3, AppDomain.CurrentDomain.BaseDirectory, out var errorMessage);
        Console.WriteLine(relativePath);
        if (String.IsNullOrEmpty(errorMessage) == false) {
            Console.WriteLine(errorMessage);
            Assert.Fail("Can not find relative path");
        }
    } 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-08-09T12:28:20.893

Uri 的方式不适用于 linux/macOS 系统。路径“/var/www/root”无法转换为 Uri。更通用的方式 - 全部手动完成。

```
public static string MakeRelativePath(string fromPath, string toPath, string sep = "/")
{
    var fromParts = fromPath.Split(new[] { '/', '\\'},
        StringSplitOptions.RemoveEmptyEntries);
    var toParts = toPath.Split(new[] { '/', '\\'},
        StringSplitOptions.RemoveEmptyEntries);

    var matchedParts = fromParts
        .Zip(toParts, (x, y) => string.Compare(x, y, true) == 0)
        .TakeWhile(x => x).Count();

    return string.Join("", Enumerable.Range(0, fromParts.Length - matchedParts)
        .Select(x => ".." + sep)) +
            string.Join(sep, toParts.Skip(matchedParts));
} 
```

PS：我使用“/”作为分隔符的默认值而不是 Path.DirectorySeparatorChar，因为此方法的结果在我的应用程序中用作 uri。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-11-01T09:45:25.587

在`ASP.NET Core 2`中，如果您想要相对路径，`bin\Debug\netcoreapp2.2`可以使用以下组合：

```
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Configuration;
public class RenderingService : IRenderingService
{

    private readonly IHostingEnvironment _hostingEnvironment;
    public RenderingService(IHostingEnvironment hostingEnvironment)
    {
    _hostingEnvironment = hostingEnvironment;
    }

    public string RelativeAssemblyDirectory()
    {
        var contentRootPath = _hostingEnvironment.ContentRootPath;
        string executingAssemblyDirectoryAbsolutePath = System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location);
        string executingAssemblyDirectoryRelativePath = System.IO.Path.GetRelativePath(contentRootPath, executingAssemblyDirectoryAbsolutePath);
        return executingAssemblyDirectoryRelativePath;
    }
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-12-16T17:55:51.013

这应该有效：

```
private string rel(string path) {
  string[] cwd  = new Regex(@"[\\]").Split(Directory.GetCurrentDirectory());
  string[] fp   = new Regex(@"[\\]").Split(path);

  int common = 0;

  for (int n = 0; n < fp.Length; n++) {
    if (n < cwd.Length && n < fp.Length && cwd[n] == fp[n]) {
      common++;
    }
  }

  if (common > 0) {
    List<string> rp = new List<string>();

    for (int n = 0; n < (cwd.Length - common); n++) {
      rp.Add("..");
    }

    for (int n = common; n < fp.Length; n++) {
      rp.Add(fp[n]);
    }

    return String.Join("/", rp.ToArray());
  } else {
    return String.Join("/", fp);
  }
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-11-11T01:32:20.980

这是我的：

```
public static string RelativePathTo(this System.IO.DirectoryInfo @this, string to)
{
    var rgFrom = @this.FullName.Split(new[] { Path.DirectorySeparatorChar, Path.AltDirectorySeparatorChar }, StringSplitOptions.RemoveEmptyEntries);
    var rgTo = to.Split(new[] { Path.DirectorySeparatorChar, Path.AltDirectorySeparatorChar }, StringSplitOptions.RemoveEmptyEntries);
    var cSame = rgFrom.TakeWhile((p, i) => i < rgTo.Length && string.Equals(p, rgTo[i])).Count();

    return Path.Combine(
        Enumerable.Range(0, rgFrom.Length - cSame)
        .Select(_ => "..")
        .Concat(rgTo.Skip(cSame))
        .ToArray()
    );
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-10-12T10:54:28.500

```
 public static string ToRelativePath(string filePath, string refPath)
    {
        var pathNormalized = Path.GetFullPath(filePath);

        var refNormalized = Path.GetFullPath(refPath);
        refNormalized = refNormalized.TrimEnd('\\', '/');

        if (!pathNormalized.StartsWith(refNormalized))
            throw new ArgumentException();
        var res = pathNormalized.Substring(refNormalized.Length + 1);
        return res;
    } 
```

# php - CodeIgniter 不喜欢视图中的方法？

> ID：275701
> 
> 赞同：2
> 
> 时间：2008-11-09T07:12:13.813
> 
> 标签：php, codeigniter

我在玩 CodeIgniter；希望将我的一些旧的、丑陋的 PHP 转换成一个更易于维护的框架。然而，我遇到了一个相当令人沮丧的障碍——我似乎无法在我的视图中定义方法。每当我尝试时，我都会得到一个完全空白的页面，当我查看调试日志时，处理似乎在视图加载后停止。我可以在视图中定义方法吗？如果不是，为什么，你会建议什么解决方法？

**注意**：该方法与格式化输出字符串有关。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-09T09:55:06.200

[在帮助程序](http://codeigniter.com/user_guide/general/helpers.html)中定义您的函数并从控制器加载它们。这样，您也可以在其他视图中重用这些功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T08:02:35.490

我不熟悉 CodeIgnitor，但它可能会多次包含您的模板。尝试将您的功能包装在支票中：

```
if (!function_exists('myfunc'))
{
    function myfunc() {}
} 
```

CodeIgnitor 可能正在吞噬错误，因此您也可以尝试在函数之前立即刷新缓冲区：

```
while(ob_end_flush()){}
error_reporting(E_ALL);
ini_set('display_errors', 1); 
```

但实际上，您可能应该使您的字符串格式化代码更通用一些。您的模板并不是开始添加功能的好地方。您将开始复制代码，这完全违背了拥有模板的目的。我建议尝试使用 CodeIgnitor 的[Helpers](http://codeigniter.com/user_guide/general/helpers.html)和[Plugins](http://codeigniter.com/user_guide/general/helpers.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-10T19:40:45.273

视图并不意味着调用控制器动作。反转您的逻辑，在控制器中调用该函数并将其设置为您发送到视图的变量。然后你可以让 if 语句在你的视图模板中检查那个变量。

如果这对您不起作用，也许您需要一个助手： http: [//codeigniter.com/user_guide/general/helpers.html](http://codeigniter.com/user_guide/general/helpers.html)

# syntax - Boo 中的 Lambda 表达式？

> ID：275704
> 
> 赞同：8
> 
> 时间：2008-11-09T07:21:18.147
> 
> 标签：syntax, lambda, boo

你如何处理 boo 中的 lambda？“可调用”是一回事吗？如何定义以 lambda 作为参数的方法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-09T07:37:35.633

Boo 确实支持 lambda 表达式语法：

```
foo = {x|x+2}
seven = foo(5)
def TakeLambda(expr as callable(int) as int):
   return expr(10)
twelve = TakeLambda(foo) 
```

在此示例中，`foo`是一个接受数字 x 并返回 x + 2 的函数。因此，调用`foo(5)`返回数字 7。`TakeLambda`是一个接受`foo`并评估它为 10 的函数。

# powershell - 如何引用名称中带括号的文件

> ID：275707
> 
> 赞同：5
> 
> 时间：2008-11-09T07:24:56.703
> 
> 标签：powershell

创建一个名为 Valid[File].txt 的文件并在其中粘贴一些文本。启动powershell并进入目录。

```
gc 有效[文件].txt

```

应该显示文件中的值。它返回空白。如果您使用选项卡自动完成，它会转义名称：

```
gc '有效的[File].txt'

```

但仍然没有返回任何内容。

如何引用名称中带括号的文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-09T07:53:58.517

原来关键是`-literalpath`。有关详细信息，请参阅[此技术网文章](http://www.microsoft.com/technet/scriptcenter/resources/pstips/jun08/pstip0620.mspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T07:52:47.087

您可能需要将其括在引号中： gc "Valid[File].txt"

# java - 在Java中为数字添加前导零？

> ID：275711
> 
> 赞同：544
> 
> 时间：2008-11-09T07:35:20.333
> 
> 标签：java

有没有更好的方法来获得这个结果？如果 num 的数字多于数字，则此函数将失败，并且我觉得它应该在库中的某个地方（例如 Integer.toString(x,"%3d") 或其他东西）

```
static String intToString(int num, int digits) {
    StringBuffer s = new StringBuffer(digits);
    int zeroes = digits - (int) (Math.log(num) / Math.log(10)) - 1; 
    for (int i = 0; i < zeroes; i++) {
        s.append(0);
    }
    return s.append(num).toString();
} 
```

* * *

## 回答 #1

> 赞同：1436
> 
> 时间：2008-11-09T07:46:56.927

String.format ( [https://docs.oracle.com/javase/1.5.0/docs/api/java/util/Formatter.html#syntax](https://docs.oracle.com/javase/1.5.0/docs/api/java/util/Formatter.html#syntax) )

在您的情况下，它将是：

```
String formatted = String.format("%03d", num); 
```

*   0 - 用零填充
*   3 - 将宽度设置为 3

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2008-11-09T07:48:35.643

从 Java 1.5 开始，您可以使用该`String.format`方法。例如，要执行与您的示例相同的操作：

```
String format = String.format("%0%d", digits);
String result = String.format(format, num);
return result; 
```

在这种情况下，您将使用以数字指定的宽度创建格式字符串，然后将其直接应用于数字。此示例的格式转换如下：

```
%% --> %
0  --> 0
%d --> <value of digits>
d  --> d 
```

因此，如果数字等于 5，则格式字符串变为`%05d`指定宽度为 5 的整数，打印前导零。有关转换说明符的更多信息，请参阅[java 文档。](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#format(java.util.Locale,%20java.lang.String,%20java.lang.Object...))`String.format`

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-11-09T10:12:03.887

另一种选择是使用[DecimalFormat](http://java.sun.com/j2se/1.5.0/docs/api/java/text/DecimalFormat.html)来格式化您的数字字符串。如果您被困在 1.5 之前的世界，这是另一种无需使用 String.format 即可完成工作的方法：

```
static String intToString(int num, int digits) {
    assert digits > 0 : "Invalid number of digits";

    // create variable length array of zeros
    char[] zeros = new char[digits];
    Arrays.fill(zeros, '0');
    // format number as String
    DecimalFormat df = new DecimalFormat(String.valueOf(zeros));

    return df.format(num);
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-03-25T00:09:58.097

怎么样：

```
public static String intToString(int num, int digits) {
    String output = Integer.toString(num);
    while (output.length() < digits) output = "0" + output;
    return output;
} 
```

* * *

## 回答 #5

> 赞同：-10
> 
> 时间：2010-09-21T09:09:02.117

如果您的 jdk 版本低于 1.5，可以使用以下选项。

```
 int iTest = 2;
    StringBuffer sTest = new StringBuffer("000000"); //if the string size is 6
    sTest.append(String.valueOf(iTest));
    System.out.println(sTest.substring(sTest.length()-6, sTest.length())); 
```

# printf - sprintf() 和 WriteFile() 影响字符串缓冲区

> ID：275717
> 
> 赞同：1
> 
> 时间：2008-11-09T07:51:57.947
> 
> 标签：printf, writefile

我有一个非常奇怪的问题，我似乎无法弄清楚。不幸的是，如果不描述我的整个应用程序，我什至不确定如何描述它。我想做的是：

```
1）从串口读取一个字节
2) 在读取每个字符时将它们存储到 tagBuffer 中
3) 使用 tagBuffer 运行查询以查看它是什么类型的标签（书或书架标签）
4）根据标签类型，输出标签类型对应的一系列字节

```

我的大部分代码都已实现，我可以将正确的标签代码从串行端口发送回。但是我添加了两行作为调试语句，当我试图删除它们时，它们会导致我的程序停止工作。

这些行是最底部的两行：

 `````
 sprintf(buf,"%s!\n", tagBuffer);
    WriteFile(hSerial,buf,strlen(buf), &dwBytesWritten,&ovWrite); 
````  `如果我尝试删除它们，“tagBuffer”将只存储最后一个字符作为缓冲区。与下一行相同，WriteFile()。

我认为 sprintf 和 WriteFile 是 I/O 函数，对变量没有影响。我被困住了，我需要帮助来解决这个问题。

 `````
//keep polling as long as stop character '-' is not read
while(szRxChar != '-')
{
    // Check if a read is outstanding
    if (HasOverlappedIoCompleted(&ovRead))
    {
        // Issue a serial port read
        if (!ReadFile(hSerial,&szRxChar,1,
                &dwBytesRead,&ovRead))
        {
            DWORD dwErr = GetLastError();
            if (dwErr!=ERROR_IO_PENDING)
                return dwErr;
        }
    }

    // resets tagBuffer in case tagBuffer is out of sync
    time_t t_time = time(0);
    char buf[50];
    if (HasOverlappedIoCompleted(&ovWrite))
    {
        i=0;                                       
    }

    // Wait 5 seconds for serial input
    if (!(HasOverlappedIoCompleted(&ovRead)))
    {
        WaitForSingleObject(hReadEvent,RESET_TIME);
    }

    // Check if serial input has arrived
    if (GetOverlappedResult(hSerial,&ovRead,
            &dwBytesRead,FALSE))
    {
        // Wait for the write
        GetOverlappedResult(hSerial,&ovWrite,
            &dwBytesWritten,TRUE);

        if( strlen(tagBuffer) >= PACKET_LENGTH )
        {
            i = 0;
        }

        //load tagBuffer with byte stream
        tagBuffer[i] = szRxChar;
        i++;
        tagBuffer[i] = 0; //char arrays are \0 terminated

        //run query with tagBuffer  
        sprintf(query,"select type from rfid where rfidnum=\"");
        strcat(query, tagBuffer);
        strcat(query, "\"");
        mysql_real_query(&mysql,query,(unsigned int)strlen(query));

        //process result and send back to handheld
        res = mysql_use_result(&mysql);
        while(row = mysql_fetch_row(res))
        {
           printf("result of query is %s\n",row[0]);

           string str = "";
           str = string(row[0]);

           if( str == "book" )
           {
               WriteFile(hSerial,BOOK_INDICATOR,strlen(BOOK_INDICATOR),
                &dwBytesWritten,&ovWrite);
           }
           else if ( str == "shelf" )
           {
               WriteFile(hSerial,SHELF_INDICATOR,strlen(SHELF_INDICATOR),
                &dwBytesWritten,&ovWrite);
           }
           else //this else doesn't work
           {
               WriteFile(hSerial,NOK,strlen(NOK),
                &dwBytesWritten,&ovWrite);
           }
        }

        mysql_free_result(res);

        // Display a response to input
        //printf("query is %s!\n", query);
        //printf("strlen(tagBuffer) is %d!\n", strlen(tagBuffer));

        //without these, tagBuffer only holds the last character
        sprintf(buf,"%s!\n", tagBuffer);
        WriteFile(hSerial,buf,strlen(buf), &dwBytesWritten,&ovWrite);

    }
} 
````  `有了这两行，我的输出如下所示：

没有它们，我发现 tagBuffer 和 buf 在任何时候都只存储最近的字符。

任何帮助都将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T07:57:29.027

你在哪里分配标签缓冲区，它有多大？
您可能正在覆盖“buf”，因为您正在写入标签缓冲区的末尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T07:58:58.930

这两行似乎不太可能对正确的程序产生这种影响 - 也许您没有为 in`buf`字符串的整个长度分配足够的空间`tagBuffer`？这可能会导致掩盖真正问题的缓冲区溢出？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T08:06:43.827

我要说的第一件事是一条一般性建议：错误并不总是在您认为的位置。如果你正在发生的事情似乎没有意义，这通常意味着你在其他地方的假设是错误的。

在这里，sprintf() 和 WriteFile() 似乎不太可能改变“buf”数组变量的状态。但是，这两行测试代码确实写入“hSerial”，而您的主循环也从“hSerial”读取。这听起来像是改变程序行为的方法。

建议：更改您的调试输出行以将输出存储到其他位置：对话框、日志文件或类似文件。调试输出通常不应该转到核心逻辑中使用的文件，因为这很可能会改变核心逻辑的行为方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T12:16:28.473

在我看来，这里真正的问题是您试图从单个线程读取和写入串行端口，这使得代码比它需要的更复杂。我建议您阅读以下文章并重新考虑您的设计：

*   [Joseph Newcomer 网站的串行端口 I/O](http://www.flounder.com/serial.htm)。
*   来自 MSDN[的 Win32 中的串行通信。](http://msdn.microsoft.com/en-us/library/ms810467.aspx)

在多线程实现中，每当阅读器线程从串行端口读取消息时，您就会将其发布到应用程序的主线程。然后主线程将解析消息并查询数据库，然后将适当的响应排队到写入线程。

这听起来可能比您当前的设计更复杂，但实际上并非如此，正如 Newcomer 解释的那样。

我希望这有帮助！

# javascript - dojo 的 gfx 表面例程是否有 Erase？

> ID：275734
> 
> 赞同：2
> 
> 时间：2008-11-09T08:08:46.727
> 
> 标签：javascript, dojo

我正在使用 Dojo 的 gfx 例程在 div 上绘制一些形状`surface.clear()`，除此之外，有没有办法清除或擦除部分表面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T02:49:44.033

简而言之：没有。请记住，这是一个带有场景图的矢量图形。它不适用于帧缓冲区或像素 => 它不支持擦除区域的概念。

你可以做什么：

*   清除整个表面（surface.clear()）
*   用矩形或任何其他合适的形状或形状遮盖部分表面 - 只需将其放在其他形状的顶部即可。
*   有选择地删除不需要的形状

# emacs - 如何在控制台模式下不使用颜色主题？

> ID：275736
> 
> 赞同：3
> 
> 时间：2008-11-09T08:11:37.187
> 
> 标签：emacs

我使用深蓝色 2 颜色主题，但在控制台下看起来很难看。所以我想在终端下使用无颜色主题，那我该怎么办？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-09T22:31:51.757

为了比那些人略短，变量**`window-system`**是*`something`*如果你在窗口系统中，`nil`如果你在终端中，所以如果我想加载 color-theme-darkblue2 我会：

```
(if window-system
    (progn
       (load "color-theme")
       (color-theme-darkblue2))) 
```

它只会使用终端中的默认颜色。当然，如果您愿意，显然可以在 else 部分加载一个术语友好的主题：

```
(load "color-theme")
(if window-system
     (color-theme-darkblue2)
   (some-term-theme))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T08:49:39.047

在启动 Emacs 之前设置一个与单色终端对应的“TERM”变量。例如，如果您在 xterm 中，请使用：

```
TERM=xterm-mono emacs -nw 
```

如果“控制台”是指文本模式下的 Linux 控制台，则可以尝试使用“vt100”（或“vt320”）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T10:33:38.413

我使用这个，它运行良好，因为我使用来自 Emacs CVS（未来 23）的[多 tty东西：](http://www.emacswiki.org/emacs/MultiTTYSupport)

```
(defun mrc-xwin-look (框架)
  “在 X 窗口中运行时使用的设置”
  （颜色主题深蓝色））

(defun mrc-terminal-look (frame)
  “在终端中运行时使用的设置”
  （颜色主题炭黑））

(defun mrc-setup-frame (框架)
  (set-variable 'color-theme-is-global nil)
  （选择帧帧）
  （条件
   （（窗口系统）
    (mrc-xwin-look 框架)
    （工具栏模式-1）
    (mrc-最大化帧))
   (t (mrc-terminal-look frame))))

(add-hook 'after-make-frame-functions 'mrc-setup-frame)

(add-hook 'after-init-hook
      （拉姆达（）
        (mrc-setup-frame (选定的框架))))

```

它会根据框架是在控制台还是在 X 窗口中运行来选择不同的颜色主题。（我不想在控制台中丢失颜色语法突出显示。）

顺便说一句，最大化看起来像这样：

```
(defun mrc-maximize-frame ()
  “切换框架最大化状态”
  ;; 来自 http://paste.lisp.org/display/54627/raw
  （交互的）
  （条件
   ((eq 'x (窗口系统))
    （预测
      (x-send-client-message nil 0 nil "_NET_WM_STATE" 32
                 '(2 "_NET_WM_STATE_MAXIMIZED_HORZ" 0))
      (x-send-client-message nil 0 nil "_NET_WM_STATE" 32
                 '(2 "_NET_WM_STATE_MAXIMIZED_VERT" 0))))
   （吨
    （消息“最大化不支持窗口系统 %s”
         （符号名称（窗口系统））））））

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-27T20:28:49.357

我使用的另一个简单的：

```
(when window-system
   (load-theme '<myThemeName>)) 
```

因此，这将在窗口系统不为零的所有情况下加载主题，这基本上是任何类型的 gui。

# sql-server-2005 - 如何比较 SQL Server 2005 中的两个日期时间字段？

> ID：275737
> 
> 赞同：1
> 
> 时间：2008-11-09T08:12:05.097
> 
> 标签：sql-server-2005, tsql

```
DECLARE  @p_date DATETIME
SET      @p_date = CONVERT( DATETIME, '14 AUG 2008 10:45:30',?)

SELECT   *
FROM     table1
WHERE    column_datetime = @p_date 
```

我需要比较日期时间，例如：

```
@p_date=14 AUG 2008 10:45:30
column_datetime=14 AUG 2008 10:45:30 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T09:38:01.430

问题尚不清楚，但看起来您正在尝试进行不返回您期望的行的相等匹配，所以我猜测问题在于毫秒是有问题的。这里有几种方法：

1.  使用 CONVERT 格式化两个值（如 varchar 等）：CPU 成本高，不能使用索引
2.  使用 DATEDIFF/DATEPART 进行数学运算 - 类似，但不*那么*昂贵
3.  创建一个范围进行搜索

第三个选项几乎总是最有效的，因为它可以很好地利用索引，并且不需要大量的 CPU。

例如，在上面，由于您的精度是秒*，我会使用：

```
DECLARE @end datetime
SET @end = DATEADD(ss,1,@p_date) 
```

然后添加表单的 WHERE：

```
WHERE column_datetime >= @p_date AND column_datetime < @end 
```

如果您在 column_datetime 上有一个聚集索引，这将最有效，但如果您在 column_datetime 上有一个非聚集索引，它仍然可以正常工作。

[*=如果 @p_date 包含毫秒，您需要更多地考虑是通过 修剪那些毫秒`DATEADD`，还是做更小的范围等]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T09:26:13.963

我不太明白你的问题，但[DateDiff](http://msdn.microsoft.com/en-us/library/ms189794.aspx)可以用来比较日期。

# asp.net-mvc - 如何在自定义 IModelBinder 中的 POST 期间将 Html.CheckBox() 设为布尔值？

> ID：275750
> 
> 赞同：1
> 
> 时间：2008-11-09T08:31:56.443
> 
> 标签：asp.net-mvc

我正在使用`Html.CheckBox()`. 生成的 HTML 是：

```
<input id="IsMultiGraph" name="IsMultiGraph" value="true" type="checkbox">
<input name="IsMultiGraph" value="false" type="hidden"> 
```

在服务器上，我有一个 Action，它接受表单发布信息并使用自定义 IModelBinder 将表单结果绑定到我的一个模型。这是我在 IModelBinder 中运行的代码片段：

```
bool isMultiGraph;
if (!bool.TryParse(bindingContext.HttpContext.Request["IsMultiGraph"], out isMultiGraph))
    bindingContext.ModelState.AddModelError("IsMultiGraph", "Invalid boolean for \"IsMultiGraph\""); //this should not ever happen unless someone is programatically posting
result.IsMultiGraph = isMultiGraph; 
```

问题是，`Html.CheckBox()`如果我更改文本框的状态，则会呈现一个复选框以及一个隐藏的输入字段，因此回发值加倍（即“true，false”）。

我理解为什么要这样做，并且我正在寻找在回发期间解析 CheckBox 的当前值的最佳方法（选中 = true，未选中 = false）。MVC 中是否有另一种帮助方法，或者我应该自己编写？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T12:14:13.267

一种方法是使用类的`GetValues`方法`NameValueCollection`来获取数组属性的第一个值，如下所示：

```
bindingContext.HttpContext.Request.Form.GetValues("IsMultiGraph")[0] 
```

# python - 所有 os.popen() 方法之间有什么区别？

> ID：275756
> 
> 赞同：7
> 
> 时间：2008-11-09T08:50:12.197
> 
> 标签：python, subprocess, popen

我正在查看[Python 文档](http://www.python.org/doc/2.5.2/lib/module-popen2.html)，发现有 4-5 个不同版本的 popen()，例如 os.popen()、os.popen2() 等。

*除了有些包含stderr*而有些不包含这一事实之外，它们之间有什么区别以及您什么时候使用它们？文档并没有很好地解释它。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-09T13:06:46.017

杰森说得对。以一种更容易看到的方式进行总结：

*   os.popen() -> 标准输出
*   os.popen2() -> (标准输入，标准输出)
*   os.popen3() -> (标准输入、标准输出、标准错误)
*   os.popen4() -> (stdin, stdout_and_stderr)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-09T10:44:40.047

我建议使用`subprocess`具有这些功能的所有功能以及更多功能的模块。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-09T08:53:58.803

popen2 不捕获标准错误，popen3 确实捕获标准错误并为其提供唯一的文件句柄。最后，popen4 捕获标准错误，但将其包含在与标准输出相同的文件对象中。

# outlook - 使用 iCalendar 文件更新 Outlook 2007 中的事件

> ID：275759
> 
> 赞同：13
> 
> 时间：2008-11-09T08:59:32.847
> 
> 标签：outlook, outlook-2007, icalendar

这个问题有[一个先前的线程](https://stackoverflow.com/questions/45453/icalendar-and-event-updates-not-working-in-outlook)，并暗示了一个答案，但我无法让它工作。

我有一个 ICS 文件。它[验证](http://severinghaus.org/projects/icv/). 它看起来像这样：

```
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//WA//FRWEB//EN
BEGIN:VEVENT
UID:FRICAL201
SEQUENCE:0
DTSTAMP:20081108T151809Z
DTSTART:20081109T121200
SUMMARY:11/9/2008 12:12:00 PM TRIP FROM JFK AIRPORT (JFK)
LOCATION:JFK AIRPORT (JFK)
END:VEVENT
END:VCALENDAR 
```

我双击它，它完美地进入 Outlook 2007。然后，我双击另一个如下所示的 ICS 文件：

```
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//WA//FRWEB//EN
BEGIN:VEVENT
METHOD:REQUEST
UID:FRICAL201
SEQUENCE:1
DTSTAMP:20081108T161809Z
DTSTART:20081109T121300
SUMMARY:11/9/2008 12:13:00 PM TRIP FROM JFK AIRPORT (JFK)
LOCATION:JFK AIRPORT (JFK)
END:VEVENT
END:VCALENDAR 
```

正如[rfc 中所解释的](https://www.rfc-editor.org/rfc/rfc2446#page-19)，UID 是相同的，并且序列号大一，所以我希望 Outlook 更新我以前的事件条目，但它所做的只是插入第二个。

如何制定 ICS 文件以便 Outlook 知道更新事件？我上面引用的线程中的原始海报说他让它用 METHOD 和 ORGANIZER 做出响应，但根据我的经验，METHOD 没有效果，并且 ORGANIZER 会导致 Outlook 想要将事件通过电子邮件发送给某人的不良行为。我只是想让它更新日历。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-11T05:05:37.670

我找到了汤姆·卡特（Tom Carter），他是发起原始线程的人。他有一个工作示例，请求后取消。我错了，我的 METHOD 应该在我的 VEVENT 里面，而它应该在外面。所以这是一个有效的更新！

原来的：

```
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//WA//FRWEB//EN
METHOD:REQUEST
BEGIN:VEVENT
UID:FRICAL201
SEQUENCE:0
DTSTAMP:20081108T151809Z
ORGANIZER:donotreply@test.com
DTSTART:20081109T121200
SUMMARY:11/9/2008 12:12:00 PM TRIP FROM JFK AIRPORT (JFK)
LOCATION:JFK AIRPORT (JFK)
END:VEVENT
END:VCALENDAR 
```

更新：

```
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//WA//FRWEB//EN
METHOD:REQUEST
BEGIN:VEVENT
UID:FRICAL201
SEQUENCE:1
DTSTAMP:20081108T161809Z
ORGANIZER:donotreply@test.com
DTSTART:20081109T121300
SUMMARY:11/9/2008 12:13:00 PM TRIP FROM JFK AIRPORT (JFK)
LOCATION:JFK AIRPORT (JFK)
END:VEVENT
END:VCALENDAR 
```

我所做的只是添加请求方法（在正确的位置！）和一个组织者。

# javascript - 如何使用javascript从文本框控件中获取选定的文本

> ID：275761
> 
> 赞同：41
> 
> 时间：2008-11-09T09:10:24.183
> 
> 标签：javascript, html, textarea, textselection, selectedtext

我有一个文本框和一个链接按钮。当我写一些文本，然后选择其中一些然后单击链接按钮时，从文本框中选择的文本必须与消息框一起显示。

我该怎么做？

* * *

当我单击下面文本框的提交按钮时，消息框必须显示 Lorem ipsum。因为在该区域中选择了“Lorem ipsum”。

* * *

如果我从页面中选择任何文本并单击它正在工作的提交按钮，但如果我将文本写入文本框并制作它，它不是。因为当我点击另一个空间时，文本框的选择被取消。

现在的问题是，当我从文本框中选择一个文本并单击任何其他控件或空间时，必须仍然选择被选中的文本。

它是如何完成的？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-11-09T10:57:54.013

好的，这是我的代码：

```
function ShowSelection()
{
  var textComponent = document.getElementById('Editor');
  var selectedText;

  if (textComponent.selectionStart !== undefined)
  {// Standards Compliant Version
    var startPos = textComponent.selectionStart;
    var endPos = textComponent.selectionEnd;
    selectedText = textComponent.value.substring(startPos, endPos);
  }
  else if (document.selection !== undefined)
  {// IE Version
    textComponent.focus();
    var sel = document.selection.createRange();
    selectedText = sel.text;
  }

  alert("You selected: " + selectedText);
} 
```

问题，虽然我为 IE 提供的代码在很多网站上都有，但我无法让它在我当前系统上的 IE6 副本上工作。也许它对你有用，这就是我给它的原因。
您寻找的技巧可能是 .focus() 调用，将焦点返回给 textarea，以便重新激活选择。

[更新]我通过 onKeyDown 事件得到了正确的结果（选择内容）：

```
document.onkeydown = function (e) { ShowSelection(); } 
```

所以代码是正确的。同样，问题是通过单击按钮获得选择...我继续搜索。

[更新] 我没有成功绘制带有`li`标签的按钮，因为当我们单击它时，IE 取消选择之前的选择。上面的代码可以使用一个简单的`input`按钮，但是......

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2015-09-04T11:36:59.900

这是一个更简单的解决方案，基于在 mouseup 上发生文本选择的事实，因此我们为此添加了一个事件侦听器：

```
document.querySelector('textarea').addEventListener('mouseup', function () {
  window.mySelection = this.value.substring(this.selectionStart, this.selectionEnd)
  // window.getSelection().toString();
});
```

```
<textarea>
  Select some text
</textarea>
<a href="#" onclick=alert(mySelection);>Click here to display the selected text</a>
```

这适用于所有浏览器。

如果您还想通过键盘处理选择`keyup`，请使用相同的代码添加另一个事件侦听器。

如果不是因为2001 年（是的，14 年前）[提交的这个 Firefox 错误](https://stackoverflow.com/questions/20419515/window-getselection-of-textarea-not-working-in-firefox#comment52700249_20419515)`window.mySelection`，我们可以替换分配给with的值`window.getSelection().toString()`，它适用于 IE9+ 和所有现代浏览器，并且还可以在非 textarea 部分中进行选择的DOM。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-03-16T07:09:13.080

```
function disp() {
  var text = document.getElementById("text");
  var t = text.value.substr(text.selectionStart, text.selectionEnd - text.selectionStart);
  alert(t);
}
```

```
<TEXTAREA id="text">Hello, How are You?</TEXTAREA><BR>
<INPUT type="button" onclick="disp()" value="Select text and click here" />
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-09T10:09:50.287

对于 Opera、Firefox 和 Safari，您可以使用以下功能：

```
function getTextFieldSelection(textField) {
    return textField.value.substring(textField.selectionStart, textField.selectionEnd);
} 
```

然后，您只需将对文本字段元素（如 textarea 或 input 元素）的引用传递给函数：

```
alert(getTextFieldSelection(document.getElementsByTagName("textarea")[0])); 
```

或者，如果您希望 <textarea> 和 <input> 拥有自己的 getSelection() 函数：

```
HTMLTextAreaElement.prototype.getSelection = HTMLInputElement.prototype.getSelection = function() {
    var ss = this.selectionStart;
    var se = this.selectionEnd;
    if (typeof ss === "number" && typeof se === "number") {
        return this.value.substring(this.selectionStart, this.selectionEnd);
    }
    return "";
}; 
```

然后，您只需执行以下操作：

```
alert(document.getElementsByTagName("textarea")[0].getSelection());
alert(document.getElementsByTagName("input")[0].getSelection()); 
```

例如。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-06-03T21:28:40.517

[jQuery-textrange 的忠实](https://github.com/dwieeb/jquery-textrange)粉丝

下面是一个非常小的、独立的示例。下载 jquery-textrange.js 并复制到同一个文件夹。

```
<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>jquery-textrange</title>
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script src="jquery-textrange.js"></script>

<script>
/* run on document load **/
$(document).ready(function() {
    /* run on any change of 'textarea' **/
    $('#textareaId').bind('updateInfo keyup mousedown mousemove mouseup', function() {
        /* The magic is on this line **/
        var range = $(this).textrange();
        /* Stuff into selectedId.  I wanted to store this is a input field so it can be submitted in a form. **/
        $('#selectedId').val(range.text);
    });
});
</script>
</head>
<body>

    The smallest example possible using 
    <a href="https://github.com/dwieeb/jquery-textrange">
       jquery-textrange
    </a><br/>
    <textarea id="textareaId" >Some random content.</textarea><br/>
    <input type="text"  id="selectedId"  ></input>

</body>
</html> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-23T05:12:16.027

```
//Jquery
var textarea = $('#post-content'); 
var selectionStart = textarea.prop('selectionStart');
var selectionEnd = textarea.prop('selectionEnd');
var selection = (textarea.val()).substring(selectionStart,selectionEnd);

//Javascript
var textarea = document.getElementById("post-content");   
var selection = (textarea.value).substring(textarea.selectionStart,textarea.selectionEnd); 
```

# java - 有没有办法用 String.split() 分割字符串并包含分隔符？

> ID：275768
> 
> 赞同：42
> 
> 时间：2008-11-09T09:30:04.800
> 
> 标签：java, regex, string, split

我正在尝试使用所有非字母数字字符作为分隔符拆分字符串，但 Java 的 String.split() 方法会丢弃结果数组中的分隔符。有没有办法像 "\W" 正则表达式模式那样拆分字符串，但保留分隔符？

# gcc - 在 GCC 中转储寄存器的值

> ID：275771
> 
> 赞同：3
> 
> 时间：2008-11-09T09:31:56.403
> 
> 标签：gcc, assembly, x86

我需要使用 GCC 获取寄存器中的值。

与此类似的东西：

```
EAX=00000002 EBX=00000001 ECX=00000005 EDX=BFFC94C0
ESI=8184C544 EDI=00000000 EBP=0063FF78 ESP=0063FE3C
CF=0 SF=0 ZF=0 OF=0

```

获取 32 位寄存器很容易，但我不确定获取标志的最简单方法是什么。

在本书的示例中：http: [//kipirvine.com/asm/](http://kipirvine.com/asm/)

他们通过获取整个 EFLAGS 寄存器并移位有问题的位来做到这一点。我也想过使用 Jcc 和 CMOVcc 来做这件事。

关于如何做到这一点的任何其他建议？一些要验证的测试用例也很有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-09T11:32:37.250

无需使用汇编程序来获取寄存器。

您可以只使用 setjmp。这会将所有寄存器写入 jmp_buf 类型的结构中。它甚至有点跨平台，除了 jmp_buf 本身对于每个架构都不同。

但是，调用 setjmp（以及调用您的汇编代码）会更改一些寄存器，因此您不能真正信任它们。

有一种方法可以获得真正的快照，但这有点困难并且高度依赖于操作系统：

1.  为非法的非法操作码扩展安装异常处理程序。处理程序可以是真正的中断、信号处理程序或 OS 异常处理程序（C++ 中的 try/except 块将不起作用）。

2.  在您的代码中发出非法操作码。

这里的诀窍是，非法操作码没有寄存器副作用。异常处理程序可以从堆栈或异常信息结构中复制寄存器。

同样的技巧可能适用于断点中断、强制溢出、陷阱等。通常有不止一种方法可以从一段代码中引发中断。

* * *

关于 EFLAGS：您可以通过堆栈操作获取它们：

```
 PUSHFD
  POP EAX  
  , eax now contains the EFLAG data 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T11:56:50.510

恕我直言，使用 gdb 比 gcc 更好。

[http://www.unknownroad.com/rtfm/gdbtut/gdbadvanced.html](http://www.unknownroad.com/rtfm/gdbtut/gdbadvanced.html)

高温高压

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-19T20:59:05.790

以下是针对 64 位机器测试的。如果您有 32 位机器，请卸下 64 位齿轮，并更改 flag64 -> flag32 （并使用`pushfd`代替`pushfq`）。在实践中，我发现我只需要检查标志寄存器中的 CY（进位）和 OV（溢出）（我通常使用`jc`、`jnc`、`jo`和`jno`）。

```
#include <stdio.h>
#include <stdint.h>

#define HIGH32(x) ((uint32_t)(((uint64_t)x)>>32))
#define LOW32(x) ((uint32_t)(((uint64_t)x)& 0xFFFFFFFF))

int main(int argc, char** argv)
{
    uint32_t eax32, ebx32, ecx32, edx32;
    uint64_t rax64, rbx64, rcx64, rdx64;

    asm (
         "movl %%eax, %[a1] ;"
         "movl %%ebx, %[b1] ;"
         "movl %%ecx, %[c1] ;"
         "movl %%edx, %[d1] ;"

         "movq %%rax, %[a2] ;"
         "movq %%rbx, %[b2] ;"
         "movq %%rcx, %[c2] ;"
         "movq %%rdx, %[d2] ;"
         :
         [a1] "=m" (eax32), [b1] "=m" (ebx32), [c1] "=m" (ecx32), [d1] "=m" (edx32), 
         [a2] "=m" (rax64), [b2] "=m" (rbx64), [c2] "=m" (rcx64), [d2] "=m" (rdx64)
         );

    printf("eax=%08x\n", eax32);
    printf("ebx=%08x\n", ebx32);
    printf("ecx=%08x\n", ecx32);
    printf("edx=%08x\n", edx32);

    printf("rax=%08x%08x\n", HIGH32(rax64), LOW32(rax64));
    printf("bax=%08x%08x\n", HIGH32(rbx64), LOW32(rbx64));
    printf("cax=%08x%08x\n", HIGH32(rcx64), LOW32(rcx64));
    printf("dax=%08x%08x\n", HIGH32(rdx64), LOW32(rdx64));

    uint64_t flags;

    asm (
         "pushfq        ;"
         "pop %[f1] ;"
         :
         [f1] "=m" (flags)
         );

    printf("flags=%08x%08x", HIGH32(flags), LOW32(flags));

    if(flags & (1 << 0)) // Carry
        printf(" (C1"); 
    else
        printf(" (C0");

    if(flags & (1 << 2)) // Parity
        printf(" P1");
    else
        printf(" P0");

    if(flags & (1 << 4)) // Adjust
        printf(" A1");
    else
        printf(" A0");

    if(flags & (1 << 6)) // Zero
        printf(" Z1");
    else
        printf(" Z0");

    if(flags & (1 << 7)) // Sign
        printf(" S1");
    else
        printf(" S0");

    if(flags & (1 << 11)) // Overflow
        printf(" O1)\n");
    else
        printf(" O0)\n");

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T09:35:49.653

我认为使用 Jcc 会更长，而且使用内联汇编不太清楚。

这是我目前使用 CMOVcc 所拥有的：

```
无效转储注册（）
{
  int eax = 0;
  int ebx = 0;
  int ecx = 0;
  int edx = 0;

  int esi = 0;
  int edi = 0;
  int ebp = 0;
  int esp = 0;

  int cf = 0;
  int sf = 0;
  int zf = 0;
  整数 = 0;

  整数集 = 1; // -52(%ebp)

  asm(
    "movl %eax, -4(%ebp)\n\t"
    "movl %ebx, -8(%ebp)\n\t"
    "movl %ecx, -12(%ebp)\n\t"
    "movl %edx, -16(%ebp)\n\t"
    "movl %esi, -20(%ebp)\n\t"
    "movl %edi, -24(%ebp)\n\t"
    "movl %ebp, -28(%ebp)\n\t"
    "movl %esp, -32(%ebp)\n\t"

    "movl $0, %eax\n\t"
    "cmovb -52(%ebp),%eax\n\t" // 如果 CF = 1 则移动
    "movl %eax, -36(%ebp) \n\t" // cf

    "movl $0, %eax\n\t"
    "cmovs -52(%ebp),%eax\n\t" // 如果 SF = 1 则移动
    "movl %eax, -40(%ebp)\n\t" // sf

    "movl $0, %eax\n\t"
    "cmove -52(%ebp),%eax\n\t" // 如果 ZF = 1 则移动
    "movl %eax, -44(%ebp)\n\t" // zf

    "movl $0, %eax\n\t"
    "cmovo -52(%ebp),%eax\n\t" // 如果 OF = 1 则移动
    "movl %eax, -48(%ebp)\n\t" // 的

    "movl -4(%ebp), %eax\n\t" // 恢复 EAX
  );

  printf("EAX = %#08x\tEBX = %#08x\tECX = %#08x\tEDX = %#08x\n",eax,ebx,ecx,edx);
  printf("ESI = %#08x\tEDI = %#08x\tEBP = %#08x\tESP = %#08x\n",esi,edi,ebp,esp);
  printf("CF = %d\tSF = %d\tZF = %d\tOF = %d\n",cf,sf,zf,of);
}

```

我还没有解决的一件重要的事情是副作用，我希望能够在不干扰状态的情况下调用它，欢迎任何关于这个方向的提示。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-09T09:48:36.057

我的头顶，如果我错了，请纠正我，但你可以分配一些内存，获得分配的地址，然后用一个asm括号将寄存器内容写在那里......或者你可以只是推它进入堆栈并以某种方式手动读取它......我想它需要一些好的asm代码，它可能不是做类似事情的理想方式，但它会起作用。

# java - 如何在 jPanel 上绘制不会重新绘制的东西？

> ID：275778
> 
> 赞同：1
> 
> 时间：2008-11-09T09:42:54.507
> 
> 标签：java, jpanel

如何在 JPanel 中绘制保持不变且不会重新绘制的东西，我正在做一个交通模拟程序，我希望道路只绘制一次，因为它不会改变。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T09:51:57.220

据我所知，不，除非有透明覆盖的技巧。

我看到（并且做过）的大多数图形应用程序只是在每次重绘时重新绘制整个面板。现在，您可以在图形缓冲区中执行一次，然后通过将图形缓冲区复制到 JPanel 来快速绘制整个背景。它应该比调用所有图形基元来绘制道路要快。

或者，像一些 2D 游戏那样，可能绘制一次并更新移动部件，如精灵：它需要擦除精灵使用的旧位置（恢复那里的背景）并在新位置重新绘制精灵。因此，您仍然在图形缓冲区中有道路的副本，但不是每次都重新绘制它，而是只更新一些小部分。可以稍微快一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T09:54:27.543

我不确定您是否真的希望您的道路永远不会被重新粉刷 - 当您的窗口被调整大小时，或者当它在另一个窗口阻碍它之后变得可见时，重新粉刷事件会触发（例如）。如果您的面板从不重新粉刷，那么它看起来会很奇怪。

据我记得，Swing 只会在这些情况下触发适当的绘制事件，所以你应该可以按照通常的方法使用合适的覆盖来继承 JPanel：

```
public class RoadPanel extends JPanel {

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        // your drawing code here
    }
} 
```

如果您将道路缓存为图像或其他图形格式（以节省多次计算显示数据）一次绘制一次，这可能会为您节省一些后续绘制时间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-09T16:22:01.393

每次面板被遮挡（即框架最小化/另一个窗口放在顶部）时，都需要重新绘制组件。因此，仅绘制一次不会像您希望的那样工作。为了更有效地绘制不改变的部分，您可以将它们绘制一次到“缓冲区”图像，然后在每次需要重绘面板或组件时仅绘制此缓冲区。

```
// Field that stores the image so it is always accessible
private Image roadImage = null;
// ...
// ...
// Override paintComponent Method
public void paintComponent(Graphics g){

  if (roadImage == null) {
      // Create the road image if it doesn't exist
      roadImage = createImage(width, height);
      // draw the roads to the image
      Graphics roadG = roadImage.getGraphics();
      // Use roadG like you would any other graphics
      // object to draw the roads to an image
  } else {
      // If the buffer image exists, you just need to draw it.
      // Draw the road buffer image
      g.drawImage(roadImage, 0, 0, null);
  }
  // Draw everything else ...
  // g.draw...
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T15:12:51.550

我所做的是为某个部分是否需要重绘设置一个布尔值。然后，在该`paintComponent()`方法中，我可以检查值并重新绘制某些东西，或者不。

```
protected void paintComponent(Graphics g){
    super.paintComponent(g);
    if (drawRoad) {
        drawRoadMethod(g);
    }
    drawTheRest(g);
} 
```

有点像这样。

# asp.net - Server.MapPath(".")、Server.MapPath("~")、Server.MapPath(@"\")、Server.MapPath("/")。有什么不同？

> ID：275781
> 
> 赞同：460
> 
> 时间：2008-11-09T09:48:03.547
> 
> 标签：asp.net, path, directory, mapping, filesystems

谁能解释`Server.MapPath(".")`,`Server.MapPath("~")`和之间`Server.MapPath(@"\")`的区别`Server.MapPath("/")`？

* * *

## 回答 #1

> 赞同：830
> 
> 时间：2008-11-09T10:01:15.797

**Server.MapPath**指定映射**到物理目录**的相对或虚拟路径。

*   `Server.MapPath(".")`¹返回正在执行的文件（例如 aspx）的当前物理目录
*   `Server.MapPath("..")`返回父目录
*   `Server.MapPath("~")`返回应用程序根目录的物理路径
*   `Server.MapPath("/")`返回域名根目录的物理路径（不一定和应用的根目录相同）

*一个例子：*

假设您将网站应用程序 ( `http://www.example.com/`) 指向

```
C:\Inetpub\wwwroot 
```

并在

```
D:\WebApps\shop 
```

例如，如果您调用`Server.MapPath()`以下请求：

```
http://www.example.com/shop/products/GetProduct.aspx?id=2342 
```

然后：

*   `Server.MapPath(".")`¹次退货`D:\WebApps\shop\products`
*   `Server.MapPath("..")`返回`D:\WebApps\shop`
*   `Server.MapPath("~")`返回`D:\WebApps\shop`
*   `Server.MapPath("/")`返回`C:\Inetpub\wwwroot`
*   `Server.MapPath("/shop")`返回`D:\WebApps\shop`

如果 Path 以正斜杠 ( `/`) 或反斜杠 ( `\`) 开头，则`MapPath()`返回路径，就好像 Path 是完整的虚拟路径一样。

如果 Path 不以斜杠开头，则`MapPath()`返回相对于正在处理的请求的目录的路径。

*注意：在 C# 中，`@`是逐字字面字符串运算符，表示字符串应该“按原样”使用，而不是为转义序列处理。*

*脚注*

1.  `Server.MapPath(null)`也会`Server.MapPath("")`产生[这种效果](https://stackoverflow.com/a/17616488/1185053)。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-07-12T13:49:35.297

只是为了稍微扩展@splattne的答案：

`MapPath(string virtualPath)`调用以下内容：

```
public string MapPath(string virtualPath)
{
    return this.MapPath(VirtualPath.CreateAllowNull(virtualPath));
} 
```

`MapPath(VirtualPath virtualPath)`依次调用`MapPath(VirtualPath virtualPath, VirtualPath baseVirtualDir, bool allowCrossAppMapping)`其中包含以下内容：

```
//...
if (virtualPath == null)
{
    virtualPath = VirtualPath.Create(".");
}
//... 
```

所以如果你打电话`MapPath(null)`or `MapPath("")`，你实际上是在打电话`MapPath(".")`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-01-08T10:49:21.800

1) -- 返回正在执行`Server.MapPath(".")`的文件（例如）的“当前物理目录” 。`aspx`

前任。认为 `D:\WebApplications\Collage\Departments`

2) `Server.MapPath("..")`-- 返回“父目录”

前任。`D:\WebApplications\Collage`

3) `Server.MapPath("~")`-- 返回“应用程序根目录的物理路径”

前任。`D:\WebApplications\Collage`

4) `Server.MapPath("/")`-- 返回域名根的物理路径

前任。`C:\Inetpub\wwwroot`

# c++ - 返回 const 引用是否更有效

> ID：275795
> 
> 赞同：14
> 
> 时间：2008-11-09T10:06:38.860
> 
> 标签：c++, performance

例如

其中最好的是：

```
std::string f() {} 
```

或者

```
const std::string& f() {} 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-11-09T10:33:20.333

函数**永远不应返回**对本地对象/变量的引用，因为此类对象超出范围并在函数返回时被销毁。

不同的是，函数可以返回对范围不受函数上下文限制的对象的 const 或非 const 引用。典型示例是自定义`operator<<`：

```
std::ostream & operator<<(std::ostream &out, const object &obj)
{
   out << obj.data();
   return out;
} 
```

不幸的是，按值返回有其性能缺陷。正如 Chris 所提到的，按值返回对象涉及临时对象的副本及其随后的销毁。复制通过复制构造函数或`operator=`. 为了避免这些低效率，智能编译器可能会应用 RVO 或 NRVO 优化，但在某些情况下它们不能——多次返回。

即将发布的 C++0x 标准（在 gnu gcc-4.3 中部分可用）引入了右值引用 [&&]，可用于区分左值和右值引用。通过这种方式，可以实现**移动构造函数**，这有助于部分返回一个对象，避免复制构造函数的成本和临时的析构函数。

移动构造函数基本上是几年前 Andrei 在Chris 建议的文章[http://www.ddj.com/database/184403855中所设想的。](http://www.ddj.com/database/184403855)

*移动构造函数*具有以下签名：

```
// move constructor
object(object && obj)
{} 
```

并且它应该取得传递对象内部的所有权，使后者处于默认状态。通过这样做，避免了内部结构的副本，并且使临时结构的破坏变得容易。典型的函数工厂将具有以下形式：

```
object factory()
{
    object obj;
    return std::move(obj);
} 
```

从`std::move()`对象返回右值引用。最后但同样重要的是，移动构造函数允许按右值引用返回不可复制的对象。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-09T10:51:14.293

我想补充一下尼古拉的出色回答。是的，您绝不能返回悬空引用（例如，对局部变量的引用），但是，在这些情况下，有三种有用的方法可以提高性能：

1.  返回值优化 (RVO)：您按值返回，但通过只有一条`return`语句来消除复制，这会在现场创建返回值。以下是使用 RVO 的示例：[如何标记 C++ 字符串？](https://stackoverflow.com/questions/275733/c-string#275747)

2.  命名返回值优化 (NRVO)：按值返回，并首先在函数顶部声明返回值变量。所有`return`语句都返回该变量。对于支持 NRVO 的编译器，该变量在返回值槽中分配，并且在返回时不会被复制。例如，

    ```
    string
    foobar()
    {
        string result;
        // fill in "result"
        return result;
    } 
    ```

3.  使用a`shared_ptr`等作为返回类型；这需要在堆而不是堆栈上创建对象。这可以防止悬空引用问题，同时仍然不需要复制整个对象，只需要复制智能指针。

顺便说一句，关于 RVO 和 NRVO 的信息，我不能相信；它们直接来自 Scott Meyers 的《[更有效的 C++](http://www.informit.com/store/product.aspx?isbn=020163371X) 》 。因为我现在没有这本书，所以我描述中的任何错误都是我做的，而不是斯科特的。:-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-09T10:19:53.090

如果您返回对函数本地变量的引用，那么您最终会遇到问题（取决于编译器及其设置）。

如果您在函数返回时返回对仍在范围内的实例的引用，那么它会更快，因为没有创建字符串的副本。

因此后者更有效（技术上），但可能无法按预期运行，具体取决于您返回的引用。

# .net - Windows 7 中将包含哪个 .NET 框架版本？

> ID：275808
> 
> 赞同：2
> 
> 时间：2008-11-09T10:28:25.523
> 
> 标签：.net, windows, windows-7, .net-framework-version

有人知道微软是否已经决定明年（2009 年）**Windows 7 中将发布哪个版本的 .NET 框架？**它会是 .NET 3.5 (SP 1) 还是 4.0？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T11:26:29.930

微软已发表声明，在新的 Windows 平台下一次发布之前不会再有其他 WinHEC（互联网上有很多关于此的信息，[一个站点](http://www.istartedsomething.com/20081022/windows-7-targets-october-2009-rtm-retail-soon-after/)）。另一方面，**Stephen Toub**、**Somasegar**、**ScottGu 的**博客（团队背后的一些推动力）等提到 .NET 4.0 Framework 将在 2010 年初随 Visual Studio 2010 推出。

我还没有找到关于 Windows 7 和 .NET 4.0 之间相似之处的确认，但似乎 Windows 7 可能会在 .NET 4.0 之前稍早出现，尽管不一定如此。10 月中旬ScottGu 的[博客文章中的一段话告诉我们](http://weblogs.asp.net/scottgu/archive/2008/10/16/asp-net-mvc-beta-released.aspx)

> 我将在接下来的几周内尝试发布更多端到端教程，展示如何从一开始就使用 ASP.NET MVC，然后顺理成章地发展到越来越丰富的场景。教程列表中将包括我臭名昭著的 AJAX with MVC 帖子，我一直承诺会写——但到目前为止还没有（我的借口：Silverlight 2、ASP.NET MVC、.NET 4.0、VS10 和 Windows 7 发布）周期在我的团队中同时发生 - 不幸的是我真的很忙，这就是延迟的原因）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T16:27:51.977

有足够多的博客文章可以确定 Visual Studio 2010 将成为 .Net 4.0 的开发平台。由于 Windows 通常在 VS 之前发布，我们可以假设它将安装 3.5。最好的部分是，在 Windows 发布的前几个月，已经暗示了 VS 的发布时间表。.Net 4.0 将不在包装盒中，但很快就会提供。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T13:55:55.587

2009 年 1 月发布的 Windows 7 Public Beta 包含 .net 3.5。.net 4.0 尚未准备好进行 beta 测试，但是，一些 beta 社区已经听说 net 4.0 将发布到 RC1 版本的 Windows 7 进行 beta 测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T10:31:12.087

在我看来，这取决于发布日期。

如果 Windows 7 在 .NET 4.0 之前发布（应该与 Visual Studio 2010 一起发布），那么它不能有 .NET 4.0。但是使用 .NET 3.5 是肯定的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-09T10:47:27.857

当前最新版本是 .NET 3.5 SP1

我已经阅读了有关“.NET 4 中的功能”的博客，所以我在想如果微软想要采取明智的举措，他们将在发布 .NET 4 之后发布 Windows 7

再次，这是我们正在谈论的窗户......

# elmah - 城堡 MonoRail 和 ELMAH

> ID：275810
> 
> 赞同：3
> 
> 时间：2008-11-09T10:33:07.823
> 
> 标签：elmah, castle-monorail

有人成功使用 Castle MonoRail 和 ELMAH 吗？

我们正在使用许多 Resuce 向用户提供友好的错误消息，但如果我们这样做，异常永远不会像 MonoRail 救援拦截它们那样到达 ELMAH。

理想情况下，我们希望用户看到救援，但要在 ELMAH 中记录异常。

任何想法/指针？

干杯，

杰。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T19:17:25.773

查看 Macka 发布的链接后，我编写了这个简单的单轨异常处理程序：

```
public class ElmahExceptionHandler : AbstractExceptionHandler {
    public override void Process(IRailsEngineContext context) {
        ErrorSignal.FromCurrentContext().Raise(context.LastException);
    }
} 
```

然后我在 web.config，monorail 部分注册了它：

```
<monorail>
    <extensions>
        <extension type="Castle.MonoRail.Framework.Extensions.ExceptionChaining.ExceptionChainingExtension, Castle.MonoRail.Framework"/>
    </extensions>
    <exception>
        <exceptionHandler type="MyNamespace.ElmahExceptionHandler, MyAssembly"/>
    </exception>
...
</monorail> 
```

就是这样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-10T11:07:08.737

在[Google Groups](http://groups.google.com/group/elmah/browse_thread/thread/c81280722a05602f)上发帖后，看起来 Atif 可能已经为我指明了正确的方向。

> 您可能想查看 ELMAH 中的错误信号。它专为您希望通过 ELMAH 的管道传递异常的场景而设计，即使它正在被处理/吞咽。以下是一些开始使用错误信号的指针：
> 
> *   [http://code.google.com/p/elmah/wiki/DotNetSlackersArticle#Error_Signa...](http://code.google.com/p/elmah/wiki/DotNetSlackersArticle#Error_Signaling)
> *   [http://code.google.com/p/elmah/wiki/DotNetSlackersArticle#Signaling_e...](http://code.google.com/p/elmah/wiki/DotNetSlackersArticle#Signaling_errors)
> 
> -阿提夫

# asp.net - 如何找出我的 ASP.NET 代码在哪个帐户下运行？

> ID：275824
> 
> 赞同：16
> 
> 时间：2008-11-09T10:57:39.193
> 
> 标签：asp.net, security

在调试模式下运行时，我收到“拒绝访问路径”错误消息。我已尝试授予 {MACHINENAME}\ASPNET 和 NETWORK SERVICE 的权限，但这没有任何区别。我也尝试过 < impersonate = true /> 使用管理员帐户，这也没有区别。那么我如何确定正在使用哪个帐户？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-09T11:16:56.160

要在任何给定时间找出您的应用程序在哪个 NT 帐户下运行，请执行以下操作（在 VB.NET 中）：

```
 Dim User = System.Security.Principal.WindowsIdentity.GetCurrent.User
    Dim UserName = User.Translate(GetType(System.Security.Principal.NTAccount)).Value 
```

使用 ASP.NET 时，此帐户将与您使用 IIS 管理器配置的应用程序池的标识相匹配。请注意，匿名 IIS 用户与 ASP.NET 请求的关系不大。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-07-08T00:16:58.110

vb.net 答案的 C# 代码

```
var user = System.Security.Principal.WindowsIdentity.GetCurrent().User;
var userName = user.Translate(typeof (System.Security.Principal.NTAccount)); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-09T11:37:03.623

您可以使用以下代码：

**C＃**

```
Response.Write("Windows Account which runs ASP.NET is: " 
   + Environment.Username); 
```

**VB.NET**

```
Response.Write("Windows Account which runs ASP.NET is: " _
   & Environment.Username) 
```

如果您在 PC (localhost) 上的 Visual Studio 中运行您的应用程序，您将获得您的用户名。如果您在 IIS 上部署 ASP.NET Web 应用程序，您可能会获得 NETWORK SERVICE 帐户，因为这是运行 IIS 6.0 的默认用户（Windows Server 2000 的 IIS 5.0 上的 ASPNET）。

`Environment.UserName`返回线程当前登录的用户。`Page.User`返回 ASP.NET 通过身份验证验证的名称，并且此用户在大多数情况下独立于运行当前线程的 Windows 登录。对于匿名请求，Page.User 为空白，而 Environment.User 将为 NETWORK SERVICE。

*正如[mdb](https://stackoverflow.com/users/8562/mdb)在对此答案的评论中正确指出的那样，Environment.Username 将仅返回 USERNAME 环境变量，该变量在进程创建时设置，并且在模拟等情况下不会更新。*

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-03-13T10:51:26.833

```
strint t=System.Web.Security.Membership.GetUser().UserName.ToString(); 
```

# .net - 在 .NET 中比较 2 个 XML 文档的最佳方法

> ID：275831
> 
> 赞同：10
> 
> 时间：2008-11-09T11:21:56.930
> 
> 标签：.net, xml

我有一堆需要检查 XML 输出的单元测试。

我已经开始比较字符串，但这不会随着格式和表面差异的阻碍而扩展。

.NET 中评估生成的 XML 在语义上是否与测试期望的相同的最简单方法是什么？

> **关闭**为[您如何比较两个 XML 文档的副本？](https://stackoverflow.com/questions/167946/how-would-you-compare-two-xml-documents)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-09T11:31:36.880

[Microsoft在此处](http://msdn.microsoft.com/en-gb/library/aa302294.aspx)提供其 XML Diff 工具/类。我没有亲自使用它，但听起来它会让你开始：

> “通过使用 XMLDiff 类，程序员能够根据对其应用程序很重要的条件来确定这两个文件是否实际上不同”

它似乎可以处理不同的排序、间距、命名空间前缀等。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-09T12:08:34.713

这是听起来很容易开始的问题之一，但是您挖掘的越多，您在问题空间中发现的深度就越多。

有许多预先存在的工具可以进行 xml 差异 - 都以 GUI 方式（与文本差异工具相同的行）和命令行驱动/组件（更多的是你想要的） . 如前所述，XMLDiff 就是这样一种情况。

当你问这样的问题时，麻烦就开始了——我希望它输出什么？您只是想要一个返回代码来说明它们是相同还是不同（出于单元测试的目的，这实际上可能就足够了） - 还是您想要一个告诉您差异的报告？（如果您想找出问题所在，也可用于单元测试）？如果是后者，您如何获得这些信息？你想要编辑距离吗？你想让它解释数值并告诉你它们之间的区别吗？

节点排序呢？子节点是否应该按特定顺序排列 - 或者如果它们是相同的节点但顺序不同，可以吗？

您可能还希望能够指定要比较的内容。命名空间应该匹配吗？空格在任何地方都很重要吗？是否有某些节点您总是想忽略（例如“时间”属性），或者您是否想要更精细地控制哪些节点被比较而哪些不被比较？

对于数值比较，您希望允许公差吗？对于文本比较（文本节点），文本中的空格*是否*重要？大写呢？

你可以继续下去（就像我在最近工作的这样一个项目的分析中所做的那样）。

每个工具都以不同的程度和不同的方式解决这些问题。

You might decide to just keep it as simple as possible and go for something that does a direct, node-by-node, comparison, with no interpretation - and at the end tell you if they are the same or different. I believe xmldiff will give you that (and a little more).

Also worth thinking about is, if you do want to handle cases such as different node orderings, or ignoring certain branches, you could apply an xslt transform to your test document before the comparison, to normalise it according to your rules.

# c# - C# .NET 标签中的多种颜色

> ID：275836
> 
> 赞同：38
> 
> 时间：2008-11-09T11:32:11.573
> 
> 标签：c#, .net, user-interface, colors, label

我正在寻找一种在单个 C#/.NET 标签中显示多种颜色的方法。例如，标签显示了一系列 csv 分隔值，每个值根据它们落入的桶而呈现颜色。我不想使用多个标签，因为这些值是可变长度的，我不想玩动态布局。有对此的本机支持吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-11-09T12:36:15.313

.NET 中没有执行此操作的本机控件。您最好的选择是编写您自己的 UserControl（称之为 RainbowLabel 或其他名称）。通常你会有一个直接从Label继承的自定义标签控件，但是由于你不能在一个标签中获得多色文本，你只能从UserControl继承。

为了呈现文本，您的 UserControl 可以用逗号分割文本，然后为每个块动态加载不同颜色的标签。然而，更好的方法是使用 Graphics 命名空间中的 DrawString 和 MeasureString 方法将文本直接呈现到您的 UserControl 上。

在 .NET 中编写 UserControls 确实不难，而这种不寻常的问题正是自定义 UserControls 的用途。

**更新**：这是一个简单的方法，可用于在 PictureBox 上呈现多色文本：

```
public void RenderRainbowText(string Text, PictureBox pb)
{
    // PictureBox needs an image to draw on
    pb.Image = new Bitmap(pb.Width, pb.Height);
    using (Graphics g = Graphics.FromImage(pb.Image))
    {
        // create all-white background for drawing
        SolidBrush brush = new SolidBrush(Color.White);
        g.FillRectangle(brush, 0, 0,
            pb.Image.Width, pb.Image.Height);
        // draw comma-delimited elements in multiple colors
        string[] chunks = Text.Split(',');
        brush = new SolidBrush(Color.Black);
        SolidBrush[] brushes = new SolidBrush[] { 
            new SolidBrush(Color.Red),
            new SolidBrush(Color.Green),
            new SolidBrush(Color.Blue),
            new SolidBrush(Color.Purple) };
        float x = 0;
        for (int i = 0; i < chunks.Length; i++)
        {
            // draw text in whatever color
            g.DrawString(chunks[i], pb.Font, brushes[i], x, 0);
            // measure text and advance x
            x += (g.MeasureString(chunks[i], pb.Font)).Width;
            // draw the comma back in, in black
            if (i < (chunks.Length - 1))
            {
                g.DrawString(",", pb.Font, brush, x, 0);
                x += (g.MeasureString(",", pb.Font)).Width;
            }
        }
    }
} 
```

显然，如果您的文本中有超过 4 个以逗号分隔的元素，这将中断，但您明白了。此外，MeasureString 中似乎存在一个小故障，使其返回的宽度比必要的宽几个像素，因此多色字符串似乎被拉长 - 您可能需要调整该部分。

为 UserControl 修改此代码应该很简单。

**注意**：TextRenderer 是一个更好的用于绘制和测量字符串的类，因为它使用整数。Graphics.DrawString 和 .MeasureString 使用浮点数，所以你会在这里和那里得到逐个像素的错误。

**更新**： *忘记*使用 TextRenderer。这是狗慢。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-09T11:39:51.777

您可以尝试使用 RichTextBox 以便您可以获得字符串的多种颜色，然后将其设为只读并删除边框。将背景颜色更改为与它所在的表单相同，您可能会侥幸成功。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-09T11:41:13.210

作为替代方案，您可以在合适的控件（例如 WebBrowser）中以 rtf 或 html 的形式执行此操作。理想情况下，它可能需要更多的资源，但它会很快工作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-09T12:26:33.367

如果您正在为 XP 及更高版本的用户构建 Windows 应用程序，则可以使用 WPF。即使它是 Windows 窗体应用程序，您也可以添加 WPF 用户控件。

然后我会使用标签，并将“前景”属性设置为颜色渐变。

或者，在 Windows 窗体（无 WPF）中，您可以只使用“流程面板”，然后在 for 循环中添加多个标签作为句子的片段......它们将全部“流动”在一起，就好像它是一个标签一样.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-10-08T23:29:16.783

我经常使用彩色标签将关键字标记为红色等。就像在 Phil Wright 的回答中一样，我使用 RichTextBox 控件，删除边框并将背景颜色设置为 SystemColors.Control。

要编写彩色文本，首先清除控件，然后我使用此函数附加彩色文本：

```
private void rtb_AppendText(Font selfont, Color color, Color bcolor, 
                        string text, RichTextBox box)
    {
            // append the text to the RichTextBox control
            int start = box.TextLength;
            box.AppendText(text);
            int end = box.TextLength;

            // select the new text
            box.Select(start, end - start);
            // set the attributes of the new text
            box.SelectionColor = color;
            box.SelectionFont = selfont;
            box.SelectionBackColor = bcolor;
            // unselect
            box.Select(end, 0);

            // only required for multi line text to scroll to the end
            box.ScrollToCaret();
    } 
```

如果您想使用“mono”运行此功能，则在每个新的彩色文本之前添加一个空格，否则 mono 将无法正确设置新颜色。这不是 .NET 所必需的

用法：

```
myRtb.Text = "";
rtb_AppendText(new Font("Courier New", (float)10), 
                   Color.Red, SystemColors.Control, " my red text", myRtb);
rtb_AppendText(new Font("Courier New", (float)10), 
                   Color.Blue, SystemColors.Control, " followed by blue", myRtb); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-09T09:18:23.337

稍微偏离主题...您还可以检查：

*   [生成html颜色表](http://ysgitdiary.blogspot.com/2009/07/how-to-generate-html-color-table-with.html)
*   [sql中的模型颜色](http://ysgitdiary.blogspot.com/2009/07/how-to-create-html-color-table-in-sql.html)
*   [结果](http://ysgitdiary.blogspot.com/2009/07/how-to-create-html-color-table-part-2.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-06-20T17:53:47.217

您可以简单地使用多个标签。设置你想要的字体属性，然后使用左边。top 和 width 属性来显示您想要以不同方式显示的单词。这是假设您使用的是 Windows 窗体。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-02-22T08:31:51.020

试试这个，

```
 labelId.Text = "Successfully sent to" + "<a style='color:Blue'> "  + name + "</a>"; 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-11-09T11:36:16.167

对此没有本机支持；您将不得不使用多个标签或找到将提供此功能的第 3 方控件。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2008-11-09T11:38:00.907

我不这么认为。您应该自己创建一个。

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2009-01-07T15:46:32.977

根据您的问题，您的要求很简单 `lable.Text = "This color is Red"`，所以它必须显示这样的文本“颜色是”将是蓝色，“红色”将是红色......这可以这样完成

```
lable.Text = "<span style='Color:Blue'>" + " The color is " +"</span>" + "<span style='Color:Red'>"Red"</span>" 
```

# emacs - Emacs 中有 (repeat-last-command) 吗？

> ID：275842
> 
> 赞同：151
> 
> 时间：2008-11-09T11:37:02.157
> 
> 标签：emacs, elisp

我经常深入研究 apropos 和 docs 寻找类似以下内容的内容，只是为了放弃手头的任务：

（重复最后一个命令）

执行我刚刚执行的最后一个 C- 或 M- 命令（要反弹到 fn 键）

或者有时是相关的：

（描述最后一个功能）

我刚刚错误地发出了什么击键，我想将其效果添加到我的技巧包中。describe-key 很接近，但需要知道我输入了什么。

我只是对我可信赖的伙伴要求太多了吗？

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2008-11-09T12:12:15.393

重复功能由`repeat.el`Emacs Lisp 包提供，它包含在标准 Emacs 发行版中。来自`repeat.el`的文档：

> 这个包定义了一个重复前面命令的命令，不管是什么，包括它的参数，不管它们是什么。此命令连接到键 Cx z。要重复上一个命令一次，请键入 Cx z。要立即重复第二次，只需键入 z。通过一次又一次地键入 z，您可以一遍又一遍地重复该命令。

要查看有关重复命令的其他信息，请`C-h F repeat RET`在 Emacs 中键入。

* * *

## 回答 #2

> 赞同：169
> 
> 时间：2008-11-09T13:18:54.773

## 重复上一个命令

`C-x``z`

一旦你按下它，只需 `z` 在那之后按下它就会重复（无需`C-x`再次按下）。

* * *

## 回答 #3

> 赞同：86
> 
> 时间：2009-03-09T01:27:02.017

是的，有一个**重复**命令。它被称为`repeat`：

*   您可以使用 重复命令`C-x` `z`，然后点击`z`以继续重复。

有点震惊没人提`repeat-complex-command`，可从键位绑定`C-x` `ESC` `ESC`。

* * *

## 回答 #4

> 赞同：64
> 
> 时间：2008-11-09T12:35:59.340

关于“ **describe-last-function** ”：

有一个变量`last-command`设置为代表您所做的最后一件事的符号。所以这个 elisp 片段 - `(describe-function last-command)`- 应该为立即发生的事情提供文档。

`describe-last-function`所以你可以像这样做一个微不足道的工作

```
(defun describe-last-function() 
  (interactive) 
  (describe-function last-command)) 
```

将该 elisp 或等效项放入其中`.emacs`，您将拥有一个**Mx describe-last-function**。

如果您在感兴趣的事情之后敲了几个键或做了一些修改 last-command 的事情，那么该`command-history`功能可能会令人感兴趣。您可以通过**Mx 命令历史记录**

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2008-11-09T22:16:05.253

此外，还会`M-x view-lossage`显示您输入的最后一百个（？）击键。因此，您将能够看到命令在哪里。这是我使用的，直到我现在才发现`M-x command-history`我认为我现在将使用它`C-h w`。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2008-11-09T12:13:21.897

我不太确定，但也许你正在寻找这个？

> 命令`C-x``z`( `repeat`) 提供了另一种重复 Emacs 命令多次的方法。这个命令重复前面的 Emacs 命令，不管它是什么。重复一个命令使用之前使用的相同参数；它不会每次都读取新参数。

Emacs 手册，8.11 重复命令

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-11-14T00:53:34.587

可能这也有帮助......来自emacs帮助逐字：

```
C-x M-ESC runs the command repeat-complex-command
  which is an interactive compiled Lisp function in `simple.el'.
It is bound to <again>, <redo>, C-x M-:, C-x M-ESC.
(repeat-complex-command ARG)

Edit and re-evaluate last complex command, or ARGth from last.
A complex command is one which used the minibuffer.
The command is placed in the minibuffer as a Lisp form for editing.
The result is executed, repeating the command as changed.
If the command has been changed or is not the most recent previous command
it is added to the front of the command history.
You can use the minibuffer history commands M-n and M-p
to get different commands to edit and resubmit. 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-11-12T16:45:01.297

我个人发现塞巴斯蒂安的想法很有用。这是一个工作版本

```
(global-set-key "\C-r" #'(lambda () (interactive)
                                 (eval (car command-history)))) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-29T14:47:22.013

这是旧的，但是当我想要检索我在 Emacs 提示符下键入的最后一个命令时，Google 会首先弹出这个帖子。这些答案都不适合我，所以我决定为那些以后可能会像我一样偶然发现这个问题的人投入两分钱。我正在使用 Portacle，但我在[这里](https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Ring.html)找到了我想要的东西，所以我希望它足够通用，可以用于不同的设置。无论如何，对我有用的是使用`C-↑`和`C-↓`循环历史。使用`M-p`和`M-n`效果也很好，但我更喜欢使用箭头，因为我经常使用 Bash。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-04T00:35:50.027

[dot-mode](https://www.emacswiki.org/emacs/dot-mode.el)是一种重复最后一个命令的方式。

从它的评论中：

> It emulates the vi `redo' command, repeating the immediately preceding sequence of commands. This is done by recording input commands which change the buffer, i.e. not motion commands.

# sql-server - Silverlight 和 WPF 独立应用程序版本的数据访问技术

> ID：275852
> 
> 赞同：4
> 
> 时间：2008-11-09T11:54:16.397
> 
> 标签：sql-server, wpf, silverlight, ssds

我正在编写一个应用程序，它将是一个独立的 WPF 应用程序，也是一个缩减版本，它将作为 Silverlight 工作，因此托管在浏览器中。我希望 Silverlight 应用程序能够访问云中的数据。WPF 应用程序需要针对本地数据库工作，但随后能够与相同的云存储同步。

所以我需要以下场景才能工作。Silverlight 直接处理存储在云中的数据。WPF 应用程序针对本地数据库工作。但是 WPF 应用程序有能力在启动时转到云端并获取最新版本，以防自上次运行 WPF 应用程序以来在线进行更改。当用户完成 WPF 应用程序后，它可以再次同步对云所做的更改。这可以在 WPF 运行期间提供更好的性能，还允许您脱机运行它并在以后有连接时同步。

可以做到这一点的最佳技术是什么？我知道有一个 Sync Framework、SQL Server Data Service、ADO.NET Entity Framework 和 SQL Server Compact Edition 可以帮助进行数据访问，但我不确定它们是否可以一起工作来完成所呈现的场景。

我自己实现这一切吗？大部分都是免费的，我只需要处理同步吗？如果您对 Microsoft 数据访问技术有深入的了解，那么我将不胜感激您对设计的投入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-10T15:49:47.480

使用标准 SQL Server 后端，您的场景会很容易。:)

但是，我认为您的建议在大多数情况下是可行的。对于 WPF 应用程序并使用 SSDS 同步到云，您可以使用[Project Huron](http://sqlserviceslabs.net/huron.html)（“即将”下载）。这将使您的 SSDS 数据与 WPF 客户端应用程序保持同步。

对于 silverlight 方面，您可以使用 SSDS 的 REST api（或像[SSDS Rest](http://code.msdn.microsoft.com/ssdsrest)这样的帮助库）。

因此，您不需要自己实现大部分功能，但是每当您沿着这条路走下去时，总会遇到很多小路障。玩得开心！

# c++ - 大多数签名/未签名警告的可接受修复？

> ID：275853
> 
> 赞同：9
> 
> 时间：2008-11-09T11:56:34.630
> 
> 标签：c++, stl, coding-style, unsigned

我自己坚信，在我正在处理的项目中，有符号整数是大多数情况下的最佳选择，即使其中包含的值永远不会是负数。（更简单的反向循环，更少的错误机会等，特别是对于只能保存在 0 和 20 之间的值的整数，无论​​如何。）

大多数出错的地方是 std::vector 的简单迭代，过去通常这曾经是一个数组，后来被更改为 std::vector。所以这些循环通常看起来像这样：

```
for (int i = 0; i < someVector.size(); ++i) { /* do stuff */ } 
```

因为这种模式经常被使用，关于有符号和无符号类型之间这种比较的编译器警告垃圾邮件的数量往往会隐藏更多有用的警告。请注意，我们绝对没有超过 INT_MAX 元素的向量，并且请注意，到目前为止，我们使用了两种方法来修复编译器警告：

```
for (unsigned i = 0; i < someVector.size(); ++i) { /*do stuff*/ } 
```

这通常有效，但如果循环包含任何代码，如“if (i-1 >= 0) ...”等，则可能会静默中断。

```
for (int i = 0; i < static_cast<int>(someVector.size()); ++i) { /*do stuff*/ } 
```

此更改没有任何副作用，但确实使循环的可读性降低了很多。（而且打字更多。）

所以我想出了以下想法：

```
template <typename T> struct vector : public std::vector<T>
{
    typedef std::vector<T> base;

    int size() const     { return base::size(); }
    int max_size() const { return base::max_size(); }
    int capacity() const { return base::capacity(); }

    vector()                  : base() {}
    vector(int n)             : base(n) {}
    vector(int n, const T& t) : base(n, t) {}
    vector(const base& other) : base(other) {}
};

template <typename Key, typename Data> struct map : public std::map<Key, Data>
{
    typedef std::map<Key, Data> base;
    typedef typename base::key_compare key_compare;

    int size() const     { return base::size(); }
    int max_size() const { return base::max_size(); }

    int erase(const Key& k) { return base::erase(k); }
    int count(const Key& k) { return base::count(k); }

    map() : base() {}
    map(const key_compare& comp) : base(comp) {}
    template <class InputIterator> map(InputIterator f, InputIterator l) : base(f, l) {}
    template <class InputIterator> map(InputIterator f, InputIterator l, const key_compare& comp) : base(f, l, comp) {}
    map(const base& other) : base(other) {}
};

// TODO: similar code for other container types 
```

您所看到的基本上是 STL 类，其返回 size_type 的方法被覆盖以仅返回“int”。需要构造函数，因为它们不是继承的。

**作为开发人员，如果您在现有代码库中看到这样的解决方案，您会怎么看？**

您会认为“哇，他们正在重新定义 STL，多么巨大的 WTF！”，或者您会认为这是一个很好的简单解决方案，可以防止错误并提高可读性。或者您可能更愿意看到我们花了（半天）左右的时间来更改所有这些循环以使用 std::vector<>::iterator？

（特别是如果此解决方案与禁止将无符号类型用于原始数据（例如无符号字符）和位掩码之外的任何内容相结合。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-09T12:58:33.427

不要从 STL 容器公开派生。它们具有非虚拟析构函数，如果有人通过指向基的指针删除您的对象之一，则会调用未定义的行为。如果您必须例如从向量派生，请私下进行，并通过声明公开您需要公开的部分`using`。

在这里，我只使用 a`size_t`作为循环变量。它简单易读。评论说使用`int`索引将您暴露为 n00b 的发布者是正确的。然而，使用迭代器循环一个向量会使您成为一个稍微有经验的 n00b - 一个没有意识到向量的下标运算符是常数时间的人。（`vector<T>::size_type`是准确的，但不必要地冗长 IMO）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-09T14:19:05.090

虽然我不认为“使用迭代器，否则你看起来 n00b”是解决问题的好方法，但从 std::vector 派生似乎比这更糟糕。

首先，开发人员确实希望vector 是std:.vector，而map 是std::map。其次，您的解决方案不适用于其他容器或与容器交互的其他类/库。

是的，迭代器很丑陋，迭代器循环的可读性不是很好，而 typedef 只会掩盖混乱。但至少，它们确实可以扩展，而且它们是规范的解决方案。

我的解决方案？一个 stl-for-each 宏。这并非没有问题（主要是，它是一个宏，糟糕），但它理解了含义。它不像[这个](http://wtw.tw/papers/foreach.html)那样先进，但可以胜任。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-09T12:33:34.850

## 我制作了这个社区维基...请编辑它。我不再同意反对“int”的建议。我现在觉得还不错。

是的，我同意理查德的观点。你不应该`'int'`在这样的循环中使用计数变量。以下是您可能希望如何使用索引进行各种循环（尽管没有什么理由，偶尔这可能很有用）。

## 向前

```
for(std::vector<int>::size_type i = 0; i < someVector.size(); i++) {
    /* ... */
} 
```

## 落后

你可以这样做，这是完美定义的行为：

```
for(std::vector<int>::size_type i = someVector.size() - 1; 
    i != (std::vector<int>::size_type) -1; i--) {
    /* ... */
} 
```

很快，随着 c++1x（下一个 C++ 版本）的顺利推出，您可以这样做：

```
for(auto i = someVector.size() - 1; i != (decltype(i)) -1; i--) {
    /* ... */
} 
```

递减到 0 以下会导致 i 回绕，因为它是无符号的。

## 但是未签名会使错误陷入困境

这绝不应该成为错误方式（使用`'int'`）的论据。

## 为什么不使用上面的 std::size_t ？

C++ 标准在 中定义`23.1 p5 Container Requirements`，即`T::size_type`，对于`T`一些`Container`，这种类型是一些实现定义的无符号整数类型。现在，使用上面`std::size_t`的 for`i`会让 bug 悄悄潜入。如果`T::size_type`小于或大于`std::size_t`，则会溢出`i`，甚至达不到`(std::size_t)-1`if `someVector.size() == 0`。同样，循环的条件将被完全破坏。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-09T14:12:44.323

绝对使用迭代器。很快您将能够使用“自动”类型，以获得更好的可读性（您关注的一个问题），如下所示：

```
for (auto i = someVector.begin();
     i != someVector.end();
     ++i) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-08-22T00:23:55.280

## 跳过索引

最简单的方法是通过使用迭代器、基于范围的 for 循环或算法来回避问题：

```
for (auto it = begin(v); it != end(v); ++it) { ... }
for (const auto &x : v) { ... }
std::for_each(v.begin(), v.end(), ...); 
```

如果您实际上不需要索引值，这是一个很好的解决方案。它还可以轻松处理反向循环。

## 使用适当的无符号类型

另一种方法是使用容器的尺寸类型。

```
for (std::vector<T>::size_type i = 0; i < v.size(); ++i) { ... } 
```

您也可以使用`std::size_t`（来自 <cstddef>）。有些人（正确地）指出`std::size_t`可能与`std::vector<T>::size_type`（尽管通常是）不同的类型。但是，您可以放心，容器`size_type`将适合`std::size_t`. 所以一切都很好，除非您使用某些样式进行反向循环。我首选的反向循环样式是：

```
for (std::size_t i = v.size(); i-- > 0; ) { ... } 
```

使用这种样式，您可以安全地使用`std::size_t`，即使它的类型大于`std::vector<T>::size_type`. 其他一些答案中显示的反向循环样式需要将 -1 强制转换为正确的类型，因此不能使用更容易键入的类型`std::size_t`。

## 使用有符号类型（小心！）

如果您真的想使用带符号的类型（或者您的[样式指南实际上需要一个](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml?showone=Integer_Types#Integer_Types)），例如`int`编译器警告消息：

```
#include <cassert>
#include <cstddef>
#include <limits>

template <typename ContainerType>
constexpr int size_as_int(const ContainerType &c) {
    const auto size = c.size();  // if no auto, use `typename ContainerType::size_type`
    assert(size <= static_cast<std::size_t>(std::numeric_limits<int>::max()));
    return static_cast<int>(size);
} 
```

现在你可以写：

```
for (int i = 0; i < size_as_int(v); ++i) { ... } 
```

或以传统方式反向循环：

```
for (int i = size_as_int(v) - 1; i >= 0; --i) { ... } 
```

诀窍只是比带有隐式转换的`size_as_int`循环稍微多输入一点，您可以在运行时检查基本假设，您可以使用显式转换使编译器警告静音，您获得与非调试构建相同的速度，因为它几乎肯定会内联，并且优化的目标代码不应该更大，因为模板没有做任何编译器还没有隐式做的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-09T13:14:10.650

`vector.size()`返回一个`size_t`var，所以只需更改`int`为`size_t`，它应该没问题。

理查德的回答更正确，除了一个简单的循环需要做很多工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-09T13:14:17.497

你多虑了这个问题。

最好使用 size_t 变量，但是如果您不相信您的程序员可以正确使用 unsigned，请使用强制转换并处理丑陋。找一个实习生来改变它们，之后就不用担心了。在错误时打开警告，并且不会出现新的错误。您的循环现在可能“丑陋”，但您可以理解这是您的宗教立场对签名与未签名的后果。

# c# - 如何从自定义属性中确定附加类型？

> ID：275855
> 
> 赞同：7
> 
> 时间：2008-11-09T11:57:26.157
> 
> 标签：c#, .net, reflection, custom-attributes

我有一个可以分配给类的自定义属性，`[FooAttribute]`. 我想做的是，从属性中确定哪种类型实际使用了我。例如，如果我有：

```
[FooAttribute]
public class Bar
{
} 
```

在 FooAttribute 的代码中，如何确定是 Bar 类添加了我？我不是专门寻找 Bar 类型，我只是想使用反射设置一个友好的名称。例如

```
[FooAttribute(Name="MyFriendlyNameForThisClass")]
public class Bar
{
}

public class FooAttribute()
{
  public FooAttribute()
  {
    // How do I get the target types name? (as a default)
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-09T13:37:08.670

首先，您可能会考虑现有`[DisplayName]`的以保持友好名称。如前所述，您根本无法在属性中获取此信息。您可以从 Bar 中查找属性，但一般来说，从属性中执行此操作的唯一方法是将类型传递给*属性*- 即

```
[Foo("Some name", typeof(Bar)] 
```

你到底想做什么？可能还有其他选择...

请注意，对于 i18n、resx 等；您可以通过覆盖getter来继承`DisplayNameAttribute`和提供键的查找。`DisplayName`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T13:15:23.160

细化。内置或自定义的属性只是类或类成员的元数据，而属性本身并没有表示它与某物相关联。

*   该类型知道它自己的元数据
*   元数据（在本例中为属性）不知道它属于谁

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T12:56:25.460

从您的句子“我只想使用反射设置一个友好名称”中，我认为您想在运行时将“MyFriendlyNameForThisClass”名称设置为属性。如果是这样，我认为这是不可能的。请看[这个线程](https://stackoverflow.com/questions/51269/change-attributes-parameter-at-runtime)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T23:43:24.300

这很笨拙，但是您可以遍历程序集中的所有类，测试每个“是”此实例的自定义属性。

# build-process - 如何自动将头文件添加到项目中？

> ID：275868
> 
> 赞同：5
> 
> 时间：2008-11-09T12:24:21.343
> 
> 标签：build-process, cmake, codeblocks

我将如何拥有一个 CMake 构建系统，它现在使用[AUX_SOURCE_DIRECTORY](http://www.cmake.org/cmake/help/cmake2.6docs.html#command:aux_source_directory)扫描源文件，也在同一目录中扫描头文件，最好使用类似的命令？

我还没有在文档中找到一个简单的方法来做到这一点，所以我现在有一个糟糕的 bash 脚本来后处理我的（CodeBlocks）项目文件......

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-21T16:57:08.613

您可以使用 file(GLOB ... ) 命令。例如：

```
set(dir my_search_dir)
file (GLOB headers "${dir}/*.h")
message("My headers: " ${headers}) 
```

此命令还可以递归并列出相对于给定路径的文件。请参阅 cmake 文档中的[“文件”命令条目](http://www.cmake.org/cmake/help/cmake2.6docs.html#command:file)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-15T23:10:32.760

AUX_SOURCE_DIRECTORY 的文档表明它不打算以这种方式使用，所以我宁愿怀疑你所问的是否可能。如果您想要一个权威的答案，您可以通过 cmake@cmake.org 联系 CMake 开发人员（他们实际上非常好相处）。

我强烈建议不要使用通配符来指定构建中包含的内容。构建文件应该指定库的确切内容，而不是依赖于目录中发生的情况。一开始它可能很麻烦（如果你习惯了通配符，或者工作方式相同的 IDE），但是当你习惯它时，你不希望有任何其他方式。

# c++ - 如何克服 GCC 限制“无法将模板参数 '0' 转换为 'Foo*'”？

> ID：275871
> 
> 赞同：1
> 
> 时间：2008-11-09T12:27:01.260
> 
> 标签：c++, templates, gcc

假设我有这样的代码：

```
template<class T, T initial_t> class Bar {
  // something
} 
```

然后尝试像这样使用它：

```
Bar<Foo*, NULL> foo_and_bar_whatever_it_means_; 
```

GCC 因错误而退出（在上面的行）：

> 无法将模板参数“0”转换为“Foo*”

我找到了这个线程： http: [//gcc.gnu.org/ml/gcc-help/2007-11/msg00066.html](http://gcc.gnu.org/ml/gcc-help/2007-11/msg00066.html)，但在这种情况下我必须使用NULL（好吧，我可能可以重构 - 但它不会微不足道；有什么建议吗？）。我试图通过创建一个值为 NULL 的变量来解决这个问题，但 GCC 仍然抱怨我将变量而不是变量的地址作为模板参数传递。并且对使用默认 ctor 初始化的变量的引用与 NULL 不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T12:55:46.520

重新思考你的代码可能是解决它的最好方法。您链接到的线程包含来自标准的明确引用，表明这是不允许的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-10T14:07:29.030

要接受`Bar<Foo, NULL>`，你需要

```
template <typename T, int dummy> class Bar; /* Declared but not defined */
template <typename T> class Bar <T,NULL> { /* Specialization */ }; 
```

因为 typeof(NULL)==int。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T13:23:08.527

*这似乎与将字符串文字*作为非类型模板参数传递相同的问题：这是不允许的。如果对象具有**外部链接**，则允许将指向对象的指针作为模板参数：这是为了保证类型的唯一性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T12:50:07.627

你有没有尝试过：

```
Bar<Foo*, (Foo*)NULL> foo_and_bar_whatever_it_means_; 
```

?

或 reinterpret_cast(0)？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-09T14:24:47.310

@Dan Olson：似乎有很简单的解决方法。

创建一个只有一个模板参数的父类。添加一个返回 T 的虚函数。对于基类，它应该被硬编码为 NULL。对于派生类，它将返回第二个模板参数。

# firefox - Firefox 和 SSL：sec_error_unknown_issuer

> ID：275878
> 
> 赞同：59
> 
> 时间：2008-11-09T12:37:49.007
> 
> 标签：firefox, ssl

我的客户端在使用 Firefox访问[https://mediant.ipmail.nl](https://mediant.ipmail.nl)`sec_error_unknown_issuer`时收到一条错误消息。我自己无法重现该错误。我在 Vista 和 XP 机器上安装了 FF，没有任何问题。Ubuntu 上的 FF 也可以正常工作。

有没有人遇到同样的错误，有没有人给我一些线索，所以我可以告诉我的 ISP 更改一些设置？该证书是所谓的通配符 SSL 证书，适用于所有子域 (*.ipmail.nl)。我选最便宜的有错吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-06-22T09:34:27.130

Comodo Wildcard SSL 证书也遇到了同样的问题。阅读文档后，解决方案是确保您在配置中包含他们发送给您的证书链文件，即

```
SSLCertificateChainFile /etc/ssl/crt/yourSERVERNAME.ca-bundle 
```

[Comodo网站](https://support.comodo.com/index.php?_m=knowledgebase&_a=viewarticle&kbarticleid=264&nav=0,1)上的完整详细信息

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-10-28T18:05:20.323

我们遇到了这个问题，它与 Firefox 非常相关——只能在那个浏览器中重现，Safari、IE8、Chrome 等都很好。

修复它需要**从 Comodo 获取更新的证书**并安装它。

不知道他们改变了什么魔法，但这绝对是 Firefox 不喜欢的证书。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-11-28T13:11:02.143

对于 nginx 执行此操作 生成一个链接的 crt 文件使用

```
$ cat www.example.com.crt bundle.crt > www.example.com.chained.crt 
```

生成的文件应在 ssl_certificate 指令中使用：

```
server {
    listen              443 ssl;
    server_name         www.example.com;
    ssl_certificate     www.example.com.chained.crt;
    ssl_certificate_key www.example.com.key;
    ...
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-12-12T05:41:02.270

Firefox 比其他浏览器更严格，需要正确安装中间服务器证书。这可以由购买证书的证书颁发机构提供。中间证书通常安装在与服务器证书相同的位置，并且需要 httpd.conf 文件中的正确条目。

虽然许多人因为它（通常）独家“标记”这一点而责备 Firefox，但它实际上展示了更高级别的安全标准。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-06-14T08:51:16.147

我知道这个线程有点旧，但我们也遇到了这个问题，并将在这里为其他人存档我们的最终解决方案。

Comodo 通配符“正 ssl”证书也有同样的问题。我们正在使用 squid-reverse SSL 代理运行我们的网站，Firefox 会一直抱怨“sec_error_unknown_issuer”，如您所说，但其他所有浏览器都正常。

我发现这是证书链不完整的问题。Firefox 显然没有内置中间证书之一，尽管 Firefox 确实信任根 CA。因此，您必须向 Firefox 提供整个证书链。Comodo 的支持声明：

> 中间证书是介于站点（服务器）证书和根证书之间的证书。中间证书或证书完成了到浏览器信任的根证书的链。
> 
> 使用中间证书意味着您必须在安装过程中完成一个额外的步骤，以使您的站点证书能够链接到受信任的根目录，并且当有人访问您的网站时不会在浏览器中显示错误。

这已经在这个线程的前面提到过，但它并没有解决你如何做到这一点。

首先，您必须制作一个链式证书包，然后使用您最喜欢的文本编辑器完成此操作，然后以正确（反向）的顺序将它们粘贴进去，即

*   中间 CA 证书 2 - IntermediateCA2.crt - 在文件顶部
*   中间 CA 证书 1 - IntermediateCA1.crt
*   根 CA 证书 - root.crt - 在文件末尾

如果从名称中不明显，您可以从您的 ssl 提供商处获得的确切顺序。

然后将文件保存为您喜欢的任何名称。例如 yourdomain-chain-bundle.crt

在此示例中，我没有包含实际的域证书，只要您的服务器可以配置为采用单独的链式证书包，这就是您使用的。

更多数据可以在这里找到：

[https://support.comodo.com/index.php?/Knowledgebase/Article/View/643/0/how-do-i-make-my-own-bundle-file-from-crt-files](https://support.comodo.com/index.php?/Knowledgebase/Article/View/643/0/how-do-i-make-my-own-bundle-file-from-crt-files)

如果由于某种原因您无法将服务器配置为使用单独的链式捆绑包，那么您只需将服务器证书粘贴到捆绑包的开头（顶部）并将生成的文件用作服务器证书。这就是 Eg Squid 案例中需要做的事情。请参阅下面有关此主题的 squid 邮件列表。

[http://www.squid-cache.org/mail-archive/squid-users/201109/0037.html](http://www.squid-cache.org/mail-archive/squid-users/201109/0037.html)

这为我们解决了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-12-03T20:38:27.263

I had this problem with Firefox and my server. I contacted GoDaddy customer support, and they had me install the intermediate server certificate:

[http://support.godaddy.com/help/article/868/what-is-an-intermediate-certificate](http://support.godaddy.com/help/article/868/what-is-an-intermediate-certificate)

After a re-start of the World Wide Web Publishing Service, everything worked perfectly.

If you do not have full access to your server, your ISP will have to do this for you.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-09T12:46:32.920

您的客户端在哪个平台上使用哪个版本的 Firefox？

[这些人与Firefox 支持论坛中](http://support.mozilla.com/tiki-view_forum_thread.php?forumId=1&comments_parentId=64923)记录的问题相同。我希望你能在那里找到解决方案。祝你好运！

*更新：*

让您的客户端检查 Firefox 中的设置：在“高级”-“加密”上有一个“查看证书”按钮。**在列表中查找“Comodo CA Limited”**。我看到 Comodo 是该域名/服务器证书的颁发者。在我的两台机器（Vista 和 Mac 上的 FF 3.0.3）上，该条目在列表中（默认情况下/Mozilla）。

[![替代文字](https://i.stack.imgur.com/b1Cd9.png)](https://i.stack.imgur.com/b1Cd9.png)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-01-31T22:09:13.210

如果其他人在使用 Ubuntu LAMP 和“COMODO Positive SSL”时遇到此问题，请尝试从压缩文件中的证书构建您自己的捆绑包。

`cat AddTrustExternalCARoot.crt COMODORSAAddTrustCA.crt COMODORSADomainValidationSecureServerCA.crt > YOURDOMAIN.ca-bundle`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-06-15T16:31:06.407

2014 年 6 月：

这是我使用的配置，在我的头撞到墙上几天后它工作正常。我使用 Express 3.4（我认为 Express 4.0 也一样）

```
var privateKey  = fs.readFileSync('helpers/sslcert/key.pem', 'utf8');
var certificate = fs.readFileSync('helpers/sslcert/csr.pem', 'utf8');

files = ["COMODORSADomainValidationSecureServerCA.crt",
         "COMODORSAAddTrustCA.crt",
         "AddTrustExternalCARoot.crt"
        ];

ca = (function() {
  var _i, _len, _results;

  _results = [];
  for (_i = 0, _len = files.length; _i < _len; _i++) {
    file = files[_i];
    _results.push(fs.readFileSync("helpers/sslcert/" + file));
  }
  return _results;
})();

var credentials = {ca:ca, key: privateKey, cert: certificate};

// process.env.PORT : Heroku Config environment
var port = process.env.PORT || 4000;

var app = express();
var server = http.createServer(app).listen(port, function() {
        console.log('Express HTTP server listening on port ' + server.address().port);
});
https.createServer(credentials, app).listen(3000, function() {
        console.log('Express HTTPS server listening on port ' + server.address().port);
});

// redirect all http requests to https
app.use(function(req, res, next) {
  if(!req.secure) {
    return res.redirect(['https://mydomain.com', req.url].join(''));
  }
  next();
}); 
```

然后我重定向了 80 和 443 端口：

```
sudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-ports 4000
sudo iptables -t nat -A PREROUTING -p tcp --dport 443 -j REDIRECT --to-ports 3000 
```

正如您在检查我的认证后看到的那样，我有 4 [0,1,2,3]：

> openssl s_client -connect mydomain.com:443 -showcerts | grep "^"

```
ubuntu@ip-172-31-5-134:~$ openssl s_client -connect mydomain.com:443 -showcerts | grep "^ "
depth=3 C = SE, O = AddTrust AB, OU = AddTrust External TTP Network, CN = AddTrust External CA Root
verify error:num=19:self signed certificate in certificate chain
verify return:0
 0 s:/OU=Domain Control Validated/OU=PositiveSSL/CN=mydomain.com
   i:/C=GB/ST=Greater Manchester/L=Salford/O=COMODO CA Limited/CN=COMODO RSA Domain Validation Secure Server CA
 1 s:/C=GB/ST=Greater Manchester/L=Salford/O=COMODO CA Limited/CN=COMODO RSA Domain Validation Secure Server CA
   i:/C=GB/ST=Greater Manchester/L=Salford/O=COMODO CA Limited/CN=COMODO RSA Certification Authority
 2 s:/C=GB/ST=Greater Manchester/L=Salford/O=COMODO CA Limited/CN=COMODO RSA Certification Authority
   i:/C=SE/O=AddTrust AB/OU=AddTrust External TTP Network/CN=AddTrust External CA Root
 3 s:/C=SE/O=AddTrust AB/OU=AddTrust External TTP Network/CN=AddTrust External CA Root
   i:/C=SE/O=AddTrust AB/OU=AddTrust External TTP Network/CN=AddTrust External CA Root
    Protocol  : TLSv1.1
    Cipher    : AES256-SHA
    Session-ID: 8FDEAEE92ED20742.....3E7D80F93226142DD
    Session-ID-ctx:
    Master-Key: C9E4AB966E41A85EEB7....4D73C67088E1503C52A9353C8584E94
    Key-Arg   : None
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 300 (seconds)
    TLS session ticket:
    0000 - 7c c8 36 80 95 4d 4c 47-d8 e3 ca 2e 70 a5 8f ac   |.6..MLG....p...
    0010 - 90 bd 4a 26 ef f7 d6 bc-4a b3 dd 8f f6 13 53 e9   ..J&..........S.
    0020 - f7 49 c6 48 44 26 8d ab-a8 72 29 c8 15 73 f5 79   .I.HD&.......s.y
    0030 - ca 79 6a ed f6 b1 7f 8a-d2 68 0a 52 03 c5 84 32   .yj........R...2
    0040 - be c5 c8 12 d8 f4 36 fa-28 4f 0e 00 eb d1 04 ce   ........(.......
    0050 - a7 2b d2 73 df a1 8b 83-23 a6 f7 ef 6e 9e c4 4c   .+.s...........L
    0060 - 50 22 60 e8 93 cc d8 ee-42 22 56 a7 10 7b db 1e   P"`.....B.V..{..
    0070 - 0a ad 4a 91 a4 68 7a b0-9e 34 01 ec b8 7b b2 2f   ..J......4...{./
    0080 - e8 33 f5 a9 48 11 36 f8-69 a6 7a a6 22 52 b1 da   .3..H...i....R..
    0090 - 51 18 ed c4 d9 3d c4 cc-5b d7 ff 92 4e 91 02 9e   .....=......N...
    Start Time: 140...549
    Timeout   : 300 (sec)
    Verify return code: 19 (self signed certificate in certificate chain) 
```

祝你好运！PD：如果您想要更多答案，请查看：[http ://www.benjiegillam.com/2012/06/node-dot-js-ssl-certificate-chain/](http://www.benjiegillam.com/2012/06/node-dot-js-ssl-certificate-chain/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-05-15T05:32:47.727

如果您从 COMODO 获得证书，则需要添加此行，该文件位于您收到的 zip 文件中。

```
SSLCertificateChainFile /path/COMODORSADomainValidationSecureServerCA.crt 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-02-06T03:38:55.583

正如@user126810 所说，可以通过`SSLCertificateChainFile`配置文件中的适当指令来解决问题。

但是在修复配置并重新启动网络服务器之后，我还必须**重新启动 Firefox**。没有它，Firefox 继续抱怨证书错误（看起来它使用了缓存的证书）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-01-13T04:58:17.317

我一直在用 Firefox 43、El Capitan 和 WHM/cPanel SSL 安装绕圈子，不断收到不受信任的站点错误 - 我没有购买证书，当最后一个人走出门时，它交给我安装. 原来我安装在错误的域下，因为我错过了 www - 但是证书仍然安装在域上，当我使用 www.domain.com.au 在 WHM 中安装证书时，它现在安装担心并且 FF 错误已经消失- 该证书适用于 www 和非 www。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-06-04T15:12:46.470

要回答问题的不可重现性方面 - Firefox 会自动将中间证书导入其证书存储区。因此，如果您之前访问过使用正确配置的证书链使用相同中间证书的站点，那么 Firefox 将存储该证书，因此当您访问使用相同中间证书的链配置不正确的站点时，您不会看到问题证书。

您可以在 Firefox 的证书管理器（选项->隐私和安全->查看证书...）中查看这一点，您可以在其中查看所有存储的证书。在“安全设备”列下，您可以检查证书的来源 - 自动/手动导入的证书将显示为来自“软件安全设备”，而不是“内置对象令牌”，后者是 Firefox 安装的默认设置。您可以删除/不信任任何特定证书并再次测试。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-09-16T09:50:53.447

本周末有同样的问题，只有 Firefox 不接受证书......我的解决方案是在网站的 apache 配置中添加具有以下行的中间证书：

```
SSLCACertificateFile /your/path/to/ssl_ca_certs.pem 
```

*[在https://httpd.apache.org/docs/2.4/fr/mod/mod_ssl.html](https://httpd.apache.org/docs/2.4/fr/mod/mod_ssl.html)上查找更多信息*

# eclipse - 如何摆脱 Eclipse 中的 TagExtraInfo JSTL 警告？

> ID：275880
> 
> 赞同：1
> 
> 时间：2008-11-09T12:40:32.107
> 
> 标签：eclipse, jsp, jstl

我正在使用 WTP 在 Eclipse 中使用 JSTL。我的 WEB-INF/lib 目录中有 jstl 和 standard.jar，一切正常。Eclipse 在我的 JSP 中给了我这个警告：

在构建路径上找不到 c:forEach (org.apache.taglibs.standard.tei.ForEachTEI) 的 TagExtraInfo 类。

我有 JSTL 包括：

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%> 
```

警告位于使用 ac:forEach 的行上。我怎样才能摆脱它？我的项目的目标是 Tomcat v6。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T21:08:38.287

将 web-inf 目录中的 standard.jar 添加到构建路径 jar 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T22:19:27.443

这些罐子实际上是否在构建路径上？如果是这样，您可以尝试关闭并重新打开项目。否则，该消息可从 Web/JSP 文件/验证首选项页面控制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-12T10:42:45.877

最后，我不小心双击了警告，它把我带到了可编辑的源代码。然后我自己解决了这个问题。

# c# - 实现身份映射的最佳结构是什么？

> ID：275885
> 
> 赞同：4
> 
> 时间：2008-11-09T12:50:54.597
> 
> 标签：c#, data-structures, identity-map

尽管 DataTable 是一个内存占用者，但如果由于检索时间为 O(1) 而对象集非常大，那么 DataTable 不是实现和 IdentityMap 的最佳选择吗？

**更新**

如果我决定使用 IDictionary，我会在检索对象时牺牲速度吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-09T13:32:52.623

任何`Dictionary<,>`,`SortedList<,>`或`SortedDictionary<,>`都是显而易见的选择 - 但请注意，排序在这里成为一个问题......`Dictionary<,>`不保证任何特定的顺序；另外两个按键顺序而不是插入顺序。

另请注意，字典不会很好地与数据绑定一起使用。最好创建类似 a 的东西`Collection<T>`，但*封装*a`Dictionary<,>`用于查找。当然，这一切都取决于场景。

`SortedList<,>`可以在[此处](http://msdn.microsoft.com/en-us/library/ms132319.aspx)找到有关 etc 之间的性能等差异的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T13:02:39.207

我更倾向于使用由 Dictionary<T,T> 支持的自定义类而不是 DataTable。据推测，这将构建在可以使用 LINQ 或 DataTables 等来访问关系数据的数据访问层之上，但如果该对象在自定义映射中可用，您至少可以避免从关系中重构它数据。

# c# - 使用 HttpWebRequest 下载没有关键敏感问题的网页

> ID：275888
> 
> 赞同：1
> 
> 时间：2008-11-09T12:58:32.163
> 
> 标签：c#, httpwebrequest

使用 HttpWebRequest 下载没有关键敏感问题的网页

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T13:20:39.577

[更新：我不知道为什么，但是下面的两个示例现在都可以正常工作！最初我在 page2 示例上也看到了 403。也许是服务器问题？]

首先，`WebClient`更容易。其实，[我以前见过这个](http://groups.google.com/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/1393cb0a3c6728a7/258fd33c5fc96c2f)。访问维基百科时，url 中的大小写敏感；尝试确保您在对维基百科的请求中使用了相同的案例。

[更新] 正如 Bruno Conde 和 gimel 所观察到的，使用 %27 应该有助于使其保持一致（间歇性行为表明可能某些维基百科服务器的配置与其他服务器不同）

我刚刚检查过，在这种情况下，案例问题似乎不是问题......但是，*如果*它有效（它~~没有~~），这将是请求页面的最简单方法：

```
 using (WebClient wc = new WebClient())
        {
            string page1 = wc.DownloadString("http://en.wikipedia.org/wiki/Algeria");

            string page2 = wc.DownloadString("http://en.wikipedia.org/wiki/%27Abadilah");
        } 
```

~~恐怕我想不出对破坏事物的领先撇号该怎么办......~~

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-26T20:34:57.627

我确定 OP 现在已经对此进行了排序，但我刚刚遇到了同样的问题 - 通过网络客户端从维基百科下载时出现间歇性 403。设置用户代理标头可以对其进行排序：

```
client.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T13:56:45.883

我也得到了奇怪的结果......首先，

> [http://en.wikipedia.org/wiki/](http://en.wikipedia.org/wiki/) '阿巴迪拉

没有工作，经过一些失败的尝试后它开始工作。

第二个网址，

> [http://en.wikipedia.org/wiki/](http://en.wikipedia.org/wiki/) 't_Zand_(Alphen-Chaam)

对我来说总是失败...

撇号似乎是造成这些问题的原因。如果您将其替换为

> **%27**

所有网址都可以正常工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T13:59:07.253

[尝试使用百分比编码（第 2.1 段）](http://www.ietf.org/rfc/rfc3986)转义特殊字符。例如，单引号`%27`在 URL ( [IRI](http://www.w3.org/International/articles/idn-and-iri/) ) 中表示为。

# javascript - jQuery 悬停和类选择器

> ID：275891
> 
> 赞同：26
> 
> 时间：2008-11-09T13:00:20.427
> 
> 标签：javascript, jquery, html, css

我不想使用以下 HTML、CSS 和 javascript 动态更改 div 的背景颜色。HTML：

```
<div id="menu">
    <div class="menuItem"><a href=#>Bla</a></div>
    <div class="menuItem"><a href=#>Bla</a></div>
    <div class="menuItem"><a href=#>Bla</a></div>
</div> 
```

CSS：

```
.menuItem{
  display:inline;
  height:30px;
  width:100px;
  background-color:#000;
} 
```

Javascript：

```
$('.menuItem').hover( function(){
     $(this).css('background-color', '#F00');
},
function(){
     $(this).css('background-color', '#000');
}); 
```

**编辑：**我忘了说我有理由不想使用 css 方式。

而且我确实忘记检查 DOM 是否已加载。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-11-09T13:27:24.180

你的代码对我来说看起来不错。

在使用 jQuery 的 $(callback) 函数执行 javascript 之前，确保 DOM 已准备就绪：

```
$(function() {
   $('.menuItem').hover( function(){
      $(this).css('background-color', '#F00');
   },
   function(){
      $(this).css('background-color', '#000');
   });
}); 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-11-09T13:57:46.240

我建议不要将 JavaScript 用于这种简单的交互。CSS 能够做到这一点（即使在 Internet Explorer 6 中），它的响应速度也比使用 JavaScript 快得多。

您可以使用 ":hover" CSS 伪类，但为了使其与 Internet Explorer 6 一起使用，您必须在 "a" 元素上使用它。

```
.menuItem
{
    display: inline;
    background-color: #000;

    /* width and height should not work on inline elements */
    /* if this works, your browser is doing the rendering  */
    /* in quirks mode which will not be compatible with    */
    /* other browsers - but this will not work on touch mobile devices like android */

}
.menuItem a:hover 
{
    background-color:#F00;
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-09T13:35:17.910

这可以在 CSS 中使用 :hover 伪类来实现。`<div>`(:hover在 IE6 中对 s 不起作用)

HTML：

```
<div id="menu">
   <a class="menuItem" href=#>Bla</a>
   <a class="menuItem" href=#>Bla</a>
   <a class="menuItem" href=#>Bla</a>
</div> 
```

CSS：

```
.menuItem{
  height:30px;
  width:100px;
  background-color:#000;
}
.menuItem:hover {
  background-color:#F00;
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-09T13:52:30.387

**测试.html**

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>jQuery Test</title>
        <link rel="stylesheet" type="text/css" href="test.css" />
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="test.js"></script>
    </head>
    <body>
        <div id="menu">
            <div class="menuItem"><a href=#>Bla</a></div>
            <div class="menuItem"><a href=#>Bla</a></div>
            <div class="menuItem"><a href=#>Bla</a></div>
        </div>
    </body>
</html> 
```

**测试.css**

```
.menuItem
{

    display: inline;
    height: 30px;
    width: 100px;
    background-color: #000;

} 
```

**测试.js**

```
$( function(){

    $('.menuItem').hover( function(){

        $(this).css('background-color', '#F00');

    },
    function(){

        $(this).css('background-color', '#000');

    });

}); 
```

**作品:-)**

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-09T15:37:43.747

既然这是一个菜单，不妨把它提升到一个新的水平，并清理 HTML，并通过使用列表元素使其更具语义：

HTML：

```
 <ul id="menu">
    <li><a href="#">Bla</a></li>
    <li><a href="#">Bla</a></li>
    <li><a href="#">Bla</a></li>
  </ul> 
```

CSS：

```
#menu {
  margin: 0;
}
#menu li {
  float: left;
  list-style: none;
  margin: 0;
}
#menu li a {
  display: block;
  line-height:30px;
  width:100px;
  background-color:#000;
}
#menu li a:hover {
  background-color:#F00;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-09T21:47:39.663

另一方面，这更有效：

```
$(".menuItem").hover(function(){
    this.style.backgroundColor = "#F00";
}, function() {
    this.style.backgroundColor = "#000";
}); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-09T14:10:16.747

我更喜欢 foxy 的回答，因为在为这项工作制作现有 css 属性时，我们不应该使用 javascript。

不要忘记添加`display: block ;`，`.menuItem`所以高度和宽度都被考虑在内。

编辑：为了更好的脚本/外观和感觉解耦，如果您需要通过 jQuery 更改样式，我会定义一个额外的 css 类并使用`$(...).addClass("myclass")`和`$(...).removeClass("myclass")`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-02-16T15:53:54.460

如果有人阅读原始问题的意思是他们想要动态更改悬停 css 而不仅仅是更改元素的基本 css 规则，我发现这是可行的：

我有一个动态加载的页面，需要我找出加载数据后容器的高度。加载后，我想更改 css 的悬停效果，以便元素覆盖生成的容器。我需要更改 css .daymark:hover 规则以获得新的高度。这是如何...

```
function changeAttr(attrName,changeThis,toThis){
    var mysheet=document.styleSheets[1], targetrule;
    var myrules=mysheet.cssRules? mysheet.cssRules: mysheet.rules;

    for (i=0; i<myrules.length; i++){
        if(myrules[i].selectorText.toLowerCase()==".daymark:hover"){ //find "a:hover" rule
            targetrule=myrules[i];
            break;
        }
    }
    switch(changeThis)
    {
        case "height":
            targetrule.style.height=toThis+"px";
            break;
        case "width":
            targetrule.style.width=toThis+"px";
            break;
    }

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-11T04:21:33.607

我刚刚在 jQuery 中编写了一个示例，说明如何在单选按钮上创建 div 覆盖，从而为 jQuery 创建一个紧凑、交互式但简单的颜色选择器插件

[http://blarnee.com/wp/jquery-colour-selector-plug-in-with-support-for-graceful-degradation/](http://blarnee.com/wp/jquery-colour-selector-plug-in-with-support-for-graceful-degradation/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-06T21:07:16.877

通过创建一个类，始终让事情变得简单易行

.bcolor{ 背景：#F00; }

然后使用 addClass() & removeClass() 完成它

# asp.net-mvc - IIS 6 上的 ASP.NET MVC - 通配符映射 - 传入请求与任何路由都不匹配

> ID：275920
> 
> 赞同：8
> 
> 时间：2008-11-09T13:35:18.003
> 
> 标签：asp.net-mvc, .net-3.5, iis-6

我一直在尝试在 IIS 6 上设置我的 Beta 1 MVC 应用程序，但无法使其正常运行。我已按照其他博客文章中的建议向 .net isapi DLL 添加了通配符映射，但是当我访问网站的根目录时出现以下错误：

```
The incoming request does not match any route.
..
[HttpException (0x80004005): The incoming request does not match any route.]
   System.Web.Routing.UrlRoutingHandler.ProcessRequest(HttpContextBase httpContext) +147
   System.Web.Routing.UrlRoutingHandler.ProcessRequest(HttpContext httpContext) +36
   System.Web.Routing.UrlRoutingHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext context) +4
   HCD.Intranet.Web.Default.Page_Load(Object sender, EventArgs e) +81
   System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +15
   System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +33
   System.Web.UI.Control.OnLoad(EventArgs e) +99
   System.Web.UI.Control.LoadRecursive() +47
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1436 
```

我正在使用 MVC 模板应用程序中提供的 Default.aspx 页面，该页面正确地重写了对网站根目录的访问。

```
public partial class Default : Page
{
    public void Page_Load(object sender, System.EventArgs e)
    {
        HttpContext.Current.RewritePath(Request.ApplicationPath);
        IHttpHandler httpHandler = new MvcHttpHandler();
        httpHandler.ProcessRequest(HttpContext.Current);
    }
} 
```

如果我尝试访问应用程序中的路由，例如 /Project，我会得到标准的 IIS 404 错误页面，而不是 .net 错误页面。

我尝试将以下行添加到我的 Web.config httpHandlers 部分：

```
<add verb="*" path="*" validate="false" type="System.Web.Mvc.MvcHttpHandler, System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/> 
```

这给了我一个不同的错误——.net 404 错误页面。

我在我的 Global.asax 中添加了以下内容，但它什么也没做：

```
protected void Application_BeginRequest(object sender, EventArgs e)
{
    if (Context.Request.FilePath.Equals("/"))
        Context.RewritePath("Default.aspx");
} 
```

我正在使用以下路由配置（使用 MvcContrib 项目提供的 restful 路由）：

```
routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
SimplyRestfulRouteHandler.BuildRoutes(routes);
routes.MapRoute(
"Default", 
"{controller}/{action}/{id}",
new { controller = "Home", action = "Index", id = "" }
); 
```

任何建议都会受到欢迎，因为我现在已经用尽了所有选项。

非常感谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-10T22:21:38.110

这是我为使无扩展名 URL 与 IIS 6 和 ASP.NET MVC Beta 1 一起使用所做的工作。

*   创建一个默认的 ASP.NET MVC Beta 项目并编译它。
*   创建一个指向应用程序目录的新 IIS 网站。
*   在网站的 IIS 属性中，单击 HomeDirectory 选项卡。
*   单击“配置...”按钮。在“映射”选项卡中，单击“插入...”
*   在“通配符应用程序映射”标签旁边 在文本框中，键入“c:\windows\microsoft.net\framework\v2.0.50727\aspnet_isapi.dll”
*   取消选中标有“验证该文件是否存在”的框单击“确定”
*   导航到 /home 成功了！

您根本不需要更改 web.config。您只需要将所有到 IIS 的请求映射到 ASP.NET Isapi dll，否则 ASP.NET 将永远不会收到这些请求。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-12T12:47:35.227

好的，开始工作了。

问题是我使用 msbuild 自动化来打包我需要部署的文件，而我缺少 global.asax。

所以看起来如果 global.asax 没有部署到站点，那么没有任何路由被连接。这意味着正确点击网站根目录会导致错误“传入的请求与任何路由都不匹配。”，并且任何其他请求不再被路由到您的控制器类，因此导致 404。

HTH。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T13:46:35.763

不幸的是，IIS 6 需要一个文件扩展名来将请求映射到正确的处理程序，这意味着您必须在控制器名称上使用 .mvc 后缀，例如 */{controller}.mvc/{action}*

```
routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

SimplyRestfulRouteHandler.BuildRoutes(routes);

routes.MapRoute(
      "Default",
      "{controller}.mvc/{action}/{id}",
      new { controller = "Home", action = "Index", id = "" }
); 
```

但是，解决此问题的方法取决于您对 IIS 6 服务器的控制级别。请参阅以下页面了解更多信息

*   [http://biasecurities.com/blog/2008/how-to-enable-pretty-urls-with-asp-net-mvc-and-iis6/](http://biasecurities.com/blog/2008/how-to-enable-pretty-urls-with-asp-net-mvc-and-iis6/)
*   [http://www.flux88.com/UsingASPNETMVCONIIS6WithoutTheMVCExtension.aspx](http://www.flux88.com/UsingASPNETMVCOnIIS6WithoutTheMVCExtension.aspx)

# wcf - 会话之间的 WCF 数据持久性

> ID：275926
> 
> 赞同：3
> 
> 时间：2008-11-09T13:42:24.150
> 
> 标签：wcf, persistence, session

我们正在开发一个基于 WCF 的系统。在这个过程中，我们试图锁定一些数据不被多个用户修改。所以我们决定有一个数据结构，它将包含执行锁定逻辑所需的信息（例如通过存储锁定对象的 ID）

我们遇到的问题是在会话之间保留该数据。无论如何我们可以避免执行昂贵的数据库调用吗？我不确定我们如何在 WCF 中做到这一点，因为它只能在打开的会话期间保存数据（在内存中）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-09T23:21:22.897

服务实现类的静态成员在会话和调用之间共享。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-10T04:48:49.037

正如 Jimmy McNulty 所说，一种选择是使用静态成员。我有一个 WCF 服务，它根据用户指定的 IP 地址打开网络连接。我的服务配置为 PerCall 服务实例模式。在每个会话中，我都会检查一个静态数据结构，以查看是否已经为指定的 IP 地址打开了网络连接。这是一个例子。

```
[ServiceContract]
public interface IMyService
{
    [OperationContract]
    void Start(IPAddress address);
}

[ServiceBehavior(InstanceContextMode=InstanceContextMode.PerCall)]
public class MyService : IMyService
{
    private static readonly List<IPAddress> _addresses = new List<IPAddress>();
    public void Start(IPAddress address)
    {
        lock(((ICollection)_addresses).SyncRoot)
        {
            if (!_addresses.Contains(address)
            {
                // Open the connection here and then store the address.
                _addresses.Add(address);
            }
        }
    }
} 
```

按照配置，对 Start() 的每次调用都发生在其自己的服务实例中，并且每个实例都可以访问静态集合。由于每个服务实例都在单独的线程中运行，因此必须同步对集合的访问。

与在多线程编程中完成的所有同步一样，一定要尽量减少花在锁上的时间。在所示示例中，一旦第一个调用者获取锁，所有其他调用者必须等待直到锁被释放。这适用于我的情况，但可能不适用于您的情况。

另一种选择是使用单一服务实例模式，而不是 PerCall 服务实例模式。

```
[ServiceBehavior(InstanceContextMode=InstanceContextMode.Single)]
public class MyService : IMyService
{ ... } 
```

不过，从我读过的所有内容来看，PerCall 似乎更灵活。

您可以点击此[链接](http://msdn.microsoft.com/en-us/library/system.servicemodel.instancecontextmode.aspx)了解两者之间的差异。

并且不要忘记实现您的服务的类就是这样 - 一个类。它像所有 C# 类一样工作。您可以添加静态构造函数、属性、事件处理程序、实现其他接口等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T14:10:56.837

也许像[速度](http://blogs.msdn.com/velocity/)这样的缓存框架可以帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T15:26:26.453

创建第二个类并将其 InstanceContextMode 设置为 single 并将所有昂贵的方法移到那里，然后在您的原始类中使用这些方法。

# java - 在 Java 中修改图形上下文

> ID：275927
> 
> 赞同：0
> 
> 时间：2008-11-09T13:45:34.767
> 
> 标签：java, swing

我有一个试图修改 JComponent 的图形上下文的表单。例如，我使用

```
((Graphics2D) target.getGraphics()).setStroke(new BasicStroke(5)); 
```

现在，在我设置值并关闭表单后，更改是不可见的。我不允许修改 JComponent 的图形上下文吗？我还能如何修改笔触、颜色和变换？

谢谢，

弗拉德

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T19:59:23.937

这种方法有几个问题。首先是大多数组件在被要求重新绘制自己时会自行设置这些东西。这意味着每次组件到达实际使用它的点时，您的更改都会丢失。但是，在更基础的层面上，Graphics2D 对象不是持久的。它们通常在每次重绘组件时实例化，这意味着您获得的 Graphics2D 对象将与组件在重绘时使用的对象不同。

您需要做的是，要实现这种事情，要么自己重新实现特定组件，要么实现会影响整个挥杆组件集的新外观。请查看以下链接以获取有关此内容的更多详细信息：

[http://today.java.net/pub/a/today/2006/09/12/how-to-write-custom-look-and-feel.html](http://today.java.net/pub/a/today/2006/09/12/how-to-write-custom-look-and-feel.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T21:47:43.313

没人回答吗？我已经让一些时间看看是否有任何好的答案摆在我面前：我不是这个问题的专家......

首先，我不完全理解您的问题：您更改设置然后关闭表单？

无论如何，我不太确定，但在这个过程中的某个地方，图形上下文可能会被重新计算或取自默认值。也许如果你在paint() 方法中做这个操作，你可以得到一些结果，虽然我不确定。

对于许多更改，您通常使用装饰器。在回答关于 SO 的问题时，我探讨了这个主题：[如何在 Java 中向 JComboBox 添加分隔符？](https://stackoverflow.com/questions/138793/how-do-i-add-a-separator-to-a-jcombobox-in-java#139366 "如何在 Java 中向 JComboBox 添加分隔符？"). 我不得不在那里画我自己的边界（不对称），但通常你只取一个现有的，所以它很简单。

我希望我提供了一些信息，如果它没有帮助，也许你应该提供更多关于你想要做什么的细节（也许是一个简单的、最小的程序来说明你的问题）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T12:41:48.763

好的，我已经解决了这样的问题：自定义 JComponent 现在拥有一个 Stroke 对象，当用户单击“确定”时，该对象由“选择笔划”表单设置。然后，在JComponent 的paint 方法中，我将作为参数传递的图形上下文的描边设置为对象中包含的描边。

我进行了实验，发现由于某种原因， JComponent.getGraphics().set* 不起作用。

# jquery - 你如何在 jQuery 中使元素“闪烁”

> ID：275931
> 
> 赞同：268
> 
> 时间：2008-11-09T13:49:39.127
> 
> 标签：jquery, animation, element, highlight, flashing

我是 jQuery 的新手，并且有一些使用 Prototype 的经验。在 Prototype 中，有一种“闪现”元素的方法——即。短暂地用另一种颜色突出显示它并让它恢复正常，以便用户的眼睛被它吸引。jQuery中有这样的方法吗？我看到了 fadeIn、fadeOut 和动画，但我没有看到像“flash”这样的东西。也许这三个之一可以与适当的输入一起使用？

* * *

## 回答 #1

> 赞同：367
> 
> 时间：2012-02-01T14:19:07.350

我的方式是 .fadein, .fadeout .fadein, .fadeout ......

```
$("#someElement").fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100); 
```

```
function go1() { $("#demo1").fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100)}

function go2() { $('#demo2').delay(100).fadeOut().fadeIn('slow') }
```

```
#demo1,
#demo2 {
  text-align: center;
  font-family: Helvetica;
  background: IndianRed;
  height: 50px;
  line-height: 50px;
  width: 150px;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<button onclick="go1()">Click Me</button>
<div id='demo1'>My Element</div>
<br>
<button onclick="go2()">Click Me</button> (from comment)
<div id='demo2'>My Element</div>
```

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2009-07-17T21:13:25.320

您可以使用[jQuery Color 插件](https://github.com/jquery/jquery-color "GitHub 上的 jQuery 颜色")。

例如，要引起对页面上所有 div 的注意，您可以使用以下代码：

```
$("div").stop().css("background-color", "#FFFF9C")
    .animate({ backgroundColor: "#FFFFFF"}, 1500); 
```

**编辑 - 新的和改进的**

以下使用与上述相同的技术，但它具有以下优点：

*   参数化的高亮颜色和持续时间
*   保留原始背景颜色，而不是假设它是白色
*   作为 jQuery 的扩展，因此您可以在任何对象上使用它

扩展 jQuery 对象：

```
var notLocked = true;
$.fn.animateHighlight = function(highlightColor, duration) {
    var highlightBg = highlightColor || "#FFFF9C";
    var animateMs = duration || 1500;
    var originalBg = this.css("backgroundColor");
    if (notLocked) {
        notLocked = false;
        this.stop().css("background-color", highlightBg)
            .animate({backgroundColor: originalBg}, animateMs);
        setTimeout( function() { notLocked = true; }, animateMs);
    }
}; 
```

使用示例：

```
$("div").animateHighlight("#dd0000", 1000); 
```

* * *

## 回答 #3

> 赞同：105
> 
> 时间：2012-08-11T14:19:24.677

您可以使用 css3 动画来闪烁元素

```
.flash {
  -moz-animation: flash 1s ease-out;
  -moz-animation-iteration-count: 1;

  -webkit-animation: flash 1s ease-out;
  -webkit-animation-iteration-count: 1;

  -ms-animation: flash 1s ease-out;
  -ms-animation-iteration-count: 1;
}

@keyframes flash {
    0% { background-color: transparent; }
    50% { background-color: #fbf8b2; }
    100% { background-color: transparent; }
}

@-webkit-keyframes flash {
    0% { background-color: transparent; }
    50% { background-color: #fbf8b2; }
    100% { background-color: transparent; }
}

@-moz-keyframes flash {
    0% { background-color: transparent; }
    50% { background-color: #fbf8b2; }
    100% { background-color: transparent; }
}

@-ms-keyframes flash {
    0% { background-color: transparent; }
    50% { background-color: #fbf8b2; }
    100% { background-color: transparent; }
} 
```

而你 jQuery 来添加类

```
jQuery(selector).addClass("flash"); 
```

* * *

## 回答 #4

> 赞同：81
> 
> 时间：2014-04-12T12:20:28.040

### 5年后......（并且不需要额外的插件）

**这个通过在其后面放置一个 div 背景**颜色，然后**将对象淡出**再淡入，将其“脉冲”成您想要的颜色（例如白色）。

**HTML**对象（例如按钮）：

```
<div style="background: #fff;">
  <input type="submit" class="element" value="Whatever" />
</div> 
```

**jQuery**（香草，没有其他插件）：

```
$('.element').fadeTo(100, 0.3, function() { $(this).fadeTo(500, 1.0); }); 
```

**元素**- 类名

**转换的第一个数字**（以`fadeTo()`毫秒为单位）

**第二个数字**`fadeTo()`- 淡入淡出后对象的不透明度

您可以在此网页的右下角查看：[https ://single.majlovesreg.one/v1/](https://single.majlovesreg.one/v1/)

**通过使用 $(this) 和调整值来编辑**（willsteel）没有重复的选择器以实际执行闪存（根据 OP 的要求）。

* * *

## 回答 #5

> 赞同：47
> 
> 时间：2008-11-09T14:03:29.833

我猜你可以使用 jQuery UI 中的[高亮效果](http://docs.jquery.com/UI/Effects/Highlight)来达到同样的效果。

* * *

## 回答 #6

> 赞同：46
> 
> 时间：2011-01-12T18:20:40.053

如果您使用的是 jQueryUI，则`pulsate`有`UI/Effects`

```
$("div").click(function () {
      $(this).effect("pulsate", { times:3 }, 2000);
}); 
```

[http://docs.jquery.com/UI/Effects/Pulsate](http://docs.jquery.com/UI/Effects/Pulsate)

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2012-10-09T20:45:48.117

```
$('#district').css({opacity: 0});
$('#district').animate({opacity: 1}, 700 ); 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2015-03-11T06:48:02.413

### 纯 jQuery 解决方案。

（不需要 jquery-ui/animate/color。）

如果你想要的只是黄色的“闪光”效果而不加载 jquery 颜色：

```
var flash = function(elements) {
  var opacity = 100;
  var color = "255, 255, 20" // has to be in this format since we use rgba
  var interval = setInterval(function() {
    opacity -= 3;
    if (opacity <= 0) clearInterval(interval);
    $(elements).css({background: "rgba("+color+", "+opacity/100+")"});
  }, 30)
}; 
```

上面的脚本只是做了 1s 黄色淡出，非常适合让用户知道元素已更新或类似的东西。

用法：

```
flash($('#your-element')) 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2008-11-09T14:14:42.867

你可以使用这个插件（把它放在一个 js 文件中并通过 script-tag 使用它）

[http://plugins.jquery.com/project/color](http://plugins.jquery.com/project/color)

然后使用这样的东西：

```
jQuery.fn.flash = function( color, duration )
{

    var current = this.css( 'color' );

    this.animate( { color: 'rgb(' + color + ')' }, duration / 2 );
    this.animate( { color: current }, duration / 2 );

} 
```

这为所有 jQuery 对象添加了一个“flash”方法：

```
$( '#importantElement' ).flash( '255,0,0', 1000 ); 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2012-06-15T16:06:59.993

您可以通过允许迭代计数进行多次闪烁来进一步扩展李德胜的方法，如下所示：

```
// Extend jquery with flashing for elements
$.fn.flash = function(duration, iterations) {
    duration = duration || 1000; // Default to 1 second
    iterations = iterations || 1; // Default to 1 iteration
    var iterationDuration = Math.floor(duration / iterations);

    for (var i = 0; i < iterations; i++) {
        this.fadeOut(iterationDuration).fadeIn(iterationDuration);
    }
    return this;
} 
```

然后您可以使用时间和闪烁次数调用该方法：

```
$("#someElementId").flash(1000, 4); // Flash 4 times over a period of 1 second 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2014-02-13T17:34:56.727

一个非常简单的答案怎么样？

`$('selector').fadeTo('fast',0).fadeTo('fast',1).fadeTo('fast',0).fadeTo('fast',1)`

闪烁两次……就是这样！

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2011-09-25T22:42:49.820

我不敢相信这还不是在这个问题上。你要做的就是：

```
("#someElement").show('highlight',{color: '#C8FB5E'},'fast'); 
```

这完全符合您的要求，非常简单，适用于两种`show()`方法`hide()`。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2013-02-11T21:07:00.870

这可能是一个更新的答案，并且更短，因为自从这篇文章以来，事情已经有所巩固。需要**jquery-ui-effect-highlight**。

```
$("div").click(function () {
  $(this).effect("highlight", {}, 3000);
}); 
```

[http://docs.jquery.com/UI/Effects/Highlight](http://docs.jquery.com/UI/Effects/Highlight)

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2016-07-01T02:48:42.893

```
function pulse() {
    $('.blink').fadeIn(300).fadeOut(500);
}
setInterval(pulse, 1000); 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2008-11-09T14:03:00.303

会不会~~[脉冲效应](http://enhance.qd-creative.co.uk/demos/pulse/)~~（离线）JQuery 插件是否适合您正在寻找的内容？

您可以添加持续时间以及时限制脉冲效果。

* * *

正如**[JP](https://stackoverflow.com/users/21677/j-p)**在评论中提到的，现在有*他* [更新的脉冲插件](http://james.padolsey.com/javascript/simple-pulse-plugin-for-jquery/)。
查看他的[GitHub 存储库](https://github.com/padolsey/jQuery-Plugins/tree/master/pulse)。这是[一个演示](http://jsfiddle.net/9sWRT/207/)。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2013-07-22T04:51:54.950

后来发现了这么多卫星，但如果有人在乎，这似乎是让某些东西永久闪烁的好方法：

```
$( "#someDiv" ).hide();

setInterval(function(){
     $( "#someDiv" ).fadeIn(1000).fadeOut(1000);
},0) 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2013-09-29T22:21:47.417

我一直在寻找解决此问题的方法，但不依赖 jQuery UI。

这就是我想出的，它对我有用（没有插件，只有 Javascript 和 jQuery）；-- 这是工作小提琴 -- [http://jsfiddle.net/CriddleCraddle/yYcaY/2/](http://jsfiddle.net/CriddleCraddle/yYcaY/2/)

将您的 CSS 文件中的当前 CSS 参数设置为普通 css，并创建一个仅处理要更改的参数的新类，即背景颜色，并将其设置为 '!important' 以覆盖默认行为。像这样...

```
.button_flash {
background-color: #8DABFF !important;
}//This is the color to change to. 
```

然后只需使用下面的函数并将 DOM 元素作为字符串传递，一个整数表示您希望 flash 发生的次数，您要更改为的类，以及一个表示延迟的整数。

注意：如果你为'times'变量传递一个偶数，你将得到你开始的类，如果你传递一个奇数，你将得到切换类。两者都对不同的事情有用。我用'i'来改变延迟时间，否则它们会同时开火，效果会丢失。

```
function flashIt(element, times, klass, delay){
  for (var i=0; i < times; i++){
    setTimeout(function(){
      $(element).toggleClass(klass);
    }, delay + (300 * i));
  };
};

//Then run the following code with either another delay to delay the original start, or
// without another delay.  I have provided both options below.

//without a start delay just call
flashIt('.info_status button', 10, 'button_flash', 500)

//with a start delay just call
setTimeout(function(){
  flashIt('.info_status button', 10, 'button_flash', 500)
}, 4700);
// Just change the 4700 above to your liking for the start delay.  In this case, 
//I need about five seconds before the flash started. 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2012-10-30T04:50:38.287

以下代码对我有用。定义两个淡入淡出函数，放在彼此的回调中。

```
var fIn = function() { $(this).fadeIn(300, fOut); };
var fOut = function() { $(this).fadeOut(300, fIn); };
$('#element').fadeOut(300, fIn); 
```

以下控制闪烁的次数：

```
var count = 3;
var fIn = function() { $(this).fadeIn(300, fOut); };
var fOut = function() { if (--count > 0) $(this).fadeOut(300, fIn); };
$('#element').fadeOut(300, fIn); 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2012-06-24T01:46:34.717

如果包含一个库是多余的，这里是一个保证工作的解决方案。

```
$('div').click(function() {
    $(this).css('background-color','#FFFFCC');
    setTimeout(function() { $(this).fadeOut('slow').fadeIn('slow'); } , 1000); 
    setTimeout(function() { $(this).css('background-color','#FFFFFF'); } , 1000); 
}); 
```

1.  设置事件触发器

2.  设置块元素的背景颜色

3.  在 setTimeout 中使用 fadeOut 和 fadeIn 创建一点动画效果。

4.  在第二个 setTimeout 内重置默认背景颜色

    在几个浏览器中测试，效果很好。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2016-09-25T17:58:27.947

```
$("#someElement").fadeTo(3000, 0.3 ).fadeTo(3000, 1).fadeTo(3000, 0.3 ).fadeTo(3000, 1); 
```

3000 是 3 秒

从不透明度 1 逐渐衰减到 0.3，然后到 1，依此类推。

您可以堆叠更多这些。

只需要 jQuery。:)

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2016-05-20T11:04:26.690

像淡入/淡出一样，您可以使用动画 css/延迟

```
$(this).stop(true, true).animate({opacity: 0.1}, 100).delay(100).animate({opacity: 1}, 100).animate({opacity: 0.1}, 100).delay(100).animate({opacity: 1}, 100); 
```

简单灵活

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2014-05-12T05:00:10.467

不幸的是，最佳答案需要 JQuery UI。[http://api.jquery.com/animate/](http://api.jquery.com/animate/)

# 这是一个香草 JQuery 解决方案

[http://jsfiddle.net/EfKBg/](http://jsfiddle.net/EfKBg/)

### JS

```
var flash = "<div class='flash'></div>";
$(".hello").prepend(flash);
$('.flash').show().fadeOut('slow'); 
```

### CSS

```
.flash {
    background-color: yellow;
    display: none;
    position: absolute;
    width: 100%;
    height: 100%;
} 
```

### HTML

```
<div class="hello">Hello World!</div> 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2011-07-06T20:26:20.210

动画背景错误有一个解决方法。这个要点包括一个简单的突出显示方法及其使用的例子。

```
/* BEGIN jquery color */
  (function(jQuery){jQuery.each(['backgroundColor','borderBottomColor','borderLeftColor','borderRightColor','borderTopColor','color','outlineColor'],function(i,attr){jQuery.fx.step[attr]=function(fx){if(!fx.colorInit){fx.start=getColor(fx.elem,attr);fx.end=getRGB(fx.end);fx.colorInit=true;}
  fx.elem.style[attr]="rgb("+[Math.max(Math.min(parseInt((fx.pos*(fx.end[0]-fx.start[0]))+fx.start[0]),255),0),Math.max(Math.min(parseInt((fx.pos*(fx.end[1]-fx.start[1]))+fx.start[1]),255),0),Math.max(Math.min(parseInt((fx.pos*(fx.end[2]-fx.start[2]))+fx.start[2]),255),0)].join(",")+")";}});function getRGB(color){var result;if(color&&color.constructor==Array&&color.length==3)
  return color;if(result=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(color))
  return[parseInt(result[1]),parseInt(result[2]),parseInt(result[3])];if(result=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(color))
  return[parseFloat(result[1])*2.55,parseFloat(result[2])*2.55,parseFloat(result[3])*2.55];if(result=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(color))
  return[parseInt(result[1],16),parseInt(result[2],16),parseInt(result[3],16)];if(result=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(color))
  return[parseInt(result[1]+result[1],16),parseInt(result[2]+result[2],16),parseInt(result[3]+result[3],16)];if(result=/rgba\(0, 0, 0, 0\)/.exec(color))
  return colors['transparent'];return colors[jQuery.trim(color).toLowerCase()];}
  function getColor(elem,attr){var color;do{color=jQuery.curCSS(elem,attr);if(color!=''&&color!='transparent'||jQuery.nodeName(elem,"body"))
  break;attr="backgroundColor";}while(elem=elem.parentNode);return getRGB(color);};var colors={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]};})(jQuery);
  /* END jquery color */

  /* BEGIN highlight */
  jQuery(function() {
    $.fn.highlight = function(options) {
      options = (options) ? options : {start_color:"#ff0",end_color:"#fff",delay:1500};
      $(this).each(function() {
        $(this).stop().css({"background-color":options.start_color}).animate({"background-color":options.end_color},options.delay);
      });
    }
  });
  /* END highlight */

  /* BEGIN highlight example */
  $(".some-elements").highlight();
  /* END highlight example */ 
```

[https://gist.github.com/1068231](https://gist.github.com/1068231)

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2015-02-22T14:10:51.500

这足够通用，您可以编写任何您喜欢的动画代码。您甚至可以将延迟从 300 毫秒减少到 33 毫秒并淡化颜色等。

```
// Flash linked to hash.
var hash = location.hash.substr(1);
if (hash) {
    hash = $("#" + hash);
    var color = hash.css("color"), count = 1;
    function hashFade () {
        if (++count < 7) setTimeout(hashFade, 300);
        hash.css("color", count % 2 ? color : "red");
    }
    hashFade();
} 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2014-04-08T22:15:37.757

这将脉动元素的背景颜色，直到触发鼠标悬停事件

```
$.fn.pulseNotify = function(color, duration) {

var This = $(this);
console.log(This);

var pulseColor = color || "#337";
var pulseTime = duration || 3000;
var origBg = This.css("background-color");
var stop = false;

This.bind('mouseover.flashPulse', function() {
    stop = true;
    This.stop();
    This.unbind('mouseover.flashPulse');
    This.css('background-color', origBg);
})

function loop() {
    console.log(This);
    if( !stop ) {
        This.animate({backgroundColor: pulseColor}, pulseTime/3, function(){
            This.animate({backgroundColor: origBg}, (pulseTime/3)*2, 'easeInCirc', loop);
        });
    }
}

loop();

return This;
} 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2015-02-06T08:43:10.653

只需给 elem.fadeOut(10).fadeIn(10);

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2014-07-09T14:02:01.053

将以上所有内容放在一起-闪烁元素并返回原始bgcolor的简单解决方案...

```
$.fn.flash = function (highlightColor, duration, iterations) {
    var highlightBg = highlightColor || "#FFFF9C";
    var animateMs = duration || 1500;
    var originalBg = this.css('backgroundColor');
    var flashString = 'this';
    for (var i = 0; i < iterations; i++) {
        flashString = flashString + '.animate({ backgroundColor: highlightBg }, animateMs).animate({ backgroundColor: originalBg }, animateMs)';
    }
    eval(flashString);
} 
```

像这样使用：

```
$('<some element>').flash('#ffffc0', 1000, 3); 
```

希望这可以帮助！

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2011-12-23T22:49:27.977

这是 colbeerhey 解决方案的略微改进版本。我添加了一个 return 语句，以便在真正的 jQuery 形式中，我们在调用动画后链接事件。我还添加了参数以清除队列并跳转到动画的末尾。

```
// Adds a highlight effect
$.fn.animateHighlight = function(highlightColor, duration) {
    var highlightBg = highlightColor || "#FFFF9C";
    var animateMs = duration || 1500;
    this.stop(true,true);
    var originalBg = this.css("backgroundColor");
    return this.css("background-color", highlightBg).animate({backgroundColor: originalBg}, animateMs);
}; 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2015-01-05T03:08:46.157

Here's a solution that uses a mix of jQuery and CSS3 animations.

[http://jsfiddle.net/padfv0u9/2/](http://jsfiddle.net/padfv0u9/2/)

Essentially you start by changing the color to your "flash" color, and then use a CSS3 animation to let the color fade out. You need to change the transition duration in order for the initial "flash" to be faster than the fade.

```
$(element).removeClass("transition-duration-medium");
$(element).addClass("transition-duration-instant");
$(element).addClass("ko-flash");
setTimeout(function () {
    $(element).removeClass("transition-duration-instant");
    $(element).addClass("transition-duration-medium");
    $(element).removeClass("ko-flash");
}, 500); 
```

Where the CSS classes are as follows.

```
.ko-flash {
    background-color: yellow;
}
.transition-duration-instant {
    -webkit-transition-duration: 0s;
    -moz-transition-duration: 0s;
    -o-transition-duration: 0s;
    transition-duration: 0s;
}
.transition-duration-medium {
    -webkit-transition-duration: 1s;
    -moz-transition-duration: 1s;
    -o-transition-duration: 1s;
    transition-duration: 1s;
} 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2017-01-16T10:38:24.757

您可以使用 jquery Pulsate 插件强制将注意力集中在任何 html 元素上，并控制速度、重复和颜色。

[JQuery.pulsate()](https://kilianvalkhof.com/jquerypulsate) ^(** 带演示*)

示例初始化程序：

*   $(".pulse4").pulsate({speed:2500})
*   $(".CommandBox button:visible").pulsate({ color: "#f00", speed: 200,reach: 85, repeat: 15 })

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2011-09-21T14:17:41.630

我正在使用这个。虽然尚未在所有浏览器上进行测试。只需按照您喜欢的方式修改即可，

用法：`hlight($("#mydiv"));`

```
function hlight(elementid){
    var hlight= "#fe1414"; //set the hightlight color
    var aspeed= 2000; //set animation speed
    var orig= "#ffffff"; // set default background color
    elementid.stop().css("background-color", hlight).animate({backgroundColor: orig}, aspeed);
} 
```

注意：您需要在标题中添加一个 jquery UI。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2014-10-08T23:51:00.243

最好的方法就是这样简单：

```
<script>

setInterval(function(){

    $(".flash-it").toggleClass("hide");

},700)
</script> 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2015-02-03T11:25:45.447

使用 jQuery 1.10.2，这会触发两次下拉菜单并将文本更改为错误。它还存储已更改属性的值以恢复它们。

```
// shows the user an error has occurred
$("#myDropdown").fadeOut(700, function(){
    var text = $(this).find("option:selected").text();
    var background = $(this).css( "background" );

    $(this).css('background', 'red');
    $(this).find("option:selected").text("Error Occurred");

        $(this).fadeIn(700, function(){
            $(this).fadeOut(700, function(){
                $(this).fadeIn(700, function(){
                    $(this).fadeOut(700, function(){

                        $(this).find("option:selected").text(text);
                        $(this).css("background", background);
                        $(this).fadeIn(700);
                    })
                })
            })
        })
}); 
```

通过回调完成 - 确保没有错过任何动画。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2015-02-06T20:26:50.887

创建两个类，给每个类一个背景颜色：

```
.flash{
 background: yellow;
}

.noflash{
 background: white;
} 
```

使用以下类之一创建一个 div：

```
<div class="noflash"></div> 
```

以下函数将切换类并使其看起来正在闪烁：

```
var i = 0, howManyTimes = 7;
function flashingDiv() {
    $('.flash').toggleClass("noFlash")
    i++;
    if( i <= howManyTimes ){
        setTimeout( f, 200 );
    }
}
f(); 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2013-08-22T14:27:36.980

此功能使其闪烁。它必须使用 cssHooks，因为**背景颜色**函数的 rgb 默认返回。

希望能帮助到你！

```
$.cssHooks.backgroundColor = {
get: function(elem) {
    if (elem.currentStyle)
        var bg = elem.currentStyle["backgroundColor"];
    else if (window.getComputedStyle)
        var bg = document.defaultView.getComputedStyle(elem,
            null).getPropertyValue("background-color");
    if (bg.search("rgb") == -1)
        return bg;
    else {
        bg = bg.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
        function hex(x) {
            return ("0" + parseInt(x).toString(16)).slice(-2);
        }
        return "#" + hex(bg[1]) + hex(bg[2]) + hex(bg[3]);
    }
}
}
function blink(element,blinkTimes,color,originalColor){
    var changeToColor;
    if(blinkTimes === null || blinkTimes === undefined)
        blinkTimes = 1;
    if(!originalColor || originalColor === null || originalColor === undefined)
        originalColor = $(element).css("backgroundColor");
    if(!color || color === null || color === undefined)
        color = "#ffffdf";
    if($(element).css("backgroundColor") == color){
        changeToColor = originalColor;
    }else{
        changeToColor = color;
        --blinkTimes;
    }
    if(blinkTimes >= 0){
        $(element).animate({
            "background-color": changeToColor,
        }, {
            duration: 500,
            complete: function() {
                blink(element, blinkTimes, color, originalColor);
                return true;
            }
        });
    }else{
        $(element).removeAttr("style");
    }
    return true;
} 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2020-01-01T06:53:09.317

您可以使用此代码 :) 更改 mili 值以更改动画速度

```
var mili = 300
for (var i = 2; i < 8; i++) {
   if (i % 2 == 0) {
      $("#lblTransferCount").fadeOut(mili)
   } else {
      $("#lblTransferCount").fadeIn(mili)
   }
} 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2019-09-25T14:52:10.233

直接jquery，没有插件。它闪烁指定的次数，在闪烁时更改背景颜色，然后将其更改回来。

```
function blink(target, count, blinkspeed, bc) {
    let promises=[];
    const b=target.css(`background-color`);
    target.css(`background-color`, bc||b);
    for (i=1; i<count; i++) {
            const blink = target.fadeTo(blinkspeed||100, .3).fadeTo(blinkspeed||100, 1.0);
            promises.push(blink);
    }
    // wait for all the blinking to finish before changing the background color back
    $.when.apply(null, promises).done(function() {
            target.css(`background-color`, b);
    });
    promises=undefined;
} 
```

例子：

```
blink($(`.alert-danger`), 5, 200, `yellow`); 
```

* * *

## 回答 #38

> 赞同：-1
> 
> 时间：2015-02-15T15:47:47.907

您可以使用这个很酷的库对您的元素制作任何类型的动画效果：http: [//daneden.github.io/animate.css/](http://daneden.github.io/animate.css/)

# java - 如何计算字符串中字符的出现次数？

> ID：275944
> 
> 赞同：595
> 
> 时间：2008-11-09T14:07:09.060
> 
> 标签：java, string

我有字符串

```
a.b.c.d 
```

我想计算 '.' 的出现次数。以惯用的方式，最好是单行。

（以前我将此约束表示为“没有循环”，以防您想知道为什么每个人都试图在不使用循环的情况下回答）。

* * *

## 回答 #1

> 赞同：1090
> 
> 时间：2012-01-18T13:17:41.647

这个怎么样。它在下面不使用正则表达式，因此应该比其他一些解决方案更快，并且不会使用循环。

```
int count = line.length() - line.replace(".", "").length(); 
```

* * *

## 回答 #2

> 赞同：764
> 
> 时间：2009-11-29T22:23:07.673

我的“惯用单行”是：

```
int count = StringUtils.countMatches("a.b.c.d", "."); 
```

当它已经在[commons lang](http://commons.apache.org/lang/)时，为什么要自己写呢？

Spring Framework 的 oneliner 是：

```
int occurance = StringUtils.countOccurrencesOf("a.b.c.d", "."); 
```

* * *

## 回答 #3

> 赞同：310
> 
> 时间：2016-02-06T15:40:59.177

总结其他答案以及我所知道的使用单线的所有方法：

```
 String testString = "a.b.c.d"; 
```

1) 使用**Apache Commons**

```
int apache = StringUtils.countMatches(testString, ".");
System.out.println("apache = " + apache); 
```

2) 使用**Spring 框架的**

```
int spring = org.springframework.util.StringUtils.countOccurrencesOf(testString, ".");
System.out.println("spring = " + spring); 
```

3）使用**替换**

```
int replace = testString.length() - testString.replace(".", "").length();
System.out.println("replace = " + replace); 
```

4）使用**replaceAll**（案例1）

```
int replaceAll = testString.replaceAll("[^.]", "").length();
System.out.println("replaceAll = " + replaceAll); 
```

5）使用**replaceAll**（案例2）

```
int replaceAllCase2 = testString.length() - testString.replaceAll("\\.", "").length();
System.out.println("replaceAll (second case) = " + replaceAllCase2); 
```

6）使用**拆分**

```
int split = testString.split("\\.",-1).length-1;
System.out.println("split = " + split); 
```

7）使用**Java8**（案例1）

```
long java8 = testString.chars().filter(ch -> ch =='.').count();
System.out.println("java8 = " + java8); 
```

8) 使用**Java8**（案例 2），对于 unicode 可能比案例 1 更好

```
long java8Case2 = testString.codePoints().filter(ch -> ch =='.').count();
System.out.println("java8 (second case) = " + java8Case2); 
```

9) 使用**StringTokenizer**

```
int stringTokenizer = new StringTokenizer(" " +testString + " ", ".").countTokens()-1;
System.out.println("stringTokenizer = " + stringTokenizer); 
```

**来自评论**：小心 StringTokenizer，对于 abcd 它会起作用，但对于 a...bc...d 或 ...abcd 或 a....b......c.....d ...或等它不起作用。它只是算数。字符之间只有一次

更多信息在[github](https://github.com/Vedenin/useful-java-links/blob/master/helloworlds/5.0-other-examples/src/main/java/other_examples/FindCountOfOccurrencesBenchmark.java)

[性能测试](https://github.com/Vedenin/useful-java-links/blob/master/helloworlds/5.0-other-examples/src/main/java/other_examples/FindCountOfOccurrencesBenchmark.java)（使用[JMH](http://openjdk.java.net/projects/code-tools/jmh/)，mode = AverageTime，得分高于`0.010`）`0.351`：

```
Benchmark              Mode  Cnt  Score    Error  Units
1\. countMatches        avgt    5  0.010 ±  0.001  us/op
2\. countOccurrencesOf  avgt    5  0.010 ±  0.001  us/op
3\. stringTokenizer     avgt    5  0.028 ±  0.002  us/op
4\. java8_1             avgt    5  0.077 ±  0.005  us/op
5\. java8_2             avgt    5  0.078 ±  0.003  us/op
6\. split               avgt    5  0.137 ±  0.009  us/op
7\. replaceAll_2        avgt    5  0.302 ±  0.047  us/op
8\. replace             avgt    5  0.303 ±  0.034  us/op
9\. replaceAll_1        avgt    5  0.351 ±  0.045  us/op 
```

* * *

## 回答 #4

> 赞同：181
> 
> 时间：2008-11-09T14:38:20.027

迟早，*有些事情*必须循环。编写（非常简单的）循环比使用`split`比你需要的更强大的东西要简单得多。

无论如何将循环封装在一个单独的方法中，例如

```
public static int countOccurrences(String haystack, char needle)
{
    int count = 0;
    for (int i=0; i < haystack.length(); i++)
    {
        if (haystack.charAt(i) == needle)
        {
             count++;
        }
    }
    return count;
} 
```

然后你不需要在你的主代码中有循环 - 但循环必须在某个地方。

* * *

## 回答 #5

> 赞同：62
> 
> 时间：2008-11-09T16:16:47.287

我有一个类似于姆拉登的想法，但恰恰相反......

```
String s = "a.b.c.d";
int charCount = s.replaceAll("[^.]", "").length();
println(charCount); 
```

* * *

## 回答 #6

> 赞同：37
> 
> 时间：2008-11-09T14:48:32.333

```
String s = "a.b.c.d";
int charCount = s.length() - s.replaceAll("\\.", "").length(); 
```

ReplaceAll(".") 将替换所有字符。

[PhiLho 的解决方案](https://stackoverflow.com/questions/275944/how-do-i-count-the-number-of-occurrences-of-a-char-in-a-string#276062)使用 ReplaceAll("[^.]","")，不需要转义，因为 [.] 表示字符“点”，而不是“任何字符”。

* * *

## 回答 #7

> 赞同：31
> 
> 时间：2013-10-11T09:46:21.123

```
String s = "a.b.c.d";
long result = s.chars().filter(ch -> ch == '.').count(); 
```

* * *

## 回答 #8

> 赞同：31
> 
> 时间：2013-11-13T19:30:51.113

我的“惯用单线”解决方案：

```
int count = "a.b.c.d".length() - "a.b.c.d".replace(".", "").length(); 
```

不知道为什么接受使用 StringUtils 的解决方案。

* * *

## 回答 #9

> 赞同：26
> 
> 时间：2009-11-29T13:40:01.590

一个较短的例子是

```
String text = "a.b.c.d";
int count = text.split("\\.",-1).length-1; 
```

* * *

## 回答 #10

> 赞同：18
> 
> 时间：2008-11-09T14:46:28.187

这是一个没有循环的解决方案：

```
public static int countOccurrences(String haystack, char needle, int i){
    return ((i=haystack.indexOf(needle, i)) == -1)?0:1+countOccurrences(haystack, needle, i+1);}

System.out.println("num of dots is "+countOccurrences("a.b.c.d",'.',0)); 
```

好吧，有一个循环，但它是**不可见**的:-)

——约纳坦

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2013-04-16T09:50:00.677

我不喜欢为此目的分配一个新字符串的想法。由于字符串后面已经有一个 char 数组来存储它的值，因此 String.charAt() 实际上是免费的。

```
for(int i=0;i<s.length();num+=(s.charAt(i++)==delim?1:0)) 
```

没有额外的需要收集的分配，在 1 行或更少的代码中，只使用 J2SE。

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2008-11-09T18:06:24.320

好的，受 Yonatan 解决方案的启发，这是一个*纯*递归的解决方案 - 使用的唯一库方法是`length()`and `charAt()`，它们都不做任何循环：

```
public static int countOccurrences(String haystack, char needle)
{
    return countOccurrences(haystack, needle, 0);
}

private static int countOccurrences(String haystack, char needle, int index)
{
    if (index >= haystack.length())
    {
        return 0;
    }

    int contribution = haystack.charAt(index) == needle ? 1 : 0;
    return contribution + countOccurrences(haystack, needle, index+1);
} 
```

递归是否算作循环取决于您使用的确切定义，但它可能与您得到的一样接近。

我不知道这些天大多数 JVM 是否会进行尾递归……如果不是，那么当然，对于适当的长字符串，你会得到同名的堆栈溢出。

* * *

## 回答 #13

> 赞同：12
> 
> 时间：2008-11-11T14:20:02.997

受到 Jon Skeet 的启发，这是一个不会破坏你的堆栈的非循环版本。如果您想使用 fork-join 框架，这也是有用的起点。

```
public static int countOccurrences(CharSequeunce haystack, char needle) {
    return countOccurrences(haystack, needle, 0, haystack.length);
}

// Alternatively String.substring/subsequence use to be relatively efficient
//   on most Java library implementations, but isn't any more [2013].
private static int countOccurrences(
    CharSequence haystack, char needle, int start, int end
) {
    if (start == end) {
        return 0;
    } else if (start+1 == end) {
        return haystack.charAt(start) == needle ? 1 : 0;
    } else {
        int mid = (end+start)>>>1; // Watch for integer overflow...
        return
            countOccurrences(haystack, needle, start, mid) +
            countOccurrences(haystack, needle, mid, end);
    }
} 
```

（免责声明：未经测试，未经编译，不明智。）

也许是最好的（单线程，不支持代理对）编写方法：

```
public static int countOccurrences(String haystack, char needle) {
    int count = 0;
    for (char c : haystack.toCharArray()) {
        if (c == needle) {
           ++count;
        }
    }
    return count;
} 
```

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2013-01-11T14:23:42.753

不确定这样做的效率，但这是我在不引入 3rd 方库的情况下可以编写的最短代码：

```
public static int numberOf(String target, String content)
{
    return (content.split(target).length - 1);
} 
```

* * *

## 回答 #15

> 赞同：10
> 
> 时间：2014-05-26T16:39:49.300

使用[java-8](/questions/tagged/java-8 "显示标记为“java-8”的问题")，您还可以使用流来实现这一点。显然在幕后有一个迭代，但你不必明确地写出来！

```
public static long countOccurences(String s, char c){
    return s.chars().filter(ch -> ch == c).count();
}

countOccurences("a.b.c.d", '.'); //3
countOccurences("hello world", 'l'); //3 
```

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2017-05-24T14:05:59.607

也可以在 Java 8 中使用 reduce 来解决这个问题：

```
int res = "abdsd3$asda$asasdd$sadas".chars().reduce(0, (a, c) -> a + (c == '$' ? 1 : 0));
System.out.println(res); 
```

输出：

```
3 
```

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2017-05-17T09:14:13.653

获得答案的最简单方法如下：

```
public static void main(String[] args) {
    String string = "a.b.c.d";
    String []splitArray = string.split("\\.",-1);
    System.out.println("No of . chars is : " + (splitArray.length-1));
} 
```

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2012-03-03T17:54:04.373

**完整样本：**

```
public class CharacterCounter
{

  public static int countOccurrences(String find, String string)
  {
    int count = 0;
    int indexOf = 0;

    while (indexOf > -1)
    {
      indexOf = string.indexOf(find, indexOf + 1);
      if (indexOf > -1)
        count++;
    }

    return count;
  }
} 
```

**称呼：**

```
int occurrences = CharacterCounter.countOccurrences("l", "Hello World.");
System.out.println(occurrences); // 3 
```

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2011-02-24T11:21:05.877

如果您使用的是 Spring 框架，您还可以使用“StringUtils”类。该方法将是“countOccurrencesOf”。

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2016-05-19T07:59:34.283

`split()`只需一行代码即可使用该功能

```
int noOccurence=string.split("#",-1).length-1; 
```

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2019-12-14T05:16:12.497

一个更简单的解决方案是根据您匹配的字符拆分字符串。

例如，

`int getOccurences(String characters, String string) { String[] words = string.split(characters); return words.length - 1; }`

这将在以下情况下返回 4： `getOccurences("o", "something about a quick brown fox");`

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2011-06-07T15:29:46.490

```
public static int countOccurrences(String container, String content){
    int lastIndex, currIndex = 0, occurrences = 0;
    while(true) {
        lastIndex = container.indexOf(content, currIndex);
        if(lastIndex == -1) {
            break;
        }
        currIndex = lastIndex + content.length();
        occurrences++;
    }
    return occurrences;
} 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2008-11-09T18:19:50.160

虽然方法可以隐藏它，但没有循环（或递归）就无法计数。不过，出于性能原因，您想使用 char[] 。

```
public static int count( final String s, final char c ) {
  final char[] chars = s.toCharArray();
  int count = 0;
  for(int i=0; i<chars.length; i++) {
    if (chars[i] == c) {
      count++;
    }
  }
  return count;
} 
```

使用 replaceAll（即 RE）听起来并不是最好的方法。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2012-11-14T23:11:38.223

```
import java.util.Scanner;

class apples {

    public static void main(String args[]) {    
        Scanner bucky = new Scanner(System.in);
        String hello = bucky.nextLine();
        int charCount = hello.length() - hello.replaceAll("e", "").length();
        System.out.println(charCount);
    }
}//      COUNTS NUMBER OF "e" CHAR´s within any string input 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2016-01-14T23:49:55.967

好吧，通过一项非常相似的任务，我偶然发现了这个线程。我没有看到任何编程语言限制，因为 groovy 在 java vm 上运行：这是我如何使用 Groovy 解决问题的方法。

```
"a.b.c.".count(".") 
```

完毕。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2017-06-23T05:40:05.873

使用[Eclipse 集合](https://www.eclipse.org/collections/)

```
int count = Strings.asChars("a.b.c.d").count(c -> c == '.'); 
```

如果要计算多个字符，可以`CharBag`按如下方式使用 a：

```
CharBag bag = Strings.asChars("a.b.c.d").toBag();
int count = bag.occurrencesOf('.'); 
```

注意：我是 Eclipse Collections 的提交者。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2008-11-11T14:39:57.123

在代码的某处，必须循环一些东西。解决这个问题的唯一方法是完全展开循环：

```
int numDots = 0;
if (s.charAt(0) == '.') {
    numDots++;
}

if (s.charAt(1) == '.') {
    numDots++;
}

if (s.charAt(2) == '.') {
    numDots++;
} 
```

...等等，但是您是在源代码编辑器中手动执行循环的人 - 而不是将运行它的计算机。见伪代码：

```
create a project
position = 0
while (not end of string) {
    write check for character at position "position" (see above)
}
write code to output variable "numDots"
compile program
hand in homework
do not think of the loop that your "if"s may have been optimized and compiled to 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2009-03-20T11:25:18.847

这是一个稍微不同的风格递归解决方案：

```
public static int countOccurrences(String haystack, char needle)
{
    return countOccurrences(haystack, needle, 0);
}

private static int countOccurrences(String haystack, char needle, int accumulator)
{
    if (haystack.length() == 0) return accumulator;
    return countOccurrences(haystack.substring(1), needle, haystack.charAt(0) == needle ? accumulator + 1 : accumulator);
} 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2011-04-28T04:59:44.277

为什么不只拆分字符然后获取结果数组的长度。数组长度将始终是实例数 + 1。对吗？

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2013-05-02T10:56:32.037

以下源代码将为您提供用户输入的单词中给定字符串的出现次数：-

```
import java.util.Scanner;

public class CountingOccurences {

    public static void main(String[] args) {

        Scanner inp= new Scanner(System.in);
        String str;
        char ch;
        int count=0;

        System.out.println("Enter the string:");
        str=inp.nextLine();

        while(str.length()>0)
        {
            ch=str.charAt(0);
            int i=0;

            while(str.charAt(i)==ch)
            {
                count =count+i;
                i++;
            }

            str.substring(count);
            System.out.println(ch);
            System.out.println(count);
        }

    }
} 
```

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2014-05-07T12:03:51.547

```
int count = (line.length() - line.replace("str", "").length())/"str".length(); 
```

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2013-07-10T08:59:01.077

```
 public static int countSubstring(String subStr, String str) {

    int count = 0;
    for (int i = 0; i < str.length(); i++) {
        if (str.substring(i).startsWith(subStr)) {
            count++;
        }
    }
    return count;
} 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2013-09-05T16:06:34.433

你为什么要避免循环？我的意思是你不能在不检查字符串的每个字符的情况下计算“numberOf”点，如果你调用任何函数，它会以某种方式循环。也就是说，String.replace 应该循环验证字符串是否出现，以便它可以替换每一次出现。

如果你想减少资源使用，你不会那样做，因为你正在创建一个新的 String 只是为了计算点数。

现在如果我们谈论递归的“在这里输入代码”方法，有人说它会由于OutOfMemmoryException而失败，我想他忘记了StackOverflowException。

所以我的方法是这样的（我知道它和其他方法一样，但是这个问题需要循环）：

```
public static int numberOf(String str,int c) {
    int res=0;
    if(str==null)
        return res;
    for(int i=0;i<str.length();i++)
        if(c==str.charAt(i))
            res++;
    return res;
} 
```

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2014-08-30T16:59:49.943

我看到很多技巧等被使用。现在我不反对漂亮的技巧，但我个人喜欢简单地调用*旨在*完成工作的方法，所以我创建了另一个答案。

请注意，如果性能有任何问题，请改用[Jon Skeet 的答案](https://stackoverflow.com/a/275969/589259)。这个更通用，因此在我看来更具可读性（当然，可重复用于字符串和模式）。

```
public static int countOccurances(char c, String input) {
    return countOccurancesOfPattern(Pattern.quote(Character.toString(c)), input);
}

public static int countOccurances(String s, String input) {
    return countOccurancesOfPattern(Pattern.quote(s), input);
}

public static int countOccurancesOfPattern(String pattern, String input) {
    Matcher m = Pattern.compile(pattern).matcher(input);
    int count = 0;
    while (m.find()) {
        count++;
    }
    return count;
} 
```

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2020-06-22T12:20:11.967

这是我用来计算字符串出现次数的方法。

希望有人觉得它有帮助。

```
 private long countOccurrences(String occurrences, char findChar){
        return  occurrences.chars().filter( x -> {
            return x == findChar;
        }).count();
    } 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2010-08-04T18:06:09.343

试试这个方法：

```
StringTokenizer stOR = new StringTokenizer(someExpression, "||");
int orCount = stOR.countTokens()-1; 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2014-05-30T20:05:41.563

下面的递归算法呢？这也是线性时间。

```
import java.lang.*;
import java.util.*;

class longestSubstr{

public static void main(String[] args){
   String s="ABDEFGABEF";

   int ans=calc(s);

   System.out.println("Max nonrepeating seq= "+ans);

}

public static int calc(String s)
{//s.s
      int n=s.length();
      int max=1;
      if(n==1)
          return 1;
      if(n==2)
      {
          if(s.charAt(0)==s.charAt(1)) return 1;
          else return 2;

      }
      String s1=s;
    String a=s.charAt(n-1)+"";
          s1=s1.replace(a,"");
         // System.out.println(s+" "+(n-2)+" "+s.substring(0,n-1));
         max=Math.max(calc(s.substring(0,n-1)),(calc(s1)+1));

return max;
}

}

</i> 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2015-08-30T07:02:17.927

试试这个代码：

```
package com.java.test;

import java.util.HashMap;
import java.util.Map;

public class TestCuntstring {

    public static void main(String[] args) {

        String name = "Bissssmmayaa";
        char[] ar = new char[name.length()];
        for (int i = 0; i < name.length(); i++) {
            ar[i] = name.charAt(i);
        }
        Map<Character, String> map=new HashMap<Character, String>();
        for (int i = 0; i < ar.length; i++) {
            int count=0;
            for (int j = 0; j < ar.length; j++) {
                if(ar[i]==ar[j]){
                    count++;
                }
            }
            map.put(ar[i], count+" no of times");
        }
        System.out.println(map);
    }

} 
```

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2017-04-26T07:25:58.683

如果你想数数。字符串“SELENIUM”中的相同字符，或者您想打印字符串“SELENIUM”的唯一字符。

```
public class Count_Characters_In_String{

     public static void main(String []args){

        String s = "SELENIUM";
        System.out.println(s);
        int counter;

       String g = "";

        for( int i=0; i<s.length(); i++ ) { 

        if(g.indexOf(s.charAt(i)) == - 1){
           g=g+s.charAt(i); 
          }

       }
       System.out.println(g + " ");

        for( int i=0; i<g.length(); i++ ) {          
          System.out.print(",");

          System.out.print(s.charAt(i)+ " : ");
          counter=0; 
          for( int j=0; j<s.length(); j++ ) { 

        if( g.charAt(i) == s.charAt(j) ) {
           counter=counter+1;

           }      

          }
          System.out.print(counter); 
       }
     }
} 
```

/******************** 输出 **********************/

硒

硒

S：1，E：2，L：1，E：1，N：1，I：1，U：1

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2017-07-29T19:07:44.833

```
String[] parts = text.split(".");
int occurances = parts.length - 1;

" It's a great day at O.S.G. Dallas! "
     -- Famous Last Words 
```

嗯，这是一个了解您的 Java 的案例，尤其是您对 Java 中已经可用的集合类的基本了解。如果你看一下这里的整个帖子，除了斯蒂芬霍金对宇宙起源的解释、达尔文关于进化的平装书和吉恩罗登伯里的星际迷航演员选择之外，几乎所有内容都没有，关于他们为什么选择威廉沙特纳而没有怎么做这又快又容易...

……还需要我说吗？

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2019-08-22T10:11:53.197

使用没有任何库的 Java 8 和 HashMap 来计算所有不同的字符：

```
private static void countChars(String string) {
    HashMap<Integer, Integer> hm = new HashMap<Integer, Integer>();
    string.chars().forEach(letter -> hm.put(letter, (hm.containsKey(letter) ? hm.get(letter) : 0) + 1));
    hm.forEach((c, i) -> System.out.println(((char)c.intValue()) + ":" + i));
} 
```

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2019-10-02T23:28:15.803

*使用 lambda 函数删除所有字符来计算*
计数是前长度和后长度的差

```
String s = "a.b.c.d";
int count = s.length() - deleteChars.apply( s, "." ).length();  // 3 
```

[在这里找到 deleteChars](https://stackoverflow.com/questions/4576352/remove-all-occurrences-of-char-from-string/56916146#56916146)

*如果您必须计算多个字符的出现次数，则可以一口气完成：*
例如。对于`b` `c`和`.`：

```
int count = s.length() - deleteChars.apply( s, "bc." ).length();  // 5 
```

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2020-11-26T16:55:14.230

 *不需要外部库*的 lambda 单线。*
创建一个包含每个字符计数的地图：* 

 *```
Map<Character,Long> counts = "a.b.c.d".codePoints().boxed().collect(
    groupingBy( t -> (char)(int)t, counting() ) ); 
```

获取：`{a=1, b=1, c=1, d=1, .=3}`
某个字符的计数，例如。`'.'`被放弃：
`counts.get( '.' )`

*（出于病态的好奇心，我还写了一个 lambda 解决方案，以了解我的解决方案有多慢，最好来自具有 10 行解决方案的人。）*

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2021-04-09T18:26:09.377

这里最简单易懂，不用数组，只用Hashmap。它还将计算空格、大写字符和小字符的数量、特殊字符等。

```
import java.util.HashMap;
  //The code by muralidharan  
    public class FindChars {

        public static void main(String[] args) {

            findchars("rererereerererererererere");
        }

        public static void findchars(String s){

            HashMap<Character,Integer> k=new HashMap<Character,Integer>();
            for(int i=0;i<s.length();i++){
                if(k.containsKey(s.charAt(i))){
                Integer v =k.get(s.charAt(i));
                k.put(s.charAt(i), v+1);
                }else{
                    k.put(s.charAt(i), 1);
                }

            }
            System.out.println(k);

        }

    } 
```

**O/P: **{r=12, e=13}****

第二个输入：

```
findchars("The world is beautiful and $#$%%%%%%@@@@ is worst"); 
```

**O/P: **{ =7, @=4, a=2, b=1, #=1, d=2, $=2, e=2, %=6, f=1, h=1, i= 3, l=2, n=1, o=2, r=2, s=3, T=1, t=2, u=2, w=2}****

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2021-08-28T17:38:58.470

```
 public static String encodeMap(String plainText){

        Map<Character,Integer> mapResult=new LinkedHashMap<Character,Integer>();
        String result = "";
        for(int i=0;i<plainText.length();i++){
            if(mapResult.containsKey(plainText.charAt(i))){
            Integer v =mapResult.get(plainText.charAt(i));
            mapResult.put(plainText.charAt(i), v+1);
            }else{
                mapResult.put(plainText.charAt(i), 1);
            }
        }

        for(Map.Entry<Character, Integer> t : mapResult.entrySet()) {
            result += String.valueOf(t.getKey())+t.getValue();
        }

        return result;

    }

 public static void main(String args[]) {
        String  plainText = "aaavvfff";
        System.out.println(encodeMap(plainText)); //a3v2f3  
    } 
```

* * *

## 回答 #46

> 赞同：-1
> 
> 时间：2018-08-01T19:22:34.700

```
public static void getCharacter(String str){

        int count[]= new int[256];

        for(int i=0;i<str.length(); i++){

            count[str.charAt(i)]++;

        }
        System.out.println("The ascii values are:"+ Arrays.toString(count));

        //Now display wht character is repeated how many times

        for (int i = 0; i < count.length; i++) {
            if (count[i] > 0)
               System.out.println("Number of " + (char) i + ": " + count[i]);
        }

    }
} 
```

* * *

## 回答 #47

> 赞同：-3
> 
> 时间：2014-11-21T11:06:04.300

```
public class OccurencesInString { public static void main(String[] args) { String str = "NARENDRA AMILINENI"; HashMap occur = new HashMap(); int count =0; String key = null; for(int i=0;i<str.length()-1;i++){ key = String.valueOf(str.charAt(i)); if(occur.containsKey(key)){ count = (Integer)occur.get(key); occur.put(key,++count); }else{ occur.put(key,1); } } System.out.println(occur); } } 
```

* * *

## 回答 #48

> 赞同：-5
> 
> 时间：2015-03-19T17:07:23.390

我试图用 switch 语句解决你的问题，但我仍然需要一个 for 循环来解析字符串。如果我可以改进代码，请随时发表评论

```
public class CharacterCount {
public static void main(String args[])
{
    String message="hello how are you";
    char[] array=message.toCharArray();
    int a=0;
    int b=0;
    int c=0;
    int d=0;
    int e=0;
    int f=0;
    int g=0;
    int h=0;
    int i=0;
    int space=0;
    int j=0;
    int k=0;
    int l=0;
    int m=0;
    int n=0;
    int o=0;
    int p=0;
    int q=0;
    int r=0;
    int s=0;
    int t=0;
    int u=0;
    int v=0;
    int w=0;
    int x=0;
    int y=0;
    int z=0;

    for(char element:array)
    {
        switch(element)
        {
        case 'a':
        a++;
        break;
        case 'b':
        b++;
        break;
        case 'c':c++;
        break;

        case 'd':d++;
        break;
        case 'e':e++;
        break;
        case 'f':f++;
        break;

        case 'g':g++;
        break;
        case 'h':
        h++;
        break;
        case 'i':i++;
        break;
        case 'j':j++;
        break;
        case 'k':k++;
        break;
        case 'l':l++;
        break;
        case 'm':m++;
        break;
        case 'n':m++;
        break;
        case 'o':o++;
        break;
        case 'p':p++;
        break;
        case 'q':q++;
        break;
        case 'r':r++;
        break;
        case 's':s++;
        break;
        case 't':t++;
        break;
        case 'u':u++;
        break;
        case 'v':v++;
        break;
        case 'w':w++;
        break;
        case 'x':x++;
        break;
        case 'y':y++;
        break;
        case 'z':z++;
        break;
        case ' ':space++;
        break;
        default :break;
        }
    }
    System.out.println("A "+a+" B "+ b +" C "+c+" D "+d+" E "+e+" F "+f+" G "+g+" H "+h);
    System.out.println("I "+i+" J "+j+" K "+k+" L "+l+" M "+m+" N "+n+" O "+o+" P "+p);
    System.out.println("Q "+q+" R "+r+" S "+s+" T "+t+" U "+u+" V "+v+" W "+w+" X "+x+" Y "+y+" Z "+z);
    System.out.println("SPACE "+space);
} 
```

}

# c - 夏令时规则更改是否使 C 运行时库无效？

> ID：275952
> 
> 赞同：3
> 
> 时间：2008-11-09T14:14:14.273
> 
> 标签：c, datetime, dst

前段时间，我整理了一个基于**时间**的库，可用于计算某人一年内的相对时间。我当时注意到，它在两个方向都做了一小时的轮班，以实现夏令时。我突然想到[国会改变了夏令时规则](http://aa.usno.navy.mil/faq/docs/daylight_time.php)。我不记得看到任何有关更新以解决算法更改的信息。有没有人有关于这个话题的任何信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T16:02:37.127

大多数类 Unix 系统使用 Olson tz 数据库来获取其时区信息：

[http://www.twinsun.com/tz/tz-link.htm](http://www.twinsun.com/tz/tz-link.htm)

美国时区规则的更改在 tz 数据库的 2005l 版本中实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T14:44:03.107

对于 Visual Studio 2005 及更早版本，Microsoft 已发布 C 运行时库的更新版本。更多信息可以在[这里](http://msdn.microsoft.com/en-us/vs2005/bb264729.aspx)找到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T14:46:26.610

你在哪个平台上工作？

由于国会没有为全世界制定规则:) 长期以来一直有一种机制可以灵活地指定 Unix/Linux 上的规则

例如，请参阅[http://www.manpagez.com/man/8/zic/](http://www.manpagez.com/man/8/zic/)了解文件格式。您的特定系统可能需要新规则的更新定义（如果分发尚未处理它）

对于 Windows，MS 构建了一些规​​则并在情况发生变化时发布更新。

对于 MacO，我不知道，但我想它继承了 Unix 的做事方式。

但在所有这些情况下，都不需要更改 C 库

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T14:47:39.743

更一般地说，C 运行时确实使用内部数据文件从内部时间表示映射到用户的语言环境。这些映射由各自的供应商定期更新，以符合当前的立法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-09T15:06:12.327

由于内部时钟应设置为 UTC，因此夏令时只是更改时区的问题。例如，在我的语言环境中，10 月 26 日，我的 Mac 从 CEST（中欧夏令时间）切换到“正常”CET（中欧时间）。我的时钟显示改变了，但电脑的时间没有改变。

[http://www.timeanddate.com/library/abbreviations/timezones/eu/cest.html](http://www.timeanddate.com/library/abbreviations/timezones/eu/cest.html)

实际上，这意味着您绝对必须将日期时间变量保留为 UTC 或考虑时区的本机格式。这就是为什么将日期时间记录为“YYYYMMDDHHMMSS”字符串是一个等待发生的错误。

# c# - C# 程序能否以某种方式测量其自身的 CPU 使用率？

> ID：275957
> 
> 赞同：40
> 
> 时间：2008-11-09T14:19:49.723
> 
> 标签：c#, monitoring, cpu, performancecounter

我正在开发一个将运行很长时间的后台程序，并且我有一个外部日志记录程序（[SmartInspect](http://www.gurock.com/products/smartinspect/)），我想定期提供一些值，以便在调试时实时监控它。

我知道我可以简单地启动多个程序，例如任务管理器或 IARSN TaskInfo，但我想为此将所有内容保留在我自己的程序中，因为我还想添加一些简单的规则，例如程序是否使用超过X% CPU，在日志中标记这个。

我有一个后台线程，它会定期向 SmartInspect 提供一些统计信息，例如内存消耗、工作集等。

该线程是否有可能对它消耗的计算机 CPU 资源量进行合理准确的测量？主程序是一个单线程应用程序（除了记录统计信息的看门狗线程），因此如果一项技术仅限于*单个线程使用多少*，那也很好。

我发现了一些与Linux 和 C 的*rusage*相关的条目。我可以使用类似的东西吗？

* * *

**编辑：**好的，我尝试了性能计数器的方式，但每次调用它都会添加相当多的 GC 数据，因此内存使用和垃圾收集的图表猛增。我想我现在就把这部分放在一边。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-11-09T14:47:49.477

您还可以使用[System.Diagnostics。**Process.TotalProcessorTime**](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.totalprocessortime.aspx)和[System.Diagnostics。**ProcessThread.TotalProcessorTime**](http://msdn.microsoft.com/en-us/library/system.diagnostics.processthread.totalprocessortime.aspx)属性来计算您的处理器使用情况，如[本文](http://www.codeproject.com/KB/system/processescpuusage.aspx)所述。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-09T14:27:07.710

看看`System.Diagnostics.PerformanceCounter`。如果您运行起来`perfmon.exe`，您将看到可供您使用的性能计数器范围（将“性能对象”设置为“进程”），其中之一是“%处理器时间”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-09T14:27:11.860

您可以通过 System.Diagnostic.PerformanceCounter 类。以下是监控 CPU 使用率的示例：

[http://blogs.msdn.com/dotnetinterop/archive/2007/02/02/system-diagnostics-performancecounter-and-processor-time-on-multi-core-or-multi-cpu.aspx](http://blogs.msdn.com/dotnetinterop/archive/2007/02/02/system-diagnostics-performancecounter-and-processor-time-on-multi-core-or-multi-cpu.aspx)

请注意，这确实需要提升的权限。使用它可能会影响性能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-09T17:40:06.697

您正在登录到 smartinspect 之类的监视器，这很好。但是在这种情况下，Windows 本身会为您的程序（或进程）收集每个资源的数据。WMI 是应用程序监控的标准。我们可以查看WMI捕获的数据。许多应用程序管理、健康监控或应用程序监控工具都支持开箱即用的 WMI。

因此，我不建议您将应用程序中的 CPU 使用情况记录到日志文件中。

如果您认为可用性和性能至关重要，请选择 Microsoft Operations Manager 解决方案等解决方案。

要了解 WMI 并获取进程列表，请参见下文： -`Win32_PerfFormattedData_PerfProc_Process`要获取 Cpu 时间，过滤器是 processID [请参阅这篇文章](http://msdn.microsoft.com/en-us/library/aa394277(VS.85).aspx) - 您可以从 Win32_process 类中获取 processID。

凯文·马修·高斯 (Kevin Matthew Goss)[为 C# 简化了 WMI](http://www.csharphelp.com/archives2/archive334.html)

```
oConn.Username = "JohnDoe";
oConn.Password = "JohnsPass";

System.Management.ManagementScope oMs = new System.Management.ManagementScope("\\MachineX", oConn);    

//get Fixed disk stats
System.Management.ObjectQuery oQuery = new System.Management.ObjectQuery("select FreeSpace,Size,Name from Win32_LogicalDisk where DriveType=3");

//Execute the query 
ManagementObjectSearcher oSearcher = new ManagementObjectSearcher(oMs,oQuery);

//Get the results
ManagementObjectCollection oReturnCollection = oSearcher.Get();   

//loop through found drives and write out info
foreach( ManagementObject oReturn in oReturnCollection )
{
    // Disk name
    Console.WriteLine("Name : " + oReturn["Name"].ToString());
    // Free Space in bytes
    Console.WriteLine("FreeSpace: " + oReturn["FreeSpace"].ToString());
    // Size in bytes
    Console.WriteLine("Size: " + oReturn["Size"].ToString());
} 
```

您也可以从远程系统监控进程。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2010-05-11T10:56:40.940

这篇代码项目文章描述了如何使用高性能定时器：

[http://www.codeproject.com/KB/cs/highperformancetimercshar.aspx](http://www.codeproject.com/KB/cs/highperformancetimercshar.aspx)

您可以使用它来计时代码的执行。

在这里，您可以找到许多开源 C# 分析器：

[http://csharp-source.net/open-source/profile](http://csharp-source.net/open-source/profile)

# c++ - 在 C/C++ 中列出项目的最有效方法

> ID：275958
> 
> 赞同：3
> 
> 时间：2008-11-09T14:22:47.703
> 
> 标签：c++, c

我有一个说 100 个未分类项目的列表。每个项目都属于一个组。项目所属的组只是项目类的成员。

使用 C/C++ 我正在寻找最有效的方式来扫描项目列表，检查它们所在的组并将项目打印到屏幕上。不过，这就是问题所在。将某个组中的项目打印到屏幕上后，我不想再打印属于该组的任何项目。

我使用的是预 STL 编译器，可执行文件的大小很关键，所以我不想开始定义自己的 Hash 类。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-09T14:46:09.840

根据组值对项目进行排序（如果是*指针*，则可以使用其地址，否则按*字典顺序对**字符串*进行排序）。然后遍历该排序列表，始终获取每个组的第一项。

这大约需要

```
n + n * log(n)
```

我认为这是可执行文件大小和速度之间的合理选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T14:25:37.167

您可以创建组的字典/哈希图，并为每个组存储一个布尔值，说明该组的项目是否已打印。

示例代码：

```
#include <unordered_map>
#include <string>
#include <iostream>

std::string getGroupForNumber( int num )
{
//
}

int main()
{
    typedef std::tr1::unordered_map< std::string, bool > hashmap;
    hashmap groupsPrinted;

    for( int i = 0 ; i < 100 ; ++i ) {
        if ( groupsPrinted[ getGroupForNumber( i ) ] == false ) {
            groupsPrinted[ getGroupForNumber( i ) ] = true;
            std::cout << i << std::endl;
        }
    }
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T15:32:41.977

您确实在问题中编写了 c/c++，所以这里有一些 c 代码。有几个问题是有序的。未来某个时间组是否可以打印？项目列表是静态的吗？您打印特定组中的哪个项目是否重要？

我会建议以下构造（我对问题的理解有限）：

列表数组。

```
 typedef struct node{
    void *item; /* this is your item */
    node *next; 
  } node_t;

  typedef struct {
    node_t *my_group;
    int used;
  } group_t;

  static group_t my_items[NUM_OF_GROUPS]; /* this is your ordered by groups list.*/ 
```

更好的是，使用列表列表。group_t 将是：

```
typedef struct group{
  node_t *my_group;
  group *next_free;
} group_t; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T22:42:43.560

打印到屏幕上的成本比您可以对对象执行的任何其他操作高出几个数量级。如果您在几个组中有一个包含 1000 万个对象的数组，那么排序不是一个合理的选择。如果可以通过静态索引（即给定范围内的整数）标识组，则只需使用掩码数组来指示是否已看到它。如果组更复杂，您可以将已经看到的组存储在任何集合数据结构（散列、树等）中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-09T17:32:52.813

团体呢？你能得到一个新的组吗？打印其中一个成员后，组是否可以变得相关？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-09T15:15:52.027

如果您可以将组编号为 0..99，那么您将需要一个布尔数组，或者如果您想优化，则需要位集。将所有数组初始化为“假”。打印后设置 arr[groupId] = 'true'，下次打印前检查值。不需要 STL。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-09T15:20:03.593

保留不应再打印其项目的组名的 std::set。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-09T15:58:27.667

再回答一些问题。

> 项目列表是静态的吗？

不，它可以随时缩小或增长。

> 您打印特定组中的哪个项目是否重要？

暂时没有，没有。也许在未来，但目前打印属于唯一组的第一个项目就足够了。

# asp.net-mvc - 需要 ASP.NET MVC AutoEventWireup？

> ID：275965
> 
> 赞同：2
> 
> 时间：2008-11-09T14:29:56.270
> 
> 标签：asp.net-mvc, autoeventwireup

当我创建一个 aspx 页面时，标题包含如下内容：-

```
<%@ Page
    Language="C#" 
    MasterPageFile="~/Views/Shared/Site.Master" 
    AutoEventWireup="true" 
    CodeBehind="Create.aspx.cs" 
    Inherits="My.Mvc.Views.Blah" %> 
```

对于 ASP.NET MVC 应用程序，我们是否：

*   需要包含此 AutoEventWireUp 属性吗？
*   如果我们将其设置为 false 会发生什么？
*   这个属性到底有什么作用？它对 ASP.NET MVC 有效吗？

谢谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T14:54:09.700

您可以去掉此属性，或将其设置为 false（这是默认值）。

AutoEventWireup 意味着 ASP.NET 将在运行时使用反射在您的 Web 表单类中以 Page_EventName 的形式（如 Page_Load、Page_Init 等）查找方法，并自动将这些方法连接到相应的页面生命周期事件。我在这里有更多详细信息：http: [//odetocode.com/Blogs/scott/archive/2006/02/16/2914.aspx](http://odetocode.com/Blogs/scott/archive/2006/02/16/2914.aspx)

在 MVC 中，作为一般规则，您应该避免为页面生命周期和代码隐藏连接事件处理程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T19:57:05.890

抱歉 - 在 ASP.NET 中默认为 true，因此您应该在 @Page 指令中将 AutoEventWireup 显式设置为 false，或者将其删除并在 MVC 的 web.config 的 pages 部分中将其设置为 false。

# nhibernate - 将查询转换为 HQL 时遇到问题

> ID：275971
> 
> 赞同：1
> 
> 时间：2008-11-09T14:42:21.267
> 
> 标签：nhibernate, hql

我对 HQL 很陌生（嗯，一般是 nHibernate），目前正在构建一个简单的应用程序来了解更多信息。

我在尝试将以下 SQL 表达为 HQL 时遇到了问题，如果有任何想法，我将不胜感激。

这是查询：

```
select * from parent p
where p.id in (select p.parentid from child c where c.createdby = 2)
and
(select top 1 createdby 
 from child where parentid = p.id order by createdon desc) != 2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-10T00:25:17.487

谢谢 - 这让我走上了正轨。我不能使用“Top”，但是像这样重写查询似乎已经成功了：

```
select p from Parent p where p.ID in 
  (select c.parent.Id from Child c where c.CreatedBy = "+user.ID+") 
   and "+ user.ID +" = (select max(c.CreatedBy) 
from Child c 
where child.parent.ID = parent.ID 
```

请原谅讨厌的字符串连接 - 下一步是使用参数化 HQL 清理它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T15:52:35.743

不能保证第二部分，但也许这可以让你更接近目标。我将 parentid 比较替换为多对一参考。任何人都应该在 hql 中工作。

```
select p from parent p 
    where p in (select c.ParentReference from child c 
        where c.createdby = :twoparameter)
    and :twoparameter = (select top 1 c.createdby from child 
        where c.ParentReference = p order by p.createdon desc) 
```

# networking - 二十一小时内的 DNS

> ID：275978
> 
> 赞同：3
> 
> 时间：2008-11-09T14:48:11.037
> 
> 标签：networking, dns

我想要在 21 天内获得与 DNS 等效的在线资源。我需要一个晚上的阅读来解释不同记录类型的作用、传播和缓存如何工作、什么是 SoA 等。

我不想要任何以解释 DNS 是什么开始的东西。

谁能指出我正确的方向，以找到一些在线“天才的 DNS”指南？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T15:03:36.887

查看[火箭科学家的 DNS](http://www.zytrax.com/books/dns/)

它确实以非常简短的“什么是 DNS”开头，但您可以轻松跳过它。

您还可以查看[Records 101](http://www.dnsmadeeasy.com/s0306/res/recs.html)，它很好地概述了不同的记录类型——尽管这些示例是特定于 DNSMadeEasy 的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T17:00:31.380

我把[DNS 和 BIND](http://oreilly.com/catalog/9780596001582/)放在我的床头柜上。让我继续前进是件好事（我使用了 TOC 并跳过了“什么是 DNS”部分），它不断给我信心和帮助。

我通常不买死树上的烟灰书，但这本是一个罕见的例外，它已经回报了我很多倍。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T17:09:44.810

权威来源，可读性强（IMO）：

[http://www.ietf.org/rfc/rfc1035.txt](http://www.ietf.org/rfc/rfc1035.txt)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T17:09:24.153

当我第一次设置 DNS 时，我阅读了[DNS HOWTO](http://www.langfeldt.net/DNS-HOWTO/BIND-9/)。它对我来说效果很好。

# python - 将机械化模块导入python脚本

> ID：275980
> 
> 赞同：4
> 
> 时间：2008-11-09T14:50:26.353
> 
> 标签：python, google-app-engine

我试图像这样将机械化模块导入我的python脚本，

从机械化导入浏览器

但是，Google appengine 在访问我的脚本时会抛出 HTTP 500。

为了让事情更清楚，让我给你我的包结构的快照，

```
root
 ....mechanize(where all the mechanize related files there)
 ....main.py
 ....app.yaml
 ....image
 ....script 
```

谁能帮我解决这个问题？

谢谢， 波马拉尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T23:09:47.077

机械化主页说：

> mechanize.Browser 是 mechanize.UserAgentBase 的子类，它又是 urllib2.OpenerDirector 的子类

我的理解是 urllib2 是 GAE 中的沙盒模块之一，其功能被 Google 提供的 urlfetch 取代。如果可能的话，您需要重新实现 mechanize.UserAgentBase 类以使用 urlfetch。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T19:27:31.770

当 GAE 抛出 500 时，您可以在管理控制台的日志中看到实际错误。如果这没有帮助，请将其粘贴到此处，我们将进一步提供帮助。

此外，它是否适用于 dev_appserver？

# asp.net - lsass.exe 在 ASP.NET Web 应用程序部署后开始最大化 CPU

> ID：275981
> 
> 赞同：1
> 
> 时间：2008-11-09T14:50:32.157
> 
> 标签：asp.net, deployment, windows-server-2003

在部署 ASP.NET Web 应用程序的新版本（大部分是更改的 DLL）后，服务器上的 CPU 现在每隔几秒就会跳到 100%，罪魁祸首是 lsass.exe。你认为将asp.net web app部署到服务器和这个问题有关系吗？（或者是同时发生的巧合？）

更多信息：

这是我第一次在 Server 2008 x64 机器上进行构建。以前的构建是在 Server 2003 x86 机器上完成的。目标是“任何 CPU”，因此应该可以在其中任何一个上工作。部署到服务器的是 Server 2003 x86。

我在网上搜索了更多信息，并确认该进程是 lsass.exe（第一个字符是小写 L 而不是大写 i），因此排除了病毒版本。找到了一些与 Server 2000 错误相关的文档，但不适用于此处。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T00:11:52.833

我最终将问题隔离到在该 ASP.NET Web 应用程序“下”运行的 ASP 论坛上。使用论坛上的管理页面，我将论坛关闭，然后再次将其恢复，问题就消失了。我觉得这非常令人沮丧，因为问题现在已经消失，但我不知道是什么原因造成的，因此它很容易返回。

我还安装了[这个 Microsoft 修补程序](http://support.microsoft.com/kb/939268/)并重新启动了这台服务器，但没有奏效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-10T00:26:24.037

[Windows Performance Toolkit](http://www.microsoft.com/whdc/system/sysperf/perftools.mspx)中分发的 xperf 工具将准确地告诉您 CPU 时间或磁盘带宽的使用情况。这些工具是免费的，适用于任何零售版本的 WS2008 或 Vista。[这](http://www.microsoft.com/whdc/system/sysperf/perftools.mspx)是我本人关于 xperf 工具的系列文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T20:07:22.470

您是否已更新为使用 Active Directory 角色提供程序？我已经看到枚举组进行角色检查的问题与 CPU 挂钩并且确实减慢了应用程序的速度。我实际上实现了一个定制的提供程序，它允许我指定一个特定的 OU 和一组我真正关心的组来解决这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T15:02:38.373

您是否检查过系统和应用程序事件日志是否有任何异常？

# sql-server-2005 - SQL 2005 用户实例和 SQL 身份验证

> ID：275983
> 
> 赞同：0
> 
> 时间：2008-11-09T14:54:26.283
> 
> 标签：sql-server-2005, sql-authentication, user-instance

我可以对用户实例使用 SQL 身份验证吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T14:58:49.207

[**不：**](http://msdn.microsoft.com/en-us/library/ms143684(SQL.90).aspx)

> 使用用户实例时的限制
> 
> *   用户实例不支持 SQL Server 身份验证。仅支持 Windows 身份验证。

# database - Delphi：主/详细数据集的“无效字段类型”错误

> ID：275984
> 
> 赞同：1
> 
> 时间：2008-11-09T14:55:04.940
> 
> 标签：database, delphi, dataset

我询问了有关[使用 TClientDataset 设置内存数据集的问题，](https://stackoverflow.com/questions/274958/delphi-using-tclientdataset-as-an-in-memory-dataset)并被告知我必须使用表单设计器中的“创建数据集”命令。在我尝试创建主从数据库关系之前，它工作得很好。如果我有一个 ftDataSet 类型的字段 def，则运行 Create Data Set 命令（或在运行时调用该方法）会给出“无效字段类型”错误。我做了一些搜索，发现其他人以前也遇到过这个问题，但似乎没有人想出答案。有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-10T19:55:33.960

不要将您的详细信息放在 ftDataSet 列中，只需使用唯一整数或 GUID 作为键引用，并将详细数据放在不同的 TClientDataSet 中并拥有该键。就像在普通数据库中一样。每个 TClientDataSet 代表一个不同的表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T14:38:56.237

如果创建 ftDataSet 类型的字段，则需要定义数据集，否则类型无效。

您可以通过以下方式定义数据集：

*   选择字段。
*   选择 ChildDefs 属性并单击 [...] 按钮。
*   添加字段。

现在您可以创建数据集了。除非其中一个孩子是 ftDataSet 类型，在这种情况下，您必须递归地重复该过程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T05:50:15.163

一个令人讨厌的问题，已经花费了我很多时间。最后我找到了一个解决方法，在这里描述（谢谢你们！）：

[http://www.delphigroups.info/3/6/171869.html](http://www.delphigroups.info/3/6/171869.html)

摘要：罪魁祸首是主客户端数据集的字段定义，即包含 ftDataset 字段的字段定义。只要主客户端数据集的字段定义不为空，命令 CreateDataSet 就会失败并显示上述错误消息（“无效字段类型”）。

解决方法：按照说明创建主从表，但在执行 CreateDataset 时确保字段定义为空：

a) 设计时：在设计表单中执行“主数据集|右键单击|创建数据集”之前，您必须单击主数据集，进入对象检查器，单击 FieldDefs，然后删除 FieldDefs 窗口中的所有字段。（第一次构建主数据集时无论如何都没有，但后来有。）然后才创建数据集。（我自己用 Delphi 2007 试过这个；它有效。）

b) 运行时：在执行 [Name of Masterdataset].CreateDataSet 之前调用 [Name of Masterdataset].FieldDefs.Clear。（我自己没有尝试过，但在上面命名的链接中有可靠的描述。）

如果这太复杂，请查看上面提到的链接。

# ruby - 流终止而不循环并打印额外的字符

> ID：275985
> 
> 赞同：1
> 
> 时间：2008-11-09T14:58:11.860
> 
> 标签：ruby

**搜索词.rb**

```
search = "1|butter+salted|Butter salt|Butter|Túrós csusza|Margarine|Potato
          2|butter+whipped|Shea butter|Butter|Pastry bag|Cream bun|Butter cream
          3|butter+oil+anhydrous|Ultralight backpacking|Odell\'s|Ghee|Fragrance extraction|Perfume
          4|cheese+blue|Blue cheese|Shropshire Blue cheese|Buxton Blue cheese|Danish Blue cheese|Blue cheese dressing
          5|cheese+brick|Brick cheese|Oaxaca cheese|List of American cheeses|Herve cheese|Trappista cheese

.
.
.

search = search.split('\n')
catalog = String.new
a = 0; until a == search.length

  line = search[a].split('|')
  id   = line.first
  term = line[1]

  puts id + "|" + term
  puts "        1 #{line[2].nil? ? '' : line[2]}"
  puts "        2 #{line[3].nil? ? '' : line[3]}"
  puts "        3 #{line[4].nil? ? '' : line[4]}"
  puts "        4 #{line[5].nil? ? '' : line[5]}"
  puts "        5 #{line[6].nil? ? '' : line[6]}"

  choice = gets 
  choice = choice.chomp.to_i

  catalog = "#{id}|#{term}|#{line[choice]}\n"

  %x[echo "#{catalog}" >> updated_terms]

  a += 1
end

$ ruby searchterms.rb
1|butter+salted
        1 Butter salt
        2 Butter
        3 Túrós csusza
        4 Margarine
        5 Potato
2 # I don't know why this figure is printed. 
2
$ 
```

我如何让这个工作？我必须为每种食品选择最相关的术语。

在将 a 设置为任何其他数字以开始时，我也会收到一个奇怪的错误：

```
 searchterms.rb:7525:      
      line = search[a].split('|')
   private method `split' called for nil:NilClass (NoMethodError) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T15:37:46.147

你需要使用

```
search.split("\n") 
```

代替

```
search.split('\n') 
```

单引号防止它被解释为实际的换行符。这就是循环终止的原因——数组的长度（根本没有被拆分）是 1。在第一次迭代结束时，a（即 0）变为 a += 1，即未拆分的数组。

# python - 多线程 Python 应用程序的远程调试

> ID：275989
> 
> 赞同：1
> 
> 时间：2008-11-09T15:05:23.593
> 
> 标签：python, remote-debugging

如何从 Windows XP 或 Vista 远程调试在基于嵌入式 Linux 的系统上运行的多线程 Python 应用程序？

到目前为止，我只遇到过[基于 PyScripter 的远程调试](http://pyscripter.googlepages.com/)。它的表现如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T15:30:08.487

除了一些快速的试运行外，我从未使用过它，但[winpdb](http://winpdb.org/)听起来就像你想要的那样：

> Winpdb 是一个独立于平台的 GPL Python 调试器，支持多线程、命名空间修改、嵌入式调试、加密通信，比 pdb 快 20 倍。

# c# - 在 C/C#/C++ 中进行反向循环的最佳方法是什么？

> ID：275994
> 
> 赞同：108
> 
> 时间：2008-11-09T15:07:28.830
> 
> 标签：c#, c++, c

我需要向后移动一个数组，所以我有这样的代码：

```
for (int i = myArray.Length - 1; i >= 0; i--)
{
    // Do something
    myArray[i] = 42;
} 
```

有没有更好的方法来做到这一点？

更新：我希望也许 C# 有一些内置机制，比如：

```
foreachbackwards (int i in myArray)
{
    // so easy
} 
```

更新 2：有*更好的*方法。符文获奖：

```
for (int i = myArray.Length; i-- > 0; )
{    
    //do something
}
//or
for (int i = myArray.Length; i --> 0; )
{
    // do something
} 
```

在常规 C 中看起来更好（感谢 Twotymz）：

```
for (int i = lengthOfArray; i--; )
{    
    //do something
} 
```

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2008-11-09T16:06:12.503

虽然诚然有点晦涩，但我会说最令人愉悦的排版方式是

```
for (int i = myArray.Length; i --> 0; )
{
    //do something
} 
```

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2008-11-09T16:04:53.957

在 C++ 中，您基本上可以选择使用迭代器或索引进行迭代。根据您是使用普通数组还是`std::vector`，您使用不同的技术。

## 使用 std::vector

### 使用迭代器

C++ 允许您使用`std::reverse_iterator:`

```
for(std::vector<T>::reverse_iterator it = v.rbegin(); it != v.rend(); ++it) {
    /* std::cout << *it; ... */
} 
```

### 使用索引

*返回的无*符号整数类型`std::vector<T>::size`并不总是。它可以更大或更小。这对于循环工作至关重要。*`std::size_t`*

 *```
for(std::vector<int>::size_type i = someVector.size() - 1; 
    i != (std::vector<int>::size_type) -1; i--) {
    /* std::cout << someVector[i]; ... */
} 
```

它可以工作，因为无符号整数类型值是通过对其位数取模来定义的。因此，如果你正在设置`-N`，你最终会在`(2 ^ BIT_SIZE) -N`

## 使用数组

### 使用迭代器

我们`std::reverse_iterator`用来进行迭代。

```
for(std::reverse_iterator<element_type*> it(a + sizeof a / sizeof *a), itb(a); 
    it != itb; 
    ++it) {
    /* std::cout << *it; .... */
} 
```

### 使用索引

与上面相反，我们可以`std::size_t`在这里安全地使用，因为`sizeof`总是`std::size_t`按定义返回。

```
for(std::size_t i = (sizeof a / sizeof *a) - 1; i != (std::size_t) -1; i--) {
   /* std::cout << a[i]; ... */
} 
```

## 避免将 sizeof 应用于指针的陷阱

实际上，上述确定数组大小的方法很糟糕。如果 a 实际上是一个指针而不是一个数组（这种情况经常发生，初学者会混淆它），它会默默地失败。更好的方法是使用以下方法，如果给定指针，它将在编译时失败：

```
template<typename T, std::size_t N> char (& array_size(T(&)[N]) )[N]; 
```

它首先获取传递数组的大小，然后声明返回对相同大小的 char 类型数组的引用。`char`被定义为`sizeof`：1。所以返回的数组将有一个`sizeof`：N * 1，这就是我们正在寻找的，只有编译时评估和零运行时开销。

而不是做

```
(sizeof a / sizeof *a) 
```

更改您的代码，使其现在可以执行

```
(sizeof array_size(a)) 
```

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2008-11-09T17:37:42.240

**在 C#**中，使用 Visual Studio 2005 或更高版本，**键入 'forr' 并点击 [TAB] [TAB]**。这将扩展为一个`for`向后遍历集合的循环。

很容易出错（至少对我来说），我认为把这个片段放进去是个好主意。

也就是说，我喜欢`Array.Reverse()`/`Enumerable.Reverse()`然后更好地*向前*迭代——它们更清楚地表明了意图。

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2013-01-03T10:22:32.833

我**总是**更喜欢清晰的代码而不是'*印刷上令人愉悦*'的代码。因此，我总是使用：

```
for (int i = myArray.Length - 1; i >= 0; i--)  
{  
    // Do something ...  
} 
```

您可以将其视为向后循环的标准方式。
就我的两分钱...

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2008-11-09T15:55:59.950

在**C#**中使用**Linq**：

```
foreach(var item in myArray.Reverse())
{
    // do something
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-11-09T15:10:31.023

对于长度为有符号整数类型的任何数组，这绝对是最好的方法。对于长度为无符号整数类型的数组（例如`std::vector`C++ 中的 an），则需要稍微修改结束条件：

```
for(size_t i = myArray.size() - 1; i != (size_t)-1; i--)
    // blah 
```

如果你刚才说`i >= 0`，对于无符号整数来说总是如此，所以循环将是一个无限循环。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-09T15:13:22.657

对我来说看上去很好。如果索引器未签名（uint 等），您可能必须考虑到这一点。叫我懒惰，但在那种（无符号）情况下，我可能只使用一个反变量：

```
uint pos = arr.Length;
for(uint i = 0; i < arr.Length ; i++)
{
    arr[--pos] = 42;
} 
```

（实际上，即使在这里，您也需要小心诸如 arr.Length = uint.MaxValue 之类的情况......也许是 != 某处......当然，这是一个非常不可能的情况！）

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-11-09T17:14:34.563

在 CI 中喜欢这样做：

```
 int i = myArray.Length;
while (i--) {
  myArray[i] = 42;
} 

```

MusiGenesis 添加的 C# 示例：

```
{int i = myArray.Length; while (i-- > 0)
{
    myArray[i] = 42;
}} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-10T00:53:19.973

在 C++ 中做到这一点的最好方法可能是使用迭代器（或更好的范围）适配器，它会在遍历序列时懒惰地转换它。

基本上，

```
vector<value_type> range;
foreach(value_type v, range | reversed)
    cout << v; 
```

以相反的顺序显示范围“范围”（这里是空的，但我很确定您可以自己添加元素）。当然，简单地迭代范围并没有多大用处，但是将新范围传递给算法和其他东西非常酷。

这种机制也可以用于更强大的用途：

```
range | transformed(f) | filtered(p) | reversed 
```

将懒惰地计算范围“范围”，其中函数“f”应用于所有元素，删除“p”不为真的元素，最后将结果范围反转。

管道语法是最易读的 IMO，因为它是中缀。Boost.Range 库更新待审核实现了这一点，但自己也很简单。使用 lambda DSEL 生成函数 f 和内联谓词 p 更加酷。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-15T17:36:00.680

```
// this is how I always do it
for (i = n; --i >= 0;){
   ...
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-10-25T07:59:39.830

我更喜欢while循环。对我来说，这比`i`在 for 循环的条件下递减更清楚

```
int i = arrayLength;
while(i)
{
    i--;
    //do something with array[i]
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-09T16:46:12.530

我会使用原始问题中的代码，但如果你真的想使用 foreach 并在 C# 中有一个整数索引：

```
foreach (int i in Enumerable.Range(0, myArray.Length).Reverse())
{
    myArray[i] = 42; 
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-01-02T18:24:23.307

**对于 C++：**

正如其他人所提到的，如果可能（即一次只需要每个元素），最好使用迭代器来明确并避免常见的陷阱。现代 C++ 有一个更简洁的语法`auto`：

```
std::vector<int> vec = {1,2,3,4};
for (auto it = vec.rbegin(); it != vec.rend(); ++it) {
    std::cout<<*it<<" ";
} 
```

打印`4 3 2 1` 。

您还可以在循环期间修改该值：

```
std::vector<int> vec = {1,2,3,4};
for (auto it = vec.rbegin(); it != vec.rend(); ++it) {
    *it = *it + 10;
    std::cout<<*it<<" ";
} 
```

导致`14 13 12 11` 被打印并`{11, 12, 13, 14}`在`std::vector`之后。

如果您不打算在循环期间修改该值，则应确保在尝试意外执行此操作时遇到错误，类似于人们可能编写`for(const auto& element : vec)`的 . 这可能是这样的：

```
std::vector<int> vec = {1,2,3,4};
for (auto it = vec.crbegin(); it != vec.crend(); ++it) { // used crbegin()/crend() here...
    *it = *it + 10; // ... so that this is a compile-time error
    std::cout<<*it<<" ";
} 
```

在这种情况下，我的编译器错误是：

```
/tmp/main.cpp:20:9: error: assignment of read-only location ‘it.std::reverse_iterator<__gnu_cxx::__normal_iterator<const int*, std::vector<int> > >::operator*()’
   20 |     *it = *it + 10;
      |     ~~~~^~~~~~~~~~ 
```

另请注意，您应该确保不要同时使用不同的迭代器类型：

```
std::vector<int> vec = {1,2,3,4};
for (auto it = vec.rbegin(); it != vec.end(); ++it) { // mixed rbegin() and end()
    std::cout<<*it<<" ";
} 
```

导致详细错误：

```
/tmp/main.cpp: In function ‘int main()’:
/tmp/main.cpp:19:33: error: no match for ‘operator!=’ (operand types are ‘std::reverse_iterator<__gnu_cxx::__normal_iterator<int*, std::vector<int> > >’ and ‘std::vector<int>::iterator’ {aka ‘__gnu_cxx::__normal_iterator<int*, std::vector<int> >’})
   19 | for (auto it = vec.rbegin(); it != vec.end(); ++it) {
      |                              ~~ ^~ ~~~~~~~~~
      |                              |            |
      |                              |            std::vector<int>::iterator {aka __gnu_cxx::__normal_iterator<int*, std::vector<int> >}
      |                              std::reverse_iterator<__gnu_cxx::__normal_iterator<int*, std::vector<int> > > 
```

如果堆栈上有 C 样式的数组，则可以执行以下操作：

```
int vec[] = {1,2,3,4};
for (auto it = std::crbegin(vec); it != std::crend(vec); ++it) {
    std::cout<<*it<<" ";
} 
```

如果您确实需要索引，请考虑以下选项：

*   检查范围，然后使用有符号值，例如：

```
void loop_reverse(std::vector<int>& vec) {
    if (vec.size() > static_cast<size_t>(std::numeric_limits<int>::max())) {
        throw std::invalid_argument("Input too large");
    }
    const int sz = static_cast<int>(vec.size());
    for(int i=sz-1; i >= 0; --i) {
        // do something with i
    }
} 
```

*   使用无符号值，小心，并添加注释，例如：

```
void loop_reverse2(std::vector<int>& vec) {
    for(size_t i=vec.size(); i-- > 0;) { // reverse indices from N-1 to 0
        // do something with i
    }
} 
```

*   单独计算实际指数，例如：

```
void loop_reverse3(std::vector<int>& vec) {
    for(size_t offset=0; offset < vec.size(); ++offset) {
        const size_t i = vec.size()-1-offset; // reverse indices from N-1 to 0
        // do something with i
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-21T18:40:01.103

我这样做

```
if (list.Count > 0)
    for (size_t i = list.Count - 1; i >= 0; i--)
    {
        //do your thing

        if (i == 0) //for preventing unsigned wrap
            break;
    } 
```

但由于某种原因，Visual Studio 2019 生气并警告我“定义不明确的循环”或其他什么......它不相信我

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-11-09T15:15:48.110

我将尝试在这里回答我自己的问题，但我也不喜欢这样：

```
for (int i = 0; i < myArray.Length; i++)
{
    int iBackwards = myArray.Length - 1 - i; // ugh
    myArray[iBackwards] = 666;
} 
```

* * *

## 回答 #16

> 赞同：-5
> 
> 时间：2008-11-09T16:35:19.060

注意：这篇文章最终变得更加详细，因此偏离主题，我深表歉意。

话虽如此，我的同龄人读过它并相信它在“某处”很有价值。这个线程不是地方。我会很感激您对这应该去哪里的反馈（我是该网站的新手）。

* * *

无论如何，这是 .NET 3.5 中的 C# 版本，令人惊奇的是它可以使用定义的语义在任何集合类型上工作。这是最常见的开发场景中的默认度量（重用！），而不是性能或 CPU 周期最小化，尽管这似乎从未在现实世界中发生（过早优化）。

***在任何集合类型上工作的扩展方法并采取期望该类型的单个值的动作委托，所有这些都在每个项目上反向执行**

要求 3.5：

```
public static void PerformOverReversed<T>(this IEnumerable<T> sequenceToReverse, Action<T> doForEachReversed)
      {
          foreach (var contextItem in sequenceToReverse.Reverse())
              doForEachReversed(contextItem);
      } 
```

较旧的 .NET 版本还是您想更好地了解 Linq 内部？继续阅读..或不..

假设：在 .NET 类型系统中，Array 类型继承自 IEnumerable 接口（不是通用的 IEnumerable，只有 IEnumerable）。

这就是您从头到尾迭代所需的全部内容，但是您想朝相反的方向移动。由于 IEnumerable 适用于“对象”类型的数组，因此任何类型都有效，

关键措施：我们假设您是否可以以“更好”的相反顺序处理任何序列，然后只能对整数进行处理。

.NET CLR 2.0-3.0 的解决方案 a：

描述：我们将接受任何 IEnumerable 实现实例，并要求它包含的每个实例都属于同一类型。因此，如果我们收到一个数组，则整个数组包含 X 类型的实例。如果任何其他实例的类型为 !=X，则会引发异常：

单例服务：

公共类 ReverserService { 私有 ReverserService() { }

```
 /// <summary>
    /// Most importantly uses yield command for efficiency
    /// </summary>
    /// <param name="enumerableInstance"></param>
    /// <returns></returns>
    public static IEnumerable ToReveresed(IEnumerable enumerableInstance)
    {
        if (enumerableInstance == null)
        {
            throw new ArgumentNullException("enumerableInstance");
        }

        // First we need to move forwarad and create a temp
        // copy of a type that allows us to move backwards
        // We can use ArrayList for this as the concrete
        // type

        IList reversedEnumerable = new ArrayList();
        IEnumerator tempEnumerator = enumerableInstance.GetEnumerator();

        while (tempEnumerator.MoveNext())
        {
            reversedEnumerable.Add(tempEnumerator.Current);
        }

        // Now we do the standard reverse over this using yield to return
        // the result
        // NOTE: This is an immutable result by design. That is 
        // a design goal for this simple question as well as most other set related 
        // requirements, which is why Linq results are immutable for example
        // In fact this is foundational code to understand Linq

        for (var i = reversedEnumerable.Count - 1; i >= 0; i--)
        {
            yield return reversedEnumerable[i];
        }
    }
}

public static class ExtensionMethods
{

      public static IEnumerable ToReveresed(this IEnumerable enumerableInstance)
      {
          return ReverserService.ToReveresed(enumerableInstance);
      }
 } 
```

[TestFixture] 公共类Testing123 {

```
 /// <summary>
    /// .NET 1.1 CLR
    /// </summary>
    [Test]
    public void Tester_fornet_1_dot_1()
    {
        const int initialSize = 1000;

        // Create the baseline data
        int[] myArray = new int[initialSize];

        for (var i = 0; i < initialSize; i++)
        {
            myArray[i] = i + 1;
        }

        IEnumerable _revered = ReverserService.ToReveresed(myArray);

        Assert.IsTrue(TestAndGetResult(_revered).Equals(1000));
    }

    [Test]
    public void tester_why_this_is_good()
    {

        ArrayList names = new ArrayList();
        names.Add("Jim");
        names.Add("Bob");
        names.Add("Eric");
        names.Add("Sam");

        IEnumerable _revered = ReverserService.ToReveresed(names);

        Assert.IsTrue(TestAndGetResult(_revered).Equals("Sam"));

    }

    [Test]
    public void tester_extension_method()
  {

        // Extension Methods No Linq (Linq does this for you as I will show)
        var enumerableOfInt = Enumerable.Range(1, 1000);

        // Use Extension Method - which simply wraps older clr code
        IEnumerable _revered = enumerableOfInt.ToReveresed();

        Assert.IsTrue(TestAndGetResult(_revered).Equals(1000));

    }

    [Test]
    public void tester_linq_3_dot_5_clr()
    {

        // Extension Methods No Linq (Linq does this for you as I will show)
        IEnumerable enumerableOfInt = Enumerable.Range(1, 1000);

        // Reverse is Linq (which is are extension methods off IEnumerable<T>
        // Note you must case IEnumerable (non generic) using OfType or Cast
        IEnumerable _revered = enumerableOfInt.Cast<int>().Reverse();

        Assert.IsTrue(TestAndGetResult(_revered).Equals(1000));

    }

    [Test]
    public void tester_final_and_recommended_colution()
    {

        var enumerableOfInt = Enumerable.Range(1, 1000);
        enumerableOfInt.PerformOverReversed(i => Debug.WriteLine(i));

    }

    private static object TestAndGetResult(IEnumerable enumerableIn)
    {
      //  IEnumerable x = ReverserService.ToReveresed(names);

        Assert.IsTrue(enumerableIn != null);
        IEnumerator _test = enumerableIn.GetEnumerator();

        // Move to first
        Assert.IsTrue(_test.MoveNext());
        return _test.Current;
    }
} 
```**````**