# StackOverflow 问答 000302000-000302999

# sql-server - 未安装 sql server 2005 vss writer 服务。我该如何解决

> ID：302002
> 
> 赞同：2
> 
> 时间：2008-11-19T14:20:51.907
> 
> 标签：sql-server

我试图用 SP2 更新 sql server 2005。由于没有启动 vss writer，我失败了。当我进入服务时，我看到没有安装 vss writer。（甚至没有在服务中列出）。当我检查我的其他冗余服务器时，我看到安装了 vss writer 服务。如何添加服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T23:46:59.157

从 SQL Server DVD 中找到 SqlWriter.msi 并运行它。

# java - 从 Java 访问 SDF SQLServer Mobile 文件

> ID：302016
> 
> 赞同：2
> 
> 时间：2008-11-19T14:26:30.273
> 
> 标签：java, jdbc, sdf, sql-server-mobile

在工作中，我们想要访问`.sdf`在 PDA 中生成的文件中的数据`SQLServer Mobile Edition`。我们将`SqlJDBC4`数据包用于`JDBC`但无法进入服务器。我们知道它正在运行，因为我们可以 telnet 进入它，但是从`Java`代码中我们一次又一次地得到我们无法连接到服务器。

我们使用这个连接字符串：

```
String connectionUrl="jdbc:sqlserver://localhost;databaseName=d:\\file.sdf;"+
   "SelectMethod=cursor;Password=test;integratedSecurity=true"; 
```

任何人`stackoverflower`都可以告诉我们正确的连接字符串或我们做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-11-06T10:51:03.693

[这](https://stackoverflow.com/questions/141454/jdbc-driver-for-microsoft-sql-server-cecompact-edition-3-5/1071831#1071831)是来自关于 CE 数据库的问题。但也许它无论如何都可以帮助你。据我了解，问题是相似的 - 访问 sdf。

# firefox - 在 Firefox 中浏览和编辑保存的表单数据

> ID：302017
> 
> 赞同：34
> 
> 时间：2008-11-19T14:26:34.033
> 
> 标签：firefox, forms

是否有人熟悉在 Firefox 中浏览和编辑/删除已保存表单条目的方法？我知道我可以：

*   使用 Clear Private Data 对话框删除所有表单数据；
*   [当光标在表单上时，使用 shift-delete 删除表单中的特定条目](http://kb.mozillazine.org/Deleting_autocomplete_entries)(*)。

我想要的是一种查看特定关键字的所有已保存条目、编辑它们并轻松删除全部或选择性删除的方法。

我希望找到一个可以做到这一点的插件，但找不到任何插件。也许有人写了一个但还没有提交？或者，也许有人刚刚编写了一个操作 formhistory.sqlite 文件的外部工具？

谢谢。

(*) 对于那些不知道这一点的人：转到您最喜欢的搜索引擎的搜索框，然后按向下键查看历史记录。Shift-delete 将从保存的表单数据中删除“当前”条目。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-10-11T13:20:42.420

[SQLite 管理器](https://addons.mozilla.org/addon/sqlite-manager-webext/)扩展可以打开`formhistory.sqlite`文件（以及`.sqlite`Firefox 配置文件夹中的任何其他文件），并使其可用于使用简单的 GUI 添加、编辑和删除记录。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-19T14:34:41.910

它们存储在您的配置文件目录中的[sqlite](http://sqlite.org/)数据库中（例如 C:\Documents and Settings\xxxxx\Application Data\Mozilla\Firefox\Profiles\xxxxx），位于名为 formhistory.sqlite 的文件中。

您可以下载[sqlite 客户端](http://sqlite.org/download.html)来浏览和编辑数据库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-11T11:57:01.600

**更新**（根据评论）：*新的 Webextension API 不再适用。表单历史控件管理一个单独的历史。*

* * *

**[表单历史控件](https://addons.mozilla.org/addon/form-history-control/)**扩展可以从所有表单历史中删除特定输入和相同输入。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-07T23:12:18.017

我开发 Adob​​e AIR 应用程序并使用 Lita 查看他们的 SQLite 数据库。我刚刚在 firefox 表单数据库上尝试过，我比 firefox 扩展更喜欢它。

该扩展的好处是它可以轻松访问您的数据库，但是一旦您知道它们都在哪里：

**在 Mac 上：**
`/Users/[yourName]/Library/Application Support/Firefox/Profiles/[profileName]`

**在窗户上：**
`C:\Documents and Settings\[yourName]\Application Data\Mozilla\Firefox\Profiles\[profileName]`

然后，我认为你最好使用你最喜欢的 SQLite 客户端。

对我来说，在 Lita 的 Mac 上：

[http://www.dehats.com/drupal/?q=node/58](http://www.dehats.com/drupal/?q=node/58)

*注意：Lita 也可以在 Windows 和 Linux 上运行。*

...希望对某人有所帮助！

# sql - SQL - 需要查找重复记录但排除反向交易

> ID：302022
> 
> 赞同：4
> 
> 时间：2008-11-19T14:27:55.467
> 
> 标签：sql, crystal-reports, report, reporting

我有一个交易表，偶尔会有重复的条目。如果/当管理员发现这些重复条目时，他们将撤消交易，从而产生负值（但由于监管要求，原始副本仍然存在）。我想创建一个 SQL 查询（并使用 Crystal Reports）为管理员制作报告，以便轻松找到重复的交易。由于交易量很大，我想通过忽略他们已经撤销的交易来让他们更容易。

这是我想做的一个例子：

**交易日期 ; 交易数量；交易价值；逆转**

```
1/1/08    ; 14    ;    70.00    ; N
1/1/08    ; 14    ;    70.00    ; N
1/1/08    ; -14   ;    -70.00   ; Y
2/1/08    ; 17    ;    89.00    ; N
2/15/08   ; 18    ;    95.00    ; N
2/15/08   ; 18    ;    95.00    ; N
3/1/08    ; 11    ;    54.00    ; N
3/1/08    ; -11   ;    -54.00   ; Y
3/1/08    ; 11    ;    54.00    ; N
3/1/08    ; 11    ;    54.00    ; N
3/1/08    ; 11    ;    54.00    ; N 
```

理想情况下，如果我在上表中运行我的“期望”查询，我会收到以下结果：

**交易日期 ; 交易数量；交易价值；数数**

```
2/15/08    ; 18    ;    95.00    ; 2
3/1/08     ; 11    ;    54.00    ; 3 
```

那有意义吗？我已经想出了如何编写查询来给我一个重复的计数，但是我不知道如何排除已经“退出”的重复记录。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T14:36:16.137

怎么样：

```
select dt, abs(qty), abs(val),
       sum(case when reversal='Y' then -1 else 1 end) as count
from transactions
group by dt, abs(qty), abs(val)
having sum(case when reversal='Y' then -1 else 1 end) > 1; 
```

我刚刚在 Oracle 中对其进行了测试，它可以工作：

```
create table transactions
( dt date
, qty number
, val number
, reversal varchar2(1)
);

insert into transactions values (to_date('1/1/08','mm/dd/yy')    , 14    ,    70.00    , 'N');
insert into transactions values (to_date('1/1/08','mm/dd/yy')    , 14    ,    70.00    , 'N');
insert into transactions values (to_date('1/1/08','mm/dd/yy')    , -14   ,    -70.00   , 'Y');
insert into transactions values (to_date('2/1/08','mm/dd/yy')    , 17    ,    89.00    , 'N');
insert into transactions values (to_date('2/15/08','mm/dd/yy')   , 18    ,    95.00    , 'N');
insert into transactions values (to_date('2/15/08','mm/dd/yy')   , 18    ,    95.00    , 'N');
insert into transactions values (to_date('3/1/08','mm/dd/yy')    , 11    ,    54.00    , 'N');
insert into transactions values (to_date('3/1/08','mm/dd/yy')    , -11   ,    -54.00   , 'Y');
insert into transactions values (to_date('3/1/08','mm/dd/yy')    , 11    ,    54.00    , 'N');
insert into transactions values (to_date('3/1/08','mm/dd/yy')    , 11    ,    54.00    , 'N');
insert into transactions values (to_date('3/1/08','mm/dd/yy')    , 11    ,    54.00    , 'N');

SQL> select dt, abs(qty), abs(val),
  2         sum(case when reversal='Y' then -1 else 1 end) as count
  3  from transactions
  4  group by dt, abs(qty), abs(val)
  5  having sum(case when reversal='Y' then -1 else 1 end) > 1;

DT            ABS(QTY)   ABS(VAL)      COUNT
----------- ---------- ---------- ----------
15-FEB-2008         18         95          2
01-MAR-2008         11         54          3 
```

# database - 如何创建表单来编辑一对多关系？

> ID：302025
> 
> 赞同：2
> 
> 时间：2008-11-19T14:28:14.763
> 
> 标签：database, ms-access, ms-access-2007

使用 MS Access 2007，我正在创建一个学生管理数据库。我有以下表格：

*   学生们
*   培训班
*   课程部分

我需要的是一种将学生分配到课程部分的方法。所以我创建了一个链接学生和会话的表：

*   StudentInSection（包含学生的外键和课程部分的外键）

我想创建一个表单，允许我编辑一个部分并从学生列表中添加学生。我做过很多关系数据库工作，只是从来没有访问过。这似乎是一件很简单的事情。有人知道这样做的好方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T16:32:37.790

创建一个绑定到 StudentsInSection 表的表单。如果您希望能够编辑该部分中的学生，最简单的做法是使用基于 Student 表的具有行源的组合框，该组合框的绑定列与记录集中的学生 ID 相关联StudentInSection 表单的基础。此表单将是您的子表单。将表单的默认视图属性设置为“数据表”或“连续表单”。保存并关闭表单。

创建一个绑定到 CourseSection 表的表单。从 Forms 列表中，单击并拖动基于 StudentsInSection 表的第一个表单到 CourseSection 表单的设计区域。

在新子窗体控件的属性表中，将 Link Master Fields 属性设置为 CourseSection 表的 Section ID。在 Link Child Fields 属性中，将值设置为 StudentsInSection 表的 Section ID。设置这些属性将在导航记录时过滤子表单数据以匹配父表单中的当前值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T15:11:56.953

您可以做的最简单的事情是从主表单创建一个子表单。基于学生的主要形式和基于学生部分的子形式。在子表单上，添加一个下拉菜单以选择课程。

这样，StudentSection 将从父表单中填充 StudentID（我假设这是您的密钥），并且您可以在设置下拉菜单时设置 CourseID。

# java - 测量代码段的 Java 执行时间、内存使用和 CPU 负载

> ID：302026
> 
> 赞同：26
> 
> 时间：2008-11-19T14:28:40.193
> 
> 标签：java, performance, monitoring, jmx, measurement

**对于特定的 Java 代码段，我想测量：**

*   **执行时间（很可能是*线程执行时间*）**
*   **内存使用情况**
*   **CPU 负载（具体归因于代码段）**

我是一个相对的 Java 新手，不熟悉如何实现这一点。我被提到过[JMX](http://en.wikipedia.org/wiki/JMX)，但是我不确定如何使用它，而且 JMX 对于我想要做的事情来说看起来有点“沉重”。

理想情况下，我想要一些可以告诉我想要测量什么的测量类，可以选择`start()`在代码段之前调用方法和`stop()`之后调用方法。相关指标将记录到我指定的文件中。

例如：

```
import com.example.metricLogger;

metricLogger logger = new metricLogger();

logger.setLogPath(pathToLogFile);
logger.monitor(executionTime);
logger.monitor(memoryUsage);
logger.monitor(cpuLoad);

logger.start();

/* Code to be measured */

logger.stop(); 
```

**在 Java 中是否有任何标准/通用/传统方式来实现这一点？**

这样的测量是一次性的性能比较，所以我不是在寻找任何生产中的长期监控过程。

我很高兴被提及教程或外部示例，并且不期望在这里得到完整的答案。也就是说，如果可以实现上述任何简单的事情，那么一个现实的例子就会非常好。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-19T14:44:12.843

分析可能是一个更简单的选择，因为您不需要生产中的统计信息。分析也不需要修改代码。VisualVM（附带 JDK 1.6.06+）是一个简单的工具。如果你想要更深入的东西，我会选择 Eclipse TPTP、Netbeans profiler 或 JProfiler(pay)。

如果您想自己编写，请考虑以下事项：

可以通过“计时”您感兴趣的部分来完成执行时间等简单测量：

```
long start = System.nanoTime(); // requires java 1.5
// Segment to monitor
double elapsedTimeInSec = (System.nanoTime() - start) * 1.0e-9; 
```

您可以使用类似的技术通过 Runtime.getRuntime().*memory() 方法监控内存。请记住，在垃圾收集环境中跟踪内存使用情况比简单的减法更棘手。

CPU 负载在 Java 中很难测量，我通常坚持执行时间并优化较长/重复的部分

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-24T07:40:04.617

使用 ThreadMXBean，您可以获得单个线程的 CPU 使用率和消耗的 CPU 时间，而不是可能有用的经过时间。

但是，使用分析器通常更简单，因为此过程通常会生成大量数据，您需要一个好的可视化工具来查看发生了什么。

我使用 Yourkit，因为我发现解决我使用过的其他分析器的问题更容易。我还使用内置的 hprof，因为这可以让您对应用程序的配置文件有不同的看法（但没那么有用）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T15:16:52.123

**使用 Java Profiler**是最好的选择，它将为您提供对代码所需的所有洞察力。即响应时间、线程调用跟踪、内存利用率等

我会向您[**推荐 JENSOR**](http://jensor.sourceforge.net)，一个开源的 Java Profiler，因为它易于使用且 CPU 开销低。您可以下载它，检测代码，并获得您需要的有关代码的所有信息。

**您可以从以下网址下载： http : [//jensor.sourceforge.net/](http://jensor.sourceforge.net)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-21T14:24:53.633

我们可以通过在执行期间收集 cpu 和内存指标来测量特定调用方法期间使用的 cpu 和内存。
当然，如果其他方法的其他并发线程在执行过程中消耗了内存和cpu，你就会卡住。因此，当您能够以孤立的方式执行方法时，这是一种有效的方法。

对于 CPU，您可以获得其当前值：

```
OperatingSystemMXBean osBean = ManagementFactory.getPlatformMXBean(
            OperatingSystemMXBean.class); 
double processCpuLoad = osBean.getProcessCpuLoad(); 
```

对于内存，您可以这样做：

```
MemoryMXBean memoryMXBean = ManagementFactory.getMemoryMXBean();
int currentHeapUsedInMo = (int) (memoryMXBean.getHeapMemoryUsage().getUsed() / 1_000_000); 
```

关于内存度量，在执行该方法之前等待一个主要收集提高了它的可靠性。

例如，类似的事情可能会有所帮助：

```
import com.google.common.testing.GcFinalization;

GcFinalization.awaitFullGc();
foo.execute(); // method to execute 
```

`GcFinalization`来自[Guava 测试库](https://static.javadoc.io/com.google.guava/guava-testlib/23.0/com/google/common/testing/GcFinalization.html)。

所有这些都几乎没有开销。因此，想法是为您要监视的每个调用方法收集指标（例如每秒），并在方法返回时计算最大值/平均值或任何有用的信息。

我赞成 AOP 这样做。
Spring AOP 是一种创建切面并为其设置切入点的简单而好方法，但如果您需要一些关于 AOP 特性的特定内容，也可以使用 AspectJ 来完成。

# c++ - 我在哪里可以获得 c++ 标准手册？

> ID：302031
> 
> 赞同：0
> 
> 时间：2008-11-19T14:30:50.983
> 
> 标签：c++, manual

我在哪里可以获得 c++ 标准手册？

那是免费的吗？

***重复：*** [我在哪里可以查看 C++ 标准](https://stackoverflow.com/questions/204841/where-can-i-look-at-the-c-standard)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-19T14:37:59.050

AFAIK，ISO标准不是免费的

# vb.net - 在 LINQ 查询中从具体类转换为接口时出现异常

> ID：302032
> 
> 赞同：1
> 
> 时间：2008-11-19T14:31:04.213
> 
> 标签：vb.net, linq, casting

我有一个类 SomeClass，它可以从它的构造函数中的数据行中填充自己。此类实现 IInterface。但是，当我执行下面的代码时：

```
Dim fpQuery As IEnumerable(Of IInterface) = _
    From dr As DataRow In DataLayer.SomeMethodToGetADataTable.AsEnumerable _
    Select New SomeClass(dr) 
```

我得到错误

```
Unable to cast object of type 
'System.Data.EnumerableRowCollection`1[Classes.SomeClass]' 
to type
'System.Collections.Generic.IEnumerable`1[Interfaces.IInterface]' 
```

我可能应该补充一点，以下代码可以正常工作。

```
Dim fpQuery As IEnumerable(Of SomeClass) = _
    From dr As DataRow In DataLayer.SomeMethodToGetADataTable.AsEnumerable _
    Select New SomeClass(dr) 
```

和简单的演员一样

```
Dim myInterface As IInterface = New SomeClass(myDataRow) 
```

有任何想法吗？

编辑：乔恩·斯基特（Jon Skeet）明白了。我使用了以下代码，它运行良好。

```
Dim fpQuery2 As IEnumerable(Of IInterface) = fpQuery.Cast(Of IInterface) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T14:33:55.250

您遇到了泛型缺乏变化。把它放在一个更简单的例子中，你不能把它`IEnumerable(Of String)`当作`IEnumerable(Of Object)`.

最简单的事情可能是添加对[Cast(Of TResult)](http://msdn.microsoft.com/en-us/library/bb341406.aspx)的调用。

# asp.net - 单例与缓存 ASP.NET

> ID：302037
> 
> 赞同：5
> 
> 时间：2008-11-19T14:33:35.953
> 
> 标签：asp.net, caching, concurrency, singleton

我在.NET 中创建了一个注册表类，它是一个单例。显然，这个单例的行为就像它保存在缓存中一样（单例对象对每个会话都可用）。这是我应该将此单例添加到缓存中的好习惯吗？+ 我是否需要注意 GetInstance() 函数的并发问题？

```
namespace Edu3.Business.Registry
{
    public class ExamDTORegistry
    {
        private static ExamDTORegistry instance;
        private Dictionary<int, ExamDTO> examDTODictionary;

        private ExamDTORegistry()
        {
            examDTODictionary = new Dictionary<int, ExamDTO>();
        }

        public static ExamDTORegistry GetInstance()
        {
            if (instance == null)
            {
                instance = new ExamDTORegistry();
            }
            return instance;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T14:38:42.870

好吧，您的 GetInstance 方法当然不是线程安全的 - 如果两个线程同时调用它，它们很可能最终得到两个不同的实例。如果有帮助，我有一个[关于实现单例模式的页面。](http://csharpindepth.com/Articles/General/Singleton.aspx)

您的代码是否*依赖*于单例？请记住，如果重新加载 AppDomain，无论如何您都会获得一个新实例。

不过，我并没有真正看到将对象放入缓存有什么好处。你有什么特别想的吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-19T14:39:32.963

尽管它们存在于 GoF 单例中，但通常被认为是[不好的做法](http://tech.puredanger.com/2007/07/03/pattern-hate-singleton/)。您是否有任何理由希望只拥有一个实例？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T19:43:38.450

HttpContext.Cache 可用于所有会话，但缓存中的项目可以在过期或存在内存压力时从内存中删除。

HttpContext.Application 也可用于所有会话，并且是存储持久的、应用程序范围的对象的好地方。

由于您已经创建了一个单例并且它可以工作，我不明白为什么应该使用其中一个内置的单例集合，除非您需要 Cache 为您提供的额外功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T14:40:50.090

不确定缓存是什么意思...如果您希望将其缓存（例如...将其保存在内存中，这样您就不必从某些数据存储中再次获取它），那么是的，您可以将其放入缓存，它将对所有用户都是全局的。会话意味着每个用户，所以我认为这不是你想要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-27T14:46:38.767

我认为最初的问题谈到了哪个是首选。如果您有保持静态或本质上不可变的数据，那么 http 缓存或单例模式就很有意义。如果在应用程序启动时加载单例，则根本不存在“线程”问题。一旦单例就位，您将收到您请求的相同实例。我在实际实现中看到的很多问题是人们在没有充分考虑的情况下使用这两种方法。为什么要使不可变的配置数据过期？有一个客户端缓存了那里的数据并且仍然创建了 ADO DB 对象等，当他们最后一次检查它是否在缓存中时。实际上，这两种解决方案都适用于您，但要获得任何积极效果，请确保您使用缓存/单例。无论哪种情况，如果您的数据不可用，

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-12T17:12:42.133

我会让它像：

私有静态只读 ExamDTORegistry 实例；

那么你不需要检查 NULL 和它的线程安全。

# javascript - 回答问题后，或者当您无法投票并关闭警告时，javascript闪烁效果

> ID：302046
> 
> 赞同：2
> 
> 时间：2008-11-19T14:36:37.803
> 
> 标签：javascript

有人知道我可以参考的任何资源吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T14:43:02.457

我相信您指的是[JQuery FadeOut 效果](http://docs.jquery.com/Effects/fadeOut#speedcallback)（因为[Stackoverflow 使用 JQuery](http://ttp://blog.stackoverflow.com/2008/09/what-was-stack-overflow-built-with/)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T14:43:21.393

Stackoverflow 使用 JQuery 库，它使用[淡出效果](http://docs.jquery.com/Effects/fadeOut#speedcallback)来描述您所描述的内容。

我从未使用过 JQuery，但我过去曾使用[scriptaculous](http://github.com/madrobby/scriptaculous/wikis)库来做同样的事情。

[Effect.highlight](http://github.com/madrobby/scriptaculous/wikis/effect-highlight)效果可能是您正在寻找的效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T14:45:36.727

您可以在各种 javascript 库中轻松找到此效果以及许多其他效果。我个人喜欢[JQuery](http://ui.jquery.com/repository/real-world/effects/)

# vb.net - VB.NET 中的 And 和 AndAlso 有什么区别？

> ID：302047
> 
> 赞同：272
> 
> 时间：2008-11-19T14:36:44.997
> 
> 标签：vb.net, short-circuiting

`And`在 VB.NET 中，和有什么区别`AndAlso`？我应该使用哪个？

* * *

## 回答 #1

> 赞同：413
> 
> 时间：2008-11-19T14:42:31.787

`And`运算符评估两边，其中当`AndAlso`且仅当左侧为真时评估右侧。

**一个例子：**

```
If mystring IsNot Nothing And mystring.Contains("Foo") Then
  ' bla bla
End If 
```

**上面抛出一个异常，如果`mystring = Nothing`**

```
If mystring IsNot Nothing AndAlso mystring.Contains("Foo") Then
  ' bla bla
End If 
```

**这个不会抛出异常。**

因此，如果您来自 C# 世界，您应该`AndAlso`像使用`&&`.

更多信息在这里： http: [//www.panopticoncentral.net/2003/08/18/the-ballad-of-andalso-and-orelse/](http://www.panopticoncentral.net/2003/08/18/the-ballad-of-andalso-and-orelse/)

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-11-19T14:44:56.353

运算符将在继续之前检查语句中的`And`所有条件，而 Andalso 运算符将在知道条件为假时停止。例如：

```
if x = 5 And y = 7 
```

检查 x 是否等于 5，如果 y 等于 7，则如果两者都为真则继续。

```
if x = 5 AndAlso y = 7 
```

检查 x 是否等于 5。如果不是，它不检查 y 是否为 7，因为它知道条件已经为假。（这称为短路。）

通常，如果有理由在第一部分不正确的情况下明确不检查第二部分，例如如果检查会抛出异常，人们会使用短路方法。例如：

```
If Not Object Is Nothing AndAlso Object.Load() 
```

如果使用`And`代替，即使是`AndAlso`，它仍然会尝试，这会引发异常。`Object.Load()``nothing`

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2014-11-24T18:07:08.383

有趣的是，没有一个答案提到，`And`并且`Or`在 VB.NET 中是位运算符，而`OrElse`和`AndAlso`是严格的布尔运算符。

```
Dim a = 3 OR 5 ' Will set a to the value 7, 011 or 101 = 111
Dim a = 3 And 5 ' Will set a to the value 1, 011 and 101 = 001
Dim b = 3 OrElse 5 ' Will set b to the value true and not evaluate the 5
Dim b = 3 AndAlso 5 ' Will set b to the value true after evaluating the 5
Dim c = 0 AndAlso 5 ' Will set c to the value false and not evaluate the 5 
```

**注意**：考虑非零整数`true`；`Dim e = not 0`将设置`e`为`-1`演示`Not`也是一个位运算符。

`||`和（和`&&`的 C# 版本）分别返回最后计算的表达式，即和。这使您可以使用 C# 中的习语来给出表达式的值 when is or (和一个整数)，否则给出值。语义上的差异可能会让涉足 VB.NET 的 C# 程序员措手不及，因为这种“默认值习语”在 VB.NET 中不起作用。`OrElse``AndAlso``3``5``v || 5``5``v``null``0``v`

**因此，要回答这个问题**：使用`Or`and`And`进行位运算（整数或布尔值）。使用`OrElse`和`AndAlso`“短路”操作以节省时间，或在评估之前测试评估的有效性。`If valid(evaluation) andalso evaluation then`或者`if not (unsafe(evaluation) orelse (not evaluation)) then`

**奖励：**以下内容的价值是什么？

```
Dim e = Not 0 And 3 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-11-19T14:42:59.727

```
If Bool1 And Bool2 Then 
```

评估 Bool1 和 Bool2

```
If Bool1 AndAlso Bool2 Then 
```

当且仅当 Bool1 为真时评估 Bool2。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-01-26T23:34:39.800

只是对于那些说副作用是邪恶的人来说：在一种情况下有两个副作用是好的地方就是同时读取两个文件对象。

```
While File1.Seek_Next_Row() And File2.Seek_Next_Row()
    Str1 = File1.GetRow()
    Str2 = File2.GetRow()
End While 
```

使用`And`确保每次检查条件时都会消耗一行。而`AndAlso`可能会读取最后一行`File1`并离开`File2`而没有消耗一行。

当然上面的代码是行不通的，但是我一直在使用这样的副作用，并且不会像某些人会让你相信的那样认为它是“*坏*”或“*邪恶”的代码。*它易于阅读且高效。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-19T14:45:02.903

AndAlso 很像 And，除了它在 C#、C++ 等中像 && 一样工作。

不同之处在于，如果第一个子句（AndAlso 之前的那个）为真，则永远不会评估第二个子句 - 复合逻辑表达式是“短路的”。

这有时非常有用，例如在如下表达式中：

```
If Not IsNull(myObj) AndAlso myObj.SomeProperty = 3 Then
   ...
End If 
```

如果 myObj 为 null，则在上面的表达式中使用旧的 And 将引发 NullReferenceException。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-11-19T15:01:26.523

另请参阅 Stack Overflow 问题：*[我应该始终使用 AndAlso 和 OrElse 运算符吗？](https://stackoverflow.com/questions/55013)*.

另外：对于那些提到使用`And`表达式的右侧是否有您需要的副作用的人的评论：

如果右侧有您需要的副作用，只需将其移到左侧而不是使用“与”。*如果双方*都有副作用，你才真正需要“和” 。如果你有那么多副作用，你可能做错了什么。一般来说，你真的应该更喜欢 AndAlso。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-12-14T10:44:51.660

一个简单的思考方法是使用更简单的英语

```
If Bool1 And Bool2 Then
If [both are true] Then

If Bool1 AndAlso Bool2 Then
If [first is true then evaluate the second] Then 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-08-16T19:01:56.933

除了上述答案之外，AndAlso 还提供了一种称为短路的调节过程。许多编程语言都像 vb.net 一样内置了此功能，并且可以通过删除不必要的评估来显着提高长条件语句的性能。

另一个类似的条件是 OrElse 条件，它仅在左条件为假时检查右条件，从而在找到真条件后切断不必要的条件检查。

我建议您始终使用短路过程并以最能从中受益的方式构建您的条件语句。例如，首先测试您最有效和最快的条件，以便您仅在绝对必须时运行长时间条件并在其他时间短路。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-06-11T17:12:15.257

对于我们大多数人来说，OrElse 和 AndAlso 可以解决问题，除了一些令人困惑的异常（不到 1% 的情况我们可能不得不使用 Or 和 And）。

尽量不要被人们炫耀他们的布尔逻辑并让它看起来像一门火箭科学而得意忘形。

它非常简单直接，有时您的系统可能无法按预期工作，因为它首先不喜欢您的逻辑。然而，你的大脑不断告诉你，他的逻辑经过了 100% 的测试和验证，并且应该有效。在那一刻停止相信你的大脑，让他再想一想，或者（不是 OrElse 或 OrElse）你强迫自己寻找另一份不需要太多逻辑的工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-12-27T07:10:41.323

## 用文字而不是鳕鱼来理解：

用例：
使用“And”，编译器将检查所有条件，因此如果您检查一个对象可能是“Nothing”，然后您检查它的一个属性，您将遇到运行时错误。
但是如果 AndAlso 在条件中使用第一个“false”，它将检查下一个，因此您不会出现错误。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-10-21T15:53:44.490

使用*And*和*Or*进行逻辑位运算，例如`x% = y% Or 3`

*AndAlso*和*OrElse*用于*If*语句：

`If x > 3 AndAlso x <= 5 Then`

和

`If (x > 3) And (x <= 5) Then`

我怎么看...

另外值得注意的是，（我）建议您在*If*语句中将带有逻辑运算符的方程括起来，这样它们就不会被编译器误解，例如：

`If x = (y And 3) AndAlso ...`

# iphone - 如何根据设备是 3G 还是非 3G 设备来禁止使用应用程序功能？

> ID：302064
> 
> 赞同：2
> 
> 时间：2008-11-19T14:41:13.957
> 
> 标签：iphone, gps

我想只允许拥有 3G 手机的用户使用特定的 GPS 功能。在允许使用该功能之前，如何在设备上运行检查？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T22:22:51.810

以下代码允许您确定正在使用的确切设备，但我首先会考虑一个事实，即 3G 设备实际上可能无法获得 GPS 锁定，因为这样做的过程非常缓慢并且需要更多或天空的视野不太清晰。

对于 iPhone 3G，此方法的结果将是 iPhone1,2

```
- (NSString *)deviceModel
{
    NSString *deviceModel = nil;
    char buffer[32];
    size_t length = sizeof(buffer);
    if (sysctlbyname("hw.machine", &buffer, &length, NULL, 0) == 0) {
        deviceModel = [[NSString alloc] initWithCString:buffer encoding:NSASCIIStringEncoding];
    }
    return [deviceModel autorelease];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-21T05:38:28.320

Why would you stop 1g phone users from using location services? If you are near mapped WiFi you can get decent location results even without a GPS on the device.

Instead you should base your choice of what to do around the current location accuracy, if that is a reason why you seek to disable anything.

# dynamic - SSRS 报表，动态选择字段

> ID：302069
> 
> 赞同：1
> 
> 时间：2008-11-19T14:42:57.120
> 
> 标签：dynamic, reporting-services, field, report

我想创建一个报告，我的报告字段应根据我的输入参数值进行更改。

例如，如果我选择`2 months`，结果中应该有 2 个字段，按月计算。如果我选择`3 weeks`，则每周计算应该有 3 个字段，而不是 2 个月字段。

我如何实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T12:08:02.450

我仍然是 SSRS 的初学者，但我听说过一些方法来处理这个问题：

1.  在某种程度上，您实际上是在谈论单独的查询，具体取决于参数。因此，使用动态查询（将查询构建为字符串表达式）。我看到的最简单的方法是在表达式中使用 IIF 来根据参数值选择一个或另一个存储过程。
2.  如果它几乎是相同的查询，但您希望不同的列可见，那么您可以将列的可见性与基于参数值的表达式联系起来。
3.  如果报告的结构有太多因参数而异，那么您可以使用多个报告。让一个前端报表根据参数值调用其他报表之一，将参数值传递给另一个报表。

我希望这会有所帮助。如果您已经找到解决方案，请告诉我！

# eclipse - 如何在 Netbeans for Java 项目中导入 Eclipse 语法高亮配置文件？

> ID：302076
> 
> 赞同：9
> 
> 时间：2008-11-19T14:44:10.537
> 
> 标签：eclipse, netbeans, syntax-highlighting

我必须同时使用这两个 IDE，并且我想在 Netbeans 中使用 Eclipse 风格的语法高亮。有谁知道如何导入它（或更改任何配置文件）？我已经将 Netbeans 设置为使用 Eclipse 键绑定。

有没有比手动更改 Java 编辑器的每个关键字的颜色更好的方法？

谢谢，

路易斯

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2011-10-18T14:20:02.217

您可以通过转到**工具 > 选项**并选择**字体和颜色**选项卡来更改 NetBeans 中语法突出显示的样式。

为了导入语法突出显示配置文件，请使用上述选项窗口中的**导入按钮。**

可以在此处找到适用于 NetBeans 的类似 Eclipse 的即用型语法突出显示配置文件：[https](https://github.com/Boris-de/eclipsecolors_for_netbeans/downloads) ://github.com/Boris-de/eclipsecolors_for_netbeans/downloads 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-10T02:22:19.457

除了 cristiantolnai 说的，对于 mac 用户，转到**NetBeans** -> **Preferences** -> **Fonts & Colors**和左下角的**导入按钮。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T10:16:21.977

据我所知，这还不可能。两种 IDE 都有不同的系统来存储全局或项目级别的设置。我知道有一个插件可以让您将 Ecpise 项目导入 NetBeans。

# asp.net - 如何强制 SqlDataSource 使用 varchar 参数？

> ID：302082
> 
> 赞同：0
> 
> 时间：2008-11-19T14:45:13.433
> 
> 标签：asp.net, sql-server, gridview, sqldatasource, varchar

我正在使用 SqlDataSource 来填充我的 GridView，因为这两者似乎紧密耦合在一起。由于此网格显示搜索结果，因此我在代码隐藏中编写了一个动态 sql 字符串，该字符串引用了我传入的参数，如下所示：

```
sdsResults.SelectParameters.Add("CodeID", TypeCode.String, strCodeID) 
```

我的问题是 CodeID 字段是一个 varchar 字段。您可能已经体验过，传入要针对 varchar 字段进行评估的 nvarchar 字段可能对 sql 性能非常不利。但是， SelectParameters.Add 只接受 TypeCode 类型，这似乎只给了我 unicode TypeCode.String 作为我可行的选择。

如何强制我的 SqlDataSource 使用 varchars？此时我无法更改数据类型——它是一个 10 年历史的大型应用程序的主键，坦率地说，varchar 适合该应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T15:38:29.990

顺便说一句，我现在的解决方法是让 SqlDataSource 作为 nvarchar 传入参数。然后，我在 SQL 中的第一行将该 nvarchar 参数显式转换为 varchar 变量，并通过我的脚本使用该新的 varchar 变量。

但这似乎很愚蠢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T17:08:36.793

不，不幸的是，它需要传入 System.TypeCode 参数。使用 SqlDbType 最终会出现编译错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-02T14:55:06.237

也许这会起作用：

```
using System.Data;

sdsResults.SelectParameters.Add("CodeID", SqlDbType.VarChar, strCodeID); 
```

# c# - 我可以创建一个可以修改用户界面并且可以中止的线程吗？

> ID：302086
> 
> 赞同：2
> 
> 时间：2008-11-19T14:46:32.170
> 
> 标签：c#, .net, user-interface, multithreading

我的表单上有一个冗长的用户界面操作，只要触发事件就会触发。我不想在操作发生时阻止 UI，而是想在另一个线程中执行操作，并中止该线程并在事件再次触发时重新开始。

但是，为了安全地更改表单上的控件，我需要使用表单的 Invoke 或 BeginInvoke 方法。如果我这样做，那么我可以将所有 UI 操作放在一个函数中，如下所示：

```
private delegate void DoUIStuffDelegate(Thing1 arg1, Thing2 arg2);
private void doUIStuff(Thing1 arg1, Thing2 arg2)
{
    control1.Visible = false;
    this.Controls.Add(arg1.ToButton());
    ...
    control100.Text = arg2.ToString();
}

...

private void backgroundThread()
{
    Thing1 arg1 = new Thing1();
    Thing2 arg2 = new Thing2();

    this.Invoke(new DoUIStuffDelegate(doUIStuff), arg1, arg2);
}

Thread uiStuffThread = null;

public void OnEventFired()
{
    if (uiStuffThread != null)
        uiStuffThread.Abort();

    uiStuffThread = new Thread(backgroundThread);
    uiStuffThread.Start();
} 
```

但如果我这样做，那么我将失去在单独线程中工作的好处。或者，我可以将它们分别放在自己的函数中，如下所示：

```
private delegate void DoUIStuffLine1Delegate();
private delegate void DoUIStuffLine2Delegate(Thing1 arg1);
...

private delegate void DoUIStuffLine100Delegate(Thing2 arg2);

private void doUIStuffLine1()
{
    control1.Visible = false;
}

private void doUIStuffLine2()
{
    this.Controls.Add(arg1.ToButton());
}

...

private void doUIStuffLine100(Thing2 arg2)
{
    control100.Text = arg2.ToString();
}

...

private void backgroundThread()
{
    Thing1 arg1 = new Thing1();
    Thing2 arg2 = new Thing2();

    this.Invoke(new DoUIStuffLine1Delegate(doUIStuffLine1));
    this.Invoke(new DoUIStuffLine2Delegate(doUIStuffLine2), arg1);
    ...
    this.Invoke(new DoUIStuffLine100Delegate(doUIStuffLine100), arg2);
}

Thread uiStuffThread = null;

public void OnEventFired()
{
    if (uiStuffThread != null)
        uiStuffThread.Abort();

    uiStuffThread = new Thread(backgroundThread);
    uiStuffThread.Start();
} 
```

但这是一个可怕的、无法维护的混乱局面。有没有办法创建一个可以修改用户界面的线程，并且我可以中止？这样我就可以做这样的事情：

```
private void doUIStuff()
{
    Thing1 arg1 = new Thing1();
    Thing2 arg2 = new Thing2();

    control1.Visible = false;
    this.Controls.Add(arg1.ToButton());
    ...
    control100.Text = arg2.ToString();
}

Thread uiStuffThread = null;

public void OnEventFired()
{
    if (uiStuffThread != null)
        uiStuffThread.Abort();

    uiStuffThread = this.GetNiceThread(doUIStuff);
    uiStuffThread.Start();
} 
```

无需在我的表单上禁用跨线程检查？理想情况下，我希望能够在线程或方法上设置一些属性，这些属性将所有操作单独包装在委托中，然后在表单的线程上调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T14:54:52.883

首先-不要禁用跨线程检查...表单具有线程亲和性...

第二 - 尽量避免中止线程；这不好 - 您应该更喜欢干净关闭（例如 BackgroundWorker 支持的取消）

一种选择可能是编写一个包装器方法：

*   接受一个类型化的委托（所以你可以更简单地调用它）
*   进行必要的检查（抛出异常以终止和展开）

例如：

```
 void worker_DoWork(object sender, DoWorkEventArgs e)
    {
        try {
          Action<Action> update = thingToDo =>
          {
              if (worker.CancellationPending) throw new SomeException();
              this.Invoke(thingToDo);
          };

          //...
          string tmp = "abc"; // long running
          update(() => this.Text = tmp);

          tmp = "def"; // long running
          update(() => textbox1.Text = tmp);
        } catch (SomeException) {
          e.Cancel = true;
        }
    } 
```

这仍然有点混乱，但可以说比左右中止线程更干净......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T09:13:33.150

我在这里回答你，因为评论太短了。我个人使用BackgroundWorker，当方法完成时，线程被释放。基本上你要做的是：

```
bw = new BackgroundWorkerExtended();
bw.DoWork += (DoWorkEventHandler)work;
bw.WorkerSupportsCancellation = true;
//bw.WorkerReportsProgress = true;
bw.RunWorkerCompleted += (RunWorkerCompletedEventHandler)workCompleted;
//bw.ProgressChanged+=new ProgressChangedEventHandler(bw_ProgressChanged);
bw.RunWorkerAsync(); 
```

另一件事，如果你使用 Post，它将是异步的，如果你使用，Send 它将是同步的。

取消： bw.CancelAsync();

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T12:29:07.140

除了 BackgroundWorker 的建议和相关评论之外，BackgroundWorker 确实将 OnProgress 回调编组回 UI 线程，因此您可以从那里更新内容而无需执行 Invoke()。

我真的无法判断这是否有帮助，无论如何，这是一种无需后台工作人员即可轻松使用的技术。

我怀疑，如果后台任务需要非常了解它正在执行的无数次调用的表单，那么您可能会有一个关注点分离问题，无论如何都值得考虑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T21:57:59.800

您可以使用框架 2 中引入的对象 SynchronizationContext 来避免使用 Invoke。好吧，这是同一件事，您将一件事替换为另一件事，但实际上它更高效、更健壮。无论如何，跨线程需要检查，因为没有这个，你永远无法访问在另一个线程中创建的控件。

阅读以下内容：http: [//www.codeproject.com/KB/cpp/SyncContextTutorial.aspx](http://www.codeproject.com/KB/cpp/SyncContextTutorial.aspx) [http://codingly.com/2008/08/04/invokerequired-invoke-synchronizationcontext/](http://codingly.com/2008/08/04/invokerequired-invoke-synchronizationcontext/)

一些代码来揭示我的想法：

```
 private Thread workerThread;

        private AsyncOperation operation;

        public event EventHandler SomethingHappened;

        public MySynchronizedClass()
        {
            operation = AsyncOperationManager.CreateOperation(null);

            workerThread = new Thread(new ThreadStart(DoWork));

            workerThread.Start();
        }

        private void DoWork()
        {
            operation.Post(new SendOrPostCallback(delegate(object state)
            {
                EventHandler handler = SomethingHappened;

                if(handler != null)
                {
                    handler(this, EventArgs.Empty);
                }
            }), null);

            operation.OperationCompleted();
        } 
```

# user-interface - 如何实现（UI 方面）按钮

> ID：302087
> 
> 赞同：1
> 
> 时间：2008-11-19T14:46:32.667
> 
> 标签：user-interface, layout, user-controls

我正在设计程序的（G）UI，并且偶然发现了一个问题；程序会将一个数字转换成不同的单位，转换成的单位的布局是：

[单位名称（单击时提供信息）] [特殊状态，如果有的话] [文本字段中的输出，也可用于输入（转换为其他单位）]

我希望用户能够将 outputnumber 复制到剪贴板上，而不必弄乱突出显示并找到要按下的正确按钮。所以，我想我会在文本输出字段之后做一个按钮，说“C”或“Copy”之类的东西。

但我昨天在[joelonsoftware.com](http://www.joelonsoftware.com/uibook/chapters/fog0000000063.html)上阅读，发现用户似乎很笨拙。所以我该怎么做？

我考虑了许多不同的选择：

1.  单击文本字段以复制到剪贴板-但是：我也想将其用于输入
2.  按键盘上的一个数字来复制相应的数字 - 但是：可能会超过 10 个，我需要它们来进行新的输入
3.  更大的复制按钮，就像上面所说的“复制” - 嗯，这行得通吗？我知道我喜欢尽可能使用键盘，因此涉及它的解决方案会很好。
4.  每个单元都有自己的空间，所有内容（名称，文本字段等）都适合。如果单击该空间中除名称或文本字段之外的任何位置时它会复制到剪贴板怎么办。- 但是：如果你错过了，意味着单击一个文本字段下方，然后单击另一个文本字段上方怎么办？
5.  但是，当我走的时候突出单位的空间呢？- 仍然可能意味着麻烦...

你怎么看？我想我可能会选择#3 - 更大的复制按钮..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-18T22:25:26.977

如果您觉得复制按钮将是一个非常常见的操作，那么在每个字段之后添加一个复制按钮并没有什么问题。

但是有两个建议：

1.  在外观方面，请确保按钮与字段明确关联。对于文本字段，最好的方法是将复制按钮放在文本字段内（在右侧 - 但要准备好通过根据需要切换其位置来处理 RTL 语言！）。

2.  为避免使其过大，不要使用任何文本，而是使用 Windows 的常用图标进行复制（例如：）![](https://getinvolved-donate.fao.org/pub_libs21/fck_alt/editor/skins/silvernarrow/toolbar/copy.gif)，并将文本放入其工具提示中。如果你这样做，你也可以完全摆脱按钮边框，进一步减小它的大小，尽管你仍然需要一些视觉悬停指示器来明确它是一个活动的 UI 元素。事实上，您可能想要专门复制 Vista/Win7 Explorer（也见于 IE7/8）UI 的位置字段和其中的重新加载图标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T14:53:57.503

如果您不小心点击了错误的区域，您可以在之后点击正确的区域。如果您的问题在于用户不知道他们何时点击了错误的区域，只需突出显示最后点击的区域。

当他们单击文本字段时复制文本字段中的内容是否有问题？那么如果它被用于输入呢？他们只是在输入值*后*复制他们需要的值。

您也可以在文本框中有一个`ctrl-click`或作为副本。`shift-click`

大多数人都知道如何在自己的计算机上复制文本。也许最好的解决方案是在获得焦点时自动突出显示文本框中的所有文本，以便他们可以通过 ctrl-c 复制或开始输入以开始输入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-18T22:14:36.087

无论您做什么，使用操作系统标准的键盘和鼠标事件绑定以及更可取的外观也很重要，否则用户会感到困惑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T15:00:56.943

我认为解决方案 #3 是您列表中最好的，但我想看看您的 GUI 草图。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T02:22:22.513

对于纯粹的速度，键盘是要走的路。用字母 AZ 来复制文本框怎么样？跳过“E”允许输入科学计数法。潜在的速度很高，但可学习性很低。我预计即使页面/窗口上有说明文字，用户也很难弄清楚这个 UI，如果用户必须阅读说明文字，那么所花费的时间可能会抵消 UI 的时间节省，除非用户一直在使用该应用程序（乔尔也正确地写了用户讨厌阅读的内容）。

对于只偶尔使用的应用程序，大按钮是更好的选择，越大越好，正如菲茨定律所预测的那样。并且绝对将其标记为“复制”，而不是“C”而不是图标，以最大限度地提高可学习性。您的其他想法在没有键盘速度的情况下存在可学习性和耐受性问题。

也就是说，我认为你把乔尔所说的太过分了。当然你想消除不必要的点击，但是这种类型的应用程序的典型设计需要单击文本框（默认情况下应该突出显示整个值），然后单击复制菜单项 - 或者更好，Alt-键盘上的 C 或 Ctrl-C。我很难想象节省一次点击或几次键盘按键的任务会值得你的文本框旁边的一堆复制按钮的混乱。你还会有粘贴和清除按钮吗？在某些时候，混乱会比额外的点击减慢用户的速度。

用户多久复制一次？如果每个会话真的要几十次，那么你应该重新考虑整个设计方法，因为一次复制和粘贴*一个*数字会变得乏味。也许您应该支持批处理，一次获取多个数字并以已经适合预期用途的形式输出结果。也许它可以像 Enso 那样在其他应用程序中工作：用户在任何应用程序的任何文档或文本字段中突出显示一个数字，命令转换 - 英尺 - 米，它在文档或字段中已更改。

# eclipse - eclipse的git插件有多稳定？

> ID：302089
> 
> 赞同：166
> 
> 时间：2008-11-19T14:47:23.820
> 
> 标签：eclipse, git, version-control

我打算玩 git，想知道是否有人使用[git 插件进行 eclipse](http://www.eclipse.org/egit/)

我看到它的版本是 0.3.1，想知道是否有人知道它有多稳定/有什么陷阱？

* * *

更新：

如果您使用的是最新版本的 Eclipse，您的帮助菜单有一个“Eclipse Marketplace...”链接。

在“查找”字段中输入“git”。这向我展示了 EGit。

这在热门插件列表中也非常高。

点击安装。比手动添加更新站点位置要容易得多。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-11-19T21:07:58.747

[Github 博客](http://github.com/blog/232-github-and-eclipse)昨天谈到了 Egit 插件：

[http://freshmeat.net/projects/jgit/](http://freshmeat.net/projects/jgit/)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-07-25T19:11:48.687

我将 if 用于日常工作，我发现它很稳定。最近该插件取得了不错的进展并添加了：

*   合并支持，包括一个在 Eclipse 中的合并工具；
*   一个基本的同步视图；
*   读取 .git/info/exclude 和 .gitignore 文件。
*   变基；
*   简化的推拉命令；
*   采摘樱桃。

![Git 存储库视图](https://i.stack.imgur.com/36VLC.png)

请务必浏览[EGit 用户指南](http://wiki.eclipse.org/EGit/User_Guide)，以获得对当前功能的良好概述。

我发现我只需要进入命令行即可进行交互式变基。

作为[一个官方的 Eclipse 项目](http://eclipse.org/egit/)，我相信 EGit 将获得命令行客户端的所有主要功能。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-11-04T15:36:35.493

EGit 仍处于 Eclipse 孵化阶段。您可以使用 Eclipse 更新管理器安装它。

1.  选择帮助 -> 安装新软件...
2.  您的站点列表中可能没有 JGit 更新 URL，因此在“使用：”字段中输入此 URL：[http ://www.jgit.org/updates](http://www.jgit.org/updates)
3.  单击添加...
4.  您现在应该看到 Eclipse Git Plugin - Integration Build (Incubation) 被列为可供安装的可用软件。检查它并单击下一步。
5.  单击下一步并同意许可，它应该被安装。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-11-08T18:59:18.947

您可以将 Git-GUI 与 Eclipse 集成作为 EGit 的替代方案。

请参阅此特定于 Windows 的两部分 YouTube 教程：
[http://www.youtube.com/watch?v=DcM1xOiaidk](http://www.youtube.com/watch?v=DcM1xOiaidk)
[http://www.youtube.com/watch?v=1OrPJClD92s](http://www.youtube.com/watch?v=1OrPJClD92s)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-12-12T11:40:43.483

说实话，它似乎仍然勉强可用，尤其是与 CVS 和 SVN 插件相比。GIT 真的如此不同，以至于拥有四年 CVS 和 SVN 插件经验的开发人员会因为完全不同的 GUI、闻所未闻的命令、两个甚至单个单词的错误消息以及“功能”（如在没有警告的情况下覆盖共享存储库）而完全迷失吗？不要使用它，使用命令行界面。如果您不喜欢命令行界面，请不要使用 GIT。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-07-25T14:27:38.570

同时 EclipseGit 是一个“官方 Eclipse 技术项目”（[09-05-07 GitWiki](http://git.or.cz/gitwiki/EclipsePlugin)）。我不时使用当前**版本 0.5.0 （Wiki 是落后了一步），没有任何问题。**版本比较、提交、还原等运行良好，尽管在使用命令行或其他 Git 客户端时需要手动刷新（F5）（我认为是通常和可接受的 Eclipse 行为）。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-08-16T17:24:40.123

对于 Eclipse 中的命令行视图，请安装 Aptana Eclipse 插件，它为您提供了一个控制台。如果您执行大量终端命令，这将极大地提高生产力。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-08-13T21:38:30.030

我已经在 Eclipse 中为我的一些项目设置了 EGit，并且发现使用命令行界面更容易、更快，而不必向下钻取菜单并单击窗口。

我更喜欢 Eclipse 中的命令行视图之类的东西来完成所有 Git 职责。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-09-06T16:00:11.140

在将工作目录中的文件与之前的文件进行比较时，egit 有一个严重的错误——它会闪烁一个空白选项卡。该错误自 2010 年以来一直存在，但仍未修复。这个在 svn 插件中运行良好的非常基本的功能完全被破坏了。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-19T15:06:07.387

我已经简单地使用了它，但它在几个重要领域仍然缺乏支持（它没有正确地进行重命名/移动，或者其他什么）。也没有可用的更新站点。

我不记得它是哪个版本，但这就像 6 个月前一样。希望现在更好。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-19T21:04:19.193

您可能对这些指针感兴趣：http: [//github.com/blog/232-github-and-eclipse](http://github.com/blog/232-github-and-eclipse)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-04-09T07:35:00.380

还有[gitclipse](http://gitclipse.sourceforge.net/index.php)（基于 JavaGit），但似乎死了。

# version-control - 不同团队的源代码控制？

> ID：302090
> 
> 赞同：0
> 
> 时间：2008-11-19T14:48:00.137
> 
> 标签：version-control

需要这方面的建议...

我有2个团队

1.  使用 InfoPath 2003、BizTalk 2006、MSCRMv3、自定义 .net2 网站和一系列使用 VSStudio 2005 和 TFS 的 Web 服务进行企业 SOA 开发。
2.  Web 团队专注于面向公众的网站 - 使用 Adob​​e Suite、VSStudio 2005。

如前所述，团队 1 有 TFS——我们不进行每日/每周/每晚/集成构建，因为我们不采用这种方法——但我们确实有一个自定义构建/测试解决方案，使用插入到 TFS 中的 msbuild。（它会做其他时髦的事情，比如 zips 用于存档版本/删除 biztalk，在 biztalk 中部署新组件并重新列出 biztalk 以及网站和服务的完整部署）

团队 2 什么都没有……除了版本的 zip 存档。

问题...

*   TFS 很贵
*   两个团队都习惯了源代码控制的“锁定学校”。
*   需要对不同资产进行源代码控制

任何建议 - OSS 或其他明智的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T14:53:50.267

[svn](http://subversion.tigris.org/) - 甚至可以保持你的锁定策略（如果你必须），你也可以开发各种前/后提交钩子来自动化部署/测试等。易于设置和管理。

一些工具和链接

*   [visualsvn 服务器](http://www.visualsvn.com/server)- 免费
*   乌龟 svn - 资源管理器插件 - 免费
*   [视觉 svn](http://www.visualsvn.com) - 视觉工作室插件（每个座位 49 美元）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T14:55:15.053

尽管有费用，我还是会为两个团队选择 TFS。您已经拥有该产品的内部专业知识，并且它支持您喜欢的锁定模型。

如果成本是一个问题，请使用[SVN](http://subversion.tigris.org/) for web 团队，但购买[VisualSVN](http://www.visualsvn.com/)用于 Visual Studio 集成并使用[TortoiseSVN](http://tortoisesvn.tigris.org/)用于 Explorer 集成。我过去发现网络团队倾向于更快地“获得”SVN，尤其是使用 TortoiseSVN。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T14:56:48.433

我使用[Subversion](http://subversion.tigris.org/)工作，在客户端开发人员机器上运行[VisualSVN Server](http://www.visualsvn.com/server/)以及用于 Visual Studio 的[TortoiseSVN](http://tortoisesvn.tigris.org/)和 [AnkhSVN](http://ankhsvn.open.collab.net/)插件，这是一个非常好的设置，而且都是开源的。

# .net - Gridview 上的可扩展行

> ID：302094
> 
> 赞同：1
> 
> 时间：2008-11-19T14:51:10.460
> 
> 标签：.net, asp.net, gridview

有没有人知道如何让 Gridview 中的每一行展开以显示具有元素形式的 DIV 或 PANEL，即文本框的简单形式等。我不需要嵌套的 Gridview 显示结果或使用 DynamicPopulate .

我从 DataGrid Expandable Row 尝试了一些技术，但在尝试访问不属于 Gridview 的变量时遇到了一些问题。任何帮助，将不胜感激。我基本上可以使用 Gridview 中的可编辑模板来做到这一点，但我需要一个更清洁的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-21T10:52:04.300

我最近使用 ASP.Net Listview 控件做了类似的事情 - 与使用标准 Gridview 相比，您可以更好地控制生成的标记。

查看[Matt Berseth 的这篇文章。](http://mattberseth.com/blog/2008/05/modifying_data_with_the_listvi.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-09T01:23:26.853

通过在创建的每个 gridview 行下方的 div 中注入一个 div，我能够成功地做到这一点。在那里，我能够根据我正在使用的数据为他们提供唯一的 ID，在 javascript 中调用扩展函数，并按照我的意愿展开/折叠 div。

这对于 gridview 来说是相当可行的，但转发器也可以像返回表结构的简单 AJAX 实现一样工作。

这是一个与我所做的非常相似的示例：

[http://www.codeproject.com/KB/ajax/ExpandPanelGridView.aspx?display=Print](http://www.codeproject.com/KB/ajax/ExpandPanelGridView.aspx?display=Print)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T15:01:58.783

如果你负担得起的话，有很多 gridview 控件是 ajaxified 并且能够根据需要扩展每一行。我使用了一家公司的一套控制措施，该公司（目前）将保持匿名并且对它们非常满意。

在 gridview 控件上进行谷歌搜索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T19:11:12.587

我有一个解决方案，我在其中创建了一个额外的 Gridview Row，然后将一个 Panel 与我的元素一起注入该行。问题是我的 CLOSE 图像不断消失。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T19:42:48.620

可能不优雅，但我通过用中继器替换 gridview 来做到这一点。它看起来仍然像一个网格视图，但我在每行数据之后放置了一个额外的行，其中包含一个可以通过 javascript 显示的不可见子网格。显然，您将用面板替换子网格。有点花哨，但它工作正常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-21T10:39:14.827

[http://demos.telerik.com/aspnet-ajax/grid/examples/hierarchy/twotablesatlevel/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/grid/examples/hierarchy/twotablesatlevel/defaultcs.aspx)

试试这个

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-26T16:33:45.177

GridView 对于这种功能来说是很糟糕的，因为它严格控制它的 UI。ListView 非常适合实现这一点。

# c# - 如何从 C# 中的泛型方法返回 NULL？

> ID：302096
> 
> 赞同：610
> 
> 时间：2008-11-19T14:51:41.877
> 
> 标签：c#, generics

我有一个使用这个（虚拟）代码的通用方法（是的，我知道 IList 有谓词，但我的代码没有使用 IList 而是使用其他一些集合，无论如何这与问题无关......）

```
static T FindThing<T>(IList collection, int id) where T : IThing, new()
{
    foreach T thing in collecion
    {
        if (thing.Id == id)
            return thing;
    }
    return null;  // ERROR: Cannot convert null to type parameter 'T' because it could be a value type. Consider using 'default(T)' instead.
} 
```

这给了我一个构建错误

> “无法将 null 转换为类型参数 'T'，因为它可能是值类型。请考虑改用 'default(T)'。”

我可以避免这个错误吗？

* * *

## 回答 #1

> 赞同：1074
> 
> 时间：2008-11-19T14:59:53.577

两种选择：

*   Return`default(T)`这意味着`null`如果 T 是引用类型（或可为空的值类型）、`0`for `int`、`'\0'`for`char`等，您将返回。（[默认值表（C# 参考）](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/default-values-table)）
*   将 T 限制为具有`where T : class`约束的引用类型，然后`null`正常返回

* * *

## 回答 #2

> 赞同：103
> 
> 时间：2008-11-19T14:56:23.863

```
return default(T); 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2008-11-19T15:01:39.097

你可以调整你的约束：

```
where T : class 
```

然后返回 null 是允许的。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-11-19T15:02:27.317

将类约束添加为泛型类型的第一个约束。

```
static T FindThing<T>(IList collection, int id) where T : class, IThing, new() 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-08-06T11:15:05.650

1.  如果您有对象，则需要进行类型转换

    ```
    return (T)(object)(employee); 
    ```

2.  如果你需要返回null。

    ```
    return default(T); 
    ```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2015-09-24T06:30:41.817

以下是您可以使用的两个选项

```
return default(T); 
```

或者

```
where T : class, IThing
 return null; 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-19T15:01:37.287

您的另一个选择是将其添加到声明的末尾：

```
 where T : class
    where T: IList 
```

这样，它将允许您返回 null。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-12-02T10:11:55.453

TheSoftwareJedi作品的解决方案，

你也可以使用几个值和可为空的类型来归档它：

```
static T? FindThing<T>(IList collection, int id) where T : struct, IThing
{
    foreach T thing in collecion
    {
        if (thing.Id == id)
            return thing;
    }
    return null;
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2020-01-14T15:02:10.543

为了完整起见，很高兴知道您也可以这样做：

```
return default; 
```

它返回与`return default(T);`

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-19T14:56:38.763

接受错误的建议......以及 user`default(T)`或`new T`.

如果您走那条路线，您必须在代码中添加比较以确保它是有效的匹配项。

否则，可能会考虑“找到匹配”的输出参数。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-03-12T01:24:45.157

这是 Nullable Enum 返回值的工作示例：

```
public static TEnum? ParseOptional<TEnum>(this string value) where TEnum : struct
{
    return value == null ? (TEnum?)null : (TEnum) Enum.Parse(typeof(TEnum), value);
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-04-08T15:12:40.377

因为 IThing 是接口，所以不能使用 null。因此，您必须使用 default(T) 来确定在调用函数之前定义的实际类型 T 的默认值。

```
using System;
using System.Collections.Generic;

public class Program
{
    public static void Main()
    {
        Console.WriteLine("Hello World");

        IThing x = new List<Thing>().FindThing(1);

    }

}

public static class Ext {
    public static T FindThing<T>(this IList<T> collection, int id) where T : IThing, new()
    {
        foreach (T thing in collection)
        {
            if (thing.Id == id) return (T)thing;
        }

        //return null; //not work
        //return (T)null; //not work
        //return null as T; //not work
        return default(T); //work
    }
}

public interface IThing { int Id {get; set;} }
public class Thing : IThing { public int Id {get;set;}} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-07-14T12:52:00.060

上面提供的 2 个答案的另一种选择。如果将返回类型更改为`object`，则可以返回`null`，同时强制转换非空返回。

```
static object FindThing<T>(IList collection, int id)
{
    foreach T thing in collecion
    {
        if (thing.Id == id)
            return (T) thing;
    }
    return null;  // allowed now
} 
```

# asp.net - 是什么导致 IIS 中的应用程序池循环使用？

> ID：302110
> 
> 赞同：71
> 
> 时间：2008-11-19T14:55:39.310
> 
> 标签：asp.net, iis, application-pool

我一直在搜索这方面的信息，但无济于事。我为什么需要这个的背景是[我在这里问的另一个问题](https://stackoverflow.com/questions/271944/storing-temporary-user-files-in-aspnet-in-medium-trust)。更具体地说，在 App_Data 中创建/更新/删除文件会导致池回收吗？

如果有人可以提供导致回收的原因的详细列表，那就太好了。

**更新**：正如两个用户已经注意到的那样，我也很乐意回答指定仅回收 AppDomain 而不是整个池的原因。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-11-19T15:06:48.150

您在另一篇文章中喜欢的文章实际上在这方面做得非常好。

立即回收

*   Web.config 更改
*   Machine.config 更改
*   Global.asax 更改
*   bin目录变化
*   App_Code 更改

延迟回收

可能会在其他位置发生多次更改，但通常我只注意到对 .aspx 或 .cs/.vb 文件的更改。添加临时文本、csv 或其他文件并没有给我带来问题。

注意：这些都是应用程序域回收，而不是池的实际回收。通常，应用程序池将仅根据 IIS 中的设置（请求数、内存限制、空闲时间或计划重启）进行回收。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-11-19T15:02:52.183

两种不同的效果：

*   AppPool 进程是潜在的多个 AppDomain 的宿主。通常，这可以通过许多效果来回收。这些可能是时间（每*n*小时）、请求不足、内存使用等；所有在 IIS 配置管理器中配置。

*   AppDomain（应用程序根的托管实例）可以更频繁地循环，而不会影响 AppPool 中的其他 AppDomain。[Tess 关于 AppDomain 回收的帖子](http://blogs.msdn.com/tess/archive/2006/08/02/asp-net-case-study-lost-session-variables-and-appdomain-recycles.aspx)非常有见地。

您正在写入受监视以进行重新编译的文件夹。这将在某个时候触发 AppDomain 重新创建。

事件日志将帮助您确定启动回收的原因。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-11-20T16:40:45.977

您可能想要打开完整的 AppPool 回收事件日志：

```
cscript adsutil.vbs Set w3svc/AppPools/DefaultAppPool/LogEventOnRecycle 255 
```

您可能还想看看这篇 Scott Guthrie 博客文章：[http](http://weblogs.asp.net/scottgu/archive/2005/12/14/433194.aspx) ://weblogs.asp.net/scottgu/archive/2005/12/14/433194.aspx，它展示了如何在 Global.ASAX 中编写代码以记录Application.End 事件的实际原因。

这对我们诊断几个棘手的问题非常有用 - 特别是一个将日志文件写入 wwwroot 目录的应用程序 - 太多的文件更改导致回收......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T14:57:37.747

这可以根据偏好每天发生，或者在超过进程的最大虚拟内存时发生。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T16:20:34.023

这是一个设置，您可以根据应用程序运行的分钟数或已处理的请求数对其进行操作以回收应用程序池。

它还将回收 web.config 更改和已在此处发布的其他内容。

IIS 重置也可以解决问题，停止/启动服务也是如此。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-23T19:35:27.623

`w3wp.exe`出错了。这导致`Application_Start`被调用`Global.asax`。

为了找出答案，我打开了**Event Viewer**。

在**Windows Logs**下，我去了**Application**。

我看到一个**应用程序错误**：

```
Faulting application name: w3wp.exe, version: 10.0.16299.15, time stamp: 0x0aeb5595
Faulting module name: KERNELBASE.dll, version: 10.0.16299.334, time stamp: 0x6369e29f
Exception code: 0xe0434352
Fault offset: 0x0000000000014008
Faulting process id: 0x2900
Faulting application start time: 0x01d43b16f726cbb9
Faulting application path: c:\windows\system32\inetsrv\w3wp.exe
Faulting module path: C:\WINDOWS\System32\KERNELBASE.dll
Report Id: 998cf55d-2cd9-4b8d-9884-2110e3fd1411
Faulting package full name: 
Faulting package-relative application ID: 
```

# javascript - jQuery Event Keypress：按下了哪个键？

> ID：302122
> 
> 赞同：726
> 
> 时间：2008-11-19T14:59:19.133
> 
> 标签：javascript, jquery, events, bind, keypress

使用 jQuery，当我绑定到 keypress 事件时，如何找出按下了哪个键？

```
$('#searchbox input').bind('keypress', function(e) {}); 
```

我想在`ENTER`按下时触发提交。

**[更新]**

尽管我自己找到了（或更好的：一个）答案，但似乎还有一些变化的空间；）

`keyCode`和-之间有区别吗`which`- 特别是如果我只是在寻找`ENTER`, 永远不会是 unicode 键？

某些浏览器是否提供一种属性而其他浏览器提供另一种？

* * *

## 回答 #1

> 赞同：863
> 
> 时间：2008-11-19T15:07:10.503

其实这样更好：

```
 var code = e.keyCode || e.which;
 if(code == 13) { //Enter keycode
   //Do something
 } 
```

* * *

## 回答 #2

> 赞同：136
> 
> 时间：2008-11-19T15:05:29.027

试试这个

```
$('#searchbox input').bind('keypress', function(e) {
    if(e.keyCode==13){
        // Enter pressed... do anything here...
    }
}); 
```

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2008-11-19T16:22:34.970

如果您使用的是 jQuery UI，您可以翻译常用键码。在[ui/ui/ui.core.js](https://github.com/jquery/jquery-ui/blob/master/ui/keycode.js)：

```
$.ui.keyCode = { 
    ...
    ENTER: 13, 
    ...
}; 
```

tests/simulate/jquery.simulate.js 中也有一些翻译，但我在核心 JS 库中找不到任何翻译。请注意，我只是grep'ed来源。也许还有其他方法可以摆脱这些神奇的数字。

您还可以使用 String.charCodeAt 和 .fromCharCode：

```
>>> String.charCodeAt('\r') == 13
true
>>> String.fromCharCode(13) == '\r'
true 
```

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2010-03-05T17:47:19.950

鉴于您使用的是 jQuery，您绝对应该使用 .which。是的，不同的浏览器设置了不同的属性，但是 jQuery 会对它们进行规范化并在每种情况下设置 .which 值。请参阅[http://api.jquery.com/keydown/](http://api.jquery.com/keydown/)上的文档，它指出：

> > 要确定按下了哪个键，我们可以检查传递给处理函数的事件对象。虽然浏览器使用不同的属性来存储这些信息，但 jQuery 对 .which 属性进行了规范化，因此我们可以可靠地使用它来检索关键代码。

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2010-05-12T22:58:24.353

...此示例阻止表单提交（通常是捕获击键 #13 时的基本意图）：

```
$('input#search').keypress(function(e) {
  if (e.which == '13') {
     e.preventDefault();
     doSomethingWith(this.value);
   }
}); 
```

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2010-05-07T15:35:42.417

```
 // in jquery source code...
 if (!event.which && ((event.charCode || event.charCode === 0) ? event.charCode : event.keyCode)) {
     event.which = event.charCode || event.keyCode;
 }

 // So you have just to use
 $('#searchbox input').bind('keypress', function(e) {
     if (e.which === 13) {
         alert('ENTER WAS PRESSED');
     }
 }); 
```

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2013-01-08T01:27:05.523

编辑：这仅适用于 IE ...

我意识到这是一个旧帖子，但有人可能会觉得这很有用。

键事件是映射的，因此您也可以使用键值来使其更具可读性，而不是使用键代码值。

```
$(document).ready( function() {
    $('#searchbox input').keydown(function(e)
    {
     setTimeout(function ()
     { 
       //rather than using keyup, you can use keydown to capture 
       //the input as it's being typed.
       //You may need to use a timeout in order to allow the input to be updated
     }, 5);
    }); 
    if(e.key == "Enter")
    {
       //Enter key was pressed, do stuff
    }else if(e.key == "Spacebar")
    {
       //Spacebar was pressed, do stuff
    }
}); 
```

这是我从这个[博客获得的带有映射键的备忘单](http://mikemurko.com/general/jquery-keycode-cheatsheet/) ![在此处输入图像描述](https://i.stack.imgur.com/FgAVt.png)

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2010-07-20T19:21:19.353

查看支持组合键的优秀[jquery.hotkeys 插件](https://github.com/jeresig/jquery.hotkeys)：

```
$(document).bind('keydown', 'ctrl+c', fn); 
```

* * *

## 回答 #9

> 赞同：19
> 
> 时间：2017-08-06T16:55:01.107

这几乎是 keyCodes 的完整列表：

```
3: "break",
8: "backspace / delete",
9: "tab",
12: 'clear',
13: "enter",
16: "shift",
17: "ctrl",
18: "alt",
19: "pause/break",
20: "caps lock",
27: "escape",
28: "conversion",
29: "non-conversion",
32: "spacebar",
33: "page up",
34: "page down",
35: "end",
36: "home ",
37: "left arrow ",
38: "up arrow ",
39: "right arrow",
40: "down arrow ",
41: "select",
42: "print",
43: "execute",
44: "Print Screen",
45: "insert ",
46: "delete",
48: "0",
49: "1",
50: "2",
51: "3",
52: "4",
53: "5",
54: "6",
55: "7",
56: "8",
57: "9",
58: ":",
59: "semicolon (firefox), equals",
60: "<",
61: "equals (firefox)",
63: "ß",
64: "@ (firefox)",
65: "a",
66: "b",
67: "c",
68: "d",
69: "e",
70: "f",
71: "g",
72: "h",
73: "i",
74: "j",
75: "k",
76: "l",
77: "m",
78: "n",
79: "o",
80: "p",
81: "q",
82: "r",
83: "s",
84: "t",
85: "u",
86: "v",
87: "w",
88: "x",
89: "y",
90: "z",
91: "Windows Key / Left ⌘ / Chromebook Search key",
92: "right window key ",
93: "Windows Menu / Right ⌘",
96: "numpad 0 ",
97: "numpad 1 ",
98: "numpad 2 ",
99: "numpad 3 ",
100: "numpad 4 ",
101: "numpad 5 ",
102: "numpad 6 ",
103: "numpad 7 ",
104: "numpad 8 ",
105: "numpad 9 ",
106: "multiply ",
107: "add",
108: "numpad period (firefox)",
109: "subtract ",
110: "decimal point",
111: "divide ",
112: "f1 ",
113: "f2 ",
114: "f3 ",
115: "f4 ",
116: "f5 ",
117: "f6 ",
118: "f7 ",
119: "f8 ",
120: "f9 ",
121: "f10",
122: "f11",
123: "f12",
124: "f13",
125: "f14",
126: "f15",
127: "f16",
128: "f17",
129: "f18",
130: "f19",
131: "f20",
132: "f21",
133: "f22",
134: "f23",
135: "f24",
144: "num lock ",
145: "scroll lock",
160: "^",
161: '!',
163: "#",
164: '$',
165: 'ù',
166: "page backward",
167: "page forward",
169: "closing paren (AZERTY)",
170: '*',
171: "~ + * key",
173: "minus (firefox), mute/unmute",
174: "decrease volume level",
175: "increase volume level",
176: "next",
177: "previous",
178: "stop",
179: "play/pause",
180: "e-mail",
181: "mute/unmute (firefox)",
182: "decrease volume level (firefox)",
183: "increase volume level (firefox)",
186: "semi-colon / ñ",
187: "equal sign ",
188: "comma",
189: "dash ",
190: "period ",
191: "forward slash / ç",
192: "grave accent / ñ / æ",
193: "?, / or °",
194: "numpad period (chrome)",
219: "open bracket ",
220: "back slash ",
221: "close bracket / å",
222: "single quote / ø",
223: "`",
224: "left or right ⌘ key (firefox)",
225: "altgr",
226: "< /git >",
230: "GNOME Compose Key",
231: "ç",
233: "XF86Forward",
234: "XF86Back",
240: "alphanumeric",
242: "hiragana/katakana",
243: "half-width/full-width",
244: "kanji",
255: "toggle touchpad" 
```

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2009-02-17T11:18:17.500

```
$(document).ready(function(){
    $("#btnSubmit").bind("click",function(){$('#'+'<%=btnUpload.ClientID %>').trigger("click");return false;});
    $("body, input, textarea").keypress(function(e){
        if(e.which==13) $("#btnSubmit").click();
    });
}); 
```

希望这可以帮助你！！！

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2008-11-19T15:01:43.760

好吧，我瞎了：

```
e.which 
```

将包含密钥的 ASCII 码。

请参阅[https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/which](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/which)

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2010-03-05T17:41:17.123

这是对各种浏览器行为的详细描述[http://unixpapa.com/js/key.html](http://unixpapa.com/js/key.html)

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2012-02-10T19:59:42.983

我将用这一行补充解决方案代码`e.preventDefault();`。在表单的输入字段的情况下，我们不参加在输入按下时提交

```
var code = (e.keyCode ? e.keyCode : e.which);
 if(code == 13) { //Enter keycode
   e.preventDefault();
   //Do something
 } 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2018-02-18T19:24:23.730

# 使用`event.key`和现代的 JS！

*没有数字代码*了。您可以直接检查密钥。例如`"Enter"`、`"LeftArrow"`、`"r"`或`"R"`。

```
const input = document.getElementById("searchbox");
input.addEventListener("keypress", function onEvent(event) {
    if (event.key === "Enter") {
        // Submit
    }
    else if (event.key === "Q") {
        // Play quacking duck sound, maybe...
    }
}); 
```

[Mozilla 文档](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key)

[支持的浏览器](http://caniuse.com/#feat=keyboardevent-key)

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2011-04-19T14:54:20.710

添加隐藏提交，而不是隐藏类型，只需使用 style="display:none" 进行简单提交。这是一个示例（从代码中删除了不必要的属性）。

```
<form>
  <input type="text">
  <input type="submit" style="display:none">
</form> 
```

它将本机接受输入键，不需要 JavaScript，适用于每个浏览器。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2011-07-14T15:37:41.770

巫婆 ;）

```
/*
This code is for example. In real life you have plugins like :
https://code.google.com/p/jquery-utils/wiki/JqueryUtils
https://github.com/jeresig/jquery.hotkeys/blob/master/jquery.hotkeys.js
https://github.com/madrobby/keymaster
http://dmauro.github.io/Keypress/

http://api.jquery.com/keydown/
http://api.jquery.com/keypress/
*/

var event2key = {'97':'a', '98':'b', '99':'c', '100':'d', '101':'e', '102':'f', '103':'g', '104':'h', '105':'i', '106':'j', '107':'k', '108':'l', '109':'m', '110':'n', '111':'o', '112':'p', '113':'q', '114':'r', '115':'s', '116':'t', '117':'u', '118':'v', '119':'w', '120':'x', '121':'y', '122':'z', '37':'left', '39':'right', '38':'up', '40':'down', '13':'enter'};

var documentKeys = function(event) {
    console.log(event.type, event.which, event.keyCode);

    var keycode = event.which || event.keyCode; // par exemple : 112
    var myKey = event2key[keycode]; // par exemple : 'p'

    switch (myKey) {
        case 'a':
            $('div').css({
                left: '+=50'
            });
            break;
        case 'z':
            $('div').css({
                left: '-=50'
            });
            break;
        default:
            //console.log('keycode', keycode);
    }
};

$(document).on('keydown keyup keypress', documentKeys); 
```

演示：http: [//jsfiddle.net/molokoloco/hgXyq/24/](http://jsfiddle.net/molokoloco/hgXyq/24/)

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2012-10-12T16:36:36.760

这是一个 jquery 扩展，它将处理按下的回车键。

```
(function ($) {
    $.prototype.enterPressed = function (fn) {
        $(this).keyup(function (e) {
            if ((e.keyCode || e.which) == 13) {
                fn();
            }
        });
    };
}(jQuery || {}));

$("#myInput").enterPressed(function() {
    //do something
}); 
```

可以在这里找到一个工作示例 [http://jsfiddle.net/EnjB3/8/](http://jsfiddle.net/EnjB3/8/)

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2011-11-17T11:07:29.357

```
$(document).bind('keypress', function (e) {
    console.log(e.which);  //or alert(e.which);

}); 
```

你应该有 firbug 才能在控制台中看到结果

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2014-05-08T11:34:13.630

一些浏览器使用keyCode，其他浏览器使用keyCode。如果你使用 jQuery，你可以可靠地使用 which 作为 jQuery 标准化的东西。实际上，

```
$('#searchbox input').bind('keypress', function(e) {
    if(e.keyCode==13){

    }
}); 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2011-09-14T10:37:53.050

根据 Kilian 的回答：

如果**只输入**按键很重要：

```
<form action="javascript:alert('Enter');">
<input type=text value="press enter">
</form> 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2011-12-16T13:51:49.117

我做的最简单的方法是：

```
$("#element").keydown(function(event) {
    if (event.keyCode == 13) {
        localiza_cep(this.value);
    }
}); 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2015-06-30T07:06:04.540

我刚刚为 jQuery 制作了一个插件，它允许更简单的`keypress`事件。您不必找到号码并将其输入，您所要做的就是：

# 如何使用它

1.  包括我在下面的代码
2.  运行此代码：

```
$(document).keydown(function(e) {
    if (getPressedKey(e) == theKeyYouWantToFireAPressEventFor /*Add 'e.ctrlKey here to only fire if the combo is CTRL+theKeyYouWantToFireAPressEventFor'*/) {
        // Your Code To Fire When You Press theKeyYouWantToFireAPressEventFor 
    }
}); 
```

就是这么简单。请注意，这*不是*`theKeyYouWantToFireAPressEventFor`一个数字，而是一个字符串（例如，按下时触发，按下时触发，或者在数字的情况下，只是，没有引号。按下时会触发。）*`"a"``A``"ctrl"``CTRL *(control)*``1``1`*

 *# 示例/代码：

```
function getPressedKey(e){var a,s=e.keyCode||e.which,c=65,r=66,o=67,l=68,t=69,f=70,n=71,d=72,i=73,p=74,u=75,h=76,m=77,w=78,k=79,g=80,b=81,v=82,q=83,y=84,j=85,x=86,z=87,C=88,K=89,P=90,A=32,B=17,D=8,E=13,F=16,G=18,H=19,I=20,J=27,L=33,M=34,N=35,O=36,Q=37,R=38,S=40,T=45,U=46,V=91,W=92,X=93,Y=48,Z=49,$=50,_=51,ea=52,aa=53,sa=54,ca=55,ra=56,oa=57,la=96,ta=97,fa=98,na=99,da=100,ia=101,pa=102,ua=103,ha=104,ma=105,wa=106,ka=107,ga=109,ba=110,va=111,qa=112,ya=113,ja=114,xa=115,za=116,Ca=117,Ka=118,Pa=119,Aa=120,Ba=121,Da=122,Ea=123,Fa=114,Ga=145,Ha=186,Ia=187,Ja=188,La=189,Ma=190,Na=191,Oa=192,Qa=219,Ra=220,Sa=221,Ta=222;return s==Fa&&(a="numlock"),s==Ga&&(a="scrolllock"),s==Ha&&(a="semicolon"),s==Ia&&(a="equals"),s==Ja&&(a="comma"),s==La&&(a="dash"),s==Ma&&(a="period"),s==Na&&(a="slash"),s==Oa&&(a="grave"),s==Qa&&(a="openbracket"),s==Ra&&(a="backslash"),s==Sa&&(a="closebracket"),s==Ta&&(a="singlequote"),s==B&&(a="ctrl"),s==D&&(a="backspace"),s==E&&(a="enter"),s==F&&(a="shift"),s==G&&(a="alt"),s==H&&(a="pause"),s==I&&(a="caps"),s==J&&(a="esc"),s==L&&(a="pageup"),s==M&&(a="padedown"),s==N&&(a="end"),s==O&&(a="home"),s==Q&&(a="leftarrow"),s==R&&(a="uparrow"),s==S&&(a="downarrow"),s==T&&(a="insert"),s==U&&(a="delete"),s==V&&(a="winleft"),s==W&&(a="winright"),s==X&&(a="select"),s==Z&&(a=1),s==$&&(a=2),s==_&&(a=3),s==ea&&(a=4),s==aa&&(a=5),s==sa&&(a=6),s==ca&&(a=7),s==ra&&(a=8),s==oa&&(a=9),s==Y&&(a=0),s==ta&&(a=1),s==fa&&(a=2),s==na&&(a=3),s==da&&(a=4),s==ia&&(a=5),s==pa&&(a=6),s==ua&&(a=7),s==ha&&(a=8),s==ma&&(a=9),s==la&&(a=0),s==wa&&(a="times"),s==ka&&(a="add"),s==ga&&(a="minus"),s==ba&&(a="decimal"),s==va&&(a="devide"),s==qa&&(a="f1"),s==ya&&(a="f2"),s==ja&&(a="f3"),s==xa&&(a="f4"),s==za&&(a="f5"),s==Ca&&(a="f6"),s==Ka&&(a="f7"),s==Pa&&(a="f8"),s==Aa&&(a="f9"),s==Ba&&(a="f10"),s==Da&&(a="f11"),s==Ea&&(a="f12"),s==c&&(a="a"),s==r&&(a="b"),s==o&&(a="c"),s==l&&(a="d"),s==t&&(a="e"),s==f&&(a="f"),s==n&&(a="g"),s==d&&(a="h"),s==i&&(a="i"),s==p&&(a="j"),s==u&&(a="k"),s==h&&(a="l"),s==m&&(a="m"),s==w&&(a="n"),s==k&&(a="o"),s==g&&(a="p"),s==b&&(a="q"),s==v&&(a="r"),s==q&&(a="s"),s==y&&(a="t"),s==j&&(a="u"),s==x&&(a="v"),s==z&&(a="w"),s==C&&(a="x"),s==K&&(a="y"),s==P&&(a="z"),s==A&&(a="space"),a}

$(document).keydown(function(e) {
  $("#key").text(getPressedKey(e));
  console.log(getPressedKey(e));
  if (getPressedKey(e)=="space") {
    e.preventDefault();
  }
  if (getPressedKey(e)=="backspace") {
    e.preventDefault();
  }
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<p>The Pressed Key: <span id=key></span></p>
```

因为长版太……好吧……太长了，我为它做了一个 PasteBin 链接：http:
[//pastebin.com/VUaDevz1](http://pastebin.com/VUaDevz1)

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2019-11-06T06:44:51.280

和已`event.keyCode`弃用`event.which`。请参阅上面的@Gibolt 答案或查看文档：[https ://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent)

`event.key`应改为使用

`keypress`事件也被弃用： [https ://developer.mozilla.org/en-US/docs/Web/API/Document/keypress_event](https://developer.mozilla.org/en-US/docs/Web/API/Document/keypress_event)

* * *

## 回答 #24

> 赞同：-9
> 
> 时间：2010-02-09T19:25:46.080

试试这个：

```
jQuery('#myInput').keypress(function(e) {
    code = e.keyCode ? e.keyCode : e.which;
    if(code.toString() == 13) {
        alert('You pressed enter!');
    }
}); 
```

# java - 打包具有大量依赖项的 Java 应用程序的最佳方法是什么？

> ID：302126
> 
> 赞同：12
> 
> 时间：2008-11-19T14:59:42.487
> 
> 标签：java, eclipse, deployment

我正在使用 eclipse 编写一个 java 应用程序，它引用了一些外部 jars，并且需要一些配置文件供用户访问。

1.  将其打包以进行部署的最佳方法是什么？

2.  我的理解是你不能把罐子放在另一个罐子文件里，这是正确的吗？

3.  我可以将我的配置文件保留在 jar 之外并仍然在代码中引用它们吗？或者配置文件的路径应该是命令行参数？

4.  Eclipse 是否有任何第三方插件可以帮助简化此操作？我目前正在使用一个 ant 构建文件，但我不确定我知道我在做什么。

5.  Visual Studio 中是否有类似的部署项目，它会找出您需要的一切并制作一个安装程序？我以前使用过 install4j，如果没有像 .Net 部署项目那样自动化的话，它非常强大。

干杯。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T15:11:05.397

没有一种“最好的方法”。这取决于您部署的是 Swing 应用程序、webstart、applet、库还是 Web 应用程序。每个都是不同的。

关于第 2 点，您是正确的。Jar 文件不能包含其他 jar 文件。（嗯，从技术上讲他们可以，只是内部 jar 文件不会在您的类路径上，实际上意味着 jar 文件不包含 jar 文件）。

在第 3 点，您当然可以引用 jar 文件之外的配置文件。您通常可以将配置文件作为文件或资源引用。如果您使用资源方法，它通常来自类路径（可以在 jar 中）。如果使用文件，则指定文件名（不在 jar 中）。

一般来说，大多数 Java 开发人员会使用[Apache Ant](http://ant.apache.org)来实现部署。它有据可查，所以看看。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-19T15:21:52.130

(1) 您可能希望考虑的替代 ant 是[maven](http://maven.apache.org/)。

可以在[这里](http://maven.apache.org/run-maven/index.html)找到对 maven 的简要介绍。

对于构建 JAR，maven 有[jar](http://maven.apache.org/maven-1.x/plugins/jar/properties.html)插件，它可以自动执行确保所有依赖 jar 都列在 jar 清单中的过程。

如果您使用的是 eclipse，请同时下载[maven 集成](http://m2eclipse.codehaus.org/)。

(2) 另一种选择是使用[OneJar](http://one-jar.sourceforge.net/)（免责声明：我自己没有尝试过）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-19T15:54:41.343

答案因您正在构建的类型而异。

如果您正在构建一个库，最好将您的工作作为 jar 文件分发。可以通过 jar 清单中的 Class-path 属性引用您的 jar 依赖项，尽管我通常认为这很不酷。该属性是为 applet 设计的，并且在库中很少使用，因此当这种技术将内容拉入类路径时（尤其是用户可能已经在使用的常见内容），您可能会遇到意外的版本冲突。而且很难追查为什么你会看到他们。

使用 pom 信息将 jar 发布到 Maven 存储库以跟踪依赖关系对于库来说也是一个很好的选择。如果您这样做，请在您的文档中发布您的 Maven 坐标！

如果您正在构建应用程序，两个流行的选择是分发 zip/tar/任何部署结构或使用安装程序。如果该程序是一种服务器式的东西，那么前者更为常见。后者对于客户来说更常见。通常，安装程序仅用于布置部署结构，并且可能会执行一些额外的任务，例如在特定于操作系统的位置进行安装。

要构建您的部署结构（又名“工具包”），您需要在您使用的任何构建系统中创建一个可重复的过程。Ant 有很多这样的例子，Maven 有可以提供帮助的程序集插件。通常，您需要包含一个 jar 代码、任何依赖项、启动程序的脚本、可能是 JRE，以及您可能需要的任何其他资源。

如果您想创建安装程序，有很多免费和商业选项。我认识的一些人最近对免费的[IzPack](http://izpack.org)有很好的体验，但请查看您的选择。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-28T12:57:58.533

你应该试试[FatJar](http://fjep.sourceforge.net/)。这是一个 Eclipse 插件，只需在项目上单击鼠标右键，就可以构建一个 JAR 文件，其中包含运行应用程序所需的一切，包括必要的第三方 JAR。

我们每天都使用它，结合[JSmooth](http://jsmooth.sourceforge.net/)来创建可执行文件，将我们的软件包部署给我们的客户，并且像一个魅力一样工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T05:48:10.460

好吧，如果您说的是独立桌面应用程序的部署：

**在我们切换到 web start 之前，**我们已经创建了三个部署档案，一个用于 windows，一个用于 mac，一个用于其他平台。

在 Windows 上，我们已经成功地使用了[Nullsoft Scriptable Install System](http://nsis.sourceforge.net/Main_Page)（以被较早的 winamp 版本使用而闻名）及其[ant task](http://nsisant.sourceforge.net/)，尽管有一些缺点：

*   它仅在 Windows AFAIR 上可用
*   您必须手动完成一些工作，即自定义向导创建的脚本 AFAIR

另一方面，它可以使用开始菜单条目创建 Windows 安装。还有一个用于集成 NSIS shell 脚本编辑的 eclipse 插件。

在 Mac OS X 上，有一个[ant 任务](http://informagen.com/JarBundler/)可以从您的 java 文件创建一个 .app 文件，这样您就可以像启动本机 os x 应用程序一样启动它。但请注意不要将任何设置写入您的主目录，而是使用应用程序目录。

对于其他人，您必须期望他们在 un*x 环境中并使用 shell 脚本部署您的应用程序以启动应用程序。

在任何情况下，您都可能必须部署自定义[策略文件](http://java.sun.com/j2se/1.5.0/docs/guide/security/PolicyFiles.html)以获得应用程序的访问权限。

如果你想摆脱所有的包装和东西，你应该认真考虑使用[web start](http://java.sun.com/docs/books/tutorial/deployment/webstart/deploying.html)。自从切换到它之后，我们节省了很多时间，即简化了我们的部署过程，负责更新等。

**2014 年更新**

使用[maven 程序集插件](http://maven.apache.org/plugins/maven-assembly-plugin/usage.html)，请参阅“创建可执行 jar”部分

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T15:02:46.613

蚂蚁。这不是世界上最好的东西，但它是标准的，它是 apache，它可以工作。网上有一些很好的例子，如何为任何人制作一个简单的 build.xml，它有一些特性，比如“战争”任务，它知道如何将所有基本的东西（类、web.xml 等）放在 jar 文件中为你。您还可以告诉它获取其他配置文件和 jars，它会很乐意这样做。编译什么也很聪明。你给它一个目录，它会找到所有的 java 文件并只在它们的类文件过期时构建它们，所以你可以毫不费力地免费获得一些传统的 make 功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T15:31:07.507

您可以查看其他 java 项目（例如 JMeter、SquirrelSQL、JEdit、Cernunnos 等）。每个人对应用程序的打包方式略有不同，因此在查看这些内容时请考虑您的目标。

# stored-procedures - 将大量 XML 传输到 CLR 存储过程

> ID：302131
> 
> 赞同：2
> 
> 时间：2008-11-19T15:00:27.583
> 
> 标签：stored-procedures, clr

我正在编写一个 CLR 存储过程，以字符串形式获取 XML 数据，然后使用这些数据执行某些命令等。

我遇到的问题是，每当我尝试发送长度超过 4000 个字符的 XML 时，我都会收到错误消息，因为 XmlDocument 对象无法加载 XML，因为缺少很多结束标记，原因是文本在 4000 个字符后被截断。

我认为这个问题归结为 CLR 存储过程将字符串参数映射到 nvarchar(4000)，当我想像 nvarchar(max) 或 ntext 这样的东西是我需要的。

不幸的是，我找不到从 .NET 类型到 ntext 的映射，并且字符串类型自动转到 nvarchar(max)。

有谁知道我的问题的解决方案？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T19:15:53.493

我想你想要`System.Data.SqlTypes.SqlXml`那种类型。例如：

```
using System;
using System.Data;
using System.Data.SqlClient;
using System.Data.SqlTypes;
using System.Xml;

using Microsoft.SqlServer.Server;

public partial class StoredProcedures
{
    [SqlProcedure]
    public static void StoredProcedure1(SqlXml data)
    {
        using (XmlReader reader = data.CreateReader())
        {
            reader.MoveToContent();
            // Do stuff here.
        }
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T23:32:40.023

对于 CLR 存储过程，char、varchar、text、ntext、image、cursor、用户定义的表类型和表不能指定为参数。

您应该能够使用 nvarchar(max) 类型而不是 ntext 类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T14:49:34.577

ntext 将在 SQL Server 的未来版本中消失，因此您应该改用 nvarchar(MAX)。

# database-design - 用于标记多种类型实体的数据库设计

> ID：302136
> 
> 赞同：6
> 
> 时间：2008-11-19T15:01:37.223
> 
> 标签：database-design, tagging

我目前正在设计一个用于存储食谱的数据库模式。在这个数据库中，我希望能够标记不同类型的实体（配料、配方发布者、配方等）。所以一个标签有多个 n:m 关系。如果我使用“三表设计”，这将导致我拥有的每种实体类型（配方、成分、发行人）的表（交叉表）。换句话说，每次我介绍一个实体时，我都必须为其添加一个交叉表。

我正在考虑创建一个具有唯一 id 的表，所有实体都引用该表，以及标签表和“唯一 id”表之间的：m 关系。这样，“唯一 id”表和标签表之间只有一个交叉表。

以防有些人会认为这个问题已经被问过了。我已经阅读了[Database Design for Tagging](https://stackoverflow.com/questions/48475/database-design-for-tagging)。那里提到了三张桌子的设计。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T17:53:12.383

我认为为所有标记分配使用一个表没有任何问题（与多个表相反 - 每个可标记实体一个表）。

然而，你设计中的一个重要细节对我来说仍然是模棱两可的：如果你打算有一些类似的东西

```
- - - - - - - - - -
Tag
    ID           // PK
    Name
    ...

- - - - - - - - - -
Taggable
    ID           // PK
    ...

- - - - - - - - - -
TagAssignment
    Tag_ID       // FK -> Tag.ID
    Taggable_ID  // FK -> Taggable.ID
    ...

- - - - - - - - - -
EntityOne
    Taggable_ID  // FK -> Taggable.ID
    ...

- - - - - - - - - -
EntityTwo
    Taggable_ID  // FK -> Taggable.ID
    ... 
```

那么您的实体类是否将拥有自己的主键，或者您将使用`EntityOne.TaggableID`and作为and`EntityTwo.TaggableID`的事实上的主键？`EntityOne``EntityTwo`

在大多数情况下，我会谨慎并让实体拥有自己的 ID：

```
- - - - - - - - - -
EntityOne
    ID           // PK
    Taggable_ID  // FK -> Taggable.ID (Nullable)
    ...

- - - - - - - - - -
EntityTwo
    ID           // PK
    Taggable_ID  // FK -> Taggable.ID (Nullable)
    ... 
```

这不会要求每个实体都有相应的实例，`Taggable`因此也不会要求与实体相关的每段代码也都知道标签。但是，如果标记将在系统中真正无处不在，并且如果您确定不需要任何其他实体的“共同祖先”（即，除了`Taggable`），那么您可能会在没有“内在”的情况下逃脱实体的 ID。

**注意**：我从来没有尝试过实现这样的东西，所以我所有的建议都是纯理论的。所以如果我没有看到一些明显的缺陷，请不要拍我。:-)

* * *

回应比尔·卡尔文的评论：

你是对的：上面描述的设计并没有阻止多个实体引用同一个`Taggable`. 但：

1.  就像我说的，一切都取决于要求。如果我们确定它将`Taggable`成为实体的唯一“共同祖先”，那么可以将`Taggable_ID`FK 用作实体的 PK。但是，例如，如果某些恰好是“可标记”的实体也必须是“可观察的”（想想通知、通知时间表等）或“任何可以的”:-) 怎么办？我们可以通过将任何实体与任何实体紧密联系来切断所有这些“能力”`Taggable`吗？

2.  如果你真的想对一个可标记的实体约束进行数据库级别的强制...... AFAIK，至少有一种常见的方法可以做到这一点而不使 FK 充当 PK：通过引入可标记的“类型”（其中无论如何可能对其他一些功能有用）。

类似这样的东西会让我们吃蛋糕并吃掉它：

```
- - - - - - - - - -
Taggable
    ID           // PK
    Type        
    ... 
    - - - - - - - -
    Constraint: (ID, Type) is unique

- - - - - - - - - -
EntityOne
    ID
    Taggable_ID   
    Taggable_Type // Constraint: always = 'EntityOne'
    ...
    - - - - - - - -
    FK: (Taggable_ID, Taggable_Type) -> (Taggable.ID, Taggable.Type) 
```

当然，所有这些都比将实体绑定到可标记对象要复杂得多。但我只是想讨论在我的拙见中，除了原始问题提供的狭隘图片之外，还应该考虑什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T18:13:43.497

我会说这取决于你想如何使用标签。

*如果*您一次只搜索一种类型的实体，我想您可以为要标记的每种实体类型创建一个额外的交集表。换句话说，说“给我看带有'yummy'标签的成分”是很正常的，但不清楚这意味着“给我看带有'yummy'标签的成分和食谱发布者。”在这个在这种情况下，每个实体有一个单独的交集表就可以了。

但是，如果您确实需要使用给定标签搜索所有类型的所有实体，那么使用单个“ID”表会更容易。使用您定义为主键和外键的列使所有实体表指向它：

```
CREATE TABLE Recipes (
  recipe_id INT NOT NULL PRIMARY KEY, -- not auto-generated
  FOREIGN KEY (recipe_id) REFERENCES Taggables(id)
); 
```

这个计划的唯一弱点是你不能阻止两个中的一行`Recipes`和`Ingredients`指向同一行`Taggables`。

```
INSERT INTO Taggables (id) VALUES (327);
INSERT INTO Recipes (recipe_id, name) VALUES (327, 'Hollandaise sauce');
INSERT INTO Ingredients (ingr_id, name) VALUES (327, 'eggs'); 
```

您是否希望与鸡蛋相关的每个标签也适用于荷兰酱？

我只是指出单表设计的这一方面。考虑到其他要求，它可能仍然是为您的标记建模的最佳方式。但是您应该注意从属表中 id 冲突的可能性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T15:22:31.003

我认为你在正确的轨道上。你描述得很好，你有几个不同的实体。您可以创建一个名为实体的表，其中包含所有常见属性（如果有的话）。所以例如

实体

*   实体 ID
*   姓名

成分

*   实体 ID
*   数量

配方发行者

*   实体 ID
*   一些其他信息

现在您可以有一个表来标记实体。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T02:36:58.377

我手上也有类似的“问题”。我正在开发一个小型产品数据库，其中涉及标签并为标签赋予一个值（例如标签名：颜色，值：绿色）。

两个主要表格是项目 (I) 和文章 (A)。项目是实际的物理项目，并且文章是从项目派生的。文章是可以在网站上展示的东西，物品是要存放在仓库中的东西。这种关系的一个小例子可能是汽车零件。具有已知尺寸和其他数据的散热器实际上可以适合许多不同的型号和制造，这就是为什么用于表示散热器的项目涉及到多个表明散热器可以适合的物品的原因。另一方面，我们可能为一个型号提供两种不同的散热器，一种是全新的版本，另一种是刚刚再制造的。在这种情况下，有两个项目与同一篇文章有​​关。

因此，我和 A 具有 N:M 关系。

物品和物品具有某些属性。例如，散热器项目可能具有条件、材料、重量、高度、宽度和厚度等数据。这篇文章还包含一些基本信息，如品牌、型号、年份、发动机等，但可能还需要一些特殊数据，如底盘型号、变速箱类型，或其他一些信息，如同一型号上使用的两种不同的配件类型。因为两个项目可以链接到一篇文章，这意味着我不能只标记文章。用两个条件值标记一篇文章是愚蠢的，另一方面，用一个模型的多个实例、品牌或一些特殊要求标记一个项目也不是一个好主意。_有两种类型的属性，第一种表示某物是什么样的，第二种表示它适合什么。

标签不必有值，它们可以简单地充当分配给实体的常规标签。

散热器只是简单产品的一个例子。我们不妨将一些计算机零件或服装放入我们的数据库中。这意味着我需要能够在两个不同的实体 I 和 A 上放置不同的“标签”。

我需要能够在网上商店中搜索文章。假设我正在使用基于树的导航，其中我有一个名为“二手日产散热器”的类别。搜索将涉及搜索文章和项目，文章具有标签 Model:Nissan，并且项目具有标签 Condition:Used。当然，当用户查看文章时，他确实会看到与文章相关的所有项目。

我正在考虑的解决方案之一是三角形数据库设计，其中有一个通用表，称为所有属性和标签的标签。

我们有表项目 (I)、文章 (A) 和标签 (T) 它们以 N:M 关系连接：I2A 将项目连接到文章。T2I 将标签连接到项目，并且也可能存储标签或属性的值。T2A 将标签连接到文章，并且也可能存储标签的值。

在纸面上，这个解决这个问题的 6 表设计看起来相当不错，但是我对形成一个体面的查询感到头疼，我可以在其中选择匹配一组不同标签及其值的文章，例如：Condition=Remanufactured , 品牌=日产

我希望能够做的是类似于 www.summitracing.com 的东西。从“商店”下方的左侧选择部门，选择任何类别，您将看到他们如何设法为项目提供一些属性。它们具有适用于大多数应用的发动机尺寸，但在寻找轮辋时，它们还具有宽度属性。

对此的任何反馈将不胜感激，我开始尝试设计它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T15:33:34.150

为食谱、配料等正常制作表格。

那么你的标签表应该是这样的：Id, Type, Tag

我建议在代码中使用枚举来区分不同的“类型”（实体）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T15:23:13.623

这个怎么样？

类型（PK：**类型**，set_id[,TypeDesc]）

属性（PK ：（ **set_id**，FK：***类型***），值）

PS：粗体/斜体真的很烂

# mysql - 哪个是 Rails 应用程序的最佳数据库？

> ID：302148
> 
> 赞同：2
> 
> 时间：2008-11-19T15:03:00.340
> 
> 标签：mysql, ruby-on-rails, database, postgresql, db2

我正在开发一个 Rails 应用程序，它将访问大量 RSS 提要或抓取网站以获取数据（主要是新闻）。它将类似于 Google 新闻，但采用不同的方法，因此我将存储大量新闻（或新闻摘要），将它们分类为不同的类别，并使用排名和推荐技术。

*   我应该使用 MySQL 吗？

*   使用 IBM DB2 purexml 存储文档是否值得？如果我选择 DB2，也不需要 Ruby 搜索实现（Ferret、Ultasphinx 等）。那是对的吗？

*   PostreSQL在这方面有什么优势？

*   在这种情况下使用 Couch DB 有意义吗？

我想选择最好的选项，但又不会使解决方案过于复杂。所以我放弃了使用两种不同存储解决方案的想法（一种用于新闻文档，另一种用于其余数据）。我也只考虑“免费”选项，所以我没有看 Oracle 或 MS SQL Server。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T15:14:16.700

purexml 比 SQL 更重，因此您为 webserver 和 DB 之间的往返支付更多费用。如果您打算拥有很多用户，我会避免它，最好让您的网络服务器缓存请求，从而避免每次都创建 xml(rss)，如果这是您正在考虑的。

我会选择 MySQL，因为它非常擅长服务并且完全免费，PostgreSQL 也是如此，但没有使用它，所以我不能说。

CouchDB 可能有意义，但如果您计划对数据进行 OLAP（离线分析），那么普通的 RDBMS 会更好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-22T21:45:06.160

首先承认我一般不喜欢mysql，我会说关于postgres的这个话题已经写过：

[http://oldmoe.blogspot.com/2008/08/101-reasons-why-postgresql-is-better.html](http://oldmoe.blogspot.com/2008/08/101-reasons-why-postgresql-is-better.html)

当我需要一个纯关系数据库时，这始终是我的选择。如果不了解更多信息，我不知道文档数据库是否更适合您的应用程序。听起来你至少应该调查一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T21:47:43.003

MySQL 可能是最好的选择之一。轻巧，易于安装和维护，多平台且免费。除此之外，还有一些不错的免费客户端工具。

需要考虑的事情；由于您系统的性质，您可能会有一些表会非常快速地增长，因此您可能需要考虑性能。

因此，MySQL 支持垂直分区，但仅从 V 5.1 开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T15:51:19.283

在我看来，您将构建的应用程序很容易成为大型 Web 应用程序。我建议使用 PostgreSQL，因为它以可靠性着称。

您可以查看以下链接——来自 MochiMedia 的 Bob Ippolito 告诉我们他们为什么放弃 MySQL 转而使用 PostgreSQL。尽管这些帖子已有 3 年多的历史，但 MySQL 5.1 最近出现的问题往往证明它们仍然具有相关性。

[http://bob.pythonmac.org/archives/category/sql/mysql/](http://bob.pythonmac.org/archives/category/sql/mysql/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T15:55:26.217

MySQL 在生产中表现良好。我没有将 PostgreSQL 用于 Rails，但它也是一个很好的解决方案。

In the dev and test environments I'd start out with SQLite (default), and perhaps migrate to your target DB in the test environment as you move closer to completion.

# asp.net - 在页面的生命周期内保持数据库连接打开是否可以接受？

> ID：302149
> 
> 赞同：6
> 
> 时间：2008-11-19T15:04:07.420
> 
> 标签：asp.net, database-connection, page-lifecycle

每个人都知道您应该在使用完连接后立即关闭它。

由于我的域对象模型设计存在缺陷，我不得不在整个页面生命周期中保持连接打开。本质上，我有一个 Just In Time 属性，它在第一次调用时打开一个连接，然后在 Page.Unload (..) 上它会检查一个 db 连接是否曾经打开，如果是则关闭它。由于只需要一秒钟，我认为它与立即关闭它并没有太大不同。

这个可以吗？还是应该在每次使用后立即关闭？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T15:14:45.747

不，这样不行。

如果您的应用程序需要增长或扩展，您将需要解决此问题。通过保持该连接打开，您正在降低扩展能力。请记住，打开的连接会占用服务器上的内存、客户端上的内存、保持打开的锁等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T15:11:22.493

如果在到达 Page.Unload 事件之前页面崩溃了怎么办？您将有一个打开的连接。对我来说，最好总是尽快关闭连接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T15:08:17.320

是的，没关系。

尽快关闭连接是防止孤立打开连接的最佳做法，但如果您确定连接正在关闭，那没有任何问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T15:30:33.967

现在每个像样的 ASP.NET 应用程序都使用连接池，而池基本上是一堆打开的连接。在您的情况下，这意味着您所持有的连接被“占用”并且不能用于服务其他请求。

据我所知，这将是一个可扩展性问题，具体取决于您的页面需要完成工作/渲染的时间量。如果您希望只有 100 个用户，就像您说的那样，那么这可能不是问题 - 当然，除非它是 100 个请求/秒。

从技术的角度来看是可以的。据我所知，大多数客户端-服务器应用程序（Web 和非 Web），包括曾经这样工作的经典 ASP 代码，例如，您为整个页面声明一个连接并使用它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-19T15:45:35.683

这并不理想，但我不会重写我的应用程序。除非您的页面正在以各种方法进行大量耗时的工作，否则整个页面生命周期应该快速执行。实际上，这可能只是意味着您的连接对象的打开时间比原本打开的时间长了几毫秒。这在某些情况下可能很重要，但听起来不像你的情况。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-19T15:16:45.757

页面崩溃？这就是 using 和 finally 的用途

也就是说，为了数据库性能（即扩展）*，最好保持连接打开的时间尽可能短，只允许您不想打开关闭打开关闭打开关闭以实现快速顺序和可预测的工作

* 在我职业生涯的早期，一位导师告诉我，我必须说我自己并没有实际测试过，但理论上听起来是正确的

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-19T15:43:08.637

当然，您*可以*让它们保持打开状态，但不行不行。在 finally 块中使用后关闭它。“每次使用后”的公平权衡是在每次使用后关闭它，如果您倾向于运行存储过程，更新列，然后删除其他行，您可以围绕这三个打开/关闭操作，假设它们都包含在 try/catch/finally 中。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-06T21:37:14.967

如果您在页面的整个生命周期中执行多个查询，那么您当然应该在页面的整个生命周期内保持连接打开。通常，实际上，一个人在许多页面上重复使用连接。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-06T21:45:53.280

我认为一个更好的问题是提供更明智和更有成效的反馈，可能会提供一些你正在做的事情（代码）的片段，并扩展你做出这个选择的原因。很可能有一个更好的解决方案，不需要保持连接打开这么长时间，但至少，出于务实的原因，您可以获得一些关于它是否值得改进的反馈。

将来，您肯定希望摆脱代码隐藏中的数据访问。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-06T22:21:05.907

[我发现在使用 ORM（在视图中打开会话](https://www.hibernate.org/43.html)）时保持连接打开很方便，这样在初始渴望获取之后，可以根据需要延迟加载其他数据。当页面响应时间合理以免占用连接时，这很有效。

# bash - AWK：将脚本输出从脚本重定向到另一个具有动态名称的文件

> ID：302152
> 
> 赞同：3
> 
> 时间：2008-11-19T15:04:40.167
> 
> 标签：bash, redirect, awk, gawk

我知道我可以将 awk 的打印输出从脚本中重定向到另一个文件，如下所示：

```
awk '{print $0 >> "anotherfile" }' 2procfile 
```

（我知道那是个假例子，但这只是一个例子......）

但我需要将输出重定向到另一个文件，该文件具有这样的动态名称

```
awk -v MYVAR"somedinamicdata" '{print $0 >> "MYWAR-SomeStaticText" }' 2procfile 
```

并且输出应该被重定向到`somedinamicdata-SomeStaticText`.

我知道我可以通过以下方式做到：

```
awk '{print $0  }' 2procfile >> "$MYVAR-somedinamicdata" 
```

但问题是它是一个更大的 awk 脚本，我必须根据某些条件输出到多个文件（并且这个 awk 脚本是从另一个 bash 调用的，它通过 -v 开关传递一些动态变量......和儿子在。

有可能吗？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T15:15:38.663

我想

```
awk -v MYVAR="somedinamicdata" '{print $0 >> (MYVAR "-SomeStaticText") }' 2procfile 
```

应该这样做。awk 中的字符串连接只是一个接一个。

# c# - 在 C# 中，我可以在基类中知道从我那里继承了哪些子类吗？

> ID：302157
> 
> 赞同：5
> 
> 时间：2008-11-19T15:06:16.263
> 
> 标签：c#, .net, inheritance

我有一个基类车辆和一些儿童类，如汽车、摩托车等。从车辆继承。在每个子类中都有一个函数 Go(); 现在我想在函数 Go() 触发时记录每辆车的信息，并且在该日志上我想知道是哪种车辆做到了。

例子：

```
public class vehicle 
{
      public void Go()
      {
           Log("vehicle X fired");
      }
}
public class car : vehicle
{
       public void Go() : base()
       {
           // do something
       }
} 
```

* * *

我如何在函数 Log 中知道那辆车在 base() 期间呼叫了我？谢谢，

暗里

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-19T15:10:21.560

从 Vehicle.Go()调用[`GetType()`](http://msdn.microsoft.com/en-us/library/system.object.gettype.aspx)会起作用——但前提是 Go() 被实际调用。

执行此操作的一种方法是使用[模板方法模式](http://en.wikipedia.org/wiki/Template_method_pattern)：

```
public abstract class Vehicle 
{
    public void Go()
    {
        Log("vehicle {0} fired", GetType().Name);
        GoImpl();
    }

    protected abstract void GoImpl();
}

public class Car : Vehicle
{
    protected override void GoImpl()
    {
        // do something
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-19T15:10:48.860

this.GetType() 将为您提供当前实例的类型

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T15:12:20.573

这个怎么样：

```
GetType().Name 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T15:39:46.257

Jon Skeet 的回复确实完成了工作，但我个人并不喜欢这种实施。我更喜欢以下保持它 - 在我看来 - 简单。

无论如何，.NET 已经通过虚拟方法提供了对此功能的支持。

```
public class Vehicle {
    public virtual void Go() {
          Log(this.GetType().Name);
    }
}

public class Car : Vehicle {
    public override void Go() {
         base.Go();
         // Do car specific stuff
    }
}

public class Bus : Vehicle {
} 
```

无论您是通过它的基类还是它的实际类来引用一个实例，这都会起作用。它不会强迫您更改基类中的实现，而且…….NET 的所有其他面向对象的优点。

如果您可以完全控制基类和派生类的实现，那么这个实现应该很好地为您服务。

# c# - ASP.NET 全球化——显示日期

> ID：302160
> 
> 赞同：1
> 
> 时间：2008-11-19T15:07:02.813
> 
> 标签：c#, asp.net, internationalization, globalization

早上好，

为新手问题道歉。我刚刚开始使用 ASP.NET 国际化设置。

背景资料：

我有一个显示`<table>`HTML 对象的网站。在那个`<table>`HTML 对象中，我有一列显示日期。我的服务器在美国，这些日期显示为`MM/DD/YYYY`. 我的许多用户通过 Excel，通过数据 --> 导入外部数据 --> 导入 Web 查询界面插入此网页。我的用户大部分都在美国，所以这些日期正确显示在他们的 Excel 屏幕上。

现在我需要让网页为英国用户工作。照原样，他们将日期下载为`MM/DD/YYYY`，这使得他们的电子表格无法使用，因为他们的区域设置设置为`DD/MM/YYYY`。

我的问题是：

如何使 Web 服务器意识到传入的请求具有`en-GB`文化设置？我可以设计自己的小自定义解决方法，但我敢肯定我不是第一个遇到这种情况的程序员。专业人士如何处理？我正在寻找一个相对简单且快速安装的解决方案，但我不想只是将我自己的逻辑中的一些糟糕的错误部分放在一起，我会在 6 个月后害怕。

提前非常感谢，-艾伦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T15:11:34.210

如果您愿意，您可以允许浏览器自动设置您的 UI 文化，方法是打开 web.config，如下所示：

```
<configuration>
   <system.web>    
       <globalization uiCulture="auto" />
       ... 
```

然后浏览器设置的文化将自动在您的应用程序中设置。这意味着当您让框架显示日期/时间值时，它们将根据当前线程的 UI 文化进行格式化。

如果您使用货币和/或本地化文本，这也会有所帮助（但是您必须为您支持的每种文化提供本地化资源）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T16:38:37.153

几点：

*   <globalization> 元素还需要属性culture="auto"。uiCulture 属性影响用于检索资源的语言。文化属性影响用于格式化数字和日期的文化。

*   如[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/bz9tc508.aspx)中所述，完全依赖浏览器设置来确定页面的 UI 文化并不是最佳实践。用户经常使用未设置为其偏好的浏览器（例如，在网吧中）。您应该为用户提供一种方法来明确选择页面的语言或语言和文化（CultureInfo 名称）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T16:54:12.583

您还可以接受用于覆盖文化设置的查询字符串参数。

文化初始化应该在 Page.InitializeCulture 方法中进行。

```
protected override void InitializeCulture ( )
{
  Thread.CurrentThread.CurrentCulture
    = Thread.CurrentThread.CurrentUICulture
    = Request.QueryString [ "culture" ] != null ? new CultureInfo ( Request.QueryString [ "culture" ] ) : CultureInfo.InvariantCulture;
  //base.InitializeCulture ( );
} 
```

用法：[http ://tempuri.org/page.aspx?culture=en-GB](http://tempuri.org/page.aspx?culture=en-GB)

# currency - 我将使用什么文件格式进行货币兑换

> ID：302162
> 
> 赞同：0
> 
> 时间：2008-11-19T15:07:24.560
> 
> 标签：currency, file-format

我正在寻找需要存储货币并提供货币兑换的系统使用的标准文件格式（因此我们需要买入和卖出汇率）

我在网上查找并找到了[.cex](http://filext.com/file-extension/CEX)但无法找到它的格式。

我在哪里可以得到这个文件的格式？

我应该使用另一种文件格式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-21T09:02:05.373

我不知道[SERIFF](http://www.cloanto.com/specs/seriff.html)是否更适合您的应用程序，但至少它有文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-09T15:57:08.170

或者也许[FIX](http://www.fixprotocol.org/)就是你所追求的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-19T11:43:21.490

FpML [http://www.fpml.org/](http://www.fpml.org/)可能是您正在寻找的。如果您所做的只是存储出价/询价，那么我认为我不会为自己背负 XML。将其存储在数据库中有什么问题？

# python - Gnome 中 Python 应用程序的全局热键

> ID：302163
> 
> 赞同：6
> 
> 时间：2008-11-19T15:08:12.017
> 
> 标签：python, gnome

我想为我在 Gnome 中运行的 Python 应用程序分配一个全局热键。我怎么做？我只能找到两年前的帖子说，好吧，几乎什么都没有:-)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-08-31T21:03:58.240

有 python-keybinder 是相同的代码，但独立打包。现在也可以在 debian 和 ubuntu 存储库中使用。

[https://github.com/engla/keybinder](https://github.com/engla/keybinder)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T15:09:54.803

查看 Deskbar 源代码 - 他们这样做；afaik，他们调用了一个与 X11 交互的 C 库来完成这项工作

# .net - MSTest 是否有流畅的断言 API？

> ID：302166
> 
> 赞同：15
> 
> 时间：2008-11-19T15:09:41.793
> 
> 标签：.net, unit-testing, mstest, fluent, fluent-interface

我最近接触了 nUnit 中的流利界面，我喜欢它；但是，我正在使用 msTest。

有谁知道是否有一个流畅的接口是测试框架不可知的还是用于 msTest 的？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-08-08T14:14:40.623

请参阅[流利的断言](http://www.fluentassertions.com/)。你可以做类似的事情

```
"ABCDEFGHI".Should().StartWith("AB").And.EndWith("HI").And.Contain("EF").And.HaveLength(9);

new[] { 1, 2, 3 }.Should().HaveCount(4, "because we thought we put three items in the 
collection"))

dtoCollection.Should().Contain(dto => dto.Id != null);

collection.Should().HaveCount(c => c >= 3);

dto.ShouldHave().AllPropertiesBut(d => d.Id).EqualTo(customer);

dt1.Should().BeWithin(TimeSpan.FromHours(50)).Before(dt2); 

Action action = () => recipe.AddIngredient("Milk", 100, Unit.Spoon);
action
   .ShouldThrow<RuleViolationException>()
   .WithMessage("Cannot change the unit of an existing ingredient")
   .And.Violations.Should().Contain(BusinessRule.CannotChangeIngredientQuanity 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-01-12T10:34:28.247

见[http://sharptestex.codeplex.com/](http://sharptestex.codeplex.com/)

注意：SharpTestsEx 似乎不再积极开发，推荐的替代方法是[http://www.fluentassertions.com/](http://www.fluentassertions.com/)。

SharpTestsEx（Sharp Tests Extensions）是一组可扩展的扩展。主要目标是编写以 Visual Studio IDE 智能感知为指导的简短断言。#TestsEx 可以与 NUnit、MsTests、xUnit、MbUnit 一起使用……甚至在 Silverlight 中。

强类型断言的语法示例（取自网页）：

```
true.Should().Be.True();
false.Should().Be.False();

const string something = "something";
something.Should().Contain("some");
something.Should().Not.Contain("also");
something.ToUpperInvariant().Should().Not.Contain("some");

something.Should()
    .StartWith("so")
    .And
    .EndWith("ing")
    .And
    .Contain("meth");

something.Should()
    .Not.StartWith("ing")
    .And
    .Not.EndWith("so")
    .And
    .Not.Contain("body");

var ints = new[] { 1, 2, 3 };
ints.Should().Have.SameSequenceAs(new[] { 1, 2, 3 });
ints.Should().Not.Have.SameSequenceAs(new[] { 3, 2, 1 });
ints.Should().Not.Be.Null();
ints.Should().Not.Be.Empty();

ints.Should()
    .Contain(2)
    .And
    .Not.Contain(4);

(new int[0]).Should().Be.Empty(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T04:09:14.070

根据我的研究，没有，但是如果您愿意牺牲更好的可报告性至于断言失败的原因并愿意添加新的 dll，您可以参考 nunit 并使用他们的....

# gfortran - 如何找出使用了哪个编译器：g77 或 gfortran

> ID：302171
> 
> 赞同：7
> 
> 时间：2008-11-19T15:10:20.280
> 
> 标签：gfortran, g77

我正在为一个私人项目编译库，这取决于许多库。具体来说，其中一个依赖项是用 Fortran 编译的。在某些情况下，我看到使用 编译的依赖项`g77`，在其他情况下，我看到使用 编译的依赖项`gfortran`。然后我的项目`./configure`将与`-lg2c`or链接`-lgfortran`，但到目前为止我一直在手动完成。

如果可能的话，我如何通过查看依赖库（通过例如`nm`或其他一些实用程序？）找出使用的编译器是`g77`（然后我将`-lg2c`在我的链接选项中使用）还是`gfortran`（然后我'会用`-lgfortran`）？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T20:00:49.740

```
nm filename | fgrep ' __g77' 
```

如果使用 g77 将给出结果，同时

```
nm filename | fgrep '@@GFORTRAN' 
```

如果使用 gfortran 将给出结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-23T08:03:09.863

您需要在 的输出中使用 grep 来`nm filename`指示是否使用了 g77 或 gfortran。在大多数情况下，如果库至少在一个地方进行输入输出，它将调用 libg2c 或 libgfortran，您会注意到其中有一个符号`*g77*`，或`*gfortran*`. 所以，最好的办法是使用 grep：

```
nm filename | grep _g77_
nm filename | grep _gfortran_ 
```

两个注意事项：

1.  按照 geocar的建议，Grepping for`@@GFORTRAN`是不可靠的：它只能在支持库版本控制的平台上工作，包括例如 linux，但不包括 Windows 或 Mac OS。
2.  仍然有可能某些编译代码调用绝对不支持库函数（如果它所做的只是简单的算术并且没有输入输出，例如）。在这种情况下，除非它使用调试选项进行编译，否则无法判断哪个编译器输出它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T15:45:39.787

您可能可以通过使用 nm 来解决这个问题，并查看编译的代码是否使用了其中一个或另一个的函数，但这是一个相当棘手的问题。您可能能够根据可用的库来确定它（例如，如果没有可用的 libg2c，则它不是 g77），但是如果两者都可用，您仍然会有一些歧义。如果您可以自己构建依赖项，那么您可以使用构建过程的一部分以某种方式（变量、文件等）告诉另一部分您使用了哪一个。

# asp.net - 共享相同 ASP.Net 会话 Cookie 的不同应用程序

> ID：302181
> 
> 赞同：8
> 
> 时间：2008-11-19T15:11:54.583
> 
> 标签：asp.net, session, ssl, cookies

我有两个 ASP.Net 应用程序驻留在服务器上的两个不同文件夹中：

*   `/Foo`<-- 这是标准的不安全应用程序
*   `/Secure`<-- 这是一个单独的应用程序，需要 IIS 使用 SSL

问题是，默认情况下，`ASP.NET_SessionId`cookie 是在域上指定的，并且在不同目录中的两个应用程序之间共享。我需要不同的会话 cookie，因为我不能允许使用被劫持的 cookie`/Foo`来授予对`/Secure`应用程序的访问权限。

理想情况下，我希望每个应用程序的 cookie 都受 cookie`Path`属性的限制。开箱即用的.Net 显然没有办法做到这一点。

更令人头疼的是，即使我编写自定义代码来设置 cookie 路径，我也担心某些浏览器区分大小写并且不会对 and 使用相同的会话 cookie `/Foo`，`/foo`这取决于链接的构建方式，可以导致同一应用程序中的多个会话。

有没有人遇到并克服了这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-19T15:36:06.560

在 .Net 2.0 及更高版本中，您可以将 web.config 中“sessionState”XML 元素的“cookieName”属性设置为每个应用程序的不同值。这将阻止他们使用相同的会话 ID。

[这是 MSDN 参考。](http://msdn.microsoft.com/en-us/library/h6bb9cz9.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T15:26:30.667

检查`/Secure`IIS 中文件夹的图标。

如果它有一个齿轮图标，那么它是一个单独的应用程序，会话应该不同，应用程序将在它自己的 appdomain 中运行。

如果它是一个地球图标，那么它就是一个虚拟目录，将与根站点共享相同的会话，并且`/Foo`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T08:04:17.307

如果您使用表单身份验证，那么您还需要更改 web.config 中的表单 cookie：

```
<forms name="Foo"...
<forms name="Secure"... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T15:16:26.540

听起来它们只是在不同的虚拟目录中，但仍在同一个应用程序池中。如果您真的希望应用程序分开，请尝试为您的 /secure 应用程序创建另一个应用程序池。

# http - 从 wget 解析 http 响应头

> ID：302195
> 
> 赞同：11
> 
> 时间：2008-11-19T15:15:17.180
> 
> 标签：http, parsing, header, response, wget

我试图从 wget 的结果中提取一行，但遇到了麻烦。这是我的 wget 调用：

```
$ wget -SO- -T 1 -t 1 http://myurl.com:15000/myhtml.html 
```

输出：

```
--18:24:12-- http://xxx.xxxx.xxxx:15000/myhtml.html
           => `-'
正在解决 xxx.xxxx.xxxx... xxx.xxxx.xxxx
正在连接到 xxx.xxxx.xxxx|xxx.xxxx.xxxx|:15000... 已连接。
已发送 HTTP 请求，等待响应...
  找到 HTTP/1.1 302
  日期：格林威治标准时间 2008 年 11 月 18 日星期二 23:24:12
  服务器：IBM_HTTP_Server
  过期：1994 年 12 月 1 日星期四 16:00:00 GMT
  位置：https://xxx.xxxx.xxxx/siteminderagent/...
  内容长度：508
  保活：超时=10，最大值=100
  连接：保持活动
  内容类型：文本/html；字符集=iso-8859-1
位置：https://xxx.xxxx.xxxx//siteminderagent/...
--18:24:13-- https://xxx.xxxx.xxxx/siteminderagent/...
           => `-'
解析 xxx.xxxx.xxxx... 失败：名称或服务未知。

```

如果我这样做：

```
$ wget -SO- -T 1 -t 1 http://myurl.com:15000/myhtml.html | egrep -i "302" <br/> 
```

它不会返回包含字符串的行。我只想检查站点或站点管理员是否已启动。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-19T15:20:43.380

您正在寻找的 wget 的输出写在 stderr 上。您必须重定向它：

```
$ wget -SO- -T 1 -t 1 http://myurl.com:15000/myhtml.html 2>&1 | egrep -i "302" 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-19T15:23:13.903

`wget`将标头打印到标准错误，而不是标准输出。您可以将 stderr 重定向到 stdout，如下所示：

```
wget -SO- -T 1 -t 1 http://myurl.com:15000/myhtml.html 2>&1 | egrep -i "302" 
```

“2>&1”部分表示将 ('>') 文件描述符 2 (stderr) 重定向到文件描述符 1 (stdout)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-03T16:38:09.407

已经提供的解决方案的一些增强版本

> wget -SO- -T 1 -t 1 [http://myurl.com:15000/myhtml.html](http://myurl.com:15000/myhtml.html) 2>&1 >/dev/null | grep -c 302

`2>&1 >/dev/null`将修剪掉不需要的输出。这样，egrep 将仅解析 wget 的 stderr，从而消除了从 stdout 中捕获包含 302 的字符串的可能性（其中 html 文件本身输出 + 下载过程栏，结果字节数等）:)

`egrep -c`计算匹配字符串的数量，而不是简单地输出它们。足以知道 egrep 匹配了多少字符串。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-20T13:26:07.470

wget --server-response [http://www.amazon.de/xyz](http://www.amazon.de/xyz) 2>&1 | awk '/^ HTTP/{打印 $2}'

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-23T23:27:48.600

只是为了解释一下。原始问题中的`-S`switch 是`--server-response`.

另外，我知道指定的 OP `wget`，但`curl`类似并默认为 STDOUT 。

```
curl --head --silent $yourURL 
```

或者

```
curl -I -s $yourURL 
```

`--silent`只有-ability需要这个开关`grep`：（`-s`关闭进度%仪表）

# .net - 为性能关键的大容量应用程序构建 DAL

> ID：302196
> 
> 赞同：4
> 
> 时间：2008-11-19T15:15:19.257
> 
> 标签：.net, linq-to-sql, architecture

我正在开发一个具有非常非规范化数据库的大规模性能关键 asp Web 应用程序（出于性能原因，许多数据在表之间重复）。该应用程序对性能至关重要且很大。几乎没有任何 n 层设计的感觉。我不能触摸数据库，它是刻在石头上的。

现在我需要构建一些额外的应用程序来访问 c# (.net 3.5) 中的相同数据。在这样做的同时，我被要求构建一个新的“核心”，以后可以在转到 MVC 时使用它，所以我想引入某种数据访问层来保存实体类和一个存储库，负责 crud 操作。

我一直在阅读有关存储库模式和 LinqToSql 的信息，所以我想我知道非常基础的知识。应该构建的新应用程序当然要在 2 周前到期，所以我真的不能花大量时间来创建一个巨大的框架或在开始工作之前参加课程。我愿意每天读一本书，但我需要快速开始。

我的问题是，在考虑将 LinqToSql 和存储库模式作为解决方案时，我是否走在正确的道路上？为什么不使用您最喜欢的代码生成器生成实体并使用断开连接的记录集查询数据库旧样式？使用 LinqToSql 时是否会失去对 sql 查询的控制？我应该担心性能吗？我完全走错路了吗？

我希望我能正确解释手头的问题。如果有任何未解决的问题，请随时提问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T15:25:23.963

有大量的映射工具旨在帮助完成这项任务，但就可维护性而言，在实用性方面，您最好自己动手（特别是如果该数据库模型不太可能改变）。

如果我处于您的情况，我会创建代表您在数据库中存储的内容的通用类，然后为您的数据层创建具有静态方法的类。每个方法只执行您的应用程序需要的一项任务（即添加、编辑、获取、搜索等），并使用内置的 SQLCommand/SQLDataReader 对象来完成，最好调用存储过程。对于“get”类型的方法，它们将返回您的第一组类（或它们的列表）。

这个过程将比使用框架/linqtosql 更耗时，但您不会找到比这更好或更灵活的另一种方法（因为您实际上是在编写代码；它不是生成的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T15:29:07.887

几周前我们遇到了完全相同的问题。我们最初是生成实体、Dal 和基本 BLL 的代码。但是我们必须编写大量代码来加载引用的实体，如果没有集中的通用解决方案，集合将非常复杂。

我们已经有一个很棒的本土代码生成器，我们正在使用，而且几乎我们所有的业务实体都不是聚合的，它们大多是 1-1 与数据库表（大部分）。我们真的很想使用 LinqToSql，但是我们使用属性进行验证，而使用 LinqToSql 设计器并没有使这成为可能。它也不允许我们通过网络发送查询。

所以我们决定使用我们的代码生成器来生成我们的 LinqToSql 实体。我们还使用[Interlinq](http://www.codeplex.com/interlinq)，它允许我们通过网络发送查询。我们有一个存储库工厂来处理我们所有的 linqToSql 查询。基本上，这只是根据我们是否需要通过网络发送查询来包装 LinqToSql 数据上下文或 Interlinq 数据上下文。

这个解决方案对我们来说非常有用，它允许我们直接查询数据并使其保持活跃。

# c# - 您是否使用常规构建作为编码工具？

> ID：302203
> 
> 赞同：2
> 
> 时间：2008-11-19T15:16:57.973
> 
> 标签：c#, performance, delphi, compiler-construction

我们有一个大型（大约 580,000 loc）应用程序，在 Delphi 2006 中构建（在我的机器上）大约需要 20 秒。当构建时间以秒为单位时，您倾向于将编译器用作工具。即编写一些代码，构建，编写更多代码并构建更多等等当我们将一些东西移到C#中时，有没有人比较过构建这种大小的东西需要多长时间？我目前只有小型应用程序和组件，因此无法真正进行比较。如果事情需要更长的时间来构建，那么我可能需要改变我的风格！还是我的风格只是懒惰？

例如，如果我正在更改方法调用的接口，而不是对所有应用程序进行全面搜索以找出我需要对调用进行更改的位置，我将使用编译器为我找到它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T15:28:27.403

Visual Studio 2008 SP1 现在为 C# 提供了后台编译（它一直为 VB.NET 提供）。回到我的 VB 时代，我经常使用它来通过更改名称来查找引用的位置，然后查看后台编译器说哪里有错误。

我从来没有做过这么大的事情。在我的上一份工作中，我们有大约 60,000 个 loc 分布在大约 15 个项目中，编译大约需要 10 秒。也许其他人可以发布一个稍微大一点的案例研究

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T15:29:34.373

我曾经使用过您描述的编译器，但由于我一直在使用[ReSharper](http://www.jetbrains.com/resharper) ，所以我这样做的次数要少得多。此外，对于重命名之类的事情，重构支持（在 Visual Studio 2005 及更高版本中，甚至更好的是来自 ReSharper）意味着我不必执行搜索 + 替换来重命名事物。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T15:20:51.913

您可以利用的一件事，尤其是在桌面应用程序中，我想您正在处理来自 Delphi 的问题，那就是编辑并继续。这使您可以在调试模式下运行时更改实际代码。除了添加类级变量、方法或新类之外，您几乎可以更改任何内容，并且仍然可以继续运行，而无需重新编译您的项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T17:05:06.787

我只使用“语法检查”来查看我是否忘记了代码上的一些错字......而且这些都大大减少了，因为我是 GExperts 插件的“代码校对器”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T15:25:00.717

好吧，编译器不必那么快就可以利用它。一些 IDE 支持在每个文件保存时进行增量编译，或者即时进行。这很好用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T15:25:09.657

您可以将应用程序拆分为多个项目（按层和/或模块和/或等...），您将只编译项目，您实际上在哪里工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T15:29:19.163

你帖子的最后一部分吓到我了。我不熟悉其他 IDE，但 MSDev 允许您查找对方法的所有引用 - 因此您不必编译只是为了找到您中断的所有方法调用。

使用任何有效的方法，但你对新的做事方式持开放态度是件好事。

# wpf - 通过 Visual Studio 2008 远程调试器远程调试 .NET WPF 应用程序？

> ID：302207
> 
> 赞同：0
> 
> 时间：2008-11-19T15:18:00.327
> 
> 标签：wpf, visual-studio-2008, debugging, remote-debugging

可以通过 Visual Studio 2008 远程调试器对 .NET WPF 应用程序进行远程调试吗？我只在选项中看到原生？任何帮助请...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-14T14:33:34.643

是的，它可以。在客户端 PC 上运行远程调试器，在开发 PC 上运行 VS2008。您选择“附加到进程”并在过滤器框中输入远程服务器名称。然后，您应该能够从进程列表中选择您的应用程序。（您显然需要确保列表显示托管进程 - 这可以通过对话框上的选项进行更改）

它是 WPF 应用程序这一事实没有任何区别，只要您拥有正确的源代码和匹配的符号文件，您就可以使用 Visual Studio 远程调试任何 .net 应用程序。

# c++ - 如何在 Windows 上构建 x64 Boost 库？

> ID：302208
> 
> 赞同：51
> 
> 时间：2008-11-19T15:18:13.913
> 
> 标签：c++, visual-studio-2005, boost, 64-bit, boost-build

我已经多次构建了 x86 Boost 库，但我似乎无法构建 x64 库。我启动“Visual Studio 2005 x64 Cross Tools 命令提示符”并运行我通常的构建：

```
bjam --toolset=msvc --build-type=complete --build-dir=c:\build install 
```

但它仍然会生成 x86 .lib 文件（我用 dumpbin /headers 验证了这一点）。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-11-19T15:28:40.540

您需要添加`address-model=64`参数。

看例如[这里](http://devsql.blogspot.com/2007/05/building-boost-134-for-x86-x64-and-ia64.html)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-06-14T09:56:56.620

接受的答案是正确的。添加这个以防其他人用谷歌搜索这个答案但仍然无法生成 x64 版本。

以下是我在 Visual Studio 15 2017 社区版上构建 Boost 1.63 所必须做的。

从 VS 环境 cmd shell 执行的命令。工具 -> Visual Studio 命令提示符

```
C:\Work\Boost_1_63> C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Auxiliary\Build\vcvarsall.bat amd64
C:\Work\Boost_1_63> bootstrap.bat
C:\Work\Boost_1_63> bjam -j4 architecture=x86 address-model=64 link=static stage
C:\Work\Boost_1_63> bjam --prefix=C:\opt\boost architecture=x86 address-model=64 link=static install 
```

您可以使用 dumpbin 验证生成的 .lib 是否为 x64：

```
C:\Work> dumpbin /headers C:\work\boost_1_63\stage\lib\libboost_locale-vc140-mt-1_63.lib | findstr machine
8664 machine (x64)
8664 machine (x64)
8664 machine (x64)
8664 machine (x64) 
... 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-10-30T02:24:27.863

使用 b2 命令是：

```
b2 --build-dir=build/x64 address-model=64 threading=multi --build-type=complete --stagedir=./stage/x64 
```

它会`default address-model: 32-bit`在开始时显示，但仍会以 64 位构建（多么令人困惑）。您应该使用名称创建 dll，例如`library-vc140-mt-x64-1_71.dll`确认它是 64 位。

来源：[在 Windows 上构建 Boost 32 位和 64 位库](http://informilabs.com/building-boost-32-bit-and-64-bit-libraries-on-windows/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-13T01:01:34.763

您可能会发现以下[Boost.Build 属性](https://boostorg.github.io/build/manual/develop/index.html#bbv2.overview.invocation.properties)：

```
address-model=64 
```

# sql - 您将常用的 sql 任务脚本保存在哪里？

> ID：302217
> 
> 赞同：2
> 
> 时间：2008-11-19T15:21:03.707
> 
> 标签：sql, sql-server, scripting

在您的工作场所，您在哪里存储您在 SQL Server 中使用的常见的、非数据库特定的脚本？您是将它们保存在文件服务器上的 .SQL 脚本中，将它们存储在 Master 数据库中，还是将它们保存在专门为此类事物定义的数据库中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T15:26:48.560

我们将它们存储为常规源代码，因此在版本控制中。这样您就可以使用以前版本的脚本，并且避免了“有人删除了 XY 脚本”的风险。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T15:24:18.223

我们将它们存储在一个 wiki 中，每个人都可以访问它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T16:29:26.110

我们将它们存储在一个单独的数据库中，并有一个自定义程序，以便于执行和维护。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T20:35:06.707

我将它们全部以[模板](http://msdn.microsoft.com/en-us/library/ms174169.aspx)格式存储在我的硬盘上。CTRL+SHIFT+M 将填充占位符。这很棒。

# .net - Oracle 登录触发器未触发

> ID：302219
> 
> 赞同：4
> 
> 时间：2008-11-19T15:21:31.897
> 
> 标签：.net, oracle

我在 Oracle 10.2 数据库上使用以下登录触发器：

```
CREATE OR REPLACE TRIGGER AlterSession_trg
AFTER LOGON ON DATABASE
BEGIN
  EXECUTE IMMEDIATE 'ALTER SESSION SET NLS_COMP=LINGUISTIC';
  EXECUTE IMMEDIATE 'ALTER SESSION SET NLS_SORT=BINARY_AI';
END AlterSession_trg; 
```

这是为了让区分大小写的查询成为过去，当我从 PL/SQL Developer 连接时，情况确实如此。但是，当我从 SQL Developer 或 ASP.NET 应用程序连接时，我正在处理的查询再次区分大小写。无论如何，SQL Developer/.NET 是否可以跳过此触发器？我是不是把触发器设置错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T18:12:10.740

Oracle SQL Developer 正在根据首选项更改 NLS 参数。（工具 -> 首选项... -> 数据库 -> NLS 参数）

可能您的 .NET 应用程序也在更改 NLS 参数，覆盖您的触发器设置。

您是否尝试过设置`NLS_COMP`和`NLS_SORT`作为[环境变量](http://download.oracle.com/docs/cd/B10501_01/server.920/a96529/ch3.htm#58904)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T15:34:36.050

我认为您应该让您的 DBA 进行这些更改，而不是依赖触发器。如果由于某种原因它变得无效，您可能会遇到问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T08:26:27.113

这是排序的 SQL Developer。在深入研究环境变量解决方案时，我找到了 .NET 应用程序的解决方案；我更新了 SPFILE，现在一大堆有案例问题的查询正在正确运行。

我运行的命令是：

```
ALTER SYSTEM SET NLS_COMP=LINGUISTIC SCOPE SPFILE;
ALTER SYSTEM SET NLS_SORT=BINARY_AI SCOPE SPFILE; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-21T04:23:54.747

仅供参考，您需要小心操作会话变量以处理不区分大小写的搜索。

如果您通过 db-link 向具有这些会话变量的 Oracle 9.2 或更早版本的数据库实例发出查询，您将收到 ORA-00600 错误，因为您在 Oracle 10.2 中操作的会话变量在 Oracle 9.2 中不存在或更早。

# php - 给出一组提交相同表单的不同可点击选项的标准方法是什么？

> ID：302223
> 
> 赞同：0
> 
> 时间：2008-11-19T15:21:52.957
> 
> 标签：php, javascript, html

我有一个 PHP 生成的页面，它显示有关一组电影的一些数据。该页面使用 POST 更新。该表格仅显示以特定字母开头的电影。我想在屏幕顶部显示一组可点击的选项，每个选项都是一个字母。因此，如果您单击“B”，它会提交表单并重新绘制仅显示以 B 开头的电影的页面。（我知道，Ajax 会是一个更好的方法，但我正试图快速完成一些事情）。

无论如何，我知道我可以通过让每个链接成为设置隐藏字段的值然后提交表单的 Javascript 调用来做到这一点，或者我可以通过让每个字母成为具有特定值的按钮并提交来做到这一点直接形式，但这些都没有让我觉得特别优雅。有没有标准的方法来做到这一点？我错过了一些非常明显的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T15:26:46.160

您始终可以创建多个提交按钮并为每个按钮指定不同的名称。然后您根据 POST 数组中包含的内容进行测试以查看哪个提交被按下。

请注意，您可以使用[图像输入类型](http://www.w3schools.com/TAGS/att_input_type.asp)代替提交输入类型，以便您可以将自己的图像等替换为您的按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T15:31:31.923

我认为您几乎涵盖了您拥有的选项。我通常认为它是用 javascript 和 hrefs 完成的，因为人们不喜欢为真正的按钮设置样式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T20:18:41.063

请注意，Internet Explorer（6/7？）不会在 <input type="image"> 上发布带有按钮**名称的变量 - 它只会发布带有****name_x**和**name_y**的变量以及按钮上位置的坐标被点击。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T15:52:49.570

您实际上并不需要提交表单，因为您并没有真正使用它。

为什么不只是一组超链接 B

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T16:05:19.420

使用几个不同的提交按钮，如下所示：

```
<input type="submit" name="letter" value="A" />
<input type="submit" name="letter" value="B" />
<input type="submit" name="letter" value="C" />
... 
```

# asp.net-mvc - 为什么这个查询字符串无效？

> ID：302234
> 
> 赞同：3
> 
> 时间：2008-11-19T15:23:54.793
> 
> 标签：asp.net-mvc, invalid-url

在我的 asp.net mvc 页面中，我创建了一个呈现如下的链接：

`http://localhost:3035/Formula/OverView?colorId=349405&paintCode=744&name=BRILLANT%20SILVER&formulaId=570230`

根据 W3C 验证器的说法，这是不正确的，并且在第一个 & 号之后会出错。它抱怨 & 未被编码和实体 &p 未被识别等。

AFAIK & 不应该被编码，因为它是键值对的分隔符。

对于那些关心的人：我将这些 pars 作为查询字符串而不是“/”分隔值发送，因为没有像我所知的传递可选参数的好方法。

将所有位放在一起：

*   锚 (<a>) 标签的 href 属性需要一个编码值
*   & 编码为 &
*   当它是参数值的一部分时对“&”进行编码，请使用 %26

不会将 & 符号编码为 & 使其成为我参数值的一部分吗？我需要它将第二个变量与第一个变量分开

事实上，通过编码我的 href 值，我确实摆脱了错误。但是，我现在想知道的是，例如，如果我的 colorId 是“123&456”，其中的 & 符号是值的一部分，该怎么办。由于必须对分隔符进行编码，因此如何处理已编码的 & 符号。可以这么说，它们是否需要被编码两次？

所以要获取网址：

`www.mySite.com/search?query=123&amp;456&page=1`

我的 href 值应该是多少？

另外，我想我是世界上第一个关心这个的人..去检查 www 并计算在 W3C 验证器中验证了他们的查询字符串的页面..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T15:27:38.093

作为属性一部分的实体通常应该被编码。因此你需要 & 而不仅仅是 &

即使它没有验证它也可以工作，因为大多数浏览器在接受什么方面非常、*非常*、**非常**宽松。

此外，如果您要输出 XHTML，您必须在任何地方对每个实体进行编码，而不仅仅是在属性内部。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T15:28:04.470

所有 HTML 属性都需要使用字符实体。你只需要把 & 改成 & 在脚本块内。

```
<a href="http://localhost:3035/Formula/OverView?colorId=349405&amp;paintCode=744&amp;name=BRILLANT%20SILVER&amp;formulaId=570230">Whatever</a> 
```

在 HTML 文档中，如果您希望 & 直接显示在空格以外的内容旁边，则需要使用字符实体 &。如果它是属性的一部分，则 & 会像 & 一样工作。如果文档是 XHTML，则需要在任何地方使用字符实体，即使 & 旁边没有任何东西。您还可以使用其他角色实体作为属性的一部分，将它们视为实际角色。

如果您想以不同于参数分隔符的方式使用与号作为 URL 的一部分，则应使用 %26。

举个例子...

```
<a href="http://localhost/Hello?name=Bob&amp;text=you%20%26%20me%20&quot;forever&quot;">Hello</a> 
```

将用户发送到[http://localhost/Hello](http://localhost/Hello)， name=Bob 和 text=you & me “永远”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T01:36:24.773

我发现这对某些人来说是一个有点混乱的概念。当您放入`&amp;`一个 HTML 页面时，例如在 中`<a href="abc?def=5&amp;ghi=10">`，URL*实际上是* `abc?def=5&ghi=10`. HTML 解析器将实体转换为 & 符号。

想一想与在字符串中转义引号的方式完全相同：

```
// though you define your string like this:
myString = "this is \"something\" you know?"

// the string is ACTUALLY: this is "something" you know?

// when you look at the HTML, you see:
<a href="foo?bar=1&amp;baz=2">

// but the url is ACTUALLY: foo?bar=1&bar=2 
```

# gac - 将策略文件添加到 GAC 时出错

> ID：302239
> 
> 赞同：0
> 
> 时间：2008-11-19T15:24:51.920
> 
> 标签：gac, policy, publisher

我正在尝试根据此[线程](https://stackoverflow.com/questions/283419/how-to-just-load-the-latest-version-of-dll-from-gac)将发布者策略文件添加到 gac，但是当我尝试在测试服务器上添加文件时遇到问题。

我得到“找不到在程序集'policy.3.0.assemblyname.dll'的清单中指定的模块”

我的策略文件如下所示：

```
<configuration>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="*assemblyname*"
                          publicKeyToken="7a19eec6f55e2f84"
                          culture="neutral" />
        <bindingRedirect oldVersion="3.0.0.0"
                         newVersion="3.0.0.1"/>
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration> 
```

请帮忙！

谢谢

本

* * *

我用一个本身没有依赖项（除了默认值）的新程序集从头开始重新创建了这个问题 - 在我的本地开发机器上一切正常（并且重定向也很好），但是将策略文件添加到 GAC 时出现相同的错误在服务器上！

```
<configuration>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="TestAsm"
                          publicKeyToken="5f55456fdcc9b528"
                          culture="neutral" />
        <bindingRedirect oldVersion="3.0.0.0"
                         newVersion="3.0.0.1"/>
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration> 
```

通过以下方式链接

```
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\al.exe /link:PublisherPolicy.xml /out:policy.3.0.TestAsm.dll /keyfile:..\..\key.snk /version:3.0.0.0
pause 
```

请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T08:24:38.100

哇——好的。

我应该更加注意这到底意味着什么

[(MSDN) 如何：创建发布者策略](http://msdn.microsoft.com/en-us/library/dz32563a.aspx)

> 重要说明：除非原始发布者策略文件与程序集位于同一目录中，否则无法将发布者策略程序集添加到全局程序集缓存中。

坦率地说，这个要求太奇怪了，以至于它没有注册。添加策略程序集时，编译到我尝试添加到 gac 的程序集的原始策略文件必须与策略程序集位于同一文件夹中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T16:10:30.673

好的...只是想检查一些基础知识....

您肯定已将两个版本的依赖程序集都安装到 GAC 中吗？

您是否已验证 [assembly: AssemblyVersion()] 属性中的版本号是否正确。

而且您确实使用了 [assembly: **AssemblyVersion** ()] 而*不是*[assembly: **AssemblyFileVersion** ("1.0.0.1")]。

**更新：**我的错误，您只需要 GAC 中最新版本的程序集。我只是在这里尝试过，它有效。我唯一的其他想法是检查公钥标记是否相同，并且您没有拼错程序集名称。

此外，当您生成策略文件时，请确保使用程序集链接器中的 /version 开关将版本号显式设置为 3.0.0.0*并且*不要指定 /platform 开关。例如

```
al.exe /link:assembly.config /out:policy.3.0.assembly.dll 
         /keyfile:mykey.snk /version:3.0.0.0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T22:18:39.933

要使用 Wise 将策略程序集添加到 GAC，您执行与添加策略所针对的程序集相同的操作。因此，您将策略程序集添加到 Wise 中的“全局程序集缓存”，只要您在计算机上的同一位置有策略文件 (.config)，Wise 也会自动将其添加到 GAC。

# asp.net-ajax - 为什么我的 CalendarExtender 在渲染时会重叠？

> ID：302244
> 
> 赞同：11
> 
> 时间：2008-11-19T15:25:33.040
> 
> 标签：asp.net-ajax, calendarextender

我正在开发一个 .NET Web 应用程序，并在其中使用 CalendarExtender 控件让用户指定日期。出于某种原因，当我单击图标显示日历时，背景似乎是透明的。

我在其他页面上使用了扩展器，没有遇到这个问题。

我不确定它是否值得一提，但日历嵌套在一个面板内，该面板上附有一个圆角扩展器，以及它下面的面板（“从”重叠的地方）。

在该面板中，我确实有一个 div 布局设置来创建两列。

编辑：这里要注意的另一件事是，具有名称和昵称的“占位符”的部分都是 ASP.NET 标签控件，如果这很重要的话。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-20T19:48:07.207

所以再四处摸索，我发现了这个问题。部分问题源于我设置的用于创建两个单独列的 div 布局使用 position:relative 和 float:right/left 属性。

根据我的阅读，一旦您开始增加 div 标签的位置属性，它就会影响渲染的 z-index，只有当日历控件动态“弹出”时才会变得复杂。

不幸的是，CalendarExtender 没有 Z-Index 属性，除非您想为日历编写完整的样式，而我不想这样做。但是，您可以通过将以下内容添加到 CSS 文件来扩展默认样式：

```
.ajax__calendar_container { z-index : 1000 ; } 
```

如果您不使用 CSS 文件，您也可以将其添加到页面的 head 部分：

```
<style type="text/css">
   .ajax__calendar_container { z-index : 1000 ; }
</style> 
```

这应该可以解决问题。它对我有用。

如果由于某种原因这不起作用（并且有些人仍然报告问题），更“激进”的方法是将输入字段和 CalendarExtender 包装在 DIV 标记中，然后将以下内容添加到您的 CSS 文件/HEAD 部分：

```
.ajax__calendar {
    position: relative;
    left: 0px !important;
    top: 0px !important;
    visibility: visible; display: block;
}
.ajax__calendar iframe
{
    left: 0px !important;
    top: 0px !important;
} 
```

...希望这对你有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T13:11:40.893

我发现解决 IE7 中的问题的*唯一方法是向我遇到问题的页面添加一些额外的 CSS。*没有多少 z-indexing 或 div 包装和重新设计有效果。

以下更改控件堆叠上下文。

```
.ajax__calendar_container
{
    position:static;
} 
```

这确实会导致日历弹出窗口垂直显示在扩展器控件的上方，而不是正常的垂直下方。对我来说这是可以接受的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T15:31:05.153

这对我来说看起来并不透明，它看起来像是在“隐藏”其他元素。您是否为任何项目指定了“z-index”？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T22:51:48.603

我有一个类似的问题，我用字段集上的 z 索引修复了

如果你有

```
<fieldset> some content... including ajax popup </fieldset>
<fieldset> some more content </fieldset> 
```

然后 ajax 弹出窗口在第二个字段集下方弹出，以修复将第一个字段集上的 z-index 设置为高于第二个字段集的 z-index，即如下所示。

```
<fieldset style="z-index: 2;"> some content... including ajax popup </fieldset>
<fieldset style="z-index: 1;"> some more content </fieldset> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-20T18:37:24.493

我发现解决这个问题的唯一方法是为 calendarExtender 编写一些 css 规则。它对我有用。代码如下：

[https://gist.github.com/carlosmr12/5825371](https://gist.github.com/carlosmr12/5825371)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-05T10:46:00.880

如果这些答案不能正常工作，则可能是隐藏溢出的问题。这可以使用以下 css 解决：

```
.ajax__scroll_none {
    overflow: visible !important;
    z-index: 10000 !important;
} 
```

# sql-server - 如何在 SQL Server 2008 上重新安装 MDAC？

> ID：302251
> 
> 赞同：1
> 
> 时间：2008-11-19T15:27:27.220
> 
> 标签：sql-server, windows-server-2008, mdac

我在连接到我的 SQL Server 2008 时遇到问题，我认为这可能是与 MDAC 相关的问题。是否有下载重新安装这些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-23T15:19:46.250

[MDAC 2.8 SP1](http://www.microsoft.com/downloads/details.aspx?FamilyID=78cac895-efc2-4f8e-a9e0-3a1afbd5922e&DisplayLang=en)

请记住，MDAC 是不应安装在服务器上的客户端软件。

您的问题更可能是协议或防火墙错误。你能提供更多信息吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-23T15:40:51.637

我同意 gbn；检查您是否允许在 SQL 服务器上进行远程连接，在某些版本中默认禁用；使用服务器上的配置管理器来验证 TCP/IP 是否已启用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-07T18:45:16.313

MDAC 是用于客户端访问的 ODBC 驱动程序。但是您需要它来连接 ASP 和 ASP.Net 数据库。

MDAC 2.8 SP1 不会安装在 Windows 2008 Server 中，因为它是为旧版本的 Windows 设计的。

您也许可以启用访问，我认为在 IIS 6.0 下，默认情况下禁用 32 位驱动程序和程序。有关详细信息，请参阅此 Microsoft 论坛帖子： [http ://forums.iis.net/p/1146917/1882658.aspx#1882658](http://forums.iis.net/p/1146917/1882658.aspx#1882658)

您需要检查 IIS 的应用程序池设置，并查看启用 32 位应用程序是否设置为 true，如果设置为 false，请将其更改为 true，然后重新启动 IIS 服务。MDAC 和 ODBC 驱动程序是 32 位的，您需要在应用程序池中启用 32 位应用程序访问，因为在 64 位 Windows 20008 Server RC1/RC2 版本中默认设置为 false。

看看能不能解决你的问题。

我什至尝试安装 MS-Office，但仍然无法访问数据库。直到我在应用程序池中启用 32 位访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T03:57:02.493

首先使用 MDAC 检查器，它会告诉您 MDAC 是否存在问题：

[http://support.microsoft.com/kb/307255](http://support.microsoft.com/kb/307255)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-20T21:49:05.207

我最近遇到了这个问题，他们在 Server 2008 中将 MDAC 重命名为 WDAC，这真的让你的搜索字符串消失了。要修复 WDAC，您需要运行系统文件检查器“sfc /scannow”

# asp.net - 具有内置验证器的自定义文本框：服务器端验证未触发

> ID：302252
> 
> 赞同：0
> 
> 时间：2008-11-19T15:27:35.940
> 
> 标签：asp.net, validation, custom-server-controls

我有一个看起来像这样的类：

```
public class TextField : TextBox
{
   public bool Required { get; set; }
   RequiredFieldValidator _validator;

   protected override void CreateChildControls()
   {
      base.CreateChildControls();

      _validator = new RequiredFieldValidator();
      _validator.ControlToValidate = this.ID;
      if(Required)
          Controls.Add(_validator);
   }

   public override void Render(HtmlTextWriter tw)
   {
      base.Render(tw);

      if(Required)
         _validator.RenderControl(tw);
   }
} 
```

这在始终启用 javascript 的内部应用程序中已经工作了一段时间。我最近注意到上游 javascript 错误可以阻止验证器触发，所以服务器端验证应该启动......对吗？对？

所以 Page.IsValid 属性总是返回 true （我什至尝试过事先显式调用 Page.Validate() ）。

经过一番挖掘，我发现验证器 init 方法应该将验证器添加到页面中，但由于我构建它的方式，我认为这不会发生。因此，客户端验证有效，但服务器端验证无效。

我试过这个：

```
protected override OnInit()
{
   base.OnInit();

   Page.Validators.Add(_validator); // <-- validator is null here
} 
```

但是当然验证器在这里是空的（有时它不是必需的，所以不应该添加）......但是 OnInit() 对我来说做出这些决定真的很早（Required 属性不会从 ViewState 加载例如）。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T16:23:42.690

CreateChildControls 基本上是用于具有子控件的控件。RequiredFieldValidator 就像 TextBox 的兄弟。

这是对我有用的代码：

```
public class RequiredTextBox : TextBox
    {
        private RequiredFieldValidator _req;
        private string _errorMessage;

        public string ErrorMessage
        {
            get { return _errorMessage; }
            set { _errorMessage = value; } 
        }

        protected override void OnInit(EventArgs e)
        {
            _req = new RequiredFieldValidator();
            _req.ControlToValidate = this.ID;
            _req.ErrorMessage = _errorMessage;
            Controls.Add(_req);
            base.OnInit(e); 
        }       

        protected override void Render(System.Web.UI.HtmlTextWriter writer)
        {
            base.Render(writer);
            _req.RenderControl(writer); 
        }
    } 
```

这里是后面的 ASP.NET 页面：

```
 protected void SubmitClick(object sender, EventArgs e)
        {
            if(Page.IsValid)
            {
                // do something
            }
        } 
```

这是 ASPX 代码：

```
 <MyControl:RequiredTextBox runat="server" ErrorMessage="Name is required!" ID="txtName"></MyControl:RequiredTextBox>

    <asp:Button ID="Btn_Submit" runat="server" Text="Submit" OnClick="SubmitClick" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T15:33:03.727

验证器必须从 BaseValidator 继承。

# sql-server - 将 PDF MP3 DOC XLS 等文件导入 MS SQL Server 数据表字段

> ID：302258
> 
> 赞同：1
> 
> 时间：2008-11-19T15:28:55.360
> 
> 标签：sql-server, vba, ms-access

有人知道如何在 MS SQL-Server 2000 中保存和检索文件吗？我猜图像数据类型可以用作容器。

我想导入/导出以下文件类型：DOC、XLS、PDF、BMP、TIFF 等。

由于资源问题，我们使用 MS-Access 2007 作为前端，所以我正在寻找 VBA 代码。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-26T00:07:44.827

我建议您（真的！）不要尝试（永远！）将文件作为数据保存在数据库中。您将很快面临关键的空间问题。

请考虑为文件存储创建文件夹。这些将用于保存/归档您的文件。文件夹路径可以存储在您的一张表中（`Tbl_Folder`例如）。然后，您可以将文件名存储在一个表中（例如`Tbl_File`，您将在其中有一个“ `filename`”字段）。您将能够使用该方法打开它并使用[文件脚本对象](http://www.databasejournal.com/features/msaccess/article.php/3709941/File-Management-with-Scripting-Object.htm)(FSO)`Access.followHyperlink`对其进行管理（复制/删除/移动）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T15:49:14.087

您可以使用 GetChunk 和 AppendChunk 执行此操作。

从[这篇文章中](http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/9acef36c-0f2d-4fa1-b71f-172a0ac89c4b/)，您可能会发现[此链接](http://support.microsoft.com/default.aspx?scid=kb;en-us;194975)很有帮助！

需要注意的一件事：

> 使用某些提供程序时，尤其是 ODBC 到 SQL Server 和其他数据库，您可能必须特别注意检索 BLOB 数据，例如将 BLOB 列放在字段列表的末尾并在访问 BLOB 之前引用所有非 BLOB 字段列。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T23:16:33.463

你可以用流来做到这一点。此代码应该可以帮助您完成第一步：

```
Set rs = New ADODB.Recordset
rs.Open "select * from YourTable", Connection, adOpenKeyset, adLockOptimistic

Set mstream = New ADODB.Stream
mstream.Type = adTypeBinary
mstream.Open
mstream.LoadFromFile "c:\myfile.pdf"
rs.Fields("blobfield").Value = mstream.Read
rs.Update 
```

将文件存储在数据库中并没有什么危险。我们有一个大约 20 GB 的 SQL Server 数据库，其中包含大约 40.000 个文档、图像等。3 年多来从未出现过问题。

# c# - 在 C# 中使用不带 TO 的 BCC 通过 SMTP 发送邮件

> ID：302271
> 
> 赞同：10
> 
> 时间：2008-11-19T15:32:12.200
> 
> 标签：c#, email, smtp, bcc

我正在尝试使用`System.Net.Mail.MailMessage`C# 中的类来创建一封电子邮件，该电子邮件全部通过`BCC`. 我不想包含`TO`地址，但似乎必须包含地址，因为如果我在构造函数中使用空字符串作为`TO`地址，则会出现异常。`MailMessage`错误指出：

```
ArgumentException
The parameter 'addresses' cannot be an empty string.
Parameter name: addresses 
```

当然可以仅使用发送电子邮件，`BCC`因为这不是 SMTP 的限制。

**有没有解决的办法？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-19T15:34:25.800

对不希望人们一直回复的内部邮件爆炸做同样的事情。

将其发送给您**自己**（或虚拟帐户），然后添加您的密件抄送列表。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-25T19:26:16.087

我认为如果您注释掉整`emailMessage.To.Add(sendTo);`行，它将发送`To`字段为空的电子邮件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T15:34:25.707

您必须包括一个收件人地址。只需将其发送到您不介意接收邮件的“垃圾”电子邮件地址即可。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T15:46:00.363

它甚至不需要是一个真实的电子邮件地址，我通常使用`Mailer@CompanyName.com`for`TO`和`NoReply@CompanyName`for `FROM`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-25T19:32:23.827

只是不要在 To-property 上调用 Add-method。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-17T18:06:05.787

必须有一个地址。自从 80 年代最初的 sendmail 和我所知道的所有 SMTP 邮件程序的实现以来，就一直采用这种方式，具有相同的要求。您可以只使用一个虚拟地址。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-08T16:21:12.177

您可以使用临时假地址，然后在以下情况下将其删除：

```
MailMessage msg = new MailMessage(from, "fake@example.com");
msg.To.Clear();
foreach (string email in bcc.Split(';').Select(x => x.Trim()).Where(x => x != ""))
{
     msg.Bcc.Add(email);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-19T23:02:14.510

我认为您正在尝试执行以下操作：

```
var msg = new MailMessage("no-reply@notreal.com", ""); 
```

这就是您看到错误消息的原因。

相反，尝试这样的事情：

```
MailMessage msg = new MailMessage();
SmtpClient SmtpServer = new SmtpClient("smtp.notreal.com");
msg.From = new MailAddress("no-reply@notreal.com");
//msg.To.Add("target@notreal.com"); <--not needed
msg.Bcc.Add("BCCtarget@notreal.com"); 
```

# asp.net-mvc - ASP MVC 中的强类型视图

> ID：302273
> 
> 赞同：1
> 
> 时间：2008-11-19T15:33:11.840
> 
> 标签：asp.net-mvc

我一直在浏览 Scott Guthrie 的 MVC 教程，似乎执行强类型视图的语法已经改变，或者我做错了什么......

我的控制器代码：

```
return View(CurrentUser); 
```

视图中的代码：

```
 public partial class EditProfile : ViewPage<User> 
```

然而，如果我输入，在视图的前端代码中

```
ViewData. 
```

对于我的 User 类中可用的属性，我根本没有得到任何智能感知，实际上它看起来像 IEnumerable 中可用的方法列表

有人请让我摆脱痛苦:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-19T15:34:57.267

```
ViewData.Model 
```

你是如此接近:)

# unit-testing - 在 SetUp 中或在测试方法期间初始化要测试的对象？

> ID：302277
> 
> 赞同：5
> 
> 时间：2008-11-19T15:33:59.217
> 
> 标签：unit-testing

我想知道要测试的对象是否应该是一个字段，并因此在`SetUp`方法期间设置（即 JUnit、nUnit、MS 测试……）。

考虑以下示例（这是带有 MsTest 的 C♯，但任何其他语言和测试框架的想法应该类似）：

```
public class SomeStuff
{
    public string Value { get; private set; }

    public SomeStuff(string value)
    {
        this.Value = value;
    }
}

[TestClass]
public class SomeStuffTestWithSetUp
{
    private string value;
    private SomeStuff someStuff;

    [TestInitialize]
    public void MyTestInitialize()
    {
        this.value = Guid.NewGuid().ToString();
        this.someStuff = new SomeStuff(this.value);
    }

    [TestCleanup]
    public void MyTestCleanup()
    {
        this.someStuff = null;
        this.value = string.Empty;
    }

    [TestMethod]
    public void TestGetValue()
    {
        Assert.AreEqual(this.value, this.someStuff.Value);
    }
}

[TestClass]
public class SomeStuffTestWithoutSetup
{
    [TestMethod]
    public void TestGetValue()
    {
        string value = Guid.NewGuid().ToString();
        SomeStuff someStuff = new SomeStuff(value);
        Assert.AreEqual(value, someStuff.Value);
    }
} 
```

当然，如果只有一个测试方法，第一个例子就太长了，但是如果有更多的测试方法，这可能是安全的一些冗余代码。

每种方法的优缺点是什么？有没有“最佳实践”？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-19T15:42:25.863

*一旦您开始初始化字段并通常在*测试方法本身中设置测试的上下文，这是一个滑坡。这会导致大量的测试方法和无法很好地解释自己的真正难以管理的夹具。

相反，您应该查看 BDD 风格的命名和测试组织。每个上下文制作一个夹具，而不是每个被测系统一个夹具。然后您的 [setup] 确实设置了上下文，并且您的测试可以是简单的单行断言。

当您看到执行此操作的测试输出时，阅读起来会容易得多：

OrderFulfillmentServiceTests.cs

*   with_an_order_from_a_new_customer

    *   它应该从信用服务中检查他们的信用
    *   它不应该打折
*   有有效的信用检查

    *   它应该减少库存
    *   它应该运送货物
*   与德克萨斯州或加利福尼亚州的客户

    *   它应该增加适当的销售税
*   来自黄金客户的订单

    *   它不应该检查信用
    *   它应该免费添加加急运输

我们的测试现在是我们系统的非常好的文档。每个“with_an...”都是一个测试夹具，它下面的项目是测试。在其中，您设置上下文（类名描述的世界状态），然后测试执行简单的断言来验证方法名所说的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T15:38:39.600

第二种方法更具可读性，并且更容易在视觉上追踪。

然而，第一种方法意味着更少的重复。

我发现我倾向于使用 SetUp 创建对象（尤其是对于具有许多依赖项的对象），然后设置测试本身使用的值。根据经验，这提供了适量的代码重用与可读性/可追溯性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T16:30:57.997

通过与 Kent Beck 讨论 jUnit 的设计，我知道测试类是在测试之间共享设置的一种方式，因此使用通用初始化是其意图。但是，除此之外，这意味着将需要不同设置的测试拆分为具有揭示名称的单独测试类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T15:46:27.773

就个人而言，我使用 Setup 和 Teardown 方法有两个不同的原因，尽管我认为其他人会有不同的原因。

1.  当所有测试都使用公共启动逻辑并且在设置中创建的对象的单个实例被设计为可重用时，请使用设置和拆卸方法。
2.  当在每个 TestMethod 中重复创建和销毁所创建的任何对象所花费的时间足以减慢单元测试过程时，请使用 Setup 和 Teardown 方法。

为了让您了解我在这些场景中运行的频率，在我现在正在处理的一个项目中，我的测试类中只有两个（大约 80 个）明确需要 Setup 和 Teardown 方法，两次都是由于我为每次测试执行启用了最多 10 秒，因此满足我的第二个原因。

我也更喜欢在 TestMethod 中创建和销毁对象的可读性，尽管这对我来说不是一个突破点或卖点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T16:43:29.653

我采用的方法介于中间——我使用 TearDown 和 SetUp 创建一个测试“沙盒”目录（并在完成后将其删除），以及使用一些默认值初始化一些测试成员变量，这些默认值将用于测试类。然后我设置了一些“辅助方法”——一个通常称为 InstantiateClass() 我用它来调用默认参数（如果有的话），我可以在每个显式测试中根据需要覆盖这些参数。

```
[Test]
public void TestSomething()
{
    _myVar = "value";
    InstantiateClass();
    RunTheClass();
    Assert.IsTrue(this, that);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-26T18:33:14.607

在实践中，我发现设置方法很难推断失败的测试，并且必须滚动到文件顶部附近的某个位置（可能非常大）以找出协作者破坏了什么（模拟不容易) 并且在您的 IDE 中导航没有可点击的参考。简而言之，你失去了空间局部性。

静态辅助方法更明确地显示协作者，并且避免不必要地扩大变量范围的字段。

# security - Sharepoint：如何以编程方式管理 SPFolder 和 SPListItem 权限

> ID：302279
> 
> 赞同：6
> 
> 时间：2008-11-19T15:34:21.697
> 
> 标签：security, sharepoint, permissions

我想知道我是否遗漏了什么。我会这样做：对于 SPFolder，我将更改关联项目的权限 (SPFolder.Item)。所以我想管理 SPFolder 权限归结为管理 SPListItem 权限。对于 SPListItem，我将首先打破角色继承，`SPListItem.BreakRoleInheritance()`然后使用`RoleAssignments`集合在那里添加和删除角色。

我想知道 RoleAssignments 是否是管理 SPListItem 权限（除了继承）的唯一方法，是否有办法在没有角色的情况下管理个人权限。还有 EffectiveBasePermissions 属性，但我不确定。

所以问题是除了 RoleAssignments 集合之外，还有其他方法（除了继承）来管理 SPListItem 权限吗？

**@Edit：**还有AllRolesForCurrentUser，但我想你可以从RoleAssignments 属性中获得相同的信息，所以这个只是为了方便。

**@Edit：**正如弗洛在他的回答中指出的那样，设置有问题

```
folder.ParentWeb.AllowUnsafeUpdates = true; 
```

并使用`BreakRoleInheritance`“false”参数（即没有复制父对象的权限）。

```
folder.Item.BreakRoleInheritance(false); 
```

`BreakRoleInheritance`在允许不安全的更新后，根本不会像您期望的那样处理 GET 请求。大概该方法重置`AllowUnsafeUpdates`回“假”。

我知道的一种解决方法是在 BreakRoleInheritance(true) 之后手动删除继承的权限，如下所示：

```
folder.Item.BreakRoleInheritance(false);
while(folder.Item.RoleAssignments.Count > 0) {
    folder.Item.RoleAssignments.Remove(0);
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T17:06:48.890

你说得很对。我相信 RoleAssignments 确实是直接管理权限的唯一机制。这是一篇[文章](http://blogs.msdn.com/robgruen/archive/2007/11/15/how-to-programmatically-set-permissions-on-files-folders-in-a-sharepoint-document-library.aspx)，展示了如何做到这一点的快速示例。当我做一些更复杂的事情时，我也使用了这[两个](http://blogs.msdn.com/pranab/archive/2007/07/04/how-to-set-item-level-permission-for-moss-wss-list-document-library-programmatically.aspx) [帖子。](http://blogs.msdn.com/pranab/archive/2008/02/14/how-to-set-item-level-permission-for-sharepoint-2007-moss-wss-list-document-library-programmatically-part-2.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-27T11:03:20.807

当使用 BreakRoleInheritance() 方法时，这篇[文章](http://www.wictorwilen.se/Post/BreakRoleInheritance-and-AllowUnsafeUpdates.aspx)也会很有趣。这是关于您在使用 BreakRoleInheritance(false) 时可能遇到的问题。

# jsp - 来自 JSP 的可编辑 Word 文档

> ID：302284
> 
> 赞同：0
> 
> 时间：2008-11-19T15:34:39.887
> 
> 标签：jsp, ms-word, edit

有没有办法在 JSP 页面中创建指向 Microsoft Word 文档的链接，您可以对其进行编辑并将其自动回发到服务器？我正在使用 Websphere 门户。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T15:49:13.603

您可以查看[WebDAV](http://www.webdav.org/)。我相信 Microsoft Word 了解如何从 WebDAV 服务器读取和保存文档。您需要实现一个 WebDAV 服务器才能实现这一点，但我确信有多种可用的开源实现——谷歌很快就会找到[这个](http://webdav-servlet.sourceforge.net/)，看起来很有趣。

# firefox - Firefox 中的 Cookie

> ID：302294
> 
> 赞同：17
> 
> 时间：2008-11-19T15:38:08.773
> 
> 标签：firefox, cookies

Firefox 将 cookie 存储在哪里以及它们以什么格式存储

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-19T15:40:23.167

# 对于 Windows

您的 cookie 存储在：

*   在 Firefox 2.x 中：`cookies.txt`unix 格式文本文件中的纯文本文件 ( )（例如，换行符用 LF 代替 CRLF）。
*   在 Firefox 3.0 及更高版本中：代表[**SQLite 数据库**的二进制文件，您可以在其上进行查询](http://www.webdevbros.net/2008/07/31/query-your-firefox-cookies-with-sql/)( [**`cookies.sqlite`**](http://kb.mozillazine.org/Cookies))。

该文件位于您的[个人资料文件夹](http://support.mozilla.com/tiki-view_forum_thread.php?locale=ro&comments_parentId=192052&forumId=1)下：

```
C:\Documents and Settings\username\Application Data\Mozilla\Firefox\Profiles\xxxx.default 
```

其中`xxxx`是一些随机出现的字母数字字符串。

您可能需要安装 Firefox 插件[View Cookies](http://www.bitstorm.org/extensions/view-cookies/)以更好地管理它们。

![替代文字](https://i.stack.imgur.com/Wwunb.jpg)

# 对于 Linux

您的 cookie 存储在：

```
~/.mozilla/firefox/xxxx.default/cookies.sqlite 
```

其中`xxxx`是一些随机出现的字母数字字符串。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-08-13T16:50:30.470

请注意，在 Firefox 3.5 中，cookies.sqlite 被 Firefox 独占锁定，因此您必须在阅读之前对其进行复制。

此外，在 Firefox 退出之前，cookies.sqlite 可能不会刷新到磁盘，因此如果 Firefox 仍在运行，您不能假设磁盘上的文件包含您需要的 cookie。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T15:41:58.593

在 XP 上，在 C:\documents and settings 的 Application Data\Mozilla 文件夹中。

例如，在我的机器上是：

C:\Documents and Settings\\Application Data\Mozilla\Firefox\Profiles\\cookies.sqllite

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T16:02:11.843

它存储在`PathFromCSIDL(CSIDL_APPDATA) + "Mozilla\Firefox\Profiles\" + [[profiledirectory]] + "\" + "cookies.sqlite"`. 还有一个 cookies.txt 文件，但 if 可能是空的。 `PathFromCSIDL`可以通过 windows API 相对容易地实现。

如果您的目标是以编程方式访问 cookie，您可能希望这样做而不是硬编码路径。请注意，`[[profiledirectory]]`可能有多个配置文件，因此可能有多个目录，每个配置文件/目录都有自己的 cookie。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T15:39:48.113

该目录取决于您的操作系统，但它们似乎存储在 SQLite 数据库中。

# asp.net - ASP.net 信息事件“应用程序编译正在启动”

> ID：302302
> 
> 赞同：2
> 
> 时间：2008-11-19T15:39:22.937
> 
> 标签：asp.net, iis, events

我们使用 MSMQ 来捕获我们的 asp.net 站点抛出的所有事件，并将数据存储到我们的数据库中。一整天，我们都可以在日志数据库中 `1003`看到事件 ID 。`Title = "Application compilation is starting"`

但是，我们没有看到相应的事件`1004`，`"Application compilation ends".` 我想知道这可能是什么原因造成的？我们使用预编译选项（允许更新）部署我们的站点，并且我们对会话对象的使用率很高（我知道这很糟糕！）。该消息是否表明我们的 Web 应用程序正在自行重新启动？

谢谢，赫尔曼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-08-19T02:21:29.770

尝试在不允许更新的情况下进行预编译。当您允许更新时，会进行第二次运行时编译，如以下文章中所述`Precompling for Deployment and Update.`

[http://msdn.microsoft.com/en-us/library/399f057w%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/399f057w%28v=vs.85%29.aspx)

# c# - 文本框验证，焦点切换问题

> ID：302303
> 
> 赞同：6
> 
> 时间：2008-11-19T15:39:25.977
> 
> 标签：c#, winforms, validation, controls, focus

早上好，

我正在开发一个使用控件验证的 C# winform 应用程序。我遇到的问题是，当用户单击文本框并尝试单击退出时，验证会触发并重新聚焦控件，基本上用户无法单击控件之外的另一个控件。

我想要的结果是在用户单击提交按钮时验证表单上的所有控件。我想让 errorProvider 图标出现在错误的字段旁边，并允许用户在他们认为合适的时候更正它们。

我的问题是，当出现错误时，如何设置控件以允许用户在外部单击。我希望用户能够填写表格的其余部分并自行返回错误，而不是被迫立即处理。

提前感谢您的任何帮助和建议，

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-30T09:53:51.723

表单具有 AutoValidate 属性，可以设置为允许更改焦点

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-10-23T17:44:20.753

表单属性是“AutoValidate”，它会影响表单上的所有控件。这是一个枚举；将其设置为 System.Windows.Forms.AutoValidate.EnableAllowFocusChange 以允许用户退出验证失败的控件，但仍显示允许用户拉出错误工具提示的错误图标。

控件“CausesValidation”属性是一个布尔值。如果为真，则控件引发触发 errorProvider 的验证事件。这是错误的，一切都被绕过了，用户可以退出控制，但没有错误图标或工具提示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T15:42:25.830

最简单的方法是将所有验证放在提交按钮处理程序中，而不是将其放在控件中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T16:55:17.370

我们有一个验证函数，如果表单有效则返回 bool 并设置表单上的所有错误提供程序：

看起来像这样：

```
 private void OnSave()
    {
      if(ValidateData())
      {
        //do save
      }
    }

    public bool ValidateData()
    {
        errorProvider.Clear();
        bool valid = true;
        if (this.defectStatusComboBox.SelectedIndex == -1)
        {
            errorProvider.SetError(defectStatusComboBox, "This is a required feild.");
            valid = false;
        }
        //etc...
        return valid;
     } 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-19T15:44:20.803

有一个属性（我认为它在表单上）允许您在验证失败时在字段之间移动。我不记得它叫什么了，但我认为它的名称非常具有描述性。

# sql-server - Microsoft SQL Server - 事务日志已满是什么意思？

> ID：302310
> 
> 赞同：3
> 
> 时间：2008-11-19T15:40:49.703
> 
> 标签：sql-server, tsql, transaction-log

事务日志已满是什么意思？我将文件设置为在需要时增长 20%。我的驱动器上还剩 4GB。如何永久解决此问题？运行这些命令可以暂时解决问题：

```
DBCC SHRINKFILE('MyDatabase_log', 1)
使用 TRUNCATE_ONLY 备份日志 MyDatabase
DBCC SHRINKFILE('MyDatabase_log', 1)

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T15:56:48.393

事务日志是 SQL 服务器“记录”它所做的每一个更改的地方，因此如果出现问题（从软件崩溃到电源故障，再到小行星撞击……也许不是小行星撞击），它可以“恢复”通过“撤消”自上次一致的“检查点”以来所做的所有更改 - 回到数据库的最后一次“一致”状态......在那个检查点。每次事务完成（或“提交”）时，已存储在事务日志中的所有更改都被标记为“ok”，并且 CheckPopint 标记允许在这些更改之后向前移动，以便将来恢复之后只会“撤消”更改到某个点。发生这种情况后，

正如另一位先生所提到的，您在服务器上设置的“恢复模型”控制了检查点之前对事务日志条目的影响。在简单模式下，它们会在检查点发生时被删除，但如果主数据磁盘崩溃，您将面临风险，因为您的事务日志不会包含自上次备份以来写入磁盘的更改。

在其他恢复模式中，在您进行备份之前不会删除事务日志条目，从而保护您免受此风险...

所以，一般来说，当这个问题发生时，这是因为服务器处于设置的“正常”（不简单）恢复模型之一（增量或完整）并且他们没有进行备份......。在这种情况下，交易日志一直在增长……而且在增长……有点像电视上的那些前列腺广告……

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T16:01:37.023

听起来您没有适当的备份策略。执行任何备份（完整备份、差异备份或事务日志）都将截断日志，另外还有一个好处是可以保存一个点，在发生故障时您可以从中恢复。您可以运行数据库维护向导来帮助您设置定期运行的备份计划。

如果你真的根本不关心你的数据（在这种情况下，我想知道你为什么有一个数据库），那么你可以将数据库的恢复模式设置为“简单”，这将完全阻止 TLog 增长.

最后一件事：如果您正在执行批量加载操作，您可能还会考虑在执行批量操作时更改为“批量记录”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T15:46:03.563

您应该查看[SQL Server 恢复模型](http://msdn.microsoft.com/en-us/library/ms366344.aspx)。简短的回答是将恢复模式更改为“简单”，但这对备份/恢复有影响。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T15:52:50.473

经常备份，每次备份数据库时都会清除事务日志。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-20T21:20:24.573

您必须备份事务日志而不仅仅是数据库，否则日志将继续增长，直到您用完空间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-12T16:40:46.030

另一个简单的答案是您的备份可能没有安排。在升级周期中，我们的数据库备份计划之一已从作业中删除。日志一直在增长，直到我们发现备份没有运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T15:49:20.467

我不会做 20% 的增长率。当它需要增长时，这可能会产生重大影响。如果它曾经增长到，比如说，100GB，它必须在下一次增长时增长 20GB - 准备好让你的系统变慢，而不是在这种情况发生时......相反，我会将它设置为固定速率 - 比如 100MB . 当然我们不知道当前的尺寸来做出更准确的推荐。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-26T02:22:07.893

有许多不同的方法可以解决这个问题。这取决于您的备份要求。

主要问题是您的事务日志没有定期备份，这导致事务日志不断增长。

SQL Server 2005 具有**简单**恢复模式（数据库本身的属性/选项），我主要在不需要每小时快照的 DEV 和 TEST 环境中使用它，事务日志仅增长到足以处理服务器上运行的最大事务. 此恢复模式不需要计划或维护计划。

在 SQL Server 2000 中，您基本上有一个计划的备份脚本，该脚本运行您使用的相同命令，大约每小时一次：

`BACKUP LOG MyDatabase WITH TRUNCATE_ONLY`

对于生产环境，通常我们在数据库维护计划中安排了每小时的事务日志备份和每日的完整备份。这可以将事务日志截断到合理的大小（显然，这个大小可以保存 1 小时的事务数据）。

# wpf - 如何通过 DataBinding/Triggers 有选择地设置 TabItem 的“可见性”

> ID：302312
> 
> 赞同：6
> 
> 时间：2008-11-19T15:41:16.707
> 
> 标签：wpf, data-binding, eventtrigger

我有一个标签页，如果属性 (BlahType) 设置为 1，则应该隐藏，如果设置为 0，则显示。这就是我*想要*做的：

```
<TabItem Header="Blah">
    <TabItem.Triggers>
        <DataTrigger Binding="{Binding BlahType}" Value="0">
            <Setter Property="TabItem.Visibility" Value="Hidden" />
        </DataTrigger>
    </TabItem.Triggers>
</TabItem> 
```

问题是，我收到此错误：

```
"Triggers collection members must be of type EventTrigger" 
```

如果你用谷歌搜索那个错误，你会看到[Dr. WPF 解释了这个错误](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/f816fd72-4f41-4a1a-b0a2-4e409e89c75c/)。有没有一种干净的方法来做我想要在这里实现的目标？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-19T15:51:52.287

我相信一个控件的 Triggers 集合目前只支持 EventTriggers。如果您想使用 DataTrigger，只需将其放在样式中，例如：

```
<TabItem Header="Blah">
    <TabItem.Style>
        <Style>
            <Style.Triggers>
                <DataTrigger Binding="{Binding BlahType}" Value="0">
                    <Setter Property="TabItem.Visibility" Value="Hidden" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </TabItem.Style>
</TabItem> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T15:49:32.417

好吧，你不能使用触发器来做到这一点（除非你在 DataTemplate、ControlTemplate 或 Style 中）。

您可以使用绑定来执行此操作，您需要编写一个自定义 ValueConverter，它将在 0/1 到 Visible/Hidden 之间转换，然后您可以将 Visibility 属性绑定到 BlhaType 属性。

或者您可以在代码中设置可见性并放弃基于 XAML 的方法（我会这样做）。

# c++ - 如何更改注册表项上的 ACL？(C++)

> ID：302314
> 
> 赞同：1
> 
> 时间：2008-11-19T15:41:46.380
> 
> 标签：c++, windows, permissions, registry

我需要删除注册表项。它在设置值上有一个拒绝 ACL（我需要这个权限才能删除它）。

如何更改 C++ 中的 ACL？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T15:45:08.493

您可以使用 RegSetKeySecurity 调整安全设置，然后照常删除密钥。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T13:33:42.497

这是一个 Win32 常见问题解答。

见 Win32 api ng 新闻://194.177.96.26/comp.os.ms-windows.programmer.win32

# scripting - 想要编写 Windows WMI (wmiprvse.exe) 脚本以释放文件句柄

> ID：302315
> 
> 赞同：2
> 
> 时间：2008-11-19T15:41:50.543
> 
> 标签：scripting, windows-services, wmi

我正在使用由其他人编写的 VB 脚本文件，该文件使用 Windows Management Instrumentation (WMI) 调用来检查多个 Windows 服务的状态。此脚本按设定的计划每隔几分钟运行一次。我需要升级/替换这些服务的 .exe。

我停止了 VB 脚本，停止了服务，然后卸载了服务，因此它们不再出现在“服务”面板 (services.msc) 中。不幸的是，WMI (wmiprvse.exe) 仍然拥有服务 .exe 文件的句柄。我可以通过重新启动系统来释放句柄，但我想尽可能避免这种情况，因此这可以是完全脚本化/自动升级。

有没有办法强制 WMI 释放它在 .exe 上的句柄？请记住，我是使用 WMI 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T15:54:33.623

我也在寻找解决这个问题的方法。还想了解为什么 wmiprsve 对我的一些服务可执行文件有句柄，但对其他可执行文件没有。

我正在使用的解决方法是终止 wmiprvse 进程。您可以使用 SysInternals 命令行工具（pslist、pskill）自动获取进程 ID 并执行终止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-11T08:37:52.543

您可以简单地重新启动 WMI 服务 (winmgmt) 以强制它释放您的文件。如果您的服务在 WMI 启动时未注册，则不会锁定文件。

停止服务、卸载服务、重启 WMI、替换文件、启动服务。

# c++ - Firefox 插件在 Chrome 中崩溃

> ID：302329
> 
> 赞同：1
> 
> 时间：2008-11-19T15:45:16.527
> 
> 标签：c++, google-chrome, npapi

据我所知，Google Chrome 可以运行使用[NPAPI](http://en.wikipedia.org/wiki/NPAPI)编写的浏览器插件。

我写了一个在 Firefox 中可以很好地完成它的工作，但是一旦你将它嵌入到一个页面上，它就会让 Chrome 崩溃和烧毁。我什至不必调用我的任何方法，嵌入足以导致崩溃。

我该如何调试？我尝试将调试器附加到 chrome，但我得到的堆栈跟踪在 Chrome 本身的深处，就像我说的，没有“我的”实际代码正在运行，但应该只是 NPAPI 初始化代码。

我会很感激一些指示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T18:17:36.400

Chromium 开发文档描述了将 Visual Studio 附加到 Chrome 进程的一些技巧：[Chromium Developer Documentation > Debugging Chromium](http://dev.chromium.org/developers/how-tos/debugging)。

在 Chrome 中使用 NPAPI 插件可能会遇到一些问题：

*   您的插件将在与 Chrome UI 不同的进程中运行。（你可能已经知道了：）
*   如果加载了插件的多个实例（在同一个 HTML 页面或不同的 Chrome 选项卡中），您的插件实例*将*在同一个进程中一起运行。如果您有全局变量，则您的插件实例可能会相互影响。
*   Chrome 使用 DEP（数据执行保护），但 Firefox 没有。如果您使用 ATL 或其他 JITted 代码技巧，DEP 可能会使您的插件崩溃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T20:06:50.473

Chrome 是开源的……您是否尝试过下载源代码并构建它？这样，您至少可以将您的 IDE 指向源代码树并让它在崩溃时自动附加，这可以为您提供更多关于发生了什么的信息。

当然，这不会解决您的错误，但它可能会帮助您向 Chrome 团队报告一个错误。如您所知，插件 API 对 Chrome 来说是相当新的，并且错误可能是他们的而不是您的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T09:13:08.573

事实证明，我使用的旧 NPAPI 插件示例中的部分初始化代码导致了崩溃。很抱歉，我很久以前就解决了这个问题，但似乎无法在版本控制历史记录中找到我为修复它所做的具体修改。无论如何，我的问题已经解决，是由于我愚蠢和盲目相信示例代码造成的。

# java - Struts 中有哪些可用的安全特性？

> ID：302357
> 
> 赞同：1
> 
> 时间：2008-11-19T15:51:48.980
> 
> 标签：java, security, struts, owasp

我的任务是开发一个 Web 应用程序，并且正在考虑使用 Struts 框架，因为它似乎是一个标准并且易于实现。

但是，在做出决定之前，我需要了解 Struts 中可用的安全特性。

是否有使用 Struts处理[OWASP Top 10的有效方法？](http://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project)如果是这样，我将如何完成它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T01:29:10.310

Struts 为您提供了一个 MVC 框架，它具有有限的安全功能，例如您可以将角色映射到操作。我会建议您研究更成熟的东西，例如[Spring Security](http://static.springframework.org/spring-security/site/)（以前称为 Acegi）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T00:23:27.710

处理 OWASP Top 10 in struts 的最佳方法是查看 OWASP Enterprise Security API...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T00:33:21.027

即使对于 YC 提到的特性，您也可能不想使用开箱即用的 Struts 配置文件来为您的操作设置 ACL。在 HttpRequest 离开 ActionServlet 时，在它到达您的 Struts 操作之前，以编程方式检查状态可能会更好（即，这个 HttpRequest 是否来自给定 URL 的经过身份验证和授权的用户？）。或者，您可以使用 ServletFilter 拦截请求，但您必须小心确保它是线程安全的。

# cocoa - 观察 NSMutableArray 以进行插入/删除

> ID：302365
> 
> 赞同：76
> 
> 时间：2008-11-19T15:54:17.023
> 
> 标签：cocoa, key-value-observing, key-value-coding

一个类具有类型为 NSMutableArray 的属性（和实例 var），并带有合成访问器（通过`@property`）。如果您使用以下方法观察此数组：

```
[myObj addObserver:self forKeyPath:@"theArray" options:0 context:NULL]; 
```

然后像这样在数组中插入一个对象：

```
[myObj.theArray addObject:NSString.string]; 
```

**未**发送observeValueForKeyPath... 通知。但是，以下确实发送了正确的通知：

```
[[myObj mutableArrayValueForKey:@"theArray"] addObject:NSString.string]; 
```

这是因为`mutableArrayValueForKey`返回一个负责通知观察者的代理对象。

但是合成的访问器不应该自动返回这样一个代理对象吗？解决这个问题的正确方法是什么——我应该编写一个只调用的自定义访问器`[super mutableArrayValueForKey...]`吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-11-20T02:10:56.263

> 但是合成的访问器不应该自动返回这样一个代理对象吗？

不。

> 解决这个问题的正确方法是什么——我应该编写一个只调用的自定义访问器`[super mutableArrayValueForKey...]`吗？

不。实现[数组访问器](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/KeyValueCoding/DefiningCollectionMethods.html#//apple_ref/doc/uid/10000107i-CH17-SW1)。当您调用这些时，KVO 将自动发布适当的通知。所以你所要做的就是：

```
[myObject insertObject:newObject inTheArrayAtIndex:[myObject countOfTheArray]]; 
```

正确的事情会自动发生。

为方便起见，您可以编写`addTheArrayObject:`访问器。此访问器将调用上述真正的数组访问器之一：

```
- (void) addTheArrayObject:(NSObject *) newObject {
    [self insertObject:newObject inTheArrayAtIndex:[self countOfTheArray]];
} 
```

（您可以并且应该为数组中的对象填写正确的类，代替`NSObject`.）

然后，而不是`[myObject insertObject:…]`，你写`[myObject addTheArrayObject:newObject]`。

可悲的是，上次我检查过，`add<Key>Object:`它的对应物`remove<Key>Object:`只被 KVO 识别为集合（如在 NSSet 中）属性，而不是数组属性，所以你不会得到免费的 KVO 通知，除非你在它确实识别的访问器之上实现它们. 我为此提交了一个错误：x-radar://problem/6407437

我的博客上[有所有访问器选择器格式的列表。](http://boredzo.org/blog/archives/2007-08-07/a-complete-raw-list-of-kvc-accessor-selector-formats)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-19T19:51:49.853

在这种情况下，我不会使用`willChangeValueForKey`and 。`didChangeValueForKey`一方面，它们旨在表明该路径上的值已更改，而不是一对多关系中的值正在更改。如果你这样做，你会想要使用`willChange:valuesAtIndexes:forKey:`它。即便如此，使用像这样的手动 KVO 通知是不好的封装。更好的方法是在实际拥有数组的类中定义一个方法`addSomeObject:`，其中包括手动 KVO 通知。这样，将对象添加到数组的外部方法也不需要担心处理数组所有者的 KVO，这不是很直观，如果您开始向数组添加对象，可能会导致不需要的代码和可能的错误从几个地方排列。

在这个例子中，我实际上会继续使用`mutableArrayValueForKey:`. 我对可变数组并不积极，但我相信从阅读文档中可以看出，这种方法实际上用一个新对象替换了整个数组，所以如果性能是一个问题，你还需要在拥有数组的类中`insertObject:in<Key>AtIndex:`实现`removeObjectFrom<Key>AtIndex:`.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-10-31T14:07:13.663

当您只想观察计数发生变化时，可以使用聚合键路径：

```
[myObj addObserver:self forKeyPath:@"theArray.@count" options:0 context:NULL]; 
```

但请注意，数组中的任何重新排序都不会触发。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-17T04:02:28.597

您自己对自己问题的回答几乎是正确的。不要`theArray`对外销售。相反，声明一个不同的属性，`theMutableArray`对应于无实例变量，并编写此访问器：

```
- (NSMutableArray*) theMutableArray {
    return [self mutableArrayValueForKey:@"theArray"];
} 
```

结果是其他对象可以`thisObject.theMutableArray`用来对数组进行更改，而这些更改会触发 KVO。

其他答案指出，如果您也实施`insertObject:inTheArrayAtIndex:`并且`removeObjectFromTheArrayAtIndex:`仍然正确，效率会提高。但是没有必要让其他对象知道这些或直接调用它们。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-04-17T01:29:18.250

如果您不需要 setter，您也可以使用下面更简单的形式，它具有相似的性能（在我的测试中具有相同的[增长率](http://en.wikipedia.org/wiki/Big_O_notation)）和更少的样板。

```
// Interface
@property (nonatomic, strong, readonly) NSMutableArray *items;

// Implementation
@synthesize items = _items;

- (NSMutableArray *)items
{
    return [self mutableArrayValueForKey:@"items"];
}

// Somewhere else
[myObject.items insertObject:@"test"]; // Will result in KVO notifications for key "items" 
```

这是有效的，因为如果数组访问器没有实现并且键没有设置器，`mutableArrayValueForKey:`将查找名称为`_<key>`or的实例变量`<key>`。如果找到，代理会将所有消息转发到该对象。

请参阅[这些 Apple 文档](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/KeyValueCoding/Articles/SearchImplementation.html)，“有序集合的访问器搜索模式”部分，#3。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T17:49:41.813

你需要把你的`addObject:`电话`willChangeValueForKey:`和`didChangeValueForKey:`电话包装起来。据我所知，您正在修改的 NSMutableArray 无法了解任何观察其所有者的观察者。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-11T08:35:28.257

一种解决方案是使用 NSArray 并通过插入和删除从头开始创建它，例如

```
- (void)addSomeObject:(id)object {
    self.myArray = [self.myArray arrayByAddingObject:object];
}

- (void)removeSomeObject:(id)object {
    NSMutableArray * ma = [self.myArray mutableCopy];
    [ma removeObject:object];
    self.myArray = ma;
} 
```

比你得到 KVO 并且可以比较新旧数组

注意：self.myArray 不应为 nil，否则 arrayByAddingObject: 也会导致 nil

视情况而定，这可能是解决方案，并且由于 NSArray 仅存储指针，因此这不是太大的开销，除非您使用大型数组和频繁的操作

# theory - XKCD 中的 Wolfram 规则 34

> ID：302369
> 
> 赞同：89
> 
> 时间：2008-11-19T15:54:55.027
> 
> 标签：theory, cellular-automata

[#505 xkcd](http://en.wikipedia.org/wiki/Xkcd)中的悬停“笑话”吹捧“我根据 Wolfram 的规则 34 调用规则 34”。

我知道[Internet 术语中的第 34 条规则，](http://www.urbandictionary.com/define.php?term=Rule%2034)并且我已经搜索了[Wolfram 是谁，](http://en.wikipedia.org/wiki/Stephen_Wolfram)但我很难弄清楚 Wolfram 的第 34 条规则是什么。

那么这个“第 34 条”究竟是什么？

这是漫画：http: [//xkcd.com/505/](http://xkcd.com/505/)。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2008-11-19T16:08:18.947

Wolfram 以这种方式根据最近邻组织了 256 个可能的一维元胞自动机：

```
RULES:
0:        0        0        0
1:        0        0        1
2:        0        1        0
3:        0        1        1
4:        1        0        0
5:        1        0        1
6:        1        1        0
7:        1        1        1 
```

如果您正在评估遵循规则 2 的元胞自动机 (CA) 中的阶段，那么只要三位字符串与规则 2 的配置匹配，中心位就会在下一次迭代中变为（或在这种情况下保持）真。

CA 的规则被描述为一个位串。说这是规则 110（我最喜欢的）。在二进制中，110 是 01101110。最不重要的数字是零。这意味着如果单元格及其邻居匹配上面的规则 0，它将变为白色/否定/0/false/whatever。第二个最低有效数字是 1，因此如果单元格及其邻居与上面的规则 1 匹配，它将变为黑色/正/1/true/whatever`，等等，直到您看到，对于规则 110，如果一个单元格和它的邻居匹配规则 1,2,3,5,6，然后单元格变为黑色。否则，它会变成白色。不久前，我写了一些 JS 代码来让我玩弄这些独特的 CA：

[http://lucasoman.com/files/projects/caeditor/caed.php](http://lucasoman.com/files/projects/caeditor/caed.php)

正如您在玩它时看到的那样，您可以随机切换任何块，这会根据规则改变它下面的每个块。这是一种查看由过程中的异常引起的连锁反应的巧妙方法。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-12T22:16:55.287

多么完美的自我实现模因。XKCD 非常流行，人们会搜索一些被引用的晦涩难懂的东西。上面发布了一条说明，垃圾邮件发送者在标头中使用 W's-34 来重定向搜索。由于垃圾邮件发送者有时会为色情网站工作，因此作者只需在其上调用 34 即可创建与 w-34 相关的色情内容。神圣递归蝙蝠侠。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-12-09T15:34:03.407

“我将规则 34 称为 Wolfram 规则 34”

第一个“规则 34”是指在[http://xkcd.com/305/](http://xkcd.com/305/)中提到的互联网规则 34，第二个“规则 34”是 Wolfram 的元[胞自动机](http://en.wikipedia.org/wiki/Cellular_automaton)理论。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-22T06:53:16.553

在[xkcd](http://en.wikipedia.org/wiki/Xkcd)漫画的第 9-13 帧和第 19-20 帧中，您可以看到规则生成的一些模式。我们想知道的是“我在 Wolfram 的 34 条规则上调用了 34 条规则”有什么好笑的？

我不完全确定第 34 条规则的意义是什么（除了 xkcd 305 上的网络色情笑话 [归功于 Jason Slocomb 的评论]），但漫画的重点是某个可怜的家伙正在使用[图灵模拟我们的整个宇宙机](http://en.wikipedia.org/wiki/Turing_machine)。图灵机的思想本质上是一个数据表可用于对其他数据运行计算（即程序是第一个表，输入和输出是另一个表）。

第一个表（程序）给出了告诉机器如何处理数据的规则。Wolfram 声称已将所有内容归结为尽可能少的规则，以便能够执行所有可能的计算（通用计算机）。

他说它需要 2 种状态和 3 种颜色或其他东西（我可能会将顺序倒过来）。我认为状态是指（ 0 / 1 ），颜色是指您执行的操作类型。如果您研究了一些组装，这将更有意义。

最基本的计算是当比较 2 位数据以产生三分之一时。这些称为布尔运算。有 8 种可能：

```
0;0 -> 0
0;0 -> 1
0;1 -> 0
0;1 -> 1
1;0 -> 0
1;0 -> 1
1;1 -> 0
1;1 -> 1 
```

您可以使用单一的比较“颜色”（例如 XOR 电路）来完成所有这些操作，甚至可以将此操作与写入操作合并。然后通过在某处保留 2 个控制位（在内存开头的 o 和 1），您可以通过将这些位与它们自身或彼此进行比较来完成写入普通的 0 或 1。如果您将一堆 XOR 电路以不同的模式连接在一起，您可以实现所有 8 个结果。Wiki XOR 了解更多信息。

但大多数程序都需要另一个非常重要的特性：你必须跳转到程序的不同部分，然后再跳回去。所以跳跃是完全不同的颜色。

当然，您必须从内存中读取位。

所以总而言之，Wolfram 说他可以只用 3 种“颜色”制作任何程序（这意味着所有可以想象的程序）。

Stephen Wolfram 对这些图灵模式进行了广泛的经验研究。盯着它们，沉思它们，对它们进行分类，并通过研究数百张图片和图表来比较它们，等等。

所以这个笑话的妙语，我想，要么就是当那个移动岩石的可怜人进入他的宇宙模拟部分，处理 Wolfram 的研究工作，以及所有涉及的大脑活动等时，岩石模式变得真正递归，或者它与涉及 Wolfram 的元胞自动机规则的互联网色情摇滚模拟有关？？！！？

递归模式的摇滚互联网色情模拟？带有摇滚模拟的网络色情？

我想是这样的。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-11-26T00:47:27.133

我花了一点时间才明白这一点，但这个笑话是对两个不同的第 34 条规则的双关语。第一个是在[这部漫画](http://xkcd.com/305/)中创造的 xkcd 的第 34 条规则（“如果你能想象到，那就是色情”） 。第二个是上面专业解释的 Wolfram 规则 34。所以漫画家是说，在某个地方，一定有以元胞自动机为主题的色情片。除了叙述者使用元胞自动机之外，它与这部特定的漫画没有太大关系。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-11-19T17:04:34.200

如果你想看源码：

*   规则34的详细属性：http: [//atlas.wolfram.com/01/01/34/01_01_1_34.html](http://atlas.wolfram.com/01/01/34/01_01_1_34.html)
*   规则 34 的行为：http: [//atlas.wolfram.com/01/01/34/](http://atlas.wolfram.com/01/01/34/)
*   高亮规则（Wolfram 选择）：[http ://atlas.wolfram.com/01/01/](http://atlas.wolfram.com/01/01/)
*   所有 256 条规则的索引：http: [//atlas.wolfram.com/01/01/rulelist.html](http://atlas.wolfram.com/01/01/rulelist.html)

这[本书](https://rads.stackoverflow.com/amzn/click/com/1579550088)包含数千个漂亮的小图表。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-19T16:08:42.657

规则 34 指的是斯蒂芬沃尔夫勒姆为元胞自动机开发的一组规则。您可能熟悉[康威的生命游戏](http://en.wikipedia.org/wiki/Conway%27s_Game_of_Life)，它可用于对计算进行建模。Wolfram 有类似的使用元胞自动机的计算方法，由许多规则定义；规则 34 只是定义如何进行计算的规则之一。“游戏”本身在 Wolfram 的[简单程序图集中定义。](http://atlas.wolfram.com/)

如果您想了解更多信息，包括一些有用的链接，您应该查看[这篇博文](http://fakerake.com/2008/282/wolframs-rule-34-for-xkcd-readers/)以及[这篇](http://www.ts-si.org/off-tangent-comix/3600-rule-34-in-the-lecture-hall.html)博文。可悲的是，自从 XKCD 动画片问世以来，很多人在 Google 上搜索了这条规则，导致很多垃圾邮件发送者试图利用搜索词，因此很难找到有关 Wolfram 规则 34 的直接信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-19T16:03:37.130

规则 34 是 256 个基本元胞自动机之一（一维）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-19T16:11:14.103

[http://atlas.wolfram.com/01/01/34/01_01_1_34.html](http://atlas.wolfram.com/01/01/34/01_01_1_34.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-16T23:39:43.620

[Wolfram Alpha](http://www.wolframalpha.com/)[在这里](http://www.wolframalpha.com/input/?i=rule+34)有一个很好的描述。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-19T16:01:36.947

规则 34

[http://xkcd.com/305/](http://xkcd.com/305/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-21T13:22:20.130

然而，漫画中岩石图案所表明的规则是规则 126。

# java - 您将使用哪种数据结构：TreeMap 或 HashMap？（爪哇）

> ID：302371
> 
> 赞同：54
> 
> 时间：2008-11-19T15:55:12.763
> 
> 标签：java, data-structures, map, hashmap, treemap

**说明 |** 一个 Java 程序，用于读取文本文件并按字母顺序打印每个唯一单词以及该单词在文本中出现的次数。

程序应该声明一个类型的变量`Map<String, Integer>`来存储单词和相应的出现频率。但是，哪种具体类型？`TreeMap<String, Number>`还是`HashMap<String, Number>`？

输入应转换为小写。

单词不包含以下任何字符：`\t\t\n]f.,!?:;\"()'`

**示例输出 |**

```
 Word            Frequency
  a                 1
  and               5
  appearances       1
  as                1
         .
         .
         . 
```

**备注 |** 我知道，我已经在 Perl 中看到了用大约两行代码来解决这个问题的优雅解决方案。但是，我想在 Java 中看到它。

编辑：哦，是的，使用其中一种结构（在 Java 中）显示实现会很有帮助。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-11-19T15:56:52.010

[`TreeMap`](http://java.sun.com/javase/6/docs/api/java/util/TreeMap.html)对我来说似乎很容易 - 仅仅是因为“按字母顺序”的要求。`HashMap`迭代时没有排序；`TreeMap`以自然键顺序迭代。

编辑：我认为康拉德的评论可能暗示“使用`HashMap`，然后排序”。这很好，因为虽然我们最初会有 N 次迭代，但由于重复，我们最终会有 K <= N 个键。我们还不如将昂贵的位（排序）保存到最后，因为我们得到的键更少，而不是在进行时保持排序的小但非恒定的打击。

话虽如此，我暂时坚持我的答案：因为这是实现目标的*最简单*方法。我们真的不知道 OP 特别担心性能，但这个问题暗示他关心优雅和简洁。使用 a`TreeMap`使这变得非常简短，这对我很有吸引力。我怀疑如果性能确实是一个问题，那么可能有比任何一个更好的攻击方法`TreeMap`或`HashMap`:)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-19T16:06:11.290

TreeMap 优于 HashMap，因为 TreeMap 已经为您排序。

但是，您可能需要考虑使用更合适的数据结构，即包。请参阅 [Commons Collections](http://commons.apache.org/collections) - 和[TreeBag](http://commons.apache.org/collections/api-3.2/org/apache/commons/collections/bag/TreeBag.html)类：

这有一个很好的优化内部结构和 API：

```
bag.add("big")
bag.add("small")
bag.add("big")
int count = bag.getCount("big") 
```

编辑：乔恩回答了 HashMap 与 TreeMap 性能的问题 - HashMap 和排序可能更快（试试吧！），但 TreeBag 更容易。袋子也是如此。有一个 HashBag 和一个 TreeBag。根据实现（使用可变整数），bag 应该优于 Integer 的等效普通映射。唯一确定的方法是测试，就像任何性能问题一样。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-04-14T14:21:51.800

我看到不少人说“TreeMap 查找需要`O(n log n)`”！！怎么会？

我不知道它是如何实现的，但在我的脑海中它需要`O(log n)`.

这是因为在树中查找可以在`O(log n)`. 每次在其中插入项目时，您不会对整个树进行排序。这就是使用树的全部想法！

因此，回到最初的问题，用于比较的数字是：

**HashMap 方法：** `O(n + k log k)`平均情况，最坏情况可能要大得多

**TreeMap 方法：** `O(k + n log k)`最坏情况

其中 n = 文本中的单词数，k = 文本中不同单词的数量。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-19T17:35:40.330

哈希映射应该快得多。您不应该根据您希望项目最终如何排列来选择容器；只需在最后对（单词，频率）对列表进行排序。通常要排序的此类对比文件中的单词少，因此使用哈希映射的渐近（和真实）性能会更好。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-03T13:02:31.723

```
import java.io.BufferedReader;
import java.io.DataInputStream;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.ObjectInputStream.GetField;
import java.util.Iterator;
import java.util.Map;
import java.util.StringTokenizer;
import java.util.TreeMap;

public class TreeMapExample {

    public static void main (String args[]){
        Map<String,Integer> tm = new TreeMap<String,Integer>();
        try {

            FileInputStream fis = new FileInputStream("Test.txt");
            DataInputStream in = new DataInputStream(fis);
            BufferedReader br = new BufferedReader(new InputStreamReader(in));
            String line;
            int countValue = 1;
            while((line = br.readLine())!= null ){
                line = line.replaceAll("[-+.^:;,()\"\\[\\]]","");
                StringTokenizer st = new StringTokenizer(line, " ");    
                while(st.hasMoreTokens()){
                    String nextElement = (String) st.nextElement();

                    if(tm.size()>0 && tm.containsKey(nextElement)){
                        int val = 0;
                        if(tm.get(nextElement)!= null){
                        val = (Integer) tm.get(nextElement);
                        val = val+1;
                        }
                        tm.put(nextElement, val);
                    }else{
                    tm.put(nextElement, 1);
                    }

                }
            }
            for(Map.Entry<String,Integer> entry : tm.entrySet()) {
            System.out.println(entry.getKey() + " : " + entry.getValue());
            }

        } catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-19T16:17:34.667

您不能将 a 分配给`TreeMap<String,Number>`类型为 的变量`Map<String,Integer>`。`Double`,`Long`等可以“放入”到`TreeMap<String,Number>`. 当我从 a 中“获取”一个值时`Map<String,Integer>`，它必须是一个`Integer`.

完全忽略任何 i18n 问题、内存限制和错误处理，这里是：

```
class Counter {

  public static void main(String... argv)
    throws Exception
  {
    FileChannel fc = new FileInputStream(argv[0]).getChannel();
    ByteBuffer bb = fc.map(FileChannel.MapMode.READ_ONLY, 0, fc.size());
    CharBuffer cb = Charset.defaultCharset().decode(bb);
    Pattern p = Pattern.compile("[^ \t\r\n\f.,!?:;\"()']+");
    Map<String, Integer> counts = new TreeMap<String, Integer>();
    Matcher m = p.matcher(cb);
    while (m.find()) {
      String word = m.group();
      Integer count = counts.get(word);
      count = (count == null) ? 1 : count + 1;
      counts.put(word, count);
    }
    fc.close();
    for (Map.Entry<String, Integer> e : counts.entrySet()) {
      System.out.printf("%s: %d%n", e.getKey(), e.getValue());
    }
  }

} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-08-14T03:46:49.463

“当一个键已经存在时，它具有与 HashMap 相同的性能。” - 这是完全错误的。HashMap 有 O(1) 插入和 TreeMap O(n log n)。至少需要 n log n 检查才能确定它是否在表中！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-03-04T17:39:50.460

对于这种方式，在我看来，最好使用Apache [Commons Collections](https://commons.apache.org/proper/commons-collections/)的[HashBag](http://commons.apache.org/proper/commons-collections/javadocs/api-3.2.1/org/apache/commons/collections/bag/HashBag.html)或[Guava](https://github.com/google/guava)的[HashMultiset](http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/HashMultiset.html)或[Eclipse Collections的](https://projects.eclipse.org/proposals/eclipse-collections)[HashBag](http://www.goldmansachs.com/gs-collections/javadoc/6.1.0/com/gs/collections/impl/bag/mutable/HashBag.html)（以前称为[GS Collections](https://github.com/goldmansachs/gs-collections)）或任何以下类：

```
 Order    |  Guava           |   Apache  | Eclipse(GS) | JDK analog
─────────────┼──────────────────┼───────────┼─────────────┼─────────────
Not define   | HashMultiset     |   HashBag | HashBag     | HashMap<String, Integer>
─────────────┼──────────────────┼───────────┼─────────────┼─────────────
Sorted       | TreeMultiset     |   TreeBag | TreeBag     | TreeMap<String, Integer>
─────────────┼──────────────────┼───────────┼─────────────┼─────────────
Linked       |LinkedHashMultiset|     -     |     -       | LinkedHashMap<String, Integere>
─────────────┼──────────────────┼───────────┼─────────────┼─────────────
Concurrent & | ConcurrentHash-  |Synchroniz-|Synchroniz-  | Collections.synchronizedMap(
not define   | Multiset         |   edBag   | edBag       |       HashMap<String, Integer>)
─────────────┼──────────────────┼───────────┼─────────────┼─────────────
Concurrent   |         -        |Synchroniz-|Synchroniz-  | Collections.synchronizedSorted-
and sorted   |                  |edSortedBag| edSortedBag |       Map(TreeMap<>))
─────────────┼──────────────────┼───────────┼─────────────┼─────────────
Immutable and| ImmutableMultiset|Unmodifiab-|Unmodifiab-  | Collections.unmodifiableMap(
not define   |                  |   leBag   | leBag       | HashMap<String, Integer>)
─────────────┼──────────────────┼───────────┼─────────────┼─────────────
Immutable and| ImmutableSorted- |Unmodifiab-|Unmodifiab-  | Collections.unmodifiableSorted-
sorted       | Multiset         |leSortedBag| leSortedBag | Map(TreeMap<String, Integer>))
──────────────────────────────────────────────────────────────────────── 
```

例子：

### 1.[使用 Apache 的 SynchronizedSortedBag](http://www.goldmansachs.com/gs-collections/javadoc/6.1.0/com/gs/collections/impl/bag/sorted/mutable/SynchronizedSortedBag.html)：

```
 // Parse text to separate words
    String INPUT_TEXT = "Hello World! Hello All! Hi World!";
    // Create Multiset
    Bag bag = SynchronizedSortedBag.synchronizedBag(new TreeBag(Arrays.asList(INPUT_TEXT.split(" "))));

    // Print count words
    System.out.println(bag); // print [1:All!,2:Hello,1:Hi,2:World!]- in natural (alphabet) order
    // Print all unique words
    System.out.println(bag.uniqueSet());    // print [All!, Hello, Hi, World!]- in natural (alphabet) order

    // Print count occurrences of words
    System.out.println("Hello = " + bag.getCount("Hello"));    // print 2
    System.out.println("World = " + bag.getCount("World!"));    // print 2
    System.out.println("All = " + bag.getCount("All!"));    // print 1
    System.out.println("Hi = " + bag.getCount("Hi"));    // print 1
    System.out.println("Empty = " + bag.getCount("Empty"));    // print 0

    // Print count all words
    System.out.println(bag.size());    //print 6

    // Print count unique words
    System.out.println(bag.uniqueSet().size());    //print 4 
```

### [2\. 使用 Eclipse(GC) 中的 TreeBag](http://www.goldmansachs.com/gs-collections/javadoc/6.1.0/com/gs/collections/impl/bag/sorted/mutable/TreeBag.html)：

```
 // Parse text to separate words
    String INPUT_TEXT = "Hello World! Hello All! Hi World!";
    // Create Multiset
    MutableSortedBag<String> bag =  TreeBag.newBag(Arrays.asList(INPUT_TEXT.split(" ")));

    // Print count words
    System.out.println(bag); // print [All!, Hello, Hello, Hi, World!, World!]- in natural order
    // Print all unique words
    System.out.println(bag.toSortedSet());    // print [All!, Hello, Hi, World!]- in natural order

    // Print count occurrences of words
    System.out.println("Hello = " + bag.occurrencesOf("Hello"));    // print 2
    System.out.println("World = " + bag.occurrencesOf("World!"));    // print 2
    System.out.println("All = " + bag.occurrencesOf("All!"));    // print 1
    System.out.println("Hi = " + bag.occurrencesOf("Hi"));    // print 1
    System.out.println("Empty = " + bag.occurrencesOf("Empty"));    // print 0

    // Print count all words
    System.out.println(bag.size());    //print 6

    // Print count unique words
    System.out.println(bag.toSet().size());    //print 4 
```

### 3.[使用来自 Guava 的 LinkedHashMultiset](http://www.goldmansachs.com/gs-collections/javadoc/6.1.0/com/gs/collections/impl/bag/sorted/mutable/SynchronizedSortedBag.html)：

```
 // Parse text to separate words
    String INPUT_TEXT = "Hello World! Hello All! Hi World!";
    // Create Multiset
    Multiset<String> multiset = LinkedHashMultiset.create(Arrays.asList(INPUT_TEXT.split(" ")));

    // Print count words
    System.out.println(multiset); // print [Hello x 2, World! x 2, All!, Hi]- in predictable iteration order
    // Print all unique words
    System.out.println(multiset.elementSet());    // print [Hello, World!, All!, Hi] - in predictable iteration order

    // Print count occurrences of words
    System.out.println("Hello = " + multiset.count("Hello"));    // print 2
    System.out.println("World = " + multiset.count("World!"));    // print 2
    System.out.println("All = " + multiset.count("All!"));    // print 1
    System.out.println("Hi = " + multiset.count("Hi"));    // print 1
    System.out.println("Empty = " + multiset.count("Empty"));    // print 0

    // Print count all words
    System.out.println(multiset.size());    //print 6

    // Print count unique words
    System.out.println(multiset.elementSet().size());    //print 4 
```

## [您可以在我的 github 项目中找到更多示例](https://github.com/Vedenin/java_in_examples/tree/master/collections/src/com/github/vedenin/eng/collections/multiset)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-19T18:44:41.407

我肯定会选择 TreeMap：

*   TreeMap 在插入时自动对新键进行排序，之后不需要排序。
*   当键已经存在时，它具有与 HashMap 相同的性能。

TreeSet 在内部使用 TreeMap，所以为什么不直接使用 TreeMap。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-19T16:06:20.667

根据速度要求，您还可以使用[Trie](http://en.wikipedia.org/wiki/Trie)。但是，如果 TreeMap 足够快，那么实现其中之一是没有意义的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-08-19T11:40:32.227

考虑添加或删除数据结构的频率。如果 TreeMap 很高，它就不是理想的了。除了搜索现有条目 nLn 之外，它还经常进行重新平衡。

另一方面，哈希结构在内存上有点华丽（过度分配）。如果您可以咬紧牙关，那么请在需要时使用哈希结构并进行排序。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-06-28T12:54:10.993

这是读取文本文件的java示例，根据键排序，然后根据值排序；取决于文件中单词的出现次数。

```
public class SortFileWords {

    public static void main(String[] args) {
        HashMap<String, Integer> map = new HashMap<String, Integer>();
        ValueCompare vc = new ValueCompare(map);
        TreeMap<String, Integer> sorted_map = new TreeMap<String, Integer>(map);
        List<String> list = new ArrayList<>();
        Scanner sc;
        try {
            sc = new Scanner(new File("c:\\ReadMe1.txt"));
            while (sc.hasNext()) {
                list.add(sc.next());
            }
            sc.close();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }

        for (String s : list) {
            if (map.containsKey(s)) {
                map.put(s, map.get(s) + 1);
            } else
                map.put(s, 1);
        }

        System.out.println("Unsorted map: " + map);
        sorted_map.putAll(map);
        System.out.println("Sorted map on keys: " + sorted_map);

        TreeMap<String, Integer> sorted_value_map = new TreeMap<>(vc);
        sorted_value_map.putAll(map);
        System.out.println("Sorted map on values: " + sorted_value_map);
    }
}

class ValueCompare implements Comparator<String> {

    Map<String, Integer> map;

    public ValueCompare(Map<String, Integer> map) {
        this.map = map;
    }

    @Override
    public int compare(String s1, String s2) {
        if (map.get(s1) >= map.get(s2))
            return -1;
        else
            return 1;
    }
} 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2008-11-19T16:14:11.337

为什么不使用[TreeSet](http://java.sun.com/j2se/1.4.2/docs/api/java/util/TreeSet.html)？

与 TreeMap 相同的排序概念，除了它是一个 Set - 根据定义，它是“不包含重复元素的集合”。

从您的问题描述中，听起来好像您需要一个 Set，我看不出您将哪些键和值映射在一起。

> 此类实现由 TreeMap 实例支持的 Set 接口。此类保证已排序的集合将按元素升序排序，根据元素的自然顺序（请参阅 Comparable）或在集合创建时提供的比较器排序，具体取决于使用的构造函数。

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2011-04-05T13:02:27.210

基本上这取决于需求。有时哈希图很好，有时树图很好。但是哈希映射最好只使用它们是对开销进行排序的一些约束。

# python - 计算两个D30复投的准确结果

> ID：302379
> 
> 赞同：3
> 
> 时间：2008-11-19T15:57:35.003
> 
> 标签：python, math, statistics, puzzle

好吧，这困扰了我好几年，现在。如果你在学校学过统计学和高等数学，*现在*就转身离开。太晚了。

好的。深吸一口气。这是规则。拿*两个*30 面骰子（是的，[它们确实存在](http://paizo.com/store/byCompany/k/koplow/dice/d30)）并同时掷骰子。

*   将两个数字相加
*   如果两个骰子都显示 <= 5 或 >= 26，再次掷骰子*并将结果添加*到您所拥有的
*   如果一个是 <= 5 而另一个 >= 26，则再次抛出并从你拥有的结果中*减去结果*
*   重复直到 > 5 和 < 26！

如果您编写一些代码（见下文），将这些骰子掷几百万次，然后计算您收到每个数字的频率作为最终结果，您会得到一条在 1 的左侧非常平坦的曲线，在 1 和 1 之间大约 45° 60和60以上持平。滚动30.5或更好的机会大于50％，滚动优于18的机会是80％，滚动优于0的机会是97％。

现在的问题是：是否可以编写一个程序来*计算**精确*值 f(x)，即滚动某个值的概率？

背景：对于我们的角色扮演游戏“星辰丛林”，我们寻找一种方法来控制随机事件。上面的规则保证了你尝试的东西会得到更稳定的结果:)

对于周围的极客，Python 中的代码：

```
import random
import sys

def OW60 ():
    """Do an open throw with a "60" sided dice"""
    val = 0
    sign = 1

    while 1:
        r1 = random.randint (1, 30)
        r2 = random.randint (1, 30)

        #print r1,r2
        val = val + sign * (r1 + r2)
        islow = 0
        ishigh = 0
        if r1 <= 5:
            islow += 1
        elif r1 >= 26:
            ishigh += 1
        if r2 <= 5:
            islow += 1
        elif r2 >= 26:
            ishigh += 1

        if islow == 2 or ishigh == 2:
            sign = 1
        elif islow == 1 and ishigh == 1:
            sign = -1
        else:
            break

        #print sign

    #print val
    return val

result = [0] * 2000
N = 100000
for i in range(N):
    r = OW60()
    x = r+1000
    if x < 0:
        print "Too low:",r
    if i % 1000 == 0:
        sys.stderr.write('%d\n' % i)
    result[x] += 1

i = 0
while result[i] == 0:
    i += 1

j = len(result) - 1
while result[j] == 0:
    j -= 1

pSum = 0
# Lower Probability: The probability to throw this or less
# Higher Probability: The probability to throw this or higher
print "Result;Absolut Count;Probability;Lower Probability;Rel. Lower Probability;Higher Probability;Rel. Higher Probability;"
while i <= j:
    pSum += result[i]
    print '%d;%d;%.10f;%d;%.10f;%d;%.10f' % (i-1000, result[i], (float(result[i])/N), pSum, (float(pSum)/N), N-pSum, (float(N-pSum)/N))
    i += 1 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-20T15:29:30.303

我必须先重写你的代码才能理解它：

```
def OW60(sign=1):
    r1 = random.randint (1, 30)
    r2 = random.randint (1, 30)
    val = sign * (r1 + r2)

    islow  = (r1<=5)  + (r2<=5)
    ishigh = (r1>=26) + (r2>=26)

    if islow == 2 or ishigh == 2:
        return val + OW60(1)
    elif islow == 1 and ishigh == 1:
        return val + OW60(-1)
    else:
        return val 
```

也许你会发现这不太可读；我不知道。（请检查它是否与您的想法相同。）另外，关于您在代码中使用“结果”的方式——您知道 Python 的[dict](http://www.diveintopython.org/getting_to_know_python/dictionaries.html)吗？

无论如何，抛开编程风格的问题：假设 F(x) 是 OW60(1) 的[CDF](http://en.wikipedia.org/wiki/Cumulative_distribution_function)，即

```
F(x) = the probability that OW60(1) returns a value ≤ x. 
```

同样让

```
G(x) = the probability that OW60(-1) returns a value ≤ x. 
```

然后，您可以通过对第一次投掷结果的所有 (30×30) 可能值求和，根据定义计算 F(x)。例如，如果第一次投掷是 (2,3)，那么您将再次投掷，因此该项对 F( X）。所以你会得到一些很长的表情，比如

```
F(x) = (1/900)(2+F(x-2) + 3+F(x-3) + ... + 59+F(x-59) + 60+F(x-60)) 
```

这是超过 900 个术语的总和，[30]×[30] 中的每一对 (a,b) 一个。两者均≤5或均≥26的对(a,b)具有项a+b+F(xab)，具有1个≤5且1个≥26的对具有项a+b+G(xab)，并且其余的有一个像 (a+b) 这样的术语，因为你不会再扔了。

同样你有

```
G(x) = (1/900)(-2+F(x-2) + (-3)+F(x-3) + ... + (-59)+F(x-59) + (-60)+F(x-60)) 
```

当然，你可以收集系数；唯一出现的 F 项是从 F(x-60) 到 F(x-52) 和从 F(x-10) 到 F(x-2)（对于 a,b≥26 或两者≤5），并且唯一出现的 G 项是从 G(x-35) 到 G(x-27)（对于 a,b≥26 和另一个≤5），因此项少于 30 个。在任何情况下，将向量 V(x) 定义为

```
V(x) = [F(x-60) G(x-60) ... F(x-2) G(x-2) F(x-1) G(x-1) F(x) G(x)] 
```

（比如说），你（从 F 和 G 的那些表达式中）有一个形式的关系

```
V(x) = A*V(x-1) + B 
```

对于适当的矩阵 A 和适当的向量 B（您可以计算），因此从形式 V(x) = [0 0] 的初始值开始，对于 x 足够小，您可以找到 F(x) 和 G(x ) 对于 x 在您想要任意接近精度的范围内。（而你的 f(x)，即抛出 x 的概率，只是 F(x)-F(x-1)，所以也可以得出。）

可能有更好的方法。然而，一切都说了又做了，你为什么要这样做？无论您想要哪种分布，都有很好且简单的概率分布，具有适当的参数，具有良好的属性（例如小方差、单边误差等）。没有理由编写自己的临时程序来生成随机数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-08T17:12:44.213

我已经对 2000 万次投掷样本进行了一些基本统计。结果如下：

```
Median: 17 (+18, -?) # This result is meaningless
Arithmetic Mean: 31.0 (±0.1)
Standard Deviation: 21 (+1, -2)
Root Mean Square: 35.4 (±0.7)
Mode: 36 (seemingly accurate) 
```

误差是通过实验确定的。算术平均值和众数非常准确，即使非常激进地更改参数似乎也不会对其产生太大影响。我想已经解释了中位数的行为。

注意：不要将这些数字作为函数的正确数学描述。使用它们可以快速了解分布的样子。对于其他任何事情，它们都不够准确（即使它们可能很精确。

也许这对某人有帮助。

编辑2：

![图形](https://chart.apis.google.com/chart?cht=lc&chs=400x200&chd=e:UshVbmkydgXwlLifjQljW.cvgkackylLRPd5ZriGhVbmgkdgfCi3eRfCgk4VSyYhhufbbmYhcvhVg9ZrljkZa0ZrljhVY6gMfzkZkyXYacfClLfbackBifd5kZi3fCiGcvgMi3acnel8g9gMmtZrdgbmbNd5l8fCcvbNkBmUdIbNgMZrb-kymUbmdIhuxDiGbNeRYJwqgkjobmeqiGaDY6cvpxjobNlLhVgMonkZcXg92aVFl8iGljeRjoljhVdIiGn2bNfzd5-1kZhVWOhVnenFgMbmaceRfzgMifeqbNfbfCjon2dIjo2yi3gMdIjQZSjQa0y9hukBi3jog9ZrfbeRmUkycvgMdIZrnFbNjQhVjo04bmbNZracYhfbi3aceqhuYhZSlLcXd5n21pljkBa0kZmtifaceqifUUiG6oeRgMkycXeqQ3fCmtaDlLjogMgMjQkygkkyfbcveqiGZSkZeRfbbNaceReRd5l8gkpYfCiGlLkyfzgMfCmUififdgifb-mUac2ymtifd5kBfzjQnFcvfbfCYhjQac2yacifeqjocvb-bmjQifdghVd5g9ifkZeqd5hVdgjQnFn2fCZScXcXifd5-dhVnFbmbNacgMgk8KbmmUWncvlLd5bNcXRojonF.mkZbNmUdgfCnFkBljoPhVjQoPdId5fzifachufCgkhVpAcXgkmUd5nFiGdgi3gMV2kyl8n2jofCfzoPdIeqPVa0kZhVoncvhVaDlLbmXwaDiGYhkyZrVFljSZhuaDi3acnecvb-gknFbmjQeRkBonjQeqfbb-mUjob-jQdgmtzueqmUifoPFwcX2aeRjoiGfCXYa0b-iGpAaDiGNCoPi3kZl8ZrQ3jQiGW.ZrbmY6dIiGeRjQkyY6bmfzoPpxgMd5l8fzhufzlLg9lLa0i3YhkBiGXweqjQcXjogMa0WOg9oPl8eRhujQfbZSjocvifhVRPmtd5hVgMn2jQhuifd5gkYJnen2kZcXY6fCdgcvmtjobNfChufCnekZdIgkg9ackydggMeq7AYhiGfbjoeqeRachuT7cvVFbmeqeRkyUshusEd5joiGRPgMlLeqdgfChujoifg9g9YJiGdgkBmtdIhuYhO8RoiffzfCiGfbjQi3Yhkylja0gMjobmfCdIdghVljdIjQwqhVoPl8jQljg9kZdIdgfCd5yMnFeRZraDYhgkmtWOjQn2l8fznecva0mthuAAkyg9ZrZSYJonkyNafCeqfCx0fzkymtkycXgkl8b-jQcXhVW.eRdgkZcvfbnegkjoeqkZiGkykBhVfbkBcXfCSymUg9neeRnehVeqd5g9hukBififn2kZl8n2d5l8huYhfzifd5bNXYW.oni3b-jQifacn2eqjQifmUdIfCNalLeqvhkZpAjQkBXweRi3T7kBZr5GifjoneYJifWnackZbmeqeqiGaDeRyli30fbmeqcvn2ifackyfCifkya0kBfCeqcXY6oPhujogMiGlLg9YhneYhg9iGiGiGgkgkoPjQn2eqlLa0VdoPbNXYfChufCjobNeRhui3g9a0gkbmifSAifaceqhueRifZSb-mUmtfCZrb-lLYJbmjQfCdgjooncXhufC-1fbb-eRdgfbdgoPdgeRdIl8lLgMdgfbljkyljbmlLhuifeRfzg904L4fzfzgMbNkyYJZrcvkygMiGeRkBn2hVd5cXd5gMfbZrbNfzn2eRgMlLZrlLn2g9ljg9hVifnFd5nFonhunecXdgneSARPifl8iGfbYhkZkBfzneacnFyMYhjoa0fCjoaDgkd5iGkBeqmtnehub-eRnekZ2BaDkBlLd5eRgMkBljcvZrlj1Qy9ZSkZhubmhuifd5bNkykBcvpAa0onifnFdgfCjonFifbNMpjoaDhVkZfbQGmUfzjobmljfzeqgMiGmtjofCi3joRoeqdIpAb-a0d5dgi3cXfzeRljb-cXjofbmUmt&chxt=y,x&chxr=0,-54,112|1,0,991)

仅基于 991 个值。我本可以在其中塞入更多值，但它们会扭曲结果。这个样本恰好是相当典型的。

编辑1：

以下是仅一个 60 面骰子的上述值，用于比较：

```
Median: 30.5
Arithmetic Mean: 30.5
Standard Deviation: 7.68114574787
Root Mean Square: 35.0737318611 
```

请注意，这些值是计算得出的，而不是实验值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T21:35:51.500

复合无界概率是......非平凡的。我打算像 James Curran 一样解决这个问题，但后来我从你的源代码中看到可能有第三组卷，第四组，依此类推。这个问题是可以解决的，但远远超出了大多数滚模模拟器。

是否有任何特殊原因需要从 -Inf 到 +Inf 的随机范围以及 1-60 左右的如此复杂的曲线？为什么2D30的钟形曲线不能接受？如果你解释你的要求，很可能有人可以提供一个更简单、更有界的算法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T16:20:37.423

走着瞧。第二*次*投掷（有时会在第一次投掷中添加或减去）在 31 附近有一个很好的易于预测的钟形曲线。当然，第一次投掷是问题所在。

对于第一卷，我们有 900 种可能的组合。

*   50 种组合导致添加第二卷。
*   25 个组合导致减去第二个掷骰。
*   留下 825 个与第二卷的钟形曲线相匹配的组合。

减法集（预减法）将在 (27..35) 范围内形成钟形曲线。加法集的下半部分将在 (2..10) 范围内形成钟形曲线，而上半部分将在 (52...60) 范围内形成钟形曲线

我的概率有点生疏，所以我无法为您计算出确切的值，但应该清楚的是，这些会导致可预测的值。

# windows - 如何使用参数从命令行启动存储在 UNC 共享中的程序？

> ID：302381
> 
> 赞同：4
> 
> 时间：2008-11-19T15:57:59.670
> 
> 标签：windows, command-line, powershell, shortcuts

我们使用了一个内部程序，它存储在 UNC 共享中，因此更新是透明的。我想为它提供一些命令行参数，如下所示：

```
\\server\share\in_house_thingy.exe myusername mypassword 
```

但我似乎无法让它在 CMD 或 PowerShell 中或通过快捷方式工作。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-20T14:14:00.143

你可以使用：

```
$app = '\\server\share\in_house_thingy.exe'
$arguments = 'myusername mypassword'
$process = [System.Diagnostics.Process]::Start($app, $arguments) 
```

如果您想从该进程获取退出代码或其他信息，$process 对象将为您提供一个实时进程对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-20T18:03:35.593

对于快捷方式，将目标更改为：

```
"\\server\share\in_house_thingy.exe" myusername mypassword 
```

除非你真的想使用 powershell 来完成这项工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T12:57:07.957

在批处理文件中使用`%~dp0`当前（unc）路径，包括尾随`\`

在 powershell 脚本中，将其用于当前（unc）路径，而无需尾随`\`

```
$0 = $myInvocation.MyCommand.Definition
$dp0 = [System.IO.Path]::GetDirectoryName($0) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T15:59:16.390

我刚刚注意到有一个 .CMD 文件将文件从共享复制到临时目录并在本地运行。

如果没有更好的解决方案，如果你们都可以投票给这个答案，那就行了。

# wix - 包括所有依赖项

> ID：302393
> 
> 赞同：20
> 
> 时间：2008-11-19T16:01:55.277
> 
> 标签：wix, windows-installer, wix3, paraffin

我刚开始使用 WiX，因为我需要能够在我们的 CI 服务器上自动构建 MSI。反正有没有自动包含项目的所有依赖项？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-19T16:39:05.437

heat.exe 的“proj”扩展越来越好。 [热量](http://wixtoolset.org/documentation/manual/v3/overview/heat.html)还没有完全准备好以自动化方式用于生产。这是一种将初始结构组合在一起的非常合理的方法，但在重复运行时并不能完全正确地完成（例如，Component/@Guids 还不稳定，但......）。

当上述问题在 heat.exe 中解决后，将其合并到您的构建过程中肯定会省去人们上面提到的所有麻烦。在核心工具集中修复了最严重的错误之后，我们的清单上会做得更好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-29T17:37:57.653

我也刚开始使用 WIX，我做了一个快速而肮脏的技巧来自动添加引用。这个想法是扫描您要打包的项目的输出文件夹中的所有.dll。

在 WIX 项目的预构建中，添加

```
call "$(ProjectDir)GenerateDependency.bat" "$(SolutionDir)" "$(ProjectDir)Dependencies.wxs" 
```

在您的 WIX 项目中添加 GenerateDependency.bat 文件，其中包含

```
@echo off
set SOLUTIONDIR=%1
set OUTPUTFILE=%2
echo Starting Dependency check...
echo ^<?xml version="1.0" encoding="UTF-8"?^> > %OUTPUTFILE%
echo ^<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"^> >> %OUTPUTFILE%
echo   ^<Fragment^> >> %OUTPUTFILE%
echo     ^<ComponentGroup Id="MesDependance" Directory="INSTALLFOLDER"^> >> %OUTPUTFILE%

for %%F in (%SOLUTIONDIR%WixServiceInstallerExample\bin\Debug\*.dll) do (
   echo "-- Adding %%~nxF" 
    echo       ^<Component Id="%%~nF"^> >> %OUTPUTFILE%
    echo                     ^<File  Id="%%~nF" Name="%%~nxF" Source="%%~dpnxF" Vital="yes" KeyPath="yes" DiskId="1"/^> >> %OUTPUTFILE%
    echo       ^</Component^> >> %OUTPUTFILE%
)
echo     ^</ComponentGroup^> >> %OUTPUTFILE%
echo   ^</Fragment^> >> %OUTPUTFILE%
echo ^</Wix^> >> %OUTPUTFILE%
echo Dependency check done. 
```

根据需要修改“WixServiceInstallerExample\bin\Debug”。这个soulhd是你要打包的项目的输出文件夹

注意：请注意，VisualStudio 经常搞乱编码。最好用 Notepad++ 编辑这个文件，并确保它是 ANSI，而不是 UTF8。

这将生成一个 Dependencies.wxs，您可以将其包含在您的项目中。如果您处于源代码控制之下，请将其排除在外。

在实际制作包之前，每次构建都会重新扫描 .dll 并重建 Dependencies.wxs。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T14:40:10.950

看看来自 Wintellect 的[石蜡](http://www.wintellect.com/blogs/jrobbins/wix-a-better-tallow-paraffin-part-3-of-3)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T16:16:04.220

根据我的经验，Wix 仍然是一个非常手动的过程。您必须单独添加每个依赖项 - 我认为您的想法是在构建项目的同时构建 Wix 安装程序，并在代码中添加每个项目时添加它。这样一来，它似乎比不得不回去回顾项目更令人生畏。不过，这肯定是一个很好的增强建议！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T16:18:58.440

我还没有在 WIX 中看到可以做到这一点的东西，您应该知道您的解决方案/项目所需的所有依赖项。阅读这个[博客](http://blogs.dovetailsoftware.com/blogs/kmiller/archive/2007/12/06/creating-windows-installers-using-wix-the-journey-begins.aspx)，里面是一个引用：

> 保持你的源代码和你的依赖关系更紧密（向孙子道歉。）

我发现确保在 MSI 中没有忘记任何内容的最佳方法是在干净安装的虚拟 PC 上测试安装程序。

我见过的最接近你想要的东西是这个人的[博客](http://mostlytech.blogspot.com/2007/02/extend-right-click-menu-in-explorer-in.html)。

目前，我们只能手动完成。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T21:54:56.137

我刚开始使用 WIX，并认为 WixEdit( [http://wixedit.sourceforge.net/](http://wixedit.sourceforge.net/) ) 可以添加多个文件/dll，解决了我对 Wix 轻松获取文件的挫败感。只需保持文件井井有条，然后使用导入文件夹功能。当然，它不支持每个文件一个组件的新 3.0 建议。

热量也很好，每个文件支持一个组件。我的清单上的下一个是获得一些自动化，以便这些文件在 la Visual Studio 中自动更新。

# php - 如何更改 drupal 5 视图模块的 HTML

> ID：302398
> 
> 赞同：1
> 
> 时间：2008-11-19T16:04:40.107
> 
> 标签：php, drupal, drupal-views, drupal-5

我正在使用 Drupal 5，并且有很多我想更改其输出的视图。使用视图向导，我可以为每个实例创建一个不同的模板，但我想对我的所有视图进行相同的更改，并且主题目录中有 30 个文件接缝，就像大量的维护和代码一样。有谁知道是否有一种默认方式可以同时处理所有视图，然后使用我目前拥有的一次性使用？

这是我现在拥有的：

意见列表-首页________文章_______latest.tpl.php

```
<?php 
/**
 * views template to output one 'row' of a view.
 * This code was generated by the views theming wizard
 * Date: November 17, 2008 - 2:07pm
 * View: home_articles_latest
 *
 * Variables available:
 * $view -- the entire view object. Important parts of this object are
 *   home_articles_latest, .
 * $view_type -- The type of the view. Probably 'page' or 'block' but could
 *   also be 'embed' or other string passed in from a custom view creator.
 * $node -- the raw data. This is not a real node object, but will contain
 *   the nid as well as other support fields that might be necessary.
 * $count -- the current row in the view (not TOTAL but for this page) starting
 *   from 0.
 * $stripe -- 'odd' or 'even', alternating. * $title -- Display the title of the node.
 * $title_label -- The assigned label for $title
 * $comment_count -- This will display the comment count.
 * $comment_count_label -- The assigned label for $comment_count
 * $field_abstract_value -- 
 * $field_abstract_value_label -- The assigned label for $field_abstract_value
 *
 * This function goes in your views-list-home_articles_latest.tpl.php file
 */

 //now we add the stylesheet...
 //drupal_add_css(path_to_theme() .'/views-list-home_articles_latest.css');

  ?>
  <?php print $view ?>
<div class="view-label view-field-title">
  <?php print $title_label ?>
</div>
<div class="view-field view-data-title">
  <?php print $title?>
</div>

<?php if ($comment_count != '0' && $view_type == 'block'): ?>
<div class="view-label view-field-comment-count">
  <?php print $comment_count_label ?>
</div>
<div class="view-field view-data-comment-count">
  <?php print $add?><?php print $comment_count?>
</div>
<?php endif; ?>

<?php if ($count == 0): ?>
<div class="view-label view-field-field-abstract-value">
  <?php print $field_abstract_value_label ?>
</div>
<div class="view-field view-data-field-abstract-value">
  <?php print $field_abstract_value?>
</div>
<?php endif; ?> 
```

在模板.php

```
/**
 * views template to output a view.
 * This code was generated by the views theming wizard
 * Date: November 17, 2008 - 2:07pm
 * View: home_articles_latest
 *
 * This function goes in your template.php file
 */
function phptemplate_views_view_list_home_articles_latest($view, $nodes, $type) {
  $fields = _views_get_fields();

  $taken = array();

  // Set up the fields in nicely named chunks.
  foreach ($view->field as $id => $field) {
    $field_name = $field['field'];
    if (isset($taken[$field_name])) {
      $field_name = $field['queryname'];
    }
    $taken[$field_name] = true;
    $field_names[$id] = $field_name;
  }

  // Set up some variables that won't change.
  $base_vars = array(
    'view' => $view,
    'view_type' => $type,
  );

  foreach ($nodes as $i => $node) {
    $vars = $base_vars;
    $vars['node'] = $node;
    $vars['count'] = $i;
    $vars['stripe'] = $i % 2 ? 'even' : 'odd';
    foreach ($view->field as $id => $field) {
      $name = $field_names[$id];
      $vars[$name] = views_theme_field('views_handle_field', $field['queryname'], $fields, $field, $node, $view);
      if (isset($field['label'])) {
        $vars[$name . '_label'] = $field['label'];
      }
    }
    $items[] = _phptemplate_callback('views-list-home_articles_latest', $vars);
  }
  if ($items) {
    return theme('item_list', $items);
  }
} 
```

谢谢，
史蒂夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T02:35:03.843

我*认为*只创建一个名为“views-list.tpl.php”的文件将适用于所有列表样式的视图（除非存在更具体的 .tpl.php 文件）。

否则，可能有一种方法可以使用主题功能获得您想要的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T00:06:52.227

在 Views 5 中，默认情况下模块无法公开 tpl 文件，因此模板名称对您没有任何帮助。关键是要放入你的 template.php 文件中的函数，“phptemplate_views_view_list_home_articles_latest”。这是一个 PHP 函数，它拦截任何名为“home_articles_latest”的列表视图的呈现。如果您希望它拦截所有视图，只需将函数本身的名称更改为：“phptemplate_views_view”

请记住，这会影响一切——使用视图、RSS 提要等构建的侧边栏块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T17:20:52.543

我相信每个模板都必须独立更新，如果您谈论的是视图模板内部发生的事情。我不知道只更新 n 个视图的一小部分的方法。

如果您在每个视图的模板上方都有一个标题，您可以使用 template.php 中的辅助函数或 node.tpl.php 中的条件来做到这一点。但如果它比那更远，我相信你不走运。

# iphone - 声音在 iPhone 模拟器中不起作用？

> ID：302399
> 
> 赞同：50
> 
> 时间：2008-11-19T16:05:11.120
> 
> 标签：iphone, objective-c, cocoa-touch, audio, ios-simulator

不知何故，我的 iPhone 模拟器无法播放声音。首先，我正在使用的应用程序`AudioServicesPlaySystemSound()`停止工作。我花了一段时间调试它，但当我在设备上运行应用程序时，声音仍在 iPhone 上运行。我使用其他 iPhone 应用程序（例如示例 Crash Landing 应用程序）得到了相同的结果。

我在模拟器或 Xcode 首选项中的任何地方都找不到声音设置。我尝试通过“重置内容和设置”菜单项重置模拟器无济于事。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-02-12T23:55:47.000

在您的 Mac 上，转到“系统偏好设置”>“声音”>“声音效果”，然后取消选中并重新选中“播放用户界面声音效果”。

您需要重新激活系统声音，请参阅[本页](http://discussions.apple.com/thread.jspa?messageID=8883401)末尾。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-07-10T11:30:43.853

我在模拟器中没有声音，所以我用移动 safari 测试它并尝试播放 mp3：没有声音！

以上所有提示均无济于事。最终，我将**INPUT**源从虚拟 soundflower 设备更改为 Line-In，模拟器工作了！

因此，即使应用程序没有使用输入，它也不能很好地与 Soundflower 配合使用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-12-08T06:13:01.200

我从 OSX10.5.7 更新到 10.6.2 后看到了这个问题

我进行了以下更改以使模拟器再次唱歌：转到“应用程序/实用程序”并运行“音频 MIDI 设置”，然后将 MIDI 格式从 48000 更改为 44100。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-19T19:47:04.060

我发现模拟器（2.1 SDK）中的声音非常不一致。有时有效，有时无效。即使它确实有效，它通常也非常不稳定和失真（在播放 mp3 等音频文件时）。

需要记住的几件事：

*   `AudioSessionInitialize`您的应用程序完成启动后立即致电
*   通过（使用诸如 的值）设置`kAudioSessionProperty_AudioCategory`会话的属性`AudioSessionSetProperty``kAudioSessionCategory_MediaPlayback`
*   称呼`AudioSessionSetActive(YES)`

当然，当所有其他方法都失败时，只需在您的硬件上运行它！

编辑：现在 2.2 SDK 已经发布，我在模拟器中没有任何声音问题。他们一定已经修复了错误！我强烈建议您升级到 2.2 SDK。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-20T01:53:35.567

2.1 SDK 修复了 OpenAL 无法在模拟器上运行的问题。确保 Active SDK*和*Active Executable 设置为 2.1。

顺便说一句，请确保您使用的是最新版本的 CrashLanding (v1.8)。SoundEngine 中的一些令人讨厌的漏洞最近得到了修复。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-06-12T21:26:03.140

如果重新激活系统声音对您不起作用，请尝试以下操作：启动 audio-midi-setup，然后将“内置输出”配置为使用 44.100Hz、2 个通道、24 位。（来自[http://www.cocos2d-iphone.org/forum/topic/4159](http://www.cocos2d-iphone.org/forum/topic/4159)）

不知何故，几天后，我的 iphone 模拟器现在想要 48.000Hz，2 个通道，24 位。只需玩一会儿，并警告它在插入耳机、进入待机、重新启动等时可能会随机变化。

这是一个离题的提示：当您将耳机插入您的 iphone/ipad 时，缓冲区大小可能会翻倍（例如，从 512 字节到 1024 字节），请确保您不要依赖您请求的缓冲区大小！

# algorithm - 确定给定价格的“通常”现金支付金额的算法

> ID：302406
> 
> 赞同：5
> 
> 时间：2008-11-19T16:07:41.023
> 
> 标签：algorithm, logic, payment

你走进一家商店，选择几种产品，然后去柜台付帐。总金额为（`A`）。你把手伸进钱包、钱包或口袋，放下一些现金 ( `P`)，其中`P`>= `A`，收银员会给你找零。

给定流通中的一组硬币和纸币，最可能的值是`P`多少？

一些例子，假设可用的钞票是 5 美元、10 美元、20 美元、50 美元和 100 美元，可用的硬币是 5c、10c 和 25c：

`A`= $151.24
`P[1]`= $160 (8x$20) 或 ($100 + 3x$20)
`P[2]`= $155 ($100 + $50 + $5)

`A`= $22.65
`P[1]`= $25 ($20 + $5)
`P[2]`= $30 ($20 + $10)
`P[3]`= $40 ($20 + $20)

`A`= $0.95
`P[1]`= $1 (4 x 25c)
`P[2]`= $5

其中许多数字看起来很直观，但我感觉算法很难确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T21:42:52.123

“最有可能”使这是一个非常棘手的问题。您需要了解每种货币的相对可用性和分布情况。例如，流通中的所有纸币中有 22% 是 20 美元，这使得它们比 10 美元或 50 美元的纸币更可能用于 10 美元到 100 美元之间的金额。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T21:56:58.633

这实际上是一个已知问题，如果我没记错的话，它是[binpacking的一种变体......](http://en.wikipedia.org/wiki/Bin_packing_problem)

有时它被称为收银员算法（或[贪心算法](http://en.wikipedia.org/wiki/Greedy_algorithm)）。您可以在此演示文稿中找到一个实现：[http](http://www.cs.princeton.edu/~wayne/kleinberg-tardos/04greed.pdf) ://www.cs.princeton.edu/~wayne/kleinberg-tardos/04greed.pdf ，参见第 11/12/13 页。

（澄清一下，正常的收银员算法只返回支付客户所需的最小数量的硬币。但您可以更改动态编程解决方案来计算所有可能的组合）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T22:13:18.443

还有其他因素，您不太可能用 6 x 0.25 支付，而是使用 1 x 1.00 和 2 x 0.25。通常，0.25 不会超过 3，0.10 不会超过 2，0.05 不会超过 1。

同样在现实世界中，许多人从不关心低于 1.00 的值，他们总是用账单支付并“保持零钱”。

这同样适用于 5.00、10.00 和 20.00，购买超过几美元的人将使用 5.00 或 10.00。当然，由于 ATM 机，20.00 是流通中最常见的。

这个软件是干什么用的？您实际上是在尝试模拟实际购买并需要准确的结果，还是一个不需要严格的简单模拟？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T17:44:57.097

哦！@#$%^&*()_，现在我真的很生气。

我只写了10分钟的伪代码和复杂度估计，当我发帖时只有“我是人”按钮，没有任何机会输入内容，我的完整帖子不见了（当然，这次我没有做编辑窗口的副本，以防万一...），好的，这是简短的版本：

硬币数量通常是超单调的（即每个值都大于先前值的总和），因此您可以使用贪心来获得 A 的确切硬币。

现在使用这个多组 P 硬币，将其添加到（到目前为止为空的）结果集（一组多重集）和（到目前为止也是空的）工作集。

现在重复直到工作集为空：

将集合 P 从工作集中取出，P' = P，对于 P 中的每个硬币 c： P' = P.replace(c, nextBiggerCoin)，removeSmallestCoin(只要 P 没有最小的硬币仍然 > A)

如果 P' 尚未在结果集中，则将其放入结果集和工作集中

我猜测的复杂度是 O(s*n^2)，其中 s 是解决方案的数量。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-25T03:28:29.493

> 它适用于销售点系统。计算最终价格时，收银员必须输入客户提供的现金金额。应该将三个“快捷方式”按钮设置为“可能”金额，以使收银员的生活更轻松。绝对完美是不必要的。– eJames（11 月 19 日 22:28）

我不认为有一个完美的算法。如果我是你，我会找到大量现金交易的现有 POS 数据来源，并在特定价格范围内对其进行评估。找出人们通常如何为特定的价格范围付费（确切的变化更有可能），并为最差异化的范围制定最合适的公式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-20T17:06:35.737

我实际上是最终实施这个的人，所以我认为最好发布最终结果。它不漂亮，但它很快并且没有任何循环或数组。我不认为这是对概念问题的解决方案，但它确实解决了实际问题。

在大多数情况下，实际使用限制在 5 美元到 200 美元之间。大多数人通常不会定期取出 500 美元现金：）

我决定查看从 0 美元到 5 美元、5 美元到 10 美元的各种案例。. . 45 到 50 美元。我们有 3 个按钮，所以在每种情况下，第一个按钮（最低的）将是高于价格的下一个 5 美元的价值。所以如果是 7.45 美元，那么第一个按钮就是 8 美元，13.34 美元 -> 15 美元，21.01 美元 -> 25 美元。

这留下了第二个和第三个按钮。给定 5 美元、10 美元、20 美元、50 美元钞票的标准价值，每个案例都有明显的答案。例如：查看 $24.50 然后 1->$25、2->$30、3->$40。这些可以使用表格和一些常识找到。

我还发现使用大于 50 美元的值可以简单地匹配低于 50 美元的值。即：72.01 美元的答案与 22.01 美元的答案相同，依此类推。唯一需要注意的是数字大于 60 且小于 70。这种情况需要处理 4 张 20 美元钞票的可能性。

The algorithm also scales nicely into the $100 to $200 range. Above that is a rare case in retail.

# delphi - 如何在 Delphi 字符串中转义字符

> ID：302409
> 
> 赞同：44
> 
> 时间：2008-11-19T16:08:10.460
> 
> 标签：delphi, string, escaping, literals

Delphi 字符串使用单引号，例如 ' `a valid string`'。如何`'`在文字字符串中指定字符？如何引用空字节（Unicode 代码点`U+0000`）？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-11-19T16:15:40.803

要将单引号添加到字符串，请包含两个`'`标记，例如

```
str := '''test string''';
Writeln(str) 
```

在上面的字符串中，你有一个普通的单引号来开始一个字符串，然后是两个单引号。字符串的结尾也是如此。

您还可以使用`#`后跟数字来表示其他转义字符，例如
换行：

```
str := 'Newline' + #13 + #10 
```

要不就

```
str := 'Newline'#13#10 
```

当然，对换行使用平台相关的常量会更好。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-19T16:28:34.223

要回答问题的最后一部分，您可以使用

```
#$0000 
```

添加 U+0000

这样您也可以添加其他 Unicode 字符。（请务必使用可以显示这些字符的字体。）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-19T16:17:15.700

对于`'`字符，它放了两次。例如：`'Don''t'`。空字节类型为#0。

# c# - 无法将对象添加到速度缓存

> ID：302418
> 
> 赞同：1
> 
> 时间：2008-11-19T16:10:43.137
> 
> 标签：c#, .net, appfabric

我刚刚在我的计算机上安装了[Velocity](http://msdn.microsoft.com/sv-se/library/cc645013(en-us).aspx)，除了我无法将任何对象添加到缓存之外，一切似乎都运行良好。我可以毫无问题地检索缓存本身，但是当我尝试添加一个对象时，一切都会冻结五分钟，然后我就会超时。

**我连接到缓存主机的代码（工作正常）：**

```
// Define Array for 1 cache host.
ServerEndPoint[] servers = new ServerEndPoint[1];

// Specify Cache Host Details 
servers[0] = new ServerEndPoint(
       "COMPUTERNAME" /* Host  */, 
       22233 /* Port */, 
       "DistributedCacheService" /* Service name */);

// Pass configuration settings to CacheFactory constructor.
m_cacheFactory = new CacheFactory(servers, 
       true /* Use routing client */, 
       false /* No local cache */);

// Get the cache (works fine).
Cache cache = m_cacheFactory.GetCache("MyCache"); 
```

**我将对象添加到缓存的代码（不起作用）：**

```
// Get the cache.
Cache cache = m_cacheFactory.GetCache("MyCache");

// Create the item to put in the cache.
Product product = new Product();
product.Sku = "10000";
product.Name = "My Product";

// Put the object in the cache (The add method doesn't work either).
cache.Put(product.Sku /* Key */, product /* Value */); 
```

通过集群管理员界面，我验证了缓存主机正在运行并且缓存本身存在。

任何人都知道问题可能是什么？

**编辑：**

我将一个日志接收器提供程序附加到缓存工厂，并且我已经验证存在某种超时。缓存主机在我的本地机器上，防火墙已关闭。

> CASClient - 尝试与 net.tcp://l1441gbg:22233/distributedcacheservice,Velocity.DRM.SendReceive,Warning,2008-11-20 11:06:29.988 交谈超时

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T16:21:05.200

您是否使用辅助选项创建了 namedCache“myCache”？我在使用单个服务器集群并使用 -Secondaries 1 选项创建 NamedCache 时遇到了同样的冻结问题。似乎主服务器无法复制您要放入缓存的对象。尝试删除命名的 chache 并使用 -secondaries 0 选项重新创建它。

# c# - 国际奥委会设计资源

> ID：302421
> 
> 赞同：6
> 
> 时间：2008-11-19T16:11:59.907
> 
> 标签：c#, .net, dependency-injection, inversion-of-control, alt.net

我已经对此进行了很多搜索，并且没有太多运气找到有凝聚力的东西。我是一个相对较新的开发人员，刚刚开始我的第一个专业开发职位。我知道即使在基础领域我也有很多东西要学。基于收听 PodCast、阅读博客、论文等；我开始明白，在设计和构建软件时考虑分离关注点、IOC、依赖注入似乎是正确的做法。我在非常高的水平上获得了这些概念，并希望尽可能多地接近我对此所做的事情。

所以，这就是问题所在。我怎么会这样设计东西？我在一个团队工作，该团队继承了一个基于 Web 的产品，该产品耦合非常紧密，文档记录非常差，而且通常不容易维护一些软件。Evryone 似乎喜欢移除这对夫妇中的一些人的想法。他们喜欢开发自动化测试的想法（根据我所读到的内容，使用松散耦合的组件更容易做到这一点）。似乎没有人知道该怎么做。我愿意尝试一下，但我需要指导。我发现的一切似乎总是以一种非常高级的方式谈论这些东西，或者相反，只关注整体的一小部分。我想要一些关于一本书、一系列教程、视频或一些东西的指导，这些东西需要一个真实的例子，向你展示如何应用这些原则。理想情况下，

我知道这有点啰嗦，我只是有点沮丧，因为我发现的大多数综合培训材料根本没有以一种开始的人可以从一天开始应用良好实践的方式讨论这个话题一。

谢谢大家的时间。

史蒂夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T16:49:42.920

您绝对应该查看[dimecasts.net](http://www.dimecasts.net/)上的 IoC 截屏视频。它们非常直截了当，可以帮助您掌握一些概念。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T05:31:10.430

我也遇到了同样的情况，我买了这两本书

（要打印的 PDF 版本） [http://www.manning.com/osherove/](http://www.manning.com/osherove/) 和 [http://www.manning.com/prasanna/](http://www.manning.com/prasanna/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-23T16:02:50.390

我建议您查看[这篇博](http://www.jameskovacs.com/blog/TheBookshelf.aspx)文中提到的 James Kovacs 书。一个对你的情况特别尖锐。那就是“有效地使用遗留代码”。它对重构的概念有很好的解释。它还提供了这些概念的示例，尽管这些概念在 C#、Java 和 C++ 中很容易理解。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T16:33:52.653

我只能描述我们想出的东西。我们从各种在线库中借用了可用性语法等，但代码都是我们的。

基本上，我们有我们所说的 ServiceContainer，一个对象。它总是有一个全局实例，如果你愿意，可以是一个单例副本，静态的，因此在 web 应用程序中，在 appdomain 中的所有用户之间共享。

ServiceContainer 包含规则。规则是这样说的：*如果有人要一个 XYZ 类型的对象，这就是你如何为他们提供它的方法*。

例如，一个规则可能是为了让某些代码获得一个实现 IDbConnection 的对象，容器将构造、配置并返回一个新的 SqlConnection 对象。

因此，有问题的代码不知道也不关心它使用的是 SqlConnection 对象，而不是 OleDbConnection 对象。

写完之后，我意识到这不是一个很好的例子，因为最终您会向连接请求命令对象，并且您为该对象提供的 SQL 语法必须根据连接类型进行调整。但是如果我们现在可以忽略这一点，代码就不会知道它正在连接到 SQL Server，它只知道它有一个连接对象。

现在，这里有问题的*代码*需要给出它应该使用的容器，因此需要给出规则。这意味着从单元测试的角度来看，我可以创建一个新的 ServiceContainer 实例，将新规则写入其中以进行测试，并要求代码执行它的操作。最终，代码会想要执行一些 SQl（在这种情况下），而不是与真正的数据库对话，它会调用我的 IDbConnection 和 IDbCommand 的测试实现，从而让我有机会验证事情是否正常。

更重要的是，它为我提供了一种返回适合测试的已知虚拟数据的方法，而无需模拟整个数据库。

现在，对于*注入*部分，在我们的例子中，我们可以要求容器为我们提供必须构建的对象，这些对象依赖于其他对象。

例如，假设我们有一个 IDataAccessLayer 接口和一个 MSSQLDataAccessLayer 实现。

虽然接口没有给我们任何外部迹象表明它进行了任何日志记录，但这里的实际实现需要有一个地方来记录它执行的所有 SQL。因此，该类的构造函数可能如下所示：

```
public MSSQLDataAccessLayer(ILogger logger) { ... } 
```

在 ServiceContainer 对象中，我们注册了以下规则（这是我们的语法，在其他任何地方都找不到，但应该很容易遵循）：

```
ServiceContainer.Global.RegisterFactory<ILogger, FileLogger>()
    .FactoryScoped()
    .WithParameters(
        new Parameter("directory", @"C:\Temp")
    );
ServiceContainer.Global.RegisterFactory<IDataAccessLayer, MSSQLDataAccessLayer>()
    .FactoryScoped(); 
```

FactoryScoped 意味着每次我向容器请求一个对象时，我都会得到一个新对象。

规则，如果我用英文写，是这样的：

*   如果有人需要 ILogger 的实现，请构造一个新的 FileLogger 对象，并获取需要“目录”参数的构造函数，并在传入“C:\Temp”作为参数时使用该构造函数
*   如果有人需要 IDataAccessLayer 的实现，请构造一个新的 MSSQLDataAccessLayer

请注意，我之前说过 MSSQLDataAccessLayer 的构造函数采用 ILogger，但我没有在这里指定任何参数？这给了我以下代码来获取访问层对象：

```
IDataAccessLayer dal = ServiceContainer.Global.Resolve<IDataAccessLayer>(); 
```

现在发生的情况是容器对象发现该对象是 MSSQLDataAccessLayer，并且它有一个构造函数。这个构造函数需要一个 ILogger 对象，但是你瞧，容器知道如何创建一个。容器将因此构造一个新的 FileLogger 对象，并将其传递给 MSSQLDataAccessLayer 对象的构造函数，静默。

因此，大部分应用程序依赖项的配置可以一次完成，在某个中央位置并在启动期间执行，而其余代码则完全没有意识到这里发生的所有魔法。

出于单元测试的目的，我可以重写规则以提供我自己的虚拟记录器对象，该对象仅将记录的文本存储在内存中，这使我能够轻松验证我期望记录的代码是否实际记录，而无需读取之后归档。

这些规则为我们提供了如何实际提供对象实例的强大功能：

*   来自委托/方法，这意味着如果我们愿意，我们可以自己完成构建依赖对象的所有魔法
*   从构造函数中自动生成（或者自动确定要使用哪一个，或者我们可以通过名称/类型提供足够的虚拟参数来选择一个）
*   或者我们可以为容器提供一个现有实例（这将有点像单例）

在提出我们自己的方法之前，我们查看了[autofac](http://code.google.com/p/autofac/)，基本上我们只是查看了显示调用语法示例的 wiki，然后坐下来编写了我们自己的系统来满足我们的需要。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-19T19:49:38.407

我必须将您引导到我为一个询问良好单元测试示例的人回答的同一个开源项目。

> [寻找具有大量单元测试的 *small*、开源、c# 项目](https://stackoverflow.com/questions/287646/looking-for-small-open-source-c-project-with-extensive-unit-testing#287755)
> 
> 我建议看一下 CarTrackr，它具有开发人员应该熟悉的各种 .Net 技术（尤其是 Unity、MVC 框架），并且具有广泛的单元测试。该项目足够简单，可以一口气消化，但又足够复杂，实际上不仅仅是概念验证。他们的 codeplex 网址位于 [http://www.codeplex.com/CarTrackr](http://www.codeplex.com/CarTrackr)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-13T16:12:22.103

[Ayende的](http://ayende.com/)[这篇文章](http://msdn.microsoft.com/en-us/library/aa973811.aspx)是我见过的对 IoC 的最佳介绍。

# sql - Like vs. "=" 用于使用 SQL Server 匹配字符串

> ID：302423
> 
> 赞同：9
> 
> 时间：2008-11-19T16:13:14.380
> 
> 标签：sql, sql-server, like-keyword

每当我编写一个基于字符串变量（varchar、nvarchar、char）选择数据的存储过程时，我都会有类似的东西：

```
procedure dbo.p_get_user_by_username(
    @username      nvarchar(256)
as
begin
    select
        u.username
        ,u.email
        --,etc
    from
        sampleUserTable u
    where
        u.username = @username
end 
```

所以换句话说，为了匹配我会拥有的记录

```
u.username = @username 
```

但有时我会遇到使用***LIK*** *E*代替***=的代码***

```
u.username like(@username) 
```

你会在什么时候使用它？不应该只在需要一些通配符匹配时使用吗？

**编辑**

感谢您的回答。

我认为我需要澄清我真正想问的是：是否可能存在更喜欢使用 like 代替 "=" 进行精确字符串匹配的情况。从答案中我可以说不会有。根据我自己的经验，即使在我需要忽略大小写以及前导和结尾空格的情况下，我也会在两个字符串上使用 ltrim、rtrim、lower 和“=”。再次感谢您的输入。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-19T16:20:33.103

你是对的。除非您进行通配符匹配，否则使用 LIKE 没有任何好处。此外，在没有通配符的情况下使用它可能会导致使用低效的查询计划。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-20T01:11:00.537

Sunny几乎做对了:)

在 SQL2005 的默认安装中在 QA 中运行以下命令

```
select * from sysobjects where name = 'sysbinobjs   '
-- returns 1 row
select * from sysobjects where name like 'sysbinobjs   '
-- returns 0 rows 
```

因此，LIKE 在尾随空格上不匹配，在查询计划方面两者的性能几乎相同，但 '=' 连接的性能稍好一些。

使用 LIKE 时必须记住的另一件事是正确转义字符串。

```
declare @s varchar(40) 
set @s = 'escaped[_]_%'

select 1 where 'escaped[_]_%'  like @s 
--Return nothing = BAD 

set @s = '_e_s_c_a_p_e_d_[___]___%' 

select 1 where 'escaped[_]_%'  like @s escape '_'
--Returns 1 = GOOD 
```

一般人不会使用 LIKE 进行精确匹配，因为转义问题会导致各种并发症和微妙的错误，人们忘记了转义，这是一个痛苦的世界。

但是……如果你想要一个真正有效的精确匹配，LIKE 可以解决这个问题。

假设您想将用户名与“sam”匹配，并且不想得到“Sam”或“Sam”，不幸的是，列的排序规则不区分大小写。

像下面这样（添加了转义）是要走的路。

```
select * from sysobjects
WHERE name = 'sysbinobjs' and name COLLATE Latin1_General_BIN LIKE 'sysbinobjs' 
```

进行双重匹配的原因是为了避免表扫描。

然而 ....

我认为[varbinary 转换技巧](https://stackoverflow.com/questions/306906/how-do-i-perform-an-exact-string-match-is-a-non-case-sensitive-field#306918)不太容易出现错误并且更容易记住。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-19T17:09:01.430

如果没有使用通配符，那么区别在于，“=”进行完全匹配，但 LIKE 将匹配带有尾随空格的字符串（来自 SSBO）：

> 当您使用 LIKE 执行字符串比较时，模式字符串中的所有字符都是重要的，包括前导或尾随空格。如果查询中的比较是返回带有字符串 LIKE 'abc'（abc 后跟一个空格）的所有行，则不返回该列的值为 abc（没有空格的 abc）的行。但是，模式匹配的表达式中的尾随空格将被忽略。如果查询中的比较是返回所有带有字符串 LIKE 'abc'（abc 没有空格）的行，则返回所有以 abc 开头并且有零个或多个尾随空格的行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T16:18:18.350

使用[LIKE](http://msdn.microsoft.com/en-us/library/ms179859.aspx)关键字，您可以将字段`u.username`与指定的模式而不是固定的“字符串”进行匹配。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-19T18:54:01.483

如果您在其他人的代码中看到这一点，可能他们打算允许一个人传入包含模式或通配符的字符串。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-19T16:22:59.883

是的 - 你是对的 - 它应该只用于通配符匹配。应该谨慎使用它，尤其是在非索引字段上的非常大的表上，因为它会减慢您的查询速度。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-12-06T15:36:35.157

我遇到了同样的问题。运行类似的查询大约需要一分半钟`=`。当我更改`=`为`like`查询时要快得多。

*   尝试为您要比较的列创建索引。这大大加快了查询速度。
*   尝试运行`sp_updatestats`。在我的情况下，这使得查询在不使用索引的情况下运行大约 6 秒`=`，并且几乎立即使用索引。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-20T01:13:51.280

LIKE 用于通配符匹配，其中 as = (equals) 用于精确匹配。

我还认为它用于已被 FULL TEXT CATALOGS 编目的字段以进行硬核字符串比较。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-19T16:21:54.333

是的，据我所知，使用不带任何通配符的 like 与使用 = 运算符相同。您确定输入参数中没有通配符吗？

# .net - 如何在系统托盘中显示图标？

> ID：302430
> 
> 赞同：1
> 
> 时间：2008-11-19T16:15:24.313
> 
> 标签：.net, windows, windows-shell, system-tray, notifyicon

我想让我的 .Net 应用程序在系统托盘中显示通知。所以我想为此显示一个图标，谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T16:19:57.347

打开应用程序的主窗体，转到工具箱，打开所有 Windows 窗体部分并在窗体上放置一个 NotifyIcon。然后将您想要的图标添加到 NotifyIcon。

您可能还希望在窗体最小化时将窗体的 ShowInTaskbar 属性更改为 false，并处理 NotifyIcon 的双击事件以恢复您的窗体并将 ShowInTaskbar 设置回 true。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T16:41:04.900

您需要将**NotifyIcon**添加到 Windows 窗体并将**Icon**属性设置为适当的图标，将窗体的**ShowInTaskBar**属性设置为 false。

您可能还想处理表单关闭事件并隐藏而不是关闭表单；将**ContextMenuStrip**添加到**NotifyIcon**将允许您提供上下文菜单，其中包含带有适当处理程序的 Exit 和 Settings 等选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T16:19:56.910

在 .Net 应用程序中，您可以指定要用作图标的文件 - 它可以是位图或 png 等，因此只需使用您喜欢的图像编辑程序来创建您的图标。

本文提供了有关让您的应用程序在系统托盘中放置图标的建议[。](http://www.developer.com/net/csharp/article.php/3336751)

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T16:15:24.120

请参阅此内容，它涵盖了鼠标单击与 NotifyIcon 的所有组合以及更多内容。该代码位于模板中，并且是项目设置驱动的，因此您可以在所有项目中实现 NotifyIcon 逻辑，而无需进行任何编码工作。

更多在这里

[http://code.msdn.microsoft.com/TheNotifyIconExample](http://code.msdn.microsoft.com/TheNotifyIconExample)

# .net - 如何从 .NET 设置 COM+ 组件的构造函数字符串？

> ID：302435
> 
> 赞同：0
> 
> 时间：2008-11-19T16:16:17.463
> 
> 标签：.net, com+

我正在尝试从 C# 应用程序以编程方式设置 COM+ 组件的构造函数字符串。我在网上找到了下面的示例代码，但是它抛出了一个异常：

```
 COMAdminCatalogCollection Components;
        COMAdminCatalogClass Catalog = new COMAdminCatalogClass();
        string strConstr;
        string ApplicationName = "ApplicationName"; // case sensitive
        string CompName = "MyComponent.ProgID";
        COMAdminCatalogCollectionClass Applications = (COMAdminCatalogCollectionClass)Catalog.GetCollection("Applications");
        Applications.Populate();
        // find the correct application
        foreach (COMAdminCatalogObjectClass AppObject in Applications)
        {
            if (AppObject.Name == ApplicationName)
            {
                // find matching component
                Components = (COMAdminCatalogCollectionClass)(Applications.GetCollection("Components", AppObject.Key));
                Components.Populate();
                foreach (COMAdminCatalogObjectClass CompObject in Components)
                {
                    if (CompObject.Name.ToString() == CompName)
                    {
                        CompObject.get_Value("ConstructorString").ToString();
                        CompObject.get_Value("ConstructionEnabled").ToString();
                    }
                }
            }
        } 
```

当我运行此代码时，我在第 6 行得到以下异常：

> 无法将类型为“System.__ComObject”的 COM 对象转换为类类型“COMAdmin.COMAdminCatalogCollectionClass”。进入 CLR 且不支持 IProvideClassInfo 或未注册任何互操作程序集的 COM 组件将包装在 __ComObject 类型中。这种类型的实例不能转换为任何其他类；但是，只要底层 COM 组件支持对接口的 IID 的 QueryInterface 调用，它们就可以转换为接口。

知道我哪里出错了吗？或者有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T18:11:04.907

我找到了一种避免异常的方法。与在 C# 中执行此操作不同，我可以利用 VB.NET 的可选弱类型来删除所有强制转换和几个变量声明类型。生成的代码如下所示：

```
 Dim Components As COMAdminCatalogCollection
    Dim Catalog As New COMAdminCatalogClass()
    Dim ApplicationName As String = "ApplicationName"
    Dim CompName As String = "MyComponent.ProgID"
    Dim Applications = Catalog.GetCollection("Applications")
    Applications.Populate()
    For Each AppObject In Applications

        If (AppObject.Name = ApplicationName) Then

            Components = (Applications.GetCollection("Components", AppObject.Key))
            Components.Populate()
            For Each CompObject In Components

                If (CompObject.Name.ToString() = CompName) Then
                    CompObject.Value("ConstructorString") = "Some new value"

                    Components.SaveChanges()
                End If

            Next
        End If
    Next 
```

这是 VB 和 C# 显着不同的一种情况，了解这些内容确实有助于您为工作选择正确的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T16:14:56.553

我相信你已经顺利通过了这个，但我目前正在开发一个需要类似功能的项目，我能够使用 .NET 和 PowerShell 提出一个解决方案来做到这一点。首先，我在 C# 中创建了一个自定义 cmdlet，如下所示：

```
using COMAdmin;
using System;
using System.Runtime.InteropServices;
using System.Management.Automation;

namespace COMAdminModule
{
    // Name the cmdlet
    [Cmdlet("Set", "COMConstructorString")]
    public class SetCOMConstructorSting : PSCmdlet
    {

        // App name Parameter
        private string comAppName;

        [Parameter(
            Mandatory = true,
            ValueFromPipelineByPropertyName = true,
            ValueFromPipeline = true,
            Position = 0,
            HelpMessage = "Name of COM+ Application"
            )]

        [Alias("App Name")]

        public string COMApp
        {
            get { return comAppName; }
            set { comAppName = value; }
        }

        // App Component name
        private string componentName;

        [Parameter(
            Mandatory = true,
            ValueFromPipelineByPropertyName = true,
            ValueFromPipeline = true,
            Position = 1,
            HelpMessage = "The name of the Component that will receive a new Constructor string"
            )]

        [Alias("Component Name")]

        public string ComponentName
        {
            get { return componentName; }
            set { componentName = value; }
        }

        // Constructor String
        private string constructorString;

        [Parameter(
            Mandatory = true,
            ValueFromPipelineByPropertyName = true,
            ValueFromPipeline = true,
            Position = 2,
            HelpMessage = "The new Constructor string"
            )]

        [Alias("Constructor String")]

        public string ConstructorString
        {
            get { return constructorString; }
            set { constructorString = value; }
        }

        // Provides a one-time, preprocessing functionality for the cmdlet
        protected override void BeginProcessing()
        {
            base.BeginProcessing();
        }

        // Provides a record-by-record processing functionality for the cmdlet
        protected override void ProcessRecord()
        {
            string working = "Setting the constructor string " + constructorString;
            working = " to the Component " + componentName;
            working += " for the COM App " + comAppName;

            WriteObject(working);

            setConstructorString(comAppName, componentName, constructorString);
        }

        // Provides a one-time, post-processing functionality for the cmdlet
        protected override void EndProcessing()
        {
            base.EndProcessing();
        }

        //Add component method
        private void setConstructorString(string comAppName, string componentName, string constructorString)
        {
            ICOMAdminCatalog2 oCatalog = null;

            try
            {

                //Create the comAdmin object
                oCatalog = (ICOMAdminCatalog2)Activator.CreateInstance(Type.GetTypeFromProgID("ComAdmin.COMAdminCatalog"));

                //Get the comApps
                ICatalogCollection comApps = (ICatalogCollection)oCatalog.GetCollection("Applications");
                comApps.Populate();

                foreach (ICatalogObject app in comApps)
                {

                    //Find the comApp
                    if (app.Name.ToString().Equals(comAppName))
                    {
                        //Get the Components
                        ICatalogCollection components = (ICatalogCollection)comApps.GetCollection("Components", app.Key);
                        components.Populate();

                        foreach (ICatalogObject component in components) 
                        {
                            //Find the component
                            if (component.Name.ToString().Equals(componentName))
                            {
                                // Set the constructor string
                                component.set_Value("ConstructorString", constructorString);

                                components.SaveChanges();

                                break;
                            }

                        }

                        break; 
                    }

                }

            }
            catch (Exception e)
            {
                WriteObject(e.Source);
                throw;
            }
        }
    }
} 
```

然后将该模块导入 PowerShell 脚本并按如下方式运行它：

```
PS C:\Windows\system32> Import-Module "<dll path>"

PS C:\Windows\system32> Set-COMConstructorString <Application Name> <Component Name> <Constructor String> 
```

# seo - 使用维基百科内容会损害页面/网站的 SEO 排名吗？

> ID：302442
> 
> 赞同：1
> 
> 时间：2008-11-19T16:18:46.227
> 
> 标签：seo, wikipedia

维基百科允许您复制其内容。

*如果您想在自己的书籍/文章/网站或其他出版物中使用 Wikipedia 资料，您可以这样做——但必须遵守 GFDL。* [看这里。](http://en.wikipedia.org/wiki/Wikipedia_Copyright#Reusers.27_rights_and_obligations)

我正在考虑使用一些维基百科内容来填充我网站上的页面。例如 - 只看前几段。这样做的动机不是为了 SEO，而是为了向网站用户提供信息。

我的问题是：这样做会伤害我自己的页面搜索引擎优化吗？我用谷歌搜索了一下，不断提到*谷歌补充索引*。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T16:25:24.403

在一个网站内有重复的内容肯定会导致你的排名受到惩罚，但可能不会在网站之间。不过，谷歌的算法非常先进，所以它可能会让你措手不及。也就是说，如果您不得不用其他地方的内容来填充您的网站，那么这可能表明其他地方不太对劲。为什么不直接链接到 Wikipedia 文章？这样你绝对不会受到惩罚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T15:58:01.633

谷歌是一头复杂的野兽，所以你总是有可能被抓住。

但是，如果您只打算使用 Wikipedia 中的一两段，那么我不明白 Google 为什么会介意，只要您提供引用该文章的链接即可。

另一种选择是自己重写信息，然后链接到维基百科以引用信息。这是我经常用于技术页面的一种方法，因为通过这种方式我得到了谷歌的内容，并且谷歌和用户都正确地引用了维基百科（使用哈佛参考系统）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T17:29:56.940

答案是肯定的。您和维基百科都将因拥有相同内容而受到 Google 算法的惩罚。Google 允许实际版权所有者提交 DMCA 请求，以从 Google 的索引中删除该剽窃网站。

# sql-server - 无法追踪报告处理性能问题

> ID：302444
> 
> 赞同：2
> 
> 时间：2008-11-19T16:18:57.363
> 
> 标签：sql-server, reporting-services

我们在生产环境中遇到了一个非常令人沮丧的问题。

我们有一份报告有时会很快返回，有时则根本不返回。当问题发生时，报告将处理 15 分钟左右，然后浏览器将显示“无法显示网页”错误。这个问题是零星的，通常会持续几天，然后我们得到几天的非常快的处理，然后又变慢了。当报告运行良好时，我们可以在大约 10 秒内返回超过 14k 条记录。

我们的数据团队告诉我，当我们看到从慢到快的转变时，SQL Server 上没有发生任何事情。没有索引重建、统计数据重新计算等。

底层报表查询（存储过程）总是运行得很快。即使我们遇到问题，我也可以连接到生产数据库，使用与报表相同的用户，并使用相同的参数运行存储过程，它总是快速返回。我们检查了阻塞，但没有发生。

该报告确实有很多参数。我看过有关“参数嗅探”的帖子，所以我创建了一个无参数版本的报告，但我仍然得到相同的结果。

这份报告没有什么复杂的。这是一张桌子。在报告级别不进行分组或过滤。没有子报表。该报告确实使用交互式排序。

该报告可以返回超过 14k 条记录。数据总量约为 2MB。但就像我之前所说的，有时报告运行良好，甚至会在几秒钟内返回最大数量的记录。

该报告使用共享数据源，许多其他未遇到此问题的报告也使用该数据源。

在报告数据库中，我们看到这些报告请求的记录被添加到 RunningJobs 表中，但之后我们没有看到任何处理发生。就像报表服务器忘记了它们一样。

我们当前的思路或想法是 Report Server 没有正常运行，因为 RunningJobs 中的这些条目只是坐在那里并且没有被处理。

有谁知道为什么工作可能会出现在 RunningJobs 表中？如果这些作业正在运行，我们应该在报表服务器日志文件中看到一些内容，对吗？还有什么我们应该测试的吗？

我们的报表服务器版本为 9.00.3050.00。我们正在通过 Report Viewer Web 控件进行访问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T20:42:22.793

也许尝试一个较小的数据集，看看是否会改变它。

任一服务器上的任何 CPU 峰值？

报告的运行时间是否与您遇到的情况相符？ReportServer 中的 ExecutionLog 表应该显示这一点。

听起来很烦人 - 我很同情，希望我有更好的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T19:23:34.697

您是否尝试过使用 SQL Server 分析器分析请求？使用它，您可以确定请求是否已在 SQL Server 中完成，问题出在生成报告中，或者查询是否实际上未完成。

如果查询在缓慢时未完成，您可以捕获查询计划并将其与您没有问题时生成的计划进行比较。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T15:13:08.973

我能够解决在我们切换数据库服务器并更新 web.config 中的连接字符串后发生的类似问题。我的查询运行了大约 5 到 6 秒，但报告花费的时间太长，以至于我的网页超时（我正在使用本地报告；我没有报告服务器。）

我怀疑我的 DAL 中的 DataTables 在继续使用新服务器之前仍在四处寻找旧服务器。我可能对这个想法很遥远，但它的解决方案仍然有效！

我通过在右键单击菜单中选择“配置”刷新了 .xsd 文件中的所有数据表，并在保留所有默认值的情况下单击“下一步”，直到我不得不单击“完成”。在浏览了每个 DataTable 之后，我重建了网站，现在它的运行速度与我的查询一样快。

我希望这有帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-17T08:11:38.887

确认您的报告中没有任何带有外部链接的图像。如果这样做，则图像主机可能需要很长时间才能成为服务器。我有一个非常相似的情况，报告服务器失去了出站互联网访问权限，因此报告服务器在处理过程中无法检索外部图像。不幸的是，SRRS 不只是检查，得到一个 http 错误，然后返回，它等待，等待。我怀疑（但尚未验证）它试图检索报告每一页的图像。我之所以这么说是因为报告长度与旧执行时间与存在问题时的执行时间之间的差异之间存在相关性。报告的每一页似乎都有 5 到 12 秒的延迟。

如果您想了解有关我如何解决问题的更多详细信息，请参阅我的帖子：

[SQL Server Reporting Services - 快速时间数据检索 - 长时间处理](https://stackoverflow.com/questions/2451959/sql-server-reporting-services-fast-timedataretrieval-long-timeprocessing)

亲切的问候，

伯尼

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T18:28:33.233

我没有使用过 ReportServer（到目前为止），但我已经看到 SQL Server 出现类似问题，这些问题只是由网络交换机（或其他网络硬件）故障引起的。一些数据包丢失并且应用程序无限期地等待服务器 - 并且服务器上绝对没有活动。

# c++ - 如何在 Visual C++ 中检查 vtable？

> ID：302446
> 
> 赞同：4
> 
> 时间：2008-11-19T16:18:59.657
> 
> 标签：c++, visual-c++, inheritance

假设一个人继承了一个复杂的代码库（在 Visual C++ 中，假设是 2003 年或更晚），并带有一个大而复杂的继承图。假设它很深，并且有很多虚函数，甚至可能还有多重继承。（是的，有点维护噩梦）。任何将这个类层次结构重构为更合理的东西的尝试都需要知道每个类使用的每个虚函数的实现。

如果我们采用任意叶类 L1——它从基类 B1 派生，从基类 B2 派生，等等——它显然会有一个用于该类的 vtable，它将显示类似（伪 vtable）的内容：

```
L1::F1
B3::F2
B1::F3
L1::F4
etc. 
```

...具体取决于哪个类已覆盖了哪些虚函数。

怎么能以类似的形式看到这样的 vtable？可以通过阅读代码手动重建它，但这容易出错且费力。据推测，在调试器中闯入类的对象可以让您通过该类的 vtable 指针在 Watch 窗口中检查 vtable，但这是一个尴尬的解决方案，特别是如果您还想查看 L2 的 vtable， L3, ... LN。

DbgHelp.dll 是否提供了以编程方式检查 vtable 的工具（允许以任何需要的形式输出）？还是有其他方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-19T17:00:07.937

在 Visual Studio 2005 中，有两个未记录的标志可以完全满足您的需要。它们是**reportAllClassLayout**和**reportSingleClassLayout**标志。例如，在 cl.exe 命令行上尝试“/d1 reportAllClassLayout”。它将向您展示包括虚拟表在内的完整课程布局，这是一个[示例](http://www.gamedev.net/community/forums/topic.asp?topic_id=396484&whichpage=1&#2629055)。另见[http://blogs.msdn.com/vcblog/archive/2007/05/17/diagnosing-hidden-odr-violations-in-visual-c-and-fixing-lnk2022.aspx](http://blogs.msdn.com/vcblog/archive/2007/05/17/diagnosing-hidden-odr-violations-in-visual-c-and-fixing-lnk2022.aspx) 没有太多信息在这些标志上，因为它们现在没有记录，但也许微软会在未来版本的 Visual Studio 中正式支持它们。

另一种方法，实际上是我更喜欢的方法，是使用[IDA Pro](http://www.hex-rays.com/idapro/) Interactive 反汇编程序。有一个巨大的学习曲线，但 IDA 足够聪明，可以帮助您构建 VTable 并将它们链接到您的类。它用于对传统上没有符号的二进制文件进行逆向工程，但它也使用 Visual Studio pdb 文件。这样做您将**准确地**看到**所有**vtable 的样子。哪些虚拟表被用于哪些方法，或者哪些方法被覆盖，所有这些都是在单步执行代码时进行的。换句话说，您实际上会在运行时调试期间看到您的方法调用被跟踪**到 vtable中。**正如您所注意到的，像 VS 调试器这样的典型调试器不会跟踪到虚拟表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T21:57:51.487

我强烈建议使用[Doxygen](http://www.doxygen.org/)作为任何类型的代码分析工具。我认为它没有快速找到类型中任何函数的最终覆盖器的方法，但它应该提供继承和实现的列表，以便您可以快速扫描树以识别覆盖器任何给定的功能（通常，您的层次结构不足以使其成为大问题）。它还可以生成调用图、关系图和超链接源代码，这是一个很棒的工具。

# sql - 计算上一季度的最后一天

> ID：302452
> 
> 赞同：9
> 
> 时间：2008-11-19T16:20:22.603
> 
> 标签：sql, sql-server, date

计算上一季度最后一天的最有效方法是什么？

示例：给定日期 2008 年 11 月 19 日，我想返回 2008 年 9 月 30 日。

平台是 SQL Server

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-19T17:02:58.087

如果@Date 有问题的日期

```
Select DateAdd(day, -1, dateadd(qq, DateDiff(qq, 0, @Date), 0)) 
```

编辑：感谢下面的@strEagle，更简单的是：

```
Select dateadd(qq, DateDiff(qq, 0, @Date), -1) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-07-28T16:13:40.593

其实更简单的是：

```
SELECT DATEADD(qq, DATEDIFF(qq, 0, GETDATE()), -1) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-10-22T05:14:31.963

**获取当前日期**

```
SELECT CONVERT(DATE,GETDATE()) [Current Date] 
```

**获取当前日期的季度第一个日期**

```
SELECT CONVERT(DATE, DATEADD(QQ, DATEDIFF(QQ, 0, GETDATE())  ,0)) [Current Quarter 1st Date] 
```

**获取当前日期的季度最后日期**

```
SELECT CONVERT(DATE,DATEADD(d, -1, DATEADD(q, DATEDIFF(q, 0, GETDATE()) +1, 0))) [Current Quarter Last Date] 
```

**获取当前日期下一季度的第一个日期**

```
SELECT CONVERT(DATE, DATEADD(QQ, DATEDIFF(QQ, 0, GETDATE()) +1 ,0)) [Next Quarter 1st Date] 
```

**获取当前日期下一季度的最后一个日期**

```
SELECT CONVERT(DATE,DATEADD(d, -1, DATEADD(q, DATEDIFF(q, 0, GETDATE()) +2, 0))) [Next Quarter Last Date] 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-19T16:38:06.250

我想出了这个（测试了所有月份）：

```
select dateadd(dd,-1,dateadd(qq,datediff(qq,0,'11/19/2008'),0)),
       dateadd(dd,-1,dateadd(qq,datediff(qq,0,'10/19/2008'),0)),
       dateadd(dd,-1,dateadd(qq,datediff(qq,0,'12/19/2008'),0)) 
```

结果可能是最简单的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-24T07:26:25.093

```
convert(varchar, dateadd(dd,-1,dateadd(qq,1,DATEADD(qq, DATEDIFF(qq,0,YOUR_DATE), 0))),112) 
```

您也可以根据以下列表更改 112

```
SELECT convert(varchar, getdate(), 100) -- mon dd yyyy hh:mmAM (or PM)
                                        -- Oct  2 2008 11:01AM
SELECT convert(varchar, getdate(), 101) -- mm/dd/yyyy - 10/02/2008                  
SELECT convert(varchar, getdate(), 102) -- yyyy.mm.dd – 2008.10.02           
SELECT convert(varchar, getdate(), 103) -- dd/mm/yyyy
SELECT convert(varchar, getdate(), 104) -- dd.mm.yyyy
SELECT convert(varchar, getdate(), 105) -- dd-mm-yyyy
SELECT convert(varchar, getdate(), 106) -- dd mon yyyy
SELECT convert(varchar, getdate(), 107) -- mon dd, yyyy
SELECT convert(varchar, getdate(), 108) --  hh:mm:ss
SELECT convert(varchar, getdate(), 109) -- mon dd yyyy hh:mm:ss:mmmAM (or PM)
                                        -- Oct  2 2008 11:02:44:013AM   
SELECT convert(varchar, getdate(), 110) -- mm-dd-yyyy
SELECT convert(varchar, getdate(), 111) -- yyyy/mm/dd
SELECT convert(varchar, getdate(), 112) -- yyyymmdd
SELECT convert(varchar, getdate(), 113) -- dd mon yyyy hh:mm:ss:mmm
                                        --  02 Oct 2008 11:02:07:577     
SELECT convert(varchar, getdate(), 114) -- hh:mm:ss:mmm(24h)
SELECT convert(varchar, getdate(), 120) -- yyyy-mm-dd hh:mm:ss(24h)
SELECT convert(varchar, getdate(), 121) --  yyyy-mm-dd hh:mm:ss.mmm
SELECT convert(varchar, getdate(), 126) -- yyyy-mm-ddThh:mm:ss.mmm
                                        --  2008-10-02T10:52:47.513
-- SQL create different date styles with t-sql string functions
SELECT replace(convert(varchar, getdate(), 111), '/', ' ') -- yyyy mm dd
SELECT convert(varchar(7), getdate(), 126)                 -- yyyy-mm
SELECT right(convert(varchar, getdate(), 106), 8)          -- mon yyyy 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2016-04-12T16:00:26.900

**在亚马逊红移中：**

上一季度的最后一天：

```
select dateadd(day,-1,DATE_TRUNC('qtr', current_date)) from whatever 
```

当前季度的最后一天：

```
select dateadd(qtr,1,dateadd(day,-1,DATE_TRUNC('qtr', current_date))) from whatever 
```

# visual-studio-2008 - 视觉工作室错误？

> ID：302456
> 
> 赞同：0
> 
> 时间：2008-11-19T16:20:38.360
> 
> 标签：visual-studio-2008

现在大约有六次，我一直在 Visual Studio 中做日常琐事——要么运行单元测试，要么只是编译、从 SVN 更新某些东西或其他什么，Visual Studio 就消失了……它关闭并立即消失……它当我重新启动它时很好，并且我有一段时间没有再次看到问题......它一直在发生，并且出于随机原因......有其他人经历过这种情况吗？

一种想法是我正在使用 AnkhSVN，但是如果您遇到此问题并且没有遇到此问题，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T16:32:23.360

很有可能是您的插件之一导致了这种情况。

如果您能够在它发生时重新创建，请尝试使用各种插件组合（如果您只运行 AnkhSVN，则只尝试使用和不使用）。

Anhk 能够做到这一点并非不可能，因此首先要确定这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T16:25:52.670

我团队中的所有开发人员都经常看到这个问题。它不是 AnkhSVN，因为我们不使用它。我相信它是 C++ 智能感知，但这只是一种感觉。有时它发生在我们什么都不做的时候。我们会去喝咖啡，回来，它就消失了。

我从来没有在较小的项目上遇到过这种情况，但在我们混合了非托管 C++、托管 C++ 和 C# 的大型（数百万行，数十个项目）解决方案中经常发生。

自从升级到 SP1 后，我们很少看到它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T16:38:39.727

绝对是插件。我遇到了类似的问题，但它会使我的机器蓝屏。卸载插件（它是 SlickEdit Gadgets）后，我再也没有遇到过这个问题。尝试卸载插件。或者更新ankhSVN。

# language-agnostic - 什么是编程习语？

> ID：302459
> 
> 赞同：78
> 
> 时间：2008-11-19T16:21:33.117
> 
> 标签：language-agnostic, idioms

我看到“编程成语”这个短语被大家所理解。然而，在搜索结果和stackoverflow中，我看到了一切......

从微：

*   增加一个变量
*   代表一个无限循环
*   交换变量值

中等：

*   [PIMPL](http://aszt.inf.elte.hu/~gsd/halado_cpp/ch09s03.html)
*   [RAII](http://www.hackcraft.net/raii/)
*   [格式、评论、风格……](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html)

宏：

*   [编程范式或常用库功能作为成语](http://pschombe.wordpress.com/2006/05/06/the-next-big-programming-idiom/)
*   [流程模型作为成语](http://blogs.msdn.com/g/archive/2008/06/07/a-finding-from-an-architecture-review-of-a-product-with-components-that-originated-on-unix.aspx)
*   [成语集合等于新范式](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.48.7793)

“编程习语”有一个单一的通用定义吗？由于“编程习语”在许多范围内使用：

*   微观：句法细微差别或通用句法
*   介质：常见的样式和图案
*   宏：作为成语的编程范式

在任何这些范围内使用该短语是否有效？到目前为止，答案都集中在句法习语上。其他的也有效吗？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-11-19T16:49:26.820

编程习惯是用特定语言编写任务的常用方法。例如，在 C 中，循环通常是这样编写的：

```
for (i=0; i<10; i++) 
```

PHP 会理解类似的结构：

```
for ($i = 1; $i <= 10; $i++) 
```

但在 PHP 中不鼓励循环遍历数组。在这种情况下，您将使用：

```
foreach ($arr as $value) 
```

而在 Ruby 中，您将使用：

```
(1..10).each 
```

对于循环，或：

```
array.each 
```

用这些语言编写循环有很多可能性。使用这个成语可以让有经验的读者立即识别它。然后他们可以把时间花在更重要的问题上。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-11-19T16:31:15.983

（非编程）语言中的“成语”是特定语言独有的说法或表达。通常一些不遵循语言“规则”的东西，只是因为母语人士“知道”它的意思而存在。（例如，在英语中我们说“in line”但“out *of* line”——这是惯用语）

将其移至编程领域，我们得到如下内容：

```
 if(c=GetValue())
 {...} 
```

这实际上意味着：

```
 c = GetValue();
 if (c != 0)
 {....} 
```

每个 C/C++ 程序员都理解，但会让来自不同编程语言的人完全困惑。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-19T16:24:17.230

见[http://en.wikipedia.org/wiki/Programming_idiom](http://en.wikipedia.org/wiki/Programming_idiom)

编程习语是一种模式、算法或结构化代码的方式。谈论编程习语就是谈论那些在代码中经常出现的模式或提出新的模式。

熟悉惯用语，尤其是较大的惯用语的好处是，在查看代码时，您可以看到几行代码，但由于它是一个特定的惯用语，因此您可以在心理上将代码表示和思考为单个惯用语，而不是必须单独阅读和理解每一行。

说代码不是惯用的，就是说它没有以允许人类读者有效思考代码的方式构建自身。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-19T16:29:57.403

成语是语言学的一个术语。它是一组字面意思不是字面意思的词。例如，当某人感觉不舒服时，说他们“不舒服”。这个特殊的短语来自水手们谈论乘客，晕船的乘客会去到船舶运动较少的“天气”甲板下面。但我们大多数人都不是水手，也不知道这句话的字面意思。

在编程中，即使是大多数指令，即使是英文单词，普通大众也无法理解。例如“for循环”。虽然它们对程序员有意义，但对大多数其他人来说却没有。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-05-14T04:35:45.933

由于大型程序是从小型程序发展而来的，因此至关重要的是，我们开发出一套标准程序结构库，我们已经确定其正确性——我们称它们为惯用语——并学习使用经过验证的组织技术将它们组合成更大的结构。

程序员应该掌握好的算法和习语。

Alan J. Perlis - [SICP 前言](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-5.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-19T16:25:27.100

来自[WikiPedia](http://en.wikipedia.org/wiki/Programming_idioms)：编程习语是一种用一种或多种编程语言表达重复结构的方法。

我猜你已经走上了这条路！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-15T12:12:17.713

成语是**可以在多个地方识别的“模式”。**

我不会说它与特定的编程语言有任何关系。

```
Iterator foo;
foo.reset();
while (foo.next())
{
    print(foo.value());
} 
```

这是我称之为“for each”成语的片段，它在多种语言中的表达方式略有不同。

另一个很好的成语例子是**Socket**。所有声称拥有套接字的平台，在概念上都以相同的方式工作，也就是说，它们都具有大致相同的接口。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-19T16:33:25.337

成语是一种表达特定语言特定内容的方式。例如这里有一些[英语习语](http://www.usingenglish.com/reference/idioms/)。

您可以推断这一点以将该概念应用于编程。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-01-13T02:38:23.060

尽早陷入困境：以相同的方式执行相同的过程。积累成语。标准化。莎士比亚和你的唯一区别（！）是他的成语列表的大小——而不是他的词汇量。

*   ALAN PERLIS，编程中的警句

[http://www.cs.yale.edu/quotes.html](http://www.cs.yale.edu/quotes.html)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-06-20T17:35:35.743

它来自[惯用语，编程中的](https://en.wiktionary.org/wiki/idiomatic)[惯用](https://en.wiktionary.org/wiki/idiom)语一词的含义可以概括为短语，其含义和含义大于单词的总和。在编程中，大多数代码片段实际上都是惯用的。'*属于或符合一种语言的自然表达方式*'

编程习语可以被认为是对可转移到不同情况的一类解决方案的描述。考虑`while { ... }`与`do {} while`这些是惯用的，它们包含相同的单词，但排序带有重要区别。确切的措辞会因语言而异，但基本含义和含义会有所不同；例如`do {} while`，无论使用什么语言或语句来实现它，总是会执行一次。作为一个成语，它是一个想法的可转移形式。它可以在许多情况下使用，并用不同的词（语句/命令）表示，但基本结果将始终相同。

# java - Java 集合（LIFO 结构）

> ID：302460
> 
> 赞同：42
> 
> 时间：2008-11-19T16:21:51.883
> 
> 标签：java, collections, stack, queue

我正在 Java 的 Collections 框架中寻找 LIFO 结构（堆栈），但没有任何成功。基本上我想要一个非常简单的堆栈；我的完美选择是 Deque，但我使用的是 Java 1.5。

我不想在我的结构中添加另一个类，但我想知道这是否可能：

1.  Collections 框架（1.5）中是否有任何类可以完成这项工作？

2.  如果没有，有没有办法在不重新实现的情况下将队列转换为 LIFO 队列（又名堆栈）？

3.  如果不是，我应该为此任务扩展哪个接口或类？我想保持 Sun 的家伙使用 Deque 的方式是一个好的开始。

非常感谢。

编辑：我忘了说 Stack 类：当我看到它实现了 Vector 类时，我对这个类有疑问，而且 Vector 类有点过时了，不是吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-11-19T16:24:39.520

实际上有一个 Stack 类：http: [//java.sun.com/j2se/1.5.0/docs/api/java/util/Stack.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Stack.html)

如果您不想使用它，LinkedList 类 ( [http://java.sun.com/j2se/1.5.0/docs/api/java/util/LinkedList.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/LinkedList.html) ) 具有`addFirst`and`addLast`和`removeFirst`and`removeLast`方法，使其非常适合用作堆栈或队列类。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-01-17T19:25:33.757

我意识到我在这里聚会迟到了，但是 java.util.Collections (Java 7) 有一个静态的“asLifoQueue”，它接受一个 Deque 参数并（显然）返回 deque 的 LIFO 队列视图。我不确定这是添加了什么版本。

[http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#asLifoQueue(java.util.Deque)](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#asLifoQueue(java.util.Deque))

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-02-28T22:25:09.357

# `Deque`, `ArrayDeque`, &`LinkedList`

虽然前一段时间有人问过这个问题，但提供一个 JDK6+ 答案可能是明智的，它现在提供了一个由[ArrayDeque](http://docs.oracle.com/javase/8/docs/api/java/util/ArrayDeque.html)数据结构实现的[Deque](http://docs.oracle.com/javase/8/docs/api/java/util/Deque.html)（甲板）接口，并且更新了[LinkedList](http://docs.oracle.com/javase/8/docs/api/java/util/LinkedList.html)以实现这个接口。

# `ConcurrentLinkedDeque`&`LinkedBlockingDeque`

并发访问的特殊形式也存在并由[ConcurrentLinkedDeque](http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentLinkedDeque.html)和[LinkedBlockingDeque](http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/LinkedBlockingDeque.html)实现。

# LIFO 与 FIFO

deque 的一大优点是它同时提供 LIFO（堆栈）和 FIFO（队列）支持，它可能会导致混淆哪些方法用于队列操作，哪些方法用于新人的堆栈操作。

恕我直言，JDK 应该有一个`Stack`接口和一个`Queue`仍然可以由[ArrayDeque](http://docs.oracle.com/javase/8/docs/api/java/util/ArrayDeque.html)之类的接口实现，但只公开该结构所需的方法子集，即 LIFO 可以定义和`pop()`，然后在`push()``peek()`

```
LIFO<String> stack = new ArrayDeque<>(); 
```

只有堆栈操作被公开，这会阻止某人在打算使用[push(E](http://docs.oracle.com/javase/8/docs/api/java/util/Deque.html#push-E-) )时意外调用[add(E) 。](http://docs.oracle.com/javase/8/docs/api/java/util/Deque.html#add-E-)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-22T14:04:19.680

**堆栈**类很慢：方法是同步的 +**堆栈**扩展同步**向量**

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-19T16:24:08.180

API 中有一个[Stack 类](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Stack.html)。这会满足您的需求吗？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-10-05T16:21:08.650

# `Deque`&`LinkedList`

只是为了完整起见，我提供了一个使用[`Deque`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Deque.html)接口和[`LinkedList`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/LinkedList.html)实现的示例。

```
 Deque<String> deque = new LinkedList<>();
    deque.add("first");
    deque.add("last");

    // returns "last" without removing it
    System.out.println(deque.peekLast());

    // removes and returns "last"
    System.out.println(deque.pollLast()); 
```

[`Deque`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Deque.html) 用 a备份 a [`LinkedList`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/LinkedList.html)对性能很有好处，因为从中插入和删除元素是在恒定时间内完成的 (O(1))。

[`LinkedList`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/LinkedList.html)单独使用：

```
 LinkedList<String> list = new LinkedList<>();
    list.add("first");
    list.add("last");

    // returns "last" without removing it
    System.out.println(list.getLast());

    // removes and returns "last"
    System.out.println(list.removeLast()); 
```

# c# - 如何只找到同时具有 getter 和 setter 的属性？

> ID：302476
> 
> 赞同：38
> 
> 时间：2008-11-19T16:25:17.930
> 
> 标签：c#, .net, reflection

C#、.NET 3.5

我正在尝试获取具有实例的 getter 和 setter 的对象的所有属性。我*认为*应该工作的代码是

```
PropertyInfo[] infos = source.GetType().GetProperties(BindingFlags.Instance | BindingFlags.Public | BindingFlags.SetProperty | BindingFlags.GetProperty); 
```

但是，结果包括一个没有设置器的属性。为了让您对可能会影响这一点的继承结构有一个简单的了解（尽管我不知道如何）：

```
public interface IModel
{
    string Name { get; }
}

public class BaseModel<TType> : IModel
{
    public virtual string Name { get { return "Foo"; } }

    public void ReflectionCopyTo(TType target)
    {
        PropertyInfo[] infos = this.GetType().GetProperties(BindingFlags.Instance | BindingFlags.Public | BindingFlags.SetProperty | BindingFlags.GetProperty);
        foreach (PropertyInfo info in infos)
            info.SetValue(target, info.GetValue(this, null), null);
    }
}

public class Child : BaseModel<Child>
{
    // I do nothing to override the Name property here
} 
```

使用 Name 时出现以下错误：

```
System.ArgumentException: Property set method not found. 
```

编辑：我想知道为什么这不起作用*，*以及我应该怎么做才能不出错。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-11-19T16:31:11.083

调用[`GetGetMethod`](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.getgetmethod.aspx)和[`GetSetMethod`](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.getsetmethod.aspx)属性 - 如果两个结果都不为空，你就在那里:)

（无参数版本只返回公共方法；有一个带有布尔参数的重载来指定您是否还需要非公共方法。）

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2010-07-22T09:35:25.473

您可以检查`PropertyInfo.CanRead`和`PropertyInfo.CanWrite`属性。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-01-02T00:32:10.373

怎么样...

```
var qry = typeof(Foo).GetProperties(BindingFlags.Instance | BindingFlags.Public)
            .Where(p => p.CanRead && p.CanWrite); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T16:56:39.580

这不应该工作。

请参阅允许的[msdn](http://msdn.microsoft.com/en-us/library/aa332493(VS.71).aspx)`GetProperties`上的定义：

以下`BindingFlags`过滤器标志可用于定义要包含在搜索中的嵌套类型：

```
* You must specify either BindingFlags.Instance or BindingFlags.Static in order to get a return.
* Specify BindingFlags.Public to include public properties in the search.
* Specify BindingFlags.NonPublic to include non-public properties (that is, private and protected members) in the search.
* Specify BindingFlags.FlattenHierarchy to include static properties up the hierarchy. 
```

或者您可以在[msdn](http://msdn.microsoft.com/en-us/library/system.reflection.bindingflags(VS.71).aspx)`GetProperty`中查看/的定义，其中指出：`SetProperty`

> GetProperty = 指定应返回指定属性的值。
> 
> SetProperty = 指定应设置指定属性的值。对于 COM 属性，指定此绑定标志等效于指定 PutDispProperty 和 PutRefDispProperty。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T00:35:30.677

为了使它更通用一点，您可以从 'ObjectWithDefaultValues' 继承和/或调用 obj.SetDefaultValues() 扩展方法。两者都在下面列出。

代码：

```
public abstract class ObjectWithDefaultValues : object {

    public ObjectWithDefaultValues () : this(true){
    }

    public ObjectWithDefaultValues (bool setDefaultValues) {
        if (setDefaultValues)
            this.SetDefaultValues();    
    }
}

public static class ObjectExtensions {

    public static void SetDefaultValues(this object obj) {
        foreach (FieldInfo f in obj.GetType().GetFields(BindingFlags.Instance | BindingFlags.FlattenHierarchy | BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.SetField)) {
            foreach (Attribute attr in f.GetCustomAttributes(true)) {
                if (attr is DefaultValueAttribute) {
                    var dv = (DefaultValueAttribute)attr;
                    f.SetValue(obj, dv.Value);
                }
            }
        }

        foreach (var p in obj.GetType().GetProperties(BindingFlags.Instance | BindingFlags.FlattenHierarchy | BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.SetProperty)) {
            if (p.GetIndexParameters().Length == 0) {
                foreach (Attribute attr in p.GetCustomAttributes(true)) {
                    if (attr is DefaultValueAttribute) {
                        var dv = (DefaultValueAttribute)attr;
                        p.SetValue(obj, dv.Value, null);
                    }
                }
            }
        }
    }
} 
```

# asp.net - 在 ASP.NET 中显示带空格的字符串？

> ID：302482
> 
> 赞同：1
> 
> 时间：2008-11-19T16:27:24.413
> 
> 标签：asp.net, string, whitespace

我需要在 asp.net 页面上显示一个带有空格的字符串。

****这是我正在做的：****

```
cell = New TableCell

cell.Text = value  (lets assume value is <"  test with whitespace    ">

row.Cells.Add(cell) 
```

**它被渲染为**

```
<tr>
<td>"  test with whitespace    "</td>
</tr> 
```

不显示单引号内的空格。

我希望这个值在我的页面上显示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T16:30:08.340

HTML 去除了除一个空格字符之外的所有字符。您需要使用 &NBSP; 实体以确保空白以 HTML 呈现。使用 String 类的 Replace 方法（或 RegEx）将每个空格换出 &NBSP;

[http://en.wikipedia.org/wiki/Non-breaking_space](http://en.wikipedia.org/wiki/Non-breaking_space)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T16:37:01.650

您是否尝试在文本之前和之后获得一个空格，以便在表格单元格的边框和文本之间留出一些间距？

如果是这样，您应该查看 CSS 样式“ **padding** ”或 padding-left、padding-right。这将在表格边框和文本之间添加空间。

将此添加到您的页面：

```
<style type="text/css">
td {
padding: 4px;
}
</style> 
```

如果这不是你所追求的，我很抱歉。

# wpf - 是否有使用数据绑定的可空设置的智能模式？

> ID：302483
> 
> 赞同：0
> 
> 时间：2008-11-19T16:28:22.667
> 
> 标签：wpf, user-interface, design-patterns

在我的应用程序中，我有绑定到对象属性的控件。

但控件总是如下所示：

*   一个复选框
*   说明设置的标签
*   编辑控件（例如：文本框）

当复选框未选中时，我使用绑定来禁用文本框。

当复选框未选中时，我希望属性值为空。

选中复选框后，我希望属性包含文本框中的值**。**

文本框可以是`NumericUpDown`、`ComboBox`、`DatePicker`等。

有没有一种聪明的方法来使用绑定来获得这种行为，或者代码是我唯一的选择？

我真的很想构建一个支持它并重新使用它的控件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-08T04:09:27.683

您似乎想要绑定到一个自定义对象，该对象具有“UseNull”属性以及基础属性。

然后可以使用 TemplateSelector 选择非空值的“真实”控件。

至少我最初是这样解决这个问题的。

# .net - (VB).NET 中的“:=”运算符是什么，或者它有什么用？

> ID：302486
> 
> 赞同：13
> 
> 时间：2008-11-19T16:29:17.407
> 
> 标签：.net, vb.net, colon-equals

我不时看到这个，想知道它是什么。我确实尝试过 google，但它从搜索中过滤掉了字符。我有几本书也没有参考。

FWIW，我记得帕斯卡是赋值运算符。

谁能指出我的 MSDN 或类似页面？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-19T16:43:07.097

您可以使用 := 语法按名称而不是严格按位置将参数分配给 Sub 或 Function。例如：

```
Public Class Form1

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        TestRoutine(Y:="TestString", X:=12)
    End Sub

    Private Sub TestRoutine(ByVal X As Long, Optional Y As String = "")
        ' Do something with X and Y here... '
    End Sub

End Class 
```

请注意，TestRoutine 将 X 指定为第一个参数，将 Y 指定为第二个参数，但是 Form1_Load 中的调用以相反的顺序将它们指定为使用 := 运算符命名每个参数。

这是关于该主题的 MSDN 文章的链接：

[http://msdn.microsoft.com/en-us/library/51wfzyw0.aspx](http://msdn.microsoft.com/en-us/library/51wfzyw0.aspx)

我不经常看到这个使用，除了在 Excel 的宏记录器生成的 VBA 宏中，它经常使用***它***。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-19T17:44:55.053

当有多个可选参数时，它非常有用 - 您会在调用 Office 对象模型（Word、Excel 等）的代码中看到很多。当您有 40 个参数，其中 37 个是可选参数，并且您想为参数 34 设置值时和 40，使用 := 比使用看起来像 ("new", "settings", 1, ,,,,,,,,,,,,,,,,,,, 的函数调用要清晰**得多**,,,,,,,,,43,,2,,,,,7)

我想对 JeffK 发表评论，但我没有足够的代表。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-19T16:33:57.083

VB 使用该运算符进行属性值分配：

[http://www.ondotnet.com/pub/a/dotnet/excerpt/vbnut_8/index1.html](http://www.ondotnet.com/pub/a/dotnet/excerpt/vbnut_8/index1.html)

# c# - WCF服务，如何隐藏内部方法？

> ID：302488
> 
> 赞同：2
> 
> 时间：2008-11-19T16:29:49.603
> 
> 标签：c#, accessor

在我的 WCF 服务中，我有当前公开的方法，但我想对外界隐藏它们，但能够在我的 WCF 服务中使用它们。

我在看的是内部的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T16:35:04.803

yes internal 将限制对当前程序集的访问

[http://msdn.microsoft.com/en-us/library/ba0a1yw2.aspx](http://msdn.microsoft.com/en-us/library/ba0a1yw2.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T16:37:23.990

为了不让外界（WCF 客户端）知道它们，您所要做的就是不使用 [ServiceContract] 属性标记它们，那么它们是否公开也没关系

如果您分发包含 WCF 服务的 DLL，您可以标记这些方法：

*   私有（只能在同一个类中调用）
*   受保护的（与私有的+继承自它的类相同）
*   internal （与 private 相同 + 同一程序集中的所有其他类 + 程序集中已在 InternalsVisibleTo 中命名的任何类（google it）

# objective-c - @property 设计问题的另一种适当用法

> ID：302496
> 
> 赞同：1
> 
> 时间：2008-11-19T16:32:00.427
> 
> 标签：objective-c, cocoa, cocoa-touch

这是[避免 @property-itis](https://stackoverflow.com/questions/284428/avoiding-property-itis-ie-overuse-of-properties-when-are-they-appropriate)的后续行动。

UIWebView 具有以下属性声明：

```
@property(nonatomic,readonly,getter=canGoBack) BOOL canGoBack;
@property(nonatomic,readonly,getter=canGoForward) BOOL canGoForward; 
```

UIScrollView 有这些：

```
@property(nonatomic) BOOL canCancelContentTouches; 
```

然而，UIResponder 有

```
- (BOOL)isFirstResponder;
- (BOOL)canBecomeFirstResponder;
- (BOOL)canResignFirstResponder; 
```

UIResponder 是否应该将它们声明为属性，但无论出于何种原因，它们都不是？

还是将它们声明为属性是不合适的？如果不合适，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T16:48:02.687

我最好的猜测是 UIResponder 是为了匹配 NSResponder，当然 NSResponder 是在 Objective-C 2.0 引入属性之前设计的。为什么 UIWebView 对 WebView 不做同样的事情，我不知道。我希望 Cocoa 中的属性在一段时间内会以这种方式有点精神分裂，在考虑您自己的代码时我不会考虑太多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T18:34:27.560

综合属性指定如何访问属性。是否使用综合属性是一个设计决定，因为正确实现的 getter 和 setter 方法将提供相同的功能。

只要可以使用可用的属性属性正确实现所讨论的方法，就没有理由不重写它们来这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T22:11:57.060

一个属性应该直观地映射到你的类的一些存储机制——无论是在你中声明的 ivar`@interface`还是由运行时合成的东西。调用诸如此类的方法的行为`canBecomeFirstResponder`不一定需要查询类以获取保存微不足道的存储机制，`BOOL`而是会导致触发一些事件链来查询响应者树。也就是说，没有`firstResponder`ivar，因为任何这些方法的值都不能存储在缓存中，必须在执行时确定。

# user-interface - 确定您的网站配色方案

> ID：302497
> 
> 赞同：6
> 
> 时间：2008-11-19T16:32:08.117
> 
> 标签：user-interface, web, color-scheme, color-management

从 UI 的角度来看，我遇到的最大问题之一是在构建新网站时弄清楚我将使用什么颜色以及这些颜色中的颜色，它们是否真的可以很好地协同工作。

我发现这个网站确实帮助了我，我想我会与大家分享它，并得到一些关于类似网站或其他方式的回复，你可以得到/找出你的配色方案。

这是我目前使用的网站：[http://kuler.adobe.com/](http://kuler.adobe.com/)

使用 Adob​​e Kuler，您可以选择一种基色，它会建议 5 种颜色，包括您的颜色，它们可以相互搭配。当然，您可以修改它选择的颜色。此外，我使用的主要功能之一是图像颜色匹配。您可以上传图像，它将根据图像的颜色确定配色方案。因此，如果您有徽标并想使用徽标的颜色，那么这对您来说非常合适。

谢谢你，我期待你的反馈！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T16:38:10.273

库勒不错。我也喜欢[http://www.degraeve.com/color-palette/](http://www.degraeve.com/color-palette/)仅用于创建基于图像的配色方案，以及[http://www.colourloves.com/](http://www.colourlovers.com/)用于挑选完美搭配的颜色。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T17:05:00.627

我使用[Color Brewer](http://www.personal.psu.edu/faculty/c/a/cab38/ColorBrewer/ColorBrewer.html)。它报告颜色在哪里有用（投影仪、笔记本电脑、打印页面等）以及颜色是否适合色盲。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T17:09:25.530

我过去使用过 Color Schemer，它有一个非常简单的界面：

[http://www.colorschemer.com/online.html](http://www.colorschemer.com/online.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-07T14:17:10.783

这里有两个我喜欢的：

[http://www.colorcombos.com/combotester.html](http://www.colorcombos.com/combotester.html)

[http://colorschemedesigner.com/](http://colorschemedesigner.com/)

我也喜欢你提到的[http://kuler.adobe.com/ 。](http://kuler.adobe.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-26T10:02:44.063

徽标或任何图像的配色方案：在线工具，您可以在其中上传图像/徽标，它会为您提供与您的徽标/图像相匹配的建议配色方案。

这是链接[http://www.pictaculous.com/](http://www.pictaculous.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-05T14:45:55.010

一些预制托盘可以提供灵感。[我最喜欢的是 Google Material Colors，这里](https://penguoir.github.io/Google-Material-Colors/#)有一个时尚的网站。

# drivers - 如何在 Vista 64 中加载 64 位 USB 驱动程序

> ID：302501
> 
> 赞同：-1
> 
> 时间：2008-11-19T16:33:12.623
> 
> 标签：drivers, signing, vista64

我在 Vista 64 位系统中工作。

我有一个 3rdPartyUsbDriver.sys 和 3rdPartyUsbDriver.inf 文件。

我已经对 inf 文件中的供应商和产品 ID 进行了必要的更改，以使用我的自定义硬件。这可以在“未签名的驱动程序测试模式”下安装并正常工作。

我现在想以“正常模式”安装此驱动程序。我不在乎，如果它弹出警告说该驱动程序来自不受信任的来源。

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-19T17:12:44.823

在 Vista 4 位上安装驱动程序的唯一方法是对驱动程序进行[数字签名](http://www.microsoft.com/whdc/winlogo/drvsign/kmsigning.mspx)。我认为你需要在[这里](http://www.verisign.com/)得到签名。我不是 100% 确定，但驱动程序可能也需要通过[WHQL](http://www.microsoft.com/whdc/whql/default.mspx)。WHQL 政策页面位于[此处](http://www.microsoft.com/whdc/whql/policies/default.mspx)。
如果可能，请联系您的驱动程序供应商并要求他这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T00:46:25.560

原来我需要基于 .inf 和 .sys 文件创建并签署一个“cat”文件。

# .net - 基于 .Net 3.5 的 Web 应用程序是否可以使用基于 2.0 的库？

> ID：302504
> 
> 赞同：1
> 
> 时间：2008-11-19T16:33:41.423
> 
> 标签：.net

我觉得这是一个愚蠢的问题，我错过了一些东西，但我什至还没有弄清楚如何搜索这个:(

针对 .Net 3.5 Framework 编写的应用程序能否利用在 2.0 Framework 中编写的库？

答案中的其他信息，例如“为什么”和/或如何找到此信息会有所帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T16:41:39.567

是的你可以。底层运行时没有改变，它仍然是 CLR v2.0，c#3 仍然编译为 2.0 MSIL，在 2.0 CLR 上执行。此外，ASP.NET 仍然有效地处于 2.0 版，因为它的核心基础没有改变（C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll）。

.NET 3.5 是一个附加的框架更新，而不是替代品。您仍将在使用 3.0 和 3.5 的同时使用 BCL 和 FCL 的 v2.0 部分。

**更新：**以防万一你感兴趣，我问了一个问题，关于 2.0 代码消耗 3.5 程序集，这是相反的：

[使用 C# 3.0 编译的 C# 2.0 代码使用程序集](https://stackoverflow.com/questions/9508/c-20-code-consuming-assemblies-compiled-with-c-30)

希望对
凯夫有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T16:37:21.993

是的，它可以，.Net framework 2.0、3.0 和 3.5 都共享同一个 CLR 2.0，这意味着程序集都由同一个 CLR 加载并且是二进制兼容的。

# perl - 如何在 Perl 中修改 Windows NTFS 权限？

> ID：302507
> 
> 赞同：5
> 
> 时间：2008-11-19T16:34:02.513
> 
> 标签：perl, winapi, permissions

我在 Windows Server 2003 上使用 ActiveState Perl。

我想在 Windows NTFS 分区上创建一个目录，然后授予 Windows NT 安全组对该文件夹的读取权限。这在 Perl 中可能吗？我是否必须使用 Windows NT 命令或是否有 Perl 模块来执行此操作？

一个小例子将不胜感激！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-19T17:24:28.310

标准方法是使用[Win32::FileSecurity](http://search.cpan.org/perldoc?Win32::FileSecurity)模块：

```
use Win32::FileSecurity qw(Set MakeMask);

my $dir = 'c:/newdir';
mkdir $dir or die $!;
Set($dir, { 'Power Users' 
            => MakeMask( qw( READ GENERIC_READ GENERIC_EXECUTE ) ) }); 
```

请注意，这`Set`将覆盖该目录的权限。如果您想编辑现有权限，您`Get`首先需要它们：

```
my %permissions;
Win32::FileSecurity::Get($dir, \%permissions);
$permissions{'Power Users'}
  = MakeMask( qw( READ GENERIC_READ GENERIC_EXECUTE ) ) });
Win32::FileSecurity::Set($dir, \%permissions); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-19T16:50:06.817

[这](http://www.roth.net/perl/perms/)是 ActivePerl 的通用权限包。

```
use Win32::Perms;

# Create a new Security Descriptor and auto import permissions
# from the directory
$Dir = new Win32::Perms( 'c:/temp' ) || die;

# One of three ways to remove an ACE
$Dir->Remove('guest');

# Deny access for all attributes (deny read, deny write, etc)
$Dir->Deny( 'joel', FULL );

# Set the directory permissions (no need to specify the
# path since the object was created with it)
$Dir->Set();

# If you are curious about the contents of the SD
# dump the contents to STDOUT $Dir->Dump; 
```

# sql-server - 如何获取 SQL Server 2005 和 ASP 中使用的下一个标识号？

> ID：302515
> 
> 赞同：5
> 
> 时间：2008-11-19T16:35:09.047
> 
> 标签：sql-server, asp-classic, ado, identity, autonumber

我之前通过执行如下简单查询获得了 Access 中使用的下一个可用自动编号：

```
SELECT RecordNumber, Info 
FROM myTABLE 
WHERE 0 = 1 
```

这样我可以创建一个变量来保存 currentRecord，它将使用与 Access 在更新行时将使用的相同的自动编号

例子

```
rs.AddNew
currentRecord = rs("RecordNumber")

rsInfo = "SomeFormData" & currentRecord
rs.Update
rs.Close 
```

现在这用于 MS Access，但在 SQL Server 2005 中，我没有取回由新记录创建的标识。“SomeFormData”已正确插入，SQL 中的 RecordNumber 字段由新的自动编号填充，但我的变量中没有 RecordNumber，我需要它继续填写相关表单，将数据保存到相关表并需要保存当前记录编号。

**问题**：有没有办法在进行新插入时取回这个唯一编号？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-19T16:52:45.487

`IDENT_CURRENT('tableName')`（包括单引号）返回给定表的标识的当前值。该值应该是表中使用的最后分配的标识值。换句话说，除非该行已被删除，否则您将在表中拥有具有此标识值的行。将在下一次分配的标识值`INSERT`将是`IDENT_CURRENT('tableName') + IDENT_INCR('tableName')`。

不过，我不建议依赖这个。如果您以这种方式预先确定下一个标识值，那么您最终会遇到这样的情况，即另一个进程在您之前插入实际获取该 ID 的插入，因此您的进程最终使用了错误的 ID 值。

最好先进行插入（即使您还没有所有数据），并用于`SCOPE_IDENTITY()`获取分配的实际 ID。

你可能想知道为什么`SCOPE_IDENTITY()`比`IDENT_CURRENT('tableName')`. 顾名思义，前者将为您提供在当前范围内分配的最新身份值（您的批次、您的存储过程等），而后者将为您提供任何人在表上分配的最新身份。即使您可能会`IDENT_CURRENT`在 ' 之后立即调用`INSERT`，但仍有可能`INSERT`在两者之间出现其他人，并且会为您提供由*他们的*插入而不是您的插入`IDENT_CURRENT`产生的身份值，而总是给您您的。*`SCOPE_IDENTITY`*

 ***编辑**：

还值得一提的`SCOPE_IDENTITY()`是，它比功能相似的`@@IDENTITY`. 虽然两者都返回当前批次中分配的最新标识值，但`@@IDENTITY`受触发器中发生的插入影响；`SCOPE_IDENTITY()`不是。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T16:40:31.080

SELECT CAST（Scope_Identity（）作为 INT）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-26T04:21:22.297

我知道这个问题很老...但是您可以使用输出参数获取插入的记录 ID。

这是我有一个存储过程的例子

```
IF object_id('spOrganizationAdd') IS NOT NULL
    DROP PROCEDURE spOrganizationAdd;
GO

CREATE PROCEDURE dbo.spOrganizationAdd
    @OrganizationName VARCHAR(50),
    @ReturnIdentityValue INT OUTPUT
AS
BEGIN
    DECLARE @TempOrganizationIdentity TABLE (TempOrganizationID INT)

    INSERT INTO Organization (OrganizationName)
    OUTPUT INSERTED.OrganizationID INTO @TempOrganizationIdentity
    VALUES (@OrganizationName)

    SELECT @ReturnIdentityValue = (SElECT TempOrganizationID FROM @TempOrganizationIdentity)
END
GO 
```

这是调用它的 C# 代码示例...注意`ParameterDirection.Output`：

```
public static int AddOrganization(Organization oOrganization)
{
    int iRetVal = 0;

    using (SqlConnection conn = Connection.GetConnection())
    {
        using (SqlCommand cmd = new SqlCommand("spOrganizationAdd", conn))
        {
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.Parameters.AddWithValue("@OrganizationName", oOrganization.OrganizationName);
            cmd.Parameters.Add("@ReturnIdentityValue", SqlDbType.Int).Direction = ParameterDirection.Output;

            conn.Open();
            cmd.ExecuteNonQuery();
            iRetVal = Convert.ToInt32(cmd.Parameters["@ReturnIdentityValue"].Value);
        }
    }

    return iRetVal;
} 
```

类示例

```
public class Organization
{
    public Organization() { }
    public Organization(int organizationID) { OrganizationID = organizationID; }

    public int OrganizationID { get; set; }
    public string OrganizationName { get; set; }

    public string Display()
    {
        return OrganizationID.ToString() + " " + OrganizationName;
    }
} 
```

# visual-studio - 如何确保将移动应用程序部署到移动设备？

> ID：302516
> 
> 赞同：1
> 
> 时间：2008-11-19T16:35:32.807
> 
> 标签：visual-studio, windows-mobile, emulation

我们刚刚遇到了一个问题，即一切都正确编译，但在调试期间没有部署到移动设备上。当然，这会导致难以追踪的奇怪错误。解决方法很简单，只需删除移动设备上的目录即可。有没有办法确保/强制每次都部署文件？VS设置？我们的程序集上的版本不会改变吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-21T17:28:50.907

使用 VS2005 和非托管代码 (C++)，我注意到如果设备上已经有更高版本号的二进制文件，VS 不会部署新的二进制文件。如果它相同或更低，那么一切都很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T16:47:08.773

进入配置管理器，您会看到解决方案中的每个项目都有一系列“构建”和“部署”复选框。选中“部署”以获取您要确保部署的所有内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-23T16:18:21.233

在 Windows Mobile 开发人员的电动玩具中，有一个名为 CECopy 的实用程序。这允许您将文件从 PC 复制到移动设备。如果一切都失败了，请在 Pre-Build 事件中使用它来复制所需的文件。如果复制失败，您至少会收到通知。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T19:53:09.100

根据我的经验，ActiveSync 不是很一致。
此外，如果您首先将应用程序从设备中删除，则应用程序部署正确，这也可能不是配置问题。至少对于 VS2005，在这方面没有任何神奇的旋钮可以扭转。部署是否进行得非常快，还是看起来像是在实际部署？
我的建议是通过蓝牙尝试 ActiveSync。恕我直言，它比 USB 更稳定。（当然，除非你在模拟器上运行......）

# java - 在不创建新 Throwable 的情况下向 Throwable 添加信息的通用方法

> ID：302533
> 
> 赞同：2
> 
> 时间：2008-11-19T16:40:25.667
> 
> 标签：java, exception

在不创建新 Throwable 的情况下添加一种通用方式来向 Throwable 添加信息是否有益？

我经常看到这样的代码：

```
try {
    foo();
} catch (Exception e) {
    throw new Exception(e.getMessage() + " extra info=" + blah, e);
} 
```

改为添加`Throwable.setProperty(String key, String value)`以便上面的代码变为以下代码会更好吗？

```
try {
    foo();
} catch(Exception e) {
    e.setProperty("extra info", blah);
    throw e;
} 
```

额外的信息可以在消息和堆栈列表之间打印（每行一个）。

好处： 1\. 不需要创建新`Throwable`的 s 只是为了添加额外的信息。2\. 堆栈跟踪不会有多层原因跟踪（因此更容易阅读） 3\. 减少创建额外堆栈跟踪的成本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T16:48:06.527

链式异常已经负责删除冗余堆栈帧。也就是说，您只会看到一个给定的堆栈帧列出一次。这是一个见仁见智的问题，但我认为缺少链式异常是一个缺点。

令人沮丧的扩展`RuntimeException`将是好的。这可能在这方面有所帮助。

中间的堆栈帧可能希望在堆栈展开时添加它们自己的上下文。这可能导致财产损失。应该有一种机制来处理它，例如给定属性名称的一堆值。

这在核心 Java 中永远不会发生，但没有什么能阻止您将这个约定用于您自己的 Exception 类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T21:51:51.840

像往常一样，使用异常，它非常依赖于场景。尽管您应该尝试明确您要捕获的异常，但您还希望明确**说明当前范围内**异常的原因，而不是增加从另一个范围抛出的异常。如果您没有要添加的内容可以帮助调用者并且无法执行某些操作以响应特定异常，请让它传播。如果您的范围内有与调用者相关的信息，请使用您的信息抛出异常，并链接到捕获的异常。这里的关键是范围。始终从当前范围产生结果并允许其他范围做同样的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T16:47:52.157

一般来说，我认为在这种情况下使用标准成语会更好。在这种情况下，标准的习惯用法是包装异常，如下所示：

```
try {
  foo();
} catch (Exception e) {
  throw new MySpecificException("extra info=" + blah, e);
} 
```

此外，通常最好不要捕获通用异常。如果您想捕获并向 RuntimeException 添加信息，请执行此操作，并创建一个新的 RuntimeException。否则，请仔细考虑要捕获和抛出哪些已检查异常。

# c# - 如何获取实现给定接口的所有加载类型的所有实例？

> ID：302542
> 
> 赞同：20
> 
> 时间：2008-11-19T16:43:31.760
> 
> 标签：c#, reflection

我们需要获取实现给定接口的所有对象实例——我们能做到吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-19T16:55:09.287

如果您需要实现特定接口的所有类型的实例（样本），您可以遍历所有类型，检查接口并在找到匹配项时创建实例。

这是一些看起来非常像 C# 的伪代码，甚至可以编译并返回您需要的内容。如果不出意外，它将为您指明正确的方向：

```
public static IEnumerable<T> GetInstancesOfImplementingTypes<T>()
{
    AppDomain app = AppDomain.CurrentDomain;
    Assembly[] ass = app.GetAssemblies();
    Type[] types;
    Type targetType = typeof(T);

    foreach (Assembly a in ass)
    {
        types = a.GetTypes();
        foreach (Type t in types)
        {
            if (t.IsInterface) continue;
            if (t.IsAbstract) continue;
            foreach (Type iface in t.GetInterfaces())
            {
                if (!iface.Equals(targetType)) continue;
                yield return (T) Activator.CreateInstance(t);
                break;
            }
        }
    }
} 
```

现在，如果您正在谈论遍历堆并返回实现特定类型的所有对象的先前实例化实例，那么祝您好运，因为 .Net 运行时不存储此信息（可以由调试器/分析器通过检查堆来计算/stack 所以）。

根据您认为需要这样做的原因，可能有更好的方法来解决它。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-19T16:54:34.080

我不相信有办法......您必须能够遍历堆，并检查那里的每个对象，或者遍历应用程序进程空间中每个活动线程的堆栈，检查每个堆栈引用变量每个线程...

另一种方式，（我猜你不能这样做）是拦截所有对象创建活动（使用容器方法）并保留应用程序中所有对象的列表......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-19T16:56:41.703

对象的所有实例，还是所有类型？

获取对象的所有实例几乎是不可能的，并且会涉及有关通过管理内存进行扫描的非公开信息。

获取所有实现给定接口的类型是可行的——在给定域内。（即，您可以找到在实现特定接口的程序集中定义的所有类型）

*   加载程序集
*   遍历它的类型（调用 asm.GetTypes()）
*   检查 typeof(IMyInterface).IsAssignibleFrom(testType)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-02-06T00:23:23.970

如果实现指定接口的类是您的，那么您可以在实例化时实现弱引用列表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-07T14:07:16.373

```
IEnumerable<Type> GetAllTypesThatImplementInterface<T>()
{
    var @interface = typeof (T);
    return @interface.IsInterface
               ? AppDomain.CurrentDomain.GetAssemblies()
                     .SelectMany(assembly => assembly.GetTypes())
                     .Where(type => !type.IsInterface
                                 && !type.IsAbstract 
                                 && type.GetInterfaces().Contains(@interface))
               : new Type[] {};
} 
```

# java - 在客户端使用正确的程序打开 webdav 链接

> ID：302543
> 
> 赞同：4
> 
> 时间：2008-11-19T16:44:27.860
> 
> 标签：java, applet, webdav

我们有一个基于浏览器的应用程序，它集成了一个 webdav 服务器。我们在 (webdav) servlet 上生成特定文档的 URL。( `https://server.com/webdav/path/to/file.doc`)

我们正在寻找的是让我们的客户直接在适当的程序中打开这些链接的好方法。IE 对于 Windows 用户，" `https://server.com/webdav/path/to/excelfile.xls`" 应该在 MS Excel 中打开，而相同的链接应该在 Linux 上打开 OOCalc。

到目前为止，我们一直在使用一个小程序，它映射了扩展、操作系统和程序，并通过`Runtime.getRuntime().exec(..)`. 这种方法在 Ms-Windows 上工作得有些好，但在 Linux 和 mac 客户端上是有问题的，而且也很不灵活。

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-09-11T11:23:41.523

如果您将文件的 MIME 类型设置为正确的格式，则所有浏览器都应该能够处理它们。然后，用户可以决定对该类型采取默认操作（打开 acrobat、word、excel、记事本）或选择自定义操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-23T23:43:58.940

如今，它在 Internet Explorer 10/11 中运行良好。但是您必须添加一个注册表项才能允许 Office 以读/写方式打开从浏览器传递的文档。注册表项如下：

> 办公室 2013：
> 
> HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Common\Internet\OpenDocumentsReadWriteWhileBrowsing = 0x1 (DWORD)
> 
> 办公室 2010：
> 
> HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\Common\Internet\OpenDocumentsReadWriteWhileBrowsing = 0x1 (DWORD)

有关设置密钥的信息，请参阅本文：http: [//social.technet.microsoft.com/Forums/office/en-US/06fedd90-4889-45ca-949d-60b76d74dd15/ms-word-open-document-readonly-带有-WebDAV](http://social.technet.microsoft.com/Forums/office/en-US/06fedd90-4889-45ca-949d-60b76d74dd15/ms-word-open-document-readonly-with-WebDAV)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T19:13:49.383

这不是 java.awt.Desktop 类的设计目的吗？

我说“专为”是因为有很多事情它做得不好或不正确，但它确实适用于某些事情。它缺少“打开方式”选项，就像操作系统必须提示您打开文档时应该使用什么，如果没有注册它。

它可能会将 url 解释为 web url，打开浏览器，然后浏览器可能会委托打开文件？在这种情况下，您必须将文档下载到临时文件，然后使用 desktop.open？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T13:47:06.677

不幸的是，小程序是目前唯一的解决方案。但在极少数情况下，我们使用`"SharePoint.OpenDocuments"`和`'application/x-sharepoint'`插件。[您可以在此处](http://ajaxbrowser.com)与您的解决方案进行比较。

# php - 有没有办法在 Zend Framework 1.5 中执行“INSERT...ON DUPLICATE KEY UPDATE”？

> ID：302544
> 
> 赞同：47
> 
> 时间：2008-11-19T16:44:35.503
> 
> 标签：php, mysql, zend-framework, insert-update

我想`ON DUPLICATE KEY UPDATE`在 Zend Framework 1.5 中使用，这可能吗？

例子

```
INSERT INTO sometable (...)
VALUES (...)
ON DUPLICATE KEY UPDATE ... 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-11-19T17:46:42.163

我为 Zend 工作，并且专门为 Zend_Db 工作了很多。

`ON DUPLICATE KEY UPDATE`不，该语法不支持 API 。对于这种情况，您必须`query()`自己简单地使用并形成完整的 SQL 语句。

我不建议将值插入到 SQL 中，如 harvejs 所示。使用查询参数。

编辑：您可以避免使用`VALUES()`表达式重复参数。

```
$sql = "INSERT INTO sometable (id, col2, col3) VALUES (:id, :col2, :col3)
  ON DUPLICATE KEY UPDATE col2 = VALUES(col2), col3 = VALUES(col3)";

$values = array("id"=>1, "col2"=>327, "col3"=>"active"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-07-30T14:44:32.670

作为侧边栏，您可以通过以下方式简化`ON DUPLICATE KEY UPDATE`子句并减少脚本需要执行的处理量`VALUES()`：

```
$sql = 'INSERT INTO ... ON DUPLICATE KEY UPDATE id = VALUES(id), col2 = VALUES(col2), col3 = VALUES(col3)'; 
```

有关更多信息，请参阅[http://dev.mysql.com/doc/refman/5.1/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.1/en/insert-on-duplicate.html)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-28T07:10:34.867

@Bill Karwin：很好的解决方案！但是如果使用命名占位符（“：id”，“：col1”，...）而不是问题符号会更好。比您不需要通过 array_marge 复制值。此外，如果使用“INSERT”而不是“VALUES”的“SET”语法，代码会更简单地为任何字段集自动生成。

```
$sql = 'INSERT INTO sometable SET id = :id, col2 = :col2, col3 = :col3
    ON DUPLICATE KEY UPDATE id = :id, col2 = :col2, col3 = :col3'; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-09T11:49:44.763

```
$arrayData = array('column1' => value1, 'column2' => value2, ...)

class Model_Db_Abstract extends Zend_Db_Table_Abstract
{
    protected $_name;
    protected $_primaryKey;

    public function insertOrUpdate($arrayData)
    {
        $query = 'INSERT INTO `'. $this->_name.'` ('.implode(',',array_keys($arrayData)).') VALUES ('.implode(',',array_fill(1, count($arrayData), '?')).') ON DUPLICATE KEY UPDATE '.implode(' = ?,',array_keys($arrayData)).' = ?';
        return $this->getAdapter()->query($query,array_merge(array_values($arrayData),array_values($arrayData)));
    }

} 
```

**用法：**

例如。Model_Db_Contractors.php

```
class Model_Db_Contractors extends Model_Db_Abstract 
{

    protected $_name = 'contractors';
    protected $_primaryKey = 'contractor_id';

    ...
} 
```

索引控制器.php

```
class IndexController extends Zend_Controller_Action
{
 public function saveAction()
 {
  $contractorModel = new Model_Db_Contractors();
  $aPost = $this->getRequest()->getPost();

  /* some filtering, checking, etc */

  $contractorModel->insertOrUpdate($aPost);
 }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-07T19:27:58.107

改用这个：

```
REPLACE INTO sometable SET field ='value'..... 
```

如果存在则更新，如果不存在则插入。这是标准 mysql api 的一部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-27T16:25:15.223

更新 Pawel's Answer 以支持单独插入和更新数据，并且还支持 Zend Db 表达式

```
 class Model_Db_Abstract extends Zend_Db_Table_Abstract
    {
        protected $_name;
        protected $_primaryKey;

        public function insertOrUpdate($arrayData)
        {
            $insertDataValuesForQuery = [];
            $queryParams = [];
            foreach ($insertData as $key => $value) {
                if (gettype($value) == "object") {
                    array_push($insertDataValuesForQuery, $value->__toString());
                    continue;
                }
                array_push($insertDataValuesForQuery, "?");
                array_push($queryParams, $value);
            }

            $updateDataValuesForQuery = [];
            foreach ($updateData as $key => $value) {
                if (gettype($value) == "object") {
                    array_push($updateDataValuesForQuery, $key . " = " . $value->__toString());
                    continue;
                }
                array_push($updateDataValuesForQuery, $key . " = ?");
                array_push($queryParams, $value);
            }

            $query = 'INSERT INTO ' . $this->_name . ' (' . implode(',', array_keys($insertData)) . ') VALUES (' . implode(',', $insertDataValuesForQuery) . ') ON DUPLICATE KEY UPDATE ' . implode(' , ', $updateDataValuesForQuery);
            return $this->getAdapter()->query($query, $queryParams);
     }
} 
```

* * *

## 回答 #7

> 赞同：-7
> 
> 时间：2010-03-12T19:14:16.420

你可以简单地做这样的事情：

在您的 id 上设置唯一索引

进而

```
try {
   do insert here
} catch (Exception $e) {
   do update here
} 
```

# performance - 最坏的抽象反转

> ID：302548
> 
> 赞同：12
> 
> 时间：2008-11-19T16:45:26.623
> 
> 标签：performance, abstraction, anti-patterns

你今天在编程中看到的最糟糕的（由于流行或严重性）抽象反转的例子是什么？

对于那些不熟悉这个概念的人，抽象反转是在高级构造之上实现低级构造。更准确地说，假设您有构造 A 和 B。B 在 A 之上实现，但 A 没有在任何地方公开。因此，如果您真的需要较低级别的构造 A，那么您最终会在 B 之上实现 A，而 B 首先是根据 A 实现的。请参阅[http://en.wikipedia.org/wiki/Abstraction_inversion](http://en.wikipedia.org/wiki/Abstraction_inversion)。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-03-29T15:05:24.650

可能我见过的最糟糕的抽象滥用例子就是[这个流利的 C#](https://stackoverflow.com/questions/1916260/more-fluent-c-net)，它将基本的流控制元素（if、while、序列表达式）包装在一个流利的接口中。

所以你的完美地道，干净的代码：

```
var selectedTextBox = (TextBox)sender,
if (IsAdmin)
{
    selectedTextBox.Enabled = true;
    selectedTextBox.Text = superSecretPassword;
}
else
{ 
    selectedTextBox.Clear();
} 
```

变成这个烂摊子：

```
Cast<TextBox>(sender).
    WithIf(IsAdmin,
        With(selectedTextBox => selectedTextBox.Enabled = true).
        With(selectedTextBox => selectedTextBox.Text = superSecretPassword),
        With(selectedTextBox => selectedTextBox.Clear()); 
```

因为 lambda 让一切都变得更好！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T23:56:03.823

这似乎是一个相当死气沉沉的话题。我将回答我自己的问题只是为了开始一些讨论。我会说我见过的最糟糕的抽象反转是使用 OOP 风格的抽象类/接口来复制函数指针。例如：

```
interface foo {
    int bar();
}

class myClass1 implements foo {
    // No member variables.

    int bar() {
        // Implementation
    }

    // No other methods.
}

class myClass2 implements foo {
    // No member variables.

    int bar() {
        // Implementation
    }

    // No other methods.
} 
```

当您需要封装状态和行为时，类应该是一个强大的抽象。函数指针是相对简单的东西，仅用于包含行为。虚函数是使用函数指针数组实现的，但许多 OO 语言不公开函数指针或任何直接等效的东西。因此，您最终会使用接口和类来实现与函数指针等效的功能，而这些类和接口本身是根据函数指针来实现的。这会导致不必要的复杂性和性能下降。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T20:49:17.520

我不确定这是否回答了你的问题，但我已经看到了（我对此感到内疚）像 Lisp 这样的高级语言被用作 Fortran 甚至是汇编语言，因为这就是程序员所处的水平。

恕我直言，计算的讽刺之一是，无论一种语言有多高级，如果它是通用的，它就可以在最低级别使用。精致并不能保证精致。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-29T14:14:35.257

使用客户端过程集合库来处理 SQL 结果集。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-13T08:14:27.253

通过使用标志布尔变量来模拟结构编程中的 goto 怎么样？然而，结构化编程已被普遍接受。这不是表明抽象反转并不总是一件坏事吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-22T15:15:10.440

另一个答案或问题，如果你不介意的话。“抽象”这个词真的有定义吗？抽象实际上是好的、坏的还是中性的？我的意思是，我理解数字 2 是抽象的，因为它代表 2 只鞋子、2 只眼睛、2 个周期等的共同点。接口 IStack 可以是抽象的，因为它适用于像堆栈一样的东西。但是如果子程序 A 调用子程序 B 是否意味着它更抽象？为什么我们如此迷恋这个词？

EDT：我只是问，因为我看到人们对“具体”问题嗤之以鼻，认为森林比树木更重要。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-22T15:33:03.417

我不确定这是否真的符合条件，但它似乎相关。当 SQL Server 2005 推出 CLR 功能时，我听到一群开发人员说“好吧，现在我们可以直接从我们的存储过程中触发 Web 服务调用！” 我还看到了几个关于这样做的教程。这些是一些相互矛盾的抽象层次。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-29T14:53:01.667

> 你今天在编程中看到的最糟糕的（由于流行或严重性）抽象反转的例子是什么？

我不知道这是否重要，但是当我看到以它们的*实现*而不是*它们的用途*命名的类时，我通常会感到厌烦。它确实是一种匈牙利符号，请注意：

*   客户工厂
*   决策树访问者
*   抽象窗口装饰器
*   JsonDataAdapter
*   选项卡式DocumentImpl
*   具体列表处理程序

“Factory”、“Visitor”、“Decorator”、“Adapter”、“Impl”、“Concrete”——谁在乎它是如何实现的，它的用途是什么？

# ubuntu - Ubuntu 服务器 8.10 中用于 Apache 2.2.9 的 PHP4

> ID：302554
> 
> 赞同：2
> 
> 时间：2008-11-19T16:47:28.320
> 
> 标签：ubuntu, apache2, php4

我最近从基于 Windows 的开发环境转移到了 ubuntu 环境。我需要同时提供 PHP4 和 PHP5（PHP4 是公司的要求，所以我无法决定）。我的问题是我无法安装 PHP4，因为它不能作为一个包提供，而且似乎获得它的唯一方法是编译它。你能给我指出一个关于如何编译和安装 PHP4 的好资源或教程吗？我需要能够在两个版本之间轻松切换，一个 là WAMPSERVER（如果不可能，我将设置为 PHP4）。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T16:54:20.477

好吧，真正的问题是您的公司要求您运行 PHP4，这是一个 EOLd 产品。这意味着不再有安全修复。我会*非常*害怕部署类似的东西。

话虽如此，您可能可以通过将一个作为 CGI 并将另一个作为 apache 模块运行，或者同时作为 CGI 并将 CGI 支持映射到基于 IP 或 vhost 的不同版本来运行。[本文](http://blog.thembid.com/2007/06/21/how-to-run-php-4-and-5-in-ubuntu-without-cgi/)描述了在不同 IP 下运行 4 和 5 作为 apache 模块，但它适用于 Ubuntu 6.06.1 LTS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T16:51:58.500

php4 包似乎在 dapper 中可用。

您可以在需要安装 php4 时将 dapper 的 repos 添加到您的 sources.list :-) （这不是很干净，但它可能比其他东西更干净）。

（或者你可以按包设置源偏好，但我不知道怎么做，我只知道它存在于 Debian 中，所以它也应该存在于 Ubuntu 中）。

PS：对不起我的英语。

# c# - 调试任何入口点

> ID：302558
> 
> 赞同：0
> 
> 时间：2008-11-19T16:48:14.857
> 
> 标签：c#, asp.net, debugging

我正在使用派生自 System.Web.UI.Page 的 BasePageClass。

我想做的是以某种方式为每次访问此页面上的方法或属性设置一个断点。

我知道如何做到这一点的唯一方法是在页面上的每个属性和方法上设置一个断点。这似乎并不实用。

有谁知道是否有办法只说“每当执行此页面上的代码时，就中断它”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T20:42:08.770

`System.Diagnostics.Debugger.Break()`

“如果没有附加调试器，则询问用户是否要附加调试器。如果是，则启动调试器。如果附加了调试器，调试器会收到用户断点事件的信号，并且调试器会暂停进程的执行就像遇到了调试器断点一样。”

-- [http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.break.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.break.aspx)

看看这个，您可以将它与 BasePage 或其他一些优点结合使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T20:38:52.520

不完全确定这一点...

但我认为，当您在 Visual Studio 中使用条件断点时，您几乎可以设置断点来评估您可以在 .Net 中编写的任何表达式。也许尝试编写一些反射代码来检查是否已调用属性或方法，然后将断点条件设置为评估该代码。

# php - 查找嵌套 PHP 数组中的所有排列

> ID：302559
> 
> 赞同：0
> 
> 时间：2008-11-19T16:48:26.867
> 
> 标签：php, arrays, permutation

给定以下示例数组，我怎样才能找到所有可用时间的排列，以便满足 amountNeeded？换句话说，跟随数组应该产生以下内容：

> 使用资源 10 和 13 于 2008 年 5 月 14 日 08:00 至 08:10 可用
> 
> 使用资源 10 和 13 于 2008 年 5 月 14 日 08:10 至 08:20 可用

```
print("Array(

    [amountNeeded] => 2
    [resources] => Array
        (
            [0] => Array
                (
                    [resourceID] => 10
                    [blocks] => Array
                        (
                            [0] => Array
                                (
                                    [availDate] => 2008-05-14
                                    [startTime] => 08:00
                                    [endTime] => 08:10
                                )

                            [1] => Array
                                (
                                    [availDate] => 2008-05-14
                                    [startTime] => 08:10
                                    [endTime] => 08:20
                                )

                            [2] => Array
                                (
                                    [availDate] => 2008-05-14
                                    [startTime] => 08:20
                                    [endTime] => 08:30
                                )
                    ...
            [1] => Array
                (
                    [resourceID] => 13
                    [blocks] => Array
                        (
                            [0] => Array
                                (
                                    [availDate] => 2008-05-14
                                    [startTime] => 08:00
                                    [endTime] => 08:10
                                )

                            [1] => Array
                                (
                                    [availDate] => 2008-05-14
                                    [startTime] => 08:10
                                    [endTime] => 08:20
                                )

                            [2] => Array
                                (
                                    [availDate] => 2008-05-14
                                    [startTime] => 08:30
                                    [endTime] => 08:40
                                )
                    ...
"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-19T17:19:15.183

它被称为排列，用一个很好的词。查看[此博客文章](http://www.tagarga.com/blok/on/070816)，了解通用实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T03:14:54.590

您正在寻找的内容与排列无关。您正在考虑重叠的时间段，我看到了两种方法：

1.  将所有时间段预处理为时间线，然后查询时间线，或
2.  并行扫描所有资源块。

第一个选项占用更多内存但更容易理解；第二个可能不那么占用资源，但编程起来要复杂得多。两者都将受益于最小化要考虑的数据集，即限制目标时间段。

选项 #1 如下（在 OO PHP5 中实现）：

```
<?php

class Resource {
    protected $name;    // resource ID
    protected $start;   // start timestamp
    protected $finish;  // end timestamp
    // resource available while $start <= current time < $end

    function __construct($n, $sd, $st, $ed, $et) {
        $this->name = $n;
        $this->start = strtotime("$sd $st");
        $this->finish = strtotime("$ed $et");
    }

    function getID() { return $this->name; }
    function getStart() { return $this->start; }
    function getEnd() { return $this->finish; }
}

class Timeline {
    protected $times;       // ordered list of start-times;
    protected $resources;   // resources available in each timeslot
    protected $offs;        // iterator offset

    function __construct() {
        $this->times = array();
        $this->resources = array();
        $this->offs = 0;
    }

    // binary search, insert if not found, return index
    private function time_ins($time) {
        // array is empty?
        if (count($this->times) == 0) {
            $this->times[0]= $time;
            $this->resources[0] = array();
            return 0;
        }

        $min = $lo = 0;
        $max = $hi = count($this->times)-1;
        // binary search
        while($lo <= $hi) {
            $mid = ($lo+$hi) >> 1;

            if ($this->times[$mid] == $time) {
                // already exists - return index
                return $mid;
            }
            elseif ($this->times[$mid] < $time) {
                // if value exists, is in upper half of array
                $lo = $mid+1;

                if ($lo > $max || $this->times[$lo] > $time) {
                    // $lo points to first value greater than $time
                    // insert new value at $lo
                    array_splice($this->times, $lo, 0, $time);
                    $t = isset($this->resources[$lo-1]) ? $this->resources[$lo-1] : array();
                    array_splice($this->resources, $lo, 0, $t);
                    return $lo;
                }
            }
            else {
                // if value exists, is in lower half of array
                $hi = $mid-1;

                if ($hi < $min || $this->times[$hi] < $time) {
                    // $hi points to first value less than $time
                    // insert new value at $hi+1
                    array_splice($this->times, $hi+1, 0, $time);
                    $t = isset($this->resources[$hi+1]) ? $this->resources[$hi+1] : array();
                    array_splice($this->resources, $hi+1, 0, $t);
                    return $hi+1;
                }
            }
        }
    }

    function Add( $start, $end, $id ) {
        $s = $this->time_ins($start);
        $e = $this->time_ins($end);

        for($i = $s; $i < $e; ++$i)
            $this->resources[$i][]= $id;
    }

    function reset()    { $offs = 0; }
    function isValid()  { return ($this->offs+1 < count($this->times)); }   // omit last time (is end-time only)
    function next()     { $this->offs++; }
    function resCount() { return count( $this->resources[ $this->offs ] ); }
    function getStart() { return $this->times[$this->offs]; }
    function getEnd()   { return $this->times[$this->offs + 1]; }
    function getRes()   { return $this->resources[$this->offs]; }
}

$res = array();
$res[]= new Resource('10', '2008-05-14', '08:00', '2008-05-14', '08:10');
$res[]= new Resource('10', '2008-05-14', '08:10', '2008-05-14', '08:20');
$res[]= new Resource('10', '2008-05-14', '08:20', '2008-05-14', '08:30');
$res[]= new Resource('13', '2008-05-14', '08:00', '2008-05-14', '08:10');
$res[]= new Resource('13', '2008-05-14', '08:10', '2008-05-14', '08:20');
$res[]= new Resource('13', '2008-05-14', '08:30', '2008-05-14', '08:40');

$tl = new Timeline();
foreach($res as $R)
    $tl->Add( $R->getStart(), $R->getEnd(), $R->getID() );

$needed = 2;
$_pre = "\n<p>";
$_post = "</p>";
for( $tl->reset(); $tl->isValid(); $tl->next() ) {
    $cnt = $tl->resCount();

    if ($cnt >= $needed) {
        $st = date("Y-m-d H:i", $tl->getStart());
        $fn = date("Y-m-d H:i", $tl->getEnd());
        $res = join(', ', $tl->getRes());

        echo ($cnt == $needed
            ? "{$_pre}Available from $st to $fn using resources ($res){$_post}"
            : "{$_pre}Available from $st to $fn using any $needed of resources ($res){$_post}"
        );
    }
}

?> 
```

# installation - 使用 WixUI_Minimal 的 Wix 自定义操作

> ID：302560
> 
> 赞同：2
> 
> 时间：2008-11-19T16:48:30.957
> 
> 标签：installation, wix, windows-installer, custom-action

因此，我尝试在应用程序完成安装后（尽管实际上，运行辅助应用程序并不重要，因为它在安装过程中不会与已安装的文件交互），运行另一个程序与应用程序捆绑在一起。相关代码（用“...”替换各种内容：

```
<directory ...>
  <component ...>
  <File Id="IDINST" ... />
  </component>
</directory>
...
<CustomAction Id="IDACTION" FileKey="IDINST" ExeCommand="..." Return="ignore" />
...
<InstallExecuteSequence>
  <Custom Action="IDACTION" After="CostFinalize" />
</InstallExecuteSequence> 
```

我检查了目录，文件在我预期的位置，但在安装过程后没有执行。事实上，我什至不想安装该文件，只需运行然后删除即可。但我暂时忽略它。无论如何，我已经看到了几个在对话后触发动作的例子，但由于我目前正在使用`<UIRef Id="WixUI_Minimal" />`，我认为这并不理想。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T18:50:44.483

CostFinalize 发生在 InstallFiles 延迟操作运行（实际放置文件）之前很久。因此，CustomAction 静默失败（因为文件不可用）（因为 Return 被忽略）

您需要至少在 InstallFiles 之后安排您的 CustomAction 并延迟，或者如果 CustomAction 不能延迟运行，那么它必须在 InstallFinalize 之后（当然，它不会在 InstallFinalize 之后导致回滚）。

# javascript - Javascript Hashmap键编译成正则表达式

> ID：302569
> 
> 赞同：2
> 
> 时间：2008-11-19T16:51:34.273
> 
> 标签：javascript, regex

monthRegex 正则表达式始终返回 true，即使 dateInput 在我看来类似于“2008 年 12 月 1 日”，它也应该通过我传递给它的任何键来匹配正则表达式。但这不是发生的事情，它只是返回 true，并将“JAN”检测为月份。

```
 function dateFormat(dateInput) {

    var formattedDate = "";

    var the_date, month, year;

    var monthHash = new Array();
    monthHash['JAN']="01";
    monthHash['FEB']="02";
    monthHash['MAR']="03";
    monthHash['APR']="04";
    monthHash['MAY']="05";
    monthHash['JUN']="06";
    monthHash['JUL']="07";
    monthHash['AUG']="08";
    monthHash['SEP']="09";
    monthHash['OCT']="10";
    monthHash['NOV']="11";
    monthHash['DEC']="12";

    // Find which month we are dealing with
    var whichKey = null;

    for(var key in monthHash) {

        var monthRegex = new RegExp(key, "i")
        monthRegex.compile();

        console.log("monthRegex.compile: " + monthRegex.test(dateInput));

        if(monthRegex.test(dateInput))
        {
            whichKey = key;
            break;
        }
    }
} 
```

谢谢你，
  安德鲁·J·李尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T17:38:41.540

第一点：不要使用 Array 作为关联数组！请改用对象。或者以相反的方式使用数组。

第二点：你为什么使用正则表达式进行如此简单的搜索？改用 indexOf ：

```
function dateFormat(dateInput) 
{
  var formattedDate = "";

  var the_date, month, year;

  var months = new Array("", 
      "jan", "feb", "mar", 
      "apr", "may", "jun", 
      "jul", "aug", "sep", 
      "oct", "nov", "dec"
  );

  // Find which month we are dealing with
  for (var i = 1; i < months.length; i++) 
  {
    if (dateInput.toLowerCase().indexOf(months[i]) > -1)
    {
      var whichMonth = months[i];
      break;
    }
  }
  if (whichMonth != undefined)
    alert("Found: "  + whichMonth);
}
dateFormat("10 Jun 2008"); 
```

如果你真的想使用正则表达式来保持话题，这里有另一种方式：

```
function dateFormat(dateInput) 
{
  var formattedDate = "";

  var the_date, month, year;

  var months = /(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i;

  // Find which month we are dealing with
  var matches = dateInput.match(months);
  if (matches != null)
    alert("Found: "  + matches[1]);
}
dateFormat("December, 10 2008"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T17:44:30.437

删除“monthRegex.compile();” 线，它的工作原理。

This is because monthRegex.compile(); complies "" as a regex and therefore everything matches it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T18:06:02.327

You don't need to use regular expressions for plain old string matching. You especially don't need to compile and throw away 12 regular expressions every time the function is called.

A saner version:

```
// Get integer number of named month. 1-indexed for January;
// return 0 if unreadable name.
//
function readMonth(s) {
    var begin= s.toLowerCase().substring(0, 3);
    var ix= MONTHS.indexOf(begin);
    if (ix==-1) return 0;
    return ix/4+1;
}
var MONTHS= 'jan feb mar apr may jun jul aug sep oct nov dec'; 
```

# rss - 如何检测提要阅读器访问我的页面？

> ID：302572
> 
> 赞同：0
> 
> 时间：2008-11-19T16:52:22.680
> 
> 标签：rss, web-applications, feed, user-agent

我想根据用户是浏览器还是 RSS 阅读器（因此避免使用 example.com/feed URL）从单个 URL 提供不同的内容。因此，www.example.com/posts 将向浏览器返回 (X)HTML 页面，向提要阅读器返回 RSS 提要。

实现这一点的架构上最合适的方式是什么？

PS 垒球问题怎么样... :)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T16:58:28.970

我不确定在所有情况下都有可能。考虑一个使用 Safari 的 RSS 阅读器的用户，假设它在下载 RSS 提要时使用相同的浏览器标识符字符串，您如何区分这两种模式？

我真的会重新考虑这种方法，单独的提要 URL 没有任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T16:54:13.363

让我向您介绍一下 User-Agent [HTTP 标头](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)。它将包含一个用于访问您页面的客户端的标识字符串。它可以被伪造，但您不能 100% 确定它是 RSS 阅读器还是浏览器。

此外，RSS 阅读器可能会发送 RSS 内容类型的 Accept 标头，您可以使用它来实现[内容协商](http://en.wikipedia.org/wiki/Content_negotiation)（ Apache 中的[MultiViews](http://httpd.apache.org/docs/2.0/content-negotiation.html)）。

但是由于没有确定的方法，您最好在提供 HTML 方面比 RSS 更频繁地失败，或者更好的是，像其他人一样为 RSS 提供不同的提要。

# .net - 如何使用 typeof 或 GetType() 作为 Generic 的模板？

> ID：302577
> 
> 赞同：31
> 
> 时间：2008-11-19T16:53:36.687
> 
> 标签：.net, generics

如果用文字很难解释，让我们看一个例子，我有一个这样的通用函数

```
void FunctionA<T>() where T : Form, new()
{
} 
```

如果我有反射类型，如何将其与上述功能一起使用？我期待着这样做

```
Type a = Type.GetType("System.Windows.Forms.Form");
FunctionA<a>(); 
```

当然，上述方法不起作用。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2010-09-18T16:38:50.940

```
class Program
{
    static void Main(string[] args)
    {
        int s = 38;

        var t = typeof(Foo);
        var m = t.GetMethod("Bar");
        var g = m.MakeGenericMethod(s.GetType());
        var foo = new Foo();
        g.Invoke(foo, null);
        Console.ReadLine();
    }
}

public class Foo
{
    public void Bar<T>()
    {
        Console.WriteLine(typeof(T).ToString());
    }
} 
```

它可以动态工作，并且 s 可以是任何类型

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-19T16:58:14.803

~~你不能。.NET 中的泛型必须在编译时解析。您正在尝试做一些可以在运行时解决它们的事情。~~

~~您唯一能做的就是为 FunctionA 提供一个采用类型对象的重载。~~

* * *

嗯……评论者是对的。

```
class Program
{
    static void Main(string[] args)
    {
        var t = typeof(Foo);
        var m = t.GetMethod("Bar");
        var hurr = m.MakeGenericMethod(typeof(string));
        var foo = new Foo();
        hurr.Invoke(foo, new string[]{"lol"});
        Console.ReadLine();
    }
}

public class Foo
{
    public void Bar<T>(T instance)
    {
        Console.WriteLine("called " + instance);
    }
} 
```

[生成通用方法](http://msdn.microsoft.com/en-us/library/system.reflection.methodinfo.makegenericmethod.aspx)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-30T16:32:11.190

晚了几年，来自 msdn 博客，但这可能会有所帮助：

```
Type t = typeof(Customer);  
IList list = (IList)Activator.CreateInstance((typeof(List<>).MakeGenericType(t)));  
Console.WriteLine(list.GetType().FullName); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-15T15:01:50.807

我以不同的方式解决了这个问题。我有一个列表类，它封装了（真正的）Dapper 功能。它继承自一个基类，该基类是用于模拟的虚拟类。基类中的每个方法都被真实类覆盖。然后我不需要做任何特别的事情。如果将来我想对自己`SQLite`开发的内存数据库做一些特别的事情，如果我愿意，我可以随时将其添加到基类中。

# linux - 以编程方式登录论坛，然后截屏

> ID：302578
> 
> 赞同：0
> 
> 时间：2008-11-19T16:53:39.417
> 
> 标签：linux, scripting, curl, wget, community-server

我想登录到社区服务器的论坛部分（例如[http://forums.timesnapper.com/login.aspx?ReturnUrl=/forums/default.aspx](http://forums.timesnapper.com/login.aspx?ReturnUrl=/forums/default.aspx)），然后下载特定页面并执行正则表达式（查看是否有任何帖子等待审核）。如果有，我想发一封电子邮件。

我想从 Linux 服务器执行此操作。

目前我知道如何下载一个页面（例如使用 wget），但在登录时遇到问题。有什么好主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T17:01:17.107

您可能对 Selenium 有更好的运气或查看此问题以获得更多建议：

[大学班级注册脚本](https://stackoverflow.com/questions/300788/script-for-college-class-registration)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T17:01:34.157

查看登录页面的来源，它似乎是一个 asp.net 应用程序，因此您可能需要做几件事来实现这一点 -

管理表单隐藏的 __viewstate 字段，并在您提交登录详细信息时将其发回。

一旦你过去了，我猜你可以只使用绝对 URL 来引用有问题的特定页面，但你需要处理 ASP.NET Forms 身份验证 cookie 并将其作为 GET 请求的一部分发送。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-28T19:38:32.933

就个人而言，我会用 Perl 编写它，使用[WWW::Mechanize](http://search.cpan.org/dist/WWW-Mechanize)，并执行以下操作：

```
 my $login_url = 'login url here';
my $username = 'username';
my $password = 'password';
my $mech = new WWW::Mechanize;
$mech->get($login_url)
    or die "Failed to fetch login page";
$mech->set_visible($username, $password)
    or die "Failed to find fields to complete";
$mech->submit
    or die "Failed to submit form";

if ($mech->content() =~ /posts awaiting moderation/i) {
    # Do something here
} 
```

我不知道上述方法是否可行，因为我没有社区服务器（无论是什么）的登录详细信息来测试它，但它应该为您提供一些您可以轻松工作的东西，并显示出强大的功能万维网::机械化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-11T06:22:47.947

您可以使用 wget 完成所有操作。您需要使用 POST 提交表单并需要存储 cookie。wget 手册页中的相关内容：

```
--post-data=string
--post-file=file

Use POST as the method for all HTTP requests and send the specified data in the request body.
"--post-data" sends string as data, whereas "--post-file" sends the contents of file.  Other than
that, they work in exactly the same way.

This example shows how to log to a server using POST and then proceed to download the desired pages,
presumably only accessible to authorized users:

       # Log in to the server.  This can be done only once.
       wget --save-cookies cookies.txt \
            --post-data 'user=foo&password=bar' \
            http://server.com/auth.php

       # Now grab the page or pages we care about.
       wget --load-cookies cookies.txt \
            -p http://server.com/interesting/article.php 
```

# dojo - 在哪里可以找到 Dojo XMLNS DTD？

> ID：302580
> 
> 赞同：0
> 
> 时间：2008-11-19T16:53:54.673
> 
> 标签：dojo, xhtml, xml-namespaces

我想在我的 XHTML 页面中添加一些 Dojo 小部件，但是 Dojo 使用了一些不属于 XHTML 规范的属性。例如：

```
<input dojoType="ComboBox" type="text" dataUrl="/some_data.json" /> 
```

和属性会导致验证问题`dojoType`。`dataUrl`我相信 Dojo 让我`dojoType`进入了`class`属性：

```
<input class="dojo-ComboBox" type="text" dataUrl="/some_data.json" /> 
```

这解决了部分问题，但不是全部。“正确”的解决方案如下所示：

```
<input dojo:type="ComboBox" type="text" dojo:dataUrl="/some_data.json" /> 
```

但这需要在我的 HTML 文件顶部添加一个 Dojo XMLNS 声明，这意味着我需要找到一份 Dojo XMLNS DTD 的副本。我怀疑我需要将它复制到我的服务器并在那里托管，因为我已经扩展了 Dojo 工具包。Dojo 甚至会采用范围版本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T20:32:03.577

我不相信替换自定义 DTD 会使您的页面得到验证。无论 DTD 是什么，它们仍然不是有效的 XHTML。如果验证真的很重要，您可以尝试使用 Dojo JavaScript 库来写出所有小部件：http: [//www.dojoforum.com/node/1182](http://www.dojoforum.com/node/1182) HTH

# multithreading - 如何在 Delphi 中实现线程安全的列表包装器？

> ID：302583
> 
> 赞同：6
> 
> 时间：2008-11-19T16:54:12.643
> 
> 标签：multithreading, delphi, semaphore, critical-section

我有一个列表包装器，它维护两个 Tstringlists 和一个 TClassList

我需要这是线程安全的，例如：

*   不允许并发写入（应进入某种等待状态）
*   不允许边读边写（反之亦然）（应进入某种等待状态）
*   允许*并发*读取

关于如何做到这一点的任何想法？我的直觉告诉我它需要的不仅仅是一个关键部分，也许是一个信号量或“使用计数器”，也许其中之一与 CS*结合使用。*

我只是不太确定从哪里开始-从英语的整体方法到伪代码，再到 delphi 实现或外部链接，将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-19T17:01:46.607

你应该看看在 sysutils.pas 中声明的 TMultiReadExclusiveWriteSynchronizer 类...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-19T17:04:19.347

看看这个教程。 [线程化德尔福方式](http://www.eonclash.com/Tutorials/Multithreading/MartinHarvey1.1/ToC.html)

看第 11 章，但都是好东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-01T03:01:22.403

你真的应该看看 TThreadList。

.Add、.Remove、.Clear 方法会自动为您锁定列表。如果需要，您还可以根据需要锁定/解锁：

```
x.LockList; 
try 
  //do whatever
finally  
  x.Unlocklist; 
end; 
```

TMultiReadExclusiveWriteSynchronizer 是一个伟大的想法，但我不知道他们是否已经解决了所有的错误。它总是在负载下出现问题。

# background-process - BITS 还是不错的后台更新技术吗？

> ID：302591
> 
> 赞同：4
> 
> 时间：2008-11-19T16:55:32.657
> 
> 标签：background-process, microsoft-bits

我的一个爱好应用程序使用 SQLite 后端来存储应用程序数据。该应用程序已设置，以便用户可以单击典型的“检查更新”按钮，该按钮将查询 Web 服务以查看是否有可用更新。如果是，用户单击“更新”按钮并下载新数据库（通过 HTTP），然后将其安装在应用程序中。这个过程目前是“模态的”，因为在下载和安装完成之前，用户不能在应用程序中做任何其他事情。

我正在更新应用程序，我想做的一件事是让这个更新过程发生在幕后，比如 Windows 更新。当应用程序启动时，将查询服务，如果有可用更新，它会自动下载，但在后台，以便用户可以继续工作。下载完成后，系统会提示用户安装更新。

我对[BITS](http://msdn.microsoft.com/en-us/library/bb968799(VS.85).aspx)进行了广泛的研究，尽管迄今为止我还没有看到任何 API 可以利用该技术，但我已经看到了一些示例代码，并且相信我可以让它工作。

但这是为数据库进行“背景更新”的最佳方法，还是有其他一些解决方案/方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-19T19:03:44.350

如果您只在 MS Windows 上运行，并且您的客户正在使用足够新的操作系统版本来支持 BITS，那么我认为您当然应该利用平台中已经内置的功能，而不是像其他人一样做和编写您自己的后台更新检查器，它位于我的任务栏通知区域并不必要地使用系统资源。

关于BITS的信息：

[关于比特](http://msdn.microsoft.com/en-us/library/aa362708(VS.85).aspx)

[BITS 参考](http://msdn.microsoft.com/en-us/library/aa362820%28VS.85%29.aspx)

[后台智能传输服务，来自维基百科](http://en.wikipedia.org/wiki/Background_Intelligent_Transfer_Service)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-01-08T23:42:40.527

我是 Windows 中 BITS 团队的 PM —— 是的，当您需要以对用户友好的方式下载（或上传）数据时，BITS 技术非常适合很多时候。BITS 会尽量小心占用网络带宽、当前电源状态和网络成本，并且会在失败时自动重试下载。我们还在 GitHub 上为使​​用 C# 和 .NET 编程的每个人创建了一个新的示例[BITS Manager](https://github.com/Microsoft/BITS-Manager)程序！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T12:07:59.637

这真的感觉你应该考虑同步框架[http://msdn.microsoft.com/en-us/sync/bb736753.aspx](http://msdn.microsoft.com/en-us/sync/bb736753.aspx)而不是 BITS。

# reporting-services - 如何在VBScript中计算每月的最后一个工作日

> ID：302597
> 
> 赞同：4
> 
> 时间：2008-11-19T16:57:35.210
> 
> 标签：reporting-services, vbscript

如何在 VBScript 中计算每月的最后一个工作日？它用于 Reporting Services 报告。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-19T17:15:05.630

怎么样：

```
intMonth=11
'Use zero to return last day of previous month '
LastDayOfMonth= dateserial(2008,intMonth+1,0)

'Saturday '
If WeekDay(LastDayOfMonth,1)=7 Then LastDayOfMonth=LastDayOfMonth-1
'Sunday '
If WeekDay(LastDayOfMonth,1)=1 Then LastDayOfMonth=LastDayOfMonth-2

Msgbox LastDayOfMonth & "  " & Weekdayname(Weekday(LastDayOfMonth,1),1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T17:13:05.820

这里有一篇很好的 CodeProject 文章：[**Working With Business Dates (Business Holidays/Weekends, etc)**](http://www.codeproject.com/KB/asp/BusinessDates.aspx)。

> 该项目旨在减轻确定有效营业日期的麻烦。它包括我创建的一些函数，用于确定日期是假期还是周末，以及检索下一个工作日还是最后一个工作日。还有一个功能可以查找给定月份的最后一天。

```
Function LastBusinessDay(sDate)

   Dim iDay, iDaysToAdd, iDate

   iDaysToAdd = 0
   iDate = sDate

   x = 1

   Do while iDaysToAdd >= 0

      If Weekday(iDate) = 1 or Weekday(iDate) = 7 or _
                isHoliday(iDate) <> 0 then
         iDay = Weekday(iDate)
         Select Case cint(iDay)
            Case 1  'Sunday

               iDate = DateAdd("d", -1, iDate)

            Case 7  'Saturday

               iDate = DateAdd("d", -1, iDate)

            Case else    'this is a valid day

                if isHoliday(iDate) > 0 then
                    iDate = dateadd("d", -(isHoliday(iDate)), iDate)
                else
                    iDaysToAdd = iDaysToAdd - 1
                end if

         End Select
      end if
   Loop

   LastBusinessDay = iDate
End Function 
```

PS：你会在文章中找到功能`LastDayOfMonth`和`isHoliday`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T18:08:59.557

对于希望获得上个月最后一个工作日的任何人，这是一个解决方案。

```
Dim lastbusinessdayofprevmonth

Sub GetLastDay()

Dim curdate
curdate = Date()    

Dim firstdayofcurmonth 
firstdayofcurmonth = Month(curdate) & "/1/" & Year(curdate)

Dim lastdayofprevmonth
lastdayofprevmonth = DateAdd("d", -1, firstdayofcurmonth)

Dim day
day = weekday(lastdayofprevmonth)

if(day = 1) then
    lastbusinessdayofprevmonth = DateAdd("d", -2, lastdayofprevmonth)
elseif (day = 7) then
    lastbusinessdayofprevmonth = DateAdd("d", -1, lastdayofprevmonth)
else
    lastbusinessdayofprevmonth = lastdayofprevmonth
end if

end sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T17:12:10.067

如果您指的是该月的最后**一周**（MF），请尝试：

```
Dim d

d = DateAdd("m", 1, Now)

d = Month(d) & "/1/" & Year(d)
d = DateAdd("d", -1, d)

If Weekday(d) = 7 Then
    d = DateAdd("d", -1, d)
ElseIf Weekday(d) = 1 Then
    d = DateAdd("d", -2, d)
End If

MsgBox d 
```

# java - 如何使 Swing/JFace/SWT GUI 可寻址？

> ID：302606
> 
> 赞同：5
> 
> 时间：2008-11-19T16:59:46.003
> 
> 标签：java, user-interface, design-patterns, swing

我有一个“胖”的 GUI，它变得相当复杂，我想添加从一个地方到另一个地方的链接，并添加后退/前进按钮以简化导航。在我看来，如果我的应用程序是可寻址的，这会更容易：每个组合都可以有它的 URI，并且链接将使用该 URI。

有适用于这个问题的设计模式吗？

我可以只看 Firefox 或 Eclipse 的源代码，但这些都是巨大的项目，需要大量时间才能理解它，所以我在这里问。有没有更简单的例子？

当然，如果我首先构建一个 Web 应用程序会更简单，但我不会很快从头开始重写这个巨大的应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T17:08:28.777

我做这样的事情的解决方案通常涉及[侦听器模式](http://en.wikipedia.org/wiki/Observer_pattern)。简而言之，您可以通过提供一种向相关方（在本例中为组合）发送和接收事件的方法来减少耦合。这很容易实现，即使在改装时也是如此。这样，您的事件和聚会可以在不更改依赖代码的情况下进行更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T17:16:57.607

您可以构建一个“全局”注册表，将唯一 ID 映射到对象（或者可能是类名）。例如，这些对象可以是 JPanel。当用户点击一个链接或按钮时，一些 Controller 会收到要显示的新页面的键的通知。该控制器可以创建该 JPanel 并将其放置在应用程序的框架中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-22T13:52:21.980

我的最后一种方法包括全局管理器和链接注册。UI 的每个部分都可以为自己命名并进行注册。全局经理了解每个人，然后使用一些肮脏的工作使这部分可见。后退/前进导航由特殊的撤消/重做管理器进行。每个“显示”都能够获取导航管理器并注册其“撤消”事件。让它工作起来很辛苦，但最终的功能非常有用。我们讨论了使用一些简单的 JNDI 服务来定位和命名 UI 部件。它在链接中也可能有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T17:45:20.293

在 Swing 中，您可以使用[CardLayout](http://java.sun.com/javase/6/docs/api/java/awt/CardLayout.html)。您可以让每个“页面”成为一张卡片，卡片的名称（在向布局中添加卡片时选择）将等同于您想要的 URI。

例子：

```
String PAGE_1_KEY = "page 1";
String PAGE_2_KEY = "page 2";
// as many keys as you need

JFrame frame = ...;
frame.setLayout(new CardLayout());
frame.add(createPage1(), PAGE_1_KEY);
frame.add(createPage2(), PAGE_2_KEY);
// etc. 
```

然后在按钮的动作监听器中，你会调用

```
((CardLayout)frame.getLayout()).show(frame, PAGE_1_KEY); // or whichever 
```

# sql-server - ReportViewer 的 Reporting Services 交互式排序和分页问题

> ID：302608
> 
> 赞同：1
> 
> 时间：2008-11-19T17:00:25.253
> 
> 标签：sql-server, reporting-services, reporting, report

我在 ReportViewer 中的交互式排序和分页遇到了一个奇怪的问题，我无法弄清楚。我在 aspx 页面中使用本地报表定义和 ReportViewer 控件。我将 AsynchRendering 设置为 true。除了这个问题，一切似乎都很好。以下是重现问题的步骤：

```
（各种前的第1页）
COL1 | COL2
  一个 1
  3
  b 2

```

1) 在第 1 页上，按 COL1 升序排序 - 排序是正确的

```
（第 1 页）
COL1 | COL2
  一个 1
  b 2
  3

```

2) 导航到第 2 页 - 排序正确

```
（第2页）
COL1 | COL2
  d 4
  5
  f 6

```

3）按X列降序排序（这样做后它会自动返回到第1页） - 排序是正确的

```
（第 1 页）
COL1 | COL2
  26
  是 25
  w 24

```

4) 再次导航到第 2 页 - 排序不正确；数据仍然按升序排序，就好像第 2 页上的排序点击从未发生过一样

```
（第2页）
COL1 | COL2
  d 4
  5
  f 6

```

其他奇怪的事情：

*   如果我从第 1 页导航到除第 2 页之外的任何其他页面，则排序顺序是正确的，如果我从除第 1 页之外的任何其他页面导航到第 2 页，则排序顺序是正确的。
*   如果我将 AsyncRendering 设置为 false，我根本没有这个问题。我需要将 AsyncRendering 设置为 true。
*   这个问题只发生在 IE6 和 IE7 中。我不会发生在 Firefox 或 Chrome 中。
*   这是最奇怪的一个=> 这个问题只发生在我部署到 Web 服务器之后。如果我在我的计算机上从 Visual Studio 2008 开发服务器运行它，那么一切正常，无一例外。

这是一个问题，因为我工作的公司几乎只使用 IE6/IE7，这种排序功能是必需的，如果我不使用 AsyncRendering，页面就会太慢。

对此的任何帮助将不胜感激。

（在我有足够的声誉能够发表评论之前，我做出的回答的评论）：关于这件事我注意到了其他一些事情。使用提琴手，我观察了每次排序点击和导航点击的http请求/响应，我注意到从第1页导航到第2页时没有http GET请求。所有其他导航点击和排序点击发出GET请求，然后html 会使用相应的响应进行刷新。如果在发生另一次排序后从第 1 页导航到第 2 页时没有 GET 请求，则页面不会刷新到当前排序顺序。这对我来说似乎是一个 ReportViewer AJAX 错误......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T13:31:40.557

我在使用 AsyncRendering 时遇到了问题，我的问题与你的完全不同，但也许这个链接可能会对你有所帮助。

尝试使用本文中提出的建议，从解决我的问题的页面中删除 xhtml doctype。

[ [http://msdn.microsoft.com/en-us/library/ms252090(VS.80).aspx][1]](http://msdn.microsoft.com/en-us/library/ms252090(VS.80).aspx][1])

[1]: [http://](http://the)来自页面的 xhtml doctype

# windows - 在批处理文件中，如何判断进程是否正在运行？

> ID：302609
> 
> 赞同：8
> 
> 时间：2008-11-19T17:00:57.687
> 
> 标签：windows, batch-file, process

我想编写一个批处理文件来检查进程是否正在运行，如果是，则执行一个操作，如果不是，则执行另一个操作。

我知道我可以使用 tasklist 列出所有正在运行的进程，但是有没有更简单的方法可以直接检查特定进程？

看起来这应该有效，但它没有：

```
tasklist /fi "imagename eq firefox.exe" /hn | MyTask
IF %MyTask%=="" GOTO DO_NOTHING
'do something here
:DO_NOTHING 
```

**使用 atzz 提供的解决方案，这是一个完整的工作演示：**

**编辑：简化，并修改为在 WinXP 和 Vista 下工作**

```
echo off

set process_1="firefox.exe"
set process_2="iexplore.exe"
set ignore_result=INFO:

for /f "usebackq" %%A in (`tasklist /nh /fi "imagename eq %process_1%"`) do if not %%A==%ignore_result% Exit
for /f "usebackq" %%B in (`tasklist /nh /fi "imagename eq %process_2%"`) do if not %%B==%ignore_result% Exit

start "C:\Program Files\Internet Explorer\iexplore.exe" www.google.com 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T17:26:08.040

您可以使用“for /f”构造来分析程序输出。

```
set running=0
for /f "usebackq" %%T in (`tasklist /nh /fi "imagename eq firefox.exe"`) do set running=1 
```

此外，坚持一个好主意

```
setlocal EnableExtensions 
```

在脚本的开头，以防用户默认禁用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T17:05:10.483

一些选项：

*   来自微软的 PsList

[http://www.windowsdevcenter.com/pub/a/oreilly/windows/news/win2kcommands_0401.html#ps](http://www.windowsdevcenter.com/pub/a/oreilly/windows/news/win2kcommands_0401.html#ps)

*   Cygwin（用于 ps）
*   资源工具包（用于 ps.vbs）

[http://www.windowsdevcenter.com/pub/a/oreilly/windows/news/win2kcommands_0401.html#ps](http://www.windowsdevcenter.com/pub/a/oreilly/windows/news/win2kcommands_0401.html#ps)

*   用于获取过程的 Powershell。

# winforms - 启用双缓冲

> ID：302614
> 
> 赞同：1
> 
> 时间：2008-11-19T17:01:58.883
> 
> 标签：winforms, visual-studio-2008, doublebuffered

我已经看到以下代码在 winform 上启用双缓冲：

```
// Activates double buffering 
this.SetStyle(ControlStyles.DoubleBuffer |
   ControlStyles.OptimizedDoubleBuffer |
   ControlStyles.UserPaint |
   ControlStyles.AllPaintingInWmPaint, true);
this.UpdateStyles(); 
```

这与简单地设置 Form.DoubleBuffering = true 有什么不同吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T17:12:28.053

`Control.DoubleBuffering`施行

```
SetStyle(ControlStyles.OptimizedDoubleBuffer | ControlStyles.AllPaintingInWmPaint, value); 
```

所以你的代码集`ControlStyles.UserPaint`也是如此（此时可能没有效果）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T17:09:51.100

设置表单的 DoubleBuffering 将为该表单设置双缓冲。和打电话是一样的

```
form.SetStyle(ControlStyles.OptimizedDoubleBuffer, value); 
```

其他标志，如 UserPaint 和 AllPaintingInWmPaint 是不是通过简单地设置 control.DoubleBuffering = true 来设置的样式

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T17:29:24.697

在 .NET 1.x*中*`DoubleBuffered`，控件上没有属性，因此`SetStyle`启用它的唯一方法是。您看到的代码`SetStyle`可能仍然在*1.x*天左右，或者来自从那时起就没有改变习惯的开发人员。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T14:59:36.963

来自[Stackoverflow：如何在表单上加倍缓冲 .NET 控件？](https://stackoverflow.com/questions/76993/how-to-double-buffer-net-controls-on-a-form/77041#77041)：

```
public static void SetDoubleBuffered(System.Windows.Forms.Control c)
{
   //Taxes: Remote Desktop Connection and painting
   //http://blogs.msdn.com/oldnewthing/archive/2006/01/03/508694.aspx
   if (System.Windows.Forms.SystemInformation.TerminalServerSession)
      return;

   System.Reflection.PropertyInfo aProp = typeof(System.Windows.Forms.Control).GetProperty(
        "DoubleBuffered",
         System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance);
   aProp.SetValue(c, true, null); 
} 
```

# python - Python 中的嵌入式 Web 服务器？

> ID：302615
> 
> 赞同：12
> 
> 时间：2008-11-19T17:02:10.303
> 
> 标签：python, simplehttpserver, embeddedwebserver

你能推荐一个我可以嵌入到我的桌面应用程序中的简约 python 网络服务器吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-19T17:06:47.673

多么简约，目的是什么？

[SimpleHTTPServer](https://docs.python.org/2/library/simplehttpserver.html)作为标准 Python 库的一部分免费提供。

如果您需要更多功能，请查看[CherryPy](http://cherrypy.org/)或（在顶端）[Twisted](http://twistedmatrix.com/trac/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-20T07:04:08.747

[我正在成为新发布的电路](http://trac.softcircuit.com.au/circuits "电路")库的忠实粉丝。它是一个组件/事件框架，带有一组非常好的用于创建 Web 服务器和应用程序的包。这是该站点的简单 Web 示例：

```
from circuits.lib.web import Server, Controller

class HelloWorld(Controller):
   def index(self):
      return "Hello World!"

server = Server(8000)
server += HelloWorld()
server.run() 
```

它的 WSGI 支持也不比这更复杂。好东西。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-19T17:26:08.773

如果你正在做很多并发的事情，你可能会考虑[Kamaelia](http://www.kamaelia.org/Home)的[HTTPServer](http://www.kamaelia.org/Components/pydoc/Kamaelia.Protocol.HTTP.HTTPServer.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-20T11:39:49.067

我发现 web.py 很容易使用：[http ://webpy.org/](http://webpy.org/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-20T23:35:48.713

如果您想使用标准库中的某些内容，我强烈建议您*不要*使用 SimpleHTTPServer，而是使用[`wsgiref.simple_server`](http://docs.python.org/library/wsgiref.html#module-wsgiref.simple_server). SimpleHTTPServer 是一种笨拙且相当荒谬的方式来实现 Web 应用程序，虽然原始 WSGI 不是非常容易（但肯定是可能的），但您可以选择在它之上使用任何基于 WSGI 的框架。此外，如果您使用 wsgiref，您稍后可以选择更改为像 CherryPy 这样的服务器（请注意，CherryPy 中的服务器可以与框架的其余部分分开使用，您只需要[一个文件](http://docs.python.org/library/wsgiref.html#module-wsgiref.simple_server)用于服务器）。对于“真正的”Web 应用程序，CherryPy 比 wsgiref 有几个优点，但对于本地托管的应用程序，它们中的任何一个都不太重要。

如果您正在制作桌面应用程序，您将需要为 wsgiref 或 CherryPy 启动一个单独的线程。如果没问题，那么基于 WSGI 的服务器可能是最简单的。如果您不想为服务器启动单独的线程，那么您很可能需要使用 Twisted。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-19T17:05:41.357

请参阅[WSGI 参考](http://www.python.org/doc/2.5.2/lib/module-wsgiref.html)实现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T17:21:06.677

我做了这个。 [它只是稍微增强了 Python 的 SimpleHTTPServer，让您可以根据请求定义自定义操作。](http://www.blendedtechnologies.com/python-trick-really-little-http-server/220)

# linux - 如何解决 AIX tar 命令套接字错误？

> ID：302637
> 
> 赞同：1
> 
> 时间：2008-11-19T17:09:10.117
> 
> 标签：linux, unix, aix, tar

在 AIX 环境中工作，我发出以下 tar 命令并在套接字上接收错误。

问题 1\. 如何避免套接字错误？

问题 2\. 我可以依靠 tar 文件来包含除错误文件之外的所有文件吗？

```
 $ tar  -cvf /post_patches.tar /xyz 
   tar: /xyz/runtime/splSock6511 could not be archived
   tar: /xyz/runtime/splSock6507 could not be archived
   tar: /xyz/runtime/splSock6510 could not be archived
   tar: /xyz/runtime/splSock6506 could not be archived

 $ ls -asl spl*
   0 srwxrwxrwx    1 myuser   myuser            0 Nov 19 09:41 splSock6506
   0 srwxrwxrwx    1 myuser   myuser            0 Nov 19 09:41 splSock6507
   0 srwxrwxrwx    1 myuser   myuser            0 Nov 18 14:19 splSock6510
   0 srwxrwxrwx    1 myuser   myuser            0 Nov 18 14:19 splSock6511 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T23:48:42.573

1.  您可能应该避免包含绝对路径 - GNU`tar`会自动执行此操作。这使得很难恢复到`/xyz`可能已经存在并且可能不应该被篡改的其他机器上。
2.  您可能不应该在根目录中写入 - 这是一个不好的做法。
3.  AIX tar 支持`-X`排除文件的选项；如果您可以列出要排除的文件，它将起作用。
4.  它还具有`-d`处理特殊文件的选项。

    光盘 /

    找到 xyz -type s -print > /tmp/xx

    tar -cvf /tmp/post_patches.tar -X /tmp/xx

    rm -f /tmp/xx

这确保所有套接字文件都列在 /tmp/xx 中；它们将通过 -X 选项从备份中排除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T17:43:16.837

我手头没有 AIX 可以查看，但 Mac OSX 上的“tar”支持“ **--ignore-failed-read** ”开关。你看过了吗？

# linq - Linq to Entity - 我可以在列表模板 MVC 页面中访问模型中的另一个表吗

> ID：302650
> 
> 赞同：0
> 
> 时间：2008-11-19T17:14:41.137
> 
> 标签：linq, entity-framework, dynamic-data

在项目模板解决方案（动态数据 Web 应用程序）中，我创建了模型，一切都很好。- 获取表格列表，以及选择编辑等。

但是我的数据库有只包含伪造键的链接表 - 所以列表模板只显示 fk 值

![表格示意图](https://lh6.ggpht.com/_KoHB_k0rTus/SSUbvobGucI/AAAAAAAAAB4/MYPlVYtB2zQ/s288/PARLinkTable.jpg)

是否可以将主表中的行列表与基于 fk 的另一个表的检查结合起来？

更类似于 SQL 中的联接？但是使用 Linq2Entity 和 MetaModel？

下面是 List.aspx.cs - 这似乎将标准网格绑定到实体数据源，但这是根据 MVC 中的路由绑定到当前表。

但正如您所看到的，我需要通过模型查询 Person、Role 和 Link 表以获取其他字段，这样才会有用。 ![工作室](https://lh5.ggpht.com/_KoHB_k0rTus/SSUd7yGYUgI/AAAAAAAAADI/cbHUjV1GfrA/VS-Plain.jpg)

PS 如果可能的话，想尝试将其保留在 LINQ2Entity 中 - 尝试摸索

我想做的很自然的事情是开始衍生新的 sql 查询来检索这些值。但这不是这个成语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T10:48:26.923

您可以通过 dataContext 引用元模型

```
MetaModel refMetaModel = MetaModel.GetModel(typeof(yourdataContextName));
MetaTable refMetaModel;
refMetaModel =  refMetaModel.GetTable("yourTableName"); 
```

PS查看了您的代码，这在您的场景中有效。您可以从模型中获取表，然后检查模型中每个表返回的数据

[关于 MetaModel 的 MSDN 文章](http://msdn.microsoft.com/en-us/library/system.web.dynamicdata.metamodel.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T13:13:08.720

从 Linq to Entities 模型中使用它也很有用 -

使用 dataContext - 您可以获得最有用的实际数据。

metaModel 允许访问 dataModel，它为您提供底层 ddl 类型信息

```
//use the datacontext to get the underlying data
      using (brrdbEntities brr = new brr_dbEntities())
      {
          ObjectQuery<person> people = brr.person;
          IQueryable<string> names = from p in people select p.person_name;
          foreach (var name    in names) 
```

# python - 只使用 Django 的某些部分？

> ID：302651
> 
> 赞同：41
> 
> 时间：2008-11-19T17:14:42.963
> 
> 标签：python, django

我喜欢 Django，但对于一个特定的应用程序，我只想使用它的一部分，但我对 Django 内部的工作方式还不够熟悉，所以也许有人可以指出我必须做的正确方向查看。

具体来说，我*想使用*：

*   模型和数据库抽象
*   [缓存 API](http://docs.djangoproject.com/en/dev/topics/cache/#the-low-level-cache-api) ，虽然我想通过缓存而不是 HTML 生成来避免数据库查找，并且由于 Django 中的缓存框架是为后者设计的，我还不确定这是否真的合适。

我*不会使用*：

*   模板
*   网址配置

或者，更准确地说，我既没有使用 HTTP 也没有使用 HTML。所以基本上，我的输入/输出链与平时不同。

这能行吗？

我在 Django 中的个人杀手级功能是我可以使用模型进行的对象/数据库映射，所以如果有另一种技术（不一定是 Python，我正处于设计阶段，我对语言和平台）给我同样的能力，那也很棒。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-11-19T18:17:41.057

我自己使用 Django 进行对象/数据库映射，而不使用它的 urlconfigs。只需创建一个名为的文件`djangosettings.py`并插入必要的配置，例如：

```
DATABASE_ENGINE   = 'oracle'
DATABASE_HOST     = 'localhost'
DATABASE_NAME     = 'ORCL'
DATABASE_USER     = 'scott' 
DATABASE_PASSWORD = 'tiger' 
```

然后在您的常规 Python 代码中，执行

```
import os
os.environ["DJANGO_SETTINGS_MODULE"] = "djangosettings" 
```

在导入任何 Django 模块之前。这将使您无需实际拥有 Django 项目即可使用 Django 的对象/数据库映射，因此您可以将其用于独立脚本或其他 Web 应用程序或任何您想要的。

至于缓存，如果您不想使用 Django，那么您可能应该决定使用什么并从那里开始。我推荐使用 CherryPy，它不使用 Django 风格的正则表达式 URL 映射，而是根据函数名称自动将 URL 映射到函数。CherryPy 主页顶部有一个示例： http: [//cherrypy.org/](http://cherrypy.org/)

CherryPy 有自己的缓存系统，因此您可以完成与 Django 完全相同的事情，但无需使用 Django 的 urlconfig 系统。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-20T04:46:55.530

Django 作为一个 Web 框架，在创建网站方面非常高效。但是，它也同样适合解决网络问题。这是该项目引以为豪的*松散耦合*。没有什么能阻止您安装完整版本的 Django，并且只使用您需要的东西。通常，很少有 Django 组件对它们的使用做出广泛的假设。

具体来说：

*   Django 模型对 HTML 或 HTTP 一无所知。
*   模板对 HTML 或 HTTP 一无所知。
*   缓存系统可用于[存储 *任何可以腌制*](http://docs.djangoproject.com/en/dev/topics/cache/#the-low-level-cache-api)的东西。

尝试在没有 Web 服务器的情况下使用 Django 时，您将面临的主要问题之一是正确设置环境。ORM 和缓存系统仍然需要在 settings.py 中进行配置。有一些关于在[没有设置模块的情况下使用 django](http://docs.djangoproject.com/en/dev/topics/settings/#using-settings-without-setting-django-settings-module)的文档，您可能会发现它们很有用。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-05-28T20:04:18.147

**Django ORM 独立**

我创建了一个模板 Django 项目，它允许您这样做。

[https://github.com/dancaron/Django-ORM](https://github.com/dancaron/Django-ORM)

只需按照说明进行操作，您就可以编写利用 Django 数据库功能的独立 python 文件，而无需使用 urlconf、视图等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T17:23:08.687

当然还有其他项目专门实现 django 的单个部分。[例如， TurboGears](http://turbogears.org/)是几个项目的集合，这些项目可以单独工作，共同构成一个完整的 Web 开发框架。

对于数据库抽象[SQLAlchemy 浮现](http://www.sqlalchemy.org/)在脑海中。

关于缓存部分：我不知道有任何实现通用缓存设施的独立项目。

另一方面，实现自己的缓存应该相当容易，例如使用[pickles](http://docs.python.org/library/pickle.html#module-cPickle)。看看这个关于想法[的装饰者的食谱和谷歌的“记忆”。](http://code.activestate.com/recipes/325205/)

还要记住，您的数据库有自己的缓存机制，所以也许您甚至不需要关心细节。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-19T17:24:07.297

我倾向于使用混合搭配的方法来使用 Python 进行 Web 编程。:-)

我对 Django 没有太多经验，但我建议让[sqlalchemy](http://www.sqlalchemy.org/)看看数据库的东西。它与其他人一起工作得很好，并为您提供了几个潜在的抽象层（因此您可以使用一些基本的东西，或者如果您愿意，可以对其进行调整）。另外，如果您曾经使用过 hibernate/nhibernate，那么您已经对它有些熟悉了。

我最喜欢的部分是它有很多可供数据库连接的选项（最值得注意的是 SQL Server，我上次检查时 django 没有内置它）。

话虽如此，有人告诉我，使用 Django，分离功能非常容易（但我自己从未这样做过）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-03-27T14:34:02.997

为了使用 Django 的**模型和数据库抽象**，我在这里解释了一种在 Django 之外使用它们的简洁方法： [https ://stackoverflow.com/a/49515366/2682613](https://stackoverflow.com/a/49515366/2682613)

**Django 2.0.2 版**

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-21T01:42:27.367

我分享了一个解决方案示例，它可以防止代码中的 Python 路径操作：

[https://github.com/askalyuk/django-orm-standalone](https://github.com/askalyuk/django-orm-standalone)

它包含一个独立的数据访问包、一个单独的简单 Django 站点和一个单元测试。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-09T11:09:36.867

我找到了[KeyboardInterrupt 的答案](https://stackoverflow.com/a/948593/1145750)，但它在 2009 年得到了回答，我未能在 Django 1.8 中运行它。最近`Django 1.8`，你可以看看这个，其中一些部分来自 KeyboardInterrupt 的答案。

文件夹结构为：

```
.
├── myApp
│   ├── __init__.py
│   └── models.py
└── my_manage.py 
```

myApp 是一个模块，包含一个空的`__init__.py`和`models.py`.

有一个示例模型类`models.py`： from django.db import models

```
class MyModel(models.Model):
     field = models.CharField(max_length=255) 
```

my_manage.py 包含 django 数据库、installed_app 设置并充当 django 官方 manage.py，因此您可以：

```
python my_manage.py sql myApp
python my_manage.py migrate
...... 
```

中的代码`my_manage.py`是： from django.conf import settings

```
db_conf = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'your_database_name',
        'USER': 'your_user_name',
        'PASSWORD': 'your_password',
        'HOST': 'your_mysql_server_host',
        'PORT': 'your_mysql_server_port',
    }
}

settings.configure(
    DATABASES = db_conf,
    INSTALLED_APPS     = ( "myApp", )
)

# Calling django.setup() is required for “standalone” Django u usage
# https://docs.djangoproject.com/en/1.8/topics/settings/#calling-django-setup-is-required-for-standalone-django-usage
import django
django.setup()

if __name__ == '__main__':
    import sys
    from django.core.management import execute_from_command_line

    execute_from_command_line(sys.argv) 
```

# java - 我如何发现给定日期的季度？

> ID：302658
> 
> 赞同：47
> 
> 时间：2008-11-19T17:15:44.660
> 
> 标签：java, calendar

给定一个 java.util.Date 对象，我该如何找到它所在的 Quarter？

假设 Q1 = 1 月 2 月 3 月，Q2 = 4 月、5 月、6 月等。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-11-19T17:18:43.220

[从 Java 8 开始，可以使用java.time](https://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)包中的类作为字段访问季度。

```
import java.time.LocalDate;
import java.time.temporal.IsoFields;

LocalDate myLocal = LocalDate.now();
quarter = myLocal.get(IsoFields.QUARTER_OF_YEAR); 
```

* * *

在旧版本的 Java 中，您可以使用：

```
import java.util.Date;

Date myDate = new Date();
int quarter = (myDate.getMonth() / 3) + 1; 
```

请注意，尽管[getMonth](https://docs.oracle.com/javase/7/docs/api/java/util/Date.html#getMonth())很早就被弃用了：

> 从 JDK 1.1 版开始，由 Calendar.get(Calendar.MONTH) 取代。

相反，您可以使用这样的`Calendar`对象：

```
import java.util.Calendar;
import java.util.GregorianCalendar;

Calendar myCal = new GregorianCalendar();
int quarter = (myCal.get(Calendar.MONTH) / 3) + 1; 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2016-04-21T09:31:51.590

在 Java 8 及更高版本中，[java.time](https://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)类有一个更简单的版本。使用[`LocalDate`](https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html)和[`IsoFields`](https://docs.oracle.com/javase/8/docs/api/java/time/temporal/IsoFields.html)

```
LocalDate.now().get(IsoFields.QUARTER_OF_YEAR) 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-19T17:20:06.710

您将不得不编写自己的代码，因为每个企业的“季度”一词都不同。你不能做类似的事情：

```
Calendar c = /* get from somewhere */
int month = c.get(Calendar.MONTH);

return (month >= Calendar.JANUARY && month <= Calendar.MARCH)     ? "Q1" :
       (month >= Calendar.APRIL && month <= Calendar.JUNE)        ? "Q2" :
       (month >= Calendar.JULY && month <= Calendar.SEPTEMBER)    ? "Q3" :
                                                                    "Q4"; 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-11-19T17:23:21.587

由于宿舍是一个本地化（西方）概念，请指定一个 Locale 而不是使用平台默认值：

```
Calendar cal = Calendar.getInstance(Locale.US);
/* Consider whether you need to set the calendar's timezone. */
cal.setTime(date);
int month = cal.get(Calendar.MONTH); /* 0 through 11 */
int quarter = (month / 3) + 1; 
```

这将避免在非西方日历上获得第十三个月（Calendar.UNDECIMBER），以及由于其较短的月份而导致的任何偏差。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-06-26T00:43:11.800

如果你有

```
private static final int[] quarters = {1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4}; 
```

那么电流`quarter`是

```
private static final int thisQuarter = quarters[thisMonth]; 
```

`thisMonth`在哪里

```
private static final int thisMonth = cal.get(Calendar.MONTH); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-08-18T12:40:41.203

使用 Joda 时间时，使用 Math.ceil() 函数：

```
double quarter = Math.ceil(new Double(jodaDate.getMonthOfYear()) / 3.0); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-09-02T19:11:25.840

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-19T17:30:26.470

JFreeChart 有一个 Quarter 类。如果您好奇，请查看[javadoc](http://www.jfree.org/jfreechart/api/javadoc/index.html?org/jfree/data/time/Quarter.html)。如果您想查看实现，也可以从[SourceForge获得源代码。](http://sourceforge.net/project/showfiles.php?group_id=15494&package_id=12428)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-19T18:06:09.020

这里有很好的解决方案，但请记住，季度也可能因公司/行业而异。有时一个季度可能是不同的 3 个月。

您可能希望扩展或封装日历类以将其自定义为您的任务，而不是编写一些转换它的实用程序函数。您的应用程序在该领域可能已经足够复杂，以至于您会发现新日历类的其他用途——我保证您会很高兴您扩展或封装它，即使现在看起来很傻。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-07-11T20:11:06.500

```
int month = Calendar.getInstance().get( Calendar.MONTH ) + 1;

int quarter = month % 3 == 0?  (month / 3): ( month / 3)+1; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-04-24T17:47:11.197

确保`thisMonth`至少是浮点数或双精度数，而不是整数：

```
String quarter = thisMonth/3 <= 1 ? "Q1" : thisMonth/3 <= 2 ? "Q2" : thisMonth/3 <= 3 ? "Q3" : "Q4"; 
```

问候，女士

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-11-12T13:09:01.460

对我来说，我使用这种方法来表示字符串：

```
int quarter = (Calendar.getInstance().get(Calendar.MONTH) / 3); // 0 to 3
String[] mQuarterKey = {"qt1", "qt2", "qt3", "qt4"};
String strQuarter = mQuarterKey[quarter]; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-09-12T08:25:12.853

使用 java8 你可以使用格式化程序：

```
import java.time.format.DateTimeFormatter
import java.time.LocalDate

println("withQuarter: " + LocalDate.of("2016".toInt,"07".toInt,1).format(DateTimeFormatter.ofPattern("yyyyQMM"))) 
```

与季度：2016 **3** 07

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-10-01T07:46:53.067

我使用这种方法。

```
 public static Integer getQuarter(Date d){
    Calendar c = Calendar.getInstance();
    c.setTime(d);
    int month = c.get(Calendar.MONTH);
    return (month /3)+1;
} 
```

# c# - Cursor.Current 与 this.Cursor

> ID：302663
> 
> 赞同：57
> 
> 时间：2008-11-19T17:17:48.977
> 
> 标签：c#, .net, winforms, mouse-cursor

`Cursor.Current`.Net中和`this.Cursor`（`this`WinForm在哪里）之间有区别吗？我一直使用`this.Cursor`它并且运气很好，但我最近开始使用 CodeRush 并且只是在“等待光标”块中嵌入了一些代码，并且 CodeRush 使用了该`Cursor.Current`属性。我在 Internet 和工作中看到其他程序员对该`Cursor.Current`属性有一些问题。这让我想知道两者是否有区别。提前致谢。

我做了一个小测试。我有两个winforms。我单击 form1 上的一个按钮，将`Cursor.Current`属性设置为`Cursors.WaitCursor`然后显示 form2。光标在任何一种形式上都不会改变。它仍然是`Cursors.Default`（指针）光标。

如果我在 form1 上的按钮单击事件中设置`this.Cursor`为`Cursors.WaitCursor`并显示 form2，则等待光标仅显示在 form1 上，默认光标在 form2 上，这是预期的。所以，我仍然不知道是什么`Cursor.Current`。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2008-11-19T18:23:19.190

Windows 向包含鼠标光标的窗口发送 WM_SETCURSOR 消息，使其有机会更改光标形状。像 TextBox 这样的控件利用了这一点，将光标更改为 I-bar。Control.Cursor 属性确定将使用什么形状。

Cursor.Current 属性直接更改形状，无需等待 WM_SETCURSOR 响应。在大多数情况下，这种形状不太可能长期存在。只要用户移动鼠标，WM_SETCURSOR 就会将它改回 Control.Cursor。

.NET 2.0 中添加了 UseWaitCursor 属性，以便更轻松地显示沙漏。不幸的是，它的效果不是很好。它需要一条 WM_SETCURSOR 消息来更改形状，并且当您将属性设置为 true 然后执行需要一段时间的操作时，不会发生这种情况。试试这个代码，例如：

```
private void button1_Click(object sender, EventArgs e) {
  this.UseWaitCursor = true;
  System.Threading.Thread.Sleep(3000);
  this.UseWaitCursor = false;
} 
```

光标永远不会改变。要将其打造成形状，您还需要使用 Cursor.Current。这是一个小助手类，可以使它变得容易：

```
using System;
using System.Windows.Forms;

public class HourGlass : IDisposable {
  public HourGlass() {
    Enabled = true;
  }
  public void Dispose() {
    Enabled = false;
  }
  public static bool Enabled {
    get { return Application.UseWaitCursor; }
    set {
      if (value == Application.UseWaitCursor) return;
      Application.UseWaitCursor = value;
      Form f = Form.ActiveForm;
      if (f != null && f.Handle != IntPtr.Zero)   // Send WM_SETCURSOR
        SendMessage(f.Handle, 0x20, f.Handle, (IntPtr)1);
    }
  }
  [System.Runtime.InteropServices.DllImport("user32.dll")]
  private static extern IntPtr SendMessage(IntPtr hWnd, int msg, IntPtr wp, IntPtr lp);
} 
```

并像这样使用它：

```
private void button1_Click(object sender, EventArgs e) {
  using (new HourGlass()) {
    System.Threading.Thread.Sleep(3000);
  }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-19T17:19:32.750

我相信 Cursor.Current 是当前正在使用的鼠标光标（无论它在屏幕上的哪个位置），而 this.Cursor 是当鼠标经过您的窗口时它将被设置的光标。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-19T17:20:35.070

`this.Cursor`是当鼠标悬停在 引用的窗口上时将使用的光标`this`。 是当前鼠标光标，如果鼠标在不同的窗口上`Cursor.Current`，它可能会有所不同。`this.Cursor`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-12-15T05:45:26.133

实际上，如果您想从另一个线程使用 HourGlass，这会给您返回跨线程异常，因为您尝试从与最初创建的表单不同的线程访问 f.Handle。使用来自 user32.dll 的 GetForegroundWindow()。

```
[DllImport("user32.dll")]
private static extern IntPtr GetForegroundWindow(); 
```

进而

```
public static bool Enabled
{
    get
    {
        return Application.UseWaitCursor;
    }

    set
    {
        if (value == Application.UseWaitCursor)
        {
            return;
        }

        Application.UseWaitCursor = value;
        var handle = GetForegroundWindow();
        SendMessage(handle, 0x20, handle, (IntPtr)1);
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-04-30T20:29:06.413

我注意到关于设置光标的一个有趣的事情，所以我想澄清一下我自己之前的一些误解，希望它也可以帮助其他人：

当您尝试使用设置表单的光标时

this.cursor = 光标.Waitcursor

您实际上为控件设置了光标，而不是整个表单，因为光标是 Control 类的属性。

当然，只有当鼠标实际位于实际控件上时光标才会更改为给定的光标（明确地是表单的区域）

正如 Hans Passant 已经说过的那样：

> Windows 向包含鼠标光标的窗口发送 WM_SETCURSOR 消息，使其有机会更改光标形状

我不知道 Windows 是否直接向控件发送消息，或者表单是否根据鼠标位置将这些消息中继到它的子控件，我很可能会猜测第一种方法，因为当我使用表单的覆盖 WndProc 获取消息时控件，例如，当我在文本框上时，表单没有处理任何消息。（请有人澄清这一点）

基本上我的建议是停止使用 this.cursor 并坚持使用 this.usewaitcursor，因为这会将所有子控件的 cursor 属性更改为 waitcursor。

这个问题也与应用程序级别 Application.usewaitcursor 相同，当您没有使用光标在表单/表单上时，Windows 不会发送 WM_SETCURSOR 消息，因此如果您在移动之前启动耗时的同步操作将鼠标悬停在表单区域上，只有在耗时的同步操作完成后，表单才能处理此类消息。

（我根本不建议在 UI 线程中运行耗时的任务，主要是这导致了这里的问题）

我对 Hans Passant 的回答做了一点改进，所以沙漏可以设置在应用程序级别或表单级别，也可以避免来自跨线程操作调用的 InvalidOperationException：

```
using System;
using System.Windows.Forms;

public class HourGlass : IDisposable
{
    public static bool ApplicationEnabled
    {
        get{ return Application.UseWaitCursor; }
        set
        {
            Form activeFrom = Form.ActiveForm;
            if (activeFrom == null || ApplicationEnabled == value) return;
            if (ApplicationEnabled == value)return;
            Application.UseWaitCursor = (bool)value;

            if (activeFrom.InvokeRequired)
            {
                activeFrom.BeginInvoke(new Action(() =>
                {
                    if (activeFrom.Handle != IntPtr.Zero)
                    SendMessage(activeFrom.Handle, 0x20, activeFrom.Handle, (IntPtr)1); // Send WM_SETCURSOR
                }));
            }
            else
            {
                if (activeFrom.Handle != IntPtr.Zero)
                SendMessage(activeFrom.Handle, 0x20, activeFrom.Handle, (IntPtr)1); // Send WM_SETCURSOR
            }
        }
    }

    private Form f;

    public HourGlass() 
    {
        this.f = Form.ActiveForm;

        if (f == null)
        {
            throw new ArgumentException();
        }
        Enabled = true;
    }

    public HourGlass(bool enabled)
    {
        this.f = Form.ActiveForm;

        if (f == null)
        {
            throw new ArgumentException();
        }
        Enabled = enabled;
    }

    public HourGlass(Form f, bool enabled)
    {
        this.f = f;

        if (f == null)
        {
            throw new ArgumentException();
        }
        Enabled = enabled;
    }

    public HourGlass(Form f)
    {
        this.f = f;

        if (f == null)
        {
            throw new ArgumentException();
        }

        Enabled = true;
    }

    public void Dispose()
    {
        Enabled = false;
    }

    public bool Enabled
    {
        get { return f.UseWaitCursor; }
        set
        {
            if (f == null || Enabled == value) return;
            if (Application.UseWaitCursor == true && value == false) return;

            f.UseWaitCursor = (bool)value;

            if(f.InvokeRequired)
            {
                f.BeginInvoke(new Action(()=>
                {
                    if (f.Handle != IntPtr.Zero)
                    SendMessage(f.Handle, 0x20, f.Handle, (IntPtr)1); // Send WM_SETCURSOR
                }));
            }
            else
            {
                if (f.Handle != IntPtr.Zero)
                SendMessage(f.Handle, 0x20, f.Handle, (IntPtr)1); // Send WM_SETCURSOR
            }
        }
    }

    [System.Runtime.InteropServices.DllImport("user32.dll")]
    private static extern IntPtr SendMessage(IntPtr hWnd, int msg, IntPtr wp, IntPtr lp);
} 
```

要在应用程序级别使用它：

```
try
{
  HourGlass.ApplicationEnabled = true;
  //time consuming synchronous task
}
finally
{
  HourGlass.ApplicationEnabled = false;
} 
```

要在表单级别使用它，您可以将其用于当前活动表单：

```
using (new HourGlass())
{
  //time consuming synchronous task
} 
```

或者你可以像这样初始化一个局部变量：

```
public readonly HourGlass hourglass;

public Form1()
{
    InitializeComponent();
    hourglass = new HourGlass(this, false);
} 
```

稍后在 try catch finally 块中使用它

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-15T03:40:49.723

当 LongRunningOperation() 处理消息时，这对我很有用。

```
private void btnDoLongRunningOperation_Click(object sender, System.EventArgs e)
{
    this.Cursor = Cursors.WaitCursor;
    LongRunningOperation();
    this.Cursor = Cursors.Arrow;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-03-12T19:44:00.853

来自 VB.net VS 2012

```
Windows.Forms.Cursor.Current = Cursors.Default 
```

# objective-c - Objective-C 和 sqlite 的 DATETIME 类型

> ID：302664
> 
> 赞同：7
> 
> 时间：2008-11-19T17:17:49.647
> 
> 标签：objective-c, sqlite

我有一个 sqlite3 表，我试图将它映射到 Objective-C 中的一个对象。该表的一个属性是“completed_at”，它存储为 DATETIME。

我想在我的 Objective-C 类（继承自 NSObject）上创建一个属性，该属性将很好地映射到“completed_at”属性。

Objective-C 有一个 NSDate 类型，但我不确定它是否会直接映射？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2011-08-18T13:57:33.807

I am sharing here just the core things regarding date formatting for saving and retrieving the data for presentation. If you have any problem with this code snippet then I will share the full code that I used for my project.

When you save your data, bind your date value in the sql statement like this way:

```
 NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
    [dateFormat setDateFormat:@"yyyy-MM-dd HH:mm:ss"];
    NSString *dateString=[dateFormat stringFromDate:[NSDate date]];

    sqlite3_bind_text(saveStmt, 1, [dateString UTF8String] , -1, SQLITE_TRANSIENT); 
```

and when you retrieve data you have to write this code:

```
 NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
    [dateFormat setDateFormat:@"yyyy-MM-dd HH:mm:ss"];
    NSDate *myDate =[dateFormat dateFromString:[NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 1)]]; 
```

now you have a variable myDate of NSDate type which you can render in your way:

```
 NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
    [formatter setDateFormat:@"dd-MM-yyyy hh:mm:ss a"];
    NSLog(@"My Date was : %@", [formatter stringFromDate:myDate]); 
```

You must have to remember three things:

1.  In your SQLite date field type should be DATETIME
2.  Date format should be same when you store and when you retrieve
3.  Now you can show in your own way but following the format. Below the format details is given.

Format:

```
 'dd' = Day 01-31
   'MM' = Month 01-12
   'yyyy' = Year 2000
   'HH' = Hour in 24 hour
   'hh' = Hour in 12 hour
   'mm' = Minute 00-59
   'ss' = Second 00-59
   'a' = AM / PM 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T18:03:54.877

我对 Objective-C 的经验为零，但我通过谷歌搜索找到了Apple 的[NSDate 类参考。](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/doc/uid/20000188)通过链接页面上提供的信息，您应该能够弄清楚如何在 Objective-C 中操作 32 位纪元时间，这在 SQLite 中可以很好地工作。我可能会将 completed_at 列创建为 32 位时间的 INTEGER 类型。

SQLite 真的更喜欢 Julian 日期，它是浮点数。我还没有找到任何解释如何强迫 NSDate 类与 Julians 合作的文档。

[timeIntervalSince1970](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDate/timeIntervalSince1970)看起来很有趣。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-13T04:30:22.513

如果您试图影响演示，格式化程序很重要，但如果您将 if 用于内部存储，则您定义的字符串可能会破坏 DB 引擎使用该值进行计算、比较、排序等的能力。此外，如果您将有不同的客户端将日期值插入数据库中，您将不得不在任何地方编写转换函数。我使用了以下内容，它按预期工作（模式的列定义为 DATETIME）：

```
dateExpires = [NSDate dateWithTimeIntervalSinceNow: sqlite3_column_double(queryStmt, 5)]; 
```

我在中央时区插入带有 Firefox 附加组件的 SQLITE3 db 作为“2010 年 4 月 12 日”。在 XCode 调试器中查看 'dateExpires' 的值显示为：

```
2010-04-12 23:19:48 -0500 
```

果然，那是正确的时间。

此外，要插入 SQLITE DB，您将输入值`[NSDate date]`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T22:06:16.070

这是几周前出现的：

[在 iPhone 应用程序中将日期持久化到 SQLite3](https://stackoverflow.com/questions/251155/persisting-dates-to-sqlite3-in-an-iphone-application)

# visual-studio - 防止在 VSS 中检出第三方 DLL

> ID：302677
> 
> 赞同：1
> 
> 时间：2008-11-19T17:20:35.977
> 
> 标签：visual-studio, version-control, visual-sourcesafe

（我知道我正在使用 Visual Source Safe，我别无选择，因为它附带 MSDN 订阅许可证，而且我的公司不想购买第三方源代码控制解决方案......）

我有一个 VS 2005 解决方案，其中包含 3 个 C# 类库项目、2 个 ASP.NET 网站项目和一个存储在 Visual Source Safe 数据库中的 ASP.NET Web 服务项目。一些项目引用了处理常见任务的通用库 DLL。

当一个新人在他们的工作站上设置解决方案并第一次构建它时，它会检查 ASP.NET 网站和 Web 服务项目的 bin 文件夹中的公共库 DLL。当当前正在处理该项目的另一个开发人员尝试构建时，他们会收到“文件已被其他用户完全签出”消息。

VS 2005 不会在引起头痛的 DLL 旁边显示复选标记。

有没有办法防止这种情况发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T19:03:23.257

为什么要将 bin 文件夹签入 SourceSafe？在我从事的项目中，第三方 dll 被检入与解决方案文件处于同一级别的单独文件夹（可能称为 ExternalLibraries 或 ThirdParty）中。编译过程将被设置为将 dll 复制到 bin 文件夹中。这可以通过 .refresh 文件或构建前或构建后步骤来处理。这样，VisualStudio/SourceSafe 将不会看到文件已更新，也不会尝试检出它们。

如果由于它们是依赖项而编译已经将文件拉入，我建议从 VSS 中删除 bin 文件夹。这与“从项目中排除文件夹”不同，后者在编译时从 VS05 中隐藏文件夹（并为您提供您提到的编译错误。）

如果第三方 dll 不会更改，另一种选择是在 VSS 中将这些文件设为只读。这样，任何用户都无法签出文件。（要将文件标记为只读，您需要从 VSS 管理工具更改权限；开发人员的工具没有该功能。）

至于为什么会这样，我不相信 VSS 会检查二进制版本号——它只关心修改文件的日期。如果新开发人员将所有代码提取出来，所有文件（包括二进制文件）都将以当前日期作为修改日期。这可能会导致不必要的结帐。

关于您后来的评论 - 我不确定为什么 VS05 不会将文件视为受源代码控制，但 VSS UI 会。我怀疑它与该文件夹中的 .vss 文件（和类似文件）有关。在这种情况下，VS05 不正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T17:42:26.090

不确定这是问题还是最佳解决方案，但如果您更新每个开发人员的机器，以便他们安装相同的最新版本的常见 DLL，则不应继续发生这种情况。如果项目文件引用的版本与开发人员机器上安装的版本不匹配，我认为 VSS 会检查 \bin 文件夹中的 DLL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T00:24:14.203

@佩德罗：

在 VS 2005 IDE 界面中，它并不表示 \bin 文件夹在 VSS 中。当我在 VSS UI 中查看该项目时，它显示该项目已签出给在其工作站上进行了最新构建的用户。

如果我使用“从项目中排除文件夹”选项，它将导致编译器抛出“未找到引用”错误。

在我的解决方案结构中，类库项目使用“添加引用”命令创建对第三方 DLL 的引用。然后我在我的 ASP、NET 网站和 Web 服务项目（使用网站项目模板）中设置对类库的项目引用。因为类库依赖于第三方 DLL，所以它们被复制到 \bin 文件夹中。

如何通过 VSS UI 将文件设置为只读？

# python - 在 mod_wsgi 下运行 Django 站点

> ID：302679
> 
> 赞同：9
> 
> 时间：2008-11-19T17:21:02.840
> 
> 标签：python, django, apache, mod-wsgi

我正在尝试使用 mod_wsgi 而不是 mod_python (RHEL 5) 运行我的 Django 站点。我在我所有的网站上都试过这个，但遇到了同样的问题。我按照每个人都推荐的标准方式对其进行了配置，但是对站点的请求只是超时了。

阿帕奇配置：

```
<VirtualHost 74.54.144.34>
    DocumentRoot /wwwclients/thymeandagain
    ServerName thymeandagain4corners.com
    ServerAlias www.thymeandagain4corners.com
    LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
    CustomLog /var/log/httpd/thymeandagain_access_log combined
    ErrorLog /var/log/httpd/thymeandagain_error_log
    LogLevel error
    WSGIScriptAlias / /wwwclients/thymeandagain/wsgi_handler.py
    WSGIDaemonProcess thymeandagain user=admin group=admin processes=1 threads=16
    WSGIProcessGroup thymeandagain
</VirtualHost> 
```

wsgi_handler.py：

```
import sys
import os

sys.path.append("/wwwclients")
os.environ['DJANGO_SETTINGS_MODULE'] = 'thymeandagain.settings'

import django.core.handlers.wsgi

application = django.core.handlers.wsgi.WSGIHandler() 
```

应该产生的守护进程 mod_wsgi 不存在，所以请求只是超时，我在日志中收到一堆“无法连接到 WSGI 守护进程”错误。WSGIDaemonProcess 指令是否有阻止创建守护进程的内容？在此先感谢您的帮助...

编辑：我在错误日志中得到这个：

```
[WARN@1227228322.174175] mcm_server_readable():2582: timeout: Operation now in progress: select(2) call timed out for read(2)able fds
[INFO@1227228322.174263] mcm_get_line():1592
[WARN@1227227903.249626] mcm_server_readable():2582: timeout: Operation now in progress: select(2) call timed out for read(2)able fds
[INFO@1227227903.249712] mcm_get_line():1592
[Thu Nov 20 21:18:17 2008] [notice] caught SIGTERM, shutting down
[Thu Nov 20 21:18:18 2008] [notice] Digest: generating secret for digest authentication ...
[Thu Nov 20 21:18:18 2008] [notice] Digest: done
[Thu Nov 20 21:18:18 2008] [notice] mod_python: Creating 4 session mutexes based on 8 max processes and 64 max threads.
[Thu Nov 20 21:18:18 2008] [notice] Apache/2.2.3 (Red Hat) mod_python/3.2.8 Python/2.4.3 mod_wsgi/2.1-BRANCH configured -- resuming normal operations 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-24T12:35:32.147

真正的问题是 Apache 日志目录的权限。有必要告诉 Apache/mod_wsgi 为用于与守护进程通信的 UNIX 套接字使用备用位置。看：

[http://code.google.com/p/modwsgi/wiki/ConfigurationIssues#Location_Of_UNIX_Sockets](http://code.google.com/p/modwsgi/wiki/ConfigurationIssues#Location_Of_UNIX_Sockets)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T02:42:14.717

问题是 mod_python 不能与 mod_wsgi 配合得很好。几周前我遇到了类似的问题，在我注释掉 mod_python 包含后不久，一切都开始为我工作了。

尝试在[modwsgi.org](http://modwsgi.org) wiki 搜索“mod_python”，我相信有人在评论中的某处谈论这个

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T18:21:34.323

[这](http://code.google.com/p/modwsgi/wiki/IntegrationWithDjango)是关于如何将 django 与 mod_wsgi 集成的非常详细的描述。

# c# - winmobile中带有文本字段的自定义对话框

> ID：302680
> 
> 赞同：4
> 
> 时间：2008-11-19T17:21:05.647
> 
> 标签：c#, windows-mobile, smartphone

我正在寻找一个简单的自定义对话框，比如一个消息框，它有一个标签和一个文本框。如果有一个简单的方法可以做到这一点，对不起！我真的不精通对话的东西。

感谢您的帮助，伙计们！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-20T15:45:54.637

以下是如何在 Windows Mobile 中制作一个如下所示的小型自定义对话框：

[替代文字 http://www.freeimagehosting.net/uploads/b8fb5421d6.jpg](http://www.freeimagehosting.net/uploads/b8fb5421d6.jpg)

向您的项目添加一个表单，并将其 FormBorderStyle 属性设置为 None。这允许表单调整大小和位置，但也意味着它没有边框或标题栏，用户无法移动它。

所以你必须伪造所有三个。伪造边框和标题栏的最简单方法是制作表单 SystemColors.WindowFrame 的 BackColor，然后使用 BackColor = SystemColors.Highlight 和 ForeColor = SystemColor.HighlightText 放置标签（在图片中显示“对话框”的位置） （并加粗字体），然后放置一个带有 BackColor = SystemColors.Window 的面板，您可以在其中看到图片中的白色。你必须调整标签和面板的位置和大小，这样你就有一个 1 像素的边框（这只是表单的背景色）。

要使表单能够被其假标题栏拖动，请将此代码添加到表单中（当然您也必须连接事件）：

```
private bool _Moving = false;
private Point _Offset;
private void Form1_MouseDown(object sender, MouseEventArgs e)
{
    _Moving = true;
    _Offset = new Point(e.X, e.Y);
}

private void Form1_MouseMove(object sender, MouseEventArgs e)
{
    if (_Moving)
    {
        Point newlocation = this.Location;
        newlocation.X += e.X - _Offset.X;
        newlocation.Y += e.Y - _Offset.Y;
        this.Location = newlocation;
    }
}
private void Form1_MouseUp(object sender, MouseEventArgs e)
{
    if (_Moving)
    {
        _Moving = false;
    }
} 
```

另一个问题是，由于没有真正的标题栏，用户无法关闭表单。您必须添加一个确定（或关闭）按钮，并将其放在按钮的 Click 事件中：

```
this.DialogResult = DialogResult.OK; 
```

通常您会在标题栏上使用鼠标事件来方便拖动，但标签控件没有任何鼠标事件。使用此代码，您实际上可以抓取表单上的任何位置并拖动它，但面板会阻止它并使标题栏成为唯一可以抓取和拖动的地方。

我的另一个答案有更多关于从自定义对话框中获取信息的详细信息。

更新：实际上，没有*明显*的方法可以在不添加自己的确定按钮的情况下关闭无边框表单。只要您不将表单的 ControlBox 属性设置为 False，“今日”屏幕右上角的 OK 或 X 按钮就会关闭您的对话框，即使它看起来不像，因为它实际上不在形式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T17:29:34.507

如果您想要一个超级简单但丑陋的解决方案，您可以在项目中包含对 Microsoft.VisualBasic 的引用，它可以让您像这样使用 VB 函数 InputBox：

```
string s = Microsoft.VisualBasic.Interaction.InputBox("prompt text",
    "title text", "default value", 0, 0); 
```

该对话框占据了整个屏幕，但使用起来很简单。但正如我所提到的，它非常丑陋。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T18:11:47.277

我假设您基本上想要一个自定义对话框，该对话框返回用户输入的字符串。一种方法是向您的项目添加对 Microsoft.VisualBasic 的引用，这使您可以访问 InputBox 方法，该方法基本上是一个带有文本框的消息框。但这并不好玩，而且我不确定它是否可以在智能手机上运行。

要自己滚动，您只需将一个表单（名为 CustomDialog）添加到您的项目中，然后将一个文本框 (textBox1)、一个标签 (label1) 和一个按钮（标记为“OK”）拖到它上面。

要设置标签文本，请向表单的构造函数添加一个参数，如下所示：

```
public CustomDialog(string textCaption)
{
    label1.Text = textCaption;
} 
```

要将输入的文本公开给调用者，请将此代码添加到表单中：

```
public override string Text
{
    get
    {
        return textBox1.Text;
    }
} 
```

在 OK 按钮的单击事件中，输入以下代码：

```
this.DialogResult = DialogResult.OK; // this will close the form, too 
```

要在主窗体中使用此对话框，请创建此窗体的一个实例，显示它，检查是否单击了 OK 按钮，然后读取其 Text 属性（返回用户输入的内容），如下所示：

```
using (CustomDialog dialog = new CustomDialog("What is your name"))
{
    if (dialog.ShowDialog(this) == DialogResult.OK)
    {
        string enteredText = dialog.Text;
    }
} 
```

你可以变得更漂亮，但这些是基础。

# mysql - 高效过滤/搜索

> ID：302683
> 
> 赞同：5
> 
> 时间：2008-11-19T17:22:32.570
> 
> 标签：mysql, search, lucene, filtering, saas

我们有一个管理内容页面的托管应用程序。每个页面可以有许多自定义字段，以及一些标准字段（时间戳、用户名、用户电子邮件等）。

可能有数百个不同的站点使用该系统——处理过滤/搜索的有效方法是什么？想象一个您想要缩小范围的网格视图。您可以过滤特定字段（用户 ID、日期），也可以输入全文搜索。

例如，“所有由 userid 10 开始的页面”将是一个针对 MySQL 数据库的非常快速的查询。但是像“由用户 ID 为 10 且匹配 [某些搜索查询] 的用户启动的所有页面”之类的内容会影响数据库，因此它适用于 Lucene 等搜索引擎。

基本上我想知道其他大型网站是如何做这种事情的。他们是否 100% 使用搜索引擎进行所有类型的过滤？他们是否将数据库查询与搜索引擎混合在一起？

如果我们*只*使用搜索引擎，那么新/更新对象出现在搜索索引中的延迟时间就会出现问题。也就是说，我读过*立即*更新索引并不聪明，而是分批进行。即使这意味着每 5 分钟一次，当用户查看一个简单的页面列表（例如“类别：5”的搜索查询）时，当他们最近添加的页面没有立即列出时，用户也会感到困惑。

我们正在使用 MySQL，并且一直在密切关注 Lucene 进行搜索。还有其他我不知道的技术吗？

我的想法是提供一个简单的过滤页面，它使用 MySQL 过滤基本字段。然后提供一个单独的全文搜索页面，该页面将显示类似于 Google 的结果。这是唯一的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T19:46:35.153

Solr 或 Grassyknoll 都为 Lucene 提供了稍微抽象的接口。

那说：是的。如果您是一个主要内容驱动的网站，提供对您的数据的全文搜索，那么除了 LIKE 之外，还有一些东西在起作用。虽然 MySql 的 FULLTEXT 索引并不完美，但在此期间它可能是一个可接受的占位符。

假设您确实创建了一个 Lucene 索引，将 Lucene 文档链接到您的关系对象非常简单，只需在索引时向文档添加一个存储属性（此属性可以是 url、ID、GUID 等）然后，搜索就变成了 2阶段系统： 1）向 Lucene 索引发出查询（显示简单的结果，如标题） 2）通过其键从关系存储中获取有关对象的更多详细信息

由于文档的实例化在 Lucene 中相对昂贵，因此您只想存储在 Lucene 索引中搜索的字段，而不是关系对象的完整克隆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T18:30:16.193

不要轻易注销 MySQL！

使用数据库实现它，例如在 where 子句中带有“like”的选择或其他任何内容。

分析它，如有必要，添加索引。推出一个测试版，这样您就可以从用户的实际数据模式中获得实数 - 并非所有列都可能被平等地询问，等等。

如果性能确实很糟糕，那么那就是您考虑其他选择的时候了。您可以考虑调整您的 SQL、您的数据库、运行数据库的机器，最后使用另一个技术堆栈...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T20:52:21.823

如果您想使用 MySQL 或 PostgreSQL，可以使用它的开源解决方案是 Sphinx： [http ://www.sphinxsearch.com/](http://www.sphinxsearch.com/)

我们遇到了同样的问题，并考虑将 Sphinx 和 Lucene 作为可能的解决方案。

# wcf - WCF 绑定，basicHttpBinding 与 wsHttpBnding

> ID：302684
> 
> 赞同：0
> 
> 时间：2008-11-19T17:22:38.360
> 
> 标签：wcf, binding

我的 WCF 从未与 wsbinding 一起使用，但是当我切换到 basic 时，它运行良好。

我必须做什么才能使 wsbinding 工作？

**更新**

当我说它不起作用时，我的意思是客户端永远无法使用服务端点。

**我必须在某处添加用户名/密码吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T17:34:03.733

首先，您使用的是 Visual Studio 2005 还是 2008？接下来，如果您使用的是 VS2005，您是否安装了 2006 年发布的用于 WCF/WF 的 .NET 3.0 CTP 工具？我问这些问题是因为我想知道您如何在客户端中设置代理类。您是否右键单击并执行“添加服务参考”或“添加网络参考”

另外，您的 WCF 配置文件是否类似于以下内容？这显示了双重设置，基本和 WsHttp 绑定。

```
 <system.serviceModel>
    <bindings>
      <wsHttpBinding>
        <binding name="wsHttp">
          <security mode="None">
            <transport clientCredentialType="None" />
            <message clientCredentialType="None" negotiateServiceCredential="false" establishSecurityContext="false" />
          </security>
        </binding>
      </wsHttpBinding>
      <basicHttpBinding>
        <binding name="basicHttp"/>
      </basicHttpBinding>
    </bindings>
    <behaviors>
      <serviceBehaviors>
        <behavior name="NorthwindBehavior">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <services>
      <service behaviorConfiguration="NorthwindBehavior" name="SampleApplicationWCF.Library.SupplierService">
        <endpoint binding="wsHttpBinding" bindingConfiguration="wsHttp" name="wsHttpSupplierService" contract="SampleApplicationWCF.Library.ISupplierService" />
      </service>
    </services>
  </system.serviceModel> 
```

# sql-server - 如何将 sql server express mdf 文件移动到不同的 sql server express 服务器？

> ID：302690
> 
> 赞同：1
> 
> 时间：2008-11-19T17:23:46.343
> 
> 标签：sql-server, sql-server-express

我正在尝试将我的 database.mdf 文件从开发环境移动到托管在我的 VPS 上的 SQL Server Express 服务器 - 但我不知道如何将文件附加到我的数据库服务器。帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T17:26:56.277

[`sp_attach_db`](http://msdn.microsoft.com/en-us/library/ms179877.aspx)（或 CREATE DATABASE FOR ATTACH） - 不要忘记带上 LDF（日志）文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T17:27:57.803

我不确定你是否可以，但你可以使用 Sql Studio Management Express，它允许你连接（然后附加）数据库。

您的应用程序也可以使用本地实例并直接连接到 app.data 文件夹中的 database.mdf。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-01T08:54:52.160

虽然可以使用分离/附加，但推荐的方法是使用备份/恢复（不要忘记：SQL Server 备份在线）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-04T04:36:51.247

这将帮助你

[http://support.microsoft.com/kb/224071](http://support.microsoft.com/kb/224071)

# ruby-on-rails - has_many_polymorphs 标记 - 适用于开发机器，不适用于生产！

> ID：302692
> 
> 赞同：0
> 
> 时间：2008-11-19T17:24:08.077
> 
> 标签：ruby-on-rails, has-many-polymorphs

我遇到了一个奇怪的问题，**在我的开发机器上标记工作正常**，但是当我部署到生产服务器时，我在日志中收到此错误：

```
ActionView::TemplateError (undefined method `tags' for #<Person:0x98bb9d4>) on line... 
```

production.log 文件中有一个条目指出 has_many_polymorphs 已加载，因此插件在生产机器上不可用。

我的 Google-fu 让我无法找到答案，所以如果有人知道可能出了什么问题，将不胜感激！

编辑：我应该提到在生产和开发中我使用的是同一个数据库。我下载了生产版本，并在开发机器上使用它，它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-19T17:54:11.573

上限部署：迁移

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T22:34:24.063

我见过与此类似的问题，其中多态类型字段未正确填写，或者在添加多态类型标记之前存在一些现有数据。人是子类吗？_type 字段是否包含多态表上的任何空值？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-03T10:49:41.660

在这里只是在黑暗中刺伤，但 has_many_polymorphs 并没有为您的模型本身添加标记功能。相反，您使用生成器来创建进入 lib/tagging_extensions.rb 的标记扩展模块。模块文件具有添加标记功能的辅助方法，这些方法建立在 has_many_polymorphs 基本功能之上。

那么，您是否有可能安装了插件，但没有安装标记扩展文件？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T14:26:49.707

我花了一些时间和一位顾问一起追踪这个问题，最终我们发现由于未知的原因，标记的东西没有被加载。

通过在 environment.rb 的末尾添加一行代码，只有三个字母，就解决了。我评论了它，以便我们永远不会忘记 wtf 正在发生的事情：

```
# Magic begins here.
# We need to force Rails to load the Tag record, or 
# has_many_polymorphs doesn't work properly. I don't know
# if there's a better fix, but this one seems reasonable. :-/
Tag 
```

就是这样。我确信对此有一个优雅而适当的解决方案，但这很有效。奇怪的。

我希望这可以帮助那里的人。

# .net - Visual Studio 2008 不会编辑只读文件

> ID：302700
> 
> 赞同：5
> 
> 时间：2008-11-19T17:26:22.033
> 
> 标签：.net, visual-studio, visual-studio-2008, ide

所以，直到今天，当我尝试在 VS2008 中编辑只读文件时，弹出一个对话框，给我三个选项：

*   在内存中编辑
*   使可写
*   保存副本

还有一个复选框，上面写着“从不允许内存编辑”。

突然间，它已停止提供这些选项，并且如果文件是只读的，则根本不会接受编辑器窗口中的任何输入。我必须进入 Windows 资源管理器并将文件标记为只读，然后在 VS 中重新打开它，然后才能进行任何更改。我正在做一个大型项目，有很多源代码控制文件，并且经常需要对文件进行本地更改，所以这是一个真正的 PITA。

我猜我一定是错误地选中了从不允许内存编辑复选框。

Tools.. Options.. Environment.. Documents 中有一个选项，内容如下：

“允许编辑只读文件，尝试保存时发出警告”

此复选框已勾选，当前更改其值无效。我试过关闭和打开工作室，重新启​​动我的机器等 - 都无济于事。

有谁知道如何恢复以前的行为？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-21T10:58:29.210

如果有人感兴趣，将以下注册表项重置为 0 将恢复以前的行为：

```
HKCU\Sofware\Microsoft\Visual Studio\9.0\Source Control\UncontrolledInMemoryEditDialogSuppressed 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-26T11:42:01.170

我在 Visual Studio 2010 中做了同样的事情。对话框的措辞并不完全清楚。这个问题（和 Winston 的解决方案）在 Visual Studio 2010 中是相同的。所以在注册表中将其设置为 0：

HKEY_CURRENT_USER\Software\Microsoft\Visual Studio\10.0\Source Control\UncontrolledInMemoryEditDialogSuppressed

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-28T20:09:25.097

在同一个注册表位置似乎还有其他注册表变量在起作用...

和以前一样，转到 HKEY_CURRENT_USER\Software\Microsoft\Visual Studio\10.0\Source Control\

并重置所有三个：

*   AllowUncontrolledInMemoryEditing
*   AllowInMemoryEditing
*   UncontrolledInMemoryEditDialogSuppressed

回到零。

（这似乎使我自己的编译器一直回到“出厂默认”行为。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T20:37:35.360

我今天刚遇到同样的问题，发现工具->选项->源代码控制中选择的源代码控制已更改。所以......您可能想要验证您选择的源代码控制系统是否符合您的预期。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-11-19T21:00:43.147

实际上，最合乎逻辑的做法是：

1.  如果 A 文件不打算被编辑，则将其标记为只读
2.  如果要编辑 A 文件**，**请将其标记为可写！

这部分是只读属性的*重点。*

如果您认为我在某种程度上错了，当然，请拒绝我，但是从逻辑上讲，其他所有人都应该同意我的观点，因为目前还不清楚为什么您需要以错误的方式使用事物。

在扩展解释之前，您的问题与抱怨为什么，当您删除某些内容时，您以后无法将其取回。

# .net - 空差

> ID：302701
> 
> 赞同：6
> 
> 时间：2008-11-19T17:26:27.947
> 
> 标签：.net

和有什么区别

```
if(null==object) 
```

和

```
if(object==null) 
```

请提供使用上述内容的优势。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-19T17:29:01.637

如果您不小心键入`=`而不是`==`：

`if (null = object)`- 编译器错误
`if (object = null)`- 错误！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-19T17:42:24.077

在过去的美好时光里，编译器很乐意让您在条件语句中进行赋值，从而导致意外错误：

```
if(a = false)
{
  // I'll never execute
}
if(b = null)
{
  // I'll never execute 
}
b.Method(); // And now I'm null! 
```

所以一些聪明的开发者开始把他们的常量放在他们的条件中：

```
if(false = a) // OOPS! Compiler error
{
  // ..
}
if(null = b) // OOPS! Compiler error
{
  // ..
} 
```

因此，他们训练自己避免出现一整类错误。大多数现代编译器将不再让您犯该错误，但这种做法仍在继续。

始终将常量放在首位还有另一个优点：

```
if(myString != null && myString.Equals("OtherString"))
{
  // ...
} 
```

可以（在 .NET、Java 和大多数具有基于对象的字符串类型的语言中）简化为：

```
if("OtherString".Equals(myString))
{
  // ..
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-19T17:34:16.683

好吧，这是我有点喜欢的东西......使用扩展：

```
public static class ObjectExtensions
{
    public static bool IsNull(this object target)
    {
        return null == target;
    }
} 
```

现在，您可以完全忘记它：

```
if(item.IsNull()) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-19T17:29:06.100

没有不同。(null == object) 是 C/C++ 的一种实践，其中“=”既用作赋值运算符，又用作比较运算符。

使用 if (object = null) 时错误太多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-19T17:29:09.907

有些人更喜欢`if (null == object)`这样，如果您不小心键入`=`而不是`==`，您会得到编译错误而不是赋值。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-19T17:29:36.067

*从逻辑上讲*，没有区别。

从*错误检查*的角度来看，第一个更可取，因为如果您错过了等号 ( `=`)，编译器会告诉您无法对常量进行赋值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T17:29:55.460

在许多语言中 == 是比较运算符 = 是赋值运算符。

当你真正的意思是 == 时，输入 = 非常容易。

因此，键入常量==变量的约定是首选。

constant=variable 不会编译，因此会向您显示您的错误。

variable=constant 将编译并在运行时做错事。

# replace - Smarty 用双引号替换文本

> ID：302718
> 
> 赞同：0
> 
> 时间：2008-11-19T17:32:11.273
> 
> 标签：replace, double, smarty, quotes

我在 smarty（php 模板系统）变量 $test 中有以下字符串：

```
<img height="113" width="150" alt="Sunset" src="/test.jpg"/> 
```

我想像这样将“em”添加到高度和宽度：

```
{$test|replace:'" w':'em" w'|replace:'" a':'em" a'} 
```

但这不起作用......问题和解决方案是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T18:34:30.740

您确实知道 HTML 宽度/高度属性中的“em”单位无效，对吧？那只是CSS。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T18:02:21.040

我的正则表达式不是最好的，或者我会给你一个更好的匹配器，但也许使用你通过正则表达式替换所拥有的东西会起作用。

```
{$test|regex_replace:'/".w/':'em" w'|regex_replace:'/".a/':'em" a'} 
```

其他匹配器尝试

```
'/\".w/'
'/".*w/'
'/\".*w/' 
```

我目前无法使用我的 smarty 网站，但我会先从替换值中删除 "，看看是否存在错误，然后将其从匹配器中删除，然后查找高度/宽度。

否则，如果可以的话，我会在 PHP 中进行替换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T18:18:04.017

使用[Aggiorno](http://www.aggiorno.com/smart-search-replace.aspx?so)的智能搜索和替换，您可以这样做：

搜索模式：

```
<img height="$h" width="$w" $attributes/> 
```

替换模式：

```
<img height="$[h]em" width="$[w]em" $attributes"/> 
```

当您单击“搜索”按钮时，所有匹配项都会在应用替换之前突出显示，以便您进行进一步检查，之后您可以自信地应用替换。

# nhibernate - 如何在 NHibernate 中删除子对象？

> ID：302720
> 
> 赞同：79
> 
> 时间：2008-11-19T17:33:15.547
> 
> 标签：nhibernate

我有一个父对象，它与子对象的 IList 有一对多的关系。删除子对象的最佳方法是什么？我不会删除父级。我的父对象包含一个子对象的 IList。这是一对多关系的映射：

```
<bag name="Tiers" cascade="all">
  <key column="mismatch_id_no" />
  <one-to-many class="TGR_BL.PromoTier,TGR_BL"/>
</bag> 
```

如果我尝试使用 clear() 从集合中删除所有对象，然后调用 SaveOrUpdate()，我会收到以下异常：

```
System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 
```

如果我尝试单独删除子对象然后将它们从父对象中删除，则会出现异常：

```
deleted object would be re-saved by cascade 
```

这是我第一次处理在 NHibernate 中删除子对象。我究竟做错了什么？

编辑：只是为了澄清-我不是要删除父对象，只是子对象。我在父母身上建立了一对多的关系。我是否还需要在子对象映射上创建多对一关系？

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2008-11-19T18:21:45.103

您收到第一个错误是因为，当您从集合中删除项目时，NHibernate 的默认操作模式是简单地破坏关联。在数据库中，NHibernate 尝试将子行上的外键列设置为空。由于您不允许该列中有空值，SQL Server 会引发错误。清除集合不一定会删除子对象，但这样做的一种方法是设置 cascade=all-delete-orphan。这通知 NHibernate 它应该删除新孤立的行而不是设置外键列。

您收到第二个错误，因为当您调用 SaveOrUpdate NHibernate 首先删除所有子对象。然后，因为两个关系都没有被标记为反向，NHibernate 还尝试将子表中的外键列设置为空。由于行已被删除，您会收到第二个错误。您需要在关系的一侧设置 inverse=true 来解决此问题。这通常在一侧（主键或父级）完成。如果您不这样做，NHibernate 将为关系的每一方进行适当的更新。不幸的是，运行两个更新不是合适的做法。

您应该始终将您的关系的一侧标记为相反的一侧。根据您的编码方式，您可能需要也可能不需要使用级联。如果您想在尝试使用 Clear() 时利用一次性删除，您需要定义您的级联。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-23T09:48:57.857

根据 Chuck 的回答，我通过在父侧映射中添加 Inverse = true 解决了我的问题：

Message 有很多 MessageSentTo：

```
[HasMany(typeof(MessageSentTo), Cascade = ManyRelationCascadeEnum.AllDeleteOrphan, Inverse = true)]
public IList<MessageSentTo> MessageSendTos
{
    get { return m_MessageSendTo; }
    set { m_MessageSendTo = value; }
} 
```

我正在使用 Castle ActiveRecord。谢谢查克。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T17:58:45.853

尝试使用 merge() 而不是 saveOrUpdate()。此外，请确保您的级联设置为 all-delete-orphan 并且您的父子关系是可逆的（父级上的 inverse=true，然后子级中的字段是具有 not-null=true 的父 ID） .

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-27T16:31:05.820

在我们的示例中，我们有许多产品的类别，其中产品不可为空。

您可以通过在刷新之前删除产品并将其从父集合中删除来解决此问题，但我们仍在寻找更好的解决方案。

```
product = pRepo.GetByID(newProduct.ProductID);
product.Category.Products.Remove(product);
pRepo.Delete(product); 
```

希望它无论如何都有帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T17:49:47.227

将级联属性值从“all”更改为“all-delete-orphan”。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-11-19T17:43:16.430

在导致问题的列上的映射中设置 Not-Null = true。我不确定确切的语法（对不起）。

# python - Python如何处理位于不同文件中的类，或者它们都应该在一个文件中

> ID：302729
> 
> 赞同：6
> 
> 时间：2008-11-19T17:37:25.817
> 
> 标签：python, oop

我正在开发用于测试一些命令行实用程序的框架。我想创建一些类来更轻松地保存不同类型的信息。

Python 对我来说相当新，所以我不确定你会如何处理这个问题。您是否将所有类与主脚本一起保存在一个文件中，或者您可以将它们分成自己的文件并在主脚本中使用它们。

您如何创建多个类并在单个脚本中使用它们的范例是什么？

**[我应该在一个文件中放入多少个 python 类](https://stackoverflow.com/questions/106896/how-many-python-classes-should-i-put-in-one-file)的副本**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T17:53:16.770

评论中重复问题的[答案](https://stackoverflow.com/questions/106896/how-many-python-classes-should-i-put-in-one-file#107836)似乎回答了我的问题。我现在的理解是，您可以将多个类添加到一个单独的文件中，然后将其称为模块。然后您可以导入该模块以使用您的类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T17:50:42.780

“您如何创建多个类并在单个脚本中使用它们的范例是什么？”

您是在询问[导入](http://docs.python.org/reference/simple_stmts.html#the-import-statement)声明吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T17:44:41.623

在有意义的情况下，我使用模块化方法将功能分散到单独的文件中。

# c# - 多少空检查就足够了？

> ID：302736
> 
> 赞同：66
> 
> 时间：2008-11-19T17:39:01.133
> 
> 标签：c#, java, c++, design-by-contract

当不需要检查空值时，有哪些指导**方针**？

我最近一直在处理的许多继承代码都带有令人作呕的空检查。对琐碎函数进行空检查，对声明非空返回的 API 调用进行空检查等。在某些情况下，空检查是合理的，但在许多地方，空值并不是一个合理的期望。

我听过很多论点，从“你不能相信其他代码”到“总是防御性地编程”再到“在语言保证给我一个非空值之前，我总是会检查”。在某种程度上，我当然同意其中的许多原则，但我发现过多的空值检查会导致其他通常违反这些原则的问题。顽强的空值检查真的值得吗？

我经常观察到带有过多空值检查的代码实际上质量较差，而不是质量较高。许多代码似乎过于关注空值检查，以至于开发人员忽略了其他重要品质，例如可读性、正确性或异常处理。特别是，我看到很多代码忽略了 std::bad_alloc 异常，但对`new`.

在 C++ 中，由于取消引用空指针的不可预测的行为，我在某种程度上理解了这一点；在 Java、C#、Python 等中，null 取消引用的处理更加优雅。我是否刚刚看到了警惕的 null 检查的不良示例，或者这真的有什么问题吗？

这个问题旨在与语言无关，尽管我主要对 C++、Java 和 C# 感兴趣。

* * *

我见过的一些似乎*过度*的空值检查示例包括以下内容：

* * *

这个示例似乎考虑了非标准编译器，因为 C++ 规范说失败的新编译器会引发异常。除非您明确支持不兼容的编译器，否则这有意义吗？这在 Java 或 C#（甚至 C++/CLR）等托管语言中*是否*有意义？

```
try {
   MyObject* obj = new MyObject(); 
   if(obj!=NULL) {
      //do something
   } else {
      //??? most code I see has log-it and move on
      //or it repeats what's in the exception handler
   }
} catch(std::bad_alloc) {
   //Do something? normally--this code is wrong as it allocates
   //more memory and will likely fail, such as writing to a log file.
} 
```

* * *

另一个例子是在处理内部代码时。特别是，如果是一个可以定义自己的开发实践的小团队，这似乎是不必要的。在某些项目或遗留代码中，信任文档可能不合理……但是对于您或您的团队控制的新代码，这真的有必要吗？

如果您可以看到并可以更新（或可以对负责的开发人员大喊大叫）的方法有合同，是否仍然需要检查空值？

```
//X is non-negative.
//Returns an object or throws exception.
MyObject* create(int x) {
   if(x<0) throw;
   return new MyObject();
}

try {
   MyObject* x = create(unknownVar);
   if(x!=null) {
      //is this null check really necessary?
   }
} catch {
   //do something
} 
```

* * *

在开发私有或其他内部函数时，当合约仅调用非空值时，是否真的需要显式处理空值？为什么空检查比断言更可取？

（显然，在您的公共 API 上，空值检查至关重要，因为向您的用户大喊不正确使用 API 被认为是不礼貌的）

```
//Internal use only--non-public, not part of public API
//input must be non-null.
//returns non-negative value, or -1 if failed
int ParseType(String input) {
   if(input==null) return -1;
   //do something magic
   return value;
} 
```

相比：

```
//Internal use only--non-public, not part of public API
//input must be non-null.
//returns non-negative value
int ParseType(String input) {
   assert(input!=null : "Input must be non-null.");
   //do something magic
   return value;
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-11-19T17:53:14.320

有一件事要记住，您今天编写的代码虽然可能是一个小团队并且您可以拥有良好的文档，但将变成其他人必须维护的遗留代码。我使用以下规则：

1.  如果我正在编写一个将公开给其他人的公共 API，那么我将对所有引用参数进行空检查。

2.  如果我正在为我的应用程序编写一个内部组件，当我需要在 null 存在时执行一些特殊的操作时，或者当我想使其非常清楚时，我会编写 null 检查。否则我不介意得到空引用异常，因为这也很清楚发生了什么。

3.  在处理来自其他人框架的返回数据时，我只在可能且有效地返回 null 时检查 null。如果他们的合同说它不返回空值，我不会进行检查。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-21T12:27:30.937

首先请注意，这是合同检查的一种特殊情况：您正在编写的代码除了在运行时验证是否符合记录的合同之外什么都不做。失败意味着某处的某些代码有问题。

对于实现更普遍有用的概念的特殊情况，我总是有点怀疑。契约检查很有用，因为它在第一次跨越 API 边界时捕获编程错误。空值有什么特别之处，这意味着它们是您要检查的合同的唯一部分？仍然，

关于输入验证：

null 在 Java 中是特殊的：许多 Java API 的编写使得 null 是唯一可以传递给给定方法调用的无效值。在这种情况下，空检查“完全验证”输入，因此支持合同检查的完整论点适用。

另一方面，在 C++ 中，NULL 只是指针参数可以采用的近 2^32 个（在较新的体系结构上为 2^64 个）无效值之一，因为几乎所有地址都不是正确类型的对象。除非您在某处拥有该类型所有对象的列表，否则您无法“完全验证”您的输入。

那么问题就变成了，NULL 是一个足够常见的无效输入来获得`(foo *)(-1)`没有得到的特殊处理吗？

与 Java 不同，字段不会自动初始化为 NULL，因此垃圾未初始化值与 NULL 一样合理。但有时 C++ 对象具有显式 NULL 初始化的指针成员，这意味着“我还没有”。如果您的调用者这样做，那么就会有一类重要的编程错误，可以通过 NULL 检查来诊断。对于他们来说，异常可能比他们没有源代码的库中的页面错误更容易调试。因此，如果您不介意代码膨胀，它可能会有所帮助。但是你应该考虑的是你的调用者，而不是你自己——这不是防御性编码，因为它只“防御” NULL，而不是 (foo *)(-1)。

如果 NULL 不是有效输入，您可以考虑通过引用而不是指针获取参数，但许多编码风格不赞成非常量引用参数。如果调用者传递给你 *fooptr，其中 fooptr 为 NULL，那么无论如何它对任何人都没有任何好处。您要做的是将更多文档压缩到函数签名中，希望您的调用者更有可能认为“嗯，fooptr 在这里可能为空吗？” 当他们必须显式取消引用它时，而不是将其作为指针传递给您。它只是到目前为止，但就它而言，它可能会有所帮助。

我不知道 C#，但我知道它就像 Java 一样，保证引用具有有效值（至少在安全代码中），但与 Java 不同的是，并非所有类型都有 NULL 值。所以我猜想空检查很少值得：如果你在安全代码中，那么不要使用可为空的类型，除非 null 是一个有效的输入，如果你在不安全的代码中，那么同样的推理适用于在 C++ 中。

关于输出验证：

出现了类似的问题：在 Java 中，您可以通过知道其类型来“完全验证”输出，并且该值不为空。在 C++ 中，您不能使用 NULL 检查“完全验证”输出 - 因为您知道该函数返回了一个指针，该指针指向它自己的堆栈上刚刚展开的对象。但是，如果由于被调用者代码的作者通常使用的结构，NULL 是一个常见的无效返回，那么检查它会有所帮助。

在所有情况下：

尽可能使用断言而不是“真实代码”来检查合同——一旦你的应用程序工作，你可能不希望每个被调用者检查其所有输入的代码膨胀，每个调用者检查它的返回值。

在编写可移植到非标准 C++ 实现的代码的情况下，而不是问题中检查 null 并捕获异常的代码，我可能会有这样的函数：

```
template<typename T>
static inline void nullcheck(T *ptr) { 
    #if PLATFORM_TRAITS_NEW_RETURNS_NULL
        if (ptr == NULL) throw std::bad_alloc();
    #endif
} 
```

然后，作为移植到新系统时要做的事情之一，正确定义 PLATFORM_TRAITS_NEW_RETURNS_NULL（可能还有其他一些 PLATFORM_TRAITS）。显然，您可以为您所知道的所有编译器编写一个头文件。如果有人拿了你的代码并在你一无所知的非标准 C++ 实现上编译它，那么他们基本上是靠自己的，原因比这更大，所以他们必须自己做。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-19T17:48:59.070

如果您编写代码及其合约，您有责任按照合约条款使用它并确保合约正确。如果你说“返回一个非空”x，那么调用者不应该检查空值。如果该引用/指针发生空指针异常，则说明您的合同不正确。

只有在使用不受信任或没有适当合同的库时，空值检查才应该走极端。如果是你的开发团队的代码，强调合约不能被破坏，并且在出现错误时追查错误使用合约的人。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-19T17:56:25.810

这部分取决于代码的使用方式——例如，如果它是仅在项目中可用的方法还是公共 API 中可用的方法。API 错误检查需要比断言更强大的东西。

因此，虽然这在一个受单元测试和类似东西支持的项目中很好：

```
internal void DoThis(Something thing)
{
    Debug.Assert(thing != null, "Arg [thing] cannot be null.");
    //...
} 
```

在您无法控制谁调用它的方法中，这样的方法可能会更好：

```
public void DoThis(Something thing)
{
    if (thing == null)
    {
        throw new ArgumentException("Arg [thing] cannot be null.");
    }
    //...
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-19T20:10:08.770

这取决于实际情况。我的其余答案假设 C++。

*   我从不测试 new 的返回值，因为我使用的所有实现都会在失败时抛出 bad_alloc。如果我在我正在处理的任何代码中看到新的返回 null 的旧测试，我会将其删除，并且不会费心用任何东西替换它。
*   除非心胸狭窄的编码标准禁止它，否则我会断言记录在案的先决条件。违反已发布合同的损坏代码需要立即且显着地失败。
*   如果 null 是由不是由于代码损坏引起的运行时故障引起的，我会抛出。fopen 失败和 malloc 失败（尽管我很少在 C++ 中使用它们）将属于这一类。
*   我不会尝试从分配失败中恢复。Bad_alloc 被 main() 捕获。
*   如果空测试是针对我班级的合作者的对象，我会重写代码以通过引用获取它。
*   如果协作者真的不存在，我使用[Null Object](http://en.wikipedia.org/wiki/Null_Object_pattern) 设计模式来创建一个占位符，以明确定义的方式失败。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-19T18:31:50.047

NULL 检查通常是邪恶的，因为它为代码可测试性添加了一个小的负面标记。到处都有 NULL 检查，你不能使用“pass null”技术，它会在单元测试时打击你。最好对方法进行单元测试而不是空检查。

查看 Misko Hevery 在[http://www.youtube.com/watch?v=wEhu57pih5w&feature=channel上关于该问题和一般单元测试的体面介绍](http://www.youtube.com/watch?v=wEhu57pih5w&feature=channel)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-19T20:23:59.303

旧版本的 Microsoft C++（可能还有其他版本）不会为通过 new 的分配失败抛出异常，而是返回 NULL。必须在符合标准的版本和旧版本中运行的代码将具有您在第一个示例中指出的冗余检查。

让所有失败的分配都遵循相同的代码路径会更干净：

```
if(obj==NULL)
    throw std::bad_alloc(); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-19T17:50:34.370

众所周知，有以过程为导向的人（专注于以正确的方式做事）和以结果为导向的人（得到正确的答案）。我们大多数人位于中间的某个地方。看起来您已经找到了面向过程的异常值。这些人会说“除非你完全理解事物，否则一切皆有可能；所以为任何事情做好准备。” 对他们来说，你所看到的都是正确的。对他们来说，如果你改变它，他们会担心，因为鸭子没有排好队。

在处理别人的代码时，我会尽量确保自己知道两件事。
1\. 程序员的意图
2\. 为什么他们以他们的方式编写代码

对于跟进 A 型程序员，也许这会有所帮助。

因此，“多少才够”最终成为一个社会问题，就像一个技术问题一样——没有商定的衡量方法。

（它也让我发疯。）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-19T17:55:53.767

当您可以指定正在使用哪个编译器时，对于诸如“新”之类的系统功能，检查 null 是代码中的错误。这意味着您将复制错误处理代码。重复的代码通常是错误的来源，因为经常有一个被更改而另一个没有。如果你不能指定编译器或编译器版本，你应该更加防御。

至于内部功能，您应该指定合同并确保通过单元测试执行合同。前段时间我们的代码中有一个问题，我们要么抛出异常，要么在数据库中缺少对象的情况下返回 null。这只是让 api 的调用者感到困惑，所以我们通过并使其在整个代码库中保持一致，并删除了重复检查。

重要的是（恕我直言）是没有重复的错误逻辑，其中一个分支永远不会被调用。如果你永远不能调用代码，那么你就不能测试它，你永远不会知道它是否被破坏。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-19T18:37:47.223

就我个人而言，我认为在绝大多数情况下，null 测试是不必要的。如果 new 失败或 malloc 失败，您会遇到更大的问题，并且在您没有编写内存检查器的情况下，恢复的机会几乎为零！此外，空测试在开发阶段隐藏了很多错误，因为“空”子句通常只是空的并且什么都不做。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-19T21:30:11.590

我会说这有点取决于你的语言，但我将 Resharper 与 C# 一起使用，它基本上不会告诉我“这个引用可能是空的”，在这种情况下我添加一个检查，如果它告诉我“这个对于“if (null != oMyThing && ....)”，将永远为真”，然后我会听它而不测试 null。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-20T15:13:52.223

是否检查 null 很大程度上取决于具体情况。

例如，在我们的商店中，我们检查我们在方法内为 null 创建的方法的参数。原因很简单，作为最初的程序员，我很清楚该方法应该做什么。即使文档和要求不完整或不太令人满意，我也能理解上下文。后来负责维护的程序员可能不理解上下文，并且可能错误地认为传递 null 是无害的。如果我知道 null 是有害的，并且我可以预料到有人可能会传递 null，我应该采取简单的步骤来确保该方法以一种优雅的方式做出反应。

```
public MyObject MyMethod(object foo)
{
  if (foo == null)
  {
    throw new ArgumentNullException("foo");
  }

  // do whatever if foo was non-null
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-11-21T19:54:29.177

我只在看到 NULL 时知道该怎么做时才检查 NULL。“知道该怎么做”在这里意味着“知道如何避免崩溃”或“知道除了崩溃的位置之外要告诉用户什么”。例如，如果 malloc() 返回 NULL，我通常别无选择，只能中止程序。另一方面，如果 fopen() 返回 NULL，我可以让用户知道无法打开的文件名，可能是 errno。如果 find() 返回 end()，我通常知道如何继续而不崩溃。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-19T18:05:45.650

较低级别的代码应该从较高级别的代码中检查使用。通常这意味着检查参数，但也可能意味着检查来自上行调用的返回值。不需要检查 Upcall 参数。

目的是以直接和明显的方式发现错误，并用不撒谎的代码记录合同。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-19T21:24:04.410

我不认为这是*糟糕*的代码。相当数量的 Windows/Linux API 调用在某种失败时返回 NULL。所以，当然，我以 API 指定的方式检查失败。通常我会以某种方式将控制流传递给错误模块，而不是复制错误处理代码。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-11-20T14:40:35.470

如果我收到一个语言不保证不为 null 的指针，并且将以 null 会破坏我的方式取消引用它，或者将我的函数放在我说不会产生 NULL 的地方，我检查 NULL。

这不仅仅是关于 NULL，如果可能，函数应该检查前置条件和后置条件。

如果给我指针的函数的合同说它永远不会产生空值，这根本不重要。我们都会制造错误。有一个很好的规则，一个程序应该尽早失败并且经常失败，所以与其将错误传递给另一个模块并让它失败，我会失败。在测试时使事情变得更容易调试。此外，在关键系统中，更容易保持系统健全。

此外，如果异常从 main 中逃脱，堆栈可能不会被卷起，从而阻止析构函数运行（请参阅有关 terminate() 的 C++ 标准）。这可能很严重。因此，不检查 bad_alloc 可能比看起来更危险。

断言失败与运行时错误失败是完全不同的话题。

如果标准 new() 行为未更改为返回 NULL 而不是抛出，则在 new() 之后检查 NULL 似乎已过时。

还有一个问题，即使 malloc 返回了一个有效的指针，也不意味着你已经分配了内存并且可以使用它。不过那是另一回事了。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-09-20T07:04:56.033

我的第一个问题是，它会导致代码中充斥着空检查等。它损害了可读性，我什至会说它损害了可维护性，因为如果你正在编写一段代码，其中某个引用确实不应该为空，那么很容易忘记空检查。而且您只知道在某些地方会缺少空检查。这实际上使调试比需要的更难。如果原始异常没有被捕获并替换为错误的返回值，那么我们将获得一个有价值的异常对象，其中包含信息丰富的堆栈跟踪。缺少的空检查会给您带来什么？一段代码中的 NullReferenceException 让你走：wtf？这个引用永远不应该为空！

因此，您需要开始弄清楚代码是如何被调用的，以及为什么引用可能为空。这可能会花费大量时间，并且确实会影响调试工作的效率。最终你会找出真正的问题，但很可能它被隐藏得很深，你花费了比你应该花更多的时间来寻找它。

到处都有空检查的另一个问题是，一些开发人员在收到 NullReferenceException 时并没有真正花时间正确考虑真正的问题。实际上，我已经看到不少开发人员只是在发生 NullReferenceException 的代码上方添加了一个空检查。太好了，异常不再发生！欢呼！我们现在可以回家了！嗯……“不，你不能，你应该用肘部抵住脸”怎么样？真正的错误可能不再导致异常，但现在您可能有缺失或错误的行为......而且没有异常！这更加痛苦，并且需要更多时间来调试。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-03-25T01:48:05.170

起初，这似乎是一个奇怪的问题：`null`支票很棒，而且是一种有价值的工具。检查`new`退货`null`绝对是愚蠢的。我将忽略一个事实，即有些语言允许这样做。我敢肯定有正当的理由，但我真的不认为我可以处理生活在那个现实中:)所有的开玩笑，看起来你至少应该指定当没有足够的内存时`new`应该返回`null`.

无论如何，检查`null`适当的地方会导致代码更清晰。我什至会说永远不要为函数参数分配默认值是下一个合乎逻辑的步骤。更进一步，在适当的地方返回空数组等会导致代码更简洁。不必担心得到`null`s 是很好的，除非它们在逻辑上有意义。最好避免将空值作为错误值。

使用断言是一个非常好的主意。特别是如果它让您可以选择在运行时关闭它们。另外，这是一种更明确的合同风格:)

# cell - 在 BIRT 中，如何从单元的事件脚本块中访问单元的子项

> ID：302741
> 
> 赞同：2
> 
> 时间：2008-11-19T17:40:08.107
> 
> 标签：cell, reporting, birt

我在[BIRT](http://www.eclipse.org/birt/phoenix/)中动态创建图像并将它们添加到网格的单元格中。网格是 List 的一部分，它遍历数据源中的记录。

我希望能够在每条记录的基础上修改图像的属性。具体来说，我正在更改边距 - 但我的问题是我找不到访问单元格内容的方法。

我希望我可以在单元格的**`onRender`**函数中使用“this”关键字，它会为我提供[访问单元格内容的句柄](http://www.birt-exchange.com/documentation/BIRT_220/EngineJavadoc/model/api/org/eclipse/birt/report/model/api/CellHandle.html#getContent())。

这个函数似乎不起作用——它显然是不同的对象类型。

如何访问单元格的单个实例的子代？

# c++ - 将混合数据文件读入 C++ 字符串

> ID：302742
> 
> 赞同：0
> 
> 时间：2008-11-19T17:40:57.200
> 
> 标签：c++, stl

我需要使用 C++ 读取带有空格的文本，然后是一个数值。

例如，看起来像这样的数据：

```
text1
1.0
text two 
2.1
text2 again
3.1 
```

不能用 2 个`"infile >>"`语句读入。我也没有运气`getline` 。我最终想`struct`用这两个数据元素填充 a 。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T18:19:05.907

为什么？您可以使用 getline 提供空格作为行分隔符。如果下一个是数字，则缝合提取的部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T18:33:38.810

标准 IO 库不会单独为您执行此操作，您需要对数据进行某种简单的解析以确定文本在哪里结束以及数值从哪里开始。如果您可以做出一些简化的假设（例如说每行只有一个文本/数字对，并且错误恢复最少），那么将整个内容 getline() 变成一个字符串然后手动扫描它也不会太糟糕。否则，您最好使用正则表达式或解析库来处理这个问题，而不是重新发明轮子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T18:18:06.000

如果您可以确定输入格式正确，则可以尝试以下示例：

```
#include <iostream>
#include <sstream>

int main()
{
    std::istringstream iss("text1 1.0 text two 2.1 text2 again 3.1");

    for ( ;; )
    {
        double x;
        if ( iss >> x )
        {
            std::cout << x << std::endl;
        }
        else
        {
            iss.clear();
            std::string junk;
            if ( !(iss >> junk) )
                break;
        }
    }
} 
```

如果您确实必须验证输入（而不仅仅是尝试从中解析任何看起来像 double 的内容），您将不得不编写某种解析器，这并不难，但很无聊。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T21:27:28.037

伪代码。

这应该有效。但是，它假设您有成对的文本/数字。你也必须做一些调整才能让所有的打字都开心。

```
while( ! eof)
   getline(textbuffer)
   getline(numberbuffer)
   stringlist = tokenize(textbuffer)
   number = atof(numberbuffer) 
```

# javascript - jQuery表格排序问题

> ID：302749
> 
> 赞同：16
> 
> 时间：2008-11-19T17:43:31.703
> 
> 标签：javascript, jquery, html, sorting, tablesorter

我在使用 JQuery [tablesorter](http://tablesorter.com/docs/)插件时遇到了一些问题。如果单击列标题，它应该按此列对数据进行排序，但有几个问题：

1.  行未正确排序（1、1、2183、236）
2.  总行包含在排序中

关于（2），我不能轻易地将总行移动到表页脚，因为 HTML 是由我控制有限的[displaytag标记库生成的。](http://displaytag.sourceforge.net/11/)

关于（1），我不明白为什么排序不起作用，因为我使用了与[tablesorter tutorials](http://tablesorter.com/docs/#Getting-Started)中最简单示例中显示的完全相同的 JavaScript 。

其实只有一行JS代码，就是：

```
<body onload="jQuery('#communityStats').tablesorter();"> 
```

在此先感谢，唐

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-19T18:12:58.943

第一个问题是由于表格排序器自动将列检测到“文本”列（可能是因为空单元格）。要解决此问题，请使用此代码初始化表格排序器并根据数据将所有字段设置为数字或货币：

```
<script type="text/javascript" >
jQuery(document).ready(function() 
{ 
    jQuery("#communityStats").tablesorter({ 
        headers: { 2: { sorter:'digit' } , 
                   3: { sorter:'digit' } ,
                   4: { sorter:'digit' } ,
                   5: { sorter:'digit' } ,
                   6: { sorter:'digit' } ,
                   7: { sorter:'digit' } ,
                   8: { sorter:'currency' } ,
                   9: { sorter:'currency' } ,
                   10: { sorter:'currency' } ,
                   11: { sorter:'currency' } 
                 } 
    }); 
});
</script> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-19T18:10:22.007

我建议使用一些 Javascript 从表中删除最后一行。添加页脚，然后重新添加从表中删除的行。要解决数字单元格中的空数据问题，您可能需要添加自己的[自定义解析器](http://tablesorter.com/docs/example-parsers.html)。

```
 $(function() {
       $('#communityStats').append("<tfoot></tfoot>");
       $('#communityStats > tr:last').remove()
                                     .appendTo('#communityStats > tfoot');
       $('#communityStats').tablesorter();
   }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T18:00:48.000

我*认为*＃1的答案是您有一些数字列的空白字段导致表格排序器将该列检测为“字符串”列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T18:04:05.453

1.  空白字段可能是一个问题（例如，它们不是 0），尝试使用自定义解析器删除任何非数字并将值强制为整数（例如： http: [//paste.pocoo.org/show/90863/](http://paste.pocoo.org/show/90863/)）

2.  将您的“总计”行放在表格末尾之前的 <tfoot> </tfoot> 标记内

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T18:27:08.610

我发现以下内容适用于无法识别的数字（数字）列。当前版本（2.0.3）的tablesorter似乎将0视为文本。

包括来自 tvanfosson 的示例，页面底部的此脚本会将您的最后一行从页脚中移出，这会阻止它使用 tbody 中的数据进行排序，并会强制排序器使用数字排序而不是文本排序它是按照你的描述使用。

```
$(document).ready(function() {
  $('#communityStats').append("<tfoot></tfoot>");
  $('#communityStats > tr:last').remove()
    .appendTo('#communityStats > tfoot');

  $("#communityStats").tablesorter({
     debug: true,
     headers: { 
       0:{sorter: 'digit'}
       ...
       10:{sorter: 'digit'}
     }
  });

}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-17T12:18:26.380

tablesorter 插件的固定标头：

**css**

```
table.tablesorter thead {
position: fixed;
top: 35px; // 
} 
```

**JS**

```
function tableFixedHeader() {
   var tdUnit = $('.tablesorter tbody tr:first').children('td').length;
   for(var i=0;i<tdUnit; i++) {
     $('.tablesorter thead th').eq(i).width($('.tablesorter tbody td').eq(i).width());
   }
   $('.tablesorter').css('margin-top',$('.tablesorter thead').height()); 
} 
```

**HTML**

```
<div id="container">
   <div id="topmenu" style="height:35px;">some buttons</div>
   <div id="tablelist" style="width:100%;overflow:auto;">
      <table class="tablesorterw">.....</table>
   </div>
</div> 
```

# shipping - 计算加州销售税

> ID：302759
> 
> 赞同：11
> 
> 时间：2008-11-19T17:47:43.160
> 
> 标签：shipping, sales-tax

我正在开发的其中一个网络应用程序有一个相当小的网络商店/购物车。由于客户公司实际位于加利福尼亚州并在那里有实际位置，因此他们需要对运往加利福尼亚州的所有订单征收加利福尼亚州销售税。

对于那些不知道的人，CA 有一些相当复杂的销售税规则，基本上，任何地方团体都可以创建一个“税区”，并在全州 7.25 的基数之上利用额外几美分的销售税%。（通常少于 1% 的额外费用。）这些地区不必映射到任何其他立法边界，因此您可以最终让半个城市支付额外的 0.25% 销售税，例如。

从技术上讲，法律只要求您作为卖家在您所在地区收取销售税 - 所以，如果我在萨克拉门托有一家商店，我只需要对所有发货的订单收取萨克拉门托销售税。

但是，由于各种会计和纳税申报原因，实际上收取订单发货地点的销售税更*容易*。（这意味着每个订单都可能有不同的销售税。）

所以 - 我的问题。有谁知道任何巧妙的计算方法？您实际完成工作所需的数据都可以在州均衡委员会网站上以各种半有用的格式获得，我们正在拼凑一个小部件，试图根据城市名称和邮政编码。但是，我想知道是否有人遇到过任何很酷的工具来解决这个问题。（或者任何工具，就此而言。）

（我们使用的是 VB 和 ASP.net，但我会对任何语言的解决方案感兴趣，主要是因为我很想看看其他人是如何解决这个问题的。）

附录 - 从下面回答一些问题：

蒂姆问这怎么可能“更容易”。有人告诉我，以这种方式缴纳销售税可以让您更轻松地填写纳税申报表。我对细节很模糊，但据我了解，如果您不收取送货地点的费率，您必须证明为什么您没有在年底为每个订单收取费用 - 即，您必须证明不，我们住*在这里*而不是*那里*，所以我们在这里收取费用*。*

然而，如果您总是收取目的地费率，您可以（显然）将您全年收取的销售税总额写在一行上，并说“销售税就是这么多。

看起来国家并不关心你做什么。所以，我所说的“更容易”，真正的意思是“对会计师来说更容易”——这对我们编程团队来说当然一点也不容易。

此外，Schnapple 的德克萨斯故事是一个潜在的解决方案。（事实上​​，我今天早上提出了这个想法。）CA 真的不在乎你是否多收销售税，只要你不少收并交出你收集的所有东西。这里的问题是，与德克萨斯州（显然）不同的是，加利福尼亚州的大片地区不在特殊税区。因此，虽然我们*可以*为每个人收取最高级别​​的费用（我认为目前是 8.75），但大多数客户会介意不玩正常的 7.25 费率。我想我不能责怪他们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T20:05:18.857

德克萨斯州做了类似的事情——州税为 6.25%，然后有 1% 的地方税（例如，特定县或其他东西）和 1% 的额外“公共交通”税。最终结果是，当你去德克萨斯州的某个地方时，你需要支付 8.25% 的销售税。8.25% 是最大值。理论上可能有一些地区不征收地方税，但我从来没有遇到过。理论上，地方税可能超过 1%，导致公共交通税低于 1%，但我又从未见过。

几年前，当我还是一个小企业的合伙人，我们在网上卖东西（可下载的数据文件）时，我参加了一个由国家举办的小型研讨会，向我们解释税收。由于当时我在一个小镇，当地的电视新闻报道了这一事件（这是一个无聊的小镇）。

我或其他人曾经问过“你知道，因为计算所有这些税费很复杂，而且往往是 8.25%，我们不能只向每个人收取 8.25% 的费用然后寄给你吗？

主持研讨会的人问摄制组，“那东西在拍吗？”

剧组一说不，他就说“是的，你可以这样，我们不会有任何问题”

当时提交销售税的表格不够具体，无法区分物品在该州的去向，所以我们只向德克萨斯州的每个人收取 8.25% 的费用，对德克萨斯州以外的所有人收取任何费用，每个人都很高兴。

所以你可能会因为加利福尼亚并不真正关心的事情而背叛......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T18:03:20.930

我同意这非常复杂。[Sabrix](http://www.sabrix.com/)是另一个为中小型公司提供托管税务服务以及大型企业解决方案的第三方资源。不确定定价模型是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T22:22:12.123

我的实施是针对零售点的，但它可以适应基于 zip 的解决方案。由于退货和退货可能来自其他税区，销售点登记必须具有完整的税收规则定义。

我们的交易支持无限数量的税收管辖区。每个税收管辖区都提供了一种基于表格概念计算税收的方法，就像所得税一样。该软件将识别所有起作用的司法管辖区并计算适当的税收。

例如，纽约对单件价格超过 110 美元的单件商品征收奢侈品税（对前 109.99 美元征收该税率是累退税），当地县有税，因此我们能够定义：

```
Auth  Start$  End$    Rate  Base    
NY    0       109.99  0%    $0.00
NY    110.00  -       4%    $4.40
NYALB 0       -       4%    $0.00 
```

因此，在奥尔巴尼销售 50.00 美元的商品会产生 2 美元的 4% 税——NYALB 税率为 4%，而纽约税率为 0%。120.00 美元的销售导致 9.60 美元的有效 8% 税——NYALB 税率为 4%，NY 税率为 4%，金额等于或超过 110 美元 + 4.40。

科罗拉多州有一个拥有 PIF 税的乡镇，除了州和县税之外，它本身也是应税的。

爱达荷州根据 0.002 规则进行舍入 - 如果计算的税款为 4.002，则应缴税款为 4.01。一些司法管辖区总是四舍五入。对于每个司法管辖区，我们附加了一个四舍五入规则以进一步处理税收：向上、向下、0.005 和 0.002。

如果您有兴趣维护自己的税收规则，我发现以这种方式组织税收数据是最灵活的。

但就像已经提到的几个人一样，有一些服务可以为您提供税务数据。你只需要弄清楚如何整合它。

编辑：税收假期......我们也支持这一点，只是添加了一个单独的表格，其中包含司法管辖区假期的开始和结束日期。在这些日期，税收引擎只会吐出零。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-14T21:17:34.053

我今天一直在为我最近开始在线销售的公司研究这个问题。CA BOE 按城市而不是邮政编码列出税率。税区是市/县，所以这是有道理的。

从编程的角度来看，如果任何州根据邮政编码征税，我实际上会感到惊讶，因为邮政编码可以包括多个城市/县甚至州。但是，如果您想考虑这种可能性，那么我会创建一个表格，列出城市、县、州、邮政编码和税率。然后按城市、州和邮政编码查找该表。您可能会得到一个结果，但在多个结果的情况下使用最高比率。将城市、州和税率设为必填字段，其余字段可选。

您还需要能够导入数据文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T19:50:34.490

我在以前的工作中使用[Vertex](http://www.vertexinc.com)进行 iSeries 上托管的邮购操作。我们将它连接到我们的订购系统中。

Vertex 使用[地理编码](http://en.wikipedia.org/wiki/Geocoding)来确定销售税。五位数的邮政编码不足以准确定位加利福尼亚等地的销售税。有一些特殊的经济开发区（如新商场）可以有自己的税收。因此，税收可能只适用于一个特定地址（对于商场）。

随着税收的颁布或更改，Vertex 会定期发布更新。此外，如果有免税期，您可能必须进入 Vertex 表格以在一段时间内关闭税收。

Alram 公司通过所有销售渠道实现了 3 亿美元的销售额。没有关于价格的线索。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-24T18:36:41.663

efileSalesTax.com 是一个基于网络的系统，用于提交加州销售税申报表。只需输入总销售额和非应税销售额（如果有的话），系统就会计算整个表格并以电子方式向州政府提交申报表。每次申请 6.95 美元，批量购买申请可享受折扣，无限制申请/无限制纳税人每年 199 美元。

他们还支持佛罗里达州、伊利诺伊州和科罗拉多州的销售税。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T17:54:48.043

对于这些不断变化的规则，第三方资源几乎是必不可少的。

[这是一个。](http://www.avalara.com)那就是SaaS。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-19T22:18:17.497

“从技术上讲，法律只要求您作为卖家收取您所在地区的销售税——所以，如果我在萨克拉门托有一家商店，我只需要对所有发货的订单收取萨克拉门托的销售税。

但是，由于各种会计和纳税申报原因，实际上收取订单发货地点的销售税更容易。（这意味着每个订单都可能有不同的销售税。）”

其他人在这里看到矛盾吗？对我来说，只使用卖家的位置并完成它是微不足道的 - 特别是如果这满足了国家为什么要打扰它。您关于“充电实际上更容易......”的评论是不正确的 - 如果更容易，您就不会问这个问题。

只是我的观点

另外——如果这是礼物呢？购买者不是发货地址，也不是购买地点。在我看来（仍然）最好只使用一个已知的位置，如果它满足状态。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-27T19:19:55.997

我将讨论纽约税收以及我如何实施我的代码来处理通过 POS 收取的税款并跟踪到税务报告。许多原则将适用于许多州。

首先有一个“税收管辖区”，猜猜这不一定意味着“县”或“城市”，绝对不是“邮政编码”，但我很确定它总是包括“州”。所以我们需要一个“税收管辖权”的数据库表。需要此税务管辖区来报告在 NYS-100 上收取的销售税。因此，您必须对其进行跟踪以使其正确。如果我在罗切斯特和布法罗有一家商店，我需要跟踪在地方一级和州一级征收的税款，以便正确处理季度税表。所以销售发票需要获取税务管辖区的id。

例如，这里是纽约的税收管辖区，这是从 nys-100 中提取的，销售税报告 .pdf，但以一种实际有用的形式： [http ://embrasse-moi.com/exampleData/new_york_tax_jurisdictions.csv](http://embrasse-moi.com/exampleData/new_york_tax_jurisdictions.csv)

作为一个社区，我们需要的是所有 50 个州的相同数据。

所以店内销售相对容易，我有州税和地方税要跟踪。不幸的是，我们应该根据纽约的运输目的地征税，这意味着我们基本上需要数据库中的所有“税收管辖区”都是正确的。税率的差异通常不超过 0.75%，但在考虑豁免时可能会增加，因此，如果审计涉及费用，则绕过添加所有当地税率，我们将赌博并使用 4% 的默认税率很可能会低于全面税率实施和维护的成本，但这取决于您的数量。

接下来，费率可能会发生变化。所以你需要一个 db 表来指定税率的开始日期，以及适用于什么税收管辖区。

接下来，有与税收类别相对应的“豁免”。我们销售服装，通常对“服装和鞋类”给予豁免。因此，您需要一个用于税收类别的数据库表。我在我的产品类别中放置了一个默认税收类别 ID，然后在添加新产品时将默认税收类别写入产品。

现在您可以添加您的税率。我有一个表格来添加州税率并将其保存在我的日期特定 tax_rate db 表中的唯一列中。我有另一种形式来添加当地税率，再次放入同一个 tax_rate 表中。此税率特定于某个税种。

例如，我为纽约州添加了 4% 的税率，从 1-1-1900 开始，适用于所有税种。然后我添加了所有税收管辖区，我编写了从上面的文件中提取数据的脚本，再次开始日期 1-1-1900，上面文件中的税率。适用于所有类别。

然后您需要对免税类别执行相同的操作，州和所有地方税收管辖区为 0%。

然后我们添加豁免。现在这实际上要容易一些，因为豁免是在州一级，只有少数几个 tax_jurisdictions 支持豁免。所以我添加了纽约，从 2011 年 4 月开始为服装类别的最大值为 55 美元然后我添加了纽约，从 2011 年 10 月开始为服装类别添加了 4%（这覆盖了豁免）然后我添加了纽约，从 4 月开始为 0% 2012 年服装类别最高价值 110 美元。

现在我也应该为每个地方税收管辖区这样做，但就像我说的，只有少数几个提供豁免，但功能就在那里。

最后，在运输时，您需要到达税务管辖区。这是不可能发生的地方，但是对于我的 POS 系统，我必须询问“县”，因为这将是最容易理解的选择。在纽约.. 当然.. 纽约市是布朗克斯县、皇后县、布鲁克林（有时称为其他）县和其他县的税务管辖区，所以当有人提到 Burroughs 之一时，您就会知道税收管辖区是“纽约市”，或者添加另一个 db 表来查找县到税收管辖区，老实说，这更正确，我可能应该这样做。

因此，当您计算产品的税金时，您会获取售价、产品税种、州 ID 和税收管辖区 ID（以及日期，假设不是现在）。您查询您的税率数据，按日期列出，然后查看每个项目并找到第一个有效的项目。如果什么也没找到，我已经设置了默认税率，以防未输入当地税收管辖区。将有许多 if 语句来完成它。

# c++ - 为什么 Visual C++ 不会在特定函数中遇到断点或单步执行？

> ID：302768
> 
> 赞同：4
> 
> 时间：2008-11-19T17:51:19.300
> 
> 标签：c++, visual-studio, breakpoints

我有以下内容：

```
classA::FuncA()
{
 ... code
   FuncB();
 ... code
}

classA::FuncB(const char *pText)
{
    SelectObject(m_hDC, GetStockObject (  SYSTEM_FONT)); 
    wglUseFontBitmaps(m_hDC, 0, 255, 1000); 
    glListBase(1000); 
    glCallLists(static_cast<GLsizei>(strlen(pText)), GL_UNSIGNED_BYTE, pText); 
} 
```

我可以在 FuncA 的任何地方打断点。如果我尝试进入 FuncB，它就会跳过。它将接受 FuncB 中的断点，但从不命中它。我知道它正在执行 FuncB，因为我可以在 FuncB 中调用 MessagBox() 并获取消息框。

在远离大量 VC6 使用几年之后，我是 VS2005 的新手。我在 VC6 的日子里回忆起的一种情况是，如果符号信息不可用。但是，在这种情况下，两个函数都在同一个文件中，因此符号信息必须正确。同样在那种情况下，我认为您甚至无法设置断点。

我已经尝试了所有愚蠢的巫术，比如重建整个解决方案。

我忽略了什么愚蠢的事情？

编辑：添加了 FuncB 的代码，以回应关于它可能基本上可以内联的评论。（这只是来自 MSDN 的 wglUseFontBitmaps [减去此处的注释] 的确切示例代码）。我看不出内联会如何阻碍每次调用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T18:07:05.307

确保禁用所有编译器优化 (/Od)。编译器优化可能会导致调试器断点出现问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-19T18:08:04.430

不确定问题是什么，但您可能会尝试的一件事是查看反汇编代码。您可以使用 VS 在源代码和禁用视图之间切换。我在工作中没有 IDE，所以这些条款可能略有不同。

如果将调试器置于此模式，您可以看到正在执行的汇编指令。这有时有助于确定这类问题。有时，尽管通常不使用调试版本，但编译器会优化调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T18:03:20.617

如果一切都失败，请尝试更新到 VS2005 SP1（如果您还没有）...

听起来确实很奇怪！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T19:33:59.310

感谢您发布代码。这显然不是我的猜测。

* * *

为了后代，为了澄清事情，我的猜测是，如果（1）函数是一行，（2）编译器内联函数，那么（3）调试器可能不知道如何进入它。这种猜测依赖于这样一个事实，即[某些调试器在内联代码和其他编译器优化方面确实存在问题](http://gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html)。我对 Visual Studio 的调试器不够熟悉，无法说出它是否在该列表中。

> 在大多数使用 stabs 格式的系统上，-g 允许使用只有 GDB 可以使用的额外调试信息；这些额外的信息使 GDB 中的调试工作更好，但可能会使其他调试器崩溃或拒绝读取程序。...
> 
> GCC 允许您将 -g 与 -O 一起使用。优化代码所采取的捷径有时可能会产生令人惊讶的结果：您声明的某些变量可能根本不存在；控制流可能会短暂地移动到您没有预料到的地方；某些语句可能无法执行，因为它们计算常量结果或它们的值已经在手边；有些语句可能在不同的地方执行，因为它们被移出循环。

GCC 手册曾经有一个声明，即某些编译器会拒绝在优化代码中发出调试符号，因为它们的调试器无法遵循它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T11:18:30.847

实际上我有一个类似的问题，发现当我运行程序时代码没有被编译，所以在你尝试运行它之前确保你“编译”了程序

# java - 多线程访问文件

> ID：302769
> 
> 赞同：11
> 
> 时间：2008-11-19T17:52:24.587
> 
> 标签：java, multithreading

我们有一个多线程的java程序。多线程将写入一个文件，一个线程将从该文件中读取。我正在寻找一些设计理念。是否需要同步？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-20T11:15:24.060

[FileChannel](http://docs.oracle.com/javase/7/docs/api/java/nio/channels/FileChannel.html)理论上是线程安全的。从javadoc：

> 多个并发线程可以安全地使用文件通道。按照 Channel 接口的规定，可以随时调用 close 方法。在任何给定时间，只有一项涉及通道位置或可以更改其文件大小的操作正在进行；在第一个操作仍在进行时尝试启动第二个此类操作将阻塞，直到第一个操作完成。其他操作，特别是那些采取明确立场的操作，可以同时进行；他们是否真的这样做取决于底层实现，因此未指定。

如果您可以使用这些，那么您可以使用内置的同步，而不必自己编写。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-19T18:01:48.843

在这种情况下，我会考虑同步。想象一下，2 个线程（t1 和 t2）同时打开文件并开始写入。第一个线程执行的更改被第二个线程覆盖，因为第二个线程是最后一个将更改保存到文件的线程。当线程 t1 正在写入文件时，t2 必须等到 t1 完成它的任务才能打开它。

此外，如果您关心文件的最新可能更新，您应该将写入线程与读取文件的线程同步，以便如果有任何线程写入文件，读取线程应该等待。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T18:44:10.003

如果同步并不重要，您可以让编写器在自己的线程中运行，并允许其他线程排队写入文件。虽然我认为首先要考虑的是写入文件是否真的是你想要做的。尤其是在高流量情况下，拥有大量磁盘 I/O 可能效率不高。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T18:21:53.653

如果您想要多个读者和一个作家，您将寻找[读写锁](http://en.wikipedia.org/wiki/Read_write_lock_pattern)或读写互斥锁。

但是你需要多个作者和一个读者。你怎么知道这些作家不会覆盖彼此的数据？他们以某种方式被隔离了吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T18:04:20.130

一旦多个线程访问共享数据，则需要同步。如果多个线程在没有某种形式的锁定的情况下写入同一个文件，那么您最终可能会遇到更新丢失的问题。

读取在所有情况下都不是一个大问题，因此您需要考虑...如果一个线程正在读取文件并且同时另一个线程更新文件，读取线程是否需要知道更改？如果是这样，您还需要为读取线程锁定文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T18:15:42.293

如果你有读者和作家或作家和作家的混合，你需要同步（锁定）。如果您只有阅读器，则不需要任何同步。

您不希望两个进程写入同一个文件或一个进程写入另一个正在读取的文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-27T03:29:01.593

在这种情况下，同步是必要的。FileChannel 对于防止文件被 JVM 之外的进程修改很有用：对于包含多个线程写入单个文件的应用程序则不然。从（进一步向下） FileChannel 的 JavaDoc：

> 文件锁代表整个 Java 虚拟机持有。它们不适用于控制同一虚拟机内的多个线程对文件的访问。

有关在线程之间共享文件写入的策略的简要讨论，请参阅[这篇文章。](http://www.java-forums.org/advanced-java/14646-filelock-file-access-concurrent-threads.html)

# c# - 在代码中从 c# 调用网页

> ID：302775
> 
> 赞同：16
> 
> 时间：2008-11-19T17:54:14.707
> 
> 标签：c#, asp.net, .net-2.0

我需要一种从我的 .net 应用程序中调用网页的方法。

但我只想向页面发送请求而不担心响应。

由于有时响应可能需要一段时间，所以我不希望它挂起应用程序。

我一直在尝试 page_load 事件

```
WebClient webC = new WebClient();
Uri newUri = new Uri("http://localhost:49268/dosomething.aspx");
webC.UploadStringAsync(newUri, string.Empty); 
```

即使它设置为异步，它仍然会挂起，因为页面在线程完成之前不会完成渲染

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-19T18:04:24.827

这应该适合你：

```
System.Net.WebClient client = new System.Net.WebClient();
client.DownloadDataAsync(new Uri("http://some.url.com/some/resource.html")); 
```

WebClient 类具有用于在请求完成时通知调用者的事件，但是由于您不在乎，因此应该没有其他任何内容。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-19T19:23:03.030

Doak，几乎就在那里，但每次我将任何请求放在单独的线程中时，页面仍然不会呈现，直到所有线程完成运行。

我发现的最好方法是调整 Doak 的方法，然后在其中设置一个超时并吞下错误。

我知道它是一个黑客，但它确实有效：P

```
WebRequest wr = WebRequest.Create("http://localhost:49268/dostuff.aspx");
wr.Timeout = 3500;

try
{
    HttpWebResponse response = (HttpWebResponse)wr.GetResponse();
}
catch (Exception ex)
{
    //We know its going to fail but that dosent matter!!
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-19T17:58:29.893

为了不让您的应用程序挂起，您需要从线程调用该方法。

对于没有答案的 HTTP 请求，这样的事情应该可以完成：

```
Thread myThread = new Thread(new ThreadStart(myMethodThatDoHttp));
    myThread.Start();
public void myMethodThatDoHttp()
{
    HttpWebRequest request  = (HttpWebRequest)WebRequest.Create("http://www..com");
    HttpWebResponse response = (HttpWebResponse)request.GetResponse();
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-19T17:58:02.920

看[`System.Net.WebClient`](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)，具体使用[`DownloadDataAsync()`](http://msdn.microsoft.com/en-us/library/system.net.webclient.downloaddataasync.aspx)方法发送请求而不阻塞应用程序的其余部分。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-19T18:42:41.693

要在不中断当前页面的页面流的情况下进行此过程，我建议创建一个 WCF 服务来为您执行代码。将服务设置为使用 1 方式调用，并在页面上启动对服务的 Ajax 调用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-19T17:59:57.957

`System.Net.WebClient.DownloadDataAsync/DownloadFileAsync`与 结合使用`DownloadDataCompleted/DownloadFileCompleted`。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-03-10T23:06:09.910

1.  据我所见，HttpWebRequest 对象的“BeginGetResponse”方法和“EndGetResponse”方法（通过调用 WebRequest.Create 获得），分别。BeginGetRequestStream-/EndGetRequestStream 方法，此处尚未反映，尽管它们在文档中被明确标记为“异步请求”：

    *   [对于.Net 2.0](http://msdn.microsoft.com/de-de/library/system.net.httpwebrequest%28v=vs.80%29.aspx)
    *   [对于.Net 4.0](http://msdn.microsoft.com/de-de/library/system.net.httpwebrequest%28v=vs.100%29.aspx)

    不知道，它是如何工作的。

2.  如果要调用的页面在同一个 IIS/App 上。作为调用，您可以编写一个过滤器，如果映射字符串包含要调用的页面的规范（在 ISAPI-cpp 中：“返回SF_STATUS_REQ_FINISHED;") 但也许你在被调用页面中的 asp/x/-script-execution 也被杀死了。检查问题。

3.  考虑使用服务器端包含指令（条件较少）或使用 Server.Execute 动态调用 .asp 文件。

4.  不是真正的异步，但可能值得：在系统的调用页面中通过 EARLY Response.End() （或类似的）显式声明，不需要进一步的响应，主要不是给调用者。然后在 CALLED 页面的脚本中进行你的工作。至少等待同步呼叫结束的时间间隔可以通过 10、100 左右的 fac 最小化。

# asp-classic - 经典的 ASP DB 打开功能不起作用

> ID：302781
> 
> 赞同：0
> 
> 时间：2008-11-19T17:55:07.887
> 
> 标签：asp-classic, windows-server-2008

我已将在 windows server 2003 上运行的经典 asp 站点转移到 windows server 2008，但突然以下代码停止工作。

```
Const connStr_FC08 = "Provider=SQLNCLI10;Server=DS-47500;Database=TestDB;Uid=TestLogin;Pwd=test;Network=dbmssocn;"

Function connDB(OpenDB)
    DIM conn
    SET conn = Server.CreateObject("ADODB.Connection")
    conn.open = connStr_FC08
    If OpenDB = "Y" Then conn.open
    connDB = conn
End Function

dim cn, cmd
cn = connDB("Y")
response.Write(cn.state) 
```

这将返回以下错误

```
Microsoft VBScript runtime error '800a01a8' 

Object required: 'Provider=SQLNCLI10.1' 
```

这发生在下面的行

```
response.write(cn.state) 
```

谢谢克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-22T02:10:52.380

我看到您发布的代码存在一些可能的语法问题：

```
 ...
    conn.open = connStr_FC08
    ...
    connDB = conn
...
cn = connDB("Y") 
```

是否应该更新为以下内容？

```
 ...
    conn.ConnectionString = connStr_FC08
    ...
    Set connDB = conn
...
Set cn = connDB("Y") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T19:15:00.567

如果我从函数中打开连接并放入内联，那么没有错误并且它可以工作。

但是我的整个网站都是通过使用这个函数来工作的，所以a）我不想重写我的代码，b）我不明白为什么这在以前不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T18:05:48.787

你安装了那个 SQL Provider 对吗？

您可以将该函数放入一个简单的 VBScript 脚本中进行测试，而无需更改任何页面。

# ruby-on-rails - Rails：如何检查列是否有值？

> ID：302782
> 
> 赞同：13
> 
> 时间：2008-11-19T17:55:19.167
> 
> 标签：ruby-on-rails, ruby, database, ruby-on-rails-3, ruby-on-rails-4

我怎样才能做到这一点？

```
<% for agent in @broker.agents %>
  ...
  <% if agent.cell %><span class="cell-number">Cell: <%= agent.cell %></span><% end %>
  ...
<% end %> 
```

我想测试一下代理是否有一个单元格号码，如果有，显示条件里面的内容。我目前所拥有的似乎不起作用；它只显示“单元格：”。

想法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-19T18:23:40.437

这是你要求的：

```
<% for agent in @broker.agents %>
  <% unless agent.cell.blank? %>
    <span class="cell-number">Cell: <%= agent.cell %></span>
  <% end %>
<% end %> 
```

细胞？无论单元格是 nil 还是空字符串，该方法都有效。Rails 为所有 ActiveRecord 属性添加了类似的功能。这看起来会更好一些：

```
<% for agent in @broker.agents %>
  <span class="cell-number">
    Cell: <%= agent.cell? ? "none given" : agent.cell %>
  </span>
<% end %> 
```

问号和冒号形成一个快速的“if ? then : else”语句。上面的代码中有两个问号，因为一个是方法名称单元格的一部分？另一个是 if/then/else 结构的一部分。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-08-29T17:42:27.767

我对这个问题“**如何检查列是否有值？** ”给出了非常详细的答案。

首先，重要的是要注意一个属性可以有四种值。

1.  **nil**值，即“nil”存储在数据库中
2.  **空值，即 "" 一个****没有空格**的空字符串
***   ****带有空格**“”的**空**字符串。*****   数据库中存在的值，即**非空字符串**。****

 ****这是可以在这种情况下使用的所有当前方法（Ruby 2.2.2）的详细行为。

**第一种方法：** `.empty?`

1.  对于**nil**值 => 抛出异常

    ```
    2.2.2 :037 > object.attribute
    => nil
    2.2.2 :025 > object.attribute.empty?
    NoMethodError: undefined method `empty?' for nil:NilClass 
    ```

2.  对于**空值，即 "" 一个****没有空格**的空字符串

     **```
    2.2.2 :037 > object.attribute
    => ""
    2.2.2 :025 > object.attribute.empty?
    true 
    ```** 
***   ****带有空格**“”的**空**字符串。**

     **```
    2.2.2 :041 > object.attribute
    => " " 
    2.2.2 :042 > object.attribute.empty?
    => false 
    ```** ***   数据库中存在的值，即**非空字符串**。

    ```
    2.2.2 :045 > object.attribute
     => "some value" 
    2.2.2 :046 > object.attribute.empty?
     => false 
    ```**** 

 ******第二种方法：** `.nil?`

1.  **nil**值，即“nil”存储在数据库中

    ```
    2.2.2 :049 > object.attribute
     => nil 
    2.2.2 :050 > object.attribute.nil?
     => true 
    ```

2.  **空值，即 "" 一个****没有空格**的空字符串

     **```
    2.2.2 :053 > object.attribute
     => "" 
    2.2.2 :054 > object.attribute.nil?
     => false 
    ```** 
***   ****带有空格**“”的**空**字符串。**

     **```
    2.2.2 :057 > object.attribute
     => " " 
    2.2.2 :058 > object.attribute.nil?
     => false 
    ```** ***   数据库中存在的值，即**非空字符串**。

    ```
    2.2.2 :061 > object.attribute
     => "some value" 
    2.2.2 :062 > object.attribute.nil?
     => false 
    ```**** 

 ******第三种方法：** `.blank?`

1.  **nil**值，即“nil”存储在数据库中

    ```
    2.2.2 :065 > object.attribute
     => nil 
    2.2.2 :066 > object.attribute.blank?
     => true 
    ```

2.  **空值，即 "" 一个****没有空格**的空字符串

     **```
    2.2.2 :069 > object.attribute
     => "" 
    2.2.2 :070 > object.attribute.blank?
     => true 
    ```** 
***   ****带有空格**“”的**空**字符串。**

     **```
    2.2.2 :073 > object.attribute
     => " " 
    2.2.2 :074 > object.attribute.blank?
     => true 
    ```** ***   数据库中存在的值，即**非空字符串**。

    ```
    2.2.2 :075 > object.attribute
     => "some value" 
    2.2.2 :076 > object.attribute.blank?
     => false 
    ```**** 

 ******第四种方法：** `.present?`

1.  **nil**值，即“nil”存储在数据库中

    ```
    2.2.2 :088 > object.attribute
     => nil 
    2.2.2 :089 > object.attribute.present?
     => false 
    ```

2.  **空值，即 "" 一个****没有空格**的空字符串

     **```
    2.2.2 :092 > object.attribute
     => "" 
    2.2.2 :093 > object.attribute.present?
     => false 
    ```** 
***   ****带有空格**“”的**空**字符串。**

     **```
    2.2.2 :096 > object.attribute
     => " " 
    2.2.2 :097 > object.attribute.present?
     => false 
    ```** ***   数据库中存在的值，即**非空字符串**。

    ```
    2.2.2 :100 > object.attribute
     => "some value" 
    2.2.2 :101 > object.attribute.present?
     => true 
    ```**** 

 ****您可以根据您面临的情况使用这四种中的任何一种。

谢谢

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-19T18:11:33.720

```
if !agent.cell.blank? 
```

有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T12:33:53.853

代理.细胞？似乎与agent.cell.blank一样工作？在 RoR。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T23:40:15.570

```
<% @broker.agents.each do |agent| %>
  ...
  <% unless agent.cell.empty? %>
    <span class="cell-number">Cell: <%= agent.cell %></span>
  <% end %>
  ...
<% end %> 
```

我发现使用#each,`unless`和`cell.empty?`乍一看更易读和更容易理解。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-03T11:18:20.977

您实际上可以检查列是否不包含任何内容， `Model.column == ""`如果列类型为字符串，则将返回 true

# ruby-on-rails - 我可以在 rails 模型中定义方法吗？

> ID：302789
> 
> 赞同：23
> 
> 时间：2008-11-19T17:58:44.683
> 
> 标签：ruby-on-rails, ruby

我的 rails 模型有试图`define_method(method_name)`在模型内部的代码。

我不断得到：

```
NoMethodError: undefined method `define_method' 
```

我究竟做错了什么？我在错误的地方这样做吗？我需要将此方法附加到此模型。我还能在哪里定义这个方法？

编辑：对于那些要求查看代码的人：

```
for field in rdev_fields
  next if self.attributes.include?(field)
  count = count + 1
  rdev_hash[field.to_sym] = self.attributes["attribute#{count}"]
  if !self.respond_to?(field) then
    define_method("#{field}") do
      self.send("attribute#{count}".to_sym)
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-11-19T23:08:30.190

Rails 模型没有什么神奇之处，它只是一个普通的类，有一堆预先存在的方法，

那么，问题是“我可以在一个类中定义_method”吗？

### 第 1 部分：是的，你可以。

重要的区别是您可以*在类*中定义方法而不是*在实例*方法中

例如：

```
class Cow
  define_method "speak" do
    "MOOOO"
  end
end

Cow.new.speak
=> "MOOOO" 
```

这应该可以正常工作。请注意，您是在 Cow 类上定义它，因此您已经拥有的任何其他 Cows 都会自动添加该方法。

### 第 2 部分：如果要从实例方法中定义方法，该怎么办？

您不能从实例方法中定义方法，因此您必须获取类，并使用它来定义方法。像这样：

```
class Cow
  def add_speak
    self.class.send(:define_method, :speak) do
      "MOOOO added"
    end
  end
end

Cow.new.speak
NoMethodError: undefined method 'speak' for #<Cow:0xb7c48530>

Cow.new.add_speak
Cow.new.speak
=> "MOOOO added" 
```

问题解决了。精明的读者会注意到，在我使用的这个例子中`send(:define_method)`——这是必需的，因为`define_method`它是私有的，私有方法只能被它们所在的东西访问。在这种情况下，`define_method`在类中，我们在实例中，所以我们不能直接访问它。

如上所述，我们将方法直接添加到类中，因此所有其他已经存在的 Cows 也会自动添加 speak 方法。

### 第 3 部分：如果您只想为 1 个对象而不是该类的所有对象定义方法，该怎么办？

例子：

```
class Cow
  def add_speak_just_me
    class << self
      define_method "speak" do
        "MOOOO added for just me"
      end
    end
  end
end

Cow.new.speak
NoMethodError: undefined method 'speak' for #<Cow:0xb7c72b78>

c = Cow.new
c.add_speak_just_me
c.speak
=> "MOOOO added for just me" # it works, hooray

Cow.new.speak # this new cow doesn't have the method, it hasn't been automatically added
NoMethodError: undefined method `speak' for #<Cow:0xb7c65b1c> 
```

这是如何运作的？你去兔子洞！

阅读：[http](http://dannytatom.me/metaid/) ://dannytatom.me/metaid/祝你好运。当您意识到向实例“添加方法”实际上并没有将其添加到实例中时，它会有所帮助:-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-11-18T18:59:05.783

如果您来这里搜索如何动​​态定义 CLASS 方法，因为`define_method`它不起作用（因为它定义了 INSTANCE 方法），这是您的答案：

使用`define_singleton_method`:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T18:54:34.257

能够拼凑起来。但对实际发生的事情知之甚少。

我的实例方法 foo 正在打开类并在其上定义 bar 以便我可以在我的实例上调用它。更有经验的人会告诉我们这是否同时打开了一罐蠕虫。

不过，了解您对此的具体用途会很有用。

```
class User < ActiveRecord::Base

  def foo
    (class << self; self; end).class_eval do
      define_method(:bar) {puts "bar"}
    end
  end
end

u = User.first
u.foo
u.bar #=> "bar" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T20:24:39.460

你的问题的答案是“是的，你可以”。至于为什么它不适合你——如果你不为代码提供一些上下文，就不可能确定为什么。

# asp.net - 从 IIS 刷新缓存数据？

> ID：302794
> 
> 赞同：1
> 
> 时间：2008-11-19T18:00:23.027
> 
> 标签：asp.net, web-services, iis

我被要求调查在运行我团队的应用程序的 Web 服务器上间歇性发生的问题。

本质上，我们有一个在代码之间进行查找的网络服务。如果你有 Code Type A，你可以用它来查找对应的 Code Type B。周期性地，当内存不足时，当调用这个 webservice 时，会抛出一个空引用异常。本质上，此服务将查找文件加载到缓存中，并依赖于该文件，因此如果文件发生变化，缓存将重新加载新文件。缓存对象的优先级设置为默认值。我猜在代码中的某个地方，没有验证缓存对象是否仍然存在，并且当服务器上的内存变低时，该对象被转储导致错误。在开始深入研究此代码之前，我希望能够重新创建错误并进行验证。

IIS 管理器（或从命令提示符）中是否有办法强制正在运行的 Web 应用程序转储它的缓存？我认为这应该重新创建条件并因此重新创建错误。更不用说，看到详细错误应该会导致正确的代码部分。

谢谢，

史蒂夫·布鲁亚德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-19T18:15:02.717

我的直觉反应是将 WebMethod 的[CacheDuration](http://msdn.microsoft.com/en-us/library/system.web.services.webmethodattribute.cacheduration(VS.80).aspx)设置为零，然后持续返回到您想要的任何值。我还没有尝试过，但我认为这会转储缓存然后重新开始形成......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T20:41:22.560

我发现了一个可以添加到 ASP.NET 应用程序的实用程序，它允许您将缓存作为一个整体或单个缓存对象进行动态管理。感谢[.NET Rocks！](http://www.dotnetrocks.com)和[dnrtv](http://www.dnrtv.com)。

这是我使用的工具的链接。这使我能够即时清除有问题的特定对象，并证明错误。

感谢大家的帮助。[ASP 联盟缓存管理器。](http://aspalliance.com/cachemanager/default.aspx)

史蒂夫

# sql-server - 当数据更新时，您将如何在数据库之间进行实时数据传输？

> ID：302814
> 
> 赞同：2
> 
> 时间：2008-11-19T18:06:58.240
> 
> 标签：sql-server, data-transfer, real-time

这是我的高层次问题：

我们有两个业务应用程序。App1 输入并存储大量数据。每当 App1 中的任何相关数据发生更改时，我们都需要将数据从 App1 传输到 App2 的东西。本质上，我们希望 App2 中的数据与 App1 同步，只是 App2 包含数据的子集。

App1 使用 SQL Server 2000 数据库。

App2 使用 SQL Server 2005 数据库。

因此，例如，如果用户正在使用 App1 并且他们更新了一些数据，则该数据需要尽可能实时地保存到 App1 数据库，然后发送到 App2 数据库。

寻找一些不会让任何一个系统都崩溃的好主意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T18:16:16.723

你考虑过[复制](http://technet.microsoft.com/en-us/library/ms143241.aspx)吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T18:22:55.447

大概您可以将其表述为“当系统 A 中发生感兴趣的事件时，调用操作 B 以异步（即解耦）更新系统 C”。

听起来像一个消息队列 - 无论是正式的，还是在数据库表中。

有些人可能会认为是“触发”，但那里存在致命的同步依赖。但是触发器可以提供队列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T18:21:12.063

他们在不同的物理位置吗？为什么不能使用单个数据库而只允许 app2 访问允许访问的数据子集？

# .net - 使用代表的好处？

> ID：302819
> 
> 赞同：7
> 
> 时间：2008-11-19T18:08:14.163
> 
> 标签：.net, design-patterns, delegates

我希望在 VB.NET 或 C# 或其他一流的 .NET 语言中实现观察者模式。我听说委托可以用于此目的，但无法弄清楚为什么它们比在观察者上实现的普通旧接口更受欢迎。所以，

*   为什么我应该使用委托而不是定义我自己的接口并传递对实现它们的对象的引用？
*   为什么我要避免使用委托，而使用良好的老式接口？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2010-06-28T17:25:56.420

当您可以直接调用方法时，您*不需要*委托。

当调用方法的代码不知道/不关心它正在调用的方法是什么时，委托很有用*——*例如，您可能会调用一个长时间运行的任务并将其传递给该任务可以使用的回调方法发送有关其状态的通知。

这是一个（非常愚蠢的）代码示例：

```
enum TaskStatus
{
   Started,
   StillProcessing,
   Finished
}

delegate void CallbackDelegate(Task t, TaskStatus status);

class Task
{
    public void Start(CallbackDelegate callback)
    {
        callback(this, TaskStatus.Started);

        // calculate PI to 1 billion digits
        for (...)
        {
            callback(this, TaskStatus.StillProcessing);
        }

        callback(this, TaskStatus.Finished);
    }
}

class Program
{
    static void Main(string[] args)
    {
        Task t = new Task();
        t.Start(new CallbackDelegate(MyCallbackMethod));
    }

    static void MyCallbackMethod(Task t, TaskStatus status)
    {
        Console.WriteLine("The task status is {0}", status);
    }
} 
```

如您所见，`Task`该类不知道也不关心——在这种情况下——委托是一个将任务状态打印到控制台的方法。该方法同样可以通过网络连接将状态发送到另一台计算机。等等。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-06-28T17:25:15.300

你是操作系统，我是应用程序。我想告诉您，当您检测到发生某些事情时，调用我的一种方法。为此，我将一个委托传递给我希望你调用的我的方法。我自己不会调用我的那个方法，因为我希望你在检测到某些东西时调用它。您不直接调用我的方法，因为您不知道（在编译时）该方法存在（我什至在构建时都没有编写）；相反，您调用您在运行时收到的委托指定的任何方法。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-06-28T17:24:55.417

从技术上讲，您不必使用委托（除非使用[事件处理程序](http://www.csharphelp.com/2006/07/c-events/)，否则它是必需的）。没有他们你也能过得去。实际上，它们只是工具箱中的另一个工具。

使用它们首先想到的是[Inversion Of Control](http://en.wikipedia.org/wiki/Inversion_of_control)。任何时候您想从外部控制函数的行为方式，最简单的方法是将委托作为参数放置，并让它执行委托。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-06-28T17:28:19.303

你不像程序员那样思考。

[问题是，当您可以调用委托时](http://en.wikipedia.org/wiki/Indirection)，为什么要直接调用函数？

> David Wheeler 的一句著名格言是：计算机科学中的所有问题都可以通过另一个层次的间接性来解决。

我有点半开玩笑。显然，大多数时候你会直接调用函数，尤其是在模块中。但是，当需要在包含对象不可用（或相关）的上下文中调用函数时，委托很有用，例如事件回调。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-19T18:47:22.337

在观察者模式中有两个地方可以使用委托。由于我不确定您指的是哪一个，因此我将尝试回答两者。

第一种是在主题中使用委托而不是 IObserver 列表。这种方法在处理多播方面似乎更干净，因为你基本上有

```
private delegate void UpdateHandler(string message);
private UpdateHandler Update;

public void Register(IObserver observer)
{
    Update+=observer.Update;
}

public void Unregister(IObserver observer)
{
    Update-=observer.Update;
}

public void Notify(string message)
{
    Update(message);
} 
```

代替

```
public Subject()
{
    observers = new List<IObserver>();
}

public void Register(IObserver observer)
{
    observers.Add(observer);
}

public void Unregister(IObserver observer)
{
    observers.Remove(observer);
}

public void Notify(string message)
{
    // call update method for every observer
    foreach (IObserver observer in observers)
    {
        observer.Update(message);
    }
} 
```

除非您需要做一些特别的事情并需要对整个 IObserver 对象的引用，否则我认为代表会更干净。

第二种情况是例如使用传递委托而不是 IObervers

```
public delegate void UpdateHandler(string message);
private UpdateHandler Update;

public void Register(UpdateHandler observerRoutine)
{
    Update+=observerRoutine;
}

public void Unregister(UpdateHandler observerRoutine)
{
    Update-=observerRoutine;
}

public void Notify(string message)
{
    Update(message);
} 
```

有了这个，观察者不需要实现接口。你甚至可以传入一个 lambda 表达式。这种控制水平的变化几乎是不同的。这是好是坏取决于你。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-06-28T17:25:44.113

*我在重复我对[这个问题](https://stackoverflow.com/questions/1337379/still-having-problems-understanding-asp-net-events-whats-the-point-of-them/1337472#1337472)的回答。*

我一直喜欢广播电台的比喻。

当一个广播电台想要广播一些东西时，它只是将它发送出去。它不需要知道是否真的有人在听。您的收音机能够向广播电台注册（通过拨盘调谐），所有广播电台的广播（我们的小比喻中的事件）都被收音机接收，并将它们翻译成声音。

没有这种注册（或事件）机制。广播电台必须轮流联系每一个电台，询问它是否想要广播，如果你的电台说是，然后直接向它发送信号。

您的代码可能遵循非常相似的范例，其中一个类执行一项操作，但该类可能不知道，或者可能不想知道谁会关心或对发生的该操作采取行动。因此，它为任何对象提供了一种注册或注销自身的方法，以通知该操作已发生。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-06-28T17:26:20.163

委托是函数/方法接口的强类型。

如果您的语言认为应该有强类型，并且它具有一流的功能（C# 都有），那么*没有*委托将是不一致的。

考虑任何接受委托的方法。如果你没有委托，你将如何传递一些东西给它？被调用者如何对其类型有任何保证？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-19T18:31:56.050

实际上，委托是传递对方法的引用，而不是对象……接口是对对象实现的方法子集的引用……

如果在您的应用程序的某些组件中，您需要访问一个对象的多个方法，则定义一个表示该对象方法子集的接口，并在您可能需要传递给它的所有类上分配和实现该接口组件...然后通过该接口而不是通过它们的具体类传递这些类的实例。

如果，otoh，在某些方法或组件中，您只需要几个方法之一，这些方法可以在任意数量的不同类中，但都具有相同的签名，那么您需要使用委托。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-19T18:36:01.410

我听过一些“事件布道者”谈论这个，他们说越多的解耦事件越好。

最好，事件源永远不应该知道事件侦听器，而事件侦听器永远不应该关心谁发起了事件。这不是今天的情况，因为在事件侦听器中，您通常会收到事件的源对象。

话虽如此，代表是这项工作的完美工具。它们允许事件源和事件观察者之间的解耦，因为事件源不需要保留所有观察者对象的列表。它只保留观察者的“函数指针”（委托）列表。正因为如此，我认为这比接口有很大的优势。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-19T18:40:58.747

换个角度看。与使用该语言在语法和库中都支持的标准方式相比，使用自定义接口有什么优势？

当然，在*某些*情况下，定制的解决方案可能具有优势，在这种情况下，您应该使用它。在所有其他情况下，请使用可用的最规范的解决方案。它的工作量更少，更直观（因为这是用户所期望的），得到了更多工具（包括 IDE）的支持，而且很有可能，编译器会以不同的方式处理它们，从而产生更高效的代码。

不要重新发明轮子（除非当前版本已损坏）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-06-28T18:27:07.407

实际上，Sun 和 Microsoft 之间在代表问题上发生了有趣的争论。虽然 Sun 对代表采取了相当强硬的立场，但我认为 Microsoft 在使用代表方面提出了更强有力的观点。以下是帖子：

[http://java.sun.com/docs/white/delegates.html](http://java.sun.com/docs/white/delegates.html)

[http://msdn.microsoft.com/en-us/vjsharp/bb188664.aspx](http://msdn.microsoft.com/en-us/vjsharp/bb188664.aspx)

我想你会发现这些有趣的阅读...

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-12-20T09:21:01.013

这是我可以写下的使用委托的原因。以下代码是用 C# 编写的，请关注评论。

```
public delegate string TestDelegate();
protected void Page_Load(object sender, EventArgs e)
{
    TestDelegate TD1 = new TestDelegate(DiaplayMethodD1);
    TestDelegate TD2 = new TestDelegate(DiaplayMethodD2);
    TD2 = TD1 + TD2; // Make TD2 as multi-cast delegate
    lblDisplay.Text =  TD1(); // invoke delegate
    lblAnotherDisplay.Text = TD2();

    // Note: Using a delegate allows the programmer to encapsulate a reference 
    //       to a method inside a delegate object. Its like the function pointer
    //       in C or C++.    
}
//the Signature has to be same.
public string DiaplayMethodD1()
{
    //lblDisplay.Text = "Multi-Cast Delegate on EXECUTION"; // Enable on multi-cast 
    return "This is returned from the first method of delegate explanation";
}
// The Method can be static also
public static string DiaplayMethodD2()
{
    return " Extra words from second method";
} 
```

最好的问候， Pritom Nandy，孟加拉国

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-10-03T09:17:13.753

这是一个可能有帮助的例子。

有一个使用大量数据的应用程序。需要一个允许过滤数据的功能。可以指定 6 种不同的过滤器。

立即的想法是创建 6 个不同的方法，每个方法都返回过滤后的数据。例如

公共数据 FilterByAge(int age)

公共数据 FilterBySize(int size)

.... 等等。

这很好，但是非常有限，并且会产生垃圾代码，因为它已关闭以进行扩展。

更好的方法是使用单个 Filter 方法并传递有关如何过滤数据的信息。这是可以使用委托的地方。委托是一个可以应用于数据以过滤数据的函数。

公共数据过滤器（动作过滤器）

然后使用它的代码变成

过滤器（数据 => data.age > 30）；

过滤器（数据 => 数据大小 = 19）；

代码 data => blah blah 成为委托。代码变得更加灵活并保持开放。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-06-28T19:28:14.947

我认为它与**语法糖**和组织代码的方式更相关，一个很好的用途是处理与公共上下文相关的几种方法，这些方法属于对象或静态类。

并不是您被迫使用它们，您可以使用或不使用它们进行编程，但也许使用或不使用它们可能会影响代码的组织性、可读性以及为什么不酷，可能会破坏代码中的某些行。

正如有人所说，这里给出的每个示例都是一个很好的示例，您可以在其中实现它们，这只是您可以使用的语言的另一个功能。

问候

# .net - .NET 3.5 图表控件异常：执行 ChartImg.axd 的子请求时出错

> ID：302820
> 
> 赞同：40
> 
> 时间：2008-11-19T18:09:47.733
> 
> 标签：.net, .net-3.5, charts

有人在使用从 Dundas 购买的新免费图表控件 MS 时遇到此错误吗？

“执行 ChartImg.axd 的子请求时出错”

在 MSDN 论坛上，他们建议这是我的 web.config： [MSDN 论坛帖子](http://social.msdn.microsoft.com/Forums/en-US/MSWinWebChart/thread/1dc4b352-c9a5-49dc-8f35-9b176509faa1/)

到目前为止，这还没有解决问题。还有其他想法吗？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-01-13T07:52:40.177

我遇到了同样的问题：图表可以在一页上工作，但不能在下一页上工作。事实证明，如果图表在 POST（即回发）中第一次初始化，则会引发错误，因为处理程序配置不正确。要解决此问题，请通过添加 POST 动词来修改用户 LaptopHeaven 在本主题中提到的 httpHandler 配置：

```
<add path="ChartImg.axd" verb="GET,HEAD,POST" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" validate="false" /> 
```

我已经在 Scott Anderson 在本主题的开篇文章中提到的 MSDN 论坛帖子中对为什么会出现此错误进行了更彻底的解释。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-02T20:39:05.370

我遇到了这个错误，但是通过向我的 web.config 文件的 system.web\httpHandler 部分添加一个元素来纠正它。我添加了以下内容：

```
<add path="ChartImg.axd" verb="GET,HEAD" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" validate="false" /> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-03-29T18:57:27.220

在 .NET 4.0 上，图表是内置的，但您仍可能需要在下面添加类似的标签：

```
<add path="ChartImg.axd" verb="GET,HEAD,POST" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" validate="false" /> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-03-18T18:06:41.090

尝试（不要忘记 ChartImageHandler 键中的路径）

```
 <appSettings>
    <add key="ChartImageHandler" value="storage=file;timeout=20;dir=c:\TempImageFiles\;" />
</appSettings>

<httpHandlers>
...
    <add path="ChartImg.axd" verb="GET,HEAD" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" validate="false" />
...
</httpHandlers>

<handlers>
...
    <add name="ChartImageHandler" preCondition="integratedMode" verb="GET,HEAD" path="ChartImg.axd" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />

...
</handlers> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-03-14T09:35:52.907

另请注意，虽然将图表控件从工具箱拖到您的页面上应该会在 web.config 中创建必要的条目，但这仅**在您当时处于设计模式时才会发生。**

**如果您处于源模式并拖放，则不会发生。**

此外，当您在设计模式下添加图表控件时，项目/类文件中必须存在某种形式的注册。因为如果您处于源代码模式并且 dnd 图表控件，您将不会像上面那样在 web.config 中获得条目。如果您随后进入设计模式并从工具箱 dnd 进入页面，您将获得 web.config 中的条目。

但是，如果然后删除图表，您在设计模式下会删除，它会从 web.config 中擦除条目（假设是单页站点），即使您在页面上仍然拥有其他图表控件源模式。

所以不，你不是疯了，只是不直观。;)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-21T07:04:14.567

我在 MSDN 论坛上发布了解决此问题的方法：

好吧，我仍然不知道为什么会出现异常，但我似乎找到了解决方法。我做了一个实验，将假定的有问题的 web.config 复制到一个新项目中，在该项目中我添加了一个新的 Web 表单和图表控件，并且图表控件使用“UseHttpHandler”选项渲染得很好。这让我相信实际上并不是 web.config 是我的问题，所以我回到原来的项目，并在另一个 Web 表单中添加了一个图表作为实验，它成功了！更令人惊讶的是，在那之后我去了有问题的页面，它也起作用了！然后我把新图表从另一页上取下来，检查了原来的有问题的页面，它又坏了。然后我发现如果我在违规页面之前的任何页面上放置图表控件，它会起作用，否则它抛出异常。这些控件非常酷，尽管我没有问题地找到另一个页面将其放在违规页面的路径中:)

这解决了问题，但如果有人有任何理论，为什么我会感兴趣......也许是一个错误？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-07-21T21:16:16.390

更多信息：

我也遇到了 web.config 问题，并通过确保在将 Chart 控件拖放到页面上时未在代码编辑器中打开 web.config 来解决此问题。如果 web.config 尚未打开，Visual Studio 2010 将进行适当的修改。

成功应用 web.config 问题后，我能够成功克服“执行子请求时出错”错误。

另外关于在 MVC 应用程序中的使用，我正在努力在我的 MVC 2 应用程序（VS2010/.NET 4）中实现它并遇到了另一个问题。

该页面对 ChartImg.axd 的调用导致 HTTP 404 错误。（我使用 Fiddler 找到了这个。）

事实证明，该页面试图从 /MyController/ChartImg.axd 而不是 /ChartImg.axd （从根）访问处理程序。

我可以通过将此行添加到我的 Global.asax.cs 文件来解决问题：

```
routes.IgnoreRoute("{controller}/{resource}.axd/{*pathInfo}"); 
```

对于一些不得不求助于更改 Chart.ImageStorageMode 属性的用户来说，这可能是个问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-05-02T19:30:25.337

通过在 webconfig 中添加 chatImageHandler 解决了这个问题。

```
<system.webServer>
    <validation validateIntegratedModeConfiguration="false"/>
    <handlers>
      <remove name="ChartImageHandler"/>
      <add name="ChartImageHandler" preCondition="integratedMode" verb="GET,HEAD,POST" path="ChartImg.axd" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
    </handlers>
  </system.webServer> 
```

**更多详情： http:** [//www.infinetsoft.com/Post/-Solved-Error-executing-child-request-for-ChartImg-axd/1164#.VyenrNJ97cs](http://www.infinetsoft.com/Post/-Solved-Error-executing-child-request-for-ChartImg-axd/1164#.VyenrNJ97cs)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-22T16:16:56.467

只是想指出，这也是图像未找到错误的权限问题。

在您的图像文件夹上设置“允许修改”权限（默认情况下，对于您的网站运行的帐户，它是“C:\TempImageFiles”。

问题消失。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-24T08:29:07.810

请在 webconfig 中添加

添加动词="GET,HEAD" path="ChartImg.axd" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"

谢谢

巴桑特

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-06-23T18:50:12.460

在 IIS 6.0 (Server 2003) 中，如果 httpHandler 丢失，则会发生此错误（请参阅[上一个答案](https://stackoverflow.com/questions/302820/net-3-5-chart-controls-exception-error-executing-child-request-for-chartimg-axd/335363#335363)）

查看堆栈跟踪，似乎 IIS 6.0 假定将加载处理程序。它对语句执行 Execute 并吞下异常。在 IIS 6.0 中的 httpHandlers 下包含以下属性（如上所示）为我解决了这个问题。

```
<add path="ChartImg.axd" verb="GET,HEAD" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"  validate="false"/> 
```

请注意，我将版本从上一个答案更改为 4.0.0.0 并在 Server 2008 (IIS 7.0) 和 Server 2003 (IIS 6.0) 中进行了测试

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-07-20T12:21:40.953

此问题的另一个原因可能是因为应用程序池设置为“经典”模式。我的处理程序配置正确，但我得到了同样的错误。

```
 <add name="ChartImg" verb="*" path="ChartImg.axd" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"  /> 
```

一旦我将应用程序池切换到“集成”模式。图表控件开始正常工作。

# c# - 不使用文件系统的 C# 中的序列化

> ID：302821
> 
> 赞同：26
> 
> 时间：2008-11-19T18:10:04.240
> 
> 标签：c#, sharepoint, serialization, moss, wss

我有一个简单的二维字符串数组，我想将它填充到 MOSS 中的 SPFieldMultiLineText 中。这映射到一个 ntext 数据库字段。

我知道我可以序列化为 XML 并存储到文件系统，但我想在不接触文件系统的情况下进行序列化。

```
public override void ItemAdding(SPItemEventProperties properties)
{
    // build the array
    List<List<string>> matrix = new List<List<string>>();
    /*
    * populating the array is snipped, works fine
    */
    // now stick this matrix into the field in my list item
    properties.AfterProperties["myNoteField"] = matrix; // throws an error
} 
```

看起来我应该能够做这样的事情：

```
XmlSerializer s = new XmlSerializer(typeof(List<List<string>>));
properties.AfterProperties["myNoteField"] = s.Serialize.ToString(); 
```

但这不起作用。我发现的所有示例都演示了写入文本文件。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-11-19T18:32:48.810

```
StringWriter outStream = new StringWriter();
XmlSerializer s = new XmlSerializer(typeof(List<List<string>>));
s.Serialize(outStream, myObj);
properties.AfterProperties["myNoteField"] = outStream.ToString(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-19T20:46:24.813

这是一个通用序列化程序（C#）：

```
 public string SerializeObject<T>(T objectToSerialize)
    {
        BinaryFormatter bf = new BinaryFormatter();
        MemoryStream memStr = new MemoryStream();

        try
        {
            bf.Serialize(memStr, objectToSerialize);
            memStr.Position = 0;

            return Convert.ToBase64String(memStr.ToArray());
        }
        finally
        {
            memStr.Close();
        }
    } 
```

在您的情况下，您可以致电：

```
 SerializeObject<List<string>>(matrix); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-19T18:37:51.327

将 TextWriter 和 TextReader 类与 StringWriter 一起使用。

以机智：

```
XmlSerializer s = new XmlSerializer(typeof(whatever));
TextWriter w = new StringWriter();
s.Serialize(w, whatever);
yourstring = w.ToString(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T18:33:05.457

在 VB.NET 中

```
Public Shared Function SerializeToByteArray(ByVal object2Serialize As Object) As Byte()
    Using stream As New MemoryStream
        Dim xmlSerializer As New XmlSerializer(object2Serialize.GetType())
        xmlSerializer.Serialize(stream, object2Serialize)
        Return stream.ToArray()
    End Using
End Function

Public Shared Function SerializeToString(ByVal object2Serialize As Object) As String
    Dim bytes As Bytes() = SerializeToByteArray(object2Serialize)
    Return Text.UTF8Encoding.GetString(bytes)
End Function 
```

在 C#

```
public byte[] SerializeToByteArray(object object2Serialize) {
       using(MemoryStream stream = new MemoryStream()) {
          XmlSerializer xmlSerializer = new XmlSerializer(object2Serialize.GetType());
          xmlSerializer.Serialize(stream, object2Serialize);
          return stream.ToArray();
       }
}

public string SerializeToString(object object2Serialize) {
   byte[] bytes = SerializeToByteArray(object2Serialize);
   return Text.UTF8Encoding.GetString(bytes);
} 
```

# javascript - as3 ExternalInterface.addCallback 无法正常工作

> ID：302829
> 
> 赞同：4
> 
> 时间：2008-11-19T18:11:56.840
> 
> 标签：javascript, actionscript-3, externalinterface, addcallback

我试图从 javascript 访问 swf，所以 livedocs 中的这个例子就是我想要修改的。[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html#includeExamplesSummary](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html#includeExamplesSummary)

但是，由于某种原因，它无法正常工作。我遇到的问题是它在 Safari 和 Firefox 中不起作用，只有在 javascript 将值传递给 swf 之前我在函数中放置警报时它才起作用。（似乎需要一些时间）我也尝试在 as3 中设置一个计时器，但是计时器不起作用，只有 js 中的 alert 有帮助。

我想做的就是用js告诉swf文件播放ep1.swf。这是我的js代码：

```
document.observe('dom:loaded', function() {
    $('episode1').observe('click', function() {
        var params = {wmode : "transparent", allowScriptAccess:"always", movie:"header"};
        swfobject.embedSWF("swf/float.swf", "header", "100%", "100%", "9.0.0","expressInstall.swf", "", params, "");
        sendToActionScript("ep1.swf");
    });
})
function thisMovie(movieName) {
    if (navigator.appName.indexOf("Microsoft") != -1) {
        return window[movieName];
    } else {
        //alert("aaa")
        return document[movieName];
    }
}
function sendToActionScript(value) {     
    thisMovie('header').sendToActionScript(value);       
} 
```

这是我的 as3 代码：

```
private function receivedFromJavaScript(value:String):void {

    loader.load(new URLRequest(value));

} 
```

我已经尝试了很长时间，有人知道如何解决这个问题吗？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-21T15:39:26.850

问题是，当您尝试调用 SWF 文件时，它还没有完全加载。Flash 播放器可能已加载，但加载和初始化 swf 文件需要一段时间。

您需要做的是在加载时从 SWF 文件调用 javascript 函数并将您的 javascript 放在那里而不是您现在似乎正在执行的页面加载处理程序中。这样您就知道您的闪存应用程序到那时已正确初始化。您正在使用的 ExternalInterface 类具有让您回调 javascript 的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-06T13:34:32.007

使用此代码获取 swf 对象。

我在以下位置测试了这段代码：

*   即 9,8,7
*   火狐 6.0.1
*   网景导航器 9.0.0.6
*   歌剧 11.5
*   谷歌浏览器 13.0.782.215
*   Safari 3.2（全部在 Windows 操作系统中）

它工作得很好。

```
function GetSWF(strName) {
    if (window.document[strName] != null) {
        if (window.document[strName].length == null)
            return window.document[strName];
        else
            return window.document[strName][1];
    } else {
        if (document[strName].length == null)
            return document[strName];
        else
            return document[strName][1];
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T17:26:54.520

成功总结：

* * *

我使用`AC_RunActiveContent.js`的是 Flash 在发布时设置的。
我的 swf 被称为`fvar_js`，如下所示：

```
AC_FL_RunContent(
        ...
    'src', 'fvar_js',
        ... 
```

我强调这一点，因为我从来不需要使用`thisMovie` 上面帖子中的函数来指向 swf 对象。我能够直接使用 `fvar_js`（嗯，有点，如你所见）。

* * *

在我的 as3 代码中，我有以下几行：

```
if (ExternalInterface.available) {
    ExternalInterface.addCallback("js_to_as_f", js_from_as_f);
} 
```

`js_from_as_f`更改文本字段中文本的函数在哪里。

* * *

在 HTML 中，我设置了以下内容：

```
var timeoutId;
var js_initiate_callback = function() {
    // This is the swf object:
    fvar_js.js_to_as_f();
    clearTimeout ( timeoutId );
}
var reset_fvar_f = function(new_val) {
    fvar_val = new_val;
}
//js_initiate_callback();
timeoutId = setTimeout(js_initiate_callback, 1000); 
```

我尝试了 1ms 和 100ms，但结果参差不齐。用 1000 毫秒，这可以在 PC 上的 IE、FF 和 Safari 中运行。没有在 Mac OS X 上检查过。

显然，关键是让所有对象和所有对象连接都有时间建立起来。我不知道最短时间是多少。

# sql - Sql Server Case Statement 在用户定义的函数中给了我错误

> ID：302833
> 
> 赞同：2
> 
> 时间：2008-11-19T18:12:16.713
> 
> 标签：sql, sql-server, ssms

我想在我的用户定义函数中使用 case 语句，因为我需要匹配多个术语。我可以使用一个表进行匹配，但是我无法将它放在计算列定义中。

这适用于 IF 语句：

```
CREATE FUNCTION MaraSizeNumber
(
    @ms varchar
)
RETURNS varchar
AS
BEGIN
    IF ms = '16-18' RETURN '1'
    ELSE IF ms = '18-20' RETURN '2'
    ELSE IF ms = '20-22' RETURN '3'
    ELSE IF ms = '22+' RETURN '4'
    ELSE IF ms = '24+' RETURN '5'
    ELSE IF ms = '14-16' RETURN '7'
    ELSE RETURN 'BAD'
END 
```

但是使用 CASE 的原始样式...WHEN THEN BLOCK 我收到一条错误消息。

```
CREATE FUNCTION MaraSizeCaseExample
(
    @ms varchar
)
RETURNS varchar
AS
BEGIN
    CASE ms
        WHEN '16-18' THEN RETURN '1'
        WHEN '18-20' THEN RETURN '2'
        WHEN '20-22' THEN RETURN '3'
        WHEN '22+' THEN RETURN '4'
        WHEN '24+' THEN RETURN '5'
        WHEN '14-16' THEN RETURN '7'
        ELSE RETURN 'BAD'
    END
END 
```

对于我的 when 部分，我收到 Incorrect Syntax near case 和不正确的语法错误。

我已经正确地对所有内容进行了批处理，因为我的最后一个 CREATE FUNCTION 块以 GO 结尾，并且根据 CASE 上的文档，我有正确的语法。

我正在构建一个更大的标量函数，它将使用其他标量函数在我们的系统中生成与其他参数相对应的生产编码。最好能够使用 CASE，因为生产编码取决于产品和客户。

在我的 Create Function 行的第二个示例中，我还收到一个额外的错误，上面写着“不正确的语法：'Create Function' 必须是批处理中的唯一语句”，但是其他所有内容都相同，我没有得到那个错误IF。

我做错了什么，还是只允许在 SQL 查询中使用 CASES 而不是标量函数？错误消息来自 SQL Server Management Studio 的 squiggle 错误消息系统。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T18:15:08.940

案例陈述应如下所示：

```
RETURN CASE @ms
       WHEN '16-18' THEN '1'
       WHEN '18-20' THEN '2'
       WHEN '20-22' THEN '3'
       WHEN '22+' THEN '4'
       WHEN '24+' THEN '5'
       WHEN '14-16' THEN '7'
       ELSE 'BAD'
  END 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T18:41:17.717

我认为您的问题是因为您没有在 varchar 上指定大小（默认为 1）。这导致输入和输出被截断为单个字符。（您还缺少`@`函数内的变量。）

所以`PRINT dbo.SizeExample('16-18')`会打印`'B'`（这不仅被截断，也不是您可能想要的答案，即`'1'`）

请尝试：

```
CREATE FUNCTION MaraSizeExample
(
    @ms varchar(5)
)
RETURNS varchar(3)
AS
BEGIN
    RETURN CASE @ms
        WHEN '16-18' THEN '1'
        WHEN '18-20' THEN '2'
        WHEN '20-22' THEN '3'
        WHEN '22+' THEN '4'
        WHEN '24+' THEN '5'
        WHEN '14-16' THEN '7'
        ELSE 'BAD'
    END
END 
```

1.  `CASE`只是一个搜索（或查找）的表达式 - 你不能`RETURN`从它里面 - 它有点像`IIF()`在 VB 或`IF()`Excel 中。较早的答案基本上解释了这一点。

2.  `VARCHAR`意味着`VARCHAR(1)`，所以你会被截断 - 即你永远不会看到`'BAD'`出来，只有`'B'`. 我不知道为什么当它发生时你没有收到截断警告，就像你在 some 上一样`SQL` `INSERT`，但是你去了。

3.  `@ms`是你的变量名。我不确定为什么 ms 会被接受，除非有其他一些具有该名称的数据库对象（表？）——即使那样也不会。中的所有变量和参数`T-SQL`都带有`@`这样的前缀。

# python - scons : src 并包含目录

> ID：302835
> 
> 赞同：5
> 
> 时间：2008-11-19T18:13:08.617
> 
> 标签：python, scons

有人可以提供一个允许以下结构的 scons 配置文件吗

```
toplevel/
        /src - .cc files
        /include .h files 
```

在顶层，我想要 o 和最终的 exe。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T19:05:01.897

这是 Sconscript 文件的一个示例

```
env=Environment(CPPPATH='/usr/include/glib-2.0/:/usr/lib/glib-2.0/include:inc',
                CPPDEFINES=[],
                LIBS=['glib-2.0']) 
env.Program('runme', Glob('src/*.c')) 
```

（对于示例来说，环境行并不是真正需要的，但我让它包含非标准 glib 标头路径并将其留在那里，这样您就可以了解如何添加额外的包含和定义）

源文件在 src 目录下，头文件在 inc 目录下。您从基本目录运行 scons 并且输出文件也在同一目录中生成。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-19T19:01:05.260

这个问题：[https://stackoverflow.com/questions/279860/...](https://stackoverflow.com/questions/279860/how-do-i-get-projects-to-place-their-build-output-into-the-same-directory-with) 提供了一个非常灵活的 scons 框架，它应该通过对路径变量进行一些调整来满足您的需求。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-19T22:20:04.780

```
env=Environment(CPPPATH='/usr/include/glib-2.0/:/usr/lib/glib-2.0/include:include',
                CPPDEFINES=[],
                LIBS=['glib-2.0']) 

if ARGUMENTS.get('debug', 0):
    env.Append(CCFLAGS = ' -g')

env.Program('template', Glob('src/*.cc')) 
```

工作了一个款待。谢谢。

# vb.net - 使用 VB.NET 查找模式 6 位空间 7 位 ###### ####### 的最佳方法

> ID：302837
> 
> 赞同：0
> 
> 时间：2008-11-19T18:13:28.287
> 
> 标签：vb.net, regex

在vb.net中解析一个文本文件，需要在这两段文本中定位经纬度。模式是 6 位空格 7 位 (364800 0953600)。样本来自两个不同的地图文件，格式略有不同。

```
I 2H02 364800 0953600 '                 SEC72                           10496300-
I 2H05 360100 0953645 '                               ZFW J602 ZME 2A93 10496400-
I 2H06 361215 0952400 '                 SEC72                  ZME 2A75 10496500-
I 2H07 361715 0951145 '                 SEC27/72               ZME 2A78 10496600-
I 2H08 362025 0950100 '                 TUL                    ZME 2A69 10496700-
I 2H10 360800 0952915 '                                        ZME 2A85 10496800-
I 2H11 362500 0955015 '                 SEC62/72                        10496900-
I 2H14 364145 0954315 '                 TUL                             10497000-

I A85A                  'AL851                                50591 REF 33393944 
         391500 0831100 '                                     50591 REF 33393945 
I A85B                  'AL851                                50591 REF 33393946 
         374500 0825700 '                                     50591 REF 33393947 
I A87A                  'AL871                               111592 REF 33393948 
         402050 0814420 '                                    111592 REF 33393949 
I A87B                  'AL871                               111592 REF 33393950 
         400449 0814400 '                                    111592 REF 33393951 
I A87C                  'AL872                              '030394 GDK 33393952 
         392000 0810000 '                                   '030394 GDK 33393953 
```

谢谢，

戴夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T18:22:20.923

一个简单的正则表达式应该做到这一点：

```
[0-9]{6} [0-9]{7} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-19T18:28:19.257

```
Dim matches As MatchCollection
Dim regex As New Regex("\d{6} \d{7}")
matches = regex.Matches(your_text_string) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T18:25:36.703

......

```
(?<First>\d{6})\s(?<Second>\d{7}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T18:20:52.720

做一个简单的组捕获。看来您的 RegEx 公式很简单，可以处理这两种情况（在空间检测上会有些损失）。然后您可以访问匹配的组属性（命名或只是基本索引）并获取您需要的数据。

# c# - WPF 用户控件父级

> ID：302839
> 
> 赞同：192
> 
> 时间：2008-11-19T18:13:47.523
> 
> 标签：c#, .net, wpf

我有一个`MainWindow`在运行时加载到的用户控件。我无法从`UserControl`.

我试过`this.Parent`了，但它总是空的。有谁知道如何从 WPF 中的用户控件获取包含窗口的句柄？

以下是控件的加载方式：

```
private void XMLLogViewer_MenuItem_Click(object sender, RoutedEventArgs e)
{
    MenuItem application = sender as MenuItem;
    string parameter = application.CommandParameter as string;
    string controlName = parameter;
    if (uxPanel.Children.Count == 0)
    {
        System.Runtime.Remoting.ObjectHandle instance = Activator.CreateInstance(Assembly.GetExecutingAssembly().FullName, controlName);
        UserControl control = instance.Unwrap() as UserControl;
        this.LoadControl(control);
    }
}

private void LoadControl(UserControl control)
{
    if (uxPanel.Children.Count > 0)
    {
        foreach (UIElement ctrl in uxPanel.Children)
        {
            if (ctrl.GetType() != control.GetType())
            {
                this.SetControl(control);
            }
        }
    }
    else
    {
        this.SetControl(control);
    }
}

private void SetControl(UserControl control)
{
    control.Width = uxPanel.Width;
    control.Height = uxPanel.Height;
    uxPanel.Children.Add(control);
} 
```

* * *

## 回答 #1

> 赞同：360
> 
> 时间：2008-11-20T08:03:16.973

尝试使用以下内容：

```
Window parentWindow = Window.GetWindow(userControlReference); 
```

该`GetWindow`方法将为您遍历 VisualTree 并找到托管您的控件的窗口。

您应该在控件加载后（而不是在 Window 构造函数中）运行此代码，以防止该`GetWindow`方法返回`null`. 例如连接一个事件：

```
this.Loaded += new RoutedEventHandler(UserControl_Loaded); 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2010-02-12T14:49:37.463

我补充一下我的经验。虽然使用 Loaded 事件可以完成这项工作，但我认为重写 OnInitialized 方法可能更合适。首次显示窗口后发生加载。OnInitialized 使您有机会进行任何更改，例如，在窗口呈现之前将控件添加到窗口。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-11-19T18:56:37.467

使用 VisualTreeHelper.GetParent 或下面的递归函数来查找父窗口。

```
public static Window FindParentWindow(DependencyObject child)
{
    DependencyObject parent= VisualTreeHelper.GetParent(child);

    //CHeck if this is the end of the tree
    if (parent == null) return null;

    Window parentWindow = parent as Window;
    if (parentWindow != null)
    {
        return parentWindow;
    }
    else
    {
        //use recursion until it reaches a Window
        return FindParentWindow(parent);
    }
} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-02-09T05:17:20.950

我需要在 Loaded 事件处理程序中使用 Window.GetWindow(this) 方法。换句话说，我结合使用 Ian Oakes 的答案和 Alex 的答案来获取用户控件的父级。

```
public MainView()
{
    InitializeComponent();

    this.Loaded += new RoutedEventHandler(MainView_Loaded);
}

void MainView_Loaded(object sender, RoutedEventArgs e)
{
    Window parentWindow = Window.GetWindow(this);

    ...
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-08-06T18:32:27.353

如果您发现这个问题并且 VisualTreeHelper 不适合您或偶尔工作，您可能需要在您的算法中包含 LogicalTreeHelper。

这是我正在使用的：

```
public static T TryFindParent<T>(DependencyObject current) where T : class
{
    DependencyObject parent = VisualTreeHelper.GetParent(current);
    if( parent == null )
        parent = LogicalTreeHelper.GetParent(current);
    if( parent == null )
        return null;

    if( parent is T )
        return parent as T;
    else
        return TryFindParent<T>(parent);
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-03-05T11:38:33.340

这种方法对我有用，但它不像你的问题那么具体：

```
App.Current.MainWindow 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-05-18T17:10:29.813

这个怎么样：

```
DependencyObject parent = ExVisualTreeHelper.FindVisualParent<UserControl>(this);

public static class ExVisualTreeHelper
{
    /// <summary>
    /// Finds the visual parent.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="sender">The sender.</param>
    /// <returns></returns>
    public static T FindVisualParent<T>(DependencyObject sender) where T : DependencyObject
    {
        if (sender == null)
        {
            return (null);
        }
        else if (VisualTreeHelper.GetParent(sender) is T)
        {
            return (VisualTreeHelper.GetParent(sender) as T);
        }
        else
        {
            DependencyObject parent = VisualTreeHelper.GetParent(sender);
            return (FindVisualParent<T>(parent));
        }
    } 
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-24T15:14:50.987

I've found that the parent of a UserControl is always null in the constructor, but in any event handlers the parent is set correctly. I guess it must have something to do with the way the control tree is loaded. So to get around this you can just get the parent in the controls Loaded event.

For an example checkout this question [WPF User Control's DataContext is Null](https://stackoverflow.com/questions/296503/wpf-user-controls-datacontext-is-null)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-06-06T14:17:24.887

另一种方式：

```
var main = App.Current.MainWindow as MainWindow; 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-06-18T13:39:45.110

它对我有用：

```
DependencyObject GetTopLevelControl(DependencyObject control)
{
    DependencyObject tmp = control;
    DependencyObject parent = null;
    while((tmp = VisualTreeHelper.GetParent(tmp)) != null)
    {
        parent = tmp;
    }
    return parent;
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-07-08T11:42:13.200

如果您只想获取特定的父级，不仅是窗口，树结构中的特定父级，也不使用递归或硬中断循环计数器，您可以使用以下内容：

```
public static T FindParent<T>(DependencyObject current)
    where T : class 
{
    var dependency = current;

    while((dependency = VisualTreeHelper.GetParent(dependency) ?? LogicalTreeHelper.GetParent(dependency)) != null
        && !(dependency is T)) { }

    return dependency as T;
} 
```

只是不要将此调用放在构造函数中（因为该`Parent`属性尚未初始化）。将其添加到加载事件处理程序或应用程序的其他部分。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-03-11T16:48:58.607

这对我不起作用，因为它在树上走得太远了，并且获得了整个应用程序的绝对根窗口：

```
Window parentWindow = Window.GetWindow(userControlReference); 
```

但是，这可以立即获得窗口：

```
DependencyObject parent = uiElement;
int avoidInfiniteLoop = 0;
while ((parent is Window)==false)
{
    parent = VisualTreeHelper.GetParent(parent);
    avoidInfiniteLoop++;
    if (avoidInfiniteLoop == 1000)
    {
        // Something is wrong - we could not find the parent window.
        break;
    }
}
Window window = parent as Window;
window.DragMove(); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-08-23T14:17:38.057

```
DependencyObject GetTopParent(DependencyObject current)
{
    while (VisualTreeHelper.GetParent(current) != null)
    {
        current = VisualTreeHelper.GetParent(current);
    }
    return current;
}

DependencyObject parent = GetTopParent(thisUserControl); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-05-18T17:18:20.347

```
DependencyObject parent = ExVisualTreeHelper.FindVisualParent<UserControl>(this); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-06-05T00:34:06.153

只有在窗口初始化（方法完成）`Window.GetWindow(userControl)`后才会返回实际窗口。`InitializeComponent()`

这意味着，如果您的用户控件与其窗口一起初始化（例如，您将用户控件放入窗口的 xaml 文件中），那么在用户控件的`OnInitialized`事件中您将不会获得窗口（它将为空），导致这种情况下，用户控件的`OnInitialized`事件在窗口初始化之前触发。

这也意味着如果您的用户控件在其窗口之后被初始化，那么您可以在用户控件的构造函数中获取该窗口。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-06-28T10:25:13.170

不同的方法和不同的策略。在我的情况下，我无法通过使用 VisualTreeHelper 或 Telerik 的扩展方法找到给定类型的父级来找到我的对话框窗口。相反，我发现我的对话框视图接受使用 Application.Current.Windows 自定义注入内容。

```
public Window GetCurrentWindowOfType<TWindowType>(){
 return Application.Current.Windows.OfType<TWindowType>().FirstOrDefault() as Window;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-06-02T16:26:13.687

上面的镀金版本（我需要一个通用函数，它可以`Window`在 a 的上下文中推断 a `MarkupExtension`：-

```
public sealed class MyExtension : MarkupExtension
{
    public override object ProvideValue(IServiceProvider serviceProvider) =>
        new MyWrapper(ResolveRootObject(serviceProvider));
    object ResolveRootObject(IServiceProvider serviceProvider) => 
         GetService<IRootObjectProvider>(serviceProvider).RootObject;
}

class MyWrapper
{
    object _rootObject;

    Window OwnerWindow() => WindowFromRootObject(_rootObject);

    static Window WindowFromRootObject(object root) =>
        (root as Window) ?? VisualParent<Window>((DependencyObject)root);
    static T VisualParent<T>(DependencyObject node) where T : class
    {
        if (node == null)
            throw new InvalidOperationException("Could not locate a parent " + typeof(T).Name);
        var target = node as T;
        if (target != null)
            return target;
        return VisualParent<T>(VisualTreeHelper.GetParent(node));
    }
} 
```

`MyWrapper.Owner()`将根据以下基础正确推断窗口：

*   遍历可视化树的根`Window`（如果在 a 的上下文中使用`UserControl`）
*   使用它的窗口（如果它在 a`Window`的标记的上下文中使用）

# html - displaytag 表列总计

> ID：302859
> 
> 赞同：0
> 
> 时间：2008-11-19T18:21:37.163
> 
> 标签：html, jsp, html-table, displaytag

我正在使用[displaytag](http://displaytag.homeip.net/displaytag-examples-1.1/example-columnsummation.jsp) JSP 标记库来生成显示列总计的表格。例如，在下面的 JSP 代码中，只有具有该属性的列`total="true"`才会生成总计。

```
<display:table name="myTable" id="myTable" decorator="org.displaytag.decorator.TotalTableDecorator">
    <display:column property="name" title="Name" />
    <display:column property="description" title="Description" />

    <display:column property="openCount" title="Opened" total="true"/>
    <display:column property="revenueTotal" title="Commission" total="true"/>
</display:table> 
```

问题是 displaytag 将这些总计放在 `<tr>`表格正文的最后，但我需要将它们放在表格页脚内 `<tfoot>`。如果不对 JavaScript 中生成的 HTML 进行后处理，这是否可行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-19T18:40:47.920

看一下[display:footer](http://displaytag.sourceforge.net/11/displaytag/tagreference.html#footer)（这是@tvanfosson 引用的示例的工作方式）

# python - 如何使用 distutils 安装 Python 扩展模块？

> ID：302867
> 
> 赞同：2
> 
> 时间：2008-11-19T18:23:33.463
> 
> 标签：python, module, distutils

我正在开发一个名为“lehmer”的 Python 包，其中包括一堆用 C 编写的扩展模块。目前，我有一个扩展模块“rng”。我正在使用 Python 的 Distutils 来构建和安装模块。我可以编译和安装模块，但是当我尝试使用`import lehmer.rng`or导入模块时`from lehmer import rng`，Python 解释器会抛出`ImportError`异常。我可以很好地导入“lehmer”。

这是我的`setup.py`文件的内容：

```
from distutils.core import setup, Extension

exts = [Extension("rng", ["lehmer/rng.c"])]

setup(name="lehmer",
      version="0.1",
      description="A Lehmer random number generator",
      author="Steve Park, Dave Geyer, and Michael Dippery",
      maintainer="Michael Dippery",
      maintainer_email="mpd@cs.wm.edu",
      packages=["lehmer"],
      ext_package="lehmer",
      ext_modules=exts) 
```

当我列出 Python`site-packages`目录的内容时，我看到以下内容：

```
th107c-4 lehmer $ ls /scratch/usr/lib64/python2.5/site-packages/lehmer
__init__.py  __init__.pyc  rng.so* 
```

我的`PYTHONPATH`环境变量设置正确，所以这不是问题（如前所述，我可以`import lehmer`很好，所以我*知道*这`PYTHONPATH`不是问题）。Python 使用以下搜索路径（由 报告`sys.path`）：

```
['', '/scratch/usr/lib64/python2.5/site-packages', '/usr/lib/python25.zip', '/usr/lib64/python2.5', '/usr/lib64/python2.5/plat-linux2', '/usr/lib64/python2.5/lib-tk', '/usr/lib64/python2.5/lib-dynload', '/usr/lib64/python2.5/site-packages', '/usr/lib64/python2.5/site-packages/Numeric', '/usr/lib64/python2.5/site-packages/PIL', '/usr/lib64/python2.5/site-packages/SaX', '/usr/lib64/python2.5/site-packages/gtk-2.0', '/usr/lib64/python2.5/site-packages/wx-2.8-gtk2-unicode', '/usr/local/lib64/python2.5/site-packages'] 
```

## 更新

在 OpenSUSE 10 机器上使用时它可以工作，但在 Mac OS X 上测试时仍然无法加载 C 扩展。以下是 Python 解释器的结果：

```
>>> sys.path
['', '/usr/local/lib/python2.5/site-packages', '/opt/local/lib/python25.zip', '/opt/local/lib/python2.5', '/opt/local/lib/python2.5/plat-darwin', '/opt/local/lib/python2.5/plat-mac', '/opt/local/lib/python2.5/plat-mac/lib-scriptpackages', '/opt/local/lib/python2.5/lib-tk', '/opt/local/lib/python2.5/lib-dynload', '/opt/local/lib/python2.5/site-packages']
>>> from lehmer import rng
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: cannot import name rng
>>> import lehmer.rngs
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named rngs
>>> import lehmer.rng 
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named rng
>>> from lehmer import rngs
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: cannot import name rngs 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T16:41:37.177

作为记录（因为我厌倦了看到这个标记为未回答），这里有问题：

1.  由于当前目录自动添加到 Python 包路径中，解释器首先在当前目录中查找包；由于某些 C 模块未在当前目录中编译，因此解释器找不到它们。**解决方案：**不要从存储代码工作副本的同一目录启动解释器。
2.  Distutils 没有在 OS X 上安装具有正确权限的模块。**解决方案：**修复权限。

# bots - 开发一个机器人用作与 java 的 gtalk 联系人

> ID：302885
> 
> 赞同：-3
> 
> 时间：2008-11-19T18:30:27.693
> 
> 标签：bots, google-talk

我想开发一个可以从 gtalk 聊天的机器人，并且我有一些 java 经验。
我不想将机器人用于 IA 目的。
我想使用机器人来模拟像 xterm 这样的控制台。

**编辑：**
好的：问题是“关于如何开发它的任何线索？”
谢谢你的遮阳篷。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T18:31:58.313

Google Talk 使用 XMPP。您可以考虑使用[Smack](http://www.igniterealtime.org/projects/smack/index.jsp)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-01T12:06:54.443

我认为将您的机器人托管为[Google App Engine](http://code.google.com/appengine)应用程序的最简单方法。它内置了对接收和发送 XMPP 消息的支持。

# apache-flex - 滚动时如何重绘我的 degrafa 背景？

> ID：302890
> 
> 赞同：0
> 
> 时间：2008-11-19T18:32:20.950
> 
> 标签：apache-flex, scroll, degrafa

我正在使用具有 degrafa 背景的画布，到目前为止一切都很好。

但是，滚动时，背景（degrafa 网格）不会重绘。在代码中，背景笔画与容器高度相关联。即使滚动，容器高度也不会改变。

如何获得整个区域的高度，以便将新高度设置为我的 degrafa 背景？

它看起来像这样：

![degrafa 背景示例](https://i.stack.imgur.com/9GzZR.png)

```
 <mx:Canvas id="blackBoard"
                width="100%" 
                height="100%" 
                x="0" 
                y="0" 
                backgroundColor="#444444"
                clipContent="true">

    <!-- Degrafa Surface   -->
    <degrafa:Surface id="boardSurfaceContainer">
            <degrafa:strokes>
                <degrafa:SolidStroke    id="whiteStroke"
                                        color="#EEE"
                                        weight="1"
                                        alpha=".2"/>
            </degrafa:strokes>

            <!-- Grid drawing -->
            <degrafa:GeometryGroup id="grid">
                <degrafa:VerticalLineRepeater   count="{blackBoard.width / ApplicationFacade.settings.GRID_SIZE}"
                                                stroke="{whiteStroke}"
                                                x="0"
                                                y="0"
                                                y1="{blackBoard.height}"
                                                offsetX="0"
                                                offsetY="0"
                                                moveOffsetX="{ApplicationFacade.settings.GRID_SIZE}"
                                                moveOffsetY="0"/>

                <degrafa:HorizontalLineRepeater count="{blackBoard.height / ApplicationFacade.settings.GRID_SIZE}"
                                                stroke="{whiteStroke}"
                                                x="0"
                                                y="0"
                                                x1="{blackBoard.width}"
                                                offsetX="0"
                                                offsetY="0"
                                                moveOffsetX="0"
                                                moveOffsetY="{ApplicationFacade.settings.GRID_SIZE}"/>

            </degrafa:GeometryGroup>          

        </degrafa:Surface> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-20T00:01:14.047

我只需要在 degrafa 属性绑定中使用滚动位置

```
 <degrafa:VerticalLineRepeater   count="{(blackBoard.width + blackBoard.horizontalScrollPosition)/ ApplicationFacade.settings.GRID_SIZE}"
                                            stroke="{whiteStroke}"
                                            x="0"
                                            y="0"
                                            y1="{blackBoard.height + blackBoard.verticalScrollPosition}"
                                            offsetX="0"
                                            offsetY="0"
                                            moveOffsetX="{ApplicationFacade.settings.GRID_SIZE}"
                                            moveOffsetY="0"/> 
```

# wcf - 在 WCF 中传递原始调用者

> ID：302893
> 
> 赞同：2
> 
> 时间：2008-11-19T18:33:05.753
> 
> 标签：wcf, security, identity

我们目前有这样的设置：

```
lan\john       lan\application1    lan\appService1      lan\appService2 
client ------> website ----------> WCF Service1 ------> WCF Service2 
```

因此，每个网站/服务都作为设置在活动目录中的不同身份帐户运行。安全检查基于直接调用者的身份（即 WCF Service2 将验证其调用者 lan\appService1 是否有权执行该任务）。

出于记录目的，尽管我们需要知道原始调用者是谁（在此示例中为 lan\john），以便我们可以记录他们执行的操作。我想要一种以比目前更安全的方式执行此操作的方法（将“lan\john”字符串作为每次调用的消息头传递）。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T17:06:35.470

如果只是检查 WCF 服务调用者的安全性，您可以在[此处查看](http://blogs.msdn.com/b/ericwhite/archive/2010/05/13/determining-caller-identity-within-a-wcf-web-service.aspx)msdn 建议的机制。

对于整个应用程序，如果您想在此阶段启用身份模拟，您可以探索msdn 上[解释的设计模式。](http://msdn.microsoft.com/en-us/library/ff650591.aspx)

# regex - 正则表达式解析 ID3 标签

> ID：302897
> 
> 赞同：0
> 
> 时间：2008-11-19T18:33:20.620
> 
> 标签：regex, vb.net

我正在制作一个 mp3 id3tag 编辑器，但正则表达式不匹配。有人可以帮我吗？我的代码：

```
arquivo = "[coletanea] album [CD #] [faixa] [artista] musica.mp3"

r = New Regex("^\[(?<1>[^\]]+?)\]\s*(?<2>[\w\s]+)\s*\[CD\s*(?<3>\d+)\]\s*\[(?<4>\d+)\]\s*\[(?<5>[^\]]+)\]\s*(?<6>.+)", RegexOptions.Compiled)
m = r.Match(Mid(arquivo, 1, Len(arquivo) - 4))
        If m.Success Then
            mAuthor = Trim(m.Groups(5).ToString)
            mWM_AlbumTitle = Trim(m.Groups(2).ToString)
            mWM_TrackNumber = Trim(m.Groups(4).ToString)
            mTitle = Trim(m.Groups(6).ToString)
            mWM_PartOfSet = Trim(m.Groups(3).ToString)
            mMW_AlbumArtist = Trim(m.Groups(1).ToString)
        End If 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T18:46:48.750

那是因为你的字符串永远不会匹配你正在使用的正则表达式。

正则表达式需要一个数字而不是 # 和一个数字而不是 'faixa'

试试这个，例如：

```
"[coletanea] album [CD 20] [89] [artista] musica.mp3" 
```

如果您希望允许使用任何字符而不仅仅是数字，请将 \d 替换为 . 在第 3 组和第 4 组中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T18:47:13.913

好吧，您的字符串与正则表达式不匹配（因为 '#' 和 'faixa' 不是数字）尝试使用此字符串女巫我猜是您将从系统获得的字符串：

```
"[coletanea] album [CD 1] [1] [artista] musica.mp3" 
```

将捕获组命名为这样的数字也有点奇怪，因为默认情况下，这些组将从 0 开始命名。

# entity-framework - 实体框架验证和使用

> ID：302912
> 
> 赞同：13
> 
> 时间：2008-11-19T18:41:15.987
> 
> 标签：entity-framework, validation

我知道有一个 AssociationChanged 事件，但是，在建立关联后会触发此事件。没有 AssociationChanging 事件。那么，如果我出于某种验证原因想抛出异常，我该如何执行此操作并恢复到我的原始值？

另外，我想根据来自其他实体的信息为我的实体设置默认值，**但只有在我知道实体被实例化以插入数据库时​​才这样做**。我如何区分它与实例化的对象之间的区别，因为它即将根据现有数据进行填充？我应该知道吗？是否应该在我的实体业务逻辑之外进行考虑的业务逻辑？

如果是这样，那么我应该设计控制器类来包装所有这些实体吗？我担心的是，如果我返回一个实体，我希望客户端能够访问属性，但我希望对它们的设置、默认等验证保持严格控制。我看到的每个示例都引用上下文，这超出了我的实体部分类验证，对吗？

顺便说一句，我查看了 EFPocoAdapter 并且在我的一生中无法确定如何从我的 POCO 类中填充列表......有人知道我如何从 EFPoco 类中获取上下文吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-12-23T19:11:45.390

这是对我留下的评论的回复。希望这能回答你的问题，Shimmy。只需发表评论，如果它不能回答您的问题，我会缩短或删除它。

您将需要在您的类上实现 INotifyPropertyChanging 和 INotifyPropertyChanged 接口（除非它类似于实体框架对象，我相信它在内部实现了这些）。

在为此属性设置值之前，您需要使用 PropertyChangingEventArgs 构造函数中的属性名称引发 NotifyPropertyChanging.PropertyChanging 事件。

设置此值后，您需要引发 NofityPropertyChanged.PropertyChanged 事件，再次使用在 PropertyChangedEventArgs 构造函数中引发的属性名称。

然后你必须处理 PropertyChanging 和 PropertyChanged 事件。在 PropertyChanging 事件中，您需要缓存该值。在 PropertyChanged 事件中，可以比较并抛出异常。

要从 PropertyChanging/PropertyChanged 事件参数中获取属性，您需要使用 relfection。

```
// PropertyName is the key, and the PropertyValue is the value.
Dictionary <string, object> propertyDict = new Dictionary<object, object>();

    // Convert this function prototype to C# from VBNet.  I like how Handles is descriptive.
    Public Sub PropertyChanging(sender As object, e As PropertyChangingEventArgs) Handles Foo.PropertyChanging
    {
      if (sender == null || preventRecursion)
      {
        return;
      } // End if

      Type senderType = sender.GetType();
      PropertyInfo info = senderType.GetProperty(e.PropertyName);
      object propertyValue = info.GetValue(sender, null);

      // Change this so it checks if e.PropertyName already exists.
      propertyDict.Add(e.PropertyName, propertyValue);
    } // End PropertyChanging() Event

     // Convert this function prototype to C# from VBNet.  I like how Handles is descriptive.
    Public Sub PropertyChanged(sender As object, e As PropertyChangedEventArgs) Handles Foo.PropertyChanged
    {
      if (sender == null || preventRecursion)
      {
        return;
      } // End if

      Type senderType = sender.GetType();
      PropertyInfo info = senderType.GetProperty(e.PropertyName);
      object propertyValue = info.GetValue(sender, null);

      // Change this so it makes sure e.PropertyName exists.
      object oldValue = propertyDict(e.PropertyName);
      object newValue = propertyValue;

      // No longer needed.
      propertyDict.Remove(e.PropertyName);

      if (/* some condition */)
      {
        try {
          preventRecursion = true;
          info.SetValue(oldValue, null);
          Throw New Exception();
        } finally {
          preventRecursion = false;
        } // End try
      } // End if
    } // End PropertyChanging() Event 
```

注意我是如何使用PreventRecursion的，这是一个我忘记在这些方法之上添加的布尔值？当您将属性重置为之前的值时，将调用这些事件。

tl;博士

现在您可以派生一个从 INotifyPropertyChanged 继承的事件，但使用一个参数，该参数包含一个表示先前值的对象以及属性名称。这会将被触发的事件数量减少到一个，具有类似的功能，并且与 INotifyPropertyChanged 具有向后兼容性。

但是如果你想在设置属性之前处理任何事情（比如属性做了不可逆的更改，或者你需要在设置该变量之前设置其他属性，否则会抛出异常）你将无法做到这一点。

总的来说，这种方法是一种非常古老的做事方式。我会接受 Poker Villian 的回答，并且可以输入无效数据。但不允许保存到数据库。

实体框架有一些优秀的验证代码。您可以通过属性向您的属性添加验证。然后它负责处理这些属性的工作。然后您可以创建一个名为 IsValid 的属性，该属性调用实体框架特定的验证。它还区分了字段错误（如输入错误字符或字符串太长）和类错误（如缺少数据或键冲突）。

然后您可以将 IsValid 绑定到控件验证，当输入无效数据时它们会显示一个红色气泡。或者您可以自己实现 IsValid 验证。但如果 IsValid 为 false，SaveChanges 事件将需要取消保存。

顺便提一句。提供的代码不会编译并且只是伪代码（混合 vb 和 c#）。但我相信它比单独的 c# 更具描述性——准确地显示正在处理的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-11T23:19:14.210

It's a serious lack not having an AssociationChanging (that inherits from [`CancelEventArgs`](http://msdn.microsoft.com/en-us/library/system.componentmodel.canceleventargs.aspx)) event.

It bothers me also very much, therefore I reported this to Microsoft Connect **[Please vote here!](http://data.uservoice.com/forums/72025-ado-net-entity-framework-ef-feature-suggestions/suggestions/1058879-associationchanging-event)**

And BTW, I also think this is also stupid that the PropertyChangingEventArgs doesn't inherit CancelEventArgs, since cancelling with an exception is not always the elegant solution, besides, throwing exceptions cost more performance than calling the OnPropertyChangingEvent then check for the returned e.Cancel, so does it cost less than raising the PropertyChangingEvent, which you anyway call them both.
Also an exception can be thrown at the handler anyway instead of marking e.Cancel as true, for those who insist to go the Exception way. **[Vote Here](https://connect.microsoft.com/VisualStudio/feedback/details/580994/propertychangingeventargs-class-should-inherit-from-canceleventargs)**.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-19T17:36:20.483

关于您的第一个问题，我将简单地将关联的更改实现为业务逻辑。例如，如果您添加一个有多个学生的教师类，请不要添加学生，例如

```
aTeacher.Students.Add(new Student) 
```

相反，创建一个 AddStudent 方法

```
public Student AddNewStudent(string name, string studentID)
{

    Student s = new Student( name, studentID);
    s.Teacher = this; // changes the association
    return s;
} 
```

这样，您就可以完全控制何时更改关联。当然，是什么阻止了其他程序员直接添加学生？在学生端，您可以将教师设置器设置为私有（并将构造函数更改为接受教师或类似的）。在教师方面，如何使学生集合不可插入？我不确定...也许将其转换为不接受插入的自定义集合。

关于问题的第二部分，您可能可以使用 OnVarNameChanging 事件。如果 EntityState 是“新”，那么您可以应用获取实际值的逻辑。

当您保存更改时还会触发一个事件（OnSavingChanges？），您可以使用该事件来确定哪些对象是新对象并设置一些值。

但也许最简单的解决方案是始终在构造函数中设置默认值，如果从数据库加载数据，它们将被覆盖。

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-23T21:46:10.083

根据您的需要创建一个为您生成实例的工厂，例如：

```
getStudent(String studentName, long studentId, Teacher teacher) {
    return new Student(studentName, studentId);
}

getStudentForDBInseration(String studentName, long studentId, Teacher teacher) {
    Student student = getStudent(studentName, studentId);
    student = teacher;
    //some entity frameworks need the student to be in the teachers student list
    //so you might need to add the student to the teachers student list
    teacher.addStudent(student);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-08T15:21:16.440

要回答您的部分问题或阐述 ADB 的答案，您可以使用 ObjectStateManager.GetObjectStateEntry 来查找实体的状态并编写您的自定义默认逻辑。

SaveChanges 是您可以在上下文中使用的方法，或者 SavingChanges 是在调用 SaveChanges 之前发生的事件。

如果您不想中止更改，您可以覆盖 SaveChanges 并仅调用 base.SaveChanges

上下文还有一个 ObjectMaterialized 事件。

在两者之间，您可以将所有验证和创建代码粘贴在一个位置，如果它们很复杂并且包含其他对象的值等，这可能是合适的。

# c++ - CRC32 C 或 C++ 实现

> ID：302914
> 
> 赞同：57
> 
> 时间：2008-11-19T18:41:37.747
> 
> 标签：c++, c, crc32

我正在寻找 C 或 C++ 中的 CRC32 实现，该实现被明确许可为免费或公共领域。[这里](http://www.networkdls.com/Software/View/CRC32)的实现看起来不错，但它对许可证的唯一说明是“源代码”，这还不够好。我更喜欢非 LGPL，这样我就不必胡闹 DLL（我的应用程序是封闭源代码的）。我在 zlib 中看到了 adler32 的实现，但我正在检查一小块数据，adler 不适合。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-11-19T19:16:30.593

SNIPPETS [C 源代码存档](http://web.archive.org/web/20080217222203/http://c.snippets.org/)具有可免费使用的[CRC32 实现](http://web.archive.org/web/20080303102530/http://c.snippets.org/snip_lister.php?fname=crc_32.c)：

```
/* Copyright (C) 1986 Gary S. Brown.  You may use this program, or
   code or tables extracted from it, as desired without restriction.*/ 
```

（不幸的是，c.snippets.org 似乎已经死了。幸运的是，[Wayback Machine](http://web.archive.org/)已将其存档。）

为了能够编译代码，您需要将 typedefs 添加为`BYTE`无符号 8 位整数和`DWORD`无符号 32 位整数，以及头文件[crc.h](http://web.archive.org/web/20080303093609/http://c.snippets.org/snip_lister.php?fname=crc.h)和[sniptype.h](http://web.archive.org/web/20080303103500/http://c.snippets.org/snip_lister.php?fname=sniptype.h)。

标题中唯一的关键项是这个宏（它可以很容易地进入 CRC_32.c 本身：

```
#define UPDC32(octet, crc) (crc_32_tab[((crc) ^ (octet)) & 0xff] ^ ((crc) >> 8)) 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-03T13:26:35.880

我是指定链接源代码的作者。虽然源代码许可的意图尚不清楚（将在今天晚些时候发布），但代码实际上是开放且免费的，可在您的免费或商业应用程序中免费使用，不附带任何条件。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-11-19T18:47:21.917

使用[Boost C++ 库](http://www.boost.org/)。那里包含一个[CRC](http://www.boost.org/doc/libs/release/libs/crc/index.html)，并且[许可证](http://www.boost.org/LICENSE_1_0.txt)很好。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2012-02-21T05:33:40.473

zlib (http://zlib.net/) 中的 crc 代码是最快的代码之一，并且具有非常自由的开源许可证。

并且您不应该使用 adler-32，除非是速度比错误检测性能更重要的特殊应用程序。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2014-07-29T15:08:23.933

使用 zlib.h ( [http://refspecs.linuxbase.org/LSB_3.0.0/LSB-Core-generic/LSB-Core-generic/zlib-crc32-1.html](http://refspecs.linuxbase.org/LSB_3.0.0/LSB-Core-generic/LSB-Core-generic/zlib-crc32-1.html) ):

```
#include <zlib.h>
unsigned long  crc = crc32(0L, Z_NULL, 0);
crc = crc32(crc, (const unsigned char*)data_address, data_len); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-10-05T11:28:37.847

[**pycrc**](http://www.tty1.net/pycrc/)是一个生成 C CRC 代码的 Python 脚本，具有选择 CRC 大小、算法和模型的选项。

它是在 MIT 许可下发布的。你的目的可以接受吗？

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-01-25T19:34:03.400

我发现的最简单直接的 C/C++ 实现在本页底部的链接中：

网页：[http ://www.barrgroup.com/Embedded-Systems/How-To/CRC-Calculation-C-Code](http://www.barrgroup.com/Embedded-Systems/How-To/CRC-Calculation-C-Code)

代码下载链接：[https ://barrgroup.com/code/crc.zip](https://barrgroup.com/code/crc.zip)

它是一个简单的独立实现，带有一个 .h 和一个 .c 文件。通过使用定义支持 CRC32、CRC16 和 CRC_CCITT。此外，如果您愿意，该代码还允许用户更改参数设置，例如 CRC 多项式、初始/最终 XOR 值和反射选项。

该许可证没有明确定义 ala LGP​​L 或类似的。然而，该网站确实表示他们将代码置于公共领域以供任何使用。实际的代码文件也这么说。

希望能帮助到你！

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-01-03T20:33:49.170

mhash[库](http://mhash.sourceforge.net/)对我来说非常好用。它足够快，支持多种类型的哈希（crc32、MD5、SHA-1、HAVAL、RIPEMD128、RIPEMD160、TIGER、GOST 等）。要获取字符串的 CRC32，您可以执行以下操作：

```
 MHASH td = mhash_init(MHASH_CRC32);

 if (td == MHASH_FAILED) return -1; // handle failure

 mhash(td, s, strlen(s));

 unsigned int digest = 0; // crc32 will be stored here

 mhash_deinit(td, &digest);

 // do endian swap here if desired 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-04-25T18:53:33.097

[rurban 的 SMHasher 分支](https://github.com/rurban/smhasher)（最初的 SMHasher 似乎已被废弃）具有硬件 CRC32 支持。更改是在初始提交之前添加的，但尝试比较[新的 CMakeLists.txt](https://github.com/rurban/smhasher/blame/fbb0fda71354140899a9c347c3057d159d18537a/CMakeLists.txt#L35)和[旧的](https://code.google.com/p/smhasher/source/browse/trunk/CMakeLists.txt)（根本没有提到 SSE）。

最好的选择可能是英特尔的 zlib 分支，[本文](http://www.intel.com/content/dam/www/public/us/en/documents/white-papers/fast-crc-computation-generic-polynomials-pclmulqdq-paper.pdf)描述了[支持 PCLMULQDQ](https://github.com/jtkukunas/zlib)的功能。该库[还具有 SSE 4.2 优化](https://github.com/jtkukunas/zlib/blob/e176b3c23ace88d5ded5b8f8371bbab6d7b02ba8/deflate.c#L190)。

如果您不需要可移植性并且使用的是 Linux，则可以使用内核的实现（如果可用，它是硬件加速的）：[https ://stackoverflow.com/a/11156040/309483](https://stackoverflow.com/a/11156040/309483)

# asp.net - ASP.NET Web 部件是实现门户架构的可行技术吗

> ID：302918
> 
> 赞同：5
> 
> 时间：2008-11-19T18:43:30.053
> 
> 标签：asp.net, asp.net-ajax, widget, web-parts

Web 部件似乎在 Sharepoint 相关开发中被广泛使用，但在 asp.net webforms 应用程序中使用它们的例子很少而且相差甚远。我正在实现一个特定领域的门户框架，并且喜欢 iGoogle 或 pageflakes 中的“widgetlike”功能，并希望在我的应用程序中获得这种功能。从我的角度来看，真正令人不安的问题是，除非您使用最新的 ASP.NET AJAX 期货库，否则 Web 部件的拖放布局功能在非 IE 浏览器中不起作用。在我看来，如果微软打算将其作为一项基础技术，他们现在应该已经将这些功能转移到了主要产品中。

Web 部件是一种死胡同吗？如果是这样，是否有任何替代方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T19:02:18.330

我认为他们已经（死了），至少对于开发现代网络浏览器正在寻找的 UI 类型。我的建议... ASP.NET MVC 和一个不错的 .js 库。这是更多的工作，但通过适当的规划和实施，从长远来看，它将为您提供更好的服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-17T21:07:48.467

我发现了一个非常棒的网站，介绍了一些实现类似 WebParts 的行为的技巧：http: [//blogs.msdn.com/b/nunos/archive/2010/02/16/quick-tips-about-asp-net-mvc- webpart-framework.aspx](http://blogs.msdn.com/b/nunos/archive/2010/02/16/quick-tips-about-asp-net-mvc-webpart-framework.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T18:48:43.740

Webpart 是 .NET 基础结构的一部分，是一项基础技术。很少有接口技术可以使 webpart 与它们的 J2EE 对应物兼容。

# .net - 在 .NET 中加密数据的最佳做法是什么？

> ID：302936
> 
> 赞同：2
> 
> 时间：2008-11-19T18:48:54.287
> 
> 标签：.net, security, encryption

处理的最佳实践是什么

1.  应该散列的东西。即密码

和

2.  不能被散列但非常机密的东西，如果被泄露会造成巨大的痛苦。即信用卡、SSN、导弹发射代码。

哪种加密算法最强，最推荐？你如何处理钥匙？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T18:53:11.157

您可以在 .Net 中使用内置的加密库。有许多很好的对称和非对称加密算法（AES、RSA 等）其中许多算法让您可以选择所需的密钥强度（1024 位、2048 位等）。

存储您的密钥是一个更危险的情况。我建议不要在纯文本文件中。有一些算法可以将加密密钥分成两半，以便划分责任。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T19:04:02.663

关于散列，有用于执行散列操作的内置库（很像加密库），这使得散列存储值变得相当简单。

除了查看这些库之外，您还应该考虑在散列中添加“盐”，这实质上意味着在散列之前向正在散列的值添加一些额外的数据，并增加额外的安全层。这样，即使攻击者知道您使用了哪种散列算法，他们也不会轻易知道您在散列数据之前如何对数据进行加盐处理。

要考虑的另一件事是使用 System.Security.SecureString 在内存中移动这些未加密/未散列的受保护值。使用标准字符串意味着字符串中包含的数据以纯文本形式位于堆上，并且即使在字符串超出范围后实际上也可能会保留在那里一段时间。如果有人可以从机器中获取内存转储，他/她可能能够提取那些未受保护的数据。在某些情况下，这可能有点矫枉过正，但值得一看。

# mysql - MySQL - 每个 WHERE_IN 问题的棘手限制

> ID：302943
> 
> 赞同：1
> 
> 时间：2008-11-19T18:50:57.510
> 
> 标签：mysql, greatest-n-per-group

我正在寻找执行以下操作（请参阅伪代码）；我想为每个 gd.id（7、11 或 9）选择 4 行。我错误地使用了限制，因为总共只产生了 4 行。任何人都知道如何更改此查询以实现我的目标？

```
SELECT gd.gid, gd.aid, li.ads, li.til
FROM gd
JOIN li ON li.a_id = gd.aid
WHERE gd.gid
IN (
'7', '11', '9'
)
ORDER BY li.timestamp DESC
LIMIT 4 #FOR EACH ;-) 
```

谢谢！

冰

ps 也许是某种类型的 group_by？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T21:12:48.287

好的，既然我了解了您的表格之间的关系，我将发布第二个答案。

```
CREATE TABLE gd (
  aid INT AUTO_INCREMENT PRIMARY KEY,
  gid INT
);

INSERT INTO gd (gid) VALUES
  (7), (7), (7),                -- fewer than four rows
  (9), (9), (9), (9),           -- exactly four rows
  (11), (11), (11), (11), (11); -- greater than four rows

CREATE TABLE li (
  a_id INT AUTO_INCREMENT PRIMARY KEY,
  ads VARCHAR(10),
  til VARCHAR(10),
  `timestamp` TIMESTAMP
);

INSERT INTO li (ads, til, `timestamp`) VALUES
  ('foo1', 'bar1', '2008-01-01'),
  ('foo2', 'bar2', '2008-02-01'),
  ('foo3', 'bar3', '2008-03-01'),
  ('foo4', 'bar4', '2008-04-01'),
  ('foo5', 'bar5', '2008-05-01'),
  ('foo6', 'bar6', '2008-06-01'),
  ('foo7', 'bar7', '2008-07-01'),
  ('foo8', 'bar8', '2008-08-01'),
  ('foo9', 'bar9', '2008-09-01'),
  ('foo10', 'bar10', '2008-10-01'),
  ('foo11', 'bar11', '2008-11-01'),
  ('foo12', 'bar12', '2008-12-01'); 
```

因此，您需要前四行的每个值`gd.gid`，具体取决于`timestamp`关联表中的值`li`。

```
SELECT g1.gid, g1.aid, l1.ads, l1.til, l1.`timestamp`
FROM gd AS g1
  INNER JOIN li AS l1 ON (g1.aid = l1.a_id)
  LEFT OUTER JOIN (
    gd AS g2 INNER JOIN li AS l2 ON (g2.aid = l2.a_id)
  ) ON (g1.gid = g2.gid AND l1.`timestamp` <= l2.`timestamp`)
WHERE g1.gid IN ('7', '11', '9')
GROUP BY g1.aid
HAVING COUNT(*) <= 4
ORDER BY g1.gid ASC, l1.`timestamp` DESC; 
```

输出如下：

```
+------+-----+-------+-------+---------------------+
| gid  | aid | ads   | til   | timestamp           |
+------+-----+-------+-------+---------------------+
|    7 |   3 | foo3  | bar3  | 2008-03-01 00:00:00 | 
|    7 |   2 | foo2  | bar2  | 2008-02-01 00:00:00 | 
|    7 |   1 | foo1  | bar1  | 2008-01-01 00:00:00 | 
|    9 |   7 | foo7  | bar7  | 2008-07-01 00:00:00 | 
|    9 |   6 | foo6  | bar6  | 2008-06-01 00:00:00 | 
|    9 |   5 | foo5  | bar5  | 2008-05-01 00:00:00 | 
|    9 |   4 | foo4  | bar4  | 2008-04-01 00:00:00 | 
|   11 |  12 | foo12 | bar12 | 2008-12-01 00:00:00 | 
|   11 |  11 | foo11 | bar11 | 2008-11-01 00:00:00 | 
|   11 |  10 | foo10 | bar10 | 2008-10-01 00:00:00 | 
|   11 |   9 | foo9  | bar9  | 2008-09-01 00:00:00 | 
+------+-----+-------+-------+---------------------+ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-22T11:04:45.790

通常的做法是：

(SELECT * FROM table WHERE key=X LIMIT 4) UNION ALL (SELECT * FROM table WHERE key=Y LIMIT 4) UNION ALL (SELECT * FROM table WHERE key=Z LIMIT 4) ORDER BY ... LIMIT ...

请注意，它将实现 temptable 中的每个子选择，因此如果您的外部 LIMIT 较低而内部 LIMIT 较高，则效率不高。

# windows-server-2008 - 尝试在 Windows Server 2008 Web 版上运行 DNN 是否有任何陷阱？

> ID：302954
> 
> 赞同：1
> 
> 时间：2008-11-19T18:57:13.193
> 
> 标签：windows-server-2008, web-hosting, dotnetnuke, colocation, windows-server-2008-web

我正在考虑切换到运行 DNN (DotNetNuke) 安装和主要只进行别名转发的电子邮件服务器的共置解决方案。我想我可以在这个托管框之外获得 DNS 服务——但这可能是个问题。

我正在为一个非营利组织运营这个网站，并试图保持便宜。Windows Server 2008 Web Edition 是否可以运行所有这些？到目前为止，我的研究表明它会，但我正在寻找任何有运行网络版经验的人，它有什么样的陷阱？

我打算安装 SQL express 作为 DNN 站点的后端。有迹象表明您无法从 Web 版框外连接到 SQL。这包括 SQL 管理工作室吗？

对此的任何帮助或建议将不胜感激。

**更新：**

仍在寻找 Windows Server 2008**网络版的任何细节**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-20T18:41:03.303

不久前，我们尝试在 Windows 2008 64 位和 32 位上运行 DNN。间歇性故障和应用程序挂起不是很好的体验。我们不得不恢复到 Windows 2003。

这是在一个中等负载的网站上。如果您想为他们提供任何类型的正常运行时间/可用性保证，我会推荐 Windows 2003。

# jquery - 使用 jQuery 进行主动导航 - 无法将默认类应用于锚点

> ID：302955
> 
> 赞同：3
> 
> 时间：2008-11-19T18:57:14.067
> 
> 标签：jquery, navigation

我目前正在尝试将`navigation-menu`where an`active-class`应用于其`href`属性与当前 URL 匹配的锚点，因此我可以以一种使其从菜单的其余部分中脱颖而出的方式设置该锚点的样式。

这是我的标记：

```
<div id="sidebar">

  <h2>Navigation menu</h2>
  <h2 class="subnav"><a href="menu1/menu_item1">Menu item 1</a></h2>
  <h2 class="subnav"><a href="menu1/menu_item2">Menu item 2</a></h2>
  <h2 class="subnav"><a href="menu1/menu_item3">Menu item 3</a></h2>
  <h2 class="subnav"><a href="menu1/menu_item4">Menu item 4</a></h2>
  <h2 class="subnav"><a href="menu1/menu_item5">Menu item 5</a></h2>

</div> 
```

这是 jQuery：

```
 jQuery(function($) {

      // get the current url
      var path = location.pathname.substring(1); 

      // defining the top subnav anchor
      var $top_item = $('#sidebar h2:nth-child(2) a'); 

      // defining all subnav anchors
      var $all_items = $('#sidebar h2.subnav a'); 

      // defining the anchors with a href that matches the current url
      var $selected_item = $('#sidebar h2 a[@href$="' + path + '"]'); 

      // setting the selected menu item'class as active
      $selected_item.addClass('active'); 

      // THIS IS WHERE I THINK THE ERROR IS
      // if none of the h2.subnav's has a url that matches 
      // the current location then assume that it's the top one that's active:
      if ($all_items("href") !== path) $top_item.addClass('active');

  }); 
```

我正在使用 jQuery 应用活动类，只要锚点 href 和位置 url 之间存在匹配，它就可以正常工作。如果 url 与任何锚点不匹配，我希望将活动类应用于`$top_item`. 我的 jQuery 的那部分不起作用。

我看不出错误是什么，但我又有点像 Javascript/jQuery n00b。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T19:41:44.867

这应该是您想要的：**标记匹配的链接，如果失败，请标记您的默认链接。**

```
function markActiveLink() {

    //Look through all the links in the sidebar
   $("div#sidebar a").filter(function() {

      //Take the current URL and split it into chunks at each slash
      var currentURL = window.location.toString().split("/");

      //return true if the bit after the last slash is the current page name
      return $(this).attr("href") == currentURL[currentURL.length-1];

    //when the filter function is done, you're left with the links that match.
    }).addClass("active");

   //Afterwards, look back through the links. If none of them were marked,
   //mark your default one.
   if($("div#sidebar a").hasClass("active") == false) {
      $("div#sidebar h2:nth-child(2) a").addClass("active");
    }
 }

markActiveLink(); 
```

[另外，我在 jQuery Docs 网站上](http://docs.jquery.com/Tutorials:Auto-Selecting_Navigation)找到了一个官方教程——滚动到底部查看 jQuery 代码。它比我的更紧，虽然它不适合你的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T19:02:13.197

试一试这段代码，它是我为我工作的公司编写的。

```
// highlight tab function
var path = location.pathname;
var home = "/";
$("a[href='" + [path || home] + "']").parents("li").each(function() {   
    $(this).addClass("selected");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-06T04:19:05.287

伟大的阅读.. 但是，我必须提出一个建议.. 即使 JS 完美运行，你真的应该将所有菜单列表项保留在无序列表（或有序列表）中，.. 作为最佳实践.. :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T19:04:06.470

我认为您可以简化一下：

```
function highlightSelected()
{
  $("h2.subnav a").each(
    function()
    {
      if (location.pathname.indexOf(this.href) > -1)
      {
        $(this).addClass("selected");
      }
    }
  );
} 
```

# c# - NHibernate：检索非空一对一关联类的条件表达式

> ID：302956
> 
> 赞同：4
> 
> 时间：2008-11-19T18:57:49.713
> 
> 标签：c#, nhibernate, orm

我有两个与一对一映射关联的类：

```
<class name="Employee" table="Employees">
  ...
  <one-to-one name="Address" class="AddressInfo">
  ...
</class> 
```

我想使用标准表达式来仅获取关联地址类不为空的员工，如下所示（我知道这不起作用）：

```
IList employeesWithAddresses = sess.CreateCriteria(typeof(Employee))
    .Add( Expression.IsNotNull("Address") )
    .List(); 
```

我想这要么是一个非常困难的问题，要么几乎没有人尝试过这样做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-26T14:26:57.760

您是否尝试过为 Address 属性创建别名并检查 Address 的 ID/主键是否不为空？

就像是：

```
IList employeesWithAddresses = sess.CreateCriteria(typeof(Employee))
    .CreateCriteria("Address", "address").Add( Expression.IsNotNull("Id") )
    .List(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T10:38:57.610

要隐式触发一对一的别名/联接，您不应该使用点符号吗？然后检查您的地址类中的任何字段：

```
IList employeesWithAddresses = sess.CreateCriteria(typeof(Employee))
    .Add( Expression.IsNotNull("Address.Id") )
    .List(); 
```

这可能与 Kareena 的方法相同，但我相信这等于 .CreateAlias()。使用 CreateAlias，您可以指定 FetchMode（使用的连接类型），但由于您想要具有相应地址的行，所以这不应该是必要的（因为 INNER 是默认值）。检查它是否为空也不应该是必要的。

```
IList employeesWithAddresses = sess.CreateCriteria(typeof(Employee))
    .CreateAlias("Address")
    .List(); 
```

# ms-access - 当字段名称是动态的时vba制作表格

> ID：302958
> 
> 赞同：2
> 
> 时间：2008-11-19T18:59:16.450
> 
> 标签：ms-access, dynamic-data

我有一个交叉表查询，它使用动态日期函数来生成列标题，从而生成字段名称。例如： ForecastPeriod:DateAdd("m",[Period],[StartDate]) 这意味着每次运行交叉表查询时，我都可能得到不同的字段名称。我需要获取此交叉表的结果并将其与其他 3 个类似交叉表的结果结合起来以创建一个新表。现在我使用生成表查询和 3 个追加查询。我这样做的原因是在预测期间的范围内为每个材料项目包括 4 种不同类别的数据。

结果看起来像这样：

材料类别 Per1 值 ...Per2 值 ...... Per24 值

MatA 需求 0 ... 10 ....... 0

MatA 需求美元 $0 ... $10 ....... $0

MatA 预测 10 ... 20 .... 50

MatA 预测 美元 $10 ... $20 ....... $50

问题是已经针对当前交叉表查询的结果构建了生成表查询。当我下个月运行交叉表时，结果将具有不同的字段名称。因此，我被困在手动更改生成表查询设计中的句点，将不再出现在结果中的句点删除并添加新句点。

有没有办法在交叉表运行之前使用 VBA 创建新表而不知道字段名称？

或者有没有办法在运行后对字段名称进行编码或从交叉表中提取它们？

如果我使用如下代码： strSQL = "SELECT tblForecast.Material, tblForecast.Category, tblForecast.X " & _ "INTO tblTemp " & _ "FROM tblForecast;"

我真的不知道实际会调用什么 tblForecast.X 。可能是 11/1/08 或 12/1/08 等。

如果我声明一个变量来保存字段名称并使用日期代码来更改它，我如何将它添加到表中？我会使用 Alter Table 吗？

我相信这是可以做到的，我只是不知道该怎么做，所以任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-21T20:51:49.123

VBA 创建一个镜像查询列的表：

```
Dim db As DAO.Database
Dim tdf As DAO.TableDef
Dim qdf As DAO.QueryDef
Dim fld As DAO.Field
Dim SourceField As DAO.Field

Set db = CurrentDb

'Create a new tabledef
Set tdf = New DAO.TableDef

'Reference existing, saved querydef
Set qdf = db.QueryDefs("Query1")

tdf.Name = "Table2"

'iterate fields in the query and create fields in the new tabledef
For Each SourceField In qdf.Fields
    Set fld = tdf.CreateField(SourceField.Name, SourceField.Type, SourceField.Size)
    tdf.Fields.Append fld
Next

'Table is created and saved when the tabledef is appended to the current db
db.TableDefs.Append tdf 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T11:06:38.803

可以为交叉表使用您自己的标题，例如：

```
ColHead:"Month" & DateDiff("m",[SaleDate],Forms!frmForm!txtSomeDate) 
```

这将导致名为“月份”的列标题和来自 txtSomeDate 的偏移量。

也可以使用 vba 来构建您的新查询。

# windows-server-2003 - 需要生成持久性瞬态故障

> ID：302960
> 
> 赞同：1
> 
> 时间：2008-11-19T18:59:37.320
> 
> 标签：windows-server-2003, pop3, persistent, transient

更新：当我发现并非所有邮件服务器都根据“标准”返回错误时，4.xx 与 5.xx 成为我最不担心的问题。我现在选择将所有类型的退回邮件视为失败，但我将把这个问题留在这里，以防它得到答案并帮助其他人。

我的任务是编写一个程序来读取 POP3 帐户并区分作为永久失败（5.xx 传递状态）和持久性暂时失败（4.xx 传递状态）返回的邮件，对 4.x 进行重试。 xx DSN 并将电子邮件标记为不适合 5.xx DSN。手动编辑 DSN 主体以将 5.xx 更改为 4.xx 很容易，但管理层更愿意返回“真实的”4.xx。我这样做有很多麻烦。

测试环境是Windows 2003 Server，运行MS 的SMTP 和POP3。我已经尝试超过目标电子邮件地址（5.xx）的配额并锁定帐户（2.xx，他们无法收到电子邮件）。

这是租约结束通知，以防万一有人感兴趣，这就是为什么我们有兴趣将电子邮件标记为不良或重试失败不是永久性的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-03T07:22:07.320

产生瞬时故障并不难。想到几个：

*   某种本地别名扩展失败（这可能更像是 Unix 问题）
*   DNS 查找超时（将您的名称服务器更改为愚蠢的东西，或设置一个指向不存在的名称服务器的子域）
*   运行您的邮件服务器的磁盘空间不足

# apache-flex - 将 Ant 与 FlexBuilder 一起使用

> ID：302966
> 
> 赞同：3
> 
> 时间：2008-11-19T19:01:19.830
> 
> 标签：apache-flex, ant, flexbuilder

在使用 FlexBuilder 构建项目之前，我需要运行一些预编译步骤。我假设我需要使用 Ant 来执行此操作。任何人都知道的教程可以帮助我走上我的道路吗？我对 Ant 和 Eclipse (FlexBuilder) 几乎一无所知。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T19:35:58.153

我只使用 ant 来构建我所有的 Flex 应用程序。我写了一篇关于如何在 Linux 环境中设置 Flex/Ant 的教程，但很多内容都可以翻译成 windows：

[http://blog.apterainc.com/software/setting-up-a-flex-development-enviroment-in-gnulinux/](http://blog.apterainc.com/software/setting-up-a-flex-development-enviroment-in-gnulinux/)

此链接是 Adob​​e 关于如何在 Flex 中使用 ant 任务的说明（从安装到编译您的第一个 Flex 应用程序）：

[http://livedocs.adobe.com/flex/3/html/help.html?content=anttasks_1.html](http://livedocs.adobe.com/flex/3/html/help.html?content=anttasks_1.html)

如果您遇到任何问题，请在此处发布，我将帮助解决。

# apache - IIS 相当于 Apache 中的 VirtualHost

> ID：302968
> 
> 赞同：16
> 
> 时间：2008-11-19T19:01:26.880
> 
> 标签：apache, iis, virtualhost

是否有等效于 Apache 的 IIS 虚拟主机？我们希望能够从一个 IP 运行多个网站，并使用不同的 DNS 名称对它们进行寻址。

即我有

```
www.dom1.com
www.dom2.com
www.dom3.com 
```

这一切都指向`123.123.10.1`。Apache 将只在端口 80 上运行，并且只使用虚拟主机来决定应该为哪个站点提供服务。

这在 Windows IIS6 中可行吗？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-19T19:07:02.190

您想[在 IIS 中使用主机标头](http://www.visualwin.com/host-header/)- 该链接将指向一个很好的操作指南页面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-24T17:56:37.110

创建一个新的虚拟主机：

iis 管理器 --> (本地计算机) --> 右键单击​​网站 --> 新建 --> 网站

检查/更改/添加虚拟主机上的主机名信息（要识别的另一个主机名）：

iis 管理器-->（本地计算机）--> 网站--> 在其中一个站点上单击鼠标右键/属性--> 网站--> 高级--> “此网站的多个身份”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-08-05T06:44:24.557

在 IIS 7 中，您将在右侧 Actions 列的 Bindings 中添加 Edit Site，同时选择所需的站点。 [![如何在 IIS 中添加虚拟主机](https://i.stack.imgur.com/rSPv0.png)](https://i.stack.imgur.com/rSPv0.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-02-28T02:43:22.953

正如 rob_g 建议的那样，如果您已经有一个网站正在运行（例如默认网站），您还可以在网站上选择“编辑绑定”并指定一个主机名。

# xslt - 我没有得到 XSL 处理指令！

> ID：302969
> 
> 赞同：3
> 
> 时间：2008-11-19T19:01:37.880
> 
> 标签：xslt

XSL处理指令可以使用或应用什么样的场景？什么时候使用它们是好是坏？

干净的石板在这里，我对这个特定元素没有很好的处理。

来自 w3schools 的示例：

<xsl:processing-instruction name="process-name"> <!-- Content:template --> </xsl:processing-instruction>

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T22:13:11.893

它非常简单：`<xsl:processing-instruction>`如果您需要在输出 XML 中输出处理指令，您可以使用它。如果您的输出中不需要 PI，则不需要处理指令元素。

至于为什么您可能需要在输出中使用 PI，这完全取决于您的输出将用于什么。

我过去曾使用它们将`<?xml-stylesheet>`指令添加到我的输出中：

```
<!-- Link to the stylesheet for people who wander in. -->
<xsl:processing-instruction name='xml-stylesheet'>
        type="text/xsl"
        href="<xsl:value-of select='$stylesheet'/>"
        media="screen"
</xsl:processing-instruction> 
```

产生：

```
<?xml-stylesheet type="text/xsl" href="http://nedbatchelder.com/rss.xslt" media="screen"?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-06T12:35:50.263

当您想告诉处理 XML 的软件一些关于它处理的数据的信息时，您应该使用处理指令。PI 使您能够将数据及其结构与如何处理数据的命令分开。如果处理 XML 数据的软件不知道 PI，它将忽略它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T19:49:31.980

处理指令允许您将 <?php ?> 或 <?xml ?> 之类的内容插入到输出代码中。我自己从来没有真正找到它们的用途，所以如果你不理解它们，你可能不需要它们。[查看 XSLT 规范](http://www.w3.org/TR/xslt#section-Creating-Processing-Instructions)以获取更多详细信息和示例。

# agile - 老派与新派程序员的问题和/或好处

> ID：302970
> 
> 赞同：14
> 
> 时间：2008-11-19T19:01:43.917
> 
> 标签：agile, collaboration

我是一名刚毕业的大学毕业生，为一家劳动力老龄化的大公司工作。我很好奇人们在处理年龄差距方面的经验，最好是双方。

到目前为止我遇到的示例问题：

*   敏捷实践与瀑布
*   程序员与个性之间的协作
*   早起工作VS深夜工作

我在学校学习的主要是敏捷编程，而我正在从事的项目（大多数开发人员都习惯了瀑布）

我习惯于在项目上与同学和朋友合作，而我倾向于看到年长的程序员喜欢做自己的事情。我觉得我缠着他们问他们问题。

我发现自己更像是一个夜间程序员，但我的大多数年长同事都是清晨（凌晨 5 点）

任何关于技术工作年龄差距的经验都是相关的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-19T19:18:24.710

当我刚从大学毕业时，我是一个夜猫子，我会在早上很晚才开始工作，尽管我在其他人离开后会迟到几个小时。与其他人建立融洽的关系真的很难。当我试图提出问题或合作工作时，我也感到不受欢迎，这并不奇怪。

即使您的同事使用被认为已过时的瀑布方法，但这并不意味着他们的工作效率低下。一个成功的项目更多地与团队合作有关，而不是任何特定的方法。敏捷方法已经将这个想法编入了代码，但它仍然在任何成功的团队中非正式地实践。

你不会改变整个团队的工作方式，所以尝试一下他们的方式。在他们上班的时间上班。在茶歇时与他们交谈，并与他们共进午餐。提出开放式问题并听取他们的回答。您可能会惊讶地发现他们提供了一些有用的经验。

我还建议*不要*试图说服他们采用敏捷方法。相反，您实际上可以练习一些敏捷*方法*。例如，简单地请某人在你的肩膀上帮助解决一个棘手的问题（人们通常愿意展示他们解决棘手问题的技能）。瞧！你是结对编程。但不要这样称呼它！:-)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-19T19:11:55.300

可以这么说，我一直在围栏的两侧。

敏捷编程的问题在于，与任何工具一样，它并不总是适合任务。在某些环境中，瀑布方法仍然有效。

我不认为合作差异来自年龄差异，而是那家公司和工作环境培养的风格。我刚毕业就在一家国防承包商工作了一段时间，项目中几乎每个人都比我大很多，但合作非常频繁。另一方面，我曾在所有人年龄相仿且几乎没有合作的公司工作过。

人们要么喜欢回答问题/指导，要么不喜欢。年龄不一定有很大的不同。我曾与比我年长和年轻的人一起工作，但只有少数人真正喜欢回答问题（无论他们是否与项目相关）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-01T00:43:12.337

很好的问题。我从事这行已经快 50 年了，而且我还在学习。

我想如果我有一个抱怨的话，那就是几乎所有年轻的程序员都上过编程课，他们的脑子里充满了规范的判断。它让我想起了 Arthur C. Clarke 的小说《城市与星辰》，其中的人们被灌输了对走出城市边界的恐惧，这种恐惧远远超出了理性。

我主要是自学（在编程方面），并且我有其他类型的工程背景。在其他类型的工程中，没有任何想法像魔鬼（即 goto）或被提升为神话状态（OOP）那样令人恐惧。相反，每个想法都有其优点和缺点以及它或多或少有用的情况。一切都基于数学，并重视创造力。

虽然年轻的程序员聪明、乐于助人、精力充沛，但我希望他们更加好奇和开放。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-01T01:20:20.517

如果这听起来很刺耳，我提前道歉，我写这篇文章时实际上很有趣，因为你的情况一直在发生，也就是说，你不是第一个注意到工作中的“菜鸟”和“老人”之间的区别的人;-)

第一个缺陷：“老派”与“新派”——假设你的*前辈*是“老派”，因此低人一等，这叫做*偏见*，并不是开始你的职业生涯的好方法。

很有可能，“老学生”可以并且会在你周围编码圈子，*尤其是在他们的领域*。由于您的新工作取决于学习*他们的领域*，也许您应该先学习并与他们成为朋友，然后在赢得他们的尊重之后再尝试教他们……

...并且绝对要控制您的“新学校与旧学校”偏见；如果你的“老化”同事（好像你对老化免疫！）认为你是一个无所不知的“朋克”，没有人愿意帮助你。即使你真的知道这一切也没关系，没有人喜欢朋克。;-)

所以在最初的几个月里要假装谦虚，仔细聆听，并准备好在第一年的实际工作中学到比在大学里学到的更多的东西！

至于到目前为止您的具体问题，这是另一种看待它的方式：

*   瀑布与经验丰富的开发人员和一个移动速度不太快的目标一起工作得很好
*   你所说的“合作”我可以称之为“打断我的注意力”；代码往往由独立且不间断地工作的程序员最有效地编写；持续的多任务处理效率低下
*   在正常工作时间内工作是正常员工所做的；习惯它。当您的客户也在办公室时，在办公室有一个优势。当然也有缺点。两者之间的平衡称为“时间管理”;-)

作为企业的菜鸟，你*应该*问很多问题。只是不要像蹒跚学步的孩子那样每隔十秒钟就跳起来打断老年人，把一堆问题存起来，每天只打断他们几次。

好消息是，你问这个问题意味着*你关心*，只要你的前辈能感觉到你的这一点，他们也会关心你。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-19T19:25:48.610

我不认为您正在处理的问题与年龄有关。我与比我大一倍的程序员打过交道，并从他们身上学到了很多东西。反之亦然。

总有一天我会成为一名老程序员，但这并不意味着我必须成为“老派”。

继续学习并乐于接受新想法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-19T19:12:46.920

你需要融入团队，他们不会为了匹配你而改变，但这并不意味着你不能逐渐带来改变。

虽然你会发现有些人不喜欢回答问题，但如果你表现出你对这个主题真正感兴趣，大多数人会特别喜欢。

向团队负责人/经理询问一个您可以使用更现代的方法来完成的小项目（敏捷可能很难靠自己完成）。向人们展示它是有效的，并展示它是如何变得更好的。

要委婉，尽量不要让别人不高兴。记住“年老和背信弃义将击败青年和技能”。不要参加一场你无法获胜的战斗。人们会抵制改变。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-19T20:21:11.557

一如既往，这取决于环境和公司文化。如果您在早上 8 点到下午 5 点上班的公司工作，那么您是否喜欢晚上并不重要……

至于不同的方法，它实际上只取决于其他人如何“参与”它，以及最终是否产生任何结果。我自己来自 Cowboy Coder 方法组，但是当我从事一个需要大量协作的项目时，我必须稍微控制一下。而且无论方法多么出色，如果它妨碍按时交付产品，没人会在意。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-19T19:11:03.460

[瀑布](http://en.wikipedia.org/wiki/Waterfall_model)是一个有缺陷的、不能工作的软件开发模型的例子。不幸的是，听起来您无法向年迈的同事指出这一点。:)

我建议您不断向不同的人提问，直到找到似乎有兴趣指导您的人（或少数人）。在我的职业生涯中，我所接受的任何教育或培训都没有像我所拥有的一些非常好的导师的建议那样有价值。

一旦你找到了导师，我建议你试着按照他们的日程安排工作，至少一段时间。不要对提问感到难过，因为这是您学习的唯一方法（谷歌搜索，或先在这里提问，这样您就不会问他们*太多*简单的问题）。

祝你好运！

编辑：由于我的原始答案似乎只有前两句话被阅读，我想我最好提供更多链接来支持我所说的。

*   [交错迭代瀑布（反）模式](http://danube.com/blog/kanemar/the_staggered_iterative_waterfall_anti_pattern_part_1.html)
*   [瀑布开发模式被认为是有害的](http://www.it-director.com/technology/productivity/content.php?cid=7865)
*   [不要画错误实践的图表——或者：为什么人们仍然相信瀑布模型](http://tarmo.fi/blog/2005/09/09/dont-draw-diagrams-of-wrong-practices-or-why-people-still-believe-in-the-waterfall-model/)
*   [管理大型软件系统的开发 (PDF)](http://www.cs.umd.edu/class/spring2003/cmsc838p/Process/waterfall.pdf)

请注意，最后一篇是 Royce 的原始论文。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-19T19:50:03.880

语。我不仅仅指 COBOL 与 C#，还指用于描述问题和解决方案的词语。我经常发现自己在与年长的 COBOL 程序员交谈时遇到困难，因为我们缺乏 ABENDS、工作存储（老派）、方法、自动化单元测试（新派）等等的共享语言。与生活中的许多其他问题一样，“知道是成功的一半”——一旦你认识到问题，你就可以努力克服它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-06T19:05:10.767

从我所看到的一切来看，尽管在短短 3 年左右的行业经验中，所有开发人员都属于 2 类中的 1 类，无论年龄或经验如何。

1.  那些一直在学习和意识到变化的人，尤其是在软件领域是不可避免的，并愉快地接受或完全欢迎它。

2.  认为自己足够优秀并且只是“做好自己的工作”并且对作为开发人员的成长没有兴趣的开发人员。

我已经看到许多年轻和年长的开发人员属于每个类别，我永远不想与任何属于 #2 类别的人一起工作，因为他们真的很差，只会对项目造成损害。我很乐意接受一个专注于学习和成长（假设他们可以正确地工作逻辑）的大学实习生，而不是任何人，即使有几十年的“经验”属于第 2 类。

很多时候人们似乎不想提出这个问题。经验本身并不是对预期结果的描述。有不好的经验，或者属于第 2 类或一直受制于第 2 类开发人员的开发人员往往会比没有经验且没有先入为主的开发人员给项目带来更糟糕的经验和更糟糕的决策。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-19T19:28:44.157

我也是刚毕业的大学生。我与年长的开发人员一起工作，但在大多数情况下，他们接受敏捷方法并理解为什么我们的目的需要使用敏捷方法而不是瀑布。我承认他们的执行有时是不正确的，但至少他们尝试过。

我发现企业利益对尝试正确使用敏捷方法施加了更大的压力。当您的公司高管告诉您计划所有任务并一次估算 10 个冲刺的小时数时，请尝试使用敏捷。试图告诉他们它可能会改变并且没有意义会引起愤怒的喷发。诸如此类的问题使年龄差异显得微不足道。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-11-06T18:57:20.887

在我看来，企业文化似乎不是一种让你感到舒服的文化。你有两个选择，要么习惯它，对于一个非常初级的程序员来说，文化不会改变，要么找到另一份工作，那里的文化更符合你在工作环境中的需要。

我在工作场所看到的最大的年龄问题是，许多年轻人进来时认为他们是这个群体中最好的、最博学的，他们想要的就是做事的唯一方法。他们认为工作场所应该以给予他们特殊待遇为中心，即使他们没有取得任何值得这种待遇的成就。他们认为他们应该得到最有趣的任务，因为无聊的任务在他们之下。在尝试将现有系统更改为最酷的新事物之前，他们不想做艰苦的工作来理解现有系统。企业界并不关心某件事是否酷或有趣，也不特别关心团队中最年轻的人想要什么。也许这对您来说似乎不公平，但这就是大多数公司的情况。

年长的员工更了解公司政治的运作方式，更好地了解游戏规则，因此他们更有效地得到他们想要的东西。请注意，我并不是说我们年轻的时候我们这一代更好。

总有一天你也会变老，你会抱怨年轻人，抱怨他们比你这一代人差多少。可怕的想法，不是吗？（我什么时候变成妈妈了？怎么还没26？）

# java - Tomcat VS 码头

> ID：302977
> 
> 赞同：172
> 
> 时间：2008-11-19T19:03:47.750
> 
> 标签：java, tomcat, servlets, webserver, jetty

我想知道每台服务器在生产环境方面的缺点。有人对其中一项功能有大问题吗？性能等。我也赶紧看了一下新的Glassfish，它和简单的servlet容器匹配吗（至少它似乎有一个很好的管理界面）？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2008-11-19T19:06:43.627

我喜欢 Jetty，因为它的维护成本低。它只是打开包装，可以滚动了。Tomcat 的维护成本有点高，需要更多的配置，而且更重。此外，Jetty 的 continuation 非常酷。

编辑：2013 年，有报道称 Tomcat 变得更容易了。看评论。我还没有验证。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-10-09T08:04:27.897

我认为tomcat更受应用程序的讨论和支持，Jetty是可移植的，可以嵌入到应用程序中。Jetty 有很好的延续性。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-19T22:00:46.550

我喜欢如何将 Jetty 嵌入到应用程序中，这样它就不需要在 Web 容器中运行（Hudson 和 Nexus 是可以在这种模式下运行的两个应用程序）。Tomcat可以做到这一点吗？

# python - 集成到现有站点的最佳 Django 'CMS' 组件

> ID：302983
> 
> 赞同：14
> 
> 时间：2008-11-19T19:04:55.003
> 
> 标签：python, django, content-management-system

所以我有一个相对较大的（足够的代码，从头开始编写这个 CMS 组件比重写应用程序以适应 CMS 更容易）webapp，我也想添加基本的页面/菜单/媒体管理，我已经看到几个 Django 插件解决了这个问题，但很多似乎都是针对完整的 CMS 平台。

有谁知道可以轻松与现有模板/视图集成并且仍然具有强大/全面的管理界面的插件？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2010-10-08T17:16:32.720

我已经与这三个（以及更多）一起工作，它们都是为不同的用例构建的，恕我直言。我同意这些是顶级选择。

djangopluggables.com 上的网格比较当然可以更容易地评估每一个。

**django-cms**是功能最齐全的，您可以在不负责任的情况下将其移交给客户。尽管它具有集成其他应用程序的功能，但它没有 FeinCMS 的可扩展性/集成性或 django-page-cms 的简单性。话虽如此，我认为这是 Django 最好的开源 CMS。但是，它的文档有点缺乏。***更新***：*有人告诉我，将应用程序集成到 DjangoCMS 2.1 中已得到改进。*

**FeinCMS** - 是一套很棒的工具，用于将 CMS 功能组合和构建到您自己的应用程序中。它根本不是“开箱即用”的，这意味着您可以随心所欲地集成它。它不想接管您的 urls.py 或控制您路由页面的方式。它可能是 Django 中下一代真正可插拔应用程序的原型。- 我们正在从 django-page-cms 迁移到 FeinCMS，因为我们的主要模型是大容量电子商务，并且我想要集成的自定义内容类型不是博客或 Flash。良好的文档和支持也是如此。

**Django-page-cms** - 如果您只想在您的主要应用程序周围有一些“关于我们”页面，那就太好了。它的菜单系统不是真正的分层结构，构建您的页面演示文稿取决于您。但它非常简单、不显眼，并且很容易进入您的应用程序并获得客户可以管理的导航，甚至可以为您自己管理。它没有我知道的文档，但你真的不需要任何文档。阅读代码，您将在 30 分钟或更短的时间内完成所有操作。

*更新*

**Mezzanine** - Is a very well designed CMS and one that I have finally settled on for most of my client work, mostly because it has an integrated eCommerce portion. But beyond that it has very extensible page models, and a custom admin interface that a client might be willing to use. It also has the best "out of the box" experience i.e. You can have a full fledged site up with one command.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-08-10T20:46:34.273

如果您不一定想要具有固定功能集的完整 CMS，而是想要在 Django 之上构建您自己的 CMS 的工具，我建议您研究 FeinCMS。它遵循工具包理念，而不是试图解决所有问题，而且（也）经常失败。

[http://github.com/matthiask/feincms/tree/master](http://github.com/matthiask/feincms/tree/master)

免责声明：这是我的创意，是我尝试为客户的需求定制另一个 CMS 的太多令人沮丧的经历的结果。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-28T22:29:10.723

还有一个也很不错：

[Django CMS 页面](http://code.google.com/p/django-page-cms/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-09-08T09:16:59.360

如果您需要更多功能，那么简单的 django-page-cms 只需检查 django-blocks ( [http://code.google.com/p/django-blocks/](http://code.google.com/p/django-blocks/) )。拥有多语言菜单、平面页面，甚至还有一个简单的购物车！！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-10-01T14:33:08.203

在 Django wiki 上有一个很好的 Django CMS 应用程序概述！

[http://code.djangoproject.com/wiki/CMSAppsComparison](http://code.djangoproject.com/wiki/CMSAppsComparison)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-19T21:44:28.907

请参阅[django-plugables](http://djangoplugables.com/)网站，列出的 Django CMS 组件很少（有些看起来非常好）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-22T04:20:47.720

我在集成[django-cms](http://django-cms.org)方面取得了成功。只需将它包含在 urlconf 的末尾，它就不会干扰。（当你失去漂亮的 404 页面时`DEBUG=True`）

使用上下文处理器和自定义模板标签的各种组合，我已经能够做我需要的一切，但如果你*真的*需要将内容插入到你自己的视图中，那应该很容易。（也许`cms.views.render_page()`使用缺少所有包装器 html 的模板调用？）

# javascript - 为什么不|| 似乎在 JavaScript 中作为合并/默认运算符工作？

> ID：302993
> 
> 赞同：1
> 
> 时间：2008-11-19T19:08:23.967
> 
> 标签：javascript, firefox-3, coalesce

我已经看到几个网页说`a = b || 'blah'`应该分配`'blah'`给`a`if `b`is`undefined`或`null`. 但是，如果我将它输入到 Firebug 或在代码中使用它，它会抱怨`b`未定义，在 FF3/win 的列表中。有什么提示吗？

编辑：我正在寻找`b`可能根本不存在的情况。例如，没有`id`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-19T19:13:28.353

如果 b 存在，并且为 false、null 等，那么它会按照您期望的方式工作。你需要做的就是在上面的那一行，放`var b = null`;

如果你仔细想想，这是有道理的。它基本上做这样的事情......

```
a = function(){ if(b){return b;} else{ return 'blah' } }(); 
```

请注意，它正在检查 b 的值是否真实……如果 b 不存在，则会出现异常。

### 关于未定义的变量

javascript 中的“未定义”并不意味着“变量不存在”。它的意思是“变量的值是`undefined`”的特殊值。例子：

```
alert(nosuchvariable);
=> throws exception

var somevariable; // note it's never assigned
alert(somevariable);
=> This alerts with 'undefined' 
```

### 关于检查变量是否存在。

因此，如果我们尝试读取`b`并且没有像 b 这样的变量，我们会得到一个异常。如果我们试图找出是否定义了 b，那么这没有帮助。

您可以通过检查顶级`window`对象来查看是否存在全局变量。所有全局变量实际上只是`window`对象中的字段。例子：

```
foo = 'Hello';
alert( window.foo );
=> alerts 'Hello' 
```

因为您知道窗口对象已经存在，所以您可以检查它的字段。
检查 javascript 中不存在的字段会给您`undefined`并且不会崩溃，因此您可以进行合并，或将其`undefined`放入变量或其他任何内容中

对于**局部**变量（用 声明的东西`var`），~~您无法检查它们的存在。~~它们不会以全局变量在窗口对象中“存在”的方式“存在”任何地方，并且任何正常尝试引用一个都会导致异常：例如：

```
alert(a);
=> exception because a is meaningless
alert(d45pwiu4309m9rv43);
=> exception because that is equally meaningless 
```

然而，有一个例外（我知道，感谢评论中的 J c），`typeof`操作员。如果你尝试获取不存在的东西的类型，它*不会*崩溃，它会返回*字符串* `"undefined"`。
这为您提供了一种检查不存在的局部变量的方法。例如：

```
if( typeof(djfsd) === "undefined" )
  alert('no such variable'); 
```

### 关于不存在的DOM元素

有几条评论提到没有 ID 的 DOM 元素等等......

它是一个 DOM 元素这一事实并不真正相关。将 DOM 视为数据库或文件，将元素视为该数据库中的一行或该文件中的单词。为了用它*做*任何事情，你必须搜索数据库，找到正确的行，然后把它的数据拉出来。数据被放入一个 javascript 对象中。然后，您可以通过操作该对象来访问它，如果您愿意，也可以将该对象放入一个变量中。例子：

```
document.getElementById('foo'); 
```

这进入 dom 并查找 ID 为“foo”的元素。如果找到了，它会将有关该元素的一些信息放入一个 javascript 对象中，然后将该对象交还给您。如果它找不到元素，它会把你交还给你`null`，但所有的正常规则仍然适用（你可以把它`null`放在一个变量中，或者其他什么）。

它根本不影响合并。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T22:01:45.003

我想你正在寻找这个：

```
var a = typeof b == 'undefined' ? 'blah' : b; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T19:13:33.487

`||`是 JavaScript 中的短路逻辑 OR 运算符，很像 C、C++、Java、C#、Perl、PHP 等中的逻辑或运算符。

[根据 Wikipedia](http://en.wikipedia.org/wiki/%3F%3F_Operator#JavaScript_implementation)，如果您在 周围加上括号`b`，它将按您的预期工作。

```
var a = (b) || 'blah'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T19:56:57.173

> 但是如果我将它输入到 Firebug 或在代码中使用它，它会抱怨 b 未定义，在 FF3/win 的列表中

你是什​​么意思，“未定义”？你的意思是Javascript不知道这个变量？然后你可以使用`window.b`"window" 是顶级对象，或者首先用`var b;`;声明 b 但前提是它*是*一个变量。

如果它是一个 DOM 元素，您可能必须先尝试寻找它，例如 `document.getElementById`：

```
a = document.getElementById('b') || 'blah' 
```

为我工作。**********************